# StackOverflow 问答 13497000-13497999

# java - 骑士之旅：无法解决

> ID：13497000
> 
> 赞同：1
> 
> 时间：2012-11-21T15:53:03.567
> 
> 标签：java, knights-tour

我编写了这段代码来打印一个可能的骑士之旅，这样每个地方都被访问一次。

```
public class Main{
         static int move[][]=new int[8][8];
         static int X[]={1 , 2 , 2 , 1 ,-1 ,-2 ,-2,-1};
         static int Y[]={2 , 1 ,-1 ,-2 ,-2 ,-1 , 1, 2};
         static boolean printMove(int x,int y,int step){
   if(step==65){

       return true;
   }
   else{
       int x1,y1;

       for(int l=0;l<8;l++){
           x1=x+X[l];
           y1=y+Y[l];
           if(x1<8&&y1<8&&x1>=0&&y1>=0&&move[x1][y1]==0){

               move[x1][y1]=step;
               if(printMove(x1,y1,step+1)){
                   return true;
               }
               else
               move[x1][y1]=0;

           }
       }
       return false;

   }
} 

 static void printSteps(){
       for(int i=0;i<8;i++){
          for(int j=0;j<8;j++){
               System.out.print(move[i][j]+" ");
             }
           System.out.println();
             }
    }
public static void main(String args[]){

     move[0][0]=1;

     printMove(0,0,2);   
     printSteps();

   }
} 
```

此代码有效，但以下代码无效，我对 X[] 和 Y[] 进行了少许更改，这不应该影响算法。

```
 public class Main{
         static int move[][]=new int[8][8];
         static int X[]={-1, 1 , 2 , 2 , 1 ,-1 ,-2 ,-2};
         static int Y[]={ 2, 2 , 1 ,-1 ,-2 ,-2 ,-1 , 1};
         static boolean printMove(int x,int y,int step){
   if(step==65){

       return true;
   }
   else{
       int x1,y1;

       for(int l=0;l<8;l++){
           x1=x+X[l];
           y1=y+Y[l];
           if(x1<8&&y1<8&&x1>=0&&y1>=0&&move[x1][y1]==0){

               move[x1][y1]=step;
               if(printMove(x1,y1,step+1)){
                   return true;
               }
               else
               move[x1][y1]=0;

           }
       }
       return false;

   }
} 

 static void printSteps(){
       for(int i=0;i<8;i++){
          for(int j=0;j<8;j++){
               System.out.print(move[i][j]+" ");
             }
           System.out.println();
             }
    }
public static void main(String args[]){

     move[0][0]=1;

     printMove(0,0,2);   
     printSteps();

   }
} 
```

我刚变

```
 static int X[]={1 , 2 , 2 , 1 ,-1 ,-2 ,-2,-1};
         static int Y[]={2 , 1 ,-1 ,-2 ,-2 ,-1 , 1, 2}; 
```

至

```
 static int X[]={-1, 1 , 2 , 2 , 1 ,-1 ,-2 ,-2};
         static int Y[]={ 2, 2 , 1 ,-1 ,-2 ,-2 ,-1 , 1}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T16:46:49.577

我怀疑发生的是您的第二个程序实际上可以正常工作。这两个程序都使用蛮力搜索并且效率极低，但是第一个程序碰巧很快就偶然发现了一次旅行，而第二个程序则没有。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T17:33:05.250

试试这个代码 - 它和你的完全一样，但它会打印它的进度。在我看来，它确实有效，只是需要很长时间才能涉足所有替代方案。

```
static int move[][] = new int[8][8];
//static int X[]={1 , 2 , 2 , 1 ,-1 ,-2 ,-2,-1};
//static int Y[]={2 , 1 ,-1 ,-2 ,-2 ,-1 , 1, 2};
static int X[]={-1, 1 , 2 , 2 , 1 ,-1 ,-2 ,-2};
static int Y[]={ 2, 2 , 1 ,-1 ,-2 ,-2 ,-1 , 1};
static boolean printMove(int x, int y, int step, String stack) {
  if (step == 65) {

    return true;
  } else {
    int x1, y1;

    for (int l = 0; l < 8; l++) {
      System.out.println(stack+" step = "+step+" l = "+l);
      x1 = x + X[l];
      y1 = y + Y[l];
      if (x1 < 8 && y1 < 8 && x1 >= 0 && y1 >= 0 && move[x1][y1] == 0) {

        move[x1][y1] = step;
        if (printMove(x1, y1, step + 1, stack + "," + l)) {
          return true;
        } else {
          move[x1][y1] = 0;
        }
      }
    }
    return false;

  }
}

static void printSteps() {
  for (int i = 0; i < 8; i++) {
    for (int j = 0; j < 8; j++) {
      System.out.print(move[i][j] + " ");
    }
    System.out.println();
  }
}

public static void main(String[] args) throws InterruptedException {
  try {
    Test test = new Test();
    test.test();
    move[0][0] = 1;

    printMove(0, 0, 2, "");
    printSteps();
  } catch (Exception e) {
    e.printStackTrace();
  }
} 
```

# c++ - 本例中 move 和 forward 的区别

> ID：13497003
> 
> 赞同：1
> 
> 时间：2012-11-21T15:53:12.677
> 
> 标签：c++, c++11, move-semantics, perfect-forwarding

第一个按值取 A 的例子做了两步，而通过 refref 的例子只做了一次。有什么不同？

```
struct A
{
  A() { cout << "constructor" << endl;}
  A(const A&) { cout << "copy constructor " << endl;}
  void operator=(const A&) { cout << "assignment operator" << endl; }
  A( A&&) { cout << "move copy constructor" << endl;}
  void operator=(A&&) { cout << "move assignment operator" << endl;}
};
struct C {
  void func(A t) {
    d.a = std::move(t);
  }
  struct Data {
    A a;      
  };
  Data d;
};
struct B {
  void func(A t) {
    C c;
    c.func(std::move(t));
  }
};
//////////////////////////////////////////////////////////
struct C {
  template<class T>
  void func(T&& t) {
    d.a = std::forward<T>(t);
  }
  struct Data {
    A a;      
  };
  Data d;
};
struct B {
  template<class T>
  void func(T&& t) {
    C c;
    c.func(std::forward<T>(t));
  }
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T16:03:40.280

来自[cppreference.com](http://en.cppreference.com/w/cpp/utility/forward)：

> 在函数模板中根据以下配方使用时，将参数转发给另一个函数，就像它传递给调用函数一样。
> 
> ```
> template<typename T> 
> wrapper(T&& arg) {
>    foo(std::forward<T>(arg)); 
> } 
> ```

所以在你的片段中

```
struct B {
  template<class T>
  void func(T&& t) {
    C c;
    c.func(std::forward<T>(t));
  }
}; 
```

将`std::foward<T>(t)`简单地将您的`T&&`对象转发到`c.func()`完全按照`B::func()`调用的方式。这不需要移动，这就是为什么您使用`std::forward<T>`.

我真的建议查看 Scott Meyer 关于这个主题的博客文章`std::move`：`std::forward`http: [//scottmeyers.blogspot.com/2012/11/on-superfluousness-of-stdmove.html](http://scottmeyers.blogspot.com/2012/11/on-superfluousness-of-stdmove.html)

# asp.net-mvc - 在 Kendo 窗口中显示流

> ID：13497007
> 
> 赞同：1
> 
> 时间：2012-11-21T15:53:31.900
> 
> 标签：asp.net-mvc, kendo-ui

我正在尝试将 PDF 流显示到 KendoUI 窗口中。

当结果返回到 KendoUI 窗口时，将显示 PDF 的原始数据。我启动了 Fiddler 以查看内容类型是否正确通过。Fiddler 确实显示了正确的内容类型。

我尝试了许多不同的交互。每次尝试都会产生下面列出的相同结果。

这是控制器的片段：

```
 public FileStreamResult DownloadV3()
    {
        //Create and populate a memorystream with the contents of the database table
        MemoryStream mstream = GetPDFData();

        HttpContext.Response.AddHeader("content-disposition", "attachment; filename=form.pdf");

        return new FileStreamResult(mstream, "application/pdf");
    } 
```

以下是 KendoUI 窗口中显示的片段：

```
%PDF-1.5 5 0 obj <>>> endobj 6 0 obj <>stream 
```

下面是一段 javascript 代码：

```
<script type="text/javascript">
$(document).ready(function () {
    $("#view1").bind("click", winOpen);
});
function winOpen() {
    var id = '6CA88CA9-4F33-E211-84AC-B4A17689C6D9';
    var kendoWindow = $("#kjWindow").kendoWindow({
        title: "View File",
        width: "750px",
        height: "480px",
        content: "/home/DownloadV3/" + id,
        modal: true,
        actions: ["Close", "Refresh", "Maximize"]
    });
} 
```

关于我所缺少的任何想法/

谢谢。

史蒂夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T16:01:46.783

我猜剑道窗口试图通过 Ajax 请求获取 URL 内容，您无法通过 ajax 检索非 html 内容，尝试在窗口内放置一个 iframe 并将其指向 URL

# shopify - Shopify：是否可以在结账时在液体模板中更新产品价格？

> ID：13497014
> 
> 赞同：0
> 
> 时间：2012-11-21T15:53:47.770
> 
> 标签：shopify

如果买家从 Shopify 商店购买商品，我们希望自定义系统，以便买家可以从同一商店的特定收藏中免费选择另一款产品，即购买高级 dvd 并免费获得另一张 dvd （必须从特定收藏中选择免费 DVD）。

关于如何最好地实现这一目标的任何建议？

如果添加到购物车中的第二个免费物品在特定的“免费”系列中，是否可以编辑（破解）主题的购物车模板以将价格设置为零？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T15:55:17.243

您可以创建可应用于集合中单个项目的折扣代码。您只需将该商品的折扣设置为 100% 折扣即可。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T18:28:38.990

如果您遍历购物车并在其中找到没有“免费”追加销售产品的“高级”产品，您将为客户呈现该系列“免费的东西”，他们可以从该系列中挑选。Free 系列中的产品确实是免费的。

如果您使用免费集合中的商品渲染购物车，并且购物车中没有高级商品，您可能想要禁用结帐。

那会是“足够好”吗？

# android - 如何在 Android 的 achartengine 中删除/隐藏 X 轴编号？

> ID：13497016
> 
> 赞同：3
> 
> 时间：2012-11-21T15:53:46.380
> 
> 标签：android

我使用 achartengine 在我的 Android 应用程序上绘制一些统计条形图。![chartengine 应用程序](../Images/3116a42e8879ab186e69fa06155ebc8b.png)

从上图中可以看出，X(Y) 轴包含一系列数字：10 20 30 40 ... 我想删除/隐藏 X 轴数字。有谁知道如何通过编程来做到这一点？或者换句话说，如何改变 achartengine 的设置来实现它。谢谢！

**我找到了答案：**

```
// by it, the x-axis number 0 10 20 30.. can be hiden
renderer.setXLabels(RESULT_OK); 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-25T06:53:50.117

嘿，你可以使用方法

```
renderer.setXLabels(0); 
```

此方法接受应在 X 轴上显示的最大标签数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T01:19:56.757

好吧，在测试时它对我不起作用，但这似乎是这样做的方法。也许它可能对你有用：

```
mrenderer.clearXTextLabels(); 
```

`mrenderer`在哪里`XYMultipleSeriesRenderer()`

如果你想做自己的挖掘，这里有一个[网站](http://www.achartengine.org/content/javadoc/index.html)，它显示了一些比图书馆上无处不在的文档要少得多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T16:56:14.610

```
renderer.setXLabels(0);
renderer.setYLabels(12); 
renderer.addXTextLabel(1, "a");
renderer.addXTextLabel(2, "b");
renderer.addXTextLabel(3, "c");
renderer.addXTextLabel(4, "d");
renderer.addXTextLabel(5, "e");
renderer.addXTextLabel(6, "f"); 
```

# css - 使用浮动时div离开父级

> ID：13497018
> 
> 赞同：0
> 
> 时间：2012-11-21T15:54:07.930
> 
> 标签：css

我看不出我的问题在哪里。我尝试了多种方法，但我仍然遇到同样的问题。正如标题所说，我已经将一个 div 变成了一个 div。当对孩子使用浮动时，他会离开父母的div。即使事实并非如此，但在设置边框以检查它时，这就是我所看到的。

```
#feed{
margin: auto;
padding-top: 10px;
padding-bottom: 10px;
padding-left: 10px;
padding-right: 10px;
width: 70%;
float: center;  
}

.news{
margin:auto;
margin-top: 10px;
padding-bottom: 5px;
border: 1px solid;
}

.newsContent{
margin-top: 5px;
margin-left:5px;
margin-right:5px;
background-color:red;
}

.newsContent p{
margin-left: 5px;
margin-right: 5px;
}

.newsDate{
width: 20%;
margin-top: 5px;
margin-left:5px;
margin-right:5px;
float: right;
background-color:red;
}

.newsDate p{
text-align: center; 
} 
```

和我的html代码：

```
<div id="feed">
    <div class="news">
        <div class="newsContent">
            <p> ici nouveauté </p>
        </div>

        <div class="newsDate">
            <p> ici date </p>
        </div>
    </div>
</div> 
```

谢谢你。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-21T15:56:23.553

添加

```
<div style="clear: both;"></div> 
```

在子 div 之后，在父 div 内部。这将清除您应用于子 div 的浮动，并应为您提供所需的效果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T16:07:27.607

将以下 CSS 规则添加到父元素（`.news`在这种情况下）应该可以修复它：

`overflow: hidden;`

在此处查看预览：http: [//jsfiddle.net/ChAQq/](http://jsfiddle.net/ChAQq/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T16:02:56.900

你在寻找这样的东西吗？ [http://jsfiddle.net/QPUzd/1/](http://jsfiddle.net/QPUzd/1/)

这是因为浮动属性。你必须小心他们。

```
#feed{
margin: auto;
padding-top: 10px;
padding-bottom: 10px;
padding-left: 10px;
padding-right: 10px;
width: 70%;
float: center;  
}

.news{
margin:auto;
margin-top: 10px;
padding-bottom: 5px;
border: 1px solid;
float:left;
}

.newsContent{
margin-top: 5px;
margin-left:5px;
margin-right:5px;
background-color:red;
    float:left;
}

.newsContent p{
margin-left: 5px;
margin-right: 5px;

}

.newsDate{
width: 20%;
margin-top: 5px;
margin-left:5px;
margin-right:5px;
float: right;
background-color:red;
}

.newsDate p{
text-align: center; 
} 
```

# java - 如何区分 window / *nix 路径

> ID：13497020
> 
> 赞同：0
> 
> 时间：2012-11-21T15:54:27.413
> 
> 标签：java, windows, unix, filepath

我正在开发恢复应用程序，其中恢复路径是 Windows 路径或 unix 路径（我不知道哪个直接），然后我需要将它们映射到当前操作系统中的适当路径。

显然 Windows ==> Windows，*nix ==> *nix 是直截了当的。但是，当原始路径来自 Windows 时，将它们移动到 *nix 是有问题的，因为 *nix 会将这些路径解释为文件名（例如 C:\folderA\fileB.txt 映射到 *nix 中的文件而不是作为/文件夹A/fileB.txt)

我想要做的是提前解析路径，确定它们是否是 windows/*nix 路径，然后相应地处理它们。

有什么建议么？

乔纳森

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T15:56:37.303

该类`java.io.File`在两个平台上都可以与斜线分隔的路径一起正常工作。

您还可以解析`File.separator`值的路径，这取决于程序运行的平台。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T15:57:22.533

由于 Windows API 将反斜杠`\`和斜杠`/`视为路径分隔符，并且由于 Unix 上理智的人不会在文件名中嵌入反斜杠，因此您可以简单地将反斜杠转换为斜杠。这将使您`C:`在处理路径的开头只剩下驱动器号（等）。

# .net - 使用 NGEN 更新 RemoteAPP 应用程序的正确方法

> ID：13497022
> 
> 赞同：18
> 
> 时间：2012-11-21T15:54:35.460
> 
> 标签：.net, deployment, windows-server-2008-r2, ngen, remoteapp

我们在 RDS 服务器上有一个 Windows2008R2 RemoteAPP .NET 4.5 应用程序 NGEN-ed，大约。3 主机 NLB 群集的 300 个并发用户。

该应用程序正在积极开发中，需要经常更新（即替换为新的）RemoteAPP 部署的程序集。

我们目前的做法如下：

1.  重命名要在 RemoteAPP 服务器上更改的文件，用户连接到它（如果文件被加载，操作系统将不允许文件被覆盖），
2.  写新文件而不是旧文件，
3.  NGEN 安装新程序集（无需先卸载旧程序集！），
4.  通知用户（通过应用程序本身）应用程序版本已更改，需要重新启动，
5.  逐渐允许用户按照自己的节奏重新启动应用程序（同时重新启动应用程序会导致磁盘和 CPU 负载增加，从而损害服务器性能）。对于集群中的所有主机也是如此。

在此之后，服务器偶尔会出现蓝屏崩溃并出现 Microsoft-Windows-Kernel-Power EventID 41 严重错误 - 我强烈谴责我们的更新实践对此负责。

因此，问题是：在不必终止访问旧程序集的进程的情况下更新 RemoteAPP 应用程序和 NGEN 新程序集的推荐方法是什么（即允许用户在他们喜欢时继续并重新启动）。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-24T22:34:50.930

我建议使用新的“用于 IIS 7.5 的应用程序初始化模块”来加速您的 Web 应用程序，并且“应用程序初始化”内置在 IIS 8 中，而不是 ngen。

微软网站声称：IIS 7.5 的 IIS 应用程序初始化使网站管理员能够通过在第一个请求到达之前加载 Web 应用程序来提高其网站的响应能力。

参考： [http ://weblog.west-wind.com/posts/2013/Oct/02/Use-IIS-Application-Initialization-for-keeping-ASPNET-Apps-alive](http://weblog.west-wind.com/posts/2013/Oct/02/Use-IIS-Application-Initialization-for-keeping-ASPNET-Apps-alive)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-28T00:15:53.677

您可以使用通过 RemoteApp 发布的入门应用程序。启动器将依次启动应用程序的最新版本。

例如：有一个注册表项，它是您的应用程序最新版本的路径

1.  添加一个新文件夹`C:\Program Files\myApp\1.0.26\`
2.  `ngen`新组件
3.  更新注册表项以指向新文件夹
4.  Launcher 在运行时启动新版本的应用程序
5.  （可选）在不再使用旧版本时将其删除

RemoteApp 指向`C:\Program Files\myApp\startApp.exe`

`startApp.exe`开始`1.0.26\theApp.exe`

# xml - Perl XML::Parser - 如何访问一个简单的解析树？

> ID：13497027
> 
> 赞同：3
> 
> 时间：2012-11-21T15:54:36.643
> 
> 标签：xml, perl, parsing

我想使用 XML::Parser 解析一个简单的字符串。这工作正常。但我不知道如何访问结果。

```
#!/usr/bin/perl

use Data::Dumper;
use XML::Parser;

my $parser = XML::Parser->new( Style => 'Tree' );
my $tree   = $parser->parse( '<xml type="test" Id="ca19cfd5" result="1 test 2 test 3" elapsed="9" Size="12345" />' );

print Dumper( $tree ); 
```

给我看

```
$VAR1 = [
'xml',
[
{
'Size' => '12345',
'Id' => 'ca19cfd5',
'type' => 'test',
'elapsed' => '9',
'result' => '1 test 2 test 3'
 }
 ]
 ]; 
```

所以它完全可以解析我的字符串。但是我如何访问这些字段？类似“我的 $result = $tree...”

给定的 xml 字符串将始终具有如上所示的相同语法。只是内容不同。

Tnx 提前，恩奇都

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T16:29:07.537

您正在寻找的属性在`$tree->[1]->[0]`

```
my $atts= $tree->[1]->[0]; 
```

然后

```
print "size: $atts->{Size}\n"; 
```

也就是说 XML::Parser 不是最容易使用的模块，它有点太低级了。XML::Twig 或 XML::LibXML 将更轻松地为您提供所需的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-22T00:18:47.700

您可以查看其他生成更简单结构的 XML 解析器

例如我的模块：

*   XML::快速
*   XML::哈希::LX
*   XML::Parser::Style::ETree

# java - 将java字符串转换为json对象

> ID：13497029
> 
> 赞同：0
> 
> 时间：2012-11-21T15:54:45.487
> 
> 标签：java, json

我有一个这种格式的java字符串

```
"{name:MyName, rage:200, height:100}" 
```

我需要将它转换为 JsonObject 应该是下面的格式

```
 {name:MyName, rage:200, height:100} // that is i want to remove the  start and end double quotes fro the above string . 
```

有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T15:58:45.927

使用 json.org 库。就像`new JSONObject(s);`s 是 a一样简单`String`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T16:00:05.343

你试过杰克逊 JSON 库吗？ [使用 ObjectMapper 将 JsonNode 创建为树结构并从那里解析非常容易。](http://wiki.fasterxml.com/JsonNode)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T16:35:42.637

如果您只想删除引号，使用[StringUtils.mid](http://commons.apache.org/lang/api-2.5/org/apache/commons/lang/StringUtils.html#mid%28java.lang.String,%20int,%20int%29)应该可以完成您的工作

```
final String input = "\"{name:MyName, rage:200, height:100}\"";
final String result = StringUtils.mid (input, 1, input.length () - 2);
// result should not contain the beginning and ending quotes 
```

# java - 为什么他们在这个 Java GridBagLayoutDemo 示例中声明这些静态变量？

> ID：13497034
> 
> 赞同：0
> 
> 时间：2012-11-21T15:55:20.043
> 
> 标签：java, swing, gridbaglayout

我正在研究 Java GUI 以及[GridBagLayout 的](http://docs.oracle.com/javase/tutorial/uiswing/layout/gridbag.html)工作原理：

```
final static boolean shouldFill = true;
final static boolean shouldWeightX = true;
final static boolean RIGHT_TO_LEFT = false;

public static void addComponentsToPane(Container pane) {
    if (RIGHT_TO_LEFT) {
        pane.setComponentOrientation(ComponentOrientation.RIGHT_TO_LEFT);
    }

    JButton button;
    pane.setLayout(new GridBagLayout());
    GridBagConstraints c = new GridBagConstraints();
    if (shouldFill) {
    //natural height, maximum width
        c.fill = GridBagConstraints.HORIZONTAL;
    }

    button = new JButton("Button 1");
    if (shouldWeightX) {
        c.weightx = 0.5;
} 
```

（完整[来源在这里](http://docs.oracle.com/javase/tutorial/uiswing/examples/layout/GridBagLayoutDemoProject/src/layout/GridBagLayoutDemo.java)）我很困惑为什么你需要/想要这里的 3 个布尔值 - shouldFill、shouldWeightX 和 RIGHT_TO_LEFT - 即我们不能简单地删除这 3 个 if 语句吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T15:59:02.603

这不是必需的，但有时声明常量有助于了解所有设置值。这使您无需在代码中搜索即可快速尝试值组合（因此更抽象）。也许程序员选择只使用布尔值来对齐/简化值......注意：常量应该尊重 RIGHT_TO_LEFT 使用的语法。

# c# - 谷歌 Freebase API .Net

> ID：13497036
> 
> 赞同：1
> 
> 时间：2012-11-21T15:55:26.610
> 
> 标签：c#, .net, freebase

几个月前，我发布了一个关于 Freebase API C# .Net 示例的请求。但是客户端库中似乎存在一个错误，我看不出是否会在不久的将来得到修复。您可以在此处查看原始帖子。[Google Freebase Api C# .Net 示例](https://stackoverflow.com/questions/11991267/google-freebase-api-c-sharp-net-example)

还有这里的错误报告。[http://code.google.com/p/google-api-dotnet-client/issues/detail?id=193](http://code.google.com/p/google-api-dotnet-client/issues/detail?id=193)

我的问题是有另一种方法可以让 .Net 服务连接并从 Freebase 提取信息吗？如果是这样，有人可以指出我正确的方向，某种例子真的会有所帮助。关于使用 .Net Google Freebase API 的信息很少。谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T22:04:31.007

`HttpWebRequest`将答案使用和解析为 JSON不是更简单吗？我在开发我的应用程序时选择了这个选项，并且花了大约几个小时来编写一个可居住的适配器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T22:24:03.833

我不知道它是否能解决您的特定问题，但微软最近发布了他们自己的[适用于 .NET 的 Freebase API](http://blogs.msdn.com/b/fsharpteam/archive/2012/09/21/the-f-3-0-freebase-type-provider-sample-integrating-internet-scale-data-sources-into-a-strongly-typed-language.aspx)，您可以尝试一下。他们还发布了一些[使用示例](http://blogs.msdn.com/b/fsharpteam/archive/tags/freebase+sample/)。[FSharpx](https://github.com/fsharp/fsharpx)的人甚至将它包装成一个[NuGet 包](http://nuget.org/packages/FSharpx.TypeProviders.Freebase)。

当然，您需要使用 F#，因为 C# 和 VB 不具备此 API 所基于的功能。但当您考虑到 F# 有多好时，这是一个额外的好处。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-28T10:35:50.293

我处理了同样的问题。并决定写我自己的客户，因为我没有看到任何可以满足我要求的足够好。您可以在此处获取： [https](https://freebase4net.codeplex.com/) ://freebase4net.codeplex.com/ 或在包管理器控制台中执行此行“Install-Package Freebase4net”

使用代码示例：

```
var readService = FreebaseServices.CreateMqlReadService();

dynamic thepolice = new ExpandoObject();
thepolice.type = "/music/artist";
thepolice.name = FreebaseHelpers.Operators.CreateLikeOperator("^The Sco*$"); // Regex search
MqlReadServiceResponse result = await readService.ReadAsync(thepolice);
//Process result
var content = result.ResultAsString;
//get status
var status = result.Status; 
```

您可以在此处找到更高级的使用示例： [https ://freebase4net.codeplex.com/documentation](https://freebase4net.codeplex.com/documentation)

# node-webkit - 有没有办法在 node-webkit 应用程序中公开“查找”功能？

> ID：13497037
> 
> 赞同：5
> 
> 时间：2012-11-21T15:55:29.093
> 
> 标签：node-webkit

我是否需要编写自己的查找功能以允许用户在页面上查找文本内容，或者 node-webkit 是否可以公开预先存在的 webkit 查找功能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T03:01:10.427

目前，您可以在您的应用程序中使用如下库执行此操作：[http ://www.seabreezecomputers.com/tips/find.htm](http://www.seabreezecomputers.com/tips/find.htm)

在当前的 node-webkit 中没有原生的 UI 来支持这个特性，但是如果它有优势我们会在未来看到它。

# php - PHPMailer + Cron = 重复的电子邮件

> ID：13497038
> 
> 赞同：1
> 
> 时间：2012-11-21T15:55:32.403
> 
> 标签：php, cron, phpmailer

当我使用 PHPMailer 库时，我的脚本在 CLI 中运行良好，但是当我使用 cron 运行它时，会发送多封电子邮件。我有一个要发送到的地址列表，然后对于下一个邮件收件人（不包括第一个收件人），它会发送重复邮件。

例子：

> 我每十分钟向 3 个邮件收件人发送一条消息
> 
> 第一个收件人收到一次相同的电子邮件。
> 
> 第二个收件人两次收到相同的电子邮件。
> 
> 第三个收件人收到相同的电子邮件三次。
> 
> 第4个食谱。四次……等等……

代码： http:
[//pastebin.com/XjtgEN8u](http://pastebin.com/XjtgEN8u)

crontab：

```
0,10,20,30,40,50 * * * * /etc/webmin/cluster-cron/cron.pl 1353486136-28420 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T15:59:21.930

问题是您没有为您发送的每封电子邮件创建一个新的 PHPMailer 对象。结果是您存储了所有已发送到（在以前的循环中）的电子邮件地址，并在所有后续循环中重新发送给它们。这就是为什么你会得到增量复制。

要解决此问题，请将此行放在您的 while 循环中：

```
$mail = new PHPMailer(true); 
```

这将为每个电子邮件地址实例化一个新的邮件对象，并将您的电子邮件列表重置为 0，然后再添加新的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-11-12T06:23:09.370

您还可以使用以下方法在发送到新电子邮件地址之前删除以前的电子邮件地址：

```
$mail->ClearAllRecipients(); 
```

然后添加另一个地址。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T16:00:11.403

在第 38 行的脚本中，您需要更改`adding of recipient`为`setting the recipient`... 在每次迭代中**添加**新的，而前一个保持设置。

# java - Java Generic 扩展返回方法转换错误

> ID：13497054
> 
> 赞同：1
> 
> 时间：2012-11-21T15:56:11.627
> 
> 标签：java, generics, casting

我有一个返回泛型类型列表的方法，方法如下所示。

```
 protected <T extends SQLDataBean> List<T> getJavaListFromOracleArray(Array array) throws SQLException 
```

然后我有一个名为 ReplacementBean 的对象，它扩展了 SQLDataBean。

在另一堂课中，我有一个`List<ReplacementBean>`带有 set 方法的`List<ReplacementBean>`

我发现了什么，我不确定为什么我不能在集合中调用上面列出的方法。这意味着这会产生编译时错误：

```
setReplacements(this.getJavaListFromOracleArray(in.readArray())); 
```

但是，以下编译并正常工作。

```
List<ReplacementsBean> temp = this.getJavaListFromOracleArray(in.readArray());
setReplacements(temp); 
```

我也尝试在 set 方法中进行如下转换，但它也有编译时错误。

```
setReplacements((List<ReplacementsBean>)this.getJavaListFromOracleArray(in.readArray())); 
```

有什么方法可以在调用我的 set 方法之前不必执行设置临时局部变量的两行过程？虽然它确实有效，但不必这样做会很好。

调用以下内容：

```
setReplacements(this.getJavaListFromOracleArray(in.readArray())); 
```

导致错误`setReplacements(List<ReplacementsBean>) is not applicable for the arguments List<SQLDataBean>`

setReplacements 代码如下：

```
public void setReplacements(List<ReplacementsBean> replacements)
{
    this.replacements = replacements;
} 
```

另外，如果我尝试这个：

```
setReplacements((List<ReplacementsBean>)this.getJavaListFromOracleArray(in.readArray())); 
```

我收到错误 Cannot cast from `List<SQLDataBean>`to `List<ReplacementsBean>`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T16:20:30.097

这是编译器类型推断不如您希望的那么好的情况之一。在显式指定泛型方法类型参数的情况下，以下内容应该有效：

```
setReplacements(this.<ReplacementsBean>getJavaListFromOracleArray(in.readArray())); 
```

在临时变量情况下

```
List<ReplacementsBean> temp = this.getJavaListFromOracleArray(in.readArray());
setReplacements(temp); 
```

编译器被迫实例化`<T>`以`<ReplacementsBean>`使分配工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T16:35:11.070

问题是在编译器内部完成了以下操作：

```
List<X> temp = getJavaListFromOracleArray(in.readArray());
setReplacements(temp); 
```

其中 X 必须是 ReplacementsBean 或其子项。这是开放式的。在许多更正式的类型语言中，X 被解析，而在 java 中则没有。因此需要：

```
setReplacements(<ReplacementsBean>getJavaListFromOracleArray(in.readArray())); 
```

然而，这种“缺陷”也是一个**明显的症状**：可能`getJavaListFromOracleArray`是不安全的泛型。

另请注意，该函数`setReplacements`可能会在子类中以 a 为参数被覆盖`List<ReplacementsBeanChild>`。

# ruby-on-rails - Excel文件上传和选择列

> ID：13497058
> 
> 赞同：0
> 
> 时间：2012-11-21T15:56:49.750
> 
> 标签：ruby-on-rails, excel, file-upload

我正在建立一个允许用户上传 Excel 文件的网站。Excel 文件可能有很多列不相关的信息，所以我想显示一个界面，允许用户选择他想要的列。是否已经有一个宝石可以做到这一点是 Ruby on Rails？如果没有，关于使用哪些 API 等以及如何实现这一点的任何建议？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T18:59:51.720

请参阅 SO 上的这个答案，我认为它涵盖了您正在寻找的大部分内容：[如何在 Rails 中上传和解析 Excel 文件？](https://stackoverflow.com/questions/4825473/how-can-i-upload-and-parse-an-excel-file-in-rails)

# json - Solr：是否可以定义不同于索引模式的 JSON 输出模式？

> ID：13497060
> 
> 赞同：0
> 
> 时间：2012-11-21T15:56:27.137
> 
> 标签：json, search, solr, full-text-search

我正在尝试为使用 Solr 的 Web 应用程序实现一个解决方案，该解决方案将接收搜索请求、将查询发送到搜索服务器、接收其 JSON 响应并将其直接打包到响应中作为其 JSON 输出。我的主要观点是，当前的实现将查询发送到搜索服务器，接收资源的 id，实例化每个资源（将其完全加载到内存中），然后从每个资源中生成所需的 JSON 结构。所以，我想省去这一步，让应用程序成为搜索服务器的一种代理。我正在考虑使用 Solr，因为它已经提供了 JSON 响应。

我现在唯一的问题是：用于填充索引和促进搜索的数据与我要输出的数据之间存在差异。在我见过的 Solr 实现中，索引数据是获得 JSON 输出的数据。

我的问题是：可以定义两个单独的模式：一个要索引的数据和另一个要输出的数据？这将是一个巨大的优势，因为我不喜欢索引我不会用于搜索的数据的方法。并且可以通过查询来说出想要输出哪个“可输出”参数吗？

另外，我想知道是否可以在输出之前格式化数据（例如，取一个表示秒的整数并将其格式化为 HH:MM 格式）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T16:04:35.290

您可以将**indexed=true**和**stored=true**属性添加到[schema.xml](http://wiki.apache.org/solr/SchemaXml)中的字段。然后您的字段将被索引和存储，这意味着您可以根据需要获得输出。

# ruby-on-rails - nginx 位置指令

> ID：13497061
> 
> 赞同：-1
> 
> 时间：2012-11-21T15:56:56.760
> 
> 标签：ruby-on-rails, nginx, location, passenger

我有一个带有 rails 应用程序的 nginx 服务器。我的 nginx.conf 是

```
server {
      listen 80;
      server_name nerto.it;
      root /var/www/current/public; 
      passenger_enabled on;

    location /m {
        passenger_enabled off;
        index index.html index.php;
        try_files $uri $uri/ /m/index.html?q=$uri;
    }
...
} 
```

它可以工作，除了 nerto.it/mprove 或 nerto.it/mtry 之类的地址

其中首字母是 /m 和 nginx 采用这个地址，如 nerto.it/m

我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T16:45:32.153

```
location /m/ {
    passenger_enabled off;
    index index.html index.php;
    try_files $uri $uri/ /m/index.html?q=$uri;
} 
```

或者

```
location = /m {
    ...
} 
```

从您的问题中不清楚您期望什么行为。

请阅读文档： http: [//nginx.org/r/location](http://nginx.org/r/location)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-21T16:32:21.950

我认为你应该这样尝试：

```
location ~* ^/m(.*) { 
```

> 正则表达式是通过在它们前面加上“~*”前缀（用于不区分大小写的匹配）或“~”前缀（用于区分大小写的匹配）来指定的。

[nginx 位置指令](http://nginx.org/en/docs/http/ngx_http_core_module.html#location)

# php - 我想要一个用于拖放的javascript，它在拖放时替换拖动的数据

> ID：13497064
> 
> 赞同：0
> 
> 时间：2012-11-21T15:56:39.847
> 
> 标签：php, javascript, jquery

我在这里使用一个简单的java脚本进行拖放脚本是

```
$(function() {
  $( "#sortable" ).sortable({
    revert: true
  });

  $( ".draggable" ).draggable({
    connectToSortable: "#sortable",
    helper: "clone",
    revert: "invalid",
  });

  $( "ul, li " ).disableSelection();
}); 
```

但是我想制作一个应用程序来显示一些可以拖动的图像，但是当该图像被拖放到可拖放区域时，它将显示与图像有关的不同内容，这些内容可以是纯文本、图像、链接等. 他们将通过我的 php 数据库来。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T16:02:24.330

您有一个方法“receive(event, ui)”，您应该使用它来执行此行为。

```
<script>
$(function() {
    $( "#sortable" ).sortable({
        revert: true,
        receive : function(event, ui) {
            $(ui.item).replaceWith($('<div>').text('blabla'));
        }
    });

    $( ".draggable" ).draggable({
        connectToSortable: "#sortable",
        helper: "clone",
        revert: "invalid",

    });
    $( "ul, li " ).disableSelection();
});
</script> 
```

# ruby-on-rails - Rails 3 + Twitter Bootstrap + SASS 设置

> ID：13497065
> 
> 赞同：1
> 
> 时间：2012-11-21T15:57:07.300
> 
> 标签：ruby-on-rails, sass, bootstrap-sass

我正在尝试追踪一些棘手的交互。这是场景：

*   我正在使用 sass-twitter-bootstrap github repo。我已将完整的 scss 文件集复制到我的 assets/twitter 目录中

当我的 application.css 看起来像这样时：

```
*= require_self
*= require twitter/bootstrap
*= require_tree . 
```

刷新主页会给我这个错误：

```
Undefined variable: "$baseLineHeight".
  (in /Volumes/MonsterHD/mydev/repsurv/app/assets/stylesheets/twitter/_accordion.scss) 
```

当我的 application.css 看起来像这样时：

```
*= require_self
*= require twitter/bootstrap 
```

然后我没有收到错误，但我的 custom.css.scss 没有应用。

我的 custom.css.sccs 看起来像这样：

```
@import "twitter/bootstrap";

/* universal */
html {
  overflow-y: scroll;
}
body {
  padding-top: 60px;
}
section {
  overflow: auto;
}
textarea {
  resize: vertical;
}
.center {
  text-align: center;
}
.center h1 {
  margin-bottom: 10px;
}

#logo {
  float: left;
  margin-right: 10px;
  font-size: 1.7em;
  color: #fff;
  text-transform: uppercase;
  letter-spacing: -1px;
  padding-top: 9px;
  font-weight: bold;
  line-height: 1;
}
#logo:hover {color: #fff;
  text-decoration: none;
} 
```

这是我的宝石文件：

```
source 'https://rubygems.org'

gem 'rails'
gem 'american_date'
gem 'will_paginate'
gem 'bootstrap-will_paginate'
gem 'jquery-rails'
gem 'sass-rails'

group :development, :test do
  gem 'sqlite3'
  gem 'hirb'
  gem 'pry'
  gem 'pry-rails'
end

# Gems used only for assets and not required
# in production environments by default.

group :assets do
  gem 'coffee-rails', '~> 3.2.1'
  gem 'uglifier', '>= 1.0.3'
end

group :development, :test do
    gem 'rspec-rails'
    gem 'factory_girl_rails'
end

group :test do
  gem 'capybara'
  gem 'faker'
  gem 'launchy'
end

group :production do
  gem 'pg'
end 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T17:08:14.850

你不想要`*= require_tree .`，正如你所见，需要一切。您`*= require_directory .`只需要目录根目录中的文件（即它不会下降到子目录）。

作为另一种方法，这是我在最近的项目设置中使用的，比如你的：

应用程序.css.scss：

```
/*
 *= require_self
 */

$logo_green: #3b5263;

@import 'smoothness/jquery-ui-1.8.21.custom.css';
@import 'bootstrap_and_overrides.css.scss';
@import 'content.css.scss'; 
```

bootstrap_and_overrides.css.scss：

```
// Set the correct sprite paths
$iconSpritePath: image-url('glyphicons-halflings.png');
$iconWhiteSpritePath: image-url('glyphicons-halflings-white.png');

// override bootstrap colors
$linkColor: lighten(#355c74, 10%);

@import 'bootstrap';
body { padding-top: $navbarHeight + 10px; }
@import 'bootstrap-responsive';
.... 
```

然后我的 content.css.scss 包含我所有的应用程序特定的东西。

# haskell - 自定义 Stream 类型如何影响位置信息。在秒差距？

> ID：13497074
> 
> 赞同：4
> 
> 时间：2012-11-21T15:57:05.603
> 
> 标签：haskell, parsec

我正在使用带有自定义`Stream`类型的 Parsec。这个流本质上是`String`但有时它将在字符串中找到的输入扩展为其他字符串（想想别名扩展）。例如，给定“§4.1 ¶3”，它可能会向解析器提供“第 4.1 节第 3 段”。

我有这一切工作。我的类型看起来像：

```
data DealiasingStream = ...
instance (Monad m) => Stream DealiasingStream m Char where ...

type ShellParser = Parsec DealiasingStream () 
```

请注意，依赖类型`DealiasingStream`是 just `Char`。这允许我的解析器（好吧，我`ShellParser`的 s 使用所有标准字符解析器。

我的问题是关于让 Parsec 根据我的流的原始输入报告位置。的文档`Stream`说：

> 一个`Stream`实例负责在流状态中维护“流中的位置” `s`。除非您以非平凡的方式使用 monad，否则这是微不足道的。

事实上，我的流类型知道它想在任何给定时刻报告什么位置......但我不知道如何让 Parsec 使用它！Parsec 似乎将其自身`SourcePos`作为其内部`State`. 这似乎是由各种`token`prim 更新的，因此对于标准`Char`解析器来说，这是我无法控制的。

一个人应该如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T22:43:55.657

我同意你的理解——如果不重写诸如`char`.

文档的意思是`Stream`实例负责记录令牌*内的位置信息。*然后，该信息可以用于类似`token`or的函数`tokenPrim`（通过向它们提供适当的位置计算函数）。

因此，您必须包装`Char`到包含位置信息的数据类型中，并使用类似于位置计算的`token`或灵活的原语重写基本函数。`tokenPrim`

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-21T17:20:16.823

`SourcePos`您可以使用 in 中的函数创建一个新的`Text.Parsec.Pos`，并使用 in 将其设置到解析器`setPosition`中`Text.Parsec.Prim`。

编辑：

我不确定您为什么需要自定义流，因为您没有更改令牌类型。您应该能够使用标准解析器，并在您的规则`Char`中执行扩展和位置更新。`whitespace`我已经使用`cpp`扩展宏来完成此操作，并使用自定义`whitespace`规则来查找命令`#line`，我使用它来更新位置`setPosition`。您可以使用它来查找扩展，并通过将扩展添加到 来修改输入流`getInput`，然后使用 . 将结果设置回解析器`setInput`。的文档`setInput`建议将其用于扩展`#include`指令，这本质上是相同的问题。

# c++ - 带有 MFC 的 C++ 中的功能安装样式树控件

> ID：13497075
> 
> 赞同：1
> 
> 时间：2012-11-21T15:57:47.040
> 
> 标签：c++, windows, mfc, treeview

参考此安装程序控件：![安装程序](../Images/66a869fe695e63167d44d82f251312c4.png)

我的问题是：这个下拉按钮样式树控件是否可用于 MFC 应用程序中的其他目的？

我的怀疑（在使用 Spy++ 检查后）是它是一个高度定制的 SysTreeView32，使用看起来像按钮的宽图标，并且在这些图标上的鼠标单击被拦截以显示下拉菜单。

有人知道更好吗？

# android - AVD 管理器的问题 - 它无法启动

> ID：13497076
> 
> 赞同：1
> 
> 时间：2012-11-21T15:57:49.633
> 
> 标签：android, avd

我有一个烦人的问题，即 AVD Manager.exe 无法启动。当我按下图标时，指挥官出现然后立即关闭，并给出消息：“未能执行工具\android.bat错误2。系统找不到指定的文件”。当我尝试通过“设备”窗口从 Eclipse 打开它时，它显示：“Adb 连接错误：现有连接被远程主机强行关闭”。

奇怪的是，当我运行我的应用程序时，它会打开我正在使用的最后一个虚拟设备，但我只能打开这个，所以我无法检查我的应用程序是否在其他 android 版本或具有不同规格的设备上运行。我的主要问题是我根本无法打开 AVD 管理器，而且我无法选择要在其上运行我的应用程序的虚拟设备。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-21T19:41:02.033

点击.../SDK/tools/android.bat 如果这个文件被执行你的sdk没有错误否则你必须重新安装SDK

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-21T23:10:51.940

在卸载 SDK 之前，请确保`AVD Manager.exe`并且位于Android SDK`SDK Manager.exe`的目录中。`sdk`如果它们已经存在，您可能需要重新安装 SDK。

这上周发生在我身上，移动 exe 解决了这个问题。由于某种原因，安装 Android Studio 时 AVD Manager 和 SDK Manager 不在正确的目录中。

# c# - 单击一次静默更新检查始终检查应用程序更新

> ID：13497077
> 
> 赞同：2
> 
> 时间：2012-11-21T15:57:19.600
> 
> 标签：c#, wpf, clickonce

我已经在我的 WPF 应用程序中实现了一个静默更新程序，以检查更新并在后台静默安装它们。

我没有**选中**（项目属性->发布->更新...->“应用程序应该检查更新”）但是在发布时它每次都会重新检查自己！

当我使用`CheckForUpdate(false)`我的应用程序时，永远不会静默更新，但是它将“UpdateAvailable”标志设置为 true，因此在下次启动时，我会看到“应用更新或跳过”提示。

当我使用`CheckForUpdateAsync()`我的应用程序时，它会静默更新，一切都很好。我说几乎是因为启动后，该应用程序冻结了。大概是因为它正在检查更新，因为（项目属性->发布->更新...->“应用程序应该在应用程序启动后检查更新”）

为什么要重新检查自己，我该如何禁用它？

**[更新]**

只是运行一些测试，我删除了对项目属性的调用`CheckForUpdateAsync()`并取消选中项目属性 -> 发布 -> 更新... -> “应用程序应在应用程序启动后检查更新”）。所以绝对不应该进行更新？在与 Fiddler 核对后，仍然会调用检查更新，这怎么可能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-06-13T17:57:45.860

至于原来的问题，我发现当我在应用程序的发布设置页面中使用“立即发布”按钮进行更新时，“应用程序应该检查更新”设置没有像使用“发布”时那样设置从项目上下文菜单中。

我正在使用 VS2013，虽然这可能是一个错误，但有这个解决方法。

# templates - SharePoint Word 模板中央存储库

> ID：13497079
> 
> 赞同：0
> 
> 时间：2012-11-21T15:57:51.107
> 
> 标签：templates, sharepoint, ms-word, save

我必须构建这样的东西：

我们所有的 Word 模板都保存在一个中央 SharePoint 站点（文档库）中。对于每一位客户，我们都有一个专用的共享点工作区。在工作区中应该有一个视图、webpart 或类似的东西，其中应该显示来自中央模板库的所有文件。模板文件不应位于客户工作区中。

当用户在此视图 webpart 中单击 word 模板时，文档应以 word 打开，当用户编辑和保存文档时，应将其保存在客户工作区中（不提示输入路径）。

我知道 Content Types 可能会解决这个问题，但这对于我们的意图来说太复杂了。

在打开文档应该保存的位置时是否有可能影响词？像 URL 中的参数？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T00:55:17.917

相反，文档类型是您能够毫发无损地摆脱这种混乱的唯一方法。

对于每个“模板”，您可以创建一个“站点内容类型”。您将能够将该内容类型的 url 设置为主站点中的“模板文档”。

然后，客户站点文档库将能够创建一个“新”文档，它将默认为他们从中单击数据的库。请参阅 [更改列表或库的内容类型](http://office.microsoft.com/en-nz/sharepoint-server-help/change-a-content-type-for-a-list-or-library-HA010173454.aspx#BM1)

# javascript - 如何处理状态 302？

> ID：13497080
> 
> 赞同：4
> 
> 时间：2012-11-21T15:57:20.893
> 
> 标签：javascript, redirect, xmlhttprequest

当我使用下面的代码从我的服务器执行一个简单的*XML HTTP 请求时*

```
var targetUrl = "http://server/Service1.svc?input1=uno&input2=duo";
document.getElementById("console").innerHTML += "<br>commencing";

var xhr = new XMLHttpRequest();
xhr.onload = function () {
  document.getElementById("console").innerHTML += "<br>callbacking";
  alert(xhr.responseText);
}

xhr.open("GET", targetUrl);
document.getElementById("console").innerHTML += "<br>finishing";

xhr.send(); 
```

我在 FireBug 的控制台中得到状态码 302。根据[这篇 W3 文章](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html)，状态码 302 表示资源被临时重定向。我不能完全确定这对我来说意味着什么，因为当我在 FireFox 中输入我的 URL 时，我得到了应有的响应，看起来很棒。

关于这个问题有很多文章，但我无法直截了当。例如，[这个](https://stackoverflow.com/questions/12420686/how-to-correctly-deal-with-302-status-code)只是重申了状态码的定义。[这个](https://stackoverflow.com/questions/6299021/ajax-and-status-302)建议使用*HEAD*而不是*GET*但在我的情况下这不是一个选项（除非绝对必要）。[这里](https://stackoverflow.com/questions/7524039/problems-with-xmlhttprequest-status-302)甚至声称状态代码 302会**自动**导致正确重定向到页面移动到的位置（导致状态代码 200），在我的情况下这不是真的。

我试过看，`xhr.getRespoonseHeader("Content-Type")`但显然，它是`null`.

我被困住了。我能做些什么来解决我的问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T17:23:12.027

看起来您的服务器是：

*   将非 www 重定向`http://`到 www`http://www.`
*   将不安全的 HTTP 重定向`http://`到安全的 HTTPS`https://`

在您的网络浏览器中，查看`http://server/Service1.svc?input1=uno&input2=duo`并观察地址栏。它有任何改变吗？检查是否`www`已添加，或`https`.

您还可以将您的 javascript URL 更改为 www 版本和 https 版本，以查看是否可以修复它。

**编辑**：根据您对https的说法，我认为它将http重定向到https。您的 ajax 代码不正确，因此这将解释为什么回调不起作用。

您需要使用`onreadystatechange`事件（不是 onload）并检查状态`4`，这意味着它已完成：

```
xhr.onreadystatechange = function(){
    if(xhr.readyState == 4){
            document.getElementById("console").innerHTML += "<br>callbacking";
            alert(xhr.responseText);
    }
}
xhr.open("GET", targetUrl, true);
xhr.send(null); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T21:04:40.050

它可能与 IIS 服务器上的一些内部重定向有关。我还会检查该服务是否安装在应用程序池中。

此外，它可能类似于协议切换或域歧义（即安全/不安全的 http 和/或带有/sans w3 前缀）。

# c++ - 使用#defines、枚举值还是const ints来定义常量值会更好吗？

> ID：13497084
> 
> 赞同：0
> 
> 时间：2012-11-21T15:58:09.557
> 
> 标签：c++

> **可能重复：**
> [我应该使用#define、enum 还是 const？](http://stackoverflow.com/questions/112433/should-i-use-define-enum-or-const)

最近我发现使用枚举值来定义常量很方便，但我很想知道使用 const ints、#defines 与常量的枚举值的优缺点是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T16:01:28.413

我相信使用`#define`for 常量是 C 的遗物，因为在 C 中并不总是有 `const`关键字。现在您可以使用`const int`，并且应该使用。至于`enum`，C++11 提供了一些`enum`值得一试的简洁功能，如果您要拥有多个以某种方式相关的常量，它们可能比任何东西都更适合您的需求。

# spring - JSF bean 和可序列化问题

> ID：13497086
> 
> 赞同：3
> 
> 时间：2012-11-21T15:57:37.363
> 
> 标签：spring, jsf, jsf-2

我对使用 Spring 托管服务的 JSF bean 有疑问。我收到一条错误消息，JSF bean 中使用的 spring bean 不可序列化。

```
@ManagedProperty("#{customerService}")
private CustomerService customerService; 
```

我无法使服务可序列化，因为它正在使用`JdbcTemplate`它本身不可序列化。此外，序列化具有应用程序范围的 Spring bean 根本没有意义，所以我不明白为什么有人的代码试图序列化它们。

我用Spring服务与JSF项目合作过，没有这样的问题，所以这样的合作一定是可能的。但是这个项目是基于示例项目从零开始做的，所以spring-JSF合作的配置肯定有问题，但是不知道去哪里找。

Spring for JSF 的配置是：

```
<!-- JSF and Spring are integrated -->
<application>
    <el-resolver>
        org.springframework.web.jsf.el.SpringBeanFacesELResolver
    </el-resolver>
</application> 
```

如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T15:05:03.807

没有办法避免 JSF 序列化迷雾。甚至 ApplicationScoped bean 也被序列化（当它们被注入到其他 bean 中时）。

但是解决方案是在 Spring 方面提出的。您必须使用**作用域代理**。

要将 bean 包装到可序列化代理中，您必须添加到 bean 主体：

```
<aop:scoped-proxy proxy-target-class="true"/> 
```

`spring-aop`必须添加spring aop 命名空间和依赖项。

```
http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd 
```

就是这样！在 bean 中将是可序列化元素，代理将在反序列化时从 Spring 上下文重新加载 bean。

这里唯一的迷雾是我必须创建**cglib**类级代理。JRE 代理不起作用，因为在反序列化期间接口不可用......我不完全理解为什么，但至少我有工作解决方案。

# asp.net-web-api - Web API 参数绑定

> ID：13497089
> 
> 赞同：3
> 
> 时间：2012-11-21T15:57:43.997
> 
> 标签：asp.net-web-api

我在 Web Api 控制器中有这个动作：

```
public Data GetData(ComplexModel model) 
```

模型是

```
class ComplexModel
{
     Guid Guid1 { get; set;}
     Guid Guid2 { get; set;}
     string String1 { get; set;}
} 
```

我想为 Guid 类型指定自定义绑定器，例如空字符串或 null 将绑定到空 guid 并且不想使用可为空的类型。试图像这样注册模型活页夹：

```
var pb = configuration.ParameterBindingRules;
pb.Insert(0, typeof(Guid), param => param.BindWithModelBinding(new GuidBinder())); 
```

但它没有被调用，我得到无效的模型状态，错误消息是空字符串不能转换为类型 Guid。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-21T16:17:25.830

请记住，`ParameterBindingRules`检查控制器操作参数本身（`ComplexModel`在您的情况下），*而不是*参数的内容。您需要针对自定义绑定器注册参数绑定`ComplexModel`并使用自定义绑定器进行任何处理以验证模型实例。`Guid`尽管您不愿意这样做，但似乎您最好将属性设置为空。

# ms-access - 如何按菜单类型对 MS Access 2010 对象进行聚类？

> ID：13497091
> 
> 赞同：0
> 
> 时间：2012-11-21T15:58:22.833
> 
> 标签：ms-access

我记得以前版本的 Access 对每种对象类型都有单独的菜单，例如，所有表都列在一个菜单中，视图（查询）列在另一个菜单中，等等。

出于某种原因，最新的 Access 以分层方式组织它们，列出表并在基于该表的每个表视图下：

```
Table1
--View1 (off of Table1)
--View2 (off of Table1)
Table2
--View3 (off of Table2)
--View4 (off of Table2)
etc. 
```

我不喜欢那样看我的数据库对象，我希望它们按类型聚集，就像世界上所有其他数据库客户端组织对象视图一样。

知道我是否可以配置 Access 以列出按类型聚集的对象。例如

```
Tables
-----------
Table1
Table2
Tabls3

Views
------------
View1
View2
etc. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T16:15:28.627

您可以从下拉列表中选择订单。所示的选择是您需要的简单列表。我怀疑您当前的选择是表格和相关视图。

![访问 2010 对象顺序](../Images/36a3009668fff720d186c85423a4dcd5.png)

# android - 复选框单击 ListView

> ID：13497092
> 
> 赞同：2
> 
> 时间：2012-11-21T15:57:50.847
> 
> 标签：android, android-listview, onclicklistener, android-checkbox

我有一个带有一些文本和一个复选框的列表视图。我可以单击复选框，然后检查更改，但是当我尝试侦听正在更改的检查或单击时，侦听器永远不会触发。

我在 Activity 中有列表视图（不是 ListActivity）

schedule.xml 布局：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical"
    android:id="@+id/schedulerLayout">
<LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:orientation="horizontal"
        android:gravity="center"
        android:paddingBottom="10dp">
    <LinearLayout
            xmlns:android="http://schemas.android.com/apk/res/android"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:gravity="center"
            android:orientation="horizontal">
        <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:id="@+id/currentHours"
                android:textSize="50dp"/>
        <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:textSize="50dp"
                android:text=":"/>
        <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:id="@+id/currentMinutes"
                android:textSize="50dp"/>
    </LinearLayout>
    <LinearLayout
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:gravity="center_vertical"
            android:orientation="vertical">
        <!--vertical filler for am/pm display -->
        <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"/>
        <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:id="@+id/ampm"/>
    </LinearLayout>
    <LinearLayout
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:gravity="center_vertical"
            android:paddingLeft="10dp"
            android:orientation="vertical">
        <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:id="@+id/currentDayOfWeek"/>
        <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:id="@+id/currentDate"/>
    </LinearLayout>
</LinearLayout>

<Button
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:id="@+id/scheduleButton"
        android:text="@string/newSchedule"/>
<View
        android:layout_width="fill_parent"
        android:layout_height="1dip"
        android:background="#FFFFFFFF"/>

<ListView
        android:id="@+id/scheduler_list_view"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:focusable="false"
        android:focusableInTouchMode="false"/>
</LinearLayout> 
```

schedulerow.xml：

```
<?xml version="1.0" encoding="utf-8"?>

<RelativeLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_alignParentTop="true">
<TextView
        android:id="@+id/scheduleListTitle"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:textStyle="bold"
        android:layout_alignParentTop="true"
        android:text="Title"/>

<TextView
        android:id="@+id/scheduleListDays"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_below="@id/scheduleListTitle"
        android:text="Days"/>
<TextView
        android:id="@+id/scheduleListMonths"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_below="@id/scheduleListDays"
        android:text="Months"/>
<View
        android:id="@+id/schedulerSeparator"
        android:layout_width="fill_parent"
        android:layout_height="1dip"
        android:background="#FFFFFFFF"
        android:layout_below="@id/scheduleListMonths"/>
<CheckBox
        android:id="@+id/scheduleCheckBox"
        android:layout_width="wrap_content"
        android:layout_height="fill_parent"
        android:focusable="false"
        android:focusableInTouchMode="false"
        android:clickable="true"
        android:layout_above="@id/schedulerSeparator"
        android:layout_alignParentRight="true"
        android:layout_centerVertical="true"/>
<TextView
        android:id="@+id/scheduleListTime"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_toLeftOf="@id/scheduleCheckBox"
        android:text="Time"/>
</RelativeLayout> 
```

我正在填写这样的数据：

```
SimpleAdapter adapter = new SimpleAdapter(this,
            data,
            R.layout.schedulerow,
            new String[] {"Title","Time","Day", "Month"},
            new int[] { R.id.scheduleListTitle, R.id.scheduleListTime,R.id.scheduleListDays, R.id.scheduleListMonths});

listView.setAdapter(adapter); 
```

如果我尝试向复选框添加一个侦听器，它什么也不做。有什么建议么？我查看了大量示例代码和类似问题，但似乎都不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T16:39:32.570

一种解决方案是忘记列表项单击侦听器，并为复选框以外的其余项目使用另一个侦听器。在项目布局 xml 中，将其他视图放在单个布局中并在此设置单击侦听器并设置检查侦听器像往常一样在复选框上。两者都可以正常工作。不要使用列表项单击侦听器。

```
class MySimpleAdapter extends SimpleAdapter {
 ... 
   @Override
   void getView(.....) {
       View view = super.getView(.....);
       view.findViewById(R.id.checkboxid).setOnCheckChangedListner(checklistener);
       view.findViewById(R.id.restOfitemview).setOnClickListner(clickListner);
       return view;
    }
} 
```

定义两个监听器并设置如上图。

编辑：首先尝试您的方法（阻止焦点在复选框上），`MySimpleAdapter`仅设置 checkchangelistener .. 如果这不起作用，则使用上述划分项目布局的解决方案。

# java - jScrollPane setVisible 不起作用

> ID：13497097
> 
> 赞同：6
> 
> 时间：2012-11-21T15:58:39.390
> 
> 标签：java, swing, jtable, jscrollpane

我有一个显示按钮来显示`JTable`点击，但表格不可见。注意：当我删除`JScrollPane`代码正常工作但表的标题没有显示，所以请帮助使此代码正常工作而不删除`JScrollPane`

```
 import java.awt.event.ActionEvent;
        import java.awt.event.ActionListener;

        import javax.swing.JButton;
        import javax.swing.JFrame;
        import javax.swing.JScrollPane;
        import javax.swing.JTable;
        import javax.swing.table.DefaultTableModel;

        public class Training extends JFrame {

            public Training() {

                getContentPane().setLayout(new FlowLayout());
                JTable table = new JTable();
                table.setModel(new DefaultTableModel(new Object[][] { { "joe", "joe" },
                        { "mickel", "mickel" }, }, new String[] { "LastName",
                        "FirstName" }));
                final JScrollPane pane = new JScrollPane(table);
                pane.setVisible(false);
                getContentPane().add(pane);

                JButton btn = new JButton("show");
                add(btn);
                btn.addActionListener(new ActionListener() {

                    @Override
                    public void actionPerformed(ActionEvent e) {
                        // TODO Auto-generated method stub
                        pane.setVisible(true);
                    }
                });
            }

            public static void main(String[] args) {
                Training app = new Training();
                app.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                app.setSize(600, 600);
                app.setVisible(true);
            }
        } 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-21T16:01:57.200

`pane.setVisible(true);`添加以下内容后：

```
getContentPane().validate();
getContentPane().repaint(); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-21T16:55:55.443

需要注意的几点：

*   永远不要不必要地扩展`JFrame`类，否则您可能需要扩展另一个非常必要的类，但在 java 中，单个类可能不会*扩展*多个其他类（无多重继承）。

*   始终通过块在[Event Dispatch Thread](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/dispatch.html)上创建 Swing 组件。`SwingUtilities.invokeLater(Runnable r)`

*   在设置可见之前不要使用`setSize(..)` 呼叫`JFrame#pack()``JFrame`

*   不需要`getContentPane.add(..)`or `getContentPane().setLayout(..)`，只需调用`add(..)`or实例`setLayout(..)`，`JFrame`因为这些调用会发送到*contentPane*。

*   您遇到的问题是在设置窗格可见后您没有*刷新框架/容器。*我不同意@Dan。不要使用`validate()`(`getContentPane()`也不是必需的) 而不是：

    ```
    revalidate();
    repaint(); 
    ```

作为`revalidate()`封面`validate()`。`JComponent`当 new被添加到可见组件时也使用 validate ，而`revalidate()`在`JComponent`从可见组件中删除/添加时使用。

这是实现上述代码的固定版本：

![在此处输入图像描述](../Images/046ccdbfbf42012891c5b40de09aa1f2.png)

按下按钮后：

![在此处输入图像描述](../Images/9cb4818877fb9d99cf61afcbf3571c81.png)

```
import java.awt.FlowLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JScrollPane;
import javax.swing.JTable;
import javax.swing.SwingUtilities;
import javax.swing.table.DefaultTableModel;

public class Training {

    private JFrame frame;

    public Training() {
        frame = new JFrame();
        frame.setLayout(new FlowLayout());
        JTable table = new JTable();
        table.setModel(new DefaultTableModel(new Object[][]{{"joe", "joe"},
                    {"mickel", "mickel"},}, new String[]{"LastName",
                    "FirstName"}));
        final JScrollPane pane = new JScrollPane(table);
        pane.setVisible(false);
        frame.add(pane);

        JButton btn = new JButton("show");
        frame.add(btn);

        btn.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent e) {
                pane.setVisible(true);

                frame.pack();//this is so the frame will resize after adding pane
                frame.revalidate();
                frame.repaint();
            }
        });

        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.pack();
        frame.setVisible(true);
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                new Training();
            }
        });
    }
} 
```

**更新：**

同样为了更可重用`Layout`，为什么不将所有组件添加到 a`JPanel`中，然后将其添加`JPanel`到 中`JFrame`，因此如果您需要添加更多东西，它很简单。

# ios - UICollectionView 作为 TableViewCell 的子视图

> ID：13497099
> 
> 赞同：0
> 
> 时间：2012-11-21T15:58:06.323
> 
> 标签：ios, collections, html

我需要一个关于我想为 iPhone 应用程序实现的东西的建议。

实际上，我想要的是能够`TableView`使用引擎提供的特定模板动态填充 a （清楚吗？...）

为此，我希望我`TableViewCell`的每`TableView`一个都是`UICollectionView`.

例如 ：

我想在我的单元格中显示一个图像、一个标题和一个副标题（我知道我可以通过使用 a 来做到这一点`UITableViewCellStyleSubtitle`，但是当我有更复杂的东西要显示时，它就无法使用了）。

为此，我想要`UICollectionView`每列有 2 列和 2 行。第一项（图像）将放置在 0,0 上，并带有 2 colSpan（以获取整个列）。1,0 上的第二项（标题）和 1,1 上的第三项（副标题）。我还希望集合视图项目的大小正确。

所以2个问题：

1）这是使用 a 的好方法`UICollectionView`，还是有更简单的方法？

2) 如何在 a 中指定行和列以及 colspan 和 rowspan `UICollectionView`？

非常感谢您的回答:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T16:22:43.007

一个集合视图对此是多余的。只需定义一个带有自定义子视图的单元格。如果需要，您可以在填充单元格时调整它们的大小。你还没有说最复杂或最简单的布局是什么，所以我不能提供任何更具体的建议。

# android - 在android中通过蓝牙进行多连接

> ID：13497103
> 
> 赞同：1
> 
> 时间：2012-11-21T15:58:15.133
> 
> 标签：android, android-layout, android-emulator, bluetooth, android-contentresolver

Hy，我们正在通过蓝牙开发安卓多人游戏。这是一款多人 LUDO 游戏，其中 4 名玩家相互连接并玩游戏。

我们被困在第 3 和第 4 玩家连接上。

```
private OnMaxConnectionsReachedListener maxConnectionsListener = new OnMaxConnectionsReachedListener() {
    public void OnMaxConnectionsReached() {

    }
};

private OnIncomingConnectionListener connectedListener = new OnIncomingConnectionListener() {
    public void OnIncomingConnection(String device) {
        //rivalDevice = device;
        if(index < 1000)
        {
            clients[index] = device;
            index++;
            Log.d("Khawar", "Khawar"+device);
            if(index == 1)
            {
                //blue.setText(clients[0]);
                mConnection.sendMessage(clients[0], "ConnectionList--Ludofyp309509--"+server+"--Ludofyp309509--"+clients[0]);
            }
            else if(index == 2)
            {
                //blue.setText(clients[0]);
                //red.setText(clients[1]);
                mConnection.sendMessage(clients[0], "ConnectionList--Ludofyp309509--"+server+"--Ludofyp309509--"+clients[0]+"--Ludofyp309509--"+clients[1]);
                mConnection.sendMessage(clients[1], "ConnectionList--Ludofyp309509--"+server+"--Ludofyp309509--"+clients[0]+"--Ludofyp309509--"+clients[1]);
            }
            else if(index==3)
            {
                //blue.setText(clients[0]);
                //red.setText(clients[1]);
                //yellow.setText(clients[2]);
                mConnection.sendMessage(clients[0], "ConnectionList--Ludofyp309509--"+server+"--Ludofyp309509--"+clients[0]+"--Ludofyp309509--"+clients[1]+"--Ludofyp309509--"+clients[2]);
                mConnection.sendMessage(clients[1], "ConnectionList--Ludofyp309509--"+server+"--Ludofyp309509--"+clients[0]+"--Ludofyp309509--"+clients[1]+"--Ludofyp309509--"+clients[2]);
                mConnection.sendMessage(clients[2], "ConnectionList--Ludofyp309509--"+server+"--Ludofyp309509--"+clients[0]+"--Ludofyp309509--"+clients[1]+"--Ludofyp309509--"+clients[2]);
            }
        }
        //Toast.makeText(getBaseContext(), "Client found" + device , Toast.LENGTH_LONG).show();
      //  WindowManager w = getWindowManager();
      //  Display d = w.getDefaultDisplay();
       // int width = d.getWidth();
        //int height = d.getHeight();
    }
};

private OnConnectionLostListener disconnectedListener = new OnConnectionLostListener() {
    public void OnConnectionLost(String device) {
        class displayConnectionLostAlert implements Runnable {
            public void run() {
                Builder connectionLostAlert = new Builder(self);

                connectionLostAlert.setTitle("Connection lost");
                connectionLostAlert
                        .setMessage("Your connection with the other player has been lost.");

                connectionLostAlert.setPositiveButton("Ok", new OnClickListener() {
                    public void onClick(DialogInterface dialog, int which) {
                        finish();
                    }
                });
                connectionLostAlert.setCancelable(false);
                try {
                connectionLostAlert.show();
                } catch (BadTokenException e){
                    Log.v("TAG", "Exception throws here");
                }
            }
        }
        self.runOnUiThread(new displayConnectionLostAlert());
    }
};

private OnConnectionServiceReadyListener serviceReadyListener = new OnConnectionServiceReadyListener() {
    public void OnConnectionServiceReady() {
        if (mType == 0) {
            mConnection.startServer(1, connectedListener, maxConnectionsListener,
                    dataReceivedListener, disconnectedListener);
            self.setTitle("LudoOverAndroid: " + mConnection.getName() + "-" + mConnection.getAddress());
            server = mConnection.getAddress();
            green.setText(server);
            Log.v("1", server);
      //      Intent Game = new Intent(self, Board.class);
            // .putExtra("TYPE", 1);
        //     startActivity(Game);

        } else {

            self.setTitle("LudoOverAndroid: " + mConnection.getName() + "-" + mConnection.getAddress());
            Intent serverListIntent = new Intent(self, ServerListActivity.class);
            startActivityForResult(serverListIntent, SERVER_LIST_RESULT_CODE);
            clients[index] = mConnection.getAddress();
         //   Intent Game = new Intent(self, Board.class);
            // .putExtra("TYPE", 1);
         //    startActivity(Game);

        }
    }
}; 
```

以上是建立连接的示例代码。但是在 Connection Services 类中，我们有以下代码

```
 public int connect(String srcApp, String device) throws RemoteException {
        if (mApp.length() > 0) {
            Log.v("a", "connection service->connect->mApp.length");
            return Connection.FAILURE;
        }
        mApp = srcApp;
        BluetoothDevice myBtServer = mBtAdapter.getRemoteDevice(device);
        BluetoothSocket myBSock = null;
        Log.v("a", "Yaah aya hay aik baar nahe bar bar :");
        for (int i = 0; i < Connection.MAX_SUPPORTED && myBSock == null; i++) {
            for (int j = 0; j < 3 && myBSock == null; j++) {
                myBSock = getConnectedSocket(myBtServer, mUuid.get(i));
                if (myBSock == null) {
                    try {
                        Log.v("a", "connection service->connect->myBSock==NULL thread sleep");
                        Thread.sleep(200);
                    } catch (InterruptedException e) {
                        Log.e(TAG, "InterruptedException in connect", e);
                    }
                }
            }
        }
        if (myBSock == null) {
            Log.v("a", "connection service->connect->myBSock==NULLss");
            return Connection.FAILURE;
        }
        mBtSockets.put(device, myBSock);
        mBtDeviceAddresses.add(device);
        Thread mBtStreamWatcherThread = new Thread(new BtStreamWatcher(device));
        mBtStreamWatcherThread.start();
        mBtStreamWatcherThreads.put(device, mBtStreamWatcherThread);
        return Connection.SUCCESS;
    } 
```

移动设备与第三或第四设备连接时返回 myBSock==null。但如果代码正常工作，它必须返回设备的地址，并应添加 mBtDeviceAddresses.add(device); 进入服务器列表。

请帮助我们解决问题。

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-22T10:25:37.760

```
package com.switching.bluetooth;

import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;
import java.util.ArrayList;
import java.util.UUID;

import android.bluetooth.BluetoothAdapter;
import android.bluetooth.BluetoothDevice;
import android.bluetooth.BluetoothServerSocket;
import android.bluetooth.BluetoothSocket;
import android.content.Context;
import android.os.Bundle;
import android.os.Handler;
import android.os.Message;
import android.util.Log;

import com.switching.ServerMainActivity;

/**
 * This class does all the work for setting up and managing Bluetooth
 * connections with other devices. It has a thread that listens for incoming
 * connections, a thread for connecting with a device, and a thread for
 * performing data transmissions when connected.
 */
public class BluetoothService {
    // Debugging
    private static final String TAG = "BluetoothService iBT";
    private static final boolean D = true;

    // Name for the SDP record when creating server socket
    private static final String NAME = "i BT";

    // Unique UUID for this application
    private static UUID MY_UUID;

    // Member fields
    private final BluetoothAdapter mAdapter;
    private final Handler mHandler;
    private AcceptThread mAcceptThread;
    private ConnectThread mConnectThread;
    private ConnectedThread mConnectedThread;
    private int mState;

    private ArrayList<String> mDeviceAddresses;
    private ArrayList<String> mDeviceNames;
    private ArrayList<ConnectedThread> mConnThreads;
    private ArrayList<BluetoothSocket> mSockets;

    /**
     * A bluetooth piconet can support up to 7 connections. This array holds 7
     * unique UUIDs. When attempting to make a connection, the UUID on the
     * client must match one that the server is listening for. When accepting
     * incoming connections server listens for all 7 UUIDs. When trying to form
     * an outgoing connection, the client tries each UUID one at a time.
     */
    private ArrayList<UUID> mUuids;

    // Constants that indicate the current connection state
    public static final int STATE_NONE = 0; // we're doing nothing
    public static final int STATE_LISTEN = 1; // now listening for incoming
                                                // connections
    public static final int STATE_CONNECTING = 2; // now initiating an outgoing
                                                    // connection
    public static final int STATE_CONNECTED = 3; // now connected to a remote
                                                    // device

    /**
     * Constructor. Prepares a new BluetoothChat session.
     * 
     * @param context
     *            The UI Activity Context
     * @param handler
     *            A Handler to send messages back to the UI Activity
     */
    public BluetoothService(Context context, Handler handler) {
        mAdapter = BluetoothAdapter.getDefaultAdapter();
        mState = STATE_NONE;
        mHandler = handler;

        initializeArrayLists();

        // 7 randomly-generated UUIDs. These must match on both server and
        // client.
        // mUuids.add(UUID.fromString("b7746a40-c758-4868-aa19-7ac6b3475dfc"));
        // mUuids.add(UUID.fromString("2d64189d-5a2c-4511-a074-77f199fd0834"));
        // mUuids.add(UUID.fromString("e442e09a-51f3-4a7b-91cb-f638491d1412"));
        // mUuids.add(UUID.fromString("a81d6504-4536-49ee-a475-7d96d09439e4"));
        // mUuids.add(UUID.fromString("aa91eab1-d8ad-448e-abdb-95ebba4a9b55"));
        // mUuids.add(UUID.fromString("4d34da73-d0a4-4f40-ac38-917e0a9dee97"));
        // mUuids.add(UUID.fromString("5e14d4df-9c8a-4db7-81e4-c937564c86e0"));
    }

    public static UUID getMY_UUID() {
        return MY_UUID;
    }

    public static void setMY_UUID(UUID mY_UUID) {
        MY_UUID = mY_UUID;
    }

    public boolean isDeviceConnectedAtPosition(int position) {
        if (mConnThreads.get(position) == null) {
            return false;
        }
        return true;
    }

    private void initializeArrayLists() {
        mDeviceAddresses = new ArrayList<String>(5);
        mDeviceNames = new ArrayList<String>(5);
        mConnThreads = new ArrayList<ConnectedThread>(5);
        mSockets = new ArrayList<BluetoothSocket>(5);
        mUuids = new ArrayList<UUID>(5);

        for (int i = 0; i < 5; i++) {
            mDeviceAddresses.add(null);
            mDeviceNames.add(null);
            mConnThreads.add(null);
            mSockets.add(null);
            mUuids.add(null);
        }

        Log.i(TAG, "mConnThreads.size() in Service Constructor--"
                + mConnThreads.size());
    }

    public ArrayList<String> getmDeviceNames() {
        return this.mDeviceNames;
    }

    public void setmDeviceNames(ArrayList<String> mDeviceNames) {
        this.mDeviceNames = mDeviceNames;
    }

    public ArrayList<String> getmDeviceAddresses() {
        return mDeviceAddresses;
    }

    public void setmDeviceAddresses(ArrayList<String> mDeviceAddresses) {
        this.mDeviceAddresses = mDeviceAddresses;
    }

    /**
     * Set the current state of the chat connection
     * 
     * @param state
     *            An integer defining the current connection state
     */
    private synchronized void setState(int state) {
        if (D)
            Log.d(TAG, "setState() " + mState + " -> " + state);
        mState = state;

        // Give the new state to the Handler so the UI Activity can update
        mHandler.obtainMessage(ServerMainActivity.MESSAGE_STATE_CHANGE, state,
                -1).sendToTarget();
    }

    /**
     * Return the current connection state.
     */
    public synchronized int getState() {
        return mState;
    }

    /**
     * Start the chat service. Specifically start AcceptThread to begin a
     * session in listening (server) mode. Called by the Activity onResume()
     */
    public synchronized void start() {
        if (D)
            Log.d(TAG, "start");

        // Cancel any thread attempting to make a connection
        if (mConnectThread != null) {
            mConnectThread.cancel();
            mConnectThread = null;
        }

        // Cancel any thread currently running a connection
        if (mConnectedThread != null) {
            mConnectedThread.cancel();
            mConnectedThread = null;
        }

        // Start the thread to listen on a BluetoothServerSocket
        if (mAcceptThread == null) {
            mAcceptThread = new AcceptThread();
            mAcceptThread.start();
        }
        setState(STATE_LISTEN);
    }

    /**
     * Start the ConnectThread to initiate a connection to a remote device.
     * 
     * @param device
     *            The BluetoothDevice to connect
     */
    public synchronized void connect(BluetoothDevice device,
            int selectedPosition) {

        if (getPositionIndexOfDevice(device) == -1) {
            if (D)
                Log.d(TAG, "connect to: " + device);

            // Cancel any thread attempting to make a connection
            if (mState == STATE_CONNECTING) {
                if (mConnectThread != null) {
                    mConnectThread.cancel();
                    mConnectThread = null;
                }
            }

            // Cancel any thread currently running a connection
            if (mConnThreads.get(selectedPosition) != null) {
                mConnThreads.get(selectedPosition).cancel();
                // mConnectedThread = null;
                mConnThreads.set(selectedPosition, null);
            }

            // Create a new thread and attempt to connect to each UUID
            // one-by-one.
            try {

                // String
                // s="00001101-0000-1000-8000"+device.getAddress().split(":");
                ConnectThread mConnectThread = new ConnectThread(device,
                        UUID.fromString("00001101-0000-1000-8000-"
                                + device.getAddress().replace(":", "")),
                        selectedPosition);
                Log.i(TAG, "uuid-string at server side"
                        + ("00001101-0000-1000-8000" + device.getAddress()
                                .replace(":", "")));
                mConnectThread.start();
                setState(STATE_CONNECTING);
            } catch (Exception e) {
            }
        } else {
            Message msg = mHandler
                    .obtainMessage(ServerMainActivity.MESSAGE_TOAST);
            Bundle bundle = new Bundle();
            bundle.putString(ServerMainActivity.TOAST,
                    "This device " + device.getName() + " Already Connected");
            msg.setData(bundle);
            mHandler.sendMessage(msg);
        }
    }

    /**
     * Start the ConnectedThread to begin managing a Bluetooth connection
     * 
     * @param socket
     *            The BluetoothSocket on which the connection was made
     * @param device
     *            The BluetoothDevice that has been connected
     */
    public synchronized void connected(BluetoothSocket socket,
            BluetoothDevice device, int selectedPosition) {
        if (D)
            Log.d(TAG, "connected");
        /*
         * // Cancel the thread that completed the connection if (mConnectThread
         * != null) { mConnectThread.cancel(); mConnectThread = null; }
         * 
         * // Cancel any thread currently running a connection if
         * (mConnectedThread != null) { mConnectedThread.cancel();
         * mConnectedThread = null; }
         * 
         * // Cancel the accept thread because we only want to connect to one //
         * device if (mAcceptThread != null) { mAcceptThread.cancel();
         * mAcceptThread = null; }
         */
        // Start the thread to manage the connection and perform transmissions
        ConnectedThread mConnectedThread = new ConnectedThread(socket);
        mConnectedThread.start();
        // Add each connected thread to an array
        mConnThreads.set(selectedPosition, mConnectedThread);

        // Send the name of the connected device back to the UI Activity
        Message msg = mHandler
                .obtainMessage(ServerMainActivity.MESSAGE_DEVICE_NAME);
        Bundle bundle = new Bundle();
        bundle.putString(ServerMainActivity.DEVICE_NAME, device.getName());
        msg.setData(bundle);
        mHandler.sendMessage(msg);
        setState(STATE_CONNECTED);
    }

    /**
     * Stop all threads
     */
    public synchronized void stop() {
        if (D)
            Log.d(TAG, "stop");
        if (mConnectThread != null) {
            mConnectThread.cancel();
            mConnectThread = null;
        }
        if (mConnectedThread != null) {
            mConnectedThread.cancel();
            mConnectedThread = null;
        }
        if (mAcceptThread != null) {
            mAcceptThread.cancel();
            mAcceptThread = null;
        }

        for (int i = 0; i < 5; i++) {
            mDeviceNames.set(i, null);
            mDeviceAddresses.set(i, null);
            mSockets.set(i, null);
            if (mConnThreads.get(i) != null) {
                mConnThreads.get(i).cancel();
                mConnThreads.set(i, null);
            }
        }

        setState(STATE_NONE);
    }

    /**
     * Write to the ConnectedThread in an unsynchronized manner
     * 
     * @param out
     *            The bytes to write
     * @see ConnectedThread#write(byte[])
     */
    public void write(byte[] out) {
        // When writing, try to write out to all connected threads
        for (int i = 0; i < mConnThreads.size(); i++) {
            try {
                // Create temporary object
                ConnectedThread r;
                // Synchronize a copy of the ConnectedThread
                synchronized (this) {
                    if (mState != STATE_CONNECTED)
                        return;
                    r = mConnThreads.get(i);
                }
                // Perform the write unsynchronized
                r.write(out);
            } catch (Exception e) {
            }
        }
    }

    /**
     * Indicate that the connection attempt failed and notify the UI Activity.
     */
    private void connectionFailed() {
        setState(STATE_LISTEN);
        // Send a failure message back to the Activity
        Message msg = mHandler.obtainMessage(ServerMainActivity.MESSAGE_TOAST);
        Bundle bundle = new Bundle();
        bundle.putString(ServerMainActivity.TOAST, "Unable to connect device");
        msg.setData(bundle);
        mHandler.sendMessage(msg);

    }

    /**
     * Indicate that the connection was lost and notify the UI Activity.
     */
    private void connectionLost(BluetoothDevice device) {
        // setState(STATE_LISTEN);
        int positionIndex = getPositionIndexOfDevice(device);
        if (positionIndex != -1) {
            Log.i(TAG, "getPositionIndexOfDevice(device) ==="
                    + mDeviceAddresses.get(getPositionIndexOfDevice(device)));
            mDeviceAddresses.set(positionIndex, null);
            mDeviceNames.set(positionIndex, null);
            mConnThreads.set(positionIndex, null);

            Message msg = mHandler
                    .obtainMessage(ServerMainActivity.MESSAGE_TOAST);
            Bundle bundle = new Bundle();
            bundle.putString(ServerMainActivity.TOAST,
                    "Device connection was lost from " + device.getName());
            msg.setData(bundle);
            mHandler.sendMessage(msg);
        }
        // Send a failure message back to the Activity
    }

    private class AcceptThread extends Thread {
        // The local server socket
        private final BluetoothServerSocket mmServerSocket;

        public AcceptThread() {
            BluetoothServerSocket tmp = null;
            // Create a new listening server socket
            try {

                if (mAdapter.isEnabled()) {
                    BluetoothService.setMY_UUID(UUID
                            .fromString("00001101-0000-1000-8000-"
                                    + mAdapter.getAddress().replace(":", "")));
                }
                Log.i(TAG, "MY_UUID.toString()=="
                        + BluetoothService.getMY_UUID().toString());

                tmp = mAdapter.listenUsingRfcommWithServiceRecord(NAME,
                        BluetoothService.getMY_UUID());
            } catch (IOException e) {
                Log.e(TAG, "listen() failed", e);
            }
            mmServerSocket = tmp;
        }

        public void run() {
            if (D)
                Log.d(TAG, "BEGIN mAcceptThread" + this);
            setName("AcceptThread");
            BluetoothSocket socket = null;
            Log.i(TAG, "mState in acceptThread==" + mState);
            // Listen to the server socket if we're not connected
            while (mState != STATE_CONNECTED) {
                try {
                    // This is a blocking call and will only return on a
                    // successful connection or an exception
                    socket = mmServerSocket.accept();
                } catch (IOException e) {
                    Log.e(TAG, "accept() failed", e);
                    break;
                }

                // If a connection was accepted
                if (socket != null) {
                    synchronized (BluetoothService.this) {
                        switch (mState) {
                        case STATE_LISTEN:
                        case STATE_CONNECTING:
                            // Situation normal. Start the connected thread.
                            connected(socket, socket.getRemoteDevice(),getAvailablePositionIndexForNewConnection(socket.getRemoteDevice()));
                            break;
                        case STATE_NONE:
                        case STATE_CONNECTED:
                            // Either not ready or already connected. Terminate
                            // new socket.
                            try {
                                socket.close();
                            } catch (IOException e) {
                                Log.e(TAG, "Could not close unwanted socket", e);
                            }
                            break;
                        }
                    }
                }
            }
            if (D)
                Log.i(TAG, "END mAcceptThread");
        }

        public void cancel() {
            if (D)
                Log.d(TAG, "cancel " + this);
            try {
                mmServerSocket.close();
            } catch (IOException e) {
                Log.e(TAG, "close() of server failed", e);
            }
        }
    }

    /**
     * This thread runs while listening for incoming connections. It behaves
     * like a server-side client. It runs until a connection is accepted (or
     * until cancelled).
     */
    // private class AcceptThread extends Thread {
    // BluetoothServerSocket serverSocket = null;
    //
    // public AcceptThread() {
    // }
    //
    // public void run() {
    // if (D)
    // Log.d(TAG, "BEGIN mAcceptThread" + this);
    // setName("AcceptThread");
    // BluetoothSocket socket = null;
    // try {
    // // Listen for all 7 UUIDs
    // serverSocket = mAdapter.listenUsingRfcommWithServiceRecord(
    // NAME, MY_UUID);
    // socket = serverSocket.accept();
    // if (socket != null) {
    // String address = socket.getRemoteDevice().getAddress();
    // mSockets.add(socket);
    // mDeviceAddresses.add(address);
    // mDeviceNames.add(socket.getRemoteDevice().getName());
    // // connected(socket, socket.getRemoteDevice());
    // }
    // } catch (IOException e) {
    // Log.e(TAG, "accept() failed", e);
    // }
    // if (D)
    // Log.i(TAG, "END mAcceptThread");
    // }
    //
    // public void cancel() {
    // if (D)
    // Log.d(TAG, "cancel " + this);
    // try {
    // serverSocket.close();
    // } catch (IOException e) {
    // Log.e(TAG, "close() of server failed", e);
    // }
    // }
    // }

    /**
     * This thread runs while attempting to make an outgoing connection with a
     * device. It runs straight through; the connection either succeeds or
     * fails.
     */
    private class ConnectThread extends Thread {
        private final BluetoothSocket mmSocket;
        private final BluetoothDevice mmDevice;
        private UUID tempUuid;
        private int selectedPosition;

        public ConnectThread(BluetoothDevice device, UUID uuidToTry,
                int selectedPosition) {
            mmDevice = device;
            BluetoothSocket tmp = null;
            tempUuid = uuidToTry;
            this.selectedPosition = selectedPosition;
            // Get a BluetoothSocket for a connection with the
            // given BluetoothDevice
            try {
                tmp = device.createRfcommSocketToServiceRecord(uuidToTry);
            } catch (IOException e) {
                Log.e(TAG, "create() failed", e);
            }
            mmSocket = tmp;
        }

        public void run() {
            Log.i(TAG, "BEGIN mConnectThread");
            setName("ConnectThread");

            // Always cancel discovery because it will slow down a connection
            mAdapter.cancelDiscovery();

            // Make a connection to the BluetoothSocket
            try {
                // This is a blocking call and will only return on a
                // successful connection or an exception
                mmSocket.connect();
            } catch (IOException e) {
                // if
                // (tempUuid.toString().contentEquals(mUuids.get(6).toString()))
                // {
                connectionFailed();
                // }
                // Close the socket
                try {
                    mmSocket.close();
                } catch (IOException e2) {
                    Log.e(TAG,
                            "unable to close() socket during connection failure",
                            e2);
                }
                // Start the service over to restart listening mode
                BluetoothService.this.start();
                return;
            }

            // Reset the ConnectThread because we're done
            synchronized (BluetoothService.this) {
                mConnectThread = null;
            }
            mDeviceAddresses.set(selectedPosition, mmDevice.getAddress());
            mDeviceNames.set(selectedPosition, mmDevice.getName());
            // Start the connected thread
            connected(mmSocket, mmDevice, selectedPosition);
        }

        public void cancel() {
            try {
                mmSocket.close();
            } catch (IOException e) {
                Log.e(TAG, "close() of connect socket failed", e);
            }
        }
    }

    /**
     * This thread runs during a connection with a remote device. It handles all
     * incoming and outgoing transmissions.
     */
    private class ConnectedThread extends Thread {
        private final BluetoothSocket mmSocket;
        private final InputStream mmInStream;
        private final OutputStream mmOutStream;

        public ConnectedThread(BluetoothSocket socket) {
            Log.d(TAG, "create ConnectedThread");
            mmSocket = socket;
            InputStream tmpIn = null;
            OutputStream tmpOut = null;

            // Get the BluetoothSocket input and output streams
            try {
                tmpIn = socket.getInputStream();
                tmpOut = socket.getOutputStream();
            } catch (IOException e) {
                Log.e(TAG, "temp sockets not created", e);
            }

            mmInStream = tmpIn;
            mmOutStream = tmpOut;
        }

        public void run() {
            Log.i(TAG, "BEGIN mConnectedThread");
            byte[] buffer = new byte[1024];
            int bytes;

            // Keep listening to the InputStream while connected
            while (true) {
                try {
                    // Read from the InputStream
                    bytes = mmInStream.read(buffer);
                    // Send the obtained bytes to the UI Activity
                    mHandler.obtainMessage(
                            ServerMainActivity.MESSAGE_READ,
                            bytes,
                            getPositionIndexOfDevice(mmSocket.getRemoteDevice()),
                            buffer).sendToTarget();
                    Log.i("**********read", "read Called........");
                } catch (IOException e) {
                    Log.e(TAG, "disconnected", e);
                    connectionLost(mmSocket.getRemoteDevice());
                    break;
                }
            }
        }

        /**
         * Write to the connected OutStream.
         * 
         * @param buffer
         *            The bytes to write
         */
        public void write(byte[] buffer) {
            try {
                mmOutStream.write(buffer);

                // Share the sent message back to the UI Activity
                mHandler.obtainMessage(ServerMainActivity.MESSAGE_WRITE, -1,
                        -1, buffer).sendToTarget();
            } catch (IOException e) {
                Log.e(TAG, "Exception during write", e);
            }
        }

        public void cancel() {
            try {
                mmSocket.close();
            } catch (IOException e) {
                Log.e(TAG, "close() of connect socket failed", e);
            }
        }
    }

    public int getPositionIndexOfDevice(BluetoothDevice device) {
        for (int i = 0; i < mDeviceAddresses.size(); i++) {
            if (mDeviceAddresses.get(i) != null
                    && mDeviceAddresses.get(i).equalsIgnoreCase(
                            device.getAddress()))
                return i;
        }
        return -1;
    }

    public int getAvailablePositionIndexForNewConnection(BluetoothDevice device) {      
        if (getPositionIndexOfDevice(device) == -1) {
            for (int i = 0; i < mDeviceAddresses.size(); i++) {
                if (mDeviceAddresses.get(i) == null) {
                    return i;
                }
            }
        }
        return -1;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T20:46:11.913

经过大量工作后，我成功地实现了这一点，在路径中我遇到了一些棘手的错误，例如，我必须实现握手协议（类似的东西[）](http://en.wikipedia.org/wiki/Handshaking)以避免连接尝试期间出现超时问题。

好吧，我开始研究 BluetoothChat 示例（Android SDK 示例），它实现了 2 个设备之间的通信。因此，我对其进行了修改，以允许多个连接。随着代码变大，我只会告诉你我使用的方法。

基本上，运行我的应用程序的所有设备都可以是服务器或客户端。所以每一个，总是有一个BluetoothServerSocket(AcceptThread)在运行，这样，每一个设备总是能够接收到一个请求连接。

想要连接的设备启动 ConnectThread，该线程在发现过程之后启动，或者如果它[使用 getBondedDevices](http://developer.android.com/reference/android/bluetooth/BluetoothAdapter.html#getBondedDevices%28%29)选择 PairedDevices 的 BluetoothDevice 。

建立连接后，我创建一个表示该连接的新 Thread(ConnectedThread)。如果你想有不同的行为取决于你的设备角色（主或从）你可以有一个 ConnectedThread 子类，如 MasterThread 和 SlaveThread

Android 文档很好地解释了如何使用蓝牙：http: [//developer.android.com/guide/topics/connectivity/bluetooth.html](http://developer.android.com/guide/topics/connectivity/bluetooth.html)

# wpf - 如何在 Telerik WPF RadChart 中删除以千为单位的金额？

> ID：13497104
> 
> 赞同：0
> 
> 时间：2012-11-21T15:58:56.223
> 
> 标签：wpf, telerik, bar-chart, radchart

使用 RadChart 在运行时通过数据集将相同的数据分配给数据库查询的结果。

通过代码 (vb.net) 创建了常规条形图所需的系列和其他设置。

**问题：** 当数值为千时，数值用“K”表示。示例：如果值为 1658，则条形显示 1.66 K。

**问题：**   如何去掉“K”的值，并表示得到不变的数字？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T17:23:21.413

您可以尝试以下删除它

```
RadChart1.DefaultView.ChartArea.LabelFormatBehavior = LabelFormatBehavior.None; 
```

有关更多选项，请参阅此[链接](http://www.telerik.com/help/silverlight/t_telerik_windows_controls_charting_labelformatbehavior.html)，我希望这会有所帮助。

# ios - 如何处理位置服务弹出警报上的“取消”按钮

> ID：13497109
> 
> 赞同：1
> 
> 时间：2012-11-21T15:59:20.053
> 
> 标签：ios, cllocationmanager

我在我的应用程序中使用位置服务。当我在位置服务开启的情况下运行应用程序时，一切都很完美。但是，如果我在全局范围内关闭位置服务，然后返回应用程序。它给我一个弹出窗口，说“打开位置服务以允许确定您的位置”，并带有两个按钮“设置”和“取消”。

如果我点击设置，它会将我带到设置应用程序（如预期的那样）。但如果我点击“取消”，什么也不会发生。我的应用程序无法获取事件并且它冻结，等待发生某些事情。如果我在那之后触发其他一些使用当前位置的事件，那么它会获得授权失败，并且应用程序变得正常。

为了处理这种行为，我想检测“取消”按钮上的触摸事件。有没有办法做到这一点。因为我认为这个弹出是由操作系统而不是 SDK 处理的。

如果我错了，请纠正我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-25T20:38:31.720

This is where to detect the touch event on "Cancel" button:

```
- (void)locationManager:(CLLocationManager *)manager didFailWithError:(NSError *)error{

} 
```

Probably, Your implementation of it, causes the freezes (And not the iOS). Try and use this empty implementation just to make sure...

# php - 如何创建谷歌子章节？

> ID：13497115
> 
> 赞同：0
> 
> 时间：2012-11-21T15:58:48.330
> 
> 标签：php, html, webserver

如何在我的网站上为 Google 创建这样的子章节：

![新闻页面的 Google 子章节](../Images/f512b54791a405e75ec4fba5df83452e.png)

这是 HTML 还是特定于服务器的东西？以及如何在我自己的主页上制作这个？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T16:02:31.583

它们被称为附加链接，而您却没有。[谷歌会自动执行此操作，但前提是他们认为它对用户有用](http://support.google.com/webmasters/bin/answer.py?hl=en&answer=47334)- 通常仅在高流量网站上。

通过 Google 网站管理员工具，您可以*阻止*某些页面出现在这些建议中，但您无法启用/添加任何页面。

# wordpress - Wordpress - 用户在登录时被带到特定的受保护页面

> ID：13497116
> 
> 赞同：0
> 
> 时间：2012-11-21T15:59:28.830
> 
> 标签：wordpress, passwords

我通常在 Wordpress 中设置网站，而不是一个完整的初学者。不过，我也绝对没有高级编程技能。这是我被要求设置的内容：

我需要建立一个站点，以便人们可以登录并查看与他们相关的技术图纸。每个客户都有自己的受保护页面，其中仅包含他们的图纸。理想情况下，他们会在登录时直接进入该页面。而且，他们将能够访问该站点的一般公共部分，但不能访问包含其他客户图纸的其他受保护“用户页面”。

这是任何现有插件都可以实现的吗？Wordpress 是否甚至适合这种网站（同样，这是我习惯使用的，这就是为什么我正在寻找适合它的解决方案）。

感谢您的任何意见。我希望我的措辞没问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T16:07:19.303

我没有使用它，但是[这个插件](http://codecanyon.net/item/privatecontent-multilevel-content-plugin/1467885?ref=LCweb)看起来可以满足你的需要。

> **PrivateContent**它是一个简单快速的解决方案，通过添加多级登录、私人区域、用户私人页面和用户管理功能来启动您的 wordpress 网站。它易于使用，不需要任何脚本知识！

# c# - 导出两个泛型类型的实例

> ID：13497117
> 
> 赞同：0
> 
> 时间：2012-11-21T15:59:42.867
> 
> 标签：c#, .net, inversion-of-control, mef

也许我对自己太苛刻了，但我真的很想知道这一点。我有一个非常顽皮的构造函数，所以我想我可以使用 MEF 让我的生活变得简单。但我是不对的。我真的用过谷歌，但我发现的和这个相比什么都没有。

我有一个这样的构造函数：

```
public BussinesProcessLoader(ILoader<List<Resource>> resourceLoader, ILoader<List<Project>> projectsLoader)
{
    this.resourceLoader = resourceLoader;
    this.projectsLoader = projectsLoader;
} 
```

现在我想使用 MEF 并让它像这样组成 BussinesProcessLoader：

```
new BussinesProcessLoader(new Loader<List<Resource>>(new Projects.Deserializer.ResourceDeserializer(), fileResolver), new Loader<List<Project>>(new ProjectsDeserializer(), fileResolver)) 
```

所以我发现我无法像这样导出两个类实例：

```
internal class Loader<T> : ILoader<T>
{
    public Loader(IDeserializer<T> deserializer, FileResolver fileResolver)
    {
        this.Deserializer = deserializer;
        this.FileResolver = fileResolver;
    }

    public IDeserializer<T> Deserializer { get; set; }

    public FileResolver FileResolver { get; set; }

    ...
} 
```

我需要两个不同的 ImportingConstructor 属性和两个带有 contractName 的 Exports ...

...并像这样修改 BussinesProcessLoader 的构造函数：

```
[ImportingConstructor]
public BussinesProcessLoader([Import("ResourceLoader")] ILoader<List<Resource>> resourceLoader, [Import("ProjectsLoader")] ILoader<List<Project>> projectsLoader)
{
    this.resourceLoader = resourceLoader;
    this.projectsLoader = projectsLoader;
} 
```

甚至有可能做到这一点吗？任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T17:32:19.570

我认为您的导出需要两个不同的具体类：

```
[Export(typeof(ILoader<List<Resource>>))]
internal class ResourceLoader : Loader<List<Resource>>
{
   [ImportingConstructor]
   public ResourceLoader(IDeserializer<List<Resource>> deserializer, FileResolver fileResolver) : base(deserializer, fileResolver)
   {
   }
}

[Export(typeof(ILoader<List<Project>>))]
internal class ProjectLoader : Loader<List<Project>>
{
   [ImportingConstructor]
   public ProjectLoader(IDeserializer<List<Project>> deserializer, FileResolver fileResolver) : base(deserializer, fileResolver)
   {
   }
} 
```

您需要向构造函数添加`[ImportingConstructor]`属性`BussinesProcessLoader`，但不需要`[Import("...")]`参数上的属性。

# c# - 从资源导入或包含 XSLT 文件

> ID：13497118
> 
> 赞同：2
> 
> 时间：2012-11-21T15:59:00.580
> 
> 标签：c#, xslt

我正在开发一个应用程序，其中使用了许多 XSL 样式表。这些样式表作为资源存储在 DLL 中。

我想将另一个样式表包含或导入到正在运行的样式表中。现在，如果包含的样式表与正在运行的样式表在同一个文件夹中，我可以完成这项工作，但我需要在*不同*的文件夹中包含一个。

```
<xsl:include href ="../Folder/transform.xslt"/> 
```

加载包含的样式表时会导致错误。服务器查看 c:\Windows\Folder\transform.xslt，显然它不存在。

任何人都可以建议我如何做到这一点？我几乎找不到关于从嵌入式资源运行转换的信息，遗憾的是，我别无选择，只能这样做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T16:29:41.800

不确定它会如何进行，但我推测它可以通过[传递自定义`XmlResolver`](http://msdn.microsoft.com/en-us/library/ms163427.aspx)来从资源中加载引用来完成。

实现一个继承[`XmlResolver`](http://msdn.microsoft.com/en-us/library/system.xml.xmlresolver.aspx)并查找资源而不是文件系统的类（这将是默认[`XmlUrlResolver`](http://msdn.microsoft.com/en-us/library/system.xml.xmlurlresolver.aspx)查找的位置）。

* * *

更新：看起来 MSDN 以前遇到过这个问题。有关如何实现自定义 XmlResolver 的示例，请参阅[http://msdn.microsoft.com/en-us/library/aa302284.aspx 。](http://msdn.microsoft.com/en-us/library/aa302284.aspx)

# javascript - 淘汰赛连接问题

> ID：13497122
> 
> 赞同：1
> 
> 时间：2012-11-21T15:59:12.633
> 
> 标签：javascript, knockout.js

我正在尝试以下操作，但它不起作用：

```
<!-- ko foreach: _Poi_Images_List -->
  <img data-bind='attr: {alt: "images/"+ PATH }'  />
<!-- /ko --> 
```

当我删除“图像/”+部分时，它可以工作，但只要我添加它。它弄乱了 javascript 而不是我想要的实际 PATH，它变成了这样：

```
<span data-bind="attr: {alt: "images/"+ PATH }" alt="images/Poi/function c(){if(0&lt;arguments.length){if(!c.equalityComparer||!c.equalityComparer(d,arguments[0]))c.I(),d=arguments[0],c.H();return this}a.U.La(c);return d}"></span> 
```

有任何想法吗？我已经检查了连接部分的这个参考，我基本上做了同样的事情： [Concatenate Strings in Knockout](https://stackoverflow.com/questions/12013594/concatenate-strings-in-knockout)

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-21T16:04:18.510

在表达式中使用它时，你必须解开 observable。将您的代码更改为：

```
<!-- ko foreach: _Poi_Images_List -->
  <img data-bind='attr: {alt: "images/"+ PATH() }'  />
<!-- /ko --> 
```

# java - hibernate-memcached 统计信息

> ID：13497123
> 
> 赞同：1
> 
> 时间：2012-11-21T15:59:17.597
> 
> 标签：java, hibernate, memcached

我最近使用 hibernate-memcached 实现将我的休眠二级缓存从 EHcache 切换到了 memcached。这对我来说真的很好。我目前遇到的问题是我创建了一个用于监控 lvl2 缓存统计信息的页面。这是使用 HibernateStats 类实现的。但是，现在我切换到 memcached，此页面显示 -1 作为每个缓存区域的计数。

我已经浏览了 memcached-hibernate 代码，实际上这些方法已经实现为始终返回 -1。我想知道是否有人对此有解决方案，或者任何一般的想法如何实现这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T07:41:27.987

您可以使用 stats 方法获取所有统计信息。

```
Map<String, String> stats = client.getStats().get(client.getStats().keySet().toArray()[0]); 
```

您可以获取有关特定键的完整数据或数据。

# objective-c - NSString 的奇怪行为 - 可能的内存问题？

> ID：13497124
> 
> 赞同：1
> 
> 时间：2012-11-21T16:00:01.587
> 
> 标签：objective-c, xcode, memory-management, nsstring

我正在单步执行我的代码，并注意到本地 NSString 变量的奇怪行为。

在随机调用包含本地 NSString 变量的方法时，数据似乎已损坏或其他东西。

这是我的代码：

```
 NSString *sourceValue = [NSString string];
    NSString *targetValue = [NSString string];

    [element attributeForName:item.target].stringValue = item.source;

    sourceValue = item.source;
    targetValue = [element attributeForName:item.target].stringValue;

    if ([item.target isEqualToString:@"hidden"])
        dynamicControl.isHidden = [sourceValue boolValue];

    if (![targetValue isEqualToString:sourceValue])
        valid = NO; 
```

请参阅下图显示变量 targetValue 保存的“损坏”数据 - 随机调用我的方法：

![在此处输入图像描述](../Images/6ca35116b1ff471b91867f1a999bec9e.png)

这也许是我下面的记忆改变了还是什么？

注意：我正在使用 ARC。

感谢您的帮助，谢谢

# pattern-matching - 未解析的弹性记录（需要知道此上下文中所有字段的名称）

> ID：13497125
> 
> 赞同：5
> 
> 时间：2012-11-21T16:00:02.370
> 
> 标签：pattern-matching, tuples, smlnj

我一直在尝试创建一个以元组列表作为参数的函数，但我不断收到错误消息：*“未解析的弹性记录（需要知道此上下文中所有字段的名称）”*我的代码是：

```
fun convert d = ( (map (#1) d) , (map (#2) d) ); 
```

这基本上是试图将一对列表转换为一对列表。我也尝试声明`d`as的类型，`:('a * 'b) list`但这导致了更多错误。我认为这与元组的未知大小有关，并且可以使用一些帮助来使其知道。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-02T22:07:33.633

我怀疑您在注释类型时遇到的问题`d`实际上只是您没有用括号包围注释，这对我有用：

```
fun convert (d : ('a * 'b) list) = ( (map (#1) d) , (map (#2) d) ) 
```

然而，这不是很好的 SML 风格。不鼓励使用`#1`,等`#2`，`#n`因为它会导致这样的问题，在这种情况下，您已经失去了类型推断为您提供的一些通常的简洁性。

相反，您可以为对定义一些显式选择函数：

```
fun first  (a, _) = a
fun second (_, b) = b

fun convert d = (map first d, map second d) 
```

*（请注意，我还从 的主体中删除了一些多余的括号`convert`，因为函数应用程序具有比元组构造更高的优先级，并且我还删除了分号，这仅在对命令式代码进行排序或将代码键入时才真正需要REPL）*

[这](http://www.cs.tufts.edu/comp/105/handouts/mlstyle.pdf)是一个非常好的标准 ML 风格指南，来自哈佛（或者可能是塔夫茨大学）的一门课程。该文档的旧版本在“要避免的常见错误”下特别提到了这一点。

> ### 避免 #1 和 #2
> 
> 一些初学者接受这样的想法，即获得一对中第二个元素的好方法`p`是写作`#2 p`。
> 
> 这种风格不是惯用的或可读的，它会混淆类型检查器。处理对的正确方法是通过模式匹配，所以
> 
> ```
> fun first (x, _) = x
> fun second (_, y) = y 
> ```
> 
> 是首选，而不是
> 
> ```
> fun bogus_first p = #1 p (* WRONG *)
> fun bogus_second p = #2 p 
> ```
> 
> （出于我不想讨论的原因，这些版本甚至不进行类型检查。）
> 
> 如果您的对或元组不是函数的参数，请使用`val`进行模式匹配：
> 
> ```
> val (x, y) = lookup_pair mumble 
> ```
> 
> 但通常您可以将匹配包含在普通的有趣匹配中。

# java - 使用 CDI 的性能影响

> ID：13497128
> 
> 赞同：9
> 
> 时间：2012-11-21T16:00:09.373
> 
> 标签：java, java-ee-6, jboss7.x, cdi, jboss-weld

我正在编写一个 Java EE 6 Web 应用程序，我注意到使用注入对象与直接创建和使用对象相比，性能会受到显着影响。每个方法调用的开销似乎约为 50 - 60 毫秒。

例如，使用非注入的 150 个方法调用大约需要 500 毫秒，而使用注入的对象 150 个方法调用需要 12,000 - 13,000 毫秒。一个数量级的差异，然后是一些。

这是平常的吗？

我在使用 Weld 处理 CDI 的 JBoss AS 7.1.1 final 上运行。

注入的对象被定义为单例 bean（通过 javax.ejb.Singleton 注释）。这可能是问题的一部分吗？还是只是 Weld 代理导致速度变慢？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-22T08:53:02.130

在优秀的 Weld 论坛的帮助下，我发现：

> 默认情况下，单例会话 bean 是事务性的（EJB 3.1 规范的第 13.3.7 节）并且需要为每个业务方法调用获取排他锁（第 4.8.5.4 和 4.8.5.5 节）。相比之下，javax.inject.Singleton 不是事务性的，也不支持容器管理的并发（主要结果是容器没有实现锁定方案）。
> 
> 如果您使用@TransactionAttribute(NOT_SUPPORTED) 和@Lock(READ) 注释您的单例会话bean，您应该会看到明显更好的性能，尽管可能仍然存在一些开销。如果您不需要 EJB 功能，请坚持使用 @ApplicationScoped（CDI 未定义 javax.inject.Singleton，因此其语义不受该规范的约束）。

[https://community.jboss.org/thread/213684?tstart=0](https://community.jboss.org/thread/213684?tstart=0)

可悲的是，即使在使用 @TransactionAttribute(NOT_SUPPORTED) 和 @Lock(READ) 注释了我的 EJB 单例之后，性能仍然很差（请参阅原始帖子的时间安排）。

因此，带回家的信息是不要注入 EJB Singleton 会话 bean，除非您绝对必须这样做，并且即便如此，您也要意识到可能会产生的性能开销。对于很少被调用的方法，它可以忽略不计，但在我们的例子中，如果它是一个频繁使用的方​​法，那么小的开销会迅速累积。

我们不需要 EJB 功能，并且在切换到 ApplicationScoped 后，调用注入 bean 的特定方法的性能得到了数量级的改进。

# sql - 更新 Oracle SQL 表中的日期

> ID：13497130
> 
> 赞同：34
> 
> 时间：2012-11-21T15:59:28.577
> 
> 标签：sql, oracle, date, peoplesoft

我正在尝试更新 SQL 表中的日期。我正在使用 Peoplesoft Oracle。当我运行此查询时：

```
Select ASOFDATE from PASOFDATE; 
```

我得到 2012 年 4 月 16 日

我尝试运行此查询

```
UPDATE PASOFDATE SET ASOFDATE = '11/21/2012'; 
```

但它不工作。

有谁知道我如何将日期更改为所需的日期？

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2012-11-21T16:11:31.360

这是基于您收到有关日期格式的错误的*假设，例如无效的月份值或预期数字时的非数字字符。*

存储在数据库中的日期没有格式。当您查询日期时，您的客户正在格式化显示日期，如`4/16/2011`. 通常，相同的日期格式用于选择和更新日期，但在这种情况下，它们看起来是不同的——因此您的客户端显然正在做一些比 SQL*Plus 更复杂的事情，例如。

当您尝试更新它时，它使用的是默认[日期格式模型](http://docs.oracle.com/cd/E11882_01/server.112/e26088/sql_elements004.htm#sthref394)。由于它的显示方式，您假设它是`MM/DD/YYYY`，但似乎不是。您可以找出它是什么，但最好不要依赖默认或任何隐式格式模型。

无论这是否是问题，您都应该始终指定日期模型：

```
UPDATE PASOFDATE SET ASOFDATE = TO_DATE('11/21/2012', 'MM/DD/YYYY'); 
```

由于您没有指定时间组件 - 所有 Oracle`DATE`列都包含时间，即使是午夜 - 您也可以使用[日期文字](http://docs.oracle.com/cd/E11882_01/server.112/e26088/sql_elements003.htm#sthref362)：

```
UPDATE PASOFDATE SET ASOFDATE = DATE '2012-11-21'; 
```

您可能应该检查当前值是否不包含时间，尽管列名表明它不包含时间。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2020-03-12T12:54:44.210

以下是设置日期和时间的方法：

```
update user set expiry_date=TO_DATE('31/DEC/2017 12:59:59', 'dd/mm/yyyy hh24:mi:ss') where id=123; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-22T13:15:40.807

如果此 SQL 正在任何 peoplesoft 特定代码（应用程序引擎、SQLEXEC、SQLfetch 等）中使用，您可以使用 %Datein metaSQL。Peopletools 自动将日期转换为运行应用程序的数据库平台可接受的格式。

如果此 SQL 用于从查询分析器（如 SQLDeveloper、SQLTools）执行后端更新，则使用的日期格式是错误的。Oracle 预计日期格式为 DD-MMM-YYYY，其中 MMM 可以是 JAN、FEB、MAR 等。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-04-06T21:00:53.980

只是添加到亚历克斯普尔的答案，这是你如何做日期和时间：

```
 TO_DATE('31/DEC/2017 12:59:59', 'dd/mm/yyyy hh24:mi:ss') 
```

# ios - Facebook iOS SDK：使用权限授权需要 2 次尝试

> ID：13497132
> 
> 赞同：4
> 
> 时间：2012-11-21T16:00:13.590
> 
> 标签：ios, facebook-ios-sdk

我有一个应用程序仍然使用已弃用的 Facebook 类与 Facebook 连接。如果我在没有扩展权限的情况下授权，一切正常。但是，如果我确实包含权限，那么第一次授权的往返总是会失败（即使它获得了有效的令牌！）。我错过了一步吗？

这是为应用程序启动 Facebook 授权的代码

```
- (IBAction) doConnect:(id)sender
{
    NSArray* permissions = [NSArray arrayWithObjects:
                            @"email",@"publish_actions",nil];
    [self.facebook authorize:permissions];
} 
```

这是在用户授予权限并将控制权返回给我的应用程序后调用的代码。该 url 总是包含一个漂亮的令牌，即使是第一次通过。

```
// handle the incoming url from app switching
- (BOOL)application:(UIApplication *)application openURL:(NSURL *)url
  sourceApplication:(NSString *)sourceApplication annotation:(id)annotation
{
    return [self.facebook handleOpenURL:url];
} 
```

这是连接成功后调用的 FBSessionDelegate 方法。尽管上面的 url 包含一个令牌，但我们第一次到达这里时它就消失了。但是如果我调用上面的 doConnect 方法，当我们到达这里时，令牌就会出现。

```
// FBSessionDelegate
- (void)fbDidLogin
{
    if( [self.facebook accessToken] == nil )
    {
        NSLog(@"Had an access token above, but not now!");

        // If I reinvade the doConnect: method again, it will work!!!
    }
    // ... 
```

}

深入查看 FBSession.m 中的 sdk 代码，似乎请求的权限第一次没有与新令牌相关联，导致会话忽略新令牌。第一次通过时，cachedPermissions 始终是一个空列表

```
 // get the cached permissions, and do a subset check
    NSArray *cachedPermissions = [tokenInfo objectForKey:FBTokenInformationPermissionsKey];
    BOOL isSubset = [FBSession areRequiredPermissions:permissions
                                 aSubsetOfPermissions:cachedPermissions]; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-15T01:58:35.510

您要求两种类型的权限，读取类型（电子邮件）和写入类型（publish_actions）。

您应该使用最新的 Facebook SDK，v3.1.1，并且您必须分开读取和写入 - 特别是如果您希望支持 iOS6。您最初只能请求读取。[请参阅https://developers.facebook.com/docs/tutorial/iossdk/upgrading-from-3.0-to-3.1/](https://developers.facebook.com/docs/tutorial/iossdk/upgrading-from-3.0-to-3.1/)中的注释以及分别请求读取和写入的部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-18T07:51:23.270

对于 Facebook SDK 3.1，使用 [FBSession activeSession] 的

```
reauthorizeWithPublishPermissions: defaultAudience:completionHandler: 
```

对于 Facebook SDK 3.2，使用 [FBSession activeSession] 的

```
requestNewPublishPermissions: defaultAudience:completionHandler: 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-22T05:08:10.203

我们可以在单个请求中授权用户。它不需要两次尝试。为此，我们需要做的是“我们需要先请求发布许可”。调用下面的方法

```
let fbLoginMngr =  FBSDKLoginManager();
fbLoginMngr.logOut()
fbLoginMngr.logInWithPublishPermissions 
```

它将首先询问个人资料详细信息，然后询问请求的发布权限。一旦我们收到回调，我们就会查询 Graph api 以提取配置文件数据，如下所示。

```
let fbRequest = FBSDKGraphRequest(graphPath:"me",    parameters:self.FB_REQ_PARAMS);
                fbRequest.startWithCompletionHandler { (connection : FBSDKGraphRequestConnection!, result : AnyObject!, error : NSError!) -> Void in
                    if error == nil {
                        debugPrint(result)
                    } else {
                        handleError(error)
                    }
                } 
```

# jquery - SVG 到 viewBox 坐标

> ID：13497135
> 
> 赞同：0
> 
> 时间：2012-11-21T16:00:31.080
> 
> 标签：jquery, svg, viewbox, jquery-svg, jqvmap

我正在使用[JQVMAP](http://jqvmap.com/)生成一些美国地图。该插件有一个 onRegionClick 回调。我正在尝试放大到此功能中的单击状态。我有点知道如何通过将返回给我的 SVG 路径 onClick 转换为 viewBox 坐标来做到这一点，但是，我在转换时遇到了问题。这是我到目前为止所拥有的。

```
<script type="text/javascript">
jQuery(document).ready(function() {
    jQuery('#vmap').vectorMap(
    {
        map: 'usa_en',
        backgroundColor: '#a5bfdd',
        borderColor: '#818181',
        borderOpacity: .50,
        borderWidth: 1,
        color: '#f4f3f0',
        enableZoom: false,
        hoverColor: '#c9dfaf',
        hoverOpacity: null,
        normalizeFunction: 'linear',
        scaleColors: ['#b6d6ff', '#005ace'],
        selectedColor: '#c9dfaf',
        selectedRegion: null,
        showTooltip: true,
        onRegionClick: function(element, code, region)
        {
            //$('#vmap > svg')[0].setAttribute('viewBox', vmlPath);
            console.log(region.path);
            console.log(region.name);
        }
    });
});
</script> 
```

[链接到现场演示](http://www.hanseninfotech.com/interactive_map/)。如何将 SVG 路径转换为 ​​viewBox 坐标？我会以正确的方式解决这个问题吗？还是有更好的方法来做到这一点？我的最终目标是放大 onRegionClick 的状态。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T09:54:18.157

您可以只使用[jVectorMap](http://jvectormap.com)，从中派生 jqvmap 。它的[API](http://jvectormap.com/documentation/javascript-api-v1/jvm-worldmap/)具有`focusOn`缩放到地图上指定区域的方法。该区域可以通过坐标或区域代码指定。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T17:05:35.317

你想要完成的事情是极其困难的。SVG 路径（尤其是您正在处理的路径的大小）很难解析。您可能从路径中解析的最有意义的东西是第一个值（值以逗号分隔）。该值将以“m”或“M”开头。小写 m 是相对起点，大写 M 是绝对起点。

话虽如此，一旦你知道路径从哪里开始，你就可以开始设置你的 viewBox。但是，您仍然不知道路径的宽度和高度（德克萨斯路径大于罗德岛路径）。因此，您可以设置 viewBox 的起点，但不知道要设置多大，解析该信息将是一场噩梦！

最好的方法是找出每个状态的 viewBox 是什么，并将其包含在`jquery.vmap.usa.js`每个状态的对象信息中。所以每个对象都有一个路径、一个名称和一个视图框。然后你可以`onRegionClick`通过调用在你的事件中获取它`region.viewBox`。

除此之外，这是我能想到的最好的：

```
var showAll = false;
    jQuery(document).ready(function () {
        jQuery('#vmap').vectorMap(
    {
        map: 'usa_en',
        backgroundColor: '#a5bfdd',
        borderColor: '#818181',
        borderOpacity: .50,
        borderWidth: 1,
        color: '#f4f3f0',
        enableZoom: false,
        hoverColor: '#c9dfaf',
        hoverOpacity: null,
        normalizeFunction: 'linear',
        scaleColors: ['#b6d6ff', '#005ace'],
        selectedColor: '#c9dfaf',
        selectedRegion: null,
        showTooltip: true,
        onRegionClick: function (element, code, region) {
            $('path').each(function () {
                if (showAll) {
                    $(this).show();
                } else {
                    $(this).hide();
                }
            });
            if (showAll) { showAll = false; } else { showAll = true; }

            var id = '#jqvmap1_' + code;
            $(id).show();
        }
    });
    }); 
```

# java - Java：使用多项式样条函数 (Apache) 将数据集加倍

> ID：13497136
> 
> 赞同：2
> 
> 时间：2012-11-21T16:00:38.787
> 
> 标签：java, arrays, interpolation, spline

我正在尝试使用[SplineInterpolator](http://commons.apache.org/math/api-2.0/org/apache/commons/math/analysis/interpolation/SplineInterpolator.html) 和[PolynomialSplineFunction](http://commons.apache.org/math/api-2.0/org/apache/commons/math/analysis/polynomials/PolynomialSplineFunction.html)将数据集加倍。我想我已经走得很远了（我可能错过了一些异常处理）：

```
SplineInterpolator splineInterp;

public double[] doubledArray(double[] y){
    double[] yy = new double[y.length*2];
    // make a double version of y w/ -1 for "null" values
    for(int i = 0; i < yy.length; i++){
        if(i%2 == 0)
            yy[i] = y[i];
        else if(i == yy.length-1)
            yy[i] = yy[0];
        else
            yy[i] = -1;
    }
    // make a corresponding x array to satisfy SplineInterpolator.interpolate
    double[] x = new double[y.length];
    for(int i = 0; i < x.length; i++)
        x[i] = i;
    splineInterp = new SplineInterpolator();
    PolynomialSplineFunction polySplineF = splineInterp.interpolate(x, y);
    for(int i = 0; i < yy.length; i++){
        if(yy[i] == -1){
            yy[i] = polySplineF.value(i);
           // breaks down halfway through polySplineF.value expects and array of y.length
        }
    }
    return yy;
} 
```

但是上面的内容最迟会在最后一个 for 循环中崩溃。那么，我的第一部分或多或少是对的吗？拥有多项式样条函数后，如何使用它来创建更大的数据集？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T21:39:44.010

万一有人在家里跟着，这是我为此提出的实现：

```
private double[] multiplyArray(double[] y){
    // An array 2 or 4 or N times bigger than the original:
    double[] yy = new double[y.length*arrayMultiplier];
    // An array representing the indices of the original:
    double[] x = new double[y.length];
    for(int i = 0; i < x.length; i++)
        x[i] = i;
    // Get and instance of SplineInterpolator:
    SplineInterpolator splineInterp = new SplineInterpolator();
    // Use that instance's interpolate() function to a PolynomialSplineFunction
    // fitting your data, points y at indices x.
    PolynomialSplineFunction polySplineF = splineInterp.interpolate(x, y);

    // Use the PolynomialSplineFunction to fill in your larger array by supplying
    // index values divided by the arrayMultiplier
    for(int i = 0; i < yy.length; i++){
        yy[i] = polySplineF.value((double)(i/arrayMultiplier));
    }
    return yy;
} 
```

如果有人需要，我还想出了如何使用可能更有用的填充空白。

# web-applications - 如何分发在我的 Jython 战争中使用的库？

> ID：13497137
> 
> 赞同：3
> 
> 时间：2012-11-21T16:00:39.083
> 
> 标签：web-applications, import, jython, web-inf

我已阅读有关在 Jython 应用程序中管理已用库的相关问题的答案：

[如何在 Jython 中安装各种 Python 库？](https://stackoverflow.com/questions/6787015/how-i-install-various-python-libraries-in-jython)

[管理 Jython 包的最佳方法](https://stackoverflow.com/questions/9493307/best-method-for-managing-jython-packages)

但我不想将这些库放在我系统上的某个位置。我想将它们与我的 Jython webapp 一起分发。似乎我曾经设法将一个库安装到我的 webapp 的 WEB-INF/lib/Lib/site-packages/ 目录中，但我不知道如何再做一次。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T04:43:26.067

对于常规的 Jython 应用程序，我已经成功使用[OneJar](http://www.jython.org/jythonbook/en/1.0/DeploymentTargets.html#deploying-a-single-jar)来打包我的所有依赖项。我没试过，但看起来你应该可以把那个统一的jar打包成一个war包。这很令人费解，但让我印象深刻的是，这些实际 Jython 问题的解决方案通常如此。作为替代方案，将 jython jar 粘贴到您的 jar 中的 /web/lib 文件夹中，然后使用 java 片段引导您的 jython 代码可能就足够了。祝你好运，我很想知道你是如何解决这个问题的。

# .htaccess - Htaccess：不断询问登录信息

> ID：13497138
> 
> 赞同：2
> 
> 时间：2012-11-21T16:00:47.120
> 
> 标签：.htaccess, login, .htpasswd

我有一个网站，但我的 Htaccess 登录有问题。我输入了用户名和密码，它一次又一次地询问。

这是我的代码：.htaccess

```
AuthUserFile /webspace/httpdocs/****doman name*****/Admin/.htpasswd
AuthGroupFile /dev/null
AuthName "Bitte Passwort eingeben"
AuthType Basic## Heading ##
<Limit GET>
require valid-user
</Limit> 
```

.htpasswd

```
admin:$apr1$vo/xlPIv$p6BGvCBGW4L6vni7ejZ 
```

谢谢任何帮助！（：

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-31T14:41:13.567

我们最终面临同样的问题。我们在服务器上安装了 Varnishd Cache。清除同样的伎俩。

如果您使用任何缓存机制，例如 Varnish Cache 或通过 nginx 或 apache 缓存进行缓存。尝试在服务器上清除相同的内容。它应该可以解决问题。

# php - php全局错误数组记录错误

> ID：13497139
> 
> 赞同：0
> 
> 时间：2012-11-21T16:00:48.297
> 
> 标签：php, exception

我正在开发一个网站，但是当转义然后将记录插入数据库时​​，我正在使用 try catch。

我想创建一个全局错误数组，如果尝试失败并捕获异常，我可以将其添加到任何异常消息中。

该数组稍后将在我的 php 页面上用于显示用户发生的错误。

我将如何创建这个数组？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T16:07:10.913

您可以创建一个像这样的通用错误处理程序：

```
// error handler function
function myErrorHandler($errno, $errstr, $errfile, $errline)
{
    if (!(error_reporting() & $errno)) {
    // This error code is not included in error_reporting
    return;
    }

    switch ($errno) {
        case E_USER_ERROR:
        echo "<b>My ERROR</b> [$errno] $errstr<br />\n";
        echo "  Fatal error on line $errline in file $errfile";
        echo ", PHP " . PHP_VERSION . " (" . PHP_OS . ")<br />\n";
        echo "Aborting...<br />\n";
        exit(1);
        break;

        case E_USER_WARNING:
        echo "<b>My WARNING</b> [$errno] $errstr<br />\n";
        break;

        case E_USER_NOTICE:
        echo "<b>My NOTICE</b> [$errno] $errstr<br />\n";
        break;

        default:
        echo "Unknown error type: [$errno] $errstr<br />\n";
        break;
    }

    /* Don't execute PHP internal error handler */
    return true;
} 
```

// 设置为用户定义的错误处理程序

```
set_error_handler("myErrorHandler"); 
```

# java - 在equals方法中避免instanceof的可行方法？

> ID：13497144
> 
> 赞同：2
> 
> 时间：2012-11-21T16:00:18.580
> 
> 标签：java, equals, instanceof

很多人不喜欢使用`instanceof`，但我发现在很多情况下，当涉及到该`equals`方法时，我们几乎没有其他选择。看看下面的课程：

```
class A {   
    int n;
    public A(int n) { this.n = n; }

    @Override
    public boolean equals(Object o) {
        return false;
    }

    public boolean equals(A o) {
        return n == o.n;
    }   
} 
```

我从来没有见过这样的事情，但它可以代替必须`instanceof`用来测试 an`Object`是否是 an`A`吗？或者还有其他我没有想到的问题？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-21T16:02:42.283

> 它可以替代必须使用 instanceof 来测试 Object 是否为 A 吗？

不，这是因为调用的方法是静态选择的，即仅`equals(object o)`在大多数情况下才会调用。

你可以写

```
@Override
public boolean equals(Object o) {
    return o instanceof A && n == ((A) o).n;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T16:04:49.230

使用的集合、Swing 组件和其他类`equals`仍将调用`equals(Object o)`版本，并且将`false`始终返回。

该示例仅在显式调用该`equals(A o)`方法时才有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T16:05:29.687

这个代码块是重载而不是覆盖equals。也不要忘记检查 o == null。instanceof 的替代方法包括 getClass().equals(other.getClass()) 和使用 A.isAssignableFrom(other.getClass())

# alloy - 合金中的对称破坏谓词

> ID：13497145
> 
> 赞同：0
> 
> 时间：2012-11-21T16:01:05.113
> 
> 标签：alloy

假设我有一个简单的模型如下： sig P{r:some P} sig Q{} run {} for 2 P, 2 Q

这里有谁知道合金如何生成对称破坏谓词以减少该模型的实例数量？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T14:59:08.883

Alloy 本身依赖于另一个名为 Kodkod 的关系模型查找器作为其后端。Kodkod 使用一种称为贪婪基础分区的技术生成对称破坏谓词，该技术在 Emina Torlak 的论文（第 3 章）中有详细说明：

[http://people.csail.mit.edu/emina/pubs/kodkod.phd.pdf](http://people.csail.mit.edu/emina/pubs/kodkod.phd.pdf)

# ios - 如何打开 iOS 设置屏幕，例如位置？

> ID：13497147
> 
> 赞同：1
> 
> 时间：2012-11-21T16:00:20.777
> 
> 标签：ios, xcode, xamarin.ios, ios6

在我的应用中，我有定位功能，但如果关闭定位，我想提示用户打开定位并给他们一个按钮点击，将他们带到 iOS 中的确切位置。这同样适用于设置/隐私/日历。

有人可以提供导航到 iOS 设备设置屏幕的诀窍吗？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T16:03:50.770

编辑：这仅适用于 5.1 之前的 iOS 版本。

向以下内容发出 URL 请求：

```
WHERE TO GO — URL TO GET THERE
About — prefs:root=General&path=About
Accessibility — prefs:root=General&path=ACCESSIBILITY
Airplane Mode On — prefs:root=AIRPLANE_MODE
Auto-Lock — prefs:root=General&path=AUTOLOCK
Brightness — prefs:root=Brightness
Bluetooth — prefs:root=General&path=Bluetooth
Date & Time — prefs:root=General&path=DATE_AND_TIME
FaceTime — prefs:root=FACETIME
General — prefs:root=General
Keyboard — prefs:root=General&path=Keyboard
iCloud — prefs:root=CASTLE
iCloud Storage & Backup — prefs:root=CASTLE&path=STORAGE_AND_BACKUP
International — prefs:root=General&path=INTERNATIONAL
Location Services — prefs:root=LOCATION_SERVICES
Music — prefs:root=MUSIC
Music  Equalizer — prefs:root=MUSIC&path=EQ
Music Volume Limit — prefs:root=MUSIC&path=VolumeLimit
Network — prefs:root=General&path=Network
Nike + iPod — prefs:root=NIKE_PLUS_IPOD
Notes — prefs:root=NOTES
Notification — prefs:root=NOTIFICATIONS_ID
Phone — prefs:root=Phone
Photos — prefs:root=Photos
Profile — prefs:root=General&path=ManagedConfigurationList
Reset — prefs:root=General&path=Reset
Safari — prefs:root=Safari
Siri — prefs:root=General&path=Assistant
Sounds — prefs:root=Sounds
Software Update — prefs:root=General&path=SOFTWARE_UPDATE_LINK
Store — prefs:root=STORE
Twitter — prefs:root=TWITTER
Usage — prefs:root=General&path=USAGE
VPN — prefs:root=General&path=Network/VPN
Wallpaper — prefs:root=Wallpaper
Wi-Fi — prefs:root=WIFI 
```

# javascript - 绘制几个图形 javascript

> ID：13497149
> 
> 赞同：0
> 
> 时间：2012-11-21T16:01:10.907
> 
> 标签：javascript, amcharts

我将使用此代码显示给定数量的图形，此类图形的数量每次都是可变的将 modifié.j '我尝试为图形数量创建一个循环，但我无法帮助

[http://jsfiddle.net/amcharts/j9gUu/](http://jsfiddle.net/amcharts/j9gUu/)

我的测试

```
 for (int i=1; i<4;i++)
   {
       var valueAxis[i] = new AmCharts.ValueAxis();
    valueAxis[i].axisColor = "#FF6600";
    valueAxis[i].axisThickness = 2;
    valueAxis[i].gridAlpha = 0;
    chart.addValueAxis(valueAxis[i]);
​ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-15T06:24:41.553

您可以操作来自服务器的数据并将它们分配给我硬编码的变量。使用它，您可以绘制多个折线图。

```
chart = new AmCharts.AmSerialChart();
chart.categoryField = "date";// whatever your horizontal axis's value
chart.startDuration = 1;

// AXES
// category
var categoryAxis = chart.categoryAxis;
categoryAxis.labelRotation = 45;
categoryAxis.autoGridCount = true;
categoryAxis.startOnAxis = true;

// Value
var valueAxis = new AmCharts.ValueAxis();
valueAxis.gridAlpha = 0.07;
valueAxis.autoGridCount = true;
valueAxis.title = "Some Title on Vertical Axis";
chart.addValueAxis(valueAxis);

    //following values hardcoded. you can assign any values you want.

var j=0;
var chartData = [[{"date":"2013 Mar","company1":0,"company2":0},{"date":"2013 Apr","company1":0,"company2":271},{"date":"2013 May","company1":0,"company2":271},{"date":"2013 Jun","company1":0,"company2":284},{"date":"2013 Jul","company1":509.9,"company2":1568}];
var no_of_companies = 2;//put your value
var color_array = your color array;//should be an array
chart.dataProvider = chartData;

for(j=0;j<no_of_companies;j++){
  var graph = new AmCharts.AmGraph();
  graph.valueField = "company"+(j+1);
  graph.balloonText = "[[category]]: [[value]]";
  graph.type = "line";
  graph.lineColor = color_array[j];
  graph.lineThickness = 2;
  chart.addGraph(graph);
}       
var chartCursor = new AmCharts.ChartCursor();
chartCursor.cursorAlpha = 0;
chartCursor.cursorPosition = "mouse";
chart.addChartCursor(chartCursor);
chart.write("chartdiv"); 
```

希望这会对你有所帮助。

# android - 是否可以在 Android 中向 TabHost 添加子项？

> ID：13497153
> 
> 赞同：0
> 
> 时间：2012-11-21T16:01:23.533
> 
> 标签：android, user-interface, tabs

点击某个项目时，是否可以将子项目添加到 Android 中的 TabHost。例如：

```
item1
item2
item3

After click on item1, we receive
item1
   item1_1
   item1_2
item2
item3 
```

谢谢。

# perl - 如何在通过 perl 脚本执行此 URL 时使用 URL 中的变量传递值

> ID：13497157
> 
> 赞同：1
> 
> 时间：2012-11-21T16:00:51.993
> 
> 标签：perl

我正在尝试通过 perl 脚本执行 URL。最初我在文本文件中保留一些值并将文件中的值设置为参数。

```
#!/usr/bin/perl
use warnings;

open my $fh, '<','output_perl.txt' or die "Failed: $!\n";
my $text1 = do {
    local $/;
    <$fh>
};
close $fh or die "Failed again: $!\n";

open my $i, '<','output_perl_1.txt' or die "Failed: $!\n";
my $text2 = do {
    local $/;
    <$i>
};
close $i or die "Failed again: $!\n";

open my $j, '<','output_perl_2.txt' or die "Failed: $!\n";
my $text3 = do {
    local $/;
    <$j>
};
close $j or die "Failed again: $!\n"; 
```

因此，当我尝试打印变量`$text1`,`$text2`时，`$text1`存储在`output_perl.txt`,`output_perl_1.txt`中 的值`output_perl_2.txt`会得到反映。这意味着如果我在下面添加它可以正常工作：

```
print $text1;
print $text2;
print $text3; 
```

但我正在运行一个我想在其中传递值的 URL `$text1/2/3`：

```
use LWP 5.64;
my $browser = LWP::UserAgent->new;
my $url = 'http://sms.apps.example.com/http/sendPlainText?$text1 $text2 $text3' 
```

URL 工作正常，但值未通过。当 URL 被执行时，我们仍然可以看到`$text1` `$text2` `$text3`，但我应该看到上面命令打印的值。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T16:13:26.257

使用双引号将变量插入字符串。当您使用单引号时，生成的字符串实际上就是您键入的内容。这适用于变量以及元字符，例如`\n`,`\t`等。

[在这里](http://perlmeme.org/howtos/using_perl/interpolation.html)阅读更多。

# gnuplot - 添加水平线直方图 gnuplot

> ID：13497160
> 
> 赞同：13
> 
> 时间：2012-11-21T16:01:53.580
> 
> 标签：gnuplot, histogram

我想在 gnuplot 的直方图中添加一条水平线，这可能吗？

我的直方图在 x 轴上有：alea1 alea 2 alea3 nalea1 nalea 2 nalea 3，y 轴从 0 到 25。

在 22 处，我想添加一条水平线，从直方图的一端一直延伸到另一端。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-21T17:00:27.953

尝试添加

```
, 22 title "" 
```

在你的情节命令结束时。适用于我的测试数据（文件“histo”）：

```
# Year  Red   Green  Blue
1990    33    45     18
1991    35    42     19
1992    34    44     14
1993    37    43     25
1994    47    15     30
1995    41    14     32
1996    42    20     35
1997    39    21     31

plot "histo" u 2 t "Red" w histograms, "" u 3 t "Green" w histograms, "" u 4 t "Blue" w histograms, 22 title "" 
```

（取自 Philip K. Janert，Gnuplot in Action）

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-11-21T17:41:14.617

添加水平和/或垂直线的典型方法是使用`arrow`

```
set arrow from x1,y1 to x2,y2 nohead linestyle ... 
```

对于水平线，y1 和 y2 将相同。从你的问题来看，我有点不确定你所说的“22 岁”是什么意思，但我猜你的意思是你想在`y=22`直方图的顶部绘制这条线。如果是这种情况，请尝试此操作（在您的`plot`命令之前）。

```
set arrow from graph 0,first 22 to graph 1,first 22 nohead lc rgb "#000000" front 
```

# c++ - 使用前向迭代器对 std::vector 进行反向迭代

> ID：13497165
> 
> 赞同：1
> 
> 时间：2012-11-21T16:02:18.320
> 
> 标签：c++

如果我有一个函数需要一个`std::vector<T>::const_iterator`被调用的开始和一个`std::vector<T>::const_iterator`被调用的结束，我是否可以向后迭代它？

**更新**

我无法更改函数签名，如下所示：

```
void func(Foo::const_iterator begin, Foo::const_iterator end) 
{
   ...
} 
```

并调用：

```
func(foo.begin(), foo.end()); 
```

我也无法改变

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T16:06:48.250

是的你可以。

```
template <typename Foo>
void test(typename Foo::const_iterator begin,
          typename Foo::const_iterator end)
{
  std::reverse_iterator<typename Foo::const_iterator>
    rbegin(end),
    rend(begin);
  std::copy(rbegin, rend, std::ostream_iterator<typename std::iterator_traits<typename Foo::const_iterator>::value_type>(std::cout));
}

int main()
{
  std::vector<int> v{3,1,4,1,5,9,2,6};
  test<std::vector<int> >(v.begin(), v.end());
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-21T16:07:29.623

我可能误解了这个问题，但你只需要：

```
while (begin != end) {
    --end;
    // do something with *end
} 
```

如果您需要一个向后的迭代器，ipc 的答案会给您一个。

在实践中，`vector`你可能会侥幸逃脱`while (begin != end--)`，但不要被诱惑。在迭代器位于向量开头的情况下（即当它等于 的结果时`vector::begin()`）递减迭代器是未定义的行为。

此代码至少需要一个 BidirectionalIterator。幸运的是，`vector`有一个 RandomAccessIterator，它更好。

如果您真的只有一个 ForwardIterator，那么您必须遍历范围并将迭代器值存储在某处（如 a `stack`），然后以相反的顺序使用它们：

```
std::stack<Foo::const_iterator> iterators;
while (begin != end) {
    iterators.push(begin);
    ++begin;
}
while (!iterators.empty()) {
    Foo::const_iterator i = iterators.top();
    // do something with *i
    iterators.pop();
} 
```

这段代码至少需要一个 ForwardIterator（它不能仅与 InputIterator 一起工作）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-21T16:12:04.667

是的，您可以使用`std::reverse_iterator`. 最好不要明确指定迭代器的类型。请改用模板参数。

```
#include <vector>
#include <algorithm>
#include <iostream>
#include <iterator>

template <typename BidirectionalIterator>
void x(BidirectionalIterator b, BidirectionalIterator e) {
  std::reverse_iterator<BidirectionalIterator> rb(e), re(b);
  std::for_each(rb, re, 
                [](typename BidirectionalIterator::reference x) 
                { std::cout << x << std::endl;});
}

int main()
{
  std::vector<int> v{1,2,3,4};
  x(begin(v), end(v));
  return 0;
} 
```

# c++ - 通过用户获取 cin 来命名输出文件

> ID：13497167
> 
> 赞同：-4
> 
> 时间：2012-11-21T16:02:18.860
> 
> 标签：c++

以下是具有输出文件的代码。如果我想每次都给这个输出文件不同的名称，即，按照用户的要求。什么样的 getline 命令会有所帮助。我知道我可以简单地输入一个字符串名称 my_file 但所需的名称在输入中而不是在字符串名称中。

```
void save(cdStruct *ptr)    //Function that saves database info to file

        {

            ofstream dataFile;

            dataFile.open("output.txt", ios::out | ios::app);

            dataFile << ptr->title << endl;

            dataFile << ptr->artist << endl;
            dataFile << ptr->numberOfSongs << endl;

            dataFile << ptr->number << endl;

            dataFile.close();

        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T16:06:15.523

你想改变这一行：

> dataFile.open("output.txt", ios::out | ios::app);

到这样的事情？？

> dataFile.open(my_name_string, ios::out | ios::app);

如果是，您只需在之前阅读此字符串，添加“.txt”即可。

检查此代码：

> 字符串名称；
> cin >名称;
> 
> name.append(".txt");
> 
> 流数据文件；
> dataFile.open(name.c_str(), ios::out | ios::app);
> 数据文件.close();

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T16:52:05.817

从您对其他答案的评论看来，您将文件名作为`std::string`to 传递`std::ofstream::open`。之前`C++11`它只接受一个`const char *`参数，而不是一个`std::string`（参见[这个参考](http://en.cppreference.com/w/cpp/io/basic_ofstream/open)）。

要将此`filename.c_str()`用作第一个参数而不是`filename`. 这将返回一个以 null 结尾的 char 数组，该类型由`std::ofstream::open`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T16:52:30.967

您的错误消息告诉以下内容：您`std::string`在某个时候应该使用`char const *`. 现在我们只需要找到错误发生的正确位置。

快速查看在线文档[`std::getline`](http://www.cplusplus.com/reference/string/getline/)告诉我们，这个功能不是问题：签名允许`std::string`. 唯一改变的是;`std::ofstream(filename, std::ios::out | std::ios::ate)`的文档[`std::ofstream`](http://www.cplusplus.com/reference/iostream/ofstream/open/)。确实一个`char const *`。

这个问题应该可以通过更换快速解决

```
std::ofstream dataFile(filename, std::ios::out | std::ios::ate); 
```

和

```
std::ofstream dataFile(filename.data(), std::ios::out | std::ios::ate); 
```

然后它应该编译。

尝试理解编译器提供给您的错误消息并搜索可能存在问题的参考，这一点非常重要。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T16:06:26.330

您的具体问题不是**“根据用户的需要提供所需的输出文件名称”**，而是**“如何在命令行程序中读取用户输入”**。为此，您可以使用`std::getline`：

```
#include <iostream>
#include <string>
int main() {
    std::string filename;
    getline(std::cin, filename);
} 
```

有人可能会想使用`operator<<`重载，

```
#include <iostream>
#include <string>
int main () {
     std::string filename;
     std::cin >> filename;
} 
```

但是，如果您的文件名包含空格字符，它们会给出错误的结果。

* * *

旁注：当你想强制非空值时，不要传递可空指针：

```
// don't: void save(cdStruct *ptr)
void save(cdStruct const &ptr) // <- ah, better 
```

# unit-testing - vstest.executionengine.x86.exe 没有关闭

> ID：13497168
> 
> 赞同：49
> 
> 时间：2012-11-21T16:02:23.580
> 
> 标签：unit-testing, testing, visual-studio-2012

我在运行单元测试时遇到了错误。如果我调试单元测试 vstest.executionengine.x86.exe 运行，然后在测试通过时关闭。

如果我只是运行测试（即使测试就像创建一个新列表一样简单，没有断言）vstest.executionengine.x86.exe 不会关闭并继续在任务管理器中运行。

在编写更复杂的测试（包括删除文件/清理 sqllite 数据库）时，这给我带来了问题。

任何帮助，将不胜感激。

编辑 ：

重现步骤 ：

*   创建新的单元测试项目
*   调试单元测试 - vstest.executionengine.x86 打开和关闭，测试通过。
*   运行单元测试 - vstest.executionengine.x86 打开并保持打开状态

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2012-12-05T05:16:10.620

这是设计使然。

仅当我们检测到两次连续测试运行之间的配置更改时，才会重新启动 vstest.executionengine.exe。这有助于确保我们不会对进程重启造成不必要的影响。

**产品更新** 对于 VS2013，我们在测试 -> 测试设置下有一个新菜单项，称为“保持测试执行引擎运行”。您可以取消选中此项以退出默认行为。

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2013-02-03T21:12:47.130

我通过使用以下作为受影响测试项目的预构建事件来解决此问题：

对于 64 位：

```
taskkill /F /IM vstest.executionengine.exe /FI "MEMUSAGE gt 1" 
```

或 32 位：

```
taskkill /F /IM vstest.executionengine.x86.exe /FI "MEMUSAGE gt 1" 
```

这会在构建测试项目之前默默地杀死执行引擎。`/FI "MEMUSAGE gt 1"`如果执行引擎未运行，则停止命令（因此构建）失败。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-05-02T22:20:15.507

不管它的价值是什么，我遇到了同样的情况，结果我有一个测试没有正确清理它的所有资源。在我的具体情况下，有一个打开网络连接的后台线程在测试退出之前没有关闭。不知道为什么退出测试并没有为我关闭它，但是当我修复我的代码以正确处理我打开的所有资源时，一切都按预期工作。我不必添加任何黑客来杀死`vstest.executionengine.exe`，也不必选择退出`Test -> Test Settings -> Keep Test Execution Engine Running`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-03-16T15:43:22.820

我在使用 Resharper 的测试运行器运行测试时遇到了这个问题，它似乎不尊重`Test-->Test Settings-->Keep Test Execution Engine Running`设置。在我的情况下，它导致构建失败并出现以下错误：

> 警告 MSB3026：无法将“...\SQLite.Interop.dll”复制到“bin\Debug\x86\SQLite.Interop.dll”。在 1000 毫秒内开始重试 10。该进程无法访问文件“bin\Debug\x86\SQLite.Interop.dll”，因为它正被另一个进程使用。

正如@HappyCat 建议的那样，向测试项目添加预构建事件对我有用。我还需要将它包装在 if 语句中，以防止它在构建服务器上运行并干扰其他作业。

```
if $(ConfigurationName) == Debug (
    echo "attempting to kill vstest to prevent access denied on sqlite.interop.dll"
    taskkill /F /IM vstest.executionengine.x86.exe /FI "MEMUSAGE gt 1"
) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-09-25T19:11:36.170

我知道这很旧，但我想我会加入我刚刚发现的东西。

我正在运行的测试中有一些已实现`IDisposable`的对象，因此代码分析告诉我我的测试类也应该如此。花了一段时间才意识到这一点，但是当`this.Dispose();`我把它放在我的测试类上时，当被调用该接口的实现时，它实际上是抛出了一个 StackOverflow 异常。所以我只是猛拉界面，让CA继续抱怨。

我不需要切换“保持测试执行引擎运行”。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-07-16T04:19:31.090

最简单的方法是去windows任务管理器。注意在后台运行的 vstest.executionengine.exe 进程。终止该进程，它现在应该可以正常工作了。

# python - 完成的干净方法 - 如果 x 在 [(0, 1, 2), (2, 0, 1), (1, 2, 0)]:?

> ID：13497170
> 
> 赞同：4
> 
> 时间：2012-11-21T16:02:32.747
> 
> 标签：python

如果不是，那么函数的规范名称？“循环”对我来说是有意义的，但这是采取的。

标题中的示例是为了清晰和简洁而编写的。我正在处理的真实案例有很多重复。（例如，我希望 [1, 1, 0, 0, 0, 2, 1] “匹配” [0, 0, 2, 1, 1, 1, 0]）

这类事情模糊了我的算法，并用其他无用的重复填充我的代码。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-21T16:04:22.187

您可以通过以下方式获取列表的周期：

```
def cycles(a):
    return [ a[i:] + a[:i] for i in range(len(a)) ] 
```

然后，您可以检查 b 是否是 a 的循环：

```
b in cycles(a) 
```

如果列表的长度很长，或者如果想要对相同的循环进行多次比较，则将结果嵌入到集合中可能是有益的（在性能方面）。

```
set_cycles = set(cycles(a))
b in set_cycles 
```

您可以通过在列表中嵌入相等性检查并使用任何方法来防止构造所有循环：

```
any( b == a[i:]+a[:i] for i in range(len(a))) 
```

您也可以通过将`cycles`函数转换为生成器来实现此效果。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-21T16:03:11.410

之前误解了你的问题。如果您想检查列表的任何循环是否与列表`l1`匹配`l2`，最好（最干净/最 Pythonic）的方法可能是`any(l1 == l2[i:] + l2[:i] for i in xrange(len(l2)))`. 还有一种`rotate`方法[`collections.deque`](http://docs.python.org/2/library/collections.html#collections.deque)可能对您有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T16:31:24.930

您可以使用`cycle`from [itertools](http://docs.python.org/2/library/itertools.html#itertools.islice)以及`islice`将其剪切。这基本上将[这个答案](https://stackoverflow.com/a/13124747/1404505)放在列表理解中，因此列表为每个元素移动一次。

```
>>> from itertools import islice, cycle
>>> l = [0,1,2]
>>> [tuple(islice(cycle(t),i,i+len(t))) for i,_ in enumerate(l)]
[(0, 1, 2), (1, 2, 0), (2, 0, 1)] 
```

# asp.net-mvc - MVC 2 - 仅在每个循环中显示第一个结果

> ID：13497173
> 
> 赞同：0
> 
> 时间：2012-11-21T16:02:46.597
> 
> 标签：asp.net-mvc, model-view-controller, asp.net-mvc-2, viewmodel

我有一个看起来相当基本的循环：

```
<% foreach (var item in Model.Items.OrderByDescending(b => b.ItemDateTime)) {%> 
```

而不是循环遍历我只想输出第一个项目的所有项目，我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T16:04:15.407

您可以使用`FirstODefault()`您的收藏方法。尝试这样的事情：

```
// check if the model contains any item
if (Model.Items.Count() > 0)
{
    //show the item...
    var firstItem = Model.Items.OrderByDescending(b => b.ItemDateTime).FirstOrDefault();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T16:36:29.050

为了扩展 Felipe 的评论，更好的设计通常是把这样的东西放在你的视图模型或控制器中，而不是视图中。

你可以把它放在你的视图模型上

```
public Item EarliestItem
{
    get { return Items.OrderByDescending(b => b.ItemDateTime).FirstOrDefault(); }
} 
```

然后在您的视图中使用它

或者你想对最早的项目做什么。

# r - 在不使用循环的情况下替换许多数据框行中的字符串

> ID：13497175
> 
> 赞同：2
> 
> 时间：2012-11-21T16:02:08.527
> 
> 标签：r

我正在对大型数据帧（几 100k 行）中的一列字符串进行替换，并且在漫长的例程中必须多次替换。我想以矢量化的方式编写它，但无法找到一种方法来做到这一点。目前我必须使用一个完整的循环，每次需要几分钟，分别遍历每一行。

我无法在功能上执行此操作的原因似乎是，对于每个行值，我需要能够在`str_extract`（或`grepl`）命令中专门引用它，而我不知道如何在没有索引的情况下执行此操作。（目标是使用 0 将每个可变长度字符串的前导数字部分填充到 6 位。条目可能看起来像“1234XYZ”。）

```
for (i in 1:nrow(df)) {

df$A[i] <- gsub("^[[:digit:]]+",
paste(paste(rep(0,6-nchar(str_extract(df$A[i],"^[[:digit:]]+"))), collapse=""), 
str_extract(df$A[i], "^[[:digit:]]+"), collapse=""), df$A[i])

} 
```

显然，我天真地尝试作为“矢量化版本”的以下内容不起作用，因为`str_extract`返回一个向量，其中每个 df 行都有一个条目：

```
df$A <- gsub("^[[:digit:]]+", 
paste(paste(rep(0,6-nchar(str_extract(df$A,"^[[:digit:]]+"))), collapse=""), 
str_extract(df$A, "^[[:digit:]]+"), collapse=""), df$A) 
```

这可以在没有循环的情况下完成吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T17:15:52.100

没有可重复的数据很难确定，但我认为这对你有用

```
front <- str_pad(str_extract(df$A, "^[[:digit:]]+"), 6, pad="0")
back  <- str_extract(df$A, "[^0-9]+")
df$A <- paste(front, back, sep="") 
```

# iphone - 后退按钮点击区域超出导航栏

> ID：13497176
> 
> 赞同：0
> 
> 时间：2012-11-21T16:02:59.717
> 
> 标签：iphone, uinavigationcontroller

我注意到导航栏后退按钮点击区域在导航栏底部下方延伸了大约 10 个像素。由于这种重叠，我在导航栏正下方有一些按钮很难点击。有没有什么办法解决这一问题？

# ruby-on-rails - 当与 ruby 一起选择特定语言时，如何使用 JavaScript 选择功能？

> ID：13497177
> 
> 赞同：2
> 
> 时间：2012-11-21T16:02:09.477
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, internationalization, selection

**我想达到什么目标**

我有一个 html 选择框。选择框负责选择首选语言。例如，如果页面显示在德国，则选择框应显示德国作为其首选项，其他语言也是如此。

**到目前为止做了什么**

在 application.html.erb 我有以下代码

```
#application.html.erb

<select name="language" onChange="location = this.options[this.selectedIndex].value;">
    <% @langs.each_pair do |short, long| %>
    <option value="/<%= short %>/<%= @rem %>" <% if short==@langu %> selected="selected"<% end %>><%= long %></option>
    <% end %>
</select> 
```

在 application_controller.rb 我有以下代码

```
#application_controller.rb
@string = request.fullpath
@langu  = @string.split("/")
@rem    = @string.split("/#{@langu[1]}/")
@langu  = @langu[1]
@rem    = @rem[1]

@langs = { :en => 'english', 
           :es => 'espaniol', 
           :de => 'germany', 
           :fr => 'french', 
           :it => 'italy' } 
```

**什么不工作**

当用户查看英语/西班牙语/德语网站**或**从列表中选择时，选择框显然应该显示特定语言。即如果英语然后英语，如果西班牙语然后espaniol 等等。这是不工作的确切事情

**什么是有效的**

如果用户从选择框中选择首选语言（比如说西班牙语），它会呈现特定页面，但是选择框显示本质上应该是`espaniol`.

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T16:22:32.213

您的字符串中只有一个小错字。它应该是`selected='selected'`，所以它应该像这样工作：

```
<select name="language" onChange="location = this.options[this.selectedIndex].value;">
<% @langs.each_pair do |short, long| %>
<option value="/<%= short %>/<%= @rem %>" <% if @short==@langu %> selected="selected"<% end %>><%= long %></option>
<% end %>
</select> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T11:15:38.463

**背景与解决方案**

好，朋友们！由于无法找到解决琐碎问题的方法而花费并敲打我的头之后。我终于设法解决了这些错误。简而言之，在 application_controller.rb 中需要更改，其中我的语言（国家）数据集值采用哈希格式，实际上需要采用数组格式（请参阅上面的哈希格式问题）。除此之外，我还必须对 application.html.erb 进行一些细微的更改，请参阅下面的工作源代码

**进行更改以使其正常工作**

*   将**哈希**格式更改为**数组**格式
*   将**each.pair**更改为仅**每个**

**IN application_controller.rb**

```
@langs = [['en','english'],
          ['es','espaniol'],
          ['de','germany'],
          ['fr','french'],
          ['it','italy']] 
```

**在 application.html.erb**

```
<select name="language" onChange="location = this.options[this.selectedIndex].value;">    
    <% @langs.each do |short, long| %>
        <option value="/<%= short %>/<%= @rem %>" <% if short==@langu %> selected="selected" <% end %>><%= long %></option>
    <% end %>
</select> 
```

**注意** 感谢大家为解决此错误所做的努力。希望这对将来的人有所帮助。

# javascript - 使用 Javascript 将一个文本字段一分为二，对其进行验证，然后再次将其合并回来

> ID：13497183
> 
> 赞同：0
> 
> 时间：2012-11-21T16:02:24.813
> 
> 标签：javascript, jquery, html, forms

客户要求将包含电话号码数据的文本字段分成两部分——一个用于国家代码，另一个用于其余号码。

唉，这个字段是相当硬编码到系统中的，到目前为止收集的所有数据都作为一个合并字段（因此保存为数据库中的一列）。

因此，我认为最好的答案可能是执行以下操作：

1.  使用 Javascript，将单个文本字段替换为两个文本字段。
2.  然后，当用户单击提交按钮时，它们会合并回原始文本字段。
3.  如果在从数据库中读取该字段时（即，当管理员查看条目时），是否有办法将该字段重新分成两个，则奖励标记。请注意，数据格式必须一致——我不想将现有的字符串数据与一堆 JSON 字符串混合在一起。

这是解决这个问题的最好方法吗？这种方法是否存在任何可预见的问题（除了用户没有启用 JavaScript）？是否有专门设计用于执行此类操作的 jQuery 插件？

我还需要在某个时候将其验证为有效的电话号码，但我自己可以弄清楚。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T16:23:52.410

您可以使用屏蔽输入 JQuery 插件，而不是将文本字段一分为二

[http://digitalbush.com/projects/masked-input-plugin/](http://digitalbush.com/projects/masked-input-plugin/)

```
$(document).ready(function(){
   $("#phone").mask("(999)999999");                
}); 
```

示例 JS：http: [//jsfiddle.net/vGeMV/3/](http://jsfiddle.net/vGeMV/3/)

编辑：对于第 3 点：如果您想真正将数字分成两部分并显示它，您可以从右侧（通常为 7 位）而不是左侧拆分它，这样即使国家代码存在与否，您也会得到正确的分裂。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T16:32:39.250

如果你不想使用插件，你可以随时查看我在[jsFiddle上制作的这个片段](http://jsfiddle.net/RVSJN/)

如果你想确保它在 JS 中工作，只需将 display:'none' 更改为 display:'block'

这是我的 JavaScript

```
$(function() {
    $('#phone').css({ display:'none' });
    $('#phone').after(') <input type="text" name="phoneMainNumber" id="phoneMainNumber" />').after('(<input type="text" value="555" name="phoneAreaCode" id="phoneAreaCode" style="width:30px;" />');
    bindChange();
});

function bindChange() {
    $('#phone').val('('+$('#phoneAreaCode').val()+') ');
    $('#phoneMainNumber, #phoneAreaCode').keyup(function() {
       $('#phone').val('('+$('#phoneAreaCode').val()+') '+$('#phoneMainNumber').val());    
    });   
} 
```

# c - 创建 dns 响应消息

> ID：13497185
> 
> 赞同：0
> 
> 时间：2012-11-21T16:02:29.073
> 
> 标签：c, dns

我想创建一个 DNS 响应以发送到我的浏览器。我在 rfc 中创建了一些结构：

```
//DNS header
struct DNS_HEADER
{
    unsigned short id; 
    unsigned char rd :1; 
    unsigned char tc :1; 
    unsigned char aa :1; 
    unsigned char opcode :4;
    unsigned char qr :1; 

    unsigned char rcode :4; 
    unsigned char cd :1;
    unsigned char ad :1; 
    unsigned char z :1;  
    unsigned char ra :1; 

    unsigned short q_count; 
    unsigned short ans_count; 
    unsigned short auth_count; 
    unsigned short add_count; 
};

#pragma pack(push, 1)
struct R_DATA
{
    unsigned short type;
    unsigned short _class;
    unsigned int ttl;
    unsigned short data_len;
};
#pragma pack(pop)

struct RES_RECORD
{
    unsigned char *name;
    struct R_DATA *resource;
    unsigned char *rdata;
}; 
```

现在我正在尝试填写这些结构，以便发送有效的 DNS 响应。我正在尝试使用 ipaddres 112.12.12.12 发送例如 www.google.com （只是为了好玩）。

这就是我所拥有的：

```
dns = (DNS_HEADER*)malloc(sizeof(DNS_HEADER));
dns->id = (unsigned short) htons(GetCurrentProcessId()); // ID 
dns->qr = 1; // We give a response, Volgens RFC: (= query (0), or a response (1).)
dns->opcode = 0; // default
dns->aa = 0; //Not Authoritative,RFC: (= Authoritative Answer - this bit is valid in responses, and specifies that the responding name server is an authority for the domain name in question section.)
dns->tc = 0; // Not truncated
dns->rd = 1; // Enable recursion
dns->ra = 0; // Nameserver supports recursion?
dns->z = 0; //  RFC: (= Reserved for future use.  Must be zero in all queries and responses.)
dns->rcode = 0; // No error condition
dns->q_count = 0; // No questions!
dns->ad = 0; // How man resource records?
dns->cd = 0; // !checking
dns->ans_count = 1; // We give 1 answer
dns->auth_count = 0; // How many authority entries?
dns->add_count = 0; // How many resource entries? 
```

但是正如您所看到的，我对要填写的内容有一些疑问。此外，我无法通过 rfc 找到 R_Data 和 res_record 我所做的随机响应要填写什么...

有人可以帮我弄这个吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T05:03:25.970

一目了然的几点提示：`id`在您的响应中需要是您在查询中收到的 id。`q_count`应该是 1 并重复您收到的查询（在您的示例中，例如`\x03www\x06google\x03com\x00\x00\x01\x00\x01`for `www.google.com IN A`）。RFC1035 第 3.4.1 节中解释了需要输入的`rdata`内容（在您的示例中是`\x70\x0c\x0c\x0c`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-11T11:53:27.813

你的方法从根本上是有缺陷的。你不能用结构体来表达DNS数据包，因为DNS数据包中的字符串是可变长度的，即字符串后面的字段在数据包中的偏移量取决于前面字符串的长度。

您的结构用字符指针代替每个字符串，每个指针通常是一个 32 位值，指向内存中的某个其他位置。因此，当您尝试发送内存中表示的结构时，您将发送或多或少的随机 32 位值来代替字符串。

这是一个关于 DNS 数据包应该是什么样子的相当说明性的指南：[http ://www.tcpipguide.com/free/t_DNSMessageProcessingandGeneralMessageFormat.htm](http://www.tcpipguide.com/free/t_DNSMessageProcessingandGeneralMessageFormat.htm)

# c# - 在没有源代码的情况下在 VS 中调试

> ID：13497199
> 
> 赞同：7
> 
> 时间：2012-11-21T16:03:56.690
> 
> 标签：c#, .net, visual-studio-2010, debugging

我需要调试一些程序集，因为它们会抛出异常。这是我的程序集，但我没有它们的源代码。我拥有的是他们的 pdb 文件。

有没有办法通过 Visual Studio 调试该程序集？

**- 编辑 -**

当然，我也可以反汇编得到它们的 *.il 文件。它会以某种方式帮助我吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2017-12-11T19:19:28.263

实际上有几种方法可以做到这一点：

1.  使用 dnSpy - 免费的开源 .net 调试器和程序集编辑器[https://github.com/0xd4d/dnSpy](https://github.com/0xd4d/dnSpy)
2.  使用 dotPeek 设置符号服务器（也是免费的）[https://www.jetbrains.com/help/decompiler/Using_product_as_a_Symbol_Server.html](https://www.jetbrains.com/help/decompiler/Using_product_as_a_Symbol_Server.html)
3.  使用 Resharper 反编译器为您的 Visual Studio 中的外部模块加载符号。我认为这是最简单的方法。我已经在我的博客[https://cezarypiatek.github.io/post/debug-without-sources-part-one/上描述了整个过程](https://cezarypiatek.github.io/post/debug-without-sources-part-one/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-21T16:15:41.253

这正是我为[Reflector](http://www.reflector.net/)付费的原因。需要调试别人的程序集？它*完美地*工作。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-21T16:13:19.520

据我所知，PDB 文件只是调试的指针。也就是说，如果您没有源代码，那么 PDB 文件只会为您提供堆栈跟踪。

我不知道 Visual Studio 是否可以处理它，您可能需要手动连接到该过程。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-21T16:07:13.117

不完全是在视觉工作室，但我过去在反射器中写了这样一个工具，叫做 d [Deblector](http://deblector.codeplex.com/)。不再由我管理，但看看。当然，调试体验与 Visual Studio 中的不同，但有时足以让您摆脱困境。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-12-11T19:27:27.347

查看 dotPeek： [https ://www.jetbrains.com/decompiler/](https://www.jetbrains.com/decompiler/)

您可以将其设置为 Visual Studio 中的符号服务器，以生成允许您调试的 PDB 文件。它非常易于使用，并且与许多付费产品一样好。

您可以直接从 nuget 添加库，或指向 DLL。

# php - 无法将字符串传递给 SQL 查询

> ID：13497201
> 
> 赞同：1
> 
> 时间：2012-11-21T16:04:04.663
> 
> 标签：php, mysql

我有以下代码：

```
 $RefEquipamento = mysql_real_escape_string($_GET['ID']);
    mysql_select_db($database_connLOOPGEST, $connLOOPGEST);
    $query_rs_equipamento = sprintf("SELECT * FROM  clientes_listaequipamentos WHERE referenciacliente = $RefEquipamento ORDER BY datacriacao_loop DESC LIMIT 1");
    $rs_equipamento = mysql_query($query_rs_equipamento, $connLOOPGEST) or die(mysql_error());
    $row_rs_equipamento = mysql_fetch_assoc($rs_equipamento);
    $totalRows_rs_equipamento = mysql_num_rows($rs_equipamento);

    echo json_encode($row_rs_equipamento); 
```

我不是 PHP 或 MySQL 方面的专家，我正在尝试学习一些东西。我正在使用 Dreamweaver。

上面的代码在我传递一个数字作为参数时有效（例如，如果 $RefEquipamento 是 200456）这工作正常，但是当我尝试传递一个字符串时（假设我正在传递字符串“equip1”这不会工作，回声给我以下信息：

“‘where 子句’中的未知列‘equip1’”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T16:05:02.840

尝试：

$RefEquipamento = "'" 。mysql_real_escape_string($_GET['ID']) 。"'"; 所以mysql会将其作为字符串处理。

或者

$query_rs_equipamento = sprintf("SELECT * FROM clientes_listaequipamentos WHERE referenciacliente = '$RefEquipamento' ORDER BY datacriacao_loop DESC LIMIT 1");

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T16:08:53.460

如果您向 MySQL 命令发送一个单词，而不用标记 --> ' <---- MySQL 了解您正在给出一个字段或列的名称。

请记住，始终需要将单词作为变量传递，您需要标记它。

数字不需要特殊标记

Yoni Hassin 回复是解决方案，将其标记为答案

# c - 如何初始化只有-1值的数组

> ID：13497203
> 
> 赞同：6
> 
> 时间：2012-11-21T16:04:12.763
> 
> 标签：c, arrays

> **可能的重复：**
> [如何在 C 中](https://stackoverflow.com/questions/201101/how-to-initialize-an-array-in-c)
> [初始化一个数组，初始化一个整数数组](https://stackoverflow.com/questions/13477281/initializing-an-array-of-ints)

我想知道将 int 数组初始化为仅包含 -1 值的最快/最简单方法。我需要的数组长 90 个整数，所以直接的方法应该是像这样初始化它：

```
int array[90]={-1, -1, -1, ...}; 
```

但我只想使用一次数组，所以我希望能够动态使用它并且能够在程序中使用它后释放它，所以我更多地寻找一种快速的方式`calloc`，但不是零，而是 -1课程。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-21T16:06:24.897

如果您使用的是 gcc，则使用[指定的初始化程序](http://gcc.gnu.org/onlinedocs/gcc-4.1.2/gcc/Designated-Inits.html)

```
int array[90] = { [ 0 ... 89 ] = -1}

int array[90],i;
for(i = 0; i < 90 ; arr[i++] = -1); 
```

要动态地执行此操作，您必须使用`malloc`然后仅释放内存进行分配，否则释放未分配的内存`malloc`，`calloc`或者`realloc`是未定义的行为。

用这个：

```
int *array;
array=malloc(sizeof(int)*n);
for(i=0;i<n;array[i++]=-1);
// After use free this
free(array); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-21T16:05:02.590

如果不显式枚举所有初始化程序，就不可能在初始化时在标准 C 中执行此操作。

在 GNU C 中，您可以使用 GNU C[指定的初始值设定项](http://gcc.gnu.org/onlinedocs/gcc/Designated-Inits.html)

```
 int array[90] = {[0 ... sizeof array - 1] = -1}; 
```

初始化后：

```
 int i;

   for (i = 0; i < sizeof array / sizeof *array; i++)
   {
       array[i] = -1;
   } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-21T16:21:54.073

写这个很痛苦，但你总是可以使用宏

```
#define FILL(arr, val) \
for(int i_##arr = 0; i_##arr < sizeof arr / sizeof *arr; ++i_##arr) \
{ \
    arr[i_##arr] = val;\
} 
```

然后在其他代码中：

```
int array[90];
FILL(array, -1); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-21T16:21:21.687

没有简单的办法，calloc只初始化为0。

你可以做

```
int *array = malloc(sizeof(int)*size);
for (i=0;i<size;i++) array[i] = -1; 
```

或者

```
memset(array,-1,sizeof(int)*size); 
```

您可以使用 memset 但它仅在您想使用值“0”或“-1”时才有效，否则它将无法按预期工作，因为 memset 为所有字节设置了相同的值。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-21T16:07:50.953

```
memset( array, -1 , sizeof(array) ) ; 
```

可用于初始化为 0 或 -1

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-21T16:15:32.520

90个字不是很多记忆。您可能会花费大部分时间来分配/取消分配内存。将它放在堆栈上可能比动态创建内存要快。我会看看 for 循环或 Omkant 的答案是否有效。如果事实证明它确实是瓶颈，那么您可以开始优化。

```
for (i = 0; i < 90; ++i) { array[i] = -1; } 
```

# jquery - 为什么添加切换速度会影响“：可见”？

> ID：13497205
> 
> 赞同：2
> 
> 时间：2012-11-21T16:04:17.973
> 
> 标签：jquery

我正在开发一些功能，以在用户单击链接时显示包含一些文本的 div。

该链接最初显示文本“show +”，然后当显示 div 时，此文本更改为“hide -”。代码如下：

**查询**

```
 <script>
    $(document).ready(function() {
    $('p.link + div').hide();
    $('p.link a').prepend('<span>info +</span> ');

    $('p.link a').click(function(e) {
     var vis = $(this).parent().next().toggle().is(':visible');
     $(this).find('span').text(vis ? 'hide -' : 'info +');
     e.preventDefault();
    });
    });
    </script> 
```

**HTML**

```
 <p class="link"><a href="#" class="show-hide"> </a></p>

    <div class="info">

    <p>Some sample text to show and hide</p>

    </div> <!-- info --> 
```

这一切都很好，但后来我决定而不是立即显示/隐藏，通过在切换中添加速度来逐渐显示文本会很好。因此，我修改了以下行：

**查询**

```
 var vis = $(this).parent().next().toggle("slow").is(':visible'); 
```

这给了我想要的过渡效果，但现在链接文本没有改变。它最初仍显示为“信息+”，但从那里开始，无论是否显示 div，链接文本都显示为“隐藏 -”。

我认为这是因为代码总是以某种方式将 div 视为显示，即使它不是，但我不确定如何解决这个问题。

任何帮助，将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T16:18:17.510

在转换完成后使用回调参数`toggle`来执行你的语句，而不是在之后立即执行它。

```
var span = $(this).find('span');
$(this).parent().next().toggle("slow", function() {
  span.text($(this).is(":visible") ? 'hide -' : 'info +');
}); 
```

[JSFiddle](http://jsfiddle.net/cY7zM/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T16:20:06.460

这很简单，为什么会发生。如果你在淡入淡出后立即进行检查，它是这样的：淡入一个元素意味着它没有被隐藏，这意味着它是可见的；淡出一个元素意味着它没有被隐藏，这意味着它是可见的。

您可以先存储状态：

```
var elem = $(this).parent().next();
var vis = elem.is(':visible');
elem.toggle("slow"); 
```

或者，将状态存储在一个类中（如果用户连续点击会更好）

```
var vis = $(this).parent().next().toggleClass("visible").toggle("slow").hasClass("visible"); 
```

# ios - 日期格式化程序返回 null

> ID：13497207
> 
> 赞同：1
> 
> 时间：2012-11-21T16:04:24.803
> 
> 标签：ios, date, nsdateformatter

我总是从日期格式化程序中得到一个空值。我在所有其他问题中都尝试了示例，但没有帮助。

```
 NSLog(@"Date is %@", summaryItem.SubmittedDate);
NSLog(@"Formatted Date is %@", [df stringFromDate: summaryItem.SubmittedDate ]);
BOOL isDate = [summaryItem.SubmittedDate isKindOfClass: [NSDate class]];
NSLog(@"Date %@ a date.", isDate ? @"is" : @"is not"); 
```

查看您拥有的 SubmittedDate 的定义

```
@property (nonatomic, retain) NSDate *SubmittedDate; 
```

我正在初始化日期格式器

```
- (void) initDateFormatter {
  if( df == nil ) {
    df = [[NSDateFormatter alloc] init];
    [df setDateFormat:@"MM/dd/yyyy"];
    [df setDateStyle:NSDateFormatterShortStyle];
  }
} 
```

1.  输出到日志：
    *   2012-11-21 10:00:41.650 Mobile_v2[4093:f803] 日期是 2012 年 11 月 21 日上午 10:00:41
    *   2012-11-21 10:00:41.651 Mobile_v2[4093:f803] 格式化日期为 (null)
    *   2012-11-21 10:00:41.681 Mobile_v2[4093:f803] 日期不是日期。

任何人都可以看到有什么问题吗？我的日期格式不正确吗？

我的 SBJson 课程中的代码

```
NSString *newDate = (NSString *)[receivedObjects objectForKey:@"SubmittedDate"];
NSDate *submittedDate = [df dateFromString:newDate];  //(NSDate *) 
if ((NSNull *) submittedDate == [NSNull null]) {
    self.SubmittedDate = nil;
} else {
    self.SubmittedDate = submittedDate;
} 
```

实际值为“2012 年 11 月 21 日上午 10:47:54”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T16:27:13.177

从您的日志 中， **summaryItem.SubmittedDate**对象不属于 NSDate 类。

首先记录该对象的类，

```
NSLog(@"%@",  [summaryItem.SubmittedDate class]); 
```

如果输出不是 NSDate， `@property (nonatomic, retain) NSDate *SubmittedDate;`则声明的类中的实现（.m 文件）有问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T17:05:12.697

我不建议您在解析 JSON 响应时使用 NSDateFormatter 从字符串转换为日期，因为：

1.  您必须设置正确的日期格式 [df setDateFormat:@"MM/dd/yyyy"]。
2.  NSDateFormatter 非常慢。

而是使用 UNIX 时间戳（从 1970 年 1 月 1 日开始的秒数），并且，

```
-(id)initWithTimeIntervalSinceReferenceDate:(NSTimeInterval)seconds 
```

创建日期对象。

# java - 我的共享实体是否应该与我的网络应用程序分开进行版本控制？

> ID：13497208
> 
> 赞同：0
> 
> 时间：2012-11-21T16:03:31.067
> 
> 标签：java, model-view-controller, jpa, project-management

我们有 4 个 webapps 在同一台服务器上运行并与同一个数据库进行通信。他们使用 JPA 注释类与数据库进行通信。它们也将位于单独的存储库中，因此它们可以相互独立地进行版本控制。

每个 webapp 都有一个 MVC 架构，其中模型的一部分在 webapps 中是相同的。我们可以选择违反 DRY 并为每个 webapp 重复模型的共享部分，或者我们可以通过对模型本身进行版本控制来引入模型共享部分的耦合。

解决此问题的最佳方法是什么？如果数据库模式需要更改，我们该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T16:06:42.350

我不会这样做

```
they also will be on separate repositories so they can be versioned independent of each other. 
```

或这个

```
We can choose to violate DRY and repeat the shared parts of the model for each webapp 
```

我会在不同的 webapps 之间使用一个共享模型，并使用 maven 作为依赖项管理器将它们包含在每个项目中。

实际上，当所有应用程序都依赖于同一个数据库时，您如何使用不同版本的（实体类）？

# javascript - 我可以用 jQuery 做一个通用的可链接的过程吗？

> ID：13497209
> 
> 赞同：0
> 
> 时间：2012-11-21T16:04:26.613
> 
> 标签：javascript, jquery, method-chaining

我有这个块：

```
 return $( "<li></li>" )
              .data( "item.autocomplete", item )
              .append( "<a>" + item.label + "</a>" )
              .appendTo( ul );
        }; 
```

我想在`append`语句中放一个三元组，这样它要么只是 a`label`要么`label with an address`

```
item.address != '' ? item.address : '' 
```

或者有点混乱但更具体..

```
if ( item.address != '' )
  "<span class='customer_search_addr'>" + item.address + "</span>"
else
  "<a>" + item.label + "</a>" 
```

我可以在这里制作一个可链接的 proc，因为我不能（我认为我不能）直接在 append 语句中添加这个三元组。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T16:08:33.523

`append`是的，您可以在调用中添加三元组：

```
return $( "<li></li>" )
          .data( "item.autocomplete", item )
          .append( (item.address != '')?("<span class='customer_search_addr'>" + item.address + "</span>"):("<a>" + item.label + "</a>") )
          .appendTo( ul ); 
```

但是，这很混乱，所以我会这样做：

```
var address = (item.address != '')?
    ("<span class='customer_search_addr'>" + item.address + "</span>"):
    ("<a>" + item.label + "</a>");

 return $( "<li></li>" )
          .data( "item.autocomplete", item )
          .append(address)
          .appendTo( ul ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T16:12:20.113

它应该可以工作..参数将首先被评估，因此它只会将结果传递给函数。

证明演示：http: [//jsfiddle.net/5LpqL/](http://jsfiddle.net/5LpqL/)

但我相信如果你先像下面这样评估它会更好，

```
var stuffToAppend = (item.address)?"<a>" + item.label + "</a>":"<span class='customer_search_addr'>" + item.address + "</span>";

return $( "<li></li>" )
              .data( "item.autocomplete", item )
              .append( stuffToAppend )
              .appendTo( ul ); 
```

更好的是`if..else`有条件..

# asp.net - 基于另一个下拉列表的下拉列表值

> ID：13497210
> 
> 赞同：0
> 
> 时间：2012-11-21T16:03:38.947
> 
> 标签：asp.net

我有一个下拉列表控件，在其中添加了两个列表项。这两个列表项都是由我手动添加的，而不是从任何数据库中添加的。根据选择，我想显示另一个具有 sqldatasource 的下拉列表。

如果我的初始下拉列表源也来自数据库，我能够完成此操作我如何通过读取下拉列表的值并根据所选值填充另一个下拉列表来完成此操作

需要填充的第二个下拉列表将根据第一个下拉列表中的选定值而有所不同（来自不同的表）

需要方向的想法请

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T16:46:59.483

```
 protected void dropdown1_SelectedIndexChanged(object sender, EventArgs e)
  {
     string val = dropdown1.SelectedItem.Value;
     if(val == "xyz")
       SqlDataSource1.SelectCommand = "Select * From Table_1";
     else if(val == "abc")
       SqlDataSource1.SelectCommand = "Select * From Table_2";

      SqlDataSource1.DataBind();
  } 
```

# java - 使用数组矩阵RGB java将图像转换为灰度

> ID：13497211
> 
> 赞同：3
> 
> 时间：2012-11-21T16:04:31.863
> 
> 标签：java, arrays, matrix, rgb

我正在创建一个图像过滤器程序，我想在数组矩阵的帮助下将彩色图片转换为灰度图片。

这是我目前拥有的：

```
import java.awt.Color;
import se.lth.cs.ptdc.images.ImageFilter;

public class GrayScaleFilter extends ImageFilter {

    public GrayScaleFilter(String name){
        super(name);
    }

    public Color[][] apply(Color[][] inPixels, double paramValue){
        int height = inPixels.length;
        int width = inPixels[0].length;
        Color[][] outPixels = new Color[height][width];
        for (int i = 0; i < 256; i++) {
          grayLevels[i] = new Color(i, i, i);
        }

        for(int i = 0; i < height; i++){
            for(int j = 0; j < width; j++){
                Color pixel = inPixels[i][j];
            outPixels[i][j] = grayLevels[index];                    
            }
        }
        return outPixels;
    }
} 
```

看起来我应该使用这个公式：((R+G+B)/3)

我想创建一个这样的数组矩阵：

```
 Color[] grayLevels = new Color[256];
    // creates the color (0,0,0) and puts it in grayLevels[0],
    // (1,1,1) in grayLevels[1], ..., (255,255,255) in grayLevels[255] 
```

当我想使用 grascale 时，这也是我要引用的类：

```
public abstract Color[][] apply(Color[][] inPixels, double paramValue);

protected short[][] computeIntensity(Color[][] pixels) {
    int height = pixels.length;
    int width = pixels[0].length;
    short[][] intensity = new short[height][width];
    for (int i = 0; i < height; i++) {
        for (int j = 0; j < width; j++) {
            Color c = pixels[i][j];
            intensity[i][j] = (short) ((c.getRed() + c.getGreen() + c
                    .getBlue()) / 3);
        }
    }
    return intensity;
} 
```

关于我如何实现这一目标的任何反馈？而不是使用`outPixels[i][j] = new Color(intensity, intensity, intensity);`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T16:09:42.420

以这种方式构建`grayLevels`数组：

```
for (int i = 0; i < 256; i++) {
  grayLevels[i] = new Color(i, i, i);
} 
```

然后，当您需要某种颜色时，只需将其检索为`grayLevels[index]`.

# facebook-graph-api - 如何找到我的 Facebook 应用程序 ID 和密钥？

> ID：13497212
> 
> 赞同：-2
> 
> 时间：2012-11-21T16:04:34.433
> 
> 标签：facebook-graph-api

我已经注册为 Facebook 开发者，但我没有找到任何应​​用程序 ID 和密钥。谁能帮我 ？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T16:11:38.663

您的所有应用程序及其设置（包括 id 和秘密）的列表在这里：

> [https://developers.facebook.com/apps](https://developers.facebook.com/apps)

您可能想查看一些有关 facebook 应用程序的教程，例如：

> [http://www.emanueleferonato.com/2009/09/20/developing-a-facebook-application-for-absolute-beginners/](http://www.emanueleferonato.com/2009/09/20/developing-a-facebook-application-for-absolute-beginners/)

此外，官方文档并没有那么糟糕，但相当大：

> [https://developers.facebook.com/docs/](https://developers.facebook.com/docs/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T16:16:06.187

您会在页面底部找到一个开发者链接，打开它后您会在页面右上角找到应用程序链接，单击它可以查看您的应用程序详细信息。

或者

简单的方法就是登录 facebook 并将下面的链接复制到您的浏览器。 [https://developers.facebook.com/apps](https://developers.facebook.com/apps)

# merge - 什么是同步 2 代码库不同目录结构的简单方法

> ID：13497217
> 
> 赞同：0
> 
> 时间：2012-11-21T16:03:51.817
> 
> 标签：merge, windows-xp, directory-structure

所以我在一家公司工作，而代码库在组织方面不是我想要的，所以我采用了 Maven 约定。我遇到了一个问题，我现在有 2 个目录结构......

现有代码库

```
project
  subproject
    src
      com
    JUnitSrc
      com 
```

我的代码库

```
Project
  src
    main
      java
        com
    test
      java
        com    
Project
.... 
```

如果我更新说现有的，我希望能够将更改合并到我的代码库中，反之亦然。我有什么方法可以做到这一点？此外，当前的开发环境是 Windows XP，所以如果我能让 Linux 命令与 Bash shell 一起工作，它们就很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T18:04:37.133

您可以使用 Cobian 备份[http://www.cobiansoft.com/index.htm](http://www.cobiansoft.com/index.htm) 免费且快速同步。

祝你好运

# c++ - 使用 OpenCV Vector 和 MATLAB 时遇到问题

> ID：13497218
> 
> 赞同：2
> 
> 时间：2012-11-21T16:04:47.947
> 
> 标签：c++, matlab, opencv, mex, matlab-cvst

我正在尝试在 MATLAB 的 OpenCV 中使用特征检测器。为此，我正在创建一个 MEX 文件，该文件调用其他 CPP 文件中的某些其他函数。这些函数实现了调用 OpenCV 特征检测器的必要例程。一切都很好，直到创建 MEX 文件。它甚至可以从 MATLAB 运行普通的 OpenCV 例程。但是，当我简单地使用特征检测器时，它给了我一个错误 - VECTOR ITERATORS INCOMPATIBLE。请在下面找到必要的信息 -

文件 1 - FeatureDetectorMEX.cpp -> 此文件包含从 FeatureDetetor.cpp 调用特征检测器的 MEX 函数 文件 2 - FeatureDetector.cpp -> 此文件包含 FAST 特征检测器。然后它调用特征提取器BRIEF来获取关键点的一些特征描述符。这是代码 -

```
Keypoints sourceKp;
Descriptors sourceDesc;
cv::FastFeatureDetector *detector = new cv::FastFeatureDetector(50);
cv::BriefDescriptorExtractor *extractor = new cv::BriefDescriptorExtractor();
//The following line generates the error
detector->detect(img.clone(),sourceKp);
if(!sourceKp.empty())
{
extractor->compute(img.clone(),sourceKp,sourceDesc);
} 
```

这里，img 是 cv::Mat 类型的图像数据结构。关键点是一个向量 - std::vector 关键点。描述符也是 cv::Mat。

FastFeatureDetector 是实现 FAST 特征检测器的类。BriefDescriptorExtractor 是实现Brief 的类。

这是错误的详细信息-

```
Debug Assertion Failed!

Program: C:\Program Files\MATLAB\R2010b\bin\win64\MATLAB.exe
File: C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\include\Vector
Line: 238 
```

表达式：向量迭代器不兼容

这里有更多信息： 我的系统是 64 位的。我正在运行 MATLAB R2010b 和 VC 2010 终极版。所有代码和 dll 都是 64 位的。如果从 VC 控制台运行，该程序不会抛出任何错误。但是，如果从 MATLAB 运行，则会引发错误。

我的问题：有人在 OpenCV 中的任何特征检测器程序中遇到过这种问题吗？如果是，请帮助我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-26T15:21:55.003

[计算机视觉系统工具箱现在包括一个与 OpenCV 接口](http://www.mathworks.com/help/vision/ug/opencv-interface.html)的支持包。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T15:59:55.933

没关系。我找到了解决方案。默认情况下，MEX 编译器在 mexopts.bat 中将 SECURE_SCL 设为 0。保持这种方式。获取 OpenCV 发布代码（或使用 SECURE_SCL = 0 重新编译调试）。我实际上浏览了与此相关的帖子。但是，他们中的大多数会告诉您设置标志 = 1，这不会抑制错误。

# r - 在 R 中找不到指定的模块

> ID：13497222
> 
> 赞同：5
> 
> 时间：2012-11-21T16:04:02.907
> 
> 标签：r, rcpp

我正在使用 Rcpp 和另一个第三方 C++ 库开发一个包。当我尝试安装软件包时，我得到了

```
Error in inDL(x, as.logical(local), as.logical(now), ...) : 
  unable to load shared object 'C:/Users/Admin/Documents/R/win-library/2.15/packagename/libs/i386/package.dll':
   LoadLibrary failure:  The specified module could not be found. 
```

在 32 位 Windows 操作系统中，根据同事的建议，我通过将来自 MingW 的以下 dll 的位置添加到系统路径来解决问题。

```
libgcc_s_dw2-1.dll 
```

但是在 64 位 Windows 上，即使使用 dll，我也会遇到同样的错误，尽管我使用的是 32 位 R。

所以我的问题：

有什么方法可以知道为什么`The specified module could not be found`会发生错误？我的意思是我想知道缺少哪个模块。也许在哪里有详细的选项？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T18:25:07.930

R 中没有一种简单的方法可以从我提到的错误中获取更多信息。但是我通过以下网站找到了免费软件来查找莳萝缺少哪个依赖项：http: [//www.dependencywalker.com/](http://www.dependencywalker.com/)

使用我能够找到以下 dll 的软件需要位于系统路径中。

```
GPSVC.dll
IESHIMS.dll
SYSNIFY.dll 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-05-17T05:43:00.700

I ran into this same problem and the issue turned out to be that Windows was not looking in the right place for jvm.dll. Solution was to add location of this dll to Windows PATH variable.

Found solution here: [Using the rJava package on Win7 64 bit with R](https://stackoverflow.com/questions/7019912/using-the-rjava-package-on-win7-64-bit-with-r)

Instructions on how to edit PATH variable here: [https://www.java.com/en/download/help/path.xml](https://www.java.com/en/download/help/path.xml)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-17T08:16:23.630

正如帖子[Win 7, 64 bit, dll questions](https://stackoverflow.com/questions/17023419/win-7-64-bit-dll-problems)所暗示的，dependencywalker 的输出可能具有误导性。就我而言，我的系统 %PATH% 环境变量中缺少“Microsoft SQL Server”的路径（故意删除，因为它似乎没有必要）。之后 LoadLibrary 错误消失并加载了库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-08-28T04:26:30.170

我相信您可以**以管理员身份**运行您的 R 软件，您可以解决您的问题...您可以检查：[无法在 R 中加载任何包（无法加载共享对象）](https://stackoverflow.com/questions/30034542/unable-to-load-any-package-in-r-unable-to-load-shared-object)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-03-23T12:42:54.527

I was also facing the error

> "Warning in install.packages : installation of package ‘rlang’ had non-zero exit status".

I followed the following steps

1.  restart the RStudio,
2.  install.packages("tidyverse")
3.  removed the folder `C:/Users/CHILIKA/Documents/R/win-library/3.5/00LOCK-rlang`

and again

4.  install.packages("rlang") then rlang sucessfully installed.

# html - 制作表格 td 使其无法放大

> ID：13497228
> 
> 赞同：0
> 
> 时间：2012-11-21T16:04:26.103
> 
> 标签：html, css

我需要制作表格 td 所以它不能放大。它应该是方形的，高度是固定的，如果有更多的文本，那么可以包含一个盒子，它应该保持原样，文本只是向下。这样做很热？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T16:56:15.523

请参阅[无论其单元格中的文本量如何，都将表格列宽设置为常数？](https://stackoverflow.com/questions/4457506/css-how-to-set-the-table-column-width-constant-regardless-of-the-amount-of-text)

```
table-layout: fixed; 
```

这是一个 jsfiddle，它有一些 HTML 更改以及 CSS 更改：http: [//jsfiddle.net/GR4Lm/](http://jsfiddle.net/GR4Lm/)

我删除了一些行以简化事情，但同样的技术也适用——将所有 TD 内容包装在一个 DIV 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T17:00:55.590

我想可能会做你正在寻找的东西：http: [//jsfiddle.net/rVDQm/](http://jsfiddle.net/rVDQm/)

```
table tr td {
 width:400px;
 height:400px;
 background:#ccc;
 overflow:scroll;
 overflow-x:hidden;
 display:block;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T16:07:15.440

在每个 TD 中添加一个 DIV 并添加`overflow:hidden`该元素的样式并为其提供固定尺寸。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T16:07:46.227

```
 td style="height:xpx; width:xpx; overflow:auto;" 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-21T16:07:14.787

假设我正确理解了您的问题，请在您的 CSS 中使用`max-height`和。`max-width`

# attributes - Kendo UI 删除 Treeview 中的节点属性

> ID：13497232
> 
> 赞同：0
> 
> 时间：2012-11-21T16:05:25.303
> 
> 标签：attributes, treeview, kendo-ui, dataitem

我有一些节点包含的`items`值似乎是默认情况下从剑道初始化的，每次都使用值“[]”！

我想从节点中完全删除“项目”字段，但我似乎找不到任何删除属性的方法。

我尝试通过访问节点`dataItem`，`dataItem.set("items",undefined)`但我仍然认为它没有帮助。我正在尝试删除该`items`字段，因为剑道完成的初始化似乎有问题，我无法将新节点附加到他们，我认为这是因为它......

**编辑 ：**

似乎`kendo.observableHierarchy(data)`初始化每个没有子节点的树节点（因此没有`items`所有属性）。通过初始化，我的意思是每次我显示数据源时，没有子节点的节点都会`"items":[]`自动添加属性！

我尝试通过附加节点，`treeview.dataItem(treeview.select()).append()`但我发现此方法不适用于具有`"items":[]`由剑道添加到它们的属性的“旧”节点，因此“旧”节点是从页面加载到树上的所有节点加载因此被保存在 JSON 文件中。

我说“旧”是因为如果我附加一个新节点，它没有该`"items"`字段，并且`.append()`上面提到的在添加节点和更新数据源时`.append()`工作得很好。这在已经存在的“旧”节点上也工作得很好有孩子，所以他们的`"items"`领域不会被剑道修改，因为它已经存在。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-07-17T18:52:57.513

我刚刚发现了一些关于剑道建议答案的有趣之处：[http ://www.telerik.com/forums/clear-all-nodes](http://www.telerik.com/forums/clear-all-nodes)

使用他们的代码建议，还将删除 .items 属性：

```
$(".k-treeview").data("kendoTreeView").remove(".k-item"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T21:37:59.390

删除对象字段是`delete XXX`。我`ve updated the [fiddle] (jsfiddle.net/OnaBai/UC3uW/1) by adding a third option called`删除了，但除非我误解了你的建议，否则它不能解决问题。恐怕这是 KendoUI 中的一个功能，它不会像我们预期的那样管理 HierarchicalDataSources。

# doctrine-orm - 在 Doctrine2 中获取实体代理

> ID：13497235
> 
> 赞同：2
> 
> 时间：2012-11-21T16:05:30.370
> 
> 标签：doctrine-orm, relationship, proxy-classes

我有一个与*Collar*有 OneToOne 关系的实体*Dog*。

 *假设我创建了一个新的*Dog*实体，并且我有想要关联的*Collar id。*不是*Collar*对象本身，**只有它的 id number**。

```
$collar = 12;
$dog = new Dog();
$dog->setCollar(?); 
```

我是否需要实际从数据库中**获取***Collar*对象，只设置它的 id（已经给出），或者有没有办法创建代理*Collar*对象？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-15T16:19:04.993

是的，实际上有

您可以使用实体管理器来获取代理引用而不是实际实体，它只是为您提供代表实体的代理对象，而无需实际从数据库中获取它。

检查下面的代码以获取示例

```
$collarId = 12;

// First param is the Entity classname, second is the Entity id
$collar = $entityManager->getReference('Collar', $collarId); 

$dog = new Dog();
$dog->setCollar($colar);

$entityManager->persist($dog);
$entityManager->flush(); 
```*

# sql - Oracle：如何在 sql developer 中比较多行并确保它们相同？

> ID：13497237
> 
> 赞同：0
> 
> 时间：2012-11-21T16:05:34.410
> 
> 标签：sql, oracle, plsql

我有下表如下：

```
League_id     League_name          Team_id     Team_name
257           Copa America         11111       ABC
122           Brazil A             11111       ABC
135           La Liga              987         FC Barca
129           Copa Del Rey         987         *FC Barca Football 
```

`*Notice that there each team could play in different leagues`

我想对`Team_name`Column 进行健全性检查，并确保`Team_name`在所有联赛中都是相同的。ie`FC Barca Football`应该被标记，因为它与`FC Barca`不同的联赛不同。

进行此检查的最佳方法是什么？

应生成如下错误消息：“Team_Name discrepancy for Team_ID = 987”对于联赛：La Liga (135) 和 Copa Del Rey (129)

谢谢，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T16:10:04.720

解决此问题的适当方法是不将 存储`team_name`在此表中。该`team_name`列属于`team`表（我假设`team_id`是主键）。实际上，`league_name`也不应该在这个表中——它应该在主键`league`所在的表中。`league_id`

所以你真的需要三张桌子

```
CREATE TABLE league( 
  league_id   NUMBER PRIMARY KEY,
  league_name VARCHAR2(100) NOT NULL
);

CREATE TABLE team(
  team_id   NUMBER PRIMARY KEY,
  team_name VARCHAR2(100) NOT NULL
);

CREATE TABLE team_league(
  team_league_id NUMBER PRIMARY KEY,
  team_id        NUMBER REFERENCES team( team_id ),
  league_id      NUMBER REFERENCES league( league_id ),
  CONSTRAINT uk_team_league UNIQUE( team_id, league_id )
); 
```

然后，您可以创建一个视图来生成您在此处提供的数据

```
SELECT l.league_id, l.league_name,
       t.team_id,   t.team_name
  FROM league l
       JOIN team_league tl on (l.league_id = tl.league_id)
       JOIN team t on (tl.team_id = t.team_id) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T16:14:35.523

您可以使用 team_id 和团队名称创建一个单独的表（团队）。对这些设置一个独特的约束。然后把League_id，League_name，Team_id放在League表上。
因此，当您执行查询时，您会从团队表中提取 team_name，从而减少每个 team_id 允许多个团队名称的冗余。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T16:15:28.683

我建议您规范化您的表格。

换句话说：

创建一个包含*id*和*团队名称*列的 TEAM 表。创建一个包含*id*和*联赛名称*列的 LEAGUE 表。

一个联赛可以包含**多个**球队，一个球队可以包含**多个**联赛。因此，这应该建模为**多对多**关系。

即创建一个包含*联赛 id*和*球队 id*字段的 TEAM_LEAGUE 表

这种建模避免了这个问题，因为现在给定团队有一个唯一的团队名称。

# php - 均匀地重新排列数组中的元素

> ID：13497241
> 
> 赞同：1
> 
> 时间：2012-11-21T16:04:46.553
> 
> 标签：php, arrays, shuffle

说我有：

```
$array = (1,1,1,1,2,2,2,2,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0); 
```

我想要实现的是在其中均匀地重新排序元素。

PHP 的函数 shuffle() 不适合这里，因为我想要相同数字之间的距离。所以 1 必须在数组的开头、中间和结尾。

我在谷歌上搜索了[Fisher-Yates_shuffle](http://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle)算法，但它的工作原理似乎与 shuffle() 完全一样。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T17:45:54.677

我认为这接近您所要求的：数组中项目的恒定、合理均匀分布。

```
// The input array. 0s are regarded as blanks.
$array = array(1,1,1,1,2,2,2,2,3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);

// Count the times each item occurs. PHP will probably have a function for that, but I don't know.
$counter = array();
foreach ($array as $item)
{
  // Zeros are infill. Don't process them now, only process the other numbers and
  // the zeros will occupy the remaining space.
  if ($item === 0)
    continue;

  if (!array_key_exists($item, $counter))
    $counter[$item] = 0;
  $counter[$item]++;
}

// Reverse sort by quantity. This results in the best distribution.
arsort($counter);

// Pre-fill a new array with zeros.
$resultCount = count($array);
$result = array_fill(0, $resultCount, 0);

// Distribute the items in the array, depending on the number of times they occur.
foreach ($counter as $item => $count)
{
  // Determine the division for this item, based on its count.
  $step = $resultCount / $count;

  // Add the item the right number of times.
  for ($i = 0; $i < $count; $i++)
  {
    // Start with the index closest to the preferred one (based on the calculated step).
    $index = 0;
    $startIndex = (int)($step * $i);
    // Count up until a right index is found.
    for ($index = $startIndex; $index < $resultCount; $index++)
    {
      if ($result[$index] === 0)
      {
        $result[$index] = $item;
        break;
      }
    }
    // If no proper index was found, count fown from the starting index.
    if ($index === $resultCount)
    {
      for ($index = $startIndex; $index >= 0; $index--)
      {
        if ($result[$index] === 0)
        {
          $result[$index] = $item;
          break;
        }
      }
    }

    // Still no proper index found, that shouldn't be possible. There's always room.
    if ($index === -1)
    {
      throw new Exception('This cannot not happen');
    }
  }
}

var_dump($result); 
```

对于数组：

```
1,1,1,1,2,2,2,2,3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 
```

它返回：

```
3,2,1,0,3,0,0,0,3,0,2,1,3,0,0,0,3,0,0,0,0,3,2,1,0,3,0,0,0,3,0,2,1,3,0,0,0,3,0,0,0,0 
```

对于数组：

```
1,1,1,1,2,2,2,2,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0 
```

它返回：

```
4,4,3,4,3,4,2,4,3,4,2,4,3,4,1,4,3,4,1,4,0,4,4,3,4,3,4,2,4,3,4,2,4,3,4,1,4,3,4,1,4,0 
```

我认为这是一个整洁的分布。感谢 datdo 对中间数组进行排序的想法。

# ios - 在 Xcode 版本 4.5.2 (4G2008a) 捆绑包中找不到 OpenGL ES 性能检测器

> ID：13497242
> 
> 赞同：5
> 
> 时间：2012-11-21T16:05:41.497
> 
> 标签：ios, xcode, opengl-es

我最近在 Apple 的文档中发现了“OpenGL ES 性能侦探”的存在，但我找不到它。

我在 docs an forums 中发现了很多不同的可能位置，但在我的情况下没有一个是好的。

[Xcode 4 发行说明](https://developer.apple.com/library/mac/#releasenotes/DeveloperTools/RN-Xcode/_index.html)中提到了 OpenGL ES 性能检测，后续版本均未声明将其删除。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-21T18:11:41.220

我相信这个工具在 Xcode 包中丢失的原因（在 Xcode 4.4 中，你可以在 Xcode.app/Contents/Applications 中找到它）是它的功能现在在 Xcode 本身中处理。

当您在 Xcode 4.5 下运行 OpenGL ES 应用程序时，您会看到左侧栏中运行着一个小的 FPS 计数器。单击它，您将在应用程序中显示实时性能读数。如果您然后单击下方的分析性能按钮，您将看到如下所示的屏幕：

![Xcode 中的 OpenGL ES 性能分析](../Images/b58cd9f5b4972735499e97f8fd2057e9.png)

这似乎具有旧 OpenGL ES Performance Detective 使用的所有信息。

你仍然可以下载 4.4 版本的 Xcode，虽然它[可以在开发者中心](https://developer.apple.com/downloads/index.action?name=Xcode)获得，但是我在让那个包中的 Performance Detective 与我的 iOS 6.0 设备一起工作时遇到了麻烦。

# c# - 从文件中读取字节

> ID：13497243
> 
> 赞同：2
> 
> 时间：2012-11-21T16:05:42.710
> 
> 标签：c#

我正在尝试编写 huffman 解压缩，我有一个函数试图逐字节读取整个压缩文件，但我有一个问题，它只读取大约 150 个第一个字节，其余的被跳过我不明白为什么。

这是功能：

```
public static StringBuilder odczytBajtowy(string nazwa)
    {
        FileStream plik = null;
        StringBuilder dane = new StringBuilder("");
        try
        {
            plik = new FileStream(@nazwa, FileMode.Open, FileAccess.Read);

            int w;
            int n = 0;
            do
            {
                n++;
                w = plik.ReadByte();

                if (w != -1)
                    dane.Append(StringHelp.Reverse(Convert.ToString((byte)w,2).PadLeft(8, '0')));
            }
            while ((w > 0));
        }
        catch (FileNotFoundException)
        {
            Console.WriteLine("Brak pliku {0}", nazwa);
        }
        finally
        {
            if (plik != null)
            {
                plik.Close();
            }
        }

        return dane;
    } 
```

看起来该函数在文件真正结束之前读取 EOF。我知道字节之间没有 EOF，因为我在那里只写字节值。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T16:07:24.613

您的 while 条件不正确：它应该 read `while (w != -1)`，因此一旦找到零字节，您就停止循环读取字节，而不是在文件末尾。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T16:08:25.050

```
while ((w > 0)); 
```

这将在达到 0 时停止。将其更改为

```
while ((w >= 0)); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-21T16:09:26.930

您可能遇到了零字节。

更改您的 while 循环以包含 0：

```
while ((w >= 0)); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-21T16:10:50.667

问题出在这一行：

而 ((w > 0));

它应该是：

而 ((w != -1));

因为很可能您的文件中包含 0。

# xml - 将未知对象序列化为xml

> ID：13497244
> 
> 赞同：0
> 
> 时间：2012-11-21T16:04:49.987
> 
> 标签：xml, generics, object, serialization

我有一个我希望通过 WCF 服务发送的对象，这需要能够序列化和我可能不知道其类型的对象。我看到这适用于原始类型，但是对于引用类型，我无法成功序列化这些值。在下面的测试中，当它尝试序列化 List 或 Tuple 对象时，我在调试时收到一条错误消息。有没有一种在不知道类型的情况下执行此过程的好方法？

 `````
[DataContract]
public class SizingObject
{
    [DataMember]
    public List<SizingItem> SizingItems { get; set; }
}

[DataContract]
public class SizingItem
{
    [DataMember]
    public string Name { get; set; }

    [DataMember]
    public string Value { get; set; }

    [DataMember]
    public string Unit { get; set; }

    [DataMember]
    public string ListItemId { get; set; }

    [DataMember]
    public object Item { get; set; }
} 
````  ``````
 var i = new SizingObject();
        i.SizingItems = new List<SizingItem>();
        i.SizingItems.Add(new SizingItem
                              {
                                  Item = "String",
                                  ListItemId = string.Empty,
                                  Name = "string item",
                                  Unit = string.Empty,
                                  Value = string.Empty
                              });

        i.SizingItems.Add(new SizingItem
                              {
                                  Item = 0.23,
                                  ListItemId = string.Empty,
                                  Name = "double item",
                                  Unit = string.Empty,
                                  Value = string.Empty
                              });

        i.SizingItems.Add(new SizingItem
                              {
                                  Item = new List<double> { 3, 4, 5, 6 },
                                  ListItemId = string.Empty,
                                  Name = "list<double> item",
                                  Unit = string.Empty,
                                  Value = string.Empty
                              });

        i.SizingItems.Add(new SizingItem
                              {
                                  Item = new Tuple<string, double>("TupleItem", 2.00),
                                  ListItemId = string.Empty,
                                  Name = "Tuple<string, double> item",
                                  Unit = string.Empty,
                                  Value = string.Empty
                              });

        // Serialize User Data
        var stringWriter = new StringWriter();
        var serializer1 = new XmlSerializer(typeof(SizingObject));
        serializer1.Serialize(stringWriter, i);
        var xml = stringWriter.ToString();

        var serializer2 = new XmlSerializer(typeof(SizingObject));
        i = (SizingObject)serializer2.Deserialize(new StringReader(xml));

        var dict = new Dictionary<Type, Func<object, object>>();
        dict.Add(typeof(string), e => e as string);
        dict.Add(typeof(double), e => e);
        dict.Add(typeof(List<double>), e => e as List<double>);
        dict.Add(typeof(Tuple<string, double>), e => e as Tuple<string, double>);

        foreach (var item in i.SizingItems)
        {
            var result = dict[item.Item.GetType()].Invoke(item.Item);
        } 
````  `* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T16:09:23.493

有没有想过简单地将其发送为`Object`?

假设您在两端都有类“模板”的副本，您可以将其作为对象发送，然后在接收端将其转换为类型。

另一个想法是将它作为 XML 传输，假设没有真正的敏感信息，并在接收端重建类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-01T12:33:43.077

我发现当我花更多时间使用它并提供一组已知类型时，我能够解决这个问题。我无法序列化 Tuple 类型，因此必须创建一个替代方案，但这正如我所期望的那样，因为它的类型、列表和其他对象现在是完全可序列化的。

`var types = new Type[] { typeof(string), typeof(double), typeof(List), typeof(WCFTuple) };`

 ````
 // Serialize User Data
            var stringWriter = new StringWriter();
            var serializer1 = new XmlSerializer(typeof(SizingObject), types);
            serializer1.Serialize(stringWriter, i);
            var xml = stringWriter.ToString();

            // Deserialize object.
            var serializer2 = new XmlSerializer(typeof(SizingObject), types);
            i = (SizingObject)serializer2.Deserialize(new StringReader(xml)); 
````````

# sencha-touch - 生成一个煎茶触摸应用

> ID：13497247
> 
> 赞同：6
> 
> 时间：2012-11-21T16:05:02.047
> 
> 标签：sencha-touch, sencha-touch-2, sencha-touch-2.1, sencha-command

我正在尝试在 Windows 上使用**“sencha generate app MyApp ../MyApp”**命令创建一个新的 sencha touch 应用程序。

我做了以下事情：

下载最新的 sencha SDK 并将其解压到文件夹**“D:\MyProjects\sencha-touch-2.1.0-gpl”**文件夹中。

将 sencha SDK 工具安装在**“D:\MyProjects\SenchaSDKTools-2.0.0-beta3”**文件夹中。

确保系统环境变量“SENCHA_SDK_TOOLS_2_0_0_BETA3”确实指向**“D:\MyProjects\SenchaSDKTools-2.0.0-beta3”**

根据 sencha 文档，我应该在 sencha SDK 或应用程序文件夹中运行 sencha 命令。

因此，如果我 cd 到文件夹**"D:\MyProjects\sencha-touch-2.1.0-gpl"**并运行**"sencha generate app MyApp ../MyApp"**，我会收到此警告消息

```
**"[WARN] The current working directory (D:\MyProjects\sencha-touch-2.1.0-gpl) is not a recognized Sencha SDK or application folder. Running in backwards compatible mode."** 
```

为什么 sencha 不将此识别为 SDK 文件夹？

查看包含在 sdk 工具中的“sencha.js”文件中的代码，似乎 sencha 正在寻找**“.senchasdk”**文件。

所以我从示例文件夹中的一个子文件夹尝试了相同的命令（因为这个文件夹包含一个 .senchasdk 文件）

现在我得到了一个错误

```
"node.js:201
        throw e; // process.nextTick error, or 'error' event on first tick
              ^
Error: Cannot find module 'D:\MyProjects\sencha-touch-2.1.0-gpl\command\sencha.js'
    at Function._resolveFilename (module.js:332:11)
    at Function._load (module.js:279:25)
    at Array.0 (module.js:479:10)
    at EventEmitter._tickCallback (node.js:192:40)" 
```

由于 sencha 似乎在寻找一个不存在的名为“command”的文件夹，我将**SDK 工具**文件夹的内容复制到一个名为**“command”**的新文件夹中，并将其放在**D:\MyProjects\sencha-touch-2.1.0- gpl** \文件夹。

执行 sencha generate 命令，导致无限循环，并产生大量 Node.exe 进程（通过 TaskManager 观察）。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-21T19:31:19.753

我遇到了同样的问题，最后发现 Sencha Touch 2.1 不再使用 Sencha SDK Tools 而是使用 Sencha Command。

你可以在这里找到更多：

[http://docs.sencha.com/touch/2-1/#/guide/command](http://docs.sencha.com/touch/2-1/#/guide/command)

和这里

[http://docs.sencha.com/touch/2-1/#!/guide/command_app-section-2](http://docs.sencha.com/touch/2-1/#!/guide/command_app-section-2)

希望这有帮助

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-02-20T06:12:27.180

试试这个...

确保三件事..

1.  Sencha touch 安装路径。
2.  应用程序生成关键字
3.  您将在哪里保存 Sencha touch 项目。

让我们创建一个项目。

*   打开命令提示符
*   输入您的 Sencha touch sdk 安装路径。（对我来说：**C:\inetpub\wwwroot\touch-2.3.1**）
*   然后输入**sencha generate app MyApp**。这里**MyApp**是我们的项目名称。
*   然后输入您要保存项目**MyApp**的路径（对我来说：**C:\inetpub\wwwroot\Poonguti\MyApp**）。
*   按 Enter。
*   现在，我希望你创建一个 Sencha touch 项目。

这是一个附加的屏幕截图。![截屏](../Images/50a691f9e9002d1c9baf5468d7ba207b.png)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-13T10:17:18.723

这是因为，您使用的是旧版本的 SenchaCMD。发生这种情况的原因有两个。

**原因一**

您首先安装了 SenchaCmd，然后安装了 SenchaSDK。这可能会用 SenchaSDK 附带的旧版本覆盖最新版本的 SenchaCmd。

***解决方案***

先安装 SenchaSDK，最后安装 SenchaCmd。

**原因 2**

环境变量上设置的 SenchaCmd 路径可能有误。请检查这个。

正如 TDeBailleul 所说，最新版本的 SenchaTouch 不需要 SenchaSDK。只使用 SenchaCmd。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-22T06:38:37.233

我遇到过同样的问题。最后，问题是我使用的是旧版本的sdk ......

我会重新安装 2.0 版并下载并安装 3.0 版。

[下载链接](http://www.sencha.com/products/sencha-cmd/download)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-09-26T07:49:02.677

安装sencha

cmd
ruby
​​ compasss
并下载 sencha touch
extarct sencha touch

然后输入

sencha -sdk **PATH TO TOUCH 文件夹**生成应用程序**APPNAME** **PROJECTPATH**

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-02-16T08:38:17.640

尝试导航到安装 sencha cmd 的路径，而不是 sencha sdk 文件夹

1.  打开命令提示符
2.  `cd C:\..\bin\Sencha\Cmd\4.0.2.67`
3.  然后输入`sencha`然后按回车

你应该得到类似的东西`Sencha Cmd V4.0.2.67`

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-06-11T13:48:38.773

我的 SDK 是我提取 ExtJS 文件的地方。
`~/current/gaia/static/js/ext-5.1.1`

您可以像这样从文件夹中生成工作区：
`sencha generate workspace /tmp/extJSworkSpace`
或者
如果您不在文件夹中，则可以指定它的位置。
`sencha -sdk ~/current/gaia/static/js/ext-5.1.1 generate workspace /tmp/extJSworkSpace`

SDK 文件夹的内容如下所示：

```
ls ~/current/gaia/static/js/ext-5.1.1  
build cmd ext-bootstrap.js LICENSE overrides packages Readme.md src      version.properties build.xml examples index.html licenses package.json plugins release-notes.html test welcome 
```

如果您没有指定*-sdk*标志并且**不在**文件夹内，它仍然会创建工作区，但里面不会有“ext”文件夹（**未复制**）。

希望这可以帮助。

# c# - Excel 互操作 COM 未关闭

> ID：13497250
> 
> 赞同：2
> 
> 时间：2012-11-21T16:06:04.847
> 
> 标签：c#, excel, com

我有一些代码可以打开电子表格，读取一些值，然后关闭工作表。我需要对多个文件执行此操作。我遇到的问题是 Excel 应用程序实例没有退出，因此当我为多个文件运行我的进程时，我最终会运行几个 excel.exe 进程。任何想法如何让 Excel 关闭？

```
 static void ParseFile(string file)
    {
        try
        {
            System.Console.WriteLine("parsing:" + file);
            Excel.Application excel = new Excel.Application();
            Excel.Workbook wb = excel.Workbooks.Open(file);
            Excel.Worksheet ws = wb.Worksheets[1];
            for (int i = 2; i < 27; i++)
            {
                log(ws.Cells[i, 1].Text);
            }
            wb.Close(false);                
            excel.Quit();
            excel = null;
            ws = null;
            wb = null;
        }
        catch (Exception ex)
        {
            log(ex.Message);
        }
    } 
```

------2012 年 12 月 11 日更新--------仍然打开 excel 实例--------

```
static void ParseFile(string file)
    {
        try
        {
            log("parsing:" + file);
            Excel.Application excel = new Excel.Application();
            Excel.Workbook wb = excel.Workbooks.Open(file);
            Excel.Worksheet ws = wb.Worksheets[1];
    //do some stuff here
            wb.Close(false);
            excel.Quit();
            GC.Collect();
            GC.WaitForPendingFinalizers();
            Marshal.FinalReleaseComObject(ws);
            Marshal.FinalReleaseComObject(wb);
            Marshal.FinalReleaseComObject(excel);                
            excel = null;
            ws = null;
            wb = null;
            System.GC.Collect();
        }
        catch (Exception ex)
        {
            log(ex.Message);
        }            
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T17:11:54.677

1.  用于`Marshal.FinalReleaseComObject()`释放资源

2.  如果您一个接一个地读取多个文件，那么在性能方面最好只打开/关闭 Excel*应用程序*一次并将打开/关闭应用程序部分移动到单独的函数中

***重构代码：***

```
static Excel.Application OpenExcel(){
    Excel.Application excel = null;
    try{
        excel = new Excel.Application();
        return excel;
    }
    catch(Exception ex){
        log(ex.Message);
        return null;
    }
}

static void ParseFile(string file)
{
    try
    {
        System.Console.WriteLine("parsing:" + file);            
        Excel.Workbook wb = excel.Workbooks.Open(file);
        Excel.Worksheet ws = wb.Worksheets[1];
        for (int i = 2; i < 27; i++)
        {
            log(ws.Cells[i, 1].Text);
        }
        wb.Close(false);    
    }
    catch (Exception ex)
    {
        log(ex.Message);
    }
    finally{
        Marshal.FinalReleaseComObject(ws);
        Marshal.FinalReleaseComObject(wb);
        ws = null;
        wb = null;
    }
}

static void CloseExcel(Excel.Application excel){
    try{
        excel.Quit();
    }
    catch(Exception ex){
        log(ex.Message);
    }
    finally{
        Marshal.FinalReleaseComObject(excel);
        excel = null;
    }
} 
```

***用法：***

```
Excel.Application excel = OpenExcel();
if(excel != null){
    // Parse files in a loop
    ParseFile("fileName");

    // Close excel after parsing all files
    CloseExcel(excel);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-22T16:23:49.333

您可以在实现的实际 COM 对象周围使用包装器对象[`IDisposable`](http://msdn.microsoft.com/en-us/library/system.idisposable.aspx)，以便它可以与[C# 的`using`语句](http://msdn.microsoft.com/en-us/library/yh598w02.aspx)一起使用。

这样做的好处是它将促进可读代码，并且适用于任何 COM 对象。下面是一个运行时调度的例子：

```
using System;
using System.Reflection;
using System.Runtime.InteropServices;

public class ComRef<T> : IDisposable where T : class
{
    private T reference;

    public T Reference
    {
        get
        {
            return reference;
        }
    }

    public ComRef(T o)
    {
        reference = o;
    }

    public void Dispose()
    {
        if (reference != null)
        {
            Marshal.ReleaseComObject(reference);
            reference = null;
        }
    }
}

public class Test
{
    static void Main()
    {
        Type excelAppType = Type.GetTypeFromProgID("Excel.Application");
        using (var comRef = new ComRef<object>(Activator.CreateInstance(excelAppType)))
        {
            var excel = comRef.Reference;
            // ...
            excel.GetType().InvokeMember("Quit", BindingFlags.InvokeMethod, null, excel, null);
        }
    }
} 
```

但是，如果您已经导入了 Excel 的类型库或任何其他类型库，那么您可能需要一些更友好的东西：

```
public class CoClassComRef<T> : ComRef<T> where T : class, new()
{
    public CoClassComRef() : base(new T())
    {
    }
}

public class Test
{
    static void Main()
    {
        using (var comRef = new CoClassComRef<Excel.Application>())
        {
            var excel = comRef.Reference;
            // ...
            excel.Quit();
        }
    }
} 
```

你应该确保你没有捕获到某个超出语句`comRef.Reference`的字段或变量。`using`

请注意，我没有过多考虑线程安全和正确的[`Dispose`实现](http://msdn.microsoft.com/en-us/library/fs2xkftw.aspx)。如果只使用`ComRef`with`using`语句，线程安全并不重要。一个适当的`Dispose`实现将与终结器合作，但这里没有必要，因为`using`基本上是`try-finally`. 如果你`ComRef`在`using`语句中使用 not 并且`Dispose`没有被调用，`ComRef`则只会被垃圾回收，并且底层的 COM 对象也会被回收，如果只有 this`ComRef`引用它，它将被释放。

最后，我没有使用`Marshal.FinalReleaseComObject`，因为这是在您**绝对**确定要释放底层 COM 对象（至少，来自托管环境的所有引用）时进行的，无论它已经（重新）进入托管环境多少次世界。但是，如果你觉得幸运，你可以创建一个新的构造函数，它还接收一个布尔值，说明 if`FinalReleaseComObject`应该被调用而不是`ReleaseComObject`. 任何这些方法的网络搜索的第一个结果将指向文章和博客文章，这些文章和博客文章详细说明了为什么它们通常是邪恶的，一个比另一个多。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-11T15:41:21.237

最终杀死了进程，这是唯一有效的方法。

```
 [DllImport("user32.dll")]
    private static extern uint GetWindowThreadProcessId(IntPtr hWnd, out uint lpdwProcessId);

    /// <summary> Tries to find and kill process by hWnd to the main window of the process.</summary>
    /// <param name="hWnd">Handle to the main window of the process.</param>
    /// <returns>True if process was found and killed. False if process was not found by hWnd or if it could not be killed.</returns>
    public static bool TryKillProcessByMainWindowHwnd(int hWnd)
    {
        uint processID;
        GetWindowThreadProcessId((IntPtr)hWnd, out processID);
        if (processID == 0) return false;
        try
        {
            Process.GetProcessById((int)processID).Kill();
        }
        catch (ArgumentException)
        {
            return false;
        }
        catch (Exception ex)
        {
            return false;
        }            
        return true;
    }

    static void ParseFile(string file)
    {
        try
        {
            log("parsing:" + file);
            Excel.Application excel = new Excel.Application();
            Excel.Workbook wb = excel.Workbooks.Open(file);
            Excel.Worksheet ws = wb.Worksheets[1];
            //do some stuff here
            wb.Close(false);
            int hWnd = excel.Application.Hwnd;
            excel.Quit();
            GC.Collect();
            GC.WaitForPendingFinalizers();
            GC.Collect();
            GC.WaitForPendingFinalizers();
            Marshal.FinalReleaseComObject(ws);
            Marshal.FinalReleaseComObject(wb);
            Marshal.FinalReleaseComObject(excel);                
            excel = null;
            ws = null;
            wb = null;
            GC.Collect();
            GC.WaitForPendingFinalizers();
            GC.Collect();
            GC.WaitForPendingFinalizers();
            TryKillProcessByMainWindowHwnd(hWnd);
        }
        catch (Exception ex)
        {
            log(ex.Message);
        }            
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-12-06T14:47:49.133

我想分享一些关于这个问题的经验。

我重新构建了我的 Excel 互操作代码，以确保我永远不会有超过一个属性期，遵循此网页中所述的“规则”：http: [//jake.ginnivan.net/vsto-com-interop/](http://jake.ginnivan.net/vsto-com-interop/)

前任：

*   我删除了如下字符串...

`ExcelApplication.ExcelWorkbook.Workbookworksheet.WorksheetRange.Range.Count`

（有点夸张）。

-我用以下项目替换了这些字符串......

```
var CurrentRange = currentMDL.CurrentMDL_xlRange;
var CurrentRangeColumns = CurrentRange.Columns;
var CurrentRangeWorksheet = currentMDL.CurrentMDL_Worksheet;
var CurrentRangeWorksheetCells = CurrentRangeWorksheet.Cells; 
```

从这里，我能够更干净地利用我想要的东西。

前任：

```
for(int i = 1; i <= CurrentRangeColumns.Count; i++)
{
//Doing stuff
} 
```

在我完成所有操作之后，我确保以打开它的相同方法关闭我的 Excel 文档。我计划重新访问它，看看我是否能够远程关闭 Excel 文档。

最后，我确保跟进我在 Excel 处理方法中使用的所有 COM 对象的一些版本。

前任：

```
Marshal.FinalReleaseComObject(CurrentRange);
Marshal.FinalReleaseComObject(CurrentRangeCells);
Marshal.FinalReleaseComObject(CurrentRangeRows); 
```

操作顺序在这里很重要。我确保关闭我的工作簿，然后关闭 Excel 应用程序，最后释放了我的 COM 对象。关于 ComObject 版本的使用，我与一位工程师进行了交谈。他说我不应该使用这些调用，因为垃圾收集最终应该会清理我的烂摊子。在这里学习时，我无法通过垃圾收集来关闭我的 Excel 实例并选择自己发布它们。

-克里斯

# matlab - 在 Matlab 上玩 Yahtzee？

> ID：13497252
> 
> 赞同：-1
> 
> 时间：2012-11-21T16:05:16.693
> 
> 标签：matlab, probability

Yatzi 是一种掷 5 个骰子的游戏。我的功能 Yatzi 模拟了 5 个骰子的滚动。该函数应接受一个输入，N umR olls，即掷出 5 个骰子的总次数。该函数应该有四个输出，依次给出以下场景的相对频率（概率）：

*   显示数字 1、2、3、4 和 5 的 5 个骰子
*   两个，也只有两个，骰子
*   显示数字 2 至少两个骰子显示数字 4
*   所有 5 个骰子显示相同的数字

这是我到目前为止所拥有的，但我不知道如何进行。请帮忙！

```
function Yatzi(np)

if nargin == 0
    np=1;
elseif ~(np>0 && real(np) && numel(np)==1)
    error('Invalid input for number of players.')
end

% set up initial points array
points = ones(13,np)*NaN;
% roll variable
roll = zeros(1,5);

    % initialize our rerolls variable
    rerolls = 1:5;

    for t = 1:3
        % throw the dice
        roll(rerolls) = randi(6,[1 length(rerolls)]);
    end
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T16:25:45.577

首先，您可以拥有一个大小矩阵， `5 x np`这样您就可以一次将所有内容存储在那里。您不必使用`for`循环：

```
% throw the dice
roll(rerolls) = randi(6,[5 length(rerolls)]); 
```

然后您扫描矩阵的每一列，并为您要查找的每个结果设置一个计数值。最后你除以总的掷骰数得到概率。

要检查每个结果，您可以有许多`if`子句。为了使其更具可读性，您可以实现一个函数，例如`checkForYahzee(result)`结果将是您的滚动列`roll(:,i)`

每个函数都可以检查不同的东西，例如：

```
if( result(1) == result(2) &&
 result(2) == result(3) &&
 result(3) == result(4) &&
 result(4) == result(5) )
% yahtzee!
end 
```

您可以找到更聪明的方法来保存比较等

# linq - 使用 LINQ/实体框架以编程方式链接 OrderBy/ThenBy

> ID：13497255
> 
> 赞同：14
> 
> 时间：2012-11-21T16:05:22.247
> 
> 标签：linq, entity-framework

我有一个报告界面，最终用户可以在其中为返回的报告的排序顺序选择多个字段。我遇到的问题是我无法真正链接 OrderBy / ThenBy 方法，因为我正在遍历排序字段列表。我在想这样的事情：

```
foreach (string sort in data.SortParams)
{
    switch (sort)
    {
        case "state":
            query = query.ThenBy(l => l.RegionCode);
            break;
        case "type":
            query = query.ThenBy(l => l.Type);
            break;
        case "color":
            query = query.ThenBy(l => l.Color);
            break;
        case "category":
            query = query.OrderBy(l => l.Category);
            break;
    }
} 
```

（注意：为简单起见，我删除了确定这是否是第一个排序项的开关。）

关于如何遍历集合以确定排序顺序的任何想法？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-11-21T16:20:51.400

如果您使用初始“​​种子”OrderBy，您可以做您想做的事：

**编辑**您需要在附加子句之前先调用`OrderBy`创建一个`IOrderedEnumerable`（或）：`IOrderedQueryable``ThenBy`

```
var orderedQuery = query.OrderBy(l => 0);
foreach (string sort in data.SortParams)
{
    switch (sort)
    {
        case "state":
            orderedQuery = orderedQuery.ThenBy(l => l.RegionCode);
            break;
        case "type":
            orderedQuery = orderedQuery.ThenBy(l => l.Type);
            break;
        case "color":
            orderedQuery = orderedQuery.ThenBy(l => l.Color);
            break;
        case "category":
            orderedQuery = orderedQuery.ThenBy(l => l.Category);
            break;
    }
}
query = orderedQuery;  // cast back to original type. 
```

如果您想要更灵活的东西，请查看[此答案](https://stackoverflow.com/questions/41244/dynamic-linq-orderby)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2017-08-03T13:42:10.940

我创建了这些扩展方法来解决问题中所述的相同问题：

```
public static class QueryableExtensions
{
    public static IOrderedQueryable<T> AppendOrderBy<T, TKey>(this IQueryable<T> query, Expression<Func<T, TKey>> keySelector)
        => query.Expression.Type == typeof(IOrderedQueryable<T>)
        ? ((IOrderedQueryable<T>) query).ThenBy(keySelector)
        : query.OrderBy(keySelector);

    public static IOrderedQueryable<T> AppendOrderByDescending<T, TKey>(this IQueryable<T> query, Expression<Func<T, TKey>> keySelector)
        => query.Expression.Type == typeof(IOrderedQueryable<T>)
            ? ((IOrderedQueryable<T>)query).ThenByDescending(keySelector)
            : query.OrderByDescending(keySelector);
} 
```

然后可以将问题中的代码重构为：

```
foreach (string sort in data.SortParams)
{
    switch (sort)
    {
        case "state":
            query = query.AppendOrderBy(l => l.RegionCode);
            break;
        case "type":
            query = query.AppendOrderBy(l => l.Type);
            break;
        case "color":
            query = query.AppendOrderBy(l => l.Color);
            break;
        case "category":
            query = query.AppendOrderBy(l => l.Category);
            break;
    }
} 
```

**备注**这些扩展方法只检查表达式树中的前一个表达式以确定是否使用`OrderBy`or `ThenBy`，中间不允许其他表达式。如果您还想解决这个问题，则必须遍历完整的树，这可能只会增加您不想要的开销:)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-21T16:10:48.220

从可读性的角度来看，可能在一个 Linq 查询中使用所有功能并不是最佳选择。我会使用 IQueryable 在内存中构造您的查询。使用类似的 switch 语句（但使用 IQueryable），然后最后执行 .ToList（即枚举）以在服务器上执行所需的查询。

# vb.net - 如何在 VB 中将此包含引号的文本声明为字符串？

> ID：13497257
> 
> 赞同：1
> 
> 时间：2012-11-21T16:05:24.807
> 
> 标签：vb.net

这是我需要声明为变量的文本：

```
{ "isReadOnly": false, "sku": "393A0001", "clientVersion": 3, "nuc": 2315038076, "nucleusPersonaId": 232865288, "nucleusPersonaDisplayName": "McFux", "nucleusPersonaPlatform": "360", "locale": "en-GB", "method": "idm", "priorityLevel":4, "identification": { "EASW-Token": "" } } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T16:17:55.000

就我个人而言，我更喜欢使用函数为字符串添加引号，纯粹是为了可读性，尤其是在从变量构建字符串时。

```
Function Qt(Byval str as String) as String

    Return """" & str & """"

End Function 
```

这样`"{ """ & isReadOnly & """: false, """ & sku & """: ..."`就变成了：

```
"{ " & Qt(isReadOnly) & ": " & false & ", " & Qt(sku) & ": ..." 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T16:08:54.320

使用双引号来转义字符串中的引号。

例如：

```
Dim s = "{ ""isReadOnly"": false, ""sku"": ..." 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T16:08:36.280

在 VB 中，您可以将引号加倍以对其进行转义：

```
"{ ""isReadOnly"": false, ""sku"": ""393A0001"", ..." 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T16:09:56.347

要转义报价，您只需添加另一个报价。

="{ ""isReadOnly""}"

# java - 标记视图显示带有错误/警告图标的红色方块的标记

> ID：13497258
> 
> 赞同：1
> 
> 时间：2012-11-21T16:05:25.663
> 
> 标签：java, eclipse, rcp, marker

我根据 ibm 教程[使用标记、注释和装饰器开发 Eclipse 插件的最佳实践](http://www.vogella.com/articles/EclipsePlugIn/article.html#resourcemarker_create)创建了自己的标记。

在我的插件 xml 中，我有这样的东西：

```
 <extension point="org.eclipse.core.resources.markers"
      id="com.ibm.mymarkers.mymarker"
      name="My error">
      <super type="org.eclipse.core.resources.textmarker"/>
      <super type="org.eclipse.core.resources.marker"/>     
      <persistent value="true"/>
     </extension> 
```

我还尝试了不同的超级类型，例如
`<super type="org.eclipse.core.resources.problemmarker"/>` 当我创建我设置的标记时：

```
marker.setAttribute(IMarker.SEVERITY, IMarker.SEVERITY_ERROR); 
```

问题是标记显示在标记视图中但没有图标（基本上是红色方块）如何为这些标记定义图标...？

我尝试了 [Vogella](http://www.vogella.com/articles/EclipsePlugIn/article.html#resourcemarker_create)的简单示例，但我仍然没有看到创建标记的任何图像，但没有图像。

```
 IMarker marker = res.createMarker(IMarker.TASK);
      marker.setAttribute(IMarker.MESSAGE, "This a a task");
      marker.setAttribute(IMarker.PRIORITY, IMarker.PRIORITY_HIGH); 
```

我可能错过了一些包含这些图像的插件吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T16:19:10.397

尝试添加类型的扩展`org.eclipse.ui.ide.markerImageProviders`

```
<extension point="org.eclipse.ui.ide.markerImageProviders">
   <imageprovider
         markertype="com.ibm.mymarkers.mymarker"
         icon="marker.png"
         id="myImageProvider">
   </imageprovider>
</extension> 
```

**编辑**

似乎上述扩展点不起作用（！）。看看[这个 SO question](https://stackoverflow.com/questions/2888207/eclipse-plugin-custom-icon-for-a-marker)。

# spring - bean ctor 中的 ANDing 道具

> ID：13497259
> 
> 赞同：3
> 
> 时间：2012-11-21T16:06:22.903
> 
> 标签：spring

属性是否可以在 XML 或 bean 构造中进行与运算？就像是：

```
<constructor-arg value="${walks.like.a.duck} && ${talks.like.a.duck}"/> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T16:17:41.547

从 Spring 3 开始，您可以这样做，请参阅[Spring Expression Language 的文档](http://static.springsource.org/spring/docs/3.0.x/reference/expressions.html)。运算符是`and`，不是`&&`。它应该看起来像：

```
<constructor-arg value="${walks.like.a.duck} and ${talks.like.a.duck}"/> 
```

# css - 使用响应式布局浮动 2 个元素

> ID：13497266
> 
> 赞同：0
> 
> 时间：2012-11-21T16:06:09.873
> 
> 标签：css, css-float, responsive-design

我的页脚中有 2 个 div，我希望 div 1 位于屏幕左侧，而 div 2 位于屏幕右侧。

div 1 的显式宽度为 300px，而 div 2 仅包含一个向左浮动的元素列表。

当页面缩小时，我希望 div 2 放在 div 1 下面。最好的方法是什么？我是否都向左浮动？我是否将 div 1 放在代码中的 div 2 上方？我是否给他们两个明确的宽度？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T16:13:35.330

只需将左侧 div 浮动到左侧，将右侧 div 浮动到右侧，如果包含的 div 缩小太多，它应该将它们堆叠起来。

HTML -

```
<div id="parent">
<div id="left">Left</div>
<div id="right">Right</div>
</div>​ 
```

CSS -

```
#parent {
    width: 25px;
}

#left {
    float: left;
}

#right {
    float: right;
}​ 
```

看看这个 jsfiddle - [http://jsfiddle.net/LaqBm/](http://jsfiddle.net/LaqBm/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T16:09:10.880

您需要浮动两个容器元素并给它们一个固定的宽度。

# xcode - 如何暂时禁用 UIView 背景图像响应界面生成器中的鼠标单击？

> ID：13497267
> 
> 赞同：0
> 
> 时间：2012-11-21T16:07:05.477
> 
> 标签：xcode, xamarin.ios, monodevelop

我有一个要用于视图的 UIView 背景图像。

现在，在这张图片的顶部，我想要按钮并相对于我在图片中看到的内容定位它们。

问题是，在添加背景图像之前，这些按钮已经添加到视图中。所以现在当我放置背景图片时，整个视图都是背景图片，我无法在 Xcode 中访问它下面的按钮。

有没有办法告诉 Xcode 我对 UIView 不感兴趣，但实际上是它下面出现的按钮？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T16:18:38.730

签`- (void)sendSubviewToBack:(UIView *)view`入[UIView](http://developer.apple.com/library/ios/#documentation/uikit/reference/uiview_class/uiview/uiview.html)

会是这样的

```
[self.view sendSubviewToBack:backgroundImageView]; 
```

# delphi - 从表单移动到单元后，TXSLPageProducer 代码不再有效

> ID：13497275
> 
> 赞同：1
> 
> 时间：2012-11-21T16:07:21.307
> 
> 标签：delphi, xslt, delphi-xe2

我正在根据[Bob Swart 的“Delphi XE2 XML, SOAP & Web Services Development”一书中](http://www.ebob42.com/courseware/)的文档对 XML 文档进行 XSL 转换。
使用表单上的 TXSLPageProducer 可以正常工作：

```
procedure TFrmRemoveNamespaces.Button1Click(Sender: TObject);
const
  cRemoveNSTransform =
    '<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">' +
    '<xsl:output method="xml" indent="no"/>' +

    '<xsl:template match="/|comment()|processing-instruction()">' +
    '    <xsl:copy>' +
    '      <xsl:apply-templates/>' +
    '    </xsl:copy>' +
    '</xsl:template>' +

    '<xsl:template match="*">' +
    '    <xsl:element name="{local-name()}">' +
    '      <xsl:apply-templates select="@*|node()"/>' +
    '    </xsl:element>' +
    '</xsl:template>' +

    '<xsl:template match="@*">' +
    '    <xsl:attribute name="{local-name()}">' +
    '      <xsl:value-of select="."/>' +
    '    </xsl:attribute>' +
    '</xsl:template>' +

    '</xsl:stylesheet>';
// From http://wiki.tei-c.org/index.php/Remove-Namespaces.xsl
// This is a quick XSLT script for removing the namespaces from any document. It will remove the prefix as well.
var
  SS: TStringStream;
  TS: TStringList;
  XMLDoc: TXMLDocument;
  XSLPP: TXSLPageProducer;
begin
  XMLDoc := TXMLDocument.Create(self);
  XMLDoc.active := false;
  MmoAfter.Clear;
  SS := TStringStream.Create('',TEncoding.UTF8);
  SS.Position := 0;
  MmoBefore.Lines.SaveToStream(SS);
  SS.Position := 0;
  XMLDoc.LoadFromStream(SS);
  SS.Free;
  TS := TStringList.Create;
  TS.Text := cRemoveNSTransform;
  XSLPP := TXSLPageProducer.Create(self);
  XSLPP.XML := TS;
  XSLPP.XMLData := XMLDoc;
  XMLDoc.active := true;
  MmoAfter.Text := XSLPP.Content;
  TS.Free;
  XMLDoc.Free;
  XSLPP.Free;
end; 
```

但是，如果我将代码移动到单独单元中的类帮助函数，我会在“Result := XSLPP.Content”上得到一个无效的指针操作。
调用代码只是“MmoAfter.Text := TXMLHelper.RemoveNameSpaces(MmoBefore.Text);” 使用此代码形成类帮助器单元：

```
class function TXMLHelper.RemoveNameSpaces(XMLString: String): String;
const
  // An XSLT script for removing the namespaces from any document. It will remove the prefix as well.
  // From http://wiki.tei-c.org/index.php/Remove-Namespaces.xsl
  cRemoveNSTransform =
    '<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">' +
    '<xsl:output method="xml" indent="no"/>' +

    '<xsl:template match="/|comment()|processing-instruction()">' +
    '    <xsl:copy>' +
    '      <xsl:apply-templates/>' +
    '    </xsl:copy>' +
    '</xsl:template>' +

    '<xsl:template match="*">' +
    '    <xsl:element name="{local-name()}">' +
    '      <xsl:apply-templates select="@*|node()"/>' +
    '    </xsl:element>' +
    '</xsl:template>' +

    '<xsl:template match="@*">' +
    '    <xsl:attribute name="{local-name()}">' +
    '      <xsl:value-of select="."/>' +
    '    </xsl:attribute>' +
    '</xsl:template>' +

    '</xsl:stylesheet>';

var
  SS: TStringStream;
  TS: TStringList;
  XSLPP: TXSLPageProducer;
  XMLDoc : TXMLDocument;
begin
  XMLDoc := TXMLDocument.Create(nil);
  //  XMLDoc.active := true;
  SS := TStringStream.Create(XMLString,TEncoding.UTF8);
  SS.Position := 0;
  XMLDoc.LoadFromStream(SS);
  SS.Free;
  TS := TStringList.Create;
  TS.Text := cRemoveNSTransform;
  XSLPP := TXSLPageProducer.Create(nil);
  XSLPP.DOMVendor := GetDOMVendor('MSXML');
  XSLPP.XML := TS;
  XSLPP.XMLData := XMLDoc;
  // XSLPP.Active := true;
  Result := XSLPP.Content;
  TS.Free;
  XMLDoc.Free;
  XSLPP.Free;
end; 
```

如您所见，我必须设置DOMVendor，并且“Create(nil)”是不同的。
最后的差异可能是原因吗？为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T16:44:44.557

将其用作[TXMLDocument 用例中所述的接口](http://docwiki.embarcadero.com/CodeExamples/XE3/en/TXMLDocument_use_case_%28Delphi%29)

```
var
  XMLDoc : IXMLDocument;
begin
  XMLDoc := TXMLDocument.Create( nil );

  // your code ...

  XMLDoc := nil;
end; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-22T09:05:20.020

我找到了一种替代方法，如果我无法使上述方法起作用，我将使用它：

导入类型库、Microsoft XML Parser，然后“使用 MSXML2_TLB”，然后：

```
class function TXMLHelper.RemoveNameSpaces(XMLString: String): String;
const
  // An XSLT script for removing the namespaces from any document. It will remove the prefix as well.
  // From http://wiki.tei-c.org/index.php/Remove-Namespaces.xsl
  cRemoveNSTransform =
    '<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">' +
    '<xsl:output method="xml" indent="no"/>' +

    '<xsl:template match="/|comment()|processing-instruction()">' +
    '    <xsl:copy>' +
    '      <xsl:apply-templates/>' +
    '    </xsl:copy>' +
    '</xsl:template>' +

    '<xsl:template match="*">' +
    '    <xsl:element name="{local-name()}">' +
    '      <xsl:apply-templates select="@*|node()"/>' +
    '    </xsl:element>' +
    '</xsl:template>' +

    '<xsl:template match="@*">' +
    '    <xsl:attribute name="{local-name()}">' +
    '      <xsl:value-of select="."/>' +
    '    </xsl:attribute>' +
    '</xsl:template>' +

    '</xsl:stylesheet>';

var
  Doc, XSL: IXMLDOMdocument2;
begin
  Doc := ComsDOMDocument.Create;
  Doc.ASync := false;
  XSL := ComsDOMDocument.Create;
  XSL.ASync := false;
  try
     Doc.loadXML(XMLString);
     XSL.loadXML(cRemoveNSTransform);
     Result := Doc.TransFormNode(XSL);
  except
     on E:Exception do Result := E.Message;
  end;
end; { RemoveNameSpaces } 
```

# java - JTable Boolean.class

> ID：13497276
> 
> 赞同：1
> 
> 时间：2012-11-21T16:06:26.753
> 
> 标签：java, swing, jtable, jcheckbox, abstracttablemodel

```
import java.awt.BorderLayout;

import javax.swing.JFrame;
import javax.swing.JScrollPane;
import javax.swing.JTable;
import javax.swing.table.AbstractTableModel;
import javax.swing.table.TableModel;

class ColorTableModel extends AbstractTableModel {

  Object rowData[][] = { { "value1", Boolean.FALSE },
      { "value1", Boolean.FALSE }, { "value1", Boolean.FALSE },
      { "value1", Boolean.FALSE}, { "value1", Boolean.FALSE }, };

  String columnNames[] = { "English", "Boolean" };

  public int getColumnCount() {
    return columnNames.length;
  }

  public String getColumnName(int column) {
    return columnNames[column];
  }

  public int getRowCount() {
    return rowData.length;
  }

  public Object getValueAt(int row, int column) {
    return rowData[row][column];
  }

  public Class getColumnClass(int column) {
    return (getValueAt(0, column).getClass());
  }

  public void setValueAt(Object value, int row, int column) {
    rowData[row][column] = value;
  }

  public boolean isCellEditable(int row, int column) {
    return (column != 0);
  }
}

public class EditableColorColumn {

  public static void main(String args[]) {
    JFrame frame = new JFrame("Editable Color Table");
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    TableModel model = new ColorTableModel();
    JTable table = new JTable(model);
    // TableColumn column = table.getColumnModel().getColumn(3);
    // column.setCellRenderer(renderer);
    // column.setCellEditor(editor);

    JScrollPane scrollPane = new JScrollPane(table);
    frame.add(scrollPane, BorderLayout.CENTER);
    frame.setSize(400, 150);
    frame.setVisible(true);
  } 
```

如果我勾选相应的行，我想获得第一列的值。我已经阅读了很多关于此的内容，但我不能只是将其编写为代码。你能编码一些吗？

示例场景，当我勾选`row1`复选框时，`system.out.println()`结果为`value1`.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T19:44:30.383

您的`setValueAt()`in 您的实现`AbstractTableModel`未能触发将通知侦听器更改的事件：

```
@Override
public void setValueAt(Object value, int row, int column) {
    rowData[row][column] = value;
    fireTableCellUpdated(row, column);
} 
```

一旦纠正，a`TableModelListener`将看到每个更改。尝试注释掉该`fireTableCellUpdated()`行以查看差异。

此外：

*   Swing GUI 对象应该*只*在[事件分派线程](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/initial.html)上构建和操作。

*   避免[`set(Preferred|Maximum|Minimum)Size`](https://stackoverflow.com/q/7229226/230513)在 Java Swing 中使用方法；`setPreferredScrollableViewportSize()`只是稍微不那么危险。

代码：

```
import java.awt.BorderLayout;
import java.awt.Dimension;
import java.awt.EventQueue;
import javax.swing.JFrame;
import javax.swing.JScrollPane;
import javax.swing.JTable;
import javax.swing.event.TableModelEvent;
import javax.swing.event.TableModelListener;
import javax.swing.table.AbstractTableModel;
import javax.swing.table.TableModel;

/**
 * @see https://stackoverflow.com/q/13497276/230513
 */
public class EditableColorColumn {

    public static void main(String args[]) {
        EventQueue.invokeLater(new Runnable() {

            @Override
            public void run() {
                new EditableColorColumn().display();
            }
        });
    }

    private void display() {
        JFrame frame = new JFrame("Editable Color Table");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        final TableModel model = new ColorTableModel();
        JTable table = new JTable(model);
        table.setPreferredScrollableViewportSize(new Dimension(400, 150));
        table.getModel().addTableModelListener(new TableModelListener() {

            @Override
            public void tableChanged(TableModelEvent e) {
                System.out.println(model.getValueAt(e.getFirstRow(), 0)
                    + " " + model.getValueAt(e.getFirstRow(), 1));
            }
        });

        frame.add(new JScrollPane(table), BorderLayout.CENTER);
        frame.pack();
        frame.setLocationRelativeTo(null);
        frame.setVisible(true);
    }

    private static class ColorTableModel extends AbstractTableModel {

        String columnNames[] = {"English", "Boolean"};
        Object rowData[][] = {
            {"value1", Boolean.FALSE},
            {"value2", Boolean.TRUE},
            {"value3", Boolean.FALSE},
            {"value4", Boolean.TRUE},
            {"value5", Boolean.FALSE},};

        @Override
        public int getColumnCount() {
            return columnNames.length;
        }

        @Override
        public String getColumnName(int column) {
            return columnNames[column];
        }

        @Override
        public int getRowCount() {
            return rowData.length;
        }

        @Override
        public Object getValueAt(int row, int column) {
            return rowData[row][column];
        }

        @Override
        public Class getColumnClass(int column) {
            return (getValueAt(0, column).getClass());
        }

        @Override
        public void setValueAt(Object value, int row, int column) {
            rowData[row][column] = value;
            fireTableCellUpdated(row, column);
        }

        @Override
        public boolean isCellEditable(int row, int column) {
            return (column != 0);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T16:15:35.453

您可以使用 getSelectedRow() 来获取被选中的行。然后使用 getValueAt(row, column) 其中 row 是您从 getSelectedRow() 获得的值， column 是您想要的列。尝试以下： -

`int row=table.getSelectedRow();`

`String value=table.getValueAt(row, 0).toString();`

其中 0 表示它将返回第一列的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T17:12:04.147

如果只需要获取所选列的值，试试这个

```
table.addMouseListener(new MouseAdapter() {
        @Override
        public void mouseClicked(MouseEvent e) {
            int row = table.getSelectedRow();
            System.out.println("Selected Row ; " + row );
            System.out.println("Velue : " + model.getValueAt(row, 0));
        }
}); 
```

# arm - objdump 不会显示我的 ELF 部分

> ID：13497277
> 
> 赞同：0
> 
> 时间：2012-11-21T16:07:23.300
> 
> 标签：arm, objdump, readelf

我有一个发射 ELF 的工具，据我所知，它符合规范。Readelf 输出看起来不错，但 objdump 拒绝反汇编任何东西。

我已将输入简化为单个全局变量，并使用“int main(void) { return 0;}”来帮助调试 - 小部分的大小是正确的。

特别是，objdump 似乎无法找到sections 表：

```
$ arm-none-linux-gnueabi-readelf -S davidm.elf 
There are 4 section headers, starting at offset 0x74:
Section Headers:
  [Nr] Name              Type            Addr     Off    Size   ES Flg Lk Inf Al
  [ 0]                   NULL            00000000 000000 000000 00      0   0  0
  [ 1] .text             NULL            ff000000 000034 00001c 00  AX  0   0  4
  [ 2] .data             NULL            ff00001c 000050 000004 00  WA  0   0  4
  [ 3] .shstrtab         NULL            00000000 000114 000017 00      0   0  0

$ arm-none-linux-gnueabi-objdump -h davidm.elf 
davidm.elf:     file format elf32-littlearm
Sections:
Idx Name          Size      VMA       LMA       File off  Algn 
```

我还有另一个 ELF，由完全相同的对象构建，仅使用常规工具链生成：

```
$ objdump -h kernel.elf 

kernel.elf:     file format elf32-littlearm

Sections:
Idx Name          Size      VMA       LMA       File off  Algn
  0 .text         0000001c  ff000000  ff000000  00008000  2**2
                  CONTENTS, ALLOC, LOAD, READONLY, CODE
  1 .data         00000004  ff00001c  ff00001c  0000801c  2**2
                  CONTENTS, ALLOC, LOAD, DATA 
```

即使我从“已知良好”的 kernel.elf 中删除了 .comment 和 .ARM.attributes 部分（以防 objdump 需要它们），它仍然很高兴地列出了那里的部分，但不在我工具的 davidm.elf 中。

我已经用 readelf -x 确认了这两个部分的内容是相同的。

我唯一能想到的是 ELF 文件布局不同并且打破了对 BFD 的一些期望，这可以解释为什么 readelf（和我的工具）可以很好地处理它但 objdump 有问题。

完整的自述：

```
ELF Header:
  Magic:   7f 45 4c 46 01 01 01 00 00 00 00 00 00 00 00 00 
  Class:                             ELF32
  Data:                              2's complement, little endian
  Version:                           1 (current)
  OS/ABI:                            UNIX - System V
  ABI Version:                       0
  Type:                              EXEC (Executable file)
  Machine:                           ARM
  Version:                           0x1
  Entry point address:               0xff000000
  Start of program headers:          84 (bytes into file)
  Start of section headers:          116 (bytes into file)
  Flags:                             0x5000002, has entry point, Version5 EABI
  Size of this header:               52 (bytes)
  Size of program headers:           32 (bytes)
  Number of program headers:         1
  Size of section headers:           40 (bytes)
  Number of section headers:         4
  Section header string table index: 3

Section Headers:
  [Nr] Name              Type            Addr     Off    Size   ES Flg Lk Inf Al
  [ 0]                   NULL            00000000 000000 000000 00      0   0  0
  [ 1] .text             NULL            ff000000 000034 00001c 00  AX  0   0  4
  [ 2] .data             NULL            ff00001c 000050 000004 00  WA  0   0  4
  [ 3] .shstrtab         NULL            00000000 000114 000017 00      0   0  0
Key to Flags:
  W (write), A (alloc), X (execute), M (merge), S (strings)
  I (info), L (link order), G (group), x (unknown)
  O (extra OS processing required) o (OS specific), p (processor specific)

There are no section groups in this file.

Program Headers:
  Type           Offset   VirtAddr   PhysAddr   FileSiz MemSiz  Flg Align
  LOAD           0x000034 0xff000000 0xff000000 0x00020 0x00020 RWE 0x8000

 Section to Segment mapping:
  Segment Sections...
   00     .text .data 

There is no dynamic section in this file.

There are no relocations in this file.

There are no unwind sections in this file.

No version information found in this file. 
```

磁盘布局的激进打包是否会造成麻烦？我是否违反了 BFD 期望的某些字节流对齐限制，记录在案或其他方面？

最后 - 这个文件不打算被映射到地址空间，加载程序会将段数据 memcpy 到所需的位置，因此不需要播放对 mmap 友好的文件对齐技巧。保持 ELF 小更重要。

干杯，大卫M

编辑：我被要求上传文件，和/或提供'objdump -x'。所以我两个都做了： [davidm.elf](https://www.dropbox.com/s/mnvq2vnkvkyxj00/davidm.elf)

```
$ objdump -x davidm.elf 

davidm.elf:     file format elf32-littlearm
davidm.elf
architecture: arm, flags 0x00000002:
EXEC_P
start address 0xff000000

Program Header:
    LOAD off    0x00000034 vaddr 0xff000000 paddr 0xff000000 align 2**15
         filesz 0x00000020 memsz 0x00000020 flags rwx
private flags = 5000002: [Version5 EABI] [has entry point]

Sections:
Idx Name          Size      VMA       LMA       File off  Algn
SYMBOL TABLE:
no symbols 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T08:04:32.363

好的 - 终于想通了。

在一个小测试应用程序的上下文中构建和注释/调试 libbfd（函数 elf_object_p()）后，我发现它为什么不匹配任何 BFD 支持的目标。

我的节标题有错误的 sh_type 标志：NULL。适当地发出 STRTAB 或 PROGBITS（当我到达那一步时最终会发出 NOBITS）并且 objdump 很高兴地走我的形象。

回想起来，这并不奇怪 - 我更生气的是我在比较 readelf 输出时没有发现这一点：（

谢谢大家的帮助:)

# c# - 复合属性

> ID：13497281
> 
> 赞同：6
> 
> 时间：2012-11-21T16:06:37.330
> 
> 标签：c#, .net, reflection, attributes

有没有办法在 C# 中制作复合属性以在编译时提供等效的元数据？

例如，改变：

```
[ClassInterface(ClassInterfaceType.AutoDual)]
[ProgId("MyProgId")]
[MyMefExport("MyProgId")]
public class MyClass
{
} 
```

到：

```
[MyCompositeAttribute("MyProgId")]
public class MyClass
{
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T16:17:56.267

属性本身是没有意义的。它是枚举附加到一个类的属性的代码，这些属性可能会改变它的操作。

如果您控制理解该属性的代码，您可以创建一个复合属性并像应用了多个单独的属性一样行事。

话虽如此，我怀疑您控制[ProgId](http://msdn.microsoft.com/en-us/library/System.Runtime.InteropServices.ProgIdAttribute.aspx)或解释它的 C# 编译器...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T16:17:22.313

假设您有以下代码来读取您的自定义属性：

```
var attrs = typeof(MyClass).GetCustomAttributes(typeof(MyCompositeAttribute) ,false); 
```

任何依赖的代码都说：

```
var attrs = typeof(MyClass).GetCustomAttributes(typeof(ProgId) ,false); 
```

将无法返回该属性。

# c++ - 针对库创建 TextMate“运行”命令链接

> ID：13497283
> 
> 赞同：0
> 
> 时间：2012-11-21T16:06:47.503
> 
> 标签：c++, boost, linker, textmate

我一直在尝试使用 TextMate 作为替代编辑器。该`run`快捷方式非常适合快速轻松地测试想法。我已经通过 homebrew 安装了 boost，该`run`函数会很高兴地找到、包含和构建带有诸如`boost/lexical_cast.hpp`. 伟大的！

我现在想构建一个需要链接到`boost_system-mt`. 有没有一种简单的方法可以将此链接器步骤添加到 textmate 项目中？

**编辑**

好的。如果我添加`-lboost_system-mt`到捆绑编辑器中的运行命令，我可以让它工作，但我无法理解如何将它链接到单个项目。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T17:07:41.750

好的，这很简单。如果您查看捆绑编辑器中的代码，您可以看到将标志添加到构建设置的代码位。. .

```
flags = ENV["TM_#{env}_FLAGS"] || "-incl... 
```

...看到环境是 CXX，这意味着您需要添加一个名为 contains 的“项目特定的 shell 变量`TM_CXX_FLAGS`” `boost_system-mt`。为此，请查看显示项目中所有文件的左侧小窗格的底部，然后单击“i”。这将显示项目信息，您可以在其中添加必要的变量。

![在此处输入图像描述](../Images/5cb9be0e6bdec296488a2e34924f6524.png)

如果您愿意，可以使用双引号将大量编译标志放在那里，使 TextMate 能够运行几乎任何东西！

# java - 如何初始化图形g？

> ID：13497289
> 
> 赞同：5
> 
> 时间：2012-11-21T16:07:53.503
> 
> 标签：java, swing, graphics, awt

生命结束后，我想在吃豆人游戏中显示 GameOver 图像。但是我调用paintGameOverScreen(Graphics g) 然后我需要初始化g。有没有其他方法可以做到这一点？

这是我的生活课

```
import java.awt.Color;
import java.awt.Graphics;
import java.awt.Image;
import java.awt.image.BufferedImage;

import javax.imageio.ImageIO;
import javax.swing.ImageIcon;

public class Lives{

private int lives;

public Lives() {
    lives = 1;
}

public void removeLife() {

        lives--;
        if(lives==0){
            System.out.println("END GAME");
            paintGameOverScreen(g);
            System.exit(0);
        }
}

public void paintGameOverScreen(Graphics g) {

            ImageIcon i = new ImageIcon("src\image");
            Image image = i.getImage();
            int x = 0;
            int y = 0;
            g.drawImage(image, x, y, 100,100,null);
}

public void paint(Graphics g) {
    g.setColor(Color.WHITE);
    g.fillRect(5*20, 25*20, 100, 30);
    g.setColor(Color.BLACK);
    String result = "Lives: " + lives;
    g.drawString(result, 6*20, 26*20);
}
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-22T01:09:06.737

您永远不会打电话`paint()`或`paintComponent()`自己打电话，您总是会经历`repaint()`这将负责设置适当的`Graphics`

只是为了展示@mKorbel 指的是什么：

```
import java.awt.Color;
import java.awt.Dimension;
import java.awt.Graphics;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.net.MalformedURLException;
import java.net.URL;

import javax.swing.ImageIcon;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.SwingUtilities;
import javax.swing.Timer;

public class Lives extends JPanel {
    private int lives;
    private ImageIcon gameOverImage;

    public Lives() {
        try {
            gameOverImage = new ImageIcon(new URL("http://imgup.motion-twin.com/dinorpg/0/f/77acf80b_989624.jpg"));
        } catch (MalformedURLException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
        lives = 5;
    }

    public void removeLife() {
        if (lives > 0) {
            lives--;
            System.out.println("Left lives: " + lives);
            repaint();
        }
    }

    @Override
    protected void paintComponent(Graphics g) {
        super.paintComponent(g);
        if (lives > 0) {
            System.out.println("Still have " + lives + " lives");
            g.setColor(Color.WHITE);
            g.fillRect(5 * 20, 25 * 20, 100, 30);
            g.setColor(Color.BLACK);
            String result = "Lives: " + lives;
            g.drawString(result, 6 * 20, 26 * 20);
        } else if (gameOverImage != null) {
            System.out.println("Game over");
            int x = (getWidth() - gameOverImage.getIconWidth()) / 2;
            int y = (getHeight() - gameOverImage.getIconHeight()) / 2;
            g.drawImage(gameOverImage.getImage(), x, y, gameOverImage.getIconWidth(), gameOverImage.getIconHeight(), this);
        }
    }

    @Override
    public Dimension getPreferredSize() {
        return new Dimension(800, 600);
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                JFrame frame = new JFrame(Lives.class.getSimpleName());
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                final Lives lives = new Lives();
                frame.add(lives);
                frame.pack();
                frame.setVisible(true);
                // Dummy timer that reduces the lives every second. For demo purposes only of course
                Timer t = new Timer(1000, new ActionListener() {

                    @Override
                    public void actionPerformed(ActionEvent e) {
                        lives.removeLife();
                    }
                });
                t.start();
            }
        });
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-21T16:30:22.280

*   对于公共`void paint(Graphics g)`{ 是否有遗漏的容器，

*   `JPanel`（在某些情况下`JComponent`）可能是当今 Java 的容器

*   必须使用`paintComponent`而不是`paint()`

*   在里面`paintComponent`你可以标记`paintGameOverScreen`，然后只有油漆`BufferedImage`

*   之前准备好所有`Objects`，因为`local variable`，不要`FileIO`在里面加载任何（加载图像）`paint()`，`paintComponent()`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-16T15:09:02.117

这是我的做法：

```
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.image.BufferedImage;

public class InitializeGraphics
  {
        static BufferedImage buffer = null;
        static int height = 10;
        static int width = 10;
        static Graphics2D g2;

        public InitializeGraphics() {
                buffer = new BufferedImage(width, height, BufferedImage.TYPE_INT_ARGB_PRE);
                g2 = buffer.createGraphics();
                g2.fillOval(2, 2, 2, 2);
                g2.dispose();
        }
        protected void paintComponent(Graphics g) {
                int x = 0;
                int y = 0;
                g.drawImage(buffer, x, y, width, height, null);
        }
        public Graphics2D getGraphics(){
                return g2;
        }
    } 
```

然后某处： InitializeGraphics instance=new InitializeGraphics(); Graphics2D gG2 = instance.getGraphics();

# tfs - TFS 2012 自动构建依赖于当前项目的项目

> ID：13497295
> 
> 赞同：2
> 
> 时间：2012-11-21T16:07:17.173
> 
> 标签：tfs, continuous-integration, build-automation, tfsbuild

好吧，我不得不承认，我对所有这些构建自动化的东西都很陌生。但基本上我想知道的是，如果我有这样的情况，是否有办法连接我的构建定义

*   ProjectA 生成 ComponentA.dll
*   ProjectB 引用 ComponentA.dll 并生成 ComponentB.dll
*   ProjectC 引用 ComponentB.dll

然后，当我对 ProjectA 进行更改并签入时，构建过程也会自动构建 ProjectB，最后是 ProjectC，并报告任何错误。

那么有没有办法做到这一点，或者首先应该以某种方式完全不同地处理这种事情？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-22T22:26:49.560

您所指的过程是称为[***持续集成***](http://en.wikipedia.org/wiki/Continuous_integration)的实践的关键。

TFS 做得很好：只需将构建定义设置[`Trigger`](http://msdn.microsoft.com/en-us/library/hh190718#reason_individual_ci)为`Continuous Integration`并将[`Workspace`](http://msdn.microsoft.com/en-us/library/hh190721.aspx)工作文件夹设置为三个项目的父文件夹。这样，其中一个项目的任何更改都将触发构建。

[MSDN：持续构建和部署](http://msdn.microsoft.com/en-us/library/ee308011.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T17:11:19.040

您可以使用 Visual Studio 解决方案并在项目之间使用项目引用。然后在您的构建服务器上构建解决方案。

# html - CSS 不透明度在 Internet Explorer 7 中不起作用？

> ID：13497296
> 
> 赞同：0
> 
> 时间：2012-11-21T16:07:21.230
> 
> 标签：html, css, internet-explorer, filter, opacity

我已经查看了有关此问题的其他问题，但找不到解决方案。

我试过这个：

```
.picpic:hover{
-ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=50)";
filter: alpha(opacity=50);
-moz-opacity:0.5;
-khtml-opacity: 0.5;
opacity: 0.5;
} 
```

html是这样的

```
<a href="xx"><img class="picpic" src="zz.png"></a> 
```

我可以在这里得到一些帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T16:11:24.250

基本上正在发生的事情是您的 IE 特定的不透明度线 -`filter: alpha(opacity=50);`被`opacity: 0.5;`在其他浏览器/IE 版本中工作的通用线覆盖。

专门为 IE7 试试这个：

```
 <!--[if IE 7]>
    .opaque2 {  // for IE5-7
        filter: alpha(opacity=50);
    }
 <![endif]--> 
```

如果它适用于所有其他浏览器/版本，请确保使用条件注释。

# ruby-on-rails - 理解 will_paginate 参数

> ID：13497306
> 
> 赞同：1
> 
> 时间：2012-11-21T16:07:59.123
> 
> 标签：ruby-on-rails, will-paginate, railstutorial.org

Total Rails 菜鸟，学习 Rails 教程视频。我一直到最后一节课，还有一些我不明白的地方：

```
@users = @user.followed_users.paginate(page: params[:page]) 
```

具体来说，我没有跟踪的是`paginate(page: params[:page])`. 我查看了[分页文档](http://rubydoc.info/github/mislav/will_paginate/Array#paginate-instance_method)，我知道分页方法可以采用三个参数，`:page`其中之一。我认为这个参数的意思是“当前页面”，但是 will_paginate 文档说它默认为 1。

我也知道（认为）`params[:page]`指的是内置的 Rails 参数哈希，意思是当前会话参数。对？

所以...我不明白。为什么我需要它？符号是如何`:page`进入`params`散列的？这真的*有什么作用？*

有关其他上下文，请参阅[Ruby 教程一书中](http://ruby.railstutorial.org/chapters/following-users#sec-stats_and_a_follow_form)的清单 11.30 。任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T16:27:42.570

我认为您可能误解的是 Ruby 参数在这种情况下是如何工作的。`paginate`实际上并不需要 3 个参数，而是需要一个带有三个选项（键/值对）的哈希参数。

在 Ruby 中，当您将键/值对作为最后一组参数传递时，它们会自动转换为哈希。例如，以下是等价的：

```
paginate({page: 1}) 
```

是相同的：

```
paginate(page: 1) 
```

所以实际上你正在做的是传递一个参数，它是一个具有多个键/值对的散列。

现在专门回答你的问题：

> 为什么我需要它？

您需要传入此值，以便 will_paginate 知道您当前在哪个页面上。它默认为第一页，因为在初始页面加载时，您`?page=x`的 URL 中没有。切换到不同的页面后，它会`page`从 URL 中获取值并将其传递给 paginate 方法。

> :page 符号如何进入 params 哈希？

作为 URL 中查询参数一部分的任何参数都将被 Rails 自动传递给 params 哈希（更可能是 Rails 构建的[Rack ）](http://rack.rubyforge.org/doc/classes/Rack/Request.html#M000275)

> 这真的有什么作用？

我希望上面回答了这个问题，但如果没有，也许它为您提供了足够的信息来提出更具体的问题。

# gcc - gcc 编译器不会在第一个错误时停止

> ID：13497307
> 
> 赞同：19
> 
> 时间：2012-11-21T16:08:58.510
> 
> 标签：gcc, compiler-construction, compiler-errors, compiler-flags

在第一个错误之后如何让 gcc 不停止编译。是否有一个编译器标志可以做到这一点？

基本上我想删除一个类，但我不确定这会产生多大的影响，所以我想确定如果我从makefile中删除类会有多少类有问题。

有没有更好的方法来确定这种影响？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-11-21T16:29:50.000

在第一个错误之后有一个[GCC 编译器选项](http://gcc.gnu.org/onlinedocs/gcc-4.4.4/gcc/Warning-Options.html) `-Wfatal-errors`可以停止：

> -Wfatal-errors
> 此选项使编译器在发生第一个错误时中止编译，而不是尝试继续运行并打印更多错误消息

如果您想将警告视为错误，您也可以使用`-Werror`，这样您就可以捕获删除类时可能生成的任何警告。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T16:46:50.290

> 有没有更好的方法来确定这种影响？

使用许多 IDE 中内置的重构支持。例如，使用 NetBeans，您可以选择重命名一个类并预览所有受影响的位置。

如果没有 IDE，您可以重命名类/方法/字段，而不是删除它，并通过多次编译运行逐渐更改旧名称的所有用法，其中编译器会出错。然后 grep 获取新名称。

# hta - 独立的 HTML 应用程序

> ID：13497313
> 
> 赞同：0
> 
> 时间：2012-11-21T16:08:18.747
> 
> 标签：hta

是否有可以创建**独立 HTA**的应用程序，这意味着无需`'mshta.exe'`运行且不留下任何临时文件？我试过`'htaedit'`了，但它需要`'mshta.exe'`并留下临时文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T17:50:55.293

我不认为 hta 可以独立运行。它更像是一种由 mshta.exe 解释的解释性语言。有点像 jvm 如何解释 java 字节码

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-08-18T12:09:04.733

[![在此处输入图像描述](../Images/fc5da0591a63037431a81802fd397bbb.png)](https://i.stack.imgur.com/t5CCK.png)

您可以使用 iexpress.exe 创建一个自提取驱动器：

1.  压缩 mshta.exe 的副本和您的 hta 文件
2.  在运行时将它们解压缩到临时文件夹
3.  并运行指定的命令。例如：`mshta <the hta filename>.hta`

iexpress 通常用于创建快速而肮脏的安装程序。我在找到将`.bat`/`.cmd`文件转换为`.exe`

# c# - 如何使用 LINQ 语句从 SharePoint 获取信息

> ID：13497316
> 
> 赞同：1
> 
> 时间：2012-11-21T16:09:23.417
> 
> 标签：c#, linq, sharepoint-2010

我正在开发一个小应用程序来在 SharePoint 中运行一些计时器作业。我不只是使用 a`foreach`来遍历所有作业并选择我想要的作业，而是尝试通过 Linq 语句通过 Guid 选择它们。但是，我运气不佳。这是我到目前为止所拥有的：

```
 foreach (SPService service in centralAdmin.Farm.Services)
{
   var traceJob =
       from jobDefinition in service.JobDefinitions
       where jobDefinition.Id == traceGuid
       select jobDefinition;

   SPJobDefinition jobInfo = traceJob as SPJobDefinition
   Console.WriteLine(jobInfo.DisplayName);
 } 
```

**编辑**我收到的错误是“NullReferenceException”`Console.WriteLine(jobInfo.DisplayName)`

我确信我错过了一些东西，因为这是我第一次使用 LINQ 语句，但我无法弄清楚我做错了什么。我将 traceJob 转换为因为`SPJobDefinition`否则我无法访问. 任何提示或指示将不胜感激！`SPJobDefinition``traceJob`

**编辑** 枚举在搜索 Guid 时不会产生任何结果。但是，如果我执行以下代码：

```
 foreach (SPJobDefinition jobDefinition in service.JobDefinitions)
    {
     if (jobDefinition.Id == traceGuid)
     {
       jobDefinition.RunNow();
       Console.WriteLine(jobDefinition.DisplayName);
     }
    } 
```

它将完全恢复我期望看到的内容——作业定义的显示名称。这似乎表明问题不在于有缺陷的 Guid 或不存在的作业。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T16:12:09.643

LINQ 返回一个结果枚举器，无论您的查询总是最多返回一个项目。而且由于 LINQ 返回枚举器而不是实际结果，因此您必须对其*进行迭代*。通过调用`ToList()`，`FirstOrDefault()`或任何类似的方式。

试试这个语句：

```
SPJobDefinition jobInfo = traceJob.SingleOrDefault() ?? new SPJobDefinition(); 
```

由于您的结果对象已经是正确的类型，因此不需要强制转换。我还使用了*空合并*运算符以防您的 LINQ 语句不返回任何内容（作业信息不存在）。在这种情况下`SingleOrDefault()`将返回`null`，因为这是引用类型的默认值。

您当然可以省略空合并操作并`null`在使用前检查`jobInfo`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T16:23:50.493

你得到的异常是因为你的`as`操作总是会失败，当`as`失败时它不会抛出异常，它只是返回 null。异常来自使用该空值。

`traceJob`根本不需要演员。使用`var`并不意味着它实际上是变量类型，甚至根本不知道。它只是意味着编译器将查看右边的表达式`=`并使用它（静态地，在编译时）来确定该变量的类型。在这种情况下，将鼠标悬停`var`会显示它实际上是一个`IEnumerable<SPJobDefinition>`. 您拥有的是*一系列*工作定义，而不仅仅是一个。`First`您可以通过、`FirstOrDefault`、`Single`或轻松获取序列中的第一项`SingleOrDefault`。这样做之后，您将只有一个项目，并且您根本不需要投射它。

```
var traceJob =
    (from jobDefinition in service.JobDefinitions
    where jobDefinition.Id == traceGuid
    select jobDefinition)
    .SingleOrDefault();

if(traceJob != null)
    Console.WriteLine(traceJob.DisplayName); 
```

# jquery - 在没有表单的情况下使用 AJAX 和 Jquery

> ID：13497318
> 
> 赞同：0
> 
> 时间：2012-11-21T16:09:29.577
> 
> 标签：jquery, ajax

我之前已经成功地将 JQuery 与 Ajax 一起使用，但仅用于表单元素（使用 GET 和 POST）。我试图弄清楚如何将 Jquery 和 AJAX 用于非表单元素。我有一个这样的列表：

*   项目1
*   项目2

当用户单击一个项目时，我需要它访问服务器并将项目编号写入数据库而不刷新页面。

有人可以帮帮我吗？

* * *

编辑：使用 PHP

这是我正在使用但不知道如何正确使用的代码：

```
$(document).ready(function(){
$("#rating_toggle").click(function() {
    $.ajax({
        type: "POST",
        url: "rating/test",
        data: "????????",
        success: function(data){
            alert(data);
        }
    });
    return false;
}); 
```

});

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T16:13:04.107

您仍然可以发送 ajax 请求单击非表单元素的元素。

从您的请求中删除 return false .. 这不是必需的..

```
$('li').on('click', function(){

    $.ajax({
            url : 'rating/test',
            type : 'POST',
            dataType : 'json',
            data : { your data},
            success :  function(result){
                alert('Inserted into database')
             },
             error : function(xhr,text ,error){
                alert('Error occured !!')
             }
           });

}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T16:17:15.080

我写了这个快速的小片段

```
$(function() {
    $('ul li').click(function() {
        var selectListItem = $(this).text();
        $.ajax({
            type: "POST",
            url: "yourserverpage.php",
            data: { selectedItem: selectListItem },
            success: function(returnData) { alert('Saved '+selectListItem+' and returned '+ returnData); }
        });
    });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T16:14:57.807

这就是我会做的...

*   用于`$(selector).on('click', function(){ ... })`绑定要通过单击列表项触发的事件
*   用于`$(this).index()`获取与它的兄弟姐妹相关的项目的索引（从绑定的点击函数中）
*   用于`$.post(url,data,success_callback)`向服务器发送数据，其中`url`是一个简单的 url 字符串，data 是根据您要发送的数据构建的 javascript 对象，`success_callback`是服务器端发送接收/处理确认后运行的函数。

在服务器上，php 将收到一个请求，其中包含一堆`$_POST`数据，这些数据与 ajax 请求中发送的数据对象的键匹配。

# java - 新字符串查询中的表中的字符串

> ID：13497320
> 
> 赞同：-1
> 
> 时间：2012-11-21T16:08:40.913
> 
> 标签：java, android, sqlite

我得到了这个代码：

```
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_clicked);
    String query = "SELECT ROWID _id, linie"
            + " FROM linie";

    ArrayList<String> HaltestellenListe = CursorToArray(getApplicationContext(), query, new String[] {});

    final ListView lvD = (ListView) findViewById(R.id.lvClicked);

    ArrayAdapter<String> arrayAdapter = new ArrayAdapter<String>(this, R.layout.activity_clicked, R.id.tvClicked, HaltestellenListe);
    lvD.setAdapter(arrayAdapter);
    lvD.setDividerHeight(8);

    lvD.setOnItemClickListener(new OnItemClickListener() { 
             @Override
             public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
                  String linie = lvD.getItemAtPosition(position).toString();

                 }
        });

}

public ArrayList<String> CursorToArray(Context ApplicationContext, String query, String[] whereClause){
    ArrayList<String> ArrayList = new ArrayList<String>();

    DataBaseHelper dbHelper = new DataBaseHelper(getBaseContext());

    Cursor c = dbHelper.dbHelper(ApplicationContext).rawQuery(query, whereClause);
    dbHelper.close();

    c.moveToFirst();

    while (!c.isAfterLast()){

        if (c.isNull(c.getColumnIndex("linie")) == false){
            ArrayList.add(c.getString(c.getColumnIndex("linie")));  
        }

        c.moveToNext();
    }
    c.close();

    return ArrayList;
} 
```

使用 setonitemclicklistener 我得到点击位置的字符串。我如何将此字符串用于这样的新字符串查询：

```
lvD.setOnItemClickListener(new OnItemClickListener() { 
             @Override
             public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
                  setContentView(R.layout.activity_clicked);
                  String newQuery = "SELECT ROWID _id, linie" + "FROM linie" + "WHERE name =" + lvD.getItemAtPosition(position).toString();                   
                  ArrayList<String> ClickedList = CursorToArray(getApplicationContext(), newQuery, new String[] {});
                  final ListView lvD = (ListView) findViewById(R.id.lvClicked);                 
                  ArrayAdapter<String> arrayAdapter = new ArrayAdapter<String>(this, R.layout.activity_clicked, R.id.tvClicked, ClickedList);
                  lvD.setAdapter(arrayAdapter);
                  lvD.setDividerHeight(8);

                 }
        }); 
```

我希望新文本在同一个列表视图中，我想在新查询中使用第一个查询中的字符串。我对java很陌生，所以请帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T16:22:02.207

1.  您需要在查询中的名称值周围加上引号，并在两者之间放置空格，如下所示：

    ```
    String newQuery = "SELECT ROWID _id, linie" + " FROM linie " + 
               " WHERE name = '" + lvD.getItemAtPosition(position).toString()+"'"; 
    ```

2.  由于您`lvd`是最终的，因此它可以直接在您的方法中使用。删除该行以在下面找到它以再次找到它：

    ```
    //remove this line
    final ListView lvD = (ListView) findViewById(R.id.lvClicked); 
    ```

# android - 索引 8 无效，在 android 中大小为 8

> ID：13497321
> 
> 赞同：0
> 
> 时间：2012-11-21T16:08:42.973
> 
> 标签：android

我面临问题。当我在数组中输入 8 个值时，我可以使用 array.size() 确认数组的大小为 8，但是当我调用以下循环时，它会给我出站异常。我在一个循环周期中遍历 4 个值。

```
 for (int pos=0; pos < array.size(); pos += 4)
    {
         id = db.insert(array.get(pos), array.get(pos+1), array.get(pos+2));

         id_array.add(String.valueOf(id));
         id_array.add(array.get(pos+=3));
    } 
```

请帮忙

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T16:14:33.787

您的数组大小为 8，因此它的索引从 0 到 7。在您的循环中，当 pos 为 0 时，`pos+=3`语句使其变为 3，然后将其递增 4，使其变为 7，当您调用时，`pos+1`您会得到异常.

我想这是一个错字，并且：

```
id_array.add(array.get(pos+=3)); 
```

应该

```
id_array.add(array.get(pos+3)); 
```

此外，您真正的终止条件是`pos+3`必须是数组中的有效位置，因此您应该使用：

```
for (int pos = 0; pos + 3 < array.size(); pos += 4) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T16:14:52.523

问题是您尝试在位置 8 访问数组。如果大小为 8，则表示数组从 0 填充到 7。

# php - htaccess 正则表达式 - 有没有办法捕获编码的网址？

> ID：13497326
> 
> 赞同：0
> 
> 时间：2012-11-21T16:09:49.130
> 
> 标签：php, regex, apache, .htaccess, redirect

我需要捕获具有可以编码的任何字符的 URL。例如 +、{space}、[,] 等。我厌倦了以下操作但没有工作 -

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} ^(.*)(\s|\+|\%)+(.*)$
RewriteRule ^(.*)$ /content/my-rewrite-redirect.php [L]
RewriteCond %{HTTPS} off
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ http://mydomain.com/content/$1$1 [QSA,L]
RewriteCond %{HTTPS} on
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ https://mydomain.com/content/$1 [QSA,L] 
```

(\s|+|\%) - 尝试捕获空格字符和任何已在 URL 中编码的字符，但它不捕获 URL，例如 - [http://mydomain.com/vertical%5B1%5D.jpg](http://mydomain.com/vertical%5B1%5D.jpg)

谢谢你的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T16:19:24.320

您遇到的问题可能是 Apache 在访问 htaccess 之前对 URL 进行了解码。您应该尝试创建一个正则表达式来搜索任何将被 URL 编码的字符，而不是搜索编码字符。

例如：

```
RewriteCond %{REQUEST_FILENAME} [!@#$%^&*`~\(\)\\/\[\]\{\}\+]+ 
```

当然，还有更多符合条件的角色……这只是一个例子

# javascript - Javascript 和 jquery 与 IE 一起工作

> ID：13497327
> 
> 赞同：0
> 
> 时间：2012-11-21T16:08:54.267
> 
> 标签：javascript, jquery, internet-explorer

我的 html 页面无法在 IE 浏览器中运行。如果我打开 F12 开发人员工具，它就会开始工作。我的页面可以使用 chrome。我猜这是由 jquery 和 javascript 引起的。谁能知道如何使它工作？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T16:11:07.113

如果您在其中的任何地方使用 console.log，IE 会使您的脚本崩溃。开发人员工具添加了控制台功能 - 因此，如果您打开它，它就可以工作。删除console.log，它应该可以正常工作了。

Chrome/Firefox 默认支持这个，这就是为什么它在那里工作没有问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T16:20:21.883

您可能在某处的代码中使用了 console.log() 。除非开发工具窗口处于活动状态，否则 IE 控制台对象不存在。

# python - 在 Python 中重新启动 HTTP 服务器的正确方法

> ID：13497330
> 
> 赞同：4
> 
> 时间：2012-11-21T16:09:02.910
> 
> 标签：python, http, webserver

我正在使用下面的代码片段在 Python 中编写 HTTP 服务器。服务器运行良好，直到发生一些 IOError 导致它重新启动。我的重新启动处理有问题，因为服务器启动正常但此后不接受任何请求。

这段代码有什么问题吗？

```
#!/bin/python
from BaseHTTPServer import HTTPServer
import json
import config
import time
import socket
from SimpleHTTPServer import SimpleHTTPRequestHandler
from SocketServer import BaseServer

class MyHandler(SimpleHTTPRequestHandler):
   def parseArgs(self):
        args = {}
        try:
            config.logging.info(self.path)
            args_list = self.path.split("?")[1].split("&")
            for entry in args_list:
               args[entry.split("=")[0]] = entry.split("=")[1]
        except IndexError:
            pass
        return args

   def do_GET(self):
      try:
        response = {}
        args = self.parseArgs()
        config.logging.debug("Handle the request")
        self._handle_request(args, response)
        config.logging.debug("Write the header back to the client.")
        self.send_response(200)
        self.send_header('Access-Control-Allow-Origin', '*')
        self.send_header('Content-Type:', 'application/json; charset=UTF-8')
        self.end_headers()
        config.logging.debug("Finish writing the header and start writing JSON response.")
        json_encoded = json.dumps(response)
        config.logging.debug(json_encoded)
        self.wfile.write(json_encoded)
        config.logging.debug("JSON Response written successfully.")
      except Exception as e:
        config.logging.exception('Exception occurs when writing back the response.')
      return

   def _handle_request(self, args, response):
      try:
        response["sysTime"] = long(round(time.time() * 1000))
        if not "cmd" in args:
           response["message"] = "Error: No command provided."
        else:
           response["message"] = args['cmd']
      except Exception as e:
          response["message"] = "Error: Exception occurs (check logs)."
          config.logging.exception('Exception occurs when handling request.')

   def do_POST(self):
       self.send_response(200)
       self.send_header('Content-type',     'text/html')
       self.end_headers()
       self.wfile.write("Nothing here :( ")

def main():
   while True:
    try:
        httpd = HTTPServer(('', config.listening_port), MyHandler)
        sa = httpd.socket.getsockname()
        msg = "Serving HTTP on " + sa[0] + " port " + str(sa[1]) + "..."
        print msg
        config.logging.info(msg)
        httpd.serve_forever()
    except KeyboardInterrupt:
        print '^C received, shutting down server'
        config.logging.info('^C received, shutting down server')
        httpd.socket.close()
        break
    except Exception as e:
        httpd.shutdown()
        httpd.socket.close()
        print "Error occurs. Retry in 5 seconds"
        config.logging.exception('Exception occurs. Retry in 5 seconds.')
        time.sleep(5)

if __name__ == '__main__':
    main() 
```

很抱歉错过了模块配置。

```
import logging

# global variables
listening_port = 9001
logging.basicConfig(filename='error.log', level=logging.INFO, format='%(asctime)s - %(levelname)s - %(message)s', datefmt='%m/%d/%Y %I:%M:%S %p') 
```

运行它的一个 url 是`http://localhost:9001/?cmd=some_command`. 只需在服务器启动后将其粘贴到任何浏览器中即可。

**编辑：**

我想这与 KVM 或它在我公司机器上的设置方式有关。由于我的服务器运行在只能通过 ssh 访问的 KVM 上，每次我退出 ssh 会话时，调用上面的 url 命令（在 chrome 中），等到 chrome 通知未连接，返回 ssh 会话，调用 url再次命令，错误发生了。

我将调试消息放在 do_GET() 中的写入响应之间`self.send_response(200)`。当异常发生时，这就是我得到的踪迹。我想这与`sys.stderr.write`log_message 内部有关。

```
11/23/2012 10:58:29 AM - INFO - Handle the request
11/23/2012 10:58:29 AM - INFO - /?cmd=get_info&uid=pp
11/23/2012 10:58:29 AM - INFO - Write the header back to the client.
11/23/2012 10:58:29 AM - ERROR - Exception occurs when writing back the response.
Traceback (most recent call last):
   File "service.py", line 57, in do_GET
      self.send_response(200)
   File "/usr/lib/python2.7/BaseHTTPServer.py", line 385, in send_response
      self.log_request(code)
   File "/usr/lib/python2.7/BaseHTTPServer.py", line 422, in log_request
      self.requestline, str(code), str(size))
   File "/usr/lib/python2.7/BaseHTTPServer.py", line 458, in log_message
      format%args))
   IOError: [Errno 5] Input/output error 
```

**编辑：**

当我覆盖`log_message()`to什么都不做时，问题就消失了。我知道这只会隐藏问题，但至少它暂时对我有用。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2015-12-01T12:29:06.127

sys.stderr 将消息写入标准输出，通常是您启动程序的 shell 控制台。因此，如果 shell 控制台关闭，sys.stderr.writes 将引发 IO 错误。

所以问题的根本原因是 log_message() 函数中的 sys.stderr.write 尝试将消息写入您最初启动 python 程序的 ssh shell 控制台（标准输出），所以如果您保持 ssh 会话处于活动状态, 问题不会发生。但是如果你退出原来的 ssh 会话，shell 控制台就会关闭，那么 sys.stderr.write 就无法将消息写入原来的控制台，然后就会发生 IO 错误...... log_message 通常会这样写：

```
127.0.0.1 - - [01/Dec/2015 20:16:32] "GET / HTTP/1.1" 200 - 
```

所以解决方案是通过将标准输出重定向到 /dev/null 来运行你的 python 脚本，如下所示：

```
python your_script.py > /dev/null 2>&1 & 
```

帮帮忙。

# c# - Console.Writeline 中使用的字符串连接在该上下文之外可用

> ID：13497332
> 
> 赞同：0
> 
> 时间：2012-11-21T16:10:04.777
> 
> 标签：c#

还行吧：

```
Console.WriteLine("this is the key that has run: {0}", this.ReportKey.ToString()); 
```

这种将字符串组合在一起的方式是否仅在为控制台构建参数时可用，或者可以在其他上下文中使用。可以用在下面吗？我已经把我失败的尝试。

```
public string RunTheReport(){
    return "Name: " + this.ReportName " key: " + this.ReportKey.ToString();
    //return ("Name: {0} key: {1}", this.ReportName, this.ReportKey.ToString()); <<is there a way to avoid using all the "+" signs?
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-21T16:10:35.870

使用[`string.Format`](http://msdn.microsoft.com/en-us/library/system.string.format.aspx)：

```
public string RunTheReport(){
    return string.Format("Name: {0} key: {1}", ReportName, ReportKey);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T16:19:20.290

```
string.Format("Name: {0} Key: {1} ..", para1, para2,...); 
```

这适用于数组，也可以有混合索引

```
string[] sArray = new string[]{"xx","yy","zz"};
string.Format("Index1:{1} Index0:{0} Index2:{2}",sArray);
//Output = "Index0:yy Index1:xx Index2:zz" 
```

# c# - 更新方法的声音效果不断循环

> ID：13497333
> 
> 赞同：0
> 
> 时间：2012-11-21T16:10:06.740
> 
> 标签：c#, xna

我正在 Xna 中构建游戏，我的音效一直在循环播放，这很明显，因为声音是通过更新方法播放的。

声音并不是真的一次播放 1 次，但就像我的车撞到一块名为：tile 1 的瓷砖时，它会一次播放 1000 多次。

如何防止声音一次播放 1000 多次，而让它一次播放 1 次？

这是我用来播放音效的代码：

```
if (map[x][y] == 1)
        {
            car.speed = 0;
            crash.Play();
        } 
```

crash 是 soundEffect 的名称。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T13:53:45.550

我不得不向您推荐阅读有关 Xact 的好教程

您会认为这种方法比您尝试使用的方法更难，但它会在未来对您更加灵活 :)

[MSDN 上的 Xact](http://msdn.microsoft.com/en-us/library/bb203895%28v=xnagamestudio.20%29.aspx)

或者您可以使用声音中的 pause() 方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T16:27:26.127

如何实现这一目标的快速示例：

```
bool soundPlayed = false;   //This would be in a INIT method somewhere

if (map[x][y] == 1)
{
    if (!soundPlayed)
    {
        car.speed = 0;
        crash.Play();
        soundPlayed = true;
    }
}
else
{
    soundPlayed = false;    //Reset once condition is false
} 
```

# android - 在整个应用程序中接收蓝牙数据

> ID：13497337
> 
> 赞同：0
> 
> 时间：2012-11-21T16:10:14.727
> 
> 标签：android, bluetooth

我开发了一个带有 3-4 个活动的 Android 蓝牙应用程序。现在我必须在任何这些活动中接收蓝牙数据。我想我必须实现一个包含广播接收器的服务，它监听传入的蓝牙数据并发送广播，但我不知道该怎么做。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T19:31:36.960

您可以实现自己的广播接收器。因此，当您的 LocalService 收到数据时，它将使用 sendBroadcast 方法进行通知。您的活动应该注册特定的 BrodcastReceiver。

**在您的服务中**

通知收到的消息：

```
public void onMessageReceived(String message) {
    Intent intent = new Intent(ACTION_BLUETOOTH_MESSAGE);
    intent.putExtra(BLUETOOTH_MESSAGE_CONTENT, message);
    sendBroadcast(intent);
} 
```

**在每个活动中**

注册广播接收器：

```
registerReceiver(messageReceiver,
            new IntentFilter(ACTION_BLUETOOTH_MESSAGE)); 
```

广播接收器的实现：

```
private BroadcastReceiver messageReceiver = new BroadcastReceiver() {

    @Override
    public void onReceive(Context context, Intent intent) {
        String message = intent.getStringExtra(BLUETOOTH_MESSAGE_CONTENT);
    //Do something you want 
    }
}; 
```

# mysql - CRM 关系 MySQL

> ID：13497342
> 
> 赞同：0
> 
> 时间：2012-11-21T16:10:18.323
> 
> 标签：mysql, database-design, orm, entity-relationship, crm

*我们公司正在开发 CRM，我们现在必须决定如何处理这些关系。这是很重要的一点，因为会有很多。以后再改变结构根本不酷..*

*我知道我们可以通过 3 种方法来做到这一点：*

**一张关系表：**

我这样做的方法是创建一个包含所有关系的表。

```
Table: releationships

+----+-------------+-----------+--------------+------------+
| id | record_type | record_id | belongs_type | belongs_id |
+----+-------------+-----------+--------------+------------+
| 1  | person      | 42        | company      | 12         |
+----+-------------+-----------+--------------+------------+
| 2  | person      | 43        | company      | 12         |
+----+-------------+-----------+--------------+------------+
| 3  | note        | 23        | company      | 12         |
+----+-------------+-----------+--------------+------------+ 
| 4  | attachment  | 13        | company      | 12         |
+----+-------------+-----------+--------------+------------+ 
```

**多个关系表：**

我认为这就是例如 SugarCRM 的方式。

```
Table: company_realationships

+----+-----------+------------+--------+
| id | record_id | has_type   | has_id |
+----+-----------+------------+--------+
| 1  | 12        | person     | 42     |
+----+-----------+------------+--------+
| 2  | 12        | person     | 43     |
+----+-----------+------------+--------+
| 3  | 12        | note       | 23     |
+----+-----------+------------+--------+
| 2  | 12        | attachment | 13     |
+----+-----------+------------+--------+ 
```

**全部在记录表中：**

```
Table: person

+----+-----------+------------+
| id | name      | company_id |
+----+-----------+------------+
| 42 | luke      | 12         |
+----+-----------+------------+
| 43 | other guy | 12         |
+----+-----------+------------+ 
```

等等。

*   所以我的问题是处理大量关系的**最佳方式是什么？**
*   还有其他方法吗？
*   有什么缺点/优点？
*   高流量的双方如何处理他们的关系有什么特殊的方式吗？

谢谢你们的帮助：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T18:36:42.847

> 所以我的问题是处理大量关系的最佳方式是什么？

第三个或它的变体（见下文）。

每个“M:N”关系都应该由它自己的联结表来表示。OTOH，“1：N”关系不需要额外的表 - 只需“N”一侧的表中的正确外键即可。

如果我正确理解您的描述，则第三个选项模拟了公司与个人之间的 1:N 关系。如果您想对它们之间的 M:N 关系进行建模，那么您将有一个联结表：`company_person ( company_id, person_id, PK (company_id, person_id) )`。

> 还有其他方法吗？

有时，可以使用继承（又名类别、子类型、泛化层次结构等）来减少可能的“相关”组合的数量。简而言之，与父母建立关系，然后从该父母继承的每个孩子都会自动参与该关系。

例如，看看[这篇文章](https://stackoverflow.com/a/11618048/533120)。

> 有什么缺点/优点？

以声明方式强制执行约束（包括 FK）比通过触发器强制执行更好（更不容易出错并且可能更高效），这又比在客户端代码中强制执行更好。

选择更符合该原则的设计。例如，您的选项 1 和 2 不允许 DBMS 以声明方式强制执行 FK。

> 高流量的双方如何处理他们的关系有什么特殊的方式吗？

良好的逻辑设计和良好的物理实现是良好性能的唯一坚实基础。很难在糟糕的设计之上“巩固”性能。

也许，您想看看：

*   [ERwin 方法指南](http://tangra.si.umich.edu/~radev/654/resources/ERMGALL.PDF)
*   [使用索引，卢克！](http://use-the-index-luke.com/)

在性能方面，不要猜测！**衡量**真实的数据量。

# html - YouTube HTML5 iframe API - 如何关闭 iPad 上的自动隐藏控件？

> ID：13497343
> 
> 赞同：0
> 
> 时间：2012-11-21T16:10:19.763
> 
> 标签：html, ipad, youtube-api, html5-video, youtube-javascript-api

我正在使用 HTML5 iframe api 嵌入 YouTube 视频，一切似乎都很好，除了我无法始终关闭控件自动隐藏功能。在 ipad 上，播放器不闪烁，控件自动隐藏。在 Flash 播放器（FF、Chrome）上，控件始终显示。

这是一个 JS 小提琴：[www.jsfiddle.net/wrxpm](http://www.jsfiddle.net/wrxpm)

我的代码是：

```
var ytPlayer = new YT.Player(playerID, {
    width: width,
    height: height,
    videoId: idVideo,
    playerVars: {
        'autoplay': 0,
        'controls': 2,
        'autohide': 0,
        'showinfo': 0,
        'modestbranding': 1,
        'hd': 1,
        'wmode': 'opaque'
    }
}); 
```

# windows - Qt4 支持的最低 Windows 版本是多少？

> ID：13497344
> 
> 赞同：3
> 
> 时间：2012-11-21T16:10:23.780
> 
> 标签：windows, qt, backwards-compatibility

如果我使用现代版本的 Qt4 构建一个 hello world 应用程序，我的程序可以运行的最低 Windows 版本是多少？

它是否可以在 Windows 2000 上运行，甚至可以在旧版本（如 NT 或 Win95）上运行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T16:22:34.677

很难说，因为 QT 是一个开源项目，并且您还需要将编译器视为可能的变体，但即使是 Windows 98 也有解决方案[为 Windows 98 和 Windows 2000/NT 编译 Qt](https://stackoverflow.com/questions/2999095/compiling-qt-for-windows-98)仍然支持真正[的最新版本，如 4.7](http://qt-project.org/doc/qt-4.7/platform-notes-windows.html) 5.0 也支持它们。

我想真正的问题是 Windows 95，但你真的需要 Win95 吗？

如今，有免费的操作系统可用于生产和用户验证。

有时您会在[本页底部](http://qt-project.org/wiki/Show_library_dependencies)的 QT wiki 中找到对 Windows 95 的引用，但至少对于 4.x 分支尚不清楚它是否受支持，4.x 分支能够支持到 Windows ME ，至少根据 QT/Trolltech 的平台说明。

可能使用类似 4.3/4.4 的版本，您可以获得 Windows 95 下的 QT 环境。

* * *

***编辑***

回答您的编辑我会说支持 Windows 2000/NT 这不是问题，支持较旧的操作系统将需要您的 QT 版本降级，而 Windows 95 这是一个彩票。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T16:24:09.563

查看[支持的平台](http://doc.qt.digia.com/qt/supported-platforms.html#tier-1-platforms)说明。如果操作系统不在第 1 层或第 2 层，那么您应该尝试看看。

# c# - 如何并行处理项目然后合并结果？

> ID：13497345
> 
> 赞同：5
> 
> 时间：2012-11-21T16:10:28.320
> 
> 标签：c#, concurrency, merge, task-parallel-library, tpl-dataflow

我面临以下问题：

我有一个对象数据流，`Foo`并将这些对象流式传输到几个并发的进程内任务/线程，这些任务/线程依次处理对象和输出`FooResult`对象。每个都`FooResult`包含在其他成员`Foo`中与创建`FooResult`. 但是，并非每个人都`Foo`必须创建一个`FooResult`.

我的问题是我想从整个过程中传递一个包装对象，该对象包含原始对象和可能从并发任务中创建的`Foo`所有对象（如果有的话） 。`FooResult``Foo`

注意：我目前使用 TPL 数据流，而每个并发进程都发生在`ActionBlock<Foo>`从`BroadCastBlock<Foo>`. 它用于`SendAsync()`向目标数据流块发送可能创建`FooResult`的 . 显然，并发数据流块`FooResult`在不可预测的时间产生，这是我目前正在努力解决的问题。我似乎无法弄清楚`FooResult`总共创建了多少个`ActionBlock<Foo>`，以便我可以将它们与原始对象捆绑在一起`Foo`并将其作为包装对象传递。

在伪代码中，它目前看起来如下：

```
BroadCastBlock<Foo> broadCastBlock;
ActionBlock<Foo> aBlock1;
ActionBlock<Foo> aBlock2; 
ActionBlock<FooResult> targetBlock;
broadCastBlock.LinkTo(aBlock1); broadCastBlock.LinkTo(aBlock2);

aBlock1 = new ActionBlock<Foo>(foo =>
{
    //do something here. Sometimes create a FooResult. If then
    targetBlock.SendAsync(fooResult);
});

//similar for aBlock2 
```

`Foo`但是，当前代码的问题在于，如果 a没有`FooResult`在任何操作块中生成单个，则 targetBlock 可能不会收到任何内容。此外，可能 targetBlock 接收 2 个`FooResult`对象，因为每个动作块产生一个`FooResult`.

我想要的是 targetBlock 接收一个包含每个对象的包装对象，`Foo`如果`FooResult`创建了对象，那么也是一个`FooResult`.

有什么想法可以使解决方案按照描述的方式工作吗？它不必仔细阅读 TPL 数据流，但如果这样做会很整洁。

**更新：以下是我通过 svick 建议的 JoinBlock 实现得到的。我不会使用它（除非它可以在性能方面进行调整），因为它运行起来非常慢，我每秒可以处理大约 89000 个项目（而且那只是 int 值类型）。**

```
public class Test
{
    private BroadcastBlock<int> broadCastBlock;
    private TransformBlock<int, int> transformBlock1;
    private TransformBlock<int, int> transformBlock2;
    private JoinBlock<int, int, int> joinBlock;
    private ActionBlock<Tuple<int, int, int>> processorBlock;

    public Test()
    {
        broadCastBlock = new BroadcastBlock<int>(i =>
            {
                return i;
            });

        transformBlock1 = new TransformBlock<int, int>(i =>
            {
                return i;
            }, new ExecutionDataflowBlockOptions { MaxDegreeOfParallelism = DataflowBlockOptions.Unbounded });

        transformBlock2 = new TransformBlock<int, int>(i =>
            {
                return i;
            }, new ExecutionDataflowBlockOptions { MaxDegreeOfParallelism = DataflowBlockOptions.Unbounded });

        joinBlock = new JoinBlock<int, int, int>();

        processorBlock = new ActionBlock<Tuple<int, int, int>>(tuple =>
            {
                //Console.WriteLine("original value: " + tuple.Item1 + "tfb1: " + tuple.Item2 + "tfb2: " + tuple.Item3);
            }, new ExecutionDataflowBlockOptions { MaxDegreeOfParallelism = DataflowBlockOptions.Unbounded });

        //Linking
        broadCastBlock.LinkTo(transformBlock1, new DataflowLinkOptions { PropagateCompletion = true });
        broadCastBlock.LinkTo(transformBlock2, new DataflowLinkOptions { PropagateCompletion = true });

        broadCastBlock.LinkTo(joinBlock.Target1, new DataflowLinkOptions { PropagateCompletion = true });
        transformBlock1.LinkTo(joinBlock.Target2, new DataflowLinkOptions { PropagateCompletion = true });
        transformBlock2.LinkTo(joinBlock.Target3, new DataflowLinkOptions { PropagateCompletion = true });

        joinBlock.LinkTo(processorBlock, new DataflowLinkOptions { PropagateCompletion = true });
    }

    public void Start()
    {
        Stopwatch watch = new Stopwatch();
        watch.Start();

        const int numElements = 1000000;

        for (int i = 1; i <= numElements; i++)
        {
            broadCastBlock.Post(i);
        }

        ////mark completion
        broadCastBlock.Complete();

        processorBlock.Completion.Wait();

        watch.Stop();

        Console.WriteLine("Time it took: " + watch.ElapsedMilliseconds + " - items processed per second: " + numElements / watch.ElapsedMilliseconds * 1000);
        Console.ReadLine();
    }
} 
```

**更新代码以反映建议：**

```
public Test()
    {
        broadCastBlock = new BroadcastBlock<int>(i =>
            {
                return i;
            });

        transformBlock1 = new TransformBlock<int, int>(i =>
            {
                return i;
            });

        transformBlock2 = new TransformBlock<int, int>(i =>
            {
                return i;
            });

        joinBlock = new JoinBlock<int, int>();

        processorBlock = new ActionBlock<Tuple<int, int>>(tuple =>
            {
                //Console.WriteLine("tfb1: " + tuple.Item1 + "tfb2: " + tuple.Item2);
            });

        //Linking
        broadCastBlock.LinkTo(transformBlock1, new DataflowLinkOptions { PropagateCompletion = true });
        broadCastBlock.LinkTo(transformBlock2, new DataflowLinkOptions { PropagateCompletion = true });
        transformBlock1.LinkTo(joinBlock.Target1);
        transformBlock2.LinkTo(joinBlock.Target2);
        joinBlock.LinkTo(processorBlock, new DataflowLinkOptions { PropagateCompletion = true });
    }

    public void Start()
    {
        Stopwatch watch = new Stopwatch();
        watch.Start();

        const int numElements = 1000000;

        for (int i = 1; i <= numElements; i++)
        {
            broadCastBlock.Post(i);
        }

        ////mark completion
        broadCastBlock.Complete();
        Task.WhenAll(transformBlock1.Completion, transformBlock2.Completion).ContinueWith(_ => joinBlock.Complete());

        processorBlock.Completion.Wait();

        watch.Stop();

        Console.WriteLine("Time it took: " + watch.ElapsedMilliseconds + " - items processed per second: " + numElements / watch.ElapsedMilliseconds * 1000);
        Console.ReadLine();
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T22:47:16.503

我可以看到两种方法来解决这个问题：

1.  使用[`JoinBlock`](http://msdn.microsoft.com/en-us/library/hh160286.aspx). 您的广播块和两个工作块将分别发送到连接块的一个目标。如果一个工作块没有任何结果，它将`null`代替它（或其他一些特殊值）。您的工作块将需要更改为`TranformBlock<Foo, FooResult>`，因为使用`ActionBlock`您所做的方式并不能保证顺序（至少在您设置时不是`MaxDegreeOfParallelism`），`TransformBlock`确实如此。

    的结果`JoinBlock`将是 a `Tuple<Foo, FooResult, FooResult>`，其中任何一个或两个`FooResult`s 都可以是`null`。

    虽然我不确定我是否喜欢这个解决方案在很大程度上依赖于正确的项目排序，但这对我来说似乎很脆弱。

2.  使用其他对象进行同步。当所有块都完成某个项目时，该对象将负责向前发送结果。这类似于`NotificationWrapper`马里奥在他的回答中提出的建议。

    在这种情况下，您可以使用`TaskCompletionSource`and`Task.WhenAll()`来处理同步。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T16:15:24.753

据我了解这个问题：

```
lock foo
work on foo
if foo has not triggered sending a result
and fooResult exists
   send fooResult
   remember in foo that result has already been sent
unlock foo 
```

***OP评论后更新***

所以将 foo 推入您的广播块

```
BroadCastBlock<Foo> bcb = new BroadCastBlock<Foo>(foo);
...

if ( aBlock1.HasResult ) 
{
    bcb.Add( aBlock1.Result );
}

if ( aBlock2.HasResult ) 
{
    bcb.Add( aBlock2.Result );
} 
```

现在您可以查询 bcb 的内容并发送需要的内容（或仅发送 bcb）。

***更新（在评论中进行更多讨论之后）***

```
class NotificationWrapper<TSource, TResult>
{
   private readonly TSource originalSource;

   private Queue<TResult> resultsGenerated = new Queue<TResult>()

   private int workerCount = 0;

   public NotificationWrapper<TSource, TResult>( TSource originalSource, int workerCount )
   {
       this.originalSource = originalSource;
       this.workerCount = workerCount;
   }

   public void NotifyActionDone()
   {
       lock( this )
       {
          --workerCount;
          if ( 0 == workerCount )
          {
             //do my sending
             send( originalSource, resultsGenerated );
          }
       }
   }

    public void NotifyActionDone( TResult result )
    {
        lock ( this )
        {
            resultsGenerated.push( result );
            NotifyActionDone();
        }
    }
} 
```

在调用代码中：

```
NotificationWrapper<Foo, Fooresult> notificationWrapper = new NotificationWrapper<Foo, Fooresult>( foo, 2 );
ActionBlock<Foo> ab1 = new ActionBlock<Foo>( foo, notificationWrapper );
ActionBlock<Foo> ab2 = new ActionBlock<Foo>( foo, notificationWrapper ); 
```

并且 ActionBlock 需要更改为调用`NotifyActionDone()`或`NotifyActoinDone( Fooresult )`完成计算后。

# php - 如何单击 HTML 表格行并将行的数据发送到 PHP（作为 POST）？

> ID：13497346
> 
> 赞同：-1
> 
> 时间：2012-11-21T16:10:27.310
> 
> 标签：php, html-table, row

我需要制作一个带有可点击行的表格（为此我找到了一些 Javascript 解决方案）。当我单击一行时，将使用单击行中的数据填充表单。

但是当我单击该行时，我不知道如何将数据从 HTML 表发送到 PHP。正如我在标题中提到的，数据必须作为 POST 发送。

我不知道如何开始，所以我什么也不能告诉你。不允许在一个表中使用多个表单，也不允许`<a>`标记周围`<td>`，所以我被卡住了。根据我在网上搜索的内容，解决方案是 AJAX，但我不熟悉它，从未使用过 AJAX，所以如果可能的话，非 AJAX 解决方案将不胜感激。如果没有，请给我看一个功能示例。

**编辑** *解决了*

**最后，感谢emartel**和**Guerra**的想法，我在没有任何 AJAX 的情况下完成了它。在我从单击的行中收集了所需的数据后，我制作了一个带有隐藏输入字段的表单，并以编程方式提交了它。

我回应了这样的 tr 标签：`<tr data-id=$id_from_db onclick="submit_id(this)">`.

```
    函数 submit_id(tableRow) {
        //获取标识
        var myID = tableRow.dataset.id;

        //设置名称
        var setID = document.getElementById('order_id');
            setID.value = 我的ID；

        //提交
        var form = document.getElementById('myform');
        form.submit();
    };

```

PS 我试图嵌入一些 PHP 代码，但失败了，它没有显示在页面上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T16:13:51.527

从 JavaScript填写表单 (`name="myform"`和`method="post"`) 后，只需调用：

```
document.myform.submit(); 
```

这应该做的工作

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T16:24:42.240

您可以使用 ID 将某种输入隐藏在每一行上。因此，您可以只使用 1 个传递 ID 的表单来提交帖子并恢复服务器上的整个注册。

# c# - 为什么在三元运算符中选择零作为 Int32？

> ID：13497350
> 
> 赞同：1
> 
> 时间：2012-11-21T16:09:40.053
> 
> 标签：c#, type-conversion, ternary-operator

> **可能重复：**
> [三元语句中没有隐式 int -> 短转换](https://stackoverflow.com/questions/1672774/no-implicit-int-short-conversion-in-ternary-statement)

因此，我了解了 C# 三元运算符中类型转换和类型推断的基础知识，这主要归功于 Eric Lippert[对这个问题](https://stackoverflow.com/questions/2215745/conditional-operator-cannot-cast-implicitly/2215959#2215959)的回答。但我仍然不明白的是我下面的内容。

我想我知道 C# 假设​​零是 an`int`因为这是默认值，所以当我尝试将 an 分配`int`给`short`变量时会引发错误：

```
short recordNumber = Convert.IsDBNull(dr["record_number"]) ? 0 
    : Convert.ToInt16(dr["record_number"]); 
```

抛出此错误：

```
Cannot implicitly convert type 'int' to 'short'. 
An explicit conversion exists (are you missing a cast?) 
```

这就是 VS10 正在寻找的：

```
short recordNumber = Convert.IsDBNull(dr["record_number"]) ? (short)0 
    : Convert.ToInt16(dr["record_number"]); 
```

我想了解的是**为什么选择 0`int`而不是`short`？** 如果它被选为 a`short`那么这将使它更普遍地“可分配”。我失踪了有什么原因吗？

# postgresql - 错误：在以只读用户身份尝试 SELECT 时，Postgres 上的关系表名的权限被拒绝

> ID：13497352
> 
> 赞同：93
> 
> 时间：2012-11-21T16:10:47.743
> 
> 标签：postgresql

```
GRANT SELECT ON ALL TABLES IN SCHEMA public TO readonly; 
```

只读用户可以连接，查看表格，但是当它尝试做一个简单的选择时，它会得到：

```
ERROR: permission denied for relation mytable
SQL state: 42501 
```

这发生在 PostgreSQL 9.1 上

我做错了什么？

* * *

## 回答 #1

> 赞同：169
> 
> 时间：2012-11-22T11:20:02.683

这是最近更新的 PostgreSQL 9+ 的完整解决方案。

```
CREATE USER readonly  WITH ENCRYPTED PASSWORD 'readonly';
GRANT USAGE ON SCHEMA public to readonly;
ALTER DEFAULT PRIVILEGES IN SCHEMA public GRANT SELECT ON TABLES TO readonly;

-- repeat code below for each database:

GRANT CONNECT ON DATABASE foo to readonly;
\c foo
ALTER DEFAULT PRIVILEGES IN SCHEMA public GRANT SELECT ON TABLES TO readonly; --- this grants privileges on new tables generated in new database "foo"
GRANT USAGE ON SCHEMA public to readonly; 
GRANT SELECT ON ALL SEQUENCES IN SCHEMA public TO readonly;
GRANT SELECT ON ALL TABLES IN SCHEMA public TO readonly; 
```

感谢[https://jamie.curle.io/creating-a-read-only-user-in-postgres/](https://jamie.curle.io/creating-a-read-only-user-in-postgres/)几个重要方面

如果有人找到更短的代码，最好是能够为所有现有数据库执行此操作的代码，额外的荣誉。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-11-21T18:36:00.163

尝试添加

```
GRANT USAGE ON SCHEMA public to readonly; 
```

您可能不知道需要对架构具有必要的权限才能使用架构中的对象。

* * *

## 回答 #3

> 赞同：-5
> 
> 时间：2015-06-24T23:33:31.647

这对我有用：

使用以下命令检查您登录的当前角色：SELECT CURRENT_USER, SESSION_USER;

**注意**：它必须与架构的所有者匹配。

架构 | 姓名 | 类型 | **所有者**
--------+--------+--------+----------

如果所有者不同，则通过以下方式将所有授权从管理员角色授予当前用户角色：

将“ROLE_OWNER”授予“当前角色名”；

然后尝试执行查询，它将给出输出，因为它现在可以访问所有关系。

* * *

## 回答 #4

> 赞同：-7
> 
> 时间：2015-07-16T06:28:24.487

确保您的用户具有其角色的属性。例如：

```
postgres=# \du
                             List of roles
 Role name |                   Attributes                   | Member of 
-----------+------------------------------------------------+-----------
 flux      |                                                | {}
 postgres  | Superuser, Create role, Create DB, Replication | {} 
```

执行以下命令后：

```
postgres=# ALTER ROLE flux WITH Superuser;
ALTER ROLE
postgres=# \du
                             List of roles
 Role name |                   Attributes                   | Member of 
-----------+------------------------------------------------+-----------
 flux      | Superuser                                      | {}
postgres  | Superuser, Create role, Create DB, Replication | {} 
```

它解决了这个问题。

请参阅此处的角色和内容教程：[https ://www.digitalocean.com/community/tutorials/how-to-use-roles-and-manage-grant-permissions-in-postgresql-on-a-vps--2](https://www.digitalocean.com/community/tutorials/how-to-use-roles-and-manage-grant-permissions-in-postgresql-on-a-vps--2)

* * *

## 回答 #5

> 赞同：-8
> 
> 时间：2015-10-27T17:11:09.300

您应该执行下一个查询：

```
GRANT ALL ON TABLE mytable TO myuser; 
```

或者，如果您的错误出现在视图中，则该表可能没有权限，因此您应该执行下一个查询：

```
GRANT ALL ON TABLE tbm_grupo TO myuser; 
```

# c# - 从 .Net 到 Javascript 的安全 JSON 请求

> ID：13497355
> 
> 赞同：0
> 
> 时间：2012-11-21T16:10:56.363
> 
> 标签：c#, javascript, encryption

我将 JSON 结果发送回我的 IIS/MVC4 网站上的 javascript (Jquery)。json 包含大约 60-100 个字母的字符串值。

目前它是以明文形式发送的，根本没有加密。

在javascript客户端和.net C#后端之间加密这条消息的最简单方法是什么？

加密必须非常出色，但足以让您无法在 1 小时内计算出/暴力破解内容。

请记住，每个人都有 javascript，所以我不能只为所有客户端使用一个公共密钥。

我在想一些类似于 RSA 加密的东西，其中客户端生成一个密钥对并将其公钥与请求一起发回，服务器使用它来加密值。虽然我找不到任何这样的例子，所以我非常接受建议。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T16:11:13.220

通过 SSL (HTTPS) 运行整个网页。服务器和浏览器将为您处理加密。

# matlab - 每个班级都需要一个有效的观察结果

> ID：13497364
> 
> 赞同：1
> 
> 时间：2012-11-21T16:11:30.513
> 
> 标签：matlab

我收到此错误：

```
Warning: TRAINING can only contain
non-negative integers when
'Distribution' is set to 'mn'. Rows of
TRAINING with invalid values will be
removed. 
> In NaiveBayes.fit at 317
??? Error using ==>

??? Error using ==>
NaiveBayes.fit>mnfit at 647
At least one valid observation in each
class is required.

Error in ==> NaiveBayes.fit at 496
            obj =  mnfit(obj,training,
            gindex); 
```

这就是我所拥有的：

```
training_data = Testdata; 
target_class = TestDataLabels;

%# train model
nb = NaiveBayes.fit(training_data, target_class, 'Distribution', 'mn');

%# prediction
class1 = nb.predict(UnseenTestdata); 

%# performance
cmat1 = confusionmat(UnseenTestDataLabels, class1);
acc1 = 100*sum(diag(cmat1))./sum(cmat1(:));
fprintf('Classifier1:\naccuracy = %.2f%%\n', acc1);
fprintf('Confusion Matrix:\n'), disp(cmat1) 
```

如果有人想知道，数据集是 4940201x42。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T16:16:08.177

你有两个问题。

首先，对于多项分布，MATLAB 希望您的数据具有非负整数值。其次，似乎至少对于您的某些课程，您没有任何有效的观察结果。这可能是因为 NAN、INF 或只是 Testdata 行中的非正值。

实际上，正如错误所说 - “无效行将被删除”......所以我打赌无效行被删除......

# php - mysqlhotcopy 不工作。为什么？

> ID：13497365
> 
> 赞同：-5
> 
> 时间：2012-11-21T16:11:32.787
> 
> 标签：php, mysql, phpmyadmin

我正在尝试使用 mysqlhotcopy 备份数据库。所有文件都是本地的。我将 xampp 与 php5.4 和 mysql5.5 一起使用。

当我在 SQL 命令行中输入以下行时，出现错误：

```
sql: mysqlhotcopy -u root -p password database /tmp/ 
error: 1064 - You have an error in your SQL syntax 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T16:12:49.870

您需要从命令行运行它，而不是在 phpAdmin 中。

# javascript - 动态添加喜欢按钮到页面

> ID：13497370
> 
> 赞同：2
> 
> 时间：2012-11-21T16:10:45.123
> 
> 标签：javascript, facebook, facebook-like, facebook-javascript-sdk

我正在构建一个页面，该页面聚合了 Wordpress 站点中的其他页面，并显示有关它们的信息片段以及“喜欢”按钮。现在我正在使用 iFrame 选项。

发生的情况是，当用户单击视频时，它会在功能区域中显示该视频、一些文本和一个“赞”按钮。此 HTML 是从模板生成的，并在用户单击视频以观看视频后创建。没有页面刷新。

如果我使用 HTML5 版本的 Like 按钮，它永远不会被渲染，我猜这是因为当 Facebook init 被调用时 Like div 永远不存在。不过我不想使用 iFrame 版本，因为它似乎不允许我让人们评论他们的喜欢。

有没有办法让 Facebook 重新扫描要渲染的元素？我知道 Twitter 将允许您通过`twttr.widgets.load()`随时运行以重新扫描以呈现要呈现的内容来执行此操作。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-21T16:14:34.073

只需在加载动态站点后调用此函数，我很确定这是您需要的：

> [https://developers.facebook.com/docs/reference/javascript/FB.XFBML.parse/](https://developers.facebook.com/docs/reference/javascript/FB.XFBML.parse/)

# bash - 多文件参数搜索bash

> ID：13497375
> 
> 赞同：1
> 
> 时间：2012-11-21T16:11:02.220
> 
> 标签：bash, sed

我有大约 600 个文件，这些文件的名称类似于它们拥有信息并带有`.dgt`扩展名的机器的 IP 地址。如果给定参数正确，我正在尝试在这些文件中搜索参数并从这些文件中提取 2 行。我正在使用 aix 控制台，经过一番搜索，我`sed`在这里找到了命令。我给你一个我搜索的例子。

```
sed -n -e '/XP/,$p' 181* > machines1

sed -e '/XP/,$d' 181* > machines1 
```

更具体地说，在目录中，我有一个我所有企业机器的文件列表，它是这样的：

```
181xxxxxxxxx.dgt
181xxxxxxxxx.dgt
181xxxxxxxxx.dgt
181xxxxxxxxx.dgt 
```

它们包含如下信息：

```
MachineName= M125EEE
...
...
...
CurrentIP=XXX.XXX.XXX.XXX
...
...
OS=XP
...
...
... 
```

我正在尝试获取所有已安装 XP 的机器的列表，因此我正在尝试提取 OS 行和 MachineName 行，以便获得这样的文件...

```
MachineName= M125EEE
OS=XP
MachineName= M125EEE
OS=XP
MachineName= M125EEF
OS=XP
MachineName= M125EEG
OS=XP 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T16:41:46.293

尝试这个：

```
awk '
BEGIN{ FS=OFS="=" }
{ map[FILENAME,$1] = $2 }
END {
   for (file in ARGV) {
      if ( map[file,"OS"] == "XP" ) {
         tag="MachineName"; print tag, map[file,tag]
         tag="OS";          print tag, map[file,tag]
         tag="CurrentIP";   print tag, map[file,tag]
      }
   }
}
' 181* 
```

进行简单、明显的调整以输出您喜欢的任何值...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T16:19:24.233

**编辑：**

这将满足要求，但比第一个版本更简单（更短）：

```
sed -ne '/^MachineName=/h;/^OS=XP/{x;G;p}' 181*dgt >machines 
```

给出与以下第一个答案相同的答案：

**拳头回答**

这将完成这项工作：

```
sed -ne '/^MachineName=/{h};/^OS=/{/=XP/!d;x;G;p;d;h}' 181*.dgt >machines
cat machines
MachineName= M125EEE
OS=XP
MachineName= M125EEE
OS=XP
MachineName= M125EEF
OS=XP
MachineName= M125EEG
OS=XP 
```

但如果您不需要`OS=XP`每次都打印，因为这是唯一匹配的字符串，您可以将它们排除在外：

```
sed -ne '/^MachineName=/{h};/^OS=XP$/{g;p}' 181*.dgt >machines
cat machines
MachineName= M125EEE
MachineName= M125EEE
MachineName= M125EEF
MachineName= M125EEG 
```

如果您只想要机器名称而不想要`MachineName=`，您可以：

```
sed -ne '/^MachineName=/{s/^.*= *//;h};/^OS=XP$/{g;p}' 181*.dgt >machines
cat machines
M125EEE
M125EEE
M125EEF
M125EEG 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T17:03:00.707

它不像其他一些解决方案那样运行时效率高，但是对于如此少量的文件，这个简单易懂的解决方案可能是合适的：

`grep -h MachineName $(grep -l OS=XP 181*)`

grep -l 表示只打印匹配的文件名。然后我们使用这些文件名作为文件列表来搜索 MachineName 行（-h 表示禁止文件名）。

# javascript - jQuery.each(values, function(i,v){ ... }) 为什么 v 是未定义的？

> ID：13497379
> 
> 赞同：1
> 
> 时间：2012-11-21T16:12:26.760
> 
> 标签：javascript, jquery, asp.net

我有几个文本框，在将它们发回之前我需要检查它们。我使用 jQuery 使用每个函数来执行此操作。当按下提交按钮（LinkBut​​ton1）时，我遍历文本框并检查它们的值：

```
<asp:textbox id="txt1" class="tocheck" runat="server />
<asp:textbox id="txt2" class="tocheck" runat="server />
<asp:textbox id="txt3" class="tocheck" runat="server />

$('#LinkButton1').click(function () {
    var error = false;
    $.each('.tocheck', function (i, v) {
        checkVal(v.val());
    });
}); 
```

但是会抛出运行时错误，说 v 未定义：

![在此处输入图像描述](../Images/b5bf3dbf4a29b4991059950e5be2784c.png)

如何检索文本框值？

谢谢你。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-21T16:13:46.027

你不需要传入`v`- 删除它。

并`$(this)`改为使用。

IE

```
$('#LinkButton1').click(function () {
    var error = false;
    $('.tocheck').each( function () {
        checkVal($(this).val());
    });
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-21T16:18:36.807

问题是您没有正确传递集合。

```
$('#LinkButton1').click(function () {
    var error = false;
    $.each('.text', function (i, v) { // <-- you are passing in a STRING not a collection of elements
        checkVal(v.val());
    });
}); 
```

尝试

```
$('#LinkButton1').click(function () {
    var error = false;
    $.each($('.text'), function (i, v) {
        checkVal($(v).val());// <-- need to wrap in jQuery to use jQuery methods
    });
}); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-21T16:18:14.513

您在类选择器中遇到错误。将其更改为

```
$(".tocheck").each(function(i, v){
    checkVal($(v).val());
}) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-21T16:22:21.930

首先

```
$.each('.tocheck', function (i, v) {
        checkVal(v.val());
    }); 
```

应该是

```
$('.tocheck').each(function (i, v) {
        checkVal(v.value);
}); 
```

' **或** /

```
 $.each( $('.tocheck'), function (i, v) {
            checkVal(v.value);
        }); 
```

其次 ，这里的**v**是**DOM 对象**，您正在尝试在其上使用**jQuery 方法**..这就是错误的原因..

所以`v.val()`

应该是

`v.value` **或** `$(v).val();` **或** `this.value` **或** `$(this).val();`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-21T16:17:27.103

该`$.each`函数主要用于值数组，例如整数或字符串，这就是为什么 v 是值而不是项的原因。所以你应该使用下面的每个 jQuery 数组。

```
$(".tocheck").each(function (index, item)
{
   alert($(item).val());
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-21T16:13:38.303

```
$('.tocheck').each( function () {
        checkVal($(this).val());
    }); 
```

# c++ - 强制 MS VS2010 在每次构建时重建一个 cpp 文件

> ID：13497382
> 
> 赞同：11
> 
> 时间：2012-11-21T16:11:44.900
> 
> 标签：c++, visual-studio-2010

在一个 cpp 文件中，我使用`__DATE__`宏来获取编译日期。

它给了我最后一次编译**该文件**的日期。但由于文件不经常更改，大多数情况下日期是旧的，有时是几个月。

我真正想要的是**项目**最后一次构建的日期。

是否有设置强制 VS2010 在项目的每次编译时重建单个 cpp 文件？不管文件的变化？

到目前为止，我发现的唯一方法是在构建之前通过脚本修改文件或删除创建的 obj 文件，如果可能的话，我更喜欢 VS 中的解决方案。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-21T16:20:39.500

您可能会添加一个`Pre-Build Step`（`touch`请参阅此[线程](https://stackoverflow.com/questions/51435/windows-version-of-the-unix-touch-command)）文件？

要添加一个`Pre-Build Step`，打开你的`Project Properties`，`Configuration Properties > Build Events > Pre-Build Event`然后添加你想要在其中执行的命令行`Command Line`。

按照 Amitd 的建议，显然您也可以`touch`使用 PowerShell 来创建文件，请参阅[此](http://ss64.com/ps/syntax-touch.html)文件以获取解释。

正如 Adrian McCarthy 在下面的评论中所建议的那样，`.obj`在使用源代码控制并且您希望保留`.cpp` `read-only`. 使用 Visual Studio 公开的“宏”，可以轻松删除它们：

```
del $(TargetDir)sourcefile.obj 
```

引自 Cheers and hth。- Alf 作为实现这一目标的另一种方式

```
nmake (bundled with Visual Studio and the SDK) option /t does a touch, it was once the conventional way to do this for Windows programmers. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-03-13T14:33:08.200

您可以添加以下预构建步骤，您只需触摸文件的日期戳。这`+,,`是`copy`命令的一个特殊标志，告诉它更新文件的时间戳：

```
copy file.cpp +,, 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-11-05T10:42:14.543

正如Adrian McCarthy 所[建议](https://stackoverflow.com/questions/13497382/force-ms-vs2010-to-rebuild-one-cpp-file-on-every-build/53152782#comment18472888_13497519)的，您可以在每次构建项目时简单地删除目标文件。

`del`因此，创建一个调用该命令的预构建事件。根据[微软](https://msdn.microsoft.com/library/c02as0cs.aspx)的说法，您可以使用`$(IntDir)`宏来引用存储目标文件的目录（您不应该使用`$(TargetDir)`宏）。

我对命令的返回码（错误`MSB3073`）有疑问，因此我将命令更改为始终以`0`.

```
del $(IntDir)datefile.obj & exit 0 
```

在项目配置中的*Configuration Properties / Build Events*下创建此构建事件。

# signalr - Signalr (1.0.0-alpha2) Hubs - 你可以在连接开始后添加客户端功能吗？

> ID：13497390
> 
> 赞同：8
> 
> 时间：2012-11-21T16:12:06.460
> 
> 标签：signalr, signalr-hub

使用 Signalr (1.0.0-alpha2)，我想知道是否可以在连接启动后添加客户端功能。

假设我创建了连接并获取了代理。然后我将一些 Server Fired 客户端功能添加到集线器来做一些事情。然后我开始我的连接。然后我想向我的集线器对象添加更多的 Server Fired 函数。这可能吗？

```
var myHub= $.connection.myHub;
myHub.SomeClientFunction = function() {
   alert("serverside called 'Clients.SomeClientFunction()'");
};
$.connection.hub.start()
   .done(function() {
      myHub.SomeNewClientFunction = function() {
        alert("serverside called 'Clients.SomeNewClientFunction()'");
      }
    }) 
```

这个例子不现实，但我基本上想在集线器开始订阅原始代码不关心的新事件后将我的“myHub”变量发送到不同的对象。

现实生活示例：具有许多不同中心事件（新站点访问、聊天消息、站点错误）的仪表板。我在连接开始后“订阅”，然后将我的集线器代理传递给我所有不同的 UI 组件以处理它们特定的“消息类型”。我应该为这些创建单独的集线器，还是应该能够即时添加更多的 Server Fired 客户端功能？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-21T17:42:23.000

是的你可以。使用 .on 方法。

例子：

```
myHub.on('somethingNew', function() {
    alert("This was called after the connection started!");
}); 
```

如果您想稍后将其删除，请使用 .off 方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-28T07:44:13.383

我有完全相同的情况。如果您尝试从多个位置调用它，您可能需要考虑添加另一种抽象布局。

这是我想出的初步版本（打字稿）。

我将从用法开始。`SignalRManager`是我的“经理”类，它抽象了我的`debuggingHub`集线器。我有一个`fooChanged`在服务器上触发的客户端方法。

在使用 SignalR 的模块中的某个地方，我只是调用了该`start`方法，如果已经启动，则不会重新启动该方法。

```
// ensure signalR is started
SignalRManager.start().done(() =>
{
    $.connection.debuggingHub.server.init();
}); 
```

您的“模块”只需通过管理器类注册其回调，并且每当触发 SignalR 客户端方法时，都会调用您的处理程序。

```
// handler for foo changed
SignalRManager.onFooChanged((guid: string) =>
{
    if (this.currentSession().guid == guid)
    {
        alert('changed');
    }
}); 
```

这是一个简单的版本，`SignalRManager`它使用 jQuery`$.Callbacks`将请求传递给尽可能多的模块。当然你可以使用任何你想要的机制，但这似乎是最简单的。

```
module RR 
{ 
    export class SignalRManager
    {
        // the original promise returned when calling hub.Start
        static _start: JQueryPromise<any>;

        private static _fooChangedCallback = $.Callbacks();

        // add callback for 'fooChanged' callback
        static onfooChanged(callback: (guid: string) => any)
        {
            SignalRManager._fooChangedCallback.add(callback);
        }

        static start(): JQueryPromise<any>
        {
            if (!SignalRManager._start)
            {
                // callback for fooChanged
                $.connection.debuggingHub.client.fooChanged = (guid: string) =>
                {
                    console.log('foo Changed ' + guid);
                    SignalRManager._fooChangedCallback.fire.apply(arguments);                    
                };

                // start hub and save the promise returned
                SignalRManager._start = $.connection.hub.start().done(() =>
                {
                    console.log('Signal R initialized');
                });
            }

            return SignalRManager._start;
        }
    }
} 
```

注意：处理断开连接或连接丢失可能需要额外的工作。

# c# - 从 xml 中选择作为 linq 中的记录

> ID：13497392
> 
> 赞同：3
> 
> 时间：2012-11-21T16:12:17.630
> 
> 标签：c#, xml, linq

我已经在网上搜索了关于此的 linq 解决方案，但我找不到任何非常相似的解决方案。

谁能告诉我如何从下面的xml中选择comformation元素？我想在 c# 中使用 linq 将每个组件（id、accountnumber、type）添加到对象中。

实际上，我想一次获取一堆/记录中的数据，然后将其添加到列表中。我究竟做错了什么？

**XML**

```
string batch = @"
<batchresult>
      <outputs>
    <output>
      <value>
        <conformation>
          <component>
            <name>cmdinfo</name>
            <value>
              <bundle>
                <data>
                  <value>
                    <state>100</state>
                  </value>
                </data>
              </bundle>
            </value>
          </component>
          <component>
            <name>resultlist</name>
            <value>
              <bundle>
                <data>
                  <value>
                    <conformation>
                      <component>
                        <name>id</name>
                        <value>
                          <state>1</state>
                        </value>
                      </component>
                      <component>
                        <name>accountnumber</name>
                        <value>
                          <string>10505749</string>
                        </value>
                      </component>
                      <component>
                        <name>type</name>
                        <value>
                          <string>subnumber</string>
                        </value>
                      </component>
                    </conformation>
                  </value>
                  <value>
                    <conformation>
                      <component>
                        <name>id</name>
                        <value>
                          <state>2</state>
                        </value>
                      </component>
                      <component>
                        <name>accountnumber</name>
                        <value>
                          <string>53871265</string>
                        </value>
                      </component>
                      <component>
                        <name>type</name>
                        <value>
                          <string>subnumber</string>
                        </value>
                      </component>
                    </conformation>
                  </value>
                </data>
              </bundle>
            </value>
          </component>
          <component>
            <name>batchnumber</name>
            <value>
              <bundle>
                <data>
                  <value>
                    <state>14512367</state>
                  </value>
                </data>
              </bundle>
            </value>
          </component>
        </conformation>
      </value>
    </output>
  </outputs>
    </batchresult>"; 
```

**代码**

```
 class record
        {
            string F1 = "";
            public string f1
            {
                set { F1 = value; }
                get { return F1; }
            }

            string F2 = "";
            public string f2
            {
                set { F2 = value; }
                get { return F2; }
            }

            string F3 = "";
            public string f3
            {
                set { F3 = value; }
                get { return F3; }
            }
        }

    private void button1_Click(object sender, EventArgs e)
    {
            XDocument xmldoc = XDocument.Parse(batch);
            var obj = from o in xmldoc.Descendants("component")
                       where o.Parent.Name == "conformation"
    //select new record { f1 = o.Element("name").Value, f2 = o.Element("value").Value, f3 = o.Element("value").Value };

                       select new record { f1 = o.Element("id").Value, f2 = o.Element("accountnumber").Value, f3 = o.Element("type").Value };
            foreach (var d in obj)
            {
     record myobj = new record();
             myobj.f1=d.f1;//the first object will contain 1
             myobj.f2=d.f2; //10505749
             myobj.f3=d.f3;//subnumber .. and so on
             mylist.Add(myobj);
            }
    } 
```

嗨，我没有尝试反序列化，我会检查一下。你们中的一个人使用此代码发布的示例：

```
XElement doc =  XElement.Parse(batch);
doc.Descendants("conformation").Elements("component").Select(x =>
new record
{
   f1 = x.First().Element("name").Value,
   f2 = x.Skip(1).First().Element("name").Value,
   f3 = x.Skip(2).Element("name").Value
}; 
```

..给我以下错误：

错误 15“System.Xml.Linq.XElement”不包含“First”的定义，并且找不到接受“System.Xml.Linq.XElement”类型的第一个参数的扩展方法“First”（您是否缺少使用指令还是程序集引用？）

怎么来的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T19:05:19.620

尝试这个

```
XDocument doc = XDocument.Parse(batch);
var result = doc.
    XPathSelectElements("//component[name[text() = 'resultlist']]").
    Descendants("conformation").
    Select(y => new record
        {
            f1 = (string)y.XPathSelectElement("component[name[text() = 'id']]/value/state"),
            f2 = (string)y.XPathSelectElement("component[name[text() = 'accountnumber']]/value/string"),
            f3 = (string)y.XPathSelectElement("component[name[text() = 'type']]/value/string")
        }
    ); 
```

没有 XPath：

```
var result = doc.
    Descendants("conformation").
    Select(x => x.Elements("component")).
    Select(y => y.Select(z => new { name = (string)z.Element("name"), value = z.Element("value") })).
    Where(z => z.Any(m => m.name == "id")).
    Select(a => new record
        {
            f1 = (string)a.Where(m => m.name == "id").FirstOrDefault().value.Element("state"),
            f2 = (string)a.Where(m => m.name == "accountnumber").FirstOrDefault().value.Element("string"),
            f3 = (string)a.Where(m => m.name == "type").FirstOrDefault().value.Element("string")
        }
    ); 
```

# r - 在 R latticeExtra DoubleYscale 图中设置 y 轴范围和刻度线？

> ID：13497396
> 
> 赞同：2
> 
> 时间：2012-11-21T16:13:20.733
> 
> 标签：r

如何在 R latticeExtra DoubleYscale 图中设置 y 轴范围和刻度线？我希望两个 xyplot 中的主要和次要 y 轴刻度和刻度线相同。下面是我的 R 代码。目前，在地块 1 中，主要 y 比例从 -3 到 0，次要 y 比例从 -150 到 0。在地块 2 中，主要 y 比例从 -2 到 0，次要 y-比例是从-200 到 0。
我想要两个图的主要 y 比例是从 -3 到 0，次要 y 比例是从 -200 到 0，并且能够设置两个图中的刻度数。谢谢。

```
#load workspace stol and stoh
library(latticeExtra)
library(gridExtra)
plot1<-xyplot(percentloss*100 ~ time, groups=cap, pch=16,axis = axis.grid,
abline=c(list(h=c(0,-0.5,-1,-1.5,-2,-2.5,-3)),trellis.par.get("reference.line")),
main="Storage; 5 mL fill vol",
xlab="Time (hours)",
ylab="Evaporative loss (%)" ,
auto.key=list(border=TRUE), 
par.settings = simpleTheme(pch=16), scales=list(x=list(relation='same'), 
y=list(relation='same')),
data=stol)
plot2<-xyplot(absoluteloss*1000 ~ time, groups=cap, pch=16,
main="    ",
xlab="Time (hours)",
ylab="Absolute loss (uL)" ,
 data=stol)
plota<-doubleYScale(plot1, plot2, style1 = 0, style2 = 0, add.ylab2 = T)
plot3<-xyplot(percentloss*100 ~ time, groups=cap, pch=16,axis = axis.grid,
abline=c(list(h=c(0,-0.5,-1,-1.5,-2,-2.5,-3)),trellis.par.get("reference.line")),
main="Storage; 10 mL fill vol",
xlab="Time (hours)",
ylab="Evaporative loss (%)" ,
auto.key=list(border=TRUE), 
par.settings = simpleTheme(pch=16), scales=list(x=list(relation='same'), 
y=list(relation='same')),
data=stoh)
plot4<-xyplot(absoluteloss*1000 ~ time, groups=cap, pch=16,
main="    ",
xlab="Time (hours)",
ylab="Absolute loss (uL)" ,
data=stoh)
plotb<-doubleYScale(plot3, plot4, style1 = 0, style2 = 0, add.ylab2 = T)
grid.arrange(plota,plotb, ncol=2) 
```

# android - 带有瘦背景的 Android 搜索栏

> ID：13497408
> 
> 赞同：1
> 
> 时间：2012-11-21T16:13:13.400
> 
> 标签：android, android-widget

我正在使用 xml 为搜索栏创建自定义样式：

```
<layer-list xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:id="@android:id/background">
        <shape>
            <solid android:color="#00FF00" />
            <corners android:radius="0dp" />
        </shape>
    </item>

    <item android:id="@android:id/progress">
        <clip>
            <shape>
                <solid android:color="#FF0000" />
                <corners android:radius="0dp" />
            </shape>
        </clip>
    </item>
</layer-list>

<style name="Widget.MySeekBar" parent="android:Widget.SeekBar">
    <item name="android:indeterminateOnly">false</item>
    <item name="android:progressDrawable">@drawable/seek_bar_progress</item>
    <item name="android:minHeight">3dp</item>
    <item name="android:maxHeight">3dp</item>
    <item name="android:thumb">@drawable/image_seek_bar_thumb</item>
    <item name="android:thumbOffset">8dp</item>
    <item name="android:focusable">true</item>
</style> 
```

我希望背景比类似于标准果冻豆风格搜索栏的进度更薄。有没有办法做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T16:20:36.373

我在xml中使用过这个：

```
 <SeekBar
    android:id="@+id/seekID"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_below="@+id/linearLayoutComponentTopRow"
    android:layout_marginTop="1px"
    android:background="@drawable/slide_bar"
    android:progress="0"
    android:secondaryProgress="0"
    android:thumb="@drawable/bt_slider" /> 
```

它也设置了背景和缩略图。我希望它有帮助！

# c++ - 在 gcc 中显示 char 数组不起作用

> ID：13497409
> 
> 赞同：1
> 
> 时间：2012-11-21T16:13:13.603
> 
> 标签：c++

我写了一段代码，用gcc编译器测试

```
#include <iostream>

int main()
{
    char arr[ 1000 ];
    for( int index( 0 ); index < 1000; ++index )
    {
        std::cout << arr[ index ] << std::endl;
    }
    return 0;
} 
```

我希望它打印垃圾值，但令我惊讶的是，它没有打印任何东西。当我简单地将 arr 的数据类型从 char 更改为 int 时，它会按预期显示垃圾值。有人可以向我解释一下吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T16:23:39.377

for 字符类型的重载`<<`不将它们视为整数类型，而是将它们视为字符。如果垃圾值对应于一个可打印的字符（例如 97，它对应于`'a'`），您将看到它。如果不是（例如 0），你不会。如果垃圾值对应于一些转义序列，导致您的终端在黑色背景上使用黑色前景，那么您将看不到任何其他内容，句号。

如果您想查看 a （或任何字符类型）的实际数值`char`，只需`int`在输出之前将变量转换为：

```
std::cout << static_cast<int>( arr[index] ) << std::endl; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T16:16:17.553

你想要做的有一个`undefined behavior`. 一些编译器会为您清除内存，其他编译器会将其保留为创建缓冲区之前的状态。

总的来说，这是一个无用的测试。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-21T16:20:36.563

某些平台可能会选择，例如出于安全目的，用零填充未初始化的 char 数组，即使它不是静态的并且没有显式初始化。因此，这就是为什么没有垃圾出现的原因——你的 char 数组只是自动初始化的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-21T16:14:15.050

在您的平台上，垃圾字符不会打印。在另一个平台上可能会有所不同。

作为一个实验试试这个

```
std::cout << '|' << arr[ index ] << '|' << std::endl; 
```

看看`||`字符之间是否出现任何东西。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-21T16:17:37.157

你得到未定义的行为，因为你试图使用来自未初始化数组的值。你不能指望有什么特别的事情发生。也许每个字符都恰好是非打印字符。也许它只是决定不想打印任何东西，因为它不喜欢你的小游戏。什么都行。

# orchardcms - 是否可以在非主题视图中使用公共资源？

> ID：13497410
> 
> 赞同：2
> 
> 时间：2012-11-21T16:14:17.747
> 
> 标签：orchardcms

我正在使用 orchard cms v 1.4 并开发一些独立且不使用标准主题的网站内容。我想在非主题视图上使用清单文件中已经声明的一些资源。但是，它们仅在我将主题应用于控制器或特定视图时才会呈现。

在我看来，我包括以下内容：

```
@{
    Script.Require("jQuery").AtHead();
} 
```

这仅在我包含以下内容时按预期发挥作用：`[Themed]` 作为我的控制器上的一个属性。

关于如何在不为我的独立页面创建完整主题的情况下使其正常工作的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T16:49:43.263

是的，请参阅[http://weblogs.asp.net/bleroy/archive/2012/10/20/writing-an-unthemed-view-while-still-using-orchard-shapes-and-helpers.aspx](http://weblogs.asp.net/bleroy/archive/2012/10/20/writing-an-unthemed-view-while-still-using-orchard-shapes-and-helpers.aspx)

重要的是您使用形状作为模型。主题与否并不重要。

# javascript - 将多个选择器存储在单个变量中

> ID：13497414
> 
> 赞同：0
> 
> 时间：2012-11-21T16:14:36.830
> 
> 标签：javascript, jquery, jquery-selectors, jquery-on, prop

我有一段代码可以处理代表按钮的图像的点击。如果单击该图像，则其对应的图像将显示给用户。通过选择图像的多个 ID，下面的 vode 可以正常工作。

```
$("#content").on('click','#buttonID1, #buttonID2, #buttonID3, #buttonID4', function(){
    var $varThis = $(this);
    var tmpID = $varThis.prop('id').split('ID')[1];         
    $('#imageID'+tmpID).css({'display': 'block'});
}); 
```

但是，我将有更多这些 ID 可供选择。那么是否可以将图像存储`#buttonID`在单个变量中并将该变量放在`.on()`方法中？他们会被独立选择吗？

下面的代码不起作用。

```
var $buttons = $('#buttonID1, #buttonID2, #buttonID3, #buttonID4');
$("#content").on('click',$buttons, function(){
     var $varThis = $(this);
     var tmpID = $varThis.prop('id').split('ID')[1];            
     $('#imageID'+tmpID).css({'display': 'block'});
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T16:16:41.917

这不就是上课的目的吗？添加一个类，让我们将其称为`myButton`所有按钮，然后将其用作选择器。

```
$("#content").on('click','.myButton', function(){ 
```

或者，如果您坚持使用 id，这应该可以工作：

```
var buttons = '#buttonID1, #buttonID2, #buttonID3, #buttonID4';
$("#content").on('click',buttons, function(){ 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-21T16:17:03.487

改变

```
var $buttons = $('#buttonID1, #buttonID2, #buttonID3, #buttonID4');

To

var $buttons = '#buttonID1, #buttonID2, #buttonID3, #buttonID4';

  $("#content").on('click',$buttons, function(){
        var $varThis = $(this);
        var tmpID = $varThis.prop('id').split('ID')[1];         
        $('#imageID'+tmpID).css({'display': 'block'});
    }); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-21T16:43:28.830

您应该为此使用 css attribute-starts-with 选择器：

```
$("#content").on('click','button[id^="buttonID"]', function(){
 ...
} 
```

# linux - linux中一行末尾的奇怪字符。使用 getline 读取行

> ID：13497418
> 
> 赞同：0
> 
> 时间：2012-11-21T16:14:01.200
> 
> 标签：linux, getline, chars

一开始，我想说我是 linux 和其他东西的初学者。

我正在使用 GetLine 读取文件（逐行）。

一开始，我用函数打开打开文件描述符。

然后我将 (int)f_descriptor 更改为 (FILE*)f_stream （因为 GetLine 需要 FILE* arg）。

我将整行拆分为单词（空格是分隔符）并将它们放入 char** words_array 中。一切正常，只要它不是最后一个字。出于某种原因，遗言的末尾有一些奇怪的字符。它并不总是发生。

![在此处输入图像描述](../Images/f254125feeda4e772420c0e8f992964c.png)

为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T17:47:55.987

从外观上看，我怀疑您没有以空值终止最后一个字符串。它报告的长度是正确的，但是您有额外的字节这一事实可能意味着您正在将内容复制到一个内存区域中，该区域最初包含一些（但不是全部）空字节，但您没有添加显式空字节。如果您想要一个更好的答案，如果您可以在您正在读取数据的地方发布一些代码，这将有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T19:55:37.047

您不能简单地将 a 更改`(int) f_descriptor`为 a `(FILE*) f_stream`。他们是两个非常非常不同的东西。如果使用`open()`to get `f_descriptor`，则需要使用`read()`and`write()`来访问文件，但如果使用`fopen()`to get `f_stream`，则使用`fgetch()`, `fread()`, `fwrite()`, `gets()`, `puts()`, `fprintf()`,`fscanf()`等。

# mysql - INSERT INTO SQL DATEADD 昨天

> ID：13497420
> 
> 赞同：5
> 
> 时间：2012-11-21T16:15:09.823
> 
> 标签：mysql, dateadd

我想用 PHP 和 MySQL 插入昨天的那一天。所以我的想法是：

```
INTO chartValues SET timestamp='1353369600', `datetime`=DATEADD(d,-1,GETDATE()) 
```

但它不起作用：

> 1064 - 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在 `datetime`第 1 行的 'INTO chartValues SET timestamp='1353369600', =DATEADD(d,-1,GETDATE())'附近使用正确的语法

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T16:18:20.043

`DATEADD`并且`GETDATE()`是 SQL Server 中使用的 T-SQL 函数。

你想使用`DATE_ADD()`or `DATE_SUB()`with`NOW()`

```
INSERT INTO chartValues SET timestamp='1353369600', `datetime`= DATE_SUB(NOW(), INTERVAL 1 DAY) 
```

[参考](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_date-add)

> `DATE_SUB(date, INTERVAL expr unit)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T16:18:15.577

我相信你应该`NOW()`在 MySql 中使用，而不是`getdate()`. 请参阅[Mysql 日期和时间函数](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T16:18:17.873

Date_add() 不是 dateadd() now() 不是 getdate()

底部的链接是我推荐的mysql编程的一个很好的参考。

所以`datetime`= date_add(d,-1,now())

[http://www.w3schools.com/sql/func_date_add.asp](http://www.w3schools.com/sql/func_date_add.asp)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T16:18:58.213

你可以在 php 中使用这样的东西：

```
date("F j, Y", time() - 60 * 60 * 24); 
```

根据数据库中的数据类型，您可以使用您需要的格式更改“F j，Y”。

在mysql中是这样的：

```
CAST(NOW() - INTERVAL 1 DAY AS DATE). 
```

# git - Git 没有检测到存储库

> ID：13497424
> 
> 赞同：4
> 
> 时间：2012-11-21T16:14:17.047
> 
> 标签：git, repository

我的一位同事正在使用 git 并在安装 kdiff3 以用作合并工具来解决合并问题之后。

他不知道如何，但 git 没有检测到存储库，但文件似乎在那里并且正确 /.git 和 .gitignore。我谷歌这个问题并没有找到答案。

我使用 git 已经 3 年了，从来没有见过这样的事情。不幸的是，本地存储库的最后一次备份大约有 2 个月。

# c++ - 当我在实际收听消息之前收到消息时应用什么设计模式

> ID：13497431
> 
> 赞同：0
> 
> 时间：2012-11-21T16:14:49.343
> 
> 标签：c++, design-patterns, boost-asio, messaging

我设计了一种 Publish/Subscribe Observer/Listener 设计模式，我的业务系统订阅以收听一种类型的消息 A，然后取消订阅以便订阅以收听另一种类型的消息 B。

问题是我收到消息 A 和 B 真的一个接一个地很短，如此之快以至于我的系统在已经收到 B 消息时还没有订阅收听 B 消息： 结果是，在我当前的系统中，我的听众永远不会通知。

我正在考虑使用队列来存储所有传入消息，并在通知侦听器后使用它们。

但我想知道是否有针对此类问题的通用实现。

# subquery - 在 Kohana 中使用子查询时如何获取最后一个插入 ID

> ID：13497448
> 
> 赞同：2
> 
> 时间：2012-11-21T16:16:59.660
> 
> 标签：subquery, kohana, lastinsertid

在 Kohana 中使用子查询时如何返回正确的 $insert_id？

我正在使用查询方法返回 $insert_id 和 $affected_rows。它为 $affected_rows 返回正确的值，但为不正确的 $insert_id 返回“1”。

如下查询：

```
$sub = DB::select('id', 'username', 'email', 'lastVisitDate')->from('jos_users');

$qry_migrate_users = DB::insert('temp_users', array('old_id', 'username', 'email_work', 'last_login'))->select($sub);

list($insert_id, $affected_rows) = $qry_migrate_users->execute($this->conn_target); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-26T12:15:52.123

MySQL 仅返回最后一个插入 id 和受影响的行。只有一种方法可以做你想做的事 - 执行你的子选择到数组，并使用 foreach 做单次插入。但它的操作有点慢！或者在插入之后做这样的事情：

```
SELECT id FROM temp_users WHERE email IN (select email from jos_users) 
```

你可能明白其中的逻辑

# objective-c - 在 Ubuntu 上找不到 Foundation 头文件

> ID：13497449
> 
> 赞同：0
> 
> 时间：2012-11-21T16:16:01.067
> 
> 标签：objective-c, ubuntu, gnustep

我有一个带有 Slicehost（现为 RackSpace）的 Ubuntu 服务器，并且正在尝试安装 GNUstep，以便我可以编译 Objective-c 代码。

在通过 apt-get 安装世界并浏览大量博客以尝试编译我的源代码之后，我现在似乎很清楚我没有安装 Foundation.h 头文件，我不知道从哪里获得这些头文件.

它们出现在我的 Mac 上，也许我可以简单地将它们复制到 Ubuntu 上，这一切都会变成肉汁 - 一厢情愿？

任何有关如何定位和安装 Foundation.h 文件的帮助表示赞赏。

**回答安迪的问题**

```
~: dpkg -l | grep -i gnustep                                                                                                                                                           
ii  gnustep-back-common               0.12.0-1                    The GNUstep GUI Backend - common files
ii  gnustep-back0.12                  0.12.0-1                    The GNUstep GUI Backend
ii  gnustep-back0.12-art              0.12.0-1                    The GNUstep GUI Backend
ii  gnustep-base-common               1.14.1-2ubuntu1             GNUstep Base library - common files
ii  gnustep-base-runtime              1.14.1-2ubuntu1             GNUstep Base library
ii  gnustep-common                    2.0.2-1                     Common files for the core GNUstep environmen
ii  gnustep-core                      6                           The GNUstep Development Environment -- core
ii  gnustep-devel                     6                           The GNUstep Development Environment -- devel
ii  gnustep-gpbs                      0.12.0-1                    The GNUstep PasteBoard Server
ii  gnustep-gui-common                0.12.0-3ubuntu1             GNUstep GUI Library - common files
ii  gnustep-gui-runtime               0.12.0-3ubuntu1             GNUstep GUI Library - runtime files
ii  gnustep-make                      2.0.2-1                     Basic GNUstep Makefiles
ii  gorm.app                          1.2.2-1                     Visual Interface Builder for GNUstep
ii  libgnustep-base1.14               1.14.1-2ubuntu1             GNUstep Base library
ii  libgnustep-gui0.12                0.12.0-3ubuntu1             GNUstep GUI Library
ii  projectcenter.app                 0.4.3-3ubuntu1              IDE for GNUstep Development
ii  projectmanager.app                0.2-3                       Simple IDE for GNUstep 
```

回答第二个问题。

```
~: sudo apt-get install libgnustep-base-dev
Reading package lists... Done
Building dependency tree       
Reading state information... Done
Some packages could not be installed. This may mean that you have
requested an impossible situation or if you are using the unstable
distribution that some required packages have not yet been created
or been moved out of Incoming.

Since you only requested a single operation it is extremely likely that
the package is simply not installable and a bug report against
that package should be filed.
The following information may help to resolve the situation:

The following packages have unmet dependencies.
  libgnustep-base-dev: Depends: libxslt1-dev but it is not going to be installed
E: Broken packages 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T17:12:22.087

您正在运行哪个版本的 Ubuntu 服务器？

我正在运行 Ubuntu server 10.04 LTS 并找到我的`Foundation.h`under `/usr/include/GNUstep/Foundation/Foundation.h`，它属于 package `libgnustep-base-dev`。在其他版本中可能会有所不同...

也许你可以发布你的输出`dpkg -l | grep -i gnustep`来比较我们的列表。

```
root@scm ~ # cat /etc/lsb-release 
DISTRIB_ID=Ubuntu
DISTRIB_RELEASE=10.04
DISTRIB_CODENAME=lucid
DISTRIB_DESCRIPTION="Ubuntu 10.04.4 LTS"
root@scm ~ # locate Foundation.h
/usr/include/GNUstep/Foundation/Foundation.h
root@scm ~ # ls -l /usr/include/GNUstep/Foundation/Foundation.h
-rw-r--r-- 1 root root 4991 2009-08-31 23:45 /usr/include/GNUstep/Foundation/Foundation.h
root@scm ~ # dpkg -S /usr/include/GNUstep/Foundation/Foundation.h
libgnustep-base-dev: /usr/include/GNUstep/Foundation/Foundation.h
root@scm ~ # dpkg -l | grep -i gnustep
ii  gnustep-back-common             0.16.0-3                     The GNUstep GUI Backend - common files
ii  gnustep-back-doc                0.16.0-3                     The GNUstep GUI Backend documentation
ii  gnustep-back0.16                0.16.0-3                     The GNUstep GUI Backend
ii  gnustep-back0.16-art            0.16.0-3                     The GNUstep GUI Backend
ii  gnustep-base-common             1.19.3-1ubuntu1              GNUstep Base library - common files
ii  gnustep-base-doc                1.19.3-1ubuntu1              Documentation for the GNUstep Base Library
ii  gnustep-base-runtime            1.19.3-1ubuntu1              GNUstep Base library
ii  gnustep-common                  2.2.0-1                      Common files for the core GNUstep environmen
ii  gnustep-core-devel              7.4                          The GNUstep Development Environment -- core 
ii  gnustep-core-doc                7.4                          The GNUstep Development Environment -- core 
ii  gnustep-devel                   7.4                          The GNUstep Development Environment -- devel
ii  gnustep-gpbs                    0.16.0-3                     The GNUstep PasteBoard Server
ii  gnustep-gui-common              0.16.0-2build1               GNUstep GUI Library - common files
ii  gnustep-gui-doc                 0.16.0-2build1               Documentation for the GNUstep GUI Library
ii  gnustep-gui-runtime             0.16.0-2build1               GNUstep GUI Library - runtime files
ii  gnustep-make                    2.2.0-1                      Basic GNUstep Makefiles
ii  gnustep-make-doc                2.2.0-1                      Documentation for GNUstep-make
ii  gorm.app                        1.2.8-1ubuntu0.1             Visual Interface Builder for GNUstep
ii  libgnustep-base-dev             1.19.3-1ubuntu1              GNUstep Base header files and development li
ii  libgnustep-base1.19             1.19.3-1ubuntu1              GNUstep Base library
ii  libgnustep-gui-dev              0.16.0-2build1               GNUstep GUI header files and static librarie
ii  libgnustep-gui0.16              0.16.0-2build1               GNUstep GUI Library
ii  librenaissance0                 0.9.0-2build2                GNUstep GUI Framework - library files
ii  librenaissance0-dev             0.9.0-2build2                GNUstep GUI Framework - development file
ii  projectcenter.app               0.5.0~20080704-1build1       IDE for GNUstep Development
root@scm ~ # 
```

# php - PHP PDO在不同函数中连接和关闭连接

> ID：13497453
> 
> 赞同：4
> 
> 时间：2012-11-21T16:17:14.280
> 
> 标签：php, mysql, pdo

也许这是一个愚蠢的问题，但我对 PDO 很陌生并且很困惑。是否可以在一个函数中实例化 PDO 对象（打开与服务器/数据库的连接），然后在另一个函数中关闭相同的连接？是否需要将函数传递给对象才能关闭它？我想这样做，这样我就可以创建一个无处不在的站点范围的函数，我可以调用它来启动连接、执行非通用 sql，然后用另一个站点范围的函数关闭它。我怎样才能做到这一点？我需要将对象作为参数传递给这些函数吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-21T16:41:51.220

是的，这是可能的。我建议使用启动与 MySQL 的连接的构造函数和使它无效的析构函数。这样，您就不必在每次想要打开和关闭连接时手动调用该函数。每当调用对象的新实例时，连接就会打开，并且当没有对该对象的进一步引用时，连接将被取消。

它可能看起来像这样：

```
 private $l; //MySQL Connection

    //Called automatically upon initiation
    function __construct() {
        try {
            $this->l = new PDO("mysql:host=".MYSQL_HOST.";dbname=".MYSQL_DATABASE, MYSQL_USER, MYSQL_PASSWORD); //Initiates connection
            $this->l->setAttribute( PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION ); // Sets error mode
        } catch (PDOException $e) {
            file_put_contents("log/dberror.log", "Date: " . date('M j Y - G:i:s') . " ---- Error: " . $e->getMessage().PHP_EOL, FILE_APPEND);
            die($e->getMessage()); // Log and display error in the event that there is an issue connecting
        } 
    }

    //Called automatically when there are no further references to object
    function __destruct() {
        try {
            $this->l = null; //Closes connection
        } catch (PDOException $e) {
            file_put_contents("log/dberror.log", "Date: " . date('M j Y - G:i:s') . " ---- Error: " . $e->getMessage().PHP_EOL, FILE_APPEND);
            die($e->getMessage());
        }
    } 
```

你可能会发现这个关于构造函数和析构函数的参考很有用：http: [//php.net/manual/en/language.oop5.decon.php](http://php.net/manual/en/language.oop5.decon.php)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T16:35:10.033

据我了解，您只需连接到数据库一次，而不必为每个函数打开连接。数据库连接将自动关闭，但您可以通过将空值分配给 PDO 对象来手动关闭它。

当您实例化 PDO 对象时建立连接。

```
$dbh = new PDO("mysql:host=$hostname;dbname=mysql", $username, $password); 
```

并在脚本末尾或您为其分配空值时自动关闭

```
$dbh = null; 
```

有用的指南[在这里](http://www.phpro.org/tutorials/Introduction-to-PHP-PDO.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T16:22:36.627

好吧，例如，您可以在 php 中有一个主要的工作类，它在其类中实例化一个 DBRoutines 对象。对象引用作为受保护的 var/object 驻留在 worker 中，但对 DB 类中的所有 DB 例程进行 -> 调用。并在其生命周期的后期调用 DB::Close 函数。这么确定。

索引.php：

```
class Xcrud
{   protected static $firephp;
    protected static $_instance = array(); 
```

...

...

```
$db = Xcrud_db::get_instance($this->connection);

$db->query("SELECT `{$field}` FROM `{$this->table}` WHERE `{$this->primary}` = " . $db->escape($this->primary_key) . " LIMIT 1"); 
```

xcrud_db.php：

```
class Xcrud_db
{   protected static $firephp;
private static $_instance = array();
private $connect;
private $result;
private $dbhost;
private $dbuser;
private $dbpass;
private $dbname;
private $dbencoding;

public static function get_instance($params = false)
{   some code
}
private function __construct($dbuser, $dbpass, $dbname, $dbhost, $dbencoding)
{
    $this->firephp = FirePHP::getInstance(true);
    $this->firephp->setEnabled(true);
    //$this->firephp->log('xcrud_db.php:__construct');
    if (strpos($dbhost, ':') !== false)
    {
        list($host, $port) = explode(':', $dbhost, 2);
        $this->connect = mysqli_connect($host, $dbuser, $dbpass, $dbname, $port);
    } else
        $this->connect = mysqli_connect($dbhost, $dbuser, $dbpass, $dbname);
    if (!$this->connect)
        $this->error('Connection error. Can not connect to database');
    $this->connect->set_charset(str_replace('-', '', $dbencoding));
    if ($this->connect->error)
        $this->error($this->connect->error);
}
public function query($query = '')
{
    $this->firephp->log('xcrud_db.php:query='.$query);
    $this->result = $this->connect->query($query); //echo $query;
    if ($this->connect->error)
        $this->error($this->connect->error);
    return $this->connect->affected_rows;
}
etc 
```

# html - 图像/CSS 不会在 OSCommerce 上加载

> ID：13497455
> 
> 赞同：1
> 
> 时间：2012-11-21T16:17:19.923
> 
> 标签：html, css, image, layout, web

我在这个网站上工作； [http://netadvokaten.se/](http://netadvokaten.se/)

这是一个标准的 OsCommerce 页面，我还没有开始编辑它，所以它是直接从包中取出的。从我所看到的图像不会加载，并且布局也很差。

我怀疑这是一个损坏的安装，但同样的安装可以在我家的本地服务器上运行。

有谁知道我该如何开始解决这个问题？谷歌一个小时没有帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T16:31:15.470

您的样式和 Javascript 文件未正确加载。

您的路线可能有问题，或者您忘记上传它们。

# c# - 这两个 Java 和 C# 语句是否相等？

> ID：13497456
> 
> 赞同：1
> 
> 时间：2012-11-21T16:16:23.080
> 
> 标签：c#, java, .net, interface

在 C# 中

```
class ListMap<K, E>
    : ImyMap<K, E>, IComparable<K>, IEnumerable<KeyValuePair<K, E>>
{
} 
```

在爪哇

```
class MyListMap<K extends Comparable<? super K>, E>
    implements MyMap<K,E>, Iterable<KeyValuePair<K, E>>
{
} 
```

只是试图将一些数据结构从 Java 转换为 C#，并想知道我的 C# 实现是否与我的 Java 相同。

如果不是，请您纠正它吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-21T16:22:20.927

不，那些不相等。该`K extends ...`部分需要转换为约束：

```
class ListMap<K, E>
    : ImyMap<K, E>, IEnumerable<KeyValuePair<K, E>>
   where K : IComparable<K>
{
} 
```

通配符`? super K`在 C# 中不是必需的。通配符是 Java 支持协/逆变的方式。在 C# 中，这是作为接口声明的一部分完成的：

```
interface IComparable<in K> { ... } 
```

修饰符使接口逆变，这`in`与Java中的通配符具有相同的效果。

# android - 如何通过单击 Android 中的按钮来更改布局中的视图？

> ID：13497460
> 
> 赞同：0
> 
> 时间：2012-11-21T16:17:39.547
> 
> 标签：android, android-layout, radio-button, textview

![我的要求](../Images/92240e641ba28c01ffa83e39fbafef0a.png)

我正在回答问题和答案`String[]`。`TextView`有问题并`RadioButton`有相应的答案。如果`Start Button`单击 ，第一组问题和答案将显示在 中`Linear Layout1`。如果`Next Button`单击`LinearLayout1`被替换为下一组带有答案的问题，如果再次`Next Button`被单击，则必须替换下一组问题，反之亦然。*帮我写代码`Next Button`*

**注意**：仅`LinearLayout 1`应在单击时更改`Next Button`

代码：

```
TextView tv;
RadioButton rb1, rb2;
Button bStart, bNext;
String question[] = { "Key Lime Pie is upcoming version",
        "Android is Middleware", "Which is latest Android version?" };
String answerA[] = { "True", "False" };
String answerB[] = { "True", "False" };
String answerC[] = { "Android 4.2", "Android 5" };

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.ques);
    tv = (TextView) findViewById(R.id.textView111);
    rb1 = (RadioButton) findViewById(R.id.radioButton1);
    rb2 = (RadioButton) findViewById(R.id.radioButton2);

    bStart = (Button) findViewById(R.id.startExam);
    bNext = (Button) findViewById(R.id.bNext);
    bStart.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            // TODO Auto-generated method stub
            tv.setText(question[0]);
            rb1.setText(answerA[0]);
            rb2.setText(answerA[1]);
        }
    });
    bNext.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            // TODO Auto-generated method stub
            tv.setText(question[1]);
            rb1.setText(answerB[0]);
            rb2.setText(answerB[1]);

        }
    });
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T16:28:42.707

为答案创建一个数组。并将问题和答案的跟踪变量声明为：

```
 String answer[] = {"True", "False" , "True", "False", 
                     "Android 4.2", "Android 5" };
  int current = 0; // this is your new variable
  int ans = 1;     // this is initialized to 1, because 
                   // I assumed your first question and answer
                   // is displayed with the press of start button 
```

将您的下一个按钮侦听器更改为此

```
public void onClick(View v) {
        current ++;
        if(current < question.length){
            tv.setText(question[current]);
            rb1.setText(answer[ans+=1]);
            rb2.setText(answer[ans+=1]);
        }

    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T16:33:43.000

这是一个逻辑问题。

1.  将所有答案合并到一个多维数组中。
2.  跟踪当前的问题。
3.  使用跟踪变量获取问题标题`question`。
4.  使用跟踪变量获取多维答案数组中的答案。这是数组的第一个维度。
5.  您阅读该维度中的答案并将它们显示在`rb1`和中`rb2`。

通过使用你在那里的东西，你将在扩展该代码时遇到问题。毕竟，你真的要为每组不同的答案创建一个新变量吗？这没有任何意义。多维数组有效。

然而......虽然你可以改进你的数组结构并使用 an`int`来跟踪当前显示的问题（并因此在按下 后增加它以获得下一个问题`bNext`），我建议你尝试创建更有意义的对象，比如一个`Question`类, 与相关成员 ( `title`, `optionA`, `optionB`, 不管...)，尤其是因为看起来您正在使用此代码来学习如何编写测验风格的应用程序。

然后，您可以创建各种问题并进行迭代。

但这就是问题所在吗？不，问题在于跟踪问题和答案。使用带有跟踪变量的多维数组。

**// 已编辑：**好的，我将很快为您推荐一些东西：

```
static String[] questions = new String[] { "Question 1", "Question 2", "Question 3" };
static String[][] answers = new String[][] {
        {"Answer 1.a", "Answer 1.b"},
        {"Answer 2.a", "Answer 2.b"},
        {"Answer 3.a", "Answer 3.b"},
    };
int pos = -1;

void showNextAnswer() {
    pos++;
    tv.setText(questions[pos]);
    rb1.setText(answers[pos][0]);
    rb2.setText(answers[pos][1]);
}

bStart.setOnClickListener(new View.OnClickListener() {
    public void onClick(View v) {
        showNextAnswer();
    }
});

bNext.setOnClickListener(new View.OnClickListener() {
    public void onClick(View v) {
        showNextAnswer();
    }
}); 
```

你可以，两个按钮做同样的事情，所以最好只使用下一个按钮。

# c# - 在 mvc 中填充模型列表属性

> ID：13497475
> 
> 赞同：3
> 
> 时间：2012-11-21T16:18:21.747
> 
> 标签：c#, asp.net-mvc

我有一个带有列表属性的模型。在我看来，用户将填写固定数量的类似数据（姓名编号等）。我如何收集这些信息并在帖子上创建一个列表？谢谢你的帮助。

```
public class mainonject
{
    public List<test> list{ get; set; }
}

public class test
{
    string name;
    string number;
}

<form>
    HOW DO I COLLECT THE PROPERTY list AS A LIST TO THE SERVER
    <input type="submit" value="submit"/> 
</form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T16:27:00.073

只需将字段添加到您的表单并在名称属性中使用正确的索引：

```
<input name="list[0].Name" type="text" />
<input name="list[0].Number" type="text" />

<input name="list[1].Name" type="text" />
<input name="list[1].Number" type="text" /> 
```

...

# c# - 为什么我的 json 反序列化失败了？

> ID：13497478
> 
> 赞同：3
> 
> 时间：2012-11-21T16:17:30.727
> 
> 标签：c#, json, deserialization, restsharp, rest-client

我有以下两个对象（我无法控制也无法更改）：

```
[Serializable]
[DataContract]
public class AddressContactType : BaseModel
{
    public AddressContactType();

    [DataMember]
    public string AddressContactTypeName { get; set; }
}

[Serializable]
[DataContract]
public abstract class BaseModel
{
    protected BaseModel();

    [DataMember]
    public int Id { get; set; }
    [DataMember]
    public string NativePMSID { get; set; }
    [DataMember]
    public string PMCID { get; set; }
} 
```

我正在使用 RestClient 进行 GET 调用以在 JSON 中检索此数据。请求成功。返回的 JSON 是：

```
[{"Id":0,"NativePMSID":"1","PMCID":"1020","AddressContactTypeName":"Home"},{"Id":0,"NativePMSID":"2","PMCID":"1020","AddressContactTypeName":"Apartment"},{"Id":0,"NativePMSID":"3","PMCID":"1020","AddressContactTypeName":"Vacation"},{"Id":0,"NativePMSID":"3","PMCID":"1020","AddressContactTypeName":"Other"}] 
```

从那时起，我尝试以三种不同的方式反序列化数据。

我的代码：

```
var request = new RestRequest("AddressContactType", Method.GET);
        request.AddHeader("Accept", "application/json");
        request.AddParameter("PMCID", "1020");

        #region JSON Deserialization

        // ---- Attempt #1
        var response = client.Execute<AddressContactType>(request);

        // ---- Attempt #2
        var myResults = response.Content;

        var ms = new MemoryStream(Encoding.UTF8.GetBytes(myResults));
        var ser = new DataContractJsonSerializer(typeof(AddressContactType));
        var result = (AddressContactType)ser.ReadObject(ms);

        // ---- Attempt #3
        var jsonSettings = new JsonSerializerSettings()
        {
            Formatting = Formatting.Indented,
            DateFormatHandling = DateFormatHandling.MicrosoftDateFormat,
            DateTimeZoneHandling = DateTimeZoneHandling.Utc,
            PreserveReferencesHandling = PreserveReferencesHandling.Objects
        };

        var result2 = new AddressContactType();
        result2 = JsonConvert.DeserializeObject<AddressContactType>(new StreamReader(ms).ReadToEnd(), jsonSettings);

        #endregion 
```

在尝试 1 下，RestClient 尝试返回错误：“无法将 'RestSharp.JsonArray' 类型的对象转换为 'System.Collections.Generic.IDictionary`2[System.String,System.Object]'。”

在尝试 2 下，显示的对象结果具有正确的属性（Id、NativePMSID、PMCID 和 AddressContactTypeName），但它们都为空，并且仅显示了每个实例的一个实例。

尝试 3 只为 result2 返回一个空值。

有什么建议么？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T17:26:11.187

看来我的问题的解决方案是：

```
 List<AddressContactType> myResults2;

        using (Stream ms2 = new MemoryStream(Encoding.UTF8.GetBytes(myResults)))
        {
            myResults2 = JsonConvert.DeserializeObject<List<AddressContactType>>(new StreamReader(ms2).ReadToEnd());
        } 
```

我与前面的步骤之一很接近，但这给了我一个完整的列表。

# java - Java 小程序在浏览器中不起作用

> ID：13497479
> 
> 赞同：0
> 
> 时间：2012-11-21T16:18:33.997
> 
> 标签：java, applet

我制作一个java小程序的人：

```
 import java.net.InetAddress;
public class PegaIP {
    public static void main(String[] args) {
        try {
            getAppletContext().showDocument
                    (new URL("javascript:UpdateIP(\"" + InetAddress.getLocalHost().getHostAddress() + "\")"));
        } catch (Exception e) { }
    }
} 
```

我收到了一些错误：

```
Plug-in 10.9.2.05 do Java  
Usando versão JRE 1.7.0_09-b05 Java HotSpot(TM) Client VM  
Diretório home do usuário = C:\Users\Edilsom  

c:   limpar janela da console  
f:   concluir objetos da fila de finalização  
g:   coleta de lixo  
h:   exibir esta mensagem de ajuda  
l:   descartar lista de carregadores de classes  
m:   imprimir uso de memória  
o:   log do trigger  
q:   ocultar console  
r:   recarregar configuração da política  
s:   descartar propriedades do sistema e de implantação  
t:   descartar lista de threads  
v:   descartar pilha de threads  
x:   limpar cache do carregador de classes  
0-5: definir nível de rastreamento como <n>  

Match: beginTraversal  
Match: digest selected JREDesc: JREDesc[version 1.6+, heap=-1--1, args=null, ref=http://java.sun.com/products/autodl/j2se, sel=false, null, null], JREInfo: JREInfo for index 0:  
platform is: 1.7  
product is: 1.7.0_09  
location is: http://java.sun.com/products/autodl/j2se  
path is: C:\Program Files (x86)\Java\jre7\bin\javaw.exe  
args is: null  
native platform is: Windows, x86 [ x86, 32bit ]  
JavaFX runtime is: JavaFX 2.2.3 found at C:\Program Files (x86)\Java\jre7\  
enabled is: true  
registered is: true  
system is: true  

Match: ignoring maxHeap: -1  
Match: ignoring InitHeap: -1  
Match: digesting vmargs: null  
Match: digested vmargs: [JVMParameters: isSecure: true, args: ]  
Match: JVM args after accumulation: [JVMParameters: isSecure: true, args: ]  
Match: digest LaunchDesc: null  
Match: digest properties: []  
Match: JVM args: [JVMParameters: isSecure: true, args: ]  
Match: endTraversal ..  
Match: JVM args final:   
Match: Running JREInfo Version    match: 1.7.0.09 == 1.7.0.09  
Match: Running JVM args match: have:<>  satisfy want:<>  
CacheEntry[http://localhost/3gloja/pegaip.class]: updateAvailable=true,lastModified=Tue Nov 20 22:46:40 GMT-03:00 2012,length=780 
```

我做错了什么？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T16:24:23.997

Java 小程序不与 main 一起运行，您需要 init。还必须扩展 JApplet。

导入 javax.swing.JApplet；

公共类 PegaIP 扩展 Applet

public void init() 替换 public static void main(String[] args)

可以在此处找到资源：http: [//docs.oracle.com/javase/tutorial/deployment/applet/getStarted.html](http://docs.oracle.com/javase/tutorial/deployment/applet/getStarted.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-22T00:50:29.913

人们这是代码对我来说很好：

```
import java.net.InetAddress;
import java.net.MalformedURLException;
import java.net.URL;
import java.net.UnknownHostException;
import javax.swing.JApplet;
public class PegaIP extends JApplet {
    @Override
    public void init() {
        try {
            getAppletContext().showDocument (new URL("javascript:UpdateIP(\"" + InetAddress.getLocalHost().getHostAddress() + "\")"));
        } catch (UnknownHostException | MalformedURLException e) {
            System.err.println("Ocorreu erro na criação da GUI");
        }
    }
} 
```

谢谢大家帮我...

# .htaccess - index.php 的 .htaccess 重定向正在破坏 404 页

> ID：13497481
> 
> 赞同：3
> 
> 时间：2012-11-21T16:18:37.323
> 
> 标签：.htaccess, redirect, http-status-code-404

我最近通过 .htaccess 设置了 index.php 重定向。这里的想法是消除当站点同时具有 index.php 和 /（homapage）被索引时出现的重复内容问题。

这是我原来的 .htaccess

```
Options -Indexes
ErrorDocument 403 /customerrors/403.html
ErrorDocument 401 /customerrors/401.html
ErrorDocument 400 /customerrors/400.html
ErrorDocument 500 /customerrors/500.html
ErrorDocument 404 /customerrors/404.html 
```

很基本。

我使用此处列出的技术将 index.php 重定向到 /。

[http://www.askapache.com/htaccess/redirect-index-blog-root.html](http://www.askapache.com/htaccess/redirect-index-blog-root.html)

它也很好用。一个问题是，它打破了 404 页。

这是破坏 404 页面的修改后的 .htaccess。

```
RewriteEngine On
RewriteBase /
DirectoryIndex index.php
RewriteCond %{http_host} ^example.com [NC]
RewriteRule ^(.*)$ http://www.example.com/$1 [R=301,L]
RewriteCond %{THE_REQUEST} ^[A-Z]{3,9}\ /index\.php\ HTTP/
RewriteRule ^index\.php$ http://example.com/ [R=301,L]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
Options -Indexes
ErrorDocument 403 /customerrors/403.html
ErrorDocument 401 /customerrors/401.html
ErrorDocument 400 /customerrors/400.html
ErrorDocument 500 /customerrors/500.html
ErrorDocument 404 /customerrors/404.html 
```

因此，如果用户输入或访问 www.example.com/dafjkadbfda 而不是提供 404 页面，则 URL 保持不变（在这种情况下是损坏的）并切断 index.php 页面。

这反过来又打开了另一罐蠕虫。所有这些损坏的页面都作为重复的内容和元数据出现。

是否有另一种编写 .htacess 重定向的方法来考虑 404 页面？似乎这就是这里的冲突。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-28T00:33:17.087

.htaccess 的这一部分是“破坏” 404 的部分：

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L] 
```

您可以通过从 PHP 脚本发送 404 错误来解决问题：

```
if ($not_a_valid_page){
    header("$_SERVER[SERVER_PROTOCOL] 404 Not Found");
    readfile("./customerrors/404.html");
    die();
} 
```

# ruby-on-rails - 使用 Phusion Passenger 和 apache 的 Rails 3 在生产模式下不起作用

> ID：13497488
> 
> 赞同：2
> 
> 时间：2012-11-21T16:17:59.877
> 
> 标签：ruby-on-rails

我有 Rails3、Phusion 乘客 3 和 apache。我有一个相当简单的应用程序，一个控制器和一个视图来打印你好世界。如果从虚拟主机“RailsEnv development”中删除此行，我会收到 http 500 错误，如下所示“500 Internal Server Error”。如果我放回“RailsEnv 开发”这一行，该应用程序就可以正常工作。是否需要设置有关乘客的某些内容才能使生产正常工作？

我只需要测试我的新乘客安装是否可以在生产模式下工作。

下面是相关配置。[usertest@test-server web_app1]$ ruby​​ -v ruby​​ 1.9.3p327（2012-11-10 修订版 37606）

```
[usertest@test-server web_app1]$ which ruby
/usr/local/bin/ruby

[usertest@test-server web_app1]$ cat /etc/apache/conf.d/passenger.conf 
LoadModule passenger_module /usr/local/lib/ruby/gems/1.9.1/gems/passenger-   3.0.18/ext/apache2/mod_passenger.so
PassengerRoot /usr/local/lib/ruby/gems/1.9.1/gems/passenger-3.0.18
PassengerRuby /usr/local/bin/ruby

<VirtualHost *:80>
  ServerName siteexample.com 
 DocumentRoot  /var/www/mysites/apps/web_app1/public   
 RailsEnv development
<Directory /var/www/mysites/apps/web_app1/public>    
     AllowOverride all        
     Allow from all
     Options -MultiViews   
     Options FollowSymLinks
</Directory>
</VirtualHost> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-21T19:40:05.027

为了使用 Phusion Passenger 部署到生产服务器，您需要使用该`RailsEnv production`指令。

但是您还需要确保关联的 Rails 环境配置正确。这些文件存储在`apps/config/environments/`一个新的 Rails 项目中，带有 3 个：（`development`默认）`test`、 和`production`. 您可以添加其他人，例如`staging`通过将文件添加到此目录。

每个文件都有许多对环境有意义的设置。在开发过程中，您希望在浏览器中显示漂亮的详细日志记录、纯文本 CSS 和 JS 文件以及错误。在生产中，您希望一切都尽可能快：简洁的日志记录、编译的资产、用户友好的错误页面。

在您的情况下，Rails 使用的资产（尤其是所有 CSS 和 JS 文件）尚未由 Rails“资产管道”处理。预编译资产 ( `rake assets:precompile`) 有一个 rake 任务，这是默认`production`环境所期望的。默认的开发环境将 CoffeeScript 和 SASS 文件分别编译成 JS 和 CSS，否则只做最少的处理。

因此，作为部署到生产的一部分，您需要在任何时候添加或更改任何资产时运行此 rake 任务。因为每次部署时都需要这个和许多其他类似的细节，所以有一个很棒的 gem，叫做 Capistrano，大多数 Rails 应用程序都使用它来进行部署。可以肯定的是，这完全是另一种野兽，但是随着您在此过程中走得更远，您肯定会考虑它。即使是最小配置的 capistrano 脚本也会知道预编译资产并在完成后重新启动服务器等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T18:28:26.037

尝试设置`RailsEnv production`

重新启动 Apache，然后使用`touch /var/www/mysistes/apps/web_app1/tmp/restart.txt`

# jquery - jquery选项卡避免锚从外部链接跳转

> ID：13497489
> 
> 赞同：0
> 
> 时间：2012-11-21T16:19:09.087
> 
> 标签：jquery, url, tabs, anchor

我的页面上有一个 Jquery 选项卡，我想防止当访问者从包含 url (www.mypage.html#myanchor) 中的锚点的外部链接访问页面时，页面将跳转到实际的锚点。我只想选择标签而不是跳转。我还是 jquery 的新手，这是我用于构建选项卡的代码：

```
 <script>

    $(function() {

 $( "#tabs" ).tabs({

         select: function(event, ui) {

            // loading an iframe src on select
             if (ui.index==2){
             go('iframes/tendaggi_ignifughi.html');
             }
        }       

        });

});   

    </script> 
```

非常感谢任何关于我应该如何修改上面的代码以实现我需要的答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T16:33:19.013

试试这个代码：

```
if (location.hash) {           // do the test straight away
    window.scrollTo(0, 0);     // execute it straight away
    setTimeout(function() {
        window.scrollTo(0, 0); // run it a bit later also for browser compatibility
    }, 1);
} 
```

# c# - 替换 Switch-Case 以选择类属性并使用 LINQ 和反射 C# 进行过滤

> ID：13497491
> 
> 赞同：0
> 
> 时间：2012-11-21T16:18:12.827
> 
> 标签：c#, reflection, properties, switch-statement

我有一个`Product`具有几个属性的类：

```
public class Product
{
   public int id { get; set; }
   public string Name { get; set; }
   public string Category { get; set; }
   public string ProdCountry { get; set; }
} 
```

现在假设我有`var products = List<Product>`并且我想过滤一些我事先不知道的特定属性值。所有`{ propertyName, propertyValue }`对都必须匹配（所以 AND 关系）：

```
Dictionary<string, string> properties = GetPropertiesFromClient(); //Key = propertyName, Value = propertyValue

List<Product> products = GetProductList();

foreach(var property in properties)
{
   switch (property.Key)
   {
       case "Name": products = products.Where(p => p.Name == property.Value); 
                    break;

       case "Category": products = products.Where(p => p.Category == property.Value);
                        break;

       case "ProdCountry": products = products. Where(p => p.ProdCountry == property.Value);
                           break;
   }
} 
```

该方法`GetPropertiesFromClient()`总是返回一个`Dictionary<string, string>`我事先不知道存储了哪些属性和多少的地方。

有什么快捷方式可以避免我使用 a`switch case`吗？就像是：

```
foreach(var property in properties)
{
    products = products.Where(t => t.GetType().GetProperty(property.Key).GetValue(t, null) == property.Value);
} 
```

这段代码应该工作（逻辑上），但我得到一个例外：

> LINQ to Entities 无法识别方法 'System.Object GetValue(System.Object, System.Object[])' 方法，并且此方法无法转换为存储表达式。

我怎样才能实现我的目标？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T17:29:49.683

作为`property`一个对象，它试图将`get`访问器转换为 SQL。

尝试在本地执行 getter 并保存结构值。然后与局部变量而不是属性对象进行比较：

```
foreach(var property in properties)
{
   var x = property.Value;
   switch (property.Key)
   {
       case "Name": products = products.Where(p => p.Name == x); 
                    break;
       //...
    }
} 
```

# oracle - 根据参数设置 APEX 选择列表默认值

> ID：13497495
> 
> 赞同：4
> 
> 时间：2012-11-21T16:18:19.113
> 
> 标签：oracle, oracle-apex, selectlist

我有一个 Apex 页面，其中包含从 SQL 查询填充的选择列表项，该查询应默认为从另一个页面传递的项目的产品，但它始终选择列表中的第一项。

我们需要设置它以便它选择当前类别但是我看不到这个设置在哪里。APEX 的版本是 3.2。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-22T05:05:25.847

首先，我怀疑（如果我错了，请纠正我）您的项目正在选择第一个项目，因为该项目是用`Display Null Value`set定义的`No`；但是，在内部，该项目可能是`NULL`，但列表项无法显示它，因此它只显示第一个列表值。但我可能不会更改此设置。

要为 Select List 项设置默认值，请设置`Default Value Type`为`PL/SQL Function Body`，然后在该项的属性中输入您的 SQL 查询（返回单个值），并`Default`在其周围加上合适的 PL/SQL，例如：

```
DECLARE
  v_value VARCHAR2(<your data max length>);
BEGIN
  SELECT <yourcolumn>
  INTO v_value
  FROM <yourquery>;
  RETURN v_value;
END; 
```

# javascript - 在元素后插入仅打开的 HTML 标记？

> ID：13497499
> 
> 赞同：2
> 
> 时间：2012-11-21T16:18:26.553
> 
> 标签：javascript, jquery, html

我想在页面上的 H1 元素之后插入几个打开的 DIV 标记，而不插入相应的结束标记（因为结束标记包含在我无权访问的包含的页脚文件中）。

即现有代码：

```
<body>
<h1>Heading One</h1>
... page content...
</div>
</div>
</body> 
```

新代码：

```
<body>    
<h1>Heading One</h1>
<div id="foo">  
<div id="baa">  
... page content...
</div>
</div>
</body> 
```

DOM 方法将 div 作为完整（封闭）元素插入，“createTextNode”插入转义字符，“innerHTML”需要插入一个元素。甚至尝试在没有任何运气的情况下使用 document.write 插入脚本元素。

任何想法（jQuery 会很好）？

**更新** 以下工作：

```
document.body.innerHTML = document.body.innerHTML.replace('</h1>','</h1><div id="foo"><div id="baa">') 
```

*正如Asad*所指出的，解决方案（当然现在看起来很明显）是在 HTML 上使用字符串方法而不是 DOM 方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T16:23:51.680

如果您正在处理 DOM 操作，请使用 DOM 操作方法。如果您正在处理 HTML 操作，请使用字符串操作方法。

```
h1.parentElement.innerHTML = h1.parentElement.innerHTML.replace("<h1>Heading One</h1>","<h1>Heading One</h1><div><div>"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T16:21:48.403

忘记 DOM 方法，使用 .replace() 将其作为字符串插入。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T16:20:40.907

我认为这将回答您的问题，这完全是关于有效的 XML 格式。

[http://www.w3schools.com/xml/xml_syntax.asp](http://www.w3schools.com/xml/xml_syntax.asp)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T16:25:18.150

你的方法从根本上是错误的。浏览器解析它所看到的 DOM，并自动关闭任何应该关闭的标签。使用 JavaScript 只插入开始标记是不可能的。

您说“结束标签包含在我无权访问的包含的页脚文件中。” 没有打开的关闭标签会被忽略，因此就 DOM 解析器而言，这些关闭标签不存在。

您的解决方案是：

1.  将开始标签放在标题中，或服务器端的其他位置，或
2.  使用 JavaScript 抓取以下所有 DOM 元素，包括页脚，并将[`.wrap()`](http://api.jquery.com/wrap)它们全部放在所需的 div 中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-21T16:39:55.223

这种做法似乎有点不正统，但也许这样的做法会有所帮助。

现有的 HTML

```
<h1 id="testH1">Test H1</h1>
<div id="existingDiv">
    <div id="existingDivContent">Existing Div Content</div>
</div> 
```

新的 HTML

```
<h1 id="testH1">Test H1</h1>
<div id="newDiv">
    <div id="existingDiv">
        <div id="existingDivContent">Existing Div Content</div>
    </div>
</div> 
```

JS

javascript 是相当初级的，但我认为这个概念可以用来安全和正确地实现你的目标。

```
$(document).ready(function() {
    //-- parent node you wish to copy
    var existingDiv = $('#existingDiv');

    //-- new parent div node
    var newDiv = $('<div id="newDiv">');

    //-- where we want to insert the new parent node
    var testH1 = $('#testH1');

    //-- stuff our previous parent node into our new parent node
    newDiv.html(existingDiv);

    //-- insert into the DOM
    testH1.after(newDiv);

}); 
```

[http://jsfiddle.net/8qzvN/](http://jsfiddle.net/8qzvN/)

# ios - 检索文件创建或修改日期

> ID：13497500
> 
> 赞同：19
> 
> 时间：2012-11-21T16:19:30.967
> 
> 标签：ios, objective-c, xcode, last-modified, nsdocumentdirectory

我正在使用这段代码来尝试检索文件的最后修改日期：

```
NSError *error = nil;
NSDictionary *attributes = [[NSFileManager defaultManager] attributesOfItemAtPath: myFilePath error:&error];

        if (attributes != nil) {
            NSDate *date = (NSDate*)[attributes objectForKey: NSFileModificationDate];
            NSLog(@"Date modiifed: %@", [date description]);
        }
        else {
            NSLog(@"Not found");
        } 
```

这适用于主包中的文件，但如果文件位于应用程序文档文件夹的子目录中，则不适用，`myFilePath`如下所示：

```
/Users/User/Library/Application Support/iPhone Simulator/6.0/Applications/The App ID Number/Documents/mySubdirectory/My Saved File 
```

它不断返回“未找到”。

我知道该文件在那里，因为我可以使用 finder 来查看它。我也尝试删除文件名中的空格，但这没有效果。

错误日志说没有这样的文件或目录，所以当我试图将文件复制到文档目录时，它看起来一定出了问题。

奇怪的是，遍历文档子目录并`contentsOfDirectoryAtPath`显示文件存在。

我已经尝试对路径进行硬编码并以编程方式检索它，其中：

```
*myFolder = [documentsDirectory stringByAppendingPathComponent:@"myFolder"];
*myFilePath = [myFolder stringByAppendingPathComponent:theFileName]; 
```

谁能看到我哪里出错了？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2016-11-06T08:25:08.960

斯威夫特 3 解决方案：

```
func fileModificationDate(url: URL) -> Date? {
    do {
        let attr = try FileManager.default.attributesOfItem(atPath: url.path)
        return attr[FileAttributeKey.modificationDate] as? Date
    } catch {
        return nil
    }
} 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2012-11-22T16:28:19.783

尝试这个。我有同样的问题并解决了类似下一个：

```
NSURL *fileUrl = [NSURL fileURLWithPath:myFilePath];
NSDate *fileDate;
[fileUrl getResourceValue:&fileDate forKey:NSURLContentModificationDateKey error:&error];
if (!error)
{
//here you should be able to read valid date from fileDate variable
} 
```

希望它有所帮助；）

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2016-08-30T20:12:42.647

这是@zvjerka24答案的类似Swift的解决方案：

```
func lastModified(path: String) -> NSDate? {
    let fileUrl = NSURL(fileURLWithPath: path)
    var modified: AnyObject?
    do {
        try fileUrl.getResourceValue(&modified, forKey: NSURLContentModificationDateKey)
        return modified as? NSDate
    } catch let error as NSError {
        print("\(#function) Error: \(error)")
        return nil
    }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-02-04T19:31:13.440

如果您收到错误消息：

> *“CFURLCopyResourcePropertyForKey 失败，因为它通过了这个没有方案的 URL”*

您可以尝试通过在将其转换为 NSURL 之前将“file:///”附加到您的 NSString 文件路径来解决此问题，它适用于我的情况。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-12-21T04:24:25.363

还可以这样做：

```
NSURL* file = ...
NSError* error;`
NSDate *creationDate = [[NSFileManager defaultManager] attributesOfItemAtPath:file.path error:&error].fileCreationDate; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-02-25T07:52:49.660

对于 macOS 系统中的任何文件，我们可以使用以下任何选项轻松获取修改日期：

**方式一：**

*   NSString *path = @"文件路径";
*   NSError *err = nil;
*   NSDictionary *dic2 = [[NSFileManager defaultManager] attributesOfItemAtPath:path error:&err];
*   NSLog(@"文件修改日期：%@", dic2[NSFileModificationDate]);

**方式二：**

*   MDItemRef itemRef = MDItemCreate(kCFAllocatorDefault, (__bridge CFStringRef)path);
*   NSArray *attributeNames = (__bridge NSArray *)MDItemCopyAttributeNames(itemRef);
*   NSDictionary *attributes = (__bridge NSDictionary *) MDItemCopyAttributes(itemRef, (__bridge CFArrayRef) attributeNames);

*   CFDateRef modifDate = MDItemCopyAttribute(itemRef, kMDItemContentModificationDate);

*   NSDate* modifyDate = (__bridge NSDate*) modifDate;
*   NSLog(@"修改日期%@", modifyDate);

您还可以打印 MDItem 提供的各种其他属性： NSLog(@"All attributes%@", attributes);

# c# - 当我不应该登录时被提示登录

> ID：13497501
> 
> 赞同：3
> 
> 时间：2012-11-21T16:19:32.927
> 
> 标签：c#, asp.net-mvc-3, forms-authentication

当我尝试访问网页时，我收到以下消息：

> HTTP 错误 401.2 - 未经授权 由于身份验证标头无效，您无权查看此页面。

从这张图片可以看出：

![在此处输入图像描述](../Images/8c31f36e1d5ce147d33dd59f776c2e33.png)

考虑到我要从登录屏幕直接进入此页面并且没有收到提示，这很令人困惑。我也可以在没有提示的情况下访问该站点的任何其他部分。

这是我用来链接到此屏幕的代码：

```
@using SuburbanCustPortal.SuburbanService

<br />
<br />
<table>

  @if (ViewData["CustomerData"] != null) { 
    foreach (var usr in (IEnumerable<CustomerData>) ViewData["CustomerData"])
    {
      <tr>

        <td>
          <a href="/Customer/ShowCustomer/@usr.AccountId/">View</a>
        </td>

        <td>
          @usr.Branch-@usr.AccountNumber
        </td>

        <td>
          @usr.Name
        </td>

        <td>
          @usr.DeliveryStreet
        </td>

      </tr>
    }
  }

</table>
<br /> 
```

它与作为链接有关吗？如果是这样，我该如何解决这个问题？

**更新#1**

这是被调用的动作：

```
public ViewResult ShowCustomer(string id)
{
  var corpid = MiscClasses.TokenIdCookie.GetTokenIdCookie();
  var sb = new StringBuilder();
  sb.AppendLine("SuburbanCustPortal,Controllers.CustomerController.ExistingAccounts");
  sb.AppendLine(string.Format("corpid: {0}", corpid));
  sb.AppendLine(string.Format("accountid (id): {0}", id));
  Logging.LogInfo(sb.ToString(), _asName);

  var cr = new CustomerRequest();
  cr.CompanyId = corpid;
  cr.Account = id;

  return View("AccountScreen", _client.GetCustomerByGuid(cr));
} 
```

**更新#2**

我正在使用以下身份验证：

![在此处输入图像描述](../Images/b0686de5c2af5649c621b3b9524867f0.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T16:46:38.233

看来您的 IIS 要求您通过基本身份验证质询/响应进行身份验证。匿名访问被禁用，因此出现身份验证对话框。

启用**匿名身份验证**，您应该一切顺利。

应该启用的日常 Asp.net 应用程序（包括 MVC 应用程序）的常用身份验证方法是：

*   匿名和
*   形式

所有其他取决于您的应用程序的特定要求和/或环境（即域配置）。

# c# - 如何在 XNA + C# 中动态缩放精灵的大小？

> ID：13497502
> 
> 赞同：1
> 
> 时间：2012-11-21T16:18:31.643
> 
> 标签：c#, xna, collision-detection, sprite, 2d-games

我正在创建一个 2D 射击游戏，当某些敌人与射弹物体发生碰撞时，我想增加它的大小。我可以通过更改下面的浮点值来缩放代码中的精灵

```
enemyAnimation.Initialize(enemyTexture, Vector2.Zero, 47, 61, 8, 30, Color.White, **2f**, true); 
```

然后我可以将该浮点数更改为一个变量，并在发生碰撞时更新该变量。唯一的问题是，敌人规模确实会改变，但仅限于新生成的敌人和所有敌人。这很明显，但我想做的（如果可能的话）是改变发生碰撞的敌人的大小，只有那个敌人......

关于我如何去做这件事的任何想法？

编辑：

好吧，我有点困惑。我在 Enemy 类中创建了一个名为 scaleSize 的浮点值。然后在我的 Game1.cs 中的碰撞检测中，我正在运行一个 for 循环来遍历我的敌人对象列表

```
// Projectile vs Enemy Collision
            for (int i = 0; i < projectiles.Count; i++)
            {
                for (int j = 0; j < enemies.Count; j++)
                {
                    // Create the rectangles we need to determine if we collided with each other

                    // Determine if the two objects collided with each other
                    if (rectangle1.Intersects(rectangle2))
                    {

                        enemies[j].Health -= projectiles[i].Damage;
                        projectiles[i].Active = false;

                            *enemies[j].scaleSize += 1f;*
                    }
                }
            } 
```

现在我意识到 scaleSize 没有被正确初始化。但我不确定我应该在哪里改变它。与前面的代码示例一样，float 值正在改变敌人的比例，但通过 Animation 类，如果我改变它，它会改变所有敌人（afaik）。我很抱歉，因为我知道这很模糊，但我无法将头绕在我应该设置敌人比例大小的地方。创建它的敌人类很好，但它没有参考敌人的实际规模。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T16:23:03.540

将比例值存储在 Enemy 类中。这样，您的 Enemy 对象的每个实例都会有自己的比例值。

如果你没有 Enemy 类，你应该创建一个。您还可以存储enemyTexture，并让每个Enemy 都有自己的外观。

**编辑**

您很可能没有在 Draw 方法中使用正确的比例值。以 Enemy 类为例：

```
class Enemy
{       
   protected float Scale { get; set; }
   protected Texture2D Texture { get; set; }
   protected Vector2 Position { get; set; }

   public Enemy()
   { 
       Scale = 1f;
   }

   public void Hit()   
   {
       Scale = 2f;
   }

   public void Draw(SpriteBatch spriteBatch)
   {
        spriteBatch.Draw(Texture, Position, null, Color.White, 0, Vector2.Zero, Scale, SpriteEffects.None, 1);   
   }
} 
```

使用示例：

```
Enemy A = new Enemy();      
A.Hit();    
A.Draw(spriteBatch); 
```

# android - 按下按钮并更改文本视图颜色

> ID：13497505
> 
> 赞同：0
> 
> 时间：2012-11-21T16:19:51.113
> 
> 标签：android, listview, colors, textview, selector

谁能看到我的代码有什么问题:(我什至无法创建一个简单的应用程序，它一直在崩溃。

该应用程序要做的是，当用户按下按钮时，textview 会将颜色更改为 RED。

```
public class MainActivity extends Activity {

public TextView tv1;
public Button bt1;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    bt1 = (Button)findViewById(R.id.button1);
    tv1 = (Button)findViewById(R.id.textView1);

    bt1.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub
            tv1.setTextColor(Color.BLACK);
        }
    });

}

<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
tools:context=".MainActivity" >

<Button
    android:id="@+id/button1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_alignParentTop="true"
    android:text="Button" />

<TextView
    android:id="@+id/textView1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBottom="@+id/button1"
    android:layout_toRightOf="@+id/button1"
    android:text="TextView" /> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-21T16:21:27.653

```
tv1 = (Button)findViewById(R.id.textView1); 
```

用。。。来代替

```
tv1 = (TextView)findViewById(R.id.textView1); 
```

# git - 在 ConEMU 中显示 git 分支

> ID：13497508
> 
> 赞同：12
> 
> 时间：2012-11-21T16:19:07.067
> 
> 标签：git, conemu

有没有办法在 ConEmu 的某个地方（背景或类似）显示 git 中的分支？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2014-01-22T20:36:20.330

Git 分支可以在纯 cmd 或 Far Manager 提示符下可见。

![cmd 提示符下的 GIT 分支](../Images/a6417d9f5f7992088b662db75a5623b4.png)

所有魔法都是通过特殊的 ANSI 序列完成的（必须选中“Inject ConEmuHk”和“ANSI X3.64 ...”选项）。我运行`GitShowBranch /i`安装显示分支，`GitShowBranch /u`卸载。

此外，您可以按以下方式运行您的 cmd（在任务内容或 ConEmu 的命令行中）

```
cmd /k ver & GitShowBranch /i 
```

PS。文件`GitShowBranch`存在于 ConEmu 的发行版中，但您可能会在[网上](https://github.com/Maximus5/ConEmu/blob/daily/Release/ConEmu/GitShowBranch.cmd)看到它。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2018-04-18T07:34:17.600

在 Settings -> Startup 中更改为`specified named task`，`{Bash::Git}`您将显示分支名称。

![设置截图](../Images/1e06658f67a4f985dd7ddb78495ce8bb.png)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2014-10-15T07:59:12.207

是的，有办法。安装[git bash](http://www.git-scm.com/downloads)，然后在 ConEmu 设置中，在“ComSpec”部分下将 Explicit 可执行文件设置为`"C:\Program Files (x86)\Git\bin\sh.exe" --login -i`.

这将运行一个 bash shell 会话，并为您提供一个完全可调整大小的窗口，其中包含 git 选项卡完成和当前工作分支提示。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-21T19:30:28.687

> 免责声明#1
> 
> ConEmu 不是外壳，因此它不提供“外壳功能”，如制表符补全、命令历史记录等。

通常，分支或更改量等 Git 信息会显示在命令行提示符中，例如`C:\path\to\repository [branch|+2~4-6]>`. 这是由执行外壳完成的，而不是控制台框架。

据我所知，标准的 Windows 命令提示符 (CMD) 不支持修改它。[不过，Windows 版 Git](http://msysgit.github.com/)附带的 bash已经完美地支持了这一点。对于 PowerShell，Git 有许多扩展，最著名的是[posh-git](https://github.com/dahlbyk/posh-git)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-03-16T10:02:18.290

总结一下情况就是：

[![显示分支名称](../Images/0b3c5779ffa240aefb7ecfa320b9dd8f.png)](https://i.stack.imgur.com/sWFD0.png)

我知道`sh.exe`可以做到这一点，但需要检查它是否在`Git\bin`文件夹中，并且只能通过`sh`在命令行中写入来访问。

首先我`sh.exe`在`Git\bin`文件夹中看到，但想看看我是否可以在命令行上执行。为了查看它，我检查了使用 by 的环境变量`echo %path%` 。查看是否存在很复杂。我使用了powershell脚本并且有:)

我也会在命令行中执行 sh :)))

*参考文献：*

*   电源外壳[在哪里](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/where-object?view=powershell-5.1#examples)
*   [拆分](https://stackoverflow.com/questions/11348506/split-string-with-powershell-and-do-something-with-each-token)环境变量（[路径](https://stackoverflow.com/questions/5114985/echo-path-on-separate-lines)）

*代码：*

```
echo %path%
($env:Path).split(";") | where ({$_ -like "*Git*"}) 
```

# powershell - 通过 Powershell 取回 TIME 信息

> ID：13497514
> 
> 赞同：2
> 
> 时间：2012-11-21T16:19:29.967
> 
> 标签：powershell, powershell-2.0

我有以下代码查看操作系统系统并根据构建类型返回它们指向的 NTP 服务器。

但是，它在匹配 7601 (Windows Server 2008 R2) 时运行良好 - 但是，对于 Windows Server 2003 服务器，我总是会收到错误消息。对于 Windows Server 2003 服务器，您需要读取注册表项。

如果我在服务器上本地对注册表项进行相同的查询，它可以正常工作...尽管它会报告其他内容以及注册表项..

这是错误：

```
NTPSource                                                   Server
---------                                                   ------
The following error occurred: The procedure number is ou... SERV1 
```

这是代码：

```
$servers = @('SERV1','SERV2')
$version = Get-WmiObject Win32_OperatingSystem -computer $servers | select buildnumber

foreach ($server in $servers){

    if ($version -match '7601')
    {
    $ntps = w32tm /query /computer:$server /source
    new-object psobject -property @{
    Server = $Server
    NTPSource = $ntps
    }
    }
elseif($version -match '3790')
{

    Get-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Services\W32Time\Parameters' -Name Type

}   
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T16:33:48.393

我个人使用它来检索 NTP 服务器（Windows Server 2000/2003/2008/2008r2）：

```
$Servers = (gc Computers.txt) # list of servers name
$pw = Get-Credential 
$HKLM = 2147483650
foreach( $Server in $Servers )
{
$reg = GWMI -list -namespace root\default -computername $server -Credential $pw | 
       where-object { $_.name -eq "StdRegProv" }
$key = $reg.GetStringValue($HKLM,"SYSTEM\CurrentControlSet\Services\W32Time\Parameters","NtpServer")

write-host "$server `t$($key.svalue)"

} 
```

# android - 浏览器应用程序的 GCM 密钥（带有引用者）状态为非活动状态

> ID：13497515
> 
> 赞同：10
> 
> 时间：2012-11-21T16:20:34.853
> 
> 标签：android, status, google-cloud-messaging

我开发了一个从 Web 服务器接收通知的 Android 应用程序。我正在使用 GCM（谷歌云消息传递）。一切正常，我几乎可以立即收到通知。然后它停止工作。当我进入我的项目的 Google API 控制台时，我意识到“浏览器应用程序的密钥（带有引用者）”下的 API 密钥现在显示在过时的密钥下，并且有一个新的 API 密钥。状态设置为非活动。

我将我的项目中的 API 密钥更新为新的，现在我可以接收到我的应用程序的通知。似乎问题已经解决（尽管状态仍然处于非活动状态），但我想知道为什么会首先发生这种情况，我需要防止它再次发生。

如果有人可以帮助我，我将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-30T11:19:36.350

这是因为 Google 会定期更新其 API 并弃用旧的 API。

# python - HTML 压缩对性能有影响吗？

> ID：13497518
> 
> 赞同：0
> 
> 时间：2012-11-21T16:19:37.410
> 
> 标签：python, html, web, jinja2

[https://github.com/mitsuhiko/jinja2-htmlcompress](https://github.com/mitsuhiko/jinja2-htmlcompress)

-- jinja2-htmlcompress

```
a Jinja2 extension that removes whitespace between HTML tags. 
```

html压缩真的值得吗？它使源看起来很难看。但是，它对性能有帮助吗？如果有，对性能有多大帮助，用户是否注意到它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T16:23:01.480

我怀疑对于大多数 HTML 来说，多余的空白是否真的值得。如果我有那么担心，我会尽可能确保将我的前端网络服务器设置为 gzip 页面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T19:26:09.317

缩小 html 还有其他原因。例如，我必须这样做，因为我正在发送一封 html 电子邮件，而一些客户（如 gmail）只是在某个时间点后切断了消息。

因此，在这种情况下，减小生成的 html 的大小会增加用户在电子邮件客户端中实际看到的信息量。而且我认为他们不支持压缩内容。

我正在使用 htmlmin 库：[https ://github.com/mankyd/htmlmin](https://github.com/mankyd/htmlmin)

还有一个 Django 的前端：[https ://github.com/cobrateam/django-htmlmin](https://github.com/cobrateam/django-htmlmin)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T16:23:55.960

> 它使源看起来很难看

这一点都不重要。您不会在开发过程中运行压缩器。您将在未压缩的文件上进行开发，并将压缩器作为构建过程的一部分运行（就像您对 JavaScript 缩小所做的那样）。

> 但是，它对性能有帮助吗？如果有，对性能有多大帮助，用户是否注意到它？

是的，它有助于提高性能，因为它减小了必须由浏览器下载的文件的大小。实际保存显然取决于文件的原始大小，但在现代连接上，差异不太可能是明显的。不过，它肯定仍然是有益的，特别是对于针对移动设备优化的页面。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T16:27:40.893

至少在**使用 gzip 压缩**的情况下，节省的空格是微不足道的。

在某些情况下，它可能会使解析和 DOM 更快：您不仅可以保存空格的字节，而且这些可能会在解析中显示为额外的“文本”节点。

但是，我非常相信**对于许多用户来说，它的主要用途是在某种程度上混淆您的源代码**。这没有多大意义，因为每个人都应该知道他的工具如何重新格式化 HTML 以使其再次可读。

# android - 如何将模拟位置从junit测试传递到Android中的Activity

> ID：13497520
> 
> 赞同：2
> 
> 时间：2012-11-21T16:20:39.250
> 
> 标签：android, junit

我有一个在 textView 中打印位置变化的活动。我想用 JUnit 测试它。这是我的代码，这是我的输出：

```
public void testGPS() {
        {
            LocationManager lm = (LocationManager) myActivity
                    .getSystemService(Context.LOCATION_SERVICE);
            String testProvider = "Test";

            if (null == lm.getProvider(testProvider)) {
                lm.addTestProvider(testProvider, false, false, false, false,
                        false, false, false, Criteria.POWER_LOW,
                        Criteria.ACCURACY_FINE);
            }

            lm.setTestProviderEnabled(testProvider, true);
            lm.requestLocationUpdates(testProvider, 0, 0,
                    myActivity.mLocListener);
            lm.setTestProviderStatus(testProvider, LocationProvider.AVAILABLE,
                    null, System.currentTimeMillis());

            // getService().setUpProvider(testProvider,lm)

            Location location = new Location(testProvider);
            location.setLatitude(1.0);
            location.setLongitude(2.0);
            location.setTime(System.currentTimeMillis());
            lm.setTestProviderLocation(testProvider, location);

            String test_rs = "lon=" + location.getLongitude() + "\nlat="
                    + location.getLatitude();
            String msg = "Location Succeeded";
            // Assert.assertFalse("Received Location is null", received == null
            // );
            assertEquals(msg, myActivity.mTextLocation.getText().toString(),
                    test_rs);

            lm.removeTestProvider(testProvider);
        } 
```

跟踪是：

```
junit.framework.ComparisonFailure: Location Succeeded expected:<Unknown> but was:<lon=2.0
lat=1.0>
at mypackage.TestActivity.testGPS(TestActivity.java:73)
at java.lang.reflect.Method.invokeNative(Native Method)
at android.test.InstrumentationTestCase.runMethod(InstrumentationTestCase.java:204)
at android.test.InstrumentationTestCase.runTest(InstrumentationTestCase.java:194)
at android.test.ActivityInstrumentationTestCase2.runTest(ActivityInstrumentationTestCase2.java:186)
at android.test.AndroidTestRunner.runTest(AndroidTestRunner.java:169)
at android.test.AndroidTestRunner.runTest(AndroidTestRunner.java:154)
at android.test.InstrumentationTestRunner.onStart(InstrumentationTestRunner.java:529)
at android.app.Instrumentation$InstrumentationThread.run(Instrumentation.java:1448) 
```

所以你可以在这里看到：

```
junit.framework.ComparisonFailure: Location Succeeded expected:<Unknown> but was:<lon=2.0 lat=1.0>. 
```

所以就像 myMain Activity 没有从我的测试中获取位置。

有什么帮助吗？

编辑： myActivity 是我要测试的活动。第 73 行是断言。我只想通过测试将位置传递给活动。怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-04-27T13:05:10.680

我已经设法让它发挥作用，至少对我来说是这样。

线索在这里：[https ://developer.android.com/training/location/location-testing.html](https://developer.android.com/training/location/location-testing.html)

> ...您不必在发布之前禁用或删除测试代码。

... 和 ...

> 始终将提供程序值设置为 flp，这是位置服务放入它发出的位置对象中的代码。

我还发现有必要给更新时间提供交付。

所以，这就是我最终得到的结果：

```
public void testGPS() {
    LocationManager lm = (LocationManager) mActivity
        .getSystemService(Context.LOCATION_SERVICE);

    lm.setTestProviderEnabled(LocationManager.GPS_PROVIDER, true);
    lm.setTestProviderStatus(LocationManager.GPS_PROVIDER, 
                             LocationProvider.AVAILABLE,
                             null, System.currentTimeMillis());

    Location location = new Location(LocationManager.GPS_PROVIDER);
    location.setLatitude(1.0);
    location.setLongitude(2.0);
    location.setTime(System.currentTimeMillis());
    lm.setTestProviderLocation(LocationManager.GPS_PROVIDER, location);

    try {
        Thread.sleep(2000);
    } catch(InterruptedException e) {
    }
} 
```

# linq - 列表中的 c# Lambda 查询，其中包含用于映射的列表

> ID：13497522
> 
> 赞同：2
> 
> 时间：2012-11-21T16:19:44.117
> 
> 标签：linq, lambda

今天我像这样将我的对象映射到 DTO。

```
public IEnumerable<ArticleDTO> GetArticlesBasedOnCategorySection(int catSection, int headCategoryID, string customerREFID)
{
    return _articleRepository.GetArticlesByCategory(catSection, headCategoryID, customerREFID).Select(a => Mapper.ToDTO(a)).ToList();
} 
```

但是在变量内部，我有另一个列表，我想以类似的方式进行映射。是否可以像这样在一行中编写所有这些，或者我必须编写一个`foreach`循环然后映射 a.List。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T17:06:54.340

在匿名对象中返回文章及其项目怎么样？

```
public IEnumerable<ArticleDTO> GetArticlesBasedOnCategorySection(int catSection, int headCategoryID, string customerREFID)
{
    return _articleRepository
        .GetArticlesByCategory(catSection, headCategoryID, customerREFID)
        .Select(a => new 
                     { 
                         Article = Mapper.ToDTO(a),
                         Items = a.Items.Select(b => Mapper.ToDTO(b)).ToList()
                     })
        .ToList();            
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T18:41:52.993

一种方法是使用具有多个语句的 lambda。我不确定这是否可以被视为单行，并且多语句 lambda 不是很 LINQ-y。

```
public IEnumerable<ArticleDTO> GetArticlesBasedOnCategorySection(int catSection, int headCategoryID, string customerREFID)
{
    return _articleRepository
        .GetArticlesByCategory(catSection, headCategoryID, customerREFID)
        .Select(a =>
                {
                    ArticleDTO article = Mapper.ToDTO(a);
                    article.Items = a.Items.Select(b => Mapper.ToDTO(b)).ToList();
                    return article;
                })
        .ToList();
} 
```

如果 ArticleDTO 有一个复制构造函数，你可以这样写：

```
public IEnumerable<ArticleDTO> GetArticlesBasedOnCategorySection(int catSection, int headCategoryID, string customerREFID)
{
    return _articleRepository
        .GetArticlesByCategory(catSection, headCategoryID, customerREFID)
        .Select(a => new ArticleDTO(Mapper.ToDTO(a))
                     {
                         Items = a.Items.Select(b => Mapper.ToDTO(b)).ToList()
                     })
        .ToList();
} 
```

您还可以将项目映射到构造函数或`Mapper.ToDTO(a)`.

# tsql - 临时表中具有相同日期的不同执行计划

> ID：13497523
> 
> 赞同：0
> 
> 时间：2012-11-21T16:20:44.460
> 
> 标签：tsql, sql-server-2012, temp-tables

基本上，我有一个临时表，我使用不同的技术用相同的数据填充表，以便在我的情况下找到最快的一个。这三种方法是：

1.  使用连接选择插入的信息
2.  选择插入的信息，其中大部分表格/逻辑/计算都包含在内联函数中
3.  选择插入的信息，其中大多数表/逻辑/计算都包含在表值函数中

使用每种方法，表格都填充了相同的数据，并且我使用表格值函数获得了最佳性能。但是这里的事情变得奇怪了。

填充临时表后，对其进行简单的 SELECT，并在所有列上使用 GROUP BY 和 ORDER BY。因为数据是相同的，所以我期望相同的执行计划，但我得到了这个：

![在此处输入图像描述](../Images/07df19d94243be0f4d6d5c640c5e1e4e.png)

其中第一行是表值函数的执行计划，第二行是第一种和第二种方法的执行计划。

为什么我对具有相同数据的表有两个不同的执行计划？为什么不总是使用第一个，因为它比第二个更快？

请注意，由于这与排序和分组的数据有关，我假设当我使用表值函数时，日期可能已经排序，但简单选择结果显示数据在每个中都以相同的方式排序案子。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T16:34:53.560

执行计划不仅仅是数据

看看[只有在数据库中，您才能通过更改几行代码获得 1000% + 改进](http://blogs.lessthandot.com/index.php/DataMgmt/DataDesign/only-in-a-database-can-you-get-1000-impr)

这样的事情不是这样的`SARGAble` ，将创建一个次优计划

```
where year(payment_dt) = year(getDate())
and month(payment_dt) = month(getDate()) 
```

优化器将为

```
where payment_dt >= dateadd(mm, datediff(mm, 0, getdate())+0, 0)
and payment_dt < dateadd(mm, datediff(mm, 0, getdate())+1, 0) 
```

这两个将返回相同的行，一个将使用查找，另一个将使用扫描，因为在列周围使用了函数

# scala - scala => javafx 弹出窗口

> ID：13497524
> 
> 赞同：3
> 
> 时间：2012-11-21T16:20:49.133
> 
> 标签：scala

我想用 javafx 在 scala 中创建一个弹出窗口

```
final val popup = new Popup  
val text: Text = new Text(s)
popup.setAutoFix(false)
popup.setHideOnEscape(true)
popup.getContent().addAll(text)
popup.setX(250)
popup.setY(175)
popup.show(stage) 
```

但我有一个错误

```
org.view.View@72d873: caught java.lang.IllegalStateException: Not on FX application thread; currentThread = ForkJoinPool-1-worker-1
java.lang.IllegalStateException: Not on FX application thread; currentThread = ForkJoinPool-1-worker-1 
```

有人有想法吗？

感谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T17:00:32.627

如错误所示，您可能应该`show`在 FX 应用程序线程上调用该方法。

这是因为修改 UI 的代码必须在特定的 UI 线程上执行（Swing 和其他 GUI 框架也是如此），以防止并发更新并保证 UI 组件的一致性。

通常这些修改已经在正确的线程上进行，该线程为 UI 事件侦听器执行回调代码，但是如果您需要从另一个线程访问 UI，您必须在 FX 应用程序线程上调用

[javafx.application.Platform.runLater(Runnable r)](http://docs.oracle.com/javafx/2/api/javafx/application/Platform.html#runLater%28java.lang.Runnable%29)

如在

```
runLater (new Runnable() {
    def run = popup.show(stage)
}) 
```

# php - PHP - 安全地存储外部服务的密码？

> ID：13497527
> 
> 赞同：7
> 
> 时间：2012-11-21T16:20:52.413
> 
> 标签：php, mysql, database, security, passwords

我目前正在计划开发一个 PHP 应用程序，该应用程序需要存储外部服务的用户密码，以便在用户登录我的应用程序时可以同时登录。

我需要以安全的方式存储密码，即不是纯文本，也不是 base64 编码，但应用程序也需要以一种或另一种方式以纯文本形式访问密码。

我只能想到以下内容：

当用户将外部服务的凭据添加到他们的帐户时，他们会为我的应用程序重新输入密码，并且该密码（以加密形式）用于以某种方式“加密”外部服务的密码，但以某种方式使它仍然可以访问。

有没有人对这是否可能或潜在的解决方案有任何想法？

谢谢

**另外**：值得注意的是，发送数据将是一个 SSL 连接。

**出于好奇**：比如说；Google Mail，您可以将电子邮件帐户添加到您的 Google Mail 帐户，以便检查所有这些帐户。有人对 Google 如何存储您添加的帐户的密码有任何想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-21T16:24:20.973

一般来说，这个问题是，如果你的系统都受到攻击，攻击者可以获得所有系统的所有密码，因为它们是加密的而不是散列的。没有办法解决这个问题，因为您希望能够获得纯文本密码。

如果你必须这样做，你可以使用像 OpenSSL 这样受信任的东西来加密密码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-21T16:28:56.867

从证券的角度来看，你真的不应该在任何地方存储密码。我会让用户输入他们的密码 md5 他们的密码并存储它。因此，当他验证其已验证与 md5 时。至于外在。您可以获取外部密码并将外部密码与存储的 md5 进行异或。这样您就可以撤消它以将其传递给外部源。或者更好的方法是每次都询问外部密码。这是风险与便利的选择。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T16:32:27.450

GAH ...我希望每个人都对键进行标准化：

```
<?php
$connection = ssh2_connect('shell.example.com', 22, array('hostkey'=>'ssh-rsa'));

$sth = $dbh->prepare('select keyLoc from auth where username = :user');
$sth->bind_param('user', 'username');
$key = $sth->fetch(PDO::FETCH_ASSOC);

if (ssh2_auth_pubkey_file($connection, 'username',
                      $key,
                      '/home/username/.ssh/id_rsa', 'secret')) {
  echo "Public Key Authentication Successful\n";
} else {
  die('Public Key Authentication Failed');
} 
?> 
```

它会让生活变得容易得多。只需将您的公钥复制到任何地方，并将您的私钥保存在您身上。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-21T16:26:42.387

好吧，您可以使用用户自己的密码加密密码（而不是将其存储在任何地方），并且每次进行通信时都询问它，这样密码可能是安全的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-21T16:36:11.660

相反，您应该做的是使用 Oauth - 如果正确实施，它会更安全且对用户更友好。

[Zend oauht 客户端](http://framework.zend.com/manual/1.12/en/zend.oauth.introduction.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-21T19:42:50.143

您可能会使用[PKIF](http://pkif.sourceforge.net/)（特别是[PKIFCRYPTO](http://pkif.sourceforge.net/pkif-docs/docs/Subsystems/CryptographyPKIFCRYPTO.html)）和[NSS](http://www.mozilla.org/projects/security/pki/nss/)或[MS-CAPI](http://en.wikipedia.org/wiki/Microsoft_CryptoAPI)之类的东西。这不适合胆小的人，但您需要向决定以他们的凭据信任您的用户展示一定程度的能力。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-21T16:27:55.143

您可以使用 php mcrypt，请[在​​此处](https://stackoverflow.com/questions/1289061/best-way-to-use-php-to-encrypt-and-decrypt)查看相关问题。或者，如果您更喜欢加密/解密服务器端 mySQL 具有 AES 加密功能。

# spring - 如何在 JSF 管理的 bean 中使用 Spring 服务？

> ID：13497528
> 
> 赞同：1
> 
> 时间：2012-11-21T16:19:56.070
> 
> 标签：spring, jsf, service, managed-bean, serializable

JSF 是 Java 世界中非常流行的技术，然而，与 Spring 的合作仍然很痛苦，并且需要“讨厌”的 hack。我目前遇到这种“黑客”之一的问题。

Spring 服务是使用`SpringBeanFacesELResolver`. 它配置在`faces-config.xml`：

```
<application>
    <el-resolver>
        org.springframework.web.jsf.el.SpringBeanFacesELResolver
    </el-resolver>
</application> 
```

Spring服务的注入非常丑陋，但它正在工作：

```
@ManagedProperty(value="#{customerService}")
CustomerService customerService; 
```

但也有问题。JSF 要求我托管的 bean 应该是可序列化的。这意味着，Spring 服务也必须是可序列化的，或者该字段应该是瞬态的。当字段是瞬态时，注入不起作用（我在该字段中有 null）。在我看来，让 Spring 服务可序列化不是一个好主意，而且是一个潜在的性能问题——Hibernate 上下文、数据源应该如何处理，这些都被注入到 Spring 服务中？

那么，将 Spring 服务与 JSF 托管 bean 一起使用的正确且不那么痛苦的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-08-12T01:03:34.803

我也遇到了很多关于 org.springframework.web.jsf.el.SpringBeanFacesELResolver 的问题。主要与不匹配的对象范围有关（Spring 没有等效于 JSF 的视图范围和会话范围）。有些人还抱怨序列化问题。

我成功应用了本文提出的解决方案：[http](http://www.beyondjava.net/blog/integrate-jsf-2-spring-3-nicely/) ://www.beyondjava.net/blog/integrate-jsf-2-spring-3-nicely/ 。

就我而言，序列化不是问题，我只关心 bean 范围。我希望 JSF 能够完全管理支持 bean 的生命周期，而不会干扰 Spring bean 的生命周期。

我让 JSF 托管 bean 加载 Spring 上下文并自动装配它们自己以从 JSF 上下文访问 Spring 托管 bean。

我开发了以下 JSF bean 超类：

```
public abstract class AutowireableManagedBean {

    protected AutowireCapableBeanFactory ctx;

    @PostConstruct
    protected void init() {
        logger.debug("init");
        ctx = WebApplicationContextUtils
                .getWebApplicationContext(
                        (ServletContext) FacesContext.getCurrentInstance()
                                .getExternalContext().getContext())
                .getAutowireCapableBeanFactory();
        // The following line does the magic
        ctx.autowireBean(this);
    }
   ...
} 
```

然后，我的具体 JSF 支持 bean 看起来像这样（我能够毫无问题地使用视图范围）：

```
@ManagedBean
@ViewScoped
public class MyBackingBean extends AutowireableManagedBean {

    @Autowired
    private MyDao myDao; 
```

# c# - 列出实体框架中外键指向的实体

> ID：13497532
> 
> 赞同：5
> 
> 时间：2012-11-21T16:21:22.590
> 
> 标签：c#, database, performance, entity-framework

我有两个实体，比如说汽车和照片。每张照片都有 Car 的外键，所以每辆车都有自己的照片集。

我想列出一些汽车的子集，对于每辆列出的汽车，我想列出所有的每张照片。

如何在具有 1 db 查询的实体框架中执行此操作？我从一开始就知道我需要照片。

我现在的代码如下所示：

```
var carList = CarEntities.Where(...).ToList();
foreach(var car in carList){
    var photoList = car.Photos.ToList();
} 
```

我认为，EF 会为每辆车单独进行数据库查询。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-21T16:28:47.413

您可以在查询汽车时告诉实体框架包含照片。

```
var carList = CarEntities.Include(c => c.Photos).Where(...).ToList(); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-21T16:30:48.847

ckal 的答案非常接近，除了最后使用 include 否则 EF 可能并不总是包含它（目前无法回忆确切的原因），

```
var carList = CarEntities.Where(...).Include(c => c.Photos).ToList(); 
```

编辑：这就是原因......[实体框架包含（）不起作用](https://stackoverflow.com/questions/4474951/entity-framework-include-is-not-working)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T16:27:13.733

“选择新”是您可能想要做的。创建一个名为的新类`CarWithPhotos`并使用它返回一组结果：

```
var carWithPhotos = from car in CarEntities
                    where (...) 
                    select new CarWithPhotos(car, car.Photos.ToList()); 
```

据我了解，这编译为一个单一的数据库之旅，我认为这就是你所追求的。

**编辑：** 当我查询的对象很大并且我并不总是想检索整个“汽车”对象时，我使用了这种技术。

# java - 如何显示文件中的特定数据

> ID：13497535
> 
> 赞同：1
> 
> 时间：2012-11-21T16:20:29.920
> 
> 标签：java, bufferedreader

我的程序应该向用户询问名字、姓氏和电话号码，直到用户停止。然后何时显示它询问名字并在文本文件中进行搜索以查找具有相同名字的所有信息并显示匹配的姓氏和电话。

```
import java.util.*;
import java.io.*;
import java.util.Scanner;
public class WritePhoneList
{
public static void main(String[] args)throws IOException
{

  BufferedWriter output = new BufferedWriter(new FileWriter(new File(
                                        "PhoneFile.txt"), true));

String name, lname, age;
int pos,choice;

try
{

do
{
Scanner input = new Scanner(System.in);
System.out.print("Enter First name, last name, and phone number ");
name = input.nextLine();

output.write(name);
output.newLine();

System.out.print("Would you like to add another? yes(1)/no(2)");
choice = input.nextInt();
}while(choice == 1);
output.close();
}
catch(Exception e)
{
System.out.println("Message: " + e);
}
}
} 
```

这是显示代码，当我搜索名称时，它会找到匹配项，但会显示同名的姓氏和电话号码 3 次，我希望它显示与名字的所有可能匹配项。

```
import java.util.*;
import java.io.*;
import java.util.Scanner;
public class DisplaySelectedNumbers
{
public static void main(String[] args)throws IOException
{

String name;
String strLine;
try
{
FileInputStream fstream = new FileInputStream("PhoneFile.txt");
        // Get the object of DataInputStream
        DataInputStream in = new DataInputStream(fstream);
        BufferedReader br = new BufferedReader(new InputStreamReader(in));
          Scanner input = new Scanner(System.in);
          System.out.print("Enter a first name");
          name = input.nextLine();

        strLine= br.readLine();
        String[] line = strLine.split(" ");
        String part1 = line[0]; 
        String part2 = line[1];
        String part3 = line[2];

        //Read File Line By Line
        while ((strLine= br.readLine()) != null)    
    {

        if(name.equals(part1)) 
        {

        // Print the content on the console
System.out.print("\n" + part2 + " " + part3);
}   
}
}catch (Exception e)
{//Catch exception if any
            System.out.println("Error: " + e.getMessage());
}

}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T16:48:12.963

你需要分割你的行并将你的部分设置在while循环中：

```
 FileInputStream fstream = new FileInputStream("PhoneFile.txt");
    // Get the object of DataInputStream
    DataInputStream in = new DataInputStream(fstream);
    BufferedReader br = new BufferedReader(new InputStreamReader(in));
    Scanner input = new Scanner(System.in);
    System.out.print("Enter a first name");
    name = input.nextLine();

    String[] line;
    String part1, part2, part3;

    //Read File Line By Line
    while ((strLine= br.readLine()) != null)    
    {
        line = strLine.split(" ");
        part1 = line[0]; 
        part2 = line[1];
        part3 = line[2];

        if(name.equals(part1)) 
        {
            System.out.print("\n" + part2 + " " + part3);
        }

    } 
```

# nexus - 在 Nexus 2.1.1 中显示工件元数据选项卡？

> ID：13497538
> 
> 赞同：0
> 
> 时间：2012-11-21T16:20:38.540
> 
> 标签：nexus

在浏览 Sonatype Nexus 专业版 2.1.1 版时，我希望能够看到工件元数据。

阅读[http://www.sonatype.com/books/nexus-book/reference/_editing_artifact_metadata.html](http://www.sonatype.com/books/nexus-book/reference/_editing_artifact_metadata.html) 图片显示应该有一个右侧面板显示工件元数据选项卡。

配置中是否需要一些东西来显示它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T18:17:32.523

如图[5.7 所示](http://www.sonatype.com/books/nexus-book/reference/using-sect-browsing.html#fig-using-dependencies)，您必须在树视图中选择一个工件（例如 jar 文件）才能显示右侧窗格。

元数据窗格由 nexus-custom-metadata-plugin 提供。当前的 Nexus Pro 发行版将其作为可选插件包含在内。有关如何安装可选插件的信息，请参阅[安装附加插件。](http://www.sonatype.com/books/nexus-book/reference/install-additional-plugins.html)

# android - Android + 应用内计费 + Proguard

> ID：13497539
> 
> 赞同：0
> 
> 时间：2012-11-21T16:20:39.050
> 
> 标签：android, proguard, in-app

我已经使用应用内计费创建了应用程序，现在我想混淆我的代码以缩短破解它的机会。但是proguard设置存在一些问题。我正在尝试通过[本教程](http://android-developers.blogspot.com/2010/09/proguard-android-and-licensing-server.html)进行设置。我的项目结构很常见，主项目引用了其他具有所有功能的应用内服务的项目。我已经停止了执行带有代码混淆的 ant 发布的最后一步。我一直收到：

```
Buildfile: /home/viktor/Desktop/Dropbox/work/MyProject/build.xml

-set-mode-check:

-set-release-mode:

-release-obfuscation-check:
     [echo] proguard.config is /home/viktor/android-sdk-linux/tools/proguard/proguard-android.txt:proguard-project.txt
     [echo] Proguard.config is enabled

-check-env:
 [checkenv] Android SDK Tools Revision 21
 [checkenv] Installed at /home/viktor/android-sdk-linux

-setup:
     [echo] Project Name: MyProject
  [gettype] Project Type: Application

-build-setup:
     [echo] Resolving Build Target for MyProject...
[gettarget] Project Target:   Google APIs
[gettarget] Vendor:           Google Inc.
[gettarget] Platform Version: 4.1.2
[gettarget] API level:        16
     [echo] ----------
     [echo] Creating output directories if needed...
     [echo] ----------
     [echo] Resolving Dependencies for MyProject...
[dependency] Library dependencies:
[dependency] 
[dependency] ------------------
[dependency] Ordered libraries:
     [echo] ----------
     [echo] Building Libraries with 'release'...

nodeps:

-set-mode-check:

-set-release-mode:

-release-obfuscation-check:
     [echo] proguard.config is ${proguard.config}

-check-env:
 [checkenv] Android SDK Tools Revision 21
 [checkenv] Installed at /home/viktor/android-sdk-linux

-setup:
     [echo] Project Name: AndroidBillingLibrary
  [gettype] Project Type: Android Library

-build-setup:
     [echo] Resolving Build Target for AndroidBillingLibrary...
[gettarget] Project Target:   Android 4.0.3
[gettarget] API level:        15
     [echo] ----------
     [echo] Creating output directories if needed...
     [echo] ----------
     [echo] Resolving Dependencies for AndroidBillingLibrary...
[dependency] Library dependencies:
[dependency] No Libraries
[dependency] 
[dependency] ------------------
[dependency] API<=15: Adding annotations.jar to the classpath.

-pre-build:

-code-gen:
[mergemanifest] No changes in the AndroidManifest files.
     [echo] Handling aidl files...
     [aidl] Found 1 AIDL files.
     [aidl] No AIDL files to compile.
     [echo] ----------
     [echo] Handling RenderScript files...
[renderscript] No RenderScript files to compile.
     [echo] ----------
     [echo] Handling Resources...
     [aapt] No changed resources. R.java and Manifest.java untouched.
     [echo] ----------
     [echo] Handling BuildConfig class...
[buildconfig] No need to generate new BuildConfig.

-pre-compile:

-compile:
     [echo] Creating library output jar file...

-post-compile:

-obfuscate:

-dex:
     [echo] Library project: do not convert bytecode...

-crunch:
   [crunch] Crunching PNG Files in source dir: /home/viktor/Desktop/Dropbox/work/AndroidBillingLibrary/res
   [crunch] To destination dir: /home/viktor/Desktop/Dropbox/work/AndroidBillingLibrary/bin/res
   [crunch] Crunched 0 PNG files to update cache

-package-resources:
     [echo] Library project: do not package resources...

-package:
     [echo] Library project: do not package apk...

-post-package:

-release-prompt-for-password:

-release-nosign:
     [echo] 
[propertyfile] Updating property file: /home/viktor/Desktop/Dropbox/work/AndroidBillingLibrary/bin/build.prop
[propertyfile] Updating property file: /home/viktor/Desktop/Dropbox/work/AndroidBillingLibrary/bin/build.prop
[propertyfile] Updating property file: /home/viktor/Desktop/Dropbox/work/AndroidBillingLibrary/bin/build.prop
[propertyfile] Updating property file: /home/viktor/Desktop/Dropbox/work/AndroidBillingLibrary/bin/build.prop

-release-sign:

-post-build:

release:

-pre-build:

-code-gen:
[mergemanifest] No changes in the AndroidManifest files.
     [echo] Handling aidl files...
     [aidl] No AIDL files to compile.
     [echo] ----------
     [echo] Handling RenderScript files...
[renderscript] No RenderScript files to compile.
     [echo] ----------
     [echo] Handling Resources...
     [aapt] No changed resources. R.java and Manifest.java untouched.
     [echo] ----------
     [echo] Handling BuildConfig class...
[buildconfig] No need to generate new BuildConfig.

-pre-compile:

-compile:

-dex-obfuscate:

-dex-no-obfuscate:
BUILD FAILED
/home/viktor/Desktop/Dropbox/work/MyProject/add-proguard-release.xml:14: /home/viktor/Desktop/Dropbox/work/MyProject/${out.classes.dir} does not exist. 
```

该错误通知我没有找到某些东西，但是什么以及如何解决它？

另一件事，当我在第二步时，没有混淆的未签名项目的 ant 版本我收到了成功，但有一些通知：“看起来你有子项目，如果有，请使用 --subprojects 命令”。我尝试添加此参数并在没有很长时间的情况下完全成功，但我无法更新子项目。我`m not sure it`很坏与否。请你也帮我解决这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T23:05:40.200

您使用的教程已过时。ProGuard 现在是 Android SDK 的一部分。您可以通过在 project.properties 中的相应行中注释来启用它，如Android SDK[文档中所述。](http://developer.android.com/tools/help/proguard.html)

# windows-8 - Windows 8 Live Tile 多久可以更新一次？

> ID：13497542
> 
> 赞同：5
> 
> 时间：2012-11-21T16:21:41.633
> 
> 标签：windows-8, microsoft-metro, live-tile

我是 Windows 8 的新手，我对动态磁贴特别感兴趣。

我想知道 - 应用程序多久可以更新一次动态磁贴？例如，是否可以创建带有秒数的时钟？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T17:31:33.017

每秒更新一次 Live Tile 太频繁了。

动态磁贴文档的[MSDN 指南](http://msdn.microsoft.com/en-us/library/windows/apps/hh465403.aspx)没有明确限制磁贴的更新频率，但确实对更新频率提出了一些建议。对于内容变化非常频繁的应用，预期的最高平均频率约为 15 分钟。一些选择摘录：

> 对于非个性化内容，例如天气更新，我们建议磁贴每 30 分钟更新一次。这使您的磁贴感觉是最新的，而不会压倒您的用户。
> 
> 例如，一个繁忙的社交媒体应用程序可能每 15 分钟更新一次，天气应用程序每两小时更新一次，新闻应用程序每天更新几次，每日优惠应用程序每天更新一次，杂志应用程序每月更新一次。

没有关于时钟更新的建议，因为这不是动态磁贴更新的预期目的。商店中在其磁贴上显示时间的应用创造性地使用计划磁贴通知（旨在用于一次性日历事件），或频繁将通知推送到 WNS（Windows 推送通知服务）。前者即使不是不可能，也很难正确实施，即使是每分钟精度（请参阅应用评论），而后者很容易被标记为滥用并被 WNS 限制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T16:53:16.797

这篇[文章](http://blogs.msdn.com/b/b8/archive/2011/11/02/updating-live-tiles-without-draining-your-battery.aspx)解释了动态磁贴背后的想法以及它们是如何实现的，我相信你会发现它们很有用。我没有看到发送通知的频率有限制，但实际上几秒钟的时间假设始终是不现实的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T07:26:55.227

我试图在磁贴中显示秒数的实时时钟。但它每 4 秒更新一次。因此，更新图块所需的最短时间为 4 秒。我们不能减少更多。

# android - 在 Instagram 上分享照片

> ID：13497543
> 
> 赞同：1
> 
> 时间：2012-11-21T16:21:45.483
> 
> 标签：android, instagram, file-sharing

我正在开发一个应用程序，我正在尝试在 Instagram 中分享一张图片。

我正在使用下面的代码：

```
Intent i = new Intent(Intent.ACTION_SEND);
i.setType("image/jpeg");
i.putExtra(Intent.EXTRA_STREAM, Uri.parse("file:///"+savedPhotoPath));//savedPhotoPath is the path of my picture stored somewhere in the sdcard
startActivity(Intent.createChooser(i, "Share Image")); 
```

问题是 instagramm 是与家庭活动一起启动的，（我想要分享要启动的图片的活动）。

我试图像这样放置额外的东西：

```
i.putExtra(Intent.EXTRA_STREAM, new File(savedPhotoPath)); 
```

和

```
i.putExtra(Intent.EXTRA_STREAM, Uri.parse(savedPhotoPath)); 
```

同样的结果，总是启动 instagram 应用程序的主页活动。

任何想法如何解决这个问题？

问候，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T16:42:45.930

这只是我犯的一个愚蠢的错误，我在`file:///`路径上添加了一个斜杠，它会与 savedPhotoPath 连接，它将变成 4 个斜杠，所以添加额外内容的正确方法是：

```
i.putExtra(Intent.EXTRA_STREAM, Uri.parse("file://"+savedPhotoPath));// it will give : file:///sdcard/... 
```

# ruby-on-rails - 如何在 Rails 中获取客户的 IP 地址？

> ID：13497549
> 
> 赞同：4
> 
> 时间：2012-11-21T16:22:05.823
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我的控制器中有一个函数，它从需要输入 IP 地址的模型中调用另一个函数

```
 def get_location_users
    if current_user
      return current_user.location_users
    else

      l = Location.find_by_ip(request.remote_ip)

      lu = LocationUser.new({:location_id => l.id, :radius => Setting.get("default_radius").to_i})
      return [lu]
    end
  end 
```

从我收集的 remote.request_ip 中可以得到 IP 地址，但是当我使用 request.remote_ip 调用该函数时，对象为 nil。如果我输入一个静态 IP 地址，尽管它会产生正确的输出。如果 remote.request_ip 不这样做，那么获取 IP 地址的正确方法是什么？

同样，当我尝试在控制台中键入“request.remote_ip”时，它会返回“未定义的局部变量或方法”request” from main”

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-21T16:26:43.873

您的问题是否有错字，或者您是否真的在调用 remote.request_ip？

正确的方法是`request.remote_ip`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-21T17:44:35.430

这看起来像是应该在模型中的代码，所以我假设这就是该方法所在的位置。如果是这样，您不能（至少“开箱即用”）从您的模型访问请求对象，因为它源自 HTTP 请求——这也是您从 main 获得“未定义的局部变量或方法“请求”的原因“在您的控制台中。

如果这个方法还没有在你的模型中，我会把它放在那里，然后从你的控制器调用它并传入 request.remote_ip 作为参数。

```
def get_location_users(the_ip)
  if current_user
    return current_user.location_users
  else
    l = Location.find_by_ip(the_ip)
    lu = LocationUser.new({:location_id => l.id, :radius => Setting.get("default_radius").to_i})
    return [lu]
  end
end 
```

然后，在您的控制器中::

```
SomeModel.get_location_users(request.remote_ip) 
```

另外，请注意，如果没有匹配的记录，“Location.find_by_ip”将返回 nil。

**而且，您可以使用app.get "some-url"**在控制台中发出请求，然后您可以从请求对象**app.request.remote_ip**访问 request_ip并在需要时使用它进行测试。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-21T18:49:59.520

*   **HTTP 请求：（** `request.ip`正如 sebastianh 在他的回答中指出的那样）

    也可作为：`request.env['action_dispatch.request_id']`

*   **HTTPS 请求：** `request.env['HTTP_X_FORWARDED_FOR'].split(/,/).try(:first)`

# android - android片段动画异常

> ID：13497550
> 
> 赞同：1
> 
> 时间：2012-11-21T16:21:09.720
> 
> 标签：android, android-fragments

我正在尝试为我的应用创建一个 YouTube 风格的 UI。我有两个片段..让我们说 A（左）和 B（右）。单击操作栏中的应用程序图标时，B 应该向右滑动。再次单击时，它应该滑回左侧。我在 B 上有一个 Listview，而 A 是空的。另外，我正在使用 ActionBarSherlock。

遇到如下行为： 1、点击App图标时，B正常向右滑动

1.  再次点击App图标时B正常向左滑动

2.  当再次单击应用程序图标时，除非手动触摸片段，否则 B 不会滑动。

在随后的点击中，B 正常向左滑动。但是只有在单击按钮后触摸时它才会向右滑动。
可能是什么问题，我该如何解决？谢谢你。

# php - 本地主机返回 php 但不返回 htm

> ID：13497551
> 
> 赞同：1
> 
> 时间：2012-11-21T16:21:11.653
> 
> 标签：php, iis, localhost

我已经使用从“http://www.microsoft.com/web/platform/phponwindows.aspx”下载的内容在 Windows 7 Home Premium 上安装了 IIS 和 php。

我已将文件 'info.php' 和 'index.htm' 文件放在 localhost 文件夹 'C:\inetpub\wwwroot' 中。这两个都被证明可以在远程网站上工作。

打开“http://localhost/info.php”按预期工作。这向我表明 IIS 工作正常。

但是，“index.htm”没有打开（系统放置的“isstart.htm”文件也没有打开）。Firefox 什么也没有显示 - 没有错误消息，并且“查看页面源代码”是空的。Internet Explorer 给出了 404。

如果“index.htm”重命名为“index.php”，它会按预期打开。

为什么 IIS 会忽略“htm”文件？

罗杰

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-29T00:49:36.283

在你的IIS中，找到默认文件并点击它，尝试添加扩展名htm，因为通常配置为asp，aspx，html，修改后打开CMD并执行iisreset并测试它。

# c# - Windows 应用商店 WebView 替代方案

> ID：13497556
> 
> 赞同：8
> 
> 时间：2012-11-21T16:22:26.420
> 
> 标签：c#, webview, windows-8, windows-runtime, windows-store-apps

我在一个项目中广泛使用 WebView，但发现它的缺点是项目的亮点。是否有任何替代方案可以在 Windows 商店应用程序中呈现 HTML？

编辑：根据要求，我们在使用此控件时遇到的一些问题：

*   它没有依赖属性支持，您需要调用方法（需要解决方法：将其包装在自定义控件中，或附加属性......）
*   它无法呈现本地 html 文件（使用 navigatetostring 的解决方法）
*   如果本地 html 文件包含额外文件，如 css 或 js，则需要更多变通方法才能使其正常工作
*   它是在您的应用程序上方呈现的 IE10，因此它涵盖了其他控件（再次，您需要那个糟糕的 - 抱歉 - webbrush 解决方法）
*   放入 Listview 时动画效果不佳（滚动速度比其他控件快，拉伸也很奇怪），没有解决方法
*   放入动画浮出控件时，动画根本不起作用，没有解决方法
*   如果您放大，它会以未知的原因破坏纵向模式下的语义缩放（除了需要网络刷解决方法才能工作）。只要您不导航任何内容，它就可以横向和纵向工作，但永远不要在任何时候浏览网站它打破了缩放。

我们可能还有更多问题，这些问题让我们认为它是一个很好的选择

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-19T18:00:49.770

我们遇到了同样的问题，但在这个[XAML Toolkit for WinRT](http://winrtxamltoolkit.codeplex.com/)中使用了更多而不是“*缺点*”的替代方案来解决它。

`WebBrowser`您必须查看一个控件。

# java - 简单的 Java GIS 编辑器

> ID：13497558
> 
> 赞同：2
> 
> 时间：2012-11-21T16:21:27.080
> 
> 标签：java, frameworks, gis

我正在寻找一个库/应用程序，它可以为我需要的应用程序提供一个良好的起点：

*   在地图上显示（大）铁路/街道网络（地理上仅限于中欧）
*   铁路/街道网络有其自定义图形数据结构（没有我们可以从中受益的标准）
*   与地图的标准交互：缩放/平移
*   与网络的交互：删除/添加节点和边。移动节点。

最好用Java实现。就是这样；）

很想听听您对这个主题的建议！非常感谢，帕特里克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T16:43:08.677

[GeoServer](http://geoserver.org/display/GEOS/Welcome)是一个基于[GeoTools 库](http://www.geotools.org/)的全功能地理空间服务器。[此外，您可以查看OSGeo](http://www.osgeo.org/)托管的所有其他项目。

至于标准，您可以从中受益，由[OGC](http://en.wikipedia.org/wiki/Open_Geospatial_Consortium#Standards)开发。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T22:16:01.117

给[**uDig**](http://udig.refractions.net/)一个机会。开源和Java。

满足您的显示和交互标准（我尝试使用相对较大的矢量数据，但不确定光栅性能）。

我真的不能说它是如何与网络数据集一起工作的，但是如果你有足够的编程技能，你可能会用一些自定义插件来破解你的方式。这里是一个[起点](http://udig.github.com/docs/dev/tool_plugin_tutorial.html)。

# html - 将div之间的间距放在水平行中？

> ID：13497561
> 
> 赞同：7
> 
> 时间：2012-11-21T16:22:49.297
> 
> 标签：html, css

我在水平行中有 4 个 div。我想在 div 之间放置空间（我猜是使用边距？），但是当我这样做时，div 会溢出它们的父容器。

在零边距的情况下，它们很好地排列在一条线上：

```
<div style="width:100%; height: 200px; background-color: grey;">
  <div style="width: 25%; float:left; margin: 0px; background-color: red;">A</div>
  <div style="width: 25%; float:left; margin: 0px; background-color: orange;">B</div>
  <div style="width: 25%; float:left; margin: 0px; background-color: green;">C</div>
  <div style="width: 25%; float:left; margin: 0px; background-color: blue;">D</div>
</div>
```

现在，当我引入 5px 的边距时，最后一个按钮会换行：

```
<div style="width:100%; height: 200px; background-color: grey;">
  <div style="width: 25%; float:left; margin: 5px; background-color: red;">A</div>
  <div style="width: 25%; float:left; margin: 5px; background-color: orange;">B</div>
  <div style="width: 25%; float:left; margin: 5px; background-color: green;">C</div>
  <div style="width: 25%; float:left; margin: 5px; background-color: blue;">D</div>
</div>
```

我猜这是因为宽度属性，当一个百分比时，没有将边距考虑到元素的总宽度？这样做的正确方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-21T16:35:17.397

一个可能的想法是：

1.  `width: 25%; float:left;`从 div 的样式中删除
2.  将四个彩色 div 中的每一个包装在一个具有`style="width: 25%; float:left;"`

这种方法的优点是所有四列将具有相同的宽度，并且它们之间的间隙将始终为 5px * 2。

这是它的样子：

```
.cellContainer {
  width: 25%;
  float: left;
}
```

```
<div style="width:100%; height: 200px; background-color: grey;">
  <div class="cellContainer">
    <div style="margin: 5px; background-color: red;">A</div>
  </div>
  <div class="cellContainer">
    <div style="margin: 5px; background-color: orange;">B</div>
  </div>
  <div class="cellContainer">
    <div style="margin: 5px; background-color: green;">C</div>
  </div>
  <div class="cellContainer">
    <div style="margin: 5px; background-color: blue;">D</div>
  </div>
</div>
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-21T16:26:48.913

我建议让`div`sa 更小一些，并增加一个百分比的边距。

```
<div style="width:100%; height: 200px; background-color: grey;">
  <div style="width: 23%; float:left; margin: 1%; background-color: red;">A</div>
  <div style="width: 23%; float:left; margin: 1%; background-color: orange;">B</div>
  <div style="width: 23%; float:left; margin: 1%; background-color: green;">C</div>
  <div style="width: 23%; float:left; margin: 1%; background-color: blue;">D</div>
</div>
```

[http://jsfiddle.net/YJT7q/](http://jsfiddle.net/YJT7q/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-21T16:47:42.503

有很多方法可以解决这个问题。

**使用 box-sizing css3 属性并模拟带边框的边距。**

[http://jsfiddle.net/Z7mFr/1/](http://jsfiddle.net/Z7mFr/1/)

```
div.inside {
 width: 25%;
 float:left;
 border-right: 5px solid grey;
 background-color: blue;
 box-sizing:border-box;
 -moz-box-sizing:border-box; /* Firefox */
 -webkit-box-sizing:border-box; /* Safari */
}

<div style="width:100%; height: 200px; background-color: grey;">
 <div class="inside">A</div>
 <div class="inside">B</div>
 <div class="inside">C</div>
 <div class="inside">D</div>
</div> 
```

**减少元素宽度的百分比并添加一些边距。**

[http://jsfiddle.net/mJfz3/](http://jsfiddle.net/mJfz3/)

```
.outer {
 width:100%;
 background:#999;
 overflow:auto;
}

.inside {
 float:left;
 width:24%;
 margin-right:1%;
 background:#333;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-21T16:27:33.640

这是因为`width`当提供 a 时`%`不考虑`padding`/ `margin`s。您需要将金额减少到可能`24%`或`24.5%`。完成此操作后，您应该会很好，但是如果您希望它始终正确工作，则需要根据屏幕尺寸提供不同的选项，因为您有硬编码的边距，但相对尺寸。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-21T16:28:20.727

您可以`li`以百分比为标签设置左边距，并在父级上设置相同的负左边距：

```
ul {margin-left:-5%;}
li {width:20%;margin-left:5%;float:left;}
```

```
<ul>
  <li>A
  <li>B
  <li>C
  <li>D
</ul>
```

[http://jsfiddle.net/UZHbS/](http://jsfiddle.net/UZHbS/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-06-18T22:51:48.113

另一个想法：在 div 的另一侧补偿您的边距。

例如，对于您希望达到的间距的一侧：10px，而对于相反的一侧，补偿 -10px。这个对我有用。这可能不适用于所有场景，但根据您的布局和其他元素的间距，它可能会很好用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-07-15T14:14:45.667

将所有 div 放在一个单独的表格单元格中，并将表格样式设置为`padding: 5px;`.

例如

```
<table style="width: 100%; padding: 5px;">
<tbody>
<tr>
<td>
<div style="background-color: red;">A</div>
</td>
<td>
<div style="background-color: orange;">B</div>
</td>
<td>
<div style="background-color: green;">C</div>
</td>
<td>
<div style="background-color: blue;">D</div>
</td>
</tr>
</tbody>
</table>
```

# include - 如何检查 Smarty 2 中是否存在文件

> ID：13497563
> 
> 赞同：4
> 
> 时间：2012-11-21T16:22:50.873
> 
> 标签：include, smarty, smarty2

如何检查 Smarty 2 中是否存在文件？我的意思是这样的：

```
{assign var="module_js" value="/js/modules/{$module}.js"}
{if file_exists($module_js)}
    <script type="text/javascript" src="{$module_js}"></script>
{/if} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-22T04:09:16.410

实际上，这与 Smarty 版本无关。但是你分配变量的方式是错误的。试试这个方法：

```
{assign var="module_js" value="js/`$module`.js"}
{if file_exists($module_js)}
    <script type="text/javascript" src="{$module_js}"></script>      
{/if} 
```

# php - PDO 功能的新手什么都不做？

> ID：13497564
> 
> 赞同：0
> 
> 时间：2012-11-21T16:22:54.590
> 
> 标签：php, mysql, pdo

这是我的代码：

```
function connect() {
    $pdo = new PDO("mysql:host=localhost;dbname=www","user","pass");
   $xmax = "SELECT MAX(x) FROM headerfooter WHERE site = 'Brighter_Vista'";
   $xresult = $pdo->query($xmax);
   while($row = $xresult->fetch(PDO::FETCH_ASSOC)) {
       print_r($row);
    }
    $ymax = "SELECT MAX(y) FROM headerfooter WHERE site = 'Brighter_Vista'";
   $yresult = $pdo->query($ymax);
   while($row = $yresult->fetch(PDO::FETCH_ASSOC)) {
       print_r($row);
   }
} 
```

我调用该函数，但没有任何显示。

我检查了mysql终端中的查询，它确实有效。

我是 PDO 的新手，我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T16:35:00.430

将您的查询包装在 try catch 块中。连接很可能正在悄悄地失败。

```
function connect() {
  try{
      $pdo = new PDO("mysql:host=localhost;dbname=www","user","pass");
      $xmax = "SELECT MAX(x) FROM headerfooter WHERE site = 'Brighter_Vista'";
      $xresult = $pdo->query($xmax);
      while($row = $xresult->fetch(PDO::FETCH_ASSOC)) {
          print_r($row);
      }

      $ymax = "SELECT MAX(y) FROM headerfooter WHERE site = 'Brighter_Vista'";
      $yresult = $pdo->query($ymax);
      while($row = $yresult->fetch(PDO::FETCH_ASSOC)) {
          print_r($row);
      }
   }catch (Exception $e){
      echo $e->getMessage();
      exit;
   }

} 
```

如果引发异常，则消息会指出您的问题所在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T16:34:34.403

该函数在语法上是正确的。一切似乎都很好，我能看到的唯一问题与 PDO 尝试连接的问题有关。只需用这个替换你的函数：

```
function connect() {
    try {
        $pdo = new \PDO("mysql:host=localhost;dbname=www","user","pass");
        $xmax = "SELECT MAX(x) FROM headerfooter WHERE site = 'Brighter_Vista'";
        $xresult = $pdo->query($xmax);
            while($row = $xresult->fetch(PDO::FETCH_ASSOC))
                print_r($row);
        $ymax = "SELECT MAX(y) FROM headerfooter WHERE site = 'Brighter_Vista'";
        $yresult = $pdo->query($ymax);
            while($row = $yresult->fetch(PDO::FETCH_ASSOC))
                print_r($row);
    } catch (\PDOException $e) {
        exit($e->getMessage());
    }
} 
```

此功能在以下情况下显示或防止错误：

*   任何 PDO 错误
*   您使用命名空间的上下文

# php - MySQL查询返回数据但数据库PHP返回array()

> ID：13497569
> 
> 赞同：0
> 
> 时间：2012-11-21T16:23:11.277
> 
> 标签：php, mysql, database

我有一个查询，在 MySQL 中执行时返回 18 条记录，但是当我运行 php 代码时，它返回一个空数组：

PHP代码：

```
$db = &JFactory::getDbo();
$db->setQuery($query);
$list = $db->loadObjectList();
die (var_dump($list)); 
```

查询 var_dump：

```
string(1215) " SELECT i.title AS title, i.metadesc, i.metakey, c.name as section, i.image_caption, i.image_credits, i.video_caption, i.video_credits, i.extra_fields_search, i.created, CONCAT(i.introtext, i.fulltext) AS text, CASE WHEN CHAR_LENGTH(i.alias) THEN CONCAT_WS(':', i.id, i.alias) ELSE i.id END as slug, CASE WHEN CHAR_LENGTH(c.alias) THEN CONCAT_WS(':', c.id, c.alias) ELSE c.id END as catslug FROM #__catalog_items AS i INNER JOIN #__catalog_categories AS c ON c.id=i.catid AND c.access IN(1,1) WHERE (MATCH(i.title, i.introtext, i.`fulltext`,i.extra_fields_search,i.image_caption,i.image_credits,i.video_caption,i.video_credits,i.metadesc,i.metakey) AGAINST ('+×ž×œ×š* +×”×™×¢×¨*' IN BOOLEAN MODE) ) AND i.trash = 0 AND i.published = 1 AND i.access IN(1,1) AND c.published = 1 AND c.access IN(1,1) AND c.trash = 0 AND ( i.publish_up = '0000-00-00 00:00:00' OR i.publish_up <= '2012-11-21 16:20:36' ) AND ( i.publish_down = '0000-00-00 00:00:00' OR i.publish_down >= '2012-11-21 16:20:36' ) AND c.language IN ('he-IL', '*') AND i.language IN ('he-IL', '*') GROUP BY i.id ORDER BY i.created DESC" 
```

奇怪的代码'+×ž×œ×š* +×”×™×¢×¨*'是由于该站点是希伯来语的，我不知道它是否有什么事情要做，因为正如我所解释的，在执行查询时通过 phpmyadmin 它按预期工作。

任何的想法？

**编辑**

$db var_dump：

```
object(JFalangDatabase)#155 (26) {
["_mlTableList"]=> array(14) {
    [0]=>
    string(18) "catalog_categories"
    [1]=>
    string(13) "catalog_items"
    [2]=>
    string(10) "categories"
    [3]=>
    string(15) "contact_details"
    [4]=>
    string(7) "content"
    [5]=>
    string(13) "faq_questions"
    [6]=>
    string(4) "menu"
    [7]=>
    string(7) "modules"
    [8]=>
    string(18) "recipes_categories"
    [9]=>
    string(20) "recipes_extra_fields"
    [10]=>
    string(13) "recipes_items"
    [11]=>
    string(20) "recipes_servingtypes"
    [12]=>
    string(12) "recipes_tags"
    [13]=>
    string(13) "recipes_units"
}
["_refTables"]=>
    array(6) {
    ["fieldTablePairs"]=>
    array(2) {
    [0]=>
    string(13) "catalog_items"
    [1]=>
    string(18) "catalog_categories"
}
["tableAliases"]=>
    array(2) {
    ["catalog_items"]=>
  string(1) "i"
  ["catalog_categories"]=>
  string(1) "c"
}
["reverseTableAliases"]=>
array(2) {
  ["i"]=>
  string(13) "catalog_items"
  ["c"]=>
  string(18) "catalog_categories"
}
["fieldAliases"]=>
array(10) {
  ["title"]=>
  string(5) "title"
  ["metadesc"]=>
  string(8) "metadesc"
  ["metakey"]=>
  string(7) "metakey"
  ["section"]=>
  string(4) "name"
  ["image_caption"]=>
  string(13) "image_caption"
  ["image_credits"]=>
  string(13) "image_credits"
  ["video_caption"]=>
  string(13) "video_caption"
  ["video_credits"]=>
  string(13) "video_credits"
  ["extra_fields_search"]=>
  string(19) "extra_fields_search"
  ["created"]=>
  string(7) "created"
}
["fieldTableAliasData"]=>
array(10) {
  [0]=>
  array(4) {
    ["fieldNameAlias"]=>
    string(5) "title"
    ["fieldName"]=>
    string(5) "title"
    ["tableNameAlias"]=>
    string(1) "i"
    ["tableName"]=>
    string(13) "catalog_items"
  }
  [1]=>
  array(4) {
    ["fieldNameAlias"]=>
    string(8) "metadesc"
    ["fieldName"]=>
    string(8) "metadesc"
    ["tableNameAlias"]=>
    string(1) "i"
    ["tableName"]=>
    string(13) "catalog_items"
  }
  [2]=>
  array(4) {
    ["fieldNameAlias"]=>
    string(7) "metakey"
    ["fieldName"]=>
    string(7) "metakey"
    ["tableNameAlias"]=>
    string(1) "i"
    ["tableName"]=>
    string(13) "catalog_items"
  }
  [3]=>
  array(4) {
    ["fieldNameAlias"]=>
    string(7) "section"
    ["fieldName"]=>
    string(4) "name"
    ["tableNameAlias"]=>
    string(1) "c"
    ["tableName"]=>
    string(18) "catalog_categories"
  }
  [4]=>
  array(4) {
    ["fieldNameAlias"]=>
    string(13) "image_caption"
    ["fieldName"]=>
    string(13) "image_caption"
    ["tableNameAlias"]=>
    string(1) "i"
    ["tableName"]=>
    string(13) "catalog_items"
  }
  [5]=>
  array(4) {
    ["fieldNameAlias"]=>
    string(13) "image_credits"
    ["fieldName"]=>
    string(13) "image_credits"
    ["tableNameAlias"]=>
    string(1) "i"
    ["tableName"]=>
    string(13) "catalog_items"
  }
  [6]=>
  array(4) {
    ["fieldNameAlias"]=>
    string(13) "video_caption"
    ["fieldName"]=>
    string(13) "video_caption"
    ["tableNameAlias"]=>
    string(1) "i"
    ["tableName"]=>
    string(13) "catalog_items"
  }
  [7]=>
  array(4) {
    ["fieldNameAlias"]=>
    string(13) "video_credits"
    ["fieldName"]=>
    string(13) "video_credits"
    ["tableNameAlias"]=>
    string(1) "i"
    ["tableName"]=>
    string(13) "catalog_items"
  }
  [8]=>
  array(4) {
    ["fieldNameAlias"]=>
    string(19) "extra_fields_search"
    ["fieldName"]=>
    string(19) "extra_fields_search"
    ["tableNameAlias"]=>
    string(1) "i"
    ["tableName"]=>
    string(13) "catalog_items"
  }
  [9]=>
  array(4) {
    ["fieldNameAlias"]=>
    string(7) "created"
    ["fieldName"]=>
    string(7) "created"
    ["tableNameAlias"]=>
    string(1) "i"
    ["tableName"]=>
    string(13) "catalog_items"
  }
}
["fieldCount"]=>
int(13)
}
["_skipSetRefTables"]=>
    bool(false)
    ["orig_limit"]=>
    int(0)
    ["orig_offset"]=>
    int(0)
    ["_table_prefix"]=>
    string(6) "oyhkl_"
    ["profileData"]=>
    array(2) {
    ["JOverrideDatabase::setRefTables"]=>
    array(3) {
    ["total"]=>
  float(0.0053415298461914)
  ["count"]=>
  int(20)
  ["start"]=>
  array(0) {
  }
}
["JFalangDatabase::loadObjectList"]=>
array(3) {
  ["total"]=>
  float(0.011144638061523)
  ["count"]=>
  int(7)
  ["start"]=>
  array(0) {
       }
    }
}
["name"]=>
string(6) "mysqli"
["nameQuote":protected]=>
string(1) "`"
["nullDate":protected]=>
string(19) "0000-00-00 00:00:00"
["dbMinimum":protected]=>
string(5) "5.0.4"
["_database":"JDatabase":private]=>
string(20) "jom_database"
["connection":protected]=>
object(mysqli)#156 (17) {
    ["affected_rows"]=>
    int(0)
    ["client_info"]=>
    string(6) "5.1.49"
    ["client_version"]=>
    int(50149)
    ["connect_errno"]=>
    int(0)
    ["connect_error"]=>
    NULL
    ["errno"]=>
    int(0)
    ["error"]=>
    string(0) ""
    ["field_count"]=>
    int(13)
    ["host_info"]=>
    string(25) "Localhost via UNIX socket"
    ["info"]=>
    NULL
    ["insert_id"]=>
    int(0)
    ["server_info"]=>
    string(17) "5.1.63-0+squeeze1"
    ["server_version"]=>
    int(50163)
    ["sqlstate"]=>
    string(5) "00000"
    ["protocol_version"]=>
    int(10)
    ["thread_id"]=>
    int(94278)
    ["warning_count"]=>
    int(0)
}
["count":protected]=>
    int(20)
    ["cursor":protected]=>

Warning: var_dump(): Couldn't fetch mysqli_result in    /var/www/clients/client1/web2/web/plugins/search/catalog/catalog.php on line 198

Warning: var_dump(): Couldn't fetch mysqli_result in /var/www/clients/client1/web2/web/plugins/search/catalog/catalog.php on line 198

Warning: var_dump(): Property access is not allowed yet in /var/www/clients/client1/web2/web/plugins/search/catalog/catalog.php on line 198

Warning: var_dump(): Couldn't fetch mysqli_result in /var/www/clients/client1/web2/web/plugins/search/catalog/catalog.php on line 198

Warning: var_dump(): Property access is not allowed yet in /var/www/clients/client1/web2/web/plugins/search/catalog/catalog.php on line 198

object(mysqli_result)#317 (5) {
    ["current_field"]=>
    NULL
    ["field_count"]=>
    NULL
    ["lengths"]=>
    NULL
    ["num_rows"]=>
    NULL
   ["type"]=>
    NULL
}
["debug":protected]=>
    bool(true)
    ["limit":protected]=>
    int(50)
    ["log":protected]=>
    array(20) {
    [0]=>
    string(142) "SELECT extension_id AS id, element AS "option", params, enabled
    FROM oyhkl_extensions
    WHERE `type` = 'component' AND `element` = 'com_catalog'"
    [1]=>
    string(142) "SELECT extension_id AS id, element AS "option", params, enabled
    FROM oyhkl_extensions
    WHERE `type` = 'component' AND `element` = 'com_recipes'"
    [2]=>
    string(389) "SELECT m.id, m.menutype, m.title, m.alias, m.note, m.path AS route, m.link, m.type, m.level, m.language,m.browserNav, m.access, m.params, m.home, m.img, m.template_style_id, m.component_id, m.parent_id,e.element as component
    FROM oyhkl_menu AS m
    LEFT JOIN oyhkl_extensions AS e ON m.component_id = e.extension_id
    WHERE m.published = 1 AND m.parent_id > 0 AND m.client_id = 0
    ORDER BY m.lft"
    [3]=>
    string(62) "SELECT joomlatablename,tablepkID FROM `oyhkl_falang_tableinfo`"
    [4]=>
    string(47) "SELECT * FROM oyhkl_languages ORDER BY ordering"
    [5]=>
    string(40) "SHOW FULL COLUMNS FROM `oyhkl_languages`"
    [6]=>
    string(141) "SELECT extension_id AS id, element AS "option", params, enabled
    FROM oyhkl_extensions
    WHERE `type` = 'component' AND `element` = 'com_falang'"
    [7]=>
    string(395) "SELECT falang_content.reference_field, falang_content.value, falang_content.reference_id, falang_content.original_value 
    FROM oyhkl_falang_content AS falang_content
    WHERE falang_content.language_id=2
AND falang_content.published=1
    AND falang_content.reference_id IN(101,102,103,104,105,167,106,164,109,110,155,156,157,158,159,160,161,162,163,169)
    AND falang_content.reference_table='menu'"
    [8]=>
    string(141) "SELECT extension_id AS id, element AS "option", params, enabled
    FROM oyhkl_extensions
    WHERE `type` = 'component' AND `element` = 'com_search'"
    [9]=>
    string(213) "SELECT id, home, template, s.params
    FROM oyhkl_template_styles as s
    LEFT JOIN oyhkl_extensions as e ON e.element=s.template AND e.type='template' AND e.client_id=s.client_id
    WHERE s.client_id = 0 AND e.enabled = 1"
    [10]=>
    string(444) "SELECT a.title, a.description AS text, "" AS created, "2" AS browsernav, a.id AS catid,  CASE WHEN CHAR_LENGTH(a.alias) THEN CONCAT_WS(':', a.id, a.alias) ELSE a.id END as slug
    FROM oyhkl_categories AS a
    WHERE (a.title LIKE '%×ž×œ×š ×”×™×¢×¨%' OR a.description LIKE '%×ž×œ×š ×”×™×¢×¨%') AND a.published IN (1,2) AND a.extension = 'com_content'AND a.access IN (1,1) AND a.language in ('he-IL','*')
    GROUP BY a.id
    ORDER BY a.title DESC LIMIT 0, 50"
    [11]=>
    string(1049) "SELECT a.name AS title, '' AS created, a.con_position, a.misc,  CASE     WHEN CHAR_LENGTH(a.alias) THEN CONCAT_WS(':', a.id, a.alias) ELSE a.id END as slug, CASE WHEN CHAR_LENGTH(c.alias) THEN CONCAT_WS(':', c.id, c.alias) ELSE c.id END as catslug, CONCAT_WS(',', a.name, a.con_position, a.misc) AS text,CONCAT_WS(' / ', '×× ×©×™ ×§×©×¨', c.title) AS section,'2' AS browsernav
    FROM oyhkl_contact_details AS a
    INNER JOIN oyhkl_categories AS c ON c.id = a.catid
    WHERE (a.name LIKE '%×ž×œ×š ×”×™×¢×¨%'OR a.misc LIKE '%×ž×œ×š ×”×™×¢×¨%'OR a.con_position LIKE '%×ž×œ×š ×”×™×¢×¨%'OR a.address LIKE '%×ž×œ×š ×”×™×¢×¨%'OR a.suburb LIKE '%×ž×œ×š ×”×™×¢×¨%'OR a.state LIKE '%×ž×œ×š ×”×™×¢×¨%'OR a.country LIKE '%×ž×œ×š ×”×™×¢×¨%'OR a.postcode LIKE '%×ž×œ×š ×”×™×¢×¨%'OR a.telephone LIKE '%×ž×œ×š ×”×™×¢×¨%'OR a.fax LIKE '%×ž×œ×š ×”×™×¢×¨%') AND a.published IN (1,2) AND c.published=1 AND a.access IN (1,1) AND c.access IN (1,1) AND a.language in ('he-IL','*') AND c.language in ('he-IL','*')
    GROUP BY a.id, a.con_position, a.misc
    ORDER BY a.name DESC LIMIT 0, 50"
    [12]=>
    string(1178) "SELECT a.title AS title, a.metadesc, a.metakey, a.created AS created,CONCAT(a.introtext,a.fulltext) AS text,c.title AS section,  CASE WHEN CHAR_LENGTH(a.alias) THEN CONCAT_WS(':', a.id, a.alias) ELSE a.id END as slug, CASE WHEN CHAR_LENGTH(c.alias) THEN CONCAT_WS(':', c.id, c.alias) ELSE c.id END as catslug, '2' AS browsernav
    FROM oyhkl_content AS a
    INNER JOIN oyhkl_categories AS c ON c.id=a.catid
    WHERE ((a.title LIKE '%×ž×œ×š%' OR a.introtext LIKE '%×ž×œ×š%' OR a.fulltext LIKE '%×ž×œ×š%' OR a.metakey LIKE '%×ž×œ×š%' OR a.metadesc LIKE '%×ž×œ×š%') AND (a.title LIKE '%×”×™×¢×¨%' OR a.introtext LIKE '%×”×™×¢×¨%' OR a.fulltext LIKE '%×”×™×¢×¨%' OR a.metakey LIKE '%×”×™×¢×¨%' OR a.metadesc LIKE '%×”×™×¢×¨%'))AND a.state=1 AND c.published = 1 AND a.access IN (1,1) AND c.access IN (1,1) AND (a.publish_up = '0000-00-00 00:00:00' OR a.publish_up <= '2012-11-21 17:01:20') AND (a.publish_down = '0000-00-00 00:00:00' OR a.publish_down >= '2012-11-21 17:01:20') AND a.language in ('he-IL','*') AND c.language in ('he-IL','*')
    GROUP BY a.id, a.title, a.metadesc, a.metakey, a.created, a.introtext, a.fulltext, c.title, a.alias, c.alias, c.id
    ORDER BY a.created DESC LIMIT 0, 50"
    [13]=>
    string(998) "SELECT c.*, CASE WHEN CHAR_LENGTH(c.alias) THEN CONCAT_WS(':', c.id, c.alias) ELSE c.id END as slug
    FROM oyhkl_categories as c
    LEFT JOIN oyhkl_categories AS s ON (s.lft < c.lft AND s.rgt > c.rgt AND c.language in ('he-IL','*')) OR (s.lft >= c.lft AND s.rgt <= c.rgt)
    LEFT JOIN  (SELECT cat.id as id FROM oyhkl_categories AS cat JOIN oyhkl_categories AS parent ON cat.lft BETWEEN parent.lft AND parent.rgt WHERE parent.extension = 'com_content' AND parent.published != 1 GROUP BY cat.id) AS badcats ON badcats.id = c.id
    WHERE (c.extension='com_content' OR c.extension='system') AND c.access IN (1,1) AND c.published = 1 AND s.id=8 AND badcats.id is null
    GROUP BY c.id, c.asset_id, c.access, c.alias, c.checked_out, c.checked_out_time,
        c.created_time, c.created_user_id, c.description, c.extension, c.hits, c.language, c.level,
        c.lft, c.metadata, c.metadesc, c.metakey, c.modified_time, c.note, c.params, c.parent_id,
        c.path, c.published, c.rgt, c.title, c.modified_user_id
    ORDER BY c.lft"
    [14]=>
    string(325) "SELECT falang_content.reference_field, falang_content.value, falang_content.reference_id, falang_content.original_value 
    FROM oyhkl_falang_content AS falang_content
    WHERE falang_content.language_id=2
AND falang_content.published=1
   AND falang_content.reference_id IN(1,8)
   AND falang_content.reference_table='categories'"
    [15]=>
    string(142) "SELECT extension_id AS id, element AS "option", params, enabled
    FROM oyhkl_extensions
    WHERE `type` = 'component' AND `element` = 'com_content'"
    [16]=>
    string(1089) "SELECT a.title AS title, a.metadesc, a.metakey, a.created AS created,     CONCAT(a.introtext,a.fulltext) AS text, CASE WHEN CHAR_LENGTH(a.alias) THEN CONCAT_WS(':', a.id, a.alias) ELSE a.id END as slug, CASE WHEN CHAR_LENGTH(c.alias) THEN CONCAT_WS(':', c.id, c.alias) ELSE c.id END as catslug, c.title AS section, '2' AS browsernav
    FROM oyhkl_content AS a
    INNER JOIN oyhkl_categories AS c ON c.id=a.catid AND c.access IN (1,1)
    WHERE ((a.title LIKE '%×ž×œ×š%' OR a.introtext LIKE '%×ž×œ×š%' OR a.fulltext LIKE '%×ž×œ×š%' OR a.metakey LIKE '%×ž×œ×š%' OR a.metadesc LIKE '%×ž×œ×š%') AND (a.title LIKE '%×”×™×¢×¨%' OR a.introtext LIKE '%×”×™×¢×¨%' OR a.fulltext LIKE '%×”×™×¢×¨%' OR a.metakey LIKE '%×”×™×¢×¨%' OR a.metadesc LIKE '%×”×™×¢×¨%')) AND a.state = 2 AND c.published = 1 AND a.access IN (1,1) AND c.access IN (1,1) AND (a.publish_up = '0000-00-00 00:00:00' OR a.publish_up <= '2012-11-21 17:01:20') AND (a.publish_down = '0000-00-00 00:00:00' OR a.publish_down >= '2012-11-21 17:01:20') AND a.language in ('he-IL','*') AND c.language in ('he-IL','*')
    ORDER BY a.created DESC LIMIT 0, 49"
    [17]=>
    string(670) "SELECT a.name AS title, "" AS created, a.link AS text,  CASE WHEN CHAR_LENGTH(a.alias) THEN CONCAT_WS(':', a.id, a.alias) ELSE a.id END as slug, CASE WHEN CHAR_LENGTH(c.alias) THEN CONCAT_WS(':', c.id, c.alias) ELSE c.id END as catslug,CONCAT_WS(' / ', '×ž×–×™×Ÿ ×—×“×©×•×ª', c.title) AS section,"1" AS browsernav
    FROM oyhkl_newsfeeds AS a
    INNER JOIN oyhkl_categories as c ON c.id = a.catid
    WHERE ((a.name LIKE '%×ž×œ×š%' OR a.link LIKE '%×ž×œ×š%') AND (a.name LIKE '%×”×™×¢×¨%' OR a.link LIKE '%×”×™×¢×¨%'))AND a.published IN (1,2) AND c.published = 1 AND c.access IN (1,1) AND a.language in ('he-IL','*') AND c.language in ('he-IL','*')
    ORDER BY a.name ASC LIMIT 0, 50"
    [18]=>
    string(775) "SELECT a.title AS title, a.description AS text, a.created AS created, a.url,  CASE WHEN CHAR_LENGTH(a.alias) THEN CONCAT_WS(':', a.id, a.alias) ELSE a.id END as slug, CASE WHEN CHAR_LENGTH(c.alias) THEN CONCAT_WS(':', c.id, c.alias) ELSE c.id END as catslug, CONCAT_WS(' / ', '×—×™×¤×•×© - ×§×™×©×•×¨×™ ×¨×©×ª', c.title) AS section, '1' AS browsernav
    FROM oyhkl_weblinks AS a
    INNER JOIN oyhkl_categories AS c ON c.id = a.catid
    WHERE ((a.url LIKE '%×ž×œ×š%' OR a.description LIKE '%×ž×œ×š%' OR a.title LIKE '%×ž×œ×š%') AND (a.url LIKE '%×”×™×¢×¨%' OR a.description LIKE '%×”×™×¢×¨%' OR a.title LIKE '%×”×™×¢×¨%')) AND a.state in (1,2) AND  c.published=1 AND  c.access IN (1,1) AND a.language in ('he-IL','*') AND c.language in ('he-IL','*')
    ORDER BY a.created DESC LIMIT 0, 50"
    [19]=>
    string(1230) "SELECT i.title AS title,
    i.metadesc,
    i.metakey,
    c.name as section,
    i.image_caption,
    i.image_credits,
    i.video_caption,
    i.video_credits,
    i.extra_fields_search,
    i.created,
    CONCAT(i.introtext, i.fulltext) AS text,
    CASE WHEN CHAR_LENGTH(i.alias) THEN CONCAT_WS(':', i.id, i.alias) ELSE i.id END as slug,
    CASE WHEN CHAR_LENGTH(c.alias) THEN CONCAT_WS(':', c.id, c.alias) ELSE c.id END as catslug
    FROM oyhkl_catalog_items AS i
    INNER JOIN oyhkl_catalog_categories AS c ON c.id=i.catid AND c.access  IN(1,1) 
    WHERE (MATCH(i.title, i.introtext, i.`fulltext`,i.extra_fields_search,i.image_caption,i.image_credits,i.video_caption,i.video_credits,i.metadesc,i.metakey) AGAINST ('+×ž×œ×š* +×”×™×¢×¨*' IN BOOLEAN MODE)
    )
    AND i.trash = 0
    AND i.published = 1
    AND i.access  IN(1,1) 
    AND c.published = 1
    AND c.access  IN(1,1) 
    AND c.trash = 0
    AND ( i.publish_up = '0000-00-00 00:00:00' OR i.publish_up <= '2012-11-21 17:01:20' )
    AND ( i.publish_down = '0000-00-00 00:00:00' OR i.publish_down >= '2012-11-21 17:01:20' ) AND c.language IN ('he-IL', '*') AND i.language IN ('he-IL', '*')  GROUP BY i.id     ORDER BY i.created DESC LIMIT 0, 50"
}
["offset":protected]=>
int(0)
["sql":protected]=>
string(1215) "
    SELECT i.title AS title,
    i.metadesc,
    i.metakey,
    c.name as section,
    i.image_caption,
    i.image_credits,
    i.video_caption,
    i.video_credits,
    i.extra_fields_search,
    i.created,
    CONCAT(i.introtext, i.fulltext) AS text,
    CASE WHEN CHAR_LENGTH(i.alias) THEN CONCAT_WS(':', i.id, i.alias) ELSE i.id END as slug,
    CASE WHEN CHAR_LENGTH(c.alias) THEN CONCAT_WS(':', c.id, c.alias) ELSE c.id END as catslug
    FROM #__catalog_items AS i
    INNER JOIN #__catalog_categories AS c ON c.id=i.catid AND c.access  IN(1,1) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T19:48:55.950

我解决了这个问题。问题是Falang（一个joomla插件）​​正在修改数据库查询，包括额外的sql。我刚刚修复了这些查询，问题就解决了。

# ios - iOS - 拒绝二进制文件后是否需要重新提交应用内购买

> ID：13497578
> 
> 赞同：2
> 
> 时间：2012-11-21T16:23:39.437
> 
> 标签：ios, binary, in-app-purchase

昨天我设置了 2 个应用内购买，然后上传了二进制文件以与他们一起使用。今天我拒绝了二进制文件并立即提交了另一个。昨天的应用内购买仍然显示为等待审核。我想这意味着我也不需要重做并重新提交它们？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T16:34:40.960

如果我理解正确，您只需将应用内购买转移到“需要开发人员操作”状态时重新提交。所以就目前而言，你应该没问题。

不过，Apple 支持将能够提供更好的答案（这里的任何人都只能根据研究和过去的经验给你答复，这通常与现在不同）；你可能想给他们发一封电子邮件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T16:40:03.217

“等待审查”意味着他们甚至还没有触及你的二进制文件。你很厉害。

# java - Java Applet 出现错误 java.lang.reflect.InvocationTargetException

> ID：13497580
> 
> 赞同：1
> 
> 时间：2012-11-21T16:22:40.450
> 
> 标签：java, applet, jna

刚开始我只是java的新手。

下面是我的小程序代码，它编译时带有一个通知（注意：CallApplet.java 使用未经检查或不安全的操作。注意：使用 -Xlint:unchecked 重新编译以获取详细信息。）但没有错误。

**更新**

当我通过 javascript 调用 mprintt 方法时出现此错误。如您所见，它试图调用 DLL 实例。

```
import javax.swing.*;
import javax.print.*;
import java.util.ArrayList;
import com.sun.jna.Library;
import com.sun.jna.Native;
import java.awt.print.*;
import java.security.*;

public class CallApplet extends JApplet {

    JTextField output;

    public void init() {
        output = new JTextField(20);
        add(output);
        validate();
    }

    public void setMessage(String message) {
        output.setText(message);
    }

    public String getPrinters() {
        PrintService[] printServices = PrintServiceLookup.lookupPrintServices(null, null);
        ArrayList<String> myStringArray = new ArrayList<String>();

        String s = new String();

        int i = 0;

        for (PrintService printer : printServices) {
            myStringArray.add(printer.getName());

            if (i > 0) {
                s = s + ",";
            }

            s = s + "\"" + printer.getName() + "\"";

            i++;
        }

        s = "[" + s + "]";

        String[] simpleArray = new String[ myStringArray.size() ];
        myStringArray.toArray( simpleArray );

        return s;
    }

    public void jPrint(String printer) {

        if (printer.length() <= 0) {
            return;
        }

        //output.setText(printer);

        //TcsPrint tcsPrinter = new TcsPrint();
        //tcsPrinter.print(printer);  
    }

    public interface TscLibDll extends Library {
        TscLibDll INSTANCE = (TscLibDll) AccessController.doPrivileged(new PrivilegedAction () {
            public Object run() {
                return Native.loadLibrary ("TSCLIB", TscLibDll.class);
            }
        });
        int about ();
        int openport (String pirnterName);
        int closeport ();
        int sendcommand (String printerCommand);
        int setup (String width,String height,String speed,String density,String sensor,String vertical,String offset);
        int downloadpcx (String filename,String image_name);
        int barcode (String x,String y,String type,String height,String readable,String rotation,String narrow,String wide,String code);
        int printerfont (String x,String y,String fonttype,String rotation,String xmul,String ymul,String text);
        int clearbuffer ();
        int printlabel (String set, String copy);
        int formfeed ();
        int nobackfeed ();
        int windowsfont (int x, int y, int fontheight, int rotation, int fontstyle, int fontunderline, String szFaceName, String content);
    }

    public void mprintt(String printer) {

        TscLibDll.INSTANCE.openport(printer);
        TscLibDll.INSTANCE.sendcommand("REM ***** This is a test by JAVA. *****");
        TscLibDll.INSTANCE.setup("35", "15", "3", "8", "0", "3", "-1");
        TscLibDll.INSTANCE.clearbuffer();
        TscLibDll.INSTANCE.printerfont ("290", "8", "3", "0", "1", "1", "ARTICLE NO");
        TscLibDll.INSTANCE.barcode("290", "35", "128", "50", "1", "0", "2", "2", "123456789");
        TscLibDll.INSTANCE.printlabel("1", "1");
        TscLibDll.INSTANCE.closeport();
    }
} 
```

下面是我的html

```
<html>
    <body>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <script type='text/javascript'>

    var printers;

    function selectPrinter()
    {
        applet = document.getElementById('output');
        printers = applet.getPrinters();

    }

    </script>

    <br>
        <applet
            id='output'
            code='CallApplet.class'
            archive='.,./jna.jar'
            width=100
            height=100>
        </applet>

        <input type="button" onclick="selectPrinter()" value="Show Printers" /> <input type="button" onclick="goPrint" value="Print" />
        <select name="printers">
        </select>

        dsdsdg
    </body>
</html> 
```

大家可以看到我使用 jna.jar 加载自定义热敏打印机 DLL。

我收到错误“java.lang.reflect.InvocationTargetException”，我认为由于小程序和 jna 并发症更是如此。

请让我知道如何克服这个问题并让这个小程序通过这个 DLL 打印。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T19:47:04.727

通常 InvocationTargetException 只是包装了根异常。根异常应该列在堆栈跟踪中，或者可以使用“getCause()”方法访问。发布堆栈跟踪可能会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T20:10:35.523

我会尝试简化以找到错误或获取堆栈跟踪，如 tcbcw 所述。尝试只从小程序访问打印服务，这行得通吗？切片代码并找到错误，或获取堆栈跟踪，我们无能为力。

# xml - XmlValidationError - 如何获取错误的 xml 行

> ID：13497583
> 
> 赞同：2
> 
> 时间：2012-11-21T16:23:42.100
> 
> 标签：xml, xsd, xml-validation

我有一个非常长的 xml（大约 17000 行）并且当我针对 xsd 验证 thia 时得到一个 xmlvalidationerror。有没有人有想法/工具/最佳实践如何在 xml 中找到错误的部分？我的代码在.net 中。

【解决方案】我使用了以下webapp [http://www.corefiling.com/opensource/schemaValidate.html](http://www.corefiling.com/opensource/schemaValidate.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T04:25:32.020

当您说 17000 行时，这肯定会减慢编辑器的速度。尽管如此，可以尝试通过 XML。不确定是否有不包含行号和列号的错误消息（即使它一次抛出一个错误）。我的意思是通常验证错误消息包含行号和列号。

在这种情况下，我在 Microsoft Visual Studio 或 Notepad++ 中打开 XML 文件，选择漂亮打印选项（以防 XML 未正确对齐）。

根据您使用的验证器，错误消息也可能包含 XPath，在这种情况下，我在 notepad++ 中使用 XPath 评估

Notepad++ 有 XML 工具插件，免费且非常好用。并且可以处理低至几 MB 的文件。

# .net - 是否可以将 Reflection.Emit 用于操作码 stelem.any 和 ldelem.any？

> ID：13497586
> 
> 赞同：8
> 
> 时间：2012-11-21T16:23:51.403
> 
> 标签：.net, reflection, reflection.emit, il, dynamicmethod

所以，我最近做了一些实验，发现 Reflection.Emit 似乎并不支持 ECMA 规范中的所有操作码。缺少 3 个操作码：

*   `ldelem.any`
*   `stelem.any`
*   `no.`（字首）

反射 API 是否不支持这些操作码，或者有什么方法可以生成它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T16:31:19.000

事实上，你可以。

[在http://msdn.microsoft.com/en-us/library/4xxf1410.aspx](http://msdn.microsoft.com/en-us/library/4xxf1410.aspx)有一个精彩的演练

两个重要部分是：

创建通用参数：

```
string[] typeParamNames = {"TFirst", "TSecond"};
GenericTypeParameterBuilder[] typeParams = 
    myType.DefineGenericParameters(typeParamNames);

GenericTypeParameterBuilder TFirst = typeParams[0];
GenericTypeParameterBuilder TSecond = typeParams[1]; 
```

然后创建方法：

```
Type listOf = typeof(List<>);
Type listOfTFirst = listOf.MakeGenericType(TFirst);
Type[] mParamTypes = {TFirst.MakeArrayType()};

MethodBuilder exMethod = 
    myType.DefineMethod("ExampleMethod", 
        MethodAttributes.Public | MethodAttributes.Static, 
        listOfTFirst, 
        mParamTypes); 
```

但是，您应该完全了解它，因为泛型参数以许多不同的方式和部分使用（在方法上、在参数上、作为结果类型、在调用时......）。

-update- 如果您想要 .NET 2 特定版本：http: [//msdn.microsoft.com/en-us/library/4xxf1410%28v=vs.80%29.aspx](http://msdn.microsoft.com/en-us/library/4xxf1410%28v=vs.80%29.aspx)

页面上的下拉菜单允许您选择可以在其中执行此操作的许多版本的框架。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-12T19:14:34.550

我对此发表了评论，但`OpCode.Stelem`至少在.net 4中的指令翻译为`stelem.any`

看到它曾经是您必须对存储在数组中的类型进行编码的情况，并且对于原语有各种`stelem.*`操作码。如果您正在存储引用类型（声明为委托或类的东西），您将使用`stelem.Ref`并且您将使用`Stelem (myType)`值类型（声明为结构或枚举的东西）。

然而，随着泛型的出现，类型参数出现了，它可以是任何它想要的东西。`T`可以是引用类型，也可以是值类型。`stelem.any`为处理这种不寻常的案件而生。但你可能会说，我只能将未装箱的 T 存储到 T 数组中，所以它完全没有意义，我们不能只依赖数组的类型吗？

那么数组的类型也可能是通用的，这会使事情变得相当困难。但更重要的是它的逆运算也有助于验证下一个运算。

```
ldarg.0
ldc.i4.0
ldelem.any !!T 
```

告诉验证者这个堆栈转换之后的下一条指令应该在一个未装箱的 T 上操作，它是通用方法参数。

# binding - 从角度js中的父范围更新子范围的模板

> ID：13497588
> 
> 赞同：0
> 
> 时间：2012-11-21T16:22:55.317
> 
> 标签：binding, angularjs

我有[这个小提琴示例](http://jsfiddle.net/ADukg/1403/)，我试图在不同范围内的 ng-repeat 中设置一个值。这是我试图解决的一个更大问题的一个非常基本的例子。基本上我需要在 ng-repeat 中设置一个变量，以便 Angular 相应地更新模板。问题是模板在子控制器中。所以我使用 $controller injection-able 来访问变量。但是，更新此变量不会导致模板更新。即使我做了一个 scope.$apply()。有人有想法么？我不确定另一种方法可以做到这一点......

```
var myApp = angular.module('myApp', []);

myApp.directive("custdirective", function() {
    return {
        restrict: 'A',
        scope: 'false',
        link: function(scope, element, attr) {
            element.on("click", function() {
            anotherscope.addList();
            });
        }
    }
});

function AnotherController($scope) {
    $scope.listtwo = new Array();
    $scope.addList = function() {
        $scope.listtwo = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
    }
}

function MyCtrl($scope, $controller, $rootScope) {
    anotherscope = $rootScope.$new();
    $scope.anothercontroller = $controller(AnotherController, {
        $scope: anotherscope
    });
}​ 
```

要正确执行此操作，需要创建一项服务。[我在这里](http://jsfiddle.net/ADukg/1412/)更新了正确的方法，或者：

```
var myApp = angular.module('myApp', []);

myApp.factory("mySharedService", function($rootScope) {
    var sharedService = {};
    sharedService.message = '';

    sharedService.prepForBroadcast = function() {
        this.message = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
        this.broadcastItem();
    };
    sharedService.broadcastItem = function() {
        $rootScope.$broadcast('handleBroadcast');
    };

    return sharedService;

});

myApp.directive("custdirective", function() {
    return {
        restrict: 'A',
        scope: 'false',
        link: function(scope, element, attr) {
            element.on("click", function() {
                debugger;
                scope.handleClick();
            });
        }
    }
});

function AnotherController($scope, sharedService) {
    $scope.listtwo = new Array();
    $scope.addList = function() {
        $scope.listtwo = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
    }

    $scope.$on('handleBroadcast', function() {
        $scope.listtwo = sharedService.message;
    $scope.$apply();
    });
}

function MyCtrl($scope, sharedService) {
    $scope.handleClick = function() {
        sharedService.prepForBroadcast();
    };
}

MyCtrl.$inject = ['$scope', 'mySharedService'];        

AnotherController.$inject = ['$scope', 'mySharedService'];​ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T17:03:12.960

像这样传递作用域有点不稳定，而且几乎肯定会破坏 Angular 应用程序的可测试性。

我认为你最好[创建一个服务](http://docs.angularjs.org/guide/dev_guide.services.creating_services)来在你的控制器和你的指令之间进行更改。该服务将包含您希望更新的数组，或者您希望从指令中调用的函数。

恐怕很难写出这样一个服务的例子，因为我真的不明白你的最终目标是什么。

# c++ - c ++中的地图导致错误

> ID：13497593
> 
> 赞同：2
> 
> 时间：2012-11-21T16:24:22.450
> 
> 标签：c++, stl, map

我有头文件。我想要将地图对象添加到其中一个结构中。所以我包括

```
#include<map> 
```

并编译了程序（注意我没有使用地图对象，我只是包含它），我得到了以下错误

```
/usr/include/c++/4.7/bits/stl_map.h:115:28: error: macro "value_compare" requires 2 arguments, but only 1 given
/usr/include/c++/4.7/bits/stl_map.h:733:45: error: macro "value_compare" requires 2 arguments, but only 1 given
In file included from /usr/include/c++/4.7/map:62:0,
                 from ../optimizer_types.h:16,
                 from ../main.cpp:20:
/usr/include/c++/4.7/bits/stl_multimap.h:115:28: error: macro "value_compare" requires 2 arguments, but only 1 given
/usr/include/c++/4.7/bits/stl_multimap.h:656:45: error: macro "value_compare" requires 2 arguments, but only 1 given
In file included from /usr/include/c++/4.7/map:61:0,
                 from ../optimizer_types.h:16,
                 from ../main.cpp:20:
/usr/include/c++/4.7/bits/stl_map.h:113:11: error: invalid use of non-static data member 'std::map<_Key, _Tp, _Compare, _Alloc>::value_compare::comp'
/usr/include/c++/4.7/bits/stl_map.h:116:4: error: from this location
/usr/include/c++/4.7/bits/stl_map.h:116:9: error: '__c' was not declared in this scope
/usr/include/c++/4.7/bits/stl_map.h:116:12: error: a function call cannot appear in a constant-expression
/usr/include/c++/4.7/bits/stl_map.h:116:12: error: expected ';' at end of member declaration
/usr/include/c++/4.7/bits/stl_map.h:116:14: error: expected unqualified-id before '{' token
/usr/include/c++/4.7/bits/stl_map.h: In member function 'std::map<_Key, _Tp, _Compare, _Alloc>::value_compare std::map<_Key, _Tp, _Compare, _Alloc>::value_comp() const':
/usr/include/c++/4.7/bits/stl_map.h:733:46: error: expected primary-expression before ';' token
In file included from /usr/include/c++/4.7/map:62:0,
                 from ../optimizer_types.h:16,
                 from ../main.cpp:20:
/usr/include/c++/4.7/bits/stl_multimap.h: At global scope:
/usr/include/c++/4.7/bits/stl_multimap.h:113:11: error: invalid use of non-static data member 'std::multimap<_Key, _Tp, _Compare, _Alloc>::value_compare::comp'
/usr/include/c++/4.7/bits/stl_multimap.h:116:4: error: from this location
/usr/include/c++/4.7/bits/stl_multimap.h:116:9: error: '__c' was not declared in this scope
/usr/include/c++/4.7/bits/stl_multimap.h:116:12: error: a function call cannot appear in a constant-expression
/usr/include/c++/4.7/bits/stl_multimap.h:116:12: error: expected ';' at end of member declaration
/usr/include/c++/4.7/bits/stl_multimap.h:116:14: error: expected unqualified-id before '{' token
/usr/include/c++/4.7/bits/stl_multimap.h: In member function 'std::multimap<_Key, _Tp, _Compare, _Alloc>::value_compare std::multimap<_Key, _Tp, _Compare, _Alloc>::value_comp() const':
/usr/include/c++/4.7/bits/stl_multimap.h:656:46: error: expected primary-expression before ';' token 
```

作为一个实验，我将包含移动到一个 cpp 文件并且它正在正确编译。

可能是什么原因

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T17:02:02.903

试试这个：

```
#ifdef value_compare
#undefine value_compare // std::map header doesn't like this
#endif
#include <map> 
```

它不是很灵活（或漂亮），但它应该让你通过这个:(

编辑：无论哪种方式，问题都不包括地图，而是定义 value_compare 宏的早期包含/代码。它是C头吗？（我怀疑 C++ 会用这个名称定义一个宏，因为 value_compare 是 C++ 标准库的重要组成部分）。

# exchange-server - 在给定期间的定期约会，MAPI 方式

> ID：13497598
> 
> 赞同：1
> 
> 时间：2012-11-21T16:23:33.957
> 
> 标签：exchange-server, mapi

当您查询 EWS 或 Outlook API 以查找受某些时期限制的定期约会时，您会得到假实例。Exchange 仅保留具有重复模式和例外列表的主实例，如果必须使用 MAPI，则应“解包”此单独约会以手动获取出现次数。那不是问题）我仍然无法治愈的真正痛苦是如何获得在给定期间之外但它们的发生在内部的主要约会，我想避免获得所有定期约会（甚至在给定期间的合理距离内）例如左一年），“拆包”并检查我们日期之间的事件。

当前动作顺序：

*   IMAPITable. 日期限制

*   .SetColumns

*   .QueryRows

    MAPI 接口是否有一些方法或参数可以实现我的目标？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T20:33:54.623

在这里[http://www.pcreview.co.uk/forums/redemption-recurring-activities-t2964080.html](http://www.pcreview.co.uk/forums/redemption-recurring-activities-t2964080.html)我找到了详细的答案：pidLidClipStart 和 pidLidClipEnd 而不是 PR_START/END_DATE 过滤。

# syntax-highlighting - 预格式化 HTML 并在模板中显示

> ID：13497599
> 
> 赞同：3
> 
> 时间：2012-11-21T16:24:41.030
> 
> 标签：syntax-highlighting, markdown, meteor, handlebars.js

我得到了一些降价格式的文本，我想将它返回到我的模板中，以便它可以显示为 html。为此，我定义了一个 Handlebars 助手：

```
Handlebars.registerHelper('markdown_highlight', function (options) {
  var converter = new Showdown.converter();
  var res = '';
  var html =converter.makeHtml(options.fn(this));
  var high = hljs.highlightAuto(html).value;
  res += high;
  return res;
}); 
```

结果是格式化的，但它直接显示为 html：

```
pre><code> class Foo(object): def __init__(self, i, j): self.i, self.j = i, j def __str__(self): return “(%d, %d)” % (self.i, self.j) def __setitem__(self, idx, v): if idx == 0: self.i = v elif idx == 1: self.j = v else: raise RuntimeError(“Index out of bounds [0,1]”) </code></pre> <p>Make a subclass of Foo, named Bar, that implements the special methods <strong>eq</strong> and <strong>repr</strong>, such that the following code works: </p> <pre><code>&amp;gt;&amp;gt;&amp;gt; f = Bar(1,2)age 3 &amp;gt;&amp;gt;&amp;gt; g = Bar(2,2) &amp;gt;&amp;gt;&amp;gt; f == g False &amp;gt;&amp;gt;&amp;gt; g == eval(repr(g)) True &amp;gt;&amp;gt;&amp;gt; g[0] = 1 &amp;gt;&amp;gt;&amp;gt; f == g True </code></pre> 
```

辅助函数中发生的事情并不那么重要，但有人可能会帮助解释我如何确保返回的 html 显示为 html。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T21:39:17.207

你是说html被转义了吗？

如果是这样，请在您的模板中使用`{{{`&`}}}`而不是`{{`& 。`}}`例如。

```
{{{markdown_highlight markdown_snippet}}}` 
```

[https://stackoverflow.com/a/7173159/236564](https://stackoverflow.com/a/7173159/236564)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-22T16:11:26.523

代替

```
return res; 
```

尝试：

```
return new Handlebars.SafeString(res); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-23T02:36:52.747

```
Template['timeline-item'].rendered = ->
d = @find 'code'
if d
    hljs.highlightBlock d 
```

我使用这些代码，这可以使 hljs 工作。

在您的模板中，在 {{{content}}} 中扭曲您的模板上下文。

# mysql - 如何在 MySQL 中禁用 --skip-grant-tables？

> ID：13497601
> 
> 赞同：0
> 
> 时间：2012-11-21T16:24:41.387
> 
> 标签：mysql, sql, jdbc

我正在尝试为我的 OpenGTS 安装初始化数据库。但是，当我运行完成此操作的 shell 脚本时，我收到以下错误：

```
Version: 2.4.5
Database created: gts
[ERROR|DBAdmin.execCommands:843] ==> SQLException: DB grant error [jdbc:mysql://localhost:3306/]
[ERROR|DBAdmin.execCommands:843] Message:   The MySQL server is running with the --skip-grant-tables option so it cannot execute this statement
[ERROR|DBAdmin.execCommands:843] SQLState:  HY000
[ERROR|DBAdmin.execCommands:843] ErrorCode: 1290
[DBAdmin.execCommands:843] java.sql.SQLException: The MySQL server is running with the --skip-grant-tables option so it cannot execute this statement
java.sql.SQLException: The MySQL server is running with the --skip-grant-tables option so it cannot execute this statement
        at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1055)
        at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:956)
        at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3558)
        at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3490)
        at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:1959)
        at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2109)
        at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2642)
        at com.mysql.jdbc.StatementImpl.executeUpdate(StatementImpl.java:1647)
        at com.mysql.jdbc.StatementImpl.executeUpdate(StatementImpl.java:1566)
        at org.opengts.dbtools.DBConnection._executeUpdate(DBConnection.java:961)
        at org.opengts.dbtools.DBConnection.executeUpdate(DBConnection.java:908)
        at org.opengts.dbtools.DBConnection.executeUpdate(DBConnection.java:889)
        at org.opengts.dbtools.DBProvider.grantDBUser(DBProvider.java:2132)
        at org.opengts.dbtools.DBAdmin.execCommands(DBAdmin.java:841)
        at org.opengts.db.DBConfig._main(DBConfig.java:1246)
        at org.opengts.db.DBConfig.main(DBConfig.java:1361) 
```

我认为很明显我需要禁用--skip-grant-tables，但总的来说我对 MySQL 和 SQL 还是陌生的。最近，我按照教程重置了 MySQL 根密码，我相信我通过它启用了 --skip-grant-tables。我已经尝试寻找禁用此功能的解决方案，但没有遇到任何问题。

有谁能帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-01-06T17:15:09.113

只需键入：`mysqladmin shutdown`，然后通过运行命令启动 MySQL 服务：`service mysql start`。

:-)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T16:25:57.823

检查您的 my.cnf 文件，您可能在其中添加了该选项。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-10-14T16:10:58.630

尝试这个：

```
sudo systemctl set-environment MYSQLD_OPTS="" 
```

*（它对我有用。）*

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-21T16:50:12.313

你必须停止服务器并运行它

`mysqld_safe --skip-grant-tables` 由于 root pwd chg

所以停止服务器并正常启动它

# javascript - IE10在页面上找到第一个按钮并在输入提交时触发点击事件

> ID：13497606
> 
> 赞同：8
> 
> 时间：2012-11-21T16:25:01.087
> 
> 标签：javascript, forms, submit, internet-explorer-10

抱歉标题，我知道它很乱，但我不知道如何描述这种情况。

我们有一个输入字段。但没有表单元素。这是代码

```
<input name="search" id="search" onkeypress="SearchBox(this.value);" type="text" value="Search"/>
<input name="searchbutton" align="left" class="okbutton" id="searchbutton" onclick="SearchBox(search.value);" type="button"/> 
```

SearchBox 功能检查键码，如果它是 13（输入按钮字符码）发送搜索请求。此代码在 IE8/9 中有效，但在 IE10 中具有有趣的行为。

页面中间的代码。我们在页面顶部有一个用于登录的按钮元素。

在 IE10 中；

我在输入中输入一个单词并按回车：

*   SearchBox 功能工作，
*   但表现得像登录按钮也被点击，这是一个问题

注意：对不起语言，英语不是我的母语。注 2：删除了 SearchBox() 函数。检查 jsfiddle 链接以获取最新代码。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-11-23T15:33:32.080

另一种解决方案

将您的按钮类型定义为按钮。因为默认类型是提交

```
<button type="button" .... 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-22T16:15:09.023

好吧，Windows7 的 IE10 是一个预发布版本，这似乎是 MS 应该修复的问题之一。无论如何，我不知道为什么会发生这种情况，但我找到了解决该问题的方法：

而不是`button`，使用`<input type="button">`.

[在jsFiddle](http://jsfiddle.net/FtQNA/)进行现场演示。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-30T15:48:29.443

我遇到了同样的问题。将 type="button" 添加到我的所有按钮都有效。<按钮类型="按钮">...

即使我的按钮不在表单中。

从其他测试中，我完成了 IE 10 的工作方式与 Chrome 完全一样。这是我见过的唯一例外。

# python - 创建文件夹中每个文件内容的索引

> ID：13497607
> 
> 赞同：1
> 
> 时间：2012-11-21T16:25:05.763
> 
> 标签：python, search

我正在用 Python 制作一个搜索工具。

它的目标是能够按内容搜索文件。（我们主要谈论的是源文件、文本文件，而不是图像/二进制文件——即使在他们的元数据中搜索会是一个很大的改进）。现在我不使用正则表达式，随意的纯文本。

这部分算法效果很好！

问题是我意识到我主要在相同的几个文件夹中搜索，我想找到一种方法来建立文件夹中每个文件内容的索引。并且能够尽快知道我正在搜索的句子是否在 xxx.txt 中，或者它是否不存在。现在的想法是为每个文件维护一个校验和，使我能够知道它是否包含特定的字符串。

你知道任何接近这个的算法吗？

我不需要 100% 的成功率，我更喜欢小索引而不是 100% 成功的大索引。这个想法是提供一个通用工具。

**编辑**：要清楚，我想搜索文件内容的一部分。因此，对其所有内容进行 md5 散列并将其与我正在搜索的散列进行比较并不是一个好主意；）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T17:10:50.767

这里我使用 whoosh lib 进行搜索/索引.. 上部分是索引文件，下部分是演示搜索..

```
#indexing part

from whoosh.index import create_in
from whoosh.fields import *
import os
import stat
import time

schema = Schema(FileName=TEXT(stored=True), FilePath=TEXT(stored=True), Size=TEXT(stored=True), LastModified=TEXT(stored=True),
                LastAccessed=TEXT(stored=True), CreationTime=TEXT(stored=True), Mode=TEXT(stored=True))

ix = create_in("./my_whoosh_index_dir", schema)
writer = ix.writer()

for top, dirs, files in os.walk('./my_test_dir'):
    for nm in files:
        fileStats = os.stat(os.path.join(top, nm))
        fileInfo = {
            'FileName':nm,
            'FilePath':os.path.join(top, nm),
            'Size' : fileStats [ stat.ST_SIZE ],
            'LastModified' : time.ctime ( fileStats [ stat.ST_MTIME ] ),
            'LastAccessed' : time.ctime ( fileStats [ stat.ST_ATIME ] ),
            'CreationTime' : time.ctime ( fileStats [ stat.ST_CTIME ] ),
            'Mode' : fileStats [ stat.ST_MODE ]
        }
        writer.add_document(FileName=u'%s'%fileInfo['FileName'],FilePath=u'%s'%fileInfo['FilePath'],Size=u'%s'%fileInfo['Size'],LastModified=u'%s'%fileInfo['LastModified'],LastAccessed=u'%s'%fileInfo['LastAccessed'],CreationTime=u'%s'%fileInfo['CreationTime'],Mode=u'%s'%fileInfo['Mode'])

writer.commit()

## now the seaching part
from whoosh.qparser import QueryParser
with ix.searcher() as searcher:
    query = QueryParser("FileName", ix.schema).parse(u"hsbc") ## here 'hsbc' is the search term
    results = searcher.search(query)
    for x in results:
        print x['FileName'] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T16:56:03.027

它不是最有效的，但只是使用 stdlib 和一些工作。sqlite3（如果在编译时启用）支持全文索引。见：[http ://www.sqlite.org/fts3.html](http://www.sqlite.org/fts3.html)

因此，您可以创建一个 [file_id, filename] 表和一个 [file_id, line_number, line_text] 表，并使用它们作为查询的基础。即：有多少文件包含这个词和那一行，哪些行包含这个和这个但不包含等等......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-02-08T18:37:26.530

任何人都想要一个能够搜索文件“某些部分”的工具的唯一原因是因为他们试图做的是分析数据，这些数据对你可以阅读的部分有法律限制。

例如，Apple 能够在发送或接收文本的任何时候识别 iPhone 的 GPS 位置。但是，他们不能合法地做的是将该位置数据与任何可能与您作为个人相关联的东西相关联。

在广泛的范围内，您可以使用这样的模糊数据来跟踪和分析大量数据中的模式。您可以为美国的每部手机分配一个唯一的“虚拟 ID”并记录所有位置移动；之后，您实现了一种检测旅行模式的方法。异常值可以通过其正常旅行模式的偏差来检测。然后，该“元数据”可以与来自外部来源的数据（例如零售地点的名称和位置）相结合。想想您可能能够通过算法检测到的所有情况。就像足球爸爸一样，他在工作、家庭、餐馆和小联盟球场之间行驶了 3 年的相同路线。仅能够搜索文件的一部分仍然提供足够的数据来检测足球爸爸的手机' 独特的签名突然脱离了正常的套路，进入了一家枪店。可能性是无限的。这些数据可以与当地执法部门共享，以增加附近公共场所的街道存在；同时保持手机所有者的匿名性。

如果没有 IggY 正在寻找的方法，在今天的环境中，像上面的示例这样的功能在法律上是不可能的。

另一方面，他可能只是在某些文件类型中寻找某些类型的数据。如果他知道他想在文件的哪个位置搜索他需要的数据，他可以节省主要的 CPU 时间，只读取文件的后半部分或前半部分。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T16:38:35.533

你可以做一个简单的基于名称的缓存，如下所示。如果预计文件内容不会改变，这可能是最好的（最快的）。否则，您可以 MD5 文件内容。我说 MD5 是因为它比 SHA 快，而且这个应用程序似乎对安全性不敏感。

```
from hashlib import md5
import os

info_cache = {}

for file in files_to_search:
    file_info = get_file_info(file)
    file_hash = md5(os.path.abspath(file)).hexdigest()
    info_cache[file_hash]=file_info 
```

# jquery - 简单的 jquery 幻灯片 - 导航多于单张幻灯片时定位错误

> ID：13497614
> 
> 赞同：3
> 
> 时间：2012-11-21T16:25:32.017
> 
> 标签：jquery, jquery-animate, slideshow, margin

这是我的javascript代码：

```
$(document).ready(function() {
    //variables
    var noOfSlides = 8;
    var slideWidth = 702;
    // Skip to a slide in sequence
    function goToSlide (number) {
        marginValue = ((-slideWidth * number) );
        $('#slide_inner_wrapper').stop().animate({'left': marginValue }, {duration: 1000});
    }
    $('#slide_inner_wrapper').width(noOfSlides * slideWidth) + 135; //Initial sizing of wrapper

    // Listeners
    $('.marker').bind('click', function() {
        number = parseInt($(this).attr('id').split('-').slice(1));
        $(this).parent().siblings().removeClass('current');
        $(this).parent().addClass('current');
        goToSlide(number);
    });
}); 
```

我创建了一个小提琴，所以你可以看到我的问题：http: [//jsfiddle.net/jXVR2/1/](http://jsfiddle.net/jXVR2/1/)

您可能需要稍微调整窗口大小......但您可以看到我希望实现的目标！这是一个时间线，点击后会显示特定年份。

如果单击顶部的各个年份，则相应的幻灯片应显示在视图的中心。如果您加载它然后从 2005 一次单击一张幻灯片，这工作正常，但是一旦您跳过多张幻灯片，它就会跳出位置？我认为这与保证金值有关，但事实并非如此——计算很好。我花了几个小时看着它，无法破解它......这可能与定位有关吗？我花了最后一个小时摆弄这个没有解决方案:(

非常感谢任何帮助！我在这里的第一篇文章，所以请善待！谢谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T18:48:06.660

我从 jsfiddle 得到的问题是由于标签的主题标签而出现的`<a href="#2005">`。

当您单击链接时，焦点会转到主题标签，因此动画会变调。

如果您不需要主题标签，您可以将其替换为简单`<a href="#">`的 .

如果您需要主题标签，`return false`请在点击功能的末尾使用，即

```
$('.marker').bind('click', function() {
    number = parseInt($(this).attr('id').split('-').slice(1));
    $(this).parent().siblings().removeClass('current');
    $(this).parent().addClass('current');
    goToSlide(number);
    return false;
}); 
```

# ruby-on-rails-3 - Rails 3 Actionmailer - 如何仅在电子邮件存在时发送

> ID：13497615
> 
> 赞同：0
> 
> 时间：2012-11-21T16:25:32.570
> 
> 标签：ruby-on-rails-3, actionmailer

我有一个 Rails 3 应用程序向多个 (2) 收件人发送电子邮件。第一个收件人是必需的，但第二个不是必需的。如果第二个收件人为空，我会收到错误消息。如果为空，我如何绕过辅助电子邮件而不会出现错误？

```
 def email_approvers(invoice)
    @subject          = 'Invoice Approval Request'
    @body["invoice"]  = invoice
    @recipients       = invoice.approver_email, invoice.alternate_approver_email
    @from             = "..."
    @sent_on          = Time.now
    @headers          = {}    
  end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T17:04:28.503

您应该看到[http://edgeguides.rubyonrails.org/action_mailer_basics.html#complete-list-of-action-mailer-methods（2.3.4](http://edgeguides.rubyonrails.org/action_mailer_basics.html#complete-list-of-action-mailer-methods)向多个收件人发送电子邮件）。您可以使用电子邮件创建一个数组（也许在 Invoice 类中，您可以创建一个返回有效电子邮件数组的方法）。

在邮件中：

```
default :from => "..."

def email_approvers(invoice)
    @data  = invoice    
    mail :to => @data.recipients, :subject => 'Invoice Approval Request'
end 
```

在发票模型中：

```
def recipients
    return alternate_approver_email.nil? ? [approver_email] : [approver_email, alternate_approver_email]
end 
```

--

对于您的情况（如果没有值，它将将该属性设置为**nil ，因此前面的代码将起作用）：**

```
def alternate_approver_email
   self.alternate_approver_email = !self.alternate_approver_username.nil? ? self.alternate_approver_username + "@email.com" : nil
end 
```

# objective-c - NSCell 的意外行为

> ID：13497616
> 
> 赞同：0
> 
> 时间：2012-11-21T16:24:33.500
> 
> 标签：objective-c, cocoa, nscell

我正在实现`NSActionCell`（内部`NSTableView`）的子类，并注意到一些不寻常的事情。如果我`isEditing`在用户单击单元格时设置属性 ( )，则该属性的值会丢失，因为`NSCell`此后不久就会释放。我认为发生这种情况是因为我没有正确处理复制，所以我添加了`copyWithZone`. 现在我看到`copyWithZone`被调用 - 但它是在一个意外的实例上调用的 - 并且该实例上的属性是`NO`- 默认值。每次`copyWithZone`调用时，都会在同一个实例上调用它。

任何人都可以阐明这种行为吗？我正在附加有问题的子类，以及我得到的输出。当用户单击不同的单元格时，我需要做什么才能保留单元格的属性？

```
@interface MyCell : NSActionCell <NSCoding, NSCopying>
{
}

@property (nonatomic, assign) BOOL isEditing;

@end

@implementation MyCell

- (id)init
{
    if ((self = [super init]))
    {
        [self initializeCell];
    }

    return self;
}

- (id)initWithCoder:(NSCoder *)aDecoder
{
    if ((self = [super initWithCoder:aDecoder]))
    {
        [self initializeCell];

        self.isEditing = [[aDecoder decodeObjectForKey:@"isEditing"] boolValue];
        NSLog(@"initWithCoder %ld %i", (NSInteger)self, self.isEditing);
    }

    return self;
}

- (void)encodeWithCoder:(NSCoder *)aCoder
{
    [super encodeWithCoder: aCoder];
    NSLog(@"encode %i", self.isEditing);

    [aCoder encodeObject:[NSNumber numberWithBool:self.isEditing] forKey:@"isEditing"];
}

- (void)dealloc
{
    NSLog(@"dealloc %ld %i", (NSInteger)self, self.isEditing);
    [super dealloc];
}

- (id)copyWithZone:(NSZone *)zone
{
    MyCell *copy;

    if ((copy = [[MyCell allocWithZone:zone] init]))
    {
        copy.isEditing = self.isEditing;
    }

    NSLog(@"copy %ld %i new: %ld", (NSInteger)self, self.isEditing, (NSInteger)copy);

    return copy;
}

- (void)initializeCell
{
    self.isEditing = NO;
}

- (BOOL)startTrackingAt:(NSPoint)startPoint inView:(NSView *)controlView
{
    return YES;
}

- (void)stopTracking:(NSPoint)lastPoint at:(NSPoint)stopPoint inView:(NSView *)controlView mouseIsUp:(BOOL)flag
{
    if (flag)
    {
        self.isEditing = YES;
        NSLog(@"stopTracking %ld %i", (NSInteger)self, self.isEditing);
    }
}

@end 
```

输出（当用户单击单元格时产生）：

```
2012-11-21 08:17:59.544 SomeApp[2778:303] copy 4310435936 0 new: 4310152512
2012-11-21 08:18:00.136 SomeApp[2778:303] stopTracking 4310152512 1
2012-11-21 08:18:00.136 SomeApp[2778:303] dealloc 4310152512 1 
```

再单击一次（在不同的单元格上）：

```
2012-11-21 08:19:24.994 SomeApp[2778:303] copy 4310435936 0 new: 4310372672
2012-11-21 08:19:25.114 SomeApp[2778:303] stopTracking 4310372672 1
2012-11-21 08:19:25.114 SomeApp[2778:303] dealloc 4310372672 1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T17:59:21.940

听起来你想保留这些属性——对吗？

如果您通过将单元格属性存储在模型对象而不是 NSCell 中并让单元格或表格视图委托从模型中获取值来调整设计，您可能会更轻松。

您试图使用此属性实现什么特定行为？

# ios - 使用单例后架构 armv7 的未定义符号

> ID：13497619
> 
> 赞同：0
> 
> 时间：2012-11-21T16:25:44.663
> 
> 标签：ios, xcode

当我尝试使用此代码时：

```
FacebookViewController *manager = [FacebookViewController sharedManager]; 
```

在 .h 中调用共享管理器

```
+ (FacebookViewController *) sharedManager; 
```

我明白了：

```
Undefined symbols for architecture armv7:
  "_OBJC_CLASS_$_FacebookViewController", referenced from:
  objc-class-ref in ContactFBSViewController.o
ld: symbol(s) not found for architecture armv7
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

问题是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T16:31:05.447

当我在 XCode 4.5 中使用较旧的 Facebook iOS SDK 时出现该错误。

当我将 Facebook SDK 更新到 3.1 并使用新的 API 时，我不再收到该错误。

# azure-web-app-service - Azure 网站虚拟子文件夹

> ID：13497620
> 
> 赞同：2
> 
> 时间：2012-11-21T16:25:49.240
> 
> 标签：azure-web-app-service

我想知道在 Azure 网站（共享）中是否可以创建主应用程序的虚拟子文件夹。我想这样做是因为我想在部署期间保护用户创建的一些文件的安全。

现在我使用 IIS，并且我有一个映射到不同目录的虚拟文件夹。所以当我放一个新版本时。（删除所有并放置新文件）我的用户文件是安全的。

我想知道这在 Azure 网站中是否可行（也许是一个建议）？

您将如何处理这种情况？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T16:47:09.517

由于 azure 上的存储可能会被意外删除，因此您应该使用 blob 存储。这是您开始的地方：http: [//www.windowsazure.com/en-us/develop/net/how-to-guides/blob-storage/](http://www.windowsazure.com/en-us/develop/net/how-to-guides/blob-storage/)

# scala - 什么是正确的生产部署的正确 play-mini 项目设置

> ID：13497623
> 
> 赞同：0
> 
> 时间：2012-11-21T16:24:49.383
> 
> 标签：scala, playframework, sbt

除非我遗漏了什么，否则 Play mini 根本不像一个游戏项目。它在 sbt 中运行，你不能使用 play 命令。

[https://github.com/typesafehub/play2-mini](https://github.com/typesafehub/play2-mini)

那么如何将这些东西部署到生产环境中呢？我也尝试过一个罐子和组装，但它对我不起作用

我尝试了 start-script/stage 方法，但它似乎找不到我的主类：

```
sbt
>add-start-script-tasks
>stage

[info] Wrote start script for mainClass := None to /Users/rmedlin/rtbv2/target/start 
```

这是我的 Build.scala。我也尝试过：mainClass in (Compile, stage, run)等多种组合

```
object Build extends Build {
  override lazy val settings = super.settings
  lazy val root = Project(id = "rtbv2", 
base = file("."), settings = Project.defaultSettings).settings(
  resolvers += "Typesafe Repo" at "http://repo.typesafe.com/typesafe/releases/",
  resolvers += "Typesafe Snapshot Repo" at "http://repo.typesafe.com/typesafe/snapshots/",
  libraryDependencies += "com.typesafe" %% "play-mini" % "2.0.1",
  mainClass in (Compile, run) := Some("play.core.server.NettyServer"))
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T23:29:15.107

我的 Build.scala 不正确，我能够使汇编命令正常工作：

```
trait ConfigureScalaBuild {

lazy val typesafe = "Typesafe Repository" at "http://repo.typesafe.com/typesafe/releases/"

lazy val typesafeSnapshot = "Typesafe Snapshots Repository" at "http://repo.typesafe.com/typesafe/snapshots/"

val netty = Some("play.core.server.NettyServer")

def scalaMiniProject(org: String, name: String, buildVersion: String, baseFile:         java.io.File = file(".")) = Project(id = name, base = baseFile, settings =      Project.defaultSettings ++ assemblySettings).settings(
 version := buildVersion,
 organization := org,
 resolvers += typesafe,
 resolvers += typesafeSnapshot,
 logManager <<= extraLoggers(com.typesafe.util.Sbt.logger),
 libraryDependencies += "com.typesafe" %% "play-mini" % "2.0.1",
 mainClass in (Compile, run) := netty,
 mainClass in assembly := netty,
 ivyXML := <dependencies> <exclude org="org.springframework"/> </dependencies>
)
} 
```

# algorithm - 数组中相等元素的最大数量

> ID：13497625
> 
> 赞同：1
> 
> 时间：2012-11-21T16:26:00.383
> 
> 标签：algorithm

我正在解决codeforces实践问题实现的问题。我无法找到有效的解决方案。如何解决以下问题？我只能想到一个蛮力解决方案

Polycarpus 有一个数组，由 n 个整数 a1, a2, ..., an 组成。当数组中的数字匹配时，Polycarpus 喜欢它。这就是为什么他希望数组有尽可能多的相等数字。为此，Polycarpus 多次执行以下操作：

他选择数组 ai、aj (i ≠ j) 的两个元素；他同时将数字 ai 增加 1 并将数字 aj 减少 1，即执行 ai = ai + 1 和 aj = aj - 1。给定的操作恰好改变了两个不同的数组元素。Polycarpus 可以无限次地应用所描述的操作。

现在他想知道如果他执行任意数量的此类操作，他可以​​获得多少相等的数组元素。帮助多卡普斯。

输入 第一行包含整数 n (1 ≤ n ≤ 105) — 数组大小。第二行包含空格分隔的整数 a1, a2, ..., an (|ai| ≤ 104) — 原始数组。

输出打印一个整数——如果他执行任意数量的给定操作，他可以​​获得的最大相等数组元素数。

```
Sample test(s)
input
2
2 1
output
1
input
3
1 4 1
output
3 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T16:27:16.960

求所有元素的总和。

如果总和%n==0 则 n 否则 n-1

编辑：说明：

首先，很容易发现答案是最小值 n-1。它不能更小。

证明：选择您希望作为目标的任何数字。假设最后一个索引n。现在您通过对a1和an应用操作来制作a1 = target。类似地对a2和an等等。所以除了最后一个之外的所有数字一个等于目标。

现在我们需要看到，如果 sum%n==0 则所有数字都是可能的。显然，您可以在这里选择目标作为所有数字的平均值。您可以通过选择值小于平均值的索引和其他索引来应用操作值大于平均值并使其中之一（可能两者）等于平均值​​。

# .net - 如何在 C# 中使用构造函数返回一个值？

> ID：13497626
> 
> 赞同：16
> 
> 时间：2012-11-21T16:26:00.693
> 
> 标签：.net, constructor

我遵循一个约定，我不会在类中使用任何打印语句，但我已经在构造函数中进行了参数验证。请告诉我如何将我在构造函数中完成的验证返回给 Main 函数。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-11-21T16:27:22.697

构造函数确实返回一个值 - 正在构造的类型......

构造函数不应该返回任何其他类型的值。

在构造函数中进行验证时，如果传入的值无效，则应抛出*异常。*

```
public class MyType
{
    public MyType(int toValidate)
    {
      if (toValidate < 0)
      {
        throw new ArgumentException("toValidate should be positive!");
      }
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-21T16:26:38.200

构造函数没有返回类型，但您可以使用`ref`关键字通过引用传递值。最好从构造函数中抛出异常以指示验证失败。

```
public class YourClass
{
    public YourClass(ref string msg)
    {
         msg = "your message";
    }

}    

public void CallingMethod()
{
    string msg = string.Empty;
    YourClass c = new YourClass(ref msg);       
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-07-03T08:40:17.373

使用 Out 参数创建一个构造函数并通过相同的方式发送您的返回值。

```
public class ClassA
{
    public ClassA(out bool success)
    {
        success = true;
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T16:28:54.633

构造函数返回被实例化的类型，如有必要，可以抛出异常。也许更好的解决方案是添加一个静态方法来*尝试*创建类的实例：

```
public static bool TryCreatingMyClass(out MyClass result, out string message)
{
    // Set the value of result and message, return true if success, false if failure
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-21T16:28:24.913

当构造函数接收到无效参数时，通常会抛出异常。然后，您可以捕获此异常并解析它包含的数据。

```
try
{
    int input = -1;
    var myClass = new MyClass(input);
}
catch (ArgumentException ex)
{
    // Validation failed.
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-01-10T16:46:18.923

我认为我的方法也可能有用。需要向构造函数添加公共属性，然后您可以从其他类访问此属性，如下例所示。

```
// constructor
public class DoSomeStuffForm : Form
{
    private int _value;

    public DoSomeStuffForm
    {
        InitializeComponent();

        // do some calculations
        int calcResult = 60;
        _value = calcResult;
    }

    // add public property
    public int ValueToReturn
    {
        get 
        {
            return _value;
        }
    }
}

// call constructor from other class
public statc void ShowDoSomeStuffForm()
{
    int resultFromConstructor;

    DoSomeStuffForm newForm = new DoSomeStuffForm()
    newForm.StartPosition = System.Windows.Forms.FormStartPosition.CenterScreen;
    newForm.ShowDialog();

    // now you can access value from constructor
    resultFromConstructor = newForm.ValueToReturn;

    newForm.Dispose();
} 
```

# ruby-on-rails - 使用 Minitest 和 Devise 进行控制器测试失败

> ID：13497628
> 
> 赞同：3
> 
> 时间：2012-11-21T16:25:03.627
> 
> 标签：ruby-on-rails, ruby, devise, minitest

在使用 Devise 的 Rails 3.28 应用程序中，我设置了一个控制器来检查用户是否使用`if user_signed_in?`. 一旦测试达到这条线，我总是会`undefined method 'authenticate!' for nil:NilClass`出错。我想在没有用户登录的情况下测试一些代码。

我认为我需要根据[此处](https://github.com/plataformatec/devise/wiki/How-To%3a-Controllers-and-Views-tests-with-Rails-3-%28and-rspec%29)的设计 Wiki 中指定的选项设置测试，但是，所有说明都与 rspec 相关。

特别是，我认为我需要具备以下条件才能在 minitest 中工作：

```
RSpec.configure do |config|
  config.include Devise::TestHelpers, :type => :controller
  config.extend ControllerMacros, :type => :controller
end 
```

有没有人成功地设置这个让 Devise 与 minitest 一起工作？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-21T17:05:00.747

将以下内容添加到您的`minitest_helper.rb`文件中：

```
class MiniTest::Rails::ActionController::TestCase
  include Devise::TestHelpers
end 
```

# javascript - 需要解释这个日期处理函数

> ID：13497629
> 
> 赞同：1
> 
> 时间：2012-11-21T16:25:05.780
> 
> 标签：javascript

任何人都可以向我解释下面的代码吗？

例如，我想将今天的日期设置为今天（2012 年 11 月 21 日），将结束日期设置为 12 月 3 日。

这样做的原因是因为我想遍历一个项目列表，确定它们是在“过去”、“现在”还是“未来”，并相应地为它们分配一个类。

我希望这是有道理的！任何帮助都非常感谢和欢迎！

```
function daysTilDate(expiredate){

    expiredate ="12/"+expiredate+"/2012";

    var thisDay=new Date(expiredate);

    var CurrentDate = new Date();

    var thisYear=CurrentDate.getFullYear();

    thisDay.getFullYear(thisYear);

    var DayCount=(thisDay-CurrentDate)/(1000*60*60*24);

    DayCount=Math.round(DayCount);

    return DayCount;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T16:43:44.493

如果要计算到期日期的天数，可以简化如下方法。请注意，如果您不指定考试日期，则以当前日期为考试日期。

```
​function ​daysTilData(expireDate, testDate) {

    if(typeof testDate === "undefined"){
        testDate = new Date(); // now        
    }

    var diff = expireDate - testDate;

    // minus value meaning expired days
    return Math.round(diff/(1000*60*60*24));
}

alert(daysTilData(new Date("12/31/2012")));
// result 40

alert(daysTilData(new Date("12/31/2012"), new Date("1/12/2013")));
// result -12 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T16:47:49.523

我不打算查看代码，但我可以回答您的问题“我想遍历项目列表，确定它们是过去、现在还是未来”。

首先，您要构建目标日期。如果是“现在”，只需使用 new Date()。如果是特定日期，请使用 new Date(dateString)。

其次，JavaScript 中的 Date 对象有各种返回日期特征的成员。您可以使用它来比较日期。所以，假设你有一个数组中的日期字符串：

```
function loopDates(targetDateString, myDates) {
    var targetDate, nextDate, status, ix;
    targetDate = new Date(targetDateString);
    for (ix = 0;  ix < myDates.length;  ++ix) {
        nextDate = new Date(myDates[ix]);
        if (nextDate.getFullYear() < targetDate.getFullYear()) {
             status = "past";
        } else if (nextDate.getFullYear() > targetDate.getFullYear()) {
             status = "future";
        } else {
            // Year matches, compare month
            if (nextDate.getMonth() < targetDate.getMonth()) {
                status = "past";
            } else if (nextDate.getMonth() > targetDate.getMonth()) {
                status = "future";
            } else {
                // Month matches, compare day of month
                if (nextDate.getDate() < targetDate.getDate()) {
                    status = "past";
                } else if (nextDate.getDate() > targetDate.getDate()) {
                    status = "future";
                } else {
                    // Day matches, present
                    status = "present";
                }
            }
        }
        console.log("Date " + myDates[ix] + " is " + status + " from " + targetDateString);
    }
}

loopDates("11/17/2012", ["11/16/2012", "11/17/2012", "11/18/2012"]); 
```

这将记录：

```
Date 11/16/2012 is past from 11/17/2012
Date 11/17/2012 is present from 11/17/2012
Date 11/18/2012 is future from 11/17/2012 
```

在这里工作[jsFiddle](http://jsfiddle.net/udCTz/1/)。

如果您想使用综合的 Date 类，请使用[DateJS](http://code.google.com/p/datejs/)，这是一个开源 JavaScript 日期和时间处理库，具有一些令人印象深刻的特性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T16:40:11.443

这是逐行解释。

函数声明...

```
function daysTilDate(expiredate){ 
```

采用参数 expiredate 将其设置为与前面附加“12/”和附加“/2012”的相同值。因此，如果 expiredate 的值为“10”，则新值现在为“12/10/2012”...

```
expiredate ="12/"+expiredate+"/2012"; 
```

使用 expiredate 字符串实例化一个名为 thisDay 的新 Date 对象...

```
var thisDay=new Date(expiredate); 
```

使用默认构造函数实例化一个名为 CurrentDate 的新 Date 对象，该构造函数将值设置为今天的日期...

```
var CurrentDate = new Date(); 
```

仅从 CurrentDate 获取 Year 段（之前设置为今天的日期）...

```
var thisYear=CurrentDate.getFullYear(); 
```

从 thisDay 获取 Year 段（之前设置为“2012”）...

```
thisDay.getFullYear(thisYear); 
```

获取 thisDay 和 CurrentDate 之间的差异，以毫秒为单位，并将其乘以 1000*60*60*24 以获得天数的差异...

```
var DayCount=(thisDay-CurrentDate)/(1000*60*60*24); 
```

舍入先前计算的差异...

```
DayCount=Math.round(DayCount); 
```

返回今天与 2012 年 12 月传入的日期之间的差异...

```
return DayCount; 
```

}

请注意，获取年份段的 2 行是无关的，因为这些值从未使用过......

# cordova - 如何使用phonegap拨打电话？

> ID：13497633
> 
> 赞同：0
> 
> 时间：2012-11-21T16:25:18.040
> 
> 标签：cordova

我有一些从模拟器中读取的联系人。我想知道如何拨打电话。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T16:30:58.537

您只需要使用 tel: 协议创建一个 href：

```
<a href="tel:18005551212">Directory Assistance</a> 
```

然后，当用户点击链接时，拨号器应用程序将启动。

# iphone - iOS6 AVAudioPlayer - AAC 音频文件持续时间总是返回 0

> ID：13497634
> 
> 赞同：3
> 
> 时间：2012-11-21T16:26:23.000
> 
> 标签：iphone, ios6, avaudioplayer

我正在将一个适用于 aac 音频文件的应用程序移植到 iOS6，我发现了一个奇怪的行为，当我尝试获取（有效）aac 音频文件的持续时间时，它总是返回 0，在 iOS4 和 iOS5 中它可以工作美好的。

¿ AvAudioPlayer 类上是否存在影响*持续时间*属性的错误？我已经阅读了有关*currentTime*属性的一些问题。

这是代码：

```
NSURL* urlFichero = [NSURL fileURLWithPath:rutaFichero];
avaPlayer = [[AVAudioPlayer alloc] initWithContentsOfURL: urlFichero error:nil];
segundos = avaPlayer.duration;
NSLog(@"[ControladorFicheros] Fichero: '%@' Duración: '%f'", nombreFichero, segundos);
[avaPlayer stop];
[avaPlayer release]; 
```

谢谢 ;）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-18T09:17:48.147

最后的问题是，在最新版本的 API 中，AVAudioPlayer 似乎只在准备好播放文件时才返回文件的正确持续时间，这就是为什么我的解决方案是错误的，获取文件持续时间的正确方法（在秒）如果你不想重现它是：

```
AVURLAsset *asset = [[[AVURLAsset alloc] initWithURL:anURI_ToResource 
                  options:[NSDictionary dictionaryWithObjectsAndKeys:
                  [NSNumber numberWithBool:YES], 
                  AVURLAssetPreferPreciseDurationAndTimingKey,
                  nil]] autorelease];

 NSTimeInterval durationInSeconds = 0.0;
if (asset) 
     durationInSeconds = CMTimeGetSeconds(asset.duration) ; 
```

> 迅速

```
let asset = AVURLAsset(url: url, options: [AVURLAssetPreferPreciseDurationAndTimingKey: true])
let durationInSeconds = CMTimeGetSeconds(asset.duration) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T04:46:27.083

I noticed the same problem. My solution is to use instead.

```
MPMoviePlayerController *testPlayer = [[MPMoviePlayerController alloc] initWithContentURL:filePath];
[testPlater prepareToPlay];
[testPlater play]; 
```

# c# - Visual Studio C# 单元测试 - 使用不同/多个测试初始化 运行单元测试，多次运行相同的单元测试？

> ID：13497638
> 
> 赞同：7
> 
> 时间：2012-11-21T16:25:32.393
> 
> 标签：c#, visual-studio, unit-testing, vs-unit-testing-framework

我想做的是：

1.  创建一堆单元测试。
2.  创建模拟、输入变量等初始化的各种不同排列/组合。
3.  使用基于某些参数的一组此类初始化运行每个给定的单元测试。

我将如何去做这样的事情？

是否已经有任何框架来处理这个问题（即在更改初始化时多次运行给定的测试）？你能提出任何设计或想法，我可以用它来做这件事吗？

**我知道单元测试框架的工作原理。**我使用 NUnit 和 Rhino 模拟自己。

下面显示的是我需要的示例。

```
[Test Initialize]
Setup( <-possible parameter-> )

[Test Method]
TestA() 
```

现在我希望 TestA() 运行多次。每次测试初始化​​都会选择另一个初始化组合。

***更多说明***

假设一个测试需要变量 A、B、C。它们中的每一个都是非常复杂的对象，最终结果是可以形成大量的组合。所以我希望我能以某种方式创建一个可以迭代此类组合列表的测试初始化​​，因此它将初始化它们，运行 TESTA，返回到列表中的下一个初始化，再次运行 TESTA，依此类推，直到清单用完了。接下来，它为 TESTB 选择另一个列表并再次遵循此过程。

至少我希望能够运行给定的 TEST 函数 n 次。其余的我知道我可以建造

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-21T18:27:57.833

在 nUnit 中，您可以将 [TestCase] 属性用于简单类型：

```
[Test]
[TestCase("a", "b")]
[TestCase("c", "b")]
[TestCase("a", "d")]
public void TestMethod(string param1, string param2){
   // run your test with those parameters
} 
```

或者您可以对复杂类型使用[TestCaseSource](http://nunit.org/index.php?p=testCaseSource&r=2.5)方法：

```
[Test]
[TestCaseSource("GetTestCases")]
public void TestMethod(MyObject1 param1, MyObject2 param2){
   // run your test with those parameters
}

private IEnumerable GetTestCases(){
   yield return new TestCaseData( new MyObject1("first test args"), 
                                  new MyObject2("first test args"))
                        .SetName("SomeMeaningfulNameForThisTestCase" );
   yield return new TestCaseData( new MyObject1("2nd test args"), 
                                  new MyObject2("2nd test args"))
                        .SetName("SomeMeaningfulNameForThisTestCase2" );

} 
```

您可以使用数据源在 MS-Test 中执行类似操作：http: [//codeclimber.net.nz/archive/2008/01/18/How-to-simulate-RowTest-with-MS-Test.aspx](http://codeclimber.net.nz/archive/2008/01/18/How-to-simulate-RowTest-with-MS-Test.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-21T17:30:21.770

通过创建一个包含所有测试函数的抽象基类，然后用多个类继承该基类，每个类都有自己的设置函数，您也许可以在不需要任何特定于框架的插件的情况下做到这一点。

```
公共抽象类 MyTests
{
    [测试]
    公共无效TestOne（）
    {
        ...
    }

    [测试]
    公共无效TestTwo（）
    {
        ...
    }
}

```

```
[测试夹具]
公共类 FirstSetup : MyTests
{
    [设置]
    公共无效设置（）
    {
        ...
    }
}

[测试夹具]
公共类 SecondSetup : MyTests
{
    [设置]
    公共无效设置（）
    {
        ...
    }
}

```

我已经用其他语言做到了这一点，但不确定各种 C# 框架将如何处理它。

# javascript - 扫描和文本 PDF：Web 应用程序中的并行滚动和选择

> ID：13497639
> 
> 赞同：3
> 
> 时间：2012-11-21T16:25:35.277
> 
> 标签：javascript, html, pdf, canvas

我目前正在开发一个应用程序，用于从 1950 年代用阿拉伯文书写的马来西亚杂志中提取信息。为了分析内容并找到与其他文件的链接，整个阿拉伯文集已被扫描并转换为拉丁文。

因此，我有两套 PDF，一套是阿拉伯文字的扫描文档图像，另一套是文本格式的拉丁音译。我希望能够并排比较每个 PDF。为此，我希望将两个 PDF 的卷轴锁定在一起。

此外，我希望用户能够在任一文档中选择一些文本，并将此选择反映在第二个文档中。通过这样做，选定的拉丁文本可用于查询附件内容的多个数据库。如下图所示，即使无法直接选择扫描文档中的文本，段落在每个 PDF 中的位置也大致相同（就像在镜子中一样，因为阿拉伯语是从右到左书写的）。

![界面样机](../Images/9f41454a4cc650832b2ffbddc75ec54c.png)

我一直在寻找技术解决方案，目前我最好的方法是使用两个画布并监听选择和滚动事件以将它们反映在另一侧。我玩过[pdf.js](http://mozilla.github.com/pdf.js/ "pdf.js")，它似乎可以帮助我显示 PDF 并同时收听由用户操作触发的事件。问题是这个库的文档非常稀缺，而且它似乎仍处于早期阶段，即使有非常频繁的更新。

您知道任何更好的解决方案可以让我轻松实现这样的系统吗？请考虑以下限制：

*   该系统应该可供最大数量的人使用，并且能够连接到外部数据库，因此需要在线。
*   理想情况下，它应该适用于大多数浏览器，特别是 Chrome、IE 8 和 Firefox 4，因为它们是马来西亚最常用的浏览器（[来源：gs statcounter](http://gs.statcounter.com/#browser_version_partially_combined-MY-yearly-2010-2011)）
*   使用的称为 Jawi 的阿拉伯文字不是标准的阿拉伯文，不能提交给 OCR，因为甚至没有任何标准编码（某些字符甚至在 Unicode 中不可用）

预先感谢您的回答。

# ios - 如何动画层距离查看器 - 用户 - 相机随视角变化？

> ID：13497651
> 
> 赞同：1
> 
> 时间：2012-11-21T16:27:07.390
> 
> 标签：ios, ios5, animation, core-animation

我正在尝试制作一个与 Air bnb iOS 应用程序开头的动画非常相似的动画。

这是动画的视频：[视频](http://www.youtube.com/watch?v=E_RlPZYIpIY)

这个想法是模拟一个层从非常靠近用户飞到最后粘在远处的表面上。

我读过一些关于操纵 的文章，`layer.transform.m34`而对我帮助更大的是[这篇](http://milen.me/technical/core-animation-3d-model/)文章。

通过在 z 轴上应用透视和平移，我设法让图层看起来更大。

这是我使用的代码：

```
CALayer *aLayer = [CALayer layer];
aLayer.frame = ...
aLayer.backgroundColor = ...
CATransform3D perspectiveTransform = CATransform3DIdentity;
perspectiveTransform.m34 = 1.0f/-250.0f;
perspectiveTransform.m44 = 0.0f;
perspectiveTransform = CATransform3DTranslate(perspectiveTransform, 0.0f, 0.0f. -100.0f);
aLayer.transform = perspectiveTransform; 
```

问题是我无法让它动画回到`CATransform3DIdentity`. 我不习惯 CoreAnimation，所以我可能正在尝试一种不好的方法。如果有人能指出我做错了什么或更好的解决方案，那将有很大帮助。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T20:50:42.127

您需要先创建图层并将其添加到图层树中。一旦图层成为图层树的一部分，那么隐式动画应该可以工作。

我认为您可能需要这样做：

创建图层 将图层添加到父图层使用 performSelector:withObject:afterDelay: 运行剩余的动画代码，因此系统有机会在执行隐式动画的代码运行之前将图层添加到图层。

# node.js - Socket.io 断开连接和redis

> ID：13497654
> 
> 赞同：3
> 
> 时间：2012-11-21T16:27:19.327
> 
> 标签：node.js, redis, socket.io, scalability

我试图通过从保存我所有数据的常规数据结构切换到使用 redis 和集群来扩展我的 socket.io 应用程序。但是，我遇到了一些问题，因为在当前实现的某个时刻，我将套接字对象与其他属性一起存储在此数据结构`data[socket.id].socket = socket`中，因为在我的应用程序中，有时我需要`data[someId].socket.disconnect()`手动断开套接字。

我知道我不能将对象直接存储到redis中，所以我尝试使用`JSON.stringify(socket)`没有成功，因为`socket`它是循环的。是否有另一种方法可以仅使用 断开套接字`id`？这样我就可以存储`id`这样的东西`data[socket.id].id = socket.id`，也许可以称之为类似的`data[someId].id.disconnect()`东西。所以基本上我正在寻找一种方法来断开套接字而无需访问实际的套接字对象（我确实可以访问该`io`对象）。

谢谢大家的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-22T19:45:42.107

似乎这已经完成但没有记录在任何地方......`io.sockets.clients(someId)`无论在哪个实例上调用它都获取套接字对象，因此唯一需要的是使用`io.sockets.clients(someId).disconnect()`并实际断开客户端，无论它连接的实例如何至。我实际上不需要将它们存储在我自己的阵列上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-11-20T02:58:11.710

[在 nodejs、 pm2](https://github.com/Unitech/pm2)和[socket.io-redis](https://github.com/socketio/socket.io-redis)前面使用[nginx](https://github.com/nginx/nginx)。

**NGINX.conf**

```
 server {
        server_name                         www.yoursite.io;
        listen                              443 ssl http2;
        listen                              [::]:443 ssl http2;

        location / {
            proxy_set_header                X-Real-IP $remote_addr;
            proxy_set_header                X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header                Host $http_host;
            proxy_set_header                X-NginX-Proxy false;
            proxy_redirect                  off;
            proxy_http_version              1.1;
            proxy_set_header                Upgrade $http_upgrade;
            proxy_set_header                Connection "upgrade";
            proxy_pass                      http://[::1]:4000;
        }
   } 
```

**PM2** 运行集群模式，四个实例...

`pm2 start app.js -i 4`

**应用程序.js**

```
console.clear()
require('dotenv').config()
const express = require('express'),
  app = express(),
  Redis = require('ioredis')
if(process.env.debug === 'true')
  app.use(require('morgan')(':method :url :status :res[content-length] - :response-time ms'))
app.locals = Object.assign(app.locals, {
  sock_transports: ['websocket', 'xhr-polling'],
  sock_timeout: process.env.sock_timeout,
  title: process.env.title,
  meta_desc: process.env.meta_desc,
  app_url: ['https://', process.env.app_subdomain, '.', process.env.app_domain].join('')
})
app.set('functions', require('./lib/functions')(app))
app.set('view engine', 'hbs')
app.set('view cache', false)
app.engine('hbs', require('./lib/hbs')(require('express-handlebars')).engine)
app.use(express.json({
  type: [
    'json'
  ]
}), express.urlencoded({
  extended: true
}))
const redis = new Redis({
  path: process.env.redis_socket,
  db: 1,
  enableReadyCheck: true
})
console.time('Redis')
redis.on('ready', () => {
  console.timeEnd('Redis')
  app.set('redis', redis)
})
redis.on('error', err => {
  console.log('Redis: ' + app.get('colors').redBright(err))
  exitHandler()
})
function loadSessionMiddleware() {
  const session = require('express-session'),
    RedisSession = require('connect-redis')(session),
    client = new Redis({
      path: process.env.redis_socket,
      db: 5
    }),
    ua = require('useragent')
  ua(true)
  app.set('useragent', ua)
  app.set('session_vars', {
    secret: process.env.session_secret,
    name: process.env.session_name,
    store: new RedisSession({
      client
    }),
    rolling: true,
    saveUninitialized: true,
    unset: 'destroy',
    resave: true,
    proxy: true,
    logErrors: process.env.debug === 'true',
    cookie: {
      path: '/',
      domain: '.' + process.env.app_domain,
      secure: true,
      sameSite: true,
      httpOnly: true,
      expires: false,
      maxAge: 60000 * process.env.session_exp_mins,
    }
  })
  app.set('session', session(app.get('session_vars')))
  app.use(
    app.get('session'),
    require('./middleware')(app)
  )
  loadControllers()
}
function loadControllers() {
  require('fs').readdirSync('./controllers').filter(file => {
    return file.slice(-3) === '.js'
  }).forEach(file => {
    require('./controllers/' + file)(app)
  })
  app.get('*', (req, res) => {
    app.get('functions').show404(req, res)
  })
  initServer()
}
function initServer() {
  console.time('Server')
  const server = require('http').createServer(app)
  server.on('error', err => {
    console.err('express err: ' + err)
    app.get('functions').stringify(err)
  })
  server.listen(process.env.app_port)
  app.set('server', server)
  require('./websocket').listen(app, websocket => {
    console.timeEnd('Server')
    app.set('websocket', websocket)
    // www-data
    process.setuid(process.env.app_uid)
  })
}
console.time('Database')
require('./model').load(app, db => {
  console.timeEnd('Database')
  app.set('model', db)
  loadSessionMiddleware()
})
function exitHandler() {
  if(app.get('server'))
    app.get('server').close()
  if(app.get('redis'))
    app.get('redis').quit()
  if(app.get('mail'))
    app.get('mail').close()
  process.exit(0)
}
process.on('SIGINT SIGUSR1 SIGUSR2', () => {
  exitHandler()
})
process.stdin.resume() 
```

**websocket.js**

```
var exports = {}
exports.listen = (app, cb) => {
  const websocket = require('socket.io')(app.get('server'), {
    transports: process.env.transports
  }),
  req = {}
  websocket.setMaxListeners(0)
  websocket.adapter(require('socket.io-redis')({
    path: process.env.redis_socket,
    key: 'socket_io',
    db: 2,
    enableOfflineQueue: true
  }))
  websocket.use((socket, next) => {
    app.get('session')(socket.request, socket.request.res || {}, next)
  })
  websocket.isAccountLocked = cb => {
    if(!req.session.user_id) {
      cb(false)
      return
    }
    if(isNaN(req.session.user_id)) {
      cb(false)
      return
    }
    app.get('model').users.get(req.session.user_id, user_rec => {
      if(!user_rec) {
        cb(false)
        return
      }
      if(user_rec.account_locked === 'yes') {
        websocket.showClient(client => {
          app.get('model').users.logout(req.session, () => {
            console.log(client + ' ' + app.get('colors').redBright('Account Locked'))
            cb(true)
          })
        })
        return
      }
      cb(false)
    })
  }
  websocket.showClient = cb => {
    var outp = []
    if(!req.session.user_id && !req.session.full_name)
      outp.push(req.session.ip)
    if(req.session.user_id) {
      outp.push('# ' + req.session.user_id)
      if(req.session.full_name)
        outp.push(' - ' + req.session.full_name)
    }
    cb(app.get('colors').black.bgWhite(outp.join('')))
  }
  websocket.on('connection', socket => {
    if(!socket.request.session)
      return
    req.session = socket.request.session
    socket.use((packet, next) => {
        websocket.isAccountLocked(locked => {
            if(locked)
                return
            var save_sess = false
            if(typeof(socket.handshake.headers['x-real-ip']) !== 'undefined') {
          if(socket.handshake.headers['x-real-ip'] !== req.session.ip) {
            req.session.ip = socket.handshake.headers['x-real-ip']
            save_sess = true
          }
        }
        var ua = app.get('useragent').parse(socket.handshake.headers['user-agent']).toString()
        if(ua !== req.session.useragent) {
          req.session.useragent = ua
          save_sess = true
        }
            websocket.of('/').adapter.remoteJoin(socket.id, req.session.id, err => {
                delete socket.rooms[socket.id]
                if(!save_sess) {
            next()
            return
          }
                req.session.save(() => {
                  next()
                })
            })
      })
    })
    socket.on('disconnecting', () => {
      websocket.of('/').adapter.remoteDisconnect(req.session.id, true, err => {
      })
    })
    socket.on('auth', sess_vars => {
      function setSess() {
        if(sess_vars.path)
          req.session.path = sess_vars.path
        if(sess_vars.search_query)
          req.session.search_query = sess_vars.search_query
        if(sess_vars.search_query_long)
          req.session.search_query_long = sess_vars.search_query_long
        if(sess_vars.dispensary_id)
          req.session.dispensary_id = sess_vars.dispensary_id
        if(sess_vars.city)
          req.session.city = sess_vars.city
        if(sess_vars.state)
          req.session.state = sess_vars.state
        if(sess_vars.zip)
          req.session.zip = sess_vars.zip
        if(sess_vars.country)
          req.session.country = sess_vars.country
        if(sess_vars.hash)
          req.session.hash = sess_vars.hash
        req.session.save(() => {
          websocket.to(req.session.id).emit('auth', sess)
          app.get('functions').showVisitor({
            session: sess
          }, {
            statusCode: 200
          })
        })
      }
      setSess()
    })
    socket.on('logout', () => {
      var sess_ip = req.session.ip,
        sess_id = req.session.id,
        sess_email = req.session.email
      app.get('model').users.logout(req.session, () => {
        websocket.showClient(client => {
          console.log(client + ' - Logged Out')
        })
      })
    })
  })
  cb(websocket)
}
module.exports = exports 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T17:35:38.630

我做类似的事情是这样的：

```
var connTable = {};
function onConnection(socket) {
  connTable[socket.id] = socket;

  socket.on("close", function(data, callback) {
    socket.disconnect();
    onDisconnect(socket.id);
  });

  socket.on('disconnect', function(){
    onDisconnect(socket.id);
  });
}

function manuallyDisconnect(socket_id) {
  connTable[socket_id].disconnect();
}

function onDisconnect() {
  //closing process, or something....
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-03-12T22:53:26.737

从 socket.io-redis 的文档中，您需要使用`remoteDisconnect`：

```
io.of('/').adapter.remoteDisconnect(socketId, true, (err) => {
            if (err) {
              console.log('remoteDisconnect err:', err);
            }
        }); 
```

# ios - 从 iTunes (PhoneGap) 检索托管内容

> ID：13497660
> 
> 赞同：2
> 
> 时间：2012-11-21T16:26:24.873
> 
> 标签：ios, cordova, in-app-purchase, phonegap-plugins

是否有任何专为 PhoneGap 设计的库来从 iTunes（应用内购买）检索托管内容数据？我在没有任何运气的情况下尝试 InAppPurchaseManager，可能不足以满足我的目的。谢谢

# html - HTML 标记在条件内时关闭

> ID：13497663
> 
> 赞同：-1
> 
> 时间：2012-11-21T16:26:36.223
> 
> 标签：html, node.js, express, pug

我对翡翠有点问题。这是以下代码：

```
 each user in users
                - if (user.valid == 1)
                    tr(style="color:green;")
                - else
                    tr(style="color:red;")

                        td
                            = user.mail
                        td
                            = user.lastIp
                        td
                            = user.token
                        td
                            = user.valid 
```

我的问题是 tds 仅在 else 情况下创建。如果 if (user.valid == 1) 为真，那么它会创建一个空的 tr。

有没有办法可以用这种条件创建我的 tr ，然后只填充它们？

谢谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T16:58:16.250

**您的代码翻译为：**

```
-if (user.valid == 1)
    <tr style="color:green;" />
-else
    <tr style="color:red;" >
        td
            = user.mail
        td
            = user.lastIp
        td
            = user.token
        td
            = user.valid
    </tr> 
```

**您应该将其替换为：**

```
-if (user.valid == 1) {
    tr(style="color:green;")
-} else {
    tr(style="color:red;")
-}

        td
            = user.mail
        td
            = user.lastIp
        td
            = user.token
        td
             = user.valid 
```

祝你好运！晒

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T16:33:50.480

不确定这是否是最好的方法，但我创建了一个变量来存储我的颜色，这是我的解决方案：

```
 - if (user.valid == 1) {
                    - color = "green";
                - } 
                - else {
                    - color = "red";
                - }

                    tr(style="color:#{color};") 
```

# sharepoint - 打开 SharePoint 文档库时出现 NullreferenceException

> ID：13497665
> 
> 赞同：2
> 
> 时间：2012-11-21T16:26:46.043
> 
> 标签：sharepoint, sharepoint-2010, nullreferenceexception, document-library, sharepointdocumentlibrary

在 SharePoint 2010 中运行配置向导（由于权限问题必须这样做）后，我无法打开任何文档库，如“页面”。我收到以下错误：

```
[NullReferenceException: Object reference not set to an instance of an object.]
Microsoft.Office.Server.Administration.UserProfileApplicationProxy.get_ApplicationProperties() +134
   Microsoft.Office.Server.Administration.UserProfileApplicationProxy.get_PartitionIDs() +44
   Microsoft.Office.Server.Administration.UserProfileApplicationProxy.IsAvailable(SPServiceContext serviceContext) +329
   Microsoft.Office.Server.WebControls.MyLinksRibbon.get_PortalAvailable() +44
   Microsoft.Office.Server.WebControls.MyLinksRibbon.EnsureMySiteUrls() +60
   Microsoft.Office.Server.WebControls.MyLinksRibbon.get_PortalMySiteUrlAvailable() +15
   Microsoft.Office.Server.WebControls.MyLinksRibbon.OnLoad(EventArgs e) +91
   System.Web.UI.Control.LoadRecursive() +65
   System.Web.UI.Control.LoadRecursive() +190
   System.Web.UI.Control.LoadRecursive() +190
   System.Web.UI.Control.LoadRecursive() +190
   System.Web.UI.Control.LoadRecursive() +190
   System.Web.UI.Control.LoadRecursive() +190
   System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +2427 
```

可以毫无问题地打开“正常”列表。我已停用并重新激活“SharePoint Server Publishing”和“SharePoint Server Publishing Infrastructure”

任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T16:42:54.980

它可能与 User Profile Service 应用程序有关。

看这里： http: [//www.codeproject.com/Articles/475253/Object-null-reference-error-when-opening-the-Site](http://www.codeproject.com/Articles/475253/Object-null-reference-error-when-opening-the-Site)

根据这篇文章，删除用户配置文件服务应用程序可以修复错误。

# file - MATLAB 错误：“以前似乎被用作函数或命令”

> ID：13497668
> 
> 赞同：0
> 
> 时间：2012-11-21T16:26:54.683
> 
> 标签：file, matlab, min, mean, standard-deviation

我想创建一个名为 E7stats 的函数，它对包含在 csv 文件中的第一个期中考试的分数进行简单的统计分析。该函数接受一个字符串输入，filename，它是 csv 文件的名称，并返回一个输出，一个 1⇥2 结构数组 S ，其两个条目都包含四个字段 mean、std ev、max 和 min，分别是电子和纸质期中成绩的平均值、标准差、最大值和最小值。该函数还使用 30 个大小相同的 bin 创建两个中期 1 分数的两个直方图。电子和纸质期中 1 的分数存储在 CSV 的第一列和第二列中

我的问题是我收到错误：

“mean”以前似乎被用作函数或命令，与这里用作变量名相冲突。此错误的一个可能原因是您忘记初始化变量，或者您已使用 load 或 eval 隐式初始化它。

我知道为什么我会收到错误，但我不知道如何解决它，因为如上所述，我的变量需要命名为均值、最小值、最大值。欢迎任何建议。谢谢！

```
function S= E7stats(filename)
filename='grades_E7MT1.csv';
S=csvread(filename,1,0);
stddev = std(S)
mean= mean(S)
min= min(S)
max= max(S) 
```

我问我的导师：

我们必须在结构数组中显示内容，或者它应该只返回结构数组以及带有字段的 '1x2 结构数组：意思是 stddev max，他回答：结构是函数的输出。您不需要在命令窗口中显示它。仅确保它具有正确的字段和值。

所以现在我真的很困惑我的函数应该输出什么？对不起所有的混乱！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T16:59:00.143

不要使用函数名称`mean()`作为变量的名称。调用它`myMean`或类似的东西。

或者，您可以创建一个具有字段名称的结构，例如均值、最小值和最大值：

```
d.mean = mean();
d.min  = min(); 
```

# vba - 使用 HTTP 服务器初始化 DIR() 函数

> ID：13497670
> 
> 赞同：1
> 
> 时间：2012-11-21T16:28:07.687
> 
> 标签：vba

嗨，如果我在 PC 重新启动后运行它，以下行不起作用：

```
Filename = Dir("\\epocal-db-01\qa\docs\shared documents\17000001-*.xlsx") 
```

但如果我先运行这一行，它会：

```
Set Wk = Workbooks.Open(Filename:="http://epocal-db-01/qa/docs/Shared Documents/17000001-00.xlsx", UpdateLinks:=0) 
```

这听起来像是我电脑中的网络映射问题。我可以在不使用（慢）打开方法的情况下映射 Http 服务器吗？我需要声明一个库吗？谢谢！

# nhibernate - nHibernate“没有持久性”更新惰性属性

> ID：13497671
> 
> 赞同：1
> 
> 时间：2012-11-21T16:27:12.740
> 
> 标签：nhibernate, proxy, lazy-loading

我得到了

> “MappingExecption：ProjectNameImportTypeProxy 没有持久性”

在实体上，但**仅在更新它时**。

我的意思是，我创建没有问题的实体。如果我重新加载它并再次保存它，我会得到异常，这意味着映射实际上是正确的..

如果我删除了 lazy="true" 映射选项，我不会收到此错误。

这是映射：

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2"
                   assembly="ProjectName"
                   namespace="Projects.ProjectName.Model">
    <class name="ProjectNameImportType" table="mid_ProjectNameImportTypes">
        <id name="ID" column="ID">
            <generator class="hilo"/>
        </id>

        <property name="Code" length="255" not-null="true" index="idx_ProjectNameImportType_Code"/>
        <property name="Name" length="255" not-null="true" />
        <property name="Description" length="2000" />
        <property name="FilesShare" length="2000" not-null="true" />
        <property name="ZippedAssemblies" lazy="true" type="BinaryBlob" not-null="true" />
        <property name="FileName" length="255" not-null="true" />
    </class>
</hibernate-mapping> 
```

这是课程：

```
 /// <summary>
/// Represents a projectName import type
/// </summary>
[UniqueEntityKey("Code")]
public class ProjectNameImportType : ModelEntityBase
{
    /// <summary>
    /// Get and set code
    /// </summary>
    [Required]
    [StringLength(255)]
    public virtual string Code { get; set; }

    /// <summary>
    /// Get and set name
    /// </summary>
    [Required]
    [StringLength(255)]
    public virtual string Name { get; set; }

    /// <summary>
    /// Get and set description
    /// </summary>
    [StringLength(2000)]
    public virtual string Description { get; set; }

    /// <summary>
    /// Get and set files share
    /// </summary>
    [Required]
    [StringLength(2000)]
    public virtual string FilesShare { get; set; }

    /// <summary>
    /// Get and set zipped assemplies data
    /// </summary>
    [Required]
    public virtual byte[] ZippedAssemblies { get; set; }

    /// <summary>
    /// Get and set filename
    /// </summary>
    [Required]
    [StringLength(255)]
    public virtual string FileName { get; set; }
} 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T18:01:25.727

这种行为的原因隐藏在三个并发设置/事件的组合中：

*   类本身被映射为`lazy`
*   属性`ZippedAssemblies`（*byte[]*）映射为`lazy`
*   实体作为实例被从 NHibernate 会话中驱逐（例如，通过显式 Evict(entity) 或通过将其保持在请求之间的 Web 会话中）。

当所有这些事件一起发生时，*NHibernate*无法更新这样的实体。我们拥有的（在 Evicting 之后）不是*标准*实例，因为支持（很可能）大型属性的延迟加载`ZippedAssemblies`

有一些可能的情况如何实现这一点，但我只建议一个：

> 每当您想更新此实体时，请重新加载它 (Session.Get(ID)) 并使用新值更改其属性。始终将实体保持在 NHibernate 会话中（没有 Evict() 没有 Session.Close()）。

然后您可以在更改`ZippedAssemblies`或不更改时对其进行更新。这将起作用，并且可以在上述情况下提供帮助。

# regex - 用大写 perl 更改行上的第一个字符

> ID：13497672
> 
> 赞同：24
> 
> 时间：2012-11-21T16:28:13.593
> 
> 标签：regex, perl

我猜这是一个简单的问题，但我试图使用以下命令将行的第一个小写字母从 .txt 文件更改为大写

```
$_ =~ s/^[a-z]/\U/; 
```

当我执行它时，会发生什么，而不是将小写字母更改为大写字母，而是将行首的小写字母替换为行中的最高有效位。例如，该行`nAkld987aBALPaapofikU88`而不是被替换`NAkld987`为`Akld987...`

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-11-21T16:31:47.893

你可以/应该使用`ucfirst`. 我说应该，因为对于维护者来说，你的意图是将字符串的第一个字母大写更明显。我喜欢正则表达式，但在这种情况下，我觉得这不是正确的方法。

```
my $str = "test";
print ucfirst($str); 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2012-11-21T16:32:00.963

您需要`first character`在捕获组中捕获 ，并使用`back reference`将其转换为`uppercase`using `\u`。

尝试使用这个： -

```
$_ =~ s/^([a-z])/\u$1/; 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2012-11-21T16:32:57.300

您可以只使用该`ucfirst`功能。

如果你想使用正则表达式，你可以这样做：

```
$_ =~ s/^([a-z])/\u$1/; 
```

或者

```
$_ =~ s/^([a-z])/\U$1\E/; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-02-26T23:12:15.023

由于对正则表达式不太熟练，我完成了这个`map`（基本上是`foreach`，除了它既迭代一个列表并返回被操纵的列表）：

```
$string = join " ", map { ucfirst } split " ", $string; 
```

# perl - 在 Perl 中访问带有子进程的数组

> ID：13497677
> 
> 赞同：2
> 
> 时间：2012-11-21T16:27:19.643
> 
> 标签：perl, fork

假设我有 5 个文件，名为**a**到**e**。我想并行处理这些。我以为我可以做这样的事情：

```
my @ltrs = ('a'..'e');

for my $fnum (0..2) { 
    $pid = fork();
    if ($pid) {
        push(@childs, $pid);
    }
    elsif ($pid == 0) {
        do {
            my $ltr = shift(@ltrs);
            print "Open file $ltr on $fnum\n";
        } until (scalar(@ltrs)==0);
        exit(0);
    }
    else {
        die "Couldn't fork: $!\n";
    }
}

foreach (@childs) {
    waitpid($_, 0);
} 
```

但是每个子进程都在访问以下所有五个元素`@ltrs`：

```
Open file a on 0
Open file b on 0
Open file c on 0
Open file d on 0
Open file e on 0
Open file a on 1
Open file b on 1
Open file c on 1
Open file d on 1
Open file e on 1
Open file a on 2
Open file b on 2
Open file c on 2
Open file d on 2
Open file e on 2 
```

当一个进程`shift`从数组中获取一个元素时，为什么当下一个进程查看数组时该元素仍然存在？我假设在第一个之后`shift`，接下来发生的任何过程都会找到一个以 开头的数组`b`，但显然我错过了一些东西。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-21T16:32:28.843

数据不在进程之间共享。每个进程都有自己的副本。

如果您想分享，那么整个进程间通信的广阔世界对您开放。perldoc 页面[perlipc](http://perldoc.perl.org/perlipc.html)会告诉您所有相关信息。

如果不需要每个实例的完整进程，那么使用线程是另一种方法。与进程不同，线程可以共享数据（尽管在 Perl 中它们默认不共享）。perldoc 页面[perlthrtut](http://perldoc.perl.org/perlthrtut.html)是这个特定主题的起点。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-21T19:39:48.593

试试这个：

```
use Parallel::ForkManager;

my $max_processes = 3;
my $pm = Parallel::ForkManager->new($max_processes);

my @ltrs = ('a'..'e');

for my $ltr (@ltrs) {
    my $pid = $pm->start and next;

    print "Open file $ltr in $$\n";
    sleep 1;
    $pm->finish;
}
$pm->wait_all_children; 
```

这会为您处理排队，确保一次工作的孩子不超过 3 个；但是，与您的代码不同，它确实为每个字母做了一个单独的分叉。

如果您需要将数据从子级返回给父级，请设置一个 run_on_finish 挂钩，如[https://metacpan.org/module/Parallel::ForkManager#Data-structure-retrieval](https://metacpan.org/module/Parallel::ForkManager#Data-structure-retrieval)所示。

# ios - NSCache 在启动之间是否持续存在？

> ID：13497678
> 
> 赞同：3
> 
> 时间：2012-11-21T16:27:19.900
> 
> 标签：ios, xcode, persistence, archiving, nscache

我正在研究一种相当简单的缓存机制，目前正在使用 NSCache（出于内存管理的原因）。问题是 - 缓存是否在启动之间持续存在？对我来说似乎没有。

我将对象放入缓存中就好了，并且可以在应用程序运行没有问题时将它们从缓存中取出。但是一旦我重新启动，似乎缓存就消失了。

那么有没有办法让缓存在启动之间持续存在？如果是这样，您将如何将缓存从上一个会话重新同步到当前会话？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T16:31:04.993

`NSCache`**在启动之间不会**持续存在 - 如果您想保存缓存，我建议您简单地使用保存数据`CoreData`- 尽管如果内存管理是一个问题，那么您可能会节省太多。这真的取决于你正在开发什么。

# asp.net - Ajax PageMethod 访问页面级私有静态属性

> ID：13497680
> 
> 赞同：1
> 
> 时间：2012-11-21T16:28:23.780
> 
> 标签：asp.net, ajax, webmethod

我有一个使用 Ajax 页面方法的页面。首次加载页面时，系统会提示用户选择年份。这是 PostBack 发生的唯一时间。年份存储在名为 SelectedYear 的私有静态页面级整数属性中。有几种页面方法可以将数据从客户端传递到服务器，但年份始终存储在服务器上，因此不必再次传递。问题是，在某些情况下，在服务器 WebMethod 中，SelectedYear 属性似乎恢复为 0。我可以测试 0 并将错误返回给客户端，但如果我能解释它发生的原因会有所帮助。在这一点上，我不知道。有任何想法吗？我对这种编程风格有点陌生。这是代码的（非常简化的）示例。

这是我的 C# 服务器代码：

```
public partial class Default : System.Web.UI.Page
{
    private static int SelectedYear;

    protected void YearSelected(object sender, EventArgs e)
    {
        if (sender.Equals(btnCurrentYear))
            SelectedYear = 2013;
        else
            SelectedYear = 2014;
    }

    [WebMethod]
    public static bool Save(string FirstName, string LastName)
    {
        try
        {
            if (HttpContext.Current.User.Identity.IsAuthenticated)
                //Right here, SelectedYear is sometimes 0.
                SaveApplication(FirstName, LastName, SelectedYear);
            else
                throw new Exception("User is not logged in.");
        }
        catch (Exception ex)
        {
            throw;
        }
    }
} 
```

这是我的 JavaScript 客户端代码：

```
function Save(FirstName, LastName) {
    PageMethods.Save(firstName, LastName, SaveSucceeded, SaveFailed);
}

function SaveSucceeded(result) {
    //Notify user that save succeeded.
}

function SaveFailed(error) {
    //Notify user that save failed.
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T16:35:05.670

你的问题是这样的：

```
 private static int SelectedYear; 
```

您将要删除`static`. 静态意味着它是全局的，将为所有用户/请求共享......所以当你为一个用户将它设置为 2013 时，另一个用户点击尚未选择年份的页面，它将被设置为 0.. . 对于他们俩。哎呀！

跟踪您的回发以查看在您的 AJAX 方法期间该变量发生了什么。

您应该考虑将值存储在会话变量中，或者可能存储在页面上的隐藏字段中。

更多阅读类似帖子：[ASP.NET C# 静态变量是全局的？](https://stackoverflow.com/questions/1563171/asp-net-c-sharp-static-variables-are-global)

# ruby-on-rails - Rspec、FactoryGirl 和真实样本数据有什么问题？

> ID：13497695
> 
> 赞同：1
> 
> 时间：2012-11-21T16:29:28.070
> 
> 标签：ruby-on-rails, rspec, factory-bot

我一直在学习一些 RoR，当我接触到 TDD 时，事情开始变得更加复杂。在我的应用程序的某个时刻，我认为最好在真实数据上运行我的测试。

## 真实数据与样本数据

在网上搜索，我发现测试并不是要运行真实数据，而是要运行样本数据。但我还是不能同意。

假设我的应用程序有一个**Alias System**。因此，当您访问随机 url 时，它会确定该片段想要什么并重定向到正确的规范 url。让我们补充一下，别名字典存储在某些模型中。我们将如何测试那本词典？每个别名/关键字的硬代码规范文件？

## 坚持真实数据

我意识到但非常不确定的前两件事是：

1.  Rspec 测试环境不会访问开发模型的数据。
2.  FactoryGirl 管理我的测试数据库，因此我不能选择填充它。

作为一个完整的新手，我能想到的最佳解决方案是，我可以在`spec/support`文件夹中创建一些类并在我的工厂中调用它们以获取真实数据。这些类有一个我真实数据库信息的简短样本，嵌套，所以我的测试可以“真实”。

*周围的专业人士可以建议改进它吗？*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-28T01:04:06.563

您当然不应该使用您的开发数据库进行测试。您可以为测试数据库播种，也可以创建反映各种场景的工厂。

*FactoryGirl 管理我的测试数据库，因此我不能选择填充它。*

您可以使用多个工厂来表示一个业务实体，具体取决于所测试的场景。FactoryGirl 允许您嵌套工厂，让这一切变得简单。您可以定义具有一组基本有效属性的工厂，并在单元测试中使用它。对于集成（功能）测试，您可以使用扩展基本属性的嵌套工厂来实现特定场景。您可以根据需要拥有这些特定于实现的工厂的多种变体。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-28T00:17:23.997

我认为您可能想研究构建一个 seed.rb 文件来填充您的数据库。这通常用于初始化开发数据库，​​以便它可以在您的应用程序中使用（并在 rails 控制台中查询），但您可以使用它来为您的测试数据库播种[，如本答案中所述](https://stackoverflow.com/questions/4343435/how-do-i-load-seed-rb-within-a-rails-test-environment-using-rpec)。

# excel - 从 Outlook 电子邮件正文复制超链接并导出到 Excel 或记事本

> ID：13497698
> 
> 赞同：1
> 
> 时间：2012-11-21T16:29:41.243
> 
> 标签：excel, vba, outlook, export-to-excel, onenote

这是我正在寻找的：

> 我在 Outlook 中有 20 个不同的文件夹，每个文件夹都有相同的电子邮件正文结构和格式。每个电子邮件正文都有 3 到 7 个超链接我想导出其中一个超链接（它很容易识别，因为它具有相同的起始/特定单词 - 我们是否导出这个特定超链接或全部都没有关系，因为我们以后可以在 excel 中编辑它们）。
> 
> 我希望将这些超链接导出到 Excel 工作表中的单元格中

我现在在做什么：

我正在使用剪贴板转到每封电子邮件。右键单击复制链接，然后粘贴到记事本或 Excel 中。

让我知道你们是否有任何建议。这将真正简化我的工作......当然还有其他任何可能寻找类似解决方案的人。

问候，

AA

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T12:40:49.200

可以导出到excel，但是在复制到excel之前，

-> 您必须选择存在超链接的电子邮件。通过选择电子邮件右键单击并选择 **发送到一个笔记**。

> ->***一个音符将打开。翻阅 One-note 的此部分（右侧）中的页面选项卡。选择所有邮件（页面）并右键单击->复制*。**

1.  现在您可以将复制的项目粘贴到**记事本**中。
2.  现在您可以将记事本中的所有内容复制到excel中。
3.  您可以找到或应用过滤器，**过滤器->文本过滤器->包含所需的单词或短语（它很容易识别，因为它具有相同的起始/特定单词）**。

4.  如果你直接从**onenote**复制到excel，意味着所有表格、附件等都会被粘贴，那么过滤或查找需要的超链接会很困难。

5.  由于您说的是 20 个文件夹，因此无法将文件夹发送到**onenote**，您需要打开 20 个文件夹，然后您可以在每个文件夹中选择任意数量的电子邮件。

:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-24T19:31:46.110

我无法将我的解决方案放在一个答案中，因为它超出了大小限制。 **这是我回答的第 1 部分。** 我已将一段代码移至第二个答案。

这是一个 VBA 解决方案。你给出了一个很好的规范，所以我相信这将接近你的要求。我希望我已经包含了足够的评论，以便您进行最终调整。如果没有，请问。

第一个代码块包含我为我编写的子例程。他们执行我认为有用的任务。它们包括评论，但它们是为了提醒我他们不帮助别人理解它们而写的评论。我为您编写的宏会使用它们，并且我会解释如何使用它们。目前，我建议您不要担心这些子例程如何完成它们的工作。

我或许应该警告你，我很少在自己的宏中使用错误处理功能，因为我不希望它们优雅地失败；我希望他们停止问题陈述，以便我能够理解并纠正原因。

在 Outlook 中，打开 VBA 编辑器，插入一个模块并将第一个代码块复制到其中。您还需要单击`Tools`then `References`。“Microsoft Excel nn.n 对象库”是否在顶部附近，是否打勾？如果未勾选，您必须滚动完成列表，找到此参考并勾选它。“nn.n”的值取决于您使用的 Excel 版本。只有当您安装了多个版本的 Excel 时，您才有选择的余地。

**答案在代码下方继续。**

*此代码移至答案的第二部分。*

下面是四个宏。前三个是教程，第四个是我的解决方案。

如果您的 Outlook 安装与我的一样，您将拥有文件夹*Personal Folders*、*Archive Folders*，也许还有其他文件夹。在*个人文件夹*中，您将拥有标准文件夹*收件箱*、*发件箱*等。您可能在这些标准文件夹中添加了自己的文件夹，或者您可能已将它们添加到*个人文件夹*中。在我自己的系统上，我有各种文件夹，包括*!Family*和*!Tony*。每个都包含子文件夹和*!Tony*中的子文件夹之一是*Amazon*。

在第一个宏中，你最需要理解的语句：

```
 Call FindInterestingFolders(FolderList, True, False, "|", _
         "Personal Folders|!Family", "Personal Folders|!Tony|Amazon") 
```

`FindInterestingFolders`是上面代码中包含的子例程之一。该语句的第二行以我觉得方便的方式指定了我提到的两个文件夹的名称。该宏`FindInterestingFolders`返回有关这两个文件夹以及它们可能拥有的任何子文件夹或子子文件夹的信息。您必须将这两个名称替换为您要搜索的文件夹。如果 20 个文件夹都在一个父级下，您可以指定该单个父级。如果 20 个文件夹分散，您可能必须指定所有 20 个文件夹的名称。

第一个宏将 . 找到的所有文件夹的名称输出到即时窗口`FindInterestingFolders`。在我的系统上，它输出：

```
Personal Folders|!Family|Chloe & Euan
Personal Folders|!Family|Geoff
Personal Folders|!Family|Lucy & Mark
Personal Folders|!Tony|Amazon
Personal Folders|!Tony|Amazon|Trueshopping Ltd 
```

将此宏复制到您在上面创建的模块中并使用它，直到您创建一个包含 20 个要搜索的文件夹的列表。

**答案在代码下方继续。**

```
Sub ExtractHyperLinks1()

  ' Outputs a sorted list of interesting folders to the Immediate Window.

  Dim FolderList() As MAPIFolderDtl
  Dim InxFL As Long

  ' Set FolderList to a list of interesting folders.
  ' The True means a folder has to containing mail items to be interesting.
  ' The False means I am uninterested in meeting items.
  ' The "|" defines the name separator used in the list of folder names
  ' that follow.
  Call FindInterestingFolders(FolderList, True, False, "|", _
             "Personal Folders|!Family", "Personal Folders|!Tony|Amazon")

  For InxFL = LBound(FolderList) To UBound(FolderList)
    With FolderList(InxFL)
      Debug.Print .NameParent & "|" & .Folder.Name
    End With
  Next

End Sub 
```

希望这不是太难。您必须将修改后的调用复制`FindInterestingFolders`到以下宏中。

宏 2 建立在宏 1 的基础上。它在有趣的文件夹中搜索带有 Html 正文的邮件项目。对于每个 Html 正文，它会搜索锚标记并将每个标记和接下来的 58 个字符输出到即时窗口。即时窗口仅显示最后 200 行左右，因此您可能只能看到输出的底部。这没关系；这个想法是让您先看看宏可以看到什么。在我的系统上，输出结束：

```
 Tony Dallimore 13/02/2012 15:42:00 RE: Product details enquiry from Amazon customer ...
    <A HREF="mailto:16dhtcxlxwbh7fx@marketplace.amazon.co.uk">ma
    <A HREF="http://www.amazon.co.uk/gp/help/customer/display.ht
    <A HREF="http://www.amazon.co.uk/gp/help/customer/display.ht
  Trueshopping Ltd - Amazon Marketplace 14/02/2012 09:08:39 RE: Product details enquiry ...
    <A HREF="http://www.amazon.co.uk/gp/help/customer/display.ht
    <A HREF="http://www.amazon.co.uk/gp/help/customer/display.ht 
```

标题行包含邮件项目的发件人、接收时间和主题。

将此宏添加到模块中，将修改后的调用复制到`FindInterestingFolders`我的调用顶部并运行它。几乎立即，您将被警告宏正在访问电子邮件。您必须授予宏继续的权限并选择一个时间段以继续。我假设您将安全级别设置为标准的“中”。如果您将其设置为不同的值，您将获得不同的选项。

**答案在代码下方继续。**

```
Sub ExtractHyperLinks2()

  ' Gets a list of interesting folders.
  ' Searches the list for mail items with Html bodies that contain an anchor.
  ' For each such mail item it outputs to the Immediate Window:
  '   Name of folder (if not already output for an earlier mail item)
  '     Sender ReceivedTime Subject
  '       First 60 characters of first anchor
  '       First 60 characters of second anchor
  '       First 60 characters of third anchor

  Dim FolderList() As MAPIFolderDtl
  Dim FolderNameOutput As Boolean
  Dim InxFL As Long
  Dim InxItem As Long
  Dim PosAnchor As Long

  Call FindInterestingFolders(FolderList, True, False, "|", _
             "Personal Folders|!Family", "Personal Folders|!Tony|Amazon")

  For InxFL = LBound(FolderList) To UBound(FolderList)
    FolderNameOutput = False
    With FolderList(InxFL).Folder
      For InxItem = 1 To .Items.Count
        With .Items.Item(InxItem)
          If .Class = olMail Then
            If .HtmlBody <> "" Then
              ' This mail item has an Html body so might have a hyperlink.
              If InStr(1, LCase(.HtmlBody), "<a ") <> 0 Then
                ' It has at least one anchor
                If Not FolderNameOutput Then
                  Debug.Print FolderList(InxFL).NameParent & "|" & _
                              FolderList(InxFL).Folder.Name
                  FolderNameOutput = True
                End If
                Debug.Print "  " & .SenderName & " " & _
                            .ReceivedTime & " " & .Subject
                PosAnchor = InStr(1, LCase(.HtmlBody), "<a ")
                Do While PosAnchor <> 0
                  Debug.Print "    " & Mid(.HtmlBody, PosAnchor, 60)
                  PosAnchor = InStr(PosAnchor + 1, LCase(.HtmlBody), "<a ")
                Loop
              End If
            End If
          End If
        End With
      Next
    End With
  Next

End Sub 
```

我再次希望这很容易。我不确定下一个宏有多大用处。这是我开发的一个步骤，但它没有包含在最终宏中不重要的内容。可能值得您研究它，因为最终的宏将与宏 2 相比有两个重要的变化。

宏 3 所做的是从锚标记中提取 URL，并丢弃那些以“mailto:”开头的 URL。Html 允许的变化比我所允许的要多，因为我从未见过利用这种灵活性的电子邮件。如果您的电子邮件与我的预期不同，您可能必须增强我的代码。您只需要每封电子邮件中的一个 URL，因此您可能希望添加代码以丢弃其他 URL。

同样，将此宏添加到模块中，将修改后的调用复制到`FindInterestingFolders`我的调用顶部并运行它。在我的系统上，输出的最后几行是：

```
 Tony Dallimore 13/02/2012 15:42:00 RE: Product details enquiry from ...
    http://www.amazon.co.uk/gp/help/customer/display.html?nodeId=11081621
    http://www.amazon.co.uk/gp/help/customer/display.html?nodeId=3149571
  Trueshopping Ltd - Amazon Marketplace 14/02/2012 09:08:39 RE: Product ...
    http://www.amazon.co.uk/gp/help/customer/display.html?nodeId=11081621
    http://www.amazon.co.uk/gp/help/customer/display.html?nodeId=3149571 
```

**答案在代码下方继续。**

```
Sub ExtractHyperLinks3()

  ' Gets a list of interesting folders.
  ' Searches the list for mail items with Html bodies that contain an
  ' acceptable anchor. An acceptable anchor is one for which the url
  ' does not start "mailto:".
  ' For each acceptable anchor it outputs to the Immediate Window:
  '   Name of folder (if not already output for an earlier mail item)
  '     Sender ReceivedTime Subject (if not already output)
  '       Url from acceptable anchor

  Dim FolderList() As MAPIFolderDtl
  Dim FolderNameOutput As Boolean
  Dim InxFL As Long
  Dim InxItem As Long
  Dim ItemHeaderOutput As Boolean
  Dim LcHtmlBody As String
  Dim PosAnchor As Long
  Dim PosTrailingQuote As Long
  Dim PosUrl As Long
  Dim Quote As String
  Dim Url As String
  Call FindInterestingFolders(FolderList, True, False, "|", _
             "Personal Folders|!Family", "Personal Folders|!Tony|Amazon")

  For InxFL = LBound(FolderList) To UBound(FolderList)
    FolderNameOutput = False
    With FolderList(InxFL).Folder
      For InxItem = 1 To .Items.Count
        ItemHeaderOutput = False
        With .Items.Item(InxItem)
          If .Class = olMail Then
            If .HtmlBody <> "" Then
              ' This mail item has an Html body so might contain hyperlinks.
              LcHtmlBody = LCase(.HtmlBody)
              If InStr(1, LcHtmlBody, "<a ") <> 0 Then
                ' It has at least one anchor
                PosAnchor = InStr(1, LCase(.HtmlBody), "<a ")
                Do While PosAnchor <> 0
                  PosUrl = InStr(PosAnchor, LcHtmlBody, "href=")
                  PosUrl = PosUrl + 5
                  Quote = Mid(LcHtmlBody, PosUrl, 1)  ' Extract quote used in html
                  PosUrl = PosUrl + 1
                  PosTrailingQuote = InStr(PosUrl, LcHtmlBody, Quote)
                  Url = Mid(.HtmlBody, PosUrl, PosTrailingQuote - PosUrl)
                  If Left(LCase(Url), 7) <> "mailto:" Then
                    ' I am interested in this url
                    If Not FolderNameOutput Then
                      Debug.Print FolderList(InxFL).NameParent & "|" & _
                                  FolderList(InxFL).Folder.Name
                      FolderNameOutput = True
                    End If
                    If Not ItemHeaderOutput Then
                      Debug.Print "  " & .SenderName & " " & _
                                 .ReceivedTime & " " & .Subject
                      ItemHeaderOutput = True
                    End If
                    Debug.Print "    " & Url
                  End If
                  PosAnchor = InStr(PosTrailingQuote, LCase(.HtmlBody), "<a ")
                Loop
              End If
            End If
          End If
        End With
      Next
    End With
  Next

End Sub 
```

对于最后一个宏，我在用于开发答案的工作簿之一中创建了一个工作表。

在最终的宏中，您将找到以下语句：

```
 Const WkBkPathFile As String = "C:\DataArea\Play\Combined 10 V02.xls" 
```

您需要将其替换为工作簿的路径和文件名。

您还会发现以下声明：

```
 Const WkShtName As String = "URLs" 
```

我使用了工作表*URL*。我建议您首先创建一个像我这样的工作表。一旦你完成了最终的宏工作，你就可以根据你的要求对其进行调整。

我的工作表中有四列：文件夹名称、发件人名称、接收时间和 URL。第三列包含完整的日期和时间，但我将其格式化为仅显示一个短日期。您的问题中没有任何内容表明您想要这些额外的列。我认为值得展示您可以做什么，如果代码不有趣，您可以删除代码。

我确实认为您需要对 Received Time 做一些事情。除非您将已处理的电子邮件移出 20 个文件夹，否则每次运行宏都会再次添加完整的 URL 集。有许多技术可以不再处理电子邮件。例如，您可以将用户类别添加到已处理的电子邮件中。但是，我怀疑最简单的方法是：

*   将隐藏的工作表添加到工作簿。
*   将此工作表的单元格 A1 设置为“最新处理的电子邮件”，并将 B1 设置为 2000 年 1 月 1 日。
*   添加到丢弃无趣电子邮件的代码中，测试在此日期/时间之后的 Received 时间。
*   记录任何已处理电子邮件的最新接收时间。
*   将任何已处理电子邮件的最新接收时间写入隐藏工作表的单元格 B1。

我在最终的宏中包含了很多注释，解释了我如何积累数据并将其写入工作表，所以我不会在这里重复自己。祝你好运，并重复开始时的说明，询问是否有任何不清楚的地方。

同样，将此宏添加到模块中，将修改后的调用复制到`FindInterestingFolders`我的调用顶部。这次您还必须在运行宏之前更新一个或两个常量语句。

```
Sub ExtractHyperLinks()

  ' Open destination workbook.
  ' Find last used row in destination worksheet.
  ' Gets a list of interesting folders.
  ' Searches the list for mail items with Html bodies that contain an
  ' acceptable anchor. An acceptable anchor is one for which the url
  ' does not start "mailto:".
  ' For each acceptable anchor it outputs to the workbook:
  '   Column 1 := Name of folder
  '   Column 2 := Sender
  '   Column 3 := ReceivedTime
  '   Column 4 := Url

  Dim ExcelWkBk As Excel.Workbook
  Dim FolderList() As MAPIFolderDtl
  Dim FolderName As String
  Dim InterestingURL As Boolean
  Dim InxOutput As Long
  Dim InxFL As Long
  Dim InxItem As Long
  Dim ItemCrnt As MailItem
  Dim LcHtmlBody As String
  Dim OutputValue(1 To 50, 1 To 4)
  Dim PosAnchor As Long
  Dim PosTrailingQuote As Long
  Dim PosUrl As Long
  Dim Quote As String
  Dim RowNext As Long
  Dim TargetAddr As String
  Dim Url As String

  ' Replace constant value with path and file name of your workbook.
  Const WkBkPathFile As String = "C:\DataArea\Play\Combined 10 V02.xls"
  Const WkShtName As String = "URLs"

  Set ExcelWkBk = Application.CreateObject("Excel.Application"). _
                                                   Workbooks.Open(WkBkPathFile)

  With ExcelWkBk
    .Application.Visible = True         ' Slows the macro but helps during testing
    With .Worksheets(WkShtName)
      ' Find last used row in destination worksheet by going to bottom of sheet
      ' then moving up until a non-empty row is found then going down one.
      ' .End(xlUp) is VBA equivalent of Ctrl+Up.
      RowNext = .Cells(Rows.Count, "A").End(xlUp).Row + 1
    End With
  End With

  Call FindInterestingFolders(FolderList, True, False, "|", _
             "Personal Folders|!Family", "Personal Folders|!Tony|Amazon")

  InxOutput = 0

  For InxFL = LBound(FolderList) To UBound(FolderList)

    FolderName = FolderList(InxFL).NameParent & "|" & FolderList(InxFL).Folder.Name

    With FolderList(InxFL).Folder

      For InxItem = 1 To .Items.Count
        With .Items.Item(InxItem)
          If .Class = olMail Then
            If .HtmlBody <> "" Then
              ' This mail item has an Html body so might contain hyperlinks.
              LcHtmlBody = LCase(.HtmlBody)
              If InStr(1, LcHtmlBody, "<a ") <> 0 Then
                ' It has at least one anchor
                PosAnchor = InStr(1, LCase(.HtmlBody), "<a ")
                Do While PosAnchor <> 0
                  PosUrl = InStr(PosAnchor, LcHtmlBody, "href=")
                  PosUrl = PosUrl + 5
                  Quote = Mid(LcHtmlBody, PosUrl, 1)  ' Extract quote used in html
                  PosUrl = PosUrl + 1
                  PosTrailingQuote = InStr(PosUrl, LcHtmlBody, Quote)
                  Url = Mid(.HtmlBody, PosUrl, PosTrailingQuote - PosUrl)
                  InterestingURL = True     ' Assume interesting until find otherwise
                  If Left(LCase(Url), 7) = "mailto:" Then
                    InterestingURL = False
                  End If

                  ' **********************************************************
                  ' Set InterestingURL = False for any other urls you want
                  ' to reject.  If you can tell a URL is ininteresting by
                  ' looking at it, you can use code like mine.
                  ' **********************************************************

                  If InterestingURL Then

                    ' This URL and supporting data is to be output to the
                    ' workbook.
                    ' Rather than output data to the workbook cell by cell,
                    ' which can be slow, I build it up in the array
                    ' OutputValue(1 to 50, 1 To 4).  It is normal in a 2D array
                    ' for the first dimension to be for columns and the second
                    ' for rows. Arrays to be read from or written to a worksheet
                    ' are the other way round.  You can resize the second
                    ' dimension of a dynamic array but not the first so you
                    ' cannot resize an array being built for a workbook.  I
                    ' cannot resize the array so I have fixed its size at
                    ' compile time.
                    ' This code fills the array, writes it out to the workbook
                    ' and resets the array index.  I have 50 rows because I
                    ' wanted to test the filling and refilling of the array. I
                    ' would suggest you make it bigger.

                    InxOutput = InxOutput + 1
                    If InxOutput > UBound(OutputValue, 1) Then
                      ' Array is fill.  Output it to workbook
                      TargetAddr = "A" & RowNext & ":D" & _
                                   RowNext + UBound(OutputValue, 1) - 1
                      ExcelWkBk.Worksheets(WkShtName). _
                                          Range(TargetAddr).Value = OutputValue
                      RowNext = RowNext + 50
                      InxOutput = 1
                    End If
                    OutputValue(InxOutput, 1) = FolderName
                    OutputValue(InxOutput, 2) = .SenderName
                    OutputValue(InxOutput, 3) = .ReceivedTime
                    OutputValue(InxOutput, 4) = Url
                  End If
                  PosAnchor = InStr(PosTrailingQuote, LCase(.HtmlBody), "<a")
                Loop
              End If
            End If
          End If
        End With
      Next
    End With
  Next

  ExcelWkBk.Save             ' Save changes over the top of the original file.
  ExcelWkBk.Close (False)    ' Don't save changes
  Set ExcelWkBk = Nothing    ' Release resource

End Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-24T19:33:50.650

我无法将我的解决方案放在一个答案中，因为它超出了大小限制。 **这是我回答的第 2 部分。** 它包含第 1 部分中描述的代码块。请先阅读[第 1 部分](https://stackoverflow.com/a/13544800/973283)。

```
Option Explicit
Public Type MAPIFolderDtl
  NameParent As String
  Folder As MAPIFolder
  NumMail As Long
  NumMeet As Long
End Type
' -----------------------------------------------------------------------
' ## Insert other routines here
' -----------------------------------------------------------------------
Sub FindInterestingFolders(ByRef IntFolderList() As MAPIFolderDtl, _
                           WantMail As Boolean, WantMeet As Boolean, _
                           NameSep As String, _
                           ParamArray NameFullList() As Variant)

  ' * Return a list of interesting folders.
  ' * To be interesting a folder must be named or be a subfolder of a named
  '   folder and contain mail and or meeting items if wanted.
  ' * Note: a top level folder cannot be returned as interesting because such
  '   folders are not of type MAPIFolder.
  ' * IntFolders()  The list of interesting folders.  See Type MAPIFolderDtl for
  '                 contents.
  ' * WantMail      True if a folder containing mail items is to be classified
  '                 as interesting.
  ' * WantMeet      True if a folder containing meeting items is to be classified
  '                 as interesting.
  ' * NameSep       SubFolder Names in NameList are of the form:
  '                 "Personal Folders" & NameSep & "Inbox"
  '                 NameSep can be any character not used in a folder name.  It
  '                 appears any character could be used in a folder name including
  '                 punctuation characters.  If in doubt, try Tab.
  ' * NameFullList  One or more full names of folders which might themselves be
  '                 interesting or might be the parent an interesting folders.

  Dim InxTLFList() As Long
  Dim InxIFLCrnt As Long
  Dim InxNFLCrnt As Long
  Dim InxTLFCrnt As Variant
  Dim NameFullCrnt As String
  Dim NamePartFirst As String
  Dim NamePartRest As String
  Dim Pos As Long
  Dim TopLvlFolderList As Folders

  InxIFLCrnt = 0        ' Nothing in IntFolderList()
  Set TopLvlFolderList = CreateObject("Outlook.Application").GetNamespace("MAPI").Folders

  For InxNFLCrnt = LBound(NameFullList) To UBound(NameFullList)
    NameFullCrnt = NameFullList(InxNFLCrnt)     ' Get next name
    ' Split name into first part and the rest.  For Example,
    ' "Personal Folders|NHSIC|Commisioning" will be split into:
    '   NamePartFirst:  Personal Folders
    '   NamePartRest:   NHSIC|Commissioning
    Pos = InStr(1, NameFullCrnt, NameSep)
    If Pos = 0 Then
      NamePartFirst = NameFullCrnt
      NamePartRest = ""
    Else
      NamePartFirst = Mid(NameFullCrnt, 1, Pos - 1)
      NamePartRest = Mid(NameFullCrnt, Pos + 1)
    End If

    ' Create list of indices into TopLvlFolderList in
    ' ascending sequence by folder name
    Call SimpleSortFolders(TopLvlFolderList, InxTLFList)

    ' NamePartFirst should be the name of a top level
    ' folder or empty. Ignore if it is not.
    For Each InxTLFCrnt In InxTLFList
      If NamePartFirst = "" Or _
         TopLvlFolderList.Item(InxTLFCrnt).Name = NamePartFirst Then
        ' All subfolders are a different type so they
        ' are handled by FindInterestingSubFolder
        Call FindInterestingSubFolders(IntFolderList, InxIFLCrnt, _
                                      "", TopLvlFolderList.Item(InxTLFCrnt), WantMail, _
                                      WantMeet, NameSep, NamePartRest)
      End If
    Next
  Next

  If InxIFLCrnt = 0 Then
    ' No folders found
    ReDim IntFolderList(0 To 0)
  Else
    ReDim Preserve IntFolderList(1 To InxIFLCrnt)    ' Discard unused entries
    'For InxIFLCrnt = 1 To UBound(IntFolderList)
    '  Debug.Print IntFolderList(InxIFLCrnt).NameParent & "|" & _
    '              IntFolderList(InxIFLCrnt).Folder.Name & " " & _
    '              IntFolderList(InxIFLCrnt).NumMail & " " & _
    '              IntFolderList(InxIFLCrnt).NumMeet
    'Next
  End If

End Sub
Sub FindInterestingSubFolders(ByRef IntFolderList() As MAPIFolderDtl, _
                              InxIFLCrnt As Long, NameParent As String, _
                              MAPIFolderCrnt As MAPIFolder, WantMail As Boolean, _
                              WantMeet As Boolean, NameSep As String, _
                              NameChild As String)

  ' * NameFull = ""
  '     MAPIFolderCrnt and all its subfolders are potentially of interest
  ' * NameFull <> ""
  '     Look further down hierarchy for subfolders of potential interest

  ' This routine can be called repeately by a parent routine to explore different parts
  ' of the folder hierarchy.  It calls itself recursively to work down the hierarchy.

  ' IntFolderList    ' Array of interesting folders.
  ' InxIFLCrnt       ' On the first call, InxIFLCrnt will be zero and the state of
                     ' IntFolderList will be undefined.
  ' NameParent       ' ... Grandparent & NameSep & Parent
  ' MAPIFolderCrnt   ' The current folder that is to be explored.
  ' WantMail         ' True if a folder has to contain mail to be interesting
  ' WantMeet         ' True if a folder has to contain meeting items to be interesting
  ' NameSep          ' The name separator character
  ' NameChild        ' Suppose the original path was xxx|yyy|zzz.  For each recurse down
                     ' a name is removed from the start of NameChild and added to the end
                     ' of NameParent.  When NameChild is blank, the target folder has
                     ' been reached.

  Dim InxSFList() As Long
  Dim InxSFCrnt As Variant
  Dim NameCrnt As String
  Dim NamePartFirst As String
  Dim NamePartRest As String
  Dim NumMail As Long
  Dim NumMeet As Long
  Dim Pos As Long

  Pos = InStr(1, NameChild, NameSep)
  If Pos = 0 Then
    NamePartFirst = NameChild
    NamePartRest = ""
  Else
    NamePartFirst = Mid(NameChild, 1, Pos - 1)
    NamePartRest = Mid(NameChild, Pos + 1)
  End If

  If NameParent = "" Then
    ' This folder has no parent.  It cannot be interesting.
    NameCrnt = MAPIFolderCrnt.Name
  Else
    ' This folder has a parent.  It could be interesting.
    NameCrnt = NameParent & NameSep & MAPIFolderCrnt.Name
    If NamePartFirst = "" Then
      If FolderHasRequiredItems(MAPIFolderCrnt, WantMail, _
                                            WantMeet, NumMail, NumMeet) Then
        ' Debug.Print NameCrnt & " interesting"
        If InxIFLCrnt = 0 Then
          ReDim IntFolderList(1 To 100)
        End If
        InxIFLCrnt = InxIFLCrnt + 1
        If InxIFLCrnt > UBound(IntFolderList) Then
          ReDim Preserve IntFolderList(1 To 100 + UBound(IntFolderList))
        End If
        IntFolderList(InxIFLCrnt).NameParent = NameParent
        Set IntFolderList(InxIFLCrnt).Folder = MAPIFolderCrnt
        IntFolderList(InxIFLCrnt).NumMail = NumMail
        IntFolderList(InxIFLCrnt).NumMeet = NumMeet
      Else
        ' Debug.Print NameCrnt & " not interesting"
      End If
    End If
  End If

  If MAPIFolderCrnt.Folders.Count = 0 Then
    ' No subfolders
  Else
    Call SimpleSortMAPIFolders(MAPIFolderCrnt, InxSFList)
    For Each InxSFCrnt In InxSFList
      If NamePartFirst = "" Or _
        MAPIFolderCrnt.Folders(InxSFCrnt).Name = NamePartFirst Then
        Select Case NamePartFirst
          ' Ignore folders that can cause problems
          Case "Sync Issues"
          Case "RSS Feeds"
          Case "Public Folders"
          Case Else
            ' Recurse to analyse next level down
            Call FindInterestingSubFolders(IntFolderList, InxIFLCrnt, NameCrnt, _
                                          MAPIFolderCrnt.Folders(InxSFCrnt), WantMail, _
                                          WantMeet, NameSep, NamePartRest)
        End Select
      End If
     Next
  End If

End Sub
Function FolderHasRequiredItems(MAPIFolderCrnt As MAPIFolder, WantMail As Boolean, _
                                WantMeet As Boolean, ByRef NumMail As Long, _
                                ByRef NumMeet As Long) As Boolean

  ' Return True if folder is interested.  That is: at least one of the following is true:
  '    WantMail = True And NumMail > 0
  '    WantMeet = True And NumMeet > 0
  ' Values for NumMail and NumMeet are set whether or not the folder is interesting

  Dim FolderItem As Object
  Dim FolderItemClass As Long
  Dim InxItemCrnt As Long

  NumMail = 0
  NumMeet = 0

  ' Count mail and meeting items in folder
  For InxItemCrnt = 1 To MAPIFolderCrnt.Items.Count
    Set FolderItem = MAPIFolderCrnt.Items.Item(InxItemCrnt)

    ' This seems to avoid syncronisation errors
    FolderItemClass = 0
    On Error Resume Next
    FolderItemClass = FolderItem.Class
    On Error GoTo 0

    Select Case FolderItemClass
      Case olMail
        NumMail = NumMail + 1
      Case olMeetingResponsePositive, olMeetingRequest, olMeetingCancellation, _
           olMeetingResponseNegative, olMeetingResponseTentative
        NumMeet = NumMeet + 1
    End Select
  Next

  If WantMail And NumMail > 0 Then
    FolderHasRequiredItems = True
    Exit Function
  End If
  If WantMeet And NumMeet > 0 Then
    FolderHasRequiredItems = True
   Exit Function
  End If
  FolderHasRequiredItems = False

End Function
Sub SimpleSortMAPIFolders(MAPIFolderList As MAPIFolder, _
                                            ByRef InxArray() As Long)

  ' On exit InxArray contains the indices into MAPIFolderList sequenced by
  ' ascending name.  The sort is performed by repeated passes of the list
  ' of indices that swap adjacent entries if the higher come first.
  ' Not an efficient sort but adequate for short lists.

  Dim InxIACrnt As Long
  Dim InxIALast As Long
  Dim NoSwap As Boolean
  Dim TempInt As Long

  Debug.Assert MAPIFolderList.Folders.Count >= 1  ' Must be at least one folder

  ReDim InxArray(1 To MAPIFolderList.Folders.Count)  ' One entry per folder
  ' Fill array with indices
  For InxIACrnt = 1 To UBound(InxArray)
    InxArray(InxIACrnt) = InxIACrnt
  Next

  ' Each repeat of the loop movest the folder with the highest name
  ' to the end of the list.  Each repeat checks one less entry.
  ' Each repeats partially sorts the leading entries and may result
  ' in the list being sorted before all loops have been performed.
  For InxIALast = UBound(InxArray) To 1 Step -1
    NoSwap = True
    For InxIACrnt = 1 To InxIALast - 1
      If MAPIFolderList.Folders(InxArray(InxIACrnt)).Name > _
         MAPIFolderList.Folders(InxArray(InxIACrnt + 1)).Name Then
        NoSwap = False
        ' Move higher entry one slot towards the end
        TempInt = InxArray(InxIACrnt)
        InxArray(InxIACrnt) = InxArray(InxIACrnt + 1)
        InxArray(InxIACrnt + 1) = TempInt
      End If
    Next
    If NoSwap Then
      Exit For
    End If
  Next

End Sub 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-20T13:25:45.623

伙计们，我正在使用 codetwo Outlook 导出器来执行此任务。我不知何故偶然发现了它。谢谢Marc nd Expfresh！你的解决方案很棒，但我在尝试之前找到了另一种方法。这个论坛有乐于助人的人真是太好了。仅适用于面临相同问题的人：使用 CODETWO Outlook 导出器。- 做这项工作。问候 - 艾迪

# php - PHP libgd 崩溃没有反馈

> ID：13497700
> 
> 赞同：1
> 
> 时间：2012-11-21T16:29:43.817
> 
> 标签：php, debugging, crash, gd

我正在处理大量图像。我必须为每个图像创建四个 JPEG 版本：

*   原始尺寸 JPEG
*   700x430 版本
*   57x57 缩略图
*   167xN 缩略图（可变高度，保持纵横比）

我使用了以下两个辅助函数：

```
function thumbFixed($srcfile, $dstfile, $dstWidth, $dstHeight) {
    $srcImg = imagecreatefromstring(file_get_contents($srcfile));
    list($srcWidth, $srcHeight) = getimagesize($srcfile);
    $srcAR = $srcWidth / $srcHeight;

    $dstAR = $dstWidth / $dstHeight;

    $dstImg = imagecreatetruecolor($dstWidth, $dstHeight);

    if($srcAR >= $dstAR) {
        $cropHeight = $dstHeight;
        $cropWidth = (int)($dstHeight * $srcAR);
    } else {
        $cropWidth = $dstWidth;
        $cropHeight = (int)($dstWidth / $srcAR);
    }

    $cropImg = imagecreatetruecolor($cropWidth, $cropHeight);
    imagecopyresampled($cropImg, $srcImg, 0, 0, 0, 0, $cropWidth, $cropHeight, $srcWidth, $srcHeight);

    $dstOffX = (int)(($cropWidth - $dstWidth) / 2);
    $dstOffY = (int)(($cropHeight - $dstHeight) / 2);

    imagecopy($dstImg, $cropImg, 0, 0, $dstOffX, $dstOffY, $dstWidth, $dstHeight);
    imagejpeg($dstImg, $dstfile);
}

function thumbGrid($srcfile, $dstfile, $dstWidth) {
    $srcImg = imagecreatefromstring(file_get_contents($srcfile));
    list($srcWidth, $srcHeight) = getimagesize($srcfile);
    $srcAR = $srcWidth / $srcHeight;

    $dstHeight = $dstWidth / $srcAR;

    $dstImg = imagecreatetruecolor($dstWidth, $dstHeight);

    imagecopyresampled($dstImg, $srcImg, 0, 0, 0, 0, $dstWidth, $dstHeight, $srcWidth, $srcHeight);
    imagejpeg($dstImg, $dstfile);
} 
```

在这种情况下使用这些功能：

```
$img = imagecreatefromstring(file_get_contents($local));
imagejpeg($img, 'temp.jpg', 100);
thumbFixed($local, 'gallery.jpg', 700, 430);
thumbFixed($local, 'thumbsmall.jpg', 57, 57);
thumbGrid($local, 'grid.jpg', 167); 
```

其中`$local`保存图像的路径名。

该代码适用于大多数图片，但在一种特殊情况下表现不佳，即 1792x1198、356Kb JPEG 文件。不过，我对这种不当行为感到非常担心，因为我似乎无法以任何方式对其进行跟踪：`gdb`在 PHP 解释器上运行会导致`Program exited with code 0377.`（这意味着 PHP 已`exit(-1)`编辑）而没有其他结果 - 没有堆栈跟踪，没有错误，没有反馈任何。

我发现，通过在每次 libgd 调用之前插入各种回声，脚本`$cropImg = imagecreatetruecolor($cropWidth, $cropHeight);`在`thumbFixed`函数中执行时会“崩溃”PHP，但我似乎无法解决这个问题，因为我无法从我的代码中控制它，也不从调试器回溯它。有没有人有类似的经历，可以给我一些指示吗？

# upload - 使用 Google 电子表格中的脚本上传文本文件，并将文本文件的内容写入电子表格中的工作表

> ID：13497707
> 
> 赞同：2
> 
> 时间：2012-11-21T16:30:04.643
> 
> 标签：upload, google-apps-script, text-files, google-sheets, google-spreadsheet-api

使用通过单击 Google 电子表格上的按钮调用的自定义函数，我想将文本文件上传到特定文件夹，然后将内容放入电子表格的特定工作表中？

我知道如何创建一个按钮并在单击它时调用一个自定义函数。现在通过我的自定义功能，我想：

1.  要求用户浏览到文本文件位置，然后选择文件并上传。
2.  将其上传到特定位置，并将文件名更改为我想要的特定名称。
3.  阅读文本文件的内容并将它们放入电子表格的工作表中。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T08:08:03.027

Creating a button, and assigning a macro (function) to that button, or you could just as easily create a new menu item in your Google spreadsheet. The new menu item would be achieved programmatically using a custom function, and executed using the onOpen trigger for your spreadsheet.

```
 function onOpen(){
    var ss = SpreadsheetApp.getActiveSpreadsheet();
    var menuEntries = [ {name: "Text File Upload", functionName: "text_file_upload"},
                        {name: "Change Name", functionName: "change_name"},
                        {name: "TextFile to S.sheet", functionName: "t_file_ssheet"} ];
    ss.addMenu("Text Files", menuEntries);
 } //this onOpen function will add a new menu to your spreadsheet called "Text Files" with 3 submenu items you can use to work with your text files.

 function text_file_upload() {
    Browser.msgBox("You are about to upload new text file");
  //insert code here to get textfile location/Url and  Textfile Data, this can be stored in array 
 }

 function change_name() {
    var newName = Browser.inputBox("Enter the new name for the text file:");
  //insert code here to assign new file name to the text file
 }

 function t_file_ssheet(){
    //insert code here to copy data from your textfile to a sheet in your spreadsheet
 } 
```

There is a very nice tutorial here [Tutorial: Interacting With Your Docs List](https://developers.google.com/apps-script/articles/docslist_tutorial?hl=en/%22have%20a%20look%20at%20this%20tutorial%22) that covers most of the coding your looking for.

# c# - c#中的枚举数组索引

> ID：13497708
> 
> 赞同：0
> 
> 时间：2012-11-21T16:29:05.007
> 
> 标签：c#, arrays, indexing

我正在使用 C# (WPF) 应用程序中的 RGB 颜色数据，发现自己有很多剪切和粘贴的代码

```
totals.red += currentPixel.red;
totals.green += currentPixel.green;
totals.blue += currentPixel.blue; 
```

我想减少这种复制粘贴和复制粘贴错误的漏洞。我可以在这个地方使用大小为 3 的数组，但按数字访问这些数组会降低可读性。

我想写这样的东西：

```
for (col = all colours) {
  totals[col] += currentPixel[col];
} 
```

我知道如何在 C 中解决这个问题，但我不熟悉 C#。有枚举的东西？

编辑：使示例更有意义。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T16:40:59.673

如果你真的想为此使用枚举，你可以这样做：

```
enum Color { red, green, blue };

{
    foreach (int colorValue in Enum.GetValues(typeof(Color)))
        thing[colorValue] = otherthing[colorValue] * 2;
} 
```

这也将允许您在其他代码中按名称获取单个颜色：

```
var color = thing[Color.red]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T16:38:06.677

假设红色、绿色和蓝色的类型为 Color

您可以设置颜色列表

```
List<Color> colors = new List<Color>(); 
```

向其中添加项目：

```
colors.Add(green);
colors.Add(blue);
colors.Add(red); 
```

然后迭代：

```
foreach (Color color in colors)
{
    color.thing = color.otherThing * 2
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T16:38:51.950

枚举在这里无济于事。[但是您可以像在整数数组或结构数组](https://stackoverflow.com/questions/2441466/integer-array-or-struct-array-which-is-better)中那样定义自己的类型- 哪个更好？，并重载算术运算符，如[http://msdn.microsoft.com/en-us/library/8edha89s(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/8edha89s(v=vs.80).aspx)中所述，以允许乘以 int 例如。例如

```
thing = otherthing * 2; 
```

# delphi - 如何使用鼠标拖动画线？

> ID：13497710
> 
> 赞同：0
> 
> 时间：2012-11-21T16:30:06.007
> 
> 标签：delphi

我需要使用光标在delphi中画一条线，我已经创建了线代码，但是我不知道下一步该怎么做？怎么能做到这一点，我按下鼠标，当线条需要开始并拖动我的鼠标或简单地释放鼠标按钮并绘制线条时。

```
procedure TForm1.Button1Click(Sender: TObject);
var 
  x0, y0, x1, y1: Integer;
begin
  x0 := StrToInt(Edit1.Text);
  y0 := StrToInt(Edit2.Text);
  x1 := StrToInt(Edit3.Text);
  y1 := StrToInt(Edit4.Text);
  Brezenhems(x0 , Y0 , X1 , Y1);
end; 
```

我希望有人帮助我谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-21T16:45:07.393

像这样的东西：

```
unit Unit4;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs;

type
  TForm4 = class(TForm)
    procedure FormResize(Sender: TObject);
    procedure FormCreate(Sender: TObject);
    procedure FormPaint(Sender: TObject);
    procedure FormMouseDown(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure FormMouseUp(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure FormMouseMove(Sender: TObject; Shift: TShiftState; X, Y: Integer);
  private
    { Private declarations }
    FStartPoint, FEndPoint: TPoint;
    FDrawingLine: boolean;
    bm: TBitmap;
    procedure AddLineToCanvas;
    procedure SwapBuffers;
  public
    { Public declarations }
  end;

var
  Form4: TForm4;

implementation

{$R *.dfm}

procedure TForm4.FormCreate(Sender: TObject);
begin
  bm := TBitmap.Create;
  FDrawingLine := false;
end;

procedure TForm4.FormMouseDown(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
  FStartPoint := Point(X, Y);
  FDrawingLine := true;
end;

procedure TForm4.FormMouseMove(Sender: TObject; Shift: TShiftState; X,
  Y: Integer);
begin
  if FDrawingLine then
  begin
    SwapBuffers;
    Canvas.MoveTo(FStartPoint.X, FStartPoint.Y);
    Canvas.LineTo(X, Y);
  end;
end;

procedure TForm4.FormMouseUp(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
  FDrawingLine := false;
  FEndPoint := Point(X, Y);
  AddLineToCanvas;
  SwapBuffers;
end;

procedure TForm4.AddLineToCanvas;
begin
  bm.Canvas.MoveTo(FStartPoint.X, FStartPoint.Y);
  bm.Canvas.LineTo(FEndPoint.X, FEndPoint.Y);
end;

procedure TForm4.FormPaint(Sender: TObject);
begin
  SwapBuffers;
end;

procedure TForm4.SwapBuffers;
begin
  BitBlt(Canvas.Handle, 0, 0, ClientWidth, ClientHeight,
    bm.Canvas.Handle, 0, 0, SRCCOPY);
end;

procedure TForm4.FormResize(Sender: TObject);
begin
  bm.SetSize(ClientWidth, ClientHeight);
end;

end. 
```

[编译示例EXE](http://privat.rejbrand.se/drawlines.exe)

请注意，此方法简单且稳健，但在性能方面并非最佳。如果您尝试在 Windows 3.1 时代的计算机上运行它，这可能会成为一个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-01-01T10:37:26.213

另一种无需创建位图即可使用的技术是使用 Pen.Mode 属性。像这样的东西：

```
 TForm2 = class(TForm)
    procedure FormMouseDown(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure FormMouseMove(Sender: TObject; Shift: TShiftState; X, Y: Integer);
    procedure FormMouseUp(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
  private
   PO,LP: TPoint;
   draw: boolean;
  public
    { Public declarations }
  end;

procedure TForm2.FormMouseDown(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
 PO.X:= X;
 PO.Y:= Y;
 LP.X:= X;
 LP.Y:= Y;
 draw:= true;
 Canvas.Pen.Mode:= pmNotXor;
end;

procedure TForm2.FormMouseMove(Sender: TObject; Shift: TShiftState; X,
  Y: Integer);
begin
 if draw then
  begin
   if (LP.X <> PO.X) or (LP.Y <> PO.Y) then
    begin
     Canvas.MoveTo(PO.X,PO.Y);
     Canvas.LineTo(LP.X,LP.Y);
    end;
   LP.X:= X;
   LP.Y:= Y;
   Canvas.MoveTo(PO.X,PO.Y);
   Canvas.LineTo(LP.X,LP.Y);
  end;
end;

procedure TForm2.FormMouseUp(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
 if draw then draw:= false;
end; 
```

# android - ADT 21 和图书馆项目

> ID：13497711
> 
> 赞同：-1
> 
> 时间：2012-11-21T16:30:10.177
> 
> 标签：android, kml, gpx

昨天我将 adt 更新到 v 21。今天，经过小幅更正后，我重建并启动了项目，但它崩溃了。在我的项目中，我使用了一些库项目。ActionbarSherlock 就是其中之一。Logcat 说“java.lang.NoClassDefFoundError: com.actionbarsherlock.R$styleable at...”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T17:14:29.573

不过，我的解决方案有所不同。

我们需要确保在库项目中没有具有相同包名的项目。

如果 2 个库项目具有相同的包名，则构建过程不会为其中任何一个生成 R。更改其中一个的包名称（因此两个库具有不同的包名称）解决了这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T16:30:10.177

在查看 logcat 并挠头几分钟后，我注意到，库项目的 R 类尚未在我的项目 /gen 文件夹中生成。为什么？这对我来说是个秘密。

我刚刚重建了图书馆项目，而不是我的 - 它解决了这个问题。

来自 adt 发行说明：

> 更新了构建以仅使用库所需的 ID 为库项目生成 R 资源类，从而降低了字段和方法达到 DEX 文件限制的风险。

似乎 adt 只是忽略了在 v21 之前的版本下构建的库项目

# matlab - Matlab Slider - 显示左右箭头并每 1 秒移动一次滑块

> ID：13497715
> 
> 赞同：0
> 
> 时间：2012-11-21T16:29:16.120
> 
> 标签：matlab, user-interface, timer, slider

正如标题所说，我正在使用 Matlab 中的 GUIDE 工具箱，我首先想知道如何在滑块的任一端显示左/右箭头？

另外，如何让滑块每 1 秒自动移动一次？

据我了解，我需要首先创建一个计时器对象并设置执行模式和周期，如下所示：

```
time = timer;
set(time,'executionMode','fixedRate','period',1); 
```

现在我知道我需要将 timerFcn 设置为：

```
set(handles.slider1,'Value',x); 
```

为了改变滑块的位置。

另外我知道我需要先通过滑块步骤增加 x 变量，在我的例子中是 0.00520833。例如：

```
x = x + 0.00520833; 
```

所以我有一些代码如下：

```
time = timer;
set(time,'executionMode','fixedRate','period',1);
time.timerFcn = set(handles.slider1,'Value', x = x + 0.00520833); 
start(time); 
```

但是这不起作用，我敢肯定这是因为我正在做一些愚蠢的事情。

谢谢！

编辑：

现在我可以每秒移动一次滑块，但我想做的是每秒运行一个我自己的函数。例如：

```
time.timerFcn = @slider_increment;

function slider_increment

set(handles.slider1,'Value', get(handles.slider1,'Value') + 0.00520833)

slider = get(handles.slider1,'Value');
set(handles.text4,'String', slider); 
```

我知道这有点乱，但我稍后会整理。我面临的问题是如何在指南创建的 GUI 脚本中声明我自己的函数，并允许该函数访问 GUI 对象的句柄。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T16:43:09.507

首先，这

```
time.timerFcn = set(handles.slider1,'Value', x = x + 0.00520833); 
```

肯定会产生错误...

我想你想要这样的东西：

```
h = uicontrol;

time = timer;
set(time,'executionMode','fixedRate','period',1);

%Note: set(h,val,get(h,val) + change)
time.timerFcn = @(x,y)set(h,'position', get(h,'position') + 10);

start(time); 
```

# jquery - jquery click handler 不能在服务器上的 IE 上工作，在开发中工作

> ID：13497716
> 
> 赞同：1
> 
> 时间：2012-11-21T16:30:16.983
> 
> 标签：jquery, internet-explorer, javascript-events

当我将代码部署到 IIS 7 服务器时，我的按钮单击处理程序不起作用，但在我的开发 (VS2010) 环境中工作正常。该问题仅发生在服务器和 IE (IE 9) 上。如果我使用 Chrome 访问该站点，它可以工作。此外，单击其他非按钮控件（例如图像）也可以。

这是html中的按钮声明

```
<button id="btnReleaseAssays" type="button">Release Assays</button> 
```

这是 jquery CLICK 事件处理程序

```
 $('#btnReleaseAssays').click(function () { 
```

此点击处理程序不起作用。

但是，如果我更改为下面显示的 jQuery ON 处理程序，它确实会捕获该事件。

```
 $("#btnReleaseAssays").on("click", "", function () { 
```

关于为什么会出现这种差异的任何想法？

# c# - 将 XAML 移动到类库（Windows 商店应用程序）时出错

> ID：13497719
> 
> 赞同：0
> 
> 时间：2012-11-21T16:29:28.757
> 
> 标签：c#, xaml, windows-8, winrt-xaml

我正在尝试将所有 XAML 页面移动到类库（Windows 商店应用程序）。

当我使用库中定义的类从应用程序调用导航功能时，例如：

```
this.Frame.Navigate(typeof(ItemsPage1)); 
```

我得到“XAML 解析失败”。

问题似乎与样式或资源有关，但我不确定。

我错过了什么？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T04:04:18.687

从类库中的命名空间和程序集名称中删除句点。

请参阅：http: [//support.microsoft.com/kb/2739194](http://support.microsoft.com/kb/2739194)

看起来很疯狂，MSFT 没有在 Update1 中修复这个问题，因为它是自 VS2012 发布以来的一个严重的已知错误。

另一种解决方法是保持句点不变，但确保类库属性页中的“程序集名称”和“默认命名空间”字段匹配。

# regex - 正则表达式解析每行的第一个字母？

> ID：13497727
> 
> 赞同：2
> 
> 时间：2012-11-21T16:31:07.630
> 
> 标签：regex, lua

这是列表：

```
Work
Work
Fire
Global 
```

我想从中提取字符串`WWFG`。`[(?).*\n]`只要给我`Global`。我应该使用什么？

对于上下文，我使用的是 Rainmeter 的 webparser 插件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T13:05:17.323

试试这个：`(?simU)^(.)`
RainRegExp 似乎缺少替换功能，因此不可能将所有捕获连接到一个字符串中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T16:33:01.483

您需要将多行标志与`anchor`. 我会使用：（`/^(.)/gm`语法因语言而异）

请参阅此处的示例：[http ://regex101.com/r/uC1gV5](http://regex101.com/r/uC1gV5)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T16:33:52.577

最简单的方法取决于您使用的语言，但您想替换

```
(.).*\n 
```

和

```
$1 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-23T13:55:25.737

```
(?siU)(?(?=.)(.))(?(?=.*\n).*\n(.))(?(?=.*\n).*\n(.))(?(?=.*\n).*\n(.)) 
```

[@moshi 在这里回答。](http://rainmeter.net/forum/viewtopic.php?f=4&t=14110)它与 Rainmeter 完美配合。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-21T16:44:10.970

我不知道您使用的是什么语言，但这里有一些 Python！

```
>>> import re
>>> ''.join(re.findall("(.).*", "Work\nWork\nFire\nGlobal"))
'WWFG' 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-21T16:45:06.800

这将捕获每行的第一个字符

```
([a-z])[^\n]+\n* 
```

替换为`\1`或`$1`

根据文本中的内容，您可能需要更改`[a-z]`为更全面的内容

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-23T13:38:55.243

如果那是 Lua，请尝试`s:gsub("(.).-\n","%1")`.

# javascript - 在辅助选择上隐藏/显示所选选项

> ID：13497728
> 
> 赞同：0
> 
> 时间：2012-11-21T16:31:11.327
> 
> 标签：javascript, select

我有两个`<select>`具有不同 ID 的元素。

当用户从第一个选择框中选择一个值时，我希望第二个选择框只显示连接的值。

我的代码：

```
<select id="ExtraField_1" name="ExtraField_1">
    <option value="1">test1</option>
    <option value="2">test2</option>
    <option value="3">test3</option>
    <option value="4">test4</option>
    <option value="5">test5</option>
    <option value="6">test6</option>
    <option value="7">test7</option>
    <option value="8">test8</option>
    <option value="9">test9</option>
    <option value="10">test10</option>
    <option value="11">test11</option>
    <option value="12">test12</option>
</select>
<select id="ExtraField_2" name="ExtraField_2">
    <option value="1">test1</option>
    <option value="2">test2</option>
    <option value="3">test3</option>
    <option value="4">test4</option>
    <option value="5">test5</option>
    <option value="6">test6</option>
    <option value="7">test7</option>
    <option value="8">test8</option>
    <option value="9">test9</option>
    <option value="10">test10</option>
    <option value="11">test11</option>
    <option value="12">test12</option>
    <option value="13">test13</option>
    <option value="14">test14</option>
    <option value="15">test15</option>
    <option value="16">test16</option>
    <option value="17">test17</option>
    <option value="18">test18</option>
    <option value="19">test19</option>
    <option value="20">test20</option>
</select> 
```

因此，当用户从第一个选择框中选择“test1”时，他将在第二个选择框上只看到“test2”、“test3”和“test4”；第一个中的“test2”将在第二个框中显示“test6”、“test7”和“test8”。

如何使用 JavaScript 来解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T16:39:59.600

如果您可以使用 jQuery，那么您始终可以清除并将选项附加到第二个选择。

```
 $('#ExtraField_1').change(function(){
        $('#ExtraField_2').find('option').remove()
        if($(this).val() == '1'){
           $('#ExtraField_2').append($("<option </option>").attr('value','2').text('test2'));
           $('#ExtraField_2').append($("<option></option>").attr('value','3').text('test3'));
           $('#ExtraField_2').append($("<option></option>").attr('value','4').text('test4'));
        }
        if($(this).val() == '2'){
           $('#ExtraField_2').append($("<option></option>").attr('value','5').text('test5'));
           $('#ExtraField_2').append($("<option></option>").attr('value','6').text('test6'));
           $('#ExtraField_2').append($("<option></option>").attr('value','7').text('test7'));
        } 
   }); 
```

​</p>

[http://jsfiddle.net/8XVuv/2/](http://jsfiddle.net/8XVuv/2/)

仅使用 javascript 有点复杂，但我仍然会采用相同的方法。

```
 function createOption(otext,oValue){
        var newOption = document.createElement('option');
        newOption.text = otext;
        newOption.value = oValue;
        return newOption;
    }

    function clearSelect(theSelect){
        for(var i = 0;i <= theSelect.options.length+1;i++)
        {
            theSelect.remove();
        }
    }

    function onSelect(theSelect){
        var nextSelect = document.getElementById('ExtraField_2');
        clearSelect(nextSelect);
        var selected = theSelect.options[theSelect.selectedIndex];

        if(selected.value == 1){
            nextSelect.add(createOption('test2','2'));
            nextSelect.add(createOption('test3','3'));
            nextSelect.add(createOption('test4','4'));
        }
        if(selected.value == 2){
            nextSelect.add(createOption('test5','5'));
            nextSelect.add(createOption('test6','6'));
            nextSelect.add(createOption('test7','7'));
        }

    } 
```

用html：

```
<select id="ExtraField_1" name="ExtraField_1" onchange="javascript: onSelect(this);" >
    <option value="0">Select a test..</option>
    <option value="1">test1</option>
    <option value="2">test2</option>
    <option value="3">test3</option>
    <option value="4">test4</option>
    <option value="5">test5</option>
    <option value="6">test6</option>
    <option value="7">test7</option>
    <option value="8">test8</option>
    <option value="9">test9</option>
    <option value="10">test10</option>
    <option value="11">test11</option>
    <option value="12">test12</option>
</select>

<select id="ExtraField_2" name="ExtraField_2">
    <option value="0">Select from the left</option>
</select>​ 
```

如您所见，它仍然可以满足您的期望，但您并没有隐藏选项。

[http://jsfiddle.net/upKzW/13/](http://jsfiddle.net/upKzW/13/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T18:31:20.517

```
 $('#ExtraField_1').change(function() {
 $('#ExtraField_2').val(this.value); 
```

});

[http://jsfiddle.net/judearasu/rF8G6/](http://jsfiddle.net/judearasu/rF8G6/)

# node.js - 使用 AppJS 部署应用程序？

> ID：13497735
> 
> 赞同：2
> 
> 时间：2012-11-21T16:31:24.833
> 
> 标签：node.js, appjs

如何使用 AppJS 创建一个独立的应用程序？我阅读了本教程，但我找不到您实际上将源代码转换为具有自己的“框架”的“应用程序”的位置，而不是什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-26T18:01:25.567

为您的架构下载预打包的发行版：http: [//appjs.com/#download](http://appjs.com/#download)。解压压缩包，你会得到一个“hello world”应用程序，点击windows上的app.sh或app.exe来运行应用程序。

然后，您可以修改 index.html 以更改应用程序的外观，它是普通的 html，因此您还可以包含 jquery 和您想要的任何其他内容。app.js javascript 然后在 node 内部运行，因此它可以使用 node 模块，读取本地硬盘等。

可在以下位置获得更多帮助：[https](https://github.com/appjs/appjs/wiki) ://github.com/appjs/appjs/wiki 。

# c# - 如果输入字符串是有效的 xml 字符串，有人可以帮我找到正则表达式吗？

> ID：13497739
> 
> 赞同：1
> 
> 时间：2012-11-21T16:30:46.400
> 
> 标签：c#

> **可能重复：**
> [如何在调用 .LoadXml() 之前检查字符串输入中的有效 xml](https://stackoverflow.com/questions/86292/how-to-check-for-valid-xml-in-string-input-before-calling-loadxml)

在我正在实现的程序中，用户可以输入一个字符串。我必须确定如果它是一个有效的 xml，那么我必须区别对待它。是否有一个正则表达式可以找到给定的字符串是否是有效的 xml？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T16:48:12.633

[不可能构造一个“普通”的正则表达式来识别带有不平衡括号的字符串和带有平衡括号的字符串](https://stackoverflow.com/a/133684/335858)，因为正则表达式的底层可编程系统不足以做到这一点。出于同样的原因，理论上不可能构造一个能够识别格式良好的 XML ^*的正则表达式。

即使理论上可以构建这样的表达式，它也不实用：构建识别器所需的工作量与构建成熟的 XML 解析器所需的工作量大致相同。

幸运的是，.NET 已经带有几个 XML 解析器。像这样的一段代码

```
bool TryGetValidXml(string s, out XDoxument res) {
    try {
        res = XDocument.Load(s);
        return true;
    } catch {
        res = null;
        return false;
    }
} 
```

会成功的。

* * *

^*有各种扩展，例如 Perl 的[递归正则表达式](https://stackoverflow.com/q/4445674/335858)和 .NET[平衡组](https://stackoverflow.com/a/7973652/335858)，可让您解决此限制。

# css - 向ie8显示媒体查询的内容

> ID：13497745
> 
> 赞同：0
> 
> 时间：2012-11-21T16:32:07.003
> 
> 标签：css, responsive-design

[有一篇关于粉碎杂志](http://coding.smashingmagazine.com/2011/08/10/techniques-for-gracefully-degrading-media-queries/)（技术 3）的相当老的文章说，如果你开始这样的媒体查询：

`@media screen, all and (min-width: 300px)`

那么理解媒体查询的浏览器将理解整个媒体查询，因为旧的ie会在“all and”之后忽略所有内容。所以理论上较旧的 ie 仍然可以看到查询中的所有内容。这对于 ie6 和 ie7 来说是惊人的，但不幸的是 ie8 忽略了查询中的所有规则。

这很不幸，因为如果我们能得到

[我们可以使用Jeremy Keiths 示例](http://adactio.com/journal/4494/)做类似的事情，该示例涉及将布局内容移动到单独的样式表中，并使用条件注释将其提供给旧版 IE。

这种方法的问题在于我的 css 模块在不同的样式表之间进行了拆分。这违背了 OOCSS 和 SMACSS 中的原则（它们真的很有用！）

有一个[JS Fiddle 有人试图破解它，](http://jsfiddle.net/boblet/59e99/)但想知道是否有人对如何做到这一点有任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T14:51:16.617

感谢@cimmonon 的评论让我找到了解决方案。

使用 .less 我可以拥有

global.less - 这里有我所有的 CSS，包括我所有的断点。断点设置为较少的变量。compiled.less - 这会导入 global.less 并编译成一个 css 文件 Compiled-belowie8 - 这会导入 global.less 并编译成一个 css 文件 但是我已经将最宽布局的媒体查询变量更改为“none”，以便在这个文件中没有媒体查询。

然后，在我使用条件注释将compiled.css 提供给所有浏览器，除了

# javascript - 在 JavaScript 中观察匿名函数中的变量

> ID：13497746
> 
> 赞同：0
> 
> 时间：2012-11-21T16:31:13.070
> 
> 标签：javascript, debugging, watchpoint

我想确定何时更改特定变量。我使用[这段代码](https://gist.github.com/384583)来观察我可以访问的任何对象的任何属性都取得了巨大的成功，但它可以用于像这样声明的变量吗？：

```
$(                  // line 1
  function(){       // line 2
    var A;          // line 3
    // ... lots of code that uses A as if it were a global. I wanna see what part of this code sets A ...
  }                 // line 5999
);                  // line 6000 
```

肯定`A`不会最终成为`window`. 它可能是跨越第 2 行到 5999 行的匿名函数对象的属性吗？因此，如果我命名该函数以便可以引用它，我能否以某种方式`watch`在`A`var/prop 上使用它？

我可以使用哪些其他方法来确定 var 的设置位置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T16:43:44.463

这可能看起来有点疯狂，但稍作修改，您就可以看到变量指针。

```
(function() {
    window.ox = x = {};

    x.y = 5;
})();

alert(ox.y); 
```

这会将其拉入全局范围，并且应该允许您从全局变量 ox 中观察变量 x。​</p>

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T16:34:45.557

你不能`Object.prototype.watch`在那个变量上使用，仅仅因为它是一个变量，而不是一个对象属性。无论其范围如何（即您提到的匿名函数）。

如果您出于调试目的尝试这样做，我相信您可以从浏览器的开发人员工具中观看它。

# android - 在 Linux 上使用 ADB 安装多个 APK

> ID：13497747
> 
> 赞同：2
> 
> 时间：2012-11-21T16:31:20.547
> 
> 标签：android, linux, ubuntu, apk

将多个 APK 传递给 ADB 脚本是非法的。当我尝试通过只调用一次 adb 命令来安装多个 APK 文件时，就会发生这种情况。但是，我发现了一个用于安装多个 APK 的 Windows 机器的脚本。

有谁知道Linux（Ubuntu）机器是否存在这样的脚本？我找不到它。

我可以自己创建一个，但如果存在这样的脚本，那么它会节省我的时间。

附注：传递`adb install *.apk`一些目录也无济于事。

PS。这是我找到 Windows 脚本的链接（[链接](http://www.redmondpie.com/how-to-install-multiple-apk-files-automatically-on-android-phones-with-mass-apk-installer/)）。我没有尝试过，但它似乎有效。;)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-21T22:21:20.013

采用：

```
$ ls -1 *.apk | xargs -l adb install 
```

# php - 使用 Eclipse 将网站部署到外部测试服务器

> ID：13497750
> 
> 赞同：2
> 
> 时间：2012-11-21T16:32:35.010
> 
> 标签：php, eclipse, testing, web-deployment, eclipse-pdt

我需要一种有效的方法来自动将 Eclipse 中所做的更改推送到测试 Web 服务器。这些都是 PHP 的变化。我认为 SCP 或 FTP 与一个易于使用的插件一起使用会很棒，但我愿意接受其他建议。

**背景**

在我的公司，我们有 Windows 开发机器，但测试 PHP 的唯一方法是将代码推送到运行 Apache 安装的 Linux 机器上。通常，我只会使用 WAMPServer 或 XAMPP 在本地进行测试，但我刚开始使用该公司，他们的代码库中充满了操作系统特定的代码（有一天我们会修复它！）。

我目前已经在我的机器上设置了 Git，我只是将所有内容提交到测试服务器上的一个裸仓库。然后我有一个 post-receive 挂钩，它强制拉入实际的 Apache Web 可访问文件夹。

这个 git 设置工作正常，但我真的不喜欢用无用的提交污染责备日志（即我在 javascript 中的 X 行添加了一个逗号）。这样的事情对其他开发人员没有用。

最后，无论如何我都不会从我的测试服务器推送。相反，我将从我的 Windows 机器推送到我们团队的中央 git 服务器（一旦我设置好它），所以我不确定我们是否应该使用版本控制来部署到测试 Web 服务器。似乎使用 SCP 或 FTP 插件最有意义。

**问题重述** 是否有任何 Eclipse 插件可以自动 SCP/FTP 到文件保存目录？我已经搜索了 Eclipse 市场，但我真的不知道该去哪里。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T16:37:22.250

查看 Eclipse 的远程系统资源管理器插件：http: [//eclipse.org/tm/](http://eclipse.org/tm/)

# wpf - 如何在可观察集合中绑定到列表中的元素？

> ID：13497755
> 
> 赞同：0
> 
> 时间：2012-11-21T16:31:45.867
> 
> 标签：wpf, data-binding

我有以下问题：

我有一个 ObservableCollection 作为我的模型，如下所示：

```
public class HistoryViewModel : ViewModelBase
{
    private ObservableCollection<List<KeyValuePair<DateTime, float>>> _valuePairs;
    public ObservableCollection<List<KeyValuePair<DateTime, float>>> ValuePairs
    {
        get
        {
            return this._valuePairs;
        }
        set
        {
            this._valuePairs= (ObservableCollection<List<KeyValuePair<DateTime, float>>>)value;
            OnPropertyChanged("ValuePairs");
        }
    }
} 
```

如您所见，此集合由列表组成，我需要绑定到列表中的 KeyValuePair。但我不知道怎么做。问题是我不知道集合或列表中有多少项目。

我现在的尝试是这样的：

```
<ItemsControl ItemsSource="{Binding Path=ValuePairs}">
    <ItemsControl.ItemsPanel>
        <ItemsPanelTemplate>
            <StackPanel></StackPanel>
        </ItemsPanelTemplate>
    </ItemsControl.ItemsPanel>

    <ItemsControl.ItemTemplate>
        <DataTemplate>
            <charting:Chart Width="400" Height="250">
                <charting:Chart.Series>
                    <charting:LineSeries Title="Monthly Count" 
                                            IndependentValueBinding="{Binding //, Path=Key}"
                                            DependentValueBinding="{Binding //, Path=Value}">
                    </charting:LineSeries>
                </charting:Chart.Series>
            </charting:Chart>
        </DataTemplate>
    </ItemsControl.ItemTemplate>
</ItemsControl> 
```

它显示集合中有多少元素，但图表不显示任何值。有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T18:29:37.067

将 ItemsSource="{Binding}" 添加到图表中，它应该修复它

# java - 如何使用 Jersey + JAXB + JSON 传输原始列表

> ID：13497759
> 
> 赞同：5
> 
> 时间：2012-11-21T16:32:56.740
> 
> 标签：java, json, list, jaxb, jersey

如果我传输具有 @XmlRoolElement 的类（ MyClass ），此代码工作正常

**客户**

```
WebResource webResource = restClient.resource(getRessourceURL());
return webResource.get( new GenericType<List<MyClass>>(){} ); 
```

但是，如果我尝试传输一个原语，如字符串、整数、布尔值等......

**客户**

```
WebResource webResource = restClient.resource(getRessourceURL());
return webResource.get( new GenericType<List<Integer>>(){} ); 
```

我收到错误消息：

> 无法将类型“java.lang.Integer”编组为元素，因为它缺少 @XmlRootElement 注释

向我的请求发送实体参数时，我得到完全相同的结果：

**客户**

```
WebResource webResource = restClient.resource(getRessourceURL());
return webResource.post( new GenericType<List<Integer>>(){}, Arrays.toList("1")); 
```

**服务器**

```
@GET
@Path("/PATH")
@Produces(MediaType.APPLICATION_JSON)
public List<MyClass> getListOfMyClass( List<Integer> myClassIdList)
{
  return getMyClassList(myClassIdList);
} 
```

有没有办法在不为这些原始类型中的每一个创建包装类的情况下转移这种列表？还是我错过了一些明显的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T13:45:58.967

我找到了一种解决方法，方法是手动控制 un-/marshalling，无需 Jersey。

**客户**

```
WebResource webResource = restClient.resource(getRessourceURL());
return webResource.post( new GenericType<List<Integer>>(){}, JAXBListPrimitiveUtils.listToJSONArray( Arrays.toList("1") )); 
```

**服务器**

```
@GET
@Path("/PATH")
@Produces(MediaType.APPLICATION_JSON)
public List<MyClass> getListOfMyClass(JSONArray myClassIdList)
{
  return getMyClassList(JAXBListPrimitiveUtils.<Integer>JSONArrayToList(myClassIdList) );
} 
```

我使用的 util 类：

```
import java.util.ArrayList;
import java.util.List;

import org.codehaus.jettison.json.JSONArray;
import org.codehaus.jettison.json.JSONException;

public class JAXBListPrimitiveUtils
{

  @SuppressWarnings("unchecked")
  public static <T> List<T> JSONArrayToList(JSONArray array)
  {
    List<T> list = new ArrayList<T>();
    try
    {
      for (int i = 0; i < array.length(); i++)
      {
        list.add( (T)array.get(i) );
      }
    }
    catch (JSONException e)
    {
      java.util.logging.Logger.getLogger(JAXBListPrimitiveUtils.class.getName()).warning("JAXBListPrimitiveUtils :Problem while converting JSONArray to arrayList" + e.toString());
    }

    return list;
  }

  @SuppressWarnings("rawtypes")
  public static JSONArray listToJSONArray(List list)
  {
    return new JSONArray(list);
  }
} 
```

# r - 在 R 中以日期为条件进行聚合

> ID：13497765
> 
> 赞同：1
> 
> 时间：2012-11-21T16:32:11.090
> 
> 标签：r, time

我有一些数据，我根据数据集使用以下代码以独特的分钟为基础汇总信息，为期 1 天。但是，我希望能够使用组合了多天的数据文件来运行此代码。我在数据集中有一个日期列，因此我可以将其用作每天的唯一标识符。鉴于日期不一样，有没有办法以 1 分钟为单位汇总数据？

问题是 unique 函数提取第一天发生的唯一事件，然后添加在那一分钟之后发生的所有相同事件。如果我也基于日期，我相信我可以在一个长数据集中为每一天创建唯一的 1 分钟条目。

以下是适用于单日数据的代码。

```
novo <- read.csv("C:/Users/Morten/Desktop/data.csv", header = TRUE, stringsAsFactors=FALSE  )

TimeStamp <- novo[,1]
price <- novo[, 2]
volume <- novo[,3]
nV <- sum(volume) 

MinutesFloor <- unique(floor(TimeStamp))
nTradingMinutes <- length(MinutesFloor)

PriceMin <- rep(0, nTradingMinutes)
VolumeMin <- rep(0, nTradingMinutes)

for( j in 1:nTradingMinutes){
    ThisMinutes <- (floor(TimeStamp) == MinutesFloor[j])
    PriceMin[j] <- mean(price[ThisMinutes])
    VolumeMin[j] <- sum(volume[ThisMinutes])

    } 
```

提前致谢

数据格式：

日期，“ord”，“股票”，“FinalPrice”，“时间”，“库存”
20100301，C，80,389,540.004,1158
20100301，C，77,89,540.004,1158
20100301，C，60,389,540.004,1158
20100301，C，28,389,540.004,1158
20100301，20100 ，C，7,389,540.004,1158
20100302，C，25,394.7,540.00293333,1158
20100302，C，170,394.7,540.00293333,1158
20100302，C，40,394.7,540.00293333,1158
20100302，C，75,394.7,540.00293333,1158
20100302，C，100,394.7,540.00293333， 1158
20100302,C,1,394.7,540.00293333,1158

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T20:32:32.163

我想建议您的代码的一个彻底简化的版本。

你正在做很多相当低效的事情。R 用于计算由不同数据值聚类的汇总统计信息。我们将大量使用这种方法。

我假设您的数据是您提供的形式。在我的系统中，这看起来像

```
novo <- read.csv("test.csv", header = TRUE, stringsAsFactors=FALSE  ) 
```

这给了我们：

```
> str(novo)
'data.frame':   11 obs. of  6 variables:
 $ date      : int  20100301 20100301 20100301 20100301 20100301 20100302 20100302 20100302 20100302 20100302 ...
 $ ord       : chr  "C" "C" "C" "C" ...
 $ shares    : int  80 77 60 28 7 25 170 40 75 100 ...
 $ finalprice: num  389 389 389 389 389 ...
 $ time      : num  540 540 540 540 540 ...
 $ stock     : int  1158 1158 1158 1158 1158 1158 1158 1158 1158 1158 ... 
```

现在，我假设您的日期是 YearMonthDate。如果您有不同的顺序，则必须更改下面的格式命令。此外，您`time`可能会在几分钟内完成。

然后我们可以使用数据类型创建包含日期和时间的时间戳`POSIXct`：

```
timestamps <- as.POSIXct(as.character(novo$date), format='%Y%m%d') + novo$time*60 
```

`cut`现在，我们通过创建一个因子变量并使用函数来进行四舍五入：

```
timestampsByMinute <- droplevels(cut(timestamps, 'min')) 
```

请注意，附加`droplevels`功能只是删除没有可用数据项的分钟。

最后，我们可能会计算您在`for`-loop 中所做的汇总统计信息：

`tapply`是一个接受它的第一个参数的函数，将它分成由第二个参数定义的组，并将作为第三个参数给出的函数应用于该数据。`tapply`因此，我们可能只是将函数扔到您的数据上。（我觉得您在代码中使用的列号与示例数据中的列名不匹配 - 如果我以错误的方式解释您的意思，请随时适应不同的列）

```
PriceMin <-  tapply(novo$finalprice, timestampsByMinute, mean)
VolumeMin <- tapply(novo$shares, timestampsByMinute, sum) 
```

这给了我们

```
> PriceMin
2010-03-01 09:00:00 2010-03-02 09:00:00 
              389.0               394.7 
> VolumeMin
2010-03-01 09:00:00 2010-03-02 09:00:00 
                252                 411 
```

这可能是你想要的。

请注意，这`tapply`比您使用的循环快得多。如果您有巨大的数据文件，这可能很重要。

我希望我的代码中没有留下任何错误 - 鉴于您每天只提供一分钟的数据，因此测试并不容易。

* * *

编辑：

根据要求，这里进行了一个小的修改，从数据中删除了时间信息：

```
> unname(VolumeMin)
[1] 252 411

> unname(PriceMin)
[1] 389.0 394.7 
```

# selenium - 硒网格，以编程方式创建节点

> ID：13497766
> 
> 赞同：0
> 
> 时间：2012-11-21T16:32:11.467
> 
> 标签：selenium, grid, registration, nodes

我必须创建一个 java 应用程序来启动一个节点并将其连接到集线器。到目前为止，当集线器和节点在同一台计算机上时，我已经能够这样做，但是一旦我尝试在另一台机器集线器上连接，注册过程就会永远挂起。

我尝试了不同的方法。只需在代码中调用我的 bat 文件函数。

```
String command = "java -jar selenium-server-standalone-2.26.0.jar -role node -hub http://192.168.0.11:4444/grid/register -port 4449 -Dwebdriver.chrome.driver=data\\driver\\chromedriver.exe -Dwebdriver.ie.driver=data\\driver\\IEDriverServer.exe -nodeConfig data\\configurations.json";

    try
    {
        pr = Runtime.getRuntime().exec(command);
    }
    catch(Exception e)
    {
        e.printStackTrace();
    } 
```

该命令在从 bat 文件调用时有效，但在代码中它仅在节点和集线器位于同一台计算机上时才有效。

我也尝试使用 RegistrationRequest。

```
RegistrationRequest req = new RegistrationRequest();
                req.setRole(GridRole.NODE);

                Map<String, Object> nodeConfiguration = new HashMap<String,
                Object>();

                nodeConfiguration.put(RegistrationRequest.AUTO_REGISTER, true);
                nodeConfiguration.put(RegistrationRequest.HUB_HOST, "192.168.100.66");

                nodeConfiguration.put(RegistrationRequest.HUB_PORT, 4444);
                nodeConfiguration.put(RegistrationRequest.PORT, 5555);

                URL remoteURL = new URL("http://" + "192.168.100.66" + ":" + 5555);
                nodeConfiguration.put(RegistrationRequest.PROXY_CLASS, "org.openqa.grid.selenium.proxy.DefaultRemoteProxy");
                nodeConfiguration.put(RegistrationRequest.MAX_SESSION, 1);
                nodeConfiguration.put(RegistrationRequest.CLEAN_UP_CYCLE, 2000);
                nodeConfiguration.put(RegistrationRequest.REMOTE_HOST, remoteURL);
                nodeConfiguration.put(RegistrationRequest.MAX_INSTANCES, 1);

                req.setConfiguration(nodeConfiguration);

                remote = new SelfRegisteringRemote(req);
                remote.startRemoteServer();
                remote.startRegistrationProcess(); 
```

同样的结果，当我尝试在另一个计算机集线器上运行时，它会提交注册过程。信息 - 将节点注册到集线器：http://192.168.100.66:4444/grid/register

知道为什么吗？或者怎么做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T19:34:05.183

我想出了我的问题，这很容易解决。在我的代码中

```
URL remoteURL = new URL("http://" + "192.168.100.66" + ":" + 5555); 
```

我只需要用我的本地 IP 地址而不是集线器 IP 地址替换 IP 地址，就可以了。这很奇怪，因为我很确定我是从网上某处获取这段代码的，他有一个 ip 变量，remoteURL 和 HUB_HOST 也是一样

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T17:11:54.193

出色地。不确定是否适合您，但我想分享我在项目中使用的方法。我有一台 IP 为 192.168.4.52 的远程机器和运行在它上面的 selenium stanadlone 服务器。我在本地获得的所有硒测试套件。因此，要在远程机器上运行我的 selenium 测试套件，我只需在本地机器上的 BaseSeleniumTest.java 中使用这些设置：

```
....
@BeforeClass
    public static void firefoxSetUp() throws MalformedURLException {

          DesiredCapabilities capability = DesiredCapabilities.firefox();

        driver = new RemoteWebDriver(new URL("http://192.168.4.52:4444/wd/hub"), capability);

        driver.manage().timeouts().implicitlyWait(20, TimeUnit.SECONDS);
        driver.manage().timeouts().pageLoadTimeout(30, TimeUnit.SECONDS);
        driver.manage().window().setSize(new Dimension(1920, 1080));
    }
    @Before
    public void homePageRefresh() throws IOException {

        driver.manage().deleteAllCookies();
        driver.get(propertyKeysLoader("login.base.url"));
    }

    @AfterClass
    public static void closeFirefox(){
        driver.quit();
    } 
```

字符串在哪里

```
driver = new RemoteWebDriver(new URL("http://192.168.4.52:4444/wd/hub"), capability); 
```

指示我要在其上运行硒测试的机器的 IP。我正在使用以下命令在远程机器上启动服务器： `java -jar selenium-server-standalone-2.26.0.jar` 在运行我的测试套件之前在 cmd 中。希望对您有所帮助。

# cakephp - 无法从 cakePHP shell 保存到 wincache

> ID：13497772
> 
> 赞同：0
> 
> 时间：2012-11-21T16:33:27.187
> 
> 标签：cakephp, caching

我正在尝试通过他们的 API 从 wunderground.com 检索天气，并将其存储在 wincache 中。出于测试目的，我在 News 模型中创建了这个函数：

```
public function updateWeather(){
    $results = file_get_contents('http://api.wunderground.com/api/**api_key**/conditions/q/CA/Montreal.json');
    $results = json_decode($results);
    return Cache::write('weather', $results);
} 
```

当我从控制器调用它时它工作正常。但是，我不明白为什么从控制台调用相同的函数时不起作用。我制作了这个 shell 是为了最终将它添加到 windows 任务调度程序中。

```
class WeatherShell extends AppShell {
    public $uses = array('News');

    public function main() {
        $this->News->updateWeather();
    }
} 
```

调试时，我看到 $results 已正确填充。我从 Cache::write() 得到“真”，但是，在尝试读取时我得到“假”。

在新闻控制器中调用以下操作时，随时完成缓存读取

```
public function diaporama(){
    $this->set('weather', Cache::read('weather'));
} 
```

这是我在 bootstrap.php 中的缓存配置

```
Cache::config('default', array(
    'engine' => 'Wincache',
    'duration'=> 3600,
    'probability'=> 100,
    'prefix' => ''
)); 
```

# single-sign-on - simplesamlphp 获取属性返回值不是预期的

> ID：13497773
> 
> 赞同：0
> 
> 时间：2012-11-21T16:32:26.560
> 
> 标签：single-sign-on, saml-2.0, openam

我已经设置了 OpenAM 和 SimpleSAMLPhp。我可以通过 OpenAM“Test Fed”和 SimpleSAMLPhp 中的“Auth”页面进行身份验证，所以我相信它一切正常。

但是，当我对用户进行身份验证时，然后打印出来：

```
$attributes = $as->getAttributes();
$attrs = print_r($attributes, true);

print '<pre>Attrs: ' . $attrs . '</pre>'; 
```

我得到以下信息：

```
Attrs: Array
(
    [groups] => Array
    (
        [0] => users
        [1] => members
    )

) 
```

正如我所期望的那样：

```
inetuserstatus=[true], 
sn=[Healy], 
givenname=[Gareth], 
userpassword=xxx..., 
uid=[gareth.healy@localhost.com] 
```

如果我调用 REST API [http://auth.localhost.com:8080/openam/identity/attributes?subjectid=](http://auth.localhost.com:8080/openam/identity/attributes?subjectid=) ... 它会按预期返回值。

我也包括了[saml 响应](http://bit.ly/UTelIS)。这是 OpenAM/SimpleSAMLPhp 设置问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T23:38:09.950

正如您可能知道的那样，SAML 与 Identity Web Services（与 REST 一起使用并返回“属性资源”的默认属性集）完全不同。

您可以通过在 OpenAM 端为服务提供者配置属性映射，将属性语句包含到 SAML 身份验证响应中。

您要映射的属性必须在数据存储配置中可用。

# sql - 如何在查询 SQL 中查找映射到相应列的列的出现

> ID：13497776
> 
> 赞同：0
> 
> 时间：2012-11-21T16:32:30.373
> 
> 标签：sql, oracle

我有一个查询如下

```
select custref, tetranumber 
from
    (select * 
     from cdsheader h, custandaddr c 
     where h.custref=c.cwdocid and c.addresstype = 'C' )
where tetranumber = '034096' 
```

目标是第二列应该只有一个对应的第一列

例如：034096 应该始终将 2600135 作为第一列

我想检查 034096 除了 2600135 之外是否还有任何值。

（我是一名 java 开发人员，并提出了一个解决方案来避免数据的 1 到 n 或 n 到 n 映射，但是 DB（Oracle）中已经有坏数据，所以我想检查是否有坏数据，以便我可以删除数据）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T17:05:01.760

回复：*目标是第二列应该只有一个对应的第一列* 您需要执行一个聚合函数，如 MAX 或 MIN，以确定返回哪一行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T15:53:39.967

谢谢各位回复，

我已经找到方法了，就这样……

select custref, count(distinct(tetranumber)) from( select custref, tetranumber from cdsheader h, cusstandaddr c where h.custref=c.cwdocid and c.addresstype = 'C') 按具有 count(distinct(tetranumber)) 的 custref 分组>1

# testing - 如何减少/减少黑莓模拟器的应用程序存储和内置内存存储？

> ID：13497779
> 
> 赞同：2
> 
> 时间：2012-11-21T16:33:33.263
> 
> 标签：testing, mobile, blackberry, blackberry-simulator, blackberry-jde

如何减少/减少黑莓模拟器的应用程序存储和内置内存存储？

因为我需要它来测试我的黑莓应用程序在低内存上的行为。我正在使用黑莓模拟器 9860。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T16:51:31.593

如果您使用的是 eclipse 插件，您可以转到`Run configurations -> Simulator tab -> Memory tab`并使用堆大小字段和 SDCard 大小中的值。从来没有尝试过，所以我不知道它是否有效。

* * *

更新：
如果您单独使用模拟器，您可以从命令行更改选项。在命令行 shell 中打开模拟器目录。那里有一个名为`fledge.exe`. 要更改堆大小，请键入：

```
fledge /heap-size={<size in bytes>} 
```

默认堆值为 94.68 MB。

有关可以更改的内存设置的更多信息，请键入“ `fledge /help`”并单击对话框中的“内存”部分。

# android - 在 Android 软件中打印多条消息

> ID：13497786
> 
> 赞同：1
> 
> 时间：2012-11-21T16:34:11.080
> 
> 标签：android

我一直在搜索其他 stackoverflow 问题并查看 android 开发人员指南，但我还没有找到解决方案。在我的程序中，我要求用户输入他们刚刚收到的家庭作业。从那里我收到该消息并将其打印在新屏幕上。我想要做的是保存以前输入的消息，并每次将它们与新消息一起打印出来。我遇到的问题是一次打印多条消息。我使用了 setContentView 但它只打印一条消息。有人有建议吗？我在底部发布了我的代码：

```
 public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_display_message);
    getActionBar().setDisplayHomeAsUpEnabled(true);

 // Get the message from the intent
    Intent intent = getIntent();
    String message = intent.getStringExtra(MainActivity.EXTRA_MESSAGE);

    // Create the text view
    TextView textView = new TextView(this);
    textView.setTextSize(40);
    textView.setText(message);

    saveHomework(message);

    // Set the text view as the activity layout
    setContentView(textView);

}

public void saveHomework(String message)
{
    String message2 = message;

    TextView textView2 = new TextView(this);
    textView2.setTextSize(40);
    textView2.setText(message2);

    setContentView(textView2);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T16:42:48.550

好吧，显然您应该在某个地方保留所有以前输入的消息。

您的选择：

1.  如果您确定您的活动流程在用户可以输入消息时一直处于活动状态，您可以使用活动的一些静态变量并将消息存储在列表或数组中。
2.  如果您的流程可以关闭，您应该使用[SharedPreferences](http://developer.android.com/reference/android/content/SharedPreferences.html)将消息存储在一个文件中。

然后，无论您想在哪里显示消息，都应该从保存它们的位置读取它们，并将它们一起传递给 setText(messages_list) 调用。

# mysql - 如果值存在，更新

> ID：13497789
> 
> 赞同：2
> 
> 时间：2012-11-21T16:34:24.717
> 
> 标签：mysql

好的，我有一张桌子，我将在其中收集用户设备。当用户登录时，我希望它注册设备，如果它已经存在，它只想更新时间戳。仅当用户登录时。

该表如下所示：

```
device_id => BIGINT AUTOINCREMENT PRIMARY KEY
user_id => BIGINT FOREIGN KEY users(id)
device_name => VARCHAR(40) (Will be like 'Donald ducks iphone')
device_type => VARCHAR(10) (Will be defined by the client, like "IOS")
last_usage => TIMESTAMP (On update, new timestamp and all that) 
```

因此，当用户登录时，我有 user_id、device_name、device_type。

我想要的：如果 id、name 和 type 已经连续存在，只需更新时间戳，否则插入值。

由于这与主键无关，我不知道该怎么做。当然，我可以做一些事情，比如先选择这些值，然后返回，然后进行更新/插入，但这感觉不对:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T16:37:07.243

您可以在 MySQL 5.0+中使用[REPLACE ：](http://dev.mysql.com/doc/refman/5.0/en/replace.html)

> REPLACE 的工作方式与 INSERT 完全相同，只是如果表中的旧行与 PRIMARY KEY 或 UNIQUE 索引的新行具有相同的值，则在插入新行之前删除旧行

例子：

```
REPLACE INTO TableName (user_id, device_id, device_name, device_type, last_usage) VAULES (1, 2, "Test Device Name, "Test Type", NOW()); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-21T16:36:24.307

首先，制作`device_name`独特`device_type`。

现在你有几个选择。您可以使用：

```
INSERT IGNORE INTO devices (...) VALUES(...) 
```

或者如果您担心重要错误可能会被忽略，请使用：

```
INSERT INTO devices (...) VALUES(...)
ON DUPLICATE KEY UPDATE device_id = device_id 
```

请注意，这与`REPLACE`它根本不会影响旧记录不同，而是`REPLACE`会创建一个新的 ID 和时间戳。

编辑：由于您现在要更新时间戳，请使用：

```
INSERT INTO devices (...) VALUES(...)
ON DUPLICATE KEY UPDATE last_usage = NOW() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T16:36:41.067

```
For Each r In Me.Lstbox_Tables.ItemsSelected

'Create a recordset with required data

sql = "SELECT * FROM " & Me.Lstbox_Tables.ItemData(r)

'tablename = "Gahpp00d_" + rs!Table_Name

Set rs = db.OpenRecordset(sql, dbReadOnly)

Dim SheetName As String

SheetName = Replace(Me.Lstbox_Tables.ItemData(r), "GAHPP00D_", "")

On Error Resume Next

excelWbk.Sheets(SheetName).Select

If Err.Number <> 0 Then

MsgBox Err.Number & ":" & Err.Description, vbCritical, "ERROR!!!"

MsgBox "Worksheet " & SheetName & " doesn't exist.", vbCritical, "Sheet Missing!!!"

excelWbk.Close False

appExcel.Quit

 Exit Sub

 End If 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T16:45:30.340

您可能需要将其转换为 mysql 作为其 mssql，但类似于以下内容：

```
declare @count int
declare @user varchar
declare @machine varchar
declare @type as varchar

select @count = (select count(*) from [table] where user = @user and machine=@machine and type=@type)

if @count = 0
begin
insert into
[table]
select
@machine,
@user,
@type,
current_timestamp
end

if @count > 0
begin
update
[table]
set timestamp = current_timestamp
where
machine = @machine
and
user = @user
and
type = @type
end 
```

问候，

马库斯

# python - 分配的 Python 对齐方式（样式）

> ID：13497793
> 
> 赞同：36
> 
> 时间：2012-11-21T16:34:39.410
> 
> 标签：python, coding-style, pep8

我真的很喜欢遵循 ​​PEP 8 中指定的样式标准。我有一个自动检查它的 linter，因此我的代码肯定要好得多。

PEP 8 中只有一点，E251 和 E221 感觉不是很好。来自 JavaScript 背景，我曾经将变量分配对齐如下：

```
var var1        = 1234;
    var2        = 54;
    longer_name = 'hi';

var lol = {
    'that'        : 65,
    'those'       : 87,
    'other_thing' : true
}; 
```

在我看来，这极大地提高了可读性。问题是，PEP 8 不建议这样做。对于字典，这还不错，因为冒号后面允许有空格：

```
dictionary = {
   'something':        98,
   'some_other_thing': False
} 
```

我可以在没有对齐的情况下“生活”变量赋值，但我根本不喜欢的是不能在函数调用中传递命名参数，如下所示：

```
some_func(length=      40,
          weight=      900,
          lol=         'troll',
          useless_var= True,
          intelligence=None) 
```

所以，我最终做的是使用字典，如下所示：

```
specs = {
    'length':       40,
    'weight':       900,
    'lol':          'troll',
    'useless_var':  True,
    'intelligence': None
}

some_func(**specs) 
```

或者只是简单地

```
some_func(**{'length':       40,
             'weight':       900,
             'lol':          'troll',
             'useless_var':  True,
             'intelligence': None}) 
```

但我觉得这种解决方法比忽略 PEP 8 E251 / E221 更糟糕。

最佳做法是什么？

**多年后编辑**

不要对齐。迟早会出现一个更长的新变量，您将不得不在这里和那里按空格键一段时间，直到一切看起来都恢复正常。不值得。

**多年后编辑** 只需使用像黑色这样的代码格式化程序并将其用作预提交和/或您的 CI。然后忘记这个。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-11-21T16:41:51.830

最佳做法是主观的，但最常见的做法是坚持 PEP8。

我绝对不建议您每次要使用命名参数调用函数时都创建字典。这很浪费。我不明白为什么你原来的`some_func`电话不起作用。如果函数调用太长且笨拙，我肯定会将它们分成几行。但我不对齐它们。我想推荐的原因是因为随着时间的推移正确保持所有间距可能会变得非常痛苦，并且共识是可维护性而不是美观的增益。

如果您正在编写自己的代码，请保持一致，谁在乎？PEP8 是指导方针，而不是法律。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T16:40:57.573

> 所以，我最终做的是使用字典，如下所示：

```
specs = {
    length:      40,
    weight:      900,
    lol:         'troll',
    useless_var: True,
    intelligence:None
} 
```

恕我直言 - 这不太可读（如果它是有效的语法而不引用键），如果我碰巧想添加`some_longer_named_varible`，我真的不确定我是否想重新调整其他所有内容的间距。

我想你应该咬紧牙关，我害怕。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-21T16:50:25.450

我建议坚持使用 PEP8。如果您需要更改其中一个变量的名称，会发生什么？自动重构工具将改变这一点：

```
var1        = 1234
var2        = 54
longer_name = 'hi' 
```

对此：

```
var1        = 1234
var2        = 54
even_longer_name = 'hi'  # not aligned any more! 
```

你最终会为自己做更多的工作来保持一致。

# haskell - 可以在没有显式递归的情况下编写此代码吗？[Project Euler #31 剧透]

> ID：13497796
> 
> 赞同：1
> 
> 时间：2012-11-21T16:34:48.963
> 
> 标签：haskell

这个函数是解决 Project Euler 问题的核心：

```
numWays tot (d:ds) = sum $ map (flip numWays ds . (tot -)) [0, d .. tot]
numWays tot []
    | tot == 0     = 1
    | otherwise    = 0 
```

我想相信它可以在没有显式递归的情况下被重写，但是递归在映射下的事实阻碍了我找到它的努力。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T17:19:18.370

```
import Data.List (genericLength)

numWays' tot = genericLength . filter (== 0) . foldl snoc [tot] where
        snoc tots d = concatMap f tots where
                f tot = map (tot -) [0, d .. tot] 
```

我使用`genericLength`代替，`length`以便 my与您的( )`numWays'`具有相同的类型。`numWays``(Num c, Num b, Enum b) => b -> [b] -> c`

这里的想法是，我们不是计算一（对于零残差总数）或零（对于非零残差总数）并将它们求和，而是将函数分解为生成残差列表的递归函数，然后（非递归）计算该列表中有多少个零。

这样做的目的是它给我们留下了一个递归函数，我们可以更容易地从中删除递归。

# c++ - 更改或检查 std::ofstream 的打开模式

> ID：13497799
> 
> 赞同：7
> 
> 时间：2012-11-21T16:34:57.793
> 
> 标签：c++, iostream, ofstream, c++03

在一些使用 执行大量文件 i/o 的代码中`std::ofstream`，我正在缓存流以提高效率。但是，有时我需要更改文件的打开模式（例如追加与截断）。这是一些类似的模拟代码：

```
class Logger {
public:
    void write(const std::string& str, std::ios_base::openmode mode) {
        if (!myStream.is_open) myStream.open(path.c_str(), mode);
        /* Want: if (myStream.mode != mode) {
                     myStream.close();
                     myStream.open(path.c_str(), mode);
                 }
        */
        myStream << str;
     }
private:
    std::ofstream myStream;
    std::string path = "/foo/bar/baz";
} 
```

有谁知道：

*   有没有办法改变openmode的`ofstream`？
*   如果没有，有没有办法找出当前`openmode`的 an`ofstream`是什么，以便我可以仅在必要时关闭并重新打开它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T18:55:33.717

@Ari由于默认实现不允许您想要做的事情，您可能必须封装 ofstream 并提供额外的获取/设置开放模式功能，您的新对象将在其中模拟所需的行为。

也许是这样的

```
class FileOutput{
  private:
    ostream& streamOut;
    std::ios_base::openmode currentOpemMode;
  public:
    FileOutput(ostream& out, std::ios_base::openmode mode)
     : streamOut(out), currentOpemMode(mode){}

    void setOpenMode(const std::ios_base::openmode newOpenMode){
          if(newOpenMode != currentOpemMode){
              currentOpemMode = newOpenMode;
              updateUsedMode();
          }
    }
  private:
    void updateUsedMode(){
          if(currentOpemMode == ios_base::app){  /* use seekg/tellg to move pointer to end of file */}
          else if(currentOpenMode == binary){ /* close stream and reopen in binary mode*/}
         //...and so on
}; 
```

# java - Java乐透模拟

> ID：13497803
> 
> 赞同：1
> 
> 时间：2012-11-21T16:35:04.033
> 
> 标签：java, arrays, loops

我正在编写一个程序，模拟 1 到 45 之间的六个数字的乐透抽奖，示例输出为 3 7 12 27 43 28。但我想做的是计算相邻数字出现的次数，例如 1 4 5 29 26 41 是肯定的答案，因为 5 在 4 之后。

最好的方法是什么？

我尝试过以下示例：

```
int adjacent=0;

    for(int i =0; i<6; i++)
    {
        int t = test[i]+1;
        test[i]=(int)(45*Math.random())+1;

        if(test[i]==t)
            adjacent++;

        System.out.print(test[i]+"    ");
    } 
```

这不起作用。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T16:59:15.870

您需要分离生成唯一的（因此下面的 HashSet 以确保身份）随机选择，对它们进行排序，然后确定邻接：

```
import java.util.HashSet;
import java.util.Arrays;

public class Lotto 
{
    public Lotto()
    {

    }

    /**
     * @param args
     */
    public static void main(String[] args) 
    {
        Lotto lotto = new Lotto();
        lotto.randomizeSelections(5);
    }

    private void randomizeSelections(int numOfArrays)
    {
        for(int i = 0; i < numOfArrays; i++)
        {
            int[] selArry = new int[6];
            //to insure that each random selection is unique
            HashSet<Integer> idntySet = new HashSet<Integer>();

            for(int j = 0; j < 6;)
            {
                int rndm = (int)(45 * Math.random()) + 1;

                //add selection to the array only if it has not been randomized before
                if(!idntySet.contains(rndm))
                {
                    selArry[j] = rndm;

                    j++;
                }

            }

            //sort the array for determing adjacency
            Arrays.sort(selArry);

            for(int j = 0; j < 6; j++)
            {
                int sel = selArry[j];
                boolean isAdjcnt = (j > 0 && (sel == selArry[j - 1] + 1)) ? true : false;

                System.out.println(i + "." + j + ".random = " + sel);

                if(isAdjcnt) System.out.println("\tAdjacent");

            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T16:45:03.480

我认为你只是有一个操作顺序问题

```
int adjacent=0;

for(int i =0; i<6; i++)
{
    //test[i] hasn't been set yet
    int t = test[i]+1;
    test[i]=(int)(45*Math.random())+1;

    //this comparison doesn't make a whole lot of sense
    if(test[i]==t)
        adjacent++;

    System.out.print(test[i]+"    ");
} 
```

把它改成这样：

```
int adjacent=0;

for(int i =0; i<6; i++)
{
    test[i]=(int)(45*Math.random())+1;
    int t = -1;
    //Make sure this comparison only happens after the second iteration
    //to avoid index out of bounds
    if ( i != 0 ) 
    {
        //Set t to the last number + 1 instead of trying to predict the future
        t = test[i-1] + 1;
    }
    //Now this comparison makes a little more sense
    //The first iteration will compare to -1 which will always be false
    if(test[i]==t)
        adjacent++;

    System.out.print(test[i]+"    ");
} 
```

这可以进一步简化为：

```
int adjacent=0;

for(int i =0; i<6; i++)
{
    test[i]=(int)(45*Math.random())+1;

    if(i != 0 && test[i]==(test[i-1]+1))
        adjacent++;

    System.out.print(test[i]+"    ");
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T16:37:56.320

我认为你应该洗牌并采取任何五个。`Collections#Shuffle`会帮助你，它使用默认的随机源排列指定的列表。所有排列都以大致相等的可能性发生。

```
List<Integer> list = ArrayList<Integer>();
list.add(1);
list.add(2);
Collections.shuffle(list);
Random rnd = new Random();
Integer[] result = new Integer[5];
result[0] = list.get(rnd.getNextInt(45));
result[1] = list.get(rnd.getNextInt(45));
result[2] = list.get(rnd.getNextInt(45));
result[3] = list.get(rnd.getNextInt(45));
result[4] = list.get(rnd.getNextInt(45)); 
```

它总是给你随机值，然后你应该对它进行排序以按顺序排列它，比如升序。

```
Arrays.sort(result); 
```

现在您可以编写一个循环来找出相邻的数字。

```
int adjacent = 0;
for(int i=1; i<result.length;i++){
   int prev = result[i-1];
   int now = result[i];
   if(prev+1 == now)
    adjacent++;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T16:38:44.793

在您生成 6 个数字并将它们放入一个数组之后。使用`Arrays.sort()`. 然后，您可以比较相邻的数组条目。

您还应该避免使用 Random 来生成 6 个数字，因为它可以生成重复。这可能会或可能不会准确模拟您的乐透抽奖。Quoi 的回答对此有很好的建议。

# sql - 反透视 sql 表

> ID：13497804
> 
> 赞同：0
> 
> 时间：2012-11-21T16:35:04.237
> 
> 标签：sql, tsql, sql-server-2005, pivot, unpivot

```
A_first B_first C_first  A_second  B_second  C_second A_third  B_third  C_third
638      450     188       638       439       187      546      256      789 
```

我有一张这样的桌子，只有一排。我怎样才能旋转这一行，以便我得到每个, ,`A` `B` `C`的列和一行？`_first``_second``_third`

我正试图围绕 sql 中的 pivot/unpivot 命令

```
A          B      C     
638      450     188     
638      439     187     
546      256     789 
```

使用 SQL Server 2008，所以我有 pivot/unpivot 命令。更具体地说，SSMS 告诉我我连接到的数据库是`9.0 SP3`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T16:37:13.513

您没有指定您使用的 RDBMS，所以这里有两个解决方案。如果你有一个`UNPIVOT`函数，然后是一个`PIVOT`：

```
select *
from
(
  select value, left(fields, 1) col,
    substring(fields, 3, len(fields) -2) row
  from yourtable
  unpivot
  (
    value
    for fields in(A_first, B_first, C_first,
                  A_second, B_second, C_second,
                  A_third, B_third, C_third)
  ) unpiv
) src
pivot
(
  max(value)
  for col in ([A], [B], [C])
) piv 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/651a4/10)

如果您没有`UNPIVOT`and`PIVOT`功能，那么您可以使用`UNION ALL`：

```
select
  max(case when col = 'A' then value end) A,
  max(case when col = 'B' then value end) B,
  max(case when col = 'C' then value end) C
from
(
  select value, left(fields, 1) col, substring(fields, 3, len(fields) -2) row
  from
  (
    select A_first value, 'A_first' fields
    from yourtable
    union all
    select B_first value, 'B_first' fields
    from yourtable
    union all
    select C_first value, 'C_first' fields
    from yourtable
    union all
    select A_second value, 'A_second' fields
    from yourtable
    union all
    select B_second value, 'B_second' fields
    from yourtable
    union all
    select C_second value, 'C_second' fields
    from yourtable
    union all
    select A_third value, 'A_third' fields
    from yourtable
    union all
    select B_third value, 'B_third' fields
    from yourtable
    union all
    select C_third value, 'C_third' fields
    from yourtable
  ) unpiv
) src
group by row 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/651a4/9)

两者都会产生相同的结果：

```
|   A |   B |   C |
-------------------
| 638 | 450 | 188 |
| 638 | 439 | 187 |
| 546 | 256 | 789 | 
```

请注意，为了执行此任务，每列的数据类型必须相同。如果它们不是，那么您将需要`convert`在`UNPIVOT`.

这个答案做了一些假设：

1.  现有列将始终以新列值开头（`A`、 `B`或`C`等）
2.  现有列将始终以行号前的两个字符开头。

# jquery - Flexslider 中的 HTML5 视频暂停（Woothemes）

> ID：13497806
> 
> 赞同：1
> 
> 时间：2012-11-21T16:35:08.067
> 
> 标签：jquery, html, flexslider

有没有人在 Flexslider (Woothemes) 中成功实现 HTML5 视频？一旦视频开始播放，我无法弄清楚如何暂停幻灯片放映。我搜索了 Flexslider 文档，他们只有关于如何使用 Vimeo 完成此任务的建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-02-09T21:18:05.253

我一直在玩 flexSlider html5 视频，这对我有用：

HTML 标记与任何 flexslider 基本相同，只需记下包含视频的幻灯片的 id：

```
<div class="flexslider" id="slider">
  <ul class="slides">
    <li id="slide1"><img src="./images/slides/slide1.jpg"></li>
    <li id="slide2"><img src="./images/slides/slide2.jpg"></li>
    <li id="slide3"><video id="myVideo" src="./videos/myVideo.mp4" style="width:100%;"></video></li>
  </ul>
</div> 
```

然后是Java

```
<script>
$(window).load(function() {
  $('.flexslider').flexslider({
    animation: "fade",
    controlNav: false,
    slideshowSpeed: "5000",
    after: function(){
        // sets active_id to the active slide
        var active_id = $('.flex-active-slide').attr('id');
        //if the active slide is the video slide...  
        if( active_id == "slide3"){
          //play the video and pause the slider
          myVideo.play();
          $('.flexslider').flexslider("pause");
          //when the video has ended, go to the next slide and play the slider
          myVideo.onended = function(){
              $('.flexslider').flexslider("next");
              $('.flexslider').flexslider("play");
          }
        }
    },
  });
});
</script> 
```

这就是对我有用的东西。

如果您想在幻灯片出现时添加 CSS 动画，请尝试将动画的类添加到 ID 而不是播放视频。就像是：

```
$(active_id).addClass("slideUp"); 
```

那应该添加CSS类，它将触发动画..但是当幻灯片完成时您可能需要将其删除，以便在您的幻灯片循环时再次触发..我没有太多玩它的经验，但应该让你走上正确的轨道。希望有帮助:-)

# c++ - 在分治多项式乘法的代码中查找错误

> ID：13497810
> 
> 赞同：0
> 
> 时间：2012-11-21T16:34:29.667
> 
> 标签：c++, polynomial-math

我正在尝试使用 Karatsuba 的方法为多项式乘法实现一个简单的分而治之算法，即使用该方法进行`p=a+b*x^k`, , `q=c+d*x^k`with和递归计算, 其中某处接近or度数的一半。`p*q=ac+(ad+bc)x^k+bd*x^(2k)``ad+bc=ac+bd-(a-b)*(c-d)``ac,bd,(a-b)(c-d)``k``p``q`

以下代码在用于对度数 >= 64 左右的多项式（随机生成的介于 0 和 9 之间的整数系数）求平方时崩溃而没有错误消息，但似乎适用于较小的度数。

补充：（程序没有正确终止。另外，对于 64 级，应该只使用大约 3^(log(64))=729 递归函数调用，所以我认为如果代码有效，可以排除堆栈溢出正如在这方面的意图。）

单独使用的蛮力功能似乎在很大程度上也可以正常工作。

```
struct poly {
 int deg;
 double* coeff;
};

poly stdpolmult(poly p,poly q) { // standard algorithm 
 poly r;

 r.deg= p.deg+q.deg;
 r.coeff = (double*) calloc (r.deg,sizeof(double));
 int i,j;

 for (i=0;i<=p.deg;i++)
  for (j=0;j<=q.deg;j++)
   r.coeff[i+j]=r.coeff[i+j]+p.coeff[i]*q.coeff[j];

 return r;
}

poly fastpolmult(poly p,poly q) {  // Divide & Conquer
 if ((p.deg<=7)&&(q.deg<=7))
  return stdpolmult(p,q); // brute force

 poly a,b,c,d,u,v,x,y,w,z,s,r;
 int k=p.deg/2;
 if (p.deg<q.deg)
  k=q.deg/2;
 a=polfirstpart(p,k);
 b=pollastpart(p,k);
 c=polfirstpart(q,k);
 d=pollastpart(q,k); /* let p=p_1+x^k*p_2, q=q_1+x^k+q_2, then
                       a= p_1,b=p_2,c=q_1,d=q_2 */

 u = fastpolmult(a,c); // u =p_1*p_2
 v = fastpolmult(b,d); // v =q_1*q_2
 polneg(b); // b= -p_2
 polneg(d); // d= -q_2
 x=poladd(a,b); // x=p_1-p_2
 y=poladd(c,d); // y=q_1-q_2
 w=fastpolmult(x,y); // w=(p_1-p_2)*(q_1-q_2)
 polneg(w); // w= -(p_1-p_2)*(q_1-q_2)
 z=poladd(u,v); // z=p_1*p_2+q_1*q_2
 s=poladd(z,w); // s=p_1*p_2+q_1*q_2-(p_1-p_2)*(q_1-q_2) = p_1*q_2+p_2*q_1

 polfree(z); polfree(w); polfree(x); polfree(y);

 x=polshift(s,k); // x=(p_1*q_2+p_2*q_1)*x^k
 y=polshift(v,2*k); // y=q_1*q_2*x^(2k)

 z=poladd(u,x); // z=p_1*p_2+(p_1*q_2+p_2*q_1)*x^k
 r=poladd(z,y); // r = p_1*p_2+(p_1*q_2+p_2*q_1)*x^k +q_1*q_2*x^(2k) = p*q

 polfree(x);polfree(y);polfree(z);

 return r;
 } 
```

如果需要，我可以为使用的函数（polfirstpart、pollastpart、polneg、poladd、polshift、polfree）添加我的代码。他们没什么特别的。（我单独测试了它们，它们似乎有效）。

补充：大多数这些功能的代码：

```
poly poladd(poly p,poly q) {
 int i,n;
 poly r;
 if (p.deg>=q.deg)
  r.deg=p.deg;
 else
  r.deg=q.deg;
 r.coeff = (double*) calloc (r.deg+1,sizeof(double));
 if (p.deg<=q.deg)
  n=p.deg;
 else
  n=q.deg;

 for (i=0;i<=n;i++)
  r.coeff[i]=p.coeff[i]+q.coeff[i];

 if (p.deg>q.deg)
  for (i=n+1;i<=p.deg;i++)
   r.coeff[i]=p.coeff[i];
 else
  for (i=n+1;i<=q.deg;i++)
   r.coeff[i]=q.coeff[i];

 return r;
}

poly polfirstpart(poly p, int k) { /* if p=a+x^k*b, take a */
 poly r;
 if (k<=0)
  return zpol; // zero pol
 if (k>p.deg)
  return p;
 r.coeff=p.coeff;
 r.deg=k-1;
 return r;
}

 poly pollastpart(poly p,int k) { /* if p=a+x^k*b, take b */
  poly r;
  if (k<0)
   return zpol;
  if (k>p.deg)
   return zpol;

  r.coeff=(p.coeff)+k;
  r.deg=p.deg-k;
  return r;
 }

poly polshift(poly p,int k) {  /* x^k*p */
 int i;
 poly r;
 r.deg=p.deg+k;
 r.coeff= (double*) calloc(r.deg+1,sizeof(double));
 for (i=0;i<=p.deg;i++)
  r.coeff[k+i]=p.coeff[i];
 return r;
}

void genzpol() { // called in main
 zpol.deg=0;
 zpol.coeff=(double*) calloc(1,sizeof(double));
} 
```

# android - 用于在 ViewPager 中加载数据的软件模式

> ID：13497814
> 
> 赞同：1
> 
> 时间：2012-11-21T16:34:36.407
> 
> 标签：android, android-viewpager

我有一个关于如何最好地为 ViewPager 中的每个页面加载数据的问题。

在为我的邮件应用程序应用 ViewPager 之前，由于我在查看邮件时只加载了一个页面，因此使用了一个后台线程 (LoadMailDetailThread) 来加载邮件数据并将其绑定到 ListView 以显示该特定页面的数据。在 LoadMailDetailThread 中，它执行以下任务 - 根据输入消息 ID 加载邮件。- 设置邮件阅读状态。- 解析邮件内容以将超链接添加到每个 url。- 解析邮件内容以添加到每个电话号码的链接。- 将其绑定到 ListView。等等

在使用 ViewPager 之前，这适用于许多应用程序版本。

现在我需要实现一个允许用户滑动更改邮件的功能。应用 ViewPager 后，我现在可以在任何给定时间加载最多三个页面。为了重用现有代码，每个页面都使用 LoadMailDetailThread 来加载邮件数据并将其绑定到该页面中的 ListView。但是在这个新设计中，如果页面不是可见页面，则不需要完成所有任务，例如设置邮件读取状态，解析邮件。因此，为了让 LoadMailDetailThread 区分我们当前是否正在加载可见页面，我有一个标志传递给它（1 表示可见，0 表示不可见）。因此，如果我们正在加载可见页面，我们将设置邮件读取状态并进行解析，否则我们将在 onPageSelected 中执行这些任务。

我不认为这是一个很好的设计，因为在 LoadMailDetailThread 中，我有很多 if 语句，例如 if(taskType == VISIBLE) { } else if (taskType == NONVISIBLE) { }

到处都是。

我的问题是，有没有推荐的方法或模式来解决这类问题？为可见和不可见类编写单独的类？或者修改 LoadMailDetailThread 只做一般任务（加载邮件），让 onPageSelected 做细节（设置邮件读取状态，解析内容）？

谢谢

# debian - VLC 被动流式传输 Debian Squeeze & Wheezy

> ID：13497819
> 
> 赞同：2
> 
> 时间：2012-11-21T16:35:52.343
> 
> 标签：debian, vlc

我试图做一些流媒体。这是我的命令行：

```
cvlc  -vvv /var/www/Webtv/video/fr/test.avi --sout "#transcode{vcodec=theo,vb=800,scale=1,acodec=vorb,ab=128,channels=2,samplerate=44100}:gather:http{dst=:8080/video_fr.ogg}" --sout-keep 
```

它不能在 OVH 服务器上正常工作。

我不断收到这些消息：

```
[0x6eaf70] mux_ogg mux debug: adding input
[0x6eaf70] mux_ogg mux debug: theora stream
[0x6eaf70] main mux warning: late buffer for mux input (17133)
[0x6eaf70] main mux warning: late buffer for mux input (96028)
[0x6eaf70] main mux warning: late buffer for mux input (93573)
[0x6eaf70] main mux warning: late buffer for mux input (80988)
[0x6eaf70] main mux warning: late buffer for mux input (68268)
[0x6e1f90] stream_out_transcode stream out debug: late picture skipped (48879)
[0x6eaf70] main mux warning: late buffer for mux input (57167)
[0x6eaf70] main mux warning: late buffer for mux input (53769)
[0x6eaf70] main mux warning: late buffer for mux input (17675)
[0x6eaf70] main mux warning: late buffer for mux input (4937)
[0x6e1f90] stream_out_transcode stream out debug: late picture skipped (283877)
[0x6e1f90] stream_out_transcode stream out debug: late picture skipped (253972)
[0x6e1f90] stream_out_transcode stream out debug: late picture skipped (255371)
[0x6e1f90] stream_out_transcode stream out debug: late picture skipped (214995) 
```

它在我自己的 VirtualMachine (Debian Wheezy) 上完美运行，但似乎 CPU 无法在 OVH 服务器 (Debian Squeeze) 上运行。这是服务器的配置：

CPU : Atom 330/N2800 双核 -- 4 线程 -- 1,6+Ghz RAM : 4Gb

由于我的 VM RAM 是 1Gb 并且仍然可以工作，我不知道为什么它不能在更好的服务器上运行。

PS：我听说 ffmpeg 上的某些东西如果不是从头开始构建就无法正常工作。我的问题可能来自这里吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-09-14T14:09:38.667

此问题与 CPU 有关。这意味着跳过了一些帧，因为 CPU 无法跟上实时流，因此请尝试以较低质量进行转码或使用更好的机器 ;-)

# java - Spring Batch - JdbcCursorItemReader 使用大型 MySQL 表抛出 OutOfMemoryError

> ID：13497822
> 
> 赞同：2
> 
> 时间：2012-11-21T16:35:15.307
> 
> 标签：java, mysql, spring, jdbc, spring-batch

我正在编写一个使用 Spring Batch 处理 MySQL 数据库表中的 7,637,064 行的程序。我在较小的表上取得了成功，但是当 JdbcCursorItemReader 尝试打开游标时，此表中的大量行导致 OutOfMemoryError 异常。

我可能可以通过向它扔一个更大的 Xmx 来解决这个问题，但在我看来，Spring Batch 应该有一种方法来处理这个问题，而且我可能只是缺少一个关键的配置。

Spring批处理配置：

```
 <job id="reportJob" xmlns="http://www.springframework.org/schema/batch">
    <step id="largeTableTransfer">
      <tasklet>
        <chunk reader="largeTableReader" processor="largeTableTransformer" writer="largeTableWriter"
          commit-interval="10" />
      </tasklet>
    </step>
  </job>

  <bean id="largeTableReader" class="org.springframework.batch.item.database.JdbcCursorItemReader">
    <property name="dataSource" ref="inputDataSource" />
    <property name="sql" value="select * from largeTable" />
    <property name="rowMapper">
      <bean class="myproject.reader.largeTableRowMapper" />
    </property>
  </bean>
  <bean id="largeTableTransformer" class="myproject.transformer.LargeTableTransformer" />
  <bean id="largeTableWriter" class="myproject.writer.JdbcLargeTableWriter">
    <property name="dataSource" ref="outputDataSource" />
  </bean> 
```

在 JdbcCursorItemReader 上设置*fetchSize*似乎没有效果。唯一允许它运行完成的是将*maxRows*设置为一个较小的数字，但随后只会处理该数量的行。

相关的堆栈跟踪：

```
2012-11-21 11:25:29,931 DEBUG [org.springframework.batch.core.repository.dao.JdbcStepExecutionDao] - <Truncating long message before update of StepExecution, original message is: java.lang.OutOfMemoryError: Java heap space
    at java.util.Arrays.copyOf(Arrays.java:2734)
    at java.util.ArrayList.ensureCapacity(ArrayList.java:167)
    at java.util.ArrayList.add(ArrayList.java:351)
    at com.mysql.jdbc.MysqlIO.readSingleRowSet(MysqlIO.java:2821)
    at com.mysql.jdbc.MysqlIO.getResultSet(MysqlIO.java:467)
    at com.mysql.jdbc.MysqlIO.readResultsForQueryOrUpdate(MysqlIO.java:2510)
    at com.mysql.jdbc.MysqlIO.readAllResults(MysqlIO.java:1746)
    at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2135)
    at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2542)
    at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1734)
    at com.mysql.jdbc.PreparedStatement.executeQuery(PreparedStatement.java:1885)
    at org.apache.commons.dbcp.DelegatingPreparedStatement.executeQuery(DelegatingPreparedStatement.java:93)
    at org.springframework.batch.item.database.JdbcCursorItemReader.openCursor(JdbcCursorItemReader.java:125)
    at org.springframework.batch.item.database.AbstractCursorItemReader.doOpen(AbstractCursorItemReader.java:401)
    at org.springframework.batch.item.support.AbstractItemCountingItemStreamItemReader.open(AbstractItemCountingItemStreamItemReader.java:134)
    at org.springframework.batch.item.support.CompositeItemStream.open(CompositeItemStream.java:93)
    at org.springframework.batch.core.step.tasklet.TaskletStep.open(TaskletStep.java:301)
    at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:192)
    at org.springframework.batch.core.job.SimpleStepHandler.handleStep(SimpleStepHandler.java:135)
    at org.springframework.batch.core.job.flow.JobFlowExecutor.executeStep(JobFlowExecutor.java:61)
    at org.springframework.batch.core.job.flow.support.state.StepState.handle(StepState.java:60)
    at org.springframework.batch.core.job.flow.support.SimpleFlow.resume(SimpleFlow.java:144)
    at org.springframework.batch.core.job.flow.support.SimpleFlow.start(SimpleFlow.java:124)
    at org.springframework.batch.core.job.flow.FlowJob.doExecute(FlowJob.java:135)
    at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:293)
    at org.springframework.batch.core.launch.support.SimpleJobLauncher$1.run(SimpleJobLauncher.java:120)
    at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:48)
    at org.springframework.batch.core.launch.support.SimpleJobLauncher.run(SimpleJobLauncher.java:114)
    at ifpress.ams2amx.ExampleJobConfigurationTests.testLaunchJob(ExampleJobConfigurationTests.java:32)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T00:50:13.123

MySql JDBC 驱动程序中存在一个问题，导致将整个数据集加载到内存中，而不管您传递给语句创建方法的参数如何。有关如何正确打开游标，请参阅[http://dev.mysql.com/doc/refman/5.0/en/connector-j-reference-implementation-notes.html](http://dev.mysql.com/doc/refman/5.0/en/connector-j-reference-implementation-notes.html)。

这是我的做法：

```
<bean class="org.springframework.batch.item.database.JdbcCursorItemReader">
  <property name="verifyCursorPosition" value="false" />
   <property name="dataSource" ref="remoteDataSource" />
   <property name="rowMapper">
     <bean class="org.springframework.jdbc.core.SingleColumnRowMapper" />
   </property>
   <property name="fetchSize">
     <util:constant static-field="java.lang.Integer.MIN_VALUE" />
   </property>
   <property name="sql">
     <value>SELECT foo, bar FROM baz</value>
  </property>
</bean> 
```

# c# - 根据条件隐藏控件集合

> ID：13497824
> 
> 赞同：0
> 
> 时间：2012-11-21T16:36:21.187
> 
> 标签：c#, asp.net

我有一个 asp.net 页面，在页面的顶部和底部都有公共控件。（约 75% 的对照）。其余控件由 page_load 条件控制。

所以，我有，比如说：30 个控件和 5 个条件。
在 page_Load 上，我必须执行以下操作：

```
 if (condtion1)
       {
        control1.Visible=false;
        control2.Visible=true;
        control3.Visible=false;
        control4.Visible=true;
        ...etc...
       }
     else if (condition2)
      { contorl1.Visible=true;
        control2.Visible=true; 
        control3.Visible=true;
       ...etc...
      }
      ...etc.... 
```

有没有更好的方法来控制多个控件的控件可见性？请注意，控件可以重叠，即条件 1 和条件 2 可以具有相同的可见控件。

我的想法是创建 20 个控件并拥有某种面板，您可以在其中定义哪些控件属于该面板，但不确定它是否存在。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T16:38:29.030

我个人更喜欢这样的东西：

```
control1.Visible = condition1;
control2.Visible = condition1 || condtion2;
control3.Visible = condition2; 
```

您可以将控件或条件组合在一起，以使您的意图更加明显。

# php - 您将如何在 MVC 项目中缓存内容

> ID：13497825
> 
> 赞同：2
> 
> 时间：2012-11-21T16:36:31.300
> 
> 标签：php, model-view-controller, caching

我有一个项目，它是几个体育赛事系列的结果数据库。正如你想象的那样，内容或多或少保持不变。我想缓存一些内容以保存数据库查询。

该项目是使用 PHP 构建的，并且正在使用自定义 MVC。你会在哪里添加缓存逻辑？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T16:41:18.853

使用 Memcached。像这样，您缓存查询结果，并尝试在 DB 之前从缓存中检索。

编辑：添加了 json_encoding 数据... json_encode 比 PHP 对数组的默认序列化稍快，并且可以被其他访问数据的应用程序使用

Memcached 默认使用 FastLZ 压缩。

```
// The ID of the item you're looking for (from $_GET or whatever)
$id = 1;

// Create a memcached instance
$m = new Memcached();
$m->addServer('localhost', 11211);

// Try retrieving the event from memcached
$data = $m->get('event_' . $id);

if ($data) {
    // If you found data in memcached, decode it for use in code
    $data = json_decode($data);
} else {
    // If you didn't find the data in memcached, try retrieving from the DB
    $result = mysqli_query('SELECT * FROM events WHERE id = ' . $id);
    // If you found results in the DB...
    if ($data = mysqli_fetch_assoc($result)) {
        // Save them to memcached for future calls
        // Note: here, I'm using the optional param to expire it after 1 day
        $m->set('event_' . $id, json_encode($data), 86400);
    }
}
// Now you can use your data
var_dump($data); 
```

编辑以在代码中添加注释

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T16:54:51.113

您可以在 MVC 和受 MVC 启发的设计模式中使用缓存的两点：输出和数据检索：

### 缓存输出：

这必须在视图中实现，作为 UI 逻辑的一部分（视图应该是实例，而不仅仅是哑模板）。某处是视图在响应中组合模板的同一区域。只有在这种情况下，一些“模板”实际上是完全没有变量的。

通过这种方式，您可以在 MVC 的上下文中缓存 HTML 片段 .. 但这不适用于您的特定用例。它更适合与数据源交互花费太多时间的情况。就像存储实际上是 REST API 一样。

### 缓存数据：

要启用此功能，必须在模型层中执行。准确地说：在服务中（类/实例，主要包含域和存储逻辑之间的交互）。

如果你有一个完全实现的模型层，你在其中分离应用程序、域和存储逻辑，那么缓存的实现看起来就像是不同的存储形式。

```
$user = new User;
$cache = new UserCacheMapper;

$user->setId( 42 );
if ( ! $cache->fetch( $user ) )
{
    $storage = new UserSQLMapper( $pdo );
    $storage->fetch( $user );

    $cache->store( $user );
}

// the $user object has been initialized 
```

> [对象的初始化实际上应该由服务内的工厂执行，但这是一个简化的示例]

通过这种方式，您可以在不使用缓存的情况下创建应用程序，并且仅在以后通过修改[服务](https://en.wikipedia.org/wiki/Service_%28systems_architecture%29)（负责应用程序逻辑）来添加它。[域对象](http://c2.com/cgi/wiki?DomainObject)（域逻辑）和[数据映射器](http://martinfowler.com/eaaCatalog/dataMapper.html)（存储逻辑）都不必改变。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T16:38:19.163

我会使用 memcached，因为它非常容易使用它来构建缓存解决方案[http://memcached.org/](http://memcached.org/)

我通常将缓存逻辑放在控制器中，尽管模型通常可能更适合它，原因是模型使用的上下文会影响缓存策略

将其放入模型中会使缓存策略与正确的其余数据访问功能保持一致，这意味着您可以交换模型并且缓存代码随之移动。这可能会失败的地方是您有无法放入模型中的复杂失效。

“计算机科学中只有两件困难的事情：缓存失效和命名”Phil Karlton

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-21T16:41:29.760

可以使用 Memcache(d) 缓存对象，这对于多服务器设置最有用。对于单个服务器，您可以将内容存储在提供缓存设施的 APC/Xcache 等中。

我会在数据访问方法中缓存数据。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-21T16:59:36.467

您说您正在使用自己的 MVC 模式框架，因此很难给出具体的建议。

有几个地方可以缓存。

如果您正确使用 HTTP（幂等性、etag、缓存控制标头等），您可能会受益于将缓存层放置在应用程序*之外*并使用像[varnish](https://www.varnish-cache.org)这样的前向缓存来缓存整个页面。但是，很容易弄错 HTTP，所以这可能不是要走的路。例如，如果您有用户帐户，并且相同的 url 根据登录的用户产生不同的服务器输出，则不能使用 HTTP 缓存，因为您的资源取决于 cookie 状态。（您应该做的是将用户放入 url，例如，`/mysite/{userid}/profile`而不是`/mysite/profile`。）您可能仍然可以通过其更高级的功能使用 varnish，但这会更加困难。

你说你只是对缓存数据库查询结果感兴趣，所以我会解决这个问题。

如果您有一些定义明确的查询想要缓存数据库响应，您可以将逻辑放在控制器中：在将模型传递给视图之前，显式缓存它。如果您有多个缓存位置，此解决方案会产生混乱的代码库。此外，如果您在不同的控制器中检索相同的数据，则需要仔细并手动确保检索相同模型的所有控制器代码也查询缓存并使用相同的缓存键。显然，打开和关闭缓存也变得困难。

更简洁的解决方案是以透明缓存结果的方式包装模型。这意味着您可以以声明方式添加缓存，而无需对控制器或模型进行重大更改。但是，这需要一个设计良好的模型 api，而您可能没有。

# input - 如何将不同的背景图像应用于已定义类和 ID 的单选按钮

> ID：13497829
> 
> 赞同：1
> 
> 时间：2012-11-21T16:35:39.553
> 
> 标签：input, radio-button, background-image

我正在尝试为已经具有 ID (#3872720) 并且属于具有名为的类的父 DIV 的单选按钮输入定义 CSS`.catProdAttributeItem`

我只是想使用背景图像显示具有此 ID 的图形。出现的属性代码已经由 Business Catalyst 系统创建，因此我无法控制它，我所能做的就是针对输出代码生成的类名称和 ID 名称。

所以我正在努力实现：

```
text    radio  bg image:

white   o     image 1 here  
yello   o     image 2 here  
green   o     image 3 here  
black   o     image 4 here 
```

身体

```
<div class="catProductAttributeGroup">
<div class="catProdAttributeTitle">Colour</div>
<div class="catProdAttributeItem"> 
  <input id="3872720" name="578278" mandatory="1" type="radio">
  <span>White </span></div>
<div class="catProdAttributeItem">
  <input id="3872721" name="578278" mandatory="1" type="radio">
  <span>Yellow </span></div>
<div class="catProdAttributeItem">
  <input id="3872722" name="578278" mandatory="1" type="radio">
  <span>Green </span></div>
<div class="catProdAttributeItem">
  <input id="3872723" name="578278" mandatory="1" type="radio">
  <span>Black </span></div> 
```

CSS

```
.catProdAttributeItem input{color:#fff; padding-left:30px;}  
#3872720 input {padding-left:20px; background-image:url(../images/shop-dot-white.jpg); background-repeat:no-repeat;}  
#3872721 input {padding-left:20px; background-image:url(../images/shop-dot-yellow.jpg); background-repeat:no-repeat;}  
#3872722 input {padding-left:20px; background-image:url(../images/shop-dot-green.jpg);  background-repeat:no-repeat;}  
#3872723 input {padding-left:20px;  background-image:url(../images/shop-dot-black.jpg); background-repeat:no-repeat;} 
```

问题是我如何定位`class="catProdAttributeItem"`和输入`id="3872721"`......？

任何帮助将非常感激！

# grails - Grails 中messageSource 的声明在哪里？

> ID：13497835
> 
> 赞同：0
> 
> 时间：2012-11-21T16:37:07.400
> 
> 标签：grails, internationalization, grails-2.0

## 背景

对于存储在数据库中的字段标签，我们有一些遗留的国际化，因此我尝试创建一个“合并”消息源。如果代码存在于数据库中，则返回，如果不存在，则使用 PluginAwareResourceBundleMessageSource 在 i18n 中查找。

## 问题

由于某种原因，cachedMergedPluginProperties 正在为区域设置缓存错误的文件。例如，如果我搜索 en_US，我会收到 pt_BR 消息（地图的键是 en_US，但属性是 pt_BR）。

我声明了我的 messageSource 如下：

```
messageSource(DatabaseMessageSource) {
  messageBundleMessageSource = { org.codehaus.groovy.grails.context.support.PluginAwareResourceBundleMessageSource m ->
    basenames = "WEB-INF/grails-app/i18n/messages"
    } 
} 
```

内部 bean 是因为 Grails 不允许我有两个类型的 bean `MessageSource`。

我是否声明`PluginAwareResourceBundleMessageSource`与 Grails 的默认设置不同？在哪个 Grails 文件中我可以看到这个 bean 声明？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T16:51:20.640

我在里面找到了声明`I18nGrailsPlugin`，它比我的更详细：

```
String baseDir = "grails-app/i18n"
String version = GrailsUtil.getGrailsVersion()
String watchedResources = "file:./${baseDir}/**/*.properties".toString()
...
 Set baseNames = []

        def messageResources
        if (application.warDeployed) {
            messageResources = parentCtx?.getResources("**/WEB-INF/${baseDir}/**/*.properties")?.toList()
        }
        else {
            messageResources = plugin.watchedResources
        }

        if (messageResources) {
            for (resource in messageResources) {
                // Extract the file path of the file's parent directory
                // that comes after "grails-app/i18n".
                String path
                if (resource instanceof ContextResource) {
                    path = StringUtils.substringAfter(resource.pathWithinContext, baseDir)
                }
                else {
                    path = StringUtils.substringAfter(resource.path, baseDir)
                }

                // look for an underscore in the file name (not the full path)
                String fileName = resource.filename
                int firstUnderscore = fileName.indexOf('_')

                if (firstUnderscore > 0) {
                    // grab everyting up to but not including
                    // the first underscore in the file name
                    int numberOfCharsToRemove = fileName.length() - firstUnderscore
                    int lastCharacterToRetain = -1 * (numberOfCharsToRemove + 1)
                    path = path[0..lastCharacterToRetain]
                }
                else {
                    // Lop off the extension - the "basenames" property in the
                    // message source cannot have entries with an extension.
                    path -= ".properties"
                }
                baseNames << "WEB-INF/" + baseDir + path
            }
        }

        LOG.debug "Creating messageSource with basenames: $baseNames"

        messageSource(PluginAwareResourceBundleMessageSource) {
            basenames = baseNames.toArray()
            fallbackToSystemLocale = false
            pluginManager = manager
            if (Environment.current.isReloadEnabled() || GrailsConfigUtils.isConfigTrue(application, GroovyPagesTemplateEngine.CONFIG_PROPERTY_GSP_ENABLE_RELOAD)) {
                def cacheSecondsSetting = application?.flatConfig?.get('grails.i18n.cache.seconds')
                if (cacheSecondsSetting != null) {
                    cacheSeconds = cacheSecondsSetting as Integer
                } else {
                    cacheSeconds = 5
                }
            }
        } 
```

由于 Grails 不允许您拥有两个类型的 bean，`MessageSource`因此我不得不复制此代码并适应我的“合并”消息源。

# android - Android：不应从 UI 线程修改内容适配器

> ID：13497836
> 
> 赞同：0
> 
> 时间：2012-11-21T16:37:11.750
> 
> 标签：android

有时我会在下面的活动中收到此错误，有时不会：

```
The content of the adapter has changed
but ListView did not receive a notification. Make sure the content of
your adapter is not modified from a background thread, but only from the
UI thread. 
```

但我不确定我在下面班级的错误在哪里。有人知道吗？

```
public class FavoriteActivity extends SpeakSuperActivity {

        private final static String TAG = FavoriteActivity.class.getSimpleName();

        private Button btn_filter_topic, btn_filter_rating, btn_filter_none;
        private TextView fav_filter_text;
        private static ListView listViewFavorites;
        private static TextView txtNoFavoritesYet;
        private List<Favorite> currentFavorites;
        private ArrayAdapter<Favorite> currentFavoritesArrayAdapter;

        // required for list loading piece by piece
        final int itemsPerLoading = Configuration.LOADED_ITEMS_ON_LIST_AT_ONCE;
        boolean loadingMore = false;
        private List<Long> idList;
        int currentDataLoaded;

        private static int oldBtnViewId = 0;

        // set the start value as same as the loading value
        int maximumDataLoadedYet = Configuration.LOADED_ITEMS_ON_LIST_AT_ONCE;

        // 0 = not sorted, 1 = sorted by topic and minimum number of stars
        private int caseSelection = 0;

        private static View progressView;

        private View footerView;

        /** Called when the activity is first created. */
        @Override
        public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            setContentView(R.layout.favorites);
            Log.d(TAG, "FavoritesScreen onCreate()...");

            // indicator for waiting processes
            progressView = UIUtils.addBlockingProgressIndicatorBlack(this);

            // init Listview
            listViewFavorites = (ListView) findViewById(R.id.fav_listview_favorites);

            // add the footer before adding the adapter, else the footer
            // will not load!
            footerView = ((LayoutInflater) getSystemService(Context.LAYOUT_INFLATER_SERVICE)).inflate(R.layout.listviewfooter, null, false);
            listViewFavorites.addFooterView(footerView);

            listViewFavorites = (ListView) findViewById(R.id.fav_listview_favorites);

            fav_filter_text = (TextView) findViewById(R.id.fav_filter_text);

            btn_filter_none = (Button) findViewById(R.id.btn_fav_filter_none);
            btn_filter_topic = (Button) findViewById(R.id.btn_fav_filter_topic);
            btn_filter_rating = (Button) findViewById(R.id.btn_fav_filter_rating);

            toggleButtonStates(R.id.btn_fav_filter_none);

            LoadDataTask ldTask = new LoadDataTask();
            ldTask.execute();

            // no favorites yet?
            txtNoFavoritesYet = (TextView) findViewById(R.id.fav_no_favorites_yet);

            updateUI();

        }

        /**
         * An asynchronous Task (doesn't block the UI Thread) for loading the Data in background.
         * 
         * @author Jonas Soukup
         */
        private class LoadDataTask extends AsyncTask<Void, Void, LoudmouthException> {

            private final String TAG = LoadDataTask.class.getName();

            protected void onPreExecute() {
                super.onPreExecute();

                if (FavoriteProvider.getInstance().getNumOfFavorites() != 0)
                    progressView.setVisibility(View.VISIBLE);
                else
                    progressView.setVisibility(View.GONE);

                listViewFavorites.setVisibility(View.GONE);

                fav_filter_text.setVisibility(View.GONE);

                btn_filter_none.setVisibility(View.GONE);
                btn_filter_topic.setVisibility(View.GONE);
                btn_filter_rating.setVisibility(View.GONE);
            }

            protected LoudmouthException doInBackground(Void... params) {
                LoudmouthException exception = null;

                Log.d(TAG, "loading data..");
                switch (caseSelection) {
                case 0:
                    // Get FavoriteList without sorting
                    idList = FavoriteProvider.getInstance().getFavoritesByDate();
                    break;
                case 1:
                    // Get FavoriteList sorted by
                    // Topics + amount of stars
                    SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences(getApplicationContext());

                    float minRating = prefs.getFloat(getResources().getString(R.string.rating_filter_star_amount), 0);

                    idList = FavoriteProvider.getInstance().getFavoritesByTopicAndMinRating(minRating);
                    break;
                default:
                    Log.e(TAG, "No Case with number: " + caseSelection);

                }

                // reset data loaded, so it loads till maximumDataLoadedYet on a
                // refresh of the list
                currentDataLoaded = 0;

                // reset List on Data change
                currentFavorites = new ArrayList<Favorite>();

                Log.d(TAG, "..loading data finished");

                return exception;
            }

            protected void onPostExecute(LoudmouthException result) {

                try {
                    Log.d(TAG, "LoadDataTask.onPostExecute()");
                    super.onPostExecute(result);
                    progressView.setVisibility(View.GONE);
                    if (result != null) {
                        // Error ocurred during loading
                        android.content.DialogInterface.OnClickListener retryClickListener = new android.content.DialogInterface.OnClickListener() {

                            public void onClick(DialogInterface dialog, int which) {
                                new LoadDataTask().execute();

                            }
                        };
                        UIUtils.showRetryCancelAlertDialog(getApplicationContext(), result, retryClickListener, null);
                    } else {
                        // Everythings fine, data loaded

                        // showing & hiding

                        if (FavoriteProvider.getInstance().getNumOfFavorites() == 0) {

                            fav_filter_text.setVisibility(View.GONE);
                            btn_filter_none.setVisibility(View.GONE);
                            btn_filter_topic.setVisibility(View.GONE);
                            btn_filter_rating.setVisibility(View.GONE);
                        } else {

                            fav_filter_text.setVisibility(View.VISIBLE);
                            btn_filter_none.setVisibility(View.VISIBLE);
                            btn_filter_topic.setVisibility(View.VISIBLE);
                            btn_filter_rating.setVisibility(View.VISIBLE);
                        }

                        if (idList.size() == 0) {
                            txtNoFavoritesYet.setVisibility(View.VISIBLE);
                            listViewFavorites.setVisibility(View.GONE);
                        } else {
                            txtNoFavoritesYet.setVisibility(View.GONE);
                            listViewFavorites.setVisibility(View.VISIBLE);

                            runOnUiThread(new Runnable() {
                                public void run() {
                                    btn_filter_none.setOnClickListener(new OnClickListener() {
                                        public void onClick(View v) {
                                            caseSelection = 0;
                                            FavoriteProvider.getInstance().setCurrentFavoriteListStateDirty(true);
                                            toggleButtonStates(v.getId());
                                            updateUI();
                                        }
                                    });

                                    btn_filter_topic.setOnClickListener(new OnClickListener() {
                                        public void onClick(View v) {
                                            caseSelection = 1;
                                            TopicFilterFavDialog tfFavDialog = new TopicFilterFavDialog(FavoriteActivity.this, FavoriteActivity.this, v
                                                    .getId());
                                            tfFavDialog.show();
                                        }
                                    });

                                    btn_filter_rating.setOnClickListener(new OnClickListener() {
                                        public void onClick(View v) {
                                            caseSelection = 1;
                                            RatingFilterFavDialog ratDialog = new RatingFilterFavDialog(FavoriteActivity.this, FavoriteActivity.this, v
                                                    .getId());
                                            ratDialog.show();
                                        }
                                    });
                                }
                            });
                        }
                    }

                    // init listview displaying with data loaded step by step
                    currentFavoritesArrayAdapter = new FavoriteArrayAdapter(FavoriteActivity.this, FavoriteActivity.this, R.layout.favorite_list_entry,
                            currentFavorites);
                    listViewFavorites.setAdapter(currentFavoritesArrayAdapter);
                    currentFavoritesArrayAdapter.notifyDataSetChanged();

                } catch (Exception exception) {
                    // silent catch because activity could be closed meanwhile
                    Log.i(TAG, "silent exception catch in onPostExecute: " + exception.getMessage());
                }
            }
        }

        /**
         * Update UI
         */
        public void updateUI() {
            LoadDataTask ldTask = new LoadDataTask();
            ldTask.execute();
            if (currentFavoritesArrayAdapter != null)
                currentFavoritesArrayAdapter.notifyDataSetChanged();
        }

        @Override
        protected void onResume() {
            super.onResume();
            updateUI();
        }

        private class ListMoreItemsTask extends AsyncTask<Void, Void, LoudmouthException> {
            @Override
            protected LoudmouthException doInBackground(Void... arg0) {
                LoudmouthException exception = null;

                loadingMore = true;

                // reset loading values if adapter was reseted
                if (currentFavoritesArrayAdapter.getCount() == 0)
                    maximumDataLoadedYet = Configuration.LOADED_ITEMS_ON_LIST_AT_ONCE;

                // Get value of Configuration.LOADEDITEMSONLISTATONCE new listitems
                for (; currentDataLoaded < maximumDataLoadedYet && currentDataLoaded < idList.size(); currentDataLoaded++) {

                    // Fill the list with new information
                    currentFavorites.add(FavoriteProvider.getInstance().getFavorite(idList.get(currentDataLoaded)));
                }
                maximumDataLoadedYet += itemsPerLoading;

                // Done loading more.
                loadingMore = false;

                return exception;
            }

            protected void onPostExecute(LoudmouthException result) {
                if (result == null) {
                    // Tell to the adapter that changes have been made, this will
                    // cause
                    // the list to refresh
                    currentFavoritesArrayAdapter.notifyDataSetChanged();

                    // remove loading view when maximum data is reached
                    if (currentFavorites.size() == idList.size()) {
                        listViewFavorites.removeFooterView(footerView);
                    }
                }
            }
        }

        public void toggleButtonStates(int viewId) {

            // set clicked button as selected
            if (viewId != 0) {
                switch (viewId) {
                case R.id.btn_fav_filter_none:
                    btn_filter_none.setCompoundDrawablesWithIntrinsicBounds(getResources().getDrawable(R.drawable.filter_neuste_selected), null, null,
                            null);
                    btn_filter_none.setTextColor(getResources().getColor(color.black));
                    break;
                case R.id.btn_fav_filter_topic:
                    btn_filter_topic.setCompoundDrawablesWithIntrinsicBounds(getResources().getDrawable(R.drawable.filter_themen_selected), null, null,
                            null);
                    btn_filter_topic.setTextColor(getResources().getColor(color.black));
                    break;
                case R.id.btn_fav_filter_rating:
                    btn_filter_rating.setCompoundDrawablesWithIntrinsicBounds(getResources().getDrawable(R.drawable.filter_rating_selected), null, null,
                            null);
                    btn_filter_rating.setTextColor(getResources().getColor(color.black));
                    break;
                default:
                    Log.d("TAG", "No View with id: " + viewId);
                }
            }

            // if previews Button exists and wasn't the same button set the old
            // one
            // to selected false
            if (oldBtnViewId != 0 && oldBtnViewId != viewId) {
                // set clicked button as not selected
                switch (oldBtnViewId) {
                case R.id.btn_fav_filter_none:
                    btn_filter_none.setCompoundDrawablesWithIntrinsicBounds(getResources().getDrawable(R.drawable.filter_neuste), null, null, null);
                    btn_filter_none.setTextColor(getResources().getColor(R.color.font_grey));
                    break;
                case R.id.btn_fav_filter_topic:
                    btn_filter_topic.setCompoundDrawablesWithIntrinsicBounds(getResources().getDrawable(R.drawable.filter_themen), null, null, null);
                    btn_filter_topic.setTextColor(getResources().getColor(R.color.font_grey));
                    break;
                case R.id.btn_fav_filter_rating:
                    btn_filter_rating.setCompoundDrawablesWithIntrinsicBounds(getResources().getDrawable(R.drawable.filter_rating), null, null, null);
                    btn_filter_rating.setTextColor(getResources().getColor(R.color.font_grey));
                    break;
                default:
                    Log.d("TAG", "No View with id: " + viewId);
                }
            }
            oldBtnViewId = viewId;
        }

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T16:45:54.710

它失败是因为您在 ListMoreItemsTasks 中修改了 currentFavorite，这是支持您的适配器的基础列表。

修改是在`doInBackground`不是 UI Thread 中进行的。

我建议使用 publishProgress 接收要添加到 UI 线程上的数据并将其添加到那里的适配器（通过适配器的方法，而不是数组，在创建适配器后您可能不应该保留它）

# 编辑

代替

```
private class ListMoreItemsTask extends AsyncTask<Void, Void, LoudmouthException> { 
```

和

```
private class ListMoreItemsTask extends AsyncTask<Void, Favorite, LoudmouthException> { 
```

所以进度是最喜欢的元素，那么

```
currentFavorites.add(FavoriteProvider.getInstance().getFavorite(idList.get(currentDataLoaded))); 
```

和

```
publishProgress(FavoriteProvider.getInstance().getFavorite(idList.get(currentDataLoaded)); 
```

加上在 AsyncTask 中插入 onProgressUpdate ：

```
onProgressUpdate(Favorite... values) {
    currentFavorites.add(values[0]);
    currentFavoritesArrayAdapter.notifyDataSetChanged();
} 
```

# java - 在primefaces上的数据表中选择行

> ID：13497838
> 
> 赞同：0
> 
> 时间：2012-11-21T16:36:11.753
> 
> 标签：java, datatable, primefaces

我想在数据表中获取所选行的 ID，但我得到的是之前选择的行，而不是当前的选择。我的代码如下

```
<p:dataTable id="translationsTable" var="translation" value="#{videoBean.lyric.polylrcList}" rowKey="#{translation.lang}" selectionMode="single" selection="#{videoBean.selected}"> 
                     <p:ajax event="rowSelect" update="translationsTable"  process="translationsTable" oncomplete="alert(#{videoBean.selected.id});"/> 
</p:dataTable> 
```

它应该显示当前的 id，但它总是向我显示最后一个。

任何想法？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T18:37:48.893

```
 <p:dataTable id="translationsTable" var="translation" value="#{videoBean.lyric.polylrcList}"     rowKey="#{translation.lang}" selectionMode="single" selection="#{videoBean.selected}">

    <p:column>
        #{translation.id}
    </p:column>

    <p:ajax event="rowSelect" update="translationsTable"  process="translationsTable" oncomplete="alert(#{translation.id});"/> 

</p:dataTable> 
```

您可以使用[www.primefaces.org](http://www.primefaces.org)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T10:44:55.970

我已经做了一个解决方法来解决这个问题.. 我直接从 primefaces 执行 javascript 函数在这样选择的行上。

```
public void rowSelected(SelectEvent event) {
    selectedPolyLrc = (Polylrc) event.getObject(); 
    RequestContext.getCurrentInstance().execute("alert( "+selectedPolyLrc.getId()+");");
    System.out.println("SELECTED AREA:" + selectedPolyLrc);
    //...
} 
```

就像那样，我总是保证 javascript 函数将在选择行后执行

# uiwebview - 打开 UIWebView 时保持 Facebook 登录

> ID：13497840
> 
> 赞同：1
> 
> 时间：2012-11-21T16:37:14.947
> 
> 标签：uiwebview, uikit, ios6, facebook-ios-sdk

我已经将新的 facebook ios sdk 集成到我的应用程序中，在我的应用程序中实现了对 Facebook 的身份验证，并实现了发布到墙上。我正在使用存储在 iOS 6 设置中的内部 facebook 凭据。

现在我需要在特定的 facebook 页面 (http://facebook.com/what-so-ever) 上打开 UIWebView。但是当我的 UIWebView 加载时，用户似乎需要再次登录到他的 Facebook 帐户。有没有办法在 UIWebView 中的我的应用程序中保留 Facebook 身份验证？

# php - Wordpress wp_update_user 仅在刷新后更新

> ID：13497842
> 
> 赞同：5
> 
> 时间：2012-11-21T16:36:18.627
> 
> 标签：php, mysql, wordpress

我的 Wordpress 安装中有一个自定义页面，除其他外，它允许用户从前端**显示**和**更改他们的电子邮件地址。**

但是，当他们这样做时，电子邮件会在数据库中正确更改，但不会在页面上更新，直到再次*刷新*（有或没有`$_POST`）。这种行为真的很奇怪，我找不到原因。

这是代码有问题的部分：

```
if ( !empty( $_POST['user_email'] ) )
    wp_update_user( array ('ID' => $queried_user->id, 'user_email' => esc_attr( $_POST['user_email'] ) ) ) ; 
```

如果我执行`var_dump($_POST)`and `var_dump($queried_user)`，我会`user_email`在变量中正确显示它`$_POST`，但相应地，它仍然是变量中的旧`$queried_user`变量。但是，通过 PHPMyAdmin 查看数据库，我可以看到数据已经更新。再次刷新浏览器页面后，一切都正确显示。

任何指针？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T16:46:29.910

不确定您如何填充 $queried_user，但试试这个：

```
if ( !empty( $_POST['user_email'] ) )
{
   $queried_user->user_email=$_POST['user_email'];
   wp_update_user( array ('ID' => $queried_user->id, 'user_email' => esc_attr( $queried_user->user_email ) ) ) ;
} 
```

# ruby-on-rails - NameError: 未初始化的常量 -- activerecord

> ID：13497845
> 
> 赞同：3
> 
> 时间：2012-11-21T16:36:25.697
> 
> 标签：ruby-on-rails, activerecord, nameerror, uninitialized-constant

我有两个课程，数字和免费赠品：

```
class Number < ActiveRecord::Base
  belongs_to :account
  has_many :freebies

end

class Freebie < ActiveRecord::Base
  belongs_to :number

  attr_accessible :name, :data

  has_attached_file :data, :path => "freebies/:id_partition/:filename"

  def to_s
    name
  end
end 
```

我所有其他具有 has_many 和 belongs_to 关系的类都可以正常工作，但是当我调用类似的东西时：

```
n = Number.last
n.freebies.create 
```

我收到此错误：

```
NameError: uninitialized constant Number::Freeby
    from /Users/Robby/.rvm/gems/ruby-1.9.2-p320/gems/activerecord-3.2.8/lib/active_record/inheritance.rb:111:in `compute_type'
    from /Users/Robby/.rvm/gems/ruby-1.9.2-p320/gems/activerecord-3.2.8/lib/active_record/reflection.rb:172:in `klass'
    from /Users/Robby/.rvm/gems/ruby-1.9.2-p320/gems/activerecord-3.2.8/lib/active_record/associations/collection_association.rb:148:in `transaction'
    from /Users/Robby/.rvm/gems/ruby-1.9.2-p320/gems/activerecord-3.2.8/lib/active_record/associations/collection_association.rb:431:in `create_record'
    from /Users/Robby/.rvm/gems/ruby-1.9.2-p320/gems/activerecord-3.2.8/lib/active_record/associations/collection_association.rb:119:in `create'
    from /Users/Robby/.rvm/gems/ruby-1.9.2-p320/gems/activerecord-3.2.8/lib/active_record/associations/collection_proxy.rb:46:in `create'
    from (irb):20
    from /Users/Robby/.rvm/gems/ruby-1.9.2-p320/gems/railties-3.2.8/lib/rails/commands/console.rb:47:in `start'
    from /Users/Robby/.rvm/gems/ruby-1.9.2-p320/gems/railties-3.2.8/lib/rails/commands/console.rb:8:in `start'
    from /Users/Robby/.rvm/gems/ruby-1.9.2-p320/gems/railties-3.2.8/lib/rails/commands.rb:41:in `<top (required)>'
    from script/rails:6:in `require'
    from script/rails:6:in `<main>' 
```

我在 Freebie 类上遇到了一些其他问题，因为它以 ie 结尾，而且 Rails 试图制作单数版本“Freeby”而不是 Freebie。不过，我不确定为什么这不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T16:43:49.707

Rails 会自动尝试从单数形式推断单词的复数形式，反之亦然。您可能需要考虑覆盖默认的变形规则。

尝试类似于[此 Stackoverflow 问题](https://stackoverflow.com/questions/1640408/ruby-on-rails-pluralization-help)中的答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T17:15:21.260

```
"n.freebie.build" 
```

做你想做的同样的事情。让我知道它是否有效。

# c# - 从列表中删除多个元素

> ID：13497849
> 
> 赞同：1
> 
> 时间：2012-11-21T16:37:29.190
> 
> 标签：c#, list, collections, batch-processing, generic-collections

我想知道，是否有一种优雅的方法可以从通用集合（在我的情况下为 a `List<T>`）中删除多个项目，而无需执行诸如在 LINQ 查询中指定谓词以查找要删除的项目之类的操作？

我正在做一些批处理，其中我正在填充需要处理的对象类型`List<T>`。`Record`该处理以将每个对象插入数据库而结束。我不想构建列表，然后遍历每个单独的成员并处理/插入它，而是想对`N`列表中的项目组执行事务性批量插入，因为它的资源密集度较低（其中`N`代表`BatchSize`我可以放入配置文件， 或同等学历）。

我想做类似的事情：

```
public void ProcessRecords()
{
    // list of Records will be a collection of List<Record>
    var listOfRecords = GetListOfRecordsFromDb( _connectionString );
    var batchSize = Convert.ToInt32( ConfigurationManager.AppSettings["BatchSize"] );

    do
    {
       var recordSubset = listOfRecords.Take(batchSize);
       DoProcessingStuffThatHappensBeforeInsert( recordSubset );

       InsertBatchOfRecords( recordSubset );

       // now I want to remove the objects added to recordSubset from the original list
       // the size of listOfRecords afterwards should be listOfRecords.Count - batchSize
    } while( listOfRecords.Any() )
} 
```

我正在寻找一种方法来一次完成这一切，而不是遍历子集并以这种方式删除项目，例如：

```
foreach(Record rec in recordSubset)
{
   if( listOfRecords.Contains(rec) ) 
   { 
      listOfRecords.Remove(rec);
   }
} 
```

我正在考虑使用`List.RemoveRange( batchSize )`，但想先获得一些 StackOverflow 反馈 :) 您使用什么方法来最大限度地提高 C# 中批处理算法的效率？

非常感谢任何帮助/建议/提示！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T16:46:11.810

有扩展方法

```
public static IEnumerable<List<T>> ToBatches<T>(this List<T> list, int batchSize)
{
    int index = 0;
    List<T> batch = new List<T>(batchSize);

    foreach (T item in list)
    {
        batch.Add(item);    
        index++;

        if (index == batchSize)
        {
            index = 0;                
            yield return batch;
            batch = new List<T>(batchSize);
        }
    }

    yield return batch;
} 
```

您可以将输入序列拆分为批次：

```
foreach(var batch in listOfRecords.ToBatches(batchSize))
{
   DoProcessingStuffThatHappensBeforeInsert(batch);
   InsertBatchOfRecords(batch);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T16:44:54.570

[MoreLINQ](http://code.google.com/p/morelinq/)有一个[`Batch`扩展方法](http://code.google.com/p/morelinq/source/browse/MoreLinq/Batch.cs)，可以让你调用

```
var listOfRecords = GetListOfRecordsFromDb( _connectionString );
var batchSize = Convert.ToInt32( ConfigurationManager.AppSettings["BatchSize"] );

foreach(var batch in listOfRecords.Batch(batchSize))
{
   DoProcessingStuffThatHappensBeforeInsert(batch);
   InsertBatchOfRecords(batch);
} 
```

您无需*费心*从`listOfRecords`.

# jquery - 为模态对话框赋予样式

> ID：13497851
> 
> 赞同：0
> 
> 时间：2012-11-21T16:36:29.957
> 
> 标签：jquery, css, jquery-ui, modal-dialog

我使用这个[对话框，](http://jqueryui.com/dialog/#default) 我更愿意用[jsfiddle](http://jsfiddle.net/97LXc/3/)问我的问题，但我没有在 jsfiddle 中工作。所以我在这里放了一个[演示](http://www.olmasigereken.com/demo1/?url=dialog)。

如果我不在块中使用`visibility:hidden;`，`#dialog`当 url 参数不等于 'dialog' #dialog div 时会显示在页面中。但只有在 url=dialog
如果我使用`visibility:hidden;`#dialog div 中的内容未显示时，它才必须显示。

另外，我希望它在页面加载 10 分钟后打开。我会放在哪里`setTimeout`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T16:49:25.103

您应该使用 display:none 而不是 visibility:hidden 因为可见性将使您的元素不可见。您也可以将 setTimeout 放在任何您想要的地方，具体取决于您希望它何时开始计数。dom准备好之后？在 window.load 之后？ETC

```
$(function(){ // this waits for dom to be ready
    setTimeout(showdialog,10000);
}); 
```

[http://jsfiddle.net/mQRVp/](http://jsfiddle.net/mQRVp/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T16:51:24.213

你需要这样的东西：

```
function showdialog() {
    $( "#dialog" ).dialog({width:500,height:240});
};

$(function() {
    var lockation = document.location.toString();
    if(lockation.indexOf("url=dialog", lockation.length - "url=dialog".length) !== -1)//check if url ends with 'url=dialog'
         setTimeout(showdialog, 1000);//call function with timeout
}); 
```

`$(function(){...})`- 相当于[`jQuery.ready`](http://api.jquery.com/ready/)（您正在使用的 body.onload 的 jQuery 替换）

此外，而不是`visibility:hidden`使用`display:none`;

[http://jsfiddle.net/97LXc/5/](http://jsfiddle.net/97LXc/5/)演示（无 url=dialog）。

[http://jsfiddle.net/97LXc/7/](http://jsfiddle.net/97LXc/7/) url=对话框模仿

**UPD** 好吧，一旦您已经`onload="javascript:showdialog()"`根据 URL 在服务器上进行了填充，就无需像我那样在客户端上测试 url。只是代替`onload`打印

```
 $(function() {   
         setTimeout(showdialog, 1000);//call function with timeout
    }); 
```

在`showDialog`定义之后

# windows - (MFC) 如果控件是私有成员，父类如何接收控件的消息？

> ID：13497852
> 
> 赞同：4
> 
> 时间：2012-11-21T16:36:36.007
> 
> 标签：windows, visual-c++, mfc

假设我的主类有一个私有成员，它是从 CTreeView 控件派生的类。如何处理来自主类本身的树视图控件的消息？

这类似于 Visual Studios 为您构建的 MDI 基础应用程序，其中您有两个名为 CClassView 和 CFileView 的可停靠树视图控件，并且每个都有一个从 CTreeView 派生的私有成员。

我可以像这样将来自子成员控件 CViewTree 的消息传递给我的 CFileView 类吗？

```
void CViewTree::OnTvnSelchanged(NMHDR *pNMHDR, LRESULT *pResult)
{
    GetParent()->SendMessage(WM_NOTIFY, 0, (LPARAM)pNMHDR);
} 
```

此代码引发异常，但如果这确实有效，我将如何处理父类中的 TVN_SELCHANGED 消息？

编辑：所以我尝试了以下建议，但其中任何一个都没有太多运气。

```
//First try, in the parent .h file:
afx_msg BOOL OnSelChange(NMHDR *pNMHDR, LRESULT *pResult);

//In the .cpp file:
ON_NOTIFY_REFLECT_EX(TVN_SELCHANGED, OnSelChange)

//and

BOOL ParentClass::OnSelChange(NMHDR *pNMHDR, LRESULT *pResult)
{
     AfxMessageBox(L"in handler");
     Return TRUE;
} 
```

第二次尝试：

```
//in the parent .h file:
afx_msg void OnSelChange(NMHDR *pNMHDR, LRESULT *pResult);

//In the .cpp file:
ON_NOTIFY(TVN_SELCHANGED, AFX_IDW_PANE_FIRST, OnSelChange)

//and
void  ParentClass::OnSelChange(NMHDR *pNMHDR, LRESULT *pResult)
{
     AfxMessageBox(L"in handler");
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-21T20:43:45.233

不确定为什么要这样做，因为视图和父级之间存在紧密耦合，因此代码可重用性较低。如果您想重用选择逻辑，您可以像[DRAWCLI 示例](http://msdn.microsoft.com/en-us/library/9t94971d%28v=VS.80%29.aspx)那样将其提取到一个单独的类中。

TVN_SELCHANGED 已发送给父级。但是，当子窗口中存在 ON_NOTIFY_REFLECT 时，MFC 的[消息反射](http://msdn.microsoft.com/en-us/library/eeah46xd%28v=VS.80%29.aspx)将通知路由到子窗口的消息映射。

如果您希望父级在消息处理中也有发言权，您可以将 ON_NOTIFY_REFLECT 更改为 ON_NOTIFY_REFLECT_EX 并在反射消息处理程序中返回 FALSE。

您将在父级处获得 WM_NOTIFY，因此您处理通知的方式是将[ON_NOTIFY 宏](http://msdn.microsoft.com/en-us/library/749htf6k%28v=VS.90%29.aspx)添加到树形视图的父级，就像您通常对对话框上的树形控件所做的那样。如果您没有指定视图的 ID，则该视图的 ID 可能是 AFX_IDW_PANE_FIRST。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-26T18:13:10.937

盛能够找出我的问题，现在回想起来是很微不足道的。也许这会帮助其他可能有同样问题的人。

在我从 Visual Studio 2010 生成的带有 Visual Studio 风格的 MDI 程序中，CFileView 有一个 CViewTree 的子成员实例。CViewTree 是从 CTreeCtrl 派生的。

默认情况下，MFC 已经将消息沿子到父链传递。答案是确定控件 ID 以从您的父类中获取通知消息。

所以，首先，我们需要知道树控件的 ID。在CFileView的OnCreate方法中，可以看到这段代码：

```
if (!m_wndFileView.Create(dwViewStyle, rectDummy, this, 4)) 
```

MSDN 对 Create 方法有以下内容：

```
virtual BOOL Create(
   DWORD dwStyle,
   const RECT& rect,
   CWnd* pParentWnd,
   UINT nID 
); 
```

在我的示例中，id 为 4。现在在父级（在本例中为 CFileView）中，只需创建您的 ON_NOTIFY 宏：

```
BEGIN_MESSAGE_MAP(CFileView, CDockablePane)  //precreated for you
    ON_NOTIFY(TVN_SELCHANGED, 4, OnSelChanged)  //you create this
END_MESSAGE_MAP()  //precreated for you 
```

我必须手动输入上面的行，因为父类的类向导或消息属性没有 =TVN_SELCHANGED 消息。接下来，确保您的处理程序方法 OnSelChanged 在 CFileView.h 文件中声明为：

```
afx_msg void OnSelChanged(NMHDR *pNMHDR, LRESULT *pResult); 
```

现在我可以像这样处理 TVN_SELCHANGED 消息（回到 CFileView.cpp 中）：

```
void CFileView::OnSelChanged(NMHDR *pNMHDR, LRESULT *pResult)
{
    HTREEITEM item = m_wndFileView.GetSelectedItem();
    AfxMessageBox(m_wndFileView.GetItemText(item));
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-03-22T13:15:38.977

在所描述的情况下，如果您想使用 WM_NOTIFY TVN_SELCHANGED 消息从控件 CViewTree 通知父 CFileView，您应该在虚拟 OnNotify 函数中执行此操作，而不是使用消息映射。如果 OnNotify 没有遇到正确的处理程序，消息将转到父​​ CMainFrame，您可以在那里使用消息映射。

```
BOOL CFileView::OnNotify(WPARAM wParam, LPARAM lParam, LRESULT* pResult)
{
   if (nmHdr->idFrom != 4)
      return CDockablePane::OnNotify(wParam, lParam, pResult);
   if (nmHdr->code == TVN_SELCHANGED)
   {
      OnItemsSelChanged((NMHDR*)lParam, pResult);
      return TRUE;
   }
   return FALSE;
} 
```

# sql - 是否可以让`@SQLDelete` 考虑`hibernate.default_schema` 参数？

> ID：13497853
> 
> 赞同：0
> 
> 时间：2012-11-21T16:36:48.723
> 
> 标签：sql, hibernate, annotations

在 web 应用程序中，我使用 Hibernate 的`@SQLDelete`注释来“软删除”实体（即将状态列设置为表示其“已删除”状态的值，而不是实际从表中删除它们）。

实体代码如下所示：

```
@Entity
@SQLDelete(sql="update pizza set status = 2 where id = ?")
public class Pizza { ... } 
```

现在，我的问题是 Web 应用程序不使用表所属的模式的所有者连接到数据库。例如，模式（在 Oracle 中）被调用`pizza`，而 webapp 用来连接的 db 用户是`pizza_webapp`. 这是出于安全原因。`pizza_webapp`用户只有选择/更新/删除权限，不能修改数据库本身的结构。我在这里别无选择，这是我无法改变的政策。

`hibernate-default_schema`我使用hibernate config中的参数指定表实际所在的模式的名称：

```
<property name="hibernate.default_schema">pizza</property> 
```

这适用于通过映射实体的所有内容，Hibernate 知道如何在它生成的 SQL 中的表名前面添加模式名称。但不适用于原始 SQL，并且`@SQLDelete`包含原始 SQL。这是“按原样”执行的，结果是`"table or view not found error"`.

到目前为止，我们通过向模式添加同义词`pizza_webapp`，指向模式来解决这个问题`pizza`。它可以工作，但是在添加实体时跨多个数据库进行维护并不有趣。

那么，是否可以`@SQLDelete`考虑`hibernate.default_schema`参数？

（注意：显然我也不想在 SQL 中硬编码模式名称......）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2019-10-08T15:16:49.443

对的，这是可能的：

```
@SQLDelete(sql="update {h-schema}pizza set status = 2 where id = ?") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T11:25:00.350

我找不到任何 Hibernate 解决这个问题的方法。但是我发现了一个基于 Oracle 特性的解决方法。在使用它之前，我会在我的会话中这样做：

```
//set the default schema at DB session level for raw SQL queries (see @SQLDelete)
HibernateUtil.currentSession().doWork(new Work() {
    @Override
    public void execute(Connection connection) throws SQLException {
        connection.createStatement().execute("ALTER SESSION SET CURRENT_SCHEMA="+HibernateUtil.getDefaultSchema());
    }
}); 
```

我工作得很好，但不幸的是只在 Oracle 上（至少现在对我们来说很好）。也许在其他 RDBMS 上也有不同的方法可以实现相同的目标？

编辑：`getDefaultSchema()`我的`HibernateUtil`类中的方法这样做是为了从 Hibernate 的配置中获取默认模式：

```
defaultSchema = config.getProperty("hibernate.default_schema"); 
```

`config`我的`org.hibernate.cfg.Configuration`对象在哪里。

# php - 在两个数据库字段之间查找日期

> ID：13497855
> 
> 赞同：1
> 
> 时间：2012-11-21T16:37:53.373
> 
> 标签：php, mysql

嗨，我有一段代码在数据库中的 year_start 和 year_end 字段之间查找一年。

这是我的代码。

```
 SELECT * from $tableName where '$year' BETWEEN start_year AND end_year; LIMIT $start, $limit 
```

现在这似乎工作正常，除非年份等于 end_year 值，例如，如果我正在搜索 2002 并且年末值为 2002，那么它不会返回任何结果。

任何建议，将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T16:43:51.950

如果`start_year`和`end_year`类型是

**INT**

```
$sql = '
SELECT *
FROM '.$tableName.'
WHERE TRUE
  AND '.$year.' BETWEEN start_year AND end_year
LIMIT '.$start.', '.$limit.'
;
'; 
```

**日期**

```
$sql = '
SELECT *
FROM '.$tableName.'
WHERE TRUE
  AND '.$year.' BETWEEN YEAR(start_year) AND YEAR(end_year)
LIMIT '.$start.', '.$limit.'
;
'; 
```

**VARCHAR**
需要转换它们

```
$sql = '
SELECT *
FROM '.$tableName.'
WHERE TRUE
  AND '.$year.' BETWEEN
    CAST(start_year AS UNSIGNED) AND CAST(end_year AS UNSIGNED)
LIMIT '.$start.', '.$limit.'
;
'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T16:42:21.343

只需在执行查询之前比较 start_year 和 end_year。

```
// If they're the same,
If start_year == end_year{
  select * from $tableName where '$year' = start_year; LIMIT $start, $limit;
  // more code
}

// if not, use your query
else{
  SELECT * from $tableName where '$year' BETWEEN start_year AND end_year; LIMIT $start, $limit;
  // more code
} 
```

不是最漂亮的解决方案，但仍然是一个不错的解决方法。

# android - 用 Cordova 和 admob 覆盖本地存储

> ID：13497858
> 
> 赞同：1
> 
> 时间：2012-11-21T16:38:11.113
> 
> 标签：android, cordova, admob

当 admob 代码在使用 localStorage 的 Phonegap/Cordova 应用程序中初始化时，localStorage 似乎被 admob 广告视图覆盖。

这是在 Cordova 2.2 应用程序中初始化 admob 代码（使用 SDK 的 v6.2.1）的代码：

```
public class Foo extends DroidGap
{
    private AdView adView;

    @Override
    public void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        super.setIntegerProperty("splashscreen", R.drawable.splash);

        super.loadUrl("file:///android_asset/www/index.html", 3000);

        adView = new AdView(this, AdSize.SMART_BANNER, "AD_MOB_ID");
        root.addView(adView);
        AdRequest request = new AdRequest();
        request.setTesting(true);
        adView.loadAd(request);
    } 
```

广告已加载，但我用来维护用户会话的 localStorage 似乎已被清除并显示登录页面。当我评论 admob 初始化代码时，localStorage 被恢复并且用户的会话又回来了。

根据 [1] 和 [2] 的说明，我添加了一个处理程序::

```
public class Foo extends DroidGap
{
    private AdView adView;
    private Handler mHandler = new Handler();

    @Override
    public void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        super.setIntegerProperty("splashscreen", R.drawable.splash);

        super.loadUrl("file:///android_asset/www/index.html", 3000);

        mHandler.postDelayed(new Runnable() {
            public void run() {
                loadAdmob();
            }
        }
    }

    private void loadAdmob()
    {
          adView = new AdView(this, AdSize.SMART_BANNER, "AD_MOB_ID");
          root.addView(adView);
          AdRequest request = new AdRequest();
          request.setTesting(true);
          adView.loadAd(request);
    } 
```

这会在 10 秒后尝试加载广告，但我在 logcat:: 中收到以下消息

```
adRequestUrlHtml: <html>...
Received ad url: <url: ...
Request Scenario: Offline with no buffered ads.
Network is unavailable. Aborting ad request.
onFailedToReceiveAd(A network error occurred.) 
```

我可以确认网络连接没有问题（因为应用程序中的其余数据已显示并通过网络获取）但广告没有显示。我做错了什么还是这是一个错误？解决此问题的方法将很有帮助。

[1] [Android + HTML5(LocalStorage) + Admob：错误？](https://stackoverflow.com/questions/8850103/android-html5localstorage-admob-bug)
[2] [https://github.com/phonegap/phonegap/wiki/In-App-Advertisements](https://github.com/phonegap/phonegap/wiki/In-App-Advertisements)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-06T07:51:46.690

在引入延迟时，我在接收网络错误时遇到了同样的问题（可能是由于在另一个线程上运行，它失去了查询网络的必要权限。）

我解决这个问题的方法是覆盖 onAttachToWindow() 并从那里调用 adMob 初始化，并完全删除处理程序代码。它还具有接近即时且没有延迟的副作用。

```
@Override public void onAttachedToWindow() {
    super.onAttachedToWindow();

    doAdMob();
};

private void doAdMob() {
    adView = new AdView(this, AdSize.BANNER, "ID");

    LinearLayout layout = super.root;

    layout.addView(adView);
    AdRequest request = new AdRequest();

    request.addTestDevice("ID");

    adView.loadAd(request);
} 
```

我正在使用 Cordova 2.5 顺便说一句。

更新：AdMod 仍然会破坏本地存储，但它在 AdMob 有机会清除它时加载。但是，在随后的重新加载时，它将被重置。我已经通过添加解决了这种行为

```
window.setTimeout(saveSettings, 5000); 
```

在我加载了我的 localStorage 设置之后。这当然是非常骇人听闻的......但到目前为止似乎可以解决问题。另请注意，我只使用了 AdMob 的测试广告。

# sql - 如何保留每个用户的“已使用”数据列表

> ID：13497859
> 
> 赞同：1
> 
> 时间：2012-11-21T16:38:10.780
> 
> 标签：sql, mongodb, database, nosql

我目前正在 MongoDB 中开展一个项目，我想从数据库中随机抽取新产品的样本。但我的问题不是 MongoDB 特定的，我认为这是一个一般的数据库问题。

场景：

假设我们有一个产品集合（或表格）。我们还有一个用户集合（或表）。每次用户登录时，他们都会看到 10 个产品。这些产品是从集合/表中随机选择的。很简单，但要注意的是，每次用户登录时，都必须向他们展示 10 种他们以前从未见过的产品。我能想到的解决这个问题的两种明显方法是：

1.  每个用户都从他们自己的所有产品的私人列表开始。每次他们获得其中一种产品时，该产品都会从他们的私人列表中删除。结果是下一次从这个先前修剪的列表中选择产品时，它已经只包含新项目。

2.  每个用户都有一个以前查看过的产品的私人列表。当用户登录时，他们从主列表中随机选择 10 个产品，将每个产品的 id 与他们之前查看过的产品列表进行比较，如果该项目出现在之前查看过的列表中，应用程序会丢弃这个选择一个新的, 并迭代直到有 10 个新项目，然后将其添加到先前查看的列表中以供下次使用。

＃1的问题是它似乎是一种巨大的浪费。您基本上会为 n 个用户复制列表数据。此外，向系统删除/添加新项目将是一场噩梦，因为它必须遍历所有用户。#2 似乎更可取，但它也有问题。为了保证 10 个新产品，您最终可能会对数据库进行大量额外和不必要的调用。随着用户使用的产品越来越多，可供选择的新产品越来越少，因此不得不扔掉一个并从数据库中获取新产品的机会大大增加。

有替代解决方案吗？我首先关心的是性能。我将放弃磁盘空间以优化性能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T02:51:48.620

这样做怎么样：创建一个集合`prodUser`，其中只有产品的 ID 和客户 ID 列表（谁看过这些产品）。

```
{
  prodID : 1,
  userID : []
} 
```

当客户登录时，您会发现尚未分配给该用户的 10 个 prodID

```
db.prodUser.find({
  userID : {
    $nin : [yourUser]
  }
}) 
```

（由于某种原因 $not 不起作用:-(。我没有时间弄清楚为什么。如果你愿意 - 请告诉我。）。在向这个人展示他的产品后 - 你可以更新他的 prodUser 集合。为了减轻mongos 无法找到随机元素 - 您可以随机插入元素，然后只找到前 10 个。

一切都应该运行得非常快。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T18:18:06.077

如果你不关心 id 的序列有多随机，你可以这样做：

创建一个仅包含产品 ID 和顺序整数代理键列的随机表。在第一次登录时从列表中的随机点开始每个客户，然后循环浏览按该键排序的列表。如果您到达终点，请从顶部重新开始。

客户记录将包含他们看到的最后一个产品的单个值（随机列表中的代理项，而不是实际 id）。然后，您将在登录时提取接下来的十个并对客户进行一次更新。当然，它不会真的是随机的。但是这种表种子策略是许多更简单的伪随机数生成器的工作原理。

我看到的唯一问题是您的产品列表的增长速度是否比您的用户登录的速度更快。那么他们将永远看不到列表中出现在他们开始之前的部分。即便如此，拥有大量产品和非常活跃的用户，这应该比存储他们看到的所有内容要好得多。因此，如果产品以一组伪随机序列出现并不重要，那么这可能非常适合您。

编辑：

如果你也存储了他们开始的第一条记录，你仍然可以生成所有看到的东西的列表。这将是该值和上次查看之间的所有内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T16:54:05.163

这两种方式完全浪费了主内存和辅助内存。您想展示 2 件从未见过的产品，但这是必须的吗？如果您有很多产品，随机 10 个产品很有可能是独一无二的。

3\. 您可以列出 10 个随机产品，尽管不像 MySQL 中那么简单，但仍然没有 1 和 2 复杂。

# javascript - java脚本onkeypress事件（搜索栏没有按钮）

> ID：13497862
> 
> 赞同：0
> 
> 时间：2012-11-21T16:37:21.327
> 
> 标签：javascript, asp.net

我使用这个 javascript 在我的 onkeypress 上有一个事件

```
function myFunction() {
   if (window.event || window.event.keyCode == 13) {   
      changeSource();
   } 
}

function changeSource(){
   document.getElementById("frame1").src="Log-In.aspx";
   window.alert("wow");
} 
```

这是我将使用我的 onkeypress 事件的地方

```
<input id= "Text1" placeholder="Search here..." type="text" onkeypress="myFunction()"/> 
```

这是我希望事件发生变化的 iframe

```
<iframe id="frame1" width="100%" height="100%" frameborder="0" name="page" src="about:blank" ></iframe> 
```

问题是我无法更改 iframe 中的 src 但事件正在触发

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T16:48:49.613

使用 setAttribute 更改属性值。

```
document.getElementById("frame1").setAttribute('src',"Log-In.aspx"); 
```

# scala - 从哪里开始依赖类型编程？

> ID：13497865
> 
> 赞同：43
> 
> 时间：2012-11-21T16:37:34.853
> 
> 标签：scala, haskell, agda, dependent-type, idris

有一个 Idris 教程、一个 Agda 教程和许多其他教程风格的论文和介绍性材料，其中不断引用尚未学习的东西。我有点在所有这些中间爬行，而且大多数时候我都被数学符号和突然出现的新术语所困，没有任何解释。也许我的数学很烂:-)

是否有任何规范的方法来处理依赖类型编程？就像当你想学习 Haskell 时，你从“自学 Haskell”开始，当你想学习 Scala 时，你从 Odersky 的书开始，对于 Ruby，你阅读那个带有变异错误的奇怪教程。但我不能从他们的书开始 Agda 或 Idris。他们在我的头上。我尝试了 Coq 并陷入了它的所有关于 teorm 证明的风格。Agda 需要大量的数学背景，而 Idris，好吧，让我们暂时离开吧！

我非常了解静态类型系统，我精通 Scala，如有必要，我可以使用 Haskell。我了解函数范式并每天使用它，我了解代数数据类型和 GADT（实际上非​​常顺利），并且我最近设法理解了 Lambda Cube。不过，我缺乏数学和逻辑部分。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-11-21T17:30:33.877

我强烈推荐[Software Foundations](http://www.cis.upenn.edu/~bcpierce/sf/)。这本书非常适合一次一步地向您介绍 Coq。有很多定理证明，是的，但这是依赖类型美味的一部分。当“编程”和“证明”之间的界限开始模糊时，这是一种很棒的感觉。

> 不过，我缺乏数学和逻辑部分。

我认为 Software Foundations 在让您快速了解您需要了解的逻辑方面做得非常好。不过，已经熟悉暗示的概念会有所帮助。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2013-01-12T10:32:29.993

（注意：这是一个自我广告）

我正在写一个[Agda 教程](https://people.inf.elte.hu/divip/AgdaTutorial/Index.html)，我的主要目标是让人们在没有理论背景的情况下使用 Agda。

本教程可能会解决您的大部分问题：

*   试图解释没有外部引用的 Agda 编程
*   只需要中学数学
*   也尝试教授编程实践

它正在开发中，但前半部分已经准备就绪。

# iphone - 在 UITableViewCell 子类中设置变量

> ID：13497866
> 
> 赞同：0
> 
> 时间：2012-11-21T16:38:43.793
> 
> 标签：iphone, objective-c, uitableview, subclass

我有一个 UITableViewCell 子类，我需要有两个 UIColor 变量。我已经在标题中声明了它们，但是在实现中我会在哪里设置它们的值以便以后访问？

我需要一个类似的方法，`viewDidLoad`以便在单元加载时设置这些。我试过设置它们，`initWithStyle`但它没有用，因为我不使用它来创建我的单元格。

在我的视图控制器中，我将它们加载如下：

```
CustomCell *cell = [tv dequeueReusableCellWithIdentifier:cellIdentifier]; 
```

那么我应该在哪里设置这些变量呢？（我想尝试将它们保留在子类中。）

## 编辑

这是我的`cellForRowAtIndexPath`方法：

```
- (CustomCell *)tableView:(UITableView *)tv cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *cellIdentifier = @"Cell";

    CustomCell *cell = [tv dequeueReusableCellWithIdentifier:cellIdentifier];
    if (cell == nil) cell = [[CustomCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:cellIdentifier];

    return cell;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T17:00:53.150

如果您使用的是故事板和原型，那么您的单元格将`awakeFromNib`在首次创建时调用它。你可以把你的代码放在这里。

`initWithStyle:`未调用，因为您的单元格是从笔尖加载的。它将`initWithCoder:`改为使用初始化。您也可以将代码放在那里，或者放在从那里调用的共享设置方法和 initWithStyle 中（如果您将来更改使用单元格的方式）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T16:46:58.077

initWithStyle 是 UITableViewCell 类的指定初始化程序，因此您必须使用该方法来初始化 UITableViewCell。仅当您已初始化单元格并且有可用于出列的单元格时，出队才有效。

如果单元格为零，您可以看到您分配和初始化的代码。

# web-services - 从套接字移动到 Web 服务：双重超时

> ID：13497867
> 
> 赞同：2
> 
> 时间：2012-11-21T16:38:43.477
> 
> 标签：web-services, rest

我有一个客户端/服务器应用程序，它通过一个通常不可靠的无线网络通过 tcp/ip 套接字进行通信。为了在连接错误的情况下做出响应，我创建了这个协议。1）客户端发送请求 2）服务器确认接收请求（1 秒超时） 3）服务器进程同时客户端等待（可能需要长达 10 秒）（20 秒超时） 4）服务器发送响应 有时请求命令会丢失（客户端通过打开的连接发送它，但服务器从不接收它），但使用此协议，我立即知道命令是否已收到并将被处理。

我要问的是（我已经用 RESTSharp 和 ServiceStack 做了一些测试）是：有可能用 web 服务做这样的事情吗？在响应之前的客户端收到请求已收到的确认？

谢谢， 马蒂亚

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T17:32:46.437

在应用程序代码中看到这种类型的错误处理很奇怪，因为如果 HTTP 请求不成功，它已经抛出异常。

要在应用程序代码中获得确认回执，您需要添加第二个请求来实现某种[推送事件/彗星](http://en.wikipedia.org/wiki/Comet_%28programming%29)技术，以使服务器通知客户端不同的事件，例如已收到哪些请求 ID。

# ios - UIScrollView - 为 CGAffineTransform 使用缩放比例和内容偏移

> ID：13497882
> 
> 赞同：3
> 
> 时间：2012-11-21T16:39:21.410
> 
> 标签：ios, uiscrollview, cgaffinetransform

关于此的一些背景-> 我正在使用 UIScrollview（持有 10,000x10,000 的 catiledlayer 支持视图）并将其委托传递给自定义覆盖视图（即屏幕的大小），该视图将根据以下情况进行缩放和移动视图的缩放和内容偏移。

我正在努力驯服 didScroll: didZoom: 代表到 CGAffineTransform 中的 contentoffset/zoomscale，我可以将其应用于我的“叠加”视图。滚动非常简单，因为它是一个简单的翻译。缩放似乎是一个挑战，因为我还必须结合当前的翻译。一旦滚动/缩放停止，我就会清除变换和重绘视图（这是最简单的部分）。

（上一个问题[UIScrollView w/ Large CATiledLayer + Overlay 可以快速呈现](https://stackoverflow.com/questions/12150609/uiscrollview-w-large-catiledlayer-overlay-that-renders-fast)有关执行此操作的最佳方法）

所以我的问题是：如何将 contentoffset 和 zoomscale 转换为可以应用于另一个视图的 cgaffinetransform，以使其看起来像是在捏/缩放/滚动覆盖视图？

# sql - 为什么 Oracle 使用 ORDER BY 忽略索引？

> ID：13497887
> 
> 赞同：16
> 
> 时间：2012-11-21T16:38:51.727
> 
> 标签：sql, performance, oracle, database-performance, sql-execution-plan

我的目的是获得客户的分页结果集。我正在使用来自[Tom](http://www.oracle.com/technetwork/issue-archive/2007/07-jan/o17asktom-093877.html)的这个算法：

```
select * from (
  select /*+ FIRST_ROWS(20) */ FIRST_NAME, ROW_NUMBER() over (order by FIRST_NAME) RN
  from CUSTOMER C
)
where RN between 1 and 20
order by RN; 
```

我还在“客户”列上定义了一个索引。“FIRST_NAME”：

```
CREATE INDEX CUSTOMER_FIRST_NAME_TEST ON CUSTOMER (FIRST_NAME ASC); 
```

查询返回预期的结果集，但从解释计划中我注意到未使用索引：

```
--------------------------------------------------------------------------------------
| Id  | Operation                 | Name     | Rows  | Bytes | Cost (%CPU)| Time     |
--------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT          |          | 15467 |   679K|   157   (3)| 00:00:02 |
|   1 |  SORT ORDER BY            |          | 15467 |   679K|   157   (3)| 00:00:02 |
|*  2 |   VIEW                    |          | 15467 |   679K|   155   (2)| 00:00:02 |
|*  3 |    WINDOW SORT PUSHED RANK|          | 15467 |   151K|   155   (2)| 00:00:02 |
|   4 |     TABLE ACCESS FULL     | CUSTOMER | 15467 |   151K|   154   (1)| 00:00:02 |
--------------------------------------------------------------------------------------

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - filter("RN">=1 AND "RN"<=20)
   3 - filter(ROW_NUMBER() OVER ( ORDER BY "FIRST_NAME")<=20) 
```

我正在使用 Oracle 11g。由于我只查询按索引列排序的前 20 行，因此我希望使用索引。

为什么 Oracle 优化器会忽略索引？我认为分页算法有问题，但我不知道是什么。

谢谢。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-11-21T16:45:13.727

您的 FIRST_NAME 列很可能可以为空。

```
SQL> create table customer (first_name varchar2(20), last_name varchar2(20));

Table created.

SQL> insert into customer select dbms_random.string('U', 20), dbms_random.string('U', 20) from dual connect by level <= 100000;

100000 rows created.

SQL> create index c on customer(first_name);

Index created.

SQL> explain plan for select * from (
  2    select /*+ FIRST_ROWS(20) */ FIRST_NAME, ROW_NUMBER() over (order by FIRST_NAME) RN
  3    from CUSTOMER C
  4  )
  5  where RN between 1 and 20
  6  order by RN;

Explained.

SQL> @explain ""

Plan hash value: 1474094583

----------------------------------------------------------------------------------------------
| Id  | Operation                 | Name     | Rows  | Bytes |TempSpc| Cost (%CPU)| Time     |
----------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT          |          |   117K|  2856K|       |  1592   (1)| 00:00:20 |
|   1 |  SORT ORDER BY            |          |   117K|  2856K|  4152K|  1592   (1)| 00:00:20 |
|*  2 |   VIEW                    |          |   117K|  2856K|       |   744   (2)| 00:00:09 |
|*  3 |    WINDOW SORT PUSHED RANK|          |   117K|  1371K|  2304K|   744   (2)| 00:00:09 |
|   4 |     TABLE ACCESS FULL     | CUSTOMER |   117K|  1371K|       |   205   (1)| 00:00:03 |
----------------------------------------------------------------------------------------------

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - filter("RN">=1 AND "RN"<=20)
   3 - filter(ROW_NUMBER() OVER ( ORDER BY "FIRST_NAME")<=20)

Note
-----
   - dynamic sampling used for this statement (level=2)

21 rows selected.

SQL> alter table customer modify first_name not null;

Table altered.

SQL> explain plan for select * from (
  2    select /*+ FIRST_ROWS(20) */ FIRST_NAME, ROW_NUMBER() over (order by FIRST_NAME) RN
  3    from CUSTOMER C
  4  )
  5  where RN between 1 and 20
  6  order by RN;

Explained.

SQL> @explain ""

Plan hash value: 1725028138

----------------------------------------------------------------------------------------
| Id  | Operation               | Name | Rows  | Bytes |TempSpc| Cost (%CPU)| Time     |
----------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT        |      |   117K|  2856K|       |   850   (1)| 00:00:11 |
|   1 |  SORT ORDER BY          |      |   117K|  2856K|  4152K|   850   (1)| 00:00:11 |
|*  2 |   VIEW                  |      |   117K|  2856K|       |     2   (0)| 00:00:01 |
|*  3 |    WINDOW NOSORT STOPKEY|      |   117K|  1371K|       |     2   (0)| 00:00:01 |
|   4 |     INDEX FULL SCAN     | C    |   117K|  1371K|       |     2   (0)| 00:00:01 |
----------------------------------------------------------------------------------------

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - filter("RN">=1 AND "RN"<=20)
   3 - filter(ROW_NUMBER() OVER ( ORDER BY "FIRST_NAME")<=20)

Note
-----
   - dynamic sampling used for this statement (level=2)

21 rows selected.

SQL> 
```

在那里添加一个 NOT NULL 来解决它。

```
SQL> explain plan for select * from (
  2    select /*+ FIRST_ROWS(20) */ FIRST_NAME, ROW_NUMBER() over (order by FIRST_NAME) RN
  3    from CUSTOMER C
  4    where first_name is not null
  5  )
  6  where RN between 1 and 20
  7  order by RN;

Explained.

SQL> @explain ""

Plan hash value: 1725028138

----------------------------------------------------------------------------------------
| Id  | Operation               | Name | Rows  | Bytes |TempSpc| Cost (%CPU)| Time     |
----------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT        |      |   117K|  2856K|       |   850   (1)| 00:00:11 |
|   1 |  SORT ORDER BY          |      |   117K|  2856K|  4152K|   850   (1)| 00:00:11 |
|*  2 |   VIEW                  |      |   117K|  2856K|       |     2   (0)| 00:00:01 |
|*  3 |    WINDOW NOSORT STOPKEY|      |   117K|  1371K|       |     2   (0)| 00:00:01 |
|*  4 |     INDEX FULL SCAN     | C    |   117K|  1371K|       |     2   (0)| 00:00:01 |
----------------------------------------------------------------------------------------

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - filter("RN">=1 AND "RN"<=20)
   3 - filter(ROW_NUMBER() OVER ( ORDER BY "FIRST_NAME")<=20)
   4 - filter("FIRST_NAME" IS NOT NULL)

Note
-----
   - dynamic sampling used for this statement (level=2)

22 rows selected.

SQL> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T16:43:20.673

您查询的列多于`first_name`. 上的索引`first_name`仅包含`first_name`列和对表的引用。**因此，要检索其他列，Oracle 必须为每一行**执行对表本身的查找。如果不能保证低记录数，大多数数据库都会尝试避免这种情况。

数据库通常不够聪明，无法知道`where`子句对`row_number`列的影响。但是，您的提示`/*+ FIRST_ROWS(20) */`可能已经成功了。

也许表真的很小，所以 Oracle 期望表扫描比查找便宜，即使只有 20 行。

# python - python：绕过零除

> ID：13497891
> 
> 赞同：23
> 
> 时间：2012-11-21T16:39:01.883
> 
> 标签：python, numpy, division

我有一个大数据集的浮点数。我遍历它们并评估它们`np.log(x)`中的每一个。我明白了

```
RuntimeWarning: divide by zero encountered in log 
```

如果发生此错误，我想解决此问题并返回 0。

我正在考虑定义一个新功能：

```
def safe_ln(x):
    #returns: ln(x) but replaces -inf with 0
    l = np.log(x)
    #if l = -inf:
    l = 0
    return l 
```

基本上，我需要一种测试输出的方法，`-inf`但我不知道如何进行。感谢您的帮助！

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-11-21T18:13:01.683

您正在使用 np 函数，所以我可以安全地猜测您正在处理 numpy 数组？那么最有效的方法是使用 where 函数而不是 for 循环

```
myarray= np.random.randint(10,size=10)
result = np.where(myarray>0, np.log(myarray), 0) 
```

否则你可以简单地使用日志功能，然后修补漏洞：

```
myarray= np.random.randint(10,size=10)
result = np.log(myarray)
result[result==-np.inf]=0 
```

np.log 函数在值 0 时正确返回 -inf，所以您确定要返回 0 吗？如果您必须在某个地方恢复到原始值，您将遇到一些问题，将零变为一...

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2012-11-21T16:43:05.820

由于`log`for`x=0`是负无穷大，我只需检查输入值是否为零并返回您想要的任何内容：

```
def safe_ln(x):
    if x <= 0:
        return 0
    return math.log(x) 
```

**编辑**：小编辑：您应该检查所有小于或等于 0 的值。

**编辑 2**：`np.log`当然是一个在 numpy 数组上计算的函数，对于你应该使用的单个值`math.log`。这是上面的函数在 numpy 中的样子：

```
def safe_ln(x, minval=0.0000000001):
    return np.log(x.clip(min=minval)) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-21T16:44:09.550

你可以这样做。

```
def safe_ln(x):
   try:
      l = np.log(x)
   except ZeroDivisionError:
      l = 0
   return l 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-09-24T18:00:07.443

Enrico 给出的答案很好，但两种解决方案都会导致警告：

```
RuntimeWarning: divide by zero encountered in log 
```

作为替代方案，我们仍然可以使用该`where`函数，但只在适当的地方执行主计算：

```
# alternative implementation -- a bit more typing but avoids warnings.
loc = np.where(myarray>0)
result2 = np.zeros_like(myarray, dtype=float)
result2[loc] =np.log(myarray[loc])

# answer from Enrico...
myarray= np.random.randint(10,size=10)
result = np.where(myarray>0, np.log(myarray), 0)

# check it is giving right solution:
print(np.allclose(result, result2)) 
```

我的用例是除法，但原理显然是一样的：

```
x = np.random.randint(10, size=10)
divisor = np.ones(10,)
divisor[3] = 0 # make one divisor invalid

y = np.zeros_like(divisor, dtype=float)
loc = np.where(divisor>0) # (or !=0 if your data could have -ve values)
y[loc] = x[loc] / divisor[loc] 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-21T16:43:44.573

使用异常处理：

```
In [27]: def safe_ln(x):
    try:
        return math.log(x)
    except ValueError:       # np.log(x) might raise some other error though
        return float("-inf")
   ....:     

In [28]: safe_ln(0)
Out[28]: -inf

In [29]: safe_ln(1)
Out[29]: 0.0

In [30]: safe_ln(-100)
Out[30]: -inf 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-06-09T22:05:37.077

我喜欢使用`sys.float_info.min`如下：

```
>>> import numpy as np
>>> import sys
>>> arr = np.linspace(0.0, 1.0, 3)
>>> print(arr)
[0\.  0.5 1\. ]
>>> arr[arr < sys.float_info.min] = sys.float_info.min
>>> print(arr)
[2.22507386e-308 5.00000000e-001 1.00000000e+000]
>>> np.log10(arr)
array([-3.07652656e+02, -3.01029996e-01,  0.00000000e+00]) 
```

其他答案也引入了小的正值，但是当我为太小而无法处理的输入近似结果时，我更喜欢使用最小的有效输入。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-21T16:42:17.323

你可以这样做：

```
def safe_ln(x):
    #returns: ln(x) but replaces -inf with 0
    try:
        l = np.log(x)
    except RunTimeWarning:
        l = 0
    return l 
```

# google-maps - 谷歌地图视觉加载指示器

> ID：13497892
> 
> 赞同：3
> 
> 时间：2012-11-21T16:40:16.480
> 
> 标签：google-maps

目前是否有任何功能可用于将视觉加载指示器应用于谷歌地图 API

谢谢

# jsf-2 - jsf 不寻找它的 bean

> ID：13497893
> 
> 赞同：0
> 
> 时间：2012-11-21T16:39:22.723
> 
> 标签：jsf-2, annotations, icefaces

我正在使用 JSF 2.1 和 Maven 构建基于 ICEmobile 的 Web 应用程序。当我的 jsf 页面没有查找它的 bean 时，我遇到了这个问题，但我仍然可以毫无错误地构建和部署项目，我通过 Eclipse: 中的运行配置部署项目`clean tomcat7:run-war`。即使我通过注释或 applicationContext.xml 声明了 bean，页面仍然没有正确调用 bean。我可以获取 bean 中字段的值，但无法调用该 bean 中的方法，`System.out.println("Pressed");`不会向控制台提供任何输出。我猜这一定与我的配置有关，但我不知道在哪里查看。请给我一些提示。谢谢

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:util="http://java.sun.com/jsf/composite/components"
    xmlns:mobi="http://www.icesoft.com/icefaces/mobile/component"
    xmlns:ice="http://www.icesoft.com/icefaces/component"
    xmlns:icecore="http://www.icefaces.org/icefaces/core">
<h:head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
    <meta name="viewport"
        content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />

    <title>ICEfaces Mobile Showcase</title>
    <mobi:deviceStylesheet media="screen" />
</h:head>
<h:body>
    <mobi:pagePanel>
        <f:facet name="body">
            <h:form>
                    <mobi:commandButton value="#{buttonBean.buttonName}" buttonType="important" actionListener="#{buttonBean.buttonPress}">
                <f:attribute name="buttonState" value="change"/>
            </mobi:commandButton>   
            </h:form>
        </f:facet>
    </mobi:pagePanel>
</h:body>
</html> 
```

豆子：

```
import javax.faces.bean.ManagedBean;
import javax.faces.bean.SessionScoped;
import javax.faces.event.ActionEvent;

@ManagedBean(name = ButtonBean.BEAN_NAME)
@SessionScoped
public class ButtonBean implements Serializable {

    private static final long serialVersionUID = 1L;

    public static final String BEAN_NAME = "buttonBean";

    private String buttonName = "0";

    public String getButtonName() {
        return buttonName;
    }

    public void setButtonName(String buttonName) {
        this.buttonName = buttonName;
    }

    public void buttonPress(ActionEvent event){
        System.out.println("Pressed");
        String buttonState = (String)event.getComponent().getAttributes().get("buttonState");
        if (buttonState.equals("change") && buttonName.equals("0")) buttonName = "1";
        else if (buttonState.equals("change") && buttonName.equals("1")) buttonName = "0";
    }  
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T13:30:15.400

我发现我的 web.xml 被设置为 2.5 版。更改为 3.0 版。现在所有作品

# c# - 图片拼图：将一张图片设置为与另一张图片相同的大小和位置

> ID：13497896
> 
> 赞同：-1
> 
> 时间：2012-11-21T16:39:38.453
> 
> 标签：c#, wpf, image, bitmap, grid

今天我已经问过你一个关于我的图片拼图的问题（[原始问题](https://stackoverflow.com/questions/13488809/picture-puzzle-spaces-gaps-between-grid-rows/13488942)）。

我开始重写我的代码以获得更好的性能。我完成了最重要的部分！

但是我还有另一个问题。我生成了一个灰色叠加图像来隐藏图像，但是因为我想处理图片的动态大小，所以我无法为“掩码”设置固定的宽度和高度值。所以可能不是整个画面都覆盖着我的“面具”。

有人对此有解决方案吗？我不知道如何将我的蒙版的位置和大小完全设置为图片的位置和大小。

我附上了演示的截屏视频。

XAML：

```
<Window x:Class="PicturePuzzle.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow"
        Loaded="WindowLoaded">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition Height="80" />
        </Grid.RowDefinitions>

        <Grid x:Name="grid"
              Margin="5"
              HorizontalAlignment="Center"
              VerticalAlignment="Top">

            <Image x:Name="imgPicture"
                   HorizontalAlignment="Stretch"
                   VerticalAlignment="Stretch"
                   Source="Images/puzzle.gif"
                   Stretch="Uniform" />
            <Image x:Name="imgMask" RenderOptions.EdgeMode="Aliased" />
        </Grid>

        <StackPanel Grid.Row="1"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center">
            <StackPanel Margin="0,0,0,10" Orientation="Horizontal">
                <Button x:Name="btnStart"
                        Width="60"
                        Margin="0,0,5,0"
                        Click="BtnStartClick"
                        Content="Start" />
                <Button x:Name="btnStop"
                        Width="60"
                        Click="BtnStopClick"
                        Content="Stop"
                        IsEnabled="False" />
                <ToggleButton x:Name="btnSolution"
                              Margin="5,0,0,0"
                              Checked="btnSolution_Checked"
                              Content="Lösung anzeigen"
                              Unchecked="btnSolution_Unchecked" />
            </StackPanel>
            <Slider x:Name="slSpeed"
                    IsDirectionReversed="True"
                    Maximum="10"
                    Minimum="1"
                    ValueChanged="SlSpeedValueChanged"
                    Value="10" />
        </StackPanel>
    </Grid>
</Window> 
```

代码隐藏：

```
using System;
using System.Collections.Generic;
using System.IO;
using System.Windows;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Threading;

namespace PicturePuzzle
{
    /// <summary>
    /// Interaction logic for MainWindow.xaml
    /// </summary>
    public partial class MainWindow
    {
        public MainWindow()
        {
            InitializeComponent();

            _positionAlphaValues = new Dictionary<Point, byte>();

            _images = new List<FileInfo>();
            using (var s = new StreamReader("Images.txt"))
            {
                while (!s.EndOfStream)
                {
                    var line = s.ReadLine();

                    if (string.IsNullOrWhiteSpace(line))
                    {
                        continue;
                    }

                    var fi = new FileInfo(line);

                    if (!fi.Exists)
                    {
                        continue;
                    }

                    _images.Add(fi);
                }
            }
        }

        private const int MaxQuadsX = 5;
        private const int MaxQuadsY = 5;

        private readonly List<FileInfo> _images;

        private DispatcherTimer _timer;
        private DispatcherTimer _alphaTimer;
        private WriteableBitmap _bitmap;
        private Size _size;
        private List<Point> _positions;
        private Dictionary<Point, byte> _positionAlphaValues;
        private int _tickCounter;
        private int _imageCounter;
        private int _quadWidth;
        private int _quadHeight;

        private void WindowLoaded(object sender, RoutedEventArgs e)
        {
            _size = imgPicture.RenderSize;

            var width = (int)Math.Ceiling(_size.Width);
            var height = (int)Math.Ceiling(_size.Height);

            _quadWidth = width / MaxQuadsX;
            _quadHeight = height / MaxQuadsY;

            imgPicture.Width = _quadWidth * MaxQuadsX - 5;
            imgPicture.Height = _quadHeight * MaxQuadsY - 5;

            _bitmap = new WriteableBitmap(width, height, 96, 96, PixelFormats.Bgra32, null);

            imgMask.Source = _bitmap;
        }

        #region Click handlers

        private void BtnStartClick(object sender, RoutedEventArgs e)
        {
            btnStart.IsEnabled = false;
            btnStop.IsEnabled = true;
            btnSolution.IsChecked = false;

            // set the real picture
            _imageCounter = 0;
            _images.Shuffle();
            SetPuzzlePicture();

            _timer = new DispatcherTimer { Interval = TimeSpan.FromSeconds(slSpeed.Value / 10) };
            _timer.Tick += TimerTick;
            _timer.Start();

            _alphaTimer = new DispatcherTimer { Interval = TimeSpan.FromSeconds(0.1) };
            _alphaTimer.Tick += AlphaTimerOnTick;
            _alphaTimer.Start();
        }

        private void BtnStopClick(object sender, RoutedEventArgs e)
        {
            btnStart.IsEnabled = true;
            btnStop.IsEnabled = false;

            _timer.Stop();
            _alphaTimer.Stop();
        }

        private void SlSpeedValueChanged(object sender, RoutedPropertyChangedEventArgs<double> e)
        {
            if (_timer != null)
            {
                _timer.Interval = TimeSpan.FromSeconds(slSpeed.Value / 10);
            }
        }

        private void btnSolution_Checked(object sender, RoutedEventArgs e)
        {
            btnStop.IsEnabled = false;

            StopTimers();

            imgMask.Visibility = Visibility.Hidden;
        }

        private void btnSolution_Unchecked(object sender, RoutedEventArgs e)
        {
            btnStart.IsEnabled = true;
            btnStop.IsEnabled = false;

            ResetMaskImage();
        }

        #endregion

        private void SetPuzzlePicture()
        {
            _positionAlphaValues.Clear();

            ResetMaskImage();

            var imgFile = _images[_imageCounter++];

            var image = new BitmapImage();
            image.BeginInit();
            image.UriSource = new Uri(imgFile.FullName, UriKind.Absolute);
            image.EndInit();

            imgPicture.Source = image;
        }

        private void TimerTick(object sender, EventArgs e)
        {
            if (_tickCounter >= _positions.Count)
            {
                if (_imageCounter >= _images.Count)
                {
                    _timer.Stop();

                    btnStart.IsEnabled = true;
                    btnStop.IsEnabled = false;

                    return;
                }

                SetPuzzlePicture();
            }

            var randomPoint = _positions[_tickCounter++];

            _positionAlphaValues.Add(randomPoint, 255);
        }

        private void AlphaTimerOnTick(object sender, EventArgs eventArgs)
        {
            var updatedList = new Dictionary<Point, byte>();

            foreach (var e in _positionAlphaValues)
            {
                var newValue = e.Value - (11 - slSpeed.Value) * 5;

                if (newValue <= 0)
                {
                    continue;
                }

                SetAlphaChannel(e.Key, (byte)newValue);
                updatedList.Add(e.Key, (byte)newValue);
            }

            _positionAlphaValues = updatedList;
        }

        private void StopTimers()
        {
            if (_timer != null)
            {
                _timer.Stop();
            }

            if (_alphaTimer != null)
            {
                _alphaTimer.Stop();
            }
        }

        private void ResetMaskImage()
        {
            imgMask.Visibility = Visibility.Visible;

            var width = _quadWidth * MaxQuadsX;
            var height = _quadHeight * MaxQuadsY;
            var size = width * height * 4;

            var buffer = new byte[size];

            for (int i = 0; i < size; i++)
            {
                buffer[i++] = 128;
                buffer[i++] = 128;
                buffer[i++] = 128;
                buffer[i] = 255;
            }

            var area = new Int32Rect(0, 0, width, height);
            _bitmap.WritePixels(area, buffer, width * 4, 0);

            _positions = GetPositions();
            _tickCounter = 0;
        }

        private void SetAlphaChannel(Point point, byte alpha)
        {
            var size = _quadWidth * _quadHeight * 4;
            var buffer = new byte[size];

            for (int i = 0; i < size; i++)
            {
                buffer[i++] = 128;
                buffer[i++] = 128;
                buffer[i++] = 128;
                buffer[i] = alpha;
            }

            var startX = (int)point.X * _quadWidth;
            var startY = (int)point.Y * _quadHeight;

            var area = new Int32Rect(startX, startY, _quadWidth, _quadHeight);
            _bitmap.WritePixels(area, buffer, _quadWidth * 4, 0);
        }

        private List<Point> GetPositions()
        {
            var generated = new List<Point>();

            for (int y = 0; y < MaxQuadsY; y++)
            {
                for (int x = 0; x < MaxQuadsX; x++)
                {
                    var point = new Point(x, y);

                    generated.Add(point);
                }
            }

            generated.Shuffle();

            return generated;
        }
    }
} 
```

扩展.cs

```
using System;
using System.Collections.Generic;
using System.Windows.Media;
using System.Windows.Media.Imaging;

namespace PicturePuzzle
{
    public static class Extensions
    {
        public static Color GetPixel(this WriteableBitmap wbm, int x, int y)
        {
            if (y > wbm.PixelHeight - 1 || x > wbm.PixelWidth - 1)
                return Color.FromArgb(0, 0, 0, 0);

            if (y < 0 || x < 0)
                return Color.FromArgb(0, 0, 0, 0);

            if (!wbm.Format.Equals(PixelFormats.Bgra32))
                return Color.FromArgb(0, 0, 0, 0);

            IntPtr buff = wbm.BackBuffer;
            int stride = wbm.BackBufferStride;
            Color c;

            unsafe
            {
                var pbuff = (byte*)buff.ToPointer();
                int loc = y * stride + x * 4;

                c = Color.FromArgb(
                  pbuff[loc + 3],
                  pbuff[loc + 2], pbuff[loc + 1],
                  pbuff[loc]);
            }

            return c;
        }

        public static void Shuffle<T>(this IList<T> list)
        {
            var rng = new Random();
            int n = list.Count;
            while (n > 1)
            {
                n--;
                int k = rng.Next(n + 1);
                T value = list[k];
                list[k] = list[n];
                list[n] = value;
            }
        }
    }
} 
```

示例 Images.txt （必须在您的输出文件夹中，图像也）：

```
Desert.jpg
Hydrangeas.jpg
Jellyfish.jpg
Koala.jpg
Lighthouse.jpg
Penguins.jpg
Tulips.jpg
androids.gif
Chrysanthemum.jpg 
```

和截屏：截屏[链接](http://screencast.com/t/Ktunt0lRb3)

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T20:00:41.347

您可以将遮罩图像的`HorizontalAlignment`和设置为和填充，如下所示：`VerticalAlignment``Stretch``Stretch`

`<Image HorizontalAlignment="Stretch" VerticalAlignment="Stretch" x:Name="imgMask" Stretch="Fill" RenderOptions.EdgeMode="Aliased" />`

这将导致掩码图像填充网格，该网格将调整为其他图像的大小。

# jenkins - 黄瓜无头 xvfb ubuntu

> ID：13497901
> 
> 赞同：3
> 
> 时间：2012-11-21T16:40:12.897
> 
> 标签：jenkins, cucumber, watir-webdriver, headless, xvfb

我正在尝试在 Amazon EC2 上设置 Jenkins 构建服务器。我计划在无头模式下运行我的黄瓜测试套件。我成功地在 IRB 中无头运行

```
require 'watir-webdriver'
require 'headless'
headless = Headless.new
headless.start
b = Watir::Browser.new(:chrome)
b.goto("www.google.com")
b.title
b.close
headless.destroy 
```

但是如果我将以下内容添加到我的 env.rb

```
if ENV['HEADLESS']
  require 'headless'
  headless = Headless.new
  headless.start
  at_exit do
    headless.destroy
  end
end 
```

并运行

```
cucumber ENV=HEADLESS features/test.feature:25 
```

我收到以下错误。

```
 end of file reached (EOFError)
 /var/lib/jenkins/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/net/protocol.rb:141:in `read_nonblock'
 /var/lib/jenkins/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/net/protocol.rb:141:in `rbuf_fill'
 /var/lib/jenkins/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/net/protocol.rb:122:in `readuntil'
 /var/lib/jenkins/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/net/protocol.rb:132:in `readline'
 /var/lib/jenkins/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/net/http.rb:2562:in `read_status_line'
 /var/lib/jenkins/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/net/http.rb:2551:in `read_new'
 /var/lib/jenkins/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/net/http.rb:1319:in `block in transport_request'
 /var/lib/jenkins/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/net/http.rb:1316:in `catch'
 /var/lib/jenkins/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/net/http.rb:1316:in `transport_request'
 /var/lib/jenkins/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/net/http.rb:1293:in `request'
 /var/lib/jenkins/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/net/http.rb:1286:in `block in request'
 /var/lib/jenkins/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/net/http.rb:745:in `start'
 /var/lib/jenkins/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/net/http.rb:1284:in `request'
 /var/lib/jenkins/.rvm/gems/ruby-1.9.3-p286@cucumber/gems/selenium-webdriver-2.25.0/lib/selenium/webdriver/remote/http/default.rb:82:in `response_for'
 /var/lib/jenkins/.rvm/gems/ruby-1.9.3-p286@cucumber/gems/selenium-webdriver-2.25.0/lib/selenium/webdriver/remote/http/default.rb:38:in `request'
 /var/lib/jenkins/.rvm/gems/ruby-1.9.3-p286@cucumber/gems/selenium-webdriver-2.25.0/lib/selenium/webdriver/remote/http/common.rb:40:in `call'
 /var/lib/jenkins/.rvm/gems/ruby-1.9.3-p286@cucumber/gems/selenium-webdriver-2.25.0/lib/selenium/webdriver/remote/bridge.rb:598:in `raw_execute'
 /var/lib/jenkins/.rvm/gems/ruby-1.9.3-p286@cucumber/gems/selenium-webdriver-2.25.0/lib/selenium/webdriver/remote/bridge.rb:92:in `create_session'
 /var/lib/jenkins/.rvm/gems/ruby-1.9.3-p286@cucumber/gems/selenium-webdriver-2.25.0/lib/selenium/webdriver/remote/bridge.rb:68:in `initialize'
 /var/lib/jenkins/.rvm/gems/ruby-1.9.3-p286@cucumber/gems/selenium-webdriver-2.25.0/lib/selenium/webdriver/chrome/bridge.rb:29:in `initialize'
 /var/lib/jenkins/.rvm/gems/ruby-1.9.3-p286@cucumber/gems/selenium-webdriver-2.25.0/lib/selenium/webdriver/common/driver.rb:37:in `new'
 /var/lib/jenkins/.rvm/gems/ruby-1.9.3-p286@cucumber/gems/selenium-webdriver-2.25.0/lib/selenium/webdriver/common/driver.rb:37:in `for'
 /var/lib/jenkins/.rvm/gems/ruby-1.9.3-p286@cucumber/gems/selenium-webdriver-2.25.0/lib/selenium/webdriver.rb:65:in `for'
 /var/lib/jenkins/.rvm/gems/ruby-1.9.3-p286@cucumber/gems/watir-webdriver-0.6.1/lib/watir-webdriver/browser.rb:35:in `initialize'
 /var/lib/jenkins/automation/features/support/hooks.rb:9:in `new'
 /var/lib/jenkins/automation/features/support/hooks.rb:9:in `Before'
    Given I am on the login page
    And login as a blogger
    Then I must see the text "Blog List"
      undefined method `driver' for nil:NilClass (NoMethodError)
      /var/lib/jenkins/automation/features/support/hooks.rb:27:in `After'
      undefined method `close' for nil:NilClass (NoMethodError)
      /var/lib/jenkins/automation/features/support/hooks.rb:17:in `After' 
```

任何帮助将不胜感激。谢谢！！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T17:24:07.567

问题出在命令行 env 参数中

```
cucumber HEADLESS=true features/test.feature:25 
```

代替

```
cucumber ENV=HEADLESS features/test.feature:25 
```

# mysql - 如何从格式化时间添加 2 小时

> ID：13497905
> 
> 赞同：0
> 
> 时间：2012-11-21T16:41:20.413
> 
> 标签：mysql

我需要知道如何将 2 小时添加到下面的“已完成”时间戳。

这是选择语句

```
 Select Tsk.task_id,Tsk.org_id,Tsk.completed,Tsk.assgn_acct_id,name 
    FROM tdstelecom.tasks As Tsk
    WHERE Tsk.task_id = '11094836'
    AND DATE(Tsk.completed) < CURDATE() AND DATE(Tsk.completed) >= DATE_SUB(CURDATE
    (),INTERVAL 180 DAY) 
```

结果如下： 2012-08-22 14:18:14

期望结果：2012-08-22 16:18:14

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T16:48:37.603

您的标签说 mySQL，在您的选择中使用[subtime(exp1,exp2)](https://dev.mysql.com/doc/refman/5.6/en/date-and-time-functions.html#function_subtime)函数应该可以解决问题。`SUBTIME(Tsk.completed, '02:00:00.000000')`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T16:57:19.200

```
select Tsk.completed+interval 2 hour,Tsk.assgn_acct_id,name 
FROM tdstelecom.tasks As Tsk
WHERE Tsk.task_id = '11094836'
AND DATE(Tsk.completed) < CURDATE() AND DATE(Tsk.completed) >= DATE_SUB(CURDATE
(),INTERVAL 180 DAY) 
```

# language-agnostic - 依赖注入——在类中创建实例是个好主意吗？

> ID：13497906
> 
> 赞同：1
> 
> 时间：2012-11-21T16:41:22.030
> 
> 标签：language-agnostic, dependency-injection

自从我了解了依赖注入以来，我很难决定是否应该在类中注入或创建某些东西。

考虑以下不使用 DI 的示例：

```
class Car
{
    private Wheels _wheels;
    private Chasis _chasis;
    private Fuel _fuel;

    public Car()
    {
        _wheels = new Wheels();
        _chasis = new Chasis();
        _fuel = new Fuel();
    }

    public ExhaustGas Exhaust
    {
        get
        {
            return new ExhaustGas();
        }
    }
} 
```

您会注入哪些在 Car 内部创建的实例？如果是这样，你如何决定？

这是我的推理：

*   **燃料**- 由于燃料是从外部来源获得的，我肯定可以看到燃料发生变化的原因，我会向它添加抽象（IFuel）并注入它。
*   **车轮**- 尽管车轮是汽车的一部分，但您当然可以轻松更换车轮。所以我说它也应该注入。
*   **底盘**- 这个需要更多的思考。底盘是汽车非常重要的一部分，因此将其作为外部依赖项似乎有点奇怪。但是，您当然可以单独在底盘上运行测试，并且可以使用假人对汽车进行测试（尽管我不确定是否应该这样做）。应该注入对象的这样一个重要部分吗？
*   **ExhaustGas** - 这个更难。我可以注入一个按需创建 IExhaustGas 的工厂，但我不确定是否应该这样做。我不应该将这个实例作为工厂注入，因为它是按需创建的吗？如果不是，在这种情况下我的推理应该是什么？

我很想听听您对我在这里介绍的变量的看法，以及关于您如何决定何时注入以及何时不注入的更通用的推理。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T16:49:09.867

根据经验，应该注入*所有外部依赖项。*原因很简单：您希望能够*模拟*依赖项以进行测试，并在必要时灵活地替换它们。

为了处理注入所有东西的复杂性，有几种策略。如果您只想注入一些东西，请将其设为可选：

```
class Foo {

    private _bar
    private _baz

    public Foo(Bar bar = null, Baz baz = null) {
        if (!bar)  bar = new Bar;
        if (!baz)  baz = new Baz;

        _bar = bar
        _baz = baz
    }

} 
```

这仍然具有依赖注入的所有优点，同时避免了必要的实例化疯狂。

或者，使用类似 的工厂`CarDependencyFactory`，它可以在一个类中实例化所有必需的依赖项。也可以选择将其设为可选。

依赖注入容器/管理器/框架也可以提供帮助。最重要的是，您应该注入*所有内容*，除非您真的确定永远不需要替换依赖项，并且可以将一段代码*耦合*到另一段代码。

另请参阅[如何不使用静力学破坏您的可测试性](http://kunststube.net/static/)。

# php - 如何使用 jQuery 更新具有多个变量的输入框或标签

> ID：13497908
> 
> 赞同：0
> 
> 时间：2012-11-21T16:41:25.540
> 
> 标签：php, javascript, jquery, html, css

我正在尝试学习 jQuery，并且有一个问题对于已经熟悉它的人来说可能非常简单。

应用程序：将 PHP 与 jQuery 和 Bootstrap 切换按钮 (http://www.larentis.eu/bootstrap_toggle_buttons/) 结合使用，根据用户“打开”的切换按钮创建动态链接地址。

现在我正在使用表单发布切换按钮状态，一旦页面重新加载它然后拉出这些 POST 变量并将它们附加到链接。

我想做的是让jQuery在用户切换按钮时自动更改页面上的链接，而不必使用表单发布。

每次切换切换按钮时，我想做的是用外行术语解释：

```
$link = "http://www.mydomain.com/students.php?view="

if jQuery toggle-button-1 = on then add "name"
if jQuery toggle-button-2 = on then add "id"
if jQuery toggle-button-3 = on then add "address"

// If toggle-button-1 and toggle-button-2 were on and toggle-button-3 was off
// then $views would equal
$views = "name,id"

// On the webpage it would then display

http://www.mydomain.com/students.php?view=name,id

// If the person toggled toggle-button-1 to off, the link would display:

http://www.mydomain.com/students.php?view=id 
```

我希望我已经对此进行了解释，以便您能够理解...我正在尝试做的事情真的很简单，我知道如何在 PHP 中做到这一点，但我觉得我一直在网上搜索应该是的东西简单，我似乎无法理解它。

如果有人可以帮助我或指出正确的方向，我将不胜感激！

谢谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T16:55:53.720

这是我在[jsFiddle上的示例](http://jsfiddle.net/mouse0270/chnyy/3/)

HMTL

```
<input type="checkbox" name="name" value="name" id="name" /> name<br />
<input type="checkbox" name="id" value="id" id="id" /> id<br />
<input type="checkbox" name="address" value="address" id="address" /> address<br />
Link: <input type="text" name="url" value="" id="url" /> 
```

JavaScript

```
$(function() {
    var link = "http://jsfiddle.net/mouse0270/chnyy/"
    $('input[type=checkbox]').change(function () {
        var viewItems = "";
        $('input[type=checkbox]:checked').each(function () {
            viewItems += ','+$(this).val();
        });
        $('#url').val(link+'?view='+viewItems.substring(1));                  
    });         
});​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T16:53:32.887

[http://jsfiddle.net/CvsbD/](http://jsfiddle.net/CvsbD/)

HTML

```
<input type="checkbox" class="items" id="one" data-view="name" />
<input type="checkbox" class="items" id="two" data-view="id" />
<input type="checkbox" class="items" id="three" data-view="address" />

<input type="text" id="output" /> 
```

JS

```
$("body").on('change', '.items', function(){
    // filter down to items that are checked
    var items = $('.items').filter(function(){
        return this.checked;
    });
    // map data values to an array
    items = items.map(function (){
        return $(this).data('view');
    }).get();

    // join the array with a comma separator 
    $("#output").val(items.join(','));
});​ 
```

请注意，将委托绑定到文档正文通常不是最好的方法。您需要使用复选框的更直接祖先，或者您可以将更改事件绑定到复选框本身。

这可以进一步简化（忘记`:checked`），如下所示：

```
$("body").on('change', '.items', function(){
    // filter down to items that are checked, and get their data-view value.
    var items = $('.items:checked').map(function(){
        return $(this).data('view');
    }).get();

    // join the array with a comma separator 
    $("#output").val(items.join(','));
});​ 
```

# c - 如何在 unix 中创建阻塞文件描述符？

> ID：13497911
> 
> 赞同：0
> 
> 时间：2012-11-21T16:41:38.630
> 
> 标签：c, file, unix, blocking

我想在 Unix 的 C 中创建阻塞和非阻塞文件。首先，阻塞：

```
fd = open("file.txt", O_CREAT | O_WRONLY | O_EXCL); 
```

那正确吗？我不应该添加一些模式选项，例如 0666 吗？

非阻塞文件怎么样？我对此一无所知。

我想实现类似：

1.  当我打开它写在里面，它打开写，就可以了；如果不是，它会阻塞。
2.  当我打开它阅读时，它打开阅读，没关系；如果不是，它会阻塞。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T18:05:23.253

文件描述符是阻塞的还是非阻塞的；文件不是。`open()`如果需要非阻塞文件描述符，请将 O_NBLOCK 添加到调用中的选项。

请注意，打开 FIFO 进行读取或写入将阻塞，除非有一个进程为其他操作打开了 FIFO，或者您指定了 O_NBLOCK。如果您打开它进行读写，则它`open()`是非阻塞的（将立即返回）；I/O 操作仍然由是否设置 O_NBLOCK 来控制。

更新的问题不清楚。但是，如果您正在寻找“对文件的独占访问权限”（以便其他人没有打开它），那么 O_EXCL 和 O_NBLOCK 都不是答案。O_EXCL 影响创建文件时发生的情况；如果文件已存在，则创建将失败。O_NBLOCK 影响`read()`当没有数据可供读取时操作是否会阻塞。如果您阅读 POSIX[`open()`](http://pubs.opengroup.org/onlinepubs/9699919799/functions/open.html)描述，那里没有任何内容允许您请求对文件的“独占访问”。

要回答有关文件模式的问题：如果包含 O_CREAT，则需要`open()`. 如果省略 O_CREAT，则不需要`open()`. 它是一个可变参数函数：

```
int open(const char *filename, int options, ...); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T16:47:25.930

> 我不应该添加一些模式选项吗？

如果文件是只写的并且如果不存在，则应该创建。在这种情况下，`open()`也需要第三个参数，因此省略它会导致未定义的行为。

**编辑：**

更新的问题更加令人困惑......

> 当我打开它写在里面，它打开写，就可以了；如果不是，它会阻塞。

你为什么需要那个？看，如果您尝试写入未打开用于写入的文件/文件描述符，`write()`将返回 -1，您可以检查存储在`errno`. 告诉我们你想要通过这个奇怪的事情来实现什么，而不是过度复杂化和弄乱你的代码。

（括号内备注：

> 我想创建阻塞和非阻塞文件

那是什么？

> 在 unix 的 C 中

再一次，没有这样的事情。有C 语言，它与平台无关。**）**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T16:47:50.063

我不知道你在调用什么阻塞文件（在 Unix 中阻塞 IO 意味着 IO 操作等待数据可用或确定失败，它们反对非阻塞 IO，如果没有则立即返回可用数据）。

*   使用 O_CREAT 打开时，您始终需要指定模式。

*   如果文件已经存在（针对上述问题进行了修复），您显示的打开将失败。

*   Unix 没有标准方法来锁定文件以进行独占访问，但除外。有咨询锁（但所有程序都必须遵守协议）。有些有强制锁扩展。公认的智慧是在访问网络文件系统时不要依赖任何一种锁定。

# ruby-on-rails - 仅显示属于用户的项目的问题

> ID：13497912
> 
> 赞同：1
> 
> 时间：2012-11-21T16:41:42.357
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord

所以我正在构建一个 Rails 应用程序，您可以在其中显示项目等等。我的项目控制器中有以下代码：

```
 def create
    @project = Project.create(params[:project].merge(:user_id => current_user.id))
    if @project.save
      redirect_to project_path(@project), :flash => {:success => 'We have created your project'}
    else
      redirect_to :back, :flash => {:error => 'Cannot allow an empty project name'}
    end
  end 
```

这将在我拥有的模型中创建一个项目，根据我所理解的基于用户 id 并与之相关的内容：

```
class Project < ActiveRecord::Base
  attr_accessible :project_title, :user_id

  has_many :categories, :order => 'position', :dependent => :destroy
  has_many :tasks, :dependent => :destroy
  has_many :discussions, :dependent => :destroy
  has_many :users

  belongs_to :user

  validates :project_title, :presence => true
end 
```

**更新：用户控制器显示操作为用户显示项目**

```
 def show
    @user = current_user

    @projects = current_user.projects.all
    @tasks = current_user.tasks.all
    @categories = current_user.categories.all
    @discussions = current_user.discussions.all
  end 
```

**更新以显示项目控制器索引操作 **

```
 def index
    @project  = Project.new
    @projects = Project.all
  end 
```

考虑到这一点，我想知道为什么我可以让用户 bob 创建一个项目，注销并且用户 jake 可以登录并查看用户 bob 项目...

我在创作上做错了吗？如果您需要，我可以显示更多代码，但我认为这将是最有用的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T17:04:54.113

似乎在您的`index`方法中`users_controller`，您正在获取所有创建的项目。如果您只想显示由 current_user 创建的项目，您应该只获取这些记录。

即应该是

```
 @projects = current_user.projects 
```

而你现在拥有的是（可能是）

```
 @projects = Projects.all 
```

同样在你上面的 show 方法中做 current_user.projects`.all`没有任何意义。

`current_user.projects`将获取您需要的记录。

# javascript - ASP.NET 中的 OnClientClick 事件

> ID：13497916
> 
> 赞同：0
> 
> 时间：2012-11-21T16:41:56.280
> 
> 标签：javascript, asp.net, dom-events, client-side

我正在使用 ASP.NET 将值传递给 JavaScript 函数，并且由于某种原因我无法确定，当我尝试从另一个控件传递值时它不起作用。相反，它就像存在语法错误一样，只是提交回主表单。

有谁知道为什么？

例子：

```
<asp:TextBox ID="txtToSay" runat="server" Text="Something"></asp:TextBox>

<asp:Button runat="server" ID="btnSaySomething1" Text="Say Something"
OnClientClick="saySomething(<%=txtToSay.Text%>);"  /> <!-- doesn't work -->

<asp:Button runat="server" ID="btnSaySomething1" Text="Say Something"
OnClientClick="saySomething('<%=txtToSay.Text%>');"  /> <!-- doesn't work -->

<asp:Button runat="server" ID="btnSaySomething2" Text="Say Something"
OnClientClick="saySomething('Something');"  /> <!-- works -->

<script type="text/javascript">
    function saySomething(txt){
        alert(txt);
    };
</script> 
```

附加信息：

在 .NET 4.0 上运行的 Web 应用程序语言：C#

更新：

在处理了一段时间后，我确定您不能`<%%>`在 ASP 控件中使用标记。此外，如果您正在寻找控制值的动态评估 AVOID AVOID AVOID using`<%=someControl.Text%>`或类似的构造，因为它们仅在将请求提交到服务器后才被评估。如果您在运行时需要来自另一个控件的静态值，只需在页面加载事件中设置该值或在后面的代码中以另一种方式处理它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T16:43:14.743

`Javacript will search for variable name = txtToSay.Text`在 saySomething 函数调用中，将引号括起来使其成为字符串值

改变

```
OnClientClick="saySomething(<%=txtToSay.Text%>);" 
```

至

```
OnClientClick="saySomething('<%=txtToSay.Text%>');" 
```

您可以不通过这种方式获得 txtToSay.Text

```
<script type="text/javascript">
    function saySomething(txt){
        alert(document.getElementById('<%=txtToSay.Text%>').value);
    };
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T16:42:56.073

您需要`'`在`saySomething()`通话中添加文字。

像这样：

```
 <asp:Button runat="server" ID="btnSaySomething1" Text="Say Something" OnClientClick="saySomething('<%=txtToSay.Text%>');"  /> 
```

**更新**

`<%= %>`不能在 asp.net 控件中工作。您可以从代码隐藏中设置它吗？

IE

```
btnSaySomething1.OnClientClick = "Text to say" 
```

# php - jQuery恢复值

> ID：13497923
> 
> 赞同：-1
> 
> 时间：2012-11-21T16:41:30.833
> 
> 标签：php, jquery, load

我使用 jQuery 的加载函数来调用 PHP 文件并获得响应，例如在 PHP 端我得到值“一”。

如何将此值发送到 jQuery？

**jQuery函数加载调用文件：**

```
$(document).ready(function(){

$("#file_content").load("index.php?action=ok");

}); 
```

jQuery 脚本调用 index.php 并使用**action=ok**来激活 PHP 函数，例如获取值（在 PHP 一侧）“start”，这个值得到我想将其他时间发送到我的 jQuery 函数并显示值“开始” - 直到进入 jQuery 函数。

如果显示值“开始”，则 jQuery 函数有效，如果没有获取此值（开始），则 jQuery 函数不起作用，对我来说问题是这个值在 PHP 中，我不知道如何检测工作进入 jQuery。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T16:44:58.533

$.load 有一个回调函数。

尝试这个：

```
$(document).ready(function(){

$("#file_content").load("index.php?action=ok", function(data){
    if(data == "start"){
        //your code
    } else {
        //if the response from php is not "start";
    }
});

}); 
```

# .net - 如何以编程方式打开 .net 2.0。它是否正确？

> ID：13497924
> 
> 赞同：3
> 
> 时间：2012-11-21T16:41:33.907
> 
> 标签：.net, windows-8, installation

我正在尝试以编程方式打开（安装） .Net 2.0 Framework *Windows 功能*。（B/c Windows 7 及更高版本不允许您手动安装 .net，我的客户永远无法从控制面板启用它。）。Windows 7 包含 .net 2.0，但 Windows 8 不包含（至少在我的测试中）

我认为答案是：

```
dism.exe /online /enable-feature /featurename:NetFX3 
```

基于[包括这个在内的许多帖子。](http://www.west-wind.com/weblog/posts/2012/Aug/27/NET-35-Installation-Problems-in-Windows-8)

1.  安装 .net 3.0 框架的 [最] 正确方法是什么？
2.  有没有办法只安装*.net* 2.0**框架**？

我尝试过的；

*   使用 dism.exe 的 /get 功能来获取它可以打开的所有功能。列出的唯一 .net 是 netfx3

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T09:43:26.250

您还可以直接触发[Windows Features on Demand User Experience](http://technet.microsoft.com/en-us/library/jj571719.aspx)小程序，而无需启动 .Net 可执行文件或安装程序。仅 Windows 8 支持此功能（[根据此图表](http://pcsupport.about.com/od/commandlinereference/a/command-availability.htm)）

```
fondue.exe /enable-feature:NetFx3 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T16:50:42.790

[简短的回答：管理 .net 框架的安装，调用 .Net 框架安装引导程序](http://msdn.microsoft.com/en-us/library/5a4x27ek.aspx#web_bootstrapper_packages)并完成它不是您作为 ISV 的工作。系统管理员可能希望以不同的方式部署软件，确保您不会通过做出假设来限制自己。

长答案：使用[部署指南](http://msdn.microsoft.com/en-us/library/6hbb4k3e.aspx)来确定如何使用 .net 框架打包您的应用程序。

* * *

关于 DISM 的更新：

我并不是说 DISM 会消失，只是对 DISM 的引用被替换为对 powershell 的引用，并且 DISM 是一个纯粹的管理工具。例如，比较有关Windows Server 2012[的 Windows 功能安装的 MSDN 文档，其中突出显示了](http://technet.microsoft.com/en-us/library/hh831809.aspx)[Install-WindowsFeature](http://technet.microsoft.com/en-us/library/jj205467.aspx)用于功能的管理安装，并且仅简要提及 DISM 到2008 R2[的等效文档](http://technet.microsoft.com/en-us/library/ee441253%28v=ws.10%29.aspx)。

但是，我坚持认为，添加和删除角色和功能等操作不应作为应用程序安装的结果而静默执行。根据[部署指南](http://msdn.microsoft.com/en-us/library/6hbb4k3e.aspx)，链接 .Net 框架的推荐安装方法是调用引导程序并将其余部分留给它。有关确切的论点，请参见[此处](http://msdn.microsoft.com/en-us/library/cc160716.aspx)。

引导程序（通常会在较低版本的 Windows 中安装 .net 框架）被填充并替换为下面列出的对话框 - 只要没有其他部署问题（媒体、权限、组策略等...）该功能已安装，每个人都很高兴。如果存在部署问题，用户将被定向到服务器管理工​​具，可以在其中手动启用它。

![打开或关闭 Windows 功能](../Images/3fb26287f94be503959b6b9ab8885134.png)

除了 .Net Framework 安装的[正式指南](http://msdn.microsoft.com/en-us/library/6hbb4k3e.aspx)之外，按需安装在以下文档中被引用为维护兼容性的首选方法：

*   [.Net 4.5（幻灯片 8）中的新功能](http://download.microsoft.com/download/6/4/0/640BF4BD-D92A-4592-958F-1BB90C8D07A4/TD11BE52.pptx)
    “首选：您的设置尝试安装 3.5 MSI ... shim 安装正确的版本...”
*   [Windows 8 和 .Net Framework 3.5](http://blogs.technet.com/b/askcore/archive/2012/05/14/windows-8-and-net-framework-3-5.aspx)
    “您尝试使用可从 Microsoft 下载的可再发行程序包安装 .Net 2.0、3.0 或 3.5...Windows 8 中的应用程序 shim 拦截该尝试并调用新 .Net 的安装3.5 功能。一旦触发，安装应该像从 UI、DISM 或 Powershell 启动一样继续进行。
*   [在 Windows 8 上安装 .NET Framework 3.5](http://msdn.microsoft.com/en-us/library/hh506443%28v=VS.110%29.aspx)
    “要在 Windows 8 上运行需要 .NET Framework 3.5 的应用程序，您必须在您的计算机上启用 3.5 版本。您可以通过两种方式执行此操作：安装或运行需要.NET Framework 3.5（即通过按需安装 .NET Framework 3.5），或通过在控制面板中启用 .NET Framework 3.5。”

# sql-server - 在代码中表示为枚举的查找表

> ID：13497930
> 
> 赞同：1
> 
> 时间：2012-11-21T16:42:59.457
> 
> 标签：sql-server, entity-framework, enums

我在数据库 (SQL) 上有一些查找表，这些查找表是为了参照完整性而存在的。这些相同的表在代码中使用枚举表示，因为它周围有业务逻辑。当本地化成为问题时，会向每个实体添加一个本地化表（包含可本地化的字段）。现在正在翻译枚举（通过资源文件），但每个查找表也存在一个本地化表。

我希望得到一些关于如何建模这个枚举/查找表关系的建议，记住（实体框架5）“查找表”现在有关联的子表，但目的是仍然保留枚举编码..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2020-11-19T20:01:10.127

[房屋清洁工作] 从那以后我处理这个问题的方式一直是

如果枚举不驱动任何业务决策，我通常没有枚举。

如果它是一个驱动某种业务决策的枚举，我通常将其设为标志枚举，并且数据库条目将包含标志枚举值。通常有一个实际的查找表，其中这些值与标签配对，有时还有额外的元数据。

然后，我将使用某种缓存机制预先（或延迟）加载这些查找表，以便将所述枚举转换为 UI 中的适当标签。

当我有某种元数据时，我要么创建一个包含与枚举相关联的所有数据的类，要么创建一个静态类，其中包含负责提取所述元数据的枚举的扩展方法。

前任：

枚举数字 { 一、二、三 }

Number.One.GetLabel(); Number.One.IsEven()

可能会保留一个静态字段，在第一次检索后缓存该信息。

# java - JBOSS 不是从 cmd 开始的

> ID：13497932
> 
> 赞同：0
> 
> 时间：2012-11-21T16:42:03.563
> 
> 标签：java, jboss, cmd

我在我的 Windows 7 机器上安装了 JBOSS。我可以从 Eclipse 启动 JBOSS，但它没有发布，当我尝试从 Bin 目录运行 Standalone.bat 文件时，它会抛出此错误，

```
 JAVA_OPTS: -client -Dprogram.name=standalone.bat **-Xms1303M -Xmx1303M** -XX:MaxPe
rmSize=256M -Dsun.rmi.dgc.client.gcInterval=3600000 -Dsun.rmi.dgc.server.gcInter
val=3600000 -Djava.net.preferIPv4Stack=true -Dorg.jboss.resolver.warning=true -D
jboss.modules.system.pkgs=org.jboss.byteman -Djboss.server.default.config=standa
lone.xml

**Error occurred during initialization of VM**
Could not reserve enough space for object heap
Error: Could not create the Java Virtual Machine. 
```

我确实研究了论坛，许多人建议将 -Xms1303M 更改为 -Xms256M 。我在编辑器中编辑了standalone.conf 文件，但它没有得到反映并再次出现相同的错误。

有人可以指导我吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-21T23:57:33.203

最有可能的是，您在 32 位 jdk 上使用或运行 jboss，并且内存参数超出范围或超出 32 位 jdk 的限制。升级到 64 位 jdk 或将此行添加到 jboss/bin 的 run.conf 中，从命令行中删除 jvm args 并查看 jboss 是否启动。

设置“JAVA_OPTS=-Xms128M -Xmx512M -XX:MaxPermSize=256M”

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-22T00:09:07.493

在 Windows 中，必须使用新`JAVA_OPTS`环境变量修改的是standalone.bat 文件而不是standalone.conf 文件。

# python - scapy接收等待2个数据包

> ID：13497933
> 
> 赞同：0
> 
> 时间：2012-11-21T16:43:06.693
> 
> 标签：python, http, get, scapy, qos

我正在尝试使用 scapy 执行 http QoS。对于扫描仪，我需要获取连接时间、我的 GET 之间的时间、发送数据的开始（来自服务器的 ACK）和最后：数据的结束。

我写的是：

```
 port=RandNum(1024,65535)
    HOST=a[0][0][1][DNS].an.rdata
    syn = IP(dst=HOST) / TCP(sport=port, dport=80, flags='S', seq=42)
    syn_ack = sr(syn, verbose=0)
    t1 = (syn_ack[0][0][1].time - syn_ack[0][0][0].sent_time)*1000

    getStr = "GET / HTTP/1.1\n\n"
    filt = "tcp and host {ip}".format(ip=HOST)
    request = IP(dst=HOST) / TCP(sport=syn_ack[0][0][1][TCP].dport, dport=80, flags='A', seq=syn_ack[0][0][1][TCP].ack, ack=syn_ack[0][0][1][TCP].seq + 1) / getStr
    reply = sr(request, verbose=0)
    http_fin = sniff(filter=filt, count=1)
    t2 = (reply[0][0][1].time  - reply[0][0][0].sent_time)*1000
    t3 = (http_fin[0].time - reply[0][0][1].time)*1000

    fin_ack = IP(dst=HOST) / TCP(flags="FA", ack=http_fin[0][TCP].seq+1, seq=http_fin[0][TCP].ack, sport=http_fin[0][TCP].dport, dport=http_fin[0][TCP].sport)
    send(fin_ack, verbose=0) 
```

在wireshark中，我可以在我的GET之后看到一个ACK数据包（由“reply = sr（request，verbose = 0）”捕获）和一个必须是响应结束的HTTP数据包（如HTTP /1.0 200 OK）之后。

我的问题是，有时，这个 HTTP 数据包在解释嗅探行之前出现（http_fin = sniff(filter="tcp and host 88.191.132.65", count=1)，所以这些命令什么都没有等待。

我想也许我可以用 sr 命令捕获 2 个数据包，但我不确定。有人看到另一种方式吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-10T23:21:43.023

you can specify `multi=1` when calling `sr()` to receive multiple 'answers' the *same* sent packet. but looks like you need to specify a `timeout=` as well.

# c++ - 提升没有 base_object 的序列化基类

> ID：13497938
> 
> 赞同：0
> 
> 时间：2012-11-21T16:42:12.517
> 
> 标签：c++, memory, serialization, boost, boost-serialization

我正在使用带有增强序列化的多重继承。而不是做

```
boost::serialization::base_object< Connection<T> >(*this)
boost::serialization::base_object< Collection<C> >(*this) 
```

我在做

```
template<typename ArchiveT>
void save(ArchiveT& arc, const unsigned version) const{
  //both Connection<T> and Collection<C> are Base Classes
  Connection<T>::save(arc, version);
  Collection<C>::save(arc, version);
} 
```

及其工作。那么他们两个是一样的吗？或者这样做有什么害处？我应该更改此代码吗？

{这东西是很久以前编码的。所以我忘记了为什么我用这种方式编码。可能我当时不知道`base_object`}

我正在序列化大量数据（~1.6 GB）。当我序列化时，我看到序列化过程占用了大量内存并达到 3GB 的障碍。我试过评论序列化代码，它需要 < 50MB 内存。那么是什么让序列化占用了这么大的内存呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T11:36:19.203

您应该更改代码并通过`base_object<>()`.

从[文档](http://www.boost.org/doc/libs/1_52_0/libs/serialization/doc/serialization.html#base)中：

> [...] 请注意，这与调用基类的序列化函数不同。这似乎可行，但会绕过用于跟踪对象的某些代码，以及注册基派生关系和序列化系统按设计运行所需的其他簿记。因此，所有序列化成员函数都应该是私有的。

额外的内存消耗可能是由[对象跟踪](http://www.boost.org/doc/libs/1_52_0/libs/serialization/doc/traits.html#tracking)引起的。如果您要跟踪大量对象，则在序列化期间内存消耗会急剧增加。

从[特殊考虑](http://www.boost.org/doc/libs/1_52_0/libs/serialization/doc/special.html#objecttracking)：

> 如果事先知道没有重复的指针值，则可以通过适当地设置对象跟踪类序列化特征来消除与对象跟踪相关的开销。

如果您不需要对象跟踪，您可以通过以下方式禁用它：

```
BOOST_CLASS_TRACKING(the_class, boost::serialization::track_never) 
```

# algorithm - 完成稀疏矩阵数据的机器学习算法

> ID：13497945
> 
> 赞同：7
> 
> 时间：2012-11-21T16:42:26.977
> 
> 标签：algorithm, machine-learning, data-mining

我在这里看到了一些机器学习问题，所以我想我会发布一个相关问题：

假设我有一个数据集，其中运动员参加 10 公里和 20 公里的丘陵路线跑步比赛，即每场比赛都有自己的难度。

对于每场比赛，用户的完成时间几乎呈逆正态分布。

可以将这个问题写成矩阵：

```
 Comp1 Comp2 Comp3
User1  20min  ??   10min

User2  25min 20min 12min

User3  30min 25min ??

User4  30min ??    ?? 
```

我想完成上面的矩阵，其大小为 1000x20，稀疏度为 8%（！）。

应该有一个非常简单的方法来完成这个矩阵，因为我可以计算每个用户的参数（能力）和每个比赛的参数（mu，分布的 lambda）。而且比赛之间的相关性非常高。

我可以利用排名 User1 < User2 < User3 和 Item3 << Item2 < Item1

您能否给我一个提示，我可以使用哪些方法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-25T00:00:22.377

您对这是一个矩阵完成问题的敏锐观察使您获得了解决方案的大部分方法。我将你的直觉编码为用户的能力和课程难度的组合产生了比赛的时间，然后介绍了各种算法。

# 模型

让向量 u 表示用户的速度，因此 u_i 是用户 i 的速度。让向量 v 表示课程的难度，因此 v_j 是课程 j 的难度。同样，如果可用，设 t_ij 是用户 i 在课程 j 上的时间，并定义 y_ij = 1/t_ij，用户 i 在课程 j 上的速度。

既然你说时间是逆高斯分布的，那么观察的合理模型是

y_ij = u_i * v_j + e_ij，

其中 e_ij 是一个零均值高斯随机变量。

为了拟合这个模型，我们搜索向量 u 和 v 以最小化观察到的速度中的预测误差：

f(u,v) = sum_ij (u_i * v_j - y_ij)^2

# 算法一：缺失值奇异值分解

这是经典的[赫布算法](http://en.wikipedia.org/wiki/Generalized_Hebbian_Algorithm)。它通过梯度下降最小化上述成本函数。f wrt 到 u 和 v 的梯度是

```
df/du_i = sum_j (u_i * v_j - y_ij) v_j
df/dv_j = sum_i (u_i * v_j - y_ij) u_i 
```

将这些梯度插入共轭梯度求解器或 BFGS 优化器，如 MATLAB`fmin_unc`或 scipy`optimize.fmin_ncg`或 `optimize.fmin_bfgs`. 除非您愿意实现一个非常好的线搜索算法，否则不要滚动您自己的梯度下降。

# 算法 2：带有迹范数惩罚的矩阵分解

最近，针对这个问题提出了简单的凸松弛。由此产生的算法编码起来也很简单，而且看起来效果很好。例如，查看[非均匀世界中的协作过滤：使用加权跟踪范数学习](http://ttic.uchicago.edu/~nati/Publications/WTrNormNIPS2010.pdf)。这些方法最小化 f(m) = sum_ij (m_ij - y_ij)^2 + ||m||_*，这里`||.||_*`是矩阵 m 的所谓核范数。实现最终将再次计算关于 u 和 v 的梯度并依赖于非线性优化器。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-21T19:58:24.650

有几种方法可以做到这一点，也许首先尝试的最佳架构如下：

（像往常一样，作为预处理步骤，尽可能将您的数据标准化为具有 0 均值和 1 标准偏差的统一函数。您可以通过将函数拟合到所有比赛结果的分布，应用其逆，然后减去均值除以标准差。）

选择一个超参数 N（您可以像往常一样使用交叉验证集对其进行调整）。

为每个参与者和每个种族创建一个 N 维特征向量，最初是随机的。因此，如果有 R 个种族和 P 个参与者，那么就有 R+P 个特征向量，总共有 N(R+P) 个参数。

给定参与者和给定种族的预测是两个对应特征向量的函数（作为第一次尝试使用这两个向量的标量积）。

在逐步改进参与者特征向量和竞赛特征向量之间交替。

要改进特征向量，请对已知数据元素（您有结果的参与者/种族对）使用梯度下降（或更复杂的优化方法）。

那就是你的损失函数是：

```
total_error = 0

forall i,j
    if (Participant i participated in Race j)
        actual = ActualRaceResult(i,j)
        predicted = ScalarProduct(ParticipantFeatures_i, RaceFeatures_j)
        total_error += (actual - predicted)^2 
```

因此，根据特征向量计算该函数的偏导数，并按照通常的 ML 算法逐步调整它们。

（您还应该在损失函数中包含一个正则化项，例如特征向量长度的平方）

如果您对这个架构很清楚，或者您需要进一步阐述，请告诉我。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-21T19:24:57.630

我认为这是丢失数据恢复的经典任务。存在一些不同的方法。我可以建议的其中之一是基于[自组织特征图](http://en.wikipedia.org/wiki/Self-organizing_map)（Kohonen's Map）。

下面假设每个运动员的记录是一个*模式*，每个比赛数据是一个*特征*。

基本上，您应该将数据分为两组：第一组 - 具有完全定义的模式，第二组 - 具有部分丢失特征的模式。我认为这是符合条件的，因为稀疏度为 8%，也就是说，您有足够的数据 (92%) 来训练未损坏记录的网络。

然后，您将第一个集合提供给 SOM 并在此数据上对其进行训练。在此过程中，将使用所有功能。我不会在这里复制算法，因为它可以在许多公共资源中找到，甚至一些实现是可用的。

训练网络后，您可以将第二组中的模式输入网络。对于每个模式，网络应仅基于当前模式中存在的那些特征计算*最佳匹配单元(BMU)。*然后你可以从 BMU 中获取它的权重，对应于缺失的特征。

作为替代方案，您不能将整个数据分成两组，而是在所有模式上训练网络，包括缺少特征的模式。但是对于这样的模式，学习过程应该以类似的方式改变，即 BMU 应该只根据每个模式中的现有特征来计算。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-25T05:32:36.843

我想你可以看看最近的低秩矩阵完成方法。假设与矩阵维度相比，您的矩阵的秩较低。

```
min rank(M)
s.t. ||P(M-M')||_F=0 
```

M 是最终结果，M' 是您当前拥有的未完成矩阵。该算法最小化矩阵 M 的秩。约束中的 P 是一个运算符，它采用矩阵 M' 的已知项，并将 M 中的这些项约束为与 M' 中的相同。

这个问题的优化有一个宽松的版本，就是：

```
min ||M||_* + \lambda*||P(M-M')||_F 
```

rank(M) 放松到它的凸包 ||M||_* 然后你通过控制参数 lambda 来权衡这两个项。

# android - SlidingDrawers 列表的替代方案

> ID：13497948
> 
> 赞同：0
> 
> 时间：2012-11-21T16:43:32.107
> 
> 标签：android, android-layout, slidingdrawer

您好我正在开发一个需要显示项目列表的应用程序。单击（或点击）项目应在项目正下方显示项目的描述文本。我说的是垂直[手风琴之](http://jquery.bassistance.de/accordion/demo/?p=1.1.3 "手风琴示例")类的东西。

我希望它们动态创建（用代码而不是 XML 创建）。那部分轻松完成。我*在 LinearLayout 中膨胀了多个 SlidingDrawer*来完成它。

但问题是活动中只显示了一个 SlidingDrawer。这是通过为 SlidingDrawer 提供固定高度来实现的。正如我上面提到的那样，这种方法不适用，即动态生成项目列表，并且项目描述必须出现的活动区域保持空白。

我现在正在寻找实现这一目标的替代观点。因为我是 Android 开发的初学者，所以我找不到任何适用于 android 2.3 及更高版本的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T16:50:39.660

您可以随时查看 SlidingMenu。该项目可以在[GitHub](https://github.com/jfeinstein10/SlidingMenu)上找到。我想你需要稍微修改一下行为。

# c++ - 子类化 QList 和 operator+ 重载

> ID：13497949
> 
> 赞同：0
> 
> 时间：2012-11-21T16:42:34.527
> 
> 标签：c++, qt

我希望能够添加两个 QList 对象。例如：

```
QList<int> b;
b.append(10);
b.append(20);
b.append(30);

QList<int> c;
c.append(1);
c.append(2);
c.append(3);

QList<int> d;
d = b + c; 
```

出于这个原因，我决定继承 QList 并重载 operator+。

这是我的代码：

```
class List : public QList<int>
{
public:
    List() : QList<int>() {}

    // Add QList + QList
    friend List operator+(const List& a1, const List& a2);
};

List operator+(const List& a1, const List& a2)
{
    List myList;

    myList.append(a1[0] + a2[0]);
    myList.append(a1[1] + a2[1]);
    myList.append(a1[2] + a2[2]);

    return myList;
}

int main(int argc, char *argv[])
{
    QCoreApplication a(argc, argv);

    List b;
    b.append(10);
    b.append(20);
    b.append(30);

    List c;
    c.append(1);
    c.append(2);
    c.append(3);

    List d;
    d = b + c;

    List::iterator i;
    for(i = d.begin(); i != d.end(); ++i)
        qDebug() << *i;

    return a.exec();
} 
```

，结果是正确的，但我不确定这是否是一个好方法。请问有没有更好的解决办法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T16:57:23.093

我不建议为此重载`+`运算符，因为`QList`已经使用此运算符将两个列表连接在一起。考虑创建一个具有不同名称的成员函数来完成您正在尝试做的事情。

**编辑** 正如另一个答案所提到的，将此功能放在数据结构的派生类上有点不寻常，尽管从数据结构派生*本身*并不是坏事。

在这种情况下，容纳任何大小的列表的非成员、非朋友函数可能是更合适的方法：

```
QList<int> addListValuesTogether(const QList<int>& a1, const QList<int>& a2)
{
   QList<int> resultingList;
   Q_ASSERT(a1.size() == a2.size());

   for (int i=0; i<a1.size(); i++)
   {
      resultingList.append(a1[i] + a2[i]);
   }

   return resultingList;
} 
```

您可以更进一步，使上述函数通用（例如，如果您希望包含`double`值的列表具有相同的功能）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T17:03:26.880

这是一种奇怪的方法。最好使用具有明确名称的单独函数。您正在为 QList 重新定义 operator+ 的既定语义，并且子类化容器也不是很好的设计。查看您的代码，您可能希望使用不将列表与数学矢量语义混合的自定义 3D 矢量类。

除此之外，您的 operator+ 实现中还有两个问题：

*   您没有处理列表 a1/a2 的元素少于三个（关键的、未定义的行为/崩溃）的情况，并且您忽略了索引 2 之外的任何内容。
*   此外，当您分配给 myList 时，它仍然是空的，因此 myList[0] 等无效。您需要先 myList.resize(3)，或者使用 append()/push_back() 而不是 operator[]。

# java - 带有 java.io.NotSerializableException 的 HtmlInputHidden

> ID：13497954
> 
> 赞同：1
> 
> 时间：2012-11-21T16:42:47.540
> 
> 标签：java, jsf-2, serializable

我在我的 JSF 应用程序中将上下文参数`javax.faces.STATE_SAVING_METHOD`从`server`更改为`client`，但现在我得到：

```
java.io.NotSerializableException: javax.faces.component.html.HtmlInputHidden 
```

这会破坏视图渲染。

就像`HtmlInputHidden`来自第三方 jar 一样，我自己无法实现它。

有没有办法解决这样的问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T17:44:37.823

Solved with `transient` keyword in `HtmlInputHidden` declaration:

```
private transient HtmlInputHidden htmlInputHidden; 
```

As @millimoose said, `saveSate()` method controls the state; not the serialization.

# spotify - iPhone 上的 Spotify 曲目集链接

> ID：13497961
> 
> 赞同：0
> 
> 时间：2012-11-21T16:44:11.123
> 
> 标签：spotify

[正如https://stackoverflow.com/a/12218041/51034](https://stackoverflow.com/a/12218041/51034)中所建议的，我已经整理了一个 Web 应用程序，该应用程序创建了一个可以使用`spotify:trackset`链接在 Spotify 中播放的曲目列表。

在我的 iPhone 上点击链接时，它会切换到 Spotify 应用程序，但随后我收到一条错误消息，声称它无法在设备上打开此类链接。

有没有其他方法可以链接到移动设备上的一组曲目？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T18:34:33.790

Spotify iOS 客户端目前不支持曲目集——将曲目列表输入客户端的唯一方法是通过播放列表。

# bluetooth - 蓝牙 spp 嗅探器

> ID：13497965
> 
> 赞同：1
> 
> 时间：2012-11-21T16:43:32.983
> 
> 标签：bluetooth, sniffer, spp

我正在寻找一种工具，最好是在 Windows 中，它可以让我看到通过 SPP 进出蓝牙设备的字节流。这类似于可用于 COM 和 LPT 端口的串行端口监视器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-11T05:59:51.810

由于在 8 个月内没有人回答您的问题，我也在寻找相同的答案。这是许多人正在寻找的答案：有一个名为 wireshark 的工具可以解决问题。查看它可以过滤掉的所有协议[http://www.wireshark.org/docs/dfref/](http://www.wireshark.org/docs/dfref/) 请参阅：蓝牙 SPP 数据包，协议字段名称：btspp。

如您所见，它可以解决问题，但您必须先学习wireshark。毕竟不是所有的孩子都在玩:-)

Afaik：Wireshark 可以免费使用。提供 32 位和 64 位的 Windows 和 Mac 版本。Linux版本我不知道。

# regex - Textmate 正则表达式 简单查找/替换

> ID：13497966
> 
> 赞同：0
> 
> 时间：2012-11-21T16:44:34.727
> 
> 标签：regex, textmate, oniguruma

我正在尝试做一个简单的查找和替换。我有：

```
 <?php $url = 'http://www.mywebsite.net/this-is-a-page.php'; ?> 
```

作为每个页面上的变量，我将其替换为：

```
 <?php $url = curPageURL(); ?> 
```

我的 find 设置如下：

```
 <?php $url =( .*); ?> 
```

但这显然是不正确的，因为当我点击查找时它不会返回任何结果。任何帮助将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T16:48:29.163

您需要转义一些字符。

试试这个 `<\?php \$url =( .*); \?>`

*   `?`表示前一个字符的 0 或 1。
*   `$`表示行尾。

转义它们会将它们更改为文字匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T16:55:26.760

您将捕获组放在要替换的位上，而不是要保留的位上。我认为你需要这样的东西：

```
(<\?php \$url =)[^\?]+(\?>) 
```

然后将其替换为

```
\1 curPageURL();\2 
```

不确定 TextMate 是否`\1`用作参考或`$1`

# javascript - CKFinder 弹出 onbeforeunload javascript

> ID：13497967
> 
> 赞同：1
> 
> 时间：2012-11-21T16:43:37.070
> 
> 标签：javascript, popup, ckfinder

我目前正在使用 CKFinder 将图像上传到网络应用程序（等等）。现在的问题是，当窗口关闭时没有回调：我的意思是类似于javascript“onbeforeunload”事件。popup函数只返回api，api只包含文档，不包含窗口。

我查看了文档并找到了“selectActionFunction”，但没有“cancelActionFunction”或类似内容的迹象。

[http://docs.cksource.com/ckfinder_2.x_api/symbols/CKFinder.config.html](http://docs.cksource.com/ckfinder_2.x_api/symbols/CKFinder.config.html)

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T09:45:28.920

好的，最后我并没有在 ckfinder 中找到解决方案，但是由于我已经在使用 jquery ui，所以我只是在 ui 对话框中打开了 ckFinder。这使我能够向关闭按钮添加回调。

也许可以通过皮肤添加取消回调，但我选择了ui对话框的快捷方式。（我倾向于做的唯一皮肤是在 CSS 中，大多数时候这已经足够了）

无论如何，我希望这对其他人也有帮助。

# logging - 如何读取 msi 日志

> ID：13497969
> 
> 赞同：2
> 
> 时间：2012-11-21T16:43:40.250
> 
> 标签：logging, windows-installer

我尝试解决安装问题，因为它最近失败了。我的安装日志文件中有以下部分，但不知道如何阅读/解释它。任何人都可以指出文档或资源吗？多谢！

```
MSI (s) (78:A8) [21:14:26:012]: Doing action: viewer.exe
Action start 21:14:26: viewer.exe.
MSI (s) (78:A8) [21:14:26:012]: Note: 1: 2262 2: CustomAction 3: -2147287038 
MSI (s) (78:A8) [21:14:26:022]: Transforming table CustomAction.

MSI (s) (78:A8) [21:14:26:022]: Note: 1: 2262 2: Binary 3: -2147287038 
MSI (s) (78:A8) [21:14:26:022]: Transforming table Binary.

Action ended 21:14:56: viewer.exe. Return value 1. 
```

编辑我找到了一个链接，它告诉如何解释 msi 日志 [http://blogs.technet.com/b/richard_macdonald/archive/2007/04/02/how-to-interpret-windows-installer-logs.aspx](http://blogs.technet.com/b/richard_macdonald/archive/2007/04/02/how-to-interpret-windows-installer-logs.aspx)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T07:03:38.503

请参阅 Windows SDK，wilogutl.exe 会有所帮助。连同文档的其余部分:)

[http://msdn.microsoft.com/en-us/library/windows/desktop/aa372811(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa372811(v=vs.85).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-07-04T09:46:47.200

这里还有一篇关于[如何读取 MSI 日志文件](http://www.advancedinstaller.com/user-guide/read-log.html)的详细文章。

如果您是高级安装程序用户，您还可以利用应用程序中的内置日志解析器/调试器，但是文章中的所有建议都可以应用于任何 MSI 日志文件，无论您是否使用记事本、Notepad++ 打开它或在任何其他工具中。

# javascript - 以脚本为目标的 URL 有什么问题？

> ID：13497971
> 
> 赞同：18
> 
> 时间：2012-11-21T16:44:44.087
> 
> 标签：javascript, validation, jshint

我正在使用 JSHint，它收到以下错误：

```
Script URL. 
```

我注意到发生这种情况是因为在此特定行上有一个包含`javascript:...`URL 的字符串。

我知道 JSHint 抱怨说因为该`scripturl`选项已设置，并且由于我的代码库非常大，所以我现在必须取消设置它。

不过，我不明白使用脚本 URL 有什么问题？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-11-21T16:47:03.410

`javascript:`URL 是“eval is evil”的一部分。

为了执行`javascript:`URL，浏览器必须启动 JS 解析器并解析 URL 的文本。
这是一个缓慢而昂贵的过程。

此外，组装`javascript:`URL（或其他包含源代码的字符串）是一项棘手的任务，容易出现 XSS 漏洞。

最后，混合代码和 URL 违反了内容和行为（代码）的分离。

# python - 有没有办法在 Python 中自动刷新/fsync stderr？

> ID：13497973
> 
> 赞同：2
> 
> 时间：2012-11-21T16:43:49.800
> 
> 标签：python, pygtk

我有一个 GUI python 程序和一个简单的错误记录系统

```
import sys
sys.stderr = open("err.log", "w") 
```

它工作得很好。我遇到的一个问题是，每当我在使用 Windows 7 和 Python 2.7.3 时遇到运行时错误时，只有在我关闭程序后才会写入文件 err.log。阅读我收集的相关问题，我需要在错误发生后对 sys.stderr 执行 flush() 和 os.fsync() ，但我不知道如何轻松做到这一点。

一种方法可能是在程序中可能出现运行时错误的每个可能点之后执行刷新/fsync，但这显然不是一个好的解决方案。使用此错误日志的主要原因是调试，因此根据定义，除了可能出现运行时错误的所有可能位置之外，我无法真正事先知道我需要刷新的位置。由于有很多这样的地方，我宁愿不必尝试/抓住每个地方。

我正在使用 PyGTK，所以我看不到主循环，我可以在其中执行刷新/fsync。

有没有办法告诉 Python 在出错后始终执行刷新和 fsync，或者有没有人有其他想法如何解决这个（小）问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T17:15:52.810

我同意 syhpoon：`logging`用于记录。但是如果你真的需要你的安排，请查看第三个`buffering`参数`open`来禁用它：

> 如果给出了缓冲参数，0 表示无缓冲，1 表示行缓冲，较大的数字指定缓冲区大小。打开文件的首选方法是使用内置的 open() 函数。

我试过这个并且它有效。在 Python 会话中：

```
>>> a = open('/tmp/bar', 'w')
>>> a.write('hi\n') 
```

在另一个术语窗口中：

```
$ cat /tmp/bar
$ 
```

然后我重新运行了禁用缓冲的实验：

```
>>> a = open('/tmp/bar', 'w', 0)
>>> a.write('hi\n') 
```

和：

```
$ cat /tmp/var
hi
$ 
```

所以使用`logging`，但如果没有，看看是否只是禁用缓冲会给你你需要的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T17:05:37.617

也许[日志模块](http://docs.python.org/2/howto/logging.html#logging-basic-tutorial)是我们更好的日志选择？

# php - PHP 中的 REST API 身份验证 - 如何生成签名

> ID：13497975
> 
> 赞同：0
> 
> 时间：2012-11-21T16:44:56.490
> 
> 标签：php, api, rest, signature

首先，我对 API 很陌生，所以我在这里努力保持头脑清醒......但无论哪种方式，我都需要在 PHP 中生成 HMAC-SHA 签名。我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T17:07:15.783

```
<?php
echo "welcome<br />";
echo "welcome<br />";
echo hash_hmac('sha256', 'This is only a test sentence of gibberish.', 'secret123');
echo "<br />";
?> 
```

# jquery-mobile - 如何获取有关页面转换结束的静态信息

> ID：13497977
> 
> 赞同：1
> 
> 时间：2012-11-21T16:43:56.257
> 
> 标签：jquery-mobile

我需要知道 jquery-mobile 中的页面转换是否结束或者页面转换是否处于活动状态。我将 jscript 注入到 webbrowser 控件（windows phone 8），因此我不知道任何 ID 或类。

# git - 使用 git 的网站部署给出 500 内部服务器错误

> ID：13497979
> 
> 赞同：1
> 
> 时间：2012-11-21T16:44:03.747
> 
> 标签：git

我知道这不是 stackoverflow 上的新问题，但我没有找到任何能够为我解决此问题的答案。所以请帮我解决我的问题。

我可以在我的站点目录中看到推送的文件。但是，当我尝试浏览域时，它会显示 500 内部服务器错误。你能帮助我吗？

到目前为止，我在 public_html 文件夹中的服务器上做了这个：

mkdir test.git

光盘！$

git init --bare --shared

chgrp -R 开发人员。

chmod -R g+swX 。

vi hooks/post-receive

.....添加到vi编辑器............

GIT_WORK_TREE = /home/public_html/my2 git checkout -f

chmod +x 钩子/后接收

然后在 public_html 的服务器上，我创建了另一个目录作为工作树 mkdir my2

cd my2

chgrp -R 开发人员。

## 到目前为止一切都很好

在我的本地机器上，我可以轻松地推送到 test.git，并且工作树（my2 文件夹）也向我显示文件。

唯一的问题是，当我尝试在浏览器上浏览 my2 时，即 example.com/my2

它给了我 500 个内部服务器错误。

我知道这是权限问题。但如何解决它我不知道。

当我推送时，我已经看到 my2 目录下的用户和组发生了变化。即，如果我将 index.php 推送到 test.git

文件权限更改为

-rw-r--r-- 1 bharat bharat 72 Nov 21 10:01 index.php

其中 bharat 是推送到 test.git 的用户名

请帮忙谢谢

# c# - Ado.Net 实体产生“找不到命名空间”

> ID：13497981
> 
> 赞同：0
> 
> 时间：2012-11-21T16:45:11.280
> 
> 标签：c#, .net, entity-framework

我已经看到了几种可能的解决方案，但没有一个对我有用。

将 ADO.NET 实体数据模型添加到我的 .Net Forms C# Web 项目后，我无法使用它。

也许我在添加它时出错了？添加的文件的名称是 QcFormData.edmx。

我实例化不正确？我尝试添加该行：

```
QcFormData db = new QcFormData();

Error   13  The type or namespace name 'QcFormData' could not be found (are you missing a using directive or an assembly reference?) 
```

我遵循了我在网上找到的没有帮助的建议：

1）确保有“使用 System.Data.Entity”

2）确保dll存在。

3）确保引用存在。

4）一篇帖子说使用系统。**Web** .Data.Entity；但我没有看到可用的。

我错过了什么？

**QcFormData.edmx**

```
<?xml version="1.0" encoding="utf-8"?>
<edmx:Edmx Version="3.0" xmlns:edmx="http://schemas.microsoft.com/ado/2009/11/edmx">
  <!-- EF Runtime content -->
  <edmx:Runtime>
    <!-- SSDL content -->
    <edmx:StorageModels>
      <Schema Namespace="MyCoModel.Store" Alias="Self" Provider="System.Data.SqlClient" ProviderManifestToken="2008" xmlns:store="http://schemas.microsoft.com/ado/2007/12/edm/EntityStoreSchemaGenerator" xmlns="http://schemas.microsoft.com/ado/2009/11/edm/ssdl">
        <EntityContainer Name="MyCoModelStoreContainer">
          <EntitySet Name="QcFieldValues" EntityType="MyCoModel.Store.QcFieldValues" store:Type="Tables" Schema="dbo" />
        </EntityContainer>
        <EntityType Name="QcFieldValues">
          <Key>
            <PropertyRef Name="ID" />
          </Key>
          <Property Name="ID" Type="int" Nullable="false" StoreGeneratedPattern="Identity" />
          <Property Name="FieldID" Type="nvarchar" MaxLength="100" />
          <Property Name="FieldValue" Type="nvarchar" MaxLength="100" />
          <Property Name="DateTimeAdded" Type="datetime" />
          <Property Name="OrderReserveNumber" Type="nvarchar" MaxLength="50" />
        </EntityType>
      </Schema>
    </edmx:StorageModels>
    <!-- CSDL content -->
    <edmx:ConceptualModels>
      <Schema Namespace="MyCoModel" Alias="Self" p1:UseStrongSpatialTypes="false" xmlns:annotation="http://schemas.microsoft.com/ado/2009/02/edm/annotation" xmlns:p1="http://schemas.microsoft.com/ado/2009/02/edm/annotation" xmlns="http://schemas.microsoft.com/ado/2009/11/edm">
        <EntityContainer Name="MyCoEntities" p1:LazyLoadingEnabled="true">
          <EntitySet Name="QcFieldValues" EntityType="MyCoModel.QcFieldValue" />
        </EntityContainer>
        <EntityType Name="QcFieldValue">
          <Key>
            <PropertyRef Name="ID" />
          </Key>
          <Property Name="ID" Type="Int32" Nullable="false" p1:StoreGeneratedPattern="Identity" />
          <Property Name="FieldID" Type="String" MaxLength="100" Unicode="true" FixedLength="false" />
          <Property Name="FieldValue" Type="String" MaxLength="100" Unicode="true" FixedLength="false" />
          <Property Name="DateTimeAdded" Type="DateTime" Precision="3" />
          <Property Name="OrderReserveNumber" Type="String" MaxLength="50" Unicode="true" FixedLength="false" />
        </EntityType>
      </Schema>
    </edmx:ConceptualModels>
    <!-- C-S mapping content -->
    <edmx:Mappings>
      <Mapping Space="C-S" xmlns="http://schemas.microsoft.com/ado/2009/11/mapping/cs">
        <EntityContainerMapping StorageEntityContainer="MyCoModelStoreContainer" CdmEntityContainer="MyCoEntities">
          <EntitySetMapping Name="QcFieldValues">
            <EntityTypeMapping TypeName="MyCoModel.QcFieldValue">
              <MappingFragment StoreEntitySet="QcFieldValues">
                <ScalarProperty Name="ID" ColumnName="ID" />
                <ScalarProperty Name="FieldID" ColumnName="FieldID" />
                <ScalarProperty Name="FieldValue" ColumnName="FieldValue" />
                <ScalarProperty Name="DateTimeAdded" ColumnName="DateTimeAdded" />
                <ScalarProperty Name="OrderReserveNumber" ColumnName="OrderReserveNumber" />
              </MappingFragment>
            </EntityTypeMapping>
          </EntitySetMapping>
        </EntityContainerMapping>
      </Mapping>
    </edmx:Mappings>
  </edmx:Runtime>
  <!-- EF Designer content (DO NOT EDIT MANUALLY BELOW HERE) -->
  <Designer xmlns="http://schemas.microsoft.com/ado/2009/11/edmx">
    <Connection>
      <DesignerInfoPropertySet>
        <DesignerProperty Name="MetadataArtifactProcessing" Value="EmbedInOutputAssembly" />
      </DesignerInfoPropertySet>
    </Connection>
    <Options>
      <DesignerInfoPropertySet>
        <DesignerProperty Name="ValidateOnBuild" Value="true" />
        <DesignerProperty Name="EnablePluralization" Value="True" />
        <DesignerProperty Name="IncludeForeignKeysInModel" Value="True" />
        <DesignerProperty Name="CodeGenerationStrategy" Value="None" />
      </DesignerInfoPropertySet>
    </Options>
    <!-- Diagram content (shape and connector positions) -->
    <Diagrams></Diagrams>
  </Designer>
</edmx:Edmx> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T18:28:08.873

我将 Linq 添加到 SQL 类项，而不是 ADO.Net 实体数据模型项，现在它可以正常工作，无需在我的代码顶部添加命名空间。如果有人对特定解决方案有任何比这更好的建议，那就太好了。我很高兴发布要求的任何特定文件。

正如我上面提到的，如果是命名空间问题，我仍然不知道如何解决它。人们建议我没有做某事，但不完全是什么，要添加的命名空间，在哪里找到它等等。

# android - 小型安卓设备一览

> ID：13497982
> 
> 赞同：0
> 
> 时间：2012-11-21T16:44:17.410
> 
> 标签：android, screen-size

[在这里](http://developer.android.com/about/dashboards/index.html)我可以读到，超过 90% 的设备都安装了 Android 2.2+。

同时只有 2.7% 的设备具有小尺寸（顺便说一句。小尺寸到底是什么？）

是否有所有小型设备的分布数据，具体取决于 android 版本？

是否有任何搭载 Android 2.2+ 的小型设备？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T17:01:17.413

直接来自 Android 开发者[文档](http://developer.android.com/guide/practices/screens_support.html)

*   超大屏幕至少为 960dp x 720dp
*   大屏幕至少为 640dp x 480dp
*   普通屏幕至少为 470dp x 320dp
*   小屏幕至少为 426dp x 320dp

也可以从[这里分发](http://developer.android.com/about/dashboards/index.html)

```
 ldpi    mdpi    hdpi    xhdpi
small   1.7%    1.0%    
normal  0.4%    11%    50.1%    25.1%
large   0.1%    2.4%            3.6%
xlarge          4.6% 
```

我认为没有可靠的方法来判断是否有任何 scmall-screen 设备在 2.2 或更高版本上，但正如您所见，这些设备的数量很少。

# python - 更新二叉树中的父指针

> ID：13497983
> 
> 赞同：0
> 
> 时间：2012-11-21T16:44:24.010
> 
> 标签：python, algorithm, binary-tree

问题是，给定一棵二叉树，其中每个节点有四个数据：`left`，`right`，`data`和一个空指针`parent`，我们必须更新树，使`parent`每个节点的指针指向它的父节点（根父指针自然会指向为 NULL 值）。现在我该怎么做？我尝试了这样的后序遍历：

```
last = None
def mypostorder(root):
    if root:
      mypostorder(root.left)
      mypostorder(root.right)
      if last:
        last.parent = root
      last = root 
```

但显然它不起作用，我知道为什么在更新`parent`左孩子的指针后，它将它设置为`last`，所以下次当它访问右孩子（它的兄弟姐妹）时，它会将其设置`parent`为左孩子. 如何调整它以获得正确的结果？是否也可以使用堆栈迭代地执行此操作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T16:55:41.270

```
void setParent(node * ptr,node * parent_ptr)
{

if(ptr==NULL)
return;

ptr->parent=parent_ptr; //update the parent for the current node

parent_ptr=ptr; //now update the parent pointer

setParent(ptr->left,parent_ptr); //repeat the process for children

setParent(ptr->right,parent_ptr);
} 
```

初次通话：`setParent(root,NULL);`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T16:51:43.637

你走错路了。我认为您的解决方案会使节点的父节点指向其子节点

试试这个：

```
def myPostOrder(root, par=None):
    if root:
        root.parent = par
        myPostOrder(root.left, root)
        myPostOrder(root.right, root) 
```

# python - 需要帮助诊断 Python/MySQL 插入/更新异常

> ID：13497984
> 
> 赞同：0
> 
> 时间：2012-11-21T16:45:29.720
> 
> 标签：python, mysql

我正在学习使用从 mysql.org 网站下载的 MySQL Connector/Python 库来访问 MySQL 数据库。我的环境是 OS X 10.6、带有 PyDev 的 Eclipse Indigo，以及新安装的 MySql（5.5.28，64 位）、Sequel Pro 和 phpMyAdmin 版本。

我的测试数据库有一个表“Employees”，其中包含“id”、“name”和“ssn”列。最初，有两行：(1, Lucy, 1234) 和 (2, Alex, 3456)。

这是 Python 脚本。变量“config”包含数据库的有效访问信息。

```
import mysql.connector
from mysql.connector import errorcode

config = {…}

try:
    cnx = mysql.connector.connect(**config)
except mysql.connector.Error as err:
    if err.errno == errorcode.ER_ACCESS_DENIED_ERROR:
        print("Something is wrong your username or password")
    elif err.errno == errorcode.ER_BAD_DB_ERROR:
        print("Database does not exist")
    else:
        print(err)
else:
    print ("original database contents")

    cursor = cnx.cursor()
    query = ("SELECT name, ssn FROM Employees")  # fetches all employees names and ssns
    cursor.execute(query)
    for (name, ssn) in cursor:  # iterates over fetched data
        print(name, ssn)  # print one employee per line
    cursor.close;

    # block 1: insert a new employee into row 3
    cursor = cnx.cursor()
    cursor.execute("INSERT INTO Employees (id, name, ssn) VALUES (3, 'Sam', '5678')")
    cnx.commit()
    cursor.close()

    # block 2: update the name in the first row
    cursor = cnx.cursor()
    cursor.execute("UPDATE Employees SET name='Ethel' WHERE id=1")
    cnx.commit;
    cursor.close()

    print ("after inserting Sam and updating Lucy to Ethel")

    cursor = cnx.cursor()
    query = ("SELECT name, ssn FROM Employees")  # fetches all employees' names and ssns
    cursor.execute(query)
    for (name, ssn) in cursor:  # iterates over fetched data
        print(name, ssn)  # print one employee per line
    cursor.close;

cnx.close()

print ("end of database test") 
```

使用插入在初始数据库上运行 Python 脚本，然后更新产生：

```
original database contents
(u'Lucy', u'1234')
(u'Alex', u'3456')
after inserting Sam and updating Lucy to Ethel
(u'Ethel', u'1234')
(u'Alex', u'3456')
(u'Sam', u'5678')
end of database test 
```

使用 phpMyAdmin 或 Sequel Pro 查看数据库**仍然会在第 1 行显示“Lucy”**作为名称。

在初始数据库上运行 Python 脚本并进行更新，然后插入（颠倒脚本中块 1 和块 2 的顺序）产生：

```
original database contents
(u'Lucy', u'1234')
(u'Alex', u'3456')
after inserting Sam and updating Lucy to Ethel
(u'Ethel', u'1234')
(u'Alex', u'3456')
(u'Sam', u'5678')
end of database test 
```

使用 phpMyAdmin 或 Sequel Pro 查看数据库**现在显示“Ethel”**作为第 1 行中的名称。

从 Sequel Pro 中打开的初始数据库开始，我可以按任意顺序执行这两个查询并获得正确的结果。

似乎与提交对数据库的更改有关的事情出错了，但作为一个新手，我没有看到它。我会很感激诊断这个问题的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T16:51:32.357

您需要*调用*commit 方法将您的更改提交到数据库，否则事务永远不会保存，其他连接也不会看到更改。

```
cnx.commit() 
```

您省略了`()`代码中的括号。

您还可以`cursor.close`在多个位置引用该方法而不调用它；并不像 Python 会通过垃圾收集自动清理它们那么重要。

# vim - vim-surround 不适合我。s 键删除而不是环绕

> ID：13497990
> 
> 赞同：30
> 
> 时间：2012-11-21T16:44:47.643
> 
> 标签：vim, vim-plugin

刚刚安装了环绕插件。

新建缓冲区，输入 Hello World。假设我想用引号括起来。

在普通模式下，V 进入视觉模式，s 进入环绕

除非它没有， s 删除整行。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-12-06T14:15:50.620

环绕.vim 的默认可视模式映射是`Shift`- `S`，而不是小写的 s。

您可以检查它是否用`:verbose vmap S`. 其他的环绕.vim 映射 ( `ys`, `cs`, ...) 有效吗？如果没有，请检查`:scriptnames`并`:set runtimepath?`进行故障排除。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-07-02T02:16:42.593

这也可能是与 yankstack 插件的键绑定冲突。要修复它，请附加`call yankstack#setup()`到您的`.vimrc`文件中。有关更多信息，请参阅GitHub 上的[讨论。](https://github.com/maxbrunsfeld/vim-yankstack/issues/9)

# entity-framework - 实体框架表继承

> ID：13497991
> 
> 赞同：3
> 
> 时间：2012-11-21T16:45:49.797
> 
> 标签：entity-framework, entity-framework-4

我有以下 2 个表 TableA 和 ArchivedTableA。基本上它们是相同的表，但是 TableA 中的行被移动到 ArchivedTable 以归档它们。

我如何在实体框架中表示这一点，以便这两个类继承自同一个实体。我正在使用 POCO。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T17:10:27.023

我建议不要在这种情况下使用继承。如果您要将 TableA 中的记录“归档”到 ArchiveTableA，它仍然会在您的基表中。

Julie Lerman 有一篇很好的 MSDN 文章，介绍了继承的一些陷阱。 [http://msdn.microsoft.com/en-us/magazine/jj553510.aspx](http://msdn.microsoft.com/en-us/magazine/jj553510.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T16:50:28.073

我会创建一个具有通用属性的基类，例如

```
 public class BaseEntity
    {
         public virtual int Id {get;set;}
         public DateTime CreatedOn  {get;set;}
    } 
```

然后创建从这个基类继承的 POCO 对象，因为它们具有如下的公共列......

```
public class TableA : BaseEntity
{
   public string NewName {get;set;}
}

public class ArchivedTableA : BaseEntity
{
   public string Name {get;set;}
} 
```

您显然需要在此之上以 EF 管道的形式进行 DbSet 映射等...