# StackOverflow 问答 13128000-13128999

# c# - WinRT Xaml ListView - 触摸不能很好地滚动

> ID：13128001
> 
> 赞同：4
> 
> 时间：2012-10-29T19:04:02.463
> 
> 标签：c#, xaml, windows-8, microsoft-metro, windows-store-apps

我有一个水平列表视图，可以向右滚动到屏幕外，例如：

![在此处输入图像描述](../Images/20ba5f9a0395c319b03d86c6678c9358.png)

问题是，当使用触摸时，默认情况下您无法滑动滚动 ListView，它似乎只是抓住了 ListView 项目并将其水平拉了一下。我可以让它滚动的唯一方法是单击每个 ListViewItem 之间的 5-10 像素，这太可怕了。

是否有修改此行为的设置？

我的 Xaml 基本上是这样的：

```
 <ListView 
                x:Name="listView" Grid.Column="1" IsItemClickEnabled="True"
                ItemsSource="{Binding Assignments}" SelectionMode="None" ItemClick="OnItemClick">
                <ListView.ItemsPanel>
                    <ItemsPanelTemplate>
                        <StackPanel Orientation="Horizontal" />
                    </ItemsPanelTemplate>
                </ListView.ItemsPanel>
                <ListView.ItemTemplate>
                    <DataTemplate>
                       <!--cool template to make UI in screenshot-->
                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView> 
```

我应该问杰瑞吗？

![杰瑞！！！！](../Images/c0e82ebcd63dc81599d8c1c003135f2f.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-29T20:36:06.943

嗯，这是由于`ScrollViewer`在.`ListView``ListView`

我可以通过在以下位置设置它来修复它`ListView`：

`ScrollViewer.HorizontalScrollMode="Disabled" ScrollViewer.VerticalScrollMode="Disabled"`

# ruby-on-rails-3 - 如何在 Kaminari 中设置“Next 10”和“Prev 10”

> ID：13128002
> 
> 赞同：1
> 
> 时间：2012-10-29T19:04:07.617
> 
> 标签：ruby-on-rails-3, ruby-on-rails-3.1, kaminari

我正在尝试使用 Kaminari 逐步了解大量客户。到目前为止，我只是在 index.html.erb 中执行此操作：

```
<%= paginate @clients, :outer_window => 3 %> 
```

这导致：

```
1 2 3 4 5 ... 588 589 590 Next Last 
```

其中“下一个”只是前进到下一个。

我想得到这样的东西（大致）

```
1 2 3 4 5 ... 15 25 35 ... 
```

这样用户就可以一次比一个更快地逐步完成。我在文档中看到“Kaminari 主题”，但不知道如何使用它。谢谢...

# eclipse - groovy.lang.MissingMethodException：没有方法签名：

> ID：13128003
> 
> 赞同：2
> 
> 时间：2012-10-29T19:04:09.363
> 
> 标签：eclipse, exception, groovy, soapui, missingmethodexception

我正在尝试从soapUI 运行java eclipse 文件。这些文件目前在 Eclipse 中运行良好，但是当尝试在soapUI 中运行时，会显示以下错误消息。

```
groovy.lang.MissingMethodException:
  No signature of method: com.company.automation.testing.Test()
  is applicable for argument types: (java.lang.String)
                            values: [https://avcedevn1.mas.nsroot.net:17765/]
  Possible solutions: init(java.lang.String, java.lang.Boolean), wait(), wait(long), wait(int), any(), print(java.lang.Object) 
```

我认为这表明初始化参数设置错误，但是我相信我已将它们正确设置为 init(String, Boolean)。为什么会显示此错误消息，我该如何解决？

来自soapUI groovyscript的代码：

```
import com.company.automation.testing.Test

def env = testRunner.testCase.testSuite.project.getPropertyValue("env")
def baseUrl = testRunner.testCase.testSuite.project.getPropertyValue("baseUrl")

log.info("The baseurl is "+baseUrl)
log.info("The env under test is "+env)

Test testStep = new Test();
testStep.init(baseUrl);
testStep.execute(null); 
```

来自 Eclipse 的代码片段：

```
 package com.company.automation.testing;

    import com.eviware.soapui.model.support.AbstractSubmitContext;
    import com.eviware.soapui.model.testsuite.TestRunner;

    public class Test extends BaseSelenium {
       public static void main(final String[] args) {
          final Test trial = new Test();
          try {
             trial.init("https://avcedevn1.mas.nsroot.net:17765/", false);
          } catch (Exception e) {
             // TODO Auto-generated catch block
             e.printStackTrace();
          }
          trial.execute(null);
       } 
```

Eclipse 中的 BaseSelenium 类代码片段：

```
public void init(final String baseUrl, Boolean useDifferentNavigURL) throws Exception {

      this.startTime = System.currentTimeMillis();

      driver = new InternetExplorerDriver();

      this.baseUrl = baseUrl;

      selenium = new WebDriverBackedSelenium(driver, baseUrl);
   } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T19:15:40.383

我猜你在从 SoapUI 调用时错过了布尔参数

`testStep.init(baseUrl);`

# javascript - jQuery 从本地存储中删除单个项目后，其他项目从 UI 中消失但仍存在于本地存储中？

> ID：13128007
> 
> 赞同：0
> 
> 时间：2012-10-29T19:04:41.867
> 
> 标签：javascript, jquery, jquery-ui

好的，所以当我在记录上单击删除时，它似乎可以从 Localstorage 中删除它，但是当页面重新加载时，即使它们仍然存在，任何“下拉菜单”都不会显示 localstorage 中的其他记录？

只是想知道我将如何解决这个问题。

```
// Variable Defaults
var aragStyles = ["1, 2 , 3 , 4"],
aragValue,
save = $("#submit"),
; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T21:55:03.317

如果您使用开发人员工具，您会看到内容实际上被加载到“下拉列表”中（我认为它们被正式称为“[可折叠列表](http://jquerymobile.com/demos/1.2.0/docs/lists/lists-collapsible.html)”）但我认为正在发生的事情是列表不正确当它们被注入 DOM 时“重新初始化”。查看[这篇文章](https://stackoverflow.com/questions/9733935/reinitialize-jquery-mobile-after-inserting-a-form-into-the-page)或[这篇文章](https://stackoverflow.com/questions/8088837/jquery-mobile-triggercreate-command-not-working)以获得一些帮助

```
.trigger('create'); 
```

我查看了您的代码，我认为您会希望在您的`getData()`函数中使用它。像这样的东西：

```
$('#'+id+'items').append(elems); 
```

变成

```
$('#'+id+'items').append(elems).trigger('create'); 
```

不确定我是否正确地遵循了所有内容，但看起来这就是您实际上将可折叠列表“推送”到浏览器的地方。

编辑：

要更新整个页面，您可以执行以下操作：

```
$("div[data-role='content']").trigger("create").trigger( 'updatelayout' ); 
```

# asp.net - 操作 ASP.NET 数据绑定查询

> ID：13128010
> 
> 赞同：0
> 
> 时间：2012-10-29T19:04:51.503
> 
> 标签：asp.net, tsql

我有一个 Databound DropDownList 控件，其中填充了以下查询：

```
<asp:DropDownList ID="ddlSelector" runat="server" DataSourceID="dataSelector"
  DataTextField="Description" DataValueField="Description"
  OnSelectedIndexChanged="TextBox_TextChanged"
  AutoPostBack="True">
</asp:DropDownList>
<asp:SqlDataSource ID="dataSelector" runat="server"
  ConnectionString="<%$ ConnectionStrings:PRODUCTION %>"
  SelectCommand="SELECT [ID], [Description] FROM [Status]">
</asp:SqlDataSource> 
```

我有第二个 Databound DropDownList 控件，需要从下一个 available 中选择谁的值`Status.ID`。

```
<asp:DropDownList ID="ddlChangeTo" runat="server" DataSourceID="dataChangeTo"
  DataTextField="Description" DataValueField="Description">
</asp:DropDownList>
<asp:SqlDataSource ID="dataChangeTo" runat="server"
  ConnectionString="<%$ ConnectionStrings:PRODUCTION %>"
  SelectCommand="SELECT [ID], [Description] FROM [Status] WHERE ([Description] &lt; @Description)">
  <SelectParameters>
    <asp:ControlParameter ControlID="ddlSelector" Name="Description" PropertyName="SelectedValue" Type="String" />
  </SelectParameters>
</asp:SqlDataSource> 
```

上面的`WHERE`条款不适合我所追求的解决方案。它按字母顺序过滤。

我需要的是一种从中获取`[ID]`价值`ddlSelector`并将所有大于该值的值`ID`置于我`ddlChangeTo`控制中的方法。

如何`[ID]`从 DropDownList 控件获取值以在`ddlSelector`DropDownList 控件的数据绑定查询中使用`ddlChangeTo`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T19:12:46.277

完成此操作的最简单方法是将整个部分包装在更新面板中，并在第一个下拉列表更改后绑定第二个下拉列表。

然后，您可以将 asp:ControlParameter 连接到隐藏字段，并让第一个下拉列表在自动回发后面的代码中填充隐藏字段，然后在第二个下拉列表中调用数据绑定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T21:26:14.677

好的，我发现了如何做到这一点，但我没有在任何地方在线找到答案。

在盯着代码看了一会儿并尝试了各种方法之后，看起来这`DataTextField`就是显示的内容，而`DataValueField`这是用于比较的值。

对于那些已经这样做了很长时间的人来说，这可能是显而易见的，但它不适合我。

`DataValueField`为了使我的控件正常工作，我对`ddlSelector`DropDownList 控件进行了以下更改：

```
<asp:DropDownList ID="ddlSelector" runat="server" DataSourceID="dataSelector"
  DataTextField="Description" DataValueField="ID"
  OnSelectedIndexChanged="TextBox_TextChanged"
  AutoPostBack="True">
</asp:DropDownList> 
```

我必须对第二个 Databound DropDownList 控件、`SqlDataSource`和`ControlParameter`Type 进行类似的更改：

```
<asp:DropDownList ID="ddlChangeTo" runat="server" DataSourceID="dataChangeTo"
  DataTextField="Description" DataValueField="ID">
</asp:DropDownList>
<asp:SqlDataSource ID="dataChangeTo" runat="server"
  ConnectionString="<%$ ConnectionStrings:PRODUCTION %>"
  SelectCommand="SELECT [ID], [Description] FROM [Status] WHERE ([ID] &gt; @ID)">
  <SelectParameters>
    <asp:ControlParameter ControlID="ddlSelector" Name="Description" PropertyName="SelectedValue" Type="Int32" />
  </SelectParameters>
</asp:SqlDataSource> 
```

当你自己弄清楚时，这种感觉很酷。

我希望其他人能从中得到一些用处。

# asp.net-web-api - ASP.NET WebAPI：如何控制返回给客户端的字符串内容？

> ID：13128013
> 
> 赞同：17
> 
> 时间：2012-10-29T19:05:05.243
> 
> 标签：asp.net-web-api, string-formatting, httpresponse

在 WebAPI 中，假设我返回一个包含在 HTTP 响应中的字符串：

```
return Request.CreateResponse(HttpStatusCode.BadRequest, "Line1 \r\n Line2"); 
```

从 jQuery 调用此操作时，响应文本会在返回之前进行处理。所以在xhr中，我得到了这样的东西：

```
function success(xhr) {
    alert(xhr.responseText); // alerts ""Line1 \\r\\n Line2""
} 
```

换句话说，字符串被双引号括起来，特殊字符被转义，以便它们出现在输出中（实际警报是“Line1 \r\n Line2”，因此不保留换行符，而是编码并显示在响应文本）。

我可以通过删除引号并替换客户端上的换行符来解决这个问题，如下所示：

```
var responseText = xhr.responseText.substr(1, xhr.responseText - 2)
    .replace('\\r', '\r').replace('\\n', '\n'); 
```

但是有没有办法告诉 WebAPI 如何格式化字符串响应？例如，不要将它们用双引号括起来并转换转义字符？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-10-29T20:40:28.327

发生这种情况是因为您的控制器正在返回 JSON，其中引用了字符串值。

一个简单的解决方案是将其解析`responseText`为 JSON，然后您可以按预期使用该值：

```
$.ajax("/api/values/10", {
    error: function (xhr) {
        var error = JSON.parse(xhr.responseText);
        $("textarea").val(error);
    }
}); 
```

这正确解释了换行符/回车符。

或者，您可以`text/plain`在控制器中指定媒体类型：

```
return Request.CreateResponse(
    HttpStatusCode.BadRequest, 
    "Line1 \r\n Line2", "text/plain"); 
```

然后，Web API 将尝试加载合适的媒体类型格式化程序，`text/plain`但不幸的是，该格式化程序不存在 OOTB。您会在[WebApiContrib](https://github.com/WebApiContrib/WebAPIContrib/blob/master/src/WebApiContrib/Formatting/PlainTextFormatter.cs)中找到一个。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-29T20:32:52.093

您所追求的是自定义**MediaTypeFormatter**。听起来您希望实现自己的自定义来替换和现有的，或者您正在一起创建一个新的自定义，具体取决于您期望的 Accept 标头。好消息是你可以换掉现有的或者想出一个你喜欢的新媒体类型。可以在这里找到一些可以帮助您入门的地方：

[http://byterot.blogspot.com/2012/04/aspnet-web-api-series-part-5.html](http://byterot.blogspot.com/2012/04/aspnet-web-api-series-part-5.html)

[http://www.asp.net/web-api/overview/formats-and-model-binding/media-formatters](http://www.asp.net/web-api/overview/formats-and-model-binding/media-formatters)

是的，我实际上已经做了一小部分，因为我已经用更快的格式替换了一些默认的格式化程序，例如 JSON，即 ServiceStack，它工作得很好。

# c++ - Eclipse CDT - 输出 - 使用 vs 编译器时没有帮助

> ID：13128018
> 
> 赞同：0
> 
> 时间：2012-10-29T19:05:38.333
> 
> 标签：c++, eclipse, cross-platform

我使用 eclipse CDT（Juno 版本），并且我一直在尝试在编译时能够看到我们在 Visual Studio 中的错误输出类型。

相反，“问题”视图在让我们看到编译器错误方面似乎非常有限（使用与 Visual Studio 相同的编译器）。

一个简单的例子。如果你有一个简单的错字

```
typedef std::function(void(int)) Func; 
```

VS 输出立即显示：

```
 error C2955: 'std::function' : use of class template requires template argument list
1>          c:\program files (x86)\microsoft visual studio 11.0\vc\include\functional(554) : see declaration of 'std::function' 
```

相比之下，在 CDT 下使用相同的编译器我会在完全不同的代码行中出现错误，其中大部分是在使用错误定义的 typedef 的区域而不是在原始位置。是否有可能至少在不同的窗口中看到“原始编译器输出”，以便了解发生了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T19:17:26.117

对于编译器输出，您必须检查**控制台**选项卡。它是您所在的“**问题**”选项卡右侧的选项卡之一。

# php - 在 Jpgraph 上加载图像...直到我重新加载

> ID：13128020
> 
> 赞同：1
> 
> 时间：2012-10-29T19:05:48.570
> 
> 标签：php, phpexcel, jpgraph

这是我在这个网络上的第一个请求。

我有 jpgraph 的问题。有时，使用 phpexcel 在此脚本中不会生成图像。在我重新加载页面之前，图像会产生

```
enter code here $hrActual =date("H-i-s");
$fechasActual = date("d-m-Y");

$graph = new PieGraph(500,400);
$graph->SetShadow();

$graph->title->Set("ELISAS");
$graph->title->SetFont(FF_FONT1,FS_BOLD);

$p1 = new PiePlot3D($Datos);
$graph->Add($p1);
$p1->ExplodeSlice(1);
$p1->SetCenter(0.50);
$p1->SetLegends($Leyendas);
$p1->SetSliceColors(array('#00AF50','#FFC000'));
$graph->legend->Pos(0.4,0.95,"center","bottom"); 

$graph->Stroke('../graficas/img/Grafica_Efectividad_Elisas_'.$hrActual.'_'.  $fechasActual.'.png');
enter code here// Agrega una imagen
$objDrawing = new PHPExcel_Worksheet_Drawing();
$objDrawing->setName('image name');
$objDrawing->setDescription('PHPExcel logo');
$objDrawing->setPath('../graficas/img/Grafica_Efectividad_Elisas_'.$hrActual.'_'.$fechasActual.'.png');
//$objDrawing->setHeight(100);
$objDrawing->setCoordinates('A'.$i);
$objDrawing->setOffsetX(10);
$objDrawing->setWorksheet($objPHPExcel->getActiveSheet()); 
```

如果你不能帮助我，我会很感激。

谢谢

# iphone - 绘制，清除然后重绘问题 Quartz

> ID：13128021
> 
> 赞同：2
> 
> 时间：2012-10-29T19:05:53.247
> 
> 标签：iphone, ios, drawing, quartz-graphics, quartz-core

我正在尝试在 iPhone 上绘制图形，但我希望图形能够快速更新，所以我真正想做的是将图形绘制到 a `UIImageView`，然后在重复绘制方法时，清除旧图形并重新绘制它.

这是我的代码：

```
- (void)redraw {
    canvas.image = nil;

    UIGraphicsBeginImageContext(self.view.frame.size);
    [canvas.image drawInRect:CGRectMake(0, 0, self.view.frame.size.width, self.view.frame.size.height)];
    CGContextSetLineCap(UIGraphicsGetCurrentContext(), kCGLineCapRound);
    CGContextSetLineWidth(UIGraphicsGetCurrentContext(), 5.0);
    CGContextSetRGBStrokeColor(UIGraphicsGetCurrentContext(), 1.0, 0.0, 0.0, 1.0);
    CGContextBeginPath(UIGraphicsGetCurrentContext());
    CGContextMoveToPoint(UIGraphicsGetCurrentContext(), 0, canvas.frame.size.height/2);
    for (float i=0; i<500; i+=0.01) {
        [self y:i];
        CGContextAddLineToPoint(UIGraphicsGetCurrentContext(), ((i*200)-200), (y*200)+canvas.frame.size.height/2);
    }
    CGContextStrokePath(UIGraphicsGetCurrentContext());
    canvas.image = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();
} 
```

这段代码在调用一次时完全按照我想要的方式工作。它显示以下曲线： ![运作良好](../Images/b277ddeb6409c5dbf5d312e9774c52d2.png)

`redraw`但是，当我为奇怪的事情添加计时器时，就会开始发生。当应用程序启动时，我得到了上图所示的曲线，但它立即变成了这条曲线（相同的曲线，只是看起来沿 x 轴拉伸得更多，而在 y 轴上更高（技术上更低）： ![在此处输入图像描述](../Images/43b978c515cd6098426c4be42f88f193.png)

和：

```
- (void)y:(float)x {
    y = sin(x - 1)*pow((x - 1), 0.5)*cos(2*(x - 1))*sin(0.5*(x - 1))*cos(x - 1)*sin(2*(x - 1))*pow(cos(x-1), -1);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T11:28:24.953

我相信问题在于您在`canvas.frame`将 Graphics Context 设置为`self.view.frame.size`. 现在也许两者都设置为完全相同的尺寸（我无法知道），但如果由于某种原因，这些尺寸不同，它可能会导致您的例程图形结果中的“拉伸”。

此外，您还有一些奇怪的代码。在您调用的方法的开头`canvas.image = nil;`。但后来（向下 3 行）你调用`[canvas.image drawInRect:CGRectMake(0, 0, self.view.frame.size.width, self.view.frame.size.height)];`. 如果`canvas.image`只是设置为 nil，则没有图像`drawInRect`（如果您想替换`canvas`' 的图像，为什么还要这样做）。

# c - sendto 在 Mac OS X 10.8 上返回 EINVAL

> ID：13128024
> 
> 赞同：1
> 
> 时间：2012-10-29T19:05:58.000
> 
> 标签：c, macos, sockets, network-programming, sendto

我有一个程序可以在 Mac OS 10.6 上正常工作，但在 10.8 中莫名其妙地失败了。它的要点是 sendto 现在返回 -1 并将 errno 设置为 EINVAL (22)。怎么了？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-29T19:05:58.000

我给 sendto 的地址来自 getaddrinfo 的第一个结果。原来，第一个结果现在是 IPV6 结果（使用 sockaddr_in6）。OS 10.8 上的 sendto（至少现在）似乎只适用于 sockaddr_in 地址。确保向 getaddrinfo 传递一个提示，表明您只需要 ipv4 地址，即

```
struct addrinfo hint;
memset( &hint, 0, sizeof(struct addrinfo));
hint.ai_family = AF_INET;

struct addrinfo* result;
int res = getaddrinfo( friendlyHostname, NULL, &hint, &result ); 
```

阅读[http://linux.die.net/man/3/getaddrinfo](http://linux.die.net/man/3/getaddrinfo)了解更多信息。

# sql-server-2008 - 在插入之前锁定表

> ID：13128026
> 
> 赞同：0
> 
> 时间：2012-10-29T19:06:10.783
> 
> 标签：sql-server-2008, insert, network-programming, locking

我创建了一个适用于网络的 C# 应用程序。我的应用程序使用 SQL Server 2008 Express。

**我的问题是：**

当 2 个人同时在 2 台计算机上点击`Insert`按钮时，数据库中会添加 2 行相同编号的行（即故障）。

如果时间不一样，我的应用程序检查一些条件，这个问题就不会发生。

**我的问题是：**

现在我想在插入 1 人之前锁定表并在插入后解锁表。

这个怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T19:17:19.597

你必须使用 IDENTITY 列。

如果你想锁定 sql server 中的表，你可以这样做

```
INSERT INTO Table1 WITH (TABLOCK)
SELECT @Col1, @Col2, @Col3, @Col4 OPTION (FAST 1)

UPDATE Table1 WITH (TABLOCK) 
SET Col5 = @Col5
WHERE @Col1 = @Var

UPDATE Table2 WITH (TABLOCK) 
SET Col = @ColVal 
```

# c# - 检查对象是否是非基本类型？

> ID：13128028
> 
> 赞同：0
> 
> 时间：2012-10-29T19:06:28.723
> 
> 标签：c#

我希望能够查看对象是否属于基本类型（char、int、var、string（这是 C# 中的基本类型吗？））。这样做的原因是因为我想创建一个解析器，它获取对象的字段，如果它遇到一个对象，它无法从中获取值（如果它是内部的另一个对象），它将递归地获取字段也有。例如：

```
 for (int x = 0; x < elements.Length; x++)
    {
        FieldInfo currenField = fields[x];

        if (currenField is object) //This doesn't work because its of type "FieldInfo"
        {
            //pass in the current object into the function
        }
        else
        {
            elements[x] = new XElement(currenField.Name, currenField.GetValue(obj).ToString());
        } 
```

不幸的是，我似乎在网上找不到任何东西，这将使您可以轻松确定它是否是基本类型。以下也是不可能的：

```
 currenField.GetType is typeof(object) 
```

TLDR；我无法确定某物是否为基本类型，也无法比较类型以产生相同的效果

任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-29T19:08:22.273

您所说的“基本类型”实际上被认为是原始类型。[`IsPrimitive`](http://msdn.microsoft.com/en-us/library/system.type.isprimitive.aspx)您可以使用以下属性确定类型是否为原始类型：

```
var type = currenField.GetType();
if(type.IsPrimitive)
    // Primitive type
else
    // Other type 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T19:37:13.187

通常`IsPrimitive`就足够了，但如果您需要更多信息，我建议您使用[Type.GetTypeCode()](http://msdn.microsoft.com/en-us/library/system.type.gettypecode.aspx)。

```
var typeCode = Type.GetTypeCode(currenField.GetType());

switch (typeCode)
{
    case TypeCode.Boolean:
        break;
    case TypeCode.Byte:
        break;
    case TypeCode.Char:
        break;
    case TypeCode.DBNull:
        break;
    case TypeCode.DateTime:
        break;
    case TypeCode.Decimal:
        break;
    case TypeCode.Double:
        break;
    case TypeCode.Empty:
        break;
    case TypeCode.Int16:
        break;
    case TypeCode.Int32:
        break;
    case TypeCode.Int64:
        break;
    case TypeCode.Object:
        break;
    case TypeCode.SByte:
        break;
    case TypeCode.Single:
        break;
    case TypeCode.String:
        break;
    case TypeCode.UInt16:
        break;
    case TypeCode.UInt32:
        break;
    case TypeCode.UInt64:
        break;
    default:
        break;
} 
```

# asp.net - 在子页面中访问母版页控件

> ID：13128035
> 
> 赞同：0
> 
> 时间：2012-10-29T19:06:55.570
> 
> 标签：asp.net

我想从子页面访问asp.net母版页上的跨度，所以我在该母版页上创建了一个公共属性->
**母版页**

```
public partial class Ui_MasterPage_UI : System.Web.UI.MasterPage
    {
        public int tax = 0;

        public string notification
        {
            set
            {
                (this.FindControl("notification") as HtmlAnchor).InnerText = value.ToString();
            }
        }
       ------------------//some code
    } 
```

现在想从子页面访问它以将一些文本设置到该 htmlanchor 标记中，以便我编写一些脚本-->

**子页面**

```
public partial class Ui_ProductDetails : System.Web.UI.Page
{
protected void ListView_ProductDetails_itemcommand(object sender, ListViewCommandEventArgs e)
    {
        Master.notification = "some text";            ////////showing error
 ------------------//some code       
    }
------------------//some code       
} 
```

但是得到语法错误我认为上面的代码有问题，，，，，所以请检查一下......还有其他方法吗？thnku

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T20:06:28.613

将属性 runat="server" 和 clientidmode="static" 添加到您的 HtmlAnchor 与 id "notification" 可以使代码：

```
(Master.FindControl("notification") as HtmlAnchor).InnerText = "whatever" 
```

在每个子页面中工作...

编辑：我想说你不需要那种公共方法......

# node.js - 在 nodejs 中使用 fs.stat 的问题

> ID：13128037
> 
> 赞同：6
> 
> 时间：2012-10-29T19:06:57.567
> 
> 标签：node.js

我尝试读取文件参数。当我制作这段代码时：

```
 var fs = require('fs'),
    size = new Object();
fs.stat(file, function(err,stats){
         if(!err){
            size=stats;
         }
      })
   console.log(size); 
```

没关系，当我尝试使用功能时：

```
 var fs = require('fs'),
    size = new Object();
function writeinfile(file){
   fs.stat(file, function(err,stats){
         if(!err){
            size=stats;
         }
      })
   console.log(size.size);  
}
writeinfile('error.log'); 
```

这行不通。你能帮我变种 2 工作吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-29T19:46:14.943

您的 console.log 在您的 fs.stat 回调之外。解决它：

```
 var fs = require('fs'),
    size = new Object();
function writeinfile(file){
   fs.stat(file, function(err,stats){
         if(!err){
            size=stats;
            console.log(size.size);  
         }
      })

}
writeinfile('error.log'); 
```

我还重写了您的代码以在 Node.js 中使用更惯用（更常见）的语法：

```
var fs = require('fs');

function writeinfile (file, cb) {
  fs.stat(file, function(err,stats){
    if(err) return cb(err);
    cb(null, stats.size); 
  })
}

writeinfile('error.log', function(err, size) {
  if(err) {
    console.log(err);
    return;
  }
  console.log('The size of the file is ' + size);
}); 
```

正如 Herman 在他的回答中提到的，如果您不写入文件，最好选择一个更好的函数名称。

最后一件事，在 Javascript 中，您可以将`{}`其用作`new Object()`. 例如：`var size = {};`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-02-27T19:14:34.103

你需要把 console.log(size.size); 在回调函数内部，但我认为我需要更好地解释。

您需要了解异步调用和 Node.js 事件循环。创建 Node.js 是为了以更好的方式并行化资源，即为 IO 密集型（如 Web 服务器）而不是 CPU 密集型的问题创建线程。这个想法是单线程的逻辑与非阻塞调用使用 IO 比创建多个线程并调用块函数来使用 IO 更好。

如果您使用另一种语言进行编程，您应该熟悉算法的同步版本：

```
var fs = require('fs'),
size = new Object();
function writeinfile(file) {
    var stats = fs.statSync(path);
    size = stats.size;
    console.log(size);
};

writeinfile('error.log'); 
```

这是 Node.js 代码，但这不是 Node 方式。当您调用 statSync() 时，您的脚本会阻塞以等待从磁盘读取统计信息。

但是，当您使用 just 时`fs.stat()`，您的程序将运行到代码结束，同时磁盘正在读取。所有下一行将在程序实现事件循环之前运行。就在 stat 准备好并且程序运行到结束时，事件循环将调用您在 call 中通过参数传递的回调函数`fs.stat(callback)`。

因此，在您的代码中，您调用 stat（异步版本），并尝试使用尚未准备好的值，因为异步调用之后的代码总是会在回调被调用之前运行。

我认为第一个版本可以工作，因为您应该在解释器中手动输入代码，因此，您需要输入下一行的时间足以让程序实现事件循环。在这种模式下，每次你输入一个命令，回车，代码就会运行，也就是说，你得到一个返回，事件循环中的事件会在之后被调用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-29T19:51:59.300

在您的示例中，由于 fs.stat() 的异步特性，期望在 console.log(size) 运行时设置 size 的值是不正确的。

以下是实际发生的情况，按顺序：

1.  您需要该`fs`模块并实例化一个新`size`对象。
2.  你用回调调用 fs.stat(path,cb)
3.  你打电话给 console.log(size)
4.  然后，*在未来的某个时候*， fs.stat() 调用您的回调

事情之所以按此顺序发生，是因为由于文件 io 的异步特性，无法事先预测进行所需文件系统调用所需的时间。根据光盘当前正在执行的操作，可能需要 4 到 4000 毫秒或更多时间。

这就是我们依赖回调的原因，因为它们保证在应用它们的函数完成时发生，或者在这种情况下，当文件路径的状态已经确定时。

请不要难过。这是**每个人**在异步编程时都会犯的一个错误，也是编程节点时最难理解的概念。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-29T19:43:43.920

您的代码有几个观察结果。但我们在这里学习：

1.  确保将`console.log`回调放在内部（即在下面`size=stats`），这样您就可以在函数完成任务后获得所需的信息。

2.  在上面添加这一行`if (!err)`：

    如果（错误）console.log（错误）；

您将看到以下内容

```
{ [Error: ENOENT, stat 'error.log'] errno: 34, code: 'ENOENT', path: 'error.log' } 
```

这意味着路径上的错误。简单修复：使用[fs.exists()](http://nodejs.org/api/fs.html#fs_fs_exists_path_callback)检查文件是否存在，和/或始终确保在文件名前加上`__dirname`.

1.  最后一行讨论`writeinfile`，但`fs.stats`为您提供有关文件的信息...我建议[fs.write()](http://nodejs.org/api/fs.html#fs_fs_write_fd_buffer_offset_length_position_callback)用于此任务的更好功能。

# iphone - IOS中的恒定动画

> ID：13128043
> 
> 赞同：0
> 
> 时间：2012-10-29T19:07:21.740
> 
> 标签：iphone, ios, cocoa, core-animation, drawrect

我有一个图表，它是 iphone 屏幕宽度的 10 倍。我想每 0.2 秒自动滚动固定数量的点（例如 0.01）。我希望动画在用户按下暂停按钮时停止，并在他点击恢复按钮时从最后一个位置开始。

用Core Animation可以实现吗？还是您需要使用 drawRect 手动执行的操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T03:22:55.300

将图表放在滚动视图上并使用 NSTimer 来控制内容偏移。如果要暂停，只需使计时器无效

# javascript - 浏览器显示的图标在哈希更改时闪烁

> ID：13128045
> 
> 赞同：4
> 
> 时间：2012-10-29T19:07:27.210
> 
> 标签：javascript, jquery, google-closure-library

当我通过 document.location.hash 或 window.location.hash 更改哈希位置时，大多数浏览器都有某种形式的“闪烁”效果。我需要防止这种情况发生，因为我正在实现一个基于哈希更改的历史插件，而“闪烁”效果简直丑陋。我知道这是可行的，因为我已经看到了许多基于 Ajax 的产品（尤其是来自 Google 的负载）

这是用于显示网站图标的代码：

```
<link rel="shortcut icon" href="http://www.mysite.com/favicon.ico" /> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T19:16:14.637

检查this previous answer to a similar question，看看它是否适合您：

[FireFox 3.6 - 9 在更改 window.location 时会丢弃 favicon](https://stackoverflow.com/questions/2409759/firefox-3-6-9-drops-favicon-when-changing-window-location/4630726#4630726)

# iphone - uitableviewcell 中的两个部分

> ID：13128047
> 
> 赞同：0
> 
> 时间：2012-10-29T19:07:35.093
> 
> 标签：iphone, ios, xcode, ipad

我想做一个看起来像这样的应用程序。

![在此处输入图像描述](../Images/7f5a06ab35f6caa012b2d58675745a61.png)

有很多关于如何使 uitableviewcell 的高度动态化的帖子，所以这对我来说不是问题。我的问题是他们如何将单元格分成具有不同字体的两列？是否有教程或示例如何在 uitableview 中实现？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T19:17:50.733

它看起来像一个带有两个标签的自定义单元格。

以下是基本步骤：

1.  为它创建一个新表和一个 UITableViewController 子类。（我假设你知道如何做这部分，因为你说你可以做可变高度的行。）
2.  单击原型单元格并选择属性检查器。
3.  将您的标识符（重用标识符）设置为一个值。让我们将其设置为“TwoLabelCell”
4.  将两个标签拖到原型单元格上，并将它们排列在您想要的位置。
5.  将每个标签的字体设置为您想要的方式
6.  将每个标签的标签设置为不同的值，以便您以后识别它们。在这种情况下，让我们将左侧的设置为 1000，将右侧的设置为 1001。
7.  在您的自定义类中，实现以下方法：

* * *

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"TwoLabelCell";
    UITableViewCell *cell           = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    return cell;
}

- (void)tableView:(UITableView *)tableView willDisplayCell:(UITableViewCell *)cell forRowAtIndexPath:(NSIndexPath *)indexPath
{
    UILabel *leftLabel  = (UILabel *)[cell viewWithTag:1000];
    UILabel *rightLabel = (UILabel *)[cell viewWithTag:1001];

    // Set the values based on the indexPath.  This is just an example.
    leftLabel.text      = @"409";
    rightLabel.text     = @"Vandals and Alans cross the Pyrenees and appear in Hispania.";
} 
```

如果您将与各个行进行大量交互，您可能需要子类化并为每个标签设置属性。（即cell.yearLabel和cell.descriptionLabel）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T20:29:35.097

嗨，您可以通过为自定义 tableviewcell 添加两个标签来获得此信息，请参阅此链接[Custom UITableViewCell Using Interface Builder](http://www.google.co.in/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&ved=0CB8QFjAA&url=http://www.icodeblog.com/2009/05/24/custom-uitableviewcell-using-interface-builder/&ei=7eaOUKOjHITXrQfG7YDwAw&usg=AFQjCNGk2oznClItzoMuduKsltU3jRqeKQ&sig2=8z6JnxN9fvrwmA58kwwm0g)

# c# - 如何计时测量 Web 服务

> ID：13128060
> 
> 赞同：0
> 
> 时间：2012-10-29T19:08:15.170
> 
> 标签：c#, asp.net, iis-7

这将是我之前提出的问题的后续问题： [秒表不同的时间为什么？](https://stackoverflow.com/questions/12736719/stopwatch-different-timing-why)

我在 Web 服务中使用秒表，只知道需要一些方法的时间我有这样的程序：（C# 中的程序，使用 ASP.NET）

```
Stopwatch swK=new Stopwatch();
swK.Start();
do
{               
method1(intvar1,intvar2,intvar3);
var_1=method2(intvar1,doublevar1, doublevar2);
flag= Compara (doublevar3,intvar1,doublevar4);
}
while (flag != 1);
swK.Stop();
double tim2 = swK.Elapsed.TotalMilliseconds; 
```

这样 tim2 将以毫秒为单位从“while”中的所有方法中获取时间；我不明白的是，第一次它仍然需要很多时间，例如第一次需要 10 毫秒，下一次只需要 1毫秒，

所以我的问题是，如果我只是在测量某些方法的过程时间，那么第一次需要这么多时间吗？是因为程序集、jiiter 等...

他们是另一种衡量我的方法的方法，但没有受到其他因素的影响？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T19:14:00.660

在 .NET 中，有很多事情第一次需要一段时间，而后续操作会更快。连接到数据库、连接到 Web 服务、附加到文件系统等。甚至可能是发生 JIT 编译的问题，尤其是在您更改代码并重新运行它时。甚至只是[运行时如何分配和释放对象](http://msdn.microsoft.com/en-us/magazine/cc163791.aspx)。

作为 .NET 开发人员，您甚至不需要考虑幕后的大量“管道”。还有像[连接池](http://msdn.microsoft.com/en-us/library/8xx3tyca.aspx)这样的优化，可以在您甚至没有意识到的情况下加快后续尝试的速度。

正如您的问题所表达的那样，它可能是任何这些类型的东西。我们不一定能在这里明确地回答这个问题。我们不知道这些方法内部发生了什么，但希望以上内容*能够*阐明导致这种情况的原因。

Toi 缩小范围，在 Visual Studio 中（如果你有正确的版本）你可以使用[分析](http://msdn.microsoft.com/en-us/magazine/cc337887.aspx)来尝试找到瓶颈。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T19:18:10.910

第一次运行它需要很长时间的最可能原因是即时编译。对于 Web 服务，造成这种情况的另一个原因是网络延迟。通常，衡量一个过程所花费的时间的最佳方法是通过做几个测量（比如说 10 个）并获得它们的平均值，还有其他统计方法，但这取决于你想要获得的复杂程度这个措施。

# r - 当涉及 S4 代码时，testthat::auto_test() 似乎失败了

> ID：13128061
> 
> 赞同：4
> 
> 时间：2012-10-29T19:08:20.577
> 
> 标签：r, unit-testing, autotest, s4, testthat

在过去的几周里，我一直在将[testthat](http://cran.r-project.org/web/packages/testthat/index.html)包的单元测试功能越来越多地集成到我的日常工作中，并且真的不得不说：这个包太棒了！

我特别喜欢自动测试功能，**每次**您在代码中的某个位置进行更改时，它都会自动运行您的所有单元测试。但是，我认为在您的代码目录包含 S4 定义（类、通用方法、自定义方法）的情况下使用[testthat](http://cran.r-project.org/web/packages/testthat/index.html)的函数时，我遇到了一个小错误或至少一些不良行为。`auto_test()`

## 问题

下面说明的这种行为是错误还是我在使用时做错了什么`auto_test()`？

下面你会找到一个需要先创建一些示例文件的插图

## 预赛

设置工作目录

```
setwd("testthat_autotest") 
```

确保目录

```
dir.create("src", showWarnings=FALSE)
dir.create("tests", showWarnings=FALSE) 
```

## 创建 S4 参考类定义

`classes.R`在目录中创建文件`src`

```
def <- c(
    "setRefClass(",
    "   Class=\"MyClass\",",
    "   fields=list(",
    "       name=\"character\"",
    "   ),",
    "   methods=list(",
    "       getName=function(...) {",
    "           getName_ref(.self=.self, ...)",
    "       },",
    "       setName=function(...) {",
    "           setName_ref(.self=.self, ...)",
    "       }",
    "   )",
    ")"
)
write(def, file="src/classes.R") 
```

## 创建通用方法定义

`generics.R`在目录中创建文件`src`

```
def <- c(
    "setGeneric(",
    "    name=\"getName_ref\",",
    "    signature=c(\".self\"),",
    "    def=function(",
    "        .self,",
    "        ...",
    "    ) {",
    "standardGeneric(\"getName_ref\")",    
    "   }",
    ")",
    "",
    "setGeneric(",
    "   name=\"setName_ref\",",
    "   signature=c(\".self\"),",
    "   def=function(",
    "       .self,",
    "       value,",
    "       ...",
    "   ) {",
    "   standardGeneric(\"setName_ref\")",    
    "   }",
    ")"
)
write(def, file="src/generics.R") 
```

## 创建自定义方法定义

`methods.R`在目录中创建文件`src`

```
def <- c(
    "require(\"compiler\")",
    "",
    "setMethod(",
    "   f=\"getName_ref\",", 
    "   signature=signature(.self=\"MyClass\"),", 
    "   definition=cmpfun(function(",
    "       .self,",
    "       ...",
        ") {",
        "out <- .self$name",
        "return(out)",
        "}, options=list(suppressAll=TRUE))",  
    ")",
    "setMethod(",
    "   f=\"setName_ref\",", 
    "   signature=signature(.self=\"MyClass\"),", 
    "   definition=cmpfun(function(",
    "       .self,",
    "       ...",
    "   ) {",
    "   .self$field(name=\"name\", value=value)",
    "   return(TRUE)",
    "   }, options=list(suppressAll=TRUE))",  
    ")"
)
write(def, file="src/methods.R") 
```

## 创建单元测试

创建文件`test_getName_ref.R`和`test_setName_ref.R`目录`tests`

```
test <- c(
    "require(\"testthat\")",
    "",
    "test_that(desc=\"test_getName_ref,.self=MyClass\",",
    "   code={",
    "       x.target <- \"some value\"",
    "       expect_that(",
    "            .self <- new(\"MyClass\", name=x.target),",
    "            is_a(\"MyClass\")",
    "        )",
    "        expect_that(",
    "            x.test <- .self$getName(),",
    "            is_a(\"character\")",
    "        )",
    "        expect_that(",
    "            x.test,",
    "            is_identical_to(x.target)",
    "        )",
    "    }",
    ")"
)
write(test, file="tests/test_getName_ref.R")

test <- c(
    "require(\"testthat\")",
    "",
    "test_that(desc=\"test_setName_ref,.self=MyClass\",",
    "   code={",
    "       x.target <- \"some value\"",
    "       expect_that(",
    "            .self <- new(\"MyClass\"),",
    "            is_a(\"MyClass\")",
    "        )",
    "        expect_that(",
    "            .self$setName(value=x.target),",
    "            is_identical_to(TRUE)",
    "        )",
    "        expect_that(",
    "            .self$getName(),",
    "            is_identical_to(x.target)",
    "        )",
    "    }",
    ")"
)
write(test, file="tests/test_setName_ref.R") 
```

## 插图

运行`auto_test()`会报错：

```
require("testthat")

auto_test(
    code_path="src",
    test_path="tests"
)
Loading required package: compiler
.1.2

1\. Error: test_getName_ref,.self=MyClass ---------------------------------------
could not find function "getName_ref"
1: expect_that(x.test <- .self$getName(), is_a("character"))
2: condition(object)
3: str_c(class(x), collapse = ", ")
4: Filter(function(x) length(x) > 0, list(...))
5: sapply(x, f)
6: lapply(X = X, FUN = FUN, ...)
7: .self$getName()

2\. Error: test_setName_ref,.self=MyClass ---------------------------------------
could not find function "setName_ref"
1: expect_that(.self$setName(value = x.target), is_identical_to(TRUE))
2: condition(object)
3: all.equal(expected, actual)
4: all.equal.default(expected, actual)
5: all.equal.raw(target, current, ...)
6: attr.all.equal(target, current, ...)
7: mode(current)
8: .self$setName(value = x.target) 
```

我的第一个猜测是，这可能与`testthat::source_dir()`处理采购的方式有关，可能是由于争论`env`？

为了继续，我们需要使用 CRTL + BREAK 关闭自动测试（在 Windows 上；如果您在其他平台上，请参阅[本文中的“自动测试”部分）](http://journal.r-project.org/archive/2011-1/RJournal_2011-1_Wickham.pdf)

现在，当我们第一次手动获取代码并运行`test_dir()`时，一切似乎都运行良好：

```
require("testthat")

sapply(list.files("src", full.names=TRUE), source)

test_dir("tests")

......
You are a coding rockstar! 
> 
```

# iphone - Pageviewcontroller 在 IOS 6 中不显示翻页动画

> ID：13128063
> 
> 赞同：0
> 
> 时间：2012-10-29T19:08:29.040
> 
> 标签：iphone, ipad, ios6, uipageviewcontroller

我已经构建了一个基于 pageviewcontroller 的 iPad 应用程序，其中包含每个页面上的图像和文本。它是一个简单的应用程序。

我已禁用页面上的选项卡。我只允许使用此代码滑动翻页

```
self.view.gestureRecognizers = self.pageViewController.gestureRecognizers; 
UIGestureRecognizer* tapRecognizer = nil;
for (UIGestureRecognizer* recognizer in self.pageViewController.gestureRecognizers) {
    if ( [recognizer isKindOfClass:[UITapGestureRecognizer class]] ) {
        tapRecognizer = recognizer;
        break;
    }
}

if ( tapRecognizer ) {
    [self.view removeGestureRecognizer:tapRecognizer];
    [self.pageViewController.view removeGestureRecognizer:tapRecognizer];
} 
```

我还禁用了风景模式。该应用程序仅支持纵向模式。

一切正常，我唯一遇到的问题是该应用程序没有在 IOS 6 上显示翻页动画。当您在没有动画的情况下滑动时，它只是替换了页面视图。但该应用程序运行良好，并显示所有低于 ios 6 的翻页和翻页动画版本。

我注意到的另一件事是，当我向右滑动（返回页面）时，我可以看到动画，但是当我开始滑动并停止在屏幕中间并按住页面时，动画开始用我的手指转动并在我的手指中间停止动画停止，但该应用程序已经删除了我以前的页面视图，并在后面向我显示了空白的 bg 屏幕。当我向左滑动（向前翻页）时，当我移动手指时，应用程序没有显示动画，但是当我启动 mt finger 时，它会用下一页视图替换视图，并且当我在该应用程序调用 pageViewController: didFinishAnimating: 后完成向左滑动时，即表示它正在制作动画但不显示它。

请帮忙 ：（

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T08:20:50.740

我在以编程方式导航时遇到类似的问题，有时我会收到“对 <DataViewController: 0x32fcd532> 的开始/结束外观转换的不平衡调用”，经过一些研究后，我发现此消息表明新转换开始而前一个尚未完成.
我通过不带动画的导航解决了这个问题。

# c - 灵活数组、最优空间、索引错误

> ID：13128064
> 
> 赞同：1
> 
> 时间：2012-10-29T19:08:29.247
> 
> 标签：c, arrays, algorithm, testing

我正在用 C 实现一个灵活的数组。所有想法都基于这个小[论文](https://cs.uwaterloo.ca/research/tr/1999/09/CS-99-09.pdf)。我的错误在于索引操作。被黑客入侵太久了，无法承认。要求有知识的头脑和眼睛。

**概述**：数据结构由 1 个平面索引块组成，其中包含指向数据块的指针。每个数据块的大小为 2^(k/2)。其中 k 是前导设置位。所以当我搜索元素“i”时，k 是 log_2(i+1)。

```
index = { 
    [0], -> [0]
    [2],  -> [0,1]
    [2],  -> [0,1]
    [3],  -> [0,1,2,3]
    [4],  -> [0,1,2,3]
    ....} 
```

每个数据块的大小由它所聚集的“超级块”决定。其中一个超级块由相同大小的数据块组成。所以。索引 1,2 在同一个超级块（超级块 1）中。而 0（超级块 0）和索引 3（超级块 2）则不是。

最终每个超级块都有 2^(floor(k/2)) 个数据块，每个数据块的大小为 2^(ceil(k/2))。

**问题** 当 r = 2 的幂时，索引会跳过应该是什么。就像我搜索 3 它应该是`index [2][0]`，而不是它的`index[3][0]`. 为什么会这样？有什么办法可以避免吗？我没有看到“关闭 1”错误吗？

**这里的代码** 是单个 main 函数[testcase](https://gist.github.com/3975639)，它清晰简单，在尝试获取索引 3 处的元素时失败；

定位索引 i 的简化代码如下：

```
/* Edited from the actual test case for extra clarity */
/* all vars int */
r= i+1
k = first_set_bit(r) - 1;   // ex: r = 5, 5 = "00000101"b so k is (3-1) = 2

b = first_subset_of_r(floor(k/2)); // floor(k/2) bits of r immediately after first set; 
e = last_subset_of_r(ceil(k/2); // last ceil(k/2) bits of r 
p = (1 << k) -1 ; // 2^k -1
// Index supposed to be found with. . .
return index[p+b][e]; 
```

这是一些真实的输出，首先通过索引和数据块打印数组的内容，然后 4 的输出尝试进入索引

第一部分转储二维数组，其中 bar 之前的数字是索引块的索引，之后的部分是索引块指向的数组中包含的元素。所有数组都是零索引的。

```
[clemensm@gaia:23]> ./a.out 
Index block |  element number (Not it's index!)
0 | 0   
1 | 1   2   
2 | 3   4   
3 | 5   6   
4 | 7   8   9   10  
5 | 11  12  13  14  
6 | 15  16  17  18  
7 | 19  20  21  22  
8 | 23  24  25  26  
9 | 27  28  29  30  
10 | 31  32  33  34  35  36  37  38  
11 | 39  40  41  42  43  44  45  46  
12 | 47  48  49  50  51  52  53  54  
13 | 55  56  57  58  59  60  61  62  
14 | 63  64  65  66  67  68  69  70  
15 | 71  72  73  74  75  76  77  78  
16 | 79  80  81  82  83  84  85  86  
17 | 87  88  89  90  91  92  93  94  
18 | 95  96  97  98  99  100 101 102 
19 | 103 104 105 106 107 108 109 110 
Finished element dump

Trying to get 0
R: [1]b
k/2=[0], Ceil(k,2)=[0]
K: [0] is the leading 1 bit
B: [0]
E: [0]
P: [0] data blocks prior to our superblock
p+b,e : [0,0] 

Trying to get 1
R: [10]b
k/2=[0], Ceil(k,2)=[1]
K: [1] is the leading 1 bit
B: [0]
E: [0]
P: [1] data blocks prior to our superblock
p+b,e : [1,0] 

Trying to get 2
R: [11]b
k/2=[0], Ceil(k,2)=[1]
K: [1] is the leading 1 bit
B: [0]
E: [1]
P: [1] data blocks prior to our superblock
p+b,e : [1,1] 

Trying to get 3
R: [100]b
k/2=[1], Ceil(k,2)=[1]
K: [2] is the leading 1 bit
B: [0]
E: [0]
P: [3] data blocks prior to our superblock
p+b,e : [3,0] 
a.out: test_array.c:81: main: Assertion `get_index(3)==3' failed.
Abort (core dumped) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T23:55:04.887

只是为了搜索引擎和清晰，论文名称：`Resizable Arrays in Optimal Time and Space`
就我从论文中看到的，你可以在这里做一个非常基本的体验。即使它看起来很漂亮，也可能有错误。

定位算法显然是错误的。第 3 行声称要计算之前的数据块数，`SB_k`这种方式是行不通的。您已经在上面的示例中看到了这一点。

我建议自己找出公式，然后继续阅读。

我的分析表明了这个公式：

```
p = 2^(k/2 + 1) - 2 + (k mod 2) * 2^(k/2) # "/" indicates integer division 
```

示例代码：

```
int max = 20;
for (int k = 0; k < max; k++)
    System.out.println("k=" + k + " - data blocks: " + Math.pow(2, k/2) + " - data blocks size: " + Math.pow(2, Math.ceil(k/2.0)));
System.out.println();

for (int i = 0; i < max; i++) {
    String r = Integer.toBinaryString(i + 1);
    int k = r.length() - 1;
    String b_bin = r.substring(1, 1 + k/2);
    int b = Integer.parseInt("0" + b_bin, 2);
    String e_bin = r.substring((int)Math.ceil(k / 2.0));
    int e = Integer.parseInt("0" + e_bin, 2);
    int p = (1 << (k/2 + 1)) - 2 + (k & 1) * (1 << (k/2));
    int db = p + b;
    System.out.println("i=" + i + ", r=" + r + ", k=" + k + ", b_bin=" + b_bin + ", b=" + b + ", e_bin=" + e_bin + ", e=" + e + ", p=" + p + ", db=" + db);
} 
```

样本结果：

```
k=0 - data blocks: 1.0 - data blocks size: 1.0
k=1 - data blocks: 1.0 - data blocks size: 2.0
k=2 - data blocks: 2.0 - data blocks size: 2.0
k=3 - data blocks: 2.0 - data blocks size: 4.0
k=4 - data blocks: 4.0 - data blocks size: 4.0
k=5 - data blocks: 4.0 - data blocks size: 8.0
k=6 - data blocks: 8.0 - data blocks size: 8.0
k=7 - data blocks: 8.0 - data blocks size: 16.0
k=8 - data blocks: 16.0 - data blocks size: 16.0
k=9 - data blocks: 16.0 - data blocks size: 32.0
k=10 - data blocks: 32.0 - data blocks size: 32.0
k=11 - data blocks: 32.0 - data blocks size: 64.0
k=12 - data blocks: 64.0 - data blocks size: 64.0
k=13 - data blocks: 64.0 - data blocks size: 128.0
k=14 - data blocks: 128.0 - data blocks size: 128.0
k=15 - data blocks: 128.0 - data blocks size: 256.0
k=16 - data blocks: 256.0 - data blocks size: 256.0
k=17 - data blocks: 256.0 - data blocks size: 512.0
k=18 - data blocks: 512.0 - data blocks size: 512.0
k=19 - data blocks: 512.0 - data blocks size: 1024.0

i=0, r=1, k=0, b_bin=, b=0, e_bin=1, e=1, p=0, db=0
i=1, r=10, k=1, b_bin=, b=0, e_bin=0, e=0, p=1, db=1
i=2, r=11, k=1, b_bin=, b=0, e_bin=1, e=1, p=1, db=1
i=3, r=100, k=2, b_bin=0, b=0, e_bin=00, e=0, p=2, db=2
i=4, r=101, k=2, b_bin=0, b=0, e_bin=01, e=1, p=2, db=2
i=5, r=110, k=2, b_bin=1, b=1, e_bin=10, e=2, p=2, db=3
i=6, r=111, k=2, b_bin=1, b=1, e_bin=11, e=3, p=2, db=3
i=7, r=1000, k=3, b_bin=0, b=0, e_bin=00, e=0, p=4, db=4
i=8, r=1001, k=3, b_bin=0, b=0, e_bin=01, e=1, p=4, db=4
i=9, r=1010, k=3, b_bin=0, b=0, e_bin=10, e=2, p=4, db=4
i=10, r=1011, k=3, b_bin=0, b=0, e_bin=11, e=3, p=4, db=4
i=11, r=1100, k=3, b_bin=1, b=1, e_bin=00, e=0, p=4, db=5
i=12, r=1101, k=3, b_bin=1, b=1, e_bin=01, e=1, p=4, db=5
i=13, r=1110, k=3, b_bin=1, b=1, e_bin=10, e=2, p=4, db=5
i=14, r=1111, k=3, b_bin=1, b=1, e_bin=11, e=3, p=4, db=5
i=15, r=10000, k=4, b_bin=00, b=0, e_bin=000, e=0, p=6, db=6
i=16, r=10001, k=4, b_bin=00, b=0, e_bin=001, e=1, p=6, db=6
i=17, r=10010, k=4, b_bin=00, b=0, e_bin=010, e=2, p=6, db=6
i=18, r=10011, k=4, b_bin=00, b=0, e_bin=011, e=3, p=6, db=6
i=19, r=10100, k=4, b_bin=01, b=1, e_bin=100, e=4, p=6, db=7 
```

编辑：有关公式方式的更多详细信息

如何获得公式（我建议阅读每一步并考虑是否可以自己继续，如果不能继续踩）：
论文说：`"When superblock SB_k is fully allocated, it consists of 2^floor(k/2) data blocks"`

如果我们想要 SB_k 之前的数据块数，我们必须对所有数据块求和：

```
p = sum from i=0 to k-1 over 2^floor(i/2) 
```

我们现在可以使用它，这是一个明确的 for 循环语句。但是让我们把它作为一个单一的计算。
如果您考虑总和，由于地板的原因，它每 2^i 两次求和。这对所有偶数 k 都是正确的，因为总和 max 是不均匀的，因此我们有`floor((k-2)/2) = floor((k-1)/2)`。对于奇数 k，我们只有一个数字，我们必须单独关心这个。

所以，我们现在有：

```
(2 * sum from i=0 to floor((k-2)/2) over 2^i) + (k mod 2)*2^k/2 
```

（如果您需要更多详细信息，请为 k=6,7,8 制作一些示例）

现在，我们可以清楚地摆脱总和，因为我们知道`sum from i=0 to n over 2^i = 2^(n+1) - 1`（这是一个基本的数学/cs 证明。您可以从二进制表示中清楚地看到正确性）。我们使用这个公式得到：

```
2 * (2^(floor((k-2)/2) + 1) - 1) + (k mod 2)*2^k/2 
```

现在，我们可以乘以 2，修改指数，我们就完成了：

```
2^(floor(k/2) + 1) - 2 + (k mod 2)*2^k/2 
```

我希望这有帮助。

# shell - Logrotate 和 Shell 脚本

> ID：13128066
> 
> 赞同：0
> 
> 时间：2012-10-29T19:08:44.263
> 
> 标签：shell, logrotate

给定目录中的日志文件，如下所示：

```
log_from_2012_08_14-11:57:21_To_2012_09_14-11:56:12.zip
log_from_2012_10_14-11:57:21_To_2012_11_14-11:56:12.zip

```

鉴于大约有 155450 个这样的文件，我怎样才能以简单或有效的方式执行以下操作：

使用 logrotate 或其他工具为每个月创建一个文件夹：例如，mkdir $currentMont = october，然后将所有 2012 年 10 月的文件放在那里，依此类推，每个月。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T20:23:22.697

听起来像一个带有几个嵌套 for 循环的 bash 脚本就可以解决问题。

就像是：

```
for year in $(seq -f "%02g" 0 20); do
    for month in $(seq -f "%02g" 0 12); do
        dest = "20${year}-${month}"
        mkdir "$dest"
        mv "log_from_${dest}*" "${dest}";
    done;
done; 
```

显然，您需要根据自己的需要进行调整。如果一个目录中有太多文件，您可能会遇到行 glob 限制，在这种情况下，您必须使用它`find . | xargs mv`来避免该问题。

# java - Java双URL阅读器？

> ID：13128067
> 
> 赞同：0
> 
> 时间：2012-10-29T19:08:53.017
> 
> 标签：java

任何人都可以帮助我使用 Java URL 阅读器吗？

我在 Java 中创建了一个 URL 阅读器，它读取链接并将其发送到特定文件。如何从两个 URL 读取代码并将其保存到特定文件中？

这是我的代码：

```
import java.net.*;
import java.io.*;

public class URLReader {

public static void main(String[] args) throws Exception {

    URL oracle = new URL("http://www.oracle.com/");
    URLConnection yc = oracle.openConnection();
    BufferedReader in = new BufferedReader(new InputStreamReader(
    yc.getInputStream()));

    String inputLine;
    BufferedWriter psout = new BufferedWriter(new FileWriter("D:\\final.txt"));
    while ((inputLine = in.readLine()) != null) {
    psout.write(inputLine);
    System.out.println(inputLine);
    }
    in.close();
    psout.close();
   }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T19:19:20.820

如果您打算写入单个文件，则可以将其提取到一个方法中并使用`append`in 参数`FileWriter`：

```
private static void saveURL(String urlString) throws MalformedURLException, IOException {
   URL url = new URL(urlString);
   URLConnection yc = url.openConnection();
   BufferedReader in = new BufferedReader(new InputStreamReader(yc.getInputStream()));

   String inputLine;
   BufferedWriter psout = new BufferedWriter(new FileWriter("final.txt", true));

   // write file...

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T19:25:42.017

如果我理解您的问题，您想将两个不同 URL 的内容写入同一个文件。您可以拥有一个 URL 对象列表，然后从列表中读取/写入迭代。

```
List<URL> al = new ArrayList<>();
      URL oracle = new URL("http://www.oracle.com/");
      URL google =new  URL("http://www.google.com");
      al.add(oracle);
      al.add(google);
      BufferedReader in=null;
      BufferedWriter psout=null;
      for(URL url: al){
      URLConnection yc = url.openConnection();
      in = new BufferedReader(new InputStreamReader(
      yc.getInputStream()));
      String inputLine;
     psout = new BufferedWriter(new FileWriter("final.txt"));
      while ((inputLine = in.readLine()) != null) {
      psout.write(inputLine);
      System.out.println(inputLine);
      }

      }      in.close();
      psout.close(); 
```

# php - 使用 PHP 处理块中的数组

> ID：13128068
> 
> 赞同：0
> 
> 时间：2012-10-29T19:08:59.647
> 
> 标签：php, for-loop, foreach

这是我需要帮助的数组示例（我们称之为 $MY_ARRAY）

```
Array ( 
[0] => Array ( [NAME] => 1351449606472 [EMAIL] => aaa@yadda.com [ID] => 996774000001224477 ) 
[1] => Array ( [NAME] => 1351449605330 [EMAIL] => bbb@yadda.com [ID] => 996774000001224473 ) 
[2] => Array ( [NAME] => 1351449604318 [EMAIL] => ccc@yadda.com [ID] => 996774000001224469 ) 
[3] => Array ( [NAME] => 1351449603089 [EMAIL] => ddd@yadda.com [ID] => 996774000001224465 ) 
[4] => Array ( [NAME] => 1351449602046 [EMAIL] => eee@yadda.com [ID] => 996774000001224461 ) 
[5] => Array ( [NAME] => 1351449600883 [EMAIL] => fff@yadda.com [ID] => 996774000001224457 ) 
[6] => Array ( [NAME] => 1351449599840 [EMAIL] => ggg@yadda.com [ID] => 996774000001224453 )  
) 
```

我知道如何使用 foreach 完成此操作，如下所示：（注意：已编辑以显示我实际在做什么，但以简化问题为代价）。

```
$aws = curl_init();
$url = "https://email.us-east-1.amazonaws.com/";
curl_setopt($aws, CURLOPT_URL, $url);
curl_setopt($aws, CURLOPT_RETURNTRANSFER, true);
//process data
foreach($MY_ARRAY as $X) 
{
    //set-up email
    $MY_ARRAY = $X['EMAIL'];
    $ID = $X['ID'];
    $SUBSCRIBER_ENCODE = rawurlencode($SUBSCRIBER);
    $HELLO = "";
    if (strlen($X['NAME']) == 0)
    {
        $HELLO = "Subscriber,<br /><br />";
    }
    else
    {
        $HELLO = $X['NAME'].",<br /><br />";
    }
    $EMAIL_BODY_ENCODE = rawurlencode($HELLO.$BODY);
    //tune curl vars
    $DATE = gmdate('D, d M Y H:i:s e');
    $HASH = hash_hmac('sha1', $DATE, $AWSPRI, true);
    $KEYS = base64_encode($HASH);
    $headers = array();
    $headers[] = "Host: email.us-east-1.amazonaws.com";
    $headers[] = "Content-Type: application/x-www-form-urlencoded";
    $headers[] = "Date: ".$DATE;
    $auth = "AWS3-HTTPS AWSAccessKeyId=".$AWSPUB;
    $auth .= ",Algorithm=HmacSHA1,Signature=".$KEYS;
    $headers[] = "X-Amzn-Authorization: ".$auth;
    $MAIL = "Action=SendEmail&Source=".$XROM_ENCODE."&ReturnPath=".$BOUNCE_ENCODE."&Destination.ToAddresses.member.1=".$SUBSCRIBER_ENCODE."&Message.Subject.Data=".$SUBJECT_ENCODE."&Message.Body.Html.Data=".$EMAIL_BODY_ENCODE;
    curl_setopt($aws, CURLOPT_POSTFIELDS, $MAIL);
    curl_setopt($aws, CURLOPT_HTTPHEADER, $headers);
    $resp = curl_exec($aws);
}
//complete log and close curl
curl_close($aws); 
```

所以我想要的是一次通过三个数组。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T19:24:54.930

好的，如果我不了解需要，我认为我对问题的理解足以回答。可能有很多方法可以做到这一点。一种方法可能是

```
// make array into an array of little arrays
$littleArrays = array_chunk($input_array, 3);
// now we loop through outer array
for($i=0;$i<sizeof($littleArrays);$i++){
    // now we loop through the inner arrays
    for($j=0;$j<sizeof($littleArrays[$i]);$j++){
       mail($littleArrays[$i][$j]['EMAIL'], "Example Subject", "Hello ".$littleArrays[$i][$j]['name']);
    }
} 
```

如果我理解正确的话。可能有更快或更好的方法。我认为这是一个非正统的解决方案，因为我不明白您当时为什么要发送 3 个。

请注意，这不是一个完整的解决方案......例如，如果数组长度不能被 3 整除，它会出错......

考虑到这一点，第一条评论是最好的解决方案[ARRAY CHUNK - PHP.NET](http://php.net/array_chunk)

编辑：解决方案更改为使用带有简单 for 循环的 array_chunk 来导航它们。

# struts2 - 拦截器阻止将 URL 参数传递给操作

> ID：13128071
> 
> 赞同：2
> 
> 时间：2012-10-29T19:09:09.467
> 
> 标签：struts2, interceptor

我有一个 LoginInterceptor 在大多数操作之前运行并检查成员是否登录。如果是，则显示该页面，否则将其重定向到登录页面。

但是我刚刚注意到拦截器“阻止”了所有 URL 参数。基本上，如果在一个动作之前有一个拦截器，这个动作的 URL 参数将不会传递给 setter。

这是我的拦截器：

```
public class LoginInterceptor extends AbstractInterceptor {
    public String intercept(final ActionInvocation invocation) throws Exception {
        final String REDIR = "loginRedirect";
        AuthenticationService auth = new AuthenticationService();
        if (auth.isMemberLoggedIn()) {
            return invocation.invoke();
        } else {
            return REDIR;
        }
    }
} 
```

我怀疑`invocation.invoke()`调用动作，但没有参数。

我能做些什么呢？

更新：

**AuthenticationService.isMemberLoggedIn()**

```
public boolean isMemberLoggedIn() {
    Map<String, Object> session = ActionContext.getContext().getSession();
    String username = (String) session.get("username");
    if (username != null) {
        return true;
    } else {
        return false;
    }
} 
```

**struts.xml**

```
<package name="global" extends="struts-default">
    <interceptors>
        <interceptor name="loginInterceptor" class="community.interceptor.LoginInterceptor" />
    </interceptors>
    <global-results>
        <result name="loginRedirect" type="redirect">/members/login</result>
    </global-results>
</package> 
```

然后每个包扩展`global`，我在每个动作中调用它们：

```
<interceptor-ref name="loginInterceptor" /> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-29T19:41:22.507

如果你的拦截器栈不包含`params`拦截器，那么就会出现这个问题。您应该按照以下方式配置您的堆栈：

```
 <interceptors>
           <interceptor name="loginInterceptor" class="community.interceptor.LoginInterceptor" />
           <interceptor-stack name="customDefaultStack">
                <interceptor-ref name="i18n"/>
                <interceptor-ref name="loginInterceptor"/>
                <interceptor-ref name="prepare"/>
                <interceptor-ref name="modelDriven"/>
                <interceptor-ref name="fileUpload"/>
                <interceptor-ref name="checkbox"/>
                <interceptor-ref name="multiselect"/>
                <interceptor-ref name="params">
                    <param name="excludeParams">dojo\..*,^struts\..*,^session\..*,^request\..*,^application\..*,^servlet(Request|Response)\..*,parameters\...*</param>
                </interceptor-ref>
                <interceptor-ref name="conversionError"/>
                <interceptor-ref name="validation">
                    <param name="excludeMethods">input,back,cancel,browse</param>
                </interceptor-ref>
                <interceptor-ref name="workflow">
                    <param name="excludeMethods">input,back,cancel,browse</param>
                </interceptor-ref>
            </interceptor-stack>
        </interceptors>

        <default-interceptor-ref name="customDefaultStack"/> 
```

或者，您可以扩展开箱即用的堆栈：

```
 <interceptors>
           <interceptor name="loginInterceptor" class="community.interceptor.LoginInterceptor" />
           <interceptor-stack name="customDefaultStack">
                <interceptor-ref name="loginInterceptor"/>
                <interceptor-ref name="defaultStack"/>
            </interceptor-stack>
        </interceptors>

        <default-interceptor-ref name="customDefaultStack"/> 
```

# mysql - 如何在 MySQL 查询中获取给定月份的第 N 个工作日的日期？

> ID：13128072
> 
> 赞同：1
> 
> 时间：2012-10-29T19:09:26.107
> 
> 标签：mysql, date, weekday

我已经搜索了答案，虽然我发现在线回答了类似的问题，但我一直无法将它们用于我的目的。我需要帮助。

我正在构建一个支持重复事件的日历。我快完成了，但最后一块是最艰难的。我需要能够支持每 Y 个月的第 N 个 X 发生的事件，其中 X 是给定的工作日，Y 是几个月。

我已经弄清楚了“每 Y 个月”部分（这是下面查询段中的第二行到最后一行）。我只需要得到“第N个工作日”。

我发现有人创建的一个 PHP 脚本声称可以很好地解决这个问题，我打算使用它，但后来我意识到这必须完全在 MySQL 查询中完成，因为指定获取日期的工作日的值是db 记录，我无法让它们在主查询之外使用。

这是查询的一部分，因此您可以了解我的目标：

```
WHEN event_recurring_pattern_type = 'monthly' AND event_recurring_monthly_type = 'dayxofeveryxmonths' THEN
    MOD(PERIOD_DIFF(CONCAT(event_date_year,event_date_month), CONCAT('$date_year','$date_month')), event_recurring_monthly_dayofeveryxmonths) = 0
    AND event_recurring_monthly_dayx = '$date_day'

WHEN event_recurring_pattern_type = 'monthly' AND event_recurring_monthly_type = 'thexweekdayofeveryxmonths' THEN
    MOD(PERIOD_DIFF(CONCAT(event_date_year,event_date_month), CONCAT('$date_year','$date_month')), event_recurring_monthly_dayofeveryxmonths) = 0
    AND '$date_timestamp' = {the date of the Nth weekday of $date_month} 
```

最后一行应该将日历的当前输出日期（因为它一次构建日历一天）与我们在输出过程中所处月份的第 N 个工作日的日期进行比较。当它们匹配时，该事件将输出到日历上。

$date_timestamp 在这种情况下是 'YYYY-MM-DD' 格式的当前输出日期，因此我获得日期的第 N 个工作日也应该采用该格式。

如果我没有提供足够的信息，或者如果这在其他地方得到了充分的回答，请告诉我。我之前的一个问题是“关闭”的，因为有些人认为它太模糊或没有提供足够的信息，即使我提供了与我的问题相关的大量信息并且仍然得到了一个完全可以接受的答案来解决我的问题。如有必要，在执行负面行动之前，给我一个改进问题的机会。

提前致谢。

哦，是的，如果可以进一步创建它以选择性地获取给定月份的最后一个指定的工作日，那就更好了。PHP 脚本做到了，但就像我说的，这次我不能用 PHP 做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T20:09:49.260

使用**[DAYOFWEEK()](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_dayofweek)**：

```
WHEN event_recurring_pattern_type = 'monthly'
 AND event_recurring_monthly_type = 'thexweekdayofeveryxmonths'
THEN MOD(
       PERIOD_DIFF(
         CONCAT(event_date_year,event_date_month),
         CONCAT('$date_year','$date_month')
       ), event_recurring_monthly_dayofeveryxmonths
     ) = 0
 AND DAYOFWEEK('$date_timestamp') = event_recurring_monthly_dayofweek 
```

以上假设添加了`event_recurring_monthly_dayofweek`列，但您可以轻松地重新使用该`event_recurring_monthly_dayx`列来存储星期几整数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T18:03:00.340

我将尝试这个（尚未在该领域得到证明）：

```
 SET @target = DATE('2013-06-15');
SELECT  1 + ( 
 IF( MONTH(DATE_SUB( @target, INTERVAL  7 DAY)) = MONTH(@target), 1, 0) +
 IF( MONTH(DATE_SUB( @target, INTERVAL 14 DAY)) = MONTH(@target), 1, 0) +
 IF( MONTH(DATE_SUB( @target, INTERVAL 21 DAY)) = MONTH(@target), 1, 0) +
 IF( MONTH(DATE_SUB( @target, INTERVAL 28 DAY)) = MONTH(@target), 1, 0) ) AS nth_weekday_of_month; 
```

它似乎相对较快，但您始终可以使用此功能创建一个预填充的表（几年后，或由 crons 等创建）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T19:28:02.323

最简单的方法是编写一个程序，用您需要的信息填充一个新表。它不需要一张非常大的桌子就能在未来走很长的路。然后只需加入查询中的表即可。

# arrays - OpenGL折叠/减少实现？

> ID：13128075
> 
> 赞同：5
> 
> 时间：2012-10-29T19:09:41.087
> 
> 标签：arrays, opengl, functional-programming, gpgpu

我已经弄清楚如何通过使用变换反馈（或通过渲染到纹理）将高阶函数[映射](http://en.wikipedia.org/wiki/Map_%28higher-order_function%29)和[过滤转换为 OpenGL 代码。](http://en.wikipedia.org/wiki/Filter_%28higher-order_function%29)我也希望能够使用[fold](http://en.wikipedia.org/wiki/Fold_%28higher-order_function%29)，但我不知道这将如何工作。让我们假设该操作是关联的，所以我不在乎它是左折叠还是右折叠或一些不确定的混合。

折叠操作示例：

*   计算包含一组点的最小 AABB（折叠顶点数组）。
*   计算纹理中最亮的值（折叠纹理）。

或者如果没有 OpenCL 或 CUDA，这不可行吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T13:18:03.077

如果您的操作是关联的，您可以通过重复渲染到较小的纹理来减少/折叠数据。在每一遍中，你结合了前一遍中的一些纹素。您可以通过将其绑定为片段着色器的纹理来读取上一次传递的数据。

例如，如果您想计算 128x128 值的图像的平均值，您可以首先渲染到 64x64 的纹理，其中目标纹理中的每个纹素在输入纹理中平均 4 个纹素。

一个典型的例子是模糊图像。

# javascript - 如何隐藏在透明 div 下滚动的内容？

> ID：13128079
> 
> 赞同：2
> 
> 时间：2012-10-29T19:09:44.583
> 
> 标签：javascript, jquery, html, css

你有两个 div，一个在另一个之上，顶部的一个是透明的。*但是，当您滚动时，您希望底部的 div 在它位于第一个透明*div下方时隐藏。

您不希望第二个 div在进入第一个 div 后立即`display:`更改`none;`为。您只希望隐藏下面的部分。

我已经广泛搜索了答案：

[1）隐藏透明标题下的滚动内容](https://stackoverflow.com/questions/9688079/transparent-static-header-would-like-to-not-end-up-with-text-showing-under-the-h)

[2) 滚动页面时透明固定位置 div 后面的可滚动内容](https://stackoverflow.com/questions/6529421/hide-scrollable-content-behind-transparent-fixed-position-divs-when-scrolling-th)

[3) 在透明标题 Div 下滚动正文](https://stackoverflow.com/questions/5492375/scrolling-body-underneath-a-transparent-header-div)

[4）透明的静态标题不希望滚动时在标题下显示文本](https://stackoverflow.com/questions/9688079/transparent-static-header-would-like-to-not-end-up-with-text-showing-under-the-h)

[5）在固定透明页眉滚动背景下隐藏滚动内容](https://stackoverflow.com/questions/11287575/hide-scrolling-content-under-fixed-transparent-header-scroll-background)

#1-4 答案使 div 位于顶部`background: inherit`或`background-image: url('background_image.jpg)'`. 对我来说，这个问题是我的背景是一张照片，即当你向下滚动时，你看到的是不同的，而不是颜色或图案。透明 div 的“背景”需要随着真实背景的变化而变化。

#5 使用 JQuery 提供了一个解决方案，但是在浏览器而不是 Firefox 中存在滚动滞后的可怕问题。

各位，我该怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T22:33:42.153

没有 JavaScript 就无法做到这一点。对于不通过透明层显示的内容，它根本不能被渲染——你需要使用`overflow:hidden`. 问题是如果内容随页面滚动，则无法修复内容的边缘。元素可以相对于视口或相对于页面定位，但不能同时定位。

# android - And + Eclipse：如何将主活动更改为子活动

> ID：13128080
> 
> 赞同：1
> 
> 时间：2012-10-29T19:09:53.710
> 
> 标签：android, eclipse, main-activity

菜鸟警报！我将当前的应用程序作为运行主程序的简单测试活动启动。我现在想把它变成一个合适的应用程序，它需要一个主菜单作为 main_activity 来调用具有适当参数的子活动。

我习惯于简单的编码，您只需重命名文件，但在 Eclipse 中，您需要以我注意到的特定方式做事。那么将我当前的 main_activity 转移到较低级别并替换 main_activity 的正确程序是什么？是否只是创建较低的活动，然后复制/粘贴代码和 .xml 文件，然后覆盖 main_activity 的情况？或者我应该以特定顺序重构事物以保持清单等有序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T20:59:11.470

你的问题有点令人困惑，我不是 100% 确定这是回答它，但这里有一些花絮：

您的“主要”活动（进入应用程序）由在 AndroidManifest.xml 中提供 LAUNCHER 意图过滤器的活动确定

在该文件中，您将看到一个带有添加行的活动

```
 <intent-filter>
        <action android:name="android.intent.action.MAIN" />
        <category android:name="android.intent.category.LAUNCHER" />
    </intent-filter> 
```

这表示无论这是哪个活动 - 在点击应用程序图标时启动它。

没有真正的子活动（至少不是你谈论它们的方式）。活动代表向用户显示的不同屏幕，并使用 Intent 调用另一个屏幕。如果您想将数据传递给被调用的 Activity，请查看 Intent.putExtra 和/或 Bundles。

至于重命名，只需在 Eclipse 中右键单击源文件并选择 refactor->rename。这将 grep 您的项目并查找/替换您对旧名称的所有使用。

# javascript - 将 div 放在其上时，链接不起作用

> ID：13128082
> 
> 赞同：0
> 
> 时间：2012-10-29T19:09:59.490
> 
> 标签：javascript, jquery, html, css

我有以下情况需要帮助（HTML/CSS/JS 相关）

我有一个带有图像的 div（占据所有 div 空间），当您将鼠标悬停在它上面时，另一个带有图像的 div 会显示在其顶部（第二个 div 是半透明的）。底部图像有一个链接。此链接不起作用，因为它上面有新的半透明 div。

我怎样才能使链接工作？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T19:11:32.470

您需要为顶部图像提供相同的链接。

# android - 通过长按主页按钮启动应用程序始终会重新启动应用程序而不是将其置于前台

> ID：13128087
> 
> 赞同：1
> 
> 时间：2012-10-29T19:10:14.253
> 
> 标签：android

我的应用有两个活动，ActivityA 和 ActivityB。它们在下面的 AndroidManifest 中指定：

```
<activity android:name=".ActivityA" android:label="@string/app_name" android:screenOrientation="landscape" 
    android:configChanges="orientation|keyboardHidden|screenSize">
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
</activity>
<activity android:name=".ActivityB" 
    android:screenOrientation="landscape" android:configChanges="orientation|keyboardHidden|screenSize" 
    android:windowSoftInputMode="stateAlwaysHidden"/> 
```

问题的场景如下。

1.  我启动应用程序并显示 ActivityA。
2.  从 ActivityA，我启动 ActivityB 并关闭 ActivityA。现在任务栈只包含ActivityB。
3.  我按下主页按钮，然后手机进入主屏幕。
4.  我长按主页按钮，然后从历史记录中选择我的应用程序。
5.  第4步之后，ActivityA启动并显示，任务栈顶部有ActivityA，底部有ActivityB。

我在第 5 步很困惑。我期望的是，应用程序将以其现有的任务堆栈被带到前台，即任务堆栈中只有 ActivityB。为什么Android在第5步启动ActivityA？

顺便说一句，客户端日志在第 5 步包含以下消息：

10-26 21:29:04.070 V/HtcAppUsageStats（275）：（启动应用程序，包）：（MyApp，com.example.myapp）

10-26 21:29:04.070 I/ActivityManager（275）：开始活动：Intent { act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] flg=0x34500000 cmp=com.example.myapp /.ActivityA bnds=[0,566][540,662]（有附加功能）} 来自 pid 275

感谢您的任何建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T21:01:22.570

啊，我看到了这个 Android 错误，[http://code.google.com/p/android/issues/detail](http://code.google.com/p/android/issues/detail?id=26658) ?id=26658 。这似乎是根本原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-30T07:27:51.237

好的，所以如果你想让一个 Activity 不显示在长按主页按钮上：

1.  开始该活动`intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK); context.startActivity(intent);`

2.  在该活动的 android Manifest 中`android:excludeFromRecents="true"`

您也可以点击此[链接](http://www.zzzxo.com/q/answers-activity-launched-from-broadcast-receiver-keeps-in-recently-tasks-in-spite-of-12604620.html)这应该可以解决您的问题！

# xcode - 当前用户位置返回零值

> ID：13128089
> 
> 赞同：1
> 
> 时间：2012-10-29T19:10:18.383
> 
> 标签：xcode, mapkit, currentlocation

我使用全局变量（如下声明）作为纬度和经度，因为我需要在 .h 类的其他类中使用它们：

```
extern NSNumber *MYGlobalVariableLat;
extern NSNumber *MYGlobalVariableLong; 
```

然后在 .m 类中：

```
NSNumber *MYGlobalVariableLat;
NSNumber *MYGlobalVariableLong;

MYGlobalVariableLat = [NSNumber numberWithDouble:[(id)self.mapView.userLocation coordinate].latitude];

MYGlobalVariableLong = [NSNumber numberWithDouble:[mapView.userLocation coordinate].longitude];

NSLog(@"Lat %@",MYGlobalVariableLat);
NSLog(@"Long %@",MYGlobalVariableLong); 
```

那总是打印零，请帮助..

# jquery - 根据 Ruby on Rails 中的当前数据库记录更改元素内容

> ID：13128094
> 
> 赞同：0
> 
> 时间：2012-10-29T19:10:45.517
> 
> 标签：jquery, html, css, ruby-on-rails

请参考下图以了解外观。

我有一个名为“酱汁”的 ruby​​ on rails 数据库。

酱汁表中的字段如下：

*   ID
*   姓名
*   描述
*   图片

这是我的CSS：

```
#container{width:950px;height:800px;}
#title{this_is:irrelevant;}
#sauce_picture{bla bla}
#sauce_name{bla bla}
#sauce_splatter{background-image:url("someimage.png")} 
```

HTML

```
<html>
 <body>
  <div id="container>
   <div id="title><h1>SAUCES</h1></div>
   <div id="sauce_picture><img src="somepic.png/></div>
   <div id="sauce_name><h2>Sauce 1</h2></div>
   <div id="sauce_splatter>
     <p>Sauce Description Goes Here</p> 
   </div>
  </div>
 </body>
</html> 
```

好的，rails 数据库表有 6 条记录，每个字段都存在。我想要实现的是说页面已加载。我希望记录位于第一条记录，其中 , 的内容`<img src="somepic.png/>`全部`<h2>Sauce 1</h2>`从`<p>Sauce Description Goes Here</p>`数据库表中检索，因为计数从一开始。

我不知道如何做到这一点，以便当按下右箭头时，id 变为 2，并且上述内容更改为记录号 2（id=2）中存在的内容。

最后我将如何做到这一点，如果 id=1 （即第一条记录，左箭头作为链接被禁用，当最后一条记录出现时，右箭头被禁用。这可以通过使用更改元素来实现JQuery，但是我怎样才能同时使用 Rails 和 Jquery。

这样，如果我将来在数据库表中添加新的酱汁，我就不必更改任何代码，毕竟这就是 MCV 的全部意义所在。

谢谢

![图片](../Images/d2cd22d49c969dccf6c14284f37c9155.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T20:15:22.367

一个可能的解决方案，只要你的 Sauces-Table 没有很多条目，就是交出一个像

```
@sauces = Sauce.all 
```

默认情况下，您的视图可以呈现数组的一个条目，并且要更新 div，您需要编写一些 JavaScript 来跟踪实际选择的条目，并使用新选择的酱汁的属性更新 div。

对于更大的表，您可以使用 AJAX 从后端检索选定的酱汁，但您仍然需要通过 JavaScript 在异步调用结果上更新您的内容 div。

您还可以为每个酱汁条目呈现一个 div 并隐藏除要显示的实际之外的所有内容，按下按钮后，将显示带有所选酱汁的隐藏 div，另一个也将通过 JavaScript 设置为不可见

# javascript - 使用 javascript 获取相对 URL

> ID：13128095
> 
> 赞同：4
> 
> 时间：2012-10-29T19:10:51.453
> 
> 标签：javascript

有没有一种简单的方法可以使用 javascript 获取相对 url？我试图使用`window.location.href`，但它返回绝对路径。

我想做的是：我有两页；mobile.html 和 desktop.html。我想使用一个 javascript 文件来检测用户是在移动设备上还是桌面上（我知道，这不是一个很好的方法..），如下所示：

```
var is_mobile = //alot of text from http://detectmobilebrowsers.com/
                //that returns true/false, this works fine

if (is_mobile){

    if (window.location.href != "mobile.html"){
        window.location = "mobile.html";
    }
}

else {
    if (window.location.href != "desktop.html"){
        window.location ="desktop.html";
    }
} 
```

所以绝对路径的问题在于，在测试 mobile/desktop.html 时，它们都会进入无限循环 pagerefresh..

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-29T19:46:20.807

```
var page = window.location.pathname.split('/').pop();

if (isMobile && page !== 'mobile.html')
    window.location = 'mobile.html';
else if (!isMobile && page !== 'desktop.html')
    window.location = 'desktop.html'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T19:21:16.647

只需测试它是否以任一 HTML 文件结尾。您可以使用正则表达式：

```
if(/desktop\.html$/.test(window.location.href)) {
     // code for desktop
} else if(/mobile\.html$/.test(window.location.href)) {
     // code for mobile
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-29T19:37:51.200

找出 location.href 是否以 mobile.html 结尾的另一种解决方案，而不使用正则表达式：

```
if(window.location.href.indexOf("mobile.html") != (window.location.href.length - "mobile.html".length)) {
  ..
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-08-26T12:23:04.960

# `URL.getRelativeURL`

`URL`标准对象有一个防弹的公共域扩展名为**`getRelativeURL`**.

这将为您解决问题：

```
var loc = new URL(location.href); //get the current location
var dir = new URL(".", loc); //get the current directory
var rel = loc.getRelativeURL(dir); //relative link from dir to loc

if( rel !== "mobile.html" ){ ... } 
```

## [现场试一试。](http://jsbin.com/nodolu/edit?console,output) [查看要点。](https://gist.github.com/m93a/2553dd45de35aa05d0233c6f9dc04bc2)

# c - 为什么当我使用这种方法反向时会修改原始的双重链接？

> ID：13128098
> 
> 赞同：0
> 
> 时间：2012-10-29T19:10:57.093
> 
> 标签：c, pointers, doubly-linked-list

我正在尝试使用迭代方法来反转双向链表，即使我没有使用指向原始列表的指针样式修改的指针，我也对正在修改原始列表的部分感到震惊。

这是我正在使用的反向函数，`head`是在 main 中声明的局部变量，`Node* head = NULL;`并且已经填充了一组值。

```
Node* reverse_iterative(Node* head)
{
    if(head == NULL || head->next == NULL)
        return head;

    Node *prev, *current=head, *temp;
    while(current != NULL)
    {
        current->prev = current->next;
        current->next = temp;
        temp = current;
        current = current->prev;
    }
    return temp;
} 
```

这就是我在 main 中使用它的方式：

```
Node* rev = NULL;
rev = reverse_iterative(head); 
```

这是我得到的输出：

```
original list: 15 <=>25 <=>35 <=>45 <=>55 <=>65 <=>75 <=>
making the list actually reverse: 75 <=>65 <=>55 <=>45 <=>35 <=>25 <=>15 <=>
after reversing, the original list now: 15 <=> 
```

我无法获得修改原始头节点的部分。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T19:37:55.353

仔细查看您的 while 循环，并考虑以下*关于循环初始迭代的*语句：

```
current->next = temp; 
```

`temp`执行此任务时有什么内容？暴露更多代码，我们有：

```
Node *prev, *current=head, *temp;
while(current != NULL)
{
    current->prev = current->next;
    current->next = temp;
    temp = current;
    current = current->prev;
} 
```

请注意， temp 未初始化，因此是未定义的指针值。您原来的 head-ptr *next* ptr 被重置为保存在未初始化温度中的垃圾。

通过执行以下操作解决此问题：

```
Node *current=head, *temp=NULL;
while(current != NULL)
{
    temp = current->prev;
    current->prev = current->next;
    current->next = temp;
    temp = current;
    current = current->prev;
} 
```

我没有机会对其进行测试，但这应该可以让您更接近您正在寻找的东西。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-29T19:49:10.850

如果我理解正确，您根本不希望您的原始列表被修改。

但是循环修改了原始元素。例如，current 开始指向 head 元素，然后您修改它的 next 和 prev。这意味着现在修改了原始的 head 元素。

# jquery - jquery .load() 方法后 jScrollPane 不起作用

> ID：13128099
> 
> 赞同：0
> 
> 时间：2012-10-29T19:11:00.380
> 
> 标签：jquery, css, jscrollpane, jquery-jscrollpane

我正在使用 jScrollPane 在 div 上创建自定义滚动，它的内容通过 ajax 更新，使用 .load() 方法（jQuery）。

它适用于第一次将内容加载到 div 中，但是当我将内容加载到 div 时，div 仍然有溢出：隐藏，因此 jScrollPane 不会滚动新内容。我尝试像这样清除溢出属性：

```
$('#content .text').css('overflow', 'auto');
$('#content .text').jScrollPane(); 
```

但这使得内容 div 使用系统滚动，而不是自定义滚动。所以我尝试了这个：

```
$('#content .text').css('overflow', 'none');
$('#content .text').jScrollPane(); 
```

但是，我根本不相信它存在。所以我试着用这个来清理属性：

```
$('#content .text').css('overflow', '');
$('#content .text').jScrollPane(); 
```

但仍然没有成功。我还有其他方法可以做到吗？

*   我无法清除整个样式属性，因为我正在使用它来设置 div 的动态高度和宽度。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T19:19:50.703

它实际上应该是

```
$('#content .text').css('overflow', 'hidden'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T19:17:30.037

根据[AJAX 示例](http://www.kelvinluck.com/assets/jquery/jScrollPane/ajax_example.html)，您应该`.jScrollPane()`在 AJAX 调用完成后简单地调用（使用适当的选项）以更新自定义滚动条。

# sql - 使用 Once SQL 命令判断真假

> ID：13128100
> 
> 赞同：0
> 
> 时间：2012-10-29T19:11:02.537
> 
> 标签：sql, sql-update, sqlcommand, mysql

我只想为更新列运行一次 sql 命令..

```
UPDATE article SET published = '1 OR 0' WHERE id = '1' 
```

在上面的命令中“ **1 OR 0** ”是意思；

如果文章的发表栏目为**1/true**，设置**为 0/false** .. 如果发表为**0/false**，设置为**1/true** ..

我能做些什么？

感谢帮助..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T19:13:36.777

```
UPDATE article SET published = NOT published WHERE id = '1'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T19:15:45.140

尝试使用`if()`功能：

```
UPDATE article 
SET published = if(published=0,1,0) 
WHERE id = '1'; 
```

# java - Android Google Places API REQUEST_DENIED

> ID：13128102
> 
> 赞同：1
> 
> 时间：2012-10-29T19:11:28.667
> 
> 标签：java, android, google-api, android-mapview, android-maps

您好，我正在使用 GOOGLE maps API for android，并且使用我的 API 密钥我能够绘制地图。

还增加了放大缩小功能。但是当我尝试从谷歌 API 获取数据时，它给了我 REQUEST_DENIED 错误消息。

这是我的查询字符串

```
https://maps.googleapis.com/maps/api/place/search/json?location=43.666,93.166&radius=5000&sensor=false&types=establishment&name=hotel&key={myKey} 
```

我尝试了许多[链接来生成密钥](https://developers.google.com/maps/documentation/android/mapkey)

也试过[这个](https://code.google.com/apis/console/)链接。

在过去的两天里，需要帮助解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-29T07:41:10.130

If your keyApi is a android key won't work because you need a browser api (leave in black for all access allowed). From this [link](https://stackoverflow.com/questions/16224080/request-denied-with-google-places-api-browser-key-or-app-key)

"Accessing Google places API involves a http/https request from the browser. The application key you created wouldn't work for the Google places as it needs a browser key. You need to create a new browser key on the Google API console clicking the "Create new Browser Key"

Also leave the Accept requests from these HTTP referers (web sites): blank so that it allows access to all referrers and include the key generated in your query URL."

# hibernate - 预填充数据库

> ID：13128106
> 
> 赞同：0
> 
> 时间：2012-10-29T19:11:36.853
> 
> 标签：hibernate, intellij-idea

出于测试目的，我正在尝试预填充由 Hibernate 创建的表。我有这个`hibernate.cfg.xml`：

```
<!-- Prepopulate database with these DML scripts -->
<property name="hibernate.hbm2ddl.import_files">/genres.sql</property> 
```

我已将文件添加到文件夹`genres.sql`的根目录，`src`但它不执行文件？

这是`genres.sql`文件：

```
INSERT INTO genre (naam) VALUES ("Action");
INSERT INTO genre (naam) VALUES ("Adventure");
INSERT INTO genre (naam) VALUES ("Animation");
INSERT INTO genre (naam) VALUES ("Biography");
INSERT INTO genre (naam) VALUES ("Comedy"); 
```

为什么这不起作用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T00:13:57.073

该文件**位于**类路径中，因为它位于`/src`目录下，但 IntelliJ 仅查找特定扩展名，`.sql`而不是其中之一。

通过转到设置或使用`CTRL+ALT+S`您转到`Compiler`右侧的快捷方式`Resource Patterns`，在此处添加`.sql`扩展程序，它工作正常。

# javascript - 播放生成的声音

> ID：13128107
> 
> 赞同：2
> 
> 时间：2012-10-29T19:11:39.480
> 
> 标签：javascript, web-audio-api

我想捕获音频（在我的情况下来自`getUserMedia`）并播放。我可以像这样将一堆 AudioBuffers 推送到一个数组中：

```
var recorder = audio_context.createJavaScriptNode(256, 2, 2);
recorder.onaudioprocess = function(e) {
  recorded.push(e.inputBuffer.getChannelData(0));
  // or just:
  // recorded.push(e.inputBuffer);
};
recorder.connect(audio_context.destination); 
```

但是那我如何播放`recorded`数组中的缓冲区呢？

一种将这些合并到一个缓冲区并与它一起播放的方法`createBufferSource`？

完全不同的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T08:38:57.353

录制完音频后，您应该能够执行以下操作：

```
var bufferIndex = 0;
recorder.onaudioprocess = function (e) {
  var outputData = e.outputbuffer.getChannelData(0);
  var recordedData = recorded[bufferIndex];
  for (var i = 0; i < recordedData.length; i++) {
    outputData[i] = recordedData[i];
  });
  bufferIndex++;
} 
```

（您可能可以使其更简单/更清洁；这仅用于说明目的）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T18:29:02.683

在我看来，最简单的方法是，正如您所建议的，将它们合并到一个 AudioBuffer 中并通过 AudioBufferSourceNode 播放。我将首先通过该`context.createBuffer`方法创建一个新的 AudioBuffer 对象，特别是使用 numberOfChannels、长度和 sampleRate 作为参数的版本。要计算长度（以秒为单位），您需要知道所有样本数组组合的大小......您可能希望在捕获它们时简单地保持运行总计（类似于`recLength += currentBuffer.length`）。然后，您可以通过将样本总数除以采样率来确定长度。采样率可以通过 确定`context.sampleRate`。

使用适当的参数创建新的 AudioBuffer 对象后，您只需将保存的数组（您的`recorded`数组）复制到 AudioBuffer 的通道数据数组中。这是一个相当简单的两步过程：

1.  `getChannelData(channel)`通过 AudioBuffer 的方法检索底层通道数据
2.  遍历您的`recorded`数组并通过该`.set(array, offset)`方法将保存的数据复制到通道数据数组中（有关更多信息，请参阅[MDN Float32Array 文档](https://developer.mozilla.org/en-US/docs/JavaScript_typed_arrays/Float32Array)）。`channelData.set(currArray, currOffset)`随着`currOffset`每个存储数组的长度增加，您的代码看起来会像这样。

**注意：**如果您正在录制两个音频通道，您将拥有两个记录样本数组，您必须为每个通道（0 和 1）执行上述两个步骤，复制相应的数组。

如果操作正确，您将拥有一个 AudioBuffer，您可以将其插入 AudioBufferSourceNode 并按您认为合适的方式播放。

# javascript - 事件中的变量值

> ID：13128111
> 
> 赞同：0
> 
> 时间：2012-10-29T19:11:55.280
> 
> 标签：javascript, internet-explorer

我有一个具有更改处理程序的组合框 - switch()

```
function switch() {
    var type= $('#ddType').val();
    search.keydown(function (event) {
         if (type == "SomeCode" &&....
} 
```

每次更改组合框值时都会触发此代码（ko）但是在keydown处理程序*类型*变量中始终具有组合框的第一个默认值，因此我必须执行类似的操作

```
search.keydown(function (event) {
    type = $('#ddType').val();
    if (type == "SomeCode" &&....
} 
```

为什么？如果方法的第一行中的*类型*再次正常工作并将类型值更改为当前选择的值并且每​​次更改组合框选择时都会初始化一个按键事件？为什么按键*类型*值具有旧的第一个值？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T09:38:26.980

这种行为的原因是每次按键事件都会添加一个新的处理程序，但它只会触发第一个。所以第一个使用旧值运行。解决方案 - 在添加新的处理程序之前取消绑定处理程序。

```
function switch() {
    search.unbind('keydown');
    search.keydown(function (event) {
         if (type == "SomeCode" &&....
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T19:43:40.250

bfavaretto 是对的。开关是保留的，不能用作函数名。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T08:38:13.317

尝试使用`keyup`而不是`keydown`

# powershell - 如何通过powershell为sharepoint网站集添加搜索下拉列表？

> ID：13128112
> 
> 赞同：0
> 
> 时间：2012-10-29T19:12:04.737
> 
> 标签：powershell, sharepoint-2010

我有一些自定义搜索范围，我想为搜索框和高级搜索添加下拉列表。可以通过编辑 View scopes > Display Groups 手动完成，但我想通过使用 powershell 脚本来更改它。我可以有什么可能的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T02:34:54.873

看看这个： [https ://sharepoint.stackexchange.com/questions/28306/edit-search-dropdown-scopedisplaygroup-with-powershell-unauthorized](https://sharepoint.stackexchange.com/questions/28306/edit-search-dropdown-scopedisplaygroup-with-powershell-unauthorized)

查看评论并以这种方式创建整个脚本。或者，查看 C# 版本（并转换为 psh！）： [http ://www.sharepointconfig.com/2011/04/creating-sharepoint-2010-search-scopes-programmatically/](http://www.sharepointconfig.com/2011/04/creating-sharepoint-2010-search-scopes-programmatically/)

干杯。

# javascript - 原型在新插入的表单上提交事件处理

> ID：13128113
> 
> 赞同：0
> 
> 时间：2012-10-29T19:12:05.873
> 
> 标签：javascript, events, prototype

我在页面上有许多可点击的图像/按钮，它们具有以下内容（使用 Prototype.js）。

```
 $$( '.lbrchk' ).each( function ( name ) {
        name.observe( 'click' , function ( ev ) {
          var form = new Element( 'form',
                                    {
                                      method: 'post',
                                      action: 'url',
                                    });

            form.insert(new Element( 'input',
                                      {
                                        name: 'user',
                                        value: $(this).down( "input[name=user]" ).value,
                                        type: 'hidden'
                                      }));

            form.insert(new Element( 'input',
                                      {
                                        name: 'pin',
                                        value: '',
                                        type: 'password'
                                      }));

            form.insert(new Element( 'input',
                                      {
                                        type: 'submit',
                                        value: 'Submit',
                                       'class': 'processing'
                                      }));

            $('modal-content').insert(form); 
            $('modal').show();
            $('modal-content').down("input[name=user]").focus();

        });
    }); 
```

和其他有这个的。

```
$$( '.lbrinq' ).each( function ( name ) {
    name.observe( 'click' , function ( ev ) {
        var form = new Element( 'form',
                                {
                                  method: 'post',
                                  action: 'url'
                                });

            form.insert(new Element( 'input',
                                  {
                                    name: 'document',
                                    value: $(this).down("input[name=document]").value,
                                    type: 'hidden'
                                  }));

             $(document.body).insert(form);
             form.submit(); 

    });
}); 
```

两者相似，但一个创建一个模式表单，在提交之前要求用户输入，另一个创建表单元素并在单击按钮/图像时实用地提交表单。

我需要添加一个提交事件处理程序以仅允许提交一个表单。由于这些表单是动态创建的，所以我尝试的一切都以一种或另一种方式失败。

我试过改变

```
 var form = new Element( 'form',
                            {
                              method: 'post',
                              action: 'url'
                            }); 
```

至

```
 var form = new Element( 'form',
                            {
                              method: 'post',
                              action: 'url',
                              onsubmit: 'alert("hi");return false;'
                      //also  onsubmit: function(){ alert("hi" ); }

                            }); 
```

我还尝试向文档添加提交侦听器

```
 document.observe( 'submit', function( e, el ) {

    if ( el = e.findElement( 'form' ) ) {

          // Disable  all submit buttons
          $$( 'input[type="submit"]' ).invoke( 'disable' );         

          // If no previous submissions detected go ahead
            if( subck == 0){
              // show loading graphic to user
              $('processing_gif').show();

                  subck = 1;
                 return true;  // jump out of logic to continue normal operation
            } else { // Previous submission detected

              // Stop right here to prevent multiple submissions.
                e.stop();       
        }
    }
  }); 
```

在 Firefox 中有效，但在 IE 8/9 中无效。

有人对如何处理动态创建的表单上的“提交”事件有任何建议吗？

# python - 在 python 中导入模块时会发生什么？

> ID：13128114
> 
> 赞同：8
> 
> 时间：2012-10-29T19:12:11.943
> 
> 标签：python, import, module, initialization, package

我真的想知道当我们在 python 中导入模块文件时会发生什么。我的意思是它的过程，换句话说，python 将运行或检查什么东西？！喜欢`__init__.py`或 sys.modules 等，例如我知道`__init__.py`每个包中都是必要的文件，我想知道 python 在导入时对这些文件有什么作用？请为我点亮这个。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-29T19:18:41.813

阅读[关于模块的教程部分、](http://docs.python.org/2/tutorial/modules.html) [import 语句](http://docs.python.org/2/reference/simple_stmts.html#import)的文档、[`imp`模块](http://docs.python.org/2/library/imp.html)（特别是示例），也许还有[`__import__`内置](http://docs.python.org/2/library/functions.html#__import__)的文档。那应该会让你走得很远。如果您仍然想了解更多，我建议您提出一个具体问题，这个问题有点宽泛。

**编辑**：再次阅读您的问题后，您的问题有一个特定部分，关于`__init__.py`包中的内容。它基本上可以是空的或包含导入该包时将执行的初始化代码。有关详细信息，请参阅[有关软件包的部分](http://docs.python.org/2/tutorial/modules.html#packages)。

在一个`__init__.py`你也可以设置`__all__`，它定义了当你这样做时要导入的符号`from yourpackage import *`。这在[importing * from a package](http://docs.python.org/2/tutorial/modules.html#importing-from-a-package)中有详细说明。

# perl - 我不确定如何将 Perlbrew 与 Catalyst 一起使用

> ID：13128116
> 
> 赞同：2
> 
> 时间：2012-10-29T19:12:17.887
> 
> 标签：perl, catalyst, perlbrew

我正在尝试在全新的服务器中将 Perlbrew 与 Catalyst 一起使用。Perlbrew 已经安装并使用最后一个 Perl。优点是有希望的，但我不确定我的工作方法。

**在开发时**，我通常会启动我用于开发的用户的 shell，并使用调试器 (script/myapp_server.pl) 启动 Catalyst 服务器。

所以，如果我使用 Perlbrew，我必须初始化 Perbrew，切换到所需的 Perl 版本，然后运行 ​​Catalyst 服务器。

如果我关闭 shell，下次我使用我的开发用户连接时，我必须再次将 Perl 切换到正确的版本。每次都是由我容易出错的人手，不是吗？

生产环境在同一台机器上。

因此，**在生产环境**中，我在作为 Root 连接的 shell 中使用，在我启动 Catalyst 套接字之前，我必须确保正确的 Perl 被激活，也是通过人为操作。

**而我添加到 Perl 的所有模块**，都必须添加到 Root 使用的 Perlbrew Perl 版本和开发用户使用的 Perlbrew Perl 版本中。

最后一件事，如果我尝试一个新的 Perbrew Perl 版本......我认为我必须再次将所有模块添加到全新的 Perl，在生产和开发环境中......

这是正确的方法吗????，或者我正在做一些非常奇怪的事情，让事情变得过于复杂而不是使用 Perlbrew 来简化我的生活？

问候：米格尔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T19:34:27.407

我希望使用其安装程序安装您的应用程序的发行版会`#!`在文件中放置正确的行。

```
#!/home/ikegami/usr/perlbrew/perls/5.16.1/bin/perl 
```

如果没有，或者如果您不使用安装程序来安装您的应用程序，您可以自己在该行中进行编辑，或者您可以使用该特定 Perl 启动脚本

```
/home/ikegami/usr/perlbrew/perls/5.16.1/bin/perl script/myapp_server.pl 
```

# django - 我可以在 Django ManyToMany 字段中以某种方式使用 to_field 参数吗？

> ID：13128127
> 
> 赞同：3
> 
> 时间：2012-10-29T19:12:57.603
> 
> 标签：django, django-models

在 Django 的`ForeignKey`字段中，我可以指定`to_field`. 这很棒，因为我可以使用 slugs 作为外键并执行相当于“自然键”功能的功能。

我在 中找不到任何这样的字段`ManyToMany`。我不明白为什么不。有没有办法做到这一点？也许在我自己的 m2m 连接表中明确地使用`through`?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T19:42:08.737

我认为 Django 没有内置`to_field`参数`ManyToManyField`。但是，就像您提到的那样，您可以手动制作一个`through`表格，该表格显然将使用`ForeignKey`支持`to_field`参数的字段。

不是一个真正干净的方法并且不遵循 DRY，但我认为目前没有更好的方法来解决这个问题。也许您应该为此提交功能请求。

# asp.net - 父gridview中的e.RowIndex

> ID：13128128
> 
> 赞同：0
> 
> 时间：2012-10-29T19:12:59.730
> 
> 标签：asp.net, gridview

我有一个嵌套的网格视图。我已经为嵌套的gridview定义了gridview_RowDeleting事件。但是我有一个问题，例如，当我想删除嵌套gridview中的第一行并且这个嵌套gridview在第二或第三行时，我可以不删除嵌套gridview中的行，并且父gridview的e.RowIndex也是0，而它应该是1或2，..对于嵌套gridview，它应该是0。

请帮助我如何更改我的代码可以识别父gridview的e.RowIndex与e.RowIndex嵌套gridview不同。

```
protected void GridViewTranstoCon_RowDeleting(object sender, GridViewDeleteEventArgs e)
{

    GridView TranstoCon = sender as GridView ;
    int transid = Convert.ToInt32(GridViewTtransmittals.DataKeys[e.RowIndex].Value);

    int Id = Convert.ToInt32(TranstoCon.DataKeys[e.RowIndex].Value);

    //Also step into this and see what it's doing
    OnDeleteTtransmittaltocon(Id,transid); 
```

GridViewTtransmittals 是父网格视图，TranstoCon 是嵌套网格视图。

```
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T20:56:16.993

问题是您使用嵌套 gridview 的 RowIndex 作为父 gridview 。在这种情况下`e.RowIndex`是指`nested gridview`'`current row`不是它的父母的 。获取父gridview的当前行的索引：

```
GridViewRow parentRow = (GridViewRow)TranstoCon.Parent.Parent.Parent;
int parentRowIndex = parentRow.RowIndex; 
```

我不太确定**两个**或**三个**.Parent 是必需的。你可以尝试两者。

所以你的代码可以编辑如下：

```
protected void GridViewTranstoCon_RowDeleting(object sender, GridViewDeleteEventArgs e){
GridView TranstoCon = sender as GridView ;

// parent row
var parentRow = (GridViewRow)TranstoCon.Parent.Parent.Parent;

int transid = Convert.ToInt32(parentRow.DataKeys[parentRow.RowIndex].Value);

int Id = Convert.ToInt32(TranstoCon.DataKeys[e.RowIndex].Value);

//Also step into this and see what it's doing
OnDeleteTtransmittaltocon(Id,transid);
} 
```

你可以查看这篇[文章](http://forums.asp.net/p/1569299/3930030.aspx)

# android - 在android中的应用程序之间共享strings.xml

> ID：13128129
> 
> 赞同：0
> 
> 时间：2012-10-29T19:13:05.513
> 
> 标签：android

我有多个项目使用相同的本地化 strings.xml。如何在我的所有项目之间共享此文件以便只编辑一个文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T22:11:50.173

创建一个包含字符串和您想要共享的任何资源的[Android 库项目。](http://developer.android.com/tools/projects/index.html#LibraryProjects)

# c - 使用系统调用操作创建文件并写入随机字符

> ID：13128130
> 
> 赞同：0
> 
> 时间：2012-10-29T19:13:07.477
> 
> 标签：c, operating-system, system-calls

我正在尝试创建一个文件并通过系统调用操作将 256 MB 大小的随机字符复制到其中，我只是不明白该怎么做。

显然我需要文件是 txt 文件，所以当我尝试使用带有 O_RDWR 标志的**creat**函数但它没有创建 txt 文件时，这是我无法打开的未知文件。我在网上看到一个PERMS的东西，我不明白。这是我到目前为止写的：

```
char buff[1024*1024]; 
j=0;
for (i=0;i<(1024*1024);i++){
    if (j==256) j=0;

    buff[i]='a'+j;

    j++;
}

fd= open(argv[1], O_RDWR);
if (fd < 0) { 
    fd= creat(argv[1],O_RDWR);
    for (i=0; i<256; i++) {
        write(fd, buff, 1024*1024);
    } 
```

它确实创建了文件，但它不可访问且大小为 0。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T06:52:16.123

第二个参数 of`creat()`与 of 不同`open()`。

该常量`O_RDWR`定义为 2 并被误解为文件模式位，这意味着您无法读取文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-01T06:20:29.273

检查您的程序逻辑。`if (fd < 0)`是假`write()`的，永远不会被执行。

# android - 单击计算按钮时程序崩溃

> ID：13128132
> 
> 赞同：0
> 
> 时间：2012-10-29T19:13:10.117
> 
> 标签：android, button, crash, crash-reports

> > 我有一个应用程序在单击计算按钮时崩溃。在该程序中，用户从下拉菜单列表中输入食物信息，然后输入他们的信息以及订单。然后使用文本计算订单总数，并在第二个活动 (Food_Total) 中显示 toast 消息及其订单信息。

```
 >>Here are print screens of the code:

        public class MainActivity extends Activity {

        public static String priceString= "";

            public void onCreate(Bundle savedInstanceState) {
                super.onCreate(savedInstanceState);
                setContentView(R.layout.activity_main);
            }

          @Override
            public boolean onCreateOptionsMenu(Menu menu) {
                getMenuInflater().inflate(R.menu.activity_main, menu);
                return true;
            }

            public void onClick(View view) {
                    Intent intent = new Intent(this, Food_Total.class);
                    Bundle b = new Bundle();
                    DecimalFormat df = new DecimalFormat("0.00");//decimal format for dollars
                    EditText mealNameBox= (EditText) findViewById(R.id.editText1);
                    String mealNameString= mealNameBox.getText().toString();
                    EditText mealPriceBox = (EditText) findViewById(R.id.editText2);
                    String priceString = mealPriceBox.getText().toString();
                    Double priceDouble= Double.parseDouble(priceString);

                    //Sales tax for VA
                    String tax= "4%";

                    String percentString= tax.toString();
                    //Calculate taxes for food
                    double taxfood= priceDouble * .04;

                    String taxfood_string= Double.toString(taxfood);

                    //Calculate food total
                    double food_total= taxfood + priceDouble;

                    String food_total_string= Double.toString(food_total);

                    b.putString("Meal Price:", "" + df.format(priceString));
                    b.putString("Tax: ", tax);
                    b.putString("Food Total: ", "" + df.format(food_total));

                    intent.putExtras(b);
                    startActivity(intent);

                    //Toast.makeText(this, "" + tip, Toast.LENGTH_LONG).show();
                    //Toast.makeText(this, "" + total, Toast.LENGTH_LONG).show();
                }
        }

    Food_Total Activity (displays toast message):

        public class Food_Total extends Activity {

            @Override
            public void onCreate(Bundle savedInstanceState) {
                super.onCreate(savedInstanceState);
                setContentView(R.layout.activity_food__total);
                //get info from intent
                Bundle b = getIntent().getExtras();

                // #####################################################
                //Updated key values on bundle so that they
                // match the MainActivity class
                // #####################################################
                String meal_nameString= b.getString("MealName");
                String mealString = b.getString("MealPrice");
                String percentString = b.getString("TaxRate");
                String tax_foodString= b.getString("TaxAmount");
                String food_totalString= b.getString("Total");

                //results output info
                String results = meal_nameString + getString(R.string.mealNameString) +
                "\n" + mealString + getString(R.string.mealPrice)+ ": $"+ 
                "\n" + percentString + "%" +  
                "\n" + tax_foodString + getString(R.string.taxfood_string) + ": $"  +
                "\n" + food_totalString + getString(R.string.food_total_string);

                //create text view
                TextView textView = new TextView(this);
                textView.setTextSize(30);
                textView.setText(results);

                //set view as the activity layout
                setContentView(textView);
            }

            @Override
            public boolean onCreateOptionsMenu(Menu menu) {
                getMenuInflater().inflate(R.menu.activity_food__total, menu);
                return true;
            }

            @Override
            public boolean onOptionsItemSelected(MenuItem item) {
                switch (item.getItemId()) {
                    case android.R.id.home:
                        NavUtils.navigateUpFromSameTask(this);
                        return true;
                }
                return super.onOptionsItemSelected(item);
            }
        }

        Layout XML:

        <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
            xmlns:tools="http://schemas.android.com/tools"
            android:layout_width="match_parent"
            android:layout_height="match_parent" >

            <EditText
                android:id="@+id/name"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_alignParentRight="true"
                android:layout_marginTop="15dp"
                android:ems="10" >

                <requestFocus />
            </EditText>

            <TextView
                android:id="@+id/name_lbl"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_alignBottom="@+id/name"
                android:layout_alignParentLeft="true"
                android:layout_marginLeft="18dp"
                android:text="Student Name: "
                android:textAppearance="?android:attr/textAppearanceSmall" />

            <TextView
                android:id="@+id/Food_Name"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_alignLeft="@+id/name_lbl"
                android:layout_below="@+id/name_lbl"
                android:layout_marginTop="34dp"
                android:text="Food Name:"
                android:textAppearance="?android:attr/textAppearanceSmall" />

            <EditText
                android:id="@+id/editText1"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_alignBottom="@+id/Food_Name"
                android:layout_alignParentRight="true"
                android:ems="10" />

            <TextView
                android:id="@+id/textView1"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_alignLeft="@+id/Food_Name"
                android:layout_below="@+id/Food_Name"
                android:layout_marginTop="26dp"
                android:text="Food Price: "
                android:textAppearance="?android:attr/textAppearanceSmall" />

            <EditText
                android:id="@+id/editText2"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_alignBaseline="@+id/textView1"
                android:layout_alignBottom="@+id/textView1"
                android:layout_alignParentRight="true"
                android:ems="10"
                android:inputType="numberDecimal" />

            <ListView
                android:id="@+id/listView1"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:layout_alignLeft="@+id/textView1"
                android:layout_alignRight="@+id/name_lbl"
                android:layout_below="@+id/editText2"
                android:layout_marginTop="44dp" >

            </ListView>

            <Button
                android:id="@+id/calculate"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_alignParentRight="true"
                android:layout_alignTop="@+id/listView1"
                android:layout_marginRight="50dp"
                android:onClick="onClick"
                android:text="Calculate" />

        </RelativeLayout>

    >>Android Manifest File:

    <manifest xmlns:android="http://schemas.android.com/apk/res/android"
        package="com.example.food_activity_final"
        android:versionCode="1"
        android:versionName="1.0" >

        <uses-sdk
            android:minSdkVersion="8"
            android:targetSdkVersion="15" />

        <application
            android:icon="@drawable/ic_launcher"
            android:label="@string/app_name"
            android:theme="@style/AppTheme" >
            <activity
                android:name=".MainActivity"
                android:label="@string/title_activity_main" >
                <intent-filter>
                    <action android:name="android.intent.action.MAIN" />

                    <category android:name="android.intent.category.LAUNCHER" />
                </intent-filter>
            </activity>
            <activity
                android:name=".Food_Total"
                android:label="@string/title_activity_food__total" >

                     <meta-data
                android:name="android.support.PARENT_ACTIVITY"
                android:value="com.example.myfirstapp.MainActivity" />

                    <action android:name="android.intent.action.MAIN" />

                    <category android:name="android.intent.category.LAUNCHER" />

            </activity>
        </application>

    </manifest>

    >>Thank you for your help! Let me know if you need to know anything more about the program. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T23:33:39.187

AndroidManifest.xml 中如何定义这些活动？MainActivity 应该有一个意图过滤器，如下所示：另一个 Activity 也必须在那里，但它不应该*有*一个意图过滤器。

# jquery - ajax调用后jQuery click事件再次执行函数

> ID：13128133
> 
> 赞同：0
> 
> 时间：2012-10-29T19:13:11.287
> 
> 标签：jquery, click, execute

```
$(document).on('click', '#slider_icons_wrapper.play', function(event) {
        var slider_icons_wrapper = $('#slider_icons_wrapper');

        slider_icons_wrapper.attr('class', 'pause');
        autoSlider(cur_img_div_pos);
        showButton('play_icon');
        console.log('play');
    });

    $(document).on('click', '#slider_icons_wrapper.pause', function(event) {
        var slider_icons_wrapper = $('#slider_icons_wrapper');

        slider_icons_wrapper.attr('class', 'play');
        clearInterval(inter);
        showButton('pause_icon');
        console.log('pause');
    }); 
```

此代码在第一次加载文档时可以正常工作。当用户通过ajax调用导航到另一个页面（文档不刷新）并返回包含#slider_icons_wrapper div的页面时，当用户单击该div时，该函数会执行两次。如果用户再次导航并返回，则函数执行 3 次，以此类推！

我究竟做错了什么？

**编辑#1**

当用户导航到另一个页面时，元素 #slider_icons_wrapper 将从 DOM 中删除。当它通过 ajax 调用注入回来时，click 事件每次都会触发更多时间。当用户离开此页面时，我试图取消绑定点击事件，但同样的事情发生了

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T19:24:20.873

如果您正在执行在“导航并返回”时设置事件处理程序的代码，您可能会将多个处理程序分配给同一事件。

尝试使用这些语句：

```
$(document).off().on('click', '#slider_icons_wrapper.play', function(event) {

$(document).off().on('click', '#slider_icons_wrapper.pause', function(event) { 
```

在重新分配它们之前清除您的处理程序

您应该始终清除您的处理程序，并注意您分配它们的位置在每个页面视图中只能看到一次。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T19:48:24.690

似乎每个页面返回的事件侦听器都被添加到文档中。尝试将它们添加到 document.ready --

```
function init(e){

    $(document).on('click', '#slider_icons_wrapper.play', function(event) {
        var slider_icons_wrapper = $('#slider_icons_wrapper');

        slider_icons_wrapper.attr('class', 'pause');
        autoSlider(cur_img_div_pos);
        showButton('play_icon');
        console.log('play');
    });

    $(document).on('click', '#slider_icons_wrapper.pause', function(event) {
        var slider_icons_wrapper = $('#slider_icons_wrapper');

        slider_icons_wrapper.attr('class', 'play');
        clearInterval(inter);
        showButton('pause_icon');
        console.log('pause');
    });

}

$(document).ready(init); 
```

user1026361 还提出了一个很好的观点，即在再次添加监听器之前删除它们。但是，我相信在没有选择器的情况下使用 .off() 将删除通过 .on() 添加到该元素的所有侦听器。如果您采用 .off( ).on( ) 方法，我建议使用命名空间：

```
$(document).off('click.clickPlay').on('click.clickPlay', '#slider_icons_wrapper.play', function(event) {
    ...
});

$(document).off('click.clickPause').on('click.clickPause', '#slider_icons_wrapper.pause', function(event) {
    ...
}); 
```

# windows-server-2008 - Ektron 中的重音不敏感搜索

> ID：13128138
> 
> 赞同：0
> 
> 时间：2012-10-29T19:13:26.463
> 
> 标签：windows-server-2008, windows-server-2008-r2, ektron, indexing-service

在使用 Ektron CMS 使用 Accent Mark 进行搜索时，我们遇到了问题。搜索“关塔那摩”（带有重音符号）会返回结果，但“关塔那摩”不会返回结果。知道如何让搜索对重音字符不敏感吗？我们怀疑一年前我们有这个功能工作，但似乎被打破了。这可能与索引服务器的任何 Windows 更新有关吗？

我们使用的是 Windows Server 2008。属性“允许使用变音符号”在本地计算机策略“计算机配置/管理模板/Windows 组件/搜索”中被禁用 谢谢，Madhu。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T20:49:27.700

如果只是一些特定的词，您可以定义一个同义词，以便关塔那摩是关塔那摩的同义词。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T18:48:07.250

从搜索服务器的控制面板中，打开“索引选项”>“高级”部分，并确保未选中“将带有变音符号的相似词视为不同的词”选项。

来自： http: [//programming4.us/desktop/2346.aspx](http://programming4.us/desktop/2346.aspx)

# riak - Riak 搜索 JSON 列表

> ID：13128144
> 
> 赞同：0
> 
> 时间：2012-10-29T19:13:45.467
> 
> 标签：riak, riak-search

我想知道如何在 Riak Search 中搜索列表项。

例如：

```
{
    "name": "Zombies Eat Brains",
    "tags": ["zombies", "funny", "lol"]
} 
```

search-cmd 搜索对象？？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-20T19:54:36.670

是的，您可以在 JSON 中搜索任何类型的字段。

例如，在桶“产品”中，我有价值

```
keywords: [
"New York",
"billboard",
"outdoors"
] 
```

我通过搜索找到了结果：

```
search-cmd search products "keywords:billboard" 
```

阅读更多

*   [http://docs.basho.com/riak/1.3.1/cookbooks/Riak-Search---Indexing-and-Querying-Riak-KV-Data/#JSON-Encoded-Data](http://docs.basho.com/riak/1.3.1/cookbooks/Riak-Search---Indexing-and-Querying-Riak-KV-Data/#JSON-Encoded-Data)
*   [http://comments.gmane.org/gmane.comp.db.riak.user/5443](http://comments.gmane.org/gmane.comp.db.riak.user/5443)

# audio - 在 Phonegap 项目中的 iOS 6 上，音频不再在后台播放

> ID：13128145
> 
> 赞同：1
> 
> 时间：2012-10-29T19:13:48.633
> 
> 标签：audio, cordova, ios6, multitasking

我的应用程序需要在后台运行音频。在 iOS 6 之前的版本中，通过添加

```
<key>UIBackgroundModes</key>
<array>
    <string>audio</string>
</array> 
```

将代码添加到适当的 .plist 文件中，但是在将我的 phonegap 项目部署到 iOS 6 时，这不再有效。如何在 iOS 6 中解决此问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T06:02:07.900

在 MainController.h 文件中更改以下内容：

```
#import "MainViewController.h"
#import <AVFoundation/AVFoundation.h>

@implementation MainViewController

- (id) initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization

        NSError *setCategoryError = nil;
        [[AVAudioSession sharedInstance] setCategory: AVAudioSessionCategoryPlayback error: &setCategoryError];

    }
    return self;
} 
```

我不确定以下是否必要，但我清理了我的项目（CMD+ALT+K），重新编译了 PhoneGap / Cordova Lib（更改目标并让它运行到模拟器）和（再次更改目标后）编译到再次申请，现在它可以工作了！

**注意**：它仅适用于设备，不适用于模拟器

# python - 用python下载affy注解文件

> ID：13128146
> 
> 赞同：0
> 
> 时间：2012-10-29T19:13:49.317
> 
> 标签：python

我想下载一个 affymetrix 注释文件。但它需要先登录。

登录页面是[https://www.affymetrix.com/estore/user/login.jsp](https://www.affymetrix.com/estore/user/login.jsp) 我要下载的文件是： [http ://www.affymetrix.com/Auth/analysis/downloads/na32/genotyping/ GenomeWideSNP_6.na32.annot.db.zip](http://www.affymetrix.com/Auth/analysis/downloads/na32/genotyping/GenomeWideSNP_6.na32.annot.db.zip)

我尝试了一些方法，但我无法弄清楚。

#

```
    从请求导入会话
    有效载荷 = {
        '动作'：'登录'，
        'username': 'username', #这部分要改
        'password': 'password' #这部分要改
    }

    使用 session() 作为 c：
        c.post('https://www.affymetrix.com/estore/user/login.jsp', data=payload)
        request = c.get('http://www.affymetrix.com/Auth/analysis/downloads/na32/genotyping/GenomeWideSNP_6.na32.annot.db.zip')
        打印请求头文件
        打印请求.text

```

#

我也尝试 urllib2，

```
    导入 urllib、urllib2、cookielib
    用户名 = '用户名'
    密码='密码'
    cj = cookielib.CookieJar()
    opener = urllib2.build_opener(urllib2.HTTPCookieProcessor(cj))
    login_data = urllib.urlencode({'username' : 用户名, 'password' : 密码})
    opener.open('https://www.affymetrix.com/estore/user/login.jsp', login_data)
    resp = opener.open('http://www.affymetrix.com/Auth/analysis/downloads/na32/genotyping/GenomeWideSNP_6.na32.annot.db.zip')
    resp.read()

```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T00:57:53.747

这是发布信息的 URL。

`https://www.affymetrix.com/estore/user/login.jsp?_DARGS=/estore/user/login.jsp`

这是正在发布的信息。

![发布数据](../Images/5764c7031e6ad4d92a5f3ee1cfaef4d1.png)

# java - java中的多个子类

> ID：13128149
> 
> 赞同：3
> 
> 时间：2012-10-29T19:14:13.957
> 
> 标签：java, inheritance

我想知道一些程序，通过它我可以限制java中给定类的多个子类。

例如，如果我有 A 类，那么只有一个类可以扩展 A，即不允许超过 1 个子类。

我在公司面试中被问到这个问题，非常感谢一些帮助或指导。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T19:20:26.103

您可以通过 Sujay 链接的机制阻止任何人*使用*多个子类（请参阅评论）。超类构造函数/方法可以跟踪调用它们的子类，记住第一个，并在使用另一个子类时抛出异常。不是很优雅，也可能不是很有用（但这是一个面试问题）。

**更新：**这是你所追求的（来自[http://www.drmaciver.com/2007/09/how-to-create-sealed-classes-in-java/](http://www.drmaciver.com/2007/09/how-to-create-sealed-classes-in-java/)）？

```
public class Sealed
{
    private Sealed() { }

    public final static class Foo extends Sealed {
       public Foo() { }
    } 
} 
```

您不能在 Sealed 类之外创建更多子类，因为构造函数不可见......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T19:18:45.810

您可以使用**工厂设计模式**为类的层次结构创建实例，并使用一个**静态计数器**来表示实例的数量。当数量超过您的需要时，在工厂方法上抛出**异常。**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T19:19:44.947

当您尝试创建使用工厂的子类时会怎样。工厂可以保留某种计数器或逻辑来确定是否允许创建一个类。如果确定无法创建该类，则抛出异常。

```
try {
   ChildClass childClass = ChildFactory.createChild();
} catch (ChildCreateionException e) {
    ...
}

class ChildFactory {

    public static final int MAX_CHILDREN = 2;
    public static int numChildren = 0;

    public ChildClass createChild() throws ChildCreationException {
        if (numChildren < MAX_CHILDREN) {
            numChildren++;
            return new ChildClass();
        }

        throw new ChildCreationException("Exceeded maximum number of child classes");
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-29T19:22:56.730

您不能在编译器级别对此进行限制。您可以在运行时“某种程度地”限制它。创建将包含`Class`子级的静态变量。该变量将由基类的构造函数更新。如果实例化其他孩子，构造函数将抛出异常：

```
class Base {
    private static Class<? extends Base> childClass = null;

    protected Base() {
        if (childClass == null) {
            childClass = this.getClass();
        }
        if (!childClass.equals(this.getClass())) {
            throw new IllegalStateException("More than one child");
        }
    }
} 
```

其他解决方案可能是扫描应用程序类路径并找到所有扩展的类`Base`。另一个解决方案是拦截类加载器，以便在运行时捕获加载的类。如果您正在开发独立应用程序，则可以通过编程方式控制类加载器，或者如果您无法直接访问类加载器，则可以使用检测包来控制类加载器。

我相信我在这里提到了你的面试官不知道的技术...... :)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-29T19:22:57.957

假设您谈论的是类本身而不是类实例，我认为您唯一能做的就是让您想要限制的类有一个私有构造函数并将（一个也是唯一的）子类声明为嵌套类。

# ruby-on-rails-3 - Rails 中的迁移文件

> ID：13128151
> 
> 赞同：0
> 
> 时间：2012-10-29T19:14:28.647
> 
> 标签：ruby-on-rails-3

我正在 Rails (3.2.3) 中创建一个模型并定义要包含哪些列（希望这是正确的）

例如我的第一个条目是

```
 t.string :Dish_Name 
```

我的第一个问题是我可以使用该语法，即 Dish_Name 吗？

我的第二个问题是我想使用下拉菜单从输入字段中选择选项，因此例如我希望有一个具有多个选项的“原产国”，即世界各国。

拥有一个包含所有国家/地区的单独数据库然后从下拉列表中提取数据会更好吗？如果是这样，有人可以指出我正确的方向，看看如何做到这一点？不一定要寻找答案只是一个开始寻找的好地方

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T19:19:52.720

前导大写名称保留给常量。典型的列名是带有下划线的小写字母（例如`dish_name`，或`country_of_origin`）。这些是 Ruby 约定，Rails 也随之而来。命名约定在 Ruby 中很重要，与 C# 之类的语言不同，在 C# 中，您可以使用任何您想要的大小写来调用任何东西。

请务必查看[guides.rubyonrails.org](http://guides.rubyonrails.org)以获取更多信息。

# iphone - UItextView 委托方法未在子视图内调用

> ID：13128157
> 
> 赞同：0
> 
> 时间：2012-10-29T19:15:19.680
> 
> 标签：iphone, cocoa, uitextfield

简单来说：

在 ClassA_VC 我做：

```
ClassB_VC *classB_VC=[ClassB_VC alloc]initWithNibName:@"ClassB_VC" bundle:nil];
[self.view addSubview:classB_VC.view]; 
```

然后在 ClassB_VC 中我有一个 UITextField。我在 IB 中设置了文本字段和文件所有者之间的委托连接，我在@interface 声明中添加了，我像往常一样编写了协议方法（textFieldDidEndEditing、textFieldDidBeginEditing 等）。

这应该可以，但是当我触摸文本字段时出现异常。似乎文本字段没有到达它的代表。

但是，如果我使用 presentModalViewController 呈现视图，一切正常。我宁愿不必这样做，因为这些视图位于 tabViewController 中，并且我不想在显示时隐藏 tabBar。

我希望你明白我想说什么。我的英文不是很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T03:19:06.447

你在 ClassA_VC 中保留了 ClassB_VC 吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T20:53:50.660

从界面生成器中删除委托并执行以下操作：

```
ClassB_VC *classB_VC=[ClassB_VC alloc]initWithNibName:@"ClassB_VC" bundle:nil];
[classB_VC.yourTextField setDelegate:classB_VC];
[self.view addSubview:classB_VC.view]; 
```

让我知道它是否有帮助

# width - iframe 宽度不起作用

> ID：13128158
> 
> 赞同：0
> 
> 时间：2012-10-29T19:15:22.890
> 
> 标签：width, facebook-canvas

我真的可以使用一些帮助，我将宽度设置为流畅，但它没有正确显示我们的网站。我在想也许我需要在网站本身中添加一些编码以正确填充宽度。

任何建议将不胜感激。这是链接：[http ://www.facebook.com/pages/Dolly-Couture/121902929539?sk=app_261546067227561](http://www.facebook.com/pages/Dolly-Couture/121902929539?sk=app_261546067227561)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T03:42:52.190

我认为“流体画布”仅适用于画布应用程序，而不适用于 Page Tab 应用程序。

# linux - CUDA 进程内存使用

> ID：13128159
> 
> 赞同：1
> 
> 时间：2012-10-29T19:15:30.057
> 
> 标签：linux, memory, process, cuda

我试图弄清楚如何发现 CUDA 进程的内存使用情况（我的进程的 GPU 占用率）。我已经尝试过 cudaMemGetInfo 和 nvidia-smi，但我认为它们都报告了整个 GPU 内存信息。所以我想知道如何获取我的 CUDA 进程的内存信息，就像在 linux /proc/[pid]/status 中一样。谢谢。

# zend-framework - 学习 Zend 框架 1

> ID：13128164
> 
> 赞同：1
> 
> 时间：2012-10-29T19:15:54.153
> 
> 标签：zend-framework, frameworks, zend-framework-mvc

> **可能重复：**
> [学习 Zend 框架的最快方法？](https://stackoverflow.com/questions/4436219/fastest-way-to-learn-zend-framework)

我想在寒假期间申请为一家公司工作。他们显然严重依赖最新的 zend 框架 1。为了让我获得这个职位，他们建议我使用 zend 框架创建一个项目。我在想一个简单的博客。

有人对学习 zend 框架 1 有什么建议吗？每当我搜索时，我都会找到有关 zend 框架 2 的信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T19:21:02.593

这是[Pádraic Brady 编写](http://blog.astrumfutura.com/)的一本非常好的免费在线书籍/教程，介绍了 Zend Framework 1 以及使用它的最佳实践：[SurviveTheDeepend](http://www.survivethedeepend.com/)。

Pádraic 是 ZF1（和 2）的核心贡献者，也是 Zend_Feed_Reader/Writer 的创建者，并撰写了大量关于 PHP 应用程序安全性的文章。他的博客绝对值得一读。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T21:23:15.233

[ZendCast](http://www.zendcasts.com/)是学习 ZF1 的绝佳资源。

# c# - 无法填充组合框

> ID：13128168
> 
> 赞同：0
> 
> 时间：2012-10-29T19:16:15.603
> 
> 标签：c#, .net, wpf, xaml, mvvm

我有一个像这样的模型类：

```
public class AttributesModel
    {
        public SortOrder SortBy { get; set; }

        public enum SortOrder
        {
            Unsorted,
            Ascending,
            Descending
        }

        public AttributesModel(string field)
        {
            Field = field;
        }
    } 
```

还有一个 DataGrid，其中包含一个 Combobox 作为列之一，如下所示：

```
<DataGridTemplateColumn Width="Auto" IsReadOnly="False" Header="Order">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <ComboBox ItemsSource="{Binding Path=AttributesModel}" DisplayMemberPath="SortBy" SelectedValuePath="SortBy" SelectedValue="{Binding Path=AttributesModel}"/>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate> 
```

包含 DataGrid 的类还具有以下构造函数：

```
DataContext = this;
itemsSource = new ObservableCollection<AttributesModel>(parentDatabaseTable.ListFields.Select(f => new AttributesModel(f))); 
```

出于某种原因，我的 DataGrid 中的所有字段都在填充，但组合框除外。请注意，为了简单和可读性，我没有包含模型类中其他字段的代码，也没有包含 DataGrid 中的列。除了组合框列之外，它们都已成功填充。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T19:19:43.683

An`ItemsSource`必须是一个集合。你`AttributeModel`不是收藏品。

如果你想绑定一个枚举的选项，我过去用过这个：

```
public class EnumWrapper<T> where T:struct
{
    private List<T> values;

    public List<T> Values
    {
        get { return values; }
        set { values = value; }
    }

    public EnumWrapper()
    {
        // Note: Annoyingly, you can't restrict T to an Enum, so we have to check at runtime!
        Type type = typeof(T);
        if (!type.IsEnum)
        {
            throw new ArgumentException("Type must be an enum");
        }
        Array a = Enum.GetValues(type);
        values = a.Cast<T>().ToList();
    }
} 
```

您可以像这样使用它：

```
 EnumWrapper<SortOrder> SortOptions = new EnumWrapper<SortOrder>(); 
```

然后您可以将其作为属性公开并将其用作您的`ItemsSource`

```
<ComboBox ItemsSource="{Binding SortOptions}" SelectedValue="{Binding Path=SortBy}"/> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T11:51:34.157

虽然马特上面的回答在理论上应该有效，但如果您不想制作包装器，您可以使用这个基于 xaml 的代码。它需要你包含在根命名空间中而不是嵌套在一个类中，但除此之外，你可以在你的顶部`Enums`创建一个并将其绑定到你的.`ObjectDataProvider` `StaticResource``Enum``ComboBox`

```
<UserControl x:Class="TestApplication.DatabaseTable"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:sys="clr-namespace:System;assembly=mscorlib"
             xmlns:local="clr-namespace:TestApplication"
             mc:Ignorable="d" Width="Auto" Height="Auto">
    <UserControl.Resources>
        <ObjectDataProvider ObjectType="{x:Type sys:Enum}" MethodName="GetValues" x:Key="SortOrderProvider">
            <ObjectDataProvider.MethodParameters>
                <x:Type TypeName="local:SortOrder" />
            </ObjectDataProvider.MethodParameters>
        </ObjectDataProvider>
    </UserControl.Resources>
        <DataGrid x:Name="grid" ItemsSource="{Binding ItemsSource}" AutoGenerateColumns="True">
        <DataGrid.Columns>
            <DataGridComboBoxColumn Header="Order" ItemsSource="{Binding Source={StaticResource SortOrderProvider}}" SelectedItemBinding="{Binding SortBy, Mode=TwoWay}"/>
        </DataGrid.Columns>
    </DataGrid>
</UserControl> 
```

# android - 不会生成 R.java (android-maven-plugin)

> ID：13128169
> 
> 赞同：3
> 
> 时间：2012-10-29T19:16:18.243
> 
> 标签：android, maven

我尝试了不同的目标。`mvn package`results in `package R does not exist`, `mvn android:generate-sources`results in`BUILD SUCCESS`但不会`R.java`创建。

我想将我的类打包到一个 jar 容器（不是 apk）中，因为我想将它用作其他项目中的库。

AndroidManifest.xml：（最小设置，因为没有活动）

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example">

    <uses-sdk android:minSdkVersion="8" android:targetSdkVersion="8" />

</manifest> 
```

默认属性：

```
android.library=true
target=android-8 
```

pom.xml：

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">

    <modelVersion>4.0.0</modelVersion>

    <groupId>com.example</groupId>
    <artifactId>mylib</artifactId>
    <version>0.0.1-SNAPSHOT</version>

    <properties>
        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
    </properties>

    <dependencies>
        <dependency>
            <groupId>com.google.android</groupId>
            <artifactId>android</artifactId>
            <version>2.2.1</version>
            <scope>provided</scope>
        </dependency>
    </dependencies>

    <build>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-compiler-plugin</artifactId>
                <version>2.5.1</version>
                <configuration>
                    <source>1.6</source>
                    <target>1.6</target>
                </configuration>
            </plugin>
            <plugin>
                <groupId>com.jayway.maven.plugins.android.generation2</groupId>
                <artifactId>android-maven-plugin</artifactId>
                <version>3.4.0</version>
                <extensions>true</extensions>
            </plugin>
        </plugins>

    </build>

</project> 
```

唯一的资源是`./res/layout/example.xml`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T21:08:42.717

android-maven-plugin 无法从 Android 库项目生成功能齐全的 jar（包含所有已编译的类文件、资源、清单等）。

android-maven-plugin 给出的解决方案是[apklib](http://code.google.com/p/maven-android-plugin/wiki/ApkLib)，它只是库项目的一个 zip（具有相同的目录结构，包含原始 java 文件、资源、清单等）。[我已经在这个答案](https://stackoverflow.com/questions/8823392/android-maven-plugin-apklib-mojo-doesnt-include-compiled-r-in-resulting-apklib/8826739#8826739)中解释了更多关于 apklib 如何工作的信息，对于一些示例项目，请查看[maven-android-plugin-samples/libraryprojects](https://github.com/jayway/maven-android-plugin-samples/tree/master/libraryprojects)。

最远的 android-maven-plugin 可以是一个只包含编译的类文件，没有资源的 jar，这被默认的 <packaging>apklib<packaging> 构建生命周期覆盖，并与 .apklib 文件一起生成。

# xamarin.ios - 从 ABPeoplePickerModule 设置我的 TextField 的文本时获得了 SIGSEGV

> ID：13128170
> 
> 赞同：2
> 
> 时间：2012-10-29T19:16:18.240
> 
> 标签：xamarin.ios, ios6, segmentation-fault, abpeoplepickerview

在我的应用程序中，用户需要输入一些地址信息。从 1.0 版开始，我为此提供了一个地址簿按钮。这在我之前的测试中运行良好，但现在当我尝试设置我的 UITextField.Text 属性时，我得到了一个 SIGSEGV。每当我尝试在 MonoTouches 调试模式下从 PeoplePicker 中选择地址时，都会发生此错误，当我在 iPhone 上尝试时，错误会在设置 TextFields 和推送下一个 ViewController 之间随机发生。我的代码有什么问题还是错误？

 `````
 //AB Button Event
        addressBook.TouchUpInside += delegate {
            //Create new Picker
            ABPeoplePickerNavigationController PP = new ABPeoplePickerNavigationController();
            //Cancel Event
            PP.Cancelled += delegate {
                NavigationController.DismissViewController(true, null);
            };
            //Select Event
            PP.SelectPerson += delegate(object sender, ABPeoplePickerSelectPersonEventArgs e) {
                //Detailed Person View
                ABPersonViewController pv = new ABPersonViewController();
                //Action when clicked on a Property
                pv.PerformDefaultAction += delegate(object person, ABPersonViewPerformDefaultActionEventArgs ev) {
                    //If the Property was an Address
                    if(ev.Property.ToString() == "Address"){
                        string lands = "", orts = "", plzs = "";
                        try{
                            //Read the Detailed Address Data from the clicked property
                            ABMultiValue<PersonAddress> addresses = ev.Person.GetAllAddresses();
                            PersonAddress[] values = addresses.GetValues();
                            lands = values[ev.Identifier.Value].Country.ToString();
                            orts = values[ev.Identifier.Value].City.ToString();
                            plzs = values[ev.Identifier.Value].Zip.ToString();
                        }catch{
                            Console.WriteLine("Fehlerhafte Addresse");
                        }
                        //Set the Textfield with the new information
                        //iPhone Simulator in Debugmode crashes here everytime
                        land.Text = lands;
                        ort.Text = orts;
                        plz.Text = plzs;
                        //Close the Module
                        NavigationController.DismissViewController(true, null);
                    }
                };
                //Set selected Person for the person View
                pv.DisplayedPerson = e.Person;
                //Open Person View with navigation from the PeoplePicker Controller
                PP.PushViewController(pv, true);
            };
            //Open PeoplePicker Controller Module
            NavigationController.PresentViewController(PP, true, null);
        }; 
````  `提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T21:32:34.280

刚刚发布的 MonoTouch 6.0.5 修复了类似的[问题](https://bugzilla.xamarin.com/show_bug.cgi?id=7887)。``

# php - 无法使用 mySQLi 创建数据库

> ID：13128173
> 
> 赞同：0
> 
> 时间：2012-10-29T19:16:25.573
> 
> 标签：php, database, insert, mysqli, set

将值插入数据库时​​总是出错。但是当我只使用 mySQL 时它可以工作，我是 SQLi 的新手，所以请保持温和。

插入.php

```
 <?php
    include("dbinfo.inc.php");

    //connect to mysql server
    $mysqli = new mysqli("localhost", $username, $password, $database);

    //check if any connection error was encountered
    if(mysqli_connect_errno()) {
        echo "Error: Could not connect to database.";
        exit;
    }     

    //insert    
    $query = "insert into client_info set (
    id = '".$mysqli->real_escape_string('')."',
    first = '".$mysqli->real_escape_string($_POST['first'])."',
    last = '".$mysqli->real_escape_string($_POST['last'])."',
    phone = '".$mysqli->real_escape_string($_POST['phone'])."',
    mob = '".$mysqli->real_escape_string($_POST['mob'])."',
    fax = '".$mysqli->real_escape_string($_POST['fax'])."',
    email = '".$mysqli->real_escape_string($_POST['email'])."',
    web = '".$mysqli->real_escape_string($_POST['web'])."',
    com = '".$mysqli->real_escape_string($_POST['com'])."',
    address = '".$mysqli->real_escape_string($_POST['address'])."',
    city = '".$mysqli->real_escape_string($_POST['city'])."',
    state = '".$mysqli->real_escape_string($_POST['state'])."',
    zip = '".$mysqli->real_escape_string($_POST['zip'])."',
    zone = '".$mysqli->real_escape_string($_POST['zone'])."',
    office = '".$mysqli->real_escape_string($_POST['office'])."',
    office_num = '".$mysqli->real_escape_string($_POST['office_num'])."',
    ext_mob = '".$mysqli->real_escape_string($_POST['ext_mob'])."',
    ext_phone = '".$mysqli->real_escape_string($_POST['ext_phone'])."',
    ext_office = '".$mysqli->real_escape_string($_POST['ext_office'])."',
    srv = '".$mysqli->real_escape_string($_POST['srv'])."',
    stype = '".$mysqli->real_escape_string($_POST['stype'])."',
    voip = '".$mysqli->real_escape_string($_POST['voip'])."',
    vpass = '".$mysqli->real_escape_string($_POST['vpass'])."',
    regDate = '".$mysqli->real_escape_string($_POST['regDate'])."',
    acct = '".$mysqli->real_escape_string($_POST['acct'])."',
    Nagents = '".$mysqli->real_escape_string($_POST['Nagents'])."',
    agents = '".$mysqli->real_escape_string($_POST['agents'])."',
    password = '".$mysqli->real_escape_string($_POST['password'])."'
    )";

        //execute the query
        if( $mysqli->query($query) ) {
            //if saving success
            echo "User was created.";
        }else{
            //if unable to create new record
            echo "Database Error: Unable to create record.";
        }
        //close database connection
        $mysqli->close();

    ?> 
```

创建.php

```
<html>
<head>
<title></title>
<script language="JavaScript">
var today=new Date();
var jran=today.getTime();

function random() {
    ia=9301;
    ic=49297;
    im=233280;
    jran = (jran*ia+ic) % im;
    return jran/(im*1.0);
};

function rand(number) {
    return Math.ceil(random()*number);
};

function makearray(n) {
    this.length = n;
    for (var i = 1; i <= n; i++) this[i] = 0;
    return this;
}

var asciitable = new makearray (128);
asciitable.length=128;
for (var i=0;i<=127;i++) asciitable[i]="";
asciitable[33]="!"; asciitable[34]="\""; 
asciitable[35]="#"; asciitable[36]="$";
asciitable[37]="%"; asciitable[38]="&"; 
asciitable[39]="'"; asciitable[40]="(";
asciitable[41]=")"; asciitable[42]="*"; 
asciitable[43]="+"; asciitable[44]=",";
asciitable[45]="-"; asciitable[46]="."; 
asciitable[47]="/"; asciitable[48]="0";
asciitable[49]="1"; asciitable[50]="2"; 
asciitable[51]="3"; asciitable[52]="4";
asciitable[53]="5"; asciitable[54]="6"; 
asciitable[55]="7"; asciitable[56]="8";
asciitable[57]="9"; asciitable[58]=":"; 
asciitable[59]=";"; asciitable[60]="<";
asciitable[61]="="; asciitable[62]=">"; 
asciitable[63]="?"; asciitable[64]="@";
asciitable[65]="A"; asciitable[66]="B"; 
asciitable[67]="C"; asciitable[68]="D";
asciitable[69]="E"; asciitable[70]="F"; 
asciitable[71]="G"; asciitable[72]="H";
asciitable[73]="I"; asciitable[74]="J"; 
asciitable[75]="K"; asciitable[76]="L";
asciitable[77]="M"; asciitable[78]="N"; 
asciitable[79]="O"; asciitable[80]="P";
asciitable[81]="Q"; asciitable[82]="R"; 
asciitable[83]="S"; asciitable[84]="T";
asciitable[85]="U"; asciitable[86]="V"; 
asciitable[87]="W"; asciitable[88]="X";
asciitable[89]="Y"; asciitable[90]="Z"; 
asciitable[91]="["; asciitable[92]="\\";
asciitable[93]="]"; asciitable[94]="^"; 
asciitable[95]="_"; asciitable[96]="`";
asciitable[97]="a"; asciitable[98]="b"; 
asciitable[99]="c"; asciitable[100]="d";
asciitable[101]="e"; asciitable[102]="f"; 
asciitable[103]="g"; asciitable[104]="h";
asciitable[105]="i"; asciitable[106]="j"; 
asciitable[107]="k"; asciitable[108]="l";
asciitable[109]="m"; asciitable[110]="n"; 
asciitable[111]="o"; asciitable[112]="p";
asciitable[113]="q"; asciitable[114]="r"; 
asciitable[115]="s"; asciitable[116]="t";
asciitable[117]="u"; asciitable[118]="v"; 
asciitable[119]="w"; asciitable[120]="x";
asciitable[121]="y"; asciitable[122]="z"; 
asciitable[123]="{"; asciitable[124]="|";
asciitable[125]="}"; asciitable[126]="~";

function nchar(num) {
    if ((num>=33) && (num<=127)) return asciitable[num];
}

function doit() {
    var i;
    var n;
    var s = "";
            for (i=1;i<=8;i++) {
                n=0;
                while ( (n<=47) || 
                                        ((n>=58) && (n<=96)) || 
                                        (n>=123))  n = rand(126);
                s = s + nchar(n);
            }

    document.gen.password.value = s;
}
</script>
</head>

<body>

<form method="post" action="insert.php" name="gen">
<b>Personal Info:</b>
<p>First Name:<input type="text" name="first" size="20" /></p>
<p>Last Name:<input type="text" name="last" size="20" /></p>
<p>Mob:<input type="text" name="mob" size="20" />
ext:<input type="text" name="ext_mob" size="4" /></p>
<p>Phone:<input type="text" name="phone" size="20" />
ext:<input type="text" name="ext_phone" size="4" /></p>
<p>Fax:<input type="text" name="fax" size="20" /></p>
<p>E-mail:<input type="text" name="email" size="35" />
<p>Address:<input type="text" name="address" size="40" /></p>
<p>City:<input type="text" name="city" size="20" /></p>
<p>State:<input type="text" name="state" size="20" /></p>
<p>Zip Code:<input type="text" name="zip" size="5" /></p>
<p>Zone:<input type="text" name="zone" size="5" /></p>
<br>

<b>Office Info:</b>
<p>Company:<input type="text" name="com" size="40" /></p>
<p>Office Address:<input type="text" name="office" size="40" /></p>
<p>Office Num #:<input type="text" name="office_num" size="15" />
ext:<input type="text" name="ext_office" size="4" /></p>
<p>Website:<input type="text" name="web" size="30" /></p><br>
<b>Account Info:</b>
<p>Registry Date:<input type="text" name="regDate" size="30" /></p>
<p>Account:<input type="text" name="acct" size="20" /></p>
<p>Service:<input type="text" name="srv" size="15" /></p>
<p>Service Type:<input type="text" name="stype" size="40" /></p>
<p>Number of Agents:<input type="text" name="Nagents" size="3" /></p><br>

<b>Agent Info:</b>
<p>Agents:<input type="text" name="agents" size="40" /></p>
<p>VOID:<input type="text" name="voip" size="20" /></p>
<p>VOIP Password:<input type="text" name="vpass" size="20" /></p>
<br>

<input type="hidden" size="20" name="password">

<input type="submit" name="go" value="Insert to Database" onclick="doit()">
</form>

</body>
</html> 
```

我得到的错误是当脚本尝试将查询插入数据库时

“数据库错误：无法创建记录。”

我试图查看我的表单上是否有任何输出，甚至尝试仅插入一个变量“first”仍然出现错误，不知道我在这里做错了什么

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T19:18:43.073

如果您`SET`在语句中使用语法`INSERT`，则不应在其周围使用括号。

```
-- One way to insert
INSERT INTO table SET col1 = 'val1', col2 = 'val2';

-- other way
INSERT INTO table(col1,col2) VALUES('val1','val2'); 
```

还可以使用[驱动程序提供的本机错误](http://php.net/manual/en/mysqli.error.php)来查看您的查询有什么问题

# c# - 合同优先的 WCF 服务 - 仍然有效吗？

> ID：13128174
> 
> 赞同：3
> 
> 时间：2012-10-29T19:16:30.020
> 
> 标签：c#, .net, visual-studio-2010, wcf, wsdl

我正在尝试从现有的 WSDL 创建一些 WCF Web 服务。对此有一些很棒的问题（[1](https://stackoverflow.com/questions/950150/how-to-use-a-wsdl-file-to-create-a-wcf-service-not-make-a-call)、[2](https://stackoverflow.com/questions/1221121/generate-webservice-from-wsdl)，肯定更多），但其中许多是 3 年前的问题，我最终想知道这些建议是否仍然有效。如果是，我如何完成将其集成到 Visual Studio 2010 中的 WCF 项目中？问题和链接的博客文章对于如何配置 .svc 以在运行后使用转换后的 WSDL 相当含糊`svchost.exe`（有关详细信息，请参阅链接的问题 1），并且线程中链接的[博客文章](http://blogs.msdn.com/b/dotnetinterop/archive/2008/09/24/wsdl-first-development-with-wcf.aspx)表明有一种方法让 Visual Studio 围绕转换后的 WSDL 创建一个 .svc，但我在程序界面或文档中的任何地方都找不到它。

所以，我想，问题是：在 Visual Studio 2010/.NET 4.0 中进行合同优先 Web 服务设计的一般推荐方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T19:28:07.630

它没有改变。您仍然可以使用 svcutil 和 WSDL 生成服务接口及其数据契约。甚至会生成一个客户端，尽管您不需要它。

然后，您可以创建一个 .svc 文件，该文件仅指示 ServiceHost 托管哪个类，如下[所述](https://stackoverflow.com/questions/9925941/how-do-i-generate-the-svc-file)：

```
<% @ServiceHost Service="MyNamespace.MyServiceImplementationTypeName" %> 
```

您的实现当然必须实现生成的服务接口。

# iphone - 使用核心数据和 ARC 进行简单的内存管理

> ID：13128175
> 
> 赞同：0
> 
> 时间：2012-10-29T19:16:31.923
> 
> 标签：iphone, objective-c, ios, core-data, automatic-ref-counting

尽管 ARC 显着简化了事情，但我仍然习惯于 Objective-c 中的一些内存管理细节。这是一行代码：

```
[song addEntriesObject:self.entry]; 
```

where`song`是一个托管对象，我通过在托管对象上下文上执行获取请求来访问它，并`self.entry`引用在初始化时传递给此类的实例变量，并且也是托管对象（即它是核心数据实体 - 希望我'正在正确使用该术语）。

我的问题只是这是否会导致内存管理出现任何问题，即分配`self.entry`给托管对象是否会阻止该实例变量被释放，因为它被核心数据或类似的东西保留。这会产生任何问题，还是核心数据不会以相同的方式维护指向对象的指针？还是我的思维过程完全走错了路？

任何关于这个主题的想法将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T12:35:18.320

牛牛，

Core Data 对象是`NSObject`s，因此行为相同。换句话说，内存管理没有任何变化。在您的示例中，`self.entry`您的实例和`song`.

独立于 ARC，Core Data 项可以保留大型对象图。这些可能需要修剪。该`-refreshObject:mergeChanges:`方法用于执行此操作。为了避免一些痛苦，您应该始终`-save:`在修剪图表之前使用。

安德鲁

# java - 在 C JNI 库中使用 Java InputStream

> ID：13128176
> 
> 赞同：2
> 
> 时间：2012-10-29T19:16:42.843
> 
> 标签：java, android, c, java-native-interface

我有一个 Android 项目，它使用 C 库来解析某种类型的文件。我正在使用 AES 和 CipherInputStreams 和 CipherOutputStreams 为项目添加加密。问题是 Java 代码将文件名和描述符传递给 C 库，然后 C 库执行文件读取。照原样，如果文件是加密存储的，C 库只会将该文件作为垃圾读取。有没有办法将 CipherInputStream 传递给 C 代码以便处理解密？或者我应该只用Java解密文件并将其作为纯文本存储在私有存储中，然后将其文件描述符发送到C代码？这似乎相对低效。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T19:55:17.240

由于您可以修改 C 代码，我建议您直接在其中构建加密层。这样，您的 Java 代码就不会关心它是否位于加密文件之上。

如果您确实想在 Java 代码中使用该加密逻辑，那么我认为您需要在 Java 中进行 byte[] 读取并将 InputStream.read 的每个结果传递给您的 C 代码。您可能需要为此更改 API，并且需要一种方法在完成后告诉 C 代码。

# image - Ipad 流 m3U8 在 iOS 6 上片刻后丢失图像

> ID：13128178
> 
> 赞同：1
> 
> 时间：2012-10-29T19:16:52.657
> 
> 标签：image, ipad, video, stream, ios6

`m38u`我在我的平板电脑上播放的流很少有问题代码是这样的：

```
<video width="440" height="280" controls="controls"
 src="http://fms3.mediadirect.ro/live3/protvint/playlist.m3u8?publisher=1"
type="video/mp4" >
</video> 
```

问题是几秒钟后（10-15），流丢失图像/落后/重复，然后在某个时候又回来了。我注意到其他流的行为相同。

我有 iOS 5.1，它们运行完美，但在我升级到 iOS 6 后，这个问题开始显现！

还有其他人知道这个问题吗？是 iOS6 错误还是我缺少的东西？请帮忙！

# java - LDAP 查询不会从 Active Directory 返回正确的数据

> ID：13128180
> 
> 赞同：15
> 
> 时间：2012-10-29T19:17:07.803
> 
> 标签：java, active-directory, ldap, unboundid-ldap-sdk

我正在开发一种从 AD 获取用户详细信息并将其导入另一个系统的工具。我们计划使用 objectSid 作为唯一标识符，但我发现由于某种原因，LDAP 结果中的 objectSid 与 Active Directory 中的不匹配。大多数字节是相同的，但也有一些不同，有时 LDAP 结果的字节数比 AD 中的字节数少。

来自 AD 中用户的 objectSid：

```
decimal: [ 1,  5,  0,  0,  0,  0,  0,  5, 21,  0,  0,  0, 35, 106, 222, 96, 236, 251, 239, 68, 32, 255, 234, 203, 122,  4,  0,  0]
hex:     [01, 05, 00, 00, 00, 00, 00, 05, 15, 00, 00, 00, 23,  6A,  DE, 60,  EC,  FB,  EF, 44, 20,  FF,  EA,  CB,  7A, 04, 00, 00] 
```

通过 LDAP 结果的同一用户的 objectSid：

```
decimal: [ 1,  5,  0,  0,  0,  0,  0,  5, 21,  0,  0,  0, 35, 106,  63, 96,  63,  63,  63, 68, 32,  63,  63,  63, 122,  4,  0,  0]
hex:     [01, 05, 00, 00, 00, 00, 00, 05, 15, 00, 00, 00, 23,  6A,  3F, 60,  3F,  3F,  3F, 44, 20,  3F,  3F,  3F,  7A, 04, 00, 00] 
```

似乎任何超过 128 的值在 LDAP 结果中返回为 63/3F。对于另一个用户，LDAP 结果缺少 1 个字节（问号）：

```
hex from AD:   [01 05 00 00 00 00 00 05 15 00 00 00 23 6A DE 60 EC FB EF 44 20 FF EA CB 88 04 00 00]
hex from LDAP: [01 05 00 00 00 00 00 05 15 00 00 00 23 6A 3F 60 3F 3F 3F 44 20 3F 3F 3F ?? 04 00 00] 
```

这是我用来进行这些测试的代码的主要部分。

```
final String ldapADServer = "ldap://" + cmdLine.getOptionValue("ldap");
final String bindDN = cmdLine.getOptionValue("u");
final String bindCredential = cmdLine.getOptionValue("p");
final String baseCtxDN = cmdLine.getOptionValue("d");

final Hashtable<String, Object> env = new Hashtable<String, Object>();
env.put(Context.SECURITY_AUTHENTICATION, "simple");
env.put(Context.SECURITY_PRINCIPAL, bindDN);
env.put(Context.SECURITY_CREDENTIALS, bindCredential);
env.put(Context.INITIAL_CONTEXT_FACTORY, "com.sun.jndi.ldap.LdapCtxFactory");
env.put(Context.PROVIDER_URL, ldapADServer);
env.put("com.sun.jndi.ldap.trace.ber", System.err);

final LdapContext ctx = new InitialLdapContext(env, null);

final String searchFilter = "(&(objectClass=user) (sAMAccountName=" + accountName + "))";

final SearchControls searchControls = new SearchControls();
searchControls.setSearchScope(SearchControls.SUBTREE_SCOPE);

final StringBuilder builder = new StringBuilder();
final NamingEnumeration<SearchResult> results = ctx.search(baseCtxDN, searchFilter, searchControls);
while (results != null && results.hasMoreElements()) {
    final SearchResult result = results.nextElement();
    builder.append(LdapHelper.getSearchResultDetails(result, ""));
}

logger.info("Search results: {}{}", StringUtils.NEW_LINE, builder.toString()); 
```

LdapHelper 简单地遍历所有属性并以格式良好的字符串返回它们。objectGUID 和 objectSid 以十六进制格式打印。

我使用 JRE 6 和 JRE 7 运行测试，结果相同。我们的 AD 服务器是 Window Server 2008 RC2，我尝试使用 AD 端口 389 和 3268。

我现在要研究其他 Java LDAP 库，但我想看看其他人是否遇到过这些问题，或者有人知道为什么会这样以及如何解决它吗？即有没有办法从 AD 中获取正确的值？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-05T21:37:02.627

我现在使用 UnboundID LDAP SDK 完成了相同的操作，它可以正常工作并返回完整且正确的 objectSid 以及 objectGUID。所以这似乎是标准 J2SE 库中的一个错误？

如果有人感兴趣，代码可以做到这一点：

```
private static void unboundIdLdapSearch(final String ldapADServer, final String bindDN, final String bindCredential, final String baseCtxDN, final String userName) throws LDAPException, Exception {
    final LDAPConnection connection = new LDAPConnection(ldapADServer.substring(0, ldapADServer.indexOf(':')),
        Integer.parseInt(ldapADServer.substring(ldapADServer.indexOf(':') + 1)), bindDN, bindCredential);
    findAccountByAccountName(connection, baseCtxDN, userName);
    connection.close();
}

private static void findAccountByAccountName(final LDAPConnection connection, final String baseCtxDN, final String accountName) throws Exception {

    final String searchFilter = "(&(objectClass=user)(sAMAccountName=" + accountName + "))";

    logger.info("LDAP search filter: {}", searchFilter);

    final SearchRequest request = new SearchRequest(baseCtxDN, SearchScope.SUB, searchFilter);
    final com.unboundid.ldap.sdk.SearchResult result = connection.search(request);
    final int numOfResults = result.getEntryCount();
    final StringBuilder builder = new StringBuilder();
    builder.append("Search returned with ").append(numOfResults).append(" results: ").append(StringUtils.NEW_LINE);
    for (final SearchResultEntry entry : result.getSearchEntries()) {
        builder.append(LdapHelper.getSearchResultDetails(entry, ""));
    }

    logger.info("Search results: {}{}", StringUtils.NEW_LINE, builder.toString());
} 
```

此外，我碰巧偶然发现了为什么 JNDI LDAP 方法不能正常用于 objectSid 和 objectGUID，并且除了我的 UnboundID 解决方案之外，它还可以正常工作。

首先，我意识到，当我使用返回字符串的“getValue”的 UnboundID 方法时，它还返回了与 J2SE JNDI 版本相同的值，这是当我发现这会将字符串转换为 UTF-8 时导入的值。

然后我碰巧遇到了另一篇博文（[http://www.jroller.com/eyallupu/entry/java_jndi_how_to_convert](http://www.jroller.com/eyallupu/entry/java_jndi_how_to_convert)）以及这个页面：[http ://docs.oracle.com/javase/jndi/tutorial/ldap/杂项/attrs.html](http://docs.oracle.com/javase/jndi/tutorial/ldap/misc/attrs.html)。因此，为了正确获取 objectSid 和 objectGUID，所需要做的就是通过将空格分隔的属性名称列表添加到 LDAP 上下文的映射中，将它们添加到二进制属性列表中：

```
env.put("java.naming.ldap.attributes.binary", "objectSid objectGUID"); 
```

# c - 在 C #define _XOPEN_SOURCE 500 中预读

> ID：13128183
> 
> 赞同：2
> 
> 时间：2012-10-29T19:17:24.557
> 
> 标签：c, compilation, header-files

我在让 pread() 在头文件中工作时遇到了一些麻烦。每次我编译程序时，它都会告诉我有一个因为语句`#define _XOPEN_SOURCE 500`。错误是：

```
In file included from networking.h:6,
                 from networking.c:1:
/usr/include/bsd/stdlib.h:47: error: expected ‘)’ before ‘*’ token
make: *** [all] Error 1 
```

头文件中的头文件是

```
#ifndef NETWORKING_H
#define NETWORKING_H

#define _XOPEN_SOURCE 500

#include<bsd/stdlib.h>
#include<netinet/in.h>
#include<sys/errno.h>
#include<sys/types.h>
#include<sys/socket.h>

#include<ctype.h>
#include<fcntl.h>
#include<limits.h>
#include<netdb.h>
#include<pwd.h>
#include<stdlib.h>
#include<stdio.h>
#include<string.h>
#include<unistd.h>

#include"html.h" 
```

谢谢！

```
#ifndef LIBBSD_STDLIB_H
#define LIBBSD_STDLIB_H

#include <sys/cdefs.h>
#include <sys/stat.h>
#include <stdint.h>
#include <stdlib.h>

/* For compatibility with NetBSD, which defines humanize_number here. */
#include <libutil.h>

/* FIXME: Temporary inclusions to avoid API breakage, will be removed soon. */
#include <bsd/stdio.h>
#include <bsd/unistd.h>

__BEGIN_DECLS
u_int32_t arc4random();
void arc4random_stir();
void arc4random_addrandom(u_char *dat, int datlen);

int dehumanize_number(const char *str, int64_t *size);

char *getprogname ();
void setprogname (char *); 
```

# c# - ExecuteJavaScript 失败并出现错误“ReferenceError：OpenQA 未定义”

> ID：13128186
> 
> 赞同：0
> 
> 时间：2012-10-29T19:17:26.697
> 
> 标签：c#, selenium, webdriver

我正在尝试通过 javascript 执行器模拟锚标记上的右键单击事件。但收到错误“ReferenceError: OpenQA is not defined”。我不确定这是否是在 selenium 脚本中调用 JS 函数的正确方法。

```
IWebElement folderAtag = driver.FindElement(By.XPath("//[@title='folderA911536']"));          
 IJavaScriptExecutor js2 = ((IJavaScriptExecutor)driver);

      js2.ExecuteScript(
          "function contextMenuClick(element){" +

             "var evt = element.ownerDocument.createEvent('MouseEvents');" +

              "var RIGHT_CLICK_BUTTON_CODE = 2; " +

              " evt.initMouseEvent('contextmenu', true, true," +
              "  element.ownerDocument.defaultView, 1, 0, 0, 0, 0, false, " +
              " false, false, false, RIGHT_CLICK_BUTTON_CODE, null); " +

              " if (document.createEventObject){ " +

                 "    return element.fireEvent('onclick', evt) " +
                 "  } " +
               " };" +
           "contextMenuClick(" + folderAtag + ");"
           ); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T10:02:28.903

为了正确执行 js 代码，我使用 stringBuilder。例如下面：

```
public void jsClick(String key) throws IOException {
        JavascriptExecutor js = (JavascriptExecutor) driver;
        StringBuilder stringBuilder = new StringBuilder();
        stringBuilder.append("var x = $(\'"+propertyKeysLoader(key) +"\');");
        stringBuilder.append("x.click();");
        js.executeScript(stringBuilder.toString());
    } 
```

顺便说一句，鼠标右键单击我将以这种方式解决的元素：

```
WebElement elem = driver.findElement(By.xpath("//[@title='folderA911536']"));
new Actions(driver).contextClick(elem).perform(); 
```

# audio - 我可以从用 C++ 编写的 DLL 播放音频（或音频/视频）文件吗？

> ID：13128191
> 
> 赞同：0
> 
> 时间：2012-10-29T19:17:46.553
> 
> 标签：audio, dll, windows-7

我们想从 DLL 播放音频（和视频）文件。RenderSharedEvent/TimerDriven 可以工作，但出于多种原因，我们更喜欢在更高级别进行播放 - Media Foundation，甚至不推荐使用的 MediaPlay 或 waveOut 函数也可以工作。但是，到目前为止，我还没有看到回调，它们似乎是该过程的关键部分。

那是因为它们不能通过 DLL 工作，还是我缺少什么？我记得以前不可能从 DLL 中使用 waveOut，但我认为新框架会支持 DLL。

# java - Java——如何动态引用对象的属性？

> ID：13128194
> 
> 赞同：8
> 
> 时间：2012-10-29T19:17:56.350
> 
> 标签：java

在javascript中，我可以这样做：

```
function MyObject(obj) {
    for (var property in obj) {
        this[property] = obj[property];
    }
} 
```

我可以在 Java 中做任何事情吗？

```
class MyObject {
    String myProperty;

    public MyObject(HashMap<String, String> props) {
        // for each key in props where the key is also the name of
        // a property in MyObject, can I assign the value to this.[key]?
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-29T19:59:33.980

并不是说我不同意乔尔的回答，但我认为这并不难，如果你基本上只是想尽最大努力。基本上检查它是否存在，以及是否尝试设置。如果效果很好，如果不是，那么我们试过了。例如：

```
import java.lang.reflect.Field;
import java.util.HashMap;
import java.util.Map;

public class MyObject {

    protected String lorem;
    protected String ipsum;
    protected int integer;

    public MyObject(Map<String, Object> valueMap){
        for (String key : valueMap.keySet()){
            setField(key, valueMap.get(key));
        }
    }

    private void setField(String fieldName, Object value) {
        Field field;
        try {
            field = getClass().getDeclaredField(fieldName);
            field.set(this, value);
        } catch (SecurityException e) {
            e.printStackTrace();
        } catch (NoSuchFieldException e) {
            e.printStackTrace();
        } catch (IllegalArgumentException e) {
            e.printStackTrace();
        } catch (IllegalAccessException e) {
            e.printStackTrace();
        }
    }

    public static void main(String[] args) {
        Map<String, Object> valueMap = new HashMap<String, Object>();
        valueMap.put("lorem", "lorem Value");
        valueMap.put("ipsum", "ipsum Value");
        valueMap.put("integer", 100);
        valueMap.put("notThere", "Nope");

        MyObject f = new MyObject(valueMap);
        System.out.println("lorem => '"+f.lorem+"'");
        System.out.println("ipsum => '"+f.ipsum+"'");
        System.out.println("integer => '"+f.integer+"'");
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2019-02-22T04:47:43.330

*首先，如果可能*的话，我会使用地图：

```
class MyObject {

     // String myProperty; // ! not this
     HashMap<String,String> myProperties;  // use this instead

} 
```

但假设您想动态设置字段。

```
public MyObject(HashMap<String, String> props) {
    for (Map.Entry<String,String> entry : props.entrySet()) {
        Field field = this.getClass().getField(entry.getKey());
        field.set(this, entry.getValue());
    }
} 
```

当然，您会希望在上述构造函数中使用 try/catch。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-29T19:36:32.623

是的，您可以通过以下方式进行反思：

```
/**
 * Returns a list of all Fields in this object, including inherited fields.
 */
private List<Field> getFields() {
    List<Field> list = new ArrayList<Field>();
    getFields(list, getClass());
    return list;
}

/**
 * Adds the fields of the provided class to the List of Fields. 
 * Recursively adds Fields also from super classes.
 */
private List<Field> getFields(List<Field> list, Class<?> startClass) {
    for (Field field : startClass.getDeclaredFields()) {
        list.add(field);
    }
    Class<?> superClass = startClass.getSuperclass();
    if(!superClass.equals(Object.class)) {
        getFields(list, superClass);
    }
}

public void setParameters(Map<String, String> props) throws IllegalArgumentException, IllegalAccessException {
    for(Field field : getFields()) {
        if (props.containsKey(field.getName())) {
            boolean prevAccessible = field.isAccessible();
            if (!prevAccessible) {
                /*
                 * You're not allowed to modify this field. 
                 * So first, you modify it to make it modifiable.
                 */
                field.setAccessible(true);
            }
            field.set(this, props.get(field.getName()));

            /* Restore the mess you made */
            field.setAccessible(prevAccessible);
        }
    }
} 
```

但是，如果您对 Java 不是很熟悉，则应尽可能避免使用这种方法，因为它有些危险且容易出错。例如，不能保证`Field`您尝试设置的实际上是一个字符串。如果不是这样，您的程序将崩溃并烧毁。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-29T20:11:49.580

好吧，如果你真的想走下反射之路，那么我建议你看看[Introspector](http://docs.oracle.com/javase/7/docs/api/java/beans/Introspector.html)类并从 BeanInfo 中获取 PropertyDescriptors 的列表。

# windows - COM 服务器：调用接口方法时，ESP 未跨函数调用保存

> ID：13128199
> 
> 赞同：2
> 
> 时间：2012-10-29T19:18:11.580
> 
> 标签：windows, com, calling-convention, stdcall, out-of-process

我正在在 EXE 文件中实现 COM 服务器。准确地说，我正在向现有应用程序添加一个 COM 接口。最终目标是自动化应用程序。

第一个组件和一个接口（到目前为止只有一个方法）基本就位。我可以在 DLL 中构建一个进程内服务器并成功获取接口指针并调用该方法。这是第一步，因为我只是在学习。以后我不需要 DLL；它只是作为我的组件和界面基本没问题的概念证明。

然后我在 EXE 中构建了一个进程外服务器。我已经到了可以`CoCreateInstance()`从客户端调用的地步，EXE 启动，注册它的工厂，工厂创建组件的实例。`CoCreateInstance`返回 S_OK 并且客户端接收到一个不为 NULL 的接口指针。

当我调用接口的方法时会出现问题。

*   首先，方法中的断点没有被命中（是的，在另一个进程中，不过我也在调试服务器。服务器中的其他断点被命中ok）。
*   第二，客户报告`Run-Time Check Failure #0 - The value of ESP was not properly saved across a function call. This is usually a result of calling a function declared with one calling convention with a function pointer declared with a different calling convention.`。

*我绝对知道 COM 接口中的方法必须使用`__stdcall`*，并且我已经检查了好几次它没有丢失。此外，组件（C++）的实现源自 MIDL 生成的接口。所以接口的头文件有正确的调用约定，如果组件的头文件没有，编译器会抱怨覆盖不同。

由于断点甚至没有被命中，我的直觉是本地过程调用存在根本性错误，就像未正确设置 vtbl 一样。有没有人建议什么可能导致观察到的行为？关于如何调试代理/存根代码的任何提示？

编辑：

作为对 WhozCraig 的回应，这里是 IDL 文件：

```
import "unknwn.idl";

// Interface IMyApp1
[
   object,
   uuid(440EA043-DF6D-4df9-963D-7660BBA829EF),
   helpstring("IMyApp1 Interface"),
   pointer_default(unique)
]

interface IMyApp1: IUnknown
{
   HRESULT ShowAboutBox(void);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T22:18:55.697

我发现了问题。这是一个相当尴尬的错误，但有趣的是知道它会导致观察到的效果，所以我会在这里发布它以防其他人遇到同样的问题。

客户在做

```
HdResult = CoCreateInstance(
   sClassIdApp,
   NULL,
   CLSCTX_LOCAL_SERVER,
   IID_IUnknown,   // Oops...
   (void**) &pInterface);

pInterface->ShowAboutBox(); 
```

代替

```
HdResult = CoCreateInstance(
   sClassIdApp,
   NULL,
   CLSCTX_LOCAL_SERVER,
   IID_IMyApp1,
   (void**) &pInterface);

pInterface->ShowAboutBox(); 
```

呃...

# c# - 基础提供程序在打开时失败

> ID：13128200
> 
> 赞同：0
> 
> 时间：2012-10-29T19:18:13.730
> 
> 标签：c#, silverlight, entity-framework, silverlight-5.0, entity-framework-5

我正在使用`EntityFramework`平台`Windows Azure`。它在`LOCAL`模式下运行良好，但是当我尝试`Silverlight`在 Web 上运行我的应用程序时。我收到一个错误：

> 基础提供程序在打开时失败。

```
<configuration>
  <system.webServer>
    <modules runAllManagedModulesForAllRequests="true">
      <add name="DomainServiceModule" preCondition="managedHandler" type="System.ServiceModel.DomainServices.Hosting.DomainServiceHttpModule, System.ServiceModel.DomainServices.Hosting, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
    </modules>
    <validation validateIntegratedModeConfiguration="false" />
  </system.webServer>
  <appSettings>
    <add key="aspnet:UseTaskFriendlySynchronizationContext" value="true" />
    <add key="ValidationSettings:UnobtrusiveValidationMode" value="WebForms" />
  </appSettings>
  <system.web>
    <httpModules>
      <add name="DomainServiceModule" type="System.ServiceModel.DomainServices.Hosting.DomainServiceHttpModule, System.ServiceModel.DomainServices.Hosting, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
    </httpModules>
    <customErrors mode="Off" />
    <compilation debug="true" targetFramework="4.5">
      <assemblies>
        <add assembly="System.Data.Entity, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" />
      </assemblies>
    </compilation>
    <httpRuntime requestValidationMode="4.5" targetFramework="4.5" encoderType="System.Web.Security.AntiXss.AntiXssEncoder, System.Web, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" />
    <pages controlRenderingCompatibilityVersion="4.5" />
    <machineKey compatibilityMode="Framework45" />
  </system.web>
  <system.serviceModel>
    <serviceHostingEnvironment aspNetCompatibilityEnabled="true" multipleSiteBindingsEnabled="true" />
  </system.serviceModel>
  <connectionStrings>
    <add name="DatabaseEntities" connectionString="metadata=res://*/Model.csdl|res://*/Model.ssdl|res://*/Model.msl;provider=System.Data.SqlClient;provider connection string=&quot;data source=lnqg2ulkjr.database.windows.net;initial catalog=BuilderDatabase;persist security info=True;user id=XXXXX;password=XXXXX;MultipleActiveResultSets=True;App=EntityFramework&quot;" providerName="System.Data.EntityClient" />
  </connectionStrings>
</configuration> 
```

我正在检查这是连接字符串中的问题，`Integrated Security`但在我的情况下，我没有该属性。可能是什么错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T19:42:34.823

此错误来自实体 - 它与 Silverlight 无关。它发生在以下两种情况之一发生时：

*   实体尝试登录到您指向的数据库，但被拒绝权限/找不到服务器/找不到实例/有其他一些连接错误
*   实体成功登录，但找不到它识别的数据模型

第二个应该很容易检查，因为你有一个工作的本地人。如果您本地的数据模型与您的“生产”环境中的数据模型相同，那么该部分将得到处理。如果您有不同的表，您可能会遇到一些问题。如果它们缺少您已编码到实体数据模型中的列，则这是双重事实。在许多情况下，实体会容忍额外的列和额外的表，尽管这会根据情况发生很大变化，所以 YMMV。但是，如果 Entity 期望某些东西在那里，但它不是，它每次都会快速崩溃。

我更大的怀疑是你那里的连接字符串相当棒。您应该能够检查`InnerException`您所获得的信息，以了解数据库服务器引发的具体问题。如果不是，我会把它撕成一个控制台应用程序，并尝试与一个普通的简连接，`SqlConnection`做一个简单的`Select count(Id) from dbo.SmallTable`. 这将允许您隔离连接问题并在一个良好的受限环境中处理它们。在对连接问题进行排序后，您可以将连接字符串（现在希望不再那么混乱）粘贴回去并继续。

# ios - MKMapView中用户位置标注的轨迹选择

> ID：13128201
> 
> 赞同：2
> 
> 时间：2012-10-29T19:18:21.707
> 
> 标签：ios, mkmapview, mkannotation, userlocation

我有一个 iPhone 应用程序可以缩放到用户所在位置最近的城市，我希望用户能够双击**userLocation 注释**并将地图放大到大约一个街区左右。

如何让`userLocation`注释识别它正在被窃听？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-29T20:41:40.917

```
- (void)mapView:(MKMapView *)mapView1 didSelectAnnotationView:(MKAnnotationView *)mapView2
{
    id<MKAnnotation> annotation = mapView2.annotation;
    if ([annotation isKindOfClass:[MKUserLocation class]]) {
          // this is where you can find the annotation type is whether it is userlocation or not...
     }
} 
```

the above method is a delegate method and you need to add `MKMapViewDelegate` in your interface file

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-10-09T22:51:16.890

这是 Swift 4 中的代码：

```
func mapView(_ mapView: MKMapView, didSelect view: MKAnnotationView) {
    if view.annotation is MKUserLocation {
        // You tapped on the user location
    }
} 
```

# jquery - .hide() 在 iPad 上无法正常工作

> ID：13128210
> 
> 赞同：0
> 
> 时间：2012-10-29T19:18:52.423
> 
> 标签：jquery, ipad

我有一个基于图像数组的图像幻灯片放映，这些图像在我的页面上提供单个 img 元素。当我到达最后一张图像并按下触发 nextImage() 函数的“下一个”时，我想隐藏我的最终图像并调出启动画面（同一页面上的 div，由 css 隐藏）。这段代码在 safari 中效果很好，但它似乎没有隐藏 iPad（我的目标设备）上的图像元素。我不知道是什么导致这不起作用。

```
function endPresentation(){
    $("#image").hide(200);
    $("#test").show(200);
}

//Goto Next image in array
function nextImage(){

    save();
    iCount++;

//If there are no more images in the array
    if (images[iCount] == null) {
        endPresentation();
    }
    else{                       
        //Change image source to new image, do stuff after the image has successfully loaded
        $("#image").attr("src", images[iCount]).load(function (){               
            doStuff();  
        });         
    }               
} 
```

任何帮助将不胜感激，因为这已经困扰我好几个星期了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T19:23:03.687

不要使用 jquery 隐藏元素，而是尝试添加`style="display:none"`到`#image`html 中的元素。这应该使 jquery 更容易切换图像的可见性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T19:26:54.870

我会尝试使用 iCount 简单地将最后显示的图像隐藏在“if”语句中 - 以返回到最后一个现有图像，然后，如有必要，我只需使用 .remove(); 删除 div；希望它有效！

因此，您检查 iCount 是否为空。如果是，iCount--，隐藏（200）它，如果有必要，你在动画结束后用 .parent('#image') 删除#image。（您可能需要仔细检查语法）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-06T14:58:28.703

解决了在调用 hide 和 show 方法时添加 10 ms 超时的问题：

```
function endPresentation(){
  setTimeout(function(){
      $("#image").hide(200);
      $("#test").show(200);
  },10)
} 
```

在 iPad 4 上测试

# c# - 如何跨多个层请求 MEF 中的特定部分

> ID：13128211
> 
> 赞同：1
> 
> 时间：2012-10-29T19:18:56.247
> 
> 标签：c#, inversion-of-control, mef

我有一个 3 层的解决方案

一个

乙

C

在 C 层，我有接口 IRepository，它有两个实现，RepositoryX 和 RepositoryY。

在 B 层，我有接口 IController，在 AI 层有一个名为 Foo 的类。现在我知道我可以通过使用合同名称或导出元数据来控制 IRepository 的哪个实现被注入到依赖项中。

在 Controller 的实现中，我可以说我想要 RepositoryX 或 RepositoryY 并且可以。

在 A 层中的类 Foo 中，我对注入的 IController 有一个依赖项。如何在 Foo 类中控制我的 IController 将获得哪个 IRepository 实现？

我会寻找类似的东西：

```
class Foo  
{
    [Import("RepositoryX")]
    public IController MyController { get; set; } 
```

这将注入一个 IController，它本身具有一个类型为 RepositoryX 的存储库，该存储库注入到控制器的导入属性中。

有没有一种方法可以做到这一点，而不必定义除了哪种类型的存储库之外相同的 2 个控制器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T21:04:30.680

正如您所说，您的实现`IController`定义了它使用适当`Import`属性的存储库。无论您的实现是`IController`使用`RepositoryX`还是`RepositoryY`在编译时已知，因此导入`IController`将为您提供`IController`使用在编译时指定的存储库的实现。

您不能要求`IController`使用您选择的存储库的实现，但您可以将存储库设置为属性，以便您可以在`Foo`实现中导入所需的存储库并将其设置在控制器中：

```
class Foo
{
    [ImportingConstructor]
    public Foo(IController myController,
               [Import("RepositoryX")] IRepository repository)
    {
        myController.Repository = repository;
    }
} 
```

# android - 如何在布局内显示进度条？

> ID：13128213
> 
> 赞同：0
> 
> 时间：2012-10-29T19:19:22.713
> 
> 标签：android, progress-bar

我正在使用自定义通知布局。通知布局位于活动内部。通知布局不会填满屏幕的整个部分。它只占屏幕的 1/4。我想在通知布局中显示进度条。所以我的问题是

> 1.  如何设置进度条的位置（除了使用

(ProgressDialog.getWindow().setGravity(Gravity.CENTER);)

> 1.  我们可以设置进度条的宽度和高度（至少到布局的大小）

任何帮助都是非常可观的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T19:58:16.253

《如何设置进度条的位置》：像其他任何类型的View一样使用它（xml会更简单）。

“我们可以设置进度条的宽度和高度（至少到布局的大小）”：

android:maxHeight 一个可选参数，为这个视图提供最大高度。android:maxWidth 一个可选参数，为这个视图提供最大宽度。机器人：最小高度

# css - 什么 CSS 元素控制 bootstrap 的 scrollspy 的活动/悬停？

> ID：13128214
> 
> 赞同：5
> 
> 时间：2012-10-29T19:19:33.140
> 
> 标签：css, twitter-bootstrap

[http://examine.com/v5x/creatine.html#summary](http://examine.com/v5x/creatine.html#summary) - 将鼠标悬停在摘要上。

控制它的 CSS 是什么？我似乎找不到它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T19:38:51.200

活动：`active`类（对于大多数 Bootstrap 功能都是如此）

徘徊：

```
.navbar .nav > li > a:focus,
.navbar .nav > li > a:hover {
  color: #333333;
  text-decoration: none;
  background-color: transparent;
} 
```

[来源](http://twitter.github.com/bootstrap/javascript.html#scrollspy)

**编辑**

您的 CSS 的第 3804 行：

```
.nav-list > .active > a,
.nav-list > .active > a:hover {
  color: #ffffff;
  text-shadow: 0 -1px 0 rgba(0, 0, 0, 0.2);
  background-color: #0088cc;
} 
```

`background-color`这是导致你的蓝色背景。只需将其更改为所需的值，然后更改`color`为`color: #00A5B5;`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T04:57:34.290

解决方案是这样的：

编辑*docs.css*，注释掉

```
 background:none; //line 728 under .bs-docs-sidenav > .active > a { 
```

并编辑*bootstrap.css*，注释掉

```
 background-color: #0088cc;//line 3807 under .nav-list > .active > a:hover { 
```

和改变

```
color: #ffffff;//line 3805 under .nav-list > .active > a:hover { 
```

到

```
 color: #00A5B5; 
```

并且不要忘记在检查更改之前清除浏览器的缓存..

# asp.net - 在调用“WebSecurity”类的任何其他方法之前，您必须调用“WebSecurity.InitializeDatabaseConnection”方法

> ID：13128218
> 
> 赞同：25
> 
> 时间：2012-10-29T19:19:51.673
> 
> 标签：asp.net, asp.net-mvc-4

除了 AccountController.cs 文件中已经生成的内容外，我无法让 WebSecurity 对象在任何地方工作。帐户控制器`[InitializeSimpleMembership]`在顶部设置了属性。例如，登录功能不会抱怨调用`WebSecurity.Login(...)`。我向 AccountController 添加了一个子操作：

```
[ChildActionOnly]
        [AllowAnonymous]
        public ActionResult NavBar()
        {
            NavBarViewModel viewModel = new NavBarViewModel();
            viewModel.LinkItems = new List<NavBarLinkItem>();

            if (Request.IsAuthenticated)
            {
                SimpleRoleProvider roleProvider = new SimpleRoleProvider();
                if (roleProvider.IsUserInRole(User.Identity.Name, "User"))
                {
                    viewModel.LinkItems.Add(new NavBarLinkItem() 
                    { Title = "Create Project", Action = "Create", Controller = "Project" });

                }

            }

            viewModel.LinkItems.Add(new NavBarLinkItem() { Title="Help", Action="Index", Controller="Help" });

            return PartialView("_NavBar", viewModel);
        } 
```

保持原样，代码在 "if (roleProvider.IsUserInRole(User.Identity.Name, "User"))" 行与主题错误消息一起崩溃。所以我进入 InitialzeSimpleMembershipAttribute.cs 文件并将这一行复制/粘贴到我的函数顶部：

```
WebSecurity.InitializeDatabaseConnection("DefaultConnection", "UserProfile", "UserId", "UserName", autoCreateTables: true); 
```

...并收到一条错误消息，表明 WebSecurity.InitializeDatabaseConnection 只能调用一次。这是有道理的，因为控制器定义的顶部有一个属性应该已经调用了这个函数（而且看起来它做得很好）。因此，为了安全起见，我将上述调用更改为：

```
if (!WebSecurity.Initialized)
            {
                WebSecurity.InitializeDatabaseConnection("DefaultConnection", "UserProfile", "UserId",
                                                         "UserName", autoCreateTables: true);
            } 
```

...并取回原始错误消息，即 WebSecurity.InitializeDatabaseConnection 应该在等等等等之前调用。任何对这种疯狂的洞察力将不胜感激

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2013-04-07T15:31:00.613

这里有一个更好的解释：http: [//odetocode.com/blogs/scott/archive/2012/09/24/perils-of-the-mvc4-accountcontroller.aspx](http://odetocode.com/blogs/scott/archive/2012/09/24/perils-of-the-mvc4-accountcontroller.aspx)

这是您所要做的一切：

1.  `[InitializeSimpleMembership]`从顶部删除`AccountController`
2.  将`WebSecurity.InitializeDatabaseConnection(...)`调用从 /Filters/InitializeSimpleMembershipAttribute.cs（第 39 行）复制到 /AppStart/AuthConfig.cs
3.  随意从您的项目中删除 InitializeSimpleMembershipAttribute.cs

您不必*将*`InitializeDatabaseConnection()`调用添加到，但`AuthConfig.RegisterAuth()`它似乎是合乎逻辑的地方，可以让您的 Global.asax 保持清洁。

您实际上所做的是从原始属性中提取初始化调用并在 Application_Start 上显式调用它。如果您不使用（或不需要）SimpleMembership，属性中的其他所有内容都只是条件检查。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-01-29T16:36:05.990

将 [InitializeSimpleMembership]（如在 AccountController 中提到并找到）添加到我需要从中访问 WebSecurity 的控制器的顶部对我来说是诀窍。但是不确定它是否是预期的实现方法......

```
[InitializeSimpleMembership]
public class DataController : Controller
{ ... } 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-10-29T19:44:04.470

我在互联网上找到了这个：[http](http://forums.asp.net/t/1718361.aspx/1) ://forums.asp.net/t/1718361.aspx/1 基本上，不要使用 SimpleRoleProvider 类型。有一个 Roles 对象可用，它允许像这样的简单调用：

```
if (Request.IsAuthenticated)
{
  if( Roles.IsUserInRole(User.Identity.Name, "User"))
  {
    viewModel.LinkItems.Add(new NavBarLinkItem() 
    { Title = "Create Project", Action = "Create", Controller = "Campaign" });
  }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-10-13T18:01:35.627

首先，您必须在 web.config 中设置您的角色和成员资格提供者：

```
<authentication mode="Forms">
  <forms loginUrl="/Account/Login" slidingExpiration="true" timeout="60" />
</authentication>
<membership defaultProvider="p1">
  <providers>
    <add name="p1" type="WebMatrix.WebData.SimpleMembershipProvider, WebMatrix.WebData"/>
  </providers>
</membership>
<roleManager enabled="true" defaultProvider="p1">
  <providers>
    <add name="p1" type="WebMatrix.WebData.SimpleRoleProvider, WebMatrix.WebData"/>
  </providers>
</roleManager> 
```

当您创建 SimpleRoleProvider 的新实例时，请使用非 null 构造函数，并提供 web.config 中设置的默认 RoleProvider 作为参数：

```
SimpleRoleProvider srp = new SimpleRoleProvider(Roles.Provider); 
```

在 SimpleMembershipProvider 的情况下解决方案是相同的：

```
SimpleMembershipProvider msp = new SimpleMembershipProvider(Membership.Provider); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-05-29T09:08:32.637

在我的情况下，我必须在 IIS 身份验证设置中**禁用匿名身份验证。**

然后我必须**启用**表单和 Windows 身份验证。*这当然取决于您对应用程序需要的任何身份验证。*

一旦我这样做了，错误就消失了，应用程序按预期工作。

# expect - 使用 Expect 脚本将 IP 地址提取到变量中

> ID：13128223
> 
> 赞同：3
> 
> 时间：2012-10-29T19:20:02.297
> 
> 标签：expect, ifconfig

嗨，我是 Expect 脚本的新手，我一直在尝试使用以下方法将 IP 地址获取到变量中：

```
set timeout -1
spawn $env(SHELL)
match_max 100000
send "ifconfig | grep -A 1 'eth1' | tail -1\r "
expect -re "inet addr:.* " {send "ping $expect_out(0,string)\r"}
send -- "exit\r"
expect eof 
```

问题是它正在尝试使用 ifconfig 命令的结果进行 ping，其中包含一些字符串字符。

谁能帮我从 ifconfig 命令中提取 IP 地址并将其存储在变量中？我也一直在使用 $expect_out(buffer) ，但就是无法理解它。任何有关这些方面的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-30T14:25:27.267

您不需要生成外壳：

```
spawn ifconfig eth1
expect -re {inet addr:(\S+)}
set ipaddr $expect_out(1,string)
expect eof

spawn ping -c 10 $ipaddr
expect eof 
```

事实上，你不需要在纯 Tcl 中使用 Expect: （对 ping 进行额外的错误检查）：

```
if {[regexp {inet addr:(\S+)} [exec ifconfig eth1] -> ipaddr]} {
    set status [catch [list exec ping -c 10 $ipaddr] output]
    if {$status == 0} {
        puts "no errors from ping: $output"
    } else {
        puts "ERROR: $output"
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T19:51:25.493

您可以在现有代码上使用正则[表达式：](http://www.tcl.tk/man/tcl8.5/TclCmd/regexp.htm)

```
expect -re "inet addr:.* " {
  regexp {inet.*?(\d+\.\d+\.\d+\.\d+)} $expect_out(buffer) match ip
  puts "Pinging $ip"
  send "ping $ip\r"
} 
```

在行中：

```
regexp {inet.*?(\d+\.\d+\.\d+\.\d+)} $expect_out(buffer) match ip 
```

regexp 命令在括号中的“捕获组”中捕获 IP 地址：

`(\d+\.\d+\.\d+\.\d+)`

然后将其存储在变量中`ip`。

该`expect_out(buffer)`变量是源字符串，包含到目前为止通过期望读取的所有内容（取决于您的`expect -re`命令），并且`match`是另一个变量，它存储与整个正则表达式匹配的字符串（从“inet”到 IP 地址末尾的所有内容。） `match`很简单那里符合要求在捕获组之前存在变量的正则表达式语法 - 在这个特定示例中它是一次性数据 - 正则表达式的重新设计版本可以使用 match 来存储此示例的 ip，但通常我找到捕获组更灵活，因为您可以有多个从单个字符串中捕获不同的数据。

您可能需要阅读[regexp](http://wiki.tcl.tk/396)命令和一般的[正则表达式](http://www.regular-expressions.info/)，因为 Expect 非常广泛地使用它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T19:25:56.947

将您的 'send 更改`"ifconfig | grep -A 1 'en1' | tail -1\r"`为如下所示。

`send "ifconfig | grep -A 1 'en1' | tail -1 | cut -d' ' -f2\r"`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-14T12:25:53.797

```
$ifconfig 
eth0      Link encap:Ethernet  HWaddr 00:1b:fc:72:84:12  
      inet addr:172.16.1.13  Bcast:172.16.1.255  Mask:255.255.255.0
      inet6 addr: fe80::21b:fcff:fe72:8412/64 Scope:Link
      UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
      RX packets:638661 errors:0 dropped:20 overruns:0 frame:0
      TX packets:93858 errors:0 dropped:0 overruns:0 carrier:2
      collisions:0 txqueuelen:1000 
      RX bytes:101655955 (101.6 MB)  TX bytes:42802760 (42.8 MB)
      Memory:dffc0000-e0000000 

lo        Link encap:Local Loopback  
      inet addr:127.0.0.1  Mask:255.0.0.0
      inet6 addr: ::1/128 Scope:Host
      UP LOOPBACK RUNNING  MTU:16436  Metric:1
      RX packets:3796 errors:0 dropped:0 overruns:0 frame:0
      TX packets:3796 errors:0 dropped:0 overruns:0 carrier:0
      collisions:0 txqueuelen:0 
      RX bytes:517624 (517.6 KB)  TX bytes:517624 (517.6 KB) 
```

尝试这个：

```
ifconfig | sed '2,2!d' | sed 's/.*addr://' | sed 's/\ .*//' > ipaddress 
```

这将给 ip

```
$vi ipaddress 
```

# tsql - 使用排除列表优化递归查询

> ID：13128230
> 
> 赞同：0
> 
> 时间：2012-10-29T19:20:49.673
> 
> 标签：tsql, variables, optimization, while-loop, temp-tables

我正在尝试优化递归查询以提高速度。完整查询运行 15 分钟。我尝试优化的部分需要大约 3.5 分钟才能执行，并且在查询中使用了两次相同的逻辑。

描述：

```
Table Ret contains over 300K rows with 30 columns (Daily snapshot)
Table Ret_Wh is the werehouse for Ret with over 5million rows (Snapshot history, 90days) 
```

datadate - 记录信息的日期（如 10-01-2012）

statusA - 帐户可以拥有的状态，例如（红色，蓝色）。

statusB - 帐户可以拥有的不同状态，例如（大，小）。

*状态每天都在变化。*

old - 帐户的整数年龄。如果帐户上有付款，则可以增加/减少年龄。否则每天增加 1。

account - 帐号和一行的主键。

*在 Ret 中，该帐户是唯一的。*
*在 RetWh 中，每个数据日期的帐户都是唯一的。*

money - 帐户中的美元
**Ret 和 Ret_Wh 都有上面列出的列**

查询目标：从 Ret_Wh 中选择所有年龄在某个范围内、在当月的任何时间、在该范围内具有特定状态的所有帐户。
然后从这些结果中选择，匹配 Ret 中具有特定年龄“今天”的帐户，无论其状态如何。

我的目标：以不需要 3.5 分钟的方式完成此操作

伪代码：

```
@sdt='2012-10-01' -- or the beginning of any month
@dt = getdate()

create table #temp (account char(20))
create table #result (account char(20), money money)

while @sdt < @dt
BEGIN

insert into #temp
select
    A.account

from Ret_Wh as A
where a.datadate = @sdt
    and a.statusA = 'Red'
    and a.statusB = 'Large'
    and a.old between 61 and 80

set @sdt=(add 1 day to @sdt)

END
------

select distinct
    b.account
    ,b.money

into #result
from #temp as A
join (Select account, money from Ret where old = 81) as B
  on A.account=B.account 
```

我想在 Ret_Wh 中创建一个不同的帐户列表（称为 #shrinking_list）。然后，在此期间，我将 Ret_Wh 加入到#shrking_list。最后，我从#shrinking_list 中删除了一个帐户。然后 while 迭代，将一个较小的列表加入到 Ret_Wh，从而随着 @sdt 增加 1 天而加快查询速度。但是，我不知道如何将选择的完全相同的帐号同时传递给外部变量，以便我可以将其从#shrinking_list 中删除。

对此有什么想法，或者总体上如何加快速度？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T19:33:27.587

为什么要使用游标一次从@sdt 到@dt 获取日期？

```
select distinct b.account, b.money
from Ret as B
join Ret_Wh as A 
  on A.account = B.account
 and a.datadate >= @sdt 
 and a.datadate <  @dt
 and a.statusA = 'Red'
 and a.statusB = 'Large'
 and a.old between 61 and 80
where b.old = 81 
```

# django - 我可以让 Django 忽略非 PK 唯一约束上的重复固定装置吗？

> ID：13128231
> 
> 赞同：7
> 
> 时间：2012-10-29T19:20:52.297
> 
> 标签：django, django-models

我有一些基本的初始数据，我想包含在 Django 项目中。*除了*我可能想要拒绝重复之外，它非常适合作为固定装置。这意味着我可以将数据重新加载到现有安装中，它只会添加不存在的对象。

我在同一个字段上使用了自然键和外键，所以不存在 id 冲突等问题。

可能的？当 JSON 导入器已经存在并且我的数据已经在固定装置中时，我不想编写它。

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-10-29T19:37:09.510

通常夹具包含一个模型的所有信息，其中包括主键。这是来自 Django 站点的夹具[示例：](https://docs.djangoproject.com/en/dev/howto/initial-data/)

```
[
  {
    "model": "myapp.person",
    "pk": 1,
    "fields": {
      "first_name": "John",
      "last_name": "Lennon"
    }
  },
  {
    "model": "myapp.person",
    "pk": 2,
    "fields": {
      "first_name": "Paul",
      "last_name": "McCartney"
    }
  }
] 
```

如您所见，它有一个主键。因此，即使您有重复的夹具，只要主键相同，无论要导入的最新夹具是什么，该夹具都会覆盖数据库中的条目，因此您不应该在数据库中有任何重复的数据。

# android - Surfaceview ANR onResume

> ID：13128232
> 
> 赞同：0
> 
> 时间：2012-10-29T19:20:53.590
> 
> 标签：android, surfaceview

我正在使用 SurfaceView 开发一款 Android 游戏，游戏运行良好，所以我想在用户点击 HOME 键时暂停它，但是当返回 SurfaceView 消失（黑色背景**编辑：有时会出现绘图**）并且按钮在这两种情况我都会得到 ANR。

```
public class MainActivity extends Activity {
    private Game game;
    MainPanel mp;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        game = new Game();
        LoadLevel();
        Init();
        setContentView(R.layout.main);//contains surfaceview and buttons
        mp = (MainPanel) findViewById(R.id.SurfaceView01);
        mp.Init(game,this);
        Button btnTop = (Button) findViewById(R.id.buttonTop);
        Button btnBottom = (Button) findViewById(R.id.buttonBottom);
        Button btnLeft = (Button) findViewById(R.id.buttonLeft);
        Button btnRight = (Button) findViewById(R.id.buttonRight);
        btnTop.setOnClickListener...
    }

    private void Init() {
        ...
    }

    public void LoadLevel() {
        ...
    }

    @Override
    protected void onResume() {
        super.onResume();
        Log.d("Tag","Resume");
    }

    @Override
    protected void onPause() {
            super.onPause();
        Log.d("Tag","Pause");
    }
}

public class MainPanel extends SurfaceView implements SurfaceHolder.Callback {

    private MainThread thread;
    private Game game;
    private MainActivity act;

    public MainPanel(Context context, AttributeSet attrs) {
        super(context,attrs);
        getHolder().addCallback(this);
    }

    public MainThread getThread() {
        return thread;
    }

    public void Init(Game game, MainActivity act){
        this.game = game;
        this.act = act;
    }

    public void Move(int dir) {
        ...
    }

    public void update() {
        ...
    }

    @Override
    public void surfaceChanged(SurfaceHolder holder, int format, int width,int height) {}
    @Override
    public void surfaceCreated(SurfaceHolder holder) {
        if (thread == null) {
            thread = new MainThread(getHolder(), this);
            thread.Start();
            thread.start();
        }
    }
    @Override
    public void surfaceDestroyed(SurfaceHolder holder) {
        thread.Stop();
        boolean retry = true;
        while (retry) {
            try {
                thread.join();
                retry = false;
            } catch (InterruptedException e) {}
        }
        thread = null;
    }

    @Override
    protected void onDraw(Canvas canvas) {
        canvas.drawColor(Color.BLACK);
        //drawing...
    }
}

public class MainThread extends Thread {
    private final static int MAX_FPS = 30;
    private final static int MAX_FRAME_SKIPS = 3;
    private final static int FRAME_PERIOD = 1000 / MAX_FPS;

    private SurfaceHolder surfaceHolder;
    private MainPanel gamePanel;
    private boolean run = false;
    private boolean start = false;

    public MainThread(SurfaceHolder surfaceHolder, MainPanel gamePanel) {
        super();
        this.surfaceHolder = surfaceHolder;
        this.gamePanel = gamePanel;
    }

    public void Start() {
        this.run = true;
        this.start = true;
    }

    public void Pause() {
        this.start = false;
    }

    public void Resume() {
        this.start = true;
    }
    public void Stop() {
        this.run = false;
    }

    @Override
    public void run() {
        Canvas c = null;
        long beginTime;     // the time when the cycle begun
        long timeDiff;      // the time it took for the cycle to execute
        int sleepTime;      // ms to sleep (<0 if we're behind)
        int framesSkipped;  // number of frames being skipped 

        while(run) {
            while(start) {
                try {
                    c = surfaceHolder.lockCanvas(null);
                    synchronized (surfaceHolder) {
                        beginTime = System.currentTimeMillis();
                        framesSkipped = 0;  // resetting the frames skipped
                        // update game state
                        gamePanel.update();
                        // render state to the screen draws the canvas on the panel
                        if(c!=null) gamePanel.onDraw(c);
                        // calculate how long did the cycle take
                        timeDiff = System.currentTimeMillis() - beginTime;
                        // calculate sleep time
                        sleepTime = (int)(FRAME_PERIOD - timeDiff);

                        if (sleepTime > 0) {
                            // if sleepTime > 0 we're OK
                            try {
                                // send the thread to sleep for a short period very useful for battery saving
                                Thread.sleep(sleepTime);
                            } catch (InterruptedException e) {}
                        }

                        while (sleepTime < 0 && framesSkipped < MAX_FRAME_SKIPS) {
                            // we need to catch up update without rendering
                            gamePanel.update();
                            // add frame period to check if in next frame
                            sleepTime += FRAME_PERIOD;
                            framesSkipped++;
                        }
                    }
                } finally {
                    if (c != null) surfaceHolder.unlockCanvasAndPost(c);
                }
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T21:08:37.127

感谢这篇文章[，为什么我的 runnable 会提供 ANR？](https://stackoverflow.com/questions/6508367/why-is-my-runnable-giving-anr?rq=1)我可以解决这个问题，我将 MainThread 与 UI 线程隔离以获取更多详细信息，请检查最佳答案。

# php - 将超链接附加到动态表格单元格

> ID：13128237
> 
> 赞同：0
> 
> 时间：2012-10-29T19:21:07.273
> 
> 标签：php, mysql

我有一个使用从 MYSQL 收集的数据使用 PHP 生成的表。如何将超链接附加到行？

这是我正在使用的动态表的代码：

```
 mydata = mysql_query($sql,$con);

 echo "<table id='name',table border=0>
<tr>
<th>Users</th>
<th>Status<th>
</tr>";
while($record = mysql_fetch_array($mydata)){
echo "<tr>";
echo "<td>" . $record['user_id'] . "</td>";
if (strtolower(trim($record['activity']))!=strtolower('LOGIN')){ 
echo "<td>" . $default1  . "</td>";
}else{

echo "<td>" . $default  . "</td>";

}

echo "</tr>";
}
echo "</table>";
; 
```

我已尝试附加 href="..." style="display:block;"> 但无法使其正常工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T19:26:05.297

尝试回显一个超链接。

```
echo "<a href='http://www.google.com/'>Google</a>"; 
```

如果您想要其他功能，例如单击表格行以用作超链接，则需要在 javascript 中实现该功能，因为表格单元格/行不是超链接。

# codeigniter - codeigniter - 在提交表单之前检查会话有效性

> ID：13128238
> 
> 赞同：1
> 
> 时间：2012-10-29T19:21:12.307
> 
> 标签：codeigniter, session, session-timeout

在 codeigniter 中，似乎即使在会话过期后也可以提交表单。

示例：我正要填写表格并离开我的电脑一会儿。返回时，我提交表单成功，当我查看数据库时，用户ID为0。所以我刷新页面，发现自己重定向到登录页面--会话已过期，我仍然可以提交表单。似乎不应该发生这种情况。

我已经设置了一个应该处理它的函数，但是**我想了解为什么可以在会话过期后提交表单，或者这是否表明出现了问题。**

```
function sess_valid() {
       $sess_timeout = now() - 3600; //3600 is the session expiry time
       $last_act = $this->session->userdata('last_activity');

       if($last_act <= $sess_timeout)
       {
        redirect('login');
       }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T19:46:41.967

可以在任何时间点提交表单。表单根本不需要会话。表单是 HTML 文档的一部分，它只需要有效的 HTML。换句话说，你的表格一切都很好。

提交表单后，它会发送数据。这是您必须使用服务器端语言的地方 - 验证表单数据。
就您而言，正如您已经注意到的那样，检查会话是否处于活动状态是正确的方向。根据检查结果，您可以重定向到登录，同时将表单数据保存在某处，并在他/她登录后重新填充用户的表单字段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T19:46:42.027

我的猜测是您必须手动处理会话检查。您可以像以前一样在表单验证运行级别执行此操作。例如：

```
if ($this->form_validation->run() == FALSE || !sess_valid()) 
```

# mysql - 使用连接从多个表中获取数据

> ID：13128239
> 
> 赞同：0
> 
> 时间：2012-10-29T19:21:12.483
> 
> 标签：mysql, sql, select

我有各种各样的桌子，比如

```
学生
主要ID，学生姓名，课程

文件
论文编号、论文名称、课程、学期、类型

学生选项
primary id、studentid（外键 - 参考学生 id）和 paperid（外键 - 参考论文 id）

学生学期
studentid（外键引用学生id）和学生学期
```

现在我想要的结果是，

我想选择一门课程然后是学期，这将给我论文/主题的数量及其类型（强制性/可选），并且我想计算从所有这些表格中学习这些论文的学生人数.

我不想创建任何视图或东西，只需一个普通的选择查询即可。

我正在运行的查询是：

```
SELECT p_name,
       p_id,
       type,
       Count(sps.studentid) AS counts
FROM   students,
       str,
       papers
       LEFT JOIN sps
              ON sps.paperid = papers.p_id
WHERE  sps.studentid = students.studentid
       AND students.studentid = str.studentid
       AND sps.studentid = str.studentid
       AND str.semesterid = p_semid
       AND str.sessionid = 12
       AND students.course = c_id
       AND c_id = 6
       AND p_semid = 1
GROUP  BY p_id 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T19:27:16.823

作为更好的做法，如果您要使用显式`JOIN`语法，则不要使用隐式语法。在您在上面发布的查询中，您选择 from `papers`，但您没有在任何地方使用它。此外，您的列名有点模棱两可。如果更容易，请使用单个字母为每个表命名，或显式为列名添加前缀。如果您使用带有 的聚合`GROUP BY`，则无法选择不在组中的列。

假设这是您的 ER 图：

![](../Images/aa50a5d99b92f3b7d05f85c923351556.png)

让我们首先连接所有表：

```
SELECT a.id, a.name
FROM student a
JOIN str b ON b.student_id = a.id
JOIN sps c ON c.student_id = a.id
JOIN papers d ON d.id = c.paper_id 
```

现在您希望查找从特定课程学习论文的学生人数并输入：

```
SELECT a.id, a.name
FROM student a
JOIN str b ON b.student_id = a.id
JOIN sps c ON c.student_id = a.id
JOIN papers d ON d.id = c.paper_id
WHERE b.semester = 12
    AND d.course = 6 
```

因为您的属性不明确，所以很难分辨它们来自哪些表。[如果您可以在SQL Fiddle](http://www.sqlfiddle.com)上设置结构和示例数据，我们可以为您提供更好的帮助。

# php - 无法在 PHP 中使用查询变量作为表名创建 SQL 表

> ID：13128242
> 
> 赞同：0
> 
> 时间：2012-10-29T19:21:53.857
> 
> 标签：php, mysql, sql, database, create-table

我在 PHP 中传递一个查询变量。我想将其设为表名，但我知道可能存在 SQL 语法错误。当我打印语句时，变量被传递意味着它工作，但数据库根本没有创建。

这是我创建数据库的代码：

```
$DBName = "database_name";  
$sql = "CREATE TABLE '$DBName'.'$login' (  
    ClientID int NOT NULL AUTO_INCREMENT,   
    AgentClients varchar(15),  
    ClientTotal int  
    )";  
mysql_query($sql,$link);
where `$login = $_POST['login']; 
```

另外，我目前并不担心安全漏洞，所以不用担心。

任何见解将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-29T19:26:30.147

您必须为您的表名使用反引号，而不是引号：

```
$sql = "CREATE TABLE `$DBName`.`$login` (  
  ClientID int NOT NULL AUTO_INCREMENT,   
  AgentClients varchar(15),  
  ClientTotal int,
  PRIMARY KEY (`ClientID`) 
)"; 
```

# java - mySocketClient.waitingForResponse() 还是类似的？

> ID：13128243
> 
> 赞同：3
> 
> 时间：2012-10-29T19:22:39.180
> 
> 标签：java, sockets, response

所以..我有一个服务器套接字，在这里：

```
ServerSocket server = new ServerSocket(5000);  

while(true){  
    Socket cliente = server.accept();  
    Thread thread = new Thread(new Converter(cliente));  
    thread.start(); 
```

我的应用程序将 Word 文档 ( `.doc`) 转换为 PDF。首先，我的服务器收到一个 .doc，在使用 .pdf 存档响应后进行转换。

如何获取正在等待响应的客户端？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T19:27:01.513

如果我理解正确，您将为每个接受的套接字创建一个线程（因此是客户端）。该`Converter`线程可以访问客户端套接字（每个客户端都有不同的套接字返回`accept()`）。现在解决方案非常简单：

```
public void run() {
    cliente.getInputStream();  //read .doc first
    //do the conversion to .pdf
    cliente.getOutputStream();  //send .pdf back
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T19:40:00.043

得到：

```
private void getDocArchive(){  

    try {  

        InputStream in = socket.getInputStream();  
        BufferedInputStream buffer = new BufferedInputStream(in, 1024);  

        byte[] b = new byte[1024];  
        int len = 0;  
        int bytcount = 1024;  

        FileOutputStream out = new FileOutputStream("docs/atual.doc");  

        while ((len = buffer.read(b, 0, 1024)) != -1) {  
            bytcount = bytcount + 1024;  
            out.write(b, 0, len);  
        }  

        out.flush();  

        //out.close();  
        //buffer.close();  

    } catch (IOException e) {  
        System.out.println("Ocorreu um erro no recebimento do arquivo");  
    }  
} 
```

回复：

```
private void reponse() {  
    try {  
        OutputStream out = socket.getOutputStream();  
        InputStream in = new FileInputStream(pdf);  

        BufferedInputStream buffer = new BufferedInputStream(in, 1024);  

        byte[] b = new byte[1024];  
        int len = 0;  
        int bytcount = 1024;  
        int i = 0;  

        while ((len = buffer.read(b, 0, 1024)) != -1) {  
            bytcount = bytcount + 1024;  
            out.write(b, 0, len);  
        }  

        out.flush();  
        out.close();  
        buffer.close();  
    } catch (IOException e) {  
        e.printStackTrace();  
        System.out.println(e.getMessage());  
    }  
} 
```

我的客户：

```
public static void main(String[] args) throws Exception {  

    try {  

        Socket client = new Socket("127.0.0.1", 5000);  

        OutputStream out = client.getOutputStream();  
        InputStream in = new FileInputStream("C:\\autistmo.docx");  

        BufferedInputStream buffer = new BufferedInputStream(in, 1024);  

        byte[] b = new byte[1024];  
        int len = 0;  
        int bytcount = 1024;  

        while ((len = buffer.read(b, 0, 1024)) != -1) {  
            bytcount = bytcount + 1024;  
            out.write(b, 0, len);  
        }  

        // resposta  

        BufferedInputStream buffer2 = new BufferedInputStream(in, 1024);  
        FileOutputStream out2 = new FileOutputStream("docs/final.doc");  

        while ((len = buffer2.read(b, 0, 1024)) != -1) {  
            bytcount = bytcount + 1024;  
            out2.write(b, 0, len);  
        }  

        out2.close();  
        buffer2.close();  

    } catch (Exception e) {  
        // TODO Auto-generated catch block  
        e.printStackTrace();  
    } 
```

运行方法：

```
@Override  
public void run() {  
    getDocArchive();  
    converter();  
    reponse();  
} 
```

# testing - 如何避免在测试期间收到“太多未来的电话”？

> ID：13128253
> 
> 赞同：3
> 
> 时间：2012-10-29T19:23:37.747
> 
> 标签：testing, salesforce, apex-code

我的生产环境现在有很多触发器和类。这些都工作得很好，并且正在发挥应有的作用。但是，我无法部署几个新触发器，因为测试类调用了太多未来的方法。我向您保证，我的代码被批量化，以便每次运行只调用一次未来的方法。但是，当通过 IDE 部署触发器时，每个测试都会运行，因此未来的调用会运行太多次。

我已经尝试在我未来的所有调用中放置一个 try/catch，希望如果它确实达到了限制，它只会路由到 catch 方法。尽管出现同样的错误，但它仍然无法部署。

我正在做的主要未来电话只能通过一个类进行参考。这是一个对我的网站执行 ping 操作的 HTTP 调用。

除了完全重新做我所有的测试类之外，有没有什么方法可以避免这个限制？正如您在下面看到的，未来的过多调用是在特定触发器上`(default)`而不是在特定触发器上发生的。

```
10:39:15.617|LIMIT_USAGE_FOR_NS|(default)|
Number of SOQL queries: 85 out of 100 ******* CLOSE TO LIMIT
Number of query rows: 1474 out of 50000
Number of SOSL queries: 0 out of 20
Number of DML statements: 19 out of 150
Number of DML rows: 23 out of 10000
Number of script statements: 2370 out of 200000
Maximum heap size: 0 out of 6000000
Number of callouts: 0 out of 10
Number of Email Invocations: 0 out of 10
Number of fields describes: 0 out of 100
Number of record type describes: 0 out of 100
Number of child relationships describes: 0 out of 100
Number of picklist describes: 0 out of 100
Number of future calls: 11 out of 10 ******* CLOSE TO LIMIT 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T20:30:49.363

如果不查看特定代码，很难判断是哪些路径导致您在测试期间达到未来调用限制。值得探索为什么当前部署中的组件会达到未来的方法限制。

如果您的目标是让测试通过，您可以结合使用[Test.isRunningTest()](http://www.salesforce.com/us/developer/docs/apexcode/Content/apex_methods_system_test.htm)、[Limits.getFutureCalls()](http://www.salesforce.com/us/developer/docs/apexcode/Content/apex_methods_system_limits.htm)和[Limits.getLimitFutureCalls()](http://www.salesforce.com/us/developer/docs/apexcode/Content/apex_methods_system_limits.htm)以便在测试期间不会调用未来方法，否则它们会导致要超过的限制。

例如

```
 if(Test.isRunningTest() && Limits.getFutureCalls() >= Limits.getLimitFutureCalls()) {
     system.debug(LoggingLevel.Error, 'Future method limit reached. Skipping...');
 } else {
     callTheFutureMethod();
 } 
```

# c# - 根据 CurrentUICulture 更改标签文本

> ID：13128255
> 
> 赞同：1
> 
> 时间：2012-10-29T19:23:58.247
> 
> 标签：c#, winforms, localization

我最近的任务是本地化我公司创建的一小部分软件。我已经能够为特定的文化创建 resx 文件，而且一切都很好。问题是，大约有 50 个左右的标签/按钮/等需要更改。我的问题是，我需要编写代码来设置文本，还是有更简单的方法？例如，

`lblText.text = Resources.labelText`

对于每个按钮/标签。或者我缺少的按钮/标签中是否有一个可以设置它的属性。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T20:17:59.410

您可以直接使用 Visual Studio 的表单设计器更改文本。只需将表单的属性设置`Localizable`为 true 并将`Language`属性更改为您要翻译的属性。然后，您所做的每一项更改都只会反映在您选择的语言中

如果您需要更多帮助，可以查看[此演练](http://msdn.microsoft.com/en-us/library/y99d1cd3%28v=vs.71%29.aspx)

# .net - win 7 上的 .net 应用程序图标中等大小渲染问题

> ID：13128260
> 
> 赞同：0
> 
> 时间：2012-10-29T19:24:26.327
> 
> 标签：.net

我创建了一个与我的应用程序一起使用的图标，并将所有可用尺寸嵌入到 ico 文件中。

在测试不同尺寸以在 windows server 2008 r2 上查看时，我可以看到所有尺寸都呈现良好，包括中等尺寸。但是，当我将此应用程序推送到 Windows 7 机器时，中等大小不起作用。它显示为空白页。

我在[这里](http://msdn.microsoft.com/en-us/library/aa511280.aspx#size)阅读了有关处理 .net 应用程序中的图标的文章，并且我已将所有这些大小包含在我的 ico 文件中。

我用paint.net 创建了这个文件，但我怀疑这真的很重要。

有人有想法么？这看起来很简单，所以我不明白我在哪里搞砸了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T09:16:50.720

从 GIMP 重新创建图标被证明是成功的。不确定paint.net中的.ico插件是否存在导致我遇到的问题的错误。

# mysql - mysql查询where子句中的if-else

> ID：13128261
> 
> 赞同：2
> 
> 时间：2012-10-29T19:24:34.607
> 
> 标签：mysql, where-clause

我正在尝试根据 IF 条件更改 where 子句。查询由于某种原因失败。我将不胜感激任何帮助。

谢谢！

```
 SELECT
            c.id AS course,
            cr.id AS criteriaid,
            u.id AS userid,
            ue.timestart AS otimestart,
            (ue.timestart + cr.enrolperiod) AS ctimestart,
            ue.timecreated AS otimeenrolled,
            (ue.timecreated + cr.enrolperiod) AS ctimeenrolled
        FROM
            {user} u
        INNER JOIN
            {user_enrolments} ue
         ON ue.userid = u.id
        INNER JOIN
            {enrol} e
         ON e.id = ue.enrolid
        INNER JOIN
            {course} c
         ON c.id = e.courseid
        INNER JOIN
            {course_completion_criteria} cr
         ON c.id = cr.course
        LEFT JOIN
            {course_completion_crit_compl} cc
         ON cc.criteriaid = cr.id
        AND cc.userid = u.id
        WHERE
            cr.criteriatype = 5
        AND c.enablecompletion = 1
        AND cc.id IS NULL
        AND             
        (
        IF (ue.timeextension IS NULL)
                (ue.timestart > 0 AND ue.timestart + cr.enrolperiod < ?
          OR ue.timecreated > 0 AND ue.timecreated + cr.enrolperiod < ?)
        ELSE 
                (ue.timestart > 0 AND ue.timestart + ue.timextension < ?
          OR ue.timecreated > 0 AND ue.timecreated + ue.timeextension < ?)
        ) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T19:37:32.247

`IF`表达式的语法是：

```
IF(<cond-expr>, <then-expr>, <else-expr>) 
```

语法中没有`ELSE`关键字，您只需用逗号分隔两个结果表达式。所以你的表达式的正确语法应该是：

```
AND IF(ue.timeextension IS NULL,
       (ue.timestart > 0 AND ue.timestart + cr.enrolperiod < ?)
         OR (ue.timecreated > 0 AND ue.timecreated + cr.enrolperiod < ?),
       (ue.timestart > 0 AND ue.timestart + ue.timextension < ?)
         OR (ue.timecreated > 0 AND ue.timecreated + ue.timeextension < ?)) 
```

你可以这样写的另一种方式是：

```
AND ((ue.timestart > 0 AND ue.timestart + IFNULL(ue.timeextesion, cr.enrolperiod) < ?)
     OR (ue.timecreated > 0 AND ue.timecreated + IFNULL(ue.timeextesion, cr.enrolperiod)) < ?) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T19:35:57.310

根据您要完成的任务，正确的 where 子句可能是：

```
...
where ...
and (if(ue.timeextension IS NULL,
        ue.timestart > 0 AND ue.timestart + cr.enrolperiod < ?
            OR ue.timecreated > 0 AND ue.timecreated + cr.enrolperiod < ?,
        ue.timestart > 0 AND ue.timestart + ue.timextension < ?
            OR ue.timecreated > 0 AND ue.timecreated + ue.timeextension < ?); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T19:38:55.860

我想你可以试试 where 的最后一部分，即

```
 AND             
    (
    IF (ue.timeextension IS NULL)
            (ue.timestart > 0 AND ue.timestart + cr.enrolperiod < ?
      OR ue.timecreated > 0 AND ue.timecreated + cr.enrolperiod < ?)
    ELSE 
            (ue.timestart > 0 AND ue.timestart + ue.timextension < ?
      OR ue.timecreated > 0 AND ue.timecreated + ue.timeextension < ?)
    ) 
```

作为

```
 AND             
    (
      (ue.timestart > 0 AND ue.timestart + 
             IFNULL(ue.timeextension , cr.enrolperiod )  < ? )
     OR (ue.timecreated > 0 AND ue.timecreated + 
             IFNULL (ue.timeextension, cr.enrolperiod) < ? )
    ) 
```

# join - MS Access 07 - JOIN 查询中的通配符

> ID：13128262
> 
> 赞同：1
> 
> 时间：2012-10-29T19:24:37.450
> 
> 标签：join, ms-access-2007

我有以下查询

```
SELECT tblUsers.userfullname, 
       tblReports.reportdate, 
       tblReports.reportnumber, 
       tblRawData.reportcategory, 
       tblRawData.reportissue
FROM tblRawData 
RIGHT JOIN (tblUsers RIGHT JOIN tblReports ON tblUsers.userID = tblReports.userID) ON tblReports.reportnumber LIKE "*" & tblRawData.reportnum
WHERE (
       ((tblUsers.username) Like "*" & [Forms]![frmSelect]![txtUser] & "*") 
       AND
       ((tblUsers.userShift) Like "*" & [Forms]![frmSelect]![txtShift] & "*")
      ); 
```

哪个有效 - 除了部分

```
ON tblReports.reportnumber LIKE "*" & tblRawData.reportnum 
```

我想要匹配的是实例

```
tblReports.reportnumber = 410145 
```

和

```
tblRawData.reportnum = 12345.410145 
```

要不就

```
tblRawDatw.reportnum = 410145 
```

但由于某种原因，它不会找到第一个匹配项（例如：12345.410145），除非该数字与第二个匹配项相同（例如：410145）。我尝试将其格式化为数字和文本 - 但没有运气。

知道我可能缺少什么吗？

更新：我尝试只用这两个表进行另一个查询，但它不喜欢匹配。我尝试删除“。” （例如：12345.410145 转换为 12345410145）并且没有运气。这是我的第二个查询。

```
SELECT tblReports.userID, 
tblRawData.reportnum,
tblRawData.reportcategory,
tblRawData.reportissue,
tblReports.reportdate,
tblReports.reportnumber
FROM tblReports
LEFT JOIN tblRawData ON tblReports.reportnumber LIKE "*" & tblRawData.reportnum; 
```

如果数据是这样的。

tblReports 报告编号：410145 410144 410143 410142 410141

和 tblRawData 报告编号是这样的：12345.410145 410143 12344.410141

结果查询应该向我显示来自 tblReports 的所有 5 条记录 - 但其中 3 条记录具有来自 tblRawData 的注释等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T20:11:39.980

重写以允许不匹配。

```
SELECT 
   u.userfullname, 
   r.reportdate, 
   r.reportnumber, 
   q.reportcategory, 
   q.reportissue
FROM (tblusers u 
LEFT JOIN tblreports r 
ON u.userid = r.userid) 
LEFT JOIN (
   SELECT 
      Val(Mid([reportnum],InStr([reportnum],".")+1)) AS RepNo, 
      r.reportcategory, 
      r.reportissue
   FROM Rawdata AS r)  AS q
ON r.reportnumber = q.RepNo
AND q.username  Like "*" & [Forms]![frmSelect]![txtUser] & "*"
AND q.userShift Like "*" & [Forms]![frmSelect]![txtShift] & "*" 
```

使用 LEFT JOIN 而不是 RIGHT JOIN 是一个很常见的约定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T20:12:22.667

我没有检查所有内容，但我有一些想法。也许你必须交换 LIKE 条件？

```
tblRawData.reportnum LIKE "*" & tblReports.reportnumber 
```

如果这不是问题，您可以尝试使用该`trim`功能吗？

```
Trim(tblReports.reportnumber) LIKE "*" & Trim(tblRawData.reportnum) 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-29T19:32:29.873

SQL 查询的通配符是百分号“%”而不是星号。尝试使用它。但是，如果您包含所有匹配项，那么为什么要在查询中包含它呢？

[访问通配符参考](http://office.microsoft.com/en-us/access-help/access-wildcard-character-reference-HA010076601.aspx)

# struts2 - struts2中使用Interceptor时无法登录

> ID：13128265
> 
> 赞同：0
> 
> 时间：2012-10-29T19:25:00.460
> 
> 标签：struts2, actioncontext

我有一个小应用学习Struts2 Application

我写了一个管理页面，在里面，我的代码将检查用户是否登录，如果没有，它将重定向到登录页面。

我编写拦截器来检查用户尝试访问但未登录的所有页面，它将将此用户重定向到登录页面。一切正常，但是当我在数据库中输入正确的用户名和密码时，它无法登录，当我删除拦截器时，我可以登录到管理页面

原因可能是拦截器在登录之前和之后检查用户的会话，但也许在某些情况下，我不知道为什么我的应用程序会话为空，尽管我的用户名和密码是真实的，但是当我设置会话时它直到为空。

下面的代码将向您展示我所说的：

登录操作

```
/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package org.dejavu.software.view;

import com.opensymphony.xwork2.ActionContext;
import com.opensymphony.xwork2.ActionSupport;
import java.util.Map;
import org.apache.struts2.interceptor.SessionAware;
import org.dejavu.software.dao.UserDAO;
import org.dejavu.software.model.GroupMember;
import org.dejavu.software.model.User;

/**
 *
 * @author Administrator
 */
public class AdminLoginAction extends ActionSupport {

    private static final long serialVersionUID = -1457633455929689099L;
    private User user;
    private String username, password;
    private String role;
    private UserDAO userDAO;
    private GroupMember group;    

    public AdminLoginAction() {
        userDAO = new UserDAO();

    }

    @Override
    public String execute() {
        String result = null;
        System.out.println(getUsername());
        if (getUsername().length() != 0 && getPassword().length() != 0) {
            setUser(userDAO.checkUsernamePassword(getUsername(), getPassword()));            
            if (getUser() != null) {
                for (GroupMember g : getUser().getGroups()) {
                    boolean admincp = g.getAdminpermission().contains("1");
                    if (admincp == true) {
                        Map session = ActionContext.getContext().getSession();  
                        session.put("userLogged", getUsername());
                        session.put("passwordLogged", getPassword());
                        result = "success";
                    } else {
                        result = "error";
                    }
                }

            }
        }        
        return result;
    }

    @Override
    public void validate() {
        if (getUsername().length() == 0) {
            addFieldError("username", "Username is required");
        }
        if (getPassword().length() == 0) {
            addFieldError("password", getText("Password is required"));
        }

    }

    public String getPassword() {
        return password;
    }

    public void setPassword(String password) {
        this.password = password;
    }

    public String getRole() {
        return role;
    }

    public void setRole(String role) {
        this.role = role;
    }

    public User getUser() {
        return user;
    }

    public void setUser(User user) {
        this.user = user;
    }

    public String getUsername() {
        return username;
    }

    public void setUsername(String username) {
        this.username = username;
    }

    public GroupMember getGroup() {
        return group;
    }

    public void setGroup(GroupMember group) {
        this.group = group;
    }

} 
```

我的自定义拦截器代码：

```
/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package org.dejavu.software.interceptor;

import com.opensymphony.xwork2.ActionInvocation;
import com.opensymphony.xwork2.interceptor.AbstractInterceptor;
import java.util.Map;
import org.apache.struts2.StrutsStatics;

/**
 *
 * @author Anministrator
 */
public class LoginInterceptor extends AbstractInterceptor implements StrutsStatics {

    private static final long serialVersionUID = -3874262922233957387L;

    @Override
    public void destroy() {
    }

    @Override
    public void init() {
    }

    @Override
    public String intercept(ActionInvocation ai) throws Exception {
        Map<String, Object> session = ai.getInvocationContext().getSession();
        Object user = session.get("userLogged");

        if (user == null) {
            return "login";
        } else {
            return ai.invoke();
        }
    }
} 
```

我的 struts 配置

```
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE struts PUBLIC
"-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"
"http://struts.apache.org/dtds/struts-2.0.dtd">

<struts>

    <package name="default" namespace="/" extends="struts-default">
        <action name="index" class="org.dejavu.software.view.HomeAction">
            <result>home.jsp</result>
        </action>
        <action name="about" class="org.dejavu.software.view.AboutHomeAction">
            <result>about.jsp</result>
        </action>
    </package>  

    <package name="admincp" namespace="/admincp" extends="struts-default">
        <interceptors>
            <interceptor name="login" class="org.dejavu.software.interceptor.LoginInterceptor" />
            <interceptor-stack name="stack-with-login">
                <interceptor-ref name="login"/>
                <interceptor-ref name="defaultStack"/>
            </interceptor-stack>
        </interceptors>
        <default-interceptor-ref name="stack-with-login"/>

        <global-results>
            <result name="login">login.jsp</result>
        </global-results>

        <action name="logincp" class="org.dejavu.software.view.AdminLoginAction">
            <result name="success">dashboard.jsp</result>
            <result name="input">login.jsp</result>
            <result name="error">login.jsp</result>
        </action>

    </package>  

</struts> 
```

当我输入正确的用户名和密码匹配到数据库时，直到重定向到 login.jsp 页面

我对此一无所知

请帮我

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T20:44:02.680

您必须将登录操作配置为使用默认拦截器堆栈，否则它将不会执行您的方法，因为您的拦截器将返回`login`结果。

```
<action name="logincp" class="org.dejavu.software.view.AdminLoginAction">
  <interceptor-ref name="defaultStack" />
  <result name="success">dashboard.jsp</result>
  <result name="input">login.jsp</result>
  <result name="error">login.jsp</result>
</action> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-07T05:21:34.433

您还必须检查用户是否是第一次尝试登录。

因为当用户第一次尝试登录时，会话将始终为空，它将重定向到登录页面。

为此，您可以在登录表单中使用另一个参数来检查用户是否第一次尝试在拦截器内登录，如果是，则调用该操作。

例如：

```
<form action='' method=''>
    <input type='hidden' name='firstLogin' value='1'/>
    <input type='text' name='username'/>
    <input type='password' name='password'/>
</form> 
```

我在这段代码中使用了纯 html，可能你正在使用 struts2-tags，所以你也可以用这种方式实现。

在你的 Interceptor 检查里面。

```
request = ai.getInvocationContext().get(HTTP_REQUEST);
if(user == null)
{
    if(!StringUtils.isEmpty(request.getParameter('firstLogin'))){
        return ai.invoke();
    }
    return "login";
}
else{
    return ai.invoke();
} 
```

# jsf - 警告 facemessage(s) 已入队，但可能尚未显示

> ID：13128266
> 
> 赞同：5
> 
> 时间：2012-10-29T19:25:04.027
> 
> 标签：jsf, jsf-2, jboss7.x

我有一个带有输入验证的表单，如下所示：

```
<h:form id="insurance-form" rendered = "#{(param['insSaved']=='editable')}">
    <div id="insurance-info">
        <ul id="form-labels" style="text-align:left;">
            <li>Insurance Company&nbsp;</li>
            <li>Policy Number&nbsp;</li>
            <li>Coverage Amount&nbsp;</li>
            <li>Agent's Phone Number&nbsp;</li>
            <li>Agent's Email&nbsp;</li>
        </ul>

        <ul>
            <li>
                <h:inputText value="#{residenceBeans.insuranceCompany}" id="insurance-company" required="true" requiredMessage="company is required"/>
                <h:message for="insurance-company" styleClass="validation-error-msg insuarnce-validation"/>
            </li>

            <li>
                <h:inputText value="#{residenceBeans.policyNumber}" id="insurance-policy" required="true" requiredMessage="number is required"/>
                <h:message for="insurance-policy" styleClass="validation-error-msg insuarnce-validation"/>
            </li>

            <li>
                <h:inputText value="#{residenceBeans.coverageAmount}" id="insurance-amount" required="true" requiredMessage="coverage amount is required"/>
                <h:message for="insurance-amount" styleClass="validation-error-msg insuarnce-validation"/>
            </li>

            <li>
                <h:inputText value="#{residenceBeans.agentPhone}" id="insurance-phone" required="true" requiredMessage="phone is required"/>
                <h:message for="insurance-phone" styleClass="validation-error-msg  insuarnce-validation"/>
            </li>

            <li>
                <h:inputText value="#{residenceBeans.agentMail}" id="insurance-mail" required="true" requiredMessage="email is required">
                    <f:validator validatorId="emailValidator"/>
                </h:inputText>
                <h:message for="insurance-mail" styleClass="validation-error-msg insuarnce-validation"/>
            </li>
        </ul>                                       

        <h:commandLink value="SAVE POLICY INFORMATION" action="#{residenceBeans.saveInsuranceInfo}"  styleClass="insurance-link-container">
            <f:param name="insSaved" value="saved"/>
        </h:commandLink>
    </div>
</h:form> 
```

当将字段留空并提交表单时，我希望显示验证消息，但我收到以下警告：

```
21:20:47,671 INFO  [javax.enterprise.resource.webcontainer.jsf.renderkit] (http--127.0.0.1-8080-3) WARNING: FacesMessage(s) have been enqueued, but may not have been displayed
sourceId=insurance-form:insurance-company[severity=(ERROR 2), summary=(company is required), detail=(company is required)]
sourceId=insurance-form:insurance-policy[severity=(ERROR 2), summary=(number is required), detail=(number is required)]
sourceId=insurance-form:insurance-amount[severity=(ERROR 2), summary=(coverage amount is required), detail=(coverage amount is required)]
sourceId=insurance-form:insurance-phone[severity=(ERROR 2), summary=(phone is required), detail=(phone is required)]
sourceId=insurance-form:insurance-mail[severity=(ERROR 2), summary=(email is required), detail=(email is required)] 
```

请告知如何解决。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-30T08:48:15.570

消息没有显示，因为整个表单在回发时根本没有呈现。`insSaved`您指示仅当请求参数的值为时才呈现表单`editable`。但是，在提交按钮中，它已更改为`saved`，因此表单基本上不会在回发时呈现，因此随附的消息也不会。考虑到代码的设置方式，这是完全可以预期的行为。

如果您想在回发验证错误的情况下显示表单，那么您需要`rendered`相应地更改其属性。代替

```
<h:form id="insurance-form" rendered="#{(param['insSaved']=='editable')}"> 
```

经过

```
<h:form id="insurance-form" rendered="#{(facesContext.postback and facesContext.validationFailed) or (param['insSaved'] == 'editable')}"> 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2016-01-12T08:20:30.443

我遇到了这个问题，响应是删除 primefaces 库，然后再次添加到库列表中。

# c# - 使用 C# 检查表中是否存在值

> ID：13128267
> 
> 赞同：0
> 
> 时间：2012-10-29T19:25:03.620
> 
> 标签：c#, asp.net, detailsview

我想根据 DetailView 中的 ID 检查表中是否存在某些值。例如，我在表中有 4 个字段：

ID 已批准1 已批准2 已批准3

A）首先我想检查 Approved1、Approved2、Approved3 是否不为空，这意味着所有 3 个字段的值为是或否。如果其中任何一个为空或空白，那么我想退出该功能

B）如果所有 Approved(*) 字段的值基于 DetailView 中选定的 ID 为“YES”，那么我想调用一些函数；C）如果已批准的字段之一是“否”，那么我想调用其他一些函数。

到目前为止，我有以下内容，但不知道如何将它们组合在一起。谢谢这是我的aspx文件

```
 <asp:DetailsView ID="DV_Mgr_Appr" runat="server" Height="50px" Width="867px" AutoGenerateRows="False"
            BackColor="White" BorderColor="#E7E7FF" BorderStyle="None" BorderWidth="1px"
            CellPadding="3" DataKeyNames="ID" DataSourceID="DV_ManagerApp_DS" GridLines="Horizontal"
            DefaultMode="Edit">
            <AlternatingRowStyle BackColor="#CCCCFF" />
            <EditRowStyle BackColor="#FFFFE1" Font-Bold="True" ForeColor="#003366" />
            <Fields>
                <asp:BoundField DataField="ID" HeaderText="ID" ReadOnly="True" 
                    SortExpression="ID" />
'''
'''
'''
'''
<asp:TemplateField ShowHeader="False">
                    <EditItemTemplate>
                        <asp:Button ID="Button1" runat="server" CausesValidation="True" 
                            CommandName="Update" Text="Save Changes" />
                        &nbsp;<asp:Button ID="Button2" runat="server" CausesValidation="False" 
                            CommandName="Cancel" Visible="false" Text="Cancel" />
                    </EditItemTemplate>
                    <ItemTemplate>
</asp:DetailsView> 
```

# c# - 应用启动时预加载 UI 控件

> ID：13128270
> 
> 赞同：0
> 
> 时间：2012-10-29T19:25:17.107
> 
> 标签：c#, windows-phone-7

我正在开发一个 Windows Phone 7 应用程序，我将使用 Bing 地图控件。

我的问题是，当我使用此控件导航到页面时，它会变得太长而无法仅在第一次加载。

我认为我可以在启动时加载此 UI 控件（显示启动画面时）。

我可以这样做吗？我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T21:25:51.537

从来没有为微软的移动平台写过任何东西，但我想到的第一件事就是移除启动画面。而是让飞溅与地图控件和其他所有内容重叠。然后在加载完成后隐藏它（并且设定的时间已经过去）？

作为替代方案，您可以尝试[此（类似）问题的答案之一中](https://stackoverflow.com/questions/10314930/is-it-possible-to-preload-an-assembly-in-windows-phone-7)显示的预加载代码。

# c# - Task.Run 和 Func<>

> ID：13128271
> 
> 赞同：15
> 
> 时间：2012-10-29T19:25:21.333
> 
> 标签：c#, windows-runtime, .net-4.5

如何运行返回值并接受参数的任务？我看到有一个重载的方法`Task.Run<TResult>(Func<TResult>)`，但是我如何在那里传递参数？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-10-29T19:26:47.117

`Func<TResult>`不带参数。通常，您会改为使用 lambda 表达式来*捕获参数。*例如：

```
public void DoSomething(string text)
{
    Task<int> task = Task.Run(() => text.Length);
    ...
} 
```

这`text`是一个*捕获的变量*......所以即使你只是创建一个`Func<int>`，它也*使用*方法参数。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-29T19:49:22.187

您可以使用 Task.Factory.StartNew() 重载传入一个“状态”对象，该对象包含您想要使用的所有参数。这是一个传入 NameValueCollection 的非常基本的示例，但您显然可以传入任何类型的对象。

```
Task<bool>.Factory.StartNew(
    ( a ) => {
        NameValueCollection nvc = a as NameValueCollection;
        if( nvc != null ) {
            nvc.AllKeys.ForEach( k => Console.WriteLine( nvc[k] ) );
        }
        return true;
    },
    new NameValueCollection() { { "param1", "hithere!" } } ); 
```

# c++ - SDL_LockSurface() 用于多线程

> ID：13128272
> 
> 赞同：1
> 
> 时间：2012-10-29T19:25:21.797
> 
> 标签：c++, sdl

由于我一直收到这些错误：

```
[xcb] Unknown request in queue while dequeuing
[xcb] Most likely this is a multi-threaded client and XInitThreads has not been called
[xcb] Aborting, sorry about that.
main: ../../src/xcb_io.c:178: dequeue_pending_request: Assertion `!xcb_xlib_unknown_req_in_deq' failed. 
```

编辑：有时我也会收到此错误：

```
XIO:  fatal IO error 11 (Resource temporarily unavailable) on X server ":0.0"
  after 48888 requests (48888 known processed) with 0 events remaining. 
```

我试图使我的程序多线程安全，所以我在直接访问像素之前调用 SDL_LockSurface。

我知道这些函数访问像素：

```
int SDL_BlitSurface(SDL_Surface *src, SDL_Rect *srcrect, SDL_Surface *dst, SDL_Rect *dstrect);
int SDL_FillRect(SDL_Surface *dst, SDL_Rect *dstrect, Uint32 color); 
```

还有其他直接访问像素的功能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T19:42:46.930

SDL_LockSurface 用于直接访问像素，它与多线程无关。

SDL 只允许您从一个线程访问其库函数 - 初始化库和视频子系统的线程，这适用于大多数 gfx 或 UI 库。

您必须在主线程中提取像素副本，并将它们分发给其他线程进行处理。（如果在处理完像素后需要再次显示某些内容，则将结果组合回主线程）

# jquery - ajaxfileupload.js 如何重命名上传的文件并设置目标文件夹（保存到）？

> ID：13128274
> 
> 赞同：0
> 
> 时间：2012-10-29T19:25:27.800
> 
> 标签：jquery

我打算使用 ajaxfileupload.js 通过 ajax 调用上传文件。使用它，可编辑

我不知道如何提供目标文件夹来保存上传的文件？另外，如果可能的话，我可以在将文件保存到服务器之前更改文件的名称吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T19:29:30.293

您必须使用您选择的语言在服务器端执行此操作。ajaxfileupload-"destination" 是一个处理您的文件的脚本。

# c# - Winrt 的滑动抽屉？

> ID：13128275
> 
> 赞同：1
> 
> 时间：2012-10-29T19:25:29.353
> 
> 标签：c#, xaml, windows-8, windows-runtime

在 Android 中，有一个小部件调用`SlidingDrawer`，我想知道 C#/XAML 是否有类似的东西，我可以在需要时隐藏我的内容并拖出我的内容。![在此处输入图像描述](../Images/cab409f8dfee17cf56d51d92ccab1f16.png)

像这样除外，**从上到下**。我已经看过`AppsBar`哪些是我需要的还不够。感谢您的任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T22:22:54.200

I don't believe it is there, though it could be fairly easy to implement. A different problem is that the AppBar should be sufficient and better in most scenarios since it does not require anything to pull it out.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T22:25:59.923

Windows 8 设计指南建议您应该将应用栏用于您希望集成的控件类型，您可以在此处找到有关如何执行实施的更多信息和详细信息：

[快速入门：添加应用栏（使用 C#/VB/C++ 和 XAML 的 Windows 应用商店应用）](http://msdn.microsoft.com/en-us/library/windows/apps/xaml/hh781232.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-22T22:53:23.133

GitHub上有一个`DrawerLayout`项目：

[https://github.com/amarmesic/windows-phone-navigation-drawer](https://github.com/amarmesic/windows-phone-navigation-drawer)

它可以通过 NuGet 获得：

[https://www.nuget.org/packages/DrawerLayout/](https://www.nuget.org/packages/DrawerLayout/)

# ios - 帐户过期后如何从 iTunes Connect 中删除 iOS 应用程序

> ID：13128282
> 
> 赞同：2
> 
> 时间：2012-10-29T19:26:06.793
> 
> 标签：ios, app-store, app-store-connect

我的客户为他们的应用程序有一个 iTunes 开发帐户，出于某种原因，他们希望在新帐户下使用新版本的应用程序。他们创建了新帐户，但让旧帐户过期。

需要先删除旧应用程序，然后才能在新帐户中使用相同的名称。iTunes Connect 不允许我们这样做！！该应用程序已在所有地区停止销售。应用程序的状态为“待定合同”，删除按钮未出现。

如果有人可以引导我们到正确的位置（在门户中）向 Apple 提出此类问题，或者我们可以通过某种方式自行解决问题，那将会很有帮助。

谢谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T13:57:15.563

所以这就是最后发生的事情。在与 Apple 多次来回通话以解决此问题（包括验证此类请求的原因以及验证同一个人/公司对两个帐户的所有权）后，Apple 重新激活了旧的开发者帐户 10 天，在此期间，可以对该帐户进行任何更改，包括删除旧应用程序（从而释放该名称以在另一个帐户中使用）。他们还警告说，将来不会以任何理由给予这种延期。

希望这对将来的其他人有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T19:55:32.873

您的客户可能需要更新旧的开发者帐户才能进行**任何**更改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-23T13:06:52.210

我认为最好的解决方案是将应用程序转移到新帐户：

[https://developer.apple.com/library/ios/documentation/LanguagesUtilities/Conceptual/iTunesConnect_Guide/Chapters/TransferringAndDeletingApps.html](https://developer.apple.com/library/ios/documentation/LanguagesUtilities/Conceptual/iTunesConnect_Guide/Chapters/TransferringAndDeletingApps.html)

您将保留所有信息和历史记录。

# powershell - 使用非字符串作为 $env: 变量

> ID：13128284
> 
> 赞同：5
> 
> 时间：2012-10-29T19:26:13.633
> 
> 标签：powershell, environment-variables, hashtable

我想将哈希表存储在环境变量中——这在 Powershell 中可行吗？

这是我测试的方法：

```
$env:test = @{}
$env:test
$env:test|gm 
```

并且感到困惑，因为输出是：

> System.Collections.Hashtable
> 
> 类型名称：System.String
> 
> 名称 MemberType 定义
> 
> ---- ---------- ---------- 克隆方法 System.Object Clone()
> CompareTo 方法 int CompareTo(System.Object value), int CompareTo(string strB) 。 ..

...因此，当我直接返回 $env:test 时，我得到了 'Hashtable'，但是当我通过管道将它传递给 get-member 时，返回了 system.string。有人可以解释这种行为吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-07-12T05:33:54.113

环境变量***($env:stringVariable)***是字符串。但是，您似乎希望将哈希表类型的非字符串变量设为全局变量。这可以通过使用*全局修饰符* ***($global:hashtableVariable)***来完成。这将允许您从另一个脚本文件中的一个脚本文件访问变量，如此处所示

**PowerShellScriptFile-1.ps1**

```
$global:hashtableVariable = @{
   'key1' = 'value1'
   'key2' = 'value2'
} 
```

**PowerShellScriptFile-2.ps1**

```
$global:hashTableVariable.GetEnumerator() | ForEach-Object {
       Write-Host "$($_.Key):$($_.Value)"
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T20:06:29.533

知道了。“System.Collections.Hashtable”是分配给 $env:test 的字符串值

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-03-31T17:26:45.990

晚了一点，但是现在您可以这样做了，尽管由于环境变量是严格的字符串，您需要将它分配给代码中的其他内容，并且您需要使用该`Microsoft.PowerShell.Utility`模块。

```
import-module Microsoft.PowerShell.Utility 
$hash = ConvertFrom-StringData -StringData $env:myvar 
```

您将需要适当地格式化您的环境变量，例如：

```
$env:myvar = "Fname = John ``n Lname= Smith ``n DOB = 01/01/1980" 
```

只使用一个反引号，我不知道如何只让一个显示正确。

请参阅[https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/convertfrom-stringdata?view=powershell-7](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/convertfrom-stringdata?view=powershell-7)

# kineticjs - KineticJs 手写选择路径/笔划

> ID：13128292
> 
> 赞同：0
> 
> 时间：2012-10-29T19:26:49.020
> 
> 标签：kineticjs

有什么方法可以在 KineticJs 上选择笔迹（路径/笔画组）吗？在画布上书写然后发送到服务器进行识别是相当简单的，但是我想知道是否可以选择一个手写的单词。除非我遗漏了某些东西，否则这在 SVG 中可能是不可能的。任何信息都将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-27T16:45:40.403

因为我已经深入到手写识别等。我可以确认关于输出阶段的答案是不正确的。虽然它会输出不是问题的阶段。为了完整起见，问题与选择笔划/点作为单个对象有关，就像在 SVG 中一样。

画布上的笔迹由笔划/点组成。不是画布上的引用对象。您可以使用诸如[fabricjs 之](http://fabricjs.com/)类的库，我发现它在进行一组笔画方面非常有用。面料的开发人员也非常关注该项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T16:49:51.267

很有可能。您可以通过创建线条并将点推向它们来在舞台上书写。那么你可以这样做：

```
 stage.toImage();
 //or
 stage.toDataURL(); 
```

并将其发送到您的服务器进行识别。

# sql - SQL 查询：需要按数量排序，大多数必须在最前面，其余的在后面

> ID：13128296
> 
> 赞同：6
> 
> 时间：2012-10-29T19:27:00.190
> 
> 标签：sql, sql-server-2008, tsql, sql-order-by

表

```
JobCode Job1 Job2 Job3 zip
------- ---- ---- ---- ----------
F       F    S    NULL 90030
F       F    S    NULL 90031
F       F    S    NULL 90031
F       F    S    NULL 90034
F       F         NULL 90034
F       F    S    NULL 90034
F       F    S    NULL 90034
F       F         NULL 90034
F       F    S    NULL 90035
F       F         NULL 90035-4640 
```

预期成绩：

```
JobCode Job1 Job2 Job3 zip
------- ---- ---- ---- ----------
F       F    S    NULL 90034
F       F         NULL 90034
F       F    S    NULL 90034
F       F    S    NULL 90034
F       F         NULL 90034
F       F    S    NULL 90031
F       F    S    NULL 90031
F       F    S    NULL 90030
F       F    S    NULL 90035
F       F         NULL 90035-4640 
```

具有相同邮编的那些应该在顶部，然后是其余的。ORDER BY Zip 不起作用，因为它确实按 ZIP 排序，而不是按出现次数

使用 SQL Server 08

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-10-29T19:32:20.423

SQL Server 2008 使用**`COUNT() OVER`**

```
select *, c = count(1) over (partition by zip)
from tbl
order by c desc; 
```

如果您不需要查看附加列，则可以将该`COUNT() OVER`子句移到 ORDER BY 子句中。

```
select JobCode, Job1, Job2, Job3, zip
from tbl
order by count(1) over (partition by zip) desc; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-29T19:29:56.053

为此，您应该加入一个返回每个邮政编码计数的子查询。仅需要连接子查询来提供计数（即使未显示），而主表`yourtable`提供所有其余列。

```
SELECT 
  JobCode, 
  Job1,
  Job2,
  Job3,
  subq.zip
FROM
  yourtable
  JOIN (
     /* Subquery returns count per zip group */
     SELECT zip, COUNT(*) AS numzip 
     FROM yourtable 
     GROUP BY zip
  ) subq ON yourtable.zip = subq.zip
ORDER BY numzip DESC 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-29T19:29:40.110

```
SELECT 
  JobCode, Job1, Job2, Job3, order_jobs.zip
FROM
  jobs
  JOIN (SELECT zip, COUNT(*) AS zipcount FROM jobs GROUP BY zip) ordering 
ON jobs.zip = ordering.zip
ORDER BY zipcount DESC 
```

# ajax - OmniFaces Ajax 实用程序的 updateColumn() 不更新 p:dataTable

> ID：13128299
> 
> 赞同：3
> 
> 时间：2012-10-29T19:27:09.960
> 
> 标签：ajax, jsf, primefaces, omnifaces

最近，我关于 OmniFaces Ajax.updateColumn() 的问题得到了以下回答：

[如何通过 p:ajax 使用 OmniFaces Ajax.updateColumn() 或 Ajax.updateRow()](https://stackoverflow.com/questions/13091742/how-to-use-omnifaces-ajax-updatecolumn-or-ajax-updaterow-via-pajax)

在这种情况下，dataTable 是 JSF 标准的 h:dataTable，效果很好。

现在，在这种情况下，当最终用户通过 p:dataTable 之外存在的 p:calendar 组件选择日期时，我正在尝试更新 PrimeFaces p:dataTable。p:dataTable xhtml 如下：

```
<p:dataTable id="flightDataTable" var="flight" 
             value="#{pf_flightController.flightsForOrder}">

    <p:column headerText="Airport" style="text-align: center !important;">
        <p:inputText value="#{flight.airportTx}" maxlength="25" size="10" label="Airport"/>
    </p:column>

    <p:column headerText="Airline" style="text-align: center !important;">
        <p:inputText value="#{flight.airlineTx}" maxlength="25" size="10" label="Airline"/>
    </p:column>

    <p:column headerText="Flight Number" style="text-align: center !important;">
        <p:inputText value="#{flight.flightNumber}" maxlength="8" size="10" label="Flight Number"/>
    </p:column>

    <p:column headerText="Type" style="text-align: center !important;">
        <h:selectOneMenu value="#{flight.flightType}" label="Flight Type">
            <f:selectItem itemValue="#{bundle.DropdownOptionValueArrive}" itemLabel="#{bundle.DropdownOptionLabelArrive}"/>
            <f:selectItem itemValue="#{bundle.DropdownOptionValueDepart}" itemLabel="#{bundle.DropdownOptionLabelDepart}"/>
        </h:selectOneMenu>
    </p:column>

    <p:column headerText="Date" style="text-align: center !important;">
        <h:panelGroup rendered="#{pf_usersController.loggedInViaAndroid == 'N'}">
            <p:calendar value="#{flight.flightDate}" navigator="true"
                        label="Flight Date"
                        pattern="MM/dd/yyyy" size="10">
                <f:convertDateTime pattern="MM/dd/yyyy" />
            </p:calendar>
        </h:panelGroup>
        <h:panelGroup rendered="#{pf_usersController.loggedInViaAndroid == 'Y'}">
            <p:inputText value="#{flight.flightDate}"
                         label="Flight Date" type="date">
                <f:convertDateTime pattern="yyyy-MM-dd" />
            </p:inputText>
        </h:panelGroup>
    </p:column>

    <p:column headerText="Time" style="text-align: center !important;">
        <h:panelGroup rendered="#{pf_usersController.loggedInViaAndroid == 'N'}">
            <pe:timePicker value="#{flight.flightTime}"
                           label="Flight Time" mode="popup"
                           showPeriod="true" style="width: 80px;">
                <f:convertDateTime pattern="hh:mm a" />
            </pe:timePicker>
        </h:panelGroup>
        <h:panelGroup rendered="#{pf_usersController.loggedInViaAndroid == 'Y'}">
            <p:inputText value="#{flight.flightTime}"
                         label="Flight Time" type="time">
                <f:convertDateTime pattern="HH:mm" />
            </p:inputText>
        </h:panelGroup>
    </p:column>

</p:dataTable> 
```

最初和当前正在生产中，p:calendar p:ajax update="..." 更新了“整个”航班 p:dataTable，因此 p:dataTable 中的日期列已成功更新。我知道，我知道，如果它没有坏，那就不要修复它，但是今天我正在修改这段代码和 xhtml，所以我想使用 OmniFaces Ajax 实用程序的 updateColumn() 来只更新“一个”列此 PrimeFaces p:dataTable 的行。

下面是最终用户通过 p:calendar 选择日期时执行的代码片段；这是调用 OmniFaces Ajax 实用程序的 updateColumn() 的代码。

```
private void updateFlightDateOnAdd() {
    flightController.updateFlightDateOnAdd(current.getTripDateTime());

    UIData flightsDataTable = null;
    try {
        flightsDataTable = (UIData) Components.findComponent(":orderAddForm:flightDataTable");
    } catch (Exception e) {
        System.out.println("pf_OrdersController.updateFlightDateOnAdd(): caught exception on Components.findComponent(...)");
    }
    if (flightsDataTable != null) {
        System.out.println("pf_OrdersController.updateFlightDateOnAdd(): Components.findComponent(...) found " + flightsDataTable.getClientId());
        Ajax.updateColumn(flightsDataTable, 4);
    }
    else {
        System.out.println("pf_OrdersController.updateFlightDateOnAdd(): Components.findComponent(...) returned null");
    }
} 
```

以下是 POJO 定义：

```
public class FlightForOrder {
    private Integer flightId;
    private String airportTx, airlineTx, flightNumber;
    private Character flightType;
    private Date flightDate, flightTime;

    public FlightForOrder() {

    }

    public Integer getFlightId() {
        return flightId;
    }

    public void setFlightId(Integer flightId) {
        this.flightId = flightId;
    }

    public String getAirportTx() {
        return airportTx;
    }

    public void setAirportTx(String airportTx) {
        this.airportTx = airportTx;
    }

    public String getAirlineTx() {
        return airlineTx;
    }

    public void setAirlineTx(String airlineTx) {
        this.airlineTx = airlineTx;
    }

    public Date getFlightDate() {
        return flightDate;
    }

    public void setFlightDate(Date flightDate) {
        this.flightDate = flightDate;
    }

    public String getFlightNumber() {
        return flightNumber;
    }

    public void setFlightNumber(String flightNumber) {
        this.flightNumber = flightNumber;
    }

    public Date getFlightTime() {
        return flightTime;
    }

    public void setFlightTime(Date flightTime) {
        this.flightTime = flightTime;
    }

    public Character getFlightType() {
        return flightType;
    }

    public void setFlightType(Character flightType) {
        this.flightType = flightType;
    }

    @Override
    public int hashCode() {
        int hash = 3;
        hash = 97 * hash + Objects.hashCode(this.flightId);
        return hash;
    }

    @Override
    public boolean equals(Object obj) {
        if (obj == null) {
            return false;
        }
        if (getClass() != obj.getClass()) {
            return false;
        }
        final FlightForOrder other = (FlightForOrder) obj;
        if (!Objects.equals(this.flightId, other.flightId)) {
            return false;
        }
        return true;
    }

} 
```

测试时，服务器日志中显示以下内容：

```
INFO: pf_OrdersController.updateFlightDateOnAdd(): Components.findComponent(...) found orderAddForm:flightDataTable 
```

因此，这意味着我获得了 PrimeFaces p:dataTable 的良好参考，因此我将 UIData 类型的组件传递给 Ajax.updateColumn()。

最终结果，PrimeFaces 数据表没有被 OmniFaces Ajax 实用程序的 updateColumn() 更新。

我刚刚注释掉 Ajax.updateColumn(...) 并将 update="..." 重新添加到 p:calendar p:ajax，并且 PrimeFaces 数据表已成功更新。

请告知我可能需要做什么来确保通过 Ajax.updateColumn(...) 更新 PrimeFaces 数据表。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T00:44:39.917

更换

```
<p:column headerText="Date" style="text-align: center !important;">
    <h:panelGroup rendered="#{pf_usersController.loggedInViaAndroid == 'N'}">
        <p:calendar value="#{flight.flightDate}" navigator="true"
                    label="Flight Date"
                    pattern="MM/dd/yyyy" size="10">
            <f:convertDateTime pattern="MM/dd/yyyy" />
        </p:calendar>
    </h:panelGroup>
    <h:panelGroup rendered="#{pf_usersController.loggedInViaAndroid == 'Y'}">
        <p:inputText value="#{flight.flightDate}"
                     label="Flight Date" type="date">
            <f:convertDateTime pattern="yyyy-MM-dd" />
        </p:inputText>
    </h:panelGroup>
</p:column> 
```

经过

```
<p:column headerText="Date" style="text-align: center !important;">
    <p:calendar value="#{flight.flightDate}" navigator="true"
                label="Flight Date"
                pattern="MM/dd/yyyy" size="10"
                rendered="#{pf_usersController.loggedInViaAndroid == 'N'}">
        <f:convertDateTime pattern="MM/dd/yyyy" />
    </p:calendar>
    <p:inputText value="#{flight.flightDate}"
                 label="Flight Date" type="date"
                 rendered="#{pf_usersController.loggedInViaAndroid == 'Y'}">
        <f:convertDateTime pattern="yyyy-MM-dd" />
    </p:inputText>
</p:column> 
```

应该修复它。

说明：`Ajax#updateColumn()`仅将*直接*子代的客户端 ID 添加到`PartialViewContext#getRenderIds()`. 但是， a`<h:panelGroup>`没有任何最终应出现在结果 HTML 输出中的属性，例如`id`，不会将任何内容呈现到 HTML 输出中。因此 JS/Ajax 无法定位 HTML 表示`<h:panelGroup>`以更新它。

该修复程序将表格单元格的具体内容改为*直接*子级，这样 JS/Ajax 将能够定位和替换它们。另一种方法是给这些面板组一个具体`id`的，但这在这个结构中是不必要的。

# jquery - Ajax、jQuery 替换

> ID：13128304
> 
> 赞同：0
> 
> 时间：2012-10-29T19:27:41.003
> 
> 标签：jquery

使用html：

```
<div id="dynamic-choice">
<a href="http://www.google.com/" class="ajaxLink">click me</a>
<a href="a.nother/page/toload.html" class="ajaxLink">click me 2</a>
</div>

<div id="dynamic-content">
<p>this will be replaced</p>
</div> 
```

和 javascript

```
<script src="js/jquery-1.8.2.js"></script>

<script>
$(document).ready(function(){
$('a.ajaxLink').click(function(){
var url = $(this).attr('href');
$('#dynamic-content').empty().load(url);
});
return false;
});
</script> 
```

然而，锚只是表现得像普通链接：/

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T19:35:20.727

```
$('a.ajaxLink').click(function(e){
e.preventDefault();
var url = $(this).attr('href');
$('#dynamic-content').empty().load(url);
}); 
```

是您的代码的工作版本。

您必须传递事件`e`才能使用 preventDefault 方法，以防止锚点正常运行！

**文档：**

[event.preventDefault()](http://api.jquery.com/event.preventDefault/)

# .net - Windows 应用商店应用程序在优化关闭的情况下未能通过认证？

> ID：13128312
> 
> 赞同：3
> 
> 时间：2012-10-29T19:28:12.920
> 
> 标签：.net, windows-runtime, windows-store-apps, compiler-optimization

我有一件相当特别的事情正在做。（在 Windows Store 应用程序中测试 IL 转换）......如果这听起来很奇怪，请原谅，请避免只告诉我“打开优化”

无论如何，当我尝试验证一个空白的 Windows 商店应用程序时，我遇到了一个非常奇怪的问题。我所做的只是创建它，修改它的发布配置以不使用优化，然后将它构建到一个包中。但是，在尝试验证此软件包时，出现此错误：

> 调试配置测试
> 
> 二进制 App1.exe 在调试模式下构建。

显然，启用调试和禁用优化是两件不同的事情……不是吗？这是认证实用程序中的错误吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T20:09:10.797

问题最终是应用程序认证过程似乎只是盲目地寻找 .pdb 文件。当代码未优化时，默认生成此文件。进入 Visual Studio 中构建设置的“高级”菜单，有一个调试信息选项。将其更改为“无”为我解决了这个问题。

# zend-framework - 如何将 url 分配给使用 Zend_Translate 翻译的文本的一部分？

> ID：13128313
> 
> 赞同：0
> 
> 时间：2012-10-29T19:28:21.747
> 
> 标签：zend-framework, hyperlink, zend-translate

我正在使用 Zend Framework 和 Zend_Translate，数组适配器。假设我有以下文章：`"Neque porro quisquam est qui dolorem ipsum quia dolor sit amet, consectetur"`以及我将在我的网站上使用的语言的翻译。单词`quisquam`, `dolorem`,`consectetur`代表链接。我想在我的视图脚本中呼应整篇文章，代码：`echo $this->translate->_('someArticle');`. 但显然提到的单词不会显示为链接。是否有可能以某种方式扫描视图脚本以查找代表链接的那些单词，以便使用例如在相应控制器中声明的 url 显示出来？还是我必须在作为链接的单词之前和之后逐段翻译？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T21:24:51.520

到目前为止，我发现的唯一解决方案是在翻译中插入链接。示例：在视图脚本中：`echo $this->translate->_('someArticle');` 在翻译文件（数组适配器）中：`"someArticle" => "Neque porro quisquam est qui <a href=\"/ControllerName/methodName\">dolorem</a> ipsum quia dolor sit amet, consectetur"` 就是这样：dolorem 将显示为链接。只是不要忘记用反斜杠转义“”。

# bash - bash - 执行快捷方式

> ID：13128314
> 
> 赞同：1
> 
> 时间：2012-10-29T19:28:29.957
> 
> 标签：bash

我想执行 foo.bsh，只输入 foo.bsh 甚至 foo 而不是 ./foo.bsh。我想暂时对目录中的所有 .bsh 以及全局执行此操作。例如，我想要一个全局密钥 MYIP，它调用脚本来回显我的外部 IP。我不知道这是否有意义，因为如果我覆盖回声，我的 bash 可能会崩溃。

编辑：更清楚。我想要一个写“./”的快捷方式，为这些命令节省了 2 个键，例如在 DOS 中 foo.exe 可以用 foo 执行。如果我键入 foo (ENTER) ，是否无法在当前目录中查找 .bsh 文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T19:38:59.277

当找不到命令时，您可以挂钩 bash 的处理，并添加您自己的函数来处理您喜欢的任何内容。例如，将此添加到您的 .bashrc：

```
function command_not_found_handle()
{
    [ -f "${1}.bsh" ] && bash "${1}.bsh"
} 
```

因此，如果您在当前目录中有 foo.bsh，您只需键入“foo”，它就会运行。

编辑：澄清——当 bash 用尽其内部机制来查找您键入的命令时，它将以命令名称作为参数运行 command_not_found_handle() 函数。所以，你可以用你想要的任何逻辑来定义这个函数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-29T19:49:01.710

你真的不应该这样做，但是在你的 .bashrc 或 session 中输入这个以将当前目录添加到 PATH 中。

```
PATH=$PATH:. 
```

当然，这意味着如果有人将具有相似名称的命令放在目录中，它可以很容易地执行。

所以攻击者会：

```
cd /shared_directory
echo "rm -rf all_your_files" > apropo
chmod +x apropo 
```

然后你：

```
cd /shared_directory
apro<TAB> (completes to apropo)
(all your files are gone). 
```

如果您想知道这里的目标命令是恰当的。

通常，更好的解决方案是将您的可执行文件链接到 PATH 中的某些内容，例如 ~/bin

所以：

```
PATH=$PATH:~/bin (in your bashrc or whatever)
ln -s ~/some_executable ~/bin
some_executable 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T19:35:29.233

您可以通过编辑 ~/.bash_profile 页面并将可执行文件所在的目录添加到列表末尾来实现此目的，例如

```
export PATH=$PATH:/your/directory 
```

我通常创建一个 ~/bin 目录并将我所有的可执行文件存储在这个目录中。所以我通常将此条目添加到我的 ~/.bash_profile 文件中

```
export PATH=$PATH:/home/yourname/bin/ 
```

之后，我的 bin 目录中的所有脚本（以前是 chmod +x ）只需在控制台上通过名称调用它们即可工作。

我希望它有所帮助。干杯

# ios - 如何通过程序知道滚动视图中存在的标签和文本字段的数量？

> ID：13128323
> 
> 赞同：1
> 
> 时间：2012-10-29T19:29:16.440
> 
> 标签：ios

我拿了一个滚动视图，我正在动态添加标签，看起来像这样

```
for(int tempvariable=0; tempvariable<n;tempvariable++)
{
   CGRect labelFrame2 = CGRectMake(  x3,y3, 20, 20 );
   UILabel *label3=[[UILabel alloc]initWithFrame:labelFrame2];
   [subview addSubview:label3];
}

[self.scrollView addSubview:subview]; 
```

`"n"`是将标签n次添加到子视图后的动态值我已将子视图添加到滚动视图。现在我想打印滚动视图上所有标签的标题`NSLog(@'");`

如果我想更改一些标签的标题，我怎么能只通过没有子视图的滚动视图来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T19:37:23.783

```
for (UIView *subview in self.scrollView.subviews)
{
    if ([subview isKindOfClass:[UILabel class]])
    {
        UILabel* l=(UILabel)subview;
        NSLog(@"%@",l.text);
        l.text=@"new title";
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T19:44:10.617

您可以设置标签以找到要更改标签文本的标签。

```
for(int tempvariable=0; tempvariable<n;tempvariable++)
{
   CGRect labelFrame2 = CGRectMake(  x3,y3, 20, 20 );
   UILabel *label3=[[UILabel alloc]initWithFrame:labelFrame2];
   label3.tag = tempVariable;

// you can set the label text here..
   [subview addSubview:label3];
} 
```

正如@tillerstarr 在他的回答中提到的，您可以迭代您的子视图以获取标签的文本。

```
for (UIView *subview in self.scrollView.subviews)
{
    if ([subview isKindOfClass:[UILabel class]])
    {
        if (subview.tag == 5) {
             UILabel* l=(UILabel)subview;
             // you can check the tag value and change the label title as like this
             l.text=@"fifth label";
          }
    }
} 
```

# c++ - 使用字符串中的 getline 从文件中读取，然后从 int 数组中的字符串中拆分数字

> ID：13128324
> 
> 赞同：-2
> 
> 时间：2012-10-29T19:29:25.167
> 
> 标签：c++

我正在尝试从 .txt 文件中读取一些由空格分隔的数字。（一行最多 4 个数字）。

*   我得到了这条线，但是在我移动到第二行覆盖数组之后，如何将它转换为 int 数组？

示例：.txt 文件

```
2 5 8 14 11
50 40 30 20 10
18 17 16 15 14 
```

代码：

```
fstream f("C:\\n.txt");
string wtf;
int n;
while(f>>n)
{
getline(f,wtf);
//transform the wtf string into int array?
//do what ever...
//clear the array?
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T19:36:51.147

使用`std::istringstream`和`std::vector`：

```
std::string line;
while(std::getline(f, line)) {
  std::istringstream iss(line);
  std::vector<int> v;
  int i;
  while(iss > i) {
    v.push_back(i);
  }
  // do whatever
  // vector cleared automatically
} 
```

# python - 将应用程序创建的文件拖放到资源管理器窗口

> ID：13128328
> 
> 赞同：4
> 
> 时间：2012-10-29T19:29:44.293
> 
> 标签：python, windows, wxpython, wxwidgets

我有一个 ListCtrl 包含一些代表（巨大和远程）文件的项目。我希望用户能够将项目拖到打开的目录窗口中，从而创建一个文件（真正启动下载）。我希望我的应用程序收到类似“用户将您的列表项拖到此路径”的消息，以便我可以继续并将文件数据写入该位置。

如果源文件在本地文件系统上可用，我知道如何做[类似](http://www.blog.pythonlibrary.org/2012/08/01/wxpython-how-to-drag-and-drop-a-file-from-your-app-to-the-os/)的事情，但是我的文件很大并且在远程系统上（想想 FTP 客户端），所以我不能推测性地将它们复制到磁盘以防用户想要拖动'n' 以后再放下它们。

如何使用 wxpython 完成此任务？甚至可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-14T15:11:18.027

我在网上搜索得很辛苦，但也找不到这样做的方法。甚至 Robin Dunn 也表示，当数据被放入文件系统时，drop source 应用程序对目标一无所知。但我想出了一个简单的方法来做到这一点，至少在 Windows 上是这样。我们只需将包含空 FileDataObject 的 DropSource 拖到资源管理器窗口中。由于没有数据，所有这一切都是将资源管理器窗口带到顶部，这使我们能够获取用户拖入的文件夹的路径。`__init__`首先，确保在 ListCtrl 的父级的 def 中将事件绑定到 ListCtrl up ：

```
self.lc.Bind(wx.EVT_LIST_BEGIN_DRAG, self.onDrag) 
```

然后在事件调用的方法中执行此操作：

```
def onDrag(self, event):
    data = wx.FileDataObject()
    obj = event.GetEventObject()
    dropSource = wx.DropSource(obj)

    dropSource.SetData(data)

    #next line will make the drop target window come to top, allowing us
    #to get the info we need to do the work, if it's Explorer
    result = dropSource.DoDragDrop(0)

    #get foreground window hwnd
    h = win32gui.GetForegroundWindow()

    #get explorer location
    s = win32com.client.Dispatch("Shell.Application")
    loc, outdir = None, None
    for w in s.Windows():
        if int(w.Hwnd) == h:
            loc = w.LocationURL
    if loc:
        outdir = loc.split('///')[1]
        outdir = urllib.unquote(outdir)

    #got what we need, now download to outfol
    if outdir and os.path.isdir(outdir):
        self.dloadItems(event, outdir)

    return 
```

dloadItems 方法从 ListCtrl 获取所选项目，然后（在此应用程序中）将项目从 REST 服务器下载到 outdir。

当然，此解决方案需要 pywin32 扩展。

祝你好运，

麦克风

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T20:18:22.310

我不知道如何将它集成到 wxpython 中，但是[shell 支持多种剪贴板格式](http://msdn.microsoft.com/en-us/library/windows/desktop/bb776902%28v=vs.85%29.aspx)来复制文件。如果文件在网络驱动器上（例如可通过 UNC 路径访问），那么您可以使用像 CF_DROP 格式这样简单的东西。如果没有那么简单，那么您将不得不使用 CFSTR_FILEDESCRIPTOR/CFSTR_FILECONTENTS 格式。这是在 C 或 C++ 中实现的真正苦差事，所以我想它在 python 中会加倍。不过，可能有人已经完成了繁重的工作；你应该看看是否有一个 python 库来处理 shell 剪贴板格式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T20:57:36.330

如果您可以在 ListCtrl 中显示数据，那么您可以将列表项绑定到路径。就个人而言，我会使用 ObjectListView ，因为这会使这类事情变得更容易。然后，当您进行拖放时，您可以取出放置的对象并提取路径/ URL。之后，您只需要使用适当的 Python 库，例如 ftplib 或 urllib 来下载文件。

既然您发现我的博客对您很有帮助，我将指出其他一些可能对您有所帮助的教程：

*   [http://www.blog.pythonlibrary.org/2012/07/19/python-101-downloading-a-file-with-ftplib/](http://www.blog.pythonlibrary.org/2012/07/19/python-101-downloading-a-file-with-ftplib/)
*   [http://www.blog.pythonlibrary.org/2012/06/07/python-101-how-to-download-a-file/](http://www.blog.pythonlibrary.org/2012/06/07/python-101-how-to-download-a-file/)

# functional-programming - 逻辑运算符和/或如何工作？

> ID：13128332
> 
> 赞同：0
> 
> 时间：2012-10-29T19:30:03.107
> 
> 标签：functional-programming

有人可以向我解释一下`and`和`or`运算符在 Lisp 中是如何工作的吗？

假设我有一个函数，我想用四个参数编写一个函数的条件表达式组合

```
and4 (x1 x2 x3 x4) 
```

和

```
or4 (x1 x2 x3 x4) 
```

`and`与函数和四个参数相吻合`or`，有人可以解释我如何将它们联系起来或想出如下类似的东西：

```
and4(1,1,1,1) => 1
and4(1,0,1,1) => 0
or4(1,1,1,1) => 1
or4(0,0,1,0) => 1 
```

我只是对如何理解`and`and`or`运算符的简单解释感兴趣，甚至是一个例子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T19:40:58.573

好吧，你必须从简单开始。

假设数字 1 为真，0 为假。

这是逻辑 AND 运算符的真值表（在许多编程语言中也称为 &&）

```
a | b | a AND b
0 | 0 |    0
0 | 1 |    0
1 | 0 |    0
1 | 1 |    1 
```

因此，如果 a 为真且 b 为真，则 a && b 为真。

OR 运算符的工作方式略有不同这是逻辑 OR 运算符的真值表（在许多编程语言中也称为 ||）

```
a | b | a OR b
0 | 0 |   0
0 | 1 |   1
1 | 0 |   1
1 | 1 |   1 
```

因此，如果 a 为真 OR b 为真，则 a OR b 为真。

您上面列出的语句以类似的方式工作。

```
AND4 (x1 x2 x3 x4) 
```

当且仅当所有变量都为真时，上述内容才会返回 1（真）；

```
OR4 (x1 x2 x3 x4) 
```

如果至少有一个变量为真，则上面将返回 1（真）；

# grails - 将服务注入多个域类以在视图中使用

> ID：13128338
> 
> 赞同：0
> 
> 时间：2012-10-29T19:30:32.230
> 
> 标签：grails

我的目标是能够在我的各种域类中重用一些代码，最终在我的 gsps 中填充各种列表框。我有一项服务，但插入它时运气不佳。这是我的代码。

填充列表框服务：

```
import org.codehaus.groovy.grails.commons.ApplicationHolder as AH 
import groovy.sql.Sql

class PopulateListBox {

def dataSource = AH.application.mainContext.dataSource
def sql

def getStates(){

    sql = new Sql(dataSource)
    def states = []
    sql.eachRow("SELECT stvstat_desc FROM stvstat ORDER BY stvstat_desc"){
        states.add(it.stvstat_desc)
    }

    sql.close()

    [states:states]
}

} 
```

在我的一个域类中，我尝试在约束块中使用它，如下所示：

```
def PopulateListBox

static constraints = {
    nursingLicenseState(blank:false, inList:PopulateListBox.getStates())
} 
```

但这似乎不起作用。我如何引用我的服务并且仍然能够在我的视图中从域类访问它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T19:44:21.887

一些东西：

1.  您真的应该尝试遵守约定，并让您的服务以 *Service 结尾
2.  在将服务注入域对象的地方，第一个字母需要小写。
3.  在域对象中使用服务时，应将其声明为`transient`.

所以你的服务应该被创建（并且 Grails 通常默认附加这个）：

```
class PopulateListBoxService {
    ...
} 
```

然后你的域对象应该看起来像：

```
class MyDomainObject {
    def populateListBoxService
    ...
    static transients=['populateListBoxService']
    ...
} 
```

让我知道它是否有效。

# .net - 映射网络驱动器时的自定义身份验证 - 这可能吗？

> ID：13128341
> 
> 赞同：3
> 
> 时间：2012-10-29T19:30:51.687
> 
> 标签：.net, authentication, iis-7.5, webdav, mapped-drive

我在 IIS 7.5 中的网站中设置了一个虚拟目录，用户可以将网络驱动器映射到该目录。我想做的是设置某种自定义身份验证，用户在映射驱动器时选择“使用不同的凭据连接”，然后我可以使用这些凭据将它们登录到我的网站，然后让他们查看内容的虚拟目录。这可能吗？

我似乎找不到（以编程方式）获取映射驱动器时使用的凭据的方法。现在，我对虚拟目录的每个请求都有一个`HttpModule`并`HttpHandler`执行，但我没有看到检测凭据的方法。有没有人做过这样的事情？

如果这是不可能的，有人可以解释选择使用不同凭据连接的目的是什么？这些凭据在哪里使用，是否由 IIS 中的某种形式的身份验证使用？当然必须有某种设置来*使用*不同的凭据？

**更新：**

使用 Digest Authentication，我现在可以在 Fiddler 中看到 Authorization 标头，但我不确定是否可以以某种方式解析密码。我还在网上看到一些文章表明摘要式身份验证存在根本缺陷，但根据[ASP.NET 中的身份验证：.NET 安全指南](http://msdn.microsoft.com/en-us/library/ee817643.aspx)，如果我的用户存储在自定义数据库中，我不应该使用基本身份验证。

**所以让我列出一个更简单的场景，希望它更容易回答：**

我正在尝试实现将网络驱动器映射到我站点中的虚拟目录时使用的自定义身份验证。我正在使用 IIS 7.5。我需要解析出用户名和密码来处理自定义登录，无论是在一个`HttpModule`事件还是 Global.asax 事件中。有没有人做过这样的事情或有任何建议/建议？

我发现[这个例子似乎可以工作](http://blog.smithfamily.dk/2008/08/27/ImplementingBasicAuthenticationInASPNET20.aspx)- 但它适用于浏览器。我现在在我的测试站点上实现了它，但问题是在映射驱动器时，返回 401 质询（应该提示登录）但 Windows 显示一个错误，显示：

> Windows 无法访问`Http://myServer/mySite/myFolder`
> 
> 检查名称的拼写。否则，您的网络可能有问题。
> 
> 错误代码：0x80070043 找不到网络名称

我想知道是否可以格式化/构建基本/摘要式身份验证样式的质询响应，以便 Windows 提示登录而不是显示找不到网络？有谁知道这是否可能？

**更新 2：**

我看到使用 Fiddler，Windows 身份验证包含一个`Negotiate`标头。因此，除了标题之外，我还尝试在我的质询响应中包含该`WWW-Authenticate: Basic`标题。这似乎解决了我上面描述的“找不到网络名称”错误的问题，但不幸的是，现在后续请求中没有包含 Authorization 标头（在我提供我的凭据之后），所以我无法提取用户名和密码。

我的想法在这里用完了，虽然似乎有很多关于身份验证的文档，但似乎没有太多关于 WebDAV 身份验证（或如何使用它）或映射驱动器时的自定义身份验证的内容。

有没有人有任何见解或想法？

**解决方案：**

看起来我不能完全按照我的意愿去做。我将使用 @AdamV 的 Windows 身份验证建议进行进一步测试，因为它看起来可能是我唯一的选择。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T19:44:09.703

我假设您正在尝试将 Active Directory 与 IIS 结合使用来映射网络驱动器。如果这个假设是正确的，我有一个想法给你。

您的第一个网站位于[http://www.mysite.com/](http://www.mysite.com/)，您可以登录它。然后，作为 IIS 中的子文件夹和新的 Web 应用程序，您设置[http://www.mysite.com/networkdrive/](http://www.mysite.com/networkdrive/)接收他们想要通过[http://www.mysite.com/](http://www.mysite.com/)在 post 参数中使用的网络路径或曲奇饼。

更重要的是，这个新应用程序将简单地使用 Windows 身份验证，并且根站点可以使用您喜欢的任何身份验证。这样，用户登录到您的站点，然后选择或键入网络驱动器路径，这将被发送到子应用程序，并自动询问 Windows 凭据，它执行的第一个操作是使用 Windows Auth 令牌映射驱动器. 您将需要关闭身份模拟并设置权限以通过其凭据执行代码以实现此目的。

当他们想要切换驱动器时，将它们从 /networkdrive/ 应用程序中注销并将它们发送回驱动器选择页面/表单。

有关 Windows 身份验证的信息：http: [//msdn.microsoft.com/en-us/library/907hb5w9 (v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/907hb5w9(v=vs.100).aspx)

**更新：**作为对 WebDAV 评论的回应，这是我在配置 WebDAV 时找到的一些文档，但它仍然使用 Windows 身份验证。[http://www.iis.net/learn/install/installing-publishing-technologies/installing-and-configuring-webdav-on-iis](http://www.iis.net/learn/install/installing-publishing-technologies/installing-and-configuring-webdav-on-iis)

# objective-c - 将 NSNumberFormatter 与多个 NSTextField 一起使用

> ID：13128348
> 
> 赞同：1
> 
> 时间：2012-10-29T19:31:26.960
> 
> 标签：objective-c, cocoa-bindings, nstextfield, nsnumberformatter

我有几个相互绑定的文本字段，它们根据顶部文本字段中的值不断更新（请参阅下面的应用程序屏幕截图）。我正在尝试使用 NSNumberFormatter 根据文本字段中字符串的长度来格式化每个文本字段中的值。如果字符串太长，那么我希望格式化程序样式切换到`Scientific`. 我正在使用`IBAction`数字`alloc init`格式化程序。

我知道有，`-(void)controlTextDidChange:(NSNotification *)obj`但这仅适用于活动的 NSTextField；我需要其他文本字段也随着它们的值变化而被格式化。

如何在不必为每个文本字段设置 IBOutlet 的情况下完成此操作？

我的格式化程序类：

```
#import "FormatterObject.h"

@interface FormatterObject ()

@property (weak) IBOutlet NSTextField *textField;

@property double numA, numB, numC;

@end

@implementation FormatterObject

- (IBAction)chooseFormatter:(id)sender {

    NSNumberFormatter *formatter = [[NSNumberFormatter alloc] init];
    [formatter setFormatterBehavior:NSNumberFormatterBehavior10_4];
    [formatter setThousandSeparator:@","];
    [formatter setMaximumFractionDigits:6];

    if ( [[_textField stringValue] length] < 10) {
        [formatter setNumberStyle:NSNumberFormatterDecimalStyle];
        [_textField setFormatter:formatter];
    }

    else {
        [formatter setNumberStyle:NSNumberFormatterScientificStyle];
        [_textField setFormatter:formatter];    
    }

    formatter = nil;
}

+ (NSSet *)keyPathsForValuesAffectingNumB {
    return [NSSet setWithObject:@"numA"];
}

+ (NSSet *)keyPathsForValuesAffectingNumC {
    return [NSSet setWithObject:@"numA"];
}

- (void)setNumB:(double)theNumB {
    [self setNumA:theNumB * 1000];
}

- (double)numB {
    return [self numA] / 1000;
}

- (void)setNumC:(double)theNumC {
    [self setNumA:theNumC * 1000000];
}

- (double)numC {
    return [self numA] / 1000000;
}

- (void)setNilValueForKey:(NSString*)key {
    if ([key isEqualToString:@"numA"]) return [self setNumA: 0];
    if ([key isEqualToString:@"numB"]) return [self setNumB: 0];
    if ([key isEqualToString:@"numC"]) return [self setNumC: 0];
    [super setNilValueForKey:key];
}

@end 
```

这是我的应用程序的样子：

![在此处输入图像描述](../Images/61f59c744071d443b3530631c25f52fa.png)

以下是每个文本字段的绑定：

![在此处输入图像描述](../Images/452ff527205706c634dd1949f676face.png)

# asp.net - blockUI 初学者，如何在单击按钮后使其运行？

> ID：13128349
> 
> 赞同：1
> 
> 时间：2012-10-29T19:31:48.220
> 
> 标签：asp.net, vb.net, blockui, jquery-blockui

我希望在用户单击一个按钮以更新数据库中的某些条目后出现 blockUI 屏幕，但是自从页面加载以来它一直在运行，这对我来说没用。我希望它在用户点击后运行，并在进程完成后停止。

这是我的代码：

```
<script type="text/javascript">

 $.blockUI({ message: '<h2>Loading</h2>' });

</script> 
```

我尝试使用 OnClientClick 事件调用该函数，但我不确定要准确调用什么，它要么给我一个错误，要么什么都不做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T11:15:43.770

它在页面加载后运行，因为它在开始时加载您的脚本，因此它执行您的 blockUI，而您忘记取消阻止它，因此您的页面仍然被阻止。要解决这个问题，您应该在单击按钮时调用一个函数，该函数将阻止您的页面，直到您在数据库中完成更新，然后取消阻止它。

```
<script type="text/javascript">
  function clicked(){
    $.blockUI({ message: '<h2>Loading</h2>' });
    updateDatabase();
  }

  function updateDatabase(){
    // updating database

    // when the database finish your updates unblock your UI
    $.unblockUI();
  }
</script>

<body>

<button onclick="clicked();">Update Database</button>
</body> 
```

我希望这能帮到您

# c# - 指向 C# 的无符号字符数组指针

> ID：13128356
> 
> 赞同：1
> 
> 时间：2012-10-29T19:32:19.720
> 
> 标签：c#, pinvoke

我有一些 C 代码将使用 P/Invoke 从 C# 调用。我有一个 C 结构成员，我正在尝试为其定义一个 C# 等效项。

```
Array16 *data; 
```

Array16 定义为

```
typedef unsigned char Array16[16]; 
```

如何定义此 C 数据成员的 C# 等效项？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T20:19:58.363

我猜你的 C 结构看起来像这样：

```
struct MyStruct {
   Array16 *data;
}; 
```

由于对有效负载的引用，我不相信您可以让 p/invoke marshaler 为您完成工作。你需要手动编组。

在 C# 代码中声明这样的结构

```
[StructLayout(LayoutKind.Sequential)]
public struct MyStruct
{
    IntPtr data;
} 
```

当您需要为函数调用准备这样的结构时，请执行以下操作：

```
MyStruct s;
s.data = Marshal.AllocHGlobal(16);
byte[] bytes = Encoding.Default.GetBytes("some string data");
Marshal.Copy(bytes, 0, s.data, Math.Min(16, bytes.Length)); 
```

如果您需要读取函数返回的数据，请在相反的方向使用相同的策略。

```
int nbytes = ... // probably returned by the function, no more than 16
byte[] bytes = new bytes[nbytes];
Marshal.Copy(s.data, bytes, 0, nbytes);
string returnedString = Encoding.Default.GetString(bytes); 
```

完成结构后，请确保通过调用释放内存

```
Marshal.FreeHGlobal(s.data); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T19:45:09.487

C# 中最接近 C++ 无符号字符的类型是字节。

# android - 滑动列表活动

> ID：13128362
> 
> 赞同：0
> 
> 时间：2012-10-29T19:32:41.447
> 
> 标签：android, listactivity, sliding

谁能提供一个示例，如何通过 ListActivity 启用 SlidingMenu（非常感谢 Jeremy Feinstein 开发了如此出色的库）？

如果我有一个 FragmentActivity，我可以设置 SlidingMenu 的内容：

```
setBehindContentView(R.layout.menu_frame);
FragmentTransaction t = this.getSupportFragmentManager().beginTransaction();
mFrag = new SampleListFragment();
t.replace(R.id.menu_frame, mFrag);
t.commit(); 
```

但这是不可能的，`ListActivity`因为我无法访问`getSupportFragmentManager()`.

有解决办法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T19:34:26.127

您需要从支持库中扩展一个 Fragment 类，如 ListFragment 或 FragmentActivity，以使用 FragmentManager。

例如：

```
public class MainActivity extends FragmentActivity { 
```

# c# - Redis IOException：“现有连接被远程主机强制关闭”使用ServiceStack C#客户端

> ID：13128363
> 
> 赞同：18
> 
> 时间：2012-10-29T19:32:45.477
> 
> 标签：c#, .net, iis, redis, servicestack

我们有以下设置：

在 RackspaceCloud 8GB 实例上的 Ubuntu Linux 12.04LTE 上的 Redis 2.6，具有以下设置：

```
daemonize yes
pidfile /var/run/redis_6379.pid

port 6379

timeout 300

loglevel notice
logfile /var/log/redis_6379.log

databases 16

save 900 1
save 300 10
save 60 10000

rdbcompression yes
dbfilename dump.rdb
dir /var/redis/6379

requirepass PASSWORD

maxclients 10000

maxmemory 7gb
maxmemory-policy allkeys-lru
maxmemory-samples 3

appendonly no

slowlog-log-slower-than 10000
slowlog-max-len 128

activerehashing yes 
```

我们的应用服务器托管在 RackSpace Managed 中，并通过公共 IP 连接到 Redis（以避免必须设置 RackSpace Connect，这是一个皇家 PITA），并且我们通过要求 Redis 连接的密码来提供一些安全性。我手动将 unix 文件描述符限制增加到 10240，最大 10k 连接应该提供足够的空间。正如您从上面的设置文件中看到的那样，我将内存使用量限制为 7GB 以留出一些 RAM 空间。

我们使用 ServiceStack C# Redis 驱动程序。我们使用以下 web.config 设置：

```
<RedisConfig suffix="">
  <Primary password="PASSWORD" host="HOST" port="6379"  maxReadPoolSize="50" maxWritePoolSize="50"/>
</RedisConfig> 
```

我们有一个 PooledRedisClientManager 单例，每个 AppPool 创建一次，如下所示：

```
private static PooledRedisClientManager _clientManager;
public static PooledRedisClientManager ClientManager
{
    get
    {
        if (_clientManager == null)
        {
            try
            {
                var poolConfig = new RedisClientManagerConfig
                {
                    MaxReadPoolSize = RedisConfig.Config.Primary.MaxReadPoolSize,
                    MaxWritePoolSize = RedisConfig.Config.Primary.MaxWritePoolSize,
                };

                _clientManager = new PooledRedisClientManager(new List<string>() { RedisConfig.Config.Primary.ToHost() }, null, poolConfig);
            }
            catch (Exception e)
            {
                log.Fatal("Could not spin up Redis", e);
                CacheFailed = DateTime.Now;
            }
        }
        return _clientManager;
    }
} 
```

我们获取一个连接并执行 put/get 操作，如下所示：

```
 using (var client = ClientManager.GetClient())
    {
        client.Set<T>(region + key, value);
    } 
```

代码似乎主要工作。鉴于我们有大约 20 个 AppPools 和 50-100 个读取和 50-100 个写入客户端，我们预计最多有 2000-4000 个到 Redis 服务器的连接。但是，我们在错误日志中不断看到以下异常，通常有几百个异常聚集在一起，一个小时内什么也没有，然后又一次，令人作呕。

```
System.IO.IOException: Unable to read data from the transport connection:
An existing connection was forcibly closed by the remote host.
---> System.Net.Sockets.SocketException: An existing connection was forcibly closed by the remote host at
System.Net.Sockets.Socket.Receive(Byte[] buffer, Int32 offset, Int32 size, SocketFlags socketFlags) at
System.Net.Sockets.NetworkStream.Read(Byte[] buffer, Int32 offset, Int32 size)
--- End of inner exception stack trace
- at System.Net.Sockets.NetworkStream.Read(Byte[] buffer, Int32 offset, Int32 size) at System.IO.BufferedStream.ReadByte() at
ServiceStack.Redis.RedisNativeClient.ReadLine() in C:\src\ServiceStack.Redis\src\ServiceStack.Redis\RedisNativeClient_Utils.cs:line 85 at
ServiceStack.Redis.RedisNativeClient.SendExpectData(Byte[][] cmdWithBinaryArgs) in C:\src\ServiceStack.Redis\src\ServiceStack.Redis\RedisNativeClient_Utils.cs:line 355 at
ServiceStack.Redis.RedisNativeClient.GetBytes(String key) in C:\src\ServiceStack.Redis\src\ServiceStack.Redis\RedisNativeClient.cs:line 404 at ServiceStack.Redis.RedisClient.GetValue(String key) in C:\src\ServiceStack.Redis\src\ServiceStack.Redis\RedisClient.cs:line 185 at ServiceStack.Redis.RedisClient.Get[T](String key) in C:\src\ServiceStack.Redis\src\ServiceStack.Redis\RedisClient.ICacheClient.cs:line 32 at DataPeaks.NoSQL.RedisCacheClient.Get[T](String key) in c:\dev\base\branches\currentversion\DataPeaks\DataPeaks.NoSQL\RedisCacheClient.cs:line 96 
```

我们已经尝试过 Redis 服务器超时 0（即没有连接超时），超时 24 小时，以及介于两者之间，没有运气。谷歌搜索和 Stackoverflowing 并没有带来真正的答案，一切似乎都表明我们至少用代码做正确的事情。

我们的感觉是，在 Rackspace Hosted 和 Rackspace Cloud 之间，我们经常遇到持续的网络延迟问题，这会导致 TCP 连接块过时。我们可以通过实现客户端连接超时来解决这个问题，问题是我们是否也需要服务器端超时。但这只是一种感觉，我们不能 100% 确定我们走在正确的轨道上。

想法？

编辑：我偶尔也会看到以下错误：

```
ServiceStack.Redis.RedisException: Unable to Connect: sPort: 65025 ---> System.Net.Sockets.SocketException: An existing connection was forcibly closed by the remote host at System.Net.Sockets.Socket.Send(IList`1 buffers, SocketFlags socketFlags) at ServiceStack.Redis.RedisNativeClient.FlushSendBuffer() in C:\src\ServiceStack.Redis\src\ServiceStack.Redis\RedisNativeClient_Utils.cs:line 273 at ServiceStack.Redis.RedisNativeClient.SendCommand(Byte[][] cmdWithBinaryArgs) in C:\src\ServiceStack.Redis\src\ServiceStack.Redis\RedisNativeClient_Utils.cs:line 203 --- End of inner exception stack trace --- at ServiceStack.Redis.RedisNativeClient.CreateConnectionError() in C:\src\ServiceStack.Redis\src\ServiceStack.Redis\RedisNativeClient_Utils.cs:line 165 at ServiceStack.Redis.RedisNativeClient.SendExpectData(Byte[][] cmdWithBinaryArgs) in C:\src\ServiceStack.Redis\src\ServiceStack.Redis\RedisNativeClient_Utils.cs:line 355 at ServiceStack.Redis.RedisNativeClient.GetBytes(String key) in C:\src\ServiceStack.Redis\src\ServiceStack.Redis\RedisNativeClient.cs:line 404 at ServiceStack.Redis.RedisClient.GetValue(String key) in C:\src\ServiceStack.Redis\src\ServiceStack.Redis\RedisClient.cs:line 185 at ServiceStack.Redis.RedisClient.Get[T](String key) in C:\src\ServiceStack.Redis\src\ServiceStack.Redis\RedisClient.ICacheClient.cs:line 32 at DataPeaks.NoSQL.RedisCacheClient.Get[T](String key) in c:\dev\base\branches\currentversion\DataPeaks\DataPeaks.NoSQL\RedisCacheClient.cs:line 96 
```

我想这是服务器端连接超时未在客户端处理的直接结果。看起来我们真的需要处理客户端连接超时。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-11-20T15:47:19.300

我们认为我们在仔细阅读 Redis 文档并发现这种美（[http://redis.io/topics/persistence](http://redis.io/topics/persistence)）后找到了根本原因：

```
RDB needs to fork() often in order to persist on disk using a child process.
Fork() can be time consuming if the dataset is big, and may result in Redis
to stop serving clients for some millisecond or even for one second if the
dataset is very big and the CPU performance not great. AOF also needs to fork()
but you can tune how often you want to rewrite your logs without any trade-off
on durability. 
```

我们关闭了 RDB 持久性，从那以后就没有看到这些连接断开。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-01T15:12:56.703

似乎将服务器超时设置为 300 从 0 缓解了连接失败的问题。仍然看到一些错误的连接，但这可能是因为 PooledRedisClientManager 没有正确检查从 GetClient() 调用的 GetInActiveWriteClient () 的连接状态。

# objective-c - 有没有办法使用 AppleScript 在不访问“系统事件”的情况下单击 osx 菜单项？

> ID：13128364
> 
> 赞同：0
> 
> 时间：2012-10-29T19:32:46.630
> 
> 标签：objective-c, cocoa, applescript, appstore-sandbox, applescript-objc

我使用这样的代码自动执行一些菜单点击，而不是每次都自己执行：

```
tell application "System Events" to tell process "myApp"
   click something and so on
end tell 
```

现在，为了在 osx lion 沙箱中进行这项工作，我的权利文件如下所示（为了弄清楚这一点做了很多研究）：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
    <dict>
        <key>com.apple.security.app-sandbox</key>
        <true/>
        <key>com.apple.security.temporary-exception.apple-events</key>
        <array>
            <string>com.apple.systemevents</string>
            <string>com.apple.iphonesimulator</string>
        </array>
    </dict>
</plist> 
```

现在，正如上帝所愿，苹果拒绝了这个应用程序，因为我正在访问`com.apple.systemevents`. 有没有办法解决使用`System Events`单击指定应用程序菜单中的指定菜单项的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T19:40:09.050

不可以。将 UI 事件发送到另一个进程*本质上*违反了应用程序沙盒。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-13T12:34:23.210

我知道已经有一段时间了，我刚刚发现了你的问题。

对于它的价值，您可能需要查看 MouseTools 和 Click 实用程序： [http ://www.hamsoftengineering.com/codeSharing/MouseTools/MouseTools.html](http://www.hamsoftengineering.com/codeSharing/MouseTools/MouseTools.html)

[http://hints.macworld.com/article.php?story=2008051406323031](http://hints.macworld.com/article.php?story=2008051406323031)

Objective-C 代码随它一起提供。我已经成功地在我的应用程序中使用它来单击没有 AppleScript 的屏幕的其他部分。

另一种方法是使用 JavaScript 进行 UI 自动化。在 Apple 开发者网站上查找这些关键字。我很想发布链接，但不可能因为论坛限制:(

在这两种情况下，您都必须为您的应用程序添加一个临时权利，以便点击在沙盒中工作。

# sql-server - 更新程序

> ID：13128365
> 
> 赞同：1
> 
> 时间：2012-10-29T19:32:49.093
> 
> 标签：sql-server

我正在处理 SQL Server 中的一个过程：

我是 SQL Server 的新手，我收到此错误：

> 必须声明标量变量“@Course_Name”

我的程序是：

```
USE [Hyaline management System]
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE PROCEDURE [dbo].[GetUpdateCourseID] 
@CourseID int
AS
BEGIN

SET NOCOUNT ON;
Update Course SET
    Course_Name = @Course_Name,
    Course_Duration = @Course_Duration
where CourseID = @CourseID;

END 
```

有人可以指出我哪里出错了吗？和解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T19:35:33.707

看来，您缺少一些参数。由于您正在执行`UPDATE`and `Course_Name`，`Course_Duration`您可能需要将它们传递到存储过程中：

```
USE [Hyaline management System]
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE PROCEDURE [dbo].[GetUpdateCourseID] 
    @CourseID int,
    @Course_Name varchar(50),      -- change to the proper datatype
    @Course_Duration varchar(100)  -- change to the proper datatype
AS
BEGIN

SET NOCOUNT ON;

    UPDATE Course 
    SET Course_Name = @Course_Name,
        Course_Duration = @Course_Duration
    WHERE CourseID = @CourseID;

END 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T19:35:54.760

```
CREATE PROCEDURE [dbo].[GetUpdateCourseID] 
    @CourseID int,
    @Course_Name varchar(max),
    @Course_Duration int -- just a guess, minutes as an int?
AS
SET NOCOUNT ON;
Update Course
   SET Course_Name = @Course_Name,
       Course_Duration = @Course_Duration
 WHERE CourseID = @CourseID;
GO 
```

它说

> 必须声明缩放变量“@Course_Name”

因为你还没有声明。看起来您希望将该变量作为 SP 的输入，因此您需要将其添加到参数部分中，然后将其添加`"AS"`到正文部分。

*p/s - 请剪切并粘贴错误消息。此错误是可以理解的，但如果您提供正确，其他一些错误更容易在 Google 上搜索。这个应该说明**scalar** (a) 而不是**scaler**。*

# php - jQuery UI Autocomplete 不适用于 Source 中的外部文件

> ID：13128367
> 
> 赞同：0
> 
> 时间：2012-10-29T19:33:17.237
> 
> 标签：php, jquery, autocomplete

就是这样......我有这样的jQuery代码：

jQuery：

```
<script type="text/javascript">
$(document).ready(function() {
    $('#val').autocomplete({
        source: "search.php",
    });
});
</script> 
```

HTML：

```
<input class="searchInput" id="val" name="val" type="text" /> 
```

PHP（搜索.php）：

```
$con = mysql_connect("localhost","root","");
$db = mysql_select_db("x",$con);
$sql = mysql_query("SELECT * FROM opcionais WHERE Opcional LIKE 'Nokia%'");
$result = array();
while($linha = mysql_fetch_array($sql)){
    $result[] = $linha['Opcional'];
}
echo json_encode($result); 
```

但这是交易......当我打开我的 search.php 时，它会以 json 格式出现所有结果......然后，如果我尝试自动完成，他会加载所有结果......例如......

在 search.php 我收到：

[“诺基亚”、“诺基亚 Lumia”]

好的......在自动完成中，当我输入“LUMIA”时，小部件也会加载“诺基亚”。Buuutt .....如果我复制我在“search.php”中得到的结果并在jquery脚本中粘贴一个变量，自动完成就可以了。

任何人都知道为什么我的外部结果源不像我将结果与 jQuery 代码一起直接放在变量上那样工作？

在此先感谢并为我糟糕的英语感到抱歉:-)

**编辑：**

所以我放了更多图片来展示发生了什么......那样它不起作用，就像 SOURCE 不能接受“$（'#val'）.val（）”......

![我的jQuery](../Images/843c6ec905ecaf7620da0832be71d234.png) ![search.php 与 get 语句工作](../Images/5f555581286db244f351897eaa7eaeb7.png) ![search.php 代码](../Images/abb03a1c384e39737621aa11e1707957.png)

**解决了**

我自己解决了这个问题...

```
<script type="text/javascript">
$(document).ready(function(){
    $('#val').keyup(function(){
        var x = "search.php?ac=" + $('#val').val();
        $('#val').autocomplete({
            source: x,
            minLenght:5,
        });
    });
});
</script> 
```

感谢所有回复:-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T20:44:10.307

当您使用 javascript 变量时，自动完成（AC）自然会起作用。因为 AC 本身会从该变量（数组）中找到匹配的结果。另一方面，如果您调用`search.php`，AC 将把它返回的任何内容视为匹配结果，并且不会尝试进一步匹配。

我实际上认为您在 PHP 脚本中的查询有些错误，您需要对其进行调试。您正在输入`LUMIA`并且脚本正在返回 ['Nokia'] 等。这意味着它正在运行此查询

`SELECT * FROM opcionais WHERE Opcional LIKE 'Nokia%'`

而它应该运行

`SELECT * FROM opcionais WHERE Opcional LIKE 'LUMIA%'`

所以你去。

**编辑 ：**

看来您根本没有`LUMIA`通过 ajax 发送关键字。[检查文档](http://api.jqueryui.com/autocomplete/#option-source)。你需要做的是这样改变js：

```
$('#val').autocomplete({
    source: "search.php?keyword="+$('#val').val(),
}); 
```

在 php 中：

```
$sql = mysql_query("SELECT * FROM opcionais WHERE Opcional LIKE 'Nokia ".$_GET['keyword']."%'"); 
```

或者也许为了更好的结果：

```
$sql = mysql_query("SELECT * FROM opcionais WHERE Opcional LIKE '%".$_GET['keyword']."%'"); 
```

此外，我建议在您的查询中使用准备好的语句，这些`mysql`函数已经[过时](http://www.php.net/manual/en/mysqlinfo.api.choosing.php)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T19:52:57.897

返回的格式应该是这样的：

```
[
      {
            "label": "Nokia",
            "value": "1"
      },
      {
            "label": "Lumia",
            "value": "2"
      }
] 
```

当然有一些变化，可能是新版本的自动完成有一点不同的风格。但始终应该是一对标签和值。

`dataType: 'json'`您也可以向请求添加选项。

我认为返回那种 JSON 也可以：

```
{1:'Nokia',2:'Lumia'} 
```

# xcode - Post Json Restkit 无法为 HTTP 方法“POST”类型的对象找到可路由路径

> ID：13128370
> 
> 赞同：1
> 
> 时间：2012-10-29T19:33:45.987
> 
> 标签：xcode, json, post, restkit

我想向我的服务器发送一个简单的 Json 并通过我的 iPad 应用程序获得 Json 响应。我使用 Restkit 完成所有工作，但 Json 的 POST 有问题。这是我想要的简单 Json 请求：

```
{"id_partita":"2"} 
```

响应将是这样的：

```
[{"id":34,"id_dispositivo":"123","id_partita":2,"allenatore":0,"giocatore1":"AAA","giocatore2":"BBB",...}] 
```

这是我在 Xcode 中的代码：

```
-(void) post
{
    RKURL *baseURL = [RKURL URLWithBaseURLString:@"mysite"];
    RKObjectManager* objectManager = [RKObjectManager objectManagerWithBaseURL:baseURL];

    // Setup object mappings
    RKObjectMapping *formazioneMapping = [RKObjectMapping mappingForClass:[Formazione class]];

    [formazioneMapping mapKeyPath:@"id_formazione"
                                toAttribute:@"id_formazione"];
    [formazioneMapping mapKeyPath:@"id_dispositivo"
                                toAttribute:@"id_dispositivo"];
    [formazioneMapping mapKeyPath:@"id_partita"
                                toAttribute:@"id_partita"];
    [formazioneMapping mapKeyPath:@"formazione"
                                toAttribute:@"formazione"];
    [formazioneMapping mapKeyPath:@"giocatore1"
                                toAttribute:@"giocatore1"];
    [formazioneMapping mapKeyPath:@"giocatore2"
                                toAttribute:@"giocatore2"];
;

    // Register our mappings with the provider
    [objectManager.mappingProvider setMapping:formazioneMapping forKeyPath:@""];

    [objectManager.router routeClass:[Formazione class]
                      toResourcePath:@"/formazione/index.php"
                           forMethod:RKRequestMethodPOST];

    // Set serialization MIME type.
    [RKObjectManager sharedManager].serializationMIMEType = RKMIMETypeFormURLEncoded;

    // Configure a serialization mapping for our Formazione class. We want to send id_partita
    RKObjectMapping *formazionePOSTSerializationMapping = [RKObjectMapping
                                                      mappingForClass:[Formazione class]];
    [formazionePOSTSerializationMapping mapAttributes:@"id_partita", nil];

    // Now register the mapping with the provider
    [[RKObjectManager sharedManager].mappingProvider setSerializationMapping:formazionePOSTSerializationMapping forClass: [Formazione class]];

    FormazionePOST *formazionePOST = [[FormazionePOST alloc] init];
    formazionePOST.id_partita = @"2";
    [[RKObjectManager sharedManager] postObject:formazionePOST delegate:self];

} 
```

但是当我尝试执行它时出现此错误：'无法为 HTTP 方法'POST'的'FormazionePOST'类型的对象找到可路由路径'。

我不明白我的错误是什么，我找不到 POST 和 GET a Json 的简单示例。谢谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T17:28:48.437

是不是在您的路由器初始化中您引用了 Formazione 类，但您正在尝试发布 FormazionePost 类？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-21T10:28:08.040

我已经使用 AfNetworking 而不是 RestKit 解决了我的问题。他们的文档中有很多关于 JSON 管理的示例。

# r - opencpu服务器，如何实现OAuth2接口？

> ID：13128375
> 
> 赞同：0
> 
> 时间：2012-10-29T19:34:10.400
> 
> 标签：r, github, oauth-2.0, opencpu

我已经安装了 OpenCPU 服务器并试图让用户创建自己的登录名，但我不断收到以下错误消息：

```
GET /auth/login
Github secret file not found. 
```

关于我做错了什么的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T21:27:07.717

`auth/login`端点与（实验性）github 身份验证有关。为此，您需要在系统上创建一个名为`/etc/opencpu/secret.conf`包含 github 'secret' 的文件，这是一种私钥。该`secret.conf`文件的格式必须如下：

```
{
  "secret": "1515ab906aa1c8250e99410fb204a8d3fd16a738"
} 
```

有关 github 身份验证和注册域以获取机密的更多信息，请参阅[http://developer.github.com/v3/oauth/](http://developer.github.com/v3/oauth/)。

附带说明：如果您托管自己的服务器，则以 root 身份 ssh-in 并安装您想在标准 lcoations 中使用的 R 包可能更容易。然后这些包将在`/R/pub`例如[http://public.opencpu.org/R/pub](http://public.opencpu.org/R/pub)下可用。

# google-chrome - Chrome -webkit-object-fit 不起作用

> ID：13128377
> 
> 赞同：3
> 
> 时间：2012-10-29T19:34:22.680
> 
> 标签：google-chrome, css

在 Chrome 中使用`-webkit-object-fit`样式表会生成“未知属性名称”。

只是不支持吗？`-webkit-border-image`作品。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-30T07:10:09.710

[http://caniuse.com/object-fit](http://caniuse.com/object-fit)

**2016 年 2 月 15 日更新**

现在，除 Internet Explorer 和 Edge 之外的所有主要浏览器都支持不带前缀的扩展（尽管它在 Edge 中被[标记为处于考虑](https://dev.windows.com/en-us/microsoft-edge/platform/status/objectfitandobjectposition/)中，具有中等优先级，因此将来很可能会支持它）。

**原始（过时）答案**

> 这个特定的扩展似乎是一个 Opera 支持的项目，因为它没有获得任何其他浏览器的支持。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-21T08:40:31.243

当前没有支持 object-fit 属性的活动的基于 webkit 的浏览器。这个属性已经存在了很长一段时间，并且该规范达到了候选推荐，因为它是在 Opera Presto (<= 12) 浏览器和 HP TouchPad (WebOS 3.0) 中实现的。但是，这两个都已过时，因此该属性也出现在[CSS Images Level 4](http://dev.w3.org/csswg/css-images-4/#the-object-fit)规范中

它已被添加到 Chrome 32 中，但由于它使用 Blink，因此该属性没有前缀，因此无需使用 -webkit- 前缀。

如果你正在寻找一个 polyfill，我已经制作了一个基于 jQuery 的，你可以在[http://www.steveworkman.com/html5-2/javascript/2012/css3-object-fit-polyfill/](http://www.steveworkman.com/html5-2/javascript/2012/css3-object-fit-polyfill/)

# grails - 如何从另一个 grails 插件配置 grails 插件

> ID：13128381
> 
> 赞同：4
> 
> 时间：2012-10-29T19:34:54.800
> 
> 标签：grails, groovy, spring-security, grails-plugin

我正在尝试编写一个可以在多个 grails 应用程序中重用的插件。该插件基本上应该是[spring 安全核心](http://grails.org/plugin/spring-security-core)和 ldap 插件的包装器。

这意味着它应该包含：

*   用户/角色的域类
*   spring security的配置（这些域类的映射，一些默认的URL访问角色配置）

我的问题是我无法让我的插件中的配置正常工作。我对到目前为止找到的示例感到困惑：有时我读到配置应该简单地转到“Config.groovy”，但是[grails 文档](http://grails.org/doc/latest/guide/plugins.html#creatingAndInstallingPlugins)指出该文件最终不是插件的一部分。在某些示例中，它说您必须将配置放在任何其他 .groovy 文件中，并用一些标识符将其包装起来，如下所示：

```
myConfigName {
    // normal config here
} 
```

然后`doWithSpring`通过一些 slurper 将其加载到 MyWrapperPlugin.groovy 类的闭包中。但是，如果我理解正确，这只会将配置放在`grails.plugin.mywrapper`命名空间中。

到目前为止，我找不到任何尝试实现相同目标的示例（在另一个插件中设置插件的配置）。

感谢任何示例/提示，谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-29T20:55:18.693

您可以使用[Grails Platform Core](http://grails.org/plugin/platform-core)

> 为插件提供功能，以实现彼此之间以及与应用程序的更大集成

[配置 API](http://grailsrocks.github.com/grails-platform-core/guide/configuration.html)正是您要寻找的。只需在插件描述符文件 (*GrailsPlugin.groovy) 中添加 doWithConfig：

```
def doWithConfig = { config ->
  application {
    grails.plugins.springsecurity.ldap.active=true
    ...
  }
} 
```

# c - ANSI C - 二维数组

> ID：13128389
> 
> 赞同：0
> 
> 时间：2012-10-29T19:35:33.270
> 
> 标签：c, arrays, ansi

我正在尝试使用循环将浮点值分配给二维数组`for`。这已被宣布为`float num[4][7];`

到目前为止，这是我的代码：

```
float num[4][7];
int x;
for(x=0;x<=3;x++) {
    printf("Enter number: %d",x);
    scanf("%f",cad[x][x]);
}
return 0; 
```

但似乎它不能正常工作，它没有按照我之前解释的那样做..

任何帮助将不胜感激，谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-29T19:37:04.110

```
scanf("%f",cad[x][x]); 
```

改用：

```
scanf("%f", &cad[x][x]); 
```

`%f`转换规范 in的参数`scanf`必须是指向`float`. 您正在使用 type 的参数`float`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T20:08:40.763

三个问题，首先，如前所述，在使用[scanf()](http://www.cplusplus.com/reference/clibrary/cstdio/scanf/)时，您需要给它一个指向它要更新的内容的指针：

```
 //    v-----added that
    scanf("%f",&cad[x][x]); 
```

其次，您初始化了一个名为“num”的数组，但填充了一个名为“cad”的数组。因此，更改其中之一，名称必须匹配。

最后，您的循环将仅填充 28 个元素中的 4 个：

```
//This
float num[4][7];
for(x=0;x<=3;x++) {
  scanf("%f",&num[x][x]);

//Will give you:
[%f][  ][  ][  ]
[  ][%f][  ][  ]
[  ][  ][%f][  ]
[  ][  ][  ][%f]
[  ][  ][  ][  ]
[  ][  ][  ][  ]
[  ][  ][  ][  ] 
```

显然，在该示例中，`%f`'s 被您输入的任何内容替换。要填充整个数组，您需要有两个 for 循环，`x<=3`（用于列）和`y<=6`（用于行）

```
float num[4][7];
int x;
int y;
for(x=0;x<=3;x++) {
    for(y=0; y<=6; y++) {
        printf("Enter number: [%d][%d]",x,y);
        scanf("%f",num[x][y]);
    }
} 
```

# java - 查看 Java 中的所有超类

> ID：13128398
> 
> 赞同：4
> 
> 时间：2012-10-29T19:36:21.413
> 
> 标签：java, plugins, ide, eclipse-plugin, superclass

假设你有一个 A 类，一个 B 类扩展 A，一个 C 类扩展 B。

是否有任何想法的IDE或任何类型的插件，在文件C.Java中，在线

```
Class C extends B 
```

我可以看到类似 ( 和 Class A ) 的东西，例如工具提示或行下的评论？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-29T19:38:04.910

在 Eclipse 中，您可以将插入符号放在类型名称上，按 F4 以查看类型层次结构。这将显示从`Object`指定类型名称到该名称的所有子类型的类型路径。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T19:44:24.663

您可以使用`Ctrl-T`查看快速的类层次结构弹出窗口。当它打开时，`Ctrl-T`再次点击会显示一个颠倒的类层次结构。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T19:45:35.280

在 IntelliJ IDEA 中点击`Ctrl`+`H`打开*类层次结构*弹出窗口。另一个有用的快捷方式是`Ctrl`++ ，`Alt`它将`U`显示相关类的 UML 图。

# htmlunit - WebDriver 和 HtmlUnit 的区别

> ID：13128400
> 
> 赞同：1
> 
> 时间：2012-10-29T19:36:30.363
> 
> 标签：htmlunit

我对 htmlUnit 驱动程序有点怀疑。在执行 htmlUnit 测试时是否需要安装任何 Web 浏览器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T19:40:38.210

不，HtmlUnit**是**一个网络浏览器。与传统浏览器的不同之处在于它没有 GUI（它是一个*无头*Web 浏览器），并且由您的 Java 代码而不是您的鼠标点击驱动。

# c++ - 无法检测 FMOD 中的音量

> ID：13128401
> 
> 赞同：0
> 
> 时间：2012-10-29T19:36:31.737
> 
> 标签：c++, audio, detection, volume, fmod

我正在尝试使用 Fmod 获取麦克风输入的音量，但 getVolume 始终返回 0。是的，我已经测试过了，我的麦克风工作正常。

这在一个循环中运行：

```
float tempvolume = 0.0f;
result = channel->getVolume(&tempvolume);
ERRCHECK(result);

//Set the sound volume
channel->getVolume(&tempvolume);
if (tempvolume < 0.1f){
    do something
}else{
    do something else
} 
```

但就像我说的，tempvolume 总是等于 0.0

我能做些什么？

编辑：我现在意识到“getVolume”仅返回您为频道设置的音量。所以现在整个问题变成了“如何检测麦克风的音量？”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T11:33:10.773

FMOD 不提供麦克风的硬件或操作系统音量级别的任何视图。

如果要测量当前录音信号的音量考虑 System::recordStart，播放返回的 FMOD::Sound 然后调用 Channel::getWaveData。您可以根据需要以您喜欢的方式处理波形数据以查找峰值或 RMS。

# jquery - jQuery 匹配：如何选择在其开始标记中有正斜杠的内容块？

> ID：13128406
> 
> 赞同：0
> 
> 时间：2012-10-29T19:36:51.750
> 
> 标签：jquery, regex, handlebars.js

使用 handlebars.js，我正在尝试使用 jQuery 来选择所有在其开始标记中具有正斜杠的内容循环。例如，我的 HTML 中有这些循环：

```
{{#each /stackoverflow-string-a}}
  contentA
{{/each}}

<h3>More content</h3>
{{#each /stackoverflow-string-b}}
  contentB
{{/each}} 
```

我想使用 jQuery 选择器来选择所有循环中的内容，其中包含正斜杠，如下所示：

```
var content_from_all_loops_with_a_forward_slash = ???????;
$(content_from_all_loops_with_a_forward_slash);

=> ["contentA", "contentB"] 
```

我应该使用什么正则表达式匹配字符串？也就是说，我应该如何定义“content_from_all_loops_with_a_forward_slash”来检索'[“contentA”，“contentB”]'？

# javascript - Fancybox 和 JW Player - 在 IE 和 FF 中停止视频

> ID：13128408
> 
> 赞同：0
> 
> 时间：2012-10-29T19:37:01.873
> 
> 标签：javascript, jquery, fancybox, jwplayer

我将 JW Player 嵌入到 Fancybox 框架中。如果框架关闭，我想要发生的是视频停止播放/加载。该代码以及我尝试过的所有其他内容都可以在 Chrome 中运行，但不能在 IE 和 FF 中运行。

我目前拥有的：

```
$('.lightbox').fancybox({
    //href: jThis.attr('href'),
    type: 'inline',
    padding: 15,
    width: 960,
    height: 540,
    autoSize: false,
    scrolling: 'no',
    enableEscapeButton: true,
    afterClose: function() {$("#large-video").empty();} //This is what I've tried changing
}); 
```

最重要的是，我也尝试过只做“jwplayer().stop()”和“function() {jwplayer().stop()};。两者在 Chrome 中都可以正常工作，但视频在 IE9 中继续播放和FF。在这里相当不知所措。以前有人这样做过吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T19:42:36.727

我有一个类似的问题。解决方法是停止 JWPlayer，然后停止`empty()`包含`remove()`它的 DOM 元素。如：

```
jwplayer().stop();
$("#container").empty().remove(); 
```

`#container`包含播放器的 div在哪里。如果要再次播放视频，则必须在 DOM 中重新实例化播放器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-28T09:52:30.143

您需要在拆解代码中使用 jwplayer 方法 .remove() 。仅仅删除灯箱元素是不够的。

**取自 JWPlayer api 文档。**

> **.remove()**与 setup() 调用相反，此调用将从页面中删除 JW 播放器。它确保播放器停止播放，将 DOM 重新设置为其原始状态，并清除所有事件侦听器和计时器。如果设置了其他播放器，则需要重新实例化任何侦听器。

[http://support.jwplayer.com/customer/portal/articles/1413089-javascript-api-reference#remove](http://support.jwplayer.com/customer/portal/articles/1413089-javascript-api-reference#remove)

这也将解决一个相关问题（这是我遇到的问题），即位于灯箱中的玩家在第二次尝试启动它时无法加载。

注意：这种情况下的错误将是：

回调“就绪”的事件处理程序时出错。错误：无法读取 null jwpsrv.js:1 的属性“clientWidth”未捕获类型错误：无法读取 null 的属性“ownerDocument”。

# html - 为什么我的 HTML 页面仍然被浏览器缓存？

> ID：13128413
> 
> 赞同：1
> 
> 时间：2012-10-29T19:37:18.587
> 
> 标签：html, caching

我有一个基本的 HTML 页面，没有动态内容。偶尔手动完成更新。但是，我收到报告称人们正在查看该页面的旧版本。我以为我在页面`<head>`上的 html 文档部分下设置了所有“无缓存”标题。

```
 <meta http-equiv="CACHE-CONTROL" content="NO-CACHE" />
  <meta http-equiv="EXPIRES" content="0" />
  <META HTTP-EQUIV="PRAGMA" CONTENT="NO-CACHE"> 
```

知道我还能做些什么来强制客户端刷新吗？该站点由 apache 提供服务。

**更新**因此，事实证明这实际上只是用户错误。遇到这些问题的人正在 a.domain.com 上寻找更新，但指示我在 b.domain.com 上进行更改。因此，他们只是看错了地方。虽然我确实学到了一些关于缓存的东西，同时试图找出问题所在！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T19:43:06.913

它可能是缓存内容的代理。试图阻止 HTML 标头中的缓存可能不会阻止所有缓存。使用 HTTP 标头过期应该会有所帮助。

您可以使用 mod_expires 和 mod_headers 禁用缓存...

[http://www.electrictoolbox.com/apache-mod-expires-browser-caching/](http://www.electrictoolbox.com/apache-mod-expires-browser-caching/)

[http://www.helicontech.com/ape/doc/mod_headers.htm](http://www.helicontech.com/ape/doc/mod_headers.htm)

[http://drupal.org/node/32109](http://drupal.org/node/32109)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T19:41:10.210

用户的浏览器可能有它自己的缓存设置。同样，发送您的 HTML 文件的服务器可能正在添加它自己的缓存控制标头等。在静态缓存方面，有许多层和事物可以相互交互或覆盖。

# mysql - 多列相同数据模式的数据库设计

> ID：13128416
> 
> 赞同：1
> 
> 时间：2012-10-29T19:37:30.220
> 
> 标签：mysql, database-design

如果我错误地使用了“数据模式”，我深表歉意。这里有一些背景。我正在将 Access 数据库移植到基于 Web 的 MYSQL 应用程序。这是我们正在跟踪的内容。

我们有一台最多有 16 个磁头的机器。每个头都有三个与之关联的项目，两个是整数，一个是短文本字符串。每个生产订单至少使用一个头。有些使用全部 16 个，有些只使用 1 个。如果使用了多个磁头，我们会跟踪它们的使用顺序。每个生产订单都有一些短到中等长度的字段，此外还存储了这些字段。绝大多数生产运行使用给定磁头的不到一半。

目前，数据位于一个将所有内容存储在一个表中的 Access 数据库中，因此每行存储 6 + (16*3) 48 个字段，总共 54 列。唯一搜索的字段是后两个字段，它们是整数。

`id|workorder|partnumber|note|machine|reference|head1spec1|head1spec2|head1spec3|head2spec1|head2spec2|head2spec3|`...等到16号头

我知道那里有很多死空间，因为每一行包含 16 个元素，可以将它们分解成一个单独的表格并连接起来以显示结果。它已经获取数据大约 10 年了，现在 Access DB 的文件大小为 60.8 MB

这是我的问题。在这种情况下，规范化（可能不正确的使用）是否有任何现实世界的优势，因为没有任何数据用于搜索，并且将所有数据放在一列中是该信息的一种自然状态？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T19:52:42.047

是的，有现实世界的优势，但我认为它们不足以保证修改现有的 Access 架构。相反，如果可能的话，我会将精力放在迁移到更好的平台上，例如，基于 Web 的带有 SQL Server 后端的平台。在进行迁移时，您可以担心架构。

规范化的模式将有助于解决以下问题：

*   数据完整性：确保相同的头部或头部规格不会在同一台机器上使用两次（当然，除非那是有效的......）
*   查询：轻松统计最常用的headspec是什么

你可以用你现在拥有的模式来做这些事情，只是需要多做一点工作。但是，这个模式已经工作了 10 年，那么改变的商业案例是什么？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T22:10:12.610

> 我知道那里有很多死角，...

并不真地。我不知道 Access 是如何做到的，但大多数数据库在存储 NULL 方面相当有效（通常是一个字节，但可能低至一位，就像[MS SQL Server](https://stackoverflow.com/a/3731195/533120)的情况一样）。

> ...因为每行包含 16 个元素，这些元素可以分解为单独的表格并连接以显示结果。它已经获取数据大约 10 年了，现在 Access DB 的文件大小为 60.8 MB

您没有说这 10 年累积了多少行，但 60.8 MB 在数据库方面是微不足道的，即使对于 Access 这样的“轻型”数据库也是如此。

空间不是你的问题，因为整个数据库很容易适应今天的硬件（甚至是 10 年前的硬件）的内存，速度也可能不是你的问题。

> 这是我的问题。在这种情况下，规范化（可能不正确的使用）是否有任何现实世界的优势，因为这些数据都没有用于搜索，并且将它们全部放在一列中是该信息的一种自然状态？

如果您需要支持具有不同数量的磁头的不同机器，则优势（拆分为参与 1:N 关系的两个表）将具有更好的灵活性。*此外，编写在所有头部*搜索、求和或平均数据的查询可能更简单。

缺点是需要更多空间（因为子表需要存储父表中的 PK 值的副本）并且需要更多的 JOINing。

总而言之，您现有的设计对我来说看起来不错。有没有您在您的问题中没有提到您要解决的具体问题？

# asp.net - asp.net Grid 最佳绑定方法

> ID：13128418
> 
> 赞同：1
> 
> 时间：2012-10-29T19:37:38.923
> 
> 标签：asp.net, datagrid

我正在使用以下代码绑定到 ASP.NET DataGrid。我有以下内容，它可以工作，但想知道这是否是最好的方法。我关心的几件事是我不需要打开连接，也没有使用 DataReader。请注意，这是在我的页面后面的代码中编写的。

```
 string strConn =  ConfigurationManager.ConnectionStrings["SQL1"].ConnectionString; 
             SqlDataSource DataSource1 = new SqlDataSource();  
             DataSource1.ConnectionString = strConn;
             DataSource1.SelectCommand = "SELECT * FROM tblTruck where LocId = @LocID ";     

             DataSource1.SelectParameters.Add(new Parameter("LocId", System.TypeCode.String, value));                 
             Grid1.DataSource = DataSource1.Select(DataSourceSelectArguments.Empty); 
             Grid1.Rebind(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T19:50:09.973

在这种情况下，DataSource 控件处理建立连接、读取连接和解析返回的内部逻辑。这本身非常方便，但如果您需要更多控制，则会导致问题。

从风格上讲，在 UI 中硬编码 SQL 代码从来都不是一个好主意，尽管使用参数而不是连接是好的。

总体而言，没有“最佳方法”。根据维护/更改、代码漏洞、性能、可靠性、显示复杂性等因素，您的解决方案应针对您的问题量身定制。

我个人不喜欢数据源控件，但是当您不想花费大量时间配置网格时，它们对网格工作很有用。

SQLCommands 非常快速且最佳，但是您必须编写维护大量代码才能使用它们，而且它可能有些脆弱。

DataAdapters/DataReaders/DataTables/DataSets 比 SQLCommands 更容易编写维护，但它们在内存中可能很麻烦，并且经常无法正确处理。

Linq/ENF 都使编写和维护变得容易，但有时它们会让您使用自己生成的 sql 而不是您自己的 sql 来调试问题，并且通常执行速度较慢（通常是一个不小的数量）。

希望这有助于回答您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T20:10:20.967

我认为您最好尝试改进您的代码以使用 linq 和其他类型的编程，如实体框架工作等。因为它们使您的项目更快、更可靠。它会导致编码减少。

# javascript - 直接在 jQuery 幻灯片中定位图像

> ID：13128419
> 
> 赞同：0
> 
> 时间：2012-10-29T19:37:39.650
> 
> 标签：javascript, jquery, css, slideshow

我喜欢这个脚本的工作方式： http: [//demo.marcofolio.net/bgimg_slideshow/](http://demo.marcofolio.net/bgimg_slideshow/)

但是，我想知道，**有没有办法直接定位幻灯片中的每个图像？**

因此，我可以单击一个显示“图像 3”的超链接，它会加载某个图像 - 而不是使用当前的导航按钮。

这是脚本本身：[http](http://demo.marcofolio.net/bgimg_slideshow/js/script.js) ://demo.marcofolio.net/bgimg_slideshow/js/script.js ，但我只需要知道如何在我的 HTML 中直接定位每个图像。

谁能帮我这个？

非常感谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T19:53:50.657

每个图像不会同时加载到幻灯片中 - 相反，有一个元素显示每个图像，并且幻灯片通过更改图像的源来工作。

但是，如果您只想创建一个链接以自动加载某个图像，您应该能够解决此问题。图像数据存储在名为“photos”的数组中，因此您应该能够创建一个按钮来触发给定照片的加载。该脚本使用“导航”功能来回前进，因此您需要做的是修改它以允许加载任意照片。

像这样的东西

```
var navigate_to = function(image_number) {
  if(animating) {    
    return;    
  }  
  currentImg = image_number;

  var currentContainer = activeContainer;
  if(activeContainer == 1) {
    activeContainer = 2;
  } else {
    activeContainer = 1;
  }
  showImage(photos[currentImg - 1], currentContainer, activeContainer);
}; 
```

应该可以，但我还没有测试过——你可能需要稍微按摩一下索引才能让它完美地工作。然后，您需要做的就是创建一个链接，该链接将使用它指向的索引调用此函数。

要更具体地说明最后一点，您可以创建一个像这样的元素 -

```
<div class="navigator">1</div> 
```

然后添加此代码 -

```
$(".navigator").on("click", function () {
  navigate_to(parseInt($(this).html(), 10));
}); 
```

无需专门创建超链接，因为这是页面内导航。这将做的是，如果单击具有类“navigator”的元素，则元素中的值将被发送到“navigate_to”。只要您将整数放在导航元素中，这应该可以很好地工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T19:44:51.980

您应该能够使用 showImage() 函数更改图像。

```
showImage(photoObject, currentContainer, activeContainer) 
```

# ruby-on-rails-3 - delay_job 随机消失的作业而不执行它们

> ID：13128425
> 
> 赞同：2
> 
> 时间：2012-10-29T19:38:14.103
> 
> 标签：ruby-on-rails-3, delayed-job

Rails 3.2.8、delayed_job (3.0.3)、delayed_job_active_record (0.3.3)。使用 WEBrick。

我有一个在启动时异步填充缓存的初始化程序：

```
MyModel.delay.get_lots_of_records
MyModel.delay.get_some_other_records
MyOtherModel.delay.get_tons_of_records
MyOtherModel.delay.get_some_other_records 
```

在开发环境中，这工作正常，delayed_job 日志和缓存日志证明了这一点。

然而，在分段中，有时会执行 1 个或 2 个，或者有时没有执行这些作业。通常至少执行一个，通常是相同的（但不总是）执行。如果我在启动后查看delayed_jobs 表，我会看到**所有4**个作业都被写入，然后在2 秒后消失。

根据[这里](https://github.com/collectiveidea/delayed_job/wiki/Common-problems#wiki-jobs_are_silently_removed_from_the_database)的建议，我有

```
# config/initializers/delayed_job_config.rb
Delayed::Worker.destroy_failed_jobs = false 
```

但是这些作业仍然会很快被删除，而不会失败或执行。

如果我在 处插入断点`Delayed::PerformableMethod.perform`，我会看到只有在作业实际执行时才调用该方法，所以问题出在它的上游。不过，该`destroy`方法是在 之后调用的`perform`，所以我不确定发生了什么。

我正在寻找故障排除建议或其他诊断操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T17:50:52.180

不好意思：我有一个工作人员在另一个环境中运行，指向同一个数据库，该数据库与我的暂存环境同时运行作业。这种意想不到的后果是永远不要在环境之间共享数据库的一个很好的理由。

# android - 示例 Android 项目无法正常工作，原因是：调试证书已过期

> ID：13128426
> 
> 赞同：9
> 
> 时间：2012-10-29T19:38:14.417
> 
> 标签：android, linux, eclipse

> **可能重复：**
> [Eclipse Android 插件中的“调试证书已过期”错误](https://stackoverflow.com/questions/2194808/debug-certificate-expired-error-in-eclipse-android-plugins)

我正在尝试运行 android 附带的示例项目之一（我已经尝试了很多）。我在eclipse的`Problems`窗口中不断收到这个错误。

```
Error generating final archive: Debug Certificate expired on 10/24/12 7:27 AM com.example.android.mediafx.HelloEffects      Unknown Android Packaging Problem 
```

基本上我从`samples`目录中导入项目。然后我右键单击项目并选择

```
Run As --> android project 
```

问题的另一个症状是项目`red x`旁边有一个，但`red x`在任何子目录或文件中都没有。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-29T19:40:37.670

删除并重`~/.android/debug.keystore`试。ADT 应该生成新的调试密钥库，其中包含新证书。

# python - Python：从循环中返回值而不会中断

> ID：13128428
> 
> 赞同：4
> 
> 时间：2012-10-29T19:38:18.070
> 
> 标签：python, return, return-value, yield

G'day，我有一个按地点分组的个人列表。我想生成一个新变量，根据他们的位置为每个人提供一个数字。我希望我的数据看起来像：

```
place       individual
here        1
here        2
here        3
there       1
there       2
somewhere   1 
somewhere   2 
```

我写了这个：

```
 nest="ddd", "ddd", "fff", "fff", "fff", "fff", "qqq", "qqq"

    def individual(x):
        i = 0
        j = 1
        while i < len(x):
            if x[i] == x[i-1]:
                print(j+1)
                i = i + 1
                j = j + 1
            else:
                print(1)
                i = i + 1
                j = 1

    individual(nest) 
```

这会打印出我想要的值，但是，当我将 return 放在那里时，它会跳出循环并仅返回第一个值。我想知道如何返回这些值，以便可以将它们作为新列添加到我的数据中？

我读到了产量？但不确定是否合适。谢谢您的帮助！

干杯，亚当

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-29T19:39:27.697

替换`print(...)`为`yield ...`. 那么你将有一个生成器，它会给你一个可迭代的。然后，您可以通过迭代结果将其转换为其他适当的数据结构。例如，要从生成器构造一个列表，您可以这样做：

```
list(individual(nest))  #this is prefered 
```

在这种情况下，迭代是隐式的......

或（在这种情况下更迂回但可能提供更多信息）：

```
[ x for x in individual(nest) ]  #This is just for demonstration. 
```

# c++ - 为什么在我的测试程序中，从 char 缓冲区读取一个 int 时，`std::copy` 比 `memcpy` 慢 5 倍（！）？

> ID：13128430
> 
> 赞同：15
> 
> 时间：2012-10-29T19:38:28.243
> 
> 标签：c++, performance, x86-64, benchmarking, compiler-optimization

这是我发布此程序的[问题](https://stackoverflow.com/questions/13117211/why-is-memcpy-slower-than-a-reinterpret-cast-when-parsing-binary-data)的后续行动：

```
#include <algorithm>
#include <cstdlib>
#include <cstdio>
#include <cstring>
#include <ctime>
#include <iomanip>
#include <iostream>
#include <vector>
#include <chrono>

class Stopwatch
{
public:
    typedef std::chrono::high_resolution_clock Clock;

    //! Constructor starts the stopwatch
    Stopwatch() : mStart(Clock::now())
    {
    }

    //! Returns elapsed number of seconds in decimal form.
    double elapsed()
    {
        return 1.0 * (Clock::now() - mStart).count() / Clock::period::den;
    }

    Clock::time_point mStart;
};

struct test_cast
{
    int operator()(const char * data) const
    {
        return *((int*)data);
    }
};

struct test_memcpy
{
    int operator()(const char * data) const
    {
        int result;
        memcpy(&result, data, sizeof(result));
        return result;
    }
};

struct test_memmove
{
    int operator()(const char * data) const
    {
        int result;
        memmove(&result, data, sizeof(result));
        return result;
    }
};

struct test_std_copy
{
    int operator()(const char * data) const
    {
        int result;
        std::copy(data, data + sizeof(int), reinterpret_cast<char *>(&result));
        return result;
    }
};

enum
{
    iterations = 2000,
    container_size = 2000
};

//! Returns a list of integers in binary form.
std::vector<char> get_binary_data()
{
    std::vector<char> bytes(sizeof(int) * container_size);
    for (std::vector<int>::size_type i = 0; i != bytes.size(); i += sizeof(int))
    {
        memcpy(&bytes[i], &i, sizeof(i));
    }
    return bytes;
}

template<typename Function>
unsigned benchmark(const Function & function, unsigned & counter)
{
    std::vector<char> binary_data = get_binary_data();
    Stopwatch sw;
    for (unsigned iter = 0; iter != iterations; ++iter)
    {
        for (unsigned i = 0; i != binary_data.size(); i += 4)
        {
            const char * c = reinterpret_cast<const char*>(&binary_data[i]);
            counter += function(c);
        }
    }
    return unsigned(0.5 + 1000.0 * sw.elapsed());
}

int main()
{
    srand(time(0));
    unsigned counter = 0;

    std::cout << "cast:      " << benchmark(test_cast(),     counter) << " ms" << std::endl;
    std::cout << "memcpy:    " << benchmark(test_memcpy(),   counter) << " ms" << std::endl;
    std::cout << "memmove:   " << benchmark(test_memmove(),  counter) << " ms" << std::endl;
    std::cout << "std::copy: " << benchmark(test_std_copy(), counter) << " ms" << std::endl;
    std::cout << "(counter:  " << counter << ")" << std::endl << std::endl;

} 
```

我注意到由于某种原因，`std::copy`它的性能比 memcpy 差得多。在我使用 gcc 4.7 的 Mac 上，输出看起来像这样。

```
g++ -o test -std=c++0x -O0 -Wall -Werror -Wextra -pedantic-errors main.cpp
cast:      41 ms
memcpy:    46 ms
memmove:   53 ms
std::copy: 211 ms
(counter:  3838457856)

g++ -o test -std=c++0x -O1 -Wall -Werror -Wextra -pedantic-errors main.cpp
cast:      8 ms
memcpy:    7 ms
memmove:   8 ms
std::copy: 19 ms
(counter:  3838457856)

g++ -o test -std=c++0x -O2 -Wall -Werror -Wextra -pedantic-errors main.cpp
cast:      3 ms
memcpy:    2 ms
memmove:   3 ms
std::copy: 27 ms
(counter:  3838457856)

g++ -o test -std=c++0x -O3 -Wall -Werror -Wextra -pedantic-errors main.cpp
cast:      2 ms
memcpy:    2 ms
memmove:   3 ms
std::copy: 16 ms
(counter:  3838457856) 
```

如您所见，即使使用`-O3`它也比 memcpy 慢 5 倍（！）。

Linux 上的结果类似。

有谁知道为什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-29T23:41:43.577

我同意[@rici](https://stackoverflow.com/a/13129813/69998)关于开发更有意义的基准的评论，因此我将您的测试重写为使用`memcpy()`,`memmove()`和赋值运算符`std::copy()`对两个向量的复制进行基准测试：`std::vector`

```
#include <algorithm>
#include <iostream>
#include <vector>
#include <chrono>
#include <random>
#include <cstring>
#include <cassert>

typedef std::vector<int> vector_type;

void test_memcpy(vector_type & destv, vector_type const & srcv)
{
    vector_type::pointer       const dest = destv.data();
    vector_type::const_pointer const src  = srcv.data();

    std::memcpy(dest, src, srcv.size() * sizeof(vector_type::value_type));
}

void test_memmove(vector_type & destv, vector_type const & srcv)
{
    vector_type::pointer       const dest = destv.data();
    vector_type::const_pointer const src  = srcv.data();

    std::memmove(dest, src, srcv.size() * sizeof(vector_type::value_type));
}

void test_std_copy(vector_type & dest, vector_type const & src)
{
    std::copy(src.begin(), src.end(), dest.begin());
}

void test_assignment(vector_type & dest, vector_type const & src)
{
    dest = src;
}

auto
benchmark(std::function<void(vector_type &, vector_type const &)> copy_func)
    ->decltype(std::chrono::milliseconds().count())
{
    std::random_device rd;
    std::mt19937 generator(rd());
    std::uniform_int_distribution<vector_type::value_type> distribution;

    static vector_type::size_type const num_elems = 2000;

    vector_type dest(num_elems);
    vector_type src(num_elems);

    // Fill the source and destination vectors with random data.
    for (vector_type::size_type i = 0; i < num_elems; ++i) {
        src.push_back(distribution(generator));
        dest.push_back(distribution(generator));
    }

    static int const iterations = 50000;

    std::chrono::time_point<std::chrono::system_clock> start, end;

    start = std::chrono::system_clock::now();

    for (int i = 0; i != iterations; ++i)
        copy_func(dest, src);

    end = std::chrono::system_clock::now();

    assert(src == dest);

    return
        std::chrono::duration_cast<std::chrono::milliseconds>(
            end - start).count();
}

int main()
{
    std::cout
        << "memcpy:     " << benchmark(test_memcpy)     << " ms" << std::endl
        << "memmove:    " << benchmark(test_memmove)    << " ms" << std::endl
        << "std::copy:  " << benchmark(test_std_copy)   << " ms" << std::endl
        << "assignment: " << benchmark(test_assignment) << " ms" << std::endl
        << std::endl;
} 
```

*我只是为了好玩而使用 C++11 有点过火了。*

以下是我在使用 g++ 4.6.3 的 64 位 Ubuntu 机器上得到的结果：

```
$ g++ -O3 -std=c++0x foo.cpp ; ./a.out 
memcpy:     33 ms
memmove:    33 ms
std::copy:  33 ms
assignment: 34 ms 
```

结果都相当可比！当我在向量中更改整数类型时，我在所有测试用例中都得到了可比较的时间，*例如*to 。`long long`

除非我的基准重写被破坏，否则您自己的基准似乎没有进行有效的比较。！

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-10-29T21:16:18.980

在我看来，答案是 gcc 可以优化这些对 memmove 和 memcpy 的特定调用，但不能优化 std::copy。gcc 知道 memmove 和 memcpy 的语义，在这种情况下可以利用已知大小 (sizeof(int)) 的事实将调用转换为单个 mov 指令。

std::copy 是根据 memcpy 实现的，但显然 gcc 优化器无法弄清楚 data + sizeof(int) - data 恰好是 sizeof(int)。所以基准调用 memcpy。

我通过调用 gcc`-S`并快速浏览输出得到了所有这些；我很容易弄错了，但我看到的似乎与你的测量结果一致。

顺便说一句，我认为测试或多或少毫无意义。一个更合理的真实世界测试可能是创建一个实际`vector<int> src`的 和`int[N] dst`，然后与 进行`memcpy(dst, src.data(), sizeof(int)*src.size())`比较`std::copy(src.begin(), src.end(), &dst)`。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-29T19:41:46.563

`memcpy`并且`std::copy`每个都有它们的用途，`std::copy`应该（正如下面的 Cheers 所指出的）和 memmove 一样慢，因为不能保证内存区域会重叠。这意味着您可以非常轻松地复制非连续区域（因为它支持迭代器）（想想像链表等稀疏分配的结构......甚至是实现迭代器的自定义类/结构）。`memcpy`仅在连续的原因上工作，因此可以进行大量优化。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-10-29T20:16:46.787

那不是我得到的结果：

```
> g++ -O3 XX.cpp 
> ./a.out
cast:      5 ms
memcpy:    4 ms
std::copy: 3 ms
(counter:  1264720400)

Hardware: 2GHz Intel Core i7
Memory:   8G 1333 MHz DDR3
OS:       Max OS X 10.7.5
Compiler: i686-apple-darwin11-llvm-g++-4.2 (GCC) 4.2.1 
```

在 Linux 机器上，我得到不同的结果：

```
> g++ -std=c++0x -O3 XX.cpp 
> ./a.out 
cast:      3 ms
memcpy:    4 ms
std::copy: 21 ms
(counter:  731359744)

Hardware:  Intel(R) Xeon(R) CPU E5-2670 0 @ 2.60GHz
Memory:    61363780 kB
OS:        Linux ip-10-58-154-83 3.2.0-29-virtual #46-Ubuntu SMP
Compiler:  g++ (Ubuntu/Linaro 4.6.3-1ubuntu5) 4.6.3 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-11-10T03:10:19.807

根据[G++ 4.8.1](http://coliru.stacked-crooked.com/a/71297090164b6458)的汇编器输出，`test_memcpy`：

```
movl    (%r15), %r15d 
```

`test_std_copy`：

```
movl    $4, %edx
movq    %r15, %rsi
leaq    16(%rsp), %rdi
call    memcpy 
```

如您所见，`std::copy`成功识别出它可以使用 复制数据`memcpy`，但由于某种原因没有发生进一步的内联 - 这就是性能差异的原因。

顺便说一句，[Clang 3.4](http://coliru.stacked-crooked.com/a/fd3ca110789fa5ec)为这两种情况生成了相同的代码：

```
movl    (%r14,%rbx), %ebp 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-02-20T03:36:59.683

**编辑**：我把这个答案留作参考，gcc 的奇怪时间似乎是“代码对齐”的产物（见评论）

* * *

我正要说这是当时 gcc 4 中的一个实现故障，但它可能比这更复杂。我的结果是（计数器使用 20000/20000）：

```
$ g++ -Ofast a.cpp; ./a.out
cast:      24 ms
memcpy:    47 ms
memmove:   24 ms
std::copy: 24 ms
(counter:  1787289600)

$ g++ -O3 a.cpp; ./a.out
cast:      24 ms
memcpy:    24 ms
memmove:   24 ms
std::copy: 47 ms
(counter:  1787289600) 
```

```
$ g++ --version
g++ (Ubuntu 9.2.1-9ubuntu2) 9.2.1 20191008 
```

注意使用`copy`和`memcpy`编译时如何交换`-O3`结果`-Ofast`。`memmove`也不比两者都慢。

结果`clang`更简单：

```
$ clang++ -O3 a.cpp; ./a.out
cast:      26 ms
memcpy:    26 ms
memmove:   26 ms
std::copy: 26 ms
(counter:  1787289600)

$ clang++ -Ofast a.cpp; ./a.out
cast:      26 ms
memcpy:    26 ms
memmove:   26 ms
std::copy: 26 ms
(counter:  1787289600) 
```

```
$ clang++ --version
clang version 9.0.0-2 (tags/RELEASE_900/final) 
```

`perf`结果：[https ://pastebin.com/BZCZiAWQ](https://pastebin.com/BZCZiAWQ)

# c# - 在 C# 中加载自签名 P12 证书文件

> ID：13128436
> 
> 赞同：3
> 
> 时间：2012-10-29T19:39:10.987
> 
> 标签：c#, x509certificate

使用证书对我来说仍然是新事物。

我正在尝试加载一个 p12 证书文件（我认为它被称为自签名证书）以用于通道工厂。这是 VS2010 中的 C# 程序和 WFC 服务参考。以下是我尝试过的方法和收到的错误。最后一段代码是 VB.net 代码，运行无误。我认为这表明p12文件的路径和密码是正确的。

```
//Create the binding and channel
WSHttpBinding binding = new WSHttpBinding();
binding.Security.Mode = SecurityMode.Message;
binding.Security.Message.ClientCredentialType = MessageCredentialType.Certificate;
binding.Security.Message.NegotiateServiceCredential = false;
binding.Security.Message.EstablishSecurityContext = false;

EndpointAddress serviceAddress = new EndpointAddress("http://myendpoint");
ChannelFactory<ServiceName> channelFactory = null;

channelFactory = new ChannelFactory<ServiceName>(binding, serviceAddress);

//try to add the cert - Error: Object reference not set to an instance of the object. I've tried all available X509KeyStorageFlags
channelFactory.Credentials.ClientCertificate.Certificate.Import(@c:\path\to\file\fw.mycert.com.p12", "password", X509KeyStorageFlags.PersistKeySet);

//try to add the cert - Error: The specified network password is not correct. I've tried all available X509KeyStorageFlags
//rawCertificateData does contain 2000+ bytes
X509Certificate2 certificate = new X509Certificate2();
byte[] rawCertificateData = File.ReadAllBytes(@"c:\path\to\file\fw.mycert.com.p12");                
channelFactory.Credentials.ClientCertificate.Certificate.Import(rawCertificateData, "password", X509KeyStorageFlags.DefaultKeySet);

//This works in vb.net with the same path and password
Dim cert As New X509Certificate2("c:\path\to\file\fw.mycert.com.p12", "password")
request.ClientCertificates.Add(cert) 
```

# c++ - 在分配器重新绑定的情况下，使用 null_mutex 的 boost::fast_pool_allocator 是否安全？

> ID：13128439
> 
> 赞同：3
> 
> 时间：2012-10-29T19:39:37.187
> 
> 标签：c++, boost, allocator

我想知道使用 set 的安全`boost::fast_pool_allocator`性`null_mutex`。

我知道以下是一个不安全的实例。每个类型都实例化一个分配器。因此，如果您有两个都使用`fast_pool_allocator<int, …null_mutex>`（比如说）的容器，它们将共享相同的分配器实例，因此会引发数据竞争。

更令人担忧的是以下问题。分配器接口允许重新绑定。这意味着即使您认为您正在使用`fast_pool_allocator`不太可能与其他实例发生冲突的“本地”类型，容器也可以自由地将该分配器重新绑定到不同的类型，例如确实发生冲突的全局类型。

所以问题是： 安全性`boost::fast_pool_allocator`如何`null_mutex`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T20:38:30.120

我相信 pool_allocator 和 fast_pool_allocator 都是线程安全的，

来自： http: [//www.boost.org/libs/pool/doc/html/header/boost/pool/pool_alloc_hpp.html](http://www.boost.org/libs/pool/doc/html/header/boost/pool/pool_alloc_hpp.html)

> pool_allocator 和 pool_allocator 都将在同一个池中分配/取消分配。

fast_pool_allocator 也一样

> 如果在 main() 开始之前和 main() 结束之后只有一个线程在运行，那么两个分配器都是完全线程安全的。

但是，与其他减少分配开销的方法相比，它们的性能不是很好。我也一直在查看来自 google 的 tcmalloc，它创建每个线程堆以避免锁定。

> 此参数的默认值为 boost::details::pool::default_mutex ，它是 boost::details::pool::null_mutex 的同义词（当编译器中关闭线程支持时（因此未设置 BOOST_HAS_THREADS），或使用 BOOST_DISABLE_THREADS（Boost-wide 禁用线程）或 BOOST_POOL_NO_MT（仅限此库）或 boost::mutex（在编译器中启用线程支持时）显式禁用线程支持。

```
boost::mutex 
```

是为我设置的，这就是为什么在我的线程测试中我没有问题 - 我猜这也会为你正确设置。

**但如果不是，那么您可能会遇到问题，因为：**

> Since the size of T is used to determine the type of the underlying Pool, each allocator for different types of the same size will share the same underlying pool. The tag class prevents pools from being shared between pool_allocator and fast_pool_allocator. For example, on a system where sizeof(int) == sizeof(void *), pool_allocator and pool_allocator will both allocate/deallocate from/to the same pool.

# python - 字典理解：我们如何构建一个以整数为键、元组为值的字典？

> ID：13128440
> 
> 赞同：0
> 
> 时间：2012-10-29T19:39:38.223
> 
> 标签：python, list, dictionary, tuples

我有一个数据列表，它们的格式如下：（下面有更多行只是其中的一部分）

```
2   377222  TOYOTA MOTOR CORPORATION    TOYOTA  PASEO   1994    Y   19941226    N   0   0   PARKING BRAKE:CONVENTIONAL  SAN JOSE        CA  JT2EL45U5R0 19950103    19950103        1   PARKED ON FLAT SURFACE EMERGENCY BRAKING ENGAGED VEHICLE ROLLED REARWARD.  TT   EVOQ                                                                                                    V           
1   958164  TOYOTA MOTOR CORPORATION    TOYOTA  LAND CRUISER    1994        19941223    N   0   0   SERVICE BRAKES, HYDRAULIC:ANTILOCK  ARNOLD          CA  JT3DJ81W8R0 19950103    19950103            ABS SYSTEM FAILURE, AT 20MPH.  TT   EVOQ                                                                                                    V
46  958153  DAIMLERCHRYSLER CORPORATION DODGE   CARAVAN 1987        19940901    N   0   0   EQUIPMENT:MECHANICAL:CARRIER/RACK   CORBETT         OR  2B4FK4130HR 19950103    19950103        1   CABLE ATTACHMENT THAT SECURES THE SPARE TIRE BROKE WHILE DRIVING.  TT   EVOQ                                                                                                    V   
98  958178  GENERAL MOTORS CORP.    GMC SAFARI  1994        19941223    N   0   0   SERVICE BRAKES, HYDRAULIC:FOUNDATION COMPONENTS MILAN           MI  1GDDM19W4RB 19950103    19950103        1   BRAKES FAILED DUE TO BATTERY MALFUNCTIONING WHEN TOO MUCH POWER WAS DRAWN FROM BATTERY FOR RADIO.   TT  EVOQ                                                                                                    V 
```

使用 index(1) 整数作为键和句子中任何其他 2 个元素的元组作为值来创建字典的最佳方法是什么？所需的输出应该是这样的：

```
function(filename)[2]
('TOTOTA MOTOR CORPORATION','19941226','SAN JOSE','CA') 
```

这是我现在所拥有的，我试图先将它们全部放入字典中，但它不会遍历整个列表，而是只返回一行的元素。我的代码出了什么问题？或者我如何至少完成第一步 - 将它们全部放入字典中？

```
def function(filename):
    with open filename as FileObject:
        A=[]
        for lines in FileObject:
            B=[line.split("\t")[0]]
            A+=B
            C=[line.split("\t")[2]]
            A=A+B+C
            D=[line.split("\t")[12]]
            A=A+B+C+D
            E={A:(B,C,D)for A in A}
    return E
print function(filename) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T19:51:16.523

每次通过循环 ( ) 时，您都在创建一个新字典（而不是添加到其中`E={A:(B,C,D)for A in A}`）。在进入循环之前声明您的字典，并在每次通过循环时添加您的条目​​。

```
def create_database(f)
    """ Returns a populated dictionary.  Iterates over the input 'f'. """
    data = {}
    for line in f:
        # add stuff to data
        key, datum = parse_line(line)
        data[key] = datum
    return data 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T19:56:23.267

通过使用`csv`模块（可用于处理制表符分隔的文件）并可能`operator.itemgetter`作为便利功能。

```
with open('yourfile') as fin:
    tabin = csv.reader(fin, delimiter='\t')
    # change itemgetter to include the relevant column indices
    your_dict = {int(row[0]): itemgetter(2, 12)(row) for row in tabin}

print your_dict[2] 
```

# c++ - 未定义的架构符号，尝试过 i386 和其他 ,,,

> ID：13128442
> 
> 赞同：0
> 
> 时间：2012-10-29T19:39:48.627
> 
> 标签：c++, xcode, macos

只是想开始一些 C++ 并创建了这些简单的类：

椭球体.h

```
#ifndef __Ellipsoid__Ellipsoid__
#define __Ellipsoid__Ellipsoid__

#include <iostream>
#include <cassert>

class Ellipsoid {
private:
    double axisA;
    double flatteningF;

public:
    Ellipsoid() {};
   Ellipsoid(double aIn, double fIn);
    double getAxisA();
    double getFlatteningF();

};

#endif /* defined(__Ellipsoid__Ellipsoid__) */ 
```

椭球体.cpp

```
#include "Ellipsoid.h"

Ellipsoid::Ellipsoid (double aIn, double fIn) : axisA(aIn), flatteningF(fIn) {};

int main() {
    std::cout << "bla";
    Ellipsoid el = Ellipsoid(44.3, 32);
    double test = el.getAxisA();

    return 0;
} 
```

因为你在这里看不到什么特别的东西。我在 osx10.8 上使用 xcode。但是当我运行程序时，我遇到了这个错误：架构 x86_64 的未定义符号：“Ellipsoid::getAxisA()”，引用自：Ellipsoid.o ld 中的 _main：未找到架构 x86_64 的符号，我真的可以不知道出了什么问题。试图将架构设置为 32 位，但这也不起作用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T19:42:49.153

`Ellipsoid::getAxisA()`缺少函数的定义。你必须在某个地方定义。现在你只有一个声明，没有定义。定义可能如下所示：

```
double Ellipsoid::getAxisA() { return axisA; } 
```

并将住在 Ellipsoid.cpp 中。

# django - Django 测试在测试中存储的会话数据

> ID：13128443
> 
> 赞同：23
> 
> 时间：2012-10-29T19:39:52.220
> 
> 标签：django, django-testing

我有这样的看法：

```
def ProjectInfo(request):
    if request.method == 'POST':
        form = ProjectInfoForm(request.POST)
        if form.is_valid():
            # if form is valid, iterate cleaned form data
            # and save data to session
            for k, v in form.cleaned_data.iteritems():
                request.session[k] = v
            return HttpResponseRedirect('/next/')
        else:
            ...
    else:
        ... 
```

在我的测试中：

```
from django.test import TestCase, Client
from django.core.urlresolvers import reverse
from tool.models import Module, Model
from django.contrib.sessions.models import Session

def test_project_info_form_post_submission(self):
    """
    Test if project info form can be submitted via post.
    """
    # set up our POST data
    post_data = {
        'zipcode': '90210',
        'module': self.module1.name,
        'model': self.model1.name,
        'orientation': 1,
        'tilt': 1,
        'rails_direction': 1,
    }
    ...
    self.assertEqual(response.status_code, 302)
    # test if 'zipcode' in session is equal to posted value. 
```

所以，在我的测试中最后一条评论的地方，我想测试一个特定的值是否在`session`dict 中，并且 key:value 配对是否正确。我该怎么做？我可以使用`request.session`吗？

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-10-29T20:16:51.807

根据[文档](https://docs.djangoproject.com/en/dev/topics/testing/tools/#django.test.Client.session)：

```
from django.test import TestCase

class SimpleTest(TestCase):
    def test_details(self):
        # Issue a GET request.
        self.client.get('/customer/details/')
        session = self.client.session
        self.assertEqual(session["somekey"], "test") 
```

# forms - 如何显示自定义表单 Orchard CMS 批准的评论

> ID：13128444
> 
> 赞同：1
> 
> 时间：2012-10-29T19:39:58.363
> 
> 标签：forms, content-management-system, orchardcms

这是我的问题：如何在页面上显示我通过 Orchard CMS 从自定义表单收到的所有评论？

如果您不确定理解我的问题，这里有一个我想要的示例：

使用名为“Gestbook”的新内容类型创建留言簿。添加两个字段（名称和评论）。在表单选项卡上添加后，将评论添加到您网站的新留言簿页面中。之后，如何通过仪表板批准后向他们展示？

非常感谢，

大卫

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T01:08:09.007

单击管理员表单部分中表单右侧的“提交”以查看用户添加的内容。您还可以从规则模块触发其他操作。

# xunit - 如何修改我的自定义理论数据属性为 AutoFixture 创建的夹具？

> ID：13128446
> 
> 赞同：6
> 
> 时间：2012-10-29T19:40:03.453
> 
> 标签：xunit, autofixture

我真的很欣赏 AutoFixture 的强大功能以及 XUnit 的理论。我最近采用了[封装自定义](http://blog.ploeh.dk/2011/03/18/EncapsulatingAutoFixtureCustomizations.aspx)并通过属性将它们提供给我的测试的方法。

在某些情况下，我需要一个一次性的场景来运行我的测试。当我像上面一样使用 AutoDomainDataAttribute 时，我可以要求一个 IFixture 并期望获得由该属性创建的相同实例吗？

在我的场景中，默认情况下我对集合等使用 MultipleCustomization。但是，在这种情况下，我只希望将单个项目发送到我的 SUT 的构造函数。所以，我已经像这样定义了我的测试方法：

```
[Theory, AutoDomainData]
public void SomeTest(IFixture fixture) {
  fixture.RepeatCount = 1;
  var sut = fixture.CreateAnonymous<Product>();
  ...
} 
```

不幸的是，我在创建匿名产品时遇到了异常。如果我要求 Product 作为具有这些属性的方法参数，其他测试工作得很好。在这种特殊情况下，这只是一个问题，我希望fixture 参数与我的AutoDomainDataAttribute 创建的参数相同。

由于我通过 AutoDomainData 进行了就地自定义，产品的构造函数需要一个 IEnumerable，该 IEnumerable 通常会填充 3 个项目。目前，我的 DomainCustomization 是由 MultipleCustomization 和 AutMoqCustomization 按顺序组成的 CompositeCustomization。

例外是：“InvalidCastException：无法将 'Castle.Proxies.ObjectProxy' 类型的对象转换为 'Product' 类型。”

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-29T20:27:12.893

如果您需要与属性中的活动实例相同的 Fixture 实例，则可以在自定义中将 Fixture 注入自身，如下所示：

```
public class InjectFixtureIntoItself : ICustomization
{
    public void Customize(IFixture fixture)
    {
        fixture.Inject(fixture);
    }
} 
```

*请记住在 AutoMoqCustomization之前*将其添加到您的 CompositeCustomization中，因为 IFixture 是一个接口，如果 AutoMoqCustomization 先出现，您将获得一个 Mock 实例 - AFAICT，这就是动态 Castle 代理目前正在发生的事情。

* * *

然而，如果你*真的*需要一个 Fixture 实例，为什么不写一个常规的、命令式的测试方法：

```
[Fact]
public void SomeTest()
{
    var fixture = new Fixture().Customize(new DomainCustomization());
    fixture.RepeatCount = 1;
    var sut = fixture.CreateAnonymous<Product>();
    // ...
} 
```

在我看来这要容易得多......我自己也偶尔这样做......

* * *

不过，我想知道您是否不能以不同的方式来表达您的 API 或测试用例以使整个问题消失。这些天我*很少*发现我必须操纵`RepeatCount`财产，所以我想知道你为什么要这样做？

不过，这可能是另一个 Stack Overflow 问题的主题......

# facebook - facebook like 未发布到时间线/新提要/墙

> ID：13128449
> 
> 赞同：5
> 
> 时间：2012-10-29T19:40:12.087
> 
> 标签：facebook, facebook-like, facebook-opengraph

我在我的网站上遇到了一个奇怪的问题。我做了 facebook 开发者网站所说的完全相同的方式，但仍然遇到同样的问题。问题是当我点击我网站上的“喜欢”按钮时，弹出窗口和计数工作绝对正常，但故事没有在 Facebook 的时间线或新闻提要上发布。但是（听起来很奇怪）当我使用 linter 工具调试我的页面时，它没有显示任何警告，之后只有该页面的“like”按钮开始发布到用户的墙上，否则不会。我没有得到 linter 工具和 FB 发布政策之间的联系。任何人都可以帮我解决这个问题....解决这个问题需要太多时间:(

这些是我的元标签

```
<meta property="og:description" content="[DESCRIPTION]" />
<meta property="og:site_name" content="[SITE_ADDRESS]" />
<meta property="og:type" content="object" /> 
<meta property="og:url" content="[PAGE_WHERE_LIKE_BUTTON_IS LOCATED]" /> 
<meta property="og:title" content="[PAGE_TITLE]" /> 
<meta property="og:image" content="[IMAGE_URL]" /> 
<meta property="fb:app_id" content="[APP_ID]" />
<meta property="fb:admins" content="[ADMINS_ID]" /> 
```

我在 App Dashbord 的 opengraph 上使用“赞”作为动作和“对象”。

最奇怪的是使用调试工具后一切正常。问题是为什么？？

BR，邮件管理员

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T22:33:00.973

我遇到了同样的问题，我暂时解决了使用 ajax 调用直接从页面内部调用 facebook 调试工具的问题。这太可怕了，我知道。但如果你赶时间（像我一样），你可能想用它作为临时工作，直到你找到正确的方法

我的页面是[http://www.organirama.com/showserver/minisite.php](http://www.organirama.com/showserver/minisite.php)。解决方法是（需要jquery）。：

```
$(document).ready(function() {
    $.ajax({
        url : "http://developers.facebook.com/tools/debug/og/object?q=http%3A%2F%2Fwww.organirama.com%2Fshowserver%2Fminisite.php",
        success : function (a,b) {
        },
        error : function (a,b,c) {
        }
    });
}); 
```

# javascript - 拆分以获取分隔符之间的文本？

> ID：13128456
> 
> 赞同：0
> 
> 时间：2012-10-29T19:41:16.697
> 
> 标签：javascript, jquery

我正在发出跨域 AJAX 请求，因此，我无法将原始数组从 PHP 页面传递到我的 HTML 页面。相反，请求以字符串形式获取结果。我进行了设置，语法如下所示：

```
([SCHOOL] Name [/SCHOOL][STATUS] Status [/STATUS])
([SCHOOL] Other name [/SCHOOL][STATUS] Other status [/STATUS]) 
```

在我的 HTML 页面上，我希望能够从这些不同的值形成一个数组，其形式为：

```
Array (
    [0] =>
        [0] Name
        [1] Other
    [1] =>
        [0] Name 
        [1] Other status
) 
```

这样，我可以使用`for`循环来获取特定值。

唯一的问题是`split`它只会这样做，分裂事物。JS中有没有办法在分隔符中找到文本，并从中形成一个数组？再次在示例中，它将查找括号内的所有文本，并形成第一个数组，然后在该数组中，将文本之间的文本`[SCHOOL][/SCHOOL]`用于第一个对象，并将文本之间的文本`[STATUS][/STATUS]`用于第二个对象。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T19:44:58.300

理想情况下，您会使用更适合在服务器端存储数组的东西。我会推荐 JSON。使用 php 编码和使用 javascript 解码将是微不足道的。

如果您没有该选项服务器端，那么您可以使用正则表达式来解析您的文本。但是，您必须确保内容中没有您的分隔符。

目前尚不清楚如何从源中获取目标数据结构，但我希望这样的事情可能对您有用：

```
str = "([SCHOOL] Name [/SCHOOL][STATUS] Status [/STATUS])\n\
([SCHOOL] Other name [/SCHOOL][STATUS] Other status [/STATUS])"

arr  =[]
m = str.match(/\(.+?\)/g)
for(i in m){
    matches = m[i].match(/\(\[SCHOOL\](.+?)\[\/SCHOOL\]\[STATUS\](.+?)\[\/STATUS\]\)/)
    arr.push([matches[1],matches[2]])
}

console.dir(arr) 
```

# c++ - 使用 pthread_create 时出错

> ID：13128461
> 
> 赞同：1
> 
> 时间：2012-10-29T19:41:25.197
> 
> 标签：c++

> **可能重复：**
> [类中的 pthread 函数](https://stackoverflow.com/questions/1151582/pthread-function-from-a-class)

我对 c++ 相当陌生，我正在做一个关于 TCP 的项目。

我需要创建一个线程，所以我用谷歌搜索并找到了这个。 [http://www.yolinux.com/TUTORIALS/LinuxTutorialPosixThreads.html](http://www.yolinux.com/TUTORIALS/LinuxTutorialPosixThreads.html)

*我遵循它的语法但遇到错误：'void* (ns3::TcpSocketBase::)()' 类型的参数与'void* ( )(void* )'不匹配</p>

代码：

```
tcp-socket-base.h:
class TcpSocketBase : public TcpSocket
{
 public:
 ...
 void *threadfunction();
 ....
}

tcp-socket-base.cc:

void
*TcpSocketBase::threadfunction()
{
//do something
}

..//the thread was create and the function is called here
pthread_t t1;
int temp  =  pthread_create(&t1, NULL, ReceivedSpecialAck, NULL); //The error happens here
return;
... 
```

任何帮助，将不胜感激。谢谢！

编辑：

我接受了建议并使线程函数成为非成员函数。

```
namespaceXXX{

void *threadfunction()

int result  =  pthread_create(&t1, NULL, threadfunction, NULL);
      NS_LOG_LOGIC ("TcpSocketBase " << this << " Create Thread returned result: " << result );

void *threadfunction()
{
 .....
}

} 
```

但我得到了这个错误：

初始化 'int pthread_create(pthread_t*, const pthread_attr_t*, void* ( *)(void* ), void*)' [-fpermissive] 的参数 3

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T19:46:19.523

您希望将类的成员函数传递给您的`pthread_create`函数。线程函数应该是具有以下签名的非成员函数

```
void *thread_function( void *ptr ); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-29T20:53:09.227

如果你想继续使用 pthreads，一个简单的例子是：

```
#include <cstdio>
#include <string>
#include <iostream>

#include <pthread.h>

void* print(void* data)
{
    std::cout << *((std::string*)data) << "\n";
    return NULL; // We could return data here if we wanted to
}

int main()
{
    std::string message = "Hello, pthreads!";
    pthread_t threadHandle;
    pthread_create(&threadHandle, NULL, &print, &message);
    // Wait for the thread to finish, then exit
    pthread_join(threadHandle, NULL);
    return 0;
} 
```

如果可以的话，一个更好的选择是使用新的 C++11[线程库](http://en.cppreference.com/w/cpp/thread)。这是一个更简单的 RAII 接口，它使用模板，因此您可以将任何函数传递给线程，包括类成员函数（请参阅[此线程](https://stackoverflow.com/questions/10673585/start-thread-with-member-function)）。

然后，上面的例子简化为：

```
#include <cstdio>
#include <string>
#include <iostream>

#include <thread>

void print(std::string message)
{
    std::cout << message << "\n";
}

int main()
{
    std::string message = "Hello, C++11 threads!";
    std::thread t(&print, message);
    t.join();
    return 0;
} 
```

请注意如何直接传递数据 -`void*`不需要强制转换。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T20:36:38.130

如果您将函数声明为静态，它将编译。

# facebook-chat - 滥用 Facebook 聊天 API 的界限是什么

> ID：13128465
> 
> 赞同：-1
> 
> 时间：2012-10-29T19:41:36.187
> 
> 标签：facebook-chat, private-messaging

facebook 聊天 api 是一个强大的工具。从纯粹的技术角度来看，它肯定比它在 Graph API 中的私人消息的前身做得更多。

这就提出了一个问题，即 Facebook 将滥用其聊天 api 的界限在哪里。

所以这就是我打算如何在我的应用程序中使用 Facebook 聊天 API。

该应用程序是一个活动策划应用程序，可让用户邀请他们的朋友参加活动。除了发送短信和邮件通知客人外，最可靠的方式是通过facebook好友列表发送邀请。让我们面对现实吧，有时您的通讯录中可能没有此人的电话号码，而且您肯定不记得他们的大部分电子邮件，因此 Facebook 是您联系他们的唯一来源。

所以我需要一个解决方案来向客人发送邀请。以下是我的要求和条件：

*   来宾是用户的 Facebook 好友
*   无法获取客人的电子邮件（除非用户输入）或电话号码（即短信不是一个选项）
*   每位客人都必须收到他/她独有的链接
*   没有其他人应该能够获得此链接（即不应公开看到该消息）
*   它必须不需要用户的交互来发送这些邀请（想象一下让用户为他邀请的 10 个 Facebook 朋友确认一个 Facebook 帖子 10 次）。邀请必须自动发送。

这是障碍。Facebook 最近取消了发送私人消息的功能（我能够让我的 Facebook 朋友在一个多月前通过一个应用程序向我发送私人消息，现在不再）。但是，我发现我可以使用 Facebook Chat API 来做到这一点。

这似乎是一个灰色区域，我的应用程序使用聊天 API 的唯一目的是帮助用户通知他们的朋友他们的活动邀请。没有滥用的意图（例如向用户的每个朋友群发消息，并带有指向我的应用程序/网站的链接）。Facebook 会追捕我并撤销我的应用程序使用 Facebook 的 API 的特权吗？

任何人都可以阐明我对 API 的预期使用是滥用还是合法的？如果不合法，您有什么建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T22:21:04.623

I'd recommend using core functionality wherever possible here. For example, you could utilise the Facebook 'Event' object and the Graph API to create invite-only events and to invite individual friends of your app's users. This would deliver the same functionality without the need for nonce-based invite URLs and possible misuse of the Chat API. Take a look at [https://developers.facebook.com/docs/reference/api/event/#invited](https://developers.facebook.com/docs/reference/api/event/#invited) for details.

# python - 将 Python Shell 程序移植到 Tkinter GUI

> ID：13128466
> 
> 赞同：0
> 
> 时间：2012-10-29T19:41:38.600
> 
> 标签：python, tkinter

我查看了可能回答我的问题的类似问题，但我仍然不清楚如何进行以下操作：

我可以创建程序以在空闲的 Python Shell 中运行，我还可以在 Tkinter 中设置带有小部件的窗口，但是我在 Tkinter 中创建的任何内容都是毫无意义的，因为我无法弄清楚如何获取我的 Python Shell 代码并将其“包装”进去Tkinter 图形用户界面。

我假设它无法完成，并且必须编写全新的代码来支持特定于 Tkinter 的语言。我很困惑如何创建一个全面的程序，而不是只留下一个带有随机按钮、标签、条目等的 GUI“骨架”，以及一个非常没有吸引力并且只能在丑陋的小 Shell 中运行的 Python 程序.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T16:30:30.970

将应用程序从命令行移植到 GUI 可能需要一些返工（取决于您想要实现的交互程度）。

基本上，在 GUI 应用程序中，您在启动时构建一些*小部件*（按钮...），然后根据用户输入的“反应”执行所有操作。您通常通过将*回调**绑定* 到您的小部件（按钮、输入字段），然后进入*主循环*（或事件*循环*）来做到这一点。您可能会阅读[有关事件和绑定的这一章](http://effbot.org/tkinterbook/tkinter-events-and-bindings.htm)。

 ***如果您的应用程序主要面向计算，则提供带有“启动”按钮的 gui，并且输出字段很简单。如果您执行一些命令行输入，您可以低成本切换到小部件输入。更多交互式应用程序将需要针对交互功能进行架构。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T20:19:45.393

您使用 Tkinter 创建的内容并非毫无意义。在我看来，您正试图在 Python 中编译一个独立程序，使用 Tkinter 库来提供 GUI。一旦你有一个脚本工作，你可以使用一个程序编译成一个独立的程序。考虑`py2app`在 Mac 或`py2exe`Windows 上使用。谷歌他们，看看这是否是你要找的。***

# php - PHP Paypal IPN 争议处理

> ID：13128469
> 
> 赞同：1
> 
> 时间：2012-10-29T19:41:58.490
> 
> 标签：php, paypal, paypal-ipn

我有一个 Paypal IPN 来处理我的所有付款，在数据库中创建帐户等。当涉及到争议时，它可以检查一个何时打开，并为争议添加一行，包括交易 ID、金额等。我的问题是我不知道是否有办法检查争议是否已结束，以及是否赢/输。有谁知道是否有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T16:14:37.740

IPN 的`transaction_type`参数可以包含不同的变量，这就是您知道发生了什么的方式。

在您的情况下，您检查`transaction_type`是否存在`adjustment`，如果是，您可以查看`case_type`是否是争议或退款。

[https://cms.paypal.com/uk/cgi-bin/?cmd=_render-content&content_ID=developer/e_howto_admin_IPNReference#id091EBC0E05Z](https://cms.paypal.com/uk/cgi-bin/?cmd=_render-content&content_ID=developer/e_howto_admin_IPNReference#id091EBC0E05Z)

# php - 字段未从 php 插入 mysql 数据库

> ID：13128470
> 
> 赞同：0
> 
> 时间：2012-10-29T19:42:05.197
> 
> 标签：php, mysql, forms

我有一个小问题，字段没有被插入到我的用户表中。我有两个表如下：

用户 - id、gamerid、电子邮件、密码、国家、国家代码国家 - country_id、国家、国家代码

现在我有一个注册表单，其中包含游戏 ID、电子邮件、密码和国家选择（使用 php 从国家表中提取）

我的问题是，当我提交表单时，我想运行查询以从表中提取与用户选择的内容匹配的国家代码，并将这些字段插入用户表中。除了 country_code 之外，我的所有数据都正确插入。

这是我的 html 选择部分的代码：

```
 <select name = "country_create" style = "height: 25px; width: 180px;">
    <option value="0" selected="selected" class =  "signup_form_country_select_class">Select your country</option>
    <?php
        include "config.php";

        $connection = mysql_connect($host, $username, $password) or die(mysql_error());
        mysql_select_db($dbname, $connection) or die(mysql_error());

        $result = mysql_query('SELECT country FROM countries');

        while($row = mysql_fetch_array($result))
        {
            echo '<option value="'.$row['country'].'">'.$row['country'].'</option>';
        }
    ?>
</select> 
```

这是注册脚本中的 php：

```
 $connection = mysql_connect($host, $username, $password) or die(mysql_error());
mysql_select_db($dbname, $connection) or die(mysql_error());

// INPUT CLEANING FUNCTION
function clean($str)
{
    $cleaned = mysql_real_escape_string(strip_tags($str));
    return $cleaned;
}

$gamerid = clean($_POST['gamerid_create']);
$email = clean($_POST['email_create']);
$password = clean($_POST['password_create']);
$country = ($_POST['country_create']);

$cc_qry = "SELECT country_code FROM countries WHERE country = '$country'";
$country_code = mysql_query($cc_qry);

$insert = "insert into users(gamerid,email,password,country,country_code) values('$gamerid','$email','$password','$country','$country_code')";                    
mysql_query($insert, $connection); 
```

提前谢谢各位！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-29T19:43:54.150

首先 - 使用 PDO 或 mysqli 函数，但其​​次 - 您还必须从查询结果中获取数据：

```
$res = mysql_query($cc_qry);
$res_cc = mysql_fetch_assoc($res);
$country_code = $res_cc['country_code']; 
```

# mysql - MySQL - 将 INSERT 拆分为 2 个查询

> ID：13128481
> 
> 赞同：0
> 
> 时间：2012-10-29T19:43:04.667
> 
> 标签：mysql, insert

我有一个 INSERT 查询，如下所示：

```
$db->Query("INSERT INTO `surfed` (user, site) VALUES('".$data['id']."', '".$id."')"); 
```

基本上我想像上面的查询一样插入，但是如果该站点已经由另一个用户提交，我不希望它重新提交相同`$id`的到站点列。但是多个用户可以查看同一个站点，并且所有用户都需要与他们查看过的站点位于同一行，这导致冲浪表有成千上万的插入，这大大降低了站点的速度。

有什么办法可以以某种方式拆分插入，这样如果一个站点已经提交，它就不会再次提交给另一个用户。也许有一种方法可以使用 UPDATE 以防止插入过多？

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T19:53:12.780

如果您不需要知道是否实际插入了一行，则可以使用`INSERT IGNORE ...`.

```
$db->Query("INSERT IGNORE INTO `surfed` (user, site) VALUES('".$data['id']."', '".$id."')"); 
```

但这假设您为列定义了唯一键。

`IGNORE`这里将忽略由于尝试添加相同的唯一键两次而触发的完整性约束违规错误。

关于 INSERT 语法的 MySQL 参考手册有一些关于[http://dev.mysql.com/doc/refman/5.5/en/insert.html的信息](http://dev.mysql.com/doc/refman/5.5/en/insert.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T19:53:55.920

您需要设置一个条件语句，询问 id 是否已经存在，如果它确实更新，否则插入

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T19:49:47.600

我想最简单的方法是设置一个执行 SELECT 以检查用户站点组合是否已经在表中的存储过程。如果不是，则执行插入语句。如果该组合已经存在，则您已完成并且不执行插入。

查看存储过程手册 [http://dev.mysql.com/doc/refman/5.1/en/create-procedure.html](http://dev.mysql.com/doc/refman/5.1/en/create-procedure.html)

# html - 创建相对于文本的边框？

> ID：13128483
> 
> 赞同：0
> 
> 时间：2012-10-29T19:43:08.863
> 
> 标签：html, css

这是一张图片，显示了我想要实现的目标。

![在此处输入图像描述](../Images/845b402871dec8b7d5ac61cab6ff1c83.png)

因此，任何给定文本（通常是某种标题标签）左右两侧的一行，在文本的每一侧都延伸了一定的距离（在本例中为 65 像素）。

我需要与文本本身相关的流动性...整体宽度无法固定。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T20:00:00.517

你可以用不同的方式来做。一种方法是在将文本保留在标题标签或带有字体设置的 div 中之后，在文本周围设置边框。请参阅以下链接中的建议：

[将居中文本添加到类似 <hr/> 的行的中间](https://stackoverflow.com/questions/2812770/add-centered-text-to-the-middle-of-a-hr-like-line)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T18:21:11.630

这个解决方案是过去最适合我的解决方案，您可以在[此处查看示例](http://jsfiddle.net/rglepper/sq9DS/1/)。该代码使用 ::before 和 ::after 伪类来创建行，然后将 display:table 应用于文本，以便框适应它的内容（我使用 h2 作为示例）这种类型的设计通常是居中的我添加了边距：1em auto;
这样做，您不需要添加任何额外的 html。希望能帮助到你。

```
h2{
    display:table; 
    margin: 1em auto;
}
h2:before, h2:after{
    content:"";
    display: block;
    border-top: 1px solid #ccc;
    width: 65px;
    margin-top:.5em;
}
h2:before{
    float: left;
    margin-right:3px;
}
h2:after{
    float:right;
    margin-left:3px;
} 
```

​​​

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T19:48:28.210

你的html代码

```
<fieldset class="title">
    <legend>Some text</legend>
</fieldset> 
```

你的CSS代码

```
fieldset.title {
    border-top: 1px solid #aaa;
    border-bottom: none;
    border-left: none;
    border-right: none;
    display: block;
    text-align: center;

}
    fieldset {
       width: 50%;                
    }
fieldset.title legend {
    padding: 5px 10px;

} 
```

[jsFiddle](http://jsfiddle.net/KnEyF/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-29T20:03:12.037

试试这个：[演示](http://jsfiddle.net/8GjrJ/)

```
<html>
    <head>
        <style type="text/css"> 
            .striked-text {
                position: relative;
            }            
            .striked-text .text {            
                z-index: 10;
                position: relative;
                background-color: white;
                padding: 0 5px;
            }
            .striked-text .line {                
                left: -65px;
                padding: 0 65px;
                border-top: 1px solid gray;
                top: 0.7em;
                display: block;
                position: absolute;
                width: 100%;
                z-index: 1;
            }
        </style>
    </head>
    <body>
        <div style="text-align:center;">
            <span class="striked-text"><span class="text">FAQ</span><span class="line"></span></span>
        </div>
    </body>
</html> 
```

对于标题，您需要定义容器的宽度

# ruby-on-rails-3 - 在 Rails 3.2.8 中使用 jbuilder 模板生成的漂亮打印 JSON

> ID：13128485
> 
> 赞同：6
> 
> 时间：2012-10-29T19:43:17.890
> 
> 标签：ruby-on-rails-3, json, pretty-print, jbuilder

任何人都有办法从 jbuilder 漂亮地打印 JSON 输出？

我可以漂亮地打印在控制器操作中生成的 JSON，例如：

```
JSON.pretty_generate(some_json_object) 
```

但是一旦我传递给一个 jbuilder 模板，我不知道有一种方法可以很好地打印输出。

现在，我的操作方法的渲染语句很简单：

```
render formats: :json 
```

这成功地强制使用 jbuilder 进行渲染，而不管指定的输入格式类型如何（这是我想要的行为）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-29T20:23:54.127

我找到了一种方法来做到这一点：

```
 json_string = render_to_string formats: :json    
 json_object = JSON.parse(json_string)     
 render :json => JSON.pretty_generate(json_object) 
```

同样，这假定此操作有一个 jbuilder 模板，它将创建初始 json，该 json 被呈现为字符串，返回为 json 对象，然后传递给 pretty_generate()。

这有点迂回，但它确实有效。当然，我完全愿意接受更严格的实现！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-05-28T19:31:29.347

```
# config/initializers/jbuilder_prettify.rb
require "jbuilder"

class Jbuilder
  ##
  # Allows you to set @prettify manually in your .jbuilder files. 
  # Example: 
  #   json.prettify true
  #   json.prettify false 
  #  
  attr_accessor :prettify

  alias_method :_original_target, :target!

  ##
  # A shortcut to enabling prettify.
  # Example:
  #   json.prettify!
  #
  def prettify!
    @prettify = true
  end

  def target!
    @prettify ? ::JSON.pretty_generate(@attributes) : _original_target
  end
end 
```

* * *

```
# app/views/api/v1/users/show.json.jbuilder
json.prettify! if %w(1 yes true).include?(params["pretty"])

json.( @user, :id, :name, :created_at, :updated_at ) 
```

[https://github.com/rails/jbuilder/issues/195#issuecomment-44440569](https://github.com/rails/jbuilder/issues/195#issuecomment-44440569)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-04-10T07:03:24.120

扩展布莱克米勒的答案......

这是来自[要点](https://gist.github.com/jmoe/02c7476adac24eddd969)的代码：

```
require 'multi_json'
MultiJson.use :yajl
unless Rails.env.production?
  MultiJson.dump_options = {:pretty=>true}
end 
```

我把它放到一个名为 /config/initializers/jbuilder_prettify.rb 的文件中

为了使它工作，您必须将 yajl-ruby gem 包含在您的 Gemfile 中。请注意，jbuilder github 主页[在这里](https://github.com/rails/jbuilder#faster-json-backends)提到了如何使用 yajl-ruby 之类的东西来加快 json 渲染速度。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-11-13T03:59:03.087

这对我有用，而接受的答案却没有。它也更短！

[https://gist.github.com/jmoe/02c7476adac24eddd969](https://gist.github.com/jmoe/02c7476adac24eddd969)

```
require 'multi_json'
MultiJson.use :yajl
unless Rails.env.production?
  MultiJson.dump_options = {:pretty=>true}
end 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-12-03T00:39:11.703

`config/initializers/jbuilder.rb`和：

```
class Jbuilder
  def target!
    ::JSON.pretty_generate(@attributes)
  end
end 
```

结果，https://localhost:3000/manifest.json

```
{
  "name": "Socializus",
  "short_name": "Socializus",
  "start_url": "http://localhost:3000",
  "theme_color": "#ffffff",
  "background_color": "#ffffff",
  "display": "standalone",
  "icons": [
    {
      "src": "/android-chrome-192x192.png",
      "sizes": "192x192",
      "type": "image/png"
    },
    {
      "src": "/android-chrome-512x512.png",
      "sizes": "512x512",
      "type": "image/png"
    }
  ]
} 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-09-07T04:23:17.367

我觉得这个比较简单

```
@package = Package.first

json = JSON.parse(@blog.to_json)

PP.pp(json)

{"id_to_s"=>"5222675dbc11149e3a000002",
 "title"=>"Package Title",
 "version"=>"0.1.1",
 "comment"=>
  {"user"=>"Joe",
   "description"=>"Joe's comment"},
 "assets"=>
  [{"id_to_s"=>"522a4620fa451436f4000001",
    "_type"=>"Illustration",
    "start"=>0,
    "stop"=>100,
    "caption"=>"mountain climbing"},
   {"id_to_s"=>"522a56a6fa4514523a000001",
    "_type"=>"Illustration",
    "start"=>200,
    "stop"=>300,
    "caption"=>"airport"},
   {"id_to_s"=>"522a6a0ffa4514a30e000002",
    "_type"=>"Illustration",
    "start"=>400,
    "stop"=>600,
    "caption"=>"doc"},
   {"id_to_s"=>"522aa46bbc1114551f000001",
    "_type"=>"Illustration",
    "start"=>nil,
    "stop"=>nil,
    "caption"=>nil},
   {"id_to_s"=>"522aa47fbc1114551f000002",
    "_type"=>"Illustration",
    "start"=>10,
    "stop"=>30,
    "caption"=>"asdflkjsd"}]} 
```

或者，更快的单线，

```
PP.pp JSON.parse Blog.first.to_json 
```

# c# - 使用 C# 代理列表

> ID：13128487
> 
> 赞同：1
> 
> 时间：2012-10-29T19:43:27.870
> 
> 标签：c#, proxy

我正在尝试构建一个应用程序，该应用程序通过代理访问某个网站（来自文本框）x 次（也来自文本框）。我遇到的问题是将代理列表放入程序并在 webBrowser 控件中使用它。这是我到目前为止所拥有的。任何帮助表示赞赏。谢谢。

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Security.Permissions;
using Microsoft.Win32;
using System.Diagnostics;
using System.Threading;
using System.IO;
using System.Net;

namespace LetsBot
{
    public partial class TrafficBot : Form
    {
        public TrafficBot()
        {
            InitializeComponent();
        }

        private void btnClear_Click(object sender, EventArgs e)
        {
            this.txtURL.Clear();
            this.txtProxy.Clear();
            this.txtURL.Focus();
        }

        private void btnStart_Click(object sender, EventArgs e)
        {
            this.lblBrowsing.Show();
            this.btnStart.Enabled = false;

            int n = Convert.ToInt32(this.txtNumVisits.Text);
            for (int i = 0; i < n; i++)
            {
                string url = this.txtURL.Text;
                this.webBotBrowser.Navigate(url);
                while (webBotBrowser.ReadyState != WebBrowserReadyState.Complete)
                {
                    Application.DoEvents();
                }
                string PageText = this.webBotBrowser.DocumentText.ToString();
                Thread.Sleep(5000);                
            }            
        }       

        private void btnStop_Click(object sender, EventArgs e)
        {
            this.btnStart.Enabled = true;
            this.webBotBrowser.Stop();
            this.txtURL.Focus();          
        }

        private void btnExit_Click(object sender, EventArgs e)
        {
            DialogResult dialogResult = MessageBox.Show("Exit Traffic Bot?", "Don't Let Me Go!", MessageBoxButtons.YesNo);
            if (dialogResult == DialogResult.Yes)
            {
                Application.Exit();
            }
            else if (dialogResult == DialogResult.No)
            {

            }

        }

        private void webBotBrowser_ProgressChanged(object sender, WebBrowserProgressChangedEventArgs e)
        {

            if (e.CurrentProgress > 0)
            {
                ProgressBar.Value = (int)(e.CurrentProgress / e.MaximumProgress * 100);

            }
        }

        private List<string> getProxyListFromText(string input)
        {
            List<string> list = new List<string>();
            StreamReader reader = new StreamReader(input);
            string item = "";
            while (item != null)
            {
                item = reader.ReadLine();
                if (item != null)
                {
                    list.Add(item);
                }
            }
            reader.Close();
            return list;

            for (int i = 0; i < listBox1.Items.Count; i++)
            {
                object url;
                WebClient wc;
                url = this.txtURL.Text;
                wc = new WebClient();

                //This should come from the proxy list
                foreach (string prox in getProxyListFromText("Proxies.txt"))
                {
                    wc.Proxy = new WebProxy(prox);

                    var page = wc.DownloadString(url.ToString());
                    HtmlAgilityPack.HtmlDocument doc = new HtmlAgilityPack.HtmlDocument();
                    doc.LoadHtml(page);
                    var pplname = doc.DocumentNode.SelectNodes("/html/body/div[3]/div/div[2]/div[2]/div/div[4]/p");
                }
            }
        }
    }
} 
```

# c# - SQL数据库搜索->调用多个存储过程/函数

> ID：13128493
> 
> 赞同：2
> 
> 时间：2012-10-29T19:43:49.433
> 
> 标签：c#, sql-server, search, stored-procedures

**背景**

我目前正在重写一个搜索引擎......我最初是在几年前匆忙写的:)

今天，搜索包含约 5 种不同的内部业务对象/表：用户、组织、新闻标题等。因此，当用户在`"The Quick Brown Fox"`搜索框中键入时，他/她将获得每种类型的业务对象的结果。

每个业务对象都有一个关联的存储过程：`spSearchUsers`、`spSearchOrganizations`等。

**问题**

现在，对于每次搜索，我为每种业务对象类型多次调用每个存储过程（通过 BL -> 数据访问层）。例如，当用户搜索 时`"The Quick Brown Fox"`，我将整个字符串原封不动地发送下来，但也将字符串拆分为每个空格，并单独搜索每个单词。

在这种情况下，每个存储过程被调用 5 次……对于一次搜索，总共需要 25 个单独的数据库调用。我不觉得这是典型的......但它仍然运行得很快。每次搜索大约需要 4-5 秒。

**我想创造什么**

单个“主”存储过程获取整个搜索字符串`"The Quick Brown Fox"`，该字符串依次调用每个单独的业务对象存储过程（`spSearchUsers`、`spSearchOrganizations`等），执行一点逻辑，并返回 1 个结果集。

所以 1 个搜索... 1 个结果。

这可以使用存储过程、函数和/或用户定义的表类型来实现吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T19:49:29.207

如果您使用的是 Ms-Sql，您可以创建一个[全文索引](http://www.simple-talk.com/sql/learn-sql-server/understanding-full-text-indexing-in-sql-server/)，允许您使用所有术语进行搜索，而无需更改文本。此外，存储过程可以返回多个结果集，因此您可以创建一个新的存储过程来运行每个查询并返回所有记录，或者单独调用所有以前的存储过程（如下所示）。

```
CREATE PROCEDURE [dbo].[DoMassiveSearch]
@searchText varchar(200) = null
AS
BEGIN
  EXEC spSearchUsers @searchText

  EXEC spSearchOrganizations @searchText
END 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T20:54:33.577

假设您可以创建这样的视图

```
CREATE VIEW vSearchFields
as

    SELECT "U" as tableName, IDUser as ID, UserName as searchField 
    FROM USERS

UNION

    SELECT "O" as tableName, IDOrganizations as ID, OrgName as searchField
    FROM Organizations

UNION

    SELECT 'N' as tableName, IDNews as ID, newsText as searchField
    FROM News 

UNION

    SELECT 'H' as tableName, IDHeadline as ID, headlineText as searchField
    FROM Headlines 
```

现在您可以编写一个简单的存储过程来搜索 seachField 中的文本

```
CREATE PROCEDURE [dbo].[searchText]
@textToSearch nvarchar(2000)
AS
BEGIN
    SELECT * FROM vSearchFields WHERE searchField = @textToSearch
END 
```

下一步将引入一个函数来拆分输入文本并使用文本部分进行重复搜索，或者，如果您的数据库版本允许（2008 年及之后），使用表值参数将拆分的字符串作为从 C# 代码到存储过程的表。

[T-SQL](https://stackoverflow.com/questions/697519/split-function-equivalent-in-tsql)
[表值参数中的拆分函数](http://msdn.microsoft.com/en-us/library/bb510489%28v=sql.100%29.aspx)

# java - 在java中读取文件时如何转义以特殊字符开头的行

> ID：13128494
> 
> 赞同：0
> 
> 时间：2012-10-29T19:43:51.330
> 
> 标签：java, file, io, escaping

假设一个文件包含以下几行：

```
#Do
#not
#use
#these
#lines.

Use
these. 
```

我的目标是只阅读那些不以`#`. 如何在 Java 中以最佳方式完成这项工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T20:02:05.740

让我们假设您想要累积行（当然您可以对每一行做任何事情）。

```
String filePath = "somePath\\lines.txt";

// Lines accumulator.
ArrayList<String> filteredLines = new ArrayList<String>();

BufferedReader bufferedReader = null;
try {
    bufferedReader = new BufferedReader(new FileReader(filePath));
    String line;

    while ((line = bufferedReader.readLine()) != null) {
        // Line filtering. Please note that empty lines
        // will match this criteria!
        if (!line.startsWith("#")) {
            filteredLines.add(line);
        }
    }
}
finally {
    if (bufferedReader != null)
        bufferedReader.close();
} 
```

使用 Java 7 **try-with-resources**语句：

```
String filePath = "somePath\\lines.txt";
ArrayList<String> filteredLines = new ArrayList<String>();

try (Reader reader = new FileReader(filePath);
    BufferedReader bufferedReader = new BufferedReader(reader)) {

    String line;
    while ((line = bufferedReader.readLine()) != null) {
        if (!line.startsWith("#"))
            filteredLines.add(line);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T19:46:25.807

使用`String.startsWith()`方法。在你的情况下，你会使用 `if(!myString.startsWith("#")) { //some code here }`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T19:47:13.730

BufferedReader.readLine() 返回一个字符串。您可以检查该行是否以`#`使用 string.startsWith()开头

```
FileReader reader = new FileReader("file1.txt");
    BufferedReader br  = new BufferedReader(reader);
    String line="";
    while((line=br.readLine())!=null){
        if(!line.startsWith("#")){
            System.out.println(line);
        }
    }
} 
```

# heroku - 您如何将工作人员测功机添加到 Heroku 项目？

> ID：13128501
> 
> 赞同：6
> 
> 时间：2012-10-29T19:44:13.560
> 
> 标签：heroku

如何将 Worker dyno 添加到 Heroku 应用程序？

他们的帮助系统包括一些信息：[https ://devcenter.heroku.com/articles/background-jobs-queueing](https://devcenter.heroku.com/articles/background-jobs-queueing)

包括使用命令行扩展您的应用程序的说明：

```
$ heroku ps:scale web=1 worker=5 
```

这将返回未定义工作人员的响应。

UI还有一个调整资源的页面： ![Heroku 资源页面](../Images/90475f58fb707e603a95c71ab1cec64e.png)

但它不包括添加工人的选项。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-29T19:57:51.607

您需要在 Procfile 中有一个工作人员，然后工作人员测功机设置将出现在 UI 中。

只需添加

```
worker: command_to_run_your_worker 
```

到您的 Procfile 之后，您将能够扩展工作人员。

# c++ - 在 C++ 中删除字符串对象

> ID：13128505
> 
> 赞同：0
> 
> 时间：2012-10-29T19:44:32.227
> 
> 标签：c++, string

我有一个 const char* str 并且我想将它转换为一个简单的字符串，所以我使用了 std::string() 构造函数并将 str 的值复制到我的变量中。

```
 const char* str;
    std::string newStr = std::string(str);

    <some processing>...
    <end> 
```

所以在函数结束之前我必须删除字符串 newStr 还是自动调用 std::string 类的析构函数并且这个 newStr 将被删除。当我[在这里](https://stackoverflow.com/questions/9135501/why-doesnt-stdstring-have-a-virtual-destructor)读到std::string 类的析构函数不是虚拟的时，我感到很困惑。但是[这里](https://stackoverflow.com/questions/3130490/deleting-string-object-in-c)它说该字符串将在超出范围时被删除。任何人都可以对此有所了解，因为如果析构函数不是虚拟的，这似乎令人困惑，字符串变量在超出范围后如何被删除。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-29T19:47:17.910

您不必删除`newStr`. 它有[自动存储](http://en.wikipedia.org/wiki/Automatic_variable)，所以它的析构函数会在超出范围时被调用。这与析构函数是虚拟的完全无关。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T19:50:37.023

由于您没有使用 new 关键字创建对象，因此该对象是在堆栈上创建的，并且当变量超出范围时会自动调用 destruct-or。但是，当您使用 new 关键字创建对象时，您的对象是在堆上创建的。这是 C++ 中的一般规则。

# jquery - 如何创建具有特定 div 大小的 div

> ID：13128507
> 
> 赞同：0
> 
> 时间：2012-10-29T19:44:56.863
> 
> 标签：jquery, height, width

如何创建具有特定 div 大小（css 中的高度和宽度）的 div。

```
$('<div/>').css({
    "display" : "block";
    "width" : width();
    "height" : height();
}).appendTo('#fixed'); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T19:47:02.097

您需要 outerHeight()/outerWidth() 属性。这将包括应用于目标元素的任何边距和填充：

```
$('<div/>').css({
    "display" : "block",
    "width" : $('#myelem').outerWidth(),
    "height" : $('#myelem').outerHeight()
}).appendTo('#fixed'); 
```

注意我的参数元素中的格式。Javascript 对象道具用逗号分隔

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T19:47:09.303

你几乎明白了：

```
var $target = $('#fixed');
$('<div/>').css({
    "width" : $target.innerWidth(),
    "height" : $target.innerHeight();
}).appendTo($target); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T19:47:18.127

像那样：

```
$('<div/>').css({
    "display" : "block";
    "width" : $('#divTarget').outerWidth()+'px';
    "height" : $('#divTarget').outerHeight()+'px';
}).appendTo('#fixed'); 
```

# ruby - ruby 中的字符串文字如何绕过 new/initialize，有没有办法对此进行检测？

> ID：13128510
> 
> 赞同：8
> 
> 时间：2012-10-29T19:45:08.447
> 
> 标签：ruby, internals

今天下午我在玩一个想法，偶然发现了一些我不太明白的东西。基本上，我在这个实验中想要实现的是以某种方式知道每次创建字符串时（供以后使用，例如在某种 DSL 中）。以下适用于通过 String.new 创建的任何字符串：

```
class ::String
  class << self
    alias_method :new_orig, :new
    def new(*args)
      o = new_orig(*args)
      puts "newing '#{o}'"
      o
    end
  end
  alias_method :initialize_orig, :initialize
  def initialize(*args)
    initialize_orig(*args)
    puts "initializing '#{self}'"
  end
end 
```

例如

```
irb > String.new("foo")
initializing 'foo'
newing 'foo'
 => "foo" 
```

我无法弄清楚当您使用文字时如何创建 String 对象。例如，为什么这不经过相同的初始化和设置：

```
irb > "literal string"
 => "literal string" 
```

我意识到当字符串是文字时编译器正在做一些不同的事情，但它不需要初始化，只是为了成为一个功能齐全的对象吗？是否有任何技巧可以用来确定何时使用文字创建字符串，或者这是不可能的？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T18:25:36.637

我认为从接下来的讨论来看，这里几乎没有人会给你真正的答案，除非 Chris Heald 醒来并真正按照他的承诺查看源代码。但是，如果，正如您在对问题的评论中所说，目的是“测试语言可以做些什么来获得一些乐趣和学习新东西的界限”，那么让我向您介绍 - 尽管我讨厌 SlideShare -[这是著名深奥程序员 Yusuke Endoh 的 Ruby 演示文稿](http://www.slideshare.net/mametter/ruby-esoteric-obfuscated-ruby-programming-5088683)。

# vb.net - Lotus Notes - 扫描收件箱时光标闪烁/闪烁

> ID：13128511
> 
> 赞同：0
> 
> 时间：2012-10-29T19:45:12.523
> 
> 标签：vb.net, lotus-notes, lotus-domino

我有一个机器人定期扫描我的收件箱以查找特定的电子邮件。每当下面的代码触发光标时，光标在 Lotus Notes UI 上方时会闪烁。谷歌为我的搜索返回了大约 5 个结果，但似乎都没有解决这个问题。这并没有阻止我的程序工作，但它在美学上看起来确实很糟糕。有没有人有任何想法？谢谢！

*我还将其标记为 C# 以吸引更多人关注它。我更喜欢 vb.net 解决方案，但 C# 也受到欢迎和赞赏。

```
 Dim NS As Object = CreateObject("Notes.NotesSession")
    Dim NDB As Object = NS.GetDatabase("", "")
    If NDB.IsOpen = False Then NDB.Openmail()
    Dim NV As Object = NDB.GetView("($Inbox)")
    NV.refresh()
    Dim ND As Object = NV.GetFirstDocument
    Dim aItems As Array
    Dim dInfo As Dictionary(Of String, String)
    Dim EmailCount As Integer = NV.entrycount
    Dim iCurrent As Integer = 0
    Dim EmailDate As DateTime
    Dim Subject As String, Body As String, sFrom As String
    Do
        iCurrent += 1
        aItems = ND.Items
        dInfo = New Dictionary(Of String, String)
        For i As Integer = 0 To aItems.Length - 1
            If Not dInfo.ContainsKey(aItems(i).name) Then
                dInfo.Add(aItems(i).name, aItems(i).text)
            End If
        Next
        EmailDate = CDate(dInfo("DeliveredDate"))
        Subject = dInfo("Subject")
        Body = dInfo("Body")
        sFrom = dInfo("From")
        If NV.GetNextDocument(ND) Is Nothing Then Exit Do
        ND = NV.GetNextDocument(ND)
    Loop 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T20:53:17.577

该类`Notes.NotesSession`是一个 OLE 类，这意味着它与 Notes UI 交互。

您应该改用该类的 COM 版本，即`Lotus.NotesSession`

# objective-c - TableView 未正确重新加载

> ID：13128512
> 
> 赞同：2
> 
> 时间：2012-10-29T19:45:14.850
> 
> 标签：objective-c, ios

我正在制作一个设置屏幕，您可以在其中通过 uisearchbar 选择电台。我有一个分段的表格视图，其中一个站的第一个字母作为标题，每个站都按它的第一个字母分类。到目前为止，一切都很好。我有 2 个 NSMutableArray，每个部分都有这些站。一个是未过滤的数组（当我没有过滤它时我会使用它），另一个是当我搜索某些东西时。（我通过谓词做到这一点）。在键盘上的每个按键上，我都会执行 [self.tableView reloadData]; 这行得通，但是滚动视图停留的时间太长了！因此，您可以滚动查看所选数组中实际有多少结果。这会导致崩溃，因为它试图获取不存在的对象。

因此，似乎 tableview 没有正确计算数组或其他什么？有人熟悉这个问题吗？

这是一些代码：

```
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    if (self.searching) {
        return [self.tableFilterd count];
    } else {
        return [self.tableData count];
    }
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    NSLog(@"Rows for section");
    // Return the number of rows in the section.
    if (self.searching) {
        NSLog(@"Editing section: %i, count %i", section, [[self.tableFilterd objectAtIndex:section] count]);
        return [[self.tableFilterd objectAtIndex:section] count];
    } else {
        NSLog(@"Not editing");
        return [[self.tableData objectAtIndex:section] count];
    }
}

- (UIView *)tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section {

    SettingsHeaderCell *cell = [[[SettingsHeaderCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:@"HeaderCell"] autorelease];

    cell.labelLetter.text = [[self.tableLetters objectAtIndex:section] capitalizedString];

    return cell;
}

- (CGFloat)tableView:(UITableView *)tableView heightForHeaderInSection:(NSInteger)section {
    return 40;
}

- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath {
    return 52;
}

- (UITableViewCell *)tableView:(UITableView *)theTableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";
    SettingsCell *cell = [theTableView dequeueReusableCellWithIdentifier:CellIdentifier];

    if (cell == nil) {
        cell = [[[SettingsCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier] autorelease];
    }

    if (self.searching) {
        StationObject *object = (StationObject *)[[self.tableFilterd objectAtIndex:indexPath.section] objectAtIndex:indexPath.row];
        [cell setStationObject:object];
    } else {
        StationObject *object = (StationObject *)[[self.tableData objectAtIndex:indexPath.section] objectAtIndex:indexPath.row];
        [cell setStationObject:object];
    }

    return cell;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T11:21:51.947

您现在可能已经解决了这个问题，但我怀疑您没有清空任何一个数组。在方法中：

```
- (void)searchBar:(UISearchBar *)theSearchBar textDidChange:(NSString *)searchText
{

//Remove all objects first
[self.tableFiltered removeAllObjects];
[self.tableData removeAllObjects]; 
```

你也只需要调用 [self.tableView reloadData]; 在 textDidChange 中，而不是在其他三个方法中。希望这可以帮助。

# android - 在 Android 中发布 JSON 并检索响应

> ID：13128516
> 
> 赞同：2
> 
> 时间：2012-10-29T19:45:56.487
> 
> 标签：android, json, android-networking

我正在尝试将 JSON 消息发布到站点并检索 JSON 消息。
java.net.ProtocolException：方法不支持请求正文：POST 有谁知道出了什么问题？提前致谢

```
 HttpURLConnection conn=null;
        try{
            URL url=new URL(urlString);
            String userPassword = userName +":" + passWord;
            byte[] bytes=Base64.encode(userPassword.getBytes(),Base64.DEFAULT);
            String stringEncoding = new String(bytes, "UTF-8");

             conn = (HttpURLConnection) url.openConnection();
             conn.setReadTimeout(10000 /* milliseconds */);
             conn.setConnectTimeout(15000 /* milliseconds */);
             conn.setDoOutput(true);
             conn.setDoInput(true);
             conn.setRequestMethod("POST");
            conn.setRequestProperty ("Authorization", "Basic " + stringEncoding);
            conn.setRequestProperty("Content-Type", "application/json;charset=utf-8");
            Log.i("Net", "length="+conn.getContentLength());
            Log.i("Net", "contentType="+conn.getContentType());
            Log.i("Net", "content="+conn.getContent());
            conn.connect();

        }catch(Exception e){
            Log.d("Url Formation Connection", e.toString());
        } 
```

//输出{尝试{

```
 String requestString="{“ ";

            wr = new OutputStreamWriter(conn.getOutputStream());
            wr.write(requestString.toString());
            wr.flush();

    //input{
        BufferedReader rd = null;
        String response=" ";

            is = conn.getInputStream();
            rd = new BufferedReader(new InputStreamReader(is));
            String line;
            StringBuffer responseBuff = new StringBuffer();
            while ((line = rd.readLine()) != null) {
                // Process line...
                responseBuff.append(line);
            }
            response = responseBuff.toString();
            Log.d("response", response);
        }catch(Exception e){
            Log.d("buffer error", e.toString());
        }finally {
            if (is != null) {
                try {
                    wr.close();
                    is.close();
                } catch (IOException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }
            } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T14:27:18.193

可能是您连接的服务器不允许 POST 操作。我会先尝试一个 GET 请求，看看您是否拥有该 Web 服务方法的权限。

此外，您可以使用更简单的 HttpClient 试试运气，虽然我自己没有测试过这个解决方案：[http ://www.geekmind.net/2009/11/android-simple-httpclient-to.html](http://www.geekmind.net/2009/11/android-simple-httpclient-to.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T19:56:23.293

只是一个猜测，但你可以尝试设置：

```
 conn.setDoOutput(false); 
```

文档说：“可选择上传请求正文。如果实例包含请求正文，则必须使用 setDoOutput(true) 进行配置。” [HttpURL连接](http://developer.android.com/reference/java/net/HttpURLConnection.html)

既然你体内什么都没有，不妨设置为false。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T20:00:51.283

Android 为[setRequestMethod](http://developer.android.com/reference/java/net/HttpURLConnection.html#setRequestMethod%28java.lang.String%29)提供的文档很少，但是您的错误表明*POST*不是有效的方法。尝试使用*PUT*代替：

```
conn.setRequestMethod("PUT"); 
```

另请参阅[此帖子](https://stackoverflow.com/questions/1051004/how-to-send-put-delete-http-request-in-httpurlconnection-looks-like-not-workin)了解您可能需要进行的任何调整。

# javascript - 在FireFox中使用big 3 + jquery在页面顶部显示图像？

> ID：13128517
> 
> 赞同：1
> 
> 时间：2012-10-29T19:46:08.193
> 
> 标签：javascript, jquery, html, css, firefox

![在此处输入图像描述](../Images/096726dc178345ce47d9289f59da43c8.png)

选择时，希望将单个图像置于页面的前面或顶部。

搜索后，似乎有很多插件支持这一点 - 但也有很多我不需要的其他功能和开销（图库，支持视频，缩略图等）

是否可以只使用基本的 JavaScript、CSS、HTML 和 jQuery 将单个图像放在顶部，特别是在 FireFox 中？

谢谢你。

（请注意*：这是内部产品，因此有这些要求和限制。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T20:08:22.137

> 是否可以只使用基本的 JavaScript、CSS、HTML 和 jQuery 将单个图像放在上面，特别是在 FireFox 中？

是的，这是可能的，但插件在大多数情况下是更容易实现的。你想要完成的是类似于`light box`效果的东西，但我会尝试根据完成你想要做的事情所需的 4 个步骤给出一个简单的解决方案：

1.  创建一个覆盖 div。这个 div 会使您的整个页面变得模糊或变暗。在下面的示例中，它会使您的屏幕变暗（因为它更简单）。
2.  创建一个将附加到覆盖 div 并包含您要显示的图像的 div。在下面的演示中，这个 div`lighter`将比覆盖的 div 更实际，实际上将具有屏幕的一半宽度和一半高度。
3.  将更大的图像附加到您的图像 div。
4.  根据图像的`alt`文本为图像添加字幕。

    ```
    $(document).ready(function()
    {

        var docWidth = $(document).width();
        var docHeight = $(document).height();

        //First Step" Creating the overlay-div and adding opacity to it
        var overlayDiv = "<div id="overlay-div"></div>"
        $("body").append(overlayDiv);
        $("#overlay-div").css("position","absolute", "top","0","left","0","background-color","#000","opacity","0.5", "width", docWidth + "px", "height",docHeight + "px");

        //Second step: Creating the image-div and centering it on the screen

        $("#overlay-div").append("<div id=\"image-div\"></div>");
        $("#image-div").css("position","absolute", "top",docHeight/4 + "px","left",docWidth/4 + "px","background-color","#FFF", "width", docWidth/2, "height",docHeight);

        //Third step: Creating an image to display inside the image-div and centering it

        $("#image-div").append("<img src=\"path/to/your/image\"id=\"zoomed-img\" alt=\"This is a zoomed image\"/>");
        var imgWidth = $("#image-div").width();
        var imgHeight = $("#image-height").height();

        $("#image-div").css("position","absolute", "top","10px","left","10px");

        //Fourth step: Creating a subtitle from the alt text
        var subtitle = "<p id=\"text-subtitle\">" + $("#image-div").attr("alt") + "</p>";

        $("#image-div").append(subtitle);
        $("#text-subtitle").css("position","absolute", "top",imgHeight + 20 + "px","left","10px");

    }); 
    ```

当您的文档准备好时触发此功能，并获取任意图像。但是，通过对上面的代码稍作调整，可以显示由单击触发的不同图像（具有不同的字幕）。

我打算向您展示一个简单的演示，它可以使用几行 jQuery/javascript 代码来创建您想要的。当然，它不如 90% 的插件效果那么漂亮，但这可能是一个开始。

我希望它有所帮助。干杯

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T19:51:57.633

对于一个愚蠢的简单灯箱，我最近一直在利用[http://buckwilson.me/lightboxme/](http://buckwilson.me/lightboxme/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-29T19:55:38.240

尝试引导模式。

[JavaScript - 推特引导](http://twitter.github.com/bootstrap/javascript.html#modals)

GitHub源代码

[GitHub bootstrap-modal.js](https://github.com/twitter/bootstrap/blob/master/js/bootstrap-modal.js)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-29T20:09:22.793

这是我制作的一个非常基本的示例。希望很好的学习：

[http://jsfiddle.net/v9LTP/2/](http://jsfiddle.net/v9LTP/2/)

```
$('img').click(function(){  //bind a click event handler to images
    var img = $(this).clone().addClass('modal').appendTo($('#blackout')); //clone the clicked image element and add to the blackout div which gives the dark background.
    $('#blackout > #close').click(function(){ //attach click handler to close button
        $('#blackout').fadeOut(function(){ //fade the blackout div
            img.remove(); //remove the image element we cloned, so we can do it again.
        }); 
    });
    $('#blackout').fadeIn(); //show the blackout div
}); 
```

​</p>

# automapper - AutoMapper 可以隐式地展平这个映射吗？

> ID：13128523
> 
> 赞同：4
> 
> 时间：2012-10-29T19:46:22.240
> 
> 标签：automapper

我正在尝试在两个对象列表之间进行映射。源类型具有 type 的复杂属性`A`；目标类型是类型的扁平子集`A`加上源类型中的附加标量属性。

```
public class A
{
    public int Id { get; set; }
    public string Name { get; set; }
}

public class Source
{
    public A MyA { get; set; }
    public int SomeOtherValue { get; set; }
}

public class Destination
{
    public string Name { get; set; }
    public int SomeOtherValue { get; set; }
} 
```

如果不清楚，我想`Source.MyA.Name`映射到`Destination.Name`和`Source.SomeOtherValue`映射到`Destination.SomeOtherValue`.

实际上，type`A`有十几个属性，其中 80% 映射到`Destination`. 如果我像这样明确地拼出映射，我可以让事情正常工作`CreateMap`：

```
CreateMap<Source, Destination>()
    .ForMember(dest => dest.Name, opt => opt.MapFrom(src => src.MyA.Name)); 
```

这里的缺点是我想避免必须为每个需要复制到的属性添加`ForMember`一行。我希望我可以做类似的事情：`A``Destination`

```
CreateMap<Source, Destination>()
    .ForMember(dest => dest, opt => opt.MapFrom(src => src.MyA)); 
```

但是，如果我尝试上述操作，则在注册映射时会出现运行时错误：“成员的自定义配置仅支持类型上的顶级个人成员。”

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-01T00:16:13.470

`A`在and `Destination`、 and`Source`和 and之间创建映射`Destination`，然后`AfterMap()`在第二个中使用第一个映射

```
Mapper.CreateMap<A, Destination>();
Mapper.CreateMap<Source, Destination>()
      .AfterMap((s, d) => Mapper.Map<A, Destination>(s.MyA, d)); 
```

然后像这样使用它：

```
var res = Mapper.Map<Source, Destination>(new Source { SomeOtherValue = 7,  MyA = new A { Id = 1, Name = "SomeName" } }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T22:21:34.103

As a workaround you can use custom type converter with additional property in the destination type to avoid recursion.

```
[TestFixture]
public class MapComplexType
{
    [Test]
    public void Map()
    {
        Mapper.CreateMap<A, Destination>();

        Mapper.CreateMap<Source, Destination>().ConvertUsing(new TypeConvertor());
        var source = new Source
                         {
                             MyA = new A
                                       {
                                           Name = "Name"
                                       },
                                       SomeOtherValue = 5
                         };
        var dest = new Destination();
        Mapper.Map(source, dest);
        Assert.AreEqual(dest.Name, "Name");
    }
}

public class TypeConvertor : ITypeConverter<Source, Destination>
{
    public Destination Convert(ResolutionContext context)
    {
        var destination = (Destination) context.DestinationValue;
        if (!((Destination)context.DestinationValue).IsMapped || destination == null)
        {
            destination = destination ?? new Destination();
            destination.IsMapped = true; // To avoid recursion
            Mapper.Map((Source)context.SourceValue, destination);
                            destination.IsMapped = false; // If you want to map the same object few times
        }
        Mapper.Map(((Source)context.SourceValue).MyA, destination);
        return (Destination)context.DestinationValue;
    }
}

public class A
{
    public int Id { get; set; }
    public string Name { get; set; }
}

public class Source
{
    public A MyA { get; set; }
    public int SomeOtherValue { get; set; }
}

public class Destination
{
    public string Name { get; set; }
    public int SomeOtherValue { get; set; }
    // Used only for mapping purposes
    internal bool IsMapped { get; set; }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T05:46:26.850

尝试这个，

```
Mapper.CreateMap<A, Destination>();
Mapper.CreateMap<Source, Destination>()
    .ForMember(destination => destination.Name, options => options.MapFrom(source => Mapper.Map<A, Destination>(source.MyA).Name));

var objSource = new Source { SomeOtherValue = 7, MyA = new A { Id = 1, Name = "SomeName" } };
var result = Mapper.Map<Source, Destination>(objSource); 
```

# android - 哪个媒体播放器结束，以及 onCompletion() 方法上的不同命令集

> ID：13128526
> 
> 赞同：0
> 
> 时间：2012-10-29T19:46:25.930
> 
> 标签：android, methods, android-mediaplayer

假设我创建了几个玩家。并且可以说，对于其中的每一个，我都希望激活一组不同的操作。

我怎样才能找到哪个玩家已经完成（案例语句的实现本身）以便对每个玩家采取不同的行动？

例如：为了处理单个玩家，我们所要做的就是实现这样的`onCompletion()`方法：

```
public void onCompletion(MediaPlayer mp){
    //DO SOMETHING HERE THAT FITS FOR ALL KINDS OF PLAYER'S TYPE OBJECTS
} 
```

如何添加一个案例句来扩展它以处理几个不同的播放器对象？

谢谢 ！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-29T20:09:18.300

`MediaPlayer`传递给此方法的属性与`MediaPlayer`刚刚完成的相同，因此只要您保留指向每个媒体播放器的指针（例如通过全局变量），那么您需要做的就是检查您收到的媒体播放器：

```
public class MyClass implements OnClompleteListener 
{
    MediaPlayer player1, player2, player3;
    //initialize them
    player1.setOnCompleteListener(this);
    player2.setOnCompleteListener(this);
    player3.setOnCompleteListener(this);

    @Override
    public void onCompletion(MediaPlayer mp)
    {
        if (mp == player1)
        {
            //TODO handle player 1 completion
        }
        else if (mp == player2)
        {
            //TODO handle player 2 completion
        }
        else if (mp == player3)
        {
            //TODO handle player 3 completion
        }
    }
} 
```

您也可以在线处理此问题，而无需实现`OnCompleteListener`：

```
player1.setOnCompleteListener(new OnCompleteListener() {

    @Override
    public void onCompletion(MediaPlayer mp)
    {
        //mp IS ALWAYS EQUAL TO player1!
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T19:59:34.680

您可以创建一个扩展类`MediaPlayer`并为其赋予一个属性（如数字）以跟踪哪个玩家是哪个玩家。然后你会在方法中检查玩家的号码`onCompletion()`。否则，您可以创建不同的 onCompletion 侦听器并将它们设置为不同的播放器。

# jenkins - Jenkins 与 Nunit 测试

> ID：13128527
> 
> 赞同：-3
> 
> 时间：2012-10-29T19:46:27.283
> 
> 标签：jenkins

正在使用 Nunit 测试配置 Jenkins，但是当我尝试构建时它失败了，如下所示

我试过这个链接但没有成功

C:\Program Files (x86)\NUnit 2.6.2\bin>exit 0 记录 NUnit 测试结果 致命：未找到 NUnit 测试报告文件。

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-11-29T13:05:11.283

Yahia，我尝试这种形式并使用它

在 Jenkins 项目中的**Action pos-building**中添加新的**新命令窗口批处理**类似的东西（我的 jenkins 是葡萄牙语）。

并使用这个命令行

cd [path NUnit]\NUnit 2.6.1\bin\ nunit-console [path Nunit File test][nunit file test].nunit /xml=[path from your xml out][your xml out].xml

我希望能有所帮助。

# ruby-on-rails - Rails 与自加入类的关联

> ID：13128529
> 
> 赞同：0
> 
> 时间：2012-10-29T19:46:35.413
> 
> 标签：ruby-on-rails, has-many, self-join, nomethoderror

我正在做一个 Rails 项目，我正在使用自我加入的一对多设置。

我有一个名为 User 的类，它有很多客户。每个客户都有很多订单列表，如下所示：

```
class User < ActiveRecord::Base
  has_many :customers, class_name: 'User', foreign_key: 'owner_id'
  belongs_to :owner, class_name: 'User'
  has_many :order_lists, dependent: :destroy 
```

现在，当我打开 Rails 控制台时。我试图这样做：

```
user.customers.order_lists 
```

我懂了：

```
NoMethodError: undefined method `order_lists' 
```

当我尝试这样做时：

```
user.customers.first.order_lists 
```

我确实收到了那个客户的订单清单。但是我怎么能收到我所有客户的所有订单呢？

有人有想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T19:54:24.603

在你打电话时有很多关系：

```
user.customers 
```

它返回用户“拥有”的所有客户的数组，所以当你打电话时

```
user.customers.order_lists 
```

`order_lists`正在调用一系列客户。（没有方法`order_lists`）。第一种方法为您提供数组中的第一个客户，因此它可以工作。您还可以执行以下操作：

```
user.customers[0].order_lists 
```

如果你愿意。（虽然首先使用更好）

获取所有客户的 order_lists 将遍历所有客户并让他们像这样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T19:56:38.770

因此，您想要与用户关联的所有客户的所有 order_lists？

这可以解决问题：

```
user.customers.map(&:order_lists).flatten 
```

或者，您可以在 OrderList 上创建一个范围，该范围采用一组 customer_id，如下所示：

```
scope :for_customer_ids, ->(customer_ids) {
  where("user_id IN (?)", customer_ids)
} 
```

接着

```
OrderList.for_customer_ids(user.customer_ids) 
```

# jquery - 淡入淡出图像？

> ID：13128530
> 
> 赞同：0
> 
> 时间：2012-10-29T19:46:39.077
> 
> 标签：jquery, html, css

如何让图像在 40% 到 100% 之间不断淡入淡出？

我尝试制作 CSS3 不透明度，但它只支持 0% 和 100%，所以它不会真正褪色。

任何想法如何做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T19:50:24.750

CSS Opacity 支持全系列...

只是十进制格式。

编辑：添加跨浏览器不透明度。

```
-ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=40)";
filter: alpha(opacity=40);
-moz-opacity: 0.4;
-khtml-opacity: 0.4;
opacity:0.4; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T19:50:57.910

这就是您将 jQuery 应用于这种情况的方式：

**淡出到 40%**

```
function fadOut() {
    $('img').animate({'opacity':'0.4'}, 500); // 500 is the time in milliseconds
} 
```

**淡入 100%**

```
function fadIn() {
    $('img').animate({'opacity':'1.0'}, 500); // 500 is the time in milliseconds
} 
```

要不断运行它，请尝试

```
var timer = setTimeout(fadOut, 1000); // after every 1 sec it will fadOut

clearTimer(timer); // to clear the timer 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T19:52:57.340

Adrian 说的是正确的，但是如果你像我一样并且对 CSS 很糟糕，你可以使用[TwitterBootstrap](http://twitter.github.com/bootstrap)那里的淡入淡出类以及你可以做的所有其他很酷的事情可能会对你有所帮助。

# ios - 如何从 Apple 获取崩溃日志？

> ID：13128536
> 
> 赞同：0
> 
> 时间：2012-10-29T19:46:49.453
> 
> 标签：ios, emulation, appstore-approval

我们开发了一个应用程序，它可以在几种不同的模拟器和设备上完美运行，一次也没有崩溃，但两次我们尝试向 Apple 提交它都会以“2.1 - 崩溃的应用程序被拒绝”（或其他内容）的形式返回给我们。

我似乎无法从他们那里找到日志或任何其他信息。崩溃日志在任何地方都可用吗？或者只是任何信息？他们只说它在装有 iOS 6 的 iPad 3rd Gen 上崩溃了。我们在这样的设备上运行它并没有为我们崩溃。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T20:24:31.693

不幸的是，Apple 没有提供其审查过程的详细日志，尽管有时会提供崩溃日志，如下面评论中的@jsd 所示。

理论上，崩溃报告会与 iTunes 同步，并且可以由 Apple 收集并通过 iTunes Connect 提供给您，但在实践中，这很少奏效 - 或者只有很大的延迟。

但是，您可以将一些崩溃报告集成到您的应用程序中。这里有一些服务可以让您毫不费力地做到这一点：

*   [曲棍球应用程序](http://www.hockeyapp.net)
*   [批判主义](http://www.crittercism.com)
*   [错误感知](http://www.bugsense.com)
*   [试飞](https://testflightapp.com)

事实证明，在我的应用程序的生产版本中集成崩溃报告非常有用，所以我强烈推荐这个。良好的崩溃报告服务提供了一个 SDK，可包含在您的应用程序中，并生成符号化、可读、即用型的崩溃报告，使跟踪错误变得非常容易。

至于你的应用程序崩溃的原因，这里有一些基本的猜测：

1.  您使用 ARC（自动引用计数）吗？你应该。
2.  您是否在 Xcode ( ) 中运行了静态分析器`Product ➞ Analyze`？
3.  您是否在不同的环境下进行了测试（例如，通过 3G、WiFi 或根本没有互联网连接）？
4.  您是否在设备上删除并重新安装了该应用程序，或者您只是更新了它？

# signals - 阻塞函数和 EINTR

> ID：13128538
> 
> 赞同：4
> 
> 时间：2012-10-29T19:47:03.647
> 
> 标签：signals, blocking, eintr

许多 POSIX 阻塞函数在出现信号时返回 EINTR。这个想法是信号处理程序首先设置一个标志（在 SIGINT 的情况下说“停止”标志），然后阻塞函数解除阻塞返回 EINTR 并且应用程序看到该标志并执行有序关闭（或其他）。

但是，对于一些阻塞函数，例如 pthread_mutex_lock 和 pthread_cond_wait，没有 EINTR 错误。

这背后的想法是什么？使用这些函数的应用程序应该如何处理信号（特别是 Ctrl+C）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T10:59:21.630

没有答案。我的假设是 pthread_cond_wait() 和 SIGINT 不能结合起来执行干净的关闭。使用 sem_wait() 或类似方法代替 pthread_cond_wait()。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T21:27:14.207

通常，只有系统调用（低级操作系统调用）返回 EINTR。更高级别的标准库调用没有。例如，`read`and`write`可能会返回 EINTR，但`printf`不会`gets`。

通常，接收 an 时正确的做法`EINTR`是重做调用——这就是信号处理程序上存在 SA_RESTART 标志的原因。如果你想处理 Ctrl-C，你只需要不要忽略这个信号。退出的默认操作可能是您想要的，或者您可以编写自己的信号处理程序来执行其他操作。

# ruby-on-rails - httpwebrequest 不发送带有自定义网络凭据的客户端标头？

> ID：13128539
> 
> 赞同：1
> 
> 时间：2012-10-29T19:47:04.993
> 
> 标签：ruby-on-rails, session-variables

关于这篇文章[来自 C# 客户端的 Apache NTLM Auth do not work with self-defined NetworkCredentials](https://stackoverflow.com/questions/13066270/apache-ntlm-auth-from-c-sharp-client-do-not-work-with-self-defined-networkcreden)我添加了一种方法来进行身份验证。我以为我今天的工作已经完成了 :) 但我遇到了另一个问题。

代码：

```
public static void Authenticate()
{
  Stream requestStream = null;
  string loginUrl = Common.WindowAuthentication ? Common.PortalUrl + Common.IoiLoginWin : Common.PortalUrl + Common.IoiLogin;

  var request = (HttpWebRequest)WebRequest.Create(loginUrl);
  request.Method = WebRequestMethods.Http.Post;
  request.AllowAutoRedirect = true;
  request.CookieContainer = Common.Cookies;
  request.Accept = @"*/*";

  if (Common.WindowAuthentication)
  {
    if (Common.UserName.Length > 0)
    {
      string[] domainuser;
      string username;
      string domain;

      if (Common.UserName.Contains("@"))
      {
        domainuser = Common.UserName.Split('@');
        username = domainuser[0];
        domain = domainuser[1];
      }
      else
      {
        domainuser = Common.UserName.Split('\\');
        username = domainuser[1];
        domain = domainuser[0];
      }
      var nc = new NetworkCredential(username, Common.Password, domain);
      var cache = new CredentialCache();
      cache.Add(request.RequestUri, "NTLM", nc);
      request.Credentials = cache;
    }
    else
    {
      request.Credentials = CredentialCache.DefaultNetworkCredentials;
    }
  }
  else
  {
    string payload = Common.ParmLogin + Common.UserName + "&" + Common.ParmPass + Common.Password;
    StringBuilder urlEncoded = new StringBuilder();
    Char[] reserved = { '?', '=', '&' };
    byte[] byteBuffer;

    if (payload != null)
    {
      int i = 0, j;
      while (i < payload.Length)
      {
        j = payload.IndexOfAny(reserved, i);
        if (j == -1)
        {
          urlEncoded.Append(HttpUtility.UrlEncode(payload.Substring(i, payload.Length - i)));
          break;
        }
        urlEncoded.Append(HttpUtility.UrlEncode(payload.Substring(i, j - i)));
        urlEncoded.Append(payload.Substring(j, 1));
        i = j + 1;
      }
      byteBuffer = Encoding.UTF8.GetBytes(urlEncoded.ToString());
      request.ContentLength = byteBuffer.Length;
      requestStream = request.GetRequestStream();
      requestStream.Write(byteBuffer, 0, byteBuffer.Length);
      requestStream.Close();
    }
    else
    {
      request.ContentLength = 0;
    }
    if (Common.LogCommunicatin)
      LogCommunication(loginUrl, payload);
  }

  using (HttpWebResponse response = (HttpWebResponse)request.GetResponse())
  {
    if (response.StatusCode.ToString() == "OK") {
      WebHeaderCollection c = response.Headers;
      Common.SessionCookie = Common.Cookies.GetCookies(new Uri(loginUrl))["_ror_session"].Value;
      if (Common.LogCommunicatin)
        LogCommunication(loginUrl, "Cookie: " + Common.SessionCookie); 
    }
  }
} 
```

当我使用`CredentialCache.DefaultNetworkCredentials`服务器（Ruby on Rails over Apache/Thin）时，能够获取用户名和远程地址。

代码（ruby 代码服务器端的一部分）：

```
begin
  cookies[:user] = { :value => user.strusername, :expires => 1.month.from_now }
  session[:current_user_id] = user.id
  session_record = request.env['rack.session.record']
  session_record.update_attributes({
    :username => user.strusername,
    :client_ip => (request.env['HTTP_X_FORWARDED_FOR']||request.env['REMOTE_ADDR'])
  })
rescue => e
end 
```

但是当我使用自己的凭据时，服务器不会从 httpwebrequest 获取用户名和 client_ip。

那么我做错了什么或我想念什么？

**更新：**

我插入了一些 ruby​​ 调试代码来检查会话和标头。事实上，用户和客户端 ip 是在浏览器和 httpwebrequest 中发送的。但出于任何原因，`session_record.update_attributes`不要更新/保存值。

所以这是一个我必须调查的红宝石问题......没有c＃的东西......

这是对客户端 IP 和用户名已成功更新的浏览器标头的 RoR 检查：

```
{"SERVER_SOFTWARE"=>"thin 1.2.11 codename Bat-Shit Crazy", "SERVER_NAME"=>"thorx64", "rack.input"=>#<StringIO:0x9f4db08>, "rack.version"=>[1, 0], "rack.errors"=>#<IO:<STDERR>>, "rack.multithread"=>false, "rack.multiprocess"=>false, "rack.run_once"=>false, "REQUEST_METHOD"=>"GET", "REQUEST_PATH"=>"/ror/login.json", "PATH_INFO"=>"/login.json", "REQUEST_URI"=>"/ror/login.json", "HTTP_VERSION"=>"HTTP/1.1", "HTTP_HOST"=>"thorx64", "HTTP_ACCEPT"=>"image/jpeg, image/gif, image/pjpeg, application/x-ms-application, application/xaml+xml, application/x-ms-xbap, application/vnd.ms-excel, application/vnd.ms-powerpoint, application/msword, */*", "HTTP_ACCEPT_LANGUAGE"=>"de-DE", "HTTP_USER_AGENT"=>"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET4.0C; .NET4.0E; .NET CLR 3.5.30729; .NET CLR 3.0.30729)", "HTTP_ACCEPT_ENCODING"=>"gzip, deflate", "HTTP_AUTHORIZATION"=>"NTLM TlRMTVNTUAADAAAAAAAAAFgAAAAAAAAAWAAAAAAAAABYAAAAAAAAAFgAAAAAAAAAWAAAAAAAAABYAAAABcKIogYBsR0AAAAPB3e6Q1YIzZ10PiKm2g/S6A==", "HTTP_COOKIE"=>"user=Administrator", "HTTP_X_ISRW_PROXY_AUTH_USER"=>"Administrator", "HTTP_MAX_FORWARDS"=>"10", "HTTP_X_FORWARDED_FOR"=>"192.168.14.21", "HTTP_X_FORWARDED_HOST"=>"thorx64", "HTTP_X_FORWARDED_SERVER"=>"thorx64", "HTTP_CONNECTION"=>"Keep-Alive", "GATEWAY_INTERFACE"=>"CGI/1.2", "SERVER_PORT"=>"80", "QUERY_STRING"=>"", "SERVER_PROTOCOL"=>"HTTP/1.1", "rack.url_scheme"=>"http", "SCRIPT_NAME"=>"/ror", "REMOTE_ADDR"=>"127.0.0.1", "async.callback"=>#<Method: Thin::Connection#post_process>, "async.close"=>#<EventMachine::DefaultDeferrable:0x9f4c4d0>, "action_dispatch.parameter_filter"=>[:password], "action_dispatch.secret_token"=>"a1ef5e037607d12742a40a0793de973a5e68605ccf087ad1baedaee6d811687b82a0671b94da2c4a9af2b481a5346585649e83d2f56f2838a4aca8eedbfc93b7", "action_dispatch.show_exceptions"=>true, "action_dispatch.remote_ip"=>127.0.0.1, "rack.session"=>{}, "rack.session.options"=>{:path=>"/", :domain=>nil, :expire_after=>nil, :secure=>false, :httponly=>true, :id=>nil}, "rack.request.cookie_string"=>"user=Administrator", "rack.request.cookie_hash"=>{"user"=>"Administrator"}, "action_dispatch.request.path_parameters"=>{:controller=>"login", :action=>"index", :format=>"json"}, "action_controller.instance"=>#<LoginController:0xb6d59a0 @action_has_layout=true, @view_context_class=nil, @_headers={"Content-Type"=>"text/html"}, @_status=200, @_response=#<ActionDispatch::Response:0xb6d5760 @writer=#<Proc:0xb6d54f0@D:/Informer/ruby/lib/ruby/gems/1.9.1/gems/actionpack-3.0.10/lib/action_dispatch/http/response.rb:43 (lambda)>, @block=nil, @length=0, @header={}, @status=200, @body=[], @cookie=[], @sending_file=false, @blank=false, @cache_control={}, @etag=nil, @request=#<ActionDispatch::Request:0xb6d5778 @env={...}, @request_method="GET", @filtered_parameters={"controller"=>"login", "action"=>"index", "format"=>"json"}, @method="GET", @fullpath="/ror/login.json">>, @_request=#<ActionDispatch::Request:0xb6d5778 @env={...}, @request_method="GET", @filtered_parameters={"controller"=>"login", "action"=>"index", "format"=>"json"}, @method="GET", @fullpath="/ror/login.json">, @_env={...}, @lookup_context=#<ActionView::LookupContext:0xb6c3d60 @details_key=nil, @details={:handlers=>[:erb, :rjs, :builder, :rhtml, :rxml], :formats=>[:html, :text, :js, :css, :ics, :csv, :xml, :rss, :atom, :yaml, :multipart_form, :url_encoded_form, :json, :flv, :file, :image, :auto, :sourcefile, :sourceimage, :sourceauto, :legacy, :edit], :locale=>[:de, :de]}, @skip_default_locale=false, @frozen_formats=false, @view_paths=[d:/Informer/company/latest/ror/app/views, d:/Informer/company/latest/ror/vendor/plugins/will_paginate/app/views, d:/Informer/company/latest/ror/vendor/plugins/usesguid/app/views, d:/Informer/company/latest/ror/vendor/plugins/acts_as_tree/app/views]>, @_action_name="index", @_response_body=nil, @_config={}, @_params={"controller"=>"login", "action"=>"index", "format"=>"json"}, @_current_user=nil>, "action_dispatch.request.content_type"=>nil, "action_dispatch.request.request_parameters"=>{}, "rack.request.query_string"=>"", "rack.request.query_hash"=>{}, "action_dispatch.request.query_parameters"=>{}, "action_dispatch.request.parameters"=>{"controller"=>"login", "action"=>"index", "format"=>"json"}, "action_dispatch.request.formats"=>[application/json]} 
```

这里来自网络请求，其中我也有 client_ip 和用户名，但数据库没有更新：

```
{"SERVER_SOFTWARE"=>"thin 1.2.11 codename Bat-Shit Crazy", "SERVER_NAME"=>"thorx64", "rack.input"=>#<StringIO:0xa3a3778>, "rack.version"=>[1, 0], "rack.errors"=>#<IO:<STDERR>>, "rack.multithread"=>false, "rack.multiprocess"=>false, "rack.run_once"=>false, "REQUEST_METHOD"=>"POST", "REQUEST_PATH"=>"/ror/login.json", "PATH_INFO"=>"/login.json", "REQUEST_URI"=>"/ror/login.json", "HTTP_VERSION"=>"HTTP/1.1", "HTTP_HOST"=>"thorx64", "HTTP_ACCEPT"=>"*/*", "HTTP_X_REQUESTED_WITH"=>"XMLHttpRequest", "HTTP_USER_AGENT"=>"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET4.0C; .NET4.0E; .NET CLR 3.5.30729; .NET CLR 3.0.30729)", "HTTP_AUTHORIZATION"=>"NTLM TlRMTVNTUAADAAAAGAAYAH4AAACgAaABlgAAAAwADABYAAAADAAMAGQAAAAOAA4AcAAAAAAAAAA2AgAABYKIogYBsR0AAAAPGyWqqmBHFtGQTE/QMlHT7XQAcQBzAG8AZgB0AHIAYQB1AHMAYwBoAFQASABPAFIAWAA2ADQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAoZP5isSr442bUTMoUknN3QEBAAAAAAAAZCgelIW2zQH2AaAgXe6DYQAAAAACAAwAVABRAFMATwBGAFQAAQAOAFQASABPAFIAWAA2ADQABAAsAGYAcgBhAC4AZwBlAHIAbQBhAG4AeQAuAHQAcQBzAG8AZgB0AC4AbgBlAHQAAwA8AFQASABPAFIAeAA2ADQALgBmAHIAYQAuAGcAZQByAG0AYQBuAHkALgB0AHEAcwBvAGYAdAAuAG4AZQB0AAUALABmAHIAYQAuAGcAZQByAG0AYQBuAHkALgB0AHEAcwBvAGYAdAAuAG4AZQB0AAcACABkKB6UhbbNAQYABAACAAAACAAwADAAAAAAAAAAAAAAAAAwAAAgXEA1/+dnAlRife8JhCuzKyRGkcsJKXvyXzrION0KdwoAEAAAAAAAAAAAAAAAAAAAAAAACQBGAEgAVABUAFAALwBUAEgATwBSAHgANgA0AC4AZgByAGEALgBnAGUAcgBtAGEAbgB5AC4AdABxAHMAbwBmAHQALgBuAGUAdAAAAAAAAAAAAAAAAAA=", "HTTP_X_ISRW_PROXY_AUTH_USER"=>"rausch", "HTTP_MAX_FORWARDS"=>"10", "HTTP_X_FORWARDED_FOR"=>"192.168.14.21", "HTTP_X_FORWARDED_HOST"=>"thorx64", "HTTP_X_FORWARDED_SERVER"=>"thorx64", "HTTP_CONNECTION"=>"Keep-Alive", "GATEWAY_INTERFACE"=>"CGI/1.2", "SERVER_PORT"=>"80", "QUERY_STRING"=>"", "SERVER_PROTOCOL"=>"HTTP/1.1", "rack.url_scheme"=>"http", "SCRIPT_NAME"=>"/ror", "REMOTE_ADDR"=>"127.0.0.1", "async.callback"=>#<Method: Thin::Connection#post_process>, "async.close"=>#<EventMachine::DefaultDeferrable:0xa3a28f0>, "action_dispatch.parameter_filter"=>[:password], "action_dispatch.secret_token"=>"a1ef5e037607d12742a40a0793de973a5e68605ccf087ad1baedaee6d811687b82a0671b94da2c4a9af2b481a5346585649e83d2f56f2838a4aca8eedbfc93b7", "action_dispatch.show_exceptions"=>true, "action_dispatch.remote_ip"=>127.0.0.1, "rack.session"=>{}, "rack.session.options"=>{:path=>"/", :domain=>nil, :expire_after=>nil, :secure=>false, :httponly=>true, :id=>nil}, "rack.request.form_input"=>#<StringIO:0xa3a3778>, "rack.request.form_hash"=>{}, "rack.request.form_vars"=>"", "action_dispatch.request.path_parameters"=>{:controller=>"login", :action=>"index", :format=>"json"}, "action_controller.instance"=>#<LoginController:0xb9d86a0 @action_has_layout=true, @view_context_class=nil, @_headers={"Content-Type"=>"text/html"}, @_status=200, @_response=#<ActionDispatch::Response:0xb9d8460 @writer=#<Proc:0xb9d8388@D:/Informer/ruby/lib/ruby/gems/1.9.1/gems/actionpack-3.0.10/lib/action_dispatch/http/response.rb:43 (lambda)>, @block=nil, @length=0, @header={}, @status=200, @body=[], @cookie=[], @sending_file=false, @blank=false, @cache_control={}, @etag=nil, @request=#<ActionDispatch::Request:0xb9d8478 @env={...}, @request_method="POST", @filtered_parameters={"controller"=>"login", "action"=>"index", "format"=>"json"}, @method="POST", @fullpath="/ror/login.json">>, @_request=#<ActionDispatch::Request:0xb9d8478 @env={...}, @request_method="POST", @filtered_parameters={"controller"=>"login", "action"=>"index", "format"=>"json"}, @method="POST", @fullpath="/ror/login.json">, @_env={...}, @lookup_context=#<ActionView::LookupContext:0xb9d55f8 @details_key=nil, @details={:handlers=>[:erb, :rjs, :builder, :rhtml, :rxml], :formats=>[:html, :text, :js, :css, :ics, :csv, :xml, :rss, :atom, :yaml, :multipart_form, :url_encoded_form, :json, :flv, :file, :image, :auto, :sourcefile, :sourceimage, :sourceauto, :legacy, :edit], :locale=>[:de, :de]}, @skip_default_locale=false, @frozen_formats=false, @view_paths=[d:/Informer/company/latest/ror/app/views, d:/Informer/company/latest/ror/vendor/plugins/will_paginate/app/views, d:/Informer/company/latest/ror/vendor/plugins/usesguid/app/views, d:/Informer/company/latest/ror/vendor/plugins/acts_as_tree/app/views]>, @_action_name="index", @_response_body=nil, @_config={}, @_params={"controller"=>"login", "action"=>"index", "format"=>"json"}, @_current_user=nil>, "action_dispatch.request.request_parameters"=>{}, "rack.request.query_string"=>"", "rack.request.query_hash"=>{}, "action_dispatch.request.query_parameters"=>{}, "action_dispatch.request.parameters"=>{"controller"=>"login", "action"=>"index", "format"=>"json"}, "action_dispatch.request.formats"=>[application/json], "rack.session.record"=>#<ActiveRecord::SessionStore::Session id: nil, session_id: "14e03319c61b707318dd50066340be95", client_ip: nil, username: nil, data: nil, created_at: nil, updated_at: nil>, "action_dispatch.request.flash_hash"=>nil} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T10:13:04.207

好的，经过更多测试，我终于找到了问题：我们`protect_from_forgery`在我们的应用程序控制器中使用。

所以它有助于`skip_before_filter :verify_authenticity_token`在我的登录控制器中进行设置。

但这对我来说似乎是一种解决方法，我对此感觉并不好。

我不是 rails pro，但我想知道为什么我必须在我的第一个请求中发送一个令牌，该令牌从我的`httpwebrequest`.

编辑1：

任何人都有线索，解释或链接如何正确管理这个？或者换句话说：由于我的登录控制器仅进行身份验证，从安全的角度来看，禁用此控制器上的身份验证令牌是可以的？

编辑2：

我发现了这个：[了解 Rails Authenticity Token](https://stackoverflow.com/questions/941594/understand-rails-authenticity-token)。但现在我需要知道如何获取令牌并将其存储在我的 C# 客户端中，以便在每次请求时重新发送它。还是根本不需要？

# php - 为什么 Yii MVC findBySQL() 使用多个数据库时缺少方法或闭包？

> ID：13128540
> 
> 赞同：0
> 
> 时间：2012-10-29T19:47:04.753
> 
> 标签：php, yii

我的应用程序有一个主数据库和许多辅助数据库。我有每个数据库 2 GB 的限制，所以我必须有多个数据库。

数据必须保存在主数据库和许多辅助数据库之一中。从主数据库，我知道要保存数据的辅助数据库。

我的数据库不完全相同，有细微的差别。我为主数据库创建了一个模型，为辅助数据库创建了另一个模型。

这是错误：

```
CException

SlaveUrl and its behaviors do not have a method or closure named "findByUrl". 
```

这是我正在与之抗争的路线：

```
$record = SlaveUrl::model()->findByUrl($query); 
```

它在这段代码中找到：

```
<?php

class ScannerCommand extends CConsoleCommand {

    private $time;
    private $urls = 0;

    /**
     * Executes the command.
     * @param array command line parameters for this command.
     */
    public function run($args) {
        // $args gives an array of the command-line arguments for this command
        $this->time = time();
        $instance_scanner = new InstanceScanner();
        $instance_scanner->create = $this->time;
        $instance_scanner->urls = 0;
        if ($instance_scanner->save()) {
            echo 'scanner start' . PHP_EOL;
            $criteria = new CDbCriteria();
            $criteria->condition = 'status=:status';
            $criteria->order = '`update` asc';
            $criteria->limit = 1;
            $criteria->params = array(':status' => 1);
            $model_website = Website::model()->find($criteria);
            $model_website->update = $this->time;
            $model_website->save();
            echo 'scanning ' . $model_website->name . ' ... ' . PHP_EOL;
            $model_pattern_url = PatternUrl::model()->findByAttributes(array('website_id' => $model_website->id));
            //$website_file_content = file_get_contents($model_website->link);
            $website_file_content = CurlTool::fetchContent($model_website->link,array(),true);
            preg_match_all('/<a href=[\'"](.*?)[\'"].*?>([^<]+)<\/a>/ims', $website_file_content, $matches_url);
            if ((is_array($matches_url[0])) && (count($matches_url[0]) > 0))
                foreach ($matches_url[0] as $key => $value) {
                    $ok = false;
                    preg_match_all($model_pattern_url->pattern, $matches_url[1][$key], $matches_pattern_url);
                    //print_r($matches_pattern_url);
                    if ((is_array($matches_pattern_url)) && (count($matches_pattern_url[0]) > 0))
                        if (strpos($matches_url[1][$key], $matches_pattern_url[0][0]) !== false)
                            $ok = true;

                    SlaveUrl::$server_id = $model_website->server_id;

                    echo $query = "select * from `url` where  ( ( `website_id`='".($model_website->id)."' ) and ( `link`='".($matches_url[1][$key])."' ) ) or (  ( `website_id`='".($model_website->id)."' ) and ( `name` = '".(addslashes($matches_url[2][$key]))."' ) );";

                    $record = SlaveUrl::model()->findByUrl($query);

                    if( $record == null )
                    {

                    $model_slave_url = new SlaveUrl();
                    $model_slave_url->website_id = $model_website->server_id;
                    $model_slave_url->link = $matches_url[1][$key];
                    $model_slave_url->name = $matches_url[2][$key];
                    $model_slave_url->created = time();
                    $model_slave_url->status = 1;

                    if( $model_slave_url->save() )
                    {

                    //$data = Url::model()->findByAttributes(array('website_id' => $model_website->id, 'link' => $matches_url[1][$key], 'name' => $matches_url[2][$key]));
                    $query = "select * from `url` where  ( ( `website_id`='".($model_website->id)."' ) and ( `link`='".($matches_url[1][$key])."' ) ) or (  ( `website_id`='".($model_website->id)."' ) and ( `name` = '".(addslashes($matches_url[2][$key]))."' ) );";
                    echo $query.'<br>';
                    //$command_slave = ;
                    $command = Yii::app()->db->createCommand($query);
                    $data = $command->queryAll();
                    if((count($data)==0) && ($ok === true)) {
                        $model_url = new Url();
                        $model_url->website_id = $model_website->id;
                        $model_url->link = $matches_url[1][$key];
                        $model_url->name = $matches_url[2][$key];
                        $model_url->created = $this->time;
                        $model_url->instance_scanner_id = $instance_scanner->id;
                        $model_url->status = 0;
                        if ($model_url->save())
                            $this->urls++;
                        $command = "INSERT INTO `url` (`id` ,`website_id` ,`link` ,`name` ,`created` ,`instance_scanner_id` ,`status`)VALUES (NULL ,  '".($model_url->website_id)."',  '".($model_url->link)."',  '".(addslashes($model_url->name))."',  '".($model_url->created)."',  '".($model_url->instance_scanner_id)."',  '".($model_url->status)."');";
                    }

                    }

                    }

                }
            echo $this->urls . ' new urls found' . PHP_EOL;
            $instance_scanner->urls = $this->urls;
            $instance_scanner->save();
            echo 'scanner stop';
        }
        else echo 'something went wrong while trying to start the scanning process';
    }

    /**
     * Provides the command description.
     * This method may be overridden to return the actual command description.
     * @return string the command description. Defaults to 'Usage: php entry-script.php command-name'.
     */
    public function getHelp() {
        return 'Usage: how to use this command';
    }

} 
```

这是主要模型：

```
<?php

/**
 * This is the model class for table "url".
 *
 * The followings are the available columns in table 'url':
 * @property string $id
 * @property integer $server_id
 * @property integer $website_id
 * @property integer $slave_url_id
 * @property string $link
 * @property string $name
 * @property integer $created
 * @property integer $instance_scanner_id
 * @property integer $status
 */
class Url extends CActiveRecord
{
    /**
     * Returns the static model of the specified AR class.
     * @param string $className active record class name.
     * @return Url the static model class
     */
    public static function model($className=__CLASS__)
    {
        return parent::model($className);
    }

    /**
     * @return string the associated database table name
     */
    public function tableName()
    {
        return 'url';
    }

    /**
     * @return array validation rules for model attributes.
     */
    public function rules()
    {
        // NOTE: you should only define rules for those attributes that
        // will receive user inputs.
        return array(
            array('server_id, website_id, slave_url_id, link, name, created, instance_scanner_id, status', 'required'),
            array('server_id, website_id, slave_url_id, created, instance_scanner_id, status', 'numerical', 'integerOnly'=>true),
            array('link, name', 'length', 'max'=>255),
            // The following rule is used by search().
            // Please remove those attributes that should not be searched.
            array('id, server_id, website_id, slave_url_id, link, name, created, instance_scanner_id, status', 'safe', 'on'=>'search'),
        );
    }

    /**
     * @return array relational rules.
     */
    public function relations()
    {
        // NOTE: you may need to adjust the relation name and the related
        // class name for the relations automatically generated below.
        return array(
        );
    }

    /**
     * @return array customized attribute labels (name=>label)
     */
    public function attributeLabels()
    {
        return array(
            'id' => 'ID',
            'server_id' => 'Server',
            'website_id' => 'Website',
            'slave_url_id' => 'Slave Url',
            'link' => 'Link',
            'name' => 'Name',
            'created' => 'Created',
            'instance_scanner_id' => 'Instance Scanner',
            'status' => 'Status',
        );
    }

    /**
     * Retrieves a list of models based on the current search/filter conditions.
     * @return CActiveDataProvider the data provider that can return the models based on the search/filter conditions.
     */
    public function search()
    {
        // Warning: Please modify the following code to remove attributes that
        // should not be searched.

        $criteria=new CDbCriteria;

        $criteria->compare('id',$this->id,true);
        $criteria->compare('server_id',$this->server_id);
        $criteria->compare('website_id',$this->website_id);
        $criteria->compare('slave_url_id',$this->slave_url_id);
        $criteria->compare('link',$this->link,true);
        $criteria->compare('name',$this->name,true);
        $criteria->compare('created',$this->created);
        $criteria->compare('instance_scanner_id',$this->instance_scanner_id);
        $criteria->compare('status',$this->status);

        return new CActiveDataProvider($this, array(
            'criteria'=>$criteria,
        ));
    }
} 
```

这是从模型：

```
<?php

/**
 * This is the model class for table "url".
 *
 * The followings are the available columns in table 'url':
 * @property string $id
 * @property integer $website_id
 * @property string $link
 * @property string $name
 * @property integer $created
 * @property integer $status
 */
class SlaveUrl extends HActiveRecord
{
    /**
     * Returns the static model of the specified AR class.
     * @param string $className active record class name.
     * @return Url the static model class
     */
    public static function model($className=__CLASS__)
    {
        return parent::model($className);
    }

    /**
     * @return string the associated database table name
     */
    public function tableName()
    {
        return 'url';
    }

    /**
     * @return array validation rules for model attributes.
     */
    public function rules()
    {
        // NOTE: you should only define rules for those attributes that
        // will receive user inputs.
        return array(
            array('website_id, link, name, created, status', 'required'),
            array('website_id, created, status', 'numerical', 'integerOnly'=>true),
            array('link, name', 'length', 'max'=>255),
            // The following rule is used by search().
            // Please remove those attributes that should not be searched.
            array('id, website_id, link, name, created, status', 'safe', 'on'=>'search'),
        );
    }

    /**
     * @return array relational rules.
     */
    public function relations()
    {
        // NOTE: you may need to adjust the relation name and the related
        // class name for the relations automatically generated below.
        return array(
        'relation_website'=>array(self::BELONGS_TO,'Website','website_id'),
        );
    }

    /**
     * @return array customized attribute labels (name=>label)
     */
    public function attributeLabels()
    {
        return array(
            'id' => 'ID',
            'website_id' => 'Website',
            'link' => 'Link',
            'name' => 'Name',
            'created' => 'Created',
            'status' => 'Status',
        );
    }

    /**
     * Retrieves a list of models based on the current search/filter conditions.
     * @return CActiveDataProvider the data provider that can return the models based on the search/filter conditions.
     */
    public function search()
    {
        // Warning: Please modify the following code to remove attributes that
        // should not be searched.

        $criteria=new CDbCriteria;

        $criteria->compare('id',$this->id,true);
        $criteria->compare('website_id',$this->website_id);
        $criteria->compare('link',$this->link,true);
        $criteria->compare('name',$this->name,true);
        $criteria->compare('created',$this->created);
        $criteria->compare('status',$this->status);

        return new CActiveDataProvider($this, array(
            'criteria'=>$criteria,
        ));
    }
} 
```

以及分配正确的从数据库连接的特殊类：

```
<?php

class HActiveRecord extends CActiveRecord

{

public static $server_id=1;
   public static $master_db;

   public function getDbConnection()

   {

         self::$master_db=Yii::app()->{"db".self::$server_id};      

         if(self::$master_db instanceof CDbConnection)

         {

            self::$master_db->setActive(true);

            return self::$master_db;

         }

         else

            throw new CDbException(Yii::t('yii','Active Record requires a "db" CDbConnection application component.'));

   }

   public function getDbConnection2()

   {

      if(self::$master_db!==null)

         return self::$master_db;

      else

      {

         self::$master_db=Yii::app()->db1;

                 echo self::$master_db->connectionString;

         if(self::$master_db instanceof CDbConnection)

         {

            self::$master_db->setActive(true);

            return self::$master_db;

         }

         else

            throw new CDbException(Yii::t('yii','Active Record requires a "db" CDbConnection application component.'));

      }

   }

}

?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T19:52:37.447

在 SlaveUrl 或 HActiveRecord 或 CActiveRecord 类中没有名为 findByUrl() 的方法，这是导致错误的原因。

虽然有 findBySql。[http://www.yiiframework.com/doc/api/1.1/CActiveRecord#findBySql-detail](http://www.yiiframework.com/doc/api/1.1/CActiveRecord#findBySql-detail)。

# php - 如何将多个选项列表框选项插入mysql数据库

> ID：13128547
> 
> 赞同：0
> 
> 时间：2012-10-29T19:47:21.197
> 
> 标签：php, mysql, arrays, listbox

我有一个包含不同输入字段的表单，例如文本字段、下拉列表和多选列表框。多选列表框不会添加到数据库中。请帮忙

```
 <form action = "A.php" method ="POST" enctype="multipart/form-data">
                     <fieldset>

                      <p>`Job Description:
                        <select name="DutiesDesc[]" size=5 multiple="multiple">
                            <option value="$Arow['TextF1']"><?php echo $Arow['TextF1']?></option>
                            <option value="$Arow['TextF2']"><?php echo $Arow['TextF2']?></option>
                            <option value="$Arow['TextF3']"><?php echo $Arow['TextF3']?></option>
                            <option value="$Arow['TextF4']"><?php echo $Arow['TextF4']?></option>
                            <option value="$Arow['TextF5']"><?php echo $Arow['TextF5']?></option>
                            <option value="$Arow['TextF6']"><?php echo $Arow['TextF6']?></option>
                            <option value="$Arow['TextF7']"><?php echo $Arow['TextF7']?></option>
                            <option value="$Arow['TextF8']"><?php echo $Arow['TextF8']?></option>
                            <option value="$Arow['TextF9']"><?php echo $Arow['TextF9']?></option>
                            <option value="$Arow['TextF10']"><?php echo $Arow['TextF10']?></option>` 
```

以下部分是A.php

```
 //Check if selections were made
    if (isset($_POST['DutiesDesc']))
    {

        $SkillsArray = $_POST['DutiesDesc'];
        foreach($SkillsArray as $key =>$value )
        {
            $Sentence = join(" ",$value);
        }

    }
    $StartDate = clean($_REQUEST['StartDate']); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T07:17:28.567

您必须在 foreach 循环中执行插入查询。

```
foreach($SkillsArray as $key =>$value )
{
    // Insert query goes here
} 
```

此外，您的列表框值也不会被 PHP 解析。

```
<option value="$Arow['TextF1']"><?php echo $Arow['TextF1']?></option> 
```

应该

```
<option value="<?php echo $Arow['TextF1']?>"><?php echo $Arow['TextF1']?></option> 
```

# javascript - SharePoint 2010 SocialDataService - 安全验证无效

> ID：13128549
> 
> 赞同：3
> 
> 时间：2012-10-29T19:47:57.000
> 
> 标签：javascript, sharepoint

我正在使用 javascript 运行一些 Web 服务 (SharePoint 2010 SocialDataServices)。我已经测试了“CountCommentsOnURL”命令没有任何问题，但是当我尝试使用例如“AddComment”命令时，我收到以下错误：

“服务器无法处理请求。此页面的安全验证无效。在 Web 浏览器中单击返回，刷新页面，然后重试操作。此页面的安全验证无效。在 Web 浏览器中单击返回，刷新页面，然后再次尝试您的操作。”

浏览互联网，我看到了一些关于关闭某些安全设置的文章——这对我来说不是一个选项。显然，刷新页面也不起作用。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-30T16:08:36.643

以下示例演示了如何在客户端通过 SocialDataServices 服务发表评论：

示例 1\. 添加评论

```
//url parameter corresponds to Page Url
//comment parameter 
function addComment(url,comment)
{
     var soapEnv =
        "<soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'> \
              <soap:Body>    \
                    <AddComment xmlns='http://microsoft.com/webservices/SharePointPortalServer/SocialDataService'> \
                                <url>" + url + "</url> \
                                <comment>" + comment + "</comment> \
                                <isHighPriority>false</isHighPriority> \
                                <title></title> \
                     </AddComment> \
              </soap:Body> \
         </soap:Envelope>";

    $.ajax({
        result: result,
        url: _spPageContextInfo.webServerRelativeUrl + "/_vti_bin/SocialDataService.asmx",
        type: "POST",
        dataType: "xml",
        data: soapEnv,
        contentType: "text/xml; charset=\"utf-8\"",
        beforeSend: function (xhr) {
                        xhr.setRequestHeader("SOAPAction", "http://microsoft.com/webservices/SharePointPortalServer/SocialDataService/AddComment");
                },
        success: function(data, status, xhr){
           //..
        }
    });
} 
```

示例 2\. 使用[SPServices 库添加注释](http://spservices.codeplex.com/)

```
function addComment(url,comment)
{

   $().SPServices({
        operation: "AddComment",
        url: url,
        title:'',
        comment:comment,
        completefunc: function (xData, Status) {
           console.log($(xData.responseXML));
        }
    });
} 
```

用法：

```
addComment('http://intranet.contoso.com/pages/somenews.aspx','new comment goes here'); 
```

# c# - 对 WPF 控件的线程安全调用

> ID：13128550
> 
> 赞同：1
> 
> 时间：2012-10-29T19:48:03.670
> 
> 标签：c#, wpf, xaml, stackpanel

我只是在使用 WPF 和 C# 编写我的第一个程序。我的窗口只包含一个简单的画布控件：

```
<StackPanel Height="311" HorizontalAlignment="Left" Name="PitchPanel" VerticalAlignment="Top" Width="503" Background="Black" x:FieldModifier="public"></StackPanel> 
```

这工作正常，从`Window.Loaded`事件中我可以访问这个名为`PitchPanel`.

现在我添加了一个名为的类`Game`，它的初始化如下：

```
public Game(System.Windows.Window Window, System.Windows.Controls.Canvas Canvas)
{
    this.Window = Window;
    this.Canvas = Canvas;
    this.GraphicsThread = new System.Threading.Thread(Draw);
    this.GraphicsThread.SetApartmentState(System.Threading.ApartmentState.STA);
    this.GraphicsThread.Priority = System.Threading.ThreadPriority.Highest;
    this.GraphicsThread.Start();
    //...
} 
```

如您所见，有一个名为`GraphicsThread`. 这应该以尽可能高的速率重绘当前游戏状态，如下所示：

```
private void Draw() //and calculate
{
   //... (Calculation of player positions occurs here)
   for (int i = 0; i < Players.Count; i++)
   {
       System.Windows.Shapes.Ellipse PlayerEllipse = new System.Windows.Shapes.Ellipse();
       //... (Modifying the ellipse)
       Window.Dispatcher.Invoke(new Action(
       delegate()
       {
           this.Canvas.Children.Add(PlayerEllipse);
       }));
    }
} 
```

但是，尽管我使用了由在创建游戏实例时传递的主窗口调用的调度程序，但发生了未处理的异常：`[System.Reflection.TargetInvocationException]`，内部异常说我无法访问该对象，因为它由另一个线程拥有（主线程）。

游戏在应用程序的 Window_Loaded-event 中初始化：

```
GameInstance = new TeamBall.Game(this, PitchPanel); 
```

[我认为这与此答案](https://stackoverflow.com/a/2127027/778421)中给出的原则相同。

那么为什么这不起作用呢？有人知道如何从另一个线程调用控件吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T20:04:25.077

您不能在不同的线程上创建 WPF 对象 - 它也必须在 Dispatcher 线程上创建。

这个：

```
System.Windows.Shapes.Ellipse PlayerEllipse = new System.Windows.Shapes.Ellipse(); 
```

必须进入委托。

# iphone - UIBarButtonItem 不显示

> ID：13128551
> 
> 赞同：0
> 
> 时间：2012-10-29T19:48:08.727
> 
> 标签：iphone, objective-c, ios

为什么这个不显示？我尝试了模拟器 5.1 和 6.0。最近有什么变化吗？

```
UIBarButtonItem* rightBarButtonItem = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemPageCurl target:self action:@selector(openGasMileage)];

self.navigationItem.rightBarButtonItem = rightBarButtonItem; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T19:58:30.730

由于 >= ios5 sdk 中不存在默认 curl 图像，因此您必须使用自己的图像：

```
- (UIBarButtonItem *) rightBarButtonItem {
    if (_rightBarButtonItem == nil) {
    UIButton *rightButton = [[UIButton alloc] initWithFrame:CGRectMake(0, 0, 50, 50)];
    [rightButton setImage:[UIImage imageNamed:@"edit.png"] forState:UIControlStateNormal];
    [rightButton addTarget:self action:@selector(own) forControlEvents:UIControlEventTouchUpInside];
    _rightBarButtonItem = [[UIBarButtonItem alloc] initWithCustomView:rightButton];
    }
return _rightBarButtonItem;
}

self.navigationItem.rightBarButtonItem = self.rightBarButtonItem; 
```

另见：[卷曲项目](http://blog.shuningbian.net/2011/01/ios-toolbar-pagecurl-icon.html)

# java - 如何扫描类的注释？

> ID：13128552
> 
> 赞同：21
> 
> 时间：2012-10-29T19:48:16.167
> 
> 标签：java, servlets, guice, guava

我有一个普通的 jane servlets web 应用程序，我的一些类有以下注释：

```
@Controller
@RequestMapping(name = "/blog/")
public class TestController {
..

} 
```

现在，当我的 servlet 应用程序启动时，我想获取所有具有 @Controller 注释的类的列表，然后获取 @RequestMapping 注释的值并将其插入字典中。

我怎样才能做到这一点？

我也在使用 Guice 和 Guava，但不确定是否有任何与注释相关的助手。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-10-29T20:10:07.723

您可以通过向其提供您正在寻找的包和注释来使用[Reflections 库。](https://github.com/ronmamo/reflections)

```
Reflections reflections = new Reflections("my.project.prefix");
Set<Class<?>> annotated = reflections.getTypesAnnotatedWith(Controller.class);

for (Class<?> controller : annotated) {
    RequestMapping request = controller.getAnnotation(RequestMapping.class);
    String mapping = request.name();
} 
```

当然，将所有 servlet 放在同一个包中会更容易一些。此外，您可能想要查找具有`RequestMapping`注释的类，因为这是您要从中获取值的类。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-29T19:55:06.833

扫描注释非常困难。您实际上必须处理所有类路径位置并尝试查找与 Java 类 (*.class) 对应的文件。

我强烈建议使用提供此类功能的框架。例如，您可以看看[Scannotation](http://scannotation.sourceforge.net/)。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2019-05-28T10:01:34.697

如果您使用的是 Spring，

它有一个叫做`AnnotatedTypeScanner`类的东西。
这个类内部使用

```
ClassPathScanningCandidateComponentProvider 
```

此类具有用于实际扫描**类路径**资源的代码。它通过使用运行时可用的类元数据来做到这一点。

可以简单地扩展此类或使用相同的类进行扫描。下面是构造函数定义。

```
 /**
     * Creates a new {@link AnnotatedTypeScanner} for the given annotation types.
     * 
     * @param considerInterfaces whether to consider interfaces as well.
     * @param annotationTypes the annotations to scan for.
     */
    public AnnotatedTypeScanner(boolean considerInterfaces, Class<? extends Annotation>... annotationTypes) {

        this.annotationTypess = Arrays.asList(annotationTypes);
        this.considerInterfaces = considerInterfaces;
    } 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-05-19T21:41:13.127

试试玉米cps

```
List<Class<?>> classes = CPScanner.scanClasses(new PackageNameFilter("net.sf.corn.cps.*"),new ClassFilter().appendAnnotation(Controller.class));
for(Class<?> clazz: classes){
   if(clazz.isAnnotationPresent(RequestMapping.class){
     //This is what you want
   }
} 
```

Maven模块依赖：

```
<dependency>
    <groupId>net.sf.corn</groupId>
    <artifactId>corn-cps</artifactId>
    <version>1.0.1</version>
</dependency> 
```

访问网站[https://sites.google.com/site/javacornproject/corn-cps](https://sites.google.com/site/javacornproject/corn-cps)了解更多信息

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-09-18T04:25:51.587

以下代码对我有用，以下示例使用 Java 11 和 spring ClassPathScanningCandidateComponentProvider。用法是查找所有使用@XmlRootElement 注释的类

```
public static void main(String[] args) throws ClassNotFoundException {
    var scanner = new ClassPathScanningCandidateComponentProvider(false);
    scanner.addIncludeFilter(new AnnotationTypeFilter(XmlRootElement.class));

    //you can loop here, for multiple packages
    var beans = scanner.findCandidateComponents("com.example");
    for (var bean : beans) {
        var className = bean.getBeanClassName();
        Class clazz = Class.forName(className);
        //creates initial JAXBContext for later usage
        //JaxbContextMapper.get(clazz);
        System.out.println(clazz.getName());
    }
} 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2019-06-13T15:19:43.480

除了直接使用反射之外，您还可以使用 Google Guice 的 AOP 库来简化您的工作。AOP 是实现应用程序的横切关注点的常用方法，例如日志记录/跟踪、事务处理或权限检查。

你可以在这里阅读更多关于它的信息：[https ://github.com/google/guice/wiki/AOP](https://github.com/google/guice/wiki/AOP)

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2012-10-29T20:04:51.823

如果您可以访问 .class 文件，则可以使用以下类获取注释：

```
 RequestMapping reqMapping =  
                         TestController.class.getAnnotation(RequestMapping.class);
  String name = reqMapping.name(); //now name shoud have value as "/blog/" 
```

另请确保，您的课程标记`RetentionPolicy`为`RUNTIME`

```
 @Retention(RetentionPolicy.RUNTIME) 
```

# r - 如何在R中的$$之间放置数字？

> ID：13128557
> 
> 赞同：4
> 
> 时间：2012-10-29T19:48:31.150
> 
> 标签：r

我想使用`xtable`包将 R 输出导出到 LaTex。

因为我想使用波斯字体，所以我应该将数字放在 $$ 之间。我怎样才能在 R 中做到这一点？

T 尝试过`as.character`，但 xtable 不适用于它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T04:45:02.310

使用`sanitize.text.fuction`参数`print.xtable`：

```
df <- data.frame(foo=paste0("$",1:10,"$"))
library("xtable")
print(xtable(df),sanitize.text.function=identity) 
```

给出：

```
% latex table generated in R 2.15.1 by xtable 1.7-0 package
% Tue Oct 30 05:44:05 2012
\begin{table}[ht]
\begin{center}
\begin{tabular}{rl}
  \hline
 & foo \\ 
  \hline
1 & $1$ \\ 
  2 & $2$ \\ 
  3 & $3$ \\ 
  4 & $4$ \\ 
  5 & $5$ \\ 
  6 & $6$ \\ 
  7 & $7$ \\ 
  8 & $8$ \\ 
  9 & $9$ \\ 
  10 & $10$ \\ 
   \hline
\end{tabular}
\end{center}
\end{table} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T20:04:41.997

我不知道如何`xtable`用.`latex``Hmisc`

# c# - iTextSharp 打印可变长度文档

> ID：13128560
> 
> 赞同：0
> 
> 时间：2012-10-29T19:48:40.173
> 
> 标签：c#, printing, report, itextsharp

在尝试了尽可能多的可能性但没有成功的结果之后，这是我关于 iTextsharp 组件的问题。我需要创建一张我决定使用**iTextSharp Library**的票。

我在 java & .net 项目中使用了这个库，文件长度固定，没有问题，但在这种情况下，*文件是可变长度*的。该文档是根据规范完美创建的。创建 PDF 后，我使用`System.Diagnostics.Process`动词“<strong>PrintTo”将其发送到打印机。由于票证的可变长度性质，在打印机上设置固定的纸张长度是不够的，所以我使用以下行来指示打印机采用文档大小（*相应地与 Manning iText in Action 2nd Edition，第 140 页*) 但它似乎无法正常运行。

```
writer.AddViewerPreference(PdfName.PICKTRAYBYPDFSIZE, new PdfBoolean(true)); 
```

关于如何将文档发送到打印机指示打印机将纸张尺寸调整为文档尺寸的任何想法？

提前致谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T01:03:57.960

通过使用`GhostScript`(GHS) 和`mswinpr2`作为打印设备，我们几乎可以打印到任何可用于操作系统 (Windows) 的打印机。

要确定纸张大小，在调用 GHS 命令行实用程序 (gswin32c) 时需要设置以下参数：

> *   固定媒体
> *   dDEVICEWIDTHPOINTS = 值
> *   dDEVICEHEIGHTPOINTS = 值
> *   sOutputFile = "%printer%PRINTER_NAME"

# entity-framework - 导入后无法将货币字段添加到实体

> ID：13128563
> 
> 赞同：2
> 
> 时间：2012-10-29T19:48:55.963
> 
> 标签：entity-framework, dynamics-crm-2011

在我们的 DEV 环境中创建了一个自定义实体。它最初有一个 Currency 字段，但为了简单起见，我们决定删除它并使用 Float 字段。首次导出解决方案并将其导入 QA 后，我无法再向 QA 中的实体添加 Currency 字段（并且 DEV 中的“剩余”transactioncurrencyid 列没有迁移到 QA）。

主要问题是我无法删除 transactioncurrencyid 列，现在我的筛选视图在 DEV 和 QA 之间有所不同，这导致我们依赖实体框架的 SharePoint BCS 进程失败。

有没有办法在不重新创建实体的情况下完全删除货币字段？

计划 B：有没有办法从备份中恢复实体的过去副本（在移除货币之前）并将其合并到我们目前损坏的版本中？

计划 C：任何其他想法（将 EF 转换为使用存储过程等）？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T02:22:10.547

MSFT 批准的解决方案涉及手动删除：

1.  基表中的 ExchangeRate 列（例如，alter...drop column exchangerate）
2.  在系统表中引用属性 GUID 的行：属性、localizedlabel、AttributeIds（例如，从 tbl 中删除，其中 AttributeId = guid）
3.  更改实体的视图以删除 ExchangeRate 列（不是过滤的）

通过在 CRM 中打开 ExchangeRate 字段并按 F11 从查询字符串中提取 AttributeID 来查找步骤 2 中的 GUID。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T13:01:18.663

再次将实体从 Dev 导出到 QA。CRM 将看到已添加一列，并将其添加到 QA 中的实体。

## 编辑 1

那么这是 QA 中的非托管解决方案吗？您应该能够通过自定义解决方案界面将字段添加到 QA 中的实体。

# python - Python中的字符串拆分

> ID：13128565
> 
> 赞同：4
> 
> 时间：2012-10-29T19:49:02.263
> 
> 标签：python, string, split, delimiter

有没有办法在 Python 中使用多个分隔符而不是一个分隔符来拆分字符串？`split`似乎只接受一个参数作为分隔符。

另外，我无法导入`re`模块。（这确实是主要的绊脚石。）

关于我应该如何做的任何建议？

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-29T19:54:33.700

为了在多个序列上拆分，您可以简单地用一个序列替换您需要拆分的所有序列，然后在那个序列上拆分。

所以

```
s = s.replace("z", "s")
s.split("s") 
```

将在 s 和 z 上分裂。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T20:41:17.500

Generic approach for a list of splitters, please, someone can write this with less code?

**Initializing vars:**

```
>>> splits = ['.', '-', ':', ',']
>>> s='hola, que: tal. be' 
```

**Splitting:**

```
>>> r = [ s ]
>>> for p in splits:
...    r =  reduce(lambda x,y: x+y, map(lambda z: z.split(p), r )) 
```

**Results:**

```
>>> r
['hola', ' que', ' tal', ' be'] 
```

# python - 从数据库加载压缩的 python 模块

> ID：13128572
> 
> 赞同：0
> 
> 时间：2012-10-29T19:49:14.263
> 
> 标签：python, module, python-2.7

我有一个结构如下的 Python 模块：

```
demo/
├── __init__.py
├── app.py
├── models.py
├── modules.py 
```

现在我想压缩这个模块并将其存储到数据库中。

我将如何加载这样的结构化包？虽然加载单个`.py`文件并使用其功能没有问题，但我不知道如何处理包。在这种情况下，从和`app.py`导入。`models.py``modules.py`

使用这种方法时，它`app.py`首先加载并抛出异常，因为它没有加载其他 2 个文件。

```
import new
code = <the code from the db>
mod = new.module('foo')
exec code in mod.__dict__
sys.modules['foo'] = mod 
```

这是如何正确完成的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T23:24:55.223

我相信您正在寻找的是创建查找器和加载器类，Doug Hellmann 在其中一篇 PyMOTW 帖子中进行了描述：

[http://www.doughellmann.com/PyMOTW/sys/imports.html](http://www.doughellmann.com/PyMOTW/sys/imports.html)

尽管可能需要阅读 Doug 的完整帖子，但从数据库存储和加载多文件模块的示例的核心内容在使用 Python 数据库“搁置”的部分：

[http://www.doughellmann.com/PyMOTW/sys/imports.html#importing-from-a-shelve](http://www.doughellmann.com/PyMOTW/sys/imports.html#importing-from-a-shelve)

# wso2 - Wso2 中介中的自定义错误处理程序

> ID：13128574
> 
> 赞同：0
> 
> 时间：2012-10-29T19:49:18.433
> 
> 标签：wso2, mediator, wso2carbon

在我的顺序中介中，我需要对输入值处理一些逻辑，并基于此决定是调用 Web 服务还是返回故障。我已将序列定义如下

```
<sequence xmlns="http://ws.apache.org/ns/synapse" name="m1">
    <class name="com.myclass">
    </class>
    <makefault version="soap11">
        <code xmlns:soap11Env="http://schemas.xmlsoap.org/soap/envelope/" value="soap11Env:Client"/>
        <reason value="ERROR_MESSAGE"/>
        <role>Acc</role>
        <detail>Test Details</detail>
    </makefault>
    <log/>
</sequence> 
```

问题是默认情况下 web 服务总是将故障信息传递给 web 服务。我如何做到以下几点 1\. Incase 在 Mediator 中引发自定义异常，soap 错误将被抛出回 web 服务客户端。2.如果所有信息都正确，则Web服务被正确调用并且客户端得到正确的响应。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T04:31:56.613

您需要定义一个单独的序列来处理故障。然后，在您的 InSequence 中，您需要将该故障序列设置为“onError”属性。所以你的 InSequence 看起来像

```
<sequence xmlns="http://ws.apache.org/ns/synapse" name="m1" onError="yourFaultSequence">
    <class name="com.myclass">
    </class>
    <log/>
    <send/>
</sequence> 
```

添加了上面的配置以给出一个想法。注意**onError**属性。 [以下示例](http://docs.wso2.org/wiki/display/ESB450/Sample+5%3a+Creating+SOAP+Fault+Messages+and+Changing+the+Direction+of+a+Message)也将有所帮助。

# delphi - 为什么包含 500 个组件的表单很慢？

> ID：13128578
> 
> 赞同：7
> 
> 时间：2012-10-29T19:49:30.910
> 
> 标签：delphi

我正在创建一个表格，其中有图标 - 比如桌面上的图标，它们可以自由移动。我有时甚至想显示 500 个或更多的图标，所以它们需要快速工作。我的图标是：

> TMyIcon = 类（TGraphicControl）

所以它没有 Windows 句柄。图纸是：

> *   1 x Canvas.Rectangle（大约 64x32）
> *   1 x Canvas.TextOut（比矩形小一点）
> *   1 x Canvas.Draw（图像为 32x32）

移动东西的代码是这样的：MyIconMouseMove：

```
Ico.Left := Ico.Left + X-ClickedPos.X;
Ico.Top  := Ico.Top  + Y-ClickedPos.Y; 
```

在表单上通常有 50 个左右的图标——其余的都在可见区域之外。当我有 100 个图标时，我可以自由移动它们，而且效果很快。但是当我创建 500 个图标时，它会变得迟钝 - 但可见图标的数量仍然相同。我如何告诉 Windows 完全忽略不可见的图标，以便一切顺利？

或者也许有一个组件可以显示类似桌面的图标并且能够移动它们？像 AutoArrange = False 的 TShellListView 之类的东西？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-30T13:11:32.713

TGraphicControl 是一个没有自己的句柄的控件。它使用其父级来显示其内容。这意味着，更改控件的外观也会强制重绘父控件。这也可能触发重新绘制所有其他控件。

理论上，只有控件 X 所在的父级部分需要失效，因此只有与该部分重叠的控件才需要重新绘制。但是，这可能会导致连锁反应，导致每次更改其中一个控件中的单个像素时都会调用许多绘制方法。

显然，可见区域之外的图标也被重新绘制。我认为您可以通过将图标的 Visible 属性设置为 False 如果它们在可见区域之外来优化它。

如果这不起作用，您可能需要一种完全不同的方法：可以选择在单个控件上绘制所有图标，从而允许您缓冲图像。如果您正在拖动一个图标，您可以在位图上绘制所有其他图标一次。在每次鼠标移动时，您只需要绘制缓冲位图和拖动的单个图标，而不是 100（或 500）个单独的图标。这应该会加快速度，尽管需要更多的努力来开发。

你可以像这样实现它：

```
type
  // A class to hold icon information. That is: Position and picture
  TMyIcon = class
    Pos: TPoint;
    Picture: TPicture;
    constructor Create(Src: TBitmap);
    destructor Destroy; override;
  end;

  // A list of such icons
  //TIconList = TList<TMyIcon>;
  TIconList = TList;

  // A single graphic controls that can display many icons and 
  // allows dragging them
  TIconControl = class(TGraphicControl)
    Icons: TIconList;
    Buffer: TBitmap;
    DragIcon: TMyIcon;

    constructor Create(AOwner: TComponent); override;
    destructor Destroy; override;

    procedure Initialize;
    // Painting
    procedure ValidateBuffer;
    procedure Paint; override;
    // Dragging
    function IconAtPos(X, Y: Integer): TMyIcon;
    procedure MouseDown(Button: TMouseButton; Shift: TShiftState;
      X, Y: Integer); override;
    procedure MouseMove(Shift: TShiftState; X, Y: Integer); override;
    procedure MouseUp(Button: TMouseButton; Shift: TShiftState;
      X, Y: Integer); override;
  end;

{ TMyIcon }

// Some random initialization 
constructor TMyIcon.Create(Src: TBitmap);
begin
  Picture := TPicture.Create;
  Picture.Assign(Src);
  Pos := Point(Random(500), Random(400));
end;

destructor TMyIcon.Destroy;
begin
  Picture.Free;
  inherited;
end; 
```

然后，图形控件本身：

```
{ TIconControl }

constructor TIconControl.Create(AOwner: TComponent);
begin
  inherited;
  Icons := TIconList.Create;
end;

destructor TIconControl.Destroy;
begin
  // Todo: Free the individual icons in the list.
  Icons.Free;
  inherited;
end;

function TIconControl.IconAtPos(X, Y: Integer): TMyIcon;
var
  r: TRect;
  i: Integer;
begin
  // Just return the first icon that contains the clicked pixel.
  for i := 0 to Icons.Count - 1 do
  begin
    Result := TMyIcon(Icons[i]);
    r := Rect(0, 0, Result.Picture.Graphic.Width, Result.Picture.Graphic.Height);
    OffsetRect(r, Result.Pos.X, Result.Pos.Y);
    if PtInRect(r, Point(X, Y)) then
      Exit;
  end;
  Result := nil;
end;

procedure TIconControl.Initialize;
var
  Src: TBitmap;
  i: Integer;
begin
  Src := TBitmap.Create;
  try
    // Load a random file.
    Src.LoadFromFile('C:\ff\ff.bmp');

    // Test it with 10000 icons.
    for i := 1 to 10000 do
      Icons.Add(TMyIcon.Create(Src));

  finally
    Src.Free;
  end;
end;

procedure TIconControl.MouseDown(Button: TMouseButton; Shift: TShiftState; X,
  Y: Integer);
begin
  if Button = mbLeft then
  begin
    // Left button is clicked. Try to find the icon at the clicked position
    DragIcon := IconAtPos(X, Y);
    if Assigned(DragIcon) then
    begin
      // An icon is found. Clear the buffer (which contains all icons) so it
      // will be regenerated with the 9999 not-dragged icons on next repaint.
      FreeAndNil(Buffer);

      Invalidate;
    end;
  end;
end;

procedure TIconControl.MouseMove(Shift: TShiftState; X, Y: Integer);
begin
  if Assigned(DragIcon) then
  begin
    // An icon is being dragged. Update its position and redraw the control.
    DragIcon.Pos := Point(X, Y);

    Invalidate;
  end;
end;

procedure TIconControl.MouseUp(Button: TMouseButton; Shift: TShiftState; X,
  Y: Integer);
begin
  if (Button = mbLeft) and Assigned(DragIcon) then
  begin
    // The button is released. Free the buffer, which contains the 9999
    // other icons, so it will be regenerated with all 10000 icons on
    // next repaint.
    FreeAndNil(Buffer);
    // Set DragIcon to nil. No icon is dragged at the moment.
    DragIcon := nil;

    Invalidate;
  end;
end;

procedure TIconControl.Paint;
begin
  // Check if the buffer is up to date.
  ValidateBuffer;

  // Draw the buffer (either 9999 or 10000 icons in one go)
  Canvas.Draw(0, 0, Buffer);

  // If one ican was dragged, draw it separately.
  if Assigned(DragIcon) then
    Canvas.Draw(DragIcon.Pos.X, DragIcon.Pos.Y, DragIcon.Picture.Graphic);
end;

procedure TIconControl.ValidateBuffer;
var
  i: Integer;
  Icon: TMyIcon;
begin
  // If the buffer is assigned, there's nothing to do. It is nilled if
  // it needs to be regenerated.
  if not Assigned(Buffer) then
  begin
    Buffer := TBitmap.Create;
    Buffer.Width := Width;
    Buffer.Height := Height;
    for i := 0 to Icons.Count - 1 do
    begin
      Icon := TMyIcon(Icons[i]);
      if Icon <> DragIcon then
        Buffer.Canvas.Draw(Icon.Pos.X, Icon.Pos.Y, Icon.Picture.Graphic);
    end;
  end;
end; 
```

创建其中一个控件，使其填充表单并使用 10000 个图标对其进行初始化。

```
procedure TForm1.FormCreate(Sender: TObject);
begin
  DoubleBuffered := True;

  with TIconControl.Create(Self) do
  begin
    Parent := Self;
    Align := alClient;
    Initialize;
  end;
end; 
```

这有点快和脏，但它表明这个解决方案可能工作得很好。如果您开始拖动（鼠标向下），您会注意到一个小的延迟，因为 10000 个图标被绘制在位图上，通过缓冲区。之后，拖动时没有明显的延迟，因为每次重绘只绘制两个图像（而不是在您的情况下为 500 个）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T02:24:50.370

您可能想查看此控件，这正是您所要求的。

[来自 RMKlever 的 rkView](http://rmklever.com/?page_id=299)

它基本上是一个带有滚动等功能的图标或照片缩略图查看器。

# html-lists - CSS UL/LI 菜单未居中

> ID：13128582
> 
> 赞同：3
> 
> 时间：2012-10-29T19:49:53.687
> 
> 标签：html-lists, css

我的 CSS UL 菜单似乎不想居中，有什么想法吗？我已经粘贴了下面的代码供您查看，我对 CSS 很陌生，因此非常感谢您的帮助 :-)

我能够将其居中的唯一方法是固定宽度并使用 html 中心标签，但我需要菜单处于 100% 以进行扩展，并且我需要自动居中。

CSS

```
#menu{
    width:100%;
    margin: 0;
    padding: 5px 0 0 0;
    list-style: none;
    background-color:#333333;
    text-align:center;
}

#menu li{
    float: left;
    padding: 0 0 5px 0;
    position: relative;
    list-style:none;
    margin:auto;
}

#menu ul{
        list-style:none;
        display:inline;
        margin: 0;
        padding: 0;
        text-align: center;
}

#menu a{
    float: left;
    height: 15px;
    padding: 0 25px;
    color:#FFF;
    text-transform: uppercase;
    font: 10px/25px Arial, Helvetica;
    text-decoration: none;
    text-shadow: 0 0px 0 #000;
}

#menu li:hover > a{
    color:#F90;

    font: bold 10px/25px Arial, Helvetica;
}

*html #menu li a:hover{ /* IE6 */
    color: #F06;
}

#menu li:hover > ul{
    display: block;
} 
```

再次感谢 ：-）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-29T19:52:17.633

为您提供宽度`menu`并使用`margin: auto;`

```
#menu{
    width:300px; <--------Here
    margin: 0 auto; <-----Here
    padding: 5px 0 0 0;
    list-style: none;
    background-color:#333333;
    text-align:center;
} 
```

此外，你为什么要这样做？

```
#menu li:hover > ul{
    display: block;
} 
```

还有这个

```
#menu a{
    float: left;
    ....
} 
```

更新：只需阅读您的级联看起来很混乱的所有样式，使用以下

```
#menu { /* I Assume this ID is applied to <ul> element */
    width:/*Whatever you want to define*/;
    margin: 0 auto; <---Change Here
    padding: 5px 0 0 0;
    list-style-type: none;  <---Change Here
    background-color:#333333;
    text-align:center;
}

#menu li{
    float: left; <---You don't need this
    padding: 0 0 5px 0;
    position: relative; <---You don't need this too
    list-style:none; <---You don't need this too
    margin:auto; <---You don't need this too
}

/* Take out this entirely from here */
#menu ul{
        list-style:none;
        display:inline;
        margin: 0;
        padding: 0;
        text-align: center;
}
/* till here */

#menu a{
    float: left; <---You don't need this
    height: 15px;
    padding: 0 25px;
    color:#FFF;
    text-transform: uppercase;
    font: 10px/25px Arial, Helvetica;
    text-decoration: none;
    text-shadow: 0 0px 0 #000;
}

#menu li:hover > a{
    color:#F90;

    font: bold 10px/25px Arial, Helvetica;
}

*html #menu li a:hover{ /* IE6 */
    color: #F06;
}

#menu li:hover > ul{
    display: block;
} 
```

如果您希望菜单内的链接也居中，只需使用此

HTML

```
<ul id="#menu">
  <li></li>
</ul> 
```

CSS

```
#menu li {
  text-align: center;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T19:54:02.480

推杆

```
text-align:center; 
```

in ul 表示 ul 中的文本居中。您应该添加：

```
margin-left:auto;
margin-right:auto; 
```

到 ul。这将适用于所有主要浏览器保存 IE。要在 IE 中工作，您需要确保包含 ul 的标签具有

```
text-align:center; 
```

在里面。

# web-services - 将传出的 HTTPS 请求重定向到 HTTP 虚假服务？

> ID：13128583
> 
> 赞同：1
> 
> 时间：2012-10-29T19:49:56.357
> 
> 标签：web-services, testing, https, mocking

我的标题可能过于具体——我很难提出这个问题，因为我没有经常处理网络管理，尤其是 SSL / HTTPS。换句话说，“你为什么不做……”的答案 就像是，“我对……了解不多。”

我正在测试，被测系统 (SUT) 是一个使用[https://graph.facebook.com](https://graph.facebook.com)调用 Facebook API 的 Web 服务。

我在远程机器上设置了一个测试服务器，它将向[http://graph.facebook.com](http://graph.facebook.com)提供页面。我可以使用 SUT 服务器上的主机文件将对[http://graph.facebook.com](http://graph.facebook.com)的请求重定向到测试服务器。当我输入以下内容时，这很好用：

```
curl http://graph.facebook.com 
```

测试服务器接收请求，并返回预期的页面。

但是，如前所述，SUT 不使用 HTTP 站点，而是使用 Facebook API 的 HTTPS 站点（自然而然）。有什么方法可以拦截传出请求并将其重定向到我在另一个站点上运行的 HTTP 服务？我希望能够输入：

```
curl https://graph.facebook.com 
```

并将其重定向到我在测试服务器上运行的虚假 Facebook 服务。我可以在两端配置服务器。

如果这非常困难，我可能还想提出一个功能请求，以便能够更改 Facebook API 请求的 URL。但是，我认为开发人员正在使用预先存在的 Facebook API 模块，这可能不是直截了当的。（好吧，我很好奇并检查了......快速调查表明该 API 支持处理实际 HTTPS 请求的代码的数据注入，因此他必须实现自己的接口版本，以便他可以传入一个可配置的 URL，我可以从代码外部设置 - 但除非真的有必要，否则我仍然宁愿不分散他的注意力）。

如果相关的话，我在端口 80 上使用[asis-server](https://github.com/seomoz/asis)来伪造 Facebook 响应。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T19:40:46.640

我们最终使用的解决方案是测试服务器上的一个服务，它拦截 HTTPS 请求并将它们重定向到 HTTP 服务。我们的运维人员为此使用了[nginx](http://nginx.org/)。

我们仍然不确定这是否可以作为 SUT 的模拟 - 这取决于 SUT 是在验证证书信息还是忽略它。我仍然可能需要要求开发人员实现一个功能来支持模拟。

# c - 我的简短 C 代码中的小错误。为什么？

> ID：13128584
> 
> 赞同：1
> 
> 时间：2012-10-29T19:50:01.350
> 
> 标签：c, floating-point, cs50

我不明白为什么这适用于 90% 的输入，但不适用于其他输入。它的目的是告诉你有多少硬币可以换回来。大多数测试金额都可以正常工作，但如果您输入 4.20（或 4.20 美元），它会返回 23 个硬币……应该是 18 个硬币（16 个硬币和 2 个镍币）。错误在哪里？这是我的代码：

```
#include <stdio.h>
#include <cs50.h>

int main(void){

    float change = 0.00;

    printf("How much change is owed? ");
    change = GetFloat();

    float quarters = change/.25;
    change-= (int)quarters*.25;

    float dimes = change/.10;
    change-= (int)dimes*.10;

    float nickels = change/.05;
    change-= (int)nickels*.05;

    float pennies = (change+.005)/.01;
    change-=(int)pennies*.01;

    int total = (int)quarters+(int)dimes+(int)nickels+(int)pennies;

    printf("%d\n", total);

    return 0;
    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-29T19:55:25.307

最接近的`float`值`4.20`略小于该值（4.19999980926513671875，对于通常的 32 位 IEEE754 `float`s）。因此，从 16 个季度中减去 4 美元后，剩下的金额略小于 0.2。除以 0.1 得到的值略小于 2，所以你的`nickels`值是 1。同样的情况在你减去镍之后，值略小于 0.1，除以 0.05 得到的商略小于 2。

您应该仅将整数用于此类计算，以美分计算。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-29T20:01:10.640

抛出浮点计算。这完全基于百分之一，所以只需使用整数除法/模数。**永远不要**依赖浮点数的完美准确性。

```
#include <stdio.h>
#include <cs50.h>

int main(void){

    float fchange = 0.00;
    int change = 0;

    printf("How much change is owed? ");
    fchange = GetFloat();

    change = (int)roundf(fchange*100.0);

    int quarters = change/25;
    change = change % 25;

    int dimes = change/10;
    change = change % 10;

    int nickels = change/5;
    change = change % 5;

    printf("%d quarters, %d dimes, %d nickels, %d pennies\n", quarters, dimes, nickels, change);

    return 0;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-29T20:10:45.553

其他答案大部分都涵盖了：您应该在这里使用定点，而不是浮点。但是，从浮点输入到定点表示时，请小心正确舍入。这是我破解的一个简短版本，它应该适用于所有积极的输入：

```
#include <stdlib.h>
#include <stdio.h>
int main(int argc, char ** argv)
{
    float change = atof(argv[1]);
    int work = (int)(100*change+0.5);
    int quarters, dimes, nickels, pennies;
    quarters = work/25; work %= 25;
    dimes    = work/10; work %= 10;
    nickels  = work/5;  work %=  5;
    pennies  = work;
    printf("%.2f dollars = %d quarters, %d dimes, %d nickels and %d pennies: %d coins total\n",
    change, quarters, dimes, nickels, pennies, quarters+dimes+nickels+pennies);
    return 0;
 } 
```

例如：

```
./change 4.20
4.20 dollars = 16 quarters, 2 dimes, 0 nickels and 0 pennies: 18 coins total 
```

# command-line - 如何从命令行查看单个 Mercurial 提交？

> ID：13128585
> 
> 赞同：0
> 
> 时间：2012-10-29T19:50:03.493
> 
> 标签：command-line, mercurial, mercurial-commit

我想从命令行查看给定的 Mercurial 提交中发生的变化，类似于从 TortoiseHg 工具中看到的`hg status`或从 TortoiseHg 工具中看到的。我似乎能得到的最接近的是`hg log --stat`，但它会打印额外的符号（即加号和减号），我无法指定我想查看哪个特定版本。

我需要这个，因为我的开发人员有“。”之类的签入注释。或者 ”，”。>:-(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T19:59:15.537

事实证明，`hg status`有一个`--change`参数，您可以在其中传递修订号（例如 109）、相对修订（即 -1 是最后一次提交，-2 是倒数第二个等）或修订的哈希值，它将打印出修订版所做的更改（即添加、删除和修改）。

`--change`隔离该修订并仅显示该修订，但替换`--change`为`--rev`显示自该修订到当前状态的累积效果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T20:25:18.280

```
hg log -v -r <changeset>

changeset:   563:af4d66e2bc6e
tag:         tip
user:        David M. Carr <****>
date:        Fri Oct 26 22:46:02 2012 -0400
files:       hggit/gitrepo.py tests/test-pull.t
description:
pull: don't pull tags as bookmarks 
```

或者，使用模板，类似

```
hg log -r tip --template "{node|short} - files: {files}\n" 
```

带输出

```
af4d66e2bc6e - files: hggit/gitrepo.py tests/test-pull.t 
```

# c# - 使用 DataMatrix 代码作为键盘输入

> ID：13128587
> 
> 赞同：4
> 
> 时间：2012-10-29T19:50:14.623
> 
> 标签：c#, matrix, input, keyboard-input

我有这个程序来读取`[code].txt`文件，根据`textBox`. 现在，我输入代码并搜索文件。

但我想使用读取数据矩阵代码作为`textBox`.

基本上，我需要我的程序来读取数据矩阵代码并使用它来搜索文件。

那可能吗？我不会使用键盘编写代码，而是使用 DataMatrix 阅读器......

如果是这样，你有什么我可以用来做的提示吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T20:39:03.537

The most tightly integrated approaches are generally specific to each reader type (they have different APIs), but most readers have a mode where they emulate keyboard input, with optional delimiters at the end of the text. If you make your GUI respond to the 'Enter' key within the text entry field as the same as pressing 'Submit' (or whatever else fires off the file reading in your application), then you can bring in most code readers transparently and still support keyboard interaction in the same way.

# jpa - 限制 jpa 关联查询的大小

> ID：13128588
> 
> 赞同：1
> 
> 时间：2012-10-29T19:50:16.177
> 
> 标签：jpa, entity, resultset

以下查询获取部门中的所有员工：

```
List<Employee> employees = em.find(Department.class,departmentid).getEmployeeList(); 
```

但是，我希望从上述查询中仅获得有限数量的结果，而不是完整的结果集。是否可以通过上述查询？

我知道 em.createQuery() 替代方案，但是想使用实体中现有的一对多关联，而不是编写新查询来获得有限的结果。

任何帮助或想法都会很棒。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T15:27:22.580

使用 JPQL，

```
Select e from Department d join d.employees e where d.id = :id 
```

并在查询中设置 maxResults

# c# - 如何在我的应用程序中创建电子邮件模板

> ID：13128589
> 
> 赞同：3
> 
> 时间：2012-10-29T19:50:20.003
> 
> 标签：c#, asp.net-mvc, razor

> **可能重复：**
> [作为电子邮件模板的 Razor 视图](https://stackoverflow.com/questions/4368815/razor-views-as-email-templates)

我正在从我的网站服务中向用户发送电子邮件。

我想对其进行格式化，以便它以一种特定的方式显示得很好。

这是我所拥有的：

```
<table bgcolor="#FFE680" border="0" cellpadding="0" cellspacing="0" width="100%">
  <tbody>
    <tr>
      <td width="100%" height="51" valign="middle"><h1> <strong>[COMPANY] User ID Reminder </strong></h1></td>
      <td align="right" valign="top" width="8"><img alt="" width="8" height="8" align="top" /></td>
    </tr>

  </tbody>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%">
  <tbody>
    <tr>
      <td><table border="0" cellpadding="0" cellspacing="0" width="100%">
        <tbody>
          <tr>
            <td align="left" valign="top" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
              <tbody>
                <tr>
                  <td><table border="0" cellpadding="0" cellspacing="0" width="100%">
                    <tbody>
                      <tr>
                        <td colspan="1" align="left"></td>
                        </tr>
                      <tr>
                        <td align="left" valign="top" width="100%"><p> <br />
                          Dear [USERNAME], </p>
                          <p> In response to your request to be reminded of your User ID, please   find below the information we have on file for you. If you didn't   submit  this request, ignore this email. </p>
                          <table border="0" cellpadding="0" cellspacing="0">
                            <tbody>
                                  <tr>
                                    <td>Your User ID is: </td>
                                    <td>[USERNAME]</td>
                                    </tr>
                                  <tr>
                                    <td>Your registered email address is:  </td>
                                    <td>[EMAIL]</td>
                                  </tr>
                              </tbody>
                            </table>
                          <p> 
                            If you have forgotten your password, you can request it here.<br />
                          </p>
                          <p> 
                            Thank you,<br />[COMPANY]
                          </p></td>
                        </tr>
                      </tbody>
                    </table></td>
                  </tr>
                </tbody>
              </table></td>
          </tr>
          </tbody>
      </table></td>
    </tr>
  </tbody>
</table> 
```

现在我的问题不是关于电子邮件的外观，而是如何在填充适当的字段时将其作为电子邮件的正文？

我把它作为一个字符串放在资源中，我想我只是替换特定的[字段]。这开始变得乏味并且显得草率：

```
var body = SuburbanHUB.Properties.Resources.ForgotPasswordEmailBody.Replace("[USERNAME]", username).Replace("[EMAIL]")... 
```

我确信有更好的方法可以做到这一点，但我没有经验。

**=== 澄清 ===**

我正在使用 razor 调用用 C# 编写的 WCF 服务。被调用的服务是发送电子邮件的地方，而不是视图。我将 Razor 与 MVC 一起使用，并将 C# 作为底层代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T19:54:14.780

我有类似的要求，最终我使用了 NVelocity，它对我来说非常有用。请参阅这篇文章以了解[http://www.codeproject.com/Articles/12751/Template-merging-with-NVelocity-and-ASP-NET](http://www.codeproject.com/Articles/12751/Template-merging-with-NVelocity-and-ASP-NET)。您必须根据速度模板语言修改模板中的字段。[从http://nvelocity.sourceforge.net/](http://nvelocity.sourceforge.net/)下载 NVelocity 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T20:36:15.697

我正在尝试做同样的事情。我们使用 Razor 模板来生成电子邮件，并传入一个`Model`包含所有各种变量的变量来填充它。这让我们可以包含 Razor 和 MVC 支持的所有内容，包括`@if`and `@Html.Partial`，这让我们可以从片段中构建电子邮件。

我们刚刚提出的答案涉及运行一个内部 MVC 网络服务器，使用模型作为参数从它请求页面，并捕获响应文本，但我的问题有一些变体，它们更加独立。 [看看](https://stackoverflow.com/questions/13035427/razorgenerator-templates-and-html.)其他答案或评论是否对您有帮助。

# php - 从我的应用程序的用户那里获取喜欢并将它们归档到 csv

> ID：13128591
> 
> 赞同：1
> 
> 时间：2012-10-29T19:50:27.633
> 
> 标签：php, facebook, facebook-graph-api, facebook-like, facebook-fql

我需要能够将使用我的 Facebook 应用程序的用户的所有喜欢合并到 Excel 或 .csv 文件中。我可以让用户在我的 Facebook 应用程序中进行身份验证，但是有没有办法使用 Open Graph 或其他 Facebook 工具查看应用程序的所有用户的点赞数？我确定其他人一定有这个问题，我希望你们中的一个可以帮助我！

我一直在尝试运行 FQL 查询来获得喜欢，但没有任何 PHP 经验，所以到目前为止它一直很悲惨。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T20:00:58.737

这是该`application`类型没有`like`连接的问题。 [应用程序对象 GraphAPI](http://developers.facebook.com/docs/reference/api/application/) 当您希望收集有关它的用户的数据时，这很不方便`like`。

还是您在谈论对象的`likes`端点`user`？你可以收集，但我认为这不是你要找的。此处显示[Graph Explorer Example - 用户的喜欢](http://developers.facebook.com/tools/explorer/?method=GET&path=me?fields=likes)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T20:09:17.957

*   无法检索您的应用程序的用户列表 - 您需要在用户授权应用程序时手动构建它，请参阅[此问题](http://facebook.stackoverflow.com/questions/10071000/facebook-how-to-get-list-of-all-users-of-my-app)以获取更多信息
*   假设您有权访问用户的`likes`连接 - 访问`/USER_ID/likes`并解析响应，根据您使用的任何语言的语法将其保存到文件中（google 是您的朋友）
*   请注意，根据您的隐私政策，您对数据的使用受 Facebook[政策](http://developers.facebook.com/policy)和用户同意的约束，与第三方共享可能是非法的（我不是律师，这不是官方建议等）

# dispose - WebMatrix Database.Open... Close() 和 Dispose()

> ID：13128592
> 
> 赞同：4
> 
> 时间：2012-10-29T19:50:29.847
> 
> 标签：dispose, webmatrix

每当我阅读有关 Close() 和 Dispose() 的信息时，我最终都会看到很多仅使用 Using Block 的引用，但我还没有找到如何在 WebMatrix C# Razor Syntax 中使用 Using Block。

因此，我不想要一个只使用 Using Block 的答案，除非您可以通过示例确切地告诉我如何使用。

完成连接/查询后，特定于 Database.Open() 的使用

我的问题是：

*   我应该同时使用 Close() 和 Dispose() 吗？
*   我先调用 Close() 然后 Dispose() 还是先调用 Dispose() 然后 Close() 是否重要？

希望简单问题的简单答案。谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-29T20:30:20.233

数据库帮助程序的 ASP.NET 网页框架示例不包括对 Close 或 Dispose 的调用，因为框架本身旨在在请求结束时为您调用 Dispose。如果您使用 ADO.NET 而不是数据库助手，则应该使用 using 语句。话虽如此，没有什么可以阻止您将数据库助手调用包装在 using 块中：

```
IEnumerable<dynamic> floaters = null;
using(var db = Database.Open("MyDb")){
    var sql = "SELECT * From LifeRafts";
    floaters = db.Query(sql);
} 
```

如果您想自己管理这一切，您可以简单地调用 Close 或 Dispose。无论如何，它们都会导致连接返回到 ADO.NET 连接池。

# objective-c - Objective-C：将两个整数相除并返回一个四舍五入的整数值

> ID：13128597
> 
> 赞同：4
> 
> 时间：2012-10-29T19:50:44.167
> 
> 标签：objective-c, ios, int

如何除以两个 NSInteger，例如 13 / 4 并将结果四舍五入到下一个整数 = 3？

我已经看到一些将整数转换为浮点数并返回整数的示例。但是用最少的代码推荐的方法是什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-29T19:58:30.187

假设`x >= 0`和`y > 0`：

如果你想四舍五入：`x / y`

如果你想四舍五入：`(x + y - 1) / y`

如果要四舍五入到最近：`(x + y / 2) / y`

# eclipse - eclipse更新错误

> ID：13128599
> 
> 赞同：1
> 
> 时间：2012-10-29T19:51:05.543
> 
> 标签：eclipse, eclipse-plugin

> **可能重复：**
> [在 Eclipse 中添加新插件时出错](https://stackoverflow.com/questions/13141956/error-while-adding-new-plugin-in-eclipse)

当我试图安装这个插件[http://fornwall.net/eclipsecoder/](http://fornwall.net/eclipsecoder/) 我发现了这个问题。

[http://i.stack.imgur.com/7qjDN.png](https://i.stack.imgur.com/7qjDN.png)

那么我该如何解决这个问题呢？

# blackberry - 如何重置滚动值，NO_SCROLL_RESET，Blackberry

> ID：13128600
> 
> 赞同：0
> 
> 时间：2012-10-29T19:51:15.047
> 
> 标签：blackberry, java-me, scroll

我需要从滚动中重置值，我已经实现了一个标签栏（在 Blackberry OS 6 中开发），在 VerticalFieldManager 中使用垂直滚动，但是当我选择另一个字段（标签）时，垂直滚动返回一个空指针，标签代码很好，所以我猜是因为第一个滚动事件保存了第一个字段（选项卡）中的项目长度，当长度小于第一个字段时给我一个空指针，我需要在完成滚动时从滚动中重置值，我看到了这个

```
(Mannager.NO_SCROLL_RESET) 
```

但它已被弃用。我使用的是 OS 6，但标签栏必须适用于所有设备。

```
public class CustomizeTabbar extends MainScreen {

private int Resolucion;
VerticalFieldManager lista;
private AbsoluteFieldManager tab1Manager;
private AbsoluteFieldManager tab2Manager;
private AbsoluteFieldManager tab3Manager;
private AbsoluteFieldManager tab4Manager;
private AbsoluteFieldManager tab5Manager;  ///Detalle Nota

private AbsoluteFieldManager tabArea;
private String Token;

public CustomizeTabbar(int Res, String token) {

    Resolucion=Res;
    this.Token=token;

    try{
        ///Cabecera Tabbar
        HorizontalFieldManager htabbar= new HorizontalFieldManager(NO_HORIZONTAL_SCROLL|NO_VERTICAL_SCROLL|USE_ALL_WIDTH ){
            //define width
            public int getPreferredWidth()
            {
                if(Resolucion==1)
                    return 320;
                else
                    return 480;
            }
            //define height
            public int getPreferredHeight()
            {
                if(Resolucion==1)
                    return 25;
                else
                    return 36;

            }
            protected void sublayout( int maxWidth, int maxHeight )
            {
                super.sublayout(getPreferredWidth(), 
                        getPreferredHeight());
                setExtent(getPreferredWidth(), getPreferredHeight());
            }
        };

        final BitmapButtonField tab1= new BitmapButtonField(Bitmap.getBitmapResource("1notasactuales.png"),Bitmap.getBitmapResource("1notasactualesfocus.png"),FOCUSABLE);
        final BitmapButtonField tab2= new BitmapButtonField(Bitmap.getBitmapResource("1inasistencia.png"),Bitmap.getBitmapResource("1inasistenciafocus.png"),FOCUSABLE);
        final BitmapButtonField tab3= new BitmapButtonField(Bitmap.getBitmapResource("1Horario.png"),Bitmap.getBitmapResource("1HorarioFocus.png"),FOCUSABLE);
        final BitmapButtonField tab4= new BitmapButtonField(Bitmap.getBitmapResource("1record.png"),Bitmap.getBitmapResource("1recordfocus.png"),FOCUSABLE);
        LabelField spacer1 = new LabelField(" | ", LabelField.NON_FOCUSABLE);
         LabelField spacer2 = new LabelField(" | ", LabelField.NON_FOCUSABLE);
         LabelField spacer3 = new LabelField(" | ", LabelField.NON_FOCUSABLE);

        ///Controlador del Tabbar
        FieldChangeListener click=new FieldChangeListener() {

            public void fieldChanged(Field field, int context) {

                lista=null;
                if(tabArea!=null){
                try{
                    if(field==tab1)
                    {
                        delete(tabArea);
                        tabArea=NotasActualesDisplay();
                        add(tabArea);
                    }else 
                        if(field==tab2)
                        {
                            delete(tabArea);
                            tabArea = InasistenciaDisplay();
                            add(tabArea);
                        }else 
                            if(field==tab3)
                            {
                                delete(tabArea);
                                tabArea = HorarioDisplay();
                                add(tabArea);
                            }else
                                if(field==tab4)
                                {
                                    delete(tabArea);
                                    tabArea=RecordAcademicoDisplay();
                                    add(tabArea);
                                }
                }
                catch (Exception e) {
                    e.printStackTrace();
                    System.out.println(e.getMessage());
                }
                }

            }
        };
        tab1.setChangeListener(click);
        tab2.setChangeListener(click);
        tab3.setChangeListener(click);
        tab4.setChangeListener(click);

        htabbar.add(tab1);
        htabbar.add(spacer1);
        htabbar.add(tab2);
        htabbar.add(spacer2);
        htabbar.add(tab3);
        htabbar.add(spacer3);
        htabbar.add(tab4);

        Background bg = BackgroundFactory.createBitmapBackground(Bitmap.getBitmapResource("2tabbar_pages.png"));
        htabbar.setBackground(bg);

        setTitle(htabbar);
        /////////
        tabArea = NotasActualesDisplay();
        add(tabArea);

    }catch (Exception e) {
        // TODO: handle exception
    }

}
  public AbsoluteFieldManager NotasActualesDisplay() {
    final VerticalFieldManager lista=new     VerticalFieldManager(Manager.VERTICAL_SCROLL|Manager.VERTICAL_SCROLLBAR|Manager.NO_SCROLL_RESET){
 /* Here I design the elements with JSON using FOR*/
    }
return tab1Manager;
 }
public AbsoluteFieldManager InasistenciaDisplay() {
    VerticalFieldManager(Manager.VERTICAL_SCROLL|Manager.VERTICAL_SCROLLBAR|Manager.NO_SCROLL_RESET){
 /* Here I design the elements with JSON using FOR*/
    }
return tab2Manager;
 }
public AbsoluteFieldManager HorarioDisplay() {
    VerticalFieldManager(Manager.VERTICAL_SCROLL|Manager.VERTICAL_SCROLLBAR|Manager.NO_SCROLL_RESET){
 /* Here I design the elements with JSON using FOR*/
    }
 }
return tab3Manager;    
 } 
```

# .htaccess - 复杂的 301 .htaccess url 重定向

> ID：13128603
> 
> 赞同：0
> 
> 时间：2012-10-29T19:51:32.293
> 
> 标签：.htaccess, redirect, rewrite

我尝试了几种简单的方法，例如

```
Redirect 301 ^/gebouw/start/(.*) http://mysub.domain.nl/start/$1 
```

还有一些更详细的

```
RewriteCond %{REQUEST_URI} ^/gebouw/start/ [NC]
RewriteRule ^(.*)$ http://mysub.domain.nl/start/$1 [R,L] 
```

但我没有得到我想要的成功

我正在寻找的是 301 将浏览到的每个页面从 www.myolddomain.nl/start/ 重定向到 mysub.domain.nl/start/ 这些网址可能会变得复杂，它们的范围从

[http://www.myolddomain.nl/start/resetpassword.php](http://www.myolddomain.nl/start/resetpassword.php)

至

[http://www.myolddomain.nl/start/subdir/page.php?var1=inputBlad&var2=6378](http://www.myolddomain.nl/start/subdir/page.php?var1=inputBlad&var2=6378)

如何使用 htaccess 规则做到最好？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T06:12:10.033

> 我正在寻找的是 301 将浏览到的每个页面从 www.myolddomain.nl/start/ 重定向到 mysub.domain.nl/start/ 这些网址可能会变得复杂，它们的范围从

你想这样做：

```
RewriteEngine On
RewriteCond %{HTTP_HOST} ^www.myolddomain.nl$ [NC]
RewriteRule ^/?start/(.*)$ http://mysub.domain.nl/start/$1 [L,R=301] 
```

# c# - 在 Windows 应用程序的 EXE 中本地存储数据的最佳方法是什么

> ID：13128604
> 
> 赞同：3
> 
> 时间：2012-10-29T19:51:44.827
> 
> 标签：c#, .net, sql, windows

我有一个使用 Visual Studio 2010、CSharp、.NET 4.0 编写的小型 Windows 应用程序，它使用 HTTP 请求、Ping 和 DNS 查找对远程页面进行一些扫描。

然后它在按列排序的表格（顶部有标签）中显示扫描结果。

这很简单，但我想添加一个“设置”面板或菜单选项，以便用户可以添加某些配置选项，例如 -Timeout 持续时间（HTTP 调用）-代理详细信息（端口和 IP）-用户代理 -电子邮件登录详细信息、端口, 电子邮件帐户类型 IMAP/POP3, 密码等 - 其他

因此，我想在应用程序中添加一个“根深蒂固”的小型数据库，并作为 .EXE 的一部分。

我习惯于编写客户端/服务器应用程序，其中数据库位于远程服务器上，应用程序位于其他地方，并使用 ADO 连接字符串连接到这个远程 SQL Server，然后我使用管理工作室查看数据。

我不知道从哪里开始使用这种连接到应用程序的小型数据库。我使用 SQLLite 或 SQL CE 还是其他类型的 MS SQL DB。

我是否必须在应用程序中编写代码来“创建数据库、表并填充它们”，然后如果它们存在则将数据取回以显示给用户，以便他们可以编辑详细信息。

数据库是与 .EXE 分开放置还是作为 .EXE 的一部分，当我将它提供给人们时，理想情况下我希望它是 .EXE 的一部分。

我确信网上有很多很棒的教程，我正在浏览，但我只是想听听其他人对前进道路和最佳方法的想法。

如果您有任何指向指南或教程的链接，将会非常棒。

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-29T19:56:19.017

对于少量数据，特别是如果它们是每个用户的，您可以使用内置的[设置](http://msdn.microsoft.com/en-us/library/aa730869%28v=vs.80%29.aspx)功能。

对于大量数据，特别是您希望查询的数据，我建议使用嵌入式数据库 - SQL CE 或 SQLite 是流行的选择。

# forms - PrimeFaces Captcha 内部人员 h:form

> ID：13128607
> 
> 赞同：0
> 
> 时间：2012-10-29T19:51:58.353
> 
> 标签：forms, primefaces, submit, captcha

我正在尝试在 Liferay portlet 中使用 Primefaces 验证码控件。

我有以下代码：

```
<h:form>
   ....
   <p:captcha id="captcha" requiredMessage="Debe ingresar el captcha"/>
   <p:commandButton value="Send" actionListener="#{registrationPymeViewEdit.onSend}" ajax="false" />
</h:form> 
```

在我的 web.xml 中，我配置了这样的公钥和私钥：

```
<context-param>
    <param-name>primefaces.PRIVATE_CAPTCHA_KEY</param-name>
    <param-value>MY_PRIVATE_KEY</param-value>
</context-param>
<context-param>
    <param-name>primefaces.PUBLIC_CAPTCHA_KEY</param-name>
    <param-value>MY_PUBLIC_KEY</param-value>
</context-param> 
```

我遇到的问题是没有提交表单，它从不执行我的 bean 的“onSend”方法。如果我删除验证码，则 bean 的方法执行正常。

有任何想法吗？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T13:32:57.983

我假设您的服务器日志上没有任何错误。尝试使用具有适当操作方法的操作而不是操作侦听器。

# javascript - 如何对表示整数的字符串数组求和

> ID：13128610
> 
> 赞同：3
> 
> 时间：2012-10-29T19:52:07.120
> 
> 标签：javascript, arrays, node.js, casting

如何对这样的数组求和 `[ '', '4490449', '2478', '1280990', '22296892', '244676', '1249', '13089', '0', '0', '0\n' ]`

如果我在那个数组上调用类似的东西`['','4490449', ... , '0\n' ].reduce(function(t,s){ return t+s)`，那么这些刺就会被连接起来而不是相加。

我尝试了一些铸造，`parseInt()`但这会导致`NaN`:)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-29T20:02:20.000

您需要确保求和的值是整数。这是一种可能的解决方案：

```
var ary=[ '', '4490449', '2478', '1280990', '22296892', 
          '244676', '1249', '13089', '0', '0', '0\n' ];

console.log(
  ary
    .map( function(elt){ // assure the value can be converted into an integer
      return /^\d+$/.test(elt) ? parseInt(elt) : 0; 
    })
    .reduce( function(a,b){ // sum all resulting numbers
      return a+b
    })
)​; 
```

它将“28329823”打印到控制台。

[请参阅http://jsfiddle.net/hF6xv/](http://jsfiddle.net/hF6xv/)上的小提琴

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-29T20:04:49.693

这似乎工作正常：

```
var arry = [ 'asdf', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'ham10am' ];

var res = arry.reduce(function(prev, curr){
    return (Number(prev) || 0) + (Number(curr) || 0);
});

console.log(res); // prints 45 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-29T20:09:37.457

试试这个：

```
var sum = 0,
    arr = [ '', '1', '2', '3.0','4\n', '0x10' ],
    i = arr.length;

while( i-- ) {
    // include radix otherwise last element gets interpreted as 16
    sum += parseInt( arr[i], 10 ) || 0; 
}

console.log( sum ) // sum => 10 as 3.0 and 4\n were successfully parsed 
```

[在这里](http://jsfiddle.net/5QfG2/3/)提琴

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-29T20:17:18.810

您使用 parseInt 是正确的。

但是您需要为每个 reduce 参数使用它。

此外，您还需要检查每个 parseInt 的结果是否是一个数字，因为如果不是，该函数将尝试将一个数字与 NaN 相加，并且所有其他和最终也将是 NaN。

[Mozilla关于 parseInt](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/parseInt)的 ECMAscript文档说：

> 如果第一个字符不能转换为数字，则 parseInt 返回 NaN。

然后，为了避免让 NaN 破坏你的目标，你可以像这样实现它：

```
function parseIntForSum(str) {
    var possibleInteger = parseInt(str);
    return isNaN(possibleInteger) ? 0 : possibleInteger;
}

function sum(f, s) {
    return parseIntForSum(f) + parseIntForSum(s);
}

window.alert('sum = ' + [ '', '4490449', '2478', '1280990', '22296892', '244676', '1249', '13089', '0', '0', '0\n' ].reduce(sum)​​​);​ 
```

这是一个 jsfiddle 工作：http: [//jsfiddle.net/cLA7c/](http://jsfiddle.net/cLA7c/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-29T19:59:09.247

您的数组中有一些不是整数的值。让我们假设它们都是，那么你可以这样做：

```
['4490449', '2478', '1280990', '22296892', '244676', '1249', '13089'].reduce( 
    function(t, s) { 
        return parseInt(t) + parseInt(s); 
    }
); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-03-12T12:43:20.353

```
import java.util.List;

public class MixedSum {

 /*
  * Assume input will be only of Integer o String type
  */
  public int sum(List<?> mixed) {

    // A new array to store all the elements in the mixed list after converting them to integers
    int[] newIntList = new int[mixed.size()];

    // Variable to store sum of all elements in our new array
    int sum = 0;

    // Loop through the mixed list and convert all integers to strings and then back to string
    //(mixed.get(i) + "") converts all integers to strings and leave strings as strings
    // parseInt() function converts everything back to integers 
    for(int i = 0; i < mixed.size(); i++){
      newIntList[i] = Integer.parseInt(mixed.get(i) + "");
    }

    // Loops through the array and sum up all elements
    for(int i = 0; i < newIntList.length; i++){
      sum += newIntList[i];
    }

    //returns sum
    return sum;
  }
} 
```

# amazon-ec2 - Amazon Dynamo DB 最大客户端连接数？

> ID：13128613
> 
> 赞同：9
> 
> 时间：2012-10-29T19:52:24.203
> 
> 标签：amazon-ec2, amazon-web-services, connection-pooling, amazon-dynamodb

在 Java API 中创建 AmazonDynamoDBClient 时，我们可以使用 ClientConfiguration 上的 setMaxConnections 指定最大连接池大小。对此有硬性/推荐限制吗？例如，虽然默认限制是 50 个连接，但一个 linux 客户端应该能够维持 5,000 个打开的连接，亚马逊会允许这样做吗？

如果有最大限制，它是否仅适用于单个客户端实例？如果有几台机器通过同一个帐户使用dynamo，它们会共享连接限制吗？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-06-25T09:15:29.947

由于与 Amazon DynamoDB 的连接是基于 http(s) 的，因此打开连接的概念仅限于您的 tcp max open connections 一次。我高度怀疑 Amazons 端是否存在限制，因为它的负载平衡接近于无穷大。

当然，您的读写容量限制是个例外。请注意，如果您超过一定数量的容量单位，他们希望您与他们联系，具体取决于您所在的地区。

您可能已经阅读过它们，但在这里可以找到 DynamoDB 的局限性：

[http://docs.aws.amazon.com/amazondynamodb/latest/developerguide/Limits.html](http://docs.aws.amazon.com/amazondynamodb/latest/developerguide/Limits.html)

# php - 当“优先级”值相同时，对数组中的元素进行洗牌？

> ID：13128619
> 
> 赞同：2
> 
> 时间：2012-10-29T19:52:49.177
> 
> 标签：php

我有一个键控数组，每个槽包含两条信息：公司名称和优先级。我正在尝试找到一种方法来改组具有相同优先级值的公司名称。我熟悉洗牌功能，但是，我不想洗牌忽略优先级值的数组中的所有元素，我只想洗牌具有相同优先级值的元素。

这是我正在尝试做的一个例子：

**注意：**以下所有元素都在同一个数组中

```
 McDonalds, 10
    Marshalls, 10
    Dillards,  10
    Burger King, 5
    Hunan Palace, 5
    Taco Bell, 5
    Pizza Hut, 5
    Macy's, 2
    Prudential, 2
    Nike, 2
    Billabong, 2 
```

我想最终得到类似的东西：

```
 Marshalls, 10
        Dillards,  10
        McDonalds, 10
        Hunan Palace, 5
        Burger King, 5
        Pizza Hut, 5
        Taco Bell, 5
        Nike, 2
        Macy's, 2
        Billabong, 2
        Prudential, 2 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T07:31:46.667

您需要洗牌，然后进行排序

**编辑**

```
$array = array(
   array('company' => 'McDonalds', 'priority' => 10),
   array('company' => 'Marshalls', 'priority' => 10),
   //...
);

shuffle($array); //shuffles (randomizes the order of the elements in) an array

function custom_sort($left, $right) {
    return $right['priority'] - $left['priority'];
}

usort($array, "custom_sort"); // sort by user-defined comparison function 
```

[洗牌人](http://php.net/manual/en/function.shuffle.php)
[排序人](http://php.net/manual/en/function.usort.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T20:17:38.647

使用 排序时`usort`，当您具有相同的优先级时，按添加到数组中每个元素的随机因子进行排序：

```
$myArray = array(
   array('company' => 'McDonalds', 'priority' => 10),
   array('company' => 'Marshalls', 'priority' => 10),
);

foreach($myArray as &$elem){
    //add new property
    $elem['random_factor'] = rand(0,65535);
} 
```

现在按优先级排序，然后按随机因素排序：

```
function sort_and_shuffle($a,$b){
    if($a['priority'] == $b['priority']){
        if($a['random_factor'] == $b['random_factor']){
            return 0;
        }
        return return ($a['random_factor'] < $b['random_factor']) ? -1 : 1;
    }else{
        return return ($a['priority'] > $b['priority']) ? -1 : 1;
    }
} 
```

不要尝试在每个相同的优先级上返回随机结果，如下所示：

```
function sort_and_shuffle($a,$b){
    if($a['priority'] == $b['priority']){
        return rand(-1,1);
    }else{
        return return ($a['priority'] > $b['priority']) ? -1 : 1;
    }
} 
```

它效率低下，在最坏的情况下它可以永远运行，因为在比较相同元素时没有恒定的结果

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T20:45:24.053

这是另一种方式，可以避免您弄乱您的数据。从您的基本`usort()`通话开始。

```
$places = array(
    array('name'=>'Marshalls', 'priority'=>10),
    array('name'=>'Pizza Hut', 'priority'=>5),
    ...
);

usort($places, function($left, $right) {
    return $right['priority'] - $left['priority'];
}); 
```

现在您需要一个函数，该函数将接收一个小数组，将其打乱，然后将其附加到一个更大的数组中。

```
function shuffleAndAppend(&$temp, &$final) {
    shuffle($temp);
    array_splice($final, count($final), 0, $temp);
    $temp = array();
} 
```

现在，您可以遍历已排序的数组并将具有相同优先级的项目组合在一起，将它们打乱，然后将它们附加到最终数组中。

```
$shuffledPlaces = array();
$tempPlaces = array();
$lastPriority = -1;

foreach ($places as $onePlace) {
    if ($onePlace['priority'] != $lastPriority)
        shuffleAndAppend($tempPlaces, $shuffledPlaces);
    array_push($tempPlaces, $onePlace);
    $lastPriority = $onePlace['priority'];
}
shuffleAndAppend($tempPlaces, $shuffledPlaces);

print_r($shuffledPlaces); 
```

# entity-framework - 实体何时出现在模型的集合中

> ID：13128623
> 
> 赞同：1
> 
> 时间：2012-10-29T19:52:58.693
> 
> 标签：entity-framework

我使用实体框架并拥有一组用户：

```
 public class DbModel : DbContext
 {
     public DbSet<User> Users { get; set; } 
```

我像这样添加一个用户：

```
 User UserOne = new User();
  model.Users.Add( UserOne ); 
```

我要求用户计数： int userCount = model.Users.Count();

userCount 是“0”，我希望是“1”。添加 DetectChanges 没有帮助。在“model.SaveChanges()”之后，Count = 1，但为时已晚，我需要将内存中的内容与 DB 内容结合起来进行验证。有没有办法做到这一点？

解决方案

使用 Erik Philips 的答案，我为 DbSet 编写了以下扩展方法

```
public static class DBSetExtentions
{
     public static IEnumerable<T> AllMembers<T>(
         this DbSet<T> target, 
         Func<T, bool> selection
         )  where T : class
    {
        return target.Local.Where(selection).Union(target.Where(selection));
    }
 } 
```

**它允许我对所有**实体进行选择和验证，例如：

```
 private void ValidateEmail(ValidationDto validationDto)
    {

        int usersWithSameEmail =
            validationDto.Model.Users.AllMembers(
                x => x.EmailAddress.Equals( EmailAddress ) ).Count();

        if (usersWithSameEmail > 1)
        {
            validationDto.Result.Add(new ValidationResult("Email address is in use"));
        }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T20:02:42.590

[您可以使用Local](http://msdn.microsoft.com/en-us/library/system.data.entity.dbset.local%28v=vs.103%29.aspx)将项目（已提交和未提交）的客户端查询到您的数据存储。

```
var count = model.Users.Local.Count(); 
```

需要注意的是，这只是用户的本地表示。这意味着它可能包含来自数据库的部分用户（已更改和/或未更改），以及您创建但未保存的新用户。

[有趣的文章 - 在 EF 4.1 第 7 部分中使用 DbContext：本地数据](http://blogs.msdn.com/b/adonet/archive/2011/02/01/using-dbcontext-in-ef-feature-ctp5-part-7-local-data.aspx)

# objective-c - NSString 时间格式为 int64_t

> ID：13128626
> 
> 赞同：0
> 
> 时间：2012-10-29T19:53:13.217
> 
> 标签：objective-c, ios, game-center

我有一个 NSString 表示`mm:ss`格式的时间。我如何转换它`int64_t`以便我可以将它作为游戏中心的分数提交？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T20:04:06.317

如果您想严格，可以使用 NSDateFormatter 转换为 NSDate 然后从中获取 NSTimeInterval ；如果你想更直接，那么你可以尝试一些简单的事情：

```
NSArray *components = [string componentsSeparatedByString:@":"];
if([components count] != 2)
{
    // some error condition
    return;
}

int64_t totalSeconds = ([[components objectAtIndex:0] integerValue] * 60) +
                             [[components objectAtIndex:1] integerValue]; 
```

# javascript - JSON 和自动完成的性能问题

> ID：13128628
> 
> 赞同：0
> 
> 时间：2012-10-29T19:53:15.697
> 
> 标签：javascript, jquery, json, performance, jquery-autocomplete

我正在尝试使用应用程序缓存和本地存储等技术编写一个可以在线和离线工作的应用程序。我正在使用 jQuery mobile 和 jqm 自动完成解决方案，可以在这里找到[http://andymatthews.net/code/autocomplete/](http://andymatthews.net/code/autocomplete/)

这个想法是，如果应用程序在线，那么我将通过 ajax 调用一个远程访问函数，该函数将设置数据。发出的 ajax 调用会带回事件、国家和医院的数据。一旦返回数据，我将在 localStorage 中设置数据。

如果数据已经存在于 localStorage 中，那么我可以在离线时继续，因为我不必依赖 ajax 调用。

在 iPad/移动设备上运行时，我遇到了此代码的性能问题。就医院数据而言。有大量的医院数据被返回，请参阅下面的医院数据 JSON 示例。它在桌面上可能有点慢，但几乎没有那么糟糕。

任何人都可以看到我下面的代码的任何改进以提高性能。

**JSON 医院数据示例**

```
{ "hospitals" : { 
  "1" : { "country" : "AD",
      "label" : "CAIXA ANDORRANA SEGURETAT SOCIAL"
    },
  "10" : { "country" : "AE",
      "label" : "Advance Intl Pharmaceuticals"
    },
  "100" : { "country" : "AT",
      "label" : "BIO-KLIMA"
    },
  "1000" : { "country" : "BE",
      "label" : "Seulin Nicolas SPRL"
    },
  "10000" : { "country" : "ES",
      "label" : "Dental 3"
    },
  "10001" : { "country" : "ES",
      "label" : "PROTESIS DENTAL MACHUCA PULIDO"
    },
  "10002" : { "country" : "ES",
      "label" : "JUST IMPLANTS, S.L."
    },
  "10003" : { "country" : "ES",
      "label" : "CTRO DENTAL AGRIC ONUBENSE DR.DAMIA"
    },
  "10004" : { "country" : "ES",
      "label" : "HTAL. VIRGEN DE ALTAGRACIA"
    },
  "10005" : { "country" : "ES",
      "label" : "HOSPITAL INFANTA CRISTINA"
    }....

/*global document,localStorage,alert,navigator: false, console: false, $: false */

$(document).ready(function () {
//ECMAScript 5 - It catches some common coding bloopers, throwing exceptions. http://ejohn.org/blog/ecmascript-5-strict-mode-json-and-more/
//It prevents, or throws errors, when relatively "unsafe" actions are taken (such as gaining access to the global object).
//It prevents, or throws errors, when relatively "unsafe" actions are taken (such as gaining access to the global object).
"use strict";

//initialise online/offline workflow variables
var continueWorkingOnline, continueWorkingOffline, availableEvents, availableHospitals, availableCountries, availableCities;
continueWorkingOnline = navigator.onLine;

var getLocalItems = function () {

    var localItems = [];    
    availableEvents = localStorage.getItem('eventData');
    availableHospitals = localStorage.getItem('hospitalData');
    availableCountries = localStorage.getItem('countryData');

    if (availableEvents) {
        //only create the array if availableEvents exists
        localItems[0] = [];
        localItems[0].push(availableEvents);
    }
    if (availableCountries) {
        //only create the array if availableCountries exists
        localItems[1] = [];
        localItems[1].push(availableCountries);
    }
    if (availableHospitals) {
        //only create the array if availableHospitals exists
        localItems[2] = [];
        localItems[2].push(availableHospitals);
    }
    if (availableCities) {
        //only create the array if availableHospitals exists
        localItems[3] = [];
        localItems[3].push(availableCities);
    }
    return localItems;              
};

//Check to see if there are 3 local items. Events, Countries, Cities. If true we know we can still run page off line
continueWorkingOffline = getLocalItems().length === 3  ? true: false; 

//Does what is says on the tin
var populateEventsDropDown = function (data) {      
    var eventsDropDown = $('#eventSelection');

    var item = data.events;
    $.each(item, function (i) {
        eventsDropDown.append($('<option></option>').val(item[i].id).html(item[i].name));
    });
};

//Called once getData's success call back is fired
var setFormData = function setData(data, storageName) {
    //localStorage.setItem(storageName, data);
    localStorage.setItem(storageName, data);
};

//This function is only called if continueWorkingOnline === true
var getRemoteFormData = function getData(ajaxURL, storageName) {
    $.ajax({
        url: ajaxURL,
        type: "POST",
        data: '',
        success: function (data) {
            setFormData(data, storageName);             
        }           
    });
};

//Function for autoComplete on Hospital data
var autoCompleteDataHospitals = function (sourceData) {

    var domID = '#hospitalSearchField';
    var country = $('#hiddenCountryID').val();

    var items = $.map(sourceData, function (obj) { 
        if (obj.country === country) {
            return obj;
        } 
    });     

    $(domID).autocomplete({
        target: $('#hospitalSuggestions'),
        source: items,
        callback: function (e) {
            var $a = $(e.currentTarget);
            $(domID).val($a.data('autocomplete').label);                                        
            $(domID).autocomplete('clear');
        }
    });
};  

//Function for autoComplete on Country data
var autoCompleteDataCountries = function (sourceData) {

    var domID = '#countrySearchField';
    var domHiddenID = '#hiddenCountryID';

    var items = $.map(sourceData, function (obj) { 
        return obj; 
    }); 

    $(domID).autocomplete({
        target: $('#countrySuggestions'),
        source: items,
        callback: function (e) {

            var $a = $(e.currentTarget);
            $(domID).val($a.data('autocomplete').label);                                        
            $(domID).autocomplete('clear');
            $(domHiddenID).val($a.data('autocomplete').value);

            //enable field to enter Hospital
            $('#hospitalSearchField').textinput('enable');

            //Call to autoComplete function for Hospitals
            autoCompleteDataHospitals(availableHospitals.hospitals);
        }
    });     
};

if (continueWorkingOnline === false && continueWorkingOffline === false) {
    alert("For best results this form should be initiated online. You can still use this but auto complete features will be disabled");
}

if (continueWorkingOnline === true && continueWorkingOffline === false) {               
    getRemoteFormData('templates/cfc/Events.cfc?method=getEventsArray', 'eventData');       
    getRemoteFormData('templates/cfc/Countries.cfc?method=getCountriesArray', 'countryData');
    getRemoteFormData('templates/cfc/Hospitals.cfc?method=getHospitalsArray', 'hospitalData');

    $(document).ajaxStop(function () {
        //set the variables once localStorage has been set

        availableEvents = JSON.parse(localStorage.getItem("eventData"));
        availableHospitals = JSON.parse(localStorage.getItem('hospitalData'));
        availableCountries = JSON.parse(localStorage.getItem('countryData'));

        //Inserts data into the events drop down
        populateEventsDropDown(availableEvents);

        autoCompleteDataCountries(availableCountries.countries);            
    });
}

if (continueWorkingOnline === true && continueWorkingOffline === true) {                
    //get the localStorage which we know exists because of continueWorkingOffline is true

    availableEvents = JSON.parse(localStorage.getItem('eventData'));
    availableHospitals = JSON.parse(localStorage.getItem('hospitalData'));
    availableCountries = JSON.parse(localStorage.getItem('countryData'));

    //Inserts data into the events drop down
    populateEventsDropDown(availableEvents);

    autoCompleteDataCountries(availableCountries.countries);        
}       
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T20:08:11.297

如果您的瓶颈是下载大量的 json 文件，那么减少瓶颈的唯一方法是使其更小或发送更少的数据。例如，您可以按国家/地区对医院进行排序并存储数组而不是带有键的对象，以使 json 更小，而不是一遍又一遍地重复键。

```
{
    "AD":[
        "CAIXA ANDORRANA SEGURETAT SOCIAL"
    ],
    "AE":[
        "Advance Intl Pharmaceuticals"
    ],
    ...
    "ES":[
        "Dental 3",
        "Dental 4",
        "Dental 5"
    ]
} 
```

如果 id 字段很重要，请使用

```
 ...
    "ES":[
        ["10000","Dental 3"],
        ["10001","Dental 4"],
        ["10002","Dental 5"]
    ] 
```

您当然需要更新其余代码以使用此 json 格式而不是您以前的格式。

# c# - 无法在 Visual Studio 2010 中创建基于服务的数据库

> ID：13128629
> 
> 赞同：0
> 
> 时间：2012-10-29T19:53:18.220
> 
> 标签：c#

我正在尝试学习 C#，然后遇到了这个障碍。我的 Visual Studio 2010 不允许我创建基于服务的数据库（.mdf 文件）。（添加>新项目>基于服务的数据库）

每次我尝试添加新的 .mdf 时都会出现错误。

> 建立与 SQL 服务器的连接时发生与网络相关或特定于实例的错误。服务器未找到或无法访问。验证实例名称是否正确以及 SQL Server 是否配置为允许远程连接。（提供者：SQL 网络接口，错误：26 - 错误定位服务器/指定的实例）

我可以毫无问题地创建本地数据库（添加>新项目>本地数据库），但我无法创建 .mdf

我在 Windows 7 64 位操作系统和 Visual Studio 2010 (Ultimate) 上运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T19:57:12.513

基于服务的数据库需要连接到 SQL Server 实例。它不是内置在 Visual Studio 中的，它是一个单独的应用程序，需要在某个地方运行以供您连接。该错误消息基本上是告诉您它找不到您尝试连接的 SQL Server 实例。

本地数据库可以正常工作，因为它将所有内容都保存在您的应用程序本地，并且不需要外部数据库服务器即可运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T19:59:02.883

**使用这两种数据库的基本要求：**

*   *本地数据库 ( `.sdf`)：*需要 SQL Server Compact。也就是说，您只需要一个额外的 DLL，而不需要特殊的系统服务。（如果您了解 SQLite：SQL Server Compact 在概念上是相同的，只是更强大且功能更完整。）

*   *基于服务的数据库（`.mdf`&`.ldf`日志/日志文件）：*需要 SQL Server 或 SQL Server Express 的运行实例，它们都是独立产品（[正如 Tim Copenhaver 在他的回答中指出的那样](https://stackoverflow.com/a/13128688/240733)）。出于开发目的，您通常会在您的开发机器上安装这些产品之一。

**您的问题的可能原因：**从您发布的错误消息中猜测，您没有安装 SQL Server，也没有安装 SQL Server Express。但是，需要这些产品之一的实例，以便您可以将数据库“附加”到它。在您实际访问`.mdf`数据库之前，这是必需的。

**要查看您是否安装了 SQL Server，**您可以打开控制面板 → 管理工具 → 服务，然后查找名为“SQL Server ( `.\SQLEXPRESS`)”或“SQL Server ( `YOURCOMPUTERNAME\MSSQLSERVER`)”或类似名称的系统服务。括号中的名称是您机器上运行的数据库实例的名称。`SQLEXPRESS`是 SQL Server Express 的默认实例名称，而`MSSQLSERVER`是 SQL Server 完整版的默认实例名称。

**如果您没有安装 SQL Server，**您可以从 Microsoft 免费下载[SQL Server 2012 Express](http://www.microsoft.com/en-us/download/details.aspx?id=29062)或[SQL Server 2008 R2 Express with SP2](http://www.microsoft.com/en-us/download/details.aspx?id=30438)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-26T11:07:19.343

你可以试试

1.  从开始->运行转到命令提示符（键入 cmd ->按回车键）
2.  检查 SqlLocalDB 通过

    Sqllocaldb.exe 我

    您将看到类似 (v11.0) 的版本号，否则完成安装。

3.  通过以下方式创建 sqldb

    sqllocaldb c 数据库名

    您将看到“使用 11.0 版创建的 LocalDB 实例“dbname”。”

4.  然后启动数据库

    sqllocaldb 的数据库名称

    您将看到“LocalDB 实例“dbname”已启动”

5.  查看创建的 Db 信息

    sqllocaldb.exe 我的数据库名

现在尝试在 C# 中创建基于服务的数据库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-06-16T11:49:20.587

从“数据连接”节点临时附加数据库文件 (.mdf)

1.  在服务器资源管理器中，打开数据连接的快捷菜单并选择添加连接。出现添加连接对话框。
2.  选择更改按钮。出现更改数据源对话框。
3.  选择 Microsoft SQL Server 数据库文件并选择确定按钮。添加连接对话框再次出现，Microsoft SQL Server 数据库文件 (SqlClient) 显示在数据源文本框中。
4.  选择浏览按钮并浏览到现有的 .mdf 文件。如果您键入一个不存在的文件名，将创建一个空白的 .mdf 文件。
5.  选择使用 Windows 身份验证或使用 SQL Server 身份验证。有关 SQL Server 数据库访问身份验证的详细信息，请参阅创建新 SQL Server 数据库对话框。
6.  选择确定按钮。数据库出现在服务器资源管理器中。

# sql - 使用左连接并检查该行是否存在以及另一个检查 where 子句

> ID：13128635
> 
> 赞同：21
> 
> 时间：2012-10-29T19:53:50.797
> 
> 标签：sql, sql-server

我有以下表格：

```
Users
Banned

SELECT u.*
FROM Users
WHERE u.isActive = 1
    AND
      u.status <> 'disabled' 
```

我不想包含用户也可能在 Banned 表中的任何行。

最好的方法是什么？

我可以这样做在 where 子句中放置一个子查询，这样它就可以执行以下操作：

```
u.status <> 'disabled' and not exist (SELECT 1 FORM Banned where userId = @userId) 
```

**我认为最好的方法是进行 LEFT JOIN，我该怎么做？**

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-10-29T20:06:33.963

根据[这个答案](https://stackoverflow.com/a/2246793/1048425)，在 SQL-Server 中使用`NOT EXISTS`比`LEFT JOIN/IS NULL`

```
SELECT  *
FROM    Users u
WHERE   u.IsActive = 1
AND     u.Status <> 'disabled'
AND     NOT EXISTS (SELECT 1 FROM Banned b WHERE b.UserID = u.UserID) 
```

**编辑**

为了完整起见，这就是我将如何使用 a `LEFT JOIN`：

```
SELECT  *
FROM    Users u
        LEFT JOIN Banned b
            ON b.UserID = u.UserID
WHERE   u.IsActive = 1
AND     u.Status <> 'disabled'
AND     b.UserID IS NULL        -- EXCLUDE ROWS WITH A MATCH IN `BANNED` 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-10-29T19:57:19.920

您只需检查`LEFT JOIN`使用 Banned 获得的值是否为`NULL`：

```
SELECT U.*
FROM Users U
    LEFT JOIN Banned B ON B.userId = U.userId
WHERE U.isActive = 1
    AND U.status <> 'disabled'
    AND B.userId IS NULL -- no match in the Banned table. 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-10-29T19:56:40.423

```
select u.*
from Users u
left outer join Banned b on u.userId = b.userId
where u.isActive = 1
    and u.status <> 'disabled'
    and b.UserID is null 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-05-07T11:11:04.630

```
SELECT u.*
FROM Users u
LEFT JOIN Banned b ON u.userId = b.userId AND b.userRoles = 'VIP'
WHERE u.isActive = 1 AND b.id IS NULL 
```

如果您需要结果并且应该排除某些内容并且它不是表的键 ID，请使用它。

# c# - 将 XmlDoc 注释与数据一起序列化

> ID：13128637
> 
> 赞同：4
> 
> 时间：2012-10-29T19:53:55.180
> 
> 标签：c#, xml, serialization, xml-documentation

我有一个可序列化的类，我想用它的数据（当然）和它的 XmlDoc 注释进行序列化。有谁知道现有的图书馆可以完成这项工作，或者至少是其中的一部分？

以 Intellisense 的方式读取 C# 代码的 XmlDoc 是一个很好的起点。

因为示例胜于理论，所以我想要以下（C#）代码

```
public class ApplicationOptions : ISerializable
{
    ///<summary>This parameter describes the X property</summary>
    public int WindowPositionX;

    ///<summary>This comment is the same as in the XML-serialized form</summary>
    public int WindowPositionY;
} 
```

映射到以下序列化 XML 表单

```
<!--This parameter describes the X property-->
<parameter name="WindowPositionX" Value=12 />

<!--This comment is the same as in the XML-serialized form-->
<parameter name="WindowPositionY" Value=13 /> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T20:13:24.877

我不知道有什么库可以做到这一点，您可以为类编写自定义序列化程序并使用自定义序列化程序添加注释，如下所示：[How to write a comment to an XML file when using the XmlSerializer?](https://stackoverflow.com/questions/7385921/how-to-write-a-comment-to-an-xml-file-when-using-the-xmlserializer)

但是您必须阅读 yourlibraryfile.xml 配套文件才能获得评论，评论不会与应用程序一起编译。

# windows - 尝试 Catch 多线程 C#

> ID：13128639
> 
> 赞同：0
> 
> 时间：2012-10-29T19:53:57.650
> 
> 标签：windows, forms, try-catch

我有一个同时运行 2 个线程的程序。每个方法都被try and catch包围着。如果其中一个线程创建异常，它是否也会阻止另一个线程工作？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T20:00:55.083

不，它只会停止当前线程。另一个线程将继续工作。

异常被存储在每个线程的堆栈中。

您可以使用异步委托在线程之间传递异常信息：

[捕获异步回调中抛出的异常](https://stackoverflow.com/questions/8748645/catching-an-exception-thrown-in-an-asynchronous-callback)

# jquery - 我不能单击到 div 已在具有 slideDown 的 div 内。jQuery

> ID：13128640
> 
> 赞同：0
> 
> 时间：2012-10-29T19:53:58.610
> 
> 标签：jquery, jquery-selectors

我有这个页面[http://nelsonpatojimenez.com/startupchile.org/joinastartup/](http://nelsonpatojimenez.com/startupchile.org/joinastartup/)，但是当我尝试单击“成为其中的一部分”时，回调到 slideDown 函数。

当您单击启动时，此代码隐藏并显示作业

```
 $('section.listjobs').on('click', '.jobgroup', function(e){
            var classes = $(this).attr('class');
            var id = $(this).attr('id');

            if ($(this).children(':last').hasClass('hidedescription')) {
                $(this).children().slideDown('slow').fadeIn('slow').removeClass('hidedescription');
                $(this).css('border-bottom','0px');
            }else{
                var div = $(this).children(':last');
                var divdiv = div.children(':last');
                var divdivdiv = divdiv.children(':last');

                $(this).children(':last').slideUp('slow').addClass('hidedescription');
                $(this).css('border-bottom','1px dashed #0071A0');
            };          
            e.preventDefault();
        }); 
```

当我点击“成为其中的一部分”时，我需要它，这会转到下一页。

任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T20:56:41.040

问题是我最后有这条线。

```
e.preventDefault(); 
```

删除此行时，href 将我发送到下一页。

:D，非常感谢您的回答。

# android - 浏览器截断地址中的端口号

> ID：13128645
> 
> 赞同：2
> 
> 时间：2012-10-29T19:54:11.770
> 
> 标签：android, redirect, web

我遇到了以下问题：我开发了一个基于 Tomcat 和 Apache 的 webapp (at `http://82.xx.xx.xx:8030/app`)，当它通过桌面浏览器和移动浏览器访问时，它运行良好。但是现在，我尝试通过新的 Android 4.0 平板电脑访问，当我登录应用程序时，浏览器（默认的 android 浏览器和 chrome）会抛出一条消息，指出 url`http://82.xx.xx.xx/app`不可用。

问题是浏览器删除了端口，有人知道我能做些什么来解决这个问题吗？

# python - Matplotlib - 财务量叠加

> ID：13128647
> 
> 赞同：16
> 
> 时间：2012-10-29T19:54:17.397
> 
> 标签：python, numpy, matplotlib, scipy

我正在制作包含两个数据集的烛台图：[开盘价、最高价、最低价、收盘价] 和成交量。我正在尝试像这样覆盖图表底部的交易量：

![finviz.com](../Images/c779b7944ac6ee8cc693c4066dec79b7.png)

我正在调用[volume_overlay3](http://doc.astro-wise.org/matplotlib.finance.html#-volume_overlay3)，但它不是条形，而是填充了整个绘图区域。我究竟做错了什么？

![volume_overlay3](../Images/3e11a39bb7161b998507235007777f7c.png)

我的另一个选择是使用 .bar()，它没有上下颜色，但如果我能得到正确的比例，它会起作用：

![在此处输入图像描述](../Images/f6b7f793983704d1958ce5873b359fc0.png)

```
fig = plt.figure()
ax = fig.add_subplot(1,1,1)

candlestick(ax, candlesticks)

ax2 = ax.twinx()

volume_overlay3(ax2, quotes)

ax2.xaxis_date()

ax2.set_xlim(candlesticks[0][0], candlesticks[-1][0])

ax.yaxis.set_label_position("right")
ax.yaxis.tick_right()

ax2.yaxis.set_label_position("left")
ax2.yaxis.tick_left() 
```

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-11-04T04:51:03.913

volume_overlay3 对我不起作用。因此，我尝试了您的想法，将条形图添加到烛台图。

在为交易量创建双轴后，重新定位该轴（使其变短）并修改烛台 y 数据的范围以避免碰撞。

```
import numpy as np
import matplotlib
import matplotlib.pyplot as plt
# from matplotlib.finance import candlestick
# from matplotlib.finance import volume_overlay3
# finance module is no longer part of matplotlib
# see: https://github.com/matplotlib/mpl_finance
from mpl_finance import candlestick_ochl as candlestick
from mpl_finance import volume_overlay3
from matplotlib.dates import num2date
from matplotlib.dates import date2num
import matplotlib.mlab as mlab
import datetime

datafile = 'data.csv'
r = mlab.csv2rec(datafile, delimiter=';')

# the dates in my example file-set are very sparse (and annoying) change the dates to be sequential
for i in range(len(r)-1):
    r['date'][i+1] = r['date'][i] + datetime.timedelta(days=1)

candlesticks = zip(date2num(r['date']),r['open'],r['close'],r['max'],r['min'],r['volume'])

fig = plt.figure()
ax = fig.add_subplot(1,1,1)

ax.set_ylabel('Quote ($)', size=20)
candlestick(ax, candlesticks,width=1,colorup='g', colordown='r')

# shift y-limits of the candlestick plot so that there is space at the bottom for the volume bar chart
pad = 0.25
yl = ax.get_ylim()
ax.set_ylim(yl[0]-(yl[1]-yl[0])*pad,yl[1])

# create the second axis for the volume bar-plot
ax2 = ax.twinx()

# set the position of ax2 so that it is short (y2=0.32) but otherwise the same size as ax
ax2.set_position(matplotlib.transforms.Bbox([[0.125,0.1],[0.9,0.32]]))

# get data from candlesticks for a bar plot
dates = [x[0] for x in candlesticks]
dates = np.asarray(dates)
volume = [x[5] for x in candlesticks]
volume = np.asarray(volume)

# make bar plots and color differently depending on up/down for the day
pos = r['open']-r['close']<0
neg = r['open']-r['close']>0
ax2.bar(dates[pos],volume[pos],color='green',width=1,align='center')
ax2.bar(dates[neg],volume[neg],color='red',width=1,align='center')

#scale the x-axis tight
ax2.set_xlim(min(dates),max(dates))
# the y-ticks for the bar were too dense, keep only every third one
yticks = ax2.get_yticks()
ax2.set_yticks(yticks[::3])

ax2.yaxis.set_label_position("right")
ax2.set_ylabel('Volume', size=20)

# format the x-ticks with a human-readable date. 
xt = ax.get_xticks()
new_xticks = [datetime.date.isoformat(num2date(d)) for d in xt]
ax.set_xticklabels(new_xticks,rotation=45, horizontalalignment='right')

plt.ion()
plt.show() 
```

![阴谋](../Images/faa109afcf879290d6e12f695beb4432.png)

data.csv 在这里： [http ://pastebin.com/5dwzUM6e](http://pastebin.com/5dwzUM6e)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-22T16:03:18.740

[在这里](https://stackoverflow.com/questions/17251871/adding-volume-overlay-in-matplotlib/17252516?noredirect=1#17252516)查看答案。显然是一个错误，它将被修复。

现在，您需要将`volume_overlay3`调用返回的集合分配给一个变量，然后将其添加到图表中。

```
vc = volume_overlay3(ax2, quotes)
ax2.add_collection(vc) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-02T03:01:03.200

如果您想将图表堆叠在一起（即在同一轴上绘制它们），请使用：

```
plt.hold(True) 
```

# objective-c - 是否有可能有一个“#pragma mark”层次结构？

> ID：13128648
> 
> 赞同：13
> 
> 时间：2012-10-29T19:54:23.857
> 
> 标签：objective-c, xcode, categories, pragma

我`#pragma mark - Description`经常使用 Xcode 来组织我的方法。但是，我发现有时我需要为我的方法设置类别和子类别，如下所示：

> *   公共方法
>     
>     
>     *   辅助方法
>         *   一个方法
>     *   其他类型的方法
>         *   另一种方法
> *   私有方法
>     
>     
>     *   某种方法
>         *   私有方法

这可能吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-10-29T20:09:58.017

只需使用`-`主要部分之前和之后将其包围在行中，排除子部分的破折号，然后方法名称将一如既往地显示。

```
#pragma mark - Public Methods -
#pragma mark Helper Methods
- (void)aMethod{}
#pragma mark Other Type of Methods
- (void)anotherMethod{}

#pragma mark - Private Methods -
#pragma mark Some Type of Method
- (void)aPrivateMethod{} 
```

* * *

![在此处输入图像描述](../Images/fff054d5dba7af525060f60935368914.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-04-30T09:34:32.323

您可以使用以下任意组合：

1.  前连字符`Description`- 在描述上方放置一个分隔符

`#pragma mark - Description`

2.  连字符后`Description`- 在描述下方放置一个分隔符

`#pragma mark Description -`

3.  前后连字符`Description`- 在描述的上方和下方放置分隔符

`#pragma mark - Description -`

[![截屏](../Images/f435a9ffd3c43ab5461d80f80bc0dcef.png)](https://i.stack.imgur.com/T8n4y.png)

此外，如果您只需要分隔符而不需要描述，只需使用`#pragma mark`or `#pragma mark -`。

# java - C++ STL 数据结构与 Java 的比较

> ID：13128651
> 
> 赞同：12
> 
> 时间：2012-10-29T19:54:34.123
> 
> 标签：java, c++

我目前正在学习 C++ 并试图习惯它附带的标准数据结构，但它们看起来都很简单。例如，list 没有像我在 Java 中习惯的 get(index) 这样的简单访问器。pop_back 和 pop_front 等方法也不返回列表中的对象。因此，您必须执行以下操作：

```
Object blah = myList.back();
myList.pop_back(); 
```

而不是像这样简单的东西： `Object blah = myList.pop_back();`

在 Java 中，几乎每个数据结构都会返回对象，因此您不必进行这些额外的调用。为什么 C++ 的 STL 容器是这样设计的？我在 Java 中执行的此类常见操作对于 C++ 来说不是很常见吗？

编辑：对不起，我想我的问题措辞很糟糕，无法获得所有这些反对意见，但肯定有人可以编辑它。为了澄清，我想知道为什么 STL 数据结构与 Java 相比是这样创建的。还是我一开始就使用了错误的数据结构集？我的观点是，这些看起来像是您可能在（在我的示例中）列表上使用的常见操作，并且每个人肯定不想每次都编写自己的实现。

编辑：将问题改写为更清楚。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-29T21:15:38.247

很多人已经回答了你提出的具体问题，所以我会试着看一下大图。

Java 和 C++ 之间必须的根本区别之一是 C++ 主要处理值，而 Java 主要处理引用。

例如，如果我有类似的东西：

```
class X {
    // ...
};

// ...
X x; 
```

在 Java 中，`x`它只是对 X 类型对象的*引用*。为了有一个实际的类型对象`X`供它引用，我通常有类似的东西：`X x = new X;`. 然而，在 C++ 中，`X x;`本身定义了一个类型为 的对象`X`，而不仅仅是对对象的引用。我们可以直接使用该对象，而不是通过引用（即伪装的指针）。

尽管这最初看起来似乎是一个相当微不足道的差异，但其影响是巨大且普遍的。一个效果（在这种情况下可能是最重要的）是在 Java 中，返回值根本*不*涉及复制对象本身。它只涉及复制对该值的引用。这通常被认为非常便宜并且（可能更重要的是）完全安全——它永远不会抛出异常。

在 C++ 中，您直接处理值。当您返回一个对象时，您不仅返回了对现有对象的引用，而且还返回了该对象的值，通常以该对象状态副本的形式。当然，如果您愿意，也可以返回一个引用（或指针），但要做到这一点，您必须使其明确。

标准容器（如果有的话）甚至更倾向于使用值而不是引用。当您向集合添加值时，添加的是您传递的值的副本，当您返回某些内容时，您将获得容器本身中值的副本。

除此之外，这意味着虽然返回值*可能*像在 Java 中一样便宜且安全，但它也可能很昂贵和/或引发异常。如果程序员*想要*存储指针，他/她当然可以这样做——但这种语言不像 Java 那样*需要*它。由于返回对象*可能*很昂贵和/或抛出异常，因此标准库中的容器*通常*是围绕确保在复制成本高昂时它们可以正常工作的，并且（更重要的是）即使在/如果复制引发异常时也能正常工作。

设计上的这种基本差异不仅说明了您指出的差异，而且还说明了更多差异。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-29T20:05:50.230

`back()`返回对向量最后一个元素的引用，这使得它几乎可以自由调用。 `pop_back()`调用向量的最后一个元素的析构函数。

所以显然`pop_back()`不能返回对被破坏元素的引用。因此，要使您的语法正常工作，`pop_back()`必须在元素被销毁之前返回该元素的副本。

现在，如果您不想要该副本，我们只是不必要地制作了一个副本。

C++ 标准容器的目标是为您提供近乎裸机的性能，并以美观、易于使用的方式包装。在大多数情况下，它们不会为了易用性而牺牲性能——`pop_back()`返回最后一个元素的副本会为了易用性而牺牲性能。

可能有一个pop-and-get-back 方法，但它会复制其他功能。在许多情况下，它的效率会低于 back-and-pop。

作为一个具体的例子，

```
vector<foo> vec; // with some data in it
foo f = std::move( vec.back() ); // tells the compiler that the copy in vec is going away
vec.pop_back(); // removes the last element 
```

请注意，移动必须在元素被销毁之前完成以避免创建额外的临时副本...... `pop_back_and_get_value()`必须在元素返回之前销毁元素，并且分配将在它返回之后发生，这是浪费的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-29T20:11:22.650

列表没有 get(index) 方法，因为通过索引访问链表效率非常低。STL 的理念是只提供可以在一定程度上有效实施的方法。如果您想在效率低下的情况下按索引访问列表，那么您自己很容易实现。

pop_back不返回副本的原因是函数返回后会调用返回值的拷贝构造函数（RVO/NRVO除外）。如果此复制构造函数引发异常，则您已从列表中删除该项目而没有正确返回副本。这意味着该方法不是异常安全的。通过分离这两个操作，STL 鼓励以异常安全的方式进行编程。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-10-29T20:58:02.827

> 为什么 C++ 的 STL 容器是这样设计的？

我认为 Bjarne Stroustrup[说得最好](http://accu.org/index.php/journals/1356)：

> C++ 精益求精。基本原则是你不用为你不使用的东西付费。

对于`pop()`将返回项目的方法，请考虑为了既删除项目又返回项目，该项目不能通过引用返回。所指对象不再存在，因为它刚刚被`pop()`编辑。它可以通过指针返回，但前提是您`new`复制原始文件，这是浪费。因此，它很可能按有可能进行深层复制的值返回。在许多情况下，它不会进行深度复制（通过复制省略），而在其他情况下，深度复制将是微不足道的。但在某些情况下，例如大缓冲区，该副本可能非常昂贵，而在少数情况下，例如资源锁，它甚至可能是不可能的。

C++ 旨在通用，并且旨在尽可能快。通用并不一定意味着“易于用于简单的用例”，而是“适用于最广泛的应用程序的平台”。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-10-29T19:58:55.070

关于`pop()`-like 函数，有两件事（至少）需要考虑：

`pop_back()`1) 对于退货或`pop_front()`没有什么可退货的情况，没有明确和安全的行动。

2) 这些函数将按值返回。如果在容器中存储的类型的复制构造函数中抛出异常，则该项目将从容器中删除并丢失。我想这被认为是不受欢迎和不安全的。

关于列表的访问，标准库的一般设计原则是不避免提供低效的操作。`std::list`是一个双链表，通过索引访问列表元素意味着从头或尾遍历列表，直到到达所需的位置。如果你想这样做，你可以提供你自己的帮助函数。但是，如果您需要随机访问元素，那么您可能应该使用列表以外的结构。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-10-29T20:06:24.263

> list 甚至没有像 get(index) 这样的简单访问器

为什么要呢？一种允许您从 中访问第 n 个元素的方法`list`会隐藏操作的复杂性，`O(n)`这就是 C++ 不提供它的原因。出于同样的原因，C++`std::vector`不提供`pop_front()`函数，因为该函数也具有`O(N)`向量的大小。

> pop_back 和 pop_front 等方法也不返回列表中的对象。

[原因是异常安全。](https://stackoverflow.com/q/12600330/500104)此外，由于 C++ 具有自由函数，因此不难为操作`std::list`或任何标准容器编写这样的扩展。

```
template<class Cont>
typename Cont::value_type return_pop_back(Cont& c){
  typename Cont::value_type v = c.back();
  c.pop_back();
  return v;
} 
```

不过应该注意的是，上述函数不是异常安全的，这意味着如果`return v;`抛出异常，您将拥有一个已更改的容器和一个丢失的对象。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-10-29T21:02:32.837

在 Java`pop`中一个通用接口可以返回对弹出对象的引用。

在 C++ 中，返回对应的是按值返回。

但在不可移动的非 POD 对象的情况下，复制构造可能会引发异常。然后，一个元素将被删除，但客户端代码无法访问。始终可以根据更基本的检查器和纯 popper 来定义便利的按值返回 popper，但*反之*则不然。

这也是哲学上的差异。

对于 C++，标准库只提供基本的构建块，而不是直接可用的功能（通常）。这个想法是您可以从数千个第三方库中自由选择，但选择自由需要*付出巨大的代价*，在可用性、可移植性、培训等方面。相比之下，使用 Java，您几乎拥有您需要的一切（对于标准库中的典型 Java 编程），但您实际上不能自由选择（这是另一种成本）。

# c++ - 深度模板不起作用 - DirectX 10 C++

> ID：13128652
> 
> 赞同：4
> 
> 时间：2012-10-29T19:54:34.590
> 
> 标签：c++, directx, depth, stencil-buffer

我有一个 DirectX10 + C++ 问题。

基本上我们处于渲染的早期阶段，出于某种原因，我们的深度模板似乎无法理解我们的模型。基本上，这是我们正在做的一切：

1.  加载着色器、模型和纹理
2.  初始化 DirectX
3.  画

模型、着色器和纹理都加载并正常工作，但是（如下面的屏幕截图所示），深度模板显然没有完成它的工作，并且着色器被用在了错误的地方。我还包括了我们的初始化方法，以防您需要它来解决。我们相信我们已经尝试了几乎所有东西，但是知道我们的运气我们可能错过了 1 行重要代码 ^.^

我们还看到其他人也有同样的问题，但他们的修复没有奏效（他们的问题是他们将近剪裁平面设置为 0.0，但我们的不是 0.0，所以这不是问题）

提前致谢！

[问题截图](http://www.sonic3hd.com/database/uploads/DummyGameError.png)

```
void GraphicsDeviceDirectX::InitGraphicsDevice(HWND hWnd)
{
    DXGI_SWAP_CHAIN_DESC scd;    // create a struct to hold various swap chain information

    ZeroMemory(&scd, sizeof(DXGI_SWAP_CHAIN_DESC));    // clear out the struct for use

    scd.BufferCount = 2;    // create two buffers, one for the front, one for the back
    scd.BufferDesc.Format = DXGI_FORMAT_R8G8B8A8_UNORM;    // use 32-bit color
    scd.BufferDesc.Height = 600;
    scd.BufferDesc.Width = 600;
    scd.BufferUsage = DXGI_USAGE_RENDER_TARGET_OUTPUT;    // tell how the chain is to be used
    scd.OutputWindow = hWnd;    // set the window to be used by Direct3D
    scd.SampleDesc.Count = 1;    // set the level of multi-sampling
    scd.SampleDesc.Quality = 0;    // set the quality of multi-sampling
    scd.Windowed = true;    // set to windowed or full-screen mode

    //set scan line ordering and scaling
    scd.BufferDesc.ScanlineOrdering = DXGI_MODE_SCANLINE_ORDER_UNSPECIFIED;
    scd.BufferDesc.Scaling = DXGI_MODE_SCALING_UNSPECIFIED;

    //discard back buffer dontents
    scd.SwapEffect = DXGI_SWAP_EFFECT_DISCARD;

    //dont set advanced flags
    scd.Flags = 0;

    // create a device class and swap chain class using the information in the scd struct
    if(FAILED(D3D10CreateDeviceAndSwapChain(NULL,
                                  D3D10_DRIVER_TYPE_HARDWARE,
                                  NULL,
                                  D3D10_CREATE_DEVICE_DEBUG,
                                  D3D10_SDK_VERSION,
                                  &scd,
                                  &swapchain,
                                  &device)))
    {
        throw EngineException("Error creating graphics device");
    }

    //Push graphics device to Persistant Object Manager
    //PerObjMan::Push(device);
    //Push swapchain to Peristant Object Manager
    PerObjMan::Push(swapchain);

    // get the address of the back buffer and use it to create the render target
    ID3D10Texture2D* pBackBuffer;
    swapchain->GetBuffer(0, __uuidof(ID3D10Texture2D), (LPVOID*)&pBackBuffer);
    device->CreateRenderTargetView(pBackBuffer, NULL, &rtv);

    /*D3D10_TEXTURE2D_DESC descBack;
    pBackBuffer->GetDesc(&descBack);*/
    pBackBuffer->Release();
    pBackBuffer = NULL;

    //Push graphics device to Persistant Object Manager
    PerObjMan::Push(rtv);

    ID3D10Texture2D* pDepthStencil = NULL;
    D3D10_TEXTURE2D_DESC descDepth;

    ZeroMemory(&descDepth, sizeof(descDepth));

    descDepth.Width = 600;
    descDepth.Height = 600;
    descDepth.MipLevels = 1;
    descDepth.ArraySize = 1;
    descDepth.Format = DXGI_FORMAT_D24_UNORM_S8_UINT;
    descDepth.SampleDesc.Count = 1;
    descDepth.SampleDesc.Quality = 0;
    descDepth.Usage = D3D10_USAGE_DEFAULT;
    descDepth.BindFlags = D3D10_BIND_DEPTH_STENCIL;
    descDepth.CPUAccessFlags = 0;
    descDepth.MiscFlags = 0;
    HRESULT hr;
    hr = GetGraphicsDevice()->CreateTexture2D( &descDepth, NULL, &pDepthStencil );
    if(FAILED(hr))
        throw EngineException("FAIL");

    PerObjMan::Push(pDepthStencil);

    D3D10_DEPTH_STENCIL_DESC dsDesc;

    ZeroMemory(&dsDesc, sizeof(dsDesc));
    // Depth test parameters
    dsDesc.DepthEnable = true;
    dsDesc.DepthWriteMask = D3D10_DEPTH_WRITE_MASK::D3D10_DEPTH_WRITE_MASK_ALL;
    dsDesc.DepthFunc = D3D10_COMPARISON_FUNC::D3D10_COMPARISON_LESS;

    // Stencil test parameters
    dsDesc.StencilEnable = false;
    dsDesc.StencilReadMask = 0xFF;
    dsDesc.StencilWriteMask = 0xFF;

    // Stencil operations if pixel is front-facing.
    dsDesc.FrontFace.StencilFailOp = D3D10_STENCIL_OP_KEEP;
    dsDesc.FrontFace.StencilDepthFailOp = D3D10_STENCIL_OP_INCR;
    dsDesc.FrontFace.StencilPassOp = D3D10_STENCIL_OP_KEEP;
    dsDesc.FrontFace.StencilFunc = D3D10_COMPARISON_ALWAYS;

    // Stencil operations if pixel is back-facing.
    dsDesc.BackFace.StencilFailOp = D3D10_STENCIL_OP_KEEP;
    dsDesc.BackFace.StencilDepthFailOp = D3D10_STENCIL_OP_DECR;
    dsDesc.BackFace.StencilPassOp = D3D10_STENCIL_OP_KEEP;
    dsDesc.BackFace.StencilFunc = D3D10_COMPARISON_ALWAYS;      

    // Create depth stencil state
    hr = device->CreateDepthStencilState(&dsDesc, &dss);
    if(FAILED(hr))
        throw EngineException("FAIL");

    // Bind depth stencil state
    device->OMSetDepthStencilState(dss, 1);

    PerObjMan::Push(dss);

    D3D10_DEPTH_STENCIL_VIEW_DESC descDSV;

    ZeroMemory(&descDSV, sizeof(descDSV));

    descDSV.Format = descDepth.Format;
    descDSV.ViewDimension = D3D10_DSV_DIMENSION::D3D10_DSV_DIMENSION_TEXTURE2D;
    descDSV.Texture2D.MipSlice = 0;

    // Create the depth stencil view
    hr = device->CreateDepthStencilView( pDepthStencil, // Depth stencil texture
                                         &descDSV, // Depth stencil desc
                                         &dsv );  // [out] Depth stencil view

    if(FAILED(hr))
        throw EngineException("FAIL");

    PerObjMan::Push(dsv);

    // Bind the depth stencil view
    device->OMSetRenderTargets( 1,          // One rendertarget view
                                &rtv,      // Render target view, created earlier
                                dsv);     // Depth stencil view for the render target

    D3D10_VIEWPORT viewport;    // create a struct to hold the viewport data

    ZeroMemory(&viewport, sizeof(D3D10_VIEWPORT));    // clear out the struct for use

    GameToImplement::GameInfo::Info info = GameToImplement::GameInfo::GetGameInfo();

    RECT rect;
    int width = 0;
    int height = 0;
    if(GetClientRect(hWnd, &rect))
    {
        width = rect.right - rect.left;
        height = rect.bottom - rect.top;
    }
    else
    {
        throw EngineException("");
    }

    viewport.TopLeftX = 0;    // set the left to 0
    viewport.TopLeftY = 0;    // set the top to 0
    viewport.Width = 600;    // set the width to the window's width
    viewport.Height = 600;    // set the height to the window's height
    viewport.MinDepth = 0.0f;
    viewport.MaxDepth = 1.0f;

    device->RSSetViewports(1, &viewport);    // set the viewport

}
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T10:50:32.233

我修好了它，多亏了 catflier 朝正确的方向点头。事实证明，我实际上太早地释放了光栅化器状态，​​以至于无法使用深度模板。

我会把这个答案留给有同样问题的人。

# asp.net-mvc - 使用 OutputCache 随机用户必须支付费用

> ID：13128654
> 
> 赞同：0
> 
> 时间：2012-10-29T19:54:48.130
> 
> 标签：asp.net-mvc, outputcache

我正在使用 OutputCache 来避免每次都执行相同的代码，但是我遇到了以下问题：

当它到期时，随机用户必须支付执行此代码的成本。能避免吗？？

我正在使用 asp.net MVC 4.0。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T20:17:26.067

如果数据真的不可变，您可以将 Duration 属性设置为最大值并忘记。

但是，如果缓存条目过期，无论如何您都必须加载新数据。按照设计，OutputCacheAttribute 只允许按需加载数据。如果你想预缓存数据，你应该发明自己的缓存机制，或者以某种方式扩展 OutputCacheAttribute。

# android - 使用 GPS 位置管理器检索最后一个已知位置时，Android 应用程序崩溃

> ID：13128655
> 
> 赞同：0
> 
> 时间：2012-10-29T19:54:57.320
> 
> 标签：android

需要明确的是：这是我的 Android 应用程序中的一个活动，旨在使用 GPS_PROVIDER 提取用户位置的坐标。Activity 包含一个按钮，当按下该按钮时，应该启动一个获取坐标数据的方法。问题是当没有先前已知的位置信息时（即如果手机最近重置），应用程序会崩溃。如果我打开地图应用程序（例如）并确定我的位置，然后重新打开我自己的应用程序并运行此方法，它会按预期工作。我的问题是为什么会发生这种崩溃和/或如何防止发生这种崩溃？感谢您的帮助，谢谢。

此方法在按下按钮时运行 - 并且在正确找到坐标时生成意图响应回调用活动：

```
protected void getCurrentLocation() {
    Location location = null;
    try {
        location = locationManager.getLastKnownLocation(LocationManager.GPS_PROVIDER);
    } catch (IllegalArgumentException iae) { }

    if (location != null) {
        longV = location.getLongitude();
        latV  = location.getLatitude();
        response(longV, latV);
    } else {
        getCurrentLocation();
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-29T20:00:04.347

我猜你正在收到一个 StackOverflowException，因为如果`location`你`null`调用完全相同的函数来创建一个无限循环......

如果没有最后知道的位置，您需要请求一个新位置。（`getLastKnownLocation()`无论调用多少次都不会自行改变。）

# facebook - 具有开放图形操作的反向地理定位

> ID：13128657
> 
> 赞同：1
> 
> 时间：2012-10-29T19:55:00.720
> 
> 标签：facebook, facebook-graph-api, facebook-opengraph, reverse-geocoding

我正在开发一个应用程序，它具有关联的 lat，long 以及开放图中的操作。目前，api 只允许一个地方，所以我创建了自己的位置对象，它可以是动作的属性。

我在这里看到的问题是，这不会以 Facebook 的方式构成行动的一部分。

我不想使用 Facebook 地点，也不想让用户在执行操作时创建地点。

我不需要很多粒度，相反，只需要“近 $locality”，例如村庄名称或国家公园（如果不存在住宅地址）。这似乎是 Facebook 消息所发生的情况。

我们是否知道从 Facebook 或其他（免费）来源获取低保真数据的方法，允许将位置信息附加到操作？

干杯

# jquery - jquery循环寻呼机没有初始化

> ID：13128661
> 
> 赞同：1
> 
> 时间：2012-10-29T19:55:13.997
> 
> 标签：jquery, cycle

我在页面上使用了 jquery 循环插件作为滑块，但是在我的代码中，寻呼机甚至不想运行 init..

使用此代码：

```
$('#slider').cycle({
    fx: 'fade',
    timeout: 8000,
    speed: 1000,
    prev: '#slider_prev',
    next: '#slider_next',
    pager: '#nav',
    pagerAnchorBuilder: function(idx, slide) {
        alert("AAA");
        return '<li><a href="#"><img src="' + slide.src + 
                     '" width="50" height="50" /></a></li>';
    }
});​ 
```

它应该在构建寻呼机时发出警报，但它甚至不运行寻呼机构建器功能..

这是一个[示例页面](http://dream.dreamware.cz/)。

谁能告诉我，我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T14:28:44.860

我认为你应该使用完整版的循环插件

[http://malsup.github.com/jquery.cycle.all.js](http://malsup.github.com/jquery.cycle.all.js)

显然版本“pager”版本不支持它“jquery.cycle.lite.js”

# ruby-on-rails - rspec 文件中的文件名约定

> ID：13128662
> 
> 赞同：1
> 
> 时间：2012-10-29T19:55:16.087
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rspec, naming-conventions, rspec2

我在 Hartl 的 Ruby on Rails 教程中注意到他使用 rails generate 来创建 rspec 文件。例如，

```
rails generate integration_test static_pages 
```

创建文件`static_pages_spec.rb`。我的问题是，文件名是否有命名约定？

`describe`此外，和之间的文本是否有命名约定`do`？我知道编写类似的东西`/people/new`会在测试视图时自动设置渲染，所以我需要做的就是 write `render`，但是 rspec 中还有哪些其他命名约定？

# ruby-on-rails - JSON 与 RubyValidations。如何定义错误？

> ID：13128664
> 
> 赞同：0
> 
> 时间：2012-10-29T19:55:16.180
> 
> 标签：ruby-on-rails, json

我试图用一条`$.parseJSON(xhr.responseText).errors`警告消息来捕获验证消息，但我如何“未定义”，但我不明白为什么。

这是我的验证：

```
validates :upload_file_name,  :presence   => true,
                                :format     =>{:with => %r{\.(jpg)$}i,:message =>"It should be a pdf File"}

  validates_uniqueness_of :upload_file_name, :message => "blabla"

  validates :upload_file_size,  :inclusion  => {:in =>1.megabytes..20.megabytes,:message=>"bla"} 
```

json:

```
format.json{ render json: {error: @upload.errors.full_messages}, :status =>422} 
```

和javascript：

```
 $('#fileupload').fileupload({       

        error: function(xhr){
          var errors = $.parseJSON(xhr.responseText).errors
          alert(errors)         
        }
              }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T20:32:58.957

您的控制器中输入错误，将其更改为以下内容即可

```
format.json{ render json: {errors: @upload.errors.full_messages}, :status =>422} 
```

# chef-infra - 厨师轻量级资源提供者不工作

> ID：13128670
> 
> 赞同：0
> 
> 时间：2012-10-29T19:55:34.700
> 
> 标签：chef-infra

我创建了一个 LWRP（我的第一次），但它似乎没有按要求工作。我不确定我是否遗漏了什么或做错了什么。操作码文档很糟糕。我在下面显示了我的代码：

**提供者**

```
puts "FOO"

def restart_process
  @svc = Chef::Resource::RestartProcesses.new(new_resource.name)
  Chef::Log.debug("Restarting services according to the box")
  notifies :run, resources(:execute => 'restart-storm')
end

puts "BAR"

action :restart do

  execute 'restart-process' do
    command <<-EOH
      echo "-------Executing restart process--------"
      #Some bash code
    EOH
  end
end 
```

**资源**

```
actions :restart

attribute :name, :kind_of => String, :name_attribute => true

def initialize(*args)
  super
  @action = :restart
end 
```

**调用资源的配方**

```
template "#{install_dir}/####Something" do
  source "someSource.erb"
  variables(
    ###Some variables
  )

  notifies :run, 'nameOfCookbook_nameOfResource[process]'
end

nameOfCookbook_nameOfResource "process" do
  action :nothing
end 
```

厨师输出显示**FOO BAR**但它没有在我的*bash*脚本中打印任何内容。所以它不会运行 bash。任何指针？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T13:23:12.567

您不需要告诉实例运行操作吗：restart

像

```
restart = nameOfCookbook_nameOfResource "process" do
  action :nothing
end

restart.run_action(:restart) 
```

我知道您已将初始化设置为重新启动，但我认为传递操作 :nothing 会覆盖它，因此请按照上述示例强制它在您需要时运行，或者在模板部分中通知您想要的实际操作

```
notifies :restart 
```

通过自己运行它，我看到了一个 :nothing 仅在资源上执行的操作。不是在我的情况下的默认行为 :stop

通过将通知更改为 :stop 它具有预期的行为。

我从日志中的理解是你已经告诉你的资源运行，但它的动作是 :nothing 所以它什么也不做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T15:31:39.380

确保您的

```
notifies :run, 'nameOfCookbook_nameOfResource[process]' 
```

在实际计划运行的模板中。（例如，使用调试输出）。因为如果文件已经存在，则什么都不会做，所以也重新启动。

# javascript - 在使用 node.js 设置 HTTPS 代理时需要帮助，该代理会从浏览器窗口中获取所有 HTTPS 请求

> ID：13128681
> 
> 赞同：0
> 
> 时间：2012-10-29T19:56:35.913
> 
> 标签：javascript, node.js

我想使用 node.js 设置一个 HTTPS 代理服务器。它需要从浏览器窗口中获取所有 HTTPS 请求。我有一本 mac 书，我已经从 HTTPS 的首选项中配置了代理设置。下面是捕获任何浏览器请求的示例代码，该代码是否正确？我正在使用以下命令生成密钥。

```
 openssl genrsa -out privatekey.pem 1024
 openssl req -new -key privatekey.pem -out certrequest.csr
 openssl x509 -req -in certrequest.csr -signkey privatekey.pem -out certificate.pem

var options = {
https: {
    key: fs.readFileSync('privatekey.pem', 'utf8'),
    cert: fs.readFileSync('certificate.pem', 'utf8')
},
target: {
    https: true
}
};

https.createServer(options,function(request, response) {
console.log(request);
handleRequest(request, response);
}).listen(8877); 
```

所以上面的代码不起作用，任何建议我如何解决这个问题，在此先感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T21:59:46.350

现在我知道你改变了`host`，我认为你应该构建一个使用[request](https://github.com/mikeal/request)执行代理的 http 服务器。[像这样的`request`](https://github.com/mikeal/request#streaming)东西（基于[文档](https://github.com/mikeal/request#streaming)）：

```
var https = require('https'),
    request = require('request');
var options = {
    https: {
        key: fs.readFileSync('privatekey.pem', 'utf8'),
        cert: fs.readFileSync('certificate.pem', 'utf8')
    },
    target: {
        https: true
    }
};

https.createServer(options,function(req, resp) {
    var otherhost = req.some_method_to_get_host;
    console.log(req);
    req.pipe(request(otherhost)).pipe(resp)
}).listen(8877); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T20:45:26.087

您可能想查看[https://github.com/nodejitsu/node-http-proxy](https://github.com/nodejitsu/node-http-proxy)，它是 node.js 的 http 代理。有了它，你所要做的就是

```
var httpProxy = require('http-proxy');
var options = {
  https: {
    key: fs.readFileSync('privatekey.pem', 'utf8'),
    cert: fs.readFileSync('certificate.pem', 'utf8')
  }
};
var port = SOME_PORT;
var host = 'SOME_HOST';
httpProxy.createServer(port, host, options).listen(8877); 
```

# java - 尝试实现 Comparable 时出错

> ID：13128684
> 
> 赞同：3
> 
> 时间：2012-10-29T19:56:41.123
> 
> 标签：java

我在我的用户类中不断收到此错误：

```
User is not abstract and does not override abstract method compareTo(User) in Comparable 
```

我不确定这意味着什么或如何使其发挥作用。我确实看过其他类似的帖子，但并不真正理解这些回复，因为它们大部分时间都特定于其他人的代码。如果需要，我可以提供有关我正在尝试做什么的更多信息。

```
public class User implements Comparable < User > {

    private String firstName;
    private String surname;
    private int booksOut;

    User(String inFirstName, String inSurname, int inBooksOut){
        this.firstName = inFirstName;
        this.surname = inSurname;
        this.booksOut = inBooksOut;
    }

    //...

} 
```

我本质上在做什么我正在从 LinkedList 创建 SortedLinkedList 类，并且我在其中添加了使用 compareTo 的方法，以便在添加数据时按升序对数据进行排序。所以当我打电话时

```
 User user1= new User("Dan", "Hill", 0); 
SortedLinkedList LibraryUser = new SortedLinkedList(); 
LibraryUser.add(user1); 
```

它创建保存在排序链表中的新对象。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T19:57:50.873

你让你的类实现了一个接口，但实际上并没有实现它的方法。

您要么需要使 User 成为一个抽象类（以便它的具体子类将需要实现接口方法），要么在 User 类中实现该方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-29T19:58:31.857

当您的类实现一个接口时，它必须实现在该接口中声明的方法，而您没有这样做。您必须实现 Comparable 接口的 compareTo(T o) 方法。查看 Comparable 的[API](http://docs.oracle.com/javase/6/docs/api/java/lang/Comparable.html#compareTo%28T%29)。

```
public class User implements Comparable < User > {

   public int compareTo(T o){

    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-29T19:57:57.490

您的类被声明为实现`Comparable`接口，但它不提供此接口中方法的实现。

您需要提供`compareTo(User anotherUser)`方法的实现。例如：

```
public int compareTo(User anotherUser) {
    String thisFullName = firstName + lastName;
    String anotherFullName = anotherUser.getFirstName() + anotherUser.getLastName();
    return thisFullName.compareTo(anotherFullName);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-29T20:02:58.203

这是 Comparable 上的 javadoc。 [http://docs.oracle.com/javase/6/docs/api/java/lang/Comparable.html](http://docs.oracle.com/javase/6/docs/api/java/lang/Comparable.html)

Comparable 有一个方法签名：

```
public int compareTo(T object); 
```

将此代码添加到您的用户类以使其工作：

```
public int compareTo(User u) {
// code to compare this user with u
// i'd recommend comparing the last names, then the first names
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-29T20:05:58.420

实现 Comparable 时，java 会查找 compareTo 的实现

例如：

（请注意，为简单起见，我将变量公开）

```
public class User implements Comparable < User > {

    public String firstName;
    public String surname;
    public int booksOut;

    User(String inFirstName, String inSurname, int inBooksOut){
        this.firstName = inFirstName;
        this.surname = inSurname;
        this.booksOut = inBooksOut;
    }

    public int compareTo(User cmp) {
        int fnCmp = firstName.compareTo(cmp.firstName);
        if (fnCmp != 0) return(fnCmp);
        int snCmp = surname.compareTo(cmp.surname);
        if (snCmp != 0) return(snCmp);
        return(cmp.booksOut-booksOut);
    }   
} 
```

# sql-server-2005 - 带有 select SQL Server 的原子更新语句

> ID：13128685
> 
> 赞同：0
> 
> 时间：2012-10-29T19:56:43.030
> 
> 标签：sql-server-2005

```
INSERT stuff
SET computed = 'working'
WHERE id = (SELECT max(id) from STUFF WHERE x = y) 
```

我想在 SQL Server 2005 SP 1 中使这个语句原子化。

有没有办法在不修改隔离级别的情况下做到这一点？

我需要模拟插入以标识列作为 pk 的表。我当前的表没有像 pk 一样的 Identity 字段，但它需要像它一样工作。所以我需要获取伪 ID 字段的最大值并添加 1，然后插入下一行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T20:39:17.657

To lock the value down, one way is to to use SERIALIZABLE isolation level.

```
DECLARE @id int;
SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;
BEGIN TRAN
SELECT TOP(1) @id id from STUFF WHERE x = y ORDER BY id DESC;
INSERT stuff (id, ...) VALUES (@id, ...);
COMMIT
SET TRANSACTION ISOLATION LEVEL READ COMMITTED; 
```

Make sure to keep it as short as possible.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T21:33:13.920

如果不能添加 IDENTITY 列，是否可以创建另一个包含 IDENTITY 列的表？然后只需插入该表并使用@@IDENTITY 即可插入需要该序列的表中。此技术将为您记住最后一个数字，因此您不会获得任何重复使用的值。

在 SQL Server 2012 之前的版本中，类似的技术用于模拟 Oracle 的序列（与表无关）。

[http://www.sqlmag.com/article/tsql3/simulating-oracle-sequences-in-t-sql-code](http://www.sqlmag.com/article/tsql3/simulating-oracle-sequences-in-t-sql-code)

如果您愿意，您可以随时将这些序列表放入单独的模式中。

# javascript - 使用 EnhancedLegendRenderer 打开和关闭系列时删除系列并使用新值重新绘制

> ID：13128687
> 
> 赞同：2
> 
> 时间：2012-10-29T19:57:10.250
> 
> 标签：javascript, jquery, jqplot

假设您有一个折线图，其中显示了图片上的系列。当您使用 EnhancedLegendRenderer 打开和关闭系列时，系列会在隐藏和可见之间切换。这就是它应该的样子。但问题是，我希望保持可见的系列可以缩放，以便具有最高 y 值的系列位于图表顶部，同时调整 y 轴上的值。下图显示了当我将具有最高值的系列切换为隐藏时的外观。

有没有一种简单或先进的方法来做到这一点？我试图通过从数据中删除它并创建一个新的 jqplot 来完全从图表中删除该系列。但后来它也不再出现在图例中。还尝试了不同的方法 chart.series[i].show = false; chart.replot(); 等，但结果相同。

[![绘图图像](../Images/7b24f380bb8fad3b8fbdb69e6fa50487.png)](https://i.stack.imgur.com/DGLLS.png) [![绘图图像](../Images/33a3b6083a5ca55a0198806efcb87e79.png)](https://i.stack.imgur.com/rLkQu.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-12T10:28:56.297

还有一个未记录的 renderOption 你可以使用它来做同样的事情：

```
seriesToggleReplot: { resetAxes: true } 
```

所以我的传说是这样的：

```
legend: {
    show: true,
    renderer: $.jqplot.EnhancedLegendRenderer,
    rendererOptions:{
        seriesToggleReplot: { resetAxes: true }
    },
    placement: 'outside'
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T22:42:44.863

没有找到任何真正的内置解决方案，所以我创建了自己的解决方法。

通过将图例中所选系列的每个 y 值设置为“0”，然后使用 chart.replot()，图表将使用剩余的系列值重新绘制。

```
var j = //index of chosen serie.
for(var i = 0;i < chart.series[j].data.length ;i++)
    {
      chart.series[j].data[i][1] = 0
      //1 is the index of the y-value.
    } 
```

# http - ASP 经典 500 错误，ASP_CLIENT_DISCONNECTED 后跟 ASP_LOG_ERROR

> ID：13128691
> 
> 赞同：0
> 
> 时间：2012-10-29T19:57:22.557
> 
> 标签：http, asp-classic

我有一个问题，对于我正在管理的网站，用户收到 500 错误。它发生在站点的许多随机位置，例如执行 Ajax 查询、从页面导航到页面等。在 IIS 错误请求日志中，我看到的是两个错误，背靠背：ASP_CLIENT_DISCONNECTED 和ASP_LOG_ERROR。用户报告问题通常发生在他们从一个页面导航到另一个页面时。出现 500 错误，它就在那里。如果他们收到错误，他们通常会刷新并消失。

错误之前的调用链如下所示。

```
ISAPI_START

CALL_ISAPI_EXTENSION

ASP_START_REQUEST

ASP_NEW_SESSION_CREATED

ASP_QUEUE_REQUEST

ASP_DEQUEUE_REQUEST

ASP_CLIENT_DISCONNECTED
    Error  17:46:48.254 

ASP_LOG_ERROR
    Error LineNumber="", ErrorCode="ASP 0147", Description="500 Server Error" 17:46:48.254 

MODULE_SET_RESPONSE_ERROR_STATUS
    ModuleName="IsapiModule", Notification="EXECUTE_REQUEST_HANDLER", HttpStatus="500", HttpReason="Server Error", HttpSubStatus="0", ErrorCode="The operation completed successfully. (0x0)", ConfigExceptionInfo="" 
```

编辑 0：我认为关键可能在于 ASP_NEW_SESSION_CREATED 行。我没有任何确凿的证据支持这一点，只是一种直觉。

关于我的环境的更多详细信息，我正在使用一个使用 .NET Framework v2.0.5.2707 的经典模式下的应用程序池。作为网站的一部分，我有两个在集成模式下使用 .NET 4.0 应用程序池的 Web 应用程序。Web 应用程序根本没有被使用，所以我认为它们不会发挥作用。

非常感谢有关如何处理此问题的任何建议。

米

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T14:49:35.010

我们找到了答案。有一个 Ajax 请求在服务器上超时并导致问题。其他一些电话确实是由于用户不耐烦。

# winapi - WH_KEYBOARD_LL 钩子不捕获自己进程中的输入

> ID：13128692
> 
> 赞同：2
> 
> 时间：2012-10-29T19:57:24.600
> 
> 标签：winapi, raw-input, setwindowshookex, wh-keyboard-ll

我正在使用低级键盘挂钩 (WH_KEYBOARD_LL) 来禁用某些输入，例如 Alt-Tab。我在带有消息泵的线程上创建了钩子，因此我可以正确处理通知。

只要我不关注创建钩子的窗口（即我的主窗口），钩子的回调函数就能够处理键盘事件，但是一旦我激活该窗口，钩子中不会出现任何事件，直到我停用再次窗口，输入改为传播到窗口的 WindowProc。

有人知道这里发生了什么吗？

**更新：**所以，事实证明这种行为是由于在同一进程中注册原始输入引起的。显然，每当我的进程窗口聚焦时，使用原始输入会导致我的低级键盘挂钩被禁用。有谁知道为什么以及如何解决这个问题？

# ant - 蚂蚁属性错误

> ID：13128694
> 
> 赞同：0
> 
> 时间：2012-10-29T19:57:38.300
> 
> 标签：ant

我有两种部署配置。每个配置存储在其属性文件中。dev.properties 中的开发配置：

```
deploy.wowza.domain=DEV_IP_ADDRESS 
```

prod.properties 中的产品配置：

```
deploy.wowza.domain=PROD_IP_ADDRESS 
```

我有 build.xml

```
<?xml version="1.0"?>
<project name="MAIN" default="dev" basedir=".">    
<target name="dev">
        <property file="${java.root.dir}/ant/dev.properties"/>

        <echo>
            DEV
            ${deploy.wowza.domain}
        </echo>
        <sleep seconds="1"/>

    </target>

    <target name="prod">
        <property file="${java.root.dir}/ant/prod.properties"/>

        <echo>
            PROD
            ${deploy.wowza.domain}
        </echo>

        <antcall target="deploy"/>

    </target>
</project> 
```

如果我运行 prod 或 dev 任务，它只会在第二次运行时显示正确的属性值

```
D:\Dropbox\camwithme>ant prod
Buildfile: D:\Dropbox\camwithme\build.xml

prod:
     [copy] Copying 1 file to D:\Dropbox\camwithme\wowza_cam\ant
     [echo]
     [echo]             PROD
     [echo]             PROD_IP_ADDRESS
     [echo]

BUILD SUCCESSFUL
Total time: 0 seconds

D:\Dropbox\camwithme>ant dev
Buildfile: D:\Dropbox\camwithme\build.xml

dev:
     [copy] Copying 1 file to D:\Dropbox\camwithme\wowza_cam\ant
     [echo]
     [echo]             DEV
     [echo]             PROD_IP_ADDRESS     !!! Should be dev ip here !!!
     [echo]

BUILD SUCCESSFUL
Total time: 0 seconds

D:\Dropbox\camwithme>ant prod
Buildfile: D:\Dropbox\camwithme\build.xml

prod:
     [copy] Copying 1 file to D:\Dropbox\camwithme\wowza_cam\ant
     [echo]
     [echo]             PROD
     [echo]             DEV_IP_ADDRESS
     [echo] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T06:29:58.783

问题是因为另一个 build.xml 在复制之前加载了属性文件

# performance - 在opencv中做alpha掩码的最有效方法是什么？

> ID：13128696
> 
> 赞同：8
> 
> 时间：2012-10-29T19:57:46.177
> 
> 标签：performance, optimization, opencv

我知道 OpenCV 只支持二进制掩码。
但我需要做一个覆盖，我有一个灰度蒙版，指定覆盖的透明度。

例如。如果掩码中的像素为 50% 白色，则表示`cv::addWeighted`该像素的操作为 alpha=beta=0.5，gamma = 0.0。

现在，如果没有 opencv 库函数，您会建议哪种算法最有效？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-30T14:03:50.590

我做了这样的事情来修复。

```
typedef double Mask_value_t;
typedef Mat_<Mask_value_t> Mask;
void cv::addMasked(const Mat& src1, const Mat& src2, const Mask& mask, Mat& dst)
{
  MatConstIterator_<Vec3b> it1 = src1.begin<Vec3b>(), it1_end = src1.end<Vec3b>(); 
  MatConstIterator_<Vec3b> it2 = src2.begin<Vec3b>();
  MatConstIterator_<Mask_value_t> mask_it = mask.begin();
  MatIterator_<Vec3b> dst_it = dst.begin<Vec3b>();

  for(; it1 != it1_end; ++it1, ++it2, ++mask_it, ++dst_it)
    *dst_it = (*it1) * (1.0-*mask_it) + (*it2) * (*mask_it);
} 
```

我还没有用断言优化或保证这段代码的安全。
工作假设：所有 Mat 和 Mask 的大小相同，Mat 是正常的三通道彩色图像。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-09-14T07:35:03.867

我有一个类似的问题，我想应用一个透明的 png。我的解决方案是使用 Mat 表达式：

```
void AlphaBlend(const Mat& imgFore, Mat& imgDst, const Mat& alpha)
{
    vector<Mat> vAlpha;
    Mat imgAlpha3;
    for(int i = 0; i < 3; i++) vAlpha.push_back(alpha);
    merge(vAlpha,imgAlpha3)

    Mat blend = imgFore.mul(imgAlpha3,1.0/255) +
                imgDst.mul(Scalar::all(255)-imgAlpha3,1.0/255);
    blend.copyTo(imgDst);
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-30T13:46:24.390

OpenCV 支持 RGBA 图像，您可以使用[`mixchannels`](http://docs.opencv.org/modules/core/doc/operations_on_arrays.html?highlight=rgba#mixchannels)或`split`和`merge`函数将图像与灰度蒙版结合起来。我希望这就是你要找的！

使用此方法，您可以将灰度蒙版与图像结合起来，如下所示：

```
 cv::Mat gray_image, mask, rgba_image;
    std::vector<cv::Mat> result;
    cv::Mat image = cv::imread(image_path);
    cv::split(image, result);
    cv::cvtColor(image, gray_image, CV_BGR2GRAY);
    cv::threshold(gray_image, mask, 128, 255, CV_THRESH_BINARY);
    result.push_back(mask);
    cv::merge(result, rgba_image);
    imwrite("rgba.png", rgba_image); 
```

请记住，您无法使用[read-rgba-image-opencv](https://stackoverflow.com/questions/8667929/read-rgba-image-opencv)`cv::imshow`中的描述查看 RGBA 图像，并且您无法将图像保存为 jpeg，因为该格式不支持透明度。似乎您可以使用[opencv-2-3-convert-mat-to-rgba-pixel-array](https://stackoverflow.com/questions/10265125/opencv-2-3-convert-mat-to-rgba-pixel-array)中所示的方式组合通道`cv::cvtcolor`

# javascript - 获取哈希中唯一条目的值

> ID：13128697
> 
> 赞同：1
> 
> 时间：2012-10-29T19:57:49.063
> 
> 标签：javascript, jquery

> **可能重复：**
> [访问对象的第一个属性](https://stackoverflow.com/questions/983267/access-the-first-property-of-an-object)

我有一个`h`从 解码的哈希`JSON`，它只包含一个条目。我不关心（也不需要知道）这个条目的键，只是想得到它对应的值。

最快的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T19:58:43.353

如果您知道密钥是什么，那就更好了，但如果不知道，这应该可以

```
var value;
for (var key in h){
    value = h[key];
    break;
} 
```

# c# - Gridview 中的 AutoGenerateInsertButton

> ID：13128700
> 
> 赞同：0
> 
> 时间：2012-10-29T19:57:52.717
> 
> 标签：c#, asp.net, gridview, properties

我有以下 GridView

```
 <asp:GridView ID="GridView1" runat="server" AllowPaging="True" 
      OnRowCommand="GridView1_RowCommand" DataKeyNames="Chart_Id" 
      AutoGenerateColumns="False" EnableModelValidation="True" >

      <Columns>
          <asp:CommandField ShowEditButton="False" ShowDeleteButton="False" ShowInsertButton="False" />
                        <asp:BoundField DataField="Week" HeaderText="Week" SortExpression="Week" />
                        <asp:BoundField DataField="Date" HeaderText="Date" SortExpression="Date" ItemStyle-Wrap="False" />
                        <asp:BoundField DataField="Host" HeaderText="Host" SortExpression="Host" />
                        <asp:BoundField DataField="Topic_1" HeaderText="Topic 1" SortExpression="Topic_1" />
                        <asp:BoundField DataField="Topic_2" HeaderText="Topic 2" SortExpression="Topic_2"
                            HeaderStyle-Wrap="False" />
                        <asp:BoundField DataField="Topic_3" HeaderText="Topic 3" SortExpression="Topic_3" />
                        <asp:BoundField DataField="Topic_4" HeaderText="Topic 4" SortExpression="Topic_4" />
      </Columns>

 </asp:GridView> 
```

默认情况下，我将编辑/插入/取消按钮设置为 false。

然后在后面的代码中，我希望能够在某些条件下将这些设置为 true。

```
 string theUser = Helpers.GetUser();
    string admin = "adminName";

    if (theUser == admin) {

       // Set the buttons to true  

    } 
```

我一直在寻找方法来做到这一点，有人建议使用 AutoGenerate 属性，然后像这样启用它们：

```
 GridView1.AutoGenerateEditButton = true;
 GridView1.AutoGenerateDeleteButton = true;
 GridView1.AutoGenerateInsertButton = true; // This one throws an error 
```

唯一的问题是，在主 ASPX 页面或后面的代码中似乎不存在 AutogenerateInsertButton。

谁能建议我访问这些属性并将它们设置为 true 的一些方法？

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T20:28:57.277

为什么你认为 GridView 应该有一个`AutoGenerateInsertButton`属性？

A`GridView`是 的列表`GridViewRows`，其中每一行代表可以编辑或删除的记录/元素/项目。**但是为每条记录**设置一个插入按钮是没有意义的，因为它已经存在。

您可以按照[本教程](http://www.asp.net/web-forms/tutorials/data-access/enhancing-the-gridview/inserting-a-new-record-from-the-gridview-s-footer-vb)学习如何使用页脚行`GridView`插入新记录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T20:02:30.997

该属性`AutoGenerateInsertButton`存在于[`DetailsView`控件](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.detailsview.autogenerateinsertbutton.aspx)上。设计该控件的人可能认为您不需要为网格中的每一行添加一个插入按钮，因为它们本质上都会做同样的事情。

因此，也许您可​​以在网格底部显示一个空的 DetailsView，或者只是使用常规按钮创建自己的插入命令。

# javascript - 如何在输入 Bootstrap Datepicker 中仅显示年份？

> ID：13128701
> 
> 赞同：42
> 
> 时间：2012-10-29T19:57:52.837
> 
> 标签：javascript, twitter-bootstrap, datepicker

我使用以下代码仅显示年份：

```
$("#datepicker").datepicker( {viewMode: "years", minViewMode: "years"}); 
```

但输入以格式显示`"dd/mm/yyyy"`

由于我没有格式，我该如何解决这个问题`"yyyy"`？

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2012-10-29T20:04:25.590

尝试这个

```
$("#datepicker").datepicker({
    format: "yyyy",
    viewMode: "years", 
    minViewMode: "years"
});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.6.4/js/bootstrap-datepicker.js"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.6.4/css/bootstrap-datepicker.css" rel="stylesheet"/>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet"/>

<input type="text" id="datepicker" />
```

```
$("#datepicker").datepicker( {
    format: " yyyy", // Notice the Extra space at the beginning
    viewMode: "years", 
    minViewMode: "years"
}); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2016-10-12T14:45:33.687

对于`bootstrap datetimepicker`，赋值`decade`如下：

```
$(".years").datetimepicker({
    format: "yyyy",
    startView: 'decade',
    minView: 'decade',
    viewSelect: 'decade',
    autoclose: true,
}); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-03-15T04:00:07.860

```
$("#year").datepicker( {
    format: "yyyy",
    viewMode: "years", 
    minViewMode: "years"
}).on('changeDate', function(e){
    $(this).datepicker('hide');
}); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-01-22T10:18:53.540

bootstrap 3 datetimepicker 总是一年 [https://eonasdan.github.io/bootstrap-datetimepicker/](https://eonasdan.github.io/bootstrap-datetimepicker/)

```
 $('#year').datetimepicker({
        format: 'YYYY',
        viewMode: "years",
    });

    $("#year").on("dp.hide", function (e) {
        $('#year').datetimepicker('destroy');
        $('#year').datetimepicker({
            format: 'YYYY',
            viewMode: "years",
        });
    }); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-04-06T10:11:39.560

对于 bootstrap 3 日期选择器。（注意大写字母）

```
$("#datetimepicker").datetimepicker( {
  format: "YYYY",
  viewMode: "years"
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-05-23T13:08:13.197

```
format: "YYYY" 
```

应该是大写而不是“yyyy”

# dojo - 为什么 dijit.form.radiobutton 的标签不显示？

> ID：13128704
> 
> 赞同：0
> 
> 时间：2012-10-29T19:58:08.547
> 
> 标签：dojo, dijit.form

我有这个代码，但标签没有显示：

```
 var radioOne = new RadioButton({
                label: "Current",
                style: "margin-left:10px",
                checked: true
            }).placeAt(userDiv); 
```

我必须做一个实际标签标签的 domCreate 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T22:35:39.120

我已经开始使用它来创建标签标签。

```
 var label = domConstruct.create("label", {
                for: "Previous",
                style: "margin-left:5px",
                innerHTML: "Previous"
            }, userDiv); 
```

这确实有效，但似乎这应该包含在 RadioButton 小部件中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T20:31:52.103

是的你是。这是来自 dojo 文档：

脚本：

```
var radioOne = new RadioButton({
            checked: true,
            value: "tea",
            name: "drink",
        }, "radioOne"); 
```

HTML：

```
<input type="radio" name="drink" id="radioOne" checked value="tea"/> <label for="radioOne">Tea</label> 
```

# ajax - CakePHP在 AJAX 响应中包含“”？

> ID：13128711
> 
> 赞同：2
> 
> 时间：2012-10-29T19:58:35.793
> 
> 标签：ajax, cakephp

我只是想发送一个简单的 jquery ajax 请求，但总是得到这样的响应：

```
""ok""< !--" 16.7154s "-->" 
```

为什么：`< !-- 16.7154s -->`？

我的js：

```
jQuery.ajax({
  type:"POST",
  url: 'controller/action/' + $('#nickname').val() ,
    success: function(data) {
    alert( data ==='ok'  );

  }
}); return; 
```

我的控制器：

```
function verifynick(){    
  $this->layout='ajax';    
  $this->autoRender = false;    
  return ('ok'); 
} 
```

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T21:15:14.657

您只需将调试模式设置为 0。

您可以像这样在您的操作中即时执行此操作

> 配置::write('debug', 0);

# php - 如何让 PHP5 模拟旧版本？

> ID：13128717
> 
> 赞同：1
> 
> 时间：2012-10-29T19:58:56.470
> 
> 标签：php

我正在使用 PHP5 在我的系统上编写一个 Web 应用程序，但该应用程序需要与 PHP4 兼容。有什么方法可以模拟 PHP4，或者至少发出警告？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T20:01:13.090

作为一般规则，如果您避免使用 PHP5 中添加的函数和参数（如每个函数的文档中所示），那么它应该可以在 PHP4 中正常工作。PHP 擅长这样的向后兼容性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T22:32:34.317

我知道没有办法模拟 PHP4。您需要在真正的 PHP4 环境中运行您的代码。这是我的建议：

*   获取包含 PHP4 包的旧发行版。显然，[Ubuntu Dapper (6.06) 可以。](http://valerio.della-porta.com/node/44)
*   将其安装到您盒子上的虚拟机（VirtualBox 或 VMWare）中。
*   为虚拟机创建一个共享目录，该目录指向真实盒子上的应用程序目录。
*   在您的 VM 中，创建一个从 webroot 到共享目录的挂载点的符号链接。

完成后，您或多或少可以忘记虚拟机。您需要做的就是保持运行。像以前一样更改应用程序目录中的代码。您可以使用虚拟机的 IP 从浏览器运行它。

（也许您甚至可以在 VM 中安装旧版本的 XDebug，并在您的 IDE 中进行适当的远程调试。但我不知道 XDebug 是否与 PHP4 兼容。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T20:01:30.977

不，没有。您必须在机器上安装 PHP 4 以提供运行时环境。或者，更好的是，让客户相信 2012 年的 PHP 4 已经……过时了。

# c++ - 已在 main.obj 中定义

> ID：13128719
> 
> 赞同：9
> 
> 时间：2012-10-29T19:59:08.860
> 
> 标签：c++, visual-c++

这是我的问题的代码，我得到 4 个错误：

> 1.  student.obj : 错误 LNK2005: "struct Node * admissionedFirstNode" (?admitedFirstNode@@3PAUNode@@A) 已在 main.obj 中定义
> 2.  student.obj : 错误 LNK2005: "struct Node * allFirstNode" (?allFirstNode@@3PAUNode@@A) 已经在 main.obj 中定义
> 3.  student.obj : 错误 LNK2005: "struct Node * deniedFirstNode" (?rejectedFirstNode@@3PAUNode@@A) 已经在 main.obj 中定义
> 4.  pb4_OOP_lab1\Debug\pb4_OOP_lab1.exe：致命错误 LNK1169：找到一个或多个多重定义符号

```
#include "students.h"                          //main 
int main()                                         
{
for(int i=0;i<NR_STUDENTS;i++)
{
    Student *s1=new Student;
    cout<<"Enter name: ";
    getline(cin,s1->name);
    cout<<"Enter garde: ";
    cin>>s1->grade;
    cin.ignore();
    addStudent(s1);
    delete s1;
}

}
#include "students.h"                           //students.cpp

void AddNodeToList(Node *firstNode, Student *studToAdd)
{
Node *nodeToAdd=new Node;
nodeToAdd->student=studToAdd;
nodeToAdd->next=NULL;

if(firstNode==NULL)
{
    firstNode=nodeToAdd;
}
else
{
    Node *temp;
    temp=firstNode;
    while(temp->next != NULL)
    {
        temp=temp->next;
    }
    temp->next=nodeToAdd;
}
}
void addStudent(Student *studentToAdd)
{
AddNodeToList(allFirstNode,studentToAdd);
}

void split()
{
Node *temp=allFirstNode;
while(temp->next != NULL)
{
    Student *currentStud=temp->student;
    if(currentStud->grade < GR)
    {
        AddNodeToList(rejectedFirstNode,currentStud);
    }
    else    
    {
        AddNodeToList(admitedFirstNode,currentStud);
    }
}
}

void print(Node *firstNode)
{

if(firstNode==NULL)
{
    return;
}
else
{
    Node *temp=firstNode;
    Student *current=temp->student;
    while(temp->next != NULL)
    {
        cout<<"----------------------------------------------"<<endl;
        cout<<"Student name: "<<current->name<<endl;
        cout<<"Student grade: "<<current->grade<<endl;
    }
}
}

#include <iostream>                       //students.h
#include <string>

using namespace std;

const int NR_STUDENTS=5;
const double GR=5.0;

struct Student
{
string name;
double grade;
};

struct Node
{
Student *student;
Node *next;
};

Node *allFirstNode;
Node *admitedFirstNode;
Node *rejectedFirstNode;

void addStudent(Student *studentToAdd);
void split();
void sort();
void print(); 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-10-29T20:02:21.210

头文件中的定义`Node * rejectedFirstNode;`会导致多重定义的符号，因为包含该头文件的所有翻译单元都会为其生成一个符号。相反，在标题中，有

```
//students.h
extern Node * rejectedFirstNode; 
```

并将定义移动到**单个 cpp 文件**中：

```
//students.cpp
Node * rejectedFirstNode; 
```

似乎您正在编写 C 代码。为什么这被标记为 C++？如果您不了解 C++ 提供的所有内容，请阅读一[本好的入门书籍](https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-29T20:08:48.080

您在students.h 中声明变量，而students.h 包含在main.cpp 和student.cpp 中。

您应该避免在头文件中声明变量。

尝试将以下代码放入 students.cpp ：

```
Node *allFirstNode;
Node *admitedFirstNode;
Node *rejectedFirstNode; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-29T20:04:09.397

您有`admitedFirstNode`,`allFirstNode`并`rejectedFirstNode`在头文件中定义。这在每个 cpp 中定义了它，包括“students.h”文件。

拆分声明和定义。在“students.h”中声明它们：

```
extern Node *allFirstNode;
extern Node *admitedFirstNode;
extern Node *rejectedFirstNode; 
```

并在“students.cpp”中定义变量：

```
Node *allFirstNode;
Node *admitedFirstNode;
Node *rejectedFirstNode; 
```

# ios - IOS表单框架

> ID：13128724
> 
> 赞同：1
> 
> 时间：2012-10-29T19:59:43.577
> 
> 标签：ios, forms

销售人员将使用我正在开发的 iPad 应用程序填写申请表，然后将其上传到 CRM 系统。我的问题与“申请表”最有效的设计模式有关。

有 6 个产品，每个产品都有一个特定的申请表，每个州有一组申请表，因此最多 300 个申请表来编写 UI 和验证。

已填写申请表，假设 iPad 处于离线状态（稍后将完成上传），并且一次仅加载一个状态（下载状态表也将在设备在线后和销售人员上路之前完成） ）。

因此，在 UI 中对每个特定表单进行编码和进行验证检查（我称之为蛮力方法）将太耗时。

HTML5 Forms 可能不合适，因为它要求设备在线。据说 XFORMS 已经过时并且不再使用了。

是否有其他可以使用的标准或框架？也许基于 XML 的东西？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T06:25:12.493

我知道我的 XForms 实现 (XSLTForms) 在 iPad 上用于离线应用程序。只要用户感兴趣，XForms 就会继续改进。您应该查看 W3C XForms 用户社区组 (http://www.w3.org/community/xformsusers/) 以访问 XForms 2.0 规范草案 ( http://www.w3.org/MarkUp/Forms/wiki/XForms_2.0）。

-阿兰

# ios - 全新安装的核心数据迁移

> ID：13128725
> 
> 赞同：0
> 
> 时间：2012-10-29T19:59:47.957
> 
> 标签：ios, core-data, core-data-migration

从事一个具有悠久发展历史的项目。过去有几次成功的核心数据迁移（在我开始开发应用程序之前）。我现在正在开发几个需要手动迁移的版本（自定义策略，所有这些）。

从应用程序的现有版本升级时，手动迁移正在工作。但是，如果我卸载应用程序并部署最新版本，应用程序将无法启动并显示错误消息“找不到用于迁移的映射模型”。

关于配置中缺少什么的任何想法？我需要提供从“v1”到最新版本的迁移吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T19:19:03.533

全新安装不需要迁移。如果应用程序正在复制“入门”数据库，则应更新该数据库并将其重新打包到捆绑包中，以便在全新安装时复制。这就像从网站下载一个应用程序，它不是最新版本。

# php - 如何以动态方式使用php重命名文件或文件夹？

> ID：13128726
> 
> 赞同：1
> 
> 时间：2012-10-29T19:59:55.757
> 
> 标签：php

我需要通过从 $_REQUEST["item"] 获取旧名称和提示框中的新名称，以动态方式重命名我的基于 Web 的系统上的任何文件或文件夹，我的 javascript 代码是：

```
<script type="text/javascript">
var name;
function rename(){
   var  name= prompt("Please enter a new name for the item:", "");
    if (name=="")
        rename();          
}
<?php $name ?>=  name;

</script>

<a  onclick="rename()" href="index.php?action=rename&newname=<?php echo $name; ?>&item=<?php echo $value["path"]; ?>" >Rename</a> 
```

$value["path"] 在哪里是页面中每个项目的链接

php函数：

```
private function rename() {
    rename($_REQUEST["item"], $_REQUEST["newname"]);
   } 
```

我的 .htaccess 文件：

```
RewriteEngine On
RewriteRule ^(.*)/index.php$ index.php?controller=$1&%{QUERY_STRING} [L] 
```

有很多代码可以打开文件并调用我的函数问题是 $_REQUEST["newname"] 是未定义的变量并且没有出现提示框？

注意：调用函数没有问题^_^

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T20:02:34.837

~~还有一个给伯爵...~~

PHP***运行在服务器上***，JavaScript***运行在浏览器***上。

PHP 可以像生成 HTML 一样生成 JavaScript，但是为了让 JavaScript 与 PHP 通信，您需要使用 AJAX。

# validation - 基于现有文档内容的 couchdb 验证

> ID：13128730
> 
> 赞同：0
> 
> 时间：2012-10-29T20:00:04.613
> 
> 标签：validation, couchdb

**问题**

作为标准 couchdb 验证功能的一部分，是否可以查询其他 couchdb 文档？

如果不是，将其他文档的属性作为验证规则的一部分包含在 couchdb 验证函数中的标准方法是什么？

**基本原理**

考虑一个普通的地址簿应用程序，其中验证功能旨在防止两个或多个条目在一个地址簿条目字段中具有相同的“电子邮件”值。

还考虑一个地址簿应用程序，它可以在单独的文档中指定验证规则，具体取决于邮政编码是基于美国的邮政编码还是其他。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T20:57:00.860

不，不可能在`validate_doc_update`函数中查询其他 couchdb 文档。每个单独运行，仅传递对：新文档、旧文档和用户（如果适用）的引用。

我的个人经验是至少有三种处理重复检查的选项：

1.  使用 Cloudant 作为您的 CouchDB 提供程序。如果您想进行试验，它们现在提供免费层，但它们保证 CouchDB 数据库的节点之间的一致性。（见#2）
2.  我已经为使用类型键作为 ID 的名称使用了辅助“保留表”。然后，如果不使用像 Cloudant 这样的系统，您需要检查冲突。基本上，有一个简单的文档可以维护一个防止重复的密钥。鉴于您需要注意冲突，因此编写代码并不有趣。（即使使用 cloudant，您也需要处理失败的写入请求，但它比处理跨多个节点的数据复制的时间问题更容易）。
3.  例如，使用像 MySQL 这样的传统数据库，它可以为您所描述的特定数据值维护唯一且一致的索引。不过，将文档存储在 CouchDB 中。虽然您需要不同的数据提供者有点烦人，但它是可靠的。
4.  （可选：决定 CouchDB 不适合您正在构建的系统类型）

# javascript - 在我的本地驱动器上显示带有 openlayers 的 kml 文件

> ID：13128731
> 
> 赞同：2
> 
> 时间：2012-10-29T20:00:05.253
> 
> 标签：javascript, openlayers

我正在尝试运行此示例：[Openlayers 中的 KML 层在本地本地主机上不起作用](https://stackoverflow.com/questions/7331997/kml-layer-in-openlayers-doesnt-work-on-localhost)。我做了一些研究，发现这个人也有类似的问题。但是他提到，如果文件在本地链接，则会发生此问题。因此，我假设如果它们没有在本地链接，我应该没问题。我曾尝试直接从 openlayers 网站的示例中使用 javascript 文件：http://openlayers.org/dev/examples/kml-layer.html [，](http://openlayers.org/dev/examples/kml-layer.html)但它不起作用。

问题是我可以看到底图，但 kml 文件不会显示在地图上。

我在 jsfiddle 上放了一个例子：http: [//jsfiddle.net/Hn5pG/](http://jsfiddle.net/Hn5pG/)

```
<!DOCTYPE html>
<html>
    <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <meta name="apple-mobile-web-app-capable" content="yes">
        <link rel="stylesheet" href="http://openlayers.org/dev/theme/default/style.csss" type="text/css">
        <link rel="stylesheet" href="http://openlayers.org/dev/examples/style.css" type="text/css">
    </head>
    <body>

    <h1 id="title">KML Layer Example</h1>

    <div id="tags">KML</div>

    <p id="shortdesc">
        Demonstrates loading and displaying a KML file on top of a basemap.
    </p>

    <div id="map" class="smallmap"></div>

    <div id="docs">
        <p>
            A vector layer can be populated with features from a KML document
            by configuring the layer with an HTTP protocol that points to the
            KML document and is configured with a KML format for parsing features.
            The fixed strategy is used to load all features at once.
        </p>
        <p>
            View the <a href="kml-layer.js" target="_blank">kml-layer.js</a>
            source to see how this is done.
        </p>
    </div>

    <script src="http://openlayers.org/dev/OpenLayers.js"></script>
    <script src="http://openlayers.org/dev/examples/kml-layer.js"></script>
    </body>
</html> 
```

我误解了什么吗？我只能在工作中访问 Firefox 和 Internet Explorer，并且如果可能的话，我需要能够在不托管它的情况下对其进行测试。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T13:52:04.473

我发现了这个问题。重新托管页面时，我没有链接到一个 styles.kml 文件。加载此文件后，将显示 kml。

我仍然不明白为什么我不能使用他们的 js 文件来做同样的事情。

# java - 将参数数量从 facebook 发送到我的服务器

> ID：13128732
> 
> 赞同：0
> 
> 时间：2012-10-29T20:00:14.917
> 
> 标签：java, facebook, jsp, notifications, href

我有一个 Facebook 应用程序，可以将她的回复发送到我的服务器硬编码。我的服务器是一个 tomcat 接收响应（Facebook 通知）。

我希望使用我的应用程序的用户会收到通知，当他点击通知时，他会从我的服务器收到 index.jsp 页面。

我发送通知并添加了我想使用的 href，我的服务器收到：

```
 var messageToSend = "https://graph.facebook.com" + id + ... +
            +**"&href=?username=" + userName + "&userid="+ userId** + "&template=" +
            notificationContent + "&method=POST&format=json"; 
```

我想在服务器端获取 userId 和 userName。

在服务器端，我写道：

```
String userName = request.getParameter("username"); 
String userId = request.getParameter("userid"); 
```

我得到了用户名，但用户 ID 为空。

我应该如何向我的服务器发送多个参数？

# python - 在django admin中上传文件，通过公共站点下载

> ID：13128734
> 
> 赞同：2
> 
> 时间：2012-10-29T20:00:22.373
> 
> 标签：python, django, django-admin

我正在运行一个 Django 网站，我希望能够通过我的管理面板上传文件，然后让主站点的访问者能够下载它。我正在使用 Django-nonrel、Django FileTransfers 和 Google App Engine 运行我的网站。我相信上传功能可以正常工作，因为我可以在我的 App Engine Blob 存储中看到该文件。我似乎无法弄清楚如何在公共网站上显示指向指定文件的下载链接。我已经粘贴了下面的相关类：

* * *

我有一个名为日历的应用程序，它具有以下模型：

```
class CalendarEvent (models.Model):
    start = models.DateTimeField(auto_now=False, auto_now_add=False)
    end = models.DateTimeField(auto_now=False, auto_now_add=False)
    title = models.CharField(max_length=500)
    description = models.TextField()

    file = models.FileField(upload_to='uploads/%Y/%m/%d/%H/%M/%S/') 
```

这是视图：

```
def calendar(request):
events = CalendarEvent.objects.exclude(start__lt=datetime.datetime.now()).order_by('start')
return render_to_response('home/calendar.html',{'events': events},context_instance=RequestContext(request))

def download_handler(request, pk):
    upload = get_object_or_404(CalendarEvent, pk=pk)
    return serve_file(request, upload.file, save_as=True) 
```

这是我的管理员：

```
class calendarAdmin(admin.ModelAdmin):
    list_display = ('title','start','end')

admin.site.register(CalendarEvent, calendarAdmin) 
```

最后，这是我的模板的相关部分：

```
 {% for e in events %}
    {% url Calendar.views.download_handler pk=e.pk as fallback_url %}
    <a href="{% firstof e.file|public_download_url fallback_url %}">Download</a>
{% endfor %} 
```

{% firstof e.file|public_download_url fallback_url %} 只是返回空白，我不确定我哪里出错了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T01:10:50.037

根据[此处](http://www.allbuttonspressed.com/projects/django-filetransfers)的文档，GAE blob 存储不支持公共下载，因此如果您对公共下载 url 使用默认后端，它将返回 None。所以我的猜测是`e.file|public_download_url`总是返回无。你可以验证一下。

然后我认为你的模板是错误的。如果您的应用名为日历，则您正在尝试访问`e.views.download_handler`它应该在的位置。`Calendar.views.download_handler`

我认为 django-filetransfers 页面上的示例很容易出错，因为模板循环中使用的变量与示例应用程序具有相同的名称：“上传”。

如果这不能解决问题，您能否从日历应用程序中发布您的*urls.py。*如果没有映射，则模板的`url`方法可能无法解析 url 。`Calendar.views.download_handler``urlpatterns`

你应该有类似的东西

```
urlpatterns = patterns('Calendar.views',
    ...
    (r'^download/(?P<pk>.+)$', 'download_handler'),
    ...
) 
```

在这个文件中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T20:11:06.473

我看不出有什么特别的，例如

```
<a href="{{ e.file.get_absolute_url }}">Download File</a> 
```

应该工作，还是直接使用`e.file.url`？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-01T23:01:05.177

我自己没有在 Google App Engine 上进行部署，但这似乎是 django-filetransfers 的设计目的：

[http://www.allbuttonspressed.com/projects/django-filetransfers#handling-downloads](http://www.allbuttonspressed.com/projects/django-filetransfers#handling-downloads)

* * *

编辑：我相信我已经在您发布的另一个问题中回答了这个问题，然后：[Trouble downlaoding file using Django FileTransfers](https://stackoverflow.com/questions/13187401/trouble-downlaoding-file-using-django-filetransfers)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-02T13:08:00.567

我认为最简单的方法是编写一个视图，因为无法直接检索此文件 blob 以编写如下函数：

```
def file_transfer(req, calendar_event_id):
    try:
       ce = CalendarEvent.objects.get(calendar_event_id)
    except CalendarEvent.DoesNotExist:
       raise Http404()

    file = ce.file (Write Google appengine specfic routine to pull file)
    return HttpResponse(file, media_type='file content type') 
```

将其连接到 urls.py

# javascript - 如何在不使用 JSON 或任何东西的情况下使用纯 JavaScript/Ajax 调用此 HelloWorld Web 方法？

> ID：13128736
> 
> 赞同：1
> 
> 时间：2012-10-29T20:00:40.797
> 
> 标签：javascript, web-services

我讨厌在这里发布这样的问题，但我已经没有办法真正理解它是如何工作的了。在普通的 .Net Web 服务中，没有为 JSON 或任何内容进行配置，有以下 Web 方法：

```
<WebMethod()> _
Public Function HelloWorld(ByVal str As Int32) As String
    Return "Hello, World!  str=" & str
End Function 
```

我想做一个非常简单的网页，只使用 JS 调用这个 web 方法，从中获取值，然后在 alert() 语句中打印它。我正在继续自己研究这个主题，但我很难找到这个问题的直接答案。

这大约是我能做到的最接近的（除了这个实际上没有使用返回值）：

```
<html>
<body>
<script type="text/JavaScript">
    <!--
        alert("spam");                                
        $.ajax({
            type: "POST",
            data: "&str=1",
            url: "<HTTP path and filename>.asmx/HelloWorld",
            timeout: 15000,
            cache:false,
            success: function (data) {
                alert("good");
            },
            error: function() {
                alert("bad");
            }
        });
        alert("spam");
    //-->
</script>
</body>
</html> 
```

同样，我不喜欢在 StackOverflow 上发布这样的问题，但我一直无法找到一个**明确、直接**的答案，而且我对 JavaScript 很陌生。谢谢！

编辑：在 Ajax 调用周围抛出一个 try...catch 块，我收到以下消息：

```
$ is not defined 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T20:09:29.900

`$`是一个变量。您的代码显示它正在使用 jQuery 库，`$`用作别名。

如果要使用此代码，则必须包含 jQuery 库。

为此，请在您的代码之前包含以下内容：

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js" type="text/javascript"></script> 
```

但是，如果您是 javascript 新手，我建议您先尝试不使用 jQuery。

对于一个很棒的教程，我只能向你展示我所知道的最好的资源：[MDN](https://developer.mozilla.org/en-US/docs/AJAX/Getting_Started)。

如果你绝对要使用 jQuery，你必须知道你的`data`参数是错误的。它确实接受一个字符串，但这个字符串格式不正确，应该是这样的：`str=1`。添加另一个变量是`str=1&foo=2`.

jQuery 允许你放置一个对象而不是一个字符串，这提供了一些语法糖，通常是推荐的方式（不太容易出错）：

```
data: {
    str: 1,
    foo: 2
} 
```

# workflow - 流程制造者引擎如何工作？

> ID：13128741
> 
> 赞同：1
> 
> 时间：2012-10-29T20:01:00.390
> 
> 标签：workflow, business-process-management, business-process, processmaker

在我完成 bpmn 符号中的流程设计之后。.processmaker 将 bpmn 转换为 xpdl 以执行此流程？还是使用bpel？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T16:30:48.200

我已经使用 ProcessMaker 3 年了，在我看来它不使用 BPEL。

检查这个：[http ://wiki.processmaker.com/index.php/ProcessMaker_Architecture_Diagrams](http://wiki.processmaker.com/index.php/ProcessMaker_Architecture_Diagrams)

它没有提到任何关于它的 BPEL 或 XPDL。

为执行该流程，ProcessMaker 会生成代码文件和 XML 文件，其中包含您在使用 DynaForms 之前设计的业务逻辑。

因此，这不仅仅是使用 BPMN 符号来设计流程，您还必须构建数据输入表单、派生规则、创建用户组、授予他们权限甚至一些自定义编程。

这不是“魔术”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-21T17:58:30.123

当前版本的 processmaker 没有 BPEL 或 BPMN 引擎。但是 processmaker 可以执行流程，因为有一个引擎。要执行一个案例，您需要转到收件箱选项卡并开始一个新案例，当然您需要在设计时配置用户访问权限。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-16T21:33:42.390

当前版本的 ProcessMaker 2.5.0 不符合 BPMN 或 BPEL。但是该产品的路线图包括符合 BPMN 的实现（[http://wiki.processmaker.com/index.php/ProcessMaker_RoadMap](http://wiki.processmaker.com/index.php/ProcessMaker_RoadMap)）。目前，引擎使用任务、事件、步骤、动态表格、输入和输出文档和触发器来执行流程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-07-09T17:21:50.577

我对 XPDEL 或 BPEL 一无所知，但根据我的经验，processmaker 会将所有内容存储在他们的工作区数据库中，这就是为什么如果您创建报告表，他们使用 PMT_ 前缀，用于单独的用户创建表和 processmaker 系统表。如果您创建案例，processmaker 将在表 APP_DELEGATION 中创建 CASE，其中包含流程、任务、应用程序（案例）、用户以及与您的 CASE 相关的任何内容。所以基本上他们会根据 APP_DELEGATION 数据服务表单，这个表也存储了 CASES 的每一步。如果您提交表单，他们将在 APP_DELEGATION 中创建一个新行，其中包含示例流程和应用程序，但与设计器路径相关的新任务 (TAS_UID)（屏幕上的箭头）。

基本上，他们只是存储信息，根据信息提供信息，并根据您的设计进行路由。甚至您上传的文件也会在 processmaker 数据库系统上注明（他们会创建 UID 和其他重要信息，甚至是上传者用户信息）。而不是编译或翻译成另一种语言。简单但没有那么简单。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-05-07T13:15:25.220

ProcessMaker 的最新版本（2020 年 1 月发布）- ProcessMaker 4.x- 完全符合 BPMN 2.0。您可以将其他符合 BPMN 2.0 的设计器的 BPMN 2.0 文件重要并导出到 ProcessMaker。

BPEL 确实不再被业内任何人使用。它很久以前就失去了支持。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-05-31T13:34:51.047

总之，可以在此[链接中查看 ProcessMaker 4 对服务器的要求。](https://processmaker.gitbook.io/processmaker/install-processmaker/prerequisites#on-premises-server-requirements)

ProcessMaker 仍然使用堆栈进行安装：apache 或 nginx，mysql 数据库和 php 语言。此外，在 ProcessMaker 中使用了 Lavaravel 框架。ProcessMaker 作为 bmnp 软件需要符合 BPMN 2.0 标准。

# python - 带有引号和换行符的 Python CSV 阅读器

> ID：13128742
> 
> 赞同：0
> 
> 时间：2012-10-29T20:01:04.940
> 
> 标签：python, parsing, csv

这是我的代码：

```
in_reader = reader(open(csv_in))
for row in in_reader:
    ...do stuff... 
```

当它到达这样的行时，它会抛出 _csv.Error 抱怨字符串中的换行符：

```
asdf,"asdf",asdf,"asdf"
asdf",asdf 
```

注意并不是所有的字段都被引用，这里有问题的字段基本上是一个包含引号和换行符的引用字段。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T20:02:57.367

这不是一个正确的 CSV 文件。它试图读取`asdf"`第二条记录的第一个字段，但失败了。

如果带引号的字符串中有引号，则需要对其进行转义（通常为两个双引号字符：）`""`。

# php - PHP preg_split 结果不正确

> ID：13128747
> 
> 赞同：2
> 
> 时间：2012-10-29T20:01:23.493
> 
> 标签：php, regex, preg-split

我正在尝试在 PHP 中学习正则表达式并使用 preg_split 函数。

但这似乎并不正确，或者我的理解完全错误。

我正在使用的测试代码是：

```
$string = "test ing ";
var_dump(preg_split('/t/', $string)); 
```

我希望得到一个如下所示的数组：

```
[0] => "es" [1] => " ing " 
```

但正在返回以下内容：

```
[0] => "" [1] => "es" [2] => " ing " 
```

为什么开头有一个空字符串？

我知道我可以使用`PREG_SPLIT_NO_EMPTY`标志来过滤它，但它不应该在那里开始。应该是？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T20:06:04.870

为什么不应该呢？这正是它的工作原理。操作的语义`split`是你有一个这种格式的字符串：

```
value-delimiter-value-delimiter-value-...-delimiter-value 
```

（请注意，它是以一个值开始和结束，而不是分隔符。）

因此，如果您的字符串以定界符开头，那么假设在该定界符之前有一个空值是绝对有效的（因为定界符应该**将**某些内容分成两部分）。您通常也不想拒绝两个连续`t`s 之间的空字符串，对吗？

这正是`PREG_SPLIT_NO_EMPTY`它的用途。每当您**确实**想摆脱那些空字符串时，您都可以使用它。

举个简单的例子，为什么你想要默认行为，想想 CSV 文件。您想在 (for example) 处分割一行`;`。您通常还希望允许空值。现在，如果您的第一列中的值是空的（这意味着该行将以*开头*，`;`并且您将第一个空字符串完全切掉，那么结果数组中的所有索引突然将对应于不同的列。这就是为什么您要保留这些空字符串也是如此。在许多情况下，您知道有多少定界符，因此知道有多少值-并且您希望能够识别哪个值属于哪个位置。即使其中一些是空的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T20:06:27.500

它工作100％正确。第一个字符是't'，所以它首先在那个't'上分裂。在第一个 't' 之前没有任何内容，因此数组结果以空字符串条目开头。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T20:08:24.383

发生这种情况是因为`t`字符串的开头。如果您不使用该`PREG_SPLIT_NO_EMPTY`选项，`preg_split`则会将空字符串视为有效拆分。

可以这样想：到处都`preg_split`看到 a `t`，它将字符串分成两个块：在 之前的`t`块和在它之后的块。即使其中一个块中没有任何内容，它仍然很重要。那段只是一个空字符串。

对于某些应用程序，这将非常有用——例如，假设您想`t`用某些东西替换每个，但替换太复杂而无法使用`preg_replace`. 该语言希望您能够选择，因此除非您明确告诉它不要使用 with ，否则它会保留空拆分`PREG_SPLIT_NO_EMPTY`。

# c# - Reingold-Tilford 算法的步骤是什么，我该如何编程？

> ID：13128750
> 
> 赞同：10
> 
> 时间：2012-10-29T20:01:29.090
> 
> 标签：c#, winforms, algorithm, user-interface, tree

从演示文稿：第 3 页的[图表和树](http://hci.stanford.edu/courses/cs448b/f09/lectures/CS448B-20091021-GraphsAndTrees.pdf)中，可以直观地展示 Reigngold-Tilford 过程中发生的情况；它还事先对该算法进行了模糊的总结：`"...starts with bottom-up pass of the tree; [finishes with] Top-down pass for assignment of final positions..."`我可以通过递归方式实现两个方向传递，并且我知道 Y 值与每个节点的生成级别相关，但我仍然不知道如何X 坐标已求解。

我确实遇到过这个项目：[A Graph Tree Drawing Control for WPF](http://www.codeproject.com/Articles/29518/A-Graph-Tree-Drawing-Control-for-WPF)，但是代码太多，我很难找到应该是简单的 2-3 种方法来定义 X 值。（也没有使用WPF的经验）

几天来，我一直在搜索和试验如何做到这一点，非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2014-04-21T15:36:38.983

我发现[jwpat7 的答案](https://stackoverflow.com/a/13129759/302677)中列出的文章非常有用，虽然我花了一段时间才弄清楚这个算法所需的确切逻辑，所以我写了[自己的博客文章](http://rachel53461.wordpress.com/2014/04/20/algorithm-for-drawing-trees/)来简化解释。

这是您如何确定 X 节点位置的纯文本逻辑：

*   从树的[后序遍历](http://www.geeksforgeeks.org/tree-traversals-inorder-preorder-and-postorder/)开始

*   如果它是集合中的第一个节点，或者不是，则将初始 X 值分配给 0 的每个节点`previousSibling + 1`。

    ![在此处输入图像描述](../Images/6b026b0bee20b0e83da3a585ebfa9a2f.png)

*   如果一个节点有子节点，请找到所需的 X 值，使其以它的子节点为中心。

    *   如果节点是最左边的节点，则将其 X 设置为该值

    *   如果节点不是最左边的节点，请将`Mod`节点上的属性设置`(X - centeredX)`为 以移动所有子节点，使它们位于该节点的中心。树的最后一次遍历将使用此`Mod`属性来确定每个节点的最终 X 值。

*   确定该节点的任何子节点是否会与该节点左侧兄弟姐妹的任何子节点重叠。基本上对于每个Y，从两个节点中得到最大和最小的X，并比较它们。

    *   如果发生任何冲突，请将节点移动到所需的位置。移动子树只需要添加节点的`X`和`Mod`属性。

    *   如果节点被移动，还要移动两个重叠的子树之间的任何节点，以便它们等距分布

*   进行检查以确保在计算最终 X 时，没有负 X 值。如果找到任何一个，将最大的一个添加到根节点`X`和`Mod`属性中以将整个树移到

*   使用前序遍历对树进行第二次遍历，并将`Mod`每个节点的父节点的值的总和添加到它的`X`属性中

上面树的最终 X 值如下所示：

![在此处输入图像描述](../Images/a2db9e42e9b25384cff350e52f9be24e.png)

[我的博](http://rachel53461.wordpress.com/2014/04/20/algorithm-for-drawing-trees/)文中有更多细节和一些示例代码，但是在这里包含所有内容太长了，我想专注于算法的逻辑而不是代码细节。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-29T21:11:27.417

A couple of articles are available that include code, in python at [billmill.org](http://billmill.org/pymag-trees/) and in C on [page 2](http://www.drdobbs.com/positioning-nodes-for-general-trees/184402320?pgno=2) of a 1 February 1991 [Dr. Dobb's Journal article](http://www.drdobbs.com/positioning-nodes-for-general-trees/184402320?pgno=4). You have asked for “simple 2-3 methods” (perhaps meaning cookbook methods) but drawing trees nicely in all their generality is an NP-complete problem (see Supowit, K.J. and E.M. Reingold, "The complexity of drawing trees nicely," Acta Informatica 18, 4, January 1983, 377-392, ref. 4 in the DDJ article). The Reingold–Tilford method draws binary trees more or less nicely in linear time, and Buchheim's variation draws n-ary trees more or less nicely in linear time. However, the billmill article points out (shortly after stating Principle 6), “Every time so far that we've looked at a simple algorithm in this article, we've found it inadequate...” so the likelihood of simpler methods working ok is small.

# crystal-reports - 如何在 Crystal Reports 中仅显示字母数字字符？

> ID：13128752
> 
> 赞同：1
> 
> 时间：2012-10-29T20:01:33.450
> 
> 标签：crystal-reports

我正在寻找删除不是 AZ az 或 0-9 的任何字符。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T20:01:33.450

我在显示字符串中设置了一些代码，基本上是白名单字符。进行如下：

```
stringvar input := {report.field};
stringvar output := '';
numbervar i;

input := Trim(input);

for i := 1 to Length(input) Step 1 do

  // 0-9 is 48-57
  // A-Z is 65-90
  // a-z is 97-122

  if (input[i] in [Chr(48),Chr(49),Chr(50),Chr(51),Chr(52),Chr(53),Chr(54),Chr(55),Chr(56),Chr(57),Chr(65),Chr(66),Chr(67),Chr(68),Chr(69),Chr(70),Chr(71),Chr(72),Chr(73),Chr(74),Chr(75),Chr(76),Chr(77),Chr(78),Chr(79),Chr(80),Chr(81),Chr(82),Chr(83),Chr(84),Chr(85),Chr(86),Chr(87),Chr(88),Chr(89),Chr(90),Chr(97),Chr(98),Chr(99),Chr(100),Chr(101),Chr(102),Chr(103),Chr(104),Chr(105),Chr(106),Chr(107),Chr(108),Chr(109),Chr(110),Chr(111),Chr(112),Chr(113),Chr(114),Chr(115),Chr(116),Chr(117),Chr(118),Chr(119),Chr(120),Chr(121),Chr(122)]) 
  then output := output + input[i];

output 
```

如果有人有更清洁/更短的方法，请分享！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T12:30:28.190

创建 SQL 表达式：

```
//{%MY_FIELD}
// Oracle syntax
REGEXP_REPLACE(TABLE.FIELD, '[^0-9]', '') 
```

# vb.net - 从字符串“a”到类型“Boolean”的转换无效

> ID：13128753
> 
> 赞同：2
> 
> 时间：2012-10-29T20:01:34.313
> 
> 标签：vb.net, console-application

这真的让我很困惑。我正在尝试做一个 Visual Basic 控制台应用程序，如果用户输入“A”或“a”，那么程序应该执行“x”，但这不起作用。我得到的错误是：

**从字符串“a”到类型“Boolean”的转换无效。**

这是我的代码：

模块模块1

```
Sub Main()
    Dim Selection As String

    Console.WriteLine("Please select your function:")
    Console.WriteLine("* To convert binary to decimal, press A,")
    Console.WriteLine("* Or to convert decimal to binary, press B")

    Selection = Console.ReadLine

    If Selection = "A" Or "a" Then
        Console.WriteLine("This will be A")
    ElseIf Selection = "B" Or "b" Then
        Console.WriteLine("This will be B")
    ElseIf Selection = Not "A" Or "a" Or "B" Or "b" Then
        Console.WriteLine("Please try again")
        Do Until Selection = "A" Or "a" Or "B" Or "b"
        Loop
    End If

End Sub 
```

应该在这段代码中正确使用 Or 以使其正常运行？

谢谢，

杰克

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-29T20:04:08.337

你的`If`条款应该是这样的：

```
If Selection = "A" Or Selection = "a" Then 
```

*之间*的子句`Or`应该是布尔表达式，并且只是一个字符，而不是布尔表达式。*`"a"`*

 ** * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-29T20:27:13.223

使用**Select Case**是另一种选择：

```
Sub Main()
    Console.WriteLine("Please select your function:")
    Console.WriteLine("* To convert binary to decimal, press A,")
    Console.WriteLine("* Or to convert decimal to binary, press B")
    Console.WriteLine("* To Quit, press Q")
    Dim Selection As String = ValidateInput()
    If Selection <> "Q" Then
        'do something
    End If
End Sub

Function ValidateInput() As String

    Dim Selection As String
    Selection = Console.ReadLine

    Select Case Selection.ToUpper
        Case "A"
            Console.WriteLine("This will be A")
        Case "B"
            Console.WriteLine("This will be B")
        Case "Q"
            Return "Q"
        Case Else
            Console.WriteLine("Please try again")
            ValidateInput()
    End Select
    Return Selection

End Function 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-29T20:11:36.287

我建议在 if 语句之前将输入的字符串更改为大写。最后一个 else if 语句也不需要，可以用一个 else 代替。

```
Sub Main()
    Dim Selection As String

    Console.WriteLine("Please select your function:")
    Console.WriteLine("* To convert binary to decimal, press A,")
    Console.WriteLine("* Or to convert decimal to binary, press B")

    Selection = Console.ReadLine.ToUpper() 'Not tested otherwise use the one below
'Selection=Selection.ToUpper()

    If Selection = "A" Then
        Console.WriteLine("This will be A")
    ElseIf Selection = "B"  Then
        Console.WriteLine("This will be B")
    Else
        Do Until Selection = "A"  Or Selection = "B" 
               'Loop Code goes here
        Loop
    End If

End Sub 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-09-18T20:31:54.063

Estou tentando fazer um sistema de gerenciamento de uma loja de cafe, mas o Login não ta dando certo, quem puder me ajudar por赞成 eu agradeço。

O código com o erro é ess:

```
Public Class Login

 Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
    If UnameTb.Text = "" Or PasswordTb.Text Then
        MsgBox("Digite o Nome de Usuário e a Senha")
    ElseIf UnameTb.Text = "Admin" And PasswordTb.Text = "Password" Then
        Dim Obj = New Items
        Obj.Show()
        Me.Hide()
    Else
        MsgBox("Nome de Usuário ou Senha Incorretos")
        UnameTb.Text = ""
        PasswordTb.Text = ""

    End If
End Sub 
```*

# php - 群发邮件 php 与否

> ID：13128755
> 
> 赞同：0
> 
> 时间：2012-10-29T20:01:45.530
> 
> 标签：php, sendmail, massmail

对不起我的问题，但我对stackoverflow的所有答案都感到困惑！我搜索了 statckoverflow 的所有主题，但我不明白哪个是最好的。有些人告诉说，使用 php mailer（特别是 PHPmailer 类）你可以毫无问题地发送 5000 封邮件，而其他人则建议程序。
所以：

1.  php 是发送大量电子邮件的正确语言吗？或者我的服务器会在一分钟内崩溃？我想发送大约 3000-4000++ 封邮件。
2.  我可以从我的站点所在的服务器调用“mail.php（脚本）”，否则该服务器将崩溃并且我将丢失我的站点？
3.  我可以使用一个简单的群发邮件程序来完成这项工作吗？

感谢您的所有回答。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T20:04:46.160

PHP 非常适合发送群发邮件。邮件/SMTP 服务器可能有点困难。

如果您要发送 5000 封电子邮件，我建议您查看其中一种邮件递送服务。他们中的大多数都提供免费的服务等级。

Mailjet、Sendgrid、MandrillApp 只是我脑海中的几个。

# html - Ruby on Rails - 显示来自 twitter 提要的最后 x 条推文

> ID：13128757
> 
> 赞同：2
> 
> 时间：2012-10-29T20:01:47.820
> 
> 标签：html, twitter, gem

有人可以提供一个简单的代码块，使我能够使用 twitter gem 显示我的 twitter 帐户中的最后 5 条推文。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-16T07:18:53.573

Twitter 小部件只有非常有限的自定义。这是我发现的两个最佳资源：

关于如何让 Oauth 工作和在 Rails 中提供超级简单的 5 条推文的非常清晰的教程： [http ://www.synaptian.com/blog/posts/using-the-twitter-gem-in-your-rails-application](http://www.synaptian.com/blog/posts/using-the-twitter-gem-in-your-rails-application)

绕过 Oauth 并获取您在 Twitter 帐户中设置的 Twitter 提要小部件的值的 Javascript 解决方案：http: [//jasonmayes.com/projects/twitterApi/#sthash.BYRbZafw.dpbs](http://jasonmayes.com/projects/twitterApi/#sthash.BYRbZafw.dpbs)

我实现了第二个，因为第一个只提取了推文文本并链接了所有文本，这使得显示几乎无法使用。第二个提供了与 Oauth 之前几乎相同的定制级别。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-01-24T15:13:25.453

代码示例。

制作 new_statuses.first.attributes 的调试输出以查看可显示的内容。

把它放在 lib/ 下的文件中，或者放在 .../concern/ 文件夹中

```
require 'twitter'

def tweets_from(ids)
  new_statuses = tw_client.statuses(ids)
rescue Twitter::Error::TooManyRequests => error
  sleep error.rate_limit.reset_in + 1
  retry
  new_statuses
end

def tw_client
  @tw_client_reused ||= Twitter::REST::Client.new do |config|
    configure_client(config)
  end
end

def configure_client(config)
  config.consumer_key        = "FAKEasdfajsdlfkjalsdfkjslf"
  config.consumer_secret     = "FAKEkjsdhflkjashdfljkashldfjhasldfjkhalskdjfhlaskjd"
  config.access_token        = "172348716239-e7lcs8e7cltw8e57vlts8e57l8457vlFAKE"
  config.access_token_secret = "FAKEls3o84c7ntle847tnlc3o84n7tlc8o47tlc3847lct38n74"
end 
```

# java - 将字符串转换为 XMLDocument 不会创建文本节点

> ID：13128758
> 
> 赞同：1
> 
> 时间：2012-10-29T20:01:49.733
> 
> 标签：java, xml

这是我的情况。

我有一个包含 XML 数据的字符串：

```
<tag> 
    <anotherTag> data </anotherTag>
</tag> 
```

我获取该字符串并通过此代码运行它以将其转换为文档：

```
try {
  DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
  DocumentBuilder builder = factory.newDocumentBuilder();
  return builder.parse(new InputSource(new StringReader(sXMLString)));
} 
catch (Exception e) {
  // Parser with specified options can't be built
  ceLogger.logError("Unable to build a new XML Document from string provided:\t" + e.getMessage());
  return null;
} 
```

生成的 xml 几乎是完美的。然而，它缺少数据，看起来像这样：

```
<tag> 
    <anotherTag />
</tag> 
```

创建 XML 文档时如何复制文本，为什么首先要删除文本？

编辑：实际问题最终是这样的：在使用我自己的函数解析 XML 结构时，这一行就在那里：

```
if (curChild.getNodeType()==Node.ELEMENT_NODE) 
   sResult.append(XMLToString((Element)children.item(i),attribute_mask)); 
```

但是对于 TEXT 节点不存在这样的逻辑，所以它们被简单地忽略了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-29T20:40:17.783

你的代码是正确的。我能做出的唯一猜测是您输出的代码不正确。我已经测试了你的代码，并使用以下方法输出，并且XML与文本节点正确显示：

```
public static void outputXML(Document dom) throws TransformerException
{
    Transformer transformer = TransformerFactory.newInstance().newTransformer();
    transformer.setOutputProperty(OutputKeys.INDENT, "yes");

    //initialize StreamResult with File object to save to file
    StreamResult result = new StreamResult(new StringWriter());
    DOMSource source = new DOMSource(dom);
    transformer.transform(source, result);

    String xmlString = result.getWriter().toString();
    System.out.println(xmlString);
} 
```

输出是：

```
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<tag> <anotherTag> data </anotherTag>
</tag> 
```

# asp.net - 带有用户上传文件的 ASP.NET 网站项目

> ID：13128760
> 
> 赞同：0
> 
> 时间：2012-10-29T20:01:57.143
> 
> 标签：asp.net, visual-studio, version-control, tfs

我有一个 ASP .NET 网站项目正在移入 TFS。有一个文件夹用于存放需要保存的用户上传的文件（例如，公司徽标、excel 电子表格等）。我正在尝试找出一种管理这些文件的好方法，而无需将文件夹放在 TFS 中（它真的很大），并使新开发人员可以轻松地将文件夹结构抓取到本地机器进行开发。

我正在考虑执行以下操作，并想知道这是否是一种好方法，或者是否有更好的选择：

1.  创建一个脚本，该脚本将在执行时创建存储文件夹的文件夹结构。这将放在源代码管理中。
2.  新开发人员可以获取这个文件并在他们的本地机器上执行它。
3.  为确保将文件夹添加到源代码管理中，请让开发人员将其从本地项目中删除。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T20:34:33.810

将文件夹存储在 NAS 上 - 文件无需成为源代码控制代码的一部分。

# c# - 回调是什么意思？

> ID：13128761
> 
> 赞同：1
> 
> 时间：2012-10-29T20:01:59.697
> 
> 标签：c#, callback

> **可能重复：**
> [什么是回调？](https://stackoverflow.com/questions/2139812/what-is-a-callback)

我现在正在学习代表，我无法理解“回调”是什么意思。

它是委托类型的实例吗？

有人可以举一个“回调”实现的好例子吗？

# objective-c - 使用 NSManagedObject 进行注释

> ID：13128765
> 
> 赞同：2
> 
> 时间：2012-10-29T20:02:15.843
> 
> 标签：objective-c, core-data, mapkit

我对 Objective-C 和 iOS 比较陌生，所以我在使用`NSManagedObject`子类作为`MKAnnotation`. 我做了一个获取请求来获取所有“地点”（`NSManagedObject`子类和`MKAnnotation`），所以我可以填充地图。

`viewDidLoad`一切都很好，可以在以下位置获取它们`MapController`：

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    DatabaseHelper *db = [DatabaseHelper newDatabaseHelper]; // does all the fetch requests ahead...

    NSArray *places = [[db getPlacesForDeck:@"PlacesDeck"] allObjects];
    /*
    [places enumerateObjectsUsingBlock:^(Place *place, NSUInteger i, BOOL *stop) {
        NSLog(@"Place Number: %d", i);
        NSLog(@"Place : %@", place.name);
        NSLog(@"Place latitude: %@", place.latitude);      ALL FINE HERE
        NSLog(@"Place longitude: %@", place.longitude);
    }];
    */
    self.annotations = places;
    [self.mapView addAnnotations:places];
} 
```

NSLog 报告很好，但是随着地图的绘制，**注释标题和坐标默认为 null 和 (0,0)。**

```
- (NSString *) title{
    return self.name; //name is an attribute from NSManagedObject subclass.
}

- (CLLocationCoordinate2D) coordinate{

    CLLocationCoordinate2D coord;

    coord.latitude = [self.latitude doubleValue];   // Longitude and latitude
    coord.longitude = [self.longitude doubleValue]; // also dynamic attributes.
    return coord;
} 
```

我的猜测是，当我传递 'places' 数组时，我会以某种方式取消对每个地方的引用。但是我在某处读到`NSArray`强烈引用这些对象，所以我不太确定我是如何“丢失”数据的。关于发生了什么的任何提示？还是我采取了错误的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-07-21T23:25:54.937

坐标访问器更简单，如下所示：

```
- (CLLocationCoordinate2D)coordinate{
    return CLLocationCoordinate2DMake(self.latitude, self.longitude);
} 
```

# php - PHP中带小数的简单数学

> ID：13128769
> 
> 赞同：2
> 
> 时间：2012-10-29T20:02:21.093
> 
> 标签：php, math, simplexml, decimal

这要死我了！我从来没有遇到过这么多麻烦，我无法弄清楚我在这里做错了什么。

如果我有一个数字，比如 2.32，并且我想用它做数学运算，它就不会成功。最简单的例子：

```
$income = $commission; //Commission is 2.32, retrieved from XML
echo "income: $income<br>";
$income100 = $income*100;
echo "income100: $income100<br>"; 
```

我得到的结果是：

```
income: 2.32
income100: 200 
```

如何在不改变数学的情况下准确地使用十进制数？

非常感谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-29T20:05:35.943

您需要`$income`按以下方式分配以摆脱底层`SimpleXMLElement`：

```
$income = (float) $commission; 
```

[当你不这样做时会发生什么的例子](http://codepad.org/katxKdXK)：

```
$x = simplexml_load_string("<a>2.4</a>");
echo $x * 100; // output:  200 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-29T20:05:21.220

除了像 Tim 所说的那样使用浮点数之外，在对浮点数执行算术运算时，还要确保使用[BC Math函数。](http://php.net/bcmath)特别[是 bcmul()](http://www.php.net/manual/en/function.bcmul.php)：

`$income100 = bcmul($income, 100);`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T20:07:38.237

浮点数的问题在于你不能用它们来表示十进制数（除非它可以写成`a/b`整数`a`and `b`，即使这样也只有`abs(a) < pow(2,52)`and`b`是 2 的幂）。

您最好使用字符串函数来获取整数值：

```
$tmp = explode(".",$commission);
$tmp = intval($tmp[0].str_pad(substr($tmp[1],0,2),2,"0")); 
```

这会将整数部分与小数部分分开，确保小数部分为两位长，并将其推到整数部分的末尾，从而有效地将原始数字乘以 100。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-29T20:09:40.900

我认为最简单的解决方案是使用[floatval()将其转换为浮点数](http://www.php.net/manual/en/function.floatval.php)

`$income = floatval($comission)`

将其余代码保持原样，它应该按预期工作。

# objective-c - iOS 5/6 中的区域监控准确性，2012 年末

> ID：13128770
> 
> 赞同：2
> 
> 时间：2012-10-29T20:02:27.443
> 
> 标签：objective-c, ios, xcode, location, geofencing

我正在尝试对我的应用程序使用区域监控，但我正在尝试按照用户所在城市区域中的建筑物的顺序准确地使用它。

阅读此处有关区域监控的其他文章，我得到了一堆关于系统准确性的相互矛盾的论点。现在，在 2012 年底，准确度如何？

根据我自己的测试，它似乎将我检查到距离我所在的地方几十米的位置，这对于我的需求来说太细了。我需要知道这是区域监控的问题还是我的实施问题。

谢谢，我希望这个问题不会过多地重复其他问题，但是这些问题和回复的日期会使当前的答案变得混乱。

# .net - URL 路由不适用于没有斜杠的文件扩展名

> ID：13128773
> 
> 赞同：0
> 
> 时间：2012-10-29T20:02:34.453
> 
> 标签：.net, routing

我正在尝试使用 .NET 和 URLRouting 动态创建 XML 文件...

在我的 global.asax 中：

```
routes.MapPageRoute("FederationMetadataRoute", "FederationMetadata/2007-06/{file}", "~/FederationMetadata/2007-06/FederationMetadata.aspx") 
```

在我的 global.asax 中使用上面的路由，下面会显示以下 URL 场景：

**作品：**
[https](https://MyDomain.com/FederationMetadata/2007-06/FederationMetadata.xml/) ://MyDomain.com/FederationMetadata/2007-06/FederationMetadata.xml/ https://MyDomain.com/FederationMetadata/2007-06/AnythingWithoutExtension

**不起作用：**
[https](https://MyDomain.com/FederationMetadata/2007-06/FederationMetadata.xml) ://MyDomain.com/FederationMetadata/2007-06/FederationMetadata.xml https://MyDomain.com/FederationMetadata/2007-06/AnythingWith.Extension

**这是必须有效但无效的 URL：**
[https ://MyDomain.com/FederationMetadata/2007-06/FederationMetadata.xml](https://MyDomain.com/FederationMetadata/2007-06/FederationMetadata.xml)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T13:03:40.623

我想到了。显然我必须 runAllManagedModulesForAllRequests="true"

```
<system.webServer>
    <modules runAllManagedModulesForAllRequests="true">
        ...
    </modules>
</system.webServer> 
```

# visual-studio - 在集成 TeamCity、GitHub 和 Visual Studio 时遇到一些问题

> ID：13128775
> 
> 赞同：0
> 
> 时间：2012-10-29T20:02:46.420
> 
> 标签：visual-studio, github, teamcity

**我想做的事：**

我想为托管在 GitHub 上的项目设置与 Team City 的持续集成。

**目前正在做什么**

我已正确连接到 GitHub。提交、推送等似乎都很好。TeamCity 已设置好，我可以启动一个构建，该构建将运行并运行我的单元测试，但是......

**什么不工作**

当我进行 TeamCity 构建时，它看起来像是在进行构建或运行单元测试之前从 GitHub 中提取代码。我想在提交到 GitHub*之前触发 TC 构建。*在运行 TC 构建之前，我真的不希望它从 GitHub 中提取任何代码。这似乎根本不起作用。

我已经设置了一个 BuildTrigger，它是一个 VCS 触发器。我已经选中了在每次签入时触发构建的框。我使用 VCS (Github) 源和我的用户名向 BuildTrigger 添加了一条规则。

当我进行提交时，我没有注意到 TC 做任何事情。然后当我将提交推送到 GitHub 时，TC 也不做任何事情。我没有看到构建排队或类似的东西。

关于我做错了什么的任何线索？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T17:52:37.040

你看过 TeamCity 的[预测试提交](http://www.jetbrains.com/teamcity/features/delayed_commit.html)功能吗？它并不像您描述的那样工作，您希望您的工作流程运行，但它可能很有用。我过去曾将它与 Subversion 一起使用，并且效果很好，我没有将它与 Git 一起使用，但[JetBrains 表示](http://confluence.jetbrains.net/display/TCD7/Pre-Tested+%28Delayed%29+Commit)它也可以与 Git 一起使用。

但是，Git 最常见的工作流程是为您所做的一切创建功能/错误修复分支，这允许您自由提交和推送，并`master`在您准备好时合并。GitHub 使合并（和可选的代码审查）步骤变得轻松，TeamCity 具有自动构建分支的内置支持，有关它提供的具体细节，请参阅[有关功能分支的 TeamCity 文档。](http://confluence.jetbrains.net/display/TCD7/Working+with+Feature+Branches)

# java - Java将地图值放在树集中？

> ID：13128778
> 
> 赞同：0
> 
> 时间：2012-10-29T20:03:04.100
> 
> 标签：java

我有一个包含一些 bean 的列表，这些 bean 是排序的地图。我想遍历地图并获取值并将它们放入树集中。

```
 List<ItemBean> plannedBeans 
```

这就是“plannedBeans”里面的内容

```
public int getItemNumber() { return unitNumber; }
public SortedMap<Date, Sequencing> getPlannedByMonth() { return sequencing; } 
```

这是地图里面的内容

```
public Date getMonth() { return month; }
public double getPlanned() { return plan; } 
```

我想在排序的地图中获取所有月份并将它们放入一个树集中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T20:11:42.043

一旦您的地图准备就绪，只需对其进行迭代并使用键填充 TreeSet。

```
SortedMap<Date, Sequencing> map;

TreeSet<Date> set = new TreeSet();

for(Entry<Date, Sequencing> en: map.entrySet()) {
   set.add(en.getKey())
} 
```

# jquery - 具有多种形式的jQuery验证

> ID：13128781
> 
> 赞同：0
> 
> 时间：2012-10-29T20:03:28.240
> 
> 标签：jquery, jquery-validate, validation

我的网页上有 3 个单独的表单（所有表单都有唯一的输入字段）

```
 <form id="moneyForm">
 <form id="profile">
 <form id="get_ahelp"> 
```

对于每个表单，我都会创建一个这样的验证规则：

```
$("#moneyForm").validate({  
    rules: {
        u_money:{required:true}             
    },          
    submitHandler: function(form) {
        form.submit();
    }
});

var validator = $("#profile").validate({
        errorElement: "span",
    rules: {
        u_surname:{
            required:true,
            letters:true
            }                       
    },          
    submitHandler: function(form) {
        form.submit();
    }
});

$("#get_ahelp").validate({
    rules: {
        h_name:{required:true}
    },          
    submitHandler: function(form) {
        form.submit();
    }   
}); 
```

当我提交第一份表格时 - 一切正常，第三份也正常验证。

但是当我尝试提交第二个表单（配置文件）时，它以某种方式尝试验证第三个表单。同时在第三种形式的空字段附近，**span**容器中产生错误]。这怎么可能？是否有可能修复它，以及可能导致这样的错误？

PS我为英语道歉，我使用了翻译

# ios - Objective-C - 模态内的旋转甚至 shouldAutoRotate = false

> ID：13128782
> 
> 赞同：1
> 
> 时间：2012-10-29T20:03:39.233
> 
> 标签：ios

即使我将 shouldAutoRotate 设置为 false，我也有一个正在旋转的视图 (InfoVC)。这是打开视图的代码（在模态中）

```
- (IBAction)presentInfoVC:(id)sender{
    InfoVC *infoVC = [[InfoVC alloc] init];
    UINavigationController *infoNVC = [[UINavigationController alloc] initWithRootViewController:infoVC];

    UIImage *img =[UIImage imageNamed:@"image.png"];
    UIImageView *imgView = [[UIImageView alloc] initWithImage:img];

    infoNVC.navigationBar.tintColor = [UIColor lightGrayColor];
    [infoNVC.navigationBar.topItem setTitleView:imgView];
    [imgView release];

    [self presentModalViewController:infoNVC animated:YES];

    [infoVC release];

} 
```

以及应该避免此视图旋转的代码（在 InfoVC.m 中）：

```
- (BOOL)shouldAutorotate
{
    return FALSE;    
} 
```

怎么了？

问候！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T17:46:35.670

您可以使用类别来执行相同的任务，而不是创建 的子类`UINavigationController`（如果 UINavigationController 的所有实例都需要它）。它比子类化方法轻得多，并且不需要您将类类型交换为预先存在`UINavigationController`的 s。

这样做如下：

**UINavigationController+NoRotate.h**

```
@interface UINavigationController(NoRotate) 
- (BOOL)shouldAutorotate;
@end 
```

**UINavigationController_NoRotate.m**

```
#import "UINavigationController+NoRotate.h"

@implementation UINavigationController (NoRotate)

- (BOOL)shouldAutorotate
{
    return NO;
}

@end 
```

从那时起，如果您需要`UINavigationController`不再旋转，只需`UINavigationController+NoRotate.h`在需要的地方导入即可。由于类别覆盖将影响该类的所有实例，如果您只在少数情况下需要此行为，那么您将需要继承 UINavigationController 并覆盖`-(BOOL)shouldAutorotate`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T17:25:47.283

我得到了答案。我发现我应该在 UINavigationController 中实现 shoulAutorotate，而不是在 UIViewController 中。我创建了另一个类（UINavigationController 的子类），像在这个视图中一样实现了 shouldAutorotate，我用它替换了 UINavigationController。

代码：

UINavigationControllerNotRotate.h

```
#import <UIKit/UIKit.h>

@interface UINavigationControllerNotRotate : UINavigationController

@end 
```

UINavigationControllerNotRotate.m

```
#import "UINavigationControllerNotRotate.h"

@interface UINavigationControllerNotRotate ()

@end

@implementation UINavigationControllerNotRotate

- (BOOL)shouldAutorotate
{
    return FALSE;
}

@end 
```

新代码：

```
- (IBAction)presentInfoVC:(id)sender{

    InfoVC *infoVC = [[InfoVC alloc] init];
    UINavigationControllerNotRotate *infoNVC = [[UINavigationControllerNotRotate alloc] initWithRootViewController:infoVC];

    UIImage *img =[UIImage imageNamed:@"logo_vejasp_topbar.png"];
    UIImageView *imgView = [[UIImageView alloc] initWithImage:img];

    infoNVC.navigationBar.tintColor = [UIColor lightGrayColor];
    [infoNVC.navigationBar.topItem setTitleView:imgView];
    [imgView release];

    [self presentModalViewController:infoNVC animated:YES];

    [infoVC release];

} 
```

这对我来说很好。感谢所有试图提供帮助的人！

# javascript - 平台无关的 JS->Native Bridge？

> ID：13128790
> 
> 赞同：2
> 
> 时间：2012-10-29T20:04:08.487
> 
> 标签：javascript, android, ios, mobile-website

我目前正在开发一个应用程序，该应用程序在 iOS 和 Android 上积极使用 webviews 来呈现内容，并使用原生 chrome 围绕它。我希望能够通过 javascript 方法控制这个 chrome。

Android Webview 具有允许这种情况发生的[addJavascriptInterface](http://developer.android.com/reference/android/webkit/WebView.html#addJavascriptInterface%28java.lang.Object,%20java.lang.String%29)，但 iOS 没有此功能。我已经在[iOS JavaScript bridge](https://stackoverflow.com/questions/9473582/ios-javascript-bridge)上查看了 SO 答案，这有一些有用的信息，但它仅适用于 iOS；最佳情况下，相同的底层 Web 代码可以为 Andorid 和 iOS 设备上的回调提供动力。

我想知道 PhoneGap 或 Appcelerator 之类的东西是否提供了一种简单的方法；但是我不需要他们的核心产品（通过底层的 html/css/js 提供原生体验），我什至不知道我需要的东西是否包含在他们的包中。

感谢您提供任何信息！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T21:41:36.233

我想说最好的方法是自己做，结合这两个例子：

```
function nativeDoStuff() {
  if (androidbridge != null {
    androidbridge.doStuff();
  }
  else {
    //construct url
    window.location = "myiphonescheme://dostuff";
  } 
```

想一想，如果你有雄心壮志，你可以编写一个快速的 javascript 对象来为你做这件事：

```
function NativeAppBridge () {
  function runMethod(methodName, params) {
    if (androidbridge != null {
      // If the android bridge and the method you're trying to call exists,
      // we'll just call the method directly:
      if (androidbridge[methodName] != null) {
        androidbridge[methodName].apply(this, params);
      }
    }
    else {
      // building the url is more complicated; best I can think
      // of is something like this:
      var url = "myiphonescheme://" + methodName;
      if (params.length > 0) {
        url += "?"
        var i = 0;
        for (param in params) {
          url += "param" + i + "=" + param;
          ++i;
          if (i < params.length) {
            url += "&";
          } 
        }
      }
    }
  }
} 
```

使用它就像这样简单：

```
var bridge = new NativeAppBridge();

function onClick() {
  bridge.runMethod("doStuff", null);
} 
```

请注意，我在脑海中编写了这个代码，目前没有时间进行测试 - 但我认为它应该足够好，前提是我没有犯任何重大错误

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-04-28T15:01:07.353

如果你打算使用 WKWebView可以试试[XWebView项目](https://github.com/XWebView/XWebView)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T20:20:09.757

您可以使用 phonegap 插件来做到这一点。它们提供了一种在 webview 和您的本地层之间进行通信的绝佳方式。

[在这里你可以看到如何创建一个！](http://www.adobe.com/devnet/html5/articles/extending-phonegap-with-native-plugins-for-ios.html)

以及我对这个主题的个人看法：我使用 phonegap 已经有一段时间了，如果你在 webviews 上，我强烈建议你重新考虑你做事的方式并转向移动网络平台。您可能可以节省很多时间。

在我看来，使用它的最大缺点是您正在创建一个网页而不是移动应用程序。您不能使用本机组件，并且您的应用程序的响应速度会降低。由于您已经在 webviews 上，我相信您只能在这些平台上找到好处。

# java - ActiveMQ 连接被拒绝

> ID：13128794
> 
> 赞同：21
> 
> 时间：2012-10-29T20:04:26.517
> 
> 标签：java, activemq

我正在尝试在我的应用程序中使用，但是当我尝试连接到**localhost**`activemq`时不断收到错误消息：

 **```
log4j:WARN No appenders could be found for logger (org.springframework.core.env.StandardEnvironment).
log4j:WARN Please initialize the log4j system properly.
log4j:WARN See http://logging.apache.org/log4j/1.2/faq.html#noconfig for more info.
Exception in thread "main" org.springframework.jms.UncategorizedJmsException: Uncategorized exception occured during JMS processing; nested exception is javax.jms.JMSException: Could not connect to broker URL: tcp://localhost:61616\. Reason: java.net.ConnectException: Connection refused
    at org.springframework.jms.support.JmsUtils.convertJmsAccessException(JmsUtils.java:316)
    at org.springframework.jms.support.JmsAccessor.convertJmsAccessException(JmsAccessor.java:168)
    at org.springframework.jms.core.JmsTemplate.execute(JmsTemplate.java:469)
    at org.springframework.jms.core.JmsTemplate.send(JmsTemplate.java:534)
    at org.springframework.jms.core.JmsTemplate.send(JmsTemplate.java:526)
    at sender.MessageSender.sendMessage(MessageSender.java:16)
    at sender.SenderMain.main(SenderMain.java:13)
Caused by: javax.jms.JMSException: Could not connect to broker URL: tcp://localhost:61616\. Reason: java.net.ConnectException: Connection refused
    at org.apache.activemq.util.JMSExceptionSupport.create(JMSExceptionSupport.java:35)
    at org.apache.activemq.ActiveMQConnectionFactory.createActiveMQConnection(ActiveMQConnectionFactory.java:293)
    at org.apache.activemq.ActiveMQConnectionFactory.createActiveMQConnection(ActiveMQConnectionFactory.java:238)
    at org.apache.activemq.ActiveMQConnectionFactory.createConnection(ActiveMQConnectionFactory.java:184)
    at org.springframework.jms.support.JmsAccessor.createConnection(JmsAccessor.java:184)
    at org.springframework.jms.core.JmsTemplate.execute(JmsTemplate.java:456)
    ... 4 more
Caused by: java.net.ConnectException: Connection refused
    at java.net.PlainSocketImpl.socketConnect(Native Method)
    at java.net.PlainSocketImpl.doConnect(PlainSocketImpl.java:351)
    at java.net.PlainSocketImpl.connectToAddress(PlainSocketImpl.java:213)
    at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:200)
    at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:432)
    at java.net.Socket.connect(Socket.java:529)
    at org.apache.activemq.transport.tcp.TcpTransport.connect(TcpTransport.java:504)
    at org.apache.activemq.transport.tcp.TcpTransport.doStart(TcpTransport.java:467)
    at org.apache.activemq.util.ServiceSupport.start(ServiceSupport.java:55)
    at org.apache.activemq.transport.AbstractInactivityMonitor.start(AbstractInactivityMonitor.java:132)
    at org.apache.activemq.transport.TransportFilter.start(TransportFilter.java:58)
    at org.apache.activemq.transport.WireFormatNegotiator.start(WireFormatNegotiator.java:72)
    at org.apache.activemq.transport.TransportFilter.start(TransportFilter.java:58)
    at org.apache.activemq.transport.TransportFilter.start(TransportFilter.java:58)
    at org.apache.activemq.ActiveMQConnectionFactory.createActiveMQConnection(ActiveMQConnectionFactory.java:273)
    ... 8 more 
```

应该运行一个文件来启动它（活动 mq），这是`.bat`Windows 机器上的一个文件。当您运行它时，它会启动，并让它在命令提示符下运行。

在家里，我有一台 mac，使用**相当于 mac**的终端只打印：

```
Last login: Mon Oct 29 19:57:15 on ttys000
(null):~ rickilambert$ /Users/rickilambert/Downloads/apache-activemq-5.7.0/bin/macosx/activemq ; exit;
Usage: /Users/rickilambert/Downloads/apache-activemq-5.7.0/bin/macosx/activemq { console | start | stop | restart | status | dump }
logout

[Process completed] 
```

任何人都可以帮我启动并运行这个东西吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-10-29T20:07:01.027

您的应用程序无法连接到 activemq。检查您的 activemq 是否正在运行并在 localhost 61616 上侦听。

您可以尝试使用：`netstat -a`来检查 activemq 进程是否已启动。或者尝试检查您是否可以使用管理页面访问您的 actvemq：localhost:8161/admin/queues.jsp

在 mac 上，您将使用以下命令启动您的 activemq：

```
$ACTMQ_HOME/bin/activemq start 
```

或者，如果您的配置文件（activemq.xml）位于另一个位置，您可以使用：

```
$ACTMQ_HOME/bin/activemq start xbean:file:${location_of_your_config_file} 
```

在您的情况下，可执行文件位于：`bin/macosx/activemq`所以您需要使用：`$ACTMQ_HOME/bin/macosx/activemq start`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-11-30T20:51:23.580

我在使用以下获取连接工厂 ConnectionFactory factory = new 时遇到了类似的问题
`ActiveMQConnectionFactory("admin","admin","tcp://:61616");`

当我将其更改为以下时，它已解决

`ConnectionFactory factory = new ActiveMQConnectionFactory("tcp://:61616");`

下面显示我的 Q 尺寸正在增加.. `http://:8161/admin/queues.jsp`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-11-27T13:51:57.117

我也有类似的问题。在我的情况下，brokerUrl 配置不正确。这就是我收到以下错误的方式：

```
Cause: Error While attempting to add new Connection to the pool: nested exception is javax.jms.JMSException: Could not connect to broker URL : tcp://localhost:61616\. Reason: java.net.ConnectException: Connection refused 
```

＆我按照以下方式解决了它。

```
 ActiveMQConnectionFactory connectionFactory = new ActiveMQConnectionFactory();

  connectionFactory.setBrokerURL("tcp://hostname:61616");
  connectionFactory.setUserName("admin");
  connectionFactory.setPassword("admin"); 
```**

# regex - 在文本中搜索并验证年份（四个连续数字）

> ID：13128795
> 
> 赞同：0
> 
> 时间：2012-10-29T20:04:30.007
> 
> 标签：regex

如何验证字符串只有**4**个连续数字或没有数字？

我知道这`/\d{4}/`将验证**4**个连续的数字，但如果我的字符串是 dh25ah1233dadh3，它一定是无效的。

有效字符串

```
dkskdsokd
adad dadad
addad1257adada
1587dadad
sasasas7854 
```

无效的字符串

```
dh25ah1233dadh3
fsdfdfd1982fdf2
1some1422dd 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T20:07:41.030

如果我理解这个问题，它会是这样的：

```
/^(?:\D*\d{4}\D*)*$/ 
```

这匹配任何数量的子模式“一些非数字，然后是 4 个数字，然后是一些非数字”。

如果你只想要一组 4 位数字，那就是

```
/^\D*(?:\d{4})?\D*$/ 
```

*编辑*——如果你想要第一个，并且你不希望接受 8 位（或 12 或 16 位 ...）数字组，你会做这样的事情：

```
/^(?:\D*\d{4}\D+)*$/ 
```

*编辑*让我们再试一次：

```
/^(?:\D*\d{4}\D+)*(?:\D*\d{4})?$/ 
```

这允许字符串以 4 位数字组结尾。

# javascript - Flowplayer 播放列表仅播放第一个剪辑

> ID：13128799
> 
> 赞同：0
> 
> 时间：2012-10-29T20:04:47.767
> 
> 标签：javascript, flowplayer, playlist

我有一个`flowplayer`播放多个剪辑/视频的设置。但是，情况是它没有按照我打算执行的方式执行。对于我的生活，我无法弄清楚如何在第一个剪辑结束后自动播放第二个和/或后续视频。有任何想法吗？

```
$f("player", "/flowplayer/flowplayer.commercial-3.2.11.swf", {
key: '#$*******************',
logo: {
    url: 'logo.png',
    fullscreenOnly: false,
    displayTime: 11,
    top: 195,
    left:  400.25,
    fadeSpeed: 1100,
    opacity: 0,
    linkUrl: 'http://www.mysite.com',
    linkWindow: '_blank'

},

clip: {
    autoPlay: true,
    autoBuffering: true,

    onCuepoint: [[00,5000,13000,30000,39000,47000,53000,67000,75000,86000,100000,110000,118000], function(clip, point) {
        info.innerHTML = '<iframe src="cue_player.php?id=3716&time='+ point+'" height="490" width="730" frameborder="0" scrolling="no"></iframe>'
    }],

    // track start event for this clip
    onStart: function(clip) {
        _tracker._trackEvent("Videos", "Play", "");
    },

    // track pause event for this clip. time (in seconds) is also tracked
    onPause: function(clip) {
        _tracker._trackEvent("Videos", "Pause", "", parseInt(this.getTime()));
    },

    // track stop event for this clip. time is also tracked
    onStop: function(clip) {
        _tracker._trackEvent("Videos", "Stop", "", parseInt(this.getTime()));
    },

    // track finish event for this clip
    onFinish: function(clip) {
        _tracker._trackEvent("Videos", "Finish", "");
    },

    provider: 'rtmp'
}, 
playlist:[      {                 
        url: 'first_clip.mp4', 
        start: '0'
        },
        {
            url:'second_clip.mp4',
        }],  

    plugins: {
        rtmp: {
            url: '/flowplayer/flowplayer.rtmp-3.2.10.swf',
            netConnectionUrl: 'rtmp://video.mysite.com/videostream'
        }
    }
} 
```

);

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T20:11:35.020

我不确定，但似乎第二个对象中的悬挂逗号可能会导致错误，这可能会阻止您想要的东西：

```
playlist:[      {                 
        url: 'first_clip.mp4', 
        start: '0'
        },
        {
            url:'second_clip.mp4', //does removing this comma help?
        }], 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T13:44:29.623

好的，所以我终于想通了。这就是我的方式：

```
playlist:[{                 
    url: 'first_clip.mp4', 
    start: '0'
    },
    {
        url:'second_clip.mp4', //does removing this comma help?
    }], 
```

但解决方案是在文件名前直接放置一个“/mp4:”。所以现在它看起来像这样并且可以工作：

```
playlist:[{                 
    url: 'mp4:first_clip.mp4', 
    start: '0'
    },
    {
        url:'mp4:second_clip.mp4', //does removing this comma help?
    }], 
```

不确定它是否有所作为，但我使用视频服务器而不是网络服务器来提供视频。

# ios - 测试 iOS 点对点通信/Bonjour

> ID：13128809
> 
> 赞同：0
> 
> 时间：2012-10-29T20:05:28.270
> 
> 标签：ios, unit-testing, testing

我目前正在启动一个项目，该项目处理使用 Bonjour 在局域网中进行 p2p 通信的 iOS 设备。

我想知道如何测试 Bonjour 和 iOS 应用程序的其他联网组件，无论是自动的还是手动的（临时测试）。

# c# - 使用 GET 请求将复杂对象发送到服务堆栈

> ID：13128813
> 
> 赞同：1
> 
> 时间：2012-10-29T20:05:38.143
> 
> 标签：c#, jquery, .net, web-services, servicestack

一段时间以来，我所有的[ServiceStack](https://servicestack.net/)服务一直在使用`POST`动词来处理客户端发送的传入请求。不过，在这个特定场景中，我想使用`GET`动词，并且我希望能够传递一个相当复杂的对象（例如，包含数组。）

这是我的 ServiceStack 代码：

```
[Route("Test")]
public class TestRequest : IReturn<TestResponse>
{
    public Criteria Criteria { get; set; }
}

public class Criteria
{
    public string Msg { get; set; }
    public string[] Keys { get; set; }
}

[DataContract]
public class TestResponse
{
    [DataMember]
    public string Text { get; set; }

    [DataMember]
    public ResponseStatus ResponseStatus { get; set; }
}

public class TestService : ServiceInterface.Service, IGet<TestRequest>, IPost<TestRequest>
{
    public object Get(TestRequest request)
    {
        return HandleRequest(request);
    }

    public object Post(TestRequest request)
    {
        return HandleRequest(request);
    }

    private object HandleRequest(TestRequest request)
    {
        if (request == null) throw new ArgumentNullException("request");

        if (request.Criteria == null)
            throw new ArgumentException("Criteria is null.");

        return new TestResponse
        {
            Text =
                String.Format(
                    "Text: {0}. Keys: {1}",
                    request.Criteria.Msg,
                    String.Join(", ", request.Criteria.Keys ?? new string[0]))
        };
    }
} 
```

由具有以下 jQuery 代码的 HTML 应用程序使用：

```
$(document).ready(function () {
    $.when($.ajax({
        url: '/Test',
        type: 'get',
        dataType: 'json',
        contentType: 'application/json',
        data: {
            "criteria": JSON.stringify({
                "msg": "some message",
                "keys": ["key1", "key2"]
            })
        }
    }).done(function (response) {
        console.log(response);
    }).fail(function (response) {
        console.log(response);
    }));
}); 
```

创建了我的 Criteria 对象，但`Msg`和`Keys`属性为空。

通过以下`POST`示例，应用程序按预期工作：

```
$(document).ready(function () {

        $.when($.ajax({
            url: '/Test',
            type: 'post',
            dataType: 'json',
            contentType: 'application/json',
            data: JSON.stringify({
                "criteria": {
                    "msg": "some message",
                    "keys": ["key1", "key2"]
                }
            })

        }).done(function (response) {
            console.log(response);
        }).fail(function (response) {
            console.log(response);
        }));
    }); 
```

我有什么误解？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T20:13:12.197

注意：您不能将 JSON 字符串与 JSON 对象（即在[C#中键入](http://en.wikipedia.org/wiki/C_Sharp_%28programming_language%29)[POCO](http://en.wikipedia.org/wiki/Plain_Old_CLR_Object)）混合和匹配。

您正在尝试发送在 JSON 字符串中转义的序列化 JSON 字符串，例如：

```
"{\"msg\":..." 
```

在连接到期望 JSON 对象的 POCO 的线路上，例如：

```
{"msg":... 
```

如果条件是一个字符串，例如：

```
public class TestRequest : IReturn<TestResponse>
{
    public string Criteria { get; set; }
} 
```

它应该可以工作，否则您需要更改 JSON 请求以发送 JSON 对象而不是序列化的 JSON 对象 + 转义为 JSON 字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T20:10:41.590

当您将 JSON.stringify 与[GET](http://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol#Request_methods)请求一起使用时，查询字符串的格式不正确......

# zend-framework - 将自定义表与自定义属性上的产品属性连接起来

> ID：13128818
> 
> 赞同：1
> 
> 时间：2012-10-29T20:05:59.500
> 
> 标签：zend-framework, magento

这相当简单 - 我有一个表格，其中有一个对应于某些自定义产品属性的字段。

```
+----+-----------+---------+---------------------+  
| id | from_user | to_user | first_contact       |  
+----+-----------+---------+---------------------+  
|  2 |         2 |       2 | 2012-10-26 18:24:30 |  
+----+-----------+---------+---------------------+ 
```

`to_user`对应于`profile_id`唯一的产品属性。现在，我需要将该产品的 和 等产品属性加入`status`到`url_key`我的自定义表中。我很快就陷入困境，因为我不知道如何`profile_id`在我的连接语法中引用字段。我总是可以依赖平面产品表，但我想让脚本更健壮，以便即使平面产品关闭也能正常工作。我想我应该使用`joinAttribute()`，但我无法理解如何使用。

谢谢

# java - 可以加快这个java代码的速度吗？

> ID：13128819
> 
> 赞同：0
> 
> 时间：2012-10-29T20:06:00.577
> 
> 标签：java, optimization

我在一个 Android 应用程序中有一些代码，当我分析我的应用程序时，它会占用大部分时间。我试图优化它，但仍然占用了大部分 CPU 时间。我想知道是否有人对我如何加快速度有任何想法。这是我使用的代码的精简版本：

输入：
d 是浮点数数组
a 是浮点数数组
e 是浮点数数组

输出：
out 是一个包含 3 个浮点数的数组

代码：

```
float [] c=new float[3];
float [] b=new float[3];
float [] out=new float[3];

c[0] = a[0] - d[0 * 4 + 3];
c[1] = a[1] - d[1 * 4 + 3];
c[2] = a[2] - d[2 * 4 + 3];

b[0] = c[0]*d[0 * 4 + 0] + c[1]*d[1 * 4 + 0] + c[2]*d[2 * 4 + 0];
b[1] = c[0]*d[0 * 4 + 1] + c[1]*d[1 * 4 + 1] + c[2]*d[2 * 4 + 1];
b[2] = c[0]*d[0 * 4 + 2] + c[1]*d[1 * 4 + 2] + c[2]*d[2 * 4 + 2];           

out[0] = b[0] * e[0 * 4 + 0] + b[1] * e[0 * 4 + 1] + b[2] * e[0 * 4 + 2] + e[0 * 4 + 3];
out[1] = b[0] * e[1 * 4 + 0] + b[1] * e[1 * 4 + 1] + b[2] * e[1 * 4 + 2] + e[1 * 4 + 3];
out[2] = b[0] * e[2 * 4 + 0] + b[1] * e[2 * 4 + 1] + b[2] * e[2 * 4 + 2] + e[2 * 4 + 3]; 
```

对于那些对其 3D 模型动画的顶点变换感兴趣的人。'out' 是变换后的顶点，'a' 是原始顶点。其余的数组是骨架关节信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T20:11:14.913

其余的代码是做什么的？这看起来像一小段代码，所以它应该执行得非常快。你真的有性能问题，还是你想让你的程序完全不消耗 CPU？

也就是说，您可以简单地预先计算所有这些微不足道的算术运算：

```
c[0] = a[0] - d[3];
c[1] = a[1] - d[7];
c[2] = a[2] - d[11]; 
```

等等

我不明白您如何访问`d[3]`，虽然，因为`d[7]`应该是一个由 3 个元素组成的数组。`d[11]``d`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T20:11:29.313

您对此无能为力..所有操作都是赋值和数学运算，您没有实现这些。此外，这些操作已经非常快了......在某种 for 循环中执行此操作会更节省内存，因为 java 必须在相乘之前存储所有这些数字。动态做会更有效率。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T20:11:50.187

好吧，一个乘以零可以简化为零，然后删除加法，但我相信他们的编译器或热点已经这样做了。

您可以尝试[记忆](http://en.wikipedia.org/wiki/Memoisation)结果以防止重新计算。

此外，您可以尝试使用[JCuda](http://www.jcuda.org/)将这种数学运算卸载到 GPU，但我不知道 Android 是否支持此功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-29T23:39:06.633

所有编译时常量都将（*必须*）由编译器进行常量折叠。您所能做的就是消除临时数组，无论如何您都不会将其用作数组。我试过这样：

```
public float[]  transform2(float[] a, float[] d, float[] e)
{
    float c0,c1,c2;
    float b0,b1,b2;
    float [] out=new float[3];

    c0 = a[0] - d[0 * 4 + 3];
    c1 = a[1] - d[1 * 4 + 3];
    c2 = a[2] - d[2 * 4 + 3];

    b0 = c0*d[0 * 4 + 0] + c1*d[1 * 4 + 0] + c2*d[2 * 4 + 0];
    b1 = c0*d[0 * 4 + 1] + c1*d[1 * 4 + 1] + c2*d[2 * 4 + 1];
    b2 = c0*d[0 * 4 + 2] + c1*d[1 * 4 + 2] + c2*d[2 * 4 + 2];           

    out[0] = b0 * e[0 * 4 + 0] + b1 * e[0 * 4 + 1] + b2 * e[0 * 4 + 2] + e[0 * 4 + 3];
    out[1] = b0 * e[1 * 4 + 0] + b1 * e[1 * 4 + 1] + b2 * e[1 * 4 + 2] + e[1 * 4 + 3];
    out[2] = b0 * e[2 * 4 + 0] + b1 * e[2 * 4 + 1] + b2 * e[2 * 4 + 2] + e[2 * 4 + 3];

    return out;
} 
```

您的代码需要 35665 毫秒来运行`10000000000L`迭代。`transform2()`花了 20077 毫秒，所以它的速度略低于两倍。两种方法都先预热，a[]、d[] 和 e[] 包含随机浮点数。

我想知道是否可以通过创建`out`参数而不是在方法内部分配它来改进事情，如果`out`可以在外部保存，但这在您的调用代码中可能是不可能的。然而，将它作为第四个参数添加会使它变得更糟：它必须撤消一些 HotSpot 优化。但是，当您使用 Android 时，如果可行，您可能会考虑这样做。

这是很多迭代...

# c# - 是否有最短路径算法的开源实现，并带有 la Gavoille 等人的距离标记？

> ID：13128820
> 
> 赞同：6
> 
> 时间：2012-10-29T20:06:00.907
> 
> 标签：c#, c++, algorithm, graph, graph-algorithm

如果您被允许预先计算`|V|`图上数据量的线性，那么有一系列算法对于图中的最短路径具有次线性查询时间。

1.  Gavoille 等人。图中的距离标记。
2.  科恩等人。通过 2 跳标签的可达性和距离查询
3.  亚伯拉罕，戈德堡等人。[最短路径的分层集线器标签](http://research.microsoft.com/apps/pubs/default.aspx?id=168725)

其中一些在[Bing 地图](http://www.bing.com/community/site_blogs/b/maps/archive/2012/01/05/bing-maps-new-routing-engine.aspx)中用于极快的最短路线计算。

基本思想是预先计算每个顶点的前向标签`L_f(v)`和后向标签`L_b(v)`，它们构成一个**覆盖属性**。每个标签是一对顶点和到它的距离，例如`L_f(v) = { (u, dist(v, u)) }`和`L_r(v) = { (u, dist(u, v)) }`。并且**覆盖属性**断言对于任何顶点 s 和 t `L_f(s)`'Union'`L_r(t)`在从 s 到 t 的最短路径上至少包含一个顶点。

是否有其中一种算法（C++、C#、F#、D、Go、Java）的开源实现？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T07:52:13.263

我还没有找到任何实现这些算法的代码，但你可以查看[Karlsruhe 主页](http://algo2.iti.kit.edu/routeplanning.php)，在那里你可以找到收缩层次结构的代码，它构成了（原始）集线器标签的基础。您可以使用它来创建自己的 HL 实现，但您应该知道他们为它申请了[专利](http://www.faqs.org/patents/app/20120250535)。

# php - 从“GET”index.php?id=XX 编辑 mysql 数据库

> ID：13128823
> 
> 赞同：1
> 
> 时间：2012-10-29T20:06:22.633
> 
> 标签：php, mysql, edit

我目前正在学习 PHP。我用管理面板、会话等编写了一个简单的桶列表脚本，只是为了看看我能不能做到。

我正在编码的最后一页是“edit.php”和“editone.php”我有一个表，它返回数据库“ID、目标和评级”中的所有数据我的第四列返回“EDIT”作为链接前往：`editone.php?id=xx`

editone.php 当前不是一个页面。对于我的一生，我无法弄清楚我是如何编写editone的，所以我可以获取数据并更新mysql。我快到了，只是无法拼凑这个谜题。

这是我的编辑页面代码的核心。

```
<?php
    while ($query_row = mysql_fetch_array($query)) 
    { 
        echo "<tr>";
        echo "<td>".$query_row['id']."</td><td>". $query_row['goals']."</td><td><span class='label label-inverse'>". $query_row['rating']."</span></td><td><a href='editone.php?id=".$query_row['id']."'>Edit</a></td>"; 
        echo "<tr>";
    }
?> 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T20:11:57.627

通过 POST 方法将所有参数发送到editone页面。我的意思是在您的编辑页面中，您正在从数据库中获取所有变量。您可以在具有提交按钮且类型为“POST”的表单中显示它们。所以现在当有人提交时，它会转到 editone.php 页面。

首先通过 $_POST 方法获取所有变量。然后写一个更新查询。

```
$sql = "UPDATE tablename SET goals = '$goal', rating='$rating' WHERE id = $id"; 
```

确保按照评论中的说明转义您的帖子变量。

这应该是您的 PDO 更新声明。

```
// database connection
$conn = new PDO("mysql:host=$dbhost;dbname=$dbname",$dbuser,$dbpass);

// new data
$goals = 'Some goals';
$rating = 'whatever rating';
$id = 3;
// query
$sql = "UPDATE tablename 
        SET goals=?, rating=?
        WHERE id=?";
$q = $conn->prepare($sql);
$q->execute(array($goals,$rating,$id)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T21:21:17.953

如果我对您的理解正确，您想要的是一个首先*显示*单行的页面（以便可以对其进行编辑），*然后*在完成后保存它。因此，您首先编写没有数据的 HTML 表单。

接下来，您从查询字符串中读取 ID：

```
<?php 
    $rowId = $_GET['id']; 
```

然后查询数据：

```
// database connection example borrowed from Abhishek
$conn = new PDO("mysql:host=$dbhost;dbname=$dbname",$dbuser,$dbpass);

$sql = "SELECT goals, rating FROM tablename WHERE id = ?";
$query = $conn->prepare($sql);
$query->execute(array($rowId));
$row = $query->fetch(); 
```

现在，您可以使用这些数据来填充您的表单。这让你大约成功了一半。:-)

您会希望实际保存响应`POST`请求，而不是`GET`. 关于为什么会这样，有一个[冗长且有些复杂](http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html)的解释，但简化版本是`POST`您在为用户进行更改时使用，并且`GET`当您只是读取数据时 - 有一堆浏览器和代理行为等等与这些假设相关，因此最好尽早开始以正确的方式做事。

当您处理`POST`请求时 - 您可以在同一页面上执行此操作 - 您将获得用于抓取的更新表单值，并且您可以使用它们来更新您的数据库：

```
// This can be a hidden field on the form...
$rowId = $_POST['id'];
$goals = $_POST['goals'];
$rating = $_POST['rating'];

// database connection example borrowed from Abhishek
$conn = new PDO("mysql:host=$dbhost;dbname=$dbname",$dbuser,$dbpass);

$sql = "UPDATE tablename SET goals = ?, rating = ? WHERE id = ?";
$query = $conn->prepare($sql);
$query->execute(array($goals, $rating, $rowId)); 
```

在此之后，您的数据库应该被更新。为了完成任务，您可能需要[重定向回页面](http://www.theserverside.com/news/1365146/Redirect-After-Post)以确保表单不会被意外重复提交。

我没有在这里涵盖*所有内容*，有点故意。当有一些空白要填写时会更有趣。:-)

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-10-29T20:16:32.377

最常见的解决方案是使用 html 表单。此表单的输入值是`select`带有`id`in 查询字符串的 a。当按下提交按钮来保存它时，进行更新。但是我想和你分享[一个好的和完整的 web 2.0 例子](http://www.9lessons.info/2011/03/live-table-edit-with-jquery-and-ajax.html)。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-10-29T20:20:18.517

你可能希望你的第二个`<tr>`是`</tr>`.

# wpf - 关闭父窗口时如何处理动态加载的用户控件/视图模型

> ID：13128829
> 
> 赞同：1
> 
> 时间：2012-10-29T20:06:29.077
> 
> 标签：wpf, window, dispose

我们有一个启动子窗口的主窗口。该子窗口动态加载自定义用户控件。在这些用户控件的构造器中，我传递了一个主对象，从这个主对象中，生成一个特定于用户控件的视图模型并将其分配为它的数据上下文。

所有这些都运行良好。但是，我发现当我关闭子窗口时，至少我的一些自定义用户控件仍然处于活动状态。我应该如何清理我的控件/视图模型？在主窗口关闭之前，似乎什么都没有被调用。没有析构函数，没有 Dispatcher.ShutdownStarted，没有可用的 dispose，没有关闭事件，我什么也找不到。

有人知道窗户关闭后应该怎么做才能正确清理吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T20:52:53.833

我相信你需要仔细考虑是什么负责创建你的视图和你的视图模型，以及什么负责确定某些东西是否可以关闭等等。

对于任何创造了破坏它的东西来说，这通常是一个好主意。因此，如果您的子窗口正在创建自定义用户控件，它可能应该负责删除它们。但是，我相信如果您的所有对象都没有引用（或强事件订阅），它最终应该被垃圾收集。您可以实现终结器/析构函数并将 Debug.String 输出到输出窗口以查看最终可能发生的时间。一个好的内存分析器也可能是一个好主意。但是，您也可能需要更精确地控制 ViewModel 何时关闭。

很难确切地说出在您的场景中应该发生什么，因为它实际上取决于您的确切和具体设置。让我向您描述我在应用程序中遇到的一个场景。我有几个视图显示在标签页中。标签页有一个 X 按钮来关闭标签，我的视图包含一个托管的 Windows 窗体控件，需要调用 .Dispose() 来清理资源，并且需要通知它何时取消订阅文件菜单系统。所以，最初，我遇到了一个问题......当标签页删除视图时，我的 ViewModel 如何取消订阅命令？WPF 控件中包含的视图如何知道它何时被删除？这就是我想出的

1.  标签页本身不应该告诉我的程序是否可以关闭视图
2.  我需要能够在程序逻辑的情况下取消关闭事件（文件已保存？是/否/取消）
3.  我需要能够检测它何时关闭，以便我可以在那一刻清理/取消注册

我的解决方案是在我的视图模型中实现一个名为 IRemovable 的接口，它公开了一个 Removable 布尔值和一个返回布尔值（是否被删除）的 Remove() 方法。如果 Removable 为真，我的选项卡控件仅显示 X 按钮，选项卡控件的 Closing 触发了 IRemovable ViewModel 的 Remove()，如果它返回 false，则在 ViewModel 的 Remove 返回 false 时将事件 args Canceled 属性设置为 true。

因此，删除视图模型可能会提示用户确认、取消注册命令等。视图可以处理 Closed 事件并在任何 Windows 窗体组件上调用 Dispose 等。（当然，我必须检查我的 View.DataContext 是否为可移动）。

无论如何，我知道这不是一个确切的答案，但希望它可以帮助你想出一些关于如何解决你自己的问题的想法

# javascript - rails 资产管道 - Garber-Irish，管理和保持干燥

> ID：13128833
> 
> 赞同：0
> 
> 时间：2012-10-29T20:06:44.677
> 
> 标签：javascript, ruby-on-rails, asset-pipeline, dry

我正在使用所谓的[garber-irish 技术](https://stackoverflow.com/a/6892079/435817)来拆分我的 javascript 文件。

我的问题是，我有一个模型（项目说）并且有一个 init 函数，它位于 app/assets/javascripts/item/item.js

例如

```
MYAPP.items = {
  init: function() {
    alert("do something");
  }
}; 
```

现在.. 假设我对这个应用程序有一个管理方面，我真的不想在主要批量中包含管理 javascript。所以.. 我有一个不同的 system_adminstration.js，它需要上面的*常规*javascripts/item/item.js，但*也*需要一个 javascripts/admin/item/item.js，它看起来像：

```
MYAPP.items = {
  init: function() {
    alert("also do this");
  }
}; 
```

我想加载上面常见*的*javascripts 和特定于管理的 javascripts - 有效地合并两个 init 函数并使事情保持干燥。

问题：

1.  这是一个明智的做法吗？
2.  有可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T21:48:11.953

热衷于评论 - 但我所做的（目前）是将 init 函数更改为：

```
UTIL.exec( "common" );
UTIL.exec( controller );
UTIL.exec( "admin_"+controller );
UTIL.exec( controller, action );
UTIL.exec( "admin_"+controller, action ); 
```

（所以，我添加了一个“admin_”），然后对于*管理员*javascript 文件，我只是添加了一个管理员前缀：

```
MYAPP.admin_items = {
  init: function() { 
```

……

有点讨厌，但我认为它会对我有用，直到有人有更好的建议！

# browser - 在 Windows 8 上运行“真正的”IE8 / IE9？

> ID：13128834
> 
> 赞同：17
> 
> 时间：2012-10-29T20:06:55.037
> 
> 标签：browser, internet-explorer-8, windows-8, internet-explorer-9

在 Windows 8 上，除了在 IE10 中使用渲染模式或创建虚拟设置之外，还有什么方法可以运行 IE8 和 9？与以前版本的 IE 一样，IE10 似乎无法正确渲染 8 和 9。还尝试了 IE Collection，它不会在 Windows 8 上安装任何这些版本。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-29T20:16:41.467

由于微软创建的程序差异和依赖关系（无论出于何种原因），我认为这是不可能的。典型的替代方法是使用 XP 或 W7 安装虚拟机（[Microsoft Virtual PC](http://www.microsoft.com/windows/virtual-pc/)或[VirtualBox](https://www.virtualbox.org/)或[VmWare 桌面产品](http://www.vmware.com/products/desktop_virtualization/)），并为您需要的每个唯一 IE 版本配备一个虚拟机。

**更新**

任何使用 Windows 8 的人，Virtual PC 已重命名为服务器版本 Hyper-V，默认随附 Windows 8，默认不安装。

**更新 2**

我还建议您查看[https://www.browserstack.com/](https://www.browserstack.com/)。这是一个非常好的产品（我与那家公司没有任何关系，我只使用过这个产品并取得了很大的成功）。

# awk - awk 用于多种模式

> ID：13128835
> 
> 赞同：9
> 
> 时间：2012-10-29T20:06:56.690
> 
> 标签：awk, if-statement

我的文件看起来像：

```
L   0   256 *   *   *   *   *
H   0   307 100.0   +   0   0
S   30  351 *   *   *   *   *
D   8   27  *   *   *   *   99.3    
C   11  1   *   *   *   *   * 
```

对于我的脚本，我想从使用 $1 的某些行开始 awk print $0

如

```
awk '{if ($1!="C") {print $0}  else if ($1!="D") {print $0}}' 
```

但是，必须有一种方法可以将“C”和“D”组合成一个 IF 语句……对吧？

例如，如果我想搜索 == L,H,S 即...不是 C 或 D，我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-29T20:12:59.297

你现在的情况是不正确的，`$1!="C"`不能`$1!="D"`同时为假。因此，它将始终打印整个文件。

这将按照您的描述进行：

```
awk '{if ($1!="C" && $1!="D") {print $0}}'  file 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-29T20:14:13.447

使用 awk，您可以使用语法为特定模式提供规则

```
awk 'pattern {action}' file 
```

有关模式的定义，请参见[awk 手册页](http://unixhelp.ed.ac.uk/CGI/man-cgi?awk)。在您的情况下，您可以使用正则表达式作为具有语法的模式

```
awk'/regular expression/ {action}' file 
```

和一个适合您需要的基本正则表达式可能是

```
awk '/^[^CD]/ {print $0}' file 
```

您实际上可以缩短为

```
awk '/^[^CD]/' file 
```

正如评论中所建议的那样，因为`{print $0}`是默认操作。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-29T20:13:02.817

```
awk '$1 ~ /[CD]/' file

awk '$1 ~ /[LHS]/' file

awk '$1 ~ /[^LHS]/' file

awk '$1 !~ /[LHS]/' file 
```

# java - 创建大量的多个输出

> ID：13128846
> 
> 赞同：0
> 
> 时间：2012-10-29T20:08:10.173
> 
> 标签：java, hadoop, mapreduce, distributed

我正在创建大量输出文件，例如 500 个。我正在创建异常，如下所示。当输出文件的数量很少时，程序会自行恢复。例如。如果它的50个文件，虽然发生了这个异常，程序在多次打印这个异常后开始成功运行。

但是，对于许多文件，它最终会以`IOException`.

我粘贴了错误，然后粘贴了以下代码：

```
 12/10/29 15:47:27 INFO mapred.JobClient: Task Id : attempt_201210231820_0235_r_000004_3, Status : FAILED
    org.apache.hadoop.ipc.RemoteException: org.apache.hadoop.hdfs.protocol.AlreadyBeingCreatedException: failed to create file /home/users/mlakshm/preopa406/data-r-00004 for DFSClient_attempt_201210231820_0235_r_000004_3 on client 10.0.1.100, because this file is already being created by DFSClient_attempt_201210231820_0235_r_000004_2 on 10.0.1.130
            at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.recoverLeaseInternal(FSNamesystem.java:1406) 
```

我已经粘贴了代码：

在 Reduce 方法中，我有以下逻辑来生成输出：

```
 int data_hash = (int)data_str.hashCode();
                      int data_int1 = 0;
                      int k = 500;
                      int check1 = 0;
                      for (int l = 10; l>0; l++)
                      {

                       if((data_hash%l==0)&&(check1 == 0))
                       {
                       check1 = 1;
                       int range = (int) k/10;

                       String check = "true";

                      while(range > 0 && check.equals("true"))
                                        {

                                     if(data_hash % range-1 == 0)
                                        {                                                        
                                                check = "false";
                                        data_int1 = range*10;

                                     }
                                        }

                            }

                            }

                               mos.getCollector("/home/users/mlakshm/preopa407/cdata"+data_int1, reporter).collect(new Text(t+" "+alsort.get(0)+" "+alsort.get(1)), new Text(intersection));

                        PLs help! 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T02:52:57.243

问题是所有 reducer 都在尝试使用相同的命名方案编写文件。这样做的原因是

```
mos.getCollector("/home/users/mlakshm/preopa407/cdata"+data_int1, reporter).collect(new Text(t+" "+alsort.get(0)+" "+alsort.get(1)), new Text(intersection)); 
```

设置基于数据特征而不是reducer身份的文件名。

你有几个选择：

1.  重新设计您的地图作业，以便发出的密钥与您在此作业中计算的哈希值相匹配。这将确保每个减速器都有一个值范围。

    1.  在文件名中包含一个对每个映射器都是唯一的标识符。这将为每个减速器留下一组零件文件。

您能否解释一下为什么在这里使用多个输出？我不认为你需要。

# c# - 将 C/C++ 函数导入 C#

> ID：13128849
> 
> 赞同：-4
> 
> 时间：2012-10-29T20:08:12.930
> 
> 标签：c#, c++, c

我有一些 C 代码将使用 P/Invoke 从 C# 调用。我正在尝试为此 C 函数定义 C# 等效项。

```
SomeData* DoSomething();

struct SomeData
{
    ...
} 
```

如何将此 C 方法导入 C#？我无法定义函数的返回类型。

**编辑：** 我有一堆功能要导入。这是让我陷入困境的一个。

```
[DllImport("SomeDll.dll")]
public static extern IntPtr DoSomething(); 
```

我考虑过使用 IntPtr，即使它是正确的，那之后呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-29T20:31:23.057

我不太确定我是否理解您的问题，但我会尝试回答。您需要定义从 C 函数返回的结构并使用[Marshal.PtrToStructure](http://msdn.microsoft.com/en-us/library/4ca6d5z7.aspx)来使用返回的结构。

```
[DllImport("SomeDll.dll")]
public static extern IntPtr DoSomething();

public struct SomeData
{
    //...
}

//code to use returned structure
IntPtr result = DoSomething();

SomeData structResult = (SomeData)Marshal.PtrToStructure(result, typeof(SomeData)); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-29T20:33:04.800

我猜你想要达到的目标如下：

1.  您的 C/C++ 本机方法不接受参数并返回指向结构的指针。
2.  C# 等效项是返回一个 IntPtr（指针）。

问题是您无法将 IntPtr 解析为 C# 中的结构

...研究这个：

Marshal.PtrToStructure(IntPtr, Type)

[http://msdn.microsoft.com/en-us/library/4ca6d5z7.aspx](http://msdn.microsoft.com/en-us/library/4ca6d5z7.aspx)

你可以像这样包装你的代码

```
public static class UnsafeNativeMethods
{
   [DllImport("SomeDll.dll")]
   private static extern IntPtr DoSomething(); //NO DIRECT CALLS TO NATIVE METHODS!!

   public static SomeData SafeDoSomething()
   {
      try
      {
         return (SomeData)Marshal.PtrToStructure(DoSomething(), typeof(SomeData));
      }
      catch(Exception ex)
      {
         //handle exception
      }
   }
} 
```

# jquery - 使用 jquery 切换图像

> ID：13128853
> 
> 赞同：0
> 
> 时间：2012-10-29T20:08:34.290
> 
> 标签：jquery

我在父元素“.learn-more”中有一个图像“sprites arrow-d”。如果单击了解更多，我希望将箭头-d 替换为箭头-u，反之亦然。写这个的最好方法是什么。

```
$('.learn-more').click(function() {

    if ($('.arrow-d').is('arrow-d'))
    {
    $('#hero').animate({
        'height':'400'
    }, 700);
        $('.arrow-d').removeClass('arrow-d').addClass('arrow-u');
    }
    else 
    {
        $('.arrow-u').removeClass('arrow-u').addClass('arrow-d');
    }

}); 
```

html:

```
 <div class="learn-more">
            <span>LEARN MORE ABOUT</span>
            <i class="sprites arrow-d"></i>
        </div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T20:14:38.920

```
$('.learn-more').on('click', function() {
    $('#hero').animate({'height': $('.arrow-d').length?400:80}, 700);
    $('.arrow-d').toggleClass('arrow-d arrow-u');
});​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T20:11:29.030

您可以改用[`.toggleClass()`](http://api.jquery.com/toggleClass/)方法。这样你就不需要检查类是否存在。像这样的东西：

```
$('.learn-more').click(function() {
    $('#hero').animate({
        'height':'400'
    }, 700);
    $("i.sprites").toggleClass("arrow-d arrow-u");
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T20:12:25.677

```
 $('.learn-more').click(function() {

    var sprites = $(this).find('sprites');
        if (sprites.hasClass('arrow-d'))
        {
$('#hero').animate({
        'height':'400px'
    }, 700);
            sprites.removeClass('arrow-d').addClass('arrow-u');
        }
        else 
        {
$('#hero').animate({
        'height':'80px'
    }, 700);
            sprites.removeClass('arrow-u').addClass('arrow-d');
        }

    }); 
```

# php - PHP DateTime() 类，将一周的第一天更改为星期一

> ID：13128854
> 
> 赞同：8
> 
> 时间：2012-10-29T20:08:37.427
> 
> 标签：php, class, datetime

只要您所在国家/地区一周的第一天是星期日，PHP (5.3+) 中的 DateTime 类就可以很好地工作。在荷兰，一周的第一天是星期一，这使得课程无法用于构建具有周视图和计算的日历。

我似乎无法在 Stackoverflow 或 Internet 的其他地方找到关于如何让 DateTime 表现得好像一周的第一天是星期一的答案。

我在 Stackoverflow 上找到了这篇文章，但它并不能解决您遇到麻烦的所有方式，也不是一个优雅的解决方案。

```
$dateTime = new DateTime('2012-05-14');
$monday = clone $dateTime->modify(('Sunday' == $dateTime->format('l')) ? 'Monday last week' : 'Monday this week'); 
```

有没有办法改变这个或范围日期时间？无法想象这不是一个环境，因为欧洲大部分地区都是从星期一开始的。

**补充：** 发布完整的日历和功能代码不会让事情更清楚。但这里以一行为例。我经常需要检查一周的第一天是什么，或者计算从一周的第一天到该周的不同日期和时间。我的代码充满了这些：

```
$startOfWeek = $date->modify(('Sunday' == $date->format('l')) ? 'Monday last week' : 'Monday this week')->modify('+3 hours')->format(DATETIME); 
```

试图获得一个月或一年的第一个完整周时，我也会得到一个不想要的结果。由于我的 $date 对象并不总是包含相同的日期，因此我必须以这种方式继续检查它，从而使代码难以阅读。在这个日历上有更多的编程要做，我无法预见它会再次出现错误。

**编辑**虽然有一些不一致之处。出于某种奇怪的原因，DateTime 确实得到了下一个正确的：

```
$test = new DateTime('2012-10-29'); // Monday
echo $test->modify('Sunday this week')->format('Y-m-d');  // 2012-11-04

// But...

$test = new DateTime('2012-11-04'); // Sunday
echo $test->modify('Monday this week')->format('Y-m-d');  // 2012-11-05 instead of 2012-10-29 
```

但我想我可以让这个问题更清楚： **DateTime() 类可以与星期一一起用作一周的第一天吗？如果没有，可以延长课程以使用星期一作为一周的第一天。**

**更新：** 好的，我想我到了某个地方......我不是编码课程的专业人士......但这似乎可以持续数周。但它仍然需要第一天、第二天的规则......以及星期天本身的日期名称。我不认为这是万无一失的。我将不胜感激任何修复它的帮助。

```
class EuroDateTime extends DateTime {

// Fields
private $weekModifiers = array (
    'this week',
    'next week',
    'previous week',
    'last week'
);

// Override "modify()"
public function modify($string) {

    // Search pattern
    $pattern = '/'.implode('|', $this->weekModifiers).'/';

    // Change the modifier string if needed
    if ( $this->format('N') == 7 ) { // It's Sunday
        $matches = array();
        if ( preg_match( $pattern, $string, $matches )) {
            $string = str_replace($matches[0], '-7 days '.$matches[0], $string);
        }
    }
    return parent::modify($string);

}

}
// This works
$test = new EuroDateTime('2012-11-04');
echo $test->modify('Monday this week')->format('Y-m-d');
// And I can still concatenate calls like the DateTime class was intended
echo $test->modify('Monday this week')->modify('+3 days')->format('Y-m-d'); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-30T00:48:12.130

我发现这是可行的，但 PHP 的 DateTime 类中存在一些不一致之处。

如果出发日期是星期天，则前一个星期一不被视为同一周（由此类固定）。但是从星期一出发，下个星期日被认为是同一周。如果他们将来解决这个问题，这个类将需要一些补充。

```
class EuroDateTime extends DateTime {

// Override "modify()"
public function modify($string) {

    // Change the modifier string if needed
    if ( $this->format('N') == 7 ) { // It's Sunday and we're calculating a day using relative weeks
        $matches = array();
        $pattern = '/this week|next week|previous week|last week/i';
        if ( preg_match( $pattern, $string, $matches )) {
            $string = str_replace($matches[0], '-7 days '.$matches[0], $string);
        }
    }
    return parent::modify($string);

}

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-29T20:30:07.633

没有什么可以阻止您手动修改日期以获得一周的“第一”天，具体取决于您对“第一”的定义。例如：

```
$firstDayOfWeek = 1; // Monday
$dateTime = new DateTime('2012-05-16'); // Wednesday

// calculate how many days to remove to get back to the "first" day
$difference = ($firstDayOfWeek - $dateTime->format('N'));
if ($difference > 0) { $difference -= 7; }
$dateTime->modify("$difference days");

var_dump($dateTime->format('r')); // "Mon, 14 May 2012 00:00:00 +0000" 
```

注意输出如何随着您的变化而变化`$firstDayOfWeek`；如果将其更改为`4`上述（星期四），则将其视为`Thu, 10 May 2012`“第一”天。

**编辑**：这是一个相当基本的例子。正确的方法是使用用户/系统的语言环境给你“第一天”，然后从那里计算。有关更多信息，请参阅[此问题](https://stackoverflow.com/questions/727471/how-do-i-get-the-first-day-of-the-week-for-the-current-locale-php-l8n)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-05-18T11:37:01.200

也可以用setISODate获取一周的开始和结束，最后一个参数是一周的ISO-daynumber，周一是1，周日是7

```
$firstday = new \DateTime();
$lastday = clone($firstday);
$firstday->setISODate($firstday->format("Y"),$firstday->format("W"),1);
$lastday->setISODate($firstday->format("Y"),$firstday->format("W"),7); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-29T22:23:51.407

我也对问题出在哪里感到困惑，因为`DateTime` *确实*有一个从星期一开始的星期的概念：该[`N`格式](http://php.net/manual/en/function.date.php#refsect1-function.date-parameters)为您提供从星期一到星期日计算的星期几，星期一是 1，星期日是 7。此外，`W`格式，获得周数的唯一方法，也是从星期一开始一周。（我似乎记得荷兰的周数与 ISO 周数不完全一样，但那是另一回事）。那么你到底缺少什么功能呢？

**编辑**所以问题是（仅？）当参考日期是星期日时，[相对日期时间格式](http://www.php.net/manual/en/datetime.formats.relative.php)（例如“本周星期一”）会给出错误的结果。从 docs 听起来好像`DateTime`只是 defers to `strtotime`，它应该是依赖于语言环境的。因此**，如果**您正确设置了您的语言环境并且这不起作用，这听起来像是一个错误（对于它的价值）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-01-09T19:28:47.477

正确答案：

```
$week_start_day; // 0 - Sunday, 1 - Monday

$date_time_from = new DateTime('now');
$date_time_to = clone $date_time_from;

$this_week_first_day = $date_time_from->setISODate($date_time_from->format("Y"), $date_time_from->format("W"), $week_start_day);
$this_week_last_day = $date_time_to->setISODate($date_time_to->format("Y"), $date_time_to->format("W"), (6 + $week_start_day)); 
```

# python - 在函数调用的结果上调用“del”会导致“SyntaxError：无法删除函数调用”

> ID：13128856
> 
> 赞同：1
> 
> 时间：2012-10-29T20:08:41.497
> 
> 标签：python, syntax-error, function-calls

考虑下面的例子：

```
random_tile = random.choice(tiles)
del random_tile 
```

它首先将列表中的一个随机元素分配`tiles`给一个变量，然后对该变量调用一个函数。

那么如果我们要缩短代码如下：

```
del random.choice(tiles) 
```

我们会得到一个`SyntaxError: can't delete function call`. 我试过`eval()`没有运气。如何解决？

**编辑：**

我想做的是从`tiles`列表*中随机*删除一个元素。我以为我找到了一种比用作索引更紧凑的方法`random.randint()`，但我想不是。

否则有没有一种pythonic/传统的方式来做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-29T20:12:48.610

`del`不是函数，它是创建[del 语句](http://docs.python.org/2/reference/simple_stmts.html#grammar-token-del_stmt)的关键字，例如`del var`. 您不能将其用作函数或函数，它只能应用于变量名、变量名列表或订阅和切片，例如

```
del a
del a,b
del l[0]
del l[:] 
```

**要删除随机项目，您可以试试这个**

```
random_tile.remove(random.choice(tiles)) 
```

**但**它不是删除项目的最佳方法，因为它可能意味着对项目和项目比较的内部搜索，如果项目不是唯一的也将不起作用，所以最好是获取随机索引并删除它

```
index = random.randint(0, len(l)-1)
del l[index] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-29T20:16:09.887

如果您尝试实际修改您的`tiles`列表，那么您的第一次尝试也不会这样做。它只是分配给您的变量，然后擦除该变量。那是因为`del`适用于变量本身，而不是它指向的内容。大多数其他函数对某些变量指向的值起作用。因此，除非您确实需要使用`del`，否则您尝试做的事情将正常工作。

另外，如果您尝试使用`del`，我很确定您使用错误。如果您详细说明您正在尝试做什么，我们可能会帮助您。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-29T20:28:50.903

有多种方法可以从列表中删除随机元素。这是一个。

```
>>> import random
>>> my_list = [1, 2, 3, 4, 5]
>>> my_list.remove(random.choice(my_list))
>>> my_list
[1, 2, 4, 5] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-29T20:28:38.883

给定一个列表`tiles`，这可以解决问题：

```
import random
tiles.remove(random.choice(tiles)) 
```

# javascript - 使用 jQuery 在 Redactor 中输入内容

> ID：13128857
> 
> 赞同：1
> 
> 时间：2012-10-29T20:08:47.067
> 
> 标签：javascript, jquery, editor, wysiwyg

我有一个名为“description”的 id 的 textarea 字段。但它是由名为 redactor 的 WHYSIWYG 编辑器渲染的。

如何使用 jquery 在 textarea 中输入内容？

我试过了：

> $('#description').val('hello').blur();

和

> $('#description').val('你好');

但两者都不起作用。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T20:16:35.153

我相信 setCode 方法是您所需要的。只需在文档中查看：http: [//imperavi.com/redactor/docs/api/](http://imperavi.com/redactor/docs/api/)

```
$('#description').setCode ('<p>hello</p>'); 
```

# objective-c - 计算矩形内最大旋转矩形的点和尺寸

> ID：13128859
> 
> 赞同：7
> 
> 时间：2012-10-29T20:08:48.067
> 
> 标签：objective-c, math

我有一个矩形，必须始终旋转相同的度数。让我们称这个角度为 alpha ()。

此矩形的宽度 (w) 和高度 (h) 可以变化。矩形必须始终适合在大矩形内旋转。它必须按比例放大或缩小以适合灰色矩形。

注意：Alpha 是 w 和水平线之间的角度。

所以，有 3 种矩形

```
w > h
w < h  or
w = h 
```

见下图。

![在此处输入图像描述](../Images/1aae6560ac3b03a2a7ab9e7d4c1a078b.png)

我知道的：

1.  大矩形的宽度为 R，高度为 K，我知道这两个值；
2.  w 和 h 未知；
3.  矩形总是旋转度数；
4.  我知道 w/h 的价值。我称之为“比率WH”；
5.  红色矩形始终在灰色矩形上水平和垂直居中

我需要知道的：

1.  对于 w 和 h 的每种情况，将适合灰色矩形的 w 和 h 的最大值。
2.  点**P**的坐标，假设 0,0 在灰色矩形的左上角。

这是我到目前为止所做的，但这并没有给出正确的值：

```
CGPoint P = CGPointZero;

if (ratioWH > 0) { // means w > h

    maxH = R / (ratioWH * fabsf(cosf(theta)) + fabsf(sinf(theta)));
    maxW = maxH * ratioWH;

    // P.x = 0.0f;  // P.x is already zero
    CGFloat marginY = (K - maxW * fabsf(sinf(theta)) - maxH * fabsf(cosf(theta))) / 2.0f;
    P.y = marginY +  maxW * fabsf(sinf(theta));

} else { // w <= h

    maxW  = K / (fabsf(cosf(theta) / ratioImagemXY) + fabsf(sinf(theta)));
    maxH = maxW / ratioWH;

    P.x = (R - maxW * fabsf(cosf(theta)) - maxH * fabsf(sinf(theta))) / 2.0f;
    P.y = maxW * fabsf(sinf(theta));

} 
```

任何线索？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-29T21:42:48.433

我看到它的方式是这样的......你计算出矩形的总宽度和总高度。为此，您只需沿着两条边走。像这样：

```
dx = w * cos(theta) + h * sin(theta)
dy = h * cos(theta) + w * sin(theta) 
```

这些可能是负数，因此如果将矩形旋转到其他象限，将应用特殊处理。这将在以后发生。

您现在只需要宽度和高度之间的比率。这是您决定是按垂直量还是水平量进行缩放的地方。`w`这与和无关`h`——它实际上是关于矩形由于旋转而结束的位置。这就是目的`dx`和`dy`目的。

```
rectratio = abs( dx / dy )
viewratio = R / K 
```

如果`rectratio`结果大于`viewratio`这意味着需要缩放旋转矩形的水平足迹。否则，您将按垂直足迹进行缩放。

```
if rectratio > viewratio
    scale = R / abs(dx)
else
    scale = K / abs(dy)
end 
```

并且缩放本身适用于原始宽度和高度

```
sw = scale * w
sh = scale * h 
```

所以现在你可以计算矩形的角了。从哪里开始并不重要。

```
x[0] = 0
x[1] = x[0] + sw * cos(theta)
x[2] = x[1] + sh * sin(theta)
x[3] = x[2] - sw * cos(theta)

y[0] = 0
y[1] = y[0] - sw * sin(theta)
y[2] = y[1] + sh * cos(theta)
y[3] = y[2] + sw * sin(theta) 
```

我假设图像坐标（0,0）在左上角，所以增加`y`向下移动。所以，如果我的数学没有出错，上面给出了矩形顶点（按顺时针顺序）。

`px`最后要做的是将它们标准化......这意味着找到和的最小值`py`。打电话给他们`pxmin`和`pymin`。我不需要为此显示代码。我们的想法是计算矩形的偏移量，使视图区域由矩形定义`(0,0)`为`(R,K)`.

首先我们需要找到完全包含我们旋转矩形的子视图的左右值...记住之前的比例：

```
if( rectratio > viewratio )
    // view is too tall, so centre vertically:
    left = 0
    top = (K - scale * abs(dy)) / 2.0
else
    // view is too wide, so centre horizontally:
    left = (R - scale * abs(dx)) / 2.0
    top = 0
end 
```

`left`现在`top`是我们的子视图的“最小”坐标，它恰好包含矩形（浮点舍入误差除外）。所以：

```
left += pxmin
top += pymin 
```

现在它们是将矩形移动到所需位置所需的偏移量。你所要做的就是添加`left`和`top`到你所有的矩形坐标，你就完成了。的位置`P`是`px[0]`和`py[0]`。如果您旋转 90 度或更多，它将不是左上角的顶点。

# python - TypeError: start() 只需要 1 个参数（给定 0）？

> ID：13128860
> 
> 赞同：1
> 
> 时间：2012-10-29T20:08:48.453
> 
> 标签：python, multithreading, arguments, typeerror

**我有这样的事情：**

```
class thread1(threading.Thread):
    def __init__(self):
        file = open("/home/antoni4040/file.txt", "r")
        data = file.read()
        num = 1
        while True:
           if str(num) in data:
               clas = ExportToGIMP
               clas.update()
           num += 1     
thread = thread1
        thread.start()
        thread.join() 
```

**我得到这个错误：**

```
TypeError: start() takes exactly 1 argument (0 given) 
```

**为什么？**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-29T20:11:11.510

`thread = thread1`需要`thread = thread1()`。否则，您将尝试调用该类的方法，而不是该类的实际实例。

* * *

此外，不要覆盖`__init__`Thread 对象来完成您的工作 - 覆盖[`run`](http://docs.python.org/2/library/threading.html#threading.Thread.run)。

（虽然您可以覆盖`__init__`进行设置，但这实际上并没有在线程中运行，并且也需要调用`super()`。）

* * *

这是您的代码的外观：

```
class thread1(threading.Thread):
    def run(self):
        file = open("/home/antoni4040/file.txt", "r")
        data = file.read()
        num = 1
        while True:
           if str(num) in data:
               clas = ExportToGIMP
               clas.update()
           num += 1     

thread = thread1()
        thread.start()
        thread.join() 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-29T20:11:41.617

当你写

```
thread = thread1 
```

您分配给`thread`班级`thread1`，即`thread`成为`thread1`. 出于这个原因，如果你再写`thread.start()`你会得到那个错误 - 你正在调用一个实例方法而没有传递`self`

你真正想要的是*实例化* `thread1`：

```
thread = thread1() 
```

so`thread`成为 的实例`thread1`，您可以在其上调用实例方法，例如`start()`.

顺便说一句，正确的使用方法`threading.Thread`是重写`run`方法（您编写要在另一个线程中运行的代码），而不是（仅）构造函数。

# sql - 当表中不存在该日期的记录时，在该日期的查询结果中创建条目

> ID：13128862
> 
> 赞同：0
> 
> 时间：2012-10-29T20:08:55.663
> 
> 标签：sql, tsql

我试图找出一种方法来编写一个查询，该查询将从日志表中提取过去 7 天的记录。查询需要返回日期和描述。如果某个日期没有条目，则查询仍需要在结果中返回该日期。我如何去创建一天的记录，而该日期的日志文件中没有任何内容？

谢谢，垃圾

这是预期结果的示例：

```
10/29/2012, null

10/28/2012, null

10/27/2012, null

10/26/2012, "Error: Unable to load xyz."

10/25/2012, null

10/24/2012, null

10/23/2012, null 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T20:17:17.980

这是我的方式。希望它可以帮助你。我想需要一点解释，你应该有你已经说过的日期列表。此外，即使在该日期没有记录，您也需要使用 LEFT OUTER JOIN 加入具有特定日期的日志以获得日期。我使用了一点 CTE 来生成日期并创建了一个示例表`"Log"`，如下面的代码所示。

```
;   With    Days    (
    Value
)   As  (
    Select  1
Union   All
    Select  Value
    +   1
        From    Days
        Where   Value   <   31
)   Select  Dates.DateString
    ,   Count(Log.Id)
        From    (
            Select  Convert(Nvarchar(10), DateAdd(Day, -Value, GetDate()), 102) As  DateString
                From    Days
        )   As  Dates
        Left    Outer   Join
            Log
        On  Convert(Nvarchar(10), Log.Date, 102)    =   Dates.DateString
        Group   By  Dates.DateString 
```

干杯

# php - MySQL结合了复杂的查询和优化功能

> ID：13128863
> 
> 赞同：1
> 
> 时间：2012-10-29T20:08:56.893
> 
> 标签：php, mysql, join, mysqli, left-join

我正在开发一个相当复杂的通知系统，它在大多数情况下非常简单，复杂性在于检查其他表是否内容已被删除，并且我有多个数据表都进入通知系统，因此它必须检查每一个，并且我必须能够在构建网站时轻松添加更多表以允许添加其他通知类型，并且我正在使用当前查询不允许这样做，我试图想出一个更好的方法来做到这一点，但是我对 mysql 查询还不够好，所以我希望我能得到一些（或者结果可能很多）你们中的一个人（或一些人）的协助。

这是我当前的查询：

```
SELECT
    n.*,
    MIN(n.state) state,
    MIN(n.status) status,
    MAX(n.date) maxDate
FROM notifications n
LEFT JOIN comments c 
     ON n.type = 'comment' 
     AND n.uniqueID = c.id  
     AND c.state='0'
LEFT JOIN posts p 
     ON n.type = 'post' 
     AND p.id = n.uniqueID OR n.type = 'comment' 
     AND p.id = c.postID

WHERE n.toID = '$session'
AND p.state = 0
GROUP BY n.uniqueID
ORDER BY status ASC, maxDate DESC 
```

简而言之，上述语句的作用就是这样。它从通知表中选择通知，在此表中有一个用于`type`该`uniqueID`内容的列。因此，对于类型为 is 的每一行，`posts`它都会检查 post 表，其中`uniqueID`from 通知与 posts 表中的唯一 id 相同，然后检查该帖子的 id`state`以查看它是否已被删除（如果没有被删除，state=0，否则我不想要它）。评论也是如此。

所以我需要一种方法来做所有事情，就像这样做一样，但是我需要它更容易不断地向它添加新的表检查。我一直在尝试为一个名为 likes 的表添加另一个左连接，但是无论出于何种原因，我都无法让它一起工作。但是我想出了这个代码，它可以做我想做的事情。（虽然仅适用于 likes 表，但它不包括我需要的任何其他表）

```
SELECT
    n.*,
    MIN(n.state) state,
    MIN(n.status) status,
    MAX(n.date) maxDate
FROM notifications n
LEFT JOIN likes l 
     ON n.type = 'likes' 
     AND n.uniqueID = l.id 
WHERE n.toID = '$session'
AND l.state='0'
GROUP BY n.uniqueID
ORDER BY status ASC, maxDate DESC 
```

我希望有人可以帮助我解决这个问题，在此先感谢您！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T20:45:06.090

看起来你可以使用“ANY”子查询 [http://dev.mysql.com/doc/refman/5.0/en/any-in-some-subqueries.html](http://dev.mysql.com/doc/refman/5.0/en/any-in-some-subqueries.html)

```
SELECT
    n.*,
    MIN(n.state) state,
    MIN(n.status) status,
    MAX(n.date) maxDate
FROM notifications n
WHERE n.toID = '$session' AND
    (
        (
            n.type = 'likes' AND
            n.uniqueID = ANY (
                SELECT likes.id
                FROM likes INNER JOIN posts on (likes.postId=posts.id)
                WHERE likes.state='0' and posts.state='0'
            )
        ) OR
        (
            n.type = 'comment' AND
            n.uniqueID = ANY (
                SELECT comments.id
                FROM comments INNER JOIN posts on (comments.postId=posts.id)
                WHERE comments.state='0' and posts.state='0'
            )
        ) OR
        (
            n.type = 'post' AND
            n.uniqueID = ANY (SELECT id FROM posts WHERE state='0')
        )
    )
GROUP BY n.uniqueID
ORDER BY status ASC, maxDate DESC; 
```

# matplotlib - 如何获取系统主题的调色板？

> ID：13128864
> 
> 赞同：0
> 
> 时间：2012-10-29T20:09:04.213
> 
> 标签：matplotlib, pyqt4, pyside

出于 matplotlib 的目的，我需要系统用于窗口背景的默认颜色。例如，在 Ubuntu 中，它是一种非常浅的灰色，比 Windows XP 的稍微浅一些。

我正在将默认 matplotlib 补丁的颜色更改为这种灰色，以使它们看起来是原生的。但是，我不想对其进行硬编码。有没有办法从 PyQt 中获取本机背景颜色？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T00:39:37.200

Qt 在`QPalette`. 要在 PySide 中获取某种颜色，请调用

```
QColor(QPalette().color(state, role)) 
```

其中`state`表示颜色的状态（即`QPalette.Disabled`、`QPalette.Active`、`QPalette.Inactive`、`QPalette.Normal`）并`role`表示要确定的符号颜色。可以在[http://qt-project.org/doc/qt-4.8/qpalette.html#ColorRole-enum](http://qt-project.org/doc/qt-4.8/qpalette.html#ColorRole-enum)找到完整的颜色角色列表。

您可能正在寻找的颜色角色是`QPalette.Window`，定义为“一般背景颜色”。

# jquery-mobile - 如何在 Worklight 中保存和删除任何名称或实体？

> ID：13128874
> 
> 赞同：0
> 
> 时间：2012-10-29T20:09:43.493
> 
> 标签：jquery-mobile, ibm-mobilefirst

您好，我是 IBM Worklight 的新手。谁能告诉我如何在 IBM Worklight 中保存名称/实体并将其删除。我也没有得到 sql 适配器的概念。请帮我。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T07:58:23.003

你在谈论用户偏好方法吗？

用户偏好由两个属性组成，用户偏好键和用户偏好值。用户偏好键是唯一标识用户偏好的字符串。

首选项保存在 Worklight 数据库中。为了使用它们，用户必须经过身份验证（因此可以将首选项连接到单个用户）。

你有这些方法可以使用它们：

```
WL.Client.setUserPref(key, value, options)
WL.Client.setUserPrefs({key1:value1, key2:value2, …}, options)
WL.Client.getUserPref(key)
WL.Client.deleteUserPref(key, options)
WL.Client.hasUserPref(key) 
```

SQL 适配器

该适配器使您能够执行参数化的 SQL 查询和存储过程，以便检索或更新数据库中的数据。

您使用参数（如果需要）从客户端调用该过程，然后适配器查询数据库。结果集作为 JSON 对象发送到客户端。

# php - 循环遍历 ID 以显示其他表的输出

> ID：13128878
> 
> 赞同：0
> 
> 时间：2012-10-29T20:09:54.207
> 
> 标签：php, mysql

我在表 x 中有一个 id，表示另一个表中的状态。

例如。

表 x 的状态 id 为 1，表 z 中的 id 为 1 表示一个状态。

我将如何在 php 和 mysql 中循环以显示表 z 中该 id 的值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T20:11:44.300

一个`INNER JOIN`以确保它连接。

`SELECT z.id FROM x INNER JOIN z ON (x.id = z.x_id)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T20:25:32.500

同样的解决方案，更简单的符号是

```
select z.id
from tablex x,
     tablez z
where x.id = z.id 
```

# macros - Freemarker - 将参数传递给嵌套宏

> ID：13128881
> 
> 赞同：0
> 
> 时间：2012-10-29T20:10:03.570
> 
> 标签：macros, freemarker

假设我有两个宏，一个嵌套在另一个宏中。

```
[#macro testNestingTOP id]
   [#nested]
[/#macro]

[#macro testNesting]
   id: ${id}
[/#macro] 
```

* * *

**用法**：

如何从**testNesting**宏中检索 id 参数的值？

```
[@testNestingTOP id='SOME VALUE']
  [@testNesting /]
[/@testNestingTOP] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T19:36:49.473

将属性添加到您的内部宏并将 id 作为值传递给它

```
[@testNesting innerID ]
//code
[@testNesting /]

[@testNestingTOP id='SOME VALUE']
   //code
  [@testNesting innerID=id/]
  //code
[/@testNestingTOP] 
```

我希望这能有所帮助

# java - JList 从新列表中清除以前的条目

> ID：13128886
> 
> 赞同：2
> 
> 时间：2012-10-29T20:10:34.850
> 
> 标签：java, swing, action, jlist, defaultlistmodel

我编写了一个使用 JList 将数据从一个列表移动到另一个列表的程序。但是，当我将所选数据从一个列表移动到另一个列表时，我将数据移动到的列表中的先前条目会被新数据覆盖。

如何制作我在列表中制作的先前条目不会被我尝试移动的新数据覆盖的程序？

问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T20:14:35.177

每当将元素添加到列表时，您都应该使用类似的方法将其添加到列表模型中`addElement()`。

不要将数据添加到`JList`using`setData()`或类似方法。

```
DefaultListModel model = new DefaultListModel();
JList list = new JList(model);
model.addElement(someElement); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-29T20:15:08.737

您应该使用 a`DefaultListModel`作为 JList 模型，并从那里添加和删除。

# java - 尽管授予了适当的文件权限，但 Java AccessControlException

> ID：13128893
> 
> 赞同：1
> 
> 时间：2012-10-29T20:10:49.013
> 
> 标签：java, windows, rmi, access-control, securitymanager

我在尝试使用 SecurityManager 运行 Java RMI 应用程序时遇到了一个奇怪的错误。当服务器启动时，我希望它从作为命令行参数提供的文件中读取文本。我正在使用 Eclipse，并且该文件与 Java 项目的根目录位于同一目录中（因此我可以在命令行参数中给出文件名而不是完整路径）。我知道 RMI 的 SecurityManager 默认禁止文件 I/O，所以我为我的服务器创建了一个策略文件，如下所示：

```
grant codeBase "file:///C:/Users/Edward/College/CS197/authmatch/bin/-" {
    //Giving the server permission to make connections
    permission java.net.SocketPermission "127.0.0.1:1024-", "connect, resolve";
    permission java.net.SocketPermission "127.0.0.1:1024-", "accept, resolve";
    //File I/O permissions
    permission java.io.FilePermission "C:/Users/Edward/College/CS197/authmatch/-", "read,write,delete";
    permission java.util.PropertyPermission "user.dir", "read";
    permission java.lang.RuntimePermission "readFileDescriptor";
    permission java.lang.RuntimePermission "modifyThread";
}; 
```

（请注意，我的 Eclipse 项目的名称是“authmatch”，它在 Windows 上运行）。在我的 Eclipse 运行配置中，我使用以下 VM 标志启用此策略文件：

```
-Djava.rmi.server.codebase=file:///C:/Users/Edward/Documents/College/CS197/authmatch/bin/
-Djava.security.policy=server.policy 
```

我知道正在解析和加载策略文件，因为如果我在 server.policy 中引入语法错误，Java 会在我的应用程序运行时抱怨它（“错误解析文件”）。但是，安全管理器似乎以某种方式忽略了我在策略中授予的权限，因为当我运行应用程序时出现此错误：

```
Exception in thread "main" java.security.AccessControlException: access denied ("java.io.FilePermission" "smalltest.txt" "read")
    at java.security.AccessControlContext.checkPermission(Unknown Source)
    at java.security.AccessController.checkPermission(Unknown Source)
    at java.lang.SecurityManager.checkPermission(Unknown Source)
    at java.lang.SecurityManager.checkRead(Unknown Source)
    at java.io.RandomAccessFile.<init>(Unknown Source)
    at etremel.authmatch.text.TextFileFormatter.<init>(TextFileFormatter.java:39)
    at etremel.authmatch.source.PatternMatcherSource.main(PatternMatcherSource.java:302) 
```

由于我要求它读取的文件（smalltest.txt）位于“authmatch”项目目录中，并且我明确授予我的应用程序读取该目录的权限

```
permission java.io.FilePermission "C:/Users/Edward/College/CS197/authmatch/-", "read,write,delete"; 
```

为什么它仍然坚持认为它没有文件的读取权限？我怀疑这可能是 Windows 问题，因为我在 Linux 计算机上运行了相同的项目，并且类似的策略文件允许它从本地项目目录中读取就可以了。

**更新**

我运行服务器，`-Djava.security.debug=access,failure`它在解析策略文件时生成了一堆调试消息。[您可以在这个 pastebin](http://pastebin.com/ijjg3FC9)看到整个日志，但似乎有两个重要部分：

```
access: access allowed ("java.security.SecurityPermission" "getPolicy")
access: access allowed ("java.io.FilePermission" "C:\Users\Edward\Documents\College\CS197\authmatch\bin" "read")
access: domain that failed ProtectionDomain  (file:/C:/Users/Edward/Documents/College/CS197/authmatch/bin/ <no signer certificates>)
 sun.misc.Launcher$AppClassLoader@74ba86ef
 <no principals>
 java.security.Permissions@7a8a44a6 (
 ("java.io.FilePermission" "\C:\Users\Edward\Documents\College\CS197\authmatch\bin\-" "read")
 ("java.net.SocketPermission" "localhost:1024-" "listen,resolve")
 ... 
```

...很久以后：

```
access: access allowed ("java.io.FilePermission" "C:\Users\Edward\Documents\College\CS197\authmatch\bin\etremel\authmatch\text\TextFileFormatter.class" "read")
access: access allowed ("java.util.PropertyPermission" "user.dir" "read")
access: access denied ("java.io.FilePermission" "smalltest.txt" "read") 
```

看起来有某种“域保护”失败，因为我的代码库没有签名，但我认为使用`grant codeBase`设置指定没有签名的安全策略是可以接受的。更令人费解的是，它看起来并没有读取根 authmatch 目录的 FilePermission，只是 authmatch/bin 目录。然后它得出结论，它应该拒绝访问“smalltest.txt”，但它永远不会解析该文件的完整目录路径。

请记住，相同的项目和策略在 Linux 上运行良好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T05:52:23.027

问题在于您拼写代码库 URL 的方式和它的拼写方式：`file:/C:/Users/Edward/Documents/College/CS197/authmatch/bin/`. 它们不一样，所以你的`grant`块不适用。查看“失败的域”打印输出的内容：您的 .policy 内容不在其中。

关于签名者证书的内容不是错误，它只是说没有与“失败的域”关联的签名者。

# android - 如何在 Button 或 ImageButton 下方放置文本？

> ID：13128895
> 
> 赞同：1
> 
> 时间：2012-10-29T20:10:53.603
> 
> 标签：android, android-layout, button, imagebutton

我正在使用按钮（或 ImageButtons）来显示我的应用程序的图标。我用它来设置按钮的状态，按下按钮的图像和未按下按钮的图像：

```
selector(this, favorites,  R.drawable.icon_star_mark,  R.drawable.icon_star_mark_selected);

public static void selector(Context c, Button b, int normal_image, int pressed_image){
        StateListDrawable states = new StateListDrawable();
        states.addState(new int[] {android.R.attr.state_pressed}, c.getResources().getDrawable(pressed_image));         
        states.addState(new int[] { }, c.getResources().getDrawable(normal_image));      
        b.setBackgroundDrawable(states);
    } 
```

我需要将文本放在图标下方，但我想在不使用带有图标的 LinearLayout 和其下方的 textview 的情况下学习这样做。如果有可能，我想学习这样做。

这是我创建图标的方式：

```
Button map= new Button(this);
selector(this, map,  R.drawable.icon_map,  R.drawable.icon_map_selected);
map.setText("Map"); 
```

问题是文本显示在图标上方，而不是图标下方。

有可能用java代码实现吗？（将图标的文本放在图标下方，而不使用图标下方带有文本视图的线性布局）

提前致谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-29T20:29:47.463

可以使用 drawableTop 属性。选择器进入 android:background，图标进入 android:drawableTop attr。

```
<Button
        android:id="@+id/btn"
        style="@style/DashboardButton"
        android:drawableTop="@drawable/any_drawable"
        android:text="@string/any_text" /> 
```

或者您可以使用以编程方式设置可绘制对象[`button.setCompoundDrawablesWithIntrinsicBounds(left, top, right, bottom);`](https://developer.android.com/reference/android/widget/TextView.html#setCompoundDrawablesWithIntrinsicBounds%28int,%20int,%20int,%20int%29)

# android - 启动时选择的 Android Spinner 设置项目

> ID：13128898
> 
> 赞同：4
> 
> 时间：2012-10-29T20:11:10.203
> 
> 标签：android, spinner

我的活动中有一个 Spinner，其中包含一个字符串列表，它的声明如下：

```
String[] notificationStatus = new String[statuses.size()];
        for (int i =0; i<statuses.size();i++){
            notificationStatus[i]=statuses.get(i);
        }
        ArrayAdapter<String> aa = new ArrayAdapter<String> (
                this, android.R.layout.simple_spinner_item, notificationStatus );

        aa.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
        spinner.setAdapter(aa);
        spinner.setPrompt(getString(R.string.chooseType));
        spinner.setOnItemSelectedListener(new OnItemSelectedListener() {
            public void onItemSelected(AdapterView<?> parentView, View selectedItemView, int position, long id) {
                posType=position;
            }

            public void onNothingSelected(AdapterView<?> parentView) {
                // your code here
            }

            }); 
```

现在，当我开始这个活动时，我在按钮上得到了 notificationStatus 数组的第一项（微调器的位置 0），有没有办法开始一个活动并将例如数组的第三项放在 2 的位置？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-29T20:38:43.680

Actually i have found out how to do this. First i create a list from the array:

```
List<String> statusCheck = new ArrayList<String>();
        statusCheck = Arrays.asList(notificationStatus); 
```

Next i check where on the list is String i am looking for and put set selection on it:

```
spinner2.setSelection(statusCheck.indexOf(status)); 
```

# validation - 验证与 Yesod 中的表单声明分开

> ID：13128909
> 
> 赞同：3
> 
> 时间：2012-10-29T20:11:37.157
> 
> 标签：validation, yesod

从我从 Yesod 书中看到的，验证发生在表单上。来自 MVC 背景 - 在模型上进行验证 - 这感觉像是关注点的混合。例如，我正在寻找使用 Yesod 构建 JSON API，并且看不到将验证与表单分开使用的明显方法。

Form == HTML 表单是否只是我的一个先入为主的概念，而表单是摄取数据的正确方式，无论来源如何？还有其他我不知道的方法吗？如果有其他方式，这不代表必须对各种数据入口方法进行验证的代码重复吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T19:05:11.803

试着看看这个[消化功能](http://hackage.haskell.org/package/digestive-functors)和这个[消化功能 - aeson](http://hackage.haskell.org/package/digestive-functors-aeson)

# r - 我可以让带有手动 index.html 的预编译 PDF 的 R 小插图显示小插图列表吗？

> ID：13128928
> 
> 赞同：14
> 
> 时间：2012-10-29T20:12:21.883
> 
> 标签：r, r-mosaic

我想在 R 包中包含一个预编译的 PDF 作为小插图。PDF 不是通过 Sweave 生成​​的。如果没有 .Rnw 进行处理，就不会`\VignetteIndexEntry`导致通常自动生成 index.html 和`Meta/vignette.rds`.

我创建了一个 index.html，在安装过程`inst/doc`中复制到其中。`doc`这已从主包帮助页面链接得到更正。但是，当我加载包并执行`browseVignettes("MyPackage")`时，我得到

```
No vignettes found by browseVignettes("MyPackage") 
```

这是有道理的，因为 R 显然无法知道包有小插图。安装的包没有`Meta/vignette.rds`文件。我可以以某种方式让我的 PDF 出现`browseVignettes()`吗？

## `pdfpages`

我熟悉[马赛克包采用的方法](https://github.com/rpruim/mosaic/blob/master/inst/doc/MinimalR.Rnw)，该方法用于`pdfpages`包含整个 PDF。虽然很聪明，但我觉得应该有一种更好的方法来避免文件的扩散。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-29T20:30:38.613

就在怡辉之后……

制作一个看起来像这样的假 Rnw：

```
%\VignetteIndexEntry{User manual}
\documentclass{article}
\begin{document}
\end{document} 
```

把它放在`inst/doc`你预编译的小插图旁边，你就准备好了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-29T20:28:41.417

R 肯定需要一种更好的方法来处理小插曲：[http](http://comments.gmane.org/gmane.comp.lang.r.devel/31967) ://comments.gmane.org/gmane.comp.lang.r.devel/31967在我的提案被批准和实施之前，我们仍然必须忍受黑暗的巫术生成文件。例如，您可以将 a`fake.Rnw`和 a`real.pdf`放在Makefile的`inst/doc`, 和下。`mv real.pdf fake.pdf`在`fake.Rnw`中，您只需遵循 的规则`\VignetteIndexEntry{}`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-11-24T10:06:36.153

该`mosaic`软件包现在[显然使用具有“asis”驱动程序的`R.rsp`软件包](https://github.com/rpruim/mosaic/tree/dd62be476db5f5b46db63c265197a1133f4688ad/vignettes)，该驱动程序允许包含现有文件并创建`VignetteIndexEntry`. 这看起来不像是使用`pdfpages`或虚拟`.Rnw`文件（[在 R 3.1 中似乎不再适用](https://www.marshut.net/ksrwmr/vignette-from-existing-pdf-manual.html)）而更像是黑客攻击。

示例：对于一个文件`V1MinimalR.pdf`，有一个对应的`V1MinimalR.pdf.asis`文件，其内容如下：

```
%\VignetteIndexEntry{Minimal R for Intro Stats}
%\VignetteEngine{R.rsp::asis} 
```

`DESCRIPTION`包含（除其他外）以下内容：

```
Suggests: R.rsp
VignetteBuilder: knitr, R.rsp 
```

[这在R.rsp 包](http://cran.r-project.org/web/packages/R.rsp/index.html)的作者[Henrik Bengtsson 的回答](https://stackoverflow.com/a/24111191/946850)中也有详细说明。

# wcf - 如何在 IIS 托管的 WCF 服务中为所有不是 HTTP 200 的响应返回文本错误消息？

> ID：13128942
> 
> 赞同：1
> 
> 时间：2012-10-29T20:13:17.983
> 
> 标签：wcf

我正在编写一个 WCF 服务，它将通过 HTTP 托管在 IIS 中。我希望所有不是 HTTP 200（例如 404、500）的响应都具有 Content-Type`text/plain`并且响应正文是文本消息。

我怎样才能做到这一点？

# xna-4.0 - 以相机为目的的世界和视图有什么区别？

> ID：13128948
> 
> 赞同：0
> 
> 时间：2012-10-29T20:13:49.010
> 
> 标签：xna-4.0

我是一个初学者，所以我可能在某些基本层面上感到困惑，但我似乎用以下两个 Draw() 例程得到了相同的结果，我想知道有什么区别，一个比另一个更正确吗？

在一个中，我将变换应用于世界矩阵，在另一个中，我将变换应用于 veiw 矩阵。我*认为*结果完全一样，但我不是 100% 确定。

```
 protected override void Draw(GameTime gameTime)
    {
        GraphicsDevice.Clear(Color.CornflowerBlue);

        Matrix worldMatrix =
            Matrix.CreateTranslation(view.Position.X, view.Position.Y, view.Position.Z) *
            Matrix.CreateRotationX(view.Rotation.X) *
            Matrix.CreateRotationY(view.Rotation.Y) *
            Matrix.CreateRotationZ(view.Rotation.Z);

        Matrix viewMatrix = Matrix.CreateLookAt(view.CameraPosition, view.CameraTarget, view.CameraUp);

        Matrix projectionMatrix = Matrix.CreatePerspectiveFieldOfView(view.FieldOfView,
                                                                      GraphicsDevice.Viewport.AspectRatio,
                                                                      view.NearPlane,
                                                                      view.FarPlane);

        DrawModels(worldMatrix, viewMatrix, projectionMatrix);

        base.Draw(gameTime);
    } 
```

这与以下有何不同：

```
 protected override void Draw(GameTime gameTime)
    {
        GraphicsDevice.Clear(Color.CornflowerBlue);

        Matrix worldMatrix = Matrix.Identity;

        Matrix viewMatrix =
            Matrix.CreateTranslation(view.Position.X, view.Position.Y, view.Position.Z) *
            Matrix.CreateRotationX(view.Rotation.X) *
            Matrix.CreateRotationY(view.Rotation.Y) *
            Matrix.CreateRotationZ(view.Rotation.Z) *
            Matrix.CreateLookAt(view.CameraPosition, view.CameraTarget, view.CameraUp);

        Matrix projectionMatrix = Matrix.CreatePerspectiveFieldOfView(view.FieldOfView,
                                                                      GraphicsDevice.Viewport.AspectRatio,
                                                                      view.NearPlane,
                                                                      view.FarPlane);

        DrawModels(worldMatrix, viewMatrix, projectionMatrix);

        base.Draw(gameTime);
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T12:38:26.547

这三个矩阵具有语义含义：

*   首先，**世界**矩阵在世界各地移动模型（每个对象都有一个）
*   然后，**视图**矩阵移动整个世界 - 实际上这与在世界内移动相机相同
*   最后，**Projection**矩阵将变换后的世界顶点投影到屏幕的光栅空间中

这三个矩阵按此顺序相乘。

因此，如果您将`myWorld * myView`结果相乘并将其分配到`view`矩阵中，将 保留为单位矩阵，则结果与您分配到和到并让下一层处理乘法`world`时的结果完全相同。`myWorld``world``myView``view`

虽然结果是相同的 - 通常最好坚持可用的语义含义。它使您的代码更具可读性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T20:39:20.980

矩阵乘法是关联的：(A*B) *C = A* (B*C)，但不可交换：AB != BA 对于每个矩阵。因此，如果 DrawModels 从左到右将矩阵世界、视图和投影相乘，那么这两种方法给出完全相同的结果（+- 舍入误差...）。

这纯粹是一个设计问题，矩阵是如何分解或连接的。例如，预乘 viewMatrix 和 projectionMatrix 是有意义的——IIRC viewMatrix * symmetric_projectionMatrix 只引入了 4 或 5 个额外的乘法来从 3 个欧拉角或四元数相机表示生成 viewMatrix。对通用 4x4 矩阵进行乘法运算需要 64 次乘法...

要考虑的一件事是如何剔除边界框——轴对齐或通用。这可以在世界空间、相机空间或剪辑空间中完成。哪个最有意义应该决定矩阵是如何预乘的。

# objective-c - 创建多向滚动视图的技巧

> ID：13128950
> 
> 赞同：2
> 
> 时间：2012-10-29T20:13:58.253
> 
> 标签：objective-c, ios, ipad, uiscrollview

我正在尝试在 iPad 上创建类似于 SKY TV 指南应用程序的电视指南，以及与 ShowYou iPad 应用程序类似的体验。用户可以水平或垂直滚动​​。水平滚动将显示更多节目，而垂直滚动将允许滚动更多频道。

```
 12am|        1am|          2am| 

channel 1     | example | example2      |
channel 2     | example 3  |
channel 3            | example 4        |
.....
channel 20 
```

希望这张图有点意思。

当用户水平滚动时，时间值也将改变以表示程序的时间。

有没有这种框架的好例子，或者你能给我一些提示，告诉我在哪里可以更好地理解如何实现这一点。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T20:20:19.667

这可能是通过 3 个滚动视图完成的。最左边只能向上/向下滚动。顶部仅向左/顶部滚动，当然主要滚动所有方式。

您需要为监听滚动位置变化的主滚动视图设置一个委托。对于每个事件，更新其他两个滚动视图的滚动位置。

对其他两个滚动视图执行相同的操作。如果左滚动视图滚动，更新主滚动视图以匹配。如果顶部滚动视图滚动，则更新主滚动视图。

# python - 如何在 Python 3 中获取多行行的用户输入？

> ID：13128951
> 
> 赞同：1
> 
> 时间：2012-10-29T20:13:58.250
> 
> 标签：python, input, multiline

我知道常规输入函数可以接受单行，但是一旦您尝试编写字符串段落并按 Enter 键输入下一行，它就会终止。是否有一种适合初学者的方式来接受多行用户字符串输入作为变量？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T20:18:17.670

在程序中执行此操作的一种常见方法是使用“I'm done”字符串（例如，单个句点），并继续按行读取，直到读取的行与该字符串匹配。

```
print("Enter as many lines of text as you want.")
print("When you're done, enter a single period on a line by itself.")

buffer = []
while True:
    print("> ", end="")
    line = input()
    if line == ".":
        break
    buffer.append(line)
multiline_string = "\n".join(buffer)

print("You entered...")
print()
print(multiline_string) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-02-12T22:13:15.227

您可以使用 sys 库来做到这一点

```
import sys
x = sys.stdin.read() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-08-25T03:18:28.277

```
import sys
s = sys.stdin.read()
# print(s) # It will print everything 
for line in s.splitlines(): # to read line by line
    print(line) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-12-14T06:13:41.480

```
[input() for i in range(int(input()))] 
```

对于 n 个多行用户输入，列表中的每个索引都是来自用户的新行输入。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-10-19T17:47:06.110

```
def processString(x):
    print(x.replace('process','whatever'))

lines = ""
while True:
    if lines == "":
        lines = ""
        print("Enter string:")
    x = input()
    if x == "" and lines != "":
        processString(lines)
        break
    else:
        lines += x

# then hit enter once after multi-line string to process it 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2017-06-20T10:40:05.970

```
Line=""

while True:

    x=input()

    Line=Line+" "+x

    if "." in x:

        break

print(Line) 
```

# delphi - 从Delphi中的浮点数获 取小数点分隔符后的值

> ID：13128953
> 
> 赞同：6
> 
> 时间：2012-10-29T20:14:16.063
> 
> 标签：delphi, formatting

如何获取给定浮点数的小数分隔符后的值？

```
Number: 129.60
Expected result: 60 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-29T20:36:21.950

只需使用该`Frac`功能。

例如，`Frac(3.14)`等于`0.14`。当然，一旦你去掉了数字的整数部分，你就可以使用任何你选择的方法来制作一个字符串，比如`FloatToStr`, `FormatFloat`,`Format`等等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-05-15T14:22:43.480

```
var
  abobrinha, Expected : real;
begin
  abobrinha := 129.60;
  Expected := abobrinha - trunc(abobrinha);
end; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T22:54:26.427

如果您在 a 中有您的号码`string`，并且也希望在 a 中有结果，`string`那么您可以在不转换为数字的情况下做到这一点。如果没有，请参阅 Andreas 的回答。

```
i := Pos( DecimalSeparator, value );
if i > 0 then
  result := Copy( value, i + 1, Length( value ) - i )
else
  result := ''; 
```

# regex - Sed 使用扩展的正则表达式和捕获组

> ID：13128955
> 
> 赞同：13
> 
> 时间：2012-10-29T20:14:24.770
> 
> 标签：regex, sed

我写了下面的 sed 一行来替换 IP 地址的第三部分。

```
sed 's/192\.168\.[0-9]*\.\([0-9]*\)/192.168.15.\1/g'

192.168.0.1
192.168.15.1 
```

我想让它变得懒惰，因此它将替换`192.168.0`为`192.168.15`使用`??`扩展的正则表达式，但是当我提供“-r”选项时，我收到以下错误。

```
$ sed -r 's/192\.168\.[0-9]*\.\([0-9]*\)/192.168.15.\1/g'
sed: -e expression #1, char 44: invalid reference \1 on `s' command's RHS 
```

你能解释一下这里发生了什么以及如何在使用捕获组时使表达式变得懒惰吗？

*注意：我可以使用许多不同的方法来实现示例，我的问题不是如何解决示例。我对将 sed 与扩展的正则表达式和捕获组一起使用很感兴趣。*

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-29T20:19:55.733

无需转义大括号，因为`([0-9]*)`是匹配符号组的有效语句。

```
$> echo "192.168.0.1" | sed -r 's/192\.168\.[0-9]*\.([0-9]*)/192\.168\.15\.\1/g'
192.168.15.1 
```

# vector - Clojure：遍历向量向量以找到满足特定条件的第一个向量

> ID：13128957
> 
> 赞同：5
> 
> 时间：2012-10-29T20:14:32.927
> 
> 标签：vector, clojure, iteration, tic-tac-toe

为了学习 Clojure，我正在开发一个小井字游戏。在相对轻松地完成游戏的第一部分后，我一直在努力尝试构建一个智能电脑播放器。

对于我正在编写以帮助指导这一点的测试，如果轮到计算机，我想检查计算机是否选择了点 9，这是板：

X | ○ | 3
4 | X | 7
| 8 | 9

开始游戏时，将棋盘定义为这样的地图，其键值对表示棋盘上的位置和该空间的内容：

```
(def board {1 "1" 2 "2" 3 "3" 4 "4" 5 "5" 6 "6" 7 "7" 8 "8" 9 "9"}) 
```

我对如何解决这个问题有一些想法。一种是这样定义获胜集：

```
(def winning-sets
    [[(board 1) (board 2) (board 3)],
     [(board 4) (board 5) (board 6)],
     [(board 7) (board 8) (board 9)],
     [(board 1) (board 4) (board 7)],
     [(board 2) (board 5) (board 8)],
     [(board 3) (board 6) (board 9)],
     [(board 1) (board 5) (board 9)],
     [(board 3) (board 5) (board 7)]]) 
```

遍历每个集合：

```
(for [set winning-sets]
    (filter #(= symbol %) set)) 
```

但这似乎不对……我不知道从那里去哪里。我试图解决的问题可以这样描述：

**告诉计算机查看 8 个获胜组，并找到一组有两个符号*和*一个空位。**

我对 Clojure 还很陌生，所以我不确定我是否理解解决这个问题的最佳方法。我一直在查看[ClojureDocs](http://clojuredocs.org)（检查迭代函数，如`for`and`loop`和`case`），但无法完成这项工作。

迭代这些获胜集的最佳方法是什么，目前是矢量形式，并找到具有两个特定符号和一个开口的集合？还是最好将获胜集存储在不同的数据结构中？

*注意：我已阅读[对此问题](https://stackoverflow.com/questions/8340477/how-do-i-iterate-over-a-vector-of-vectors-in-clojure?rq=1)的回复，但无法将它们应用于我的。*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-29T21:34:25.170

首先，我建议您将这种结构用于董事会职位：

```
(def board [[1 1 0] 
            [0 0 0] 
            [1 0 1]]) 
```

其中 X 是`1`，O 是`-1`，空单元格是`0`。在我的示例中，板只有 X 符号（为了简化）。下一个，

```
(def winning-sets
  '([[0 0] [0 1] [0 2]] 
    [[1 0] [1 1] [1 2]] 
    [[2 0] [2 1] [2 2]]
    [[0 0] [1 0] [2 0]] 
    [[0 1] [1 1] [2 1]] 
    [[0 2] [1 2] [2 2]]
    [[0 0] [1 1] [2 2]]
    [[0 2] [1 1] [2 0]])) 
```

这是“获胜”的坐标集。如有必要，您可以计算此值，但对于 3x3，此列表实际上并没有那么大。在这个方面，你的问题的答案是

```
(defn check 
  [target combo] 
  (= (map #(count (filter (partial = %) combo)) [target 0]) '(2 1)))

(defn extract 
  [coords] 
  (apply vector (map (fn [[f s]] ((board f) s)) coords))) 

(filter #(check 1 (extract %)) winning-sets) 
```

如果你在 REPL 中执行这段代码，你会看到

```
user=> (filter #(check 1 (extract %)) winning-sets)
([[0 0] [0 1] [0 2]] 
 [[2 0] [2 1] [2 2]] 
 [[0 0] [1 0] [2 0]] 
 [[0 0] [1 1] [2 2]]) 
```

看起来像正确答案（2条水平线，1条垂直线和1条对角线）。代码很粗糙，没有什么方法可以使它更美观和可重用。我应该解释发生了什么还是代码足够清晰？

# javascript - JsTree 打开第一个孩子

> ID：13128960
> 
> 赞同：-1
> 
> 时间：2012-10-29T20:14:58.140
> 
> 标签：javascript, jquery, html, dom, jstree

我正在使用 JStree 插件来创建一棵树，我的问题是是否有任何选项或方法可以显示列表的第一个子项。

例如，我有一个有 5 个孩子的列表，有些孩子有其他孩子，在我的情况下，我只想显示每个孩子的第一个孩子

*   .

    有我的代码

    html列表

    ```
    <ul id="tree"> 
    ```

    *   项目 1*   第 2 项*   文件夹 1
    *   子项 1.1
    *   子项 1.2
    *   子文件夹
        *   测试
        *   子文件夹
            *   第三个孩子
            *   第三个孩子
            *   第三个孩子*   第 3 项*   文件夹 2
    *   子项目 2.1
    *   文件夹 2.1
        *   子项 2.1.1
        *   子项 2.1.2*   第 4 项

这里是我的 js

```
 $(function() {
        $("#tree").treeview({
            collapsed: true,
            animated: "medium",
            control:"#sidetreecontrol",
            persist: "location"
        });
    }) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T02:12:54.013

实际上在这个插件中你不能这样做，我使用 css 修复了它：

```
ul li ul {display:block} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-03T17:05:36.870

我需要这样做，所以我在每个 li 中放置了一个 Id 并在使用此代码后：

```
$("#my-tree-view").jstree("open_node", $("#id-first-li")); 
```

# vim - 如何在 Vim 中启用 CUDA .cu 和 .cuh 文件的语法高亮显示？

> ID：13128961
> 
> 赞同：14
> 
> 时间：2012-10-29T20:14:58.870
> 
> 标签：vim, cuda, syntax-highlighting, vim-syntax-highlighting

我发现我的`~/.vimrc`文件有`syntax on`，但它不适用于任何 CUDA 文件（`.cu`）。

不知道该怎么做。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-10-29T20:23:43.680

将这两行添加到 ~/.vimrc：

```
au BufNewFile,BufRead *.cu set ft=cuda
au BufNewFile,BufRead *.cuh set ft=cuda 
```

并将[cuda.vim](http://ftp.vim.org/vim/runtime/syntax/cuda.vim)放入 ~/.vim/syntax/

玩得开心！

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-10-29T20:25:29.887

听起来您可能缺少 vim 的语法高亮文件。您应该检查您的`/usr/share/vim/vim70/syntax`目录中的`cuda.vim`. 该目录将根据您的系统和 vim 版本而有所不同。

如果你的 vim 版本没有附带`cuda.vim`，你可以下载这个[cuda.vim](http://ftp.vim.org/vim/runtime/syntax/cuda.vim)文件并将它放在 ~/.vim/syntax/ 中。

**更新：**`~/.vimrc`在您推荐的@BenjiWiebe中添加以下行：

```
au BufNewFile,BufRead *.cu set filetype=cuda
au BufNewFile,BufRead *.cuh set filetype=cuda 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-29T20:22:30.480

怎么样[，](http://lifeofaprogrammergeek.blogspot.fr/2008/07/using-vim-for-cuda.html)这行得通吗？

```
cd /usr/share/vim/vim*/syntax
sudo cp cpp.vim cu.vim
echo "au BufNewFile,BufRead *.cu set ft=cu" >> ~/.vimrc 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-05-24T13:54:48.730

自从最初提出这个问题以来已经很久了，但是我发现自己遇到了几乎相同的问题，并且无法通过遵循以前的答案来解决它。

就我而言，vim 会自动突出显示 .cu 文件（我使用的是 vim 80，它已经在 /usr/share/vim/vim80/syntax/ 中有 cuda.vim），但忽略 .cuh 文件。为了解决这个问题，我编辑了 /usr/share/vim/vim80/filetype.vim 并添加了

```
au BufNewFile,BufRead *.cuh         setf cuda 
```

就是这样！

# android - 如何获取 Tabhost 中所有现有选项卡的列表？

> ID：13128965
> 
> 赞同：2
> 
> 时间：2012-10-29T20:15:49.387
> 
> 标签：android, android-tabhost

我想知道如何获取 Tabhost 中所有现有选项卡的列表，以将它们的指标存储到列表中，当调用 onDestroy() 时，该列表将保存到 SharedPreferences（json 字符串格式）。

我问是因为我正在开发一个基于选项卡的内置多聊天应用程序，即使用户按下“返回”按钮，我也想保留打开的聊天列表......

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T21:13:52.680

> I would like to know how to get list of all existing tabs within Tabhost to store their indicators to the List which will be saved to the SharedPreferences (json string format) when onDestroy() will be called.

When you call `addTab()` to add the tab to the `TabHost`, also keep track of your desired information yourself.

# couchdb - CouchDB 更新处理程序不会正确添加

> ID：13128966
> 
> 赞同：0
> 
> 时间：2012-10-29T20:15:53.167
> 
> 标签：couchdb, handler

首先，我已经阅读了[CouchDB 文档更新处理程序（就地更新）](https://stackoverflow.com/questions/2972068/couchdb-document-update-handlers-in-place-updates)并在该问题的答案中采用了代码。

我有一个更新处理程序，它接受一个查询字符串数量，并且应该将它添加到给定文档的 doc.count 中。它没有添加这两个数量，而是仅列出它们。EG 5+5=55。还将 parseInt() 添加到 doc.count 会产生错误消息：

```
{"error":"render_error","reason":"undefined response from update function"} 
```

我的更新处理程序是：

"countPlus": "function(doc, req) {var amount1 = doc.count; var amount2 = parseInt(req.query.amount); doc.count = amount1 + amount2; return [doc, doc.count]; }"

处理请求的js是：

```
if (count != null && count != NaN && count != 0) {
    var currentCounter = $.ajax({
    type: "POST",
    async: false,
    url: $(location).attr("href").replace("_show/action", "_update/countPlus") + "?amount=" + count,
    contentType : "application/json",         
    dataType: "json"
          });
var currentCountResponse = currentCounter.responseText;
        alert(currentCountResponse); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T18:34:11.520

您的回复似乎是一个整数。也许你应该尝试“字符串化”它。

# package - 如何打包没有makefile的程序？

> ID：13128969
> 
> 赞同：0
> 
> 时间：2012-10-29T20:16:16.693
> 
> 标签：package, deb

我正在为一个根本没有可用的 makefile 的软件创建一个 Debian 包。我应该将构建说明放入`debian/rules`还是单独的 Makefile 中？我倾向于后者。

如果我确实创建了一个单独的 Makefile，我如何正确地将它包含在我的源包中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T20:20:36.493

如果有任何实际的*构建*命令（而不是简单的安装）要做，我的直觉是将缺少 makefile 基础设施视为上游发行版中的一个错误，并通过在 Debian diff 中提供一个 makefile 来修补它，就像我要修复的那样任何其他上游错误。请务必在上游提供您的修复。

但是，如果只是`cp`在构建软件包时运行多个命令将软件的各个部分放入文件系统中的正确位置，那么我只需将它们放入`debian/rules`.

# delphi - 动态包链接——在动态包中使用程序单元

> ID：13128975
> 
> 赞同：0
> 
> 时间：2012-10-29T20:16:38.827
> 
> 标签：delphi, package, delphi-xe

我写了一个小组件，它在运行时动态加载一个包。

因此，我的主要项目（`exe`）和一些包（`bpl`）有一些小组项目。现在我想在所有这些中使用我的`exe`（`Datamod.pas`）中的单位。

`uses`因此，在我添加的包的某个单元列表中`Datamod`，我想在运行时访问该数据模块。一切都编译好了，瞧。

但

当我调试代码时 - `Datamod`bpl 中的类实例不是零，但它给了我一个 AV，因为我正在访问它。我错过了什么？我应该导出`Datamod.pas`到其他包并让其他包使用该包吗？为什么它给我一个AV？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T21:39:38.677

不，您不能从动态包中访问您的程序单元。

将 datamod.pas 移动到另一个包，然后将其链接到您的程序和其他包中。它将是可访问的，并且不会导致 AV。

# objective-c - 将多级xml解析为.plist Object-c

> ID：13128990
> 
> 赞同：0
> 
> 时间：2012-10-29T20:17:46.453
> 
> 标签：objective-c, xml, parsing, nsdictionary, multi-level

你能帮我将多级 xml 解析为 .plist、xml 文件吗：

```
 <item type="text">
    <id>
      783026
    </id>
    <rating>
     45
    </rating>
    <title>
      <![CDATA[Российские реалии)]]>
    </title>
 </item>
  <item type="image">
    <id>
      783034
    </id>
    <rating>
      47
    </rating>
    <title>
      <![CDATA[скраб...]]>
    </title>
  </item> 
```

如何将此 xml 解析为 .plist，并填充 UITableView？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T03:35:20.580

iOS 提供了[`NSXMLParser class`](http://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/NSXMLParser_Class/Reference/Reference.html)用于解析 XML。您可以使用 XML 解析器创建项目数组，并设置表视图数据源以使用该数组。

# coldfusion - 重新加载页面重新启动过期会话

> ID：13128991
> 
> 赞同：1
> 
> 时间：2012-10-29T20:17:50.380
> 
> 标签：coldfusion, coldfusion-8, cflogin

我创建了一个 ColdFusion 登录页面和 Application.cfc 文件。它似乎工作正常，但我发现了一个似乎无法修复的错误或漏洞。

它是一个三页表单：登录页面；带有日期选择和其他问题的查找页面；和一个输出页面。用户登录并通过身份验证。如果会话在查找页面上过期，则当用户尝试提交查询时将被路由回登录页面。但是，如果会话过期，他们可以通过刷新查找页面来绕过登录页面。

我怎样才能防止这种情况？我的代码有什么问题？我希望对该查找页面的任何刷新也将它们定向到登录页面。

```
<cfcomponent>
    <cfset This.name = "TEST_login">
    <cfset This.Sessionmanagement="True">
    <cfset This.loginstorage="session">
    <cfset This.sessionTimeout= CreateTimespan(0,0,1,0) />

    <cferror TYPE="exception" TEMPLATE="error.cfm" MAILTO="email address">

    <cffunction name="onSessionStart">
        <cfset session.loggedIn = false>
    </cffunction>

    <cffunction name="OnRequestStart">
        <cfargument name = "request" required="true"/>

        <cfif IsDefined("Form.logout")>
            <cflogout>
        </cfif>

        <cflogin idletimeout="1200">

            <cfif NOT IsDefined("cflogin")>
                <cfinclude template="acc_hgrant_login.cfm">
                <cfabort>
            <cfelse>
                <cfif cflogin.name IS "" OR cflogin.password IS "">
                    <cfinclude template="acc_hgrant_login2.cfm">
                    <cfabort>
                <cfelse>

                    <cfquery name="loginQuery" dataSource="cfsource">
                        SELECT username, role
                        FROM users
                        WHERE
                            username = '#cflogin.name#'
                            AND password = '#cflogin.password#'
                    </cfquery>

                    <cfif loginQuery.role EQ "admin">
                        <cfloginuser name="#cflogin.name#" Password = "#cflogin.password#"
                            roles="#loginQuery.role#">

                        <cfset Session.isLoggedIn = "Yes">

                    <cfelse>

                        <cfinclude template="login3.cfm">
                        <cfabort>
                    </cfif>

                </cfif>

            </cfif>

        </cflogin>
    </cffunction>

</cfcomponent> 
```

在我添加的每个后续页面上

```
 <cfif not isDefined("Session.isLoggedIn")> 
```

在每一页的顶部。

但是，同样，只要在一段时间后重新加载第二页就会重新启动会话，即使它过期也是如此。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T08:36:48.327

根据您的描述并且无法看到加载页面的代码，我只能猜测问题所在。

我相信这个问题的更全面的表现是：

> 但是，如果会话过期，他们可以通过刷新查找页面**并回答“你想重新提交表单”**来绕过登录页面。

解决这个问题的方法是在验证他们的凭据并设置他们的会话后重定向页面。一个简单的版本是：

```
 <cfif loginQuery.role EQ "admin">
                    <cfloginuser name="#cflogin.name#" Password = "#cflogin.password#"
                        roles="#loginQuery.role#">

                    <cfset Session.isLoggedIn = "Yes">

                    <cflocation url="#CGI.SCRIPT_NAME#?#CGI.Query_STRING#" addtoken="false">

                <cfelse> 
```

应该是您希望`cflocation`在处理每个表单提交结束时执行 a 的情况。最常见的反例是当要求用户更正他们的表单的验证问题时，因为重新发布表单只会重新加载验证页面；不更新数据库等

# android - 带有 viewPager 的 ListFragment

> ID：13128992
> 
> 赞同：2
> 
> 时间：2012-10-29T20:17:57.130
> 
> 标签：android

我正在尝试使用 ActionBar/Viewpager 为片段提供选项卡支持。但是，与每个相关的片段，我希望它是一个 ListFragment。这是我从有效导航示例中获得的相关代码示例

```
public class MainActivity extends FragmentActivity implements ActionBar.TabListener {

[..]

public static class AppSectionsPagerAdapter extends FragmentPagerAdapter {

        public AppSectionsPagerAdapter(FragmentManager fm) {
            super(fm);
        }

        @Override
        public Fragment getItem(int i) {
            switch (i) {

                case 0:
                    Fragment fragment0 = new DummySectionFragment();
                    Bundle args0 = new Bundle();
                    args0.putString(DummySectionFragment.TAB_NAME, "Public");
                    fragment0.setArguments(args0);
                    ((ListFragment)fragment0).setEmptyText("EMPTY");
                    return fragment0; 
```

[..]

```
 public static class DummySectionFragment extends ListFragment {

        public static final String TAB_NAME = "tab_name"; 
```

[..] 问题是， FragmentPagerAdapter.getItem 期待一个片段。当我试图访问 ListFragment 的方法时，它崩溃了。请指教。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-21T07:56:39.553

改变

```
((ListFragment)fragment0).setEmptyText("EMPTY"); 
```

至

```
 ((DummySectionFragment)fragment0).setEmptyText("EMPTY"); 
```

错误代码表示你尝试访问子类方法使用超类实例，可能是子类有方法，但超类没有方法，这是我自己的想法

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-07T13:44:43.720

昨天我和一位同事讨论了类似的事情，他说不要使用 viewpagers 作为列表视图的项目，因为它完全是混乱的，即使你不回收视图列表也会在滚动和类似的东西上冻结。他如何解决这个问题是在滚动视图中创建单独的浏览器，也许你可以考虑一下。

# c - BST 的 BFS 遍历中的 seg 错误

> ID：13128994
> 
> 赞同：0
> 
> 时间：2012-10-29T20:17:59.653
> 
> 标签：c, tree, binary-tree, breadth-first-search, tree-traversal

我已经实现了一个二叉树及其 BFS 遍历。程序如下：

```
struct elemq{
    int ele;
    struct elemq *left;
    struct elemq *right;
};

struct que{
    struct elemq *ss;
    struct que *next;
}; 

void qinsert(struct elemq *ptr){
    struct que *node;
    node = (struct que *)malloc(sizeof(struct que));
    if(front == NULL && rear == NULL){
            node->ss = ptr;
            node->next = NULL;
            front = node;
            rear = node;
    }
    else{
            node->ss = ptr;
            node->next = NULL;
            rear->next = node;
            rear = node;
    }
}

struct elemq *qdelete(){
    if(front == NULL && rear == NULL){
            cout << "No elements to delete\n";
            exit(0);
    }
    struct elemq *dd = front->ss;
    struct que *ddd = front;
    front = front->next;
    free(ddd);
return dd;
}

int isempty(){
    if(front == NULL && rear == NULL){
            return 1;
    }
    else{
            return 0;
    }
}

void bfs(){
    qinsert(root);
    struct elemq *fff;
    while(!isempty()){
            fff = qdelete();
            cout << fff->ele  << "\n";
            if(fff->left != NULL){
                    qinsert(fff->left);
            }
            if(fff->right != NULL){
                    qinsert(fff->right);
            }
    }
} 
```

虽然代码很长，但是很容易理解。elemq 结构是树中节点的结构。que 是我用来实现 bfs 的队列。q insert 是将元素插入队列，qdelete 删除队列中的元素。isempty() 用于检查队列是否为空。程序显示根元素，然后给出分段错误。请帮忙。挣扎了一段时间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T21:00:29.467

如果队列中只有一个元素，该`qdelete`函数将无法正常工作：

```
struct elemq *qdelete(){
    if(front == NULL && rear == NULL){
            cout << "No elements to delete\n";
            exit(0);
    }
    struct elemq *dd = front->ss;
    struct que *ddd = front;
    front = front->next;
    free(ddd);
return dd;
} 
```

在这种情况下`front`设置为`NULL`，但`rear`仍指向 now `free`d 内存。

添加一个

```
if (front == rear) {
    struct elemq *dd = front->ss;
    free(front);
    front = rear = NULL;
} else {
   // what you have
} 
```

要解决这个问题。

# python - ctypes卸载dll

> ID：13128995
> 
> 赞同：18
> 
> 时间：2012-10-29T20:18:08.663
> 
> 标签：python, ctypes

我正在加载一个带有 ctypes 的 dll，如下所示：

```
lib = cdll.LoadLibrary("someDll.dll"); 
```

完成库后，我需要将其卸载以释放它使用的资源。我在文档中查找有关如何执行此操作的任何内容时遇到问题。我看到这篇相当老的帖子：[如何在 Python 中使用 ctypes 卸载 DLL？](https://stackoverflow.com/questions/359498/how-can-i-unload-a-dll-using-ctypes-in-python). 我希望有一些我没有发现的明显的东西，而不是黑客攻击。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-10-29T20:31:21.017

我发现的唯一真正有效的方法是负责调用`LoadLibrary`和`FreeLibrary`。像这样：

```
import ctypes

# get the module handle and create a ctypes library object
libHandle = ctypes.windll.kernel32.LoadLibraryA('mydll.dll')
lib = ctypes.WinDLL(None, handle=libHandle)

# do stuff with lib in the usual way
lib.Foo(42, 666)

# clean up by removing reference to the ctypes library object
del lib

# unload the DLL
ctypes.windll.kernel32.FreeLibrary(libHandle) 
```

*更新：*

从 Python 3.8 开始，`ctypes.WinDLL()`不再接受`None`表示没有传递文件名。相反，您可以通过传递一个空字符串来解决此问题。

见[https://bugs.python.org/issue39243](https://bugs.python.org/issue39243)

# javascript - 在主干模板中使用 _.each

> ID：13128998
> 
> 赞同：1
> 
> 时间：2012-10-29T20:18:22.167
> 
> 标签：javascript, templates, backbone.js

我正在尝试在模板中使用主干 foreach 语句，它在下面给了我一个错误。

**SyntaxError: missing ) 在参数列表之后**

我正在尝试将这样的对象传递给它...

```
var multiSortDiv = _.template($('#multiSortContainerTemp').html(), { "cols": aoCols }); 
```

这是我的模板：

```
<script type="text/template" id="multiSortContainerTemp">
<div id="multiSortContainer">
    <br>
    <p style="font-weight:bold;width:400px;color:Blue">Multi-Sort - Check columns to Sort By</p>
    <br>
     <% _.each(%><%= cols %><%, function(val, i) { %>
       <label style="font-weight:bold;margin-left:7px"><%= val.sTitle %></label>
       <input id="multiSort_" + <%= i %> type="checkbox" style="margin-left:2px" />
     <%}) %>
</div>
</script> 
```

有谁知道我在模板中做错了什么？？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T22:00:39.183

你可以在这个地方简化你的模板：`<% _.each(cols, function(val, i) { %>`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T20:35:02.447

这是正确的模板：

```
<div id="multiSortContainer">
   <br>
   <p style="font-weight:bold;width:400px;color:Blue">Multi-Sort - Check columns to Sort By</p>
   <br>
    <% _.each(<%= cols %>, function(val, i) { %>
       <label style="font-weight:bold;margin-left:7px"><%= cols[i].sTitle %></label>
       <input id="multiSort_<%= i %>" type="checkbox" style="margin-left:2px" />
    <%}); %>
</div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-10-28T03:29:21.870

好的，我修好了。这是正确的模板代码：

```
<div id="multiSortContainer"> 
  <p style="font-weight:bold;width:400px;color:Blue">Multi-Sort - Check columns to Sort By</p>
  <% _.each(<%= cols %>, function(val, i) { %> 
    <label style="font-weight:bold;margin-left:7px">
    <%= cols[i].sTitle %></label> 
    <input id="multiSort_<%= i %>" type="checkbox" style="margin-left:2px" />
  <%}); %> 
</div> 
```