# StackOverflow 问答 13144000-13144999

# jquery - 上传到服务器时，Jquery 和 JSON twitter 提要不起作用

> ID：13144000
> 
> 赞同：1
> 
> 时间：2012-10-30T16:55:46.833
> 
> 标签：jquery, json, twitter

我正在尝试使用 CSS Tricks 方法让 twitter 提要工作：

[http://css-tricks.com/build-your-own-social-home/](http://css-tricks.com/build-your-own-social-home/)

有一些改动。在 Dreamweaver 上的实时预览中一切正常，但是当它上传到服务器时，什么都没有出现。我已经对其他问题进行了一些搜索，但无法提出与我的问题直接相关的任何内容

查询：

```
$(document).ready(function(){
$.getJSON('https://api.twitter.com/1/statuses/user_timeline.json?callback=?include_entities=true&user_id=913166730&count=5', function(data){
    $.each(data, function(index, item){
        $('#news').append('<div class="story"><h3 style="margin:0px;"><a style="color:#000; text-decoration:none;" href="http://twitter.com/TheHopperLane" title="The Hopper Lane">@Thehopperlane</a></h3><p>' + item.text.linkify() + '</p><p style="font-size:12px;">' + relative_time(item.created_at) + '</p></div>');
    });

});
function relative_time(time_value) {
    var values = time_value.split(" ");
    time_value = values[1] + " " + values[2] + ", " + values[5] + " " + values[3];
    var parsed_date = Date.parse(time_value);
    var relative_to = (arguments.length > 1) ? arguments[1] : new Date();
    var delta = parseInt((relative_to.getTime() - parsed_date) / 1000);
    delta = delta + (relative_to.getTimezoneOffset() * 60);

    var r = '';
    if (delta < 60) {
        r = 'a minute ago';
    } else if(delta < 120) {
        r = 'couple of minutes ago';
    } else if(delta < (45*60)) {
        r = (parseInt(delta / 60)).toString() + ' minutes ago';
    } else if(delta < (90*60)) {
        r = 'an hour ago';
    } else if(delta < (24*60*60)) {
        r = '' + (parseInt(delta / 3600)).toString() + ' hours ago';
    } else if(delta < (48*60*60)) {
        r = '1 day ago';
    } else {
        r = (parseInt(delta / 86400)).toString() + ' days ago';
    }
    return r;
}
String.prototype.linkify = function() {
    return this.replace(/[A-Za-z]+:\/\/[A-Za-z0-9-_]+\.[A-Za-z0-9-_:%&\?\/.=]+/, function(m) {
        return m.link(m);
    }).replace(/\B#([_a-z0-9]+)/ig, function(hashtag) {
        return '<a href="http://twitter.com/search?q=%23'+hashtag.substring(1)+'">'+hashtag+'</a>';
    }).replace(/\B@([_a-z0-9]+)/ig, function(screenname) {
        return '<a href="http://twitter.com/'+screenname+'">'+screenname+'</a>';
    });
};
}); 
```

HTML

```
<div id="news">
<h2>Latest News</h2> 
```

任何建议将不胜感激，如有必要，我可以提供相关网站的链接

编辑：似乎一切都归结为以下错误！

```
"XMLHttpRequest cannot load https://api.twitter.com/1/statuses/user_timeline.json?callback=?include_entities=true&user_id=913166730&count=5\. Origin http://thehopperlane.co.uk is not allowed by Access-Control-Allow-Origin." 
```

我不敢相信我没有早点抓住这个！但是，我没有解决这个问题，因为据我所知，该网站尚未解决。人们提到包括回调=？并使用 JSONP 而不仅仅是 JSON，但是这些修复似乎不再起作用（请注意[此处对答案的最后评论](https://stackoverflow.com/questions/3996438/twitter-search-api-with-jquery-error "堆栈溢出")

# api - 如何为 API 客户端提供 1,000,000 个数据库结果？

> ID：13144005
> 
> 赞同：15
> 
> 时间：2012-10-30T16:56:12.180
> 
> 标签：api, postgresql, pagination, distributed-computing

跟进我之前的问题：

[在 PostgreSQL 中使用“游标”进行分页](https://stackoverflow.com/questions/13142834/using-cursors-for-paging-in-postgresql/13149184#13149184)

为 API 客户端提供 1,000,000 个数据库结果的好方法是什么？

我们目前正在使用 PostgreSQL。一些建议的方法：

*   [使用游标](http://www.postgresql.org/docs/9.2/static/plpgsql-cursors.html)进行分页
*   使用随机数进行分页（在每个查询中添加“GREATER THAN ORDER BY”）
*   使用 LIMIT 和 OFFSET 进行分页（对非常大的数据集进行分解）
*   将信息保存到文件并让客户端下载
*   遍历结果，然后将数据 POST 到客户端服务器
*   仅将密钥返回给客户端，然后让客户端从 Amazon S3 等云文件中请求对象（仍然可能需要分页来获取文件名）。

我没有想到这比这些选项中的任何一个都简单得​​多并且更好吗？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-10-30T23:57:18.523

该表有一个主键。好好利用它。

代替`LIMIT`and `OFFSET`，使用主键上的过滤器进行分页。您在评论中暗示了这一点：

> 使用随机数进行分页（在每个查询中添加“GREATER THAN ORDER BY”）

但是你应该怎么做并不是随机的。

```
SELECT * FROM big_table WHERE id > $1 ORDER BY id ASC LIMIT $2 
```

允许客户端指定两个参数，它看到的最后一个 ID 和要获取的记录数。您的 API 必须有一个占位符、额外参数或替代调用“获取*前*n 个 ID”，其中省略了`WHERE`查询中的子句，但这很简单。

这种方法将使用相当有效的索引扫描来按顺序获取记录，通常避免排序或遍历所有跳过的记录的需要。客户端可以决定一次需要多少行。

这种方法在一个关键方面与`LIMIT`and方法不同`OFFSET`：并发修改。如果您使用*低于*某些客户已经看到的键`INSERT`的键进入表，这种方法根本不会改变其结果，而该方法将重复一行。同样，如果您的行 ID 低于已见过的 ID，则此方法的结果不会改变，而会跳过未见过的行。不过，生成键的仅追加表没有区别。*`OFFSET``DELETE``OFFSET`*

 *如果您事先知道客户端将需要整个结果集，那么最有效的做法就是将整个结果集发送给他们，而无需进行任何分页业务。那就是我*会*使用光标的地方。从数据库中读取行，并以客户端接受它们的速度将它们发送给客户端。此 API 需要设置客户端允许的速度限制，以避免过多的后端负载；对于慢速客户端，我可能会切换到分页（如上所述）或将整个游标结果假脱机到一个临时文件并关闭数据库连接。

**重要警告**：

*   需要`UNIQUE`约束/`UNIQUE`索引或`PRIMARY KEY`可靠
*   限制/偏移的不同并发修改行为，见上文

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T17:12:53.490

让 API 接受开始的偏移量和要返回的记录数。这是一种分页，客户端可以确定在一个页面请求中返回多少条记录。API 还应该返回查询可能的记录总数，以便客户端知道有多少“页面”，或者当返回的记录数为零或小于要求的记录。您可以通过在 SELECT 语句中使用 OFFSET 子句（从哪个记录开始检索）和 LIMIT 子句（要返回的记录数）在 PostgresSQL 查询中控制这一点。*

# c# - 对两个列表进行相同排序

> ID：13144006
> 
> 赞同：0
> 
> 时间：2012-10-30T16:56:20.393
> 
> 标签：c#, list, sorting, tuples

我有一个字符串列表和一个整数列表。它们以“对”的形式出现，即在索引处，给定的字符串和整数必须仍然“匹配”。我需要按降序对整数进行排序并使字符串排序相同，因此这些对是完整的。我想实现的最佳方法可能是将它们放入 List>，但我不确定如何按第二个 Tuple 项对其进行排序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T17:00:09.917

最简单的方法是将它们放入单个`List`，然后对该列表进行排序：

```
List<string> list = new List<string>() { "A", "C", "T", "F" };
List<int> list2 = new List<int>() { 5, 4, 3, 2 };

var results = list.Zip(list2, (a, b) => new
{
    str = a,
    num = b
})
.OrderBy(pair=> pair.num); 
```

如果您真的需要一个仅包含字符串的列表，您可以使用 a`Select`将它们取出，但希望在整个程序中拥有一个更复杂对象的单个列表是有意义的。（如果您这样做，请考虑创建一个实际的课程，而不是使用匿名课程。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T16:59:23.623

.NET 有一个 SortedDictionary 数据类型。

[http://msdn.microsoft.com/en-us/library/f7fta44c%28v=vs.90%29.aspx](http://msdn.microsoft.com/en-us/library/f7fta44c%28v=vs.90%29.aspx)

我会把它们加载进去，你应该很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T16:59:50.073

如果你有一个元组列表，你可以像这样订购它们

```
myList.OrderBy(x => x.Item2); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-30T17:00:13.427

我会创建一个带有字符串和整数属性的小型“对”类。您可以实现 IComparable() 以确保此类通过 Integer 属性进行比较。然后，您可以将它们填充到通用 List:`var pairs = new List<Pair>()`对象中，并使用 sort 方法对它们进行排序：`pairs.Sort();`。

# java - Java 中的 MCS 锁未更新缓存

> ID：13144008
> 
> 赞同：1
> 
> 时间：2012-10-30T16:56:21.903
> 
> 标签：java, multithreading, caching, locking, volatile

对于 Java 中的 MCS Lock，我得到了一些非常奇怪的缓存行为。基本上，它最多可用于四个线程（我机器上的内核数），但会卡住更多。当我调试时，我看到程序卡在了线上

```
while (qnode.locked); 
```

在 lock() 函数内部。调试时，我可以看到其中一个线程的 QNode 已锁定设置为 false，但我猜这是因为调试器导致缓存更新。我只是将“易失性”扔到所有变量上，绝望地尝试无济于事。这是我正在使用的课程：

```
class MCSLock
{
private volatile AtomicReference<QNode> tail;
private volatile ThreadLocal<QNode> myNode;

public MCSLock()
{
    tail = new AtomicReference<QNode>(null);
    myNode = new ThreadLocal<QNode>()
            {
                protected QNode initialValue() { return new QNode(); }
            };
}

public void lock()
{
    QNode qnode = myNode.get();
    QNode pred = tail.getAndSet(qnode);
    if (pred != null)
    {
        qnode.locked = true;
        pred.next = qnode;
        while (qnode.locked);
    }
}

public void unlock()
{
    QNode qnode = myNode.get();
    if (qnode.next == null)
    {
        if (tail.compareAndSet(qnode, null)) return;
        while (qnode.next == null);
    }
    qnode.next.locked = false;
    qnode.next = null;
}

private class QNode
{
    volatile boolean locked = false;
    volatile QNode next = null;
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-12-23T15:08:06.337

我有同样的问题。unlock() 方法有一个小错误。在将 false 值设置为下一个节点的锁定变量之前，我们需要等到该值变为 true 才能进入 lock 方法。我添加了

```
 while (!qnode.next.locked) {} 
```

前

```
 qnode.next.locked = false; 
```

进入 unlock() 方法，问题就跑了！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T17:04:40.057

`while (qnode.locked);`据我所知，没有做任何事情。也许你的意思是

```
 do {
        pred.next = qnode;
        // update qnode
       } while (qnode.locked); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T22:05:36.627

您的代码有效！但是，我的猜测是您的系统不足以快速执行 >4 个线程。

在双核 i5 上运行，执行挂在 5 个线程上

在四核超频 i7 上运行，按预期在 5 个线程上完成。哇！

# python - 如何替换字符串的一部分？

> ID：13144010
> 
> 赞同：0
> 
> 时间：2012-10-30T16:56:37.663
> 
> 标签：python, string

我对python很陌生。有人可以解释我如何操纵这样的字符串吗？

该函数接收三个输入：

*   **complete_fmla：**有一个带有数字和符号的字符串，但没有连字符 ( `'-'`) 也没有空格。
*   **partial_fmla：** 有连字符和可能的一些数字或符号的组合，其中的数字和符号（连字符除外）与 complete_formula 中的位置相同。
*   **符号：**一个字符

应该返回的输出是：

*   如果符号不在完整公式中，或者符号已经在部分公式中，则函数应返回与输入部分公式相同的公式。
*   如果符号在 complete_formula 而不是部分公式中，则函数应返回 partial_formula，其中符号替换符号所在位置的连字符，在 complete_formula 中所有出现的符号中。

基本上，我正在使用定义：

```
def generate_next_fmla (complete_fmla, partial_fmla, symbol): 
```

我要把它们变成列表吗？然后追加？另外，我应该找出符号的索引号，`complete_fmla`以便我知道在字符串中用连字符附加它的位置吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T17:04:56.490

这是一个简单的在线功能

```
def generate_next_fmla(base, filt, char):
    return ''.join( c if c==char else filt[idx] for idx,c in enumerate(base)  ) 
```

核心思想是 if else 子句：

```
c if c==char else filt[idx] 
```

其中，给定每个字符及其在原始字符串中的位置，如果等于所选字符，则将其放入新字符串中，否则将过滤字符串中的值

用更详细的方式编写，如下所示：

```
def generate_next_fmla (complete_fmla, partial_fmla, symbol):
    chars = ""
    for idx in range(len(complete_fmla)):
        c = complete_fmla[idx]
        if c==symbol:
            chars = chars + c
        else:
            chars = chars + partial_fmla[idx] 
    return chars 
```

这是在几行上用 more 编写的相同函数（实际上效率较低，因为字符串的太阳是一个坏习惯）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T17:48:15.130

作为 python 的初学者，最好的开始方法可能是将您的要求 1:1 映射到您的代码 - 我希望以下内容尽可能不言自明：

```
def generate_next_fmla (complete_fmla, partial_fmla, symbol):
    # test that complete_fmla does not contain '-'
    if '-' in complete_fmla:
        raise ValueError("comple_fmla contains '-'")
    # delete all spaces from partial_fmla if needed (this need was suggested
    # in the original question with some examples that contained spaces)
    partial_fmla = partial_fmla.replace(' ', '')
    # test if it is possible to test the "same positions" from both strings
    if len(complete_fmla) != len(partial_fmla):
        raise ValueError("complete_fmla does not have the same lenght as partial_fmla")
    # add other input checking as needed ...

    if symbol not in complete_fmla or symbol in partial_fmla:
        return partial_fmla

    # partial_fmla[i] = symbol wouldn't work in python
    # because strings are immutable, but it is possible to do this:
    # partial_fmla = partial_fmla[:i] + symbol + partial_fmla[i+1:]
    # and another approach is to start with an empty string
    result = ''
    for i in range(len(partial_fmla)):
        # for every character position in the formulas
        # if there is '-' in this position in the partial formula
        # and the symbol in this position in the complete formula
        if partial_fmla[i] == '-' and complete_fmla[i] == symbol:
            # then append the symbol to the result
            result += symbol
        else:
            # otherwise use the character from this positon in the partial formula
            result += partial_fmla[i]
    return result

print(generate_next_fmla ('abcdeeaa', '--------', 'd')) # ‘---d----’
print(generate_next_fmla ('abcdeeaa', '- - - x - - - - ', 'e')) # ‘---xee--’
print(generate_next_fmla ('abcdeeaa', 'x-------', 'a')) # ‘x-----aa’
print(generate_next_fmla ('abcdeeaa', 'x-----', 'a'))   # Exception 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T17:56:08.037

您可以检查此代码：

```
lst_fmla = []
def generate_next_fmla(s_str, fmla, c_char):
    i = 0
    for s in s_str:
        if c_char is s: lst_fmla.append(c_char)
        elif fmla[i] != '-': lst_fmla.append(fmla[i])
        else: lst_fmla.append('-')
        i = i + 1
    print(''.join(lst_fmla))
generate_next_fmla('abcdeeaa', '---d----', 'e') 
```

例如，如果您在函数 generate_next_fmla 中的第二个参数是这样的 '----d---'，其中 'd' 将是第三个参数（'e'）的相同索引，它将被替换为 'e '。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-30T17:04:24.617

问候您可以尝试使用正则表达式，我认为它们会对您想要实现的目标有很大帮助，这里有[链接](http://docs.python.org/2/library/re.html)

该文档中的一些示例：

```
>>> import re
>>> m = re.search('(?<=abc)def', 'abcdef')
>>> m.group(0)
'def' 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-30T17:39:36.793

毫无疑问，您需要添加一些边缘情况，但这应该适用于简单的情况：

```
def generate_next_fmla (complete_fmla, partial_fmla, symbol):
    result = partial_fmla.strip().split(' ')[:] 
    for index, c in enumerate(complete_fmla):
        if c == symbol:
            result[index] = c
    return "".join(result) 
```

它转换为列表并再次返回以使其更容易更改。

编辑：我现在意识到这类似于 EnricoGiampieri 的答案，但有列表。

# c# - 大规模 ORM 删除列 SQLite

> ID：13144011
> 
> 赞同：0
> 
> 时间：2012-10-30T16:56:48.033
> 
> 标签：c#, wpf, orm, massive

我正在将 Massive ORM 用于 wpf 应用程序。我有带有列表视图的屏幕，需要填充两个表（一个是主数据）。例如，我在单个列表视图中填充员工和薪水列表以及部门名称。员工表仅包含部门 ID。我应该能够更新员工的薪水。我已经用加入填充了列表视图。但是当我尝试更新整个列表时，它会抛出一个错误，即部门名称列不可用，这很明显。

问题

如何从“动态”列表中删除列？

有没有更好的方法来使用 Massive ORM 更新所有行？

谢谢尚卡拉·纳拉亚南。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T21:18:06.650

好的 - 这就是我的做法。一旦你的类派生自 DynamicModel

```
 public override System.Data.Common.DbCommand CreateUpdateCommand(object o, object key)
    {
        var expando = o.ToExpando();
        var settings = (IDictionary<string, object>)expando;

        if (RemoveColumn)
        {
            if (settings.ContainsKey(ColumnToRemove))
                settings.Remove(ColumnToRemove);
        }
        return base.CreateUpdateCommand(settings, key);
    } 
```

希望这可以帮助。

谢谢尚卡拉。

# c# - 尝试在 C# (Umbraco 4.8.1) 中返回的列表上按日期排序

> ID：13144017
> 
> 赞同：0
> 
> 时间：2012-10-30T16:57:13.167
> 
> 标签：c#, .net, linq, api, umbraco

我正在尝试从新闻部分提取最新的 5 篇文章，然后按文章日期对它们进行排序。

我设法得到了 5 篇文章并正常显示，但 OrderBy 没有按预期工作。我需要通过节点上名为“NewsDate”的属性对它们进行排序，该属性是一个日期选择器。

```
protected void Page_Load(object sender, EventArgs e)
    {
        var currentNode = Node.GetCurrent();
        var nodeTypeAlias = currentNode.NodeTypeAlias;

        if (nodeTypeAlias == "NewsMasterPage")
        {
            var nodes = FindChildren(currentNode, t => t.NodeTypeAlias.Equals("NewsArticle"));
            var nodesOutput = nodes.OrderBy(n => n.GetProperty("NewsDate"));

            newsRepeater.DataSource = nodesOutput;
            newsRepeater.DataBind();
        }

    }

    private static List<Node> FindChildren(Node currentNode, Func<Node, bool> predicate)
    {
        List<Node> result = new List<Node>();

        var nodes = currentNode
            .Children
            .OfType<Node>()
            .Where(predicate).Take(4);
        if (nodes.Count() != 0)
            result.AddRange(nodes);

        foreach (var child in currentNode.Children.OfType<Node>())
        {
            nodes = FindChildren(child, predicate);
            if (nodes.Count() != 0)
                result.AddRange(nodes);
        }
        return result;
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T17:26:19.920

我假设这是因为`GetProperty(string)`返回一个对象，而不是实际`DateTime`实例。我相信你应该能够排序，如果你创建一个过渡投影，然后像这样选择元素：

```
nodes.Select(x => new { Node = x, NewsDate = /* Convert x.GetProperty("NewsDate") to DateTime */ })
     .OrderBy(x => x.NewsDate)
     .Select(x => x.Node) 
```

# xslt - 在应用 xslt 转换时使用 java 提供的参数到 xpath 函数中

> ID：13144020
> 
> 赞同：0
> 
> 时间：2012-10-30T16:57:19.810
> 
> 标签：xslt, xpath

我正在一个执行一些 xslt 转换的 java 应用程序中工作。我想使用 java 提供的参数将节点匹配到 xslt 文档中。这是执行以下操作的正确方法：

```
<xsl:template match="//m:properties/*[contains($pattern,name())]"> 
```

因为当我启动我的应用程序时，它声称它无法编译样式表，因为没有定义模式，但我使用 setParameter 方法设置它，并且我能够使用以相同方式但在不同上下文中定义的另一个参数. 提前感谢菲尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T17:02:08.610

你需要一个

```
<xsl:param name="pattern" /> 
```

在您的样式表中声明参数，`setParameter`调用本身是不够的。然而，还有一个问题是，根据 XSLT 1.0 规范，匹配表达式不允许包含变量/参数引用，例如`$pattern`. 一些处理器确实允许它们（至少包括某些版本的 Xalan），但如果它不起作用，那么您需要更改匹配逻辑，例如通过定义要匹配的模板`//m:properties/*`但然后只调用`apply-templates`与您的模式匹配的那些元素.

# excel - 宏不会删除所有空白单元格

> ID：13144022
> 
> 赞同：1
> 
> 时间：2012-10-30T16:57:23.107
> 
> 标签：excel, excel-2010, vba

这是一个冗长的查询，因为我包含了失败的代码。

问题：当我完成将文本文件导入 Excel 后，我的工作表包含许多“空白”单元格。我之前在其他地方成功使用过以下代码，但在这种情况下它对我不起作用。

```
Range("b1:AZ60").Select
Selection.SpecialCells(xlCellTypeBlanks).Select
Selection.Delete shift:=xlToLeft 
```

我在网上搜索并找到了一些建议的解决方案（如下）。我已经尝试在上面的代码之前运行下面的 4 个代码片段中的每一个，以清除所谓的空白单元格的内容，但到目前为止没有任何效果。

1号 - - - - - - - - - - - - - - - - - - - - - - - - ---------

```
 Set rng = Intersect(Selection, Selection.Parent.UsedRange)

For Each C In rng
   If Trim(C) = "" Then
   C.ClearContents
   End If
Next C 
```

我已经用 c.value 替换了上面的装饰，但没有

```
If C.Value <> "" Then 
```

2号 - - - - - - - - - - - - - - - - - - - - - - - - --

```
For Each aCell In ActiveSheet.Cells.SpecialCells(xlCellTypeConstants)
    If Not aCell.Value Like "*[! ]*" Then aCell.ClearContents
Next 
```

3号------------------------------------------------ -

```
For Each C In rng
   If IsEmpty(C) Then
   C.Delete shift:=xlToLeft
   Else
   ActiveCell.Select
   End If
Next C 
```

4号--------------------------------------

最后我找到了这个干净的功能，但这似乎没有奏效。

```
Set rng = Intersect(Selection, Selection.Parent.UsedRange)

For Each C In rng
    If Not IsError(C) Then
        C.Value = MEGACLEAN(C)
    End If
Next C
              '
              '
              '
End Sub
-----------------------------------------
Function MEGACLEAN(varVal As Variant)
Dim NewVal As Variant
If IsMissing(varVal) Then Exit Function
NewVal = Trim(varVal) 'remove spaces
NewVal = Application.WorksheetFunction.Clean(NewVal) 'remove most unwanted characters
NewVal = Application.WorksheetFunction.Substitute(NewVal, Chr(127), "") 'remove   
ASCII#127
NewVal = Application.WorksheetFunction.Substitute(NewVal, Chr(160), "") 'remove  
ASCII#160
MEGACLEAN = NewVal
End Function 
```

也许这与我从中导入的文本文件有关，但由于我仍然有一些空白单元格，这些都不能令人满意。任何帮助将非常感激！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T18:26:47.293

找出这些“空白”单元格中有哪些字符。

选择一个单元格并运行下面的 GetSelectionContents 宏：

```
Sub GetSelectionContents()
MsgBox sAnalyseString(selection)
End Sub

Function sAnalyseString(sSTR As String) As String
Dim lLoop As Long, sTemp As String

For lLoop = 1 To Len(sSTR)
    sTemp = sTemp & ", " & Asc(Mid(sSTR, lLoop, 1))
Next

sAnalyseString = Mid(sTemp, 2)

End Function 
```

然后，一旦你有了你的神秘角色，在运行你的删除宏之前替换它。

`Activesheet.usedrange.Replace What:=chr(32), Replacement:="", LookAt:=xlPart, _ SearchOrder:=xlByColumns, MatchCase:=False, SearchFormat:=False, _ ReplaceFormat:=False`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T11:55:26.017

不确定如果我应该像这样回答我自己的问题，但我弄乱了上面的代码，并将它与我找到的 mcaro 混合在一起，并想出了下面的代码，虽然速度很慢，但似乎可以对我来说的诀窍。感谢所有的输入！

```
 Set rangetext = Cells.SpecialCells( _
 xlCellTypeConstants, _
 xlTextValues)
 For Each rangesheet In rangetext
 If Trim(rangesheet.Value) = "" Then
 rangesheet.ClearContents
 End If
 Next
Set rangetext = Nothing
Set rangesheet = Nothing

 Range("b1:AZ60").Select
 Set rng = Intersect(Selection, Selection.Parent.UsedRange)
 For Each C In rng
   If IsEmpty(C) Then
   C.FormulaR1C1 = "=0"
   If C.Value = 0 Then
   C.ClearContents
   C.Select
   Selection.SpecialCells(xlCellTypeBlanks).Select
   Selection.Delete shift:=xlToLeft
  End If

  End If
 Next C 
```

# c++ - 为程序中所有可能路径的运行生成数据

> ID：13144023
> 
> 赞同：0
> 
> 时间：2012-10-30T16:57:27.350
> 
> 标签：c++, z3

我是 Z3 的新手，并在此处和 Google 上搜索了我的问题的答案。我没有成功。

这是产生问题的代码：

```
void test(string str) {
    if (str [0] == 'g') {
        cout << "\"The first letter g" case"<< endl;
        if (str [1] == 'a') cout << "Second letter is 'a'";
        else cout << "Second letter is not 'a'";
    } else {
        cout << "The non-g case" << endl;
        if (str [1] == 'b') cout << "Second letter is 'b'";
        else cout << "Second letter is not 'b'";
    }
} 
```

我需要自动生成输入数据，以便代码一直运行。z3有可能做到这一点吗？如果是这样，我该如何使用 z3 C/C++API 做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T17:25:07.423

[Z3](http://z3.codeplex.com)不是测试用例生成器或模糊器，它是定理证明器。但是，Z3 用于实现模糊器和测试用例生成器。其中之一是[Pex](http://research.microsoft.com/en-us/projects/pex/)，一种用于 .NET 的白盒单元测试。Z3 还用于[Sage](http://channel9.msdn.com/blogs/peli/automated-whitebox-fuzz-testing-with-sage)中，这是一个用于 x86 二进制文件的白盒模糊器。不幸的是，我不知道有任何基于 Z3 的 C++ 测试用例生成器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T02:36:53.287

不直接回答您的问题，但之前已使用 SAT/SMT 求解器来生成此类“利用”向量，并取得了相当大的成功。例如，查看 Brumley 的 AEG 系统：[http](http://security.ece.cmu.edu/aeg/index.html) : //security.ece.cmu.edu/aeg/index.html 等。

# javascript - 带有对象的jQuery自动完成更新源 - 格式化数组

> ID：13144025
> 
> 赞同：0
> 
> 时间：2012-10-30T16:57:33.600
> 
> 标签：javascript, jquery, user-interface, autocomplete, jquery-autocomplete

我试图动态更新 jQuery UI 源。我可以用一个数组很好地做到这一点，例如：

```
 var arrProducts = ['cheese' , 'bread' ,  'milk']; 
```

但需要使用对象来完成。在切换到使用 AJAX 之前，这在第一页加载时运行良好，将一组对象从 PHP 传递到 Twig：

```
 var arrProducts = [
                      {% for product in allproducts %}
                          {
                              title:  "{{ product.title }}",
                              url:  "{{ product.url }}",                                 
                              label: "{{ product.label }}"                              
                          },
                      {% endfor %}
              ]; 
```

那么，如何在 javascript 中复制这种格式？我试过这个：

```
 var arrProducts = [];

                            $.each(data.products, function(index, product)
                            {
                                   prod['title'] = product.title;
                                   prod['url'] = product.url;
                                   prod['label'] = product.label;

                                   arrProducts.push(prod);
                            });                          

                           $('.searchBox' ).autocomplete( "option", "source", arrProducts ); 
```

但这会产生嵌套对象，然后自动完成似乎无法正确读取。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T17:46:29.870

jQueryUI 文档表明该`source`数组应包含具有 a`label`和`value`属性的对象：[http://api.jqueryui.com/autocomplete/#option-source](http://api.jqueryui.com/autocomplete/#option-source)；您的对象没有`value`属性。

我不清楚为什么这以前会起作用，但这里有一个对我有用的修改：我将您更改`prod['title']`为`prod['value']`, 并预先声明`prod`为局部变量，因此它不会自动实例化为全局变量。

另请注意，我必须更改“选项”调用以使用匿名对象；出于某种原因，尝试调用`$('.searchBox').autocomplete("options", "source", arrProducts);`导致我的测试小提琴出现错误。

**HTML**

```
​&lt;input type="text" class="searchBox"/>​​​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

**JavaScript**

```
var products = [
    {
      title: 'cheese',
      url: 'http://www.example.com',
      label: 'Swiss Cheese'
    },
    {
      title: 'bread',
      url: 'http://www.example.com',
      label: 'Wheat Bread'
    },
    {
      title: 'milk',
      url: 'http://www.example.com',
      label: '1% Milk'},
];

var arrProducts = [];

$.each(products, function(index, product) {
    var prod = {};
    prod['value'] = product.title;
    prod['url'] = product.url;
    prod['label'] = product.label;

    arrProducts.push(prod);
});

$('.searchBox').autocomplete({ source: arrProducts }); 
```

# c# - 在 O(n) 时间内更新 C# 键控集合中的所有值？

> ID：13144026
> 
> 赞同：5
> 
> 时间：2012-10-30T16:57:35.320
> 
> 标签：c#, .net, collections

这是我在C#中反复遇到的一个问题，但一直没有找到通用的解决方案。在 C++/STL 中，可以使用迭代器在 O(n) 时间内更新映射中的所有值，而无需使用键来访问每个元素。有没有办法获得与任何 C# 集合（如 SortedList、SortedDictionary）类似的行为？

我可以做类似的事情

```
foreach (int key in list.Keys)
{
    list[key] *= 3;
} 
```

但这需要 O(n * log(n))，因为使用键搜索每个元素需要 log(n)。

只是给出一个想法，我正在寻找类似的东西：

```
SortedList<int, double> list = new SortedList<int,double>();

// Add few values fist

// E.g. first try ...
IList<double> values = list.Values;
for (int i = 0; i < values.Count; i++)
{
    values[i] *= 3;
}

// E.g. second try
foreach (KeyValuePair<int, double> kv in list)
{
    kv.Value *= 3;
} 
```

由于 List 已经排序，因此应该可以遍历它同时更新值（而不是键）。从实现的角度来看，这似乎没有问题，但由于某种原因，该功能似乎不可用。

这也不是一个简单的情况，因为可以使用相同的方法从已知位置迭代到该范围内的另一个修改值。

有没有办法在 C# 中使用 .NET 中的任何键控集合而不使用 3rd 方库来执行此操作？

谢谢

吉夫斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T17:06:25.210

最简单的解决方案是将值包装在引用类型中。

```
class WrappedInt { public int Value; }
Dictionary<TKey, WrappedInt> dictionary = ...;
foreach (var wrappedVal in dictionary.Values)
{
    wrappedVal.Value *= 3;
}
// or 
foreach (var wrappedVal in dictionary)
{
    wrappedVal.Value.Value *= 3;
} 
```

这种方法适用于任何集合（列表或字典）。为数不多的在没有包装的情况下通过设计做到这一点的集合之一是`LinkedList`.

当然，如果您有一个非常具体的集合（由某些外部组件创建），您总是可以回退到使用反射并直接在底层存储中更改值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T17:30:47.643

```
SortedList<int, double> list = new SortedList<int,double>
{
    { 1, 3.14 },
    { 2, 1.618 },
};

var newList = new SortedList<int, double>(list.ToDictionary(kv => kv.Key, kv => kv.Value * 3)).Dump(); 
```

根据[文档](http://msdn.microsoft.com/en-us/library/016ae4ba.aspx "排序列表函数")， SortedList 构造函数是 O(n) 。
.ToDictionary 在 Dictionary.Add 上循环。Dictionary.Add 是 O(1) 当容量足够[时](http://msdn.microsoft.com/en-us/library/k7z0zy8k.aspx "到字典")

O(n) * O(1) 仍然是 O(n) 所以你很好:-)

使用这种方法，空间需求当然会增加一倍。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T17:06:41.663

在 C# 中，访问 Dictionary 元素的时间接近于 O(1) 的恒定时间。

您可以通过调用 Dictionary.Values 并更新它们来获取值列表：

```
foreach(var value in valuesDict.Values)
{
    // update value;
} 
```

获取此属性 ( `Dictionary.Values`) 的值[也是一个 O(1) 操作。](http://msdn.microsoft.com/en-us/library/ekcfxy3x.aspx).

# jquery - 主干绑定事件 keydown 到文档返回 Uncaught TypeError: Object [object Object] has no method 'apply'

> ID：13144029
> 
> 赞同：0
> 
> 时间：2012-10-30T16:57:40.043
> 
> 标签：jquery, backbone.js, keyboard-events, keydown

我在修复这个错误时遇到了很大的麻烦。

我在 Backbone.js 中有一个视图，我想将一些操作与键盘事件绑定。

这是我的观点：

```
window.PicturesView = Backbone.View.extend({
    initialize : function() {
        $(document).on('keydown', this.keyboard, this);
    },
    remove : function() {
        $(document).off('keydown', this.keyboard, this);
    },
    render : function(eventName) {
        // blah blah blah
    },
    next : function() {
        // blah
    },
    prev : function() {
        // blah
    },
    keyboard : function(e) {
        console.log(e.keyCode);
        if (e.keyCode == 37) {
            this.prev();
            return false;
        }
        if (e.keyCode == 39) {
            this.next();
            return false;
        }
    }
}); 
```

当我按下键盘时，我得到这个错误： `Uncaught TypeError: Object [object Object] has no method 'apply'` 这是由 jQuery 触发的。

读完后：[未捕获的类型错误：对象 [对象对象] 没有方法“应用”](https://stackoverflow.com/questions/11032659/uncaught-typeerror-object-object-object-has-no-method-apply)

我也试过： `$(document).on('keydown', function(e) { this.keyboard(e); }, this);` 但它仍然给我同样的错误。

并且： `$(document).on('keydown', 'keyboard', this);` 在`events : { 'event' : 'action' }`风格上，但它没有做任何事情。

我可能只在代码中的其他地方使用 jQuery 来发现一些 hack，但是由于我不是事件处理和 Backbone 方面的专家，所以我想以一种好的方式运行它。

我希望我清楚，谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T13:16:37.367

@roatin-marth 是对的。正在应用的“on”函数不是我预期的主干函数，它允许将上下文作为参数传递： `$(document).on('keydown', this.keyboard, this);`

因为它是一个 jQuery 选择器，所以它适用于 jQuery。因此我需要一个代理来链接上下文： `$(document).on('keydown',$.proxy(this.keyboard,this));`

一切都好，感谢您的帮助。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-30T17:25:44.610

Backbone 的典型事件语法应该可以工作。摆脱初始化代码并尝试它。

```
// code above unaltered
initialize : function() { }, // of course you can remove these two, it was just to clarify that they should be empty.

remove : function() { },

render : function(eventName) {
    // blah blah blah
    this.delegateEvents(); // just to have them re-bound if the view is removed
},

events: {
    'keydown': 'keyboard'
}
// rest of the code unaltered 
```

# asp.net - 从 Application_Error 中执行控制器操作会引发 InvalidOperationException（未找到视图）

> ID：13144031
> 
> 赞同：0
> 
> 时间：2012-10-30T16:57:47.613
> 
> 标签：asp.net, asp.net-mvc-3, error-handling

我正在尝试安装一个很好的全局异常处理机制来集中管理一般抛出的异常，以及 404、500、...错误；也就是说，不必针对不同的错误实现不同的错误页面/错误处理解决方案。

为此，我尝试[实现此示例](https://stackoverflow.com/a/9026907/122764)以从 Global.asax.cs 的 Application_Error 方法中调用 ErrorsController。

但是，当我运行代码时，我遇到了这个异常：

```
System.InvalidOperationException was unhandled by user code
  HResult=-2146233079
  Message=The view 'NotFound' or its master was not found or no view engine supports the searched locations. The following locations were searched:
~/Views/Errors/NotFound.aspx
~/Views/Errors/NotFound.ascx
~/Views/Shared/NotFound.aspx
~/Views/Shared/NotFound.ascx
/favicon.ico
  Source=System.Web.Mvc
  StackTrace:
       at System.Web.Mvc.ViewResult.FindView(ControllerContext context)
       at System.Web.Mvc.ViewResultBase.ExecuteResult(ControllerContext context)
       at System.Web.Mvc.ControllerActionInvoker.InvokeActionResult(ControllerContext controllerContext, ActionResult actionResult)
       at System.Web.Mvc.ControllerActionInvoker.<>c__DisplayClass1a.<InvokeActionResultWithFilters>b__17()
       at System.Web.Mvc.ControllerActionInvoker.InvokeActionResultFilter(IResultFilter filter, ResultExecutingContext preContext, Func`1 continuation)
       at System.Web.Mvc.ControllerActionInvoker.<>c__DisplayClass1a.<>c__DisplayClass1c.<InvokeActionResultWithFilters>b__19()
       at System.Web.Mvc.ControllerActionInvoker.InvokeActionResultFilter(IResultFilter filter, ResultExecutingContext preContext, Func`1 continuation)
       at System.Web.Mvc.ControllerActionInvoker.<>c__DisplayClass1a.<>c__DisplayClass1c.<InvokeActionResultWithFilters>b__19()
       at System.Web.Mvc.ControllerActionInvoker.InvokeActionResultFilter(IResultFilter filter, ResultExecutingContext preContext, Func`1 continuation)
       at System.Web.Mvc.ControllerActionInvoker.<>c__DisplayClass1a.<>c__DisplayClass1c.<InvokeActionResultWithFilters>b__19()
       at System.Web.Mvc.ControllerActionInvoker.InvokeActionResultWithFilters(ControllerContext controllerContext, IList`1 filters, ActionResult actionResult)
       at System.Web.Mvc.ControllerActionInvoker.InvokeAction(ControllerContext controllerContext, String actionName)
       at System.Web.Mvc.Controller.ExecuteCore()
       at System.Web.Mvc.ControllerBase.Execute(RequestContext requestContext)
       at System.Web.Mvc.ControllerBase.System.Web.Mvc.IController.Execute(RequestContext requestContext)
       at Cider.MvcApplication.Application_Error(Object sender, EventArgs e) in c:\Users\cornelius.kopp\Projects\SD Cider\Cider\Global.asax.cs:line 88
       at System.EventHandler.Invoke(Object sender, EventArgs e)
       at System.Web.HttpApplication.RaiseOnError()
  InnerException: 
```

有趣的是，我使用 Razor 作为视图引擎，并且模板*确实*存在。我实现了一个`HandleErrorsAttribute`名为 ErrorsController 的自定义，并通过它一切顺利。仅当从 Application_Error 方法调用（基本上是复制和粘贴的）代码时，它才会失败。

尝试在项目中创建 NotFound.aspx 视图产生了相同的异常，只是它仅将 favicon.ico 列为搜索位置。

将代码移动到 Application_EndRequest 中，如最初编写的那样，产生了相同的结果

对此的任何解释将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T10:48:56.523

谷歌让我发现了[一个关于 Jetbrain 的问题跟踪器的问题](http://youtrack.jetbrains.com/issue/RSRP-329698)。显然我的 R# 缓存不知何故损坏了；清除它并重新启动 Visual Studio 有帮助。“清除缓存”似乎是解决问题的一种普遍有用的方法。:|

```
How to clean caches:
1\. Menu: RESHARPER->Options->General->Clear caches
2\. Restart Visual Studio 
```

# javascript - 如何从父 div 中删除 div 列表？

> ID：13144032
> 
> 赞同：0
> 
> 时间：2012-10-30T16:57:55.193
> 
> 标签：javascript, dom, parent, children

我的 JavaScript 有问题。

我需要从父 div 中删除一个 div 列表。所以我尝试了这个：

```
var divs = parent.getElementsByTagName("div");
if(divs != null)
{
    for(var v = 0; v < divs.length; v++)
    {
        parent.removeChild(divs[v]);
    }
} 
```

但问题是，JS 并没有删除所有的 div。JS 只删除列表的一半。

我也试过这个：

```
var divs = parent.getElementsByTagName("div");
if(divs != null)
{
    for(var v = 0; v < divs.length; v++)
    {
        parent.removeChild(divs[0]);
    }
} 
```

但结果相同

请帮忙？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T17:07:23.603

```
var divs = parent.getElementsByTagName("div");
while(divs[0]) {
    divs[0].parentNode.removeChild(divs[0])
} 
```

getElementsByTagName 返回的列表是*live*。这意味着它会在您删除 DOM 对象时更新，因此每个周期的长度都不相同。

这是一个[小提琴](http://jsfiddle.net/nTcq9/1/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T17:06:25.833

你为什么不尝试类似的东西：

```
var divs = parent.getElementsByTagName("div");
if (divs.length > 0) {  // Technically unnecessary, as the for loop just won't run if there aren't any elements returned
    for (var v = divs.length; v >= 0; v--) {
        divs[v].parentNode.removeChild(divs[v]);
    }
} 
```

为了解释为什么这是正确的，`removeChild`必须使用 来删除父节点的实际**子节点。**If`div[v]`是一个后代（你知道，就像嵌套在另一个元素内 - 不是一个 div - 这是一个实际的子元素`parent`）。这是在引用元素时删除元素的安全方法。您保证元素的父节点正在删除它，因此是有效的。如果您检查控制台是否尝试`parent.removeChild`像您和其他代码一样使用，则会为任何后代抛出异常 - [http://jsfiddle.net/ujaSv/](http://jsfiddle.net/ujaSv/)

尽管重要的是要指出 for 循环的更好替代方法是：

```
while (divs[0]) {
    divs[0].parentNode.removeChild(divs[0]);
} 
```

我没有想到这种辉煌 - 这是在另一个答案/评论区决定的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-30T17:06:29.500

两种解决方案：

1：倒计时

```
var divs = parent.getElementsByTagName("div");
if(divs != null)
{
    for(var v = divs.length - 1; v >= 0; v--)
    {
        parent.removeChild(divs[0]);
    }
}​ 
```

2：缓存长度：

```
var divs = parent.getElementsByTagName("div");
if(divs != null)
{
    for(var v = 0, len = divs.length; v < len; v++)
    {
        parent.removeChild(divs[0]);
    }
} 
```

# c - pthread 与 ucontext 的性能特征

> ID：13144044
> 
> 赞同：1
> 
> 时间：2012-10-30T16:58:45.630
> 
> 标签：c, performance, pthreads, coroutine

我正在尝试将使用 ucontext 的库移植到支持 pthreads 但不支持 ucontext 的平台。代码写得很好，所以用对 pthread 例程的调用替换所有对 ucontext API 的调用应该相对容易。但是，这是否会引入大量额外开销？或者这是一个令人满意的替代品。我不确定 ucontext 是如何映射到操作系统线程的，而这个工具的目的是使协程生成相当便宜和容易。

所以，问题是：用 pthread 调用替换 ucontext 调用是否会显着改变库的性能特征？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T18:32:26.043

pthread 将使用系统调用，以及少量的管理内存。假设需要相同数量的系统调用，它应该与 ucontext 相当（我会天真地用 strace 进行检查）。

出于同样的原因，swapcontext() 比使用一些 longjmp 技巧要慢（有关作者声称对他的应用程序的 7 倍性能影响的讨论，请参阅[此页面）。](http://www.1024cores.net/home/lock-free-algorithms/tricks/fibers)

我不是这方面的专家，但我使用协程 spice-gtk 开发了一个库，我们有使用 ucontext/jmp、gthread 或 winfibers 的后端。我没有注意到任何性能变化，但这可能是因为 lib 通常是 IO 绑定的。

# c# - 处理 Prism 4 模块中的异常

> ID：13144048
> 
> 赞同：2
> 
> 时间：2012-10-30T16:59:00.047
> 
> 标签：c#, wpf, mvvm, prism, mef

我在这里浏览了很多关于这个主题的主题，但都没有成功。似乎在我们的 WPF 应用程序的 App.xaml.cs 中，处理 DispatcherUnhandledExceptions 和 AppDomain.CurrentDomain.UnhandledException 并不能捕获所有内容。

在这个特定的例子中，我们有 7 个棱镜模块。我的异常处理代码如下（UnhandledException 几乎相同）：

```
private void OnDispatcherUnhandledException(object sender, DispatcherUnhandledExceptionEventArgs e)
    {
        try
        {
            var ex = e.Exception.InnerException ?? e.Exception;
            var logManager = new LogManager();
            logManager.Error(ex);

            if (!EventLog.SourceExists(ex.Source))
                EventLog.CreateEventSource(ex.Source, "AppName");
            EventLog.WriteEntry(ex.Source, ex.InnerException.ToString());

            var emb = new ExceptionMessageBox(ex);
            emb.ShowDialog();
            e.Handled = true;

        }
        catch (Exception)
        { }
    } 
```

**问题似乎是模块中发生的未处理异常。** 它们没有被上面的代码捕获，它们会导致应用程序崩溃而不记录或显示任何类型的消息。

有人对此有经验吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-01T05:49:35.367

这就是我们在 Prism 应用程序中为捕获异常所做的（它几乎可以捕获所有内容）：

```
static class Program
{
    [STAThread]
    static void Main()
    {
        try
        {
             App app = new App();
             app.InitializeComponent();
             app.Run();
        }
        catch (Exception e)
        {
             // Log here
             // Custom error message.
        }
     }
 } 
```

为此，您必须将“启动对象”更改为此类。您可以在 shell 的项目属性中执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-07-02T19:00:01.487

虽然并不完美，但您可以通过覆盖来捕获模块初始化期间发生的异常`InitializeModules`。

```
protected override void InitializeModules()
{
    try
    {
        base.InitializeModules();
    }
    catch (ModuleInitializeException e)
    {
        Exception innerException = e.InnerException;

        // Handle Exception
    }
} 
```

A`ModuleInitializeException`被抛出，可以被困住；内部异常将包含原始异常。

不幸`InitializeModules`的是，或者模块管理器将执行自己的日志记录，在我的情况下，我更愿意自己做以避免`ModuleInitializeException`出现在日志中。

# html - 在获取请求中编码数据

> ID：13144050
> 
> 赞同：1
> 
> 时间：2012-10-30T16:59:04.037
> 
> 标签：html, forms, get, request

```
<!DOCTYPE html>
<html>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<body onload="searchForPrograms.submit();">
<form id="searchForPrograms" name="searchForPrograms" enctype="application/x-www-form-urlencoded" method="get" action="searchingEngine.php">
<input type="text" id="query" name="query" value="MyProgram"  /><br>
<input type="submit" value="Search" />
</form>
</body> 
```

获取请求的格式应类似于“searchingEngine.php?query=%22MyProgram%22”。

如何正确编码查询输入的值？

# django - 姜戈。此函数的关键字参数无效。多对多

> ID：13144051
> 
> 赞同：12
> 
> 时间：2012-10-30T16:59:03.880
> 
> 标签：django

我有这个错误：

**'people' 是此函数的无效关键字参数**

```
class Passage(models.Model):
    name= models.CharField(max_length = 255)
    who = models.ForeignKey(UserProfil)

class UserPassage(models.Model):
    passage = models.ForeignKey(Passage)
    people = models.ManyToManyField(UserProfil, null=True)

class UserProfil(models.Model):
    user = models.OneToOneField(User)
    name = models.CharField(max_length=50) 
```

我尝试：

```
def join(request):
    user = request.user
    user_profil = UserProfil.objects.get(user=user)
    passage = Passage.objects.get(id=2)
    #line with error
    up = UserPassage.objects.create(people= user_profil, passage=passage)
    return render_to_response('thanks.html') 
```

如何正确地做到这一点？谢谢！

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-10-30T17:08:23.443

您需要先保存/创建对象，然后才能添加`ManyToMany`关系：

```
up = UserPassage.objects.create(passage=passage)
up.people.add(user_profil) 
```

`ManyToMany`关系不会保存为表中的列。阅读这里的第一个回复以获得很好的解释：

[模型中未创建 Django ManyToMany 字段](https://stackoverflow.com/questions/9080177/django-manytomany-field-is-not-created-in-model)

> @DanielRoseman：因为 ManyToMany 不是字段，至少不是作为数据库列存在的字段。这是与链接表的关系。您会发现已经创建了一个名为 myapp_teacher_subjects 的表，其中包含教师和科目的外键。

# scala - 如何从Scala中抛出的异常中打印表达式的确切名称

> ID：13144055
> 
> 赞同：-1
> 
> 时间：2012-10-30T16:59:14.247
> 
> 标签：scala, exception-handling

我不知道如何从我的代码中抛出的异常中打印出表达式的确切名称：http: [//pastie.org/private/jfszprszt7uxng2ajahcg](http://pastie.org/private/jfszprszt7uxng2ajahcg)

我需要的是它打印`WrongTypeInExpression(BinOp("+",Var("b"),IntLit(12)))`但实际上它打印`WrongTypeInExpression(BinOp(+,Var(b),IntLit(12)))`。

请问你能帮帮我吗？

我试图改变这些东西，但它们产生了相同的结果：

```
case e:WrongTypeInExpression => println("WrongTypeInExpression(" + e.expr.toString() + ")") 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T15:19:35.170

仅出于显示问题的目的，您在 paste.org 上的代码可以缩短为：

```
trait Expr
case class BinOp(op: String, left: Expr, right: Expr) extends Expr
case class IntLit(value: Int) extends Expr
case class Var(name: String) extends Expr

println(BinOp("+", Var("b"), IntLit(12))) // prints BinOp(+,Var(b),IntLit(12)) 
```

正如 Rex Kerr 在他的评论中指出的那样，您可以简单地覆盖 toString（在上面的 println 中默默地调用它以将其所有参数转换为可打印值）来做您想做的事情。

```
trait Expr
case class BinOp(op: String, left: Expr, right: Expr) extends Expr {
    override def toString : String = "BinOp(\"" + op + "\", " + left.toString + ", " + right.toString + ")"
}
case class IntLit(value: Int) extends Expr
case class Var(name: String) extends Expr {
    override def toString : String = "Var(\"" + name + "\")"
} 
```

现在，如您所愿：

```
scala> println(BinOp("+", Var("b"), IntLit(12)))
BinOp("+", Var("b"), IntLit(12)) 
```

# html - Pydev上的html代码颜色为浅灰色，如何更改？

> ID：13144058
> 
> 赞同：1
> 
> 时间：2012-10-30T16:59:18.500
> 
> 标签：html, eclipse, colors, editor, appearance

我对 Eclipse 的 Pydev 有疑问。我必须在 Eclipse 编辑器中编辑一个 html 文件，但是代码是浅灰色的，我找不到更改它的方法。

我已经尝试过 Eclipse 的“外观”菜单，但找不到正确的条目！有人有建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T17:20:36.467

Eclipse 有一种相当复杂的分层方式来确定外观。我不确定 Pydev 变体的具体情况，但大多数变体都是相似的：

项目菜单 -> 属性

这应该会弹出一个窗口，左侧有一堆下拉菜单。您特别想要哪一个可能会有很大差异。但是，您正在寻找“格式化程序”菜单，可能在“（Python）代码样式”下。找到它后，单击“配置工作区设置”。您必须创建一个新的活动配置文件并从该菜单修改它。

请注意，可能有几个这样的“格式化程序”菜单，找到处理 html 的菜单是诀窍。祝你好运！

# css - webkit和firefox中的字体权重不同

> ID：13144061
> 
> 赞同：3
> 
> 时间：2012-10-30T16:59:27.360
> 
> 标签：css, fonts, cross-browser, typography

我完成了一个设计，到目前为止我一直在 firefox 中工作，只是在我第一次注意到我的标题完全不同的时候把它带到 webkit，它们在 Helvetica Neue UltraLight 50px 中，所以在 css 中：

```
font-family: "helvetica neue"; font-weight:100; font-size:50px; 
```

在 Firefox 中查看时，它看起来像左侧的版本

在 webkit (safari, chrome, ios safari) 中查看它看起来像右边的版本

![firefox helvetica neue 超轻](../Images/6a6544a89e785596f169981f76d45b14.png) ![webkit helvetica neue 超轻](../Images/6160989c4c909d5c35c0fd0edd290f9e.png)

知道如何让这两者更接近吗？

如果有人想玩 css，我还做了一个小[jsfiddle ，](http://jsfiddle.net/24CFE/)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-30T17:24:23.100

过去我很幸运，因为讨厌的 webkit 字体显示比预期的更粗：

```
-webkit-font-smoothing: antialiased; 
```

我还建议使用 CSS @font-face 来显示 Helvetica Neue 字体。默认情况下，Helvetica Neue 并非在所有计算机和操作系统上。希望这可以帮助！:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T18:01:26.680

从图片中可以看出，Firefox 使用的是家族中较粗的字体。我猜不出为什么，也无法在我的电脑上进行测试——就像全球大多数电脑一样，它没有 Helvetica Neue 字体。

字体可用性可能是这里最重要的问题。您的`font-family`列表在（几乎所有）Windows 计算机上导致使用 Arial。这意味着使用正常重量（常规）字体，因为 Arial 没有更薄的字体。

所以最好的方法可能是寻找一种免费的可下载字体并通过`@font-face`. 但是，大多数此类字体只有两种粗细，甚至可能只有一种，因此如果您想要同时存在 300 和 100 粗细的字体，则需要关注相对较少的字体，例如至少 6 种字体. 也许[Source Sans Pro](http://www.fontsquirrel.com/fonts/source-sans-pro)的设计可能非常相似——或者至少是可以接受的设计。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-03-16T01:52:08.507

尝试：-webkit-text-stroke: 0.35px

在这里阅读更多：http: [//css-tricks.com/beefing-up-dull-text-in-webkit/](http://css-tricks.com/beefing-up-dull-text-in-webkit/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-08-28T14:44:40.997

**在样式表顶部附近添加**

```
/**
 * Fix fonts that render as bold in Firefox
 *
 * Put this near the top of your style.css
 * Before any overriding styles
 */

html {
  -moz-osx-font-smoothing: grayscale;
  -webkit-font-smoothing: antialiased;
  font-smoothing: antialiased;
  font-weight: 400;
}

/**
 * Firefox specific rule
 */

@-moz-document url-prefix() {
  body {
    font-weight: lighter !important;
  }
} 
```

`-moz`前缀规则仅针对 Firefox 。`-webkit`前缀规则针对 Chrome 和 Safari，它们在浏览器中使用 Webkit 渲染引擎。

**注意：**如果您还在`text-rendering: optimizeLegibility`样式表中使用，这可能会导致 Internet Explorer 将一些较粗的字体呈现为粗体，而它们应该呈现为正常粗细。

来自[网站](https://www.lockedownseo.com/firefox-font-weight-too-bold/)的参考。

# python - 如何使用views.py在django中显示mysql数据？

> ID：13144063
> 
> 赞同：2
> 
> 时间：2012-10-30T16:59:34.433
> 
> 标签：python, mysql, django

我是 python 的初学者，正在尝试下面的教程：http: [//net.tutsplus.com/tutorials/python-tutorials/python-from-scratch-creating-a-dynamic-website/](http://net.tutsplus.com/tutorials/python-tutorials/python-from-scratch-creating-a-dynamic-website/)

我创建了一个具有以下正文的模板：

```
<div class="container">
    <h1>First Blog</h1>
    <hr />
    {% for post in posts %}
        <div class="post">
        <h2>{{ post.title }}</h2>
        <h3>Posted on {{ post.timestamp }} by {{ post.author }}</h3>
        <p>{{ post.bodytext }}</p>
        </div>
        <hr />
    {% endfor %}
</div> 
```

views.py 文档有以下代码：

```
from django.shortcuts import render_to_response
from blog.models import posts
def home(request):
    entries = posts.objects.all()[:10]
    return render_to_response('index.html', {'posts' : entries}) 
```

该网站显示以下内容：

```
First Blog

{% for post in posts %}
{{ post.title }}

Posted on {{ post.timestamp }} by {{ post.author }}

{{ post.bodytext }}

{% endfor %} 
```

如何让网站显示我数据库中的数据？

# windows-phone-8 - 内部部署 Windows Phone 8 应用程序

> ID：13144069
> 
> 赞同：5
> 
> 时间：2012-10-30T16:59:43.943
> 
> 标签：windows-phone-8, win-company-app

有没有类似于适用于 Windows Phone 8 应用程序的[iOS 开发者企业计划的东西？](https://developer.apple.com/programs/ios/enterprise/)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-07T19:55:32.493

[是的，您可以通过在Windows Phone 开发中心](https://dev.windowsphone.com/en-us/join)注册公司帐户来加入企业计划。该过程称为[公司应用程序分发](http://msdn.microsoft.com/en-us/library/windowsphone/develop/jj206943%28v=vs.105%29.aspx)。

简而言之，一旦您的公司帐户通过验证，您将收到一个 ID，您将提供给赛门铁克，赛门铁克将生成[企业移动代码签名证书](https://products.websecurity.symantec.com/orders/enrollment/microsoftCert.do)。您将使用此证书生成一个令牌（设备用于在您的企业中识别自己）并签署应用程序。令牌和应用程序可以通过电子邮件、浏览器、MDM 或 Company Hub 分发。

电子邮件和浏览器分发是直截了当的，MDM 通过 Windows InTune 等设备管理系统进行。Company Hub 是您的组织为内部应用程序发现、安装和启动而开发的设备上应用程序。

有关更多信息，请参阅 //Build/ 会议中的[Windows Phone 8：企业开发](http://channel9.msdn.com/Events/Build/2012/2-014)演讲。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-30T18:02:01.437

WP8 中为此明确添加了一项功能。它被称为**公司中心**。

由于 SDK 仅可用几个小时，并且文档正在缓慢地在线分发/更新，因此预计很快就会提供更多详细信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-30T17:10:44.287

这是我对自己感兴趣的事情，这是微软方面关于此的官方博客条目：

[http://blogs.msdn.com/b/windowsstore/archive/2012/04/25/deploying-metro-style-apps-to-businesses.aspx](http://blogs.msdn.com/b/windowsstore/archive/2012/04/25/deploying-metro-style-apps-to-businesses.aspx)

这一切听起来都很棒，但是你会得到这个： [http ://social.technet.microsoft.com/Forums/en-US/w8itproinstall/thread/3092a681-b9cc-473b-83aa-b492ea7f3946](http://social.technet.microsoft.com/Forums/en-US/w8itproinstall/thread/3092a681-b9cc-473b-83aa-b492ea7f3946)

它似乎还没有真正实施。

祝你好运！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-30T17:11:49.263

可以仅为您的公司开发私有 WP8 应用程序并直接分发它们，而不是通过 Windows Phone 商店。
您应该从下载 SDK 开始，网络文档应该很快就会提供。
[http://www.microsoft.com/en-us/download/details.aspx?id=35471](http://www.microsoft.com/en-us/download/details.aspx?id=35471)

# php - 通过加倍反冲在输出中显示“\n\r”

> ID：13144071
> 
> 赞同：1
> 
> 时间：2012-10-30T16:59:48.567
> 
> 标签：php, regex, newline

我如何使用“正则表达式”输出 PHP 的`\n`OR `\r`OR IN 输出？`\n\r`

我知道反弹应该是双重的，但我做不到。

我的代码

```
preg_replace('/(\n|\r)/', '?', $String ); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-30T17:02:06.790

只需使用[`str_replace()`](http://php.net/str_replace)- 您不需要正则表达式：

```
$H = str_replace( "\n", '\n', $H);
$H = str_replace( "\r", '\r', $H); 
```

或者正如马克指出的那样，在一次通话中：

```
$H = str_replace( array( "\n", "\r"), array( '\n', '\r'), $H); 
```

或者，使用两个不必要的正则表达式：

```
$H = preg_replace( "/\n/", '\n', $H);
$H = preg_replace( "/\r/", '\r', $H); 
```

或者，一个正则表达式和一些额外的逻辑：

```
$H = preg_replace_callback( "/(\n|\r)/", function( $match) {
    return $match[1] == "\n" ? '\n' : '\r';
}, $H); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T17:17:14.353

这是您要输出的内容吗？

```
$H = "This is a line with \\n and \\r  and \\r\\n";
$H = "This is a line with " . '\n and ' . '\r and ' . '\r\n'; 
```

或者简单地单引号整个字符串，这样 php 就不会评估转义...

```
$H = 'This is a line with \n and  \r and  \r\n'; 
```

您不需要正则表达式来输出文字 '\n' '\r' 或 '\r\n'。

只需双反斜杠双引号字符串转义或单引号要输出文字的字符串。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T17:20:49.380

试试这个，这可能就是你要找的...

```
$String = preg_replace('/\\n/', '\\n', $String ); 
echo preg_replace('/\\r/', '\\r', $String ); 
```

# css - IE 不会在悬停时显示 ul

> ID：13144078
> 
> 赞同：0
> 
> 时间：2012-10-30T16:59:59.277
> 
> 标签：css, internet-explorer, colors

我无法让 ul li ul 在 IE 中显示。悬停时会出现 ul li ul li 的边框，但您看不到背景或链接。当我将鼠标移到它上面时，它就消失了。适用于所有其他浏览器。我读到的所有内容都说要为 li 添加背景颜色，但事实并非如此。我已经尝试了我能想到的一切，我被卡住了！这是CSS

```
ul.menuDiv { 
    width:998px; 
    height:60px; 
    margin-left:auto; 
    margin-right:auto; 
    z-index:0; 
    list-style:none;
}
ul.menuDiv li.menuItem { 
    position:relative; 
    width: 141px; 
    height:36px; 
    display:block; 
    float:left; 
    border-bottom: 1px solid #960; 
    border-top: 1px solid #960; 
    border-right:1px solid #000; 
    text-align:center; 
    padding-top: 22px; 
    z-index:1; 
}
ul.menuDiv li.menuItem:hover {
    background-color: #D39400;
    cursor:pointer; 
    border-top: 2px inset #000; 
    padding-top: 21px;
}
ul.menuDiv ul.menuSubItemHolder { 
    display:none; background-color:#F9B300;
}
ul.menuDiv li.parent:hover ul.menuSubItemHolder {  
    list-style:none; 
    display:block; 
    visibility:visible; 
    position:absolute; 
    top:57px; 
    left:-1px; 
    width: 200px; 
    background-color:#D39400; 
    z-index:2 
}
ul.menuDiv ul li.menuSubItem { 
    position:relative; 
    display:block; 
    width: 195px; 
    height:30px; 
    background-color:#F9B300; 
    border:1px solid #000; 
    border-top:none; 
    padding: 12px 0 0 5px; 
    text-align:left; z-index:3
} 
```

这是HTML

```
<div class="menuBar shadowBottom">
    <ul class="menuDiv">
        <li class="menuItem first"><a class="mainA" href="site.com">Welcome</a></li>
        <li class="menuItem parent"><a class="mainA" href="site.com"><span>BATH ARMOR&trade;</span></a>
            <ul class="menuSubItemHolder shadow">
                <li class="menuSubItem"><a class="subA" href="site.com">Tub and Shower Liners</a></li>
                <li class="menuSubItem"><a class="subA" href="site.com">Colors and Patterns</a></li>
                <li class="menuSubItem"><a class="subA" href="site.com">Accessories and Features</a></li>
            </ul>
        </li>
    </ul>
</div> 
```

**发现了问题。**CSS 下面的过滤器导致了这个问题。filter:progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=#F9B300, endColorstr=#8E6800);

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T17:10:54.737

您可能只需要根据 IE 的版本指定 doctype，因此它不会进入 quirks 模式，从而产生您遇到的错误。

```
 <!DOCTYPE html> 
```

# java - 在 Java 中使用 OpenGL 将字符串绘制到窗口

> ID：13144079
> 
> 赞同：-2
> 
> 时间：2012-10-30T16:59:59.170
> 
> 标签：java, opengl, lwjgl

> **可能重复：**
> [如何使用 OpenGL 将字符串绘制到窗口？](https://stackoverflow.com/questions/13143344/how-to-draw-a-string-to-the-window-with-opengl)

我正在创建一个简单的 2D 游戏并遇到了问题。我不知道如何在使用 OpenGL 时在屏幕上显示文本。我不能使用 Graphics drawString() 方法，因为我的窗口是 LWJGL 窗口，而不是 JFrame。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T17:06:30.873

[GLUT](http://www.opengl.org/resources/libraries/glut/)有能力做你想做的事，我建议你使用，但你也可以尝试使用`glFontTextOut`with`glFontBegin`和`glFontEnd`enclosure，例如：

```
glFontBegin(font);
glScalef(10.0, 10.0, 10.0);
glFontTextOut("Testing", 5, 5, 0);
glFontEnd(); 
```

# javascript - Dojo 1.8 - 在 require 中创建全局变量

> ID：13144092
> 
> 赞同：5
> 
> 时间：2012-10-30T17:00:57.513
> 
> 标签：javascript, dojo, scope

我注意到在我的团队升级到 Dojo 1.8 后，我正在为一个项目处理的一些遗留脚本不再工作。具体来说，他们创建的全局变量不再被创建。

我四处挖掘，发现 Dojo 1.8 团队非常反对全局变量。如此反对，事实上，它们使用户在物理上不可能在要求的末尾使用以下代码在所需的脚本中创建全局变量：

```
req.eval =
        function(text, hint){
            return eval_(text + "\r\n////@ sourceURL=" + hint);
        };
var eval_ = new Function('return eval(arguments[0]);'); 
```

这太棒了，但是我正在使用的旧代码无法更改，所以我一直在试图弄清楚如何解决这个问题并在本地上下文中执行 eval。

幸运的`dojo.eval`是，旧版本的 Dojo 仍然存在，这正是我想要的。所以我只需要访问`req.eval`并更改要执行的功能，`return dojo.eval(...)`甚至只是`eval(...)`在某些情况下。

问题是，我无法弄清楚如何访问`req`. 这是发生的事情：

`dojo.js`我在我的 HTML 文件顶部包含在脚本标签中。它加载到自己的脚本文件中。

`dojo.require`可以从我自己的文件中访问。它`define`在脚本文件中定义为：

```
'dojo/_base/loader':function(){
define(["./kernel", "../has", "require", "module", "./json", "./lang", "./array"], function(dojo, has, require, thisModule, json, lang, array) { 
```

我不确定这是否重要。无论如何，在 的范围内`dojo.require`，我可以看到名为 的东西`injectModule`，而在我自己的文件中却看不到。 `injectModule`是一个局部变量，所以你不能用`this`. 它在文件开头的匿名函数中定义，即

```
(function(){ ... injectModule = function(){} ... })(); 
```

在`injectModule`函数内部，有以下行：

`req.getText(url, legacyMode!=sync, xhrCallback);`

去`req.eval`。所以`injectModule`可以看到`req`。

我不知道该怎么办。我的邪恶 JavaScript 技巧都没有帮助我开始导航这个范围的僵局。一个好的开始是弄清楚如何`injectModule`从调用`dojo.require`. 不过，我无法使用“bind”来做到这一点，因为它是在匿名函数中定义的局部变量。这甚至可能吗？

为了让事情变得更容易，这里有一个摘要：

文件 1：

```
<script src="dojo.js"></script>
dojo.require(File 3);
console.log(globalVar); 
```

文件 2：

```
(function(){req.eval = unhelpful function})();
define(["require"], function(module){
    dojo.require = function(x){req.eval(x)}
}); 
```

文件 3：

```
globalVar = ...; 
```

我可以修改文件 1 和 3，但文件 3 总是需要一个全局变量。我无法修改文件 2。目标是更改`req.eval`文件 2 以获得更好的功能。

提前声明全局变量不起作用，因为范围更改意味着文件 3 仍然无法看到它。

反射和字符串替换不起作用，因为范围错误并且 JS 在服务器端被缩小。

覆盖文件 1 中的方法不起作用，因为我无法看穿范围。

使用 JavaScript`bind`函数也没有结果。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-01T17:43:54.527

为此，dojo 创建了`dojo.global`. 它将指向`window`已加载 dojo 的位置（适用于框架布局）。

所以像这样声明你的全局变量：

```
require([ "dojo/_base/kernel", ... ] , function(kernel) {
    kernel.global.globalVariable = 1;
    console.log('set')
})

dojo.addOnLoad(function() {console.log('get', globalVariable);}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T11:13:14.480

全局作用域可以通过全局`window`对象访问，`window.foo = 'bar'`与创建全局变量一样`foo`。更多细节在这里：[https ://stackoverflow.com/a/4862268/168382](https://stackoverflow.com/a/4862268/168382)

# regex - 查找和修改模式之后的日期模式

> ID：13144094
> 
> 赞同：2
> 
> 时间：2012-10-30T17:01:06.300
> 
> 标签：regex

我有一个字符串，其中一些日期由模式 FXTKLN 成功。

JHSHSS20NOV2012 GHHSEE23FEB2011 FXTKLN

我的要求是找到模式 FXTKLN 成功的日期 20NOV2012、23FEB2012 并将这些日期替换为 DATE20NOV2012DATE、DATE23FEB2012DATE 等。可以有很多日期 - 而不仅仅是两个。

干杯，珍珠

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T17:03:52.713

> 找到日期 20NOV2012、23FEB2012 由 FXTKLN 模式成功

使用这个正则表达式

```
\d{1,2}[a-zA-Z]{3}\d{4}(?=.*?FXTKLN) 
```

以上`regex`包含

```
\d{1,2}// matches 1 to 2 digits
[a-zA-Z]{3} //matches 3 characters 
\d{4} //matches 4 digits
(?=.*?FXTKN) //checks if the date is followed by FXTKN considering multile dates before it! 
```

> 我必须用 DATE20NOV2012DATE 替换这些日期

使用这个现在使用组的正则表达式

`(\d{1,2}[a-zA-Z]{3}\d{4})(?=.*?FXTKLN)`

然后将其替换为

`DATE$1DATE`

# javascript - 用于获取项目列表的 AJAX 环回 - 好主意吗？

> ID：13144095
> 
> 赞同：0
> 
> 时间：2012-10-30T17:01:06.803
> 
> 标签：javascript, ajax, loops, recursion

我有一个脚本`index.php`，它通过 AJAX 动态加载在`ajax.php`.

如果项目太多，该列表可能不会包含所有需要的项目。在这种情况下，我想给用户一个按钮*显示所有*将再次加载`ajax.php`但请求所有项目的项目。

我有一个想法，它`ajax.php`会呼应这个按钮。按下时，`ajax.php`将动态调用自身，但所有项目都有一个 GET 参数。这是个好主意吗？

谢谢！

这是简化的代码：

**索引.php**

```
<div id="ajax-out" />
<script> 
    $.get("ajax.php", function(out){
        $("#ajax-out").html(out);
    });
</script> 
```

**ajax.php**

```
... list of items ...

<?php if the list isn't complete, print code below: ?>

    <a id="show-all">Show all items</a>

    <script>
        $("#show-all").click(function() {
            $.get("ajax.php?show_all", function(out){ // there's the loopback!
                $("#ajax-out").html(out);
            });
        });
    </script> 
```

我只是有另一个想法。`ajax.php`如果列表完整，将返回包含列表的 HTML 代码的 XML 和一个参数。然后`index.php`可以打印*显示所有项目*按钮并调用`ajax.php?show_all`自身。你怎么看？谁应该是呼叫者？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T17:08:04.037

> ajax.php 将动态调用自身，但所有项目都有一个 GET 参数

如果我没看错，就会有多个 ajax 调用只是为了得到一个列表。

为什么不一次调用 ajax 并让它返回整个列表呢？不必要的多个 ajax 调用效率非常低，即使它们是异步的并且在技术上不会“阻止”页面其余部分的加载。

# lua - 如何在保持精度的同时限制 Lua 中的数字？

> ID：13144096
> 
> 赞同：4
> 
> 时间：2012-10-30T17:01:07.047
> 
> 标签：lua, numbers, limit

原始信息：

> 我需要将两个 64 位数字相乘，但 Lua 会因大数字而失去精度。（例如 99999999999999999 显示为 100000000000000000） 相乘后，我需要一个**64 位解决方案**，因此我需要一种方法将解决方案限制为 64 位。（我知道，如果解决方案是精确的，我可以使用*% 0x10000000000000000*，这样也可以）

**编辑：**有了 Lua 5.3 和新的 64 位整数支持，这个问题就不再存在了。整洁的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T17:23:09.667

Lua 对所有数学都使用双精度浮点数，包括整数运算（参见[http://lua-users.org/wiki/FloatingPoint](http://lua-users.org/wiki/FloatingPoint)）。这为您提供了大约 53 位的精度，这（正如您所注意到的）比您需要的要少。

有几种不同的方法可以在 Lua 中获得更好的精度。您最好的选择是找到最积极的此类努力并加以利用。在这种情况下，您的问题已经得到解答；查看[Lua 的标准（或最受支持的）大数（任意精度）库是什么？](https://stackoverflow.com/questions/288707/what-is-the-standard-or-best-supported-big-number-arbitrary-precision-librar)

如果你的 Lua 发行版有它的包，简单的答案是[lmapm](http://www.tecgraf.puc-rio.br/~lhf/ftp/lua/#lmapm)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T18:49:43.640

如果使用[LuaJIT](http://luajit.org/)代替 Lua，则可以访问所有 C99 内置类型，包括`long long`通常为 64 位的类型。

```
local ffi = require 'ffi'

-- Needed to parse constants that do not fit in a double:
ffi.cdef 'long long strtoll(const char *restrict str, char **restrict endptr, int base);'

local a = ffi.C.strtoll("99999999999999999", nil, 10)
print(a)
print(a * a) 
```

=> `3803012203950112769LL` (assuming the result is truncated to 64 bits)

# html - 如何在 Blackberry 10 Dev Alpha Simulator 中获得大于 311 x 211 的 html5 画布

> ID：13144099
> 
> 赞同：0
> 
> 时间：2012-10-30T17:01:14.600
> 
> 标签：html, qt, canvas, webview, blackberry-simulator

我正在尝试在 qml WebView 中使用 C++ QT QML Blackberry 10 Cascades Beta 3 在 VMWare 中运行的 Blackberry 10 Dev Alpha Simulator 中的 html5 画布中显示图形。我在发生这种情况时遇到了问题，但我尝试了来自：[http](http://www.w3schools.com/html/tryit.asp?filename=tryhtml5_canvas_first) ://www.w3schools.com/html/tryit.asp?filename=tryhtml5_canvas_first 的 html5 示例，这是以下代码...

```
<!DOCTYPE html>
<html>
<body>

<canvas id="myCanvas" width="200" height="100" style="border:1px solid #c3c3c3;">
Your browser does not support the HTML5 canvas tag.
</canvas>

<script>

var c=document.getElementById("myCanvas");
var ctx=c.getContext("2d");
ctx.fillStyle="#FF0000";
ctx.fillRect(0,0,150,75);

</script>

</body>
</html> 
```

然后经过一些测试，只有当我保持宽度不超过 311 且高度不超过 211 时，才会显示红色方块。但我需要让我的 webview 中的 html5 画布中的图形内容大于那个。有谁知道这个问题的任何解决方案？

# c# - HQL选择组内具有最大值的实体的ID

> ID：13144100
> 
> 赞同：0
> 
> 时间：2012-10-30T17:01:17.480
> 
> 标签：c#, sql, hibernate, hql

我有这个小实体

```
class Order
{
    public long Id;
    public DateTime Date;
    public long ProductId;
} 
```

我想选择在按 .分组的订单`Id`中具有的实体。对 ( , ) 不是唯一的，所以这个查询是错误的：`MAX(Date)``ProductId``MAX(Date)``ProductId`

```
select o.Id 
from Order o 
where o.Date = 
   (select max(o2.Date) 
    from Order o2 
    where o2.ProductId = o.ProductId); 
```

你有什么想法？

基本上我想要的是从组中获取最新的订单，所以如果我假设更大`Id`== 更新`Order`这个：

```
select o 
from Order o 
where o.Id in 
   (select max(o2.Id) 
    from Order o2 
    group by o2.ProductId); 
```

会为我工作。有没有更好的解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T12:27:12.683

查询需要优化，但它适合你。

```
List<Order> orders = GetOrders();

        var result = from o in orders
                      group o by new { o.ProductId } into ordGrouping
                      let MaxOrderDate = ordGrouping.Max(od=>od.Date)
                      let OrderID = ordGrouping.First(od=>od.Date.Equals(MaxOrderDate)).Id
                      select new 
                      { 
                          ProductId = ordGrouping.Key.ProductId, 
                          OrderId = OrderID,
                          OrderDate = MaxOrderDate
                      };

        foreach (var item in result)
        {
            Console.WriteLine(string.Format("Product ID:{0}, OrderId: {1} Date: {2}", item.ProductId, item.OrderId, item.OrderDate.ToLongDateString() + item.OrderDate.ToLongTimeString()));
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T18:25:43.907

尝试*自我加入*而不是查询以获得更好的性能*。*

# redirect - Joomla setRedirect 不起作用

> ID：13144101
> 
> 赞同：2
> 
> 时间：2012-10-30T17:01:18.827
> 
> 标签：redirect, joomla, joomla2.5, joomla-extensions

我有一个简单的 Joomla 控制器，但我无法重定向任何东西。

根据文档：

```
class MyController extends MyBaseController {

 function import() {
    $link = JRoute::_('index.php?option=com_foo&ctrl=bar');
    $this->setRedirect($link);
  }

}
//The url contains &amp; html escaped character instead of "&" 
```

这应该可以，但我得到一个格式错误的 URL。我在这里缺少什么吗？为什么 Joomla 将所有“&”字符转换为`&amp;`'s？我应该如何使用 setRedirect？

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-30T17:13:55.247

好吧，我修好了。因此，如果有人需要它：

代替

```
$link = JRoute::_('index.php?option=com_foo&ctrl=bar');
$this->setRedirect($link); 
```

利用

```
$link = JRoute::_('index.php?option=com_foo&ctrl=bar',false);
$this->setRedirect($link); 
```

让它工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T01:20:35.717

Glad you found your answer, and by the way, the boolean parameter in `JRoute::_()` is by default true, and useful for xml compliance. What it does is that inside the static method, it uses the htmlspecialchars php function like this: `$url = htmlspecialchars($url)` to replace the & for xml.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-31T04:21:00.703

尝试这个。

```
$mainframe = &JFactory::getApplication();
$mainframe->redirect(JURI::root()."index.php?option=com_foo&ctrl=bar","your custom message[optional]","message type[optional- warning,error,information etc]"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-31T06:38:47.000

检查 Joomla 源代码后，您可以快速了解发生这种情况的原因：

```
if (headers_sent())
    {
        echo "<script>document.location.href='" . htmlspecialchars($url) . "';</script>\n";
    }
    else
    {
    ... ... ... 
```

问题是您的页面可能已经输出了一些数据（通过回显或其他方式）。在这种情况下，Joomla 被编程为使用简单的 javascript 重定向。但是，在此 javascript 重定向中，它已将 htmlspecialchars() 应用于 URL。

一个简单的解决方案是不使用 Joomlas 函数并以更有意义的方式直接编写 javascript：

```
echo "<script>document.location.href='" . $url . "';</script>\n"; 
```

这对我有用:)

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2016-06-19T14:11:27.047

/libraries/joomla/application/application.php

查找第 400 行

```
 // If the headers have been sent, then we cannot send an additional location header
    // so we will output a javascript redirect statement.
    if (headers_sent())
    {
        echo "<script>document.location.href='" . htmlspecialchars($url) . "';</script>\n";
    } 
```

替换为

```
 // If the headers have been sent, then we cannot send an additional location header
    // so we will output a javascript redirect statement.
    if (headers_sent())
    {
        echo "<script>document.location.href='" . $url . "';</script>\n";
    } 
```

这行得通！

# facebook - 使用 FQL 检索使用 My Facebook Application 的所有用户的 Facebook 状态

> ID：13144102
> 
> 赞同：4
> 
> 时间：2012-10-30T17:01:22.863
> 
> 标签：facebook, facebook-graph-api, facebook-fql

我想检索使用我的 Facebook 应用程序的所有用户的状态。我对检索用户的朋友状态不感兴趣，只对检索正在使用我的 Facebook 应用程序并已授予我的应用程序“read_stream”权限的用户感兴趣。

我可以通过调用成功检索登录用户或登录用户的朋友之一的状态：

```
SELECT post_id, message, attachment, type FROM stream WHERE source_id = "SOME ID" AND type IN (46, 247) 
```

但这不是我的目标。我想获得“所有”使用我的 Facebook 应用程序的用户，并在没有任何特定用户登录的情况下获得他们的最新状态提要。

例如：我现在也没有登录facebook，你也没有。但是，当您单击下面的链接时，您将获得该特定用户的 RSS 提要。该用户实际上是一个业务页面，因此它对公众开放。点击此[链接](https://www.facebook.com/feeds/page.php?format=rss20&id=152237754851522)

我想从允许我的应用程序“读取流”权限的用户那里检索此信息。

我无法在个人 Facebook 用户页面上检索此信息。所以我的印象是我需要构建一个 Facebook 应用程序来做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T17:40:52.447

无法检索应用用户的用户 ID 列表，如果您已经拥有用户 ID，则您已经拥有正确的查询格式 - 您只需使用用户的访问令牌进行调用

此处介绍了您无法检索列表的事实：[Facebook。如何获取我的应用程序的所有用户的列表？](http://facebook.stackoverflow.com/questions/10071000/facebook-how-to-get-list-of-all-users-of-my-app)

如果您需要所有用户的状态更新，您可能应该使用[实时更新](https://developers.facebook.com/docs/reference/api/realtime/)API 在用户添加新消息时向您的应用发送通知，然后您可以使用缓存的 [并且仍然有效的] 访问令牌该用户检索新消息

# java - GAE 数据存储阵列初始化抛出：不支持 FK 阵列

> ID：13144112
> 
> 赞同：0
> 
> 时间：2012-10-30T17:02:01.503
> 
> 标签：java, arrays, google-app-engine, datastore

我正在尝试将数组对象保存在实体类中，我想将其存储在 GAE 数据存储中。可悲的是，当我尝试初始化数组时，我遇到了一个异常。

我收到此错误：

> java.lang.UnsupportedOperationException：不支持 FK 数组。

我的课看起来像这样：

```
@Entity
public class Game {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Key key;
    ...
    @Persistent
    private Profile[] players = new Profile[4];
    ...
    public void setPlayers(Profile player) {
        if (pcount.intValue() < 4) {
            this.players[pcount] = player; //Here I get the exception
            pcount = Integer.valueOf(pcount.intValue() + 1);
        }
    }
} 
```

`Profile`也是一个实体类。

什么地方出了错？我怎么能解决这个问题。如果有人可以向我解释，那就太好了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T18:39:45.700

您需要将您的`Profile`实体注释为`@Embeddable`并在您的`Game`实体中将`players`字段注释为`@Embedded`。有关 JPA 注释的详细信息，请查看[JPA 2 Annotations](http://www.objectdb.com/api/java/jpa/annotations)。这样，所有文件都`Profile`将显示为您`Game`实体的内联字段。如果您只想保留`Game`实体对实体的引用，则可以使用and not`Profile`的数组。例如，`Key``Profile`

```
private Key[] players = new Key[4]; 
```

希望这可以帮助。

# mysql - 带有int的mysql查询字符串字段，返回等效于（'int-％'）

> ID：13144113
> 
> 赞同：1
> 
> 时间：2012-10-30T17:02:04.280
> 
> 标签：mysql

这是我注意到的一种奇怪的怪癖，我真的只是想看看是否有人可以提供有关其发生原因的见解。

假设我们有一个名为“account”的字段，它是一个 varchar(x)

这两个查询将返回相同的结果集。

```
SELECT * FROM table WHERE account = 1234;
SELECT * FROM table WHERE account LIKE '1234%'; 
```

我在为迁移一些旧数据而编写的脚本中偶然发现了这一点，但我不小心忘记了封装我的字符串。

谁能告诉我为什么会发生这种行为？

* * *

更新：

我觉得我可能没有很好地解释这一点，所以我将提供一个示例表：

table_name: id - INT 帐户 - varChar(50)

条目：

```
ID - account
1 - "1"
2 - "12"
3 - "123"
4 - "1234" 
```

所以：

**1：**

```
SELECT * FROM table_name WHERE account LIKE '1%' 
```

将返回条目 1、2、3、4

**2：**

```
SELECT * FROM table_name WHERE account = 1 
```

将返回条目 1、2、3、4

**3：**

```
SELECT * FROM table_name WHERE account = '1' 
```

将返回条目 1

为什么1和2一样，为什么2和3不一样

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T17:05:54.643

这是因为 % 是一个元字符，表示任意数量的字符，包括零字符。`Like`关键字查找以 1234 开头的模式。由于 account = 1234 也与条件匹配，因此您会得到相同的结果。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-30T17:05:02.590

[http://dev.mysql.com/doc/refman/5.0/en/type-conversion.html](http://dev.mysql.com/doc/refman/5.0/en/type-conversion.html)

“...MySQL 会根据需要自动将数字转换为字符串，反之亦然。”

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-30T20:22:39.503

我认为此时已发现这是一个 MYSQL 错误，我提交了错误报告 ID #67427，如果有人有兴趣获得更新，我会指导您通过[http://bugs.mysql.com/查看它](http://bugs.mysql.com/)

# javascript - JavaScript/jQuery - 基于长度验证

> ID：13144114
> 
> 赞同：0
> 
> 时间：2012-10-30T17:02:05.457
> 
> 标签：javascript, jquery, regex

我正在制作一个简单的表格，我需要根据英国邮政编码进行验证。没问题，但我需要根据字符长度进行验证。用户可以只输入邮政编码的前半部分（即 SW1）或完整的邮政编码（即 SW1 1AB）。

我认为最好的方法是检查 KeyPress 上的长度并针对 RegEx 验证半个邮政编码或整个事情。见下文：

```
jQuery('.ValPostCode').keyup(
    function(){

        if (jQuery(this).length < 5){
            jQuery.validator.addMethod("ValPostCode", function(value, element) {
                return this.optional(element) || /([A-PR-UWYZa-pr-uwyz]([0-9]{1,2}|([A-HK-Ya-hk-y][0-9]|[A-HK-Ya-hk-y][0-9]([0-9]|[ABEHMNPRV-Yabehmnprv-y]))|[0-9][A-HJKS-UWa-hjks-uw]))/.test(value);
            }, "Please enter a valid postcode");                            
        } else if (jQuery('.ValPostCode').length > 4) {
             jQuery.validator.addMethod("ValPostCode", function(value, element) {
            return this.optional(element) || /^(GIR\\s{0,1}0AA|[A-PR-UWYZ]([0-9]{1,2}|([A-HK-Y][0-9]|[A-HK-Y][0-9]([0-9]|[ABEHMNPRV-Y]))|[0-9][A-HJKS-UW])\\s{0,1}[0-9][ABD-HJLNP-UW-Z]{2})$/.test(value);
            }, "Please enter a valid postcode");
        }

    }); 
```

因此，如果 char 的长度`.ValPostCode`小于 5，则它仅验证英国邮政编码的前半部分，否则它会检查完整且有效的英国邮政编码。

有一次我在输出长度，`.ValPostCode`但它总是停在 1（第一次按键），然后不再继续（即不会随着后续按键计数）。

我希望我已经足够清楚地解释了自己，如果我不清楚，请告诉我。

我已经搜索了类似的问题来尝试为自己解决这个问题，但我找不到任何东西。任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T17:06:01.153

`$(selector).length`（或）的长度`jQuery(selector).length`将始终是屏幕上与给定选择器匹配的元素数。尝试使用`$(selector).val().length`获取表单元素的值并检查其长度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T17:15:26.250

似乎您不必要地在每个按键上设置验证器规则

当页面第一次加载时，你应该只需要调用这样的东西：

```
jQuery.validator.addMethod("ValPostCode", function(value, element) {
    if(value.length < 5) {
        return (insert partial postcode check here);
    } else {
        return  (insert whole postcode check here);
    }
}, "Please enter a valid postcode"); 
```

并且应该只调用一次。JQuery 将根据其配置方式在提交/更改时获取错误。

所以不需要 keyUp 事件。

您遇到的主要问题（正如其他人已经指出的那样）是您返回的是 jQuery 对象的长度而不是其 value 属性的长度。

# html - 提交表单不显示变量

> ID：13144118
> 
> 赞同：0
> 
> 时间：2012-10-30T17:02:13.693
> 
> 标签：html, php

当我提交表单时，会向我的电子邮件地址发送一封电子邮件，其中包含在表单中输入的详细信息，但是当我收到电子邮件时，数据为空白，这是我的代码

```
 <?php
$form = '<form action="test2.php" method="POST">
<table width="300" style="border: 1px solid black;">
<tr>
<td>Name         &nbsp; <td><input type="text" id="name">
<tr>
<td>Phone Number &nbsp; <td><input type="text" id="telephone">
<tr>
<td colspan="2">
<input type="submit" name="submit" value="submit"/></div>
</tr>
</table>';

echo $form;
$to = 'redacted@redacted.redacted';
$name = $_POST['name'];
$telephone = $_POST['telephone'];

$body = "<div>Name: $name <br>Telephone Number: $telephone<br></div>";

// subject
$subject = 'Call Back Requested';

// message
$message = $body;

// To send HTML mail, the Content-type header must be set
$headers  = 'MIME-Version: 1.0' . "\r\n";
$headers .= 'Content-type: text/html; charset=iso-8859-1' . "\r\n";

// Additional headers
$headers .= 'To:' . "\r\n";
$headers .= 'From: Call Back Request <contact-us-form@yellowgrid.co.uk>' . "\r\n";

if(isset($_POST['submit'])){

mail($to, $subject, $message, $headers);
}

?> 
```

问题是当我提交表单时，我收到一封电子邮件，上面写着

姓名（无） 电话号码（无）

谁能告诉我哪里出错了

提前致谢

亚当

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T17:04:34.417

您必须为`name`输入指定属性：

```
<input type="text" id="name" name="name">
<input type="text" id="telephone" name="telephone"> 
```

代替

```
<input type="text" id="name">
<input type="text" id="telephone"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T17:06:11.373

快速浏览后，您应该交换 $body 以阅读

```
$body = '<div>Name: ' . $name . '<br>Telephone Number: ' . $telephone . '<br></div>'; 
```

试试看它是否有效

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T17:19:04.810

您在关闭标签中有很多错误.. 使用 echo 显示整个 html 表单是一种不好的做法.. 看看这段代码：

```
<?php

    extract($_POST);

    if ( isset($submit) )
    {
        $to = 'adam.albison@yellowgrid.co.uk';

        $body = "<div>Name: $name <br>Telephone Number: $telephone<br></div>";
        $subject = 'Call Back Requested';
        $message = $body;

        $headers  = 'MIME-Version: 1.0' . "\r\n";
        $headers .= 'Content-type: text/html; charset=iso-8859-1' . "\r\n";
        $headers .= 'To:' . "\r\n";
        $headers .= 'From: Call Back Request <contact-us-form@yellowgrid.co.uk>' . "\r\n";

        mail($to, $subject, $message, $headers);
    }

?>

<html>
    <form action="test2.php" method="POST">
        <table width="300" style="border: 1px solid black;">
            <tr> 
                <td>Name &nbsp; </td>
                <td> <input type="text" id="name" name="name" /> </td>
            </tr>
            <tr>
                <td>Phone Number &nbsp; </td>
                <td> <input type="text" id="telephone" name="telephone" /> </td>
            </tr>
            <tr>
                <td colspan="2"> <input type="submit" name="submit" value="submit"/> </td>
            </tr>
    </form>
</html> 
```

# .net - 加密的应用程序不在一台机器上运行

> ID：13144119
> 
> 赞同：0
> 
> 时间：2012-10-30T17:02:39.730
> 
> 标签：.net, obfuscation, net-reactor

我使用 Eziriz .Net Reactor 来保护我们的 dll 和 exe 免受逆向工程的影响。它多年来一直运行良好。

就在今天，在一台机器上，受保护的应用程序停止运行。它与之前运行的文件版本完全相同，并且完全相同的文件可以在其他几台机器上运行。

我不明白这台机器可能出了什么问题。所有其他软件都可以正常工作。如果不受保护，则相同的应用程序代码可以工作，但如果受到保护，则会失败。没有显示错误。我只是尝试运行exe，该过程启动然后再次关闭。

这台机器唯一不同的是，我最近一直在安装和卸载许多第三方软件。.Net Reactor 是否依赖于某些可能已损坏的系统设置、注册表设置等？

如果必须，我会擦拭机器并重新安装 Windows - 但我不想这样做。我也想了解哪里出了问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T04:07:06.270

I also encounter similar issues with **Eziriz Rector** and **Intellilock** recently when I received Windows update including 3rd party software updates.

I have to "protect" my application by de-selecting all protection options, then adding each option back one after another to find out which is causing problems with other software. For example, just last month one option causes the application to be recognized as a "mal-ware" by Avira after the antivirus software get updated.

I think the bigger problem is we have no idea what 3rd party software the clients have on their machine, and yet I have to programmatically find out the compatibility issue before installation of the distribution. Perhaps someone has better ideas.

# fiddler - 在使用 IPSEC 的域/网络上，如何在 Windows Phone 8 SDK 中使用 Fiddler（或等效）和模拟器？

> ID：13144120
> 
> 赞同：5
> 
> 时间：2012-10-30T17:02:41.470
> 
> 标签：fiddler, hyper-v, ipsec, windows-phone-8

现在 WP8 Emulator 基于 Hyper-V，如果网络使用 IPSEC，则使用 Fiddler 拦截网络流量的旧方法不起作用。

在这种情况下有没有办法使用 Fiddler 和 WP8 模拟器？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-30T20:31:07.747

[与 WP7 ( https://fiddler2.com/fiddler/help/phone.asp](https://fiddler2.com/fiddler/help/phone.asp) )设置完全相同的提琴手对我来说绝对没问题。

您从主机系统获取流量，因此来宾（WP8 模拟器）也必须绕过它。

如果它不起作用，请告诉我，但对于我和我认识的其他人来说，它运行没有任何问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-29T10:05:25.437

我终于在[http://msdn.microsoft.com/en-us/library/windowsphone/develop/jj684580(v=vs.105).aspx找到了答案](http://msdn.microsoft.com/en-us/library/windowsphone/develop/jj684580(v=vs.105).aspx)

> 在公司域中，模拟器显示为未加入域的单独网络设备。因此，**您可能还必须先从 IT 部门获得例外，**然后模拟器才能连接到在加入域的开发计算机上运行的服务。

需要网络安全例外。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-30T18:37:24.857

您可能必须使用类似[wireshark](http://www.wireshark.org/)的东西，它在子协议级别工作，因此可以拦截任何东西。

请注意，分析不会像在 Fiddler 中那样容易。此外，由于协议和证书等带来的整个中间人攻击防护，HTTPS 连接可能无法分析。

# pdf - PostScript - 超链接表，但只有一个链接用于所有

> ID：13144121
> 
> 赞同：2
> 
> 时间：2012-10-30T17:02:42.570
> 
> 标签：pdf, postscript

要求是在 pdf 中显示一些文本，其中包含指向站点/pdf/etc 的超链接 - 类似于您将看到的 HTML，请单击此处并在此处打开一个链接。

我正在使用 PlanetPress 创建 pdf，它基本上是添加了维生素和铁的 PostScript 代码。

当在文本中找到 http:// 时，Acrobat 会自动创建链接，因此 PlanetPress 不会直接处理链接（因为它们是由 Acrobat 自动创建的）。

我可以通过直接通过 PlanetPress 传递 PDFMark PostScript 代码来创建满足我们要求的静态链接，但是当我尝试对多行代码动态执行相同操作时，列表中的最终链接将成为每一行的链接。

在 PlanetPress 中，我基本上是循环遍历一个 XML 文件并将结果发送到 .ps 文件。

这是我的 PDFmarks 代码：

```
 passthrough('[ /Rect [ 0 0 16 '+inttostr(floattoint(&j))+' ]')
        passthrough('/Action << /Subtype /URI /URI ('+&CentreCodeLink+') >>')
        passthrough('/Count '+IntToStr(&i)+'')
        passthrough('/Subtype /Link')
        passthrough('/Border [ 1 1 1 ]')
        passthrough('/ANN pdfmark') 
```

我已经使用 /count 字段来确定正在读取/传递到 PostScript 文件的不同值。我使用 /rect 和 /border 字段来创建超链接区域。我认为矩形将是超链接区域的边界，但事实并非如此。我尝试使用 moveto 来确保光标沿页面移动，但这对最终结果完全没有影响。passthrough(' '+inttostr(floattoint(&width*72))+' '+inttostr(floattoint(&j))+'moveto')

我真的不知道 PostScript，但我认为这是两个链接输出的一部分（我已经切断了链接，因为它们是真正的链接）

```
0 0 *m
213.9994 30.00256 *m
0 35.00296 *m
*gr
*gs
[1 0 0 1 0 70.75305]concat
 /^PP$ {systemdict /show get exec} *bd
&body /$ 1 index 2 get store /_ 1 index 6 get store 1 get *sf
 /^PP$ {systemdict /show get exec} *bd
&bold /$ 1 index 2 get store /_ 1 index 6 get store 1 get *sf
36 12.00037 *m
36 12.00037 *m (London - Hammersmith) $
165.6 12.00037 *m
&weblinkstyle dup 0 get [9 0 0 -9 0 0] *mf *sf
 /^PP$ {systemdict /show get exec} *bd
[] 0 setdash
/$ 1 index 5 get dup 0 {1 1 0 0 *sc}*bi put store /_ exch 8 get dup 0 {1 1 0 0 *sc}*bi put store
165.6002 12.00037 *m (London - Angel) $
([ /Rect [ 0 0 540 16 ]) cvx exec
(/Action << /Subtype /URI /URI \(http://WelcomePacka5LondonAngel/\) >>) cvx exec
(/Count 1) cvx exec
(/Subtype /Link) cvx exec
(/Border [ 1 1 1 ]) cvx exec
(/ANN pdfmark) cvx exec
( 540 16 moveto) cvx exec
 /^PP$ {systemdict /show get exec} *bd
&bold /$ 1 index 2 get store /_ 1 index 6 get store 1 get *sf
36 24.00073 *m
36 24.00073 *m (London - London Bridge) $
165.6 24.00073 *m
&weblinkstyle dup 0 get [9 0 0 -9 0 0] *mf *sf
 /^PP$ {systemdict /show get exec} *bd
[] 0 setdash
/$ 1 index 5 get dup 0 {1 1 0 0 *sc}*bi put store /_ exch 8 get dup 0 {1 1 0 0 *sc}*bi put store
165.6002 24.00073 *m (London - Bridge / Borough High Street) $
([ /Rect [ 0 0 540 28 ]) cvx exec
(/Action << /Subtype /URI /URI \(http://WelcomePacka5LondonBridge/\) >>) cvx exec
(/Count 2) cvx exec
(/Subtype /Link) cvx exec
(/Border [ 1 1 1 ]) cvx exec
(/ANN pdfmark) cvx exec
( 540 28 moveto) cvx exec
 /^PP$ {systemdict /show get exec} *bd 
```

任何想法为什么这些不起作用？我在想也许我需要在每个 pdfmark 框之间休息一下，因为它们现在似乎共享一个边框，但我不知道该怎么做。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T19:20:36.407

`/Rect`确实定义了链接的矩形。但看起来代码的矩形左下角值为 0，所有矩形都为 0。所以矩形是重叠的，因此顶部的（最后一个创建的）将是单击时被激活的那个。请记住，`/Rect`is `[ "lower left x" "lower left y" "upper right x" "upper right y" ]`，所以前两个值定义了矩形的左下角，最后两个值定义了矩形的右上角。

> *“现在我只需要弄清楚如何使用所有 4 个点重复地重绘矩形”*

我不确定我是否理解这个额外的问题。你是在问，“现在我已经为超链接的 /Rect 设置了正确的值，我该如何在那里绘制一个矩形？”

要查找矩形的所有四个点，您只需使用`/Rect` 值中的信息。例如，假设`/Rect [ 70 680 110 690 ]`，则矩形的四个点是 (70,680)、(70,690)、(110,680) 和 (110,690)。您可以使用适当的绘图命令来绘制该矩形。

# html - GWT：使用旋转在 context2D 上绘制 ImageElement

> ID：13144122
> 
> 赞同：1
> 
> 时间：2012-10-30T17:02:49.503
> 
> 标签：html, gwt

我正在寻找一种通过图像旋转在 context2D 上绘制图像的方法。我试过了：

```
imageElement.getStyle().setProperty("transform", "rotate(-45deg)"); 
```

它不起作用，图像没有旋转。还有其他旋转图像的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T17:23:28.717

使用[`setTransform`](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/canvas/dom/client/Context2d.html#setTransform%28double,%20double,%20double,%20double,%20double,%20double%29)方法将变换应用于`Context2D`，则`drawImage`。

# .net - 终止服务器上的会话标识符

> ID：13144125
> 
> 赞同：5
> 
> 时间：2012-10-30T17:02:53.600
> 
> 标签：.net, session, security, session-cookies

我们已经对我们的网站进行了安全测试，并且发现了一个漏洞。

**问题**

> 如果可以访问用户工作站的攻击者知道会话标识符，则可以在用户终止会话后使用会话 cookie 访问已注销的会话。

**推荐**

> 确保调用注销功能时会话标识符在服务器端正确终止。

**代码**

代码当前执行此操作（如果用户单击“注销按钮”）

```
 FormsAuthentication.SignOut();
        Roles.DeleteCookie();
        Session.Clear(); 
```

我不确定如何检查“确保在调用注销功能时在服务器端正确终止会话标识符”。

我已经做了一些研究，并认为我应该这样做吗？

```
 Session.Abandon(); 
```

如果没有，我该怎么办？（我不完全确定如何测试这个......）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-03T08:41:57.780

在 ASP.net`Session.Abandon()`中不足以完成此任务，它不会从用户浏览器中删除会话 ID cookie，因此对同一应用程序的任何新请求，在会话被放弃后，将使用相同的会话 ID 和新的会话状态实例！[正如微软在这里所说](http://support.microsoft.com/kb/899918)。您需要放弃会话**并**清除会话 ID cookie：

```
Session.Abandon();
Response.Cookies.Add(new HttpCookie("ASP.NET_SessionId", "")); 
```

在您的`web.config`文件中更改表单身份验证 cookie 名称也是一个好习惯：

```
<authentication mode="Forms">
  <forms name=".CookieName" loginUrl="LoginPage.aspx" />
</authentication> 
```

这是一篇关于[会话攻击和 ASP.NET](http://software-security.sans.org/blog/2009/06/24/session-attacks-and-aspnet-part-2)以及如何解决它的好文章。

# string - 在 Visual Studio 2010 的 C++ 文本编辑器中更改字符串的颜色

> ID：13144127
> 
> 赞同：0
> 
> 时间：2012-10-30T17:02:58.333
> 
> 标签：string, visual-studio-2010, colors

我很好奇是否有人能告诉我如何让 std::string 颜色本身就像一个原始颜色一样。我一直在我的家用机器上使用 2012，我真的很喜欢它，并且已经习惯了让它们着色，在我实习的一家公司，因为我使用的是 2010，但不知道我会在字体和颜色上改变什么. 谢谢，也......对不起这个非常卑鄙的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T17:33:36.543

您是否尝试过搜索模板，例如在此页面 [studiostyl](http://studiostyl.es/)

然后你必须去工具 -> 选项 -> 导入和导出设置

# ruby - Chef : 作为另一个用户创建一个进程

> ID：13144130
> 
> 赞同：2
> 
> 时间：2012-10-30T17:03:17.643
> 
> 标签：ruby, chef-infra, win32-process

所以我有一些代码可以作为特定用户运行批处理文件。这是我尝试自动化以下语法

```
runas /user:thisguy "C:\ThisGuysScript.bat" 
```

所以它在Ruby中看起来像这样

`Process.create(:command_line => "C:\\ThisGuysScript.bat ", :domain => "MYServer", :with_logon => "thisguy", :password => "thisguyspassword", :cwd =>"C:\\")`

所以我试着把这个放在厨师和灾难袭击的食谱中

```
require 'win32/process'

::Process.create(:command_line => "C:\\ThisGuysScript.bat ", :domain => "MYServer", :with_logon => "thisguy", :password => "thisguyspassword", :cwd =>"C:\\") 
```

失败并出现以下错误

```
[Tue, 30 Oct 2012 15:57:03 +0000] FATAL: ArgumentError: You must supply a name when declaring a user resource 
```

所以似乎没有意识到我想使用win32风味的过程。Chef 似乎覆盖了 win32 模块（我知道食谱是 opscode DSL 而不是真正的 ruby​​ 对吗？）

任何人都能够得到这个工作？或具有不同实现的相同功能。检查了 windows 食谱，但没有发现太多

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T11:12:12.510

听起来你想制作一个 LWRP 来在 Windows 机器上创建一个进程。

你得到的错误意味着你有类似的东西

```
user do # Missing name
  gid 500
  home "..."
end 
```

正确的语法是

```
user "apache" do # or whatever the user name should be
   # ...
end 
```

如果您的食谱中没有上述内容，则包含的文件可能有一个名为 user 的变量，这也会导致此问题。

为了回答您的子问题，Chef 是纯红宝石，具有一些可用的功能和运行事物的框架。请注意，厨师运行有几个阶段。我认为您在编译阶段遇到了问题。

制作 LWRP 似乎是要走的路。如果你不想走那么远，你可以做类似的事情。

```
ruby_block "Firing process lazers" do
   require 'win32/process'
   ::Process.create(:command_line => "C:\\ThisGuysScript.bat ", :domain => "MYServer", :with_logon => "thisguy", :password => "thisguyspassword", :cwd =>"C:\\")
end 
```

# c# - 将我的数据有效负载提交到 urbanairship 时出现 401 错误

> ID：13144132
> 
> 赞同：0
> 
> 时间：2012-10-30T17:03:29.343
> 
> 标签：c#, push-notification, apple-push-notifications, urbanairship.com

我正在尝试使用 C# 通过 UrbanAirship 向我的 ipod 发送测试通知。我尝试了许多代码片段，试图从我的 Windows 服务器向 UrbanAirship 发送通知，但我总是以 401 错误告终。

这是我的最新代码：

```
string postData = "{\"aps\": {\"badge\": 1, \"alert\": \"Hello from Urban Airship!\"}, \"device_tokens\": [\""+ devToken +"\"]}";

var uri = new Uri("https://go.urbanairship.com/api/push/");
var encoding = new UTF8Encoding();
var request = (HttpWebRequest)WebRequest.Create(uri);
char[] charArray = Encoding.UTF8.GetChars(Encoding.UTF8.GetBytes(postData));
request.Method = "POST";
request.Credentials = new NetworkCredential(username, password);
request.ContentType = "application/json";
request.ContentLength = encoding.GetByteCount(charArray);

using (var stream = request.GetRequestStream())
{
   stream.Write(encoding.GetBytes(postData), 0, encoding.GetByteCount(postData));
   stream.Close();
   var response = request.GetResponse();
   response.Close();
} 
```

注意：我已经验证我的用户名和密码是正确的。

===更新===

我会说我的城市飞艇配置有问题，但以下工作：

```
curl -X PUT -u "appKey:appSecret" -H "Content-Type: application/json" --data '{"alias": "myalias"}' https://go.urbanairship.com/api/device_tokens/myTOken/ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T21:25:41.520

已修复，我修改了我的代码，最重要的是：您的密码是应用程序的主要机密

```
string postData = "{\"aps\": {\"badge\": 1, \"alert\": \"Hello from Urban Airship!\"}, \"device_tokens\": [\""+ devToken +"\"]}";

var uri = new Uri("https://go.urbanairship.com/api/push/");
var encoding = new UTF8Encoding();
var request = (HttpWebRequest)WebRequest.Create(uri);
char[] charArray = Encoding.UTF8.GetChars(Encoding.UTF8.GetBytes(postData));
request.Method = "POST";
request.Credentials = new NetworkCredential(username, password);
request.ContentType = "application/json";
request.ContentLength = encoding.GetByteCount(charArray);

using (var stream = request.GetRequestStream())
{
    stream.Write(encoding.GetBytes(postData), 0, encoding.GetByteCount(postData));
    stream.Close();
    var response = request.GetResponse();
    response.Close();
} 
```

# ruby - ruby-eventmachine 将 start_server 与实例一起使用

> ID：13144134
> 
> 赞同：2
> 
> 时间：2012-10-30T17:03:35.333
> 
> 标签：ruby, eventmachine

我是 ruby​​ 新手，也许这是一个非常简单的问题。我想使用 eventmachine 为我的测试开发一个模拟器。按照文档中的示例，我可以编写如下内容：

```
require 'eventmachine'

class Server< EM::Connection
   def receive_data data
     send_data data
     close_connection_after_writing
   end
end
#Note that this will block current thread.
EventMachine.run {
  EventMachine.start_server '127.0.0.1','8080', Server
} 
```

但我想知道是否有办法使用类的实例，例如：

```
require 'eventmachine'
class Server< EM::Connection
  attr_accessor :response
    def receive_data data
      send_data @response
      close_connection_after_writing
    end
end

server1 = Server.new
server1.response = "foo"

#Note that this will block current thread.
EventMachine.run {
  EventMachine.start_server '127.0.0.1','8080', server1
} 
```

我尝试阅读源代码..但这对我来说太难了。我肯定错过了一些东西，但我不知道如何做这样的事情。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-30T17:43:40.883

正如我所说，我缺少一些东西。

您可以为要实例化的类添加参数：

```
 class Server< EM::Connection
    def initialize par
       puts "I'm server number#{par}"
    end
    def receive_data data
      send_data data
      close_connection_after_writing
    end
 end

EventMachine.run {
  EventMachine.start_server '127.0.0.1','8080', Server,1
}

EventMachine.run {
  EventMachine.start_server '127.0.0.1','8080', Server,2
} 
```

所以我会用参数自定义实例行为

# c++ - 窗口化 XAML 应用程序

> ID：13144139
> 
> 赞同：0
> 
> 时间：2012-10-30T17:03:53.270
> 
> 标签：c++, .net, xaml, windows-8, visual-studio-2012

我想用 C++ 在 Windows 8 上用 XAML 制作一个窗口应用程序，但据我所知，唯一的 XAML 选项是 Metro（休闲）应用程序（全屏）。但是，我的应用程序不是休闲应用程序，因此我希望它成为桌面（窗口）应用程序。另外，我希望讨厌 Windows 8 的 Window 7 用户能够使用它。

有什么办法吗？更改`<Page ... </Page>`为`<Window ... </Window>`似乎并不能解决问题（至少对我而言）。我知道 Visual Studio 2012 可以执行 Windowed XAML C#，因为我不久前打开了一个项目并且它以窗口方式运行。

这只是一个项目设置还是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T17:06:25.930

编辑：这不是项目设置；你正在尝试一些从未被支持的东西。C++ 不是 WPF 语言。您需要使用 C# 或 Visual Basic 来构建 WPF 桌面应用程序，它在 VS2012 和 VS2010 中都受支持。抱歉，我错过了您使用 C++ 工作的事实。

* * *

（C# 不应该是一个陡峭的学习曲线，如果你以前没有使用过它并且你已经习惯了 C++。如果需​​要，你可以将 C++ 移植到 CLR 库中。）

可能，这只是一个项目设置，它取决于您拥有的 Visual Studio 版本。我认为 Visual Studio 2012 的 Express 版本只允许创建“Metro 风格”应用程序，而 Professional、Premier 或 Ultimate 版本具有桌面（WPF 或 Silverlight）目标项目。

可以肯定的是，启动一个新的解决方案，看看你是否有选择。如果没有，你可能没有正确的 VS2012 版本。请务必查看项目类型的树状视图，以确保您没有错过任何一个。如果它真的是 VS2012 的专业版，它会在那里或者可以下载。

# javascript - jQuery请求一个url列表，同时限制最大并发请求数

> ID：13144144
> 
> 赞同：5
> 
> 时间：2012-10-30T17:04:11.090
> 
> 标签：javascript, jquery, ajax, performance

> **可能重复：**
> [排队 AJAX 调用](https://stackoverflow.com/questions/4797566/queue-ajax-calls)

我有一个 id 列表：

`var ids = [3738, 75995, 927, ... ]; // length is about 2000`

我想用 请求网址`http://xx/ + id`，`$.getJSON`例如：

```
ids.forEach(function(id, index){
    $.getJSON('http://xx/' + id, function(data){
        // store the data in another array.
    });
}); 
```

但是这样会一次性发出过多的请求，让浏览器阻塞一段时间，所以我的问题是，如何限制 jQuery 中并发 ajax 请求的数量？例如，我发送 10 个请求，当他们每个人都收到响应时，我发送另一个请求。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T17:28:51.420

```
var $queue = $({});

ids.forEach(function(id, index) {
    $queue.queue("ajaxQueue", function( next ) {
        $.getJSON('http://xx/' + id, function(data){
            // store the data in another array.

            next();
        });
    });
});

$queue.queue("ajaxQueue", function() {
    // everything is saved
});

$queue.dequeue("ajaxQueue"); 
```

* * *

**jQuery 文档：**

[jQuery.queue](http://api.jquery.com/queue/)
[jQuery.dequeue](http://api.jquery.com/queue/)

**所以：**

[jQuery 中的队列是什么？](https://stackoverflow.com/questions/1058158/can-somebody-explain-jquery-queue-to-me/3314877#3314877)

* * *

**还：**

> 解决方案应该是如何让后端处理多个 id。–[埃帕斯卡雷罗](https://stackoverflow.com/users/14104/epascarello)

* * *

~~##当时的十个请求：~~有一些问题！

 ~~~~```
var $queue = $({}),
    handler;

ids.forEach(function(id, index) {
    if ( !(index % 10) && handler ) {
         $queue.queue("ajaxQueue", handler);
    }
    handler = (function(prev) {
        return function( next ) {
            prev();
            $.getJSON('http://xx/' + id, function(data){
                // store the data in another array.
            });
            if ( next ) {
                next();
            }
        }
    })(handler);
});

$queue.queue("ajaxQueue", function() {
    // everything is saved
});

$queue.dequeue("ajaxQueue"); 
```~~  ~~**`x % y`**

```
(index % 10) => Math.floor(index/10)*10 === index;
!(index % 10) => Math.floor(index/10)*10 !== index; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T17:21:47.110

`shift()`或`pop()`在您开始请求时从数组中删除 id。首先发出 10 个请求。然后在`complete()`ajax 调用的处理程序中，检查数组长度。如果它大于 0，则`setTimeout`持续几百毫秒（以释放浏览器一点），然后移动或弹出另一个 ID 并触发另一个请求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T17:14:18.790

这应该可以解决问题：

```
var current;    

function fetchCurrentLast()
{
    if (current < ids.length)
    {
        var id = ids[current];
        current++;

        $.getJSON('http://xx/' + id, function(data){
            // store the data in another array.

            fetchCurrentLast();
        });
    }
}

current = 0;

for (var i = 0; i < 10; i++)
{
    fetchCurrentLast();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-30T17:15:09.007

```
var cnt = 0;
function getEach() {
    if (cnt>=ids.length) return;
    $.getJSON('http://xx/' + ids[cnt], function(data){
    // store the data in another array.
    cnt++;
    getEach(); 
    // or setTimeout(getEach,1000); to wait a sec
    // or if (cnt%10==0) setTimeout(getEach,1000); to wait a sec every 10
    //    else getEach();
  });
} 
```~~~~

# matlab - 如何从图像中获取两个关系操作之间的值

> ID：13144157
> 
> 赞同：1
> 
> 时间：2012-10-30T17:05:18.467
> 
> 标签：matlab, wolfram-mathematica, relationship

我正在尝试从图像中获取两个关系操作之间的值。

`A(34,67,4)`是具有给定值的图像。
我需要`A`0 到 16 ( `0<=A<=16`) 之间的值。

当我尝试按以下方式进行操作时，这只是给了我 0 或 1（不是`A`数组的值）。你能告诉我问题是什么吗？

```
B=((A<=0)&(A>=16)+((A>=0)&(A<=16)) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T17:08:17.723

你想应用条件

```
(A>=0)&(A<=16) 
```

作为矩阵的[逻辑索引](http://www.mathworks.nl/company/newsletters/articles/Matrix-Indexing-in-MATLAB/matrix.html)`A`：

```
B = A(A>=0 & A<=16); 
```

这将为您呈现一个值向量，因为它只选择那些满足您条件的值，并且因为它们可以出现在矩阵中的任何位置，所以没有结构可以将它们返回给您，而是在向量中。

但是，如果您想保留矩阵，并重置每个不满足条件的值 0 或`NaN`（因此剩下的所有内容都是满足条件的所有元素），请使用以下命令：

```
B = A;
B(A<0 | A>16) = NaN; 
```

如果您还想对这些值（并且仅对这些值，而不是 NaN）应用操作，则可以按如下方式进行：

```
B = A;
select_idx = A>=0 & A<=16;
B(~select_idx) = NaN;
B( select_idx) = arrayfun(@myfun, B(select_idx) ); 
```

例如：

```
A = rand(10)*30-5
B = A;
select_idx = A>=0 & A<=16;
B(~select_idx) = NaN;
B( select_idx) = arrayfun(@floor, B(select_idx) ); 
```

它将 0-16 范围之外的所有值设置为 NaN，并将 floor 函数应用于范围内的所有值。

# python - Windows 64 上的 Python、GEOS 和 Shapely

> ID：13144158
> 
> 赞同：23
> 
> 时间：2012-10-30T17:05:23.853
> 
> 标签：python, gis, geospatial, shapely

当尝试在我的 Windows 64 位计算机上安装 Shapely 时，我无法让 GEOS 库工作。

到目前为止，我已经运行了安装 GDAL 的 OSGeo4W 安装程序（我相信 geos 库包含在该软件包中）。之后，我检查并在我的`C:\OSGeo4W\bin`目录中有 geos_c.dll，但要么我错过了一些配置步骤，要么该库不起作用。

我需要 Shapely 才能工作，所以我`pip install shapely`在安装 GDAL 后也运行了，它显然可以工作（尽管它找不到 GEOS 的 C 库）。

在我的代码中，我可以导入 Shapely，但是当我尝试使用它时，我收到一条错误消息，告诉我`"geos.dll"`找不到。

对此的任何帮助将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-07-25T05:02:50.440

Anaconda/Miniconda 用户应该安装 Shapely（和依赖项）：

```
conda install shapely 
```

截至 2020 年，其他 Python 用户可以使用 pip 从 PyPI 安装二进制轮子：

```
pip install shapely 
```

（添加二进制轮时，您可能需要`--upgrade`至少获得 1.7.0 版本。）请注意，二进制轮不适用于 Windows 上的 Python 2。

* * *

从 python.org 安装 Python 的 Windows 用户的另一个资源，Christoph Gohlke 维护了一个优秀的 Python 非官方 Windows 二进制文件池。下载适用于 32 位或 64 位版本 Python的[Shapely Wheels ，其中包括 GEOS 依赖项。](https://www.lfd.uci.edu/%7Egohlke/pythonlibs/#shapely)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2018-05-31T12:13:43.823

在这里查看我的答案[https://stackoverflow.com/a/50623996/1683626](https://stackoverflow.com/a/50623996/1683626)

在 Windows 10 上，python 3.6.5 64 位

*   安装[osgeo4w](https://trac.osgeo.org/osgeo4w/)
*   将安装的文件夹添加到路径，例如 C:\OSGeo4W64\bin（必须包含 geos_c.dll）
*   重启命令行

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-25T16:58:01.247

[这里](http://pypi.python.org/pypi/Shapely/1.2b6)有一个可用的 Shapely 版本，其中包含安装程序中的地理信息。查看页面底部。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-08-04T01:34:41.807

我尝试了@jozef 的方法，但即使我将文件夹导入路径也失败了。

一个简单的解决方案：将 geos_c.dll、geos.dll 添加到 python 环境的库文件夹中。然后它工作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-12-06T16:39:58.237

我使用了下面的命令，它确实有效；

pip install Shapely==1.3.0

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-03-24T12:50:42.683

[我已经从https://www.lfd.uci.edu/~gohlke/pythonlibs/#gdal](https://www.lfd.uci.edu/%7Egohlke/pythonlibs/#gdal)为GDAL（和 Fiona，在我的情况下；可能不需要）安装轮子 提供 geos_c.dll 的路径没用。也不将它们放入 venv/Lib。

# word - 位、字节和数字。缩小字节大小

> ID：13144164
> 
> 赞同：1
> 
> 时间：2012-10-30T17:05:54.927
> 
> 标签：word, byte, bits

这可能是一个非常基本的低级架构问题。我正在努力解决它。如果我的理解有误，也请指正。

Word = 64 位、32 位等。这是计算机一次可以读取的位数。

问题：

1.) 这是否意味着，我们可以发送 4 个 32 位数字（每个 8 位/字节长度）？还是一次组合 8 位（字节）、32 位（4 字节）等数字？

2.) 如果我们只需要发送 8 位数字，那么它是如何组成一个字的？只有第一个字节被填充，其余所有字节都用 0 填充，或者最后一个字节被填充，而其余字节用 0 填充？或者我看到像第一个字节这样的地方有关于如何填充其余字节的信息。这适用于这里吗？例如，UTF-8。在这里，ASCII 是 1 个字节，而其他一些字符最多占用 4 个字节。所以当我们发送一个 char 时，我们将所有 4 个字节一起发送，但是按照 char 和其余字节 0 的要求填充字节？

3.) 现在要表示 8 位数字，我们需要 27 位（记住著名的问题，用 1 MB RAM 对 100 万个 8 位数字进行排序）。我们可以准确地使用 27 位，即 32 位（4 字节）- 5 位吗？并将这 5 位数字用于其他用途？

感谢您的回答！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T02:52:31.243

**1-**是的，四个 8 位整数可以放入一个 32 位整数。这可以使用按位运算来完成，例如（使用 C 运算符）：

```
((a & 255) << 24) | ((b & 255) << 16) | ((c & 255) << 8) | (d & 255) 
```

此示例使用 C 运算符，但它们也用于其他几种语言中的相同目的（*见下文 - 此示例的 C 中的完整、可编译版本*）。您可能需要查找按位运算符**AND** ( `&`)、**OR** ( `|`) 和**Left Shift** ( `<<`)；

**2-**未使用的位通常是`0`. 第一个字节有时用于表示编码的类型（查找“幻数”），但这取决于实现。有时它是不同的位数。

**3-** 8 位数字组可以压缩为每组仅使用 27 位。这与示例非常相似，只是数据的位数和大小不同。为此，您将需要 864 位组，即 27 个 32 位整数来存储 32 个 27 位数字。这将比示例更复杂，但它会使用相同的原理。

完整的、可编译的 C 语言示例：

```
#include <stdio.h>

/*Compresses four integers containing one byte of data in the least
 *significant byte into a single 32-bit integer*/
__int32 compress(int a, int b, int c, int d){
   __int32 compressed = ((a & 255) << 24) | ((b & 255) << 16) |
      ((c & 255) << 8) | (d & 255);
   return compressed;
}

/*Test the compress() function and print the resuts*/
int main(){
   printf("%x\n", (unsigned)compress(255, 0, 255, 0));
   printf("%x\n", (unsigned)compress(192, 168, 0, 255));
   printf("%x\n", (unsigned)compress(84, 94, 255, 2));
   return 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T17:44:13.493

我认为这里需要澄清两点：
1.内存寻址。
2.字

存储器可以通过两种方式寻址，它们通常是字节寻址或字寻址。 **字节可寻址**存储器意味着每个字节都有一个单独的地址。
a -> 第 0 个字节
b -> 第 1 个字节
**字可寻址**存储器是那些与字一样宽的每组字节获得地址的存储器。例如，如果字长是 32 位：
a->第 0 个字节
b->第 4 个字节
等等。

**Word我会说一个词定义了处理器一次可以****处理**
的最大位数。例如，对于 8086，它是 16。它通常是处理器可以执行算术运算的最大数。继续这个例子，8086 可以一次对 16 位数字执行操作。

 **现在我将尝试回答问题：

> 1.) 这是否意味着，我们可以发送 4 个 32 位数字（每个 8 位/字节长度）？还是一次组合 8 位（字节）、32 位（4 字节）等数字？

**您始终可以为一堆位定义自己的解释。**

例如，如果它是字节可寻址的，我们可以单独处理每个字节，因此，我们可以在汇编级别编写代码，将每个字节视为一个单独的 8 位数字。如果不是，您可以使用位操作来提取单个字节。
关键是您可以用 32 位表示 4 个 8 位数字。

2）大多数情况下，剩余的有效位都填充了 0（对于无符号数）

> 3.) 现在要表示 8 位数字，我们需要 27 位（记住著名的问题，用 1 MB RAM 对 100 万个 8 位数字进行排序）。我们可以准确地使用 27 位，即 32 位（4 字节）- 5 位吗？并将这 5 位数字用于其他用途？

是的，你也可以这样做。但你知道伟大的时空权衡。您肯定会为每个数字节省 5 位。但是你需要使用位操作和所有非常酷但难以阅读的东西。增加时间并使代码更复杂。
但是我认为您永远不会遇到需要这种级别的储蓄的情况，除非您正在为一个非常受限的系统进行编码。（嵌入式等）**

# cognos - COGNOS 生成 xls 格式的报告

> ID：13144165
> 
> 赞同：2
> 
> 时间：2012-10-30T17:05:58.997
> 
> 标签：cognos

我有一个提示页面，一个html报告输出页面和一个xls报告输出页面。在提示页面上，我有一个选择输出格式（HTML/XLS）的提示和一个生成报告的生成按钮。生成按钮需要以正确的格式显示输出页面。

'Generate' 按钮只是做 promptAction('finish')。问题是无论我选择什么格式（XLS、PDF 等），promptAction('finish') 总是生成 HTML 输出。
那么有没有办法调用诸如promptAction（'finish'，varFormat）之类的东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T10:08:33.550

我通常以相反的方式执行此操作 - 使用本机 Cognos 功能以所需的格式运行它（即使用带有选项的运行）。然后使用变量来检测应用的格式，然后应用条件格式。在您的情况下，如果选择了 XLS，则将呈现 XLS 页面，如果选择了 HTML，则呈现 HTML 页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T22:43:14.773

我记得在 HTML 与 PDF 页面渲染时遇到了这个问题。我面前没有 Cognos，但我发现我必须更新我的条件样式/格式，因为以下内容无法正常工作......这是一个奇怪的问题，但我确实想出了一个解决方法

不起作用的旧伪代码。创建的变量表示 Case RENDER_TYPE When PDF THEN PDF WHEN HTML THEN HTML End 然后我使用此变量设置条件样式以使页面可见或不可见......这将不起作用。

我必须做的是这个......

```
Case 
   When RENDER TYPE = 'HTML'
   Then 'HTML'
   Else 'PDF'  <-  or in your case EXL
End 
```

当然，它只适用于两种格式，但出于某种奇怪的原因，尝试使用 HTML 以外的任何其他值都会产生奇怪的行为。谢谢，

如果 Render Type <> 'HTML' 然后渲染 PDF 否则渲染 HTML ...

我在任何时候使用 HTML 以外的任何内容引用渲染变量时都会遇到问题。所以基本上我只需要测试 HTML 然后 HTML 其他格式。

# java - Apache Commons 电子邮件，如何将 Content-Transfer-Type 的附件发送为可引用打印的电子邮件？

> ID：13144171
> 
> 赞同：3
> 
> 时间：2012-10-30T17:06:17.440
> 
> 标签：java, email, jakarta-mail, apache-commons-email

我有一个应用程序通过发送带有附件的电子邮件与其他人的服务器通信。

我使用 Apache Commons Email 发送带有附件的电子邮件，如下所示：

```
MultiPartEmail email = new MultiPartEmail();
email.setHostName(sHostName);
email.addTo("bob@bob.com");
email.addFrom("andy@andy.com");
email.setSubject("the subject");
email.setMsg("the message");

byte[] documentFile = /* ... */;
String filename = "my file.pdf";
String description = "this is my file";

email.attach(new ByteArrayDataSource(myPDF, "application/pdf"), filename, description, EmailAttachment.ATTACHMENT);

email.send(); 
```

问题是，另一端的人说“标头信息的 Content-Transfer-Encoding 值为“7bit”，它需要“引用打印”。

我的问题是，如何进行此更改，以便以适当的方式附加文件？

抢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-01T07:09:23.293

Commons 电子邮件根据附件的内容决定使用哪种编码，请参阅[http://thecarlhall.wordpress.com/2010/09/01/setting-quoted-printable-in-a-commons-email-body-part/](http://thecarlhall.wordpress.com/2010/09/01/setting-quoted-printable-in-a-commons-email-body-part/)进行一些相关的讨论。此外，底层的 java-mail 似乎会根据[javadoc](http://docs.oracle.com/javaee/6/api/javax/mail/internet/MimeUtility.html#getEncoding%28javax.activation.DataSource%29)自动执行此操作。

博客文章指出您可以尝试使用

```
email.addHeader("Content-transfer-encoding", "quoted-printable"); 
```

但它可能会因此损坏邮件的其他部分。

# regex - 剥离选择查询字符串属性/值对，以便清漆不会因它们而改变缓存

> ID：13144172
> 
> 赞同：12
> 
> 时间：2012-10-30T17:06:22.133
> 
> 标签：regex, query-string, varnish, varnish-vcl

我的目标是将某些查询字符串属性及其值“列入白名单”，以便清漆不会改变网址之间的缓存。

例子：

```
Url 1: http://foo.com/someproduct.html?utm_code=google&type=hello  
Url 2: http://foo.com/someproduct.html?utm_code=yahoo&type=hello  
Url 3: http://foo.com/someproduct.html?utm_code=yahoo&type=goodbye 
```

在上面的示例中，我想将“utm_code”而不是“type”列入白名单，所以在第一个 url 被点击后，我希望 varnish 将缓存的内容提供给第二个 url。

但是，在第三个 url 的情况下，属性“type”值不同，因此应该是清漆缓存未命中。

我尝试了以下两种似乎不起作用的方法（在我现在找不到的 drupal 帮助文章中找到）。可能是因为我的正则表达式错误。

```
# 1\. strip out certain querystring values so varnish does not vary cache.
set req.url = regsuball(req.url, "([\?|&])utm_(campaign|content|medium|source|term)=[^&\s]*&?", "\1");
# get rid of trailing & or ?
set req.url = regsuball(req.url, "[\?|&]+$", "");

# 2\. strip out certain querystring values so varnish does not vary cache.
set req.url = regsuball(req.url, "([\?|&])utm_campaign=[^&\s]*&?", "\1");
set req.url = regsuball(req.url, "([\?|&])foo_bar=[^&\s]*&?", "\1");
set req.url = regsuball(req.url, "([\?|&])bar_baz=[^&\s]*&?", "\1");
# get rid of trailing & or ?
set req.url = regsuball(req.url, "[\?|&]+$", ""); 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-14T02:19:36.047

我想通了这一点并想分享。我发现这段代码可以创建一个可以满足我需要的子程序。

```
sub vcl_recv {

    # strip out certain querystring params that varnish should not vary cache by
    call normalize_req_url;

    # snip a bunch of other code
}

sub normalize_req_url {

    # Strip out Google Analytics campaign variables. They are only needed
    # by the javascript running on the page
    # utm_source, utm_medium, utm_campaign, gclid, ...
    if(req.url ~ "(\?|&)(gclid|cx|ie|cof|siteurl|zanpid|origin|utm_[a-z]+|mr:[A-z]+)=") {
        set req.url = regsuball(req.url, "(gclid|cx|ie|cof|siteurl|zanpid|origin|utm_[a-z]+|mr:[A-z]+)=[%.-_A-z0-9]+&?", "");
    }
    set req.url = regsub(req.url, "(\?&?)$", "");
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-08-13T15:57:20.150

RegEx 有问题。
我更改了两个 regsub 调用中使用的 RegExes：

```
sub normalize_req_url {
    # Clean up root URL
    if (req.url ~ "^/(?:\?.*)?$") {
        set req.url = "/";
    }

    # Strip out Google Analytics campaign variables
    # They are only needed by the javascript running on the page
    # utm_source, utm_medium, utm_campaign, gclid, ...
    if (req.url ~ "(\?|&)(gclid|cx|ie|cof|siteurl|zanpid|origin|utm_[a-z]+|mr:[A-z]+)=") {
        set req.url = regsuball(req.url, "(gclid|cx|ie|cof|siteurl|zanpid|origin|utm_[a-z]+|mr:[A-z]+)=[%\._A-z0-9-]+&?", "");
    }
    set req.url = regsub(req.url, "(\?&|\?|&)$", "");
} 
```

第一个变化是“[%._A-z0-9-]”部分，因为破折号的作用就像一个范围符号，这就是为什么我把它移到最后，点应该被转义。

第二个更改是不仅删除了剩余 URL 处的问号，还删除了与号或问号和与号。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-12-03T08:38:47.970

来自[https://github.com/mattiasgeniar/varnish-4.0-configuration-templates](https://github.com/mattiasgeniar/varnish-4.0-configuration-templates)：

```
# Some generic URL manipulation, useful for all templates that follow
# First remove the Google Analytics added parameters, useless for our backend
if (req.url ~ "(\?|&)(utm_source|utm_medium|utm_campaign|utm_content|gclid|cx|ie|cof|siteurl)=") {
  set req.url = regsuball(req.url, "&(utm_source|utm_medium|utm_campaign|utm_content|gclid|cx|ie|cof|siteurl)=([A-z0-9_\-\.%25]+)", "");
  set req.url = regsuball(req.url, "\?(utm_source|utm_medium|utm_campaign|utm_content|gclid|cx|ie|cof|siteurl)=([A-z0-9_\-\.%25]+)", "?");
  set req.url = regsub(req.url, "\?&", "?");
  set req.url = regsub(req.url, "\?$", "");
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-11T10:47:10.827

您想删除，`utm_code`但您正在使用的任何一个正则表达式都没有涵盖它。

试试这个：

```
# Strip out specific utm_ values from request URL query parameters
set req.url = regsuball(req.url, "([\?|&])utm_(campaign|content|medium|source|term|code)=[^&\s]*&?", "\1");
# get rid of trailing & or ?
set req.url = regsuball(req.url, "[\?|&]+$", ""); 
```

或者，如果您想删除*所有*以您开头的 URL 参数，`utm_`可以使用：

```
# Strip out ALL utm_ values from request URL query parameters
set req.url = regsuball(req.url, "([\?|&])utm_(\w+)=[^&\s]*&?", "\1");
# get rid of trailing & or ?
set req.url = regsuball(req.url, "[\?|&]+$", ""); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-07-16T05:40:03.197

runamok 的副本，但我在参数中得到 + 而不是 %20 所以我已将其添加到我的正则表达式中

```
sub vcl_recv {
    # strip out certain querystring params that varnish should not vary cache by
    call normalize_req_url;
    # snip a bunch of other code
}
sub normalize_req_url {
    # Strip out Google Analytics campaign variables.
    # I allso stribe facebook local that are use for facebook javascript.
    # They are only neededby the javascript running on the page
    # utm_source, utm_medium, utm_campaign, gclid, ...
    if(req.url ~ "(\?|&)(gclid|cx|ie|cof|siteurl|zanpid|origin|utm_[a-z]+|fb_local|mr:[A-z]+)=") {
        set req.url = regsuball(req.url, "(gclid|cx|ie|cof|siteurl|zanpid|origin|utm_[a-z]+|fb_local|mr:[A-z]+)=[%.+-_A-z0-9]+&?", "");
    }
    set req.url = regsub(req.url, "(\?&?)$", "");
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-04-09T17:41:44.740

你们有没有试过这个？ [https://github.com/Dridi/libvmod-querystring](https://github.com/Dridi/libvmod-querystring)

示例
集 req.url = querystring.regfilter(req.url, "utm_.*");

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-01-25T22:24:12.693

通过添加对空参数的支持并对剩余参数进行排序，我对 runamok 的答案进行了一些改进，这是我为验证正确性而实现的完整 vtc 文件。

```
varnishtest "Test for URL normalization - Varnish 4"

server s1 {
  rxreq
  txresp -hdr "Backend: up" -body "Some content"
} -repeat 11 -start

varnish v1 -vcl+backend {
  import std;

  sub vcl_recv {
    # Strip out marketing variables. They are only needed by
    # the javascript running on the page.
    if (req.url ~ "(\?|&)(gclid|cx|ie|cof|siteurl|zanpid|origin|utm_[a-z]+|mr:[A-z]+)(=|&|$)") {
      # Process params with value.
      set req.url = regsuball(req.url, "(gclid|cx|ie|cof|siteurl|zanpid|origin|utm_[a-z]+|mr:[A-z]+)=[%.\-_A-z0-9]+&?", "");
      # Process params without value.
      set req.url = regsuball(req.url, "(gclid|cx|ie|cof|siteurl|zanpid|origin|utm_[a-z]+|mr:[A-z]+)=?(&|$)", "");
    }
    # Remove trailing '?', '?&'
    set req.url = regsub(req.url, "(\?&?)$", "");
    # Sort query params, also removes trailing '&'
    set req.url = std.querysort(req.url);
  }

  sub vcl_deliver {
    set resp.http.X-Normalized-URL = req.url;
  }
} -start

client c1 {
  # Basic, no params.
  txreq -url "/test/some-url"
  rxresp
  expect resp.http.X-Normalized-URL == "/test/some-url"

  # One blacklisted param.
  txreq -url "/test/some-url?utm_campaign=1"
  rxresp
  expect resp.http.X-Normalized-URL == "/test/some-url"

  # One blacklisted param, without value.
  txreq -url "/test/some-url?utm_campaign"
  rxresp
  expect resp.http.X-Normalized-URL == "/test/some-url"

  # Two blacklisted params.
  txreq -url "/test/some-url?utm_campaign=1&origin=hpg"
  rxresp
  expect resp.http.X-Normalized-URL == "/test/some-url"

  # Two blacklisted params, one without value
  txreq -url "/test/some-url?utm_campaign&origin=123-abc%20"
  rxresp
  expect resp.http.X-Normalized-URL == "/test/some-url"

  # Two blacklisted params, both without value
  txreq -url "/test/some-url?utm_campaign&origin="
  rxresp
  expect resp.http.X-Normalized-URL == "/test/some-url"

  # Three blacklisted params.
  txreq -url "/test/some-url?utm_campaign=ABC&origin=hpg&siteurl=br2"
  rxresp
  expect resp.http.X-Normalized-URL == "/test/some-url"

  # Three blacklisted params, two without value
  txreq -url "/test/some-url?utm_campaign=1&origin=&siteurl"
  rxresp
  expect resp.http.X-Normalized-URL == "/test/some-url"

  # Three blacklisted params; one param to keep, with space encoded as +.
  txreq -url "/test/some-url?qss=hello+one&utm_campaign=some-value&origin=hpg&siteurl=br2"
  rxresp
  expect resp.http.X-Normalized-URL == "/test/some-url?qss=hello+one"

  # Three blacklisted params; one param to keep, with space encoded as %20, passed in-between blacklisted ones.
  txreq -url "/test/some-url?utm_campaign=1&qss=hello%20one&origin=hpg&siteurl=br2"
  rxresp
  expect resp.http.X-Normalized-URL == "/test/some-url?qss=hello%20one"

  # Three blacklisted params; three params to keep.
  txreq -url "/test/some-url?utm_campaign=a-value&qss=hello+one&origin=hpg&siteurl=br2&keep2=abc&keep1"
  rxresp
  expect resp.http.X-Normalized-URL == "/test/some-url?keep1&keep2=abc&qss=hello+one"
} -run

varnish v1 -expect client_req == 11 
```

# python - Python：以固定间隔连续且可取消地重复执行

> ID：13144176
> 
> 赞同：3
> 
> 时间：2012-10-30T17:06:26.930
> 
> 标签：python, multithreading, vim, multiprocessing

在能够立即终止执行程序（线程或进程）的同时以固定间隔连续重复执行给定函数的最佳方法是什么？

基本上我知道两种方法：

1.  最后使用无限循环`time.sleep`的多处理和函数。处理`process.terminate()`以任何状态终止。
2.  使用线程并在线程函数结束时不断重新创建计时器。`timer.cancel()`处理在睡眠时终止。

（“处于任何状态”和“睡觉时”都可以，即使后者可能不是即时的）。问题是我必须同时使用多处理和线程，因为后者似乎不适用于 ARM（python 解释器和 vim 的一些模糊交互，在 vim 之外一切都很好）（我在那里使用第二种方法，没有尝试过线程+循环；目前没有代码），前者产生了太多的进程，除非真的需要，否则我不想看到。这导致了一个问题，即必须编写两种不同的方法，而`threading`使用循环只是为了替换所有包含在/中的`multiprocessing`东西的直接替换（除了没有 ）。有没有更好的方法来完成这项工作？`if``else``thread.terminate()`

当前使用的代码在[这里](https://bitbucket.org/ZyX_I/aurum/src/1dc9ed228ca82ad6bf5b718df07148064420a9d7/python/aurum/repeatedcmd.py)（目前两个工作都有循环），但我认为回答这个问题不会有多大用处。

**更新**：我使用此解决方案的原因是在 vim 状态行的版本控制系统中显示文件状态（以及其他一些东西，如分支）的功能。这些状态必须更新，但是如果不使用钩子就无法立即更新它们，而且我不知道如何临时设置钩子并在 vim 退出时删除而不会破坏用户配置。因此标准解决方案是缓存在 N 秒后过期。但是当缓存过期时，我需要进行昂贵的 shell 调用，并且延迟似乎很明显，IO 负载越重越明显。我现在正在实施的是在单独的过程中每 N 秒更新一次查看缓冲区的值，因此延迟会困扰该过程而不是我。由于 GIL 不影响对外部程序的调用，因此线程也可能起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T21:33:56.130

我不清楚为什么在任务上无限循环的单个长寿命线程对您不起作用？或者为什么你最终在多进程选项中有许多进程？

我的直接反应将是一个带有队列的单线程来提供它要做的事情。但我可能误解了这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T20:49:37.030

我不知道如何在 Python 中简单和/或干净地做到这一点，但我想知道您是否不能利用现有的系统调度程序，例如 *nix 系统的 crontab。

[python中](http://pypi.python.org/pypi?name=python-crontab&%3aaction=display)有一个API ，它可能会满足您的需求。

# android - 安卓手机摄像头垂直倾角

> ID：13144180
> 
> 赞同：0
> 
> 时间：2012-10-30T17:06:35.790
> 
> 标签：android, android-camera, android-orientation

我使用函数 getRotationMatrix。现在我有了手机的方位角、俯仰角和滚动角。但我想有相机的倾向。音高也受滚动的影响，这是我想要的一个例子：

1.  相机指向天空？角度 -90°
2.  摄像头在前面？角度 0°
3.  相机指向地板？角度 +90°

我能怎么做？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T19:05:26.577

试试这个.. 获取对 Camera 对象的引用

```
 theCamera.setDisplayOrientation(90); 
```

# c++ - 如何在 Windows 上使用 CMake + CPack + NSIS 创建安装程序？

> ID：13144181
> 
> 赞同：27
> 
> 时间：2012-10-30T17:06:38.270
> 
> 标签：c++, installation, cmake, nsis, cpack

我想为我正在构建的基于 C++ 的系统创建一个跨平台安装程序。

我使用 CMake 来构建一切，如果我可以使用 CPack 来制作安装程序，那就太好了。我已经让 CPack 在 OSX 上运行，但我无法让它在 Windows 上运行。为了使事情更容易，我尝试在[http://www.cmake.org/Wiki/CMake:Packaging_With_CPack](http://www.cmake.org/Wiki/CMake:Packaging_With_CPack)上获取示例以使用 NSIS 安装程序软件。配置后我在任何地方都找不到 NSIS 安装程序（使用 VS 2010 Win64 生成器）。

也许我很困惑，但我认为可以只使用源代码、CMake、CPack 和 NSIS 创建安装包，而无需 Visual Studio。这可能吗？

完整教程的链接（[http://www.cmake.org/Wiki/CMake:Component_Install_With_CPack](http://www.cmake.org/Wiki/CMake:Component_Install_With_CPack)跳过相关信息以使 NSIS 工作并且没有提及生成器或编译器）将非常有帮助，或者关于如何获得这个神秘生成的 NSIS 安装程序的基本解释会很棒。

这是上面示例的 CMakeLists.txt：

```
cmake_minimum_required(VERSION 2.6.0 FATAL_ERROR)
project(StPMS)

add_library(mylib mylib.cpp)

add_executable(mylibapp mylibapp.cpp)
target_link_libraries(mylibapp mylib)

 install(TARGETS mylib 
   ARCHIVE
   DESTINATION lib
   COMPONENT libraries)
 install(TARGETS mylibapp
   RUNTIME
   DESTINATION bin
   COMPONENT applications)
 install(FILES mylib.h
   DESTINATION include
   COMPONENT headers)

set(CPACK_GENERATOR NSIS)
set(CPACK_PACKAGE_NAME "MyLib")
set(CPACK_PACKAGE_VENDOR "CMake.org")
set(CPACK_PACKAGE_DESCRIPTION_SUMMARY "MyLib - CPack Component Installation Example")
set(CPACK_PACKAGE_VERSION "1.0.0")
set(CPACK_PACKAGE_VERSION_MAJOR "1")
set(CPACK_PACKAGE_VERSION_MINOR "0")
set(CPACK_PACKAGE_VERSION_PATCH "0")
set(CPACK_PACKAGE_INSTALL_DIRECTORY "CPack Component Example")
SET(CPACK_NSIS_MODIFY_PATH ON)

INCLUDE(CPack) 
```

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-10-30T23:13:12.003

> ...我认为可以仅使用源代码、CMake、CPack 和 NSIS 创建安装包，而无需 Visual Studio。这可能吗？

有点儿。这取决于您所说的“不需要 Visual Studio”是什么意思。您需要一个构建工具来实际创建 lib 和 exe。在 Windows 上，您需要 Visual Studio 的 msbuild 之类的东西，尤其是在您指定`"Visual Studio 10 Win64"`为生成器的情况下。

如果您的意思是“不运行 Visual Studio”，那么答案是肯定的。您可以让 CMake 使用该[`--build`](http://www.cmake.org/cmake/help/v2.8.9/cmake.html#opt:--builddir)参数执行您选择的构建工具。

运行 CMake 后，您最终会在构建目录中获得一个文件 PACKAGE.vcxproj。它正在构建它将创建安装程序。您可以从 Visual Studio 内部构建 PACKAGE 项目，也可以通过执行以下操作直接调用 msbuild：

```
msbuild /P:Configuration=Release PACKAGE.vcxproj 
```

从 VS 命令提示符中的构建目录中。

这应该会在您的构建目录中生成名为 MyLib-1.0.0-win64.exe 的安装程序。

如果您只想使用 CMake，那么调用 msbuild 的替代方法是：

```
cmake --build . --target PACKAGE.vcxproj --config Release 
```

或者您可以先构建解决方案，然后调用 CPack 来创建安装程序：

```
cmake --build . --config Release
cpack -C Release 
```

# c# - 将发布的图像转发到 WCF 休息服务

> ID：13144186
> 
> 赞同：1
> 
> 时间：2012-10-30T17:06:49.033
> 
> 标签：c#, wcf, httpwebrequest

我有一个用 C# 编写的 webform 应用程序，我想做的是在用户提交带有图像的 HTML 表单后，我将该图像发送到也用 C# 编写的 WCF Rest 服务。问题是当我在 Web 服务中获取图像时，它已损坏。

我想问题是我没有正确编码文件，但是在互联网上阅读了几天后，我还没有找到线索。

**网络表单代码：**

```
protected void Page_Load(object sender, EventArgs e)
{
     HttpPostedFile image = Request.Files["imagen"];
     string serverResponse = Send("mywebservice/postimage", "POST", Encoding.UTF8.GetBytes(StreamToString(image.InputStream)));
} 
```

**编辑（这种方式有效）**

```
protected void Page_Load(object sender, EventArgs e)
{
     HttpPostedFile image = Request.Files["imagen"];
     MemoryStream ms = new MemoryStream();
     image.InputStream.CopyTo(ms);
     byte[] bytes = ms.ToArray();
     string serverResponse = Send("mywebservice/postimage", "POST", bytes);
}

public int Send(string url, string method, byte[] data)
{
    string serverResponse = "";
    HttpWebRequest newRequest = (HttpWebRequest)WebRequest.Create(url);

    newRequest.ContentType = "image/jpeg";
    newRequest.Method = method;
    newRequest.Timeout = 10000;

    if (newRequest.Method == "POST" || newRequest.Method == "PUT")
    {
        Stream reqStream = newRequest.GetRequestStream();
        reqStream.Write(data, 0, data.Length);
        reqStream.Close();         
    }

    WSMessageEnt wsMessageEnt = new WSMessageEnt();

    try
    {
        HttpWebResponse webResponse;
        webResponse = (HttpWebResponse)newRequest.GetResponse();
        Stream dataStream = webResponse.GetResponseStream();
        serverResponse = new StreamReader(dataStream).ReadToEnd();

    }
    catch (WebException we)
    {

    }

    return serverResponse;
}

public static string StreamToString(Stream data)
{
    StreamReader reader = new StreamReader(data);
    string body = reader.ReadToEnd();
    reader.Close();
    reader.Dispose();

    return body;
} 
```

**网络服务代码：**

```
[WebInvoke(UriTemplate = "upload-user-image", Method = "POST")]
public Stream UploadUserImage(Stream streamdata)
{
     System.Drawing.Image img = System.Drawing.Image.FromStream(streamImagen, true);
     // here I get a format error
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T17:24:28.970

可能是一个问题：您正在将字节流转换为字符串，然后再转换回字节流。图像字节是任意字节，可能会或可能不会映射到字符串，并且您在一次转换中使用的编码 (Encoding.Default) 可能与在另一次转换中使用的编码不同 (Encoding.UTF8)。

而不是这样做：

```
Encoding.UTF8.GetBytes(StreamToString(image.InputStream)) 
```

尝试做类似的事情

```
MemoryStream ms = new MemoryStream();
image.InputStream.CopyTo(ms);
byte[] bytes = ms.ToArray(); 
```

或者只是将流传递给并将`Send`其复制到请求流。

# jquery-ui - 关闭某些元素的 jQuery UI 工具提示

> ID：13144188
> 
> 赞同：22
> 
> 时间：2012-10-30T17:07:03.870
> 
> 标签：jquery-ui, tooltip

为简单起见，我想在页面的所有元素上启用 jQuery UI 工具提示小部件：

然后为某些元素或元素及其后代禁用它。但这似乎不起作用：

```
$(document).tooltip({ track: true });
$('#menu *[title]').tooltip({ disabled: true }); 
```

我的`$('#menu *[title]')`选择器似乎按我的预期工作，获取所有具有 #menu 元素的 title 属性的后代元素。

那么为什么[禁用](http://api.jqueryui.com/tooltip/#option-disabled)选项不能`.tooltip({ disabled: true });`禁用这些元素的工具提示呢？是否有另一种方法和/或更好的方法来实现这一点？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-10-31T09:43:58.117

在所有元素上设置工具提示：

```
$('*').tooltip(); 
```

并禁用

```
$('#menu *[title]').tooltip('disable'); 
```

啦啦：

[jsFiddle](http://jsfiddle.net/uHuDp/1/)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2014-03-23T16:03:43.660

上面的答案都不适合我，现在这样做的方法似乎是使用[items 选项](http://api.jqueryui.com/tooltip/#option-items)：

```
$("*").tooltip({ items: ':not(.menu)' }); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-02-13T12:19:45.037

这些都不适合我，它一直让我发疯。

这对我有用：

`$(document).tooltip({ content: function () { return $(this).not('#NoTipDiv *[title]').attr('title'); });`

$('*').tootip 会严重延迟您的页面查看！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-12-14T13:45:56.763

如果您使用 selector 而不是`$(document)`，请不要忘记在适当的时候调用该代码。

```
$(document).tooltip({show: false});
$(document).ready( function(){
    $('#OK_Button').tooltip({disabled: true});
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-30T17:15:37.540

也许`$(':not(.menu *[title])').tooltip({ track: true });`？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-04-23T19:34:25.207

根据我的回答日期的 jQueryUI 文档。

`$( ".selector" ).tooltip( "option", "disabled", true );`

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-05-24T08:25:43.840

这就是我现在正在做的事情..

显示工具提示：

*   排除任何具有“noToolTip”类的内容。
*   然后包括这些：
    *   具有 TITLE 属性的元素。
    *   具有 ALT 属性的 IMG 元素。
    *   任何具有类“工具提示”和 TITLE 属性的东西。

这是我的 JavaScript 代码。

```
// Set up tool tips for images and anchors.
$( document ).tooltip({
   items: "img[alt], a[title], .toolTip[title], :not(.noToolTip)",
   track: true,
   content: function() {
      var element = $( this );
      // noToolTip means NO TOOL TIP.
      if ( element.is( ".noToolTip" ) ) {
         return null;
      }
      // Anchor - use title.
      if ( element.is( "a[title]" ) ) {
         return element.attr( "title" );
      }
      // Image - use alt.
      if ( element.is( "img[alt]" ) ) {
         return element.attr( "alt" );
      }
      // Any element with toolTip class - use title.
      if ( element.is( ".toolTip[title]" ) ) {
         return element.attr( "title" );
      }
   }
}); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-02-10T05:52:25.567

对于在 ASP.NET MVC Razor 页面中遇到此问题的任何人。这是由于剃须刀助手。您需要将以下内容添加到 @Html.EditorFor 属性。

```
 autocomplete = "off" 
```

下面是一个示例表单组，您可以在其中执行此操作。

```
<div class="form-group">
   @Html.LabelFor(model => model.Field, htmlAttributes: new { @class = "control-label col-md-2" })
   <div class="col-md-10">
      @Html.EditorFor(model => model.Field, new { htmlAttributes = new { @class = "form-control date-field", autocomplete = "off" } })
      @Html.ValidationMessageFor(model => model.Field, "", new { @class = "text-danger" })
   </div>
</div> 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2017-12-20T19:36:32.707

以上都没有为我工作......但这确实（在初始化之后）：

```
$("#selector").tooltip("disable"); 
```

# image-processing - JAI：如何将 4 波段 32 位 CMYK 图像转换为 PNG？

> ID：13144189
> 
> 赞同：1
> 
> 时间：2012-10-30T17:07:04.417
> 
> 标签：image-processing, tiff, java-2d, jai

我正在尝试将图像转换为 PNG 格式，我拥有的数据是由 LZW 压缩的 4 波段 32 位类似 TIFF 的图像。通过使用 Java2D 和 JAI，我现在有未压缩的数据来表示 CMYK 空间中的颜色，并且可以在存储在 tiff 中时以与 4 波段 32 位格式相同的设置导出和查看。

问题是当我尝试转换为PNG等其他格式时，它会产生零大小的数据，所以我想问一下有没有人在转换此类图像方面有类似的经验？我把我的一些代码贴在下面供大家参考，如果发现错误还请指正，谢谢！！

```
int bands = 4;
int w = sizeParam.getHorizonPts();
int h = sizeParam.getVerticalPts();
ColorModel cm = new ComponentColorModel(new CMYKColorSpace(), new int[]{8,8,8,8},
                false, false, Transparency.OPAQUE, DataBuffer.TYPE_FLOAT);

// Create WritableRaster with four bands
WritableRaster r = RasterFactory.createBandedRaster(
                DataBuffer.TYPE_FLOAT, w, h, bands, null);
for (int i = 0; i < bandStreams.length; i++) {
        int x, y;
        x = y = 0;
        byte[] uncomp = new byte[w * h];
        decoder.decode(bandStreams[i], uncomp, h);
        for (int pos = 0; pos < uncomp.length; pos++) {
                r.setSample(x++, y, i, (float) (uncomp[pos] & 0xff) / 255);
                if (x >= w) {
                        x = 0;
                        y++;
                }
        }
}

// Create TiledImage
TiledImage tiledImage = new TiledImage(0, 0, w, h, 0, 0,
                RasterFactory.createBandedSampleModel(DataBuffer.TYPE_FLOAT, w,
                                h, bands), cm);
tiledImage.setData(r);
JAI.create("filestore", tiledImage, "test.tif", "TIFF"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T23:21:28.513

我终于通过将 CMYK 转换为 RGB 来解决这个问题，这样它就可以生成 PNG 图像，课程中使用了以下代码，

```
// Create target image with RGB color.
BufferedImage result = new BufferedImage(w, h,
            BufferedImage.TYPE_INT_RGB);

// Convert pixels from YMCK to RGB.
ColorConvertOp cmykToRgb = new ColorConvertOp(new CMYKColorSpace(),
            result.getColorModel().getColorSpace(), null);
cmykToRgb.filter(r, result.getRaster()); 
```

# c# - 使用 Json.Net 处理数据中的换行符

> ID：13144190
> 
> 赞同：7
> 
> 时间：2012-10-30T17:07:04.620
> 
> 标签：c#, asp.net-web-api, newline, json.net

有什么方法可以处理 JSON.NET 中的换行符。我有一些数据通过回车换行返回，而 Json.Net 只是将其原始保留在返回值中。有没有办法强制 Json.Net 为 Json 进行编码。我认为默认情况下会发生这种情况，但对我来说并没有发生。也许我错过了其他东西。

如果这很重要，我将在 MVC4 WebApi 项目中使用 Json.Net。

我的数据以字符串中的 \r\n 形式返回，例如

```
 "Keywords": "These are my keywords.\r\n\r\n\r\nThis is a second line...\r\n\r\nThis is a third line. ...\r\n\r\n\r\nThis is a 4th line ..." 
```

据我了解，应该是这样 `\\r\\n`。我返回的数据可能有问题，但我只是想看看 JSON.NET 应该对此做什么。

* * *

## 回答 #1

> 赞同：-4
> 
> 时间：2012-10-30T17:18:21.437

您可以使用 Formatting.Indented 选项序列化您的对象。像这样：

```
string yourJsonString = JsonConvert.SerializeObject(yourObject,  Formatting.Indented, new JsonSerializerSettings { }); 
```

我认为这应该有效。

问候。

# c# - NHibernate & NET Persistence API 在测试项目中不起作用

> ID：13144195
> 
> 赞同：0
> 
> 时间：2012-10-30T17:07:12.270
> 
> 标签：c#, nhibernate, nunit, persistence

在我的数据访问层（DAL）（类库项目）中创建 EntityManager 时出现以下错误：

文件名：'Iesi.Collections，Version=1.0.1.0，Culture=neutral，PublicKeyToken=aa95f207798dfdb4'---> System.NotSupportedException：试图从网络位置加载程序集，这会导致程序集在 .NET Framework 的早期版本中被沙盒化。此版本的 .NET Framework 默认情况下不启用 CAS 策略，因此这种加载可能很危险。如果此加载不打算对程序集进行沙箱处理，请启用 loadFromRemoteSources 开关。有关详细信息，请参阅[http://go.microsoft.com/fwlink/?LinkId=155569](http://go.microsoft.com/fwlink/?LinkId=155569)。

我从我返回 NUnit 测试用例的 TestProject（类库项目）中收到此错误。

我有一个也调用 DAL 的 Web 应用程序，但在此调用期间它能够正确创建 EntityManager。实际上我需要在配置文件中添加以下行以避免上述错误：

```
<runtime>
        <loadFromRemoteSources enabled="true" />
</runtime> 
```

现在的问题是，我显然已将这些行添加到我的 web.config 中，那就是我能够创建 EntityManager。但是我怎样才能将此行添加到我的 TestProject （这是一个控制台库），因为它不会有与之关联的配置文件。

PS：我正在使用 NHibernate 和 NET Persistence API。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T19:33:05.183

您必须复制 bin 目录中的 Iesi.Collections，最简单的方法是在您的测试项目中添加引用。

# mysql - 由于关系，DataMapper 无法删除记录

> ID：13144198
> 
> 赞同：2
> 
> 时间：2012-10-30T17:07:33.807
> 
> 标签：mysql, ruby, orm, relational-database, datamapper

我有这个带有 Torrent 和 Tag 的很多 DataMapper/MySQL 设置，如下所示：

```
class Torrent
  include DataMapper::Resource

  property :id,          Serial
  property :name,        String
  property :magnet,      Text
  property :created_at,  DateTime

  has n, :tags, :through => Resource
end

class Tag
  include DataMapper::Resource

  property :id,      Serial
  property :name,    String
  property :hits,    Integer

  has n, :torrents, :through => Resource
end 
```

但是，当尝试通过`Torrent.first.destroy`或类似的方式销毁种子时，DataMapper 会返回`false`.

我尝试了类似的直接 SQL 查询`delete from torrents where name like '%ubuntu%'`，但由于 MySQL 错误 1451 而失败：

```
ERROR 1451 (23000): Cannot delete or update a parent row: a foreign key constraint fails (`brightswipe`.`tag_torrents`, CONSTRAINT `tag_torrents_torrent_fk` FOREIGN KEY (`torrent_id`) REFERENCES `torrents` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION) 
```

我认为有一些 DataMapper 设置，在删除种子时我可以：

1.  删除标签关联
2.  删除种子

删除标签时，我可以：

1.  从具有该标签的所有种子中删除标签关联
2.  删除标签

我该怎么办？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-30T17:11:09.823

尝试使用此插件自动管理关系：

[https://github.com/datamapper/dm-constraints](https://github.com/datamapper/dm-constraints)

这将允许您销毁 M:M assocs，尽管您必须手动清理 assocs 表：

```
class Tag
  ...
  has n, :torrents, :through => Resource, :constraint => :skip

class Torrent
  ...
  has n, :tags, :through => Resource, :constraint => :skip 
```

**另一种选择**是手动从 assocs 表中删除关系，然后您可以毫无问题地删除项目，因为您通过从 assocs 表中删除相应条目来破坏关系。

基本示例：

```
tr = Torrent.create
tg = Tag.create

tr.tags << tg
tr.save

tg.torrents << tr
tg.save

# destroying relation

TagTorrent.first(:tag => tg, :torrent => tr).destroy!

# or
tr.tag_torrents(:tag => tg).destroy

# or
tg.tag_torrents(:torrent => tr).destroy

# destroy items

tr.destroy!
tg.destroy! 
```

# cuda - CUDA 内存传输问题

> ID：13144207
> 
> 赞同：1
> 
> 时间：2012-10-30T17:08:09.690
> 
> 标签：cuda, gpu

我正在尝试执行一个代码，该代码首先将数据从 CPU 传输到 GPU 内存，反之亦然。尽管增加了数据量，但数据传输时间保持不变，就好像实际上没有数据传输发生一样。我正在发布代码。

```
#include <stdio.h>  /* Core input/output operations                         */
#include <stdlib.h> /* Conversions, random numbers, memory allocation, etc. */
#include <math.h>   /* Common mathematical functions                        */
#include <time.h>   /* Converting between various date/time formats         */
#include <cuda.h>   /* CUDA related stuff                                   */
#include <sys/time.h>
__global__ void device_volume(float *x_d,float *y_d)
{
    int index = blockIdx.x * blockDim.x + threadIdx.x;
}

int main(void)
{
    float *x_h,*y_h,*x_d,*y_d,*z_h,*z_d;
    long long  size=9999999;
    long long nbytes=size*sizeof(float);

    timeval t1,t2;
    double et;

    x_h=(float*)malloc(nbytes);
    y_h=(float*)malloc(nbytes);

    z_h=(float*)malloc(nbytes);

    cudaMalloc((void **)&x_d,size*sizeof(float));
    cudaMalloc((void **)&y_d,size*sizeof(float));
    cudaMalloc((void **)&z_d,size*sizeof(float));
    gettimeofday(&t1,NULL);

    cudaMemcpy(x_d, x_h, nbytes, cudaMemcpyHostToDevice);
    cudaMemcpy(y_d, y_h, nbytes, cudaMemcpyHostToDevice);
    cudaMemcpy(z_d, z_h, nbytes, cudaMemcpyHostToDevice);

    gettimeofday(&t2,NULL);
    et = (t2.tv_sec - t1.tv_sec) * 1000.0;      // sec to ms
    et += (t2.tv_usec - t1.tv_usec) / 1000.0;   // us to ms
    printf("\n %ld\t\t%f\t\t",nbytes,et);
    et=0.0;
    //printf("%f %d\n",seconds,CLOCKS_PER_SEC); 

    // launch a kernel with a single thread to greet from the device
    //device_volume<<<1,1>>>(x_d,y_d);
    gettimeofday(&t1,NULL);

    cudaMemcpy(x_h, x_d, nbytes, cudaMemcpyDeviceToHost);
    cudaMemcpy(y_h, y_d, nbytes, cudaMemcpyDeviceToHost);
    cudaMemcpy(z_h, z_d, nbytes, cudaMemcpyDeviceToHost);

    gettimeofday(&t2,NULL);

    et = (t2.tv_sec - t1.tv_sec) * 1000.0;      // sec to ms
    et += (t2.tv_usec - t1.tv_usec) / 1000.0;   // us to ms
    printf("%f\n",et);
    cudaFree(x_d);
    cudaFree(y_d);
    cudaFree(z_d); 
    return 0;
} 
```

有人可以帮我解决这个问题吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T04:57:20.027

1.  尝试使用 cudaEvent 来捕获 GPU 代码的时间。
2.  尝试使用 Visual profiler 查看在 memcpy 上花费了多少时间。分析器将显示每个 cuda 相关操作在 GPU 上花费的所有执行时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T17:48:39.717

它保持不变，因为它需要相同的时间。在您的代码中，您不会添加传输时间。

# jsf-2 - 更改 Rich:pickList 按钮的默认图像

> ID：13144209
> 
> 赞同：0
> 
> 时间：2012-10-30T17:08:16.590
> 
> 标签：jsf-2, richfaces

如何更改按钮的默认图像？没有这样的属性，也没有使用构面的选项。我已经用谷歌搜索了一段时间，但仍然没有找到解决方案。感谢您的回答！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T17:24:59.297

我的耻辱。看来日子过得太苦了：）

> 给定属性的替代方案是以下方面： "copyAllControl" 、 "removeAllControl" 、 "copyControl" 、 "removeControl" 、 >"copyAllControlDisabled" 、 "removeAllControlDisabled" 、 "copyControlDisabled" 、 >"removeControlDisabled" 、 "caption" 。

我希望这对某人有帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T17:17:45.850

Facets 对我不起作用，因为我试图将它附加到禁用的按钮上。所以解决方案：

```
<f:facet name="copyControl"> 
  <h:commandButton image="path/to/image" /> 
</f:facet> 
```

工作正常，但我仍然不知道如何将图像附加到禁用元素

# java - Java复制两个哈希图

> ID：13144213
> 
> 赞同：1
> 
> 时间：2012-10-30T17:08:31.697
> 
> 标签：java

我有一个包含 Map 的类，其键是字符串，值是另一个类的对象。

```
 Class Employee {
               String name;
          }

          Class Company {
              Map<String, Employee> m =new HashMap<String, Employee>();
          } 
```

我有两个 Company 对象 obj1 和 obj2，我想将地图从一个对象复制到另一个对象。

如果我做以下任何事情，

```
 obj1 = obj2  or    
         obj1.setM(obj2.getM())   // assume we have setters and getters 
```

现在，如果我操作 obj1 的映射，使任何值指向 Employee 的不同对象，用于 obj2 具有的同一 Company 对象，其中 obj2 的映射也受到影响。

有什么办法（除了将键和值复制到新映射并将其分配给对象），我们可以将映射内容复制到另一个对象的映射，这样操作一个映射不会影响另一个映射。任何建议都非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T17:14:28.543

如果你只需要复制*地图*，你可以使用

```
new HashMap<String, Employee>(mapToCopy); 
```

如果需要修改员工，则需要直接复制这些对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T17:12:49.200

如果我错了，请纠正我，但是当您分配`Employee`给每个时，您`Map`正在分配*Object Reference*。对于每次插入，`Map`如果您想拥有一个独特的项目，您需要对`clone()`对象执行某种形式的方法。

例如，该`getM()`函数可能应该返回这种形式...

```
public Employee getM() {
  return new Employee(name,id,....) //constructor to set identical attributes
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T17:13:34.550

尝试：

```
obj1 = HashMap<Employee, Company> obj2.clone(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-30T17:27:02.553

前段时间我读过这篇关于[深拷贝和浅拷贝的文章，并为它加了书签。](http://www.jusfortechies.com/java/core-java/deepcopy_and_shallowcopy.php)它在帮助您理解深拷贝（克隆和序列化变体）和浅拷贝机制方面做得很好。每种复制机制的限制和问题。

# winapi - AVG 将我的程序检测为病毒。这里有什么问题？

> ID：13144216
> 
> 赞同：2
> 
> 时间：2012-10-30T17:08:57.253
> 
> 标签：winapi, antivirus, trojan

AVG 表示从以下代码编译的可执行文件是高优先级的“特洛伊木马 PSW.Agent.AYRW”。这里有什么问题，或者这只是一个虚惊？

```
#include <windows.h>

const char g_szClassName[] = "myWindowClass";

LRESULT CALLBACK WndProc(HWND hwnd, UINT msg, WPARAM wParam, LPARAM lParam)
{
    switch(msg)
    {
        case WM_LBUTTONDOWN:
        {
            char szFileName[MAX_PATH];
            HINSTANCE hInstance = GetModuleHandle(NULL);

            GetModuleFileName(hInstance, szFileName, MAX_PATH);
            MessageBox(hwnd, szFileName, "This program is:", MB_OK | MB_ICONINFORMATION);
        }
        break;
        case WM_CLOSE:
            DestroyWindow(hwnd);
        break;
        case WM_DESTROY:
            PostQuitMessage(0);
        break;
        default:
            return DefWindowProc(hwnd, msg, wParam, lParam);
    }
    return 0;
}

int WINAPI WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance,
    LPSTR lpCmdLine, int nCmdShow)
{
    WNDCLASSEX wc;
    HWND hwnd;
    MSG Msg;

    wc.cbSize        = sizeof(WNDCLASSEX);
    wc.style         = 0;
    wc.lpfnWndProc   = WndProc;
    wc.cbClsExtra    = 0;
    wc.cbWndExtra    = 0;
    wc.hInstance     = hInstance;
    wc.hIcon         = LoadIcon(NULL, IDI_APPLICATION);
    wc.hCursor       = LoadCursor(NULL, IDC_ARROW);
    wc.hbrBackground = (HBRUSH)(COLOR_WINDOW+1);
    wc.lpszMenuName  = NULL;
    wc.lpszClassName = g_szClassName;
    wc.hIconSm       = LoadIcon(NULL, IDI_APPLICATION);

    if(!RegisterClassEx(&wc))
    {
        MessageBox(NULL, "Window Registration Failed!", "Error!",
            MB_ICONEXCLAMATION | MB_OK);
        return 0;
    }

    hwnd = CreateWindowEx(
        WS_EX_CLIENTEDGE,
        g_szClassName,
        "The title of my window",
        WS_OVERLAPPEDWINDOW,
        CW_USEDEFAULT, CW_USEDEFAULT, 240, 120,
        NULL, NULL, hInstance, NULL);

    if(hwnd == NULL)
    {
        MessageBox(NULL, "Window Creation Failed!", "Error!",
            MB_ICONEXCLAMATION | MB_OK);
        return 0;
    }

    ShowWindow(hwnd, nCmdShow);
    UpdateWindow(hwnd);

    while(GetMessage(&Msg, NULL, 0, 0) > 0)
    {
        TranslateMessage(&Msg);
        DispatchMessage(&Msg);
    }
    return Msg.wParam;
} 
```

这真的是在制造病毒吗？

编辑：这现在变得更加重要，因为如果没有 Windows 限制我的访问权限，我什至无法将程序编译到其原始位置。抱怨... AVG 2012 好多了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T08:17:11.200

让 AVG 知道这是误报[http://samplesubmit.avg.com/](http://samplesubmit.avg.com/)

# git - lntelliJ IDEA EAP 12 和 Bitbucket（Git 或 Mercurial）

> ID：13144218
> 
> 赞同：2
> 
> 时间：2012-10-30T17:09:01.110
> 
> 标签：git, mercurial, intellij-idea, dvcs, bitbucket

我的系统设置是

1.  Windows 7 64 位
2.  IntelliJ IDEA EAP 12 版本 122.639
3.  Java 1.6
4.  我是非管理员用户。

[我有一个 android 项目，我想在Bitbucket](https://bitbucket.org)上进行版本控制。我曾尝试使用 IntelliJ IDEA 中的内置 VCS 来创建 git/mercurial，但对于他们两者，我都收到关于**hg.exe** / **git.cmd** not found 的错误。

仅供参考，我必须从 GitHub 上签出一些东西，并且它没有问题。我还安装了 BitBucket 插件。

**如何使用 IntelliJ IDEA 中的内置 VCS 为我的本地项目创建 git/Mercurial 存储库并将它们保存在我的 Bitbucket 帐户中。**

**编辑** @crazycoder

我已按照您的建议安装了 msysgit，这是您要求的 git 路径配置屏幕。 ![Git 路径配置](../Images/d40573a894051f8d59db142db78a9850.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T17:21:47.977

IntelliJ IDEA 不捆绑 Git/Mercurial 版本控制系统，它提供集成，但工具需要单独安装。

另请参阅相关问题：

*   [将 RubyMine 与 GitHub for Windows 集成](https://stackoverflow.com/q/11497506/104891)
*   [git.exe 位于哪里？](https://stackoverflow.com/q/11928561/104891)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T17:15:39.147

没有把握。但我会认真考虑安装 MSysGit 并改用命令行。您可以使用 ctrl-R 在键入时进行历史跟踪，让您可以查看几天前为使该变基工作所做的工作等。其他好处是分支和路径的制表符补全、命令管道并且更容易帮助解决问题，因为它是纯 git，与 intelliJ 的 git 实现/集成相比，您将获得更多帮助。

# java - EntityManager 能知道它已经死了吗？

> ID：13144219
> 
> 赞同：2
> 
> 时间：2012-10-30T17:09:03.310
> 
> 标签：java, jpa

我的代码：

```
emf = Persistence.createEntityManagerFactory("cassandra_pu");
em = emf.createEntityManager(); 
```

我动态更改 persistence.xml 以更改为 cassandra_pu 单元的 IP 地址。但是，它可能执行得太快，因此返回旧实体管理器而不是新实体管理器。有没有办法检查创建的 em 实体管理器是否足够好用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T18:44:16.213

它可能取决于正在使用的 EJB 容器，但通常`persistence.xml`在下一次重新部署应用程序之前不会反映对的更改 - 因此“旧”实体管理器将一遍又一遍地返回，直到您重新部署。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T22:02:14.103

一些提供商允许它，但它是本机功能。查看 Eclipselink 的 refreshMetadata() 以了解更改。但是如果只有数据库连接/模式不同，您应该使用新的 PU。只需指定 ORM.xml 以根据需要覆盖表和方案名称，您就可以重用类

# java - 如何实现一个鼠标侦听器，它返回鼠标在 JTable 中指向的字符？

> ID：13144221
> 
> 赞同：1
> 
> 时间：2012-10-30T17:09:23.587
> 
> 标签：java, swing, jtable, listener, mouselistener

我有一个带有鼠标监听器的 JTable。我需要获取已在表格单元格中单击的字符。我可以获得行号和列号，但我无法获得`Element`鼠标指向的（我认为必须是表格单元格中的字符）。有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T17:25:24.893

*   [JTable.rowAtPoint()](http://docs.oracle.com/javase/7/docs/api/javax/swing/JTable.html#rowAtPoint%28java.awt.Point%29)和[JTable.columnAtPoint()](http://docs.oracle.com/javase/7/docs/api/javax/swing/JTable.html#columnAtPoint%28java.awt.Point%29)从未知返回[getValueAt(int row, int column)](http://docs.oracle.com/javase/7/docs/api/javax/swing/JTable.html#getValueAt%28int,%20int%29)`mouseevent`协调（不确定是否存在[MouseListener](http://docs.oracle.com/javase/tutorial/uiswing/events/mouselistener.html)或[MouseMotionListener](http://docs.oracle.com/javase/tutorial/uiswing/events/mousemotionlistener.html)）

*   更有效的是将[ListSelectionListener](http://docs.oracle.com/javase/tutorial/uiswing/events/listselectionlistener.html)添加到[JTable (SINGLE_SELECTION_Model)](http://docs.oracle.com/javase/tutorial/uiswing/components/table.html#selection)，因为监听事件也来自键盘

*   我希望您的问题不是关于[为单元格指定工具提示](http://docs.oracle.com/javase/tutorial/uiswing/components/table.html#celltooltip)

# tridion - 64 位应用程序池中的 Tridion 2011

> ID：13144225
> 
> 赞同：5
> 
> 时间：2012-10-30T17:09:38.030
> 
> 标签：tridion, tridion-2011

是否可以在 IIS 7.5 下的 x64 经典管道应用程序池中运行 SDL Tridon 2011 SP1 HR1。

请求的原因是我的 SSO 提供程序包含一个 ISAPI 过滤器，由于 IIS 7.5 中的安全性提高，该过滤器必须在 x64 池中以经典模式运行。

当前错误：

```
Retrieving the COM class factory for component with CLSID {4ED977D7-A765-11D5-8071-00B0D0B98279} failed due to the following error: 80040154 Class not registered (Exception from HRESULT: 0x80040154 (REGDB_E_CLASSNOTREG)). 
```

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-10T18:24:31.650

根据我的研究，您**必须** 在 Tridion 2011 App_Pool 上*“启用 32 位应用程序” 。*

![IIS 7 - 启用 32 位应用程序](../Images/7317a0dc18bf0c51c337cd168ba9b295.png)

我听说这将为 Tridion 2013 排序。

# c# - 如何获取类库中内容的文件路径

> ID：13144228
> 
> 赞同：8
> 
> 时间：2012-10-30T17:10:08.210
> 
> 标签：c#, class-library

`content`我有一个 Excel 文件，它在类库中具有构建操作。ASP.NET WebForms 应用程序和控制台应用程序都引用了该库，并且两者都使用 Excel 文件。有没有办法以编程方式获取该文件的文件路径？

我知道在 ASP 中我可以做到这一点：

```
HttpContext.Current.Server.MapPath(@"bin") 
```

在控制台应用程序中，我可以这样做：

```
Path.GetDirectoryName(System.Reflection.Assembly.GetEntryAssembly().Location) 
```

这些工作，但我想知道是否有更好、更统一的方法来从程序集中找到文件并返回路径。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T17:18:28.990

第二种方法在所有环境中都可以正常工作，您只需对其进行更改，使其不查找条目程序集而是查找特定程序集。

最简单的方法是：

```
typeof(Some.Type.From.That.Assembly).Assembly.Location 
```

另一种方法是使用嵌入式资源，以便您可以直接从程序集中加载文件。当然，如果文件必须由用户写入，这将不起作用。

# c++ - 带有 CV_SHAPE_ELLIPSE 的 OpenCV cv::getStructuringElement 生成一个黑色正方形

> ID：13144229
> 
> 赞同：2
> 
> 时间：2012-10-30T17:10:22.167
> 
> 标签：c++, opencv

我正在尝试对我的图像执行膨胀并希望使用光盘进行膨胀操作。但无论我在尝试什么，我总是最终得到一个黑色方块：

```
dilSize = 12;
kern = cv::getStructuringElement( CV_SHAPE_ELLIPSE, cv::Size( dilSize + 1, dilSize + 1 ) );

cv::dilate( im, im, kern, cv::Point( -1, -1 ), 10 );
cv::imwrite( "ker.png", ker ); 
```

结果是 PNG 图像中的 13x13 像素黑色正方形...

我究竟做错了什么？

问候

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-30T18:50:20.597

好的，因为 cv::getStructuringElement 只是创建零和一，所以没有光学差异。

添加：

```
kernel *= 255; 
```

在写图像之前，解开谜团；）

# mysql - 两个选定 SQL 语句的结果的划分

> ID：13144230
> 
> 赞同：1
> 
> 时间：2012-10-30T17:10:28.643
> 
> 标签：mysql, sql, select

所以这是我的问题：

我有 2 个不同的 sql 选择查询，它们都返回一个值（1425000 和 2850000）我现在想要做的是：

```
Select (query1 / query 2)
from xxxxx
where xxxx; 
```

但是查询 1 和查询 2 是安静的复杂查询，其中包含计数和求和函数。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T17:15:45.643

```
declare @q1 int, @q2 int

select @q1 = (query1)
select @q2 = (query2)

select @q1 / @q2 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T17:17:35.103

```
SELECT t1.val / t2.val
FROM   (SELECT val
        FROM   foo) t1
       INNER JOIN (SELECT val
                   FROM   bar) t2 
```

`(SELECT val FROM foo)`并且`(SELECT val FROM bar)`可以用任意`SELECT`语句替换。

有关演示，请参见[sqlfiddle](http://www.sqlfiddle.com/#!2/018c6/13)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-30T17:24:14.020

你可以为这样的事情创建视图。

```
create view vResult1 as
select your(
         complicated(
           query(
             here()
           )
         )
       );

create view vResult2 as
select another(
         complicated(
           query(
             here()
           )
         )
       ); 
```

然后你可以运行它们：

```
select vResult1/vResult2; 
```

如果您需要复杂查询的参数 - 您可以使用[存储过程](http://en.wikipedia.org/wiki/Stored_procedure)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-30T17:24:24.557

我认为你将不得不使用变量..如果你不想在一个查询中全部写出来。

```
SET @query1_result = (Select ... complicated query 1)
SET @query2_result = (Select ... complicated query 2)

Select @query1_result / @query2_result 
```

# javascript - CakePHP 2.0：如何切换到 js 布局？

> ID：13144231
> 
> 赞同：-1
> 
> 时间：2012-10-30T17:10:31.777
> 
> 标签：javascript, cakephp

我想在我的一个控制器中执行一个操作来输出纯 javascript，但是我在书中找不到任何关于实现此目的的正确方法的内容。

我试过`$this->response->type('js');`哪个确实设置`Content-Type: text/javascript; charset=UTF-8`但没有将布局更改为 Layouts/js/default.ctp

我一直在寻找帖子说要使用`$this->RequestHandler->renderAs($this, 'js')` ，但好像该方法不再存在：[app\views\layouts\js 的用途是什么？](https://groups.google.com/forum/?fromgroups=#!topic/cake-php/wZu0NGguQxg)

到目前为止唯一有效的是`$this->layoutPath = "js";`：[如何更改 cakephp 布局？](http://www.balistupa.com/blog/2009/07/how-to-change-cakephp-layout/)

不过，这篇文章好像是从Cake 1.3天开始的。这仍然是切换到 js 布局的正确方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T19:19:40.483

`RequestHandlerComponent::renderAs`还存在：

[http://book.cakephp.org/2.0/en/core-libraries/components/request-handling.html#RequestHandlerComponent::renderAs](http://book.cakephp.org/2.0/en/core-libraries/components/request-handling.html#RequestHandlerComponent::renderAs)

不要忘记在您的控制器中包含请求处理程序组件，然后它应该可以正常工作。

```
public $components = array
(
    'RequestHandler'
);

public function action()
{
    $this->RequestHandler->renderAs($this, 'js');
} 
```

# configuration - 大 Cassandra 查询导致守护进程崩溃

> ID：13144232
> 
> 赞同：0
> 
> 时间：2012-10-30T17:10:32.680
> 
> 标签：configuration, nosql, cassandra, out-of-memory

需要从 CentOS 6.3 版虚拟机上运行的 cassandra 1.1.6 数据库读取约 2.5Gb 的记录。当查询具有默认开箱即用配置的守护程序时，我收到错误：

```
 INFO [Thread-2] 2012-10-30 20:05:13,345 CassandraDaemon.java (line 212) Listening for thrift clients...
 WARN [ScheduledTasks:1] 2012-10-30 20:06:27,076 GCInspector.java (line 145) Heap is 0.8434091049049706 full.  You may need to reduce memtable and/or
 WARN [ScheduledTasks:1] 2012-10-30 20:06:27,077 StorageService.java (line 2855) Flushing CFS(Keyspace='system', ColumnFamily='Versions') to relieve m
 INFO [ScheduledTasks:1] 2012-10-30 20:06:27,077 ColumnFamilyStore.java (line 659) Enqueuing flush of Memtable-Versions@1970754472(83/103 serialized/l
 INFO [FlushWriter:2] 2012-10-30 20:06:27,078 Memtable.java (line 264) Writing Memtable-Versions@1970754472(83/103 serialized/live bytes, 3 ops)
 INFO [FlushWriter:2] 2012-10-30 20:06:27,096 Memtable.java (line 305) Completed flushing /var/lib/cassandra/data/system/Versions/system-Versions-hf-1
 WARN [ScheduledTasks:1] 2012-10-30 20:06:28,793 GCInspector.java (line 139) Heap is 0.9390217139392345 full.  You may need to reduce memtable and/or
 WARN [ScheduledTasks:1] 2012-10-30 20:06:28,794 AutoSavingCache.java (line 156) Reducing KeyCache capacity from 2075306 to 12 to reduce memory pressu
 WARN [ScheduledTasks:1] 2012-10-30 20:06:28,794 GCInspector.java (line 145) Heap is 0.9390217139392345 full.  You may need to reduce memtable and/or
 INFO [ScheduledTasks:1] 2012-10-30 20:06:28,795 StorageService.java (line 2851) Unable to reduce heap usage since there are no dirty column families
 WARN [ScheduledTasks:1] 2012-10-30 20:06:30,181 GCInspector.java (line 145) Heap is 0.9984246325381808 full.  You may need to reduce memtable and/or
 INFO [ScheduledTasks:1] 2012-10-30 20:06:30,182 StorageService.java (line 2851) Unable to reduce heap usage since there are no dirty column families
 WARN [ScheduledTasks:1] 2012-10-30 20:06:34,740 GCInspector.java (line 145) Heap is 0.9983338780063149 full.  You may need to reduce memtable and/or
 INFO [ScheduledTasks:1] 2012-10-30 20:06:34,741 StorageService.java (line 2851) Unable to reduce heap usage since there are no dirty column families
ERROR [ReadStage:33] 2012-10-30 20:06:34,843 AbstractCassandraDaemon.java (line 135) Exception in thread Thread[ReadStage:33,5,main]
java.lang.OutOfMemoryError: Java heap space
<------>at org.apache.cassandra.io.util.RandomAccessReader.readBytes(RandomAccessReader.java:323)
<------>at org.apache.cassandra.utils.ByteBufferUtil.read(ByteBufferUtil.java:398)
<------>at org.apache.cassandra.utils.ByteBufferUtil.readWithLength(ByteBufferUtil.java:363)
<------>at org.apache.cassandra.db.ColumnSerializer.deserialize(ColumnSerializer.java:120)
<------>at org.apache.cassandra.io.util.ColumnIterator.deserializeNext(ColumnSortedMap.java:255)
<------>at org.apache.cassandra.io.util.ColumnIterator.next(ColumnSortedMap.java:275)
<------>at org.apache.cassandra.io.util.ColumnIterator.next(ColumnSortedMap.java:232)
<------>at edu.stanford.ppl.concurrent.SnapTreeMap.<init>(SnapTreeMap.java:453)
<------>at org.apache.cassandra.db.AtomicSortedColumns$Holder.<init>(AtomicSortedColumns.java:311)
<------>at org.apache.cassandra.db.AtomicSortedColumns.<init>(AtomicSortedColumns.java:77)
<------>at org.apache.cassandra.db.AtomicSortedColumns.<init>(AtomicSortedColumns.java:48)
<------>at org.apache.cassandra.db.AtomicSortedColumns$1.fromSorted(AtomicSortedColumns.java:61)
<------>at org.apache.cassandra.db.SuperColumnSerializer.deserialize(SuperColumn.java:399)
<------>at org.apache.cassandra.db.SuperColumnSerializer.deserialize(SuperColumn.java:382)
<------>at org.apache.cassandra.db.SuperColumnSerializer.deserialize(SuperColumn.java:377)
<------>at org.apache.cassandra.db.SuperColumnSerializer.deserialize(SuperColumn.java:339)
<------>at org.apache.cassandra.db.columniterator.SimpleSliceReader.computeNext(SimpleSliceReader.java:79)
<------>at org.apache.cassandra.db.columniterator.SimpleSliceReader.computeNext(SimpleSliceReader.java:39)
<------>at com.google.common.collect.AbstractIterator.tryToComputeNext(AbstractIterator.java:140)
<------>at com.google.common.collect.AbstractIterator.hasNext(AbstractIterator.java:135)
<------>at org.apache.cassandra.db.columniterator.SSTableSliceIterator.hasNext(SSTableSliceIterator.java:116)
<------>at org.apache.cassandra.utils.MergeIterator$Candidate.advance(MergeIterator.java:147) 
```

没有太多时间来计算堆/内存表等的大小，补充说

```
JVM_OPTS="-Xms4g -Xmx4g" 
```

到守护进程配置（测试服务器有 8 gigs 的 ram）。查询再次失败

```
ERROR [ReadStage:1] 2012-10-30 20:46:22,417 AbstractCassandraDaemon.java (line 135) Exception in thread Thread[ReadStage:1,5,main]
java.lang.RuntimeException: java.lang.IllegalArgumentException
        at org.apache.cassandra.service.RangeSliceVerbHandler.doVerb(RangeSliceVerbHandler.java:71)
        at org.apache.cassandra.net.MessageDeliveryTask.run(MessageDeliveryTask.java:59)
        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(Unknown Source)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
        at java.lang.Thread.run(Unknown Source)
Caused by: java.lang.IllegalArgumentException
        at org.apache.cassandra.io.util.FastByteArrayOutputStream.<init>(FastByteArrayOutputStream.java:78)
        at org.apache.cassandra.io.util.DataOutputBuffer.<init>(DataOutputBuffer.java:40)
        at org.apache.cassandra.db.RangeSliceReply.getReply(RangeSliceReply.java:48)
        at org.apache.cassandra.service.RangeSliceVerbHandler.doVerb(RangeSliceVerbHandler.java:64)
        ... 4 more 
```

我无法进一步调试。有谁知道我如何调整 Cassandra 以便我可以运行该查询？数据库有约 500 个超列，每个约 7 mb。我需要全部阅读它们，并且在某些时候在内存中（客户端机器有 40 gigs 的 ram，所以 100% 不是缺少资源的问题）以供进一步处理。查询结果根本没有返回到 api 中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T21:11:03.193

根据建议，您通常应该为 cassandra 使用 8G RAM 甚至 16G ram。

你在运行什么查询？我知道 PlayOrm 使用游标，因此它可以为您提供碎片，因此它不会耗尽内存。我们已经使用 PlayOrm 和 cassandra 轻松地将 100Gigs 的东西检索到我们的客户端，尽管我们在它流回时将其丢弃并且我们没有遇到任何问题。

后来，迪恩

# html - 如何将 .css 添加到 .cshtml

> ID：13144234
> 
> 赞同：12
> 
> 时间：2012-10-30T17:10:44.653
> 
> 标签：html, css, razor

我是一个完整的 html/css 新手，我正在尝试获取一个 .cshtml 文件以使用我编写的一些基本 CSS。我需要在 .cshtml 中添加什么代码才能使用 CSS 文件？

编辑：这是我的 .css 文件中的代码。它旨在`div`使用“comment_box1”的 id 设置我的样式，但即使在遵循答案之后，它也无法正常工作。知道有什么问题吗？

```
.comment_box1 {
    background-color: #C8E0E8; 
    width: 830px; 
    height: 180px; 
} 
```

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-10-30T17:12:26.657

这是基本选项-您将样式标签添加到`<head>`文档的...

```
<link rel="stylesheet" href="app.css" type="text/css" /> 
```

如果您使用的是捆绑包，则将捆绑包放在那里：

```
@Styles.Render("~/Content/css") 
```

最后，如果您使用主布局，这是放置它的最佳位置，因为它将应用于您的所有页面。

**更新**

如果您以 id 为目标，则使用`#`，而不是用于类的点。

```
#comment_box1
{
background-color: #C8E0E8; 
width: 830px; 
height: 180px; 
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2019-02-02T09:18:23.260

您还可以在 .cshtml 文件中使用 CSS 时使用。在这种情况下，请将以下代码直接粘贴到您的 .cshtml 文件中：

```
<style>
#comment_box1
{
background-color: #C8E0E8; 
width: 830px; 
height: 180px; 
}
</style> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-08-13T11:47:14.993

**点网核心**

首先，确保您有`wwwroot`文件夹并将`css`文件放入其中。

其次，检查你是否有`app.UseStaticFiles();`你的`startup.cs` `Configure`方法

第三，使用`~/style.css`基于以下路径的路径链接到您的文件`wwwroot`

[参考](https://docs.microsoft.com/en-us/aspnet/core/fundamentals/static-files?view=aspnetcore-5.0)

# json - Groovy 2 JsonBuilder 嵌套的可迭代关联

> ID：13144245
> 
> 赞同：0
> 
> 时间：2012-10-30T17:11:20.060
> 
> 标签：json, groovy

JsonBuilder 有 2 个问题。我已经通过研究尝试了一切。这是我最接近解决这个问题的方法，但这是不对的。

1.  几天的数组和议程没有特色 - 它们以非数组的形式出现。
2.  出于某种原因，第 2 天的议程数据会出现在第 1 天的议程结构中。基础数据是正确的。

这里是建筑

```
def root = builder.output {
    days {
        for (Day day : model.days) {
            "$day.name" { 
                agendas {
                    for (Agenda agenda : day.agendas) {
                        "$agenda.name" {
                            name agenda.name
                        }
                    }
                }
            }
        }
    }
} 
```

JSON

```
{ "output": {
    "days": {
        "Day 1": {
            "agendas": {
                "Day 2 Agenda B": {
                    "name": "Day 2 Agenda A"
                },
                "Day 2 Agenda A": {
                    "name": "Day 2 Agenda A"
                }
            }
        },
        "Day 2": {
            "agendas": {
                "Day 2 Agenda B": {
                    "name": "Day 2 Agenda A"
                },
                "Day 2 Agenda A": {
                    "name": "Day 2 Agenda A"
                }
            }
        }
    }
}} 
```

我追求的是：

```
{ "output": {
    "days": [
        {
            "name": "Day 1",
            "agendas": [
                {
                    "name": "Day 1 Agenda A"
                },
                {
                    "name": "Day 1 Agenda B"
                }
            ]
        },
        {
            "name": "Day 2",
            "agendas": [
                {
                    "name": "Day 2 Agenda A"
                },
                {
                    "name": "Day 2 Agenda B"
                }
            ]
        }
    ]
}} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T18:49:33.057

我终于明白了：）

```
 def builder = new JsonBuilder()

    builder {
        days(days.collect { day ->
            [
                name: day.name,
                agendas: day.agendas.collect { agenda ->
                    name: agenda.name   
                }
            ]
        })
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-03T17:48:09.230

可以不`collect()`这样做：

```
builder.days(DAYS) { day->
    name day.name
    agendas(day.agendas){ agenda ->
        name agenda.name
    }
} 
```

这是输出：

```
{
    "days": [
        {
            "name": "Day 1",
            "agendas": [
                {
                    "name": "Day 1 Agenda A"
                },
                {
                    "name": "Day 1 Agenda B"
                }
            ]
        },
        {
            "name": "Day 2",
            "agendas": [
                {
                    "name": "Day 2 Agenda A"
                },
                {
                    "name": "Day 2 Agenda B"
                }
            ]
        }
    ]
} 
```

# java - 确定字符串中的字符是否都是特定字符集

> ID：13144250
> 
> 赞同：20
> 
> 时间：2012-10-30T17:11:39.677
> 
> 标签：java, character-encoding

我需要能够在Java 中获取一个字符串，并确定其中包含的所有字符是否都在一个指定的字符集中（例如ISO-8859-1）。我已经环顾四周寻找一种简单的方法来做到这一点（包括玩弄 a `CharsetDecoder`），但还没有找到一些东西。

获取字符串并确定所有字符是否都在给定字符集中的最佳方法是什么？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-10-30T17:18:11.733

java.nio.charset包中的[CharsetEncoder](http://docs.oracle.com/javase/7/docs/api/java/nio/charset/CharsetEncoder.html)[类](http://docs.oracle.com/javase/7/docs/api/java/nio/charset/package-summary.html)提供了一个方法[canEncode](http://docs.oracle.com/javase/7/docs/api/java/nio/charset/CharsetEncoder.html#canEncode%28char%29)来测试是否支持特定字符。

[迈克尔](https://stackoverflow.com/users/614418/michael)基本上做了这样的事情：

[`Charset`](http://docs.oracle.com/javase/7/docs/api/java/nio/charset/Charset.html). [`forName`](http://docs.oracle.com/javase/7/docs/api/java/nio/charset/Charset.html#forName%28java.lang.String%29)( [`CharEncoding.ISO_8859_1`](http://commons.apache.org/proper/commons-lang/javadocs/api-2.6/org/apache/commons/lang/CharEncoding.html#ISO_8859_1))。[`newEncoder`](http://docs.oracle.com/javase/7/docs/api/java/nio/charset/Charset.html#newEncoder%28%29)()。[`canEncode`](http://docs.oracle.com/javase/7/docs/api/java/nio/charset/CharsetEncoder.html#canEncode%28java.lang.CharSequence%29)（“细绳”）

请注意，`CharEncoding.ISO_8859_1`依赖于[Apache commons](http://commons.apache.org/)，可能会被“ISO_8859_1”替换。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T17:18:50.607

我认为最简单的方法是创建一个表，其中可以用目标字符集编码表示哪些 Unicode 字符，然后测试字符串中的每个字符。对于 ISO-8859 系列，表格通常可以用一个或几个范围的 Unicode 字符表示，使测试相对容易。这是很多手工工作，但只需要完成一次。

**编辑：**如果您的 Java 实现支持字符集，则使用[Aubin 的答案。](https://stackoverflow.com/a/13144332/535871):)

# ios - 子类化 UITableViewCell 会导致文本和图像在加载时发生偏移

> ID：13144255
> 
> 赞同：0
> 
> 时间：2012-10-30T17:11:50.363
> 
> 标签：ios, cocoa-touch, uitableview

我创建了一个子类，`UITableViewCell`因为我想明确设置`imageView`帧大小，而不管我实际给它的图像大小。

话虽如此，当我`tableView`加载时，一切似乎在一瞬间发生了变化。图像稍微变大，`titleLabel`和`detailLabel`都移到更靠近图像的位置。我在我的子类中做错了什么吗？

```
- (id)initWithStyle:(UITableViewCellStyle)style reuseIdentifier:(NSString *)reuseIdentifier
{
    self = [super initWithStyle:style reuseIdentifier:reuseIdentifier];
    if (self) {
        // Selected View
        self.selectedBackgroundView = [[UIView alloc] initWithFrame:self.frame];
        self.selectedBackgroundView.backgroundColor = RGB(233, 233, 233);

        // Text Label
        self.textLabel.textColor = [UIColor darkGrayColor];
        self.textLabel.opaque = YES;
        self.textLabel.highlightedTextColor = self.textLabel.textColor;

        // Detail
        self.detailTextLabel.font = [UIFont systemFontOfSize:12.0];
        self.detailTextLabel.numberOfLines = 3;
        self.detailTextLabel.opaque = YES;
        self.detailTextLabel.highlightedTextColor = self.detailTextLabel.textColor;

        // Cell
        self.opaque = YES;
    }
    return self;
}

- (void)setSelected:(BOOL)selected animated:(BOOL)animated
{
    [super setSelected:selected animated:animated];

    // Configure the view for the selected state
}

- (void)layoutSubviews {
    [super layoutSubviews];

    float desiredWidth = 70;
    float desiredHeight = 70;
    float leftMargin = 5;
    float topMargin = 5;

    float w=self.imageView.frame.size.width;
    self.imageView.contentMode = UIViewContentModeScaleAspectFill;
    self.imageView.clipsToBounds = YES;
    if (w>desiredWidth) {
        float widthSub = w - desiredWidth;
        self.imageView.frame = CGRectMake(leftMargin,topMargin,desiredWidth,desiredHeight);
        self.textLabel.frame = CGRectMake(self.textLabel.frame.origin.x-widthSub,self.textLabel.frame.origin.y,self.textLabel.frame.size.width+widthSub,self.textLabel.frame.size.height);
        self.detailTextLabel.frame = CGRectMake(self.detailTextLabel.frame.origin.x-widthSub,self.detailTextLabel.frame.origin.y,self.detailTextLabel.frame.size.width+widthSub,self.detailTextLabel.frame.size.height);

    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T22:13:04.693

我看到你在做

```
self.selectedBackgroundView = [[UIView alloc] initWithFrame:self.frame]; 
```

我真的觉得应该

```
self.selectedBackgroundView = [[UIView alloc] initWithFrame:self.bounds]; 
```

因为 self.selectedBackgroundView 是基于父视图坐标系定位的

# php - 如何在最后一个数组项后去掉逗号？

> ID：13144256
> 
> 赞同：1
> 
> 时间：2012-10-30T17:12:05.503
> 
> 标签：php, loops

我有这个数组循环：

```
 foreach ( $event_entrance as $event_entrance_s ) {
    _e($event_entrance_s,'holidayge');
    echo ', ';
 } 
```

我想`comma`在最后一个循环结束时摆脱掉。
有任何想法吗？看起来很简单，但它不适合我:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-30T17:39:17.807

```
$fn = function($v) { return _e($v,'holidayge'); };
$arr = array_map($fn, $event_entrance );
echo implode(',', $arr); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T17:14:37.467

两种选择：

*   用于`implode`将东西放在一起，它可以轻松为您处理这种边缘情况。说真的，内爆很棒
*   确定您是否在最后一个元素上（可能有一个计数，并通过访问元素键），如果它是最后一个元素，则省略逗号。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T17:16:59.400

尝试这样的事情：

```
$event_entrance_count = count($event_entrance);

$loop_number = 1;

foreach ( $event_entrance as $event_entrance_s ) {
     _e($event_entrance_s,'holidayge');
     if(!$loop_number == $event_entrance_count) {
         echo ', ';
     }
     $loop_number++;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-30T17:17:15.750

关于什么...

```
$limit = count($event_entrance);

foreach ($event_entrance as $key => $event_entrance_s) {
    _e($event_entrance_s,'holidayge');
    if ($key < ($limit-1)) {
        echo ', ';
    }
} 
```

只要您的键是整数和顺序的，这应该完全按照您的意图工作。如果您使用的是整数，但它们没有任何特定的顺序，则将其放在`foreach()`循环之前将解决该问题：

```
$event_entrance = array_values($event_entrance); 
```

如果您使用字符串作为键而不是整数，请尝试以下操作：

```
$limit = count($event_entrance);
$i = 1;
foreach ($event_entrance as $event_entrance_s) {
    _e($event_entrance_s,'holidayge');
    if ($i < $limit) {
        echo ', ';
    }
    ++$i;
} 
```

# java - 在哪里可以找到包含在 jogl 2.0 中的罐子？

> ID：13144259
> 
> 赞同：0
> 
> 时间：2012-10-30T17:12:24.037
> 
> 标签：java, jogl, configuration-management

我试图让这个例子工作，只是为了确保我设置了我的环境： [Using_JOGL_in_a_Java_applet](http://jogamp.org/wiki/index.php/Using_JOGL_in_a_Java_applet)

然后我下载了jogl或jogamp，名称似乎可以互换 [使用下载jogl的说明](http://jogamp.org/wiki/index.php/Downloading_and_installing_JOGL)

我下载了所有平台版本，因为我正在多个平台上开发 [jogamp-all-platforms.7z](http://jogamp.org/deployment/jogamp-current/archive/)

然后我尝试使用 -classpath jogamp-all-platforms/jar/* 编译示例代码，但它没有找到任何 jogl 包。

有很多版本的 jogl，还有很多 jar，但是没有全面的逐步教程来设置这个东西。为什么找不到包，jar 文件都在 jogamp-all-platforms/jar/ 文件夹中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-03T14:28:25.707

您只需要在编译和运行 JogAmp jogl 应用程序时添加gluegen-rt.jar 和jogl-all.jar。所有原生 jar 只需要位于这两个 jar 旁边。

不可能使用通配符 * 因为在命令行上将 jar 添加到类路径时，jar 需要用 : 分隔。

Linux/Unix 用户使用

```
-classpath jogamp-all-platforms/jar/jogl-all.jar:jogamp-all-platforms/jar/gluegen-rt.jar 
```

Windows 用户使用

```
-classpath jogamp-all-platforms\jar\jogl-all.jar;jogamp-all-platforms\jar\gluegen-rt.jar 
```

有关更多详细信息，请参阅 JogAmp 常见问题解答，其中还介绍了如何在命令行上编译：http: [//jogamp.org/wiki/index.php/Setting_up_a_JogAmp_project_in_your_favorite_IDE](http://jogamp.org/wiki/index.php/Setting_up_a_JogAmp_project_in_your_favorite_IDE)

# ios - iOS 让视图智能地跟随另一个视图

> ID：13144276
> 
> 赞同：0
> 
> 时间：2012-10-30T17:13:51.687
> 
> 标签：ios, uiimageview

我有以下问题：
我有一个 UIImageView，我可以通过触摸和一个工具栏拖动它，我想靠近那个 Image View。这就是我目前正在做的事情：

```
- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event
{
  //motion here;self.tool is toolbar View

  CGFloat a=self.tool.frame.size.width;
  CGFloat b=self.tool.frame.size.height;
  self.tool.frame=CGRectMake(self.frame.origin.x+self.frame.size.width/2+50, self.frame.origin.y+self.frame.size.height/2+50, a, b);
} 
```

它工作正常，但有时工具栏会移出屏幕。也许有简单的方法来跟踪我是否在外面并将工具栏移动到另一个点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T17:26:28.003

您可以像这样检查它：

```
- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event
{
  //motion here;self.tool is toolbar View

  CGFloat a = self.tool.frame.size.width;
  CGFloat b = self.tool.frame.size.height;
  CGRect newFrame = CGRectMake(self.frame.origin.x+self.frame.size.width/2+50, 
                               self.frame.origin.y+self.frame.size.height/2+50,
                               a, b);

  // only set frame, if it is still in the bounds of self.superview
  if(CGRectContainsRect(self.superview.frame, newFrame)) {
    self.tool.frame = newFrame;
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T17:27:37.653

您应该使用 UIGestureRecognizer，而不是 touchesMoved:。当你这样做时，图像视图上的手势识别器可以随意移动工具栏视图。

# c++ - C ++中的延迟变换

> ID：13144280
> 
> 赞同：11
> 
> 时间：2012-10-30T17:14:18.207
> 
> 标签：c++, python, functional-programming, lazy-evaluation

我有以下 Python 片段，我想使用 C++ 重现：

```
from itertools import count, imap

source = count(1)
pipe1 = imap(lambda x: 2 * x, source)
pipe2 = imap(lambda x: x + 1, pipe1)
sink = imap(lambda x: 3 * x, pipe2)
for i in sink:
    print i 
```

我听说过[Boost Phoenix](http://www.boost.org/doc/libs/1_51_0/libs/phoenix/doc/html/index.html)，但我找不到`transform`与 Python 的`imap`.

编辑：为了澄清我的问题，这个想法不仅是使用 a 按顺序应用函数`for`，而是能够使用`std::transform`无限生成器之类的算法。组合函数的方式（使用更实用的语言，如方言）也很重要，因为下一步是函数组合。

更新：感谢 bradgonesurfing、David Brown 和 Xeo 提供的惊人答案！我选择 Xeo's 是因为它最简洁，而且它可以让我到达我想去的地方，但 David's 对于理解这些概念非常重要。此外，bradgonesurfing 的提示 Boost::Range :)。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-30T18:00:47.303

[使用](http://www.boost.org/libs/range/)Boost.Range ：

```
int main(){
  auto map = boost::adaptors::transformed; // shorten the name
  auto sink = generate(1) | map([](int x){ return 2*x; })
                          | map([](int x){ return x+1; })
                          | map([](int x){ return 3*x; });
  for(auto i : sink)
    std::cout << i << "\n";
} 
```

[`generate`包括该功能的实时示例。](http://liveworkspace.org/code/841508d3b54bed4181d4e9fb6058200f)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-30T17:54:44.430

我认为在 C++ 中最惯用的方法是使用迭代器。这是一个基本的迭代器类，它接受一个迭代器并将一个函数应用于其结果：

```
template<class Iterator, class Function>
class LazyIterMap
{
private:
    Iterator i;
    Function f;
public:
    LazyIterMap(Iterator i, Function f) : i(i), f(f) {}
    decltype(f(*i)) operator* () { return f(*i); }
    void operator++ () { ++i; }
};

template<class Iterator, class Function>
LazyIterMap<Iterator, Function> makeLazyIterMap(Iterator i, Function f)
{
    return LazyIterMap<Iterator, Function>(i, f);
} 
```

这只是一个基本示例，仍然不完整，因为它无法检查您是否已到达可迭代序列的末尾。

这是您的示例 python 代码的重新创建（也定义了一个简单的无限计数器类）。

```
#include <iostream>

class Counter
{
public:
    Counter (int start) : value(start) {}
    int operator* () { return value; }
    void operator++ () { ++value; }
private:
    int value;
};

int main(int argc, char const *argv[])
{
    Counter source(0);
    auto pipe1 = makeLazyIterMap(source, [](int n) { return 2 * n; });
    auto pipe2 = makeLazyIterMap(pipe1, [](int n) { return n + 1; });
    auto sink = makeLazyIterMap(pipe2, [](int n) { return 3 * n; });
    for (int i = 0; i < 10; ++i, ++sink)
    {
        std::cout << *sink << std::endl;
    }
} 
```

除了类定义（只是复制 python 库函数所做的）之外，代码大约与 python 版本一样长。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-30T17:28:58.083

我认为 boost::rangex 库是您正在寻找的。它应该与新的 c++lambda 语法很好地配合使用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-30T17:19:07.467

```
int pipe1(int val) {
    return 2*val;
}

int pipe2(int val) {
    return val+1;
}

int sink(int val) {
    return val*3;
}

for(int i=0; i < SOME_MAX; ++i)
{
    cout << sink(pipe2(pipe1(i))) << endl;
} 
```

我知道，这不是您所期望的，但它肯定会在您想要的时候进行评估，尽管不是使用迭代器 iterface。一篇非常相关的文章是这样的：

[D 中的组件编程](http://www.drdobbs.com/architecture-and-design/component-programming-in-d/240008321)

12 年 11 月 6 日编辑：

仍然坚持裸 C++ 的另一种方法是使用函数指针并为上述函数构造自己的管道（来自 SO q 的函数指针向量：[如何将函数指针存储在向量中？](https://stackoverflow.com/questions/3758121/how-can-i-store-function-pointer-in-vector)）：

```
typedef std::vector<int (*)(int)> funcVec;
int runPipe(funcVec funcs, int sinkVal) {
    int running = sinkVal;
    for(funcVec::iterator it = funcs.begin(); it != funcs.end(); ++it) {
        running = (*(*it))(running); // not sure of the braces and asterisks here
    }
    return running;
} 
```

这旨在遍历此类向量中的所有函数并返回结果值。那么你也能：

```
funcVec funcs;
funcs.pushback(&pipe1);
funcs.pushback(&pipe2);
funcs.pushback(&sink);

for(int i=0; i < SOME_MAX; ++i)
{
    cout << runPipe(funcs, i) << endl;
} 
```

当然，您也可以通过结构为此构造一个包装器（如果 C++ 这样做，我会使用闭包......）：

```
struct pipeWork {
     funcVec funcs;
     int run(int i);
};

int pipeWork::run(int i) {
    //... guts as runPipe, or keep it separate and call:
    return runPipe(funcs, i);
}

// later...
pipeWork kitchen;
kitchen.funcs = someFuncs;
int (*foo) = &kitchen.run();

cout << foo(5) << endl; 
```

或类似的东西。警告：不知道如果指针在线程之间传递会发生什么。

额外警告：如果你想用不同的函数接口来做到这一点，你最终将不得不加载大量`void *(void *)(void *)`函数，以便它们可以接受任何内容并发出任何内容，或者大量模板来修复你拥有的管道类型。我想理想情况下，你会为​​函数之间的不同接口构造不同类型的管道，这样`a | b | c`即使它们在它们之间传递不同类型也可以工作。但我猜这很大程度上就是 Boost 正在做的事情。

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2012-10-30T17:29:36.257

根据功能的简单性：

```
#define pipe1(x) 2*x
#define pipe2(x) pipe1(x)+1

#define sink(x) pipe2(x)*3

int j = 1
while( ++j > 0 )
{
    std::cout << sink(j) << std::endl;
} 
```

# facebook - 在没有用户交互的情况下更新长寿令牌？

> ID：13144290
> 
> 赞同：2
> 
> 时间：2012-10-30T17:15:09.183
> 
> 标签：facebook, facebook-graph-api, authorization

首先让我说授权、令牌和整个过程让我很困惑，所以我希望我能传达我想要理解的内容！

我有一个 WordPress 博客，我正在使用我编写的一个非常基本的插件来授权 Facebook 访问我的个人帐户。我正在授予 user_photos 和 manage_pages 权限，以允许我从我自己的帐户和与博客相关的页面在博客上显示照片画廊。我只关心将 Facebook 授权给我自己的帐户。

我正在使用 API 生成身份验证令牌，并将该令牌存储在 WP 数据库中以重复使用它。我已经确认我有一个长期存在的令牌。这一切现在都完美无缺。我的画廊完全按照我想要的方式显示给访问该站点的任何人。

我不明白，也不知道如何测试的是，当这个令牌过期时会发生什么。我的假设是，如果用户在发生这种情况后访问我的网站，他们会在画廊应该在的地方看到一些乱码/错误。我在这里通读了“[场景 4](https://developers.facebook.com/roadmap/offline-access-removal/) ”，它看起来有点像我正在处理的内容，但我不知道新的短期令牌来自哪里，然后可以交换长期令牌。

我是否可以自动生成新的短期令牌以重新授权应用程序而无需我进行任何交互，或者我是否必须每月给自己做个记录以确保它不会过期？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T17:21:48.207

不，如果没有特定用户本身，就无法更新用户访问令牌。无论如何都会使整个系统无效。但是，长寿命令牌的有效期为 60 天，因此您必须不时登录您的应用程序。

更好：Afaik 您可以通过`/me/accounts`使用长寿命（60 天）用户访问令牌调用来获得永久页面的页面令牌。所以这至少适用于页面。无论如何，来自用户帐户的数据并不意味着要在某个地方发布。但话又说回来，如果您只想从 facebook 页面读取内容，则可以使用应用访问令牌：

```
$app_access_token = APPID . '|' . APPSECRET; 
```

# javascript - Phantomjs 可以工作，但速度很慢

> ID：13144292
> 
> 赞同：16
> 
> 时间：2012-10-30T17:15:23.143
> 
> 标签：javascript, phantomjs, webpage-screenshot

我正在尝试使用 PhantomJS 截取网页的屏幕截图。具体来说，我使用的是`espn.com`从[这个](http://skookum.com/blog/dynamic-screenshots-on-the-server-with-phantomjs/)例子中捕获的例子。我的代码如下所示：

```
var page = new WebPage(); 
    page.open('http://www.espn.com', function (status) {
    page.render('fb.png');
    phantom.exit();
}); 
```

然后我使用终端或命令提示符转到我的 PhantomJS 目录并运行：

```
phantomjs shotty.js 
```

一切运行良好，但完成输出图像需要 6-8 秒。这正常吗？有没有更快的方法来完成这项工作，以便在一秒钟或更短的时间内完成？

我使用的是 CentOS 和 Windows 7。两个机器都有 8GB 的​​ RAM，3.2 GHz CPU，我在 speedtest.net 上的速度下降了 22Mbp/s，上升了 1Mbp/s

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-11-13T06:28:08.520

好吧，在我的例子中，页面正在等待一些 GET 请求并且无法到达请求的服务器并且它一直等待很长时间。我只有在使用远程调试器选项时才能弄清楚。

```
phantomjs --remote-debugger-port=9000 loadspeed.js <some_url> 
```

并在`loadspeed.js`文件中添加以下代码：

```
page.onResourceRequested = function (req) {
    console.log('requested: ' + JSON.stringify(req, undefined, 4));
};

page.onResourceReceived = function (res) {
    console.log('received: ' + JSON.stringify(res, undefined, 4));
}; 
```

然后在任何 webkit 浏览器（safari/chrome）中加载 localhost:9000 并查看控制台日志，我可以在其中发现它正在等待一些无法访问的请求很长时间。

绕过这个 - 通过在同一个`loadspeed.js`文件中添加以下内容来减少超时：

```
page.settings.resourceTimeout = 3000; //in milliseconds 
```

在那之后事情进展得很快。希望这可以帮助

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-10-30T17:22:08.020

是的，这很正常。当您尝试渲染时，PhantonJS 仍将等待`page.open`事件触发`load`事件以表示整个 DOM 已加载。

看看当我`espn.com`在系统上本地加载时会发生什么。DOMContentLoaded 完成大约需要 2 秒，然后`ready`事件触发需要大约 7 秒。

![在此处输入图像描述](../Images/d620d24c0eba85ee82865722e11e0586.png)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-08-05T22:09:51.747

我不认为以下会起作用，但对我来说它确实（在 Windows 上）：

打开 Internet Explorer > Internet 选项 > 连接 > LAN 设置并禁用“自动检测设置”

原帖： https: [//plus.google.com/+MatthiasG%C3%B6tzke/posts/9v9BMCJj2k6](https://plus.google.com/+MatthiasG%C3%B6tzke/posts/9v9BMCJj2k6)

# linux - 文件不存在

> ID：13144293
> 
> 赞同：0
> 
> 时间：2012-10-30T17:15:22.663
> 
> 标签：linux, cmake, root

我是 Linux 的新手。我正在做一个需要我切换到 Linux 的项目。我正在尝试构建一个用 C++ 编码的库。当我传入“cmake”时。命令，我收到以下错误。

```
CMake 错误：文件 /home/robotEr/Desktop/projects/Robotics/Krang/Path Planning/dart/thirdparty/fcl/include/fcl/config.h.in 不存在。

```

但是该文件确实存在于上述指定位置。尽管文件在那里，但我不明白为什么会遇到此错误。这是我“ls”时该文件夹中的文件和子文件夹的列表。

```
$ ls
CMakeCache.txt
profile.h
octree.h
distance_func_matrix.h
intersect.h
data_types.h
distance.h
collision_node.h
collision_object.h
config.h.in --------> HERE IT IS!
collision_func_matrix.h
collision_data.h
collision.h
CMakeFiles/
CMakeLists.txt
articulated_model/
broadphase/
BV/
BVH/
ccd/
math/
narrowphase/
shape/
simd/
traversal/ 
```

# sql - 如何获取新插入或已经存在的记录的标识值？

> ID：13144295
> 
> 赞同：2
> 
> 时间：2012-10-30T17:15:29.667
> 
> 标签：sql, sql-server, insert, sql-server-2012, identity

到目前为止，我有以下 SQL...

```
-- SETUP MY SQL
DECLARE @NewUsers    TABLE (Username VARCHAR(32), Name VARCHAR(32))
DECLARE @UserResults TABLE (UserName VARCHAR(32), UserId INT)

INSERT INTO @NewUsers (Username, Name)
VALUES ('johndoe', 'John Doe'),
       ('janedoe', 'Jane Doe'),
       ('mrsmith', 'Mr Smith') -- This guy already exists in the DB though...

-- INSERT STATEMENT

INSERT INTO User (Username, Name)
    SELECT new.Username, new.Name
    FROM @NewUsers new
    WHERE NOT EXISTS (SELECT 1 FROM dbo.User WHERE User.Username = new.Username) 
```

* * *

我想要做的是获取结果`@@IDENTITY`值，以便稍后在我的 SQL 中的另一个插入语句中使用，但我想获取**所有**身份，包括已经存在但未插入的用户。我知道之后我总是可以做另一个选择语句，但我不确定这是最好的方法吗？

```
INSERT INTO @UserResults (UserResults, UserId)
    SELECT Username, UserId
    FROM User
    INNER JOIN @NewUsers new ON new.Username = User.Username 
```

我认为有一种更有效的方法可以使用该`OUTPUT`子句使用所有身份（新插入和/或现有）填充结果表，但我不确定......有没有比我正在做的方式更好的方法?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T17:27:19.500

您想查看所有身份，甚至是已经存在的行。这意味着`output`仅该条款是不够的。无论如何，您之后都需要一个新的查询：

```
select  u.id
from    @NewUsers nu
join    [User] u
on      u.Username = nu.Username 
```

由于较早的“不存在”子查询，具有相关用户的页面将在内存中。所以从效率的角度来看，这没什么好担心的。

# java - 最小化时 JInternalFrame 图标移动到 JPanel 下方

> ID：13144305
> 
> 赞同：2
> 
> 时间：2012-10-30T17:16:13.020
> 
> 标签：java, swing, jpanel, jinternalframe, jdesktoppane

我正在尝试设计一个小游戏，并使用 JInternalFrame 来显示库存。我遇到的问题是，当我最小化 InternalFrame 时，左下角的图标会自动隐藏在 JPanel 后面，该 JPanel 也添加到 JDesktopPane 中。当我向下拖动窗口（使窗口垂直变大）时，白色的 DesktopPane 在默认的灰色 JPanel 下方可见。此外，当我向下拖动时，会显示 InternalFrame 的图标。我试图发布图片，但我是该网站的新手，所以我不能:(。

我尝试使用 moveToFront() 和 toFront() 方法并尝试覆盖 InternalFrameListener 以图标化框架，但没有任何效果。如果您认为我使用了糟糕的设计，请随时告诉我——我只是一名学生，对常用实践没有太多了解。

这是我的代码

```
public class GameTester extends JFrame {

    private JDesktopPane pane;
    private Inventory i; //class that extends JInternalFrame

    public static void main(String[] args) {
        GameTester frame = new GameTester();
        frame.setVisible(true);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setSize(1280, 720);
    }       

    public GameTester() {
        setFocusable(true);
        i = new Inventory("Inventory");

        GamePanel g = new GamePanel();
        g.setBounds(0, 0, 1280, 720);

        pane = new JDesktopPane();
        pane.add(i);
        setContentPane(pane);
        getContentPane().add(g);            
        }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T17:56:43.650

尝试这样的事情怎么样：

```
import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Dimension;
import javax.swing.JDesktopPane;
import javax.swing.JFrame;
import javax.swing.JInternalFrame;
import javax.swing.JPanel;

public class GameStarter extends JFrame {

    private JDesktopPane pane = new JDesktopPane();
    private JInternalFrame i = new JInternalFrame(); 

    private JPanel panel = new JPanel();

    public static void main(String[] args) {
        GameStarter frame = new GameStarter();
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setSize(1024,768);
        frame.setVisible(true);
    }       

    public GameStarter() {
        setLayout(new BorderLayout());
        i.setClosable(true);
        i.setIconifiable(true);
        i.setMaximizable(true);
        i.setDefaultCloseOperation(JInternalFrame.DISPOSE_ON_CLOSE);
        i.setSize(320,240);
        i.setVisible(true);
        pane.setPreferredSize(new Dimension(1024,320));
        pane.setBackground(Color.GRAY);
        pane.add(i);    
        panel.setBackground(Color.YELLOW);

        add(pane,BorderLayout.SOUTH);
        add(panel,BorderLayout.CENTER);
    }
} 
```

![在此处输入图像描述](../Images/0466f45be447b882318885daded0d45b.png)

我个人的看法是，添加的想法`JPanel`很`JDesktopPane`糟糕。

# c++ - 用于 C++ 的良好 IDE，例如用于具有完美自动完成功能的 Windows 的 xcode？

> ID：13144319
> 
> 赞同：2
> 
> 时间：2012-10-30T17:17:15.803
> 
> 标签：c++, xcode, ide

我正在为 Windows 寻找像 xcode 这样的优秀 IDE（xcode 是仅适用于 Mac 的具有最佳自动完成功能的 IDE）。要求：此 IDE 必须具有完美的自动完成功能。对我来说，具有自动完成功能和非常好的格式化风格的编辑器放在首位。你知道吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-30T17:18:20.040

Visual Studio 将是一个很好的起点。

还有一个免费版[Visual Studio Express](http://www.microsoft.com/visualstudio/eng/products/visual-studio-express-products)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T17:28:48.033

以下是一些建议：

*   视觉工作室
*   Geany gtk（*这个！！！*）
*   代码::块 IDE
*   Dev C++（它没有单词完成，但它是一个非常好的编辑器）

链接：

*   [http://en.wikipedia.org/wiki/Geany](http://en.wikipedia.org/wiki/Geany)
*   [http://wiki.codeblocks.org/index.php?title=Main_Page](http://wiki.codeblocks.org/index.php?title=Main_Page)
*   [http://en.wikipedia.org/wiki/Microsoft_Visual_Studio](http://en.wikipedia.org/wiki/Microsoft_Visual_Studio)

PS：我强烈推荐你使用 Geany。它确实可靠且可用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-09T09:24:24.607

Have a look at Netbeans IDE for C/C++. Here is the link to [download](https://netbeans.org/downloads/start.html?platform=windows&lang=en&option=cpp)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-30T17:20:03.347

Microsoft Visual C++ Express 可以免费使用，并带来了很多功能。

# c# - WPF MVVM 可观察集合不更新 GUI

> ID：13144320
> 
> 赞同：5
> 
> 时间：2012-10-30T17:17:17.870
> 
> 标签：c#, wpf, mvvm, observablecollection

我正在设计一个 MVVM WPF 应用程序，并且有一个 ViewModel，它有一个名为 SelectedCustomer 的属性，类型为 Customer。该对象有一个名为 SummaryDetails 的 ObservableCollection 类型的属性，它逐行呈现到 ListView 中。

为此，我在 ViewModel 上创建了一个名为 CustomerSummaryDetails 的单独属性，它只包含一个 get，它返回包含在我上面提到的客户中的集合。

在 XAML 中，我将 ItemsSource 绑定到 CustomerSummaryDetails 属性。

这样我就不必绑定到不太干净的 SelectedCustomer.SummaryDetails 了。

SelectedCustomer 属性具有 get 和 set 方法，并且 set 为 OTHER 属性 CustomerSummaryDetails 调用 OnPropertyChanged，让 XAML 知道基础集合已更改并进行更新。

问题是，当我更新集合中的一个项目时，它并没有反映在 GUI 上，尽管调用了所有正确的事件。我已经介入并调用了 SelectedCustomer 的 set 方法，然后我按照预期进入 CustomerSummaryDetails 属性的“get”方法的 OnPropertyChanged("CustomerSummaryDetails") 调用。此时我已经深入研究了返回集合的值，列表中的值是更新后的值，但是 GUI 上没有任何反映，所以我很困惑，因为 GUI 似乎正在调用 get 方法来更新它在 OnPropertyChanged() 调用中，但它没有在视觉上反映。

更新 - 包含代码

抱歉没有包含代码，我认为描述起来会更容易，但这里是主要的 ViewModel 属性

```
public CustomerSummaryViewModel SelectedCustomer
{
    get { return _selectedCustomer; }
    set
    {
        _selectedCustomer = value;
        OnPropertyChanged("CustomerSummaryDetails");
    }
}

public ObservableCollection<RbcUICustomerSummary> CustomerSummaryDetails
{
    get { return _selectedCustomer.SummaryDetails; }
}

public ItemSummaryViewModel SelectedItem
{
    get { return _selectedItem; }
    set
    {
        _selectedItem = value;
        OnPropertyChanged("SelectedItem");
    }
} 
```

下面的 XAML

```
 <ListView x:Name="lvCustomerSummary" Margin="10,10,10,10" Background="#F4F8FB" ItemsSource="{Binding CustomerSummaryDetails}" MouseDoubleClick="lvCustomerSummary_MouseDoubleClick" ItemContainerStyle="{StaticResource myHeaderStyleColor}" VirtualizingStackPanel.IsVirtualizing="False" VirtualizingStackPanel.VirtualizationMode="Recycling">
            <ListView.View>
            <GridView ColumnHeaderContainerStyle="{StaticResource myHeaderStyle}">
                    <GridView.Columns>
                    <GridViewColumn Header=""  >
                        <GridViewColumn.CellTemplate>
                            <DataTemplate >
                                <Grid>
                                    <Image Source="{z:ImageStaticResource {Binding IconSelect}}" Width="20" Height="20" />
                                </Grid>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <GridViewColumn Width="200" Header="SubCustType" DisplayMemberBinding="{Binding SubCustType}" >
                    </GridViewColumn>
                    <GridViewColumn Width="200" Header="SubCustValue"  DisplayMemberBinding="{Binding SubCustValue}">
                    </GridViewColumn>
                    <GridViewColumn Header=""  >
                        <GridViewColumn.CellTemplate>
                            <DataTemplate >
                                <Grid>
                                    <Image Source="{z:ImageStaticResource {Binding IconFlag}}" Width="20" Height="20" />
                                </Grid>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                </GridView.Columns>
            </GridView>
        </ListView.View>
    </ListView> 
```

最后是进行实际更新的 Updater 方法

```
private void DisplayCustomerComment(string commentEnt)
{            
    if (_queueViewModel.SelectedCustomer == null) return;
        var selCust = _queueViewModel.SelectedCustomer;

    foreach (var t in selCust.SummaryDetails
        .Where(t => t.SubCustType == AppString.CustomerSummary.Comment))
    {
        t.SubCustValue = commentEnt;
        break;
    }

    _queueViewModel.SelectedCustomer = selCust;
} 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-10-31T19:53:05.137

您不是在修改 ObservableCollection 本身（例如添加/删除项目），而是在该集合内的项目。ObservableCollection 负责通知自己的更改，而不是与其项目有关的更改。您应该 NotifyPropertyChange("SubCustValue") 在您的 SubCustValue 的设置器中。

更改未反映在 UI 中，因为当您 NotifyPropertyChange() 整个集合，而不是单个项目的单个属性时，WPF 检测到它实际上是与以前相同的实例（对相同集合的相同对象引用），所以似乎什么都没有改变。

# java - 处理来自 FTP 列表的所有消息后停止 Spring Integration 应用程序

> ID：13144333
> 
> 赞同：0
> 
> 时间：2012-10-30T17:18:16.000
> 
> 标签：java, spring, ftp, spring-integration

在处理了由一系列 FTP 出站网关`ls`命令产生的所有消息后，停止 Spring Integration 应用程序的最佳方法是什么？

作为一项一次性工作，我需要遍历 FTP 目录结构，对找到的每个目录进行递归，并复制每个文件，然后将其作为消息发送以进行处理。一旦 FTP 目录树被完全遍历，*并且*遍历产生的所有消息都已被处理，我想优雅地停止应用程序。

我目前的想法是，我可以尝试跟踪网关和所有队列的活动，当它们的大小都为 0 一段时间后，终止应用程序。这可以通过做*一些事情*来变得更加复杂，比如为每个目录保留所有文件的计数（这需要扩展`AbstractRemoteFileOutboundGateway`），确保目录名称保留在流中的所有消息头上，然后有一个下游组件保持为每个目录处理的消息计数，并在全部计算完后启动关闭。

这听起来像是相当多的工作——有人知道更简单的方法吗？我可以选择在没有 Spring Integration 的情况下编写应用程序和手动执行大量繁琐的工作（迭代 FTP 树、复制文件），或者使用 Spring Integration 但必须扩展它的一部分以匹配我的用例.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T21:23:37.277

有点绕，但这是我能想到的一种方法：

.1。由于您必须放置消息来触发 ftp 出站网关，因此在您触发所有消息后，放置一条带有 STOP 的虚拟消息，例如作为有效负载。就在出站 ftp 网关之前放置一个路由器，该路由器将选择性地将消息发送到 ftp 网关或步骤后 FTP 网关 - 通过一次只接受一条消息的通道发送它，以便对消息进行序列化。

.2\. 当您收到 STOP 消息时，一旦进入文件处理通道，请将此消息发送到特定队列通道，例如停止队列通道。

.3\. 在您的主程序中获取对此停止队列通道的引用，一旦您启动 SI 流程，只需等待消息到达队列通道，一旦 STOP 消息到达此队列通道，您的主方法将继续并且流程应该停止在此刻。

# css - 固定两个流体 DIV 之间的 px 边距

> ID：13144340
> 
> 赞同：1
> 
> 时间：2012-10-30T17:18:42.923
> 
> 标签：css, html, width, margin, fluid

我正在研究一种布局，该布局在一个占主体宽度 80% 的容器内包含两个相邻的流体宽度 div（每个宽度：50%）。

我想在左右 50% div 之间有 10px 的边距，但我需要整个组件适合 80% 的体宽容器。我知道减少左右 DIV 的 % 宽度将为我提供 10px 中心边距的空间，但这也意味着整个左 DIV/右 DIV/10px 边距组合通常不会占身体的 80%宽度。

有没有办法重新计算左右 DIV 的宽度，以便当它们之间有固定的 10px 边距时它们累积占据主体宽度的 80%，无论浏览器窗口调整到什么大小？不确定这是否适用于 CSS。如果 Javascript 是实现它的唯一方法，那很好，但如果我缺少一些隐藏的 CSS 技巧，那就太好了。

这是我的CSS：

```
#logoplace {
width: 200px;
height: 200px;
background-color: red;
margin-left: auto;
margin-right: auto;
}

#navcontainer {
height: 30px;
width: 80%;
background-color: white;
margin: 5px auto;
opacity: 0.7;
}

#navcontainer:hover {
opacity: 1;
}

#rowone {
width: 80%;
height: 120px;
background-color: white;
margin: 5px auto;
}

#rowoneone {
width: 50%;
height: 120px;
background-color: green;
margin-right: 5px;
float: left;
}

#rowonetwo {
width: 50%;
height: 120px;
background-color: blue;
margin-left: 5px;
float: right;
}

html, body
{
height: 100%;
padding-left: 20px;
padding-right: 20px;
padding-top: 20px;
padding-bottom: 20px;
} 
```

还有我的 HTML：

```
<div id="logoplace">
</div>
<div id="navcontainer">
</div>
<div id="rowone">
    <div id="rowoneone">
    </div>
    <div id="rowonetwo">
    </div>
</div> 
```

最后，这是一个[JsFiddle](http://jsfiddle.net/Koubenec/KX6eR/29/)，它显示了我得到的结果。右浮动 DIV 被压低，显然是因为我将两个浮动 DIV 都设置为 50%，然后添加了固定边距。

任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T17:33:18.943

如果您可以向 HTML 添加元素，则可以执行以下操作...

```
<div id="rowone">
  <div id="rowonepad">
    <div id="rowoneone">
    </div>
    <div id="rowonetwo">
    </div>
  </div>
</div> 
```

然后是下面的 CSS

```
#rowone {
  width: 80%;
  overflow: hidden;
}
#rowonepad {
  padding: 0 5px;
}
#rowoneone {
  float: left;
  width: 50%;
  margin-left: -5px;
}
#rowonetwo {
  float: right;
  width: 50%;
  margin-right: -5px;
} 
```

或者您可以使用该`box-sizing: border-box;`属性，无需包装器

```
<div id="rowone">
  <div id="rowoneone">
  </div>
  <div id="rowonetwo">
  </div>
</div> 
```

然后是下面的 CSS

```
#rowone {
  width: 80%;
  overflow: hidden;
}
#rowoneone {
  box-sizing: border-box;
  float: left;
  width: 50%;
  padding-right: 5px;
}
#rowonetwo {
  box-sizing: border-box;
  float: right;
  width: 50%;
  padding-left: 5px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T17:38:30.443

根据浏览器支持，您可以使用新的 box-sizing css 声明。[http://www.w3.org/TR/css3-ui/#box-sizing](http://www.w3.org/TR/css3-ui/#box-sizing)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T10:43:07.670

[http://jsfiddle.net/thirtydot/KX6eR/30/](http://jsfiddle.net/thirtydot/KX6eR/30/)

添加一个额外的包装器：

```
<div id="rowone">
    <div id="rowonewrapper">
        <div id="rowoneone"></div>
        <div id="rowonetwo"></div>
    </div>
</div> 
```

`div`​然后稍微重新定位你的两个内部s：

```
#rowonewrapper {
    margin-right: 10px;
}
#rowoneone {
    width: 50%;
    height: 120px;
    background-color: green;
    float: left;
}

#rowonetwo {
    width: 50%;
    height: 120px;
    background-color: blue;
    float: right;
    position: relative;
    left: 10px;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-17T05:17:22.383

如果您对在项目中使用边框框、第一个类型和第 n 个类型“类型”的东西感到满意 - 当我们真的需要固定的装订线宽度时，这就是我一直在做的事情。边框框是 94% - 但 CSS3 选择器，如 :first of type 是 IE 9 及更高版本。可能有一个polyfill？下面只是关键部分，我不喜欢使用包装器 - 但它有效。请参阅链接以获得更清晰的图片。数学变得非常时髦，但你可以用任意多的列来做。

[http://codepen.io/sheriffderek](http://codepen.io/sheriffderek/pen/tCBHi)

HTML

```
<div class="column-w">
  <div class="column main">

    [column01]

  </div>  
</div>

<div class="column-w">
  <div class="column sub">

    [column02]

  </div>  
</div> 
```

CSS

```
.column-w {
  width: 50%;
  float: left;
}

.column-w:first-of-type {
  padding-right: 10px;
}

.column-w:last-of-type {
  padding-left: 10px;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-06-22T09:56:49.660

好的，这是一个 2 岁的问题，但是是的，我花了很长时间才学会使用

```
calc(X% [math operand] Xpx) 
```

有跨浏览器的变体，例如

```
-webkit-calc(...) 
```

我不知道其他人。

不过，我喜欢带有额外包装器的上述解决方案。这是一个漂亮的黑客！:D

# c# - UI 未从单独 ViewModel 中的命令调用的 ObservableCollection 更新

> ID：13144348
> 
> 赞同：2
> 
> 时间：2012-10-30T17:19:29.417
> 
> 标签：c#, wpf, data-binding, mvvm, prism

```
private ObservableCollection<ProjectItem> _projectItems;

public ObservableCollection<ProjectItem> DataItems
    {
        get { return _projectItems; }
    }

public ProjectsPanelViewViewModel()
    {
        _projectItems = new ObservableCollection<ProjectItem>();
        _createProjectCommand = new DelegateCommand(OnCreateProjectCommand);
        _saveProjectCommand = new DelegateCommand(OnSaveProjectCommand);
    }

private void OnCreateProjectCommand()
    {
        _addProjectViewModel = new AddProjectViewModel();
        AddProjectView view = new AddProjectView();
        view.Show();
    }

    private void OnSaveProjectCommand()
    {
        ProjectItemViewModel _vm = new ProjectItemViewModel();
        _vm.ProjectName = ProjectName;
        _vm.ProjectDescription = ProjectDescription;
        var item = new ProjectItem(_vm);
        _projectItems.Add(item);
    } 
```

XAML

```
<UserControl.DataContext>
    <VM:ProjectsPanelViewViewModel/>
</UserControl.DataContext>
<StackPanel Name="ProjectsPanel" Style="{DynamicResource FullLengthPanelStyle}" >
    <StackPanel Name="ProjectsHeader" Orientation="Horizontal" Margin="0,0,0,5">
        <Label Style="{StaticResource TitleLabelStyleBlue}">projects</Label>
        <Button Name="AddProjects" Margin="10,5,0,0" Style="{StaticResource CircularGreyButtonStyle}" Content="+" ToolTip="Add a new project" Command="{Binding CreateProjectCommand}"/>
        <Button Name="ExpandProjects" Margin="10,5,0,0" Style="{StaticResource CircularGreyButtonStyle}" Content=">" ToolTip="Expand projects"/>
    </StackPanel>

    <ScrollViewer VerticalScrollBarVisibility="Visible">
            <ItemsControl ItemsSource="{Binding DataItems}"/>
    </ScrollViewer>
</StackPanel> 
```

当 OnCreateProjectCommand 打开时，它会创建一个包含 2 个字符串字段的窗口，然后有一个执行 OnSaveProjectCommand 的按钮。命令执行得很好，但是 UI 没有发现新项目已添加到集合中。（调试时它就在那里）。但是，如果您更改 OnSaveProjectCommand 中的代码并将其放入 OnCreateProjectCommand 中，并对简单字符串值进行硬编码，则 UI 会从 observable 集合中正确更新。

谁能给我一些关于为什么这不起作用的指导，以及我应该从这个命令产生一个新窗口的正确方法。这应该通过棱镜的基于状态的视图导航来完成吗？我们已经将其用于模块化和指挥。

感谢您的建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T18:46:51.503

我想你可能在那里有一个参考问题。你如何将这些 ViewModel 相互粘合？我对 Prism 不熟悉，但您在屏幕上查看的虚拟机实例可能与您正在调试的虚拟机实例不同。否则没有意义。Observablecollections 通常工作得很好，除非您从 UI 线程以外的不同线程操作它们。尝试使用[Snoop](http://snoopwpf.codeplex.com/ "窥探")窥探正在运行的应用程序以查看您的 DataContexts 是什么。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T07:29:11.783

除了 HighCores 建议之外，还可以`CollectionChanged`从 ObservableCollection 将事件处理程序附加到事件。如果事件被触发，您至少可以手动提高 ObservableCollection 的 NotifyPropertyChanged。

编辑

例子：

```
using System.Collections.ObjectModel;
using System.Collections.Specialized;
using System.ComponentModel;

namespace CollectionChangedSpike
{
    public class ViewModel : INotifyPropertyChanged
    {
        private ObservableCollection<ProjectItem> _projectItems = new ObservableCollection<ProjectItem>();
        public ObservableCollection<ProjectItem> ProjectItems
        {
            get { return _projectItems; }
            set { _projectItems = value; OnPropertyChanged("ProjectItems");}
        }

        public ViewModel()
        {
            //Just for debugging
            ProjectItems.CollectionChanged += OnProjectItemsChanged;
        }

        private void OnProjectItemsChanged(object sender, NotifyCollectionChangedEventArgs e)
        {
            OnPropertyChanged("ProjectItems");
        }

        public event PropertyChangedEventHandler PropertyChanged;

        protected virtual void OnPropertyChanged(string propertyName)
        {
            PropertyChangedEventHandler handler = PropertyChanged;
            if (handler != null) handler(this, new PropertyChangedEventArgs(propertyName));
        }

    }
} 
```

# php - 搜索多个表？

> ID：13144350
> 
> 赞同：0
> 
> 时间：2012-10-30T17:19:38.857
> 
> 标签：php, search

> **可能重复：**
> [在多个列中搜索多个项目](https://stackoverflow.com/questions/4823068/search-multiple-items-in-multiple-colums)
> [在一个查询中搜索多个表 (MySQL/PHP#)](https://stackoverflow.com/questions/5254165/search-multiple-tables-at-in-one-query-mysql-php)

我已经构建了这个简单的搜索脚本，可以按名称搜索用户。我想稍微扩展一下，以便它可以搜索显示名称和位置？有人可以让我知道这是否可能并引导我朝着正确的方向前进吗？谢谢。

```
 <form method="get" action="">
<label>Search For: </label><input type="text" name="query" />
<input type="submit" name="submit" value="Start Search" />
<input type="reset" value="Reset"
</form>

<?php
//PHP CODE STARTS HERE

if(isset($_GET['submit'])){

// Change the fields below as per the requirements
$db_host="localhost";
$db_username="root";
$db_password="";
$db_name="telecom";
$db_tb_name="ptb_profiles";
$db_tb_atr_name="display_name"; 

//Now we are going to write a script that will do search task
// leave the below fields as it is except while loop, which will display results on screen

mysql_connect("$db_host","$db_username","$db_password");
mysql_select_db("$db_name");

$query=mysql_real_escape_string($_GET['query']);

$query_for_result=mysql_query("SELECT * FROM $db_tb_name WHERE 

$db_tb_atr_name like '%".$query."%'" );
echo "<h2>Search Results</h2><ol>";
while($data_fetch=mysql_fetch_array($query_for_result))
{
    echo "<li>";
    echo substr($data_fetch[$db_tb_atr_name], 0,160);
    echo "</li><hr/>";
}
echo "</ol>";

mysql_close();
}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T17:24:23.043

这个怎么样，你可以添加`OR`和添加另一个条件。`AND`如果这是您想要的，您可以添加：

```
$sql = "SELECT * FROM `$db_tb_name` 
        WHERE display_name like '%".$query."%' 
        OR location LIKE '%".$query."%'" 
```

# vb.net - 麻烦编组 Ui 线程

> ID：13144352
> 
> 赞同：1
> 
> 时间：2012-10-30T17:19:51.727
> 
> 标签：vb.net, multithreading, user-interface

我正在尝试从单独的线程上的单独类更新标签的文本。另一个类引发了一个在此处处理的事件

```
 Private Sub handleChangeUI(ByVal sender As System.Object)
    Dim ytde As Data_Entry_Form.YTD = CType(sender, Data_Entry_Form.YTD)

    UpdateExcelLabel(ytde.LabelMessage)
End Sub 
```

在 updateExcelLabel 方法中，我希望使用以下内容更改标签的文本

```
 Private Delegate Sub updateExcelDelegate(txt As String)
Public Sub UpdateExcelLabel(text As String)
    If Me.lblExcel.InvokeRequired = True Then
        Dim del As New updateExcelDelegate(AddressOf UpdateExcelLabel)
        Me.lblExcel.BeginInvoke(del, text)
    Else
        Me.lblExcel.Visible = True
        Me.lblExcel.Text = text
        Me.lblExcel.Refresh()
    End If
End Sub 
```

出于某种原因，Me.lblExcel.InvokeRequired 总是返回 true。在代表和多线程方面我仍然很新，所以任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-30T17:35:16.403

根据[文档](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.invokerequired%28v=vs.90%29.aspx)，`BeginInvoke`在创建控件的线程上运行委托，但它是异步的，因此不能保证委托在下次`handleChangeUI`调用之前已经开始运行。

我一直`Invoke`在这种情况下使用，而不是`BeginInvoke`.

# php - 复选框问题（使用 post 和 onchange）

> ID：13144355
> 
> 赞同：1
> 
> 时间：2012-10-30T17:19:58.823
> 
> 标签：php, ajax

我有动态生成的复选框，当复选框被选中时，onchange方法工作正常并且我的函数也被调用，当用户取消选中该框时，onchange方法调用我的预期函数问题是当复选框被选中时页面变为活动状态很好，但是当用户取消选中复选框时，页面的该部分再次变为活动状态，并且复选框“已选中”的值在第一次被选中后保持为是。有没有办法检测用户何时选择取消选中以使页面的活动部分变为非活动状态。

我可以在没有提交表单的情况下发送复选框状态吗？是否必须提交才能发布。我必须为此使用 Java 脚本吗？

我试过这个我有问题

```
<script type="text/jscript">
//this funciton will be called when user checks a check box. 
function edit(){

     //get selected category from the form 
    //var formName = 'choose';
    //var Category = document[formName]['choose'].value;

    //check if browser suports ajax
    var xmlhttp = null;      
    if(typeof XMLHttpRequest != 'udefined'){
      xmlhttp = new XMLHttpRequest();
    }

    else if(typeof ActiveXObject != 'undefined'){
        xmlhttp = new ActiveXObject('Microsoft.XMLHTTP');
    }

    else 
        throw new Error('You browser doesn\'t support ajax');

    //open connection with activateImages.php to recieve the active images as an acho
    xmlhttp.open("GET", "activateImages.php",true);         

    //echeck if ready to recieve        
    xmlhttp.onreadystatechange = function (){

    if(xmlhttp.readyState == 4)
      window.activate(xmlhttp);
    };

    xmlhttp.send(null);
    }

    //recieve the active images then insert them in the specified location of the page. 
    function activate(xhr){

        if(xhr.status == 200){
            document.getElementById('images').innerHTML = xhr.responseText;

        }
        else 
            throw new Error('Server has encountered an error\n'+
            'Error code = '+xhr.status);

}

</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T17:30:57.927

在检查状态更新之前不会调用更改事件处理程序：

```
<label><input type='checkbox' onchange='handleChange(this);'>Checkbox</label>

function handleChange(cb) {
  console.log("Changed, new value = " + cb.checked);
} 
```

[例子](http://jsbin.com/unoyab)

handleChange 函数会告诉您复选框的值何时会更改为真或假。用它来隐藏和显示你的 div。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T17:24:44.913

我的建议是，最好使用像**[jQuery](http://jquery.com/)**这样的库来处理这种复杂的请求。主要原因是跨浏览器兼容，更容易实现。对于您的相同逻辑，您可以在 jQuery 中这样做。

首先在标题中包含脚本。

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script> 
```

接下来是 AJAX GET 请求和函数`edit()`。

```
function edit(){
    $.get("activateImages.php", function(data) {
        $("#images").html(data);
    }).error(function(e){
        throw new Error('Server has encountered an error\n' + 'Error code = ' + e);
    });
} 
```

# php - Ajax + JSON 解码 + Slim PHP 问题？

> ID：13144358
> 
> 赞同：3
> 
> 时间：2012-10-30T17:20:17.870
> 
> 标签：php, javascript, ajax, json, zepto

好的，我似乎无法从我的 ajax 调用中解码 JSON，该调用将用户数据发布到我的 api，它内置在 slim php 中。

这是我的ajax..

```
var jsonData;
jsonData = [
      {
        username: "user",
        password: "pass"
      }
    ];

$.ajax({
  type: "POST",
  url: "http://localhost/api/user/auth",
  data: {
    user: JSON.stringify(jsonData)
  },
  contentType: "application/json; charset=utf-8",
  dataType: "json",
  success: function(data) {
    alert("You are good!");
  },
  error: function(xhr, type) {
    alert("Y U NO WORK?");
  }
}); 
```

这是我的 SLIM PHP 代码..

```
$app->post('/user/auth', function () use ($app) {
    try {
         $requestBody = $app->request()->getBody(); //This works

         //RequestBody is: user=%5B%7B%22username%22%3A%22user%22%2C%22password%22%3A%22pass%22%7D%5D         

         $json_a = json_decode($requestBody); //This doesn't work

         print_r($json_a); //Has no output?

         $username = $json_a['user']['username']; //Therefore this doesn't work?

    } catch(Exception $e) {
         echo '{"error":{"text": "'. $e->getMessage() .'"}}';
    }
}); 
```

正如您在注释中看到的，用代码编写的 requestBody 等于：

```
user=%5B%7B%22username%22%3A%22user%22%2C%22password%22%3A%22pass%22%7D%5D 
```

但是，我似乎无法解码它，因为 print_r($json_a) 没有效果。

非常感谢任何帮助，谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T17:23:05.947

尝试

```
$params_str = urldecode($requestBody);
parse_str($params_str, $params_arr);
$user = json_decode($params_arr['user']); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T17:41:13.720

你做错了......你正在通过帖子发送数据，所以你应该从那里获取json字符串，而不是尝试手动读取请求正文......类似

```
$req = $app->request();
$json = json_decode($req->post('user')); 
```

现在，如果你真的想发送一个 json 请求正文，那就完全不同了，但它需要对你的 js 进行更改。您需要设置`processData`为 false 以便它不会尝试在`data`内部对值进行编码。这也意味着您必须对其进行预编码：

```
$.ajax({
  type: "POST",
  url: "http://localhost/api/user/auth",
  data: JSON.stringify({user: jsonData}), // gotta strinigfy the entire hash
  processData: false,
  contentType: "application/json; charset=utf-8",
  dataType: "json",
  success: function(data) {
    alert("You are good!");
  },
  error: function(xhr, type) {
    alert("Y U NO WORK?");
  }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T17:49:51.840

问题是“用户”键。json 解码的格式不正确。我完全删除了它，因为无论如何都没有必要。

所以我改变了：

```
data: {
    user: JSON.stringify(jsonData)
  }, 
```

至

```
 data: JSON.stringify(jsonData) 
```

而且，我还实现了@air4x 行：

```
$json_a = json_decode(urldecode($requestBody)); 
```

# redirect - Nginx 301 在 URL 中使用圆括号重定向

> ID：13144366
> 
> 赞同：2
> 
> 时间：2012-10-30T17:21:06.093
> 
> 标签：redirect, nginx, rewrite

当有问题的 URL 带有圆括号时，我很难让基本的 301 重定向在 nginx 中工作。

通常，我会简单地使用这种类型的基本位置规则（不带括号）：

```
location /abc/def {
rewrite /abc/def http://new.domain.com/abc/def/ permanent;
} 
```

在上面提到的 URL 带有圆括号的情况下：

源网址：domain1.com/abc/def(ghi) 目标网址：domain2.com/abc/defghi

```
location /abc/def(ghi) {
rewrite /abc/def(ghi) http://new.domain2.com/abc/defghi permanent;
} 
```

不幸的是，它不像第一个例子那么简单。从那以后，我已经多次更改规则以包括转义、用于打开和关闭圆括号的 urlencoded、正则表达式以允许在括号中捕获单个字符，但似乎没有任何效果。

通过以下方式逃脱：

```
location /abc/def\(ghi\) 
```

当 URL 有括号时，如何获得 301 重定向以在 nginx 中工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T18:10:29.047

尽管在这种特定情况下，VBart 的答案有效，但它不是一个通用的解决方案。

基本问题是`(`and`)`是正则表达式中的特殊字符，一般的解决方法是转义那些特殊字符 **但**问题是`\`只有当你将正则表达式包含在`"`

像这样：

```
location /abc/def(ghi) {
  rewrite "/abc/def\(ghi\)" http://new.domain2.com/abc/defghi permanent;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T17:27:47.050

```
location /abc/def(ghi) {
    return 301 http://new.domain2.com/abc/defghi;
} 
```

# facebook - 是否可以查找与应用程序关联的 facebook 登录？

> ID：13144368
> 
> 赞同：0
> 
> 时间：2012-10-30T17:21:11.657
> 
> 标签：facebook, facebook-c#-sdk, facebook-apps, app-id

我有一个我们使用的 facebook 应用程序，但是用于编辑应用程序权限和管理员的登录已被忘记。无论如何我可以使用我的应用程序 ID 来查找用于创建此应用程序的登录信息吗？即使是电子邮件地址也会有所帮助。

先感谢您！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T17:53:38.320

应用程序对象应该为您提供可用的内容。

[http://developers.facebook.com/docs/reference/api/application/](http://developers.facebook.com/docs/reference/api/application/)

# windows-8 - Windows 应用商店应用程序：WinJS.Promise.join 和 queueEvent 之间的区别

> ID：13144370
> 
> 赞同：0
> 
> 时间：2012-10-30T17:21:22.237
> 
> 标签：windows-8, microsoft-metro, winjs, windows-store-apps

我的假设是 WinJS.Application.queue 事件适用于在全局上下文中排队应用程序事件（例如检查点、卸载、激活、加载...），但与异步调用无关。WinJS.Promise.join 可以在事件处理程序 setPromise() 中使用，以确保在继续之前完成所有异步调用。任何上下文或澄清表示赞赏。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T23:16:32.107

他们是两个完全不同的东西。

WinJS.Application.queueEvent 用于向使用 WinJS.Application.addEventHandler 函数注册的处理程序引发事件。随着时间的推移，可能会引发多个事件，并且可能会多次调用处理程序。

WinJS.Promise.join 用于创建一个新的 Promise 对象，该对象在您传递给它的所有 Promise 完成时完成。您需要一开始就做出承诺，一旦承诺完成（成功或失败），它就会保持完成。您的处理程序只会运行一次。

它们都用于异步处理，但它们用于不同风格的异步。Promise 用于某些会发生并做某事并在稍后返回的事情，但它们只会运行一次。在您的应用程序的整个生命周期中，事件可能会发生多次。

# vb.net - 使用 BackgroundWorker 并更新 UI

> ID：13144371
> 
> 赞同：0
> 
> 时间：2012-10-30T17:21:26.607
> 
> 标签：vb.net

```
Private _Proxies As New List(Of String)
Private _Array As New List(Of String)

Private Sub btnLeech_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Leech_btn.Click
    Worker.RunWorkerAsync(_Array)
End Sub

'Open a bunch of new threads to download sources of webpages
Private Sub Fetch(ByVal sender As System.Object, _
                                 ByVal e As System.ComponentModel.DoWorkEventArgs) Handles Worker.DoWork
    Dim websiteUri As Uri = Nothing
    Dim Website As String
    For I = 0 To _Array.ToList.Count - 1
        Website = _Array(I)
        Using wc As Net.WebClient = New Net.WebClient
            AddHandler wc.DownloadStringCompleted, AddressOf SourceDownloaded
            If Uri.TryCreate(Website, UriKind.Absolute, websiteUri) Then
                wc.DownloadStringAsync(New Uri(Website))
                Threading.Thread.Sleep(250)
            Else
                If Notify.Checked = True Then
                    TrayIcon.ShowBalloonTip(1, "Invalid website", "There was a invalid site in the list." & Website.ToString, ToolTipIcon.Error)
                    Me.TrashSite_list.Items.Add(Website)
                Else
                    Me.TrashSite_list.Items.Add(Website)
                End If
            End If
        End Using
    Next
End Sub
'Grab the proxies from the webpages
Private Sub SourceDownloaded(ByVal sender As Object, ByVal e As Net.DownloadStringCompletedEventArgs)
    Dim strRegex As String = "\b(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\:[0-9]{1,5}\b"
    Dim myRegexOptions As RegexOptions = RegexOptions.None
    Dim myRegex As New Regex(strRegex, myRegexOptions)
    Dim frm As New Proxies
    Dim i As Integer
    My.Settings.Proxies = New StringCollection
    If e.Error Is Nothing Then
        For Each myMatch As Match In myRegex.Matches(e.Result)
            If myMatch.Success Then
                Try
                    i += i
                    _Proxies.Add(myMatch.ToString)
                    Worker.ReportProgress(i)
                Catch ex As WebException
                    MessageBox.Show(
                        ex.ToString,
                        ErrorToString,
                        Windows.Forms.MessageBoxButtons.OK)
                End Try
            End If
        Next
    End If
End Sub

Private Sub Worker_ProgressChanged(sender As Object, e As System.ComponentModel.ProgressChangedEventArgs) Handles Worker.ProgressChanged
    Proxy_list.Items.AddRange(_Proxies.ToArray)
        Proxy2_lbl.Text = "Proxies: " & Proxy2_list.Items.Count
    Proxy_lbl.Text = "Proxies: " & Proxy2_list.Items.Count
End Sub 
```

这是我的代码，我希望它用它来更新 UI，但我不确定该怎么做。我正在寻找一个带有评论的示例，以便我可以理解它。到目前为止，我已经在几个网站上发布了，每个人都会告诉我该怎么做或给我一个例子，但没有人会告诉我如何处理这个例子！他们希望我知道代码的作用，但如果我知道它的作用，你真的认为我会问问题吗？无论如何，回到主题：

这就是我想要完成的。当我单击 Leech_btn 时，它会将我的所有网站从 Website_list 添加到一个名为“Array”的数组中。然后它以数组作为参数运行后台工作程序。后台工作人员从列表中下载网站的字符串并将其移至 SourceDownloaded 进行过滤。（它会从网站上删除所有代理）然后它应该在 Proxy_list 中显示代理，但这是我遇到问题的地方。我应该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T17:47:02.043

如果我理解正确，问题出在

```
Dim Proxies() As String = My.Resources.SiteList6.Split(vbNewLine)
Proxy_list.Items.AddRange(Proxies) 
```

这是因为 UI 和 worker 在不同的线程中。你可以添加这个：

```
Private Delegate Sub UpdateListDelegate(byval itemName() as string)
Private Sub UpdateList(byval itemName() as string)
    If Me.InvokeRequired Then
        Me.Invoke(New UpdateListDelegate(AddressOf UpdateList), itemName)
    Else
        ' UpdateList
        ' add list add code
        Proxy_list.Items.AddRange(itemName)
    End If
End Sub 
```

在您的代码中，将“Proxy_list.Items.AddRange(Proxies)”替换为

```
 UpdateList(Proxies) 
```

参见[vb.net: listbox.items.add() throws exception in same class](https://stackoverflow.com/questions/13072621/vb-net-listbox-items-add-throws-exception-in-same-class/13074534#13074534)，类似的问题。

# ruby-on-rails - main 的未定义方法“y”：rails 控制台中的对象

> ID：13144372
> 
> 赞同：3
> 
> 时间：2012-10-30T17:21:26.813
> 
> 标签：ruby-on-rails, console, rails-console

我总是使用 'y' 方法在我的 rails 控制台中清理我的结果。但是，它似乎不再起作用了。

我有结果要找到，我可以查看结果，但不是以干净的方式。这是我的 Rails 控制台：

```
Loading development environment (Rails 3.2.6)
1.9.3-p286 :001 > y Trip.all
  Trip Load (0.1ms)  SELECT "trips".* FROM "trips" 
NoMethodError: undefined method `y' for main:Object
    from (irb):1
    from /home/timen/.rvm/gems/ruby-1.9.3-p286/gems/railties-3.2.6/lib/rails/commands/console.rb:47:in `start'
    from /home/timen/.rvm/gems/ruby-1.9.3-p286/gems/railties-3.2.6/lib/rails/commands/console.rb:8:in `start'
    from /home/timen/.rvm/gems/ruby-1.9.3-p286/gems/railties-3.2.6/lib/rails/commands.rb:41:in `<top (required)>'
    from script/rails:6:in `require'
    from script/rails:6:in `<main>'
1.9.3-p286 :002 > 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-30T17:25:30.953

这真的是我有生以来第一次听说一种`y`方法。我一直使用`p`or `pp`（包括后的后者`'pp'`）或`ap`（与`awesome_print`gem 一起使用）。

它不是 IRB 的一部分，也不是 pry 的一部分。

它可能来自您已安装的特定 gem，因此请检查 gemfile 中的最新更改，或者您可能切换到 bundler 或 rvm，丢失了一些全局安装的 gem。

哦，我的天哪，这就是编辑

`y`由 yaml 库提供：

```
require "yaml" 
```

将此添加到一些初始化脚本或您的`.irbrc`文件中。

哦，天哪，它不起作用！

它适用于香草 IRB，但不适用于 Rails 控制台....

这就是为什么

[Rails 控制台 'y' 助手返回 NameError 而不是 yaml-formatting 输出](https://stackoverflow.com/questions/11571801/rails-console-y-helper-returns-nameerror-rather-than-yaml-formatting-output)表示`syck`YAML 库在 ruby​​ 1.9.3 中被淘汰，取而代之的是`psych`，它没有该`y`方法。

所以，使用`awesome_print`或任何它的小兄弟。

# erlang - gen_event handle_info 没有被调用

> ID：13144381
> 
> 赞同：2
> 
> 时间：2012-10-30T17:21:48.487
> 
> 标签：erlang, gen-event

我正在使用 gen_event 行为，除了处理事件之外，我希望能够处理其他通用消息。根据文档，这些消息应该通过 handle_info 接收。但是，这似乎不起作用......除非我遗漏了一些非常明显的东西！

这是我的行为实现：

```
-module(genevent).

-behaviour(gen_event).

-export([init/1, handle_event/2, handle_info/2, handle_call/2, terminate/2, start_link/0]).

init(_Args) -> {ok, []}.

handle_event(Event, State) ->
    io:format("***Event*** ~p~n", [Event]),
    {ok, State}.

handle_call(Call, State) ->
    io:format("***Call*** ~p~n", [Call]),
    {ok, State}.

handle_info(Info, State) ->
    io:format("***Info*** ~p~n", [Info]),
    {ok, State}.

start_link() -> gen_event:start_link({local, genevent}).

terminate(_Args, _State) -> ok. 
```

这是我的用法

```
{ok,PID} = genevent:start_link(),
io:format("***Sending to*** ~p~n", [PID]),
PID ! {hello},
io:format("***Sent hello to*** ~p~n", [PID]). 
```

问题是代码 io:format(" ***Info*** ~p~n", [Info]) 从未达到。

我希望我没有做一些非常愚蠢的事情！谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-30T17:38:38.000

`gen_event:start_link/1`只是启动一个事件管理器；它不会将您的事件处理程序添加到这个新的事件管理器中。你需要自己做`gen_event:add_handler/3`：

```
1> c(genevent).
genevent.erl:3: Warning: undefined callback function code_change/3 (behaviour 'gen_event')
{ok,genevent}
2> {ok,PID} = genevent:start_link().
{ok,<0.38.0>}
3> gen_event:add_handler(PID, genevent, {}).
ok
4> PID ! foo.
***Info*** foo
foo 
```

# android - 在移动设备上以一个大请求或多个小请求下载数据的性能更好吗？

> ID：13144386
> 
> 赞同：1
> 
> 时间：2012-10-30T17:22:01.773
> 
> 标签：android, ios, web-services, mobile, client-server

我有一个为 iOS 和 Android 编写的移动应用程序，它使用一个 Web 服务来返回数据。此服务返回的数据大约每天更改一次或当用户更改位置时。我目前正在下载一条大消息（大约 700kb）并使用用户会话所需的所有数据填充应用程序。

问题是初始消息需要大约 30 秒才能将所有数据处理到本地数据库 (sqlite) 表中。这导致我考虑下载较小的数据块并根据需要处理数据？这可能会导致应用内每次点击的等待时间较短。

基于性能的最佳方法是什么，这反过来又转化为我上面解释的场景类型的最佳用户体验？

我见过其他类似的问题，但他们缺乏明确的答案。 **请提供任何答案/意见，然后请投票，这样我们就可以平息这个论点！**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T19:33:53.390

当然，从响应时间的角度来看，一个连接一个获取请求更好。在移动环境中，几乎没有 DNS 缓存、保持活动检查等（所有这些让我们在 PC 上的生活更轻松的小事情），因此每次连接建立（握手）需要相当长的时间，有时甚至长达一秒钟案例。因此，如果您将提要拆分为不同的连接，则必须汇总所有握手。

在您的情况下，您声明存在处理延迟问题，因此，将此进程放入后台线程并分块填充数据可能是个好主意吗？我的意思是，您以 100 步（例如）下载整个提要并启动处理例程，并获得一些回报。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T19:46:41.550

一般来说，由于 whiteagle 给出的原因，一个 HTTP 请求是最好的。但是如果对于第一个 Activity 只有少量数据有用，你应该考虑拆分下载。仅直接加载最初需要的内容并使用此信息更新（！）第一个屏幕。

请求返回后立即开始在一个后续请求中下载所有其他内容。如果第一个屏幕的信息有用，则用户将至少花一小段时间才能进入下一个视图。

当然，您应该注意通常的最佳实践：

*   在后台进行所有下载。

*   向用户展示一些东西，即使下载尚未完成 - 然后在下载后更新 UI。

*   尽量减少下载，因为只下载真正新的内容。

*   最重要的是：积极缓存。

# sql - 如何在 SQL 中使用条件逻辑来选择要加入的记录？

> ID：13144391
> 
> 赞同：1
> 
> 时间：2012-10-30T17:22:31.553
> 
> 标签：sql, join, if-statement, exists

我正在处理一个查询，除其他事项外，为一个给定 ID 号码的人选择一个电话号码。

这段代码得到了它：

```
LEFT JOIN [thedatabasename].dbo.[thetablename] Phone 
ON p.PersonId = phone.PersonId 
AND (phone.[Description] = 'Home Phone' 
     OR phone.[Description] = 'Cell Phone' 
     OR phone.[Description] is null) 
```

这行得通，但我想要的是它做一些在概念上更像

```
IF EXISTS select [phone number] from <tablename> where description = 'Home phone'
ELSE IF EXISTS select [phone number] from <tablename> where description = 'cell phone'
ELSE IF EXISTS select [phone number] from <tablename> where description is null 
```

因此它更喜欢“家庭电话”而不是“手机”，并且更喜欢“手机”而不是没有描述的手机。我不知道如何在我加入的过程中做到这一点。有没有办法做到这一点而不必编写三个单独的选择？此连接所属的查询丑陋且庞大，并且有一堆连接，因此将其分离出来会很困难。有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T17:45:58.650

因为这三个电话号码位于不同的行中，所以您需要三个联接。使用`case`语句选择第一个不为空的：

```
select
    ...
    case 
        when phone1.[phone number] is not null then phone1.[phone number]
        when phone2.[phone number] is not null then phone2.[phone number]
        else phone3.[phone number] 
    end as [phone number]            
    ...
LEFT JOIN [thedatabasename].dbo.[thetablename] phone1
    ON p.PersonId = phone1.PersonId AND phone1.[Description] = 'Home Phone'
LEFT JOIN [thedatabasename].dbo.[thetablename] phone2
    ON p.PersonId = phone2.PersonId AND phone2.[Description] = 'Cell Phone'
LEFT JOIN [thedatabasename].dbo.[thetablename] phone3
    ON p.PersonId = phone3.PersonId AND phone3.[Description] is null 
```

请注意赋予连接`Phone`行的不同别名以区分它们。

如果您的数据库支持`COALESCE`（或类似），您可以将您的选择简化为：

```
select
    ...
    coalesce (phone1.[phone number], phone2.[phone number], phone3.[phone number]) as [phone number]            
    ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T23:40:39.280

假设您有权创建存储函数，我将用函数调用替换查询的那部分。决定返回哪个电话号码的逻辑可以写在这个函数中。这使主查询保持干净，并且该函数也可以在其他查​​询中重用。

MySQL 函数存根看起来像这样：

```
CREATE FUNCTION `getPhoneNumber`(_PersonId INT) RETURNS TEXT
BEGIN
    // You SQL query here 
END 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T18:09:55.963

另一个想法是为子查询中的每种电话类型分配一个排名，并只选择第一个。这可以通过分析函数或 suquery (select count(*) etc) 来完成，这取决于您的服务器类型。mysql 不支持分析函数，它可能看起来有点奇怪，但应该可以工作:-)。使用 MSSQL，它提供：

```
select * 
from (
    select rank() over ( 
            partition by Person.PersonId
            order by 
                case when Phone.PhoneDescription = 'Home' then 1
                when Phone.PhoneDescription = 'Cell' then 2
                else 3 end  ) as [rank],
        Person.name, Phone.PhoneDescription, Phone.PhoneNumber
    from Person
    left join Phone on Person.PersonId = Phone.PersonId
) PhoneNumbers
where [rank] = 1 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-30T18:14:29.307

补充@Bohemian的建议。如果您在多个查询中经常需要此功能，您可能需要编写一个表值函数（如果您的数据库有这样的东西）或查看来计算要显示的正确电话号码。然后所有对电话号码的引用将始终获得相同的号码。

另一种方法是使用标志字段（称为联系电话）将一个且唯一的电话号码标记为主要电话号码，并通过触发器保持更新。如果要联系的人可以指定他希望通过哪一个联系，这将很有用。

# python - 新的 Canvas 项目不是当前的

> ID：13144392
> 
> 赞同：2
> 
> 时间：2012-10-30T17:22:47.553
> 
> 标签：python, tkinter

我正在开发一个需要重新定位画布项目的应用程序。我开发了以下 GrabbablePoint 类，但新点不是当前的，除非我将鼠标移开然后再移回该点。

```
try:
    import tkinter as tk
except ImportError:
    import Tkinter as tk

class grabbablePoint:

    def __init__(self, canvas, x, y, r):
        if not(canvas.find_withtag(tk.CURRENT)):
            h = canvas.create_oval(x-r, y-r, x+r, y+r)
            canvas.tag_bind(h, '<Enter>', lambda e,hh=h: canvas.itemconfig(hh,fill='#FF0000'))
            canvas.tag_bind(h, '<Leave>', lambda e,hh=h: canvas.itemconfig(hh,fill=''))
            canvas.tag_bind(h, '<B1-Motion>', lambda e,hh=h: canvas.coords(hh,e.x-r,e.y-r,e.x+r,e.y+r))

if __name__ == '__main__':
    canv = tk.Canvas(width=400, height=300, bg='#CCCCFF')
    canv.bind('<Button-1>',lambda e: grabbablePoint(canv,e.x,e.y,3))
    canv.pack()
    tk.mainloop() 
```

结果，如果我在离开和返回之前单击一个点，它会在第一个点的顶部生成另一个点。奇怪的是，我可以通过向 create_oval 添加填充属性来纠正这种不良行为...

```
 h = canvas.create_oval(x-r, y-r, x+r, y+r, fill='#FF0000') 
```

现在它完美地工作了。谁能向我解释这里发生了什么？为什么添加属性会触发 CURRENT 以及为什么不设置其他属性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T18:44:26.480

如果您在没有填充的情况下绘制形状，从 Tkinter 的角度来看，您不是在*悬停*形状，而是在悬停背景。如果没有填充，只有形状的笔划对鼠标事件（进入、离开、当前......）是敏感的。

您可以使用`find_`家庭的另一种方法解决此问题：`find_closest`, `find_overlapping`.

请注意，由于鼠标事件采样，您也可以在不触发回车的情况下进入现有形状（跳过笔划），因此不会显示您的背景，这意味着您的圆圈不会移动，并且您将创建另一个圆圈（但不太可能使用您的半径和鼠标）。

# png - 如何使用gnuplot在标题中显示'@'并且输出格式为png？

> ID：13144394
> 
> 赞同：3
> 
> 时间：2012-10-30T17:22:49.307
> 
> 标签：png, special-characters, gnuplot

你知道在使用 gnuplot 并且输出格式是 PNG 图像时如何在标题中显示字符“@”吗？谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T18:38:31.787

您使用的是哪个版本的 gnuplot？使用带有以下脚本的 gnuplot 4.4.3：

```
#!/usr/bin/gnuplot

set term png 
set output 'plot@.png'

set xlabel 'xlabel is @'
set ylabel 'ylabel is @' 
set title "title is @a\'\@\'a\@"

plot x t 'line title is @' 
```

给了我这张图片： ![在此处输入图像描述](../Images/fbbe327f4b2e76ff0eaebe2bc0a5d976.png)

即使使用转义序列字符似乎也不会造成问题，并且创建的文件的文件名中有一个“@”。

# javascript - 加载选项列表一次并将其呈现到客户端的多个选择框？

> ID：13144396
> 
> 赞同：2
> 
> 时间：2012-10-30T17:22:55.477
> 
> 标签：javascript, jquery, ruby-on-rails

在我的 Rails 3.2 应用程序中，我有一些类似于显示许多照片的相册页面的内容。在每张照片下都有一个选择框，用户可以在其中从多个选项中进行选择，格式如下：

```
<select id="photo_1">
  <option value=value_1>Name of Value 1</option>
  ...
  <option value=value_n>Name of Value N</option>
</select> 
```

问题是，值列表很长（有 100 种可能性），但每张照片都完全相同。由于每个相册可能有数十张照片，因此每次将照片加载到页面时让服务器发送完整列表似乎效率低下。有没有更有效的方法来做到这一点，例如，加载

```
 <option value=value_1>Name of Value 1</option>
  ...
  <option value=value_n>Name of Value N</option> 
```

只在相册页面生成一次（可能作为隐藏字段），然后使用 jQuery/javascript 在客户端将其填充到照片的唯一标签中，当照片加载到页面时？（注意：照片是动态加载的，所以有些照片可能会在相册页面初始加载后加载，因为用户上传它们。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T17:37:26.300

您可以将选项复制到其他元素

**HTML**

```
<select id="photo_1">
  <option value="value_">Pick</option>    
  <option value="value_1">Name of Value 1</option>
  <option value="value_2">Name of Value 2</option>
  <option value="value_3">Name of Value 3</option>
</select>
<select class="copy"></select>
<select class="copy"></select> 
```

**JavaScript**

```
var mainSelectOptions = $("#photo_1 option").clone();
var selects = jQuery(".copy").append(mainSelectOptions); 
```

示例：[JSFiddle](http://jsfiddle.net/TqDHe/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T17:37:42.937

如果需要它的 s 有一个公共类会更好`<select>`，但这适用于`<select>`ID 以开头的任何人`photo`（尽管您可能应该使用`name`而不是`id`）。

```
$(function () {
    $("select[id^=photo]").each(function () {
       $(this).html($("#hidden_select").html());
    });
});​ 
```

[JSFIDDLE](http://jsfiddle.net/barmar/ULpEH/1/)

# hadoop - java.lang.NoSuchMethodError：运行 MRUnit 时的 org.apache.hadoop.mapreduce.TaskAttemptID

> ID：13144397
> 
> 赞同：1
> 
> 时间：2012-10-30T17:22:58.710
> 
> 标签：hadoop, mapreduce, cloudera

我正在尝试使用 Cloudera hadoop distrubution 开发 mr-job。我使用的是 api 版本 2。我确实遇到了 mr-unit 的问题。请指教该怎么做。我使用了标准的 arhetype 并且完全迷失了，我不明白问题的根源在哪里。这是我的依赖项：

```
<dependency>
            <groupId>com.cloudera.hadoop</groupId>
            <artifactId>hadoop-core</artifactId>
            <version>0.20.2-320</version>
            <scope>provided</scope>
        </dependency>

        <dependency>
            <groupId>com.cloudera.hadoop</groupId>
            <artifactId>hadoop-mrunit</artifactId>
            <version>0.20.2-320</version>
            <scope>test</scope>
        </dependency> 
```

这是我的测试代码：

```
@Test
    public void testEmptyOutput() throws Exception{
        for(String line : linesFromFlatFile){
            //List<Pair<GetReq, IntWritable>> output = 
                    driver.withInput(UNUSED_LONG_KEY, new Text(line) )
                 // .withOutput(null, null )
                  .run();
            //assertTrue("", output.isEmpty());
        }
    } 
```

这是一个例外：

```
> Tests run: 1, Failures: 0, Errors: 1, Skipped: 0, Time elapsed: 0.283
> sec <<< FAILURE!
> testEmptyOutput(MapperTest)
> Time elapsed: 0.258 sec  <<< ERROR! java.lang.NoSuchMethodError:
> org.apache.hadoop.mapreduce.TaskAttemptID.<init>(Ljava/lang/String;IZII)V
>   at
> org.apache.hadoop.mrunit.mapreduce.mock.MockMapContextWrapper$MockMapContext.<init>(MockMapContextWrapper.java:71)
>   at
> org.apache.hadoop.mrunit.mapreduce.mock.MockMapContextWrapper.getMockContext(MockMapContextWrapper.java:144)
>   at
> org.apache.hadoop.mrunit.mapreduce.MapDriver.run(MapDriver.java:197)
>   at
MapperTest.testEmptyOutput(ScoringCounterMapperTest.java:42)

package mypackage;

import java.util.Date;
import java.util.List;

import junit.framework.TestCase;

import org.apache.hadoop.io.IntWritable;
import org.apache.hadoop.io.LongWritable;
import org.apache.hadoop.io.Text;
import org.apache.hadoop.mapreduce.Mapper;
import org.apache.hadoop.mrunit.mapreduce.MapDriver;
import org.apache.hadoop.mrunit.types.Pair;
import org.junit.Before;
import org.junit.Test;

import Sample;
import GetReq;

public class MapperTest extends TestCase {
    private static final IntWritable ONE_OCCURANCE = new IntWritable(1);
    private static final LongWritable UNUSED_LONG_KEY = new LongWritable(new Date().getTime());

    private Mapper<LongWritable, Text, GetReq, IntWritable> mapper;
    private MapDriver<LongWritable, Text, GetReq, IntWritable> driver;

    List<String> linesFromFlatFileNoOutput = null;
    List<String> linesFromFlatFileWithOutput = null;
    @Before 
    public void setUp() {
        mapper = newMapper();
        driver = new MapDriver<LongWritable, Text, GetReq, IntWritable>(mapper);
        Mapper.METADATA_CSV ="../../data/metadata.csv"; //ugly hook
        linesFromFlatFileNoOutput = Sample.instance.getLinesFromFlatFileNoOutput();  
        linesFromFlatFileWithOutput = Sample.instance.getLinesFromFlatFileWithOutput(); 
    }

    @Test
    public void testEmptyOutput() throws Exception{
        for(String line : linesFromFlatFileNoOutput){
            //List<Pair<GetReq, IntWritable>> output = 
                    driver.withInput(UNUSED_LONG_KEY, new Text(line) )
                  .withOutput(null, null )
                  .runTest();
            //assertTrue("", output.isEmpty());
        }
    }

    @Test
    public void testResultOutput() throws Exception{
        for(String line : linesFromFlatFileWithOutput){
            driver.withInput(UNUSED_LONG_KEY, new Text(line) )
                //.withOutput(null, null )
                .runTest();
        }
    }
} 
```

嗯...我没有更改 pom.xml 中的任何内容现在我得到输出和相同的异常。看起来映射器运行一次。或 rties 运行。我从映射器主体获得调试输出。

**UPD：**我添加了分类器并更改了依赖项：

```
<dependency>
                <groupId>org.apache.mrunit</groupId>
                <artifactId>mrunit</artifactId>
                <version>0.9.0-incubating</version>
                <classifier>hadoop2</classifier>
                <scope>test</scope>
            </dependency> 
```

现在我确实遇到了另一个问题：

> 找到接口 org.apache.hadoop.mapreduce.Counter，但预期类

在线的：

```
context.getCounter(EnumCounter.MATCHED_RECORDS).increment(1); 
```

我又做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T15:23:05.803

我找到了解决方案：Nee 为 mr-unit 添加分类器标签。它应该看起来像：

```
<dependency> 
<groupId>org.apache.mrunit</groupId> 
<artifactId>mrunit</artifactId> 
<version>0.9.0-incubating</version> 
<classifier>hadoop2</classifier> 
<scope>test</scope> 
</dependency> 
```

现在我有另一个问题：**找到接口 org.apache.hadoop.mapreduce.Counter，但是**在计数器增量时需要类。这个问题与一些错误有关。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T19:27:16.247

在将错误版本的依赖项拉入运行时之前，我已经看到过这种问题。以前有两件事为我解决了这种问题：

1.  在您的 hadoop-core 依赖项上将“提供”更改为“编译”。这只是强制在运行时使用正确的版本。无论哪种方式，都返回“提供”。
2.  在 Eclipse 中，转到 pom 编辑器的依赖层次结构选项卡。您可以在此处查看您选择的依赖项是否一起引用了间接依赖项之一的多个版本。如果您找到这样的版本，请使用 maven 排除和显式依赖块来选择您要使用的版本。

# php - Yii：在控制器中访问模型常量

> ID：13144399
> 
> 赞同：0
> 
> 时间：2012-10-30T17:23:05.117
> 
> 标签：php, yii

使用 Yii 框架，我如何访问控制器中的模型常量？

模型.php

```
...
const STATUS_ACTIVE=1;
... 
```

控制器.php

```
...
$criteria->condition = 'status='.self::STATUS_ACTIVE;
... 
```

错误：

```
Fatal error: Undefined class constant 'STATUS_ACTIVE' in ... on line X 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-30T17:25:38.607

在您的控制器中，self 是没有此常量的控制器类。我想你想要：

```
Model::STATUS_ACTIVE 
```

其中 Model 是模型类的名称。IE：

```
$criteria->condition = 'status='.Model::STATUS_ACTIVE; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2022-01-09T00:26:27.683

假设您的模型类对象是 $model，它将是

```
$criteria->condition = 'status=' . $model::STATUS_ACTIVE; 
```

不确定选择的答案是如何工作的——当然对我不起作用。

# solr - SOLR 搜索：消除重复的电子邮件地址

> ID：13144404
> 
> 赞同：0
> 
> 时间：2012-10-30T17:23:24.217
> 
> 标签：solr

如果我的 SOLR 索引中有 2 条记录使用相同的电子邮件地址，并且我的关键字搜索在结果集中都得到了它们，我该如何显示其中一个。例如;

记录 1：

```
<doc>
     <id>123</id>
     <name>Adil Malik</name>
     <email>abc@hotmail.com</email>
     <jobtitile>Software Engineer</jobtitle>
</doc> 
```

记录 2：

```
<doc>
     <id>456</id>
     <name>Adil Malik</name>
     <email>abc@hotmail.com</email>
     <jobtitile>Database Developer</jobtitle>
</doc> 
```

如果我们用“abc@hotmail.com”搜索，它会返回两条记录，但我想显示其中任何一条。如果我们有 2 条具有相同的电子邮件地址，我如何在 SOLR 搜索中查询以仅显示一条记录？

注意：我想将这两条记录都保存到我的 SOLR 索引中。

* * *

回复@Layke

![在此处输入图像描述](../Images/01c051f0f42838461f8b2fbcc1d7ee7d.png)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-30T17:41:33.603

您应该阅读[FieldCollapsing](https://wiki.apache.org/solr/FieldCollapsing)和[重复数据删除](http://wiki.apache.org/solr/Deduplication)（重复数据删除完全阻止文档进入索引，这不是您想要的，但我会将其保留在这里以帮助其他可能适合的读者。）。

要使用 FieldCollapsing，您将使用您的查询并拥有`group: true , group.field : email`

但是，查看您提供的文档示例，我可能会说您设计的架构错误，而您真正想要做的是使用多值字段。

在此处阅读此问题，它可能会解释/建议您应该如何使用 MVF。

[Solr 中“多值”字段类型的用途是什么？](https://stackoverflow.com/questions/5800762/what-is-the-use-of-multivalued-field-type-in-solr)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T17:27:14.757

使用您的电子邮件字段作为唯一键如何不允许重复？在 wiki 页面中搜索`<uniqueKey>`schema.xml [https://wiki.apache.org/solr/SchemaXml](https://wiki.apache.org/solr/SchemaXml)

# asp.net-mvc - 在 ViewModel 中保存详细信息

> ID：13144414
> 
> 赞同：0
> 
> 时间：2012-10-30T17:24:02.870
> 
> 标签：asp.net-mvc, ef-code-first

我有一个用于创建新用户的 ViewModel，它更新了三个不同的模型。

我有一个关于如何编辑这些细节的问题。查看示例，控制器中的编辑方法将使用类似 userRepository.Save(); 但是对于用户模型以外的其他模型中的其他项目，我将如何保存它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T17:27:48.223

您应该拥有`DbContext`要更新的所有模型。调用`Save()`该上下文的实例将保存所有更改。

像这样

```
public class MainContext : DbContext
{
    public DbSet<User> Users { get; set; }
    public DbSet<Detail> Details { get; set; }
} 
```

# facebook - 无法从传输连接中读取数据。连接已关闭 facebook csharp sdk

> ID：13144417
> 
> 赞同：1
> 
> 时间：2012-10-30T17:24:06.010
> 
> 标签：facebook, facebook-c#-sdk

我开发了一个 Windows 应用程序，通过 facebook c# sdk 5.4 将照片上传到 facebook，但有时它会给我以下错误：

“无法从传输连接中读取数据。连接已关闭”

有人知道如何解决这个问题吗？谢谢

我使用的功能是发布我的数据

```
_fb.PostAsync(album_path, photoDetails); 
```

这对于发布完成

```
 public void fb_PostCompleted(object sender, FacebookApiEventArgs e)
    {
        if (e.Cancelled)
        {
            MessageBox.Show("Upload cancelled");
        }
        else if (e.Error == null)
        {
            // upload successful.
            this.lastUpload = false;
            updateCompleteCnt();
            //MessageBox.Show(e.GetResultData().ToString());
        }
        else
        {
            // upload failed
            MessageBox.Show(e.Error.Message);
        }

        this.progressbar_upload.BeginInvoke(new MethodInvoker(() =>
            {
                this.progressbar_upload.Value = 0;
            }));
    } 
```

# javascript - 使用 jQuery .animate() 时的图像动画问题

> ID：13144420
> 
> 赞同：2
> 
> 时间：2012-10-30T17:24:17.897
> 
> 标签：javascript, jquery, image, animation, jquery-animate

我有一个需要修复的图像动画问题。当用户将鼠标悬停在图像上时，图像的大小应该会增加。当用户离开图像时，图像应该恢复到原来的大小。

**问题：**当用户快速移出图像时，图像会扩大并开始自行扭曲，或者变成完全不同的大小。然后，当鼠标没有悬停在图像上时，它会继续动画。

这是[JSFiddle的一个问题](http://jsfiddle.net/TbDrB/2/)

`mouseover`我在方法中使用和`mouseout`事件遇到了同样的问题`.on()`。同时在`.on()`方法中将这些事件链接在一起

HTML：

```
<div id="content">
<img id="foo" src="http://www.nasa.gov/images/content/297522main_image_1244_946-710.jpg"  alt="" title="" /> 
```

jQuery：

```
jQuery('#content').on("hover", '#foo', function (e) {
    var $img = jQuery(this);
    var $imgWidth = $img.width();
    var $imgHeight = $img.height();
    var $imgTop = $img.position().top;
    if (e.type == "mouseenter") {
        $img.animate({
            top: $imgTop - 20,
            width: $imgWidth * 1.2,
            height: $imgHeight * 1.2
        }, 200);
    } else if (e.type == "mouseleave") {
        $img.animate({
            top: $imgTop + 20,
            width: $imgWidth / 1.2,
            height: $imgHeight / 1.2
        }, 200);
    }
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-30T17:30:15.680

每次将鼠标悬停在图像上时，您都会获得图像的宽度和高度，即使图像正在制作动画，所以当前值并不是您真正想要的值。

相反，存储原始值并处理这些值：

```
jQuery('img').load(function() {
    var $this = jQuery(this);

    $this.data({
        'orig-width': $this.width(),
        'orig-height': $this.height(),
        'orig-top': $this.position().top
    });
});

jQuery('#content').on("hover", '#foo', function(e) {
    var $this = jQuery(this);

    if (e.type == "mouseenter") {
        $this.stop().animate({
            top: $this.data('orig-top') - 20,
            width: $this.data('orig-width') * 1.2,
            height: $this.data('orig-height') * 1.2
        }, 200);
    } else if (e.type == "mouseleave") {
        $this.stop().animate({
            top: $this.data('orig-top'),
            width: $this.data('orig-width'),
            height: $this.data('orig-height')
        }, 200);
    }
});​ 
```

**演示：http: [//jsfiddle.net/TbDrB/5/](http://jsfiddle.net/TbDrB/5/)**

# c# - 我应该如何将域对象的属性转移到其模型对应物？

> ID：13144425
> 
> 赞同：2
> 
> 时间：2012-10-30T17:24:24.913
> 
> 标签：c#, asp.net-mvc, model

我们目前使用扩展方法来提供此功能，但我不禁觉得有一个更清洁的解决方案。我玩过 AutoMapper，但我不太明白它是如何在复杂情况下解决问题的。对于简单的 1:1 来说，它可以工作，但如果需要对数据进行任何修改——这似乎令人失望。

所以，我有类似的东西：

```
public static class ProvisioningExtensions
{
    // Convert ProvisioningServicesProxy.Provisioning to ProvisioningDetailsModel.
    public static ProvisioningDetailsModel ToProvisioningDetailsModel(this Provisioning provisioning)
    {
        var provisioningDetailsModel = new ProvisioningDetailsModel
        {
            ID = provisioning.ID,
            TaskDeviceID = provisioning.TaskDevice.ID,
            ServiceGroupID = provisioning.ServiceGroup.ID,
            ServiceID = provisioning.Service.ID,
            PatchSchedules = provisioning.PatchSchedules.Select(ps => ps.ToPatchScheduleDetailsModel()).ToList()
        };

        return provisioningDetailsModel;
    }

    // Convert ProvisioningDetailsModel to ProvisioningServicesProxy.PatchSchedule.
    public static Provisioning ToProvisioning(this ProvisioningDetailsModel provisioningDetailsModel)
    {
        WorkflowManager workflowManager = new WorkflowManager();
        ProvisioningManager provisioningManager = new ProvisioningManager();

        TaskDevice taskDevice = workflowManager.GetTaskDeviceByID(provisioningDetailsModel.TaskDeviceID);
        Service service = provisioningManager.GetServiceByID(provisioningDetailsModel.ServiceID);
        ServiceGroup serviceGroup = provisioningManager.GetServiceGroupByID(provisioningDetailsModel.ServiceGroupID);

        var provisioning = new Provisioning
        {
            ID = provisioningDetailsModel.ID,
            TaskDevice = taskDevice,
            ServiceGroup = serviceGroup,
            Service = service,
            PatchSchedules = provisioningDetailsModel.PatchSchedules.Select(ps => ps.ToPatchSchedule()).ToArray()
        };

        return provisioning;
    }
} 
```

ProvisioningDetailsModel 是一个只包含模型属性的类。没什么特别的。

我考虑过装饰 Provisioning 域对象，以便可以使用它来代替模型，但决定不这样做。如果我想以两种不同的方式表示供应数据怎么办——如果我使用域对象本身作为我的模型，这将是不可能的。

我应该考虑哪些其他选择？扩展方法将是我最后的选择——尤其是当我必须在 ToProvisioning 中做相对繁重的工作时。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T17:28:52.450

在 AutoMapper 中，您可以创建类型自定义转换器。这是通过实现 ITypeConverter<> 接口来完成的。

```
 public class CreateMomentoCommandToMomentoConverter : ITypeConverter<CreateMomentoCommand, Momento>
    {
        public Momento Convert(ResolutionContext context)
        {
            var source = (CreateMomentoCommand) context.SourceValue;
            var momento = new Momento {Username = source.Username};

            return momento;
        }
    } 
```

使用 AutoMapper 初始化客户类型转换器

```
 /// <summary>
    /// Configures the aut do mapper.
    /// </summary>
    public static void ConfigureAutoMapper()
    {
        AutoMapper.Mapper.Initialize(c=> c.CreateMap<CreateMomentoCommand, Momento>().ConvertUsing(new CreateMomentoCommandToMomentoConverter()));
    } 
```

最后映射它。

```
Mapper.Map<CreateMomentoCommand, Momento>(command); 
```

# android - 所有列在多列列表视图中显示相同的数据

> ID：13144427
> 
> 赞同：0
> 
> 时间：2012-10-30T17:24:35.930
> 
> 标签：android, android-layout, android-widget

大家好，在我的应用程序中，我正在显示多列列表视图（列表有 3 列），但在我的应用程序中，它显示的所有列都相同。我的列表视图布局如下：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="vertical"
android:paddingBottom="5dip"
android:paddingLeft="5dip"
android:paddingTop="5dip" >

<LinearLayout
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal"
    android:weightSum="3" >

    <LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_marginLeft="2dip"
        android:layout_marginRight="2dip"
        android:layout_weight="1"
        android:background="@drawable/listbackground"
        android:gravity="center"
        android:orientation="vertical" >

        <TextView
            android:id="@+id/Name"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:textColor="#C20000"
            android:textSize="14sp"
            android:textStyle="bold" />

        <TextView
            android:id="@+id/ltp"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content" />

        <LinearLayout
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_marginLeft="2dip"
            android:layout_marginRight="2dip"
            android:layout_weight="1"
            android:gravity="center"
            android:orientation="horizontal" >

            <ImageView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_alignParentLeft="true"
                android:layout_centerVertical="true"
                android:src="@drawable/down" />

            <TextView
                android:id="@+id/perChange"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content" />
        </LinearLayout>
    </LinearLayout>

    <LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_marginLeft="2dip"
        android:layout_marginRight="2dip"
        android:layout_weight="1"
        android:background="@drawable/listbackground"
        android:gravity="center"
        android:orientation="vertical" >

        <TextView
            android:id="@+id/Name1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:textColor="#C20000"
            android:textSize="14sp"
            android:textStyle="bold" />

        <TextView
            android:id="@+id/ltp1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content" />

        <LinearLayout
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_marginLeft="2dip"
            android:layout_marginRight="2dip"
            android:layout_weight="1"
            android:gravity="center"
            android:orientation="horizontal" >

            <ImageView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_alignParentLeft="true"
                android:layout_centerVertical="true"
                android:src="@drawable/down" />

            <TextView
                android:id="@+id/perChange1"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content" />
        </LinearLayout>
    </LinearLayout>

    <LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_marginLeft="2dip"
        android:layout_marginRight="2dip"
        android:layout_weight="1"
        android:background="@drawable/listbackground"
        android:gravity="center"
        android:orientation="vertical" >

        <TextView
            android:id="@+id/Name2"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:textColor="#C20000"
            android:textSize="14sp"
            android:textStyle="bold" />

        <TextView
            android:id="@+id/ltp2"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content" />

        <LinearLayout
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_marginLeft="2dip"
            android:layout_marginRight="2dip"
            android:layout_weight="1"
            android:gravity="center"
            android:orientation="horizontal" >

            <ImageView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_alignParentLeft="true"
                android:layout_centerVertical="true"
                android:src="@drawable/down" />

            <TextView
                android:id="@+id/perChange2"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content" />
        </LinearLayout>
    </LinearLayout>
</LinearLayout> 
```

```
 final ListView lv = (ListView) findViewById(R.id.srListView);
    lv.setAdapter(new MyCustomBaseAdapter(this, searchResults));

public class MyCustomBaseAdapter extends BaseAdapter {
    private ArrayList<SearchResults> searchArrayList;

    private LayoutInflater mInflater;

    public MyCustomBaseAdapter(Context context,
            ArrayList<SearchResults> results) {
        searchArrayList = results;
        mInflater = LayoutInflater.from(context);
    }

    public int getCount() {
        return searchArrayList.size();
    }

    public Object getItem(int position) {
        return searchArrayList.get(position);
    }

    public long getItemId(int position) {
        return position;
    }

    public View getView(int position, View convertView, ViewGroup parent) {
        ViewHolder holder;
        if (convertView == null) {
            convertView = mInflater.inflate(R.layout.custom_row_view, null);
            holder = new ViewHolder();
            holder.txtName = (TextView) convertView
                    .findViewById(R.id.Name);
            holder.txtCityState = (TextView) convertView
                    .findViewById(R.id.ltp);
            holder.txtPhone = (TextView) convertView
                    .findViewById(R.id.perChange);

            holder.txtName1 = (TextView) convertView
                    .findViewById(R.id.Name1);
            holder.txtCityState1 = (TextView) convertView
                    .findViewById(R.id.ltp1);
            holder.txtPhone1 = (TextView) convertView
                    .findViewById(R.id.perChange1);

            holder.txtName2 = (TextView) convertView
                    .findViewById(R.id.Name2);
            holder.txtCityState2 = (TextView) convertView
                    .findViewById(R.id.ltp2);
            holder.txtPhone2 = (TextView) convertView
                    .findViewById(R.id.perChange2);

            convertView.setTag(holder);
        } else {
            holder = (ViewHolder) convertView.getTag();
        }

        System.out.println("position::" + position);

        holder.txtName
                .setText(searchArrayList.get(position).getStockCode());
        holder.txtCityState.setText(searchArrayList.get(position).getLtp());
        holder.txtPhone.setText(searchArrayList.get(position)
                .getPerChange());

        holder.txtName1.setText(searchArrayList.get(position)
                .getStockCode());
        holder.txtCityState1
                .setText(searchArrayList.get(position).getLtp());
        holder.txtPhone1.setText(searchArrayList.get(position)
                .getPerChange());

        holder.txtName2.setText(searchArrayList.get(position)
                .getStockCode());
        holder.txtCityState2
                .setText(searchArrayList.get(position).getLtp());
        holder.txtPhone2.setText(searchArrayList.get(position)
                .getPerChange());

        return convertView;
    }

    class ViewHolder {
        TextView txtName;
        TextView txtCityState;
        TextView txtPhone;

        TextView txtName1;
        TextView txtCityState1;
        TextView txtPhone1;

        TextView txtName2;
        TextView txtCityState2;
        TextView txtPhone2;
    }
} 
```

它显示我的输出为

![在此处输入图像描述](../Images/3faa900e1060f50609869b8528d794d6.png)

现在在这里它显示所有列相同的数据，但我想要的是显示所有列不同的数据，如何做到这一点？任何帮助/建议将不胜感激，在此先感谢。

谢谢山姆，但现在如果名称很大，那么我的输出看起来会出现问题：假设 Vishal 变为 Vishallllllllllllllllllllll

![在此处输入图像描述](../Images/fa652c2dda3065504c554b6249e1d24b.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T17:46:00.060

> 我可以在gridview中的那个框中使用三行​​吗？如果是的话，你能告诉我任何样本/教程吗？

以下是如何修改现有代码示例以使用 GridView。

**首先**将您的布局简化为一个框，将其另存为`grid_item.xml`：

```
<LinearLayout
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_marginLeft="2dip"
    android:layout_marginRight="2dip"
    android:layout_weight="1"
    android:background="@drawable/listbackground"
    android:gravity="center"
    android:orientation="vertical" >

    <TextView
        android:id="@+id/Name"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:textColor="#C20000"
        android:textSize="14sp"
        android:textStyle="bold" />

    <TextView
        android:id="@+id/ltp"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" />

    <TextView
        android:id="@+id/perChange"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:drawableLeft="@drawable/down" />

</LinearLayout> 
```

（注意我合并了最后一个TextView和ImageView，你可能需要调整一下。）

**其次**简化您的`getView`方法：

```
public View getView(int position, View convertView, ViewGroup parent) {
    ViewHolder holder;
    if (convertView == null) {
        // Change the layout that is loaded
        convertView = mInflater.inflate(R.layout.grid_item, null);
        holder = new ViewHolder();
        holder.txtName = (TextView) convertView
                .findViewById(R.id.Name);
        holder.txtCityState = (TextView) convertView
                .findViewById(R.id.ltp);
        holder.txtPhone = (TextView) convertView
                .findViewById(R.id.perChange);

        convertView.setTag(holder);
    } else {
        holder = (ViewHolder) convertView.getTag();
    }

    System.out.println("position::" + position);

    SearchResult result = searchArrayList.get(position);
    holder.txtName.setText(result.getStockCode());
    holder.txtCityState.setText(result.getLtp());
    holder.txtPhone.setText(result.getPerChange());
    return convertView;
}

class ViewHolder {
    TextView txtName;
    TextView txtCityState;
    TextView txtPhone;
} 
```

**最后**更改这些参考资料（以及您可能拥有的任何其他参考资料）：

```
final GridView gv = (GridView) findViewById(R.id.srGridView);
gv.setAdapter(new MyCustomBaseAdapter(this, searchResults)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T17:32:42.233

看起来你的问题是问题。

```
holder.txtName2.setText(searchArrayList.get(position)
                .getStockCode());
        holder.txtCityState2
                .setText(searchArrayList.get(position).getLtp());
        holder.txtPhone2.setText(searchArrayList.get(position)
                .getPerChange());

holder.txtName1.setText(searchArrayList.get(position)
                .getStockCode()); 
```

在获取上做一个调试/断点我相信你的代码将意味着每行的三个盒子的“位置”int将是相同的。因此，它返回相同的数据并将其放入该行中的每个框中，这意味着您有重复项。

你会想做类似的事情

```
 holder.txtName2.setText(searchArrayList.get(position)
                    .getStockCode());
            holder.txtCityState2
                    .setText(searchArrayList.get(position).getLtp());
            holder.txtPhone2.setText(searchArrayList.get(position)
                    .getPerChange());

    holder.txtName1.setText(searchArrayList.get(position+column2dataoffset)
                    .getStockCode()); 
```

但我同意评论，网格布局会更好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T18:01:37.947

在您现有的代码中尝试此代码可能会对您有所帮助...

```
if((position * 3) <= getCount()){
    holder.txtName
            .setText(searchArrayList.get(position * 3).getStockCode());
    holder.txtCityState.setText(searchArrayList.get(position * 3).getLtp());
    holder.txtPhone.setText(searchArrayList.get(position * 3)
            .getPerChange());
}

if(((position * 3) + 1) <= getCount()){
    holder.txtName1.setText(searchArrayList.get((position * 3) + 1)
            .getStockCode());
    holder.txtCityState1
            .setText(searchArrayList.get((position * 3) + 1).getLtp());
    holder.txtPhone1.setText(searchArrayList.get((position * 3) + 1)
            .getPerChange());
}

if(((position * 3) + 2) <= getCount()){
    holder.txtName2.setText(searchArrayList.get((position * 3) + 2)
            .getStockCode());
    holder.txtCityState2
            .setText(searchArrayList.get((position * 3) + 2).getLtp());
    holder.txtPhone2.setText(searchArrayList.get((position * 3) + 2)
            .getPerChange());
} 
```

# r - 处理基于时间的对象时的 PerformanceAnalytics 错误？

> ID：13144430
> 
> 赞同：3
> 
> 时间：2012-10-30T17:25:00.080
> 
> 标签：r, time-series, xts, zoo

请将以下数据结构放入 R 中：

```
ret.tot <- structure(c(NA, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -0.0176629385269872, 
-0.00598540500471782, 0.000397233717450593, 0.0306832492016377, 
0.017489053560066, 0.00269955471373475, -0.0320201783372234, 
-0.0275430853903852, -0.000590271106063863, 0.0129459406811023, 
0.0149953072553982, -0.0129087888171287, -0.00130280102489988, 
-0.0377404713075129, 0.0236191282922097, -0.0119020468768697, 
-0.115096461748588, 0.100199681314344, 0.0911308738334283, -0.110863725885523, 
-0.0727448946117171, 0.0474370051015683, -0.0261582369412903, 
0.0555183596655775, 0.00860003940385565, 0.0346875742874423, 
0.0165600647484871, 0.0289458251073716, -0.0200260791601897, 
0.0762373770534174, -0.0221922758574445, -0.0462536669889334, 
0.0145014986918377, 0.00785273903343038, 0.0278941165111914, 
-0.0147065715501423, 0.0153730326847651, 0.0144617698521356, 
0.0197478508710501, 0.0251269321439706, -0.0103666325237731, 
-0.00157067125918319, 0.0115368085910558, -0.0200792001115183, 
0.0309994626763721, -0.00718247947811835, 0.0175666609422171, 
0.00657518046680547, -0.0281804455661145, 0.0239339965633073, 
-0.0040811434351766, -0.00861507762926691, 0.0492982380847687, 
0.0101687467126706, 0.0134748887393316, 0.0258425088138871, 0.00378545928098804, 
-0.0150120910386031, 0.00362726110322858, -0.00593835966763433, 
0.0312603603825787, 0.0111363934978518, 0.00793289404006547, 
0.00807089833865603, -0.0118743825996689), .Dim = c(78L, 1L), .Dimnames = list(
    NULL, NULL), index = structure(c(1146441600, 1149120000, 
1151712000, 1154390400, 1157068800, 1159660800, 1162339200, 1164931200, 
1167609600, 1170288000, 1172707200, 1175385600, 1177977600, 1180656000, 
1183248000, 1185926400, 1188604800, 1191196800, 1193875200, 1196467200, 
1199145600, 1201824000, 1204329600, 1207008000, 1209600000, 1212278400, 
1214870400, 1217548800, 1220227200, 1222819200, 1225497600, 1228089600, 
1230768000, 1233446400, 1235865600, 1238544000, 1241136000, 1243814400, 
1246406400, 1249084800, 1251763200, 1254355200, 1257033600, 1259625600, 
1262304000, 1264982400, 1267401600, 1270080000, 1272672000, 1275350400, 
1277942400, 1280620800, 1283299200, 1285891200, 1288569600, 1291161600, 
1293840000, 1296518400, 1298937600, 1301616000, 1304208000, 1306886400, 
1309478400, 1312156800, 1314835200, 1317427200, 1320105600, 1322697600, 
1325376000, 1328054400, 1330560000, 1333238400, 1335830400, 1338508800, 
1341100800, 1343779200, 1346457600, 1349049600), tzone = "", tclass = "yearmon"), .indexCLASS = "yearmon", tclass = "yearmon", .indexTZ = "", tzone = "", class = c("xts", 
"zoo")) 
```

我的 R 会话：

```
R version 2.15.1 (2012-06-22)
Platform: i386-pc-mingw32/i386 (32-bit)

locale:
[1] LC_COLLATE=English_Australia.1252  LC_CTYPE=English_Australia.1252   
[3] LC_MONETARY=English_Australia.1252 LC_NUMERIC=C                      
[5] LC_TIME=English_Australia.1252    

attached base packages:
[1] stats     graphics  grDevices datasets  utils     methods   base     

other attached packages:
 [1] quantmod_0.3-17       TTR_0.21-1            xts_0.8-6            
 [4] zoo_1.7-8             Defaults_1.1-1        rmgarch_0.97         
 [7] Matrix_1.0-9          lattice_0.20-10       Kendall_2.2          
[10] spd_1.7               KernSmooth_2.23-8     rugarch_1.0-11       
[13] Rsolnp_1.12           truncnorm_1.0-6       chron_2.3-42         
[16] numDeriv_2012.3-1     MASS_7.3-18           RcppArmadillo_0.3.4.2
[19] Rcpp_0.9.13           rcom_2.2-5            rscproxy_2.0-5       

loaded via a namespace (and not attached):
[1] boot_1.3-7                   grid_2.15.1                 
[3] PerformanceAnalytics_1.0.4.4 timeDate_2160.95
[5] timeSeries_2160.94           tools_2.15.1 
```

给我问题的代码：

```
op <- par(no.readonly = TRUE)
library(PerformanceAnalytics)
charts.PerformanceSummary(R = ret.tot, Rf = .0)
table.AnnualizedReturns(R = ret.tot, scale = 12, Rf = 0)
table.Returns(R = ret.tot)
detach(package:PerformanceAnalytics)
par(op) 
```

上面的代码返回以下错误：

```
> table.AnnualizedReturns(R = ret.tot, scale = 12, Rf = 0)
Error in xts(rep(Rf, length(indexseries)), order.by = indexseries) : 
  order.by requires an appropriate time-based object
> table.Returns(R = ret.tot)
Error in matrix(unlist(value, recursive = FALSE, use.names = FALSE), nrow = nr,  : 
  'data' must be of a vector type 
```

我猜和其他包之间有些冲突`PerformanceAnalytics`，但我不明白谁是有罪的......

```
ret.tot <- xts(ret.tot, order.by = as.POSIXct(index(ret.tot))) 
```

所以...

```
> charts.PerformanceSummary(R = ret.tot, Rf = .0)
Error in UseMethod("first") : 
  no applicable method for 'first' applied to an object of class "c('xts', 'zoo')"

> table.AnnualizedReturns(R = ret.tot, scale = 12, Rf = 0)
                              NA
Annualized Return         0.0335
Annualized Std Dev        0.1144
Annualized Sharpe (Rf=0%) 0.2928

> table.Returns(R = ret.tot)
Error in matrix(unlist(value, recursive = FALSE, use.names = FALSE), nrow = nr,  : 
  'data' must be of a vector type 
```

啊！

（与 相同`as.Date()`）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T05:17:09.220

我可以重现您的问题，但使用完全不同的系统（见下文）。所以我不认为你的问题是由于你安装了这些软件包。

我的猜测是 PerformanceAnalytics 中的某些函数不需要 yearmon 日期类型，因此请尝试将其转换为 POSIXct。是的，我刚刚确认：

```
z=xts(coredata(ret.tot), order.by=as.POSIXct(index(ret.tot)) )
table.AnnualizedReturns(R = z, scale=12,Rf=0) 
```

给出了这个：

```
 NA
Annualized Return         0.0335
Annualized Std Dev        0.1144
Annualized Sharpe (Rf=0%) 0.2928 
```

**更新您的更新**

1.  `charts.PerformanceSummary()`对我有用，对对象`as.POSIXct`和`as.Date`对象都有效。也许再试一次，有一个新的会话？

2.  因为`table.Returns`我通过给列命名来修复它！这有点奇怪，而且没有记录，所以你可以提交一个错误报告。但只要给它一个名字：

    ```
    colnames(ret.tot)=c('something') 
    ```

* * *

这是我的 sessionInfo()

```
R version 2.15.1 (2012-06-22)
Platform: x86_64-pc-linux-gnu (64-bit)

locale:
 [1] LC_CTYPE=en_US.utf8       LC_NUMERIC=C              LC_TIME=en_US.utf8        LC_COLLATE=en_US.utf8     LC_MONETARY=en_US.utf8    LC_MESSAGES=en_US.utf8   
 [7] LC_PAPER=C                LC_NAME=C                 LC_ADDRESS=C              LC_TELEPHONE=C            LC_MEASUREMENT=en_US.utf8 LC_IDENTIFICATION=C      

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] PerformanceAnalytics_1.0.4.4 xts_0.8-6                    zoo_1.7-7                   

loaded via a namespace (and not attached):
[1] grid_2.15.1     lattice_0.20-10 tools_2.15.1 
```

# python - 为什么实例变量表现得像 Python 中的类变量？

> ID：13144433
> 
> 赞同：3
> 
> 时间：2012-10-30T17:25:09.860
> 
> 标签：python, class, variables, instance

> **可能的重复：**
> [Python 中的“Least Astonishment”：可变默认参数](https://stackoverflow.com/questions/1132941/least-astonishment-in-python-the-mutable-default-argument)

我有以下代码：

```
class Node(object):
    def __init__(self, value = 0, children = {}):
        self.val = value
        self.children = children

    def setChildValue(self, index, childValue):
        self.children[index] = Node(childValue)

n = Node()
n.setChildValue(0,10)
print n.children
n2 = Node()
print n2.children 
```

它打印：

```
{0: <__main__.Node object at 0x10586de90>}
{0: <__main__.Node object at 0x10586de90>} 
```

所以我的问题是，为什么在 n2 中定义了孩子？Children 是一个实例变量，但它的行为就像一个类变量。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-30T17:27:16.093

您正在为`children`每个实例分配相同的字典。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T17:28:20.623

当你定义函数时`__init__`，你给它一个字典作为默认参数。该字典创建一次（当您定义函数时），然后每次`__init__`调用时使用。

更多信息： [http ://effbot.org/zone/default-values.htm](http://effbot.org/zone/default-values.htm)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-30T17:31:12.587

正如 Martijn 的评论和 kindall 的回答中所指出的，您遇到了可变的默认参数行为，这在某些时候会困扰大多数 Python 开发人员，您可以通过以下方式进行修改`Node.__init__()`，使其按您期望的方式工作：

```
class Node(object):
    def __init__(self, value = 0, children = None):
        self.val = value
        if children is None:
            self.children = {}
        else:
            self.children = children 
```

# c# - C# 等价于 C const char**

> ID：13144435
> 
> 赞同：2
> 
> 时间：2012-10-30T17:25:16.910
> 
> 标签：c#, c, dll

我想在 C# 中实现 Mongoose (http://code.google.com/p/mongoose/) 绑定。有一些示例，但它们不适用于当前版本。

这是我当前的函数调用：

```
[DllImport("_mongoose",CallingConvention=CallingConvention.Cdecl)] private static extern IntPtr mg_start(int zero, Nullable, string options); 
```

（工作）C等价物将是：

```
const char *options[] = {
     "document_root", "/var/www",
     "listening_ports", "80,443s",
     NULL
   };
struct mg_context *ctx = mg_start(&my_func, NULL, options); 
```

其中 mg_start 定义为：

```
struct mg_context *mg_start(mg_callback_t callback, void *user_data,
                            const char **options); 
```

您可以在这里找到整个 C 示例： [https ://svn.apache.org/repos/asf/incubator/celix/trunk/remote_services/remote_service_admin_http/private/include/mongoose.h](https://svn.apache.org/repos/asf/incubator/celix/trunk/remote_services/remote_service_admin_http/private/include/mongoose.h)

如何转移`const char *options[]`到 c#？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T17:55:02.477

```
DllImport("_mongoose",CallingConvention=CallingConvention.Cdecl)]
private static extern IntPtr mg_start(IntPtr callback, IntPtr userData,
    [In][MarshalAsAttribute(UnmanagedType.LPArray,
                            ArraySubType=UnmanagedType.LPStr)] string[] options); 
```

没有尝试过，但我认为这可以让你到达那里。如果您想在 C 调用中使用 unicode，您可能需要将 ArraySubType 设置为 LPWStr。使它成为 LPStr 为您提供 ANSI。

你在做函数指针吗？这才是真正的挑战所在。与其说是声明和编组，不如说是指针寿命问题。如果 mg_start 保留委托的非托管版本，您可能会发现 thunk 会在您身上收集垃圾，尽管文档说了什么。我们经常看到这种情况发生，因此我们尽可能地重新设计了底层粘合剂以不使用这种代码风格。

一般来说，如果 API 是一个带有大量回调的健谈 API，那么您将被回调所困扰。您最好尝试创建一个 C++/CLI 库，该库以一种更简洁的方式实现 API，并具有明确的托管/非托管边界。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T17:39:45.850

在 C# 中，char 是 Unicode 字符，因此由两个字节组成。在这里使用字符串不是一个选项，但您可以使用 Encoding.ASCII 类将 unicode 字符串的 ASCII 表示形式获取为字节数组：

```
byte[] asciiString = Encoding.ASCII.GetBytes(unicodeString); 
```

C# 的数组是引用，也就是 C 中的指针，因此您可以将代码编写为：

```
byte[][] options = {
    Encoding.ASCII.GetBytes("document_root"),
    Encoding.ASCII.GetBytes("/var/www"),
    Encoding.ASCII.GetBytes("listening_ports"),
    Encoding.ASCII.GetBytes("80,443s"),
    null
}; 
```

除了使用只读索引器和私有字节数组创建包装类之外，您无法对 const 做任何事情，但这不适用于您的情况。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T17:40:41.803

我只是想建议在[项目页面](http://code.google.com/p/mongoose/)上使用 C# 绑定，它们具有以下功能：

*   Python 和 C# 绑定

你试过这个吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-30T17:32:54.633

C# 中的 char[] 是一个字符串。

看起来您正在定义一个指向 char[] 的指针。在 C 中，这是 Array of Arrays，对吧？所以在 C# 中它只是：

```
String[] options = {
 "document_root", "/var/www",
 "listening_ports", "80,443s",
 NULL
}; 
```

希望能帮助到你。

问候。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-30T17:33:14.813

尝试

```
[DllImport("_mongoose",CallingConvention=CallingConvention.Cdecl)] 
private static extern IntPtr mg_start(int zero, IntPtr userData, string[] options); 
```

并`IntPtr.Zero`用作`userdata`. 和类似的东西

```
new [] { "document_root", "/var/www", "listening_ports", "80,443s", null } 
```

作为选项。

# frama-c - Frama-C 选项 -no-simplify-cfg 不起作用

> ID：13144443
> 
> 赞同：2
> 
> 时间：2012-10-30T17:25:47.800
> 
> 标签：frama-c

我正在使用 Frama-C 来计算 C 程序的一部分。我希望切片程序看起来像没有代码转换的原始程序。然而，在生成的切片中，我总是有 goto 语句和标签。我使用命令：

```
frama-c -no-simplify-cfg -main test -slice-assert test test.c -then-on 'Slicing export' -print -ocode result.c 
```

我在 Cygwin 下的 Windows 机器上从最新的 Oxygen 版本编译了 Frama-C。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-30T23:03:01.980

```
$ frama-c -kernel-help
[...]
-simplify-cfg   remove break, continue and switch statement[sic] before
                analyzes[sic] (opposite option is -no-simplify-cfg) 
```

选项 -no-simplify-cfg 不做任何事情，因为不简化 `break`，`continue`并且`switch`statements 已经是默认设置。

前端确实`goto`以非可选的方式引入语句和标签作为这些目标的目标，作为其他结构的翻译，例如`||`and `&&`。没有办法禁用这种治疗。切片插件选择部分 AST 并擦除其他部分，因此`goto`语句出现在其输出中。

Frama-C 的切片插件是我所知道的唯一一个为 C 程序生成可编译切片的切片器。如果您需要更好的不引入`goto`语句的切片器，您可能需要编写自己的切片器。

# tsql - SQL 使用 WITH 子句使用多个结果

> ID：13144444
> 
> 赞同：0
> 
> 时间：2012-10-30T17:25:47.903
> 
> 标签：tsql, select

> **可能重复：**
> [为什么我使用过一次后无法访问我的 CTE？](https://stackoverflow.com/questions/1590994/why-cant-i-access-my-cte-after-i-used-it-once)

如何使用 WITH 获得多个结果？

```
;WITH X AS
    (SELECT whatever)

, Y AS
    (SELECT whatever FROM X)

SELECT * FROM Y WHERE condition

SELECT Count(*) FROM X                <==== X doesn't work here 
```

我不想要**@@RecordCount**，这算**Y**，而不是**X**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T22:49:58.710

在它所属的语句完成后，您将无法访问 CTE。

不过，您可以将其包含在您的第一个结果集中：

```
SELECT Y.*, (SELECT COUNT(*) FROM X) as X_Count
FROM Y
WHERE condition 
```

但是，这将在结果的每一行中包含该值。

将 X 设为表变量而不是 CTE 可能会更好。

# c# - 从两个服务引用序列化相同的类

> ID：13144453
> 
> 赞同：3
> 
> 时间：2012-10-30T17:26:27.433
> 
> 标签：c#, class, xml-serialization, xmlserializer

我正在尝试使用 XMLSerialize 从我的一个类中生成一个 .xml，其中包含来自两个第三方服务引用的成员。

我在 XmlSerializer 上遇到了这个错误（因为两个第三方服务在它们的引用中都有相同的类名）。

> 类型“ExternalServiceReference1.SameClass”和“ExternalServiceReference2.SameClass”都使用命名空间“http://blablabla/”中的 XML 类型名称“SameClass”。使用 XML 属性为类型指定唯一的 XML 名称和/或命名空间。

ExternalServiceReference1 中的 TestClass1 包含 SameClass 类型的成员 ExternalServiceReference2 中的 TestClass2 还包含 SameClass 类型的成员

我的课看起来像这样：

```
using ExternalServiceReference1; // This is the first thrid-party service reference, that contain the TestClass1\. 
using ExternalServiceReference2; // This is the second thrid-party service reference, that contain the TestClass2.

[Serializable]
public class Foo
{
    public TestClass1 testClass1;
    public TestClass2 TestClass2;
}

My test program : 

class Program
    {
        static void Main(string[] args)
        {
            var xmlSerializer = new XmlSerializer(Foo.GetType());

        }
    } 
```

我的问题 ：

如何在不修改项目中两个服务引用的 reference.cs 的情况下解决这个问题？

如果解决方案是在我自己的类（ Foo ）或 XmlSerializer 调用上添加属性，我没有问题。但我不想更改为两个外部参考生成的reference.cs。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T15:10:08.037

如果我理解你的困惑，这应该会有所帮助。

```
namespace XmlSerializerTest
{
    class Program
    {
        static void Main(string[] args)
        {
            Example exampleClass = new Example();
            exampleClass.someClass1 = new ext1.SomeClass(){ Value = "Hello" };
            exampleClass.someClass2 = new ext2.SomeClass(){ Value = "World" };

            var xmlSerializer = new XmlSerializer(typeof(Example));
            xmlSerializer.Serialize(Console.Out, exampleClass);
            Console.ReadLine();
        }
    }

    [XmlRoot(ElementName = "RootNode", Namespace = "http://fooooo")]
    public class Example
    {
        [XmlElement(ElementName = "Value1", Type = typeof(ext1.SomeClass), Namespace = "ext1")]
        public ext1.SomeClass someClass1 { get; set; }
        [XmlElement(ElementName = "Value2", Type = typeof(ext2.SomeClass), Namespace = "ext2")]
        public ext2.SomeClass someClass2 { get; set; }
    }
} 
```

输出：

```
<?xml version="1.0" encoding="ibm850"?>
<RootNode xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http:
//www.w3.org/2001/XMLSchema" xmlns="http://fooooo">
  <Value1 xmlns="ext1">
    <Value>Hello</Value>
  </Value1>
  <Value2 xmlns="ext2">
    <Value>World</Value>
  </Value2>
</RootNode> 
```

# sql - 提高严重依赖日期的视图的性能

> ID：13144458
> 
> 赞同：0
> 
> 时间：2012-10-30T17:26:47.870
> 
> 标签：sql, sql-server, sql-server-2008, tsql

**这个视图需要我几个小时才能执行：**

```
USE [SalesDWH]
GO

/****** Object:  View [dbo].[FirstLastEstablished]    Script Date: 10/29/2012 15:12:47 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

ALTER view [dbo].[FirstLastEstablished] as

with cte_min as(

select 
      a.client_id
      ,a.specimen_source
      ,a.received_date
from
      millennium_dw_dev..F_ACCESSION_DAILY a
join
            (select distinct
                  f.client_id
                  ,f.received_date
                  ,f.accession_daily_key
            from 
                  millennium_dw_dev..F_ACCESSION_DAILY f
            join 
                  (select CLIENT_ID, MIN(received_date) MinRecDate
                  from millennium_dw_dev..F_ACCESSION_DAILY
                  group by CLIENT_ID) i
            on f.CLIENT_ID=i.CLIENT_ID
            and f.RECEIVED_DATE=i.MinRecDate) b
on    
      a.ACCESSION_DAILY_KEY=b.ACCESSION_DAILY_KEY 

)

,
cte_max as 
(

select 
      a.client_id
      ,a.specimen_source
      ,a.received_date
from
      millennium_dw_dev..F_ACCESSION_DAILY a
join
            (select distinct
                  f.client_id
                  ,f.received_date
                  ,f.accession_daily_key
            from 
                  millennium_dw_dev..F_ACCESSION_DAILY f
            join 
                  (select CLIENT_ID, max(received_date) MaxRecDate
                  from millennium_dw_dev..F_ACCESSION_DAILY
                  group by CLIENT_ID) i
            on f.CLIENT_ID=i.CLIENT_ID
            and f.RECEIVED_DATE=i.MaxRecDate) b
on    
      a.ACCESSION_DAILY_KEY=b.ACCESSION_DAILY_KEY 

)
,

cte_est as

(

select distinct client_id, MLIS_DATE_ESTABLISHED
from millennium_dw_dev..D_CLIENT
where REC_ACTIVE_FLG=1
and MLIS_DATE_ESTABLISHED is not null
)

,

mainQuery as(
select distinct
      f.client_id
      ,cmin.specimen_source first_specimen_source
      ,cmin.received_date first_received
      ,cmax.specimen_source last_specimen_source
      ,cmax.received_date last_received
      ,cest.MLIS_DATE_ESTABLISHED MLIS_DATE_ESTABLISHED
from millennium_dw_dev..F_ACCESSION_DAILY f
left join cte_max cmax
on cmax.CLIENT_ID=f.CLIENT_ID
left join cte_min cmin
on cmin.CLIENT_ID=f.CLIENT_ID
left join cte_est cest
on cest.CLIENT_ID=f.CLIENT_ID
)
,
DateDifferences
as

(
SELECT
client_id,
   (DATEDIFF(dd, MLIS_DATE_ESTABLISHED,first_received) + 1)
  -(DATEDIFF(wk, MLIS_DATE_ESTABLISHED,first_received) * 2)
  -(CASE WHEN DATENAME(dw, first_received) = 'Sunday' THEN 1 ELSE 0 END)
  -(CASE WHEN DATENAME(dw, MLIS_DATE_ESTABLISHED) = 'Saturday' THEN 1 ELSE 0 END)
 -(case when cast('01/01/2008 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)
-(case when cast('05/26/2008 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)
-(case when cast('07/04/2008 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)
-(case when cast('09/01/2008 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)
-(case when cast('11/27/2008 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)
-(case when cast('12/25/2008 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)
-(case when cast('01/01/2009 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)
-(case when cast('05/25/2009 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)
-(case when cast('07/03/2009 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)
-(case when cast('09/07/2009 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)
-(case when cast('11/26/2009 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)
-(case when cast('12/25/2009 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)
-(case when cast('01/01/2010 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)
-(case when cast('05/31/2010 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)
-(case when cast('07/05/2010 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)
-(case when cast('09/06/2010 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)
-(case when cast('11/25/2010 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)
-(case when cast('12/24/2010 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)
-(case when cast('01/03/2011 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)
-(case when cast('05/30/2011 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)
-(case when cast('07/04/2011 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)
-(case when cast('09/05/2011 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)
-(case when cast('11/24/2011 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)
-(case when cast('12/26/2011 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)
-(case when cast('01/02/2012 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)
-(case when cast('05/28/2012 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)
-(case when cast('07/04/2012 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)
-(case when cast('09/03/2012 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)
-(case when cast('11/22/2012 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)
-(case when cast('12/25/2012 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)

   DifferenceExcludingWeekends
  from
  mainQuery
)
,
Territory 
as
(
select distinct c.client_id,c.MLIS_TERRITORY,s.REGION_NAME
from millennium_dw_dev..D_CLIENT c
left join millennium_dw_dev..D_SALES_HIERARCHY s
on s.TERRITORY_NAME=c.MLIS_TERRITORY
where c.REC_ACTIVE_FLG=1
and s.REC_ACTIVE_FLG=1

)

select mainQuery.*,d.DifferenceExcludingWeekends,Territory.MLIS_TERRITORY,Territory.REGION_NAME
from mainQuery
left join DateDifferences d
on mainQuery.CLIENT_ID=d.CLIENT_ID
left join Territory
on mainQuery.CLIENT_ID=Territory.CLIENT_ID

GO 
```

我对此进行了 sql server 数据库调整，并创建了所有推荐的索引。再次执行视图 15 分钟后，我停止了它。

**关于我的查询，您是否可以向我指出一些明显的事情，以进一步优化它并缩短执行时间？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T19:23:37.163

我认为您没有使用 CTE 的“通用”方面。尝试首先将 table: millennium_dw_dev..F_ACCESSION_DAILY 放在 CTE 中（如果可能，仅使用必要的字段和记录）。您的代码从该表中选择了 8 次（并且该表是本地的吗？）。

您的其他几个 CTE 被引用一次，但我可以看到一个如何构建在另一个之上。是的，它们可以帮助将复杂的查询分解为更易于管理的部分，但它可能对性能没有帮助。

性能在这里可能不是问题，但是将这些硬编码的日期放入某种假期/休假表中也会有所帮助。拥有一个[日期表](http://www.codeproject.com/Articles/26565/Generate-Date-Table-in-SQL-Server)可能是比所有这些计算更好的途径。

根据数据的大小，将其放入存储过程将允许使用索引临时表。

# drools - 包含日期（规则引擎）的 Drools json Api 调用

> ID：13144460
> 
> 赞同：0
> 
> 时间：2012-10-30T17:26:51.583
> 
> 标签：drools, rule-engine, fact

我正在尝试调用 Drools Json api，而我的一个事实是 Date 类型。我不确定如何为此构造 json 字符串。！！！！！！？？？？？？:(

这是我所拥有的：

我的 drl 文件：包 com.beachmint.common

声明订单 orderId：整数 customerId：整数总：java.math.BigDecimal cartId：整数 createdAt：java.util.Date productIds：java.util.ArrayList end

声明客户 customerId：整数 referrerId：整数 customerStatus：整数 createdAt：java.util.Date end

声明积分状态：字符串计数：整数 customerId：整数原因：字符串 ruleId：字符串结束

声明事件名称：字符串 storeId：整数结束

规则'Purchase Promo'方言“mvel”当e：事件（名称匹配“Purchase”）o：订单（总> 0，createdAt>“08-Oct-2012”，createdAt <=“01-Jan-2013”​​）

然后 p.setCount( p.getCount() + 2000 );

我尝试以 UTC 和字符串 ('yMd) 格式发送日期。

createdAt":{"date":"2012-Jan-01"} createdAt": 1351637683 createdAt": "2012-Jan-01"

这些都不起作用:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T19:08:08.413

您可以使用默认日期格式，也可以使用 drools.dateformat 系统属性进行更改。请参阅[手册](http://docs.jboss.org/drools/release/5.4.0.Final/drools-expert-docs/html/ch04.html)。

> 4.8.3.3.7.1。日期文字
> 
> 默认支持日期格式 dd-mmm-yyyy。您可以通过提供替代日期格式掩码作为名为 drools.dateformat 的系统属性来自定义此设置。如果需要更多控制，请使用限制。
> 
> 例 4.36。日期字面量限制
> 
> 奶酪（最好在 <“2009 年 10 月 27 日”之前）

# c# - 使用 stringformat 时 WPF 文本框绑定不起作用

> ID：13144461
> 
> 赞同：3
> 
> 时间：2012-10-30T17:26:55.430
> 
> 标签：c#, .net, wpf, xaml

这是我的问题：

我有一个文本框，它正在使用文本框预览并对输入的文本进行一些验证。文本框绑定到双属性。最初，当用户输入一个带小数的数字时，它会崩溃，因为当数字为 1 时，它会在每次击键后更新。它会自动更改为 1（删除小数），当在小数点后添加下一个数字时，它会认为插入新字符的位置是位置 3，但由于小数点被自动删除，因此不再是位置 3，它会出错。我通过添加解决了这个问题`StringFormat={}{0:d}`到 xaml。除了第一次加载所有内容时不再显示原始值（来自数据库的值）这一事实之外，这工作正常。但是，如果我只删除 StringFormat 值将加载但我再次遇到崩溃问题。

有任何想法吗？

```
 <TextBox Grid.Column="1" Margin="0" VerticalAlignment="Top"
                             Controls:TextBoxMask.NumericType="Double"
                             Text="{Binding Path=Model.Processor.BulkShiftInMilliseconds, UpdateSourceTrigger=PropertyChanged, StringFormat={}{0:d}}"/> 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-10-30T18:56:58.140

经测试，正文必须为 30 个字符

```
StringFormat={}{0} 
```

# awk - awk 和多行匹配（子正则表达式）

> ID：13144464
> 
> 赞同：5
> 
> 时间：2012-10-30T17:27:09.893
> 
> 标签：awk

我正在尝试使用 awk 来解析多行表达式。其中一个看起来像这样：

```
_begin  hello world !
_attrib0    123
_attrib1    super duper
_attrib1    yet another value
_attrib2    foo
_end 
```

我需要提取与_begin 和_attrib1 关联的值。因此，在示例中，awk 脚本应返回（每行一个）：

```
hello world ! super duper yet another value 
```

使用的分隔符是制表符 (\t) 字符。空格仅在字符串中使用。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-30T17:36:36.277

以下 awk 脚本完成了这项工作：

```
#!/usr/bin/awk -f
BEGIN { FS="\t"; }
/^_begin/      { output=$2; }
$1=="_attrib1" { output=output " " $2; }
/^_end/        { print output; } 
```

您没有指定是否要将制表符 ( `\t`) 作为*输出*字段分隔符。如果你这样做，请告诉我，我会更新答案。（或者你可以；这很简单。）

当然，如果你想要一个可怕的选择（因为我们已经接近万圣节了），这里有一个解决方案`sed`：

```
$ sed -ne '/^_begin./{s///;h;};/^_attrib1[^0-9]/{s///;H;x;s/\n/ /;x;};/^_end/{;g;p;}' input.txt 
hello world ! super duper yet another value 
```

这是如何运作的？Mwaahahaa，我很高兴你问。

*   `/^_begin./{s///;h;};`-- 当我们看到`_begin`时，将其剥离并将该行的其余部分存储到 sed 的“保持缓冲区”。
*   `/^_attrib1[^0-9]/{s///;H;x;s/\n/ /;x;};`-- 当我们看到`_attrib1`时，将其剥离，将其附加到保持缓冲区，交换保持缓冲区和模式空间，用空格替换换行符，然后再次交换保持缓冲区和模式空间。
*   `/^_end/{;g;p;}`-- 我们已经到了尽头，所以将保持缓冲区拉入模式空间并打印它。

这假设您的输入字段分隔符只是一个选项卡。

很简单。谁曾说`sed`是奥术？！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T17:44:41.107

这应该有效：

```
#!/bin/bash 

awk 'BEGIN {FS="\t"} {if ($1=="_begin" || $1=="_attrib1") { output=output " " $2 }} END{print output}' 
```

# asp.net - GDI 抗锯齿在 Server 2008 上无法正常工作

> ID：13144466
> 
> 赞同：2
> 
> 时间：2012-10-30T17:27:14.237
> 
> 标签：asp.net, vb.net, fonts, windows-server-2008, system.drawing

我正在使用 System.Drawing 动态生成一些图像，其中包括基本图像以及一些拉伸/缩放的文本。在我的 LOCALHOST 环境中一切都很好而且很整洁，但是当我发布到我的服务器（Server 2008）时，我失去了一些抗锯齿并且图像质量变得粗糙。

这是从我的本地环境（Windows 7）复制的示例，然后从我的服务器（Server 2008）复制

Windows 7的：

![在此处输入图像描述](../Images/c5ee9db7fe847353f50126947ab5509f.png)

视窗 2008：

![在此处输入图像描述](../Images/bf4cbf5eb2074c6879dc4d2ff4d5a6e6.png)

如您所见，图像的大小相同，字体的缩放比例也相同。服务器版本似乎没有消除锯齿来平滑边缘。这是主要的代码：imgSign 和 grSign 是已建立的图像和图形对象，具有设定的大小/背景颜色，文本将被缩放/绘制到该对象上。

```
'Requested size of test
Dim textSize As SizeF = grSign.MeasureString(textString, font)
Dim intTextWidth As Integer = textSize.Width
Dim intTextHeight As Integer = textSize.Height

'Create image to hold text
Dim img As Drawing.Image = New Bitmap(intTextWidth, intTextHeight)
Dim gr As Graphics = Graphics.FromImage(img)

'Smoothing mode
gr.SmoothingMode = Drawing2D.SmoothingMode.HighQuality
gr.TextRenderingHint = Text.TextRenderingHint.AntiAlias

'Scale Text
Dim sngScaleWidth As Single = imgSign.Width / intTextWidth
If sngScaleWidth > 1 Then sngScaleWidth = 1 'Don't scale down width if it doesn't need to be
Dim sngScaleHeight As Single = imgSign.Height / intTextHeight
grSign.ScaleTransform(sngScaleWidth, sngScaleHeight)

'Draw text
gr.DrawString(textString, font, Brushes.White, 0, 0) 
```

是否有一些我必须解决的 Server 2008 上没有的功能，或者我可以设置一个开关来提高质量，还是我需要寻找其他地方？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T20:16:26.703

也尝试在您的 Graphics gr 上设置此设置

```
gr.InterpolationMode = System.Drawing.Drawing2D.InterpolationMode.HighQualityBicubic;
gr.PixelOffsetMode = System.Drawing.Drawing2D.PixelOffsetMode.HighQuality; 
```

存档更好的质量，并仔细检查您使用的字体在两个系统上是否相同。

# intellij-idea - 在 intellij 中重新附加源？

> ID：13144468
> 
> 赞同：22
> 
> 时间：2012-10-30T17:27:17.317
> 
> 标签：intellij-idea

我希望调试到 jaxb-impl 的源代码。

我下载了 2.2.6 版，附上了源代码，然后意识到我正在调试的应用程序使用的是 jaxb-impl 2.2.3 版

所以现在我有了正确的 2.2.3 版本的源，我不知道如何从 2.2.6 源中删除关联，以便我可以附加 2.2.3？

更新：我发现你可以进入 .idea 目录，找到库 xml def 并删除`<sources>`标签内的所有内容。就我而言，我编辑了 `libraries/Maven__com_sun_xml_bind_jaxb_impl_2_2_3_1.xml`.

任何人都知道是否有办法通过 GUI 做到这一点？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-10-30T17:42:23.747

`Project Structure`| `Libraries`（或者如果在那里定义了库，则为[模块依赖项）：](http://www.jetbrains.com/idea/webhelp/configuring-module-dependencies-and-libraries.html)

![来源](../Images/932a5f4a02402abccb918899c20f6a4c.png)

如果 Maven 正在管理依赖项，`Download Sources`则`Maven Projects`应该也可以工作：

![下载](../Images/42717f80b5e8bed4173c6c823b5b765d.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-18T06:05:46.457

`Project Structure` | `Libraries` (or [Module Dependencies](http://www.jetbrains.com/idea/webhelp/configuring-module-dependencies-and-libraries.html) if libraries are defined there):

![Project Structure](../Images/56210099f49a36d5f364c58d39b638a0.png)

Then in the libries tab click on the plus mark:

![Libraries](../Images/12144b72d73bbad6010e607384bf1793.png)

Select the source type.

![Add source](../Images/645939371ab0377d7ec1c4aa52f45eff.png)

Then you have to select the source path and add the wanted libraries finally click apply!

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-08-18T21:14:53.383

另一个（非 GUI）选项是从 $USER_HOME$/.ideaLibSources/ 中删除下载的源文件并重新启动 IntelliJ。我正在开发一个 Grails 项目，但在 GUI 中没有看到任何相关内容。

# html - CSS - 所有四个边缘的切角

> ID：13144470
> 
> 赞同：2
> 
> 时间：2012-10-30T17:27:26.037
> 
> 标签：html, css

如何在所有四个边缘上切角？是否可以使用 css 来完成，或者最好使用 png 图像来完成？

HTML 代码：

```
<nav class="meni container grid_3 omega">
               <ul>
                   <a href="#"><li role=pocetna>Početna</li></a>
                   <a href="galerija.html" role=galerija class="meni_aktivan_link"><li>Galerija</li></a>
                   <a href="#" role=projekti><li>Projekti</li></a>
                   <a href="#" role=nama><li>O nama</li></a>
                   <a href="#" role=kontakt><li>Kontakt</li></a>
               </ul>
           </nav>​ 
```

CSS：

```
.meni {margin: 93px 0 0 0; text-align: left;background: gray; text-transform: uppercase;position: relative;}
.meni ul {padding: 0; margin: 0; }
.meni li {padding: 2px 0;color: black !important; padding:0 26px; }
.meni li[role=pocetna]:hover {background:#336699 !important }​ 
```

[代码（JSFidle 链接）](http://jsfiddle.net/gHU9T/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T08:42:19.410

# java - AsyncTask 与服务器连接

> ID：13144476
> 
> 赞同：1
> 
> 时间：2012-10-30T17:27:51.250
> 
> 标签：java, android

大家好我有这个问题，我不得不做一个 AsyncTask 因为从 IceCast 连接到服务错误 NetworkOnMainThreadException 然后当我阅读时我说你放了一个 AsyncTask 来解决问题，或者给予特权

```
StrictMode.ThreadPolicy policy = new StrictMode.ThreadPolicy.Builder().permitAll().build();
StrictMode.setThreadPolicy(policy); 
```

但在任何情况下都不起作用，它使我的应用程序崩溃，甚至没有告诉我任何错误，尽管 try-catch .. 你能给我解释一下吗？

提前感谢这里是代码：

```
import java.io.IOException; 
import java.net.URI;
import java.net.URISyntaxException;
import java.util.List;
import java.util.Timer;
import java.util.TimerTask;

import net.moraleboost.streamscraper.ScrapeException;
import net.moraleboost.streamscraper.Scraper;
import net.moraleboost.streamscraper.Stream;    
import net.moraleboost.streamscraper.scraper.IceCastScraper;
import android.content.Context;
import android.os.AsyncTask;
import android.os.Bundle;
import android.os.StrictMode;
import android.support.v4.app.Fragment;
import android.support.v4.app.FragmentActivity;
import android.support.v4.app.FragmentManager;
import android.support.v4.app.FragmentPagerAdapter;
import android.support.v4.view.ViewPager;
import android.view.LayoutInflater;
import android.view.Menu;
import android.view.MenuItem;
import android.view.MenuItem.OnMenuItemClickListener;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.ImageButton;
import android.widget.ProgressBar;
import android.widget.TextView;
import android.widget.Toast;

public class SwipeyTabsSampleActivity extends FragmentActivity {
    private Button streamButton;

    private ImageButton playButton;

    private TextView textStreamed;
    private TextView textSong;

    private boolean isPlaying;

    private StreamingMediaPlayer audioStreamer;

    private static final String [] TITLES = {
            "Live Stream",
            "Palinsesto",
            "Programmi",
            "Eventi",
    };

    private SwipeyTabs mTabs;
    private ViewPager mViewPager;

    @Override
    public void onCreate(Bundle savedInstanceState) {

            super.onCreate(savedInstanceState);

            setContentView(R.layout.activity_swipeytab);

            mViewPager = (ViewPager) findViewById(R.id.viewpager);
            mTabs = (SwipeyTabs) findViewById(R.id.swipeytabs);

            SwipeyTabsPagerAdapter adapter = new SwipeyTabsPagerAdapter(this,
                            getSupportFragmentManager());
            mViewPager.setAdapter(adapter);
            mTabs.setAdapter(adapter);
            mViewPager.setOnPageChangeListener(mTabs);
            mViewPager.setCurrentItem(0);

            Inizializza();

            new AsyncTaskProc().execute();

    }

    private void startStreamingAudio() {
            try { 
                    final ProgressBar progressBar = (ProgressBar) findViewById(R.id.progress_bar);
                    if ( audioStreamer != null) {
                            audioStreamer.interrupt();
                    }

                    audioStreamer = new StreamingMediaPlayer(this, textStreamed, playButton, streamButton,progressBar);
                    audioStreamer.startStreaming("http://r35798.ovh.net:8000/listen",1677, 214);
                    streamButton.setEnabled(false);
            } catch (IOException e) {                       
            }

    }
    private void Inizializza()
    {
            textStreamed = (TextView) findViewById(R.id.text_kb_streamed);
            streamButton = (Button) findViewById(R.id.button_stream);
            streamButton.setOnClickListener(new View.OnClickListener() {
                    public void onClick(View view) {
                            startStreamingAudio();
                    }});

            playButton = (ImageButton) findViewById(R.id.button_play);
            playButton.setEnabled(false);
            playButton.setOnClickListener(new View.OnClickListener() {
                    public void onClick(View view) {
                            if (audioStreamer.getMediaPlayer().isPlaying()) {
                                    audioStreamer.getMediaPlayer().pause();
                                    playButton.setImageResource(R.drawable.button_play);
                            } else {
                                    audioStreamer.getMediaPlayer().start();

                                    audioStreamer.startPlayProgressUpdater();
                                    playButton.setImageResource(R.drawable.button_pause);
                            }
                            isPlaying = !isPlaying;
                    }});
    }
    private class SwipeyTabsPagerAdapter extends FragmentPagerAdapter implements
    SwipeyTabsAdapter {

            private final Context mContext;

            public SwipeyTabsPagerAdapter(Context context, FragmentManager fm) {
                    super(fm);

                    this.mContext = context;
            }

            @Override
            public Fragment getItem(int position) {
                    return SwipeyTabFragment.newInstance(TITLES[position]);
            }

            @Override
            public int getCount() {
                    return TITLES.length;
            }

            public TextView getTab(final int position, SwipeyTabs root) {
                    TextView view = (TextView) LayoutInflater.from(mContext).inflate(
                                    R.layout.swipey_tab_indicator, root, false);
                    view.setText(TITLES[position]);
                    view.setOnClickListener(new OnClickListener() {
                            public void onClick(View v) {
                                    mViewPager.setCurrentItem(position);
                            }
                    });

                    return view;
            }

    }

    public void onPageScrollStateChanged(int arg0) {
            // TODO Auto-generated method stub

    }

    public void onPageScrolled(int arg0, float arg1, int arg2) {
            // TODO Auto-generated method stub

    }

    public void onPageSelected(int arg0) {
            // TODO Auto-generated method stub

    }
    //////////////////////////////////////

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
            menu.add("Uscita").setOnMenuItemClickListener(
                            new OnMenuItemClickListener() {
                                    public boolean onMenuItemClick(MenuItem item) {
                                            Toast.makeText(getApplicationContext(),
                                                            "Uscita Programma", Toast.LENGTH_SHORT).show();
                                            finish();
                                            System.exit(0);

                                            return true;
                                    }
                            });
            ;

            return true;
    }

    class AsyncTaskProc extends AsyncTask<Void, String, Void> {
            @Override
            protected Void doInBackground(Void... unused) {

                    List<Stream> streams=null;
                    Scraper scraper = new IceCastScraper();

                    StrictMode.ThreadPolicy policy = new StrictMode.ThreadPolicy.Builder().permitAll().build();
                    StrictMode.setThreadPolicy(policy);

                    try {
                            streams = scraper.scrape(new URI("@@@@@@"));
                    } catch (ScrapeException e) {
                            // TODO Auto-generated catch block
                            e.printStackTrace();
                            //Toast.makeText(getApplicationContext(),e.toString(), Toast.LENGTH_LONG).show();
                    } catch (URISyntaxException e) {
                            // TODO Auto-generated catch block
                            e.printStackTrace();
                            //Toast.makeText(getApplicationContext(),e.toString(), Toast.LENGTH_LONG).show();
                    }

                    textSong =(TextView) findViewById(R.id.textViewCurrentSong);

                    try {
                            for (Stream stream: streams) {

                                    textSong.setText((stream.getCurrentSong()));
                            }
                    } catch (Exception e) {
                            //Toast.makeText(getApplicationContext(),e.toString(), Toast.LENGTH_SHORT).show();

                    }

                    return (null);
            }

    }
} 
```

编辑：我在 OnPostExecute() 中移动 Ui 现在这是新的 logcat

```
010-30 21:22:03.535: E/Trace(4973): error opening trace file: No such file or directory (2)
10-30 21:22:05.145: E/AndroidRuntime(4973): FATAL EXCEPTION: AsyncTask #1
10-30 21:22:05.145: E/AndroidRuntime(4973): java.lang.RuntimeException: An error occured while executing doInBackground()
10-30 21:22:05.145: E/AndroidRuntime(4973):     at android.os.AsyncTask$3.done(AsyncTask.java:299)
10-30 21:22:05.145: E/AndroidRuntime(4973):     at java.util.concurrent.FutureTask$Sync.innerSetException(FutureTask.java:273)
10-30 21:22:05.145: E/AndroidRuntime(4973):     at java.util.concurrent.FutureTask.setException(FutureTask.java:124)
10-30 21:22:05.145: E/AndroidRuntime(4973):     at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:307)
10-30 21:22:05.145: E/AndroidRuntime(4973):     at java.util.concurrent.FutureTask.run(FutureTask.java:137)
10-30 21:22:05.145: E/AndroidRuntime(4973):     at android.os.AsyncTask$SerialExecutor$1.run(AsyncTask.java:230)
10-30 21:22:05.145: E/AndroidRuntime(4973):     at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1076)
10-30 21:22:05.145: E/AndroidRuntime(4973):     at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:569)
10-30 21:22:05.145: E/AndroidRuntime(4973):     at java.lang.Thread.run(Thread.java:856)
10-30 21:22:05.145: E/AndroidRuntime(4973): Caused by: java.lang.Error: Unresolved compilation problem: 
10-30 21:22:05.145: E/AndroidRuntime(4973):     org.apache.commons.logging.LogFactory cannot be resolved to a type
10-30 21:22:05.145: E/AndroidRuntime(4973):     at net.htmlparser.jericho.LoggerFactory.determineDefaultLoggerProvider(LoggerFactory.java:51)
10-30 21:22:05.145: E/AndroidRuntime(4973):     at net.htmlparser.jericho.LoggerFactory.getDefaultLoggerProvider(LoggerFactory.java:39)
10-30 21:22:05.145: E/AndroidRuntime(4973):     at net.htmlparser.jericho.LoggerFactory.getLoggerProvider(LoggerFactory.java:35)
10-30 21:22:05.145: E/AndroidRuntime(4973):     at net.htmlparser.jericho.LoggerFactory.getLogger(LoggerFactory.java:27)
10-30 21:22:05.145: E/AndroidRuntime(4973):     at net.htmlparser.jericho.Source.newLogger(Source.java:1645)
10-30 21:22:05.145: E/AndroidRuntime(4973):     at net.htmlparser.jericho.Source.<init>(Source.java:109)
10-30 21:22:05.145: E/AndroidRuntime(4973):     at net.moraleboost.streamscraper.parser.IceCastParser.parse(IceCastParser.java:67)
10-30 21:22:05.145: E/AndroidRuntime(4973):     at net.moraleboost.streamscraper.scraper.IceCastScraper.scrape(IceCastScraper.java:65)
10-30 21:22:05.145: E/AndroidRuntime(4973):     at com.uniradio.cesena.app.SwipeyTabsSampleActivity$AsyncTaskProc.doInBackground(SwipeyTabsSampleActivity.java:264)
10-30 21:22:05.145: E/AndroidRuntime(4973):     at com.uniradio.cesena.app.SwipeyTabsSampleActivity$AsyncTaskProc.doInBackground(SwipeyTabsSampleActivity.java:1)
10-30 21:22:05.145: E/AndroidRuntime(4973):     at android.os.AsyncTask$2.call(AsyncTask.java:287)
10-30 21:22:05.145: E/AndroidRuntime(4973):     at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:305)
10-30 21:22:05.145: E/AndroidRuntime(4973):     ... 5 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T17:31:58.123

你没有提供你的 logcat 错误，所以我猜，但我认为问题如下。

您正在尝试从内部操作 UI，`doInBackground`这将导致您的应用程序崩溃。将您`AsyncTask`必须执行的 UI 更改移动到`onPostExecute`

例如：

```
textSong.setText((stream.getCurrentSong())); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T17:51:54.260

**-**保持`UI work on UI thread`和`Non-UI work on Non-UI`线程是一个很好的做法，但从`HoneyComb`Android 版本的到来这成为了一个法律。

**-** Android 应用程序在主线程`DUI`（专用 UI​​ 线程）上启动。

**-**您应该在非 UI 线程上保持非 UI 处理器密集型工作。

**-**使用`Thread`with`Handler`来完成，或使用特制的，在 Android`AsyncTask`中也称为**PainLess 线程。**

**现在你的问题是：**

**-** `doInBackground()`是**用于处理非 UI 部分**的方法，您正在执行`textSong.setText((stream.getCurrentSong()));`它本身。**这是您的应用程序崩溃的主要原因。**

**-**使用`onPostExecute()`方法来做**UI 工作**，所以在这个方法中保留**Text 的设置。**

# yii - Yii Cgridview 刷新时擦除 JS

> ID：13144477
> 
> 赞同：0
> 
> 时间：2012-10-30T17:27:59.237
> 
> 标签：yii

我在我的 GridView 中使用 bootstrap 和[Bootstrap Editable 扩展来快速编辑数据。](http://vitalets.github.com/bootstrap-editable/)太棒了，但是当我以某种方式使用 AJAX 刷新我的 gridview 时（例如应用一些 fiter 或删除一行），它会从页面中消失，如果我想再次就地编辑，我必须手动刷新页面 (F5)。这就是我在 views/admin.php 文件中应用可编辑插件的方式：

```
 Yii::app()->clientScript->registerScriptFile(
    Yii::app()->assetManager->publish(
        Yii::getPathOfAlias('ext.editable.assets.js').'/bootstrap-editable.min.js'
    ),
    CClientScript::POS_HEAD
); 
Yii::app()->clientScript->registerCssFile(
    Yii::app()->assetManager->publish(
        Yii::getPathOfAlias('ext.editable.assets.css').'/bootstrap-editable.css'
    ),
    CClientScript::POS_HEAD
); 
Yii::app()->clientScript->registerScript('editable', '$(".editable").editable();', CClientScript::POS_END); 
Yii::app()->clientScript->registerCss('popover', '.popover{width: 600px !important;} .editable-popover{width: auto !important;}', CClientScript::POS_HEAD); 
```

这有点乱，但我只是想让它工作。

感谢任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T20:02:50.343

尝试查看[http://www.yiiframework.com/doc/api/1.1/CGridView#afterAjaxUpdate-detail](http://www.yiiframework.com/doc/api/1.1/CGridView#afterAjaxUpdate-detail)

IE。

> 'afterAjaxUpdate' => 'function() { $(".editable").editable(); }'

# jquery - 当元素在上面延迟加载时，将注意力集中在元素上 - jquery scrollTop

> ID：13144478
> 
> 赞同：0
> 
> 时间：2012-10-30T17:28:04.257
> 
> 标签：jquery, lazy-loading, scrolltop

我们懒加载页面的几个元素。

但是，在顶部，我们对页面上的最后一个元素（UI 选项卡中的 iframe）进行了行动号召。CTA 使用`scrollTop`.

在我的点击功能中

`$('html,body').animate({scrollTop: $("#customerReviews").offset().top}, 700, "easeInOutSine");`

问题是当滚动被触发时，它也会在项目进入视口时触发延迟加载。因此，目标进入视野，然后在项目完成上面的延迟加载时被推出视野。

有什么好的方法可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T17:43:02.793

我会创建一个 isAnimating 布尔变量来跟踪您何时为页面设置动画。

在您的动画调用之前将 isAnimating 设置为 true，并在动画回调中将其设置回 false。

我不确定你是如何调用延迟加载的，但是当 isAnimating 设置为 true 时，你必须设置一些不运行的条件。

```
isAnimating = true;
$('html,body').animate({scrollTop: $("#customerReviews").offset().top}, 700, "easeInOutSine", function(){
      isAnimating = false;
}); 
```

# c# - 如何在 Windows 8 的桌面应用程序中访问 Metro 应用程序的本地存储？

> ID：13144479
> 
> 赞同：5
> 
> 时间：2012-10-30T17:28:04.617
> 
> 标签：c#, c++, .net, windows-8, microsoft-metro

.Net 中是否有可用的 API？在 Windows API 中呢？如果没有，有没有人想出一些骇人听闻的方法来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T17:05:04.820

查找 Windows 8 风格应用程序的本地存储文件夹

[http://blog.falafel.com/Blogs/paul-tidwell/2012/08/27/finding-the-local-storage-folder-of-a-windows-8-style-application](http://blog.falafel.com/Blogs/paul-tidwell/2012/08/27/finding-the-local-storage-folder-of-a-windows-8-style-application)

Windows 8 Style 应用的路径如下：

`C:\Users\{username}\AppData\Local\Packages\Microsoft.BingSports_8wekyb3d8bbwe`

有一个新的 Windows API，它使用内部和未公开的算法来创建发布者哈希，当附加到包名称时成为系列名称。姓氏看起来像`{packagename}_{publisherhash}`

如果您想要另一个桌面应用程序或需要在一组应用程序之间共享它，您可以通过 PowerShell cmdlet 调用 API，如下所示：

```
(Get-AppxPackage -AllUsers -Name  $name).PackageFamilyName 
```

将其写入注册表，瞧！您的应用程序可以使用 Environment.UserName 和上面的路径模式轻松找到您的 appx 本地存储。

# jquery - 如何在jquery中选择下一个元素

> ID：13144482
> 
> 赞同：0
> 
> 时间：2012-10-30T17:28:17.340
> 
> 标签：jquery, jquery-selectors

我有一个像下面这样的 html，问题是我想在这张图片之后找到/选择下一个 div 并切换它的可见性

```
<table>
<tr>
    <td>
        <img src="src" class="minmax" />
    </td>
</tr>
</table>
<div class="minmaxdiv">
    div contents
</div>

<table>
<tr>
    <td>
        <img src="src" class="minmax" />
    </td>
</tr>
</table>
<div class="minmaxdiv">
    div contents
</div> 
```

每个图像`class="minmax"`在单击后必须切换第一个 div 的可见性。

第一个 img 标签必须切换第一个 div，第二个必须切换第二个标签。

例如我试过`$(".minmax:first").parents("table:first").nextUntil("div.minmaxdiv")`但结果是空的 jquery 对象

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T17:31:15.037

试试这个：

```
$(".minmax").click(function() {
    $(this).closest("table").next(".minmaxdiv").toggle()
}); 
```

[**示例小提琴**](http://jsfiddle.net/cxeXP/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T17:32:45.837

虽然可能不是最优雅的解决方案，但您应该能够做到这一点：

```
$('.minmax').click(function()
{
    var index = $('.minmax').index(this);
    $('.minmaxdiv').eq(index).toggle();
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-30T17:31:32.917

试试这个

```
$(".minmax").click(function() {
    $(this).closest('table').next('.minmaxdiv').toggle();

}); 
```

或者

```
$(".minmax").click(function() {
     $(this).closest('table').nextAll('.minmaxdiv').first().toggle();

 }); 
```

[检查小提琴](http://jsfiddle.net/sushanth009/7YkdS/)

# java - 3分区的中位数

> ID：13144484
> 
> 赞同：3
> 
> 时间：2012-10-30T17:28:23.463
> 
> 标签：java, algorithm, sorting, quicksort

我找到了以下代码，用于使用第一个、最后一个和中间元素的中值查找快速排序的枢轴：

```
int middle = ( low + high ) / 2;
if( a[ middle ].compareTo( a[ low ] ) < 0 )
    swapReferences( a, low, middle );
if( a[ high ].compareTo( a[ low ] ) < 0 )
    swapReferences( a, low, high );
if( a[ high ].compareTo( a[ middle ] ) < 0 )
    swapReferences( a, middle, high );

// Place pivot at position high - 1
swapReferences( a, middle, high - 1 );
Comparable pivot = a[ high - 1 ]; 
```

我想知道找到中位数后，为什么交换是用索引 high-1 而不是 high 完成的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T14:10:35.287

原因是该算法不仅找到中位数，还对低、中、高元素进行排序。在三个排列之后，您知道 a[middle]<=a[high]。所以只需要对high之前的元素进行分区，因为a[high]大于等于pivot。

让我们看一个例子：low=0，middle=4，high=8。你的数组是这样的：

```
lowerOrEqualToPivot X X X pivot X X X greaterOrEqualToPivot 
```

如果将中间与高交换，则需要在括号之间划分 8 个元素：

```
[ lowerOrEqualToPivot X X X greaterOrEqualToPivot X X X ] pivot 
```

如果将 middle 与 high-1 交换，则只需要拆分 7 个元素：

```
[ lowerOrEqualToPivot X X X X X X ] pivot greaterOrEqualToPivot 
```

顺便说一句，第一行有一个错误：

```
int middle = ( low + high ) / 2; //Wrong
int middle = ( low + high ) >>> 1; //Correct 
```

原因是如果 (low + high) 大于 Integer.MAX_VALUE 您将有溢出，而中间将是一个负数。第二行总是会给你一个积极的结果。

# drupal - Drupal 表单单选按钮第一个按钮没有索引

> ID：13144485
> 
> 赞同：0
> 
> 时间：2012-10-30T17:28:23.073
> 
> 标签：drupal, drupal-7, drupal-fapi, drupal-forms

我在 Drupal 7 中有一个从自定义函数生成单选按钮的表单。在提交时，我获取所选按钮的索引值并通过另一个自定义函数对其进行处理。我的问题是，如果选择了第一个单选按钮，则不会生成索引 ($form_state['values']['stores'])。我想我可以将第一个按钮硬编码为相应数组中的第一个结果，但我真的很想弄清楚为什么会这样。

这是我的代码：

形式：

```
hook_form {
   global $user;
   $user_fields = user_load($user->uid);
    $zipcode = $user_fields->zip_code['und']['0']['value'];
    $defaults = !empty($form_state['values']['zip_code']) ? $form_state['values']['zip_code'] : $zipcode;
    $storename = getmystorename($defaults);
    $form['zip_code'] = array(
      '#title' => t('Zip Code'),
      '#type' => 'textfield',
      '#required' => TRUE,
      '#default_value' => $defaults,
      '#ajax' => array(
    // #ajax has two required keys: callback and wrapper.
    // 'callback' is a function that will be called when this element changes.
    'callback' => 'settings_form_callback',
    'wrapper' => 'textfields',
      ),
      );
    if(count($storename) > 0) {
    $form['textfields'] = array( 
    '#prefix' => '<div id="textfields">',
    '#suffix' => '</div>',
    '#type' => 'fieldset' );
    $form['textfields']['stores'] = array(
    '#type' => 'radios',
    '#title' => t('Choose your store:'),
    '#options' => $storename,
    '#default_value' => $storename[0], );
    } else {
      $form['textfields']['incorrect'] = array(
    '#title' => t('Sorry, there are no stores available near you.'),
    '#type' => 'fieldset', );
    }
    $form['submit'] = array(
      '#type' => 'submit',
      '#value' => 'Submit',
      );
} 
```

提交：

```
hook_form_submit {
  $zipcode = $form_state['values']['zip_code'];
  //Check that results were given for the zip code
  if(!empty($form_state['values']['stores'])) {
     $linkposition = $form_state['values']['stores']; }
  //If results were given grab the store link
  //if(isset($linkposition)) {
  //querypath the array of the store name to grab link
  $mystorelinks = getmystorelink($zipcode);
  $storelink = $mystorelinks[$linkposition];
} 
```

生成的数组：

```
Array ( [0] => Store1 [1] => Store2 [2] => Store3 [3] => Store4 [4] => Store5 [5] => Store6 [6] => Store7 [7] => Store8 [8] => Store9 [9] => Store10 ) 

Array ( [0] => http://www.example.com/stores/store1.html [1] => http://www.example.com/stores/store2.html [2] => http://www.example.com/stores/store3.html [3] => http://www.example.com/stores/store4.html [4] => http://www.example.com/stores/store5.html [5] => http://www.example.com/stores/store6.html [6] => http://www.example.com/stores/store7.html [7] => http://www.example.com/stores/store8.html [8] => http://www.example.com/stores/store9.html [9] => http://www.example.com/stores/store10.html ) 
```

# pyqt - PyQt：tableview中的复选框委托

> ID：13144486
> 
> 赞同：1
> 
> 时间：2012-10-30T17:28:34.180
> 
> 标签：pyqt, pyqt4, qtableview, qitemdelegate

我已经能够在我的表格视图中使我的复选框可编辑。它们出现在我的表格视图中，但我对它们无能为力。就像没有正确设置标志一样。

```
class CheckBox(QtGui.QStyledItemDelegate):

    def __init__(self, parent = None):
        QtGui.QGraphicsWidget.__init__(self)

    def flags(self, index):
        return QtCore.Qt.ItemIsEditable | QtCore.Qt.ItemIsUserCheckable | Qt.ItemIsEnabled

    def paint (self, painter, option, index):

        item = QtGui.QTableWidgetItem()
        item.setFlags(QtCore.Qt.ItemIsUserCheckable | QtCore.Qt.ItemIsEnabled)

        # picks up data from database
        checked = index.model().data(index, Qt.EditRole).toBool()

        # Then draw the checkbox
        box = QtGui.QStyleOptionButton()

        box.palette = option.palette
        box.rect = option.rect
        box.state = QtGui.QStyle.State_Enabled

        if checked:
            box.state |= QtGui.QStyle.State_On
        else:
            box.state |= QtGui.QStyle.State_Off

        style = QtGui.QApplication.instance().style()
        style.drawControl(QtGui.QStyle.CE_CheckBox, box, painter)
        painter.restore() 
```

嗨，这是基于 Avaris 评论的审查代码，使用 checkrole 而不是委托。但我仍然可以解决问题。我无法勾选复选框，而是显示一个旋转框。它正在正确地从数据库中读取值（0 或 1），但我想隐藏这个值。任何帮助，将不胜感激！

![在此处输入图像描述](../Images/685cd78d931b85593539f608d1141a78.png)

```
class EditableShoSqlModel(QtSql.QSqlQueryModel):
    def __init__(self, parent=None):
        super(EditableShoSqlModel, self).__init__(parent)

    def flags(self, index):
        flags = super(EditableShoSqlModel, self).flags(index)
        if index.column() in (12):
            flags |= QtCore.Qt.ItemIsEditable | QtCore.Qt.ItemIsUserCheckable | Qt.ItemIsEnabled
        return flags

    def data(self, index, role=QtCore.Qt.DisplayRole):
        value2 = super(EditableShoSqlModel, self).data(index)
        if index.column() == 12 and role == QtCore.Qt.CheckStateRole:
            if value2 != 0:
                return QtCore.Qt.Checked
            else:
                return QtCore.Qt.Unchecked
        return QtSql.QSqlQueryModel.data(self, index, role)

    def setData(self, index, value, role):
        if index.column() not in (12):
            return False

        primaryKeyIndex = self.index(index.row(), 0)
        id = self.data(primaryKeyIndex)
        #self.clear()

        if index.column() == 12 and role == QtCore.Qt.CheckStateRole:
            value2 = super(EditableShoSqlModel, self).data(index)
            if value2 != 0:
                ok = self.setAniStatus(id, value)
                return QtCore.Qt.Unchecked
            else:
                ok = self.setAniStatus(id, value)
                return QtCore.Qt.Checked
            return True
        self.refresh()
        return ok

    def refresh(self):
        MainWindow.AllShotsFromProject ()

    def setAniStatus(self, id, Number):
        mon = Number
        if mon != False:
           mon = 1
        else:
           mon = 0
        print "ANIS"            
        query = QtSql.QSqlQuery()
        sql = "UPDATE Shot SET Ani= '{0}' WHERE idShot = {1}".format(int(mon), id.toString())
        query.prepare(sql)
        print 'lastQuery:', query.lastQuery()
        return query.exec_() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T09:11:16.393

`if index.column() not in (12):`不管用。`(12)`是一样的`12`，你不能做`foo in 12`。那是一个`TypeError`。你*可以*做`foo in (12,)`，但没有必要。这很简单`foo == 12`。

`setData`应该返回`True`or`False`表示`success`，但您正在返回`QtCore.Qt.Unchecked`and `QtCore.Qt.Checked`。那不合适。

如果你不想显示`0/1`，你应该`data`通过简单地返回`None`for 来做到这一点`DisplayRole`。

这应该做你想要的：

```
class EditableShoSqlModel(QtSql.QSqlQueryModel):
    def __init__(self, parent=None):
        super(EditableShoSqlModel, self).__init__(parent)

    def flags(self, index):
        flags = super(EditableShoSqlModel, self).flags(index)
        if index.column() == 12:
            flags |= QtCore.Qt.ItemIsEditable | QtCore.Qt.ItemIsUserCheckable | QtCore.Qt.ItemIsEnabled
        return flags

    def data(self, index, role=QtCore.Qt.DisplayRole):
        if index.column() == 12:
            value = super(EditableShoSqlModel, self).data(index, QtCore.Qt.DisplayRole)
            if role == QtCore.Qt.CheckStateRole:
                if value != 0:
                    return QtCore.Qt.Checked
                else:
                    return QtCore.Qt.Unchecked
            else:
                return None

        return super(EditableShoSqlModel, self).data(index, role)

    def setData(self, index, value, role):
        if index.column() == 12 and role == QtCore.Qt.CheckStateRole:
            # `id` is a built-in function
            id_ = self.data(self.index(index.row(), 0)).toString()
            state, ok = value.toInt()
            if state == QtCore.Qt.Checked:
                value = 1
            else:
                value = 0
            result = self.setAniStatus(id_, value)
            if result:
                # we modified the db, we need to query again
                self.refresh()
            return result

        # I don't know what `refresh` does. But normally you don't need that
        return False

    def refresh(self):
        # something that re-queries the model.
        #self.setQuery('SELECT * FROM Shot')

    def setAniStatus(self, id_, value):          
        query = QtSql.QSqlQuery()
        sql = "UPDATE Shot SET Ani= {0} WHERE idShot = {1}".format(value, id_)
        query.prepare(sql)
        print 'lastQuery:', query.lastQuery()
        return query.exec_() 
```

# javascript - backbone-relational .set() method not updating related models

> ID：13144494
> 
> 赞同：5
> 
> 时间：2012-10-30T17:29:10.180
> 
> 标签：javascript, backbone.js, backbone-relational

I've got backbone-relational working fairly well so far. I have relationships and reverse relationships well established (see below). When I initially call `.fetch()` on my `Country` model instance, the `nominees` array is parsed out into `nominee` models perfectly.

When I call `.fetch()` again later, however, these related models do not update, even though the `nominee` data has changed (e.g. the vote count has incremented). Essentially it seems that Backbone's `.set()` method understands relationships initially but not subsequently.

**Country Model**

```
var Country = Backbone.RelationalModel.extend({

    baseUrl : config.service.url + '/country',

    url : function () {
        return this.baseUrl;
    },

    relations : [
        {
            type : Backbone.HasMany,
            key : 'nominees',
            relatedModel : Nominee,
            collectionType : Nominee_Collection,
            reverseRelation : {
                key : 'country',
                includeInJSON : false
            }
        }
    ]
}); 
```

**JSON Response on `country.fetch()`**

```
{
  "entrant_count" : 1234,
  "vote_count" : 1234,
  "nominees" : [
    {
      "id" : 3,
      "name" : "John Doe",
      "vote_count" : 1,
      "user_can_vote" : true
    },
    {
      "id" : 4,
      "name" : "Marty McFly",
      "vote_count" : 2,
      "user_can_vote" : true
    }
  ]
} 
```

Any help would be greatly appreciated, as always.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T18:04:46.450

So it appears that backbone-relational specifically forgoes updating relations automatically (see the `updateRelations` method), and simply emits a `relational:change:nominees` event which your models can target. If, however, you wish to programmatically update your related models, simply modify the `updateRelations` method as follows:

```
Backbone.RelationalModel.prototype.updateRelations = function( options ) {
    if ( this._isInitialized && !this.isLocked() ) {
        _.each( this._relations || [], function( rel ) {
            // Update from data in `rel.keySource` if set, or `rel.key` otherwise
            var val = this.attributes[ rel.keySource ] || this.attributes[ rel.key ];

            if ( rel.related !== val ) {
                this.trigger( 'relational:change:' + rel.key, this, val, options || {} );

                // automatically update related models
                _.each(val, function (data) {                           
                    var model = rel.related.get(data.id);
                    if (model) {
                        model.set(data);
                    } else {
                        rel.related.add(data);
                    }
                });
            }
        }, this );
    }
}; 
```

(Note that this does not handle deletion of models from a collection, only updates to existing models, and the addition of new models to a collection)

# javascript - 无法获取属性“innerHTML”的值：对象为空或未定义

> ID：13144496
> 
> 赞同：0
> 
> 时间：2012-10-30T17:29:22.160
> 
> 标签：javascript, html

我使用 flowplayer 来显示视频。它适用于 Firefox 和 chrome。但它在 iexplorer 中不起作用。给我的错误是：

SCRIPT5007：无法获取属性“innerHTML”的值：document.getElementById(src_row).innerHTML 的对象为 null 或未定义。“src_row”是有价值的，但innerHTML 是没有价值的。

函数附在下面。请帮助如何使用 ie 使其工作。谢谢

```
function copyRows(dest_row, src_row_id){
    var src_row = 'row' + src_row_id.toString(); 
    document.getElementById(dest_row).innerHTML = document.getElementById(src_row).innerHTML;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T17:35:08.380

您在通话中指的是`src_row`，`getElementById`但似乎您`ID`在调用它之前正在修改它。

```
var src_row = 'row' + src_row_id.toString(); 
document.getElementById(src_row) 
```

假设这样的电话：

```
copyRows( myRow, 'rowID' ); 
```

`getElementById(src_row)`将寻找带有`ID`of的元素`rowrowID`。

这是你的意图吗？将“行”附加到 ID 的开头？

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-30T17:39:15.187

```
function copyRows(dest_row, src_row_id){
    var src_row = 'row' + src_row_id.toString(); 
    console.log(src_row);
    document.getElementById(dest_row).innerHTML = document.getElementById(src_row).innerHTML;
} 
```

看看这是否为您提供了您正在寻找的字符串。

# pdf - 使用 iText 检测动态 XFA

> ID：13144500
> 
> 赞同：3
> 
> 时间：2012-10-30T17:29:33.830
> 
> 标签：pdf, itext, xfa

我需要将预先填充的 PDF/XFA 表单设为只读（因为没有输入，例如文本、复选框、单选按钮等可以更改其值）。

对于常规 AcroForms PDF 和静态 XFA 表单，我可以通过调用[`setFormFlattening(true)`](http://www.docjar.org/docs/api/com/lowagie/text/pdf/PdfStamper.html#setFormFlattening(boolean))PdfStamper 实例来完成此操作。对于动态 XFA 表单，我必须将`access`XDP`field`节点的属性设置为`readOnly`.

问题是，如何检测表单是否为**动态**XFA？ [`isXfaPresent`](http://www.docjar.org/docs/api/com/lowagie/text/pdf/XfaForm.html#isXfaPresent)不区分静态或动态 XFA 表单，因此没有用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T17:52:33.073

iText 像言论自由一样是免费的，而不是像免费啤酒那样免费。阅读[http://lowagie.com/bumodels](http://lowagie.com/bumodels)了解更多关于我们为避免从 MPL/LGPL 切换到 AGPL 而尝试的商业模式的信息。

**Q1：将动态 XFA 表单设为只读**

这对于最新版本的 iText 来说是显而易见的，但在您使用的过时版本中不受支持。请阅读[http://lowagie.com/itext2](http://lowagie.com/itext2)了解为什么您不应该使用 iText 4.2.0（据我所知，它甚至不是正式版本；我知道，因为我对所有单个 iText 版本）。也许您在谈论 iTextSharp。

**Q2：扁平化动态 XFA 表单**

如果你想扁平化一个动态 XFA 表单，你有两个选择：要么使用 Adob​​e LiveCycle ES（这将花费你一条胳膊和一条腿），或者使用 iText 的 XFA Worker（它是一种价格便宜得多的封闭源代码产品F/OSS iText 的）。考虑到该产品的成本和工时数，我认为您不会找到像免费啤酒那样免费的解决方案。我不知道任何这样的产品。

**Q3：如何判断一个 XFA 表单是否是动态的**

这在我的书“iText in Action - Second Edition”中有解释。你已经有了一半的解决方案。条件一：`isXfaPresent()`需要退货`true`。条件2：`getFields()`需要有一个空键集。请参阅`readFieldnames()`本例中的方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-02-06T22:32:51.090

要添加到布鲁诺的答案并提供 C# 示例代码：

```
PdfReader reader = new PdfReader(filePath);
XfaForm xfa = new XfaForm(reader);

//Check if PDF file contains Dynamic XFA data
if (xfa != null && xfa.XfaPresent && xfa.Reader.AcroFields.Fields.Keys.Count == 0)
{
   MessageBox.Show("This PDF contains Dynamic XFA data.");
} 
```

# java - 是否有一种可移植的方式来找出 JVM 从 VM 内部打开了多少文件？

> ID：13144502
> 
> 赞同：8
> 
> 时间：2012-10-30T17:29:40.523
> 
> 标签：java, unit-testing, junit, jvm

我正在为一些 Java 文件处理代码编写测试，并希望确保所有文件都正确关闭。我不想运行“lsof”，因为这会打开更多文件并使测试套件不可移植。有人知道这样做的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T18:20:48.417

如果您正在寻找 JDK 的一部分，答案是否定的。

您可能会发现一些使用[JVMTI](http://docs.oracle.com/javase/6/docs/platform/jvmti/jvmti.html)的东西，但它是不可移植的（它是本机接口）。或者使用[JPDA](http://docs.oracle.com/javase/6/docs/technotes/guides/jpda/index.html)的东西，但这需要第二个 JVM。我给你这两个首字母缩写词作为谷歌搜索的开始。

如果您想在 JVM 中运行并具有可移植性，则必须为您的文件引用引入一个工厂：将所有`new FileInputStream()`、`new FileOutputStream()`、`new RandomAccessFile()`、`new FileReader`和`new FileWriter`调用替换为该工厂对象上的方法。该工厂将返回这些对象的子类，这些对象的`close()`方法已被覆盖。它还将增加一个“打开文件”计数器，然后由覆盖的`close()`.

工厂方法和计数器需要是静态和同步的（除非您想注入工厂），并且应该使用系统属性来决定是返回子类流还是返回 JDK 版本。

就个人而言，我会接受评论中的建议，并首先使用 FindBugs。

# nhibernate - NHibernate 查询缓存过期

> ID：13144504
> 
> 赞同：4
> 
> 时间：2012-10-30T17:29:51.647
> 
> 标签：nhibernate, query-cache

是否可以配置 NHibernate 的查询缓存过期？

对于二级缓存，我可以从 中进行`nhibernate.cfg.xml`，但我找不到 SQL 查询缓存的方法。

**编辑：**

```
ICriteria query = CreateCriteria()
                  .Add(Expression.Eq("Email", identifiant))
                  .SetCacheable(true)
                  .SetCacheRegion("X");

 <syscache>
    <cache region="X" expiration="10" priority="1" />
  </syscache> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-30T18:42:21.083

是的，我们可以通过区域设置缓存过期。像这样调整查询：

```
criteria.SetCacheable(true)
    .SetCacheMode(CacheMode.Normal)
    .SetCacheRegion("LongTerm"); 
```

并将类似的配置放入 web.config 文件中

```
<configSections>
    <section name="syscache" type="NHibernate.Caches.SysCache.SysCacheSectionHandler, NHibernate.Caches.SysCache" requirePermission="false" />
</configSections>
<syscache>
    <cache region="LongTerm" expiration="180" priority="5" />
    <cache region="ShortTerm" expiration="60" priority="3" />
</syscache> 
```

**编辑**：我只是添加这个链接[Class-cache not used when getting entity by criteria](https://stackoverflow.com/questions/13073956/) 确定我所说的*SQL Query cache*是什么意思。在链接的答案中，我正在解释该主题

只是为了清楚。NHibernate“会话工厂”的配置必须包含：

```
<property name="cache.use_query_cache">true</property> 
```

此开关将使查询缓存工作。更多细节： http: [//nhibernate.info/doc/nh/en/index.html#performance-querycache](http://nhibernate.info/doc/nh/en/index.html#performance-querycache)

# android - Android应用程序在phonegap中读取设备信息

> ID：13144506
> 
> 赞同：0
> 
> 时间：2012-10-30T17:29:57.830
> 
> 标签：android, cordova, android-permissions

如何获取下面的这些项目以从设备中读取该数据并在下面的 html 页面中显示？

```
 $('#devicename').html(device.name);
  $('#devicephonegap').html(device.phonegap);
  $('#devicplatform').html(device.platform);
  $('#deviceuuid').html(device.uuid);
  $('#deviceversion').html(device.version); 
```

整页代码

```
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="format-detection" content="telephone=no" />
<meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
<link rel="stylesheet" type="text/css" href="jquery.mobile-1.2.0.css" />
<script type="text/javascript" src="jquery-1.8.2.js"></script>
<script type="text/javascript" src="jquery.mobile-1.2.0.js"></script>
<script type="text/javascript">

    $(document).on("pageinit", "#newpage", function () {
        $('#saveButton').click(function () {
            localStorage.setItem("name", $('#name').val());
        });

    });
    var wID = navigator.accelerometer.watchAcceleration(onSucess, onerror, { frequency: 1000 });
    function onSucess(a) {
        $('#aX').html(a.x);
        $('#aY').html(a.y);
        $('#aZ').html(a.z);
        $('#aTime').html(a.timestamp);
    }
    function onError() {

    }
var phoneName = window.device.name;
var phoneName = device.name;
        $('#devicename').html(device.name);
        $('#devicephonegap').html(device.phonegap);
        $('#devicplatform').html(device.platform);
        $('#deviceuuid').html(device.uuid);
        $('#deviceversion').html(device.version);

    $(document).on('pageshow', '#newpage', function () {
        var personName = localStorage.getItem("name");
        if (personName.length > 0) {
            $('#name').val(personName);
        }
    });
</script>
<title>Hello World 2</title>
</head>
<body>
<div id="home" data-role="page">
    <div data-role="header">
        <h1>Home Page2</h1>
    </div>
    <div data-role="content">
        hello Phone Gap and JQuery Mobile! 
        <a href="#newpage" data-role="button">new page</a>
        <br>
        <p id="devicename">  </p>
        <p id="devicephonegap">  </p>
        <p id="deviceplatform">  </p>
        <p id="deviceuuid">  </p>
        <p id="deviceversion">  </p>
         <p id="ax">  </p>
        <p id="ay">  </p>
        <p id="az">  </p>
        <p id="aTime">  </p>
    </div>
    <div data-role="footer" data-position="fixed">
    <a href="#dialogpage" data-rel="dialog" data-icon="plus">Add Something</a>

    </div>
</div>

<div id="newpage" data-role="page">
    <div data-role="header">
    <a href="#home" data-icon="delete">Cancel</a>
        <h1>New Page</h1>
        <a href=#home" data-icon="save">save</a>
    </div>
    <div data-role="content">
        <label for="name">what is your name?</label>
        <input id="name" type="text" name="name" value="" />
        <a id="saveButton" href="" data-role="button">Save</a>
    </div>
    <div data-role="footer" data-position="fixed">
        <h4>
            footer</h4>
    </div>
</div>

<div id="dialogpage" data-role="page"> 
 <div data-role="header">
        <h1>Dialog</h1>
    </div>
     <div data-role="content">
        this is a dialog
     </div>
</div>
<script type="text/javascript" src="cordova-2.1.0.js"></script>
<script type="text/javascript" src="js/index.js"></script>
<script type="text/javascript">
    app.initialize();
</script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T17:44:00.277

**-**您需要为您的文件添加`READ_PHONE_STATE` **权限。**`AndroidManifest.xml`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T17:33:26.840

您需要包含设备插件并请求 Android READ_PHONE_STATE 权限。这清楚地记录在：

[http://docs.phonegap.com/en/2.1.0/cordova_device_device.md.html#Device_permissions](http://docs.phonegap.com/en/2.1.0/cordova_device_device.md.html#Device_permissions)

# python - Numpy Matrix 类：继承类的默认构造函数属性

> ID：13144512
> 
> 赞同：6
> 
> 时间：2012-10-30T17:30:33.010
> 
> 标签：python, inheritance, constructor, numpy, init

我想实现我自己的矩阵类，它继承自 numpy 的矩阵类。

numpy 的矩阵构造函数需要一个属性，例如`("1 2; 3 4'")`. 相反，我的构造函数应该不需要属性，并且应该为超级构造函数设置一个默认属性。

这就是我所做的：

```
import numpy as np

class MyMatrix(np.matrix):
    def __init__(self):
        super(MyMatrix, self).__init__("1 2; 3 4")

if __name__ == "__main__":
    matrix = MyMatrix() 
```

这段代码一定有一个愚蠢的错误，因为我不断收到这个错误：

```
this_matrix = np.matrix()
TypeError: __new__() takes at least 2 arguments (1 given) 
```

我对此一无所知，到目前为止，谷歌搜索也没有帮助。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-30T17:45:41.087

好问题！

从查看源代码来看，似乎`np.matrix`将`data`论点设置为 in [`__new__`](http://docs.python.org/2/reference/datamodel.html#object.__new__)，而不是 in `__init__`。这是违反直觉的行为，尽管我确信这是有充分理由的。

无论如何，以下对我有用：

```
class MyMatrix(np.matrix):
    def __new__(cls):
        # note that we have to send cls to super's __new__, even though we gave it to super already.
        # I think this is because __new__ is technically a staticmethod even though it should be a classmethod
        return super(MyMatrix, cls).__new__(cls, "1 2; 3 4")

mat = MyMatrix()

print mat
# outputs [[1 2] [3 4]] 
```

* * *

附录：您可能需要考虑使用工厂函数而不是子类来实现您想要的行为。这将为您提供以下代码，它更短更清晰，并且不依赖于`__new__`-vs-`__init__`实现细节：

```
def mymatrix():
    return np.matrix('1 2; 3 4')

mat = mymatrix()
print mat
# outputs [[1 2] [3 4]] 
```

当然，您可能出于其他原因需要子类。

# mpi - OpenMP and MPI hybrid program

> ID：13144520
> 
> 赞同：10
> 
> 时间：2012-10-30T17:30:58.267
> 
> 标签：mpi, openmp

I have a machine with 8 processors. I want to alternate using OpenMP and MPI on my code like this:

**OpenMP phase:**

*   ranks 1-7 wait on a MPI_Barrier
*   rank 0 uses all 8 processors with OpenMP

**MPI phase:**

*   rank 0 reaches barrier and all ranks use one processor each

So far, I've done:

*   set I_MPI_WAIT_MODE 1 so that ranks 1-7 don't use the CPU while on the barrier.
*   set omp_set_num_threads(8) on rank 0 so that it launches 8 OpenMP threads.

It all worked. Rank 0 did launch 8 threads, but all are confined to one processor. On the OpenMP phase I get 8 threads from rank 0 running on one processor and all other processors are idle.

How do I tell MPI to allow rank 0 to use the other processors? I am using Intel MPI, but could switch to OpenMPI or MPICH if needed.

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-30T18:14:11.957

The following code shows an example on how to save the CPU affinity mask before the OpenMP part, alter it to allow all CPUs for the duration of the parallel region and then restore the previous CPU affinity mask. The code is Linux specific and it makes no sense if you do not enable process pinning by the MPI library - *activated* by passing `--bind-to-core` or `--bind-to-socket` to `mpiexec` in Open MPI; *deactivated* by setting `I_MPI_PIN` to `disable` in Intel MPI (the default on 4.x is to pin processes).

```
#define _GNU_SOURCE

#include <sched.h>

...

cpu_set_t *oldmask, *mask;
size_t size;
int nrcpus = 256; // 256 cores should be more than enough
int i;

// Save the old affinity mask
oldmask = CPU_ALLOC(nrcpus);
size = CPU_ALLOC_SIZE(nrcpus);
CPU_ZERO_S(size, oldmask);
if (sched_getaffinity(0, size, oldmask) == -1) { error }

// Temporary allow running on all processors
mask = CPU_ALLOC(nrcpus);
for (i = 0; i < nrcpus; i++)
   CPU_SET_S(i, size, mask);
if (sched_setaffinity(0, size, mask) == -1) { error }

#pragma omp parallel
{
}

CPU_FREE(mask);

// Restore the saved affinity mask
if (sched_setaffinity(0, size, oldmask) == -1) { error }

CPU_FREE(oldmask);

... 
```

You can also tweak the pinning arguments of the OpenMP run-time. For `GCC/libgomp` the affinity is controlled by the [GOMP_CPU_AFFINITY](http://gcc.gnu.org/onlinedocs/libgomp/GOMP_005fCPU_005fAFFINITY.html) environment variable, while for Intel compilers it is [KMP_AFFINITY](http://software.intel.com/sites/products/documentation/studio/composer/en-us/2011Update/compiler_c/optaps/common/optaps_openmp_thread_affinity.htm). You can still use the code above if the OpenMP run-time intersects the supplied affinity mask with that of the process.

Just for the sake of completeness - saving, setting and restoring the affinity mask on Windows:

```
#include <windows.h>

...

HANDLE hCurrentProc, hDupCurrentProc;
DWORD_PTR dwpSysAffinityMask, dwpProcAffinityMask;

// Obtain a usable handle of the current process
hCurrentProc = GetCurrentProcess();
DuplicateHandle(hCurrentProc, hCurrentProc, hCurrentProc,
                &hDupCurrentProc, 0, FALSE, DUPLICATE_SAME_ACCESS);

// Get the old affinity mask
GetProcessAffinityMask(hDupCurrentProc,
                       &dwpProcAffinityMask, &dwpSysAffinityMask);

// Temporary allow running on all CPUs in the system affinity mask
SetProcessAffinityMask(hDupCurrentProc, &dwpSysAffinityMask);

#pragma omp parallel
{
}

// Restore the old affinity mask
SetProcessAffinityMask(hDupCurrentProc, &dwpProcAffinityMask);

CloseHandle(hDupCurrentProc);

... 
```

Should work with a single processor group (up to 64 logical processors).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-01T18:42:44.627

Thanks all for the comments and answers. You are all right. It's all about the "PIN" option.

To solve my problem, I just had to:

I_MPI_WAIT_MODE=1

I_MPI_PIN_DOMAIN=omp

Simple as that. Now all processors are available to all ranks.

The option

I_MPI_DEBUG=4

shows which processors each rank gets.

# java - 用Java发送帖子

> ID：13144524
> 
> 赞同：0
> 
> 时间：2012-10-30T17:31:14.423
> 
> 标签：java, parsing

当我登录网页然后解析 html 时，我有一个 bash 脚本。我使用的命令是 wget：

```
wget --save-cookies=cookies.txt --post-data "uid=USER&pass=PWD" http://www.spanishtracker.com/login.php

wget --load-cookies=cookies.txt "http://www.spanishtracker.com/torrents.php"  -O OUTPUT 
```

现在，我正在尝试用 Java 制作这些。首先，我正在尝试发布请求，但是当我执行输出时，我登录时并没有给出。这些是Java的代码：

```
try {
        data = URLEncoder.encode("uid", "UTF-8") + "=" + URLEncoder.encode("USER", "UTF-8");
        data += "&" + URLEncoder.encode("pass", "UTF-8") + "=" + URLEncoder.encode("PASS", "UTF-8");

                // Send the request
                URL url = new URL("http://www.spanishtracker.com/index.php");
                URLConnection conn = url.openConnection();

                conn.setDoOutput(true);

                OutputStreamWriter writer = new OutputStreamWriter(conn.getOutputStream());

                //write parameters
                writer.write(data);
                writer.flush();

                // Get the response
                StringBuffer answer = new StringBuffer();
                BufferedReader reader = new BufferedReader(new InputStreamReader(conn.getInputStream()));
                String line;
                while ((line = reader.readLine()) != null) {
                    answer.append(line);
                }
                writer.close();
                reader.close();
                // temporary to build request cookie header
                StringBuilder sb = new StringBuilder();

                // find the cookies in the response header from the first request
                List<String> cookies = conn.getHeaderFields().get("Set-Cookie");
                if (cookies != null) {
                    System.out.println("Hay cookies para guardar");
                    for (String cookie : cookies) {
                        if (sb.length() > 0) {
                            sb.append("; ");
                        }

                        // only want the first part of the cookie header that has the value
                        String value = cookie.split(";")[0];
                        sb.append(value);
                    }
                } 
```

请问你能帮帮我吗。非常感谢和对不起我的英语！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T17:48:42.947

使用 apache HttpClient 库[链接](http://hc.apache.org/httpclient-3.x/methods/post.html)

# python - python：从url保存图像时出错

> ID：13144528
> 
> 赞同：2
> 
> 时间：2012-10-30T17:31:22.303
> 
> 标签：python, django, image, jpeg, python-imaging-library

我需要使用 Django 从 url 保存图像。所以我确实像教程所说的那样，但我得到了一个奇怪的错误。

```
page = requests.get(url)
if page.status_code != 200 or not page.content:
assert 0, 'can\'t download article image'
image = image_content_file(page.content)
article.image.save('%i.jpg' % article.pk, image, save=False) 
```

我的文章模型：

```
class Article(models.Model):
   title = models.CharField(max_length=255)
   content = models.TextField(blank=True)
   image = models.ImageField(blank=True, upload_to='upload/article_image')
   date_created = models.DateTimeField(null=True, blank=True, db_index=True) 
```

我创建了`upload/article_image`文件夹并将其权限设置为 777

我的`image_content_file`功能：

```
def image_content_file(img_content):
    input_file = StringIO(img_content)
    output_file = StringIO()
    img = Image.open(input_file)
    if img.mode != "RGB":
        img = img.convert("RGB")
    img.save(output_file, "JPEG")
    return ContentFile(output_file.getvalue()) 
```

但我得到这个错误

```
image = image_content_file(page.content)
  File "/home/yital9/webservers/binarybits/binarybits/../binarybits/utils/img.py", line 24, in image_content_file
    img.save(output_file, "JPEG")
  File "/usr/local/lib/python2.7/dist-packages/PIL/Image.py", line 1439, in save
    save_handler(self, fp, filename)
  File "/usr/local/lib/python2.7/dist-packages/PIL/JpegImagePlugin.py", line 471, in _save
    ImageFile._save(im, fp, [("jpeg", (0,0)+im.size, 0, rawmode)])
  File "/usr/local/lib/python2.7/dist-packages/PIL/ImageFile.py", line 481, in _save
    e = Image._getencoder(im.mode, e, a, im.encoderconfig)
  File "/usr/local/lib/python2.7/dist-packages/PIL/Image.py", line 399, in _getencoder
    return apply(encoder, (mode,) + args + extra)
TypeError: function takes at most 9 arguments (11 given) 
```

你能给我任何建议是什么问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T17:35:59.333

这段代码应该做你需要的：

```
import urllib2
from django.core.files.base import ContentFile

content = ContentFile(urllib2.urlopen(url).read())
article.image.save('%i.jpg' % article.pk, content, save=True) 
```

相反，如果您只想从网上下载图像，最好这样做：

```
from urllib import urlretrieve
urlretrieve(url, '%i.jpg' % article.pk) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-01-28T12:39:25.000

要使其在 Python 3 中工作，您必须使用

```
urllib.request.urlretrieve(url=filepath) 
```

# c# - URL 的 LastModified 日期

> ID：13144529
> 
> 赞同：2
> 
> 时间：2012-10-30T17:31:25.197
> 
> 标签：c#, .net

我正在尝试获取 URL 的 LastModified 日期，但它总是返回今天（当前日期）。我检查了许多 URL，但结果是一样的。我尝试了 winform 和 web 应用程序。

这是我的代码。请帮我修复它。

```
 Uri myUri = new Uri(TextBox1.Text);

  // Creates an HttpWebRequest for the specified URL. 
  HttpWebRequest myHttpWebRequest = (HttpWebRequest)WebRequest.Create(myUri);
  HttpWebResponse myHttpWebResponse = (HttpWebResponse)myHttpWebRequest.GetResponse();

  if (myHttpWebResponse.StatusCode == HttpStatusCode.OK)
       Console.WriteLine("\r\nRequest succeeded and the requested information is in the response , Description : {0}", myHttpWebResponse.StatusDescription);

      DateTime today = DateTime.Now;

      // Uses the LastModified property to compare with today's date.         
      if (DateTime.Compare(today, myHttpWebResponse.LastModified) == 0)
           Console.WriteLine("\nThe requested URI entity was modified today");
      else
      {
           if (DateTime.Compare(today, myHttpWebResponse.LastModified) == 1)
               Console.WriteLine("\nThe requested URI was last modified on:{0}", myHttpWebResponse.LastModified);

          // Releases the resources of the response.
          myHttpWebResponse.Close(); 
      } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T20:36:11.563

根据[这个解释](http://kb.siteground.com/article/LastModified_HTTP_header_explained.html)：

> 如果您的网站使用纯 HTML 文件，“Last-Modified”只是 HTML 文件的时间戳。但是，如果您有从数据库中获取数据的动态页面，那么事情就有点复杂了。服务器不知道您是如何生成数据的，也不知道如何从上次加载数据时更改数据。

因此，从现在的大多数 Web 服务器来看，“上次修改”日期将是页面呈现的日期，因为 A）配置服务器以了解数据是否已更改是许多人不会做的额外工作, 和 B) 数据经常*发生*变化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-04T17:30:45.227

这是用于显示 html 和 shtml（服务器解析）的网页的 Last-Modified 日期/时间的解决方案。我还将包括一个 php 解决方案。让我们从 html 和 shtml 开始。对于大多数服务器，html 不是服务器解析的，因此当页面发送给您时，传输中包含一个 Last-Modified 变量。但是对于服务器解析的页面，例如 shtml，不会发送该变量。相反，页面设计者应该使用 SSI 语句来提供 Last-Modified 信息，该信息在页面发送之前由服务器处理。

以下是如何以支持 Javascript 的直接 html 或支持 SSI 的 shtml 的方式处理页面。

```
<p>Last modified:
<!--#config timefmt="%m/%d/%Y %T" --><!--#echo var="LAST_MODIFIED" -->
<script type="text/javascript" language="JavaScript">
<!--
if(Last-Modified !== undefined)
{
document.write(document.lastModified)
}
//-->
</script></p> 
```

“Last modified:”字符串无条件输出。然后，在服务器解析的情况下，注释使用#config timefmt AND #echo SSI-statments 提供日期/时间。但如果这不是服务器解析的，它仍然只是一个评论。同时，对于服务器解析，不会发送名为 Last-Modified 的变量，因此 Javascript 会测试 Last-Modified 是否未定义，并且仅在已定义时才执行某些操作，这不适用于服务器解析。注意：在评论中，不要在 !-- 之后留下空白，并且在 --> 之前不要留下空白。

现在是另一面：直接的 html，而不是服务器解析的。SSI 语句没有被执行，所以评论仍然只是一个评论。但是 Last-Modified 已定义，所以现在 JavaScript 开始行动并执行 document.write 以提供 document.lastModified 值。

您可以尝试格式化，但上面显示的是基本代码。

如果 Last-Modified !== undefined 的测试不起作用，那么您可以使用更长的方法：

```
<p>Last modified:
<!--#config timefmt="%m-%d-%Y %T" --><!--#echo var="LAST_MODIFIED" -->
<script language="JavaScript">
<!--
var mydate=new Date();
var year=mydate.getFullYear();
var month=mydate.getMonth()+1;
var day=mydate.getDate();
var hours=mydate.getHours();
var minutes=mydate.getMinutes();
var now='';
var testnow='';
var testlast=document.lastModified;
if (month<10) month="0"+month;
if (day<10) day="0"+day;
if (hours<10) hours="0"+hours;
if (minutes<10) minutes="0"+minutes;
now=(month + '/' + day + '/' + year + ' ' + hours + ':' + minutes + ':');
testnow=(now.substring(6,10)+now.substring(0,16));
testlast=(testlast.substring(6,10)+testlast.substring(0,16));
  if (testlast && (testlast < testnow))
  { document.write(" "+document.lastModified); }
//-->
</script></p> 
```

此方法比较 current-date 和 document.lastModified 的截断版本。两个数量的格式必须相同，并且子字符串函数删除“秒”。当 document.lastModified 不存在时，大多数浏览器所做的就是替换当前日期。

现在对于php解决方案：

```
<p>Last modified:
<?php
date_default_timezone_set('America/Los_Angeles');
echo " " . date ("m/d/y.", filemtime(__FILE__));
?>
</p> 
```

您也可以在此处调整格式。事实上，您可能想要为您的服务器位置设置时区。网络搜索“支持时区的 php 列表”。

# php - 使用php创建excel表

> ID：13144530
> 
> 赞同：0
> 
> 时间：2012-10-30T17:31:29.377
> 
> 标签：php, excel, compiler-errors, echo

我在这个特定的行面临一个问题..

```
echo pack("ssssss", 0×809, 0×8, 0×0, 0×10, 0×0, 0×0); 
```

即将到来的错误是..

```
Parse error: syntax error, unexpected T_STRING in C:\wamp\www\amc\excel.php on line 20 
```

我不明白为什么会发生这种情况，因为它是回显 pack 函数的正确语法（我提到了[http://www.w3schools.com/php/func_misc_pack.asp](http://www.w3schools.com/php/func_misc_pack.asp)）

有人可以帮我吗.. PS：我在接下来的几行中遇到了同样的错误，当我尝试评论第 20 行时，我使用了相同的回显包代码，但错误完全相同。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T17:33:16.477

`0×809`这不是十六进制数字，它包含 unicode 字符`×`。您应该使用简单`x`的十六进制表示法。

或者只是使用可以为您标记此错误的良好 IDE。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T17:34:13.767

您拥有的角色是`&times`，它以这种方式显示：`×`！但是我们需要使用plain `x`（字符，在w 之后，y 之前）。

所以替换：

```
echo pack("ssssss", 0×809, 0×8, 0×0, 0×10, 0×0, 0×0); 
```

和：

```
echo pack("ssssss", 0x809, 0x8, 0x0, 0x10, 0x0, 0x0); 
```

它应该工作！`:)`

# python - 使用python解析来自js的多行注释

> ID：13144539
> 
> 赞同：2
> 
> 时间：2012-10-30T17:31:56.930
> 
> 标签：python, regex

我想使用 python 获取 js 文件中多行注释的内容。

我试过这个代码示例

```
import re
code_m = """
/* This is a comment. */
"""
code_s = "/* This is a comment*/"

reg = re.compile("/\*(?P<contents>.*)\*/", re.DOTALL + re.M) 
matches_m = reg.match(code_m)
matches_s = reg.match(code_s)
print matches_s # Give a match object
print matches_m # Gives None 
```

我`matches_m`得到`None`. 但`matches_s`有效。我在这里想念什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-30T17:34:30.910

[`match()`](http://docs.python.org/2/library/re.html#re.RegexObject.match)仅匹配字符串的开头，[`search()`](http://docs.python.org/2/library/re.html#re.RegexObject.search)改为使用。

使用 时`match()`，就像`\A`在您的正则表达式的开头有一个字符串锚 ( ) 的隐式开头。

作为旁注，除非您正在使用或在您的正则表达式中并希望它们在行的开头和结尾匹配，否则您不需要该`re.M`标志。在组合多个标志时，您还应该使用按位 OR（例如）而不是相加。`^``$``re.S | re.M`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T17:34:41.863

`re.match`测试字符串是否与正则表达式匹配。您可能正在寻找`re.search`：

```
>>> reg.search(code_m)
<_sre.SRE_Match object at 0x7f293e94d648>
>>> reg.search(code_m).groups()
(' This is a comment. ',) 
```

# android - 如何在 Android 中使用 Tab 和 Swipe View 在 Fragment 中进行 ACTION_CALL？

> ID：13144545
> 
> 赞同：1
> 
> 时间：2012-10-30T17:32:28.123
> 
> 标签：android, android-fragments, call, contacts, swipe

我在大学时已经使用 stackoverflow 多年，现在发现自己问我的第一个问题是关于我的新工作。我已经进行了数天的研究（每天至少 3 小时），但找不到解决问题的方法。我敢肯定这是一件小而愚蠢的事情，但它欺骗了我！我正在尝试创建一个应用程序，允许用户点击一个数字/按钮来拨打与顶部选项卡相关的电话号码。因此，对于 TAB A，他们有一个数字 A，用户可以向右滑动到 TAB B 以获得数字 B，等等。

这是我到目前为止的代码：

主要活动：

```
startActivity(new Intent(Intent.ACTION_CALL,Uri.parse("tel:18004581552"))); 
```

感谢各位的帮助！我感谢所有的批评和想法！

好吧，可悲的是，在我花了很长时间尝试格式化发布代码之后，我在 stackoverfloor 上发布的第一次体验很糟糕，它只是不允许我这样做！！！

这是我用来帮助我使用 Swipe & Tab 视图的网站。

[http://www.lucazanini.eu/2012/android/tabs-and-swipe-views/?lang=en](http://www.lucazanini.eu/2012/android/tabs-and-swipe-views/?lang=en)

然后，我将按钮添加到 xml 布局文件 tab1 等。我现在正在尝试创建一个按钮按下操作，该操作将调用一个数字。我不知道我哪里出错了。这里强调一点。

谢谢，

科马克

# mysql - SQL 语法错误

> ID：13144553
> 
> 赞同：0
> 
> 时间：2012-10-30T17:32:51.180
> 
> 标签：mysql

我正在尝试在 phpMyAdmin 中插入数据，但返回一个错误：

```
#1064 - You have an error in your SQL syntax; check the manual that corresponds to your  MySQL server version for the right syntax to use near 'INSERT INTO utilizadores(nome, login, password, email, tipoacesso) VALUE' at line 1. 
```

<`

```
//variáveis de estabelecer ligação à base de dados
$hostDB = "localhost";
$userDB = "root";
$passDB = "";
$nameDB = "sistemaimportacao";

//conexão à base de dados
$connectDB = mysql_connect($hostDB,$userDB,$passDB, $nameDB) or die ("não foi possível conectar: ".mysql_error());

class users{

    private $_login;
    private $_password;
    private $_tipoacesso;
    private $_nome;

    public function __construct($login, $password,$tipoacesso,$nome){
        $this->_login=$login;
        $this->_password=$password;
        $this->_tipoacesso=$tipoacesso;
        $this->_nome=$nome;
    }

    public function create(){

        $sql = "INSERT INTO users(login, password, tipoacesso, nome) 
VALUES ('$this->_login', '$this->_password', '$this->_tipoacesso','$this->_nome')";
        echo $sql;
        mysql_query($sql);
    }

}

$reg = new users("abc", "qwerty", "1", "edgar");
$reg->create(); 
```

?>`

我确信表和字段的名称是正确的。

有人能帮我吗？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T17:33:27.013

尝试在您的值周围加上引号`password`，它可能不是整数数据类型：

```
INSERT INTO utilizadores(nome, login, password, email, tipoacesso) 
VALUES ('Edgar', 'apolo90', '123456','edgar@edgar.pt',1) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T09:37:19.763

您在列名中使用了关键字（`password`是关键字），将它们封装在反向刻度中以避免歧义。

```
INSERT INTO `users`(`login`, `password`, `tipoacesso`, `nome`) 
VALUES ('$this->_login', '$this->_password', '$this->_tipoacesso','$this->_nome') 
```

# maven - 用于 maven pom 项目的 Apache Archiva

> ID：13144555
> 
> 赞同：0
> 
> 时间：2012-10-30T17:32:55.530
> 
> 标签：maven, repository, archiva

我已经在我的服务器上实现了 Apache Archiva，它在 jetty *(localhost:8888)*上运行。我已经添加了我的 jar，现在我有一个内部**仓库 (localhost:8888/repository/internal/)**。好吧，现在我需要将此存储库集成到我的项目中，并且我已将其添加到我的 pom.xml 的存储库部分，但我无法检索任何已加载的 jar。我已经将外部存储库重新索引到Eclipse 的*Maven 存储库*视图中，并且我已经检查了我的存储库的***启用完整索引***，当我尝试进入这个存储库时，通过这个视图，这个位置是空的。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T07:12:48.600

如果您使用的是**Archiva**的最新版本，您可以手动添加 jar，它会在浏览部分显示所有添加的 jar。

# sql - 如何解决 SQL Server 2000 上的参数嗅探？

> ID：13144556
> 
> 赞同：1
> 
> 时间：2012-10-30T17:32:56.730
> 
> 标签：sql, sql-server, sql-server-2000, parameter-sniffing

我遇到了一个问题，其中包含大约 70 个参数的更新查询有时会超时。根据一些研究，我相信这是由于数据包嗅探。我看到在较新版本的 SQL Server 中，我可以使用该`Option(recompile)`子句，但在我的情况下这不起作用，因为我使用的是服务器 2000。

我正在使用`sqlhelper.executeNonQuery`而不是存储过程。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T17:45:20.327

据我所知，没有像 一样的“开箱即用”方式`Option(recompile)`，但我记得我找到了一种欺骗优化器的方法。它似乎只嗅探您实际上在查询外部传递的参数，而不是全部。所以，如果你尝试运行

```
SELECT MyField1, MyField2 FROM MyTable WHERE MyOtherField = @MyParm 
```

参数嗅探会发生，但是如果你写类似的东西

```
DECLARE @MyUnsniffableParm varchar(30)
SET @MyUnsinffableParm = @MyParm    
SELECT MyField1, MyField2 FROM MyTable WHERE MyOtherField = @MyUnsniffableParm 
```

广告当然只是将`@MyParm`参数传递给您的脚本，参数嗅探似乎没有发生！让我知道如果我没记错的话，我没有可尝试的 SQL 2000 实例！
**编辑：**
看起来其他东西在这里做同样的事情：http: [//blogs.msdn.com/b/khen1234/archive/2005/06/02/424228.aspx](http://blogs.msdn.com/b/khen1234/archive/2005/06/02/424228.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T17:44:29.777

一个简单的解决方法是不使用参数。代替：

```
SELECT * FROM YourTable WHERE UserName = @myUserName; 
```

经过：

```
SELECT * FROM YourTable WHERE UserName = 'PFranchise' 
```

如果 SQL Server 不知道参数，它就无法嗅探它们！SQL Server 将为每个查询重新编译查询计划。

关于这种方法的两个注意事项：

*   小心 SQL 注入
*   在更高版本的 SQL Server 中，[服务器选项“强制参数化”](http://technet.microsoft.com/en-us/library/ms175037%28v=sql.105%29.aspx)甚至可以嗅探没有参数的查询。默认情况下它是关闭的。但是在升级 SQL Server 时要牢记这一点。

# c++ - 如何将 std::function 或 lambda 作为（可选）模板参数？

> ID：13144567
> 
> 赞同：0
> 
> 时间：2012-10-30T17:33:25.687
> 
> 标签：c++, c++11, template-meta-programming

嗨，我在玩 TMP，正在考虑生成一个看起来像这样的类：

```
template<typename T, typename LogFunc>
class
{ 
```

（其中 LogFunc 应默认为“nop”函数）

想法是有一个类为类型 T 的实例定义一些功能，例如检查数字是否为偶数，并且还可以通过调用来记录

```
void memberFunc(T& t)
{
  LogFunc(t); 
} 
```

或许

```
void memberFunc(T& t)
{
  LogFunc lf;
  lf(t);
} 
```

可以做到吗？通过阅读 SO 上的 A，lambdas 作为 templ 参数有点问题。顺便说一句，如果有人关心[这](http://pastebin.com/rhCz2y1y)是我尝试过的，但它会打印出来

> :(

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T18:29:49.963

问题是 lambda 的类型是编译器强制的单例；它只有一个值，即 lambda 本身；此外，该类型有一个已删除的构造函数。因此，即使使用 decltype，您也不能将 lambda 作为模板实例化的一部分传递。但是没有什么能阻止你将它们作为构造函数参数传递。

然而，这里我们遇到了另一个问题：构造函数参数不用于推断模板实例化（这就是标准库提供 make_pair 和 make_tuple 等实用程序的原因）。所以我们需要一个模板化的工厂函数。

有了这一切，解决方案非常简单：

```
template<typename T, typename LogFunc>
class Foo {
  public:
    Foo(const T& t, LogFunc fn) : t_(t), lfn_(fn) {}
    //...

  private:
    T t_;
    LogFunc lfn_;
};

struct Noop {
  template<typename...A>
  void operator()(A...) { };
};

template<typename T, typename LogFunc=Noop>
Foo<T, LogFunc> make_foo(const T& t, LogFunc func=LogFunc()) {
  return Foo<T, LogFunc>(t, func);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T18:07:32.110

这不会直接回答，但会提供一些有关您所做工作的提示。

`LogFunc`参数是一种类型（不是对象），因此

*   `LogFunc(t)`创建一个临时`LogFunc`给`t`定作为参数（您实际上是在调用`LogFunc::LogFunc(T&)`构造函数）。
*   `LogFunc lf; lf(t);`创建一个`Logfunc`名为 lf 的堆栈生存默认构造，并`lf(t)`调用其`LogFunc::operator()(T&)`成员函数。
*   `LogFunc()(t)`创建一个临时的默认构造的 LogFunc 并在其上调用 operator()(T&)。

关于 lambda，它们实际上是类，其构造函数采用捕获的变量，其 operator() 采用您声明的参数。但是它们只存在于编译器的“内部”，并且没有您可以引用的“名称”。

你可以做的是用`decltype`, 或自由函数来推断它的类型。

通常，参数函数类存储一个函数对象，在构造时初始化。

```
#include <iostream>

template<class Fn>
class LogFunc
{
public:
    LogFunc(Fn f) :fn(f) {}

    template<class T>
    void memberFunc(T& t)
    { fn(t); }
private:
    Fn fn;
};

template<class Fn>
LogFunc<Fn> makeLogFunc(Fn f)
{ return LogFunc<Fn>(f); }

int main()
{
    int x=5;

    auto lf = makeLogFunc([](int& a){ std::cout << a << std::endl; });
    lf.memberFunc(x);

    return 0;
} 
```

编译为“g++ -pedantic -Wall -std=c++11”，会输出

```
5 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-30T19:33:35.727

其他答案都很好，但你也可以只传入一个带有`std::function<T>`. 看起来像这样：

```
#include <functional>
#include <iostream>

template <typename T> void someOther(T val){
  std::cout << "used other "<<val<<std::endl;
}

template <typename T> void noop(T val){
  std::cout << "noop "<<val<<std::endl;
}

template<typename T>
struct A{
  A(std::function<void(T)> f =noop<T> ) : mf(f){}
  void memberFunc(T valx){
    mf(valx);
  }
  std::function<void(T)> mf;
};

int main(){
  A<int> aNoop; ;
  A<float> aSomeOther{someOther<float>} ;
  aNoop.memberFunc(5);
  aSomeOther.memberFunc(3.55);
} 
```

## 另一种方法是使用仿函数类，如下所示：

```
#include <iostream>
template <typename T> struct OtherC{
  void operator()(T v){ std::cout <<"other "<<v<<std::endl; };
};
template <typename T> struct NoopC{
  void operator()(T){ std::cout << "noop"<<std::endl; };
};
template<typename T, template <typename X> class F = NoopC >
struct A{
  static void memberFunc(T valx){ F<T>()(valx); }
};
int main(){
  A<int> aNoop; 
  A<float,OtherC> aSomeOther ;
  aNoop.memberFunc(5);
  aSomeOther.memberFunc(3.55);
} 
```

# grails - 一对多关系的标准

> ID：13144570
> 
> 赞同：2
> 
> 时间：2012-10-30T17:33:27.387
> 
> 标签：grails

我的域包含这样的一对多关系：

A类 { B b }

B类{字符串名称}

我想在 A 上创建一个条件查询，它将查找 A 以具有给定名称的 B 对象。它可能会返回多个条目。所以......将给定的字符串与 B 中的“名称”字段进行比较，并返回 B 与名称匹配的类型 A 的条目列表。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T17:44:04.353

除非我遗漏了一些应该很容易的东西：

```
def instanceList = A.withCriteria {
   b {
     eq('name','whatever')
   }
} 
```

# jquery - 谷歌翻译和 JQuery

> ID：13144574
> 
> 赞同：1
> 
> 时间：2012-10-30T17:33:36.560
> 
> 标签：jquery, google-translate

我有一个法语网站——我使用谷歌翻译允许用户将其翻译成英文，效果很好。

网站上有一个进入城镇的表格。当用户开始输入时，列表从 javascript 数组中提取并输入到 jquery 数组中，如下所示：

```
 strTowns = "LE BAR SUR LOUP, PARIS, LE FROMAGE,"
    arr = strError.split(",");
    $(function() {
        $( "#town" + pR ).autocomplete ( {
            source: arr

        });
        $( "#town" + pR ).autocomplete( "option", "minLength", 2 );
    }); 
```

这也很好用。然而，如果用户选择将网站翻译成英文，谷歌翻译器也会翻译我的城镇列表，这样“LE FROMAGE”就变成了“LE CHEESE”，这当然没有意义，因为“LE CHEESE”甚至不是一个城镇。

我已经花了几个小时试图防止这种使用 etc 但到 noavil。

谁能帮忙？？？

提前致谢

# android - Android应用程序中的普通线程，ProgressDialog，屏幕方向更改

> ID：13144577
> 
> 赞同：0
> 
> 时间：2012-10-30T17:33:47.223
> 
> 标签：android, android-layout, android-intent

我是android开发的幼崽，但我现在面临着难题。请尝试帮助我。在我的应用程序中，我使用 onRetainNonConfigChange() 来保存对象并在创建活动后使用。我知道用 ProgressDialog 处理 AsynchTask 线程的这个问题，但是我不能用普通的 Thread 和 Hanlder 处理同样的问题。我尝试了所有方法，例如将 Thread 类设为静态并在 Handler 类上传递参数更新 UI 但......没有用......“如何使用 android 中的普通线程处理程序处理屏幕方向更改”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T17:43:20.070

我认为你应该`AsyncTask`仍然使用。因为它在 SDK 中说：

**如果您的保留状态是 AsyncTask，则可以保证在执行下一个实例的 onCreate(Bundle) 之前，不会从此处调用它的回调函数（如 onPostExecute(Result)）。**

# javascript - 如何在 JavaScript 电子表格中初始化 =SUM 字段

> ID：13144580
> 
> 赞同：1
> 
> 时间：2012-10-30T17:34:03.690
> 
> 标签：javascript, sum, spreadsheet

我正在使用 JavaScript 创建电子表格，但无法弄清楚如何评估该`=SUM`字段。我的代码将生成一个数组 ex `(=SUM,A1,B1)`，但我不知道如何更改 A1 和 B1 的属性以获取其关联字段的值。

```
function saveCell()
{
// get the text the user just typed into the text box
var cellText = document.getElementById("txtCell").value;

var tokenArray = getFormula(cellText);

// if null... this isn't a formula
if (tokenArray != null)
{
    alert("This is a formula to sum from " + tokenArray[1] + " to " + tokenArray[2]);

}
else
    currentRef.innerHTML = cellText;

    ssArray[currentRow - 1][currentCol - 1] = cellText;
}//end saveCell()

// determines if user entered a formula such as =SUM(A1:B1)
// returns an array with cell coordinates

function getFormula(tbValue)
{

// this is a regular expression pattern which is intended to
// split the string (formula) on any of ":" "(" or ")"
var pattern = /[:|\(|\)]/;

// do the split ... ar is an array
var ar = tbValue.split(pattern);

// convert =sum to upper case
var sum = ar[0].toUpperCase();
var attOne = ar[1];
var attTwo = ar[2];

if (ar.length < 3)
    return null;
else if (sum != "=SUM")
    return alert("The function '"+sum+"' is not supported...");
else
{
    //return an array of strings
    return ar;
    }
}//end getFormula() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T17:52:08.303

嗯，如果我理解得很好，A1 和 B1 应该是存储值的元素的“id”，所以你应该进入这些元素并获取值。

在这种情况下，您可以使用`document.getelementbyid(attOne).value`获取 A1 字段内的值；

虽然我对你的问题有点迷茫，但也许你应该发布电子表格的结构。

# linux - 使用 boost program_options 时从命令行获取字符串

> ID：13144584
> 
> 赞同：1
> 
> 时间：2012-10-30T17:34:12.440
> 
> 标签：linux, boost, boost-program-options

我正在使用 boost program_options 库来处理命令行和配置文件数据，但我不清楚如何从处理的数据中获取所需的字符串。

如何将 program_options 命令行参数转换为 getaddrinfo 函数的正确形式。

```
//First, the options are declared

po::options_description config("Configuration");
    config.add_options()
        ("IPAddress", po::value< vector<string> >(),"127.0.0.1")
        ("Port", po::value< vector<string> >(),"5000")
         ;
//...

// Attach the config descriptions to the command line and/or config file

    po::options_description cmdline_options;
    cmdline_options.add(config).add(hidden);

    po::options_description config_file_options;
            config_file_options.add(hidden);

    po::options_description visible("Allowed options");
            visible.add(config);

    po::positional_options_description p;
            p.add("input-file", -1);

    po::variables_map vm;
    store(po::command_line_parser(ac, av).
          options(cmdline_options).positional(p).run(), vm);
    notify(vm);

// Use the command line options for IPAddress and Port
// TODO: Load the config file's address and port information
int retval = getaddrinfo(vm["IPAdress"].as< string >(),vm["Port"].as<string>(),    &hint, &list);
// This doesn't work and neither does this
//  int retval = getaddrinfo(vm["IPAdress"].as< vector<string> >(),vm["Port"].as<vector <string> >(),    &hint, &list);

// getaddressinfo 
```

来自 netdb 的 getaddrinfo 原型是：

```
extern int getaddrinfo (__const char *__restrict __name,
        __const char *__restrict __service,
        __const struct addrinfo *__restrict __req,
        struct addrinfo **__restrict __pai); 
```

这里是 boost program_options API 的链接：

[http://www.boost.org/doc/libs/1_37_0/doc/html/program_options.html](http://www.boost.org/doc/libs/1_37_0/doc/html/program_options.html)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T12:24:04.477

如果所需的参数应该具有类型`char *`并且您尝试提供 a `string`，编译器会告诉您出了什么问题。阅读该错误消息并尝试理解它。

要从 a 中获取`char *`a `string`，请使用方法`c_str()`。

# java - 检查两个字符串是否与字母、数字和特殊字符匹配

> ID：13144590
> 
> 赞同：1
> 
> 时间：2012-10-30T17:34:45.620
> 
> 标签：java, python, string, compare, character

您将如何编写一个接收两个字符串并在它们匹配时返回 true 的函数（不使用正则表达式）。

约束如下：

*   字符串 1（要匹配的文本）将包含字母和数字。
*   字符串 2 是模式，将是字母、数字`.`和`*`，其中`.`表示字母或数字都将被视为匹配，并且`*`表示前一个字符重复 0 次或多次。

例如：

```
Text: Facebook
Pattern: F.cebo*k
returns True 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T18:01:58.380

对此并不特别自豪（@JoranBeasley 的回答是最好的），但如果没有正则表达式，这将有效（似乎）：

```
def Matcher(pattern, text):
  comp = zip(pattern, text)
  for i, vals in enumerate(comp):
    if vals[0] != vals[1]:
      if vals[0] == '.' and vals[1].isalnum():
        continue
      elif vals[0] == '*' and vals[1] == comp[i-1][0]:
        continue
      else:
        return False
  return True

print 'F.cebo*k -> Facebook'
print Matcher('F.cebo*k', 'Facebook')

print 'St.c.koverflow -> Stackoverflow'
print Matcher('St.c.koverflow', 'Stackoverflow')

# And for nostalgia...
print 'St.ckoverfl*w -> Stackoverfllw'
print Matcher('St.ckoverfl*w', 'Stackoverfllw') 
```

我确定它充满了错误（例如，如果字符串以 a 开头`*`），但我的代码通常是。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T17:41:41.670

您刚刚描述的内容被称为正则表达式（尽管`.`在正则表达式中表示“任何东西”）......已经有一个库

你的例子也是错误的..因为`"flow"`不匹配`"fl*w"`，但它会匹配`"fl.w"`

```
import re
string2=string2.replace(".","[0-9a-zA-Z]")
print re.match(string2,string1) 
```

这是一个状态机实现，它应该适用于所有情况，除非它以 * 开头

```
def matcher(pat,txt):
    last = None
    try:
        for ltr in txt:
            if ltr == pat[0]:
                pat = pat[1:] #consume
            elif pat[0] == "*" and ltr == last:
                 #dont consume
                continue # dont change last
            elif pat[0] == "*" and ltr == pat[1]:
                pat = pat[2:] #consume 2 (* + whatever)
            elif pat[0] =="*"  and last == ".":
                continue #dont consume and dont change last 
            elif pat[0] == ".":
                pat = pat[1:]#consume
            elif pat[1] == "*"  and ltr == pat[2]:
                pat = pat[3:] #consume 3 (x*X)
            else:
                return False
            last = ltr
    except IndexError:
        return False #there was a problem that made it break ... it also doesnt match
    if not pat or pat == "*":
        return True

    return False
print "Matching Pattern bo*k"
for word in "boak,bok,book,booooooook,boo,bk".split(","):
    print word ," ?=",matcher("bo*k",word) 
```

哪个输出

```
Matching Pattern bo*k
boak  ?= False
bok  ?= True
book  ?= True
booooooook  ?= True
boo  ?= False
bk  ?= True 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-30T17:46:41.573

您可能想查看正则表达式。如果他们发现了什么，他们会返回 true。

```
import re
if re.findall(regex, string):
  print "You found it!" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-30T17:42:23.933

正则表达式将帮助您[链接](http://docs.python.org/2/library/re.html)

# sql-server - 插入更新删除触发器

> ID：13144591
> 
> 赞同：1
> 
> 时间：2012-10-30T17:34:51.747
> 
> 标签：sql-server, triggers

亲爱的，我的触发器有问题。

我这样做是否正确，现在它只适用于插入。我想我很接近，如果你有时间请帮助我。我正在尝试通过触发器将所有插入、更新和删除存储到表 customers_changelog 中。我无法删除或更新客户的代码有问题，我只能插入新客户。请帮助我，我已经花了很多时间在这上面，只是不能让它工作！:)

```
create table customers (
customerid int identity primary key,
name varchar(100) not null,
address varchar(100)
)
go

create table customers_changelog (
customerid int,
name varchar(100) not null,
address varchar(100),
change_user varchar(32),
change_time datetime,
change_action char(1) default 'I',
check (change_action = 'I' or change_action = 'D')
)
go

CREATE TRIGGER log_changes
ON customers
AFTER INSERT, UPDATE, DELETE
AS 
BEGIN
    SET NOCOUNT ON;

--
-- Check if this is an INSERT, UPDATE or DELETE Action.
-- 
DECLARE @customerid1 as int;
DEClARE @name1 as varchar(32);
DECLARE @address1 as varchar(100);
DECLARE @change_action1 as char(1);
DECLARE @change_time1 as datetime;
DECLARE @change_user1 as varchar(32);

select  @customerid1 = c.customerid, @name1 = c.name, @address1 = c.address
from customers c, inserted i
where c.customerid = i.customerid 

SET @change_time1 = CURRENT_TIMESTAMP;
SET @change_user1 = CURRENT_USER;
INSERT INTO customers_changelog(customerid,name,address,change_action,change_time,change_user)
    VALUES(@customerid1,@name1,@address1,'I',@change_time1,@change_user1)
IF EXISTS(SELECT * FROM DELETED)
BEGIN    
            IF EXISTS(SELECT * FROM INSERTED) 
            INSERT INTO customers_changelog VALUES(@customerid1,@name1,@address1,'U',@change_time1,@change_user1)
            ELSE 
            INSERT INTO customers_changelog VALUES(@customerid1,@name1,@address1,'D',@change_time1,@change_user1)

END
ELSE 
    IF NOT EXISTS(SELECT * FROM INSERTED) RETURN;
END 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T18:52:22.390

从语法假设 MS-SQL - 这里有几个问题：
1\. 需要在“更新”和“删除”插入中指定列列表，因为表中的列顺序与您的插入不匹配。
2.不能使用“插入”的数据进行删除插入

```
ALTER TRIGGER [dbo].[log_changes] ON [dbo].[customers] AFTER INSERT, UPDATE, DELETE AS 
BEGIN
    SET NOCOUNT ON;
    DECLARE @customerid1 as int;
    DEClARE @name1 as varchar(32);
    DECLARE @address1 as varchar(100);
    DECLARE @change_action1 as char(1);
    DECLARE @change_time1 as datetime;
    DECLARE @change_user1 as varchar(32);

    select  @customerid1 = c.customerid, @name1 = c.name, @address1 = c.address
    from customers c, inserted i
    where c.customerid = i.customerid 

    SET @change_time1 = CURRENT_TIMESTAMP;
    SET @change_user1 = CURRENT_USER;

    IF EXISTS(SELECT * FROM DELETED)
    BEGIN    
                IF EXISTS(SELECT * FROM INSERTED) 
                INSERT INTO customers_changelog(customerid,name,address,change_action,change_time,change_user) 
                    VALUES(@customerid1,@name1,@address1,'U',@change_time1,@change_user1)
                ELSE 
                BEGIN
                    select  @customerid1 = d.customerid, @name1 = d.name, @address1 = d.address
                        from deleted d
                    INSERT INTO customers_changelog(customerid,name,address,change_action,change_time,change_user) 
                        VALUES(@customerid1,@name1,@address1,'D',@change_time1,@change_user1)
                END

    END
    ELSE
    BEGIN
        IF NOT EXISTS(SELECT * FROM INSERTED) RETURN;
        INSERT INTO customers_changelog(customerid,name,address,change_action,change_time,change_user)
            VALUES(@customerid1,@name1,@address1,'I',@change_time1,@change_user1) 
    END
END 
```

# git - GIT stash apply reverse 不适用于 js 和 rb 文件

> ID：13144592
> 
> 赞同：2
> 
> 时间：2012-10-30T17:34:51.690
> 
> 标签：git, newline, reverse, git-stash, git-patch

我试图弄清楚为什么 GIT 不对 javascript 和 ruby​​ 文件应用反向补丁，而是对 php 文件应用反向补丁。我的步骤是：

`...modifying some php, ruby and js files...`

`git stash`#将更改保存到存储中

`git stash apply`#应用它们

`git stash show -p | git apply -R`#反向修补

它工作正常并且不应用我隐藏的更改，但仅适用于 php 文件，不适用于 ruby​​ 或 javascript。所有文件（甚至 php）都有`CRLF`行尾。当我尝试使用`LF`行结尾的文件时，根本没有问题，但我仍然想知道，为什么它只适用于特定文件类型的`CRLF`行。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T11:18:54.623

我发现了这个问题，我认为我的解决方案对其他人有用。实际上，它发生在从 Subversion 到 Git 的初始迁移之后。问题是项目中的文件有不同的行尾，所以它不依赖于文件类型。当 Git 在结帐期间尝试将它们全部转换为一种格式时，它是不正确的，并且在某些情况下`CRLF`被破坏了。我发现的解决方案：

`git config --global core.autocrlf input`# 在 OSX 或 Linux 上设置此设置

`git config --global core.autocrlf true`# 在 Windows 上设置此设置

`git rm --cached -r .`

`git add .`

`git commit -m "Line endings fix. Now all lines are in LF format"`

`git reset --hard`

之后，我有了一个干净的分支，所有文件都采用一种格式。希望，这会帮助某人。

# ruby - Ruby：执行示例程序时遇到问题

> ID：13144593
> 
> 赞同：-1
> 
> 时间：2012-10-30T17:34:57.647
> 
> 标签：ruby, sublimetext2

我下载了一个用 Ruby 编写的代码示例。

我使用 RailsInstaller 在 Windows Server 2008 上准备好开发环境，并使用 Sublime Text 2 作为我的编辑器。

我尝试了一些基本的命令行语法，它们似乎工作得很好，但是我不知道如何执行这个有两个类并且没有定义 Main 函数方法的示例。

我是一名 C# 开发人员，无法找到该程序的入口点。每当我在 Sublime 中构建代码时，它都会返回以下错误：

```
[Error 2] The system cannot find the file specified
[cmd:  [u'ruby', u'filepath']]
[dir:  folderpath]
[path: C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Program Files\Sublime Text 2\]
[Finished] 
```

任何人都可以帮助我开始吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T17:38:09.373

确保在文件路径中包含 Ruby 安装。我不确定 Rails 安装程序是否为您设置了它们，但是，从上面的路径声明来看，它看起来不像在您的路径上。

要将 Ruby 安装目录添加到 Windows 上的路径，请打开控制台并键入：

```
set PATH=%PATH%;<PathToRubydir>\bin 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T14:31:28.290

如果您从[http://rubyinstaller.org](http://rubyinstaller.org)安装，安装程序可以选择将 ruby​​ 可执行文件添加到 PATH。默认情况下不选中。您可以重新安装并检查此选项。然后重新启动ST2，您可以通过CTRL + B构建代码。

# c# - dalAccess 在 ASP.NET 中应该做什么？

> ID：13144594
> 
> 赞同：0
> 
> 时间：2012-10-30T17:35:02.737
> 
> 标签：c#, asp.net, asp.net-mvc

我对从 Ruby on Rails 3 迁移而来的 ASP.NET MVC 框架有点陌生，它是 ActiveRecord。请帮助我了解 dalAccess 在 MVC 中的位置。

```
[HttpGet]
    public ActionResult copyCampaign(int Id)
    {
        DALAccess dalaccess = new DALAccess();
        //string newid = dalaccess.CopyOffer(Id);
        string newid = dalaccess.CopyOfferByCampaignId(Id);

        string type = PrepareOffer4Edit(newid);
        if (type == "bundle")
            return RedirectToAction("bundleStep1");
        else if (type == "scratchOff")
            return RedirectToAction("scratchOffStep1");
        else
        {
            return RedirectToAction("CampaignMgmt", "CampaignMgmt");
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T17:42:29.307

拥有 DAL（数据访问层）的目的是[关注点分离](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&ved=0CCEQFjAA&url=http://en.wikipedia.org/wiki/Separation_of_concerns&ei=jRGQUNnMF6_oiAL9mYGABQ&usg=AFQjCNFjPCAoeZtZUsEK1uTqlMlgN2QTOg)的概念。这也适用于[单一职责原则](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&ved=0CCEQFjAA&url=http://en.wikipedia.org/wiki/Single_responsibility_principle&ei=nxGQUI-oIabfigKoyoHoDA&usg=AFQjCNFoci3JyHtoEwOx1lduCbF7IcS50Q)。

DAL 为您提供了一种从数据源检索数据对象的方法，而无需担心数据来自何处或如何转换它。这允许您专门为您的数据访问功能创建测试，以帮助识别问题。

如果您需要编写另一个使用相同数据的应用程序（或者说是第二个前端），这种分离也会派上用场。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T17:48:48.127

这取决于。我不熟悉 Ruby 的活动记录，所以我不能给你比较。

在 .Net 中，数据访问通常是应用程序中的较低层。这会有所不同，但通常随着应用程序的增长，您会发现数据层更加孤立。在较小的应用程序中，这不是什么大问题。

截至目前，ORM 已成为数据访问的方式。.NET 中有两种流行的 ORM：Entity Framework (Microsoft) 和 nHibernate (open source)。两者都有优点，都可以完成工作并且都有不错的文档。EF 更容易上手，因为它与 .Net 配合得很好。nHibernate 更加灵活，尤其是随着复杂性的增加。nHibernate 一直在生成更好的 SQL。虽然，微软在最新版本的 EF 中为清理 SQL 生成做了很多工作。

# esb - stWSO2ESB OutSequence 处理

> ID：13144596
> 
> 赞同：1
> 
> 时间：2012-10-30T17:35:05.313
> 
> 标签：esb, wso2esb, bus, synapse

我正在通过 WSO2ESB 中的 XSLT 将 XML 请求转换为 SOAP，只是想知道是否可以使请求参数可用于响应？

例如

```
<request>
<test>123</test>
<param1>testing</param1>
</request> 
```

-> 转换为 SOAP

```
<?xml version='1.0' encoding='utf-8'?><soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"><soapenv:Body><S:Envelope xmlns:S="http://schemas.xmlsoap.org/soap/envelope/">#S:Body><ns2:testrequest xmlns:ns2="http://xml.testing.com/test"><teststring>testing</teststring></ns2:testrequest></S:Body></S:Envelope></soapenv:Body></soapenv:Envelope> 
```

在回应中

```
<?xml version='1.0' encoding='utf-8'?><soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"><soapenv:Body><S:Envelope xmlns:S="http://schemas.xmlsoap.org/soap/envelope/"><S:Body><ns2:testresponse xmlns:ns2="http://xml.testing.com/test"><responsestring>success</responsestring></ns2:testresponse></S:Body></S:Envelope></soapenv:Body></soapenv:Envelope> 
```

我想以 XML 格式返回

```
<responsestring>
<test>123</test>
<return1>success</return1>
</responsestring> 
```

如您所见， 123 没有发送到服务器，也没有从服务器接收。但是，客户端正在发送此参数，我只想在请求中使用此参数并发送回响应，这可能吗？怎么办？我对突触很陌生，对 WSO2ESB 也很陌生，有人可以赐教吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T02:43:03.280

对的，这是可能的。您可以在 Insequence 中使用[属性 mediator](http://docs.wso2.org/wiki/display/ESB450/Property+Mediator)将所需的值设置为属性，然后使用[丰富的 mediator](http://docs.wso2.org/wiki/display/ESB450/Enrich+Mediator)将其添加到 outsequence 中以响应。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T09:28:49.860

Got it working now. Simply by adding the property mediator in both insequence and outsequence together with the XSLT, where the xslt is trying to get the value from test property. That's it!

Insequence

```
 <property xmlns:ns="http://org.apache.synapse/xsd" name="TEST" expression="//request/*[local-name()=test]" scope="default"/> 
```

outsequence

```
<xslt key="xxxx.xslt">
<property name="test" expression="get-property('TEST')"/>
</xslt> 
```

# java - 如何将 lambdaj 与 hamcrest 匹配器 (hasItemsInArray) 一起使用来过滤列表

> ID：13144599
> 
> 赞同：2
> 
> 时间：2012-10-30T17:35:12.330
> 
> 标签：java, predicate, hamcrest, lambdaj, matcher

我正在尝试通过 lambdaj 过滤在供应商数组中找到的 caroffers 对象列表。但是下面的代码不起作用。我得到空列表。

```
 String[] vendor = {"FORD","TOYOTA"}; 
    List carsOffers=filter(having(on(CarProviderModel.class).getProviderName(),  hasItemInArray(vendor)),carprvds); 
```

下面的代码在哪里起作用。只有 equalTo 似乎对我有用。

```
 List carsOffers=filter(having(on(CarProviderModel.class).getProviderName(),  anyOf(equalTo(vendor[0]), equalTo(vendor[1]))),carprvds); 
```

请帮我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T16:56:01.893

你想要`isIn`：

```
filter(having(on(CarProviderModel.class).getProviderName(), 
    isIn(vendor)),carprvds); 
```

`hasItemInArray`有点与您想要的相反-不是过滤`getProviderName()`提供的列表之一的`vendor`项目，而是过滤`vendor`返回的项目之一的项目`getProviderName()`-当然 `getProviderName()`（大概！）不返回数组，所以你没有匹配。

[Hamcrest`Matchers`类文档](http://hamcrest.org/JavaHamcrest/javadoc/1.3/org/hamcrest/Matchers.html)提供了以下两个示例：

**是在**：

```
assertThat("foo", isIn(Arrays.asList("bar", "foo"))) 
```

**hasItemInArray**：

```
assertThat(new String[] {"foo", "bar"}, hasItemInArray(startsWith("ba"))) 
```

（注意，您的代码正在调用 的另一个重载`hasItemInArray`，这相当于`hasItemInArray(equalTo(vendor))`- 这可能会让您更清楚您正在测试与您的`vendor`集合是否相等）。

# ruby-on-rails - 我应该在 Rails 应用程序（或任何 MVC 应用程序）中的哪里放置“通知用户”方法？

> ID：13144601
> 
> 赞同：2
> 
> 时间：2012-10-30T17:35:15.607
> 
> 标签：ruby-on-rails, model-view-controller, model

我听说过一些关于 Web 应用程序中 MVC 结构的观点。有些人认为模型应该非常小，并且只包含 ActiveRecord（或其他一些 ORM）和像`validates`and`belongs_to`这样的小东西，所以模型只有几行长。

我个人认为模型可以在应用程序中发挥更大的作用。例如，我需要在整个应用程序中频繁通知用户。通知可以从多个控制器触发。它们都根据用户的通知设置向用户发送通知，这是可通过用户模型访问的对象。

我想做类似的东西：

```
class User < ActiveRecord::Base
  #validations, relationships, etc

  def notify(event)
    notif = Notification.new
    notif.type = event.type
    notif.to = self.id
    # etc

    if notif.save
      # send the notification based on the settings
    end
  end
end 
```

这将使任何控制器都可以`@user.notify`用来向用户传递消息。这让事情变得非常干净，但我意识到我的模型中有一些逻辑。更不用说该模型制造了另一个模型。

我不介意的另一种方法是创建通知并通过该对象发送它。所以控制器可以做`Notification.new(:to => @user.id, ...)`，然后通过`Notification.send`. 这也会在 Notification 对象中添加一些逻辑，以便它知道如何发送自己。事实上，我可能更喜欢这种方法，而不是通过 User 模型创建通知对象。

我不介意模型中的这些小逻辑，以便在从多个控制器发送消息时方便。这是最好的方法吗？我想一个更纯粹的方法是在每个发送通知的控制器中包含一个 NotificationHelper 模块？

编辑：我一直在阅读一些关于模型中的“域逻辑”的内容。似乎鼓励这样做，我认为`notify`or`send`方法被认为是域逻辑。任何有 MVC 经验的开发人员都可以对此发表评论吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T19:14:37.607

对于第二种方法，您可以使用 ActiveRecord::Observer

```
 class NotificationObserver < ActiveRecord::Observer
   def after_create(notification)
       # some sending logic
   end
 end 
```

但不要害羞将小块逻辑提取到他们自己的类中，比如

lib/user_notify.rb

```
 class UserNotify
   def event_trigger(user,event)
       # some logic
   end
 end 
```

使用适合您系统的命名概念（可能是 Notify.send_user_about_event 等）

# ssrs-2008 - SSRS ReportingService2010 将嵌入式数据源更改为共享数据源

> ID：13144604
> 
> 赞同：4
> 
> 时间：2012-10-30T17:35:41.363
> 
> 标签：ssrs-2008

我在一台服务器上安装了带有 SSRS 的 SQL Server 2008，在新服务器上安装了带有 SSRS 的 SQL Server 2008 R2。我想使用 SSRS Web 服务 API 将 200 多个报告以及一些共享计划和几个数据源从第一台服务器迁移到第二台服务器。为简单起见，因为只有几个共享数据源，我继续使用 Report Manager 界面创建了这些数据源。

不幸的是，在我之前的人在每个报告中都嵌入了数据源信息（连接字符串、登录名、密码等）。我认为这是将这些更改为指向共享数据源的好时机，这样就不必为每个报告一个一个地执行此操作。我可以使用 CreateCatalogItem 在新服务器上创建报告，但我似乎无法确定如何正确地从嵌入式数据源更改为共享数据源。

到目前为止，我已经尝试了两个 SetItemReferences：

```
itemRef.Reference = "/Data Sources/TMS";
itemRef.Name = "TMS";
itemRef.Reference = "/Data Sources/TMS";

rs2010.SetItemReferences(catItem.Path, new ReportService2010.ItemReference[] { itemRef }); 
```

和 SetItemDataSources：

```
ReportService2010.DataSourceReference dataSourceRef = new ReportService2010.DataSourceReference();
dataSourceRef.Reference = "/Data Sources/TMS";

ReportService2010.DataSource dataSource = new ReportService2010.DataSource();
dataSource.Name = "TMS";
dataSource.Item = dataSourceRef;

rs2010.SetItemDataSources(catItem.Path, new ReportService2010.DataSource[] { dataSource }); 
```

这两种方法在尝试使用嵌入数据源的报表时都会导致“NotFoundException”，但它们都可以在已经指向共享数据源的报表上正常工作。

此外，我在 Google 和 StackOverflow 上都搜索了解决方案，但一无所获。谁能在这里指出我正确的方向？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-31T15:09:57.227

所以我一直在使用 SetItemReferences 方法，并有一个绝妙的想法最终奏效了。我使用的最终代码如下：

```
List<ReportService2010.ItemReference> itemRefs = new List<ReportService2010.ItemReference>();
ReportService2010.DataSource[] itemDataSources = rs2010.GetItemDataSources(catItem.Path);

foreach (ReportService2010.DataSource itemDataSource in itemDataSources)
{
    ReportService2010.ItemReference itemRef = new ReportService2010.ItemReference();
    itemRef.Name = itemDataSource.Name;
    itemRef.Reference = "/Data Sources/TMS";
    itemRefs.Add(itemRef);
}

rs2010.SetItemReferences(catItem.Path, itemRefs.ToArray()); 
```

问题是我使用的数据源名称与报告 .rdl 文件中的名称不同。我能够使用 GetItemDataSources 方法确定名称应该是什么。由于此方法返回一个数组并且在所述数组中可能有多个项目，因此如果存在多个 ItemReference，我会遍历它以创建多个 ItemReference，尽管我怀疑这种情况是否经常发生。

# sql - 在查询多个结果中使用解码？

> ID：13144605
> 
> 赞同：1
> 
> 时间：2012-10-30T17:35:49.343
> 
> 标签：sql, oracle, group-by, left-join, decode

```
SELECT PE.PHYS_RESR_ID,PE.EQMT_INIT,  PE.EQMT_NBR,
decode (EEU.dimn_type , 'EXTHGT', EEU.dimn_valu) as EXTHGT, 
decode(EEU.dimn_type, 'EXTHGT', EEU.uom_code) as UNIT_EXTHGT,
decode (EEU.dimn_type , 'INHGT', EEU.dimn_valu) as INHGT, 
decode(EEU.dimn_type, 'INHGT', EEU.uom_code) as UNIT_INHGT,
decode (EEU.dimn_type , 'INWDTH', EEU.dimn_valu) as INWDTH, 
decode(EEU.dimn_type, 'INWDTH', EEU.uom_code) as UNIT_INWDTH

FROM EQU_EQMT PE
  left join EQU_EQMT_DIMN EEU 
  on  EEU.PHYS_RESR_ID = PE.PHYS_RESR_ID      
and   ( EEU.POS_DESC is null or EEU.POS_DESC ='VALU' or EEU.POS_DESC ='valu'); 
```

但是当我运行它时。该查询为我制作的每个解码返回一行。我想要这个 id pe.phys_resr_id 的一行，在同一行中有不同的数据。有什么建议吗？我希望它给我这样的：

```
+-------------+-------------+---------+--------+------------+---------+------------+------------+---------------+
| PHYS_RESR_ID| EQMT_INIT   | EQMT_NBR| EXTWD  | UNIT_EXTWD | INHGT   | UNIT_INGHT | INWDTH      | UNIT_INWDTH  | 
+-------------+-------------+---------+--------+------------+---------+------------+-------------+--------------+
|  456        | AC          | 3       |   4    |   IN       | NULL    | NULL       | NULL        | NULL     | 
|  324        | AD          | 45      |   67   |   IN       | 56      | IN         | NULL        | NULL     |
|  132        | B           | 65      |  54    |   IN       | 78      | IN         | 34          |  IN      |    
+----+-------------+---------+--------+--------+------------+---------+------------+-------------+--------------+ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T20:03:42.857

我会使用`MAX(DECODE(...))`成语来[枢轴](http://asktom.oracle.com/pls/apex/f?p=100:11:0%3a%3a%3a%3aP11_QUESTION_ID:766825833740)：

```
SQL> SET NULL [NULL]
SQL> SELECT   pe.phys_resr_id
  2  ,        pe.eqmt_init
  3  ,        pe.eqmt_nbr
  4  ,        MAX(DECODE(eeu.dimn_type, 'EXTHGT', eeu.dimn_valu)) AS exthgt
  5  ,        MAX(DECODE(eeu.dimn_type, 'EXTHGT', eeu.uom_code))  AS unit_exthgt
  6  ,        MAX(DECODE(eeu.dimn_type, 'INHGT' , eeu.dimn_valu)) AS inhgt
  7  ,        MAX(DECODE(eeu.dimn_type, 'INHGT' , eeu.uom_code))  AS unit_inhgt
  8  ,        MAX(DECODE(eeu.dimn_type, 'INWDTH', eeu.dimn_valu)) AS inwdth
  9  ,        MAX(DECODE(eeu.dimn_type, 'INWDTH', eeu.uom_code))  AS unit_inwdth
 10  FROM     equ_eqmt  pe
 11           LEFT JOIN equ_eqmt_dimn eeu ON eeu.phys_resr_id = pe.phys_resr_id
 12  AND      (eeu.pos_desc IS NULL OR eeu.pos_desc = 'VALU' OR eeu.pos_desc ='valu')
 13  GROUP BY pe.phys_resr_id
 14  ,        pe.eqmt_init
 15  ,        pe.eqmt_nbr
 16  ;

PHYS_RESR_ID EQMT_INIT    EQMT_NBR     EXTHGT UNIT_EXTHG      INHGT UNIT_INHGT     INWDTH UNIT_INWDT
------------ ---------- ---------- ---------- ---------- ---------- ---------- ---------- ----------
         456 AC                  3          4 IN         [NULL]     [NULL]     [NULL]     [NULL]
         324 AD                 45         67 IN                 56 IN         [NULL]     [NULL]
         132 B                  65         54 IN                 78 IN                 34 IN

SQL> 
```

# jsf - 从 preRender 导航后无法保留面孔消息

> ID：13144611
> 
> 赞同：1
> 
> 时间：2012-10-30T17:36:13.613
> 
> 标签：jsf, jsf-2

在我的页面的 preRender 代码中，我添加了 faces 消息，然后导航到另一个页面，如下所示：

```
if(error){
addMessageToComponent(null,"AN ERROR HAS OCCURRED");
FacesContext.getCurrentInstance().getExternalContext().getFlash()
                .setKeepMessages(true);
navigateActionListener("myoutcome");
} 
```

添加消息和导航的 util 方法是：

```
public static String getClientId(String componentId)
    {
        FacesContext context = FacesContext.getCurrentInstance();
        UIViewRoot root = context.getViewRoot();

        UIComponent c = findComponent(root, componentId);
        return c.getClientId(context);
    }

    public static UIComponent findComponent(UIComponent c, String id)
    {
        if (id.equals(c.getId())) { return c; }
        Iterator<UIComponent> kids = c.getFacetsAndChildren();
        while (kids.hasNext())
        {
            UIComponent found = findComponent(kids.next(), id);
            if (found != null) { return found; }
        }
        return null;
    }

    /**
     * @param componentId
     *            : the id for the jsf/primefaces component without formId:
     *            prefix. <br>
     *            if you use null then the message will be added to the
     *            h:messages component.
     **/
    public static void addMessageToComponent(String componentId, String message)
    {

        if (componentId != null)
            componentId = GeneralUtils.getClientId(componentId);
        FacesContext.getCurrentInstance().addMessage(componentId,
                new FacesMessage(message));
    }

public static void navigateActionListener(String outcome)
    {
        FacesContext context = FacesContext.getCurrentInstance();
        NavigationHandler navigator = context.getApplication()
                .getNavigationHandler();
        navigator.handleNavigation(context, null, outcome);
    } 
```

但消息未保存，因此重定向后不会出现。

请告知如何解决。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-30T17:50:31.480

该`preRenderView`事件在`RENDER_RESPONSE`阶段的最开始运行。指示范围保留消息**为时已晚。**`Flash`您最迟可以在该`INVOKE_APPLICATION`阶段执行此操作。

由于对此没有标准的 JSF 组件系统事件，因此您需要自制一个：

```
@NamedEvent(shortName="postInvokeAction")
public class PostInvokeActionEvent extends ComponentSystemEvent {

    public PostInvokeActionEvent(UIComponent component) {
        super(component);
    }

} 
```

要发布此内容，您需要`PhaseListener`：

```
public class PostInvokeActionListener implements PhaseListener {

    @Override
    public PhaseId getPhaseId() {
        return PhaseId.INVOKE_APPLICATION;
    }

    @Override
    public void beforePhase(PhaseEvent event) {
        // NOOP.
    }

    @Override
    public void afterPhase(PhaseEvent event) {
        FacesContext context = FacesContext.getCurrentInstance();
        context.getApplication().publishEvent(context, PostInvokeActionEvent.class, context.getViewRoot());
    }

} 
```

注册后如下`faces-config.xml`：

```
<lifecycle>
    <phase-listener>com.example.PostInvokeActionListener</phase-listener>
</lifecycle> 
```

您将能够按如下方式使用新事件：

```
<f:event type="postInvokeAction" listener="#{bean.init}" /> 
```

您只需要确保您至少有一个`<f:viewParam>`，否则 JSF 根本不会进入调用阶段。

JSF 实用程序库[OmniFaces](http://omnifaces.org)已经支持此事件和`preInvokeAction`开箱即用的事件。另请参阅[展示页面](http://showcase.omnifaces.org/eventlisteners/InvokeActionEventListener)，该页面还演示了为重定向设置面部消息。

# c# - RenderTargetBitmap 渲染大小错误的图像

> ID：13144615
> 
> 赞同：5
> 
> 时间：2012-10-30T17:36:30.973
> 
> 标签：c#, wpf, image, thumbnails, dpi

我的任务是向用户显示其 XPS 文档每一页的缩略图。我需要所有图像都很小，所以我将它们的*dpi*设置为 72.0（我用谷歌搜索了 dpi 72.0 的 A4 纸的尺寸是 635x896）。基本上，我执行以下操作：

```
 List<BitmapImage> thumbnails = new List<BitmapImage>();
        documentPaginator.ComputePageCount();
        int pageCount = documentPaginator.PageCount;
        for (int i = 0; i < pageCount; i++)
        {
            DocumentPage documentPage = documentPaginator.GetPage(i);
            bool isLandscape = documentPage.Size.Width > documentPage.Size.Height;
            Visual pageVisual = documentPage.Visual;
            //I want all the documents to be less or equals to A4
            //private const double A4_SHEET_WIDTH = 635;
            //private const double A4_SHEET_HEIGHT = 896;
            //A4 sheet size in px, considering 72 dpi
            RenderTargetBitmap targetBitmap = new RenderTargetBitmap(
            (int)(System.Math.Min(documentPage.Size.Width, A4_SHEET_WIDTH)),
            (int)(System.Math.Min(documentPage.Size.Height, A4_SHEET_HEIGHT)),
            72.0, 72.0,
            PixelFormats.Pbgra32);
            targetBitmap.Render(pageVisual);
            BitmapFrame frame = BitmapFrame.Create(targetBitmap);
            PngBitmapEncoder encoder = new PngBitmapEncoder();
            encoder.Frames.Add(frame);
            BitmapImage image = new BitmapImage();
            using (System.IO.MemoryStream ms = new System.IO.MemoryStream())
            {
                encoder.Save(ms);
                image.BeginInit();
                image.CacheOption = BitmapCacheOption.OnLoad;
                image.StreamSource = ms;
                if (isLandscape)
                {
                    image.Rotation = Rotation.Rotate270;
                }
                image.EndInit();
            }
            thumbnails.Add(image);
        } 
```

但是当我渲染一个文档页面 (A4) 时，它的大小实际上是**846x1194**，而不是我预期的。我试图使 dpi 更低（48.0）并且图像的尺寸变得更大（我想，我只是不太明白 dpi 是什么以及它如何影响文档）。我尝试制作*dpi=96.0*，尺寸变小了。`BitmapImage`我将上面代码生成的类实例集合中的一个图像设置为`Image`控件的源（我正在创建一个 WPF 应用程序），如果 dpi 设置为 96.0，我的程序如下所示：

![缩略图显示不正确](../Images/9ac934968184d104abef99b0f0f1b4b5.png)
如您所见，部分页面根本没有显示，它不适合`Image`控件，即使控件的大小设置为*635x896*，这就是为什么根据上面的代码，图像必须正确显示并且所有文本必须合适。
简而言之，我期望得到什么结果：我正在尝试创建文档页面的缩略图，但我希望它们相对于某个数字更小（对不起，我不太确定我该怎么说这些东西用英语，基本上如果文档的页面宽度是 1200 像素，我希望它是`1200/n`，其中*n*是我前面提到的“某个数字”），但是如果缩小图像的尺寸仍然大于*635x896*，我希望尺寸为*635x896* .
提前致谢。我也很抱歉我的英语不好。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-10-30T20:11:15.167

首先，DPI 表示每英寸点数，或每英寸像素。如果将 A4 页面（21 x 29.7 厘米）渲染为 72 DPI 的位图，您最终会得到以下大小的位图：

*   宽度 = 21 厘米/（2.54 厘米/英寸）* 72 像素/英寸 = 595 像素
*   高度 = 29.7 厘米/（2.54 厘米/英寸）* 72 像素/英寸 = 842 像素

除此之外，您不必太在意 DPI，但有一个例外：WPF 渲染以 96 DPI 完成。这意味着文档的 A4 大小页面将呈现为 794 x 1123 位图。提醒一句：

*   宽度 = 21 厘米/（2.54 厘米/英寸）* 96 像素/英寸 = 794 像素
*   高度 = 29.7 厘米/（2.54 厘米/英寸）* 96 像素/英寸 = 1123 像素

因此，当 RenderTargetBitmap 包含正好是 A4 的页面时，794 x 1123 应该是它的大小。如果页面大小小于 A4，则位图应该更小。另一方面，如果页面大于 A4，则应将其*缩小*到 794 x 1123。这就是诀窍。您可以将视觉对象放入具有[ScaleTransform的](http://msdn.microsoft.com/en-us/library/system.windows.media.scaletransform.aspx)[ContainerVisual](http://msdn.microsoft.com/en-us/library/system.windows.media.containervisual.aspx)中，而不是将页面视觉对象直接呈现到 RenderTargetBitmap 中，如下所示。

```
for (int i = 0; i < paginator.PageCount; i++)
{
    DocumentPage page = paginator.GetPage(i);
    double width = page.Size.Width;
    double height = page.Size.Height;
    double maxWidth = Math.Round(21.0 / 2.54 * 96.0); // A4 width in pixels at 96 dpi
    double maxHeight = Math.Round(29.7 / 2.54 * 96.0); // A4 height in pixels at 96 dpi
    double scale = 1.0;
    scale = Math.Min(scale, maxWidth / width);
    scale = Math.Min(scale, maxHeight / height);

    ContainerVisual containerVisual = new ContainerVisual();
    containerVisual.Transform = new ScaleTransform(scale, scale);
    containerVisual.Children.Add(page.Visual);

    RenderTargetBitmap bitmap = new RenderTargetBitmap(
        (int)(width * scale), (int)(height * scale), 96, 96, PixelFormats.Default);

    bitmap.Render(containerVisual);

    ...
} 
```

# c++ - 如何使用内置返回类型重载运算符？

> ID：13144618
> 
> 赞同：1
> 
> 时间：2012-10-30T17:36:38.960
> 
> 标签：c++

假设我有一堂课，其中包含一些数学运算。让我们用一个玩具例子

```
class Test
{
public:
   Test( float f ) : mFloat( f ), mIsInt( false ) {}

   float mFloat;
   int   mInt;
   bool  mIsFloat;
}; 
```

我想使用以下原型创建一个运算符重载：

```
float operator=( const Test& test ) 
{ 
    if ( !test.mIsFloat ) return *this; // in this case don't actually do the assignment
    return test.mFloat;                      // in this case do it.
} 
```

所以我的问题是：我可以用内置的返回类型重载 operator= 吗？如果是这样，有没有办法引用内置类型？

我知道如果我用一个类包装内置插件我可以做到这一点。但在这种情况下，我想让赋值运算符与 LHS 上的内置类型一起使用

使用示例：

```
Test t( 0.5f );
float f = t; // f == 0.5
int   i = 0;
i = t;       // i stays 0. 
```

更新：非常感谢您的帮助。从玩具示例中扩展一点，以便人们了解我真正想要做的事情。

我有一个配置系统，允许我从具有不同类型的参数树中获取配置参数（它们可以是整数、浮点数、字符串、数组等）。

我可以通过以下操作从树中获取项目：

```
float updateTime = config["system.updateTime"]; 
```

但是“system.updateTime”可能不存在。或者是错误的类型。通常对于配置，我有一个默认值块，然后代码覆盖配置中的默认值：

```
float updateTime = 10;
const char* logFile = "tmp.log";
... etc etc... 
```

我想做类似的事情：

```
updateTime = config["system.updateTime"]; 
```

如果有覆盖，则操作成功。因此，如果 operator[] 的返回值是树中的“无效”节点，通常不会发生赋值。

现在我用如下函数解决它：

```
getConfig( config, "system.updateTime", updateTime ); 
```

但我更喜欢使用赋值运算符。

如果我愿意创建类来包装内置函数，我可以这样做。

```
class MyFloat
{
   operator=( const Test& test ) { if (test.isValidNode() ) f = test.float(); return *this; }
   float f;
} 
```

但显然最好不要仅仅为了重载分配而用普通类包装内置函数。问题是 - 这在 C++ 中可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T17:45:46.287

根据您的示例，您真正想要的是一个隐式转换运算符：

```
class Test
{
    // ...
public:
    operator float() const;
};

inline Test::operator float() const
{
    return mIsFloat ? mFloat : mInt;
} 
```

如果你想有条件地做作业，那么你需要采取另一种方法。一个命名的方法可能是最好的选择，考虑到所有的事情......像这样：

```
class Test
{
public:
    bool try_assign(float & f) const;
};

inline bool Test::try_assign(float & f) const
{
    if (mIsFloat) {
        f = mFloat;
    }

    return mIsFloat;
} 
```

无论你做什么，都要小心你引入的语法糖不会导致不可读的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T17:51:19.803

您已经有一个从`float`to的隐式转换，`Test`以 convert 构造函数的形式

```
class Test
{
public:
 /* ... */
Test( float f ) : mFloat( f ) /*...*/ {}       

}; 
```

这将支持以下转换：

```
Test t(0.5f); 
```

您可能还需要一个复制赋值运算符，以便进一步进行从`float`到`Test`的隐式转换：

```
class Test
{
public:

    Test& operator=(float f) { mFloat = f; return *this; }  
};

t = 0.75; // This is possible now 
```

为了支持从`Test`到`float`您的隐式转换，请不要使用`operator=`自定义转换运算符，而是这样声明和实现的：

```
class Test
{
public:
  /* ... */
  operator float () const { return mFloat; }
}; 
```

这使得隐式转换成为可能，例如：

```
float f = t; 
```

顺便说一句，您可能甚至没有意识到这里发生了另一个隐式转换。在这段代码中：

```
Test t( 0.5 ); 
```

文字值`0.5`不是 a `float`，而是 a `double`。为了调用 convert 构造函数，这个值必须被转换为`float`，这可能会导致精度损失。要指定`float`文字，请使用`f`后缀：

```
Test t( 0.5f ); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-30T18:42:02.797

**使用模板特化：**

```
class Config {
    template<typename T>
    void setValue(const std::string& index, T& value); //sets the value if available
};

template<float>
void Config::setValue(const std::string& index, float& value){...} //only sets float values

template<int>
void Config::setValue(const std::string& index, int& value){...} //only sets int values; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-30T17:48:24.600

您不能为基本类型“重载/添加”运算符，但可以为您的 type `Type`。但这不应该是`operator =`-`operator >>`就像在`istream`s 中一样。

```
class Test
{
public:
   float mFloat;
   int   mInt;
   bool  mIsFloat;
   Test& operator >> (float& v) { if (mIsFloat) v = mFloat; return *this; }
   Test& operator >> (int& v) { if (!mIsFloat) v = mInt; return *this; }
}; 
```

那么你就可以：

```
int main() {
  float v = 2;
  Test t = { 1.0, 2, false };
  t >> v; // no effect
  t.mIsFloat = true;
  t >> v; // now v is changed
} 
```

**更新**

> 我想做类似的事情：

```
updateTime = config["system.updateTime"]; 
```

然后根据我的建议，您可以：

```
config["system.updateTime"] >> updateTime; 
```

# asp.net-mvc - 在 Linq to EF 中调用方法

> ID：13144619
> 
> 赞同：0
> 
> 时间：2012-10-30T17:36:41.710
> 
> 标签：asp.net-mvc, linq-to-entities, asp.net-mvc-viewmodel

为了创建 ViewModel，我尝试调用 GetName() 方法来查找 UserID 的 FirstName 和 LastName，然后将其添加到模型中。但错误告诉“Linq to Entities 无法识别该方法”。

我如何以另一种方式实现这一目标？

我的代码：

```
public IQueryable<SheetList> GetSheetData()
    {
        var query = from a in GetSheets()
                    select new SheetList
                    {
                        SheetId = a.ListAllSafetySheets.Id,
                        SheetTitle = a.ListAllSafetySheets.SafetySheetTitle,
                        ProductionManagerId = a.ListAllSafetySheets.ProductionManager,
                        ProductionManagerName = this.GetName(a.ListAllSafetySheets.ProductionManager),
                        ConstructionManagerId = a.ListAllSafetySheets.ConstructionManager,
                        Created = a.ListAllSafetySheets.Created,
                        CreatedBy = a.ListAllSafetySheets.CreatedBy,
                        UserProfile_UserId = a.ListAllUserProfiles.UserId,
                        Project_Id = a.ListAllProjects.Id,
                        ProjectLeaderId = a.ListAllProjects.ProjectLeader,
                        ConstructionLocation_Id = a.ListAllConstructionLocations.Id,
                    };
        return query;
    }

public IQueryable<DataCollection> GetSheets()
    {
        var query = from vSafety in _db.Sheets
                    join vUserProfile in _db.UserProfiles
                    on vSafety.Id
                    equals vUserProfile.UserId
                    join vProject in _db.Projects
                    on vSafety.Id
                    equals vProject.Id
                    join vConstructionLocation in _db.ConstructionLocations
                    on vSafety.Id
                    equals vConstructionLocation.Id
                    orderby vSafety.Created descending
                    select new SafetyAndProjectAndUserAndLocationCollection
                    {
                        ListAllSafetySheets = vSafety,
                        ListAllUserProfiles = vUserProfile,
                        ListAllProjects = vProject,
                        ListAllConstructionLocations = vConstructionLocation
                    };
        return query;
    }

public string GetName(int? id)
    { 
        string returnValue;

        if (id == null)
        {
            var userModel = _db.UserProfiles.Single(x => x.UserId == id);

            string FirstName = userModel.FirstName;
            string LastName = userModel.LastName;

            returnValue = FirstName + ", " + LastName;
        }
        else
        {
            returnValue = "";
        }

        return returnValue;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T22:39:45.950

您需要在构建模型后调用该方法。你可以尝试这样的事情：

```
public IQueryable<SheetList> GetSheetData()
{
    var query = from a in GetSheets()
                select new SheetList
                {
                    SheetId = a.ListAllSafetySheets.Id,
                    SheetTitle = a.ListAllSafetySheets.SafetySheetTitle,
                    ProductionManagerId = a.ListAllSafetySheets.ProductionManager,
                    ProductionManagerName = a.ListAllSafetySheets.ProductionManager,
                    ConstructionManagerId = a.ListAllSafetySheets.ConstructionManager,
                    Created = a.ListAllSafetySheets.Created,
                    CreatedBy = a.ListAllSafetySheets.CreatedBy,
                    UserProfile_UserId = a.ListAllUserProfiles.UserId,
                    Project_Id = a.ListAllProjects.Id,
                    ProjectLeaderId = a.ListAllProjects.ProjectLeader,
                    ConstructionLocation_Id = a.ListAllConstructionLocations.Id,
                };

   var queryWithNames = query.ToList().ForEach(s => s.ProductionManagerName = this.GetName(s.ProductionManagerName));

    return queryWithNames;
} 
```

由于您在使用 .ForEach() 时遇到问题，您可以使用常规的 foreach 循环来执行此操作：

```
foreach(var s in query)
{
    s.ProductionManagerName = this.GetName(s.ProductionManagerName);
} 
```

这样做的缺点是对 .ToList 的调用将枚举可查询对象，对数据库执行查询，因此如果您稍后需要在此方法之外进行进一步的过滤，您可能会下载不需要的其他数据，从而导致额外的高架。

# c# - 使用多个连接引入动态限制时的 Linq 查询语法转方法语法

> ID：13144622
> 
> 赞同：1
> 
> 时间：2012-10-30T17:37:03.330
> 
> 标签：c#, linq, entity-framework, linq-to-entities, entities

我正在尝试使用查询关键字将 linq 查询转换为方法语法。我的最终目标是每次在查询中看到**Where**子句时都能够在运行时应用附加限制。我总共有 14 个不同的参数要应用。有些是相互排斥的，有些是包容的。

这是开始的查询：

```
query = from p in context.Person
where p.Firstname.ToUpper().StartsWith(firstName.ToUpper())
join v in context.Visit on p.Id equals v.PersonId
where !v.AccessionNumber.StartsWith(RISConst.PM_PREFIX)
join f in context.Finding on v.Id equals f.VisitId
join c in context.Consultation on f.Id equals c.FindingId
where c.StudyId.ToUpper().CompareTo(studyId.ToUpper()) == 0
select v; 
```

使用 Jon Skeet 的[优秀博客文章](http://msmvps.com/blogs/jon_skeet/archive/2011/01/28/reimplementing-linq-to-objects-part-41-how-query-expressions-work.aspx)，我已经能够做到这一点：

```
query = context.Person.Where(p => p.Firstname.ToUpper().StartsWith(firstName.ToUpper()))
.Join(context.Visit, p => p.Id, v => v.Id, (p, v) => new { p, v })
.Where(z => z.v.AccessionNumber.StartsWith(RISConst.PM_PREFIX))
.Select(z => z.v)
.Join(context.Finding, v => v.Id, f => f.VisitId, (v, f) => new { v, f })
.Select(t => t.f)
.Join(context.Consultation, f => f.Id, c => c.FindingId, (f, c) => new { f, c })
.Where( u => u.c.StudyId.ToUpper().CompareTo(studyId.ToUpper()) == 0)
.Select(????); 
```

现在我被困住了，因为我需要回访。我怎样才能做到这一点 ？

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T17:43:14.523

我认为你迷失`Visists`了这个选择声明：`.Select(t => t.f)`. 删除它并在下一条语句中使用整个匿名对象。

```
.Join(context.Consultation, x => x.f.Id, c => c.FindingId, (x, c) => new { x.v, c })
.Where( u => u.c.StudyId.ToUpper().CompareTo(studyId.ToUpper()) == 0)
.Select(u => u.v); 
```

# ruby-on-rails - 使用 Rails 的 form_for 但设置自定义类、属性 元素？

> ID：13144624
> 
> 赞同：100
> 
> 时间：2012-10-30T17:37:20.123
> 
> 标签：ruby-on-rails, ruby-on-rails-3

`form_for`似乎忽略了任何“额外”属性，如`data-foo`属性或在其第二个参数中`class`传递。`options`

```
= form_for @user, {:url => 'foo', :class => 'x', 'data-bar' => 'baz' } do |f|
  # ... 
```

输出是一个`<form>`没有`x`类或`data-bar`属性的标签。

解决方法是什么？

或者，我如何在`FormBuilder`不使用的情况下获取实例`form_for`？

* * *

## 回答 #1

> 赞同：212
> 
> 时间：2012-10-30T17:44:48.860

使用`:html`哈希：

```
= form_for @user, :html => {:class => 'x', 'data-bar' => 'baz'} do |f| 
```

或者

```
= form_for @user, html: {class: 'x', data: { bar: 'baz' } } do |f| 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2014-08-12T21:32:46.777

Rails 4.0.3，Ruby 2.1.0p0 -> 这对我有用 =>

```
<%= form_for(@contact, :html => {:class => 'form_height'}) do |f| %><% if     @contact.errors.any? %> 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-06-28T07:50:13.837

我遇到了同样的问题，但很困惑我的应用程序中其他地方的另一种形式工作正常。

我意识到我不小心在另一个**form_for中添加了一个****form_for**，一旦删除它就解决了这个问题。

 **其次，我应该补充一点，这种语法在 Rails 4.2 中适用于我：

```
<%= form_for @type, html: {class: "form-horizontal"} do |f| %> 
```

我发现它比此处其他答案的标点符号汤更好（可能基于旧的 Rails 版本）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-30T17:51:22.073

在大多数帮助器上，最后一个 arg 是元素的 html 选项的哈希值。

```
= form_for @user, :html => {:class => 'x', 'data-bar' => 'baz'} %> 
```

您还可以在文档[ActionsView::Helpers::FormHelper中查看其他替代方案](http://api.rubyonrails.org/classes/ActionView/Helpers/FormHelper.html#method-i-form_for)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-10-28T22:40:29.070

我没有运气尝试了上述方法，但找到了解决方案。我正在使用导轨 4.1.6。

这没有用

```
= form_for @user, :html => {:class => 'x', 'data-bar' => 'baz'} %> 
```

这做到了

```
= form_for @user, html: {:class => 'x', 'data-bar' => 'baz'} %> 
```

注意与 html 选项的区别，希望这会有所帮助**

# servicestack - ServiceStack 自定义格式和供应商特定的内容类型

> ID：13144625
> 
> 赞同：3
> 
> 时间：2012-10-30T17:37:21.630
> 
> 标签：servicestack, hypermedia

我正在尝试为 HAL（超文本应用程序语言）添加自定义格式。我创建了我的自定义格式处理程序，我遵循了 ServiceStack v-card 示例，一切正常，我能够将它注册到 ServiceStack。

问题是在我的自定义格式中，我试图指定“hal+json”的内容类型

当我向我的服务发出 GET 请求并指定格式时，如下所示：

'http://mylocalserver:555555/items?format=hal+json'

ServiceStack 默认只使用 Json。我尝试使用我的自定义格式化程序将内容类型更改为不同的内容，例如“halj”和使用“？format = halj”的ServiceStack格式请求。

我拉下 ServiceStack 的源代码，发现其中的任何请求都会检查查询字符串的格式，如果格式甚至包含“json”，它将默认为 Json 格式化程序。

有没有办法解决？我一直在尝试查找一些有关如何覆盖此行为的文档。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T20:15:19.933

不幸`+`的是 url 上有一个特殊的变量。尝试使用 Url 对其进行编码，例如：

```
http://mylocalserver:555555/items?format=hal%2Bjson 
```

# c# - 在派生类中覆盖 Designer 属性

> ID：13144626
> 
> 赞同：1
> 
> 时间：2012-10-30T17:37:24.143
> 
> 标签：c#, winforms, visual-studio-2010

我有一个继承内置类的`System.Windows.Forms.Panel`类。根据`Panel`类的元数据，它有一个名为 的属性`Designer`。我假设这是导致我的派生类默认在表单设计器中打开的原因，而不是代码视图。有没有办法可以覆盖此属性，以便文件在代码视图中打开？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T17:50:09.117

我找到了答案。感谢[Visual Studio：使用属性使视图代码默认](https://stackoverflow.com/questions/1789603/visual-studio-make-view-code-default-using-attribute?rq=1)。

```
[System.ComponentModel.DesignerCategory("")] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T17:39:44.453

您可以在解决方案资源管理器或设计器视图中简单地右键单击并在 VS 中选择“查看代码”。

# android - 扫描接入点 (WifiManager)

> ID：13144629
> 
> 赞同：3
> 
> 时间：2012-10-30T17:37:29.703
> 
> 标签：android

我正在尝试使用类 WifiManager (StartScan) 扫描一些接入点，此扫描发生在触摸事件中，但每次触摸仅进行一次扫描。问题是我需要将此过程设为 10、20 或我想要的次数；但是我不知道我该怎么做。因为我认为一个 for 循环就足够了，但是这种方法对我不起作用。

这是我的 onTouch 方法，我需要每次触摸屏幕时重复 10 次

```
public boolean onTouch(View v, MotionEvent event) { 
// TODO Auto-generated method stub 
WifiManager w = (WifiManager) getSystemService(Context.WIFI_SERVICE);
texto.setLength(0); 
switch (event.getAction()){ 
case MotionEvent.ACTION_DOWN:
texto.append("down"; posx:(double) event.getX(); posy:(double) event.getY();    
w.startScan(); 
break;
}
return false; 
} 
```

我尝试了下一个 for 循环，但没有用

```
for(int i=1;i <= 10;i++){ 
w.startScan();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T18:32:45.357

You need to request the scan and then wait for the results in a BroadcastReceiver , something like this:

```
 BroadcastReceiver receiver_aps = new BroadcastReceiver()
        {
            @Override
            public void onReceive(Context c, Intent intent) 
            {
               List<WifiConfiguration> results = wifiManager.getConfiguredNetworks();
               List<ScanResult> scanResults = wifiManager.getScanResults();   
            }
        };

        IntentFilter filter = new IntentFilter();
        filter.addAction(WifiManager.SCAN_RESULTS_AVAILABLE_ACTION);
        registerReceiver(receiver_aps,filter); 
```

When the Scan has finished you can then request a scan again (in the BroadcastReceiver) keeping a counter to make sure you only do it ten times.

Your current code is requesting 10 scans within the time it takes to complete the initial scan so all subsequent scan requests are ignored.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T18:21:01.177

扫描是一个需要很长时间才能完成的命令。扫描时忽略其他扫描命令。

scan 在所有 2.4GHz 和 5GHz 通道（一次一个）中发送探测并等待答案。
为什么需要连续发出 10 次扫描？

# c# - 在 C# 中使用 SMO 备份 SQL Server 数据库

> ID：13144631
> 
> 赞同：0
> 
> 时间：2012-10-30T17:37:32.483
> 
> 标签：c#, sql-server, sql-server-2008-r2, smo

我正在开发一个简单的实用程序，它将`*.bak`从 SQL Server 数据库创建一个文件。

如果数据库的大小非常小，小于 50 Mb，那么没有问题，它运行良好。但我可能会使用 2-3Gb 数据大小的大型数据库。

由于（我猜）不可能在内存中保存如此大的数据来创建`*.bak`文件，我的实用程序在这种情况下还能工作吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T19:49:35.433

是的，您的实用程序仍可用于 2 -3 Gb 大小的数据库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T22:47:43.093

Yes! behind the scene Sql Server Management Studio uses smo models for it`s tasks such as backup and restoring. it can handle backups so also you can do your job using smo functionality.

# file - 在运行 Windows 的两台非联网 PC 之间进行实时文件传输的建议

> ID：13144633
> 
> 赞同：0
> 
> 时间：2012-10-30T17:37:47.783
> 
> 标签：file, transfer

解释这个问题：我使用 SCADA 系统。主控制屏幕在未连接到 Internet 的 Windows XP 系统上运行。我们希望保持这种状态，以避免病毒和陷入麻烦的用户。

我们想弄清楚如何允许用户在不将这台计算机连接到互联网的情况下远程查看该系统的屏幕（即从连接互联网的智能手机或 PC）。

我们附近有另一台运行 Windows 7 x64 的计算机，它已连接到互联网。

我曾尝试使用 IrDA 将屏幕截图从 Windows XP 计算机传输到 7 计算机，但连接有问题 - 不可靠。

我们需要某种方式在两台计算机之间发送屏幕截图（我已经编写了一个脚本来以定义的时间间隔捕获屏幕）。这种方法需要使用命令行实用程序而不是 GUI 来实现，因为它需要自动化。

到目前为止我的想法： - IrDA（没有工作，即使花了几个小时对驱动程序进行故障排除等） - 串行端口（找不到用于传输文件的命令行实用程序） - 蓝牙（这可能是要走的路但是除非 fsquirt 可以，否则我找不到命令行实用程序） - 以太网/无线 - 无法工作 - 将计算机暴露在互联网上 - 火线 - 与以太网相同 - USB-to-USB - 找不到命令line utility - 专有技术（尚未发现任何东西！）

我是否以错误的方式处理这个问题？非常感谢任何建议，想法，见解！

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T17:44:42.257

为什么不将计算机设置在本地网络上，并且不为其提供默认网关？或者在两台计算机之间建立一个本地 VPN。您只需要在 Windows 7 电脑中安装第二个网卡，以便它能够与主计算机通信。

您还可以在 XP 计算机上使用防火墙来阻止所有未绑定到本地网络的流量。

只是几个想法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T15:58:26.313

好的，我只是想描述一下我对问题的解决方案，以防它使其他人受益。

我决定尝试使用蓝牙文件传输，因为它是无线的并且使用不会妨碍的微型 USB 加密狗。这是我配置此设置并使一切正常的方式。

为此，您需要购买支持 1) Microsoft 蓝牙堆栈和 2) 对象推送 (OPP) 和 FTP 配置文件的蓝牙加密狗。我的选择是 Targus ACB10US1 (http://www.targus.com/US/productdetail.aspx?sku=ACB10US1) 该设备基于支持 WIDCOMM（包括在内）和 Microsoft 蓝牙堆栈的 Broadcom 芯片组。

我想将屏幕截图从 Windows XP 32 位机器发送到 Windows 7 x64 机器。

在 XP 机器（Sender）上，安装了以下项目：

1.  Targus ACB10US1 USB 蓝牙适配器（请勿安装 WIDCOMM/Broadcom 驱动程序！）
2.  Microsoft 蓝牙堆栈和驱动程序（我使用了来自[http://bluetoothinstaller.com](http://bluetoothinstaller.com)的简易安装程序）。
3.  BluetoothInstaller.com 的蓝牙命令行工具 (http://bluetoothinstaller.com/bluetooth-command-line-tools/)
4.  Irfanview 4.33 (http://irfanview.com)

在 Windows 7（收件人）机器上，安装了以下项目：

1.  Targus ACB10US1 USB 蓝牙适配器（使用 WIDCOMM 驱动程序，其中包括支持对象交换/ftp 配置文件的 WIDCOMM/Broadcom 蓝牙堆栈）将文件传输文件夹配置到将保存屏幕截图的所需文件夹。
2.  HFS 网络服务器：[http](http://www.rejetto.com/hfs/) ://www.rejetto.com/hfs/ 配置为提供从 Sender 计算机接收的屏幕截图文件。
3.  每 x 分钟更新一次 ddns 地址的 powershell 脚本

发送第一个文件时，请确保允许 Receiver 接收来自 Sender 的所有文件，而无需提示。

为了在 Sender 上截取屏幕截图，我使用了 IrfanView 的命令行模式和自定义的 i_view32.ini 文件。此 ini 文件将当前时间/日期添加到屏幕截图的左下角。

这是[i_view32.ini 文件](http://hilltop.net/ryan/i_view32.ini)

这是在 Sender PC 上连续运行 IrfanView 以截取屏幕截图并使用 btftp 将文件“shot1.jpg”传输到 Receiver PC的[批处理文件。](http://hilltop.net/ryan/screenshot.bat)

这种方法似乎工作正常，但是传输非常慢（因此在 screenshot.bat 文件中不需要“等待”循环。）每次传输需要 30-45 秒以上。我认为蓝牙发送代码中存在某种超时，而不是实际上需要很长时间才能发送大约。100kB 文件。

可选功能：

在 Receiver PC 上为原始图像创建一个 HTML 包装文件，具有自动刷新等功能，并使用 HFS 提供此文件。

我希望这可以帮助别人。如果您有任何问题，请告诉我。

# graphite - 石墨碳ceres保养

> ID：13144635
> 
> 赞同：1
> 
> 时间：2012-10-30T17:37:54.240
> 
> 标签：graphite

我将[Carbon Graphite](http://graphite.wikidot.com/)与 Ceres 数据库后端一起使用。我很难弄清楚如何让 dedrag 工作以巩固切片。

我尝试了以下方法，但出现了一个相当奇怪的错误：

```
$ /opt/graphite/bin/ceres-maintenance --configdir=/opt/graphite/conf/carbon-daemons/example/ defrag
/opt/graphite/storage/ceres/ is not inside a CeresTree 
```

有没有人有任何见识？网络上似乎很少有这方面的内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T02:26:03.777

两种可能：

1.  数据目录的默认位置由 --root 指定。所以，指定它。也就是说，可能是 /opt/datastore/ceres/ （或不是）。

2.  如果您确定指向正确的 --root，请确保您没有丢失 .ceres-tree 目录 (mkdir /opt/datastore/ceres/.ceres-tree/)

把它们放在一起：

/opt/graphite/bin/ceres-maintenance --configdir=/opt/graphite/conf/carbon-daemons/example --root=/opt/datastore/ceres/

可选地，您可以添加 --daemon 和 --logdir=/tmp/mydefrag.log

# c - 将 struct var 分配给函数的 retval 时出现“不兼容的类型”

> ID：13144642
> 
> 赞同：0
> 
> 时间：2012-10-30T17:38:26.923
> 
> 标签：c, function, types, struct, return

我有一个返回结构（不是结构指针）的函数，但是当尝试将返回值设置为相同类型的结构变量时，我得到“不兼容的类型”。

这是结构定义和函数实现的样子：

```
typedef struct{
    int ssn;
    char FirstName[12];
    char LastName[12];
    int income;
} MyRecord;

MyRecord parseNextRecord()
{
    MyRecord record;
    // parse and initialize
    return record;
} 
```

这是我从我的主要功能中调用它：

```
MyRecord nextRecord;
nextRecord = parseNextRecord(); // "error: incompatible types in assignment" 
```

真的为这件事难住了。在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T17:52:31.450

在没有看到头文件的情况下，可能的原因是`main()`没有看到`parseNextRecord()`导致编译器为其生成隐式声明的函数声明，返回类型为`int`. 这将导致*不兼容的分配*错误，因为无法将 an 分配`int`给 a `MyRecord`。要解决，请在头文件中添加声明：

```
extern MyRecord parseNextRecord(); 
```

# html - 使用 yahoo 管道发布数据

> ID：13144646
> 
> 赞同：2
> 
> 时间：2012-10-30T17:38:48.257
> 
> 标签：html, http-post, yahoo-pipes, mashup

我想在我的混搭中包含一个 Wordle ( [wordle.net) 。](http://www.wordle.net)但是 wordles 需要通过 post: [wordle.net/advanced](http://www.wordle.net/advanced)发送数据。

有没有办法使用 Yahoo Pipes 通过 POST 发送数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-30T15:26:09.330

终于找到了解决方案......虽然我不确定管道，但我不再是朋友了。

管道：[http ://pipes.yahoo.com/pipes/pipe.info?_id=de24ea125f4fe90d9394d15c5c03e776](http://pipes.yahoo.com/pipes/pipe.info?_id=de24ea125f4fe90d9394d15c5c03e776)

推特搜索很简单，然后使用正则表达式将推文连接成一个长字符串。

该字符串附加了一个表单标签 - 在数据之前打开，然后是提交并在之后关闭。

![正则表达式是使用字符串生成器构建的。](../Images/07402a6aac1917d226917cd264bdadfc.png)

将结果放入返回的单个项目的标题中，以便 RSS 的标题包含我们要显示的表单。最终用户必须手动提交表单，但可以安排一点 javascript 和 CSS 糖衣。

不过，它不是很好地使用管道 - 最后，管道可以很好地进行搜索，并且可以说是连接。然后，它应该被另一个进程消耗，该进程可以生成更好看的表单，或者甚至更好，通过加载 Java Applet 直接显示 wordle。

# perl - 如何计算 Perl 中文本字符串出现的次数？

> ID：13144647
> 
> 赞同：1
> 
> 时间：2012-10-30T17:38:52.253
> 
> 标签：perl, text-manipulation

我正在尝试计算文本字符串的出现次数。

下面的 Perl 代码在找到某些类型的文件时打印一条语句（文本字符串），我需要计算它打印字符串的次数。

```
elsif ($elt =~ /DELETE_.+\.XML/) {
    print "  <-- Delete XMLs !!";
} 
```

我只是想学习 perl 而我不是程序员！所以请解释任何答案。

我不想插入、排序或合并，只是计数。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-30T18:52:42.507

如果要计算目录中名称匹配的所有文件`/DELETE_.+\.XML/`，我会这样做：

1.  打开目录。
    在 Perl 中，这是通过

    ```
    opendir my $directory, "path/to/dir" or die "Error while opening: $!"; 
    ```

    然后，`$directory`是一个表示该目录*句柄*的变量。

2.  获取目录中的所有文件。
    在 Perl 中，我们可以使用以下`readdir`函数：

    ```
    my @files = readdir $directory; 
    ```

    这会将其所有内容读`$directory`入一个*名为*`@files`.

3.  选择与模式匹配的所有文件。
    在 Perl 中，您可以选择满足特定条件的元素`grep`：

    ```
    my @interesting_files = grep {/DELETE_.+\.XML/} @files;
    #  ^--output                 ^--a  condition--^ ^--source 
    ```

    我们将条件括在花括号内。它可以包含任意代码，但我们将在这里放置一个正则表达式。`grep`是一种数据过滤器。

4.  我们计算`@interesting_files`.
    Perl 有一个*上下文*的概念。有*标量上下文*和*列表上下文*。函数和变量的行为各不相同。如果在标量上下文中使用数组，则返回该数组中的元素数。我们可以使用函数强制标量上下文`scalar`：

    ```
    my $count = scalar @interesting_files; 
    ```

这共同构成了以下代码：

```
opendir my $directory, "path/to/dir" or die "Error while opening: $!";
my @files = readdir $directory;
my @interesting_files = grep {/DELETE_.+\.XML/} @files;
my $count = scalar @interesting_files; 
```

如果我们省略不必要的变量并使用隐式上下文，这可以简化为以下两行。

```
opendir my $directory, "path/to/dir" or die "Error while opening: $!";
my $count = grep {/DELETE_.+\.XML/} readdir $directory; 
```

但是，请注意，`$count`只有在我们离开封闭块 ( `{...}`) 之前它才可见。如果您需要`$count`在此块之外，则必须在使用它的最外层*范围内**声明*它。或者，您根本不使用，但这有缺点。`my`*`my`*

 ** * *

真正优雅的解决方案使用以下`glob`功能：

```
my $count =()= glob "DELETE_*.XML"; 
```

这将手动目录打开抽象化，并使用 Unix shell 熟悉的通配语法。这些*不是*传统的正则表达式！`=()=`伪运算符可以读作*count-* of 。它在右侧强加列表上下文，但允许左侧具有标量上下文。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T17:46:25.500

```
elsif ($elt =~ /DELETE_.+.XML/) { 
   print " <-- Delete XMLs !!";
   $count++;   # Count number of times string is printed
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T17:46:27.300

以下应计算匹配行：

```
use strict;
use warnings;

my $count = 0;

for (<>) {
  $count++ if /line-matches/;
}

print "count: $count\n"; 
```

如果将其放在文件 count.pl 中，则可以将其运行为：

```
perl count.pl file1 file2 file3 ... 
```

如果您需要在管道中使用它，它也应该可以工作：

```
ls *.XML | perl count.pl 
```*

# facebook - 无法创建 Facebook 对象

> ID：13144648
> 
> 赞同：1
> 
> 时间：2012-10-30T17:38:53.333
> 
> 标签：facebook, firefox

在我的 index.php 中，我创建了一个 Facebook 对象并使用它来获取用户 ID。

```
$facebook = new Facebook(array(
'appId' => FACEBOOK_APP_ID,
'secret' => FACEBOOK_SECRET,
'cookie' => true
)); 
```

我也提出了一些 API 请求，一切都很好。

现在我切换到另一个子页面（events.php - 与 index.php 基本相同）。但是在这里我无法访问 USER ID

```
$user = $facebook->getUser(); 
```

它始终为 0。正如我所说，创建 Facebook 对象的命令是相同的 - 只是另一个网页作为 index.php。

//edit - 刚刚发现这不仅仅是我之前认为的 Firefox 问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T18:39:44.037

确保将 $facebook 会话变量传递给新页面 (events.php)。返回 0 表示没有登录用户，因此会话没有被实例化。 [https://developers.facebook.com/docs/reference/php/facebook-getUser/](https://developers.facebook.com/docs/reference/php/facebook-getUser/)

以下是一些更有用的文档，解释了如何使用 Facebook PHP SDK 获取当前用户/会话：[https ://developers.facebook.com/blog/post/503/](https://developers.facebook.com/blog/post/503/)

# c# - 在代码中使用 [Serializable()]

> ID：13144650
> 
> 赞同：1
> 
> 时间：2012-10-30T17:39:06.430
> 
> 标签：c#, xml

> **可能重复：**
> [我什么时候应该在 C# 中使用 [Serializable]？](https://stackoverflow.com/questions/5877808/when-should-i-use-serializable-in-c)

当我们处理序列化时，在类的开头（命名空间之后和类之前）使用 [Serializable()] 有多重要？

我正在查看以下示例：

```
namespace MyObjSerial
{
    [Serializable()]    //Set this attribute to all the classes that you define to be serialized
    public class Employee : ISerializable
    {
        public int EmpId;
        public string EmpName;

        //Default constructor
        public Employee()
        {
            EmpId = 0;
            EmpName = null;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T17:54:18.770

# **二进制序列化**[高度自动化]

使类型**Binary Serializable的两种方法**

> {如果你想用 XML 序列化这不是你想要的}

实施`ISerializable`使您可以完全控制序列化

**或者**

使用类似的属性`serialzable`，`nonSerialized`以及各种其他属性。使用`serialzable`属性指示序列化程序包含类型中的所有字段，包括`private,`公共`but not`属性`

* * *

# **XML 序列化**[自动化程度较低]

我猜你想`XML`在那种情况下序列化类

使**XML 类型可序列化的两种方法**

使用`System.Xml.Serialization`属性

**或者**

实施`IXmlSerializer`更多控制

* * *

# 你的问题

> 当我们处理序列化时，在类的开头（命名空间之后和类之前）使用 [Serializable()] 是否重要

Ofcorse ..这就是你要告诉编译器序列化那些特定类型的方式。但是你应该根据类应该序列化的内容来使用属性或接口。

因此，使用`[Serializable()]`属性将类型序列化为`XML`行不通。它用于**二进制序列化**。您应该在类上撒上属性`System.Xml.Serialization attributes`或`IXmlSerializer`用于**XML 序列化**

您可以使用

```
1>Data Contract Serializer
2>Binary Serializer
3>Xml Serializer 
```

# extjs - Extjs表单继承

> ID：13144655
> 
> 赞同：0
> 
> 时间：2012-10-30T17:39:20.783
> 
> 标签：extjs

我在这里遇到了一些概念问题。

我必须为我的每张桌子写一个搜索窗口。此窗口仅在组合框内容（要搜索的字段名称）和网格列（结果）中有所不同。

extjs 中最好的方法是什么：

1.  编写一个基本窗口并在子类中定义组合列和网格列。
2.  为每个窗口写一个不同的类？

特别是我更喜欢第一个选项，但我坚持从子类配置此属性。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T18:06:47.540

这里的答案可能取决于可重用代码的数量与您需要自定义的代码量。

如果您可以将 70-80% 的通用可重用代码放在那里，您可以构建一个所有其他人都将扩展的基类。然后每个特定的类将扩展这个基类并自定义其余部分。您可以通过编写一组从 initComponent 调用的函数来构建您的窗口，从而提高自定义的难度。然后每个子类将只覆盖将其与基类区分开来所必需的函数。

如果可重用代码的数量要高得多，例如 90%+，那么最好编写一个类，然后在实例化期间传入单独的配置覆盖，如下所示：

```
Ext.create('MySearchView', { title:'My Custom title', fieldSelector:myComboConfig}); 
```

此外，浏览示例代码，您可能会发现有趣的重用案例。

# html - DNN 使用的 HTML5 对象（代码库，代码类型已弃用）

> ID：13144656
> 
> 赞同：0
> 
> 时间：2012-10-30T17:39:24.220
> 
> 标签：html, object, embed, dotnetnuke

这很可能是一个非常非常愚蠢的问题。所以我道歉；所以我有一个客户不希望以 .ascx 格式创建 Dot Net Nuke 皮肤。所以无论如何，出于某种奇怪的原因，我偶然发现了一个两难境地。

因此，在 Dot Net Nuke 中，您可以简单地执行以下操作：

```
<object id = "Name" codebase = "Name" codetype = "dotnetnuke/server" >
<!-- Whatever code parameters you want here -->
</object> 
```

但是，当您使用 HTML 5 时，您不能再使用代码库或代码类型，因为它们已经被贬值了。如果我只是这样做：

```
<object id="Name" data="Dot Net Nuke Control" type="dotnetnuke/server" > 
```

这基本上会做同样的事情吗？本质上，DNN 使用 codetype 属性来自动解析，就好像它是 Flash 电影、mp3 或其他任何东西一样。避免用 XML 来定义对象。

还是我必须使用标签？因为我知道我可以做到：

```
<embed src="link to DNN Control" type="dotnetnuke/server"> 
```

但是我会丢失 id，标识符。此外，我什至不确定它是否会正确解析，因为它必须作为原始对象处理。

我完全迷路了吗？想太多？与概念概念混淆在一起。无论如何，一个解释会很棒。我本质上是在尝试模仿上面的第一个代码示例。我试图完成的所有标准的一个例子是：

```
<object id="dnnNAV" codebase="NAV" codetype="dotnetnuke/server">
            <param name="ProviderName" value="DDRMenuNavigationProvider">
            <param name="IndicateChildren" value="false">
            <param name="ControlOrientation" value="Horizontal">
            <param name="CSSControl" value="mainMenu">
</object> 
```

任何建议和解释都会很棒。我正在努力学习我发誓。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T05:57:42.260

格雷格，

@Ryan 说，尝试使用`html5`对象方法，`codetype = "dotnetnuke/server"`如果您没有取得进展，请在此处发布您的问题！

# c# - 如何使用 WMI/ADSI 和 C# 在 IIS 中启用/禁用/获取身份验证扩展保护状态？

> ID：13144657
> 
> 赞同：2
> 
> 时间：2012-10-30T17:39:26.170
> 
> 标签：c#, iis-7, iis-7.5, wmi, adsi

有人可以提供一个代码示例或资源，可以帮助我以编程方式**获取状态、启用和禁用**使用 C# 在 IIS 7/IIS 7.5 中对身份验证的扩展保护吗？

带有 WMI/ADSI 的 C# 是首选。

即我被要求使用 C# 使用**System.Management** API 或**Microsoft.Web.Administration** API，我需要确定是否**在 Web 服务器级别启用了 EAP**（作为所有未来网站的 Web 服务器默认设置）。

也欢迎使用 C# 的任何其他解决方案。

期待有帮助的答案。谢谢

史蒂夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T04:01:41.977

微软[慷慨地提供了一个网页](http://support.microsoft.com/kb/973917)，它不仅解释了这个新概念（即，身份验证的扩展保护，flag=extendedProtection），还提供了几种语言的示例代码（复制如下）。这是他们在 IIS7/7.5 中启用 EAP 的 C# 代码。

通过 WMI 实现这一点需要使用显式凭据并设置 impersonationLevel=Impersonate。Frank White 最近在 SO 上创建了另一种方法，我在这里详细介绍了它的完整代码：[https ://stackoverflow.com/a/11948096/1569434](https://stackoverflow.com/a/11948096/1569434)

```
using System;
using System.Text;
using Microsoft.Web.Administration;

internal static class Sample
{
   private static void Main()
   {
      using (ServerManager serverManager = new ServerManager())
      {
         Configuration config = serverManager.GetApplicationHostConfiguration();

         ConfigurationSection windowsAuthenticationSection = config.GetSection("system.webServer/security/authentication/windowsAuthentication", "Default Web Site");
         windowsAuthenticationSection["enabled"] = true;

         ConfigurationElement extendedProtectionElement = windowsAuthenticationSection.GetChildElement("extendedProtection");
         extendedProtectionElement["tokenChecking"] = @"Allow";
         extendedProtectionElement["flags"] = @"None";

         ConfigurationElementCollection extendedProtectionCollection = extendedProtectionElement.GetCollection();

         ConfigurationElement spnElement = extendedProtectionCollection.CreateElement("spn");
         spnElement["name"] = @"HTTP/www.contoso.com";
         extendedProtectionCollection.Add(spnElement);

         ConfigurationElement spnElement1 = extendedProtectionCollection.CreateElement("spn");
         spnElement1["name"] = @"HTTP/contoso.com";
         extendedProtectionCollection.Add(spnElement1);

         serverManager.CommitChanges();
      }
   }
} 
```

# objective-c - 子类 NSViewController 或 NSView

> ID：13144659
> 
> 赞同：2
> 
> 时间：2012-10-30T17:39:33.493
> 
> 标签：objective-c, macos, appkit

我需要一个包含滑块和按钮等控件的视图，并具有彩色背景。我不确定是子类`NSView`还是`NSViewController`. 我以为我可以子类`NSView`化并绘制自定义背景并在 xib 中布局控件，并将出口设置为`NSView`子类。

有些按钮需要切换，例如播放/暂停按钮，我认为这个逻辑应该在 中完成`NSView`，并`NSViewController`在按钮切换时得到通知，而不是`NSViewController`必须自己管理切换。

但是当我去创建一个`NSView`子类时，创建 a 的选项`xib`是灰色的，只有`NSViewController`. 所以我必须在上面有插座`NSViewController`吗？

我想要`myView.playPauseButton`，但似乎我必须拥有`myViewController.playPauseButton`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T18:03:33.080

> 我需要一个包含滑块和按钮等控件的视图，并具有彩色背景。我不确定是继承 NSView 还是 NSViewController。我想我可以继承一个 NSView 并绘制一个自定义背景并在 xib 中布局控件，并将出口设置为 NSView 子类。

如果要使用xib，则必须使用`NSViewController`子类；这就是它的用途，除其他外。

一般来说，对于您想要做的事情（将几个控件捆绑在一起），`NSViewController`是要使用的类。

你也可以从 Model-View-Controller 模式（即视图控制器和视图的来源）的角度来看这一点：视图与事物的外观有关；控制器与用户交互（以及与模型的交互）有关。

您当然可以`NSView`通过编程方式或在 IB 中定义一个子类并定义其内容（将滑块和按钮作为子视图添加到其中），但我认为它没有多大优势，除非您要提供一种特定的控制。

编辑：

您在评论中声明您希望使用自定义的 IB 定义`NSView`的`NSSplitView`. 这使事情更加情境化。

现在，像往常一样，有许多设计选项，例如，您可以定义自己的选项，`MySplitController`允许您指定应该从中加载拆分视图的子视图的 nib。

但是，如果我正确理解您的目标，您想做的是在 xib 中定义一个 NSView 并在 NSSplitView 中使用它，就像它是 IB 允许的默认视图类型之一一样。

[Interface Builder Plug-ins](http://cocoadev.com/wiki/InterfaceBuilderPlugins)允许这样做。不幸的是，Xcode 4 似乎不再支持它们。

然后我看到的唯一选择是定义一个子类`NSView`，例如，`MyCustomView`然后在其`initWithFrame:`方法中加载 xib 文件，识别您在其中定义的视图，并将其添加为子视图。

具体来说，您可以使用此代码加载 xib 文件顶级对象，其中将找到您的自定义视图：

```
NSNib *nib = [[[NSNib alloc] initWithNibNamed:@"MyView" bundle:nil] autorelease];
NSArray *topLevelObjects;
if (![nib instantiateWithOwner:customViewOwner topLevelObjects:&topLevelObjects]) {
    //- handle error
}

MyView *myView = nil;
for (id topLevelObject in topLevelObjects) {
  if ([topLevelObject isKindOfClass:[MyView class]) {
    myView = topLevelObject;
    break;
  }
} 
```

为了简化事情，您可以让这个 xib 文件只定义您的自定义 NSView 和无处不在的文件所有者（这是将视图集成到应用程序其余部分的链接）。

如您所见，我正在传递一个`customViewOwner`to `instantiateWithOwner`：这将是您的主视图控制器或应用程序委托，负责响应来自自定义视图的所有操作并在需要时设置其状态。此类将是您的 xib 的文件所有者，因此要进行真正的模块化设计，最好`MyCustomViewController`在特定项目中定义您的子类。

一旦你定义了这样一个自定义的 NSView 子类，那么将它集成到你的 NSSplitView 中唯一需要做的就是将 NSSplitView 的子视图类设置为`MyCustomView`.

这不像使用 IB 插件那么简单，但它可以很好地用于集成在不同 xib 文件中定义的视图。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-30T17:44:21.883

最好将 NSViewController 子类化并使用 xib 初始化或在代码中手动布局子视图。根据我的经验，子类化 NSView 从来没有按照我想要的方式进行，包括您正在寻找的实现。

# jquery - 如何使用 jQuery 在多个 ID 上设置属性？

> ID：13144664
> 
> 赞同：5
> 
> 时间：2012-10-30T17:39:50.913
> 
> 标签：jquery

我有以下代码：

```
 $('#loginLink, #registerLink')
            .attr('data-disabled') === 'yes' 
```

我正在尝试在 ID 上设置 data-disabled 属性，但它似乎不起作用。我使用正确的 jQuery 吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-30T17:41:48.900

您应该这样设置值：

```
$('#loginLink, #registerLink').attr('data-disabled', 'yes'); 
```

由于数据是一个属性，您可以使用`data`方法来代替：

```
$('#loginLink, #registerLink').data('disabled', 'yes'); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-30T17:41:41.240

您可以像这样设置属性的值：

```
$('#loginLink, #registerLink').attr('data-disabled','yes'); 
```

要检索这样存储的值，您可以：

```
$('yourselector').attr('data-disabled'); 
```

或者

```
$('yourselector').data('disabled'); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-30T17:42:15.863

通常在 jQuery 中，任何属性都应该设置如下：

```
$(<selector>).attr("<attr name>", "<attr value>"); 
```

希望这可以帮助！！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-30T17:42:18.567

`$('#loginLink, #registerLink').attr('data-disabled','yes')`

也许？我不熟悉该属性，但这就是它们通常的属性。

# mysql - MySQL：如何检查 varbinary 类型中的特定值？

> ID：13144665
> 
> 赞同：1
> 
> 时间：2012-10-30T17:39:50.550
> 
> 标签：mysql, varbinary, sql-like

我正在使用一个表，该表有一个名为 other_group_ids 的字段，其类型为 varbinary(255)。它的一个示例值是：3,7,14。我有一个查询来检查用户是否在某个组中。例如，要检查他们是否在第 4 组中，我对其进行 LIKE：

```
SELECT user.* FROM users AS user WHERE user.other_group_ids LIKE '%4%'; 
```

这工作得很好，但问题是它也在 14 上流行。如何更改我的查询以使其仅匹配 4，而不是其他值，如 14 或 41？

非常感谢您的任何见解！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T17:48:58.787

要回答您的问题，您可以执行以下操作：

```
SELECT user.* FROM users AS user 
WHERE user.other_group_ids LIKE '%,4,%' OR
    user.other_group_ids LIKE '4,%' OR
    user.other_group_ids LIKE '%,4' 
```

请注意，具有多个值的列未标准化，如果可能，您应该尝试修复此问题。要规范化，请创建一个名为`user_group`has`user`和的表`group`。主键将是`(user, group)`并且将充当参考表。然后您可以简单地查询组 4 中的用户。

# python - Python IF 查询

> ID：13144667
> 
> 赞同：2
> 
> 时间：2012-10-30T17:40:18.713
> 
> 标签：python, if-statement

我正在尝试制作一个计算入场费用的程序。我已经设法做到了，除了一个需要两个成人和三个孩子的部分，那么费用是 15 美元。这是否应该使用 if 语句来完成，我该怎么做？

```
import math 

loop = 1
choice = 0
while loop == 1:

    print "Welcome"

    print "What would you like to do?:"
    print " "
    print "1) Calculate entrance cost"

    print "2) Leave swimming centre"
    print " "

    choice = int(raw_input("Choose your option: ").strip())
    if choice == 1:
        add1 = input("Adults: ")
        add2 = input("Concessions: ")
        add3 = input("Children: ")
        print add1, "+", add2, "+", add3, "answer=", add1 *5 + add2 *3 + add3 *2   
    elif choice == 2:
        loop = 0 
```

提前感谢您的任何帮助，我们将不胜感激！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T17:48:15.927

您应该为特殊情况放置一个 if 语句，即您有 2 个成人，3 个孩子。否则你应该正常计算。我已经评论了发生这种特殊情况的区域。

此代码还假设特殊情况不影响优惠的价格。

```
import math 

loop = 1
choice = 0
while loop == 1:

    print "Welcome"

    print "What would you like to do?:"
    print " "
    print "1) Calculate entrance cost"

    print "2) Leave swimming centre"
    print " "

    choice = int(raw_input("Choose your option: ").strip())

    if choice == 1:
        add1 = input("Adults: ")
        add2 = input("Concessions: ")
        add3 = input("Children: ")

        cost = 0

        # special case for 2 adults, 3 children
        if add1 == 2 and add3 == 3:
            cost += 15
        else:
            cost += add1*5 + add3*2

        # concession cost
        cost += add2 *3

        print add1, "+", add2, "+", add3, "answer=", cost

    elif choice == 2:
        loop = 0 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T01:19:11.780

```
import math 

choice = 0
while True:

    print """
       Welcome

       What would you like to do?:

       1)Calculate entrance cost
       2) Leave swimming centre
      """

   choice = int(raw_input("Choose your option: ").strip())
   if choice == 1:
       add1 = input("Adults: ")
       add2 = input("Concessions: ")
       add3 = input("Children: ")
       print add1, "+", add2, "+", add3, "answer=", add1 *5 + add2 *3 + add3 *2   
   elif choice == 2:
       break 
```

# android - 将 float[] 转换为 android.graphics.Matrix

> ID：13144671
> 
> 赞同：1
> 
> 时间：2012-10-30T17:40:35.313
> 
> 标签：android, rotational-matrices

我正在开发一个 android 应用程序，我需要将 9 个元素的浮点数组转换为 android.graphics.Matrix 类型的对象。float 数组表示 SensorManager.getRotationMatrix(...) 返回的旋转矩阵。我想使用这个浮点数组将其转换为 android.graphics.Matrix 以在 canvas.drawBitmap(Bitmap, Matrix, Paint) 中使用。

如何将浮点数组的值设置为 Matrix 对象？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T17:49:19.217

来自 Android 文档：

[`setValues`](http://developer.android.com/reference/android/graphics/Matrix.html#setValues%28float%5B%5D%29)

# java - 如何在类路径上查找资源文件的目录树？

> ID：13144676
> 
> 赞同：3
> 
> 时间：2012-10-30T17:40:48.260
> 
> 标签：java, spring

我在类路径上有一组资源，大致如下：

```
com/example/foo
    r1.txt
    r2.txt
    r3.txt
    bar/
      b1.txt
      b2.txt
      baz/
       x.txt
       y.txt 
```

我知道这个包位于 WEB-INF lib 中的类路径上，我希望能够遍历从 com.example.foo 开始的类路径以查找所有 .txt 文件。使用 siganutre 调用类似于以下内容的函数。

列出文件 = findFiles("com/example/foo","*.txt");

我使用的是 spring 3.1，所以我很乐意使用 spring 中的任何方法。

**更新：** 使用下面基于 Spring 的 @jschoen 建议的解决方案：

```
PathMatchingResourcePatternResolver resolver = new PathMatchingResourcePatternResolver();
Resource[] resources = resolver.getResources("classpath:com/example/foo/**/*.txt"); 
```

弹簧匹配使用蚂蚁风格的图案，因此需要双 **

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T17:53:32.673

如果我没记错的话，你可以使用[Reflections 库。](http://code.google.com/p/reflections/)

```
public static void main(String[] args) {
    Reflections reflections = new Reflections(new ConfigurationBuilder()
    .setUrls(ClasspathHelper.forPackage("your.test.more"))
    .setScanners(new ResourcesScanner()));

    Set<String> textFiles = reflections.getResources(Pattern.compile(".*\\.txt"));

    for (String file : textFiles){
        System.out.println(file);
    }
} 
```

不管你放什么包，你只需要一个开始，它会找到所有其他的。

编辑：Spring 中似乎还有[PathMatchingResourcePatternResolver](http://static.springsource.org/spring/docs/3.0.x/api/org/springframework/core/io/support/PathMatchingResourcePatternResolver.html#getResources%28java.lang.String%29)可以使用。它有一个[`getResources(String locationPattern)`](http://static.springsource.org/spring/docs/3.0.x/api/org/springframework/core/io/support/PathMatchingResourcePatternResolver.html#getResources%28java.lang.String%29)我假设你可以使用传递模式`".*\\.txt"`并且会以相同的方式工作。我所在的位置没有 Spring 设置，否则我会自己进行测试。

# android - 使用后置摄像头计算场景亮度

> ID：13144680
> 
> 赞同：2
> 
> 时间：2012-10-30T17:40:53.447
> 
> 标签：android, image-processing, android-camera, luminance

我正在使用三星 Galaxy Tab 10.1" 在 Android 上构建应用程序。我想使用设备的后置摄像头获取场景亮度的值。

不幸的是，我找不到直接从设备背面的光传感器获取读数的方法。因此，我目前通过计算每个灰度帧的平均值来手动估计亮度。但是，由于帧曝光和白平衡的自动校正，这种方法是不准确的。例如，如果您将相机对准一个非常亮的光源，相机将使整个图像变暗，并且灰度帧的平均值将太低（因为明亮光源之外的区域现在将非常暗）。

我搜索了允许我禁用我提到的自动更正的方法，但没有找到任何东西。

有没有一种方法可以让我使用后置摄像头获取场景亮度的值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T02:41:12.157

不幸的是，您是正确的，目前无法从 Android 相机 API 获取此数据。

根据您的设备，您可能能够捕获图片，然后从中读取 EXIF 数据。这可能会让您看到曝光（ISO 和快门速度）。这是[Tiny Light Meter](http://tinycouch.com/tinylightmeter/#compatibility)等应用程序使用的方法。问题是某些设备没有完全填充 EXIF 数据，所以这种方法是命中注定的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-09T04:57:09.767

在某些设备（仅限较新的 Android）中，支持点测光。您可以使用由单独的计时器线程（如 AsyncTask）触发的 JPEG 回调，然后读取将测量到选择点的 EXIF 信息。要检查这是否可用，您可以使用：

```
//on Event Touch callback on your SurfaceView
x=event.getX();
y=event.getY();
params=camera.getParameters();
... //check for rotation, calculate focus point (x, y: -1000, 1000)
if(params.getMaxNumMeteringAreas() > 0){
    //draw a meter area, however big you want, 1000 is weight (0-1000)
    Camera.Area ca=new Area(new Rect(x-25, y-25, x+25, y+25), 1000);
    List<Camera.Area> areas=new ArrayList<Area>();
    areas.add(ca);
    params.setFocusAreas(areas);
    params.setMeteringAreas(areas);
    camera.setParameters(params);
}else{
    //process the Bitmap and do the below...
} 
```

在较旧的设备上（如果您想要向后兼容），您仍然可以设置一个焦点（存储在您的代码中），然后与 EXIF 值相比，对该焦点周围的像素进行平均（我使用 6% 的宽度和高度） （如果它更暗，降低曝光等）。为此，您可能需要使用一键式按钮（因为旧设备在执行 JPEG 回调时会滞后）。

```
average=((r+g+b)/3-128)/256
myEV=myEV+myEV*average 
```

***使用这两种方法，只需确保您正在阅读的图像正确旋转（您可以通过将其放入 ImageView 并将其与预览进行比较来检查）。***

从 EV，您可以相对容易地转换为 Lux 或 Foot Candles（或任何您喜欢的测量值）。

# java - 创建 HashMap 的不同方法

> ID：13144685
> 
> 赞同：15
> 
> 时间：2012-10-30T17:41:12.877
> 
> 标签：java, hashmap

我最近一直在学习 HashMaps，但我有一个问题似乎无法得到明确的答案。之间的主要区别 -

```
HashMap hash1 = new HashMap(); 
```

对比

```
HashMap<,>hash1 = new HashMap <,> (); //Filled in with whatever Key and Value you want. 
```

我认为当您定义 HashMap 时，它需要键和值。任何帮助将非常感激。谢谢你。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-10-30T18:09:47.877

这些是您拥有的选项：

J2SE <5.0 风格：

```
 Map map = new HashMap(); 
```

J2SE 5.0+ 风格（使用[泛型](http://en.wikipedia.org/wiki/Generics_in_Java)）：

```
 Map<KeyType, ValueType> map = new HashMap<KeyType, ValueType>(); 
```

[Google Guava](http://code.google.com/p/guava-libraries/)风格（更短更灵活）：

```
 Map<KeyType, ValueType> map = Maps.newHashMap(); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-10-30T17:47:11.863

你应该看看[Java generics](http://docs.oracle.com/javase/tutorial/java/generics/)，如果你不指定 HashMap 的类型，键和值都是`Object`类型。

因此，如果您想要一个带有`Integer`键和`String`值的 HashMap，例如：

```
 HashMap<Integer, String> hashMap= new HashMap<Integer, String>(); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-30T17:52:04.000

通过启用编译时类型强制执行，指定`key`和`value`类型可以提高类型安全性。

这样可以更轻松地编写不会意外混淆键和值类型的代码，并减少必须在代码中显式声明的强制转换数量。

但是，重要的是要知道这些类型检查仅在编译时进行，即一旦应用程序运行，JVM 将允许您对键和值使用任何类型。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-30T18:02:01.397

**-** `Generics`可以隐含到类、接口、方法、变量等。但使用它的**最重要原因**是使`Collection` **类型更安全**。

**-** `Generics`确保只有特定类型的**对象进入和退出**。`Collections`

**-**此外，值得一提的是，有一个过程称为`Erasure`，

->`Erasure`是一个过程，其中`type parameters`和**由编译器从泛型类和接口**`type arguments`中删除，使其与**没有**泛型编写的代码**兼容。**

 ******所以，

`HashMap<String, Integer> map = new HashMap<String, Integer>();`

变成`Raw type`,

`HashMap map = new HashMap();`******

# css - 多个背景 css3：2 个重复的 x 图像，每个占容器的一半

> ID：13144697
> 
> 赞同：1
> 
> 时间：2012-10-30T17:41:56.013
> 
> 标签：css, background-image, background-repeat

我有这个：http: [//jsfiddle.net/MAJZz/](http://jsfiddle.net/MAJZz/)

我想要的是红鱼停在容器的一半，绿鱼从那里开始直到结束。换句话说，红色的鱼应该覆盖（从 0 到 50% 水平），而绿色的鱼应该覆盖（从 50% 到 100% - 相同，水平）。

这是我的html：

```
<div></div> 
```

这是我的CSS：

```
div {
    background: url(http://a0.twimg.com/profile_images/88812997/Redfish_facebook_normal.jpg) repeat-x, url(http://icons.iconarchive.com/icons/fasticon/fish-toys/16/Green-Fish-icon.png) repeat-x;
    position: absolute;
    top: 10px;
    left: 10px;
    width: 500px;
    height: 100px;
} 
```

可能吗 ？

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T22:15:26.567

我认为你可以在伪类之后和之前使用，如果你真的只需要两个背景，

```
div:before {
    background: url(http://a0.twimg.com/profile_images/88812997/Redfish_facebook_normal.jpg) repeat-x;
    position:absolute;
    left:0;
    width:250px;
    height:100px;
    content:"";
}
div {
    position: absolute;
    top: 10px;
    left: 10px;
    width: 500px;
    height: 100px;
}
div:after {
    position:absolute;
    width:250px;
    height:100px;
    right:0;
    top:0;
    background:url(http://icons.iconarchive.com/icons/fasticon/fish-toys/16/Green-Fish-icon.png) 50% top repeat-x;
    content:""
} 
```

# cuda - 为什么 cublasGetVector 得到这个结果？

> ID：13144698
> 
> 赞同：1
> 
> 时间：2012-10-30T17:41:59.223
> 
> 标签：cuda, cublas

很难理解数组（维度）是如何在 cublas 中组织的。做了以下测试，但输出无法解释。谢谢你的帮助！

```
include <stdio.h>
include <stdlib.h>
include <cublas.h>

define DIMX 5
define DIMY 5
define ROW 2
define COL 3

typedef int TYPE;

void print_matrix(TYPE * v)
{
    int i,j;
    for (i=0; i<DIMX; i++)
    {
        for (j=0; j<DIMY; j++) printf("%5d ",v[i*DIMY+j]);
        printf("\n");
    }
}

    int main()
    {
        printf("Hello world!\n");

        int i;
        //Initialize the array
        TYPE v[DIMX*DIMY];
        for (i=0; i<DIMX*DIMY; i++) v[i]=i+1;
        printf("Before:\n");
        print_matrix(v);

        //Cublas part
        cublasInit();
        int *cv;
        cublasAlloc(DIMX*DIMY,sizeof(TYPE),(void**)&cv);
        cublasSetMatrix(ROW,COL,sizeof(TYPE),v,DIMX,cv,DIMY);
        //cublasGetVector(DIMX*DIMY,sizeof(TYPE),cv,1,v,1);
        cublasGetVector(DIMX*DIMY,sizeof(TYPE),cv,DIMX,v,DIMX);
        cublasFree(cv);
        cublasShutdown();

        printf("After:\n");
        print_matrix(v);
        return 0;
    } 
```

输出：

你好世界！之前：1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 之后：1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T22:22:04.220

您遇到的第一个问题是您没有进行错误检查。如果您进行错误检查，您会发现调用 cublasGetVector 时出现映射错误。其次，您需要查看[cublas 调用的 API 定义](http://docs.nvidia.com/cuda/cublas/index.html#topic_5_8). 在您调用 cublasSetMatrix 时，对于第一个矩阵的前导维度，您有 DIMX，而对于第二个矩阵的前导维度，您有 DIMY。两者都应该是 DIMX。这并不重要，因为您正在处理方阵。您的 cublasGetVector 调用的问题是您正在为 inc 参数传递 DIMX 和 DIMY，这导致此复制操作超出 GPU 内存中矩阵 cv 的末尾。如果要根据 ROW 和 COL 参数捕获左上角元素，则应该为增量值传递 1。这是一些我认为您想要的代码，并显示了错误检查的示例：

```
#include <stdio.h>
#include <stdlib.h>
#include <cublas.h>
#include <helper_cuda.h>

#define DIMX 5
#define DIMY 5
#define ROW 2
#define COL 3

typedef int TYPE;

#define cublasCheckErrors(fn) \
    do { \
        cublasStatus_t __err = fn; \
        if (__err != CUBLAS_STATUS_SUCCESS) { \
            fprintf(stderr, "Fatal error: %s (at %s:%d)\n", \
                _cudaGetErrorEnum(__err), \
                __FILE__, __LINE__); \
            fprintf(stderr, "*** FAILED - ABORTING\n"); \
            exit(1); \
        } \
    } while (0)

void print_matrix(TYPE * v)
{
    int i,j;
    for (i=0; i<DIMX; i++)
    {
        for (j=0; j<DIMY; j++) printf("%5d ",v[i*DIMY+j]);
        printf("\n");
    }
}

    int main()
    {
        printf("Hello world!\n");

        int i;
        //Initialize the array
        TYPE v[DIMX*DIMY];
        for (i=0; i<DIMX*DIMY; i++) v[i]=i+1;
        printf("Before:\n");
        print_matrix(v);

        //Cublas part
        cublasCheckErrors(cublasInit());
        int *cv;
        cublasCheckErrors(cublasAlloc(DIMX*DIMY,sizeof(TYPE),(void**)&cv));
        cublasCheckErrors(cublasSetMatrix(ROW,COL,sizeof(TYPE),v,DIMX,cv,DIMX));
        //cublasGetVector(DIMX*DIMY,sizeof(TYPE),cv,1,v,1);
        cublasCheckErrors(cublasGetVector(DIMX*DIMY,sizeof(TYPE),cv,1,v,1));
        cublasCheckErrors(cublasFree(cv));
        cublasCheckErrors(cublasShutdown());

        printf("After:\n");
        print_matrix(v);
        return 0;
    } 
```

您需要使用如下命令编译它：

```
g++ -I/usr/local/cuda/include -I /usr/local/cuda/samples/common/inc -L/usr/local/cuda/lib64 -lcublas -o t24 t24.cpp 
```

这假设您安装了标准 CUDA 5，并且您在标准位置安装了 cuda 5 示例。这使我可以为 cublas 选择一个方便的错误解析器：_cudaGetErrorEnum()

通过这些更改，我得到如下结果：

```
Hello world!
Before:
    1     2     3     4     5
    6     7     8     9    10
   11    12    13    14    15
   16    17    18    19    20
   21    22    23    24    25
After:
    1     2     0     0     0
    6     7     0     0     0
   11    12     0     0     0
    0     0     0     0     0
    0     0     0     0     0 
```

另请注意，您只是部分填充了 cv，但将 cv 的所有内容复制回 v。这意味着在 After: 结果中我上面有零的地方，您可以有任何数字。因此，您应该将 cv 的所有元素初始化为某个值。我的 After: 结果显示非零的 2 列和 3 行，因为尽管您有一个参数 ROW，但您在 cublasSetMatrix 调用中将其传递到错误的位置。cublas API 通常期待以列为主形式的东西，这是对行主形式（典型的 C 或 C++ 形式）的索引的反转。

# javascript - 我可以在 .ajax() 调用中加载 2 个 xml 文档吗

> ID：13144700
> 
> 赞同：0
> 
> 时间：2012-10-30T17:42:10.117
> 
> 标签：javascript, jquery

我想知道我是否可以在 jquery.ajax() 调用中解析 2 个不同的 xml 文档。我能够解析 1 个单个 xml 文件，但现在我想将其扩展为 2 个 xml 文档。那可能吗？这是我为 1 个 xml 文件所做的事情

```
 $.ajax({
            type: "GET",
            url: "sample5.xml",
            dataType: "xml",
            async: false,
            error: function() {
                alert("XML file not found");
            },
            success:function(xml) {   
                     alert("Success");
             };
          }); 
```

现在上面的url只有sample5.xml，我想再加载一个xml文件说sample6.xml，我可以这样做吗？如果是，那怎么办？

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T17:43:32.510

没有办法通过一个请求获取两个文件。

您进行第二次 Ajax 调用以获取该文档。

一种方法是使用[$.when()](http://api.jquery.com/jQuery.when/)

```
$.when($.ajax("/file1.xml"), $.ajax("/file2.xml")).done(function(xhr1,  xhr2){
   console.log(xhr1); 
   console.log(xhr2); 
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T18:26:11.693

简单的方法是将 xml 值存储在一个对象中，然后在 jquery 中使用 .parseXML() 函数。通过这种方式，我可以解析 N 个 xml 对象。

# c++ - Bool：cout 的错误输出不是 0 或 1

> ID：13144701
> 
> 赞同：0
> 
> 时间：2012-10-30T17:42:12.397
> 
> 标签：c++, boolean, cout

我有一个读取请求的函数：按时间戳、当前楼层和目标楼层，它没有按我预期的方式输出。

我所有的成员值都正确输出：时间戳、当前楼层和目标楼层，布尔值除外。

对于我的方向，布尔输出 205 而不是 1 或 0。

```
Elevator::readRequests()

{
  ifstream myStream("T1.txt");

while(!myStream.eof())
{
    int timestamp ,currentFloor, destinationFloor;

    myStream >> timestamp >> currentFloor >> destinationFloor;
    //cout<< endl <<"The current timestamp is "<< timestamp << "The current floor is " << currentFloor 
    //  << " and the destination floor is " << destinationFloor << endl << endl;
    //cout<< endl;

    reqNode *temp = new reqNode;

    //initialize request node object
    temp->timestamp = timestamp;
    temp->start = currentFloor;
    temp->destination = destinationFloor;
    temp->start_time = -1;
    temp->finish_time = -1;

    temp->calculate_priority();

    if(temp->start < temp->destination)
        temp->set_dir(true);
    else
        temp->set_dir(false);

    request.push(*temp);//push nodes into the request bank
}
int i = 0;
while( !request.empty() )
{

    cout << "Node " << i << " : " << request.front().timestamp << " " <<    request.front().start << " " << request.front().destination
        << " " <<  request.front().direction << endl;

    request.pop();//popping the request in order to test
    i++;
}

} 
```

我正在尝试获取输出：

节点#：时间戳。当前（用户楼层）。目的地（用户楼层）。方向（用户正在前进）。

```
Node 0 : 1 3 7 1
Node 1 : 1 2 9 1
Node 2 : 1 7 9 1
Node 3 : 2 4 6 1
Node 4 : 2 4 8 1
Node 5 : 2 1 17 1
Node 6 : 5 1 15 1
Node 7 : 5 5 1 0
Node 8 : 6 17 4 0
Node 9 : 6 4 17 1 
```

相反，我得到了输出：

```
Node 0 : 1 3 7 205
Node 1 : 1 2 9 205
Node 2 : 1 7 9 205
Node 3 : 2 4 6 205
Node 4 : 2 4 8 205
Node 5 : 2 1 17 205 
Node 6 : 5 1 15 205
Node 7 : 5 5 1 205
Node 8 : 6 17 4 205
Node 9 : 6 4 17 205 
```

这是文件 T1.txt：

```
1 3 7
1 2 9
1 7 9
2 4 6
2 4 8
2 1 17
5 1 15
5 5 1
6 17 4
6 4 17 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T17:48:05.473

`205`是`0xCD`。这通常意味着您正在使用未初始化的变量。

根据原始问题中的代码，您需要`direction`在`reqNode`. 根据输出，它没有被复制。

此外，由于您的向量似乎是`vector<reqNode>`，因此您不需要将临时分配`reqNode`给`new`. 只需在堆栈上创建它并将其传递给`requests.push_back`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T18:34:35.373

`request.push(*temp)`复制`temp`指向的对象。作为风格问题，您应该在执行此操作后删除指针，因为不再需要该对象。更好的是，将其创建为自动对象而不是新建它。C++ 不是 Java。

由于存储的副本与原始副本具有不同的值，因此表明复制构造函数的复制`reqNode`不正确。

# objective-c - 以编程方式获取 UIButton

> ID：13144718
> 
> 赞同：0
> 
> 时间：2012-10-30T17:43:03.557
> 
> 标签：objective-c, xcode, uibutton

我想以编程方式更改 UIButton，这可能吗？没有任何互动。

我可以以某种方式获取视图中的对象吗？如果我能得到它们，我可以遍历它们并得到我想要的 UIButton 并将其更改为我想要的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T17:52:53.767

是的，这是可能的。

如果您正在处理动态数量的按钮，那么您需要使用标签。插入您的`UIButton`（通过 Interface Builder 或以编程方式）时，您可以为其分配一个标签。如中，`view.tag = 6`。这意味着您可以从超级视图中拉出按钮的特定实例。

在实践中，您通常会通过以下方式添加按钮：

```
UIButton* btn = [UIButton alloc] initWithFrame:...];
....
[self.view addSubview:btn]; 
```

附加步骤是分配标签（如何跟踪标签取决于您）。

```
btn.tag = 44; 
```

为了再次访问它，我可以从我的视图中提取它。

```
UIButton* btn = (UIButton*)[self.view viewWithTag:44]; 
```

这会产生与我最初创建的相同的实例。

如果你想替换它，你只需删除旧的，然后创建+添加新的。

```
[btn removeFromSuperview];
UIButton* btn2 = [UIButton alloc] initWithFrame:...];
...
[self.view addSubview:btn2]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T17:50:33.133

您可以使用引用插座选项卡部分将您的按钮从 xib 链接到其控制器。然后，您将获得对按钮的引用，因此您不必遍历所有子视图。只需选择您的 xib 并打开侧面实用程序菜单。选择您的按钮并单击实用程序菜单上的连接检查器。单击“新参考插座”旁边的圆圈并将其拖动到控制器的 .h 文件中。

# wcf - .NET4.0 和 .NET4.5 之间 WCF 跟踪中的回归

> ID：13144721
> 
> 赞同：0
> 
> 时间：2012-10-30T17:43:18.213
> 
> 标签：wcf, .net-4.0, .net-4.5

我的 app.config 中有以下设置：

```
 <system.diagnostics>
    <sources>
      <source name="System.ServiceModel" switchValue="Off,ActivityTracing" propagateActivity="true">
        <listeners>
          <add type="System.Diagnostics.DefaultTraceListener" name="Default">
            <filter type="" />
          </add>
          <add name="ServiceModelTraceListener">
            <filter type="" />
          </add>
        </listeners>
      </source>
      <source name="System.ServiceModel.MessageLogging" switchValue="ActivityTracing">
        <listeners>
          <add type="System.Diagnostics.DefaultTraceListener" name="Default">
            <filter type="" />
          </add>
          <add name="ServiceModelMessageLoggingListener">
            <filter type="" />
          </add>
        </listeners>
      </source>
    </sources>
    <sharedListeners>
      <add initializeData="c:\temp\log.svclog" type="System.Diagnostics.XmlWriterTraceListener, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" name="ServiceModelTraceListener" traceOutputOptions="Timestamp">
        <filter type="" />
      </add>
      <add initializeData="c:\temp\log.svlog" type="System.Diagnostics.XmlWriterTraceListener, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" name="ServiceModelMessageLoggingListener" traceOutputOptions="Timestamp">
        <filter type="" />
      </add>
    </sharedListeners>
  </system.diagnostics> 
```

（注意第`switchValue="Off,ActivityTracing"`3 行）

这正如我在 .NET3.5、.NET4.0 中所期望的那样工作（没有进行日志记录）。但是，当我更新到 .NET4.5 时，日志正在被填满！

我在任何地方都找不到这种行为的原因。是虫子吗？或者我的错误假设并且它根据我在 .NET4.0 中的需要工作是我的错误？

谢谢！

# sharepoint-2010 - InvalidOperationException：由于对象的当前状态，操作无效

> ID：13144723
> 
> 赞同：1
> 
> 时间：2012-10-30T17:43:21.443
> 
> 标签：sharepoint-2010

我正在尝试在添加新项目但获得关注时更新项目安全性。如何从这个跟踪中找到问题？

```
InvalidOperationException: Operation is not valid due to the current state of the object.]
   Microsoft.SharePoint.SPListItem.InitSecurity() +26790031
   Microsoft.SharePoint.SPListItem.get_SecurableObjectImpl() +16
   Microsoft.SharePoint.SPSecurableObject.get_RoleAssignments() +10
   Updateroutine.<>c__DisplayClass2.<updatelistpermission>b__0() +1955
   Microsoft.SharePoint.<>c__DisplayClass4.<RunWithElevatedPrivileges>b__2() +729
   Microsoft.SharePoint.Utilities.SecurityContext.RunAsProcess(CodeToRunElevated secureCode) +27947702
   Microsoft.SharePoint.SPSecurity.RunWithElevatedPrivileges(WaitCallback secureCode, Object param) +27648393
   Microsoft.SharePoint.SPSecurity.RunWithElevatedPrivileges(CodeToRunElevated secureCode) +93 
```

这是我的功能，

```
private static void updatelistpermission(Header objEntity, SPListItem lstItem,string strStatus)
        {

            SPUserToken token = lstItem.Web.Site.SystemAccount.UserToken;

            try
            {

                SPSecurity.RunWithElevatedPrivileges(delegate()
                {

                    using (SPSite site = new SPSite(lstItem.Web.Site.ID, token))
                    {
                        site.AllowUnsafeUpdates = true;
                        using (SPWeb web = site.OpenWeb(lstItem.Web.ID))
                        {
                            web.AllowUnsafeUpdates = true;
                            lstItem.BreakRoleInheritance(false); 

                            SPRoleDefinition roleUserDefintion = null;
                            SPRoleDefinition roleSupervisorDefintion = null;
                            SPRoleDefinition roleOpManagerDefintion = null;

                            if (strStatus == "Active")
                            {
                                roleUserDefintion = web.RoleDefinitions.GetByType(SPRoleType.Contributor);
                                roleSupervisorDefintion = web.RoleDefinitions.GetByType(SPRoleType.Reader);
                                roleOpManagerDefintion = web.RoleDefinitions.GetByType(SPRoleType.Reader);
                            }
                            else if (strStatus == "Submitted")
                            {
                                roleUserDefintion = web.RoleDefinitions.GetByType(SPRoleType.Reader);
                                roleSupervisorDefintion = web.RoleDefinitions.GetByType(SPRoleType.Contributor);
                                roleOpManagerDefintion = web.RoleDefinitions.GetByType(SPRoleType.Contributor);
                            }
                            else if (strStatus == "Completed")
                            {
                                roleUserDefintion = web.RoleDefinitions.GetByType(SPRoleType.Reader);
                                roleSupervisorDefintion = web.RoleDefinitions.GetByType(SPRoleType.Reader);
                                roleOpManagerDefintion = web.RoleDefinitions.GetByType(SPRoleType.Reader);
                            }

                            SPUser uParticipant = Utility.convertStringToSPUser(Utility.getSPStringLookupFromListGLT(objEntity.Participant));
                            SPRoleAssignment roleUserAssignment = new SPRoleAssignment(uParticipant);

                            SPUser uSupervisor = Utility.convertStringToSPUser(Utility.getSPStringLookupFromListGLT(objEntity.Supervisor));
                            SPRoleAssignment roleSupervisorAssignment = new SPRoleAssignment(uSupervisor);

                            SPUser uOpManager = Utility.convertStringToSPUser(Utility.getSPStringLookupFromListGLT(objEntity.OpsManager));
                            SPRoleAssignment roleuOpManagerAssignment = new SPRoleAssignment(uOpManager);

                            roleUserAssignment.RoleDefinitionBindings.Add(roleUserDefintion);
                            lstItem.RoleAssignments.Add(roleUserAssignment);

                            roleSupervisorAssignment.RoleDefinitionBindings.Add(roleSupervisorDefintion);
                            lstItem.RoleAssignments.Add(roleSupervisorAssignment);

                            roleuOpManagerAssignment.RoleDefinitionBindings.Add(roleOpManagerDefintion);
                            lstItem.RoleAssignments.Add(roleuOpManagerAssignment);

                            lstItem.Update();
                            web.AllowUnsafeUpdates = false;
                        }
                    }
               });
            }
            catch (SPException spex)
            {
                SPDiagnosticsService.Local.WriteTrace(0, new SPDiagnosticsCategory("APP", TraceSeverity.Unexpected, EventSeverity.Error), TraceSeverity.Unexpected, spex.Message , "");
            }
        } 
```

**@Dmitry Kozlov 建议的新代码，但仍然是相同的错误**

```
try
                {
                    {
                        SPUserToken token = SPContext.Current.Web.Site.SystemAccount.UserToken;

                        SPSecurity.RunWithElevatedPrivileges(delegate()
                        {
                            using (SPSite site = new SPSite(SPContext.Current.Web.Site.ID, token))
                            {
                                site.AllowUnsafeUpdates = true;

                                using (SPWeb web = site.OpenWeb(SPContext.Current.Web.ID))
                                {
                                    web.AllowUnsafeUpdates = true;
                                    web.BreakRoleInheritance(true);
                                    web.AllowUnsafeUpdates = true;

                                    SPList lstProject = web.Lists["SharedSurveyHeader"];
                                    SPListItem lstItem = lstProject.Items.Add();
                                    loadToListItem(sharedHeader, ref lstItem, true);
                                    updatelistpermission(web, sharedHeader, lstItem, strStatus);
                                    lstItem.Update();
                                    objWeb.AllowUnsafeUpdates = false;
                                    intResult = lstItem.ID;
                                    lstItem = null;
                                    lstProject = null;
                                }
                            }
                        });

                    }

                 }

private static void updatelistpermission(SPWeb web, SharedSurveyHeader objEntity, SPListItem lstItem,string strStatus)
        {
             try
            {

                            SPRoleDefinition roleUserDefintion = null;
                            SPRoleDefinition roleSupervisorDefintion = null;
                            SPRoleDefinition roleOpManagerDefintion = null;

                            if (strStatus == "Active")
                            {
                                roleUserDefintion = web.RoleDefinitions.GetByType(SPRoleType.Contributor);
                                roleSupervisorDefintion = web.RoleDefinitions.GetByType(SPRoleType.Reader);
                                roleOpManagerDefintion = web.RoleDefinitions.GetByType(SPRoleType.Reader);
                            }
                            else if (strStatus == "Submitted")
                            {
                                roleUserDefintion = web.RoleDefinitions.GetByType(SPRoleType.Reader);
                                roleSupervisorDefintion = web.RoleDefinitions.GetByType(SPRoleType.Contributor);
                                roleOpManagerDefintion = web.RoleDefinitions.GetByType(SPRoleType.Contributor);
                            }
                            else if (strStatus == "Completed")
                            {
                                roleUserDefintion = web.RoleDefinitions.GetByType(SPRoleType.Reader);
                                roleSupervisorDefintion = web.RoleDefinitions.GetByType(SPRoleType.Reader);
                                roleOpManagerDefintion = web.RoleDefinitions.GetByType(SPRoleType.Reader);
                            }

                            SPUser uParticipant = Utility.convertStringToSPUser(Utility.getSPStringLookupFromListGLT(objEntity.Participant));
                            SPRoleAssignment roleUserAssignment = new SPRoleAssignment(uParticipant);

                            SPUser uSupervisor = Utility.convertStringToSPUser(Utility.getSPStringLookupFromListGLT(objEntity.Supervisor));
                            SPRoleAssignment roleSupervisorAssignment = new SPRoleAssignment(uSupervisor);

                            SPUser uOpManager = Utility.convertStringToSPUser(Utility.getSPStringLookupFromListGLT(objEntity.OpsManager));
                            SPRoleAssignment roleuOpManagerAssignment = new SPRoleAssignment(uOpManager);

                            roleUserAssignment.RoleDefinitionBindings.Add(roleUserDefintion);
                            lstItem.RoleAssignments.Add(roleUserAssignment);

                            roleSupervisorAssignment.RoleDefinitionBindings.Add(roleSupervisorDefintion);
                            lstItem.RoleAssignments.Add(roleSupervisorAssignment);

                            roleuOpManagerAssignment.RoleDefinitionBindings.Add(roleOpManagerDefintion);
                            lstItem.RoleAssignments.Add(roleuOpManagerAssignment);

            }
            catch (SPException spex)
            {

            }
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T19:14:11.290

尝试从您以提升的权限打开的 Web 获取列表项并使用它：

```
SPSecurity.RunWithElevatedPrivileges(delegate()
{
    using (SPSite site = new SPSite(lstItem.Web.Site.ID, token))
    {
        site.AllowUnsafeUpdates = true;
        using (SPWeb web = site.OpenWeb(lstItem.Web.ID))
        {
           web.AllowUnsafeUpdates = true;

           // Get list item here:
           var newListItem = web.GetListItem(itemUrl);
           ...
        }
    }
} 
```

# cakephp - 在error.log中记录了奇怪的错误

> ID：13144724
> 
> 赞同：3
> 
> 时间：2012-10-30T17:43:30.437
> 
> 标签：cakephp, cakephp-2.1

当我刷新我的网站时，我在 tmp/logs/error.log 中记录了以下错误：

```
2012-10-30 18:38:50 Error: [MissingControllerException] Controller class JsController could not be found.
#0 /var/www/mysite/app/webroot/index.php(92): Dispatcher->dispatch(Object(CakeRequest), Object(CakeResponse))
#1 {main} 
```

这很奇怪，因为 web 服务运行良好，一切正常，我在网站上没有收到任何错误。

我的问题是如何跟踪此错误以找到原因？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-30T17:47:39.397

看起来 JS 文件从您的项目或您正在使用的插件（DebugKit 或其他东西）返回 404。打开 firebug (Net-Tab) 并确保所有文件看起来都像他们应该的那样..

希望有帮助

# java - 数组列表中的 NullPointerException

> ID：13144727
> 
> 赞同：1
> 
> 时间：2012-10-30T17:43:32.870
> 
> 标签：java, arraylist, nullpointerexception

我的学业有问题，希望我能在这里得到一些帮助！显然在第 17 行有一个 nullpointerexception 错误。

```
import java.util.*;
import java.text.*;
public class Librarian {
    private ArrayList<Book> bookList = new ArrayList<Book>();

    public Librarian() {
        bookList = new ArrayList<Book>();
    }
    public ArrayList<Book> findBooksWrittenBy(ArrayList<Book> bookList, String author) {
        ArrayList<Book> booksByAuthor = new ArrayList<Book>();
        for(int i = 0; i < bookList.size(); i++) {
            Book book = bookList.get(i);
            String author1 = book.getAuthor();
            if(author1.equalsIgnoreCase(author)) {
                booksByAuthor.add(book);
            }
            if(booksByAuthor.size() != 0) {
                booksByAuthor = booksByAuthor;
            }else {
                booksByAuthor = null;
            }
        }
        return booksByAuthor;
    } 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-30T17:51:57.560

将检查放在 for 循环之外的作者。然后，检查大小并立即返回，将对象分配给自身是多余的。

如下：

```
 public ArrayList<Book> findBooksWrittenBy(ArrayList<Book> bookList, String author) {
    ArrayList<Book> booksByAuthor = new ArrayList<Book>();
    for(int i = 0; i < bookList.size(); i++) {
        Book book = bookList.get(i);
        String author1 = book.getAuthor();
        if(author1.equalsIgnoreCase(author)) {
            booksByAuthor.add(book);
        }
    }
    if(booksByAuthor.size() > 0) {
        return booksByAuthor;
    }else {
       return null;
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-02-20T17:52:17.887

更短更好：

```
public List<Book> findBooksWrittenBy(ArrayList<Book> bookList, String author) {
    List<Book> booksByAuthor = new ArrayList<Book>();
    for(Book b: bookList) {
        if(author.equalsIgnoreCase(b.getAuthor) {
            booksByAuthor.add(book);
        }
    }
    return booksByAuthor;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-30T17:54:26.223

似乎您的第一次迭代工作正常，它将在第二次迭代中将数据添加到 booksByAuthor 对象，它不为零，因此它在您的代码中设置为 null。

建议 ：

```
public ArrayList<Book> findBooksWrittenBy(ArrayList<Book> bookList, String author) {
    ArrayList<Book> booksByAuthor = new ArrayList<Book>();
    for(int i = 0; i < bookList.size(); i++) {
        Book book = bookList.get(i);
        String author1 = book.getAuthor();
        if(author1.equalsIgnoreCase(author)) {
            booksByAuthor.add(book);
        }

    }
    return booksByAuthor;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-30T17:55:41.400

我想可能当 i=0 时， bookList(0).getAuthor() 和 author 参数之间不匹配，这不会在您的 booksByAuthor 列表中添加任何书。所以 else 语句将被执行并且结果 booksByAuthor 被设置为空。

然后当 i=1 时，您在导致 NPE 的空对象上调用了一个方法。

# python - 在python中应用位掩码

> ID：13144728
> 
> 赞同：1
> 
> 时间：2012-10-30T17:43:37.287
> 
> 标签：python, binary, bitmask

我想对 python 中的变量应用位掩码以找出设置了哪些位。我一直在尝试，但还没有找到正确的方法。我的变量是二进制的，为了显示它的值，我使用了函数 hexlify()：

```
 corr = fh.read(1)
    mac = fh.read(6)[-3:]
    print "corr "+ hexlify(corr) 
```

不，我无法将位掩码应用于 corr：

```
 print hexlify(corr&0x01) 
```

它说

```
TypeError: unsupported operand type(s) for &: 'str' and 'int' 
```

但这是为什么呢？任何帮助，将不胜感激！非常感谢你！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T17:46:14.697

因为 corr 是一个字符串，它需要一个 int

```
print hexlify(int(corr)&0x01) # if corr is like "12352"
print hexlify(ord(corr)&0x01) #if corr is like "\x##"

>>> ord("\x10")
16
>>> ord("\x10")&0x01
0 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T18:24:40.330

现在，我不喜欢这样，但它似乎有效：

```
print (int(hexlify(corr),16))&0x01 
```

这会将 corr 转换为十六进制字符串，该字符串在应用掩码之前再次转换为整数，基数为 16 ..... 任何有关我如何解决此问题的提示，否则将不胜感激。谢谢！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T19:04:12.453

由于`corr`来自

```
corr = fh.read(1) 
```

我想您想读取一个字节，然后继续读取该字节的值。

然后你应该使用`ord()`and `chr()`：

```
if corr: # it could as well be empty!
    print "corr "+ hexlify(chr(ord(corr) & 0x01)) 
```

`ord()`为您获取该字节的字节值，您可以对其进行处理，然后，如`hexlify()`预期的那样，将其重新转换为单字节字符串。

# android - Android 4 UrlConnection setReadTimeout 不适用于 VPN 连接

> ID：13144731
> 
> 赞同：2
> 
> 时间：2012-10-30T17:43:40.967
> 
> 标签：android, urlconnection

我尝试在 60000 上的 UrlConnection 上设置ReadTimeout。服务器不断发送保持活动状态。一段时间（可能是几个小时）这会停止工作。更好的是：没有抛出异常。代码就在那里，没有connectionTImeout没有readTimeout，没有任何异常，并且保持活动没有写入日志文件。

有没有人经历过这个？除了写一个看门狗来监控这个过程之外，还有什么解决方法吗？感谢您的任何建议。汉内斯

# java - 如何从 PublicKey 获取未编码的公共值字节

> ID：13144732
> 
> 赞同：0
> 
> 时间：2012-10-30T17:43:49.617
> 
> 标签：java, cryptography

我有一个小程序，它以交换会话密钥进行通信开始，为此它使用 diffie-hellmann 协议。在java中，第一部分是这样完成的：

```
KeyPairGenerator keyPairGenerator1 = KeyPairGenerator.getInstance("DH");
keyPairGenerator1.initialize(Skip.sDHParameterSpec);
KeyPair keyPair1 = keyPairGenerator1.generateKeyPair();
byte[] localKey1 = keyPair1.getPublic().getEncoded();
KeyAgreement keyAgreement1 = KeyAgreement.getInstance("DH");
keyAgreement1.init(keyPair1.getPrivate());
// getting remote key 
keyAgreement1.doPhase(theirPublicKey2, true);
byte[] sharedKey1 = keyAgreement1.generateSecret(); 
```

然后将 localKey 发送到远程部分，远程部分将部分数据发送回用于计算 DH 共享密钥。问题，另一个程序期望获取行数据（大整数），并且从 java 程序中我发送了 X509 编码。

那么如何从 PublicKey 中获取 BigInteger（DH 协议的本地 Y 值）？或者也许还有另一种方法来生成必要的 DH 参数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T20:50:25.840

只需将密钥转换为更专业的类型...

```
DHPublicKey localKey = (DHPublicKey) keyPair1.getPublic();
BigInteger localY = localKey.getY(); 
```

当然，如果您还没有就预定义的参数达成一致，您可能还想从中检索参数`localKey`。

# css - 在纯CSS中选择元素的兄弟姐妹的孩子

> ID：13144733
> 
> 赞同：0
> 
> 时间：2012-10-30T17:43:57.957
> 
> 标签：css

假设你有：

```
----------
    A
----------
    B -> C
---------- 
```

给定 C 是 B 的孩子，我想选择所有的 C，其父 B 是 A 的兄弟

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T17:47:27.547

尝试这个：

```
A ~ B > C 
```

返回作为 'A' 兄弟的 'B' 子级的所有 'C'

@Sven 还提到了“+”相邻兄弟选择器，如果 A 和 B 是“相邻”兄弟（意味着彼此相邻且不被其他兄弟元素分割），该选择器也将起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T17:48:52.327

```
.a +.b .c 
```

这是一个[jsfiddle](http://jsfiddle.net/GAu2Z/)，您可以在其中进行测试。请注意`.c`不符合规则的 div 不会获得绿色背景。我不会指望 IE 支持这一点。

# c# - 如何判断上下文菜单项是用鼠标单击还是由热键触发？

> ID：13144739
> 
> 赞同：0
> 
> 时间：2012-10-30T17:44:04.180
> 
> 标签：c#, winforms, hotkeys

我有`DataGridView`一个上下文菜单。一个菜单项是复制（使用 Ctrl+C 热键。）我要做的就是获取当前鼠标位置以复制用户右键单击的单元格，或者如果他们使用热键则获取当前选定的单元格. 在这两种情况下，`menu_Click`事件都会被触发。如何判断它是来自热键还是上下文菜单？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T17:59:27.560

据我所知，您可以通过`Hook`所有事件`Mouse`和`Keyboard`事件来检测输入源。

您应该看看这篇*CodeProject*文章，[在 C# 中处理全局鼠标和键盘挂钩](http://www.codeproject.com/KB/system/CSLLKeyboard.aspx)

[MSDN 参考](http://msdn.microsoft.com/en-us/library/ms644959%28v=vs.85%29.aspx)：

> *全局挂钩*监视与调用线程相同的桌面中的所有线程的消息。特定于线程的*挂钩*仅监视单个线程的消息。全局挂钩过程可以在与调用线程相同的桌面中的任何应用程序的上下文中调用，因此该过程必须位于单独的 DLL 模块中。仅在关联线程的上下文中调用特定于线程的钩子过程。

# haskell - 使用 TypeFamilies 派生实例

> ID：13144740
> 
> 赞同：10
> 
> 时间：2012-10-30T17:44:07.417
> 
> 标签：haskell, types, type-families

我有一个`Foo`具有关联类型的类型类：

```
{-# LANGUAGE TypeFamilies #-}

class Foo a where
    type Bar a
    foo :: a -> Bar a 
```

现在我想定义一个包含关联类型之一的数据类型，并`Show`为其派生一个实例：

```
data Baz a = Baz (Bar a) deriving (Show) 
```

但是，这不会编译，因为你不能保证有一个`Show`实例`Bar a`

```
No instance for (Show (Bar a))
  arising from the 'deriving' clause of a data type declaration 
```

我可以通过打开并编写手动实例来解决问题`FlexibleContexts`，`UndecidableInstances`如下`Show`所示

```
{-# LANGUAGE FlexibleContexts, UndecidableInstances #-}

data Baz a = Bar a

instance (Show a, Show (Bar a)) => Show (Baz a) where
    showsPrec _ (Baz x) = showString "Baz " . shows x 
```

但这并不是特别令人满意，尤其是当`Baz`它比围绕一个值的简单包装器更复杂时，或者当我还想派生其他类型类的实例时。有出路吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-30T17:57:53.443

您可以使用`StandaloneDeriving`来要求 GHC 生成与`Show`以往相同的实例，但使用不同的上下文：

```
{-# LANGUAGE FlexibleContexts, StandaloneDeriving, TypeFamilies, UndecidableInstances #-}

class Foo a where
    type Bar a
    foo :: a -> Bar a

data Baz a = Baz (Bar a)
deriving instance Show (Bar a) => Show (Baz a) 
```

# c++ - 通过“指针 3”获取“指针 1”的值

> ID：13144743
> 
> 赞同：0
> 
> 时间：2012-10-30T17:44:26.067
> 
> 标签：c++, pointers

请看下面的代码

```
#include <iostream>

using namespace std;

int main()
{
    int a = 5;

    int *aPtr1 = &a;
    int *aPtr2 = aPtr1;
    int *aPtr3 = aPtr2;

    cout << "'a' value: " << a << endl;
    cout << "'aPtr1' value: " << *aPtr1 << endl;
    cout << "'aPtr2' value: " << *aPtr2 << endl;
    cout << "'aPtr2' value from 'aPtr3': " << **aPtr3 << endl;
} 
```

在这里，在最后一行，我试图从“aPtr3”中获取“aPtr2”值。换句话说，这是我试图找到“之前的指针”。但它给了我错误

```
PointerTest.cpp:16: error: invalid type argument of `unary *' 
```

我怎样才能做到这一点？请帮忙！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T17:47:11.130

`aPtr3`等于`aPtr2`。并且`aPtr2`是 的地址`a`。在编写 时`*aPtr3`，您已经访问了它所包含的地址所指向的值（即 的地址`a`）。

如果你想使用这种语法，你应该有

```
int **aPtr3 = &aPtr2; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T17:54:57.887

`**aPtr3`唤起未定义的行为。 `aPtr3`不是指向 int 的指针；它是一个指向 int 的指针。只需执行以下操作即可修复代码：

`<< *aPtr3 << endl`

您的代码引起了未定义的行为，因为`**aPtr3`归结为`*5`.

# javascript - 无法在 Firefox 的对话框标题中选择输入元素

> ID：13144748
> 
> 赞同：3
> 
> 时间：2012-10-30T17:44:34.817
> 
> 标签：javascript, jquery, jquery-ui

我在这里添加了我的代码 - [http://jsfiddle.net/Cvf2F/3/](http://jsfiddle.net/Cvf2F/3/) - 知道为什么我无法在 Firefox 的这个简单对话框的标题区域中选择选择/输入元素吗？我发现添加 draggable: false 会使这个在 Chrome 中工作，而这在我的 firefox 中不起作用。

```
$('<div>Hello world!</div>').dialog({
 title: '<select><option>A</option><option>B</option><option>C</option><option>D</option></select><input value="value">', 
 draggable: false
});​ 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T18:15:51.217

我的建议是删除对话框的标题栏，因为它不适用于 Firefox。

`<div id="StatusDialog" title="Dialog Title"></div>`

```
var data = "<select><option>A</option><option>B</option><option>C</option><option>D</option></select><input value='value'>"

$("#StatusDialog").html(data)

$("#StatusDialog").dialog({
    draggable: false});

$(".ui-dialog-titlebar").hide(); 
```

当前，选择被应用于元素的某些样式阻止，这阻止了选项的出现。

# c# - 扩展 Window 类的 ContentPresenter 在设计时不显示内容

> ID：13144750
> 
> 赞同：1
> 
> 时间：2012-10-30T17:44:39.760
> 
> 标签：c#, wpf, visual-studio-2010, dependency-properties, contentpresenter

我目前正在编写一个扩展 Window 的 Dialog 类（无外观控件），并使用 XAML 样式为该类分配一个默认 ControlTemplate。

我希望我的对话框模板的“按钮”部分是可替换的，但如果没有指定其他内容，则使用一组默认按钮预先填充它。这就是为什么我添加了一个名为我的类的**依赖属性。**`ButtonContent`

（请参阅下面的`DefaultButtons`XAML）**在我运行应用程序时正确呈现**，但**Visual Studio 2010 的设计预览不会呈现内容**。为什么这没有发生？

我的对话框类如下所示：

```
public class Dialog : Window
{
    public FrameworkElement ButtonContent
    {
        get { return (FrameworkElement)GetValue(ButtonContentProperty); }
        set { SetValue(ButtonContentProperty, value); }
    }

    public static readonly DependencyProperty ButtonContentProperty =
        DependencyProperty.Register("ButtonContent", typeof(FrameworkElement), typeof(Dialog), new UIPropertyMetadata(null));

    static Dialog()
    {
        DefaultStyleKeyProperty.OverrideMetadata(typeof(Dialog), new FrameworkPropertyMetadata(typeof(Dialog)));
    }
} 
```

这是我的 XAML：

```
<Style TargetType="{x:Type Dialogs:Dialog}">
    <Setter Property="DataContext" Value="{Binding RelativeSource={RelativeSource Self}}"/>     
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type Dialogs:Dialog}">
                <StackPanel>
                    <ContentPresenter Content="{TemplateBinding ButtonContent}"/>
                    <TextBlock>This text is rendered correctly</TextBlock>
                </StackPanel>
            </ControlTemplate>
        </Setter.Value>
    </Setter>

    <Setter Property="ButtonContent">
        <Setter.Value>
            <!-- This stuff here is not shown in VS2010's preview -->
            <UniformGrid Name="DefaultButtons" Rows="1" Columns="2">
                <Button>Button 1</Button>
                <Button>Button 2</Button>
            </UniformGrid>
        </Setter.Value>
    </Setter>
</Style> 
```

当我启动应用程序时，它看起来像这样：

[![由应用程序呈现](../Images/cce65cf1dba7f4ffbfcc4198ece130ab.png)](https://i.stack.imgur.com/6UVzV.png)

VS2010 设计器渲染了这个：

[![由 VS2010 渲染](../Images/36397832ba134172e802858d06e0acf5.png)](https://i.stack.imgur.com/dVp7M.png)

* * *

**编辑：**如评论中所述，将上述样式放在 Themes\Generic.xaml 而不是我从 App.xaml 中包含的资源字典中不会改变任何内容。

* * *

**编辑 2：**如果我像这样显式覆盖默认值`ButtonContent`，设计器也不会显示任何内容。在运行时，一切正常：

```
<Dialogs:Dialog x:Class="Dialogs.TestDialog"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:Dialogs="clr-namespace:Dialogs">
    <Dialogs:Dialog.ButtonContent>
        <Button>Also not shown at design time</Button>
    </Dialogs:Dialog.ButtonContent>
</Dialogs:Dialog> 
```

* * *

**编辑 3：**如果我将`ButtonContent`属性添加到 a`UserControl`而不是我的`Dialog`类 extends `Window`，`ButtonContent`则在用户控件中正确显示...此外，VS2010 似乎将上面定义的样式应用于*任何*窗口，而不仅仅是 class 的那些`Dialog`，尽管我已经适当地设置了 TargetType ......很奇怪！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T12:46:22.880

我在 Microsoft Connect 上针对此问题打开了[错误报告。](https://connect.microsoft.com/VisualStudio/feedback/details/770067/wpf-designer-not-sho)根据 MS 的说法，这是一个已知问题，并且是设计使然：

> 感谢您报告此问题。这是我们的一个已知问题，并且是设计使然。我们无法在设计器中创建 Window 的设计实例，因此我们用我们自己的代理类型替换。这就是它在 UserControl 而不是在窗口中正常工作的原因。解决方法是将对话框的内容单独设计为 UserControl。

# javascript - Javascript Newb：在单选点击时按类显示 div

> ID：13144753
> 
> 赞同：0
> 
> 时间：2012-10-30T17:44:44.297
> 
> 标签：javascript

好的，显然我是 javascript 新手。我正在尝试使用单选按钮按类隐藏 div，当单击单个单选时，我的函数需要隐藏类名称为“p12”或“p34”的所有 div。

但

这仅适用于所有 p12 div....我缺少什么来制作两者？..

```
if (document.getElementById('numbofextras0').checked == true) {
    for(i=0; i<100; i++) 
        document.getElementsByClassName('p12')[i].style.display = 'none';

    for(i=0; i<100; i++) 
        document.getElementsByClassName('p34')[i].style.display = 'none';
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T17:49:43.023

如果它不喜欢你可能超出`getElementsByClassName`回报的范围，我不会感到惊讶（但话又说回来，我还没有测试/检查会发生什么）。尝试先存储结果，然后循环它们。

```
var p12s = document.getElementsByClassName('p12');
for (var i = 0; i < p12s.length; i++) {
    p12s[i].style.display = "none";
}

var p34s = document.getElementsByClassName('p34');
for (var i = 0; i < p34s.length; i++) {
    p34s[i].style.display = "none";
} 
```

`100`这样，它循环遍历每个`getElementsByClassName`返回的确切数量的元素（您没有硬代码）。

主要问题是当你硬编码`100`时，它总是从 0 循环到 99。如果`getElementsByClassName`返回少于 100 个元素，尝试访问该索引将返回 undefined 并在你尝试执行类似`.style.display = "none";`. 或者如果返回 160 个元素怎么办？只有前 100 个会被修改。在循环之前进行调用并将返回的元素存储在变量中，然后遍历该长度，是安全/正确的方法。就像你以前的方式一样，它`getElementsByClassName`在每次循环迭代时都会调用 - 非常低效 - 你只需**要做**一次！......当然，硬编码`100`不是循环遍历元素的最佳方式。这是一个正确的想法，只是顺序不对。我的意思是，从技术上讲，你可以这样做：

```
for (i=0; i<100; i++) {
    var el = document.getElementsByClassName('p12')[i];
    if (el) {
        el.style.display = 'none';
    }
} 
```

但是就像我说的那样，调用`getElementsByClassName`每个循环迭代并不是很有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T17:55:55.147

考虑使用`querySelectorAll`而不是`getElementsByClassName`

```
document.querySelectorAll(".p12, .p34") 
```

如果您愿意，这在旧版浏览器中不起作用。但如果你这样做，我宁愿推荐 jQuery 或类似的东西，而不是 vanilla JS。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-30T17:56:30.060

请尝试此代码：

```
if (document.getElementById('numbofextras0').checked == true) {
          var elems=document.getElementsByClassName('p12 p34')
          for(i=0; i<elems.length; i++) 
             elems[i].style.display='none';
        } 
```

# c# - 在 WebBrowser 控件中控制 Excel

> ID：13144756
> 
> 赞同：2
> 
> 时间：2012-10-30T17:45:07.730
> 
> 标签：c#, .net, vb.net, excel, interop

我正在尝试将 .xls 文件加载到我的 Windows 窗体应用程序中的 webbrowser 控件中，以便我可以通过编程方式不断更新它。

因此，例如，当用户按下表单上的按钮时，Excel 工作表中的数据就会更新。

我已经设法很容易地将数据加载到控件中：

```
WebBrowser1.Navigate(PathToXLSFile) 
```

而且，根据我在网上阅读的内容，我现在应该能够使用以下内容来控制该表：

```
Dim wb As Object
WebBrowser1.Navigate(PathToXLSFile)
wb = WebBrowser1.Document 
```

现在，我尝试将最后一行代码放入模块`WebBrowser1_DocumentCompleted` *和*模块中`WebBrowser1_Navigated`，但对于两者，我都得到了`WebBrowser1.Document = Nothing`.

我在网上查看并找到了诸如[this](http://www.codeproject.com/Articles/15760/How-to-Integrate-Excel-in-a-Windows-Form-Applicati)、[this](http://support.microsoft.com/kb/304662)和[this](http://www.vbforums.com/showthread.php?455851-RESOLVED-Excel-in-Web-Browser-Control-Select-sheet-problem)之类的解决方案，但没有一个对我有用。

同样，我想要做的是将 Excel 工作表加载到 webbrowser 控件（或其他控件，如果您有更好的想法），并能够通过 .NET 编辑/更改它。

* * *

至于我的完整场景（为什么我需要这个）：

基本上，我的程序会生成大量数据，最终用户希望看到以特定方式格式化（经常变化）的数据，所以我所做的是创建一个格式化的 Excel 表，其中的公式引用回不同 Excel 表上的表. 这样，我的程序所需要做的就是将所有计算值吐出到表中，然后数据就在那里供用户查看（并且很容易定制而不会弄乱我的程序）。

挑战在于，现在他们希望在 Windows 窗体上看到这些数据的*大量*迭代，所以，基本上我需要做的是每次他们想看到新数据时，即时计算并重新显示给他们。

由于格式复杂，我发现 DataGridView 在这里很难使用，所以我要做的是向他们展示“输出”表（通过 webBrowser 控件，因为这就是我能找到的全部）并有能力使用新数据不断更新“输入”表，以便输出表不断更新。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T14:45:14.043

只是为了完全回答这个问题，以便将来面临这一挑战的任何人都不必像我一样将头撞在砖墙上，并且会有一些东西来指导他们，这就是我最终做的事情：

1.  使用 Office.Interop 在后台打开我的 Excel 工作簿一次 - 这使我能够操作数据并使用 Excel 的计算引擎非常快速地更新数据。
2.  在我的表单中添加了一个 Panel 内的 PictureBox 并设置 Panel 的 autoscroll = True

## 用于显示 Excel 输出的代码：

```
Dim MyRange As Microsoft.Office.Interop.Excel.Range

... code ...

MyRange.CopyPicture(Microsoft.Office.Interop.Excel.XlPictureAppearance.xlScreen,Microsoft.Office.Interop.Excel.XlCopyPictureFormat.xlBitmap)

If Clipboard.GetDataObject IsNot Nothing Then
   Dim Data As IDataObject = Clipboard.GetDataObject

   If Data.GetDataPresent(DataFormats.Bitmap) Then
       Dim img As Image = Data.GetData(DataFormats.Bitmap, True)

       PictureBox1.Height = img.Height
       PictureBox1.Width = img.Width
       PictureBox1.Image = img
   End If
End If 
```

不过，我肯定想声明，这个答案是 100% 感谢蒂姆威廉姆斯的惊人指导和评论 - 谢谢！

# javascript - 可滚动表格，专注于行

> ID：13144757
> 
> 赞同：0
> 
> 时间：2012-10-30T17:45:10.323
> 
> 标签：javascript, knockout.js

[jsfiddle 代码](http://jsfiddle.net/aDahT/415/)
我有一个带有可滚动正文的表格。数据使用`knockout.js`. 可以选择正文中的单行。
默认情况下，某些行被选中。但是这一行可以在正文的底部，在这种情况下用户看不到它。如何使选定的行默认可见？我想在页面加载时自动将表格滚动到选定的行。数据的顺序不能改变。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-30T19:57:23.880

像这样的东西：http: [//jsfiddle.net/aDahT/416/](http://jsfiddle.net/aDahT/416/)

```
var GetElementByClassName = function(matchClass){
  var elems = document.getElementsByTagName('*'), i;
    for (i in elems) {
        if((' ' + elems[i].className + ' ').indexOf(' ' + matchClass + ' ')
                > -1) {
            return elems[i];
        }
    }  
};

GetElementByClassName('selectedRow').scrollIntoView(true); 
```

如果你想要更全面的`GetElementsByClass`，你可以[看看这个](http://robertnyman.com/2008/05/27/the-ultimate-getelementsbyclassname-anno-2008/)。较新的浏览器（请参阅：不是 IE）已加入。

# java - 我在 JSTL c:import 上需要什么编码用于法语字符

> ID：13144758
> 
> 赞同：2
> 
> 时间：2012-10-30T17:45:11.320
> 
> 标签：java, jsp, jstl

我在我的所有 JSP 中使用通用页眉并传递可能是法语或英语的属性，但是当法语属性以重音传递时，我得到了？或类似的错误字符

```
<c:set var="subTitle" value="${data}"/>     

<c:import charEncoding="UTF-8" url="../menu/header.jsp" >
        <c:param name="systemTitle" value="${label}" />
    <c:param name="subTitle" value="${subTitle}" />
</c:import> 
```

我如何对参数进行编码，以便它们保留重音字符。UTF-8 似乎不起作用，除非我错误地引用了它

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T19:08:50.570

`<c:import charEncoding>`仅指示它应该使用`<c:import>`什么字符编码来**读取**目标资源。它没有指示应该使用什么字符编码将读取的字符**写入**响应正文。而是使用 JSP 页面自己的字符编码。您可以通过将以下行添加到 JSP 的最顶部来设置它：

```
<%@page pageEncoding="UTF-8"%> 
```

请注意，您还可以通过将以下条目添加到应用程序范围内（如果您想要[World Domination](http://en.wikipedia.org/wiki/Mojibake)`web.xml`建议使用） ：

```
<jsp-config>
    <jsp-property-group>
        <url-pattern>*.jsp</url-pattern>
        <page-encoding>UTF-8</page-encoding>
    </jsp-property-group>
</jsp-config> 
```

# rabbitmq - 长时间空闲后，RabbitMQ 连接自动断开

> ID：13144761
> 
> 赞同：4
> 
> 时间：2012-10-30T17:45:23.400
> 
> 标签：rabbitmq

我正在使用 .net 客户端连接到运行 HA 模式的 RabbitMQ 服务器，并且所有队列都具有以下配置。

**队列具有以下配置**

*   队列名称 = ""; // 自动生成
*   独占=假；
*   自动删除 = 真；
*   耐用=假
*   Argumenets==> x-ha-policy, all（适用于 HA 服务器模式）

我看到这种行为，在进程空闲了很长一段时间比如说 10 分钟后，连接开始断开，因此队列被自动删除。

是否有空闲设置或超时设置？或者在 RabbitMQ .net 客户端中连接自动关闭的可能原因是什么。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-02T23:14:22.960

这是由负载均衡器在 5 分钟后断开空闲连接引起的。使用 RequestedHeartbeat 保持连接处于活动状态

# objective-c - 知道 CLLocationManager 何时锁定 在当前位置

> ID：13144773
> 
> 赞同：0
> 
> 时间：2012-10-30T17:46:03.423
> 
> 标签：objective-c, ios

使用 CLLocationManager 对象，您首先设置距离过滤器和所需的精度：

```
_locationManager.distanceFilter = kCLDistanceFilterNone;
_locationManager.desiredAccuracy = kCLLocationAccuracyThreeKilometers; 
```

然后您开始更新设备的位置：

```
[_locationManager startUpdatingLocation]; 
```

什么时候锁定位置？我需要处理这个位置，但在它完全锁定之前不想处理它。

谢谢！

编辑：

意识到协议方法没有被调用；不知道为什么。_locationManager.delegate = self;

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T17:58:53.467

当您开始从 接收位置更新时`CLLocationManagerDelegate`，请查看`horizontalAccuracy`接收到的属性`CLLocation`。将其与适当的`kCLLocationAccuracyXXX`常数进行比较，以确定该值是否“足够好”以满足您的需求。

# html - Eclipse：使用 HTML标记显示图片时出现问题

> ID：13144787
> 
> 赞同：0
> 
> 时间：2012-10-30T17:46:51.020
> 
> 标签：html, eclipse

我正在使用 Eclipse 来学习 javascript。由于某种原因，我无法在浏览器中显示图片。

我想我应该做错了什么。但是，不能完全弄清楚。

![在此处输入图像描述](../Images/babcbaed4ce0b0eff6474e60866148ec.png)

这就是我在浏览器中看到的。

![在此处输入图像描述](../Images/62f2ae7fd326c0fcdd1f60426eab6876.png)

# javascript - 使用 Elasticsearch 搜索的 AJAX 调用

> ID：13144794
> 
> 赞同：14
> 
> 时间：2012-10-30T17:47:22.353
> 
> 标签：javascript, jquery, ajax, couchdb, elasticsearch

我一直在试图弄清楚如何使用 jQuery AJAX 调用正确地从 elasticsearch 请求数据。我要么得到一个解析错误，要么我会得到我正在搜索的索引中的每个文档。

```
 $(document).ready(function() {

    var timer = null;
    function dicom_search() {
        var box = $('#s_box').val();

        $.ajax({
            url: 'http://localhost:9200/dicoms/dicoms/_search',
            type: 'POST',
            //contentType: 'application/json; charset=UTF-8',
            crossDomain: true,
            dataType: 'json',
            data: {
                query:{match:{_all:$('#s_box').val()}},
                pretty: true,
                fields: '_id'
            },
            success: function(response) {
                var data = response.hits.hits;
                var doc_ids = [];
                var source = null;
                var content = '';

                if (data.length > 0) {
                    for (var i = 0; i < data.length; i++) {
                        source = data[i].fields;
                        doc_ids.push(source._id);
                        content = content + ' ' + source._id + '<br />';
                    }

                    $('#res').removeClass('text-error').addClass('text-success').html(content);
                } else {
                    $('#res').removeClass('text-success').addClass('text-error').html('No results found.');
                }

            }
        });
    }

    $('#s_box').live('keyup', function() {

        if (timer) {
            clearTimeout(timer);
        }
        timer = setTimeout(dicom_search, 600);

    });
}); 
```

这是我的错误：

```
{
   "error":"SearchPhaseExecutionException[Failed to execute phase [query], total failure; shardFailures {[GUiivW0TQVSNv2HQyxu8Vw][dicoms][0]: SearchParseException[[dicoms][0]: from[-1],size[-1]: Parse Failure [Failed to parse source [_na_]]]; nested: ElasticSearchParseException[Failed to derive xcontent from org.elasticsearch.common.bytes.ChannelBufferBytesReference@779479bb]; }{[GUiivW0TQVSNv2HQyxu8Vw][dicoms][3]: SearchParseException[[dicoms][3]: from[-1],size[-1]: Parse Failure [Failed to parse source [_na_]]]; nested: ElasticSearchParseException[Failed to derive xcontent from org.elasticsearch.common.bytes.ChannelBufferBytesReference@779479bb]; }{[GUiivW0TQVSNv2HQyxu8Vw][dicoms][1]: SearchParseException[[dicoms][1]: from[-1],size[-1]: Parse Failure [Failed to parse source [_na_]]]; nested: ElasticSearchParseException[Failed to derive xcontent from org.elasticsearch.common.bytes.ChannelBufferBytesReference@779479bb]; }{[GUiivW0TQVSNv2HQyxu8Vw][dicoms][4]: SearchParseException[[dicoms][4]: from[-1],size[-1]: Parse Failure [Failed to parse source [_na_]]]; nested: ElasticSearchParseException[Failed to derive xcontent from org.elasticsearch.common.bytes.ChannelBufferBytesReference@779479bb]; }{[GUiivW0TQVSNv2HQyxu8Vw][dicoms][2]: SearchParseException[[dicoms][2]: from[-1],size[-1]: Parse Failure [Failed to parse source [_na_]]]; nested: ElasticSearchParseException[Failed to derive xcontent from org.elasticsearch.common.bytes.ChannelBufferBytesReference@779479bb]; }]",
   "status":500
} 
```

编辑：我想通了：

```
var data = {
            query: {
                match: {
                    _all: $('#s_box').val()
                }
            },
            fields: '_id'
        }; 

$.ajax({
            url: 'http://localhost:9200/dicoms/dicoms/_search',
            type: 'POST',
            //contentType: 'application/json; charset=UTF-8',
            crossDomain: true,
            dataType: 'json',
            data: JSON.stringify(data),
            success: function(response) {
                var data = response.hits.hits;
                var doc_ids = [];
                var source = null;
                var content = '';

                if (data.length > 0) {
                    for (var i = 0; i < data.length; i++) {
                        source = data[i].fields;
                        doc_ids.push(source._id);
                        content = content + ' ' + source._id + '<br />';
                    }

                    $('#res').removeClass('text-error').addClass('text-success').html(content);
                } else {
                    $('#res').removeClass('text-success').addClass('text-error').html('No results found.');
                }

            },
            error: function(jqXHR, textStatus, errorThrown) {
                var jso = jQuery.parseJSON(jqXHR.responseText);
                error_note('section', 'error', '(' + jqXHR.status + ') ' + errorThrown + ' --<br />' + jso.error);
            }
        }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T17:57:41.313

你可以在这里看看：[https ://github.com/dadoonet/devoxxfr_demo/blob/gh-pages/index.html#L512](https://github.com/dadoonet/devoxxfr_demo/blob/gh-pages/index.html#L512)

它可以帮助您解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-01-19T05:35:29.513

我建议您使用这个名为**Postman**的工具，而不是编写您的 AJAX 调用。邮递员有一个简单的座右铭——

> 简化 API 开发

因此，如果您在编写 ES 请求时遇到问题，或者您决定不使用 jQuery AJAX/XHR，或者您想使用 cURL/Unirest/NSURL 等等，您可以使用 Postman 请求构建器来编写放下您的简单 Http 请求，然后您会在其下方的框中找到一个名为*code*的链接，您可以使用它以您选择的语言生成请求。包括 AJAX，是的。所以我建议你尝试使用它。

这是您可以从中下载 Postman 的链接 - [https://www.getpostman.com/postman](https://www.getpostman.com/postman)

# android - 是否可以获得 APK 的下载源/应用商店？

> ID：13144799
> 
> 赞同：1
> 
> 时间：2012-10-30T17:47:30.710
> 
> 标签：android, download, installation, apk, analytics

我们的应用安装与中国的 Google Play 商店下载无关。

因此，管理层提出了一个问题，是否可以追踪提供我们 APK 的商店。我知道这几乎是不可能的，因为签名的 APK 没有与商店相关的数据。

但也许我错了。那么在手机上安装APK的商店是否有任何信息？

# c++ - 什么是签名目录文件成员标签？

> ID：13144803
> 
> 赞同：5
> 
> 时间：2012-10-30T17:47:48.063
> 
> 标签：c++, winapi

我正在填写[WINTRUST_CATALOG_INFO](http://msdn.microsoft.com/en-us/library/windows/desktop/aa388203.aspx)结构。我已经计算了文件的哈希值并找到了要使用的目录文件。

有一个成员我不知道如何填写：

```
pcwszMemberTag
    Tag of a member file to be verified. 
```

我在互联网上看到的大多数示例代码似乎都将文件哈希转换为自身的十六进制编码版本，并将其作为成员标签传递。我不确定为什么会这样。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-05T13:03:41.597

它包含对文件名的文本引用。此代码可能有助于理解工作流程：

```
HRESULT Cwvt::VerifyTrust(HANDLE hFile, HWND hWnd, PJAVA_TRUST *ppJavaTrust,
                          LPCWSTR szStatusText,
                          IInternetHostSecurityManager *pHostSecurityManager,
                          LPSTR szFilePath, LPSTR szCatalogFile,
                          CDownload *pdl) 
{
    LPWSTR                   wzFileName = NULL;
    LPWSTR                   wzFilePath = NULL;
    LPWSTR                   wzCatalogFile = NULL;
    GUID                     guidJava = JAVA_POLICY_PROVIDER_DOWNLOAD;
    GUID                     guidCor = COR_POLICY_PROVIDER_DOWNLOAD;
    GUID                     guidAuthenticode = WINTRUST_ACTION_GENERIC_VERIFY_V2;
    GUID                    *pguidActionIDJava = &guidJava;
    GUID                    *pguidActionIDCor = &guidCor;
    WINTRUST_DATA            wintrustData;
    WINTRUST_DATA            wtdAuthenticode;
    WINTRUST_FILE_INFO       fileData;
    JAVA_POLICY_PROVIDER     javaPolicyData;
    WCHAR                    wpath [MAX_PATH];
    PJAVA_TRUST              pbJavaTrust = NULL;
    IServiceProvider        *pServProv = NULL;
    LPCATALOGFILEINFO        pcfi = NULL;
    HRESULT                  hr = S_OK;

    ZEROSTRUCT(wintrustData);
    ZEROSTRUCT(fileData);
    ZEROSTRUCT(javaPolicyData);

    javaPolicyData.cbSize = sizeof(JAVA_POLICY_PROVIDER);
    javaPolicyData.VMBased = FALSE;
    javaPolicyData.fNoBadUI = FALSE;

    javaPolicyData.pwszZone = szStatusText;
    javaPolicyData.pZoneManager = (LPVOID)pHostSecurityManager;

    fileData.cbStruct = sizeof(WINTRUST_FILE_INFO);
    fileData.pcwszFilePath = szStatusText;
    fileData.hFile = hFile;

    wintrustData.cbStruct = sizeof(WINTRUST_DATA);
    wintrustData.pPolicyCallbackData = &javaPolicyData;

    if ( (hWnd == INVALID_HANDLE_VALUE) || IsUIRestricted())
        wintrustData.dwUIChoice = WTD_UI_NONE;
    else
        wintrustData.dwUIChoice = WTD_UI_ALL;

    wintrustData.dwUnionChoice = WTD_CHOICE_FILE;
    wintrustData.pFile = &fileData;

    if (szCatalogFile) {
        ::Ansi2Unicode(szCatalogFile, &wzCatalogFile);
        ::Ansi2Unicode(szFilePath, &wzFilePath);
        wzFileName = PathFindFileNameW(szStatusText);

        if (!m_bHaveWTData) {
            memset(&m_wtCatalogInfo, 0x0, sizeof(m_wtCatalogInfo));
            m_wtCatalogInfo.cbStruct = sizeof(WINTRUST_CATALOG_INFO);
            m_bHaveWTData = TRUE;
        }
        m_wtCatalogInfo.pcwszCatalogFilePath = wzCatalogFile;
        m_wtCatalogInfo.pcwszMemberTag = wzFileName;
        m_wtCatalogInfo.pcwszMemberFilePath = wzFilePath;

        wtdAuthenticode = wintrustData;
        wtdAuthenticode.pCatalog = &m_wtCatalogInfo;
        wtdAuthenticode.dwUnionChoice = WTD_CHOICE_CATALOG;
        wtdAuthenticode.dwStateAction = WTD_STATEACTION_VERIFY;
        wtdAuthenticode.dwUIChoice = WTD_UI_NONE;

        hr = WinVerifyTrust(hWnd, &guidAuthenticode, &wtdAuthenticode);
        if (FAILED(hr)) {
            hr = WinVerifyTrust(hWnd, pguidActionIDCor, &wintrustData);

            if (hr == TRUST_E_PROVIDER_UNKNOWN)
                hr = WinVerifyTrust(hWnd, pguidActionIDJava, &wintrustData);
        }
        else {
            // Clone Java permissions
            pbJavaTrust = pdl->GetCodeDownload()->GetJavaTrust();
            if (!pbJavaTrust) {
                hr = pdl->GetBSC()->QueryInterface(IID_IServiceProvider, (void **)&pServProv);
                if (SUCCEEDED(hr)) {
                    hr = pServProv->QueryService(IID_ICatalogFileInfo, IID_ICatalogFileInfo, (void **)&pcfi);
                    if (SUCCEEDED(hr)) {
                        pcfi->GetJavaTrust((void **)&pbJavaTrust);
                    }
                }
                SAFERELEASE(pServProv);
                SAFERELEASE(pcfi);
                pdl->SetMainCABJavaTrustPermissions(pbJavaTrust);
            }
        }

    }
    else {
        hr =  WinVerifyTrust(hWnd, pguidActionIDCor, &wintrustData);
        if (hr == TRUST_E_PROVIDER_UNKNOWN)
            hr = WinVerifyTrust(hWnd, pguidActionIDJava, &wintrustData);

        if (SUCCEEDED(hr)) {
            pdl->SetMainCABJavaTrustPermissions(javaPolicyData.pbJavaTrust);
        }
    }

    SAFEDELETE(wzCatalogFile);
    SAFEDELETE(wzFilePath);

    // BUGBUG: this works around a wvt bug that returns 0x57 (success) when
    // you hit No to an usigned control
    if (SUCCEEDED(hr) && hr != S_OK) {
        hr = TRUST_E_FAIL;
    }

    if (FAILED(hr)) {
        // display original hr intact to help debugging
//        CodeDownloadDebugOut(DEB_CODEDL, TRUE, ID_CDLDBG_VERIFYTRUST_FAILED, hr);
    } else {
        *ppJavaTrust = javaPolicyData.pbJavaTrust;
    }
    if (hr == TRUST_E_SUBJECT_NOT_TRUSTED && wintrustData.dwUIChoice == WTD_UI_NONE) {
        // if we didn't ask for the UI to be out up there has been no UI
        // work around WVT bvug that it returns us this special error code
        // without putting up UI.

        hr = TRUST_E_FAIL; // this will put up mshtml ui after the fact
                           // that security settings prevented us
    }

    if (FAILED(hr) && (hr != TRUST_E_SUBJECT_NOT_TRUSTED)) {

        // trust system has failed without UI

        // map error to this generic error that will falg our client to put
        // up additional info that this is a trust system error if reqd.
        hr = TRUST_E_FAIL;
    }

    if (hr == TRUST_E_SUBJECT_NOT_TRUSTED) {

        pdl->GetCodeDownload()->SetUserDeclined();
    }

    return hr;
}

HRESULT GetActivePolicy(IInternetHostSecurityManager* pZoneManager, 
                        LPCWSTR pwszZone,
                        DWORD  dwUrlAction,
                        DWORD& dwPolicy)
{
    HRESULT hr = TRUST_E_FAIL;
    HRESULT hr2 = TRUST_E_FAIL;
    DWORD cbPolicy = sizeof(DWORD);

    // Policy are ordered such that high numbers are the most conservative 
    // and the lower numbers are less conservative

    DWORD dwDocumentPolicy = URLPOLICY_ALLOW;
    DWORD dwUrlPolicy = URLPOLICY_ALLOW;

    // We are going for the most conservative so lets set the 
    // value to the least conservative
    dwPolicy = URLPOLICY_ALLOW;

    IInternetSecurityManager* iSM = NULL;

    // Ask the document base for its policy
    if(pZoneManager) { //  Given a IInternetHostSecurityManager
        hr = pZoneManager->ProcessUrlAction(dwUrlAction,
                                            (PBYTE) &dwDocumentPolicy,
                                            cbPolicy,
                                            NULL,
                                            0,
                                            PUAF_NOUI,
                                            0);
    }

    // Get the policy for the URL 
    if(pwszZone) { // Create an IInternetSecurityManager
        hr2 = CoInternetCreateSecurityManager(NULL,
                                              &iSM,
                                              0);
        if(hr2 == S_OK) { // We got the manager so get the policy info
            hr2 = iSM->ProcessUrlAction(pwszZone,
                                        dwUrlAction,
                                        (PBYTE) &dwUrlPolicy,
                                        cbPolicy,
                                        NULL,
                                        0,
                                        PUAF_NOUI,
                                        0);
            iSM->Release();
        }
        else 
            iSM = NULL;
    }

    // if they both failed and we have zones then set it to deny and return an error
    if(FAILED(hr) && FAILED(hr2)) {
        // If we failed because there are on zones then lets QUERY
        // BUGBUG: we should actually try to get the IE30 security policy here.
        if(iSM == NULL && pZoneManager == NULL) {
            dwPolicy = URLPOLICY_QUERY;
            hr = S_OK;
        }
        else {
            dwPolicy = URLPOLICY_DISALLOW;
            hr = TRUST_E_FAIL;
        }
    }
    else {
        if(SUCCEEDED(hr))
            dwPolicy = dwDocumentPolicy;
        if(SUCCEEDED(hr2))
            dwPolicy = dwPolicy > dwUrlPolicy ? dwPolicy : dwUrlPolicy;

        if (dwPolicy == URLPOLICY_DISALLOW)
            hr = TRUST_E_FAIL;
        else
            hr = S_OK;
    }
    return hr;
} 
```

一些额外的评论可以在[MSDN](http://msdn.microsoft.com/en-us/library/windows/desktop/aa386967%28v=vs.85%29.aspx)中找到。使用文件哈希的十六进制表示作为参考标记是常见的用法，但不是强制性的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-09T17:31:55.707

标签存在是因为文件名不可靠。`pcwszMemberTag`对应于`pwszReferenceTag`将成员添加到目录时的设置（例如，使用[CryptCATPutMemberInfo 函数](http://msdn.microsoft.com/en-us/library/windows/desktop/bb736352%28v=vs.85%29.aspx)）。

为了真正符合 API 的工作方式，我认为您应该首先获取成员信息，然后才能完全设置 WINTRUST_CATALOG_INFO。要确定成员信息，您必须使用[CryptCATEnumerateMember 函数](http://msdn.microsoft.com/en-us/library/windows/desktop/aa379902%28v=vs.85%29.aspx)（还有一个[CryptCATGetMemberInfo 函数](http://msdn.microsoft.com/en-us/library/windows/desktop/aa379904%28v=vs.85%29.aspx)但您不能使用它 - 鸡和蛋的问题 - 您没有标签）并以任何方式确定您对哪个成员感兴趣你想要（使用其他[CRYPTATMMEMBER 结构](http://msdn.microsoft.com/en-us/library/windows/desktop/aa379905%28v=vs.85%29.aspx)字段）

使用文件哈希的十六进制表示作为参考标记是常见的用法（MakeCat 可能会这样做，所以它看起来像标准），但我认为这根本不是强制性的 - 另一个答案中的 Java 内容不是使用此约定（另请参阅此链接：[RE: CryptCATGetMemberInfo samples](http://www.derkeiler.com/Newsgroups/microsoft.public.platformsdk.security/2006-03/msg00037.html) with a Microsoft guy answer。）

# java - 在 Maven 中使用 ServicesResourceTransformer 时的 ClassNotFound

> ID：13144804
> 
> 赞同：3
> 
> 时间：2012-10-30T17:47:50.597
> 
> 标签：java, maven, jersey

我正在尝试使用 ServicesResourceTransformer 来处理我在构建 fatjar 时遇到的一些问题（[在此处记录](https://stackoverflow.com/questions/9787265/grizzly-and-jersey-standalone-jar)），但是当 maven 尝试使用它时我得到一个 ClassNotFound ：

```
ClassNotFoundException: Class name which was explicitly given in configuration using 'implementation' attribute: 'org.apache.maven.plugins.shade.resource.ServicesResourceTransfor‌​mer' cannot be loaded 
```

我的完整 pom.xml 是：

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
<modelVersion>4.0.0</modelVersion>
<groupId>embedly.reverb</groupId>
<artifactId>reverb</artifactId>
<packaging>jar</packaging>
<version>1.0-SNAPSHOT</version>
<name>reverb</name>
<url>http://maven.apache.org</url>
<dependencies>
    <dependency>
        <groupId>junit</groupId>
        <artifactId>junit</artifactId>
        <version>3.8.1</version>
        <scope>test</scope>
    </dependency>
    <dependency>
        <groupId>com.sun.jersey</groupId>
        <artifactId>jersey-bundle</artifactId>
        <version>1.14</version>
    </dependency>
    <dependency>
        <groupId>com.sun.jersey</groupId>
        <artifactId>jersey-grizzly2</artifactId>
        <version>1.14</version>
    </dependency>

    <dependency>
        <groupId>com.sun.grizzly</groupId>
        <artifactId>grizzly-servlet-webserver</artifactId>
        <version>1.9.18-i</version>
    </dependency>
    <dependency>
        <groupId>com.sun.jersey.jersey-test-framework</groupId>
        <artifactId>jersey-test-framework-grizzly</artifactId>
        <version>1.4</version>
        <scope>test</scope>
    </dependency>
</dependencies>
<build>
    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-compiler-plugin</artifactId>
            <inherited>true</inherited>
            <configuration>
                <source>1.6</source>
                <target>1.6</target>
            </configuration>
        </plugin>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-shade-plugin</artifactId>
            <version>1.5</version>
            <configuration>
                <transformers>
                    <transformer implementation="org.apache.maven.plugins.shade.resource.ServicesResourceTransformer"/>
                    <transformer implementation="org.apache.maven.plugins.shade.resource.ManifestResourceTransformer">
                        <manifestEntries>
                            <Main-Class>Main</Main-Class>
                            <Build-Number>1</Build-Number>
                        </manifestEntries>
                    </transformer>
                </transformers>
            </configuration>
            <executions>
                <execution>
                    <phase>package</phase>
                    <goals>
                        <goal>shade</goal>
                    </goals>
                </execution>
            </executions>
      </plugin>
    </plugins>
</build> 
```

请让我知道是否有更多信息会有所帮助；这个Java tang对我来说是新的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T18:20:04.607

尝试 2.0 的插件。看起来那个类是最近才引入的。

# winapi - 如何`FindWindow`一个没有出现在Spy ++中的窗口？

> ID：13144805
> 
> 赞同：1
> 
> 时间：2012-10-30T17:47:50.730
> 
> 标签：winapi, findwindow, spy++, ida

我正在使用 IDA Pro 调试一个 Windows 应用程序，我看到它有一次调用`FindWindowA`并成功地找到了一个具有给定类名的窗口。

但是，当我使用 Spy++ 定位具有给定类名的窗口时，它似乎不存在于任何地方，我找不到它。

我想知道如何找到应用程序在调用时以某种方式在内部找到的同一个窗口`FindWindowA`？我想知道为什么我的外部应用程序找不到相同的窗口...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T19:09:59.847

通常，一个窗口不能对 Spy++ 隐藏（除非程序故意挂钩 Spy++ 来隐藏窗口）。Spy++（和其他类似程序）旨在显示操作系统已知的所有窗口。

在任何情况下，使用 IDA，您都可以看到传递给的实际参数值`FindWindowA()`，因此只需将这些相同的值复制到您自己的代码中。如果其他应用程序可以找到该窗口，那么您的应用程序也可以使用相同的参数值。

# maven - 如何引用另一个 Maven 插件配置的值？

> ID：13144809
> 
> 赞同：1
> 
> 时间：2012-10-30T17:48:05.410
> 
> 标签：maven

在我的具体情况下，我希望使用 WAR 插件的 <webappDirectory> 设置的值作为依赖插件执行的配置。

有没有一种通用的方法可以将 WAR 插件的设置称为属性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T19:14:53.900

不。

您需要让两个插件都引用您在 pom 中定义的属性来实现这一点......在这种情况下，任何覆盖配置而不是属性的 pom 都会导致问题。

# asp.net-mvc - 多个同名的 DropDownLists（在 foreach 语句中）

> ID：13144810
> 
> 赞同：2
> 
> 时间：2012-10-30T17:48:09.150
> 
> 标签：asp.net-mvc, asp.net-mvc-3, html-select

加载多个具有相同名称的 DropDownLists 时遇到问题。我在这里附上我的代码：

**看法：**

```
@{
   int i = 1

    foreach (var queue in Model.Queues)
    {
            using (Html.BeginForm("ChangeQueueState", "Home", FormMethod.Post))
            {
                List<SelectListItem> sli = ViewBag.states[i - 1];
            <div>@Html.DropDownList("state", sli)</div>
            }
     }
    i++
} 
```

视图中有更多我没有显示的代码。

在我的控制器中，我只需更改相应队列的状态并加载其中包含状态列表`ViewBag.states`的列表，`SelectedListItem`其中每个队列的正确状态为“已选择”。

问题是当视图被加载时，所有的`DropDownLists`都加载了最后修改的状态。例如，如果我将第 5 个队列从“打开”更改为“关闭”，则所有`DropDownLists`显示都`Closed`选择了“”选项（尽管在数据库中正确应用了更改）。

我认为问题是由于 MVC 在`DropDownList`名称和`SelectListItem`关联项之间进行的绑定，但我无法将 DDL 名称更改为`"state" + @i`，因为状态绑定到在`ChangeQueueState`我的 Controller 的“”方法中接收到的参数。

我将衷心感谢您的帮助。提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T03:10:10.630

我认为您应该为每个下拉列表使用不同的名称。假设每个队列都有不同的 ID，所以尝试使用以下代码：

```
<div>@Html.DropDownList("state" + queue.ID, sli)</div> 
```

当然你需要区分哪个是集合中的哪个。我经常这样做，希望它对你有用。

# mysql - 在将行添加到 SQL 之前检查表中是否存在行

> ID：13144815
> 
> 赞同：0
> 
> 时间：2012-10-30T17:48:20.263
> 
> 标签：mysql, sql, mysql-python

我正在使用**Python**和模块构建一个 twitter 抓取`Tweepy`器应用程序`MySQLdb`

它将获取数百万条推文，因此性能是一个问题，我想在将其添加到同一个查询之前检查表中是否存在之前的 tweet_id

表架构是：

```
 *id* |   tweet_id             |     text
  _____|________________________|______________________________
    1  |   259327533444925056   |     sample tweet1
  _____|________________________|______________________________
    2  |   259327566714923333   |     this is a sample tweet2 
```

我尝试的代码是，但它执行双重查询：

```
#check that the tweet doesn't exist first
q = "select count(*) from tweets where tweet_id = " + tweet.id
cur.execute(q)
result = cur.fetchone()
found = result[0]
if found == 0: 
q = "INSERT INTO  lexicon_nwindow (tweet_id,text) VALUES(tweet_id,tweet.text)
cur.execute(q) 
```

使 Tweet_id 唯一并仅插入推文，会引发异常并且效率不高吗？

那么用一个查询来实现这一目标的最佳执行方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T17:55:02.027

如果将 tweet_id 作为主键（删除字段 Id），则可以使用 INSERT IGNORE 或 REPLACE INTO。1解决了2个问题。

如果要保留 Id 字段，请将其设置为索引/唯一并将其设置为自动增量。如果我知道 tweet_id 可以用作主键，我会避开这种方法。

希望这可以帮助。

哈里

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T01:19:00.863

The answer is **profile, don't speculate**.

I don't mean to be dismissive. We don't know what will be fastest:

*   SELECT + (in code) conditional INSERT
*   REPLACE INTO
*   INSERT IGNORE
*   INSERT SELECT WHERE NOT EXISTS...)
*   INSERT and (in code) ignore error

We don't know the rate of data, the frequency of duplicates, the server configuration, whether there are multiple writers simultaneously, etc.

Profile, don't speculate.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T17:59:23.813

```
#check that the tweet doesn't exist first
q = "select count(*) from tweets where tweet_id = " + tweet.id
cur.execute(q)
result = cur.fetchone()
found = result[0]
if found == 0: 
q = "REPLACE  lexicon_nwindow (tweet_id,text) VALUES(tweet_id,tweet.text)
cur.execute(q) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-30T19:28:26.587

使用 INSERT SELECT 而不是 INSERT VALUES 并在您的 SELECT 添加 WHERE 子句以检查您的 tweet.id 是否已在表中

```
q = "INSERT INTO  lexicon_nwindow (tweet_id,text) 
SELECT " + tweet.id +" ," + tweet.text +" FROM DUAL
WHERE not exists(select 1 from tweets where tweet_id = " + tweet.id +" ) " 
```

# sql - SQL 错误：参数化查询..期望参数

> ID：13144820
> 
> 赞同：0
> 
> 时间：2012-10-30T17:48:29.517
> 
> 标签：sql, sql-server

我在将日志文件部分转换为 SQL 时遇到问题`DateTime`，发现更好的解决方案是让我的日期字段由数据库而不是代码生成（使用`GETDATE()`）。

我从插入中删除了日期字段，但现在出现此错误：

> 错误：参数化查询“（@station int、@indoor_temp float、@outdoor_temp float、@dewpoint f”需要未提供的参数“@wind_direction_text”。

它抱怨的那个值被提供了，奇怪的是插入仍然成功并且插入了数据库记录！

我想弄清楚为什么我会得到这些例外！

这是我的代码：

```
var dataCommand = new SqlCommand();
dataCommand.Connection = dataConnection;

dataCommand.Parameters.AddWithValue("@station", _stationId);
dataCommand.Parameters.AddWithValue("@indoor_temp", _indoorTemp);
dataCommand.Parameters.AddWithValue("@outdoor_temp", _outdoorTemp);
dataCommand.Parameters.AddWithValue("@dewpoint", _dewPoint);
dataCommand.Parameters.AddWithValue("@rel_humidity_indoor", _relHumidityIndoor);
dataCommand.Parameters.AddWithValue("@rel_humidity_outdoor", _relHumidityOutdoor);
dataCommand.Parameters.AddWithValue("@wind_speed", _windSpeed);
dataCommand.Parameters.AddWithValue("@wind_direction_degrees", _windDirectionDegrees);
dataCommand.Parameters.AddWithValue("@wind_direction_text", _windDirectionText);
dataCommand.Parameters.AddWithValue("@wind_chill", _windChill);
dataCommand.Parameters.AddWithValue("@rain1h", _rain1H);
dataCommand.Parameters.AddWithValue("@rain24h", _rain24H);
dataCommand.Parameters.AddWithValue("@rain_total", _totalRain);
dataCommand.Parameters.AddWithValue("@relative_pressure", _relativePressure);
dataCommand.Parameters.AddWithValue("@tendency", _tendency);
dataCommand.Parameters.AddWithValue("@forecast", _forecast);

dataCommand.CommandType = CommandType.Text;
dataCommand.CommandText =
                         "INSERT INTO"
                         + " dbo.WeatherData(station_id, indoor_temp, outdoor_temp, dewpoint," +
                            "rel_humidity_indoor, rel_humidity_outdoor, wind_speed, wind_direction_degrees," +
                            "wind_direction_text, wind_chill, rain1h, rain24h, rain_total, relative_pressure," +
                            "tendency, forecast)"
                            + "VALUES " +
                            "(@station, @indoor_temp, @outdoor_temp, @dewpoint, @rel_humidity_indoor," +
                            "@rel_humidity_outdoor, @wind_speed, @wind_direction_degrees," +
                            "@wind_direction_text, @wind_chill, @rain1h, @rain24h, @rain_total," +
                            "@relative_pressure, @tendency, @forecast)";

// execute the insert command
dataCommand.ExecuteNonQuery(); 
```

谢谢你的帮助！

# ef-code-first - 实体框架代码优先迁移 - 启用迁移失败

> ID：13144827
> 
> 赞同：4
> 
> 时间：2012-10-30T17:48:44.360
> 
> 标签：ef-code-first, entity-framework-5, entity-framework-migrations

我一直在尝试使用代码优先迁移，并且取得了一些有限的成功，但我弄错的一件事是我没有告诉它哪个项目有配置信息。它为我生成了一些类，我有点让它全部工作，但我认为我应该解决配置问题并重新开始。

糟糕的错误。现在我已经尝试删除所有迁移的东西，我发现我无法重新安装它。我已经卸载并重新安装了 EF 5，但是当我使用该`Enable-Migrations`命令时，我得到一个异常报告：

> System.Runtime.Serialization.SerializationException：未解析成员“System.Data.Entity.Migrations.Design.ToolingFacade+GetContextTypeRunner,EntityFramework, Version=4.4.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089”的类型。

无论我现在做什么，我似乎都无法超越。有任何想法吗？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-11-26T20:08:26.850

这发生在我身上是因为我的项目路径中有一个特殊字符 - 特别是与号*&*。我删除了＆符号，然后一切都像一个魅力。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-30T18:06:55.137

好吧，我不知道为什么这从一开始就不是问题，但事实证明，这个问题是由于我有一些针对 .NET 4.5 的项目和一些针对 .NET 4.0 的项目引起的。这意味着这些项目使用不同版本的 EF 5（v5 与 v4.4），我认为这是导致问题的原因；它试图加载错误版本的 DLL。

当我从我的解决方案中卸载面向 .NET 4.5 的项目时，我可以在面向 .NET 4 的项目上使用 Enable-Migrations。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-07-26T23:13:51.343

我发现了另一种可能发生此问题的方式，因此我想在这里分享它以供将来参考:-)。

在我们的例子中，我们的`Web.config`文件中有一个无效的绑定重定向：

```
<dependentAssembly>
   <assemblyIdentity name="EntityFramework" publicKeyToken="b77a5c561934e089" culture="neutral" />
   <bindingRedirect oldVersion="0.0.0.0-6.0.0.0" newVersion="6.2.0.0" />
   <codeBase version="6.0.0.0" href="libs/EntityFramework.dll" />
</dependentAssembly> 
```

即使 NuGet 包版本是**6.2**，程序集版本仍然是**6.0.0.0**。使用此重定向可能不会导致代码出现问题，但会破坏 powershell EF 命令以及`migrate.exe`工具。

解决方案是删除绑定或使用正确的版本 - **6.0.0.0**。

```
<dependentAssembly>
   <assemblyIdentity name="EntityFramework" publicKeyToken="b77a5c561934e089" culture="neutral" />
   <bindingRedirect oldVersion="0.0.0.0-6.0.0.0" newVersion="6.0.0.0" />
   <codeBase version="6.0.0.0" href="libs/EntityFramework.dll" />
</dependentAssembly> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-09-15T07:06:01.747

写这个原因也许有一天它会对某人有所帮助 - 只是遇到了同样的问题并且（愚蠢的）问题是连接字符串中的错误主机名。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-01-24T04:51:26.823

我的项目收到了这个命名约定错误。MyProject.MyProject.Web、MyProject.MyProject.EntityFramework 等

我将其更改为 MyProject.MyProject2.Web 等。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-08-07T14:26:58.887

我的项目文件夹路径有一个单词 Q&A。一旦我更改为 QA 并重新运行迁移，这个问题就消失了。避免在项目路径中的任何文件夹名称中使用“&”字符。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-06-26T08:57:00.917

我遇到了同样的问题，这可能是由于更改项目名称和/或将其移动到我的项目文件夹结构中造成的。无论如何，通过重新创建项目并手动导入（添加现有项目）我的所有 .cs 文件，然后添加新的迁移来解决这个问题。

# algorithm - 快速排序相同数字的数组

> ID：13144831
> 
> 赞同：2
> 
> 时间：2012-10-30T17:49:12.700
> 
> 标签：algorithm, sorting, quicksort

我正在尝试学习快速排序算法的工作原理。我通过阅读 CLR 算法书来做到这一点。我似乎无法弄清楚该算法如何适用于相同数字的数组，并且我无法在网上找到任何示例。例如，快速排序算法的进展是什么：

```
{5h, 5i, 5j, 5k, 5m, 5n} 
```

其中字符 (h,i,j,k,m,n) 仅用于区分各种 5 提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T02:32:21.497

[如果他们使用合理的变量名称，那本该死的书本](https://rads.stackoverflow.com/amzn/click/com/0262033844)可以更容易消化，但我猜他们不想偏离用于所有数学的正常单字母变量约定。

我试图保留它们的函数和变量名称，并且几乎复制了代码，包括它们使用的“数组从 1 开始”约定。我模仿了非随机枢轴版本。

演示：http: [//jsfiddle.net/p7R99/](http://jsfiddle.net/p7R99/)

或者只是将以下内容放入 .html 文件中

```
<pre id="out">
</pre>

<script>
function QUICKSORT(A, p, r) {
    if (p < r) {
        var q = PARTITION(A, p, r);
        output("q=" + q + " and A=" + arr(A) + "\n");
        QUICKSORT(A, p, q - 1);
        QUICKSORT(A, q + 1, r);
    }
}

function PARTITION(A, p, r) {
    var x = A[r];
    var i = p - 1;
    for (var j = p; j < r - 1; j++) {
        if (intval(A[j]) <= intval(x)) {
            i = i + 1;
            swap(A, i, j);
        }
    }
    swap(A, i + 1, r);
    return i + 1;
}

function intval(str) {
    return parseInt(str, 10);
}

function swap(A, i, j) {
    var tmp = A[i];
    A[i] = A[j];
    A[j] = tmp;
}

function output(msg) {
    var ele = document.getElementById("out");
    ele.innerHTML += msg;
}
function arr(A) {
    return A.slice(1).join(" ");
}

var A = [undefined, "5h", "5i", "5j", "5k", "5m", "5n"];
QUICKSORT(A, 1, A.length);
</script> 
```

结果

```
q=1 and A= 5i 5j 5k 5m 5n 5h
q=6 and A= 5i 5j 5k 5m 5h 5n
q=4 and A= 5i 5j 5m 5k 5h 5n
q=2 and A= 5j 5i 5m 5k 5h 5n 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T17:59:12.953

这是快速排序可以提供 O (n^2) 性能的少数情况之一，因为（实施不那么谨慎）您的一个分区可能最终为空。

如果您事先了解输入并且它们大多相同，您可能需要考虑[计数排序](http://en.wikipedia.org/wiki/Counting_sort)或[三向快速排序](http://stas-blogspot.blogspot.sg/2010/10/all-you-need-to-know-about-quicksort.html)

# asp.net-mvc - 在 ASP.NET MVC Web 应用程序中包含 Shopify & Stripe

> ID：13144833
> 
> 赞同：2
> 
> 时间：2012-10-30T17:49:21.670
> 
> 标签：asp.net-mvc, twitter-bootstrap, shopify, kentico, stripe-payments

是否有任何清晰的分步教程解释如何将我已经使用 Stripe 的 shopify 商店包含到使用 Kentico CMS 的电子商务网站的 MVC 应用程序中？

是不是像使用 JSON 调用 Shopify API 一样简单？我知道您需要在视图中使用液体，但这可以与 Razor 结合使用吗？我正在使用 Kentico CMS，我听说它现在可以与 MVC 一起使用，但是非常有问题（也许这是在较新的版本中修复的？？）。另外——我是 Twitter bootstrap 的脚手架和插件以及 .less 文件的忠实粉丝。我已经在 mvc 应用程序中使用过它，并且我假设它可以在 kentico 和/或 liquid 中工作，但只是想知道是否有人尝试过在液体页面中使用 twitter bootstrap 或与 Kentico 集成。我假设它可以很好地与 kentico 配合使用，因为它只是 css 和脚本。

基本上，我的问题是

*   Kentico CMS 是否适合与 .NET MVC 一起使用？如果不是，那么 N2 或其他 .net CMS 呢？
*   液体代码可以与剃须刀代码一起使用吗？
*   在 .net mvc 视图中使用或集成 shopify 页面有多难？
*   有没有人在流动页面或 Kentico 中使用 Twitter Bootstrap 的经验？

我可以找到这些信息的点点滴滴，但我只是希望那里有人已经记录了这一点。任何链接或提示将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T06:13:43.433

我只能回答关于使用 Kentico 的一些问题。

Kentico 在 bootstrap 和 less 上运行良好，但请确保您在设置中关闭允许 css 缩小，否则您将收到错误。我个人已经将 dotless 和 less.js 与 kentico 一起用于 bootstrap。

站点管理器 > 设置 > 系统 > 性能 > 资源。

此外，我从来没有发现 Kentico 在 MVC 中的工作非常好。它甚至是 Kentico 自己推荐的最不推荐的模板引擎。另一方面，Orchard CMS 非常适合与 MVC 一起使用，但它相当年轻并且缺乏很多功能。

# objective-c - IOS-用于尝试/捕获加载Json

> ID：13144843
> 
> 赞同：0
> 
> 时间：2012-10-30T17:50:14.937
> 
> 标签：objective-c, ios, exception-handling, error-handling, try-catch

我正在从服务器加载数据，但有时服务器未连接（错误）。

我想用 Try/Catch 或其他东西来避免错误应用

1：在加载数据时尝试/cactch 2：在图像中尝试/catch

我不知道怎么用 我写的代码是：

```
@try
{
 dispatch_async(htvque, ^{
        NSData* data = [NSData dataWithContentsOfURL: [NSURL URLWithString:listChannel]];
        NSError* error;
        jsonTable = [NSJSONSerialization JSONObjectWithData:data options:kNilOptions error:&error];
        if (error) {
            NSLog(@"%@", error);
        }
        else
        {
             NSMutableArray *arrImage = [jsonTable objectForKey:@"ListImage"];
        for (int i =0; i<arrImage.count; i++) {
            UIImage * result;
            UIImageView *imgView = [[UIImageView alloc] init];
            imgView.frame  = CGRectMake(0, 30 * i , 20, 20);
            imgView.image = result;
            @try
            { 
               NSData * data = [NSData dataWithContentsOfURL:[NSURL URLWithString:                               [arrImage objectAtIndex:i]]];
               result = [UIImage imageWithData:data];
               [self.view addSubview:imgView];
            }
            @catch
            {}
            @finally
            {}

        }

        }
    });
}
@catch(NSException * exp)
{
  NSLOG(@"abc");
}
@finnaly
{

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T18:04:44.953

不要为此目的为您的 ObjC 程序使用异常。

在 ObjC 中，仅在以下情况下保留使用异常：

*   你不打算恢复
*   当你不打算恢复

-*如果*有一个例外甚至是合适的（我只是不使用它们，但这对很多人来说有点太“核心”了）。

无论如何 - ObjC 中的异常表示程序员错误，并且在逻辑上是您无法期望从中恢复的东西（与其他语言不同）。找出你的错误是什么，而不是“尝试并吞下”错误处理。

我建议的补救措施是创建一个新问题，其中显示适当的代码，并详细说明异常、如何重现它等。

* * *

*注意：实际上有一些古怪的 Cocoa API 会抛出较少的异常情况，而它们应该只是使用另一种错误处理方法，例如`NSError`. 您将在开发中看到的绝大多数 Cocoa 异常都是您应该并且可以纠正的问题（范围错误、不响应选择器、引用计数）。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T18:46:41.923

我认为这将是一种相当稳健的方式来做你想做的事。我希望该示例在不依赖 try/catch 的情况下显示很多错误检查

```
dispatch_async(htvque, ^{
    NSError* error = nil;
    NSData* data = [NSData dataWithContentsOfURL:[NSURL URLWithString:listChannel] options:0 error:&error];
    if (error) { NSLog(@"%@", error); return; }

    NSDictionary *jsonTable = [NSJSONSerialization JSONObjectWithData:data options:kNilOptions error:&error];
    if (error) { NSLog(@"%@", error); return; }
    if (![jsonTable isKindOfClass:[NSDictionary class]]) { NSLog(@"jsonTable is not an NSDictionary: %@", jsonTable); return; }

    NSArray *images = [jsonTable objectForKey:@"ListImage"];
    if (![images isKindOfClass:[NSArray class]]) { NSLog(@"images is not an NSArray: %@", images); return; }

    NSMutableArray *dataForImages = [NSMutableArray arrayWithCapacity:images.count];

    // Build up an array with all the image data. For simplicity sake, I'll just skip ones the fail to load.
    for (NSString *URLString in images) {
        if (![URLString isKindOfClass:[NSString class]]) { NSLog(@"URLString is not an NSString: %@", URLString); continue; }

        NSData* data = [NSData dataWithContentsOfURL:[NSURL URLWithString:URLString] options:0 error:&error];
        if (error) { NSLog(@"%@", error); continue; }

        [dataForImages addObject:data];
    }

    // MUST SWITCH TO MAIN QUEUE BEFORE UPDATING UI!!!!!!!
    dispatch_sync(dispatch_get_main_queue(), ^{
        // This is just a different way of iterating the array.
        [dataForImages enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop) {
            UIImage *image = [UIImage imageWithData:obj];
            if (!image) { NSLog(@"Could not create image from data at index %d", idx); return; }

            UIImageView *imageView = [[UIImageView alloc] initWithImage:image];
            imageView.frame = CGRectMake(0, 30 * idx , 20, 20);

            [self.view addSubview:imageView];
        }];
    });
}); 
```

这真的不应该是一个可行的解决方案，而是一个粗略的大纲。

# html - 动态图像无法正确显示

> ID：13144846
> 
> 赞同：0
> 
> 时间：2012-10-30T17:50:31.333
> 
> 标签：html, iis

我有一个显示动态图像的非常基本的页面。这是我非常简单的代码：

```
<html>
<body>
<p><img width=1024 height=768 src="../image/someImage.jpg"></p>
</body>
</html> 
```

图像每分钟被另一个程序刷新一次。问题是有时 html 页面不会在任何人的计算机上显示更新的图像，因此这不是本地缓存问题。我正在使用 IIS6。让它显示更新图像的唯一方法是停止和启动该站点的 IIS。

我的公司只使用 IE，但我也尝试在 FireFox 中查看它，结果也是如此。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T18:10:08.803

尝试禁用 IIS7 缓存：

*   启动 IIS 管理器（在开始菜单的搜索程序和文件中键入 IIS）
*   导航到连接树中的所需站点（默认网站）
*   打开输出缓存
*   编辑功能设置
*   取消选中启用缓存和启用内核缓存

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T19:07:15.043

为了快速修复，请在图像路径的末尾附加一个问号和一个随机数。PHP 示例：

```
<img src=".../images/someImage.jpg?<?=rand(1,100000)?>"> 
```

问题的真正根源可能是过期标头。您可能希望将图像的标头配置为在过去某个时间过期。谷歌搜索过期标题。

# oracle - 在 Oracle 中循环遍历 CURSOR 时使用 EXIT WHEN 指令是一种不好的做法吗？

> ID：13144848
> 
> 赞同：3
> 
> 时间：2012-10-30T17:50:41.473
> 
> 标签：oracle, coding-style, cursor, conditional

这听起来可能是一个愚蠢的问题，但我希望我能让自己足够清楚。

1.  谈到[Spaghetti Code](http://en.wikipedia.org/wiki/Spaghetti_code)时，它​​的基础是 GOTO 的使用。我有一个同行曾经说过*，如果我在代码末尾放置了一个断点，并且每次都没有到达这个断点，那就是有问题*。
2.  尽管如此，在 Oracle 包中使用结构是一个常见的（我会说是一个规则）[`EXIT WHEN`](http://docs.oracle.com/cd/B10500_01/appdev.920/a96624/04_struc.htm#8297) （通常随后是`%NOTFOUND` 测试）。

理所当然地认为 using`EXIT`会破坏编程流程，这不是 1 和 2 之间不匹配的东西吗？

每个人都在遵循不好的做法来使用 PL/SQL 进行编程吗？PL/SQL 是否不遵循这种特定的条件模式？

在 Oracle 的内部是否有任何性能原因使用此类语句？

抱歉，如果这个问题已经被问过，我找不到类似的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T01:10:56.777

保持代码简单是非常值得推荐的，所以我可以告诉你 PL/SQL 大师对它的看法：

注意：在某些情况下不推荐使用 CURSOR-FOR-LOOP。您可以考虑一种更智能的方式，根据您的需要选择单个 SELECT-INTO 或 BULK COLLECT。

[资料来源：关于光标 FOR 循环，Oracle 杂志，作者：Steven Feuerstein](http://www.oracle.com/technetwork/issue-archive/2008/08-nov/o68plsql-088608.html)

（参考：[Feuerstein，前二十个 PL/SQL 技巧和技术](http://www6.uniovi.es/oracle/sftop20.pdf)）：

> **循环**
> 
> **12\. 利用光标 FOR 循环。**
> 
> 游标 FOR 循环是我最喜欢的 PL/SQL 结构之一。它充分利用了语言的过程方面与 SQL 数据库语言的强大功能的紧密有效集成。它减少了从游标中获取数据所需编写的代码量。它大大减少了在您的编程中引入循环错误的机会 - 循环是程序中更容易出错的部分之一。这个循环听起来好得令人难以置信吗？好吧，它不是——这都是真的！
> 
> 假设我需要更新住在我的宠物旅馆 Share-a-Din-Din Inn 的所有宠物的账单。下面的示例包含一个匿名块，它使用光标 occupancy_cur 来选择 Inn 中所有住客的房间号和宠物 ID 号。过程 update_bill 将任何新的更改添加到该宠物的房间费用中。
> 
> ```
> DECLARE
>    CURSOR occupancy_cur IS
>     SELECT pet_id, room_number
>     FROM occupancy
>     WHERE occupied_dt = SYSDATE;
>    occupancy_rec occupancy_cur%ROWTYPE;
> BEGIN
>     OPEN occupancy_cur;
>     LOOP
>     FETCH occupancy_cur
>       INTO occupancy_rec;
>       EXIT WHEN occupancy_cur%NOTFOUND;
>       update_bill
>       (occupancy_rec.pet_id,
>       occupancy_rec.room_number);
>     END LOOP;
>     CLOSE occupancy_cur;
> END; 
> ```
> 
> 这段代码没有任何想象空间。除了定义游标（第 2 行），还必须显式声明游标的记录（第 5 行），打开游标（第 7 行），启动无限循环，从游标集中取一行到记录中（第 9 行），使用游标属性检查数据结束条件（第 10 行），最后执行更新。完成后，您必须记住关闭光标（第 14 行）。如果我将此 PL/SQL 块转换为使用游标 FOR 循环，那么我所拥有的只是：
> 
> ```
> DECLARE
> CURSOR occupancy_cur IS
>   SELECT pet_id, room_number
>   FROM occupancy WHERE occupied_dt =
>   SYSDATE;
> BEGIN
>   FOR occupancy_rec IN occupancy_cur
>   LOOP
>     update_bill (occupancy_rec.pet_id,
>     occupancy_rec.room_number);
>   END LOOP;
> END; 
> ```
> 
> 在这里，您可以看到光标 FOR 循环的美丽简洁！记录的声明一去不复返了。OPEN、FETCH 和 CLOSE 语句已经一去不复返了。不需要检查 %FOUND 属性。把一切都做好的烦恼一去不复返了。相反，您实际上对 PL/SQL 说：： Ò您和我都知道我想要每一行，并且我想将该行转储到与游标匹配的记录中。帮我处理好这个，好吗？”PL/SQL 确实会处理它，就像任何与 SQL 集成的现代编程语言一样。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T04:37:10.487

是的，很多人都在遵循一种不好的做法。

**坏作风**

我同意@Osy 的观点，即 OPEN/FETCH/CLOSE 添加了完全不必要的代码。我会更进一步，说你几乎不应该使用`CURSOR`.

首先，您通常希望尽可能多地使用纯 SQL。如果您需要使用 PL/SQL，请使用隐式游标。它将为您节省一行代码，并帮助您将相关逻辑更紧密地联系在一起。

我坚信保持单个代码单元尽可能小。乍一看，它似乎`CURSOR`可以帮助您做到这一点。你可以在一个地方定义你的 SQL，然后再做 PL/SQL 循环。

但实际上，额外的间接层几乎不值得。有时很多逻辑在 SQL 中，有时很多逻辑在 PL/SQL 中。但在实践中，在两者中加入大量复杂逻辑几乎没有意义。您的代码通常最终看起来像以下之一：

```
for records in (<simple SQL>) loop
    <complex PL/SQL>
end loop; 
```

或者：

```
for records in
(
    <complex SQL>
) loop
    <simple PL/SQL>;
end loop; 
```

无论哪种方式，您的代码部分之一都将非常小。分离这两个代码部分的复杂性大于更大的单个代码部分的复杂性。（但这显然是我的意见。）

**表现不佳**

使用 OPEN/FETCH/CLOSE 会对性能产生重大影响。该方法比使用游标循环或隐式游标*慢得多。*

编译器可以在某些 for 循环中自动使用批量收集。但是，引用 Oracle 演示文稿[“PL/SQL 性能——揭穿神话”](http://www.oracle.com/technetwork/database/features/plsql/plsql-performance-debunking-the-myt-131194.zip)，第 122 页：

> 不要通过使用 open、fetch 循环、close 形式放弃这个机会

这是一个简单的例子：

```
--Sample data
create table t(a number, b number);
insert into t select level, level from dual connect by level <= 100000;
commit;

--OPEN/FETCH/CLOSE
--1.5 seconds
declare
    cursor test_cur is
    select a, b from t;
    test_rec test_cur%rowtype;
    counter number;
begin
    open test_cur;
    loop
        fetch test_cur into test_rec;
        exit when test_cur%notfound;
        counter := counter + 1;
    end loop;
    close test_cur;
end;
/

--Implicit cursor
--0.2 seconds
declare
    counter number;
begin
    for test_rec in (select a, b from t) loop
        counter := counter + 1;
    end loop;
end;
/ 
```

# php - 将变量从 Javascript/JQuery 传递给 PHP

> ID：13144849
> 
> 赞同：1
> 
> 时间：2012-10-30T17:50:45.937
> 
> 标签：php, jquery, ajax, variables

我还是 JQuery 的新手，正在尝试学习如何在不刷新页面的情况下提交表单......我想要的是，当提交表单时，我在“标题”和“副标题”上键入的值可以传递到php 变量（所以我可以回显/插入数据到数据库等）

所以，我把

```
"<? echo $_POST['headline']; ?>" 
```

上

```
<span class="save-notice">Your change has been saved! <? echo $_POST['headline']; ?></span> 
```

但是当我填写表格并单击提交按钮时，它只显示“您的更改已保存！”。这意味着，该变量不能传递给 PHP。

HTML 和 JS 合并为 1 个文件。我将 URL 方法保留在 .ajax 上，因为它是在同一个文件中处理的。

**HTML 表格**

```
<div id="submit-form">
<form action="" id="select-block" class="general-form">
<div class="input-wrap">
    <input class="clearme" name="Headline" value="Your headline here" id="headline"/>
</div>
<div class="input-wrap">
    <textarea class="clearme" name="Sub-Headline" id="subheadline">Sub Headline Here</textarea>
</div>

<input type="submit" class="submit-btn" value="SAVE" />
<span class="save-notice">Your change has been saved! <? echo $_POST['headline']; ?></span>
</form>
</div> 
```

**和 JQUERY 代码**

```
<script type="text/javascript">

$(function() {  
  $(".save-notice").hide();
  $(".submit-btn").click(function() {  

    var headline = $("input#headline").val();
    var subheadline = $("textarea#subheadline").val();
    var dataString = 'headline='+ headline + '&subheadline=' + subheadline;
    alert(dataString)

        $(".save-notice").hide();
        $.ajax({  
        type: "POST",  
        url: "",
        data: dataString,
        success: function() {  
            $(".save-notice").show();
        }  
    });  
return false;  
  });  
});  

</script> 
```

如果可以这样做，我在互联网上的几个示例/教程中看到了。你能建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T18:05:04.550

见 [http://api.jquery.com/serialize/](http://api.jquery.com/serialize/)

而不是将代码添加到单击处理程序

```
$(".submit-btn").click(function() { ...  } 
```

使用提交处理程序

```
$("#select-block").submit(function() {  
// your code
  var dataString = $(this).serialize();

}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T17:59:30.930

在`$_POST['headline']`你`save-notice`的页面加载时生成。PHP 运行，并输出一个 HTML 文件。

当您发出 AJAX 请求时，返回到 AJAX 调用的页面将包含您的新值，但您的当前页面不包含。

您可以发布到不同的页面，让该页面返回一个值，然后使用 JavaScript 更改 div 的值。

或者，您可以尝试从返回的 HTML 页面中提取数据。

```
$(".save-notice").hide();
$.ajax({
    type: "POST",
    url: "",
    data: dataString,
    dataType: 'html', // the page returned
    success: function(data) {
        // get the data from the returned page
        $(".save-notice").html($('.save-notice', data).html());
        $(".save-notice").show();
    }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T18:13:41.883

您已经拥有 javascript 变量中的值：

```
var headline = $("input#headline").val();
var subheadline = $("textarea#subheadline").val(); 
```

你可以这样做：

```
$.ajax({
    type: "POST",
    url: "foo.php",
    data: {headline: headline, subheadline: subheadline},
        success: function() {
            $(".save-notice").show();
        }
}); 
```

或像这样：

```
$.post("foo.php", { headline: headline, subheadline: subheadline }, 
    function(data) {
        $(".save-notice").show();
    }
); 
```

可以看到，数据是在键值对中传递的： `{ headline: headline, subheadline: subheadline }`

您可以使用`$_POST`like`$_POST['headline']`和`$_POST['subheadline']`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-30T18:42:16.340

使用 Firebug 的控制台功能，您可以看到服务器对您的 AJAX 调用的响应。响应正在评估 $_POST 变量，就像您希望的那样，但由于 AJAX 调用发生在幕后，您看不到它。

要使您的脚本无需太多修改即可运行，请尝试以下操作（无需 PHP）：

1.  替换`<? echo $_POST['headline']; ?>`为`<span id="yourheadline"><span>`
2.  `$('#yourheadline').html(headline);`在前一行插入`$(".save-notice").show();`

我建议的另一件事是序列化您的表单以创建 dataString var，而不是通过输入进行输入。如果您的输入被命名为`headline`and`subheadline`而不是`Headline`and `Sub-Headline`...

```
var dataString = $("#select-block").serialize(); 
```

...将完成与以下相同的事情：

```
var headline = $("input#headline").val();
var subheadline = $("textarea#subheadline").val();
var dataString = 'headline='+ headline + '&subheadline=' + subheadline; 
```

# asp.net - asp.net mvc 将 js 代码注入 Razor

> ID：13144850
> 
> 赞同：0
> 
> 时间：2012-10-30T17:50:51.323
> 
> 标签：asp.net, asp.net-mvc, razor

我该怎么做？

```
$for (var i = 0; i < model.CategoryList.length; i++) {
   var text = model.CategoryList;
   categories += '<span class="label label-info">' + @((AgesCategory)int.Parse( ..... )).GetDescription() + '</span>';
 } 
```

我需要将JS 代码中的**int.Parse( ..... ))**替换为**int.Parse(model.CategoryList[i])**。我无法将**文本**变量添加到**int.Parse(...)** intellisense 检测到此代码，如 c# 代码，而不是 JS。

**更新：**

我将尝试重新提出我的问题：如何从 JS 变量中设置值 C# 变量？

```
<script>
    var temp1 = 1;   // js var
    @{ string temp2 = 0 ;}  // c# var
    @{ temp2 = temp1 } // how do it?
    var temp2 = @(((MyEnumType)int.Parse(temp2).GetEnumDescription()));  //js var
</script> 
```

需要用什么？'@：' 或者是其他东西？在所有情况下，我都会收到语法错误

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T21:12:03.537

了解您可以在视图中的 <script> 块内使用 @ 表达式。如果您这样做，某些开发人员工具可能不会显示 JavaScript 代码块的代码着色或 Intellisense，但这不会影响站点编译和运行的能力。

HTH，粘土

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T08:11:04.273

我不认为这是可能的。因为 javascript 在运行时执行，C# 被编译，它不知道运行时 javascript 的值，所以会出错。

您可以对 C# 中的“动态”类型进行一些研究，这是在运行时使用的。

但是很抱歉，我不能在这里写一个演示，因为我对“动态”没有太多的经验，尽管我知道它可以在 C# 上做跨语言的事情。我只能给你这个建议。

# mysql - Mysql：如何使用 date_format

> ID：13144852
> 
> 赞同：0
> 
> 时间：2012-10-30T17:50:56.207
> 
> 标签：mysql

我试图使用这个 sql：

```
SELECT date_format(signdate , '%Y-%c-%d %h:%i:%s' ) as post_date , 
date_format(NOW(), '%Y-%c-%d %h:%i:%s' ) as post_date_gmt 
FROM `article`  where outkey = 'Y' 
```

post_date 的结果为空，但 post_date 正在工作。那么我如何使用函数 date_format 来格式化签名日期（例如：签名日期是 1095959971）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T17:54:29.053

[`DATE_FORMAT`](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_date-format)需要一`DATETIME`列。

你必须投它：

```
DATE_FORMAT(CAST(signdate AS DATETIME), ....) 
```

不过，最好有一个真正的 DATETIME 字段。

# php - 未定义的 fetchAll 并在返回的 PDOStatement 中获取

> ID：13144855
> 
> 赞同：4
> 
> 时间：2012-10-30T17:51:05.427
> 
> 标签：php, mysql, pdo, undefined

我刚刚开始使用 PDO，并在几个教程中查找了答案，但我无法让它工作。

我有

```
Notice: Undefined property: PDOStatement::$fetch in E:\-------- on line 22 
Result: 1 
```

和

```
$dsn = "mysql:host=localhost;dbname=the_database;";
try {
    $dbh = new PDO($dsn, "root", "");
    $dbh->setAttribute( PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION );
} catch (PDOException $e){
    die( "failed conexion: ".$e->getMessage() );
}

$query = "SELECT MAX(price) AS max, MIN(price) AS min FROM cellphones";
try {
    $sth = $dbh->prepare($query);
    $sth->execute();
    $sth->setFetchMode(PDO::FETCH_ASSOC);
    $result = $sth->fetchAll;
    }
catch(PDOException $e){
    echo $e->getMessage();
    }
die( "<br />Result: ".print_r($result, true) ); 
```

我得到相同的结果

```
$sth = $dbh->query($query);
$result = $sth->fetchAll; 
```

和

```
$sth = $dbh->prepare($query);
$sth->execute();
$result = $sth->fetch; 
```

我得到的是它可能会返回结果计数但是为什么呢？以及为什么它给我一个关于 fetch / fetchAll 甚至没有声明的通知。我也没有任何例外。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-30T17:56:07.190

您需要使用带括号的方法调用：

```
$sth->fetchAll(); 
```

或 $sth->fetch();

不只是

```
$sth->fetchAll; 
```

PHP 认为您试图访问一个名为 fetchAll 的属性！

# content-management-system - QR 码解析为 .htm 而不是 .html，需要 1 页才能执行相同操作

> ID：13144859
> 
> 赞同：0
> 
> 时间：2012-10-30T17:51:24.953
> 
> 标签：content-management-system, modx, modx-revolution

我有一个客户，每月印刷出版物和所述印刷出版物的在线代表。他们生成自己的 QR 码，并在本出版物中发布，并且与这些代码关联的链接通常以 .html 结尾。生成二维码时出现拼写错误，与二维码关联的 URL 改为以 .htm 结尾。我已经设置了 MODx Revo，以便友好的 URL 处于打开状态并以 .html 结尾。如何让这一单页显示为 .htm 而不是 .html？（而且我无法将整个站点更改为使用 .htm，因为许多其他现有的 QR 会损坏）

我已经尝试过：我复制了页面的源代码并将其保存在根目录中，扩展名为 .htm 而不是 .html 但当然 index.php 正在控制该站点并且它不会抓取“硬编码” ' 复制..

有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T18:34:34.203

问题已解决。下载了重定向器包，然后 301 重定向了它……我从一开始就想错了。哎呀。

# javascript - html的多个内联注释

> ID：13144860
> 
> 赞同：0
> 
> 时间：2012-10-30T17:51:30.107
> 
> 标签：javascript, html, css, comments

我正在尝试评论以下 html，以便它不应该转到超链接。

```
<a href="<!--http://www.google.com=-->" target="_blank" onclick="javascript:alert('Navigation Prevented')">CLICK HERE FOR GOOGLE</a> 
```

我无法评论 target="_blank"。如果我这样做它不起作用，它也会在页面上显示 javascript。

如何让页面显示警报以及停止在新选项卡中打开页面。我希望取消 target="_blank" 的效果。

我们不能为 html 内联多个评论吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T17:54:05.107

### 元素的属性值内不能有注释标签。

您可以通过添加一个`return false;`. 这会阻止浏览器跟踪该链接：

```
<a href="http://www.google.com" target="_blank"
   onclick="javascript:alert('Navigation Prevented'); return false;">CLICK HERE FOR GOOGLE</a> 
```

### 小提琴：http: [//jsfiddle.net/rBmjs/](http://jsfiddle.net/rBmjs/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T17:54:12.093

```
<a href="google.com" target="_blank" onclick="javascript:alert('Navigation Prevented');return false;">CLICK HERE FOR GOOGLE</a> 
```

其中最重要的部分是`return false;`on`onclick`属性。这指示浏览器在单击后立即取消此链接。所以会发生的是javascript将被执行，但链接*不会*被跟踪。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-30T17:54:27.913

HTML 标记内不能有 HTML 注释，因为注释本身就是一个标记。

您可以`false`从事件处理程序返回以阻止浏览器跟踪链接：

```
<a href="http://www.google.com" target="_blank" onclick="javascript:alert('Navigation Prevented');return false;">CLICK HERE FOR GOOGLE</a> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-30T18:13:44.150

在看到其他用户说评论不能包含在元素属性中后，我开始想知道为什么。当然这是一个不好的做法，但为什么它不工作呢？

我检查了[HTML5 注释](http://www.w3.org/TR/2011/WD-html5-20110113/syntax.html#comments)和[HTML4.01 注释](http://www.w3.org/TR/html401/intro/sgmltut.html#h-3.2.4)的规范，答案在 4.01 规范中：

> 请注意，注释是标记

注释的`<!`一部分只是打开一个声明，然后`>`关闭它。它是`--`将声明标识为注释的字符串。当将注释语法与 doctype 声明和 CDATA 部分进行比较时，这一点变得很明显。

因为您不能将声明放在属性值中（我无法在规范中找到明确说明，但这似乎很明显），所以注释不能包含在属性值中。

有趣的是，[HTML5 评论](http://www.w3.org/TR/2011/WD-html5-20110113/syntax.html#comments)部分没有提到“评论是标记”注释。但是，我确信同样的规则仍然适用。

如果这有任何错误，请随时发布更正。

# asp.net - 身份验证超时无法正常工作

> ID：13144868
> 
> 赞同：3
> 
> 时间：2012-10-30T17:51:58.577
> 
> 标签：asp.net, timeout

我有一个 ASP.NET 4 站点。我在 web.Config 中的身份验证中将超时设置为 100 分钟，但是当用户突然使用站点时，即使 3 分钟后站点也会提示登录。下面的代码是我的 web.Config 文件

```
 <?xml version="1.0" encoding="utf-8"?>
    <!--
    For more information on how to configure your ASP.NET application, please visit
    http://go.microsoft.com/fwlink/?LinkId=169433
    -->
    <configuration>
    <appSettings>
    <add key="ImageMaxFileLengh" value="500" />
    </appSettings>
  <system.web>
    <pages enableViewStateMac="false"></pages>
    <compilation debug="true" targetFramework="4.0">
      <assemblies>
        <add assembly="System.Data.Entity, Version=4.0.0.0, Culture=neutral,   PublicKeyToken=b77a5c561934e089" />
        <add assembly="System.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A" />
        <add assembly="System.Windows.Forms, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089" />
        <add assembly="System.Speech, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
      </assemblies>
    </compilation>
    <authentication mode="Forms">
      <forms defaultUrl="~/Default.aspx" loginUrl="~/Account/Login.aspx" timeout="100" name="HajLogin" slidingExpiration="true" />
    </authentication>
    <!--<membership>
      <providers>
        <clear />
        <add name="AspNetSqlMembershipProvider" type="System.Web.Security.SqlMembershipProvider" connectionStringName="ApplicationServices" enablePasswordRetrieval="false" enablePasswordReset="true" requiresQuestionAndAnswer="false" requiresUniqueEmail="false" maxInvalidPasswordAttempts="5" minRequiredPasswordLength="6" minRequiredNonalphanumericCharacters="0" passwordAttemptWindow="10" applicationName="/" />
      </providers>
    </membership>
    <profile>
      <providers>
        <clear />
        <add name="AspNetSqlProfileProvider" type="System.Web.Profile.SqlProfileProvider" connectionStringName="ApplicationServices" applicationName="/" />
      </providers>
    </profile>
    <roleManager enabled="false">
      <providers>
        <clear />
        <add name="AspNetSqlRoleProvider" type="System.Web.Security.SqlRoleProvider" connectionStringName="ApplicationServices" applicationName="/" />
        <add name="AspNetWindowsTokenRoleProvider" type="System.Web.Security.WindowsTokenRoleProvider" applicationName="/" />
      </providers>
    </roleManager>-->
    <httpHandlers>
      <add path="Telerik.Web.UI.WebResource.axd" type="Telerik.Web.UI.WebResource" verb="*" validate="false" />
    </httpHandlers>
  </system.web>
  <system.webServer>
    <modules runAllManagedModulesForAllRequests="true" />
    <validation validateIntegratedModeConfiguration="false" />
    <handlers>
      <add name="Telerik_Web_UI_WebResource_axd" verb="*" preCondition="integratedMode" path="Telerik.Web.UI.WebResource.axd" type="Telerik.Web.UI.WebResource" />
    </handlers>
  </system.webServer>
</configuration> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-30T18:07:37.910

确保您没有在代码中创建 FormsAuthenticationTicket。这将覆盖您在 web.config 中配置的超时值。如果您在代码中执行此类操作，则可能是它不起作用的原因：

```
FormsAuthenticationTicket ticket = new FormsAuthenticationTicket
(
   ...
   DateTime.Now, // issueDate
   DateTime.Now.AddMinutes(30), // expiration
   ...
 ); 
```

如果您没有执行上述操作，请查看您的 SessionTimeout。尝试增加它。

问候。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-30T18:03:47.517

请不要将验证超时与会话超时混淆。

在寻求身份验证时，您将表单 1000 设置为超时。一旦它通过身份验证，您就不会查看此变量以使经过身份验证的会话到期。

以下是一些描述差异的好链接：

*   [链接 1](http://completedevelopment.blogspot.com/2009/12/caution-with-using-sessiontimeout-and.html)
*   [链接 2](https://stackoverflow.com/questions/1470777/forms-authentication-timeout-vs-session-timeout)（堆栈溢出）

这是一个很好的链接，描述了在表单身份验证中设置会话超时：

*   [链接 3](https://stackoverflow.com/questions/648992/session-timeout-in-asp-net)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-06-05T12:39:43.607

Forms 标记中的 Timeout 属性指定当记住我复选框被选中时**持久 cookie有效的分钟数。**

# php - 由于它们在 php 中的循环中缺少任何加载？

> ID：13144869
> 
> 赞同：-4
> 
> 时间：2012-10-30T17:51:59.873
> 
> 标签：php, loops

```
$listget=file_get_contents('http://mysite.com/list');

$list=explode('target="_',$listget);
$count=count($list);
$i='2';
for ($i=2 ; $i <= ($count-4) ; $i++) {

//function or statement here

if($my_statement===false){
  show cancel
    else{
      show second matter
         if($my_statement===false)
          {//nothing is here
            }
        else{
          show success with data}
          }
          }

else{
    show 1st matter
        if($my_statement===false)
             {
           //nothing is here}
        else{
           show success with data }
} 
```

这段代码运行良好。但是当列表数量如此之大（即超过 100 个单词）时，它会在一段时间后停止工作。是循环中的问题还是任何地方的问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T17:55:54.933

最大执行时间默认为 30 秒。

您可以使用 php 文件检查您的实际设置

```
<?
phpinfo();
?> 
```

如果可能，更改您的 php.ini 设置或使用 php cli。但请注意服务器整体性能问题。

[最长执行时间](http://php.net/manual/en/info.configuration.php)

# python - 如何在 Python 中公平地将任务分配给工作人员？- 将可迭代拆分成类似大小的块

> ID：13144880
> 
> 赞同：0
> 
> 时间：2012-10-30T17:52:32.153
> 
> 标签：python, python-3.x, split, itertools, iterable

我有工人和任务要做：

```
workers = ['peter', 'paul', 'mary']
tasks = range(13) 
```

现在我想将任务拆分成块或批次的工作，这样每个工人就可以处理一个批次，并且做的工作量与其他人大致相同。在我的现实生活中，我想将批处理作业安排到计算场。批处理作业应该并行运行。实际的调度和调度是由商业级工具如 lsf 或 grid 完成的。

我期望的一些例子：

```
>>> distribute_work(['peter', 'paul', 'mary'], range(3))
[('peter', [0]), ('paul', [1]), ('mary', [2])]
>>> distribute_work(['peter', 'paul', 'mary'], range(6))
[('peter', [0, 3]), ('paul', [1, 4]), ('mary', [2, 5])]
>>> distribute_work(['peter', 'paul', 'mary'], range(5))
[('peter', [0, 3]), ('paul', [1, 4]), ('mary', [2])] 
```

[这个问题与这里](https://stackoverflow.com/q/12285115/923794)、[这里](https://stackoverflow.com/q/5850536/923794)和[这里](https://stackoverflow.com/q/434287/923794)的问题非常相似

不同之处在于我想要这些功能，按顺序或优先顺序：

1.  尽可能不使用`len`内部长数据结构
2.  接受生成器
3.  返回发生器
4.  尽可能多地使用 stdlib 组件

关于要求的一些旁注：

*   没有故意的命令：我有同名的工人可以做多个批次（unix 主机名）。如果您的解决方案使用 dicts，那很好，因为我们总是可以通过批量枚举进行工作人员查找。
*   任意长度：worker 和 tasks 都可以是任何长度 >= 1 的迭代。并且它们不必像上面示例中所示的平均拆分，其中 Mary 只得到一个任务。
*   秩序：对我来说并不重要。我猜其他人可能更喜欢 [0,1]、[2,3]、[5] 之类的顺序，但我不在乎。如果您的解决方案可以保持或切换顺序，也许值得向其他人指出。

我试图解决`itertools`这个特殊的问题，并想出了以下代码来说明这个问题：

```
from itertools import *

def distribute_work(workers, tasks):
    batches = range(len(workers))
    return [ ( workers[k],
               [t[1] for t in i]
               )   for (k,i) in groupby(sorted(zip(cycle(batches),
                                                   tasks),
                                               key=lambda t: t[0]),
                                        lambda t: t[0]) ] 
```

这满足 4.，但排序很可能违反 1.. 和 2./3。甚至没有想过。

可能有一些简单的解决方案，以我没有想到的方式组合一些 stdlib 组件。但也许不是。有接盘侠吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T09:04:16.793

我想你想用它`multiprocessing.Pool.imap`来处理你的工人和分配他们的工作。我相信它会做你想做的一切。

```
jobs = (some generator)                   # can consume jobs from a generator
pool = multiprocessing.Pool(3)            # set number of workers here
results = pool.imap(process_job, jobs)    # returns a generator

for r in results:                         # loop will block until results arrive
    do_something(r) 
```

如果结果的顺序对您的应用程序无关紧要，您也可以使用`imap_unordered`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T17:55:50.453

一定要预批吗？

为什么不只是有一个队列，并让每个工作人员在完成一个工作单元时退出队列？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-30T19:43:32.947

按照[泰勒的回答](https://stackoverflow.com/a/13144923/36537)：

```
def doleOut(queue, workers):
    for worker,task in itertools.izip(itertools.cycle(workers),queue):
        yield worker,task 
```

`(worker, task)`只要有队列，这将继续返回元组。所以如果你有阻塞`waitForMoreWork`，你可以这样做：

```
queue = []
doler = distribute_work(workers, queue)
while 1:
    queue.append(waitForMoreWork)
    currentqueuelen = len(queue)
    for i in range(0,queuelen):
        worker,item = doler.next()
        worker.passitem(item) 
```

这样，它将阻塞直到有更多队列项目，然后分发这些项目，然后再次阻塞。您可以设置您的 waitForMoreWork 表达式，以便一次分发尽可能多的项目。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-31T10:24:00.617

好的，说了不可能，这里有一个想法。也许这是我应该转向 codereview 的东西 - 我非常有兴趣评论这会在内存中产生多少开销。换句话说，我不知道这是否真的解决了任务列表很长且大小未知的问题。正如[Blckknght 提到`multiprocessing`的可能是更好的选择](https://stackoverflow.com/a/13154416/923794)。

编码：

```
import itertools

def distribute_work(workers, tasks):
    """Return one generator per worker with a fair share of tasks

    Task may be an arbitrary length generator.
    Workers should be an iterable.
    """
    worker_count = len(workers)
    worker_ids = range(worker_count)
    all_tasks_for_all_workers = itertools.tee(tasks, worker_count)
    assignments = [ (workers[id], itertools.islice(i, id, None, worker_count))
                    for (id,i) in enumerate(all_tasks_for_all_workers) ]    
    return(assignments) 
```

该算法是

1.  为每个工人复制一次原始任务列表。由于这只是复制生成器对象，因此它应该与内存中任务列表的大小无关。即使这是一项相对昂贵的操作，它也只是一次启动成本，对于非常大的任务列表来说在内存中是微不足道的。
2.  要将任务分配给一个工作人员，每个工作人员必须获取任务列表的一部分。如果`#W`是工人的数量，第一个工人接任务`0`, `#W`, `2*#W`,`3*#W`等。第二个工人接`0+1`, `#W+1`, `2*#W+1`,`3*#W+1`等。每个工人的拼接可以用`itertools.islice`

对于纯粹的任务拆分/分配，此功能并不真正需要工作人员的姓名。但是工人的数量是。改变它会使函数更加通用和有用，并使返回值更容易理解。为了回答我自己的问题，我将保留该功能。

用法和结果：

```
>>> for (worker,tasks) in distribute_work(['peter', 'paul', 'mary'], range(5)):
...   print(worker, list(tasks))
... 
peter [0, 3]
paul [1, 4]
mary [2] 
```

它还处理工人具有相同名称但不同实体的情况：

```
>>> for (worker,tasks) in distribute_work(['p', 'p', 'mary'], range(5)): 
...   print(worker, list(tasks))
... 
p [0, 3]
p [1, 4]
mary [2] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-10-12T01:57:32.897

这是我喜欢的一种方法：

```
parallelism = os.cpu_count()
num_todos = len(todos)

# this zip fanciness makes each chunk stripe through the data sequentially overall so that the
# first items still get done first across all the workers
chunksize = math.ceil(num_todos / parallelism)
chunks = list(itertools.zip_longest(*[todos[i:i+chunksize] for i in range(0, num_todos, chunksize)]))
chunks = [[c for c in chunk if c is not None] for chunk in chunks]

with Pool(processes=parallelism) as pool:
    tasks = [pool.apply_async(my_function, args=(chunk)) for chunk in chunks]
    [task.get() for task in tasks] 
```

根据您是否需要累积结果，您可以进行调整，但对我来说有趣的部分是让工作人员协作以全局顺序完成工作（在我的情况下，处理图像的连续帧，以便我可以看到事情的样子所有的CPU都在启动）。

# javascript - 使用python解析js文件中的多个注释

> ID：13144883
> 
> 赞同：2
> 
> 时间：2012-10-30T17:52:54.353
> 
> 标签：javascript, python, regex, comments

我想获取 js 文件注释的内容。我尝试使用代码

```
import re
code = """
/*
This is a comment.
*/

/*
This is another comment.
*/

"""
reg = re.compile("/\*(?P<contents>.*)\*/", re.DOTALL)
matches = reg.search(code)

if matches:
    print matches.group("contents") 
```

我得到的结果是

```
This is a comment.
*/

/*
This is another comment. 
```

如何单独获取评论？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-30T17:54:32.890

使重复不贪婪：

```
"/\*(?P<contents>.*?)\*/" 
```

现在`.*`将消耗尽可能少而不是尽可能多。

要获得多个匹配项，您需要使用[`findall`](http://docs.python.org/2/library/re.html#re.findall)而不是`search`.

# java - 使用 Sql Server 2005 设置 Play 2.0 项目

> ID：13144887
> 
> 赞同：1
> 
> 时间：2012-10-30T17:53:14.073
> 
> 标签：java, sql, sql-server-2005, playframework, playframework-2.0

我之前将我的应用程序设置为使用 MySQL 数据库作为默认值，它运行良好。

现在我正试图让它与***SQL server 2005***一起工作。我尝试了这个和几个类似的变体：

## 应用程序.conf

```
db.default.url="jdbc:sqlserver://remoteServerName:Port"
db.default.driver=com.microsoft.jdbc.sqlserver.SQLServerDriver
db.default.user=correctUser
db.default.pass=correctPass 
```

但我收到以下错误：

```
Driver not found: [com.microsoft.jdbc.sqlserver.SQLServerDriver]
...
caused by: java.lang.ClassNotFoundException: com.microsoft.jdbc.sqlserver.SQLServerDriver 
```

乍一看，这似乎暗示构建路径中缺少 jdbc 驱动程序 JAR。问题是，它*并没有*从构建路径中丢失。sqljdbc4.jar 与其他所有内容都位于构建路径中。

我错过了什么吗？我不知道该去哪里。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T09:03:56.700

实际上，该错误似乎表明它没有正确加载您的 jar。有两种可能的解决方案。

1.  您需要将它添加到您的 build.scala 文件中。

    ```
    val appDependencies = Seq(
        "sqljdbc4" % "com.microsoft.sqlserver" % "3.0"
    ) 
    ```

2.  或者您可以将它添加到根项目文件夹中的 lib 文件夹中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T18:21:29.757

在您的 Play 应用程序的根目录下创建一个`lib`文件夹，然后将您的`sqljdbc4.jar`文件放在此`lib`文件夹下。

sbt 将在您的类路径中添加此文件夹和包含的 jar，并且该`dist`任务会将 jar 添加到生成的 zip 中。

# c# - 将 SQL varbinary 转换为图像和接收参数无效

> ID：13144895
> 
> 赞同：0
> 
> 时间：2012-10-30T17:53:56.363
> 
> 标签：c#

我正在尝试从 SQL 中提取数据并将其显示到 Windows 窗体上的图片框中。

编码：

```
// Use the customer number to obtain image from the DBFile table
Query.CommandText = "SELECT * FROM DBFile " +
    "WHERE " +
    "FileName = @FileName";

// Fill in the parameters
Query.Parameters.AddWithValue("@FileName", customerNumber + ".jpg");

// Build the DBFile data table
da = new SqlDataAdapter(Query);
cb = new SqlCommandBuilder(da);
da.Fill(DBFile);

// Dispose of SQL data
da.Dispose();
cb.Dispose();
Query.Dispose();

try
{
    byte[] bImage = new byte[0];
    bImage = (byte[])DBFile.Rows[0]["Data"];
    MemoryStream ms = new MemoryStream(bImage);
    pbLicense.Image = Image.FromStream(ms); // Error is thrown here
}
catch (Exception ex)
{
    MessageBox.Show(ex.Message);
} 
```

我的问题是，这是否是不仅获得所需数据而且将其转换为所需结果的正确方法，如果是，我错过了什么？我查看了许多教程和指南，但在我尝试的方面似乎都相似。

# java - 对象何时有资格进行垃圾收集？

> ID：13144899
> 
> 赞同：17
> 
> 时间：2012-10-30T17:54:15.017
> 
> 标签：java, garbage-collection

在下面的代码中，假设`amethod`已被调用。最初由 引用的对象在什么点/线有`myObject`资格进行垃圾收集？

```
class Test {
  private Object classObject;

  public void amethod() {
    Object myObject = new Object();
    classObject = myObject;
    myObject = null;
  }
} 
```

如果`classObject`或`amethod`具有公共、受保护、默认或静态的访问修饰符，它会影响对象符合垃圾收集条件的点吗？如果有，会受到怎样的影响？

*   我的第一个想法是，当 Test 对象符合垃圾回收条件时，该对象符合垃圾回收条件。
*   但话又说回来。优化器可能知道 classObject 永远不会被读取，在这种情况下`classObject = myObject;`将被优化出来，并且`myObject = null;`是它有资格进行垃圾收集的点。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-10-30T17:56:32.783

**在丢弃所有**对它的引用之前，该对象不会成为垃圾回收的候选对象。Java 对象是通过引用分配的，所以当你有

```
 classObject = myObject; 
```

您为堆上的同一对象分配了另一个引用。所以这条线

```
 myObject = null; 
```

只去掉一个参考。要成为`myObject`垃圾收集的候选者，您必须拥有

```
 classObject = null; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-08-17T16:31:36.807

从书**OCA Java SE 7**

> 当一个对象不再被访问时，它被标记为**有资格被垃圾回收，这可能在对象超出范围时发生。**当对象的引用变量被分配一个显式的空值或被重新初始化时，也会发生这种情况。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-11-15T15:58:36.603

这实际上由 Java 语言规范 [第 12.6.1 节，实现终结](https://docs.oracle.com/javase/specs/jls/se8/html/jls-12.html#jls-12.6.1)精确解决：

> 可以设计优化程序的转换，将可到达的对象的数量减少到比那些天真地认为是可到达的要少。例如，Java 编译器或代码生成器可能会选择设置一个不再使用的变量或参数，`null`以使此类对象的存储可能更快地被回收。
> 
> 如果对象字段中的值存储在寄存器中，则会出现另一个示例。然后程序可能会访问寄存器而不是对象，并且永远不会再次访问对象。这意味着该对象是垃圾。…</p>

**但**

> …请注意，只有当引用在堆栈中而不是存储在堆中时，才允许进行这种优化。
> 
> > 例如，考虑 Finalizer Guardian 模式：
> > 
> > ```
> >  class Foo {
> >        private final Object finalizerGuardian = new Object() {
> >            protected void finalize() throws Throwable {
> >                /* finalize outer Foo object */
> >            }
> >        }
> >    } 
> > ```
> > 
> > `super.finalize`如果子类覆盖并且`finalize`未显式调用`super.finalize`.
> > 
> > 如果允许对存储在堆上的引用进行这些优化，那么 Java 编译器可以检测到该`finalizerGuardian`字段从未被读取，将其清空，立即收集对象，并尽早调用终结器。这与意图背道而驰：程序员可能想在实例无法访问`Foo`时调用终结器。`Foo`因此，这种转换是不合法的：只要外部类对象可访问，内部类对象就应该是可访问的。

此示例可以 1:1 应用于您的示例，只要该对象被实例字段引用`classObject`，它就不会比`Test`包含该引用的实例更早地进行垃圾收集。

但是，请注意，在将规范中提到的激进优化应用于使用`Test`实例的代码时，仍然是允许的。只要将实例和引用的对象都收集在一起*，就可能发生早于预期的收集。*[在这种情况下，第12.6 节](https://docs.oracle.com/javase/specs/jls/se8/html/jls-12.html#jls-12.6)`Test`中规定的以下方面适用：

> Java 编程语言没有对 finalize 方法调用进行排序。终结器可以按任何顺序调用，甚至可以同时调用。

So it’s perfectly possible that the `Test` instance is collected earlier than the object referenced by `classObject` whereas the “inner” object’s finalizer is invoked earlier. The only thing that is guaranteed, is, that when the inner object’s finalizer runs, the outer object is unreachable (or has a pending or concurrent finalization). Since in your example, neither has a non-trivial finalizer, that doesn’t matter anyway…</p>

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-10-30T18:05:46.437

您认为私有对象可能会立即被 GC，因为没有其他代码能够访问它的想法确实有一些吸引力，但这会与 Java 内存管理的一般语义相混淆。例如，如果该对象已实现`finalize`，并且 Java 语义清楚地规定了对象何时符合垃圾回收条件，则必须根据规范调用该终结器方法。

另请注意，该对象反过来可能会引用其他对象，可能会产生更复杂的结果。更不用说反射可以随时访问该对象，`null`即使没有代码可以进行该分配，观察到的字段突然更改为也没有任何意义。

总而言之，您的优化想法在更广泛的情况下不起作用的原因有很多。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-30T17:58:02.847

此处没有对象符合垃圾回收条件，因为您正在为同一个对象创建两个引用，并且您仅将 null 赋予一个引用，但其他引用仍指向您的对象

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-30T17:58:02.680

由于您保留`myObject`（**引用被维护**`classObject`），它（通过classObject引用的内存中的对象）将不可用于垃圾收集，直到实例被释放/卸载。**`Test`**

 *** * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-06T11:07:23.290

> 在下面的代码中，假设 amethod 已被调用。myObject 最初引用的对象在哪一点/哪一行符合垃圾收集条件？

您的问题是荒谬的，因为您的高级源代码与垃圾收集器看到的低级表示（寄存器、堆栈和全局变量中的全局根）之间存在脱节。

您的短语“有资格进行垃圾收集”大概意味着堆分配的内存块在什么时候变得无法访问。因此，您的问题只能通过对堆分配的内容以及生成的代码将保留引用的时间做出很多（可疑的）假设来回答。**

# php - 如何获得行位置？

> ID：13144900
> 
> 赞同：2
> 
> 时间：2012-10-30T17:54:15.207
> 
> 标签：php, mysql, sql

> **可能重复：**
> [MySQL 在 ORDER BY 中获取行位置，](https://stackoverflow.com/questions/3614666/mysql-get-row-position-in-order-by)
> [在 PHP/MySQL 中计算排名](https://stackoverflow.com/questions/4845290/calculating-rank-in-php-mysql)

我有一个用php编写的游戏系统，每个用户有X金额。我有一个页面显示网站中最富有的用户。

```
$ranking = mysql_query("
    SELECT * 
    FROM users 
    ORDER BY money DESC 
    LIMIT 10
"); 
```

现在我想给每个用户他在列表中的位置。我不能选择所有信息并开始排序只是为了得到一个值，这是浪费资源。如何选择行的位置（其中 userid = X）？

(MYSQL)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T20:46:30.723

这是使用相关子查询执行此操作的简单且标准的方法：

```
SELECT *, (SELECT count(*) + 1 FROM users WHERE money > u.money) as MoneyRank
FROM users AS u
WHERE username = 'X' 
```

这是一个[SqlFiddle 演示](http://www.sqlfiddle.com/#!2/4edef/2)。

但是，这确实会遇到任何[“三角连接”](http://www.sqlservercentral.com/articles/T-SQL/61539/)（SQL Server 文章，但仍然适用）的性能问题。我最初仍然会以这种方式自己实现它（这很简单），然后在存在性能问题时进行索引，如果这还不够好，则继续使用其他预先计算/缓存的选项。评论还提到了其他可行的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T18:02:35.643

如果不进行全表排序，您将无法轻松/快速地做到这一点。我建议你只定期给每个人一个新的排名，也许每小时一次，并以这种方式更新他们的位置。

对于“排行榜”，您不会遇到此问题，因为您将始终受到偏移量和限制的限制。所以当你显示前 10 名（有限）时，你就知道他们的排名是 1 - 10。

*然而，仅仅选择一个单独的用户，如果没有一个非常*无效的表排序，你就无法做到这一点。

另外，请参阅this other question，哪个（我认为几乎完全重复？）

[在 PHP/MySQL 中计算排名](https://stackoverflow.com/questions/4845290/calculating-rank-in-php-mysql)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T17:58:02.253

`Rank`列将是列表中的位置：

```
SELECT t.*, 
   @rownum := @rownum + 1 AS rank
FROM users, (SELECT @rownum := 0) r
ORDER BY money DESC 
LIMIT 10 
```

# c# - 如何向下转换通用类型的实例？

> ID：13144902
> 
> 赞同：1
> 
> 时间：2012-10-30T17:54:21.643
> 
> 标签：c#, generics, casting, type-conversion

我正在为如何正确使用 C# 泛型而苦苦挣扎。具体来说，我希望有一个将泛型类型作为参数并根据泛型类型执行不同操作的方法。但是，我不能“向下转换”通用类型。请参见下面的示例。

编译器抱怨演员`(Bar<Foo>)`说“无法将类型转换`Bar<T>`为`Bar<Foo>`”。但是在运行时，演员是可以的，因为我已经检查了类型。

```
public class Foo { }

public class Bar<T> { }

// wraps a Bar of generic type Foo
public class FooBar<T> where T : Foo
{

    Bar<T> bar;

    public FooBar(Bar<T> bar)
    {
        this.bar = bar;
    }

}

public class Thing
{
    public object getTheRightType<T>(Bar<T> bar)
    {
        if (typeof(T) == typeof(Foo))
        {
            return new FooBar<Foo>( (Bar<Foo>) bar);  // won't compile cast
        }
        else
        {
            return bar;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-30T17:57:18.063

在这种情况下，编译器无法知道`Bar<T>`可以转换为`Bar<Foo>`，因为它通常不是真的。您必须通过在两者之间引入演员来“作弊” `object`：

```
return new FooBar<Foo>( (Bar<Foo>)(object) bar); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T18:05:35.163

这应该可以解决问题，而且您不必先强制转换`object`。

```
public class Thing
{
    public object getTheRightType<T>(Bar<T> bar)
    {
        if (typeof(T) == typeof(Foo))
        {
            return new FooBar<Foo>(bar as Bar<Foo>);  // will compile cast
        }
        else
        {
            return bar;
        }
    }
} 
```

# android - 如何将条目插入 SQLite 数据库

> ID：13144905
> 
> 赞同：1
> 
> 时间：2012-10-30T17:54:26.880
> 
> 标签：android, sqlite

我正在尝试从我的视图中获取一些数据，并在我的 android 应用程序中输入我的 SQLite 数据库。

```
 SQLiteDatabase db = openOrCreateDatabase("SemesterDB", MODE_PRIVATE, null);
    db.execSQL("CREATE TABLE IF NOT EXISTS Semesters (Session VARCHAR, YearStart INT," +
            " MonthStart INT, DayStart INT,YearEnd INT, MonthEnd INT, DayEnd INT )");

    //extract session from view
    Spinner sessionSpinner = (Spinner) findViewById(R.id.sessionSpinner);
    String session = (String) sessionSpinner.getSelectedItem();

    //extract start date from view
    DatePicker startDatePicker = (DatePicker) findViewById(R.id.semesterStartDate);
    int startDay = startDatePicker.getDayOfMonth();
    int startMonth = startDatePicker.getMonth();
    int startYear = startDatePicker.getYear();

    //extract end date from view
DatePicker endDatePicker = (DatePicker) findViewById(R.id.semesterEndDate);
    int endDay = startDatePicker.getDayOfMonth();
    int endMonth = startDatePicker.getMonth();
    int endYear = startDatePicker.getYear();

    String sessionName = (String) session+" "+startYear;

    db.execSQL("INSERT INTO Semesters VALUES(sessionName,startYear,startMonth,startDay,endYear,endMonth,endDay);");
    db.close(); 
```

- 所以当我将值硬编码到 db.execSQL("INSERT..... 行时，它工作得很好，但是当我尝试用存储的值插入变量时，它没有。有什么想法吗？

这是一个用 eclipse juno 编写的 android 2.3 应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T18:59:33.943

您的 db.execSQL 查询也可以对其进行一些修改。

```
 db.execSQL("INSERT INTO Semesters VALUES(" +
    sessionName + "," +
    startYear + "," +
    startMonth + "," +
    startDay + "," +
    endYear + "," +
    endMonth + ","
    endDay + ");"); 
```

你做错了什么是在双引号中传递变量，如 startYear 等，它被视为字符串而不是它的值。所以你最终生成和执行的查询字符串结果是

插入学期值（sessionName，startYear，startMonth，startDay，endYear，endMonth，endDay）；

因此它失败了，因为这不是有效的查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T18:46:49.943

试试这个，它是更好的插入方式。

```
 ContentValues cv = new ContentValues();
    cv.put("Session" , sessionName);
    cv.put("YearStart" , startYear);
    cv.put("MonthStart" , startMonth);
    cv.put("DayStart" , startDay);
    cv.put("YearEnd" , endYear);
    cv.put("MonthEnd" , endMonth);
    cv.put("DayEnd" , endDay);

    long rowID = db.insertOrThrow("Semesters", null, cv); 
```

另一个好的做法是将所有表名和列名移动到常量并使用这些常量引用它们。

# java - 队列大小为 1 的 Spring 调度

> ID：13144906
> 
> 赞同：0
> 
> 时间：2012-10-30T17:54:27.753
> 
> 标签：java, spring

我正在使用 spring 3 调度和线程池框架。我想在不同的时间/间隔安排不同的任务。我希望每个任务在另一个任务开始之前运行完成。

IE 如果我有 task1 和 task2：task1 每 10 分钟运行一次，运行时间为 1 分钟 task2 每天运行一次，运行时间为 5 分钟。

如果 task1 和 task2 计时器同时触发，我希望将 task1 和 task2 放在一个队列中，并且一次只取消一个任务。

我知道我可以使用 Spring ThreadPoolTask​​Executor 进行设置，即

```
<task:executor id="executorWithPoolSizeRange"
               pool-size="5-10"
               queue-capacity="1"/> 
```

但是我不确定如何将该执行程序挂接到调度程序中。使用 Spring ThreadPoolTask​​Scheduler 时，您只能设置 poolSize 而不是 queueSize

```
<task:scheduler id="scheduler" pool-size="10"/> 
```

有谁知道我如何能够一起使用 Spring 执行器和调度程序服务来实现我的目标？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T19:50:31.310

你可以通过两种方式做到这一点：

一种是明确指定您的调度程序和 taskExecutor 作为`task:annotation-driven`标签的一部分：

```
<task:annotation-driven executor="executor" scheduler="scheduler"/> 
```

或者作为计划任务的一部分，您可以注入 executor 并明确提交给 executor：

```
executor.execute(myrunnable/callable) 
```

# php - PHP将命令行上打印的内容获取到变量

> ID：13144911
> 
> 赞同：3
> 
> 时间：2012-10-30T17:54:48.437
> 
> 标签：php, window

我有以下 PHP 代码：

```
<?php
$video = "C:\Users\Administrator\myVideo\processing\video.mp4";
$cmd = 'ffmpeg -i "' . $video .'" 2>&1 | wtee buffer.txt'; // wtee is a Windows version of tee

exec($cmd);
echo($cmd);
?> 
```

如果我运行`aa.php`包含上述代码的 ，它将不起作用。

但是，如果我`$cmd`直接在命令提示符下运行正在回显的文件，则该文件`buffer.txt`已创建并可以正常工作。

我想得到这个的输出：

```
$cmd = 'ffmpeg -i "' . $video .'"' 
```

进入一个变量，例如`$output`。

到目前为止，此代码打印空白：

```
exec($cmd,$output,$result);
print_r($output); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T18:15:56.253

就像您提到的那样，您的代码直接从命令行而不是[PHP CLI](http://en.wikibooks.org/wiki/PHP_Programming/CLI)工作，很可能是因为日志文件权限，这意味着您必须首先创建一个具有正确权限的日志文件，然后在那里写入您的输出！

例如，从命令行*（不是 PHP）*确保删除日志文件`buffer.txt`并再次运行 PHP 代码。由于您的文件不存在，它很可能无法正常工作。请记住，当您直接从命令行运行该命令时，您的日志文件`buffer.txt`是使用特殊权限创建的*（不仅是读/写，还有组和所有者（Linux））*。当 PHP 创建文件时，默认情况下，它`nobody nobody`用于所有者/组，并且您已经有一个日志文件（当您从命令行运行相同的命令时），该文件是由其他用户（我想是*管理员*）创建的，因此您可以肯定的是，PHP将无法使用它，只是因为文件权限错误。尝试查看当前日志文件*所有者/组上的内容*通过`ls -ls`在 Linux 或`DIR /Q`Windows 中执行来获得这个想法。

除此之外，请确保您没有在安全模式下运行 PHP，结果`exec`可能无法按预期运行，因为如果[PHP 处于安全模式](http://us2.php.net/manual/en/features.safe-mode.functions.php)，它会被禁用。

1.  `shell_exec()`（相当于反引号的功能）当 PHP 在安全模式下运行时，此功能被禁用。

2.  `exec()` 您只能在*safe_mode_exec_dir*中执行可执行文件。出于实际原因，目前不允许在可执行文件的路径中包含组件。`escapeshellcmd()`在此函数的参数上执行。

您可以使用该[`phpinfo()`](http://us2.php.net/manual/en/function.phpinfo.php)功能检查服务器的 PHP 设置。

**您的代码应该如下所示：**

```
exec("$cmd 2>&1", $output);
log_conversion($config['logs_path']. '/' .$video_id. '_log.txt', $cmd);
log_conversion($config['logs_path']. '/' .$video_id. '_log.txt', implode("\n", $output)); 
```

这意味着什么？如果您说`2>&1`，那么您将重定向到当前重定向`stderr`到的任何位置。`stdout`如果`stdout`要去控制台`stderr`，那么也是。如果`stdout`要去一个文件，那么`stderr`也是如此。

请阅读有关命令重定向的更多信息，请参阅文章[Using command redirection operator](http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/redirection.mspx?mfr=true) for Windows 或[All about redirection](http://tldp.org/HOWTO/Bash-Prog-Intro-HOWTO-3.html) for Linux。

**你的日志转换函数，可能是这样的：**

```
function log_conversion($file_path, $text)
{
    $file_dir = dirname($file_path);
    if( !file_exists($file_dir) || !is_dir($file_dir) || !is_writable($file_dir) )
        return false;

    $write_mode = 'w';
    if( file_exists($file_path) && is_file($file_path) && is_writable($file_path) )
        $write_mode = 'a';

    $handle = fopen($file_path, $write_mode);
    if( !$handle )
        return false;

    if( fwrite($handle, $text. "\n") == FALSE )
        return false;

    @fclose($handle);
} 
```

确保您创建的日志文件*是可写的*并且具有*正确的权限*非常重要！

如果日志文件存在，我会亲自删除它，以确保我拥有最新且合理的日志文件。

我敢打赌它会像这样工作或稍作调整！

如果它不适合你，请告诉我，我会详细说明！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T18:14:28.817

`exec`输出变量需要一个数组。所以试试：

```
$output = array();
exec($cmd, $output, $result); 
```

这将为您提供一个数组，其中每个元素都是您的命令返回的一行。

# css - 使用纯 CSS 选择具有特定子元素的兄弟元素

> ID：13144917
> 
> 赞同：0
> 
> 时间：2012-10-30T17:55:11.283
> 
> 标签：css, css-selectors

> **可能重复：**
> [是否有 CSS 父选择器？](https://stackoverflow.com/questions/1014861/is-there-a-css-parent-selector)

假设你有：

```
----------
    X
----------
    Y -> Z
---------- 
```

鉴于 Z 是 Y 的孩子，我想选择所有 X 有一个兄弟姐妹有一个孩子 Z

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T18:00:05.557

您**不能**根据子元素和兄弟元素在 CSS 中选择父元素...所以您无法完成此操作...

所以还没有 CSS 父选择器..

[CSS 2 选择器的规范参考](http://www.w3.org/TR/CSS2/selector.html#pattern-matching)

[CSS 3 选择器的规范参考](http://www.w3.org/TR/css3-selectors/#selectors)

在 CSS4 规范中，我记得有类似`$`的东西，但后来被拒绝了

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T18:02:40.223

目前[无法](http://www.w3.org/TR/css3-selectors/#selectors)在 CSS 中选择元素的父元素，这就是为什么无法选择具有子 Z 的兄弟元素的原因。

# binding - 在支持 bean 中添加列和行后，动态 DataTable 组件不呈现

> ID：13144918
> 
> 赞同：0
> 
> 时间：2012-10-30T17:55:15.340
> 
> 标签：binding, jsf-2, primefaces

我正在尝试为 CSV 文件创建一个文件上传屏幕，该屏幕将为用户提供上传内容的预览。

我有前端的jsf标签如下：

```
<p:fileUpload id="selectFile" value="#fileUploadBean.file}" mode="simple"/>
<p:commandButton ajax="false" action="#{fileUploadBean.uploadDataFile}" />
<h:panelGrid id="filePreview" binding="#{fileUploadBean.filePreview}"/> 
```

在后端，我有方法在文件上传时建立预览：

```
public String uploadDataFile() {
  createFilePreview();
  return "";
}

private void createFilePreview() {
  HtmlPanelGrid dataPrevGrid = new HtmlPanelGrid();
  dataPrevGrid.setColumns(numColumns);
    for (/*loops through all lines in the CSV file*/) {
      String row = it.next(); //get next line in CSV file
      String[] cells = row.split(",");
      for (int i = 0; i < cells.length; i++) {
        String cell = cells[i];
        HtmlOutputText jcell = createHtmlOutputText(cell);
        dataPrevGrid.getChildren().add(jcell);
      }
    }
}

public HtmlPanelGrid getFilePreview() {
    return filePreview;
} 
```

代码全部运行（我在调试时看到它正在运行代码），但是 PanelGrid 组件永远不会随文件预览更新。有趣的是（因为我已将 bean 声明为会话范围），如果导航出然后返回页面，则面板网格包含新数据。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T17:09:14.453

这是我解决此问题的方法。

如果有更好的方法可以做到这一点，请发布更好的解决方案或在评论中告诉我。理想情况下，我想摆脱支持 bean 中的行，在该行中我通过 ID 获取组件以便对其进行操作。我会认为绑定是为了这个目的？

任何帮助，将不胜感激。

* * *

**支持豆**

```
@ManagedBean(name = "dataTableTesterBean")
@RequestScoped
public class DataTableTesterBean {
    private DataTable dataTable;
    private ListDataModel<String[]> dataModel;

    public String initDataTable() {
        buildDataModel();
        buildDataTable();
        return "";
    }

    public ListDataModel<String[]> getDataModel() {
        return dataModel;
    }

    public void setDataModel(ListDataModel<String[]> dataModel) {
        this.dataModel = dataModel;
    }

    public DataTable getDataTable() {
        return dataTable;
    }

    public void setDataTable(DataTable dataTable) {
        //do nada
    }

    private Column buildColumn(String colTitle, String colValueExpr) {
        //add columns so the datatable knows what to display
        Column col = (Column) JsfUtil.createComponent(Column.COMPONENT_TYPE);
        UIOutput title = (UIOutput) JsfUtil.createComponent(UIOutput.COMPONENT_TYPE);
        title.setValue(colTitle);
        col.getFacets().put("header", title);
        //setup the field that will display the column data
        ValueExpression val = JsfUtil.createValueExpression(colValueExpr, Object.class);
        HtmlOutputText display = (HtmlOutputText) JsfUtil.createComponent(HtmlOutputText.COMPONENT_TYPE);
        display.setValueExpression("value", val);
        col.getChildren().add(display);
        return col;
    }

    private void buildDataModel() {
        //build up the data
        List<String[]> data = new ArrayList<>();
        data.add(new String[]{"A", "123", "apples"});
        data.add(new String[]{"B", "456", "oranges"});
        data.add(new String[]{"C", "789", "bananas"});
        data.add(new String[]{"D", "987", "lemons"});
        data.add(new String[]{"E", "654", "mangoes"});
        dataModel = new ListDataModel(data);
    }

    private void buildDataTable() {
        //The following line should work, don't know why it doesn't
        //dataTable = (DataTable) JsfUtil.createComponent(DataTable.COMPONENT_TYPE);
        dataTable = (DataTable) JsfUtil.getUIComponent("frmTester:myDataTable");

        dataTable.setVar("item");

        Column abcCol = buildColumn("ABCs", "#{item[0]}");
        dataTable.getColumns().add(abcCol);

        Column numCol = buildColumn("Nums", "#{item[1]}");
        dataTable.getColumns().add(numCol);

        Column fruitCol = buildColumn("Fruits", "#{item[2]}");
        dataTable.getColumns().add(fruitCol);
    }
} 
```

* * *

**JSF 页面**

```
<h:form id="frmTester">
<h:commandButton value="Do Stuff" action="#{dataTableTesterBean.initDataTable}"/>
<p:dataTable id="myDataTable" value="#{dataTableTesterBean.dataModel}" binding="#{dataTableTesterBean.dataTable}" />
</h:form> 
```

* * *

# active-directory - Active Directory 用户数据存储

> ID：13144919
> 
> 赞同：0
> 
> 时间：2012-10-30T17:55:25.317
> 
> 标签：active-directory, asp.net-mvc-4, windows-authentication

使用 MVC4 为通过 Active Directory 进行身份验证的用户存储用户数据的最佳方法是什么？我应该使用 SID 作为用户 ID 吗？例如：

```
CREATE TABLE MyStuff AS
{
   ID INT IDENTITY (1,1) NOT NULL UNIQUE,
   AccountDomainSid VARCHAR(50),
   Stuff VARCHAR(100)
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T18:02:39.173

`SID`用户的可以*更改*（例如，如果您合并两个域）。这就是为什么[`SIDHistory`你的 AD 对象](http://msdn.microsoft.com/en-us/library/windows/desktop/ms679833%28v=vs.85%29.aspx)也有一个属性:-)

[请参阅有关SID 与 GUID](http://technet.microsoft.com/en-us/library/cc961625.aspx)的 TechNet 简介。

**始终**保持不变的一件事是`objectGUID`来自 Active Directory - 终身固定。

# java - SortedSet - 排序和相等测试未按预期工作

> ID：13144922
> 
> 赞同：2
> 
> 时间：2012-10-30T17:55:46.433
> 
> 标签：java

我有一个类的实例，我想按特定顺序对其进行排序，但也能够使用*不同*的标准判断一个实例是否存在于集合中。例子：

```
public class Foo {
    int x;
    int y;

    public Foo(int x, int y) { this.x = x; this.y = y }

    // equality determined by value of 'x':
    @Override 
    public boolean equals(Object obj) {
        if (obj instanceof Foo) {
            return ((Foo)obj).x == this.x;
        }
        return false;
    }

    @Override
    public int hashCode() {
        return this.x;
    }

    @Override
    public int compareTo(Foo foo) {
        if (this.x < foo.x return -1;
        else if (this.x > foo.x return 1;
        return 0;
    }
}

...

// Would like to keep a set of Foos, but sorted by 'y' value.
// Passing in an explicit comparator which sorts on 'y'.
SortedSet<Foo> test = new TreeSet<Foo>(new ComparatorFoo());

public static class ComparatorFoo implements Comparator<Foo> {
    @Override
    public int compare(Foo o1, Foo o2) {
        if (o1.y < o2.y) return -1;
        else if (o1.y > o2.y) return 1;
        return 0;
    }
} 
```

现在尝试：

```
test.add(new Foo(3, 4));
test.add(new Foo(1, 2));
test.add(new Foo(5, 6));

// sorts by 'y' ok.
for (Foo foo : test) {
    System.out.println(foo.toString());
}

// but can't find an instance with the same 'x' value:
test.contains(new Foo(1, 999)); 
```

我是否需要保留两个单独的数据结构才能做到这一点？（一个用于排序，一个用于相等测试？）

谢谢

- - - 更新 - - - - -

最终结果：用于初始化 SortedSet 的比较器也会在调用 contains() 时使用。因此，我不能让集合按“y”排序，并通过“x”检查元素是否存在。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-30T17:57:31.917

你应该定义你的`compareTo`一致`equals`

从[`SortedSet`](http://docs.oracle.com/javase/6/docs/api/java/util/SortedSet.html)检查突出显示部分的java doc。

> 请注意，如果有序集合要正确实现 Set 接口，则由有序集合维护的排序（无论是否提供显式比较器）**必须与 equals 一致。**（请参阅 Comparable 接口或 Comparator 接口以了解与等于一致的精确定义。）这是因为 Set 接口是根据等于操作定义的，但排序集**使用其 compareTo（或比较）方法执行所有元素比较**，因此从排序集的角度来看，**此方法认为相等的两个元素是相等的。**一个有序集合的行为是明确定义的，即使它的排序与equals不一致；它只是不遵守 Set 接口的一般约定。

更改您的比较器，如下所示

```
public static class ComparatorFoo implements Comparator<Foo> {
    @Override
    public int compare(Foo o1, Foo o2) {
        if (o1.x < o2.x)
            return -1;
        else if (o1.x > o2.x)
            return 1;
        return 0;
    }
} 
```

它会回报你`true`

# c# - 无法获取我的自定义配置部分

> ID：13144926
> 
> 赞同：11
> 
> 时间：2012-10-30T17:56:00.100
> 
> 标签：c#, .net, app-config, configurationmanager

我正在尝试创建一个自定义配置部分来加载我的应用程序监视器的“烤箱”列表。这是我对配置部分的第一次体验，我尝试按照示例进行操作；但是，我无法弄清楚我错过了什么。

当我尝试获取配置部分时，出现以下异常：

> 为 BurnIn 创建配置节处理程序时出错：无法从程序集“System.Configuration，Version=4.0.0.0，Culture=neutral，PublicKeyToken=b03f5f7f11d50a3a”加载类型“BurnIn.UI.BurnInConfigurationSection”。（C:\MKS\BurnIn\PC_SW\bin\BurnIn.UI.vshost.exe.config 第 8 行）

我主要尝试过： System.Configuration.Configuration config = ConfigurationManager.OpenExeConfiguration(ConfigurationUserLevel.None); if (config.Sections[BurnInSection] == null) ...

```
BurnInConfigurationSection burnInConfigSection = config.GetSection(BurnInSection) as BurnInConfigurationSection; 

BurnInConfigurationSection burnInConfigSection = ConfigurationManager.GetSection(BurnInSection) as BurnInConfigurationSection; 
```

一切似乎都导致相同的异常

当我查看 config.FilePath 时，它是“C:\MKS\BurnIn\PC_SW\bin\BurnIn.UI.vshost.exe.config”，我已经验证它与 app.config 文件匹配。

这是我的配置类：

```
namespace BurnIn.UI
{
/// <summary>
/// BurnIn Application configuration section in app.config
/// </summary>
public class BurnInConfigurationSection : ConfigurationSection
{
    [ConfigurationProperty("Ovens", IsDefaultCollection = false)]
    [ConfigurationCollection(typeof(OvenCollection),
        AddItemName = "add",
        ClearItemsName = "clear",
        RemoveItemName = "remove")]
    public OvenCollection Ovens
    {
        get { return (OvenCollection)base["Ovens"]; }
        set { base["Ovens"] = value; }
    }
}

/// <summary>
/// Oven configuration information
/// </summary>
public class OvenConfig : ConfigurationElement
{
    public OvenConfig() { }

    public OvenConfig(string nickName, string mesName, string ip, int slotCount)
    {
        NickName = nickName;
        MesName = mesName;
        IP = ip;
        SlotCount = slotCount;
    }

    [ConfigurationProperty("NickName", DefaultValue = "OvenName", IsRequired = true, IsKey = true)]
    public string NickName
    {
        get { return (string)this["NickName"]; }
        set { this["NickName"] = value; }
    }

    [ConfigurationProperty("MesName", DefaultValue = "MesName", IsRequired = true, IsKey = true)]
    public string MesName
    {
        get { return (string)this["MesName"]; }
        set { this["MesName"] = value; }
    }

    [ConfigurationProperty("IP", DefaultValue = "10.130.110.20", IsRequired = true, IsKey = false)]
    public string IP
    {
        get { return (string)this["IP"]; }
        set { this["IP"] = value; }
    }

    [ConfigurationProperty("SlotCount", DefaultValue = "20", IsRequired = true, IsKey = false)]
    public int SlotCount
    {
        get { return (int)this["SlotCount"]; }
        set { this["SlotCount"] = value; }
    }

}
/// <summary>
/// Collection of Oven Configs
/// </summary>
public class OvenCollection : ConfigurationElementCollection
{
    public OvenCollection()
    {
    }

    public OvenConfig this[int index]
    {
        get { return (OvenConfig)BaseGet(index); }
        set
        {
            if (BaseGet(index) != null)
            {
                BaseRemoveAt(index);
            }
            BaseAdd(index, value);
        }
    }

    public void Add(OvenConfig ovenConfig)
    {
        BaseAdd(ovenConfig);
    }

    public void Clear()
    {
        BaseClear();
    }

    protected override ConfigurationElement CreateNewElement()
    {
        return new OvenConfig();
    }

    protected override object GetElementKey(ConfigurationElement element)
    {
        return ((OvenConfig)element).NickName;
    }

    public void Remove(OvenConfig ovenConfig)
    {
        BaseRemove(ovenConfig.NickName);
    }

    public void RemoveAt(int index)
    {
        BaseRemoveAt(index);
    }

    public void Remove(string name)
    {
        BaseRemove(name);
    }
}
} 
```

这是我的 app.config：

```
<?xml version="1.0"?>
<configuration>
  <configSections>
    <sectionGroup name="applicationSettings" type="System.Configuration.ApplicationSettingsGroup, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" >
      <section name="Biotronik.NGMP.DAL.Sources.DalBaseSettings" type="System.Configuration.ClientSettingsSection, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" requirePermission="false" />
    </sectionGroup>
    <section name="log4net" type="log4net.Config.Log4NetConfigurationSectionHandler, log4net"/>
    <section name="BurnIn" type="BurnIn.UI.BurnInConfigurationSection"/>
  </configSections>
  <applicationSettings>
    <Biotronik.NGMP.DAL.Sources.DalBaseSettings>
      <setting name="ConfigFileName" serializeAs="String">
        <value>DalConfig.xml</value>
      </setting>
      <setting name="MappingFileName" serializeAs="String">
        <value>BurnInTestPlanMap.tpx</value>
      </setting>
    </Biotronik.NGMP.DAL.Sources.DalBaseSettings>
  </applicationSettings>
  <connectionStrings>
    <add name="BurnInConnection" connectionString="metadata=res://*/BurnIn.csdl|res://*/BurnIn.ssdl|res://*/BurnIn.msl;provider=Oracle.DataAccess.Client;provider connection string=&quot;DATA SOURCE=XXXX;PASSWORD=xxxx;PERSIST SECURITY INFO=True;USER ID=XXXX&quot;" providerName="System.Data.EntityClient" />
  </connectionStrings>
  <log4net configSource="BurnInLog4net.config"/>
  <BurnIn>
    <Ovens>
      <add NickName="Mark's Oven" MesName="MESBOven" IP="10.130.110.20" SlotCount="5"/>
      <add NickName="Real Oven" MesName="MESOven1" IP="10.130.110.50" SlotCount="20"/>
    </Ovens>
    </BurnIn>
  <startup><supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.0"/></startup>
</configuration> 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-10-30T17:58:49.230

您在此处输入了错误的配置节类型名称：

```
<section name="Biotronik.NGMP.DAL.Sources.DalBaseSettings"  
    type="System.Configuration.ClientSettingsSection, System, Version=4.0.0.0,  
    Culture=neutral, PublicKeyToken=b77a5c561934e089" requirePermission="false" /> 
```

您应该在此处使用自定义配置部分类型的名称：

```
type="BurnIn.UI.BurnInConfigurationSection, AssemblyWhereThisTypeIsDeclared" 
```

# javascript - Jquery for loop 在每第三次循环迭代后写入 html

> ID：13144927
> 
> 赞同：13
> 
> 时间：2012-10-30T17:56:04.230
> 
> 标签：javascript, jquery, html, loops

我试图`<div class="clear"></div>`在 jquery 中的 for 循环的每第三次迭代之后出现一个。我知道在 PHP 中它可以通过`if($i%3 == 0)`但如何在 jquery/javascript 中完成？

这是我的for循环：

```
var data = $.parseJSON(result);
for(i=0;i<data.length;i++){
    if(i/3 == 1){
        $('#add_product_preview_area').append('<div class="clear"></div>');
    }
    $('#add_product_preview_area').append(data[i]);
} 
```

现在这只工作一次，因为循环只会到达数字 3 一次。那么关于如何使相同的 php 概念在 jquery 中工作的任何想法？我已经看到了关于将每个 nth 包装在 div 中的其他问题，但我只需要在每个 div 之后编写一个 div 的 html。

提前致谢。

编辑：

```
if ( i && (i % 3 === 0)) { 
```

是答案..我不知道你能做到这一点。谢谢！

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-10-30T17:57:43.753

请改用模数运算符。

```
if ( i && (i % 3 === 0)) { ... 
```

只要没有余数，你就可以被 整除`3`。

我包括了`i &&`以消除自`0 % 3 === 0; // true`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-30T17:57:47.540

使用这个...就像你的 PHP

```
if (i % 3 == 0 ) 
```

# asp.net-mvc - Azure Cloud 上的表单身份验证/配置文件速度慢，本地正常

> ID：13144933
> 
> 赞同：4
> 
> 时间：2012-10-30T17:56:28.443
> 
> 标签：asp.net-mvc, azure, asp.net-mvc-4, asp.net-membership, azure-sql-database

我在 Azure 上使用 MVC 4，它的加载速度非常慢（超过一分钟）。以下是几个页面的加载时间： ![http://i.imgur.com/V4brS.png](../Images/4b5aaf2d75414639a75490acf97c0ca6.png) （6.9 分钟是我尝试加载不同页面的 7 个标签时）

当我在本地使用 Azure 模拟器时，不会出现此问题。

我尝试过使用一个超大的实例，并使用远程桌面在本地运行该站点，但速度同样慢。我也尝试过使用 IIS Express 和普通 IIS，但也没有。

我使用“Internet 应用程序”模板创建了一个全新的 MVC 项目，其中包括安全性，而且它也很慢，所以我很确定我在项目中使用的其他东西不会导致问题。以下是仅使用默认 MVC 项目的加载时间： ![在此处输入图像描述](../Images/8f6d62e6bcfcf0cfa1c619fd163c2a5a.png)

我最初为我的会员数据库和我的网站使用单独的关联区域，但我尝试在带有表单身份验证的空白 MVC 模板和我的项目上使用匹配的关联组。

重新访问页面并没有显着提高它们的速度。

我还尝试创建一个没有身份验证的 MVC 站点，生成一个 10x5000 表：

```
<html>
<body>
    <table>
        <thead>
            <tr>
                @for (int i = 0; i < 10; i++)
                {
                    <th>@i
                    </th>
                }
            </tr>
        </thead>
        <tbody>
            @for(int i = 0; i < 5000; i++)
            {
                <tr>
                    @for(int j = 0; j < 10; j++)
                    {
                        <td>Row @i , column @j</td>    
                    }
                </tr>
            }
        </tbody>
    </table>
</body>
</html> 
```

这在本地和云端都可以正常加载。即使是冷启动，也只有 ~10-15 秒。

所以我相当确定问题出在 ASP.NET 的配置文件/成员身份/身份验证中，但仅在它部署到 Azure 时（因为我在本地运行时使用与 Universal Providers 相同的 SQL Azure 数据库，并且有不是这些减速）。

我预计这个问题会更常见，但唯一真正相关的是： [social.msdn.microsoft.com/Forums/en-US/windowsazuremanagement/thread/7d3323d8-571b-4b8f-9fdb-bd5ccc6c39b7](http://social.msdn.microsoft.com/Forums/en-US/windowsazuremanagement/thread/7d3323d8-571b-4b8f-9fdb-bd5ccc6c39b7) （可能是这个：[stackoverflow.com/questions/10791433/saving-changes-very-slow-via-datacontext](https://stackoverflow.com/questions/10791433/saving-changes-very-slow-via-datacontext)）

按照该线程中的建议，我正在尝试尝试：[windowsazure.com/en-us/manage/windows/best-practices/](http://windowsazure.com/en-us/manage/windows/best-practices/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T20:02:01.193

您是否检查过数据库服务器的防火墙规则中是否选中了“允许其他 Windows Azure 服务访问此服务器”？

我想知道提供者是否无法访问数据库并在最终超时之前重试（不过，老实说，我希望会抛出异常）。

如果您为网络添加了防火墙规则，但没有为 Azure 本身添加防火墙规则，您可能会遇到此类问题。

# c# - DTO 属性

> ID：13144934
> 
> 赞同：1
> 
> 时间：2012-10-30T17:56:28.753
> 
> 标签：c#, servicestack

我正在使用我无法控制的[ServiceStack连接到服务：](http://servicestack.net)

我有一个像这样的 DTO：

```
public class Request
{
    public string Property1 { get; set; }
} 
```

但是该服务需要一个请求，例如`{"Property 1":"value"}`注意单词 Property 和 1 之间的空格。 **是否有一个属性可以用来将名称设置为传输到服务器的属性？** 类似以下内容会有所帮助：

```
public class Request
{
    [Name("Property 1")]
    public string Property1 { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T18:10:39.357

[拉取请求 #51作为](https://github.com/ServiceStack/ServiceStack.Text/pull/51)[此问题请求](https://github.com/ServiceStack/ServiceStack.Text/issues/41)的结果添加了以下内容。

```
[DataContract]
public class Request
{
    [DataMember(Name = "Property 1")]
    public string Property1 { get; set; }
} 
```

# vba - 用户表单列表框根据从另一个列表框中的选择填充和清除

> ID：13144937
> 
> 赞同：0
> 
> 时间：2012-10-30T17:56:31.830
> 
> 标签：vba, excel, userform

我有 2 个列表框，lbA 和 lbB。我正在使用运行良好的 SQL 脚本填充 lbA。现在我想做的是，当我从 lbA 中选择一个项目时，lbB 会再次从 SQL 脚本中填充。它在仅从 lbA 中选择一个项目但选择两个或更多或取消选择一个项目时起作用，然后它会添加重复的项目或不从 lbB 中删除项目。我很困惑如何解决这个问题。有人可以帮忙吗？

这是到目前为止的代码：

```
Private Sub lbA_Change() 
    Dim Num As Integer 
    Dim lngIndex As Long 

    If Me.lbA.ListIndex <> -1 Then 
        For lngIndex = 0 To lbA.ListCount - 1 
            If lbA.Selected(lngIndex) Then 

                Dim cnPubs As ADODB.Connection 
                Set cnPubs = New ADODB.Connection 
                Dim strConn As String 
                strConn = "PROVIDER=SQLOLEDB;" 
                strConn = strConn & "DATA SOURCE=MSSQLSERVER2008;INITIAL CATALOG=MyDB;" 
                strConn = strConn & " INTEGRATED SECURITY=sspi;" 
                cnPubs.Open strConn 
                Dim rsPubs As ADODB.Recordset 
                Set rsPubs = New ADODB.Recordset 
                With rsPubs 
                    .ActiveConnection = cnPubs 
                    .Open "My SQl Statement" 
                End With 
                If rsPubs.EOF Or rsPubs.BOF Then 
                    Exit Sub 
                End If 
                rsPubs.MoveFirst 
                With Me.lbB 
                    .Clear 
                    Do 
                        .AddItem rsPubs![strName] 
                        rsPubs.MoveNext 
                    Loop Until rsPubs.EOF 
                End With 
                rsPubs.Close 

            End If 
        Next 
    End If 
End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T21:53:17.927

尝试这样的函数来获取 SQL 语句。

```
Function GetSQLFromListbox(lbx As MSForms.ListBox)

    Dim i As Long
    Dim sIn As String

    If lbx.ListIndex <> -1 Then
        sIn = " WHERE field IN("
        For i = 0 To lbx.ListCount - 1
            If lbx.Selected(i) Then
                sIn = sIn & "'" & lbx.List(i) & "',"
            End If
        Next i
        sIn = Left$(sIn, Len(sIn) - 1) & ")"
    End If

    GetSQLFromListbox = "SELECT * FROM table" & sIn

End Function 
```

它应该返回类似

```
SELECT * FROM table WHERE field IN('2''3') 
```

然后从该语句创建一个记录集并循环遍历它以填充第二个列表框。请注意，如果未选择任何内容，它将返回没有 WHERE 子句的 SQL，因此您将获得所有内容。您可能需要调整它以适应您的情况。

# compression - Sencha touch 2 SDK压缩JS文件

> ID：13144940
> 
> 赞同：2
> 
> 时间：2012-10-30T17:56:42.157
> 
> 标签：compression, sencha-touch

有一种方法可以在 app.json 中指定，我在其中包含 js 文件，而不是缩小 1 个 js 文件，例如

```
"js": [
    {
        "path": "sdk/sencha-touch.js"
    },
    {
        "path": "sdk/myjs.js",
        "compress": false
    },
...

"compress": false --  ofc doesn work , there is something to specify not to compress or minify that js file ? 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T21:57:25.507

据我发现没有为什么要指定不压缩，我如何解决的方法是：

1.  在“资源”文件夹中创建一个“js”文件夹并将我的 js 文件放在该文件夹中
2.  像这样更新`app.json`文件（在我们构建生产应用程序时不要松开“js”文件夹）：

    ```
    "resources": [
        "resources/js",
    ] 
    ```

3.  将 index html 中的文件作为常规脚本包含在内

# javascript - htaccess 和深度链接返回按钮

> ID：13144943
> 
> 赞同：0
> 
> 时间：2012-10-30T17:56:55.320
> 
> 标签：javascript, .htaccess, deep-linking

我正在实现以下 htaccess 以深度链接到一个 ajax 重站点，

它工作正常，除非您从外部链接到该站点，您需要快速按两次后退按钮才能返回。

有没有人成功地解决过这个问题，如果是这样怎么办？

```
<IfModule mod_rewrite.c>
Options +FollowSymlinks
RewriteEngine On
# Rewrite rules to support deeplinking
RewriteRule ^([A-Za-z]+)/?$ /studio/$1/ [NC,R]
RewriteRule ^studio/families/([^/]*)/?$ /studio/inc-discover-static/$1 [NC,NE,R]
RewriteRule ^studio/([^/]*)/?$ /index.php#!section=$1 [NC,NE,R]
RewriteRule ^studio/([^/]*)/([^/]*)/?$ /index.php#!section=$1&sub=$2 [NC,NE,R,L]      
</IfModule> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T18:01:51.147

您在 RewriteRules 上使用了`[R]`标志（代表重定向），这意味着重定向对浏览器可见。如果您删除它，所有这些都将仅在服务器上发生，用户不会注意到任何内容，因此您不必按回两次。

# linux - linux、freepascal、fp-ide：没有可用的调试器支持。如何启用调试器？

> ID：13144947
> 
> 赞同：1
> 
> 时间：2012-10-30T17:57:14.870
> 
> 标签：linux, freepascal

如何在 fp-ide 中启用调试器？我在某处读到我应该从源代码编译 fp-ide，但我不知道该怎么做。有人能帮我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-01T09:14:37.280

[从http://www.freepascal.org/down/x86_64/linux-hungary.var](http://www.freepascal.org/down/x86_64/linux-hungary.var)获取用于 FPC 的通用 linux tar 安装程序 (fpc-2.6.0.x86_64-linux.tar)它带有一个带有集成调试器的预编译 IDE支持，并且至少在 12.04 LTS 上运行良好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T19:10:40.970

我无法为 找到 PPA `fp-ide`，但我可以描述如何在 Arch Linux 上编译 CLI IDE，如[存储库](https://projects.archlinux.org/svntogit/community.git/tree/trunk/PKGBUILD?h=packages/fpc)中所述。请注意，编译不会启用 CLI 中的调试器，因为根据[Debian 中的这个错误报告，](http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=528855)`gdb`它似乎是和`fp`(fp-ide)之间的不兼容。在 Arch Linux 上，该软件包在设计上也不支持调试器（使用标志明确禁用它）。`fpc``fp``NOGDB`

无论如何，编译过程如下：

1.  确保你已经安装了 FreePascal，因为你需要它来编译 IDE
2.  下载[源压缩包](ftp://ftp.freepascal.org/pub/fpc/dist/2.6.0/source/fpcbuild-2.6.0.tar.gz)
3.  将压缩包解压到您方便的位置并`cd`进入该目录

在您的 shell 中执行以下代码：

```
pushd fpcsrc/compiler
fpcmake -Tall
popd
make build          
make -j1 install    
# in Arch, the switch "NOGDB=1" is present in both make lines 
```

这应该编译 IDE 并安装它（您甚至可以尝试`dpkg`通过使用[`checkinstall`](https://help.ubuntu.com/community/CheckInstall)而不是集成它`make install`，但请查看[Arch PKGBUILD](https://projects.archlinux.org/svntogit/community.git/tree/trunk/PKGBUILD?h=packages/fpc)以查看可能需要的示例）。

但是为什么你使用命令行 IDE`fp`而不是`lazarus`呢？您还可以制作控制台应用[`lazarus`](http://www.lazarus.freepascal.org/)程序，它提供了更多功能（例如，工作调试支持）。

# java - Java中将文本数据作为图像对象处理的最有效方法？

> ID：13144951
> 
> 赞同：1
> 
> 时间：2012-10-30T17:57:32.930
> 
> 标签：java, image

我正在考虑解析源文本以获取像素数据，然后将它们放入整数数组中。我将如何优雅地解析这些数据并提取像素信息而不使其过于昂贵？另外，这是处理具有这种格式的图像文件并将其作为图像对象返回的最有效方法吗？

这是纯文本的结构：

```
name
n m
px0,0 px0,1 … px0,m
px1,0 px1,1 … px1,m
pxn,0 pxn,1 … pxn,m 
```

例子：

```
TestName
5 5
55, 6, 65, 79, 99
10, 25, 0, 45, 66
88, 19, 188, 76, 50 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T19:14:33.413

1.  无论如何，解析将花费 O(nm)，因为您需要解析所有“像素”。关于优雅 - 你可能会看看 Google Guava 类：

    *   [字符流](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/io/CharStreams.html)
    *   [线处理器](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/io/LineProcessor.html)
    *   [分路器](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/base/Splitter.html)
2.  返回“图像”可能是压缩数据的好主意，但前提是它是无损格式（例如 PNG）。

# filemaker - 更改程序设置的脚本（filemaker pro 11）

> ID：13144964
> 
> 赞同：1
> 
> 时间：2012-10-30T17:58:09.047
> 
> 标签：filemaker

在这里寻求帮助。我为大约 200 人的组织提供一些 IT 支持。他们中的大多数使用名为 Filemaker Pro 11 的数据库程序。每个用户都应该有自己的用户名，该用户名在“编辑”菜单 ->“首选项”下设置。编辑菜单位于屏幕顶部的工具栏上，还有文件、视图、窗口等，就像在 MS Word 中一样。

每个用户当前都有一个默认用户名，但组织希望每个人都更改为唯一的用户名。这意味着我访问每台机器并手动更改它。我想知道是否可以编写一个脚本来提示用户在下次打开系统时进行此更改？我对编程并不陌生，但我以前从未编写过这样的脚本，所以不知道从哪里开始。谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T02:10:38.143

没有办法编写该更改的脚本。

您所指的用户名是系统（Windows 或 Mac）用户名，而不是 FileMaker 用户帐户。系统用户名的默认值是他们登录到其计算机的任何名称。因此，您可以在系统级别为人们提供唯一的用户名。

非默认选项允许用户更改其系统名称。您可以创建一个脚本来为它们打开首选项，但无法通过 FileMaker 脚本实际更改它。

您可以执行的操作：使用 FileMaker 帐户名称而不是系统名称。帐户名称更可靠，可以跨计算机跟踪用户，更安全，*最重要的*是（几乎）完全可编写脚本。

我希望这有帮助。抱歉，在 FileMaker 中无法实现您想要的。

# jquery - 重新启动 jQuery 动画循环的绝对位置

> ID：13144969
> 
> 赞同：0
> 
> 时间：2012-10-30T17:58:58.387
> 
> 标签：jquery, loops, jquery-animate

# 是）我有的：

在屏幕上移动和离开屏幕的平面的绝对定位图像。

# 我需要的：

我需要动画每 10 秒循环/重新启动一次，即飞机在每个循环开始时出现在其默认绝对位置。

# 问题：

我尝试了很多例子，但我能得到的最接近的例子是使用 .queue 和 .callee的[这个例子。](http://www.sk89q.com/2011/07/looping-jquery-animations-indefinately/)它循环播放，但需要反向动画来重新定位图像。相反，我需要在没有动画的情况下重新定位图像。

# 我的代码：

动画开始的CSS（并且需要为每个循环重新启动）......

```
<style>
#main_content_container{
width:800px;
margin:0 auto;
position:relative;
height:2000px;
}

#sprite_plane{
    position:absolute;
    left:-400px;
    top:400px;
    opacity:0;
    filter:alpha(opacity=0); /* For IE8 and earlier */
    }
</style> 
```

jQuery动画...

```
<script>

  $("#sprite_plane").animate({
    opacity: 1,
    "left": "+=430px",
    "top": "-=530px",
  }, 1500 );

</script> 
```

的HTML...

```
<div id="main_content_container">
    <img src="images/plane.png" alt="" width="120" height="120" id="sprite_plane" />
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T18:12:00.043

我相信这个递归函数应该做你想做的

```
function loopAnimation(doReset) {
    var $el = $("#sprite_plane");
    if (doReset) {
       $el.css({ left: "-=430px", top: "+=530px", opacity:0 });/*assume opacity is zero at start*/
    }
    $el.animate({
        opacity: 1,
        "left": "+=430px",
        "top": "-=530px",
    }, 1500, function() {

        setTimeout(function() {
            loopAnimation(true);
        }, 10000);
    });
} 
```

在页面初始化代码调用中：

```
 loopAnimation(false); 
```

After that the complete callback of each instance of animation will call the function within a `setTimeout`

# sql-server - 在两者之间获取日期的程序

> ID：13144970
> 
> 赞同：4
> 
> 时间：2012-10-30T17:59:01.177
> 
> 标签：sql-server, tsql

我有一个包含`timesheet`表的 SQL Server 数据库。该表用于存储员工的角色。在我执行插入之前，我会检查员工在选定的日子里是否有任何预先存在的角色。

这是一个返回预先存在的角色计数的存储过程

```
set @retVal=(select count(fk_RoleID) from dbo.TimesheetTable where 
(@startdate >=  CAST((
STR( YEAR( StartDate ) ) + '/' +
STR( MONTH( StartDate ) ) + '/' +
STR( DAY( StartDate ) )
)
AS DATE
))-- AND EndDate <= '2012-08-30')
and
(@enddate  <  CAST(
(
STR( YEAR( EndDate ) ) + '/' +
STR( MONTH( EndDate ) ) + '/' +
STR( DAY( EndDate ) )
)
AS DATE
))
and fk_PersonnelID=@personnelID)

return @retVal 
```

以下是一名员工的记录。

```
pk_ID  fk_PersonnelID  fk_RoleID  StartDate   EndDate     dateCreated
62     1               26         2012-10-01  2012-10-02  2012-10-25 15:55:12.940
81     1               20         2012-10-04  2012-10-06  2012-10-30 14:50:28.300 
```

如果我尝试插入开始日期`2012-10-05`和结束日期的位置`2012-10-11`，则查询无法捕获`startdate`..并且插入发生

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T18:25:02.800

您的重叠测试不正确。测试应该是“**两个开始都在相反的结束之前**”。记住它，这很容易。

```
SELECT @retVal = CASE WHEN EXISTS (
    select *
    from dbo.TimesheetTable
    where StartDate <= @EndDate
      and @StartDate <= EndDate
      and fk_PersonnelID=@personnelID) THEN 1 ELSE 0 END 
```

要测试是否存在，请切换到使用 EXISTS，它会短路并在找到结果后立即为您提供结果，而不是对所有匹配项进行计数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T18:19:47.850

您不需要解析 StartDate 和 EndDate 列来获得所需的结果。

```
SELECT @retVal = COUNT(fk_RoleID)
FROM dbo.TimesheetTable AS tt
WHERE @startDate <= tt.EndDate
   AND @endDate >= tt.StartDate
   AND fk_PersonnelId = @personnelID;

return @retVal; 
```

@retVal 对于数据库中已经有计划的输入，这里将返回一个大于 0 的数字。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T18:28:16.840

您的日期比较不等式中有一个逻辑错误，因为我认为您尝试匹配的日期间隔范围是重叠的 - 没有正确包含 - 正如您的代码似乎假设的那样。

即 10/4 - 10/6 与 10/5- 10/11 严格重叠，而您的代码暗示参数间隔必须完全位于数据行的间隔内。

# php - 如何为来自不同列的每个条目分配错误

> ID：13144971
> 
> 赞同：0
> 
> 时间：2012-10-30T17:59:01.933
> 
> 标签：php, mysql

```
<?php
 include ('database_connection.php');
include ('navigs.php');
if (isset($_POST['formsubmitted'])) {
$error = array();//Declare An Array to store any error message  
if (empty($_POST['firstname'])) {//if no name has been supplied 
    $error[] = 'Please enter your firstname ';//add to array "error"
} else {
    $firstname = $_POST['firstname'];//else assign it a variable
}

if (empty($_POST['nickname'])) {
    $error[] = 'Please enter your nickname';
} else {
     $nickname = $_POST['nickname'];
}        

if (empty($_POST['email'])) {
    $error[] = 'Please enter your e-mail ';
} else {

    if (preg_match("/^([a-zA-Z0-9])+([a-zA-Z0-9\._-])*@([a-zA-Z0-9_-])+([a-zA-Z0-9\._-]+)+$/", $_POST['email'])) {
       //regular expression for email validation
        $email = $_POST['email'];
    } else {
         $error[] = 'Your email address is invalid  ';
    }

}

 if (empty($_POST['altemail']))      {
 $error[] = 'Please enter your alternative email';
 } else {
if (preg_match("/^([a-zA-Z0-9])+([a-zA-Z0-9\._-])*@([a-zA-Z0-9_-])+([a-zA-Z0-9\._-]+)+$/", $_POST['altemail'])) { 
$altemail = $_POST['altemail'];
} else {
 $error[] = 'Not a  valid email ';
}

}   
  if (empty($_POST['password'])) {
    $error[] = 'Please enter a password ';
 } else {
    $password = $_POST['password'];
 }

  if (empty($error)) //send to Database if there's no error '

 { // If everything's OK...

    // Make sure the email address is available:
    $query_verify_email = "SELECT * FROM users  WHERE Email ='$email' OR   Altemail='$altemail' OR nickname='$nickname'";
    $result_verify_email = mysqli_query($dbc, $query_verify_email);
    if (!$result_verify_email) {//if the Query Failed ,similar to  if($result_verify_email==false)
        echo ' Database Error ';
    }

    if (mysqli_num_rows($result_verify_email) == 0) { // IF no previous user is using this email .

        // Create a unique  activation code:
        $activation = md5(uniqid(rand(), true));

        $query_insert_user = "INSERT INTO `users` ( `firstname`, `nickname`, `email`, `activation`, `altemail`, `password` ) VALUES ( '$firstname', '$nickname', '$email', '$activation', '$altemail', ENCRYPT('$password'))";

        $result_insert_user = mysqli_query($dbc, $query_insert_user);
        if (!$result_insert_user) {
            echo 'Erreur SQL ';
        }

        if (mysqli_affected_rows($dbc) == 1) { //If the Insert Query was successfull.

            // Send the email:
            $message = " Pour activer ton compte, click sur ce lien:\n\n";
            $message .= WEBSITE_URL . 'activate.php?email=' . urlencode($email) . "&key=$activation";
            mail($altemail, 'Registration Confirmation', $message, 'From: noreply@mysite.org');

            // Flush the buffered output.

            // Finish the page:
            echo '<div class="success">An email has been sent to the following addres:   '.$altemail.'   Please click on the link to activate your account </div>';

        } else { // If it did not run OK.
            echo '<div class="errormsgbox">An error has occurred please try again later .</div>';
        }

    } else { // The email address is not available.
 echo '<div class="errormsgbox" >Either the nickname is already taken, the email address is already taken, or the alternative email you supplied is already on our  system</div>';
    }

} else {//If the "error" array contains error msg , display them

  echo '<div class="errormsgbox"> <ol>';
    foreach ($error as $key => $values) {

        echo '  <li>'.$values.'</li>';

    }
    echo '</ol></div>';

}

 mysqli_close($dbc);//Close the DB Connection

} // End of the main Submit conditional.

 ?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org    /TR/xhtml1/DTD/xhtml1-transitional.dtd">
   <html xmlns="http://www.w3.org/1999/xhtml">
   <head>
  <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
  <title>Create you email account</title>
  <style type="text/css">
 body {
 font-family:"Lucida Grande", "Lucida Sans Unicode", Verdana, Arial, Helvetica,     sans-serif;
 font-size:12px;
  }
  .registration_form {
margin:0 auto;
width:500px;
padding:14px;
 }
 label {
width: 10em;
float: left;
margin-right: 0.5em;
display: block
}
.submit {
 float:right;
 }
 fieldset {
background:#EBF4FB none repeat scroll 0 0;
border:2px solid #B7DDF2;
width: 500px;
 }
  legend {
color: #fff;
background: #80D3E2;
border: 1px solid #781351;
padding: 2px 6px
 }
 .elements {
padding:10px;
 }
 p {
border-bottom:2px solid #B7DDF2;
color:#666666;
font-size:13px;
margin-bottom:20px;
padding-bottom:9px;
 }
 a{
  color:#0099FF;
  font-weight:bold;
 }

 /* Box Style */

  .success, .warning, .errormsgbox, .validation {
border: 1px solid;
margin: 0 auto;
padding:10px 5px 10px 50px;
background-repeat: no-repeat;
background-position: 10px center;
    font-weight:bold;
    width:450px;

 }

 .success {

color: #4F8A10;
background-color: #DFF2BF;
background-image:url('images/success.png');
 }
  .warning {

color: #9F6000;
background-color: #FEEFB3;
background-image: url('images/warning.png');
 }
 .errormsgbox {

color: #D8000C;
background-color: #FFBABA;
background-image: url('images/error.png');

  }
  .validation {

color: #D63301;
background-color: #FFCCBA;
background-image: url('images/error.png');
   }

    </style>

   </head>
   <body>

 <form action="index.php" method="post" class="registration_form">
 <fieldset>
 <legend>Créer Un Compte Mail </legend>

  <p>Create an email account <span style="background:#EAEAEA none repeat scroll 0 0;line-height:2;margin-left:220px;;padding:7px 7px;">Tu as un compe? <a href="http://www.mysite.net/webmail/">Login</a></span> </p>

<div class="elements">
  <label for="firstname">Firstname / Initiale  :</label>
  <input type="text" id="firstname" name="firstname" size="25" />
</div>
<div class="elements">
  <label for="nickname">NickName  :</label>
  <input type="text" id="nickname" name="nickname" size="25" />
</div>  
<div class="elements">
  <label for="email">E-mail  :</label>
  <input type="text" id="email" name="email" size="25" />
</div>
<div class="elements">
  <label for="altemail">Email de verification :</label>
  <input type="text" id="altemail" name="altemail" size="25" />
</div>
<div class="elements">
  <label for="password">Your Password  :</label>
  <input type="password" id="password" name="password" size="25" />
</div>
<div class="submit">
 <input type="hidden" name="formsubmitted" value="TRUE" />
  <input type="submit" value="Submit" />
  </div>
</fieldset>
</form>
Go Back to <a href="index.php">Account Verification on sign up</a>
</body> 
```

大家好我想在这里实现的是：

当用户输入用户名、电子邮件地址和备用电子邮件时，能够检查数据库中是否不存在这些条目并相应地返回错误。

例如，如果用户名已经被使用，它将警告用户选择另一个用户名，依此类推。目前，如果找到三个条目中的任何一个，它只返回一个错误，我该怎么做才能根据表中找到的条目返回错误请。

作为更新，我最初的问题是检查表中的两个单独的字段，

首先，此表格允许人们创建自己的电子邮件帐户，但为此，他们还需要提供现有的电子邮件地址，以便向他们发送链接以激活他们的帐户。

我可以成功检查这三个字段，但我遇到的问题是如何分别为每个字段返回错误。

目前我只能为任何字段返回相同的错误。

首先它将检查电子邮件地址的有效性

其次，它将检查电子邮件地址是否都尚未在系统上，即用户尝试创建的电子邮件地址和他作为备用电子邮件地址提供的电子邮件地址

第三，它会检查昵称是否已经被占用。

现在它完成了上述所有操作，我遇到的唯一问题是如何让它为每个错误返回一个错误。

因此用户不会感到困惑，并且他/她会知道要更改哪个字段才能完成他/她的注册。

如果你能帮我解决这个问题

```
 } else { // The email address is not available.
 echo '<div class="errormsgbox" >Either the nickname is already taken, the email   address is already taken, or the alternative email you supplied is already on our     system</div>';
  } 
```

谢谢大家的帮助，非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T18:05:45.797

`print_r($error)`在不同的调用之间做一些。或者使用 xdebug 来单步执行您的代码。

无论如何，我会建议您使用 CMS 或框架来构建，而不是将所有内容混合在一个文件中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T18:06:21.627

我建议使用类似的框架`Kohana`，将使您的生活更轻松。这也将使您能够确保只有指定的字段通过数据库并进行了清理。不想处理批量分配（我是未来的弯管机）

为可用字段创建一组规则

```
$rules = array(
  'email' => array(
     'valid_email',
     'not_empty'
   ),
   'nickname' => array(
     'not_empty', 
   )
) 
```

编写一个方法来检查规则并获取消息或将其返回为真。

```
foreach ($_POST as $field)
{
   if (isset($rules[$field]))
   {
       // Check the rules
       foreach ($rules[$field] as $rule)
       { 
          $check = call_user_func(array(Valid, $rule), $field);
          if ( !$check->isValid )
          {
              $this->errors[] = $check->message;
           }
           else
           {
              // Insert or do whatever you need to with the data
           }
       }

   }

} 
```

# svn - 将文件的两个修订合并到不同的分支

> ID：13144976
> 
> 赞同：0
> 
> 时间：2012-10-30T17:59:22.843
> 
> 标签：svn, tortoisesvn

我`a.c`在分支中有一个`branch_1`具有以下版本的文件。

```
Previous version: 10
Next version : 20
Current version :25 
```

我的工作副本是`branch_2`

`20`我想将版本之间`10`的差异合并`branch_1`到仅用于`a.c`文件的工作副本中。

我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T19:11:03.933

## 纯SVN方式

~~使用 2-URL-merge 和 PEG-revisions~~底部示例[“将更改合并到单个文件”](http://www.visualsvn.com/support/svnbook/ref/svn/c/merge/)

```
svn merge -c 20 ^/branch1/a.c a.c 
```

# c# - C# 集合/列表 - 唯一 ID

> ID：13144978
> 
> 赞同：2
> 
> 时间：2012-10-30T17:59:26.100
> 
> 标签：c#, list

在 C# 中，我试图创建一个对象列表，当将新事物添加到列表中时，会检查它以确保不使用相同的 ID。我在 Linq 中有解决方案，但我试图在没有 linq 的情况下做到这一点。

```
public void AddStudent(Student student)
        {
            if (students == null)                               
            {
                students.Add(student);                          
            }
            else
            {
                if ((students.Count(s => s.Id == student.Id)) == 1)   

                  // LINQ query, student id is unique
            {
                throw new ArgumentException("Error student " 
                  + student.Name + " is already in the class");
            }
            else
            {
                students.Add(student);
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-30T18:59:07.690

另一种方法是使用 a`HashSet`而不是 a `List`。

`Student`班级：

```
public class Student
{
    private int id;

    public override int GetHashCode()
    {
        return this.id;
    }
    public override bool Equals(object obj)
    {
        Student otherStudent = obj as Student;
        if (otherStudent !=null)
        {
            return this.id.Equals(otherStudent.id);
        }
        else
        {
            throw new ArgumentException();
        }

    }

    public int Id
    {
        get { return id; }
        set { id = value; }
    }

} 
```

然后你可以添加这样的东西

```
 HashSet<Student> hashSetOfStudents = new HashSet<Student>();
    Student s1 = new Student() { Id = 1 };
    Student s2 = new Student() { Id = 2 };
    Student s3 = new Student() { Id = 2 };

    hashSetOfStudents.Add(s1);
    hashSetOfStudents.Add(s2);
    hashSetOfStudents.Add(s3); 
```

添加`s3`将失败，因为它与`Id`相同`s2`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T18:03:00.787

您可以覆盖`Student.Equals()`并`Student.GetHashCode()`检查 Student.Id 是否相等。如果学生列表继承自`List<Student>`，您可以使用默认`Add()`方法。它只会添加具有不同 ID 的学生。

```
public class Student
{
    // ...

    public override bool Equals(object obj)
    {
        // Check for null values and compare run-time types.
        if (obj == null || GetType() != obj.GetType()) 
            return false;

        Student other = obj as Student;
        return this.Id == other.Id;
    }

    public override int GetHashCode()
    {
        return this.Id.GetHashCode();
    }
}

public class StudentList : List<Student> { }

// Usage:

var students = new StudentList();
students.Add(student); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-30T18:03:25.820

不同项目的列表听起来非常像一[组](http://msdn.microsoft.com/en-us/library/dd412081.aspx)

更新：为如何选择适当的数据结构编写一个好的动机有点乏味，我将向您展示一旦您更熟悉 .NET 框架，您将如何编写上述内容：

```
public void AddStudent(Student student)
{
    /* this.students is an ISet<Student> */
    if (!this.students.Add(student))
    {
       throw new ArgumentException("student");
    }
} 
```

这当然假设*Student*具有*Equals()*和*GetHashCode()*的合适定义。*根据使用的具体 ISet 类型，您实际上可能会通过GetHashCode()*的良好定义获得一些不错的副作用，但该讨论可能有点超出了这个问题的范围。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-30T18:06:19.537

我会使用[字典](http://msdn.microsoft.com/en-us/library/xfhwa508.aspx)

```
students Dictionary<int, Student> = new Dictionary<int, Student>(); 
```

然后检查你是否已经有那个学生

```
if (!students.ContainsKey(student.id))
{
      students.add(student.id, student);
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-30T18:08:26.713

使用`foreach`循环：

```
 public void AddStudent(Student student)
    {
        if (students == null)
        {
            students.Add(student);
        }
        else
        {
            foreach (var s in students)
            {
                if (student.Id == s.Id)
                {
                    throw new ArgumentException("Error student "
                    + student.Name + " is already in the class");
                }
            }
            students.Add(student);
        }
    } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-30T18:04:55.063

有很多方法可以做到这一点，这里有两种可能的解决方案

## 1\. 您可以遍历您的列表。

```
bool alreadyInList = false;
foreach (var item in students) 
{
 if (item.Id == student.Id)
 {
    alreadyInList = true;
    break; // break the loop
 }
}

if (!alreadyInList)
{
   students.Add(student);
} 
else
{
     throw new ArgumentException("Error student " 
              + student.Name + " is already in the class");
} 
```

## 2\. 覆盖对象`Equals`中的方法`Student`并使用`Contains`.

```
public class Student 
{
    public override bool Equals(object x) 
    {
        return ((Student)x).Id == this.Id;
    }
}

if (!students.Contains(student)) 
{
   students.Add(student);
} 
else 
{
     throw new ArgumentException("Error student " 
              + student.Name + " is already in the class");
} 
```

更多信息：

*   [MSDN - Object.Equals 方法（对象）](http://msdn.microsoft.com/en-us/library/bsc2ak47.aspx)
*   [MSDN - List.Contains 方法](http://msdn.microsoft.com/en-us/library/bhkz42b3.aspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-10-30T18:05:13.723

将保存学生的结构设为 a并通过[ContainsKey](http://msdn.microsoft.com/en-us/library/kw5aaea4.aspx)`dictionary<int,Student>`检查 ID 是否已在字典中。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2012-10-30T18:11:05.487

首先将所有可用的 id 读入`list`or ，然后通过检查or`array`确保新 id 与现有 id 不匹配。`list``array`

# c++ - C ++ Redishiredis编译器错误？

> ID：13144981
> 
> 赞同：1
> 
> 时间：2012-10-30T17:59:31.813
> 
> 标签：c++, redis

感谢这个网站上的某个人，我能够使用示例 C++ 源文件。 [https://gist.github.com/1893378](https://gist.github.com/1893378) 当我编译这个时，我得到了一堆奇怪的编译器错误：

```
/home/.../workspace/redis-hiredis-3c46b13/pipelineTest.cpp: In function ‘void redisTop(redisContext*)’:
/home/.../workspace/redis-hiredis-3c46b13/pipelineTest.cpp:142:32: error: invalid conversion from ‘void*’ to ‘redisReply*’
/home/../workspace/redis-hiredis-3c46b13/pipelineTest.cpp:162:25: warning: format ‘%d’ expects type ‘int’, but argument 2 has type ‘long int’
/home/=.../workspace/redis-hiredis-3c46b13/pipelineTest.cpp: In function ‘int main(int, char**)’: 
```

我意识到我可能与hiredis libray 不同步，但我使用的是最新的。任何想法如何正确构建这个 C++ 程序？

另外，我正在寻找使用 Redis 的完整 C++ 管道教程。这是Java中一个非常好的示例：

[http://www.cafebabe.me/2011/05/redis-pipelines-and-transactions.html](http://www.cafebabe.me/2011/05/redis-pipelines-and-transactions.html)

没有像这样的 C++ 示例教程吗？
无论哪种方式都感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T18:34:16.307

实际上，它是一个 C 程序，而不是 C++。C++ 编译器通常比 C 编译器更迂腐，而且它会抱怨。使用 C++ 编译器进行编译需要稍作修改。

我做了，又把文件放到网上： [https ://gist.github.com/1893378](https://gist.github.com/1893378)

它现在可以使用 g++ 3.4 和 4.3 正常编译

AFAIK，Redis 没有 C++ 教程。我认为在 C++ 中处理 Redis 的最佳方法是在hiredis 之上开发自己的包装类。这并不难。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-07-19T05:25:56.977

只需将 redisCommand 转换为 redisReply

```
reply = (redisReply *)redisCommand(context, "PING"); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-30T18:16:32.690

这是一个 C 程序。您必须使用 C 编译器构建它。

# c++ - 用 C++ 实现图像插值

> ID：13144984
> 
> 赞同：0
> 
> 时间：2012-10-30T17:59:50.100
> 
> 标签：c++, image-processing, opencv, stl, implementation

我有一个关于用 C++ 实现图像插值（双三次和双线性方法）的问题。我主要关心的是速度。根据我对问题的理解，为了让插值程序快速高效，可以采用以下策略：

1.  使用流式 SIMD 扩展 (SSE) 的快速图像插值

2.  使用多线程或 GPU 进行图像解释

3.  快速图像插值算法

4.  C++ 实现技巧

在这里，我对最后一个策略更感兴趣。我设置了一个插值类：

```
 /**
        * This class is used to perform interpretaion for a certain poin in 
        * the image grid.
        */
        class  Sampling
        {
        public:
            //   samples[0] *-------------* samples[1]
            //              --------------
            //              --------------
            //   samples[2] *-------------*samples[3]
            inline void sampling_linear(unsigned char *samples, unsigned char &res)
            {
                unsigned char res_temp[2];
                sampling_linear_1D(samples,res_temp[0]);
                sampling_linear_1D(samples+2,res_temp[1]);
                sampling_linear_1D(res_temp,res);
            }
        private:
            inline void sampling_linear_1D(unsigned char *samples, unsigned char &res)
            {
            }
        } 
```

这里我只举一个双线性插值的例子。为了使程序运行得更快，使用了内联函数。我的问题是这种实施方案是否有效。此外，在解释过程中，如果我让用户选择在不同的插值方法之间进行选择。然后我有两个选择：

1.  根据插值方法，调用函数对整个图像执行插值。
2.  对于每个输出图像像素，首先确定其在输入图像中的位置，然后根据插值方法设置，确定插值函数。

第一种方法意味着程序中的代码更多，而第二种方法可能导致效率低下。那么，我该如何在这两种方案之间进行选择呢？谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-30T18:17:23.100

> 使用流式 SIMD 扩展 (SSE) 的快速图像插值

这可能无法提供所需的结果，因为我希望您的算法将是内存限制的，而不是 FLOP/s 限制的。

我的意思是 - 这肯定会有所改进，但与实施成本相比没有好处。

顺便说一句，现代编译器可以执行自动矢量化（即使用 SSE 和其他扩展）：[GCC 从 4.0](http://gcc.gnu.org/projects/tree-ssa/vectorization.html)开始，[MSVC 从 2012 开始](http://msdn.microsoft.com/en-us/library/hh872235.aspx)，[MSVC Auto-Vectorization 视频讲座](http://channel9.msdn.com/Series/C9-Lectures-Jim-Radigan-Inside-Auto-Vectorization/Jim-Radigan-Inside-Auto-Vectorization-1-of-n)。

> 使用多线程或 GPU 进行图像解释

多线程版本应该会产生良好的效果，因为它可以让您利用所有可用的内存吞吐量。

如果你不打算多次处理数据，或者在 GPU 上以某种方式使用它，那么 GPGPU 可能不会给出想要的结果。是的，它会更快地产生结果（主要是由于更高的内存速度），但是这种效果会被主 RAM 和 GPU 的 RAM 之间的缓慢传输所抵消。

例如，近似现代吞吐量：

1.  CPU RAM ~ 20GiB/s
2.  GPU RAM ~ 150GiB/s
3.  在 CPU RAM <-> GPU RAM 之间传输 ~ 3-5 GiB/s

对于单程内存限制算法，在大多数情况下，第三项使 GPU 的使用变得不切实际（对于此类算法）。

> 为了使程序运行得更快，采用了内联函数

默认情况下，类成员函数是“内联”的。请注意，“内联”的主要目的实际上并不是“内联”，而是有助于防止在标题中定义函数时违反[单一定义规则。](http://en.wikipedia.org/wiki/One_Definition_Rule)

有依赖于编译器的“forceinline”特性，例如 MSVC 有[__forceinline](http://msdn.microsoft.com/en-us/library/z8y1yy88%28v=vs.71%29.aspx)。或者从编译器 ifdef'ed BOOST_FORCEINLINE 宏中抽象出来。

无论如何，除非您没有证明，否则请相信您的编译器（例如在汇编程序的帮助下）。最重要的事实是编译器应该看到函数定义 - 然后它可以决定自己内联，即使函数本身不是内联的。

> 我的问题是这种实施方案是否有效。

据我了解，作为预步骤，您将样本收集到 2x2 矩阵中。我认为直接将两个指针直接传递给图像中两个元素的数组可能会更好，或者一个指针+宽度大小（自动计算第二个指针）。但是，这不是一个大问题，您的临时 2x2 矩阵很可能会被优化掉。

* * *

真正重要的是——你如何遍历你的图像。

假设对于给定的 x 和 y，索引计算为：

```
i=width*y+x; 
```

那么你的遍历循环应该是：

```
for(int y=/*...*/)
    for(int x=/*...*/)
    {
        // loop body
    } 
```

因为，如果您选择另一个顺序（先是 x，然后是 y） - 它对缓存不友好，因此性能下降可能高达 64 倍（取决于您的像素大小）。你可以检查它只是为了你的兴趣。

> 第一种方法意味着程序中的代码更多，而第二种方法可能导致效率低下。那么，我该如何在这两种方案之间进行选择呢？谢谢！

在这种情况下，您可以使用编译时多态性来减少第一个版本的代码量。例如，基于模板。

只需看一下[std::accumulate](http://www.sgi.com/tech/stl/accumulate.html) - 它可以编写一次，然后它将适用于不同类型的迭代器、不同的二进制操作（函数或函子），而不会因为它的多态性而暗示任何运行时惩罚。

[亚历山大·斯捷潘诺夫 说](http://www.stepanovpapers.com/BYTE_com.htm)：

> 多年来，我试图在更高级的语言（例如，Ada 和 Scheme）中实现相对效率，但失败了。即使是简单算法的通用版本也无法与内置原语竞争。但在 C++ 中，我终于不仅能够实现相对效率，而且非常接近于绝对效率这一更雄心勃勃的目标。为了验证这一点，我花了无数个小时查看不同编译器在不同架构上生成的汇编代码。

* * *

检查[Boost 的通用图像库](http://www.boost.org/doc/libs/1_51_0/libs/gil/doc/index.html)- 它有很好的教程，并且有作者的[视频演示](http://stlab.adobe.com/gil/presentation/index.htm)。

# jquery - 在 jquery 的 focusout 上，检测焦点是否转移或没有元素有焦点

> ID：13144985
> 
> 赞同：2
> 
> 时间：2012-10-30T17:59:53.490
> 
> 标签：jquery, focus

我正在使用 jquery 1.8.2，有 2 个输入字段，并且想要一种方法来检测每个字段是否有焦点，或者都没有焦点。

任何帮助将不胜感激，谢谢。

编辑：

我已经更新了 jsfiddle 以更接近我想要的，所以没有混淆。这里的问题是我有 2 个绑定在一起的输入字段。当一个焦点集中时，我想增大一个并缩小另一个，如果两者都没有集中，我想将它们重置为原始宽度。我可以处理一些全局变量，这些变量会更新焦点并跟踪两者是否处于焦点位置，但我想看看是否首先存在 jquery 解决方案。这是更新后的 jsfiddle，带有一个用于切换重置动画的按钮，因此您可以看到它现在是如何跳跃的：

[http://jsfiddle.net/LZn85/12/](http://jsfiddle.net/LZn85/12/)

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js" type="text/javascript"></script>

<input class="searchy-search input1" />
<input class="searchy-search input2" />
<p>who has focus?</p>
<div class="focus-who jquery-focus"></div>

<button class="out-focus">toggle focus out</button>​

$(document).ready(function() {
    $('.focus-who').html('init');
    $('.input1').val('some long string of text');
    $('.input2').val('some long string of text');

    $('.searchy-search').focusin(function() { 
        var $shrinkSelector;
        if($(this).hasClass('input1')) {
            $shrinkSelector = $('.input2');
        } else if($(this).hasClass('input2')) {
            $shrinkSelector = $('.input1');
        }   
        var initWidth = 100;
        var inputVal = $(this).val();
        var inputLength = inputVal.length;

        if(inputLength > 16) {
            var offset = ((inputLength - 16) * 6); 
            var growWidth = initWidth + offset;
            var shrinkWidth = initWidth - offset;
            var aniTime = 200;
            $(this).animate({width: growWidth + 'px'}, aniTime);
            $shrinkSelector.animate({width: shrinkWidth + 'px'}, aniTime);
        }  
    });
    var outFocus = false;
    $('.out-focus').click(function() {
        outFocus = !outFocus;
    });
    $('.searchy-search').focusout(function() {
        if(outFocus) {
            $('.searchy-search').animate({width: '130px'}, 200);
        }
    });
});​ 
```

另一个编辑：

看起来这可能只是我最好的选择。如果有人有任何其他想法会很棒，但现在我想我只需要这样做。

[使用 JavaScript 或 jQuery 检测哪个表单输入具有焦点](https://stackoverflow.com/questions/354718/detect-which-form-input-has-focus-using-javascript-or-jquery)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T18:43:56.933

我认为这不适用于 focusout 事件，因为 focusout 事件发生在 focus 事件之前。因此，您的代码在浏览器知道现在哪个元素具有焦点之前触发。是否有理由必须检查 focusout 事件？你可以做一些同时使用 focus 和 focusout 事件的事情：

```
$(document).ready(function() {
   $('.focus-who').html('init');

   $('.searchy-search').focus(function() {
       $('.jquery-focus').html($(this).attr("id"));
   });

   $('.searchy-search').focusout(function() {
       $('.jquery-focus').html("nothin");
   });
});​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T08:33:04.887

目前还不清楚您要做什么，但这可能会有所帮助。

您可以检测焦点是否已远离父元素的所有子元素`parentEl`：

```
 // Trigger when any children have lost focus
  parentEl.on('focusout', function() {
    // Check where focus has moved to
    setTimeout(function() {
      if(parentEl.find(":focus").length == 0){
        // Focus has moved outside the parent element
      }else{
        // Focus has moved to another element within the parent element
      }
    }, 50)
  }); 
```

50ms`setTimeout`让浏览器有机会在我们检查之前将焦点移到新元素上。

# java - 兰顿蚂蚁中的 JVM 堆大小错误

> ID：13144986
> 
> 赞同：0
> 
> 时间：2012-10-30T17:59:58.400
> 
> 标签：java, jvm

我试图用Java制作一个Langton's ant（http://en.wikipedia.org/wiki/Langton's_ant）程序。我最初想到了一个只有两种颜色的简单实现 - 因此是一个布尔网格 - 或一个布尔值二维数组。

这里似乎有一个问题——网格需要在运行时构建——即用户输入网格长度的值。

这意味着我不能获取超过特定值的网格值 - 因为它会在 Java 堆上引发 Out of memory 错误。

我最多可以制作的典型网格是（30,000 * 30,0000）。

我正在考虑解决这个问题的方法，以至少使网格达到 2^32*2^32..

有人可以提供即兴算法的建议吗？还是其他优化？

虽然我的问题是针对一个特定问题的......我猜想解决这个问题的策略可能与许多此类问题相匹配。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T18:08:21.937

您不需要为此在内存中分配和保存矩阵。您只能在节点列表中维护访问过的位置。一个节点将具有如下信息：`x`和`y`坐标（来自虚拟矩阵）和`color`. 这样你的蚂蚁只需要知道她在虚拟矩阵中的位置（`x`和`y`），并且需要遵循的方向将根据蚂蚁所在节点的颜色来计算。

# android - 片段特定的操作栏菜单项

> ID：13144987
> 
> 赞同：0
> 
> 时间：2012-10-30T17:59:59.333
> 
> 标签：android, actionbarsherlock

我正在使用使用下拉列表导航样式的 ActionBarSherlock 构建应用程序。我设置了每个下拉列表项加载不同的片段，并且效果很好。不起作用的是操作栏中的菜单项。我有`setHasOptionsMenu(true)`我想要菜单项的片段，以及

```
@Override
public void onCreateOptionsMenu(Menu menu, MenuInflater inflater) {
    super.onCreateOptionsMenu(menu, inflater);
    inflater.inflate(R.menu.fragment_menu, menu);
} 
```

对于片段中的菜单。每次我更改片段时，我都不想添加正在发生的菜单项。选择一个片段后，菜单会加载良好，然后选择一个不应该具有菜单项的不同片段，并且菜单项与以前的片段相同。然后，如果我回到第一个片段，菜单项会增加一倍，因为它们不断被附加。我该如何控制这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T02:44:00.680

我想到了。我没有`FragmentTransaction`用来加载片段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T18:09:59.130

在正常情况下，不应附加菜单。您的 menu.xml 是什么样的？你有id的设置吗？也许在活动中创建一个菜单？

# php - 从外部服务器加载元素内容

> ID：13144988
> 
> 赞同：0
> 
> 时间：2012-10-30T17:59:59.820
> 
> 标签：php, jquery

我正在根据供应商提供的产品数据构建我的网站。所有与产品相关的页面都位于供应商的网站上。

供应商允许我创建一个“产品摘要”链接以将其用作 Wordpress 中的帖子。基本上，该帖子包含带有简短信息的产品列表。

如果我单击其中一种产品，它将带我进入“产品详细信息”页面，该页面再次位于供应商的服务器上。

在这一点上，我所能做的就是在我的首页上显示“产品摘要”帖子作为预告片。

我真正想在首页用作预告片的是一些产品而不是产品摘要。

我使用 file_get_contents() 在我的“详细信息”帖子中回显产品详细信息：

```
function demo_file_get_contents(){
    if(is_page('detail')){
       echo file_get_contents('http://vendorsite.com/product.html');
    }
}
add_action('wp_head','demo_file_get_contents'); 
```

然后我尝试捕捉“绿色”属性，因此我可以将此产品分配到“绿色”类别，并将产品显示为首页上的一组绿色产品预告片。

```
function demo_retriveAttr(){
  if(is_page('detail')){
     ?>            
        <script type="text/javascript">                
          jQuery(document).ready(function() {   
            $('#color').load('http://mysite.com/detail.html #product-color');            
          });
        </script>
      <?php
  }
}
add_action('wp_footer','demo_retriveAttr'); 
```

我的问题是：

1.  file_get_contents 是捕获外部数据的最佳实践吗？
2.  .load() 函数不起作用，我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T18:20:28.850

1.  除了 file_get_contents()，您还可以使用 cURL 方法（参考[“使用 PHP cURL 下载 URL 的内容”](http://davidwalsh.name/curl-download)）。就最佳实践而言，我相信任何一种方法都是合适的。[这里](https://stackoverflow.com/questions/555523/file-get-contents-vs-curl-what-has-better-performance)有一些关于性能差异的好信息。

2.  您的 .load() 函数可能无法正常工作的原因有很多。您是否检查过控制台是否有任何错误消息？您决定使用 wp_head() 钩子加载外部服务器页面内容是否有原因？如果 file_get_contents() 正在提取额外的 [html]、[head] 和 [body] 标签，则在同一个文档中包含多个上述标签通常会产生冲突。

您能否为 detail.html 文档提供一些代码？具体来说，你在哪里摇摆 #product-color 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T18:02:45.570

### 快速解答

1.  如果您的服务器可以访问该网站，这`file_get_contents`是一个很好的选择。
2.  如果该`.load()`功能不起作用，您可能必须启用 CORS。为安全起见，浏览器通常会阻止跨域请求。

# html - 圆角隐藏溢出 + 变换（在 Firefox 和 Safari 中可以，在 Chrome 和 Opera 中不行）

> ID：13144992
> 
> 赞同：0
> 
> 时间：2012-10-30T18:00:12.100
> 
> 标签：html, rounded-corners, css

我尝试使 div 的圆角掩码其子项的内容。感谢[这个问题](https://stackoverflow.com/questions/5736503/how-to-make-css3-rounded-corners-hide-overflow-in-chrome-opera)，我做到了，但是当孩子们被改造时它不起作用。

所以这个[http://jsfiddle.net/ut2DW/](http://jsfiddle.net/ut2DW/)在 Firefox 和 Safari（！）中运行良好，但在 Chrome 和 Opera 中运行良好，除非我们删除 transforms 属性（并调整边距）：

CSS（更多在 JSFiddle 中）

```
div {
    position: absolute;
}

a {
    display: block;
    overflow: hidden;
    -webkit-border-radius: 0 0 20px 0;
            border-radius: 0 0 20px 0;
}

span {
    display: block;
    transform: rotate(45deg);
} 
```

HTML

```
<div>
    <a href="#">
        <span></span>
    </a>
</div> 
```

我怎样才能让它（至少）在 Chrome 中工作？（哦拜托，我不想做图像！）

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T19:11:05.853

我想这是由于`transform: rotate(45deg);`

我不知道为什么它也不起作用..如果您删除它可以按您的意愿工作..

我建议你添加背景图片而不是旋转

```
span {
    display: block;
    margin: 22px 0 0 22px;
    width: 100px;
    height: 100px;
    background: #000 url(../img/black-triangle.png) no-repat;
}​ 
```

# html - 当我不想要它时，jQuery toggle() 动画？

> ID：13144999
> 
> 赞同：0
> 
> 时间：2012-10-30T18:00:45.077
> 
> 标签：html, jquery

我有 ID 为“albums”、“about”和“contact”的三个元素，以及通过 toggle() 函数显示/隐藏它们的三个链接，ID 分别为“togglealbums”、“toggleabout”和“togglecontact” . 我只希望能够随时看到这些元素之一，因此我编写了以下函数：

```
$('#togglealbums').click(function() {
  if( $('#about').is(':visible') ) {
    $('#about').toggle(function() {
      $('#albums').toggle();
    });
  } else if( $('#contact').is(':visible') ) {
    $('#contact').toggle(function() {
      $('#albums').toggle();
    });
  } else {
    $('#albums').toggle();
  }
});

$('#toggleabout').click(function() {
  if( $('#albums').is(':visible') ) {
    $('#albums').toggle(function() {
      $('#about').toggle();
    });
  } else if( $('#contact').is(':visible') ) {
    $('#contact').toggle(function() {
      $('#about').toggle();
    });
  } else {
    $('#about').toggle();
  }
});

$('#togglecontact').click(function() {
  if( $('#albums').is(':visible') ) {
    $('#albums').toggle(function() {
      $('#contact').toggle();
    });
  } else if( $('#about').is(':visible') ) {
    $('#about').toggle(function() {
      $('#contact').toggle();
    });
  } else {
    $('#contact').toggle();
  }
}); 
```

首先，如果这些效率极低或者有更简单的方法可以做到这一点，请告诉我。

我发现如果三个 DIV 都不可见，单击其中一个切换链接将显示/隐藏相应的 div，没有动画。但是，如果其中一个 DIV 可见，则单击另一个切换链接将导致 div 缩小和淡入，而新的 div 会展开并淡入，这是我不想要的（至少现在是这样）。这可以在这里看到：http: [//new.e17.paca.arvixe.com](http://new.e17.paca.arvixe.com)。

谁能告诉我为什么会这样？

谢谢！

编辑：

标记在这里：

```
<body>
  <div id="main">
    <div id="nav">
      <div id="menu">
        <ul>
          <li><a href="#" id="togglealbums">Albums</a></li>
          <li><a href="#" id="toggleabout">About Me</a></li>
          <li><a href="#" id="togglecontact">Contact</a></li>
        </ul>
      </div>
    </div>
    <div id="albums">
      Albums go here
    </div>
    <div id="about">
      About info goes here
    </div>
    <div id="contact">
      Contact info goes here
    </div>
  </div>
</body> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T18:11:46.877

你的收缩和淡入淡出发生是因为，如果`.toggle()`给定一个回调函数，它假设你想要动画切换而不是仅仅打开/关闭它。（根据[文档](http://api.jquery.com/toggle/)，在撰写本文时，只有在您提供持续时间时才会发生这种情况。我已经提交了关于此的错误报告。）

请参阅[http://jsfiddle.net/mblase75/byKeP/1/](http://jsfiddle.net/mblase75/byKeP/1/)以了解这方面的简化示例。要解决它，只需删除回调并将相同的代码放在函数的下一行。

至于简化你的代码，类是你的朋友。HTML：

```
<a href="#" class="togglelink" data-block="albums" id="togglealbums">toggle albums</a>
<a href="#" class="togglelink" data-block="about" id="toggleabout">toggle about</a>
<a href="#" class="togglelink" data-block="contact" id="togglecontact">toggle contact</a>

<div class="toggleblock" id="albums">ALBUMS</div>
<div class="toggleblock" id="about">ABOUT</div>
<div class="toggleblock" id="contact">CONTACT</div> 
```

请注意`data-`jQuery 将解析并通过该`.data()`方法访问的属性。这使得在超链接本身上存储唯一 ID 变得很容易`div`，从而极大地简化了我们的 JavaScript。JS：

```
$('.togglelink').on('click',function(e) {
    var id = $(this).data('block');
    $('#'+id).toggle().siblings('.toggleblock').hide();
});​ 
```

[http://jsfiddle.net/mblase75/byKeP/](http://jsfiddle.net/mblase75/byKeP/)