# StackOverflow 问答 13961000-13961999

# ruby-on-rails - 使用 PostgreSQL 使用 ActiveRecord 准备和执行语句

> ID：13961005
> 
> 赞同：5
> 
> 时间：2012-12-19T20:54:25.087
> 
> 标签：ruby-on-rails, activerecord, insert, prepared-statement

我正在尝试使用 ActiveRecord 通过准备好的语句插入值。但是，每次我尝试：

```
conn = ActiveRecord::Base.connection
conn.prepare "SELECT * from sampletable where id = $1"
conn.execute 3 
```

在第二个语句之后，我得到：

```
NoMethodError: undefined method `prepare' for
#<ActiveRecord::ConnectionAdapters::PostgreSQLAdapter:0x000001027442c8> 
```

我该怎么办？我正在运行 Rails 3.2.1 和 Ruby 1.9.2

更新：

我解决了这个问题。感谢您的回复，但它不适用于 PostgreSQL。这样做的方法是：

```
stmt = "SELECT * from sampletable where id = $1 and name = $2"
values = [ { value: 1}, { value: "henry" } ] 
```

其中 values 是一个散列数组，每个指定一个值，$1 绑定到第 0 个散列，$2 绑定到数组中的第 2 个散列，依此类推

```
con = PG::Connection.new(:dbname => "development_DB")
con.prepare("insert", stmt)
con.exec_prepared("insert", values)
con.close() 
```

女士们，先生们，这很有效！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-10-09T04:47:53.763

从已编辑的问题正文中复制答案，以便从“未回答”过滤器中删除此问题：

> 我解决了这个问题。感谢您的回复，但它不适用于 PostgreSQL。这样做的方法是：
> 
> ```
> stmt = "SELECT * from sampletable where id = $1 and name = $2"
> values = [ { value: 1}, { value: "henry" } ] 
> ```
> 
> where values is an array of hashes, each specifying a value, $1 is bound to the 0th hash, $2 is bound to the 2nd hash in the array and so on
> 
> ```
> con = PG::Connection.new(:dbname => "development_DB")
> con.prepare("insert", stmt)
> con.exec_prepared("insert", values)
> con.close() 
> ```
> 
> And this, ladies and gentlemen, works!

~ answer per [alalani](https://stackoverflow.com/users/1523610/alalani)

# ruby-on-rails - Bundler 找不到 gem 的版本，但 gem install 同名有效

> ID：13961007
> 
> 赞同：23
> 
> 时间：2012-12-19T20:54:32.697
> 
> 标签：ruby-on-rails, bundler, gemfile

我创建了一个 gem，由于某种原因，这个 gem 一直困扰着我，并且拒绝通过 bundler 正确安装。

这是*Gemfile*：

```
source 'https://rubygems.org'
gem 'rails', '3.2.9'
gem "switch_access-rails", "~> 1.1.6" 
```

*捆绑安装*失败：

```
Could not find gem 'switch_access-rails (~> 1.1.6) ruby' in the gems available on this machine. 
```

这有效：

```
gem install switch_access-rails -v 1.1.6 
```

宝石在 ruby​​gems 上：[https ://rubygems.org/gems/switch_access-rails/versions/1.1.6](https://rubygems.org/gems/switch_access-rails/versions/1.1.6)

我什至尝试从 1.1.5 版本升级到 1.1.6 版本，看看是否有帮助。

使用 bundle install 安装 1.1.4 版有效。

关于从哪里开始查找/调试捆绑安装的任何提示？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-12-19T21:07:55.417

经过一整天的谷歌搜索，我发现了 12 月 12 日的状态更新：http: [//twitter.com/rubygems_status/status/279019743166476288](http://twitter.com/rubygems_status/status/279019743166476288)

```
bundle install --full-index 
```

似乎直接从 ruby​​gems 而不是从云端缓存获取索引。

我看了一下索引，两个索引有很大区别，所以如果你刚刚发布了一个gem或者使用了一个新发布的gem，你可能需要添加--full-index才能得到正确的索引.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T21:02:14.097

您是否将 ruby​​gems 列为远程源？

你`Gemfile`应该`source :rubygems`在文件的顶部，并且`$ gem sources`至少应该返回：

```
*** CURRENT SOURCES ***

http://rubygems.org/ 
```

如果它没有列出，你可以添加它`$ gem sources -a http://rubygems.org`

# c# - 实体框架查询，如何选择多于1个表？

> ID：13961010
> 
> 赞同：1
> 
> 时间：2012-12-19T20:54:38.320
> 
> 标签：c#, .net, entity-framework, entity

我有这个查询

```
var resultado = from c in conn.carrera
                            join u in conn.usuario on c.idusuario equals u.idusuario
                            join t in conn.texto on c.idtexto equals t.idtexto
                            where c.estatus == 1
                            select c; 
```

我如何得到它：

```
select c.*,u.*,t.eltexto from carrera c
join usuario u on c.idusuario =u.idusuario
join texto t on c.idtexto = t.idtexto
where c.estatus = 1 
```

你可以在我的查询中看到，`select c.*, u.* and t.col1,`那么我如何在 EF 中得到它？因为我的第一个查询只得到`carrera.*`但我需要更多数据。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T20:58:29.507

您可以轻松地返回一个包含三个连接表的所有属性的新对象：

```
var resultado = from c in conn.carrera
                            join u in conn.usuario on c.idusuario equals u.idusuario
                            join t in conn.texto on c.idtexto equals t.idtexto
                            where c.estatus == 1
                            select new
                            { 
                               c.prop_1, 
                               c.prop_n, 
                               u.prop_1, 
                               u.prop_n, 
                               t.prop_1, 
                               t.prop_n 
                            }; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T21:20:43.993

```
select c.*,u.*,t.eltexto from carrera c
join usuario u on c.idusuario =u.idusuario
join texto t on c.idtexto = t.idtexto
where c.estatus = 1

from c in Carrerra
join u in Usuario on c.idusuario equals u.idusuario
join t in Texto on c.idtexto equals t.idtexto
where c.estatus = 1
select new {
  newcolumn1 = c.column1,
  c.column2,
  usercolumn1 = u.column1,
  usercolumn2 = u.column2,
  textcolumn = t.column1
} 
```

如果您想访问对象本身，那么您可以这样做

```
select new {
  usario = u,
  carrera = c,
  texto = t
} 
```

Carrera、Usario 和 Texto 指的是实体框架容器中的模型。

# testing - 设置内部数组时 PHPUnit 测试失败

> ID：13961011
> 
> 赞同：0
> 
> 时间：2012-12-19T20:54:42.593
> 
> 标签：testing, phpunit

有许多测试工作，但我对某些对象的实际测试失败了，我不知道为什么。当我在一个简单的测试中单步执行代码时，我可以看到我要测试的内容已定义，但 PHPUnit 未能通过测试。

我在下面编辑了一些小代码示例，以尝试在没有太多噪音的情况下说明问题。

类定义的非常简单的子集。

```
class UTIL_CATEGORY_SCOPE extends UTIL_MESSAGE_DATA
{
    function __construct($CategoryNo = NULL, $CategoryName = NULL)
    {
        $this->DeclareClassFields_();

        $this->CategoryName = $CategoryName;
        $this->CategoryNo   = $CategoryNo;
    }

    private function DeclareClassFields_()
    {
        $this->Fields['CategoryNo']             = new UTIL_ICAP_FIELD('CCL', 6, 'Category', 8);
        $this->Fields['SubCategoryNo']          = new UTIL_ICAP_FIELD('SCC', 6, 'Sub-Category', 12);
        $this->Fields['SubSubCategoryNo']       = new UTIL_ICAP_FIELD('SSC', 6, 'Sub-Sub-Category', 12);
    }
} 
```

Netbeans 调试器中的普通代码可以查看此功能。

```
$Category = new UTIL_CATEGORY_SCOPE(); 
```

转储内容以比较 PHPUnit 测试样本。

```
var_dump($Category);

class UTIL_CATEGORY_SCOPE#1 (4) {
  public $TheMessage_ =>
  class MESSAGE_DATA#2 (0) {
  } 
```

还行吧。预期和工作，因为类 InstanceOf 可以被测试并正确通过。

在内部，有一个在数组中维护的字段列表，这是一个类对象数组，它使用魔术方法来获取/设置值等...... 数组是否已初始化？

```
var_dump($Category->Fields);

array(3) {
    'CategoryNo' =>
        class UTIL_ICAP_FIELD#3 (14) {
            public $FieldCode =>
                string(3) "CCL"
            public $FieldLength =>
                int(6)
            public $FieldTitle =>
                string(8) "Category"
        }
    'SubCategoryNo' =>
        class UTIL_ICAP_FIELD#4 (14) {
            public $FieldCode =>
                string(3) "SCC"
            public $FieldLength =>
                int(6)
            public $FieldTitle =>
                string(12) "Sub-Category"
        }
    'SubSubCategoryNo' =>
        class UTIL_ICAP_FIELD#5 (14) {
            public $FieldCode =>
                string(3) "SSC"
            public $FieldLength =>
                int(6)
            public $FieldTitle =>
                string(16) "Sub-Sub-Category"
        }
    } 
```

数组按预期初始化。
检查数组是否存在并且可以访问各个项目。

```
if (array_key_exists('CategoryNo', $Category->Fields))
    echo 'Array Key Exists';

    Array Key Exists

if( $Category->Fields['CategoryNo'] instanceof UTIL_ICAP_FIELD )
    echo 'Yes';

Yes 
```

一切都按预期报告。

PHPUnit 测试部分：

```
class TEST_UTIL_CATEGORY_SCOPE extends PHPUnit_Framework_TestCase
{
    protected function setUp()
    {
    }

    public function testObjectCreation()
    {
        $CategoryInfo = new UTIL_CATEGORY_SCOPE();
        $this->assertInstanceOf('UTIL_CATEGORY_SCOPE', $CategoryInfo);
        $this->assertInstanceOf('UTIL_DATA_STRUCTURE', $CategoryInfo);
    }

    public function testConstructFieldOrder()
    {
        $CategoryInfo = new UTIL_CATEGORY_SCOPE(1500, 'Category Name');
        $this->assertEquals(1500, $CategoryInfo->CategoryNo);
        $this->assertEquals('Category Name', $CategoryInfo->CategoryName);
    }

    /**
     *
     */
    public function testConstructDefaults()
    {
        $CategoryInfo = new UTIL_CATEGORY_SCOPE();
        $this->assertNull($CategoryInfo->CategoryNo);
        $this->assertNull($CategoryInfo->CategoryName);
    } 
```

这些测试按预期通过。但是，鉴于上述信息的转储，以下 2 个测试失败，即使测试运行和 var_dump 显示这些值已按预期初始化并呈现。

```
 public function testFieldsCreated()
    {
        $CategoryInfo = new UTIL_CATEGORY_SCOPE();
        $this->assertArrayHasKey('CategoryNo', $CategoryInfo->Fields);
        $this->assertArrayHasKey('SubCategoryNo', $CategoryInfo->Fields);
        $this->assertArrayHasKey('SubSubCategoryNo', $CategoryInfo->Fields);
    } 
```

创建的错误：

```
1) TEST_UTIL_CATEGORY_SCOPE::testFieldsCreated
Failed asserting that an array has the key 'CategoryNo'. 
```

下一个测试

```
 public function testICAPFieldTypes()
    {
        $CategoryInfo = new UTIL_CATEGORY_SCOPE();
        $this->assertInstanceOf('UTIL_ICAP_FIELD', $CategoryInfo->Fields['CategoryNo']);
        $this->assertInstanceOf('UTIL_ICAP_FIELD', $CategoryInfo->Fields['SubCategoryNo']);
        $this->assertInstanceOf('UTIL_ICAP_FIELD', $CategoryInfo->Fields['SubSubCategoryNo']);
    } 
```

创建的错误：

```
2) TEST_UTIL_CATEGORY_SCOPE::testICAPFieldTypes
Failed asserting that null is an instance of class "UTIL_ICAP_FIELD". 
```

我不知道如何继续，因为当我看到对象已创建时，这会导致错误，数组填充如我所料。我现在必须将这些测试标记为未完成，以允许我们的测试套件继续进行。

有没有人有任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T16:30:36.080

在对课程进行了深入检查后，我找到了解决方案。我试图访问的数组被定义为 PROTECTED，因此 PHPUnit 测试框架无法访问该值。

有两种解决方案可以解决这个问题。

1.  将数组声明为 PUBLIC 以使其可访问。

2.  在测试中使用反射使其仅可用于测试。

选项 2 是我们首选的解决方案，但出于项目的即时需求，以及其他更改的时间，暂时使用了选项 1 (PUBLIC)。

感谢那些帮助尝试解决我的问题的人。

# c# - RibbonCombobox 的清除值

> ID：13961012
> 
> 赞同：1
> 
> 时间：2012-12-19T20:54:46.163
> 
> 标签：c#, wpf, ribbon

我得到 2 RibbonCombobox，第一个*FiltreEtatPays*和第二个*FiltreEtatType*，第一个 RibbonCombobox 的选定值是第二个的驱动内容。所以我想在第一个 RibbonCombobox 的 selectedItem 更改时清除第二个 RibbonCombobox 的显示值。

我得到以下 xaml

```
<ribbon:RibbonComboBox x:Name="FiltreEtatPays" Label="Pays" Grid.Column="1" Grid.Row="0">
    <ribbon:RibbonGallery Name="GallEtatPays" SelectionChanged="GallEtatPays_SelectionChanged">
        <ribbon:RibbonGalleryCategory Name="GalEtatPays" ItemsSource="{Binding}"/>
    </ribbon:RibbonGallery>
</ribbon:RibbonComboBox>
<ribbon:RibbonComboBox x:Name="FiltreEtatType" Label="Type" Grid.Column="1" Grid.Row="1">
    <ribbon:RibbonGallery Name="GallEtatType">
        <ribbon:RibbonGalleryCategory Name="GalEtatType" ItemsSource="{Binding}"/>
    </ribbon:RibbonGallery>
</ribbon:RibbonComboBox> 
```

我试过这段代码，但显示的文本没有改变

```
FiltreEtatType.Text = "";
GallEtatType.SelectedItem = null; 
```

我能怎么做 ？

# asp.net - 如何使用 Web API 实现基于声明的身份验证？

> ID：13961018
> 
> 赞同：3
> 
> 时间：2012-12-19T20:55:06.587
> 
> 标签：asp.net, authentication, asp.net-web-api

我将在即将到来的项目中使用 Web API，并被要求将*现有的*STS 提供程序集成到等式中作为我的身份验证机制。因此，我的 Web API 将是 RP（依赖方）。我不需要任何支持来提供实际令牌（例如创建 STS 提供程序），只需将基于声明的身份验证合并到已配置的 STS 提供程序中，并在我的基于 Web API REST 的服务中使用它。

有谁知道这是否可能，以及如何实现这一点的一些例子？我看到了创建 STS 提供程序的完整示例，但就像我说的那样，它已经存在。我只需要信任它并用于身份验证。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T06:03:05.810

取决于您现有的 STS 支持哪些协议。你需要找出来。

基本上你需要这样做：

1.  从您的 STS 请求令牌（从您的客户端应用程序中）
2.  将令牌发送到 Web API
3.  验证 Web API 中的令牌

您需要了解的是 1\. 是否与您的自定义 STS 一起使用 - 那么我们可以讨论 2 和 3 ;)

# html - 使用 Visual Studio 2012 进行 HTML5 开发

> ID：13961022
> 
> 赞同：5
> 
> 时间：2012-12-19T20:55:31.793
> 
> 标签：html, visual-studio-2012

我是网络世界的新手，我被要求使用 Visual Studio 2012 开发一个 HTML5 网站。我有以下问题：

1.  有人可以给我一个关于如何设置 Visual Studio 2012 来创建 HTML5 应用程序的链接吗？我试图创建一个新项目，但根本没有找到 HTML5 应用程序的选项？

2.  有人可以推荐一个关于如何使用 Visual Studio 2012 开发 HTML5 网站的好的 youtube 页面或教程页面吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T21:38:58.943

HTML5 是 HTML 的较新版本，适用于支持构成它的功能的浏览器。您可能希望从阅读[HTML5 的 wiki 条目](http://en.wikipedia.org/wiki/HTML5)开始。

[W3C 本周早些时候（2012 年 12 月 17 日）完成了 HTML5](http://www.w3.org/News/2012#entry-9667)规范。

在关注 Visual Studio 2012 为开发 HTML5 Web 应用程序提供了哪些功能之前，我建议先了解[一下 HTML5 是什么](http://en.wikipedia.org/wiki/HTML5)、[它的工作原理](http://msdn.microsoft.com/en-us/magazine/hh335062.aspx)以及[哪些浏览器支持哪些功能](http://caniuse.com/)。

开始阅读的好地方是[Dive Into HTML5](http://diveintohtml5.info/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-04T20:12:58.270

你可以参考：[http ://docs.kendoui.c​​om/tutorials/ASP.NET/asp-net-hello-html5](http://docs.kendoui.com/tutorials/ASP.NET/asp-net-hello-html5)

如果你赶时间，可以直接跳到这个视频的第 6 分钟，直接回答这个问题。

# http - HTTP Keep-Alive 标头

> ID：13961024
> 
> 赞同：3
> 
> 时间：2012-12-19T20:55:36.727
> 
> 标签：http

HTTP/1.1 服务器默认使用 Connection 标头的 Keep-Alive 设置。为什么大多数浏览器即使知道目标服务器支持 HTTP/1.1，也会在其请求中包含 Connection: Keep-Alive？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T08:17:39.590

浏览器通常不会保留有关他们过去联系过的服务器的元数据缓存，即使他们这样做了，他们也必须考虑具有不同版本 HTTP 的服务器场、中介（尤其是“透明”代理） ) 等等。

因此，他们做出了一个判断，即始终发送 Connection: keep-alive 会更容易，至少在连接中的第一个请求上是这样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-12T02:51:45.840

这个问题没有意义。浏览器在提交请求并获得响应之前不知道服务器支持什么。

# android - 无法安装andgram（android instagram）

> ID：13961026
> 
> 赞同：1
> 
> 时间：2012-12-19T20:55:40.890
> 
> 标签：android, import

我正在尝试安装和测试[https://github.com/markchang/android-instagram.git上提供的 andgram 应用程序](https://github.com/markchang/android-instagram.git)

但是，一些布局文件显示以下消息并且 Eclipse 不生成 R.java 文件：

注意：这个项目包含资源错误，所以 aapt 没有成功，这可能会导致渲染失败。先解决资源问题。

无法解析资源 @style/ActionBar

我以为是SDK版本，但我安装了版本8并没有解决问题。

我将不胜感激任何帮助。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T21:10:15.397

您尝试使用的库取决于[android-actionbar](https://github.com/johannilsson/android-actionbar)库。您是否下载了该库并将其作为库项目添加到您的项目中？

编辑：

仅供参考，它所依赖的操作栏库已过时（2 年以上）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T20:58:05.237

您已将构建目标更改为至少 API 11 以支持 ActionBar。

# javascript - IFrame 未使用 mootools 加载

> ID：13961027
> 
> 赞同：1
> 
> 时间：2012-12-19T20:55:48.100
> 
> 标签：javascript, iframe, mootools

我试图在 IFrame 中加载 youtubevideo，但它不起作用。我在这里错过了什么吗？

```
addVideo.addEvent('click', function() {
link = ytlink.get('value');
src = new URI(link);
if(src.get('host') == 'www.youtube.com') {
    var videoFrame = new IFrame({
        url: 'http://'+src.get('host')+'/embed/'+src.get('data').v,
        styles: {
            width: 490,
            height: 276
        },
        events: {
            onLoad: function() {console.log('fertich');}
        }
    });
    container.grab(videoFrame);
} 
```

addVideo 是一个链接，直到现在我都幸运地使用了抓取方法。这里出了什么问题？什么都赞赏。

编辑：我希望 youtube 播放器显示在 IFrame 中，但那里没有任何内容（尽管 IFrame 元素被渲染到页面中）。即使我设置`url`为`http://www.google.com/`.

这是创建的 IFrame 元素：

```
<iframe url="http://www.google.de" style="width: 490px; height: 276px; " name="IFrame_haxso5aq" id="IFrame_haxso5aq"></iframe> 
```

干杯！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T10:55:14.673

是 iFrame 属性你不需要'src'而不是'url'吗？

```
var videoFrame = new IFrame({
    src: 'http://'+src.get('host')+'/embed/'+src.get('data').v,
    styles: {
        width: 490,
        height: 276
    },
    events: {
        onLoad: function() {console.log('fertich');}
    }
}); 
```

# javascript - 要求在新窗口中运行功能，但它仍然在父窗口上运行

> ID：13961029
> 
> 赞同：0
> 
> 时间：2012-12-19T20:55:53.590
> 
> 标签：javascript, popup, onload

我在javascript中定义了一个新窗口，如下所示：

```
var r = window.open("", "rgroup", "status=1,width=800,height=600"); 
```

我有一个打印某些输出的函数，我试图像这样运行它：

```
r.onload = runproduct(); 
```

但它仍然在主父窗口上运行。

我必须补充一点，我不是试图给出从父窗口运行的顺序，而是从第二个新窗口开始，所以为了简短起见，我有：

1）主窗口（功能出现在这里）

2）第二个窗口（我从这里下订单）

3）第三个窗口（这是我希望输出发生的地方）

容易修复吗？我在挠头，为什么下令在主窗口的第二个窗口上运行函数有效，但从第二个窗口下令到第三个窗口却没有......

感谢您的澄清！这有点令人困惑......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T21:01:16.450

函数在*创建*时包含变量上下文，而不是在运行时。即您`runproduct()`正在使用它创建上下文（主窗口）的变量范围链。无论何时运行，对全局变量或其他闭包变量的任何引用都将指向主窗口中的状态。

要解决此问题，您可以编写`runproduct()`函数以明确引用窗口引用。例如

```
var r;
function runproduct() {
  console.log(window); // refers to main window
  console.log(r); // refers to second window
}
r = window.open(...etc...); 
```

# python - 遍历字典时使用 keys() 函数的优点

> ID：13961030
> 
> 赞同：6
> 
> 时间：2012-12-19T20:55:55.197
> 
> 标签：python

使用 keys() 函数有什么好处吗？

```
for word in dictionary.keys():
    print word 
```

对比

```
for word in dictionary:
    print word 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-19T20:56:53.590

是的，在 Python 2.x 中，直接遍历字典可以节省一些内存，因为键列表不会重复。

您也可以使用`.iterkeys()`，或者在 Python 2.7 中，使用`.viewkeys()`.

在 Python 3.x 中，`.keys()`是一个视图，没有区别。

因此，总而言之：仅当您*需要*`d.keys()`密钥副本时才使用（或`list(d.keys())`在 python 3 中），例如当您在循环中更改 dict 时。否则直接迭代dict。

# php - 将原始图像数据转换为物理文件

> ID：13961031
> 
> 赞同：1
> 
> 时间：2012-12-19T20:56:03.263
> 
> 标签：php, image, image-processing, rets

我正在调用基于 RETS 的服务来收集有关房产列表的数据……当然，这方面的一个主要方面是获取照片。但是，照片的数据实际上是原始图像数据：

```
ÿØÿàJFIF``ÿá"ExifII*îhÿÛC       $.' ",#(7),01444'9=82<.342ÿÛC     2!!22222222222222222222222222222222222222222222222222ÿÀU"ÿÄ    ÿÄµ}!1AQa"q2‘¡#B±ÁRÑð$3br‚  %&'()*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyzƒ„…†‡ˆ‰Š’“”•–—˜™š¢£¤¥¦§¨©ª²³´µ¶·¸¹ºÂÃÄÅÆÇÈÉÊÒÓÔÕÖ×ØÙÚáâãäåæçèéêñòóôõö÷øùúÿÄ    ÿÄµw!1AQaq"2B‘¡±Á  #3RðbrÑ $4á%ñ&'()*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz‚ƒ„…†‡ˆ‰Š’“”•–—˜™š¢£¤¥¦§¨©ª²³´µ¶·¸¹ºÂÃÄÅÆÇÈÉÊÒÓÔÕÖ×ØÙÚâãäåæçèéêòóôõö÷øùúÿÚ?÷ú(¢€ (¢€ (¢€ (¢€ (¢€ (¢€ (¢€ (¢€ (¢€ (¢€ (¢€ 
```

等等等等等等……

如何转换/使用这些原始数据并将其转换为 Web 服务器上的物理文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T21:05:36.337

尝试简单地将这些原始数据写入文件。如果您确定文件格式始终为 JPG，则设置`.jpg`为扩展名。

如果没有，您可能想看看[这里](https://stackoverflow.com/a/134893/759049)- 这应该可以帮助您获得正确的文件格式，然后设置适当的文件扩展名。

**编辑**我不知道 RETS 协议，但它可能会返回图像的内容类型，这应该会进一步简化整个过程。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-04T21:26:32.357

您必须从 RETS 服务器解析 mime multipart 对象。您可以手动获取每一行并将其分块在 mime 分隔符字符串中，您还必须弄清楚它在标题中的位置。

如果您想节省时间，请查看[phrets 类](https://github.com/troydavisson/PHRETS)源代码（或直接使用它）。[https://github.com/troydavisson/PHRETS/blob/master/phrets.php#L141](https://github.com/troydavisson/PHRETS/blob/master/phrets.php#L141)

这里有一些例子， [https://github.com/troydavisson/PHRETS/wiki/GetObject](https://github.com/troydavisson/PHRETS/wiki/GetObject)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-30T21:28:25.177

此外，如果您在对给定列表的所有照片使用 GetObject 请求时在流中获得多个 jpeg，您可以拆分 ÿØÿà 字节 (\xff\xd8\xff\xe0) 并保存由拆分为 jpeg 文件，但您必须在每个 jpeg 的开头保留 ÿØÿà，因此您需要在拆分后在每个块的开头重新插入它们。我也从“类似 RETS”的服务中遇到了这个问题，并且不得不手动将下标（_1、_2 等）添加到拆分产生的 jpeg 文件名中。它最终是这样的：

```
if response.find('\xff\xd8\xff\xe0') > -1:
    blist = response.split('\xff\xd8\xff\xe0')
    blist.remove("")  /* get rid of any empty list elements resulting from split */
    index = 1
    for img in blist:
        file_nm = os.path.join(photo_dir, "{0}_{1}.jpg".format(photo_id, index))
        with open(photo_file_nm, "wb") as photo_file:
            photo_file.write('\xff\xd8\xff\xe0' + img)
        index += 1 
```

...其中 photo_dir 和 photo_id 在此块之外定义。这个例子是 python，但可以很容易地转换为 php。

# javascript - 如何在Javascript中的子类中重载父类的方法？

> ID：13961032
> 
> 赞同：1
> 
> 时间：2012-12-19T20:56:06.307
> 
> 标签：javascript, oop, inheritance

我正在尝试编写一个从父类扩展的javascript类，重载一个方法并稍微更改它。

例如，它检查一些变量，如果它们被设置为真，那么它在父节点上执行相同的方法，否则它执行一些不同的代码。

这就是我想出的：

```
function Dad(name)    
{
    this.yell = function()
    {
        console.log( 'GRRRRRRR ' + name);
    }
}

function Kid(name, age)    
{
    var parent = new Dad(name);

    parent.yell = function()
    {
        if (age < 15)
            console.log( 'BAAAAA ' + name );
        else
            parent.yell(); //This is the problem line, how to call this method on
                           //parent object
    }
    return parent;
}

var k = new Kid('bob', 13);
k.yell(); 
```

但是问题是，如何调用父对象的方法。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T21:03:15.983

使用原型。它们允许您访问超类的方法，但无需实例化它。

然后，从子类，你可以做`SuperClass.prototype.instanceMethod.call(this)`，基本上`super`是大多数典型的OO语言，但是JS并不能帮助你弄清楚超类是什么。所以你必须自己跟踪它。

```
// Superclass
function Dad() {};
Dad.prototype.yell = function() {
    console.log("Do your homework!");
}

// Subclass
function Kid(age) {
    // calls the constructor of the superclass.
    // in this case, the Dad() constructor does nothing, so it's not required here.
    Dad.call(this);

    // save constructor argument into this instance.
    this.age = age;
};

// Inheritance happens here, prototype is an instance of superclass
Kid.prototype = new Dad();

// Make sure the constructor is properly assigned.
Kid.prototype.constructor = Kid;

// Override an instance method.
Kid.prototype.yell = function() {
    if (this.age < 18) {
        console.log('Waaaaa, I hate homework');
    } else {
        // calls the yell method of the superclass
        Dad.prototype.yell.call(this);
    }
}

// make a kid.
var k = new Kid(13);
k.yell(); // 'Waaaaa, I hate homework' 

// make an old kid.
var k = new Kid(30);
k.yell(); // 'Do your homework!' 
```

JS 中的 OO 继承可能很混乱，但有一些东西可以提供帮助。

*   [对象.create](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/create)
*   [Resig 的简单 javaScript 继承](http://ejohn.org/blog/simple-javascript-inheritance/)
*   [咖啡脚本类](http://coffeescript.org/#classes)

仅举几例。

# javascript - 有没有办法检测从重定向的 img src 加载什么类型的图像？

> ID：13961034
> 
> 赞同：0
> 
> 时间：2012-12-19T20:56:10.610
> 
> 标签：javascript, facebook, mime-types

我正在使用这个 facebook 服务返回个人资料图片。

`<img src="http://graph.facebook.com/username/picture">`

如果 fb 用户未设置个人资料图片，则服务将重定向到此 facebook 匿名人物图像：`http://static.ak.fbcdn.net/rsrc.php/v2/yo/r/UlIqmHJn-SK.gif`. 我想避免展示这些。

有没有办法使用 javascript 来检测返回的图像是否为`http://static.ak.fbcdn.net/rsrc.php/v2/yo/r/UlIqmHJn-SK.gif`. 该地址来自 CDN，所以我想知道我们是否可以检查文件大小是否为 <= 390B 并且 mime-type 是 image/gif？

编辑：不幸的是，仅涉及现代浏览器（HTML5 和画布）的解决方案可能对我不起作用，因为要求是我们仍然需要支持回 ie7。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T21:11:37.450

是的，您可以简单地使用 AJAX 提出请求并自己解析 MIME 类型。事实上，Facebook 包含这个标题：

```
访问控制允许来源：*

```

这授权了现在大多数浏览器都支持的[CORS](http://caniuse.com/#feat=cors)（跨源资源共享）。

如果您绝对必须支持旧浏览器，请查看 Open Graph 文档：

[https://developers.facebook.com/docs/reference/api/using-pictures/](https://developers.facebook.com/docs/reference/api/using-pictures/)

您可以使用 JSONP 获取其元数据，而不是直接获取图片。这应该在 IE7 中工作：

```
函数 checkPictureUrl(用户名, cb) {
  $.ajax({
    url: 'http://graph.facebook.com/' + 用户名 + '/picture?redirect=false',
    数据类型：'jsonp'，
    成功：函数（json）{
      // 用户只有一张默认头像
      如果（json.data.is_silhouette）
        返回 cb(null);
      别的
        返回 cb(null, json.data.url);
    },
    错误：函数（错误）{
      CB（错误）；
    }
  });
}

```

# c++ - 委托构造函数 C++

> ID：13961037
> 
> 赞同：55
> 
> 时间：2012-12-19T20:56:14.833
> 
> 标签：c++, c++11

我这样做对吗？我正在尝试委托一个 C++ 类构造函数，因为它基本上是相同的代码重复 3 次。我阅读了 C++x11 并读到 g++ 4.7.2 允许这样做，但我不确定我是否正在这样做对：

```
Bitmap::Bitmap(HBITMAP Bmp)
{
   //Construct some bitmap stuff..
}

Bitmap::Bitmap(WORD ResourceID)
{
   HBITMAP BMP = (HBITMAP)LoadImage(GetModuleHandle(NULL), MAKEINTRESOURCE(ResourceID), IMAGE_BITMAP, 0, 0, LR_SHARED);

   Bitmap(BMP);   //Delegates to the above constructor? Or does this create a temporary?
} 
```

或者我需要做什么：

```
Bitmap::Bitmap(HBITMAP Bmp)
{
   //Construct some bitmap stuff..
}

Bitmap::Bitmap(WORD ResourceID) : Bitmap((HBITMAP)LoadImage(GetModuleHandle(NULL), MAKEINTRESOURCE(ResourceID), IMAGE_BITMAP, 0, 0, LR_SHARED))
{
} 
```

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-12-19T20:59:05.540

你需要做第二个。委托构造函数只在构造函数的初始化列表中起作用，否则你只会创建一个临时的或像你提到的那样做其他错误。

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2012-12-19T20:59:24.310

正确的语法是

```
struct Foo {
  Foo(char x, int y) : _x{x}, _y(y) {}
  Foo(int y) : Foo('a', y) {}

  char _x;
  int _y;
}; 
```

您的第一个示例创建了一个立即销毁的临时对象。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-08-18T20:18:56.090

如果您想在一些命令式逻辑之后使用构造函数委托，您可以选择`*this`从临时移动分配：

```
Foo() {
  // calculate stuff…
  *this = Foo(stuff, calculated, above);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-10-28T08:01:37.743

第二个使用初始化列表的例子是正确的。第一个示例将最终创建一个临时对象。

# php - 网页实现excel另存为的最佳方法

> ID：13961039
> 
> 赞同：2
> 
> 时间：2012-12-19T20:56:15.870
> 
> 标签：php, excel, web

什么被认为是允许用户通过单击“另存为”来保存表数据的最佳编码方式

**这是场景**

我创建了一个网页，列出了来自 mysql db 的数据（在 php 中创建的应用程序）。

该页面列出了数据并提供了“另存为”按钮，因此可以将数据保存到用户本地计算机（csv、xml 等）。

**技术的**

以下是执行此操作的最佳方法1）将数据保存到查询该mysql db的同一php程序中的文件中吗？2）当用户点击网页上的“另存为”时，ajax将数据从＃1（服务器）流式传输到用户本地计算机

我已经阅读了一些关于如何创建 xml 数据（opendocument、openxml）和 php excel/xml 库的内容，但只是不完全理解流程；是否应该在查询时创建文件，数据如何到达用户本地计算机等。或者是否有不同的方法来做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T21:07:52.823

主要有两种方法：

*   在服务器上生成文件。当第一个用户点击下载链接或每次有人下载文件时，您可以先执行此操作。您可以通过提供一个下载链接来做到这一点，该下载链接由您的 Web 服务器或 Web 框架解释为*文件*的位置，例如

    > [http://example.org/uploads/file1.csv](http://example.org/uploads/file1.csv)

    或者您为下载编写自定义操作/页面，例如：

    > [http://example.org/download.php?filename=file1.csv](http://example.org/download.php?filename=file1.csv)（[如何在 PHP 中制作下载链接](https://stackoverflow.com/questions/1218277/how-to-make-a-download-link-in-php)）

*   生成一个 HTTP 响应，客户端（浏览器）将其解释为下载。您不需要将额外的文件写入磁盘，但它对文件类型最有用，您可以在程序中轻松生成这些文件类型，例如 CSV 文件的行等。这是 CSV 文件的示例： http: [//code.stephenmorley.org/php/creating-downloadable-csv-files/](http://code.stephenmorley.org/php/creating-downloadable-csv-files/)

无论如何，浏览器都知道，它处理文件下载而不是处理另一个网页是通过 HTTP 标头：

```
// specify the MIME-type 
// (e.g. if it's an image or PDF most browser can display the content directly)
header('Content-Type: text/csv; charset=utf-8');

// The Content-Disposition response-header field has been proposed 
// as a means for the origin server to suggest a default filename 
// if the user requests that the content is saved to a file.
header('Content-Disposition: attachment; filename=data.csv'); 
```

您可以在此处阅读更多相关信息：http: [//www.w3.org/Protocols/rfc2616/rfc2616-sec19.html](http://www.w3.org/Protocols/rfc2616/rfc2616-sec19.html)

最后，这完全取决于您和您的要求。它是一个低流量站点并且文件很小吗？- 预先生成文件，让网络服务器处理下载链接。它是一个有很多小文件的高流量网站吗？- 可能会即时生成它（如在 CSV 示例中）。不是每个人都应该能够下载每个文件并且身份验证由您的 php 项目管理？- 使用自定义 download.php 脚本检查权限会更容易。

# javascript - JavaScript 可能会干扰 CSS 3 级导航系统

> ID：13961045
> 
> 赞同：0
> 
> 时间：2012-12-19T20:56:40.537
> 
> 标签：javascript, jquery, css

这个小提琴有效（见`We Distribute`产品下）：

[http://jsfiddle.net/dgUFw/1362/](http://jsfiddle.net/dgUFw/1362/)

但是在我正在构建的网站上下文中的页面上，我运行了 JavaScript（包括 jQuery）。例如，主页上有一个幻灯片，当我将鼠标悬停在小提琴导航的第 3 级时，它会在一两秒后消失。另外，还有其他一些我无法解释的奇怪行为，比如第 3 级`li`移动到第 2 级列表的顶部，等等，这在小提琴中不会发生。

我对将 CSS 和 JavaScript 集成在一起还比较陌生，所以我还没有看到这种行为。

当我在 Firefox 中关闭 JavaScript 时，这种行为似乎平息了。

是什么原因造成的，我该如何解决？我也尝试了不同的 JS 库和 CSS 规范化`jsfiddle.net`，结果是一样的。我还尝试了 Opera 的小提琴结果相同但网站结果更差。Chrome 似乎更健壮，更不容易出现行为不端。

您可能还注意到，在第 3 级内部时，第 2 级`We Distribute`文本是黑色的。我也很难让它保持白色。但这不是我的主要问题。我对 JavaScript/CSS 交互最感兴趣。

**编辑说明**

我从下面接受了一些建议并对此进行了更多测试：

我对小提琴进行了更多测试：http: [//jsfiddle.net/nicorellius/dgUFw/1368/](http://jsfiddle.net/nicorellius/dgUFw/1368/) 我发现如果您单击“我们分发”，菜单会自行折叠。这实际上与我在网站上看到的行为相似，除了在没有点击的情况下发生崩溃。单击菜单并折叠后，悬停不会使其恢复正常，我希望它会。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T21:09:42.043

两件事情：

首先，我认为您的菜单消失问题是由于 z-index。幻灯片可能具有更高或相同的 z-index，导致菜单失去悬停状态。要解决这个问题：

```
#nav-top li, #nav-top li a {
    z-index: 1000;
} 
```

其次，对于您的颜色/悬停问题，您需要稍微更改一下 CSS：

```
#nav-top li a:hover {
    color: #fff;
}

#nav-top li#products-sub:hover > a, #nav-top li#home-sub:hover > a,
#nav-top li#faq-sub:hover > a, #nav-top li#user-sub:hover > a, #nav-top li ul.dist-sub:hover  {
    color: #fff;
} 
```

这将保持 li 的悬停状态并基于该状态而不是链接设置链接的颜色。

摆弄更改：http: [//jsfiddle.net/dgUFw/1364/](http://jsfiddle.net/dgUFw/1364/)

# c# - 我的游戏如何在开始屏幕上有一个宽图标？

> ID：13961048
> 
> 赞同：6
> 
> 时间：2012-12-19T20:56:47.230
> 
> 标签：c#, xna, windows-phone-8

我正在为 WP8 创建游戏，但它在 XNA 中。我怎样才能让它在开始屏幕上有一个宽图标？默认只支持 small 和 normal

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-19T21:22:46.657

由于 XNA 仅支持 WP7 应用程序，因此您必须检查您的应用程序是否在 WP8 上运行，如果是，则使用反射将磁贴更新为 WP8 图标。[在这篇 MSDN 文章@将 Windows Phone 8 Tile 功能添加到 Windows Phone OS 7.1 应用程序](http://msdn.microsoft.com/en-us/library/windowsphone/develop/jj720574%28v=vs.105%29.aspx)中有一个很好的示例来说明该代码片段的外观

[使用Mangopollo](http://mangopollo.codeplex.com/)库可能更容易，它内置了与 WP8 类似的 API 的功能。这是包装要从 WP7 调用的 WP8 API 的源代码 @ [http://mangopollo.codeplex.com/SourceControl/changeset/view/100687#2023247](http://mangopollo.codeplex.com/SourceControl/changeset/view/100687#2023247)

这是在 WP7 应用程序中使用 WP8 宽磁贴的[Mangopollo](http://mangopollo.codeplex.com/)代码片段：

```
if (!Utils.CanUseLiveTiles)
{
    MessageBox.Show("This feature needs Windows Phone 8");
    return;
}

try
{
    var mytile = new FlipTileData
    {
        Title = "wide flip tile",
        BackTitle = "created by",
        BackContent = "Rudy Huyn",
        Count = 9,
        SmallBackgroundImage = new Uri("/Assets/logo159x159.png", UriKind.Relative),
        BackgroundImage = new Uri("/Assets/Background336x336_1.png", UriKind.Relative),
        BackBackgroundImage = new Uri("/Assets/Background336x336_2.png", UriKind.Relative),
        WideBackContent = "This is a very long long text to demonstrate the back content of a wide flip tile",
        WideBackgroundImage = new Uri("/Assets/Background691x336_1.png", UriKind.Relative),
        WideBackBackgroundImage = new Uri("/Assets/Background691x336_2.png", UriKind.Relative)
    };

#if ALTERNATIVE_SOLUTION
  var mytile = Mangopollo.Tiles.TilesCreator.CreateFlipTile("flip tile",
    "created by", "Rudy Huyn",
    "This is a very long long text to demonstrate the back content of a wide flip tile",
    9, new Uri("/Assets/logo159x159.png", UriKind.Relative),
    new Uri("/Assets/Background336x336_1.png", UriKind.Relative),
    new Uri("/Assets/Background336x336_2.png", UriKind.Relative),
    new Uri("/Assets/Background691x336_1.png", UriKind.Relative),
    new Uri("/Assets/Background691x336_2.png", UriKind.Relative));
#endif
    ShellTileExt.Create(new Uri("/MainPage.xaml?msg=from%20wipe%20flip%20tile",
      UriKind.Relative), mytile, true);
}
catch
{
    MessageBox.Show("remove tile before create it again");
} 
```

要记住的另一件事是，即使 XNA 应用程序是 WP7 应用程序，也可以直接从 XNA 使用其他 WP8 API。这是一个关于如何在 WP7 应用程序（包括 XNA）[上使用 WP8 应用程序内购买的示例。](http://code.msdn.microsoft.com/WP8-Store-Wrapper-for-IAP-74f77f17)这是一个关于[如何在 WP7 应用程序中使用新的 WP8 启动器和选择器](http://mangopollo.codeplex.com/SourceControl/changeset/view/100687#2023155)的示例（向下滚动）。

# android - Android 是否会为 NDK/C++ 崩溃发送崩溃报告（在 Google Play 中）？

> ID：13961053
> 
> 赞同：3
> 
> 时间：2012-12-19T20:57:01.313
> 
> 标签：android, android-ndk

我的印象是，NDK 端的崩溃不会为用户打开“报告崩溃”视图，应用程序只是被默默地杀死。谁能证实这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T21:36:55.897

现有的 NDK 没有，但谷歌 breakpad 有一个[用于原生 Android](http://code.google.com/p/google-breakpad/source/browse/trunk/README.ANDROID)代码的自定义报告器，这可能会有所帮助。

# java - 调用返回相同类型的变量和类型本身的相同名称的静态方法时，“变量 xxx 可能尚未初始化”

> ID：13961056
> 
> 赞同：3
> 
> 时间：2012-12-19T20:57:10.620
> 
> 标签：java, jls

为什么它会失败并出现如下所示的错误？我不确定在 JLS 中的哪个位置寻找限制来做这样的事情。

```
public class A {

    static A foo() {
        return null;
    }

    public static void main(String[] args) {
        A A = A.foo();
    }
} 
```

编译时出错

```
A.java:14: error: variable A might not have been initialized
        A A = A.foo();
              ^
1 error 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-19T20:59:56.290

该变量隐藏了同名的类。这就是为什么会有[命名约定](http://www.oracle.com/technetwork/java/javase/documentation/codeconvtoc-136057.html)的部分原因。

* * *

正如 Patricia 在评论中指出的那样，这实际上在 JLS 中被称为[obscuring](http://docs.oracle.com/javase/specs/jls/se7/html/jls-6.html#jls-6.4.2)：

> 在这些情况下，[§6.5](http://docs.oracle.com/javase/specs/jls/se7/html/jls-6.html#jls-6.5)的规则指定将优先选择变量而不是类型，并且将优先选择类型而不是包。

* * *

在您的情况下，您会收到编译错误，因为变量隐藏了类型，因为声明是在方法调用之前处理的。这与执行以下操作相同：

```
public class A {
    public void foo() {
        String s = s.substring(0, s.length());
    }
} 
```

你会得到同样的错误：

```
A.java:3：变量 s 可能尚未初始化
        字符串 s = s.substring(0, s.length());
                   ^
1 个错误

```

在评论中，你说你没有找到 JLS 说你的建筑是非法的。它本身并不违法，由于模糊不清的结果是。考虑有 2 个类的情况，由于模糊，您也可能会收到不需要的呼叫，这不是非法的，只是令人困惑：

```
public class A {
    public void foo() {
        System.out.println("A.foo()");
    }

    public static void main(String[] args) {
        A B = new A();
        B.foo();
    }

    public static class B {
        public static void foo() {
            System.out.println("B.foo()");
        }
    }
} 
```

你认为输出是什么？

```
$ javac A.java
$java A
A.foo()

```

# c# - 在 SQLite 中的表中添加时间戳字段

> ID：13961057
> 
> 赞同：2
> 
> 时间：2012-12-19T20:57:11.073
> 
> 标签：c#, sql, database, timestamp

我正在修改一些 c# 代码并尝试在创建数据库时将日期+时间字段添加到数据库中。什么是这样做的好方法？我是 SQL 和数据库的新手，因此也很感谢您向我指出有用的资源。

我相信我想要类似的东西：

```
createCommand.CommandText = "CREATE TABLE Table1 ( field1 INTEGER, field2 BLOB, timestamp datatype);" 
```

我不确定时间和日期标记使用什么数据类型。我应该使用文本并采用“12/19/2012, 16:20”的形式吗？我在这里先向您的帮助表示感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T21:02:16.517

如果要使用字符串类型，则应使用按字母顺序按时间排序的格式。SQLite 的内置函数支持 ISO 8601 字符串 (YYYY-MM-DD HH:MM:SS.SSS) 以及儒略日数和 Unix 风格的整数时间戳。

请参阅：[http](http://www.sqlite.org/datatype3.html#datetime) ://www.sqlite.org/datatype3.html#datetime和[http://www.sqlite.org/lang_datefunc.html](http://www.sqlite.org/lang_datefunc.html)

# javascript - 加载每个部分内容后的 InfiniteScroll 回调

> ID：13961061
> 
> 赞同：0
> 
> 时间：2012-12-19T20:57:28.743
> 
> 标签：javascript, jquery, mediaelement.js, infinite-scroll

我有一个网页，上面有大约 50 个音频播放器。我想使用 InfiniteScroll 在用户滚动时一次只加载大约 10 个玩家。我遇到的问题是我正在使用一个`audio`名为 MediaElement.js 的 HTML5 插件，并且该插件不会应用于加载到我的页面中的新播放器。我正在寻找的是一种在每个内容部分加载后进行回调的方法，以便我可以再次初始化 MediaElement.js，以便将其应用于所有新加载的音频元素。

我已经尝试使用 InfiniteScroll 的以下选项来完成这项工作，但它似乎只在我第一次加载页面时加载..而不是在每个内容部分加载到页面中时加载。

```
// Just a testing function
function test() {
    console.log("test");
}

// snippet of the finished option for InfiniteScroll..
loading: {
  finished: test()
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-20T19:01:08.357

您需要发送不带括号的函数引用

```
// Just a testing function
function test() {
    console.log("test");
}

// snippet of the finished option for InfiniteScroll..
loading: {
  finished: test
} 
```

# html - 用图案或图像填充边框？

> ID：13961065
> 
> 赞同：6
> 
> 时间：2012-12-19T20:57:41.153
> 
> 标签：html, css, border, image

我有一个按类别分隔的企业列表。在每个类别名称旁边，从大约 20px 开始，我希望有一个 3px 高的边框延伸到 div 的末尾。我希望该边框填充图案或图像。最初，我尝试只使用图像，但由于每个类别名称的长度不同，这被证明是不切实际的。

我确信有一个相对简单的方法可以解决这个问题，我只是不确定如何实现它。想法？

谢谢。

![理想的](../Images/8f8704eb2832f2f7810f2a9c6a4ea9b6.png)

更新的图像 ![在此处输入图像描述](../Images/a5243edcaee70189febef6e0e2dde515.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T21:51:25.530

在这里，我使用 a来显示*类别*`<div>`后面的边框，其中和具有匹配的背景图案（也排成一行）`<h1>` *`<body>``<h1>`*

 *[示例 jsfiddle](http://jsfiddle.net/Xc3y5/2/)

CSS

```
body {
    background:url('http://subtlepatterns.subtlepatterns.netdna-cdn.com/patterns/gray_jean.png');
    font-family:helvetica,arial,sans-serif;
}

#container {
    margin:0 20px;
    position:relative;
}

h1 {
    position:relative;
    float:left;
    padding-top:6px;
    padding-right:20px;
    font-size:2em;
    background:url('http://subtlepatterns.subtlepatterns.netdna-cdn.com/patterns/gray_jean.png')
}

.border {
    background:url('http://s3.amazonaws.com/creattica/uploaded-images/0016/6142/patterns_009_blue-hexagon-pattern_crop-iphone_web_for-creattica.jpg') repeat-x -10px 0;
    position:absolute;
    top:20px;
    width:100%;
    height:3px;
}

.listings {
    clear:both;
}
​ 
```

HTML

```
<div id="container">
    <div class="border"></div>
    <h1>Catering</h1>
    <div class="listings">
        <ul>
            <li>
                Catering Company 1
            </li>
            <li>
                ...
            </li>
        </ul>
    </div>
</div>​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T22:03:05.793

如果允许附加标记（并且您的父元素具有纯色背景），您可以这样做：

```
h1 {
    background: red; /* replace with background-image */
}

h1 span {
    background: white; /* replace with color of parent element's bg */
}

<h1><span>Test Headline</span></h1> 
```

[http://jsfiddle.net/358Gg/](http://jsfiddle.net/358Gg/)*

# spring - Websphere、Spring、Hibernate、JAX-WS 全局事务

> ID：13961066
> 
> 赞同：1
> 
> 时间：2012-12-19T20:57:41.010
> 
> 标签：spring, hibernate, jax-ws, websphere-7

我正在尝试编写参与全局事务的 JAX-WS 服务的演示。随着时间的推移，我的组织将更多地采用这种模式，我们需要弄清楚它，但我正在苦苦挣扎。

我有一个从客户端调用的 WSDL 服务（它也在一个具有相同配置的 Java EE servlet 中......实际上它是同一个服务器，但我可以看到它正在通过网络向自身调用）。两者都在更新他们的行，然后我抛出一个异常，但服务不会回滚。

我用@Transactional(propagation=Propagation.REQUIRED) 注释了一个调用本地DAO 更新和WSDL 服务客户端的方法。该服务反过来调用另一个方法，也以相同的方式注释，该方法又调用一个 dao 方法来执行另一个数据库更新。

应用程序配置.xml：

```
<jee:jndi-lookup id="wsdlDataSource" jndi-name="${es.ds.jndi}" />
<bean id="wsdlSessionFactory" class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean">
    <property name="dataSource" ref="wsdlDataSource" />
    <property name="packagesToScan" value="com.wsdl" />
    <property name="hibernateProperties">
        <props>
            <prop key="hibernate.dialect">org.hibernate.dialect.DB2Dialect</prop>
            <prop key="hibernate.connection.driver_class">com.ibm.db2.jcc.DB2Driver</prop>
            <prop key="hibernate.bytecode.provider">javassist</prop>
            <prop key="hibernate.show_sql">false</prop>
            <prop key="hibernate.cache.use_second_level_cache">false</prop>
            <prop key="hibernate.default_schema">k702prdr</prop>
            <prop key="hibernate.transaction.factory_class">org.hibernate.transaction.JTATransactionFactory</prop>
            <prop key="hibernate.transaction.manager_lookup_class">org.hibernate.transaction.WebSphereExtendedJTATransactionLookup</prop>
            <prop key="jta.UserTransaction">java:comp/UserTransaction</prop>
        </props>
    </property>
    <property name="annotatedClasses">
        <list>
            <value>com.wsdl.db.DBTrans</value>
            <value>com.wsdl.db.UsrTrans</value>
        </list>
    </property>
</bean>
<!-- END Data sources  -->

<!-- BEGIN Hibernate config and dependencies -->
<bean id="transactionManager"
    class="org.springframework.transaction.jta.WebSphereUowTransactionManager" >
</bean>
<tx:annotation-driven transaction-manager="transactionManager"
    proxy-target-class="true" /> 
```

我遵循了一些教程，这些教程让我进入服务视图并添加客户端和服务的 WSTRansaction 策略集和绑定（最初都是从 RAD 向导生成的），然后再次进入管理控制台应用程序->应用程序类型-> Websphere 企业应用程序->我的应用程序->服务提供者/客户端策略集和绑定。在那里，我在父应用程序级别分别将 WSTransaction 添加到客户端和服务（策略继承到端点）。

但归根结底，没有发生回滚。帮助！我错过了什么？我配置错了什么？

（更新） - 我找到了如何在管理控制台中打开 websphere 事务跟踪日志。它说（为简洁而编辑）：

```
No transaction context found
Exit
Entry parm0=Operation: isAlive
No transaction context from incoming request
getTransactionManager parm0=com.ibm.ws.tx.jta.TranManagerSet@306e306e 
```

这些消息伴随着一堆似乎是对物体的检查，而且它们重复了很多次。好的，所以我似乎没有从我的客户发送事务上下文。但我还是不明白为什么。任何人？

（更新 2） - 我发现我的服务和客户端的 WSTRansaction 策略集未设置为共享，因此我将其设置为通过 wsdl 共享，现在跟踪日志似乎表明它正在查找事务上下文。 .或者至少，它不再明确地说它不能像上面那样。它在说一些类似以下的东西，可能或可能不是我认为的意思（再次，为简洁起见，如果您没有看到有意义的东西，请告诉我，那里有更多信息）：

```
Entry parm0=XATransactionWrapper@ 5f175f17  XAResource: com.ibm.ws.rsadapter.spi.WSRdbXaResourceImpl@5b7d5b7d  enlisted: falseHas Tran Rolled Back = false  mcWrapper.hashCode()490085686 parm1=XARESOURCE_NOTASSOCIATED
xa_start with flag: 0=TMNOFLAGS
setResourceStatus parm0=from NONE to REGISTERED
[at this point I see a log stmt that indicates my first update in the service]
setResourceStatus parm0=from REGISTERED to COMPLETING_ONE_PHASE
**setResourceStatus parm0=from COMPLETING_ONE_PHASE to COMMITTED**
setResourceStatus parm0=from NONE to REGISTERED
[at this point I see a log stmt that indicates my second update, which is done in the client]
setResourceStatus parm0=from REGISTERED to COMPLETING
setResourceStatus parm0=from COMPLETING to ROLLEDBACK
[at this point I see the stack trace of the hardcoded exception I am throwing] 
```

所以看起来很清楚，虽然事务管理器现在看到了客户端和服务事务，但它认为应该在服务端完成该部分后立即完成事务，而没有意识到它应该继续。我猜我不知何故触发了过早的提交。想法？

# php - 将数据存储在 html 元素中

> ID：13961068
> 
> 赞同：-1
> 
> 时间：2012-12-19T20:57:57.017
> 
> 标签：php, javascript, encoding

我有使用 PHP 生成的动态内容，我想在`data`属性中存储一些不同的文本。但是问题是我需要转义可能损坏整个 html 的各种字符

因此，当我想使用该数据时，我需要使用 php 进行某种编码，然后使用 javascript 解码该字符串，最好的方法是什么？

为了澄清我不想使用任何输入或类似的东西，我需要将这些数据存储在各种元素中，例如`a`等等`div`......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T21:00:51.693

如果您只想将一些数据传递给 JavaScript，为什么不[直接将其写入变量](https://stackoverflow.com/a/169035/212555)：

```
<html>
<head>
<script>
var data = <?php echo json_encode($data); ?>
</script>
<!-- etc. --> 
```

* * *

无论如何，如果您想按照自己的方式进行操作，可以[`htmlspecialchars`](http://php.net/manual/en/function.htmlspecialchars.php)在将任意数据放入 HTML 属性之前对其进行转义：

```
<div data="<?php echo htmlspecialchars('"\'!)(@UI#_!)(@JP_!()@J'); ?>">Example</div> 
```

如果你用 JavaScript 阅读它，它应该理解 HTML 编码，所以你不需要做任何特别的事情来阅读它。

如果您的数据更复杂，但不是二进制，您可以对其[进行 JSON 编码](http://php.net/manual/en/function.json-encode.php)，然后使用`htmlspecialchars`：

```
<?php
$data = array();
$data["a"] = 123;
$data["b"] = "example";
$jsonData = json_encode($data);
$escapedJsonData = htmlspecialchars($jsonData);
echo "<div data=\"$escapedJsonData\">example</div>";
?> 
```

然后，您可以使用[JSON.parse](https://developer.mozilla.org/en-US/docs/Using_native_JSON)在 JavaScript 中读取该数据：

```
var yourDiv = getDivSomehow();
var data = JSON.parse(yourDiv.getAttribute("data")); 
```

如果您的数据是二进制的，您可以[对其进行 base64 编码](http://php.net/manual/en/function.base64-encode.php)：

```
<?php
$data = someImage();
$encodedData = base64_encode($data);
echo "<div data=\"$encodedData\">example</div>";
?> 
```

大概有一些方法可以在 JavaScript 中对此进行解码。

# ios - NSDecimalNumber 和

> ID：13961073
> 
> 赞同：3
> 
> 时间：2012-12-19T20:58:05.893
> 
> 标签：ios, core-data, sum, key-value-coding, nsdecimalnumber

在我的 ios 项目中，我使用了两个实体（**CoreData**）：Person 和 Gifts with To-Many 关系

我知道如何计算给一个人的礼物总和：

```
NSDecimalNumber *orderSum=[person.gifts valueForKeyPath:@"@sum.priceOfGift"]; 
```

但是我如何计算所有人的总和？

```
 -(NSFetchedResultsController *) fetchedResultsController {
if (_fetchedResultsController != nil) {
    return _fetchedResultsController;
}
//NSError *error = nil;
NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
NSEntityDescription *entity = [NSEntityDescription entityForName:@"Person"
                                          inManagedObjectContext:[self managedObjectContext]];
[fetchRequest setEntity:entity];

NSSortDescriptor *sortDescriptor = [[NSSortDescriptor alloc] initWithKey:@"nameOfPerson"
                                                               ascending:YES];
NSArray *sortDescriptors = [[NSArray alloc] initWithObjects:sortDescriptor, nil];
[fetchRequest setSortDescriptors:sortDescriptors];

_fetchedResultsController = [[NSFetchedResultsController alloc]initWithFetchRequest:fetchRequest managedObjectContext:self.managedObjectContext sectionNameKeyPath:@"nameOfGroup" cacheName:nil];

_fetchedResultsController.delegate = self;

return _fetchedResultsController; 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T10:34:25.073

“所有人的总和”将是获取所有人并计算他们

```
int sum = fetchedObjects.count; 
```

但也许你的意思是“所有人所有礼物的价格总和”。仔细一想，这和所有礼物的价格总和是一样的。因此，您可以只取礼物并计算

```
NSNumber *sum = [self.fetchedResultsController.fetchedObjects 
      valueForKeyPath:@"@sum.priceOfGift"]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T21:50:16.797

您可以尝试获取所有人员，然后使用总和

```
 NSError *error = nil;
    NSFetchRequest *request = [[NSFetchRequest alloc] init];
    request.entity = [NSEntityDescription entityForName:@"Person" inManagedObjectContext:managedObjectContext];
    request.predicate = nil;
    request.sortDescriptors = [NSArray arrayWithObject:[NSSortDescriptor sortDescriptorWithKey:@"index" ascending:YES]];//some parameter
    NSArray *persons =  [managedObjectContext executeFetchRequest:request error:&error];
 NSDecimalNumber *orderSum;
 for (Person *person in persons)
  orderSum = [NSDecimalNumber decimalNumberWithDecimal:orderSum.decimalValue
+[person valueForKeyPath:@"gifts.@sum.priceOfGift"].decimalValue] 
```

不过，现在使用 NSDecimalNumber 看起来有点不舒服。

# ember.js - 使用 ember 视图助手或条件插座使用绑定控制器

> ID：13961080
> 
> 赞同：1
> 
> 时间：2012-12-19T20:58:30.470
> 
> 标签：ember.js

在余烬视图中，我正在尝试完成类似的事情：

```
{{#if loggedIn}}
   <p> I'm Logged In! </p>
{{else}}
   {{view App.LoginView contentBinding="App.UserInfo"}}
{{/if}} 
```

这不是开箱即用的，因为 LoginView 的上下文应该是 loginController，并且 *那个控制器的内容”应该是 App.UserInfo。

这个讨论有一些相关的注释，并建议了出口：

[使用 {{view}} 帮助器实例化控制器类？](https://stackoverflow.com/questions/13221813/instantiate-a-controller-class-using-the-view-helper)

奥特莱斯为此提供了一个干净的解决方案 - 例如，我可以这样做：

```
{{#if loggedIn}}
   <p> I'm Logged In! </p>
{{else}}
   {{outlet login}}
{{/if}} 
```

然后让路由器将此视图的控制器（称为 homeController）连接到带有 LoginView 和一些上下文的登录出口。

但是，使用插座时，如果loggedIn 属性发生更改，则插座不会重新连接/重绘，因此如果我登录然后再次注销，我会得到一个空白页。

有没有一种很好的方法来使用视图助手绑定适当的控制器和控制器内容，或者以一种在loggedIn属性更改时使其正确重绘的方式设置出口？

# git - 在同一台服务器上从一个 --bare repo 推送到另一个 --bare repo

> ID：13961084
> 
> 赞同：0
> 
> 时间：2012-12-19T20:58:41.207
> 
> 标签：git

我在服务器上有一个远程存储库，我推送到该服务器以用于暂存目的。然后我有一个 post-receive 将它推送到[http://stage.xxxx.com](http://stage.xxxx.com)文件所在的文件目录。

既然我的暂存存储库中有所有内容并且假定它没有错误，那么如何将它从我的暂存存储库推送到同一服务器上的实时存储库？

我宁愿不必将我的本地代码直接推送到生产 git 存储库，因为我应该说不是最擅长跟踪这类东西。我是否必须直接登录到服务器并从那里推送到实时存储库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T22:17:36.940

是的，您必须直接登录到服务器，并且该解决方案似乎有点过于复杂，因为您可以执行以下操作：

```
git fetch --all
git push livesite staging/master:master 
```

这会将**staging/master**的状态推送到**livesite/master**，您不必跟踪任何内容。

# php - 显示错误消息

> ID：13961087
> 
> 赞同：1
> 
> 时间：2012-12-19T20:58:45.190
> 
> 标签：php, codeigniter

我正在使用 Codeigniter 框架来创建我的 Web 应用程序。

我有一个登录表单供用户输入他们的用户名和密码以及一个记住我的复选框。用户提交表单后，它使用 jQuery ajax 提交表单并将发布数据发送到登录控制器提交函数以进行数据检查和操作。运行提交函数后，如果用户已登录，则返回 JSON 数组。如果用户成功登录，他/她将被发送到仪表板，如果他们未成功登录，则会显示一条错误消息并在下方每个用户输入都会向未通过 CI 表单验证规则的规则显示相应的消息。

截至目前，它显示一条消息，说它没有通过验证，但我在弄清楚如何显示在用户输入框下没有通过的验证规则时遇到了问题。

```
<div style="display:none"  id="message_container"><button type="button" class="close" data-dismiss="alert">&times;</button></div>
    <div class="login_container">
<?php $attributes = array('id' => 'login_form', 'class' => 'form-horizontal'); ?>
<?php echo form_open('login/submit', $attributes); ?>
    <div class="form-row row-fluid">
        <div class="spa12">
            <div class="row-fluid">
                <?php $attributes = array('class' => 'form_label span12'); ?>
                <?php echo form_label('Username<span class="icon16 icomoon-icon-user-3 right gray marginR10"></span>', 'username', $attributes); ?>
                <?php $attributes = array('name' => 'username', 'id' => 'username', 'value' => '', 'class' => 'span12 text valid'); ?>
                <?php echo form_input($attributes); ?>
            </div>
        </div>
    </div>
    <div class="form-row row-fluid">
        <div class="span12">
            <div class="row-fluid">
                <?php $attributes = array('class' => 'form_label span12'); ?>
                <?php echo form_label('Password<span class="icon16 icomoon-icon-locked right gray marginR10"></span><span class="forgot"><a href="#">Forgot your password?</a></span>', 'password', $attributes); ?>
                <?php $attributes = array('name' => 'password', 'id' => 'password', 'value' => '', 'class' => 'span12 password'); ?>
                <?php echo form_password($attributes); ?>
            </div>
        </div>
    </div>
    <div class="form-row row-fluid">                       
        <div class="span12">
            <div class="row-fluid">
                <div class="form-actions">
                    <div class="span12 controls">
                        <input type="checkbox" id="keepLoged" value="Value" class="styled" name="logged" />Keep me logged in
                        <button type="submit" class="btn btn-info right" id="loginBtn">
                            <span class="icon16 icomoon-icon-enter white"></span>
                            Login
                        </button>
                    </div>
                </div>
            </div>
        </div> 
    </div>
</form>
</div>

public function submit()
{
    $output_status = 'Notice';
    $output_title = 'Not Processed';
    $output_message = 'The request was unprocessed!';

    $this->form_validation->set_rules('username', 'Username', 'trim|required|xss_clean|callback_check_username');
    $this->form_validation->set_rules('password', 'Password', 'trim|required|xss_clean');
    $this->form_validation->set_rules('remember', 'Remember Me', 'trim|xss_clean|integer');

    if ($this->form_validation->run() == TRUE)
    {

    }
    else
    {
        $output_status = 'Error';
        $output_title = 'Form Not Validated';
        $output_message = 'The form did not validate successfully!';
    }

    echo json_encode(array('output_status' => $output_status, 'output_title' => $output_title, 'output_message' => $output_message));
}

public function check_username($str)
{
    if (preg_match('#[0-9]#', $str) && preg_match('#[a-z]#', $str)) 
    {
        return TRUE;
    }
    $this->form_validation->set_message('check_username', 'This is not have an accepted value!');
    return FALSE;
} 
```

编辑：

"error_messages":{"username":"这不是一个可接受的值！"}}

由于我通过 jQuery ajax 函数提交此表单，因此我试图弄清楚我将如何制作我的 if 语句。考虑到除非有更好的主意，否则我将在每个文本字段下放置多个输入。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T21:13:52.463

如果您要做的只是将错误消息字符串附加到您的后面，`$output_message`您可能可以这样做：

```
$output_message = 'The form did not validate successfully! Errors: ' . $this->form_validation->error_string(); 
```

您可以使用以下方法设置自定义错误消息：

```
$this->form_validation->set_message('username', 'Invalid Username'); 
```

根据您的评论进行编辑，如果您想发回错误消息，您应该尝试以下操作：

```
echo json_encode(array('output_status' => $output_status, 'output_title' => $output_title, 'output_message' => $output_message, 'error_messages' => $this->form_validation->error_array())); 
```

为了显示这些错误消息，我会在您的 html 中添加占位符并将消息附加到那里

[CodeIgniters 表单验证库源码](https://github.com/EllisLab/CodeIgniter/blob/develop/system/libraries/Form_validation.php)：

```
/**
 * Get Array of Error Messages
 *
 * Returns the error messages as an array
 *
 * @return  array
 */
public function error_array()
{
    return $this->_error_array;
} 
```

所以看起来这是一个新的添加`Version 3.0`，所以现在你可以通过在你的文件中添加一个文件来扩展表单验证库，`application/libraries/`并命名它`MY_Form_validation.php`并在其中放置：

```
class MY_Form_validation extends CI_Form_validation {
    public function __construct()
    {
        parent::__construct();
    }

    /**
     * Get Array of Error Messages
     *
     * Returns the error messages as an array
     *
     * @return  array
     */
    public function error_array()
    {
        return $this->_error_array;
    }
} 
```

# entity-framework - 使用外键 mvc4 asp.net 创建模型

> ID：13961088
> 
> 赞同：0
> 
> 时间：2012-12-19T20:58:49.970
> 
> 标签：entity-framework, asp.net-mvc-4

我不确定如何创建具有外键的模型。我必须将外键传递给模型，但我不确定处理此问题的最佳方法。

如果您使用[实体框架文档](http://msdn.microsoft.com/en-us/data/jj591583)中的博客/帖子示例：

您会将您的帖子模型传递给您的视图：

```
@model BlogApp.Models.Post 
```

保存模型的一部分是放入 BlogId，这将是一个隐藏字段，但在概念上：

```
<div class="editor-label">
    @Html.LabelFor(model => model.BlogId)
</div>
<div class="editor-field">
    @Html.EditorFor(model => model.BlogId)
    @Html.ValidationMessageFor(model => model.BlogId)
</div> 
```

如何从当前博客模型传递博客 ID，以便可以将其保存在 Post BlogId 字段中？

我能想到的选项。

1.  获取博文中的博客 ID Get create 并将其传递到 ViewBag 中。

2.  添加其他路由规则，使其类似于 blog/2/post/create/3 ，然后以某种方式获取 2 并将其用作 blogId

3.  在会话变量中设置 BlogId 并为 Post 创建控制器中的帖子设置它。

是上述最佳实践之一还是我不知道有其他选择？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T03:59:44.007

在您的工作流程中，将在选择博客后完成创建博客文章。因此，您可以更改 url 以将其作为查询字符串变量，

```
/post/create?blogId=1 
```

**Post**控制器中的**Create**操作将如下所示，

 **```
 [HttpGet]
    public AcionResult Create(int blogId ){
        var post=new Post{BlogId=blogId}
        return view (post); 
    } 
```

我认为这是最简单、最干净的方法。**

# ruby-on-rails-3 - FactoryGirl，2次创建用户？

> ID：13961091
> 
> 赞同：0
> 
> 时间：2012-12-19T20:59:01.547
> 
> 标签：ruby-on-rails-3, rspec, factory-bot

我真的不明白建立关联。在 spec_helper 我有

```
def log_in_user
  user = User.find_by_name 'User1'
  user = FactoryGirl.create :user1 unless user
  sign_in user
end 
```

在 rspec

```
let(:product) { FactoryGirl.build :product_A }

describe "GET confirm purchase" do
    it "xxx" do
      log_in_user

      Product.should_receive(:find_active_by_id).with("1").and_return(product)

       ...
   end
end 
```

工厂.rb

```
FactoryGirl.define do
    factory :user do
        encrypted_password 'abcdef1'
        confirmed_at Time.now

            factory :user1 do
              email 'user1@test.com'
              name 'User1'
              year 1984
            end
    end

    factory :product do
        factory :product_A do
          name "product A"
          association :user, factory: :user1
        end
    end
end 
```

当我运行测试用例时发生异常：ActiveRecord::RecordInvalid: Validation failed: Email has been taken

看起来 user1 正在创建 2 次，一次在 log_in_user 中，第二次在 factory: association :user, factory: :user1

我是对的？如果是，我该如何解决这个问题？我想创建用户并在工厂产品中定义关联

最好的

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T21:41:05.617

当你工厂`:product_A`时，它会自动调用工厂`:user1`。

`:user1`然后您再次在 中进行工厂化`log_in_user`，但对唯一电子邮件的验证阻止了第二个电子邮件的`:user1`创建。

我建议您`sequence`像这样发送电子邮件：

```
FactoryGirl.define do
  sequence :email do |n|
    "user#{n}@test.com"
  end

  factory :user do
    encrypted_password 'abcdef1'
    confirmed_at Time.now

    factory :user1 do
      email
      name 'User1'
      year 1984
    end
  end

  factory :product do
    factory :product_A do
      name "product A"
      association :user, factory: :user1
    end
  end

end 
```

然后，我将更`sign_in_user`改为将（可选）用户作为这样的选项：

```
def log_in_user(user)
  user =|| User.find_by_name 'User1'
  user =|| FactoryGirl.create :user1
  sign_in user
end 
```

并修改您的测试用例以将该用户对象传递给登录：

```
let(:product) { FactoryGirl.build :product_A }

describe "GET confirm purchase" do
  it "xxx" do
    log_in_user(product.user)
    Product.should_receive(:find_active_by_id).with("1").and_return(product)
 end
end 
```

# .net - 并行运行 ASP.Net MVC 2 和 MVC 4 的要求

> ID：13961093
> 
> 赞同：2
> 
> 时间：2012-12-19T20:59:02.333
> 
> 标签：.net, asp.net-mvc, asp.net-mvc-2, asp.net-mvc-4

搜索后我很难找到信息。我们的网站有一个全新的服务器。一个是 MVC 2 站点，另一个是 MVC 4 站点。我只想安装这两个站点的基本要求。

某些版本的 .Net 中是否包含 MVC 框架？MVC 站点上的安装程序看起来都是用于开发的，我不希望安装任何工具，只是站点运行所需的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T21:04:53.223

您只需要安装 .NET 4。然后确保在部署期间复制 DLL，即对 ASP.NET MVC 2 应用程序使用[bin 部署](https://stackoverflow.com/questions/10234130/can-i-bin-deploy-and-mvc4-for-net-4-where-i-have-an-mvc3-app-running)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T21:25:17.773

MVC 2 或 4 的安装程序确实包含工具，但只有在给定计算机上安装了 Visual Studio 时才会安装它。如果它只是一个服务器，那么您应该可以随意使用这些安装程序。

# celery - Celeryd 不会处决我的工人

> ID：13961096
> 
> 赞同：0
> 
> 时间：2012-12-19T20:59:11.467
> 
> 标签：celery, celeryd, celery-task

我正在尝试在 celery 中守护我的任务，我已经在没有守护进程的情况下进行了测试，并且运行良好。

但我不能像教程所说的那样守护进程（[http://docs.celeryproject.org/en/latest/tutorials/daemonizing.html#daemonizing](http://docs.celeryproject.org/en/latest/tutorials/daemonizing.html#daemonizing)）我有我的文件：

**solr_desa.py**

```
from celery import Celery

celery = Celery('solrdesa')
celery.config_from_object('celeryconfig')

@celery.task(name = "doSomething")
def doSomething():
    return 6 
```

**芹菜配置文件**

```
from celery.schedules import crontab

BROKER_URL = '127.0.0.1'
BROKER_PORT = 5673
CELERY_RESULT_BACKEND = 'redis://127.0.0.1:6969/0'
CELERY_TASK_SERIALIZER = 'json'
CELERY_RESULT_SERIALIZER = 'json'
CELERY_TIMEZONE = 'America/Santiago'
CELERY_IMPORTS = ('solr_desa', )
CELERYBEAT_SCHEDULE = {
    'solr_schedule': {
        'task': 'doSomething',
        'schedule': crontab(minute=9, hour=12)
    },
} 
```

还有 **/etc/default/celeryd**

```
CELERY_NODES="w1"

CELERYD_CHDIR="/opt/latam/script/solr"

CELERYD_OPTS="--time-limit=300 --concurrency=8"

CELERY_CONFIG_MODULE="celeryconfig"

CELERYD_LOG_FILE="/var/log/celery/%n.log"
CELERYD_PID_FILE="/var/run/celery/%n.pid" 
```

[我使用https://github.com/celery/celery/blob/3.0/extra/generic-init.d/celeryd](https://github.com/celery/celery/blob/3.0/extra/generic-init.d/celeryd)中的默认 celeryd 执行，但任务只是排队，但看起来没有工人 :(

我的配置错误在哪里？:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T06:37:45.740

您的经纪人网址错误，应该是这样的

```
BROKER_URL : transport://userid:password@hostname:port/virtual_host
#example
BROKER_URL = "amqp://{username}:{password}@{host}:{port}//" 
```

阅读[此处](http://docs.celeryproject.org/en/latest/configuration.html?highlight=broker_url#broker-url)了解更多详情

# objective-c - 使用来自 tableviewcell UITextfield 的输入构建一个数组

> ID：13961097
> 
> 赞同：0
> 
> 时间：2012-12-19T20:59:10.807
> 
> 标签：objective-c, ios, xcode

我有一个表格视图，其中包含动态数量的单元格，基于由 JSON 构建的数组。

```
tableData = [NSJSONSerialization JSONObjectWithData:dataWebService options:kNilOptions error:&error]; 
```

这条小线获取了构建表格视图所需的所有数据。

在表格视图中，我在每个单元格中都有一个文本字段，其中包含来自我的 JSON 的预定义文本。用户可以在进行下一个转场（故事板）之前更改此值。

问题是如何在`tableData`将这个 arraobject 发送到下一个 segue 之前将这个用户类型的值存储在一个数组中并替换我的数组中的现有值。

请记住，当用户在表格视图中滚动时，用户输入不得更改。

也许这是基本的，但我想不出一个很好的方法来做到这一点。

这是 JSON 的一个示例。

```
(
    {
    defaultval = 8;
    dtype = long;
    id = "@franr";
    label = "Faktura nr.";
},
    {
    defaultval = 8;
    dtype = long;
    id = "@tilnr";
    label = "Til faktura";
} 
```

表格视图如下所示：（我无法发布图片）

Fra faktura 8 直到 faktura 8

用户可以将值（数字 8）更改为任何数字。所以我需要在我的 JSON 数组中替换 defaultVal 的数量。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T21:06:50.173

由于它是一个 UITEXTFIELD，您可以使用 OnTextChange 事件

```
[textField addTarget:self action:@selector(textFieldDidChange:) forControlEvents:UIControlEventEditingChanged]; 
```

或者

```
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range     
                  replacementString:(NSString *)string 
```

，或失去焦点

```
- (BOOL)textFieldShouldReturn:(UITextField *)textField 
```

请记住，您需要将文本字段的委托设置为 self 并添加相应的协议。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T21:07:43.417

为了在滚动后保留数据，您应该在用户每次输入后修改数据源（数组）。您可以在 UITextFieldDelegate 的方法中执行 dis `textFieldDidEndEditing:`（当然，您必须是每个文本字段的委托：）`textField.delegate = self;`。您还应该实现一个 UIScrollViewDelegate 方法，用于在表格开始滚动时关闭键盘（例如`scrollViewWillBeginDragging:`）。

**编辑：**

您的数组必须包含不可变的 NSDictionaries，因此我建议您创建自己的具有这些属性（defaultval、dtype ...）的类，以便您可以编辑数据源。我不认为你可以像现在这样修改你的数组。

具有自定义对象的代码将类似于：

```
- (void)textFieldDidEndEditing:(UITextField *)textField {
    UITableViewCell *cell = textField.superview.superview;
    NSIndexPath *indexPath = [self.tableView indexPathForCell:cell];
    MyObject *currentObject = [tableData objectAtIndex:indexPath.row];
    currentObject.defaultVal = textField.text.intValue;
} 
```

# sencha-touch - 控制器未接收到来自视图的 Sencha Touch FireEvent

> ID：13961098
> 
> 赞同：2
> 
> 时间：2012-12-19T20:59:14.893
> 
> 标签：sencha-touch, sencha-touch-2

在我看来，我有这个定义：

**看法：**

```
Ext.define("MyApp.view.Welcome", {
    extend: 'Ext.Panel',
    alias: 'widget.welcomeview',

    config: {
        ///...items... removed lines for brevity.. 
        {
           xtype: 'button',
           id : 'btnSignInNow',
           text: 'Sign In Now',            
           listeners: {
               tap: function() {
               this.fireEvent("onSignInNowTap", this);
                console.log("onSignInNowTap fired"); /// <-- I see this in console.log
          }
       }
    } 
```

我可以在日志中看到这一点。但在我的控制器中，它没有收到事件。任何人都可以对此有所了解吗？

**控制器：**

```
 config: {
        refs: {
            welcomeView: 'welcomeview'
        },

        control: {
            welcomeView: {
                onSignInNowTap: function () {
                    alert('bla!');  <!-- I Don't see this in console.log
                }
            }
        }
    } 
```

我很感激我可能错过了一些东西，但是有什么方法可以调试来找出这个事件是如何/在哪里丢失或被忽略的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T06:58:50.057

尝试

```
this.parent.fireEvent("onSignInNowTap", this); 
```

代替

```
this.fireEvent("onSignInNowTap", this); 
```

这样父视图将触发事件而不是按钮。有时，如果按钮嵌套在内部深处，您可能必须做这样的事情

```
this.parent.parent.parent....fireEvent("onSignInNowTap", this); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-22T22:54:52.293

感谢 ThinkFloyd。你的解决方案奏效了。我必须使用 this.parent.fireEvent(...) 然后控制器才能捕捉到它...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T03:55:00.880

在 initialize 中编写视图的侦听器，您将在 initialize 中获得对此的 **引用**

```
 Ext.define("MyApp.view.Welcome", {
    extend: 'Ext.Panel',
    alias: 'widget.welcomeview',

 initialize:function(){
        this.callParent();
       listeners: {
          tap: function() {
             this.fireEvent("onSignInNowTap", this);
             console.log("onSignInNowTap fired");
          }
       }
    } 
```

# python - Python：翻译常量的最佳方式？

> ID：13961105
> 
> 赞同：1
> 
> 时间：2012-12-19T20:59:57.873
> 
> 标签：python, constants

背景：我正在向需要返回常量名称列表的现有类添加一个新函数。

假设我在一个类中有许多常量

```
JOHN = 1
SMITH = 4
BEN = 8
... 
```

而且我有返回列表常量值的 Web 服务函数，而不是返回`[1,4,8]`我想返回更有意义的数据，例如`['JOHN', 'SMITH', 'BEN']`

什么是有效的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T21:03:26.277

您可以`map()`与映射字典一起使用。

```
arg_map = {1 : 'JOHN', 4 : 'SMITH', 8 : 'BEN'}
translated_result = map(arg_map.get, result_list) 
```

正如评论中提到的，列表理解也可以在这里工作。请注意，您可以通过用括号替换方括号来使其成为生成器。

```
arg_map = {1 : 'JOHN', 4 : 'SMITH', 8 : 'BEN'}
translated_result = [arg_map.get(val, '%s NOT MAPPED' % str(val)) for val in result_list] 
```

# java - 将一些单词作为块添加到 JTextarea

> ID：13961108
> 
> 赞同：0
> 
> 时间：2012-12-19T21:00:05.210
> 
> 标签：java, swing, custom-component, jtextarea

我们想在`JComboBox`a中添加一些词`JTextArea`，但我们希望这些词成为块。

我的意思是当用户试图从这个块中删除一个字母时，整个块将被删除。

例子：

让块词为“Title”，那么当我们在 a 中有这个块时`JTextArea`，我们将其作为一个字母处理。

我们怎么能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T05:51:13.350

获取`JTextArea`的文档并添加`DocumentFilter`. 检查事件的偏移量是否在块文本内并跳过事件（删除或插入）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T22:07:43.403

您也许可以像这样将 customEditorKit 附加到[jetTextPane](http://docs.oracle.com/javase/7/docs/api/javax/swing/JTextPane.html#setEditorKit(javax.swing.text.EditorKit))：
1\. 扩展`EditorKit`并覆盖`ViewFactory`以返回 CustomViewFactory 的实例2.
实现并返回BoxView、ComponentView、IconView（如果要添加一些图标 + 文本）等的覆盖方法。`create``CustomViewFactory``ViewFactory`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T21:43:44.683

如评论中所述，您可以使用`JTextPane`将 a 添加`Component`到文本区域。然后它总是被视为一个完整的词。这是一个例子：

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

public class TextComponent extends Box{
    public TextComponent(){
        super(BoxLayout.Y_AXIS);
        final JTextPane textArea = new JTextPane();
        textArea.setAlignmentX(CENTER_ALIGNMENT);
        add(textArea);

        JButton addText = new JButton("Add Text");
        addText.setAlignmentX(CENTER_ALIGNMENT);

        addText.addActionListener(new AbstractAction() {
            @Override
            public void actionPerformed(ActionEvent e) {
                JLabel text = new JLabel("Original Text");
                text.setAlignmentY(0.8f);
                text.setOpaque(true);
                text.setBackground(Color.yellow);
                textArea.insertComponent(text);
            }});
        add(addText);
    }

    public static void main(String[] args) {
        JFrame frame = new JFrame();
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setContentPane(new TextComponent());
        frame.pack();
        frame.setVisible(true);
    }
} 
```

# css - 尽管 z-index 较低，但子元素与其他元素重叠？

> ID：13961112
> 
> 赞同：4
> 
> 时间：2012-12-19T21:00:28.917
> 
> 标签：css, position, z-index, children

所以我今天一直在试验 z-index，我真的不明白这里发生了什么。

这是一个非常简化的 HTML 版本：

```
// content has z-index of 30, pos abs
<div class="content">
    // content-centered has z-index of 32, pos rel
    <div class="content-centered">
        // Text and buttons goes here
    </div>
</div>

// bubbles has z-index of 31, pos abs
<div class="bubbles">
    <div class="bubbles-centered">
        // Bubbles goes here
    </div>
</div> 
```

目标是让 .content 提供背景内容，然后是背景上方的气泡，最后是气泡上方的内容。由于某种原因，正在发生的事情是气泡位于内容之上。

见演示：http: [//jsfiddle.net/zFFkv/1/](http://jsfiddle.net/zFFkv/1/)

给它几秒钟让气泡出现在内容上。您无法选择文本或按下按钮，因为气泡层位于内容层之上，即使它设置在下方。这是怎么回事？子元素不继承父索引吗？

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T21:07:44.040

z 索引是相对于其父级而不是整个文档进行解析的。

`.bubbles`在上面`.content`，这就是你的情况。里面的所有孩子`.content`都将在下面`.bubbles`，但可以相对于彼此排序。

做你想做的事`.content-centered`，`.bubbles`必须是兄弟姐妹。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T09:00:34.703

您可以在气泡元素上将指针事件设置为无，以防止它阻塞下面的链接，尽管我认为它在 IE 中没有很好的支持。

```
.bubbles {
     pointer-events: none;
} 
```

[演示](http://robertnyman.com/css3/pointer-events/pointer-events.html)

# android - 摩托罗拉 Razr i (XT890) 应用程序

> ID：13961117
> 
> 赞同：0
> 
> 时间：2012-12-19T21:00:47.357
> 
> 标签：android, intel

我正在考虑购买配备 Intel Atom 2.0GHz 的 Motorola Razr i。

我的问题是：我想开始学习 Android 开发，而我会使用的两个 Developers IDE 是 Eclipse 和 Appcelerator 上的原生 Java + Android SDK。

使用这些 IDE 为 Android 开发我会在 Razr i 上运行我的应用程序时遇到问题，因为它有一个英特尔处理器。或者那些“英特尔应用程序问题”仅适用于游戏和其他类型的应用程序，这些应用程序直接对某些 ARM 处理器有指令？

非常感谢！

:)

# java - 递归洪水填充 - 检查边界

> ID：13961125
> 
> 赞同：0
> 
> 时间：2012-12-19T21:01:16.120
> 
> 标签：java, recursion, flood-fill

我在矩阵中有一个合法邻居的递归洪水填充（合法邻居是具有相同颜色的邻居），洪水没有填充数组中的所有合法邻居。我用于测试的板是：

```
int[][] map={{4,0,0,0},
             {0,4,0,0},
             {0,4,0,0},
             {0,4,0,0}};

   fill(map,1,1,9,4);// calling to function. 
```

输出是：

```
4000
0900
0900
0900 
```

**编辑** 如果我将地图更改为：

```
int[][] map={{4,0,0,0},
         {4,4,0,0},
         {0,4,0,0},
         {0,4,0,0}}; 
```

输出将是：

```
4000
4900
0900
0900 
```

剩下的两个 4 数字也需要填写。我的递归函数是：

```
public static void fill(int[][] map, int row, int col, int color,int oldColor) 

   {

System.out.println("row is: "+row+"col is:"+col);
if ((row <= 0) || (row >= map.length) || (col <= 0) || (col >= map.length) ) return; 

if(map[row][col]==color)
        return;

if(map[row][col]==oldColor)
    {
        map[row][col]=color;
    }
if(col+1<=map.length)
      fill(map, col+1, row,color,oldColor);
 if((col-1)<=0) 
      fill(map,col-1, row,color,oldColor);

  if(row+1<=map.length)
      fill(map, col, row+1,color,oldColor);
  if((row-1)<=0)
      fill(map, col, row-1,color,oldColor);

   } 
```

**更改代码**

```
public static void fill(int[][] map, int row, int col, int color,int oldColor) {
    System.out.println("row is: "+row+"col is:"+col);
if ((row < 0) || (row > map.length) || (col < 0) || (col > map.length) || map[row]                        [col]!=oldColor ) return; 

if(map[row][col]==color)
        return;

if(map[row][col]==oldColor)
    {
        map[row][col]=color;
    }

fill(map, col, row-1,color,oldColor);
fill(map, col+1, row,color,oldColor);
    fill(map, col, row+1,color,oldColor);
    fill(map,col-1, row,color,oldColor);
  } 
```

现在的输出是：

```
9000
9900
0900
0400 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T21:36:38.593

你有几个错误。首先，你的守卫不包括第 0 行和第 0 列，所以这就是你没有得到预期结果的原因之一。

现在，修复您将获得堆栈溢出的问题，因为您将尝试填充所有邻居，无论它们具有哪种颜色。这意味着您将永远访问颜色为 0 的所有单元格。您只想填充具有*oldColor*的邻居。

最后，您的方法需要参数*row, column*，但您使用*column, row*递归调用它，因此您切换每个堆栈级别的索引。

修复了您可以在没有保护的情况下获得更简单的方法*if*。如果您希望行的长度不同，则需要再次添加防护。

显示一个自包含的示例，该示例在填充地图之前和之后打印地图。

```
public class FloodFill {

  static int[][] map1 ={{4,0,0,0}, {4,4,4,4}, {0,4,0,4}, {0,4,0,0}};
  static int[][] map2 ={{0,4,4,4}, {0,4,0,4}, {0,4,0,4}, {9,9,9,4}};

  public static void fill(int[][] map, int row, int col, int color, int oldColor) {
    if (map[row][col] == oldColor) {
      map[row][col] = color;
      if (col + 1 < map[row].length)
        fill(map, row, col + 1, color, oldColor);           
      if (col > 0)
        fill(map, row, col - 1, color, oldColor);           
      if (row + 1 < map.length)
        fill(map, row + 1, col, color, oldColor);
      if (row > 0)
        fill(map, row - 1, col, color, oldColor);
    }
  }

  public static void main(String[] args) {
    floodfill(map1);
    floodfill(map2);
  }

  private static void floodfill(int[][] map) {
    show(map, "Initial");
    fill(map, 1, 1, 9, 4);
    show(map, "Filled");
  }

  private static void show(int[][] map, String label) {
    System.out.println(label);
    for (int[] row : map) {
      for (int val : row) {
        System.out.print(val + " ");
      }
      System.out.println();
    }
  }
} 
```

另一种使用防护装置填充，然后也可以处理不同长度的行。

```
public static void fill2(int[][] map, int row, int col, int color, int oldColor) {
  if (row < 0 || row >= map.length || col < 0 || col >= map[row].length) 
    return;
  if (map[row][col] == oldColor) {
    map[row][col] = color;
    fill2(map, row, col + 1, color, oldColor);          
    fill2(map, row, col - 1, color, oldColor);          
    fill2(map, row + 1, col, color, oldColor);
    fill2(map, row - 1, col, color, oldColor);
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T21:30:22.020

这不是最佳答案，但我无法删除我的提交。

```
public class Fill
{

    public static void fill(int[][] map, int col, int row, int color,int oldColor) 
    {

        System.out.println("row is: "+row+"col is:"+col);
        if ((row <= 0) || (row >= map.length) || (col <= 0) || (col >= map.length) ) return; 

        if(map[row][col]==color)
            return;

        if(map[row][col]==oldColor)
        {
            map[row][col]=color;
        }

        if(col+1<=map.length) {
            fill(map, col+1, row,color,oldColor);
        }

        if((col-1)<=0) { 
            fill(map,col-1, row,color,oldColor);
        }

        if(row+1<=map.length) {
            fill(map, col, row+1,color,oldColor);
        }

        if((row-1)<=0) {
            fill(map, col, row-1,color,oldColor);
        }

    } 

    public static void main(String pArgs[])
    {
        int[][] map={{4,0,0,0},
             {0,4,0,0},
             {0,4,0,0},
             {0,4,0,0}};

        printMap(map);
        fill(map,1,1,9,4);// calling to function.
        printMap(map);
    }

    static void printMap(int[][] map)
    {
        for (int i=0; i < 4; i++) {
            System.out.print("{");
            for (int j=0; j<4; j++) {
                System.out.print( map[i][j] + "," );
            }
            System.out.println("}");
        }
    }
} 
```

# c# - 带过滤视图的代码优先数据绑定

> ID：13961126
> 
> 赞同：1
> 
> 时间：2012-12-19T21:01:16.900
> 
> 标签：c#, winforms, entity-framework, data-binding

下午好，

我目前正在尝试在 winforms 应用程序中使用实体框架 DbContext/Code First。我的类*PrintQueueItem*映射到数据库内的视图，该视图仅返回*PrintQueueItem*的*PrintStatus*等于“待定”。这通过 DataGridView 显示给最终用户，因此他们可以查看在一天结束时要批量打印的内容。用户可以添加*PrintQueueItem*的实例，这也显示在 DataGridView 中。

当我尝试取消设置为打印的项目时，我的问题出现了。我将*PrintStatus*设置为*Canceled*，然后运行 ​​ExecuteSqlCommand 来更新数据库。在此之后，我尝试重新加载信息，但该项目仍显示在 DataGridView 中。我不确定为什么在再次加载信息后获得计数（通过本地）时，它已减一。知道为什么会这样，因为我认为 BindingList 为数据绑定提供了 2 路同步，并且 UI 会随着数据的变化而更新？

**PrintQueueItem（模型）**

```
public class PrintQueueItem
{
    public PrintQueueItem()
    {
        this.PrintQueueID = Guid.NewGuid();
        this.PrintStatus = "Pending";
        this.DateAdded = DateTime.Now;
    }

    public Guid PrintQueueID { get; set; }
    public Guid DocumentID { get; set; }
    public string PrintStatus { get; set; }
    public DateTime DateAdded { get; set; }

    public virtual Documentation Document { get; set; }
} 
```

**初始绑定**

```
this.printQueueBinding.DataSource = db.PrintQueue.Local.ToBindingList();
this.printQueueGridView.AutoGenerateColumns = false;
this.printQueueGridView.DataSource = printQueueBinding; 
```

**更新 PrintQueueItem 上的 PrintStatus 并重新加载**

```
PrintQueueItem item = printQueueBinding.Current as PrintQueueItem;
if (item == null)
{
    throw new ArgumentNullException("Could not obtain instance of selected 'PrintQueueItem'");
}
item.PrintStatus = "Cancelled";
this.db.Database.ExecuteSqlCommand("exec usp_PrintQueue_Update {0}, {1}",item.PrintQueueID, item.PrintStatus);
this.db.PrintQueue.Load(); 
```

**一些附加说明**

我没有调用 ExecuteSqlCommand，而是尝试调用 SaveChanges，但遇到异常说明：

```
"Store update, insert, or delete statement affected an unexpected number of rows (0). Entities may have been modified or deleted since entities were loaded." 
```

我假设这是因为在更新时不再在视图中找到该项目。如果不是这种情况，请告诉我。

在应用程序中使用过滤视图而不是过滤的原因是因为 BindingList 没有实现 IBindingListView，而且我无法实现 BindingList.Filter 方法来过滤 DataGridView 中显示的数据。也欢迎对此提出任何建议。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T02:33:12.140

喝了几杯啤酒，让我头脑中混乱的逻辑从今天早些时候清理出来；我开始思考实际发生了什么，然后突然想到，当我尝试调用 SaveChanges 时，发生了并发异常。

我没有注意到引发的异常类型，因此未能正确处理它。我已经将我的代码更新为以下内容，因此当发生 DbUpdateConcurrencyException（预期，因为视图不再包含记录）时，遇到问题的实体将从数据库中刷新：

```
 try
        {
            if (Program.YesNoQuestion(string.Format("Cancel print job for the selected document?", printQueueGridView.SelectedRows.Count)) != System.Windows.Forms.DialogResult.Yes)
            {
                return;
            }

            PrintQueueItem item = printQueueBinding.Current as PrintQueueItem;
            if (item == null)
            {
                throw new ArgumentNullException("Could not obtain an instance of 'PrintQueueItem'");
            }

            item.PrintStatus = "Cancelled";
            this.db.Database.ExecuteSqlCommand("exec usp_PrintQueue_Update {0}, {1}", item.PrintQueueID,
                                                                                           item.PrintStatus);
            //this.db.PrintQueue.Load();
            this.db.SaveChanges();
        }
        catch (DbUpdateConcurrencyException ex)
        {
            foreach (DbEntityEntry entry in ex.Entries)
            {
                entry.Reload();
            }
        } 
```

请让我知道是否有更好的方法来解决这个问题，因为我总是对其他想法持开放态度，并且总是有兴趣以正确的方式做事。有一个美好的夜晚！

# c++ - 为什么我需要将 -lstdc++ 添加到我的其他链接器标志中？

> ID：13961127
> 
> 赞同：2
> 
> 时间：2012-12-19T21:01:24.220
> 
> 标签：c++, objective-c, linker

对这个问题的[回答](https://stackoverflow.com/questions/7701393/link-error-about-opencv-in-xcode)让我意识到我需要将 -lstdc++ 添加到我的“其他链接器标志”中才能编译我的项目。

如果我将代码直接编译到我的项目中，它运行良好。如果我将它构建到一个框架中并包含该框架，它会抱怨：

```
Undefined symbols for architecture armv7:
  "std::terminate()", referenced from: ... 
```

添加 -lstdc++ 似乎可以解决问题。它很好用，但是有人可以帮助我理解为什么我只在将我的代码视为框架时才看到这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T23:29:15.187

[Jerry Coffin 的评论](https://stackoverflow.com/questions/13961127/why-do-i-need-to-add-lstdc-to-my-other-linker-flags#comment19258289_13961127)是有用的答案。编译器正在检测 .mm 扩展名并切换到 Obj-C++ 来构建框架，但没有迹象表明包含框架的构建也应该以这种方式编译。

# javascript - javascript对象问题

> ID：13961131
> 
> 赞同：1
> 
> 时间：2012-12-19T21:01:37.960
> 
> 标签：javascript, object

我试图理解别人的代码。他有

```
task.prototype.taskAttributes = {
  'header' : [
    {'name' : 'display_type', 'display' : 'Display Type', 'type' : 'select', 'options' : {
      'default' : 'Default',
      name1 : 'Peter',
      name2 : 'Ted',
     }
    },
    {'name' : 'background', 'display' : 'Background', 'type' : 'image'},
    {'name' : 'background_position', 'display' : 'Background Position', 'type' : 'text'},
    {'name' : 'credit', 'display' : 'Background Credit', 'type' : 'text'}],

  'input' : [
    {'name' : 'display_type', 'display' : 'Display Type', 'type' : 'select', 'options' : {
      'default' : 'Default',
      title1 : 'manager',
      title2 : 'employee'}
    },
    {'name' : 'background', 'display' : 'Background', 'type' : 'image'},
    {'name' : 'background_position', 'display' : 'Background Position', 'type' : 'text'},

  'image' : [{'name' : 'column', 'type' : 'select', 'options' : ['', 'left', 'right']}]
} 
```

我不确定 ' `header`' 和 ' `input`' 是否是对象属性？`header`' ' 和 ' `input`' 下的属性是什么

这些有什么作用：

```
{'name' : 'display_type', 'display' : 'Display Type', 'type' : 'select', 'options' : {
  'default' : 'Default',
  name1 : 'Peter',
  name2 : 'Ted',
 }
},
{'name' : 'background', 'display' : 'Background', 'type' : 'image'},
{'name' : 'background_position', 'display' : 'Background Position', 'type' : 'text'},
{'name' : 'credit', 'display' : 'Background Credit', 'type' : 'text'}], 
```

我想声明对象属性，我们这样做

```
attribute={header:'header', input:'input'} 
```

我不知道他为什么有这么多的属性。

谢谢你们的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T21:04:24.520

`header`并且确实`input` *是*的对象属性`taskAttributes`，`image`以及。

```
taskAttributes = {
  // Three object properties, each is an array
  header: [],
  input: [],
  image: []
} 
```

其中的每一个本身就是一个具有, ,等属性`[]`的对象数组。这解决了您问题的“*这些做什么*”部分。`{}``name``display``type`

 *```
// Example object element of the parent attribute arrays:
// There are multiples of these objects for each property header, input, image
{'name' : 'background', 'display' : 'Background', 'type' : 'image', 'options': {...}} 
```

例如，要访问`name`下面的第一个，您可以访问它的数组键，如下所示：`header``[0]`

```
taskAttributes.header[0].name
// 'displayType'

// And the third array element [2]
taskAttributes.header[2].name
// 'credit' 
```

`headers`在两者的第一个数组元素上还有一层嵌套，`input`如下所示：

```
// Property named options is an object...
'options' : {
  'default' : 'Default',
  title1 : 'manager',
  title2 : 'employee'
} 
```

`options`那是为每个对象引用的另一个对象。

```
taskAttribtues.header[0].options.title1
// 'manager' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T21:08:34.040

是的`header`，`input`和`image`是`task.prototype.taskAttributes`对象的属性，它们中的每一个都包含一个对象数组。[通过http://jsbeautifier.org/](http://jsbeautifier.org/)管道您的代码可以通过使用缩进强调文字结构来提供帮助：

```
task.prototype.taskAttributes = {
    'header': [{
        'name': 'display_type',
        'display': 'Display Type',
        'type': 'select',
        'options': {
            'default': 'Default',
            'name1': 'Peter',
            'name2': 'Ted',
        }
    }, {
        'name': 'background',
        'display': 'Background',
        'type': 'image'
    }, {
        'name': 'background_position',
        'display': 'Background Position',
        'type': 'text'
    }, {
        'name': 'credit',
        'display': 'Background Credit',
        'type': 'text'
    }],
    'input': [{
        'name': 'display_type',
        'display': 'Display Type',
        'type': 'select',
        'options': {
            'default': 'Default',
            'title1': 'manager',
            'title2': 'employee'
        }
    }, {
        'name': 'background',
        'display': 'Background',
        'type': 'image'
    }, {
        'name': 'background_position',
        'display': 'Background Position',
        'type': 'text'
    },
    'image': [{
        'name': 'column',
        'type': 'select',
        'options': ['', 'left', 'right']
    }]
}; 
```*

# gzip - 文件在哪里以及如何被 gzip 压缩？

> ID：13961133
> 
> 赞同：3
> 
> 时间：2012-12-19T21:01:47.587
> 
> 标签：gzip

[下载jQuery](http://jquery.com/)的生产副本时，链接旁边会显示该文件是 32K Minified & Gzipped。我被缩小了，但 Gzipped 是什么意思？

它是由像[Apache deflate](http://httpd.apache.org/docs/2.2/mod/mod_deflate.html)这样的网络服务器压缩的吗？

**更新**：找到这个网站，看看哪些资源被压缩了[http://gzipwtf.com/](http://gzipwtf.com/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T21:19:35.687

当您的浏览器向 Web 服务器发送 HTTP 请求时，它可以指定[`Accept-Encoding`字段](http://en.wikipedia.org/wiki/HTTP_compression)来指示它支持哪些压缩模式：

```
GET /scripts/jquery.min.js HTTP/1.1
Host: www.example.com
Accept-Encoding: gzip, deflate 
```

然后服务器可以选择这些模式之一（但不是必须）并在响应标头中指定它：

```
HTTP/1.1 200 OK
Content-Encoding: gzip
etc. 
```

因此，如果 Web 服务器配置为 gzip javascript 文件，并且浏览器支持它（绝大多数支持），那么文件将被“gzip”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T21:04:06.047

是的，它使用了一个名为 mod_gzip 的 Apache 模块：

[http://sourceforge.net/projects/mod-gzip/](http://sourceforge.net/projects/mod-gzip/)

它（原则上）就像 mod_deflate 一样有效。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-19T21:10:45.477

该下载链接指向您可以在网页中热链接到的托管文件。文件本身是缩小的 JavaScript。

当浏览器从其托管服务器请求文件时，它会在传输过程中使用内容标头中指定的 Gzip 压缩进行进一步压缩。当浏览器接收到它时，它会膨胀并存储在浏览器的缓存中。

如果您要在自己的服务器上托管缩小文件，除非您将服务器配置为使用压缩，否则它不一定会在传输过程中被压缩。

# algorithm - 蛮力算法

> ID：13961134
> 
> 赞同：-1
> 
> 时间：2012-12-19T21:01:52.383
> 
> 标签：algorithm, cryptography, brute-force

没有什么特别的原因，除了我对密码学和计算感兴趣之外，我想用 Java 或 Visual Basic 或 C# 制作我自己的暴力破解程序，看看它是否可以破解密码。我对性能不感兴趣，我知道这是一种完全不切实际的方法——老实说，这只是一个有趣的项目。但是，我脑子里只有一个粗略的想法，我什至无法将其放入伪代码中。我最精通Java，但即使有人可以为我提供很棒的伪代码！

我不想为程序提供一个长度，但我会提供一个最大长度。我知道该程序将不得不做很多工作，但我也认为我有点想太多了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T15:26:16.123

好的，所以我刚刚找到了一个我想在 C++ 中执行的示例，并且我设法将其转换为以下 Visual Basic .NET 代码，它可以完美运行。然而，输出似乎有点慢，我原以为程序会使用接近 100% 的处理能力，但事实并非如此。有人可以告诉我为什么会这样以及我该如何改变它吗？

```
Public Class Form1
    Dim chars() As Char = "1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYX".ToCharArray
    Dim csize As Integer = chars.Length - 1
    Dim upto As String
    Private Sub btnGo_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnGo.Click
        upto = "                                                  "

        Dim max_length As Integer = 50

        For i = 1 To max_length
            bf_recursion(0, i)
            Update()
        Next

    End Sub

    Private Sub bf_recursion(ByVal index As Integer, ByVal depth As Integer)
        Dim current() As Char = upto.ToCharArray()

        For i = 0 To csize
            current(index) = chars(i)
            upto = CStr(current)

            Console.WriteLine(CStr(current))
            '\\lblOutput.Text = CStr(current)

            If index <> (depth - 1) Then
                bf_recursion(index + 1, depth)
            End If
        Next
    End Sub
End Class 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T21:06:24.007

你要做的第一件事就是弄清楚你想要暴力破解什么。我会选择一种单向散列方案，例如 MD5 或 SHA-1，可以在高速率下强制执行。在选择了要“破解”哪种方式的哈希方案后，您必须找到某种密码列表，例如[http://www.whatsmypass.com/the-top-500-worst-passwords-of-all-时间](http://www.whatsmypass.com/the-top-500-worst-passwords-of-all-time)。获得列表后，您需要对值进行散列并将它们存储在某处。在您拥有这个存储的“真实”数据集后，您可以创建蛮力循环并进行比较。当您找到匹配项时，输出该匹配项。您现在已经通过蛮力“破解”了一个虚假的个人密码。祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-14T12:32:17.053

哈桑-G：是的，我可以

```
Dim chars() As Char = "1234567890abcdefghijklmnopqrstuvwxyz".ToCharArray
    Dim csize As Integer = chars.Length - 1
    Dim upto As String
    Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
        upto = "                                                  "

        Dim max_length As Integer = 25

        For i = 1 To max_length
            bf_recursion(0, i)
            Update()
        Next

    End Sub

    Private Sub bf_recursion(ByVal index As Integer, ByVal depth As Integer)
        Dim current() As Char = upto.ToCharArray()

        For i = 0 To csize
            current(index) = chars(i)
            upto = CStr(current)

            TextBox1.Text = (CStr(current))
            TextBox1.Refresh()
            Me.Refresh()
            '\\lblOutput.Text = CStr(current)

            If index <> (depth - 1) Then
                bf_recursion(index + 1, depth)
            End If
        Next
    End Sub 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-02-24T20:38:44.743

```
while (true) 
{

 string[] mystring = new string[27];
                    mystring[0] = "";
                    mystring[1] = "a";
                    mystring[2] = "b";
                    mystring[3] = "c";
                    mystring[4] = "d";
                    mystring[5] = "e";
                    mystring[6] = "f";
                    mystring[7] = "g";
                    mystring[8] = "h";
                    mystring[9] = "i";
                    mystring[10] = "j";
                    mystring[11] = "k";
                    mystring[12] = "l";
                    mystring[13] = "m";
                    mystring[14] = "n";
                    mystring[15] = "o";
                    mystring[16] = "p";
                    mystring[17] = "q";
                    mystring[18] = "r";
                    mystring[19] = "s";
                    mystring[20] = "t";
                    mystring[21] = "u";
                    mystring[22] = "v";
                    mystring[23] = "w";
                    mystring[24] = "x";
                    mystring[25] = "y";
                    mystring[26] = "z";

                    if (counter == 27)
                    {
                        counter = 0;
                        counter2++;
                    }

                    if (counter2 == 27)
                    {
                        counter2 = 0;
                        counter3++;
                    }

                    if (counter3 == 27)
                    {
                        counter3 = 0;
                        counter4++;
                    }

                    if (counter4 == 27)
                    {
                        counter4 = 0;
                        counter5++;
                    }

                    if (counter5 == 27)
                    {
                        counter5 = 0;
                        counter6++;
                    }

                    if (counter6 == 27)
                    {
                        throw new Exception();
                    }

                    guessedpassword =  mystring[counter6] + mystring[counter5] + mystring[counter4] + mystring[counter3] + mystring[counter2] + mystring[counter];

                    counter++;
    } 
```

这是我写的一些代码。破解效率很低，但是很简单。

# linq-to-xml - 如何从 xml 文件中读取多维值？

> ID：13961139
> 
> 赞同：1
> 
> 时间：2012-12-19T21:02:22.550
> 
> 标签：linq-to-xml

我试过但无法得到它？这是xml文件

```
<Root>
    <Data>
        <Keys>Key1, key2, key3, key4</Keys>
        <FirstRow>Key1row1, Key2Row1, Key3Row1, Key4Row1</FirstRow>
        <SecondRow>Key1Row2, Key2Row2, Key3Row2, Key4Row2</SecondRow>
        <ThirdRow>Key1Row3, Key2Row3, Key2Row3, Key2Row3</ThirdRow>
        and so on .........
    </Data>
</Root> 
```

我需要使用 Linq to XML：-

```
 var data = from d in xDoc.Root.Element("Data")
                              select d;
    foreach(var d in data)
    {
        ...
    } 
```

我喜欢将**逗号分隔**的键值与**逗号分隔**的Rows 值进行 Md 数组映射。

```
Key1      key2        key3       key4
Key1row1  key2Row1    Key3Row1   Key4Row1
.... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T22:05:36.717

行元素可以迭代（如已完成），但需要`string.Split`（或更高级的解析器）来分解行值本身。在以下示例中，它是在`RowTextToValues`方法中完成的。

这是一个带有一些提示的[LINQPad](http://www.linqpad.net)示例（作为“C# 程序”运行）：

```
IEnumerable<string> RowTextToValues (string v) {
    return v.Split(new [] {", "}, StringSplitOptions.None);
}

XDocument TestDoc() {
    return XDocument.Parse(@"
    <Root>
        <Data>
            <Keys>Key1, key2, key3, key4</Keys>
            <FirstRow>Key1row1, Key2Row1, Key3Row1, Key4Row1</FirstRow>
            <SecondRow>Key1Row2, Key2Row2, Key3Row2, Key4Row2</SecondRow>
            <ThirdRow>Key1Row3, Key2Row3, Key2Row3, Key2Row3</ThirdRow>
        </Data>
    </Root>");
}

void Main()
{
    var dataNode = TestDoc().Root.Element("Data");

    // -> IEnumerable<XElement>
    var rows = dataNode.Elements();

    // -> IEnumerable<IEnumerable<string>>
    var res = rows
        .Select(r => RowTextToValues(r.Value));

    res.Dump();
} 
```

转换为二维数组或处理更复杂的规则留作练习。

# python - 在 python 中使用命令行时出现语法错误

> ID：13961140
> 
> 赞同：53
> 
> 时间：2012-12-19T21:02:32.203
> 
> 标签：python, command-line, syntax-error

我是 python 的初学者，目前无法使用命令行。我有一个脚本 test.py（仅包含`print("Hello.")`），它位于地图 C:\Python27 中。在我的系统变量中，我将 python 指定为 C:\Python27（我的计算机上也安装了其他版本的 Python）。

我认为这应该足以`python test.py`在命令行中运行，但是当我这样做时，我得到了：

```
File "<stdin>", line 1
python test.py
       ^
SyntaxError: invalid syntax 
```

怎么了？提前致谢！

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2012-12-19T21:04:07.820

看起来您的问题是您试图`python test.py` *从 Python 解释器*中运行，这就是您看到该回溯的原因。

确保您不在解释器中，然后`python test.py`从 bash 或命令提示符或其他任何方式运行命令。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-12-19T21:05:58.000

不要`python test.py`从 Python 解释器中输入。在命令提示符下键入它，如下所示：

![命令文件](../Images/c6c07978f8fcf8a5af0df2503787d0f3.png)

![蟒蛇测试.py](../Images/8356acb8d3e38a4f4c7adbc1d00a04f5.png)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-09-09T07:01:51.207

我遇到了类似的问题，在我的 Windows 计算机上，请检查您是否正确设置了环境变量。

要检查环境变量是否设置正确：

1.  打开 cmd.exe

2.  键入 Python 并按回车键

3.  (a) 如果它输出 python 的版本，则环境变量设置正确。

    (b) 如果它输出“没有这样的程序或文件名”，那么您的环境变量设置不正确。

设置环境变量：

1.  转到计算机-> 系统属性-> 高级系统设置-> 设置环境变量
2.  转到系统变量中的路径；最后附加 ;C:\Python27 。

如果您已经设置了正确的变量；然后你在 python 解释器中调用文件。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2021-04-25T21:23:32.123

您只需`exit()`在 Python 终端中键入即可退出 Python 解释器。然后当你运行代码时，就不会再有错误了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-19T21:08:15.477

为了运行脚本，您应该在命令提示符中编写“python test.py”命令，而不是在 python shell 中。此外，test.py 文件应该位于您在 cli 中运行的路径中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-19T21:07:36.757

从命令行运行意味着从终端或 DOS shell 运行。您正在从 Python 本身运行它。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2015-09-24T12:02:17.453

从“python解释器”中走出来。

1.  检查您的 PATH 变量 c:\python27
2.  cd 和您的文件位置。3.现在输入 Python yourfilename.py。

我希望这应该工作

# javascript - 谷歌分析会话多长时间？超过每次会话的最大命中数，中止命中

> ID：13961143
> 
> 赞同：1
> 
> 时间：2012-12-19T21:02:46.573
> 
> 标签：javascript, debugging, google-chrome-extension, google-analytics

我有一个 Chrome 扩展程序，我对我的分析代码进行了调试，产生了一条控制台消息“超过了每个会话的最大点击数，正在中止点击”。请注意，这只发生在生产中。

我理解为什么会发生这种情况，因为每个会话限制为大约 500 个 utm 请求。但是，这些会话何时到期？有没有办法强制会话或会话过期？在解决了一些问题的更新后，我只需要使这些会话过期一次。

由于应用程序遇到了导致“事件过度生成”的错误，我已经解决了这个问题，我想使所有这些会话到期或知道它们何时到期。

任何帮助是极大的赞赏。

```
_gaq.push processing "_setAccount" for args: "[UA-XXXXXX-X]":  ssl.google-analytics.com/u/ga_debug.js:18
_gaq.push processing "_trackPageview" for args: "[]":  ssl.google-analytics.com/u/ga_debug.js:18
Track Pageview ssl.google-analytics.com/u/ga_debug.js:18
Exceeded maximum hits per session. Aborting hit. 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T21:22:53.593

就个人而言，我认为不应达到每个会话 500 个请求的限制。也许您的网站正在过度生成事件。

以下是可能产生如此多事件的一些线索：

> 每个会话的事件限制
> 
> 对于每次访问（用户会话），最多可以跟踪大约 500 个组合 GATC 请求（事件和页面浏览量）。以编程方式生成事件时请记住这一点。请注意，随着会话中的事件数量接近限制，可能不会跟踪其他事件。例如，您应该：
> 
> *   避免编写视频脚本以在播放的每一秒和其他高度重复的事件触发器中发送一个事件
> *   避免过度的鼠标移动跟踪
> *   避免产生高事件计数的延时机制

（来自 Google Analytic 的[事件跟踪指南](https://developers.google.com/analytics/devguides/collection/gajs/eventTrackerGuide)）

根据以下情况，访问似乎从月初持续到月底：

> 为了了解访问次数维度的工作原理，首先需要了解 Google Analytics（分析）中会话的计数方式。每次用户访问您的网站时，都会对他们的访问应用一个计数器，该计数器会随着该访问者的每个新会话而增加。例如，如果访客 A 在 1 月份第一次访问您的网站，他们的会话计数为 1。如果该访客随后在 2 月返回，他们的会话计数将为 2，以此类推，每次后续访问。

（基于会话的更多背景信息，请参阅[有关此主题的 Google Analytics 帮助中心](http://support.google.com/analytics/bin/answer.py?hl=en&answer=1032796)）

也许您可以考虑更改[会话超时](https://developers.google.com/analytics/devguides/collection/gajs/methods/gaJSApiBasicConfiguration#_gat.GA_Tracker_._setSessionCookieTimeout)。

# jquery - 计算在 JQuery 中单击的特定图像的问题

> ID：13961145
> 
> 赞同：0
> 
> 时间：2012-12-19T21:02:55.097
> 
> 标签：jquery, wordpress

嘿伙计们，所以我有一个概述我正在为产品构建，问题是我有以下代码：

```
<?php  $i = 0; $j = 1;?>
                <?php if ( have_posts() ) : while ( have_posts() ) : the_post(); ?>
                <?php get_template_part( 'content', get_post_format() ); 
                    $postid[$i] = get_the_ID();
                    echo "<input type='hidden' value='".$postid[$i]."' id='hiddenpostitle".$j."' name='hiddenpostitle'/> ";
                    echo "<input type='hidden' value='".$j."' id='hiddenpostnumfield'/> ";
                ?>
                                            <script type="text/javascript">
                                $(function()
                                {

                                    $('.item-post a').click(function() {
                                        var num = $('#hiddenpostnumfield').val();
                                    var prodname = $('#hiddenpostitle' + num).val();

                                       $.post('overviewcheck-515adfzx8522', 
                                        { 
                                            'ProdName': prodname

                                        },
                                        function(response) {
                                        },
                                        'json'
                                    );
                                    });
                                    $('.item-post a').colorbox({opacity:0.3, href:"../overviewa512454dzdtfa"});
                                });

                            </script>
                <?php 
                $i++;
                $j++;
                ?>
                <?php endwhile; endif; ?> 
```

因此，在 wordpress 中查询的每个帖子或产品都会发布到站点，然后 JSON 发送并创建产品 ID 的会话，然后颜色框打开它，现在它总是需要查询的最后一个帖子，我认为这是因为这`$('.item-post a').click(function() {` 是每个帖子的全局变体。

所以我想我的问题是如何制作它以便它选择为特定产品单击的图像（.item-post a），因为无论您选择哪种产品，它都只是选择每一个产品。

我希望这是有道理的，如果你能帮助我，我将不胜感激！

圣诞节快乐！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T21:47:27.790

在该事件中，`$('.item-post a').click(function() {`您可以`$(this)`使用单击的项目。

在选择器中，您可以添加`this`第二个参数以确保它从单击的项目中抓取

```
$('#hiddenpostnumfield', this) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T21:52:18.713

```
$('.item-post a').click(function() {
    $(this); //a jQuery object of the <a> element clicked
}); 
```

# javascript - 在 Ember 数据中，在两个对象之间形成关联的最佳方式是什么？

> ID：13961150
> 
> 赞同：0
> 
> 时间：2012-12-19T21:03:15.677
> 
> 标签：javascript, web-applications, ember.js, ember-data

比方说一些 DS.Model 类`Leaf`belongsTo class `Tree`，一个`Tree`hasMany `leaves`，即：

```
App.Leaf = DS.Model.extend({

    tree:   DS.belongsTo('App.Tree'),

});

App.Tree = DS.Model.extend({

    leaves:   DS.hasMany('App.Leaf'),

}) 
```

到目前为止，我正在手动操作`Tree`的叶子字段：

```
tree = App.store.create( App.Tree )
leaf = App.store.create( App.Leaf )
tree.get('leaves').pushObject( leaf )
App.store.commit() 
```

现在这似乎可行，但事情变得很奇怪：

当我检查叶子的树字段时，我看到那里有一个 App.Tree 实例，并且 id 与树的 id 匹配：

```
leaf.get('tree').get('id')  // outputs 1
tree.get('id')             // outputs 1 
```

到目前为止还可以。现在我检查树的叶子字段，我认为它是一个 Ember 可变数组，我看到了：

```
branch.get('leaves').content  // outputs [ 2 ]
leaf.get('id')                // outputs 1 
```

所以我假设叶子可变数组正在存储一个叶子ID数组，除了它的ID与叶子实例的ID不匹配。

注意当叶子的id为2时，它在branch.leaves.content字段中存储为4，如果叶子id为3，则存储的id为6，以此类推。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T03:22:11.093

在您的示例中一切正常，访问内容变量 `branch.get('leaves')`记录数组返回`clientId`对象的数组。

但是，这是一个例外，因为以任何其他方式访问属性都将透明地访问对象本身。

在您的情况下，如果您想要使用 ID`branch.get('leaves').mapProperty('id')`

# javascript - 使用电话和申请属性？

> ID：13961151
> 
> 赞同：0
> 
> 时间：2012-12-19T21:03:19.803
> 
> 标签：javascript, properties, this

假设我有一个这样的变量：

```
var a = this.property || this.parent.anotherProperty; 
```

`a`可以在使用`.call()`或`.apply()`函数时设置上下文（通过上下文我的意思是“this”，也许“范围”是一个更好的词......） ？

**编辑：**

我有一个辅助函数，它给出了一个返回值：

*   如果值是一个函数 -> value()
*   如果它不是函数 -> 值

这是代码：

```
function unwrapValue(value){
   return typeof value === 'function' ? value() : value; 
} 
```

unwrapValue 在一个普通对象（Utils）内，它是从这个对象外部调用的：

```
Utils.unwrapValue(value); 
```

现在，我`url`在函数中有一个属性（可能是函数或其他东西）：

```
this.url = this.baseUrl || this.collection.baseUrl; 
```

我不知道 this.url 是函数还是其他东西，所以我使用 unwrapValue 来获取 url 的值：

```
var params = {};
params.url = Utils.unwrapValue(this.url); 
```

问题就在这里，unwrapValue 返回 this.url 但将 'this' 设置为其他东西（我认为它是 Utils 对象，但由于某种原因它是`window`对象）所以`params.url`这`window.baseUrl || window.collection.baseUrl`不是我想要的。

如果`value`是我这样解决的函数：

```
function unwrapValue(value, context){
    if(typeof value === 'function'){
        return typeof context === 'undefined' ? value() : value.call(context);
    }else{
        return value;
    }
} 
```

因此，如果将第二个参数`context`传递给`unwrapValue`，则 value`this`将设置为`context`。

带着这个问题，我正在寻找一种`context`在这种情况下使用 aslo 的方法`value`不是这样的功能：

```
this.url = this.baseUrl || this.collection.url; 
```

只是为了澄清一点： this.baseUrl 和 this.collection.url 是简单的字符串

有办法解决吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T21:09:32.293

假设这`a`是一个函数（您的问题尚不清楚），那么您可以使用它[`Function.bind`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/bind)来设置对其进行的所有调用的上下文：

```
var a = (this.a || this.parent.a).bind(this); 
```

有关更多信息，请参阅[MDN](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/bind)和旧浏览器的 shim。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T21:21:55.810

您可能希望将对象文字作为*thisArg 传递*给该函数：

```
function fn() {
    var a = this.a || this.parent.a;
    console.log(a);
}
fn.call({
    a: false,
    parent: {
        a: "foobar"
    }
}); 
```

由于您没有传递更多参数，因此您可以使用[`apply`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/apply)as well 代替[`call`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/call).

# sql-server - 当 SQL 表不是一对一时，我如何计算准时交货

> ID：13961156
> 
> 赞同：9
> 
> 时间：2012-12-19T21:03:46.823
> 
> 标签：sql-server, sql-server-2008

我有以下两个表：

截止日期：

```
DECLARE @DueDates TABLE (
    uniqueln varchar(10),
    ship_dts smalldatetime,
    qty decimal(18,4))
INSERT INTO @DueDates
SELECT '51351621AS','1/1/2013',7
UNION ALL
SELECT '51351621AS','1/7/2013',7
UNION ALL
SELECT '51351621AS','1/14/2013',7
UNION ALL
SELECT '51351621AS','1/21/2013',7
UNION ALL
SELECT '51351621AS','1/28/2013',7
UNION ALL
SELECT 'V4351621AS','1/5/2013',10
UNION ALL
SELECT 'V4351621AS','1/10/2013',10
UNION ALL
SELECT 'V4351621AS','1/15/2013',10
UNION ALL
SELECT 'V4351621AS','1/20/2013',10
UNION ALL
SELECT 'V4351621AS','1/25/2013',10 
```

详细信息

```
DECLARE @PlDetail TABLE (
    uniqueln varchar(10),
    shipdate smalldatetime,
    shippedqty decimal(18,4))
INSERT INTO @PlDetail
SELECT '51351621AS','1/1/2013',10
UNION ALL
SELECT '51351621AS','1/7/2013',10
UNION ALL
SELECT '51351621AS','1/14/2013',10
UNION ALL
SELECT '51351621AS','1/21/2013',5
UNION ALL
SELECT 'V4351621AS','1/5/2013',13
UNION ALL
SELECT 'V4351621AS','1/15/2013',9
UNION ALL
SELECT 'V4351621AS','1/25/2013',12
UNION ALL
SELECT 'V4351621AS','1/30/2013',10
UNION ALL
SELECT 'V4351621AS','2/5/2013',6 
```

出货量`PlDetail`可以与表中的订单一一对应`DueDates`，但通常情况并非如此。

我正在尝试`uniqueln`使用一种方法计算每个计划的准时交付`FIFO`（我无法更改数据在表中的存储方式）。基本上，我想将最早的发货应用于最早的交货。

如果装运数量超过`DueDates`记录中的余额，则应将余额应用于下一次预定交货。

最终结果应如下所示：

```
uniqueln    ship_dts    qty shipdate    shippedqty  daysLate
51351621AS  1/1/2013    7   1/1/2013    7            0
51351621AS  1/7/2013    7   1/1/2013    3           -6
51351621AS  1/7/2013    7   1/7/2013    4            0
51351621AS  1/14/2013   7   1/7/2013    6           -7
51351621AS  1/14/2013   7   1/14/2013   1            0
51351621AS  1/21/2013   7   1/14/2013   7           -7
51351621AS  1/28/2013   7   1/14/2013   2           -14
51351621AS  1/28/2013   7   1/21/2013   5           -7
V4351621AS  1/5/2013    10  1/5/2013    10           0
V4351621AS  1/10/2013   10  1/5/2013    3           -5
V4351621AS  1/10/2013   10  1/15/2013   7            5
V4351621AS  1/15/2013   10  1/15/2013   2            0
V4351621AS  1/15/2013   10  1/25/2013   8           10
V4351621AS  1/20/2013   10  1/25/2013   4            5
V4351621AS  1/20/2013   10  1/30/2013   6           10
V4351621AS  1/25/2013   10  1/30/2013   4            5
V4351621AS  1/25/2013   10  2/5/2013    6           11 
```

我知道如何`PlDetail`严格按日期对货物进行分组，以便将任何在下一个到期日或之前的货物归为一组，但它必须考虑预定数量与发货数量。

我不想创建游标并循环浏览货运记录，但如果这种类型的连接不起作用，我可以。但是，我相信这是可能的，但我不确定如何对表格进行分组或加入。

听起来 SQL Server 2012 有一些新方法可以让这更容易，但现在我正在使用 SQL SERVER 2008 R2，并且必须在不久的将来保持这种状态。

解决这个问题的最佳方法是什么？光标真的是唯一的方法吗？

**更新：** 这是我到目前为止添加的内容。最终结果是一个表格，显示了每个 uniqueln 的 from 和 to qty 和 ship_dts

```
WITH DSeq AS (
   SELECT TOP 100 PERCENT
      Seq = Row_Number() OVER (partition by uniqueln ORDER BY ship_dts),
      D.UNIQUELN,
      D.SHIP_DTS,
      SchBal = (SELECT TOP 100 PERCENT SUM(B.Qty) FROM @DueDates B WHERE b.SHIP_DTS<= D.SHIP_DTS AND b.UNIQUELN=d.UNIQUELN ORDER BY d.SHIP_DTS)
   FROM @DueDates D
   GROUP BY UNIQUELN,D.QTY,D.UNIQUELN,D.SHIP_DTS
   ORDER BY D.UNIQUELN, D.SHIP_DTS
)
--SELECT * FROM DSeq
, Slices AS (
   SELECT
      LN = D.UNIQUELN,
      FromQty = COALESCE(N.SchBal,0),
      ToQty = D.SchBal,
      D.SHIP_DTS
   FROM
      DSeq D
      LEFT OUTER JOIN DSeq N
         ON D.Seq -1 = N.Seq AND D.UNIQUELN=N.UNIQUELN
)
SELECT * FROM Slices 
```

**光标方法：**

如前所述，最好的方法可能是游标。希望有人有一个可以满足所有需求的连接方法，但在那之前我们使用的是游标。

如果有人正在寻找使用游标方法的解决方案，下面的代码就是我们的做法。用户选择一个日期范围并产生结果。`uniqueln`请注意，即使在所选日期范围之前发货，您也必须为所有记录运行光标，否则`FIFO`应用发货将出错。

```
DECLARE @startdate smalldatetime, @endDate smalldatetime

DECLARE @OnTime TABLE (Uniqueln varchar(10),DueQty int,dueDate smalldatetime,shipDate smalldatetime,shipQty int DEFAULT 0,daysLate int,balQty int)

DECLARE @uniqln1 varchar(10),@toQty int, @dueDate smalldatetime,@bQty int
DECLARE @uniqln2 varchar(10),@shipQty int, @shipDate smalldatetime

DECLARE ot_cursor CURSOR LOCAL FAST_FORWARD
FOR
SELECT uniqueln,qty,ship_dts,qty
    FROM @DueDates 
    ORDER BY uniqueln,ship_dts 
OPEN ot_cursor;
FETCH NEXT FROM ot_cursor INTO @uniqln1,@toQty,@dueDate,@bQty

WHILE @@FETCH_STATUS = 0
BEGIN
    DECLARE s_cursor CURSOR LOCAL FAST_FORWARD
    FOR
    SELECT Uniqueln,shippedqty,shipdate
        FROM @PlDetail p
        WHERE uniqueln = @uniqln1
        ORDER BY 3
    OPEN s_cursor ;
    FETCH NEXT FROM s_cursor INTO @uniqln2,@shipQty,@shipDate
    WHILE @@FETCH_STATUS = 0
    BEGIN
        INSERT INTO @OnTime(Uniqueln,DueQty,dueDate,shipDate,shipQty,daysLate,balQty)
        SELECT @uniqln1,@toQty,@dueDate,@shipDate,CASE WHEN @bQty>@shipQty THEN @shipQty ELSE @bQty END,DATEDIFF(d,@dueDate,@shipDate),CASE WHEN @bQty>@shipQty THEN @bQty-@shipQty ELSE 0 END
        SET @bQty=@bQty-@shipQty
        IF @bQty < 0 
        BEGIN
            SET @shipQty = -@bQty 
            FETCH NEXT FROM ot_cursor INTO @uniqln1,@toQty,@dueDate,@bQty
        END
        ELSE 
        IF @bQty =0
        BEGIN
            BREAK
        END
        ELSE
        BEGIN
            SET @shipQty = @bQty
            FETCH NEXT FROM s_cursor INTO @uniqln2,@shipQty,@shipDate
        END
    END
    CLOSE s_cursor
    DEALLOCATE s_cursor
    FETCH NEXT FROM ot_cursor INTO @uniqln1,@toQty,@dueDate,@bQty
END
CLOSE ot_cursor
DEALLOCATE ot_cursor

SELECT * FROM @OnTime 
    WHERE shipDate BETWEEN @startdate AND @endDate
    ORDER BY Uniqueln,dueDate 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T21:40:25.787

尝试使用 CTE 和表之间的 pidgin 交叉连接将某些东西放在一起。（别问，丑）

任何人，经过一点[阅读](https://stackoverflow.com/questions/7652511/sql-server-2008-using-sum-overorder-by)，并且知道桌子有多大，我觉得用……*鼓声*……用光标来回答这个问题很安全。这将是丑陋和缓慢的，但逻辑将在纸上更有意义。关于可维护代码有很多话要说……

更新：去度假。这就是我在玩的东西。

```
DECLARE @DueDates TABLE (
    uniqueln varchar(10),
    ship_dts smalldatetime,
    qty decimal(18,4))
INSERT INTO @DueDates
SELECT '51351621AS','1/1/2013',7
UNION ALL
SELECT '51351621AS','1/7/2013',7
UNION ALL
SELECT '51351621AS','1/14/2013',7
UNION ALL
SELECT '51351621AS','1/21/2013',7
UNION ALL
SELECT '51351621AS','1/28/2013',7
UNION ALL
SELECT 'V4351621AS','1/5/2013',10
UNION ALL
SELECT 'V4351621AS','1/10/2013',10
UNION ALL
SELECT 'V4351621AS','1/15/2013',10
UNION ALL
SELECT 'V4351621AS','1/20/2013',10
UNION ALL
SELECT 'V4351621AS','1/25/2013',10

DECLARE @PlDetail TABLE (
    uniqueln varchar(10),
    shipdate smalldatetime,
    shippedqty decimal(18,4))
INSERT INTO @PlDetail
SELECT '51351621AS','1/1/2013',10
UNION ALL
SELECT '51351621AS','1/7/2013',10
UNION ALL
SELECT '51351621AS','1/14/2013',10
UNION ALL
SELECT '51351621AS','1/21/2013',5
UNION ALL
SELECT 'V4351621AS','1/5/2013',13
UNION ALL
SELECT 'V4351621AS','1/15/2013',9
UNION ALL
SELECT 'V4351621AS','1/25/2013',12
UNION ALL
SELECT 'V4351621AS','1/30/2013',10
UNION ALL
SELECT 'V4351621AS','2/5/2013',6

; WITH DueDates AS 
(
    SELECT b.*
    FROM @DueDates a
    JOIN @DueDates b
        ON a.uniqueln = b.uniqueln
        AND b.ship_dts >= a.ship_dts
)
, PlDetail AS
(
    SELECT b.*
    FROM @PlDetail a
    JOIN @PlDetail b
        ON a.uniqueln = b.uniqueln
        AND b.shipdate >= a.shipdate
)
SELECT a.uniqueln
    , SUM(a.qty) AS ordered_running_total
    , SUM(b.shippedqty) AS shipped_running_total
    , a.ship_dts
    , b.shipdate
    , SUM(b.shippedqty) - SUM(a.qty) AS leftover_running_total
FROM DueDates a
JOIN PlDetail b
    ON a.uniqueln = b.uniqueln
    AND a.ship_dts >= b.shipdate
GROUP BY a.uniqueln, a.ship_dts, b.shipdate
HAVING SUM(a.qty) <= SUM(b.shippedqty)
ORDER BY a.uniqueln, a.ship_dts, b.shipdate 
```

# java - 在 JAVA (Netbeans) 中关闭第二个 JFrame - 事件

> ID：13961157
> 
> 赞同：0
> 
> 时间：2012-12-19T21:03:52.650
> 
> 标签：java

> **可能重复：**
> [在 JAVA 中关闭 JFrame 事件 - 不起作用](https://stackoverflow.com/questions/13960824/closing-jframe-event-in-java-does-not-work)

我有 2 个 JFrame。第一个 JFrame 是我程序中的主窗口。当我们单击按钮时，会出现第二个 JFrame。当第二个 JFrame（称为设置）可见时，第一个 JFrame，主程序的窗口被禁用`setEnabled(false)`。当我关闭设置窗口时，我的主窗口没有再次启用。看我的代码。我把指令放在那里，`setEnabled(true)`所以它应该可以工作。

```
 FrameSettings.setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
    FrameSettings.addWindowStateListener( new WindowAdapter() {
        public void windowClosing(WindowEvent evt) {
            setEnabled(true);
        }
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T21:08:56.397

删除这个：

```
FrameSettings.setDefaultCloseOperation(
    javax.swing.WindowConstants.DISPOSE_ON_CLOSE); 
```

并改变这个：

```
FrameSettings.addWindowStateListener( new WindowAdapter() {
    public void windowClosing(WindowEvent evt) {
        setEnabled(true);
        FrameSettings.dispose();
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T21:31:38.257

做这个 ：

我将调用第一个 JFrame 类 mainView：

```
mainView object=new mainView();
obj.setVisible(true); 
```

此外，而不是`setEnabled(false)`在打开设置 JFrame 时将 mainView 可见性设置为 false。

您不必禁用视图。

**[编辑]**

你`setEnabled(true)`不起作用，因为你再次调用 JFrame 2。要启用 JFrame1，请创建一个对象，然后启用它。

```
JFrame1 o=new JFrame1();
o.setEnabled(true); 
```

# python - 无法通过 WMI 为 IIS7 创建应用程序/应用程序池

> ID：13961158
> 
> 赞同：0
> 
> 时间：2012-12-19T21:04:01.743
> 
> 标签：python, iis-7, wmi

环境：Windows 2008 R2 x64，IIS 7

我正在尝试将“应用程序”和“应用程序池”添加到 IIS。IIS 已配置并且运行良好。我已经手动添加了站点/应用程序 - 它们也可以正常工作。

```
import wmi

oWebAdmin = wmi.GetObject(r"winmgmts:root\WebAdministration")

strApplicationPath = "/my_site"
strSiteName = "Default Web Site"
strPhysicalPath = r"C:\Windows\SysNative\certsrv\mscep"

#fails here:
oWebAdmin.Get('Application').Create(strApplicationPath, strSiteName, strPhysicalPath)

oWebAdmin.Get("ApplicationPool").Create("NewAppPool") 
```

我得到错误：

```
Traceback (most recent call last):
  File "C:\work\selenium-project\mdm-setup-assistant\ndes\install_dnes_service.py", line 23, in <module>
    oWebAdmin.Get('Application').Create(strApplicationPath, strSiteName, strPhysicalPath)
  File "C:\Python27\lib\site-packages\win32com\client\dynamic.py", line 505, in __getattr__
    ret = self._oleobj_.Invoke(retEntry.dispid,0,invoke_type,1)
pywintypes.com_error: (-2147352567, 'Exception occurred.', (0, u'SWbemObjectEx', u'Invalid parameter ', None, 0, -2147217400), None) 
```

有趣的是，`.Create()` [msdn](http://msdn.microsoft.com/en-us/library/ms690696%28v=vs.90%29.aspx)说我输入的所有参数都是有效的。

我尝试了什么：

1）首先创建应用程序池（但是顺序无关紧要，因为我需要在创建它们时绑定它们）

```
oWebAdmin.Get("ApplicationPool").Create("NewAppPool") 
```

而且，当然，我得到了非常相似的错误：

```
Traceback (most recent call last):
  File "C:\work\selenium-project\mdm-setup-assistant\ndes\install_dnes_service.py", line 17, in <module>
    oWebAdmin.Get("ApplicationPool").Create("NewAppPool")
  File "C:\Python27\lib\site-packages\win32com\client\dynamic.py", line 505, in __getattr__
    ret = self._oleobj_.Invoke(retEntry.dispid,0,invoke_type,1)
pywintypes.com_error: (-2147352567, 'Exception occurred.', (0, u'SWbemObjectEx', u'Invalid parameter ', None, 0, -2147217400), None) 
```

2）我试图列出应用程序。这有效：

```
oApps = oWebAdmin.InstancesOf("Application")

for app in oApps:
    print app.SiteName 
    print app.Path
    print app.ApplicationPool
    print app.EnabledProtocols 
```

输出：

```
Default Web Site
/
DefaultAppPool
http

Default Web Site
/CertSrv/mscep_admin
SCEP
http

Default Web Site
/CertSrv/mscep
SCEP
http

MyApp
/
MyApp AppPool
http 
```

**我的`.Create()`电话可能有什么问题？**

注意：我正在以提升的权限运行（如果这很重要）

**更新：**可能`.Get`会失败？：不，肯定是`.Create()`：

```
app = oWebAdmin.Get('Application')

#fails here:
app.Create(strApplicationPath, strSiteName, strPhysicalPath) 
```

错误：

```
Traceback (most recent call last):
  File "C:\work\selenium-project\mdm-setup-assistant\ndes\install_dnes_service.py", line 18, in <module>
    app.Create(strApplicationPath, strSiteName, strPhysicalPath)
  File "C:\Python27\lib\site-packages\win32com\client\dynamic.py", line 505, in __getattr__
    ret = self._oleobj_.Invoke(retEntry.dispid,0,invoke_type,1)
pywintypes.com_error: (-2147352567, 'Exception occurred.', (0, u'SWbemObjectEx', u'Invalid parameter ', None, 0, -2147217400), None) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T21:17:38.560

你确定不是 GET 失败了吗？

# android - Android 上的数据持久性替代方案

> ID：13961162
> 
> 赞同：-3
> 
> 时间：2012-12-19T21:04:07.523
> 
> 标签：android, sqlite, sharedpreferences, ormlite, data-persistence

我想问一个关于android上数据持久性的建议。事情是这样的：我有一个小的rest应用程序，它从一个`RESTful API`用jackson反序列化到一个自定义对象中获取一个json数据，然后我使用这个对象为了提供我的用户界面，问题是我希望这些数据是持久的或至少是可缓存的。

我看到有一些我可以使用的选项：ORM-lite 将对象保存在 sqlite DB 或将 JSON 字符串保存到共享首选项或内存中的文件中，我已经阅读了 android 开发人员网站上的文章关于这个话题。

我的对象的结构至少有 15 个字段，并且与另一个对象相关。

哪个是一个不错的选择？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T21:10:12.340

就个人而言，我建议将 JSON 字符串保存为应用程序数据区域中的文件，至少假设它不是那么大以至于解析它很慢。通常，解析 JSON 非常快。

但是，如果您需要存储此 JSON 对象的多个版本，那么 DB 可能是最好的选择。

我不建议以这种方式使用 SharedPreferences。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T21:15:19.753

这实际上取决于其他一些变量。

Shared Preferences 非常适合可迭代的键/值对，但并不是真正为关系数据设计的。它们还旨在存储有限数量的数据，而不是任意大的数据集。例如，您可以将用户名保存在 SharedPref 中，但可能不会保存用户在每个级别中获得的每个分数的完整历史记录，或者每个级别的定义。

SQLite在关系数据方面*要*好得多，因为它是一个关系数据库，但如果您一次只想持有一个对象，它可能会过大。通常你需要设置一个内容提供者，但我认为 ORMLite 会为你处理。

所以：如果您在任何给定时间只存储此 json 对象的一个​​或两个实例，可能只是为了方便而共享首选项。如果您要存储任意数量的它们以及与之相关的数据，则 SQLite 数据库。

# php - 表单提交响应 301 或 302

> ID：13961164
> 
> 赞同：3
> 
> 时间：2012-12-19T21:04:10.910
> 
> 标签：php, http-status-code-301, http-status-code-302, http-redirect

我的网站上有一个表单，每次提交此表单时..我得到一个 301 烫发，然后是 302 重定向，然后是另一个 302 重定向。由于这些重定向，我的数据没有提交。我没有运气找到这些重定向。`.htaccess`目录的根目录中没有导致此问题的文件。

我在哪里寻找摆脱重定向？任何提示将不胜感激。

我提交时的开发人员工具转到 301、302、302。

这是我的表格的开始。

```
<form action="index.php?view=ticket_submit" method="POST" name="QContact" runat="vdaemon"> 
```

当这个提交时，我有一个案例声明寻找ticket_submit。由于 var_dump 和 exit 方法，它甚至没有到达 ticket_submit 。它只是回到根 index.php 文件。

```
private function ProcessView($type){
    $ticket = new Ticket();
    $ticket->CurrentUser = $this->CurrentUser;
    $ticket->TicketUser = $this->CurrentUser;
    $ticket->setBlankTicketHTML();
    $title = 'New ROI';
    $prior_count = count($this->Containers);
    $_SESSION['vdaemon'] = '1';
    if($_SESSION['al'] == 't' && $type['view'] == ''){
        $type['view'] = 'summary';
    }

    switch($type['view']){
        case 'ticket_edit':
            $ticket->ticketid = (int)$this->Request['ticketid'];
            $ticket->TicketUser = array();
            $ticket->fillTicket();

            if(($this->CurrentUser['userid'] != $ticket->TicketUser['userid']) && ($_SESSION['al'] == 't' || $_SESSION['al'] == 'r')){

                $ticket->setViewTicketHTML();
                $title = "Error: You can only Edit items you have created.";
                $_SESSION['vdaemon'] = '0';
            } else {
                $ticket->setEditTicketHTML();
                $title = 'Edit ROI';
                $_SESSION['vdaemon'] = '1';
            }
            break;

        case 'ticket_submit':
            var_dump('test');
            exit();
            $ticket->ticketid = (int)$this->Request['ticketid'];
            $ticket->TicketUser['useremail'] = $this->Request['useremail'];
            $ticket->saveTicket(0);
            $_SESSION['vdaemon'] = '0';             
            if($_REQUEST['viewquick'] == 'quick'){$quick = 'ticket_quick_view';}else{$quick = 'ticket_filed';}
            if($_REQUEST['edit'] == 'yes') {
                echo 'works';
            }else {
                header("Location: ?view=".$quick."&ticketid=".$ticket->ticketid);
                echo 'workss';
            }   
            exit;
            break; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T14:18:16.353

我最终修复了它，这就是原因所在。

需要修复三件事。

第一件事是我需要修复对 vdaemon 库的引用。这条路全都搞砸了。之后，我在两个地方摆脱了标头重定向。一个在单独的文件夹中，一个在我的 index.php 上，我完全错过了（以为我检查过）。它正在执行 302 重定向，因为标头在那里，但在整个服务器和 index.php 上的不同文件夹中。

下次我会知道要找什么。感谢大家在这里的努力。:)

确保在处理这些错误时首先查找此代码

```
header("Location: http://www.foo.com"); 
```

# ssh - 当有 ssh 可用时，sftp 是否总是可行的？

> ID：13961165
> 
> 赞同：0
> 
> 时间：2012-12-19T21:04:17.870
> 
> 标签：ssh, sftp

当有 ssh 可用时，是否始终可以使用 SSH（端口号 22）进行安全 FTP（sftp）？目前我正在使用 PuTTY 进行 SSH。我想使用 CuteFTP Pro 上传文件。

还是我需要在服务器端使用 ftp 服务器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T21:11:15.953

对于 sshd（OpenSSH SSH 守护程序），它是一个配置选项，默认情况下是打开的。注意线路

```
Subsystem       sftp    /usr/lib/ssh/sftp-server 
```

在 /etc/ssh/sshd_config. 要禁用只需删除该行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T21:08:00.423

不，在服务器端，您还需要一个 sftp 二进制文件。OpenSSH 提供了一个他们称之为 sftp-server 的服务器。通常驻留在 /usr/lib/openssh/sftp-server 中（例如在 Debian 机器上）

CuteFTP 支持 sftp。但请记住，您的服务器首先需要 sftp-server 。

# javascript - jQuery将url参数传递给单独的函数参数？

> ID：13961166
> 
> 赞同：0
> 
> 时间：2012-12-19T21:04:18.787
> 
> 标签：javascript, jquery, function, param

需要 JS 帮助的 PHP 开发人员！我对 JS 很陌生，无法弄清楚这一点。

我有一个小的 jQuery 插件**gSearch** [http://gsearch.scottreeddesign.com/index.html](http://gsearch.scottreeddesign.com/index.html)在您的页面中执行 Google 搜索。它不是使用 POST/GET 功能构建的，您需要在函数参数中定义“搜索词”。我正在尝试修改它。

我有 2 页：

**search.html**包含：

```
<form action="results.html">
  <input type="text" name="q" id="term">
  <input type="button" id="search_button" onclick="this.form.submit();">
</form> 
```

**results.html**包含：

```
$("#search-results").gSearch({
    search_text : 'brian griffin',
    count : 4,
    site : 'wikipedia.org',
    pagination : false  
}); 
```

在体内：

```
<div id="search-results"></div> 
```

现在我需要从表单中获取搜索词并将其作为变量传递给**.gSearch**函数。我该怎么办？我看到有关如何获取/返回 url 参数的帖子，但我似乎找不到任何解释如何将其转换为变量并将其传递给另一个函数？我可以用纯 PHP 闭着眼睛做到这一点，但我是 JS 新手！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T21:09:35.977

尝试这个

```
$('#search_button').on('click', function(e) {
    e.preventDefault();

    var $search = $('#term').val();

    // Assign it to the gSearch
    $("#search-results").gSearch({
        search_text: $search,
        count: 4,
        site: 'wikipedia.org',
        pagination: false
    });

});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T21:48:07.277

JavaScript 中没有内置的方式来读取查询字符串中的键/值对。要从查询字符串中获取值，请[解析`location.search`](https://stackoverflow.com/a/7732379/361684)：

```
var searchTerms = "";
if (/\bq=([^&]+)/.test(location.search)) {
    searchTerms = decodeURIComponent(RegExp.$1);
}
$("#search-results").gSearch({
    search_text : searchTerms,
    count : 4,
    site : 'wikipedia.org',
    pagination : false  
}); 
```

您根本无法从 JavaScript 读取 POST 值。这些仅在服务器端可用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T21:08:13.090

```
$('form').on('submit', function(e){
    e.preventDefault(); //stop default form submit
    $('#search-results').gSearch({
        search_text: $('#term').val(), //the term to search
        count: 4, //how many
        site: 'wikipedia.org', //a site to match the search against
        pagination: false //whether or not to use pagination
    }); 
}); 
```

我们捕获表单提交并使用 preventDefault() 停止它。之后，我们将 gSearch 应用于 id 的元素`search-results`（返回的结果将附加到该元素）。我们在对象请求中定义了一些参数。这应该足够了。

# jquery - 调用双击事件

> ID：13961180
> 
> 赞同：3
> 
> 时间：2012-12-19T21:05:49.223
> 
> 标签：jquery, jqgrid

如何在 jqGrid 中触发“ondblClickRow”事件？我需要在单击按钮时调用该行的双击事件处理程序。

```
button:
<a class="btn" id="shwDetails" type="button>Details</a>

grid:
$("#gridX").jqgrid({
...
...
ondblClickRow : function(rowID, iRow, iCol, e){
// event handler
fetchRowData(rowID);
}

...
...
}); 
```

以下似乎不起作用。

```
$('#gridX').trigger( 'jqGridDblClickRow' ); 
$('#gridX').trigger( 'ondblClickRow' ); 
```

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T21:35:53.667

在您的特殊情况下，您可以直接调用该函数`fetchRowData`，而不是“触发`ondblClickRow`事件”。

如果其他一些代码创建 jqGrid 并且您确实需要“触发”回调函数`ondblClickRow`（不是事件），您可以执行以下操作：

```
var ondblClickRowHandler = $("#gridX").jqGrid("getGridParam", "ondblClickRow");

ondblClickRowHandler.call($("#gridX")[0], rowID); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T21:34:54.807

ondblClickRow 是否需要这些变量中的一个、部分或全部？

```
var rowID =  ,//your rowID
    iRow =  ,//your iRow 
    iCol =  ,//your iCol
    e; 
$('#gridX').trigger( 'jqGridDblClickRow', [rowID, iRow, iCol, e]); 
```

此处的文档：http: [//api.jquery.com/trigger/](http://api.jquery.com/trigger/)

不过要小心：

> “事件对象始终作为第一个参数传递给事件处理程序，但如果在 .trigger() 调用期间指定了其他参数，这些参数也将传递给处理程序。要传递多个参数，请使用一个数组，如此处所示。从 jQuery 1.6.2 开始，可以在不使用数组的情况下传递单个参数。”

# sql - 从列值中删除多余的空间

> ID：13961188
> 
> 赞同：1
> 
> 时间：2012-12-19T21:06:18.487
> 
> 标签：sql, oracle11g

我在 Oracle 数据库中有一个列，其中存储了连接值。例如，

```
/uk/letters/default?/uk/letters/funny_letters? 
/uk/letters/letters?/library/conditionalstyle?o=3&f=11/uk/letters/funny_letters?    
/uk/workinglife/viewarticle_93?/library/conditionalstyle?/uk/financialcentre/car_tax_calculator?
/uk/job-hunting/default?/partners/msn/i-resignfinctr?/uk/letters/letters?/ 
```

在网址之间，有一些空格。我怎样才能删除它们？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T21:08:55.557

```
UPDATE YourTable
SET YourColumn = REPLACE(YourColumn, ' ', '') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-09-27T23:21:26.580

这为时已晚，但会帮助一些人。

```
select regexp_replace(column_name, '[[:space:]]+', chr(32))  from table_name; 
```

验证后，可以如下更新表格；

```
UPDATE table_name
SET column_name = REGEXP_REPLACE (column_name ,'[[:space:]]+',' '); 
```

# nlp - 所有问题的列表以及 StackOverflow 上的标签（用于 NLP 任务）

> ID：13961190
> 
> 赞同：1
> 
> 时间：2012-12-19T21:06:26.650
> 
> 标签：nlp

由于 StackOverflow 带有大量问题和用户提供的标签，我将其视为用于 NLP（自然语言处理）任务的有趣、丰富注释的文本语料库。

基本上，我想**根据问题 body 自动预测问题标签**。我相信这可以在一定程度上做到这一点，并且有许多很好的用例，例如标签建议（例如，使标签使用更加一致），仅举一个例子。

为此，我需要很多 - 甚至更好： - 所有问题以及它们的正文和用户标签来训练带有机器学习算法**的标签预测器。**

我知道有 StackOverflow API，但我可以通过它获取的数据量似乎非常有限 - 当然有充分的理由。

**所以问题是**：有没有办法从 StackOverflow 获取/下载所有问题及其用户标签？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T21:17:30.447

[您可以在http://www.clearbits.net/torrents/2076-aug-2012](http://www.clearbits.net/torrents/2076-aug-2012)获取数据转储，没有元站点，这是一个小疏忽，已通过替代版本修复，但不适用于您的请求。

# ruby-on-rails - 如何在 Rails 中为联系表单设置邮件传递？

> ID：13961194
> 
> 赞同：1
> 
> 时间：2012-12-19T21:07:12.353
> 
> 标签：ruby-on-rails, forms, actionmailer

我正在尝试使用我在[Railscast 中看到的关于 ActiveAttr](http://railscasts.com/episodes/326-activeattr?view=asciicast)的方法构建联系表单（这给了我一个不受数据库支持的消息模型）。

此代码位于消息的控制器中：

```
class MessagesController < ApplicationController
  def new
    @message = Message.new
  end

  def create
   @message = Message.new(params[:message])
   if @message.valid?
     # TODO send message here
     redirect_to root_url, notice: "Message sent! Thank you for contacting us."
   else
     render "new"
   end
  end
end 
```

我不知道我需要编写什么样的代码才能在`create`操作期间将联系表单输入（消息）发送到特定的电子邮件地址。有人能给我大致了解一下我需要知道或需要设置什么才能完成这项工作吗？谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T21:44:05.557

你可以添加这样的东西。

```
def create
  @message = Message.new(params[:message])
  if @message.valid?
    UserMailer.send_message(@message).deliver
    redirect_to whatever_path, notice: "Message sent."
  else
    render "new"
  end
end 
```

您将需要创建一个邮件程序。这很容易，Rails 已经有一个很好的指南来说明如何做到这一点。[http://guides.rubyonrails.org/action_mailer_basics.html](http://guides.rubyonrails.org/action_mailer_basics.html)

创建邮件程序

`rails generate mailer UserMailer`

然后在你的 UserMailer`app\mailers\user_mailer.rb`

```
def send_message(message)
  @message = message
  email = "myemail@example.com"
  mail to: email, subject: "You have received a message"
end 
```

然后创建您的电子邮件视图`app\views\user_mailer.txt.erb`

```
You have a new message

Your message says

<%= @message.whatever_attribute %> 
```

# php - 建立会话来调用 URL？

> ID：13961197
> 
> 赞同：1
> 
> 时间：2012-12-19T21:07:25.257
> 
> 标签：php, session, post, curl, whmcs

我正在寻找如何通过 PHP 与我们的计费软件 (WHMCS) 建立会话，以便我可以调用仅对登录管理员可用的 URL。我不相信我可以将登录数据和参数都传递给 URL，所以我相信必须首先进行会话，然后调用 URL。

系统中的实际 php 已编码，但从查看源代码来看，它看起来如下...

```
<form action="dologin.php" method="post" name="frmlogin" id="frmlogin">
  <table width="100%" border="0" cellspacing="0" cellpadding="5">
    <tr>
      <td width="30%" align="right" valign="middle"><strong>Username</strong></td>
      <td align="left" valign="middle"><input type="text" name="username" size="30" class="login_inputs" /></td>
    </tr>
    <tr>
      <td width="30%" align="right" valign="middle"><strong>Password</strong></td>
      <td align="left" valign="middle"><input type="password" name="password" size="30" class="login_inputs" /></td>
    </tr>
    <tr>
      <td width="30%" align="right" valign="middle"><input type="checkbox" name="rememberme" id="rememberme" /></td>
      <td align="left" valign="middle"><label for="rememberme" style="cursor:hand">Remember me until I logout.</label></td>
    </tr>
    <tr>
      <td width="30%" align="right" valign="middle">&nbsp;</td>
      <td align="left" valign="middle"><table width="100%" cellpadding="0" cellspacing="0"><tr><td><input type="submit" value="Login" class="button" /></td><td align="right">Language: <select name="language" class="login_inputs"><option value="">Default</option><option value="czech">Czech</option><option value="english">English</option><option value="french">French</option><option value="portugues">Portugues</option></select></td></tr></table></td>
    </tr>
  </table>
</form> 
```

我是否应该能够像下面这样进行 CURL 调用，然后调用 URL？

```
$url = "https://clients.website.com/admincp/dologin.php";
$username = "admin";
$password = "239asd90";

$postfields = array();
$postfields["username"] = $username;
$postfields["password"] = md5($password);

$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, $url);
curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_TIMEOUT, 30);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_POSTFIELDS, $query_string);
curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 0);
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, 0);
curl_exec($ch);

if (curl_error($ch)) die("Connection Error: ".curl_errno($ch).' - '.curl_error($ch));
curl_close($ch); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T21:14:41.617

会话实现通常使用存储在 cookie 中的唯一哈希。然后在每个后续请求中发送该 cookie，以识别用户的会话。

您需要做的是在执行登录过程时捕获该 cookie 及其值。然后在登录区域内的页面请求中，您还需要将会话 cookie 添加到 curl 调用中。

# c# - 在面板中放置标签 winforms

> ID：13961198
> 
> 赞同：2
> 
> 时间：2012-12-19T21:07:26.147
> 
> 标签：c#, winforms, visual-studio-2010, panel

我在 winforms 应用程序中有一个面板，我想在其中以垂直对齐方式显示一些数据。我将从 XML 文档中获取该数据。我将像这样遍历 XML：

```
for (int i = 0; i < node.ChildNodes.Count; i++)
{
    lbl = new Label();
    lbl.Text = node.ChildNodes[i].Name + " = " + node.ChildNodes[i].InnerText;
    panel1.Controls.Add(lbl);
} 
```

最后，我只能看到面板左上角显示的第一条记录，但循环显示`panel1.controls`，我可以看到计数是 79，我只需要正确定位它们。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T21:10:14.513

您可以改用[FlowLayoutPanel](http://msdn.microsoft.com/en-us/library/system.windows.forms.flowlayoutpanel.aspx)并将其[FlowDirection](http://msdn.microsoft.com/en-us/library/system.windows.forms.flowdirection.aspx)属性设置为`TopDown`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T21:14:03.033

*   用`FlowLayoutPanel`它代替它。

*   将`FlowDirection`属性设置为`TopDown`。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-19T21:11:46.023

您只需要设置标签对象的顶部和/或左侧属性。

```
for (int i = 0; i < node.ChildNodes.Count; i++)
            {

                lbl = new Label();
                lbl.Text = node.ChildNodes[i].Name + " = " + node.ChildNodes[i].InnerText;
                lbl.top = 15 * i;
                panel1.Controls.Add(lbl);
} 
```

# .net - CLR 中的本机浮点类型使用

> ID：13961205
> 
> 赞同：11
> 
> 时间：2012-12-19T21:07:50.453
> 
> 标签：.net, cil

我发现 CIL 编译器允许 type `native float`. 但是，CLR 不允许这样做。它有什么用处吗？它的大小是多少？是否有对应的 .NET 类型？我试图将它实现为伪原始类型：

```
.class public sequential ansi serializable sealed beforefieldinit NativeFloat
  extends System.ValueType
{
  .field assembly native float m_value
} 
```

但是，CLR 不支持这种类型。感谢您的帮助。

编辑：如果你有兴趣，它的 CorElementType 是 26 (0x1a, R)。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-19T21:37:08.427

来自 CIL ECMA 规范，[I.12.1.1 原生大小：原生 int、原生 unsigned int、O 和 &](http://www.ecma-international.org/publications/files/ECMA-ST/ECMA-335.pdf)：

> 本机大小类型（本机 int、本机 unsigned int、O 和 &）是 CLI 中用于延迟选择值大小的一种机制。这些数据类型作为 CIL 类型存在；但是，CLI 将每个映射到特定处理器的本机大小。（例如，数据类型在 Pentium 处理器上映射到 int32，但在 IA64 处理器上映射到 int64。）因此，大小的选择推迟到 JIT 编译或运行时，此时 CLI 已初始化并且架构已知. 这意味着字段和堆栈帧偏移量在编译时也是未知的。

现在，话虽如此，`native float`（相对于`native int`）在 ECMA 规范中没有一次提及。我能找到的唯一证据是在一些开源 CIL 汇编器中，它们会抛出异常，指出它们无法为`native float`.

如果微软的 CIL 编译器确实接受这种类型，我想这是微软打算实现的功能，但最终没有放入 MSIL（CIL 的前身）。此外，如果汇编程序确实生成了操作码而不是错误消息，我可以想象（尽管这也是推测）可能存在 Microsoft 的 CLR 的变体（可能是 .NET Micro Framework 或特定版本的 Silverlight，或其他东西）支持操作码。

另请注意，在上面的规范中，提到了 CLI。CLR 只是 Microsoft 对 CLI 的实现。

ECMA 规范*确实*提到了本机浮点类型，但它不是`native float`：

> F，浮点值（float32、float64 或底层硬件支持的其他表示）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-19T21:45:08.880

CLI 规范 Ecma 335 定义了*三种*浮点类型。Float32、float64 和 F。前两个是*名义*类型，第三个是*表示*类型，即 IL 中的“本机浮点”类型。

第 I.12.1.3 节，“浮点数据类型的处理”给出了理由：

> 浮点数（静态、数组元素和类的字段）的存储位置是固定大小的。支持的存储大小为 float32 和 float64。在其他任何地方（在评估堆栈上，作为参数、作为返回类型和作为局部变量）浮点数都使用内部浮点类型表示。在每个这样的实例中，变量或表达式的标称类型是 float32 或 float64，但其值可以在内部用额外的范围和/或精度表示。内部浮点表示的大小取决于实现，可以变化，并且应具有至少与所表示的变量或表达式一样大的精度。

这在当前的抖动实现中实际上并不存在，参数和局部变量实际上是 float32 或 float64。但它有*一些*先例，他们首先考虑这一点的可能原因是，英特尔处理器中的内部 FPU 寄存器是 80 位的。这是许多个月前英特尔设计 8087 协处理器时做出的设计决定。

这个想法在纸面上听起来非常好，它允许更精确地存储中间计算结果，以便计算的最终结果更准确。然而，毫无疑问，英特尔犯了十亿美元的错误，FPU 无​​法优化并且仍然允许一致的浮点结果。问题是内部 FPU 寄存器是有限的资源，只有 8 个。它也被实现为堆栈，处理起来很尴尬。如果涉及计算，则不可避免地需要将中间结果溢出到内存中。将 80 位值截断为 64 位。如果计算容易丢失很多有效数字，那么对代码的微小更改会在计算结果中产生很大差异。或者一般来说让程序员感到不安，因为第 16 位数字不是

好吧，这是一个大错误，也是 SO 大量问题的根源。当英特尔实现下一代浮点硬件时，这个想法被废弃了，XMM 和 YMM 寄存器是 64 位的。真正的寄存器，而不是堆栈。x64 抖动使用它们。让您的程序在 64 位模式下运行会产生与在 32 位模式下运行时不同的结果。还需要十年时间才能停止伤害。

# vb.net - 64 位系统选项显式打开

> ID：13961209
> 
> 赞同：1
> 
> 时间：2012-12-19T21:07:57.473
> 
> 标签：vb.net, 64-bit

我有一个 64 位系统。我将我的变量声明为 64 位变量，希望我的代码运行得更快。当我执行诸如 'String.IndexOf("J", X)' 之类的函数时，它会失败，因为 X 是 Long 但它正在寻找 32位值作为起始索引。

有什么方法可以传递 64 位变量而不将其转换为 32 位？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T21:30:00.453

你对 64 位代码有错误的想法。String.IndexOf() 方法的参数不变，第二个参数仍然是一个整数。.NET 中唯一改变大小的类型是 IntPtr。

这完全是设计使然。当您让64 位处理器处理 64 位整数值时，它*不会更快地执行代码。*恰恰相反，它使它运行*得更慢*。处理器速度在很大程度上受到缓存大小的限制。CPU 缓存很重要，因为它们有助于避免处理器必须从 RAM 读取或写入数据。与处理器的速度相比，这非常慢。由于 L1、L2 或 L3 高速缓存中没有数据而导致的最坏情况处理器停顿可能是 200 个周期。

缓存大小是固定的。使用 64 位变量可使缓存的效率减半。

您还可以使用 Long 和 Option Strict Off 使代码变慢。这需要编译器发出转换以将 Long 转换为 Integer。它在您的代码中不可见，但它肯定会执行，当您使用 ildasm.exe 或反编译器（如 ILSpy 或 Reflector）查看 IL 时，您可以看到它。

# c# - 断丝带 - 一切都在消失

> ID：13961210
> 
> 赞同：3
> 
> 时间：2012-12-19T21:07:58.877
> 
> 标签：c#, visual-studio, ribbon

我正在尝试在我的应用程序中使用功能区。

我使用 Visual Studio 2012 在 CodeProject 上遵循[了本教程。](http://www.codeproject.com/Articles/364272/Easily-Add-a-Ribbon-into-a-WinForms-Application-Cs)

在我编译项目之前一切正常。

如果我关闭表单设计，那么 Visual Studio 会给我这个错误：

> 没有可用于此错误的堆栈跟踪或错误行信息

接下来，功能区中的所有面板和选项卡都会消失。保存解决方案或关闭表单都没有关系。

我使用 CodeProject 中的示例进行尝试，并将其放入我的项目中，但都以这个错误结束。

是否有可能清除此错误？或者你知道丝带的另一种解决方案吗？

# c - 我如何用 avrdude 擦除除 EEPROM 之外的所有内容？

> ID：13961212
> 
> 赞同：2
> 
> 时间：2012-12-19T21:08:00.580
> 
> 标签：c, avr, jtag, eeprom, avrdude

我有2个主要文件。一个写入 EEPROM，另一个从 EEPROM 读取。我想做以下事情：

*   Flash main.hex（写入 EEPROM 的那个）
*   擦除除 EEPROM 内容外的所有内容
*   Flash main.hex（从 EEPROM 读取的那个）

我在 Windows 7 上将**AT90CAN128**与**JTAG ICE mkII**
一起使用。 我通过以下方式执行 avrdude：

```
avrdude -c jtag2 -p c128 -P usb -U flash:w:main.hex 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T21:15:17.723

您可以清除 EESAVE 保险丝。启用此功能后，芯片擦除命令将不会擦除 EEPROM。

# java - Java SWT 图像调整大小不起作用

> ID：13961218
> 
> 赞同：1
> 
> 时间：2012-12-19T21:08:50.517
> 
> 标签：java, image, swt

我正在尝试调整图片大小并保存它，但是我保存的图片没有调整大小。

这是我尝试使用的代码。

```
if(CC_Files.fileExists(path)){
                if(path.contains(".jpg") || path.contains(".png") || path.contains(".gif") ){
                Image image = (Image) SWTResourceManager
                        .getImage(path);
                ImageData imgData = image.getImageData();
                imgData.scaledTo(150, 150);
                ImageLoader imageLoader = new ImageLoader();
                imageLoader.data = new ImageData[] {imgData};
                imageLoader.save(Variables.getStrResources() + "\\Pics\\" + a.getHerd_id() + ".jpg",SWT.IMAGE_JPEG);
    }      
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T21:12:17.180

您的问题是您没有阅读所写的 JavaDoc

`ImageData#scaledTo(int width, int height) - Returns a copy of the receiver which has been stretched or shrunk to the specified size.`

所以解决方案是：

`imgData = imgData.scaledTo(150, 150);`

[文档](http://help.eclipse.org/indigo/index.jsp?topic=%2Forg.eclipse.platform.doc.isv%2Freference%2Fapi%2Forg%2Feclipse%2Fswt%2Fgraphics%2FImageData.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-02-02T13:35:16.290

> Java SWT Image Resize 正常工作

ImageLoader 类用于从文件或流中加载图像并将图像保存到文件或流中

```
imageLoader.save(result, SWT.IMAGE_COPY) 
```

* * *

FileDialog 类允许用户浏览文件系统并选择或输入文件名。

```
Button btnOpen = new Button(parent, SWT.NONE);
btnOpen.setBounds(200, 55, 68, 23);
btnOpen.addSelectionListener(new SelectionAdapter() {
    @Override
    public void widgetSelected(SelectionEvent e) {

          FileDialog dialog = new FileDialog(PlatformUI.getWorkbench().getActiveWorkbenchWindow().getShell(), SWT.OPEN);
          String result = dialog.open();

           if(result!=null)
           {
               Image image=SWTResourceManager.getImage(result);
               //ImageData class are device-independent descriptions of images
               ImageData imgData = image.getImageData();
               imgData=imgData.scaledTo(200, 200);

               ImageLoader imageLoader = new ImageLoader();
               imageLoader.data = new ImageData[] {imgData};
               imageLoader.save(result, SWT.IMAGE_COPY);

               System.out.println("Width: "+imgData.width+".....Height: "+imgData.height);
               lbl_image_text.setBounds(25,88,imgData.width+10,imgData.height+10);
               lbl_image_text.setImage(SWTResourceManager.getImage(result));
           }
    }
});
btnOpen.setText("open");
CLabel lbl_image_text = new CLabel(parent, SWT.Resize); 
```

图像大小设置为动态标签

```
Button btnOpen = new Button(parent, SWT.NONE);
btnOpen.setBounds(200, 55, 68, 23);
btnOpen.addSelectionListener(new SelectionAdapter() {
    @Override
    public void widgetSelected(SelectionEvent e) {

          FileDialog dialog = new FileDialog(PlatformUI.getWorkbench().getActiveWorkbenchWindow().getShell(), SWT.OPEN);
          String result = dialog.open();

           if(result!=null)
           {

               Image image=SWTResourceManager.getImage(result);
               //get Image width and height
               lbl_image_text.setBounds(25,88,image.getBounds().width+10,image.getBounds().height+10);
               lbl_image_text.setImage(SWTResourceManager.getImage(result));
           }
    }
});
btnOpen.setText("open");
CLabel lbl_image_text = new CLabel(parent, SWT.Resize); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-12T04:19:12.430

从 SWT.addListener(SWT.Close, new CustomShellCloseListener()) 调用此方法。需要传递的 Tha 参数是 LabelImage（不使用 Label.getImage() ，传递直接路径）、label.getBounds.width 、label.getBounds.height

```
protected Image resize(Image imageFromSource, int width, int height) {
    if(width>0 && height>0){
        Image scaledImage = new Image(shellCCMPFMatrixBomCompare.getDisplay(), width, height);
        GC gc = new GC(scaledImage);            //Graphics Capabilities(GC instance) in SWT used to draw an Image, graphics, display
        gc.setAntialias(SWT.ON);        // Anti aliasing is used for making the low resolution image to redraw and make into a good resolution Image
        gc.setInterpolation(SWT.HIGH);      //Interpolation is based in the Graphics, it may not work properly in some systems
        gc.drawImage(imageFromSource, 0, 0, 
                imageFromSource.getBounds().width, imageFromSource.getBounds().height, 
                0, 0, width, height);       

        /*drawImage(Image image, int srcX, int srcY, int srcWidth, int srcHeight, int destX, int destY, int destWidth, int destHeight)
        Copies a rectangular area from the source image into a (potentially different sized) rectangular area in the receiver.*/

        gc.dispose();
        return scaledImage;
        }
        else return imageFromSource;
} 
```

# android - 在边界内平移/缩放位图？

> ID：13961223
> 
> 赞同：6
> 
> 时间：2012-12-19T21:09:04.573
> 
> 标签：android

当我研究在图像上触摸平移/缩放的方法时，我通常会发现有效、简单的代码——但没有什么能完全满足我的需求。图像不需要在实际图像（位图）的边缘与其视图之间显示空白区域。如果位图是 200x100 而视图是 50x50，用户应该只能缩小到 100x50，允许他们水平滑动图像，但不能垂直滑动。

我的代码在移动（翻译）图像时做得很好——直到图像被缩放。然后有些东西被扔掉了；我可以将位图移动得足够远以看到它周围的间隙。这可能是与当前比例因子分解像素测量相关的简单而明显的事情，但我找不到它。我怀疑这与下面 onDraw() 中 maxX 和 maxY 的计算有关。有任何想法吗？

```
import android.content.Context;
import android.graphics.Bitmap;
import android.graphics.Canvas;
import android.graphics.drawable.BitmapDrawable;
import android.graphics.drawable.Drawable;
import android.util.AttributeSet;
import android.util.Log;
import android.view.MotionEvent;
import android.view.ScaleGestureDetector;
import android.widget.ImageView;

/**
 * Most code from
 * http://android-developers.blogspot.com/2010/06/making-sense-of-multitouch.html
 * 
 * @author Chad Schultz
 * 
 */
public class PanZoomImageView extends ImageView {

    public static final String TAG = PanZoomImageView.class.getName();

    private static final int INVALID_POINTER_ID = -1;

    // The ‘active pointer’ is the one currently moving our object.
    private int mActivePointerId = INVALID_POINTER_ID;

    private Bitmap bitmap;

    private ScaleGestureDetector mScaleDetector;
    private float mScaleFactor = 1.f;
    private float minScaleFactor;

    private float mPosX;
    private float mPosY;

    private float mLastTouchX, mLastTouchY;

    private boolean firstDraw = true;

    private boolean panEnabled = true;
    private boolean zoomEnabled = true;

    public PanZoomImageView(Context context) {
        super(context);
        setup();
    }

    public PanZoomImageView(Context context, AttributeSet attrs, int defStyle) {
        super(context, attrs, defStyle);
        setup();
    }

    public PanZoomImageView(Context context, AttributeSet attrs) {
        super(context, attrs);
        setup();
    }

    private void setup() {
        mScaleDetector = new ScaleGestureDetector(getContext(), new ScaleListener());
    }

    @Override
    public void setImageBitmap(Bitmap bmp) {
        super.setImageBitmap(bmp);
        bitmap = bmp;
        firstDraw = true;
    }

    @Override
    public void setImageDrawable(Drawable drawable) {
        super.setImageDrawable(drawable);
        bitmap = ((BitmapDrawable) drawable).getBitmap();
        firstDraw = true;
    }

    public void onDraw(Canvas canvas) {
        Log.v(TAG, "onDraw()");
        if (bitmap == null) {
            Log.w(TAG, "nothing to draw - bitmap is null");
            super.onDraw(canvas);
            return;
        }

        if (firstDraw 
                && (bitmap.getHeight() > 0) 
                && (bitmap.getWidth() > 0) 
                && (canvas.getHeight() > 0) 
                && (canvas.getWidth() > 0)) {
            //Don't let the user zoom out so much that the image is smaller
            //than its containing frame
            float minXScaleFactor = (float) canvas.getWidth() / (float) bitmap.getWidth();
            float minYScaleFactor = (float) canvas.getHeight() / (float) bitmap.getHeight();
            minScaleFactor = Math.max(minXScaleFactor, minYScaleFactor);
            Log.d(TAG, "minScaleFactor: " + minScaleFactor);
            firstDraw = false;
        }
        mScaleFactor = Math.max(mScaleFactor, minScaleFactor);
        Log.d(TAG, "mScaleFactor: " + mScaleFactor);

        //Save the canvas without translating (panning) or scaling (zooming)
        //After each change, restore to this state, instead of compounding
        //changes upon changes
        canvas.save();

        int maxX, minX, maxY, minY;
        //How far can we move the image horizontally without having a gap between image and frame?
        maxX = (int) (mScaleFactor * (bitmap.getWidth() / 2) - (canvas.getWidth() / 2));
        minX = -1 * maxX;
        //How far can we move the image vertically without having a gap between image and frame?
        maxY = (int) (mScaleFactor * (bitmap.getHeight() / 2) - (canvas.getWidth() / 2));
        minY = -1 * maxY;
        //Do not go beyond the boundaries of the image
        if (mPosX > maxX) {
            mPosX = maxX;
        }
        if (mPosX < minX) {
            mPosX = minX;
        }
        if (mPosY > maxY) {
            mPosY = maxY;
        }
        if (mPosY < minY) {
            mPosY = minY;
        }

        Log.d(TAG, "canvas width: " + canvas.getWidth() + " canvas height: "
                + canvas.getHeight());
        Log.d(TAG, "bitmap width: " + bitmap.getWidth() + " height: " + bitmap.getHeight());
        Log.d(TAG, "translating mPosX: " + mPosX + " mPosY: " + mPosY);

        if (zoomEnabled) {
            Log.d(TAG, "zooming to scale factor of " + mScaleFactor);
            canvas.scale(mScaleFactor, mScaleFactor);
        } else {
            Log.d(TAG, "zooming disabled");
        }

        if (panEnabled) {
            Log.d(TAG, "panning to " + mPosX + "," + mPosY); 
            canvas.translate(mPosX, mPosY);
        } else {
            Log.d(TAG, "panning disabled");
        }

        super.onDraw(canvas);
        canvas.restore(); //clear translation/scaling
    }

    @Override
    public boolean onTouchEvent(MotionEvent ev) {
        // Let the ScaleGestureDetector inspect all events.
        mScaleDetector.onTouchEvent(ev);

        final int action = ev.getAction();
        switch (action & MotionEvent.ACTION_MASK) {
            case MotionEvent.ACTION_DOWN: {
                final float x = ev.getX();
                final float y = ev.getY();

                mLastTouchX = x;
                mLastTouchY = y;
                mActivePointerId = ev.getPointerId(0);
                break;
            }

            case MotionEvent.ACTION_MOVE: {
                final int pointerIndex = ev.findPointerIndex(mActivePointerId);
                final float x = ev.getX(pointerIndex);
                final float y = ev.getY(pointerIndex);

                // Only move if the ScaleGestureDetector isn't processing a gesture.
                if (!mScaleDetector.isInProgress()) {
                    float dx = x - mLastTouchX;
                    float dy = y - mLastTouchY;

                    //Adjust for zoom factor. Otherwise, the user's finger moving 10 pixels
                    //at 200% zoom causes the image to slide 20 pixels instead of perfectly
                    //following the user's touch
                    dx /= mScaleFactor;
                    dy /= mScaleFactor;

                    mPosX += dx;
                    mPosY += dy;

                    invalidate();
                }

                mLastTouchX = x;
                mLastTouchY = y;

                break;
            }

            case MotionEvent.ACTION_UP: {
                mActivePointerId = INVALID_POINTER_ID;
                break;
            }

            case MotionEvent.ACTION_CANCEL: {
                mActivePointerId = INVALID_POINTER_ID;
                break;
            }

            case MotionEvent.ACTION_POINTER_UP: {
                final int pointerIndex = (ev.getAction() & MotionEvent.ACTION_POINTER_INDEX_MASK) >> MotionEvent.ACTION_POINTER_INDEX_SHIFT;
                final int pointerId = ev.getPointerId(pointerIndex);
                if (pointerId == mActivePointerId) {
                    // This was our active pointer going up. Choose a new
                    // active pointer and adjust accordingly.
                    final int newPointerIndex = pointerIndex == 0 ? 1 : 0;
                    mLastTouchX = ev.getX(newPointerIndex);
                    mLastTouchY = ev.getY(newPointerIndex);
                    mActivePointerId = ev.getPointerId(newPointerIndex);
                }
                break;
            }
        }

        return true;
    }

    private class ScaleListener extends
            ScaleGestureDetector.SimpleOnScaleGestureListener {
        @Override
        public boolean onScale(ScaleGestureDetector detector) {
            mScaleFactor *= detector.getScaleFactor();
            // Don't let the object get too small or too large.
            mScaleFactor = Math.max(0.1f, Math.min(mScaleFactor, 5.0f));
            Log.d(TAG, "detector scale factor: " + detector.getScaleFactor() + " mscalefactor: " + mScaleFactor);

            invalidate();
            return true;
        }
    }

    //Currently zoomEnabled/panEnabled can only be set programmatically, not in XML

    public boolean isPanEnabled() {
        return panEnabled;
    }

    public void setPanEnabled(boolean panEnabled) {
        this.panEnabled = panEnabled;
    }

    public boolean isZoomEnabled() {
        return zoomEnabled;
    }

    public void setZoomEnabled(boolean zoomEnabled) {
        this.zoomEnabled = zoomEnabled;
    }

} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-04T04:18:00.763

这是我在经过大量痛苦的实验后最终自己想出的东西——在 Android 中如何处理位图的过程中学习了一些有趣的东西。这段代码远非完美，但它适合我的目的——希望它也能帮助其他人。

```
import android.content.Context;
import android.graphics.Bitmap;
import android.graphics.Canvas;
import android.graphics.drawable.BitmapDrawable;
import android.graphics.drawable.Drawable;
import android.util.AttributeSet;
import android.util.Log;
import android.view.MotionEvent;
import android.view.ScaleGestureDetector;
import android.view.View;

/**
 * @author Chad Schultz
 * @version 1
 */
public class PanZoomView extends View {

    public static final String TAG = PanZoomView.class.getName();

    private static final int INVALID_POINTER_ID = -1;

    // The ‘active pointer’ is the one currently moving our object.
    private int mActivePointerId = INVALID_POINTER_ID;

    private Bitmap bitmap;
    private float viewHeight;
    private float viewWidth;
    float canvasWidth, canvasHeight;

    private ScaleGestureDetector mScaleDetector;
    private float mScaleFactor = 1.f;
    private float minScaleFactor;

    private float mPosX;
    private float mPosY;

    private float mLastTouchX, mLastTouchY;

    private boolean firstDraw = true;

    private boolean panEnabled = true;
    private boolean zoomEnabled = true;

    public PanZoomView(Context context) {
        super(context);
        setup();
    }

    public PanZoomView(Context context, AttributeSet attrs, int defStyle) {
        super(context, attrs, defStyle);
        setup();
    }

    public PanZoomView(Context context, AttributeSet attrs) {
        super(context, attrs);
        setup();
    }

    private void setup() {
        mScaleDetector = new ScaleGestureDetector(getContext(), new ScaleListener());
    }

    public void setBitmap(Bitmap bmp) {
        setImageBitmap(bmp);
    }

    public void setImageBitmap(Bitmap bmp) {
        bitmap = bmp;
        resetZoom();
        resetPan();
        firstDraw = true;
        invalidate();
    }

    public Bitmap getImageBitmap() {
        return bitmap;
    }

    public Bitmap getBitmap() {
        return getImageBitmap();
    }

    public void resetZoom() {
        mScaleFactor = 1.0f;
    }

    public void resetPan() {
        mPosX = 0f;
        mPosY = 0f;
    }

    public void setImageDrawable(Drawable drawable) {
        setImageBitmap(((BitmapDrawable) drawable).getBitmap());
    }

    public BitmapDrawable getImageDrawable() {
        BitmapDrawable bd = new BitmapDrawable(getContext().getResources(), bitmap);
        return bd;
    }

    public BitmapDrawable getDrawable() {
        return getImageDrawable();
    }

    public void onDraw(Canvas canvas) {
//      Log.v(TAG, "onDraw()");

        if (bitmap == null) {
            Log.w(TAG, "nothing to draw - bitmap is null");
            super.onDraw(canvas);
            return;
        }

        if (firstDraw 
                && (bitmap.getHeight() > 0) 
                && (bitmap.getWidth() > 0)) {
            //Don't let the user zoom out so much that the image is smaller
            //than its containing frame
            float minXScaleFactor = (float) viewWidth / (float) bitmap.getWidth();
            float minYScaleFactor = (float) viewHeight / (float) bitmap.getHeight();
            minScaleFactor = Math.max(minXScaleFactor, minYScaleFactor);
            Log.d(TAG, "minScaleFactor: " + minScaleFactor);
            mScaleFactor = minScaleFactor; //start out "zoomed out" all the way

            mPosX = mPosY = 0;
            firstDraw = false;

        }
        mScaleFactor = Math.max(mScaleFactor, minScaleFactor);

        canvasHeight = canvas.getHeight();
        canvasWidth = canvas.getWidth();
//      Log.d(TAG, "canvas density: " + canvas.getDensity() + " bitmap density: " + bitmap.getDensity());

//      Log.d(TAG, "mScaleFactor: " + mScaleFactor);

        //Save the canvas without translating (panning) or scaling (zooming)
        //After each change, restore to this state, instead of compounding
        //changes upon changes
        canvas.save();
        int maxX, minX, maxY, minY;
        //Regardless of the screen density (HDPI, MDPI) or the scale factor, 
        //The image always consists of bitmap width divided by 2 pixels. If an image
        //is 200 pixels wide and you scroll right 100 pixels, you just scrolled the image
        //off the screen to the left.
        minX = (int) (((viewWidth / mScaleFactor) - bitmap.getWidth()) / 2);
        maxX = 0;
        //How far can we move the image vertically without having a gap between image and frame?
        minY = (int) (((viewHeight / mScaleFactor) - bitmap.getHeight()) / 2);
        maxY = 0;
        Log.d(TAG, "minX: " + minX + " maxX: " + maxX + " minY: " + minY + " maxY: " + maxY);
        //Do not go beyond the boundaries of the image
        if (mPosX > maxX) {
            mPosX = maxX;
        }
        if (mPosX < minX) {
            mPosX = minX;
        }
        if (mPosY > maxY) {
            mPosY = maxY;
        }
        if (mPosY < minY) {
            mPosY = minY;
        }

//      Log.d(TAG, "view width: " + viewWidth + " view height: "
//              + viewHeight);
//      Log.d(TAG, "bitmap width: " + bitmap.getWidth() + " height: " + bitmap.getHeight());
//      Log.d(TAG, "translating mPosX: " + mPosX + " mPosY: " + mPosY);

//      Log.d(TAG, "zooming to scale factor of " + mScaleFactor);
        canvas.scale(mScaleFactor, mScaleFactor);

//      Log.d(TAG, "panning to " + mPosX + "," + mPosY); 
        canvas.translate(mPosX, mPosY);

        super.onDraw(canvas);
        canvas.drawBitmap(bitmap, mPosX, mPosY, null);
        canvas.restore(); //clear translation/scaling
    }

    @Override
    public boolean onTouchEvent(MotionEvent ev) {
        // Let the ScaleGestureDetector inspect all events.
        if (zoomEnabled) {
            mScaleDetector.onTouchEvent(ev);
        }

        if (panEnabled) {
            final int action = ev.getAction();
            switch (action & MotionEvent.ACTION_MASK) {
                case MotionEvent.ACTION_DOWN: {
                    final float x = ev.getX();
                    final float y = ev.getY();

                    mLastTouchX = x;
                    mLastTouchY = y;
                    mActivePointerId = ev.getPointerId(0);
                    break;
                }

                case MotionEvent.ACTION_MOVE: {
                    final int pointerIndex = ev.findPointerIndex(mActivePointerId);
                    final float x = ev.getX(pointerIndex);
                    final float y = ev.getY(pointerIndex);

                    // Only move if the ScaleGestureDetector isn't processing a gesture.
                    if (!mScaleDetector.isInProgress()) {
                        float dx = x - mLastTouchX;
                        float dy = y - mLastTouchY;

                        //Adjust for zoom factor. Otherwise, the user's finger moving 10 pixels
                        //at 200% zoom causes the image to slide 20 pixels instead of perfectly
                        //following the user's touch
                        dx /= (mScaleFactor * 2);
                        dy /= (mScaleFactor * 2);

                        mPosX += dx;
                        mPosY += dy;

                        Log.v(TAG, "moving by " + dx + "," + dy + " mScaleFactor: " + mScaleFactor);

                        invalidate();
                    }

                    mLastTouchX = x;
                    mLastTouchY = y;

                    break;
                }

                case MotionEvent.ACTION_UP: {
                    mActivePointerId = INVALID_POINTER_ID;
                    break;
                }

                case MotionEvent.ACTION_CANCEL: {
                    mActivePointerId = INVALID_POINTER_ID;
                    break;
                }

                case MotionEvent.ACTION_POINTER_UP: {
                    final int pointerIndex = (ev.getAction() & MotionEvent.ACTION_POINTER_INDEX_MASK) >> MotionEvent.ACTION_POINTER_INDEX_SHIFT;
                    final int pointerId = ev.getPointerId(pointerIndex);
                    if (pointerId == mActivePointerId) {
                        // This was our active pointer going up. Choose a new
                        // active pointer and adjust accordingly.
                        final int newPointerIndex = pointerIndex == 0 ? 1 : 0;
                        mLastTouchX = ev.getX(newPointerIndex);
                        mLastTouchY = ev.getY(newPointerIndex);
                        mActivePointerId = ev.getPointerId(newPointerIndex);
                    }
                    break;
                }
            }
        }
        return true;
    }

    private class ScaleListener extends
            ScaleGestureDetector.SimpleOnScaleGestureListener {
        @Override
        public boolean onScale(ScaleGestureDetector detector) {
            mScaleFactor *= detector.getScaleFactor();
            // Don't let the object get too small or too large.
            mScaleFactor = Math.max(0.1f, Math.min(mScaleFactor, 5.0f));
//          Log.d(TAG, "detector scale factor: " + detector.getScaleFactor() + " mscalefactor: " + mScaleFactor);

            invalidate();
            return true;
        }
    }

    //Currently zoomEnabled/panEnabled can only be set programmatically, not in XML

    public boolean isPanEnabled() {
        return panEnabled;
    }

    public void setPanEnabled(boolean panEnabled) {
        this.panEnabled = panEnabled;
    }

    public boolean isZoomEnabled() {
        return zoomEnabled;
    }

    public void setZoomEnabled(boolean zoomEnabled) {
        this.zoomEnabled = zoomEnabled;
    }

    /**
     * Calls getCroppedBitmap(int outputWidth, int outputHeight) without
     * scaling the resulting bitmap to any specific size.
     * @return
     */
    public Bitmap getCroppedBitmap() {
        return getCroppedBitmap(0, 0);
    }

    /**
     * Takes the section of the bitmap visible in its View object
     * and exports that to a Bitmap object, taking into account both
     * the translation (panning) and zoom (scaling).
     * WARNING: run this in a separate thread, not on the UI thread!
     * If you specify that a 200x200 image should have an outputWidth
     * of 400 and an outputHeight of 50, the image will be squished
     * and stretched to those dimensions.
     * @param outputWidth desired width of output Bitmap in pixels
     * @param outputHeight desired height of output Bitmap in pixels
     * @return the visible portion of the image in the PanZoomImageView
     */
    public Bitmap getCroppedBitmap(int outputWidth, int outputHeight) {
        int origX = -1 * (int) mPosX * 2;
        int origY = -1 * (int) mPosY * 2;
        int width = (int) (viewWidth / mScaleFactor);
        int height = (int) (viewHeight / mScaleFactor);
        Log.e(TAG, "origX: " + origX + " origY: " + origY + " width: " + width + " height: " + height + " outputWidth: " + outputWidth + " outputHeight: " + outputHeight + "getLayoutParams().width: " + getLayoutParams().width + " getLayoutParams().height: " + getLayoutParams().height);
        Bitmap b = Bitmap.createBitmap(bitmap, origX, origY, width, height);

        if (outputWidth > 0 && outputWidth > 0) {
            //Use the exact dimensions given--chance this won't match the aspect ratio
            b = Bitmap.createScaledBitmap(b, outputWidth, outputHeight, true);
        }

        return b;
    }

      @Override
        protected void onSizeChanged(int w, int h, int oldw, int oldh) {
            super.onSizeChanged(w, h, oldw, oldh);
            viewHeight = h;
            viewWidth = w;
        }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T18:33:33.197

```
mScaleFactor = Math.max(0.1f, Math.min(mScaleFactor, 5.0f)); 
```

这样，您最多可以缩放 5 倍，根据您想要的大小计算最大比例并添加到此，而不是一直使用 5。

此外，当我在一个项目上使用捏缩放时，我发现如果使用绝对值而不是乘法，它会更容易使用。只需在第一次触摸时获取手指的距离，在移动手指时，计算距离，然后根据第一次距离计算比例。这样，当您限制最小和最大比例时，它可以更好地跟随手指并且工作得更好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-06-21T09:22:18.687

这篇文章很旧并且已经得到了回答，但是我找到了另一个解决方案，它对我来说比接受的答案更好。

```
 protected override void OnDraw(Canvas canvas)
    {
        // Calculate the boundaries of the canvas
        var minX = (int)((_viewWidth / _scaleFactor) - canvas.Width);
        var minY = (int)((_viewHeight / _scaleFactor) - canvas.Height);

        if (_posX > 0)
            _posX = 0;
        else if (_posX < minX)
            _posX = minX;
        if (_posY > 0)
            _posY = 0;
        else if (_posY < minY)
            _posY = minY;

        // Change image position
        canvas.Scale(_scaleFactor, _scaleFactor);
        canvas.Translate(_posX, _posY);

        base.OnDraw(canvas);
    }

    protected override void OnSizeChanged(int w, int h, int oldw, int oldh)
    {
        base.OnSizeChanged(w, h, oldw, oldh);

        _viewHeight = h;
        _viewWidth = w;
    } 
```

请注意，此代码是用 编写的`Xamarin.Android`，但是将其转换为 Java 将很容易。

这使图像完美地保持在其边界内。

# ios - 是否更改 iOS 捆绑包显示名称，在用户设备上作为新应用下载？

> ID：13961226
> 
> 赞同：0
> 
> 时间：2012-12-19T21:09:16.477
> 
> 标签：ios, xcode, app-store-connect, info.plist

如果捆绑显示名称在已提交应用的未来版本中更改，它是作为完全不同的应用下载到用户设备上还是显示名称只是更改？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-19T21:12:31.870

显示名称只会改变。捆绑包 ID 决定是否安装新应用程序。

# silverlight - 加载图像时隐藏 WP7 进度条

> ID：13961227
> 
> 赞同：0
> 
> 时间：2012-12-19T21:09:17.473
> 
> 标签：silverlight, windows-phone-7, progress-bar

我正在使用进度条在 Windows Phone 7 的应用程序中加载图像。

```
bitmapImage.DownloadProgress += new EventHandler<DownloadProgressEventArgs (bitmapImage_DownloadProgress);

void bitmapImage_DownloadProgress(object sender, DownloadProgressEventArgs e)
{
   progressBar.Value = e.Progress;
} 
```

XAML 文件：

```
<ProgressBar x:Name="progressBar" IsIndeterminate="True" Width="300" Height="30" Style="{StaticResource PerformanceProgressBar}" /> 
```

我想知道加载图像后使进度条消失的最佳方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T22:39:08.563

使用`ImageOpened`图像加载成功时触发的事件以及`ImageFailed`图像下载失败时触发的事件。

```
bitmapImage.ImageOpened += new EventHandler<RoutedEventArgs>(bi_ImageOpened);
bitmapImage.ImageFailed += new EventHandler<ExceptionRoutedEventArgs>(bi_ImageFailed);

void bi_ImageFailed(object sender, ExceptionRoutedEventArgs e)
{
    MessageBox.Show("Download of image failed");
    progressBar.Visibility = Visibility.Collapsed;
}

void bi_ImageOpened(object sender, RoutedEventArgs e)
{
     progressBar.Visibility = Visibility.Collapsed;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T21:21:06.543

`Visibility`只需通过属性隐藏它

```
progressBar.Visibility = Visibility.Collapsed 
```

# c# - datagridview 清除和单元格验证问题

> ID：13961234
> 
> 赞同：1
> 
> 时间：2012-12-19T21:09:43.823
> 
> 标签：c#, .net, datagridview

我有一个`dataGridView`包含多个列。第一列是标识符，它必须是唯一的 1 位或 2 位数字。我使用单元格验证来确保标识符满足这些标准。用户根据需要输入任意多行的数据，然后导出数据。`dataGridView`导出数据后，程序通过调用`grid.Clear()`和清除`grid.Refresh()`。

这在大多数情况下都很好用，但有时当删除行时，我会收到一个错误，表明第 1 列中的单元格编号不是唯一的。我无法始终如一地重现此错误；当我通常进入调试器时，如果我尝试在单元格验证步骤中中断，我发现它在清除期间没有被调用，正如我所期望的那样。然而，有时它在清除期间确实会在那里中断，这当然会导致问题。

有没有人对可能导致此问题的原因有任何想法？

编辑：这是我的 cellValidate 代码：

```
private void Grid_CellValidating(object sender, DataGridViewCellValidatingEventArgs e)
    {
        string headerText = Grid.Columns[e.ColumnIndex].HeaderText;

        switch (headerText)
        {
            case "Number":

                if (!String.IsNullOrEmpty(e.FormattedValue.ToString()))
                {
                    if (!Regex.IsMatch(e.FormattedValue.ToString(), @"(^\d{1,2}$)"))
                    {
                        MessageBox.Show("Identifier number must be a 1 or 2 digit positive number");
                        e.Cancel = true;
                    }

                    else
                    {
                        foreach (DataGridViewRow r in Grid.Rows)
                        {
                            if (r.Cells[0].Value != null)
                            {
                                if (e.FormattedValue.ToString() == r.Cells[0].Value.ToString())
                                {
                                    //this message box pops up sometimes when I call Grid.Clear()
                                    MessageBox.Show("Identifier number must unique");
                                    e.Cancel = true;
                                }
                            }
                        }
                    }
                }
                break; //more cases for each column 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T15:20:58.110

问题原来是我有时会在选定的标识符列中使用一个单元格清除 dataGridView，从而获得焦点。通过在调用 clear() 之前关闭多选并将焦点更改为不同的单元格，我能够解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-11-22T10:47:43.267

在 Grid_CellValidating 事件中使用布尔值并绕过它，在清除 Datagridview 后，您可以重置布尔值

# ruby-on-rails - 即使在指定belongs_to之后，我是否需要明确提及has_many？

> ID：13961236
> 
> 赞同：2
> 
> 时间：2012-12-19T21:09:52.777
> 
> 标签：ruby-on-rails, activerecord

我已经使用在rails中创建了模型

```
rails g model User uid:integer name:string 
```

和

```
rails g model Post message:string user:references 
```

以上行生成的模型如下

```
class User < ActiveRecord::Base
  attr_accessible :name, :uid
end 
```

和

```
class Post < ActiveRecord::Base
  belongs_to :user
  attr_accessible :message
end 
```

现在我需要`has_many :posts`在`User`模型中显式添加 a 吗？

还有我怎样才能`user_id`在`Post`模型中制作`NOT NULL`？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T21:13:33.417

> 现在我需要在用户模型中显式添加一个 has_many :posts 吗？

是的，如果您想查找用户 User.firs.posts 的帖子

> 另外我怎样才能使 Post 模型中的 user_id 不是 NULL ？

添加迁移

```
change_column :posts, :user, :integer, :null => false 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T21:17:22.630

您不一定需要 ，`has_many :posts`除非您要进行类似`current_user.posts`. Rails 使用关联来绑定这样的查询。

为了确保 user_id 不为空，您可以做一个或两个。

1.  在您的模型中添加验证，如下所示：

`validates :user_id, :presence => true`

1.  添加数据库约束以使数据库也不允许空值

`t.integer "user_id", :null => false`

后者将通过不允许您通过 SQL 查询插入值 null 来使数据库保持一致。

# android - 如何在小部件中添加加载

> ID：13961242
> 
> 赞同：1
> 
> 时间：2012-12-19T21:10:15.770
> 
> 标签：android, android-widget

当我在家中添加小部件时，我有几个过程，我如何在它还没有准备好时添加“加载图像”？

我看到 Youtube 小部件有这个。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T14:26:29.667

我做到了！=)

我不知道这是否是最好的方法，让我告诉你：

在我的小部件 xml 上，我添加了第二个布局，它包含进度条：

```
widget_layout.xml

<LinearLayout android:id="@+id/progressLayout"
    android:layout_width="match_parent"
    android:layout_height="match_parent">

    <ProgressBar android:id="@+id/widgetProgressBar" android:layout_width="match_parent"
        android:layout_height="match_parent" />

</LinearLayout> 
```

我在原始布局中添加了以下代码：

```
android:visibility="gone" 
```

然后，当我的所有过程结束时，我这样做了：

```
RemoteViews remoteViews = new RemoteViews(context.getPackageName(), R.layout.widget_layout);

remoteViews.setViewVisibility(R.id.progressLayout, View.GONE);
remoteViews.setViewVisibility(R.id.layout, View.VISIBLE);

appWidgetManager.updateAppWidget(widgetId, remoteViews); 
```

如果有人有更好的方法，请告诉我们！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T21:31:13.840

您是否尝试过进度条？当您开始该过程时，您可以使用以下代码：

```
ProgressDialog mDialog;  //create a member vairable

//put this in what ever method you start your process
mDialog = new ProgressDialog(getApplicationContext());
mDialog.setMessage("Loading...");
mDialog.setCancelable(false);
mDialog.show(); 
```

完成所有流程后，您可以致电：

```
//call this when all processes are finished
mDialog.cancel(); 
```

# ios - 访问 UITableViewCell 子类插座属性

> ID：13961245
> 
> 赞同：1
> 
> 时间：2012-12-19T21:10:34.727
> 
> 标签：ios, uitableview

我提供了一个带有插座属性的`UITableViewCell`子类`MyCell`（为了连接笔尖）：

```
@interface MyCell : UITableViewCell

@property (nonatomic, strong) IBOutlet UILabel* theLabel;

@end 
```

然后我合成`theLabel`. 然后我想使用属性名称来访问单元格：

```
MyCell *theCell = (MyCell *)cell;
UILabel *lab = theCell.theLabel; 
```

当我使用属性名称访问单元格时，我收到一条错误消息：

`[UITableViewCell theLabel]: unrecognized selector`

我似乎错过了什么。为什么会抛出异常？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T21:16:35.330

您的问题是，在您的 cellForRowAtIndexPath 函数中，您没有正确地将单元格实例化为“MyCell”类型，而只是尝试将指针静态转换为它。最后，您尝试访问普通 UITableViewCell 中不存在的属性。

您是否正在加载与此类似的单元格？：

```
static NSString *reuseIdentifier = @"Cell";

UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:reuseIdentifier];

if (cell == nil) {
    cell = [[[NSBundle mainBundle] loadNibNamed:@"MyCell" owner:self options:nil] objectAtIndex:0];
} 
```

# knockout.js - knockout.js 在可观察数组中搜索文本冻结

> ID：13961247
> 
> 赞同：0
> 
> 时间：2012-12-19T21:10:36.643
> 
> 标签：knockout.js

我有一个问题，我在可观察数组上搜索 keyupdate，有时页面会冻结。在逻辑中插入“indexOf”时会发生这种情况。我只想隐藏被过滤掉的对象。它主要发生在我低于 2 个字符时。有 1500 行。另一件事我注意到这只发生在 Chrome 中，但在 IE 中它运行得很快！

JS

```
 var self = this,
                intervalId = null;

            self.powerSchoolCourses = ko.observableArray([]);

            // Stores The Text To Filter The Powerschool Course List
            self.powerSchoolCourseSearchText = ko.observable('');

            self.powerSchoolCourseSearchText.subscribe(function (searchText) {

                if (intervalId)
                    clearTimeout(intervalId);

                intervalId = setTimeout(function () {

                    var powerSchoolCourses = self.powerSchoolCourses();

                    ko.utils.arrayForEach(powerSchoolCourses, function(powerSchoolCourse) {

                        if (searchText.length < 3) {
                            powerSchoolCourse.visible(true);
                        } else if (powerSchoolCourse.courseName.toLowerCase().indexOf(searchText) == -1) {
                            powerSchoolCourse.visible(false);
                        } else {
                            powerSchoolCourse.visible(true);
                        }
                    });

                }, 300);
            }); 
```

用户界面

```
<div class="filter">
                                    <div class="input-prepend">            
                                        <span class="add-on"><i class="icon-search"></i></span>
                                        <input class="span2" type="text" placeholder="Powerschool Course Name" data-bind="value: powerSchoolCourseSearchText, valueUpdate: 'afterkeydown'" />                                         
                                    </div>
                                </div>

    <!-- ko foreach: powerSchoolCourses -->
                                    <div class="ps-course" data-bind="draggableCourse: {}, css: { 'even-row': $index()%2 }, visible: visible()">
                                        <span class="icon-move"></span>
                                        <span data-bind="html: courseName"></span> (<span data-bind="html: courseNumber"></span>)

                                        <!-- ko foreach: brainHoneyTypesSorted -->
                                        <span class="badge" data-bind="html: $data[0]"></span>
                                        <!-- /ko -->

                                        <a class="icon-plus" data-bind="click: $root.showSections.bind($data), attr: { title: showSections() ? 'Hide Sections' : 'Show Sections' }, css: { 'icon-minus': showSections() }"></a>
                                    </div>

                                    <div class="sections" data-bind="visible: showSections()">
                                        <div class="header">
                                            <!-- ko if: loadingSections() -->
                                            Loading Sections...
                                            <!-- /ko -->
                                            <!-- ko if: !loadingSections() && sections().length == 0 -->
                                            No Sections Found
                                            <!-- /ko -->
                                            <!-- ko if: !loadingSections() && sections().length > 0 -->
                                            Sections
                                            <!-- /ko -->
                                        </div>
                                        <div class="data">
                                            <!-- ko foreach: sections -->
                                            <div class="ps-section" data-bind="css: { 'even-row': $index()%2 }">
                                                <span data-bind="html: schoolName"></span>
                                                <span data-bind="html: teacherLastName"></span>
                                                <span data-bind="html: courseName"></span>
                                                <span data-bind="html: term"></span>
                                                <span data-bind="html: expression"></span>
                                                <span data-bind="html: bhType"></span>
                                            </div>
                                            <!-- /ko -->
                                        </div>
                                    </div>
                                    <!-- /ko --> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T23:18:00.447

我更新了`visible: visible()`，`if: visible()`问题就解决了。

# python - 如何在 PyQt4 的 http 请求中设置 X-Forwarded-For

> ID：13961250
> 
> 赞同：1
> 
> 时间：2012-12-19T21:10:51.140
> 
> 标签：python, qt, http-headers, ip, pyqt

我想知道如何将参数添加`X-Forwarded-For`到我的标题中。

例如，如果我想在我的应用程序中更改 user-uagent，我会做这样的事情：

```
class MyBrowser(QWebPage):
    ''' Settings for the browser.'''

    def __init__(self):
        QWebPage.__init__(self)

    def userAgentForUrl(self, url):
        ''' Returns a User Agent that will be seen by the website. '''
        return "Mozilla/5.0 (Windows NT 6.2; WOW64) AppleWebKit/537.15 (KHTML, like Gecko) Chrome/24.0.1295.0 Safari/537.15" 
```

而不是我会做类似的事情：

```
class Browser(QWebView):
    def __init__(self, user_info):
        QWebView.__init__(self)
        self.setPage(MyBrowser()) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T08:40:54.693

QWebView 有`void QWebView::load ( const QNetworkRequest & request, QNetworkAccessManager::Operation operation = QNetworkAccessManager::GetOperation, const QByteArray & body = QByteArray() )`. 您可以在 QNetworkRequest 上设置任何标头`void QNetworkRequest::setRawHeader ( const QByteArray & headerName, const QByteArray & headerValue )`

我不是 python 开发人员，但在 C++ 中它会是这样的：

```
QWebView * view = new QWebView;
QNetworkRequest req(QUrl("http://www.google.pl"));
req.setRawHeader("X-Forwarded-For", "MyData");
req.setRawHeader("User-Agent", "Mozilla/5.0 (Windows NT 6.2; WOW64) AppleWebKit/537.15 (KHTML, like Gecko) Chrome/24.0.1295.0 Safari/537.15");
view->load(req); // will perform get operation by default
view->show(); 
```

# javascript - 添加任何额外的 JavaScript 都会破坏 jQuery 模式中的功能

> ID：13961251
> 
> 赞同：3
> 
> 时间：2012-12-19T21:11:11.420
> 
> 标签：javascript, jquery, google-analytics

我有一个由其他人创建的页面，其中包含模式窗口，每个模式窗口都有悬停时显示的链接/图像。仅供参考，我对 JavaScript 和 jQuery 的了解非常有限。

我想要实现的是将 Google Analytics 事件标签添加到模式窗口中的链接。它可以与直接添加到锚标记的 onclick（下面的代码）一起使用，或者如果它通过 jQuery/JavaScript 添加到链接中）。该事件需要在 Google Anayltics 中作为点击事件触发。

通常，我只是添加：

```
onclick="_gaq.push(['_trackEvent','Parameter 1', 'Parameter 2', 'Parameter 3']);" 
```

直接添加到锚标记，但是每当我将代码添加到 HTML 中的锚标记时，jQuery 就会停止工作。模态窗口在此链接上正常工作：http: [//cookware.lecreuset.com/cookware/content_cast-iron-guide-sizes_10151_-1_20002](http://cookware.lecreuset.com/cookware/content_cast-iron-guide-sizes_10151_-1_20002)

您可以在以下链接上看到我所说的“停止工作”的意思 - 列表标签中的项目不再被填充，这意味着图标不会显示，并且悬停时显示的新内容不能访问：[http ://cookware.lecreuset.com/cookware/content_test-form_10151_-1_20002](http://cookware.lecreuset.com/cookware/content_test-form_10151_-1_20002)

由于大多数链接都是在 jQuery 中创建的，因此我首先尝试通过 .click、.attr、.on 和 .bind 添加 Google 标记，但没有成功。上面的链接向您展示了我对 .click 函数的尝试（搜索 CIGuide，您会在第二个链接的源代码中找到它），但无论我在页面中添加什么 JavaScript，它都会以相同的方式中断。我原来的问题在这里：[无法成功地将 Google Analytics 事件标签添加到由 .attr 创建的链接](https://stackoverflow.com/questions/13844292/not-able-to-successfully-add-google-analytics-event-tag-to-link-created-by-attr)

在我无法让这两件事中的任何一个工作之后，我决定尝试在我提供的所有内容之外的页面上使用它自己的 JavaScript 标签进行简单的警报，看看我是否可以做到这一点工作。它工作得很好，但模态功能仍然坏了。

我已经能够成功地将 Google 标记添加到顶部导航中的锚点以及页面左侧和右侧的箭头中。但是每当我尝试标记其他任何内容时，它都会中断。

我正在与之合作的代理机构能够在他们的服务器上测试它时毫无问题地将谷歌标签添加到锚点，如果我在我的本地机器上测试它，我能够看到事件触发。我必须假设我的服务器或 OpenCMS 有问题。但是，我在任何浏览器/调试器中都看不到任何错误消息，并且我已经使用 JSLint 验证了我的脚本添加，并且一切都检查出来了。

这让我发疯！谁能帮我弄清楚为什么这不起作用以及如何将事件标签添加到页面？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T21:26:55.403

不完全确定您要实现的目标以及是否可行。

```
$(document).ready(function() {

    $("#modal_sizes_1 a").each(function( index, elem ) {

        $(elem).click(function() {

            _gaq.push(['_trackEvent','Parameter 1', 'Parameter 2', 'Parameter 3']);
        });
    });
}); 
```

**更新**
好的，所以我认为这是关于这一行的：

```
<a
    href="/cookware/content_cast-iron-guide-about_10151_-1_20002"
    title="About Cast Iron" 
    onclick="_gaq.push(['_trackEvent','CIGuide', 'Click', 'About Cast Iron']);"

>About Cast Iron</a> 
```

我会尝试像这样改变它

```
<a
    href="/cookware/content_cast-iron-guide-about_10151_-1_20002"
    title="About Cast Iron" 
    onclick="setTimeout(function(){
        _gaq.push(['_trackEvent','CIGuide', 'Click', 'About Cast Iron']);
    },0);"

>About Cast Iron</a> 
```

或者甚至使延迟时间超过`0`10 或 50。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-11T23:15:43.287

您可以使用 GA 推送方法的回调并添加超时。在你的情况下尝试这样的事情：

```
var submitBtn = $('.submit-btn');

submitBtn.on('click', function(e) {
    var that = this;

    if (typeof _gaq != 'undefined') {
        e.preventDefault();

        _gaq.push(['_trackEvent','Parameter 1', 'Parameter 2', 'Parameter 3'], function() {
            setTimeout(function() {
                window.location = $(that).attr('href');
            }, 100);
        });
    }
}); 
```

# ruby-on-rails - Rails 不使用 Twitter Bootstrap 加载 .less 文件

> ID：13961255
> 
> 赞同：2
> 
> 时间：2012-12-19T21:11:29.533
> 
> 标签：ruby-on-rails, twitter-bootstrap

我已经在我的 Rails 3.2.1 应用程序上成功运行 Twitter Bootstrap 几个月了

我对 Heroku 进行了推送，但对 assets:precompile 的推送失败了，整个应用程序崩溃了

在本地运行 assets:precompile 也失败并出现以下错误：

```
no such file to load -- less
(in /blah/blah/app/assets/stylesheets/bootstrap_and_overrides.css.less) 
```

我的 bootstrap_and_overrides.css.less 或 bootstrap_defaults.css.less 文件没有变化，但我怀疑 Gem 更新了（我怎么知道？）

我通过添加宝石管理了部分恢复：

```
gem 'less-rails-bootstrap'
gem 'therubyracer' 
```

（其他宝石需要rubyracer）

我还做了一个 rails g bootstrap:install -f 并从备份中恢复了 bootstrap_and_overrides 中的任何自定义行

我还从我知道它正在工作的地方恢复到 Git 提交

但是，我只取得了部分成功——现在一些网站 CSS 样式与原来不同

这里发生了什么？我怎样才能回到我原来的设置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-12T15:28:32.897

即使您的问题已解决，我只想为遇到相同错误的其他人添加此内容：在我的情况下，我只需要重新启动我的服务器。当我的本地服务器运行时，我在我的 Gemfile 中添加了三个相关的 gem（less-rails、therubyracer 和 twitter-bootstrap-rails），导致了上面看到的相同问题。因此，一旦我将其关闭并重新启动，一切都加载良好。

# jquery - sharethis jquery 背景图像更改

> ID：13961256
> 
> 赞同：0
> 
> 时间：2012-12-19T21:11:31.360
> 
> 标签：jquery, wordpress, social, sharethis

```
<span class="stMainServices st-facebook-counter" style="background-image: url(http://w.sharethis.com/images/facebook_counter.png);">&nbsp;<img src="http://w.sharethis.com/images/check-big.png" style="position: absolute; top: -7px; right: -7px; width: 19px; height: 19px; max-width: 19px; max-height: 19px; display: none;"></span> 
```

我无法用自己的图像更改背景图像（facebook_counter）。我试图通过使用 .css("background-image","url...") 和 .attr("style","new style") 来更改它，但也许我使用了错误的选择器部分。

我也通过在 wordpress 安装中使用 wp socializer 来获取此代码。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T21:14:27.137

这是因为 CSS 优先级。内联样式（使用`style="blah"`标签中的声明）比样式表中的项目具有更高的优先级。

`!important`您可以使用样式上的标志覆盖它，但这[被认为是不好的做法](https://stackoverflow.com/questions/3706819/what-are-the-implications-of-using-important-in-css)。

```
.st-facebook-counter
{
    background-image: url('someotherimage.jpg') !important;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-05-10T06:52:31.240

要更改背景图像，例如 facebook：

默认情况下，sharethis 的工作方式如下：

```
<span class="st_facebook"></span> 
```

我们需要将上面更改为

```
<span class="st_facebook_custom"></span> 
```

然后将样式添加到类中：

```
 .st_facebook_custom{
    background: url("http://path/to/image/file") no-repeat scroll left top transparent;
    padding:0px 16px 0 0;
} 
```

它应该与您需要的图像完美配合。

# django - ManyToManyField上的Django查询填充

> ID：13961267
> 
> 赞同：0
> 
> 时间：2012-12-19T21:12:27.520
> 
> 标签：django, django-models

我有一张表，其中包含涉及 Sim 卡的任务列表。只有在任务中使用的所有 sims 卡同时可用时才能完成任务

表中的示例任务：

```
Task1 - IMEI1 & IMEI2
Task2 - IMEI1 
```

如果我有一个只有 IMEI1 的 IMEI 列表，我只想拥有 Task2。如果我有一个带有 IMEI1 和 IMEI2 的列表，我想拥有 Task1 和 Task2。

请注意，我在此列表中有随机数量的模拟人生。

这是我的代码：

```
class Sim(models.Model):
    msisdn = models.CharField(max_length=20, blank=False, null=False)
    imei = models.CharField(max_length=40, blank=False, null=False, default='IMEI')

class taskInQueue(models.Model):
     simInvolved = models.ManyToManyField(Sim) 
```

所以在一个`taskInQueue`我有一个或多个`Sim`参与的任务。在一个函数中，我尝试获取所有涉及模拟人生列表的任务：

```
sim = getSimInvolved(_imeiList)  #_imeiList is a list of IMEI -> Sim is a list of SIm Objects 
```

首先，我正在做以下事情：

```
tasks = taskInQueue.objects.filter(simInvolved__in=sim, testsStatus='W').distinct().order_by('pk') 
```

问题是，通过这个查询，我将完成所有涉及至少一个模拟人生的任务。因此，如果我可以使用前面的示例，`_imeiList=['IMEI1']`我将获得 Task1 和 Task2，而我只能获得 Task2。

那么我如何过滤`taskInQueue`列表中的所有参与模拟市民`_imeiList`呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T21:40:13.873

使用链式过滤器？

```
tasks = taskInQueue.objects.all()
for sim in sims:
    tasks = tasks.filter(simInvolved=sim)

# in the end tasks will only contains those tasks which required all sims 
```

# qt - 无法在 qt opengl 中使用键盘命令移动相机

> ID：13961269
> 
> 赞同：2
> 
> 时间：2012-12-19T21:12:37.363
> 
> 标签：qt, opengl, keyboard, camera

我正在尝试在 qt4 中使用 opengl 实现游戏。到目前为止，我已经创建了足球场，现在我正在尝试实现一个用户可以使用箭头键在世界上自由移动的相机。我的朋友使用了他在 NeHe 教程中找到的一段代码，只需将其复制粘贴到他的代码中，相机就可以为他工作。当我尝试相同时，只有转义按钮有效，它只是关闭了 opengl 小部件。f1 键应该切换到全屏，但它只会使鼠标光标不可见，而无需切换到全屏模式。箭头键根本不起作用。由于我是 opengl 的新手，所以我无法弄清楚实现有什么问题。

我正在添加绘制音高的代码以及键盘事件处理程序。

```
void metinalifeyyaz::paintGL(){

movePlayer();

glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
glLoadIdentity();

GLfloat xtrans = -xpos;
GLfloat ytrans = -walkbias - 0.50f;
GLfloat ztrans = -zpos;
GLfloat sceneroty = 360.0f - yrot;

glLoadIdentity();
glRotatef(lookupdown, 1.0f, 0.0f, 0.0f);
glRotatef(sceneroty, 0.0f, 1.0f, 0.0f);
glTranslatef(xtrans, ytrans+50, ztrans-130);

glLoadIdentity();
glTranslatef(1.0f,0.0f,-18.0f);
glRotatef(45,1,0,0);
drawScene();

int delay = time.msecsTo(QTime::currentTime());
if (delay == 0)
    delay = 1;
time = QTime::currentTime();
timer->start(qMax(0,10 - delay));

}

void metinalifeyyaz::movePlayer() {

if (keyUp) {
    xpos -= sin(yrot * PI_OVER_180) * 0.5f;
    zpos -= cos(yrot * PI_OVER_180) * 0.5f;
    if (walkbiasangle >= 360.0f)
        walkbiasangle = 0.0f;
    else
        walkbiasangle += 7.0f;
    walkbias = sin(walkbiasangle * PI_OVER_180) / 10.0f;
} else if (keyDown) {
    xpos += sin(yrot * PI_OVER_180)*0.5f;
    zpos += cos(yrot * PI_OVER_180)*0.5f ;
    if (walkbiasangle <= 7.0f)
        walkbiasangle = 360.0f;
    else
        walkbiasangle -= 7.0f;
    walkbias = sin(walkbiasangle * PI_OVER_180) / 10.0f;
}

if (keyLeft)
    yrot += 0.5f;
else if (keyRight)
    yrot -= 0.5f;

if (keyPageUp)
    lookupdown -= 0.5;
else if (keyPageDown)
    lookupdown += 0.5;
}

void metinalifeyyaz::keyPressEvent(QKeyEvent *event) {

switch (event->key()) {
case Qt::Key_Escape:
    close();
    break;
case Qt::Key_F1:
    setWindowState(windowState() ^ Qt::WindowFullScreen);
    break;
default:
    QGLWidget::keyPressEvent(event);
case Qt::Key_PageUp:
    keyPageUp = true;
    break;
case Qt::Key_PageDown:
    keyPageDown = true;
    break;
case Qt::Key_Left:
    keyLeft = true;
    break;
case Qt::Key_Right:
    keyRight = true;
    break;
case Qt::Key_Up:
    keyUp = true;
    break;
case Qt::Key_Down:
    keyDown = true;
    break;

}
}

void metinalifeyyaz::changeEvent(QEvent *event) {

switch (event->type()) {
case QEvent::WindowStateChange:

    if (windowState() == Qt::WindowFullScreen)
        setCursor(Qt::BlankCursor);
    else
        unsetCursor();
    break;
default:
    break;
}
}
void metinalifeyyaz::keyReleaseEvent(QKeyEvent *event) {

switch (event->key()) {
case Qt::Key_PageUp:
    keyPageUp = false;
    break;
case Qt::Key_PageDown:
    keyPageDown = false;
    break;
case Qt::Key_Left:
    keyLeft = false;
    break;
case Qt::Key_Right:
    keyRight = false;
    break;
case Qt::Key_Up:
    keyUp = false;
    break;
case Qt::Key_Down:
    keyDown = false;
    break;
default:
    QGLWidget::keyReleaseEvent(event);
}
} 
```

我知道复制粘贴不是一种有效的方法，但我朋友的项目与我的项目没有什么不同，它对他有用。如果您知道任何可能导致相同代码在一个项目而不是另一个项目上工作的事情，请指出。当然，非常感谢有关代码的任何其他评论。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T21:14:43.350

看：

```
glLoadIdentity();
glRotatef(lookupdown, 1.0f, 0.0f, 0.0f);
glRotatef(sceneroty, 0.0f, 1.0f, 0.0f);
glTranslatef(xtrans, ytrans+50, ztrans-130);

glLoadIdentity(); // get rid of this!
glTranslatef(1.0f,0.0f,-18.0f);
glRotatef(45,1,0,0);
drawScene(); 
```

“glLoadIdentity”重置当前矩阵。在您的代码中，您旋转和平移矩阵，但之后，您通过调用“glLoadIdentity”重置矩阵，因此之前的矩阵转换什么都不做。

基本上这是你的代码：

*   OpenGL，重置矩阵。
*   OpenGL，移动播放器和相机。
*   OpenGL，重置矩阵，然后忘记我刚刚做的任何事情。
*   OpenGL，做...不管那是什么。
*   OpenGL，画我的场景！

# php - 在php中覆盖祖父方法

> ID：13961270
> 
> 赞同：4
> 
> 时间：2012-12-19T21:12:38.380
> 
> 标签：php, oop, multiple-inheritance

我目前正在为应用程序编写一组骨架类，从一个名为 StoreLogic 的基类开始，它包含税收规则、折扣规则等。Cart、Order、Quote 等类将扩展 StoreLogic，因为它们都将使用StoreLogic 提供的同一组方法。

一旦完成这些核心类，我将通过扩展 Cart、Order、Quote 和 StoreLogic 来实现它们，因为这些类的每个应用程序都会根据我们不同的客户需求而有所不同。覆盖父类的方法很容易，但是在他们的孩子扩展它们之前覆盖祖父类似乎......不可能？我觉得我做错了（tm）..我认为像你这样更有经验的人可能能够为我指明正确的方向。看看代码，看看你的想法！

```
/* My core classes are something like this: */
abstract class StoreLogic
{
    public function applyDiscount($total)
    {
        return $total - 10;
    }
}

abstract class Cart extends StoreLogic
{
    public function addItem($item_name)
    {
        echo 'added' . $item_name;
    }
}

abstract class Order extends StoreLogic
{
    // ....
}

/* Later on when I want to use those core classes I need to be able to override
 * methods from the grandparent class so the grandchild can use the new overriden
 * methods:
 */
class MyStoreLogic extends StoreLogic
{
    public function applyDiscount($total) {
        return $total - 5;
    }
}

class MyOrder extends Order
{
    // ...
}

class MyCart extends Cart
{
    public $total = 20;

    public function doDiscounts()
    {
        $this->total = $this->applyDiscount($this->total);
        echo $this->total;
    }
}

$cart = new MyCart();
$cart->doDiscounts(); // Uses StoreLogic, not MyStoreLogic.. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T21:20:24.483

我认为您在这里缺少一个非常基本的逻辑

```
- MyCart extends Cart
- Cart extends StoreLogic 
```

如果要使用`MyStoreLogic`then`cart`应定义为

```
 abstract class Cart extends MyStoreLogic 
```

如果您不想这样做，那么您可以拥有

```
$cart = new MyCart();
$cart->doDiscounts(new MyStoreLogic()); // output 15 
```

类修改

```
class MyCart extends Cart {
    public $total = 20;
    public function doDiscounts($logic = null) {
        $this->total = $logic ? $logic->applyDiscount($this->total) : $this->applyDiscount($this->total);
        echo $this->total;
    }
} 
```

# ruby-on-rails - 使用 ruby with thin 实现实时聊天功能

> ID：13961272
> 
> 赞同：1
> 
> 时间：2012-12-19T21:12:48.320
> 
> 标签：ruby-on-rails, long-polling, thin, livechat

所以我的目标是创建某种简单的聊天功能，几天后（那是正确的日子）没有确定的方向，我决定在这里发布。基本上我所需要的只是一个全球聊天频道，该网站上的任何用户都可以打开和贡献。我想我应该使用长轮询。我想知道这是否可以使用我现在为该站点提供的内容来完成：Ruby on Rails 框架，顶部有 Backbone.js，还使用瘦 gem 来处理服务器垃圾。关于如此接近我想要完成的唯一问题是[here](https://stackoverflow.com/questions/3072480/using-thin-for-long-polling-connection)，但这是一个非常模糊的答案。请保持简单，虽然我在大多数 ruby​​ 和 javascript 方面都做得很好，但这个服务器端事件业务对我来说基本上是全新的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T21:16:29.963

我建议你尝试使用 private_pub gem [https://github.com/ryanb/private_pub](https://github.com/ryanb/private_pub) 它使用的是 Faye 服务器，它易于使用且速度非常快

# python - 这个“继续”示例在 Python 中做了什么？

> ID：13961273
> 
> 赞同：-2
> 
> 时间：2012-12-19T21:12:50.187
> 
> 标签：python, range, continue

所以我在学习python的过程中遇到了让我困惑的代码。

```
var = 95
for items in range(0,100):
    if var < 10:
        continue
    elif var == 10:
        print("hit")
    elif var > 10:
        print("passed")
    var = var + 1 
```

我不明白为什么它不只是打印“通过”5 次……而是打印 100 次。

到底在做什么？如果我将 var 更改为 like (3)，它会“继续”到下一个代码块吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-19T21:13:59.057

`continue`继续下一个循环迭代。请参阅[文档](http://docs.python.org/3/reference/simple_stmts.html#the-continue-statement)。

但是，在这种情况下，这并不重要，因为`oontinue`永远不会到达。 `var`从 95 开始，只能增加，所以永远不会小于 10。

这段代码有点奇怪，因为只有最后一个`elif`会执行。也许您打算`var`在循环中的某个地方使用？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T21:31:59.567

正如 BrenBarn 所说，`continue`只是跳过循环的其余部分并继续下一次迭代。

但何时从 95 开始并不重要`var`，因为该代码永远不会到达。让我们追溯一下，看看会发生什么：

```
var = 95
First loop, items = 0:
   since var (95) > 10:
       print("passed")
   var = var + 1 = 96
Next loop, items = 1
   since var (96) > 10:
       print("passed")
   var = var + 1 = 97
...
100th loop, items = 99
   since var (194) > 10:
       print("passed")
   var = var + 1 = 195 
```

> 如果我将 var 更改为 like (3)，它会“继续”到下一个代码块吗？

不，它会继续`while`循环的下一次迭代——这意味着它会跳过该`var = var + 1`部分。如果您想跳出循环并转到下一个代码块，那就是`break`而不是`continue`.

现在，让我们追溯一下如果从 3 开始会发生什么：

```
var = 3
First loop, items = 0:
   since var (3) < 10:
       continue # skips to the next loop iteration
Second loop, items = 1:
   since var (3) < 10:
       continue # skips to the next loop iteration
...
Last loop, items = 99:
   since var (3) < 10:
       continue # skips to the next loop iteration 
```

由于`continue`，它永远不会到达`var = var + 1`，所以它只是循环 100 次而不做任何事情。

这意味着，如果您尝试使用`print(var)`循环后的 a 来测试它，它看起来很像它只是跳到下一个代码块。但是，如果你把 a 放在`print(items)`那里，你会看到它是 99，而不是 0。或者，如果你`print`之前的东西`continue`，你会看到它发生了 100 次。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T21:32:36.460

这个例子有点奇怪，因为你使用 var 和 items 的方式不同。让我重写这个例子更清楚一点。

```
for i in range(0,100):

    # If i is less than 10, do nothing.
    if i < 10:
        continue

    # If i equals 10, print "hit"
    if i == 10:
        print "hit"

    # If i is greater than 10, print "passed"
    if i > 10:
        print "passed" 
```

这将输出：

```
hit
passed
passed
... (repeat 87 more times) 
```

您的示例不仅运行五次的原因是因为您没有在 for 循环中使用变量 var 。由于 range(0, 100)，您的 for 循环将发生 100 次，变量 item 每次递增。

要让它像您期望的那样发生五次，您需要在 range 函数中使用 var ，如下所示：

```
var = 95
for item in range(var, 100):
    if var < 10:
        continue
    elif var == 10:
        print("hit")
    elif var > 10:
        print("passed")
    var = var + 1 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-19T21:18:10.950

`continue`跳到循环的下一次迭代，而不执行任何其他语句。

在这种情况下，`continue`语句不会被命中，因为 var 从 95 开始并且只会递增。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-19T21:18:58.623

我怀疑您的意思是在 var 达到 100 时将其重置为零？

# z3 - 是否可以通过 SMT 模型进行量化？

> ID：13961279
> 
> 赞同：1
> 
> 时间：2012-12-19T21:13:07.053
> 
> 标签：z3, smt

我需要检查某个 smt 问题的每个令人满意的实例是否有来自其他 smt 问题的匹配实例。即“A 的所有实例都存在 B st ....”的实例，其中 A 和 B 是从一些 smt-lib 代码生成的 sat 模型。

我一直在思考这个问题，但不知道该怎么做

# php - 如何将我的登录过程拆分为函数？

> ID：13961282
> 
> 赞同：0
> 
> 时间：2012-12-19T21:13:22.780
> 
> 标签：php, function, login, module, session-variables

我目前正在使用我在网上找到的登录脚本的修改版本。任何人都可以提出一些将代码模块化为函数的方法吗？

下面是登录页面的代码：

```
<?php
include("db.php");
include("login_fns.php");
session_start();
if($_SERVER["REQUEST_METHOD"] == "POST")
{
// username and password sent from Form
$username=mysql_real_escape_string($_POST['username']); 
$password=mysql_real_escape_string($_POST['password']); 
$password=md5($password);
$sql="SELECT * FROM client_login WHERE Username='$username' and Password='$password'";
$result=mysql_query($sql);
$count=mysql_num_rows($result);
$row = mysql_fetch_array($result);
$client_ref = $row['Client_ref'];
$user_level = $row['user_level'];
// If result matched $username and $password, table row must be 1 row
if($count==1)
{

$_SESSION['user_level'] = $user_level;
$_SESSION['client_ref'] = $client_ref;
$_SESSION['user'] = $username;

if ($user_level == '1') {
header('Location: admin.php');
} else {

header('Location: myaccount.php');
}
}
else 
{
echo "Error logging in!";
}
}
?>
<form action="login.php" method="post">
<label>UserName :</label>
<input type="text" name="username"/><br />
<label>Password :</label>
<input type="password" name="password"/><br/>
<input type="submit" value=" Login "/><br />
</form> 
```

理想情况下，我想要一个用于用户帐户搜索和会话设置的功能。我之前尝试将这段代码的片段复制到一个单独的 php 函数文件中，但它似乎不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T21:19:31.043

你怎么看待这件事？:)

# 功能

```
<?php
function checkLogin($username, $password) {
    global $bd;

    $returnArray=array();
    $username=mysqli_real_escape_string($bd, $username);
    $password=md5($password);

    $getUser=mysqli_query($bd, "SELECT `Client_ref`,`user_level` FROM client_login WHERE Username='$username' and Password='$password'");
    $arrayUser=mysqli_fetch_array($getUser);

    if(mysqli_num_rows($getUser) == 0)
    {
        $returnArray['error']='true';
        $returnArray['errormsg']='User not found in the database.';

        return $returnArray;
    }

    $returnArray['Client_ref']=$row['Client_ref'];
    $returnArray['user_level']=$row['user_level'];

    return $returnArray;
}
?> 
```

# 其余代码

```
<?php
include("db.php");
include("login_fns.php");
session_start();

if($_SERVER["REQUEST_METHOD"] == "POST")
{
    $username=$_POST['username']; 
    $password=$_POST['password']; 

    $loginArray=checkLogin($username, $password);

    if(!isset($loginArray['error']))
    {
        $_SESSION['user_level'] = $loginArray['Client_ref'];
        $_SESSION['client_ref'] = $loginArray['user_level'];
        $_SESSION['user'] = $username;

        if($loginArray['user_level'] == '1')
        {
            header('Location: admin.php');
        }
        else
        {
            header('Location: myaccount.php');
        }
    }
    else 
    {
        echo "Error logging in!";
        echo "The detailed error message is: ".$returnArray['errormsg'];
    }
}
?>
<form action="login.php" method="post">
    <label>UserName :</label>
    <input type="text" name="username"/><br />

    <label>Password :</label>
    <input type="password" name="password"/><br/>

    <input type="submit" value=" Login "/><br />
</form> 
```

# internet-explorer - Favicon 请求未显示在开发人员工具栏的网络选项卡中

> ID：13961283
> 
> 赞同：21
> 
> 时间：2012-12-19T21:13:26.537
> 
> 标签：internet-explorer, google-chrome, firefox, google-chrome-devtools, favicon

[我已经按照这些线](https://stackoverflow.com/a/9892941/419956)在 Content 文件夹（而不是根目录）中设置了我的 ASP.NET MVC 应用程序。这很好用，图标显示在所有浏览器中。

但是，当我安装 ELMAH 时，我开始看到 404 错误，因为显然我网站的根目录仍在请求图标图标！我很想知道为什么会发生这种情况以及是谁在这样做。假设我的浏览器导致了这种情况，我打开了开发人员工具栏，这就是我发现的：

**谷歌浏览器：**
![Chrome 中的开发人员工具栏、网络选项卡](../Images/8246188411368c164ed86638d94661ce.png)

**互联网浏览器 9：**
![IE9 中的开发工具栏、网络选项卡](../Images/91e39e05773d0fa4ddc89311a9946318.png)

**火狐：**
![Firefox 中的开发人员工具栏、网络选项卡](../Images/b8bc4cfbc3275912339d3de4b40f4848.png)

所有这些都显示了 9 个类似的请求，但**没有一个显示 favicon.ico 请求……根本没有*？***我希望至少有一个（我在浏览器中看到的 Content 文件夹中的那个），甚至两个（也是在 ELMAH 中给我 404 的那个）。

***所以，我的问题****：谁能解释为什么开发人员工具栏通常不显示图标请求？这可以以某种方式打开或在某处看到吗？*

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-12-19T21:42:29.380

默认情况下，所有浏览器`/favicon.ico`都会在地址栏、选项卡、书签等中使用它。这只是一种约定（[W3C 不喜欢它](http://www.w3.org/2001/tag/issues.html?type=1#siteData-36)）。

使用 Chrome，您可以在此处看到此请求：`chrome://net-internals/#events`.

![网络内部事件面板](../Images/509308d129c4a796b741cefe4f7dac24.png)

`<link rel="shortcut icon" href="http://test.com/myicon.ico" />`您可以使用该部分中的 HTML 标记覆盖该图标`<head>`。这似乎阻止了 Chrome 检查默认位置。但是，即使设置了此标记，Chrome DevTools 也不会显示`favicon.ico`为在页面加载期间下载的资源。造成这种情况的原因可能是网站没有使用 favicon，它是由浏览器使用的。浏览器出于自己的目的请求它。

**[编辑]**有一个打开的 Chrome[问题](http://code.google.com/p/chromium/issues/detail?id=110449)`favicon.ico`将网络面板中的 缺失分类为错误。**[编辑]**它也是 Firebug 中的一个[错误](https://stackoverflow.com/questions/10667348/why-doesnt-the-favicon-icon-show-in-firebug-net-panel)。

# reporting-services - 从 MVC 向 SQL Server Reporting Services 进行身份验证

> ID：13961288
> 
> 赞同：0
> 
> 时间：2012-12-19T21:13:45.277
> 
> 标签：reporting-services, asp.net-mvc-4

我有一个网站（ASP.NET MVC 4），其中有需要访问 SQL Server Reporting Services 的用户。在我们网站的数据库中，我们有我们的用户信息，用户名是电子邮件（不确定电子邮件是否允许作为 SSRS 的登录凭据？）。我希望用户通过网站和 SQL Server 报告服务的身份验证，以便我们可以使用也存储在数据库中的角色来控制用户查看哪些报告。

我已经阅读了实现 SQL Server Reporting Services Extension 的文档，但大多数示例都实现了用于登录 SSRS ReportServer 站点的登录页面。而我希望我的用户通过身份验证以使用 Reporting Services 服务在我的网站上查看/导出报告。至少我想在他们登录时进行身份验证，并能够将他们重定向到 Reporting Services 报告管理器。

所以我的问题是，在我的网站上查看报告是否需要实施身份验证扩展？

我是 Reporting Services 领域的新手，目前正在进一步学习这个主题，所以请随意进入不必要的细节。

注意：该网站与 Reporting Services 托管在同一台机器上，SSRS 也是 2012 版。

# image - Cocos2d。正确加载和存储图像？

> ID：13961289
> 
> 赞同：2
> 
> 时间：2012-12-19T21:13:46.087
> 
> 标签：image, cocos2d-iphone, ccsprite, cclayer, cctexturecache

这个问题有很多答案。但所有这些都是**不正确**的！

例如，如果我用一个 CCSprite 对象创建了一个 CCLayer 对象。我有 3 个纹理，我想在每次触摸时在它们之间切换。

例如，我将使用类似的东西：

[关联](https://stackoverflow.com/questions/9812011/how-to-load-sprites-in-cocos2d-correctly)

我在模拟器中运行这个应用程序。然后我调用内存警告。然后我尝试在图像（纹理）之间切换。而且我看到 3 张图像中的 2 张被删除（除了图像同时显示内存警告）。

我尝试对 CCSprite 和 ССTexture2D 使用保留/释放命令，但它们会导致从未调用释放对象的 dealloc 方法的情况。

那么如何正确存储呢？我想将它们存储在内存警告中，并在当前层被破坏时释放/删除它们。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T10:20:31.760

将它们存储在使用 Texture Packer 创建的一个纹理图集中。然后就是调用[Sprite setDisplayFrame:frameName]来切换显示的纹理那么简单。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T23:10:01.340

默认情况下，内存警告 cocos2d 将删除未使用的纹理。内存警告的全部意义在于操作系统告诉您的应用程序“嘿，那不行，减少您的内存需求，否则我将关闭您”，您的应用程序应该像“哎呀，抱歉，现在释放内存”。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-19T23:13:38.210

如果您在预加载纹理时收到内存警告，cocos2d 删除未使用纹理的默认行为会让您大吃一惊。[更多关于这个问题在这里。](http://www.learn-cocos2d.com/2012/11/optimize-memory-usage-bundle-size-cocos2d-app/)

我的建议：去掉 AppDelegate 内存警告方法中清除 cocos2d 缓存的调用。当然，您要格外小心内存使用情况。或者，您可以在预加载图像时简单地禁用该行为，但这可能只是将问题移到稍后的时间点。

# java - 实现押韵查找器

> ID：13961291
> 
> 赞同：11
> 
> 时间：2012-12-19T21:13:53.887
> 
> 标签：java, algorithm, linguistics

想知道是否有人有任何提示或可以指出正确的方向来查找/创建某种算法来查找押韵词。

我特别不想使用 API，因为创建算法只是为了创建它是我的最终目标。

并不是说它应该很重要，但我正在用 java 编码。

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-19T21:23:20.643

如果您不想使用 API，这似乎是一个巨大的项目。具有挑战性的步骤是确定一个词的语音（如果两个词的结尾在语音上相似，则两个词押韵）。如果你能做到这一点，你可以比较他们发音的结尾。您可能会找到一个 API 可以将已知单词转换为其拼音，但如果您不想使用 API，您必须自己做，这不是一项小任务……更不用说，任何人都没有做到完美.

另一种方法是研究 Metaphone 算法，在这里解释：http: [//www.blackbeltcoder.com/Articles/algorithms/phonetic-string-comparison-with-soundex](http://www.blackbeltcoder.com/Articles/algorithms/phonetic-string-comparison-with-soundex)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-19T21:28:56.400

最佳算法将使用按押韵分类的单词词典。这是一个非常困难的问题，需要语言学背景。我想你想要一些可能不是最好的自动查找押韵的算法。

用一些价值编码单词（不是单词本身）的发音的基本思想。以相同代码结尾的值识别单词押韵。

从我的角度来看，它比找到正确的算法更多的是研究。

看看那篇论文：[押韵自动识别系统](http://www.google.com.ua/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&ved=0CDYQFjAA&url=http%3A%2F%2Fwww.bradleybuda.com%2Frhymes%2F595-final-report.pdf&ei=BjDSUPelHonitQaL2oHwAQ&usg=AFQjCNHuLpGt0TxLy541-SPLZ3MoLRVl2g&sig2=jRnUDpM5qVpiDuliYL0c1g&bvm=bv.1355534169,d.d2k&cad=rja)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-19T21:29:56.820

我认为利用标准的语音算法将是一个好主意。我认为 Soundex 可能有点受限，但[双](http://en.wikipedia.org/wiki/Metaphone#Double_Metaphone)变音位可能是一个不错的选择。

获取相关单词的变音位表示，删除第一个字符，并检查两个单词中较短的单词的剩余部分是否与较长单词的结尾匹配。双变音位非常相似，但要进行四个比较，初级到初级，次级到初级，初级到次级，次级到次级。

我认为这将是一个很好的起点。

关于这个和许多其他语音算法的注释：它不是为提供精确的语音定义而设计的。多变的地理读音、常见的误读和交替读音，使得仅凭单词无法获得硬而快速的单一正确读音。新颖的拼写和字母用法使得算法难以获得接近的发音（关心一些开胃小菜吗？）。此外，许多此类算法的主要目标是将相似的发音或听错的单词或名称相互匹配，因此结果通常有点不精确（这可能是一件好事，也是为了这个目的）。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-12-19T22:04:57.483

[我在我的博客上](http://programmingpraxis.com/2012/04/24/rhyming-dictionary/)写了一个押韵词典程序。这个想法是使用带有发音的字典并从末尾开始比较音素；具有相同结尾音位的两个单词是彼此押韵的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-01-23T04:39:30.800

首先，您可能想看看卡内基梅隆大学的发音词典。这是我能找到的最好的发音词典。

[http://www.speech.cs.cmu.edu/cgi-bin/cmudict](http://www.speech.cs.cmu.edu/cgi-bin/cmudict)

# c++ - wxWidgets - 无模式的 wxDialog

> ID：13961292
> 
> 赞同：1
> 
> 时间：2012-12-19T21:13:56.157
> 
> 标签：c++, user-interface, pointers, dialog, wxwidgets

我正在创建自己的 wxDialog 子类，它在用作无模式对话框时效果很好，如下所示：

```
AddDialog newAddDialog = new AddDialog(this, wxID_ANY, _T("Dialog Title"), wxDefaultPosition, wxDefaultSize, 0);
if (newAddDialog.ShowModal() == wxID_OK)
{
//do something
} 
```

使用 ShowModal() 时，程序的流程会停止，直到按下 OK 或 Cancel。我需要显示对话框，但不能停止 GUI 的流程，所以我尝试了这个：

```
AddDialog newAddDialog = new AddDialog(this, wxID_ANY, _T("Dialog Title"), wxDefaultPosition, wxDefaultSize, 0);
if (newAddDialog.Showl() == wxID_OK)
{
//do something
} 
```

使用 Show() 时，对话框会短暂显示然后消失。我认为这可能是范围问题，所以我使用了 newAddDialog 的指针。然后，出现对话框，当我单击确定或取消时，对话框关闭，但即使单击确定，if 语句代码也不会执行。

有谁知道如何进行？谢谢。

* * *

进一步澄清：

我在另一个类中覆盖的 Dialog 子类中有虚拟 void 函数。当我覆盖时，我似乎无法让事件工作，但是，如果我在实际的 Dialog 子类中有一个 void，我会收到事件调用。这似乎是一个过度的问题，但我不知道问题会是什么。这不是我在 OnInit() 调用中调用的主 GUI——这可能是个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T21:27:30.213

`ShowModal`阻止程序的执行并返回结果（如 wxID_OK）。另一方面，`Show`只显示对话框并立即返回，因此您无法从其返回值检查结果（用户按下按钮的内容）。相反，您必须通过从对话框或类似的东西发送事件来传达该对话框的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T02:32:21.633

```
AddDialog newAddDialog = new AddDialog(... 
```

这能编译吗？真的吗？

'new' 运算符返回一个指向 void 的指针，因此您发布的代码看起来确实很奇怪。

通常的做法是：

```
AddDialog * newAddDialog = (AddDialog *) new AddDialog( ... 
```

或者

```
AddDialog newAddDialog( ... 
```

# entity-framework - 重新处理 EF 嵌套连接以避免 Azure 上的 MSDTC

> ID：13961294
> 
> 赞同：2
> 
> 时间：2012-12-19T21:13:59.180
> 
> 标签：entity-framework, transactionscope, msdtc

我已部署到不支持 MSDTC 的 Azure 和 Azure SQL，我无法理解如何修改我的代码以防止我假设的嵌套连接。我对 EF 还很陌生，我对 TransactionScope 的了解并不好，所以我不确定我是否有正确的模式。

我正在尝试使用 repos，它调用 ObjectContext 的共享实例（我试图处理 EndRequest 但有问题，所以这对我来说是另一个问题）。

我有一个事务多次调用 ObjectContext 实例上的 SaveChanges，但在某些时候它会被释放。是什么控制了这个，你能推荐我能做些什么来让它正常工作吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T10:32:42.430

如果您想避免分布式事务的问题，您必须手动处理连接，因为每个上下文实例只需要一个打开的连接`TransactionScope`= 一个上下文实例，其中一个连接用于所有查询和数据库更新。代码应如下所示：

```
using (var context = new YourObjectContext()) {
    context.Connection.Open();

    ...
} 
```

> 我正在尝试使用 repos，它调用 ObjectContext 的共享实例（我试图在 EndRequest 上处理但有问题，所以这对我来说是另一个问题）。

如果您在多个请求之间共享您的上下文实例，或者更糟糕的是，如果您只使用单个上下文实例来处理您的所有请求，您现在应该停止并完全重新设计您的应用程序。[否则将无法正常工作。](https://stackoverflow.com/questions/3653009/entity-framework-and-connection-pooling/3653392#3653392)

# c# - 为什么此数据未显示在 DataGridView 中

> ID：13961295
> 
> 赞同：0
> 
> 时间：2012-12-19T21:14:01.370
> 
> 标签：c#, winforms, linq, datagridview

我正在使用从 Access 数据库中检索数据，并且可以通过将其 DataSource 设置为`CoolStorage`来成功填充团队。`DataGridView``Team.List()`

但是，我想对结果集使用 LINQ 查询来返回每个团队的用户数。正如此屏幕截图所示，结果返回正常，`DataGridView`但未显示任何数据。如果我切换它`DataSource`，`Team.List()`它会显示没有任何问题的团队（尽管显然不是用户数量）。

为了将 LINQ 结果用作数据源，我需要做些什么吗？我可以通过向我的 Team 类添加一个属性来解决这个问题，但是我不明白为什么我不能使用 LINQ 结果。

![截屏](../Images/2d0ae191ee3ad5e73968c200a360860e.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T21:26:57.937

您需要先实现您的数据源，然后才能使用它。

尝试改变

```
this.dgvTeams.DataSource = d; 
```

到

```
this.dgvTeams.DataSource = d.ToList(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T21:30:53.153

LINQ 使用延迟执行。也就是说，您已经构建了 LINQ 查询，但它实际上不会被评估以产生结果，除非您在查询末尾添加方法或聚合以强制立即评估，或者您可以枚举结果。

尝试使用...

```
this.dgvTeams.DataSource = d.ToList(); 
```

# c# - 如何将 Checkbox 动态添加到 WPF 应用程序中的网格中

> ID：13961297
> 
> 赞同：1
> 
> 时间：2012-12-19T21:14:01.830
> 
> 标签：c#, wpf, linq-to-sql, checkbox, grid

当窗口加载到我的 C# 桌面应用程序中时，我想`Checkbox`在控件中动态添加一些内容。`Grid`复选框将出现多少次取决于表中的条目数。在这里，我使用`LINQ To SQL`了类。Grid 控件在 XAML 中定义。

```
...
<Grid Name="grid1">
   <!-- here i would like to show all check box -->
</Grid>
... 
```

文件后面的代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Shapes;
// class declaration ...
...
private void course_Loaded(object sender, RoutedEventArgs e)
    {
        List<Course> courses = ldc.Courses.ToList();
        foreach (var c in courses)
        {
            CheckBox cb = new CheckBox();
            cb.Name=c.CourseID.ToString();
            cb.Content = c.CourseID.ToString();
            //grid1.Controls.Add(cb); does not work. what to do here?
        }
    } 
```

此代码不起作用。有什么建议吗？谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T04:29:52.573

我建议将这些 CheckBoxes 添加到 StackPanel，然后将 StackPanel 添加到网格中：

```
StackPanel innerStack;

private void course_Loaded(object sender, RoutedEventArgs e)
{
    innerStack= new StackPanel 
    {
        Orientation=Orientation.Vertical
    };
    List<Course> courses = ldc.Courses.ToList();

    foreach (var c in courses)
    {
        CheckBox cb = new CheckBox();
        cb.Name = c.CourseID.ToString();
        cb.Content = c.CourseID.ToString();
        innerStack.Children.Add(cb);
    }
    Grid.SetColumn(innerStack,  /*Set the column of your stackPanel, default is 0*/);
    Grid.SetRow(innerStack,  /*Set the row of your stackPanel, default is 0*/);
    Grid.SetColumnSpan(innerStack,  /*Set the columnSpan of your stackPanel, default is 1*/);
    Grid.SetRowSpan(innerStack,  /*Set the rowSpan of your stackPanel, default is 1*/);

    Grid.Children.Add(innerStack);
} 
```

如果您不想要这种结构，您应该在网格中添加一些 RowDefinition 并使用 Grid.SetRow(cb, int) 方法将 ComboBoxes 相互叠加。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T21:29:07.710

你这样做是错的。

先说可以做grid1.Children.Add(cb);

那么真正的问题是您正在使用网格来显示列表。在 WPF 中有一个非常好的 ListView，它具有完全可样式化的行，可以包括复选框和几乎所有你能想象到的东西。

我不知道您的数据是什么样的，所以我无法在 ListView 上进行太多扩展，但类似于

```
<ListView ItemsSource="{Binding Courses}">
     <ListView.View>
           <GridView>
                <GridViewColumn Width="120">
                      <GridViewColumnHeader>
                            <TextBlock Text="Course Name"/>
                      </GridViewColumnHeader>
                      <GridViewColumn.CellTemplate>
                           <DataTemplate>
                                <TextBlock Text="{Binding ...UFigureThisOut}"/>
                           </DataTemplate>
                      </GridViewColumn.CellTemplate>
                </GridViewColumn>
                <GridViewColumn Width="120">
                      <GridViewColumnHeader>
                            <TextBlock Text="Take That"/>
                      </GridViewColumnHeader>
                      <GridViewColumn.CellTemplate>
                           <DataTemplate>
                                <CheckBox IsChecked="{Binding ...UFigureThisOutToo}"/>
                           </DataTemplate>
                      </GridViewColumn.CellTemplate>
                </GridViewColumn> 
           </GridView> 
     </ListView.View>
</ListView> 
```

# c# - 冒泡要订阅的事件

> ID：13961299
> 
> 赞同：5
> 
> 时间：2012-12-19T21:14:03.270
> 
> 标签：c#, wcf, events

我有一个类`ChatManager`，其中有一个`ChatServer`和一个`ChatClient`（WCF）类。

我希望我的控制器实例化`ChatManager`能够订阅和上`UserConnected`的事件。`UserDisconnected``MessageReceived``ChatClient`

最优雅和最合乎逻辑的方法是什么？`ChatClient`以我的方式定义事件，然后重新定义事件，`ChatManager`仅将事件传递给控制器​​，而无需处理或了解控制器，这对我来说是愚蠢的`ChatClient`吗？The`ChatManager`将订阅 的事件`ChatClient`，然后触发它自己`ChatController`正在监听的事件。

我知道 WPF 有事件冒泡的概念，但我不知道这是否适用于这种类型的场景，因为没有任何东西是用户界面的一部分。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T21:35:22.357

我会首先质疑两者是否都`ChatManager`可以`ChatController`证明自己的存在。通常，当您发现自己创建了一个“Manager”类时，实际上并没有必要，尤其是当它正在做的部分工作仅包括中继消息时。

控制器类可能会与 SRP 抗争，因为它们的“职责”非常广泛。如果您想为某些行为委派责任，则将责任留给`ChatClient`控制器，并使用（通过合同接口）初始化从属控制器，`ChatClient`以便它可以根据需要与客户端交互。只要确保当您开始注册事件时，在丢弃下属或客户端之前取消注册这些事件，否则您将看到托管内存泄漏。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T21:35:03.140

您正在寻找的不是冒泡事件。您可以通过调用父类 (ChatManager) 中的子类实例并像这样订阅事件来轻松订阅这些事件：

```
chatManager.UserConnected += (param1, param2) => {
    //your code here
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T21:25:06.410

除非您需要一个事件仅有条件地到达将订阅它的事物（或由多个处理程序按顺序处理），否则“冒泡”并不是您真正应该需要的。使用[事件聚合器](http://msdn.microsoft.com/en-us/library/ff921122%28v=PandP.20%29.aspx)可能是最好的方法。

# ruby - Ruby：如何在时间对象中获取子午线？

> ID：13961301
> 
> 赞同：4
> 
> 时间：2012-12-19T21:14:03.933
> 
> 标签：ruby, time

如果我有一个时间对象：

```
t = Time.now 
```

我想知道那个时间是上午还是下午，现在我能想到的唯一方法是：

```
t.strftime("%p") == "PM" 
```

现在，这`%p`是从某些东西中插入的，对吧？还有其他方法可以达到吗？

我问是因为我正在做一些时间格式化，我想显示一个时间范围，比如：

```
"9:00 AM - 5:00 PM"
"4:00 - 5:30 PM"
"10:15 - 11:45 AM" 
```

现在我必须检查 的字符串值`strftime`，但我更喜欢写如下内容：

```
if start_time.am? && end_time.pm? || start_time.pm? && end_time.am? 
```

`strftime`...而不是我现在正在做的更冗长的字符串比较。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T21:18:57.440

基于[http://www.ruby-doc.org/core-1.9.3/Time.html](http://www.ruby-doc.org/core-1.9.3/Time.html)，我不相信还有其他方法。您可以使用猴子补丁 Time 来节省一些乏味的 strftime，但是：

```
class Time
  def meridian
    self.strftime('%p')
  end

  def am?
    self.meridian == 'AM'
  end

  def pm?
    self.meridian == 'PM'
  end
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T21:18:19.860

没有什么比这更好的了，`time.am?`但你可以用它`time.hour < 12`来代替。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T21:21:43.230

```
class Time
  def am?
    self.hour.in? (0..12)
  end

  def pm?
    self.hour.in? (13..24)
  end
end 
```

# javascript - Mongoosejs 刷新文档

> ID：13961303
> 
> 赞同：9
> 
> 时间：2012-12-19T21:14:12.983
> 
> 标签：javascript, node.js, mongodb, mongoose

假设我有一个文档，例如： var doc = Model.findOne({name:"name"});

现在，如果文档通过数据库的另一个连接进行编辑，则 doc 不包含正确的信息。我确实需要它，所以我必须从数据库中“刷新”或“重新下载”它。有没有办法只用对象“doc”来做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-19T22:14:57.847

假设`doc`包含要刷新的文档实例，您可以执行此操作来一般刷新它：

```
doc.model(doc.constructor.modelName).findOne({_id: doc._id},
    function(err, newDoc) {
        if (!err) {
            doc = newDoc;
        }
    }
); 
```

但是，最好不要持久化/缓存 Mongoose 文档实例超出您对它们的迫切需要。缓存`_id`您需要快速访问的不可变文档，而不是文档本身。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-02-26T17:26:37.270

抱歉，我知道这很旧，但我有一个更好的解决方案，以防其他人仍在四处张望。

在这种并发访问同一文档的情况下，您可以执行正常保存。

Mongoose 使用对象的 __v 属性来确保旧实例不会覆盖最新实例。

因此，如果您有 2 个 doc.__v = 0 实例，并且 A 先保存，则数据库现在具有 doc.__v = 1。所以当 B 保存时，它会出错，因为 B.__v = 0，而不是 1。所以然后你可以做的是捕捉错误（它应该是一个特定的猫鼬错误）并通过刷新对象来处理它（它应该将它提升到 __v = 1）然后根据你想要的保存或不保存它去做。

所以在代码中

```
doc.save(function (err, _doc) {
    if (err) {
        if (err.some_error_property_telling_you_version_was_wrong) {
            // Do your business here 
            // Refresh your object
            // Model.findById(doc._id, function (err, _refreshed_doc) {});
            // doc = _refreshed_doc;
            // doc.set('property', value); set the value again
            // Then re-save? or maybe make this a recursive function,
            // so it can keep trying to save the object?
        } else {
            // Handle it like a normal error
        }
    }
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-06-28T00:20:26.793

如果它是用你定义的，`let`你可以做

```
await thing.update(stuff);
thing = await Thing.findById(thing._id); 
```

或者如果是这样，`const`那么就一成不变地这样做：

```
await thing.update(stuff);
const updatedThing = await Thing.findById(thing._id); 
```

# objective-c - 重新启动应用程序的按钮

> ID：13961308
> 
> 赞同：2
> 
> 时间：2012-12-19T21:14:56.287
> 
> 标签：objective-c, ios, cocoa-touch

我一直在制作一个需要帮助的应用程序。在我完成我希望应用程序执行的操作后，它会进入一个新页面。当我按下返回按钮时，它仍然处于与我离开时相同的状态。当我按下按钮时，我希望第一个视图完全重置。关于如何做到这一点的任何建议？任何帮助表示赞赏！

以下是按钮当前功能的代码：

```
- (IBAction)retry:(id)sender 
{
   [self dismissModalViewControllerAnimated:YES];
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T21:41:31.240

在最初显示的 viewController 上实现 viewWillAppear，如下所示：

```
- (void)viewWillAppear:(BOOL)animated
{
    //
    //put your code to reset this viewController into its initial state here
    //
    [self resetAllStatesBackToDefault];
} 
```

举个例子，假设你`UITextField`在第一个 viewController 上有一个名为`textField`;

```
- (void)resetAllStatesBackToDefault
{
    self.textField.text = @"";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T21:24:21.690

你需要的是`-(void)viewDidAppear:(BOOL)animated;`

# ruby-on-rails - 无法让 nested_form 显示验证错误

> ID：13961310
> 
> 赞同：0
> 
> 时间：2012-12-19T21:15:04.837
> 
> 标签：ruby-on-rails, ruby-on-rails-3, validation, nested-forms

我之前没有遇到过验证问题，但这次我遇到了nested_form 验证问题。我正在使用 Twitter Bootstrap，并且可以通过以下方式显示 flash 错误：

```
 def create
 @recipe = current_user.recipes.new(params[:recipe])
 if @recipe.save
  redirect_to my_recipes_path, :notice => "Thanks #{current_user.name} Recipe sucessfully created."
  else
  render :action => 'new'
 end
end 
```

对于我的 Flash 消息，我在我的应用程序/布局中使用它

```
 <% flash.each do |name, msg| %>
 <div class="alert alert-<%= name == :notice ? "success" : "error" %>">
  <a class="close" data-dismiss="alert">×</a>
  <%= content_tag :div, msg, :id => "flash_#{name}" if msg.is_a?(String) %>
 </div>
 <% end %> 
```

所以我想我会尝试让其中一个验证器工作，所以我的模型

```
class Recipe < ActiveRecord::Base

belongs_to :user
delegate :name, :to => :user, :prefix => :user, :allow_nil => true
belongs_to :country
has_many :ingredients 
has_many :preperations
has_many :favourites 
```

validates_presence_of :dish_name

和我的表格

```
 <%= nested_form_for @recipe  do |f| %>

    <div class="field_with_errors"> 
    <%= f.label :dish_name, "Dish Name" %>
    <%= f.text_field :dish_name, :placeholder => "Enter Dish Name" %>
    </div>

    <%= f.label :country_id, "Country Of Origin" %>
    <%= f.collection_select(:country_id, Country.all, :id, :name, :prompt => 'Please select country') %>

    <%= f.label :category, "Category" %>
    <%= f.select :category, [['Starter'], ['Main Course'], ['Desserts'],  ['Vegeterian']], {:include_blank => 'Please Select'} %>

   <%= f.label :difficulty, "Difficulty Level" %>
   <%= f.select :difficulty, [['Beginner'],['Intermediate'],['Expert']], {:include_blank => 'Please Select'} %>

   <%= f.label :preperation_time, "Preperation Time (Mins)" %>
   <%= f.select :preperation_time, [['15-30 Mins'],['30-60 Mins'],['60-120 Mins']], {:include_blank => 'Please Select'} %>

   <%= f.fields_for :ingredients do |ing| %>
   Ingredient<br>
   <%= ing.text_field :ingredient_name , :placeholder => "Enter Ingredient Here" %><br>
   <% end %>
   <%= f.link_to_add "Add an Ingredient", :ingredients %><br>

   <%= f.fields_for :preperations do |prep| %>
   Preperation Step<br>
   <%= prep.text_field :prep_steps , :placeholder => "Enter step Here" %><br>
   <% end %>

   <%= f.link_to_add "Add a step", :preperations %><br>

   <%= f.label :description, "Description of Recipe" %>
   <%= f.text_area :description, :size=> "60x10" %></br>

   <%= f.file_field :avatar %><br>

   <%= f.submit "Submit Recipe" %>
   <% end %> 
```

我对 Rails 还很陌生，所以我可能错过了一些基本的东西，还是因为它是一个嵌套形式并且行为不同？

## 编辑

输出`<%= flash debug %>`：

```
 --- !ruby/object:ActionDispatch::Flash::FlashHash
 used: !ruby/object:Set
 hash: {}
 closed: false
 flashes: {}
 now: 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T21:39:55.070

看来您实际上并没有为您的闪存哈希提供任何可使用的消息。一个快速的解决方案可能是这样的：

```
def create
 @recipe = current_user.recipes.new(params[:recipe])
 if @recipe.save
   redirect_to my_recipes_path, :notice => "Thanks #{current_user.name} Recipe sucessfully created."
 else
   flash[:error] =  @recipe.errors.full_messages.to_sentence
   render :action => 'new'
 end
end 
```

# java - 程序不会打开新窗口

> ID：13961313
> 
> 赞同：0
> 
> 时间：2012-12-19T21:15:10.367
> 
> 标签：java, android, xml

我正在尝试为 android 制作游戏，但我的 windows 出现了一些问题。

我可以从“mainactivity”打开“newgame”窗口，我正在尝试使用“back”按钮，但我无法让它工作。

我也无法从第二个“newgame”窗口打开新窗口（正在测试它是否会开始“加载”）

这可能是一个愚蠢的错误，但我不知道为什么它不起作用。大多数应用程序教程都处理一个窗口，因此对我没有帮助

我的代码：

**主要活动.java：**

```
package dream.o.eternaty;

import android.os.Bundle;
import android.app.Activity;
import android.view.Menu;
import android.view.View;
import android.widget.Button;

public class MainActivity extends Activity {
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        setContentView(R.layout.activity_main);
        final Button NewGame = (Button) findViewById(R.id.button1);
        NewGame.setOnClickListener(new View.OnClickListener() {
            public void onClick(View v) {
                setContentView(R.layout.newgame);
            }
        });

        final Button Load = (Button) findViewById(R.id.button2);
        Load.setOnClickListener(new View.OnClickListener() {
            public void onClick(View v) {
                setContentView(R.layout.loadgame);
            }});  
        }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }
} 
```

**新游戏.java：**

```
package dream.o.eternaty;
import android.os.Bundle;
import android.app.Activity;
import android.view.Menu;
import android.view.View;
import android.widget.Button;

public class NewGame extends Activity {
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.newgame);
        final Button Back = (Button) findViewById(R.id.newgameback);
        Back.setOnClickListener(new View.OnClickListener() {
            public void onClick(View v) {
                setContentView(R.layout.loadgame);
            }
        });
    };

    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }});
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-19T21:21:23.643

您不应该转换视图，而是实际上为 NewGame 启动一个新活动，正如您所声明的那样，您可以这样做

```
Intent newIntent = new Intent(MainActivity.this,NewGame.class);
startActivityForResult(newIntent, 0); 
```

在 MainActivity 的 onClick 监听器中

# php - 带有 HTTPS 网络服务和 .PEM 客户端证书的 PHP SOAP

> ID：13961321
> 
> 赞同：1
> 
> 时间：2012-12-19T21:15:51.647
> 
> 标签：php, web-services, soap, certificate, soapheader

如何使用 HTTPS Web 服务和 .PEM 客户端证书创建 PHP SOAP？

当我这样做时，我收到以下错误：

> 数组（2）{[0]=>字符串（38）“testeResponse teste（teste $parameters）”[1]=>字符串（38）“testeResponse teste（teste $parameters）”}
> 
> 致命错误：未捕获的 SoapFault 异常：[wsse:InvalidSecurity] D:\Inetpub\wwwroot\SOAP\index.php:47 中缺少 SOAP 标头 堆栈跟踪：#0 [内部函数]：SoapClient->__call('teste', Array ) #1 D:\Inetpub\wwwroot\SOAP\index.php(47): SoapClient->teste(Array) #2 {main} 在第 47 行的 D:\Inetpub\wwwroot\SOAP\index.php 中抛出

编码：

```
$client = new SoapClient($wsdl, array(
    'local_cert'  => $localCert, 
     'passphrase' => $passphrase, 
     'style'      => SOAP_DOCUMENT, 
     'use'        => SOAP_LITERAL, 
     'exceptions' => true, 
     'trace'      => true)
);
$something = $client->teste(array());
echo $something->testeResult; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T21:24:41.037

该警告与 PEM 证书或 SSL 无关。很简单：

> 缺少 SOAP 标头

您可以[`SOAPHeader`在 PHP 手册中](http://php.net/class.soapheader)找到。PHP 手册中有一些使用示例和用户贡献的注释，本网站也有。例如：

```
$auth = array(
    'UserName' => 'USERNAME',
    'Password' => 'PASSWORD',
    'SystemId' => array('_'=> 'DATA', 'Param' => 'PARAM'),
);
$header = new SoapHeader('NAMESPACE','Auth',$auth,false);
$client->__setSoapHeaders($header); 
```

如果您遇到问题，请告诉我。

# php - PHP脚本在每次迭代中花费越来越长的时间来保存数据

> ID：13961322
> 
> 赞同：3
> 
> 时间：2012-12-19T21:15:56.497
> 
> 标签：php, memory, time

我编写了一个自动化脚本来解析本地的 XML 文件，从 XML 中提取一些 url，然后下载 url 指向的文件并存储数据（所有 jpg 的）。每次后续迭代逐渐花费越来越长的时间。最终，脚本只是挂起，没有任何反应。哦，内存使用量似乎保持不变。XML 解析工作正常，所以请不要过多关注。如果我在脚本完全停止的游戏中启动脚本，则会在一秒钟内将文件保存到磁盘，因为这是脚本所做的第一次保存。这是什么原因造成的？这是代码：

```
 <?php

$xml = simplexml_load_file('./playfin.xml', null, LIBXML_NOCDATA);

echo("Getting urls from the XML...\n");
$data = array();
foreach($xml->game as $game) {
  $smlBox = $game->small_boxshot_image->url;
  $lrgBox = $game->large_boxshot_image->url;

  foreach($game->screenshots->screenshot_image as $image) {
    $scrShots[] = array(
      'smlScr' => (string)$image->small_screenshot_image->url,
      'lrgScr' => (string)$image->large_screenshot_image->url  
    );
  }
  $data[] = array(
    'id' => (int)$game->game_id,
    'smlBox' => (string)$smlBox,
    'lrgBox' => (string)$lrgBox,
    'scrShots' => $scrShots
  );
} 
echo("Done pulling urls from XML...\n");

echo("Storing picture data to disk...\n");
$start = time();
$total = 0;
$now = 0;
for($i = 0; $i < count($data); $i++) {
  $total += $now;
  $now = time() - $start - $total;
  echo("Writing game id: ".$data[$i]['id']. 
    ." to disk at time=".(string)$now."          seconds.\n");
  echo("Memory usage: ".(string)memory_get_usage(true)."\n\n");
  $smlBoxStr = '%s_49_60.jpg';
  $lrgBoxStr = '%s_160_189.jpg';
  $smlScrStr = '%s_115_86_%d.jpg';
  $lrgScrStr = '%s_300_300_%d.jpg';

  writeData($data[$i]['smlBox'], sprintf($smlBoxStr, $data[$i]['id']), 'boxshot');
  writeData($data[$i]['lrgBox'], sprintf($lrgBoxStr, $data[$i]['id']), 'boxshot');
  for($j = 0; $j < count($data[$i]['scrShots']); $j++) {
    writeData(
      $data[$i]['scrShots'][$j]['smlScr'], 
      sprintf($smlScrStr, $data[$i]['id'], $j),
      'screenshot'
    );
    writeData(
      $data[$i]['scrShots'][$j]['lrgScr'], 
      sprintf($lrgScrStr, $data[$i]['id'], $j),
      'screenshot'
    );
  }  
}
echo("Done storing!\n");
echo("Done!\n");

function writeData($url, $file, $type) {
  $headers = get_headers($url, 1);
  $awayPic = fopen($url, 'rb');
  $localPic = fopen("./$type/$file", 'wb');
  while($picData = fread($awayPic, (int)$headers['Content-Length'])) {
    fwrite($localPic, $picData);
  }
  fclose($awayPic);
  fclose($localPic);
}  

?> 
```

这是生成的日志文件：

> 从 XML 中获取 url... 完成从 XML 中提取 url... 将图片数据存储到磁盘... 在 time=0 秒时将游戏 id: 671850 写入磁盘。内存使用量：77856768
> 
> 在 time=0 秒时将游戏 id: 730950 写入磁盘。内存使用量：77856768
> 
> 在 time=1 秒时将游戏 id: 621650 写入磁盘。内存使用量：77856768
> 
> 在 time=1 秒时将游戏 id: 687250 写入磁盘。内存使用量：77856768
> 
> 在时间 = 7 秒时将游戏 ID：633950 写入磁盘。内存使用量：77856768
> 
> 在 time=2 秒时将游戏 id: 633850 写入磁盘。内存使用量：77856768
> 
> 在 time=2 秒时将游戏 id: 720950 写入磁盘。内存使用量：77856768
> 
> 在 time=3 秒时将游戏 id: 572250 写入磁盘。内存使用量：77856768
> 
> 在 time=3 秒时将游戏 id: 674950 写入磁盘。内存使用量：77856768
> 
> 在 time=3 秒时将游戏 id: 731450 写入磁盘。内存使用量：77856768
> 
> 在 time=4 秒时将游戏 id: 656350 写入磁盘。内存使用量：77856768
> 
> 在 time=4 秒时将游戏 id: 653550 写入磁盘。内存使用量：77856768
> 
> 在时间 = 4 秒时将游戏 ID：585550 写入磁盘。内存使用量：77856768
> 
> 在 time=5 秒时将游戏 id: 736750 写入磁盘。内存使用量：77856768
> 
> 在时间 = 5 秒时将游戏 ID：671350 写入磁盘。内存使用量：77856768
> 
> 在 time=5 秒时将游戏 id: 696250 写入磁盘。内存使用量：77856768
> 
> 在时间 = 6 秒时将游戏 ID：645550 写入磁盘。内存使用量：77856768
> 
> 在 time=6 秒时将游戏 id: 625650 写入磁盘。内存使用量：77856768
> 
> 在 time=6 秒时将游戏 id: 696850 写入磁盘。内存使用量：77856768
> 
> 在时间 = 7 秒时将游戏 ID：709550 写入磁盘。内存使用量：77856768
> 
> 在时间 = 7 秒时将游戏 ID：575750 写入磁盘。内存使用量：77856768
> 
> 在时间 = 7 秒时将游戏 ID：651950 写入磁盘。内存使用量：77856768
> 
> 在时间 = 8 秒时将游戏 ID：685350 写入磁盘。内存使用量：77856768
> 
> 在时间 = 9 秒时将游戏 ID：724150 写入磁盘。内存使用量：77856768
> 
> 在时间 = 8 秒时将游戏 ID：522250 写入磁盘。内存使用量：77856768
> 
> 在时间 = 10 秒时将游戏 ID：610350 写入磁盘。内存使用量：77856768
> 
> 在时间 = 9 秒时将游戏 ID：645050 写入磁盘。内存使用量：77856768
> 
> 在时间 = 9 秒时将游戏 ID：716950 写入磁盘。内存使用量：77856768
> 
> 在 time=10 秒时将游戏 id: 672750 写入磁盘。内存使用量：77856768
> 
> 在时间 = 11 秒时将游戏 ID：568650 写入磁盘。内存使用量：77856768
> 
> 在时间 = 11 秒时将游戏 ID：668650 写入磁盘。内存使用量：77856768
> 
> 在时间 = 11 秒时将游戏 ID：417950 写入磁盘。内存使用量：77856768
> 
> 在时间 = 13 秒时将游戏 ID：497950 写入磁盘。内存使用量：77856768
> 
> 在时间 = 12 秒时将游戏 ID：567950 写入磁盘。内存使用量：77856768
> 
> 在时间 = 13 秒时将游戏 ID：692350 写入磁盘。内存使用量：77856768
> 
> 在时间 = 13 秒时将游戏 ID：450950 写入磁盘。内存使用量：77856768
> 
> 在时间 = 14 秒时将游戏 ID：452750 写入磁盘。内存使用量：77856768
> 
> 在时间 = 14 秒时将游戏 ID：666450 写入磁盘。内存使用量：77856768
> 
> 在时间 = 15 秒时将游戏 ID：754550 写入磁盘。内存使用量：77856768
> 
> 在时间 = 15 秒时将游戏 ID：659050 写入磁盘。内存使用量：77856768
> 
> 在时间 = 15 秒时将游戏 ID：712350 写入磁盘。内存使用量：77856768
> 
> 在时间 = 16 秒时将游戏 ID：719250 写入磁盘。内存使用量：77856768
> 
> 在时间 = 15 秒时将游戏 ID：529250 写入磁盘。内存使用量：77856768
> 
> 在时间 = 17 秒时将游戏 ID：685150 写入磁盘。内存使用量：77856768
> 
> 在时间 = 17 秒时将游戏 ID：736450 写入磁盘。内存使用量：77856768
> 
> 在时间 = 17 秒时将游戏 ID：252750 写入磁盘。内存使用量：77856768
> 
> 在时间 = 17 秒时将游戏 ID：719150 写入磁盘。内存使用量：77856768
> 
> 在时间 = 18 秒时将游戏 ID：461150 写入磁盘。内存使用量：77856768
> 
> 在时间 = 18 秒时将游戏 ID：699450 写入磁盘。内存使用量：77856768
> 
> 在时间 = 18 秒时将游戏 ID：523550 写入磁盘。内存使用量：77856768
> 
> 在 time=20 秒时将游戏 id: 451050 写入磁盘。内存使用量：77856768
> 
> 在时间 = 19 秒时将游戏 ID：768350 写入磁盘。内存使用量：77856768
> 
> 在 time=20 秒时将游戏 id: 724650 写入磁盘。内存使用量：77856768
> 
> 在 time=21 秒时将游戏 id: 676550 写入磁盘。内存使用量：77856768
> 
> 在时间 = 21 秒时将游戏 ID：730850 写入磁盘。内存使用量：77856768
> 
> 在时间 = 22 秒时将游戏 ID：558250 写入磁盘。内存使用量：77856768
> 
> 在时间 = 22 秒时将游戏 ID：674750 写入磁盘。内存使用量：77856768
> 
> 在 time=22 秒时将游戏 id: 695450 写入磁盘。内存使用量：77856768
> 
> 在时间 = 22 秒时将游戏 ID：682950 写入磁盘。内存使用量：77856768
> 
> 在时间 = 24 秒时将游戏 ID：706450 写入磁盘。内存使用量：77856768
> 
> 在时间 = 24 秒时将游戏 ID：546450 写入磁盘。内存使用量：77856768
> 
> 在时间 = 24 秒时将游戏 ID：575350 写入磁盘。内存使用量：77856768
> 
> 在时间 = 25 秒时将游戏 ID：616550 写入磁盘。内存使用量：77856768
> 
> 在 time=26 秒时将游戏 id: 648250 写入磁盘。内存使用量：77856768
> 
> 在时间 = 25 秒时将游戏 ID：763750 写入磁盘。内存使用量：77856768
> 
> 在 time=26 秒时将游戏 id: 613850 写入磁盘。内存使用量：77856768
> 
> 在时间 = 25 秒时将游戏 ID：645450 写入磁盘。内存使用量：77856768
> 
> 在时间 = 33 秒时将游戏 ID：695950 写入磁盘。内存使用量：77856768
> 
> 在时间 = 27 秒时将游戏 ID：661050 写入磁盘。内存使用量：77856768
> 
> 在时间 = 27 秒时将游戏 ID：461050 写入磁盘。内存使用量：77856768
> 
> 在时间 = 29 秒时将游戏 ID：693150 写入磁盘。内存使用量：77856768

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T21:27:37.657

问题是您在`$scrShots`解析 XML 时没有清除外部循环。因此，每次迭代不仅包含当前游戏的屏幕截图，还包含之前所有游戏的屏幕截图。（这样，你从第一场比赛下载图像，然后从第一场比赛的图像加上第二场比赛的图像，然后从第一场比赛加上第二场比赛加上第三场比赛，依此类推，当然这需要越来越长的时间。）

在添加下一轮之前尝试清除数组：

```
$scrShots = array();
foreach($game->screenshots->screenshot_image as $image) {
    $scrShots[] = array(
    ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T21:34:32.137

除了 Wolfgang 发现的问题（主要问题）之外，您还错误地计算了时间（次要问题）。

```
Writing game id: 687250 to disk at time=1 seconds. Memory usage: 77856768
Writing game id: 633950 to disk at time=7 seconds. Memory usage: 77856768
Writing game id: 633850 to disk at time=2 seconds. Memory usage: 77856768 
```

让我们假设 $start 从 1000 开始，每次迭代需要 1 秒

```
for($i = 0; $i < count($data); $i++) {
    $total += $now;
    $now = time() - $start - $total; 
```

那么这将是您在每次循环迭代之后的值

```
1: $total: 0, $now: 1000 - 1000 - 0 = 0
2: $total: 0, $now: 1001 - 1000 - 0 = 1
3: $total: 1, $now: 1002 - 1000 - 1 = 1
4: $total: 1, $now: 1003 - 1000 - 1 = 2
5: $total: 2, $now: 1004 - 1000 - 2 = 2
6: $total: 2, $now: 1005 - 1000 - 2 = 3
7: $total: 3, $now: 1006 - 1000 - 3 = 3
7: $total: 3, $now: 1007 - 1000 - 3 = 4 
```

这绝对不是你想要的。不知道您为什么使用总计来计算您的 $now。:)

我想这就是你想要的。

```
for($i = 0; $i < count($data); $i++) {
    $now = time() - $start;
    ...
}

$total = $now - $start; 
```

# groovy - Jenkins - 动态选择参数 - 从列表中删除文件扩展名

> ID：13961325
> 
> 赞同：2
> 
> 时间：2012-12-19T21:16:00.697
> 
> 标签：groovy, jenkins

我在使用动态选择参数让我的 groovy 代码在 Jenkins 中正常工作时遇到了一些麻烦。我们目前有一个文件夹，其中包含许多用于各种环境的属性文件。以下常规代码正确返回所有文件名的列表，但是它附加了不需要的文件扩展名。

```
 Arrays.asList(new File("path").list()) 
```

我将如何将其更改为仅列出 .xml 文件而不在列表中附加文件扩展名。我在搜索时发现了一些这样的例子，但由于某种原因，当我尝试其中一些例子时，它没有填充列表。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T21:19:32.087

你的意思是：

```
new File( 'path' ).list()
                  .findAll { it.endsWith( '.xml' ) }
                  .collect { it[ 0..-5 ] } 
```

获取文件列表（作为字符串），保留以 结尾的文件`.xml`，然后从末尾删除 .xml

# machine-learning - 在 WEKA GUI 上使用分类模型对集合的实例进行分类

> ID：13961331
> 
> 赞同：2
> 
> 时间：2012-12-19T21:16:19.727
> 
> 标签：machine-learning, classification, weka, svm, arff

我是数据挖掘的新手，我想问你一个分类问题。我使用 ARFF 格式的训练集在 WEKA (GUI) 上训练了分类算法。因此，我将其保存为模型格式以备将来使用。现在我想在 WEKA (GUI) 上使用这个分类模型来获得也是 ARFF 格式的集合实例的预测类。您能否给我一些关于如何在 WEKA 上执行此操作的说明？与 Weka Java API 不同，GUI 版本在 Web 上的文档非常糟糕，我找不到任何相关的东西。

是否可以将分类集存储回 ARFF 格式，并将“？”替换为类属性中的类标签？我需要这样的输出文件来进行一些计算。

事先谢谢你。

# html - 如何使背景图像留在底部并覆盖整个高度

> ID：13961332
> 
> 赞同：1
> 
> 时间：2012-12-19T21:16:23.593
> 
> 标签：html, css, wordpress

[我怎样才能使我的所有页面都具有与我的主页](http://healinghands.vtable.us/)相同的背景感觉。例如，如果您看到[此](http://healinghands.vtable.us/board-of-directors/)页面，您可以看到背景不合适。如果您希望我将代码发送给您，请告诉我，但您几乎可以在这些页面上看到它。非常感谢！

PS：除了使用固定位置还有其他方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T21:23:57.423

尝试不同的方法...而不是在两个不同的 div (`#hhbg`和`#footer`) 中使用 2 个不同的渐变，只需将两个渐变组合成一个图像并将其作为背景应用到，例如`body`. 然后使用`background-position`将图像锚定到底角并水平重复。

# wordpress - jquery ui selectmenu 与 wordpress 3.5 一起工作很奇怪

> ID：13961337
> 
> 赞同：0
> 
> 时间：2012-12-19T21:16:42.710
> 
> 标签：wordpress, jquery-ui, contact-form-7, jquery-ui-selectmenu

[我在 wordpress 的 3.4 版http://xn--5dbaaldanagj3al0n.org.il/](http://xn--5dbaaldanagj3al0n.org.il/)上构建此表单

我像这样植入`jquery ui`文件

```
add_action( 'init', 'frontporch_enqueue_scripts' );
function frontporch_enqueue_scripts() {
    if (!is_admin() ) {
        wp_enqueue_script( 'jquery' );
        wp_register_script( 'google-jquery-ui', 'http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.12/jquery-ui.min.js', array( 'jquery' ) );

        wp_register_script( 'ui-core', get_bloginfo('template_directory').'/ui/jquery.ui.core.js',array('jquery'), true);
        wp_register_script( 'ui-position', get_bloginfo('template_directory').'/ui/jquery.ui.position.js',array('jquery'), true);
        wp_register_script( 'ui-selectmenu', get_bloginfo('template_directory').'/ui/jquery.ui.selectmenu.js',array('jquery'), true);
        wp_register_script( 'ui-widget', get_bloginfo('template_directory').'/ui/jquery.ui.widget.js',array('jquery'), true);       
        wp_register_style( 'jquery-core', get_bloginfo('template_directory').'/themes/base/jquery.ui.core.css', true);
        wp_register_style( 'jquery-selectmenu', get_bloginfo('template_directory').'/themes/base/jquery.ui.selectmenu.css', true);
        wp_register_style( 'jquery-theme', get_bloginfo('template_directory').'/themes/base/jquery.ui.theme.css', true);        
        wp_enqueue_style( 'jquery-core' );
        wp_enqueue_style( 'jquery-selectmenu' );
        wp_enqueue_style( 'jquery-theme' );     
        wp_enqueue_script( 'google-jquery-ui' );
        wp_enqueue_script( 'ui-core' );
        wp_enqueue_script( 'ui-position' );
        wp_enqueue_script( 'ui-selectmenu' );
        wp_enqueue_script( 'ui-widget' );
    }       
} 
```

并将脚本`header.php`像这样放在文件中

```
<script>
jQuery(document).ready(function($) {
    $("#formlocation select").selectmenu();
    $("#formlocation input[type=text]").button();
});
</script> 
```

现在，当您进入[该站点](http://xn--5dbaaldanagj3al0n.org.il/)时，您会看到下拉列表看起来很奇怪，宽度假设与所有字段相同，并且选择已损坏。当我完成这个表格的开发时，一切都很顺利。

是因为3.5版本自带`jquery ui`文件吗？是3.5吗？？我试图取消 JS 实现，但没有成功

很想知道那里发生了什么提前谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T22:22:31.610

请尽量不要多次包含 jQuery UI，并确保文件的顺序正确。

因此，仅使用组合的 CDN 文件和 selectmenu js 文件，或者以正确的顺序包含所有需要的 jQuery UI 插件/小部件：Core、Widget、Position、Selectmenu。

# spring - 在 jboss AS 7.2 中部署 SpringData JPA2、hibernate cxf Web 服务时出错

> ID：13961346
> 
> 赞同：0
> 
> 时间：2012-12-19T21:17:35.003
> 
> 标签：spring, hibernate, jpa-2.0, cxf

我正在开发一个使用 Hibernate 作为持久性提供程序的 SpringData/JPA2 Web 服务。它使用以下框架： `cxf=2.6.2` `hibernate= 4.1.1.Final` `springframework=3.1.2.RELEASE` `spring.data=1.2.0.RELEASE`

与数据库相关的代码位于“核心子模块”中，在 Eclipse 进行单元测试时可以正常工作。我有另一个 webservice 子模块，它具有 core-submodule 作为依赖项。到目前为止，当我从 Eclipse 进行单元测试时，它似乎在开发过程中运行良好。现在，我已经取得了足够的进展，我正在尝试将它部署到我桌面上新安装的 jboss AS 7.2 中。我已经在standalone.xml 中设置了数据源，并且还在modules 目录中部署了jTDS 1.2.7 的驱动程序。

当我部署我的战争文件时，我得到了这个错误堆栈跟踪。我不知道从哪里开始解决这个错误。因此，任何提示或要点都值得赞赏，因为我不知道从哪里开始：（堆栈跟踪粘贴在下面：

```
 15:52:34,954 INFO  [org.springframework.context.support.ClassPathXmlApplicationContext] (MSC service thread 1-3) 
    Bean 'entityManagerFactory' of type [class org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
    15:52:34,972 INFO  [org.springframework.context.support.ClassPathXmlApplicationContext] (MSC service thread 1-3) 
    Bean 'org.springframework.transaction.annotation.AnnotationTransactionAttributeSource#0' of type [class org.springframework.transaction.annotation.AnnotationTransactionAttributeSource] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
    15:52:34,976 INFO  [org.springframework.context.support.ClassPathXmlApplicationContext] (MSC service thread 1-3) 
    Bean 'org.springframework.transaction.config.internalTransactionAdvisor' of type [class org.springframework.transaction.interceptor.BeanFactoryTransactionAttributeSourceAdvisor] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
    15:52:34,983 INFO  [org.springframework.beans.factory.support.DefaultListableBeanFactory] (MSC service thread 1-3) 
    Pre-instantiating singletons in org.springframework.beans.factory.support.DefaultListableBeanFactory@1bb71ac: defining beans [org.springframework.context.support.PropertySourcesPlaceholderConfigurer#0,org.springframework.context.support.PropertySourcesPlaceholderConfigurer#1,dataSource,entityManagerFactory,entrLoanRepository,keyRefRepository,org.springframework.data.repository.core.support.RepositoryInterfaceAwareBeanPostProcessor#0,org.springframework.dao.annotation.PersistenceExceptionTranslationPostProcessor#0,org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor#0,addKeyRefService,createEntrLoanService,disableAllKeyRefService,retrieveEntrLoanService,entrLoanServiceImpl,keyRefServiceImpl,retrieveKeyRefService,org.springframework.context.annotation.internalConfigurationAnnotationProcessor,org.springframework.context.annotation.internalAutowiredAnnotationProcessor,org.springframework.context.annotation.internalRequiredAnnotationProcessor,org.springframework.context.annotation.internalCommonAnnotationProcessor,org.springframework.context.annotation.internalPersistenceAnnotationProcessor,transactionManager,org.springframework.aop.config.internalAutoProxyCreator,org.springframework.transaction.annotation.AnnotationTransactionAttributeSource#0,org.springframework.transaction.interceptor.TransactionInterceptor#0,org.springframework.transaction.config.internalTransactionAdvisor,org.springframework.context.annotation.ConfigurationClassPostProcessor$ImportAwareBeanPostProcessor#0]; root of factory hierarchy
    15:52:35,487 INFO  [org.springframework.beans.factory.support.DefaultListableBeanFactory] (MSC service thread 1-3) 
    Destroying singletons in org.springframework.beans.factory.support.DefaultListableBeanFactory@1bb71ac: defining beans [org.springframework.context.support.PropertySourcesPlaceholderConfigurer#0,org.springframework.context.support.PropertySourcesPlaceholderConfigurer#1,dataSource,entityManagerFactory,entrLoanRepository,keyRefRepository,org.springframework.data.repository.core.support.RepositoryInterfaceAwareBeanPostProcessor#0,org.springframework.dao.annotation.PersistenceExceptionTranslationPostProcessor#0,org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor#0,addKeyRefService,createEntrLoanService,disableAllKeyRefService,retrieveEntrLoanService,entrLoanServiceImpl,keyRefServiceImpl,retrieveKeyRefService,org.springframework.context.annotation.internalConfigurationAnnotationProcessor,org.springframework.context.annotation.internalAutowiredAnnotationProcessor,org.springframework.context.annotation.internalRequiredAnnotationProcessor,org.springframework.context.annotation.internalCommonAnnotationProcessor,org.springframework.context.annotation.internalPersistenceAnnotationProcessor,transactionManager,org.springframework.aop.config.internalAutoProxyCreator,org.springframework.transaction.annotation.AnnotationTransactionAttributeSource#0,org.springframework.transaction.interceptor.TransactionInterceptor#0,org.springframework.transaction.config.internalTransactionAdvisor,org.springframework.context.annotation.ConfigurationClassPostProcessor$ImportAwareBeanPostProcessor#0]; root of factory hierarchy
    15:52:35,499 INFO  [org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean] (MSC service thread 1-3) 
    Closing JPA EntityManagerFactory for persistence unit 'persistenceUnit'
    15:52:35,503 ERROR [org.jboss.msc.service.fail] (MSC service thread 1-3) 
    MSC00001: Failed to start service jboss.deployment.unit."euclid-ws.war".
    INSTALL: org.jboss.msc.service.StartException in service jboss.deployment.unit."euclid-ws.war".
    INSTALL: JBAS018733: Failed to process phase INSTALL of deployment "euclid-ws.war"
        at org.jboss.as.server.deployment.DeploymentUnitPhaseService.start(DeploymentUnitPhaseService.java:127) [jboss-as-server-7.2.0.Alpha1-SNAPSHOT.jar:7.2.0.Alpha1-SNAPSHOT]
        at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:1811) [jboss-msc-1.0.2.GA.jar:1.0.2.GA]
        at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1746) [jboss-msc-1.0.2.GA.jar:1.0.2.GA]
        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) [rt.jar:1.6.0_33]
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) [rt.jar:1.6.0_33]
        at java.lang.Thread.run(Thread.java:662) [rt.jar:1.6.0_33]
    Caused by: java.lang.RuntimeException: org.springframework.beans.factory.BeanCreationException: 
    Error creating bean with name 'entrLoanServiceImpl': Injection of resource dependencies failed; 
    nested exception is org.springframework.beans.factory.BeanCreationException: 
    Error creating bean with name 'entrLoanRepository': 
    FactoryBean threw exception on object creation; nested exception is java.lang.NullPointerException
        at org.jboss.wsf.stack.cxf.configuration.NonSpringBusHolder.newInstance(NonSpringBusHolder.java:174)
        at org.jboss.wsf.stack.cxf.configuration.NonSpringBusHolder.configure(NonSpringBusHolder.java:96)
        at org.jboss.wsf.stack.cxf.deployment.aspect.BusDeploymentAspect.startDeploymentBus(BusDeploymentAspect.java:129)
        at org.jboss.wsf.stack.cxf.deployment.aspect.BusDeploymentAspect.start(BusDeploymentAspect.java:68)
        at org.jboss.as.webservices.deployers.AspectDeploymentProcessor.deploy(AspectDeploymentProcessor.java:74)
        at org.jboss.as.server.deployment.DeploymentUnitPhaseService.start(DeploymentUnitPhaseService.java:120) [jboss-as-server-7.2.0.Alpha1-SNAPSHOT.jar:7.2.0.Alpha1-SNAPSHOT]
        ... 5 more
    Caused by: org.springframework.beans.factory.BeanCreationException: 
    Error creating bean with name 'entrLoanServiceImpl': Injection of resource dependencies failed; 
    nested exception is org.springframework.beans.factory.BeanCreationException: 
    Error creating bean with name 'entrLoanRepository': 
    FactoryBean threw exception on object creation; nested exception is java.lang.NullPointerException
        at org.springframework.context.annotation.CommonAnnotationBeanPostProcessor.postProcessPropertyValues(CommonAnnotationBeanPostProcessor.java:307)
        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1106)
        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:517)
        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
        at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
        at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
        at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
        at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
        at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:609)
        at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:918)
        at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:469)
        at org.springframework.context.support.ClassPathXmlApplicationContext.<init>(ClassPathXmlApplicationContext.java:139)
        at org.springframework.context.support.ClassPathXmlApplicationContext.<init>(ClassPathXmlApplicationContext.java:83)
        at com.sgbeuclid.ws.web.ServicingContext.getAppContext(ServicingContext.java:16)
        at com.sgbeuclid.ws.web.Euclid.<init>(Euclid.java:52)
        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) [rt.jar:1.6.0_33]
        at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39) [rt.jar:1.6.0_33]
        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27) [rt.jar:1.6.0_33]
        at java.lang.reflect.Constructor.newInstance(Constructor.java:513) [rt.jar:1.6.0_33]
        at java.lang.Class.newInstance0(Class.java:355) [rt.jar:1.6.0_33]
        at java.lang.Class.newInstance(Class.java:308) [rt.jar:1.6.0_33]
        at org.jboss.wsf.stack.cxf.configuration.NonSpringBusHolder.newInstance(NonSpringBusHolder.java:170)
        ... 10 more
    Caused by: org.springframework.beans.factory.BeanCreationException: 
    Error creating bean with name 'entrLoanRepository': FactoryBean threw exception on object creation; 
    nested exception is java.lang.NullPointerException
        at org.springframework.beans.factory.support.FactoryBeanRegistrySupport.doGetObjectFromFactoryBean(FactoryBeanRegistrySupport.java:149)
        at org.springframework.beans.factory.support.FactoryBeanRegistrySupport.getObjectFromFactoryBean(FactoryBeanRegistrySupport.java:102)
        at org.springframework.beans.factory.support.AbstractBeanFactory.getObjectForBeanInstance(AbstractBeanFactory.java:1442)
        at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:248)
        at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)
        at org.springframework.context.annotation.CommonAnnotationBeanPostProcessor.autowireResource(CommonAnnotationBeanPostProcessor.java:443)
        at org.springframework.context.annotation.CommonAnnotationBeanPostProcessor.getResource(CommonAnnotationBeanPostProcessor.java:417)
        at org.springframework.context.annotation.CommonAnnotationBeanPostProcessor$ResourceElement.getResourceToInject(CommonAnnotationBeanPostProcessor.java:559)
        at org.springframework.beans.factory.annotation.InjectionMetadata$InjectedElement.inject(InjectionMetadata.java:150)
        at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:87)
        at org.springframework.context.annotation.CommonAnnotationBeanPostProcessor.postProcessPropertyValues(CommonAnnotationBeanPostProcessor.java:304)
        ... 31 more
    Caused by: java.lang.NullPointerException
        at org.hibernate.engine.transaction.internal.jta.JtaStatusHelper.getStatus(JtaStatusHelper.java:73)
        at org.hibernate.engine.transaction.internal.jta.JtaStatusHelper.isActive(JtaStatusHelper.java:115)
        at org.hibernate.engine.transaction.internal.jta.CMTTransaction.join(CMTTransaction.java:149)
        at org.hibernate.ejb.AbstractEntityManagerImpl.joinTransaction(AbstractEntityManagerImpl.java:1220)
        at org.hibernate.ejb.AbstractEntityManagerImpl.postInit(AbstractEntityManagerImpl.java:178)
        at org.hibernate.ejb.EntityManagerImpl.<init>(EntityManagerImpl.java:89)
        at org.hibernate.ejb.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:179)
        at org.hibernate.ejb.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:174)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) [rt.jar:1.6.0_33]
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) [rt.jar:1.6.0_33]
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) [rt.jar:1.6.0_33]
        at java.lang.reflect.Method.invoke(Method.java:597) [rt.jar:1.6.0_33]
        at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:376)
        at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:517)
        at $Proxy37.createEntityManager(Unknown Source) at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:234)
        at $Proxy40.createNamedQuery(Unknown Source)    at org.springframework.data.jpa.repository.query.NamedQuery.<init>(NamedQuery.java:60)
        at org.springframework.data.jpa.repository.query.NamedQuery.lookupFrom(NamedQuery.java:111)
        at org.springframework.data.jpa.repository.query.JpaQueryLookupStrategy$DeclaredQueryLookupStrategy.resolveQuery(JpaQueryLookupStrategy.java:125)
        at org.springframework.data.jpa.repository.query.JpaQueryLookupStrategy$CreateIfNotFoundQueryLookupStrategy.resolveQuery(JpaQueryLookupStrategy.java:160)
        at org.springframework.data.jpa.repository.query.JpaQueryLookupStrategy$AbstractQueryLookupStrategy.resolveQuery(JpaQueryLookupStrategy.java:68)
        at org.springframework.data.repository.core.support.RepositoryFactorySupport$QueryExecutorMethodInterceptor.<init>(RepositoryFactorySupport.java:280)
        at org.springframework.data.repository.core.support.RepositoryFactorySupport.getRepository(RepositoryFactorySupport.java:148)
        at org.springframework.data.repository.core.support.RepositoryFactoryBeanSupport.getObject(RepositoryFactoryBeanSupport.java:125)
        at org.springframework.data.repository.core.support.RepositoryFactoryBeanSupport.getObject(RepositoryFactoryBeanSupport.java:41)
        at org.springframework.beans.factory.support.FactoryBeanRegistrySupport.doGetObjectFromFactoryBean(FactoryBeanRegistrySupport.java:142)
        ... 41 more

    15:52:35,611 ERROR [org.jboss.as.server] (DeploymentScanner-threads - 1) 
    JBAS015870: Deploy of deployment "euclid-ws.war" was rolled back with the following failure message: 
    {"JBAS014671: Failed services" => {"jboss.deployment.unit.\"euclid-ws.war\".
    INSTALL" => "org.jboss.msc.service.StartException in service jboss.deployment.unit.\"euclid-ws.war\".
    INSTALL: JBAS018733: Failed to process phase INSTALL of deployment \"euclid-ws.war\"
        Caused by: java.lang.RuntimeException: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'entrLoanServiceImpl': Injection of resource dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'entrLoanRepository': FactoryBean threw exception on object creation; nested exception is java.lang.NullPointerException
        Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'entrLoanServiceImpl': Injection of resource dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'entrLoanRepository': FactoryBean threw exception on object creation; nested exception is java.lang.NullPointerException
        Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'entrLoanRepository': FactoryBean threw exception on object creation; nested exception is java.lang.NullPointerException
        Caused by: java.lang.NullPointerException"}}
    15:52:35,688 INFO  [org.jboss.as.server.deployment] (MSC service thread 1-1) JBAS015877: Stopped deployment euclid-ws.war in 76ms 
```

基本上，当它试图实例化存储库时，它看起来好像正在获取一个空指针。

这是 web.xml。我应该使用 CXFServlet 吗？或者这看起来足够了吗？

```
 <web-app xmlns="http://java.sun.com/xml/ns/javaee"
          xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
          xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
          version="2.5"> 

        <context-param>
            <param-name>contextConfigLocation</param-name>
            <param-value>classpath*:META-INF/spring/applicationContext-ws.xml</param-value>
        </context-param>

        <listener>
            <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
        </listener>

        <!-- 
        commenting out the CXFServlet . It does not appear to be needed while deploying to jboss.
        <servlet>
            <servlet-name>CXFServlet</servlet-name>
            <servlet-class>org.apache.cxf.transport.servlet.CXFServlet</servlet-class>
            <load-on-startup>1</load-on-startup>
        </servlet>

        <servlet-mapping>
            <servlet-name>CXFServlet</servlet-name>
            <url-pattern>/*</url-pattern>
        </servlet-mapping>

        <session-config>
            <session-timeout>60</session-timeout>
        </session-config>
         -->

        <servlet>
            <servlet-name>euclid</servlet-name>
            <servlet-class>com.sgb.euclid.ws.web.Euclid</servlet-class>
            <load-on-startup>1</load-on-startup>
        </servlet>
        <servlet-mapping>
            <servlet-name>euclid</servlet-name>
            <url-pattern>/*</url-pattern>
        </servlet-mapping>

    </web-app> 
```

此外，可能不相关，但很高兴知道。在其中，我看到了一条警告消息：

```
JBAS016012: Deployment deployment "euclid-ws.war" contains CDI annotations but beans.xml was not found. 
```

尽管我没有尝试显式使用 CDI，但我是否应该在 WEB-INF 中有一个空的 beans.xml 文件？或者我可以在尝试使用 Spring Container 时安全地忽略警告吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T21:53:20.897

添加这个

```
<property name="hibernate.transaction.jta.platform" value="org.hibernate.service.jta.platform.internal.JBossAppServerJtaPlatform" /> 
```

到`persistence.xml`. 我怎么知道？[谷歌告诉我](https://www.google.com/search?q=JtaStatusHelper.java:73%20nullpointer&ie=utf-8&oe=utf-8)。

# java - struts2 - 具有单独动作类的多个提交按钮

> ID：13961350
> 
> 赞同：1
> 
> 时间：2012-12-19T21:17:40.243
> 
> 标签：java, javascript, struts2

我需要在一个表单中为不同的提交按钮调用不同的动作类，并在 struts2 中获取下拉列表的值。

学校学生页面的示例：

1.  提交按钮 1：显示学术页面
2.  提交按钮 2：显示运动页面
3.  提交按钮 3：显示库页面等。

我尝试如下，但它不起作用。

代码：

```
<s:submit value="academic" action="academic" />
<s:submit value="sports" action="sports" />
<s:submit value="library" action="library" />

Generated html code gets 
<input name="action:academic">
<input name="action:sports"> 
```

我正在使用`theme="simple"`表单标签。

我通过 URL 标签尝试了它，但调用的操作没有将下拉字段值填充为学生卷。

struts.xml：

`

```
<package name="default" extends="struts-default">
    <action name="academics" class="ViewAcademics" > 
        <result name="success">pages/ViewAcademics.jsp</result> 
    </action> 
    <action name="sports" class="ViewSports" > 
        <result name="success">pages/ViewSports.jsp</result> 
    </action> 
    <action name="library" class="ViewLibrary" > 
        <result name="success">pages/ViewLibrary.jsp</result> 
    </action>
</package> 
```

`

JSP 文件：

```
<s:form name="inquiryForm" method="post" theme="simple" > 
   Select roll no : 
   <s:select style="width: 200px;" 
      list="#{'1':'Student 01', '2':'Student 02', '3':'Student 03', '4':'Student 04'}"
      id="projectName" 
      name="studentRollNo" 
      readonly="false" 
      headerKey="-1" 
      headerValue="--- Select ---" 
   /> 
   <s:submit cssClass="page" action="academics" value="academics" /> 
   <s:submit cssClass="page" name="sports" value="sports" /> 
   <s:submit cssClass="page" name="library" value="library" /> 
</s:form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T10:53:35.247

`action`在提交声明中使用属性：

```
<s:submit cssClass="page" action="academics" value="academics" /> 
<s:submit cssClass="page" action="sports" value="sports" /> 
<s:submit cssClass="page" action="library" value="library" /> 
```

`studentRollNo`并且您的所有操作都应该具有getter/setter变量。

# math - 计算投影仪的位置

> ID：13961352
> 
> 赞同：0
> 
> 时间：2012-12-19T21:18:05.960
> 
> 标签：math, projection

我正在用投影仪在桌子上投影一个矩形，我想根据这个矩形的变形计算投影仪在空间中的绝对位置。我知道投影在桌子上的矩形所有角的绝对位置（3D）。

我不知道如何开始，并且在互联网上找不到很多有用的信息。有人可以提供一些提示吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T21:37:17.250

这取决于你知道什么。我会选择最简单的：

如果您知道原始矩形的位置，只需找到穿过匹配角的线的交点即可。

# xcode - NSImageView 双击动作

> ID：13961356
> 
> 赞同：12
> 
> 时间：2012-12-19T21:18:26.280
> 
> 标签：xcode, nsimageview

我的 Mac 应用程序中有一些 NSImageView，用户可以在其中拖放 .png 或 .pdf 等对象，以将它们存储到用户共享默认值中，效果很好。

我现在想为用户双击这些 NSImageView 设置一个动作，但这似乎有点困难（我对 NSTableView 没有任何问题，但是 NSImage 没有“setDoubleAction”，还有很多答案（这里或与谷歌）关于 NSImageView 的操作指向制作 NSButton 而不是 NSImageView，所以这无济于事）

这是我的 AppDelegate.h 的一部分：

```
@interface AppDelegate : NSObject <NSApplicationDelegate>{

    (...)

    @property (assign) IBOutlet NSImageView *iconeStatus;

    (...)

@end 
```

这是我的 AppDelegate.m 的一部分：

```
#import "AppDelegate.h"

@implementation AppDelegate

(...)

@synthesize iconeStatus = _iconeStatus;

(...)

- (void)awakeFromNib {

    (...)

[_iconeStatus setTarget:self];
[_iconeStatus setAction:@selector(doubleClick:)];

    (...)

}

(...)

- (void)doubleClick:(id)object {
        //make sound if that works ...
        [[NSSound soundNamed:@"Basso"] play];

} 
```

但这不起作用。

谁能告诉我最简单的方法是什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-07-15T14:18:13.620

您需要继承 NSImageView 并将以下方法添加到子类的实现中：

```
- (void)mouseDown:(NSEvent *)theEvent
{
    NSInteger clickCount = [theEvent clickCount];

    if (clickCount > 1) {
        // User at least double clicked in image view
    }
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2018-05-01T19:29:20.313

Swift 4 的代码。NSImageView 再次被子类化，并且 mouseDown 函数被覆盖。

```
class MyImageView: NSImageView {

    override func mouseDown(with event: NSEvent) {
        let clickCount: Int = event.clickCount

        if clickCount > 1 {
            // User at least double clicked in image view
        }
    }

} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-06-21T16:17:38.557

另一种解决方案使用`extension`：

```
extension NSImageView {
    override open func mouseDown(with event: NSEvent) {
        // your code here
    }
} 
```

虽然这会将该功能添加到每个 NSImageView，但也许这不是您想要的。

# spring - 使用 Hibernate 使用 JSTL 以给定格式显示 Oracle 日期

> ID：13961357
> 
> 赞同：1
> 
> 时间：2012-12-19T21:18:34.897
> 
> 标签：spring, hibernate, jsp, datetime, oracle10g

我在 Oracle(10g) 数据库的表中有一个日期字段，该字段在`TemporalType.TIMESTAMP`Hibernate 中映射，例如，

```
@Column(name = "DISCOUNT_START_DATE")
@Temporal(TemporalType.TIMESTAMP)
private Date discountStartDate;

//Setter and getter. 
```

它获取日期并显示如下（已插入数据库），

```
2012-08-29 01:53:10.0
2012-08-20 02:32:22.0
2012-08-01 14:00:21.0
2012-08-20 13:58:01.0
2012-08-30 04:14:13.0
2012-09-10 16:13:45.0 
```

当我尝试使用 JSTL 显示它们时，

```
<fmt:formatDate pattern="dd-MMM-yyyy hh:mm:ss" value="${row.discountStartDate}"/> 
```

它抛出一个异常，

> javax.el.E​​LException：无法将 java.lang.String 类型的 2012-08-29 01:53:10.0 转换为 java.util.Date 类

我试图改变`TemporalType.TIMESTAMP`但`TemporalType.DATE`没有工作。

早些时候，它使用 XML 映射文件 (xxx.hbm.xml) 之类的。

```
<property name="discountStartDate" type="date">
  <column length="7" name="DISCOUNT_START_DATE"/>
</property> 
```

但是有了注释，它失败了。如何应用这种格式`dd-MMM-yyyy hh:mm:ss`来使用 JSTL 在 JSP 中显示这些日期？

* * *

**编辑：**

下面是与Oracle中`Discount`的表映射的实体类（和方法已省略）。`DSCOUNT``equals()``toString()`

```
@Entity
@Table(name = "DISCOUNT", catalog = "", schema = "WAGAFASHIONDB")
public class Discount  implements java.io.Serializable
{
    private static final long serialVersionUID = 1L;
    @Id
    @Basic(optional = false)
    @Column(name = "DISCOUNT_ID", nullable = false, precision = 35, scale = 0)
    @SequenceGenerator(name = "discountIdSequence", sequenceName = "DISCOUNT_SEQ", allocationSize=1, initialValue=1)
    @GeneratedValue(strategy = GenerationType.SEQUENCE, generator = "discountIdSequence")
    private Long discountId;

    @Column(name = "DISCOUNT_CODE", length = 100)
    private String discountCode;

    @Column(name = "DISCOUNT_PER", precision = 35, scale = 2)
    private double discountPer;

    @Column(name = "DISCOUNT_START_DATE")
    @Temporal(TemporalType.TIMESTAMP)
    private Date discountStartDate;

    @Column(name = "DISCOUNT_END_DATE")
    @Temporal(TemporalType.TIMESTAMP)
    private Date discountEndDate;

    @OneToMany(mappedBy = "discountId", fetch = FetchType.LAZY)
    private Set<OrderTable> orderTableSet;

    public Discount() {
    }

    public Discount(Long discountId) {
        this.discountId = discountId;
    }

    public Long getDiscountId() {
        return discountId;
    }

    public void setDiscountId(Long discountId) {
        this.discountId = discountId;
    }

    public String getDiscountCode() {
        return discountCode;
    }

    public void setDiscountCode(String discountCode) {
        this.discountCode = discountCode;
    }

    public double getDiscountPer() {
        return discountPer;
    }

    public void setDiscountPer(double discountPer) {
        this.discountPer = discountPer;
    }

    public Date getDiscountStartDate() {
        return discountStartDate;
    }

    public void setDiscountStartDate(Date discountStartDate) {
        this.discountStartDate = discountStartDate;
    }

    public Date getDiscountEndDate() {
        return discountEndDate;
    }

    public void setDiscountEndDate(Date discountEndDate) {
        this.discountEndDate = discountEndDate;
    }

    public Set<OrderTable> getOrderTableSet() {
        return orderTableSet;
    }

    public void setOrderTableSet(Set<OrderTable> orderTableSet) {
        this.orderTableSet = orderTableSet;
    }
} 
```

在 JSP 中，使用以下循环来显示数据（降低代码复杂度）。

```
<c:forEach var="row" items="${list}" varStatus="loop">
    <fmt:formatDate pattern="dd-MMM-yyyy hh:mm:ss" value="${row.discountStartDate}"/>
</c:forEach> 
```

而在 Spring DAO 中，通过前面的循环迭代的列表被简单地检索如下。

```
@SuppressWarnings("unchecked")
public List<Discount>getList(int currentPage, int rowsPerPage)
{
    List<Discount> list = sessionFactory.getCurrentSession()
                          .createQuery("from Discount order by discountId desc")
                          .setFirstResult(currentPage)
                          .setMaxResults(rowsPerPage).list();

    for(Discount d:list)
    {
       System.out.println(d.getDiscountStartDate()+" : "+d.getDiscountEndDate());
    }
    return list;
} 
```

前面的循环只是为了演示。它显示表中的日期，如下所示。

```
2012-08-29 01:53:10.0 : 2012-08-31 01:53:16.0
2012-08-20 02:32:22.0 : 2012-08-24 02:34:36.0
2012-08-01 14:00:21.0 : 2012-08-31 14:01:30.0
2012-08-20 13:58:01.0 : 2012-08-21 13:58:20.0
2012-08-30 04:14:13.0 : 2012-11-23 16:21:57.0
2012-09-10 16:13:45.0 : 2012-10-26 16:13:39.0
2012-08-22 16:06:23.0 : 2012-08-15 16:06:17.0
2012-08-22 10:35:04.0 : 2012-08-17 10:34:56.0
2012-08-17 10:35:29.0 : 2012-08-10 10:35:35.0
2012-10-08 10:35:56.0 : 2013-03-08 10:35:49.0 
```

# objective-c - Conditional breakpoint using strcmp() in GDB on Mac OS X conflicts with Objective-C runtime

> ID：13961368
> 
> 赞同：7
> 
> 时间：2012-12-19T21:19:26.270
> 
> 标签：objective-c, c, macos, gdb

I'm trying to debug a program that I do not have the source for on Mac OS X. I would like to know what arguments it is calling [`gettattrlist()`](https://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man2/getattrlist.2.html) with, and inspect the return value, for two different volumes (in order to compare and see why it will let you use one volume and not the other).

I first tried `dtruss`; but that's useless for `getattrlist()`; it shows only the pointers that are being passed into `getattrlist()` (and doesn't even know how many arguments `getattrlist()` takes).

```
 635/0x1dc5:  getattrlist("/Volumes/MyVolume\0", 0x113FA6380, 0x113FA5FD0)                 = 0 0
  635/0x1dc5:  getattrlist("/Volumes/MyVolume\0", 0x113FA4F00, 0x113FA4B30)                 = 0 0
  635/0x1dc5:  getattrlist("/Volumes/MyVolume\0", 0x113FA5870, 0x113FA54C0)                 = 0 0
  635/0x19c6:  getattrlist("/Volumes/MyVolume\0", 0x7FFF5FBF9140, 0x7FFF5FBF8D70)           = 0 0
  635/0x19c6:  getattrlist("/Volumes/MyVolume\0", 0x7FFF5FBFA8A0, 0x7FFF5FBFA4F0)           = 0 0 
```

So I tried GDB. I can set an unconditional breakpoint on `getattrlist()`, and take a look at its first argument, but it's called way too often for that to be useful.

```
(gdb) break getattrlist
Breakpoint 1 at 0x7fff8e90b6ac
(gdb) cont
Continuing.

Breakpoint 1, 0x00007fff8e90b6ac in getattrlist ()
(gdb) p (char *)$rdi
$1 = 0x7fff5fbfd67e "/some/random/path" 
```

So, I probably need a conditional breakpoint, that will break only when the first argument matches the path I'm interested in. That shouldn't be too hard, right?

```
(gdb) delete
Delete all breakpoints? (y or n) y
(gdb) break getattrlist if ((int)strcmp((char *)$rdi, "/Volumes/My Volume")) == 0
Breakpoint 2 at 0x7fff8e90b6ac
(gdb) cont
Continuing.
Canceling call as the malloc lock is held so it isn't safe to call the runtime.
Issue the command:
    set objc-non-blocking-mode off 
to override this check if you are sure your call doesn't use the malloc libraries or the ObjC runtime.
Error in testing breakpoint condition:
Canceling call as the malloc lock is held so it isn't safe to call the runtime.
Issue the command:
    set objc-non-blocking-mode off 
to override this check if you are sure your call doesn't use the malloc libraries or the ObjC runtime.

Breakpoint 2, 0x00007fff8e90b6ac in getattrlist ()
(gdb) p (char *)$rdi
 $12 = 0x7fff5fbfd67e "/some/other/random/path" 
```

What's this? GDB has ignored my condition because it suspects that it might call `malloc()` or the ObjC runtime? OK, well, `strcmp()` shouldn't call `malloc()`; it should just compare the strings byte by byte until it gets to a null character. So lets set that option the message recommends to override the check:

```
(gdb) set objc-non-blocking-mode off
(gdb) cont
Continuing.
Segmentation fault: 11 
```

No dice. GDB and the application both die.

Any suggestions on how to set a conditional watchpoint on a string from GDB without running into this issue? Or other ways of capturing the arguments and return values (which are stored via an output argument) of `getattrlist()`, that works better than `dtruss()`?

### Edit

Tried matt's solution, but no luck:

```
(gdb) set $vol = (char *) malloc((int)strlen("/Volumes/My Volume") + 1)
(gdb) call (int)strcpy($vol, "/Volumes/My Volume")
$1 = 236411760
(gdb) break getattrlist if ((int)strcmp((char *)$rdi, $vol)) == 0
Breakpoint 1 at 0x7fff8e90b6ac
(gdb) cont
Continuing.
Unsafe to run code: malloc zone lock is held for some zone..
Error in testing breakpoint condition:
Canceling call as the malloc lock is held so it isn't safe to call the runtime.
Issue the command:
    set objc-non-blocking-mode off 
to override this check if you are sure your call doesn't use the malloc libraries or the ObjC runtime.

Breakpoint 1, 0x00007fff8e90b6ac in getattrlist ()
(gdb) p (char *)$rdi
$4 = 0x11a715838 "/some/other/random/path" 
```

I decided to try `memcmp()` instead of `strcmp()`; no luck there either:

```
(gdb) break getattrlist if ((int)memcmp((char *)$rdi, $vol, 18)) == 0
Breakpoint 1 at 0x7fff8e90b6ac
(gdb) cont
Continuing.
Unsafe to run code: malloc zone lock is held for some zone..
Error in testing breakpoint condition:
Canceling call as the malloc lock is held so it isn't safe to call the runtime.
Issue the command:
    set objc-non-blocking-mode off 
to override this check if you are sure your call doesn't use the malloc libraries or the ObjC runtime.

Breakpoint 1, 0x00007fff8e90b6ac in getattrlist ()
(gdb) 
```

At this point, I figured "OK, now there really shouldn't be anything using `malloc()`", so I decided to try `set objc-non-blocking-mode off` again. Still no luck:

```
(gdb) set objc-non-blocking-mode off
(gdb) cont
Continuing.
Reading symbols for shared libraries ... done
Reading symbols for shared libraries . done
Reading symbols for shared libraries ....... done
[Switching to process 5456 thread 0x2971b]
[Switching to process 5456 thread 0x29e2f]
warning: Unable to restore previously selected frame.

Program received signal EXC_BAD_ACCESS, Could not access memory.
Reason: KERN_INVALID_ADDRESS at address: 0x0000000000000000
[Switching to process 5456 thread 0x29e2f]
0x0000000000000000 in ?? ()
Error in testing breakpoint condition:
The program being debugged was signaled while in a function called from GDB.
GDB remains in the frame where the signal was received.
To change this behavior use "set unwindonsignal on"
Evaluation of the expression containing the function (memcmp) will be abandoned.

Breakpoint 1, 0x0000000000000000 in ?? ()
Error in testing breakpoint condition:
The program being debugged was signaled while in a function called from GDB.
GDB remains in the frame where the signal was received.
To change this behavior use "set unwindonsignal on"
Evaluation of the expression containing the function (memcmp) will be abandoned.

Breakpoint 1, 0x0000000000000000 in ?? () 
```

Hmm. What state am I in?

```
(gdb) bt
#0  0x0000000000000000 in ?? ()
#1  0x000000011e6ec070 in ?? () 
```

Ick. That doesn't look good. What if I continue here?

```
(gdb) cont
Continuing.
[Switching to process 5456 thread 0x2971b]
(gdb) bt
#0  0x00007fff8e90b6ac in getattrlist ()
#1  0x00007fff897c9c4b in GetPathVolFSAttributes ()
#2  0x00007fff897c9459 in PathGetObjectInfo ()
#3  0x00007fff897c9279 in FSPathMakeRefInternal ()
#4  0x00007fff8767b3ee in FSNodePrepareFSRef ()
... snip ...
(gdb) p (char *)$rdi
$2 = 0x10db1c2b0 "/System/Library/CoreServices/CoreTypes.bundle" 
```

Nope. Still not actually breaking on the correct call to `getattrlist()`; and everything has died in the meantime due to the null pointer dereference.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T18:00:19.830

I believe that something like the following should work.

```
(gdb) start
...
(gdb) set $x = malloc(strlen("foobar") + 1)
(gdb) call strcpy($x, "foobar")
(gdb) break a_leg if strcmp(foo, $x) == 0 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-03T13:16:29.227

In recent versions of GDB:

```
(gdb) start
(gdb) break a_leg if $_streq(foo, "foobar") 
```

I'm not sure in what version this was introduced, but it's at least present in 7.7.1.

# jquery - 如何从外部页面链接到 jquery 移动子页面？

> ID：13961372
> 
> 赞同：5
> 
> 时间：2012-12-19T21:19:30.840
> 
> 标签：jquery, jquery-mobile

我有一个基本的 jQuery Mobile 页面，如下所示：

```
<div data-role="page" id="home">

</div>
<div data-role="page" id="products">

</div> 
```

除非我想从外部链接链接到产品页面，否则一切都按预期工作。我试过了：mysite.com/mobile/default.aspx#products 但只显示主页。有没有办法让外部链接显示产品页面？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T21:27:46.633

简短的回答是您不能直接链接到*多页文档*中的特定页面。

不幸的是，jQuery Mobile 的工作方式是，当您链接到具有多个“页面”的页面时，默认情况下它只会加载第一*页*，要加载整个外部多页文档，您需要加载没有 ajax 的页面（例如添加`rel="external"`，或者如果你想用 ajax 加载页面，你可以使用[subpages 插件](https://github.com/ToddThomson/jQuery-Mobile-Subpage-Widget)。

就链接而言，您应该分开您的*页面*，或者通过 ajax 预加载外部多页文档（使用我上面链接到的插件，或者如果您愿意，可以手动），然后作为内部页面链接到它。

从[文档](http://jquerymobile.com/demos/1.2.0/docs/pages/page-links.html)

> 请务必注意，如果您从通过 Ajax 加载的移动页面链接到包含多个内部页面的页面，则需要在链接中添加 rel="external" 或 data-ajax="false"。这告诉框架重新加载整个页面以清除 URL 中的 Ajax 哈希。这一点很关键，因为 Ajax 页面使用哈希 (#) 来跟踪 Ajax 历史，而多个内部页面使用哈希来指示内部页面，因此这两种模式之间的哈希会发生冲突。
> 
> 例如，指向包含多个内部页面的页面的链接如下所示：

```
<a href="multipage.html" rel="external">Multi-page link</a> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-18T19:58:17.693

为每个“页面”添加一个与您提供的 id 名称相同的 data-url 属性：

```
<div data-role  = 'page'                         
     id         = 'page_baseball_hats'  
     data-url   = 'page_baseball_hats'    
  > 
```

那么您应该能够使用 jqm 已经生成的 url 哈希系统从站点*外部*直接链接到“子页面”，例如：www.myjqmsite.com/#page_baseball_hats

第二段介绍了这个想法：http: [//jquerymobile.com/demos/1.0a3/docs/pages/docs-navmodel.html](http://jquerymobile.com/demos/1.0a3/docs/pages/docs-navmodel.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-11T05:07:38.860

这是一种开箱即用的方式。但效果很好。

```
 $(document).on('pagebeforeshow', '#mainPage', function (e) {  
      if(window.location.hash) {
          $('#YOUR BTN ID LINKED TO DESIRED SUBPAGE').click();
      } 
  }); 
```

这表示“如果您的 url 有一个哈希 (index.html#subPage)，并且如果您有一个超链接按钮到该页面的 id (将该 id 设置为 $click), (您可能在导航栏中有这个按钮例如，您的页脚）在显示主页面之前转到该子页面“

将#mainPage 更改为多页网址中的第一页ID。

将 #subPage 更改为您的多页 url 中的子页面 ID。

当然，这仅在您只有一个子页面时才有效。

如果您有多个子页面，请使用此

```
 $(document).on('pagebeforeshow', '#mainPage', function (e) {  
      var hash = location.hash.replace("#","");
      if(window.location.hash) {
          if(hash === 'subPage'){ 
              $('#YOUR BTN ID LINKED TO DESIRED SUBPAGE').click(); 
          }
      }
  }); 
```

# php - 如何查找 LDAP 的 account_suffix

> ID：13961374
> 
> 赞同：2
> 
> 时间：2012-12-19T21:19:40.303
> 
> 标签：php, active-directory, ldap, symfony-1.4

我正在尝试设置 bhLDAPAuthPlugin 以通过 Active Directory 进行身份验证。我在配置身份验证设置时遇到问题。

在 adLDAP.php 文件中，这里是默认设置：

```
class adLDAP {
    // BEFORE YOU ASK A QUESTION, PLEASE READ THE DOCUMENTATION AND THE FAQ
    // http://adldap.sourceforge.net/documentation.php
    // http://adldap.sourceforge.net/faq.php

    // You can set your default variables here, or when you invoke the class
    var $_account_suffix="@mydomain.local";
    var $_base_dn = "DC=mydomain,DC=local"; 

    // An array of domain controllers. Specify multiple controllers if you 
    // would like the class to balance the LDAP queries amongst multiple servers
    var $_domain_controllers = array ("dc01.mydomain.local");

    // optional account with higher privileges for searching
    // not really that optional because you can't query much as a user
    var $_ad_username=NULL;
    var $_ad_password=NULL;

    // AD does not return the primary group. http://support.microsoft.com/?kbid=321360
    // This tweak will resolve the real primary group, but may be resource intensive. 
    // Setting to false will fudge "Domain Users" and is much faster. Keep in mind though that if
    // someone's primary group is NOT domain users, this is obviously going to bollocks the results
    var $_real_primarygroup=true;

    // Use SSL, your server needs to be setup, please see - http://adldap.sourceforge.net/ldap_ssl.php
    var $_use_ssl=false;

    // When querying group memberships, do it recursively
    // eg. User Fred is a member of Group A, which is a member of Group B, which is a member of Group C
    // user_ingroup("Fred","C") will returns true with this option turned on, false if turned off
    var $_recursive_groups=false;

    // You should not need to edit anything below this line
    //****************************************************************************************** 
```

这个问题可能看起来很抽象，但是我如何确定这个信息呢？

在插件的文档中，它说 account_suffix 应该是我要连接的域，但我发现其他文档列出了特定参数，例如组织，例如：

```
account_suffix = "ou=People, o=domain.edu"; 
```

我如何找到要使用的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T20:48:53.170

如果您有权访问 Active Directory 并有权运行 Active Directory 用户和计算机，则可以相当容易地解决这个问题。

首先，出于向后兼容性的原因，AD 使用“域”对象，即 LDAP 中的 dc=。所以后缀很可能是 dc=domain,dc=com 或类似的形式。

您的 AD 管理员可能已选择将用户留在默认的 Users 容器中，该容器实际上是 cn=Users 而不是 ou=Users，如您所料。

或者他们为用户存储制作了一系列OU。完全取决于他们。

在 ADUC 中，您可以看到最顶部的域名作为最根节点的布局。那将是 domain.com 或类似的，这意味着 dc=domain, dc=com 在一端。

然后环顾四周，查看用户的存储位置（或者至少是您希望使用此服务的用户），然后为每个 OU 添加一个 ou=whatever 到 dc=domain,dc=com。

# php - MySQL 但事先不知道列名

> ID：13961381
> 
> 赞同：6
> 
> 时间：2012-12-19T21:20:12.270
> 
> 标签：php, mysql

我正在构建一个 PHP/MySQL 应用程序，我允许用户创建他们自己的自定义（尽可能多）配置文件数据（即他们可以使用其他文本框将任意数量的信息添加到他们的配置文件中，但是有一个“核心”一组用户配置文件字段）

例如，他们可以在表单上创建一个新文本框并将其称为“我的宠物”和/或“我最喜欢的颜色”。我们需要将这些数据存储在数据库中，并且显然不能为他们的每个选择创建列，因为我们事先不知道他们的附加信息是什么。

我们认为我们可以存储他们提供的所有“附加信息”的一种方法是将他们的附加信息存储为 JSON 并将其存储在 MySQL 文本字段中（我喜欢 MySQL :)）

我见过 Wordpress 表单构建器插件，您可以在其中创建自己的字段，因此我认为它们必须以某种方式将数据存储在 MySQL 中，因为 NoSQL 解决方案超出了这些插件的范围。

我很想坚持使用 MySQL，但是你们认为像 MongoDB/Redis 这样的 NoSQL 解决方案会是一个更好的解决方案吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T21:25:23.040

解决此问题的一种方法是使用使用 EAV 范例或实体-属性-值的单个表。请参阅[维基百科文章](http://en.wikipedia.org/wiki/Entity%E2%80%93attribute%E2%80%93value_model)。在大多数方面，这比让用户选择数据库模式要整洁得多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T21:24:49.627

您可以创建一个键值对表，其中将存储任何不在核心中的内容。该表看起来像：user_id、name_of_user_specified_field、user_specified_value；

任何开始大量显示的 name_of_user_specified_field 都可以添加到核心表中。这称为实体-属性-值。请注意，有些人认为这是一种反模式。

如果您这样做，请添加控件以限制用户可以创建的新条目的数量，否则您可能会发现有人用大量字段填充您的数据库:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T21:25:28.080

MySQL 可以很好地处理这个问题。如果额外的数据总是要一起被提取出来（即你永远不需要只得到 pet 字段而没有任何其他额外的字段），那么你可以将它序列化存储在 users 表的列中。但是，如果您需要更多关系模型，则可以将额外数据存储在由用户 ID 链接的单独表中。附加表将有一个用于用户 ID 的列、附加字段名称附加字段值以及您可能想要的任何其他内容。然后，您只需在获取配置文件时运行`JOIN`查询即可获取所有额外字段。

# php - Iframe not stored in mysql correctly from ckeditor

> ID：13961382
> 
> 赞同：1
> 
> 时间：2012-12-19T21:20:14.003
> 
> 标签：php, mysql, iframe, ckeditor, htmlspecialchars

I am using ckeditor to post formated text into the mysql database. When I post it converts the iframe into encoded html as if using `htmlspacialchars` but leaves the rest of the html code ok.

what I get:

```
<p>&lt;iframe frameborder=&quot;0&quot; scrolling=&quot;no&quot; src=&quot;http://php.net/manual/en/function.mysql-real-escape-string.php&quot;&gt;&lt;/iframe&gt;</p>

<p>&nbsp;</p>

<ul>
 <li>hi lol</li>
 <li>wow</li>
 <li>yaya</li>
</ul> 
```

vs what I want:

```
<p><iframe frameborder="0" scrolling="no" src="http://php.net/manual/en/function.mysql-real-escape-string.php"></iframe></p>

<p>&nbsp;</p>

<ul>
 <li>hi lol</li>
 <li>wow</li>
 <li>yaya</li>
</ul> 
```

This causes it to appear as html code rather than rendering the iframe on the page.

I know it is not the mysql that has the problem because when I store it directly through the phpmyadmin it lets it show fine on the page, rendering the iframe.

Also it happend the same thing in tinymce so it may be a server permission thing, I don't know.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T21:25:03.667

The editor is protecting against [Cross Site Scripting](https://www.owasp.org/index.php/Cross-site_Scripting_%28XSS%29) attacks. A little searching turned up the correct way to [add an iframe with ckeditor](http://docs.cksource.com/CKEditor_3.x/Users_Guide/Rich_Text/IFrame).

# jquery - requestNextPage() 不是 Backbone.Paginate 中的函数

> ID：13961384
> 
> 赞同：0
> 
> 时间：2012-12-19T21:20:16.543
> 
> 标签：jquery, jquery-ui, backbone.js, backbone.js-collections, backbone.paginator

我正在编写一个需要分页的骨干集合。所以这是我的代码

```
define([
  'underscore',
  'backbone',
  'models/object',
  'backbone_paginate'

], function(_, Backbone, Object){
   "use strict";
  var myCollection= Backbone.Paginator.clientPager.extend({

    model: Object,

      paginator_core: {
          // the type of the request (GET by default)
          type: 'GET',

          // the type of reply (jsonp by default)
          dataType: 'json',

          // the URL (or base URL) for the service
          url: location.protocol + '//' + location.host+'/address'
      },

      paginator_ui: {
          // the lowest page index your API allows to be accessed
          firstPage: 1,

          // which page should the paginator start from
          // (also, the actual page the paginator is on)
          currentPage: 1,

          // how many items per page should be shown
          perPage: 3,

          // a default number of total pages to query in case the API or
          // service you are using does not support providing the total
          // number of pages for us.
          // 10 as a default in case your service doesn't return the total
          totalPages: 10,

          pagesInRange: 3
      },

      server_api: {
           '$top': function() {
               return this.totalPages * this.perPage; },

          },

       parse:function(dat){
      return dat.items;
    }

     });
  return new myCollection();
}); 
```

我的观点是这样的：

```
define([
  'jquery',
  'underscore',
  'backbone',
   'collections/addressLists',
     'models/object',
     'views/shared_object_item',

], function($, _, Backbone, AddressLists,Address,Shared_object_item){
  "use strict";

  var AppView = Backbone.View.extend({
    events: {

    },

    initialize: function() {

      _.bindAll(this,'render','updateData','showMoreData','showAllData');              this.collection=AddressLists;
     this.collection.bind('reset',this.render);
       this.collection.fetch();

    },

     el:$('div')[0],
     render: function() {

       var that=this;
      $('.innerContainer').bind('scroll',function(){
         if($(this)[0].scrollHeight-$(this).scrollTop()==$(this).outerHeight()){
           that.showMoreData();
          }
      });
        this.updateData();
       },

    updateData:function(){
      var that=this,collection;
      $('.innerItem').empty();

      _.each(this.collection.models,function(model){
         $('.innerItem').append(new Shared_object_item({parent:that,collection:that.collection,model:model}).render().el);
      });

    },
      showMoreData:function(){

this.collection.requestNextPage();

      },
   });
  return AppView;
}); 
```

现在在我看来，我正在调用：fetch();

在获取成功后，我试图调用 this.collection.requestNextPage();

它在 fetch() 之前工作正常，但是一旦它到达 requestNextPage 函数（位于 showMoreData() 函数中），它就会抛出一个错误，指出 requestNextPage() 不是一个函数。

我不知道我在哪里出错了..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T01:46:30.290

从[Backbone.Paginator 文档](https://github.com/addyosmani/backbone.paginator) `requestNextPage(options)`是一种方便的方法`Paginator.requestPager`，但您正在扩展`Paginator.clientPager`. 看起来你需要使用`nextPage()`.

# php - 在 Html 表中显示 Php 数组结果

> ID：13961388
> 
> 赞同：4
> 
> 时间：2012-12-19T21:20:37.903
> 
> 标签：php

我试图将 php 中的数组显示到 HTML 表中，但出现了问题。我在堆栈溢出中找到了几个示例，但它们不适用于我的情况。

**控制器：**

```
<?php include('inc/db_connect.php');?>

<?php
try
{
  $sql = "SELECT id GroupName, VideoTITLE, ByArtist FROM videoclip";
  $result = $pdo->query($sql);
}
catch(PDOException $e)
{
  $error = 'unable to fetch data: '.$e->getMessage();
  include'error.html.php';
  exit();
}
$URLS = array();
while ($row = $result->fetch())
{
  $URLS[] = array('id' => $row['id'], 'GroupName' => $row['GroupName'], 'VideoTITLE' => $row['VideoTITLE'], 'ByArtist'=> $row['ByArtist'] );
} 
```

**html:**

```
<div id="table_admin" class="span7">
        <h3>Videoclip List</h3>

        <table class="table table-striped table-condensed">

                <thead>
                <tr>
                <th>Song name</th>
                <th>Group name </th>
                <th>Artist </th>
                </tr>
                </thead>
            <?php foreach ($URLS as $URL){
                echo'<tbody>';
                echo'<tr>'; 
                echo'<td>'. $row['VideoTITLE']."</td>";
                echo'<td>'. $row['GroupName'].'</td>';
                echo'<td>'. $row['ByArtist'].'</td>';
                echo'<tr>';
                echo'</tbody>';
              }
            ?>

        </table>

    </div> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-19T21:22:34.057

你很接近：

```
</thead>
<tbody>
<?php 
    foreach ($URLS as $URL){
        echo'<tr>'; 
        echo'<td>'. $URL['VideoTITLE']."</td>";
        echo'<td>'. $URL['GroupName'].'</td>';
        echo'<td>'. $URL['ByArtist'].'</td>';
        echo'<tr>';
    }
?>
</tbody> 
```

由于您正在获取`$URLS`数组的值并调用每个值，因此`$URL`您需要`$URL`为每一行的值引用。不是`$row`您最初用于从数据库结果中填充数组的变量。

仅供参考，您可能需要研究[`htmlentities()`](http://us3.php.net/manual/en/function.htmlentities.php)以逃避您的数据以帮助防止 XSS 攻击。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T21:28:17.040

假设您的 fetchRow 数据很好，我在您的 html 中只看到一个主要错误：在您的 foreach 循环中将 $row 更改为 $URL。此外，您可以将 PHP 与 HTML 混合使用以使其更漂亮：

```
<?php foreach ($URLS as $URL) { ?>
    <tr>
        <td><?php echo $URL['VideoTITLE']; ?></td>
        <td><?php echo $URL['GroupName']; ?></td>
        <td><?php echo $URL['ByArtist']; ?></td>
    <tr>
<?php } ?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T21:27:27.473

是的，正如约翰所说，你有 $URLs 作为 $URL，但是你指的是一个数组，在每个中调用 $row。

另一件事是您可能希望将 tbody 标签放在 for each 循环之外

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-04-19T14:01:37.093

从数据库中获取结果后，请关注

```
<?php
  echo '<table>';
  echo '<thead>';
  echo '<tr>';
  echo '<th>Song name</th>';
  echo '<th>Group name </th>';
  echo '<th>Artist </th>';
  echo '</tr>';
  echo '</thead>'
  echo '<tbody>'; 
  foreach($URLS as $URL) {
    echo'<tr>'; 
    echo'<td>'. $URL['VideoTITLE']."</td>";
    echo'<td>'. $URL['GroupName'].'</td>';
    echo'<td>'. $URL['ByArtist'].'</td>';
    echo'<tr>';  
  }
  echo '</tbody>'; 
  echo '</table>'; 
?> 
```

我希望这对你有帮助

# ruby-on-rails - Rails 在使用 capistrano 部署后给我一个 file.js is not precompiled 错误

> ID：13961390
> 
> 赞同：0
> 
> 时间：2012-12-19T21:20:44.393
> 
> 标签：ruby-on-rails, ruby, capistrano

我在 erb 中直接使用简单的包含：

```
<%= javascript_include_tag "file.js" %> 
```

我只是将我的一个文档中的代码放入脚本标签中，然后将其移出该文件并将其放置在 app/assets/javascripts/file.js 中。我必须在某处列出这个文件吗？我不希望它包含在每个页面上，只是某些页面。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T21:27:54.610

在`config/environments/production.rb`：

```
config.assets.precompile += %w( file.js ) 
```

或者

```
config.assets.compile = true 
```

还要确保你的 capistrano 食谱中有这个”

```
load 'deploy/assets' 
```

# c++ - 发送 MAPI 消息时遇到问题

> ID：13961391
> 
> 赞同：1
> 
> 时间：2012-12-19T21:21:05.280
> 
> 标签：c++, send, mapi

我正在尝试使用扩展 MAPI 发送消息，但不断收到 E_ACCESSDENIED 错误。我正在使用调用 cpp dll 的 C# 类。我可以检查邮件和删除邮件，但不能发送。下面是我用来创建消息的 C#：

```
using (MAPIMessage message = new MAPIMessage())
{
   if (message.Create(this))
   {
      message.SetSender(send.SenderName, send.SenderAddress);
      message.SetSubject(send.Subject);
      message.SetBody(send.Message);
      message.AddRecipient(send.RecipientAddress);
      //  High: Add attachments

      #if DEBUG
      ConfirmMessageCreation(send, message);
      #endif

      Logger.Log("Message created...\nSending message...", Verbose.LogEverything);
      result = message.Send();
   }

       else
          Logger.Log("There was a problem creating the email.", Verbose.LogImportant);
} 
```

发送消息的实际 cpp 如下：

```
BOOL MessageSend(CMAPIMessage* pMessage)
{
    return pMessage->Send();
} 
```

...

```
BOOL CMAPIMessage::Send()
{
    HRESULT result = Message()->SubmitMessage(0);

    if(Message() && result==S_OK) 
    {
        Close();
        return TRUE;
    }
    return FALSE;
} 
```

即使我已正确登录并且可以检查或删除消息，但在调用 Send() 时仍会收到 E_ACCESSDENIED 错误。对此问题的任何见解将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T15:15:45.453

需要删除发件人相关属性。

# ui-automation - UIA：从控件类型名称（字符串）中获取 ControlType

> ID：13961400
> 
> 赞同：2
> 
> 时间：2012-12-19T21:21:53.720
> 
> 标签：ui-automation, microsoft-ui-automation, uia

使用 Microsoft UI 自动化。我有一个代表 UIA 控件类型的字符串，例如“Window”或“Button”。我想得到一个适合这个字符串的 ControlType 对象。怎么做？是否存在一些代表所有 UIA 控件类型的枚举？我发现只有 ControlType 有 ControlType.LookupById(int) 方法。但是我必须知道ID和名称之间的对应关系。当然，我可以使用所有可能的 UIA 控件类型创建自己的开关，甚至可以使用反射来获取 ControlType 工厂的所有成员。但我肯定应该是更简单的方法..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T11:27:24.323

我发现这样的方式，使用 PresentationCore.dll，对我来说很奇怪，这样的枚举在标准 UIA DLL 中不存在。另外请注意，ControlType 类中有一个错误，我猜是由于它的私有**静态**构造函数。如果您第一次调用 ControlType.LookupById(enumId)，它将返回 null，但在第二次将可以。解决方案很简单——在使用前调用 ToString ，它会初始化静态构造函数 :)

```
 using System.Windows.Automation.Peers;

    // solving the bug with static constructor of ControlType..
    ControlType.Button.ToString();
    string controlTypeString = "Window";
    AutomationControlType typeEnum;
    bool result = Enum.TryParse(controlTypeString, true, out typeEnum);
    if (result) typeEnum = (AutomationControlType)Enum.Parse(typeof(AutomationControlType), controlTypeString);
    int enumId = (int)typeEnum + 50000;
    ControlType controlType = ControlType.LookupById(enumId); 
```

# java - 为什么从命令行运行的可执行 jar 比从 Eclipse 运行的同一个项目使用更多的内存？

> ID：13961403
> 
> 赞同：6
> 
> 时间：2012-12-19T21:22:03.267
> 
> 标签：java, eclipse

为什么从命令行运行的可执行 jar 比从 Eclipse 运行的同一个项目使用更多的 RAM（在我的情况下大约是 7 倍）？

在开发项目时，我从 Eclipse（运行->运行）运行应用程序，它使用了大约 60mb（我查看了刚刚创建的 javaw.exe 进程）的内存，而如果我创建一个可执行的 JAR 并从命令行运行它（Windows ) 内存使用量约为 450mb。此外，从命令行运行时 ram 使用变化的幅度更大，而不是从 Eclipse 的 Run->Run 运行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T21:33:15.307

这可能与 Eclipse 启动应用程序时使用的 JVM 设置有关。启动 Jar 时，Java 会根据内存做出最好的猜测。`java`您可以使用控制台上的命令更改使用的内存大小：

```
java -Xms64m -Xmx256m -cp your.jar 
```

`-Xms??m`以 mb 为单位设置最小堆大小。
`-Xmx??m`以 mb 为单位设置最大堆大小。

Java 可能会自动选择更大的堆大小，因为它不是由 eclipse 决定的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T21:29:01.783

在 Eclipse 中，它必须与其他服务/应用程序共享 ram。但是在命令行上它没有限制。在命令行上，您还可以通过启动应用程序来限制 ram。你可以通过这样做来限制它

```
java -Xmx256M -Xms256M -cp /*.jar 
```

# sql - 实体框架代码优先为空的整数

> ID：13961404
> 
> 赞同：0
> 
> 时间：2012-12-19T21:22:06.810
> 
> 标签：sql, vb.net, entity-framework, localdb

我在实体框架开发人员网站上发布了这个没有回应，所以我也会在这里问。

默认情况下，EF Code First 为整数创建“非空”条目。我想创建可为空的整数条目。我找到了 C# 示例（此站点），但尝试在 VB.net 中进行类似操作是行不通的。EF 似乎忽略了“int？” 和“nullable(of int)”属性类型。有没有人想出如何在VB中做到这一点？另外，出于好奇，为什么整数的默认“非空”？提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T21:26:03.000

诠释？用 vb .net 编写为下面的代码，并且应该由 EF 进行相同的输入。

```
Dim i As System.Nullable(Of Integer) 
```

# php - 调整图像大小仅用于显示

> ID：13961405
> 
> 赞同：1
> 
> 时间：2012-12-19T21:22:23.890
> 
> 标签：php, image, resize, gd

我一直在对这个主题进行大量研究，但并不是我发现的所有内容都是我的具体问题的核心。

我受雇为一个朋友重建一个网站，这个网站有大约 20,000 张与 223 个章节相关的图像。每页显示六个章节，每个章节都有一个主图像和描述性文本。主图像是从与每个章节相关的照片中随机选择的。这一切都很好。

问题是这样的：这些照片的尺寸从 640x426 到 929 x 622 不等，并且保存为针对 weband 优化。因此，当您滚动浏览显示章节的页面时，主要图像（在大多数情况下）大小不同，这看起来不太好。

我想坚持使用随机选择的图像，但我不打算开始调整大小，在某些情况下，裁剪超过 20,000 张图像。这就是为什么我想知道调整随机选择的图像的大小仅用于显示是否是一个愚蠢的想法。我在这里和其他地方读过一些帖子说不要这样做。

但是，这样做可以解决我的问题。

同样，章节一次显示 6 个，因此它们有 31 页，并且在任何给定时间，每个用户每次页面浏览都需要调整六个图像的大小。我的一部分人已经知道这不是正确的方法，但我希望得到更多知识渊博的 PHP 人员的一些意见。

我有一个安装了 GD 的专用服务器，但没有安装 ImageMagick。

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T21:40:15.873

如果我是你，我会选择[IrfanView](http://www.irfanview.com/)并通过批量调整大小获得一些乐趣：

![在此处输入图像描述](../Images/e3d5b0fa493a81c4474891bf5e7a99e5.png)

# python - Django，在哪里更新失败的登录尝试，为什么？

> ID：13961409
> 
> 赞同：2
> 
> 时间：2012-12-19T21:22:29.210
> 
> 标签：python, django, authentication

我有一个自定义用户模型，我想在其中跟踪失败的登录尝试次数并据此采取行动。我想知道写这个逻辑的更好的地方是什么。

以下是我在更新用户模型中的 *failed_attempts* 字段时想到的两个选项：

1.  在后端验证方法。
2.  User 模型中的 *check_password* 方法。我已经从 AbstractBaseUser 模型中覆盖了这个方法。

基本逻辑（不包括所有情况）是这样的：

*   如果身份验证失败，请检查上一次登录尝试失败的时间。
*   如果那是最近的，则增加失败的登录计数。
*   如果计数达到最大尝试锁定帐户几分钟（或做其他事情）。

我的问题是写这个逻辑的更好的地方是什么以及为什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T21:28:48.980

仅使用您列出的详细信息，我会说 Authentication 方法更合适，如果只是因为如果更新模型上的字段会**非常**混乱。`check_password`

但是，为什么您既有“支持的身份验证方法”又有`check_password`模型中的方法？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T01:53:19.827

**什么：**我实际上会在身份验证后端实现该逻辑。

**如何：**使用特定的、单独的模型来跟踪登录尝试，或者使用 miko (fail2ban) 建议的解决方案。

**原因：**您将身份验证与用户分离。奖励：如果您想利用`User`Django 中即将推出的可插拔模型，那是个好主意。

* * *

附带说明一下，您可能有一种方法可以通过包装现有的身份验证后端以提供所需的功能来实现更“整洁”的解决方案。

# vba - 用户定义的函数不会在 excel 上更新

> ID：13961413
> 
> 赞同：1
> 
> 时间：2012-12-19T21:22:46.353
> 
> 标签：vba, excel, user-defined-functions

> **可能重复：**
> [刷新 Excel VBA 函数结果](https://stackoverflow.com/questions/11045/refresh-excel-vba-function-results)

我在excel中有简单的功能：

```
Function Test() As String

    Test = Now

End Function 
```

我可以将它用作：

![在此处输入图像描述](../Images/ddb7be44940bc8d280ec10c2842a734a.png)

现在为什么当我按下按钮时：

![在此处输入图像描述](../Images/d0a930a418a3e70794a979a7c34b73f3.png)

值不更新！？

例如，如果我`=Rand()`每次单击计算值时都有一个带有公式的单元格，我将得到一个不同的数字。如何使我的自定义函数表现相同？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T21:32:55.177

添加`application.volatile`到工作

顺便说一句，`now()`可作为 excel 函数使用

# javascript - 检测用户是否喜欢我的 FB 页面，并删除 DIV

> ID：13961417
> 
> 赞同：2
> 
> 时间：2012-12-19T21:23:14.823
> 
> 标签：javascript, jquery, facebook, facebook-like, facebook-javascript-sdk

我为我的网站制作了一个弹出框，邀请访问者在 FB 上点赞我的页面。我想知道是否有一种方法可以检测到喜欢该页面的人，并删除弹出框（= 一个 div），因此每次他们浏览网站时都不会为他们加载。

不知道这是否可能，但我想知道。这是我为此准备的脚本，以防万一您需要它：

```
<script type="text/javascript" src="http://code.jquery.com/jquery.min.js"></script>
<script type="text/javascript">
var dom = {};
dom.query = jQuery.noConflict(true);
var time = 11;

window.setInterval(test, 1000);

function test()
{
    time -=1;
    dom.query('#fb-timer').html(time); 

    if(time == 0)        
    {
        dom.query('#fb-popupdiv').remove();
    }
} 
function setCookie(name,value,days) {
    if (days) {
        var date = new Date();
        date.setTime(date.getTime()+(days*24*60*60*1000));
        var expires = "; expires="+date.toGMTString();
    }
   else var expires = "";
   document.cookie = name+"="+value+expires+"; path=/";
}

function readCookie(name) {
    var nameEQ = name + "=";
    var ca = document.cookie.split(';');
    for(var i=0;i < ca.length;i++) {
        var c = ca[i];
        while (c.charAt(0)==' ') c = c.substring(1,c.length);
       if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);

    }
    return null;
}

function eraseCookie(name) {
    setCookie(name,"",-1);
}
dom.query(document).ready(function() {
    var val = readCookie("popupAlreadyShown");
    if (!val) {
        setCookie("popupAlreadyShown", 1, 1);
        dom.query("#fb-popupdiv").show();
    } else {
}
});
</script> 
```

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T21:31:51.657

你想看看[edge.Create](https://developers.facebook.com/docs/reference/javascript/FB.Event.subscribe/)事件。订阅它，并在其中执行您想要的任何功能。例如：

```
<script type='text/javascript'>
    window.fbAsyncInit = function () {
        FB.init({ appId: '1234567890', status: true, cookie: true,
            xfbml: true
        });

        FB.Event.subscribe('edge.create', function (response) {
            $("#facebookdiv").hide();
            // set a variable or a cookie so it doesn't show on future requests
        });
</script> 
```

**从我链接的页面上的 Facebook 文档中：**

**edge.create** - 当用户喜欢某物时触发（fb:like）。回调函数的响应参数包含被点赞的 URL：

```
"http://www.example.com/article1.php" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T21:34:32.517

除非您有权访问用户的喜欢，否则您无法从 facebook 的一端知道该页面是否被喜欢。但为此，您必须通过 facebook connect 获得用户注册。

大多数类似的门/弹出窗口使用cookie来跟踪类似的。当用户点赞该页面时，facebooks 的 edge.create 用于收听点赞并创建一个 cookie。如果 cookie 被清除，弹出窗口将再次出现。

有关 fb 事件的更多信息： [https ://developers.facebook.com/docs/reference/javascript/FB.Event.subscribe/](https://developers.facebook.com/docs/reference/javascript/FB.Event.subscribe/)

# drupal-7 - Drupal 商务订单项 + 图片

> ID：13961422
> 
> 赞同：1
> 
> 时间：2012-12-19T21:23:30.690
> 
> 标签：drupal-7, drupal-taxonomy, commerce

我有一个 drupal 商务 + 订单项 + 分类法 + 花哨的属性。

```
Product:    
-sku    
-...    
-shape (product line item) - taxonomies (text + image) 
```

![在此处输入图像描述](../Images/ad91c62b00e1826e692fe1a259ed332e.png)

并且分类图像根本不显示（文本没问题）。

当我使用产品变体（形状（产品字段）-分类法（图像））时，一切都很好，但我需要 3 个具有许多属性的变体选项，并且不可能为同一项目创建数百万个 SKU 产品。

如何显示订单项的分类图像？（也许其他一些解决方案？）

# php - 抽象和静态方法

> ID：13961423
> 
> 赞同：1
> 
> 时间：2012-12-19T21:23:30.627
> 
> 标签：php

我正在创建一个数据库连接类作为超类中的抽象。我在 php 中使用 PDO。我想让它抽象化，以便我可以为 mysql、oracle、postgre 等声明特定的数据库连接子类。

我在抽象超类中有一个连接方法，我也将其声明为抽象。我现在的问题是，我可以让这个连接方法在子类中也是静态的吗？我想知道这样做是否正确。

**编辑**

```
//SUPER CLASS
abstract protected function connectToDatabase($hostname, $dbName, $userName, $password="");

// SUB CLASS
public static function connectToDatabase($hostname, $dbName, $userName, $password=""){

        $this->setHostName($hostname);
        $this->setDbName($dbName);
        $this->setUserName($userName);
        $this->setPassword($password);
        $this->setDatabaseType(DATABASE_TYPE);
        $dsn = $this->getDatabaseType(DATABASE_TYPE) . ":" . parent::getHostConst() . "=" 
              . $this->getHostName() . ";" . parent::getDbNameConst() . "=" . $this->getDbName();
        $pdo = new PDO($dsn, $username, $passwd);
        $this->setPdoConnection($pdo);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T21:44:51.300

通过查看您的代码，我会说您不能将它们设为静态，因为您在其中引用了 $this 。$this 在静态方法中应该是什么意思？静态方法在类中只存在一次，并且不引用特殊对象。

例如看一下：[何时使用 self 而不是 $this？](https://stackoverflow.com/questions/151969/php-self-vs-this)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T22:40:21.850

你在抽象基类中说的是子类应该实现这个函数签名：

```
abstract protected function connectToDatabase($hostname, $dbName, $userName, $password=""); 
```

您需要子类将 connectToDatabase() 实现为受保护的方法，但随后您在子类中将其实现为公共。

除非您真的知道自己在做什么，否则请忘记具有抽象方法的基类，而只需创建具有非静态方法的单个类。保持简单。

# bash - bash 查找返回值

> ID：13961425
> 
> 赞同：1
> 
> 时间：2012-12-19T21:23:33.960
> 
> 标签：bash, find

我正在尝试查找一个文件并在多个位置进行检查，但不仅仅是找到它并继续前进，我想知道它的确切位置。“查找”返回的值是否与传递给查找查询的值不同？如果它发现了什么，它是否也返回 true 或 0？

```
FILE="file.txt"
DIR1="/path1/"
DIR2="/path2/" 
```

我知道这在语法上是不正确的，但我需要的是......

```
if ${DIR1}${FILE} = true
then
    echo "${FILE} has been found in ${DIR1}"
fi 
```

有什么比 find 更适合在这里使用的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T21:25:25.280

unix`find`工具呢？

```
FILE="file.txt"
DIR1="/path1/"
DIR2="/path2/"

find "$DIR1" "$DIR2" -type f -name "$FILE" 
```

这将为找到的每个文件打印一个文件路径`stdout`。

**解释：**

*   `find`- 调用`find`，递归查找文件
*   `"$DIR1" "$DIR2"`- 指定要查看的目录路径列表
*   `-type f`- 只考虑文件（不考虑目录、链接）
*   `-name "$FILE"`- 指定文件的名称。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T21:34:44.900

您可以将目录放在一个数组中，然后遍历该数组并测试文件是否存在：

```
#!/bin/bash
FILE="file.txt"
DIR1="/path1/"
DIR2="/path2/"
DIRS=(DIR1 DIR2) 

for dir in ${DIRS[*]}
do
   if [ -e $FILE ]
   then
      echo "File " $FILE " exists in directory " $dir
   fi
done 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T21:38:46.163

比“查找”更简单快捷的是“定位”。

```
locate -b file.txt 
```

这将告诉 file.txt 的位置。

Locate 有一个文件和目录的索引数据库，所以它更快。但是 find 更强大，在管道命令或执行其他高级操作的情况下很有用。

如果要检查文件是否存在以进行条件执行，请查看此链接： [http ://tldp.org/LDP/abs/html/fto.html](http://tldp.org/LDP/abs/html/fto.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-19T21:40:26.070

@McMillen 的答案的另一个版本，只是有点短，可能不那么可读：

```
[[ -e ${DIR}${FILE} ]] && echo "$FILE has been found in ${DIR}" 
```

第一部分检查 DIR 中 FILE 的存在，只有当它成功 (&&) 时，`echo`才会运行该部分

# prolog - 从标准输入解析

> ID：13961426
> 
> 赞同：6
> 
> 时间：2012-12-19T21:23:38.040
> 
> 标签：prolog, swi-prolog

如何解析标准输入（无缓冲）？如果我理解正确，`phrase/2`需要一个列表，并且`phrase_from_file/2`需要`library(pure_input)`一个文件。

我使用普通谓词（不是 DCG）和使用像`get_char/2`and之类的内置函数解决了我的问题`read_line_to_codes/2`，但最终实现看起来与我用 C 编写的解决方案非常相似。

如果我可以偷偷问一个非常相关的问题：SWI-Prolog 中的标准输入是什么？`read_line_to_codes`( `library(readutil)`) 需要一个输入流（`get/1`例如，与 不同）。我用以下谓词得到它：

```
input_stream(Stream) :-
    current_stream(Object, read, Stream),
    integer(Object). 
```

. . . 这当然有效，但感觉有点被黑了。是否可以有多个打开的输入流？我怎么知道哪个是操作系统的标准输入（在我的例子中是 Linux）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T22:04:56.987

我认为您正在寻找正确的流命名。这是一个可能有用的示例：

```
?- read_line_to_codes(user_input,L).
|: a line
L = [97, 32, 108, 105, 110, 101]. 
```

我找到的最详细的解释页面在[这里](http://www.swi-prolog.org/pldoc/doc_for?object=section%282,%274.16%27,swi%28%27/doc/Manual/IO.html%27%29%29)。

# ios - Mac OS X Lion / Mountain Lion 缓存未命中分析

> ID：13961429
> 
> 赞同：15
> 
> 时间：2012-12-19T21:23:53.327
> 
> 标签：ios, profiling, osx-lion, osx-mountain-lion, shark

是否有任何工具可以分析 Mac OS X Lion 和 iOS 上的缓存未命中情况。如果您知道如何在仪器中做到这一点，请提供帮助。

Shark（CHUD 包）不安装在 Mac OS X Lion 及更高版本上，所以我不能使用 Shark。同时我在 Instruments 中找不到缓存未命中分析器的功能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-08T08:37:22.883

我相信您正在寻找的工具称为“VM Operations”。要获得它，首先使用 Instruments 中的空白模板创建一个新文档，然后单击工具栏中的 + 并选择 VM Operations 作为要在出现的面板中添加的工具。

请注意，要完成这项工作，您需要选择延迟模式或窗口模式。您可以在文件->记录选项中更改这些设置...</p>

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-12-12T11:46:26.537

OSX 的[Core Data Cache Misses 工具](https://developer.apple.com/library/mac/documentation/AnalysisTools/Reference/Instruments_User_Reference/CoreDataCacheMissesInstrument/CoreDataCacheMissesInstrument.html)怎么样？

# class - Enterprise Architect 在不同包中的两个类之间创建关联

> ID：13961432
> 
> 赞同：0
> 
> 时间：2012-12-19T21:24:01.863
> 
> 标签：class, package, enterprise-architect

我在多个包中组织类来处理大量的类。如何在 2 个不同包中的类之间建立关系？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T09:19:11.927

从项目浏览器中打开任何类图。

将不同包中的类从项目浏览器拖到图表中。选择“将元素粘贴到图表：作为简单链接”

将类与任何关系连接起来。

关系保存在类类型中，因此将类放入另一个图表将自动绘制相关关系

# sql - SQL Server - 索引具有最小和最大范围的映射表

> ID：13961433
> 
> 赞同：2
> 
> 时间：2012-12-19T21:24:06.400
> 
> 标签：sql, sql-server, indexing, range

在使用具有多个范围的映射表时，我遇到了性能问题。映射表的布局如下。

```
ResultNumber param1Min param1Max param2Min param2Max ... param8min param8max 
```

这些是映射表的列名。桌子上连接的是`param1, param2, param3 ... param8`.

我需要找到（param1 在 param1Min 和 param1Max 之间）和（param2 在 param2Min 和 param2Max 之间）的行......并从匹配的行中获取结果编号。问题是映射表有超过 200 万行，我无法索引该表，因为它必须使用范围来查找所需的内容。

关于如何加快速度的任何想法？

我还包括了我尝试过的完全没有帮助的索引

```
SELECT ResultNumber
FROM   MappingTable
WHERE  ( param1 BETWEEN param1Min AND param1Max )
       AND ( param2 BETWEEN param2Min AND param2Max )
       AND ( param3 BETWEEN param3Min AND param3Max ) 
 ...

CREATE CLUSTERED INDEX [index] ON [dbo].MappingTable 
(
    [param1Min] ASC,
    [param1Max] ASC,
    [param2Min] ASC,
    [param2Max] ASC,
    [param3Min] ASC,
    [param3Max] ASC,
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T02:44:57.693

“param1，param2，param3 ... param8”变量或列在另一个表中吗？在任何情况下，我都会将它分成块以从索引中获取使用情况，并减少每次后续参数检查需要完成的工作。

您想在 resultnumber 和仅 resultnumber 上创建聚集索引，然后在 resultnumber、param#min、param#max 组合上创建非聚集索引。应该是 [dbo].[MappingTable] 上的总共 9 个索引。

```
Create Clustered Index ix_rn On [dbo].[MappingTable] (resultnumber)
Create NonClustered Index ix_p1 On [dbo].[MappingTable] (resultnumber, param1min, param1max)
...
Create NonClustered Index ix_p8 On [dbo].[MappingTable] (resultnumber, param8min, param8max) 
```

这将允许您从下面的代码中获得性能提升。它应该运行得非常快。

```
With    param1 As
(
        Select  resultnumber
        From    [dbo].[MappingTable]
        Where   @param1 Between param1min And param1max
),      param2 As
(
        Select  m.resultNumber
        From    [dbo].[MappingTable] m
        Join    param1 p1
                On  m.resultnumber = p1.resultnumber
        Where   @param2 Between param2min And param2max
),      param3 As
(
        ...
        ...
),      param8 As
(
        Select  m.resultNumber
        From    [dbo].[MappingTable] m
        Join    param7 p7
                On  m.resultnumber = p7.resultnumber
        Where   @param8 Between param8min And param8max
)
Select  resultNumber
From    param8 
```

表实现看起来像这样。根据您要加入的表的大小，它仍需要一段时间，但它的运行速度仍应比原始查询快。

```
With    param1 As
(
        Select  m.resultnumber, w.tableIdentityValue
        From    [dbo].[MappingTable] m
        Join    whateverJoinTable w
                On w.param1 Between m.param1min And m.param1max
),      param2 As
(
        Select  m.resultNumber, w.tableIdentityValue
        From    [dbo].[MappingTable] m
        Join    param1 p1
                On  m.resultnumber = p1.resultnumber
        Join    whateverJoinTable w
                On  m.tableIdentityValue = w.tableIdentityValue
                And w.param2 Between m.param2min And m.param2max
),      param3 As
(
        ...
        ...
),      param8 As
(
        Select  m.resultNumber, w.tableIdentityValue
        From    [dbo].[MappingTable] m
        Join    param7 p7
                On  m.resultnumber = p7.resultnumber
        Join    whateverJoinTable w
                On  m.tableIdentityValue = w.tableIdentityValue
                And w.param8 Between m.param8min And m.param8max
)
Select  resultNumber, tableIdentityValue
From    param8 
```

# sql - SQL选择一个只有孩子的父母

> ID：13961438
> 
> 赞同：4
> 
> 时间：2012-12-19T21:24:20.127
> 
> 标签：sql, tags, parent, subset

如果你有父表

```
create table parent (
  pid int not null,
  name varchar(255)
) 
```

和一个父子连接表

```
create table parent_child (
  pid int not null,
  cid int not null,
  foreign key (pid) references parent(pid),
  foreign key (cid) references child(cid)
)
create table child(
  cid int not null,
  name varchar(255)
) 
```

如何在以下列表（'dave'，'henry'，'myriam'，'jill'）中找到所有孩子都有名字的所有父母的名字。

如果他们有一个不同名字的孩子，我不想看到父母，但如果他们有 1 个或多个孩子并且他们的所有孩子的名字都在列表中，我想看到父母的名字。

我确实找到了这个[https://stackoverflow.com/a/304314/1916621](https://stackoverflow.com/a/304314/1916621)这将帮助我找到一个有这些名字的孩子的父母，但我无法弄清楚只有孩子名字的父母如何该列表的一个子集。

如果有人知道不同方法的性能权衡，则加分。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T21:38:46.430

```
SELECT 
    p.pid, 
    p.name
FROM 
    parent p
WHERE NOT EXISTS (
    SELECT *
    FROM 
        parent_child pc 
        JOIN child c 
            ON pc.cid = c.cid
            AND c.name NOT IN ('dave','henry','myriam','jill')
    WHERE 
        p.pid = pc.pid
) AND EXISTS (
    SELECT *
    FROM 
        parent_child pc 
        JOIN child c 
            ON pc.cid = c.cid
            AND c.name IN ('dave','henry','myriam','jill')
    WHERE 
        p.pid = pc.pid
) 
```

另一种方法...没有子查询，但`DISTINCT`需要额外的方法来消除`parent`加入`parent_child`表的记录重复。

```
SELECT DISTINCT
    p.pid, 
    p.name
FROM 
    parent p 
    JOIN parent_child pc_exists ON pc_exists.pid = p.pid
    JOIN child c_exists 
        ON c_exists.cid = pc_exists.cid
        AND c_exists.name IN ('dave','henry','myriam','jill')
    LEFT JOIN parent_child pc_notExists ON pc_notExists.pid = p.pid
    LEFT JOIN child c_notExists 
        ON c_notExists.cid = pc_notExists.cid
        AND c_notExists.name NOT IN ('dave','henry','myriam','jill')
WHERE
    c_notExists.cid IS NULL 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T21:58:52.843

这是我的适度赌注：

示例表：

**家长**

```
PID     NAME
1       dad john
2       mum sandy
3       dad frank
4       mum kate
5       mum jean 
```

**孩子**

```
CID     NAME
11      dave
22      maryam
33      henry
44      maryam
16      jill
17      lina
23      jack
34      jill
55      dave 
```

**父子**

```
PID     CID
1       11
1       16
1       17
2       22
3       33
4       44
2       23
5       55
3       34 
```

询问：

```
select p.pid, p.name, 
group_concat(c.name) as children
from parent as p
inner join parent_child as pc
on p.pid = pc.pid
join child as c
on pc.cid = c.cid
where c.name
in ('dave','henry','maryam','jill')
group by p.pid
; 
```

结果：

```
PID     NAME        CHILDREN
1       dad john    dave,jill
2       mum sandy   maryam
3       dad frank   henry,jill
4       mum kate    maryam
5       mum jean    dave 
```

*   [SQLFIDDLE](http://sqlfiddle.com/#!2/09ce6/1)

* * *

## 使用 REGEXP 和 GROUP_CONCAT

它比SQL`in`或`find_in_set`SQL 要好得多。我所做的更改，我将列表用作`comma delimitted string`;)

*但这里的问题是：必须在逗号分隔的字符串中找到 group_concat 字符串顺序。* 除非我们`REGEXP`提高效率 :)

询问：

```
select x.pid, x.name,
x.children from(
select p.pid, p.name, 
group_concat(c.name) as children,
  count(c.name) as counts
from parent as p
inner join parent_child as pc
on p.pid = pc.pid
join child as c
on pc.cid = c.cid
group by p.pid) as x
where 'dave,maryam,henry,jill'
REGEXP x.children
; 
```

结果：

```
PID     NAME        CHILDREN
3       dad frank   henry,jill
4       mum kate    maryam
5       mum jean    dave 
```

* **[SQLFIDDLE](http://sqlfiddle.com/#!2/8b12f/14)**

# flash - OpenX - 如何检测闪存版本

> ID：13961440
> 
> 赞同：-1
> 
> 时间：2012-12-19T21:24:31.217
> 
> 标签：flash, openx

我尝试运行包含 swf 文件的活动。该文件是在 Macromedia Flash 11.5 下制作的。

问题是 OpenX 没有在网站上显示该文件。在 admin 中，swf 看起来不错（但它还需要从[http://www.shdon.com/blog/2012/12/03/bugfix-for-handling-of-flash-content-in-openx](http://www.shdon.com/blog/2012/12/03/bugfix-for-handling-of-flash-content-in-openx)进行小修复） .

我对此没有任何想法。我觉得这个问题与负责检测 Flash 版本的 OpenX 的某些部分有关。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T08:43:08.177

OpenX checks the version of the uploaded flash file. You have to change the version of Flash-Player in 9, because OpenX only delivers Flash-Banners up to version 9.

# jquery - 如何使用 jquery 在表中克隆 tr

> ID：13961445
> 
> 赞同：2
> 
> 时间：2012-12-19T21:24:39.567
> 
> 标签：jquery

页面上有很多表格。我想在某个数据之后添加带有现有数据的新行`tr`。所以我有一张桌子：

```
 <table>
            <tr>
                <th>...</th>
                <td>...</td>
            </tr>
        </table>
        <p id="add-tr">[add]</p> 
```

当我单击 to 时`[add]`，我想添加一个`tr`包含现有元素`th`的新`td`元素。我找到了最后一张桌子：

```
$('#add-tr').on('click',function(){
    $(this).prev('table')...;
    }); 
```

（用 hide() 函数检查）下一步做什么？试过：

```
$(this).prev('table').closest('tr').clone(); 
```

但是没有效果！

我在stackoverflow的第一个问题！所以不要太苛刻，谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-19T21:27:44.060

您应该使用`find`or`children`方法并追加行，`closest`方法选择元素的最近父级。

```
var $table = $(this).prev('table');
$table.find('tr:first').clone().appendTo($table); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T21:29:28.817

你真的很接近，只需要使用 .find() 而不是 .closest() 选择内部的 tr，然后选择 .appendTo() 的位置：

```
$('#add-tr').on('click',function(){
    $(this).prev('table').find('tr').first().clone().appendTo('table');
});​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T21:28:18.217

我认为你已经克隆了它，但现在你需要实际附加它：

```
var myRow = $(this).prev('table').closest('tr').clone();

$(this).prev('table').closest('tr').append(myRow); 
```

或类似的

# mysql - MySQL数据库中的法语字符

> ID：13961446
> 
> 赞同：5
> 
> 时间：2012-12-19T21:24:47.847
> 
> 标签：mysql, sql

我有一个庞大的图书作者数据库，其中法国作者的姓名没有正确存储，法语字符已被一些奇怪的字符替换！

我可以通过 SQL 查询来解决问题吗？如果是的话，我很感激你给我一个线索。

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T21:29:59.603

1.  使用 mysqldump 导出表数据
2.  将dump文件create table语句的字符编码改为utf8
3.  删除表或将名称更改为 tablename_old 之类的名称（我建议保留旧表直到实验结束；））
4.  导入修改后的转储文件

由于法语字符都在 UTF8 中，并且您的表上可能没有多字节编码字符集，这应该可以解决问题。

您也许可以只运行一个更改表来更改编码，但根据我的经验，这可能是掷骰子。

# php - 将密码存储在盐渍哈希中以供用户登录

> ID：13961449
> 
> 赞同：0
> 
> 时间：2012-12-19T21:25:02.120
> 
> 标签：php, security, encryption, hash, passwords

> **可能重复：**
> [如何在 PHP 中使用 bcrypt 对密码进行哈希处理？](https://stackoverflow.com/questions/4795385/how-do-you-use-bcrypt-for-hashing-passwords-in-php)

我正在研究将用户密码加密并存储在数据库中以进行登录的最佳和最安全的方法。我遇到的一篇文章[Salted Password Hashing - Doing it Right](http://crackstation.net/hashing-security.htm#phpsourcecode)提供了一组看起来相当复杂的密码加密和检查函数。

我了解代码的工作原理，但文章还提到不仅将散列密码存储在数据库中，还将盐存储在数据库中。使用给定的代码，我将如何去做？例如：

```
// User registers with username and password; assume they're already validataed
$hash = create_hash($password_entered);
$password_hash = $hash[HASH_PBKDF2_INDEX];
$salt = $hash[HASH_SALT_INDEX];

$PDO = new PDO('mysql:host=localhost;dbname=myDatabase', $username, $password);
$statement = $PDO->prepare('INSERT INTO users (username, password, user_salt)
    VALUES (:username, :password; :user_salt)');
$statement->execute(array(
    ':username'  => $username_entered,
    ':password'  => $password_hash,
    ':user_salt' => $salt,
)); 
```

这似乎是正确的......但是，在验证登录时，我不确定要检查登录表单中输入的密码的内容。返回的已编译哈希`create_hash()`给出了一个以冒号分隔的值列表。我只是不确定从这里去哪里，或者这个源代码是否值得使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T21:33:56.803

我没有使用此代码，但我很确定您不应该将 user_salt 单独保存在用户表的列中。用户 salt 将包含在散列中（位置 3 在冒号分隔的散列中）。在您的登录脚本中，获取用户输入的密码，然后调用以下函数：

```
// here run a query and get the hashed password from the users table and put the
// hashed value in $hashed_password_from_database
// $user_enetered_password usually comes from $_POST

if (validate_password($user_entered_password, $hashed_password_from_database)) {
  // login successful
} else {
  // login failed
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T21:34:49.033

要验证登录，请使用您发布的链接上的以下功能，该功能`$password`是尝试登录的用户输入的密码，并且`$good_hash`是`PBKDF2_HASH_ALGORITHM . ":" . PBKDF2_ITERATIONS . ":" . $salt_from_db . ":" . $hash_from_db`

```
function validate_password($password, $good_hash)
{
    $params = explode(":", $good_hash);
    if(count($params) < HASH_SECTIONS)
       return false;
    $pbkdf2 = base64_decode($params[HASH_PBKDF2_INDEX]);
    return slow_equals(
        $pbkdf2,
        pbkdf2(
            $params[HASH_ALGORITHM_INDEX],
            $password,
            $params[HASH_SALT_INDEX],
            (int)$params[HASH_ITERATION_INDEX],
            strlen($pbkdf2),
            true
        )
    );
} 
```

# c# - 跟踪特定的方法调用

> ID：13961458
> 
> 赞同：7
> 
> 时间：2012-12-19T21:25:40.780
> 
> 标签：c#, reflection, azure

目前我正在编写一个可以估算 Azure 应用程序成本的程序。为此，我有想法拦截将（间接）调用（Azure）服务器的所有方法。并且对于每种方法，决定它属于成本的哪个方面（例如（存储事务、服务总线事务、令牌请求等））

这样做的困难之一是我还想在模拟类/方法时拦截方法调用，因此该程序也可以在 Azure 应用程序开发期间用于（单元）测试。

所以我想知道是否有一种方法可以“订阅”类的方法。当调用此方法时，将触发一个事件。或者是否还有其他（更好的）解决方案来拦截存储事务、服务总线事务、令牌请求等，也适用于发送例如存储事务但被模拟的类？

提前致谢

**编辑 1：** 有谁知道是否有一些（帮助）类/库或引用包含/知道影响 Azure 应用程序成本的所有类/方法？

**编辑 2** 这是解决上述问题的好方法吗？或者有其他选择吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T21:30:32.213

您指的是[面向方面的编程](http://en.wikipedia.org/wiki/Aspect_oriented_programming)(AOP)。AOP 处理拦截对象及其方法和属性之间的调度消息。可以执行取决于调用内容的逻辑。

这是一个关于 .NET 中 AOP 框架的问题：

[.Net 中 AOP 的最佳实现是什么？](https://stackoverflow.com/questions/633710/what-is-the-best-implementation-for-aop-in-net)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-08T13:04:57.387

创建一个 HTTP 代理并让您的应用程序通过该代理。这样您就可以真正拦截到 Windows Azure 存储/服务总线/的每个请求...

虽然 AOP 是一个很好的解决方案，但它不能满足您的需求。以[CloudBlob.UploadFile](http://msdn.microsoft.com/nl-nl/library/windowsazure/ee772820.aspx)方法为例。从 AOP 的角度来看，这是一个单独的调用，但如果您查看 HTTP 事务的数量，这可能远远超过 1 个调用（大文件被分块并通过多个 HTTP 请求发送）。

这就是为什么如果要监视对 Windows Azure 服务的所有调用，就需要使用 HTTP 代理之类的低级别的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T21:30:35.927

您可以使用[动态代理](http://www.castleproject.org/projects/dynamicproxy/)生成拦截对底层对象的调用的类，记录有关调用的详细信息，然后转发它们。

我不完全确定你是如何把它全部连接起来的，但希望这会让你朝着正确的方向前进。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-19T21:30:40.293

您正在寻找面向方面的解决方案。像[PostSharp](http://www.sharpcrafters.com/)这样的东西应该适合你。我已经成功地使用了它。不确定是否有其他免费选项可用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-09T02:54:55.690

我们使用[Trace](http://msdn.microsoft.com/en-us/library/system.diagnostics.trace.aspx) API 来跟踪方法调用 - 我建议阅读[Using Trace in Windows Azure Cloud Applications](http://blogs.msdn.com/b/windowsazure/archive/2012/10/25/using-trace-in-windows-azure-cloud-applications-1.aspx)。在 Azure Tables 中捕获数据后，就可以轻松报告正在跟踪的数据（类似于诊断报告）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-09T10:56:44.087

我做了一些我认为是现代 C# 设计的工作，包括代理生成和基于接口的动态方法调用。该博客解释了它的工作原理以及如何使用它。

我很确定这适用于您的场景。

相关链接可以找到：

[装饰代理](http://atlasteit.wordpress.com/2012/06/29/advanced-c-programming-2-decorator-proxy-and-aop/ "装饰代理")

并且可以找到更通用的动态方法调用：

[动态方法调用](http://atlasteit.wordpress.com/2012/07/05/advanced-c-programming-3-generalized-dynamic-method-invocation/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-09T12:10:34.233

您可以创建日志文件。写下时间和错误或反应。这是一个很好的解决方案。一半我？

# php - 用 COUNT 函数计算新消息的数量？

> ID：13961459
> 
> 赞同：0
> 
> 时间：2012-12-19T21:25:57.567
> 
> 标签：php, mysql, count, messages

我正在尝试从我的表 ptb_messages 中获取用户拥有的新消息的数量，其中“read”设置为“0”

有人可以告诉我哪里出错了。

我的表如下所示：

```
id | from_user_id | to_user_id | subject | content | date_sent | read

1         2              4        hello     hello    2012-04-13    0 
```

我正在使用此功能来尝试显示用户拥有的未读消息的数量。

```
function check_new_messages() {
            global $connection;
            global $_SESSION;
            $query = "SELECT COUNT('read') FROM ptb_messages WHERE to_user_id =".$_SESSION['user_id']." AND ('read)'='0'";
            $check_new_messages_set = mysql_query($query, $connection);
            confirm_query($check_new_messages_set);
            return $check_new_messages_set;     
        }

<?php

$check_new_messages_set = check_new_messages();
while ($new = mysql_fetch_array($check_new_messages_set)) {

echo "There are ". $new['COUNT(read)'] ." items.";

}

 ?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T21:28:55.090

你根本不需要`COUNT`那个领域；就`WHERE`足够了。报价只是一点点：

```
$query = "SELECT COUNT(*) FROM ptb_messages WHERE to_user_id =".$_SESSION['user_id']." AND `read` = 0"; 
```

另外，请不要使用`mysql_`扩展名；它们在 PHP 5.5 中已被弃用，并且很容易引入 SQL 注入漏洞。尝试使用 PDO 或 MySQLi 准备好的语句！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T21:28:33.470

尝试：

```
 $query = "SELECT COUNT(read) FROM ptb_messages WHERE to_user_id =".$_SESSION['user_id']." AND read = 0"; 
```

您可能还想阅读[SQL Injection](http://en.wikipedia.org/wiki/SQL_injection)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T21:32:52.023

首先，我认为您的 SQL 可能需要调整：

```
SELECT COUNT('read') FROM ptb_messages WHERE to_user_id =".$_SESSION['user_id']." AND ('read)'='0' 
```

不应该是：

```
SELECT COUNT(id) FROM ptb_messages WHERE to_user_id =".$_SESSION['user_id']." AND `read` = 0 
```

然后这一行：

```
echo "There are ". $new['COUNT(read)'] ." items."; 
```

应该：

```
echo "There are ". $new[0] ." items."; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-19T23:39:56.113

好的，您确实需要查看 Mysqli 或 PDO，话虽如此，很明显您将拥有“已读”列的不同状态。0 = 未读，1 = 已读等....

在这里，您可以使您的函数更通用，并允许您使用一个函数来获取这些状态。像这样的东西：

```
function check_new_messages($id,$state)
{
    $query ="SELECT COUNT(*)as newmessage FROM ptb_messages WHERE to_user_id =".$id." AND `read` ='".$state."'";
    $check_new_messages_set = mysql_query($query, $connection);
    confirm_query($check_new_messages_set);
    return $check_new_messages_set;     
 }
    $check_new_messages_set = check_new_messages($_SESSION['user_id'], '0' );
    while ($new = mysql_fetch_array($check_new_messages_set))
        {
            echo "There are ". $new['newmessage'] ." items.";
        } 
```

这是一个使用 MYSQLI 的示例。在此示例中，您可以返回行数并回显它：

```
function check_new_messages($id,$state)
{
    $MessageCount = new mysqli(DB_HOST, DB_USERNAME, DB_PASSWORD, DB_NAME);
    if ($MessageCount->connect_errno)
    {
        echo "Failed to connect to MySQL: (" . $MessageCount->connect_errno . ") " . $MessageCount->connect_error;
        $MessageCount->close();
    }
    $values = $MessageCount->query("SELECT to_user_id FROM ptb_messages WHERE to_user_id =".$id." AND `read` ='".$state."'");
    if($count = $values->num_rows)
    {
        return $count;
    }
        return 0;
} 
```

//像这样返回调用

```
$Unread = check_new_messages($_SESSION['user_id'], '0' );
echo "There are ". $Unread ." items."; 
```

# android - 自定义 ViewGroup 中的自定义 View 应该使用 onDraw() 还是 layout()？

> ID：13961461
> 
> 赞同：2
> 
> 时间：2012-12-19T21:26:02.680
> 
> 标签：android, android-view, android-custom-view, viewgroup

起初，我创建了一个自定义视图，它通过覆盖该`onDraw()`方法来绘制自己。由于我需要创建大量视图，这被证明是不切实际的。所以我创建了一个自定义 ViewGroup，它使用该`onLayout()`方法绘制它的每个孩子。

我在 android 文档中读到子视图应该实现一个`layout()`方法。但是我制作的子视图使用 onDraw 方法来绘制自己。我该如何处理？我应该摆脱这种`onDraw()`方法吗？谁能给我一个关于该`layout()`方法如何工作以及我应该如何将我`onDraw()`的方法“转换”为方法的示例`layout()`？

我当前的`onDraw()`方法如下所示：

```
protected void onDraw(Canvas canvas)
    {
        super.onDraw(canvas);

        //Draw Border.
        canvas.drawRect(mCellBounds, mBorderPaint);

        //Draw Background.
        canvas.drawRect(mBackgroundBounds, mBackGroundPaint);

        //Draw Value if not 0.
        if(Value != 0)
            canvas.drawText(Integer.toString(Value), ValueX, ValueY, mNumberPaint);

        //Draw Notes if Value == 0.
        else
        {
            for(int i = 0 ; i < 9 ; i++)
                if(NoteList[i])
                    canvas.drawText(Integer.toString(i), NoteX + ((i%3) * NoteMeasureX), NoteY + ((i/3) * NoteMeasureY), mNotePaint);
        }
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-20T11:04:26.580

> 所以我创建了一个自定义 ViewGroup，它使用 onLayout() 方法绘制它的每个孩子。

我不明白你是如何`ViewGroup`用它的方法画出 的孩子的`onLayout`。应该使用该方法将孩子定位在屏幕上。

> 我在 android 文档中读到子视图应该实现 layout() 方法

该方法已经实现，您使用正确的值调用它，以便`View`知道它应该放在屏幕上的哪个位置。

> 我应该摆脱 onDraw() 方法吗？

如果你想真正看到一些东西，你不应该忽略这个`onDraw`方法。

> 谁能给我一个例子，说明 layout() 方法是如何工作的，以及我应该如何将我的 onDraw() 方法“转换”为 layout() 方法？

您不会将`onDraw`方法转换为`layout`方法。例如，我制作了一个由 custom`ViewGroup`和 custom child组成的小样本`View`。自定义`ViewGroup`它将放置两个（预期的孩子），如下图所示（每个孩子的宽度和高度都是父母的一半）：

![自定义视图组](../Images/32c378fe84fd06d6567f31818fb4379d.png)

[您可以在此处](https://gist.github.com/4344689)找到示例。我希望它对你有帮助。您还可以查看 SDK 布局的源代码（如 simple `FrameLayout`），了解它们如何发挥作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T22:37:15.150

你真的需要整个视图层次结构吗？考虑使用[SurfaceView](http://developer.android.com/reference/android/view/SurfaceView.html)，这是一种更轻松的自定义绘图方式，并且您可以在一个视图中轻松嵌入到其他视图中。

另请参阅我的[答案](https://stackoverflow.com/questions/3268068/android-custom-layout/10709991#10709991)。

# java - Android SQLite - 尝试访问单行但可以访问整个数据时出现 NullPointerException？

> ID：13961462
> 
> 赞同：1
> 
> 时间：2012-12-19T21:26:22.360
> 
> 标签：java, android, sqlite, nullpointerexception, logcat

基本上，我可以插入我的数据库并使用以下方法查看所有结果，并将 SimpleCursorAdapter 显示到 ListView - 工作得很好。

```
// Returns a Cursor containing all JSON strings
public Cursor getAllJSONstrings()
{       
    // Return all JSONstrings ordered by COLUMN_ID
    return ssDatabase.query(TABLE_ROUTINES, new String[] {COLUMN_ROWID, COLUMN_JSON}, null, null, null, null, COLUMN_ROWID);        
} 
```

但是，以下方法提供的信息不亚于`NullPointerException`我每次查询。

id LogCat 标签将标签显示为应有的标签，1 表示第一项等。

```
// Return one JSONstring in String form 
public String getJSONstring(long id)
{
    Log.i(TAG, "getJSONstringStart... id=" + id);

    Cursor cursor;

    Log.i(TAG, "Cursor defined");

    /****** NullPointerException LINE ******/
    cursor = ssDatabase.query(TABLE_ROUTINES, null, "_id=" + id, null, null, null, null);

    Log.i(TAG, "Exceed Cursor");

    int index = cursor.getColumnIndex(COLUMN_JSON);

    Log.i(TAG, "index=" + index);

    return cursor.getString(index);
} 
```

值得一提的是，此方法 getJSONString(long id) 正在 AsyncTask 中执行。它引用的 id 是 OnItemClickListeners onItemClick 方法中的 id。

任何帮助将不胜感激，我的头已经方了！

干杯!

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T21:40:54.907

你必须做 moveToFirst()。您的方法假设游标的当前行指针已设置为第一行，并且 getString(index) 将返回第一行的 COLUMN_JSON 值。

这不是真的。你永远不应该假设你的查询返回了一些东西。如果选择子句没有返回任何行，则 cursor.getCount() 将返回 0。此外，查询可能会抛出 SQLite 异常。任何时候查看查询结果时，都应该将代码附在

尝试 {

```
// query
if ((cursor != null) && (cursor.getCount() > 0)) {

    // some operation

}
... 
```

} 捕捉（异常 e）{

}

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T21:36:45.053

鉴于唯一可能的 null 引用是 ssDatabase，因为光标刚刚被分配并且 id 是一个普通的 long，并且假设您使用的是常见的 SqlliteHelper 模式，我的猜测是您之前可能忘记调用 open()打电话

> 获取JSON字符串

# php - 为什么 Easyuniv REST API 不处理错误？

> ID：13961467
> 
> 赞同：0
> 
> 时间：2012-12-19T21:26:43.437
> 
> 标签：php, rest

我正在编写一个 REST API，目前正在测试一些东西。我试图让它在数据库中找不到任何内容时发送错误响应。

正在运行的部分（因为我目前正在通过在浏览器中输入 url 进行测试）如下：

```
 else if ($request->getHttpAccept() === 'xml')  
    {  
        if(isset($data['s']) && isset($data['n'])) {
            $id = $db->getAlcoholIDByNameSize($data['n'], $data['s']);
            $prices = $db->pricesByAlcohol($id);
        }
        if(isset($id)) {
            $resData = array();
            if(!empty($prices)) {
                foreach($prices as $p) {
                    $store = $db->store($p['store']);
                    array_push($resData, array('storeID' => $p['store'], 'store_name' => $store['name'], 'store_gps' => $store['gps'], 'price' => round($p['price'], 2)));
                }
                RestUtils::sendResponse(200, json_encode($resData), 'application/json'); 
            } else {
                RestUtils::sendResponse(204, 'error', 'application/json'); 
            }
        } else {
            RestUtils::sendResponse(204, 'error', 'application/json'); 
        }
        //RestUtils::sendResponse(501, "xml response not implemented", 'application/xml');  
    } 
```

如果查询返回要存储在 $id 和 $prices 中的内容，则一切正常。但是，如果它们在数据库中不存在，它会尝试加载该页面，然后返回到您所在的上一个页面。您可以通过以下方式查看行为：

```
http://easyuniv.com/API/alc/coorsa/2   <-- works
http://easyuniv.com/API/alc/coors/3    <-- works
http://easyuniv.com/API/alc/coorsa/5   <-- doesn't work(or anything else, the two above are the only ones) 
```

这是我的 sendResponse 函数：

```
 public static function sendResponse($status = 200, $body = '', $content_type = 'text/html')  
    {  
        $status_header = 'HTTP/1.1 ' . $status . ' ' . RestUtils::getStatusCodeMessage($status);  
        // set the status  
        header($status_header);  
        // set the content type  
        header('Content-type: ' . $content_type);  

        // pages with body are easy  
        if($body !== '')  
        {  
            $temp = json_decode($body);
            $body = json_encode(array('result' => array('status' => $status, 'message' => RestUtils::getStatusCodeMessage($status)), 'data' => $temp));
            // send the body  
            echo $body;  
            exit;  
        }  
        // we need to create the body if none is passed  
        else  
        {           
            $body = "else".json_encode(array('result' => array('status' => $status, 'message' => RestUtils::getStatusCodeMessage($status))));

            echo $body;  
            exit;  
        }  
    } 
```

我曾尝试使用回声进行调试，但我似乎无法缩小问题的范围。任何帮助将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T21:42:32.850

问题是，当您返回的数据库中没有找到合适的数据时，`HTTP 204`这告诉浏览器绝对没有任何东西可以显示。在您的情况下，情况并非如此。

你仍然想输出没有找到的消息。

要修复，您需要将`204`代码中的两个实例替换为`200`.

我修改了测试你的代码使用：注意，什么都不会显示。获取消息以显示`204`变量中`200`的更改。`$status_header`

```
<?php
        $status_header = 'HTTP/1.1 204';

        // set the status  
        header($status_header);  
        // set the content type  
        header('Content-type: text/html');

        echo "Can you see me???";
?> 
```

注意：在测试时，请始终关闭选项卡并为每个调用使用一个新选项卡，否则它看起来像是从上一个调用中加载数据，就像你已经解释的那样。

# android - Android 如何在 ORMLite 中建立自我关系？

> ID：13961470
> 
> 赞同：0
> 
> 时间：2012-12-19T21:27:07.640
> 
> 标签：android, database, foreign-keys, ormlite

我有以下对象是自关系的，如下：

```
@DatabaseTable(tableName = "categoria")
public class Categoria implements Serializable {

    @DatabaseField(generatedId = true)
    public int id;

    @DatabaseField(canBeNull = true, foreign = true)
    public Categoria pai;

    @DatabaseField(canBeNull = false, width = 50, unique = true)
    public String descricao;

    public Categoria() { }
} 
```

当我这样做时：

```
Categoria cat = new Categoria();
cat.pai = null;
cat.descricao = "Comidas";

categoryDao.create(cat); //should be id = 1.

Categoria sub_cat = new Categoria();
sub_cat.pai = cat;
sub_cat.descricao = "Bebidas";

categoryDao.create(sub_cat); // should be id = 2. 
```

因此，执行此操作时，我的对象类别为空：

```
Categoria sub_cat = categoryDao.queryForId(2);

sub_cat.descricao // is ok, return "Bebidas". 
```

但

```
sub_cat.pai // is null when supposed to be sub_cat.pai.id = 1. 
```

我做错了什么？

# ruby-on-rails - 在控制器中填充访问者 IP 地址以进行 Geocoder near() 查询

> ID：13961471
> 
> 赞同：0
> 
> 时间：2012-12-19T21:27:09.383
> 
> 标签：ruby-on-rails, gmaps4rails, rails-geocoder

我想获取访问者的 IP 地址并在我的控制器中使用它，以便我可以使用地理编码器来查找附近的对象。

所以我有一个 Location 模型，我想运行这样的查询：

```
def index
  @json = Location.near('visitor location here', 20).to_gmaps4rails
end 
```

所以我可以向他们展示一张预先填充了最近位置的地图。

我如何访问他们的 IP 地址并在控制器中使用它？可以做到吗？我应该尝试使用范围在模型中完成此操作吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-19T21:29:54.440

从您的控制器：

```
request.remote_ip 
```

# c# - 如何计算字符串中的特定字符集

> ID：13961472
> 
> 赞同：6
> 
> 时间：2012-12-19T21:27:09.223
> 
> 标签：c#, regex, string, linq

基本上，我想计算字符串中特定字符的集合。换句话说，我需要计算所有的字母和数字，仅此而已。但我似乎找不到正确的（正则表达式）语法。这就是我所拥有的...

```
public double AlphaNumericCount(string s)
{
    double count = Regex.Matches(s, "[A-Z].[a-z].[0-9]").Count;
        return count;
} 
```

我一直在环顾四周，但似乎找不到任何允许一组以上字符的东西。同样，我不确定语法可能应该是“[AZ]/[az]/[0-9]”之类的。任何人，对我放轻松——这是我使用正则表达式的第一天。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-19T21:32:22.433

[正则表达式备忘单](http://www.mikesdotnetting.com/Article/46/CSharp-Regular-Expressions-Cheat-Sheet)

[Expresso 正则表达式工具](http://www.ultrapico.com/Expresso.htm)

`[A-Z].[a-z].[0-9]`将匹配任何大写字母 ( `[A-Z]`)，后跟任意字符 ( `.`)，后跟任意小写字母 ( `[a-z]`)，后跟任意字符 ( `.`)，后跟任意数字 ( `[0-9]`)。

您想在任何字母或数字上匹配的是`[A-Za-z0-9]`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-19T21:37:09.407

如果不需要使用正则表达式，有一个简单的替代解决方案：

```
return s.ToCharArray().Count(c => Char.IsNumber(c) || Char.IsLetter(c)); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-19T21:29:56.807

试试这个：

```
^[a-zA-Z0-9]+$ 
```

参见：[regexlib.com](http://regexlib.com/REDetails.aspx?regexp_id=1014)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-12-19T21:31:53.717

如果您想避免使用正则表达式，您可以简单地遍历字符串中的字符并使用[Char.IsLetterOrDigit](http://msdn.microsoft.com/en-us/library/system.char.isletterordigit.aspx)检查它们是字母还是数字。

```
public int AlphaNumericCount(string s)
{
    int count = 0;

    for(int i = 0; i < s.Length; i++)
    {
       if(Char.IsLetterOrDigit(s[i])) 
          count++;
    }

    return count;
} 
```

# android - WiFi热点Android手机的连接总数

> ID：13961478
> 
> 赞同：-1
> 
> 时间：2012-12-19T21:27:35.533
> 
> 标签：android, mobile

昨天我把我的手机作为 WiFi 热点运行了，但它似乎只允许总共 8 个用户，其他型号的型号也一样吗？不用担心我的模型，只是想知道总数是否为 8，因为我正在为 Android 移动设备创建应用程序。

帆布

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T21:41:29.183

根据谷歌官方帮助[页面](http://support.google.com/android/bin/answer.py?hl=en&answer=2677717)，你是对的，只允许8个同时连接。

> 您还可以通过将其变成便携式 Wi-Fi 热点，一次与多达 8 台设备共享您的数据连接。

# c++ - 使用提取从 boost::python::object 展开 boost::function

> ID：13961486
> 
> 赞同：2
> 
> 时间：2012-12-19T21:27:58.817
> 
> 标签：c++, boost, boost-python, boost-function

如何从 C++ 调用 C++ 模块函数但从 python 中选择函数？请参阅下面的示例

我知道我可以手动设置字符串映射，然后选择我想要运行的函数，但我想要一个更干净的 python 解决方案。

我还希望它非常高效，希望基本上是解开 boost::python::object 并从中提取 boost::function<> 。

这是python文件

```
import stackoverflow #this is a C++ module I wrote

t = stackoverflow.TestClass()
t.Reference()                      # time invoking a boost::function 100k times
t.CallSomeClassMemberFunction(t.a) # instead of choosing a function directly, i want to pass in which function I want to invoke from python 
```

C++ 模块代码（编译，但不运行..你可以看到我的意图）：

```
#include <sys/time.h>
#include <stdlib.h>
#include <boost/function.hpp>
#include <boost/python.hpp>

struct TestClass
{
    TestClass() { }

    int a() const { return rand()%4; }
    int b() const { return rand()%64; }

    template<typename T>
    void BenchMark(T & aUnknownFunction)
    {
        timeval begin, end;
        long long sum(0);
        gettimeofday(&begin, NULL);
        __asm__ __volatile__ ("cpuid");
        for (int x(0); x!=100000; ++x)
            sum += aUnknownFunction();
        __asm__ __volatile__ ("cpuid");
        gettimeofday(&end, NULL);

        std::cout << "Time: " << 1000000 * (end.tv_sec - begin.tv_sec) + (end.tv_usec - begin.tv_usec) << std::endl;
        srand(sum);
    }

    void CallSomeClassMemberFunction(boost::python::object &aTest)
    {
        boost::function<int ()> unknownFunction =  boost::python::extract<boost::function<int ()> >(aTest) ;  // i don't think this works as I want
        BenchMark( unknownFunction );
    }

    void Reference()
    {
        boost::function<int ()> unknownFunction = boost::bind(&TestClass::a, this);
        BenchMark( unknownFunction );
    }
};

BOOST_PYTHON_MODULE(stackoverflow)
{
    boost::python::class_<TestClass>("TestClass")
        .def("a",&TestClass::a)
        .def("b",&TestClass::b)
        .def("CallSomeClassMemberFunction",&TestClass::CallSomeClassMemberFunction)
        .def("Reference",&TestClass::Reference)
        ;
} 
```

如果你能让它运行，也很想看看你的时间安排。

# debugging - 如何在 SQL Server 2008 R2 上使用 Visual Studio 2010 调试 SharePoint 存储过程？

> ID：13961490
> 
> 赞同：0
> 
> 时间：2012-12-19T21:28:10.973
> 
> 标签：debugging, sharepoint, stored-procedures

我正在寻找一种方法来调试 SharePoint 使用的存储过程。我想知道数据库端发生了什么。COM 异常消息是猪无用的（0x8004005，这意味着一般问题 - 万岁），我想看看另一边出了什么问题，因为我不能在 COM 组件本身中乱七八糟。虽然我遵循了关于如何设置 VS 以调试 SQL Server 的描述，但他们都假设我可以自己调用存储的过程。我正在寻找 Debugger.break() 风格的 T-SQL 调用或类似的东西。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T06:45:22.830

您只能在 SERVER 上调试存储过程，而不能在 CLIENT 上调试。

如果服务器上安装了sql server，而本地PC上只安装了SQL Server Management Studio，则无法在本地PC上调试存储过程。

您需要转到服务器，在那里您可以在 SQL Server Management Studio 中调试存储过程，如下所示：

1.  在 SQL Server Management Studio 中打开存储过程。
2.  单击“调试”菜单中的“开始调试”。

# r - 从 2 个向量中找到最佳匹配的成对点

> ID：13961493
> 
> 赞同：8
> 
> 时间：2012-12-19T21:28:23.453
> 
> 标签：r, matrix, distance

我有 2 个点的 X、Y 坐标列表。列表 1 包含的点比列表 2 多。

任务是以最小化整体欧式距离的方式找到点对。

我有一个工作代码，但我不知道这是否是最好的方法，我想提示我可以改进什么结果（更好的算法来找到最小值）或速度，因为每个列表大约有 2000 个元素.

实施样本向量中的轮次以获得具有相同距离的点。使用“rdist”功能，所有距离都以“距离”生成。比矩阵中的最小值用于链接 2 点（“dist_min”）。这两个点的所有距离现在都被 NA 替换，循环继续搜索下一个最小值，直到列表 2 的所有点都具有列表 1 中的一个点。最后，我添加了一个可视化图。

```
require(fields)

set.seed(1)
x1y1.data <- matrix(round(runif(200*2),2), ncol = 2)   # generate 1st set of points 
x2y2.data <- matrix(round(runif(100*2),2), ncol = 2)   # generate 2nd set of points

distances <- rdist(x1y1.data, x2y2.data)
dist_min <- matrix(data=NA,nrow=ncol(distances),ncol=7)   # prepare resulting vector with 7 columns

for(i in 1:ncol(distances)) 
{
    inds <- which(distances == min(distances,na.rm = TRUE), arr.ind=TRUE)

    dist_min[i,1] <- inds[1,1]              # row of point(use 1st element of inds if points have same distance)
    dist_min[i,2] <- inds[1,2]              # column of point (use 1st element of inds if points have same distance)
    dist_min[i,3] <- distances[inds[1,1],inds[1,2]] # distance of point
    dist_min[i,4] <- x1y1.data[inds[1,1],1]     # X1 ccordinate of 1st point
    dist_min[i,5] <- x1y1.data[inds[1,1],2]     # Y1 coordinate of 1st point
    dist_min[i,6] <- x2y2.data[inds[1,2],1]     # X2 coordinate of 2nd point
    dist_min[i,7] <- x2y2.data[inds[1,2],2]     # Y2 coordinate of 2nd point

    distances[inds[1,1],] <- NA # remove row (fill with NA), where minimum was found
    distances[,inds[1,2]] <- NA # remove column (fill with NA), where minimum was found
}

# plot 1st set of points
# print mean distance as measure for optimization
plot(x1y1.data,col="blue",main="mean of min_distances",sub=mean(dist_min[,3],na.rm=TRUE))       
points(x2y2.data,col="red")                         # plot 2nd set of points
segments(dist_min[,4],dist_min[,5],dist_min[,6],dist_min[,7])   # connect pairwise according found minimal distance 
```

![最小距离输出](../Images/61b33bbc5057883a7f125cf76b46bbd8.png)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-20T00:47:31.833

这是组合优化中的一个基本问题，称为[分配问题](http://en.wikipedia.org/wiki/Assignment_problem)。解决分配问题的一种方法是在 R 包中实现的[匈牙利算法线索：](http://en.wikipedia.org/wiki/Hungarian_algorithm)

```
require(clue)
sol <- solve_LSAP(t(distances)) 
```

我们可以验证它是否优于简单的解决方案：

```
mean(dist_min[,3])
# [1] 0.05696033
mean(sqrt(
  (x2y2.data[,1] - x1y1.data[sol, 1])^2 +  
    (x2y2.data[,2] - x1y1.data[sol, 2])^2))
#[1] 0.05194625 
```

我们可以构建与您问题中的情节类似的情节：

```
plot(x1y1.data,col="blue")       
points(x2y2.data,col="red")
segments(x2y2.data[,1], x2y2.data[,2], x1y1.data[sol, 1], x1y1.data[sol, 2]) 
```

![在此处输入图像描述](../Images/738a2bd877aa2e4250fc0c0360ee9fe7.png)

# c# - 按属性过滤 XML 文件并在 datagridview 中显示结果

> ID：13961498
> 
> 赞同：0
> 
> 时间：2012-12-19T21:28:48.493
> 
> 标签：c#, datagridview

我有一个程序可以将一本书的名称、作者和 ISBN 存储在 XML 文件中。该程序有效，但我的搜索按钮有问题，它只过滤整体，但我需要它来过滤任何单词。

我一直在寻找，我发现了这个：

```
private void FilterByType(string type)
{
            var dataView = ((DataTable) this.dataGridView.DataSource).DefaultView;
            dataView.RowFilter = "(Type = '" + type + "')";
} 
```

还有这个：

```
dataView.RowFilter = "(Type LIKE *'" + substring + "*')"; 
```

第一个有效，但就像我说的那样，它会查找整个名称，当我尝试使用第二个时，我收到此消息“语法错误：'*' 运算符之前缺少操作数”。

希望你能帮助我，谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T21:34:26.273

你放错地方了`*`。它应该是

```
 "(Type LIKE '*" + substring + "*')"; //moved after the ' 
```

完整[的参考在这里。](http://www.csharp-examples.net/dataview-rowfilter/)

# php - CodeIgniter 中是否有内置的验证功能？这不适用于表格

> ID：13961504
> 
> 赞同：1
> 
> 时间：2012-12-19T21:29:08.260
> 
> 标签：php, codeigniter, validation

我想检查变量`$username`是否为字母数字且少于 15 个字符。CodeIgniter 是否内置了此功能？如果它们已经存在，我不想重写这些函数。我知道有表单验证，但这不是我想要的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T21:34:36.790

在@Sparky 的评论之后，所有的验证函数看起来都是内部的公共函数`Form_validation.php`

您可以加载表单 vlaidation 并直接使用验证功能

[`max_length`](https://github.com/EllisLab/CodeIgniter/blob/develop/system/libraries/Form_validation.php#L1070)所以你可以运行它[`alpha_numeric`](https://github.com/EllisLab/CodeIgniter/blob/develop/system/libraries/Form_validation.php#L1227)，因为它们都是公开的，只需查看源代码并使用正确的参数调用它们

# delphi - 为什么 TFormatSettings 的行为不符合预期？

> ID：13961507
> 
> 赞同：14
> 
> 时间：2012-12-19T21:29:10.800
> 
> 标签：delphi, str-to-date

我希望以下代码能够工作：

```
program Project3;

{$APPTYPE CONSOLE}

{$R *.res}

uses
  System.SysUtils;

var
  FS: TFormatSettings;

const
  DF = 'yyyymmdd';

begin
  try
   WriteLn(FormatDateTime(DF, Now));

   FS := TFormatSettings.Create;
   FS.ShortDateFormat := DF;
   WriteLn(StrToDate('20121219', FS));

   ReadLn;
  except
    on E: Exception do
      Writeln(E.ClassName, ': ', E.Message);
  end;
end. 
```

为什么会抛出异常，说“20121219”不是有效日期？这不正是通过 TFormatSettings 应该做的吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-12-19T21:46:32.243

StrToDate() 需要在 FS.DateSeparator 中定义的分隔符： Char; 所以不能为空。

参考： [http ://docwiki.embarcadero.com/Libraries/XE3/en/System.SysUtils.StrToDate](http://docwiki.embarcadero.com/Libraries/XE3/en/System.SysUtils.StrToDate)

# jquery - 基于下拉选择的jQuery ValidationEngine交换规则

> ID：13961512
> 
> 赞同：2
> 
> 时间：2012-12-19T21:29:39.510
> 
> 标签：jquery, regex, jquery-validation-engine

我有一个包含联系人“类型”（电话、电子邮件、邮政编码等）的下拉框。

根据选择，第二个文本框需要应用不同的验证规则。

如何`jquery.validationEngine`在文本框中动态添加/删除规则？这是简单的部分。

```
$(function () {
    $("[id$=inputType]").change(function () {
        switch ($(this).val()) {
            case "Phone":
            case "Mobile":
                break;
            case "Email":
                break;
            case "PostalCode":
                break;
            default:
                break;
        }
    });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T07:16:37.197

我认为你不应该在这里使用这样的逻辑。
根据[官方文档](http://www.position-absolute.com/articles/jquery-form-validator-because-form-validation-is-a-mess/)，您可以使用函数来使用`funcCall[methodName]`指令验证您的输入。

所以你可以使用这样的代码：

```
<input value="" class="validate[required,funcCall[checkHELLO]]" type="inputType" id="selectTypes" name="selectTypes" />

function checkHELLO(field, rules, i, options){
    switch ($(this).val()) {
        case "Phone":
        case "Mobile":
            break;
        case "Email":
            break;
        case "PostalCode":
            break;
        default:
            return options.allrules.validate2fields.alertText;
     }
  }
} 
```

# authentication - 为什么 Redis 不能与 requirepass 指令一起使用？

> ID：13961520
> 
> 赞同：2
> 
> 时间：2012-12-19T21:30:12.677
> 
> 标签：authentication, redis

我想设置一个密码来连接到 Redis 服务器。

适当的方法是使用`requirepass`配置文件中的指令。 [http://redis.io/commands/auth](http://redis.io/commands/auth)

但是，在设置值之后，我在重新启动 Redis 时得到了这个：

```
Stopping redis-server: redis-server.
Starting redis-server: Segmentation fault (core dumped)
failed 
```

这是为什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-20T10:12:31.610

密码长度限制为 512 个字符。

在 redis.h 中：

```
#define REDIS_AUTHPASS_MAX_LEN 512 
```

在 config.c 中：

```
 } else if (!strcasecmp(argv[0],"requirepass") && argc == 2) {
        if (strlen(argv[1]) > REDIS_AUTHPASS_MAX_LEN) {
            err = "Password is longer than REDIS_AUTHPASS_MAX_LEN";
            goto loaderr;
        }
        server.requirepass = zstrdup(argv[1]);
    } 
```

现在，配置文件的解析机制已经很基础了。使用 sds（字符串管理）库的 sdssplitargs 函数拆分所有行。此函数解释特定的字符序列，例如：

*   单引号和双引号
*   \x 十六进制数字
*   特殊字符，例如 \n、\r、\t、\b、\a

这里的问题是您的密码包含一个双引号字符。解析失败，因为字符串末尾没有匹配的双引号。在这种情况下，sdssplitargs 函数返回一个 NULL 指针。发生核心转储是因为未在 config.c 代码中正确检查此指针：

```
 /* Split into arguments */
    argv = sdssplitargs(lines[i],&argc);
    sdstolower(argv[0]); 
```

这是一个应该提交 IMO 的错误。

一个简单的解决方法是用十六进制序列替换双引号字符或任何其他解释字符（即双引号的 \x22）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-19T21:30:12.677

虽然没有记录，但密码值似乎有限制，特别是包含字符，而不是长度。

我尝试了 160 个字符（只是数字），效果很好。这

```
9hhNiP8MSHZjQjJAWE6PmvSpgVbifQKCNXckkA4XMCPKW6j9YA9kcKiFT6mE 
```

也。但是这个

```
@hEpj6kNkAeYC3}@:M(:$Y,GYFxNebdH<]8dC~NLf)dv!84Z=Tua>>"A(=A< 
```

才不是。

因此，Redis 不支持部分或全部“特殊字符”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-13T15:48:08.640

**刚刚把这个钉在了：**

*   php: urlencode('crazy&char's^pa$$wor|]');
*   -或者-
*   js: encodeURIComponent('crazy&char's^pa$$wor|]');

然后它可以在通过（通常）tcp发送到redis服务器的任何地方使用

# java - Designing format for intermediate data files?

> ID：13961531
> 
> 赞同：1
> 
> 时间：2012-12-19T21:30:44.570
> 
> 标签：java, python, r

We are dumping a lot of data (in terms of volume than frequency i.e. dumping 100K or > 400MB records at once ) from database to Excel files. The dumping process is currently being performed in Python, R and Java (using POI library). As part of the dump process, we read the data from the database to a intermediate file (pipe delimited text file) which is then picked up by the code to update excel files. Recently, we ran into issues where text from database with newline characters caused the pipe -delimited files to be invalid since 1 record spanned over multiple lines as opposed to just one line. For example,

```
| Col1 | Col2 | Col3 |  
| Val  | Val2 | Val3 | 
```

is a valid example of pipe delimited file. If the data contains any new lines, then:

```
| Col1 | Col2 | Col3 |
| Val1

| Val2 | Val3 

| 
```

Such scenarios become harder to catch and results in more coding then needs to be done in order to make such checks.

I was wondering if there are any libraries/techniques that can be used to write out such temp data. I am not sure if XML would be a solution, considering that performance might become a issue for such a large volume of data. JSON might seem a better fit, but then I don't know all my options here.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T21:40:33.140

If the number of columns is always guaranteed to be the same, this is just an odd dialect of csv, which you should be able to parse with the `csv` module in Python, and I suspect Java (but maybe not R) has similar functionality in either a built-in or readily-available library.

Or, if you've written the parsers yourself for some reason, it should be pretty easy to extend them to handle newlines. For example, instead of reading a line and splitting on `|` and assuming you've got all the fields, read a line, split on `|`, count to see if you have enough fields, and if not read the next line and append and try again. But you're really better off using code that's already been written and tested than trying to hack it together yourself.

(Of course if the fields can contain `|` characters, then this format is ambiguous, and can't be parsed by anything, unless you're escaping them somehow.)

Another option is to just quote or escape the newlines (and other special characters) on one end and unescape them on the other. Again, this is something any decent csv library will do for you (almost whether you want it to or not).

And you might want to consider using the quasi-standard csv dialect (usually meaning "as defined by Excel's defaults") instead of coming up with a similar but not identical custom format.

One obvious advantage of using a standard csv dialect is that Excel can then read the results directly, which may take one layer out of your long chain. (Of course you might be able to take even more layers out, by using Excel's data access features to just import or front for the actual database.)

If you want to change to JSON, there's no reason you can't. But there doesn't seem to be any compelling reason to do so here. When you have flexible, dynamic record types, JSON (or something similar, like YAML) is definitely the way to go. But when you have static record types repeated over and over again, JSON means repeating the names of those fields over and over. It's not as bad as XML would be, but it's still extra information to create, pass, and parse for no real benefit.

So, I think the right answer here is: Excel-style csv if possible, your own unique csv dialect with a rule added for how to deal with newlines if for some reason that's not possible.

# sql-server - 如何将值传递给 OLE DB 源组件中的存储过程参数？

> ID：13961534
> 
> 赞同：4
> 
> 时间：2012-12-19T21:30:56.640
> 
> 标签：sql-server, ssis, etl

我正在使用 SSIS 2008。我有一个*`sqlquery1`*返回一些行的选择查询名称：

```
aq
dr
tb 
```

此查询目前未在 SSIS 上实现。

我从数据流任务中的 OLE DB 源调用存储过程。我想将从查询中获得的数据传递给存储过程参数。

### 例子：

我想通过传递第一个值来调用存储过程*`aq`*

```
storedProdecure1 'aq' 
```

然后传递第二个值*`dr`*

```
storedProdecure1 'dr' 
```

我想这将是一个循环。我需要这个，因为*`OLE DB Source`*通过存储过程生成的数据需要发送到另一个目的地，并且必须为*sqlquery1*的每条记录完成。

我想知道如何调用查询*`sqlquery1`*并将其输出传递给另一个存储过程。

我需要如何在 SSIS 中执行此操作？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-12-20T16:58:46.133

从概念上讲，您的解决方案将类似于执行源查询以生成结果集。将其存储到一个变量中，然后您需要遍历这些结果，对于每一行，您需要使用该行的值调用您的存储过程并将结果发送到一个新的 Excel 文件中。

我设想你的包裹看起来像这样

一个名为“SQL Load Recordset”的执行 SQL 任务，附加到一个名为“FELC Shred Recordset”的 Foreach 循环容器。嵌套在那里我有一个文件系统任务，名为“FST 复制模板”，它是数据流任务的优先级，名为“DFT 生成输出”。

![控制流](../Images/e4afa91f456283583c06f7e5b36fca5f.png)

# 设置

由于您是初学者，我将尝试详细解释。为了省点麻烦，请获取[BIDSHelper](http://bidshelper.codeplex.com)的副本。它是一个免费的开源工具，可改善 BIDS/SSDT 的设计体验。

## 变量

单击控制流的背景。没有选择任何内容，右键单击并选择变量。在弹出的新窗口中，单击创建新变量的按钮 4 次。什么都不点击的原因是，在 SQL Server 2012 之前，变量创建的默认行为是在当前对象的范围内创建它们。这导致新的和有经验的开发人员都失去了很多头发。变量名区分大小写，因此也要注意这一点。

1.  将变量重命名为 RecordSet。将数据类型从 Int32 更改为 Object
2.  将变量 1 重命名为 ParameterValue。将数据类型从 Int32 更改为 String
3.  将变量 2 重命名为 TemplateFile。将数据类型从 Int32 更改为 String。将值设置为输出 Excel 文件的路径。我用 C:\ssisdata\ShredRecordset.xlsx
4.  将变量 4 重命名为 OutputFileName。将数据类型从 Int32 更改为 String。在这里，我们将做一些稍微高级的事情。单击变量并按 F4 以显示“属性”窗口。将 EvaluateAsExpression 的值更改为 True。在 Expression 中，将其设置为`"C:\\ssisdata\\ShredRecordset." + @[User::ParameterValue] + ".xlsx"`（或任何您的文件和路径）。这样做的目的是将变量配置为随着 ParameterValue 的值的变化而变化。这有助于确保我们获得唯一的文件名。欢迎您根据需要更改命名约定。请注意，您需要在`\`任何时候在表达式中转义。

## 连接管理器

我假设您使用的是 OLE DB 连接管理器。我的名字叫 FOO。如果您使用的是 ADO.NET，则概念将是相似的，但与参数等有关的细微差别。

您还需要第二个连接管理器来处理 Excel。如果 SSIS 对数据类型喜怒无常，那么 Excel 会在你沉睡于数据类型时，用叉子在背后捅你一刀。我们将等待，让数据流真正创建这个连接管理器，以确保我们的类型是好的。

# 源查询到结果集

这`SQL Load Recordset`是[Execute SQL Task](http://technet.microsoft.com/en-us/library/ms141003.aspx)的一个实例。在这里，我有一个简单的查询来模仿您的来源。

```
SELECT 'aq' AS parameterValue
UNION ALL SELECT 'dr'
UNION ALL SELECT 'tb' 
```

![执行sql任务常规选项卡](../Images/56edeac31258a974a9ae9ddc4ef57ee9.png)

在 General 选项卡上需要注意的重要一点是，我已将 ResultSet 从 切换`None`到`Full result set`. 这样做会使结果集选项卡从灰显变为可用。

![执行sql任务结果集选项卡](../Images/b1c610b27d6663071fff7b537eb4ad48.png) 您可以观察到我已将变量名称分配给我们在上面创建的变量 (User::RecordSet)，结果名称为`0`. 这很重要，因为默认值`NewResultName`不起作用。

# FELC 粉碎记录集

获取一个[Foreach 循环容器](http://technet.microsoft.com/en-us/library/ms141724.aspx)，我们将使用它来“分解”上一步中生成的结果。

`Foreach ADO Enumerator`将枚举器配置为`User::RecordSet`用作您的 ADO 对象源变量。选择`rows in the first table`作为您的枚举模式

![使用 Foreach ADO 枚举器并使用 User::RecordSet 作为源。 选择第一个表中的行](../Images/9f60c9975f15b6da3fb68019d81dd750.png)

在“变量映射”选项卡上，您需要选择变量`User::ParameterValue`并为其分配索引 0。这将导致记录集对象中的第零个元素被分配给变量 ParameterValue。重要的是您有数据类型协议，因为 SSIS 不会在这里进行隐式转换。

![将 User::ParameterValue 分配为变量映射选项卡上的第 0 个索引](../Images/0f4da19af20ab946c19a06e10557cd85.png)

# FST 复制模板

这是一个[文件系统任务](http://technet.microsoft.com/en-us/library/ms140185.aspx)。我们将复制我们的模板 Excel 文件，以便我们有一个命名良好的输出文件（其中包含参数名称）。将其配置为

*   IsDestinationPathVariable：真
*   目标变量：用户::输出文件名
*   覆盖目标：真
*   操作：复制文件
*   IsSourcePath 变量：真
*   源变量：用户::模板文件

![在此处输入图像描述](../Images/bd2d6c494ebdfe3aae8172f348c44ecf.png)

# DFT 生成输出

这是一个[数据流任务](http://technet.microsoft.com/en-us/library/ms140080.aspx)。我假设您只是将结果直接转储到文件中，因此我们只需要一个[OLE DB 源](http://technet.microsoft.com/en-us/library/ms141696.aspx)和一个[Excel 目标](http://technet.microsoft.com/en-us/library/ms137643.aspx)

![基本数据流](../Images/31e4ff65ca68fce48a083b581b105021.png)

## OLEDB dbo_storedProcedure1

这是使用我们在控制流中分解的参数从源系统中提取数据的地方。我将在这里写下我的查询并使用`?`来表示它有一个参数。

将您的数据访问模式更改为“SQL 命令”，然后在可用的 SQL 命令文本中输入您的查询

```
EXECUTE dbo.storedProcedure1 ? 
```

![OLEDB 源到 Excel 目标](../Images/31263c997c64a04062b29c47a57d6d18.png)

我单击“参数...”按钮并如图所示填写

*   参数：@parameterValue
*   变量：用户::参数值
*   参数方向：输入

![参数配置](../Images/67aeafe3f4d43e1eb5d2a91294288101.png)

将 Excel 目标连接到 OLE DB 源。双击并在 Excel 连接管理器部分中，单击新建... 确定您需要 2003 还是 2007 格式（.xls 与 .xlsx）以及您是否希望文件具有标题行。对于您的文件路径，输入您用于 @User::TemplatePath 变量的相同值，然后单击确定。

![Excel 连接管理器](../Images/95370025c34b22d517df2ba481a9c329.png)

我们现在需要填充 Excel 工作表的名称。单击那个 New... 按钮，它可能会抱怨没有足够的关于映射数据类型的信息。别担心，这是半标准的。然后它将弹出一个表定义，例如

```
CREATE TABLE `Excel Destination` (
    `name` NVARCHAR(35),
    `number` INT,
    `type` NVARCHAR(3),
    `low` INT,
    `high` INT,
    `status` INT
) 
```

“表”名称将是工作表名称，或者准确地说，是工作表中的命名数据集。我制作了我的 Sheet1 并单击“确定”。现在工作表存在，在下拉列表中选择它。我选择了 Sheet1$ 作为目标工作表名称。不确定它是否有所作为。

![Excel 目标编辑器](../Images/03af18c40e5a590cb9bf623779e4a4f9.png)

单击“映射”选项卡，事情应该会自动映射，所以单击“确定”。

# 最后

此时，如果我们运行包，它每次都会覆盖模板文件。秘密是我们需要告诉`Excel Connection Manager`我们刚刚制作它不需要有硬编码的名称。

单击连接管理器选项卡中的 Excel 连接管理器。在“属性”窗口中，找到该`Expressions`部分并单击省略号`...`在这里我们将配置属性`ExcelFilePath`，我们将使用的表达式是 `@[User::OutputFileName]`

如果您的图标等看起来不同，那是可以预料的。这是使用 SSIS 2012 记录的。您的工作流程在 2005 和 2008/2008R2 中将相同，只是皮肤不同。

如果你运行这个包并且它甚至没有启动并且有一个关于 ACE 12 或 Jet 4.0 的错误不可用，那么你在一台 64 位机器上并且需要告诉 BIDS/SSDT 你想在 32 位中运行模式。

确保 Run64BitRuntime 值为`False`。可以通过右键单击项目找到此项目设置，展开配置属性，它将成为调试下的一个选项。

![32位属性设置](../Images/4e0a17d307e6e093d8d74e8a9ca48bc4.png)

# 进一步阅读

可以在[如何使用 SSIS 包自动执行存储过程？](https://stackoverflow.com/questions/13143386/how-to-automate-the-execution-of-a-stored-procedure-with-an-ssis-package/)

# tornado - 如何从龙卷风访问像 client/?sort(+name) 这样的请求的参数

> ID：13961538
> 
> 赞同：0
> 
> 时间：2012-12-19T21:31:04.130
> 
> 标签：tornado

当使用 tornado 收到类似**client/?sort="name"**的请求时，我可以使用 self.request.arguments 访问和读取这些参数，但是当使用这种新类型的请求时**client/?sort(+id)**没有论据。我怎样才能获得这种论点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T02:42:54.143

[`get_argument`](http://www.tornadoweb.org/documentation/web.html#tornado.web.RequestHandler.get_argument)将按名称获取任何查询字符串参数。它需要一个关键字参数作为默认值，如果省略，如果参数不存在，将引发 400。

```
self.get_argument('sort', default='foo') 
```

# mysql - MySql 最好的查询方式？虚拟表？由于需要唯一列而返回重复行

> ID：13961542
> 
> 赞同：1
> 
> 时间：2012-12-19T21:31:15.480
> 
> 标签：mysql, database-design, jointable

我有一个为我正在制作的网站创建的数据库，其中包含员工列表。这将是一个网格状列表，包含每个员工的照片、姓名、电话号码等。

这是我的第一个数据库设计，我为此感到非常自豪……但我是新手，所以我确信它在某些方面效率低下。

我无法找出为网站查询它以制作元素的最佳方式。

1）我应该使用虚拟表吗？或者我应该只使用一个查询并为每个员工循环它？

2) 一些员工将拥有多个司法管辖区。现在我有：

```
select employees.firstName, employees.lastName, employees.phone, employees.position,
    employees.picture, jurisdictions.jurisdiction
from employees
    inner join(jurisdictions cross join departments cross join user_jurisdictions)
    on (employees.deptID = departments.deptID
        AND user_jurisdictions.userID = employees.userID
        AND user_jurisdictions.jurID = jurisdictions.jurID) 
```

哪个会返回：

```
+-----------+----------+--------------+-----------------+---------+--------------+
| firstName | lastName | phone        | position        | picture | jurisdiction |
+-----------+----------+--------------+-----------------+---------+--------------+
| John      | Smith  | 210-226-3232 | Senior Manager   |/pics/jpeg1|South America|
| John      | Smith  | 210-226-3232 | Senior Manager   |/pics/jpeg1|London       |
+-----------+----------+--------------+-----------------+---------+--------------+ 
```

由于员工拥有额外的管辖权，有什么方法可以创建删除重复行的查询？就像是？

```
+-----------+----------+--------------+---------+---------+--------------+------------+
| firstName | lastName | phone        | position| picture | jurisdiction |Jurisdiction|
+-----------+----------+--------------+---------+---------+--------------+------------+
| John      | Smith  | 210-226-3232 | Manager |/pics/jpeg1| South America|London      |
+-----------+----------+--------------+-----------------+---------+-------------------+ 
```

这是我的mysql架构：

```
employees
--------------------
userID (primary key)
firstName
lastName
phone
fax
position
picture
deptID (foreign key references departments(deptID)) 

departments
--------------------
deptID (primary key)
department

jurisdictions
-----------------
jurID (primary key)
jurisdiction

user_jurisdictions
--------------------------
userID(foreign key references employees(userID)) 
jurID(foreign key references jurisdictions(jurID))

triger: 
 after_employees_insert | INSERT | employees | begin
insert into user_jurisdictions(userID) values (new.userID); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T21:35:42.993

您可以按员工对结果进行分组，并使用 MySQL 的[`GROUP_CONCAT()`](http://dev.mysql.com/doc/en/group-by-functions.html#function_group-concat)功能来汇总员工的管辖范围：

```
SELECT   employees.firstName,
         employees.lastName,
         employees.phone,
         employees.position,
         employees.picture,
         GROUP_CONCAT(jurisdictions.jurisdiction)
FROM     employees
    JOIN departments        USING (deptID)
    JOIN user_jurisdictions USING (userID)
    JOIN jurisdictions      USING ( jurID)
GROUP BY employees.userID 
```

但是，这会将管辖区聚合成一个分隔字符串（这使得很难区分多个管辖区和包含分隔符的单个管辖区：人们可以选择一个不太可能在管辖区名称中使用的分隔符，但它仍然会遇到诸如作为字符串长度的限制，并且在我看来，从根本上来说是懒惰的）。

更好的方法可能是将这种聚合留给更高级别的应用程序代码。例如，使用[PDO](http://php.net/manual/en/book.pdo.php)：

```
$dbh = new PDO("mysql:dbname=$dbname", $username, $password);

$qry = $dbh->query('
  SELECT   employees.userID
           employees.firstName,
           employees.lastName,
           employees.phone,
           employees.position,
           employees.picture,
           jurisdictions.jurisdiction
  FROM     employees
      JOIN departments        USING (deptID)
      JOIN user_jurisdictions USING (userID)
      JOIN jurisdictions      USING ( jurID)
  ORDER BY employees.userID
');

$row = $qry->fetch();
while ($row) {
  $current_user = $row['userID'];

  // handle $current_user initialisation
  do {
    // handle user $row
  } while ($row = $qry->fetch() and $row['userID'] == $current_user);
  // handle $current_user termination

} 
```

当然，这样做的缺点是产生了一个更大的结果集，这些结果集必须由 RDBMS 生成并传输到您的更高级别代码/由您的更高级别代码处理。

# javascript - 从路径和模板创建 JSON 对象

> ID：13961544
> 
> 赞同：0
> 
> 时间：2012-12-19T21:31:19.987
> 
> 标签：javascript

我本质上是一个懒惰的编码员，所以想知道在我写之前有一个库可以执行以下操作：

```
var parser = PathParser('/{first}/{last}');
var actual = parser.parse('/fred/flintstone');
assertEquals({"first":"fred","last":"flintstone"}, actual); 
```

第一个字符串指定一个模式，第二个字符串提取相关值并将它们存储在一个对象中，其键对应于模式中的键。

我找到了进行扩展的标准，但没有找到 JSON 对象的生成。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T22:54:45.610

您想从第一个字符串中提取一个键数组并从后者中提取一个值数组，其中值前面是特定模式，后跟特定模式。

没有执行此操作的现有库，但我已经编写了一个实现。[您可以在此处](http://jsbin.com/unomof/1/edit)找到现场演示。

```
//## Extension to escape all regex special characters in a string ##

RegExp.quote = function(str) {
    return (str + '').replace(/([.?*+^$[\]\\(){}|-])/g, "\\$1");
};

//## Parsing ##

var parser = PathParser('/{first}/{last}');
var actual = parser('/fred/flintstone');

//## Output ##

var pre = document.createElement('pre');
pre.innerHTML = JSON.stringify(actual, null, "  ");
document.body.appendChild(pre);    

//## The parser constructor ##

function PathParser(pattern) {
    var keys = [];
    var keyreg = /\{([a-zA-Z0-9]+)\}/g;
    var result;
    while ((result = keyreg.exec(pattern)) !== null) {
        var pre = "^" + RegExp.quote(pattern.substring(0, result.index)).replace(/\\\{[a-zA-Z0-9]+\\\}/g, ".*");
        var post = RegExp.quote(pattern.substring(keyreg.lastIndex)).replace(/\\\{[a-zA-Z0-9]+\\\}/g, ".*") + "$";
        keys.push({
            pre: pre,
            post: post,
            text: result[1]
        });
    }

    function parser(valstring) {
        var keyarr = keys;
        var obj = {};
        for (var i = 0; i < keyarr.length; i++) {
            var valreg = new RegExp(keyarr[i].pre + "(.*)" + keyarr[i].post);
            obj[keyarr[i].text] = valstring.match(valreg)[1];
        }
        return obj;
    }

    return parser;
} 
```

# c# - 如何在活动后检索照片 ID？

> ID：13961545
> 
> 赞同：1
> 
> 时间：2012-12-19T21:31:24.780
> 
> 标签：c#, facebook, facebook-graph-api, facebook-c#-sdk

> **可能重复：**
> [如何检索我刚刚通过 Facebook API 发布的帖子的帖子 ID](https://stackoverflow.com/questions/7813500/how-to-retrieve-post-id-for-a-post-ive-just-made-via-the-facebook-api)

我正在尝试使用 Facebook C# SDK，并希望在我将照片发布到墙上后找到用于在我的应用中显示照片的变量。我知道我需要找到照片的 ID，但我运气不佳。我尝试使用`_lastMessageID`但没有用。这是我正在使用的代码，其中没有必要的变量`postedPictureUrl`：

```
private async void PostToWall_Click(object sender, RoutedEventArgs e)
{
    try
    {
        dynamic parameters = new ExpandoObject();
        parameters.message = txtMessage.Text;

        StorageFile imageFile = await Windows.Storage.StorageFile.GetFileFromApplicationUriAsync(new Uri("ms-appx:///Images/photo.png"));
        IRandomAccessStream fileStream = await imageFile.OpenAsync(FileAccessMode.Read);
        var reader = new Windows.Storage.Streams.DataReader(fileStream.GetInputStreamAt(0));
        await reader.LoadAsync((uint)fileStream.Size);
        byte[] pixels = new byte[fileStream.Size];
        reader.ReadBytes(pixels);
        parameters.picture = new FacebookMediaObject
        {
            ContentType = "image/png",
            FileName = "photo.png",
        }.SetValue(pixels);
        dynamic result = await _fb.PostTaskAsync("me/photos", parameters);
        _lastMessageId = result.id;
        txtMessage.Text = string.Empty;
        btnDeleteLastMessage.IsEnabled = true;
        string postedPictureUrl = string.Format("https://graph.facebook.com/{0}/photos?&access_token={2}", _userId, _fb.AccessToken"); //this is where I need to retrieve the id of the photo...
        myPostedPainting.Source = new BitmapImage(new Uri(postedPictureUrl));
    }
    catch (FacebookApiException ex)
    {
        // handle error message
    }
} 
```

# json - JSON 给出不需要的行索引号 - Active Record - Codeigniter

> ID：13961556
> 
> 赞同：1
> 
> 时间：2012-12-19T21:32:07.857
> 
> 标签：json, codeigniter, activerecord

我不知道为什么当我回显 json_encode 查询结果集时，我会在每个对象之前获得结果行的编号。我只想计算返回的总行数，并让它们在 JSON 字符串的开头只显示一次，然后只返回行。即使用以下代码：

```
 //...active record query
               $result = $this->db->get();

                $data = array();

                $count = 1;

                foreach($result->result() as $row)
                {
                    $data['count'] = $count;
                    $entry = array();
                    $entry['firstname'] = $row->first_name;
                    $entry['lastname'] = $row->last_name;
                    $entry['jobtitle'] = $row->title;
                    $entry['dept'] = $row->dept_name;
                    $entry['deptid'] = $row->dept_no;

                    if($row->emp_no == null)
                    {
                        $entry['ismanager'] = 0;
                    }
                    else
                    {
                        $entry['ismanager'] = 1;
                    }
                    $data[] = $entry;
                    $count++;
                }

                return $data; 
```

然后在控制器中对其进行json_encode，我得到：

```
{"count":35,"0":{"firstname":"Georgi","lastname":"Facello","jobtitle":"Senior Engineer","dept":"Development","deptid":"d005","ismanager":0},"1":{"firstname":"Kirk","lastname":"Facello","jobtitle":"Senior Engineer","dept":"Development","deptid":"d005","ismanager":0},....rest of the query results 
```

我不想要的是`"0"`等`"1"`，在行结果之前。我已经有了返回结果的总数，所以我不需要单独的行号。

如果有人可以帮助我，我将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T21:43:34.613

如果您尝试将数组序列化为 JSON，它将变成这样：

```
[elem1, elem2, elem3, ...] 
```

但是如果那个“数组”有其他字段，那么它将被序列化为一个对象：

```
{"field":value, "0":elem1, "1":elem2, "2":elem3, ...} 
```

由于没有办法`field`使用数组语法进行序列化，`json_encode`也不能简单地丢弃它，所以它使用对象语法。如[文档中所述](http://php.net/manual/en/function.json-encode.php)：

> **笔记：**
> 
> 在对数组进行编码时，如果键不是从 0 开始的连续数字序列，则所有键都被编码为字符串，并为每个键值对显式指定。

一个可能的解决方法是将计数与元素列表分开：

```
$data = array();
$list = array();
$data['list'] = list;

$count = 1;
foreach($result->result() as $row)
{
    $data['count'] = $count;
    $entry = array();
    ...
    $list[] = $entry;
    $count++;
} 
```

这将序列化为：

```
{"count":35,"list":[{"firstname":"Georgi","lastname":"Facello","jobtitle":"Senior Engineer","dept":"Development","deptid":"d005","ismanager":0},{"firstname":"Kirk","lastname":"Facello","jobtitle":"Senior Engineer","dept":"Development","deptid":"d005","ismanager":0},....rest of the query results]} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T21:44:16.283

看起来您可能正在使用它`JSON_FORCE_OBJECT`，`json_encode`这将始终使您的数字索引显示为属性。你应该`json_encode`在你的问题中展示你的步骤。

如果您关闭选项并使用默认编码，您仍需要将数字索引数组嵌套在其自己的属性中，否则数字索引将显示为属性以生成有效的 JSON。因为在将行分配给对象时可能会做这样的事情：

```
$data['records'][] = $entry; 
```

# objective-c - 将数据传递给 parentViewController [iOS]

> ID：13961557
> 
> 赞同：4
> 
> 时间：2012-12-19T21:32:17.017
> 
> 标签：objective-c, ios, uitableview, parent-child, segue

我有这个故事板： ![在此处输入图像描述](../Images/ae3646101940eccc0aa1684cc1c0e64f.png)

**当我在第一个视图控制器（称为newCourseViewController** ）中按下“Insegnante”按钮时，它会显示一个带有教师列表的表格视图。当我按下老师（并`tableView:canEditRowAtIndexPath:`调用该方法）时，我希望将`UITableViewController`按下的对象“传递”到第一个视图控制器。

这是我的第一个视图控制器**newCourseViewController.h的代码**

```
#import <UIKit/UIKit.h>
#import "Teacher.h"

@interface newCourseViewController : UIViewController

@property (nonatomic , strong) Teacher *teacher;

@end 
```

这是我的第一个视图控制器**newCourseViewController.m**的代码（仅重要代码）

```
#import "newCourseViewController.h"
#import "Courses.h"
#import "Teacher.h"
#import "addTeacherToCourseViewController.h"

@interface newCourseViewController ()
@property (weak, nonatomic) IBOutlet UITextField *textField;
@end

@implementation newCourseViewController

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view.
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

-(void)setTeacher:(Teacher *)teacher
{
    self.teacher = teacher;
    NSLog(@"Maestro settato!");
}

-(void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if ([segue.identifier isEqualToString:@"addTeacherToCourse"]) {
        [segue.destinationViewController setPreviousViewController:self];
    }
} 
```

现在第二个视图控制器的代码**addTeacherToCourseViewController -h**

```
@interface addTeacherToCourseViewController : UITableViewController

@property (nonatomic , weak) id previousViewController;

@end 
```

和**addTeacherToCourseViewController.m**（仅重要方法）

```
-(void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    Teacher *teacher = [self.teachers getTeacherInPosition:indexPath.row];
    [self.previousViewController setTeacher:teacher];
    [self.navigationController popViewControllerAnimated:YES];

} 
```

在`prepareForSegue`方法的第一个视图控制器中，我将自己设置为`previousViewController`第二个视图中的。然后我“通过”选择的老师，然后解雇第二个视图控制器。当应用程序执行`[self.navigationController popViewControllerAnimated:YES];`Xcode 崩溃和模拟器崩溃。我不知道是什么问题。你能帮助我吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-19T23:38:37.720

要将值发送到父控制器，您必须使用协议。我将提供您应该采取的正确步骤，以使您所需的功能正常工作。

1\. 为您的 AddTeacherToCourseController 创建一个协议。在您的 AddTeacherToCourseController.h 中，在导入下方添加以下内容：

```
@protocol AddTeacherToCourseControllerProtocol <NSObject>
    - (void)yourDelegateMethod:(Teacher *)insegnante;
@end 
```

在接口标签下面添加：

```
@property (strong, nonatomic) id <AddTeacherToCourseControllerProtocol> delegate; 
```

2\. 在 AddTeacherToCourseController.m 中：

```
-(void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    // I would use the existing array you are using to display the teachers in order to select the correct one you want to send back like this:
    // Teacher *teacher = [self.teachers getTeacherInPosition:indexPath.row];
    [self.delegate yourDelegateMethod:[yourTeacherArray objectAtIndex:indexPath.row]];
} 
```

[此方法将通过协议调用您的委托方法，并将您选择的教授传递给父控制器]

3\. 在您的父控制器中，您的 newCourseViewController.h 就在界面行之后添加：

```
<AddTeacherToCourseControllerProtocol> 
```

4\. 如果您没有Insegnante按钮动作，请在界面生成器中创建一个[拖动和命名]。然后将以下内容添加到此操作中：

```
// assuming your storyboard is named MainStoryboard. here you create your segue programmatically:
UIStoryboard *storyBoard = [UIStoryboard storyboardWithName:@"MainStoryboard" bundle:nil];
addTeacherToCourseViewController *addTeacherController = (addTeacherToCourseViewController *)[storyBoard instantiateViewControllerWithIdentifier:@"addTeacherToCourseViewController"];
addTeacherController.delegate = self;
[self.navigationController pushViewController:addTeacherController animated:YES]; 
```

5\. 在界面生成器中：

*   从 Insegnante 按钮中删除你的 segue。
*   将“addTeacherToCourseViewController”的 Storyboard Id 编辑为“addTeacherToCourseViewController”

6\. 在 newCourseViewController.h 中写下你的委托方法：

```
- (void)yourDelegateMethod:(Teacher *)insegnante{
    // Do whatever you want with your Insegnante
    // and be sure to pop the second controller from the view stack:
    [self.navigationController popViewControllerAnimated:YES];
} 
```

如果您有任何问题，以及我的回答是否对任何人有帮助，请告诉我。

# sublimetext2 - Sublime 的新手无法找出其中包含 javascript 的片段

> ID：13961566
> 
> 赞同：1
> 
> 时间：2012-12-19T21:32:42.883
> 
> 标签：sublimetext2, sublimetext

我刚刚开始使用 sublimeText2，因为通过 VPN 处理大型项目时 eclipse 真的很慢。我正在尝试带来我的一些片段。大多数工作正常，但以下是我使用的 ajax 调用，但不能作为片段工作。我猜有些字符需要转义或其他东西，但我不确定哪些字符

```
<snippet>
    <content><![CDATA[

    $.ajax({
        type: 'get',
        url: '.cfc',
        data: {method:''
            , var: var
            , var2:var
                },
        dataType: 'json',
        async: false,
        success: function(result){
            var result = jQuery.trim(result);
            console.log(result);
            } 
        }
    });     

]]></content>
    <tabTrigger>ajax</tabTrigger>
</snippet> 
```

谁能看到我哪里出错了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T22:07:12.950

必须用 \$ 转义 $ 并且它有效

```
<snippet>
    <content><![CDATA[

    \$.ajax({
        type: 'get',
        url: '.cfc',
        data: {method:''
            , var: var
            , var2:var
                },
        dataType: 'json',
        async: false,
        success: function(result){
            var result = jQuery.trim(result);
            console.log(result);
            } 
        }
    });     

]]></content>
    <!-- Optional: Set a tabTrigger to define how to trigger the snippet -->
    <tabTrigger>ajax</tabTrigger>
    <!-- Optional: Set a scope to limit where the snippet will trigger -->
    <!-- <scope>source.python</scope> -->
</snippet> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T21:38:54.060

也许`CDATA`标签外壳会导致这个问题？只是猜测...

# javascript - 比较 javascript 中的两个数组并创建包含缺失元素和新元素的新数组

> ID：13961572
> 
> 赞同：2
> 
> 时间：2012-12-19T21:32:58.630
> 
> 标签：javascript, arrays, comparison

比较两个 javascript 数组并创建两个包含缺失元素和新元素的新数组的最有效方法是什么？数组元素将始终是字符串或数字，并且不能 100% 确定它们会以任何方式排序。

```
var old_array = ['11', '13', '14', '18', '22', '23', '25'];
var new_array = ['11', '13', '15', '16', '17', '23', '25', '31'];
var missing_elements = [];
var new_elements = [];

/*
* some magic goes here
* which compares
* new_array with old_array
*/

console.log(missing_elements); // would produce ['14', '18', '22']
console.log(new_elements); // would produce ['15', '16', '17', '31'] 
```

非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T21:55:03.760

Drew Noakes 解决方案的代码：

```
var old_array = ['11', '13', '14', '18', '22', '23', '25'];
var new_array = ['11', '13', '15', '16', '17', '23', '25', '31'];
var missing_elements = _.difference(old_array, new_array);
var new_elements = _.difference(new_array, old_array);

console.log(missing_elements); // would produce ['14', '18', '22']
console.log(new_elements); // would produce ['15', '16', '17', '31'] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T21:40:53.587

我会使用 Underscore.js 的[交集](http://underscorejs.org/#intersection)和[差分](http://underscorejs.org/#difference)函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T21:44:50.447

排序将是最有效的（假设您没有任何其他先决条件来进行优化）：

```
var old_array_sorted = old_array.slice().sort(); // slicing for not mutating
var new_array_sorted = new_array.slice().sort(); // the original array

for (var o=0, n=0; o<old_array_sorted.length && n<new_array_sorted.length; ) {
    if (old_array_sorted[o] < new_array_sorted[n])
        missing_elements.push ( old_array_sorted[o++] );
    else if (old_array_sorted[o] > new_array_sorted[n])
        new_elements.push( new_array_sorted[n++] );
    else
        n++, o++;
}
[].push.apply(missing_elements, old_array_sorted.slice(o));
[].push.apply(new_elements, new_array_sorted.slice(n)); 
```

# amazon-ec2 - Hive 作业被终止，查询 execute() 仍然挂起

> ID：13961573
> 
> 赞同：0
> 
> 时间：2012-12-19T21:32:59.083
> 
> 标签：amazon-ec2, hive, amazon-emr, emr

我正在使用 hive-jdbc-0.7.1-cdh3u5.jar。我在 EMR 上运行了一些内存密集型查询，这些查询偶尔会失败。当我查看作业跟踪器时，我看到查询已被终止，并且我看到以下错误：

java.io.IOException：任务进程退出，非零状态为 137

但是，Hive JDBC 驱动程序 execute() 调用没有检测到这一点，而是挂起。没有发现异常。有任何想法吗？谢谢：

```
    ST stQuery = MY_QUERY;
    尝试 {
        语句 stmt = conn.createStatement();
        stmt.execute(stQuery.render()); // 在不知道作业已被终止的情况下挂在这里。不会引发异常。
    }
    捕获（SQLException sql）{
        sqle.printStackTrace();
        log.error("查询失败");
        返回;
    }

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T10:05:09.393

这可能是由于hadoop会在10分钟（600秒）后如果没有得到响应就会杀死任务，通过设置参数`mapred.task.timeout=0`我们可以避免杀死运行超过10分钟的任务。

同样在这些情况下，人们可以编写 mapper/reducer 以定期报告进度（比每 10 分钟更频繁）。这可以通过多种方式实现：

*   调用`setStatus()`Reporter 设置任务进度的人类可读描述
*   调用`incrCounter()`Reporter 以增加用户计数器
*   调用`progress()`Reporter 告诉 Hadoop 你的任务仍然存在（并且正在取得进展）

# c - for 循环不运行

> ID：13961575
> 
> 赞同：3
> 
> 时间：2012-12-19T21:33:11.267
> 
> 标签：c, for-loop, nested-loops

我想出了一个我认为是一个尴尬（尽管是标准）问题的混乱解决方案：对于给定的用户输入，反转单词的字母

例如：

> 这是一个标准测试

变成

> sihT si a dradnats tset

并不是

> tset dradnats a si sihT

问题的核心是这段代码

```
 while (!iscntrl(user_input[x])) // quit when new line is read
      {
        restart:
        x++;
        puts("first level test");
        if (user_input[x]==' ')
            {
            puts("second level test");
            for (i=x; user_input[i]!=' '; --i)
                {               
                reverse_words[k]=user_input[i];
                k++;
                puts("third level test");
                goto restart;
                }
            }
        } 
```

（是的，我知道，那里有一个 goto ：/）

但循环的第三级从未被触及。

大概有一些完全错误`(i=x; user_input[i]!=' '; --i)`的 for 循环参数？

`x`, `i`, 和`k`在第一个循环开始之前都被初始化为整数 == 0。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-19T21:36:18.813

好吧，你的情况在这里矛盾：

```
 if (user_input[x]==' ')
            {
            puts("second level test");
            for (i=x; user_input[i]!=' '; --i) 
```

您只输入 if `user_input[x]`is space，但只要它不等于空格，您就会循环。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T21:37:16.117

问题是这部分：

```
 if (user_input[x]==' ')
            {
            puts("second level test");
            for (i=x; user_input[i]!=' '; --i)
                { 
```

在第一行中，您已经确定了`user_input[x]==' '`.

几行之后，您设置了一个将运行 while 的循环`user_input[i]!=' '`。

但是，您已经设置`i = x`了……因此，在第一遍中，您要求`user_input[x]!=' '`……您已经确定它是错误的。

因此，内部循环永远不会运行。

# javascript - 在 IE 中禁用 ActiveX 特定的 ocx（或特定的 ActiveX 控件）

> ID：13961578
> 
> 赞同：0
> 
> 时间：2012-12-19T21:33:16.477
> 
> 标签：javascript, internet-explorer, activex, activexobject

在 IE 用户可以禁用 ActiveX 脚本。但这会禁用浏览器上的所有 ActiveX 控件。

是否可以只使一个 *.ocx 文件不能在 IE 中工作？

-达特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T00:18:36.163

每个 ActiveX 控件使用 Killbit。但这使得控件无法加载到 MSWord、MSExcel 等具有 KillBit 感知能力的应用程序中。

# c# - 在 Visual C++ 编译器上编译 C++ 的命令行调用，包括汇编程序？

> ID：13961582
> 
> 赞同：0
> 
> 时间：2012-12-19T21:33:29.613
> 
> 标签：c#, c++, visual-studio-2010

有人可以告诉我，如果我要从 C# 编译 C++ 文件，执行字符串是什么（假设我使用 x86 cl.exe 进行编译）。我想将汇编程序与原始源代码一起输出（类似于 Visual Studio 中的选项）？

像（只是例子）：

> “ cl.exe my_cpp_file.cpp -assembler -source_code”

编译C会有很大不同吗？

编辑这是正确的吗？我需要使用“FAs”

CL FAs my_cpp_file.cpp

我不太确定该怎么办？... [lib...] [@command-file] [/link link-opt...]

(http://msdn.microsoft.com/en-us/library/610ecb4h(v=vs.100).aspx)

我也想做全优化编译

EDIT2 我不想执行文件，我想做的就是产生汇编输出（带有源代码）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T21:38:50.373

该`/FAs`选项似乎是您正在寻找的。查看[文档](http://msdn.microsoft.com/en-us/library/367y26c6%28v=vs.100%29.aspx)。

# jquery - 圆形边框在 chrome 中不起作用

> ID：13961588
> 
> 赞同：2
> 
> 时间：2012-12-19T21:34:18.047
> 
> 标签：jquery, google-chrome, slideshow, css

我正在使用 jquery 幻灯片，效果很好。唯一的问题是，即使我专门使用了 Chrome 的 CSS 圆形边框样式，它也不会在 Google Chrome 中的图像“div”上显示圆形边框。因为我知道几乎所有浏览器都使用自己的代码来设置圆形边框，所以我已经设置了所有浏览器的可用设置。但是，它仍然不能像应有的那样在 Chrome 上运行。

而不是用 HTML 和 CSS 填充这个小页面，我宁愿给你幻灯片的[url](http://www.5eren.dk/scripts/jqueryslideshow/test.php)，如果你愿意，你可以阅读源代码，CSS 链接在`head`标签中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T21:38:29.580

**在您的CSS**中添加此代码

 **```
div.slides_control a img {border-radius: 12px;} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T21:39:43.153

您的示例确实有圆角，可以在过渡期间看到它们。但是包含`<a>`的 's 比图像更宽......使`<a>`'s 与图像的大小相同，或者更好更简单，将 's 应用于`border-radius`' `<img>`s。

此外，Firefox 和 Chrome 已删除对其供应商前缀`-moz-border-radius`和`-webkit-border-radius`. 只需使用[`border-radius`](https://developer.mozilla.org/en-US/docs/CSS/border-radius#Browser_compatibility).

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-19T21:40:05.510

将**CSS 分配给您的图像**，而不是 `.slides_container`

将此添加到您的**CSS**

```
 img
    {
       -moz-border-radius: 10px;
       -webkit-border-radius: 10px;
       border-radius: 10px; 
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-19T21:40:55.887

这应该有效：

```
#slides_control img {
   border-radius: 3px;
} 
```

您不需要任何浏览器前缀：[http ://caniuse.com/#feat=border-radius](http://caniuse.com/#feat=border-radius)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-20T20:30:20.427

非常感谢大家试图帮助我。

似乎有一些 Google Chrome 错误可以防止溢出被隐藏，因为如果您只想设置 div 的样式，border 命令可以正常工作。

解决方案是将其添加到您的样式中：

```
#slider{
    border-radius: 10px;
    -webkit-mask-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAA5JREFUeNpiYGBgAAgwAAAEAAGbA+oJAAAAAElFTkSuQmCC);
} 
```

希望现在像我这样的其他可怜人不会整夜寻找可以挽救一天的代码。**

# ios - 将 NSArray 转换为 JSON 对象数组

> ID：13961590
> 
> 赞同：2
> 
> 时间：2012-12-19T21:34:26.320
> 
> 标签：ios, json, nsdictionary, fmdb

我想从 resultsArray 创建一个 JSON 对象数组。

```
NSMutableArray *resultsArray = [NSMutableArray array];
FMResultSet *resultsSet = [database executeQuery:queryString];
while ([resultsSet next]) {
    [resultsArray addObject:[resultsSet resultDictionary]];
} 
```

为澄清起见，我使用 FMDB 来查询数据库。然后我将结果对象存储在 resultsArray 中。从这里我想将该结果数组转换为 JSON 对象数组。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-19T22:23:40.313

您可以使用 NSJSONSerialization 类使用类方法从字典创建 JSON 文件

```
NSData * JSONData = [NSJSONSerialization dataWithJSONObject:resultsArray
                                                    options:kNilOptions
                                                      error:&error]; 
```

有关更多信息，请查看[苹果文档](http://developer.apple.com/library/ios/#documentation/Foundation/Reference/NSJSONSerialization_Class/Reference/Reference.html)

# sql - 删除表中的一系列记录

> ID：13961591
> 
> 赞同：3
> 
> 时间：2012-12-19T21:34:28.643
> 
> 标签：sql, oracle11g

我在一个表中有大约 1176 条真实记录，但我需要删除表中从第 1177 行到第 7428 行的记录。如何编写一个 DELETE 语句，只留下开始的 1176 条记录？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T21:42:54.337

假设您的表使用自动递增的主键（假设`somePrimaryKey`）：

```
DELETE myTable
WHERE ROWNUM > 1176
ORDER BY somePrimaryKey; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T21:41:39.130

只需删除 ID 高于您要保留的最高 ID 的所有内容。

```
delete from `tablename` where `row_id` > 1176 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T21:42:08.423

按身份证做

```
DELETE FROM table_y WHERE id>1176 
```

备份你的表

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-19T21:58:24.123

试试这个

```
DELETE FROM table_Name WHERE id >= 1176 && id <=7428 ; 
```

# sql - 每行多个数据行列

> ID：13961595
> 
> 赞同：1
> 
> 时间：2012-12-19T21:34:35.040
> 
> 标签：sql, birt

我正在尝试显示数据集中的单列，但分布在单行中。例如：

```
[Row1] [Row2] [Row3]
[Row4] [Row5] [Row6] 
```

代替：

```
[Row1]
[Row2]
[Row3] etc. 
```

数据集需要基于外部表中的列与另一个表连接，这意味着，AFAIK，交叉表是不可能的，因为您不能使用数据集参数。单个数据集中的行数没有限制，但我希望每行有 3 行列。

我可以修改数据集查询，但是我只能在这些查询中使用普通的旧 SQL，除了创建临时表或在服务器端创建任何“新”的东西——然而，一个仅 BIRT 的解决方案会更可取。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T22:06:45.477

如果您可以将查询更改为输出

```
1 1 [Row1]
1 2 [Row2]
1 3 [Row3]
2 1 [Row4]
2 2 [Row5]
2 3 [Row6] 
```

到一个临时表中`tmp`，然后你可以使用类似的东西来查询它

```
select col1, col3 from tmp into tmp1 where col2 = 1;
select col1, col3 from tmp into tmp2 where col2 = 2;
select col1, col3 from tmp into tmp3 where col2 = 3;
select tmp1.col3, tmp2.col3, tmp3.col3 from tmp1, tmp2, tmp3 where tmp1.col1 = tmp2.col1 and tmp1.col1 = tmp3.col1; 
```

您可以生成`col1`和`col2`使用`rownum`，但它是非标准的，它需要对原始查询的输出进行正确排序。

**编辑：**

如果您不能使用临时表，我假设您可以使用子查询：

```
select tmp1.col3, tmp2.col3, tmp3.col3 from
  (select col1, col3 from (ORIGINAL_QUERY) where col2 = 1) as tmp1,
  (select col1, col3 from (ORIGINAL_QUERY) where col2 = 2) as tmp2,
  (select col1, col3 from (ORIGINAL_QUERY) where col2 = 3) as tmp3
where tmp1.col1 = tmp2.col1 and tmp1.col1 = tmp3.col1; 
```

并希望优化器很聪明。

# magento - Magento - 加载模型时限制选定字段而不收集

> ID：13961597
> 
> 赞同：0
> 
> 时间：2012-12-19T21:34:36.490
> 
> 标签：magento, model

我知道在处理集合时如何限制字段，但我想知道是否可以在使用 getModel()->load($id) 时限制所选字段。

我的思考过程是如果我知道我使用的 ID：

```
Mage::getModel('model')->load($id) 
```

相对于：

`Mage::getModel('model')->getCollection()->addFieldToFilter('id', $id)->getFirstItem();`

问题是 load($id) 返回所有内容。我知道我可以在集合上使用 addFieldToSelect。使用 load() 时是否有等价物？当我用谷歌搜索时，我得到了收集方法。

谢谢，GG

编辑：我只想补充一点，如果收集方式是它的完成方式，那很好。我只是想确保它不能使用 load() 来完成。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T22:04:24.070

您可以尝试加载仅包含一项的集合（就像您现在所做的那样），并选择您想要使用的属性：

```
addAttributeToSelect('you_attribute_code_here') 
```

这将返回一个集合（尽管包含一个项目），其中仅包含您希望返回的属性。例子：

```
$productIds = array(166);
$collection = Mage::getModel('catalog/product')->getCollection()
    ->addAttributeToSelect('description')
    ->addFieldToFilter('entity_id', array('in' => $productIds));

$product = $collection->getFirstItem(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T22:22:28.880

不，除了完全重写模型代码之外，没有其他方法可以使用该集合，这可能不是您想要做的。模型加载调用只能用于加载完整条目 - 您可以指定用于加载的属性。例如：

```
Mage::getModel('catalog/product')->load($sku,'sku') 
```

将按其 sku 加载产品。

事实上，模型加载本身只是通过执行以下操作来遵循它的资源：

```
$this->_getResource()->load($this, $id, $field); 
```

但是资源加载方法也不提供过滤特定属性的能力，因此您将始终加载完整包或使用集合。

# java - 带有嵌入链接的 JSF 本地化段落

> ID：13961598
> 
> 赞同：4
> 
> 时间：2012-12-19T21:34:38.453
> 
> 标签：java, jsf, jsf-1.2

使用 JSF 1.2 在本地化段落中间某处嵌入输出链接的首选方法是什么？

考虑具有以下内容的消息资源：

```
my.paragraph=If you have questions, visit our {0} for further information
my.paragraph.token.0=help 
```

如果你有一个像这样的输出链接：

```
<f:outputLink value="javascript:void(0)" onclick="pophelp('#facesContext.externalContext.requestContextPath}/help/index.html');">#{messages['my.paragraph.token.0']}</ice:outputLink> 
```

如果它更容易，我们也使用 SEAM/facelets 和 icefaces。

谢谢...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T10:52:51.967

您需要一种特殊形式的布局面板组件。假设您现有的组件库中没有一个，您可以在博客上学习如何编写一个：[JSF：用于本地化组件布局的自定义格式面板控件](http://illegalargumentexception.blogspot.co.uk/2009/08/jsf-custom-format-panel-control-for.html)

# python - 如何在 HTML 中打开指向文件的 href 链接，但不在 Flask 应用程序中下载文件

> ID：13961599
> 
> 赞同：0
> 
> 时间：2012-12-19T21:34:38.890
> 
> 标签：python, html, flask

我正在使用 Flask 和 AutoIndex。当我转到我用 AutoIndex 指定的目录的 URL 时，我可以很好地看到目录中的文件。但是当我点击一个文件查看它时，浏览器会自动下载该文件。我只是希望它在单击时显示为纯文本文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T13:37:54.890

您需要更改响应以将 content-type 标头设置为“text/plain”，并且可能还删除或重写[content-disposition](https://www.rfc-editor.org/rfc/rfc6266)标头。

您可能需要创建一个新视图来提供此类文件，并更改或配置 AutoIndex 以将链接指向您的视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T06:23:10.360

您可以使用[send_from_directory](http://flask.pocoo.org/docs/api/#flask.send_from_directory)，例如：

```
# -*- coding: utf-8 -*-

from flask import Flask, send_from_directory

app = Flask(__name__)

@app.route('/open')
def open():
    """Open in browser"""
    return send_from_directory('/tmp/', 'hello.txt')

@app.route('/download')
def download():
    """Download"""
    return send_from_directory('/tmp/', 'hello.txt', as_attachment=True)

if __name__ == '__main__':
    app.run(debug=True) 
```

# php - 在 href 链接中添加 php 变量

> ID：13961606
> 
> 赞同：-4
> 
> 时间：2012-12-19T21:35:06.870
> 
> 标签：php, html

所以我需要创建一个变量子域以添加到域的末尾，但它没有识别变量。在本例中，它只会转到 google.com。有人知道这样做的正确方法吗？

```
<html>

  <?php $subdom="news";?>

     <a href="http://www.google.com/"<?php echo $subdom;?>>google</a>
</html> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-19T21:37:17.553

您需要在右引号之前添加域以将其附加到 href 变量中，而不是仅仅将其添加到 a 标记中。

```
<a href="http://www.google.com/<?php echo $subdom;?>">google</a> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T21:37:38.550

你需要

```
<html>

  <?php $path="news";?>

     <a href="http://www.google.com/<?php echo $path;?>">google</a>
</html> 
```

而且您的变量名可能应该是，`$path`而不是`$subdom`因为它实际上包含路径而不是子域

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T21:38:26.083

你在错误的地方有回声。应该在引号内。

```
<a href="http://www.google.com/<?php echo $subdom; ?>">google</a> 
```

如果您的服务器启用了短开放标签，您可以这样做：

```
<a href="http://www.google.com/<?=$subdom?>">google</a> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-19T21:48:49.947

尝试类似的东西

```
<a href="http://www.google.com/?subdom=<?php echo "$subdom"; ?>">google</a> 
```

# linux - 如何获取文件夹的大小，包括稀疏文件的表观大小？（du太慢了）

> ID：13961607
> 
> 赞同：4
> 
> 时间：2012-12-19T21:35:10.507
> 
> 标签：linux, kvm, du

我有一个包含很多 KVM qcow2 文件的文件夹，它们都是稀疏文件。现在我需要获取文件夹的总大小，qcow2 文件大小应该算作表观大小（不是实际大小）。

例如：

图像：c9f38caf104b4d338cc1bbdd640dca89.qcow2 文件格式：qcow2 虚拟大小：100G（107374182400 字节）磁盘大小：3.3M cluster_size：65536

图像应被视为 100G 而不是 3.3M

最初我使用 statvfs() 但它只能返回文件夹的实际大小。然后我切换到“du --apparent-size”，但考虑到我有 10000 多个文件，它太慢了，而且计算需要将近 5 分钟。

任何人都知道一种快速的方法可以获取计算 qcow2 虚拟大小的文件夹大小吗？谢谢你

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T19:59:00.580

`stat()`如果不ing 目录中的每个文件，就无法找出这些信息。如果您在一个目录中有这么多文件，这会很慢。`stat()`需要检索每个文件的 inode。

由于缓存，添加更多内存可能会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T14:59:58.827

你可以使用这样的东西：

`find images/ -name "*.qcow2" -exec qemu-img info {} \; | grep virtual | cut -d"(" -f2 | awk '{ SUM += $1} END { print SUM }'`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-03-19T14:42:06.700

现代 Unix*ish 操作系统提供了一种一次性检索目录所有条目统计信息的方法。这也需要查看所有 inode，但可能可以在文件系统驱动程序本身中进行优化，因此可能更快。

显然你不是在寻找一种方法来使用来自 C 的系统调用来做到这一点，所以我想一个可行的方法可能是使用 Python。`scandir()`在那里，您可以使用模块中的功能访问此功能`os`。

# javascript - jwplayer 6 设置不再支持事件回调。如果我无法在设置中指定 onReady 回调，如何判断播放器何时准备就绪？

> ID：13961608
> 
> 赞同：6
> 
> 时间：2012-12-19T21:35:12.187
> 
> 标签：javascript, dom-events, jwplayer

我正在尝试从 jw5 迁移到 jw6。在 jw5 中，我在播放器设置中包含了事件回调。例如：

```
var myplayer = jwplayer('container').setup({
  flashplayer:  /my/player.swf',
  height: '100%',
  width: '100%', 
  events: {
    'onReady': function(event) {
       alert ("on ready");
    },
    'onPlay': function(event) {
       alert ("on play");
    },        
  }
}); 
```

根据 jw5-to-jw6 迁移[文档](http://www.longtailvideo.com/support/jw-player/28834/migrating-from-jw5-to-jw6)，似乎我不能再在播放器设置中包含事件回调：

> 已移除：事件配置块 这种添加事件侦听器的方式与在设置之外添加侦听器完全多余，无论是在功能方面还是在所需代码量方面。

如果我理解正确，我应该以这种方式指定事件回调：

```
myplayer.onReady( function(event){
  alert('on ready');
});
myplayer.onPlay( function(event){
  alert('on play');
}); 
```

我的问题：

在我看来，我需要等待 myplayer 对象准备好，然后才能定义这些 myplayer 事件回调。真的？如果我无法在设置中指定 onReady 事件回调，我如何知道 myplayer 何时准备就绪？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-19T21:47:26.527

在 JWPlayer6 中，您可以像添加`onReady`其他事件处理程序一样添加事件处理程序。这对我有用：

```
var playerInstance = jwplayer("myElement").setup({
    file: "test.mp4"
});

playerInstance.onReady(function() {
    console.log('ready');

    playerInstance.onPlay(function() {
        console.log('playing');
    });

    playerInstance.play();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T21:45:48.010

第一个问题是，您在最后一个代码块中有错字：应该是`myplayer.onReady()`;-)

此外，事件处理程序一旦执行就会连接到相应的对象。

所以我认为你应该简单地将你的 jwplayer 设置和`onReady`&`onPlay`事件放入`$(document).ready()`.

我认为这应该按预期工作。

# macos - 找不到 javadoc 命令 - maven

> ID：13961615
> 
> 赞同：50
> 
> 时间：2012-12-19T21:35:49.657
> 
> 标签：macos, maven, javadoc

我在我的项目目录中运行了这个命令来构建和打包它：

```
mvn clean javadoc:jar package 
```

我的`JAVA_HOME`变量设置正确。显然：

```
$ which java
/usr/bin/java
$ sudo ls -l /usr/bin/java
lrwxr-xr-x  1 root  wheel  74 Dec 18 23:42 /usr/bin/java -> /System/Library/Frameworks/JavaVM.framework/Versions/Current/Commands/java

$ which javadoc
/usr/bin/javadoc 
```

有谁知道为什么 mvn 仍然抱怨？

```
Failed to execute goal org.apache.maven.plugins:maven-javadoc-plugin:2.8:jar (default-cli) on project foo_bar: MavenReportException: Error while creating archive: Unable to find javadoc command: The environment variable JAVA_HOME is not correctly set. -> [Help 1] 
```

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2012-12-19T21:38:30.733

正确`which java`的证据还不够，因为无论如何`/usr/bin/`都可能存在。`PATH`查看

```
$ echo $JAVA_HOME 
```

为证据。或运行

```
$ JAVA_HOME=/path/to/your/java/home mvn clean javadoc:jar package 
```

* * *

在 OS X 上，您可以设置您的`JAVA_HOME`via：

```
$ export JAVA_HOME=$(/usr/libexec/java_home) 
```

在我的机器上指向

```
/System/Library/Java/JavaVirtualMachines/1.6.0.jdk/Contents/Home 
```

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2019-01-23T09:05:38.253

你可以让它使用 java.home 系统属性而不是 JAVA_HOME 环境变量：

```
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-javadoc-plugin</artifactId>
    <version>3.0.1</version>
    <configuration>
        <javadocExecutable>${java.home}/bin/javadoc</javadocExecutable>
    </configuration>
</plugin> 
```

想法来源：[https ://medium.com/@kankvish/fixing-issue-the-environment-variable-java-home-is-not-correctly-set-b5f0b66a84d0](https://medium.com/@kankvish/fixing-issue-the-environment-variable-java-home-is-not-correctly-set-b5f0b66a84d0)

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2016-04-18T05:09:13.413

您可以在 Eclipse 中将 JAVA_HOME 添加为环境变量。

转到您的 Maven 构建-> 添加以下内容。

点击新建->

名称：JAVA_HOME

价值：您的路径。

[![在此处输入图像描述](../Images/7c8fc39c83a8513c981ea7f021bd06fc.png)](https://i.stack.imgur.com/4NhHr.png)

这对我有用！

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2020-05-09T23:06:49.710

虽然很多答案都在谈论 OS X，但对于 Debian 或类似 Debian 的系统（例如 Ubuntu），我决定滥用“替代”系统：

```
export JAVA_HOME=$(update-alternatives --query javadoc | grep Value: | head -n1 | sed 's/Value: //' | sed 's@bin/javadoc$@@') 
```

用 更干净地重写它`awk`，或者使用更正确的方式来访问“替代”数据库中的值，留给读者作为练习。

或者，鉴于使用“替代”系统的目的是维护符号链接，例如`/usr/bin/javadoc`在这种情况下，我们可以只查询符号链接指向的路径：

```
export JAVA_HOME=$(realpath /usr/bin/javadoc | sed 's@bin/javadoc$@@') 
```

虽然这不是唯一可能的“Java 主目录”（您可能安装了许多 JDK），但鉴于我只关心`mvn`向前推进构建，并且错误涉及 Javadoc，我选择将此目录称为包含`javadoc`二进制文件的目录.

* * *

除了 JRE，别忘了安装 JDK。例如，我需要的 JDK 是`openjdk-11-jdk`为了补充`openjdk-11-jre`我之前安装的 JRE。

* * *

在上面之后，`JAVA_HOME`envvar 在我的系统上有这个值：`/usr/lib/jvm/java-11-openjdk-amd64/`

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2015-12-29T05:22:21.067

花了 2-3 个小时后，我觉得通过命令行打开 Eclipse 看起来是最简单的解决方案。按照以下步骤，

`cd <Folder_where_Eclipse.app> open Eclipse.app`

现在你的 Eclipse 可以找到终端环境变量。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2020-07-23T16:50:44.870

有 2 个选项可以解决此问题。以下是步骤：

1.  确保将 JAVA_HOME 配置为环境变量。

2.  **选项 1：**将**javadocExecutable**添加到属性中。

    ```
    <properties>
        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
        <project.reporting.outputEncoding>${project.build.sourceEncoding
        </project.reporting.outputEncoding>
        <java.version>11</java.version>
        <javadocExecutable>${java.home}/bin/javadoc</javadocExecutable>
    </properties> 
    ```

3.  **选项 2：**将**javadocExecutable**添加到构建部分，如下所示。

    ```
    <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-javadoc-plugin</artifactId>
        <version>${maven-javadoc-plugin.version}</version>
        <executions>
            <execution>
                <id>attach-javadocs</id>
                <goals>
                    <goal>jar</goal>
                </goals>
                <configuration>
                    <additionalparam>-Xdoclint:none</additionalparam>
                </configuration>
            </execution>
        </executions>
        <configuration>
            <javadocExecutable>${java.home}/bin/javadoc</javadocExecutable>
            <excludePackageNames>com.vu.poc.test.objects</excludePackageNames>
            <overview />
        </configuration>
    </plugin> 
    ```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-08-11T12:39:58.977

将 maven-javadoc-plugin 插件升级到最新版本（3.3.0 或更高版本）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-01-24T15:10:56.350

他们通过将“export JAVA_HOME”添加到“bin/mvn”shell 脚本中为 maven 3.1 中的 OSX 修复了此问题，从而无需自己在外部设置 JAVA_HOME 来查找 javadoc。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-11-08T18:26:17.787

一旦我切换到使用 sdkman 并删除了 Ubuntu 的 java 包，我就开始面临这个问题。其他一切正常，但使用 IntelliJ IDEA 捆绑的 maven 时 javadoc 插件失败。幸运的是，我们可以在每个项目级别设置环境变量

**构建、执行、部署 > 构建工具 > Maven > Runner**

在*环境变量：*文本框中，添加

```
JAVA_HOME=/home/user/.sdkman/candidates/java/11.0.12-open/ 
```

[![显示 IntelliJ IDEA Maven Runner 设置的屏幕截图](../Images/4f2825ba97062d4afa50b4882ed6eb1e.png)](https://i.stack.imgur.com/2nNLO.png)

# r - ggplot：误差线

> ID：13961620
> 
> 赞同：0
> 
> 时间：2012-12-19T21:36:08.220
> 
> 标签：r, ggplot2

我想绘制 y1、y2 的两组不同值相对于 x 的误差线。换句话说，我有两个数据 Y1，Y2，它们对应于 X 值。在重塑数据框后，我设法将它们绘制在一起。现在我想在同一图表上为每个 Y1、Y2 点绘制误差线。我明白`geom_errorbar()`这就是我要找的。但是，我要走很长的路要走，而且我确信有一条捷径。我在做什么我正在为每组计算“se”，`aes(ymin=y1-se, ymax=y+se)`并为 Y2 计算并重复相同的操作。因为我想将此误差线应用于不同的情节。我宁愿做的很短。

这是我重塑后的数据框：

```
M     Req      Rec      load       Un      L1
1    30.11  9.000000   3.000000  30.02000  A
2    50.31  10.030000  6.045000  39.44000  A
3    60.01  11.290000  7.366667  54.93000  A
4    66.10  12.630000  8.827500  68.44500  A
5    80.18  13.106000  9.462000  71.07600  A
6    87.10  14.421667  15.961667 82.70500  A
7    90.08  15.880000  20.644286 94.20714  A
1    4.000  1.500000    1.000000  1        B
2    8.240  6.240000    4.760000  3.00000  B
3    10.28  12.230000  9.420000  4.05000   B
4    18.570 25.570000 17.930000  6.00000   B
5    22.250 35.250000 27.850000  7.00000   B
6    35.070 55.010000 36.810000  8.06000   B
7    48.480  0.420000 47.020000  9.06000   B 
```

我使用以下命令绘制它：

```
ggplot(df_reshaped,aes(x = M, y = Req, colour = L1, shape=L1)) +  
     geom_point(size = 5)+
     geom_line() +
     scale_x_discrete(name="M") +
     scale_y_continuous(name="Y1 Y2")+
     ggtitle("A vs B") 
```

在这种情况下，我正在绘制 Y1=Req1，Y2=Req2​​，相对于 x=M

有什么简单的方法或建议来计算误差线吗？

有什么快速计算“se”的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T06:52:27.787

一般来说，有两种可能为您准备数据`ggplot`：

*   您可以汇总原始数据并绘制结果。如果按照这种方式，您也必须计算标准误差，因为无法从聚合数据中检索信息。这些标准误差可以用 绘制`geom_errorbar`。
*   第二种选择是使用原始数据并让`ggplot`您为您进行所有计算。这可以通过`stat_summary`. 例如：

    ```
    stat_summary(fun.data = "mean_cl_normal", mult = 1, geom = "errorbar") 
    ```

显然，您选择了第一种方法。因此，您只需要计算两个变量的点的标准误差。

# ruby-on-rails - Rails jQuery Tokeninput 通过 AJAX 重新加载

> ID：13961631
> 
> 赞同：0
> 
> 时间：2012-12-19T21:36:58.567
> 
> 标签：ruby-on-rails, jquery-tokeninput

我有一个用于 Rails 控制器的 AJAX 创建操作，它将选择表单并通过仅渲染表单的一部分来重新创建它。这样，验证失败时就会显示错误消息。

但是，我的文本字段之一是使用 jQuery TokenInput 插件，当 ajax 调用重绘表单时，jQuery TokenInput 插件不再加载到表单上。

有什么方法可以触发从 AJAX 控制器操作 javascript 文件重新运行相应的 assets/javascripts/.js.coffee 文件？

提前致谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T17:00:57.730

重新绘制表单后，您只需要重新运行您的 Tokeninput 脚本。最好的方法是将您的 Tokeninput 命令放入一个函数中（这样您就不会重复自己），然后在表单渲染后调用该函数。例如，假设您想要一个 Dog 模型，其中包含您想要标记化的多个项圈：

**dog.js.coffee**：

```
tokenizeDogCollars = ->
  $("#dog_collar_tokens").tokenInput "/dogs.json"
tokenizeDogCollars 
```

**创建.js.erb**：

```
<% if @dog.errors.any? -%> 
  ...
  $('#dog-form-container').empty();
  $('#dog-form-container').append('<%= j render("form") %>');
  tokenizeDogCollars();
  ...
<% else %>
  ... whatever you want to do on a successful save ...
<% end %> 
```

# actionscript-3 - 三个movieclips AS3的问题

> ID：13961632
> 
> 赞同：0
> 
> 时间：2012-12-19T21:37:02.433
> 
> 标签：actionscript-3

我有小问题，

也就是说，我已经创建了三个 MovieClip

我给了每个 MC 链接 A1、A2、A3。

在舞台上我放置了代码：

```
var a1:A1 = new A1();
var a2:A2 = new A2();

addChild(a1);
a1.addChild(a2); 
```

在 A2 中我写道：

```
var a3:A3 = new A3();
addChild(a3);
trace(a3.t); 
```

在 A3 中我放置了：

```
var t:String = "test"; 
```

跟踪返回我“空”为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T22:30:47.740

如果不知道你的类文件是什么样子或者你把那行声明和赋值给 t 的确切位置，我不能肯定地说。

ta 是 A3 类的属性吗？

这意味着您在该类的属性声明中拥有它：

```
public var t:String = "test"; 
```

如果不是，则您正在处理范围问题，因为 t 在您声明它的位置之外没有范围。

例如，如果您的构造函数中有这一行：

```
var t:String = "test"; 
```

它的范围仅限于您的构造函数。

你需要做的是让你的 A3 类的公共财产。

这是一个例子：

```
package
{
     public class A3 extends MovieClip
     {
         // declare as class property
         public var t:String;

         public function A3()
         {
              // assign value to class property t
              t = "Test";
         }

         public function doSomething():void
         {
              // this local variable is not accessible outside this function
              var someVariable:String = "test";
         }

     }
} 
```

正如评论者所指出的，如果您选择不将属性声明为公共/私有，则它默认为私有，因此在类外不可见。您不能在方法中将变量声明为公共/私有变量。在方法中声明的任何变量都限定在该方法的范围内——局部变量——并且只能在该方法中访问。

# user-interface - 单击菜单时Kendo UI菜单跳转

> ID：13961641
> 
> 赞同：4
> 
> 时间：2012-12-19T21:37:18.907
> 
> 标签：user-interface, menu, kendo-ui

我的菜单设置为：

```
.CloseOnClick(true)
.OpenOnClick(true) 
```

（我正在使用带有 Razor 语法的 MVC4）

当我单击一个菜单项时，它会打开菜单内容，但是当我再次单击菜单项时，屏幕会在不应该的情况下跳下页面。我无法弄清楚为什么屏幕会跳动。

这是触发的相关代码：

```
items.Add().Text("Stores")
    .Content(@<text>
    <h2>Around the Globe</h2>
    </text>); 
```

由于`.Content()`参数，屏幕似乎正在跳跃。

此外，在单击菜单之前，URL 是：

```
http://localhost:55656/HelloWorld 
```

但按下后，URL 变为：

```
http://localhost:55656/HelloWorld#Menu-2 
```

虽然除了剑道 UI 菜单打开之外没有任何变化，但直到再次按下屏幕才会跳转。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T09:02:33.673

似乎菜单在单击时导航。仅当您希望项目导航 () 或页面上出现 JavaScript 错误并且不阻止对项目的单击时，才会发生这种情况。你能检查一下是否真的有错误并在这里发布吗？

# javascript - 在 Ext Xtemplate 中计算

> ID：13961646
> 
> 赞同：1
> 
> 时间：2012-12-19T21:37:52.673
> 
> 标签：javascript, extjs

我尝试在 Ext XTemplate 中进行计算。根据我读到的文档，可以使用简单的 {x + y} 标记，但这不适用于 2 个变量，因此我尝试使用 {[x + y]} 进行此操作，但之后模板渲染停止.

```
var tpl = new Ext.XTemplate('{x} + {y} = {[x + y]} thats it.');
console.log( tpl.apply({x: 1.5, y: 2}) );​ 
```

结果是。

```
1.5 + 2 = 
```

我已经按照我的尝试制作了 jsFiddle [http://jsfiddle.net/VnFR3/1/ 。](http://jsfiddle.net/VnFR3/1/)

任何人都可以对此有所了解吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T23:59:26.243

试试这个：

```
var tpl = new Ext.XTemplate('{x} + {y} = {[values.x+values.y]} thats it');
console.log( tpl.apply({x: 1.5, y: 2}) ); 
```

替代功能：

```
var tpl = new Ext.XTemplate('{x} + {y} = {[values.x+values.y]}  or ',
                            '{[this.add( values.x,values.y )]}',{
    add:function(x,y){
        return x+y;
    }
});
console.log( tpl.apply({x: 1.5, y: 2}) ); 
```

与您的代码的重要区别是在 [] 代码执行模板中使用**values对象。**文档没有说得足够清楚。

# java - 如何使用 Tuckey urlrewrite 重命名参数？

> ID：13961648
> 
> 赞同：3
> 
> 时间：2012-12-19T21:37:59.553
> 
> 标签：java, tuckey-urlrewrite-filter

我正在使用`use-query-string`设置为默认值 (false) 的 Tuckey urlrewrite 过滤器。这意味着 from url 不使用查询参数来匹配。在孤立的情况下，我想做的是重命名一个查询参数，这需要匹配 from 标记中的查询字符串。

例如，我想这样做：

```
<rule>
    <from>^/myPage?id=(.*)$</from>
    <to>/newPage?userId=$1</to>
</rule> 
```

这是可能的`use-query-string=true`，不幸的是，这将是一个全局更改，如果我更改此设置，会有许多规则被破坏。

有没有办法覆盖`use-query-string`单个规则？

有解决办法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T21:49:12.107

[我在这个](https://stackoverflow.com/questions/11995673/urlrewrite-tuckey-hide-specific-parameter-if-exists)未回答的问题上找到了答案的提示。[您可以使用手册](http://urlrewritefilter.googlecode.com/svn/trunk/src/doc/manual/4.0/index.html#configuration)中描述的“反向引用”功能（尽管它不是很清楚它是如何工作的）

```
<rule>
    <from>^/mypage$</from>
    <to type="redirect" >/newPage?userId=%{parameter:id}</to>
</rule> 
```

# objective-c - 使用可见导航栏执行 segue 时视图被下推

> ID：13961650
> 
> 赞同：0
> 
> 时间：2012-12-19T21:38:02.933
> 
> 标签：objective-c, ios, uinavigationbar, uistoryboard

我在隐藏导航栏的视图上执行带有导航栏的转场，当转场开始时，我当前的视图似乎被未隐藏在我的转场中的导航栏推下......这看起来很糟糕......

如果我删除该`setNavigationBarHidden:animated`方法，我在执行 segue 后看不到导航栏，并且问题不再出现。

```
- (void) tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    [self.navigationController setNavigationBarHidden:NO animated:YES];

    if (indexPath.row == 0) {
        [self performSegueWithIdentifier:@"mailSignUp" sender:nil];
    } else if (indexPath.row == 1) {
        [self performSegueWithIdentifier:@"logIn" sender:nil];
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T22:08:14.427

如果要隐藏导航栏，则必须在根控制器中进行，即应用程序中的第一个控制器。我的猜测是，您已经在界面构建器中设置了从某个按钮到以下视图的模态序列。通过这样做，您可以从下到上滑动以下视图。我还猜测您正在使用最新的 xcode 版本 [4.5.2] 并在 ios6 上运行它。

尝试从界面生成器中删除您的 segue。此外，而不是你的：

> [self performSegueWithIdentifier:@"mailSignUp" sender:nil];

利用：

```
UIStoryboard *storyBoard = [UIStoryboard storyboardWithName:@"MainStoryboard" bundle:nil];

YourSecondController *secondController = (YourSecondController *)[storyBoard instantiateViewControllerWithIdentifier:@"YourSecondController"];

[self.navigationController pushViewController:yourSecondController animated:YES]; 
```

[将 YourSecondController 替换为 mailSignUp 或您想要执行 segue 的任何控制器]

此外，如果要隐藏导航栏，则必须在根控制器的 (void)viewdidload 方法中添加这行代码。

如果你像这样以编程方式运行你的 segue，你应该实现从右到左的第二个视图幻灯片。如果这不充分或不准确，请告诉我这是否有帮助或提供更多信息。

# kineticjs - 如何在 kineticjs 中渲染复杂形状的两个副本

> ID：13961651
> 
> 赞同：2
> 
> 时间：2012-12-19T21:38:03.450
> 
> 标签：kineticjs, layer

**如何并排放置组的两个实例？**

```
var stage = new Kinetic.Stage({
      container: 'canvas',
      height: 125,
      width: 250         
 });

 var layerLeft = new Kinetic.Layer({
     x: 62.5,
     y: 62.5,
     height: 125,
     width: 125          
 });

var layerRight = new Kinetic.Layer({
     x: 187.5,
     y: 62.5,
     height: 125,
     width: 125          
 });

 var group = new Kinetic.Group({
     offset:   [62.5, 62.5]           
 });

    var circle = new Kinetic.Circle({

      x: (stage.getWidth() / 4),
      y: stage.getHeight() / 2,
      width: 124,
      height: 124,
      stroke: 'grey',
      strokeWidth: 1
    });

    var topPath = new Kinetic.Path({         
      data: 'M50.5,10.5 L50.5,10.5 75,10.5 L75,10.5 68.55,34.5 L68.55,34.5 56.45,34.5 L56.45,34.5 50.5,10.5 Z',
      stroke: 'grey',
      strokeWidth: 1          
    });

    var leftPath = new Kinetic.Path({ 
      data: 'M25,100 L25,100 42,81 L42,81 35.5,70.5 L35.5,70.5 11,77 L11,77 25,100 Z',
      stroke: 'grey',
      strokeWidth: 1          
    });

    var rightPath = new Kinetic.Path({          
      data: 'M100,100 L100,100 83,81 L83,81 89.5,70.5 L89.5,70.5 113.5,76.75 L113.5,76.75  100,100 Z',
      stroke: 'grey',
      strokeWidth: 1
    });

      group.add(circle);
      group.add(topPath);
      group.add(leftPath);
      group.add(rightPath);
      layerRight.add(group);
      //layerLeft.add(group); 
      stage.add(layerLeft);
      stage.add(layerRight); 
```

[JS小提琴](http://jsfiddle.net/cvGvH/11/)

*我尝试过的事情：*

• 将路径/圆圈添加到一层上的两个单独的组。

• 将一组添加到两层。

这是关闭问题吗？我已经阅读了所有相关内容，但我不太明白如何解决它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T09:29:15.267

This is a little hard for me to explain (and I could even be wrong;) ) but Ill give it a shot.

When you create a group it refrences the items in it not create new ones and then alters the attributes of them according to its attributes.
So if you had a circle of x=0 but the groups x=20 then the circle will get drawn at 20....it does not create a new circle and put its x as 20.
So if you had two groups both refrencing the same circle then the one that comes last is where the circle will be.
Group one says circleX=20, but Group2 says circleX=40 so it will draw that circle (as their is only one) at 40.
So when you clone a group your only cloning information that says where to draw the circle, not creating another circle aswell as the information as to where to put it, only the information of where to put it.

You can deal with this by explicitly creating two circles and putting them in their own groups.
In your case it would look like this....

```
var stage = new Kinetic.Stage({
    container: 'canvas',
    height: 125,
    width: 250
});

var layerLeft = new Kinetic.Layer({
    x: 0,
    y: 0,
    height: 125,
    width: 125
});

var layerRight = new Kinetic.Layer({
    x: 125,
    y: 0,
    height: 125,
    width: 125
});

function createThing() {
    var group = new Kinetic.Group();

    var circle = new Kinetic.Circle({

        x: (stage.getWidth() / 4),
        y: stage.getHeight() / 2,
        width: 124,
        height: 124,
        stroke: 'grey',
        strokeWidth: 1
    });

    var topPath = new Kinetic.Path({
        data: 'M50.5,10.5 L50.5,10.5 75,10.5 L75,10.5 68.55,34.5 L68.55,34.5 56.45,34.5 L56.45,34.5 50.5,10.5 Z',
        stroke: 'grey',
        strokeWidth: 1
    });

    var leftPath = new Kinetic.Path({
        data: 'M25,100 L25,100 42,81 L42,81 35.5,70.5 L35.5,70.5 11,77 L11,77 25,100 Z',
        stroke: 'grey',
        strokeWidth: 1
    });

    var rightPath = new Kinetic.Path({
        data: 'M100,100 L100,100 83,81 L83,81 89.5,70.5 L89.5,70.5 113.5,76.75 L113.5,76.75  100,100 Z',
        stroke: 'grey',
        strokeWidth: 1
    });
    group.add(circle);
    group.add(topPath);
    group.add(leftPath);
    group.add(rightPath);
    return group;
}

var group1 = createThing();
var group2 = createThing();

layerRight.add(group1);
layerLeft.add(group2);

stage.add(layerLeft);
stage.add(layerRight); 
```

​http://jsfiddle.net/cvGvH/12/

If anyone can explain that better, feel free to edit this post or make another answer.

# cocoa - 使 NSTableView 表现得像 WPF StackPanel

> ID：13961653
> 
> 赞同：2
> 
> 时间：2012-12-19T21:38:23.230
> 
> 标签：cocoa, nstableview, stackpanel, monomac

我正在尝试`StackPanel`在我的 MonoMac 项目中实现一个垂直等效项，但无法弄清楚。我没有使用界面生成器，而是以编程方式创建控件（这是一个限制）。我尝试使用 a`CollectionView`但该控件中的所有项目的大小都相同。

环顾互联网，这似乎`NSTableView`是要走的路，但我不知道该怎么做，尤其是在使用 MonoMac 目标时使用 C#。允许我创建我想要渲染的视图`CollectionView`更直接一些。`CollectionViewItem.ItemPrototype`但是对于`NSTableView`，似乎我只能指定一个返回`NSObject`要显示的 s 的数据源。我如何获取这些数据，然后将它们绑定到我想要粘贴在那里的视图？

我更喜欢 C# 代码，但我正处于接受任何和所有帮助的阶段！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T16:08:34.297

我终于能够让它工作了。这里有一些代码供任何想尝试的人使用。基本上，我们需要`NSTableViewDelegate`为所需的功能编写 s。此实现也不会缓存控件或任何东西。[Cocoa API 文档](http://developer.apple.com/library/mac/#documentation/cocoa/Conceptual/TableView/PopulatingView-TablesProgrammatically/PopulatingView-TablesProgrammatically.html)中提到了使用标识符来重用控件或其他东西，但标识符字段在 MonoMac 中是 get-only。

我还最终`NSTableViewDelegate`在我的数据源本身中实现了我的函数，我确信这根本不是 kosher，但我不确定最佳实践是什么。

这是数据源类：

```
class MyTableViewDataSource : NSTableViewDataSource
{
    private NSObject[] _data;

    // I'm coming from an NSCollectionView, so my data is already in this format
    public MyTableViewDataSource(NSObject[] data)
    {
        _data = data;
    }

    public override int GetRowCount(NSTableView tableView)
    {
        return _data.Length;
    }

    #region NSTableViewDelegate Methods

    public NSView GetViewForItem(NSTableView tableView, NSTableColumn tableColumn, int row)
    {
        // MyViewClass extends NSView
        MyViewClass result = tableView.MakeView("MyView", this) as MyViewClass;
        if (result == null)
        { 
            result = new MyViewClass(_data[row]);
            result.Frame = new RectangleF(0, 0, tableView.Frame.Width, 100); // height doesn't matter since that is managed by GetRowHeight
            result.NeedsDisplay = true;
            // result.Identifier = "MyView"; // this line doesn't work because Identifier only has a getter
        }

        return result;
    }

    public float GetRowHeight(NSTableView tableView, int row)
    {
        float height = FigureOutHeightFromData(_data[row]); // run whatever algorithm you need to get the row's height
        return height;
    }

    #endregion
} 
```

这是以编程方式创建表的片段：

```
var tableView = new NSTableView();
var dataSource = new MyTableViewDataSource();

tableView.DataSource = dataSource;
tableView.HeaderView = null; // get rid of header row
tableView.GetViewForItem = dataSource.GetViewForItem;
tableView.GetRowHeight = dataSource.GetRowHeight;

AddSubView(tableView); 
```

因此，它并不完美`StackPanel`，因为需要手动计算行高，但总比没有好。

# jquery - jQuery 验证未来的形式

> ID：13961659
> 
> 赞同：2
> 
> 时间：2012-12-19T21:38:39.347
> 
> 标签：jquery, jquery-validate

我正在使用 jQuery 验证插件来验证表单。我的问题是表单是动态生成的，所以页面第一次加载时它还不存在。我不确定如何做到这一点，或者是否可以做到。这是我的代码，只要我对表单进行硬编码，它就可以工作。

```
$(document).ready(function() {
    var post_url = '##removed##';

    $("#form").validate({
        success: "valid",
        rules: {
            username: {
                required: true,
                minlength: 6,
                maxlength: 15,
                remote: {
                    url: post_url,
                    type: "post",
                    data: { type : 'username' }
                }
            },
            email: {
                required: true,
                email: true,
                remote: {
                    url: post_url,
                    type: "post",
                    data: { type : 'email' }
                }
            }
        },
        messages: {
            username: {
                remote: "Username taken. Please choose another."
            },
            email: {
                remote: "E-mail address taken. Please choose another."
            }
        }
    });

}); 
```

我尝试使用 jQuery 的 on() 函数想出一些东西，但到目前为止我尝试过的任何方法都没有奏效。我试图完成的事情甚至可以完成吗？最坏的情况是我对表单进行了硬编码，但如果可能的话，我想避免这样做。

提前致谢 ...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T22:09:51.610

我假设表单是使用 ajax 连接加载的。有一个回调来查找表单并在`validate()`之后调用该函数。

您还可以使用 DOM 突变事件 (DOMNodeInserted) 附加一个事件侦听器，并每次检查插入到 DOM 的节点是否是您正在等待的表单，然后运行`validate()`。希望这可以帮助

# asp.net - Windows 身份验证会话状态 - ASP.Net MVC 3

> ID：13961665
> 
> 赞同：1
> 
> 时间：2012-12-19T21:38:54.137
> 
> 标签：asp.net, asp.net-mvc-3, iis-7.5, session-timeout

我有一个使用 Windows 身份验证的 ASP.NET MVC 3 应用程序，在 IIS 7.5 中配置。当用户第一次加载页面时，它会提示用户输入他们的 Windows 凭据。

现在，我想在 XX 分钟内设置“会话”超时，这样如果超时时间已过，页面将再次提示他们输入凭据。

我尝试在要保护的页面的 page_load 方法中设置“Session.timeout = XX”。

我注意到 Global.Asax 中的“Session_End”方法确实触发了，但即使在 Session 结束后，Authentication Ticket 似乎也“保持有效”。

有没有办法通过更改 Web.Config 中的配置或通过 IIS 来强制页面在指定的超时时间再次提示 Windows 凭据？

请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T21:46:09.057

据我所知，没有简单的方法可以实现这一目标。我读过有人试图手动控制何时发送 401，但据我所知，我还没有找到任何可靠的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T21:48:20.680

使用 Windows 身份验证时，您无法控制允许的会话持续时间，因为这是身份验证协议 (Kerberos) 的一部分。有很多[方法和解决方法](http://forums.asp.net/t/1489931.aspx)，但没有一个是直截了当的。

似乎强制客户端`document.execCommand("ClearAuthenticationCache");`可能最接近您的需求。

# jquery - jQuery查找具有类名和属性值的元素

> ID：13961667
> 
> 赞同：2
> 
> 时间：2012-12-19T21:38:58.763
> 
> 标签：jquery

就文档而言，还没有想出太多。如何找到具有特定类名且也具有指定属性值的元素。？

```
function go_to_page(page){
    $('.page_link[longdesc=page]').addClass('.active_page'); 
} 
```

我从[这里](http://www.w3schools.com/jquery/sel_attribute_end_value.asp)得到了例子。尝试自己测试它，它似乎没有工作。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-19T21:42:14.073

```
function go_to_page(page){

    $('.page_link[longdesc=' + page + ']').addClass('active_page'); 

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T21:40:49.207

您的语法有一些错误，请尝试：

```
 function go_to_page(page){

     $('.page_link[longdesc='+page+']').addClass('active_page'); 
 } 
```

类通常不以点开头（仅在选择器中而不是名称中）

# apache - 放气模式打开时 Apache 如何处理图像/闪存

> ID：13961669
> 
> 赞同：-1
> 
> 时间：2012-12-19T21:39:17.053
> 
> 标签：apache, gzip, mod-deflate

我正在考虑[在 Apache 上启用 deflate 模式](http://httpd.apache.org/docs/2.2/mod/mod_deflate.html)。我很好奇 Apache 在 deflate 时如何处理图像或闪存文件？它是否也尝试压缩图像和闪存文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T21:42:12.053

当然。如果您没有设置任何过滤器，如果客户端支持压缩，服务器将压缩所有内容。

如果您使用文档中的行：

```
AddOutputFilterByType DEFLATE text/html text/plain text/xml 
```

那只会压缩具有该内容类型的文本文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T17:44:23.167

> “网络支持的图像文件格式，以及视频、PDF 和其他二进制格式，已经被压缩；在它们上使用 gzip 不会提供任何额外的好处，实际上可以使它们更大。要压缩图像，请参阅优化图像。”

[https://developers.google.com/speed/docs/best-practices/payload#GzipCompression](https://developers.google.com/speed/docs/best-practices/payload#GzipCompression)

# javascript - replaceWith jQuery 方法后父节点为空

> ID：13961670
> 
> 赞同：2
> 
> 时间：2012-12-19T21:39:19.320
> 
> 标签：javascript, jquery, dom

我在我的项目中使用 jQuery 来操作 DOM。我有类方法，它的工作原理是这样的：

```
<!-- language: lang-js -->    
var template = this._Template.split('{0}');
    var content = template[0] + this._Content + template[1];
    if (!this._BlockNode) {
        this._BlockNode = $(content);
        this._ParentNode.append(this._BlockNode);
    }
    else {
        this._BlockNode.replaceWith(content);
    } 
```

第一次调用此方法时一切正常，因为它创建节点并将其附加到父节点。第二次调用（使用`replaceWith()`方法）也可以。但是在它之后属性`this._BlockNode[0].parentNode`为空。因此，当我第三次调用它并使用没有属性`replaceWith()`的 new时，它不会因为这个检查而替换节点的内容： 如何处理？`_.BlockNode``.parentNode``if ( !isDisconnected( this[0] ) ) { //line 5910 in jQuery 1.8.3`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T21:54:41.537

您需要确保`_BlockNode`始终指向*当前*版本的内容。

当您调用时，`replaceWith`您正确更新了 DOM 结构，但未能更新对象的内容。原来的`_BlockNode`最终成为孤立的，所有后续`replaceWith`调用都在该节点上工作，而不是在较新的内容上。

试试这个：

```
var template = this._Template.split('{0}');
var $content = $(template[0] + this._Content + template[1]);
if (!this._BlockNode) {
    this._ParentNode.append($content);
} else {
    this._BlockNode.replaceWith($content);
}
this._BlockNode = $content; 
```

最好*将*本地 DOM 元素保存在`_BlockNode`而不是 jQuery 对象中。

# java - EasyMock 参数匹配器

> ID：13961673
> 
> 赞同：1
> 
> 时间：2012-12-19T21:39:25.443
> 
> 标签：java, unit-testing, easymock

我想使用 EasyMock 进行测试。其中一个服务调用需要一个对象。在我使用该服务的类中，该对象是在我的方法中构造的。我可以事先在测试中构造对象，但对象与我的类方法中的对象不同。为了使 EasyMock 工作，我必须使用 eq()。但不幸的是，对象类是服务包的一部分，并没有覆盖 Object.equal()。我该如何解决这个问题？有一种叫做自定义参数匹配器的东西。它符合我的目的吗？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T21:44:53.643

如果您不关心参数的状态，您可以使用`anyObject()`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T21:45:01.400

您不必使用`eq()`. 您也可以使用任何其他匹配器，例如`anyObject()`、或。`isA()``capture()``notNull()`

# javascript - 是否存在用于退出 iOS 中的“选择滚动条”界面的供应商特定事件？

> ID：13961678
> 
> 赞同：1
> 
> 时间：2012-12-19T21:39:45.867
> 
> 标签：javascript, ios, css, dom

我有一个问题，当用户点击一个`<select>`框时，它会打开 iOS 中的“滚轮”界面，该界面会推动他们与之交互的模式。这很好，但是当界面关闭时它不会恢复模态的位置。

是否有任何供应商特定的 DOMEvents 或 css 伪元素可以用来调用位置计算并在此 ui 元素关闭时更改（通过“完成”按钮或通过在界面外点击）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T21:58:04.137

iOS 滚动选择小部件有一个类似但不相同的问题。在我的情况下，当滚动选择小部件打开时页面会缩放，并且在关闭时不会缩小。

奇怪的是，解决方法是将字体大小设置得相对较大：

```
/* iPhone4+ select box fix */
@media only screen and (-webkit-min-device-pixel-ratio: 2) {
    select { font-size: 2em; }
} 
```

媒体查询确保这只发生在 iPhone 上。

# jquery - 如何拖动包含被拖入其中的其他 div 的 div？

> ID：13961679
> 
> 赞同：0
> 
> 时间：2012-12-19T21:39:50.570
> 
> 标签：jquery, html, drag-and-drop

我正在尝试解决一个问题，但我自己解决问题的运气并不好。

我的页面上有几个容器 div。“ItemContainer”包含可拖动的“项目”。“MainHome”包含一个辅助“ItemContainer”（“项目”将被拖到其中）以及其他一些 div。“MainHome”也可拖入“Playarea”。我需要发生的是，当“项目”被拖到“MainHome”中包含的“ItemContainer”中时，它们需要附加到它上面，这样如果随后拖动“MainHome”，这些项目就会随之拖动。

它们也需要保持单独可拖动。

这是我的通用代码：

```
<div id="leftrail">
    <div id="manager">
        <div id="somediv">
            <h2>Text</h2>
            <div id="bubble">Text Here</div>
        </div>
        <div>
            <div id="ItemContainer">
                <div id="Item1">Item 1</div>
                <div id="Item2">Item 2</div>
                <div id="Item3">Item 3</div>
                <div id="Item4">Item 4</div>
                <div id="Item5">Item 5</div>
            </div>
        </div>
    </div>
    <h2>Section Title</h2>
    <div>
        <div id="MyContainer">
            <div id="SecondaryItemContainer">Drag Items Here</div>
            <div>Some text</div>
            <div>Some more text</div>
        </div>
    </div>
</div>

<div id="MainContent">    
    <div>Some stuff here</div>    
    <div>Some stuff here</div>      
    <div>Some stuff here</div>    
    <div id="BigContainer">Drag the MyContainer Here</div>      
</div> 
```

完整的演示在这里：http: [//jsfiddle.net/j6pVG/1/](http://jsfiddle.net/j6pVG/1/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T22:58:52.457

1.  这是一个嵌套的可排序解决方案：http: [//mjsarfatti.com/sandbox/nestedSortable/](http://mjsarfatti.com/sandbox/nestedSortable/)

    这是对上述解决方案中如何处理序列化的改进：http: [//markmintoff.com/2011/05/jqueryui-hierarchical-sorting/](http://markmintoff.com/2011/05/jqueryui-hierarchical-sorting/)

2.  另一种解决方案： http: [//dbushell.com/2012/06/17/nestable-jquery-plugin/](http://dbushell.com/2012/06/17/nestable-jquery-plugin/)

3.  而且，这里是这个问题的 SO 副本：

    *   [jQuery Nested Sortable - 在所有可用的 UL 中移动 LI 元素](https://stackoverflow.com/questions/1188153/jquery-nested-sortable-move-li-elements-within-all-available-uls)
    *   [jquery嵌套可排序列表](https://stackoverflow.com/questions/2487026/jquery-nested-sortable-list)
    *   [jQuery Sortable - 嵌套的 UL 元素](https://stackoverflow.com/questions/3290494/jquery-sortable-nested-ul-elements)

# php - symfony 1.4.8 与 PHP 5.4.7 和 Apache 2.4.3 冲突

> ID：13961683
> 
> 赞同：3
> 
> 时间：2012-12-19T21:40:04.877
> 
> 标签：php, apache, symfony1, xampp, symfony-1.4

我最近更新了我的 Xampp 服务器（从 1.7 >> 1.8），从那以后我不再能够运行我用 Symfony 1.4.8 编写的项目。

它说：

> 您无权访问请求的目录。没有索引文档或目录被读保护。

但它有权限！

实际上它适用于旧版本的 Xampp。Symfony 1.4.8 是否可能与 Apache 2.4 或 PHP 5.4 不兼容？我使用的是 Windows 8 Enterprise，但也在 Windows 7 Ultimate 上进行了测试，并且存在同样的问题。

任何建议，将不胜感激。

这是我的配置：

```
NameVirtualHost 127.0.0.1:1111
Listen 127.0.0.1:1111
<VirtualHost 127.0.0.1:1111>
  DocumentRoot "D:\AMir\PROJECTS\BarzinMehr\web"
  DirectoryIndex index.php
  <Directory "D:\AMir\PROJECTS\BarzinMehr\web">
    AllowOverride All
    Allow from All
  </Directory>
  Alias /sf C:\xampp\htdocs\symfony\data\web\sf
  <Directory "C:\xampp\htdocs\symfony\data\web\sf">
    AllowOverride All
    Allow from All
  </Directory>
</VirtualHost> 
```

这是我的 .htaccess

```
Options +FollowSymLinks +ExecCGI

<IfModule mod_rewrite.c>
  RewriteEngine On

  # uncomment the following line, if you are having trouble
  # getting no_script_name to work
  #RewriteBase /

  # we skip all files with .something
  #RewriteCond %{REQUEST_URI} \..+$
  #RewriteCond %{REQUEST_URI} !\.html$
  #RewriteRule .* - [L]

  # we check if the .html version is here (caching)
  RewriteRule ^$ index.html [QSA]
  RewriteRule ^([^.]+)$ $1.html [QSA]
  RewriteCond %{REQUEST_FILENAME} !-f

  # no, so we redirect to our front web controller
  RewriteRule ^(.*)$ index.php [QSA,L]
</IfModule> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-31T13:09:06.133

在为这个问题苦苦挣扎了这么多天之后，我终于找到了解决方案，我把它带到这里，以支持其他可能面临这个问题的人。根据[这篇文章](http://www.andrejfarkas.com/2012/06/fun-with-wamp-server-and-apache-2-4-2/)（感谢作者！）我所要做的就是：

像这样更改每个目录块：

```
<Directory "your address">
    AllowOverride All
    Allow from All
</Directory> 
```

到

```
<Directory "your address">
    Options Indexes FollowSymLinks MultiViews
    AllowOverride all
    Require all granted
</Directory> 
```

似乎在**apache 2.4中****Allow**被放弃，取而代之的是新指令**Require**（根据[版本 apache 2.4 的文档](http://httpd.apache.org/docs/2.4/howto/access.html)）

 *** * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T22:09:49.580

尝试删除 .htaccess 文件并`index.php`直接访问该文件。如果这有效（或至少产生 PHP 错误，而不是 apache 错误），则可能意味着 mod_rewrite 未启用，并且`.htaccess`未按预期工作。

我建议删除：

```
<IfModule mod_rewrite.c> 
```

如果它们存在，它是来自 .htaccess 文件的结束标记，因为如果未安装该模块，最好得到一个未安装的错误，而不是该站点无法以一种奇怪的方式工作。

如果上述方法不能解决问题，请查看 apache 的错误日志 - 这通常包含线索。**

# python - Python if 在语句细节中

> ID：13961689
> 
> 赞同：2
> 
> 时间：2012-12-19T21:40:24.133
> 
> 标签：python, if-statement, padding

简而言之，我有一个项目清单。假设他们的名称为 Object1、Object2、....Object10、....Object20 等等。

此列表取决于使用输入更改起点，例如，可以说列表包含从 Object18 到 Object28 的所有对象的名称

我使用一条语句从存储的列表中选择这些项目：

```
for i in nuke.allNodes():
if i.name() in hiddenLists:
    i.setSelected(True)
else:
    i.setSelected(False) 
```

哪个通常有效......麻烦是因为“in”（对于列表内部）没有指定我希望它必须匹配列表的整个条目，而不是只选择对象 18-28 它选择对象 1 对象 2 和对象 18- 28（原因当然是 Object18 等以 Object1 开头，20s 以 2 开头）

由于这些是程序创建的设置名称并且必须保持不变，因此我无法填充字符串。我唯一的问题是，有没有比它更好的运算符使它必须完全匹配而不是在“Object18”中看到 Object1？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T21:45:21.040

看起来 hiddenLists 是用户输入的字符串（str）。使用该`split`字符串上的方法首先使其成为列表。然后“in”子句会做你想做的事。

例如，如果用户输入一个逗号分隔的列表：

```
hiddenLists = [x.strip() for x in hiddenLists.split(",")]
if i.name() in hiddenLists:
    ... 
```

# php - 使用随机值时 ajax 页面上的会话值更改

> ID：13961693
> 
> 赞同：1
> 
> 时间：2012-12-19T21:40:31.580
> 
> 标签：php, ajax, security, session, csrf

我试图阻止用户`POST/AJAX`直接访问我的文件。我决定创建一个随机令牌，我称之为“nonce_key”。此密钥是使用 a 创建的`SESSION`，然后我通过`POST`. 如果`SESSION`密钥与 相同，`POST`则我允许访问。问题是有时它不起作用。

这是我的工作流程：
我在 index.php 上有一个选择，当用户更改其值时，它通过 ajax 调用“change_status.php”。

由于某种原因`SESSION`，index.php 上设置的`SESSION`键值与 change_status.php 上的键值不同。

我的functions.php文件中有以下代码

```
function nonce_key()
{
    return hash('crc32b', time());
} 
```

然后在我的索引中

```
session_start();
require_once 'functions.php';

$_SESSION['nonce_key'] = nonce_key();

echo '
<script  type="text/javascript"> 
$"#change_status").bind("change",function() {
var form_data = {
nonce: "'.$_SESSION['nonce_key'].'",
id: $("#id").val(),
};

$.ajax({

type: "POST",
url: "change_status.php",
data: form_data,
success: function(result) {
  $("#message").slideDown("slow").html(result);
  }
 });
});
</script>'
; 
```

最后在我的 change_status.php 文件中

```
session_start();
require_once 'functions.php';
if(isset($_SESSION['nonce_key']) && isset($_POST['nonce']))
{
   if($_SESSION['nonce_key'] == $_POST['nonce'])
   {
     change_app_status($_POST['id']);
   } else echo 'Nonce Invalid';
} else echo 'Not Allowed'; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T21:58:49.770

检查 $_POST 是否有哈希。而且你不需要`require_once 'functions.php';`在change_status.php中。如果少的话，你可以使用 ===

# php - 使用 PHP 和 For 循环将数据输入到 MySQL 表

> ID：13961696
> 
> 赞同：2
> 
> 时间：2012-12-19T21:40:44.033
> 
> 标签：php, mysql, arrays, for-loop

所以我在将数组放入 MySQL 表时遇到了一些麻烦。我的目标是将数组中的一个元素放入表格的一行中，但事实并非如此。

```
$cnt = count($array);
for($i = 0; $i < $cnt; $i++)
    {
    mysql_query("
        INSERT INTO $groupname (id, name) 
        VALUES('', '".$array[$i]."')
        ", $conn1); 
    } 
```

（id是自动递增的）

我希望这会将数组的第一个元素放在表格的第一行，第二个元素放在第二行，依此类推。相反，我的桌子看起来像这样

```
+----+-------+
| id | name  |
+----+-------+
|  1 | Array |
+----+-------+ 
```

我假设它只是获取数组并将整个内容放在第一行。我该如何防止呢？我将如何每行做一个元素？

编辑这是 var_dump

```
array(1) { [0]=> array(5) { [0]=> string(1) "0" [1]=> string(1) "1" [2]=> string(1) "2" [3]=> string(1) "3" [4]=> string(1) "4" } } 
```

出于测试目的，我只是将数字 0-4 按升序排列在数组的每个元素中

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T21:45:12.360

你的代码是有效的。但似乎 $array 实际上是一个多维数组，在第一级包含 1 个键。也许`var_dump($array)` 在循环之前尝试一下，看看里面有什么。

或尝试盲注 for on`$array[0]`然后`$array[0][$i]`在循环中。尽管盲目编码从来都不是一件好事。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T21:46:07.450

我想你打算做这样的事情：

```
VALUES('', '".$array[$i]['name']."')" 
```

您不能将数组直接插入 mysql，而是必须插入其每个值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T21:56:50.803

有几点需要指出：

不要调用要插入的 id 值。

它看起来`$array[$i]`本身就是一个数组，因此请确保您使用的是正确的值。

您应该只构建插入查询并插入一次（参见下面的示例）。

```
$query = 'INSERT INTO ' . $groupname . ' (name) VALUES ';
foreach($array as $item) {
    $query .= "('". $item['name'] . "'),"; // 'name' or whatever proper item in multidimensional array is.
}
$query = rtrim($query, ',');
mysql_query($query, $conn); 
```

您确实需要考虑使用`mysqli_*`函数，而不是`mysql_*`因为这些函数已被弃用。

您确实应该在查询中添加错误处理（即处理查询不起作用的情况并给自己一个错误消息。

# ruby-on-rails - Rails：如何测试 before_save 回调

> ID：13961699
> 
> 赞同：6
> 
> 时间：2012-12-19T21:40:50.500
> 
> 标签：ruby-on-rails, testing, private-members

给定一个典型的 ActiveRecord 模型，我经常有`before_save`解析输入的回调，例如`time_string`从用户那里获取类似的东西并将其解析为一个`time`字段。

该设置可能如下所示：

```
before_save :parse_time
attr_writer :time_string

private
def parse_time
  time = Chronic.parse(time_string) if time_string
end 
```

我知道将回调方法设为私有被认为是最佳实践。但是，如果它们是私有的，那么您不能单独调用它们来单独测试它们。

那么，对于那些经验丰富的 Rails 测试人员来说，你如何处理测试这种事情呢？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-19T21:45:16.250

在 Ruby 中，私有方法仍然可以通过`Object#send`

您可以像这样利用它进行单元测试：

```
project = Project.new
project.time_string = '2012/11/19 at Noon'
assert_equal(project.send(:parse_time), '2012-11-19 12:00:00') 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-19T21:54:18.967

我要做的是保存对象`new`或`build`实例的状态，保存对象并根据被更改的属性的值做出断言或期望`before_save`

```
post = Post.new
post.time_string = '2012/11/19'
expected_time = Chronic.parse(post.time_string)
post.save
assert_equal(post.time, expected_time) 
```

这样，您正在测试对象应该如何操作的行为，而不一定是方法的实现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-03T01:22:03.947

有时`if`我的回调有条件，在这种情况下我使用`run_callbacks`.

```
before_save :parse_time, :if => Proc.new{ |post| post.foo == 'bar' } 
```

经测试呈阳性

```
post = Post.new
post.foo = 'bar'
expected_time = Chronic.parse(post.time_string)
post.run_callbacks :before_save
assert_equal(post.time, expected_time) 
```

并且消极地由

```
post = Post.new
post.foo = 'wha?'
post.run_callbacks :before_save
assert_nil(post.time) 
```

有关更多详细信息，请参阅[API](http://api.rubyonrails.org/classes/ActiveModel/Callbacks.html)和[博客](http://jacopretorius.net/2013/10/testing-activerecord-callbacks.html)。

# ruby-on-rails - Rails 和 Ajax 如何正确处理 ajax 请求

> ID：13961712
> 
> 赞同：0
> 
> 时间：2012-12-19T21:41:48.567
> 
> 标签：ruby-on-rails, ajax, ruby-on-rails-3

我有一个项目控制器，在“new.html.erb”视图中我有以下代码：

```
<div class="row">
<%= form_for @project, remote: true do |f| %>

<%= f.label :name %>
<%= f.text_field :name %>

<%= f.label :description %>
<%= f.text_field :description %>

<%= f.submit "Add Project", class: "btn btn-primary"%>
<% end %>
</div>

<p id= "test">Hello</p> 
```

当我单击提交按钮时，我知道这被称为项目控制器中的“创建”操作：

```
def create
    respond_to do |format|
        format.html{ redirect_to new_project_path}
        format.js
    end
end 
```

我创建了 create.js.erb 文件来处理 ajax 请求：

```
("#test").hide() 
```

为何

```
<p id= "test">Hello</p> 
```

在 new.html.erb 中没有隐藏？问题是什么？

谢谢大家的回答

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T22:02:14.973

如果您使用的是 jquery，那么您`$`将 js 脚本放在前面。

```
$("#test").hide(); 
```

# python - 为了在 MySQL 数据库中启用 djangodblog 进行错误日志记录，需要哪些选项？

> ID：13961714
> 
> 赞同：1
> 
> 时间：2012-12-19T21:41:54.497
> 
> 标签：python, mysql, django

我想问一个关于用于将实时 Django 异常记录到应用程序数据库中的 djangodblog 的问题。我使用以下工具

**数据库：** 5.5.28 MySQL 社区服务器

**操作系统**：Fedora Core 17 (X86_64)

**Django** 1.4.2

**Python** 2.7.3

根据我在 Jim McGaw 的书中读到的内容：“Beginning Django E-Commerce”，我定义了我的 settings.py，包括以下项目：

```
DEBUG = False
.
.
.
MIDDLEWARE_CLASSES = (
    'django.middleware.common.CommonMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.middleware.csrf.CsrfViewMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'django.contrib.messages.middleware.MessageMiddleware',
    # Uncomment the next line for simple clickjacking protection:
    # 'django.middleware.clickjacking.XFrameOptionsMiddleware',
    #'djangodblog.DBLogMiddleware',
    djangodblog.middleware.DBLogMiddleware',
)
.
.
.
INSTALLED_APPS = (
    #'django.contrib.auth',
    #'django.contrib.contenttypes',
    #'django.contrib.sessions',
    #'django.contrib.sites',
    #'django.contrib.messages',
    #'django.contrib.staticfiles',
    # Uncomment the next line to enable the admin:
    # 'django.contrib.admin',
    # Uncomment the next line to enable admin documentation:
    # 'django.contrib.admindocs',
    'djangodblog',
) 
```

一旦我跑

```
python -tt manage.py syncdb 
```

所有表均已成功创建（我通过连接到数据库进行了检查）。但是，**djangodblog 似乎没有激活，因为只要有异常就没有插入行**。例如，假设您指定了一个尚不存在的模板，或者该模板的目录路径不正确。在这种情况下，Django 会引发异常，例如 TemplateDoesNotExist（如果项目 settings.py 中的 DEBUG 设置为 True，您可以在浏览器中看到打印错误 StackTrace）。

因此，我想问是否有任何进一步的参数来定义/启用？为了强制Django实时更新MySQL中的错误日志？

问候，

# c++ - c ++在具有不同地图的新类中重复行为

> ID：13961716
> 
> 赞同：1
> 
> 时间：2012-12-19T21:41:58.820
> 
> 标签：c++, design-patterns, stl

如果我有两个类 A 和 B 定义为：

```
class A {
    map<int, int> mMap;
    vector<int> mVec;

    void method() {
      // do something with mMap and mVec 
    }
}

class B {
    map<int, double> mMap; // just an example of a map with a different signature

    ...
} 
```

有可能以某种方式使用 A 在 B 中的所有内容，但使用 B 中定义的新映射并且无需重写`method`？

这是我正在尝试做的一个简化示例：使用新地图重构一个大类。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T21:58:53.357

如果你想使用

```
std::map<int, Y> 
```

代替

```
std::map<int, X> 
```

使用相同的代码，替换`class A`为，那么类型和`class B`之间可能存在很强的相关性。`X``Y`

在这种情况下，如果您不能在 上使用模板`class A`，一种可能的解决方法是分别为`Y`和`X`to`X`和定义隐式类型转换运算符`Y`。

```
class X {
    operator Y() {
        Y y;
        // Conversion logic
        return y;
    }
}; 
```

通过这样做，您无需更改代码，`method`因为映射上的插入或访问操作将自动调用隐式类型转换运算符。

警告说明：隐式转换运算符的滥用削弱了编译器的类型安全检查，您可能期望在代码的其他部分进行类型安全检查（例如：`Y`传递给的错误参数`f(X &x)`）。

# jquery - 这个 jQuery 选择器到底在做什么？$(' ', { ... });

> ID：13961717
> 
> 赞同：3
> 
> 时间：2012-12-19T21:41:59.330
> 
> 标签：jquery

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-19T21:43:46.387

它正在生成一个 DOM 对象。

这类似于做

```
$("<a id='specialId'></a>") .... 
```

然后你可以用它来 .appendTo 别的东西！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-19T21:44:33.663

它创建一个新元素`<a>`，设置其选项（id、href 等）并将其附加到`#specialDivId`

# java - 如何从命令行优雅地杀死firefox

> ID：13961724
> 
> 赞同：2
> 
> 时间：2012-12-19T21:42:23.290
> 
> 标签：java, firefox, ubuntu, automation

我正在编写一个需要打开 URL 列表的程序。我在Ubuntu12.04上有firefox，每次杀了firefox再重新打开，都会有一条消息询问我是否要恢复以前的会话，这很烦人。

我调用 firefox(in Java) 使用

```
Runtime r= Runtime.getRuntime();
r.exec("firefox -new-instance www.google.com"); 
```

并使用杀死它

```
r.exec("killall firefox"); 
```

有没有办法更优雅地杀死和重新打开 Firefox？我希望程序在没有任何弹出消息或人工干预的情况下自动运行。非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T21:52:10.243

我认为你不能从 Java 中优雅地杀死 Firefox，但你可以更改你的 Firefox 设置，这样它就不会在每次重新打开时询问你。

请参阅对您有所帮助的[Firefox 恢复选项](http://kb.mozillazine.org/Session_Restore)链接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T21:57:16.380

使用[WebDriver](http://seleniumhq.org/projects/webdriver/)加载和停止[Firefox](http://code.google.com/p/selenium/wiki/FirefoxDriver)。您可以使用单独的配置文件获取单独的 Firefox 实例。不会要求您恢复会话。

```
FirefoxProfile fp = new FirefoxProfile();
WebDriver driver = new FirefoxDriver(fp);
driver.get(url); 
```

然后关闭浏览器和所有子窗口：

```
driver.quit(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T21:52:22.863

与其直接启动 firefox，不如启动一个在后台启动 firefox 的 shell 脚本，然后在标准输出上打印 firefox 进程的 PID。

`Process`然后你可以通过返回的对象读回PID`Runtime.exec()`

# jquery - jquery easyui 事件以编程方式或由用户

> ID：13961726
> 
> 赞同：1
> 
> 时间：2012-12-19T21:42:29.217
> 
> 标签：jquery, jquery-easyui

假设我有一个包含数据列表的[jQuery EasyUI 组合框。](http://www.jeasyui.com/documentation/combobox.php)如何检测用户或以编程方式从该组合框中进行了选择？我知道他们说我可以通过查找来检测到，`event.originalEvent`但是当用户从组合框中进行选择时（或以编程方式触发事件时），我似乎无法找到该属性

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T21:51:40.023

如果用户进行了操作，那么您的元素将被聚焦。因此，您可以使用 jquery .focus() 检测它，它将事件处理程序绑定到“焦点”JavaScript 事件，或在元素上触发该事件。

要了解更多信息，您可以查看： [http ://api.jquery.com/focus/](http://api.jquery.com/focus/)

# bittorrent - 通过 bittorrent 播种时使用文件

> ID：13961728
> 
> 赞同：1
> 
> 时间：2012-12-19T21:42:35.280
> 
> 标签：bittorrent

可以在其他程序中使用文件同时通过比特洪流播种吗？如果这些文件是 dll 或 exe 怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T21:45:38.693

好吧，这是一个奇怪的问题，但到目前为止，如果多个程序只是读取一个应该可以正常工作的文件（非独占）。

但我无法告诉您您的 bittorrent 客户端是否使用独占读/写锁。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T07:06:12.567

假设您没有修改文件，则可以在播种文件时使用它们。为了减轻程序修改文件的问题（例如媒体播放器更改 id3 标签），uTorrent（可能还有其他客户端）以独占写入模式保持文件打开，以防止其他进程修改文件。如果您尝试打开文件的程序能够胜任，它可能会忽略修改文件的失败，而只是读取它们（这很好）。

# c - MPI：变量不增加

> ID：13961729
> 
> 赞同：1
> 
> 时间：2012-12-19T21:42:36.907
> 
> 标签：c, mpi

我试图了解 MPI 的工作原理。因此，我从一个小例子开始：

```
...
MPI_Comm_rank(MPI_COMM_WORLD, &tid);
MPI_Comm_size(MPI_COMM_WORLD, &nthreads);

int message = 2;

if(tid != 0)
{
    MPI_Recv(&rec, 1, MPI_INT, tid-1, 0, MPI_COMM_WORLD, &status);
    printf("Process %i receive %i\n", tid, rec);
}

if(tid != nthreads-1)
{
    message++;
    printf("Process %i sends %i\n", tid, message);
    MPI_Send(&message, 1, MPI_INT, tid+1, 0, MPI_COMM_WORLD);
}
... 
```

尽管`message`看起来确实增加到 3 以上，但效果很好。为什么会这样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T21:59:51.613

MPI 等级不是线程，它们是——嗯——“等级”，或者有时用 MPI 来说是处理元素，但一般来说是进程。

这通常是一个小细节，但在这里我认为它实际上反映了潜在的混乱。如果在 OpenMP 中（比如说）你有以下代码

```
int message = 0;

#pragma omp parallel default(none) shared(message)
{
   int tid = omp_get_thread_num();
   if (tid != nthreads-1) {
       #pragma omp atomic
       message++;
   }
} 
```

然后在并行部分结束时，消息实际上会增加`OMP_NUM_THREADS-1`次数。

但是 MPI 不是线程；当您使用`mpiexec`or启动程序时`mpirun`，会启动 n 个任务，并且每个任务都会在自己的进程中运行完全相同的程序——例如，没有共享变量。特别是，每个任务都有自己的变量`message`，并且该变量在上面的代码片段中最多会增加一次，这意味着`message`在发布的代码末尾始终是 2 或 3。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T22:00:33.083

`mpirun -np N`命令启动`N`MPI 进程，而不是一个具有`N`线程的进程。在每个进程中，您都有变量`message`，并且每个进程都有自己的变量设置为 2。下一个第 0 个进程将其发送`message == 3`到第一个进程。之后，第一个进程发送他自己的`message == 3`，第二个进程捕获它......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-20T13:08:44.803

我强烈怀疑您想要的可以通过以下代码实现：

```
int message = 2;

if(tid != 0)
{
   MPI_Recv(&message, 1, MPI_INT, tid-1, 0, MPI_COMM_WORLD, &status);
   printf("Process %i receive %i\n", tid, message);
}

if(tid != nthreads-1)
{
   message++;
   printf("Process %i sends %i\n", tid, message);
   MPI_Send(&message, 1, MPI_INT, tid+1, 0, MPI_COMM_WORLD);
} 
```

因此，每个进程（除了 rank 0）都会从前一个 rank 接收值，将其递增 1，然后将其传递给下一个 rank（最后一个 rank 除外）。例如：

*   等级 0 发送`2`到等级 1
*   rank 1`2`从 rank 0 接收，递增并发`3`送到 rank 2
*   rank 2`3`从 rank 1 接收，递增并发`4`送到 rank 3
*   ...
*   rank *nthreads* -1`2+nthreads-1`从 rank *nthreads* -2接收

# sql - 带有时区顺序的 OSX postgres 9.1.4 时间戳

> ID：13961732
> 
> 赞同：1
> 
> 时间：2012-12-19T21:42:50.160
> 
> 标签：sql, postgresql, timezone

在 postresql 服务器 9.1.4 上的 OSX 10.8 是一个意外行为。因为在 Ubuntu 12.04 上它是正确的。

要重现此问题，请使用以下 postgres sql 示例数据库。注意：时间戳值是在时区“欧洲/柏林”中选择的，时间戳是在[2012 年](http://timeanddate.com/worldclock/clockchange.html?n=37)DST 结束时进行的，本次测试就是这种情况。

```
BEGIN;
DROP TABLE data;
CREATE TABLE data (
"id" int8 NOT NULL,
"timestampwithtimezone" timestamp(6) WITH TIME ZONE,
CONSTRAINT "data_pkey" PRIMARY KEY ("id")
);
COMMIT;

BEGIN; 
INSERT INTO data (id, timestampwithtimezone) VALUES (205,'2012-10-28 01:30:00+02');
INSERT INTO data (id, timestampwithtimezone) VALUES (204,'2012-10-28 02:00:00+02');
INSERT INTO data (id, timestampwithtimezone) VALUES (203,'2012-10-28 02:30:00+02');
INSERT INTO data (id, timestampwithtimezone) VALUES (202,'2012-10-28 02:59:59+02');
INSERT INTO data (id, timestampwithtimezone) VALUES (106,'2012-10-28 02:00:00+01');
INSERT INTO data (id, timestampwithtimezone) VALUES (107,'2012-10-28 02:30:00+01');
INSERT INTO data (id, timestampwithtimezone) VALUES (108,'2012-10-28 02:59:59+01');
INSERT INTO data (id, timestampwithtimezone) VALUES (109,'2012-10-28 03:00:00+01');
INSERT INTO data (id, timestampwithtimezone) VALUES (110,'2012-10-28 03:30:00+01');
COMMIT; 
```

* * *

如果我键入以下 SQL 查询，它只查找给定时间戳之前的最后一个存在的时间戳：

```
SELECT id, timestampwithtimezone at time zone 'Europe/Berlin' as timestampwithtimezone
FROM data
WHERE 
timestampwithtimezone at time zone 'Europe/Berlin' 
< cast('2012-10-28T02:30:00.000+01' AS timestamp)
ORDER BY timestampwithtimezone DESC 
LIMIT 1; 
```

我的预期结果是：

║ 106 ║ 2012-10-28 02:00:00 ║</p>

因为我想要给定 (2012-10-28T02:30:00.000+01) 时间戳之前的最后一个时间戳。但结果包含：

║ 204 ║ 2012-10-28 02:00:00 ║</p>

在这种情况下，postgresqls 排序似乎是错误的。在 Ubuntu 下，我得到了正确的答案，即 id: 106 而不是 204。

但：

如果我设置了这个查询：（唯一的区别是我将结果集映射到时区）：

```
SELECT id, timestampwithtimezone
FROM data
WHERE timestampwithtimezone at time zone 'Europe/Berlin' 
< cast('2012-10-28T02:30:00.000+01' AS timestamp)
ORDER BY timestampwithtimezone DESC 
LIMIT 1; 
```

OSX 10.8 和 Ubuntu 12.04 中的结果集与预期的一样：

║ 106 ║ 2012-10-28 02:00:00+01 ║</p>

为什么操作系统版本之间存在差异？在这种情况下，此查询的答案“204”确实是错误的。但是，如果我将时间戳映射到时区，为什么结果集会有所不同？据我所知，postgresql 在内部使用 UTC 来存储时间戳。所以 DST 在时间线上应该不是问题。为什么会发生这种情况？

提前感谢，希望得到回应。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T22:52:44.443

之前的回答是错误的。

根据你的数据。两个答案都很好。

2012-10-28 有时间从夏令时更改为冬令时（[这里解释](https://dba.stackexchange.com/questions/30787/at-time-zone-with-zone-name-postgresql-bug)）。

查看此结果中的小时数：

```
select id, 
  timestampwithtimezone, 
  timestampwithtimezone at time zone 'Europe/Berlin' as berlin  
from data 
order by berlin ;

 id  | timestampwithtimezone  |       berlin        
-----+------------------------+---------------------
 205 | 2012-10-28 01:30:00+02 | 2012-10-28 01:30:00
 204 | 2012-10-28 02:00:00+02 | 2012-10-28 02:00:00
 106 | 2012-10-28 02:00:00+01 | 2012-10-28 02:00:00
 203 | 2012-10-28 02:30:00+02 | 2012-10-28 02:30:00
 202 | 2012-10-28 02:59:59+02 | 2012-10-28 02:59:59 
```

id 为 204 和 106 的记录在 berlin 列中具有相同的值。

[从这里](https://dba.stackexchange.com/questions/30787/at-time-zone-with-zone-name-postgresql-bug)阅读问题和答案。

如果您想按 timestamptz 排序，请不要使用列的别名作为同名

```
SELECT 
  id, 
  timestampwithtimezone at time zone 'Europe/Berlin' as timestampwithtimezone_alias
FROM data
WHERE 
  timestampwithtimezone at time zone 'Europe/Berlin' 
  < cast('2012-10-28T02:30:00.000' AS timestamp)
ORDER BY timestampwithtimezone DESC 
LIMIT 1; 
```

# c# - 将文本显示为标签时丢失格式

> ID：13961735
> 
> 赞同：0
> 
> 时间：2012-12-19T21:43:09.967
> 
> 标签：c#, asp.net

我有一个多行文本框，用作描述字段。可以使用空格和回车向此文本框添加大量信息。以段落格式。当我稍后显示此文本时，`Label`我失去了所有格式，它变成了一堵文本墙。我能做些什么来保持原始格式吗？

```
var customerInfo = GetCustomerInfo(itemid);

                if (customerInfo != null)
                {
                    ItemID.Text = customerInfo.ItemID.ToString();

                    Description.Text = customerInfo.Description;

                } 
```

页面来源看起来像这样

```
 This is a test

this is a test 

this is a test
1\. test
2\. test
3\. test
4\. tes 
```

标签/文字看起来像这样

```
This is a test this is a test  this is a test 1\. test 2\. test 3\. test 4\. tes 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T21:52:08.760

当您在 HTML 中显示格式化的文本时，它不会显示为格式化的，因为 HTML 有其他格式化文本的方法。所有格式化字符（换行符、制表符等）在 HTML 中都算作空格，因此它只会显示为一大块文本。

要显示 HTML 格式的文本，您必须将格式转换为 HTML 用于格式化的格式，例如：

```
label.Text = myText.Replace("\r\n", "<br>").Replace("\t", "&nbsp;&nbsp;&nbsp;&nbsp;"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T21:51:07.517

如果您不发布其他内容，我不太确定，但这应该会有所帮助

```
 Label1.Text = HttpUtility.HtmlEncode(myStringFromTxtBox); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T21:55:51.333

问题是原始文本将有回车 - 这将根据操作系统而有所不同 - 用于行分隔符，但在 HTML 中，您需要翻译它们`<br />`以保持相同的格式。

此外，标签控件呈现为跨度。您可能最好使用常规 div 并`runat="server"`在它们上设置属性，以便您可以以编程方式分配内容。

Guffa 对其他字符（制表符、空格等）提出了另一个好观点。所有这些都需要翻译成 HTML 等价物。

# android - 自顶向下布局

> ID：13961736
> 
> 赞同：3
> 
> 时间：2012-12-19T21:43:11.823
> 
> 标签：android, android-layout, tablelayout

对于一个应用程序，我想从上到下设计布局：从全屏大小开始，将屏幕大小拆分为网格并将控件放置在该网格中的固定位置等。对我来说，这似乎是最简单的方法设计适合几乎所有屏幕尺寸的应用程序。理想情况下，我也想缩放其他东西：Cornerroundings、fontsizes 等。

到目前为止，我的印象是 Android 不想支持这种方法：几乎所有东西都有缩放机制，但它变得非常丑陋：LinearLayout 和 TableLayout 支持权重，所以我可以很好地使用它们，但如果我想要边距随着屏幕尺寸缩放我需要很多嵌套布局。这有什么设计原因吗？实现类似于 AbsoluteLayout 的布局应该非常简单，但一切都基于可用屏幕尺寸的一小部分，但不存在这样的东西。

为什么不？是否有某种原因为什么人们不想要这样的东西，或者只是没有人费心去实现它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T21:49:12.183

对于随屏幕尺寸缩放的布局，不要使用像素来指定尺寸。改用“dp”单位（或倾角）。这个单元是独立于密度的，所以当你让你的布局完全适合模拟器屏幕尺寸时，Android 会为你处理缩放，它适用于小到便宜手机 (320x240px) 的屏幕到大到10" 平板电脑。您当然需要提供各种分辨率的图像，因为图像缩放总是很快变得非常糟糕。

来自官方 Android 开发者网站：

> 用像素定义布局尺寸是一个问题，因为不同的屏幕具有不同的像素密度，因此相同数量的像素可能对应不同设备上的不同物理尺寸。因此，在指定尺寸时，请始终使用 dp 或 sp 单位。dp 是与密度无关的像素，对应于 160 dpi 像素的物理尺寸。sp 是相同的基本单位，但按用户首选的文本大小（它是与比例无关的像素）进行缩放，因此在定义文本大小时应使用此测量单位（但绝不用于布局大小）。

在同一页面中，他们展示了如何为各种屏幕密度提供图像：

[http://developer.android.com/training/multiscreen/screendensities.html](http://developer.android.com/training/multiscreen/screendensities.html)

# javascript - 在 Requirejs 中使用 Meteor

> ID：13961737
> 
> 赞同：11
> 
> 时间：2012-12-19T21:43:16.033
> 
> 标签：javascript, requirejs, meteor, amd

如何将 requirejs 集成到流星应用程序中并使用 AMD 模块，例如用于我的 Backbone 模块？有没有人这样做并且可以告诉我需要哪些步骤才能使其正常工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T21:47:10.133

一个简单的答案（尽管可能不是您要寻找的答案）是您可以简单地独立使用这两者。换句话说，加载所有流星脚本，然后开始加载所需的脚本。您的 require-ified 脚本将能够很好地使用 Meteor 的东西，而不必通过 Require 的加载器“导入”任何它。

如果你*想*导入它，你应该为它创建一个 Require "shim"。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-11T14:02:35.227

这是我在 Meteor 和 IronRouter 中加载[Aloha Editor的方法。](http://www.aloha-editor.org/Content.Node/index.html)Aloha 使用**requirejs**来加载它的所有依赖项。

1.  **在public/alohaeditor**中解压 Aloha 发行版。
2.  将除 aloha-common-extra.css 之外的所有 Aloha css 文件移动到**client/lib/alohaeditor**（不要忘记插件文件夹中的文件）。
3.  在所有 Aloha css 文件中，将相对路径转换为绝对路径（将所有 '../' 替换为 '/alohaeditor/'）。
4.  安装[wait-on-lib](https://github.com/DerMambo/wait-on-lib) Meteor 包。
5.  将以下钩子添加到您的路线：

    ```
    onBeforeAction: function(pause)
        {           
        // Dynamically load require.js
        var one = IRLibLoader.load('/alohaeditor/lib/require.js', 
            {
            success: function(){ console.log('Successfully loaded require.js'); },
            error: function(){ console.log('Error loading require.js'); }
            });
        if(!one.ready())
            return pause();

        // Aloha settings
        Aloha = window.Aloha || {};
        Aloha.settings = Aloha.settings || {};
        Aloha.settings.baseUrl = '/alohaeditor/lib/';
        Aloha.settings.plugins = Aloha.settings.plugins || {};
        Aloha.settings.plugins.load = 'common/ui, common/format, common/link, common/table, common/list, common/block, common/undo, common/contenthandler, common/paste, common/commands, common/abbr';

        // Dynamically load aloha.js
        var two = IRLibLoader.load('/alohaeditor/lib/aloha.js',
            {
            success: function(){ console.log('Successfully loaded aloha.js'); },
            error: function(){ console.log('Error loading aloha.js'); }
            });
        if(!two.ready())
            return pause();
        }, 
    ```

# iphone - 如果设备已经在播放音乐，如何防止我的应用播放声音

> ID：13961738
> 
> 赞同：0
> 
> 时间：2012-12-19T21:43:17.807
> 
> 标签：iphone, ios, audio

我正在开发一个 iPhone 应用程序，它将根据用户的要求播放自己的声音。

我的问题是如果设备已经在播放音乐，我如何在启动时禁用我的应用程序中的声音？

我知道我必须检测设备是否已经在播放音乐，但我该怎么做呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T23:26:45.013

您可以像这样激活音频会话：

```
[[AVAudioSession sharedInstance] setCategory:AVAudioSessionCategoryPlayback error:nil];
[[AVAudioSession sharedInstance] setActive: YES error: nil]; 
```

或者您可以创建一个`[MPMusicPlayerController iPodMusicPlayer]`实例并暂停音乐，但这不会暂停其他应用程序中正在播放的音乐。

**编辑**

如果您想检查 iPod 是否正在播放音乐，那么您可以执行以下操作：

```
MPMusicPlayerController *musicPlayer = [MPMusicPlayerController iPodMusicPlayer];
if ([musicPlayer playbackState] == == MPMusicPlaybackStatePlaying)
   //iPod is playing music, do something here
} 
```

您需要添加`MediaPlayer`框架。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-31T00:05:52.413

要检查您是否已经在播放音乐，您可以执行以下操作：

```
(YES == ((AVAudioSession *)[AVAudioSession sharedInstance]).otherAudioPlaying) 
```

# python - 为什么 python 的 os.stat() 告诉我我的文件组是空的？

> ID：13961753
> 
> 赞同：3
> 
> 时间：2012-12-19T21:44:22.260
> 
> 标签：python

我在 Solaris 5-10 上使用 python 2.6.4。

我有一个名为“myFile”的文件。它归其他人所有，我（“myuser”）在文件的组（“mygrp”）中。下面是我的python代码。为什么它告诉我 mygrp 没有成员？？？

```
>>> import os, pwd, grp 
>>> stat_info = os.stat("myFile") 
>>> fileUID = stat_info.st_uid 
>>> fileGID = stat_info.st_gid 
>>> fileGroup = grp.getgrgid(fileGID)[0] 
>>> fileUser = pwd.getpwuid(fileUID)[0] 
>>> print "grp.getgrgid(fileGID) = %s" % grp.getgrgid(fileGID) 
grp.getgrgid(fileGID) = grp.struct_group(gr_name='mygrp', gr_passwd='', gr_gid=100, gr_mem=[]) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T22:13:41.797

根据[文档](http://docs.python.org/2/library/grp.html)（强调我的）：

> gid是整数，name和password是字符串，member list是字符串列表。（**请注意，根据密码数据库，大多数用户并未明确列为他们所在组的成员。检查两个数据库以获取完整的成员信息。**另请注意，以 + 或 - 开头的 gr_name 可能是 YP /NIS 参考，可能无法通过 getgrnam() 或 getgrgid() 访问。）

这或许可以解释为什么您没有在结果中列出，即使您是该组的成员。我相信您必须使用[`pwd.getpwall`](http://docs.python.org/2/library/pwd.html#module-pwd)并过滤它以获取组 ID，以获取该组的其余成员。

**更新：**根据OP 在评论中发布的[链接](https://groups.google.com/forum/?fromgroups=#!topic/comp.lang.python/yzeXZRLRnWY)进一步解释：

> 每个帐户都有一个主要组，有些帐户还具有附加组。主要组是 pwd 条目中 .pw_gid 属性中的组。其他组是那些在其 grp 条目中的 .gr_mem 属性中提及该帐户的组。

检索组的所有成员的示例代码：

```
def all_members(gid):
    primary_members = [user.pw_name for user in pwd.getpwall() if user.pw_gid == gid]
    additional_members = grp.getgrgid(gid).gr_mem
    return primary_members + additional_members 
```

# canvas - Delta timimg 画布在尝试绘制心跳时被踩踏

> ID：13961770
> 
> 赞同：0
> 
> 时间：2012-12-19T21:45:20.337
> 
> 标签：canvas, html5-canvas

我对画布和增量时间更新非常陌生，所以请原谅我的无知。我正在尝试重新创建心率监视器（jsfiddle 中显示的屏幕截图，理想的最终渲染匹配[https://www.youtube.com/watch?v=ew6Jp74vaN4](https://www.youtube.com/watch?v=ew6Jp74vaN4)）

我无法弄清楚为什么它似乎如此零星地行动，尤其是在调整浏览器大小或执行其他操作时（我认为增量计时背后的想法是它消除了延迟）

[http://jsfiddle.net/alexcroox/CjCkV/](http://jsfiddle.net/alexcroox/CjCkV/)

我正在使用 dt 来计算何时需要移动到下一个点

```
var distance = Math.sqrt(
    (nextPosition.x-lastPosition.x)*(nextPosition.x-lastPosition.x) +
    (nextPosition.y-lastPosition.y)*(nextPosition.y-lastPosition.y)
);

var duration = distance/this.speed;
var t = this.totalTime/duration;
var x = (1.0 - t)*lastPosition.x + t*nextPosition.x;
var y = (1.0 - t)*lastPosition.y + t*nextPosition.y; 
```

我确实有一个只使用计数器和 sin 的更平滑的版本，但有人告诉我它不会那么平滑或灵活（我最终想淡出“尾巴”）

[http://jsfiddle.net/alexcroox/AZ9zC/](http://jsfiddle.net/alexcroox/AZ9zC/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T22:32:38.560

我在下面简化了代码。这是演示（代码混乱）[http://jsfiddle.net/CjCkV/19/](http://jsfiddle.net/CjCkV/19/)

```
Game.prototype.renderBeat = function()
{
    // Get our current/target positions
    var position = this.points[this.nextPoint];
    var lastPosition = this.points[this.currentPoint] || position;

    var x = 0;
    var y = position.y;

    this.context.beginPath();
    this.context.moveTo(x+1, lastPosition.y);
    this.context.lineTo(x, position.y);
    this.context.closePath();

    this.context.stroke();

    if (this.points[this.currentPoint]){        
         this.nextPoint = this.currentPoint;
    }

    // slowly fade out trail
    this.context.fillStyle = "rgba(0,0,0,.01)";
    this.context.fillRect(-this.translated, 0, this.canvas.width, this.canvas.height);

    // this allows us to only care about the amplitude of the wave. 
    this.context.translate(1,0);
    this.translated += 1;

    this.currentPoint++;

    // if we've reached the last point in our array, loop around
    if(this.currentPoint > this.points.length)
    {   
        // random death (this randomly unsets any point except the first, slowing eliminating the "pulse"
        this.points[Math.floor(Math.random()*(this.points.length-2)+1)] = undefined;

        this.currentPoint = 0;
        this.nextPoint = 0;

        if (this.translated > this.canvas.width){
            this.context.translate(-this.translated, 0);
            this.translated = 0;
        }
    }
}; 
```

# gcc - GNU gcc/ld - 使用在同一个目标文件中定义的调用者和被调用者包装对符号的调用

> ID：13961774
> 
> 赞同：45
> 
> 时间：2012-12-19T21:45:28.823
> 
> 标签：gcc, linker, mocking, ld, interceptor

澄清一下，我的问题是指当调用者和被调用者与 GCC 编译器和链接器**在同一个编译单元中定义时，包装/拦截从一个函数/符号到另一个函数/符号的调用。**

我的情况类似于以下情况：

```
/* foo.c */
void foo(void)
{
  /* ... some stuff */
  bar();
}

void bar(void)
{
  /* ... some other stuff */
} 
```

我想包装对这些函数的调用，我可以用[ld 的`--wrap`选项](http://ftp.gnu.org/old-gnu/Manuals/ld-2.9.1/html_node/ld_3.html)（在一定程度上）做到这一点（然后我实现 __wrap_foo 和 __wrap_bar ，它们依次调用 __real_foo 和 __real_bar ，正如 ld`--wrap`选项的结果所期望的那样）。

```
gcc -Wl,--wrap=foo -Wl,--wrap=bar ... 
```

我遇到的问题是，这只对**来自**此编译单元外部的 foo 和 bar 的引用生效（并在链接时解决）。也就是说，从**foo.c**中的其他函数调用 foo 和 bar不会被包装。

![编译单元内的调用在链接器包装之前得到解决](../Images/06813dfe75f0595ff1b30a420a4702b8.png)

我尝试使用[objcopy --redefine-sym](http://sourceware.org/binutils/docs/binutils/objcopy.html)，但这只会重命名符号及其引用。

在我将 *.o 文件传递​​给链接器选项之前，我想将调用`foo`和`bar`（在 foo.o 中）替换为`__wrap_foo`和`__wrap_bar`（就像它们在其他目标文件中通过链接器选项解析一样） ，而无需修改 foo .c 的源代码。`--wrap``--wrap`

这样，所有对`foo`and的调用都会发生包装/拦截`bar`，而不仅仅是发生在 foo.o 之外的调用。

这可能吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2017-09-07T19:28:19.493

您必须使用 objcopy 弱化和全球化符号。

```
-W symbolname
--weaken-symbol=symbolname
    Make symbol symbolname weak. This option may be given more than once.
--globalize-symbol=symbolname
    Give symbol symbolname global scoping so that it is visible outside of the file in which it is defined. This option may be given more than once. 
```

这对我有用

酒吧.c：

```
#include <stdio.h>
int foo(){
  printf("Wrap-FU\n");
} 
```

富.c：

```
#include <stdio.h>

void foo(){
printf("foo\n");
}

int main(){
printf("main\n");
foo();
} 
```

编译它

```
$ gcc -c foo.c bar.c 
```

弱化 foo 符号并使其全局化，以便它再次可用于链接器。

```
$ objcopy foo.o --globalize-symbol=foo --weaken-symbol=foo foo2.o 
```

现在您可以将新 obj 与 bar.c 中的 wrap 链接起来

```
$ gcc -o nowrap foo.o #for reference
$ gcc -o wrapme foo2.o bar.o 
```

测试

```
$ ./nowrap 
main
foo 
```

还有包裹的：

```
$ ./wrapme 
main
Wrap-FU 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2017-11-09T12:05:49.830

您可以`__attribute__((weak))`在被调用者的实现之前使用，以便让某人重新实现它，而无需 GCC 对多个定义大喊大叫。

例如，假设您想模拟`world`以下*hello.c*代码单元中的函数。您可以预先添加属性以便能够覆盖它。

```
#include "hello.h"
#include <stdio.h>

__attribute__((weak))
void world(void)
{
    printf("world from lib\n");
}

void hello(void)
{
    printf("hello\n");
    world();
} 
```

然后您可以在另一个单元文件中覆盖它。对于单元测试/模拟非常有用：

```
#include <stdio.h>
#include "hello.h"

/* overrides */
void world(void)
{
    printf("world from main.c"\n);
}

void main(void)
{
    hello();
    return 0;
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2015-02-27T22:23:07.163

```
#include <stdio.h>
#include <stdlib.h>

//gcc -ggdb -o test test.c -Wl,-wrap,malloc
void* __real_malloc(size_t bytes);

int main()
{
   int *p = NULL;
   int i = 0;

   p = malloc(100*sizeof(int));

   for (i=0; i < 100; i++)
       p[i] = i;

   free(p);
   return 0;
}

void* __wrap_malloc(size_t bytes)
{
      return __real_malloc(bytes);
} 
```

然后只需编译此代码并进行调试。当你调用 realll malloc 时，被调用的函数会 __wrap_malloc 和 __real_malloc 会调用 malloc。

我认为这是拦截电话的方式。

基本上它是 ld 提供的 --wrap 选项。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-12-23T15:43:44.370

这似乎按记录工作：

```
 --wrap=symbol
       Use a wrapper function for symbol. 
       Any undefined reference to symbol will be resolved to "__wrap_symbol". ... 
```

注意上面的**未定义**。当链接器处理`foo.o`时，`bar()`不是*未定义*的，因此链接器不会包装它。我不确定*为什么*要这样做，但可能有一个用例需要这样做。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-11-18T02:43:03.380

`--undefined`如果您使用with ，您可以实现您想要的`--wrap`

```
 -u SYMBOL, --undefined SYMBOL
                              Start with undefined reference to SYMBOL 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2020-03-09T16:01:36.023

我已经尝试了@PeterHuewe[的](https://stackoverflow.com/users/8576513/peterhuewe)[解决方案](https://stackoverflow.com/a/46103766/4979084)，它可以工作，但它不允许从包装器中调用原始函数。为此，我的解决方案如下：

**foo.c**

```
 #include <stdio.h>

void foo(){
    printf("This is real foo\n");
}

int main(){
    printf("main\n");
    foo();
} 
```

**foo_hook.c**

```
#include <stdio.h>

void real_foo();

int foo(){
  printf("HOOK: BEFORE\n");
  real_foo();
  printf("HOOK: AFTER\n");
} 
```

**生成文件**

```
all: link

link: hook
    gcc -o wo_hook foo.o
    gcc -o w_hook foo_hooked.o foo_hook.o

hook: build_o
    objcopy \
    foo.o \
    --add-symbol real_foo=.text:$(shell  objdump -t foo.o | grep foo | grep .text | cut -d' ' -f 1),function,global \
    --globalize-symbol=foo \
    --weaken-symbol=foo \
    foo_hooked.o

build_o:
    gcc -c foo.c foo_hook.c

clean:
    -rm w_hook wo_hook *.o 
```

**例子**

```
virtualuser@virtualhost:~/tmp/link_time_hook$ make
gcc -c foo.c foo_hook.c
objcopy foo.o \
--add-symbol real_foo=.text:0000000000000000,function,global \
--globalize-symbol=foo \
--weaken-symbol=foo \
foo_hooked.o
gcc -o wo_hook foo.o
gcc -o w_hook foo_hooked.o foo_hook.o
virtualuser@virtualhost:~/tmp/link_time_hook$ ls
Makefile  foo.c  foo.o  foo_hook.c  foo_hook.o  foo_hooked.o  w_hook  wo_hook
virtualuser@virtualhost:~/tmp/link_time_hook$ ./w_hook
main
HOOK: BEFORE
This is real foo
HOOK: AFTER
virtualuser@virtualhost:~/tmp/link_time_hook$
virtualuser@virtualhost:~/tmp/link_time_hook$ ./wo_hook
main
This is real foo
virtualuser@virtualhost:~/tmp/link_time_hook$ 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-08-11T02:40:50.237

带链接器

```
$ /usr/bin/ld --version
GNU ld (GNU Binutils for Ubuntu) 2.30 
```

我能够使用以下`defsym`选项解决问题：

```
--defsym SYMBOL=EXPRESSION  Define a symbol` 
```

代替

```
gcc -Wl,--wrap=foo -Wl,--wrap=bar ... 
```

尝试

```
gcc -Wl,--defsym,foo=__wrap_foo -Wl,--defsym,bar=__wrap_bar ... 
```

我也没有尝试定义`__real_*`符号。

# ms-word - C# Word 互操作 - Range.HighlightColorIndex 返回 999999 - 这是有意的吗？

> ID：13961776
> 
> 赞同：3
> 
> 时间：2012-12-19T21:45:37.417
> 
> 标签：ms-word, office-interop

使用 Word 互操作 API，我有一个文档，我从中删除了以特定颜色突出显示的文本。归结起来，逻辑是这样的：

```
if(range.HighlightColorIndex == WdColorIndex.wdYellow)
{
    range.Delete();
} 
```

对于一些我注意到`range.HighlightColorIndex`返回值的文档：`999999`.

通过查看`WdColorIndex`枚举（这是属性的类型），我看到枚举是使用在 from to`HighlightColorIndex`区间内分配了一个值的元素实现的，这并没有解释返回的数字。`-1``16``999999`

此外，通过使用 Word，我注意到一些奇怪的行为。创建一个带有两条黄色高亮线的新文档——第一条包含文本和超链接，第二条只包含文本：

*   在第一次保存和关闭文档之前，Word 会在逐个选择它们时将每一行识别为以黄色突出显示。
*   保存、关闭并重新打开文档后，Word 不再将包含文本和超链接的行识别为突出显示，而仅包含文本的行仍被识别为突出显示。

打开文档后 Word 的高亮识别截图如下：

![可能的单词突出显示错误](../Images/6e330796ecfb206a58a9e55465b6459e.png)

从这项研究来看，这似乎是 Word 中的一个错误，但我想确保我没有在这里遗漏任何东西 - 所以，基本上，有没有人知道这是预期的行为还是错误，以及进一步，什么在给定情况下使用 Word Interop 时，一个合理的方法是处理它？

对于这种情况，我正在运行 Office 2010 和 Word 互操作 API 版本 14。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T13:46:29.533

Word 使用值 999999 来指示当前选择包含多个相应的格式。

在您的示例中，超链接表示为包含突出显示的运行的 Word 字段（按 Alt-F9 切换代码视图）。重新打开文档后，该字段本身没有应用突出显示。这不一定是 Word 中的错误，只是（超链接）字段的行为不记得字段级别的格式。

但是，您的实际任务似乎是从文档中删除突出显示的文本。这通常可以使用`Range.Find`Word 的对象更好地完成：

```
range.Find.ClearFormatting();
range.Find.ClearAllFuzzyOptions();
range.Find.Highlight = 1;
range.Find.Replacement.ClearFormatting();
range.Find.Replacement.Text = "";
range.Find.Wrap = Word.WdFindWrap.wdFindContinue;
range.Find.Execute(Replace: Word.WdReplace.wdReplaceAll); 
```

这是一个完整的示例程序，您可以使用它来删除突出显示：

```
using System;
using System.Linq;
using Word = Microsoft.Office.Interop.Word;

class Program
{
    static void Main(string[] args)
    {
        var fileName = args[0];

        var wordApp = new Word.Application();
        wordApp.Visible = true;
        var document = wordApp.Documents.Open(fileName);
        RemoveHighlightingEverywhere(document);
    }

    static void RemoveHighlightingEverywhere(Word.Document document)
    {
        foreach (Word.Range storyRange in document.StoryRanges)
        {
            var range = storyRange;
            while (range != null)
            {
                RemoveHighlightingFromRange(range);

                if (range.ShapeRange.Count > 0)
                {
                    foreach (Word.Shape shape in range.ShapeRange)
                    {
                        if (shape.TextFrame.HasText != 0)
                        {
                            RemoveHighlightingFromRange(
                                shape.TextFrame.TextRange);
                        }
                    }
                }
                range = range.NextStoryRange;
            }
        }
    }

    static void RemoveHighlightingFromRange(Word.Range range)
    {
        range.Find.ClearFormatting();
        range.Find.ClearAllFuzzyOptions();
        range.Find.Highlight = 1;
        range.Find.Replacement.ClearFormatting();
        range.Find.Replacement.Text = "";
        range.Find.Wrap = Word.WdFindWrap.wdFindContinue;
        range.Find.Execute(Replace: Word.WdReplace.wdReplaceAll);
    }
} 
```

# r - R 中的交互式 Web 仪表板

> ID：13961778
> 
> 赞同：1
> 
> 时间：2012-12-19T21:45:40.117
> 
> 标签：r, business-intelligence, interactive, dashboard, shiny

我们可以在 R 中创建一个交互式仪表板并将 html 链接发送给“非”R 用户吗？
如果可以的话，谁能告诉我这个过程。

我知道包“闪亮”有助于创建交互式仪表板，但最终用户必须在他的机器中安装 R 才能探索它。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-19T22:15:21.647

我们有一个闪亮的应用程序托管服务，目前处于测试阶段（[在此处注册](https://rstudio.wufoo.com/forms/shiny-server-beta-program/)）。

同样在 2013 年 1 月下旬，[我们将作为开源发布 Shiny Server](http://blog.rstudio.org/2012/12/04/shiny-update/)，因此您可以在自己的 Linux 服务器（或云等）上运行应用程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-07-10T19:26:05.067

使用 R 的仪表板和布局有几个选项。

*   为了在 R 中制作网格和组合绘图类型，ggplot2 的[facet_wrap](http://docs.ggplot2.org/0.9.3.1/facet_wrap.html)和[facet_grid](http://docs.ggplot2.org/0.9.3.1/facet_grid.html)很方便。为了能够通过 URL 共享它们，您可以使用[plotly ggplot2 图形转换器](https://plot.ly/ggplot2)。例如，我们可以[安装库](https://plot.ly/ggplot2/getting-started/)，然后运行以下代码段：

```
library(plotly)

dsamp <- diamonds[sample(nrow(diamonds), 1000), ]
qplot(carat, price, data=dsamp, colour=clarity)

py <- plotly()
py$ggplotly() 
```

响应是一个 URL，您可以将其设为[public 或 private](https://plot.ly/r/privacy/)。例如：[https](https://plot.ly/~chris/2223/price-vs-carat/) ://plot.ly/~chris/2223/price-vs-carat/ 。该图是用 D3.js 绘制的，并且是交互式的。您可以从浏览器嵌入、缩放、切换和查看悬停文本。您要发送给的人不需要 R 或 Shiny。

![在此处输入图像描述](../Images/13827e9b0ad2961621def30167073d3e.png)

[这些文档](http://ropensci.github.io/plotly-test-table/tables/0e3d5ca144d27d8416318824c1b6ec1421a51045/index.html)跟踪图形转换器的覆盖范围。

*   正如 Joe 所指出的，[Shiny](http://shiny.rstudio.com/)允许您使用 R 制作 Web 应用程序和仪表板。您可以连接到[ggplot2 图形转换器](https://plot.ly/ggplot2)，在 Shiny 中制作图形，然后将图形保存并共享为 Plotly URL。这是一个带有代码示例[的教程。](http://moderndata.plot.ly/dashboards-in-r-with-shiny-plotly/)您发布的应用程序允许您缩放、切换、过滤、平移和查看悬停时的数据，例如：

    ![在此处输入图像描述](../Images/96c9f6fe9729114eba9ca4765585a535.png)

    免责声明：我在 Plotly 团队中。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-12-19T23:11:38.230

你不用 R 创建网页，而是用 HTML、CSS 和 Javascript 创建网页。

你能从 R 中创建 HTML、CSS 和 Javascript 吗？是的。

你能提供来自 R 的网页吗？是的。

R 有一个内置的 Web 服务器，主要用于提供内部帮助页面，但您可以将应用程序移植到它上面。还有用于更复杂的 Web 应用程序的“rook”包。

学习使用 rook 编写“Hello World”页面，然后再联系我们。否则这个问题太宽泛了，你没有做太多研究，我会投票关闭它。

# python - 如何通过python中的套接字建立连接？

> ID：13961783
> 
> 赞同：1
> 
> 时间：2012-12-19T21:45:57.870
> 
> 标签：python, sockets, recv

我有以下脚本，我希望连接到我们的产品，发送 tcl 命令（设置频率和其他一些命令），但它只显示：

> 导入服务器
> 
> 服务器.ScktConn()
> 
> 频率（450-2500）：600
> 
> 接收：0 ace_set_frequency C1 600

这是第一个命令，但它甚至没有设置频率（只显示 cmd，但不应用它）！

这是脚本：

```
import socket
import threading
import time

address = ('127.0.0.1', 5426)
def ScktRecv():
    r = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    r.bind(address)
    r.listen(5)
    conn, _ = r.accept()
    csvid = conn.recv(4096)
    print "recv: %s" % csvid
    conn.close()

def ScktConn():
    recv_thread = threading.Thread(target=ScktRecv)
    recv_thread.start()
    time.sleep(1)
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect(address)
    # our local IP is 192.168.2.1, but it works even with 127.0.0.1, I don't know from where       #it is coming
    Freq=raw_input('Frequency(450-2500): ')
    CmdF='0 ace_set_frequency C1 '+str(Freq)+' \r\n'
    s.send(CmdF)
    s.send('0 ace_azplayer_remove_player AzPlayer1 \r\n')
    s.send('0 ace_azplayer_add_player \r\n')
    s.send('0 ace_azplayer_add_ace AzPlayer1 C1\r\n')
    Path='C:/Users/amir_rajaee/Desktop/gridview_script/PBF/4x4U_wocorr_SNR.csv'
    s.send('0 ace_azplayer_load_csvfile AzPlayer1 '+Path+' \r\n')
    s.close() 
```

但是当我使用以下脚本时，它会设置频率，但我的问题是，我没有接收器；我需要输出最后一个命令（加载 csv 文件）！：

```
import socket
def ScktConn():
 s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
 s.connect(('127.0.0.1', 5006))
 Freq=raw_input('Frequency(450-2500): ')
 CmdF='0 ace_set_frequency C1 '+str(Freq)+' \r\n'
 s.send(CmdF)
 s.send('0 ace_azplayer_remove_player AzPlayer1 \r\n')
 s.send('0 ace_azplayer_add_player \r\n')
 s.send('0 ace_azplayer_add_ace AzPlayer1 C1\r\n')
 Path='C:/Users/amir_rajaee/Desktop/gridview_script/PBF/4x4U_wocorr_SNR.csv'
 s.send('0 ace_azplayer_load_csvfile AzPlayer1 '+Path+' \r\n') 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T15:43:00.973

你这里似乎有两个问题。

1）您希望打印 tcl 命令将执行它们。事实并非如此。请查看[子流程库](http://docs.python.org/2/library/subprocess.html)以了解如何实现这一点。

2）你只打电话`socket.recv`一次。要捕获所有发送，您需要接收器不断侦听发送的消息。更改`SockRecv`为：

```
address = ('127.0.0.1', 5426)
def ScktRecv():
    r = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    r.bind(address)
    r.listen(5)
    conn, _ = r.accept()
    while True:
        csvid = conn.recv(4096)
        if csvid:
            print "%s" % csvid
    conn.close() 
```

您将需要进一步修改以正确处理线程的生命周期。

# c++ - OpenCV imwrite 保存黑色 png

> ID：13961789
> 
> 赞同：2
> 
> 时间：2012-12-19T21:46:09.210
> 
> 标签：c++, opencv, png, tiff, 16-bit

我正在尝试编写一个将平面场应用于图像的 C++ 程序。它应该加载一个图像并将其除以另一个加载的图像，然后将其导出为 PNG。我的程序编译正确，但只生成全黑图像。

```
#include <climits>
#include <stdio.h>
#include <string>
#include <opencv/cv.h>
#include <opencv/highgui.h>

using namespace cv;
using namespace std;

int main( int argc, char *argv[] )
 {
     const char *flat_file = argv[1];
     const char *img_file = argv[2];
     const char *out_file = argv[3];

     Mat flat_img;
     flat_img = imread( flat_file, CV_LOAD_IMAGE_ANYCOLOR | CV_LOAD_IMAGE_ANYDEPTH );   
     Mat image;
     image = imread( img_file, CV_LOAD_IMAGE_ANYCOLOR | CV_LOAD_IMAGE_ANYDEPTH );

     GaussianBlur( flat_img, flat_img, cv::Size(3,3), 0, 0, BORDER_REPLICATE );
     divide( image, flat_img, image, 1.0, -1 );
     imwrite( out_file, image );

 return 0;
 } 
```

所有输入文件都是 16 位 TIFF。目前，生成的输出文件是 16 位 PNG，具有正确的像素尺寸，但完全是黑色的。

我对 C++ 和 OpenCV 都很陌生，所以我不完全确定我错过了什么。[该线程](https://stackoverflow.com/questions/10571874/opencv-imwrite-saving-complete-black-jpeg)似乎表明浮点值可能是原因。我可以转换出浮点数，但我需要保持源代码的 16 位特性。我试过`image.convertTo( image, CV_16U );`在divide命令之后添加一行，两者`CV_16U`都`CV_8U`起作用，也不起作用。

非常感谢任何和所有帮助！

**编辑**

根据下面的建议，我尝试添加一些 imshow 命令来实际测试 opencv 是否正确处理事情。似乎一切正常，直到我执行除法命令。在那之后，我的图像数组最终是空白的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T22:10:50.027

答案可能是您已经得到了正确的图像，因为如果您使用普通图像浏览器打开 16 位图像，通常会完全变暗，因为它们只支持正确显示 8 位图像。

为了解决这个问题，首先尝试使用 OpenCV highgui 显示 16 位图像。你可以做`imshow("test",image) ; waitKey(0) ;`，看看图像是否正确显示。如果是这样，您可以将图像转换为 8 位`Mat img8bit ; image.convertTo(img8bit, CV8U, 255./65535.) ;`并 imwrite 这个新的 Mat。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T15:09:51.710

原来这确实是我的除法命令。我一直将我的代码基于一个同事编写的类似应用程序，所以我去看看他们是如何完成划分的。我不是 100% 确定这是做什么的，但是当我将我的划分更改为这个时它会起作用：

`divide( image, flat_img, image, image.depth() == 16 ? UCHAR_MAX : USHRT_MAX );`

只是做一个预测，这个条件就是根据图像的深度为我的数据设置标量。`divide( image, flat_img, image, image.depth() == 8 ? UCHAR_MAX : USHRT_MAX );`我仍然有一个挥之不去的问题是我所拥有的和将来的有什么区别。两者都产生了看似相同的图像。大多数情况下，我试图更好地理解正在发生的事情。

# google-maps-api-3 - 在 Google Map V3 中，如何在多边形内部和上方放置标签？

> ID：13961794
> 
> 赞同：19
> 
> 时间：2012-12-19T21:46:33.483
> 
> 标签：google-maps-api-3, label, polygon

在 Google Map V3 中，如何在多边形内部和上方放置标签？没有 V2 中的标签覆盖当我使用库 maplabel 时，我可以将文本放在里面，但不能放在上面，即使我指定了更高的 Z-index。谢谢菲尔

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2017-06-27T08:44:32.070

为时已晚，但我遇到了同样的问题，这段代码运行良好！

```
var triangleCoords = [
    { lat:30.655993, lng: 76.732375 },
    { lat: 30.651379, lng: 76.735808},
    { lat: 30.653456, lng: 76.729682}
]

var bermudaTriangle = new google.maps.Polygon({
    paths: triangleCoords ,
    strokeColor: '#FF0000',
    strokeOpacity: 0.8,
    strokeWeight: 2,
    fillColor: '#FF0000',
    fillOpacity: 0.35
});
attachPolygonInfoWindow(bermudaTriangle)

function attachPolygonInfoWindow(polygon) {
    var infoWindow = new google.maps.InfoWindow();
    google.maps.event.addListener(polygon, 'mouseover', function (e) {
        infoWindow.setContent("Polygon Name");
        var latLng = e.latLng;
        infoWindow.setPosition(latLng);
        infoWindow.open(map);
    });
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-04-21T00:02:11.570

maplabel 在 mapPane 的画布上呈现其文本，通常呈现在 floatPane 中所有 zIndex 值的下方。要将 mapPane 画布带入您的 zIndex 顺序，请尝试：

```
var mapLabel = new MapLabel({
    position: new google.maps.LatLng(yourLat, yourLng),
    text: 'test',
    zIndex: 101} );
$(mapLabel.getPanes().mapPane).css('z-index', mapLabel.zIndex); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-27T12:19:47.933

使用[google-maps-utility-library](https://github.com/googlemaps/v3-utility-library)

设置标签内容，找到多边形的[中心位置](https://stackoverflow.com/questions/3081021/how-to-get-the-center-of-a-polygon-in-google-maps-v3)，就是这样:)

```
var labelOptions = {
    content: label,
    boxStyle: {
      textAlign: "center",
      fontSize: "8pt",
      width: "50px"
    },
    disableAutoPan: true,
    pixelOffset: new google.maps.Size(-25, 0),
    position: this.my_getBounds(gpoints).getCenter(),
    closeBoxURL: "",
    isHidden: false,
    pane: "mapPane",
    enableEventPropagation: true
};

var polygonLabel = new InfoBox(labelOptions);
polygonLabel.open(map); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2019-06-18T17:17:03.867

您可以使用信息框的`position`字段。使用以下代码获取多边形的中心位置。

`const bounds = new window.google.maps.LatLngBounds(); bounds.extend(new window.google.maps.LatLng(lat1,lng1)); bounds.extend(new window.google.maps.LatLng(lat2,lng2)); .. .. let polygonCenter = bounds.getCenter();`

# joomla - 从 schema.org 为 joomla 添加丰富的片段！地点？

> ID：13961796
> 
> 赞同：0
> 
> 时间：2012-12-19T21:46:37.220
> 
> 标签：joomla, schema.org

我不知道如何为我的 joomla 添加标记！地点。谁能告诉我如何使用 schema.org 丰富的片段？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-01T08:37:51.517

如果您需要 VirtueMart 产品，有这个插件：

[http://www.easyjoomla.org/paid-extensions/rich-snippets-for-virtuemart](http://www.easyjoomla.org/paid-extensions/rich-snippets-for-virtuemart)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T09:18:20.227

Joomla 有一个插件可以在默认编辑器上添加选项

[http://extensions.joomla.org/extensions/site-management/seo-a-metadata/meta-data/19961](http://extensions.joomla.org/extensions/site-management/seo-a-metadata/meta-data/19961)

# objective-c - 使用 NSPipe、NSTask 进行进程间通信

> ID：13961799
> 
> 赞同：6
> 
> 时间：2012-12-19T21:46:45.340
> 
> 标签：objective-c, ipc, nstask, nspipe

我需要使用 NSPipe 通道实现两个线程之间的通信，问题是我不需要通过指定此方法来调用终端命令。

```
[task setCurrentDirectoryPath:@"....."];
[task setArguments:]; 
```

我只需要写一些数据

```
NSString * message = @"Hello World";
[stdinHandle writeData:[message dataUsingEncoding:NSUTF8StringEncoding]]; 
```

并在另一个线程上接收此消息

```
NSData *stdOutData = [reader availableData];
NSString * message = [NSString stringWithUTF8String:[stdOutData bytes]]; //My Hello World 
```

例如，C# 中的此类事情可以通过 NamedPipeClientStream、NamedPipeServerStream 类轻松完成，其中管道由 id 字符串注册。

如何在 Objective-C 中实现它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T22:52:35.317

如果我正确理解您的问题，您可以创建一个`NSPipe`并使用一端用于阅读和一端用于写作。例子：

```
// Thread function is called with reading end as argument:
- (void) threadFunc:(NSFileHandle *)reader
{
    NSData *data = [reader availableData];
    NSString *message = [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding];
    NSLog(@"%@", message);
}

- (void) test
{
    // Create pipe:
    NSPipe *pipe = [[NSPipe alloc] init];
    NSFileHandle *reader = [pipe fileHandleForReading];
    NSFileHandle *writer = [pipe fileHandleForWriting];

    // Create and start thread:
    NSThread *myThread = [[NSThread alloc] initWithTarget:self
                                                 selector:@selector(threadFunc:)
                                                   object:reader];
    [myThread start];

    // Write to the writing end of pipe:
    NSString * message = @"Hello World";
    [writer writeData:[message dataUsingEncoding:NSUTF8StringEncoding]];

    // This is just for this test program, to avoid that the program exits
    // before the other thread has finished.
    [NSThread sleepForTimeInterval:2.0];
} 
```

# ruby-on-rails - 如何使雾使用 S3 减少冗余存储

> ID：13961801
> 
> 赞同：1
> 
> 时间：2012-12-19T21:46:47.437
> 
> 标签：ruby-on-rails, amazon-s3, carrierwave, fog

我正在使用 Carrierwave 管理我的应用程序中的一些图像，并且我希望上传到 S3 的文件使用减少冗余存储而不是标准。Carrierwave 使用雾与 S3 通信，那么我该如何实现呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T21:46:47.437

在挖掘了一段时间后，我最终设置了以下行`config/initializers/carrierwave.rb`：

```
config.fog_attributes = { 
  'x-amz-storage-class' => 'REDUCED_REDUNDANCY'
} 
```

我花费时间最长的是找到正确的属性名称以及要发送的值。这是一个很好的资源：[http ://docs.aws.amazon.com/AmazonS3/latest/API/RESTObjectPOST.html](http://docs.aws.amazon.com/AmazonS3/latest/API/RESTObjectPOST.html)

# node.js - 成功编译自定义 node.js 模块我如何使用它

> ID：13961805
> 
> 赞同：0
> 
> 时间：2012-12-19T21:46:59.620
> 
> 标签：node.js

我在使用 npm 为 node.js 安装 canvas 模块时遇到了很多问题，所以我下载了源代码，并使用 Visual Studio 2005 来调试和纠正我遇到的错误。我让它成功编译，但现在我不知道从那里去哪里才能在我的项目中使用它。看起来应该很容易，但我什至不知道从哪里开始。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T22:04:14.237

将已编译的 .dll 文件重命名为 .node 并将其放入您的节点项目中。那么就`require`这样吧。

例如，在文件夹中：

```
app.js
canvas.node
... 
```

在 app.js 中：

```
var canvas = require('./canvas'); 
```

* * *

**请注意，对于 canvas 模块，如果**您设置了适当的节点本机构建环境 ( [node-gyp](https://github.com/TooTallNate/node-gyp) )，则使用 npm 安装它应该没有问题 ，其中包括 [Python 2.7](http://www.python.org/download/releases/2.7.3#download)和[MS Visual C++ **2010**](http://www.microsoft.com/visualstudio/eng/products/visual-studio-2010-express)（以及 x64构建，[Win 7 x64 SDK](http://www.microsoft.com/download/en/details.aspx?displayLang=en&id=8279)）。VS 2005 将无法工作。

您显然还需要安装 cario，因为 canvas 依赖于它。

# c++ - VS2010 无法链接它应该构建的库

> ID：13961806
> 
> 赞同：4
> 
> 时间：2012-12-19T21:47:03.140
> 
> 标签：c++, visual-studio-2010, dll, linker

我在尝试构建我的 DLL 项目时遇到了 VS2010 的问题。DLL 本身生成得很好，但是`.lib`我需要与其他依赖项目链接的文件失败了。

我有一个经典的`__declspec(dllexport)`和一切，不用担心，构建在调试模式下完美运行。我只在发布模式下遇到这个问题，但我不认为我搞砸了我的设置（它们几乎是默认设置）。

这是我得到的输出错误（未解析的外部符号）：

```
Erreur  274 error LNK1120: 1 externes non résolus   \Release\Engine.lib Engine
Erreur  273 error LNK2001: symbole externe non résolu App   LINK    Engine 
```

肯定 Visual Studio 找不到这个文件：它应该生成它！

我以为我在[Dll 项目中找到了一个解决方案，因为链接器无法找到同名的 .lib 文件](https://stackoverflow.com/questions/6647005/dll-project-doesnt-build-as-linker-not-able-to-find-the-same-named-lib-file) （同样的问题），但我不明白答案是如何解决任何问题的。

有没有人遇到过这个问题并找到了避免它的方法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-19T23:04:06.837

> 构建在调试模式下完美运行。我只有在发布模式下才有这个问题

打开您的 .vcxproj 文件并检查调试和发布版本之间的依赖关系是否一致，例如，外部库、其他包含路径等。当这种情况发生在我身上时，通常是因为我添加了一些调试配置并忘记了类似的更改发布。

# java - Git 补丁 Java 导入

> ID：13961814
> 
> 赞同：3
> 
> 时间：2012-12-19T21:47:45.767
> 
> 标签：java, git, import

有什么好方法可以解决带有 git 和 Java 导入的补丁吗？

我有一**台远程计算机**（我在工作中使用的那个），使用一个名为**bugX的分支**

现在我在家，我想将该分支的“副本”复制到我的**本地计算机**上以继续工作。

所以我所做的是在我的**本地计算机**中提取工作副本，然后我用**bugX**分支的差异对我的**远程计算机中的****master**做了一个补丁，然后我尝试将该补丁应用到我的**本地**分支**主机上的****计算机**

 ******但是补丁一直失败，因为导入都搞砸了。

[*] 我不允许推送远程分支然后从这里拉取它。

编辑：

我尝试从 master （在远程计算机中）创建另一个分支，并尝试将补丁应用于该分支，但也失败了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T22:45:11.293

如果您可以从家里通过 ssh 访问您的工作计算机，只需将您的工作存储库添加为您家用 PC 上的遥控器，然后从那里拉取。是的——你可以从任何 git repo 中提取，“git 服务器”在任何方面都不是特别的。好吧，它们是裸露的，这意味着它们没有工作副本，但这仅在**推**到那里时才有意义。

如果您没有 ssh 访问您的工作计算机并且不允许将分支推送到中央存储库，我建议您在其他地方设置一个存储库（例如私人 git 存储库）并从工作中推送到那里。或者您可以通过将其推到服务器上来隐藏您的分支，但不能作为正确的分支（不是 in `refs/heads`，而是 eg `refs/hidden`）。******

# android - Android SDK - 不在触控中心缩放

> ID：13961817
> 
> 赞同：10
> 
> 时间：2012-12-19T21:47:48.787
> 
> 标签：android, sdk, pinchzoom

我的应用程序有一点问题。我刚刚实现了捏缩放，但是当我捏缩放时，图像不会在 2 个点的中心缩放，如下图所示。图像 1 是我的手指在捏合之前的位置，而图像 2 是显示它没有像应有的那样在我的手指中心按比例缩小。

**图 1 与图 2：**
![图像1](../Images/c7873605975b5de897a1613ffbcf4fd9.png) ![图2](../Images/f50bb84ce3967f313c55930f503327fd.png)

这是我的代码：

```
 package com.jpiionefourone.guitarimage;

    import android.content.Context;
    import android.graphics.Canvas;
    import android.graphics.drawable.Drawable;
    import android.util.AttributeSet;
    import android.view.MotionEvent;
    import android.view.ScaleGestureDetector;
    import android.view.View;

    public class MultiTouchView extends View {
        private Drawable mIcon;
        private float mPosX;
        private float mPosY;

        private float mLastTouchX;
        private float mLastTouchY;

        private static final int INVALID_POINTER_ID = -1;

        // The ‘active pointer’ is the one currently moving our object.
        private int mActivePointerId = INVALID_POINTER_ID;

        private ScaleGestureDetector mScaleDetector;
        private float mScaleFactor = 1.f;

        public MultiTouchView(Context context) {
            this(context, null, 0);
        }

        public MultiTouchView(Context context, AttributeSet attrs) {
            this(context, attrs, 0);
        }

        public MultiTouchView(Context context, AttributeSet attrs, int defStyle) {
            super(context, attrs, defStyle);
            mIcon = context.getResources().getDrawable(R.drawable.guitar);
            mIcon.setBounds(0, 0, mIcon.getIntrinsicWidth(), mIcon.getIntrinsicHeight());

            // Create our ScaleGestureDetector
            mScaleDetector = new ScaleGestureDetector(context, new ScaleListener());

        }

        @Override
        public boolean onTouchEvent(MotionEvent ev) {
            // Let the ScaleGestureDetector inspect all events.
            mScaleDetector.onTouchEvent(ev);

            final int action = ev.getAction();
            switch (action & MotionEvent.ACTION_MASK) {
            case MotionEvent.ACTION_DOWN: {
                final float x = ev.getX();
                final float y = ev.getY();

                mLastTouchX = x;
                mLastTouchY = y;
                mActivePointerId = ev.getPointerId(0);
                break;
            }

            case MotionEvent.ACTION_MOVE: {
                final int pointerIndex = ev.findPointerIndex(mActivePointerId);
                final float x = ev.getX(pointerIndex);
                final float y = ev.getY(pointerIndex);

                // Only move if the ScaleGestureDetector isn't processing a gesture.
                if (!mScaleDetector.isInProgress()) {
                    final float dx = x - mLastTouchX;
                    final float dy = y - mLastTouchY;

                    mPosX += dx;
                    mPosY += dy;

                    invalidate();
                }

                mLastTouchX = x;
                mLastTouchY = y;

                break;
            }

            case MotionEvent.ACTION_UP: {
                mActivePointerId = INVALID_POINTER_ID;
                break;
            }

            case MotionEvent.ACTION_CANCEL: {
                mActivePointerId = INVALID_POINTER_ID;
                break;
            }

            case MotionEvent.ACTION_POINTER_UP: {
                final int pointerIndex = (ev.getAction() & MotionEvent.ACTION_POINTER_INDEX_MASK) 
                        >> MotionEvent.ACTION_POINTER_INDEX_SHIFT;
                final int pointerId = ev.getPointerId(pointerIndex);
                if (pointerId == mActivePointerId) {
                    // This was our active pointer going up. Choose a new
                    // active pointer and adjust accordingly.
                    final int newPointerIndex = pointerIndex == 0 ? 1 : 0;
                    mLastTouchX = ev.getX(newPointerIndex);
                    mLastTouchY = ev.getY(newPointerIndex);
                    mActivePointerId = ev.getPointerId(newPointerIndex);
                }
                break;
            }
            }

            return true;
        }

        @Override
        public void onDraw(Canvas canvas) {
            super.onDraw(canvas);

            canvas.save();
            canvas.translate(mPosX, mPosY);
            canvas.scale(mScaleFactor, mScaleFactor);
            mIcon.draw(canvas);
            canvas.restore();
        }

        private class ScaleListener extends ScaleGestureDetector.SimpleOnScaleGestureListener {
            @Override
            public boolean onScale(ScaleGestureDetector detector) {
                mScaleFactor *= detector.getScaleFactor();

                // Don't let the object get too small or too large.
                mScaleFactor = Math.max(0.1f, Math.min(mScaleFactor, 5.0f));

                invalidate();
                return true;
            }
        }
    } 
```

谢谢，

贾里德

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-19T22:13:30.917

在你的`ScaleListener`课堂上，你只需要调整`mScaleFactor`，事实上，你的图像确实*不会*围绕你的多点触控手势的中心进行缩放！

此外，您需要更新`mPosX`并`mPosY`使用不同的缩放中心。

对于我自己的一个应用程序，我使用了这样的东西：

```
final float scale = detector.getScaleFactor();
mScaleFactor = Math.max(0.1f, Math.min(mScaleFactor * scale, 5.0f));

if (mScaleFactor < 5f) {
   // 1 Grabbing
   final float centerX = detector.getFocusX();
   final float centerY = detector.getFocusY();
   // 2 Calculating difference
   float diffX = centerX - mPosX;
   float diffY = centerY - mPosY;
   // 3 Scaling difference
   diffX = diffX * scale - diffX;
   diffY = diffY * scale - diffY;
   // 4 Updating image origin
   mPosX -= diffX;
   mPosY -= diffY;
} 
```

基本上，它通过以下方式计算图像原点的相对变化

1.  抓住多点触控手势的起点 ( `getFocus()`)
2.  `diffX`计算图像原点（和`diffY`）之间的差异
3.  应用比例因子
4.  并使用缩放差异更新图像的原点

这（仍然）适用于我的情况。我不知道我们是否都使用（d）相同的坐标系，但这样的东西应该可以帮助您正确缩放多点触控手势中心的图像。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-07-17T05:56:52.633

It took me really long to get this working.. however thanks for almost working code! I'm not sure was I just messing around or what but with this changes in code I got my zooming work like I wanted! Hopefully this will safe someones time.

```
mScaleFactor *= detector.getScaleFactor();
mScaleFactor = Math.max(0.5f, Math.min(mScaleFactor, 3.0f));
scale = mScaleFactor / scaleAtm

mTranslateMatrix.preTranslate(diffX, diffY);
mTranslateMatrix.invert(mTranslateMatrixInverse);
mPosX += diffX;
mPosY += diffY;
scaleAtm = mScaleFactor; 
```

At the beginning scaleAtm = 1.

# redirect - 在 nginx 中将 /foo.html 重定向到 /foo 而不是 / 到 /index

> ID：13961825
> 
> 赞同：6
> 
> 时间：2012-12-19T21:48:07.573
> 
> 标签：redirect, nginx

我在磁盘上的文件有扩展名：`index.html`, `a.html`. `http://example.com/a`我想要一个加载`/var/www/a.html`和`http://example.com/`加载的请求`/var/www/index.html`。我希望任何其他 url 重定向到规范 url，所以`http://example.com/a.html`应该重定向到`http://example.com/a`.

我的配置如下：

```
rewrite ^(/.+)\.html$ $scheme://$host$1 permanent;
location / {
    root   /var/www;
    try_files $uri.html $uri $uri/ =404;
} 
```

这确实重定向`/a.html`到并成功从磁盘`/a`加载：`a.html`

```
$ curl -D- -s http://www.jefftk.com/food.html | grep ^Location
Location: http://www.jefftk.com/food
$ curl -s http://www.jefftk.com/food | grep ^Location 
```

但它发送`/`到`/index`：

```
$ curl -s -D- http://www.jefftk.com/pictures/ | grep ^Location
Location: http://www.jefftk.com/pictures/index
$ curl -s -D- http://www.jefftk.com | grep ^Location
Location: http://www.jefftk.com/index 
```

如果我删除重写规则，它会停止从`/a.html`to重定向，`/a`但也会停止发送`/`到`/index`：

```
$ curl -D- -s http://www.jefftk.com/food.html | grep ^Location
$ curl -D- -s http://www.jefftk.com/food | grep ^Location
$ curl -D- -s http://www.jefftk.com/ | grep ^Location
$ curl -D- -s http://www.jefftk.com/pictures/ | grep ^Location 
```

为什么会发生这种情况？我可以同时为我想要的两个东西（没有`.html`扩展名，没有`index`url）制作 nginx 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T00:31:40.303

我认为您的重写规则可能是倒退的。也许只是这个（没有重写规则）：

```
location / {
    try_files $uri.html $uri $uri/ =404;
}

location = / {
    index index.html;
} 
```

编辑版本：

对不起，我没有完全理解你的描述。我重读了几次并对此进行了测试，它可能接近您想要做的事情：

```
location = / {
    try_files /index.html =404;
}

location = /index {
    return 301 $scheme://$host;
}

location ~* \.html$ {
    rewrite ^(.+)\.html$ $scheme://$host$1 permanent;
}

location / {
    try_files $uri.html $uri/ @backend;
}

location @backend {
    # rewrite or do whatever is default for your setup
    rewrite ^ /index.html last;
    // or return 404;
} 
```

代码示例（修订版 3）：

我希望第三次是一个魅力。也许这会解决你的问题？

```
# example.com/index gets redirected to example.com/

location ~* ^(.*)/index$ {
    return 301 $scheme://$host$1/;
}

# example.com/foo/ loads example.com/foo/index.html

location ~* ^(.*)/$ {
    try_files $1/index.html @backend;
}

# example.com/a.html gets redirected to example.com/a

location ~* \.html$ {
    rewrite ^(.+)\.html$ $scheme://$host$1 permanent;
}

# anything else not processed by the above rules:
# * example.com/a will load example.com/a.html
# * or if that fails, example.com/a/index.html

location / {
    try_files $uri.html $uri/index.html @backend;
}

# default handler
# * return error or redirect to base index.html page, etc.

location @backend {
    return 404;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T06:24:15.733

您是否正在寻找这样的东西：

```
location / {
    try_files $uri.html $uri/index.html =404;
} 
```

基本上这将`a.html`首先尝试文件，如果失败，它将尝试`index.html`最后显示一个`404`. 另外请记住`restart nginx`在编辑`vhost`文件后。

# php - ZF2 登录转发

> ID：13961826
> 
> 赞同：1
> 
> 时间：2012-12-19T21:48:09.643
> 
> 标签：php, zend-framework2, zfcuser

我在控制器中有一个函数，它需要检查用户是否已登录（我正在使用 zfcuser 模块），如果没有，则向他们显示登录屏幕。

我的理解是我应该运行这个：

```
return $this->forward()->dispatch('zfcuser', array('action' => 'authenticate')); 
```

不幸的是，这改变了网址。我想显示登录屏幕并允许用户在不更改 url 的情况下登录。通过扩展，这意味着我还希望将用户重定向回同一页面，而不是转到该`/user`页面。

我怎样才能实现这两个目标？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-25T20:21:18.290

在过去的几天里，我自己也在为此苦苦挣扎。ZfcUser 配置包含一个`use_redirect_parameter_if_present`设置，但文档没有提供任何关于如何使用它的示例。我不知道我的方法是否可靠，但这就是我为使其正常工作所做的工作。请注意，此方法保留 URL，因为它使用转发。我不确定不使用 forward 的另一种方法。

在您的 zfcuser 配置文件中，继续将该`use_redirect_parameter_if_present`设置设置为`true`. 这会导致 ZfcUser 的登录操作`redirect`在请求中查找参数。它使用它在成功验证后将用户返回到指定位置。

然后，在我要确保用户登录的控制器中，我有：

```
if (!$this->zfcUserAuthentication()->hasIdentity()) {

    // Build the redirect URL using the route to which we want
    // the user returned.
    $redirect = $this->url()->fromRoute('your route', array(
        'optional-route-param' => 1234
    ));

    // Set the redirect URL in the request so that ZfcUser can
    // pick it up. This is the key.
    $this->getRequest()->getQuery()->set('redirect', $redirect);

    // Use ZfcUser's login action rather than its authentication
    // action.
    return $this->forward()->dispatch('zfcuser', array(
        'action' => 'login'
    ));
} 
```

我希望这会有所帮助。如果您在使其正常工作时遇到问题，您可能需要发布一些代码。

# r - 向量化 R 中的 for 循环

> ID：13961828
> 
> 赞同：1
> 
> 时间：2012-12-19T21:48:19.060
> 
> 标签：r, loops, for-loop, vectorization

我正在使用一个包含大约 300 万个观测值的非常大的数据集，如果它们满足特定要求，我想通过并基本上结合某些观测值。我在下面编写了一个 for 循环来执行此操作，但效率非常低。有没有更有效的方法，比如应用函数或其他东西，可以改善这一点？

```
nobs <- nrow(acsdata)

for (i in 2:nobs){

  if (acsdata[i,6]==1 & acsdata[(i-1),6]==1) acsdata[(i-1),3]=2  

  if (acsdata[i,6]==1 & acsdata[(i-1),6]==1) acsdata[(i-1),21:30]=acsdata[(i-1),21:30]+acsdata[i,21:30]

  if (acsdata[i,6]==1 & acsdata[(i-1),6]==1) acsdata[(i),31]=1

} 
```

任何帮助将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-19T22:01:55.963

只需矢量化。根本不要弄乱循环或应用函数。类似（未经测试）：

```
to.fix <- which(acsdata[ 2:nobs, 6] == 1 & acsdata[ 1:(nobs - 1), 6] == 1)
acsdata[to.fix, 3] <- 2
acsdata[to.fix, 21:30] <- acsdata[to.fix, 21:30] + acsdata[to.fix + 1, 21:30]
acsdata[to.fix + 1, 31] <- 1 
```

# nginx - 更改了 /usr/share/nginx/html/ 软链接，现在 nginx 不会为它服务 @localhost

> ID：13961830
> 
> 赞同：0
> 
> 时间：2012-12-19T21:48:24.737
> 
> 标签：nginx

我使用 nginx（Ubuntu 12.04 x64 桌面上的 1.2.4）来预览我正在处理的前端设计，而一些不寻常的事情刚刚开始发生

我正在做的设计最初位于：

`~/Projects/Clients/ANS/src/MetroBusiness.ans`

这被软链接到 nginx 的 localhost 目录：

`/usr/share/nginx/html/dev/MetroBusiness.ans`

我可以在`http://localhost/dev/MetroBusiness.ans`.

但是在我清理了我的主目录结构并将 src 目录移动到 ~/work 之后，问题就开始了：

`~/work/clients/ans/src/MetroBusiness.ans`

并将[其重新链接到 nginx 的 localhost 目录中](http://i.imgur.com/0zrOk.png)：

`/usr/share/nginx/html/dev/MetroBusiness.ans`

但现在我无法在 localhost 中查看该站点。它应该是相同的网址，但现在我得到：

`Welcome to nginx! If you see this page, the nginx web server is successfully installed and working.`

但是，我没有更改的其他软链接站点仍然可以正常工作，只是我更改并重新链接的站点。

此外，它不会出现[在 nginx 目录列表中](http://i.imgur.com/RGt9d.png)（其他站点以相同的方式链接，但最近没有移动）

我确保在移动的 src 目录上[设置`rwxrwxr_x`](http://i.imgur.com/1Q0HY.png)了权限`chmod -R`，重新启动了 nginx，甚至重新启动了计算机，但没有运气。

我确定我缺少一些小东西，但现在画了一个空白。知道为什么 Nginx 再也看不到这个软链接了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T06:00:13.283

我以前发生过这种情况，我需要做的就是删除链接并再次重置它。

```
rm /usr/share/nginx/html/dev/MetroBusiness.ans 
```

然后再次设置：

```
ln -s ~/work/clients/ans/src/MetroBusiness.ans /usr/share/nginx/html/dev/MetroBusiness.ans 
```

并检查您是否成功：

```
ls -l /usr/share/nginx/html/dev/ 
```

# python - 为什么 BeautifulSoup 无法正确读取/解析此 RSS (XML) 文档？

> ID：13961831
> 
> 赞同：9
> 
> 时间：2012-12-19T21:48:30.757
> 
> 标签：python, xml, rss, beautifulsoup

YCombinator 很好地提供了一个[RSS 提要](http://news.ycombinator.com/rss)和一个包含[HackerNews](http://news.ycombinator.com/)上热门项目的[大型 RSS 提要](http://news.ycombinator.com/bigrss)。我正在尝试编写一个 python 脚本来访问 RSS 提要文档，然后使用 BeautifulSoup 解析出某些信息。但是，当 BeautifulSoup 尝试获取每个项目的内容时，我会遇到一些奇怪的行为。

以下是 RSS 提要的一些示例行：

```
<rss version="2.0">
<channel>
<title>Hacker News</title><link>http://news.ycombinator.com/</link><description>Links for the intellectually curious, ranked by readers.</description>
<item>
    <title>EFF Patent Project Gets Half-Million-Dollar Boost from Mark Cuban and &#39;Notch&#39;</title>
    <link>https://www.eff.org/press/releases/eff-patent-project-gets-half-million-dollar-boost-mark-cuban-and-notch</link>
    <comments>http://news.ycombinator.com/item?id=4944322</comments>
    <description><![CDATA[<a href="http://news.ycombinator.com/item?id=4944322">Comments</a>]]></description>
</item>
<item>
    <title>Two Billion Pixel Photo of Mount Everest (can you find the climbers?)</title>
    <link>https://s3.amazonaws.com/Gigapans/EBC_Pumori_050112_8bit_FLAT/EBC_Pumori_050112_8bit_FLAT.html</link>
    <comments>http://news.ycombinator.com/item?id=4943361</comments>
    <description><![CDATA[<a href="http://news.ycombinator.com/item?id=4943361">Comments</a>]]></description>
</item>
...
</channel>
</rss> 
```

这是我编写的（在 python 中）访问此提要并为每个项目打印出`title`、`link`和的代码：`comments`

```
import sys
import requests
from bs4 import BeautifulSoup

request = requests.get('http://news.ycombinator.com/rss')
soup = BeautifulSoup(request.text)
items = soup.find_all('item')
for item in items:
    title = item.find('title').text
    link = item.find('link').text
    comments = item.find('comments').text
    print title + ' - ' + link + ' - ' + comments 
```

但是，此脚本给出的输出如下所示：

```
EFF Patent Project Gets Half-Million-Dollar Boost from Mark Cuban and &#39;Notch&#39; -  - http://news.ycombinator.com/item?id=4944322
Two Billion Pixel Photo of Mount Everest (can you find the climbers?) -  - http://news.ycombinator.com/item?id=4943361
... 
```

如您所见，中间的`link`, 不知何故被省略了。也就是说，结果值`link`不知何故是一个空字符串。那为什么呢？

当我深入研究其中的内容时`soup`，我意识到它在解析 XML 时会莫名其妙地窒息。这可以通过查看中的第一项来看出`items`：

```
>>> print items[0]
<item><title>EFF Patent Project Gets Half-Million-Dollar Boost from Mark Cuban and &#39;Notch&#39;</title></link>https://www.eff.org/press/releases/eff-patent-project-gets-half-million-dollar-boost-mark-cuban-and-notch<comments>http://news.ycombinator.com/item?id=4944322</comments><description>...</description></item> 
```

您会注意到仅使用`link`标签就发生了一些奇怪的事情。它只是获取关闭标签，然后是该标签的文本。这是一些非常奇怪的行为，特别是与`title`没有`comments`问题的解析相比。

这似乎是 BeautifulSoup 的问题，因为请求实际读取的内容没有任何问题。我不认为它仅限于 BeautifulSoup，因为我也尝试使用 xml.etree.ElementTree API 并且出现了同样的问题（BeautifulSoup 是基于这个 API 构建的吗？）。

有谁知道为什么会发生这种情况，或者我如何仍然可以使用 BeautifulSoup 而不会出现此错误？

注意：我终于能够使用 xml.dom.minidom 获得我想要的东西，但这似乎不是一个强烈推荐的库。如果可能的话，我想继续使用 BeautifulSoup。

**更新**：我在使用 Python 2.7.2 和 BS4 4.1.3 的 OSX 10.8 的 Mac 上。

**更新 2**：我有 lxml，它是用 pip 安装的。它是 3.0.2 版。至于 libxml，我检查了 /usr/lib，显示的是 libxml2.2.dylib。不确定何时或如何安装。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-19T21:55:43.247

哇，好问题。这让我觉得是 BeautifulSoup 中的一个错误。您无法访问链接的原因`soup.find_all('item').link`是，当您第一次将 html 加载到 BeautifulSoup 中时，它对 HTML 做了一些奇怪的事情：

```
>>> from bs4 import BeautifulSoup as BS
>>> BS(html)
<html><body><rss version="2.0">
<channel>
<title>Hacker News</title><link/>http://news.ycombinator.com/<description>Links
for the intellectually curious, ranked by readers.</description>
<item>
<title>EFF Patent Project Gets Half-Million-Dollar Boost from Mark Cuban and 'No
tch'</title>
<link/>https://www.eff.org/press/releases/eff-patent-project-gets-half-million-d
ollar-boost-mark-cuban-and-notch
    <comments>http://news.ycombinator.com/item?id=4944322</comments>
<description>Comments]]&gt;</description>
</item>
<item>
<title>Two Billion Pixel Photo of Mount Everest (can you find the climbers?)</ti
tle>
<link/>https://s3.amazonaws.com/Gigapans/EBC_Pumori_050112_8bit_FLAT/EBC_Pumori_
050112_8bit_FLAT.html
    <comments>http://news.ycombinator.com/item?id=4943361</comments>
<description>Comments]]&gt;</description>
</item>
...
</channel>
</rss></body></html> 
```

仔细看——它实际上已经将第一个`<link>`标签更改为`<link/>`然后删除了`</link>`标签。我不确定它为什么会这样做，但是如果不解决`BeautifulSoup.BeautifulSoup`类初始化中的问题，您现在将无法使用它。

### 更新：

我认为你现在最好的（尽管是hack-y）的赌注是使用以下方法`link`：

```
>>> soup.find('item').link.next_sibling
u'http://news.ycombinator.com/' 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-02-28T13:35:38.303

@Yan Hudon 是对的。我已经解决了这个问题`soup = BeautifulSoup(request.text, 'xml')`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-31T01:03:41.663

实际上，问题似乎与您使用的解析器有关。默认情况下，使用 HTML 格式。安装 lxml 模块后尝试使用 soup = BeautifulSoup(request.text, 'xml') 。

然后它将使用 XML 解析器而不是 HTML 解析器，应该没问题。

有关更多信息，请参阅[http://www.crummy.com/software/BeautifulSoup/bs4/doc/#installing-a-parser](http://www.crummy.com/software/BeautifulSoup/bs4/doc/#installing-a-parser)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-19T22:15:36.770

我认为 BeautifulSoup 中没有错误。

我从 OS X 10.8.2 在 Apple 的股票 2.7.2 上安装了一个干净的 BS4 4.1.3 副本，一切都按预期工作。它不会错误解析`<link>`as `</link>`，因此它不存在`item.find('link')`.

我还尝试在 2.7.2 和python.org 3.3.0 中使用 stock`xml.etree.ElementTree`和来解析相同的东西，它再次运行良好。这是代码：`xml.etree.cElementTree``xml.etree.ElementTree`

```
import xml.etree.ElementTree as ET

rss = ET.fromstring(x)
for channel in rss.findall('channel'):
  for item in channel.findall('item'):
    title = item.find('title').text
    link = item.find('link').text
    comments = item.find('comments').text
    print(title)
    print(link)
    print(comments) 
```

然后我安装了 lxml 3.0.2（我相信 BS 使用 lxml 如果可用），使用 Apple 的内置`/usr/lib/libxml2.2.dylib`（根据`xml2-config --version`2.7.8），并使用它的 etree 和使用 BS 进行了相同的测试，然后再次，一切正常。

除了搞砸之外`<link>`，jdotjdot 的输出还显示 BS4 正在以一种奇怪的方式搞砸`<description>`。原文是这样的：

```
<description><![CDATA[<a href="http://news.ycombinator.com/item?id=4944322">Comments</a>]]></description> 
```

他的输出是：

```
<description>Comments]]&gt;</description> 
```

我运行他完全相同的代码的输出是：

```
<description><![CDATA[<a href="http://news.ycombinator.com/item?id=4944322">Comments</a>]]></description> 
```

所以，这里似乎有一个更大的问题。奇怪的是，它发生在两个不同的人身上，而在干净安装最新版本的任何东西时都没有发生。

这意味着要么这是一个已修复的错误，而我只是有一个更新版本的任何有错误的东西，要么他们俩安装某些东西的方式有些奇怪。

BS4本身可以排除，因为至少Treebranch和我一样有4.1.3。虽然，在不知道他是如何安装的情况下，这可能是安装的问题。

可以排除 Python 及其内置的 etree，因为至少 Treebranch 拥有与我相同的 OS X 10.8 中的 Apple 2.7.2。

这很可能是 lxml 或底层 libxml 的错误，或者它们的安装方式。我知道 jdotjdot 有 lxml 2.3.6，所以这可能是一个在 2.3.6 和 3.0.2 之间修复的错误。事实上，鉴于根据[lxml 网站](http://lxml.de)和 2.3.5 之后任何版本的更改说明，*没有*2.3.6，所以无论他拥有什么，都可能是从很早就取消的分支或其他东西的某种错误发布……我不知道他的libxml版本，或者是如何安装的，或者他在什么平台上，所以很难猜测，但至少这是可以调查的。

# hadoop - 如何在Hadoop中将对象作为值传递

> ID：13961833
> 
> 赞同：0
> 
> 时间：2012-12-19T21:48:46.877
> 
> 标签：hadoop, mapreduce

是否允许将对象（如树）作为 Hadoop 中映射器的输出值传递？是这样，怎么样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T23:30:51.623

`<Text, IntWritable>`扩展 Tariq 的链接，并简单地详细说明树形图的一种可能实现：

```
public class TreeMapWritable extends TreeMap<Text, IntWritable> 
                             implements Writable {

    @Override
    public void write(DataOutput out) throws IOException {
        // write out the number of entries
        out.writeInt(size());
        // output each entry pair
        for (Map.Entry<Text, IntWritable> entry : entrySet()) {
            entry.getKey().write(out);
            entry.getValue().write(out);
        }
    }

    @Override
    public void readFields(DataInput in) throws IOException {
        // clear current contents - hadoop re-uses objects
        // between calls to your map / reduce methods
        clear();

        // read how many items to expect
        int count = in.readInt();
        // deserialize a key and value pair, insert into map
        while (count-- > 0) {
            Text key = new Text();
            key.readFields(in);

            IntWritable value = new IntWritable();
            value.readFields(in);

            put(key, value);
        }
    }
} 
```

基本上，Hadoop 中的默认序列化工厂期望对象输出实现 Writable 接口（上面详述的 readFields 和 write 方法）。通过这种方式，您几乎可以扩展任何类以改造序列化方法。

`org.apache.hadoop.io.serializer.JavaSerialization`另一种选择是通过配置配置属性来启用 Java 序列化（使用默认的 Java 序列化方法）`io.serializations`，但我不建议这样做。

# jquery - 使用 jQuery .each() 具有动态限制的字符计数器

> ID：13961837
> 
> 赞同：1
> 
> 时间：2012-12-19T21:48:59.650
> 
> 标签：jquery

这个问题是[jQuery Character Counter using class 的扩展？](https://stackoverflow.com/questions/13959314/jquery-character-counter-using-class).

我想`data-content="####"`在我的 textarea 字段中添加一个，然后使用 jQuery 提取数值并将其应用于字符计数器限制器。

`<textarea id="field1" class="input-xlarge limitChars" data-content="2000" rows="2" name="field1">`此字段的限制为 2000 个字符

`<textarea id="field2" class="input-xlarge limitChars" data-content="1000" rows="2" name="field2">`此字段的限制为 1000 个字符

`<textarea id="field3" class="input-xlarge limitChars" data-content="1500" rows="2" name="field3">`这个是 1500 个字符。

从我的另一个问题的解决方案（见下面的解决方案）中，我假设我需要从 DOM 中提取数据内容，然后将其应用于目标。我只是不知道如何从数据内容中提取价值，并希望得到一些帮助。

```
$(document).ready(function(){
    $(".limitChars").each(function() {
        $(this).counter({
            goal: 500
        });
    });
}); 
```

==================================================== ===
随着扩展对话框的出现，我认为展示我最终得到的结果可能会有所帮助：

HTML

```
<textarea id="field1" class="input-xlarge" counter-limit="2000" rows="2" name="field1"> this field would have a limit of 2000 chars 
```

JavaScript/jQuery

```
$("[data-counter-limit]").each(function() {
      var $this = $(this), limit = +$(this).data("counter-limit");
      $this.counter({
        goal: parseInt(limit,10)
        //  goal: limit
      });
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T21:51:10.447

使用[`.data()`](http://api.jquery.com/data)方法从`data-`属性中提取值。然后用于[`parseInt(string, radix)`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/parseInt)将其转换为数字

```
$(document).ready(function(){
    $('.limitChars').each(function() {
        var self = $(this);
        self.counter({
            goal: parseInt(self.data('content'),10)
        });
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T21:53:30.133

您可以删除类名`limit500`并直接*仅*使用`data-*`属性，`data-counter-limit`. 它比同时使用更清洁。

```
<textarea data-counter-limit="1000"> 
```

```
$("[data-counter-limit]").each(function() {
  var $this = $(this), limit = +$(this).data("counter-limit");
  $this.counter({
    goal: limit
  });
}); 
```

选择器`[data-counter-limit]`将获取所有具有属性的元素`data-counter-limit`。剩下的就是解析限制和应用处理元素的问题。

# javascript - 如果关闭 Javascript，如何定义 CSS 样式？

> ID：13961840
> 
> 赞同：5
> 
> 时间：2012-12-19T21:49:18.527
> 
> 标签：javascript, html, css

> **可能重复：**[如果未启用 javascript，则](https://stackoverflow.com/questions/4665748/define-css-if-javascript-is-not-enabled)
> [使用 noscript 嵌入额外样式定义 css](https://stackoverflow.com/questions/218162/embedding-extra-styles-with-noscript)

只有在关闭 Javascript 时，我才尝试定义特定的 CSS 样式。我在用：

```
<noscript>
    <style type="text/css">
    .needjs {display:none !important;}
    .mwnojs { margin-top: 40px !important; }
    </style>
</noscript> 
```

尝试验证页面源时，我收到错误“在此上下文中不允许元素样式作为元素 noscript 的子元素”。

那么，我将如何在保持标记有效的同时执行此操作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T21:52:22.210

`<noscript>`标签是“body”标签，`<style>`标签是“head”标签。因此你会得到一个错误。

您应该将非 javascript 样式设为默认值，然后使用 js 更改您的样式。有关更多详细信息，请参见此处： [https ://stackoverflow.com/a/218917/1068167](https://stackoverflow.com/a/218917/1068167)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T21:52:52.850

似乎与这个[问题非常相似](https://stackoverflow.com/questions/218162/embedding-extra-styles-with-noscript)

> “澄清验证问题：noscript 只允许在 body 元素中，style 只允许在 head。因此，后者不允许在前者中。”

您的`<noscript>`标签所在的位置可能很重要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T21:51:57.390

尝试这样的事情：

```
<html class="nojs">
<head>
<script type="text/javascript">
document.getElementByTagName("html")[0].className="";
</script>
<style>
html#nojs {
   /* do something */
}
</style> 
```

这会在加载页面时删除一个类。如果未激活 javascript，则不会删除该类。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-19T21:52:19.353

您可以通过在默认样式表中包含这些类并在页面加载时让 JavaScript 删除它们来解决这个问题。这仅在启用 JavaScript 时才有效，否则它将加载所需的样式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-19T21:53:23.973

例如，您可以以相反的方式执行此操作，并通过 javascript 禁用某些 css 文件，如果未激活，则不会发生这种情况。

# oauth - python-google-api 服务帐户中的融合表 Oauth 问题

> ID：13961841
> 
> 赞同：2
> 
> 时间：2012-12-19T21:49:19.353
> 
> 标签：oauth, google-fusion-tables, google-api-python-client

我正在从 SQL api 迁移到用于谷歌融合表的新 API v1。我正在使用谷歌 api python 库。我已经完成了迁移步骤，但仍然遇到 oauth 问题。我需要进行服务帐户身份验证并设置了一个。我根据此处给出的示例对身份验证进行了建模：[http ://code.google.com/p/google-api-python-client/source/browse/samples/service_account/tasks.py](http://code.google.com/p/google-api-python-client/source/browse/samples/service_account/tasks.py)

这是我的代码：

```
# Read in private key                                                                                                                                                        
f = file(KEY_FILE,'rb')
key = f.read()
f.close()

# Create an httplib2.Http object to handle our HTTP requests and authorize it                                                                                                
creds = SignedJwtAssertionCredentials(API_EMAIL, key,   
    scope='https://www.googleapis.com/auth/fusiontables')
http = httplib2.Http()
http = creds.authorize(http)

print vars(http.credentials)
service = build("fusiontables", "v1", http=http)

result = service.query().sql(sql="SELECT rowid, Title FROM "+TABLE_ID+" WHERE
ID="+str(id)).execute()

response = service.query().sql(sql="DELETE FROM "+TABLE_ID+" WHERE 
ROWID='"+result["rows"][0][0]+"'").execute() 
```

select 语句有效，但随后 delete 语句出现 403 Forbidden 错误。打印语句显示空凭据。

```
Traceback (most recent call last):
File "test_oauth.py", line 36, in <module>
response = service.query().sql(sql="DELETE FROM "+TABLE_ID+" WHERE
ROWID='"+result["rows"][0][0]+"'").execute()
File "/lib/google-api/oauth2client/util.py", line 120, in positional_wrapper
return wrapped(*args, **kwargs)
File "/lib/google-api/apiclient/http.py", line 680, in execute
raise HttpError(resp, content, uri=self.uri)
apiclient.errors.HttpError: <HttpError 403 when requesting
https://www.googleapis.com/fusiontables/v1/query
alt=json&sql=DELETE+FROM+xxxx+WHERE+ROWID%3D%27239601%27 returned "Forbidden"> 
```

我能够从 API 资源管理器运行这些语句没问题。任何帮助表示赞赏，谢谢！

# xml - Jackson: XML to Map with List 反序列化

> ID：13961843
> 
> 赞同：20
> 
> 时间：2012-12-19T21:49:41.530
> 
> 标签：xml, serialization, jackson

有没有办法使用杰克逊将以下 xml 反序列化为包含项目列表的地图？

```
<order>
    <number>12345678</number>
    <amount>100.10</amount>
    <items>
        <item>
            <itemId>123</itemId>
            <amount>100.0</amount>
            <itemName>Item Name1</itemName>
        </item>
        <item>
            <itemId>234</itemId>
            <amount>200.00</amount>
            <itemName>Item Name1</itemName>
        </item>
    </items>
</order> 
```

我试过了

```
XmlMapper mapper = new XmlMapper();
LinkedHashMap map = (LinkedHashMap)mapper.readValue(xml, Object.class); 
```

并得到以下地图。列表中的第一项丢失。

```
{
    order={
        number=12345678,
        amount=100.1,
        items={
            item={
                amount=200.0,
                itemName=ItemName2,
                itemId=234
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2018-09-14T18:57:01.187

这是在[问题 205](https://github.com/FasterXML/jackson-dataformat-xml/issues/205)`jackson-dataformat-xml`下提交的已知错误。简而言之，XML 中的重复元素被当前实现吞没了。幸运的是，该报告的作者 ( [João Paulo Varandas](https://github.com/joaovarandas) ) 还以自定义[实现](https://gist.github.com/joaovarandas/1543e792ed6204f0cf5fe860cb7d58ed)[的形式提供了一个临时修复](https://gist.github.com/joaovarandas/1543e792ed6204f0cf5fe860cb7d58ed)。下面我分享我对修复的解释：`UntypedObjectDeserializer`[`UntypedObjectDeserializer`](https://gist.github.com/joaovarandas/1543e792ed6204f0cf5fe860cb7d58ed)

```
import com.fasterxml.jackson.core.JsonParser;
import com.fasterxml.jackson.core.JsonToken;
import com.fasterxml.jackson.databind.DeserializationContext;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.deser.std.UntypedObjectDeserializer;
import com.fasterxml.jackson.databind.module.SimpleModule;
import com.fasterxml.jackson.dataformat.xml.XmlMapper;

import javax.annotation.Nullable;
import java.io.IOException;
import java.util.*;

public enum JacksonDataformatXmlIssue205Fix {;

    public static void main(String[] args) throws IOException {
        String xml = "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" +
                "<items>\n" +
                "    <item><id>1</id></item>\n" +
                "    <item><id>2</id></item>\n" +
                "    <item><id>3</id></item>\n" +
                "</items>";
        SimpleModule module = new SimpleModule().addDeserializer(Object.class, Issue205FixedUntypedObjectDeserializer.getInstance());
        XmlMapper xmlMapper = (XmlMapper) new XmlMapper().registerModule(module);
        Object object = xmlMapper.readValue(xml, Object.class);
        System.out.println(object);     // {item=[{id=1}, {id=2}, {id=3}]}
    }

    @SuppressWarnings({ "deprecation", "serial" })
    public static class Issue205FixedUntypedObjectDeserializer extends UntypedObjectDeserializer {

        private static final Issue205FixedUntypedObjectDeserializer INSTANCE = new Issue205FixedUntypedObjectDeserializer();

        private Issue205FixedUntypedObjectDeserializer() {}

        public static Issue205FixedUntypedObjectDeserializer getInstance() {
            return INSTANCE;
        }

        @Override
        @SuppressWarnings({ "unchecked", "rawtypes" })
        protected Object mapObject(JsonParser parser, DeserializationContext context) throws IOException {

            // Read the first key.
            @Nullable String firstKey;
            JsonToken token = parser.getCurrentToken();
            if (token == JsonToken.START_OBJECT) {
                firstKey = parser.nextFieldName();
            } else if (token == JsonToken.FIELD_NAME) {
                firstKey = parser.getCurrentName();
            } else {
                if (token != JsonToken.END_OBJECT) {
                    throw context.mappingException(handledType(), parser.getCurrentToken());
                }
                return Collections.emptyMap();
            }

            // Populate entries.
            Map<String, Object> valueByKey = new LinkedHashMap<>();
            String nextKey = firstKey;
            do {

                // Read the next value.
                parser.nextToken();
                Object nextValue = deserialize(parser, context);

                // Key conflict? Combine existing and current entries into a list.
                if (valueByKey.containsKey(nextKey)) {
                    Object existingValue = valueByKey.get(nextKey);
                    if (existingValue instanceof List) {
                        List<Object> values = (List<Object>) existingValue;
                        values.add(nextValue);
                    } else {
                        List<Object> values = new ArrayList<>();
                        values.add(existingValue);
                        values.add(nextValue);
                        valueByKey.put(nextKey, values);
                    }
                }

                // New key? Put into the map.
                else {
                    valueByKey.put(nextKey, nextValue);
                }

            } while ((nextKey = parser.nextFieldName()) != null);

            // Ship back the collected entries.
            return valueByKey;

        }

    }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-08-11T15:20:06.060

`readTree()`如果您必须使用and ，其他答案将不起作用`JsonNode`。我知道这是一个丑陋的解决方案，但至少您不需要将某人的要点粘贴到您的项目中。

将 org.json 添加到您的项目依赖项中。

然后执行以下操作：

```
import com.fasterxml.jackson.databind.JsonNode;
import com.fasterxml.jackson.databind.ObjectMapper;
import org.json.JSONObject;
import org.json.XML;
...
private static final ObjectMapper OBJECT_MAPPER = new ObjectMapper();
...
    JSONObject soapDatainJsonObject = XML.toJSONObject(data);
    return OBJECT_MAPPER.readTree(soapDatainJsonObject.toString()); 
```

转换如下：

XML -> JSONObject（使用 org.json）-> 字符串 -> JsonNode（使用 readTree）

当然，toJSONObject 处理重复项没有任何问题，我建议避免使用 Jackson，`readTree()`如果可以的话。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-25T21:36:53.983

通过扩展 UntypedObjectDeserializer 来创建自定义反序列化器来完成这项工作。

# java - Java序列化ArrayList

> ID：13961844
> 
> 赞同：0
> 
> 时间：2012-12-19T21:50:01.367
> 
> 标签：java, serialization

java中的ArrayList在序列化的时候，里面存储的对象是不是也跟着序列化了呢？还是我必须获取并序列化它的所有内容？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T21:51:27.497

当您序列化任何对象时，它通常会序列化其中的所有内容。否则，该对象还没有真正被序列化。

正如 Vash 指出的那样，必须实现这些对象才能`Serializable`使其正常工作，否则您会得到 NotSerializableException。JDK 中的类已经在有意义的地方实现了 Serializable。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T21:51:25.720

不，您必须将这些对象的[序列化接口](http://docs.oracle.com/javase/6/docs/api/java/io/Serializable.html)添加到。否则您将无法序列化 ArrayList。

# algorithm - 我一直在阅读《算法设计手册》，但这句话让我感到困惑，我不确定它所说的是否属实

> ID：13961845
> 
> 赞同：0
> 
> 时间：2012-12-19T21:50:06.483
> 
> 标签：algorithm

以下陈述使我感到困惑：

> 最近邻规则相当有效，因为它最多查看每对点 (pi,pj) 两次：一次是在将 pi 添加到游览时，另一次在添加 pj 时。

它来自以下文本块（以蓝色突出显示）：

![在此处输入图像描述](../Images/cde5c92bea58e076e3ac4f71cc99a715.png)

假设这对点是第 2 和第 3 点，(2,3) 那对点怎么看两次？当它添加第 2 个时，它将第 2 个设置为最接近第 1 个的未访问点，然后当它添加第 3 个时，它认为第 3 个最接近第 2 个。这是我能看到他们看着那对点的唯一一点。

有人可以解释吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T22:06:24.090

他们更从数学角度看待这一点 - 有一组点，每次将一个点添加到巡回赛中时，都会访问整个集以寻找最佳候选人。当一个点被添加到游览中时，该集合不会改变，这些点只是被标记为已访问。因此，每一对都被考虑两次。

如果有人真正实现了该算法，您可能会使用一组未访问的点并在每次迭代后更新该组。现在每一对只被访问一次，但代价是改变集合，这可能 - 取决于实现 - 比仅仅访问每对两次所花费的时间更多或更少。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T23:45:55.620

解释说“最多两次”。

如果他们期望每对都被检查两次，那么“最多”这个词就不会出现。“最多两次”的反例是被检查三次或更多次的配对，而不是只检查一次的配对。

# git - 解决合并冲突后如何使用默认的 git commit 消息？

> ID：13961847
> 
> 赞同：76
> 
> 时间：2012-12-19T21:50:17.810
> 
> 标签：git, merge, message, commit, conflict

在进行合并和解决冲突之后，是否有一种“简单”的方法可以从命令行接受默认生成的提交消息？我们的一位开发人员将解决所有冲突，然后`git commit -m"Merge Commit"`替换生成的列出所有冲突文件的提交消息。我想要一个不同的标志，它只需要当前文件而不修改。我知道有一个 -F 或 --file= 选项，但这需要一直知道文件名。

谢谢

* * *

## 回答 #1

> 赞同：135
> 
> 时间：2016-03-23T21:57:48.150

根据[文档](https://git-scm.com/docs/git-commit)，我刚刚尝试了这个简单的命令，它对我有用：

```
git commit --no-edit 
```

然后，运行`git log`以确认已使用默认消息。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-12-19T23:52:24.857

默认情况下，当合并失败时，要使用的提交消息保存在 git 文件夹中的文件中，通常是`.git/MERGE_MSG`. 解决冲突后，运行`git commit`会将保存的消息提供给默认编辑器。

如果消息没有被自己拾取，则可以使用该`--file`选项将其提供给 git 命令，该选项从文件中读取提交消息：

```
git commit --file .git/MERGE_MSG 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2012-12-19T22:23:09.213

只需将编辑器设置为不执行任何操作的命令：

```
GIT_EDITOR=true git commit 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-12-19T22:26:25.977

显然，这里的“正确”答案是让您的开发人员在生成合并提交时为您的团队遵循正确的做法。请注意，您想要的行为曾经是默认行为，并且直到最近 git 才开始要求“人工生成”的合并提交消息。这是有原因的，而且开发人员不会用毫无意义的信息来缩短流程。

也许开发人员在他/她应该改基础时生成合并提交？

也就是说，合并提交是 的输出`git fmt-merge-msg`，您必须将合并提交的父级提供给它。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2017-02-16T15:41:16.003

`git commit --file .git/MERGE_MSG`正如已经提到的那样很好，但它忽略了几点：

*   当前目录不是最顶层目录
*   当前存储库是一个 Git 子模块，因此没有`.git`目录，只有一个文件`.git`。

并且可以选择：

*   `MERGE_MSG`包含有关有冲突的文件的一些信息。

前两点可用于`git rev-parse`：

```
git commit -F "$(git rev-parse --git-dir)/MERGE_MSG" 
```

或者，或者，使用 Git 别名：

```
commit-merge = !cat $(git rev-parse --git-dir)/MERGE_MSG | git commit -F - 
```

这适用于“普通”存储库和子模块。如果`#`应该丢弃 - 标记的冲突标记，为简单起见，可以只取合并消息的第一行：

```
git commit -m $(head -1 $(git rev-parse --git-dir)/MERGE_MSG) 
```

或另一个别名：

```
commit-merge = !head -1 $(git rev-parse --git-dir)/MERGE_MSG | git commit -F - 
```

我不得不`-F`在别名中使用该键，因为我无法让 Git 发出要在使用 bash 生成的命令中处理的引号（否则`git commit`会在合并期间抱怨部分提交）。

* * *

[两天前发布](https://github.com/git/git/blob/master/Documentation/RelNotes/2.12.0.txt)的 Git 2.12.0引入`git merge --continue`了在合并期间因冲突而停止的合并提交。`--no-edit`它也适用于子模块，但至少目前不接受，因此建议编辑器在结束合并之前更改提交消息。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2021-02-11T15:12:42.357

您可以使用没有消息的默认**“git commit” 。**这将触发控制台中的 VIM 编辑器。默认信息将出现在 VIM 中，只需使用命令**":wq"**应用合并并退出 VIM。

演练以下步骤：

```
git commit (hit enter)

:wq (to exit and apply merge in VIM editor) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-06-26T18:47:17.893

如果您真的想强制执行此规则，那么可能有一种方法可以使用 git 挂钩强制执行此规则。

每次发生合并冲突时，“组合差异”都会显示哪些文件发生冲突：`git diff HEAD HEAD^1 HEAD^2 --name-only`. 我不知道从技术上讲，组合差异是否有可能显示比冲突文件更多的文件*。*

但是，假设它像我们想要的那样工作（这是一个假设），那么你可以有一个 git`commit-msg`钩子来检查*用户输入*的消息并断言

1.  这是合并提交吗？
2.  如果是这样，组合差异是否显示文件？
3.  如果是这样，字符串“冲突：”是否后跟这些文件名？

如果这些条件失败，则让脚本打印以筛选错误的解释，然后返回非零以中止提交。您可以让开发人员安装此提交挂钩，或者您也可以将其安装在服务器上以确保执行它。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-05-19T11:55:18.683

```
$git commit --amend --no-edit 
```

*   它会接收您之前提交的消息，并且不会有任何改变。
*   当您解决任何问题`merge conflict`并希望获取先前提交的消息并在您的应用中应用主代码`feature branch`以避免冲突时，这将很有帮助。

# python - xlwt（python）中的页眉/页脚。

> ID：13961849
> 
> 赞同：3
> 
> 时间：2012-12-19T21:50:43.660
> 
> 标签：python, xlwt

你好！

我正在使用 xlwt 包用 python 创建 excel 文件。我想知道，有没有办法使用这个模块为每张纸设置特定的页眉/页脚？

非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-04T13:16:56.993

```
sheet = book.get_sheet(0)
sheet.header_str = 'what you prefer'
sheet.footer_str = 'things' 
```

您可以使用简单的 for 语句对书中的所有工作表执行此操作。

```
for s in book.sheets():
    s.header_str = 'what you prefer' 
```

# jpa - 管理 @NamedNativeQuery 和架构

> ID：13961855
> 
> 赞同：5
> 
> 时间：2012-12-19T21:51:24.173
> 
> 标签：jpa, schema, nativequery

我有很多`EntityManager`，每个模式都有一个（我使用`entity-mappings`文件将 EM 与模式映射）。有用。

当我使用`@NamedQuery`它时，它就像一个魅力，但是当我使用`@NamedNativeQuery`模式时，它没有被使用。我必须符合条件`SELECT foo FROM schema.table`。

这是正确的行为吗？

我认为不可能通过参数`@NamedNativeQuery`来动态传递模式（我相信只有列可以是动态的，而不是表或模式或其他任何东西）所以我该如何使用`@NamedNativeQuery`动态模式呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-10-28T16:40:01.667

用“{h-schema}”作为表名的前缀，例如`SELECT foo FROM {h-schema}table`

（礼貌地[从会话工厂以编程方式获取休眠默认模式名称？](https://stackoverflow.com/questions/4832579/getting-hibernate-default-schema-name-programmatically-from-session-factory)）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T07:48:54.613

文档摘录：

*   **NamedNativeQuery ：**指定命名的本机 SQL 查询。查询名称的范围是持久性单元。
*   **NamedQuery ：**指定 Java Persistence 查询语言中的静态命名查询。查询名称的范围是持久性单元。

没有直接指定它`NamedNativeQuery`是静态的，但两者的范围相同，之后不能更改，这是所需的行为。

命名查询意味着由多个模块访问 - 应用程序范围，由唯一名称标识，因此它们是静态和常量。您可以尝试动态构建查询字符串并可以从中创建本机查询，而不是命名本机查询。

# uiviewcontroller - 将属性更改分配给子视图的最佳设计模式是什么？

> ID：13961861
> 
> 赞同：0
> 
> 时间：2012-12-19T21:51:39.837
> 
> 标签：uiviewcontroller, nsuserdefaults, cocoa-design-patterns

假设我在 NSuserdefaults 中有一个设置应该影响很多（但不是全部）UIView 对象的属性，例如字体大小。该设置也可以从“主”视图控制器更改，并且应该“分发”到 UILabel 对象，这些对象位于 UISplitviewController 内的 UINavigationController 内的 UITableView 内的 UITableviewcell 中的 UIView 中，等等......

如果我在控制器和视图层次结构的所有级别上创建此属性，并在设置父级中的属性时设置该属性，这会花费大量代码。Apple 似乎更喜欢这种模式，通过将 managedObjectContext 沿链传递给子控制器来管理它。但这似乎有点矫枉过正。很多代码只是为了传递属性的值，而没有做任何事情。但是，我确实使用此模式一次在视图的所有子视图中设置属性（通过递归遍历所有子视图）。

委托似乎同样糟糕，除非委托是顶级父视图控制器。但随后我会将委托传递给所有子视图控制器。

我应该改用通知吗？我已经有一个控制器通过 NSUserDefaultsDidChangeNotification 监听 NSUserDefaults 中的（所有）更改。当我的设置更改时，该控制器是否应该发布特定通知？在这种情况下，谁应该听呢？是否应该由视图控制器负责所涉及的视图？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T22:32:06.517

在阅读了更多内容后，我在 Buck / Yacktman 的 Cocoa Design Patterns 一书中找到了建议，正如他们所说：作为一般规则，当可能有许多对象可能观察到通知时，请使用通知。当恰好一个对象有机会影响或响应正在发生的变化时，请使用委托。

所以通知就是答案。

# javascript - 我可以使用 indexOf(input) 吗？

> ID：13961862
> 
> 赞同：4
> 
> 时间：2012-12-19T21:51:48.153
> 
> 标签：javascript

```
function myFunction(input){
var number_of_images = input.parentNode.getElementsByTagName("img")
var image_clicked = number_of_images.indexOf(input)
alert ("you clicked on image number "+image_clicked)
} 
```

我正在建立一个包含三张图像的评分量表。我想告诉用户他点击了三张图片中的哪一张。我在所有三个图像 onClick(this) 上都有 onClick 事件。然后，我尝试使用 indexOf(input)，其中 input 是指从 onclick(this) 传递的参数 (this)。它不工作。¿ 任何替代建议？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T22:00:36.033

调用`indexOf`它不起作用，因为结果是 (live) [`NodeList`](https://developer.mozilla.org/en/DOM/NodeList)，并且不提供 Array 方法。但是，您仍然可以在节点列表上应用[Array`indexOf`方法](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/indexOf)（通过使用[`.call`Function met](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/call)），因为它是通用的：

```
var images = input.parentNode.getElementsByTagName("img");
var index = Array.prototype.indexOf.call(images, input); 
```

请注意，较旧的 IE 不支持 indexOf，您需要对其进行[填充](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/indexOf#Compatibility)。

# python - tornado web http请求阻塞其他请求，如何不阻塞其他请求

> ID：13961863
> 
> 赞同：4
> 
> 时间：2012-12-19T21:51:49.263
> 
> 标签：python, http, asynchronous, tornado, nonblocking

```
import tornado.web
import Queue

QUEUE = Queue.Queue()

class HandlerA( tornado.web.RequestHandler ):
    def get(self):
        global QUEUE
        self.finish(QUEUE.get_nowait())

class HandlerB( tornado.web.RequestHandler ):
    def get(self):
        global QUEUE
        QUEUE.put('Hello')
        self.finish('In queue.') 
```

**问题：** HandlerA 阻塞 HandlerB 10 秒。

1.  浏览器 A 由 HandlerA 处理并等待...
2.  浏览器 B 由 HandlerB 处理并等待....直到超时异常

**目标**

1.  浏览器 A 由 HandlerA 处理并等待...
2.  由 HandlerB 处理并**返回的浏览器 B**
3.  HandlerA出队后**返回**

这是非阻塞、异步、epoll 或套接字的问题吗？

谢谢！

**更新：**

我用一个新线程更新了这段代码来处理 Queue.get_nowait() 请求。我担心这是一个可怕的解决方案，考虑到我一次将有数千个请求，因此一次会有数千个线程。`epoll`我正在考虑在不久的将来转向一种风格。

```
class HandlerA( tornado.web.RequestHandler ):
    @tornado.web.asynchronous
    def get(self):
       thread.start_new_thread(self.get_next)

    def get_next(self):
        global QUEUE
        self.finish(QUEUE.get_nowait()) 
```

现在这不是处理它的最佳方式......但至少它是一个开始。

**解决方案**

在这里找到[在 Tornado 中运行阻塞代码](https://stackoverflow.com/questions/14293238/running-blocking-code-in-tornado/14298520)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T21:59:41.527

这是 Python。所以，`time.sleep`总会堵住人流！为了使用 Tornado 在 10 秒后调用动作，您需要使用`tornado.ioloop.add_timeout`函数并将回调作为参数传递。[文档以获取更多信息](http://www.tornadoweb.org/documentation/ioloop.html#tornado.ioloop.IOLoop.add_callback)。

# javascript - 如何让 ASP.net 在 JavaScript jQuery.Load 调用中填写本地服务器

> ID：13961864
> 
> 赞同：0
> 
> 时间：2012-12-19T21:51:51.147
> 
> 标签：javascript, jquery, asp.net, load, bpopup

我有一个 Javascript 函数，我想在其中调用 jQuery.Load() 来加载文件。如何让 ASP.Net 填写本地服务器名称，以便我可以只提供相对路径？

这样做的原因是我可以提供基础，比如“http://www.mydomain.com/”，但是我希望能够在本地进行测试，而不必在每个构建中发布。我只想加载一个本地文件。

我的第一个想法只是“/MyFolder/MyPage.aspx”，但这不起作用。然后我想到了“~/MyFolder/MyPage.aspx”，但这也不起作用。

我认为它应该是某种 ASP.Net 指令，只是我不确定是什么。

我想给出一些代码来展示实际的使用和有效的方法。

```
<head runat="server">
   <script type="text/javascript">
        // <![CDATA[
         function DoPopupSignin()
        {
            var urlLoad = "http://" + window.location.host + '/Candiates/Login.aspx';

            // Triggering bPopup when click event is fired
            $('#popupSigninMaster').bPopup({
                //modalClose: false,
                //opacity: 0.6,
                //positionStyle: 'fixed', //'fixed' or 'absolute'
                content: 'iframe', //'iframe' or 'ajax'
                contentContainer: '.content',
                loadUrl: urlLoad, //Uses jQuery.load()
        });
        }
        // ]]> 
    </script>
</head> 
```

我试图让我的 jQuery Popup 工作从另一个文件加载内容。我的代码使用了我找到的免费 jQuery 弹出控件[jQuery.bPopup.js](http://dinbror.dk/bpopup/)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T21:55:54.993

这是一个反复出现的痛苦，但我使用这样的东西：

```
public static Uri ToAbsoluteUri(this string path)
{
  Uri uri;
  if (Uri.TryCreate(path, UriKind.Absolute, out uri)) return uri;

  var serverUrl = HttpContext.Current.Request.Url.GetLeftPart(UriPartial.Authority);
  var serverUri = new Uri(serverUrl);
  return new Uri(serverUri, path);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T22:28:23.527

在 JavaScript 中，当您准备查询时，您可以使用`window.location.host`.

```
var path = window.location.host + '/relative/path/file.ext';
$.load(path); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T21:58:52.683

.NET 中的控件/表单有一种`ResolveUrl(string)`方法可以让您使用 ~/ pathing 来解析相对路径。否则，您使用`VirtualPathUtility`静态类。

# java - Java 可以批量调用 SQL 存储过程吗？

> ID：13961866
> 
> 赞同：3
> 
> 时间：2012-12-19T21:52:02.787
> 
> 标签：java, mysql, jdbc

[Java：使用 PreparedStatement 将多行插入 MySQL](https://stackoverflow.com/questions/4355046/java-insert-multiple-rows-into-mysql-with-preparedstatement)包括将多个 INSERT 批处理到一个操作中。我想知道是否可以对存储过程的调用做同样的事情，更具体地说是对 MySQL 的调用？如果是这样，将使用什么语句类？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2019-03-12T07:16:04.187

如果您有这样的存储过程：

```
JDBC CallableStatement Stored procedure IN parameter example.
CREATE OR REPLACE PROCEDURE insertEMPLOYEE(
   e_id IN EMPLOYEE.EMPLOYEE_ID%TYPE,
   e_name IN EMPLOYEE.NAME%TYPE,
   e_salary IN EMPLOYEE.SALARY%TYPE)
IS
BEGIN

  INSERT INTO EMPLOYEE ("EMPLOYEE_ID", "NAME", "SALARY") 
  VALUES (e_id, e_name, e_salary);

  COMMIT;

END; 
```

你可以使用 executeBatch() 来做你想做的事。例子：

```
Connection conn = null;
CallableStatement callableStatement = null;
String proc = "{call insertEMPLOYEE(?,?,?)}";
try{            
    //get connection
    conn = JDBCUtil.getConnection();

    //create callableStatement
    callableStatement = conn.prepareCall(proc);

    callableStatement.setInt(1, 7);
    callableStatement.setString(2, "Harish Yadav");
    callableStatement.setInt(3, 50000);
    callableStatement.addBatch();

    callableStatement.setInt(1, 8);
    callableStatement.setString(2, "Abhishek Rathor");
    callableStatement.setInt(3, 50000);
    callableStatement.addBatch();

    //execute query
    callableStatement.executeBatch();

    //close connection
    callableStatement.close();
    conn.close();

     System.out.println("Records inserted successfully.");
}catch(Exception e){
    e.printStackTrace();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T21:54:40.513

您可以使用`executeBatch()`. 看这个[例子](http://www.careerride.com/java-batch-updates-using-CallableStatement-interface.aspx)

注意：我没有通过在本地运行来验证示例，但根据文档它应该可以工作。

# php - PHP exec更改编码

> ID：13961870
> 
> 赞同：19
> 
> 时间：2012-12-19T21:52:17.500
> 
> 标签：php, encoding, utf-8, exec

我需要使用 php exec 命令来处理 UTF-8 文件名。问题是 php`exec`命令似乎不理解 utf-8。我使用这样的东西：

```
echo exec('locale charmap'); 
```

返回`ANSI_X3.4-1968`

看着[这个](https://stackoverflow.com/questions/3410424/command-line-character-encoding-from-phps-exec)SO question，解决方案看起来像这样：

```
echo exec('LANG=de_DE.utf8; locale charmap'); 
```

但我仍然得到相同的输出：`ANSI_X3.4-1968`

另一方面 - 如果我在 bash 命令行上执行这个 php 命令：

```
php -r "echo exec('LANG=de_DE.UTF8 locale charmap');" 
```

输出为 UTF-8。所以问题是：

1.  为什么在 bash 和 apache_module/web 页面上执行 php 命令会有不同的结果？
2.  `exec`如果它在网站内作为 apache 模块运行，如何设置 UTF-8 ？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-12-20T10:15:05.503

要回答我自己的问题 - 我找到了以下解决方案：

使用 PHP 设置语言环境变量

```
$locale='de_DE.UTF-8';
setlocale(LC_ALL,$locale);
putenv('LC_ALL='.$locale);
echo exec('locale charmap'); 
```

这设置为 / 返回 `UTF-8`。所以我能够将特殊字符和变音符号传递给 linux shell 命令。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2019-10-13T22:28:56.513

这为我解决了这个问题（来源：[这里的评论](https://x10hosting.com/community/threads/shell_exec-how-to-make-utf8.93993/#post-513728)）：

```
<?php
putenv('LANG=en_US.UTF-8'); 
$command = escapeshellcmd('python3 myscript.py');
$output = shell_exec($command);
echo $output;
?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-02-11T13:08:35.240

我有类似的问题。我的程序返回给我一些德语字母，例如：üäöß。这是我的代码：

```
$programResult = shell_exec('my script'); 
```

变量`$programResult`包含德语变音符号，但编码错误。为了正确编码，您可以调用`utf8_encode()`函数。

```
$programResult = shell_exec('my script');
$programResult = utf8_encode($programResult); 
```

# android - 在 InputMethod 中设置文本

> ID：13961873
> 
> 赞同：0
> 
> 时间：2012-12-19T21:52:19.680
> 
> 标签：android, cursor, clipboard, android-input-method

我正在开发一个新的 android 应用程序，我正在为服务提供一些参数，其中一个是我想在显示时在 inputmethod 中设置的字符串。

为了清楚起见，当用户处于这种情况时： ![在此处输入图像描述](../Images/a1dac82596cbd89542127e3619a855b7.png)

我想以编程方式更改要输入的文本，而无需引用edittext或设置任何光标。

我真的不知道该怎么做。我应该使用 inputmethodmanager 还是获取光标的实例？

知道我该怎么做吗？

希望我的问题很清楚。谢谢

# iphone - 从 UIView 子类访问 UINavigationController

> ID：13961876
> 
> 赞同：0
> 
> 时间：2012-12-19T21:52:34.223
> 
> 标签：iphone, objective-c, ios, uiscrollview, uinavigationcontroller

我有一个 UIScrollView 的子类。这个自定义子类有一个方法应该初始化新 UINavigationController 的打开。我知道子类不处理这种类型的方法，但我将如何以理想的方式处理这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T21:54:39.273

我认为处理这个问题的理想方法是为您的子类声明一个自定义委托协议方法`UIScrollView`。然后，您将设置您的`UIViewController`，我假设它是自定义滚动视图的父级，当它拦截此委托回调时，只需执行一个简单的操作：

```
[self.navigationController popViewControllerAnimated:YES]; 
```

# ms-access - 如何打开某人发送给我的 MS Access 数据库

> ID：13961877
> 
> 赞同：2
> 
> 时间：2012-12-19T21:52:38.793
> 
> 标签：ms-access

我已经通过 dropbox 发送了一个 MS Access 数据库，所以我已经下载并保存了它。

它似乎打开得很好，但如果我尝试打开任何表单，则表示它是无效路径，它看起来像：c:\users\xxx_xxxx\dropbox\database.mdb 不是有效路径。xxx_xxxx 是发送它的人的名字，它不是我电脑上的路径。但是我正在打开他发给我的 database.mdb 文件，那么它怎么会引用另一个路径。为什么不 c:\my computer\etc 等？我该如何改变它？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T22:42:38.293

如果您的 Access 版本 >= 2007，请从功能区的“数据库工具”部分打开“链接表管理器”。

![链接表管理器位于功能区的数据库工具部分](../Images/5b1acb95ebcf9adffcc082d295680578.png)

在早期的 Access 版本中，我认为 Linked Table Manager 是 Database Tools 子菜单下的一个菜单项。希望你会很容易地找到它。

在下一个屏幕截图中，我突出显示了一个链接表。

![链接表显示在链接表管理器中](../Images/30662fd60bde098b064e1223e0cc626f.png)

该链接的源表位于名为“C:\share\Access\BigDb_secure.mdb”的数据库文件中。如果我重新命名了该数据库文件或将其移动到其他位置，我可以选中该链接旁边的框，然后在底部的框中​​再次选中“*始终提示新位置*”，然后单击“确定” . 接下来，访问将允许我浏览到正确的数据库文件，然后将其用于链接。

因此，在使用特定 db 文件的链接旁边放置复选标记，然后向链接表管理器显示该 db 文件的当前位置。

# browser - 阿拉伯语和其他从右到左的蛞蝓好吗？

> ID：13961882
> 
> 赞同：1
> 
> 时间：2012-12-19T21:53:02.160
> 
> 标签：browser, arabic, slug, right-to-left

我正在创建一个多语言站点，其中一个项目对每种站点语言都有一个 slug。

对于阿拉伯语蛞蝓（我假设任何其他从右到左的语言），当您尝试突出显示它时它会表现得很奇怪。光标在 RTL 文本中向相反方向移动..等。这不是什么大不了的事，但它让我觉得这可能不是“正常”或“好的”。

我看过一些带有阿拉伯语 slug 的网站，但我也看到了仍然使用英语 slug 的完全阿拉伯网站。

一种方式或另一种方式有好处吗？建议的方法？按照我的方式做吗？欢迎任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T15:50:29.353

我想你所说的“slug”是指一个页面的直接永久 URL。如果你不这样做，你可以忽略这个答案的其余部分:)

此类 URL 将起作用，但如果可以，请避免使用它们。它从右到左的事实实际上并不是最糟糕的问题。任何非 ASCII URL 最糟糕的问题是，在很多情况下它会显示如下：[https ://ar.wikipedia.org/wiki/%D9%86%D9%87%D8%B1_%D9%81 %D8%A7%D8%B1%D8%AF%D8%A7%D8%B1](https://ar.wikipedia.org/wiki/%D9%86%D9%87%D8%B1_%D9%81%D8%A7%D8%B1%D8%AF%D8%A7%D8%B1)（它只是阿拉伯维基百科中随机文章的链接）。即使标题很短，您也会看到一长串百分号和数字，因为每个非 ASCII 字符都会变成大约六个 ASCII 字符。例如，当您必须将其粘贴到电子邮件中时，这会变得非常难看。

我用希伯来语写了一个博客，然后手动将每篇文章的 slug 更改为某个 ASCII 名称。

# asp.net-mvc-4 - ASP.NET MVC URL Routing with parameters in the middle

> ID：13961886
> 
> 赞同：3
> 
> 时间：2012-12-19T21:53:24.537
> 
> 标签：asp.net-mvc-4, asp.net-mvc-routing

I have a controller called Quote, with an Index method that requires a requestId parameter. The URL appears as such

```
/Quote/{requestId}. 
```

Additionally, I have a method called ApplicantInfo which is specific to the quote and routes as such

```
/Quote/{requestId}/ApplicantInfo. 
```

But when I use the Url.Action helper like so

```
@Url.Action("Index","Quote",new { requestId = {requestId}}) 
```

It gives me a url of

```
/Quote/ApplicantInfo?requestId={requestId} 
```

which does not route correctly.

Obviously, I can manually create the URL string, but before I throw in the towel I wanted to know if I was missing something, for instance an override to the `Url.Action` method that will output the correct `Url`.

TIA

*ROUTES*

```
routes.MapRoute(
            "QuoteInfo",
            "Quote/{requestid}", 
            new { controller = "Quote", action="Index" });

routes.MapRoute(
            "QuoteApplicant",
            "Quote/{requestid}/ApplicantInfo", 
            new { controller = "Quote", action = "ApplicantInfo" });

routes.MapRoute(
             "Default",
             "{controller}/{action}/{id}", 
     new { controller = "Home", action="Index", id = UrlParameter.Optional }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T04:16:50.673

I was able to get do something similar to this like this

## Route

Define a route in `Global.asax.cs` or whereeve you override your routes

```
 routes.MapRoute(
            "Organization_default",
            "{controller}/{requestId}/{action}", 
            new { 
                  controller = "home", 
                  action = "index", 
                  requestId = "default",
                  id = UrlParameter.Optional 
             }, null); 
```

## Controller

```
 public ActionResult Question(string requestId)
    {
        ViewData["value"] = requestId;
        return View();
    } 
```

## View

```
@{
    ViewBag.Title = "Index";
    var value = ViewData["value"];
}

<h2>Stackoverflow @value</h2>
@Html.ActionLink("Click Here", 
        "question", "StackOverflow", new { requestId ="Link" }, new{   @id="link"}) 
```

## Screenshot

screenshot of how the links appear with this route, I defined the ![enter image description here](../Images/cef53e4befbfa5baed2445acfec16c70.png)

## Catch

You **CANNOT** have another route as `{controller}/{action}/{key}` defined before your custom this route. If you do the other route override your custom route.

If you need both the routes to co-exist then you would have to define a separate **Area** and define your custom route overriding `RegisterArea`

```
public override void RegisterArea(AreaRegistrationContext context)
{
   //..custom route definition
} 
```

# google-maps - 通过视口（不是中心或地理编码）获取 Google 地图或获取相邻地图

> ID：13961887
> 
> 赞同：1
> 
> 时间：2012-12-19T21:53:25.300
> 
> 标签：google-maps, google-maps-api-3, google-static-maps

我正在开发一个需要检索彼此相邻的地图的应用程序。谷歌静态地图只允许根据地址（地理编码）或中心（latLng）设置位置。我需要能够获得基于视口（左上纬度，右下纬度）的地图，或者只是通过将相邻地图获取到当前拥有的地图。我试图根据当前的缩放级别和像素大小进行某种数学运算以获取下一个中心，但没有成功。

我的客户将获得营业执照，所以不用担心这些限制。

Thxs 的帮助真的停留在这一点上。欢迎所有建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T21:04:11.640

在网上找到了答案。原来谷歌地图使用墨卡托投影。在发现这一点之后，数学变得更容易了。我需要代码以确定的缩放级别从像素转换为 latlng。

这是java中的代码：

```
static final double OFFSET = 268435456;
static final double OFFSET_RADIUS = OFFSET / Math.PI;
static final double MATHPI_180 = Math.PI / 180;
static private final double preLonToX1 = OFFSET_RADIUS * (Math.PI / 180);

public static double LonToX(double lon) {
    return Math.round(OFFSET + preLonToX1 * lon);
}

public static double LatToY(double lat) {
    return Math.round(OFFSET - OFFSET_RADIUS * Math.log((1 + Math.sin(lat * MATHPI_180)) / (1 - Math.sin(lat * MATHPI_180))) / 2);
}

public static double XToLon(double x) {
    return ((Math.round(x) - OFFSET) / OFFSET_RADIUS) * 180 / Math.PI;
}

public static double YToLat(double y) {
    return (Math.PI / 2 - 2 * Math.atan(Math.exp((Math.round(y) - OFFSET) / OFFSET_RADIUS))) * 180 / Math.PI;
}

public static double adjustLonByPixels(double lon, int delta, int zoom) {
    return XToLon(LonToX(lon) + (delta << (21 - zoom)));
}

public static double adjustLatByPixels(double lat, int delta, int zoom) {
    return YToLat(LatToY(lat) + (delta << (21 - zoom)));
} 
```

希望这可以帮助某人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T22:37:57.007

使用[Map](https://developers.google.com/maps/documentation/javascript/reference?hl=pt-BR#Map)类的方法`getBounds`和方法。`getCenter``getZoom`

# python - 如何从 fql 查询创建列表？

> ID：13961888
> 
> 赞同：0
> 
> 时间：2012-12-19T21:53:24.687
> 
> 标签：python, facebook, json, list

我有从 FQL 查询返回的以下内容：

```
posts_fql = graph.fql({'posts':"SELECT uid, name, pic, username FROM user WHERE is_app_user=1 AND uid IN (SELECT uid2 FROM friend WHERE uid1 = me())"})     
print ast.literal_eval(json.dumps(posts_fql))

    [
  {
    'fql_result_set': [
      {
        'username': 'sahithi.akasapu',
        'pic': 'http://profile.ak.fbcdn.net/hprofile-ak-ash3/173521_1033451070_925702476_s.jpg',
        'uid': 1033451070,
        'name': 'Sahithi Akasapu'
      },
      {
        'username': 'joe.kaster.73',
        'pic': 'http://profile.ak.fbcdn.net/static-ak/rsrc.php/v1/yh/r/C5yt7Cqf3zU.jpg',
        'uid': 100004855536430,
        'name': 'Joe Kaster'
      }
    ],
    'name': 'posts'
  }
] 
```

我正在尝试使用以下方法在 python 中创建一个列表：

```
user_list= []
for user in posts_fql:
    uid = user['fql_result_set'][0]['uid']
    username = user['fql_result_set'][0]['username']
    name = user['fql_result_set'][0]['name']
    pic = user['fql_result_set'][0]['pic']
    user_list.append([uid, username, name, pic]) 
```

当我打印 user_list 时，只打印第一组数据（用于用户“测试”）。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T21:57:57.647

因为你的数据结构错误。`fql_result_set`不在用户列表中。它去：

```
posts_fql = [{ 'fql_result_set' : [{user_dict1}, {user_dict2}] }] 
```

所以，你真正想要的是：

```
user_list= []
for user in posts_fql[0]['fql_result_set']:
    uid = user['uid']
    username = user['username']
    name = user['name']
    pic = user['pic']
    user_list.append([uid, username, name, pic]) 
```

# c# - 从迭代器块返回单个元素 - 迭代器不能包含返回语句

> ID：13961890
> 
> 赞同：5
> 
> 时间：2012-12-19T21:53:30.443
> 
> 标签：c#, .net, c#-4.0, iterator, yield

假设我有以下方法。在一些来

```
 public IEnumerable<ValidationResult> Validate(UserLoginCommand command)
    {
        User user = userRepository.Get(u => u.Email == command.UserEmail);
        if(user != null)
        {
            if(!user.Activated)
            {
                return new IEnumerable<ValidationResult>() {new ValidationResult("NotActived", Resources.UserNotActivated)};
            }

            if(user.IsPasswordIncorrent)
            {

                yield return new ValidationResult("IncorrectPassword", Resources.IncorrentPassword);

            }

        }
    } 
```

实际情况实际上要复杂一些，但出于说明目的，我遗漏了很多内容。

关键是在某些情况下，我想迭代器继续收集多个错误......但在其他情况下，有一个致命错误，我只想返回一个错误，但它不会让我：

```
Iterator cannot contain return statement 
```

我应该怎么办？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-19T22:05:16.973

如果你只想返回一个大小为 1 的集合，你可以这样做：

```
if(!user.Activated)
{
  yield return new ValidationResult("NotActived", Resources.UserNotActivated);
  yield break;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-19T22:07:38.910

如错误消息所示，您不能将`yield return`语句和`return`语句混合到一个方法中。

您有两种通用方法：

1.  该方法应热切评估；您应该使用所有`return`语句，找到一种将所有`yield`语句转换为返回的方法。
2.  该方法应该使用延迟执行，想办法把所有的`return`语句都变成`yield`语句。

在您的情况下，它可能是＃2，但在其他情况下，任何一个都可能是合适的。

现在，如何将 a`yield`变成 a `return`：

将单个元素包装成某种集合并返回：

```
return new[]{ someItemToReturn }; 
```

或者

```
return Enumerable.Repeat<T>(someItemToReturn, 1); 
```

现在，如何将 a`return`变成 a `yield`：

```
foreach(var item in collectionYouWereReturning)
    yield return item; 
```

`yield break;`即使方法没有达到它的自然结束，您也可以使用它来指示序列已经结束。请注意，`yield break;`应该很少使用。经常使用它会产生代码异味（但这似乎是合适的情况）。

现在，理想情况下，我们应该有某种`yield foreach`关键字，这样您就可以在迭代器块内产生一个集合，但到目前为止还没有这样的关键字被添加到该语言中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-19T22:01:53.663

该 return 语句实际上不应该是一个收益吗？

```
yield return ValidationResult("NotActived", Resources.UserNotActivated); 
```

如果你真的需要返回一个收藏，你也可以`yield return`收藏一个（就像你拥有它一样），因为你只有一个，所以没有必要。

此外，如果您想明确停止枚举，您可以使用`yield break;`

# java - 如何将大型 .txt 文件的内容保存在 HashMap 中但仅显示一行（随机）

> ID：13961895
> 
> 赞同：1
> 
> 时间：2012-12-19T21:54:09.530
> 
> 标签：java, io, hashmap

在 Android 上创建一个将使用 RMI 和 Tomcat 的小型战舰游戏。

我需要从文本文件“boards.txt”加载数据，并可能将其存储在 HashMap 中以便查询。

我无法附加该文件，但下面是记事本中 .txt 文件的屏幕截图。它显示了 10,000 个战舰游戏板的板布局（我认为无论如何都是这个数字），它们是 10x10 网格。

因此，文件的每 100 个字符将是不同船只的位置和 10 x 10 网格的空格，每个网格由换行符分隔。

我正在努力的是实际的解析。我认为将数据保存到 HashMap 将使搜索随机板布局变得更加容易。下面是我目前用来读取数据的代码。

```
public static void main(String[] args) throws FileNotFoundException {
        Scanner scanner = new Scanner(new FileReader("C:\\Path\\boards.txt"));

        HashMap<String, String> map = new HashMap<String, String>();

        while (scanner.hasNextLine()) {
            String columns = scanner.nextLine();
            map.put(columns, columns);
        }

        System.out.println(map);
    } 
```

现在我拥有它的主要原因是为了摆脱错误。以前我的代码是这样的：

```
public static void main(String[] args) throws FileNotFoundException {
        Scanner scanner = new Scanner(new FileReader("C:\\Path\\boards.txt"));

        HashMap<String, String> map = new HashMap<String, String>();

        while (scanner.hasNextLine()) {
            String[] columns = scanner.nextLine().split(" ");
            map.put(columns[0], columns[1]);
        }

        System.out.println(map);
    } 
```

但是，我遇到了一个越​​界异常。由于事实上没有空格可以分割。

好的，所以我的主要问题是，如何将整个 .txt 文件保存到 HashMap 并一次只显示一行 100 个字符。

其次（较低优先级） - 我想随机选择一行，这样我就可以创建一个 1-10000 之间的随机数来显示一行。我曾想过使用 String、Integer HashMap 并以某种方式为每一行设置一个索引值，但我不知道该怎么做。

**编辑对不起，我忘了添加屏幕截图。这里是： ![在此处输入图像描述](../Images/87930a2a236ec45d01b9253e06e95fec.png)

感谢您的回答，我现在将阅读它们

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T22:13:51.590

直接回答您的问题：

1）你几乎有你的文件阅读器，但你不必费心`Map`，一个`List`就足够了。

```
Scanner scanner = new Scanner(new FileReader("C:\\Path\\boards.txt"));
List<String> lines = new ArrayList<String>();
while (scanner.hasNextLine()) {
    String columns = scanner.nextLine();
    lines.add(columns);
} 
```

2）要抓取一条随机线，只需在`List`.

```
Random random = new Random();
int randomLineIndex = random.nextInt(lines.size());
String randomLine = lines.get(randomLineIndex); 
```

现在，说了这么多，如果您不需要加载整个文件，请不要。如果您只需要从文件中随机获取一行，那么就直接使用它并节省自己的计算和内存。

为此，您首先需要知道文件中的行数。 [这个问题](https://stackoverflow.com/questions/1277880/how-can-i-get-the-count-of-line-in-a-file-in-an-efficient-way)给你：

```
String file = "C:\\Path\\boards.txt";
BufferedReader reader = new BufferedReader(new FileReader(file));
int lineCount = 0;
while (reader.readLine() != null) lineCount++;
reader.close(); 
```

现在您知道有多少行并且可以随机选择一个：

```
Random random = new Random();
int randomLineIndex = random.nextInt(lineCount); 
```

然后你可以抓住那条线而忽略其余的：

```
reader = new BufferedReader(new FileReader(file));
int i = 0;
while (++i < randomLineIndex)
    // Skip all lines before the one we want
    reader.readLine();
String randomLine = reader.readLine(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T22:24:59.210

我就是这样做的。您最多可以使用相同的种子重玩 2^48 种不同的游戏。这避免了读取文件或在内存中存储索引的需要。您可以根据需要重新创建任何棋盘游戏。

```
public class Baord {
    private static final int[] SHIP_SIZES = {4, 4, 3, 3, 3, 2, 2, 2, 2,  1, 1};
    public static final char EMPTY = '.';

    private final Random random;
    private final char[][] grid;
    private char letter = 'a';
    private final int width;
    private final int height;

    public Baord(int height,int width,  int seed) {
        this.width = width;
        this.height = height;
        this.random = new Random(seed);
        this.grid = new char[height][width];
        for (char[] chars : grid)
            Arrays.fill(chars, EMPTY);
        for (int len : SHIP_SIZES)
            placeShip(len);
    }

    private void placeShip(int len) {
        OUTER:
        while (true) {
            if (random.nextBoolean()) {
                // across
                int x = random.nextInt(width - len + 1);
                int y = random.nextInt(height);
                for (int j = Math.max(0, y - 1); j < Math.min(height, y + 2); j++)
                    for (int i = Math.max(0, x - 1); i < Math.min(width, x + len + 2); i++)
                        if (grid[j][i] > EMPTY)
                            continue OUTER;
                for (int i = 0; i < len; i++)
                    grid[y][x + i] = letter;

            } else {
                // down
                int y = random.nextInt(height - len + 1);
                int x = random.nextInt(width);
                for (int j = Math.max(0, x - 1); j < Math.min(width, x + 2); j++)
                    for (int i = Math.max(0, y - 1); i < Math.min(height, y + len + 2); i++)
                        if (grid[i][j] > EMPTY)
                            continue OUTER;
                for (int i = 0; i < len; i++)
                    grid[y + i][x] = letter;
            }
            break;
        }
        letter++;
    }

    public String toString() {
        StringBuilder ret = new StringBuilder();
        for (int y = 0; y < grid.length; y++)
            ret.append(new String(grid[y])).append("\n");
        return ret.toString();
    }

    public static void main(String... args) {
        for (int i = 0; i < 3; i++)
            System.out.println(new Baord(8, 16, i));
    }
} 
```

印刷

```
..........ddd...
.....aaaa.......
eee.......j.....
.............i..
..bbbb.......i.c
.......g.......c
.k.h...g...f...c
...h.......f....

ii..............
.....ccc..ff...b
...............b
aaaa...........b
.........j..h..b
....gg......h...
..............k.
eee..ddd........

.d.....eee.....f
.d.............f
.d..............
......j.ccc....g
.............b.g
.............b..
h.i..........b..
h.i...aaaa.k.b..

.......h....aaaa
.......h........
.e.........ccc..
.e..............
.e.bbbb...ii..ff
........d.......
.g..j...d.......
.g......d.....k.

............ccc.
.....bbbb.......
.ii.......k..d..
.....f.......d..
eee..f.......d..
................
.j.g........hh..
...g.aaaa....... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T21:58:44.553

为什么要使用键和值相同的 HashMap？您所描述的本质上只是一个数组，其中每个存储桶包含一行 100 个字符。拉出随机地图意味着创建一个介于 1-10000 之间的随机数并打印该存储桶的内容。

关于解析，我们需要从您的文件本身中查看一个示例，以帮助解决您遇到的任何语法问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-30T15:23:19.547

仅供参考。

`scanner.next().split(":");`不在时为我工作 `scanner.nextLine().split(":");`。

# java - 在 JAVA 中完成 MySQL 准备好的语句

> ID：13961907
> 
> 赞同：0
> 
> 时间：2012-12-19T21:55:05.670
> 
> 标签：java, mysql, prepared-statement

我正在用 JAVA 学习 MySQL，但不理解准备好的语句。从我将学习它中抽象出来，我想寻求帮助以完成此代码以“准备说明”:-)

```
String stringQuery = "INSERT INTO banlist (name, reason, admin, time, temptime, IP) VALUES (testNick, testPowod, testAdmin, CURRENT_TIMESTAMP, NOW(), NULL);=?";

PreparedStatement statement = this.connection.prepareStatement( stringQuery );
statement.setString( 1,  ); // after ' 1, ' we define what we want to get
ResultSet resultSet = statement.executeUpdate(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T21:59:05.720

这是我的做法：

```
String insertQuery = "INSERT INTO banlist(name, reason, admin, time, temptime, IP) VALUES (?, ?, ?, ?, ?, ?)";
PreparedStatement statement = this.connection.prepareStatement( stringQuery );
statement.setString(1, name);  // These values come from your code; dynamic
statement.setString(2, reason);
statement.setString(3, admin);
statement.setString(4, time);
statement.setString(5, tempTime);
statement.setString(6, ip); 
int numRowsAffected = statement.executeUpdate(); 
```

一定要适当地结束你的陈述。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T22:00:33.643

```
String stringQuery = 
    "INSERT INTO banlist (name, reason, admin, time, temptime, IP)"
    + " VALUES (?, ?, ?, CURRENT_TIMESTAMP, NOW(), NULL)";

PreparedStatement statement = this.connection.prepareStatement(stringQuery);
statement.setString(1, testNick);
statement.setString(2, testPowod);
statement.setString(3, testAdmin);
int inserted = statement.executeUpdate(); 
```

阅读[JDBC 教程](http://download.oracle.com/javase/tutorial/jdbc/basics/prepared.html)。

# c++ - 如何在 Linux 上以编程方式添加接口？

> ID：13961908
> 
> 赞同：2
> 
> 时间：2012-12-19T21:55:06.200
> 
> 标签：c++, linux, networking

如何在 Linux 上以编程方式添加任何接口？

有什么办法可以添加 eth、loop 或 tun 接口？可以通过netlink完成吗？

语言是 C++，操作系统是 Ubuntu。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-19T22:05:15.190

添加接口的方式取决于接口的种类。例如，通过打开并在您获得的文件描述符上设置几个s 来创建一个[tun 或 tap接口。](http://www.kernel.org/doc/Documentation/networking/tuntap.txt)[这是Linux 内核文档](http://www.kernel.org/doc/Documentation/networking/tuntap.txt)中的一个最小示例：`/dev/net/tun``ioctl`

```
 #include <linux/if.h>
  #include <linux/if_tun.h>

  int tun_alloc(char *dev)
  {
      struct ifreq ifr;
      int fd, err;

      if( (fd = open("/dev/net/tun", O_RDWR)) < 0 )
         return tun_alloc_old(dev);

      memset(&ifr, 0, sizeof(ifr));

      /* Flags: IFF_TUN   - TUN device (no Ethernet headers) 
       *        IFF_TAP   - TAP device  
       *
       *        IFF_NO_PI - Do not provide packet information  
       */ 
      ifr.ifr_flags = IFF_TUN; 
      if( *dev )
         strncpy(ifr.ifr_name, dev, IFNAMSIZ);

      if( (err = ioctl(fd, TUNSETIFF, (void *) &ifr)) < 0 ){
         close(fd);
         return err;
      }
      strcpy(dev, ifr.ifr_name);
      return fd;
  } 
```

# excel - Excel宏打开EXE

> ID：13961909
> 
> 赞同：0
> 
> 时间：2012-12-19T21:55:07.860
> 
> 标签：excel, vba, shell, exe

我正在尝试创建一个宏来打开驱动器 F/ 上的文件“test.exe”。在下面运行此代码时，我得到“运行时错误 5”。

```
Sub MacroTangoMike()
' MacroTangoMike Macro
RetVal = Shell("F:/test.exe", 1)
End Sub 
```

如果 test.exe 在 C/ 驱动器上，它可以正常工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T21:59:50.230

错误 5 是拒绝访问。您确定您对 F: 盘上的 EXE 具有执行权限吗？

此外，您可能应该在 Windows 上的路径中使用反斜杠 \ 而不是 /。

# jquery - 图像叠加动画，不能选择没有动画循环的叠加

> ID：13961910
> 
> 赞同：1
> 
> 时间：2012-12-19T21:55:24.377
> 
> 标签：jquery, jquery-selectors

我正在尝试编写自己的图像叠加动画。我的主要问题是动画不会让我选择叠加层。我想在里面放一个链接。动画有时也会加倍。我尝试使用`stop()`但无济于事。有人可以给我一些建议，让我知道我要解决这个问题吗？

```
<html>
  <head>        
    <title></title>
<script type="text/javascript" src="jquery-1.8.2.min.js"/></script>
<style>
#home_sec_2 {z-index:20; position:relative; display:inline-block}.hide{display:none;} 
#home_sec_2 img{outline:0;text-decoration:none; display: inline-block;float:left;}
.imgOverLay1{height:70px; width:314px; background-color:#F01414; display:none; float:left; z-index:8000; position: absolute; opacity: 0.5;filter:alpha(opacity=50);-moz-opacity:0.5;-khtml-opacity: 0.5;bottom: 0px; float:left;}
</style>  
  </head>
  <body> <div id="home_sec_2">
            <h2>WHATS IN THE MIX</h2>
              <div class="imgOverLay1" id="ov0">Here is the First</div>         
              <img src="midimg1.png" width="314" height="145" class="c1"
              alt="LA NORIE"/>

            <div class="imgOverLay1" id="ov1">Here is the Second</div>
             <img src="midimg2.png" width="314" height="145" class=
              "c1" alt="BATTLEFIELD 3" />

                <div class="imgOverLay1" id="ov2">Here is the Third</div>
              <img src="midimg3.png" width="314" height="145" class="c1" alt=
              "CALL OF DUTY: MW3" />
          </div></body>
<script>
$(function(){
    $("#home_sec_2 img").attr("id", function (arr) {
        return arr;
    });
    $('#home_sec_2').on('mouseover','img',function(){
        position = $(this).position().left;
        var $ll = $(this).attr('id');
        console.log(this);
        $('#ov'+$ll).css({left:position}); 
        $('#ov'+$ll).addClass('shown');
        $('#ov'+$ll).slideToggle('slow');
        var $this = $('#ov'+$ll);
        console.log($this);
    }), 
    $('#home_sec_2').on('mouseleave','img',function(){
        $ll = $(this).attr('id');   
        $('#ov'+$ll).slideToggle('slow');
        console.log($('#ov'+$ll));
    })
});
</script>  
</html> 
```

如果我将鼠标放在叠加层上，动画`slideToggle`完成并隐藏 div。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T22:22:30.867

**更新：** 现在试试，;)

```
<html>
  <head>        
    <title></title>
<script type="text/javascript" src="jquery.js"/></script>
<style>
#home_sec_2 {z-index:20; position:relative; display:inline-block}.hide{display:none;} 
#home_sec_2 img{outline:0;text-decoration:none; display: inline-block;float:left;}
img + .imgOverLay1{overflow:hidden;height:0px; width:314px; background-color:#F01414; float:left; z-index:8000; position: absolute; opacity: 0.5;filter:alpha(opacity=50);-moz-opacity:0.5;-khtml-opacity: 0.5;bottom: 0px; float:left;-webkit-transition:height 0.5s;-moz-transition:height 0.5s;transition:height 0.5s;}
img:hover + .imgOverLay1,img + .imgOverLay1:hover{height:70px;}
</style>  
  </head>
  <body> <div id="home_sec_2">
            <h2>WHATS IN THE MIX</h2>
              <img src="img1.png" width="314" height="145" class="c1"
              alt="LA NORIE"/>
              <div class="imgOverLay1" id="ov0"><a href="#">Here is the First</a></div>         

             <img src="img2.jpg" width="314" height="145" class=
              "c1" alt="BATTLEFIELD 3" />
              <div class="imgOverLay1" id="ov1"><a href="#">Here is the Second</a></div>

              <img src="img1.jpg" width="314" height="145" class="c1" alt=
              "CALL OF DUTY: MW3" />
              <div class="imgOverLay1" id="ov2"><a href="#">Here is the Third</a></div>
          </div></body>
<script>
window.onload=function(){
$('.imgOverLay1').each(function(){
$(this).css({"left":$(this).prev().position().left});
});
};
</script>
</html> 
```

# c - 将 char 字符串读取为虚拟文件

> ID：13961912
> 
> 赞同：2
> 
> 时间：2012-12-19T21:55:26.177
> 
> 标签：c, char, virtual-file

这个问题可能看起来很奇怪，但我并没有拼错：我想解压缩我下载的一些数据而不将它们写在硬盘上。为此，我将它下载到一个动态分配的缓冲区中，并且我想将它发送到我使用的 zlib 包装器（miniunzip）。问题是这个实现很长（2-3K 行），我想避免只为几行重写它。我想知道是否有任何方法可以通过 FILE* 结构读取缓冲区（miniunzip 使用它自己的结构，但我发现加载器下隐藏了一个“fopen()”）。如果可以提供帮助，我知道它的长度。

提前感谢并原谅我糟糕的语法。

我在 Windows 和 UNIX 系统（OSX/GNU Linux）上工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T23:43:42.713

如果您谈论的是 zlib 中包含的 minizip 库，您可以使用该`unzOpen2`函数，该函数允许您指定包含要使用的 I/O 函数的结构。这应该让你开始：

```
struct zmem_data {
  char *buf;
  size_t length;
};

static voidpf zmemopen(voidpf opaque, const char *filename, int mode) {
  if ((mode&ZLIB_FILEFUNC_MODE_READWRITEFILTER) != ZLIB_FILEFUNC_MODE_READ) return NULL;
  uLong *pos = malloc(sizeof(uLong));
  *pos = 0;
  return pos;
}

static uLong zmemread(voidpf opaque, voidpf stream, void* buf, uLong size) {
  struct zmem_data *data = (struct zmem_data*)opaque;
  uLong *pos = (uLong*)stream;
  uLong remaining = data->length - *pos;
  uLong readlength = size < remaining ? size : remaining;
  if (*pos > data->length) return 0;
  memcpy(buf, data->buf+*pos, readlength);
  *pos += readlength;
  return readlength;
}

static uLong zmemwrite(voidpf opaque, voidpf stream, const void *buf, uLong size) {
  /* no write support for now */
  return 0;
}

static int zmemclose(voidpf opaque, voidpf stream) {
  free(stream);
  return 0;
}

static int zmemerror(voidpf opaque, voidpf stream) {
  if (stream == NULL) return 1;
  else return 0;
}

static long zmemtell(voidpf opaque, voidpf stream) {
  return *(uLong*)stream;
}

static long zmemseek(voidpf opaque, voidpf stream, uLong offset, int origin) {
  struct zmem_data *data = (struct zmem_data*)opaque;
  uLong *pos = (uLong*)stream;
  switch (origin) {
    case ZLIB_FILEFUNC_SEEK_SET:
      *pos = offset;
      break;
    case ZLIB_FILEFUNC_SEEK_CUR:
      *pos = *pos + offset;
      break;
    case ZLIB_FILEFUNC_SEEK_END:
      *pos = data->length + offset;
      break;
    default:
      return -1;
  }
  return 0;
}

static void init_zmemfile(zlib_filefunc_def *inst, char *buf, size_t length) {
  struct zmem_data *data = malloc(sizeof(struct zmem_data));
  data->buf = buf;
  data->length = length;
  inst->opaque = data;
  inst->zopen_file = zmemopen;
  inst->zread_file = zmemread;
  inst->zwrite_file = zmemwrite;
  inst->ztell_file = zmemtell;
  inst->zseek_file = zmemseek;
  inst->zclose_file = zmemclose;
  inst->zerror_file = zmemerror;
}

static void destroy_zmemfile(zlib_filefunc_def *inst) {
  free(inst->opaque);
  inst->opaque = NULL;
}

void example() {
 zlib_filefunc_dec fileops;
 init_zmemfile(&fileops, buffer, buffer_length);
 unzFile zf = unzOpen2(NULL, &fileops);
 /* ... process zip file ... */
 unzClose(zf);
 destroy_zmemfile(&fileops);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T21:59:59.277

总结您的问题：您想为`FILE*`内存缓冲区提供一个接口。不，你不能那样做。`fread()`等调用实际上最终会进行处理您没有的打开文件描述符的系统调用。

你把这件事复杂化了。解压缩代码几乎总是在内存中的缓冲区中工作。如果他们有一个文件接口，那肯定只是一个包装器，它处理将文件读入内存然后解压缩（可能以块的形式来节省内存）。您应该能够找到一个解压库，该库调用解压您给它的缓冲区（只是一个指针和一个长度）。

为什么您不想将下载的数据写入硬盘驱动器当然取决于您，但我希望这是好的，而不是坏的。

* * *

另一种选择是打开一个内存映射文件，您在下载期间写入该文件，并在解压缩期间读取该文件。*可能*有一种方法可以指定文件不写入磁盘，但我不确定。此外，这在 windows 和 linux 之间会有很大的不同。

这些可能会有所帮助：

*   [文件映射 (Windows)](http://msdn.microsoft.com/en-us/library/windows/desktop/aa366556%28v=vs.85%29.aspx)
*   [`mmap`(POSIX)](http://en.wikipedia.org/wiki/Mmap)

# r - 我应该使用哪种布局来获得 igraph 中的非重叠边缘？

> ID：13961913
> 
> 赞同：29
> 
> 时间：2012-12-19T21:55:34.080
> 
> 标签：r, plot, igraph

我正在尝试使用树状数据构建图形，其中节点通常分成> 2条边。我尝试了各种布局，我看到 layout.reingold.tilford 参数将生成具有非分叉数据的树状图。然而，输出并不是特别有吸引力。我宁愿使用 layout.lgl 或 layout.kamada.kawai 之类的东西，因为它们会产生更多的放射状结构。我看不到如何更改 R 中的参数，以使这些树没有重叠的边缘。这可能吗？

我导入了一个 Pajek 格式的简单数据文件，有 355 个节点和 354 个边。我目前正在使用以下方法打印它：

```
plot.igraph(g,vertex.size=3,vertex.label=NA,layout=layout.lgl) 
```

这给了我这样的输出，这很好，但仍然有重叠的边缘。我已经读到您可以使用 tkplot 或其他程序（如 cytoscape）手动修复此问题，但是我有很多这些要构建，而且它们的大小使手动更正变得很麻烦。

非常感谢。 ![这是我得到的输出示例](../Images/679ab10c8f5f65a68bef6ff7dad60960.png)

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2015-07-22T11:31:41.087

只想添加评论，但我的代表太低了。@bdemarest 发布的方法不适用于`igraph`> 0.7 版本。较新的版本不支持该`area`参数，所以我无法获得相同的效果。构建旧版本花了我一段时间，所以我想分享一些见解。[如果您从igraph nightly builds](http://igraph.org/nightly/)`igraph`下载它，您可以从源代码手动安装0.7 。在我的机器（Mac OS 10.10）上，由于 ，我在构建它时遇到了一些问题，所以我找到了解决问题的[链接。](http://thecoatlessprofessor.com/programming/rcpp-rcpparmadillo-and-os-x-mavericks-lgfortran-and-lquadmath-error/)希望对任何想要在 R 中创建类似图表的人有所帮助。`gfortran`

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-12-21T06:49:58.580

你可能想试试`layout.fruchterman.reingold()`。防止边缘交叉似乎做得很好。我已经用@Tamás 建议的 355 节点版本的 barabasi 图对其进行了测试。

```
library(igraph)

g = barabasi.game(355, directed=FALSE)

png("plot1.png", height=6, width=12, units="in", res=200)
par(mfrow=c(1, 2))

plot.igraph(g,vertex.size=3,vertex.label=NA,
    layout=layout.fruchterman.reingold(g, niter=10000))
mtext("layout.fruchterman.reingold, area = vcount^2", side=1)

plot.igraph(g,vertex.size=3,vertex.label=NA,
    layout=layout.fruchterman.reingold(g, niter=10000, area=30*vcount(g)^2))
mtext("layout.fruchterman.reingold, area = 30 * vcount^2", side=1)

dev.off() 
```

![在此处输入图像描述](../Images/a2c2c00ac2949b18483b0ac193e36cee.png)

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-12-20T18:55:17.883

`layout.reingold.tilford`有一个名为 的参数`circular`。将此设置为`TRUE`将通过将 X 坐标视为角度（经过适当的重新缩放后）将 Y 坐标视为半径，将最终布局转换为径向布局。具有讽刺意味的是，这并不能保证最终不会有边缘交叉，但如果您的子树与图的其余部分相比不是非常宽，它就会很好地工作：

```
> g <- barabasi.game(100, directed=F)
> layout <- layout.reingold.tilford(g, circular=T)
> plot(g, layout=layout) 
```

# ruby-on-rails - Rails 中 image_tag 和回形针的错误 url

> ID：13961915
> 
> 赞同：2
> 
> 时间：2012-12-19T21:55:46.543
> 
> 标签：ruby-on-rails, paperclip

我在 Rails 应用程序中使用 Paperclip gem 来上传图片。但在视图中，没有图像。丢失图像的路径是`http://localhost:3000/assets/`。这是代码：

```
<div class="advert_images">
  Фото: <br>
  <% if @advertising.image.url %>
    <%= image_tag(@advertising.image) %>    
  <% end %>
  <br>
  Розташування на карті: <br>
  <% if @advertising.map.url(:normal) %>
    <%= image_tag(@advertising.map.url(:normal)) %>
  <% end %>
</div> 
```

奇怪的是，当输入`<%= @advertising.image.url %>`显示现有图像的正确路径的代码时（例如`/system/adverts/images/000/001/408/original/luxot.gif?1355951576`）。

该模型：

```
# -*- encoding : utf-8 -*-
class Advert < ActiveRecord::Base
attr_accessible :adress, :category, :city, :desc, :map_path, :name, :image_path, :map,        :image
has_attached_file :map, :styles => {:normal => "350x265", :thumb => "250x165"}
has_attached_file :image, :styles => {:normal => "350x265", :thumb => "250x165"}

  validates :name,  :length => {:in => 2..20}, :presence => true
  validates :category,                         :presence => true
  validates :city,                             :presence => true
  validates :adress,                           :presence => true

scope :by_city, lambda {|city| where("city = ?", city)}
scope :by_category, lambda {|category| where("category = ?", category)}

end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T19:27:05.610

找到了解决方案。我更改了默认路径，回形针存储图像的位置。

```
 has_attached_file :image,
                :url => "/assets/:id/:style/:basename.:extension",
                :path =>  
                ":rails_root/app/assets/images/:id/:style/:basename.:extension" 
```

# javascript - 传递给 __defineGetter__ 的函数中“this”的值是多少

> ID：13961919
> 
> 赞同：3
> 
> 时间：2012-12-19T21:56:00.003
> 
> 标签：javascript, scope, this, npm, anonymous-function

我从 grunt npm 模块的源代码中看到以下代码行 -

```
String.prototype.__defineGetter__(method, function() { return this; }); 
```

只是试图预测上面匿名函数中“this”的值是什么——

*   它指向“方法”
*   全局“窗口”对象，如果在浏览器中运行或在 grunt 的角度类似的东西
*   如果在“defineGetter”定义中使用了调用或应用，则取决于**defineGetter的定义。**

谢谢您的帮助 ！！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-19T21:58:17.527

`this`将是发生 get 操作的对象，我*认为*它将始终是您调用的对象`__defineGetter__`（因为我不能立即看到将函数转移到其他地方的方法，但我不*保证*你不能；不过，您必须故意这样做）。

值得注意的是，它`__defineGetter__`是非标准且已过时的。当前定义 getter 的方法是使用[`Object.defineProperty`](http://www.ecma-international.org/ecma-262/5.1/#sec-15.2.3.6)or [`Object.defineProperties`](http://www.ecma-international.org/ecma-262/5.1/#sec-15.2.3.7)，如下所示：

```
Object.defineProperty(String.prototype, "foo", {
  get: function() {
    // Here, `this` is the string
    return this.toUpperCase();
  }
});

console.log("hi there".foo); 
```

...记录`"HI THERE"`。

[实例](http://jsbin.com/asinek/1)| [资源](http://jsbin.com/asinek/1/edit)

# wxpython - wxPython StyledTextCtrl 行号不是从 1 开始

> ID：13961920
> 
> 赞同：0
> 
> 时间：2012-12-19T21:56:02.160
> 
> 标签：wxpython, wxwidgets, line-numbers, wxstyledtextctrl

感谢 wxPython Demos，我知道如何将行号添加到 wxPython StyledTextCtrl。

```
myctrl.SetMarginType(0, wx.stc.STC_MARGIN_NUMBER) 
```

有没有办法让行号从 1 以外的地方开始？

这样做的动机是显示大文本文件的片段。我希望行号与完整文件中的行号匹配，但我不想在我的文本控件中加载整个文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T18:04:37.420

我会隐藏默认的行号边距并使用自定义的边距，有关详细信息，请参阅[边距文档](http://www.scintilla.org/ScintillaDoc.html#Margins)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T07:53:41.493

也许这可以通过折叠您不想显示的内容来实现。更多信息可以在这里找到：[http ://www.yellowbrain.com/stc/folding.html](http://www.yellowbrain.com/stc/folding.html)

# ruby-on-rails - Ruby on Rails，通过中央 REST API 存储在应用程序之间共享数据

> ID：13961921
> 
> 赞同：1
> 
> 时间：2012-12-19T21:56:08.193
> 
> 标签：ruby-on-rails, ruby, api, rest, soa

所以这是我提出的基本结构：

数据仓库（为了更好的词）

*   电子商务在线
*   后端管理信息系统
*   ETC

所以我的想法是我有一个订单。可以通过电子商务网站或后端 MIS 创建订单。无论哪种情况，订单都应过滤到电子商务中以向用户显示订单，反之亦然。

未来还会有其他应用。

所以想法是，拥有一个将这些数据包装在服务 API 中的中央仓库，然后其他应用程序推/拉到它。

好听吗？我想问题是同步数据。当我创建订单时，我是在创建时将订单推送到仓库，还是将其放入某个队列，或者是否有其他方法可以使所有这些保持同步，假设需要近实时到实时同步。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T21:59:05.987

假设您的 REST 服务器只是另一个数据存储。每个客户端在需要时如何从普通的旧数据库中获取更新？

如果您让每个客户端定期轮询数据存储，那将是一种解决方案。

# ruby-on-rails - 使用 collection_select 在 Active Record 中搜索 - Rails 3.2.9

> ID：13961922
> 
> 赞同：1
> 
> 时间：2012-12-19T21:56:11.843
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2

我只使用了一次collection_select 来填充关联模型用户的国家/地区ID。现在我想在另一个视图上使用相同的 collection_select 语句搜索用户，并列出选定国家的用户。我的尝试失败了。我可以在选择一个国家后查看链接，并看到该国家的 id 被选中。但是，当我单击提交按钮时，collection_select 语句会将选定值重置为默认选定值并忽略选定值。例如，当我选择法国国家时，id 为 75。当我选择法国并单击按国家/地区搜索时，id 显示如下。

```
http://localhost:3000/users_admin?utf8=✓&amp;query=&user%5Bcountry_id%5D=75 
```

这是我有 collection_select 语句的表单。我复制了我在使用所选国家 ID 在用户模型上添加/更新记录时成功使用的语句。我希望我的逻辑是当我选择一个国家并单击按国家搜索时，所选国家在下拉列表中保持选中状态，并且具有所选国家 ID 的用户记录显示在屏幕上。按名称搜索按预期工作。

```
<%= form_tag users_admin_path, method: 'get' do %>
  <p style="padding-left: 20px;">
    <%= text_field_tag :query, params[:query], placeholder: "Search for first, last or full name" %>&nbsp;&nbsp;
    <span valign="center"><%= submit_tag "Search by Name", class: "btn btn-medium btn-custom", :name => nil %></span>&nbsp;&nbsp;&nbsp;&nbsp;
    <%= collection_select(:user, :country_id, Country.order('name'), :id, :name, {:selected => 233}) %>&nbsp;&nbsp;
    <span valign="center"><%= submit_tag "Search by Country", class: "btn btn-medium btn-custom", :name => nil %>
  </p>
<% end %> 
```

这是我的控制器中的代码。

```
def users_admin
  case
  when User.where("active_user = ?", '1').count > 0 # blocked users exist
    @users = User.where("active_user = ?", '1').all
  when params[:commit]=='Search by Country'
    @users = User.where("country_id = ?", params[:country_id]).all
  else
    @users = User.text_search(params[:query])
  end 
  @microposts = Micropost.all
end 
```

我不确定问题是与 collection_select 语句的编码方式还是其他逻辑问题有关。我的第一个想法是我需要以某种方式保存从 collection_select 语句中选择的值，然后在我的 where 子句中使用它。但我不知道如何重新编码语句来做到这一点，并且默认选择的值为 233，即首次显示屏幕时的美国。我还想也许我应该有两种不同的形式而不是一种。我只是不知道我现在应该去的方向。

我主要在 Stack Overflow 上搜索有关此问题的问题。与 collection_select 相关的问题大部分都与我可能永远不会使用它的用途有关。同样，我只使用了一次 collection_statement :)

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T22:27:14.353

在进行了更多搜索后，我决定在我的视图上显示参数，只是为了查看哈希中的内容。我的 submit_tag 中没有提交，所以我改为检查 params[:country_id] 是否存在。我能够使用修改后的代码进行国家搜索：

```
case
  when User.where("active_user = ?", '1').count > 0 # blocked users exist
    @users = User.where("active_user = ?", '1').all
  when params[:country_id].present?
    @users = User.where("country_id = ?", params[:country_id].to_i).all
  else
    @users = User.text_search(params[:query])
end 
```

我剩下的唯一问题（小问题）是，为了在国家/地区搜索后使名称搜索正常工作，该人必须在国家/地区列表中选择空白条目。除此之外，这已解决。很快就会弄清楚如何清除 params[:country_id] 中的值。或者我可以对 params[:query].present 进行隐式检查？. 谢谢你的帮助。另一双眼睛确实有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T23:36:19.473

当您在表单中使用模型时，应该使用 collection_select（即，当您`form_for @user do`使用`form_tag`

尝试这样的事情：

```
<%= select_tag :country_id, options_from_collection_for_select(Country.all, :id, :title, params[:country_id]), include_blank: true %> 
```

那里的`params[:country_id]`参数确保在用户提交您的搜索表单后，通过 GET 请求传入的任何 country_id 都将在您的下拉列表中被选中。

顺便说一句，`form_for`在涉及模型（正在创建/更新）时使用。如果您正在创建搜索表单，情况并非如此，您应该使用`form_tag`

阅读此内容以获取更多信息： http: [//guides.rubyonrails.org/form_helpers.html#making-select-boxes-with-ease](http://guides.rubyonrails.org/form_helpers.html#making-select-boxes-with-ease)

# c++ - 模除法返回负数

> ID：13961929
> 
> 赞同：1
> 
> 时间：2012-12-19T21:56:52.527
> 
> 标签：c++, c, visual-studio-2010, modulo

我正在 C 程序中执行以下模除运算：

(5^6) 模 23 = 8

(5^15) 模 23 = 19

为方便起见，我正在使用以下功能：

```
int mod_func(int p, int g, int x) {
    return ((int)pow((double)g, (double)x)) % p;
} 
```

但是调用函数时的操作结果不正确：

```
mod_func(23, 5, 6) //returns 8
mod_func(23, 5, 15) //returns -6 
```

模运算符是否对操作数的大小有一些限制？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T21:59:00.570

的整数部分`pow(5, 15)`不能用 an 表示`int`（假设 的宽度`int`是 32 位）。在 C 和 C++ 中，转换（转换表达式中的 from`double`到）是未定义的行为。`int`

为了避免未定义的行为，您应该使用`fmod`函数来执行浮点余数运算。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-19T22:02:26.527

5 的 15 次方是 30,517,578,125

您可以存储的`int`最大值是 2,147,483,647

您可以使用 64 位整数，但请注意`double`最终转换时会出现精度问题。

从记忆中，数论中有一条关于您正在执行的计算的规则，这意味着您不需要计算全部幂展开来确定模结果。但我可能是错的。自从我学会了这些东西已经太多年了。

啊，这里是：[模幂运算](http://en.wikipedia.org/wiki/Modular_exponentiation)

阅读并停止使用`double`and `pow`=)

```
int mod_func(int p, int g, int x)
{
    int r = g;
    for( int i = 1; i < x; i++ ) {
        r = (r * g) % p;
    }
    return r;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T22:01:04.720

我的猜测是问题是 5 ^ 15 = 30517578125 大于`INT_MAX`(2147483647)。您目前正在将其转换为`int`，这是失败的原因。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-19T22:19:03.210

如前所述，您的第一个问题是

```
int mod_func(int p, int g, int x) {
    return ((int)pow((double)g, (double)x)) % p;
} 
```

是`pow(g,x)`经常超出`int`范围，然后您有未定义的行为将该结果转换为`int`，无论结果`int`是什么，都没有理由相信它与所需的模数有任何关系。

下一个问题是`pow(g,x)`as a的结果`double`可能不准确。除非是 2 的幂，否则即使它在范围内，对于足够大的指数`g`，数学结果也不能精确表示为 a ，但如果数学结果可以精确表示（取决于 的实现），它也可能发生。`double``pow`

如果您进行数论计算 - 并且计算幂模整数的余数是一 - 您应该只使用整数类型。

对于手头的情况，您可以通过重复平方来使用取幂，计算所有中间结果的残差。如果模数`p`足够小而`(p-1)*(p-1)`不会溢出，

```
int mod_func(int p, int g, int x) {
    int aux = 1;
    g %= p;
    while(x > 0) {
        if (x % 2 == 1) {
            aux = (aux * g) % p;
        }
        g = (g * g) % p;
        x /= 2;
    }
    return aux;
} 
```

可以。如果`p`可以更大，则需要使用更宽的类型进行计算。

# python - 在linux中配对文件

> ID：13961930
> 
> 赞同：-5
> 
> 时间：2012-12-19T21:57:02.127
> 
> 标签：python, linux, perl, bash, unix

我在一个目录中有大量文件及其其他语言的翻译。有 10 种不同语言的文件和 2 或 3 种文件。文件的典型名称是`xx_xxxx_EN.html`及其翻译 xx_xxxx_IT.html 。我想提取一个包含文件名的 2 列 txt 文件。例如英语 - 意大利语语言对： `xx_xxxx_EN.html xx_xxxx_IT.html`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-19T22:22:52.443

```
#!/bin/bash 

ls -1 *EN.html | while IFS= read -r file
do 
    ls -1 ${file%_*}* | while IFS= read -r match
    do
    if [ "$file" != "$match" ]; then 
        echo "$file" "$match"
    fi 
    done 
done 
```

* * *

```
$ ls *html 
01_DE.html 01_EN.html 01_ESP.html 01_IT.html 02_EN.html 02_IT.html 02_PL.html

$ ./pair.sh

01_EN.html 01_DE.html
01_EN.html 01_ESP.html
01_EN.html 01_IT.html
02_EN.html 02_IT.html
02_EN.html 02_PL.html 
```

# php - MySQL查询按顺序列出包含用户提交的字母的单词

> ID：13961932
> 
> 赞同：3
> 
> 时间：2012-12-19T21:57:12.217
> 
> 标签：php, mysql

我有`MySQL`一张包含单词列表的表格：

```
desc words;
+---------+--------------+------+-----+---------+----------------+
| Field   | Type         | Null | Key | Default | Extra          |
+---------+--------------+------+-----+---------+----------------+
| id      | int(11)      | NO   | PRI | NULL    | auto_increment |
| word    | varchar(255) | NO   |     | NULL    |                |
+---------+--------------+------+-----+---------+----------------+ 
```

我还有一个`HTML`包含三个输入字段的表单，用户应该在其中输入三个字母：

```
<form action='load.php' method='post'>
    <input type='text' name='first_letter'>
    <input type='text' name='second_letter'>
    <input type='text' name='third_letter'>

    <input type='submit' name='submit'>
</form> 
```

是否可以创建`MySQL`查询以在单词中按出现顺序获取包含三个字母的单词？

例如，如果我们有的话

```
adams
damn
mad 
```

...并且用户提交字母“a”、“d”、“m”它应该只给出结果

```
adams 
```

因为第一个提交的字母是“a”，第二个提交的字母在“a”之后，依此类推（即使中间有其他字母）。

还是使用 对单词进行排序更容易`PHP`？如果是这样，怎么做？我是一个初学者程序员。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-19T22:01:17.220

好吧，无论如何它都不会有效，但是以下应该可以完成工作：

```
$string = '%' . implode('%', $letters) . '%';
$query = "SELECT word FROM words WHERE word LIKE '$string'"; 
```

无论字母之间是否有任何内容，只要它们以正确的顺序出现，这将起作用。它还允许指定不同数量的字母。

编辑： `$letters`也需要为查询构建。具体到这个例子，可以这样构建：

```
$vars = array('first_letter', 'second_letter', 'third_letter');
foreach($vars as $var){
    if($_POST[$var]){
        $letters[] = $_POST[$var];
    }
} 
```

如果将`POST`变量名称更改为`letters[]`，则过程可以简化为：

```
foreach($_POST['letters'] as $letter){
    if($letter){
        $letters[] = $letter;
    }
} 
```

所有进入这个的数据也应该被验证/转义，但这超出了这个问题的范围。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T22:03:21.153

一个简单的查询就可以了

```
$stmt = $pdo->prepare("select word from words where word like '%?%?%?%'");

$stmt->bind_param(
  'sss'
  , $first_letter
  , $second_letter
  , $third_letter
);

$stmt->execute(); 
```

**更新**：改用参数

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T22:03:31.187

目前尚不清楚用户如何“提交字母 'a'、'd' 和 'm'”，但该`LIKE`子句对于这种[模式匹配](http://dev.mysql.com/doc/refman/5.5/en/pattern-matching.html)是最常见的。

尝试：

```
SELECT id, word
FROM words
WHERE word LIKE '%a%d%m%' 
```

# jquery - 带有 will_paginate 的无尽页面不适用于部分

> ID：13961933
> 
> 赞同：3
> 
> 时间：2012-12-19T21:57:15.743
> 
> 标签：jquery, ruby-on-rails-3, will-paginate

我一直在关注无尽页面上的[railscast](http://railscasts.com/episodes/114-endless-page-revised)并且之前对 will_paginate 做过同样的事情，但是我遇到了错误，但是我尝试在我的特定情况下实现它。will_paginate gems 完美地工作，就我在 Chrome 中阅读开发人员工具所知道的而言，对 dom 的 jQuery 调用也是如此。问题在于返回的内容 - rails 不喜欢它。这是一些代码：

在`videos.js.coffee`：

```
jQuery ->
  if $('.pagination').length
    $(window).scroll ->
      url = $('.pagination .next_page').attr('href')
      if url && $(window).scrollTop() > $(document).height() - $(window).height() - 50
        $('.pagination').text("Fetching more videos...")
        $.getScript(url)
    $(window).scroll() 
```

在我的`views/users/index.js.erb`

```
$('.carousel').append(' <%= j render(@recently_added_video) %>');
<% if  @recently_added_video .next_page %>
  $('.pagination').replaceWith('<%= j will_paginate(@recently_added_video) %>');
<% else %>
  $('.pagination').remove();
<% end %> 
```

在我的共享部分中，由`users/index.erb.html`

```
 <div class="carousel" %>

    <ul class="jcarousel-skin-recent">
        <% @recently_added_video.each do |v| %>
          <li><%= link_to image_tag(v.video_thumb(), width: 300), v %></li>
        <% end %>  
    </ul>
</div> 

   <%= will_paginate @recently_added_video %> 
```

这给了我开发日志中的以下错误：

```
Completed 500 Internal Server Error in 15ms

ActionView::Template::Error (Missing partial videos/video with {:locale=>[:en], :formats=>[:js, :html], :handlers=>[:erb, :builder, :coffee]}. 
```

所以我然后尝试`views/videos/_video.js.erb`使用与文件相同的代码创建一个部分`users/index.js.erb`，但它给了我以下错误：

```
 Rendered shared/_recentlyadded.html.erb (853.8ms)
  Rendered users/index.html.erb within layouts/application (1741.4ms)
  Rendered layouts/_header.html.erb (2.6ms)
  Rendered layouts/_footer.html.erb (0.0ms)
Completed 200 OK in 1813ms (Views: 1801.0ms | ActiveRecord: 8.5ms | Sphinx: 0.0ms)
Illegal instruction: 4 
```

正如你所看到的，它实际上也没有渲染`_video`局部。

`@recently_added_video`如果它是相关的，我试图调用的实例变量是在 中定义的，`application_controller`并且可以与部分和一起正常工作`will_paginate`。

任何人都可以帮助弄清楚出了什么问题吗？很迷茫！谢谢...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T22:32:57.053

没关系 - 我想通了。

问题出在这条线上

```
$('.carousel').append( ' <%= j render(@recently_added_video) %>' ); 
```

在 users/index.js.erb 文件中。

我正在关注 railscast，但 Ryan Bates 将他的实例变量设置为渲染部分，所以他的代码可以工作，但是因为 @recently_added_video 不是部分并且不会渲染，所以它返回 500 错误，因为有没有偏找。

我需要做的实际上是渲染一个像这样的部分：

```
 $('.jcarousel-skin-recent').append(' <%= j render ('shared/recentlyadded') %>'); 
```

希望能帮助其他关注 railscast 并遇到像我一样的问题的人。

# java - Java 泛型：为每个内部类构建参数化类

> ID：13961937
> 
> 赞同：0
> 
> 时间：2012-12-19T21:57:31.613
> 
> 标签：java, generics

假设我有一个界面：

```
public interface Authentication<T> {
   public void authenticate(T token);
} 
```

我有一个名为的类`AuthenticationMethods`，它有几个内部类。

我想要做的是编写一个实用程序，我可以在其中获取所有内部类，并生成一个使用内部类`Authentication<T>`的 Type 实现接口的`T`类，如下所示：

```
for (Class clazz : AuthenticationMethods.class.getDeclaredClasses()){
   createAuthenticationImplClass(clazz);
}

private <T> Authentication<T> createAuthenticationImplClass(Class clazz){
  return new Authentication<clazz>() {
     @Override
     public void authenticate(clazz token) throws Exception {
        //do something with the token
     }
   };
} 
```

显然，仅仅使用`clazz`代替是`T`行不通的。

如何从 clazz 获取类型到 Authentication 接口的参数化实现？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T22:12:07.360

你可以做这样的事情。

```
private <T extends Class<?>> Authentication<T> createAuthenticationImplClass(T clazz){
  return new Authentication<T>() {
     @Override
     public void authenticate(T token) throws Exception {
        //do something with the token
     }
   };
} 
```

例子

`Authentication<Class<String>> = createAuthenticationImplClass(String.class);`

或这个

```
private <T> Authentication<T> createAuthenticationImplClass(Class<T> clazz){
  return new Authentication<T>() {
     @Override
     public void authenticate(T token) throws Exception {
        //do something with the token
     }
   };
} 
```

例子：

`Authentication<String> = createAuthenticationImplClass(String.class);`

不同之处在于，在第一个示例中，您的`authenticate`方法将在参数中包含 Class 类型。在第二个中，参数将是该类表示的类型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T22:11:32.837

如果我理解正确，您想要验证`clazz`该类的令牌。然后您需要使用泛型 Class 类型参数化您的工厂方法参数：

```
private <T> Authentication<T> createAuthenticationImplClass(Class<T> clazz){
    return new Authentication<T>() {
        @Override
        public void authenticate(T token) throws Exception {
            //do something with the token
        }
    };
} 
```

当然，此时您为声明的类执行**for**循环会丢失泛型类型，因此传递类型安全`Class`实例的唯一方法是显式类名：

```
Authentication<TokenType> authForTokenType = createAuthenticationImplClass(TokenType.class); 
```

# javascript - Javascript - 原型 - 忽略 验证其余输入不为空并提交。这可能吗？

> ID：13961939
> 
> 赞同：0
> 
> 时间：2012-12-19T21:57:41.950
> 
> 标签：javascript, prototypejs

我不知道如何做到这一点，所以就在这里。我需要的是能够验证没有显示的空字段；。我正在使用原型。

```
new.onclick = function() {
if (document.getElementById("ticket").style.display !== "none" &&
    document.getElementsByTagName("input").length === 0) {
          alert('need to have something here');      
    }
     alert('need here');      
  }; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T22:37:45.103

我认为您需要以这种方式使用您的 if 语句：

```
if (document.getElementById("ticket").style.display !== "none" || document.getElementsByTagName("input").length === 0) 
```

因此，如果没有向 DOM 添加任何输入或显示票证，这将是真的：无

无论如何，如果您没有带有 ID 票的元素，您的脚本将被中止

```
if(document.getElementById("ticket") != null) {
...
} 
```

# scala - 链接 Scalaz 验证函数：Function1[A,Validation[E,B]]

> ID：13961940
> 
> 赞同：7
> 
> 时间：2012-12-19T21:57:49.610
> 
> 标签：scala, scalaz

我正在尝试编写一些代码来轻松链接返回 Scalaz`Validation`类型的函数。我正在尝试编写的一种方法类似于`Validation.flatMap`我将调用的 (Short circuit that validation) `andPipe`。另一个类似于`|@|`on `ApplicativeBuilder`（累积错误），除了它只返回最终`Success`类型，我将调用它`andPass`

假设我有功能：

```
def allDigits: (String) => ValidationNEL[String, String]
def maxSizeOfTen: (String) => ValidationNEL[String, String] 
def toInt: (String) => ValidationNEL[String, Int] 
```

例如，我想首先将输入字符串传递给 allDigits 和 maxSizeOf10。如果有故障，它应该通过不调用 toInt 函数来短路并返回发生的一个或两个故障。如果成功，我想将 Success 值传递给 toInt 函数。从那里开始，它要么成功，输出值为 Int，要么失败，仅返回来自 toInt 的验证失败。

```
def intInput: (String) => ValidationNEL[String,Int] = (allDigits andPass maxSizeOfTen) andPipe toInt 
```

如果没有下面的附加实现，有没有办法做到这一点？

这是我的实现：

```
 trait ValidationFuncPimp[E,A,B] {
    val f: (A) => Validation[E, B]

    /** If this validation passes, pass to f2, otherwise fail without accumulating. */
    def andPipe[C](f2: (B) => Validation[E,C]): (A) => Validation[E,C] = (a: A) => {
      f(a) match {
        case Success(x) => f2(x)
        case Failure(x) => Failure(x)
      }
    }

    /** Run this validation and the other validation, Success only if both are successful.  Fail accumulating errors. */
    def andPass[D](f2: (A) => Validation[E,D])(implicit S: Semigroup[E]): (A) => Validation[E,D] = (a:A) => {
      (f(a), f2(a)) match {
        case (Success(x), Success(y)) => Success(y)
        case (Failure(x), Success(y)) => Failure(x)
        case (Success(x), Failure(y)) => Failure(y)
        case (Failure(x), Failure(y)) => Failure(S.append(x, y))
      }
    }
  }
  implicit def toValidationFuncPimp[E,A,B](valFunc : (A) => Validation[E,B]): ValidationFuncPimp[E,A,B] = {
    new ValidationFuncPimp[E,A,B] {
      val f = valFunc
    }
  } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-24T01:02:08.237

我并不是说这个答案一定比[drstevens 的](https://stackoverflow.com/a/13963136/334519)更好，但它采用了稍微不同的方法，不适合在那里发表评论。

首先是我们的验证方法（注意我已经改变了`toInt`一点的类型，原因我将在下面解释）：

```
import scalaz._, Scalaz._

def allDigits: (String) => ValidationNEL[String, String] =
  s => if (s.forall(_.isDigit)) s.successNel else "Not all digits".failNel

def maxSizeOfTen: (String) => ValidationNEL[String, String] =
  s => if (s.size <= 10) s.successNel else "Too big".failNel

def toInt(s: String) = try(s.toInt.right) catch {
  case _: NumberFormatException => NonEmptyList("Still not an integer").left
} 
```

为了方便起见，我将定义一个类型别名：

```
type ErrorsOr[+A] = NonEmptyList[String] \/ A 
```

现在我们刚刚得到了几个 Kleisli 箭头：

```
val validator = Kleisli[ErrorsOr, String, String](
  allDigits.flatMap(x => maxSizeOfTen.map(x *> _)) andThen (_.disjunction)
)

val integerizer = Kleisli[ErrorsOr, String, Int](toInt) 
```

我们可以组成：

```
val together = validator >>> integerizer 
```

并像这样使用：

```
scala> together("aaa")
res0: ErrorsOr[Int] = -\/(NonEmptyList(Not all digits))

scala> together("12345678900")
res1: ErrorsOr[Int] = -\/(NonEmptyList(Too big))

scala> together("12345678900a")
res2: ErrorsOr[Int] = -\/(NonEmptyList(Not all digits, Too big))

scala> together("123456789")
res3: ErrorsOr[Int] = \/-(123456789) 
```

使用非 monadic`flatMap`的东西让我有点不舒服，将我们的两种`ValidationNEL`方法组合成`\/`monad 中的 Kleisli 箭头——这也是我们字符串到整数转换的合适模型——对我来说感觉更干净一些。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-19T23:48:55.507

这相对简洁，几乎没有“添加代码”。虽然它仍然有点不稳定，因为它忽略了应用的成功结果`allDigits`。

```
scala> val validated = for {
     |   x <- allDigits
     |   y <- maxSizeOfTen
     | } yield x *> y
validated: String => scalaz.Validation[scalaz.NonEmptyList[String],String] = <function1>

scala> val validatedToInt = (str: String) => validated(str) flatMap(toInt)
validatedToInt: String => scalaz.Validation[scalaz.NonEmptyList[String],Int] = <function1>

scala> validatedToInt("10")
res25: scalaz.Validation[scalaz.NonEmptyList[String],Int] = Success(10) 
```

或者，您可以保留 和 的两个`allDigits`输出`maxSizeOfTen`。

```
val validated2 = for {
  x <- allDigits
  y <- maxSizeOfTen
} yield x <|*|> y 
```

我很好奇其他人是否能想出一个更好的方法来结合这些。真的不是合成...

```
val validatedToInt = (str: String) => validated2(str) flatMap(_ => toInt(str)) 
```

`validated`和累积`validated2`失败如下所示：

```
scala> def allDigits: (String) => ValidationNEL[String, String] = _ => failure(NonEmptyList("All Digits Fail"))
allDigits: String => scalaz.Scalaz.ValidationNEL[String,String]

scala> def maxSizeOfTen: (String) => ValidationNEL[String, String] = _ => failure(NonEmptyList("max > 10"))
maxSizeOfTen: String => scalaz.Scalaz.ValidationNEL[String,String]

scala> val validated = for {
     |   x <- allDigits
     |   y <- maxSizeOfTen
     | } yield x *> y
validated: String => scalaz.Validation[scalaz.NonEmptyList[String],String] = <function1>

scala> val validated2 = for {
     |   x <- allDigits
     |   y <- maxSizeOfTen
     | } yield x <|*|> y
validated2: String => scalaz.Validation[scalaz.NonEmptyList[String],(String, String)] = <function1>

scala> validated("ten")
res1: scalaz.Validation[scalaz.NonEmptyList[String],String] = Failure(NonEmptyList(All Digits Fail, max > 10))

scala> validated2("ten")
res3: scalaz.Validation[scalaz.NonEmptyList[String],(String, String)] = Failure(NonEmptyList(All Digits Fail, max > 10)) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-20T03:20:09.283

将 ApplicativeBuilder 与前两个一起使用，这样错误就会累积，然后是 flatMap `toInt`，因此`toInt`只有在前两个成功时才会调用。

```
val validInt: String => ValidationNEL[String, Int] = 
  for {
    validStr <- (allDigits |@| maxSizeOfTen)((x,_) => x); 
    i <- toInt
  } yield(i) 
```

# python - 在我的类层次结构中处理异常的地方

> ID：13961952
> 
> 赞同：0
> 
> 时间：2012-12-19T21:58:49.597
> 
> 标签：python, architecture

我得到了类似的层次结构和类似的代码：

```
class FrontendException:
    pass    
class BackendException:
    pass
class BackendRequest:
    def exec():
        raise BackendException()

class Frontend:
    def cmd_a():
        BackendRequest().exec()

    def cmd_b():
        BackendRequest().exec() 
```

**目标**是使开发人员能够`Frontend`在`cmd_x`.`Frontend`

基本上，我需要一个地方来处理常见`BackendException`类型，来提高`FrontendException`. 例如：

```
class Frontend:
    def cmd_a():
        try:
            BackendRequest().exec()
        except BackendException as e:
            raise FrontendException() 
```

这将在每个`cmd_x`函数中重复！太丑了！它与`Backend`事物一起运作！我想删除重复的异常处理。 **有什么建议么？**

顺便说一句，我的解决方案，但我也觉得它很难看，所以在你尝试向我建议一些东西后查看它。也许你会就我的解决方案向我提出一些建议。

```
class BaseFrontend:
    def exec_request(req):
        try:
            return req.exec()
        except BackendException as e:
            raise FrontendException
class Frontend(BaseFrontend):
    def cmd_a():
        result self.exec_request(BackendRequest())
    def cmd_b():
        result self.exec_request(BackendRequest()) 
```

**编辑**：好的，是的，我知道，我不需要创建很多类来构建简单的 API。但是，让我们看看我需要的结果：

```
class APIManager:
    def cmd_a(): ...
    def cmd_b(): ... 
```

此管理器需要访问 HTTP REST 服务才能执行每个命令。所以，如果我在 REST 请求期间遇到错误，我需要引发异常 APIManagerException - 我**不能**离开`raw pycurl exception`，因为 APIManager 用户不知道是什么，如果他会给出错误，`pycurl`他会混淆的论点。因此，我需要针对一些常见情况提出信息异常。让它只是一个例外 - 。但我不想每次在每个命令中对每个 pycurl 请求都重复阻止。事实上，我想处理一些错误，而不是解析 pycurl 错误。`pycurl error``ID``cmd_x``APIManagerException``try...except``commands(functions cmd_x)`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T22:24:34.607

您可以创建一个装饰器来包装所有前端调用、捕获`BackendExceptions`和引发（`FrontendException`如果它们被抛出）。（不过，老实说，尚不清楚为什么`Frontend`和`Backend`是类而不是一组函数。）见下文：

```
class FrontendException:
    pass    
class BackendException:
    pass
class BackendRequest:
    def exec():
        raise BackendException()

class Frontend:

    def back_raiser(func):
        def wrapped(*args, **kwargs):
            try:
                func(*args, **kwargs)
            except BackendException:
                raise FrontendException
        return wrapped

    @back_raiser
    def cmd_a():
        BackendRequest().exec()

    @back_raiser
    def cmd_b():
        BackendRequest().exec() 
```

# symfony - symfony2 中缺少用户提供程序

> ID：13961954
> 
> 赞同：0
> 
> 时间：2012-12-19T21:58:52.463
> 
> 标签：symfony

我刚刚实现了自己的身份验证提供程序来执行 facebook 身份验证。它仅适用于一个请求，然后运行：

```
There is no user provider for user "Nourdine\BasicBundle\Security\User\FacebookUser" 
```

事情是：

1 - 一个 FacebookProvider 在那里并且在踢。2 - 我将其注册为服务：

```
 <service id="facebook_user_provider" class="Nourdine\BasicBundle\Security\User\FacebookUserProvider" /> 
```

3 - 并使其在 security.xml 中可用

第一个问题：为什么他现在“看到”了它？第二个问题：是否必须在每次实现身份验证提供程序时创建相关的用户提供程序？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T21:49:43.383

我认为您的用户提供程序 refreshUser 方法有问题。当您使用会话持久性（令牌被序列化并存储在会话中）时使用此方法，以便可以从数据库（或其他地方）获取用户的下一个请求。

1.  它看到提供者，因为您将其注册为服务并在 security.yml 中使用服务 ID
2.  UserProvider 负责从数据库或其他层（webservice 或其他东西）获取用户和 AuthenticationProvider 对用户进行身份验证（执行身份验证逻辑），它可以使用提供程序，但在我们使用`Symfony\Component\Security\Core\User\UserProviderInterface`不具体实现的情况下大多数时候没有必要。所以不是强制性的

# benchmarking - 如何指定在 SPEC CPU 2006 基准测试中运行的工作负载？

> ID：13961958
> 
> 赞同：1
> 
> 时间：2012-12-19T21:58:56.800
> 
> 标签：benchmarking, specifications

我目前正在尝试使用 SPEC CPU 2006 对新的 FDO 工具链进行基准测试。

一些基准测试是针对多个工作负载运行的。例如 473.astar 与河流和 BigLakes 一起运行。

当我在这个基准上使用 FDO 时，它会被编译，然后使用 BigLakes 进行训练，然后使用 Rivers 进行训练。问题是该工具不提供聚合，所以第一次训练是没有用的。

我希望能够将 astar.rivers 和 astar.BigLakes2048 作为两个单独的基准进行运行。例如， astar.rivers 会这样做：

用河流编译火车 astar 用河流编译基准 astar

runspec 是否可以实现类似的操作，还是我必须使用脚本自己完成所有操作而不使用 SPEC 工具？

我阅读了几篇论文，其中结果以这种方式呈现，所以我认为这是可能的。

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-12T00:07:25.737

我找到了解决问题的方法。

这样做的方法是复制基准目录，重命名它，然后删除不需要的输入文件。删除 ref 和 train 输入文件很重要。此外，需要编辑 Spec/object.pm 文件以设置新名称。还需要编辑 CFP2006.bset 或 CINT2006.bset 文件以添加新基准，否则即使在原始文件中，runspec 也不会显示任何结果。

它不漂亮，但效果很好。

# ruby-on-rails - 将 RVM gemsets 与 mod_rails（乘客）一起使用有什么意义吗？

> ID：13961965
> 
> 赞同：0
> 
> 时间：2012-12-19T21:59:18.140
> 
> 标签：ruby-on-rails, rvm, passenger

我在我的应用程序所在的父目录中创建了一个 .rvmrc 文件，并在其中放置：

`rvm ruby-1.9.3-p327@ruby-1.9.3-p327-project_name`

在我的 deploy.rb 文件（我正在使用 Capistrano）中，我有：

`set :rvm_ruby_string, 'ruby-1.9.3-p327@ruby-1.9.3-p327-project_name'`

但是，我认为当前稳定版本的Passenger 无论如何都不能在每个应用程序中使用独立的gemset，我是否正确？所以我还不如不费心做上面的事情？或者当乘客 4 出来时将其安装到位是件好事吗？保留它有什么缺点吗？我应该删除这些引用吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T22:06:11.493

当前乘客不支持不同的红宝石，使用此文档可以轻松添加对不同红宝石的支持：[https ://rvm.io/integration/passenger/](https://rvm.io/integration/passenger/)

# c# - 更新后图像未保存，在 c# 中使用 FileStream 或 Simple Bitmap

> ID：13961973
> 
> 赞同：2
> 
> 时间：2012-12-19T22:00:05.540
> 
> 标签：c#, gdi+, bit-manipulation

我正在为桌面应用程序中的一个实用程序工作，与一些图形工作有关。

我必须加载小缩略图和全尺寸位图。我正在使用此代码执行此操作。

```
 FileStream fs = new FileStream("myphoto.jpg", FileMode.Open);
 Image imgPhoto = Image.FromStream(fs);
 fs.Close();
 PictureBox p = new PictureBox();
 p.Name = "p1";
 p.Image = imgPhoto;
 flowPanel.Controls.Add(p);
 //---- 
 FileStream fs = new FileStream("myphoto_thumb.jpg", FileMode.Open);
 Image img = Image.FromStream(fs);
 fs.Close();
 Button b_thumb = new Button();
 b_thumb.Name = "thumb1";
 b_thumb.BackgroundImage = img;
 flowBottom.Controls.Add(b_thumb); 
```

在此之后，我需要在此图片框的图像上添加一些效果。当我为图片框中的主（大）图像添加一些效果时，我也在底部背景图像中添加相同的效果。当我将此缩略图图像保存到现有缩略图图像时它正在保存，但是当我将图片框中的大图像保存在现有文件“myphoto.jpg”上时，它给了我错误，比如文件正在被另一个进程使用

```
//---- Add some Effects to image of Picturebox ---- //
PictureBox tempPic = flowPanel.Controls["p1"];
tempPic.Image.Save("myphoto.jpg",ImageFormat.Jpeg); 
```

我在 google 和 stackoverflow 上找到了很多解决方案，但没有找到帮助。如果有任何好的解决方案，请帮助。可能很简单，但我尝试了 10 多个小时但失败了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T22:05:43.677

您不会关闭您打开的 FileStream。我总是将这种东西包装在一个`using`结构中，所以它会自动被破坏，从而关闭：

```
using (FileStream fs = new FileStream("myphoto.jpg", FileMode.Open)) {
  // Do stuff
}

tempPic.Image.Save("myphoto.jpg",ImageFormat.Jpeg); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T22:23:35.060

尝试将您的文件流设置为只读：

```
fs = New System.IO.FileStream("myphoto.jpg", 
     IO.FileMode.Open, IO.FileAccess.Read) 
```

这是 Microsoft 的建议，针对尝试 Image.FromFile 并锁定文件的用户：http: [//support.microsoft.com/kb/309482](http://support.microsoft.com/kb/309482)

# sql-server - 如何将数据导入 Visual Studio 2012 Sql Server 数据库项目

> ID：13961975
> 
> 赞同：6
> 
> 时间：2012-12-19T22:00:27.077
> 
> 标签：sql-server, visual-studio-2012

我正在研究使用 Sql Server 数据库项目。它似乎从数据库中导入模式和存储过程，但没有导入实际数据的机制。作为我们构建过程的一部分，我们通常会同时导入模式和数据。

这可以从 Sql Server 数据库项目中完成吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-20T13:08:03.303

当前的解决方案是使用部署后脚本放置参考数据。脚本必须写成幂等的，因为它不知道目标的状态。这在这里详细描述：

[在 SQL Server 数据库项目中包含数据](http://blogs.msdn.com/b/ssdt/archive/2012/02/02/including-data-in-an-sql-server-database-project.aspx)

# jquery - rails + jquery 确认删除然后调用删除方法

> ID：13961976
> 
> 赞同：0
> 
> 时间：2012-12-19T22:00:31.727
> 
> 标签：jquery, ruby-on-rails

我正在使用 Rails 和 jquery。我有链接。。

```
<%= link_to 'Delete Meeting', "/meetings/#{@meeting.id}", {:class => "delete_meeting"}, :method => :delete %> 
```

上面的链接在我的会议显示页面中。我正在寻找的行为是，当用户单击删除链接时，我希望它删除会议，然后重定向到列出剩余会议的会议/索引页面。我还想在索引页面上显示“您的会议已被删除通知”。

当用户点击上面的链接时，我要求确认，然后我想简单地调用会议控制器中的删除方法。不过我不想使用 AJAX，因为删除后我想被路由到 meeting_path。对于这一切，我有以下 jquery ..

```
$(".delete_meeting").click(function(e){
  e.preventDefault();
  jConfirm('Are you sure you want to delete this meeting?', 'Confirm Delete', function(r) {
    if(r){
        // what does here? I want to call the link's href here
    }
    return false;
  });
}) 
```

..如果确认返回true，那么我想将请求发送到控制器的删除操作。我怎样才能做到这一点？我认为我不应该为此使用 window.location.href。我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T00:18:51.780

删除您的 jquery 函数，并在销毁操作中添加“redirect_to meeting_path”

# java - 为什么子类默认调用super()？

> ID：13961977
> 
> 赞同：2
> 
> 时间：2012-12-19T22:00:31.853
> 
> 标签：java, oop, constructor, subclass

这个问题一直困扰着我一段时间，我还没有找到一个好的答案（除了“就是这样”）。

让我给出一些背景代码，以说明我在说什么。

```
class Note {
    private final String name = "Note";

    public Note() {
        System.out.println(name);
    }
    // ...
}

class Todo extends Note {
    private final String name = "Todo";

    public Todo() {
        System.out.println(name);
    }
    // ...
}

// ...
Note note = new Todo(); // case 1
Todo todo = new Todo(); // case 2 
```

那么案例 1 和案例 2 是如何打印出来的：

```
Note
Todo 
```

这是没有意义的，因为`Todo()`(constructor) 不调用`super()`（至少不可见）。为什么子类必须调用父类的默认构造函数，为什么不要求任何子类实现构造函数？

我读了几个与此相关的[问题](https://stackoverflow.com/questions/9370520/subclass-constructors-why-must-the-default-constructor-exist-for-subclass-cons)，但没有人回答*为什么*。

**编辑：**
我想我的例子有点糟糕，但它实际上是 Java 7 认证问题的衍生品。从答案的集合中，我现在明白*了为什么*。让我提供一个更好的例子：

```
public Note {
    private String description;

    public Note() {
        description = "I'm a Note";
    }

    public Note( String description ) {
        this.description = description;
    }

    // getters/setters/etc.
}

public Todo extends Note {
    // field vars..

    public Todo() {
        // empty constructor
    }

    // getters/setters/etc..
} 
```

所以现在这更有意义了，因为当`Todo`被创建时，如果`super()`没有被插入到封面后面，则不会初始化的`Note`方面。`Todo`在这种情况下，拥有一个子类是没有意义的。谢谢大家！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-19T22:03:59.803

子类构造函数必须调用*一些*构造函数。如果您没有告诉它使用哪个，它将使用默认构造函数。

另一种方法是让超类中的变量完全未初始化，但可由子类和/或其方法访问，这将*非常*糟糕。

不过，静默调用默认超类构造函数而不是编译失败的决定是值得商榷的，但我怀疑它首先与“默认构造函数”的存在有关。

仅供参考，您的问题还表明您可能对继承感到困惑。和字段是*完全分开*的：您不能覆盖子类中的`Note.name`字段*，*只能覆盖方法。`Todo.name`

 *** * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-19T22:04:50.747

这个问题可以分为两部分。

1.  为什么必须调用超类的任何构造函数？这很简单：构造函数负责设置对象的状态，而由于超类中可能存在子类代码不可见的状态（即`private`字段），这只能通过调用超类的构造函数来处理.
2.  为什么不必`super()`显式调用？这只是在 Java 中做出的一个相当随意的设计决定，以使代码看起来更简单。它与 a 的概念很好地联系在一起`default constructor`（即，存在于没有定义显式构造函数的类中的隐含的无参数构造函数），尽管从您的示例中可以看出，它也适用于没有定义的类arg 构造函数在超类中显式定义。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T22:04:59.347

您不必显式调用超类构造函数。并且没有必要在子类构造函数中调用 super() 或 super(arguments)。如果您不指定，编译器将自动添加对无参数超类构造函数的调用。

如果超类没有无参数构造函数，则必须在每个子类构造函数中显式调用 super(arguments)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-19T22:07:48.320

两种情况都打印出 Note 和 Todo 的原因是您总是使用 operator new 创建 class 的实例`Todo`。如果你写过

```
Note note = new Note();
Note todo = new Todo(); 
```

那么结果将是：

```
Note
Note
Todo 
```

这种行为的原因是[多态性](http://en.wikipedia.org/wiki/Polymorphism_in_object-oriented_programming)。

要回答为什么构造函数必须调用超级构造函数来创建自己很容易想象。由于它使用该超类的元素，因此必须首先创建该类，因此继承它的类可以对其进行操作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-19T22:41:55.683

在您的示例中，父级的构造函数不对对象执行任何操作。

通常，构造函数通过设置字段来构造对象。这些字段对于该类的构造函数是已知的，并且可能无法在另一个类中设置或访问，并且您不希望在每个子类（已经在父类中）中复制所有代码，这样父字段设置正确。

因此，对于每个类来说，初始化它所知道的字段是有意义的，而不是依赖于子类的行为来正确地表现。这允许您更改一个类而无需更改它的子类。例如添加或更改字段。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-19T22:06:22.477

事实上，确实如此。即使您不编写*super()*调用，它也会自动添加。这是 Todo 构造函数中的第一条指令。

要自己测试，只需创建一个带有参数的新 Note 构造函数并删除空的构造函数。看看现在发生了什么：）

为什么会发生这种情况？嗯，这很简单：因为这就是它的实现方式。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-19T22:07:43.187

[文档](http://docs.oracle.com/javase/tutorial/java/IandI/super.html)说明了一切：

> 如果构造函数没有显式调用超类构造函数，Java 编译器会自动插入对超类的无参数构造函数的调用。如果超类没有无参数构造函数，则会出现编译时错误。Object 确实有这样的构造函数，所以如果 Object 是唯一的超类，则没有问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-12-19T23:15:10.123

就是这样！:)

对我来说，这一切都很有意义，因为您在面向对象编程范式中编写代码的主要原因是重用现有代码。

有很多方法可以重用，其中一种是继承一个类（即：创建一个子类）。

当您继承一个类时，您也继承了该类的创建方式。

在我看来，如果不存在这种行为，Java 将是一种更加混乱的语言**

# ios - iOS网络应用程序，全屏？

> ID：13961981
> 
> 赞同：2
> 
> 时间：2012-12-19T22:00:37.127
> 
> 标签：ios, web-applications, safari, iphone-standalone-web-app

当您使用元标记时，有什么方法可以确定您是否处于 Safari 全屏模式`apple-mobile-web-app-capable`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T22:28:06.133

有了这个

```
window.navigator.standalone 
```

它是`true`全屏的

# jakarta-ee - 在 Juno 中使用 javax.servlet 2.5 插件

> ID：13961984
> 
> 赞同：1
> 
> 时间：2012-12-19T22:00:47.953
> 
> 标签：jakarta-ee, eclipse-plugin, eclipse-juno, servlet-3.0, servlet-2.5

在为 Eclipse 开发插件时，我想使用`javax.servlet`与 Java EE eclipse 捆绑在一起的插件。我发现，但是，Juno 打包的版本带有 servlet 3.0 规范。有没有办法安装和使用提供 servlet 2.5 API 的 Juno 插件？

# javascript - jQuery Click 绑定不会在 IE8 中触发

> ID：13961990
> 
> 赞同：2
> 
> 时间：2012-12-19T22:01:04.003
> 
> 标签：javascript, jquery, internet-explorer-8

在 IE8 中永远不会触发 jQuery 点击绑定（适用于 IE9、Chrome 等）。如何让点击事件在 IE8 中触发，为什么目前没有？

注意：我尝试将 href 更改为“#”，但这也不起作用。

```
$('<a/>', {
    id: 'anchor-id',
    href: 'javascript:void(0);',
    'class': 'button-next',
    html: 'HTML'
}).click(function() {
     alert('clicked');
}).appendTo($('#append'));​ 
```

版本：1.7.2

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T22:02:43.937

你试过使用[`.on()`](http://api.jquery.com/on/)吗？

`.on()`将为与您的选择器匹配的所有当前和未来元素创建一个事件处理程序。在下面的语句中，无论何时将它们添加到 DOM 中，`click`都将为具有类的所有元素处理事件。`button-next`

```
$(document).on('click', '.button-next', function(e) 
{ 
  //do something
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-19T22:03:13.813

尝试这样的事情

```
$(document).on('click', '.button-next', function() {
    // code here
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T22:08:11.103

我能够使用以下方法使其在 IE8 中工作：

```
<div id="append"></div>
<script>
    var aLink = $('<a/>', { id: 'anchor-id', href: '#',html : 'click me'}).on('click', function () {
         alert('clicked');
    });
    $('#append').append(aLink);

</script> 
```

另外，请确保您没有任何 console.log() 在那里。IE 不太喜欢它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-19T22:26:43.237

您是否停止了事件传播？

通常使用链接，您必须执行以下操作：

```
<a href="#">HTML</a> 
```

这个脚本可以工作：

```
jQuery('#someLink').bind('click', function(e){  
  e.preventDefault();  
  //.. do something  
}); 
```

*注意：*你的 javascript:void(); **应该**已经涵盖了这一点，但只是检查。

如果它不是“真正的”链接，则不必强制使用该`A`元素，因为您可以使用创建对象的相同 jQuery 模拟悬停事件：

```
jQuery("<span>", {  
  text: "html",  
  id: "anchor-id",  
  "class": "button-next",  
  click: function() { /* do something */ },  
  mouseover: function() { /* hover over */ },  
  mouseout: function() { /* hover out */ }
}).appendTo(jQuery('#append')); 
```

# css - 什么是 CSS 变体？

> ID：13961994
> 
> 赞同：-1
> 
> 时间：2012-12-19T22:01:34.030
> 
> 标签：css, variables

我在一个网站上工作，我的老板想让我使用 CSS 变体，我不知道他在说什么。

假设我有 20 个不同的元素使用`#7d2d39`，而不是：

```
background-color:#7d2d39
color="#7d2d39" 
```

在所有的样式表中，他希望我使用：

```
background-color:red1"
color="red1" 
```

并在某个地方定义什么是“red1”，这样我们就可以全局更改一种十六进制颜色而不是更改 20 次？当我输入它时它是有道理的，但我认为这不存在。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T22:03:16.300

您需要使用支持动态样式表和变量的[LESS 之类的东西。](http://lesscss.org/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T22:15:57.453

CSS 预处理器是一种通过使用函数和变量之类的东西使 CSS 更加“程序化”的方法。最受欢迎的两个是：

*   [SASS](http://sass-lang.com/)
*   [较少的](http://lesscss.org/)

还有其他的：

*   [Google 闭包样式表](http://code.google.com/p/closure-stylesheets/)
*   [手写笔](http://learnboost.github.com/stylus/)

还有像[Twitter Bootstrap](http://twitter.github.com/bootstrap/index.html)这样使用 LESS 的项目。目前在 CSS 中没有任何东西可以直接使用。这一切都需要 JavaScript 或后端处理来将 LESS/SASS 文件转换为 CSS。

但它可以帮助开发人员保持代码的组织和清洁，并更快地管理更新。

我以前从未听说过“ *CSS 变体*”这个词，但我怀疑你的老板可能指的是“CSS 变量”，这更像是你所描述的。但变量只是预处理器提供的功能的一部分。

我希望这会有所帮助！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-19T22:07:06.023

我认为他在谈论[css 变量](http://dev.w3.org/csswg/css-variables/)，但这只是一个草稿。[LESS](http://www.lesscss.de)和[SASS](http://sass-lang.com)也是选项。

# javascript - 使用一键切换文本

> ID：13961995
> 
> 赞同：-4
> 
> 时间：2012-12-19T22:01:40.707
> 
> 标签：javascript, jquery, html

我需要创建 javascript 或 jquery，以最简单的为准，使用切换功能，其中按钮在两篇文章之间切换。第一篇文章仅包含文本，第二篇文章包含三个段落和图形（图像和图形标题）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T22:04:58.600

您可以在此处使用 jquery 示例中的[.toggle](http://api.jquery.com/toggle/#example-0) [()](http://api.jquery.com/toggle/)函数

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T22:12:25.910

我会使用 jquery 切换功能，以及隐藏和显示功能。

```
$('button').click().toggle(function () {
        $('item1').show();
        $('item2').hide();
    },
        function () {
            $('item1').hide();
            $('item2').show();
        }); 
```

# file - java中用于输入的“.in”文件是什么？

> ID：13961996
> 
> 赞同：2
> 
> 时间：2012-12-19T22:01:45.450
> 
> 标签：file

在一次编程竞赛中，我在每个问题的开头都发现了这些

> 程序：投票（cpp|java）
> 
> 输入：vote.in
> 
> 气球颜色：金色

什么是“.in”扩展名和气球颜色？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-19T22:02:48.707

就 Java 或 C++ 而言，“.in”文件扩展名没有任何特殊含义。它只是一个扩展名，以表明（对人类）它是一个输入文件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-19T22:02:31.280

`.in`只不过是编程竞赛用来指定输入的东西。内容只是一个纯文本文件。

# objective-c - 如何为主线程的注释视图设置图像

> ID：13961999
> 
> 赞同：0
> 
> 时间：2012-12-19T22:01:57.213
> 
> 标签：objective-c, multithreading, annotations, mapkit

我有一个从 Flicker 下载图像的应用程序（Xcode 4.5）。我有一个地图视图，它为每张照片的位置放置一个图钉。单击图钉会显示一个注释，其中显示照片的名称及其图像的缩略图。一切正常，直到我决定从主线程下载缩略图（我第一次尝试多线程）。使用我目前拥有的代码，注释不再显示缩略图。

我设置了 4 种方法来执行此任务。第四种方法甚至没有被调用。我希望有人可以查看此代码并指出明显的错误和/或尝试此操作的不同方式：

在我的地图视图控制器类中：

```
//an annotation was selected
- (void)mapView:(MKMapView *)mapView didSelectAnnotationView:(MKAnnotationView *)aView
{
self.currentAnnotationView = [[MKAnnotationView alloc]init];
self.currentAnnotationView = aView;
[self.delegate mapViewController:self 
    imageForAnnotation:self.currentAnnotationView.annotation];
} 
```

使用委托，上述方法在我的 tableview 控制器类中调用以下内容：

```
// downloads Flickr image
- (void )mapViewController:(MapViewController *)sender imageForAnnotation:    
      (id<MKAnnotation>)annotation
{      
FlickrPhotoAnnotation *fpa = (FlickrPhotoAnnotation *)annotation;

dispatch_queue_t downloadQueue = dispatch_queue_create("flickr annotation image  
       downloader", NULL);
dispatch_async(downloadQueue, ^{
    NSURL *url = [FlickrFetcher urlForPhoto:fpa.photo format:FlickrPhotoFormatSquare]; 
    NSData *data = [NSData dataWithContentsOfURL:url];
    self.thumbnailImage = [UIImage imageWithData:data];
        dispatch_async(dispatch_get_main_queue(), ^ {
            MapViewController *mvc = [[MapViewController alloc]init];
            [mvc setAnnotationImage];  
        });
    });
} 
```

上述方法通过 mapview 控制器类的实例调用以下消息：

```
//gets thumbnail image and sets it to the annotation view
 - (void)setAnnotationImage
 {
 UIImage *image = [self.delegate getThumbnailImage];
 [(UIImageView *)self.currentAnnotationView.leftCalloutAccessoryView setImage:image];
 } 
```

最后，上面的方法使用委托调用表视图控制器类中的以下方法（没有被调用 - 不知道为什么）：

```
//returns the thumbnail image acquired in download
 - (UIImage *)getThumbnailImage;
 {
    return self.thumbnailImage;
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T22:17:45.677

该方法没有被调用，因为您没有设置第二个 mapViewController 的委托：

```
dispatch_async(dispatch_get_main_queue(), ^ {
            MapViewController *mvc = [[MapViewController alloc]init];
            [mvc setAnnotationImage];  
            [mvc setDelegate:self];
        }); 
```

应该：

```
dispatch_async(dispatch_get_main_queue(), ^ {
            MapViewController *mvc = [[MapViewController alloc]init];
            [mvc setDelegate:self];
            [mvc setAnnotationImage];  
        }); 
```

...但是您不应该制作新的 mapViewController，您应该在*现有的*mapViewController（发送方）上设置注释图像。

```
dispatch_async(dispatch_get_main_queue(), ^ {
            [sender setAnnotationImage];  
        }); 
```

...并且在您调用 setAnnotationImage 时，您不妨传入 UIImage（因为您在传递消息时拥有该信息），从而避免了对最后一个委托回调的需要：

更改 setAnnotationImage 方法以接收图像：

```
- (void)setAnnotationImage:(UIImage*)image
 {
 [self.currentAnnotationView.leftCalloutAccessoryView setImage:image];
 } 
```

然后你可以一次设置它：

```
dispatch_async(dispatch_get_main_queue(), ^ {
            [sender setAnnotationImage:self.thumbnailImage];  
        }); 
```

...如果这是您唯一需要获取它的地方，那么 self.thumbnailImage 可能不需要是 iVar...