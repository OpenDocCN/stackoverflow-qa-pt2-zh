# StackOverflow 问答 14188000-14188999

# asp.net - 访问 GridView 的 ViewState

> ID：14188003
> 
> 赞同：1
> 
> 时间：2013-01-06T23:39:17.903
> 
> 标签：asp.net, viewstate, dataview

**我有的：**

我有一个没有分页的 GridView。在包含页面的 Page_Load 处理程序中，我从表存储中读取用户特定的值并将它们存储在一个集合中，以便 ObjectDataSource 的 SelectMethod 可以获取它们。

**我想要的是：**

当用户从 GridView 所在的同一页面上传一些新数据时，我希望 GridView 在旧数据之外显示新数据，而无需再次查询存储。

**有用的东西：**

Page_Load 处理程序中的 IsPostback 有助于避免在数据仍处于 ViewState 中时进行查询。用户单击上传按钮后，由于我猜是 GridView 的 ViewState，他仍然可以看到旧数据。

**我的尝试：**

我尝试从 GridView 派生并制作自己的用户控件，以便访问返回 StateBag 但无法找到其中显示的用户数据的 ViewState 属性。它仅显示 DataSourceID、_!ItemCount 等内容。

**我的问题：**

如何从 GridView 访问 ViewState 以便从后面的代码中检索列值或 DataKeyName 值等数据。

**附加信息：**

问题的答案[gridview是否将数据保存在viewstate中？](https://stackoverflow.com/questions/5503525/does-gridview-save-data-in-viewstate)声明 GridView 将其数据保存在其 ViewState 中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T00:10:50.417

您绝对不想访问 GridView 的视图状态。这是控件的内部实现细节，可能随时更改。

您需要做的就是`DataBind()`在设置新数据后调用 GridView，控件将显示更新的数据。

# php - PHP 函数错误未更新密码但收到 ok 消息

> ID：14188005
> 
> 赞同：1
> 
> 时间：2013-01-06T23:39:26.780
> 
> 标签：php, html, mysql

我正在尝试从登录的用户更改密码。在页面上它说密码已更改，但它没有更改，不在数据库上，也没有更改。我尝试使用新密码登录，但只有旧密码才能登录。我确实刷新了页面和所有内容。我尝试了几天，我想知道是否有人会发现我的错误。今晚我以为可能是因为密码在数据库上用md5加密。我将如何进行，因为我已经尝试了一些事情并且不起作用。

```
error_reporting(E_ALL); ini_set("display_errors","On");
<?php include "includes/connection.php" ?>
<?php
session_start();

if(@$_REQUEST["Submit"]=="Update")
{
$sql="update users set password ='$_REQUEST[newpassword]' where      user='$_SESSION[myusername]'";
if (!mysql_query($sql)) die('err: PROBLEM IN QUERY: '.mysql_error());
header("Location:changpass.php?msg=updated");
}
else
die('err: PROBLEM IN REQUEST');

?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML><HEAD><TITLE>Change password</TITLE>
<script language="javascript" type="text/javascript">
function validate()
{

var formName=document.frm;

if(formName.newpassword.value == "")
{
document.getElementById("newpassword_label").innerHTML='Please Enter New Password';
formName.newpassword.focus();
return false;
}
else
{
document.getElementById("newpassword_label").innerHTML='';
}

if(formName.cpassword.value == "")
{
document.getElementById("cpassword_label").innerHTML='Enter ConfirmPassword';
formName.cpassword.focus();
return false;
}
else
{
document.getElementById("cpassword_label").innerHTML='';
}

if(formName.newpassword.value != formName.cpassword.value)
{
document.getElementById("cpassword_label").innerHTML='Passwords Missmatch';
formName.cpassword.focus()
return false;
}
else
{
document.getElementById("cpassword_label").innerHTML='';
}
}
</script>
<style type="text/css">
<!--
.style1 {font-weight: bold}
.style7 {
color: yellow;
font-size: 24px;
}
.style9 {
color: #FF6666;
font-weight: bold;
}
.style12 {
color: #666666;
font-weight: bold;
}
.style14 {color: #CC0033; font-weight: bold; }
-->
</style>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
</HEAD>
<BODY>

<form action="changpass.php" method="post" name="frm" id="frm" onSubmit="return   validate();">
<table width="47%" border="1" cellspacing="0" cellpadding="0">
<tr>
<td colspan="2" align="center"></td>
</tr>
<tr bgcolor="#666666">
<td colspan="2"><span class="style7">Change Password</span></td>
</tr>
<?php if(isset($_REQUEST['msg']) && $_REQUEST['msg'] == 'updated') { ?>
<tr bgcolor="#666666">
<td colspan="2"><span class="style7">Password has been changed successfully.</span></td>
</tr>
<?php } ?>
<tr>
<td bgcolor="#CCCCCC"><span class="style14">New Password:</span></td>
<td bgcolor="#CCCCCC"><input type="password" name="newpassword" id="newpassword"    size="20" autocomplete="off"/>&nbsp; <label id="newpassword_label" 

class="level_msg"></td>
</tr>
<tr> 
<td bgcolor="#CCCCCC"><span class="style14">Confirm Password:</span></td>
<td bgcolor="#CCCCCC"><input type="password" name="cpassword" id="cpassword" size="20"  autocomplete="off">&nbsp; <label id="cpassword_label" 

class="level_msg"></td>
</tr><tr bgcolor="#666666"><td colspan="2" align="center"><input type="submit"   name="Submit" value="Update" /></td>
</tr></table><a href="index.php">Home</a></form></BODY></HTML>` 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T23:47:51.400

我增强了您的代码：

```
<?php
    if ($_REQUEST['Submit'] == "Update")
    {
        $sql = "UPDATE `users` SET `password`='".$_REQUEST['newpassword']."' WHERE `user`='".$_SESSION['myusername']."'";
        mysql_query($sql);
        header("Location: changpass.php?msg=updated");
        exit;
    }
?> 
```

**要使用此代码，请确保以下内容：**

1）您有正确的提交按钮，示例如下：

> `<input type="submit" name="Submit" value="Update" />`

2）您的密码字段正确，示例如下：

> `<input type="password" name="newpassword" value="" />`

3) 会话必须在 key 下设置`myusername`

4) 确保您的表格字段和名称是正确的。做更多的调试。

如果这仍然无法解决，请添加表单代码以进行进一步调查。

**编辑**

以下是此代码的解释，用于一些可能有帮助的基本调试目的：

```
<?php
    if (isset($_REQUEST['Submit']) && $_REQUEST['Submit'] == "Update")
    {
        if (!isset($_SESSION['myusername'])) trigger_error("DEBUG: SESSION VARIABLE IS NOT SET");
        if (!isset($_REQUEST['newpassword']) || empty($_REQUEST['newpassword'])) trigger_error("DEBUG: NEW PASSWORD IS NOT GIVEN");

        $sql = "UPDATE `users` SET `password`='".mysql_real_escape_string($_REQUEST['newpassword'])."' WHERE `user`='".mysql_real_escape_string($_SESSION['myusername'])."'";
        $qw = mysql_query($sql);
        if (!$qw) trigger_error("DEBUG: MYSQL RESPONDED WITH ERROR - ".mysql_error());

        header("Location: changpass.php?msg=updated");
        exit;
    }
?> 
```

**更新：调试步骤 #1**

将您的 php 文件中的代码更改为此并告诉我们是否出现任何错误消息。

```
if(@$_REQUEST["Submit"]=="Update")
{
    $sql="update users set password ='$_REQUEST[newpassword]' where     user='$_SESSION[myusername]'";
    if (!mysql_query($sql)) die('err: PROBLEM IN QUERY: '.mysql_error());
    header("Location:changpass.php?msg=updated");
}
else
    die('err: PROBLEM IN REQUEST'); 
```

# c++ - 更改/设置 MINGWDIR 环境变量到底有什么作用？

> ID：14188009
> 
> 赞同：2
> 
> 时间：2013-01-06T23:40:07.517
> 
> 标签：c++, boost, mingw, codeblocks

我正在尝试在 Windows 8 计算机上的 code::blocks 上安装 boost。由于我正在使用一个库，我使用 mingw 作为我的编译器。更改/设置 MINGWDIR 环境变量究竟做了什么，这如何帮助我安装 boost？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T05:35:15.880

许多安装、程序使用这个变量来快速准确地观察某个环境的确切位置。

例如：

使用您自己的配置批处理文件更容易。还要安装 Boost 以寻找“MINGWDIR”。

下面是一个**通用**示例。（与提升无关）。

```
@echo off
if [%MINGWDIR%] == [] goto environment_not_set
goto start_develop
:environment_not_set
echo
#############################################################################
echo Please adjust environment variables within this file:
set MINGWDIR=c:\mingw
echo
#############################################################################
rem instead of setting MINGWDIR here you could also set them
rem within the registry using the system control
:start_develop
set PATH=%MINGWDIR%\bin;c:\windows;
echo MINGWDIR = %MINGWDIR%
:end
pause 
```

# vba - VBA application.match 错误 2015

> ID：14188010
> 
> 赞同：2
> 
> 时间：2013-01-06T23:40:16.453
> 
> 标签：vba, excel

在我的`Main`程序中，我想编写一个快速的 if 语句来检查用户是否进行了有效输入（用户从数据列表中选择项目数量，请参见随附的屏幕截图）。为此，我正在检查项目编号是否不在项目列表中。如果是这样，则会显示一条错误消息；如果不是，则调用许多其他程序。

出于某种原因，虽然我在运行它时收到错误 2015，这意味着 if 语句始终为真，即使在正确的用户条目上也是如此。有人可以帮我理解错误吗？

*   项目编号输入是一个名为“IdSelect”的命名单元格，位于名为“Invoice”的工作表上
*   检查此输入的数据位于名为“输入”的工作表上
*   数据存储在 B 列中，称为“ProjectList”

下面的代码（注意：我已尝试粘贴 5 次，但由于某种原因，这次格式化仍然无法正常工作 - 知道那可能是什么吗？代码格式正确。抱歉显示混乱；如果有人能告诉我我会非常感激那个问题！）

```
Sub Main()
    'Turn off screen updating
    Application.ScreenUpdating = False
    'Define variable for currently active cell to reactivate it afterwards
    Dim OldActiveSheet As Object
    Dim OldActiveCell As Object
    Dim i As Integer
    Dim ProjectList As Range
    Set OldActiveSheet = ActiveSheet
    Set OldActiveCell = ActiveCell
    'If-statement to check whether project number is valid or not
    Worksheets("Invoice").Activate
    'Print to Immediate Window to check value - remove later
    Debug.Print Range("IdSelect").Value
    If IsError(Application.Match(Range("IdSelect").Value, "ProjectList", 0)) Then
        'Print to Immediate Window to check value - remove later
        Debug.Print Application.Match(Range("IdSelect").Value, Worksheets("Input").Range("ProjectList"), 0)
        MsgBox "Invalid Choice: Project with this number does not exist!"
        Exit Sub
    Else
        'Call procedures to execute
        Call SortData
        Call Count_Line_Items
        Call Count_Total_Rows
        Call Write_Services(ServCnt)
        Call Write_Expenses(ExpCnt)
    End If
    'Reactivate previous active cell
    OldActiveSheet.Activate
    OldActiveCell.Activate
End Sub 
```

“输入”表的屏幕截图：

![在此处输入图像描述](../Images/5a6906cb140e2758abc1bde1f71c1a75.png)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-07T00:12:08.870

您引用范围的方式很奇怪..因为您错过了`range`引用。奇怪的是，你在下一行做对了 `Debug.Print Application.Match(Range("IdSelect").Value, Worksheets("Input").Range("ProjectList"), 0)`

所以请试试这个：（我花了 100 年在手机上格式化我自己的帖子.....）。确保使用**显式引用**，如下面的示例代码所示。相应地设置您的床单。

```
Dim ws as Worksheet
Set ws = Sheets(1)

 IsError(Application.Match(ws.Range("IdSelect").Value, ws.Range("ProjectList"), 0)) Then 
```

这里是供您阅读的关于 on 的[错误处理`match`。](http://www.mrexcel.com/forum/excel-questions/615916-catching-error-visual-basic-applications-match-function.html)

# javascript - jquery循环遍历列表时，一次按键

> ID：14188011
> 
> 赞同：1
> 
> 时间：2013-01-06T23:40:36.907
> 
> 标签：javascript, jquery

我有一个输入框，在它下面是一个基本列表。当您在输入框中按向下箭头（或向上箭头）时，我想突出显示/更改第一个列表项的背景（就像它被选中一样）。

```
<div><input id="frmartist" type="text" value=""/></div>
<ul id="artistlist">
    <li id="artist-1">artist 1</li>
    <li id="artist-2">artist 2</li>
    <li id="artist-3">artist 3</li>
    <li id="artist-4">artist 4</li>
    <li id="artist-5">artist 5</li>
</ul> 
```

如果再次按向下箭头，则第二项将突出显示。如果再次按下，第三项将突出显示。

如果您要按向上箭头，则第二项将再次突出显示。

如何使用 jquery/javascript 控制这种行为？我猜我应该跟踪突出显示的项目，但除此之外，我想我一无所知。

我通过使用 e.which === 40 和 e.which === 38 来捕捉向上箭头和向下箭头，但我对去哪里访问列表的第一项感到困惑。

有小费吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T23:49:50.383

在变量中跟踪突出显示的艺术家的状态。然后将事件附加到监视`keyup`事件并查找 38 或 40 的窗口。更新突出显示的艺术家的状态，然后更新视图以反映基于关键事件的更改。

像这样，演示：http: [//jsfiddle.net/9bFAb/](http://jsfiddle.net/9bFAb/)

html:

```
<div><input id="frmartist" type="text" value=""/></div>
<ul id="artistlist">
 <li id="artist-1" class="highlighted">artist 1</li>
 <li id="artist-2">artist 2</li>
 <li id="artist-3">artist 3</li>
 <li id="artist-4">artist 4</li>
 <li id="artist-5">artist 5</li>
</ul> 
```

CSS：

```
.highlighted{
 background-color:red;
} 
```

js：

```
var artistIndex = 1;
function hightlightArtist(index){
 var selector = "#artist-" + index;
 $('.highlighted').removeClass('highlighted');
 $(selector).addClass('highlighted');
}
window.onkeyup = function(e){
  var code = e.which;
  if( code == 40 ){
    if( artistIndex < 5 )artistIndex++;
  }//up
  if( code == 38){
    if( artistIndex > 1 ) artistIndex--;
  }//down
  hightlightArtist(artistIndex);
}; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T00:01:21.553

这是一个不使用任何全局 JavaScript 状态的解决方案。这使得它比使用这种状态的解决方案更简单，因为在这里我们检查标记以找到它的当前状态。因此，该解决方案在某些方面更加稳健（没有数据冗余，不能有不同步状态）。

正如您所说，您必须跟踪当前选定的元素。但是，如果您使用专用的 CSS 类进行突出显示，则 CSS 类本身可以用作指示当前突出显示的元素的标记。

以下分别用于上下移动的函数应该可以解决问题。只需从每个按键处理程序中调用正确的处理程序。当前突出显示的列表项假定具有 CSS 类`highlighted`。我使用了一个辅助函数`moveBy`来实现最大的代码重用。

已编辑：使用 jQuery 重写了示例`index`，以实现对向上、向下页面等的更直接的支持。

```
var moveUp = function(list) { moveBy(-1, list); };
var moveDown = function(list) { moveBy(+1, list); };
var pageUp = function(list) { moveBy(-10, list); };
var pageDown = function(list) { moveBy(+10, list); };
var first = function(list) { moveBy(-$(list).children().length, list); };
var last = function(list) { moveBy(+$(list).children().length, list); };

var moveBy = function(delta, list) {
    list = $(list);
    var count = list.children().length;

    var current = list.children('.highlighted');
    if (!current.length) {
        // There are no highlighted items.
        // Highlight the first or the last, depending on whether
        // delta is up (negative), or down (positive).
        list.get(delta > 0 ? 0 : count - 1).addClass('highlighted');
    } else {
        // Find the next element according to delta. Do not wrap around.
        var nextIndex = current.index() + delta;
        nextIndex = Math.max(0, Math.min(count - 1, nextIndex));
        var next = list.get(nextIndex);

        // Switch highlighting.
        current.removeClass('highlighted');
        next.addClass('highlighted');
    }
}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-06T23:49:11.127

给你的起点。向上和向下箭头都有效。如果您按下键试图越过列表的末尾或开头，它将正确环绕您可能也喜欢的。我希望它对你有帮助。

JSFIDDLE：http: [//jsfiddle.net/YnpW3/2/](http://jsfiddle.net/YnpW3/2/)

代码：

HTML：

```
<div><input id="frmartist" type="text" value=""/></div>
<ul id="artistlist">
    <li id="artist-1">artist 1</li>
    <li id="artist-2">artist 2</li>
    <li id="artist-3">artist 3</li>
    <li id="artist-4">artist 4</li>
    <li id="artist-5">artist 5</li>
</ul> 
```

JS：

```
 var h = 0;
function lich()
{
  $("li").css({color: "black"});
  $("li").eq(h).css({color: "Red"});
}
lich();
$(window).on("keyup", function(e){
   if(e.keyCode == 40)
   {
       h++;
       if(h > $("li").length - 1)
       {
         h= 0;        
       }
       lich();

   }
  else if(e.keyCode ==38)
  {
       h--;
       if(h < 0)
       {
         h= $("li").length - 1;        
       }
       lich();
  }
}) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-07T00:00:24.840

## [jsBin 演示](http://jsbin.com/eyimun/2/edit)

这也会循环，它并不关心你有多少艺术家；）

```
var $artists = $('#artistlist li'),
    nOfArtists = $artists.length,
    curr = 0;

$artists.eq( curr ).addClass('highlight');

$(window).on('keyup', function( e ){
  var key = e.which;

  if(key == 40){
    curr++ ;
    curr = curr % nOfArtists ;
  }else if(key==38){
    curr-- ;
    if(curr === -1){
      curr = nOfArtists-1; 
    }
  }
  $artists.eq(curr).addClass('highlight').siblings().removeClass('highlight');

}); 
```

# c++ - 尝试在 C++ 中创建基本 ThreadManager 时出错

> ID：14188012
> 
> 赞同：0
> 
> 时间：2013-01-06T23:40:41.167
> 
> 标签：c++, multithreading

我可能有几年没有编写太多代码了，我想用 C++ 制作一个非常基本的线程管理器，以实现我的想法。我遇到了一个问题，我收到此错误：

> ThreadManager.cpp:49:37: 错误：无法将 'ThreadManager::updateLoop' 从类型 'DWORD (ThreadManager::)(LPVOID) {aka long unsigned int (ThreadManager::)(void*)}' 转换为类型 'LPTHREAD_START_ROUTINE {aka long unsigned int (**属性**(( **stdcall** )) *)(void* )}'

但是，我不知道如何尝试修复它。这是我的代码，我不知道如何将其粘贴到此处并进行格式化。它说我每行需要 4 个空格，但这似乎需要一段时间，所以我把它放在 pastebin 上：

线程管理器.cpp：http : [//pastebin.com/2bL3mTqv](http://pastebin.com/2bL3mTqv)

ThreadManager.h：[http://pastebin.com/7xETj5BK](http://pastebin.com/7xETj5BK)

就像我说的，我很久没有编程了，我正试图用我记得的东西重新开始，所以任何帮助都将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T23:56:57.900

评论已经说明了基础知识，但这里详细说明：当调用需要正常函数时，您不能将方法传递给类。为了做你想做的事，我会做以下事情：

```
// New Function
void threadMain(void* classPointer)
{
    ThreadManager* realClass = (ThreadManager*)classPointer;
    realClass->updateLoop();
}

ThreadManager::ThreadManager(int max)
{
    // Assign maxThreads to max value
    maxThreads = max;

    // Start updateThread, and let it run updateLoop() until terminated
    updateThread = CreateThread(
                                NULL,       // default security attributes
                                0,          // use default stack size
                                threadMain, // thread function name
                                this,          // argument to thread function
                                0,          // use default creation flag
                                NULL);      // ignore thread identifier

    // Check the return value for success
    // If failed, exit process.
    if (updateThread == NULL) {
        ExitProcess(3);
    }      
} 
```

现在我知道你想要一个额外的参数，所以可能使用 std::tuple 来传递“this”指针和你真正想要的任何额外参数。

现在说了这么多，听取其他人的建议并使用[std::thread](http://en.cppreference.com/w/cpp/thread)等，除非你真的需要，否则不要使用特定于 win32 的调用。

# mysql - 代码点燃大查询结果 result_array() 结果

> ID：14188021
> 
> 赞同：7
> 
> 时间：2013-01-06T23:41:34.463
> 
> 标签：mysql, codeigniter

我正在看[这个](http://ellislab.com/codeigniter/user-guide/database/results.html)。

我的查询最多返回 10,000 行并且通常会填满内存

我目前正在做：

```
$this->db->get()->result_array(); 
```

有没有办法不将所有数据加载到内存中并使用某种游标？似乎结果和结果数组都是数组。（一个是对象数组，另一个是数组数组）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-07T04:04:48.763

如果您使用的是我个人推荐的 Active Record，那么`limit()`应该可以实现您的目标。

`$this->db->limit();`

**也可以这样使用**，*稍微容易一些，代码行数也少*：

```
$query = $this->db->get('Table_Name', 50); //syntax db->get('Table',limit_val);
return $query->result(); 
```

**也**可以返回一个带偏移量的限制：

```
$this->db->limit(10, 20); // Second parameter lets you set a result offset 
```

**有关 Active Record Query 的更多帮助的链接** [https://www.codeigniter.com/userguide2/database/active_record.html#select](https://www.codeigniter.com/userguide2/database/active_record.html#select)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T04:33:58.910

Mysql 偏移量是您要查找的指针。你可以像这样使用它：

```
 $this->db->get(tableName,10,20); 
```

第二个参数和第三个参数帮助您设置 limit 和 offset 。

[这里有更多细节](http://ellislab.com/codeigniter/user-guide/database/active_record.html)

# javascript - 多个表单提交验证？

> ID：14188022
> 
> 赞同：1
> 
> 时间：2013-01-06T23:41:37.053
> 
> 标签：javascript

我有一个表单，目前我有一个 javascript 代码来验证我的表单，以确保用户填写每个输入。我的表单操作包括：

```
onsubmit="return validateForm();" 
```

这是确保填写每个字段的javascript。如果有什么不同，这是我的javascript代码：

```
<script type="text/javascript">// 
<![CDATA[function validateForm() { 
    var a=document.forms["myform"]["inf_field_FirstName"].value; 
    var b=document.forms["myform"]["inf_field_Email"].value; 
    var c=document.forms["myform"]["inf_field_Phone1"].value; 
    if (a==null || a=="" || a=="First Name Here")
    {   alert("Please enter your First Name!");   
    return false;   }     
    if (c==null || c==''|| c=="Enter Your Phone Here")
    {    alert("Please insert your phone number!");   
    return false;   }    
    var emailRegEx = /^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i;    
    if (document.myform.inf_field_Email.value.search(emailRegEx) == -1)  
    {           alert("Please enter a valid email address.");               
    return false;    } }
    // ]]>
</script> 
```

但是，在 c 处定义的电话号码字段中，我想添加另一个脚本，如果用户没有输入至少 9 位长的电话号码，该脚本将弹出。我正在考虑添加这样的代码

```
<script type="text/javascript">
function validate(){

var c=document.forms["myform"]
    if (input.length<9){
        alert("Please enter a real phone number")
        return false
    }else {
        return true
    }
}
</script> 
```

但是我不知道如何在提交时运行这两个函数。我对javascript非常陌生，所以如果已经有一个简单的解决方案，请原谅。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T23:50:39.447

onsubmit= 之后引号中的所有内容都只是 javascript。您可以通过执行以下操作确保两个函数都返回 true：

```
onsubmit="return validateForm() && validate();" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T23:53:11.127

您可以将其添加为该条件中的另一条规则。例如：

```
if (c==null || c==''|| c=="Enter Your Phone Here" || c.length < 9)   {    
  alert("Please insert your phone number!");   
  return false;
} 
```

重构这段代码可能是最好的，但这可能是完成你需要的最快的方法。

# c# - Dispatcher.Invoke 参数抛出 IlegalOperationException

> ID：14188029
> 
> 赞同：0
> 
> 时间：2013-01-06T23:42:45.300
> 
> 标签：c#, wpf, c#-4.0, asynchronous

我有以下代码，`IlegalOperationException`因为我的参数拥有另一个线程。我知道为什么会出现此异常，但我不知道如何解决此问题。

```
//called on UI thread
public void redraw()
{
     new Thread(setPoints).Start(); //calculating new points
}

void setPoints()
{
    PointCollection c = new PointCollection();
    //calculating points to collection
    Task.Factory.StartNew((Action<object>)((p) => { polyline.Points = (PointCollection)p; }), c);

} 
```

编辑：

好的，这里与调度员一致

```
polyline.Dispatcher.Invoke((Action<PointCollection>)((p) => { polyline.Points = p; }), c); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T00:21:07.480

PointCollection 是一个 DependencyObject，您不能从一个线程实例化它并从另一个线程访问它。尝试在单独的线程中进行计算以生成所需的任何数据，然后在 UI 线程中实例化 PointCollection。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T00:07:52.203

我想你需要做这样的事情

```
private void reDraw()
        {
             Task<IList<Point>> calculatePointTask = Task.Factory.StartNew(() =>
            {
                //Use the list of points instead of thread-bound PointCollection
                IList<Point> pointCollection = new List<Point>();

                //Simulating that we calculate points
                Thread.Sleep(3000);

                pointCollection.Add(new Point(10,20));
                pointCollection.Add(new Point(10,20));

                return pointCollection;
            });

        calculatePointTask.ContinueWith(ante =>
            {

                var calculatedPoints = calculatePointTask.Result;

                Action<IList<Point>> updateUI = (points) =>
                    {

                        var pointCollection = new PointCollection(points);
                        polyline.Points = pointCollection;

                    };

                Application.Current.Dispatcher.Invoke(updateUI, calculatedPoints);

            }, TaskContinuationOptions.AttachedToParent);
        } 
```

在您的重绘功能中。

编辑：计算点时使用点列表而不是 PointCollection 实例

# sql - 在数据库中留下约束错误有什么危险？

> ID：14188030
> 
> 赞同：4
> 
> 时间：2013-01-06T23:42:48.957
> 
> 标签：sql, sql-server-2008, constraints

我不得不从具有许多 FK 约束的表中删除数千条记录。我停止了对所有表的约束强制执行，并删除了记录并修复了 DBCC 检查显示给我的一些明显约束，然后我启用了反向约束。不幸的是，在那之后 DBCC 检查仍然显示一些错误，但此时我没有时间搜索原因。然后我的问题就像标题一样可能很愚蠢，但是如果我离开数据库一段时间并出现约束错误会发生什么？使用该数据库的应用会受到影响吗？我可以推迟修复约束吗？（我使用 SQL Server 2008）谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T23:46:50.263

您将拥有缺乏完整性的数据（包含一些无效信息）。这不会使数据库崩溃或产生错误，但应用程序对此的反应完全取决于应用程序。您可能会看到一些错误页面，或者更糟糕的是，无效数据会传播以产生更多无效数据或操作（之后可能更难追踪和修复）。

这些约束的目的是使数据库验证（或拒绝）数据，以便应用程序可以依赖数据中未出现的某些无效模式。许多应用程序被构建为不使用这些保证并自己处理数据完整性，但是如果您的应用程序确实依赖于它们，然后您将它们从它下面拉出来，这听起来有点危险。

# c++ - 通过快速 i/o 打印 long long

> ID：14188037
> 
> 赞同：0
> 
> 时间：2013-01-06T23:44:00.563
> 
> 标签：c++, c

以下代码用于打印`int`. 如何修改它以打印`long long int`？请解释。

对于`pc`, 阅读[`putchar_unlocked`](http://linux.die.net/man/3/getchar_unlocked)

```
inline void writeInt (int n)
{
    int N = n, rev, count = 0;
    rev = N;
    if (N == 0) { pc('0'); pc('\n'); return ;}
    while ((rev % 10) == 0) { count++; rev /= 10;}
    rev = 0;
    while (N != 0) { rev = (rev<<3) + (rev<<1) + N % 10; N /= 10;}
    while (rev != 0) { pc(rev % 10 + '0'); rev /= 10;}
    while (count--) pc('0');
    pc('\n');
    return ;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-06T23:49:48.153

代码中没有关于 int 的具体内容。只需将两次出现的“int”都替换为“long long int”，就完成了。

（我通过 shift 发现 *10 的“优化”，并添加了所有剩余的分区非常荒谬。任何体面的 C 编译器都会自动执行此操作（以及更多）。并且不要忘记针对此“快速”版本进行分析stdlib 例程，以确保它确实值得付出努力）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-07T00:03:43.517

这段代码比它需要的要复杂一点：

```
inline void writeLongLong (long long n)
{
    char buffer[sizeof(n) * 8 * 3 / 10 + 3];  // 3 digits per 10 bits + two extra and space for terminating zero. 
    int index = sizeof(buffer)-1;
    int end = index;
    buffer[index--] = 0;
    do {
       buffer[index--] = (n % 10) + '0';
       n /= 10;
    } while(n);
    puts(&buffer[index+1]);
} 
```

这做同样的工作，大约一半的除法/模运算，至少我可以更好地遵循它。请注意，stdio/stdlib 函数可能比这更好，并且此函数不能处理负数（上面发布的函数也不处理）。

# jquery - 如何在 flexislider2 中添加水平滚动条

> ID：14188039
> 
> 赞同：0
> 
> 时间：2013-01-06T23:44:20.253
> 
> 标签：jquery, html, css

我正在使用带有缩略图的 flexislider2 (http://flex.madebymufffin.com/examples/thumbnail-controlnav.html)，并且想知道如何添加水平滚动。我正在尝试在我的网站 (http://109.109.245.194/nkarch/the-work/marlin-lodge-residence-scotland.aspx) 上使用它，并且缩略图堆叠在其他网站的顶部。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T04:35:23.627

这对于评论来说太大了，所以就在这里！

修复页面上的脚本错误。如果您使用 Firefox 上的 firebug、Opera 上的 Dragonfly 或 Google Chrome 等工具，请检查元素并单击控制台选项卡。

下面将解决您的问题。确保您了解他们为什么会解决您的大部分问题。

```
 <script src="jquery.min.js" type="text/javascript"></script>
    <script src="http://109.109.245.194/nkarch/js/modernizr.js"  type="text/javascript"></script>
    <script src="http://109.109.245.194/nkarch/scripts/JScript.js" type="text/javascript"></script>
    <script src="http://109.109.245.194/nkarch/js/jquery.mousewheel.js" type="text/javascript"></script>
    <script src="http://109.109.245.194/nkarch/js/froogaloop.js" type="text/javascript"></script>
    <script src="http://109.109.245.194/nkarch/js/jquery.easing.js" type="text/javascript"></script>
    <script src="http://109.109.245.194/nkarch/js/jquery.fitvid.js" type="text/javascript"></script>
    <script src="jquery.flexslider.js" type="text/javascript"></script>
    <script src="http://109.109.245.194/nkarch/js/shBrushCss.js" type="text/javascript"></script>
    <script src="http://109.109.245.194/nkarch/js/shBrushJScript.js" type="text/javascript"></script> 
```

至于水平滚动条，您必须使用 CSS 才能使其按您的意愿运行。这不是剧本问题，绝对是风格问题。您真的可能要考虑使用[codaslider](http://kevinbatdorf.github.com/codaslider/)。它像 flexslider 一样完全响应，但它支持交联，这使您能够将两个单独的滑块链接在一起。因此，您可以将其中一个用作缩略图滑块，根据用户单击的项目，该滑块将在页面其他位置以更大的滑块变化。我确定您可以在 ASP 中生成这些选项卡（或手动生成）。我是一名 LAMP 开发人员，所以我对 ASP 或 .NET 知之甚少。希望这可以为您提供更多信息，并有助于指导您。

# svn - 如何获取 svn 存储库以前的提交号

> ID：14188042
> 
> 赞同：0
> 
> 时间：2013-01-06T23:44:52.137
> 
> 标签：svn

> **可能重复：**
> [如何访问当前的 Subversion 内部版本号？](https://stackoverflow.com/questions/110175/how-to-access-the-current-subversion-build-number)

如何获取我之前承诺的提交编号？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T23:52:34.767

`svn log | grep '$USER' | head -2 | cut -d' ' -f1 | tail -1`为我工作：

```
{Z} hd1: 15:50 % svn log | grep 'cutting' | head -2 | cut -d' ' -f1 | tail -1 
r421185 
```

# powershell - 需要 Powershell 脚本来提取仅包含 Style.CSS 的特定文件夹的 ZIP？

> ID：14188048
> 
> 赞同：2
> 
> 时间：2013-01-06T23:46:15.013
> 
> 标签：powershell, zip, extract, unzip, extraction

需要 Powershell 脚本来提取仅包含 Style.CSS 的特定文件夹的 ZIP？

我有许多包含文件夹和文件的 ZIP 文件。我需要一个脚本来仅从 ZIP 文件中过滤和提取包含 Style.CSS 的整个文件夹。

有一个[类似的](https://stackoverflow.com/questions/4788386/extracting-a-specific-folder-from-a-zip-using-dotnetzip)使用 DotNetZip，但不能完全检测到包含 Style.css 的未知文件夹名称，然后仅提取该文件夹。

请指教。谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-07T23:24:30.343

[*这是使用 .Net Framework 4.5 的ZipFile*和*ZipFileExtensions*](http://msdn.microsoft.com/en-us/library/3z72378a.aspx)类开始的一种方法：

```
Add-Type -Assembly System.IO.Compression.FileSystem

foreach($sourcefile in (Get-ChildItem -filter "*.zip"))
{
    Write-Host "Processing $sourcefile"
    $entries = [IO.Compression.ZipFile]::OpenRead($sourcefile.FullName).Entries

    #first pass to collect the paths of the folders with a Style.CSS file 
    $folders = $entries |
        ?{ $_.Name -eq 'Style.CSS' } |
        %{ split-path $_.FullName } | unique

    #second pass to extract just the files in those folders
    $entries |
        ?{ (split-path $_.FullName) -in @($folders) -and $_.Name } |
        %{
            #compose some target path
            $targetpath = join-path "$targetroot" (join-path $sourcefile.Name $_.FullName)
            #create its directory
            md (split-path $targetfilename) >$null 2>&1
            #extract the file (and overwrite)
            [IO.Compression.ZipFileExtensions]::ExtractToFile($_, $targetfilename, $true)
        }
} 
```

只需定义一些`targetroot`或组成另一个`targetpath`……</p>

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T13:32:48.597

如果 .NET 4.5 不是一个选项，请使用 7zip： [http ://sevenzip.sourceforge.jp/chm/cmdline/commands/extract.htm](http://sevenzip.sourceforge.jp/chm/cmdline/commands/extract.htm)

# python - mongoengine - 使用 QuerySet 作为 ReferenceField

> ID：14188049
> 
> 赞同：2
> 
> 时间：2013-01-06T23:46:29.480
> 
> 标签：python, mongodb, mongoengine

基于本[教程](https://mongoengine-odm.readthedocs.org/en/latest/tutorial.html)：

```
from mongoengine import *

connect('tumblelog')

class User(Document):
    email = StringField(required=True, unique=True)
    first_name = StringField(max_length=50)
    last_name = StringField(max_length=50)

class Comment(EmbeddedDocument):
    content = StringField()
    name = StringField(max_length=120)

class Post(Document):
    title = StringField(max_length=120, required=True)
    author = ReferenceField(User, reverse_delete_rule=CASCADE)
    tags = ListField(StringField(max_length=30))
    comments = ListField(EmbeddedDocumentField(Comment))
    meta = {'allow_inheritance': True}

class TextPost(Post):
    content = StringField()

class ImagePost(Post):
    image_path = StringField()

class LinkPost(Post):
    link_url = StringField()

def main():
    john = User(email='jdoe@example.com', first_name='John', last_name='Doe')
    john.save()
    john_from_db = User.objects(email='jdoe@example.com')
    post1 = TextPost(title='Fun with MongoEngine', author = john_from_db)
    post1.content = 'Took a look at MongoEngine today, looks pretty cool.'
    post1.tags = ['mongodb','mongoengine']
    post1.save()

if __name__ == '__main__':
    main() 
```

我在 post1.save() 上收到此错误：

```
mongoengine.base.ValidationError: ValidationError(A ReferenceField only accepts DBRef or documents: ['author']) 
```

我尝试在 ReferenceField 声明中添加 dbref=True/False 选项，但它没有解决任何问题。对象 john 是 User 类型，而 john_from_db 是 QuerySet。当然我在这里遗漏了一些东西，你如何从数据库中获取一个对象并在另一个中使用它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T00:17:03.170

您必须在 QuerySet 上调用 first() 以获取与查询匹配的第一条记录，例如

```
john_from_db = User.objects(email='jdoe@example.com').first() 
```

# java - 在新实例中发送电子邮件活动

> ID：14188056
> 
> 赞同：0
> 
> 时间：2013-01-06T23:46:50.457
> 
> 标签：java, android, android-intent, start-activity

我正在尝试从我的电子邮件类发送一封电子邮件，但是当程序启动时它崩溃了，我认为它可能与清单有关。以下是我的主要活动

```
import android.app.Activity;
import android.os.Bundle;
import android.view.View;

public class InvoiceActivity extends Activity {
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
    }

    public void SendMessage(View v)
    {
        // get email parameters
        SMTPmail mail = new SMTPmail();
        mail.SendSMTP("body of email","subject of email","recipient@example.com");
    }   
} 
```

这是 SMTP 邮件

```
import android.app.Activity;
import android.content.Intent;
import android.widget.Toast;

public class SMTPmail extends Activity {

    public void SendSMTP(String message, String subject, String recipted)
    {
        Intent i = new Intent(Intent.ACTION_SEND);
        i.setType("message/rfc822");
        i.putExtra(Intent.EXTRA_EMAIL  , new String[]{recipted});
        i.putExtra(Intent.EXTRA_CC, "");
        i.putExtra(Intent.EXTRA_SUBJECT, subject);
        i.putExtra(Intent.EXTRA_TEXT   , message);
        try {
            startActivity(Intent.createChooser(i, "Send mail..."));//crashes here in debug
            finish();
        } catch (android.content.ActivityNotFoundException ex) {
            Toast.makeText(SMTPmail.this, "There are no email clients installed.", Toast.LENGTH_SHORT).show();
        }
    }
} 
```

这是清单

```
<?xml version="1.0" encoding="utf-8"?> 
```

```
<uses-sdk android:minSdkVersion="10" />
<uses-permission android:name="android.permission.INTERNET"></uses-permission>

<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name" >
    <activity
        android:label="@string/app_name"
        android:name=".InvoiceActivity" >
        <intent-filter >
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <activity 
        android:name=".SMTPmail" 
        android:noHistory="true">
    </activity>
</application> 
```

下面的日志猫

```
 01-07 00:01:25.199: D/dalvikvm(14198): GC_EXTERNAL_ALLOC freed 43K, 51% free 2687K/5379K, external 0K/0K, paused 54ms
    01-07 00:01:30.389: D/AndroidRuntime(14198): Shutting down VM
    01-07 00:01:30.389: W/dalvikvm(14198): threadid=1: thread exiting with uncaught exception (group=0x40018560)
    01-07 00:01:30.399: E/AndroidRuntime(14198): FATAL EXCEPTION: main
    01-07 00:01:30.399: E/AndroidRuntime(14198): java.lang.IllegalStateException: Could not execute method of the activity
    01-07 00:01:30.399: E/AndroidRuntime(14198):    at android.view.View$1.onClick(View.java:2165)
    01-07 00:01:30.399: E/AndroidRuntime(14198):    at android.view.View.performClick(View.java:2506)
    01-07 00:01:30.399: E/AndroidRuntime(14198):    at android.view.View$PerformClick.run(View.java:9112)
    01-07 00:01:30.399: E/AndroidRuntime(14198):    at android.os.Handler.handleCallback(Handler.java:587)
    01-07 00:01:30.399: E/AndroidRuntime(14198):    at android.os.Handler.dispatchMessage(Handler.java:92)
    01-07 00:01:30.399: E/AndroidRuntime(14198):    at android.os.Looper.loop(Looper.java:130)
    01-07 00:01:30.399: E/AndroidRuntime(14198):    at android.app.ActivityThread.main(ActivityThread.java:3835)
    01-07 00:01:30.399: E/AndroidRuntime(14198):    at java.lang.reflect.Method.invokeNative(Native Method)
    01-07 00:01:30.399: E/AndroidRuntime(14198):    at java.lang.reflect.Method.invoke(Method.java:507)
    01-07 00:01:30.399: E/AndroidRuntime(14198):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:864)
    01-07 00:01:30.399: E/AndroidRuntime(14198):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:622)
    01-07 00:01:30.399: E/AndroidRuntime(14198):    at dalvik.system.NativeStart.main(Native Method)
    01-07 00:01:30.399: E/AndroidRuntime(14198): Caused by: java.lang.reflect.InvocationTargetException
    01-07 00:01:30.399: E/AndroidRuntime(14198):    at java.lang.reflect.Method.invokeNative(Native Method)
    01-07 00:01:30.399: E/AndroidRuntime(14198):    at java.lang.reflect.Method.invoke(Method.java:507)
    01-07 00:01:30.399: E/AndroidRuntime(14198):    at android.view.View$1.onClick(View.java:2160)
    01-07 00:01:30.399: E/AndroidRuntime(14198):    ... 11 more
    01-07 00:01:30.399: E/AndroidRuntime(14198): Caused by: java.lang.NullPointerException
    01-07 00:01:30.399: E/AndroidRuntime(14198):    at android.app.Activity.startActivityForResult(Activity.java:2827)
    01-07 00:01:30.399: E/AndroidRuntime(14198):    at android.app.Activity.startActivity(Activity.java:2933)
    01-07 00:01:30.399: E/AndroidRuntime(14198):    at com.android.EUROPE.Invoice.SMTPmail.SendSMTP(SMTPmail.java:17)
    01-07 00:01:30.399: E/AndroidRuntime(14198):    at com.android.EUROPE.Invoice.InvoiceActivity.SendMessage(InvoiceActivity.java:19)
    01-07 00:01:30.399: E/AndroidRuntime(14198):    ... 14 more 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T00:18:10.170

正如詹姆斯已经说过的，没有理由`SMTPmail`延长`Activity`. 一个简单的实现可能如下所示。

`SMTPmail`：

```
public class SMTPmail {

    public static void sendSMTP(Context context, String message, String subject, String recipted)
    {
        Intent i = new Intent(Intent.ACTION_SEND);
        i.setType("message/rfc822");
        i.putExtra(Intent.EXTRA_EMAIL  , new String[]{recipted});
        i.putExtra(Intent.EXTRA_CC, "");
        i.putExtra(Intent.EXTRA_SUBJECT, subject);
        i.putExtra(Intent.EXTRA_TEXT   , message);

        try {
            context.startActivity(Intent.createChooser(i, "Send mail..."));//crashes here in debug
        } catch (android.content.ActivityNotFoundException ex) {
            Toast.makeText(context, "There are no email clients installed.", Toast.LENGTH_SHORT).show();
        }
    }
} 
```

在`InvoiceActivity`：

```
public void SendMessage(View v)
{
    SMTPmail.sendSMTP(this, "body of email","subject of email","recipient@example.com");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T00:08:04.650

有没有理由`SMTPmail`延长`Activity`？这看起来是多余的。只需更改 STMPmail 使其不扩展任何类，这应该可以工作。您必须将 a 传递给`Context`该方法才能获得`startActivity()`.

# sql - 查询表达式中的语法错误（缺少运算符） - SQL 将 1 ID 拉回结果集中

> ID：14188060
> 
> 赞同：0
> 
> 时间：2013-01-06T23:47:46.273
> 
> 标签：sql, syntax, operator-keyword

请在我的 SQL 语句下面找到第 20 行的错误显然是；

[https://gist.github.com/815c4dd5655e79581a1a](https://gist.github.com/815c4dd5655e79581a1a)

我得到的当前错误是

```
Microsoft Access Database Engine error '80040e14'

Syntax error (missing operator) in query expression 'sea_Reference=A01AND sea_TheID=5'.

/STUDENT/s0191958/PART2/bookingprocess1.asp, line 22 
```

所有被请求的变量和东西都是数字。

我整晚都在删除和添加引号，我厌倦了！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T23:51:22.443

**在 AND 之前放置一个空格，并将 sea_Reference 的数据放在引号中。**

更改：'sea_Reference=A01AND sea_TheID=5'

到 'sea_Reference='A01' **AND** sea_TheID=5'

这是修改后的代码

```
SeatSetRs="SELECT sea_ID FROM seat WHERE sea_Reference='" & request("firstSeat") & "' AND sea_TheID=" & request("the_ID") & "" 
```

# database - 应付帐款/应收帐款数据库架构

> ID：14188062
> 
> 赞同：2
> 
> 时间：2013-01-06T23:47:53.553
> 
> 标签：database, database-design, database-schema, accounting

我搜索了这个主题，有很多解释要收集。主要是为 a/p 和 a/r 做单独的表格。

我正在考虑另一种方法，将两个表合并为 1，因为 a/c 和 a/r 有 98% 相似，并且仅相差 1 或 2 个属性（例如 a/p：供应商/供应商）。

**问题：**

是否可以合并 2 个表，并仅使用or`Transaction_Type`的值对每个事务进行分类？`Acnt_Payable``acnt_Receivable`

**我知道这是可能**的，但这是一个好习惯吗？我的系统在处理时将面临哪些情况`Reports`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T09:34:17.580

你的问题是：“另一张桌子或另一列”。鉴于我已经完成了很多 MySql 和会计数据库操作，我会毫不犹豫地将其`type`作为额外的专栏。

与报告的处理是您需要重新编写提取报告的代码。拥有额外的列意味着更少的连接（如果您现在拥有它们）。您将需要加强错误检查，因为对已经设计的软件进行更改似乎总是让我措手不及，而我之前没有考虑过设计的细微差别，这突然成为逻辑的范式转变。

我会说从空白画布重写报告代码；在你从“上次”增加的经验和这次重新审视它之间，你可能会做得更好。

恕我直言，对于性能方面，大多数企业和大多数普通程序员都可以安装现成的 MySql 或 PostgreSQL。当我观察到查询时间超过一秒时，通常是因为我需要添加索引。鉴于此，您可以使用另一个表，其中的 ID 代表 AR 与 AP（或任何其他人类术语），因为我认为数字会提高性能。

一旦一家公司到达了性能真正成为问题的地方，他们就会有资源聘请一个真正的 MySql 人来处理它。***讽刺：****当然，除非你使用的是 quickbooks，在这种情况下，一旦你超过了每天 20 笔交易的夫妻店，你就会让软件负担过重。*

# php - 升序排序，从第 2 个或第 3 个 ID 开始并返回......因为没有更好的描述

> ID：14188064
> 
> 赞同：0
> 
> 时间：2013-01-06T23:48:24.880
> 
> 标签：php, arrays, sorting

这可能是一个简单的问题，但我无法理解它......我研究的所有内容都提到了数组的升序或降序排序......我有一个数组['id'，'things']。

Foreach ($things as $thing) 循环按以下顺序回显它：1,2,3,4（显而易见）我如何对它进行排序：2,3,4,1 然后是 3,4,1,2 和也许是 4,1,2,3 ... 只是按升序排列，但每次都从不同的 Id 开始... 而表中的实际 ID 不一定是 1,2,3,4 可以是 5,6 ,7,8（尽管总是在一个组中）

这很明显吗？我仍然处于 PHP 规模的最低级别 :)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T00:23:10.763

您可以实现一些自定义迭代器。就像是 ：

```
class ArrayOffsetIterator implements Iterator {
    private $_array;
    private $_index;
    private $_startIndex;

    public function __construct(array $arr, $startIndex = 0) {
        if ($startIndex < 0) throw new Exception("Start index must be greater than zero");

        $this->_array = (array) $arr;

        if (empty($this->_array)) {
            $this->_index = $this->_startIndex = 0;
        } else {
            $this->_index = $this->_startIndex = $startIndex % count($arr);
        }
    }

    public function current() {
        if (empty($this->_array)) {
            return false;
        } else {
            return $this->_array[$this->key()];
        }
    }

    public function key() {
        if (empty($this->_array)) {
            return false;
        } else {
            return $this->_index % count($this->_array);
        }
    }

    public function next() {
        if (!$this->valid()) throw new Exception("End of iterator");
        $this->_index++;
        return $this->current();
    }

    public function rewind() {
        $this->_index = $this->_startIndex;
    }

    public function valid() {
        $size = count($this->_array);
        if ($size == 0) {
            return false;
        } else {
            $count = ($this->_index % $size) + (((int) ($this->_index / $size)) * $size) - $this->_startIndex;
            return $count < $size;
        }
    }
} 
```

并以这种方式使用它：

```
// some unsorted array
$array = array(
    'Erik',
    'Carl',
    'Alphred',
    'Doris',
    'Bob',
);

// sort it however you like...
sort($array);

// create your iterator (we'll start at index 2 of 0 based index)
$iterator = new ArrayOffsetIterator($array, 2);

// because it's an iterator, we can use it in foreach directly
foreach ($iterator as $key => $item) {
   echo $key . ' => ' . $item . "\n";
} 
```

将输出

```
2 => Carl
3 => Doris
4 => Erik
0 => Alphred
1 => Bob 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T06:17:15.097

谢谢大家，你们都为我指明了一些好的方向。我找到了一个对我有用且可扩展的非常简单的解决方案：我的 $firstarray 上升了 1,2,3,4，这个保持不变。

在第二个数组上：我使用了 array_shift($myarray); 从数组中删除第一个值并将其存储为 $first_value，然后我使用 array_push($myarray, $first_value); 在数组末尾插入第一个值。$myarray 现在 = 2,3,4,1 = $secondarray

对于 $thirdarray，我使用了 $secondarray 并对其进行了与第二个相同的操作。所以 $thirdarray = 3,4,1,2

这有点粗糙，但适合我的目的，只有 6 行左右！谢谢你们....

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T00:31:46.310

另一种方法是使用`array_merge`and `array_slice`，如下所示：

```
$myArray = array(4, 5, 6, 7, 8, 1, 2, 3);

function customSort ($array, $start = 7)
{
    sort($array);
    return array_merge(array_slice($array, $start - 1), array_slice($array, 0, $start - 1));
}

echo '<pre>';
var_dump(customSort($myArray)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-07T01:28:04.803

我认为描述不是那么清楚，在某些时候它给人的印象是它是关于排列的。无论如何，如果我理解正确并且你的数字是连续的，也许这可能会有所帮助：

```
function test($min, $max, $start){
    if( $start === $min)
        return range($min,$max);
    return array_merge(range($start,$max), range($min,$start-1));
} 
```

我也喜欢 blausocke 的回答。

# java - Android 应用显示：“无法播放此视频。” 在 Android 上播放 HTTP Live Stream 时

> ID：14188068
> 
> 赞同：2
> 
> 时间：2013-01-06T23:49:04.480
> 
> 标签：java, android, video, streaming, http-live-streaming

我正在尝试创建一个小的 Android 应用程序来播放以 H.264 / MP4 编码的 HTTP Live Streaming (HLS) 视频。

当我在我的设备上启动这个应用程序时，它说：

```
Can't Play This Video. 
```

该设备是运行 Android 4.1.2 的 Galaxy S3。这是我的代码：

```
package com.florianjensen.FlorianTest;

import android.app.Activity;
import android.os.Bundle;
import android.widget.MediaController;
import android.widget.VideoView;
import android.net.Uri;

public class MyActivity extends Activity {
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        VideoView myVideoView = (VideoView)findViewById(R.id.myvideoview);
        String httpLiveUrl = 
            "http://ds4178.flosoft-servers.net:1935/flosoft/" +
            "mp4:twitStream_1128/playlist.m3u8";

        myVideoView.setVideoURI(Uri.parse(httpLiveUrl));
        myVideoView.setMediaController(new MediaController(this));
        myVideoView.requestFocus();
        myVideoView.start();
    }
} 
```

是什么导致了这个错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T00:44:29.517

您必须在应用程序的清单中授予应用程序使用 Internet 的权限，以便程序知道警告用户您计划使用哪些功能。这也是用户可以根据哪些应用使用互联网而哪些不使用来选择 android Play 商店中的应用的一种方式。

```
<uses-permission android:name="android.permission.INTERNET" /> 
```

将上面的`uses-permission`标签放在标签内`manifest`：

```
<manifest xlmns:android...>

</manifest> 
```

添加后，它应该可以工作。有关如何放置此标签的更多说明：http: [//developer.android.com/guide/topics/security/permissions.html](http://developer.android.com/guide/topics/security/permissions.html)

# html - 在没有什么可修复的情况下使用 clearfix？

> ID：14188077
> 
> 赞同：1
> 
> 时间：2013-01-06T23:50:03.297
> 
> 标签：html, css, css-float, semantic-markup, clearfix

我很清楚（双关语）[实现 clearfix 的两种最佳方式](https://stackoverflow.com/a/1633170/1779823)是通过 Nicolas Gallager 的[微版本](http://nicolasgallagher.com/micro-clearfix-hack/) `.cf { *zoom: 1; }`，或者使用`overflow: hidden`.

**但是，当没有什么需要修复时，是否应该使用 clearfix 呢？**（再次双关语。）

换句话说，如果你有一个类似`article`或`section`仅仅出于语义原因的容器——它没有背景或任何视觉效果（如[本例](https://stackoverflow.com/a/5566093/1779823)中所追求的），但里面有浮动元素——你还应该清除它吗？

我为什么要问？

好吧，显然有些地方出了问题，因为如果您在网络检查器中调出容器，您将不会看到突出显示的容器，例如它只是一个不可见的滑行：

![在此处输入图像描述](../Images/55f3c0a4511c25982be54e1f974fe251.png)

（在[Firefox Tilt](https://addons.mozilla.org/en-us/firefox/addon/tilt/)中，它以 3D 形式可视化网站，当您将网站旋转 90 度时，容器块应该是一个空白区域。）

但这有关系吗？

到目前为止我的推理：

当然，如果您决定将来将容器用于视觉/布局目的，您会发现它的行为不正常，然后您将应用 clearfix hack。但是，还有什么需要考虑的呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T00:18:44.583

我认为您应该始终使用 clearfix。如果不这样做，可能会出现许多问题，例如在此 div 之后的某些元素中浮动内容，页面边界问题（边距、填充等）。总是使用它比在不使用它时搜索和查找问题更简单，因为并非在所有情况下都可以很明显地看出问题所在。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T19:34:50.417

听起来在您的情况下，问题还没有出现，但我更喜欢防御性地编写代码。如果您稍后尝试为包含浮动的元素添加边框或背景怎么办？它看起来不正确。或者，如果您稍后对浮动进行更改以使其不占用全部可用宽度怎么办？然后，随后的内联内容可能会潜入浮动的任一侧。在我看来，您正试图防止未来发生变化。

使用 clearfix 时，您试图避免两个问题：

1.  **包含后代浮动。**这意味着有问题的元素使自己足够高以包裹所有浮动的后代。（他们不挂在外面。）
2.  **使后代与外部浮子绝缘。**这意味着元素内部的后代应该能够使用`clear: both`并且不与元素外部的浮动交互。

每当元素包含浮动后代并且您想要完成这两个目标时，使用 clearfix 非常重要。我对所有包含浮动的元素执行此操作。在我[对同一问题的回答中](https://stackoverflow.com/questions/211383/which-method-of-clearfix-is-best/1633170)[阅读更多内容](https://stackoverflow.com/a/9932508/101869)。

（正如你可能从那篇文章中看出的那样，我强烈反对“实现 clearfix 的两种最佳方法是通过 Nicolas Gallager 的微版本`.cf { *zoom: 1; }`，或者使用`overflow: hidden`.”我对 没有问题`zoom: 1`，但[`overflow: hidden`会剪掉任何掉下来的东西在元素的范围之外](https://stackoverflow.com/questions/7074114/css-ignore-overflow-hidden/7074145#7074145)。）

# vb.net - VB 日志 WebBrowser 状态

> ID：14188079
> 
> 赞同：0
> 
> 时间：2013-01-06T23:50:13.387
> 
> 标签：vb.net, browser, status

我正在开发一个新项目，但目前陷入困境。我正在使用 ListBox 添加记录器。

在我的项目中，我使用的是 WebBrowser，并且我想在每次页面加载时添加到日志中。我正在尝试这样做：

```
 If WebBrowser1.StatusText.ToString = "Klar" Then
        Label14.Text = "Success"
    End If
    If Label14.Text = "Success" Then
        Logger.Items.Add("> Successfully loaded")
    End If 
```

“Klar”翻译为“完成”（瑞典语）

但是状态一直在更新，并且垃圾邮件“完成/Klar”因此我的记录器项目在状态更改之前添加了 5 次以上（我更改了页面）。

所以我正在寻找一种只写一次的方法，也许检查它是否已经被添加到之前的项目上。我在计时器中使用它，因此它将在日志中添加多次，但如果日志中的最后一项相同，我只想添加一次。

有谁知道这是怎么做到的？

谢谢你的帮助！PS。我会在早上看看这个线程，但我真的很感激我能得到的任何帮助:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T05:54:03.763

我为你做了一个例子，很容易理解。只需更改您需要的内容。您可以使用“包含函数”来获取您需要检查的项目是否存在于您的列表框控件中。

```
 Public Class Form1

'Global Variable to hold your string(text)'
Private strText As String = ""

Private Sub Form1_Load(sender As System.Object, e As System.EventArgs) Handles MyBase.Load
    Dim myArray() As String = {"Car", "Truck", "Motorcycle"}
    ListBox1.Items.AddRange(myArray)
End Sub

Private Sub Button1_Click(sender As System.Object, e As System.EventArgs) Handles Button1.Click

    'First whatever you are sending to the listbox you need to set it to a variable'
    'For example I want to see if Motorcycle exists in the listbox so I set my variable'
    strText = "Motorcycle"

    'Now lets check if this exists in our listbox!'
    If ListBox1.Items.Contains(strText) Then
        'We can even select the item that is found'
        ListBox1.SelectedItem = strText

        MsgBox("Listbox contains: " & strText) 'Or do what you want here'

    Else
        MsgBox("NO FOUND ITEM")
    End If

End Sub
End Class 
```

您可以忽略负载，因为我只是将其用于测试...也只需将此代码放在您插入数据的位置（在它插入您的列表框之前，如果它不在列表框中，请继续添加您想要的内容让我知道它对你来说是如何工作的！

谢谢！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T16:58:41.540

容器功能并不真正适合我想要的。我希望能够多次添加相同的变量/项目/字符串，并且仍然只能在记录器的行中添加一次。

因此，因为我将其用作记录器，所以我希望它自动选择一个新项目，因为我希望它“关注”最新的项目。

所以我检查了所选项目是否等于我的变量是否为假。然后我将变量添加到我的记录器/列表框中。

```
SuccessLoad = "> Successfully loaded"

    If WebBrowser1.StatusText.ToString = "Done" Then
        If Logger.SelectedItem.Equals(SuccessLoad) = False Then 'adds if not selected
            Logger.Items.Add(SuccessLoad)
            Logger.SelectedIndex = Logger.Items.Count - 1 'selects the variable
        End If
    End If 
```

# php - MYSQL PHP将ID数组与表进行比较并按顺序返回新数组

> ID：14188080
> 
> 赞同：0
> 
> 时间：2013-01-06T23:50:33.113
> 
> 标签：php, mysql

我有一个与 MYSQL 表中的 ID 相关的 JavaScript 数字数组，
例如：

```
[5,7,11,100,201,55,67] // ids 
```

我想将此数组与 MYSQL 表进行比较，按日期（或其他任意列）排序，并返回相同的 ID，但按日期排序。前任：

```
TABLE: someTable
- id column
- Date column
- ect column 
```

如何尽可能高效地按顺序返回 ID？
如果我尝试按顺序返回很多 ID，比如超过 20k，这个函数会滞后吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T23:58:15.567

```
SELECT id FROM someTable WHERE id IN (yourIdList) ORDER BY date; 
```

请注意，如果日期是创建日期并且 id 是自动递增的，则可能会“作弊”。您可以按 id 排序，这应该与按日期排序相同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-06T23:58:16.247

```
SELECT someTable.id FROM someTable WHERE someTable.id in (5,7,11,100,201,55,67) ORDER BY someTable.date 
```

您必须进行一些性能测试以查看它是否滞后。

# android - 使用 cvBlobsLib 构建 Android NDK 应用程序时出错

> ID：14188083
> 
> 赞同：2
> 
> 时间：2013-01-06T23:51:01.660
> 
> 标签：android, opencv, cvblobslib

我在我的 Android 应用程序中使用 cvBlobsLib 时遇到问题。我正在使用带有 NDK 的 Eclipse。

我已经下载了库 cvBlobsLib，使用该库的源文件创建了一个 Eclipse 项目，使用 Eclipse 成功编译并创建了文件 libcvblobslib.a

当尝试在我的项目中使用 libcvblobslib.a 文件时（再次在 Eclipse 中 - Android+NDK 项目），我收到一条错误消息：

> 所需库的存档：项目“MyProject”中的“jni/cvblobslib_headers/libcvblobslib.a”无法读取或不是有效的 ZIP 文件。

我无法弄清楚问题是什么......我将 libcvblobslib.a 文件添加到构建路径中，所有头文件以及 libcvblobslib.a 都在路径 jni/cvblobslib_headers/ 下

我可以在没有 cvBlobsLib 的情况下使用 openCV 库，所以我知道 NDK 的所有路径和配置都是正确的。

我的 android.mk 是：

```
LOCAL_PATH := $(call my-dir)
include $(CLEAR_VARS)
LOCAL_MODULE := cvBlobsLib
LOCAL_EXPORT_C_INCLUDES := $(LOCAL_PATH)/cvblobslib_headers/
LOCAL_SRC_FILES := cvblobslib_headers/libcvblobslib.a
include $(PREBUILT_STATIC_LIBRARY)

include $(CLEAR_VARS)
include ../../sdk/native/jni/OpenCV.mk
LOCAL_MODULE    := native_sample
LOCAL_SRC_FILES := jni_part.cpp 
LOCAL_STATIC_LIBRARIES = cvBlobsLib
LOCAL_LDLIBS +=  -llog -ldl
include $(BUILD_SHARED_LIBRARY) 
```

我的 Application.mk 是：

```
APP_STL := gnustl_static
APP_CPPFLAGS := -frtti -fexceptions
APP_ABI := armeabi-v7a x86
APP_PLATFORM := android-11 
```

请帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T22:44:38.403

好的，我找到了一个部分解决方案，但它不使用静态库方式。相反，我将源文件复制到我的项目中并将它们编译为共享库。

编译现在需要一些时间，但至少它现在可以工作......

如果有人知道如何静态地做到这一点，我会很高兴知道我错过了什么......

# php - 使用日期来确定 *Newly Posted* 状态何时到期

> ID：14188091
> 
> 赞同：1
> 
> 时间：2013-01-06T23:52:30.987
> 
> 标签：php, css

我有一个漫画网站[http://www.hittingtreeswithsticks.com/](http://www.hittingtreeswithsticks.com/)，每周都会添加新漫画。我希望新发布的漫画在发布日期后 3 天之前保持突出显示。

所以，这是之前的：

![在此处输入图像描述](../Images/8e4fe36123fa63f61f1909973b506ef8.png)

这是所需的：

![在此处输入图像描述](../Images/38a0b1858876232a51079e1049d9df3f.png)

我正在考虑以下逻辑：

数据库中的日期当前设置为日期时间：0000-00-00 00:00:00

**PHP：**使用 date = $row['date'] url 参数获取漫画的日期：

```
 echo '<ul>';
            $imageCounter = 0;
            while ($imageCounter < $imagesPerPage && ($row = $catResult->fetch_assoc())) {                  
                echo '<li>';
                    echo    '<span class="comics"><a href=".?action=viewimage&site='.$site. '&id=' . $row['id'] .'">
                            <img src="./scripts/thumber.php?date='. $row['date'] . '&img=.' . $thumbpath.$row['thumb'] . '&mw=220&mh=220"/></a> 
                            <br /><br /> ' . $row['description'] . '</span>';                               
                echo '</li>';
                $imageCounter++;
            }
    echo '</ul>'; 
```

然后将 datetime 设置为该日期...

```
$datetime1 = date_create($_GET['date']); 
```

现在，我想以某种方式设置`datetime2 = (datetime1 + 3 days)`...

然后比较...

```
if ($datetime1 < $datetime2) {
   set "comics" span class in CSS file to something else that would somehow highlight the newest post...
}
else {
   set "comics" span class in CSS file to default
} 
```

有没有更简单的方法来完成我想要做的事情？

编辑 - - - - - - - - - - - - - - - -

我现在正在尝试在 3 天内突出显示最新的漫画......不幸的是，如果满足条件，我正在努力弄清楚如何突出显示最新的漫画而不是所有的漫画。

```
 //GET date  
        $desc = (isset($_GET['description']) ? ($_GET['description']) : null);  

    $row = $catResult->fetch_assoc();

    $current_date = new DateTime;
    echo "Current Date: " . $current_date->format('Y-m-d H:i:s');

    echo "<br />";

    $comic_date = new DateTime($row['date']);
    echo "Comic Date: " . $comic_date->format('Y-m-d H:i:s');

    $comic_date->modify('3 day');

    //DISPLAY IMAGES TO CORRECT PAGE FROM DATABASE  
    echo '<ul>';
        $imageCounter = 0;
        while (($row['date'] < $current_date) && ($imageCounter < $imagesPerPage) && ($row = $catResult->fetch_assoc())) {
                echo '<li>';                
                    echo    '<span class="comics"><a href=".?action=viewimage&site='.$site. '&id=' . $row['id'] .'">
                                <img src="./scripts/thumber.php?img=.' . $thumbpath.$row['thumb'] . '&mw=220&mh=220"/></a> 
                                <br /><br /> ' . $row['description'] . $row['date'] . '</span>';                                
                    $imageCounter++;
                echo '</li>';

            }   

        if ($row['date'] >= $current_date) {
                echo '<li>';                
                    echo    '<span class="newcomics"><a href=".?action=viewimage&site='.$site. '&id=' . $row['id'] .'">
                                <img src="./scripts/thumber.php?img=.' . $thumbpath.$row['thumb'] . '&mw=220&mh=220"/></a> 
                                <br /><br /> ' . $row['description'] . $row['date'] . '</span>';                                
                    $imageCounter++;
                echo '</li>';
            }
    echo '</ul>'; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T00:02:12.490

“现在，我想以某种方式设置 datetime2 = (datetime1 + 3 days)...”

用于`strtotime()`将日期转换为秒。然后你可以随心所欲地玩它。

例如：

```
$expiry_date = strtotime($time_stamp) + 259200; // 259200 = 3 days in seconds 
```

然后像这样检查日期：

```
if($expiry_date < date("Y-m-d", time()) { 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T00:09:38.397

[将日期与DateTime](http://php.net/manual/en/book.datetime.php)进行比较非常容易。

示例如何修改和比较日期：

```
# PHP >= 5.4
$row['date'] = '2013-01-03 16:15:14';
$d = (new DateTime($row['date']))->modify('3 day');
echo $d >= (new DateTime) ? 'NEW' : 'OLD';

# PHP < 5.4
$row['date'] = '2013-01-03 16:15:14';
$n = new DateTime;
$d = new DateTime($row['date']);
$d->modify('3 day');
echo $d >= $n ? 'NEW' : 'OLD'; 
```

# 或者

您可以使用 sql 语句执行此操作：

```
SELECT
    t.*,
    t.date >= DATE_SUB(NOW(), INTERVAL 3 DAY) AS is_new
FROM 
    someTable AS t 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-07T00:22:58.883

为了完整起见，我想指出，也可以在 SQL 查询中执行此操作，例如：

```
SELECT *, (date >= DATE_SUB(NOW(), INTERVAL 3 DAY)) AS is_new
FROM comics
ORDER BY date DESC 
```

（[关于 SQLize 的演示](http://www.sqlize.com/50He0c1D2y)）

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-07T00:01:53.017

一个快速的解决方案是将发布的日期保存在数据库上，然后使用一些 javascript 代码将计算全部移动到客户端。您可以通过设置类似 data-posted="...." 的属性将发布日期公开给 javascritpt 客户端。

# android - 如何将 int 数组传递到 Android OpenGL 片段着色器

> ID：14188098
> 
> 赞同：3
> 
> 时间：2013-01-06T23:53:52.333
> 
> 标签：android, opengl-es, shader

一般来说，我对 OpenGl 和着色器都很陌生。我想在片段着色器中使用我的 java 代码中的静态 int 数组来操纵相机的颜色。有没有办法将我的 int 数组传递给着色器，或者只是让着色器能够以某种方式访问​​我的数组？

谢谢，迈克

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-07T07:52:15.663

在着色器代码中使用所谓的静态数组的正确方法是将其作为 Uniform 传递：

[http://www.opengl.org/wiki/GLAPI/glUniform](http://www.opengl.org/wiki/GLAPI/glUniform)

在您的着色器代码中，您指定需要一个外部数组：

```
uniform int colors[3]; // Specify an array of 3 integers 
```

在你的java代码中使用这个：

```
int array[3] = {0, 1, 2};
int location = GLES20.glGetUniformLocation(program_id, "colors");
GLES20.glUniform1iv(location,
              3,
              array,
              0); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-07T00:54:44.540

由于您正在尝试操纵相机的颜色，我假设您正在尝试将一个小数组传递给片段着色器（可能是 3 或 4 个整数）。

因为所有片段可能只有一个颜色相同的相机，所以传递数据的最简单方法是使用**统一**的. 在您的片段中声明一个制服：

```
uniform vec4 cameraColor; 
```

然后在您的 Java 代码中，获取制服的位置并将数据传递给它（这是 C++ 代码，Java 代码可能有点不同）：

```
GLint uniColorLocation = glGetUniformLocation( shaderProgram, "cameraColor" );
glUniform4i( uniColorLocation, array[0], array[1], array[2], array[3] ); 
```

如果您想将许多颜色传递给片段着色器，您可以使用片段**属性**(ins) 来传递数据。在 Java 代码中，您将使用诸如`glVertexAttribPointer`和之类的调用`glBufferData`来实现此目的。另一种选择是使用**纹理数据**将信息传递给着色器。在这里，单个纹素可以对应一个对象的相机颜色。

# ruby-on-rails - Facebook 使用考拉

> ID：14188102
> 
> 赞同：0
> 
> 时间：2013-01-06T23:54:31.823
> 
> 标签：ruby-on-rails, ruby, hash

我正在尝试使用 Ruby on Rails 和 Facebook。我是 Rails 的新手，我一直很难理解 StackOverflow 上已经存在的许多其他答案。

您可以在这里查看我的模型 user.rb：http: [//pastebin.com/nckSsKWM](http://pastebin.com/nckSsKWM)和我的视图 index.html.erb 在这里： http: [//pastebin.com/8UXGN8Ri](http://pastebin.com/8UXGN8Ri)

到目前为止，我所做的是将 Facebook 返回的哈希打印到我的视图中。我可以让它打印出我所有用户的“朋友”的所有数据 - 但它会以散列形式打印：

```
Number of friends: 2

App Friends: 

[
    {
        "uid"=>100004995550096,
        "username"=>"",
        "is_app_user"=>true
    }, 
    {
        "uid"=>100005005780053,
        "username"=>"",
        "is_app_user"=>true
    }
] 
```

两个问题：

1.  它正在打印这个“测试帐户”的两个 Facebook 朋友的数据。我一直试图让它只打印也在使用该应用程序的朋友的数据 - 在这种情况下，它只是两个朋友之一。
2.  其次，它返回整个数据散列。如果我只想打印出用户名、uid 或个人资料图片，我该怎么做呢？

根据我目前的经验，我想遍历哈希，使用一个`each`块，如果我错了，请纠正我，然后我希望它打印出它们已经连接到的所有 uid 的 uid“值”例如我的应用程序。我试图编写自己的块，需要不同的键，但我被卡住了。似乎没有什么能像我期望的那样工作。

我怎样才能遍历一个哈希，并让返回值成为某些值，甚至可能使用条件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T01:15:19.090

我相信您的原始哈希有点不正确，因为这两个朋友都是应用程序用户。我假设你原来的哈希是

```
friends = [
    {
        "uid"=>100004995550096,
        "username"=>"",
        "is_app_user"=>true
    }, 
    {
        "uid"=>100005005780053,
        "username"=>"",
        "is_app_user"=>false
    }
] 
```

您可以采取两种不同的方法。

1.  更容易阅读但有点慢（需要两次迭代）。

> 朋友。选择 {|f| f["is_app_user"] }.map {|f| f["uid"]}

**解释：**

Select 方法将数组过滤为仅匹配谓词（条件）的朋友。完整的谓词是 f["is_app_user"] == true 但我在这里使用了快捷方式。最后，它返回与谓词匹配的新项目数组。Map 方法执行投影以仅在已过滤的朋友数组上过滤我们感兴趣的字段。

1.  阅读速度更快，但可能更难理解，特别是如果您是 Ruby 新手。

```
friends.inject([]) do |app_friends,friend| 
  app_friends << friend["uid"] if friend["is_app_user"]
  app_friends
end 
```

**解释：**

Inject 是一种非常强大的方法，但有时会让人难以理解。空数组是 app_friends 变量的初始值。注入的工作方式是将初始值传递给您（在我们的例子中为 app_friends），并期望您对其执行操作并从块中返回新值以进行下一次迭代。如果我们没有执行任何操作，这里的问题仍然需要返回值，这就是我们最后有 app_friends 的原因。

这两种方法都只过滤应用用户和这些用户的输出 uid。根据我的假设，输出将是

> => [100004995550096]

# android - Android中的数量字符串资源：英文和俄文的区别

> ID：14188106
> 
> 赞同：0
> 
> 时间：2013-01-06T23:54:58.470
> 
> 标签：android, localization, android-resources

**当我在 Android 中使用数量字符串资源时，它对英语很容易并且按预期工作：**

```
String output = getResources().getQuantityString(R.plurals.my_resource, i, i); 
```

对于`1`，这将返回数量中定义的字符串，例如`one`对于`2`to `70`，它返回数量字符串。`other`

**但是当我使用与俄语`Locale`集相同的代码时，输​​出是不同的：**

它`one`不仅将数量字符串用于 input `1`，还用于以“1”结尾的所有数字的 inputs `21`, `31`, `41`, - 。`51`为什么？这是有意的（甚至是正确的）行为吗？我只能说，对我来说，这看起来很奇怪。好吧，当我让谷歌翻译字符串`30 dogs`时，`31 dogs`-`32 dogs`名词的输出总是相同的。

顺便说一句，我已经看到立陶宛语的类似行为。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T00:23:20.820

行为是正确的。

在俄语中，当你数数时，同一个词有多种形式：

“дерево”在英语中是一棵“树”。但是这个词改变它的后缀取决于计数

```
 1 деревО
    2 деревА
    3 деревА
    4 деревА
    5 деревЬЕВ
    6 деревЬЕВ
    7 деревЬЕВ
    ...
    21 дерево
    22 деревА
    23 деревА
    24 деревА
    25 деревЬЕВ
    26 деревЬЕВ
    ...
    31 дерево
    32 деревА
    33 деревА
    34 деревА
    35 деревЬЕВ
    36 деревЬЕВ

and so on 
```

不包括 11、12、13、14。

我不确定下一个例子是否好，但你可以把它当作不是“一个”，而是“第一个”。例如在英语中我们说 21 - “二十一”，但不是“二十一”，“二十二”，但不是“二十二”。不包括 11、12、13、14 （我们不说“十第一”或“十第一”之类的。只是十一）

[http://www.russianlessons.net/lessons/lesson11_main.php](http://www.russianlessons.net/lessons/lesson11_main.php)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T00:07:32.453

> 这是有意的（甚至是正确的）行为吗？

我不会说俄语，但快速搜索表明[这是正确的](http://en.wikibooks.org/wiki/Russian/Grammar/Genitive_case#Counting)：

> ## 数数
> 
> 当表示你有多少东西时，我们通常将所讨论的对象放在所有格中。但是，俄语与英语有一些关键区别：
> 
> *   如果某物有 1、21、31、41 等，它们以主格单数形式出现。
> *   如果某物有 2、3、4、22、23、24、32、33、34 等，请使用单数属格。
> *   如果有 5 到 19、25 到 29、35 到 39 等等，或者别的什么，使用属格复数。

# javascript - 为什么这个 JavaScript 正则表达式很慢？

> ID：14188107
> 
> 赞同：6
> 
> 时间：2013-01-06T23:54:59.793
> 
> 标签：javascript, regex

```
var email = '[John Smith] <johnsmith@gmail.com>';

var re1 = /.*<+(.*)+>.*/;
var re2 = /.*\[+(.*)+\].*/;

var address = email.replace(re1, "$1");
var name = email.replace(re2, "$1"); 
```

我发现第二个正则表达式（获取名称）运行速度非常慢。但第一个很好。为什么会这样，有没有更好的方法来获取我需要的字符串？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-07T00:14:28.740

你的正则表达式很慢的原因是因为它们*写得很糟糕*。

现在，让我们继续说他们为什么不好。

您的第一个表达式有*一堆*不必要的标记。例如领先和落后`.*`- 它们没有区别。其次，您已经量化了`<`0 到 inf 的时间。为什么？你想匹配`<<<<<<<<email>`吗？还是`email>`？最后，您已经量化了一个重复组。这太可怕了，因为

1.  量化的捕获组将覆盖自身
2.  由于上面的陈述，使用捕获组没有意义，因此它使用了不必要的资源。

好吧，这是第一个表达。第二个更糟糕，即使你刚刚切换`<>`到`[]`. 为什么你可能会问？我会告诉你为什么。**因为它不匹配**。你可能会问，为什么情况如此糟糕？因为它会产生我们所说的*灾难性回溯*。你可能想知道为什么它会这样做？我会告诉你为什么：

`.*`会尽量匹配。实际上，起初它会消耗整个字符串。显然这失败了，所以它回溯了很多次，直到它可以匹配第一个`[`. 太棒了，现在引擎已经在字符串的第一个位置找到了一个匹配的字面量`[`（从而使`.*`匹配什么都没有）。现在下一个令牌，`.*`由于其贪婪的性质，将再次匹配所有内容。这不起作用，因此引擎回溯。它将继续尝试这样做，直到它与字符串匹配。问题是，它永远不会。因为您的贪婪量词被一个需要1个或多个匹配的量化组包围。

现在，你如何解决这个问题？好吧，您可以简单地`+`从组后面删除。那会解决它。您的正则表达式仍然很糟糕，但它们不会导致引擎回溯一百万次。我们如何才能进一步改进它？通过使用否定字符类。

`/\[([^]]+)\] <([^>]+)>/`

在此处查看正则表达式的演示：[http ://regex101.com/r/wS2jN0](http://regex101.com/r/wS2jN0)

如果您使用 regex101.com 开始，您会立即注意到回溯问题：[http ://regex101.com/r/vB8xB0](http://regex101.com/r/vB8xB0)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-06T23:59:34.173

不确定您的性能问题（如果有），但您可以使用单个正则表达式来提取两个值：

```
var str = '[John Smith] <johnsmith@gmail.com>',
    re = /\[(.+)\] <(.+)>/,
    name = str.match( re )[1],
    email = str.match( re )[2];

console.log( name, email ); //=> "John Smith johnsmith@gmail.com" 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-07T00:25:56.770

这是由于使用了许多贪婪`.*`的 s 以及字符串具有形式的事实`"[..] <..>"`。

每次不使用 时`.*`，`?`RegExp 引擎都会选择整个字符串的其余部分，然后一次向后移动一个字符，因为 RegExp 的以下部分失败，测试下一部分。

当您重复`.*`s 时，这意味着您告诉它从 RegExp 引擎必须回溯的字符串末尾开始对每个字符运行成倍增加的测试。`+`然后贪婪的迹象使情况变得更糟，再次重复`*`正在做的事情。

在这里添加`?`s 并不是最好的解决方法，因为您对字符串有更多了解，而且您并没有在其中寻找那么多。因此，为了让它不那么*“坏”*，做一些事情，比如只匹配你感兴趣的位

```
var re1 = /\<([^>]*)>/,
    re2 = /\[([^\]]*)\]/;

var address = email.match(re1)[1],
    uname = email.match(re2)[1]; // to avoid `window.name` conflict 
```

# python - 在 Python 中使用 round() 舍入一个总和

> ID：14188108
> 
> 赞同：0
> 
> 时间：2013-01-06T23:55:19.317
> 
> 标签：python

我对 Python2.7 非常陌生（就像第 1 天一样），我正在尝试编写一个简单的密耳到度数转换程序作为学习练习。程序要求用户选择将度数转换为密耳，反之亦然，然后询问一个值。它相应地除以或相乘并打印转换后的答案。这就是问题出现的地方。转换后的答案不应作为精确的浮点数返回。例如 - 如果用户输入 6400 密耳，我希望程序返回 360 度（1 度 = 17.78 密耳），而不是 359.955 度。我对 round 函数的（有限）理解是它接受浮点数和精度级别，但不接受变量。如何将总和传递给round()？

非常感谢您的意见。

```
import sys
import math

def menu():

    print ""
    print " Mils / Degrees Conversion Calculator"
    print "-" * 38
    print ""
    print "Options: "
    print "1\. Degrees to Mils"
    print ""
    print "2\. Mils to Degrees"
    print ""
    print "3\. Quit"
    print "-" * 20
    print""
    return input ("Choose your option: ")
    print ""

#This function contains my attempt at rounding the sum and returns errors
def m2d(a):
    print "Enter azimuth in mils (ex. 6400)"
    b = 17.78
    c = a / b
    print a, " mils = ", c, "degrees"
    round(c[])

#This function works as intended but does not include round()
def d2m(b):
    print "Enter azimuth in degrees (ex. 90)"
    a = 17.78
    print b, " degrees = ", b * a, "mils"

loop = 1
choice = 0
while loop == 1:
    choice = menu()
    if choice == 1:
       d2m(input("Degrees: "))

    elif choice == 2:
        m2d(input("Mils: "))

    elif choice == 3:
        loop = 0 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T00:01:07.680

```
>>> round(359.955)
360.0

def m2d(a):
    print "Enter azimuth in mils (ex. 6400)"
    b = 17.78
    c = round((a / b),0) #This would round the value to zero decimal places.
    print a, " mils = ", c, "degrees"

>>> m2d(6400)
Enter azimuth in mils (ex. 6400)
6400  mils =  360.0 degrees 
```

有关 round() 的更多信息，请参阅：[http ://docs.python.org/2/library/functions.html#round](http://docs.python.org/2/library/functions.html#round)

如果您在打印时不想要小数位，您可以将替换`c`为`int(c)`.

此外，当您说 print var1,var2 时，它会自动在两者之间放置一个空格。您可能想尝试：

```
 print a, "mils =", c, "degrees" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T00:01:27.633

您可以将浮点数作为变量传递。

```
round(c, 2) 
```

会将 c 舍入到小数点后两位。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T00:03:49.270

对于第 1 天的知识，您已经很好地理解了 python 的概念。现在，可以更改代码中的某些内容以使某些输入更容易，但修改起来非常简单：

```
c = a / b
c = round(c) 
```

看起来您正在舍入变量而不更改变量本身，这就是导致问题的原因。

# c - 用“零”填充数组 -memset() 不起作用 -

> ID：14188110
> 
> 赞同：0
> 
> 时间：2013-01-06T23:55:37.403
> 
> 标签：c, arrays, memset

这是代码

```
int x, y, n, i, j, l, m, o;
printf ("podaj szerokosc planszy na jakiej chcesz zagrac\n");
scanf ("%d", &x);
printf ("podaj dlugosc planszy na jakiej chcesz zagrac\n");
scanf ("%d", &y);
int plansza [x][y];
memset(plansza, 0, sizeof plansza);
int plansza2 [x][y];
memset(plansza2, 0, sizeof plansza2);

printf("plansza: \n");
for(j=0;j<x;j++)
{
    for(l=0;l<y;l++)
    {
        printf("%d",plansza[x][y]);
        printf(" ");
    }
    printf("\n");
}

printf("plansza2: \n");
for(m=0;m<x;m++)
{
    for(o=0;o<y;o++)
    {
        printf("%d",plansza2[x][y]);
        printf(" ");
    }
    printf("\n");
} 
```

这是结果：
![结果](../Images/778dbcb76212141f62040f0e32b77787.png)

不知道为什么`memset()`根本不起作用，我完全不知道为什么。我应该怎么做才能用零填充数组？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-06T23:59:03.443

尽管它们不是实际*控制*这些循环的变量，但您在打印循环中使用`x`and作为索引。`y`

 *在第一个打印循环中，使用`j`and`l`作为控制变量，`m`在`o`第二个打印循环中使用 and。您需要使用您正在使用的任何控制变量而不是`x`和来索引数组`y`，它们是维度。

假设您输入了尺寸`5`和`7`尺寸。这为您提供了从`arr[0][0]`贯穿到`arr[4][6]`包容的元素。因为您使用*维度*来访问打印循环中的元素，所以您总是会得到`arr[5][7]`实际上在数组边界之外的元素。这可能只是给你一个远远超出数组末尾的值（并且由于索引不变，所以值*相同*），尽管从技术上讲，它是未定义的行为，所以它可以做*任何事情。*

一旦你开始使用正确的索引，我想你会发现`memset`工作正常。*

# java - GUI 如何列出服务器上的可用文件

> ID：14188112
> 
> 赞同：0
> 
> 时间：2013-01-06T23:55:38.557
> 
> 标签：java, user-interface

我正在设计一个文件共享应用程序，在应用程序客户端级别，我希望客户端能够看到服务器上所有可用的文件，你能给我一个方法，我可以使用 GUI 组件列出它们吗？我正在使用套接字编程这是我的服务器代码

服务器端

```
import java.io.*;
import java.net.*;

class TCPServer {

    public static void listfile(){

    File folder = new File("c:/");
    File[] listOfFiles = folder.listFiles();

    for (int i = 0; i < listOfFiles.length; i++) {
      if (listOfFiles[i].isFile()) {
        System.out.println("File " + listOfFiles[i].getName());
      } else if (listOfFiles[i].isDirectory()) {
        System.out.println("Directory " + listOfFiles[i].getName());
      }
    }
  }

    public static void main(String args[]) {

        listfile();

        while (true) {
            ServerSocket welcomeSocket = null;
            Socket connectionSocket = null;
            BufferedOutputStream outToClient = null;

            try {
                welcomeSocket = new ServerSocket(3248);
                connectionSocket = welcomeSocket.accept();
                outToClient = new BufferedOutputStream(connectionSocket.getOutputStream());
            } catch (IOException ex) {
                // Do exception handling
            }

            if (outToClient != null) {

                String FileName = "carexception.java";

                File myFile = new File("C:\\"+FileName);

                byte[] mybytearray = new byte[(int) myFile.length()];

                FileInputStream fis = null;

                try {
                    fis = new FileInputStream(myFile);
                } catch (FileNotFoundException ex) {
                    // Do exception handling
                }
                BufferedInputStream bis = new BufferedInputStream(fis);

                try {
                    bis.read(mybytearray, 0, mybytearray.length);
                    outToClient.write(mybytearray, 0, mybytearray.length);
                    outToClient.flush();
                    outToClient.close();
                    connectionSocket.close();

                    // File sent, exit the main method
                    return;
                } catch (IOException ex) {
                    // Do exception handling
                }
            }

        }
    }
} 
```

客户端

```
 import java.io.*;
    import java.net.*;
    import java.util.*;

    class TCPClient {

        public static void main(String args[]) {
            Scanner s = new Scanner(System.in);
            byte[] aByte = new byte[1];
            int bytesRead;

            Socket clientSocket = null;
            InputStream is = null;

            try {
                clientSocket = new Socket("127.0.0.1", 3248);
                is = clientSocket.getInputStream();
            } catch (IOException ex) {
                // Do exception handling
            }
            ByteArrayOutputStream baos = new ByteArrayOutputStream();

            if (is != null) {

                FileOutputStream fos = null;
                BufferedOutputStream bos = null;
                try {
                    fos = new FileOutputStream("E:\\sss.java");
                    bos = new BufferedOutputStream(fos);
                    bytesRead = is.read(aByte, 0, aByte.length);

                    do {
                            baos.write(aByte);
                            bytesRead = is.read(aByte);
                    } while (bytesRead != -1);

                    bos.write(baos.toByteArray());
                    bos.flush();
                    bos.close();
                    clientSocket.close();
                } catch (IOException ex) {
                    // Do exception handling
                }
            }
        }
    } 
```

我写了这段代码来投影我在服务器上可用的文件

```
 public static void listfile(){

    File folder = new File("c:/");
    File[] listOfFiles = folder.listFiles();

    for (int i = 0; i < listOfFiles.length; i++) {
      if (listOfFiles[i].isFile()) {
        System.out.println("File " + listOfFiles[i].getName());
      } else if (listOfFiles[i].isDirectory()) {
        System.out.println("Directory " + listOfFiles[i].getName());
      }
    }
  } 
```

我如何将它们投影到 J 树或 Jpanel 中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T00:10:27.953

做这个

1.  将选定文件夹中的可用文件列表发送到客户端并使用 JTable 或[JList列出这些文件](http://docs.oracle.com/javase/tutorial/uiswing/components/list.html)
2.  选择文件时，如果选择的文件是文件夹，则获取该文件夹的文件列表并再次显示
3.  如果选择的文件是文件，在客户端提示保存点位置，然后保存。

这是一个使用 swing 的[TCP 聊天程序](http://www.cise.ufl.edu/~amyles/tutorials/tcpchat/)的示例，您可以修改它以进行文件共享。

# android - Json.NET：$type 变量（使用 TypeNameHandling 时）是否需要“限定类型名称”？

> ID：14188114
> 
> 赞同：1
> 
> 时间：2013-01-06T23:56:12.163
> 
> 标签：android, json, jackson, json.net

我有一个使用 Json.NET 的 C# 服务器，而另一方面是一个使用 Jackson 的 JAVA/Android 应用程序。

我序列化和反序列化一个名为 ProtocolContainer 的对象，该对象除其他外包含一个名为“SubPacket”的属性：

```
public class ProtocolContainer
{
    public DataPacket SubPacket { get; set; }
    // ...
} 
```

有许多类继承了“DataPacket”，因此当我从任何地方收到 JSON 字符串时，我需要能够将 SubPacket 反序列化为正确的子类。

这在我切换到 Json.NET 之前运行良好（当我使用 DataContractJsonSerializer 时），但在切换之后我还没有真正能够反序列化来自 Android 设备的数据。

我怀疑这与我没有从 JAVA 发送“限定类型名称”这一事实有关，我也不想这样做。可以发送名称，例如：

"$type":"my.namespace.classname"

但是发送所有与 .NET 相关的臃肿的“合格类型名称”是不行的。

现在我得到一个 JsonSerializationException。这是 JSON 的简化版本：

```
{
   "SubPacket":{
      "$type":"my.namespace.myClass",
      "HardwareId":"a5af9321038c38dc"
   },
} 
```

即使该类存在于 .NET 端，它也无法对其进行反序列化，并出现以下错误：

> {Newtonsoft.Json.JsonSerializationException：JSON 'my.namespace.myClass' 中指定的类型未解析。路径“SubPacket.$type”，第 1 行，位置 138。在 ...

如前所述，我不想写出整个汇编字符串，这对于硬编码到 JAVA 应用程序来说既长又奇怪。

感谢您的任何提示和指示=）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T11:41:55.350

您可以使用自定义转换器并像这样覆盖 ReadJson 方法：

```
public override object ReadJson(JsonReader reader, Type objectType, ob
{
    TypedObject toReturn = null;

    if (reader.TokenType == JsonToken.StartObject)
    {
        var obj = JObject.Load(reader);
        var json = obj.ToString();
        string readType = obj["type"].ToString();

        switch (readType)
        {
            case "aClass":
                toReturn = JsonConvert.DeserializeObject<AClass>(json);
                break;
            case "my.namespace.myClass";
                toReturn = JsonConvert.DeserializeObject<MyClass>(json);
                break;
        }
      }
  return toReturn;

} 
```

问候

# xml - 从 xml 的根元素中删除特定的 xmlns

> ID：14188119
> 
> 赞同：4
> 
> 时间：2013-01-06T23:57:34.393
> 
> 标签：xml, xslt, xml-namespaces

我正在尝试对 XML 文档进行转换，但我找不到解决方案，因为我不知道 XSLT。我有 XML 文档：

```
<?xml version="1.0" encoding="UTF-8"?>
<addresses xmlns="http://www.test.org/xml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:noNamespaceSchemaLocation='http://whatever/test.xsd'>

  <address>
    <name>Joe Tester</name>
    <street>Baker street 5</street>
  </address>

</addresses> 
```

我想制作：

```
<?xml version="1.0" encoding="UTF-8"?>
<addresses xmlns="http://www.test.org/xml">

  <address>
    <name>Joe Tester</name>
    <street>Baker street 5</street>
  </address>

</addresses> 
```

（考虑到 xsi:noNamespaceSchemaLocation="..." 在此之前已经排除了使用另一个 XSLT）。

有人可以帮我找到解决方案吗？

用于消除 xsi:noNamespaceSchemaLocation 的 XSLT 是：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
>

<xsl:output omit-xml-declaration="yes" indent="yes"/>
<xsl:strip-space elements="*"/>

<xsl:template match="@* | node()">
 <xsl:copy>
  <xsl:apply-templates select="@* | node()" />
 </xsl:copy>
</xsl:template>

<xsl:template match="@xsi:noNamespaceSchemaLocation"/>

</xsl:stylesheet> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T08:29:00.040

我有两个选择：

XSLT1：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="xml" indent="yes"/>
  <xsl:template match="node()|@*">
    <xsl:copy>
      <xsl:apply-templates select="node()|@*"/>
    </xsl:copy>
  </xsl:template>
  <xsl:template match="@*[local-name(.)='noNamespaceSchemaLocation']"/>
</xsl:stylesheet> 
```

输出1：

```
<?xml version="1.0" encoding="utf-8"?>
<addresses xmlns="http://www.test.org/xml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <address>
    <name>Joe Tester</name>
    <street>Baker street 5</street>
  </address>
</addresses> 
```

XSLT2：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="xml" indent="yes"/>

  <xsl:template match="*">
    <xsl:element name="{local-name(.)}">
      <xsl:apply-templates select="@* | node()"/>
    </xsl:element>
  </xsl:template>
  <xsl:template match="@*">
    <xsl:attribute name="{local-name(.)}">
      <xsl:value-of select="."/>
    </xsl:attribute>
  </xsl:template>

  <xsl:template match="@*[local-name(.)='noNamespaceSchemaLocation']"/>
</xsl:stylesheet> 
```

输出2：

```
<?xml version="1.0" encoding="utf-8"?>
<addresses>
  <address>
    <name>Joe Tester</name>
    <street>Baker street 5</street>
  </address>
</addresses> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T01:05:11.923

请试一试：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" exclude-result-prefixes="xsi"
>

  <xsl:output omit-xml-declaration="yes" indent="yes"/>
  <xsl:strip-space elements="*"/>

  <xsl:template match="@* | node()">
    <xsl:copy>
      <xsl:apply-templates select="@* | node()" />
    </xsl:copy>
  </xsl:template>

  <xsl:template match="*">
    <xsl:element name="{name()}" namespace="{namespace-uri()}">
      <xsl:copy-of select="namespace::*[not(. = 'http://www.w3.org/2001/XMLSchema-instance')]" />
      <xsl:apply-templates select="@*|node()"/>
    </xsl:element>
  </xsl:template>

  <xsl:template match="@xsi:noNamespaceSchemaLocation"/>

</xsl:stylesheet> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T09:12:11.573

您的问题是，在复制元素节点时`<xsl:copy>`，会隐式复制文档中该点范围内的命名空间节点。尝试为元素节点添加一个额外的模板以专门排除`xsi`命名空间：

```
<xsl:template match="*">
  <xsl:element name="{name()}" namespace="{namespace-uri()}">
    <xsl:copy-of select="namespace::*[not(name() = 'xsi')]" />
    <xsl:apply-templates select="@*|node()"/>
  </xsl:element>
</xsl:template> 
```

如果您`xsl:stylesheet`有，`xmlns:xsi`那么您可能还会发现您需要按照[此答案](https://stackoverflow.com/a/14188547/592139)`exclude-result-prefixes="xsi"`中的建议添加。

这应该可以防止 xsi 命名空间出现在输出中，如果它*只是*因为它是从输入中复制而来的，尽管如果需要使输出格式正确（即，如果它需要输出一个元素或该命名空间中的属性）。

# php - 具有整数和字符串键的计数数组

> ID：14188127
> 
> 赞同：1
> 
> 时间：2013-01-06T23:58:46.500
> 
> 标签：php

```
echo count(array("1" => "A", 1 => "B", "C", 2 => "D")); 
```

这会输出 2。我玩过它，并注意到当用作数组中的键时，PHP 识别字符串数字和整数时相同。似乎整数优先。此外，当我对数组进行 var_dump 时，仅显示包含值“B”和“D”的元素。我明白为什么没有显示“A”，但为什么 var_dump 中没有“C”？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-07T00:01:40.323

您的阵列基本上是按如下方式构建的：

```
Key "1" is an integer-like string, treat as integer 1
Assign "A" to key 1
Assign "B" to key 1 (overwrite "A")
No explicit key, take greatest key so far and add 1 = 2
Assign "C" to key 2
Assign "D" to key 2 (overwrite "C") 
```

因此，您得到的数组是`array(1=>"B",2=>"D");`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T00:07:01.300

似乎您不能将关联数组和非关联数组混合在一起。如果您`C`像对其他所有内容一样添加索引，它会按预期工作。至于字符串，如果它们是有效的整数，那么它将被转换为 int [arrays](http://php.net/manual/en/language.types.array.php)。

```
$arr = array("0" => "A", 1 => "B", 2 => "C", 3 => "D");
// However, if you do:
$array = array(
    "0" => "A",
    1   => "B",
    "2" => array(1, 2, 3)
); 
```

它的出现就像你期望的那样`var_dump array(3) { [0]=> string(1) "A" [1]=> string(1) "B" [2]=> array(3) { [0]=> int(1) [1]=> int(2) [2]=> int(3) } }`

# mysql - 从多对多关系中选择所有记录加上最早日期

> ID：14188131
> 
> 赞同：0
> 
> 时间：2013-01-06T23:59:12.140
> 
> 标签：mysql, many-to-many

我在 mysql 数据库中有两个表，其中包含远足和峰值：

```
hikes: HikeID, Date, Name, Route, ...
peaks: PeakID, Name, Altitude, ... 
```

两者都通过一个名为“hp_links”的表以多对多的关系链接。我想要得到的是所有山峰的列表，以及每个山峰的最早攀登日期。

我想出了以下内容：

```
SELECT peaks.PeakID, peaks.Name, MIN(hikes.Date) AS FirstClimbed
FROM peaks
INNER JOIN hp_links ON peaks.PeakID = hp_links.PeakID
INNER JOIN hikes ON hp_links.HikeID = hikes.HikeID
GROUP BY peaks.PeakID 
```

它确实有效，但它不包括在链接表中没有任何条目的山峰（即尚未攀登）。我将第一个 INNER JOIN（到 'hp_links'）更改为 LEFT JOIN，但这似乎没有任何区别。然后，我将第二个 INNER JOIN（“远足”）更改为 RIGHT JOIN。这有所不同，因为我得到了一个额外的记录，其中包含 peaks.PeakID = NULL、peaks.Name = NULL 和 FirstClimbed = 徒步旅行的日期，但无论如何都没有连接任何山峰。

有谁知道这个问题的解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T01:10:08.093

我认为两个连接都应该是左连接。否则，第二个内部连接将不包括没有 hp_links 的峰。

# c - 解释一下这个函数定义：function(struct net * const *pnet)

> ID：14188134
> 
> 赞同：0
> 
> 时间：2013-01-06T23:59:58.367
> 
> 标签：c, linux-kernel

我正在浏览 linux 内核源代码并找到了这个函数定义。

```
function(struct net * const *pnet) 
```

有人可以解释这是什么意思。它是 net* 或 net** 还是 const net* 或 const net**？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-07T00:01:04.077

pnet 是指向 const 指向 struct net 的指针（在这种情况下，您只需从右到左从变量名称到类型名称读取，读取`*`为“指针”）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-07T00:14:46.057

换句话说：一个（非常量）指针，指向一个指向（非常量）结构的常量指针数组。

因此，您可以分配一个不同的数组：

```
pnet = myArrayOfStructs; 
```

或者你可以改变一个结构：

```
pnet[k]->proc_inum = 17; 
```

但你不能改变一个完整的结构：

```
pnet[k] = &pnet[k+1]; // compiler error 
```

# windows-runtime - Windows 运行时是否提供 ECDH？

> ID：14188138
> 
> 赞同：2
> 
> 时间：2013-01-07T00:00:55.587
> 
> 标签：windows-runtime, windows-store-apps

除了使用证书（Windows.Security.Cryptography.Certificates.KeyAlgorithmNames）之外，我在 Windows 运行时中找不到任何 ECDH（椭圆曲线 Diffie-Hellman 算法）的实现。真的没有 .NET 的 ECDiffieHellmanCng 类的等价物吗？我们可以用什么来安全地交换密钥？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-14T20:14:33.813

我相信您可以将[AsymmetricKeyAlgorithmProvider](http://msdn.microsoft.com/en-US/library/windows/apps/windows.security.cryptography.core.asymmetrickeyalgorithmprovider)与此处的任何内容一起使用[AsymmetricAlgorithmNames](http://msdn.microsoft.com/en-US/library/windows/apps/windows.security.cryptography.core.asymmetricalgorithmnames)

除了一些 3rd 方库之外，您似乎没有其他使用 WinRT 的选项。如果该算法是必须的，您可以考虑替代方案，例如 openssl。[在这里](http://forum.xda-developers.com/showthread.php?t=2113595)，有些人似乎成功地为 WinRT 平台构建了 openssl。希望这可以帮助。

# objective-c - SKPSMTPMessage 通过 GMAIL 作为 MMS 发送消息未送达

> ID：14188148
> 
> 赞同：3
> 
> 时间：2013-01-07T00:01:45.463
> 
> 标签：objective-c, xcode, smtpclient, mms

我正在使用 SKPSMTPMessage 从我们的应用程序发送电子邮件。这使我们可以在电子邮件中附加图片并自动发送该图片，而无需用户点击发送按钮。这非常适合将图像发送到电子邮件帐户。但是，我刚刚尝试通过 Verizon 将图像发送到我的手机，并通过 ATT 将图像发送到我的同事手机，两者都作为 MMS 消息使用这些格式 123456789@vzwpix.com 和 1234567890@mms.att.com。疯狂的是，这些消息显示在我的 gmail 发送项目中，但从未作为彩信发送到手机。但是，如果我登录到 gmail 并将完全相同的消息转发到 123456789@vzwpix.com，则消息会顺利传递。图像大小也只有 42KB 左右。

我对此感到非常困惑，我想知道我是否没有以 gmail 可以理解的方式格式化消息，因此 gmail 无法正确地将消息传递到电话。这是我用来撰写电子邮件的代码

```
 SKPSMTPMessage *testMsg = [[SKPSMTPMessage alloc] init];
    testMsg.fromEmail = [[NSUserDefaults standardUserDefaults] stringForKey:[NSString stringWithFormat:@"%@emUsername_key", preset]];
    testMsg.toEmail = [[NSUserDefaults standardUserDefaults] stringForKey:[NSString stringWithFormat:@"%@toEmail_key", preset]];
    testMsg.relayHost = [[NSUserDefaults standardUserDefaults] stringForKey:[NSString stringWithFormat:@"%@emailServer_key", preset]];
    testMsg.port = [[NSUserDefaults standardUserDefaults] stringForKey:[NSString stringWithFormat:@"%@emailPort_key", preset]];
    testMsg.requiresAuth = [[NSUserDefaults standardUserDefaults] boolForKey:[NSString stringWithFormat:@"%@requiresAuth_key", preset]];
    testMsg.login = [[NSUserDefaults standardUserDefaults] stringForKey:[NSString stringWithFormat:@"%@emUsername_key", preset]];
    testMsg.pass = [[NSUserDefaults standardUserDefaults] stringForKey:[NSString stringWithFormat:@"%@emPassword_key", preset]];
    testMsg.subject = [[NSUserDefaults standardUserDefaults] stringForKey:[NSString stringWithFormat:@"%@emailSubject_key", preset]];
    testMsg.wantsSecure = [[NSUserDefaults standardUserDefaults] boolForKey:[NSString stringWithFormat:@"%@secureEmail_key", preset]];

    NSNumberFormatter * f = [[NSNumberFormatter alloc] init];
    [f setNumberStyle:NSNumberFormatterDecimalStyle];
    NSNumber * customPort = [f numberFromString:testMsg.port];
    defaultPorts = [[NSArray alloc] initWithObjects:customPort, [NSNumber numberWithShort:587], [NSNumber numberWithShort:25], [NSNumber numberWithShort:465], nil];
    [f release];
    testMsg.relayPorts = defaultPorts;
    testMsg.delegate = self;
    NSString *image_path = [NSString stringWithFormat:@"%@/%@", dir, file];
    NSData *imageData1 = [NSData dataWithContentsOfFile:image_path];// sendImage is a UIImage *sendImage which contains original image and I defined it in Global.h
    NSString* theFileExt = [[file lastPathComponent] pathExtension];
    NSString *fileTitle1;
    NSString *fileTitle2 = [NSString stringWithFormat:@"attachment;\r\n\tfilename=\"%@\"", title];
    NSDictionary *vcfPart;

    if([theFileExt compare:@"png"] == NSOrderedSame){
        fileTitle1 = [NSString stringWithFormat:@"image/png;\r\n\tx-unix-mode=0644;\r\n\tname=\"%@\"", title];
    }else if([theFileExt compare:@"jpg"] == NSOrderedSame){
        fileTitle1 = [NSString stringWithFormat:@"image/jpg;\r\n\tx-unix-mode=0644;\r\n\tname=\"%@\"", title];
    }

    encodedString = nil;

    size_t outBufferEstLength = EstimateBas64EncodedDataSize([imageData1 length]) + 1;
    char *outBuffer = calloc(outBufferEstLength, sizeof(char));

    size_t outBufferLength = outBufferEstLength;
    if (Base64EncodeData([imageData1 bytes], [imageData1 length], outBuffer, &outBufferLength))
    {
        encodedString = [NSString stringWithCString:outBuffer encoding:NSASCIIStringEncoding];
    }
    else
    {
        [NSException raise:@"NSData+Base64AdditionsException" format:@"Unable to encode data!"];
    }

    free(outBuffer);

    vcfPart = [NSDictionary dictionaryWithObjectsAndKeys:fileTitle1,kSKPSMTPPartContentTypeKey,
               fileTitle2,kSKPSMTPPartContentDispositionKey,encodedString,kSKPSMTPPartMessageKey,@"base64",kSKPSMTPPartContentTransferEncodingKey,nil];
    NSString * bodyMessage = [[NSUserDefaults standardUserDefaults] stringForKey:[NSString stringWithFormat:@"%@emailSignature_key", preset]];
    NSDictionary *plainPart = [NSDictionary dictionaryWithObjectsAndKeys:@"text/plain",kSKPSMTPPartContentTypeKey,
                               bodyMessage ,kSKPSMTPPartMessageKey,@"8bit",kSKPSMTPPartContentTransferEncodingKey,nil];
    testMsg.parts = [NSArray arrayWithObjects:plainPart,vcfPart,nil];
    [testMsg send];
    [encodedString release]; 
```

这是在 gmail 上检查邮件内容时生成并显示的标题

```
Return-Path: <myACCT@gmail.com>
Received: from localhost (000.sub-000-000-000.myvzw.com. [000.000.000.000])
    by mx.google.com with ESMTPS id lotsOfStoof.0.2013.01.06.15.22.03
    (version=TLSv1/SSLv3 cipher=OTHER);
    Sun, 06 Jan 2013 15:22:05 -0800 (PST)
Message-ID: <some.stuff.here.kids@mx.google.com>
Date: Sun, 06 Jan 2013 15:22:05 -0800 (PST)
From: myACCT@gmail.com
To: 123456789@vzwpix.com
Content-Type: multipart/mixed; boundary=SKPSMTPMessage--Separator--Delimiter
Mime-Version: 1.0 (SKPSMTPMessage 1.0)
Subject: MYAPP!

--SKPSMTPMessage--Separator--Delimiter
Content-Type: text/plain
Content-Transfer-Encoding: 8bit

Sent from MYAPP. Get it on iTunes!
--SKPSMTPMessage--Separator--Delimiter
Content-Disposition: attachment;
filename="MYAPPIMAGENAME"
Content-Type: image/jpg;
x-unix-mode=0644;
name="MYAPPIMAGENAME"
Content-Transfer-Encoding: base64 
```

任何指导都会很棒。提前致谢！

编辑：我一直在搞砸这个问题，但仍然无法弄清楚是什么原因造成的。我知道gmail可以中继消息。我错过了什么？

谢谢

# python - 使用 Homebrew 在 Mac OS X 上安装 Pygame

> ID：14188150
> 
> 赞同：2
> 
> 时间：2013-01-07T00:02:09.623
> 
> 标签：python, installation, pygame

我正在按照[这些说明](http://jalada.co.uk/2011/06/17/installing-pygame-on-os-x-with-a-homebrew-python-2-7-install.html)在我的 Mac 上安装 Pygame。

但是，在执行第 6 步 ( `python config.py`) 后，我收到以下错误消息：

```
Using Darwin configuration...
Backup existing "Setup" file [Y/n]:Y
Remove old build directory (force recompile) [Y/n]:n
Hunting dependencies...
Framework SDL not found
Framework SDL_ttf not found
Framework SDL_image not found
Framework SDL_mixer not found
Framework smpeg not found
PNG     : not found
JPEG    : not found
SCRAP   : not found
PORTMIDI: not found
Framework CoreMidi found 
```

有谁知道可能会发生什么？

我的 SDL 包含文件位于`/usr/local/include/SDL`.

如何将 Python 指向正确的位置？

出于某种原因，当我发布 config.py 代码时，它会重新格式化。
它可以在源代码部分的[http://www.pygame.org/download.shtml中找到。](http://www.pygame.org/download.shtml)
我使用的是 Unix 格式。

# javascript - 获取网页的前 n 个文本字符及其样式等

> ID：14188158
> 
> 赞同：2
> 
> 时间：2013-01-07T00:02:47.797
> 
> 标签：javascript, html, css

我想获取网页的前 n 个字符并按照它们在原始文档中的显示方式显示它们。

我想`textContent`在 JavaScript 中使用来获取文本，然后以某种方式递归地获取所有没有文本的 DOM（我希望这是正确的术语）。但似乎重新组合它们将非常困难。

此外，也许有一种简单的方法可以实现这一点。那么为什么要重新发明轮子呢？

那么怎么*做*呢？（我不是要完整的代码，只是为了解决这个问题。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T00:54:03.457

以下代码删除文档中前 35 个字符之后的所有文本。它忽略不可见的文本和完全由空格组成的文本节点。[你可以在这里](http://jsfiddle.net/tjH76/)看到它的演示：

```
var limit = 35;
var current = 0;

function recurse(element) {
  if (element.childNodes.length > 0) {
    for (var i = 0; i < element.childNodes.length; i++) {
      recurse(element.childNodes[i]);
    }
  }

  if (element.nodeType == Node.TEXT_NODE && element.nodeValue.trim() != '' && window.getComputedStyle(element.parentElement).height != "auto") {
    var length = element.nodeValue.length;
    if (current < limit) {
      if(current + length > limit){
        element.nodeValue = element.nodeValue.substr(0, limit - current)
      }
      current += length;
    } else {
      element.nodeValue = "";
    }
  }
}
var html = document.getElementsByTagName('html')[0];
recurse(html); 
```

# php - GET挂在重定向上

> ID：14188172
> 
> 赞同：1
> 
> 时间：2013-01-07T00:04:26.173
> 
> 标签：php, laravel

我可以在 firebug 控制台中看到 POST 开始并完成，我看到 GET 开始，但挂起并且永远不会结束。任何人都经历过这种情况和/或知道可能是什么原因造成的？

路线：

```
Route::post('recipes/submitList', array('uses'=>'recipes@submitList'));
Route::get('results/list', array('as'=>'list', 'uses'=>'recipes@list')); 
```

控制器：

```
class Recipes extends Base_Controller{
    public function post_submitList(){
            // builds array from DB
            // etc
    return Redirect::to_route('list')
        ->with('list', $ingrs);
}
public function get_list(){
    return View::make('list')
        ->with('title', 'Your Shopping List!');
    }
} 
```

此外，如果我通过 console.log(response) 回显响应，我会从我想要重定向到的页面中获取所有 HTML。但是，在控制台中循环的 GET 没有响应，但确实有“200 OK [cycle-gif] 313ms”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T21:27:53.010

In your Get http verb, your are using 'results/list', and maybe it should be 'recipes/list'.

```
Route::get('recipes/list', array('as'=>'list', 'uses'=>'recipes@list')); 
```

# c++ - 如何在不不断分配和解除分配的情况下为多个线程制作临时数组？

> ID：14188174
> 
> 赞同：2
> 
> 时间：2013-01-07T00:04:49.130
> 
> 标签：c++, parallel-processing, openmp

我有一个功能正在尝试与 OpenMP 并行化。我有一个大`for`循环，每次迭代都独立于其他迭代，我想使用类似的东西

```
#pragma omp for private(j) 
```

并行化循环。

一个问题是循环的每次迭代都需要大量的临时工作空间，这足以让我认为如果我在每次迭代中分配和取消分配这个临时工作空间，它可能会降低性能。我的环境中有“工作区”对象，并且按原样重用旧工作区对象没有问题。

如何在创建线程之前为每个线程分配工作空间（我不知道有多少）？如何告诉每个线程从池中选择一个唯一的工作区对象？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T00:43:12.953

您可以`omp_get_max_threads()`为所有线程使用和分配足够的工作空间（例如，带有`omp_get_max_threads()`元素的工作空间数组。），然后在每个线程上使用`omp_get_thread_num()`来了解哪个线程正在运行，以便它可以获得自己的工作空间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T20:44:06.013

也许我没有抓住重点，但是以下策略对您不起作用吗？

```
void foo() {

  #pragma omp parallel
  {
    // allocate work-space here, so to make it private to the thread
    thread_workspace t;

    #pragma omp for
    for(int j = 0; j < N; j++) {
      // Each thread has its local work-space allocated outside the for loop
    }
  } // End of the parallel region

} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-07T01:05:40.797

我推荐使用对象池设计模式。 [这是](http://www.oodesign.com/object-pool-pattern.html)一个描述。您显然需要使工作区线程安全的获取和释放方法（ReusablePool 中的 3 个方法需要同步）。工作空间的数量将增长到任何时候所需的总数。回收的工作空间将被 ReusablePool 重用。

> 尽管对象池正在处理对象实例化，但它的主要目的是为客户端提供一种重用对象的方法，就像它们是新对象一样。

# javascript - 在 KineticJS 中的 stage.toDataURL() 之前裁剪阶段/图层

> ID：14188176
> 
> 赞同：0
> 
> 时间：2013-01-07T00:05:47.310
> 
> 标签：javascript, jquery, html, canvas, kineticjs

在 KineticJS 中使用`stage.toDataURL()`，可以生成 JPEG 图像。

**问题：**必须将生成的图像裁剪成较小的图像并保存到 Web 服务器上。有没有办法裁剪舞台，以便创建的数据 uri`stage.toDataURL()`是最终裁剪的图像？还是我必须在服务器端裁剪它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T02:07:33.807

您可以创建另一个将用于裁剪的屏幕外画布。然后将主画布绘制到该裁剪画布并在调用 toDataURL 之前根据需要进行裁剪。

# wordpress - wordpress - 从看起来不像 codex 的自定义主题中的帖子列表中排除类别

> ID：14188178
> 
> 赞同：0
> 
> 时间：2013-01-07T00:06:03.073
> 
> 标签：wordpress, tags, custom-taxonomy

我希望有人能帮忙。我不是 php 编码员，但无论如何我一直在为 wordpress 定制和定制一个高级主题，但我被困住了。

我试图从默认列出所有类别的页面中排除特定类别。好的，没问题。它应该是：

```
<?php query_posts($query_string . '&cat=-134'); ?> 
```

正确的？

我很确定类别编号是 134，但我可能是错的。我使用的高级主题称为 Risen，并且有很多不同类型的帖子 - 所以我认为的类别可能实际上是自定义分类法中的标签 - 在这种情况下 ???

当我将鼠标悬停在类别列表中时，我得到以下信息：

```
example.com/wp-admin/edit-tags.php?action=edit&taxonomy=risen_multimedia_category&tag_ID=134&post_type=risen_multimedia 
```

我很确定我已经找到了需要包含我的论点的地方，并且在模板中：

```
// Get posts
$multimedia_query = new WP_Query( array(
    'post_type'         => 'risen_multimedia',
    'posts_per_page'    => risen_option( 'multimedia_per_page' ) ? risen_option(  'multimedia_per_page' ) : risen_option_default( 'multimedia_per_page' ),
    'paged'             => risen_page_num() // returns/corrects $paged so pagination works on static front page
) ); 
```

我试过添加

```
'tag'   => -134 
```

对这个数组无济于事。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T01:01:54.043

作为一个优质且经过明显调整的主题，这里有很多猜测，但我认为您已经说服自己解决了这个问题，除了一个细节。`tag__not_in`不使用`tag=-134`

```
// Get posts
$multimedia_query = new WP_Query( array(
    'post_type'         => 'risen_multimedia',
    'posts_per_page'    => risen_option( 'multimedia_per_page' ) ? risen_option(  'multimedia_per_page' ) : risen_option_default( 'multimedia_per_page' ),
    'paged'             => risen_page_num() // returns/corrects $paged so pagination works on static front page
    'tag__not_in'       => array(134)
) ); 
```

`tag_id=-134`可能有效（我必须对其进行测试），但`tag`希望标签 slug 不是 ID。

> 标签（字符串） - 使用标签标签
> [http://codex.wordpress.org/Class_Reference/WP_Query#Tag_Parameters](http://codex.wordpress.org/Class_Reference/WP_Query#Tag_Parameters)

# java - JetBrain IntelliJ IDEA 如何选择 Java 启动

> ID：14188179
> 
> 赞同：5
> 
> 时间：2013-01-07T00:06:16.277
> 
> 标签：java, intellij-idea, java-8

我已经在我的 Window 7 上安装了 Java 8 EA，但它既不在我的`%JAVA_HOME%`也不在`%PATH%`. 但是，当我通过单击启动 IntelliJ IDEA v12 时`idea64.exe`，它选择了 java 8 EA 而不是我的 Java SDK 1.6.0_32，它位于`%JAVA_HOME%`and`%PATH%`中。

任何人都知道 IDEA 何时开始，它如何决定运行哪个 Java 版本？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-07T11:38:22.593

它是从注册表中挑选出来的。

从 .exe 启动时，IDEA 按以下顺序查找 Java：

1.  IDEA_JDK（或 IDEA_JDK_64）环境变量
2.  IDEA home 中的 jre/（或 jre64/）目录
3.  登记处
4.  JDK_HOME 环境变量
5.  JAVA_HOME 环境变量

从 .bat 启动时，顺序相同，但不查看注册表，并且不使用 64 后缀的变量（这可能是一个错误）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-07-29T23:54:48.823

以下是可用于所有不同操作系统的可用选项。如果你感兴趣。

[http://intellij-support.jetbrains.com/entries/23455956-Selecting-the-JDK-version-the-IDE-will-run-under](http://intellij-support.jetbrains.com/entries/23455956-Selecting-the-JDK-version-the-IDE-will-run-under)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T01:16:45.337

您可以添加一个名为 IDEA_JDK 的附加环境变量来定位您希望 Intellij 使用的特定 JDK。

# c++ - C ++ 11本地命名引用返回值（xvalue）？

> ID：14188181
> 
> 赞同：4
> 
> 时间：2013-01-07T00:06:38.053
> 
> 标签：c++, c++11

我们有以下类型`X`和功能`f`：

```
struct X { ... };

X f() { ... }; 
```

现在考虑另一个函数的三个替代定义`g`：

**(1)**

```
void g()
{
    X x = f();

    ...
} 
```

**(2)**

```
void g()
{
    X& x = f();

    ...
} 
```

**(3)**

```
void g()
{
    X&& x = f();

    ...
} 
```

三种不同情况之间定义的行为（或潜在行为）有什么区别？（假设占位符“...”代码在三种情况下是相同的）

**更新：**

如果`g`返回`X`: 以下内容是否合法且正确？

```
X g()
{
    X&& x = f();

    ...

    return move(x);
} 
```

（移动是否必要，它有什么作用吗？）

您是否希望 RVO 链接，以便下面会产生相同的代码？

```
X g()
{
    X x = f();

    ...

    return x;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-07T00:08:17.877

2是违法的。其他两个本质上是相同`x`的 - 是类型的可变左值，`X`其生命在`g()`返回时结束。

当然，严格来说，第一个调用移动构造函数（但它是某些 RVO/NRVO 动作的主要候选者）而第三个不调用，所以如果 X 是不可移动的（非常奇怪......）第三种情况是合法的，但第一种不是，第一个可能更贵。然而，编译器选项和不可移动类型的实际情况是，这几乎完全是一种技术性问题，如果你能实际演示任何这种情况，我会感到惊讶。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T22:27:49.170

表达式`f()`按值返回，因此它是*prvalue*。

1.  这将创建一个新的类型对象，该对象使用类型为纯右值`X`的表达式进行初始化。新对象的构造方式取决于它是否具有移动构造函数。如果它有一个移动构造函数（或一个接受右值的模板构造函数），它将被调用，否则如果它有一个将被调用的复制构造函数。在实践中，编译器几乎肯定会忽略构造函数调用，但适当的构造函数必须是可访问的并且不能被删除。`f()``X``X``X`

2.  这甚至无法编译，您会因为在发布前没有尝试而遭到否决！

3.  这将创建一个新的类型引用，`X&&`并通过将其绑定到返回的纯右值来初始化它`f()`。该纯右值的生命周期将延长到与引用相同的生命周期`x`。

假设移动/复制被省略，行为上的差异可能没什么，但是（1）和（3）之间的语义存在差异，因为一个为构造函数做了重载决议，这可能会失败，而另一个总是有效。

> 如果 g 返回一个 X 怎么办：以下是合法且正确的吗？

这是合法的。是不必要的`move`，有一条特殊规则说，当按值返回局部变量时，构造函数查找首先完成，就好像该变量是一个右值，所以如果`X`有一个移动构造函数，它将被使用，无论你是否使用`move(x)`. RVO 应该“连锁”。如果`g`返回`X&`，您在这两种情况下都会遇到问题，因为它将绑定到的对象将在`g`.

（注意，始终有资格`std::move`阻止 ADL 是一种很好的做法。对于. 也是如此`std::forward`。如果您的意思是调用`std::move`或`std::forward`然后是显式的，请不要依赖范围内没有重载或可见，`move`并且`forward`不是自定义点，如`swap`.）

* * *

与其通过提出关于 SO 的问题来学习 C++，不如编写代码来测试发生的事情并向自己证明呢？使用 G++，您可以使用该`-fno-elide-constructors`标志关闭构造函数省略以查看在没有省略的情况下会发生什么，并且在不使用该标志（默认）时，您可以轻松测试 RVO 是否为自己“链接”。

# javascript - 如何根据引用页面显示 div

> ID：14188182
> 
> 赞同：1
> 
> 时间：2013-01-07T00:06:48.720
> 
> 标签：javascript, css, html

我是一名业余编码员，今年我开始学习 HTML5 和 CSS3。

我目前面临一个挑战，我有一个单页 html 文件 (index.html)。在页面中有一个 html 表单，它对 php 文件有一个动作。一旦 php 文件处理了表单，它就会将用户引导回 index.html。我想做的是在我的网站顶部显示一个 div，上面写着“感谢您提交表单！”

我该怎么做呢？我假设我们会做某种“如果推荐页面是 form.php 然后显示 div”，但我不知道如何检测推荐页面。另外我不知道使用什么语言，我假设是javascript。我想远离 php，因为我不希望我的单页 html 文件变成 php 文件。

我希望这很清楚谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T00:13:36.637

由于我不知道您的页面的确切结构，我建议您使用会话和 htaccess 来允许在 html 文件中使用 php。

在处理后立即在您的 php 文件中写入以下内容：

```
@session_start();
$_SESSION['submitted_msg'] = "You have submitted a form"; 
```

在你的 html 文件中，在你希望显示消息的地方写下这个：

```
<?php if (isset($_SESSION['submitted_msg'])) { ?>
<div><?php print($_SESSION['submitted_msg']);?></div>
<?php unset($_SESSION['submitted_msg']);} ?> 
```

为此，您需要一个`.htaccess`位于项目根目录中的文件。里面有以下代码：

```
AddType application/x-httpd-php .html 
```

希望这对您有所帮助，如果您需要其他方式，请写下更多详细信息。

**更新 1：启用 Cookie 的 JavaScript 方法**

表单.php

```
<?php
  # above is form processing...
  setcookie ("submit_message", 'thanks...', time()+3600, '/');
  header("Location: index.html");
  exit;
?> 
```

索引.html

```
 <html>
<head></head>
<body>
    <script type="text/javascript">

    function readCookie(name)
    {
        var cookiename = name + "=";
        var ca = document.cookie.split(';');
        for(var i=0;i < ca.length;i++)
        {
            var c = ca[i];
            while (c.charAt(0)==' ') c = c.substring(1,c.length);
            if (c.indexOf(cookiename) == 0) return c.substring(cookiename.length,c.length);
        }
        return null;
    }

function deleteCookie( name, path, domain ) 
{

   document.cookie=name+"="+((path) ? ";path="+path:"")+((domain)?";domain="+domain:"") +
                                   ";expires=Thu, 01 Jan 1970 00:00:01 GMT";
}

    window.onload = function()
    {
        var msg = '';
        if (readCookie('submit_message') != null)
        {
            msg = readCookie('submit_message');

            deleteCookie('submit_message','/');
        }
        document.getElementById('message').innerHTML = '<div style="background:green">'+msg+'</div>';
    }
</script>

<div id="message">

</div>
</body>
</html> 
```

如果你去形成 php，它会将你重定向到 index.html 并显示消息，如果你刷新消息消失。

祝你好运。

# iphone - 从 NSURLRequest 获取 cookie 到 WebView

> ID：14188184
> 
> 赞同：0
> 
> 时间：2013-01-07T00:06:56.443
> 
> 标签：iphone, objective-c, ios5, cookies

我的程序的目标是执行以下操作：

在我的网站上执行一个 url，它会“记录”用户使用 NSURLRequest。基本上我的想法是执行请求，从响应中获取 cookie 并将 cookie 添加到 WebView。

我所知道的只是执行此过程的第一部分，代码如下：

```
NSString *fullURL = @"http://mysite.com";
NSURL *url = [NSURL URLWithString:fullURL];
NSURLRequest *requestObj = [NSURLRequest requestWithURL:url]; 
```

内容是我的 webview 的名称

```
[content loadRequest:theRequest]; 
```

接下来是解析响应。基本上检查错误（页面只输出单词'true'或'false'表示错误。我猜我可以检查这些单词的存在并采取适当的行动。当然，从响应中获取cookie并发送它“内容”。不胜感激，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T00:55:03.560

通常，URL 加载系统会自动处理与您的 NSURLRequest 一起**发送和存储**所有与 URL 相关 的**cookie 。**但是，如果您想添加额外的 cookie，则必须使用 NSMutableURLRequest。

Cookie 是请求响应标头的一部分，您可以像这样修改：

```
NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:url];
[request addValue:cookie forHTTPHeaderField:"Cookie"]; 
```

# ios - 自动布局约束：如何使视图在调整大小时保持其宽度/高度比？

> ID：14188187
> 
> 赞同：31
> 
> 时间：2013-01-07T00:07:31.050
> 
> 标签：ios, xcode, autolayout

在界面构建器中，我们可以固定高度，固定宽度，使两个视图宽度相等，但是我如何设置约束，以便在调整视图大小时，它保持其宽度/高度比？

在我的特殊情况下，我的视图控制器中有一个 UIImageView 。当视图调整大小时，我希望我的图像视图调整大小，但保持 3:2 的宽度：高度比。是否可以在 IB 中完成？有没有可能用代码做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2014-03-15T16:40:09.900

您可以通过控制从视图拖动到自身并选择纵横比来在 IB 中添加纵横比约束。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2013-01-07T00:30:50.923

我不认为你可以在 IB 中做到这一点，但在代码中，可以这样做（iv 是我对图像视图的出口）：

```
 [self.iv removeConstraints:self.iv.constraints];
    NSLayoutConstraint *con1 = [NSLayoutConstraint constraintWithItem:self.iv attribute:NSLayoutAttributeHeight relatedBy:NSLayoutRelationEqual toItem:nil attribute:NSLayoutAttributeNotAnAttribute multiplier:1  constant:100];
    NSLayoutConstraint *con2 = [NSLayoutConstraint constraintWithItem:self.iv attribute:NSLayoutAttributeHeight relatedBy:NSLayoutRelationEqual toItem:self.iv attribute:NSLayoutAttributeWidth multiplier:.66 constant:0];
    [self.iv addConstraints:@[con1,con2]]; 
```

这明确地将高度设置为 100，将宽高比设置为 3:2。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-01T18:39:50.953

Apple 的这份指南对我很有帮助——它概述了两种方法，一种是关闭某些子视图的 AutoLayout 并直接设置框架，另一种是通过代码使用纯 AutoLayout。

[https://developer.apple.com/library/ios/technotes/tn2154/_index.html](https://developer.apple.com/library/ios/technotes/tn2154/_index.html)

# c# - 在 ASP.Net 中创建一个 REST API

> ID：14188191
> 
> 赞同：0
> 
> 时间：2013-01-07T00:08:08.047
> 
> 标签：c#, asp.net, asp.net-mvc, rest, kendo-ui

我有一个在 Visual Studio 中创建的 ASP .Net Web 应用程序。[我正在按照此处](http://docs.kendoui.com/tutorials/ASP.NET/asp-net-hello-services)的 KendoUI 教程来创建 REST API。我相信我已经正确设置了它，但问题是当我导航到 URL 时它说找不到它。

这是我的控制器：

```
 public class IngredientControllers : ApiController
    {
        private Data.RecipeTrackerDataContext _context = new Data.RecipeTrackerDataContext();

        // GET api/<controller>/5
        public List<Models.Ingredient> Get()
        {
            var ingredients = from e in _context.Ingredients
                              select new Models.Ingredient
                              {
                                  Id = e.IngredientID,
                                  ItemID = e.ItemID,
                                  Amount = e.Amount
                              };

            return ingredients.ToList();
        }

        // POST api/<controller>
        public void Post([FromBody]string value)
        {
        }

        // PUT api/<controller>/5
        public void Put(int id, [FromBody]string value)
        {
        }

        // DELETE api/<controller>/5
        public void Delete(int id)
        {
        }
    }
} 
```

这是我的 Global.aspx 文件：

```
 public class Global : HttpApplication
    {
        void Application_Start(object sender, EventArgs e)
        {
            // Code that runs on application startup
            BundleConfig.RegisterBundles(BundleTable.Bundles);
            AuthConfig.RegisterOpenAuth();
            RouteTable.Routes.MapHttpRoute(
                name: "DefaultApi",
                routeTemplate: "api/{controller}/{id}",
                defaults: new { id = System.Web.Http.RouteParameter.Optional });
        }

        void Application_End(object sender, EventArgs e)
        {
            //  Code that runs on application shutdown

        }

        void Application_Error(object sender, EventArgs e)
        {
            // Code that runs when an unhandled error occurs

        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T01:52:35.513

Takepara 提供了解决方案 - 我的 cs 文件应该是 'IngredientController' 而不是 'IngredientControllers.

# javascript - 需要正则表达式进行表单验证以避免多个特殊字符

> ID：14188193
> 
> 赞同：1
> 
> 时间：2013-01-07T00:08:11.750
> 
> 标签：javascript, jquery, regex

我需要 jquery 或 javascript 正则表达式来验证表单文本框，以便如果有人输入多次相同的特殊字符，则会生成警报。

比如你好吗？？或者你好吗....或者你好吗@@??

请注意，我需要阻止“多次”使用特殊字符我不想阻止单个特殊字符。如果需要发送“你好，你好吗？” 应该继续。

谢谢，

**[更新]** 我得到了最终结果

要验证我们可以使用的所有特殊字符的表单文本框

```
/(?! )(\W)\1+/ 
```

为了验证一些特殊字符，我们可以使用

```
/([@#$%])\1+/; 
```

**在[ ]**中添加或删除特殊字符

 *** * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T00:43:41.193

在提交事件时，确保文本框中没有无效字符。`return`您可以阻止处理程序通过ing提交`false`。

HTML：

```
<input type='text' id='yourTextboxID' />
<input type='submit' id='submitButton' value='Submit' /> 
```

JS：

```
document.getElementById('submitButton').onclick = function () {
    var enteredValue = document.getElementById('yourTextboxID').value;

    if (enteredValue.test(/[!@#$%^&*()]+/)) {
        alert('Bad characters!');
        return false;
    }

    return true;
}; 
```

如果您愿意，可以在[此处](http://regexr.com?33ans)修改和测试正则表达式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T00:12:18.243

反过来试试：取输入，过滤掉所有你*想要*的字符，看看“其余”的长度是否大于或等于 2。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T00:13:56.907

假设特殊字符不是字母、数字和空格，这个正则表达式应该可以工作：

```
/(?! )(\W)\1+/ 
```**

# c# - 将 COM 对象从 C# 传递到 Visual Basic

> ID：14188196
> 
> 赞同：1
> 
> 时间：2013-01-07T00:09:19.613
> 
> 标签：c#, vb.net, com

我有一个用 C# 编写的程序，它与专有的 COM 接口交互。不幸的是，这个接口有一些不能在 C# 中正常工作的特性。但是，该界面在 Visual Basic 中运行良好。

我已经在 C# 中使用 C# 的部分接口上用 C# 编写了很多代码，所以如果可以避免的话，我真的不想在 VB 中全部重写。我想找到一种简单的方法来使用 Visual Basic 来实现我确实需要的功能，而无需重新编写我已经拥有的所有代码。所以，问题是，这样做的最佳方法是什么？

我的第一次尝试：

我希望我可以将我在 C# 中创建的 COM 对象传递给 Visual Basic，它会起作用。像这样：

C＃：

```
Type type = Type.GetTypeFromProgID("ACM Application");
acm = System.Activator.CreateInstance(type);
ACMAccess.ACMAccess acmAccess =new ACMAccess.ACMAccess(acm); 
```

VB：

```
Sub New(ByVal acm)
    Dim starVars = acm.Simulation.Flowsheet.FindMatchingVariables("~")

    For Each Var In starVars
        Console.WriteLine(Var.Name)
    Next
End Sub 
```

可悲的是，这不起作用。失败有点有趣，在调试器中它有正确的类型，但如果我调用一个方法，它什么也做不了。如果我尝试一个不存在的方法名称，我会得到一个异常，但是一个现有的方法，什么都不会发生。

第二个想法：

我能想到的替代方案是委托模式，我已经避免了一段时间。创建一个 VB 对象，该对象实际创建并执行与 COM 接口的所有交互。C# 程序的其余部分将仅通过 VB 包装器使用 COM 接口。（而不是像第一次尝试那样来回传递它。）

# r - 将目录树表示为递归列表

> ID：14188197
> 
> 赞同：9
> 
> 时间：2013-01-07T00:09:21.267
> 
> 标签：r, list, recursive-datastructures, directory-tree

我被某项任务困住了。我想要的是一个函数，给定一个目录路径，它将返回一个递归列表作为输出。

输出的形式应该是 myList$dir$subdir$subdir$fullFilePath

所以基本上我想将目录树表示为某个列表。我获取了所有文件，获取了每个文件的所有子目录，但我不知道如何将它们全部放入具有多个级别的列表中。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-07T00:54:02.947

这是使用递归的解决方案：

```
tree.list <- function(file.or.dir) {
    isdir <- file.info(file.or.dir)$isdir
    if (!isdir) {
        out <- file.or.dir
    } else {
        files <- list.files(file.or.dir, full.names   = TRUE,
                                         include.dirs = TRUE)
        out <- lapply(files, tree.list)
        names(out) <- basename(files)
    }
    out
} 
```

我在一个小目录上测试了它

```
test.dir <- tree.list("./test")
test.dir
# $a
# $a$`1.txt`
# [1] "./test/a/1.txt"
# 
# $a$aa
# $a$aa$`2.txt`
# [1] "./test/a/aa/2.txt"
# 
# $b
# $b$`3.txt`
# [1] "./test/b/3.txt" 
```

如果这对您的需求来说太慢了，我会考虑将所有文件读入一次调用中`list.files`，`recursive = TRUE`然后进行一些解析。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T00:36:56.390

这是一个丑陋的黑客。

```
mypath <- 'a/b/c/d'

makelist <- function(filepath, fsep = '/'){

  unlisted <- unlist(strsplit(filepath, fsep))

  nsubs <- length(unlisted)

  mylistcall <- paste(paste(rep('list(', nsubs), unlisted, collapse = '='), 
    '= NULL', paste(rep(')', nsubs), collapse = ''))

  mylist <- eval(parse(text = mylistcall))
  return(mylist)
  }

makelist(mypath)

$a
$a$b
$a$b$c
$a$b$c$d
NULL 
```

记住

```
fortune(106)

If the answer is parse() you should usually rethink the question.
   -- Thomas Lumley
      R-help (February 2005) 
```

然而，在这种情况下，我会说我应该重新考虑答案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-10-29T20:40:44.213

这是@flodel 使用该`purrr`包的精彩解决方案的较短变体：

```
library( purrr )
tree_list <- function( file_or_dir ) {
  f <- partial(list.files, full.names=TRUE, include.dirs=TRUE) %>%
         compose(tree_list, .)
  file_or_dir %>% set_names( basename(.) ) %>% map_if(dir.exists, f)
} 
```

第一行定义了一个`f`扩展其参数的函数，使用`list.files( ..., full.names=TRUE, include.dirs=TRUE)`then 应用于`tree_list()`扩展。

第二行将定义的函数应用于`f`原始参数中的所有目录。

# codeigniter - 在 codeigniter 中显示带有错误消息的值的页面

> ID：14188199
> 
> 赞同：0
> 
> 时间：2013-01-07T00:09:45.213
> 
> 标签：codeigniter

大家好，我让我的代码更简单只是为了显示错误消息，但现在仍然显示。

```
 public function check_profile_ifexist($id)
  {

    if($this->input->post('edit')){

    $this->form_validation->set_rules('email','Email','trim|valid_email|is_unique[user_details.email]'); 
    $this->form_validation->set_rules('username','Username','trim|min_length[6]|max_length[20]|is_unique[user_details.username]|xss_clean');                $this->form_validation->set_message('is_unique',"That %s already exists!");
    $this->form_validation->set_message('max_length', 'the maximum characters for %s is 20');
    $this->form_validation->set_message('min_length', 'the minimum characters for %s is 6');

    if ($this->form_validation->run())
    {
        $this->load->model('model_user_manage');
        $em=$this->model_user_manage->update_all($id);
    }
    else
    {

     $this->view_profile($id);  
     }

} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T04:27:20.353

与其回显所有错误，不如将它们全部存储到一个属性中：

首先启动一个空属性，以便您知道它存在 - 您可以在 check_profile_ifexist() 方法的开头执行此操作：

```
 $this->profile_errors = ''; 
```

然后在您的 check_profile_ifexist() 方法中，只需将错误添加到属性中，而不是回显它们，例如

```
if (MD5($username)==$pass){
    echo "username cannot be the same as password";
} 
```

变成：

```
if (MD5($username)==$pass){
     $this->profile_errors .= "username cannot be the same as password\n";
} 
```

然后，此属性将可用于您的所有方法，因此您可以将其添加到 view_profile() 中的数据数组中，如下所示：

```
if(isset($this->profile_errors)){
    $data['errors'] = $this->profile_errors;
}else{
    $data['errors'] = ''; 
} 
```

并且错误在您的视图中显示为 $errors，因此您可以`echo $errors;`打印出所有错误。

**注意**显然，您必须确保该属性始终存在或检查其存在以避免您自己的错误。我还在您的错误中添加了换行符，以便在批量打印多个时它们看起来更整洁。

**第二个注释**你似乎有很多东西我会在这个代码中放入一个模型，我认为它是一个控制器。您可能应该将所有数据库内容保存在模型中，否则 MVC 警察会来找您。

# sed - SED语法在两个行号之间插入一个字符串？

> ID：14188206
> 
> 赞同：1
> 
> 时间：2013-01-07T00:10:53.057
> 
> 标签：sed

例如，在文本文件 /location/file.txt 中：

```
some random text
some more random text
some more random text 
```

我想在第二行之间插入一串单词。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T00:13:39.090

2 和 3 之间的两个插入（在 之后`2`）：

```
sed '2{a\
two words
}' input 
```

在 1 和 2 之间插入（在 之前`2`）：

```
sed '2{i\
two words
}' input 
```

或者，如果您不想要换行符：

```
sed '2a\\ttwo words' input 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T04:36:26.733

使用 awk：

```
awk '{print} NR==2{print "here is some extra text after line 2"}' file 
```

如果要覆盖原始文件：

```
awk '{print} NR==2{print "here is some extra text after line 2"}' file > tmp && mv tmp file 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-07T12:39:21.363

这将在第二行和第三行之间添加一行“这里的新行”。

```
awk 'NR==3{print "new line here"}1' your_file 
```

如果你想就地使用 perl：

```
perl -pi -e 'print "new line here.\n" if($.==3)' your_file 
```

# c++ - 开始与客户沟通的好方法？

> ID：14188207
> 
> 赞同：2
> 
> 时间：2013-01-07T00:11:10.787
> 
> 标签：c++, c, tcp, network-programming

我的游戏和服务器的工作方式是这样的：

我发送以我创建的格式编码的消息。它以“p”开头，后跟消息长度的整数，然后是消息。

例如：p3m15 消息长 3 个字节。它对应于消息 15。然后解析消息，依此类推。

它是为 TCP 设计的，可能只发送 1 个字节（因为 TCP 只需要发送至少 8 位）。

我创建的这个消息协议非常轻量级并且效果很好，这就是为什么我在 JSON 或其他协议上使用它的原因。

我主要关心的是，客户端和服务器应该如何开始对话？

服务器希望客户端以我的格式发送消息。游戏将永远这样做。

我遇到的问题是当我在端口 1720 上测试我的服务器时。有 BitTorrent 流量，我的服务器正在接收它。这导致各种随机“客户端”连接到我的服务器并发送随机垃圾。

为了“解决”这个问题，我这样做是为了让客户端必须发送给我的第一件事是字符串“Hello Server”。

如果发送的第一个字节是 != 'H' 或者如果他们发送给我 > 12 个字节并且它是 != "Hello Server" 那么我立即断开它们。

这很好用。我只是想知道我做的事情是否有点天真，或者是否有更标准的方法来处理：

- 客户端开始与服务器通信 - 客户端通过 Hello Server 检查，但在某处我收到一条无效消息。我可以假设我的应用永远不会发送无效消息。如果是这样，那将是一个错误。现在，如果我检测到无效消息，那么我会断开客户端。

我注意到 BitTorrent 在每条消息之前都发送了“!!BitTorrent 协议”。我应该这样做吗？

任何关于这方面的建议并使其更安全和更有保障都会非常有帮助。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T00:19:54.193

也许是嵌入在您的消息中的幻数字段。

```
struct Message
{
    ...
    unsigned magic_number = 0xbadbeef3;
    ...
}; 
```

所以你收到东西后要做的第一件事就是检查magic_number字段是否为0xbadbeef3。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T00:23:31.547

通常，我设计带有如下标头的协议：

```
typedef struct {
    uint32_t    signature;
    uint32_t    length;
    uint32_t    message_num;
} header_t;

typedef struct {
    uint32_t    foo;
} message13_t; 
```

发送消息：

```
message13_t msg;
msg.foo = 0xDEADBEEF;

header_t hdr;
hdr.signature = 0x4F4C494D;         // "MILO"
hdr.length = sizeof(message13_t);
hdr.message_num = 13;

// Send the header
send(s, &hdr, sizeof(hdr), 0);

// Send the message data
send(s, &msg, sizeof(msg), 0); 
```

接收消息：

```
header_t hdr;
char* buf;

// Read the header - all messages always have this
recv(s, &hdr, sizeof(hdr), 0);

// allocate a buffer for the rest of the message
buf = malloc(hdr.length);

// Read the rest of the message
recv(s, buf, hdr.length, 0); 
```

该代码显然没有错误检查或确保所有数据都已发送/接收。

# java - 仅在安装了证书后才能访问页面

> ID：14188209
> 
> 赞同：1
> 
> 时间：2013-01-07T00:11:15.630
> 
> 标签：java, php, .htaccess

早上好家伙！

我还有另一个麻烦……我需要限制对网站私人区域的访问，你会说……输入登录名；D 已经完成了；但是我的客户一直要求我限制更多，他想到了用户需要下载才能使用该平台的证书...这是我知道的问题，PHP不允许访问本地计算机... .所以我想使用一个java插件，然后让它以某种方式与php通信......这是一个可能的解决方案吗？有更好的选择吗？

谢谢。

法比奥

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T00:13:37.247

您可以将 HTTPS 与客户端证书一起使用。在这种情况下需要配置服务器，它不在 PHP 中处理。

# matlab - 在matlab中发送轴作为参数

> ID：14188211
> 
> 赞同：3
> 
> 时间：2013-01-07T00:11:36.823
> 
> 标签：matlab, matlab-figure, matlab-guide

我需要有关 MatLab GUI 的帮助。我有一个带有轴的 GUI，以及一个`plotData(axes,data)`以轴为参数的函数。GUI 有一个按钮“绘制数据”。

如何执行以下操作：单击按钮时，`plotData`使用参数`axes1`和要绘制的数据调用函数？我希望将情节定向到`axes1`GUI 中存在的情节。

这应该很简单，但是当我将轴作为参数发送时，它不会在 GUI 上绘制，或者它可能会绘制但我看不到它。如果没有这个功能，它对我来说很好：只是为了绘制数据。但要绘制数据，它不是 1 行 :)。

我尝试调用将 GUI 的轴句柄存储在不同 M 文件中的 ax，但是由于我将它作为来自不同 M 文件的函数调用，所以 GUI 轴句柄没有任何反应，但它也没有返回任何错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T07:40:52.133

*旁注：*您的问题有点不清楚：如果您添加了**小**代码片段来说明您尝试过的内容，则可以提供更好的答案。

*对于手头的问题：*

您是否尝试过将`plot`to 指向`axis1`in `plotData`？

```
function [] = plotData( ax, data )
% make ax the current axes for plot
axes( ax ); 
% continue with plotting the data 
% ... 
```

您可以通过您正在使用的特定命令`axes( ax );`以更有效的方式实现效果。`plot`例如，如果您使用简单`plot`

```
plot( ax, data ); % plots data to axes ax 
```

`plot`检查您用于轴参数的特定命令的文档。

# php - 使用 php header("Refresh") 重定向时的延迟

> ID：14188212
> 
> 赞同：1
> 
> 时间：2013-01-07T00:11:49.603
> 
> 标签：php, html

> **可能重复：**
> [为什么我必须在通过 PHP 中的 header('Location..') 重定向后调用'exit'？](https://stackoverflow.com/questions/2747791/why-i-have-to-call-exit-after-redirection-through-headerlocation-in-php)

为了在不登录的情况下无法访问 mainpage.php，我使用以下代码启动 mainpage.php：

```
<?php
    session_start();
    if(!isset($_SESSION['name'])){
        header("Refresh: 0; url=hauptseite_slim.php");
    }
?>
<!DOCTYPE html>
... 
```

这正是我想要的，**但是**，问题是，它非常难看，因为有一会儿，主页出现了。我怎样才能避免这种影响？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T00:13:38.137

你为什么不使用`header("location: hauptseite_slim.php");`？

* * *

这是我认为最好的做法：

```
header("location: hauptseite_slim.php");
exit; 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-07T00:16:05.663

如果您不希望发送 if 语句后的 html，只需返回即可。

```
 if(!isset($_SESSION['name'])){
        header("Refresh: 0; url=hauptseite_slim.php");
        return;
    } 
```

# charts - d3.js : 非常简单的鼠标交互

> ID：14188215
> 
> 赞同：2
> 
> 时间：2013-01-07T00:12:04.877
> 
> 标签：charts, d3.js, mouseevent

我不想用鼠标交互做一个非常简单的图表。

示例（正在进行的工作）在此页面上：http: [//velo70.ouvaton.org/2013/gpxvtt-un-nouveau-plugin/](http://velo70.ouvaton.org/2013/gpxvtt-un-nouveau-plugin/)

目标是：当您更改滑块位置时，一个圆圈在图表上的位置相同。在地图上，它已经完成了:)

最好的问题可能是：当你移动幻灯片时，圆图会移动，当你移动图表上的圆圈时，幻灯片也会移动......但对我来说可能太难了：\

与教程的任何链接可以继续进行吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T16:52:14.037

一种方法是将圆圈绑定到图表中的每个数据点，然后将 display: none 设置为除与您的活动滑块位置相对应的所有数据点之外的所有数据点。

附加 path.lineSup 后添加圆圈：

```
chart.selectAll("circle.highlightPoint")
    .data(data)
            .enter()
            .append("circle")
    .attr("class", "highlightPoint")
    .attr("fill", "pink")
    .attr("cx", function(d) { return x(d.dist); })
        .attr("cy", function(d) { return y(d.ele); })
            .attr("display", "none"); 
```

添加到您的滑块功能：

```
 d3.selectAll("circle.highlightPoint")
            .attr("display", function(d,i) { return i == id ? "block" : "none"}); 
```

我认为这应该有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T22:15:24.687

谢谢。对我来说很好的教学方式:)

我终于测试了

```
chart.append("circle")
    .data(data)
    .attr("class", "highlightPoint")
    .attr("r",4)
    .attr("innerRadius",0)
    .style("fill", "pink")
    .style("stroke","blue")
    .style("stroke-width",1)
    .attr("cx", function(d) { return x(d.dist); })
    .attr("cy", function(d) { return y(d.ele); })
    .attr("display","block") ; 
```

但它只显示第一个圆圈。我不太了解 function(d) 和 function(d,i) 的用途：\

在[http://velo70.ouvaton.org/2013/gpxvtt-un-nouveau-plugin/中测试](http://velo70.ouvaton.org/2013/gpxvtt-un-nouveau-plugin/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-10T14:08:41.330

有点晚了..但我需要参与点.. :)

对于简单的句柄点击鼠标和事件调用函数，我给你一个完整的文件来链接d3.js的简单函数。

```
<script src="js/file.js"></script> 
```

以及要包含的“THE”文件（主要针对“on”进行分析）：

```
$(function() {
// Handler for .ready() called.

var data = [],

  width = 300,
  height = 300,

  // An array to hold the coordinates
  // of the line drawn on each svg.
  coords = [],

  line = d3.svg.line(),

  // Set the behavior for each part
  // of the drag.
  drag = d3.behavior.drag()
              .on("dragstart", function() {
                // Empty the coords array.
                coords = [];
                svg = d3.select(this);

                // If a selection line already exists,
                // remove it.
                //svg.select(".selection").remove();

                // Add a new selection line.
                svg.append("path").attr({"class": "selection"});
              })
              .on("drag", function() {
                // Store the mouse's current position
                coords.push(d3.mouse(this));

                svg = d3.select(this);

                // Change the path of the selection line
                // to represent the area where the mouse
                // has been dragged.
                svg.select(".selection").attr({
                  d: line(coords)
                });

                // Figure out which dots are inside the
                // drawn path and highlight them.
                selected = [];
                svg.selectAll("circle.dot").each(function(d, i) {
                  point = [d3.select(this).attr("cx"), d3.select(this).attr("cy")];
                  if (pointInPolygon(point, coords)) {
                    selected.push(d.id);
                  }
                });
                highlight(selected);
              })
              .on("dragend", function() {
                svg = d3.select(this);
                // If the user clicks without having
                // drawn a path, remove any paths
                // that were drawn previously.
                if (coords.length === 0) {
                 // d3.selectAll("svg path").remove();
                  unhighlight();
                  return;
                }

                // Draw a path between the first point
                // and the last point, to close the path.
                svg.append("line").attr({
                  "class": "terminator",
                  d: line([coords[0], coords[coords.length-1]])
                });
              });

  function randomPoint() {
     return Math.floor(Math.random()*(width-30)) + 20;
  }

  // from https://github.com/substack/point-in-polygon
  function pointInPolygon (point, vs) {
     var xi, xj, i, intersect,
        x = point[0],
        y = point[1],
        inside = false;
    for (var i = 0, j = vs.length - 1; i < vs.length; j = i++) {
      xi = vs[i][0],
      yi = vs[i][1],
      xj = vs[j][0],
     yj = vs[j][1],
      intersect = ((yi > y) != (yj > y))
         && (x < (xj - xi) * (y - yi) / (yj - yi) + xi);
      if (intersect) inside = !inside;
   }
   return inside;
  }

 function unhighlight() {
   d3.selectAll("circle.dot").classed("highlighted", false);
  }

  function highlight(ids) {
    // First unhighlight all the circles.
   unhighlight();

   // Find the circles that have an id
   // in the array of ids given, and 
   // highlight those.
    d3.selectAll("circle.dot").filter(function(d, i) {
     return ids.indexOf(d.id) > -1;
   })
   .classed("highlighted", true);
 }

 function Scatter(data, selector, group) {
   var svg = d3.select(selector).append("svg")
               .attr({
                 width: width,
                 height: height
               }).call(drag),

       g = svg.append("g").attr({"class": "g-dot"}),

       // Create a circle element for each
       // item in the data passed.
     dot = g.selectAll("circle.dot")
                  .data(data)
                .enter().append("circle")
                 .attr({
                   "class": "dot",
                   r: 8,
                   cx: function(d, i) {
                     return d[group].x;
                  },
                cy: function(d, i) {
                  return d[group].y;
                },
              })
              .on("mouseover", function(d, i) {
                // Highlight circles on mouseover, but
                // only if a path hasn't been drawn.
                if (d3.selectAll("svg path").empty()) {
                  highlight([d.id]);
                }
              })
              .on("mouseout", function(d, i) {
                // If a path hasn't been drawn,
                // unhighlight the highlighted circles.
                if (d3.selectAll("svg path").empty()) {
                  unhighlight();
                }
              });

    text = g.selectAll("text")
              .data(data)
            .enter().append("text")
              .attr({
                x: function(d, i) {
                  return d[group].x;
                },
                y: function(d, i) {
                  return d[group].y + 4;
                }
              })
              .text(function(d, i) {
                return d.id;
              });
  }

  // Add the dots to each canvas div.
  Scatter(data, "#tableau_principal", "a");
  Scatter(data, "#canvas2", "b");
  Scatter(data, "#canvas3", "c");
}); // // FIN DOC READY //

 // functions generales used partt // 
```

# string - TCL string toupper（每个字）

> ID：14188222
> 
> 赞同：1
> 
> 时间：2013-01-07T00:13:15.980
> 
> 标签：string, list, tcl

我有一段代码用于我拥有的程序[因此一些特定于应用程序的代码] ...无论如何，我试图将每个单词的第一个字母大写，除非该单词大写。

例如： >>***这是将要更改的文本。***

到目前为止，我的代码如下。

**同样，其中一些是特定于应用程序的，我无法使用“puts”，结果必须作为 *return“”*返回，这就是我创建一个 var 并逐字添加的原因。**

```
proc ToTitle {} {
set Input [sh_set clipboard]
set CleanedInput [string map {" " |} [string trimright [string trimleft $Input]]]
set InputList [split $CleanedInput "|"]
set wresult ""
set item 0
foreach line $InputList {
set List_Item [lindex $InputList $item];
if {[string is upper $List_Item] == 1} {
 set newline $List_Item
    set wresult "$wresult $newline"
    incr item   
} else {
 set newline [string totitle $List_Item]
    set wresult "$wresult $newline"
    incr item
}
}
regsub -all {\u0020{2,}} $wresult " " wresult; #REMOVE ALL EXCESSIVE SPACE CHARACTERS
set $wresult [string trimright [string trimleft $wresult]]; # TRIM ALL OF THE WHITESPACE BEFORE AND AFTER THE STRING
return "$wresult"} 
```

这目前正在工作，输出将是： **这是将要更改的文本。**

问题是***“改变”。***因为***“。”*** 问题是我可以使用什么来仅读取具有特殊字符或单词字符的项目上的单词字符？

```
{[string is upper $List_Item] == 1} 
```

我知道我可以添加一些东西来检查它......提前感谢您的所有帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T00:42:07.107

我认为有一个更简单的解决方案。试试这个：

```
set a "this is text THAT would be CHANGED."
set out ""
foreach word $a {
append out "[string toupper $word 0 0] "
}
puts $out 
```

运行它会给出以下输出：

```
% % % This Is Text THAT Would Be CHANGED. 
```

# javascript - 跟踪 JavaScript 对 Ctrl + F 的使用？

> ID：14188224
> 
> 赞同：5
> 
> 时间：2013-01-07T00:13:27.987
> 
> 标签：javascript, browser, analytics

是否可以通过JavaScript 中的`Ctrl`+来了解我的用户在我的网页上搜索的内容？`F`因此，当用户使用`Ctrl`+`F`搜索某些内容时，JavaScript 可以捕获此操作（和搜索短语）并将其发送回服务器。

可能的？如何？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T00:19:11.330

不，不可能。在*某些*浏览器上，您可以捕获组合键`Ctrl`+ `F`，但您无法窥探用户搜索的内容。在其他浏览器上，您根本无法捕捉`Ctrl`+ `F`。

如果有什么安慰的话，您可能会在 IE6 上使用一个安全漏洞。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T00:21:36.077

不可以。出于所有安全原因，您永远不能访问页面外的浏览器 UI 元素。您可以捕获`Ctrl`+`F`并自行处理。但是，当然，它看起来与浏览器自己的 UI 元素不同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-10-14T16:44:11.183

我刚刚找到了一种在某些情况下可能会有所帮助的解决方法。

请注意，文档和可滚动元素总是滚动到下一个搜索到的位置——我们可以利用它并创建一个“隐藏”的可滚动元素并等待它滚动。当它滚动时，您可以读取它滚动到的位置并获得匹配的单词。

[http://jsfiddle.net/oz6gum90/6/](http://jsfiddle.net/oz6gum90/6/)

HTML：

```
<div id="hiddenScrollableContent">
    <div></div> <!-- first element must be empty -->
    <div>car</div>
    <div>cat</div>
    ...
</div> 
```

CSS：

```
#hiddenScrollableContent{
    overflow: scroll;
    position:absolute;
    height:20px;  /* can't be zero ! */
    opacity:0.01; /* can't be zero ! */
    pointer-events: none;
}
#hiddenScrollableContent div{
    height: 100px;
} 
```

JS：

```
$('#hiddenScrollableContent').scroll(function(e){
    var top = $(this).scrollTop();

    if (top==0)
        return; //prevents endless loop

    var index = Math.round(top / 100);
    var element = $('div', this).eq(index);
    var elementsText = element.text();
    $(this).scrollTop(0);

    console.log('top:'+top, 'index:'+index);

    $('span').text(elementsText);
}); 
```

# jquery - jQuery 插件如何加载元素集合？

> ID：14188235
> 
> 赞同：6
> 
> 时间：2013-01-07T00:15:26.663
> 
> 标签：jquery, jquery-plugins

我不确定这是否是一个stackoverflow问题，因为它有点笼统，如果是，请原谅我。

假设我有以下标记：

```
<div class="plugin"> ... </div>
<div class="plugin"> ... </div>
<div class="plugin"> ... </div> 
```

而且我不想运行一个 jquery 插件并将每个具有`plugin`该类的元素传递给它：

```
$(".plugin").myPlugin(); 
```

插件代码如下所示：

```
;(function ( $, window, undefined ) {

  var myPlugin = 'myPlugin',
      document = window.document,
      defaults = {
        propertyName: "value"
      };

  // The actual plugin constructor
  function Plugin( element, options ) {
    this.element = element;

    this.options = $.extend( {}, defaults, options) ;

    this._defaults = defaults;
    this._name = myPlugin;

    this.init();
  }

  Plugin.prototype.init = function () {

  };

  // A really lightweight plugin wrapper around the constructor, 
  // preventing against multiple instantiations
  $.fn[myPlugin] = function ( options ) {
    return this.each(function () {
      if (!$.data(this, 'plugin_' + myPlugin)) {
        $.data(this, 'plugin_' + myPlugin, new Plugin( this, options ));
      }
    });
  }
}(jQuery, window)); 
```

当我运行这段代码时，看起来插件构造函数正在为每个类名为`myPlugin`. 我认为它会在整个 div 集合上运行插件，并且只调用一次构造函数。

那么它是怎样工作的？是否为类选择器返回的每个元素创建了插件实例？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T00:37:44.107

也许以下评论会有所帮助：

```
$.fn[myPlugin] = function ( options ) {
    /* "this" is collection of elements from selector*/
    return this.each(function () {
        /* "this" is individual element due to being inside "each" loop*/
      if (!$.data(this, 'plugin_' + myPlugin)) {
        $.data(this, 'plugin_' + myPlugin, new Plugin( this, options ));
      }
    });
  } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T01:14:54.713

从顶部

```
$(".plugin").myPlugin(); 
```

**jQuery 选择器**

jQuery 将采用选择器`.plugin`，然后运行其通常的选择过程，生成一个 jQuery 对象（带有可用于链接的 jQuery 原型），该对象还包含结果的长度、结果数组和使用的选择器。

因此，`$(".plugin")`使用上述内容返回此对象。

**我的插件（）**

`myPlugin()`是一个函数调用。它是针对从`$(".plugin")`. 此函数位于定义它的位置：`$.fn[myPlugin]`. `fn`是 jQuery 向其基本原型添加功能的方式。请注意，这只调用*一次*。

**$.fn[myPlugin] = 函数**

此处调用的函数现在运行。它运行在`this`，这是上面提到的原始 jQuery 对象（包括来自选择器的结果数组）。`this.each(function () {...}`，其中 jQuery 的`each`函数将遍历 jQuery 对象的结果。在您的示例中，有 3 个 div。

**每次迭代运行**

```
if (!$.data(this, 'plugin_' + myPlugin)) {
 $.data(this, 'plugin_' + myPlugin, new Plugin( this, options ));
} 
```

第一行是一个条件语句，它查看名为“plugin_myPlugin”的数据对象（myPlugin 是一个常量字符串值）是否存在于当前元素（这是这 3 个 div 之一）上。首先运行此代码时，他们都没有这个。

**$.data(this, 'plugin_' + myPlugin, new Plugin(this, options));**

这行代码将`this`对象（即当前的 html 元素）传递给 jQuery 的`data`方法，该方法将对象添加到由名称索引的元素中。本例中的名称是“plugin_myPlugin”，对象是...

**新插件（这个，选项）**

`$.fn[myPlugin]`插件是在您的示例范围内本地定义的函数。它被定义为`function Plugin( element, options ) {...}`。

**功能插件（元素，选项）{...}**

这个函数将接受一个元素，它是从迭代中传递的`each`——在这个例子中是 3 个 div 之一——以及最初作为参数发送的选项`$.fn[myPlugin]`（在这种情况下，没有传入，可以看出与`myPlugin()`.

`this.element`该函数接受这些参数，并使用、`this.options`、`this._defaults`和将它们构建到当前 Function 对象上`this._name`，然后调用 init 函数（此处为空）。

毕竟构造了一个 Function 对象，然后使用 jQuery 的`data`方法将其附加到当前元素。

**执行摘要**

扩展函数`myPlugin`将为从使用的选择器生成的 jQuery 对象中的每个元素运行一次。扩展函数从定义的函数`Plugin`为每个符合条件的元素创建一个新的 Function 对象（因此在每个元素上运行构造函数，在这个确切的示例中运行 3 次）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-07T00:33:06.890

> 是否为类选择器返回的每个元素创建了插件实例？

**是**的。`this.each`因为当您在插件构造函数中调用并`Plugin`为每个元素初始化一个新的构造函数时，您正在循环遍历元素。

如果您想为集合运行单个自定义构造函数，请不要这样做`this.each`，只需传递`this`给`Plugin`构造函数（尽管您可能需要重新考虑使用插件的“缓存” `jQuery.data`）

# eclipse - Eclipse 折叠所有字段时完全隐藏字段

> ID：14188236
> 
> 赞同：0
> 
> 时间：2013-01-07T00:15:31.777
> 
> 标签：eclipse, ide, collapse

我有 Eclipse 的问题。我刚刚发现了“全部折叠”功能，它非常有用。但是，当我像这样在多行上定义许多变量时：

```
private int i = 0, k = 3, l = 5, g = 8, s = 3,
        p = 5, e = 6; //note: this is an example. This would be a nightmare to
                      //debug. :/ 
```

当我使用全部折叠时，Eclipse 会完全隐藏变量，就好像它们不存在一样。他们仍然按预期工作。我找到了解决方法：将光标放在下面一行上，然后按`Backspace``Enter`。但是，我不想每次折叠所有多行字段声明时都必须这样做。我该如何解决这个问题？截图如下。

在全部折叠之前：

![在此处输入图像描述](../Images/001b405d64a81e5526f2b8ad1c997dec.png)

后：

![在此处输入图像描述](../Images/b6ef469c3a9359329c151df9475de3c0.png)（左边没有`+`标志）

# android - Android：com.mysql.jdbc.exceptions.jdbc4.communicationsexception 通讯链接失败

> ID：14188238
> 
> 赞同：0
> 
> 时间：2013-01-07T00:16:17.560
> 
> 标签：android, jdbc

我有正确的 IP：端口，所以我不知道问题出在哪里，因为通信异常来自 mysql 数据库的损坏的 url：端口。

```
package com.bbb.aaa;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.ResultSetMetaData;
import java.sql.SQLException;
import java.sql.Statement;

import android.app.Activity;
import android.os.Bundle;
import android.widget.TextView;

public class MainActivity extends Activity {

private static final String url = "jdbc:mysql://uk1.khttp.net:2083/thedatabase"; // uk1.khttp.net == 95.154.195.28
private static final String user = "theusername";
private static final String pass = "thepassword";

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    System.out.println("About to try instantiating driver");

TextView tv = (TextView)this.findViewById(R.id.text_view);
try {
    Class.forName("com.mysql.jdbc.Driver");
    System.out.print("success");
    Connection con = DriverManager.getConnection(url, user, pass);
    String result = "Database connection success\n";
    System.out.print("success2");
    Statement st = con.createStatement();
    ResultSet rs = st.executeQuery("SELECT * FROM testingregistration");
    System.out.print("success3");
    ResultSetMetaData rsmd = rs.getMetaData();

    while(rs.next()) {
        result += rsmd.getColumnName(1) + ": " + rs.getInt(1) + "\n";
        result += rsmd.getColumnName(2) + ": " + rs.getString(2) + "\n";
        result += rsmd.getColumnName(3) + ": " + rs.getString(3) + "\n";
    }
    tv.setText(result);

    tv.setText("Driver instantiated");
    } catch (ClassNotFoundException e) {
    // TODO Auto-generated catch block

    tv.setText(".....Class com.mysql.jdbc.Driver not found!");
    e.printStackTrace();
    } catch (SQLException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
        tv.setText(e.toString());
    }

}

}

ERROR LOG: The last packet sent successfuly to the server was 0 milliseconds ago. The driver has not recieved any packets from the server 
```

控制台读取并打印“成功”，但之后它崩溃了，所以它不打印“success2”，这意味着问题出在连接上。

我尝试在互联网上搜索这个问题，但他们只是说你的 ip:port 和数据库应该是正确的，但对我来说这似乎是正确的，因为我可以使用该 url 和端口以及登录名和密码详细信息登录到 mysql 然后从那里我点击 phpMyAdmin 和我在数据库中。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T05:53:46.753

使用**AsyncTask**。你的 try catch 块代码写在`doInBackground`asynctask 的方法中。试试看。

# java - 无法使用 Google API [google-oauth-java-client-1.12.0-beta] 获取服务帐户流的令牌

> ID：14188239
> 
> 赞同：8
> 
> 时间：2013-01-07T00:16:23.993
> 
> 标签：java, oauth-2.0, google-oauth, google-url-shortener

我正在使用 Google API（版本 google-oauth-java-client-1.12.0-beta）获取 OAuth2 访问令牌，但返回“invalid_grant”。参考：[https ://developers.google.com/accounts/docs/OAuth2ServiceAccount](https://developers.google.com/accounts/docs/OAuth2ServiceAccount)

这是代码：

```
import com.google.api.client.auth.jsontoken.JsonWebSignature;
import com.google.api.client.auth.jsontoken.JsonWebToken;
import com.google.api.client.auth.jsontoken.RsaSHA256Signer;
import com.google.api.client.auth.oauth2.TokenRequest;
import com.google.api.client.auth.oauth2.TokenResponse;
import com.google.api.client.http.GenericUrl;
import com.google.api.client.http.HttpTransport;
import com.google.api.client.http.javanet.NetHttpTransport;
import com.google.api.client.json.JsonFactory;
import com.google.api.client.json.jackson2.JacksonFactory;
import com.google.api.client.util.Clock;

import java.io.FileInputStream;
import java.io.IOException;

import java.security.GeneralSecurityException;
import java.security.KeyStore;
import java.security.KeyStoreException;
import java.security.NoSuchAlgorithmException;
import java.security.PrivateKey;
import java.security.UnrecoverableKeyException;
import java.security.cert.CertificateException;

public class TestClient
{
  private static PrivateKey getPrivateKey(String keyFile, String alias, String password)
    throws KeyStoreException, IOException, NoSuchAlgorithmException, CertificateException, UnrecoverableKeyException
  {
    KeyStore keystore = KeyStore.getInstance("PKCS12");
    keystore.load(new FileInputStream(keyFile), password.toCharArray());
    PrivateKey privateKey = (PrivateKey) keystore.getKey(alias, password.toCharArray());

    return privateKey;
  }

  public static void main(String[] args)
    throws GeneralSecurityException, IOException
  {
    String password = "notasecret";
    String alias = "privatekey";
    String keyFile = "<private key file>.p12";
    String serviceAccountScopes = "https://www.googleapis.com/auth/urlshortener";
    String serviceAccountUser = "user1@gmail.com";
    String serviceAccountId = "<a/c id>.apps.googleusercontent.com";
    JsonWebSignature.Header header = new JsonWebSignature.Header();
    header.setAlgorithm("RS256");
    header.setType("JWT"); 

    JsonWebToken.Payload payload = new JsonWebToken.Payload(Clock.SYSTEM);
    long currentTime = Clock.SYSTEM.currentTimeMillis();
    payload.setIssuer(serviceAccountId)
       .setAudience("https://accounts.google.com/o/oauth2/token")
       .setIssuedAtTimeSeconds(currentTime / 1000)
       .setExpirationTimeSeconds(currentTime / 1000 + 3600)
       .setPrincipal(serviceAccountUser);
    payload.put("scope", serviceAccountScopes); 
    System.out.println(payload.toPrettyString());

    PrivateKey serviceAccountPrivateKey = getPrivateKey(keyFile, alias, password);
    String assertion = RsaSHA256Signer.sign(serviceAccountPrivateKey, getJsonFactory(), header, payload);     
    TokenRequest request = new TokenRequest(getTransport(), getJsonFactory(), new GenericUrl(getTokenServerEncodedUrl()), "assertion");     

    request.put("grant_type", "urn:ietf:params:oauth:grant-type:jwt-bearer");     
    request.put("assertion", assertion);     
    TokenResponse resp = request.execute();    
    System.out.println("token : " + resp.getAccessToken());
  }

  private static String getTokenServerEncodedUrl()
  {
    return "https://accounts.google.com/o/oauth2/token";
  }

  private static JsonFactory getJsonFactory()
  {
    return new JacksonFactory();
  }

  private static HttpTransport getTransport()
  {
    return new NetHttpTransport();
  }
} 
```

结果：

```
Exception in thread "main" com.google.api.client.auth.oauth2.TokenResponseException: 400 Bad Request
{
  "error" : "invalid_grant"
}
    at com.google.api.client.auth.oauth2.TokenResponseException.from(TokenResponseException.java:103)
    at com.google.api.client.auth.oauth2.TokenRequest.executeUnparsed(TokenRequest.java:303)
    at com.google.api.client.auth.oauth2.TokenRequest.execute(TokenRequest.java:323) 
```

这里有什么问题？任何提示将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-10T22:37:35.217

在 Google 服务和 Google API 客户端库上使用服务帐户时，您不必自己创建签名和构造 JWT 令牌，因为有读取使用的实用程序类可以简单地通过 OAuth 2.0 执行服务帐户授权。

然而，除了包含多种编程语言的详细解释和代码示例的 Google Drive 文档外，这并没有很好的记录。您应该阅读： [https ://developers.google.com/drive/service-accounts#google_apis_console_project_service_accounts](https://developers.google.com/drive/service-accounts#google_apis_console_project_service_accounts)

您的代码存在一些问题：

*   服务帐户的 ID 应采用以下形式：（`<some-id>@developer.gserviceaccount.com`是的电子邮件而不是客户 ID，我知道这很奇怪）
*   您只`principal`在执行[Google Apps 域范围委托](https://developers.google.com/drive/delegation)时设置，但您当然不能在 Gmail 帐户上执行此操作，只能在管理员已授予您访问权限的域的 Google Apps 帐户上设置，因此在您的情况下：不要设置它.

下面是 OAuth 2.0 的代码示例 w/Java 中的服务帐户。

注意：您还需要下载[URL Shortener library](http://code.google.com/p/google-api-java-client/wiki/APIs#URL_Shortener_API)。

```
/** Email of the Service Account */
private static final String SERVICE_ACCOUNT_EMAIL = "<some-id>@developer.gserviceaccount.com";

/** Path to the Service Account's Private Key file */
private static final String SERVICE_ACCOUNT_PKCS12_FILE_PATH = "/path/to/<public_key_fingerprint>-privatekey.p12";

/**
 * Build and returns a URL Shortner service object authorized with the service accounts.
 *
 * @return URL Shortner service object that is ready to make requests.
 */
public static Drive getDriveService() throws GeneralSecurityException, IOException, URISyntaxException {
  HttpTransport httpTransport = new NetHttpTransport();
  JacksonFactory jsonFactory = new JacksonFactory();
  GoogleCredential credential = new GoogleCredential.Builder()
      .setTransport(httpTransport)
      .setJsonFactory(jsonFactory)
      .setServiceAccountId(SERVICE_ACCOUNT_EMAIL)
      .setServiceAccountScopes(UrlshortenerScopes.URLSHORTENER)
      .setServiceAccountPrivateKeyFromP12File(
          new java.io.File(SERVICE_ACCOUNT_PKCS12_FILE_PATH))
      .build();
  Urlshortener service = new Urlshortener.Builder(httpTransport, jsonFactory, null)
      .setHttpRequestInitializer(credential).build();
  return service;
} 
```

# java - 鼠标在网格内移动

> ID：14188245
> 
> 赞同：1
> 
> 时间：2013-01-07T00:17:19.457
> 
> 标签：java, swing, mouseevent, point, swingutilities

我创建了一个网格和我的类的双数组`gridBalls`。

`gridBalls`有一个`int`类型，你传递给它一个数字来确定在网格中绘制什么，比如 0 空白，1 球等。

`mousedragged`如果我想说单击网格上的插槽 [0][0]（假装它是一个球），将我的鼠标向右拖动并绘制一条水平线（在此输入 3），我的代码会是什么样子例如），或者如果我拖动鼠标底部并绘制一条垂直线（类型 2）

```
public class connectiontest extends JApplet implements Runnable, MouseListener, MouseMotionListener
{
    Thread t;

    int GRIDSIZE = 6;
    int gridLevel = 1;

    JPanel menuPanel = new JPanel (null);
    JPanel gamePanel = new JPanel (new GridLayout (GRIDSIZE, GRIDSIZE));
    gridBalls[] [] panelGrid = new gridBalls [GRIDSIZE] [GRIDSIZE];

    public void init ()
    {
        getContentPane ().setBackground (Color.black);
        getContentPane ().setLayout (null);
        setSize (600, 600);

        gamePanel.setBounds (80, 120, 450, 450);
        gamePanel.setEnabled (true);

        menuPanel.setBounds (10, 10, 580, 100);
        menuPanel.setBackground (Color.black);
        menuPanel.setOpaque (true);
        menuPanel.setBorder (BorderFactory.createLineBorder (Color.white, 1));

        getContentPane ().add (gamePanel);
        getContentPane ().add (menuPanel);

        t = new Thread (this);
        drawGrid ();
        levels ();
        t.start ();
    }

    public void run ()
    {
        while (t != null)
        {
            try
            {
                t.sleep (20);
            }
            catch (InterruptedException e)
            {
                break;
            }
        }
    }

    private void drawGrid ()
    {
        for (int row = 0 ; row < GRIDSIZE ; row++)
        {
            for (int col = 0 ; col < GRIDSIZE ; col++)
            {
                panelGrid [row] [col] = new gridBalls ();
                panelGrid [row] [col].setOpaque (true);
                panelGrid [row] [col].setBackground (Color.black);
                panelGrid [row] [col].clr = Color.black;
                panelGrid [row] [col].setBorder (BorderFactory.createLineBorder (Color.blue, 1));
                gamePanel.add (panelGrid [row] [col]);
                panelGrid [row] [col].addMouseListener (this);
                panelGrid [row] [col].addMouseMotionListener (this);
            }
        }
    }

    public void mouseClicked (MouseEvent e)
    {

    }

    public void mouseEntered (MouseEvent e)
    {

    }

    public void mouseExited (MouseEvent e)
    {

    }

    public void mousePressed (MouseEvent e)
    {

    }

    public void mouseMoved (MouseEvent e)
    {

    }

    public void mouseDragged (MouseEvent e)
    {
        for (int i = 0 ; i < GRIDSIZE ; i++)
        {
            for (int j = 0 ; j < GRIDSIZE ; j++)
            {
                if (e.getSource () == panelGrid [i] [j])
                {
                    repaint ();
                }
            }
        }
    }

    public void mouseReleased (MouseEvent e)
    {

    }

    public void levels ()
    {
        if (gridLevel == 1)
        {
            panelGrid [0] [0].clr = Color.green;
            panelGrid [0] [0].type = 1;
            panelGrid [4] [0].clr = Color.green;
            panelGrid [4] [0].type = 1;
            panelGrid [0] [5].clr = Color.blue;
            panelGrid [0] [5].type = 1;
            panelGrid [5] [2].clr = Color.blue;
            panelGrid [5] [2].type = 1;
            panelGrid [0] [4].clr = Color.red;
            panelGrid [0] [4].type = 1;
            panelGrid [3] [2].clr = Color.red;
            panelGrid [3] [2].type = 1;
            panelGrid [5] [0].clr = Color.magenta;
            panelGrid [5] [0].type = 1;
            panelGrid [0] [1].clr = Color.magenta;
            panelGrid [0] [1].type = 1;
            panelGrid [1] [4].clr = Color.orange;
            panelGrid [1] [4].type = 1;
            panelGrid [4] [2].clr = Color.orange;
            panelGrid [4] [2].type = 1;
            panelGrid [0] [2].clr = Color.cyan;
            panelGrid [0] [2].type = 1;
            panelGrid [2] [2].clr = Color.cyan;
            panelGrid [2] [2].type = 1;
            repaint ();
        }
    }
}

class gridBalls extends JLabel
{
    Color clr;
    int type = 0;

    public gridBalls ()
    {

    }

    public void paintComponent (Graphics g)
    {
        super.paintComponent (g);

        g.setColor (clr);
        // blank
        if (type == 0)
        {

        }
        // ball
        if (type == 1)
        {
            g.fillOval ((getWidth () / 10), (getHeight () / 10), (getWidth () - 14), (getHeight () - 14));
        }
        // vertical line
        if (type == 2)
        {
            g.fillRect ((getWidth () / 3), 0, (getWidth () / 3), getHeight ());
        }
        // horizontal line
        if (type == 3)
        {
            g.fillRect (0, (getHeight () / 3), (getWidth ()), (getHeight () / 3));
        }
        // corner piece top>right
        if (type == 4)
        {
            g.fillRect ((getWidth () / 3), 0, (getWidth () / 3), (getHeight () / 2));
            g.fillRect ((getHeight () / 3), (getHeight () / 3), (getWidth ()), (getHeight () / 3));
        }
        // corner piece top>left
        if (type == 5)
        {
            g.fillRect ((getWidth () / 3), 0, (getWidth () / 3), (getHeight () / 2));
            g.fillRect (0, (getHeight () / 3), (getWidth () / 3 + getWidth () / 3), (getHeight () / 3));
        }
        // corner piece bottom>right
        if (type == 6)
        {
            g.fillRect ((getWidth () / 3), (getHeight () / 2), (getWidth () / 3), (getHeight () / 2));
            g.fillRect ((getHeight () / 3), (getHeight () / 3), (getWidth ()), (getHeight () / 3));
        }
        // corner piece bottom>left
        if (type == 7)
        {
            g.fillRect ((getWidth () / 3), (getHeight () / 2), (getWidth () / 3), (getHeight () / 2));
            g.fillRect (0, (getHeight () / 3), (getWidth () / 3 + getWidth () / 3), (getHeight () / 3));
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T01:34:56.673

The overall construction of you layers makes it very difficult to actually get the paint effect to work properly.

However, your mouse handler events would look something like...

```
public void mousePressed(MouseEvent e) {
    clickPoint = e.getPoint();
    clickPoint = SwingUtilities.convertPoint(e.getComponent(), clickPoint, this);
}

public void mouseDragged(MouseEvent e) {
    dragPoint = e.getPoint();
    dragPoint = SwingUtilities.convertPoint(e.getComponent(), dragPoint, this);
    repaint();
} 
```

`clickPoint` and `dragPoint` are instances of `java.awt.Point`.

Your next problem is going to be getting this to paint...

You need to be able to paint over the content. Because `paint` isn't double buffered, I'd personally avoid it, instead, I would override `paintChildren` (as `paintComponent` will be painted UNDER every thing else)...

```
@Override
protected void paintChildren(Graphics g) {
    super.paintChildren(g);
    if (clickPoint != null && dragPoint != null) {
        g.setColor(Color.RED);
        g.drawLine(clickPoint.x, clickPoint.y, dragPoint.x, dragPoint.y);
    }
} 
```

**Suggestions**

*   Avoid `null` layouts. They are more trouble then they are worth, you'd be better of using a combination of layout managers, compound components and `EmptyBorder`s as required...
*   Be careful with your `Thread`, Swing has some very particular needs when it comes to thread management...

# php - PHP 无法重新声明变量

> ID：14188248
> 
> 赞同：1
> 
> 时间：2013-01-07T00:18:02.107
> 
> 标签：php

```
class Content extends CodonModule     {

    public $title = 'Operations';
    public function operations()     {

        $this->show('operations');

    }

    public $title = 'Staff';
    public function staff()     {

        $this->show('staff');

    }

} 
```

我试图给每个模板一个标题，但它不能重新声明一个类，我该如何绕过这个？我尝试将 public $title 放在函数中，但这不遵循文档，并且不起作用，它只会引发未定义的 T_PUBLIC 错误。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T00:29:55.277

正如 Michael Berkowski 在评论中所说，在函数中设置标题。这将导致在调用函数时设置标题。

```
class Content extends CodonModule     {

    public $title;

    public function operations()     {
        $this->title = 'Operations';
        $this->show('operations');

    }

    public function staff()     {
        $this->title = 'Staff';
        $this->show('staff');

    }

} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-07T00:20:08.840

连续多次包含/需要此文件。您只能使用此名称定义 1 个类，但您可以将多个对象作为此类的实例。

# php - PHP SoapClient 和 Zend_Soap_client 什么都不返回

> ID：14188251
> 
> 赞同：0
> 
> 时间：2013-01-07T00:18:47.343
> 
> 标签：php, zend-framework, soap, zend-soap

我正在尝试构建一个简单的 Web 服务，并且正在跨情况运行。我不知道我做错了什么，所以我无法获取肥皂服务器返回的值。

我的 indexController 中有一个 Zend_Soap_Server 和一个 Zend_Soap_Client：

```
class IndexController 
extends Zend_Controller_Action
{

    public function init()
    {
        $this->getHelper('viewRenderer')->setNoRender(true);
        Zend_loader::loadFile( APPLICATION_PATH . '/../library/Web/Service.php' );
    }

    public function indexAction() {}

    public function serverAction()
    {

        if( isset( $_GET['wdsl'] ) ) {
            $server = new Zend_Soap_AutoDiscover();
            $server->setClass('Web_Service');
            $server->handle();
        } else {
            $options = array(
                'soap_version' => SOAP_1_1 ,
                'uri' => 'http://webservices.localhost/index/server?wdsl=1'
            );
            $server = new Zend_Soap_Server(null, $options);
            $server->setClass('Web_Service');
            $server->handle();
        }
    }

    public function testAction()
    {
        $client = new Zend_Soap_Client(
            'http://webservices.localhost/index/server?wdsl'
        );

        print( $client->getMessage() ) ;
    }

} 
```

并将一个非常简单的 Service 类传递给肥皂服务器：

```
class Web_Service
{

    public function getMessage()
    {
        return 'ok';
    }

} 
```

当我请求我的 Soap 服务器的 URL 时，它返回我猜应该返回的内容：

```
<definitions xmlns="http://schemas.xmlsoap.org/wsdl/" xmlns:tns="http://webservices.misterprint.com.br/index/server" xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap-enc="http://schemas.xmlsoap.org/soap/encoding/" xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/" name="Web_Service" targetNamespace="http://webservices.misterprint.com.br/index/server">
<types>
<xsd:schema targetNamespace="http://webservices.misterprint.com.br/index/server"/>
</types>
<portType name="Web_ServicePort">
<operation name="getMessage">
<documentation>getMessage</documentation>
<input message="tns:getMessageIn"/>
</operation>
</portType>
<binding name="Web_ServiceBinding" type="tns:Web_ServicePort">
<soap:binding style="rpc" transport="http://schemas.xmlsoap.org/soap/http"/>
<operation name="getMessage">
<soap:operation soapAction="http://webservices.misterprint.com.br/index/server#getMessage"/>
<input>
<soap:body use="encoded" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" namespace="http://webservices.misterprint.com.br/index/server"/>
</input>
</operation>
</binding>
<service name="Web_ServiceService">
<port name="Web_ServicePort" binding="tns:Web_ServiceBinding">
<soap:address location="http://webservices.misterprint.com.br/index/server"/>
</port>
</service>
<message name="getMessageIn"/>
</definitions> 
```

但是当我访问客户端的测试时，它什么也没打印！

例如，如果我将 getMessage 方法的名称更改为 getMessages，Zend 会抛出异常：

```
Message: Function ("getMessages") is not a valid method for this service 
```

我不知道我做错了什么。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T00:42:25.603

嗨，您可能想先检查几件事，尽管我很感激您可能已经知道/已经这样做了。

在开发 SOAP 服务时，除非您更改了任何默认设置，否则您的 WSDL 可能会被缓存。

您可能希望在相关环境设置下将其添加到您的 application.ini 中，例如正在开发中。

```
phpSettings.soap.wsdl_cache_enabled = 0 
```

这意味着您的 WSDL 不会被缓存，并且您可以排除这方面的任何问题 - 尽管说您的 WSDL 似乎确实是您尝试使用的方法。

此外，当使用 ZF 自动生成 WSDL 时，您需要向该方法添加基本注释，以便 ZF WSDL 生成器可以拾取它们，例如添加任何 @param 和 @return 信息。像这样：

```
 /**     
  * @return string
  */
 public function getMessage()
 {
     return 'ok';
 } 
```

因此，完成后尝试使用您的服务器方法做一些不同的事情....尝试

```
public function serverAction()
{
    $baseUrl = 'http://webservices.localhost/index/server';

    if( isset( $_GET['wdsl'] ) ) {
        $strategy = new Zend_Soap_Wsdl_Strategy_AnyType();
        $server = new Zend_Soap_AutoDiscover($strategy);
        $server->setUri($baseUrl);
        $server->setClass('Web_Service');
        $server->handle();
    } else {            
        $server = new Zend_Soap_Server($baseUrl . '?wsdl');
        $server->setClass('Web_Service');
        $server->handle();
    }
} 
```

# android - 如何在编译器中启用内在函数？

> ID：14188262
> 
> 赞同：1
> 
> 时间：2013-01-07T00:20:44.447
> 
> 标签：android, c, arm

谁能解释一下：如何在c代码中启用内在函数？

我想在 armv5TE中使用[特殊的 dsp 指令](http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.dui0489c/Cihidceh.html)

考虑`qadd`指令，当我使用汇编程序方法时它很好地工作，如下所示：

```
inline int function_qadd(int a, int b) {
    __asm__ (
            "qadd %0, %1, %2" : "=r" (a) : "r" (a), "r" (b));
    return a;
} 
```

但是当我尝试使用[__qadd 内在](http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.dui0491c/CJACGAFH.html)而不是像这样的 asm 时：

```
int add_result = __qadd(5,10);
LOGI("qadd='%d'", add_result); 
```

我得到了错误：

> 错误：未定义对“__qadd”的引用

**我做错了什么，如何在c代码中启用内在函数？**

**更新：**

我有 ndk `android-ndk-r8c`（windows 版本），[默认 GCC 4.6](http://developer.android.com/tools/sdk/ndk/index.html)：

> GCC 4.6 编译器仍然是默认的，

除了我在 android.mk 中明确指定

```
NDK_TOOLCHAIN_VERSION=4.6 
```

我的编译器标志是：

```
LOCAL_CFLAGS += -std=c99 -ffast-math -march=armv5te -mfpu=vfp -mfloat-abi=softfp 
```

除了我通过 -S 编译器标志检查 gcc 生成的 asm 代码之外，它还生成 qadd 指令：

```
qadd r3, r3, r2 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T03:44:02.810

内在函数 __qadd 不适用于 GCC 编译器。您提供的文档链接适用于（非免费）armcc 编译器。

如果您使用 GCC，则使用汇编程序方法是使用 qadd 指令的唯一实用方法。

# jquery - 使用 AJAX 加载的 DoubleClick 广告 (DFP) 不会在 Firefox 中显示广告

> ID：14188263
> 
> 赞同：9
> 
> 时间：2013-01-07T00:20:59.913
> 
> 标签：jquery, google-dfp

我使用 DFP 广告管理系统 (DFP) 提供的广告。这是页面： [http ://www.ifly.com](http://www.ifly.com)

在页面加载事件之后，我通过 jQuery AJAX 加载 DFP 广告，以使我的各种搜索小部件尽可能快地用于用户交互。这个过程看起来像这样。

将初始 DFP 标题调用放在文档标题中。

```
<head>
...
<script type='text/javascript'>
var googletag = googletag || {};
googletag.cmd = googletag.cmd || [];
(function() {
var gads = document.createElement('script');
gads.async = true;
gads.type = 'text/javascript';
var useSSL = 'https:' == document.location.protocol;
gads.src = (useSSL ? 'https:' : 'http:') + 
'//www.googletagservices.com/tag/js/gpt.js';
var node = document.getElementsByTagName('script')[0];
node.parentNode.insertBefore(gads, node);
})();
</script>

<script type='text/javascript'>
googletag.cmd.push(function() {
googletag.defineSlot('/9358962/HP-300x250', [300, 250], 'div-gpt-ad-1353002461867-0').addService(googletag.pubads());
googletag.defineSlot('/9358962/HP-460x60', [468, 60], 'div-gpt-ad-1353002461867-1').addService(googletag.pubads());
googletag.defineSlot('/9358962/HP-728x90', [728, 90], 'div-gpt-ad-1353002461867-2').addService(googletag.pubads());
googletag.defineSlot('/9358962/HP-LAF-160x600', [160, 600], 'div-gpt-ad-1353002461867-3').addService(googletag.pubads());
googletag.defineSlot('/9358962/HP-RAF-160x600', [160, 600], 'div-gpt-ad-1353002461867-4').addService(googletag.pubads());
googletag.pubads().enableSingleRequest();
googletag.enableServices();
});
</script>
....
</head> 
```

创建一个空 div 作为占位符。

```
<div id='horizontalTANBanner'></div> 
```

页面加载后，使用 jQuery AJAX 插入代码以获取广告。

```
<div id='horizontalTANBanner'>  
  <!-- HP-728x90 -->
  <div id='div-gpt-ad-1353002461867-2' style='width:728px; height:90px;'>
  <script type='text/javascript'>
  googletag.cmd.push(function() { googletag.display('div-gpt-ad-1353002461867-2'); });
  </script>
  </div>
</div> 
```

Google 会加载更多 JavaScript 来实际调用广告。我看到它已使用 Firebug 插入。

```
<div id="horizontalTANBanner">
<div id="div-gpt-ad-1353002461867-2" style="width:728px; height:90px;">
<iframe id="google_ads_iframe_/9358962/HP-728x90_0" width="728" scrolling="no" height="90" frameborder="0" name="google_ads_iframe_/9358962/HP-728x90_0" marginwidth="0" marginheight="0" style="border: 0px none;">
<html>
</iframe>
<iframe id="google_ads_iframe_/9358962/HP-728x90_0__hidden__" width="0" scrolling="no" height="0" frameborder="0" name="google_ads_iframe_/9358962/HP-728x90_0__hidden__" marginwidth="0" marginheight="0" style="border: 0px none; visibility: hidden; display: none;">
</div>
</div> 
```

我看到广告显示在除 Firefox（IE、Chrome、Opera、Safari）之外的所有浏览器中。我已与其他用户确认他们无法在 Firefox 中看到广告。如何让广告在 Firefox 中显示？

我在 DFP 论坛上问过这个问题，但不是技术性的，他们的最佳答案是“停止使用 AJAX”，但访问者体验要好得多，我希望谷歌会更好地对我的网页进行排名，因为加载速度不那么慢，所以我讨厌停止使用它。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-09T13:40:55.050

我认为您可能过于复杂 dfp 插槽的加载。

这个代码块是我认为不起作用的部分。

```
 /*** Populate DFP ads ***/
  var _pageID=$("body").find_class("pageID-");
  $.get('/common/modules/ajax-get-list.php',{pageID:_pageID},function(_data){
    //alert('data='+_data);
    if(_data!=''){
      var _arrDFPList=_data.split(',');
      for(var i=0;i<_arrDFPList.length;i++){
        //alert('DFP id = '+_arrDFPList[i]);
        $.get('/common/modules/ajax-get-one.php',{id:_arrDFPList[i]},function(_oneData){
          var _arrDFPOne=_oneData.split('<<<>>>');
          //alert('id = '+_arrDFPOne[0]+' and content = '+_arrDFPOne[1]);
          $("#"+_arrDFPOne[0]).append(_arrDFPOne[1]);
          //$("#"+_arrDFPOne[0]).html(_arrDFPOne[1]);
        });
      }
    }

    /*
    if(_data!=''){
      var arrDFPList=_data.split(',');
      $.get('/common/modules/def-get-one.php',{},function(_oneData){
      });
    }*/
  });
  /*** END Populate DFP ads ***/ 
```

我认为 Firefox 可能只是附加了广告位显示代码，但未能对其进行评估。

几个月前我遇到了一个类似的问题，我们想在加载后引入广告，并且让一切都非常快速而简单......我想出的解决方案是创建[jquery.dfp.js](https://github.com/coop182/jquery.dfp.js)。此插件允许您完全推迟 DFP 的加载，直到您想要加载它，您也不需要像当前正在做的那样预先定义所有插槽...

例如，这是您当前的主页，其中包含使用我的插件展示广告所需的基本要素：

```
<html>
<head>
    <title>DFP TEST</title>

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script src="https://raw.github.com/coop182/jquery.dfp.js/master/jquery.dfp.min.js"></script>

</head>
<body>

<div class="adunit" id="HP-300x250" data-dimensions="300x250"></div>
<div class="adunit" id="HP-460x60" data-dimensions="460x60"></div>
<div class="adunit" id="HP-728x90" data-dimensions="728x90"></div>
<div class="adunit" id="HP-LAF-160x600" data-dimensions="160x600"></div>
<div class="adunit" id="HP-RAF-160x600" data-dimensions="160x600"></div>

<script>
$(function () {
    $.dfp('9358962');
});
</script>

</body>
</html> 
```

我认为这是一种更好的做事方式。如果您有任何问题，请告诉我。

# java - 切换蓝牙时无限活动循环

> ID：14188268
> 
> 赞同：7
> 
> 时间：2013-01-07T00:21:37.993
> 
> 标签：java, android, bluetooth

我创建了一个应用程序来检查 NFC 标签的有效负载，并且当它与应用程序匹配时会切换蓝牙。

不幸的是，该应用程序似乎进入了一个无限循环，它要求用户允许操作蓝牙，忽略选择并再次启动（再次询问相同的问题/活动）。 `onActivityResult`似乎没有被调用。

我的控制台日志调用的输出是：

```
Payload: 'quicktags-togglebluetooth'
Bluetooth should now be on 
```

如果我继续在权限 Activity 上点击“是”，则蓝牙会无限切换，控制台日志 (logcat) 如下所示：

```
Payload: quicktags-togglebluetooth
Bluetooth should now be on
Bluetooth should now be off
Bluetooth should now be on
Bluetooth should now be off
Bluetooth should now be on
Bluetooth should now be off 
```

等等。

AndroidManifest 列出了正确的权限，请看下面：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.getquicktags.qt"
    android:versionCode="1"
    android:versionName="1.0" android:installLocation="auto">

    <uses-sdk android:minSdkVersion="14" android:targetSdkVersion="14" />

    <uses-permission android:name="android.permission.NFC" />
    <uses-permission android:name="android.permission.BLUETOOTH" />
    <uses-permission android:name="android.permission.BLUETOOTH_ADMIN" />
    <uses-permission android:name="android.permission.INTERNET" />
    <uses-feature android:name="android.hardware.nfc" android:required="true" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" >

        <activity
            android:name=".MainActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>

         <activity
            android:name=".CardActivity"
            android:label="@string/app_name" >

            <!-- Handle a collectable card NDEF record -->
            <intent-filter>
                <action android:name="android.nfc.action.NDEF_DISCOVERED"/>
                <data android:mimeType="application/vnd.getquicktags.qt"/>
                <category android:name="android.intent.category.DEFAULT"/>
            </intent-filter>
         </activity>

    </application>

</manifest> 
```

CardActivity.java 文件是启动这个蓝牙混乱的原因，可以在下面找到：

```
package com.getquicktags.qt;

import android.app.Activity;
import android.app.AlertDialog;
import android.content.DialogInterface;
import android.content.DialogInterface.OnClickListener;
import android.content.Intent;
import android.nfc.NdefMessage;
import android.nfc.NdefRecord;
import android.nfc.NfcAdapter;
import android.os.Bundle;
import android.os.Parcelable;
import android.util.Log;
import android.bluetooth.*;

public class CardActivity extends Activity implements OnClickListener {

    private static final String TAG = null;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.card_activity);

        // see if app was started from a tag and show game console
        Intent intent = getIntent();

        if(intent.getType() != null && intent.getType().equals(MimeType.NFC_DEMO)) {
            Parcelable[] rawMsgs = getIntent().getParcelableArrayExtra(NfcAdapter.EXTRA_NDEF_MESSAGES);
            NdefMessage msg = (NdefMessage) rawMsgs[0];
            NdefRecord cardRecord = msg.getRecords()[0];
            String payload = new String(cardRecord.getPayload());

            Log.d(TAG, "Payload: '"+ payload +"'");

            if(payload.equals("quicktags-togglebluetooth")) {
                toggleBluetooth();
            }
        }
    }

    private void toggleBluetooth() {

        BluetoothAdapter mBluetoothAdapter = BluetoothAdapter.getDefaultAdapter();
        if (mBluetoothAdapter == null) {
            // Device does not support Bluetooth
            Log.d(TAG, "No Bluetooth on device");
            closeApp();
        }
        if (!mBluetoothAdapter.isEnabled()) {
            Intent enableBtIntent = new Intent(BluetoothAdapter.ACTION_REQUEST_ENABLE);
            startActivityForResult(enableBtIntent, 1);
            Log.d(TAG, "Bluetooth should now be on");
        } else {
            // Turn it off
            mBluetoothAdapter.disable();
            Log.d(TAG, "Bluetooth should now be off");
            closeApp();
        }

    }

    @Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data) {
        super.onActivityResult(requestCode, resultCode, data);
        // Close the app
        Log.d(TAG, "Close the app call");
        closeApp();
    }

    private void closeApp() {
        Log.d(TAG, "And... close it. This is inside closeApp()");
        android.os.Process.killProcess(android.os.Process.myPid());
    }

    public void onClick(DialogInterface dialog, int which) {
        // TODO Auto-generated method stub

    }
} 
```

根据 logcat，您可以看到，`onActivityResults`因此`closeApp`不会被调用。

我在 Nexus 7 上进行测试。标签很好，我已经用各种 NFC 阅读器进行了测试。

扫描标签时 logcat 会出现一些错误，但它们对我来说似乎没有多大意义。见下文：

```
01-07 00:18:41.595: E/bt-btif(5830): btif_enable_service: current services:0x100020
01-07 00:18:41.605: E/bt-btif(5830): btif_enable_service: current services:0x140020
01-07 00:18:41.605: E/bt-btif(5830): btif_enable_service: current services:0x140020
01-07 00:18:42.415: E/bt-btif(5830): Calling BTA_HhEnable
01-07 00:18:42.415: E/btif_config.c(5830): ## btif_config_get assert section && *section && key && *key && name && *name && bytes && type failed at line:186 ##
01-07 00:18:42.415: E/bt-btif(5830): btif_storage_get_adapter_property service_mask:0x140020
01-07 00:18:42.435: E/btif_config.c(5830): ## btif_config_get assert section && *section && key && *key && name && *name && bytes && type failed at line:186 ##
01-07 00:18:42.445: E/bt_h4(5830): vendor lib postload completed
01-07 00:18:42.545: E/BluetoothServiceJni(5830): SOCK FLAG = 1 ***********************
01-07 00:18:42.605: E/BluetoothServiceJni(5830): SOCK FLAG = 0 ***********************
01-07 00:18:42.715: E/BtOppRfcommListener(5830): Error accept connection java.io.IOException: read failed, socket might closed, read ret: -1
01-07 00:18:42.915: E/bt-btif(5830): BTA AG is already disabled, ignoring ...
01-07 00:18:42.935: E/bt-btif(5830): btif_disable_service: Current Services:0x140020
01-07 00:18:42.945: E/bt-btif(5830): btif_disable_service: Current Services:0x100020
01-07 00:18:42.945: E/bt-btif(5830): btif_disable_service: Current Services:0x100020 
```

非常感谢您对此的任何帮助。正如您可能想象的那样，这让我发疯:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T13:27:17.610

你为什么要杀死进程`closeApp()`？我想这是你问题的一部分。只需调用`finish()`Activity 并让 Android 在需要时处理清理您的进程。

当你杀死你的进程时，Android 认为发生了一些不好的事情并试图恢复。作为此恢复的一部分，它可能会重新交付 Intent，这可能不是您想要的

# c - C语言和| ~ << >>

> ID：14188269
> 
> 赞同：-6
> 
> 时间：2013-01-07T00:21:43.097
> 
> 标签：c

我刚学C。有人能解释一下他们用的是什么吗？这些运营商。在一个真正的工业案例中......谢谢。

像：

我什么时候需要这些？：

```
~X 
n = n & 0177
x = x | 1211 
```

请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T02:33:37.307

这是基本的，因此有许多潜在的应用，但这里有一个具体的工业示例：

假设您要在设备之间发送一堆命令和/或状态信息。为避免浪费带宽（特别是如果您使用较慢的连接类型，例如旧的 9 针串行连接，它仍在工业设备上使用），您可以“打包”和“解包”数据。在双态信号的情况下，这意味着每个字节最多可以保存八个独立的状态。要获取第 6 位的状态，您可以执行以下操作：

```
status = (dataByte & 0x40) >> 6; 
```

在上面的行中，0x40 是一个位掩码，它导致除位 6 之外的所有位都为零。右移 6 会将结果值 - 0x40 或 0x00 - 转换为 1 或 0。

看看这个简短的部分，了解标准的相关示例： [C 中的位操作](http://en.wikipedia.org/wiki/Bit_manipulation#Bit_manipulation_in_the_C_programming_language)

# shell - 为什么 ppm: 命令找不到？

> ID：14188270
> 
> 赞同：6
> 
> 时间：2013-01-07T00:21:59.243
> 
> 标签：天蓝色, shell, perl, ubuntu-12.04

我正在尝试运行一些`ppm`命令，但我并没有走得太远。我`Ubuntu 12.04.1 LTS`在[![](../Images/1ac55c7a2483f8640ba68c61319473b9.png)天蓝色](/questions/tagged/azure "显示标记为“天蓝色”的问题")的虚拟机上运行。

```
> $ sudo apt-get install ppm
Reading package lists... Done
Building dependency tree       
Reading state information... Done
ppm is already the newest version.
0 upgraded, 0 newly installed, 0 to remove and 7 not upgraded. 
```

```
> $ ppm repo add ASSP2 "http://downloads.sourceforge.net/project/assp/ASSP V2 multithreading/packages/"
No command 'ppm' found, but there are 16 similar ones
ppm: command not found 
```

```
> $ perl -v

This is perl 5, version 14, subversion 2 (v5.14.2) built for x86_64-linux-gnu-thread-multi
(with 55 registered patches, see perl -V for more detail) 
```

任何方向都会非常有帮助。

仅供参考：我已经想出了一个使用 cpan 的解决方法，但我宁愿使用`ppm`

解决方法很简单

```
$ sudo cpan
cpan[#]> install some::package 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-07T00:59:26.310

“ [ppm](http://www.activestate.com/activeperl/ppm-perl-modules) ”是[ActiveState 的 ActivePerl](http://www.activestate.com/activeperl)使用的包管理器的名称。

Ubuntu [ppm 包](https://launchpad.net/ubuntu/+source/ppm)是“电源策略管理器”，一个完全不相关的东西。

除非您在 Ubuntu 安装中使用 ActivePerl，否则您不想使用他们的 PPM 实用程序。如果您尝试安装的软件包在 Ubuntu 的存储库中不可用，或者您不想使用它（如果可用），那么使用 CPAN 确实是您最好的选择。

# ruby-on-rails - Rails will_paginate：如何在页面之间保持一致的数组索引？

> ID：14188271
> 
> 赞同：1
> 
> 时间：2013-01-07T00:22:01.060
> 
> 标签：ruby-on-rails, haml, will-paginate

我在`will_paginate`Rails 3.2 中使用 Rails gem。我的数据库中有大约 750 部电影，我将它们放在我的视图中的一个表中。这是火腿：

```
%h1 Listing movies
%table.table.table-striped
  %tr
    %th No.
    %th Name
    %th Rating
    %th
  - @movies.each_with_index do |movie, index|
    %tr
      %td= (index + 1) 
      %td= link_to movie.name, edit_movie_path(movie)
      %td= movie.rating
      %td= link_to 'Delete', movie, method: :delete, data: { confirm: 'Are you sure?' } 
```

我已经`default_scope order: 'name ASC'`在我的`movie.rb`模型中按字母顺序对它们进行排序，这`each_with_index`使我能够在表格中获得一致的数字列表。

问题是，现在我正在使用分页，`index`电影数组的每一页都从头开始，所以它总是说 1-10。

问题是，我怎样才能让第 1 页给出 1-10，然后在第 2 页上说 11-20，等等？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T00:42:53.910

看来您可能必须修改 will_paginate 源代码才能使页面索引按您的预期工作（请参阅[此 SO Post](https://stackoverflow.com/questions/13740141/will-paginate-starts-next-page-count-from-1-with-indexing)）。

我将只使用在控制器中声明并在我的视图中递增的会话变量来解决这个问题。

```
session[:index] ||= 0
if params[:search]
   session[:index] = 0
end

# View
<% session[:index] = session[:index] + 1 %> 
```

**[编辑]**
另一种解决方案，感谢@pjam 评论，`use params[:page]`由 will_paginate 返回。例如，如果您设置`:per_page => 5`，则当前页面的索引可以计算如下：

```
@offset = (params[:page] - 1) * params[:per_page] + 1

# View
index + @offset 
```

# struts2 - 我是否应该找到并将 struts 样式和 javascripts 复制到 /struts/ 文件夹以启用客户端验证？

> ID：14188272
> 
> 赞同：0
> 
> 时间：2013-01-07T00:22:37.333
> 
> 标签：struts2, struts2-jquery, struts-validation

客户端验证对我不起作用。首先我认为这是一个 myeclipse 错误，没有将它们复制到根文件夹，但后来我发现 js 和 css 文件驻留在 struts 核心 jar 中。现在我想知道我该怎么办！如果我从相应的文件夹中找到所有 js 和 css 文件并将其复制到 webRoot，或者是否有智能的解决方法，比如更改配置？struts应该自己复制它们吗？

我将 Tiles 与 Struts 一起使用。会不会是问题？

我的 JSP 文件在 WEB-INF 文件夹中！它会引起一些问题吗？

使用 struts2-jquery 插件之类的东西可以解决我的问题吗？

我用struts2！

我的 struts2 过滤器配置是

```
 <filter>
    <filter-name>struts2</filter-name>
    <filter-class>
        org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter
    </filter-class>
  </filter>
  <filter-mapping>
    <filter-name>struts2</filter-name>
    <url-pattern>*.action</url-pattern>
  </filter-mapping>

    <listener>
    <listener-class>org.apache.struts2.tiles.StrutsTilesListener</listener-class>
</listener> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T16:55:03.587

这里的具体问题是过滤器配置：

```
<filter-mapping>
  <filter-name>struts2</filter-name>
  <url-pattern>*.action</url-pattern>
</filter-mapping> 
```

推荐的配置（除非你特别知道你在做什么）是映射到`*`：

```
<filter-mapping>
  <filter-name>struts2</filter-name>
  <url-pattern>*</url-pattern>
</filter-mapping> 
```

如果您只映射到`*.action`，过滤器将不会处理非操作请求（如 CSS 和 JavaScript）。S2 检查它 (S2) 知道的文件的请求，例如它自己的 CSS 和 JavaScript 文件，并自己处理这些请求，即使它们不是操作请求。

这记录在[S2 指南的静态内容部分](https://struts.apache.org/core-developers/static-content.html)中。

映射到是完全*有效*`*.action`的，但是您*确实*需要提取静态文件并将它们放在所需的位置，至少如果您打算使用默认的 S2 主题/JavaScript。这也是可选的：该框架旨在让您相对较快地开始，但如果您有该框架无法处理的特定需求，则使用 S2 的该部分可能是也可能不是最佳选择。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T10:24:46.473

在 Java 项目（以及其他项目）中，Eclipse 会将您的所有文件从 SOURCE 文件夹复制到 OUTPUT 文件夹。

这意味着如果您将 MyClass.java 和 foobar.properties 放在 /src 文件夹中，您将在 /bin 文件夹下拥有 MyClass.class 和 foobar.properties（根据为输出文件夹选择的名称），当您将构建你的项目。

对于更多的自动化，比如替换配置文件中的标记（比如说环境变量 config），或者动态检索所需的库，通常采用的两个主要工具是[Apache Ant](http://ant.apache.org/)（以[Apache Ivy](http://ant.apache.org/ivy/)作为依赖管理器）或[Apache Maven](http://maven.apache.org/)。

通常，

*   属性文件放在 src 文件夹的根目录下；
*   Struts2 XML Validation 文件放在Action 的同一个包下进行验证；
*   Struts2 XML Visitor Validation文件放在POJO的同一个包下进行验证；
*   JSP文件、JS文件、CSS文件放在/WEB-INF文件夹旁边（如果需要放在war里面），不会被任何人移动。

一个典型的结构*可能*是：

```
src |
    |-- java
    |-- web
       |-- css
       |-- js
       |-- jsp
       |-- WEB-INF
          |-- lib 
```

也看看这个 SO 答案：

[将 CSS 和 JS 文件放入 Mavenized Java Web 应用程序的最佳位置？](https://stackoverflow.com/questions/2238973/best-location-to-put-your-css-and-js-files-in-a-mavenized-java-web-app)

[CSS 和 JavaScript 文件在 Maven Web 应用程序项目中的位置？](https://stackoverflow.com/questions/7836930/where-do-css-and-javascript-files-go-in-a-maven-web-app-project)

* * *

也就是说，当您提到客户端验证时，您需要更加明确。如果你的意思是 Javascript 验证，那么像上面那样重构项目，然后描述你的问题，看看 JS 控制台；

但是使用 Struts2 最好使用[XML Validation](http://struts.apache.org/2.3.4/docs/form-validation-using-xml.html)验证输入，因为客户端验证不可靠：

假设我绕过了使用 FireBug 注入 HTML directyl 的 javascript 控件，或者我在运行时使用所需参数创建了一个表单并将其发送到服务器，或者我正在使用禁用 javascript 的浏览器......客户端不在您的控件，那么验证服务器端是一个好习惯。

# ruby-on-rails-3 - RSpec 给出错误“特征未注册：名称”

> ID：14188273
> 
> 赞同：27
> 
> 时间：2013-01-07T00:22:40.440
> 
> 标签：ruby-on-rails-3, rspec, factory-bot

我尝试使用 RSpec 在 Windows 上测试我的 Rails 3 应用程序。我已经编写了测试和工厂，但无法解决在命令行上运行 RSpec 时出现的问题。

这是其中一个测试文件：require 'spec_helper'

```
describe "SignIns" do
  it "can sign in" do
    user = FactoryGirl.create(:user)
    visit new_user_session_path
    fill_in "login", with: user.username
    fill_in "password", with: user.password
    click_on "sign in"
    current_user.username.should == user.username
  end
end 
```

这是 factory.rb：

```
factory :layout do
  name "layout1"
end

factory :club do
  sequence(:name) { |i| "Club #{i}" }
  contact_name "John Doe"
  phone "+358401231234"
  email "#{name}@example.com"
  association :layout
end

factory :user do
  sequence(:username) { |i| "user#{i}" }
  password 'password'
  email "test@example.com"
  club
end 
```

当我尝试运行 RSpec 时，会出现以下错误：

```
trait not registered: name
  #C: in 'object'
  #.spec/features/sign_in_spec.rb:11:in 'block (2 levels) in (top(required)) 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2014-07-03T13:39:17.963

我知道这是一个老问题，但万一其他人在搜索“未注册特征”时出现在这里：

当使用问题中的依赖属性（例如如何在工厂中`email`依赖）时，您需要将属性包装在花括号中，以便对其进行懒惰评估：`name``:club`

```
email {"#{name}@example.com"} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-07T00:35:11.320

这是一个 FactoryGirl 错误，您似乎正在使用（在 spec/features/sign_in_spec.rb:11）类似：

```
FactoryGirl.create :user, :name 
```

这仅在您为 Factory 注册了一个名为 name 的特征时才有效`user`，更多关于特征的信息请[点击此处](http://robots.thoughtbot.com/post/23673635798/remove-duplication-with-factorygirls-traits)

请注意，如果您只想覆盖已创建用户的名称，则语法为

```
FactoryGirl.create :user, name: 'THE NAME' 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2021-02-26T09:25:40.607

供未来读者参考：

什么不起作用 - **ArgumentError: Trait not registered: user_id**

```
 FactoryBot.define do
      factory :startup do
        user_id
        name { FFaker::Lorem.word }
        website { FFaker::Internet.uri(host: 'example.com') }
        founded_at { "01.01.2000" }
      end
    end 
```

当一切看起来都正确时，我是如何使用其中任何一个解决这个问题的：

1.  在 user_id 后放置空花括号

```
 FactoryBot.define do
      factory :startup do
        user_id {}
        name { FFaker::Lorem.word }
        website { FFaker::Internet.uri(host: 'example.com') }
        founded_at { "01.01.2000" }
      end
    end 
```

2.  将 user_id 移到其他使用块的助手下方：

```
 FactoryBot.define do
      factory :startup do
        name { FFaker::Lorem.word }
        website { FFaker::Internet.uri(host: 'example.com') }
        founded_at { "01.01.2000" }

        user_id
      end
    end 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-12-23T12:45:10.793

另一个迟到的答案。因为我忘记了我的模型是非常新的并且我没有迁移`test`数据库，所以我撞了头。所以这个属性实际上并不存在。

即必须事先运行

```
rails db:migrate RAILS_ENV=test 
```

# haskell - StateT 和 forM_

> ID：14188278
> 
> 赞同：0
> 
> 时间：2013-01-07T00:23:06.087
> 
> 标签：haskell, monads

在 forM_ 中，我怎么能开始`put`在 StateT monad 上工作？

```
loop :: Integer -> StateT World IO ()
loop passes = do
    (scene, b1) <- get
    forM_ [1..passes] $ \pass -> do
        let b2 = foo b1 pass
        -- other stuff --
        put (scene, b2) -- this no longer puts into the StateT monad 
```

还是有更好的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T01:23:01.550

我认为它工作正常，例如：

```
--I don't know what World is so I can't use your example

loop :: StateT Integer IO ()
loop = do
    forM_ [1..10] put
    x <- get
    liftIO $ print x 
```

像我期望的那样运行`evalStateT loop 0`打印。在引擎盖下这样做：`10``mapM_`

1.  实际上做地图，对于上面的例子，它返回一个列表`[StateT Integer IO ()]`

2.  做一个正确的折叠，如：`foldr (>>) (return ()) listOfMappedValues`

目前尚不清楚您的期望究竟是什么，但这会让您从`mapM_`

# java - 一个词的正则表达式否定不起作用（Java 7）

> ID：14188285
> 
> 赞同：0
> 
> 时间：2013-01-07T00:23:38.607
> 
> 标签：java, regex-negation

我正在尝试解析从网络设备返回的字符串以查看是否有错误。

我正在使用的测试是如果接收到的字符串中没有单词'invalid'，那么就没有错误。我不确定正则表达式是否正确。

```
Pattern noErrorsPattern = Pattern.compile("^(?!.*(invalid)).*$");   
Matcher noErrorMatcher = noErrorsPattern.matcher(receivedDataString);
if (!noErrorMatcher.matches()) {
    throw new Exception("input has error");
} 
```

receivedDataString 中没有字符串“invalid”。我通过将它粘贴到编辑器并搜索它来检查它 - 它没有找到。然而，在调试器中单步执行，异常将被抛出。

-- 澄清 -- 我简化了问题描述，但这可能有点误导。详细信息：对于每个命令，我都有一个“FieldPattern”正则表达式来从返回的文本中提取数据字段，另一个“NoError”正则表达式来检查是否有错误。NoError 正则表达式可以为类似“添加新条目”之类的命令精确设置，因此如果找到此字符串，则操作确实成功。如果没有为命令指定，则字符串中不出现“无效”的正则表达式是默认的 NoError 模式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T16:12:30.630

问题是您匹配多行。默认情况下，Java 正则表达式中的点与行终止符*不*匹配。

因此，您需要`Pattern.DOTALL`在编译正则表达式时指定。

注意：由于您的正则表达式已经锚定，您可以使用`.find()`而不是`.matches()`，因为后者将锚定正则表达式（有一天，您可能不想要那个）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T00:31:53.250

这里其实不需要正则表达式，可以使用[`contains`](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#contains%28java.lang.CharSequence%29)方法，即

```
if (receivedDataString.contains("invalid")) {
    throw new Exception("input has error");
} 
```

如果你想要一个正则表达式，你可以使用`".*invalid.*"`. 如评论中所述，如果您收到的字符串将跨越多行，请确保启用该[`Pattern.DOTALL`](http://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html#DOTALL)标志**或**使用 regex 代替`"(?s).*invalid.*"`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-07T00:50:03.373

看来你的逻辑是倒退的。如果模式匹配，则它包含字符串“invalid”，但当字符串不匹配时，您将抛出*异常*。（仅调用该模式`noErrorsPattern`并不能使其成为无错误模式:)。）

对于您发布的特定情况，您的正则表达式似乎过于复杂。怎么样：

```
Pattern errorsPattern = Pattern.compile("invalid");   
Matcher errorMatcher = errorsPattern.matcher(receivedDataString);
if (errorMatcher.find()) {
    throw new Exception("input has error");
} 
```

这等效于`receivedDataString.contains("invalid")`，但允许更一般的正则表达式搜索，您表明您需要其他情况。

# scala - 寻找 Scaladoc 帮助，reduceLeft

> ID：14188290
> 
> 赞同：6
> 
> 时间：2013-01-07T00:24:23.450
> 
> 标签：scala, scaladoc

说，我希望更好地了解将`reduceLeft`方法应用于`Array[String]`

scaladoc[说](http://www.scala-lang.org/api/current/index.html#scala.Array)： ![在此处输入图像描述](../Images/9a35a63e4ec1fd0aca372caf076e2023.png)

好的，我必须再问一次，这个方法有什么作用？更重要的是，如果我不能依靠 scaladoc 来告诉我，我在哪里可以找到？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-07T00:46:18.180

是的 - Scaladoc 条目可能会更有帮助。

另一个有用的文档来源是[Scala 文档](http://docs.scala-lang.org)站点，它对 reduceLeft 有[这样](http://docs.scala-lang.org/overviews/collections/trait-traversable.html)的说法：

> xs reduceLeft 运算
> 
> 在非空集合 xs 的连续元素之间应用二元运算 op，从左到右。

所以它所做的是通过连续应用二元运算符将集合减少为单个值。一些例子：

```
scala> Array(1, 2, 3, 4) reduceLeft (_ + _)
res2: Int = 10

scala> Array("foo", "bar", "baz") reduceLeft (_ + _)
res3: String = foobarbaz 
```

# c - 加密字符串与测试向量不同

> ID：14188293
> 
> 赞同：1
> 
> 时间：2013-01-07T00:25:12.077
> 
> 标签：c, openssl, aes

所以我试图用 OpenSSL 的 EVP-API 加密一些数据。但我没有收到与测试向量相同的结果。

这是主要功能

```
#include <stdio.h>
#include <windows.h>
#include <openssl\aes.h>
#include <openssl\evp.h>

int main()
{

    unsigned char *to = (unsigned char*)malloc(2056);
    ZeroMemory(to,2056);
    int *tosize;
    unsigned char* key = (unsigned char*)"0000000000000000000000000000000000000000000000000000000000000000";
    unsigned char* iv = (unsigned char*)"00000000000000000000000000000000";
    unsigned char* plain = (unsigned char*)"00000000000000000000000000000000";
    to = AESEncrypt(key,iv,plain,strlen((const char*)plain));
    if (to != 0)
    {
        for (int i = 0; i < strlen((const char*)to);i++)
        {
            printf("%x02", (int*)UCHAR(to[i]));
        }

    }
} 
```

这是我试图调用的函数。没有收到错误。每个电话都是真的（没有错误）。

```
 unsigned char* AESEncrypt(unsigned char* key, unsigned char*iv, unsigned char*plain, size_t plainsize)
{

EVP_CIPHER_CTX *x = (EVP_CIPHER_CTX*) malloc(sizeof(EVP_CIPHER_CTX));
EVP_CIPHER_CTX_init(x);
if (EVP_EncryptInit(x,EVP_aes_256_cbc(),key,iv))
{
    unsigned char* to = (unsigned char*) malloc(plainsize + EVP_CIPHER_CTX_block_size(x));
int tosize = 0;

if(EVP_EncryptUpdate(x,to,&tosize,plain,plainsize))
{
    if (EVP_EncryptFinal(x,to,&tosize))
    {
        return to;
    }   
  }
}

return 0;
} 
```

这是测试向量：

```
KEY = 0000000000000000000000000000000000000000000000000000000000000000
IV = 00000000000000000000000000000000
PLAINTEXT = 80000000000000000000000000000000
CIPHERTEXT = ddc6bf790c15760d8d9aeb6f9a75fd4e 
```

这就是我收到的内容：CIPHERTEXT = 5a0215028e.... 并且它还在继续。如您所见，这是不正确的。

我可能做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T00:54:15.530

CAVS 测试向量遵循相当直接的模式。从测试到测试，它们在一定程度上有所不同，但有一件事是非常一致的：

**十六进制字符串是 BYTE 表示；非字符数据**

因此，您的“测试”是完全错误的。您正在使用一个键、iv 和用字符 '0' 填充的纯文本，而不是**字节**值**0**。所以显然难怪你会得到不同的结果。

对于*该特定*测试，您的数组应该是：

```
unsigned char key[64] = {0};
unsigned char iv[16] = {0};
unsigned char plain[16] = {0}; 
```

此外，发送到加密函数的大小应该是纯文本的*字节数*。最后，理想情况下，您的加密函数应该将目标缓冲区和可修改的大小作为输出参数。

```
int AESEncrypt256(
    unsigned char* key,      // key must be 64 bytes wide.
    unsigned char *iv,       // IV must be 16 bytes wide.
    unsigned char *src,      // source buffer to encryt
    unsigned int src_len,    // length of source buffer in bytes
    unsigned char *dst,      // target buffer to write to
    unsigned int *dst_len);  // in: size of dst, out: bytes written to dst 
```

并对函数进行编码以匹配这些参数。你会很高兴你做到了。

CAVS 测试向量不是“文本”。它们是**字节**，应该这样对待。你现在需要处理好这个问题，因为如果你不这样做，蒙特卡洛测试可能会花费你一些头发。

帮自己一个**大忙，****现在**编写一些代码，将一串十六进制数字转换为`unsigned char`字节数组。您将需要相同的内容来翻译结果字符串。并让这些例程更加*稳固***，**因为您在编写这些测试时会经常使用它们。

 ** * *

**剧透警报**

*首先*测试字符串的奇数个字符。如果它是奇数，则翻译缓冲区中的第一个字节应基于，输入字符串中的第一个字节在`0c`哪里。从那时起（或者如果字符数是偶数，那么从一开始）在将字节字符串的其余部分转换为实际字节时一次抓取两个。这意味着这`c``char`

```
123456 
```

结果是一个字节数组

```
{ 0x12, 0x34, 0x56 } 
```

而这：

```
89AB1 
```

应该：

```
{0x08, 0x9A, 0xB1 } 
```*

# php - Kendo UI > 更新网格 > 内部服务器错误生成

> ID：14188294
> 
> 赞同：1
> 
> 时间：2013-01-07T00:25:28.630
> 
> 标签：php, javascript, mysql, kendo-ui

几天来，我一直在用头撞桌子……是时候寻求帮助了。

我正在尝试更新 Kendo UI 网格中的值。网格正确显示，弹出编辑器也是如此。美好的时光就这样结束了。情况如下：

1.  单击“编辑”>弹出窗口打开>单击“更新”（未进行更改）>弹出窗口关闭。结果 = 正如预期的那样。
2.  单击“编辑”>弹出窗口打开>单击“取消”>弹出窗口关闭。结果 = 正如预期的那样。
3.  单击“编辑”>弹出窗口打开>更新“客户端名称”字段>单击“更新”。结果 = 行中的值更改（在后台），弹出窗口保持打开状态，并显示一条警告，说明“未定义”。如果我然后关闭弹出窗口，则更改将丢失。作为此过程的一部分，还会生成 500 内部服务器错误。

这是我的剑道代码：

```
$(document).ready(function () {
                    var crudServiceBaseUrl = "assets/data/",
                        dataSource = new kendo.data.DataSource({
                            transport: {
                                read:  {
                                    url: crudServiceBaseUrl + "data.clients.php",
                                },
                                update: {
                                    url: crudServiceBaseUrl + "data.clients.update.php",
                                },
                                create: {
                                    url: crudServiceBaseUrl + "data.clients.create.php",
                                },

                                parameterMap: function(options, operation) {
                                    if (operation !== "read" && options.models) {
                                        return {models: kendo.stringify(options.models)};
                                    }
                                }
                            },
                            batch: true,
                            pageSize: 10,
                            error: function(e) {
                                alert(e.responseText);
                            },
                            schema: {
                                data: function(result) {     
                                  return result.data || result;
                                },
                                total: function(result) {
                                    var data = this.data(result);
                                    return data ? data.length : 0;
                                },
                                model: {
                                    id: "clientID",
                                    fields: {
                                        clientID: { editable: false, nullable: true },
                                        clientName: { validation: { required: true } },
                                    }
                                }
                            }
                        });

                    $("#grid").kendoGrid({
                        dataSource: dataSource,
                        pageable: true,
                        toolbar: ["create"],
                        columns: [
                            { field: "clientID", title: "Client ID" },
                            { field: "clientName", title: "Client Name"},
                            { command: "edit", title: "&nbsp;", width: 110 }],
                        editable: "popup"
                    });
                }); 
```

这是我的PHP：

```
include '../includes/connect.php';

    $clientName = mysql_real_escape_string($_POST["clientName"]);
    $clientID = mysql_real_escape_string($_POST["clientID"]);

    $rs = mysql_query("UPDATE cms_clients SET clientName = '" .$clientName ."' WHERE clientID = " .$clientID);

    if ($rs) {
        echo json_encode($rs);
    }
    else {
        header("HTTP/1.1 500 Internal Server Error");
        echo "Update failed for EmployeeID: " .$clientID;
    } 
```

哦，我知道这段代码存在潜在注入问题。那是第2步。

任何帮助，将不胜感激。

谢谢，@rrfive

# python - Python 编程帮助

> ID：14188296
> 
> 赞同：1
> 
> 时间：2013-01-07T00:26:10.467
> 
> 标签：python, python-3.x, computer-science

> **可能重复：**
> [为什么人们在 Python 脚本的第一行写 #!/usr/bin/env python？](https://stackoverflow.com/questions/2429511/why-do-people-write-usr-bin-env-python-on-the-first-line-of-a-python-script)

我目前正在自学 Python，我有一个关于 Python 的问题。在 Python 的许多示例中，我在顶部看到了同一行代码：

```
#!/usr/bin/env python 
```

我的问题是上面的代码有什么用途，为什么有必要？到目前为止，我一直在练习没有这行代码的 Python 代码。如果有人可以向我解释这一点，那将有很大帮助。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T00:28:40.617

`#!/usr/local/bin/env python`

您正在指定机器中 python 可执行文件的位置，脚本的其余部分需要解释。您指向的python 位于/usr/local/bin/python。

Python 并不总是安装在“/usr/local/bin/python”中。你也可以通过`#!/path/to/your/python/version`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T00:28:37.343

它描述了您的代码应该使用的 python 安装的位置。见[这里](http://www.velocityreviews.com/forums/t324727-what-does-usr-bin-env-python-do.html)和[这里](https://stackoverflow.com/questions/2429511/why-do-people-write-usr-bin-env-python-on-the-first-line-of-a-python-script)。

# php - 使用 HABTM 关系保存帖子标签

> ID：14188297
> 
> 赞同：0
> 
> 时间：2013-01-07T00:26:09.840
> 
> 标签：php, cakephp, has-and-belongs-to-many

我有一个`Post`模型和`Tag`模型，它们都通过 HABTM 关系正确设置。我的数据库中还有一个名为的表，`posts_tags`它根据命名约定正确命名。

但是，我一生都无法弄清楚如何将标签与帖子一起保存。在我的“添加帖子”页面上，我有这个：

```
<?php echo $this->Form->create('Post'); ?>
<?php echo $this->Form->input('Post.title'); ?>
<?php echo $this->Form->input('Post.body'); ?>
<?php echo $this->Form->input('Tag.name'); ?>
<?php echo $this->Form->input('Post.slug'); ?>
<?php echo $this->Form->end('Publish'); ?> 
```

在提交时调用此操作：

```
public function add() {
    if($this->request->is('post')) {            
        if($this->Post->saveAll($this->request->data)) {
            $this->Session->setFlash('Post published!');
            $this->redirect('/');
        } else {
            $this->Session->setFlash('Post unable to be saved!');
        }
    }

    $this->set('pageTitle', 'Compose new blog post');
} 
```

帖子保存但不保存标签或帖子与标签之间的关系，Cake 没有给我任何错误或警告。我该怎么做才能让 Cake 将标签与帖子一起保存并建立所需的关系？

`$this->request->data`编辑：这是使用以下方法保存到数据库中的内容的转储`saveAll()`：

```
array(
    'Post' => array(
        'title' => 'Blog post',
        'body' => 'Testing this post',
        'slug' => 'Blog-post'
    ),
    'Tag' => array(
        'name' => 'test-tag'
    )
) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T01:47:16.683

如果您的 Tag 与 Post 的关系是 hasMany，请尝试更改：

```
<?php echo $this->Form->input('Tag.name'); ?> 
```

至

```
<?php echo $this->Form->input('Tag.0.name'); ?> 
```

# ruby-on-rails - Rails 3.2 确定每个块中的最后一个元素

> ID：14188299
> 
> 赞同：0
> 
> 时间：2013-01-07T00:26:30.750
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2

给定以下代码，有没有办法测试迭代是否在最后一条记录上？我在我想测试的行上给出了一些伪代码。

```
@shipments.each do |shipment|
  puts shipment.id
  puts shipment.desc

  unless shipment.last?  #is there a way to do this line?
    puts "that was the last shipment"
  end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T00:39:03.267

没有内置方法，但最接近此方法的可能是：

```
unless shipment == @shipments.last 
```

这假设您正在处理一组 ActiveRecord 结果，因为如果`@shipments`是一个数组，例如`[1, 2, 3, 2]`,`2`将匹配第二个元素以及最后一个元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T00:39:29.707

通过使用[#last](http://www.ruby-doc.org/core-1.9.3/Array.html#method-i-last)方法，您可以做类似的事情，但我相信应该有更好的方法来实现这一点

```
@shipments.each do |shipment|
  puts shipment.id
  puts shipment.desc

  unless shipment == @shipments.last  #is there a way to do this line?
    puts "that was the last shipment"
  end
end 
```

# php - 复选框数组，无法更新 foreach 中的多行

> ID：14188303
> 
> 赞同：-1
> 
> 时间：2013-01-07T00:27:01.253
> 
> 标签：php, codeigniter, sql-update

我在更新数据库中的行时遇到了一些问题。

我有多个复选框的形式

```
<input type="checkbox" name="checkbox[]" value="75">
<input type="checkbox" name="checkbox[]" value="76">
<input type="checkbox" name="checkbox[]" value="77">
<input type="checkbox" name="checkbox[]" value="78"> 
```

现在，我想更新那些用复选框选中的行。列名是“pm_id”，表名是“pm”。“to_removed”是我希望更新的列名。

```
$data = array(
    'to_removed' => 1
);
$checked = $this->input->post('checkbox');
foreach($checked as $check)
{               
    $this->db->where('pm_id', $check);
$this->db->update('pm', $data); 

} 
```

现在，即使我选中每个复选框，它也只会删除一个。可能是什么问题呢？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-07T00:51:31.140

才发现问题。似乎每个复选框都有相同的值：D

编辑：我的意思是，上面的代码不完全是我的。我的只是其他值。

# php - $_GET['page'] 没有通过

> ID：14188305
> 
> 赞同：0
> 
> 时间：2013-01-07T00:27:50.940
> 
> 标签：php, html

我的表格有点问题，我只是希望你能回答我的问题。基本上，有一个`index.php`包含页眉、页脚，在它们之间，我放了一个`require $_GET['page'].'.php';` All my pages have links to `index.php?page=pagename`，它工作得几乎完美。我唯一的问题是 page 变量不会通过发送其他变量`$_GET`的表单，尽管如果表单为空或有变量通过 发送到下一页`$_POST`，它会很好用。每当我尝试`$_GET['page']`使用 url 直接进入动作引号的其他页面时，它就不起作用，表单变量将显示在页面中，`var_dump()`但页面不会。这是代码，在我看来这真的不那么重要。

*索引.php*：

```
if (!isset($_GET['page'])) //This returns TRUE
{
echo redirect_tempo(500, 'index.php?page=home');    
}
    elseif ($_GET['page']=="index") 
    {
    echo redirect_tempo(500, 'index.php?page=home');        
    }
        elseif (file_exists($_GET['page'].".php"))
        {
        require $_GET['page'].'.php';
        }
            else 
            {
            echo redirect_tempo(500, 'index.php?page=404');
            } 
```

*测试.php*

```
<form action="index.php?page=test" method="GET">
Obtenir les disponibilités des hôtels pour la date suivante : 
<input type="text" name="date" size="12" id="inputField" /><br /><br />
<input type="submit" value="Rechercher" />
</form> 
```

在这种情况下 var_dump 只会显示`$_GET['date']`

我很确定这是一个众所周知的错误和非常愚蠢的错误，但我真的在互联网上找不到任何东西（不容易寻找......）

非常感谢你的帮助 ：）

巴斯蒂安

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T00:31:00.757

如果您使用 GET 方法，那么只会将表单元素附加到链接。来自表单操作的 GET 参数将被忽略。试试这个：

```
<form action="index.php" method="GET">
    <input type="hidden" name="page" value="test" />
    Obtenir les disponibilités des hôtels pour la date suivante : 
    <input type="text" name="date" size="12" id="inputField" /><br /><br />
    <input type="submit" value="Rechercher" />
</form> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T00:30:36.557

尝试添加隐藏的输入字段。

```
<input type="hidden" name="page" value="test" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T00:41:35.663

尝试将操作字段留空并通过隐藏的输入字段发送 GET 变量，这可能会解决您的问题。

```
<form action="" method="GET">
Obtenir les disponibilités des hôtels pour la date suivante : 
<input type="text" name="date" size="12" id="inputField" /><br /><br />
<input type="hidden" name="page" value="test"/>
<input type="submit" value="Rechercher" />
</form> 
```

# regex - R中的正则表达式帮助

> ID：14188308
> 
> 赞同：1
> 
> 时间：2013-01-07T00:28:16.477
> 
> 标签：regex, r

我有看起来像这样的数据，其中负号是数字末尾的后缀。

```
"general_amount"
"0000000441244"
"0000000127769-"
"0000000043819"
"0000000522600-" 
```

有人可以帮我找到一个正则表达式来产生下面的所需输出。

```
"general_amount"
 441244
-127769
 43819
-522600 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-07T00:35:21.293

```
sub('^0*([^-]*)(-?)$', '\\2\\1', x)

## [1] "general_amount" "441244"         "-127769"        "43819"          "-522600" 
```

`^0*`匹配所有前导`0`字符。
`[^-]*`匹配所有非`-`字符。
`-?`匹配零个或一个`-`字符。
最后，`$`匹配字符串的结尾。

中间两块用`()`、 as`\\1`和捕获`\\2`，并以相反的顺序打印。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T07:39:27.930

使用*gsub*，还有另一个想法。

这个想法是将输入分成3个元素

1.  系列 0 :(^0+)
2.  数字系列：（[0-9]+）
3.  找到 '-' 1 次或 0 次：(-?)"

    ```
     as.numeric(gsub("(^0+)([0-9]+)(-?)","\\3\\2",tt))
       [1]  441244 -127769   43819 -522600 
    ```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T05:31:25.697

老兄，我花了3个小时才找到你问题的答案

```
sed -re 's/[^a-zA-Z0-9]0+([0-9]+)(-?)/\2\1/g' anyfile.txt 
```

但最后我做到了。可能有一些缺点，但我几乎明白了

# java - Java 应用程序嵌入谷歌地图

> ID：14188313
> 
> 赞同：1
> 
> 时间：2013-01-07T00:28:49.137
> 
> 标签：java, google-maps, system

有没有办法将谷歌地图嵌入到 Java 桌面应用程序中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-05-17T09:46:44.273

您可以使用 JxMaps 组件，它封装了 JavaScript 层并提供 Java 接口用于与 Google Maps 交互。它具有`MapBrowser`摆动组件，可以轻松插入任何摆动应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T01:49:13.093

Google Maps 是一个基于 javascript 的 api，因此您可以将 web 视图嵌入到您的桌面应用程序中。

但是，请注意，您需要向 Google 申请许可才能执行此操作。[在https://developers.google.com/maps/licensing](https://developers.google.com/maps/licensing)查看他们的许可页面底部

# android - 使用原始 MapView 浮动按钮

> ID：14188314
> 
> 赞同：1
> 
> 时间：2013-01-07T00:29:03.050
> 
> 标签：android, android-button, google-maps-android-api-2

在新的谷歌地图 api 出现之前，我能够实现一个谷歌地图片段，我会通过将按钮添加到 xml 文件中来添加按钮以浮动在地图上。我可以在原始地图视图演示活动的 xml 文件中使用相同的技术。演示活动是一个片段活动，但如果感觉它无法实际使用片段。它只是用 xml 文件中的地图填充其视图。

是否可以强制地图片段加载特定布局，而无需创建扩展地图片段的片段并且必须自己处理地图视图生命周期。我知道通常不建议这样做。

用于按钮的旧 XML

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/frame"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="vertical" >

<com.google.android.maps.MapView
    android:id="@+id/mapview"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:apiKey="0xR1g8qRRLoUp8-8gd7050zKWtMQCMDDHhizisw"
    android:clickable="true" >

    android:apiKey = "APIKEY" >
</com.google.android.maps.MapView>

<ZoomControls
    android:id="@+id/zoom"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentTop="true"
    android:layout_centerHorizontal="true"
    android:padding="10dp" />

<ImageButton
    android:id="@+id/button"
    android:layout_width="80dp"
    android:layout_height="80dp"
    android:layout_alignParentBottom="true"
    android:layout_alignParentLeft="true"
    android:background="@null"
    android:contentDescription="@string/description"
    android:padding="20dp"
    android:src="@drawable/button" > 
```

来自 rawMapViewDemo 的 XML

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/frame"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="vertical" >

<com.google.android.gms.maps.MapView
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/map"
    android:layout_width="match_parent"
    android:layout_height="match_parent" />

<ImageButton
    android:id="@+id/cacbutton"
    android:layout_width="80dp"
    android:layout_height="80dp"
    android:layout_alignParentBottom="true"
    android:layout_alignParentLeft="true"
    android:background="@null"
    android:contentDescription="@string/description"
    android:padding="20dp"
    android:src="@drawable/taxi" >
</ImageButton> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T23:57:01.193

我试图以编程方式构建我的地图片段，这不允许我做我想做的事。将片段添加到布局文件确实允许我正确添加按钮。现在只是显示和隐藏地图片段以及视图未更新的问题。下面的 XML 对我有用。请注意，我实际上使用的是 2 个地图片段。我还没有弄清楚如何为两个片段使用一个按钮。我对想法持开放态度。

```
<FrameLayout
    android:id="@+id/fragment_container"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

    <RelativeLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent" >

        <fragment
            android:id="@+id/map1"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            class="com.google.android.gms.maps.SupportMapFragment" />

        <ImageButton
            android:id="@+id/cacbutton"
            android:layout_width="80dp"
            android:layout_height="80dp"
            android:layout_alignParentBottom="true"
            android:layout_alignParentLeft="true"
            android:background="@null"
            android:contentDescription="@string/description"
            android:padding="20dp"
            android:src="@drawable/button" >
        </ImageButton>
    </RelativeLayout>

    <RelativeLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent" >

        <fragment
            android:id="@+id/map2"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            class="com.google.android.gms.maps.SupportMapFragment" />

        <ImageButton
            android:id="@+id/cacbutton2"
            android:layout_width="80dp"
            android:layout_height="80dp"
            android:layout_alignParentBottom="true"
            android:layout_alignParentLeft="true"
            android:background="@null"
            android:contentDescription="@string/description"
            android:padding="20dp"
            android:src="@drawable/button" >
        </ImageButton>
    </RelativeLayout>
</FrameLayout> 
```

# excel - TRUE 和 FALSE 在 SUM() 中不起作用

> ID：14188320
> 
> 赞同：35
> 
> 时间：2013-01-07T00:29:33.513
> 
> 标签：excel, excel-formula

我在一列中有布尔值：

```
 A
1  TRUE
2  FALSE
3  TRUE
4  TRUE 
```

我意识到在 Excel 中返`=TRUE+TRUE`​​回`2`和`=TRUE+FALSE`返回`1`意味着`TRUE`等于`1`和`FALSE`等于`0`。但是，无论它是否是数组公式样式，`SUM(A1:A4)`总是返回......我希望它是（范围内的数量）。`0``3``TRUE`

一种方法`3`是使用`{=SUM(IF(A1:A4,1,0))}`（数组公式样式），我觉得这是多余的......谁能想到比这更简单的解决方案？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-01-07T00:42:21.713

我在 COUNTIFS 条件为 TRUE 的范围内取得了成功

```
=COUNTIF(D2:D51,TRUE) 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2013-01-07T00:33:07.383

您可以尝试为范围添加前缀`--`并作为数组输入。`--`会将布尔值转换为它们的整数等价物：

```
=SUM(--(A1:A4)) 
```

根据有关该功能的[文档](http://office.microsoft.com/en-us/excel-help/sum-HP005209290.aspx)`SUM`：

> 如果参数是数组或引用，则仅计算该数组或引用中的数字。数组或引用中的空单元格、逻辑值或文本将被忽略。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2016-10-13T13:42:10.430

如果您想在真/假字段上使用 sum，您可以将真/假条件乘以 1，以便其计算结果为 0 或 1。然后您的 sum 函数将适用于该列。

# c# - 使用盐进行安全密码散列，但是将其存储在本地 cookie 中呢？

> ID：14188325
> 
> 赞同：2
> 
> 时间：2013-01-07T00:29:59.600
> 
> 标签：c#, asp.net, passwords, cryptography

我最近阅读了一篇关于使用“salt”安全地散列用户密码的有趣文章。（这是[原始文章](http://crackstation.net/hashing-security.htm)，不幸的是，在发这篇文章时它似乎已经关闭，所以[这里是](http://webcache.googleusercontent.com/search?q=cache%3a-KnqE3F0Me8J%3acrackstation.net/hashing-security.htm%20&cd=1&hl=en&ct=clnk&gl=us)缓存版本。）

我完全同意这个概念，除了我似乎无法找到一种将用户登录信息安全地存储在本地 cookie（或会话）中的方法，因为 salt + PBKDF2 哈希组合每次都是随机完成的。为了更好地理解我的意思，让我复制[文章](http://webcache.googleusercontent.com/search?q=cache%3a-KnqE3F0Me8J%3acrackstation.net/hashing-security.htm%20&cd=1&hl=en&ct=clnk&gl=us#aspsourcecode)中的 C# 代码：

```
using System;
using System.Text;
using System.Security.Cryptography;

namespace PasswordHash
{
    /// <summary>
    /// Salted password hashing with PBKDF2-SHA1.
    /// Author: havoc AT defuse.ca
    /// www: http://crackstation.net/hashing-security.htm
    /// Compatibility: .NET 3.0 and later.
    /// </summary>
    class PasswordHash
    {
        // The following constants may be changed without breaking existing hashes.
        public const int SALT_BYTES = 24;
        public const int HASH_BYTES = 24;
        public const int PBKDF2_ITERATIONS = 1000;

        public const int ITERATION_INDEX = 0;
        public const int SALT_INDEX = 1;
        public const int PBKDF2_INDEX = 2;

        /// <summary>
        /// Creates a salted PBKDF2 hash of the password.
        /// </summary>
        /// <param name="password">The password to hash.</param>
        /// <returns>The hash of the password.</returns>
        public static string CreateHash(string password)
        {
            // Generate a random salt
            RNGCryptoServiceProvider csprng = new RNGCryptoServiceProvider();
            byte[] salt = new byte[SALT_BYTES];
            csprng.GetBytes(salt);

            // Hash the password and encode the parameters
            byte[] hash = PBKDF2(password, salt, PBKDF2_ITERATIONS, HASH_BYTES);
            return PBKDF2_ITERATIONS + ":" +
                Convert.ToBase64String(salt) + ":" +
                Convert.ToBase64String(hash);
        }

        /// <summary>
        /// Validates a password given a hash of the correct one.
        /// </summary>
        /// <param name="password">The password to check.</param>
        /// <param name="goodHash">A hash of the correct password.</param>
        /// <returns>True if the password is correct. False otherwise.</returns>
        public static bool ValidatePassword(string password, string goodHash)
        {
            // Extract the parameters from the hash
            char[] delimiter = { ':' };
            string[] split = goodHash.Split(delimiter);
            int iterations = Int32.Parse(split[ITERATION_INDEX]);
            byte[] salt = Convert.FromBase64String(split[SALT_INDEX]);
            byte[] hash = Convert.FromBase64String(split[PBKDF2_INDEX]);

            byte[] testHash = PBKDF2(password, salt, iterations, hash.Length);
            return SlowEquals(hash, testHash);
        }

        /// <summary>
        /// Compares two byte arrays in length-constant time. This comparison
        /// method is used so that password hashes cannot be extracted from
        /// on-line systems using a timing attack and then attacked off-line.
        /// </summary>
        /// <param name="a">The first byte array.</param>
        /// <param name="b">The second byte array.</param>
        /// <returns>True if both byte arrays are equal. False otherwise.</returns>
        private static bool SlowEquals(byte[] a, byte[] b)
        {
            uint diff = (uint)a.Length ^ (uint)b.Length;
            for (int i = 0; i < a.Length && i < b.Length; i++)
                diff |= (uint)(a[i] ^ b[i]);
            return diff == 0;
        }

        /// <summary>
        /// Computes the PBKDF2-SHA1 hash of a password.
        /// </summary>
        /// <param name="password">The password to hash.</param>
        /// <param name="salt">The salt.</param>
        /// <param name="iterations">The PBKDF2 iteration count.</param>
        /// <param name="outputBytes">The length of the hash to generate, in bytes.</param>
        /// <returns>A hash of the password.</returns>
        private static byte[] PBKDF2(string password, byte[] salt, int iterations, int outputBytes)
        {
            Rfc2898DeriveBytes pbkdf2 = new Rfc2898DeriveBytes(password, salt);
            pbkdf2.IterationCount = iterations;
            return pbkdf2.GetBytes(outputBytes);
        }
    }
} 
```

如您所见，验证密码的唯一方法是`ValidatePassword`使用纯文本密码进行调用。在我之前的普通 SHA1 实现中，为了在本地浏览器中存储用户登录信息，我将该 SHA1 值放入 cookie 中，并将其与存储在服务器上每个页面的数据库中的值进行比较。但是你如何用这种“安全”的方法做同样的事情呢？

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T01:22:37.110

您不想将散列密码存储在 cookie 中，因为这与将密码本身存储在 cookie 中是一样的。如果哈希是您登录所需的全部，那么它就是密码。您想用随机盐对用户密码进行哈希处理的原因不是为了保护登录过程，而是为了保护您的密码表。如果攻击者窃取了您的密码表，并且每个密码都没有使用唯一的盐进行哈希处理，那么他/她很容易找出许多密码。始终使用唯一的盐对您的用户密码进行哈希处理。用散列密码存储这个盐很好。如果您想要一种安全的方式来使用散列来根据 cookie 中的数据对用户进行身份验证，您将需要采用临时凭证或会话的方向。我能想到的最简单的方法如下：

1.  当您的用户使用他的密码登录时，创建一个“会话”。分配一个值以唯一标识此会话，存储会话创建的时间（以毫秒为单位），并创建一个随机值作为盐。

2.  用盐散列会话的 id。将此哈希和会话 ID 保存在用户的 cookie 中。

3.  每次请求页面时，再次执行哈希并将其与存储在用户 cookie 中的值进行比较。如果值匹配并且自会话创建以来没有经过太多时间，您的用户可以查看该页面。否则，让他们使用密码再次登录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T01:26:14.247

哈希存储在服务器上，作为将明文密码发送到服务器时的用户身份验证的一部分，计算的盐（每个用户）存储在安全数据库中并添加到密码中，并根据密码 + 哈希计算加密结果。

Cookie 是错误的方法，因为它们会过期并且 Web 客户端没有理由需要 salt。

[加盐密码：最佳实践？](https://stackoverflow.com/questions/674904/salting-your-password-best-practices)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T00:33:40.527

一般来说，散列函数的盐是您根据规则计算的东西。例如，您使用用户标识符作为盐本身。您使用“用户名”值在数据库中查找用户，然后使用用户 ID 作为盐。这样，您不必将盐存储在任何地方，并且每个散列值的盐是不同的。

# asp.net - 在客户端覆盖 RequriedFieldValidator？

> ID：14188327
> 
> 赞同：-1
> 
> 时间：2013-01-07T00:30:04.623
> 
> 标签：asp.net, .net, requiredfieldvalidator

是否可以在客户端覆盖RequiredFieldValidator 的功能？我想增强它并用于页面中的所有控件。请指导。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T00:44:30.943

为此，您必须创建一个继承自此`RequiredFieldValidator`自定义服务器控件的创建实例的类并添加到您的页面。实际上，我认为您可以循环所有控件并更改您的修改，如下所示：

```
foreach(Control control in Page.Controls)
{
   if (control is RequiredFieldValidator)
   {
      RequiredFieldValidator rfv = (RequiredFieldValidator) control;
      // do your customizations for all RequiredFieldValidator
      rfv.ErrorMessage = "...";
      rfv.SetFocusOnError = true;
   }
} 
```

# dns - Opera Turbo 使用什么域？

> ID：14188331
> 
> 赞同：2
> 
> 时间：2013-01-07T00:31:08.057
> 
> 标签：dns, opera, opera-turbo

我确定，我已经在设置中阻止了 Opera Turbo 的使用。

第一次，Opera 不断显示弹出消息，建议激活此功能。然后它们消失了，后来，在一次自动更新之后，Opera 再次激活了它。

现在我再次禁用它，但我想在未来禁止他们用于此功能的服务器。

他们为此功能使用了哪些域？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-09T06:14:04.053

Opera Turbo 使用`global-turbo-1.opera-mini.net`可通过搜索引擎轻松找到。

两个注意事项：

*   它可以映射到任何 IP 地址，具体取决于世界上的区域。
*   它可以随时改变。

**如果**它是浏览器一侧的设置错误，则阻止域名不会解决您的问题。域被阻止，设置到位，然后您的请求将陷入死胡同。如果有任何关于您的特定配置的信息，我正在尝试检查 Opera 错误报告。

# c - C: 使用 scanf() 构造输入

> ID：14188332
> 
> 赞同：1
> 
> 时间：2013-01-07T00:31:44.023
> 
> 标签：c, scanf

有没有办法控制**scanf()**如何分离输入？

```
scanf("%10s %10s", array1, array2); 
```

以上工作正常，按空格分隔。但是，我可以使用不同的分离信号吗？

因为如果我想用逗号而不是空格拼接输入，这些似乎都不起作用：

```
scanf("%10s,%10s", array1, array2);
scanf("%10s, %10s", array1, array2); 
```

是什么赋予了？我正在阅读的一本书声称可以使用任何字符将输入与**scanf()**分开，但未能解释如何做到这一点。此外，如果可以使用替代字符，是否也可以使用比单个字符更广泛的标准？（即值类型、语句等）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T00:52:11.617

使用字符类：

```
#include <stdio.h>

int main(int argc, const char **argv) {
  char s1[10], s2[10];
  const char *str = "word1,word2";
  sscanf(str, "%[^,],%s", s1, s2);
  printf("%s -- %s\n", s1, s2);
  return 0;
} 
```

或者你可以更具体：

```
sscanf(str, "%[^,],%[^,]", s1, s2); 
```

这也将捕获空白`s2`

要拆分多个字符，您可以使用`strstr`：

```
#include <stdio.h>
#include <string.h>
int main(int argc, const char **argv) {
  const char *str = "word1fooword2fooword3", *foo = "foo", *ptr;
  const char *eofstr = str;
  for (ptr = str; eofstr; ptr = eofstr + strlen(foo)) {
    char word[10];
    eofstr = strstr(ptr, foo);
    if (eofstr) {
      size_t len = eofstr - ptr;
      strncpy(word, ptr, len);
      word[len] = 0;
      printf("%s\n", word);
    } else {
      strcpy(word, ptr);
      printf("%s\n", word);
    }   
  }
  return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T00:38:19.473

您实际上需要更改 scanf 的默认分隔符。这是您问题的确切答案。

[http://gpraveenkumar.wordpress.com/2009/06/10/how-to-use-scanf-to-read-string-with-space/](http://gpraveenkumar.wordpress.com/2009/06/10/how-to-use-scanf-to-read-string-with-space/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-07T00:45:04.647

您可以在 rect parentesis 之间使用它来“转义”字符分隔符，但老实说，我从未使用过该解决方案。相反，您可以使用[fgets](http://pubs.opengroup.org/onlinepubs/007904875/functions/fgets.html)和[sscanf](http://linux.die.net/man/3/sscanf)。在我看来，这是一种更“可靠”的方式。fgets 可以从标准输入读取，sscanf 可以在字符串中查找逗号和任何其他字符。同样， fgets 使用 ctrl+c 返回 null ， sscanf 返回成功读取的次数。希望这可以帮助。

# mongodb - MongoDB 应该使用 Memcache 还是 Redis 缓存？

> ID：14188334
> 
> 赞同：3
> 
> 时间：2013-01-07T00:31:46.820
> 
> 标签：mongodb, memcached, redis

我将 MongoLab 用作托管 MongoDB，使用 Memcache 或 Redis 缓存响应是否有意义？

我读到使用 Redis 作为缓存很常见，但另一方面我读到如果 MongoDB 不分页，MongoDB 和 Redis 可能具有相似的性能。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-07T00:37:33.120

这完全取决于您的应用程序。像 MongoDB 或 SQL 数据库这样的数据库系统实际上并不是很慢。当您的应用程序的负载不是很高时，缓存可能不会改善那么多。

你应该在正确的时候使用缓存。当访问您的数据库（或任何其他资源）很慢时。所以首先你应该确定这一点。如果是这种情况，您可以继续使用 memcached 或 Redis 进行缓存（或任何其他工具）。它将承担您数据库上的一些负载。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T00:34:46.813

我曾经研究过这个，我发现 Mongodb 的缓存足够好，你不需要 memcache 或 redis。

# php - PHP-如果某些参数通过了短代码来清除屏幕？

> ID：14188337
> 
> 赞同：-2
> 
> 时间：2013-01-07T00:32:17.647
> 
> 标签：php, html

假设我有一个简单的 php 索引网站页面。

我需要根据某些参数何时传递到索引页面来清除屏幕。检查传递参数的代码可能出现在索引页的任何位置。

如果参数未传递，则页面加载正常，如果传递，则清除/空白屏幕，或者弹出一个空白窗口以回显。

我想尽可能高效地做到这一点，因为它会导致我的回声语句（如果可能的话）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T00:37:27.087

如果我理解这个问题，您希望您的 php 不回显任何内容，或者回显页面，具体取决于某些变量。如果这是你想要的，你可以把它放在你的 php 的顶部

```
<?php
    if(condition){return;}
    //the rest of you page goes here

    ?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T00:37:35.003

你不能简单地在 javascript 中引用一个标签来

```
<body></body> 
```

然后从那里设置innerhtml值？

例如，我们可以使用一个按钮，它将使用

```
document.body.innerHTML 
```

属性将页面设置为我们想要的任何内容。. .

```
document.body.innerHTML = 'cleared'; 
```

或者 。. .

```
<button name="btnClear" id="btnClearMe" onclick="document.body.innerHTML = 'cleared'" >Clear Page</button> 
```

完整代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>
</head>
<body id="bdContent">
    <button name="btnClear" id="btnClearMe" onclick="document.body.innerHTML = 'cleared'" >Clear Page</button>
</body>
</html> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T00:53:46.690

```
<?php
if($_GET['parameter'] == 'blank'){
  echo '';
}else{
  echo 'something';
}
?> 
```

*   mysite.com（这会显示一些东西）
*   mysite.com?parameter=blank（这不会显示任何内容）

# actionscript-3 - AS3 鼠标悬停动作在后台更改影片剪辑

> ID：14188338
> 
> 赞同：0
> 
> 时间：2013-01-07T00:32:29.183
> 
> 标签：actionscript-3, mouseover, movie

我尝试在正在运行的影片剪辑上的不同位置放置一些 MouseOver 动作。每个点都会在将鼠标悬停在特定点上时更改影片剪辑。当背景中的剪辑发生变化时，MouseOver 按钮（不可见）应保持不变。

当您将鼠标悬停在按钮上时，我首先尝试从一个场景切换到另一个场景，但这可能不是最好的解决方案。

我的问题是我刚开始使用 AS3 编程，所以我的代码示例可能不是很有帮助......

```
 btn.addEventListener(MouseEvent.ROLL_OVER, btnOver);
    btn.addEventListener(MouseEvent.ROLL_OUT, btnOut);

    function btnOver(event:MouseEvent):void{  
    btn.gotoAndPlay("scene 2");
    }
    function btnOut(event:MouseEvent):void{
    btn.gotoAndPlay("main");
    } 
```

是否有一些可能性甚至是解决它的好方法？

PS：也许有更好的方法来解决它（fEJavascript？）告诉我！

# css - CSS Font Face 在 Firefox 或 IE8 中不起作用

> ID：14188339
> 
> 赞同：2
> 
> 时间：2013-01-07T00:32:51.517
> 
> 标签：css, firefox, internet-explorer-8, font-face

我的字体在 Firefox 或 IE8 中无法使用 :(

文件在正确的运动中，这是我的 css 代码：

```
@font-face {
                font-family: 'SnellRoundhand-Script';
                src: url('snellroundhandscript.eot');
                src: url('snellroundhandscript.eot?#iefix') format('embedded-opentype'),
                         url('snellroundhandscript.woff') format('woff'),
                         url('snellroundhandscript.ttf') format('truetype'),
                         url('snellroundhandscript.svg#snellroundhandscript') format('svg');
                font-weight: normal;
                font-style: normal;
        } 
```

文件会被破坏吗？还是我的 CSS 有问题？

我在该代码下方也有此代码：

```
@font-face {
                font-family: 'Zapfino';
                src: url('Zapfino.eot');
                src: url('Zapfino.eot?#iefix') format('embedded-opentype'),
                         url('Zapfino.woff') format('woff'),
                         url('Zapfino.ttf') format('truetype'),
                         url('Zapfino.svg#Zapfino') format('svg');

                font-weight: normal;
                font-style: normal;
        } 
```

你可以在这里查看我的问题....http://hearingaidneeds.com/

提前致谢，J

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T00:37:08.713

看起来您的 .eot 文件对于 IE 已损坏，我看不出 FF 不应该工作的合乎逻辑的原因。尝试改用[这个字体创建](http://fontsquirrel.com/fontface/generator)器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T05:09:55.787

Firefox 无法工作的原因是您的 WOFF 文件不是有效的 WOFF 文件。值得看看 Web 控制台，它会告诉你这些事情。我的说，在你的网站上：

```
[00:07:47.442] downloadable font: table 'cmap': failed to parse table (font-family: "SnellRoundhand-Script" style:normal weight:normal stretch:normal src index:1)
source: http://hearingaidneeds.com/wp-content/themes/twentyeleven/snellroundhandscript.woff @ http://hearingaidneeds.com/wp-content/themes/twentyeleven/style.css
[00:07:47.442] downloadable font: rejected by sanitizer (font-family: "SnellRoundhand-Script" style:normal weight:normal stretch:normal src index:1)
source: http://hearingaidneeds.com/wp-content/themes/twentyeleven/snellroundhandscript.woff @ http://hearingaidneeds.com/wp-content/themes/twentyeleven/style.css
[00:07:47.613] downloadable font: table 'cmap': failed to parse table (font-family: "SnellRoundhand-Script" style:normal weight:normal stretch:normal src index:2)
source: http://hearingaidneeds.com/wp-content/themes/twentyeleven/snellroundhandscript.ttf @ http://hearingaidneeds.com/wp-content/themes/twentyeleven/style.css
[00:07:47.613] downloadable font: rejected by sanitizer (font-family: "SnellRoundhand-Script" style:normal weight:normal stretch:normal src index:2)
source: http://hearingaidneeds.com/wp-content/themes/twentyeleven/snellroundhandscript.ttf @ http://hearingaidneeds.com/wp-content/themes/twentyeleven/style.css
[00:07:47.613] downloadable font: no supported format found (font-family: "SnellRoundhand-Script" style:normal weight:normal stretch:normal src index:4)
source: (end of source list) @ http://hearingaidneeds.com/wp-content/themes/twentyeleven/style.css 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T05:17:20.073

尝试使用[Font2Web](http://www.font2web.com/)，这将转换您的字体并创建 css 文件和演示 HTML 文件，以向您展示如何在您的网站上使用 webfonts - 使用 CSS @font-face

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-07T08:32:13.237

字体文件可能已损坏，并且可能已损坏。这在使用非法字体副本时并不少见。在使用 Snell Roundhand 和 Zapfino 等字体的问题上，请联系[Linotype](http://www.linotype.com/)、版权所有者或其经销商。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-07T01:18:40.813

当我尝试将其上传到 font-squirrel 时出现此错误。就像 djthoms 所说的那样，您的文件已损坏。

> www.fontsquirrel.com 上的页面说：
> 
> 字体“snell_roundhand_script.ttf”已损坏，无法转换。

# python - 访问链接文本中的字符串

> ID：14188348
> 
> 赞同：0
> 
> 时间：2013-01-07T00:33:51.650
> 
> 标签：python, html, django

我有一个大的 html 图像页面，这些图像单独链接到一个 html 表单。然后表单的操作指向处理键值对并写入 yaml 文件的 Django 脚本。所有这些图像都有一个“图像 id”，可以从链接的 html 中轻松访问（即我有一堆

```
<a href .../html_form><img src=longurl.../image_id /></a href .../html_form.> 
```

生成页面的行）。我需要一些方法来获取字符串“image_id”作为表单发布到 django 脚本并写入 yaml 文件的键值对之一（'ID_of_image'：image_id）。有人建议我如何修改表单的操作

```
<form name=form_name action="serverpath/django_script_function" method="post"> 
```

到

```
<form name=form_name action="serverpath/django_script_function/image_id" method="post"> 
```

从我可以通过谷歌搜索得知，我应该使用某种动态生成 html 的方式来执行此操作。我的问题如下：

(i) 如何访问表单或脚本中的字符串 image_id 以动态生成表单？

(ii) 对表格的唯一修改是上述操作；我真的需要使用一些东西来动态生成 html 来做到这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T00:59:01.463

如我所见，您正在寻找一种将参数从锚元素传递到表单的方法。有多种方法可以实现这一目标。

例如，您可以将图像 id 作为表单的 GET 参数包含在内；生成表单时，将其作为隐藏输入的值插入：

```
<!-- image link template -->
<a href=".../html_form?image_id={{img_id}}"><img src=".../imgs/{{img_id}}"></a> 

<!-- form template; the img_id variable should be accessible from the request 
object of your view, like request["image_id"] -->
<form name="form_name" action="serverpath/django_script_function">
    <input name="image_id" type="hidden" value="{{img_id}}"></input>
    <!-- other form fields.. -->
</form> 
```

# java - 如何测试 String 是否为 URL 格式？

> ID：14188350
> 
> 赞同：2
> 
> 时间：2013-01-07T00:34:08.547
> 
> 标签：java, android, string, url, format

好的，我在这里缺少一个简单的方法，但我正在画一个空白。我有一个自定义`ListView`，它从外部存储上的文件中获取一些图像，一些来自互联网，如果它们都没有显示来自可绘制文件夹的 PNG 文件。对于我的逻辑，我需要能够判断`String`（图像位置）是 URL 类型还是文件类型。

那么，我如何才能判断 a`String`是 URL 格式还是文件格式？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T00:49:14.237

用于`URI`尝试解析您的字符串：

```
try {
    new URI(theString);
} catch (URISyntaxException e) {
    // Certainly not an URL
} 
```

您将不得不进行额外的检查，例如检查此 URI 的方案（或调用`.toURL()`它并检查它是否不会抛出`MalformedURLException`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T00:36:28.220

格式错误的 URL 会给您一个例外。要知道您的 URL 是否处于活动状态，您必须与 URL 进行握手。

我知道没有其他方法。

# mongodb - Meteor / mongo db 字段名“长度”无效？

> ID：14188355
> 
> 赞同：1
> 
> 时间：2013-01-07T00:34:50.900
> 
> 标签：mongodb, meteor

嗨，当在 Meteor 中尝试简单`collection.insert({ owner: Meteor.userId(), length:3 });`时，它由客户端执行，但被服务器撤销（或在进程中，相同`collection.update`）目前我将该字段重命名`length`为`len`，瞧，它可以工作......但现在我不符合 GridFS 规范说：'fs.files.length'（项目：collectionfs.meteor.com）

任何人？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T07:58:10.327

`length`这是因为在 Meteor 中广泛使用的 Underscore 库中的迭代函数通过查看它是否具有数字属性来决定它们是迭代数组还是对象。我认为这里的特定实例`livedata/livedata_server.js`在`set`函数中（第 515 行左右）：它解释`attributes`为一个数组，然后找不到任何实际属性。

也许我们需要完全停止在 Meteor 中使用 _.each。

# javascript - 除了 V8 之外，是否有任何带有 JavaScript 引擎的 node.js 平台的端口或替代实现？

> ID：14188356
> 
> 赞同：6
> 
> 时间：2013-01-07T00:34:54.870
> 
> 标签：javascript, node.js, platform, serverside-javascript, javascript-engine

**node.js**是一个基于谷歌 V8 JavaScript 引擎的开源服务器端 JavaScript**平台。**几年来，它已经迅速普及和重要性。

现在 node.js 只是一个平台。本质上，使用哪个 JavaScript 引擎只是一个实现细节，任何 JS 引擎都可以使用，甚至是与各种 JS 引擎一起工作的抽象。

[Joyent](http://joyent.com)可能选择 V8 是因为它是开源的，具有有利的许可条款，并且通常是目前最快的 JS 引擎（但我相信它有时会被其他引擎超越）。

鉴于对许多可能被称为“开放标准”的事物（例如 JS 引擎、Web 浏览器、编程语言的编译器等）拥有多种不同但兼容的实现是一件好事；当然，拥有像 node.js 这样的服务器端平台的多个实现也是很好的

例如，几乎所有操作系统和硬件上都有 JavaScript 引擎，但 V8 只存在于其中的几个。甚至事实证明，微软正在为 Windows Azure 推广 node.js，尽管它依赖于主要竞争对手的工作，即使他们拥有自己的 JS 引擎，可以与 V8 竞争速度。

如果任何此类端口已经开始，我会非常有兴趣关注他们的进展，以监控 node.js 是否可能成为一个开放标准。

* * *

^(• 我意识到 node 不像 JS 和浏览器那样标准化，而且它的发展非常迅速，但这从未阻止任何人挠痒痒。• 如果有多个端口，我不是在征求您认为更好或更受欢迎的意见，这不是民意调查问题。• 我也不是购买node.js 实现，我感兴趣的是node.js 或类似的东西是否会被普遍采用作为一个平台，或者它是否会留在一家公司手中。)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T00:43:30.837

是的，在 JVM 上的 Nashorn 引擎上运行的 node.jar：

[https://groups.google.com/forum/?fromgroups#!topic/nodejs/750fF6ruAdY](https://groups.google.com/forum/?fromgroups#!topic/nodejs/750fF6ruAdY)

如果它成功了，那就太好了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-07T05:02:49.830

Mozilla 的 SpiderMonkey + node 核心库：[https ://github.com/mozilla/spidernode](https://github.com/mozilla/spidernode)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-06-22T20:47:58.617

有[node-chakracore](https://github.com/nodejs/node-chakracore)，它使用 Microsoft 在其 Edge 浏览器中使用的开源 JavaScript 引擎： [https ://github.com/Microsoft/ChakraCore/](https://github.com/Microsoft/ChakraCore/)

他们正在积极致力于改进常见的 Node.js 基准测试（如 AcmeAir），通过改进其针对服务器端工作负载的 JIT/GC 并[从 Node.js 核心中消除特定于 v8 的“CrankShaftScript”](https://github.com/nodejs/CTC/issues/146#issuecomment-310489140)。

正如前面的回答中提到的，还有基于 Mozilla 的 Firefox 浏览器中的 SpiderMonkey JavaScript 运行时的[蜘蛛节点。](https://github.com/mozilla/spidernode)

您可以通过查看最新的[node.js CI 构建](https://ci.nodejs.org/view/Node.js%20benchmark/)来了解他们如何提高性能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-07T01:40:25.760

是的！显然，仅在 JVM 上就有不止一种 node.js 实现：

[**SprintStack**](http://sprintstack.com/)：Rhino 的并发 + 事件 I/O

> SprintStack 为开发人员提供了一个具有 JVM 的所有优点的节点兼容环境，例如对并发的惯用支持、可靠的垃圾收集和大量现有库。
> 
> 如果您希望您的 node.js 应用程序能够利用快速、成熟的 VM 和最先进的容错和分布式编程，那么试试 SprintStack！

[（在7zark7 的 anwser](https://stackoverflow.com/a/14188415/527702)链接到的线程中找到了这个。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-02-06T20:30:10.170

我刚刚了解到另一种实现。

![io.js 徽标](../Images/6e3076703fe8584ebe6bc6136f00de1b.png)

这实际上是原始 node.js 的一个分支，称为[io.js](https://iojs.org/)。分支似乎发生在 2014 年末，主要目标是增加对[ES6 (JavaScript ECMA-262)](http://www.ecma-international.org/publications/standards/Ecma-262.htm)的支持。

# java - LinkedHashMap 与访问内部链表的方法

> ID：14188357
> 
> 赞同：1
> 
> 时间：2013-01-07T00:35:01.213
> 
> 标签：java, collections, guava, apache-commons, linkedhashmap

我需要访问`LinkedList`a 的内部`LinkedHashMap`。我希望能够同时访问尾部和头部。通过迭代器，我只能访问头部或尾部，这取决于构造时使用的访问顺序。

如何有效地访问*O(1)*中内部列表的头部和尾部？

这个想法类似于 Apache Common Collection `LinkedHashMap.asList()`（但我想避免将 Apache Commons Collections 添加为依赖项，因为我已经有 Guava）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T01:05:48.917

您只能通过反射访问内部 LinkedList。

使用反射，您可以访问私有成员，`setAccessible(true)` 当 javas 安全管理器通过反射禁用私有访问时，这可能会失败。

另一种解决方案是使用 LinkedHashMap 的开源实现，然后将 getter 添加到内部列表。

# get - Tkinter 小部件的 get() 问题

> ID：14188358
> 
> 赞同：0
> 
> 时间：2013-01-07T00:35:09.873
> 
> 标签：get, python-2.7, widget, tkinter

我在使用 Tkinter 从我的输入框中获取值时遇到问题。我现在正在尝试使用的是

```
S1 = Entry(attr,
           width = 3).grid(row = 0,
                           column = 1)
L = Label(attr,
          width = 5,
          relief = RIDGE,
          anchor = E,
          text = "STR: ").grid(row = 0,
                               column = 0) 
```

最后有一个按钮来尝试获取多个值（几个 .get()s 而不是这里的一个）

```
def Process():
   SEN = S1.get()

Button(attr,
       text = 'Continue',
       command=Process).grid(row = 8, column = 0) 
```

我将标签和条目设置为它们自己的功能。在我尝试获取（）数据之前，它会起作用。我哪里错了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T01:07:36.077

当你这样做时`S1=Entry(...).grid(...)`，存储的`S1`是网格函数的结果，它总是`None`. 如果要存储对小部件的引用，则需要单独调用网格。

试试这个看看：

```
S1 = Entry(attr, width=3)
S1.grid(row=0, column=1) 
```

# java - 如何确定通过 Input/ActionMap 绑定导致 AbstractAction 被触发的 Key？

> ID：14188363
> 
> 赞同：1
> 
> 时间：2013-01-07T00:36:41.880
> 
> 标签：java, key-bindings, keyevent

我正在构建一个 InputMap 和 ActionMap 来将键绑定到方法。许多键会做类似的事情。对于每个绑定键，我在 InputMap 中有一个条目。我想将几个 InputMap 条目与同一个 ActionMap 条目相关联，并使用 AbstractAction.actionPerformed(ActionEvent event) 方法中的 ActionEvent 参数来确定按下/释放/键入了哪个键。我查看了 getID()，测试了 ActionEvent 是否是 KeyEvent（不是）。有没有办法做到这一点，或者我必须进行不同的重构，以便每个唯一的 ActionMap 条目设置一个参数，然后调用我的（参数化）方法？

这是有效的（但很冗长）：

```
 getInputMap().put(KeyStroke.getKeyStroke(KeyEvent.VK_RIGHT,0),"myRightHandler");
    getInputMap().put(KeyStroke.getKeyStroke(KeyEvent.VK_LEFT,0),"myLeftHandler");
    getActionMap().put("myRightHandler",new AbstractAction() {
              public void actionPerformed(ActionEvent evt) {
                  System.out.println("Typed Right Arrow");
              }
          });
    getActionMap().put("myLefttHandler",new AbstractAction() {
              public void actionPerformed(ActionEvent evt) {
                  System.out.println("Typed Left Arrow");
              }
          }); 
```

这是我想做但找不到魔法的事情：

```
 getInputMap().put(KeyStroke.getKeyStroke(KeyEvent.VK_RIGHT,0),"myGenericHandler");
    getInputMap().put(KeyStroke.getKeyStroke(KeyEvent.VK_LEFT,0),"myGenericHandler");
    getActionMap().put("myGenericHandler",new AbstractAction() {
              public void actionPerformed(ActionEvent evt) {
                  // determine what key caused the event...
                  // evt.getKeyCode() does not work.
                  int keyCode = performMagic(evt);
                  switch (keyCode) {
                      case KeyEvent.VK_RIGHT:
                          System.out.println("Typed Right Arrow");
                          break;
                      case KeyEvent.VK_LEFT:
                          System.out.println("Typed Left Arrow");
                          break;
                      default:
                          System.out.println("Typed unknown key");
                          break;
                  }
              }
          }; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-07-07T18:28:42.873

你应该先试试这个简单的逻辑。

```
getInputMap().put(KeyStroke.getKeyStroke(KeyEvent.VK_RIGHT,0),"myRightHandler");
    getInputMap().put(KeyStroke.getKeyStroke(KeyEvent.VK_LEFT,0),"myLeftHandler");
    getActionMap().put("myRightHandler", new myAction("myRightHandler")); 
    getActionMap().put("myLeftHandler", new myAction("myLeftHandler")); 

    class myAction extends AbstractAction { 

        String str; 

        public myAction(String actName) {

            str = actName; 
        }

        public void actionPerformed(ActionEvent ae) { 

            switch(str) { 

                case "myRightHandler": //Here is code for 'myRightHandler'. 
                break; 

                case "myLeftHandler": //Here is code for 'myLeftHandler'. 
                break; 
                .
                .
                .
                .
                default : //Here is default Action; 
                break;
            }
        }
    } 
```

现在，您可以通过这种方式添加许多自定义组合键和操作，并通过 switch 区分它们。

# python - Python 在运行时自动创建唯一列表

> ID：14188368
> 
> 赞同：0
> 
> 时间：2013-01-07T00:37:18.060
> 
> 标签：python, list

我正在编写一个程序，但遇到了一个问题，我需要该程序自行创建列表。

```
animals = ["cat", "dog", "rat", "horse"] 
```

例如。然后，我想要一个 list.appends 列表的函数。

```
def append()
    input = input(">>>")
    animals.append(input) 
```

当它这样做时，我希望它为输入的用户输入创建一个新列表。有没有办法做到这一点而不必使用文件功能？

此功能的最终目标是：

*   附加列表“动物”（得到那部分）
*   然后，我希望它创建一个输入唯一的新列表。如果可能的话，用户输入可能会引用该列表。
*   最后，我希望用户可以编辑此列表，这很容易使用 list.append。但是我需要以某种方式能够引用这个唯一的列表才能做到这一点。

希望这能消除一些困惑。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T00:55:40.283

我希望我明白你的目标是什么。我建议你使用`dict`一个`lists`：

```
animals = {}
while True:
    print(', '.join(i for i in animals))
    animal = input('Choose an animal, or pick a newe one: ')
    if animal == "":
        break
    item = input('enter item: ')    
    animals.setdefault(animal,[]).append(item)

print(animals)

Choose an animal, or pick a newe one: rat
enter item: foo
rat
Choose an animal, or pick a newe one: dog
enter item: bar
rat, dog
Choose an animal, or pick a newe one: 
{'rat': ['foo'], 'dog': ['bar']} 
```

# javascript - 使用 cocos2d-iphone javascript 绑定检测视网膜显示

> ID：14188369
> 
> 赞同：0
> 
> 时间：2013-01-07T00:37:24.683
> 
> 标签：javascript, cocos2d-iphone, retina-display

我正在尝试 cocos2d-iphone javascript 绑定，以便在完成后更轻松地将当前项目移植到 web 或 android 平台。现在我只是使用 xcode 为 ios 设备运行 js。

我试图弄清楚是否有办法在 javascript 中检测视网膜显示。我的 sd/hd 图像似乎使用标准文件名约定（即`image.png`和`image@2x.png`）加载得很好，但我在加载正确版本的字体文件时遇到了问题。正如预期的那样，检查屏幕尺寸会为视网膜和非视网膜显示器返回相同的像素宽度。通常在 obj-c 中我只会使用`CC_CONTENT_SCALE_FACTOR()`，但我在 javascript 绑定中找不到等价物。

我找到了这个 SO [question/answer](https://stackoverflow.com/questions/5914367/iphone4-retina-display-detection-with-php-and-or-javascript)，当通过浏览器查看这个项目时它会派上用场，但它不能解决 ios 设备问题......

例子：

```
var label = cc.LabelBMFont.create("0123456789", "EuroBold24.fnt"); 
```

对比

```
var label = cc.LabelBMFont.create("0123456789", "EuroBold24@2x.fnt"); 
```

这两种方法都有效，但如果设备是启用视网膜的设备，我需要知道调用哪一个。有任何想法吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T21:57:14.510

你不应该将@2x 与 cocos2d-iphone 一起使用。使用使用以下后缀的自定义文件扩展名格式：

*   iPhone SD：图像.png
*   iPhone 视网膜：image-hd.png
*   iPad SD：image-ipad.png
*   iPad 视网膜：image-ipadhd.png

@2x 仅适用于图像文件，cocos2d 的自定义文件后缀适用于任何支持的资产，包括位图字体 (.fnt) 和 tilemap (.tmx) 文件。

# watir-webdriver - Watir - Webdriver - 无法点击元素

> ID：14188371
> 
> 赞同：1
> 
> 时间：2013-01-07T00:37:27.720
> 
> 标签：watir-webdriver

我是 watir webdriver 和 ruby​​ 的新手。在我的第一个 scipt 中，我试图输入搜索字符串并触发看起来像按钮的点击操作，但通过元素检查不会显示为按钮。插入搜索字符串后，我的 watir 脚本一直无法单击搜索按钮。

```
None of the following three options worked.
 browser.a(:id=> "search0_SearchIcon").submit
 browser.button(:id=> "search0_SearchIcon").submit
 browser.div(:id=> "header").div(:class=> "head-container").div(:class=> "search-field").button(:class => "rb-search-button js-rb-search-button").click

*******Test target code is listed below****

</div>
    <div class="search-field">
        <input accesskey="s" aria-autocomplete="list" aria-haspopup="true" autocomplete="off" class="js-rb-search-input" id="rbSearchInput" name="rbSearchInput" role="textbox" type="text" value="" />
        <a id="search0_SearchIcon" class="rb-search-button js-rb-search-button"></a>
        <form id="GeneralSearchForm" method="GET" action="/Search">
          <input name="query" type="hidden" id="rbSearchInputHidden" class="js-rb-search-input-hidden"  />
        </form>
    </div>
  </div>
************ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T03:36:53.210

您的“按钮”有两点：

1.  它是一个链接，因此您需要使用`a`or`link`方法。
2.  要单击链接，请使用`click`方法（而不是`submit`方法）。

根据您的个人喜好，以下任一选项应单击“按钮”：

```
browser.a(:id => "search0_SearchIcon").click 
```

或者

```
browser.link(:id => "search0_SearchIcon").click 
```

# java - 我必须在哪里对模型进行编码？（Spring MVC 模板项目）

> ID：14188379
> 
> 赞同：0
> 
> 时间：2013-01-07T00:38:27.853
> 
> 标签：java, spring, spring-mvc

问这个我感觉有点愚蠢，但我真的不知道把模型的代码放在哪里。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T00:42:17.367

您是否考虑过使用[STS（弹簧工具套件）](http://www.springsource.org/sts)？您将能够创建一个新的 spring MVC 模板项目。它还包含一些 spring MVC 示例，您可以使用它们来启动您自己的项目。通常，每个示例都包含一个模型、一个视图和一个控制器！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T01:36:00.567

你可以把你的模型类放在任何你喜欢的地方，但是专门为这些目的创建包是一种相当普遍的做法，例如 com.mydomain.myproject.controller 和 com.mydomain.myproject.model，所以在文件系统中，src/com /mydomain/myproject/controller 和 src/com/mydomain/myproject/model

# c++ - 如何让 Visual Studio 2012 调用原生 64 位 Visual C++ 编译器而不是 32 位 x64 交叉编译器？

> ID：14188380
> 
> 赞同：7
> 
> 时间：2013-01-07T00:38:39.363
> 
> 标签：c++, visual-c++, visual-studio-2012, visual-c++-2012

Visual Studio 2012 似乎总是调用`cl.exe`位于`%ProgramFiles(x86)%\Microsoft Visual Studio 11.0\VC\bin\x86_amd64`) 的 32 位版本，而不是位于 的 64位版本`%ProgramFiles(x86)%\Microsoft Visual Studio 11.0\VC\bin\amd64`。

我尝试在属性表的*VC++ 目录*部分中添加`$(VCInstallDir)bin\amd64`到“可执行目录”列表的开头，但这根本不起作用——重建时出现此错误：*`Microsoft.Cpp.x64.user`*

 *```
TRACKER : error TRK0002: Failed to execute command: "
"C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\bin\amd64\CL.exe"
@C:\Users\<my_profile>\AppData\Local\Temp\tmpf3d817cafe064ad28e7dd62b2cb591c3.rsp
". The operation identifier is not valid. 
```

如何让 Visual Studio 2012 使用本机 64 位 C++ 编译器？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2014-01-30T18:21:15.377

这个答案有点晚了，但令人沮丧的是，微软的在线文档中仍然没有直接可用的好资源。事实证明这很容易，即使不是完全方便。

在命令提示符下，键入（根据需要更改 VS 的版本）：

```
> set _IsNativeEnvironment=true
> "C:\Program Files (x86)\Microsoft Visual Studio 11.0\Common7\IDE\devenv.exe" YourProject.sln 
```

线索在文件中

```
C:\Program Files (x86)\MSBuild\Microsoft.Cpp\v4.0\V110\Microsoft.Cpp.targets 
```

它说的地方

```
<SetEnv Condition="'$(_IsNativeEnvironment)' == 'true'"
        Name ="PATH"
        Value ="$(NativeExecutablePath)"
        Prefix ="false">
  <Output TaskParameter="OutputEnvironmentVariable" PropertyName="Path"/>
</SetEnv> 
```

我的项目是由 CMake 生成的，所以我通常在命令提示符下运行几行，然后才能打开 VS。我总是在第一次设置 MSVC 环境后启动我的 CMake 生成器，所以老实说我不知道​​它是否需要，但你也可以选择这样做（在其他所有事情之前）：

```
> call "C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\vcvarsall.bat" amd64 
```

和/或

```
> call "C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\bin\amd64\vcvars64.bat" 
```

这是[MSDN](http://social.msdn.microsoft.com/Forums/en-US/d6b352ea-12b6-4867-b86d-a052fbab1da4/how-can-switch-to-native-x64-compiler-to-compile-x64-program)上原始帖子的链接，我终于找到了答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-19T11:18:43.543

我正在将一个旧项目从 Win32 转换为 x64 并遇到了这个问题。
我发现了两种不同的方法来解决这个问题：

**方法1：**
一。前往：***项目属性***| ***一般***| ***平台工具集***
ii。将值从“ **Visual Studio 2012 (v110)** ”更改为“ **Visual Studio 2012 - Windows XP (v110_xp)** ”

**方法2：**
i。`%LOCALAPPDATA%\Microsoft\MSBuild\v4.0\Microsoft.Cpp.x64.user.props`
ii.打开配置文件 在`<ExecutablePath>`属性组内，我将`$(WindowsSDK_ExecutablePath_x64)`条目替换为`$(WindowsSDK_ExecutablePath_x86)`

在*所有*这些工作正常之后。*

# html - 在页面加载时打开一个弹出窗口（如灯箱）

> ID：14188384
> 
> 赞同：0
> 
> 时间：2013-01-07T00:38:50.393
> 
> 标签：html

我正在使用 Weebly 构建我的网站，只是为了轻松添加内容。

我在 Dreamweaver 中创建了我的主题，然后将其上传到 Weebly。

这是我的问题。一个人修改了灯箱以与 Weebly 一起使用，因此您可以将拖放功能与弹出窗口一起使用。

我插入了他希望我插入的代码，但我试图在页面加载时加载弹出窗口，而不必单击链接。这是单击链接时打开弹出窗口的 html 代码。

```
 <div id='basic-modal'>
    <a href='#' class='basic'>Open Popout</a>
    </div> 
```

我有点困惑，所以请帮忙。我该怎么做？

谢谢。- 瑞安

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T01:19:25.977

这是一个 jQuery 模态教程，您可以使用它来加载一个与页面[http://www.jacklmoore.com/notes/jquery-modal-tutorial一起加载的模态](http://www.jacklmoore.com/notes/jquery-modal-tutorial)

点击查看实际操作：[演示](http://www.jacklmoore.com/demo/modal/modal2.html)

请提供您的 jQuery 脚本，以便其他人可以尝试帮助您处理您当前使用的代码。

# java - 多次写入OutputStream Pipeline错误 - java

> ID：14188385
> 
> 赞同：1
> 
> 时间：2013-01-07T00:38:52.097
> 
> 标签：java, pipeline

我尝试使用这种方式与进程进行通信：

```
Process process = Runtime.getRuntime().exec("/home/username/Desktop/mosesdecoder/bin/moses -f /home/username/Desktop/mosesdecoder/model/moses.ini");

while (true) {
    OutputStream stdin = null;
    InputStream stderr = null;
    InputStream stdout = null;
    stdin = process.getOutputStream();
    stderr = process.getErrorStream();
    stdout = process.getInputStream();

    // "write" the parms into stdin
    line = "i love you" + "\n";
    stdin.write(line.getBytes());
    stdin.flush();
    stdin.close();
    // Print out the output
    BufferedReader brCleanUp =
            new BufferedReader(new InputStreamReader(stdout));
    while ((line = brCleanUp.readLine()) != null) {
        System.out.println("[Stdout] " + line);
    }
    brCleanUp.close();
} 
```

这工作正常。但是，当我多次编写管道时，我遇到了一个问题。也就是说 - 我可以多次写入 Outputstream 管道。错误是（对于第 2 次迭代）：

```
Exception in thread "main" java.io.IOException: **Stream Closed**
at java.io.FileOutputStream.writeBytes(Native Method)
at java.io.FileOutputStream.write(FileOutputStream.java:297)
at java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:82)
at java.io.BufferedOutputStream.**flush(BufferedOutputStream.java**:140)
at moses.MOSES.main(MOSES.java:60) 
```

那么，有没有办法解决这个问题呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T00:48:25.403

在您的`while {}`循环中，您正在调用 stdin.close()。第一次通过循环时，从 Process 中检索到流并且恰好是打开的。在循环的第一次迭代中，从进程中检索流，写入、刷新和关闭（！）。循环的后续迭代然后从进程中获得相同的流，但它在循环的第一次迭代（！）时关闭，并且您的程序抛出一个`IOException`.

# android - Android开发：AsyncTask中的progressdialog，但应用程序仍然崩溃

> ID：14188387
> 
> 赞同：0
> 
> 时间：2013-01-07T00:39:07.783
> 
> 标签：android, crash, android-asynctask, progressdialog

```
package com.whatstherex.sam;

import java.util.ArrayList;

import org.apache.http.NameValuePair;
import org.apache.http.message.BasicNameValuePair;

import android.app.Activity;
import android.app.AlertDialog;
import android.app.ProgressDialog;
import android.content.Context;
import android.content.DialogInterface;
import android.content.Intent;
import android.graphics.Color;
import android.os.AsyncTask;
import android.os.Bundle;
import android.os.StrictMode;
import android.view.MotionEvent;
import android.view.View;
import android.view.inputmethod.InputMethodManager;
import android.widget.Button;
import android.widget.EditText;
import android.widget.LinearLayout;
import android.widget.TabHost;
import android.widget.TabHost.TabSpec;
import android.widget.TextView;

public class Login extends Activity {
String emailAdd;
EditText lEmail, lPassword, rUsername, rPassword, rRpassword, rEmail,
        rPhoneNum, rBirthday, rGender;
Button lLogin, rRegister;
TextView lAuth, rAuth;
AlertDialog loginDialog, registerDialog;
LinearLayout Llayout, Rlayout;

@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    StrictMode.ThreadPolicy policy = new StrictMode.ThreadPolicy.Builder().permitAll().build();
    StrictMode.setThreadPolicy(policy);
    setContentView(R.layout.login);

    initialize();
}

@Override
protected void onPause() {
    // TODO Auto-generated method stub
    super.onPause();
    finish();
}

public void initialize() {
    TabHost tabH = (TabHost) findViewById(R.id.tabhost);
    tabH.setup();
    TabSpec specs = tabH.newTabSpec("tag1");
    specs.setContent(R.id.Login);
    specs.setIndicator("Login");
    tabH.addTab(specs);
    TabSpec specs1 = tabH.newTabSpec("tag2");
    specs1.setContent(R.id.Register);
    specs1.setIndicator("Register");
    tabH.addTab(specs1);

    lEmail = (EditText) findViewById(R.id.etlEmail);
    lPassword = (EditText) findViewById(R.id.etlPassword);
    lLogin = (Button) findViewById(R.id.blLogin);
    lAuth = (TextView) findViewById(R.id.tvlAuth);

    rUsername = (EditText) findViewById(R.id.etrUsername);
    rPassword = (EditText) findViewById(R.id.etrpassword);
    rRpassword = (EditText) findViewById(R.id.etrRpassword);
    rEmail = (EditText) findViewById(R.id.etrEmail);
    rPhoneNum = (EditText) findViewById(R.id.etrPnumber);
    rBirthday = (EditText) findViewById(R.id.etrBirthday);
    rGender = (EditText) findViewById(R.id.etrGender);
    rRegister = (Button) findViewById(R.id.brRegister);
    rAuth = (TextView) findViewById(R.id.tvrAuth);

    hideKeyboardLayout(Llayout, R.id.Login);
    hideKeyboardLayout(Rlayout, R.id.Register);

    setLogin(lLogin);
    setRegister(rRegister);
}

public void hideKeyboardLayout(LinearLayout layout, int name) {
    layout = (LinearLayout) findViewById(name);

    layout.setOnTouchListener(new View.OnTouchListener() {

        protected void hideKeyboard(View v) {
            InputMethodManager in = (InputMethodManager) getSystemService(Context.INPUT_METHOD_SERVICE);
            in.hideSoftInputFromWindow(v.getWindowToken(),
                    InputMethodManager.HIDE_NOT_ALWAYS);
        }

        @Override
        public boolean onTouch(View v, MotionEvent event) {
            // TODO Auto-generated method stub
            hideKeyboard(v);
            return false;
        }
    });
}

public void setLogin(Button b) {
    b.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            // TODO Auto-generated method stub// TODO Auto-generated method stub
            new loadLogin().execute();
        }
    });
}

private void setRegister(Button b) {
    // TODO Auto-generated method stub
    b.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            // TODO Auto-generated method stub
            registerDialog = new AlertDialog.Builder(Login.this).create();
            registerDialog.setTitle("Register Alert!");
            registerDialog.setButton(DialogInterface.BUTTON_NEGATIVE,
                    "Back", new DialogInterface.OnClickListener() {

                        public void onClick(DialogInterface dialog,
                                int which) {
                            // TODO Auto-generated method stub
                            registerDialog.dismiss();
                        }
                    });

            ArrayList<NameValuePair> postParameters = new ArrayList<NameValuePair>();
            postParameters.add(new BasicNameValuePair("usernamelog",
                    rUsername.getText().toString()));
            postParameters.add(new BasicNameValuePair("passwordlog",
                    rPassword.getText().toString()));
            postParameters.add(new BasicNameValuePair("rpasswordlog",
                    rRpassword.getText().toString()));
            postParameters.add(new BasicNameValuePair("emaillog", rEmail
                    .getText().toString()));
            postParameters.add(new BasicNameValuePair("phonenumlog",
                    rPhoneNum.getText().toString()));
            postParameters.add(new BasicNameValuePair("doblog", rBirthday
                    .getText().toString()));
            postParameters.add(new BasicNameValuePair("genderlog", rGender
                    .getText().toString()));

            String response = null;

            try {
                response = CustomHttpClient.executeHttpPost("http://whatstherex.info/CheckR.php", postParameters);

                String res = response.toString();

                res = res.replaceAll("null", "");

                if (res.equals("1")) {
                    rAuth.setText("Successfully Register");
                    rAuth.setTextColor(Color.GREEN);
                    registerDialog.setMessage("Successfully Register");
                    registerDialog.show();
                } else {
                    rAuth.setText(res.toString());
                    rAuth.setTextColor(Color.RED);
                    registerDialog.setMessage(res.toString());
                    registerDialog.show();
                }
            } catch (Exception e) {
                rAuth.setText(e.toString());
                rAuth.setTextColor(Color.BLACK);
            }
        }
    });
}

public class loadLogin extends AsyncTask<String, Void, String> {
    ProgressDialog dialog;

    protected void onPreExecute(){
    dialog = new ProgressDialog(Login.this, ProgressDialog.STYLE_SPINNER);
    dialog.setMessage("Loading Data...");
    dialog.show();
    }

    @Override
    protected String doInBackground(String... params) {
        loginDialog = new AlertDialog.Builder(Login.this).create();
        loginDialog.setTitle("Login Alert!");
        loginDialog.setButton(DialogInterface.BUTTON_NEGATIVE, "Back", new DialogInterface.OnClickListener() {
            public void onClick(DialogInterface dialog, int which) {
                // TODO Auto-generated method stub
                loginDialog.dismiss();
                }
            });

        ArrayList<NameValuePair> postParameters = new ArrayList<NameValuePair>();
        postParameters.add(new BasicNameValuePair("emaillog", lEmail.getText().toString()));
        postParameters.add(new BasicNameValuePair("passwordlog", lPassword.getText().toString()));

        String response = null;

        String res = "";
        try {
            response = CustomHttpClient.executeHttpPost( "http://whatstherex.info/checkL.php", postParameters);

            res = response.toString();

            res = res.replaceAll("null", "");

            if (res.equals("1")) {
                res = "Login Successfully!";
                lAuth.setTextColor(Color.GREEN);
                loginDialog.setMessage("Login Successfully!");
                loginDialog.setButton(DialogInterface.BUTTON_NEGATIVE, "Continue", new DialogInterface.OnClickListener() {

                    public void onClick(DialogInterface dialog, int which) {
                        // TODO Auto-generated method stub
                        new loadRedirect().execute();
                        }
                    });
                loginDialog.show();
                dialog.dismiss();
                return res;
            } else if (res.equals("0")) {
                res = "Sorry!! Incorrect Username or Password!";
                lAuth.setTextColor(Color.RED);
                loginDialog.setMessage("Sorry!! Incorrect Username or Password!");
                loginDialog.show();
                dialog.dismiss();
                return res;
            } else {
                res = res.toString();
                lAuth.setTextColor(Color.RED);
                loginDialog.setMessage(res.toString());
                loginDialog.show();
                dialog.dismiss();
                return res;
            }

        } catch (Exception e) {
            res = e.toString();
            lAuth.setTextColor(Color.BLACK);
    }
    return res;
}

protected void onProgressUpdate() {

}

protected void onPostExecute(String result){
    lAuth.setText(result);
    dialog.dismiss();
}

}

public class loadRedirect extends AsyncTask<String, Void, String> {
    ProgressDialog dialog;

    protected void onPreExecute(){
    dialog = new ProgressDialog(Login.this, ProgressDialog.STYLE_SPINNER);
    dialog.setMessage("Loading Data...");
    dialog.show();
    }

    @Override
    protected String doInBackground(String... params) {
        ArrayList<NameValuePair> postParameters = new ArrayList<NameValuePair>();
        postParameters.add(new BasicNameValuePair("emaillog", lEmail.getText().toString()));
        postParameters.add(new BasicNameValuePair("passwordlog", lPassword.getText().toString()));

        String response = null;

        String res = "";
        try {
            response = CustomHttpClient.executeHttpPost("http://whatstherex.info/checkP.php", postParameters);

            res = response.toString();

            res = res.replaceAll("null", "");

            if (res.equals("1")) {
                Intent mainIntent = new Intent("com.whatstherex.sam.Main");
                mainIntent.putExtra("Email", lEmail.getText().toString());
                startActivity(mainIntent);
                dialog.dismiss();

            } else if (res.equals("0")) {
                Intent profilePicIntent = new Intent("com.whatstherex.sam.Profilepic");
                profilePicIntent.putExtra("Email", lEmail.getText().toString());
                startActivity(profilePicIntent);
                dialog.dismiss();
            } else {
                res = res.toString();
                lAuth.setTextColor(Color.RED);
                loginDialog.setMessage(res.toString());
                loginDialog.show();
                dialog.dismiss();
            }

        } catch (Exception e) {
            res = e.toString();
            lAuth.setTextColor(Color.BLACK);
            }
    return res;
}

protected void onProgressUpdate() {

}

protected void onPostExecute(String result){
    lAuth.setText(result);
    dialog.dismiss();
}

}

} 
```

想要并且需要添加加载旋转，否则 ui 将挂起，甚至可能崩溃。不确定我是否正确地将整个块分解为 2 个 AsyncTask。还有其他方法可以刷新意图，谢谢finish(); 因为那会出现黑屏。任何帮助将不胜感激。

这是日志文件：

```
01-07 08:58:44.984: D/dalvikvm(6078): Debugger has detached; object registry had 1 entries
01-07 08:58:45.355: D/AndroidRuntime(6090): >>>>>> AndroidRuntime START com.android.internal.os.RuntimeInit <<<<<<
01-07 08:58:45.355: D/AndroidRuntime(6090): CheckJNI is OFF
01-07 08:58:45.725: D/AndroidRuntime(6090): Calling main entry com.android.commands.am.Am
01-07 08:58:45.735: I/ActivityManager(1679): Force stopping package com.whatstherex.sam uid=10111
01-07 08:58:45.735: D/ViewRootImpl(1679): @@@- disable SystemServer HW acceleration
01-07 08:58:45.735: I/ActivityManager(1679): START intent from pid 6090
01-07 08:58:45.755: W/memalloc(1448): Falling back to ashmem
01-07 08:58:45.775: D/memalloc(1448): ashmem: Allocated buffer base:0x42542000 size:1536000 fd:47
01-07 08:58:45.775: D/memalloc(1679): ashmem: Mapped buffer base:0x55fb4000 size:1536000 fd:350
01-07 08:58:45.785: I/Adreno200-EGLSUB(1448): <CreateImage:893>: Android Image
01-07 08:58:45.785: I/Adreno200-EGLSUB(1448): <GetImageAttributes:1102>: RGBA_8888
01-07 08:58:45.795: D/CAT(1878): CatService: Return current sInstance
01-07 08:58:45.815: D/AndroidRuntime(6090): Shutting down VM
01-07 08:58:45.825: D/dalvikvm(6100): Late-enabling CheckJNI
01-07 08:58:45.825: I/AndroidRuntime(6090): NOTE: attach of thread 'Binder Thread #3' failed
01-07 08:58:45.825: D/dalvikvm(6090): GC_CONCURRENT freed 106K, 70% free 615K/2048K, paused 0ms+2ms
01-07 08:58:45.825: D/jdwp(6090): Got wake-up signal, bailing out of select
01-07 08:58:45.825: D/dalvikvm(6090): Debugger has detached; object registry had 1 entries
01-07 08:58:45.825: I/ActivityManager(1679): Start proc com.whatstherex.sam for activity com.whatstherex.sam/.Splash: pid=6100 uid=10111 gids={3003}
01-07 08:58:45.855: D/SensorManager(1679): [SensorManager] registerListener: delay = 200000
01-07 08:58:45.855: D/SensorService(1679): enable: get sensor name = BMA150 3-axis Accelerometer
01-07 08:58:45.855: D/Sensors(1679): Enable akm: en = 1
01-07 08:58:45.865: D/SensorService(1679): SensorDevice::activate--: handle = 0x0, enabled = 0x1
01-07 08:58:45.865: D/SensorService(1679): pid=1679, uid=1000
01-07 08:58:45.865: D/ConnectivityService(1679): onUidRulesChanged(uid=10111, uidRules=0)
01-07 08:58:45.875: D/AK8975(1458): Compass Start
01-07 08:58:45.875: V/WindowManager(1679): Starting animation in AppWindowToken{412e69f0 token=Token{412f5898 ActivityRecord{412f5648 com.htc.launcher/.Launcher}}} @ 160693935
01-07 08:58:45.875: V/WindowManager(1679): Finished animation in AppWindowToken{412e69f0 token=Token{412f5898 ActivityRecord{412f5648 com.htc.launcher/.Launcher}}} @ 160693935
01-07 08:58:45.885: V/WindowManager(1679): Starting animation in AppWindowToken{418942a0 token=Token{41836990 ActivityRecord{41836858 com.whatstherex.sam/.Splash}}} @ 160693935
01-07 08:58:45.895: W/ActivityThread(6100): Application com.whatstherex.sam is waiting for the debugger on port 8100...
01-07 08:58:45.905: I/System.out(6100): Sending WAIT chunk
01-07 08:58:45.925: I/dalvikvm(6100): Debugger is active
01-07 08:58:45.925: D/ViewRootImpl(1679): @@@- disable SystemServer HW acceleration
01-07 08:58:45.945: D/OpenGLRenderer(1794): Flushing caches (mode 1)
01-07 08:58:45.965: W/memalloc(1448): Falling back to ashmem
01-07 08:58:45.975: D/AK8975(1458): Ignore M_Sensor: (y, p, r) = ( 269,    5,    2), Status = 2
01-07 08:58:45.985: D/memalloc(1448): ashmem: Allocated buffer base:0x41c57000 size:737280 fd:48
01-07 08:58:46.025: D/memalloc(1679): ashmem: Mapped buffer base:0x5612b000 size:737280 fd:363
01-07 08:58:46.055: I/Adreno200-EGLSUB(1448): <CreateImage:893>: Android Image
01-07 08:58:46.055: I/Adreno200-EGLSUB(1448): <GetImageAttributes:1102>: RGBA_8888
01-07 08:58:46.095: W/dalvikvm(1794): disableGcForExternalAlloc: false
01-07 08:58:46.105: I/System.out(6100): Debugger has connected
01-07 08:58:46.105: I/System.out(6100): waiting for debugger to settle...
01-07 08:58:46.306: V/WindowManager(1679): Finished animation in AppWindowToken{418942a0 token=Token{41836990 ActivityRecord{41836858 com.whatstherex.sam/.Splash}}} @ 160694367
01-07 08:58:46.316: I/System.out(6100): waiting for debugger to settle...
01-07 08:58:46.336: D/AndroidRuntime(6116): >>>>>> AndroidRuntime START com.android.internal.os.RuntimeInit <<<<<<
01-07 08:58:46.336: D/AndroidRuntime(6116): CheckJNI is OFF
01-07 08:58:46.386: D/AndroidRuntime(6120): >>>>>> AndroidRuntime START com.android.internal.os.RuntimeInit <<<<<<
01-07 08:58:46.386: D/AndroidRuntime(6120): CheckJNI is OFF
01-07 08:58:46.516: I/System.out(6100): waiting for debugger to settle...
01-07 08:58:46.596: D/memalloc(1448): ashmem: Freeing buffer base:0x421f5000 size:1536000 fd:103
01-07 08:58:46.596: D/memalloc(1448): ashmem: Freeing buffer base:0x42e1f000 size:1536000 fd:112
01-07 08:58:46.696: E/SurfaceTexture(1448): [SurfaceView] abandon: SurfaceTexture(0x0x6239e8) has been abandoned!
01-07 08:58:46.696: D/memalloc(1448): ashmem: Freeing buffer base:0x42042000 size:1536000 fd:37
01-07 08:58:46.716: I/System.out(6100): waiting for debugger to settle...
01-07 08:58:46.736: D/OpenGLRenderer(1794): Flushing caches (mode 0)
01-07 08:58:46.916: I/System.out(6100): waiting for debugger to settle...
01-07 08:58:46.936: D/memalloc(1448): ashmem: Freeing buffer base:0x42b6d000 size:1536000 fd:105
01-07 08:58:46.936: W/memalloc(1448): Falling back to ashmem
01-07 08:58:46.936: D/memalloc(1448): ashmem: Allocated buffer base:0x42042000 size:737280 fd:37
01-07 08:58:46.936: D/memalloc(1448): ashmem: Freeing buffer base:0x42fa7000 size:1536000 fd:113
01-07 08:58:46.946: D/memalloc(1679): ashmem: Mapped buffer base:0x561df000 size:737280 fd:366
01-07 08:58:46.946: I/Adreno200-EGLSUB(1448): <CreateImage:893>: Android Image
01-07 08:58:46.946: I/Adreno200-EGLSUB(1448): <GetImageAttributes:1102>: RGBA_8888
01-07 08:58:46.966: E/SurfaceTexture(1448): [com.htc.launcher/com.htc.launcher.Launcher] abandon: SurfaceTexture(0x0x62a9e0) has been abandoned!
01-07 08:58:46.996: D/memalloc(1448): ashmem: Freeing buffer base:0x41ecb000 size:1536000 fd:31
01-07 08:58:47.116: I/System.out(6100): waiting for debugger to settle...
01-07 08:58:47.306: D/AndroidRuntime(6116): Calling main entry com.android.commands.am.Am
01-07 08:58:47.317: I/System.out(6100): waiting for debugger to settle...
01-07 08:58:47.327: D/AndroidRuntime(6120): Calling main entry com.android.commands.am.Am
01-07 08:58:47.327: D/AndroidRuntime(6116): Shutting down VM
01-07 08:58:47.327: I/ActivityManager(1679): debugger status changed, pid: 6100, uid:10111, attach:true
01-07 08:58:47.347: I/AndroidRuntime(6116): NOTE: attach of thread 'Binder Thread #3' failed
01-07 08:58:47.347: D/dalvikvm(6116): GC_CONCURRENT freed 104K, 72% free 581K/2048K, paused 0ms+0ms
01-07 08:58:47.347: D/jdwp(6116): Got wake-up signal, bailing out of select
01-07 08:58:47.347: D/dalvikvm(6116): Debugger has detached; object registry had 1 entries
01-07 08:58:47.357: I/com.fd.httpd(26432): onStart
01-07 08:58:47.357: D/AndroidRuntime(6120): Shutting down VM
01-07 08:58:47.367: I/AndroidRuntime(6120): NOTE: attach of thread 'Binder Thread #3' failed
01-07 08:58:47.367: D/dalvikvm(6120): GC_CONCURRENT freed 106K, 71% free 613K/2048K, paused 1ms+1ms
01-07 08:58:47.367: D/jdwp(6120): Got wake-up signal, bailing out of select
01-07 08:58:47.367: D/dalvikvm(6120): Debugger has detached; object registry had 1 entries
01-07 08:58:47.517: I/System.out(6100): waiting for debugger to settle...
01-07 08:58:47.717: I/System.out(6100): waiting for debugger to settle...
01-07 08:58:47.917: I/System.out(6100): waiting for debugger to settle...
01-07 08:58:48.117: I/System.out(6100): waiting for debugger to settle...
01-07 08:58:48.317: I/System.out(6100): waiting for debugger to settle...
01-07 08:58:48.518: I/System.out(6100): waiting for debugger to settle...
01-07 08:58:48.718: I/System.out(6100): waiting for debugger to settle...
01-07 08:58:48.878: D/PhoneStatusBarPolicy(1760): ServiceState ss: 0
01-07 08:58:48.888: D/PhoneStatusBarPolicy(1760): Network Type: 8
01-07 08:58:48.918: I/System.out(6100): waiting for debugger to settle...
01-07 08:58:49.128: I/System.out(6100): waiting for debugger to settle...
01-07 08:58:49.328: I/System.out(6100): waiting for debugger to settle...
01-07 08:58:49.529: I/System.out(6100): waiting for debugger to settle...
01-07 08:58:49.729: I/System.out(6100): debugger has settled (1338)
01-07 08:58:49.979: D/libEGL(6100): loaded /system/lib/egl/libGLES_android.so
01-07 08:58:49.989: D/libEGL(6100): loaded /system/lib/egl/libEGL_adreno200.so
01-07 08:58:49.989: E/SurfaceTexture(1448): [Waiting For Debugger] abandon: SurfaceTexture(0x0x622fc8) has been abandoned!
01-07 08:58:49.989: D/memalloc(1448): ashmem: Freeing buffer base:0x41c57000 size:737280 fd:48
01-07 08:58:49.989: D/memalloc(1448): ashmem: Freeing buffer base:0x42042000 size:737280 fd:37
01-07 08:58:49.999: D/libEGL(6100): loaded /system/lib/egl/libGLESv1_CM_adreno200.so
01-07 08:58:49.999: D/libEGL(6100): loaded /system/lib/egl/libGLESv2_adreno200.so
01-07 08:58:50.019: I/Adreno200-EGLSUB(6100): <ConfigWindowMatch:2078>: Format RGBA_8888.
01-07 08:58:50.019: W/memalloc(1448): Falling back to ashmem
01-07 08:58:50.029: D/memalloc(1448): ashmem: Allocated buffer base:0x41ecb000 size:1536000 fd:31
01-07 08:58:50.029: D/memalloc(6100): ashmem: Mapped buffer base:0x52287000 size:1536000 fd:62
01-07 08:58:50.039: D/OpenGLRenderer(6100): Enabling debug mode 0
01-07 08:58:50.049: W/InputManagerService(1679): Got RemoteException sending setActive(false) notification to pid 5529 uid 10111
01-07 08:58:50.049: I/InputManagerService(1679): [startInputLocked] Enable input method client.
01-07 08:58:50.099: W/memalloc(1448): Falling back to ashmem
01-07 08:58:50.119: D/memalloc(1448): ashmem: Allocated buffer base:0x42104000 size:1536000 fd:37
01-07 08:58:50.119: D/memalloc(6100): ashmem: Mapped buffer base:0x525b5000 size:1536000 fd:65
01-07 08:58:50.119: I/Adreno200-EGLSUB(1448): <CreateImage:893>: Android Image
01-07 08:58:50.119: I/Adreno200-EGLSUB(1448): <GetImageAttributes:1102>: RGBA_8888
01-07 08:58:50.119: I/ActivityManager(1679): Displayed com.whatstherex.sam/.Splash: +4s309ms
01-07 08:58:50.159: D/OpenGLRenderer(1794): Flushing caches (mode 2)
01-07 08:58:50.159: D/ConnectivityService(1679): onUidRulesChanged(uid=9999, uidRules=0)
01-07 08:58:50.319: E/SurfaceTexture(1448): [Starting com.whatstherex.sam] abandon: SurfaceTexture(0x0x626710) has been abandoned!
01-07 08:58:50.319: D/memalloc(1448): ashmem: Freeing buffer base:0x42542000 size:1536000 fd:47
01-07 08:58:50.620: V/WindowManager(1679): onProposedRotationChanged, rotation changed to 0
01-07 08:58:50.790: D/skia(1794): AndroidImageRef[ 0x135d460 ] releasePixel fail as lockCount=1
01-07 08:58:51.881: V/WindowManager(1679): onProposedRotationChanged, rotation changed to 0
01-07 08:58:51.881: D/AndroidRuntime(6145): >>>>>> AndroidRuntime START com.android.internal.os.RuntimeInit <<<<<<
01-07 08:58:51.881: D/AndroidRuntime(6145): CheckJNI is OFF
01-07 08:58:52.261: D/AndroidRuntime(6145): Calling main entry com.android.commands.am.Am
01-07 08:58:52.271: I/com.fd.httpd(26432): onStart
01-07 08:58:52.271: D/AndroidRuntime(6145): Shutting down VM
01-07 08:58:52.281: I/AndroidRuntime(6145): NOTE: attach of thread 'Binder Thread #3' failed
01-07 08:58:52.281: D/dalvikvm(6145): GC_CONCURRENT freed 106K, 71% free 613K/2048K, paused 0ms+0ms
01-07 08:58:52.281: D/jdwp(6145): Got wake-up signal, bailing out of select
01-07 08:58:52.281: D/dalvikvm(6145): Debugger has detached; object registry had 1 entries
01-07 08:58:54.924: I/ActivityManager(1679): START intent from pid 6100
01-07 08:58:55.444: I/Adreno200-EGLSUB(6100): <ConfigWindowMatch:2078>: Format RGBA_8888.
01-07 08:58:55.444: W/memalloc(1448): Falling back to ashmem
01-07 08:58:55.444: D/memalloc(1448): ashmem: Allocated buffer base:0x42542000 size:1536000 fd:47
01-07 08:58:55.454: D/memalloc(6100): ashmem: Mapped buffer base:0x5282c000 size:1536000 fd:72
01-07 08:58:55.545: W/SubtypeSwitcher(1863): Current subtype: en_US, keyboard
01-07 08:58:55.545: W/SubtypeSwitcher(1863): Last subtype was disabled. Update to the current one.
01-07 08:58:55.545: E/AbstractCompatWrapper(1863): Invalid input to AbstructCompatWrapper
01-07 08:58:55.545: E/CompatUtils(1863): Exception in invoke: NullPointerException
01-07 08:58:55.545: W/SubtypeSwitcher(1863): Update subtype to:en_US,keyboard, from: en_US, keyboard
01-07 08:58:55.545: D/SubtypeSwitcher(1863): Update shortcut IME from : com.google.android.voicesearch/.ime.VoiceInputMethodService, , voice
01-07 08:58:55.555: D/SubtypeSwitcher(1863): Update shortcut IME to : com.google.android.voicesearch/.ime.VoiceInputMethodService, , voice
01-07 08:58:55.555: I/HTCIMEService(1863): fetch result: 8.5
01-07 08:58:55.555: I/HTCIMEService(1863): fetch result: 8.5
01-07 08:58:55.585: I/XT9_C(1863): [loadDefaultDB] xt9_raw/ldb_0409.ldb size=304198 (loaded)
01-07 08:58:55.595: I/XT9_C(1863): [registerXT9LDB] ldb_0409.ldb loading [done]
01-07 08:58:55.595: D/XT9_C(1863): [registerXT9LDB] current LdbNum=109, First LdbNum=109, Second LdbNum=0
01-07 08:58:55.605: I/XT9_C(1863): [loadDefaultDB] xt9_raw/kbd_0d09.kbd size=20852 (loaded)
01-07 08:58:55.605: I/XT9IMEAutoComplete(1863): [hanldeDBContentSensitive]  set PDSwitch's OnDiagnoseListener for Email4PDSwitch
01-07 08:58:55.605: I/HTCIMMView(1863): [FixedWCL] adjustWCLHeight height:65
01-07 08:58:55.635: W/memalloc(1448): Falling back to ashmem
01-07 08:58:55.635: D/memalloc(1448): ashmem: Allocated buffer base:0x41c57000 size:860160 fd:64
01-07 08:58:55.635: D/memalloc(1863): ashmem: Mapped buffer base:0x527bb000 size:860160 fd:66
01-07 08:58:55.695: D/dalvikvm(1863): GC_FOR_ALLOC freed 720K, 29% free 7708K/10787K, paused 55ms
01-07 08:58:55.735: I/Adreno200-EGLSUB(1448): <CreateImage:893>: Android Image
01-07 08:58:55.735: I/Adreno200-EGLSUB(1448): <GetImageAttributes:1102>: RGBA_8888
01-07 08:58:55.755: D/OpenGLRenderer(6100): has fontRender patch
01-07 08:58:55.775: D/OpenGLRenderer(6100): has fontRender patch
01-07 08:58:55.825: D/OpenGLRenderer(6100): has fontRender patch
01-07 08:58:55.825: W/memalloc(1448): Falling back to ashmem
01-07 08:58:55.845: D/memalloc(1448): ashmem: Allocated buffer base:0x42b6d000 size:1536000 fd:67
01-07 08:58:55.845: D/memalloc(6100): ashmem: Mapped buffer base:0x52b29000 size:1536000 fd:75
01-07 08:58:55.845: I/Adreno200-EGLSUB(1448): <CreateImage:893>: Android Image
01-07 08:58:55.845: I/Adreno200-EGLSUB(1448): <GetImageAttributes:1102>: RGBA_8888
01-07 08:58:55.855: I/ActivityManager(1679): Displayed com.whatstherex.sam/.Login: +875ms
01-07 08:58:55.855: V/WindowManager(1679): Starting animation in AppWindowToken{418942a0 token=Token{41836990 ActivityRecord{41836858 com.whatstherex.sam/.Splash}}} @ 160703906
01-07 08:58:55.855: V/WindowManager(1679): Finished animation in AppWindowToken{418942a0 token=Token{41836990 ActivityRecord{41836858 com.whatstherex.sam/.Splash}}} @ 160703906
01-07 08:58:55.855: V/WindowManager(1679): Starting animation in AppWindowToken{41814af8 token=Token{417bfa58 ActivityRecord{417bf920 com.whatstherex.sam/.Login}}} @ 160703906
01-07 08:58:55.875: D/OpenGLRenderer(6100): Flushing caches (mode 0)
01-07 08:58:55.875: D/memalloc(1448): ashmem: Freeing buffer base:0x42104000 size:1536000 fd:37
01-07 08:58:55.885: E/SurfaceTexture(1448): [com.whatstherex.sam/com.whatstherex.sam.Splash] abandon: SurfaceTexture(0x0x6239e8) has been abandoned!
01-07 08:58:55.895: D/memalloc(1448): ashmem: Freeing buffer base:0x41ecb000 size:1536000 fd:31
01-07 08:58:56.065: W/memalloc(1448): Falling back to ashmem
01-07 08:58:56.075: V/WindowManager(1679): Finished animation in AppWindowToken{41814af8 token=Token{417bfa58 ActivityRecord{417bf920 com.whatstherex.sam/.Login}}} @ 160704136
01-07 08:58:56.085: D/memalloc(1448): ashmem: Allocated buffer base:0x41ecb000 size:1536000 fd:31
01-07 08:58:56.095: D/memalloc(6100): ashmem: Mapped buffer base:0x52287000 size:1536000 fd:63
01-07 08:58:56.095: I/Adreno200-EGLSUB(1448): <CreateImage:893>: Android Image
01-07 08:58:56.095: I/Adreno200-EGLSUB(1448): <GetImageAttributes:1102>: RGBA_8888
01-07 08:58:56.115: D/dalvikvm(1794): GC_BEFORE_OOM freed 150K, 51% free 7261K/14563K, paused 247ms
01-07 08:58:56.556: I/Adreno200-EGLSUB(1448): <CreateImage:893>: Android Image
01-07 08:58:56.556: I/Adreno200-EGLSUB(1448): <GetImageAttributes:1102>: RGBA_8888
01-07 08:58:56.876: D/AndroidRuntime(6159): >>>>>> AndroidRuntime START com.android.internal.os.RuntimeInit <<<<<<
01-07 08:58:56.876: D/AndroidRuntime(6159): CheckJNI is OFF
01-07 08:58:57.286: D/AndroidRuntime(6159): Calling main entry com.android.commands.am.Am
01-07 08:58:57.296: I/com.fd.httpd(26432): onStart
01-07 08:58:57.296: D/AndroidRuntime(6159): Shutting down VM
01-07 08:58:57.306: I/AndroidRuntime(6159): NOTE: attach of thread 'Binder Thread #3' failed
01-07 08:58:57.306: D/dalvikvm(6159): GC_CONCURRENT freed 106K, 71% free 613K/2048K, paused 0ms+0ms
01-07 08:58:57.306: D/jdwp(6159): Got wake-up signal, bailing out of select
01-07 08:58:57.306: D/dalvikvm(6159): Debugger has detached; object registry had 1 entries
01-07 08:58:57.877: D/PhoneStatusBarPolicy(1760): ServiceState ss: 0
01-07 08:58:57.877: D/PhoneStatusBarPolicy(1760): Network Type: 8
01-07 08:58:59.138: I/Adreno200-EGLSUB(6100): <ConfigWindowMatch:2078>: Format RGBA_8888.
01-07 08:58:59.148: W/memalloc(1448): Falling back to ashmem
01-07 08:58:59.148: D/memalloc(1448): ashmem: Allocated buffer base:0x419a8000 size:245760 fd:37
01-07 08:58:59.148: D/memalloc(6100): ashmem: Mapped buffer base:0x521a8000 size:245760 fd:61 
```

我从调试中得到的错误也是

```
Thread [<11> AsyncTask #1] (Suspended (exception RuntimeException)) 
    <VM does not provide monitor information>   
    ThreadPoolExecutor.runWorker(ThreadPoolExecutor$Worker) line: 1094  
    ThreadPoolExecutor$Worker.run() line: 569   
    Thread.run() line: 864 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T01:09:25.887

您不能以任何方式从其他线程（不是 UI 线程）修改 UI。因此，在 AsyncTask.doInBackground 方法中创建/显示/关闭对话框是非法的，并且您遇到了崩溃。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T02:22:21.633

Don't do like this on doInBackground, it's not a UI thread.

```
loginDialog = new AlertDialog.Builder(Login.this).create();
loginDialog.setTitle("Login Alert!");
loginDialog.setButton(DialogInterface.BUTTON_NEGATIVE, "Back", new DialogInterface.OnClickListener() {
    public void onClick(DialogInterface dialog, int which) {
        // TODO Auto-generated method stub
        loginDialog.dismiss();
    }
}); 
```

You may return the action as string, which is why you have this:

```
protected String doInBackground(String... params) 
```

pass and evaluate it in `onPostExcecute()` if you want to dismiss dialog (if you're not evaluating anything after the job done, just put a `Void` instead of `String`). If you want to create dialog, do it on `onPreExecute()`. They both run on UI thread.

For example:

```
@Override
protected void onPreExecute() {
super.onPreExecute();
    progressDialog = new ProgressDialog(context);
    progressDialog.setCancelable(false);
    progressDialog.setProgressStyle(ProgressDialog.STYLE_SPINNER);
    progressDialog.setMessage("Sending message....");
    progressDialog.show();
} 
```

[http://developer.android.com/reference/android/os/AsyncTask.html#onPostExecute(Result)](http://developer.android.com/reference/android/os/AsyncTask.html#onPostExecute%28Result%29)

# ios - 自动布局约束：调整大小时，将空间不均等地分配给子视图？

> ID：14188389
> 
> 赞同：4
> 
> 时间：2013-01-07T00:39:26.710
> 
> 标签：ios, xcode, autolayout

用一个例子来证明我的问题可能是最简单的，所以这里是：

我有一个容器视图，它有两个子视图，A 和 B。

容器：240x80

A：80x80，固定前导/顶部/底部间距。

B：160x80，固定前导/顶部/底部间距，与 A 固定的 h 间距。

![在此处输入图像描述](../Images/56931f2f59cfa632e150420f882c3c51.png)

现在，当我将容器的大小调整为 480x80 时，我得到了这样的结果： ![在此处输入图像描述](../Images/8a0dfe78bcd0eb17acab16cf74c71074.png)

那是因为 Xcode 认为我的约束不明确，所以它为我固定了 A 的宽度，并将所有额外的水平空间留给了 B。

好的，我理解它的担忧，但我真正想要的是让 A 和 B 按比例调整大小，如下所示：

![在此处输入图像描述](../Images/275a12399334aba59d087291db77166f.png)

我的预感是它与 Hugging/Compression Resistance Priority 设置有关，但我不知道如何设置这些值以获得我想要的结果！

换句话说，当容器被放大时，我如何指定多余的空间去哪里？如何设置优先级以便空间分配给视图 A 和视图 B 4:6？5:5？8:2？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-07T01:11:51.810

这与您刚刚提出的另一个问题非常相似。使用乘数进行约束，使一个视图的宽度等于另一个视图的宽度，以获得您想要的比率：

```
NSLayoutConstraint *con = [NSLayoutConstraint constraintWithItem:self.viewA attribute:NSLayoutAttributeWidth relatedBy:NSLayoutRelationEqual toItem:self.viewB attribute:NSLayoutAttributeWidth multiplier:0.5 constant:0]; 
```

这个约束需要添加到视图 A 和 B 的父视图中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-08-07T23:12:42.567

并不是说提供的答案不值得，但您现在应该能够在 Xcode (5.1.1) 中通过在视图 A 和视图 B 之间创建相等的宽度约束并设置乘数来做到这一点。

为此，请删除这两个视图之间可能存在的任何其他宽度约束，然后控制从视图 A 到视图 B 的拖动并选择等宽约束。从 Document Outline 视图中选择该约束，然后在检查器中，将 Multiplier 更改为您想要的比率。在您的情况下，它看起来可能是 1:3 或接近的值。以下是我的看法：

![在此处输入图像描述](../Images/73794b5f5a8a21347e92d6d6e333afc3.png)

检查员应该是什么样子：

![在此处输入图像描述](../Images/bcce4d9cf801023ca2f36da5d27e4824.png)

只是玩比率，直到你做对了。

# iphone - 在 xCode 中创建一个 iPhone 应用程序，我需要使用 Microsoft SQL Server 中的数据填充它。这可能吗？

> ID：14188393
> 
> 赞同：0
> 
> 时间：2013-01-07T00:39:57.763
> 
> 标签：iphone, sql-server, xcode

在 xCode 中创建一个 iPhone 应用程序，我需要使用 Microsoft SQL Server 中的数据填充它。这可能吗？如果是这样，是否有任何在线教程可以帮助我？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T00:48:39.367

是的，很有可能。[这](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/URLLoadingSystem/Tasks/UsingNSURLConnection.html)是使用 NSURLConnection 的一个很好的开始，然后您应该查找 NSJSONSerialization 或 XML 解析来处理数据。基本上，您的服务器上需要一个 .php 文件，您可以使用它来查询 MySQL 并返回您喜欢的格式。

那里有很多教程，还有一些关于从数据库解析 JSON 或 XML 的很棒的 YouTube 视频。

对于 TableView 填充和异步下载，Apple 提供了名为 LazyTableView 的示例代码。

这个网站也充满了例子。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T02:00:53.670

我建议使用 3 层模型。

*   您的数据库
*   一种网络服务，当您的应用向网络服务发送请求时从数据库中获取数据
*   您的应用程序，它连接到 Web 服务并从 Web 服务请求数据，而 Web 服务又连接到数据库。

为什么这么复杂？因为如果你直接在你的 iPhone 应用程序中连接到你的数据库，而没有它之间的网络服务。（如果这在 iPhone 应用程序中甚至是可能的）那么您将面临安全风险，因为您的应用程序将包含您的数据库连接字符串。

# php - 为什么从 PHP 5.4 开始永久启用“echo”短标签？

> ID：14188397
> 
> 赞同：36
> 
> 时间：2013-01-07T00:40:30.397
> 
> 标签：php, coding-style, php-shorttags

甚至官方文档也曾经告诉我们[PHP 的“短标签”（`<? /*...*/ ?>`）是“坏的”](https://stackoverflow.com/questions/200640/are-php-short-tags-acceptable-to-use)。但是，[从 PHP 5.4 开始，无论设置如何，该`echo`品种`<?= /*...*/ ?>``short_open_tag`](http://php.net/manual/en/language.basic-syntax.phpmode.php)都将永久启用。

*有什么改变？*

即使他们之前仅仅因为是否`short_open_tag`在共享主机平台上启用了不可预测的特性而气馁，那么这个论点肯定不会仅仅因为某些主机子集将运行 PHP 5.4 而消失吗？

可以说，对语言的这种改变并不意味着我们应该避免“短标签”的建议的改变，但是如果他们遇到了麻烦，那么 PHP 开发人员肯定看起来不再“讨厌”他们所以很多。对？

*目前我能得出的唯一合乎逻辑的结论是，在 PHP 5.4 中引入这种更改必须有一些客观的理由。*

*它是什么？*

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2013-01-07T00:46:29.163

**自 PHP 5.4 起，短开放标签**并不总是启用。该文档讨论了**简短的回声标签**。这是另一回事。（短开放标签是`<?`样式标签，短回声标签是`<?=`样式标签，用于回显）。

那为什么现在默认启用它们？好吧，那里有很多脚本，使用它`<?= $somevar ?>`而不是`<?php echo $somevar ?>`. 并且[因为短回显标签没有短开放标签那么糟糕，所以他们选择始终启用短回显标签](https://wiki.php.net/rfc/shortags)。因为现在（框架和 CMS-es 的）开发人员可以依靠它们（或者更确切地说，当 PHP 5.4 成为主流时）。

但是，短**打开**标签仍然受`short_open_tag`php.ini 中设置的影响。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-07T00:47:29.093

只有短回显标签 ( `<?=`) 是永久启用的，而不是短打开标签 ( `<?`)。这是因为当您创建 HTML 模板（或任何其他视图模板）时，短回显标签非常方便，而没有它，您必须编写更多内容（例如`<?php echo $var; ?>`，而不是仅仅`<?= $var ?>`）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-07T00:45:40.940

**注意：**从 PHP 5.4 开始**`<?=`**，无论 short_open_tag 设置如何，短回显标签始终被识别并有效。

这就是说，它`<?=`总是有效的，而不是`<?`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-11-12T13:09:48.177

原因是`< ?`在 XML 文档中使用它并且启用 short_open_tags 会在 XML 代码中产生错误。但是，,`< ?=`就像`< ?php`不是 XML 开放标签一样，可以安全使用。

# css - 调整浏览器大小时显示右边距

> ID：14188404
> 
> 赞同：1
> 
> 时间：2013-01-07T00:41:33.530
> 
> 标签：css, html, responsive-design, media-queries

我用它来使包含所有内容的主 div 居中。

```
#main {
margin-left: 10%;
margin-right: 10%;
width: 100%;
height: 100%;
} 
```

我必须创建一个响应式站点，以便在减小浏览器的大小时，我希望右侧的边距保持在那里。目前，我的 div 随尺寸减小，但右侧没有边距。

另外，我也不认为主 div 居中。

非常感谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T01:08:50.997

```
<div style="width: 80%; 
         position: relative; 
             left: 10%; 
            align: center; 
 background-color: red;"></div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T08:32:27.120

我现在想通了。改用它并在@media中粘贴相同的内容

```
#main {
 margin-left: 10%;
 margin-right: 10%;
 } 
```

像魅力一样工作。感谢 Titanium 和 Brian 的帮助。非常感激

:D

# c# - 禁用列表视图控件中项目的复选框

> ID：14188412
> 
> 赞同：0
> 
> 时间：2013-01-07T00:42:48.477
> 
> 标签：c#, winforms, listview, checkbox

我可以控制并设置`Checkboxes`为`ListView`True。此外，我在`ListView`一项一项中添加项目。它不绑定到`DataSet`/ `DataTable`。

有时，我`Checkbox.Checked = true`在我的`ListView`.

```
i.e. listview1.Items(i).Checked = True 
```

对于将 Checked 属性设置为 true 后的某些项目，我想禁用 ，以便`Checkbox`用户无法**取消选中**.`CheckBox`

我正在尝试找出有关如何**禁用**的选项`Checkboxes`，但尚未找到解决方案。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-06-28T08:08:18.663

对我来说，这有效：处理*ListView.ItemCheck*事件。

在那里使用以下代码：

```
private void listView1_BeforeCheck(object sender, ItemCheckEventArgs e)
{
    if (!CheckEnabled(e)) // check somehow if clicked item is disabled
        e.NewValue = e.CurrentValue;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T15:51:34.253

这是第 3 方控件[Better ListView](http://www.componentowl.com/better-listview)，但您可能会感兴趣。它支持自定义复选框的外观和隐藏（最后两项隐藏了复选框）：

![在此处输入图像描述](../Images/9af0addc2ae0219805c513d0347866b3.png)

要隐藏特定项目上的复选框，只需使用：

```
betterListView.Items[0].CheckBoxAppearance = BetterListViewCheckBoxAppearance.Hide; 
```

复选框的正常用法与 .NET ListView 中的相同，您可以使用两态或三态复选框甚至单选按钮...

# intellij-idea - 必须双击 IntelliJ 中的菜单项才能执行所需的功能

> ID：14188418
> 
> 赞同：0
> 
> 时间：2013-01-07T00:44:08.617
> 
> 标签：intellij-idea

我最近安装了 IntelliJ 12，并注意到我必须始终双击才能执行常见操作，例如执行菜单命令或通过单击“X”关闭选项卡。然而，我的队友没有遇到同样的问题，所以我倾向于认为这是一个配置问题。

有没有人遇到过这个问题？我设置了“从源自动滚动”选项，现在可以一键打开文件。我仍然必须双击菜单项。

# java - 使用java模拟javascript doPostBack解析结果html

> ID：14188419
> 
> 赞同：0
> 
> 时间：2013-01-07T00:44:23.473
> 
> 标签：java, javascript, parsing, call, dopostback

> **可能重复：**
> [使用回发解析 .Net 页面](https://stackoverflow.com/questions/1245782/parse-a-net-page-with-postbacks)

我有一个要解析的网站（它属于我的客户，所以没有版权或问题）。它有很多我想调用和解析返回的 html 的链接。但这些链接实际上是`doPostBack`javascript 调用。那么有什么方法可以通过Java创建这样的调用并获得结果html？

网站： **[http://myclient.something/ProductCatalog.aspx?family=20](http://myclient.something/ProductCatalog.aspx?family=20)**

javascript调用：

```
__doPostBack('ctl00$wpmMain$wp1312556404$wp432345009$tvwCatalog','sBLG')" 
```

我怎样才能模拟那个javascript调用？

# c - 如何在 Windows 下以编程方式确定驱动器是否为 DVD-RW/CD-RW？

> ID：14188428
> 
> 赞同：1
> 
> 时间：2013-01-07T00:45:27.993
> 
> 标签：c, winapi, visual-c++, device, drive

我想阻止用户将文件备份到光盘，所以我必须确定 CDROM 驱动器是否可写。

Windows下怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T00:48:35.163

Windows CD 刻录机的驱动器索引（0 = A、1 = B 等）可以在注册表中的**HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\CD Burning\DriveIndex**中找到。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T00:51:16.017

如本页所述：http: [//msdn.microsoft.com/en-us/library/windows/desktop/bb776153%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/bb776153%28v=vs.85%29.aspx)

GetRecorderDriveLetter 将返回作为刻录机的驱动器号（如果存在），如果没有可以刻录 CD 的驱动器，它将返回错误代码。

如果您需要更多示例，只需搜索 API

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-07T02:04:38.703

您可以使用开源 CD/DVD 录制应用程序[InfraRecorder](http://infrarecorder.org/) ( [git repo](http://sourceforge.net/p/infrarecorder/code) ) 使用的方法。

InfraRecorder 使用[ckmmc](https://github.com/kindahl/ckmmc)库来获取使用类的兼容设备列表`ckmmc::DeviceManager`（当然，它支持多个设备）。

首先它使用 ckmmc 扫描所有设备`DeviceManager::scan()`，然后使用方法检查设备是否是记录器`MmcDevice::recorder()`。

你会认为必须有更简单的方法来使用类似`GetDriveType()`or的东西来做到这一点`DeviceIoControl()`，但不幸的是它并不是那么简单。

`ckmmc`支持两种不同的设备访问方法：ASPI（高级 SCSI 编程接口）和 SPTI（SCSI Pass-Through 接口）。要获取驱动器属性，它实际上会向设备发送 SCSI 命令，然后它才能分析 SCSI 模式页面并判断哪些记录模式（CD-R、CD-RW、DVD-R、DVD+R 等）硬件支持（如果有的话）。

# jquery-mobile - 有什么方法可以独立使用 jQuery 移动小部件？

> ID：14188429
> 
> 赞同：4
> 
> 时间：2013-01-07T00:45:29.117
> 
> 标签：jquery-mobile, twitter-bootstrap

我有一个使用 Twitter Bootstrap 构建的网站，但我想将 jQuery Mobile 的手风琴小部件用于可折叠内容。我使用了他们的[下载生成器](http://jquerymobile.com/download-builder/)，只选择了手风琴小部件。我认为问题在于核心 jquery.mobile.js 文件中仍有一些代码与 bootstrap.js 冲突，因为它最终会改变我的链接在导航菜单中的行为。它将每个常规链接视为一个 ajax 请求，这确实与我的应用程序有关。

有没有人有 jQuery mobile 和 Bootstrap 的经验？有没有办法更改默认设置，以便只操作手风琴小部件？或者该小部件是否有更好的移动友好型替代品？我真诚地感谢我能得到的任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T17:38:50.027

我应该在不久前更新这个。要禁用 ajax，请运行：

```
$.mobile.ajaxLinksEnabled = false; 
```

这将导致所有链接都被视为普通锚点，使其与 Bootstrap 兼容。

# android - 每隔一段时间更改按钮中的文本颜色

> ID：14188432
> 
> 赞同：0
> 
> 时间：2013-01-07T00:45:47.957
> 
> 标签：android

```
Timer t = new Timer();
t.scheduleAtFixedRate(new TimerTask() {
    public void run() {
    // TODO Auto-generated method stub
    Log.i("first iteration","first iteration");
    btn1.setTextColor(Color.rgb((int)(Math.random()*255), (int)(Math.random()*255), (int)(Math.random()*255))); 
    Log.i("iterating","iteratinggggggggg"); 
                        }
                    }, 0, 1000); 
```

在 Logcat 中：

```
01-07 02:39:09.789: I/first iteration(16568): first iteration
01-07 02:39:09.789: I/iterating(16568): iteratinggggggggg
01-07 02:39:10.781: I/first iteration(16568): first iteration 
```

这意味着它只`btn1.setTextColor(...)`执行**一次**！我希望每**1 秒**更改一次**按钮文本**。

 **有高手可以帮忙吗？

感谢 Ole，我可以找到我想与您分享的问题的解决方案：

**解决方案：**

```
// UPDATING BTN TEXT DYNAMICALLY
    Runnable myRunnableUpdater = new Runnable()
    { 
        public void run() {
            colorGenerator();
            hd.postDelayed(myRunnableUpdater, 1000);
        }
    };
    void startRepeatingTask()
    {
        myRunnableUpdater.run(); 
    }
    void stopRepeatingTask()
    {
        hd.removeCallbacks(myRunnableUpdater);
    }

    private void colorGenerator() {
        btn1.setTextColor(Color.rgb((int)(Math.random()*255), (int)(Math.random()*255), (int)(Math.random()*255)));
    }
    //END OF UPDATING BTN TEXT DYNAMICALLY!! 
```

1）不要忘记声明`Handler hd`
2）此外，`hd = new Handler()`在`onCreate()`
3）中，`startRepeatingTask()`在您希望重复代码的任何地方使用。
4）`stopRepeatingTask()`在您希望停止重复的任何地方使用。

干杯! ;)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T01:03:07.733

您的应用程序正在强制关闭，因为您正试图从由`Timer`. 只允许主线程更新 UI。这可以使用`Handler`

看看[这个](https://stackoverflow.com/a/6702767/742660)关于如何实现这个的答案。**

# sql - 仅当存在条目时如何有条件地应用“where”条件

> ID：14188435
> 
> 赞同：0
> 
> 时间：2013-01-07T00:46:09.520
> 
> 标签：sql, select, join

我想基于 3 个其他表创建一个临时表。但是有一个条件可能适用也可能不适用，具体取决于第三张表中是否存在条目。如何在“where”条件下插入不同的案例？

```
select table1.tran_num, table2.impact
from table 1, table2, table3
where tables1.tran_num = 12345
and table1.index = table2.index
"and case when table2.index in table3.index then table2.version = table3.version" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T00:51:07.900

你只需要使用`INNER JOIN`

```
select  table1.tran_num, table2.impact
from    table1 
        INNER JOIN table2
            ON table1.index = table2.index
        INNER JOIN table3
            ON table2.version = table3.version
where   tables1.tran_num = 12345 
```

上面的查询仅在所有表中都存在所有记录时才显示记录。但是，如果您希望即使在 上不存在的列仍然显示记录`version`，`table2`那么`table3`a`LEFT JOIN`是必需的。

```
select  table1.tran_num, table2.impact
from    table1 
        INNER JOIN table2
            ON table1.index = table2.index
        LEFT JOIN table3
            ON table2.version = table3.version
where   tables1.tran_num = 12345 
```

要了解更多关于加入的信息，请参阅下面的文章

*   [SQL 连接的可视化表示](http://www.codeproject.com/Articles/33052/Visual-Representation-of-SQL-Joins)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T00:56:05.550

使用左连接和 where 子句类似于

```
where joined_table.id is null or joined_table.filter_col in (1,2,3) 
```

例如：

```
select t1.id, t2.id
from table1 t1
left join table2 t2
 on t1.fk_id = t2.id
where t2.id is null or t2.filter_col in (1,2,3,4) 
```

上面的查询将从 t1 获取不在 t2 上的所有记录，或者从 t1 获取在 t2 上的记录，并且它们在 t2 上的等效 filter_col 在 (1,2,3,4)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T00:57:12.813

你可以试试下面的逻辑：

```
 IF EXISTS ( SELECT *
 FROM tablea a Left JOIN tableb b 
ON a._id = b._id 
Left JOIN tablec c ON b._id = c._id 
 SELECT 1 ELSE SELECT 0 
```

# wordpress - WordPress 插件上传默认为 777 权限

> ID：14188440
> 
> 赞同：0
> 
> 时间：2013-01-07T00:46:58.253
> 
> 标签：wordpress, nginx, chmod, php

我目前在 nginx/1.2.6 上使用 WordPress 3.5，并在我的 VPS 上设置 PHP-FPM Web 服务器。每当我上传 wordpress 插件时，我注意到一个重大的安全问题，它会将所有目录和文件默认为 777 权限。这意味着我需要手动更正这些文件权限。我想知道那里是否有其他人经历过这种情况或知道是什么原因造成的以及如何解决它，以便正确设置正确的权限。

任何支持性建议将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T00:57:21.700

仅拥有具有 777 权限的文件夹并不意味着存在安全问题。如果有一个错误的上传器 PHP，那么黑客可以将后门文件放入这些文件夹。AFAIK wordpress 需要可写文件夹来上传和安装插件。如果你保持你的 wordpress 是最新的，并且如果你没有一个错误的 PHP 上传器，你就没有风险。

# ruby-on-rails - 我应该如何从外部 API（使用 rails）显示最新数据？

> ID：14188446
> 
> 赞同：1
> 
> 时间：2013-01-07T00:48:08.873
> 
> 标签：ruby-on-rails, ajax, web-services, api, harvest

因此，我正在尝试构建一个小型 Rails 应用程序，供我工作的小型设计/开发机构内部使用。我对 Rails 很陌生（我是前端开发人员），但我正在学习。

该应用程序的目标是从[Harvest](http://www.getharvest.com/api)中提取数据，并显示 10 名员工中每人每天/每周/每月的工作时间，以及其他信息，例如他们当前是否活跃以及他们的工作有多少是可计费的。信息应该每分钟更新一次。

我只需要一些关于构建这个项目的最佳实践的建议，因为我正在使用的大部分数据都来自外部来源。我最初尝试在我的 pg 数据库中存储每个用户的姓名、电子邮件和收割 ID，然后使用收割 ID 作为参考来查询 Harvest 以获取我需要的数据。这是我如何获取工作报告的示例：

```
 def harvest_user
      harvest.users.find(self.harvest_id)
    end

    def entries(interval, billable)
      user = self.harvest_user
      entries = harvest.reports.time_by_user(user, interval, DateTime.now, billable)
      sum = 0
      entries.each do |entry|
        hrs = entry.hours.to_s.to_f
        sum += hrs
      end
      sum.round(1)
    end 
```

然后，我通过对部分呈现数据进行 ajax 调用每分钟更新一次数据。

一切正常，但初始页面加载真的很慢，所以我想我一定是做错了什么。

有什么建议吗？我觉得我可以想出一些关于进行一个大的 api 调用然后根据需要过滤这些数据的想法，但我不确定从哪里开始。

谢谢！

# python - 获取多个同名请求参数

> ID：14188451
> 
> 赞同：57
> 
> 时间：2013-01-07T00:48:42.470
> 
> 标签：python, flask

我的问题是使用给定的代码：

```
from flask import Flask, request

app = Flask(__name__)

@app.route("/")
def hello():
    return str(request.values.get("param", "None"))

app.run(debug=True) 
```

我访问：

```
http://localhost:5000/?param=a&param=bbb 
```

我应该期待 ['a', 'bbb'] 的输出，除了 Flask 似乎只接受第一个参数而忽略其余参数。

这是 Flask 的限制吗？还是设计使然？

* * *

## 回答 #1

> 赞同：106
> 
> 时间：2013-01-07T00:56:01.420

您可以使用`getlist`，它类似于 Django 的`getList`，但由于某种原因在 Flask 文档中未提及：

```
return str(request.args.getlist('param')) 
```

结果是：

```
[u'a', u'bbb'] 
```

如果`request.args`参数在查询字符串中（如问题中），`request.form`如果值来自具有相同名称的多个表单输入，则使用。 `request.values`两者结合，但通常应避免用于更具体的集合。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-08-16T09:38:32.043

如果你`$('form').serialize()`在 jQuery 中对表单数据进行编码，你可以使用它`request.form['name']`来获取数据，但请注意，当多个输入元素的名称相同时，`request.form['name']`只会获取第一个匹配的项目。所以我从 Flask API 检查了表单对象，我发现[了这个](http://flask.pocoo.org/docs/0.11/api/#flask.Request.form). 然后我检查了[MultiDict 对象](http://werkzeug.pocoo.org/docs/datastructures/#werkzeug.datastructures.MultiDict)，我找到了函数`getlist('name')`。

如果有多个同名输入，请尝试以下方法：`request.form.getlist('name')`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2020-03-06T09:05:15.763

另一种选择是使用带有 request.args 的平面 json 结构。因为有时你根本不知道参数，你不能使用`.getlist()`.

```
arguments = request.args.to_dict(flat=False)

# Get a specific parameter
param = arguments.get('param')
print(param)

# Get all the parameters that have more than one value
for field, values in arguments.items():
    if len(values) > 1:
        print(values) 
```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2017-09-12T10:19:50.097

> 另一种方法是您可以使用一个键和一个包含多个值的值，然后在服务器中您可以拆分并做任何您想做的事情。希望这对某人有帮助

```
http://localhost/api/products/filters?Manufacturer=Dell|HP|HUAWEI|Lenovo 
```

### 或者

```
http://localhost/api/products/filters?Manufacturer=Dell_HP_HUAWEI_Lenovo 
```

### 或者

```
http://localhost/api/products/filters?Manufacturer=Dell__HP__HUAWEI__Lenovo 
```

# backbone.js - 如何识别未定义的内容

> ID：14188458
> 
> 赞同：2
> 
> 时间：2013-01-07T00:50:41.193
> 
> 标签：backbone.js

我的主干应用程序出现未定义的错误。我无法弄清楚什么是未定义的。在路由器的索引功能里，我有这个

```
 var view = new Enki.Views.EntriesIndex();
  console.log(view);
  $('#container').html(view.render().el); 
```

最后一行给了我这个错误

未捕获的类型错误：无法读取未定义的属性“el”

表明`console.log(view)`正在`view = new Enki.Views.EntriesIndex();`实例化。部分日志包含

```
 outerHTML: "<div><h1>Enki</h1>↵↵Entries go here↵&lt;/div>"
   outerText: "Enki↵↵Entries go here↵" 
```

该日志输出来自视图的渲染功能

```
render: function(){
  $(this.el).html(this.template({
  entries: "Entries go here"
  }));
 } 
```

这是模板。。

```
 <h1>Enki</h1>

  <%= entries %> 
```

...它没有被插入到“容器”div中，而是在视图中被读取，如上面的日志输出所示。没有任何内容被插入到主页上的容器 div 中。

```
<div id="container">...</div> 
```

谁能告诉我什么是“未定义”以及如何解决它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T00:54:52.147

一个合理的假设是您的`render`函数不返回任何内容，因此`view.render()`未定义。

尝试更改您的渲染函数，使其返回对`this`对象的引用。

```
render: function(){
  $(this.el).html(this.template( {entries: "Entries go here"} ))
  return this // <- important
} 
```

# c# - LINQ 选择属于至少一个选定类别的公司

> ID：14188461
> 
> 赞同：0
> 
> 时间：2013-01-07T00:50:52.320
> 
> 标签：c#, linq

我有一个类别列表（CategoryID's） List categoryIds; 此列表包含一些基于用户先前选择的 id。

然后我有一个数据库，其中包含可以成为一个或多个类别成员的公司。这是在连接表 CompaniesInCategory 中维护的，这会产生像 company.Categories 这样的对象结构。

现在我的问题是，我如何选择至少属于所选类别之一的所有公司。

```
List<int> categoryIds = new List<int>() {123, 3, 5858, 23};    
List<company> companies = (from c in context.Companies
                           where c.Categories.(one of the Id's of these c.Categories should be in the list named categoryIds) 
                           select c); 
```

每个公司都有一个附加的类别列表。从这个类别列表（c.Categories）（它们都有一个 CategoryId）中，至少有一个必须与列表 categoryIds 中的一个 id 匹配。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T02:24:27.847

```
var companies = dc.Companies
    .Where(c => c.Categories.Any(cat => categoryIds.Contains(cat.Id))) 
```

*“至少一个”*通常最好地转化为 LINQ 的`Any()`方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T02:29:21.330

似乎你在谈论这个：

```
var categoryIds=(new[] { 123, 3, 5858, 23 }).ToList();

var category=
    new {
        Id=123
    };

var company=
    new {
        Categories=(new[] { category }).ToList()
    };

var context=
    new {
        Companies=(new[] { company }).ToList()
    };

var companies=(
    from c in context.Companies
    from x in c.Categories
    from y in categoryIds
    where x.Id==y
    select c
    ).ToList(); 
```

所以你指定的地方：

```
where c.Categories.(one of the Id's of these c.Categories should be in the list named categoryIds) 
```

将会：

```
where c.Categories.Any(x => categoryIds.Contains(x.Id)) 
```

因为`companies`相当于：

```
var companies=(
    from c in context.Companies
    where c.Categories.Any(x => categoryIds.Contains(x.Id))
    select c
    ).ToList(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T00:54:27.353

```
List<int> categoryIds = new List<int>() {123, 3, 5858, 23};    
List<company> companies = (from c in context.Companies
                           where categoryIds.Contains(c.Categories)
                           select c).ToList();  //I would add .ToList() since List<company> 
```

这应该工作

如果您的列表实际上只有 4 个整数，那么您也可以执行类似的操作

```
where c.Categories == 123 || c.Categories == 3 || //ect. 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-07T00:57:37.080

我不像以前那样熟悉理解语法，但假设类别字段名为**CategoryId**，我相信 lambda 版本是：

```
var companies = dc.Companies
    .Where(c => categoryIds.Contains(c.CategoryId)) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-07T02:16:56.517

据我了解您的问题，我应该检查（DB）类别表与类别列表。然后获取所有成员公司是类别表。

```
List<int> categoryIds = new List<int>() {123, 3, 5858, 23};    
List<company> companies = (from c in context.Companies
                           from b in context.Categories //Asuming there is a index table of some sort
                           where categoryIds.Contains(b.CatID) && c.companyID == b.companyID
                           select c).ToList(); 
```

# android - 如何在android中扩展视图？

> ID：14188470
> 
> 赞同：0
> 
> 时间：2013-01-07T00:51:50.223
> 
> 标签：android, android-layout

我有一个 base.xml 视图：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="horizontal" >

    <TextView
        android:id="@+id/shown_path"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text=" Test" />
</LinearLayout> 
```

我想再创建两个视图：

带有 TextView 的 view1.xml 和带有 Button 的 view2.xml（都是“扩展”base.xml）。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T00:59:28.777

你不能。您只能将 xml 布局包含到另一个布局中（[包含/合并](http://developer.android.com/training/improving-layouts/reusing-layouts.html)）

# python - 在 Python 中解码 JSON 时遇到问题

> ID：14188473
> 
> 赞同：1
> 
> 时间：2013-01-07T00:52:44.563
> 
> 标签：python, json

在 Python 方面，我是初学者，我正在尝试学习如何使用 JSON 对象等数据结构，但我在尝试从 JSON 对象中实际获取数据时遇到了困难。

这是内容示例 JSON 数据文件。

`{"data":{"internalName":"value","int":1}}`

我可以通过已有的代码打印文件中的数据，但我只想打印某个值，例如`internalName`. 我将如何使用我已有的代码打印它？

```
import json
json_data=open('data.txt')
data = json.load(json_data)
print json.dumps(data)
json_data.close() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T00:55:37.523

您可以将生成的数据结构视为[字典](http://docs.python.org/2/tutorial/datastructures.html#dictionaries)。在这种情况下，您在结构内部有一个`key`被调用，并且该键的 是另一个字典，它有两个键：和。为了访问这些值，您可以使用以下示例中的语法：`data``value``internalName``int`

```
In [1]: import json

In [2]: s = '{"data":{"internalName":"value","int":1}}'

In [3]: data = json.loads(s)

In [4]: print data
{u'data': {u'int': 1, u'internalName': u'value'}}

In [5]: data['data']['internalName']
Out[5]: u'value' 
```

所以在你的情况下，你定义后`data`，你可以以类似的方式访问它。另外，我建议使用`with`打开文件，因为它将为您处理关闭（当您离开缩进块时）：

```
import json

# 'with' is called a context manager, and it handles closing for you when
# you leave the indented block
with open('data.txt', 'r') as f:
    data = json.load(f)

# When the code leaves the indented block, the file is closed for you

# Print the entire structure
print json.dumps(data)

# Print out a piece of the data
print data['data']['internalName'] 
```

# c# - 获得用户通知的正确方法

> ID：14188475
> 
> 赞同：1
> 
> 时间：2013-01-07T00:53:09.857
> 
> 标签：c#, asp.net-mvc

我想知道在 ASP.Net MVC 4 C# 中创建网站以发送电子邮件并在需要时执行其他操作的最佳方式是什么。我给你举个例子：

将在中部时间下午 2:30 预约前 15 分钟通过电子邮件通知用户 A。然后系统会在中部时间下午 2 点 15 分自动向他发送一封电子邮件以提醒他。

我知道这是一个简单的问题，但老实说，我不想（除非这是唯一的方法）使用一个系统，它坐在那里并 ping 一个页面以每分钟检查和发送通知（这是我能想到的唯一方法截至目前。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T05:24:29.643

试试看一下[Quartz .Net](http://quartznet.sourceforge.net/)。它是用于 Java 的 Quartz 的 .Net 端口。我过去曾用它来安排时间。您应该能够让它在后台的 Windows 服务上运行，并在用户需要在 Y 时间前 X 分钟触发的提醒时创建一个定时事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T03:23:29.367

正确的方法是通过窗口服务。您无需 ping 页面，而是让窗口服务不断轮询数据库或数据源以了解任务的当前计划。

# sql - 仅选择第一个结果...有更好的方法吗？

> ID：14188495
> 
> 赞同：2
> 
> 时间：2013-01-07T00:55:52.670
> 
> 标签：sql, sql-server, sql-server-2008, tsql

可以有多个 Config_RecID，但我只想显示附加到 SR_Service_RecID 的第一个，或者当为空时为 NULL。

```
SELECT s.SR_Service_RecID
     , sc.Config_RecID

  FROM SR_Service s
       LEFT JOIN SR_Config sc
              ON sc.SR_Service_RecID = s.SR_Service_RecID

 WHERE (sc.Config_RecID = 
       (
           SELECT TOP 1 sc.Config_RecID
             FROM SR_Config sc 
            WHERE sc.SR_Service_RecID = s.SR_Service_RecID
       ) 
       OR sc.Config_RecID IS NULL) 
```

有没有更好/更整洁的方法来做到这一点，还是我走在正确的轨道上？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T01:04:12.187

您可以将条件移动到`ON`子句中：

```
SELECT s.SR_Service_RecID
     , sc.Config_RecID
FROM SR_Service s
LEFT JOIN SR_Config sc
     ON sc.SR_Service_RecID = s.SR_Service_RecID
     AND sc.Config_RecID = (
           SELECT TOP 1 Config_RecID
           FROM SR_Config sc2 
           WHERE sc2.SR_Service_RecID = s.SR_Service_RecID
     ) 
```

这样你就不需要额外的检查`sc.Config_RecID IS NULL`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T02:01:10.773

```
with Config_RecIDs as (
   select SR_Service_RecID
      , Config_RecID
      , row_number() over (partition by SR_Service_RecID order by Config_RecID) as [rn]
   from SR_Config
)
select sc.SR_Service_RecID, c.Config_RecID
from SR_Config as sc
left join Config_RecIDs as s
   on s.SR_Service_RecID = c.SR_Service_RecID
   and [rn] = 1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T04:50:48.127

这就是你所追求的吗？

```
;WITH SR_ConfigCTE AS
(
    SELECT DISTINCT 
         SR_Service_RecID
        ,Config_RecID
    FROM SR_Config
)
SELECT   s.SR_Service_RecID
        ,sc.Config_RecID
FROM SR_Service     s
LEFT 
JOIN SR_ConfigCTE   sc ON sc.SR_Service_RecID = s.SR_Service_RecID 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-09T08:35:14.563

如果您使用的是 TOP N，那么您就走错了路。它是非标准的和不确定的。

相反，你想要第一个……东西。用 找到它`min()`。加入或使用相关的子查询。

我不太了解您的查询，但这是一个更简单的查询，它为每种类型提供了名字：

```
select type, usertype, cast(name as varchar(30)) as name 
from systypes as t
where exists 
      ( select 1 from systypes 
        group by type 
        having min(name) = t.name 
        and type = t.type 
) 
order by type 
```

这产生：

```
 type usertype name                          
 ---- -------- ------------------------------
    0        0 xml                           
   34       20 image                         
   35        0 ntext                         
   37        0 uniqueidentifier              
   39        0 nvarchar                      
   45        3 binary                        
   47        1 char                          
   48        5 tinyint                       
   50       16 bit                           
   52        6 smallint                      
   55       24 decimal                       
   56        7 int                           
   58       22 smalldatetime                 
   59       23 real                          
   60       11 money                         
   61       12 datetime                      
   62        8 float                         
   63        0 bigint                        
  122       21 smallmoney 
```

# jquery - 在 jQuery 中使用定义的回调

> ID：14188502
> 
> 赞同：0
> 
> 时间：2013-01-07T00:56:47.677
> 
> 标签：jquery, ajax, flickr

我有以下代码：

```
<!DOCTYPE html>
<html lang="en">
    <head>

        <title>HTML</title>

        <script src="http://code.jquery.com/jquery-latest.min.js"></script>

        <script>
            $(document).ready(function() {

                $("#b1").click(function(event) {

                    var pm_url = 'http://www.flickr.com/services/rest/?method=flickr.test.echo&format=json&jsoncallback=wooYay&api_key=52c5c9441e7965eb55b7e54246bc6abf';

                    $.ajax({
                        url : pm_url,
                        dataType : 'jsonp',
                        jsonpCallback : 'wooYay',
                        jsonp : 'callback',
                    });

                function wooYay(data) {
                    alert(data);
                    console.log('hi');
                };  

                });

            });
        </script>
    </head>

    <body>
        <div>
            <button id="b1">
                Click Me!
            </button>
        </div>
        <div class="results"></div>

    </body>
</html> 
```

当我在 Google Chrome 开发工具中查看此内容时，我清楚地看到如下响应：

```
wooYay({"method":{"_content":"flickr.test.echo"}, "format":{"_content":"json"}, "jsoncallback":{"_content":"wooYay"}, "api_key":{"_content":"52c5c9441e7965eb55b7e54246bc6abf"}, "callback":{"_content":"wooYay"}, "_":{"_content":"1357519661919"}, "stat":"ok"}) 
```

但不知何故，函数 wooYay 永远不会执行。另外我想将函数 wooYay 保留在代码块中。有人可以告诉我错误在哪里吗？

谢谢，吉姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T00:58:22.587

`wooYay`不会全局公开，因为它是在匿名函数中定义的。你可以这样分配它...

```
window.wooYay = function(data) { }; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T00:58:31.697

这是根本不可能的。
`wooYay()`在全局范围内不可见。

你应该`getJSON()`正常使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-07T01:19:02.667

最大的问题是您`jsonCallback`对 AJAX 成功回调感到困惑。

其中`wooYay`的`jsonCallback`内容是为您在发布的响应数据中看到的响应定义包装器。

jQuery 还使用提供的名称或它创建的名称（如果您不提供名称）解开此包装器中包含的数据

但是，这不会运行您命名的函数`wooYay`。这需要在 $.ajax 的成功回调中运行。

尽管`wooYay`在 clcik 处理程序中定义函数是非正统的，但它的工作方式如下：

```
$("#b1").click(function (event) {

  var pm_url = 'http://www.flickr.com/services/rest/?method=flickr.test.echo&format=json&jsoncallback=wooYay&api_key=52c5c9441e7965eb55b7e54246bc6abf';

  $.ajax({
    url: pm_url,
    dataType: 'jsonp',
    jsonpCallback: 'wooYay',
    jsonp: 'callback',
     /* added success callback*/
    success: wooYay
  });

  function wooYay(data) {
    alert('See data in console');
    console.log(data);
  };

}); 
```

演示：http: [//jsfiddle.net/kT6dq/](http://jsfiddle.net/kT6dq/)

> 重构版本以最大程度地减少**wooYay**混淆

```
function responseHandler(data) {
   alert('See data in console');
   console.log(data);
 };   

 $("#b1").click(function (event) {
   var pm_url = 'http://www.flickr.com/services/rest/?method=flickr.test.echo&format=json&jsoncallback=wooYay&api_key=52c5c9441e7965eb55b7e54246bc6abf';

   $.ajax({
     url: pm_url,
     dataType: 'jsonp',
     jsonpCallback: 'wooYay',
     jsonp: 'callback',
     success: responseHandler
   });
 }); 
```

演示（重构代码） [http://jsfiddle.net/kT6dq/1/](http://jsfiddle.net/kT6dq/1/)

# c++ - 如何将此宏转换为函数模板？

> ID：14188503
> 
> 赞同：2
> 
> 时间：2013-01-07T00:56:51.577
> 
> 标签：c++, templates, binding, c++11, lambda

在使用绑定实现调度表的过程中，我试图**用函数模板替换宏**。

一旦我开始添加用于返回的表格`std::string`或`double`.

宏版本工作正常，但模板版本转储核心。

*有人可以解释我做错了什么吗？谢谢你。*

**代码**

```
#include <functional>
#include <iostream>
#include <map>

struct Integer
{
    virtual int getInt() const = 0;
};

struct IntImpl : public Integer
{
    virtual int getInt() const { return 42; }
};

typedef std::function<int()>                               IntFunction;
typedef std::function<IntFunction( Integer const& inst )>  IntLambda;

#define USE_MACRO

#ifdef USE_MACRO
#define MP(A,B) \
    std::make_pair( A, []( Integer const& inst ) { \
                return std::bind( B, std::cref( inst )); \
            } )
#else
template<typename L,typename T,typename M>
std::pair<std::string,L>
MP( std::string const& str, M method)
{
    return std::make_pair( str, [&method]( T const& inst ) {
        return std::bind( method, std::cref( inst ));
        } 
    );
}
#endif

static std::map<std::string,IntLambda> const g_intTbl =
{
#ifdef USE_MACRO
    MP( "getInt", &Integer::getInt )
#else
    MP<IntLambda,Integer>( "getInt", &Integer::getInt )
#endif
};

int
main( int argv, char* argc[] )
{
    IntImpl x;
    std::cerr << g_intTbl.find("getInt")->second( x )() << std::endl;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T01:09:01.290

您的问题在于如何捕获`method`到您的 lambda 中。您正在`method`通过引用捕获，它引用本地方法参数，堆栈上的一个值。在`return std::bind()`调用函数之前不会执行，此时它将尝试将引用绑定到堆栈变量，该变量显然不再存在。

您只需要更改`[&method]`为`[method]`按值捕获。

# php - 如何创建文件共享以从 2 个不同的本地服务器传输文件（类似 P2P）

> ID：14188506
> 
> 赞同：0
> 
> 时间：2013-01-07T00:57:10.500
> 
> 标签：php, download, p2p, localserver

如何在没有主服务器的情况下创建 P2P 脚本来管理连接和文件传输？没有种子/水蛭的东西，只是从一台计算机到另一台计算机。

我已经阅读了一些关于 SO 的类似问题，但我想准确解释我需要什么，也许奇迹会发生。

**解释：**

用户 A 和 B 都在本地安装了 PHP 服务器。

用户 A 键入 127.0.0.1:[服务器端口] 并获得一个页面：1 个 IP，17 个文件。用户 A 单击 IP 并获取文件列表。如果他单击一个文件，一个 jQuery/PHP 脚本会将该文件下载到 htdoc 目录中。用户 B 在他/她的一侧（127.0.0.1[服务器端口]）看到用户 A 正在下载此文件的警报。

可能吗？有什么提示可以做到这一点吗？

第二个问题：用户 A 更改他/她的 IP，向用户 B 发出 HTTP 请求，新 IP 存储在本地 SQLite DB 中。（对于那部分，没关系，脚本每 X 分钟检查一次 IP 是否相同，在更改时，它会发送请求）

如果两个用户同时更改他们的 IP 怎么办？他们需要相互联系以获取他们当前的 IP 地址并手动更新吗？这有意义吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-10-30T12:24:46.890

您可以通过浏览器下载文件。尝试此步骤 ->1 将要共享的文件制作为 zip 文件。step -> 2 一旦 zip 文件完成（例如 abc.zip）。步骤 - > 3 在 B 的浏览器上键入 A 的本地 IP 127.0.0.1:[服务器端口] 选择列出的文件并单击 zip 文件，您可以选择保存文件，然后您可以在下载中找到

# ruby-on-rails-3 - Rails：通过控制器方法传递参数

> ID：14188512
> 
> 赞同：1
> 
> 时间：2013-01-07T00:58:30.603
> 
> 标签：ruby-on-rails-3, model-view-controller

假设我`new`在控制器中有一个标准方法：

```
def new
  @doc = Doc.new
  respond_to do |format|
    format.html
    format.json { render json: @doc }
  end
end 
```

我将如何促进通过它传递参数，即：

```
def new(i)
  ...
end 
```

为了允许我在视图中写这样的东西：

```
<%= link_to(e.name, new_doc_path(e.id)) %> 
```

干杯!

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-07T01:06:05.970

Rails 不是这样工作的。如果你想向控制器传递任何东西，你必须使用`params`哈希。在您的示例中：

看法：

```
<%= link_to(e.name, new_doc_with_parameter_path(e.id)) %> 
```

控制器：

```
def new
  id = params[:id]
  # do something with `id`
end 
```

为此，您必须更改您的路线，以便您可以通过 URL 将一个`id`通过 URL 传递给您的新操作：

```
get "/docs/new/:id" => "docs#new", :as => :new_doc_with_parameter 
```

尽管上述内容*应该可行，但在您的情况下，查看*[Nested Resources](http://guides.rubyonrails.org/routing.html#nested-resources)可能会更好。

# audio - ubuntu 中的泛音音量控制无效

> ID：14188518
> 
> 赞同：2
> 
> 时间：2013-01-07T00:59:02.667
> 
> 标签：audio, ubuntu, clojure, jack

我刚刚在 Macbook pro 上的 Ubuntu 12.04 上完成了 Overtone 的安装。让我们暂时搁置一个理性的人会简单地启动到 OSX 进行任何音频处理。

我杀了pulseaudio，像这样开始jackd，

```
jackd -r -d alsa -r 44100 -P # same results without the -P 
```

`cd`进入泛音目录（尝试克隆 0.8-dev 并在 dependencies.clj 中包含 0.7.1），然后启动`lein repl`. 到目前为止，一切都很好。

`(use 'overtone.core)`, `(boot-external-server)`,`(boot-server)`一切似乎都很好。现在问题来了，当我运行这样的代码时，

```
(definst foo [] (saw 220))
(definst bar [] (* 0.001 (saw 220)))
(foo) # works like it should
(stop)
(bar) # makes exactly the same sound and volume level as foo
(stop) 
```

将`saw`ugen 乘以一个数字似乎不会影响音量。知道我应该尝试什么或应该检查什么输出吗？

- 编辑 -

我也尝试下降到 sclang 并得到了类似的结果：

```
{ SinOsc.ar(440, 0, 0.00001) }.play; 
```

听起来一样

```
{ SinOsc.ar(440, 0, 0.9) }.play; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T19:08:29.093

请参阅[杰克网站上的这篇文章](http://jackaudio.org/macbook_distortion)。

> 截至 2012 年 4 月，当 Macbook 在 24 位或 32 位模式下使用时，似乎存在影响 Macbook 音频接口的驱动程序问题。为避免造成失真，请在 ALSA 后端使用 -S 标志以强制其使用 16 位样本数据格式。

我通过首先使用以下命令启动千斤顶解决了这个问题：

```
jackd -r -d alsa -S -r 44100 
```

或者

```
sudo jackd -R -d alsa -S -r 44100 
```

然后启动sclang。

# javascript - 包装页面 JavaScript 代码的正确方法

> ID：14188522
> 
> 赞同：3
> 
> 时间：2013-01-07T00:59:47.980
> 
> 标签：javascript

最近，我看到了包装内联 JavaScript 的不同方式：

* * *

选项1：

```
<script type="text/javascript">//<![CDATA[
    ...
// ]]></script> 
```

* * *

选项 2：

```
<script>
...
</script> 
```

* * *

选项 3：

```
<script type="text/javascript"><!--
...
//--></script> 
```

* * *

选项 4：以上任何一项的组合？

* * *

目前的标准是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T01:16:13.173

**HTML5**

```
<script>
alert('Hello world.');
</script> 
```

**XHTML**

```
<script type="text/javascript">
//<![CDATA[
alert('Hello world.');
//]]>
</script> 
```

**旧浏览器**

```
<script language="javascript"><!--
alert('Hello world.');
//--></script> 
```

XHTML 中的 CDATA 部分对于将文档解析为 XML 是必需的。

根据[Douglas Crockford](http://javascript.crockford.com/script.html)的说法，该`language`属性已被弃用，您可以改用该`type`属性。在 HTML 中，它是可选的。关于 HTML 注释标签，他有这样的说法：

> 不要将`<!-- //-->`hack 与脚本一起使用。它旨在防止脚本在第一代浏览器 Netscape 1 和 Mosaic 上显示为文本。多年来一直没有必要。`<!-- //-->`应该表示 HTML 注释。注释应该被忽略，而不是编译和执行。此外，HTML 注释不包括`--`，因此递减的脚本会出现 HTML 错误。

因此，如果您正在为今天的网页开发脚本，您将使用 HTML5 方式。

# linux - nano 编辑器换行符

> ID：14188523
> 
> 赞同：7
> 
> 时间：2013-01-07T01:00:04.053
> 
> 标签：linux, ubuntu-12.04, nano

我正在尝试学习安装在我的服务器（ubuntu 1204）上的 nano，但问题是每当我在 nano 编辑器中打开文件时，它都会将文件（比如 shell 脚本）作为一个大行而不是适合屏幕的换行符打开.

是否可以在 nano 中打开带有换行符的文件？我试过用谷歌搜索这个问题，但找不到任何有效的方法。

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-07T01:21:17.437

Ctrl+J 和“断”的行。

# vb.net - 在 VB.NET 2008 中向 AddHandler 事件添加参数

> ID：14188525
> 
> 赞同：6
> 
> 时间：2013-01-07T01:01:03.267
> 
> 标签：vb.net

我阅读了有关向 AddHandler 事件添加参数的所有当前帖子，但我无法将它们应用于我的情况。

在 VB.NET 2008 中的 MDI 程序中，我有一个模块 QuickSaleModule，它调用多个模式数据输入表单以将订单添加到表中。发生这种情况时，会打开一个带有网格的表单，其中显示表中的所有订单。此表单网格已与订单模块分开打开，因此表单和模块都不会相互依赖，尽管它们是解决方案中同一项目的一部分。订单网格来自 SQL 查询。

在模块中，我定义了简单事件：

**公共事件 RefreshGrid()**

我在模块中的某个点提出它 - 在输入并保存订单之后：

**RaiseEvent RefreshGrid()**

现在以我在加载事件中的顺序网格形式：

```
AddHandler QuickSaleModule.RefreshGrid, AddressOf RefreshMyGrid 
```

对于 RefreshMyGrid() 处理程序，我有：

```
Public Sub RefreshMyGrid()
     DoReturnSetup() – a sub in the grid form
     removeHandler QuickSaleModule.RefreshGrid, AddressOf RefreshMyGrid
End Sub 
```

这将调用 SQL 查询以使用新顺序刷新网格。在退出之前，可能会通过 quickSaleModule 添加许多订单，因此每次输入新订单时我都会调用该事件，因此在表单关闭时删除处理程序没有意义。但是，这是我创建的第一个 AddHandler 事件。

以下是我的问题：

1.  最重要的。如何将模块中的 orderID 作为参数传递给网格表单中的 RefreshMyGrid 处理程序？我想我可以使用全局变量，但我更喜欢更好的东西。现在作为一个事件新手，我似乎无法使用其他调用事件的方法。当我退出从网格表单调用的数据输入表单时，我使用 with 事件（带参数）。但正如我所说，在这种情况下，没有任何联系。

2.  “removeHandler QuickSaleModule.RefreshGrid, AddressOf RefreshMyGrid”的位置是否正确？或者应该是关闭事件的形式。

3.  最后， RefreshMyGrid 是否需要公开？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-07T02:06:05.417

要将参数传递给事件，您应该遵循将两个参数传递给事件的[.NET](http://en.wikipedia.org/wiki/.NET_Framework)事件标准：发送者和事件参数。

为了传递可用数据，您需要创建自己的继承自 EventArgs 的类，然后将您的属性添加到其中。

例如，定义参数类：

```
Public Class RefreshGridEventArgs
    Inherits EventArgs

    Public Property OrderId As Integer

    Public Sub New(wOrderId As Integer)
        MyBase.New()

        Me.OrderId = wOrderId
    End Sub
End Class 
```

然后重新定义事件：

```
Public Event RefreshGrid(sender As Object, e As RefreshGridEventArgs) 
```

接下来，重新定义如何引发此事件：

```
 ' Replace 1 with the actual order id
    RaiseEvent RefreshGrid(Me, New RefreshGridEventArgs(1)) 
```

最后，在事件处理程序中，用于`e.OrderId`执行适当的逻辑。

要回答您的其他问题：

2) 删除事件中的处理程序意味着该事件只会引发一次，这通常不是您想要的（在某些情况下这是有道理的，但这似乎不是一个）。当表单关闭时也不需要删除事件处理程序，因为它包含在表单中，但是如果表单由于某种原因实际上没有关闭（有些东西挂在上面），这样做也没有什么坏处在某处引用它）。

3) RefreshMyGrid 不需要公开，除非外部调用者调用它是合法的。

# cakephp - CakePHP：向模型函数发送值

> ID：14188526
> 
> 赞同：0
> 
> 时间：2013-01-07T01:01:12.080
> 
> 标签：cakephp, user-defined-functions, cakephp-2.2

我的想法是这样的。我在这样的模型中创建了一个函数。

```
public function status($id = null)
{
$conditions = array('Transaction.catalogue_id' => $id);
$status = $this->find('first',array('conditions' => $conditions, 'fields' => array('Transaction.status'),'order' => array('Transaction.id' => 'desc'))
  );
return $status['Transaction']['status'];
} 
```

我如何从这个循环中发送 $id 的值？

```
<table cellspacing="0" cellpadding="0" border="0" class="all">
      <thead>
      <tr>
          <th>No</th>
          <th>Title</th>
          <th>Author</th>
          <th>ISBN</th>
          <th>Location</th>
          <th>Availability</th>
      </tr>
      </thead>
      <?php $count = 1;?>
      <tbody>  
      <?php foreach ($Catalogue as $Catalogue): ?>
      <tr>
          <td><?php echo $count++; ?></td>
          <td><?php echo $this->Html->link($Catalogue['Catalogue']['title'],array('controller' => 'transactions', 'action' => 'view',$Catalogue['Catalogue']['id']),array('escape' => false, 'class' => 'ajax')); ?></td>
          <td><?php echo $Catalogue['Catalogue']['author']; ?></td>
          <td><?php echo $Catalogue['Catalogue']['isbn']; ?></td>
          <td><?php echo $Catalogue['Location']['rack']; ?></td>
          <td><?php echo $this->getstatus($Catalogue['Catalogue']['id'])</td>
      </tr>
      <?php endforeach; ?>
      </tbody>
      <?php unset($Catalogue); ?>
  </table> 
```

我们可以做 $this->getstatus($Catalogue['Catalogue']['id']) 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T01:34:13.327

You should be using your Model in CakePHP to define the relationship between Catalogue and Transaction. Although what you are attempting is possible, it's a lot more effort than it needs to be. One or two lines of code (providing you have key'd your tables correctly) and Cake will do the rest for you. Pretty neat, yes? Yes.

In your Catalogue.php Model file, define a hasOne relationship with Transaction. Use ORDER to get the latest record...

```
class Catalogue extends AppModel {
    public $name = 'Catalogue';

    public $hasOne = array(
       'Transaction' => array(
           'className'    => 'Transaction'
           'order'        => 'Transaction.id DESC'
       )
    );
} 
```

And then in your view, instead of

```
<td><?php echo $Catalogue['Catalogue']['id'];?></td> 
```

just do

```
<td><?php echo $Catalogue['Transaction']['status'];?></td> 
```

You can read more about relationships in CakePHP in the [manual here](http://book.cakephp.org/2.0/en/models/associations-linking-models-together.html).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T01:04:59.863

误读问题道歉：是的，您可以使用 requestAction $this->requestAction('controllerName/actionName/'.$parameter); 从视图页面访问功能（控制器内部）；

所以在你的情况下：

```
 $this->requestAction('status/' .$Catalogue['Catalogue']['id']); 
```

===========================================

我会留下我原来的（错误的）答案，以防它在某种程度上有所帮助:)

您需要在控制器中设置值，以便可以在视图页面上调用它。

```
 $this->set('status', $status); 
```

然后在您的视图页面上，您可以使用 echo $status

虽然您的示例中不需要它，但您也可以使用 CakePHP 的 copmact 函数，允许您创建多个变量。$this->set(compact('var1','var2','var5')); 在以下视图中都将变得可用：

```
 echo $var1.$var2.$var3; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T15:29:53.990

您可以将模型作为变量传递给视图，如下所示：

```
public function action() {
    ...
    $this->set('Catalogue', $this->Catalogue);
} 
```

然后在您看来，您可以执行以下操作：

```
<td><?php echo $Catalogue->getstatus($catalogue['Catalogue']['id'])?></td> 
```

但是你应该在模型上这样做。试图获取整个项目列表及其状态。

# python - Django 基于类的视图创建然后重定向到详细视图错误

> ID：14188531
> 
> 赞同：2
> 
> 时间：2013-01-07T01:02:30.097
> 
> 标签：python, django, url, web-applications

我有一个名为工作区的应用程序，

在我的 form_valid 定义中的某处

```
def form_valid(self, form):
    obj = form.instance
    obj.owner = self.request.user
    obj.sort_order = Project.default_sort_order()
    obj.workspace = get_object_or_404(Workspace, pk=self.kwargs['pk'])
    context = self.get_context_data()
    attribute_form = context['attribute_formset']
    if attribute_form.is_valid():
        self.object = form.save()
        for aform in attribute_form:
            aform.instance.owner = self.request.user
            attribute = aform.save()
            self.object.attributes.add(attribute)
        return HttpResponseRedirect(reverse(self.get_success_url()))
    else:
        return self.render_to_response(self.get_context_data(form=form)) 
```

以及我对 get_success_url 的定义：

```
def get_success_url(self):
        return reverse('workspace_project', kwargs={'pk':self.object.pk}) 
```

我的网址定义是：

```
url(r'^project/(?P<pk>\d+)$', ProjectDetailView.as_view(), name='workspace_project'), 
```

它包含在主 urlconf 中，如下所示：

```
url('^workspace/', include('workspace.urls')), 
```

但是，每当创建成功时，我都会收到此重定向错误：

```
NoReverseMatch at /workspace/workspace/3/create_project

Reverse for '/workspace/project/12' with arguments '()' and keyword arguments '{}' not found. 
```

我访问了网址`/workspace/project/12`，我可以访问它。为什么这会出错呢？

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T19:16:37.077

为什么要使用 reverse() 两次？在您的 get_success_url() 和 HttpResponseRedirect() 中。您可能还想引用 self.object.get_success_url()。

# r - 如何在 R 中的数据行中跨变量/向量查找模式

> ID：14188534
> 
> 赞同：3
> 
> 时间：2013-01-06T23:57:51.430
> 
> 标签：r, average

有谁知道如何找到模式（R中单个案例的变量最常见？

例如，如果我有关于最喜欢的水果类型 (x) 的数据，则在调查中对每个受访者 (id) 询问九次 (x1-x9)。如果我想在前五次询问中找到每个测试对象的模态响应，我将如何在 R 中编程？

更简洁地说，使用下面的示例数据，我如何在每种情况下找到 MODE？

```
 id  x1  x2  x3  x4  x5  MODE(x1-x5)?  
  1  3   5   6   4   5   5   
  2  7   4   7   4   7   7  
  3  3   4   4   4   3   4  
  4  3   2   2   2   3   2 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T01:50:10.470

该[`modeest`](http://cran.r-project.org/web/packages/modeest/index.html)包提供了实现单峰单变量数据模式的许多估计器。

这有一个函数`mfv`可以返回最频繁的值，或者（作为`?mfv`状态）使用 `mlv(..., method = 'discrete') 可能更好

```
library(modeest)

## assuming your data is in the data.frame dd

apply(dd[,2:6], 1,mfv)
[1] 5 7 4 2
## or
apply(dd[,2:6], 1,mlv, method = 'discrete')
[[1]]
Mode (most frequent value): 5 
Bickel's modal skewness: -0.2 
Call: mlv.integer(x = newX[, i], method = "discrete") 

[[2]]
Mode (most frequent value): 7 
Bickel's modal skewness: -0.4 
Call: mlv.integer(x = newX[, i], method = "discrete") 

[[3]]
Mode (most frequent value): 4 
Bickel's modal skewness: -0.4 
Call: mlv.integer(x = newX[, i], method = "discrete") 

[[4]]
Mode (most frequent value): 2 
Bickel's modal skewness: 0.4 
Call: mlv.integer(x = newX[, i], method = "discrete") 
```

现在，如果你有最频繁的关系，那么你需要考虑你想要什么。
两者都`mfv`将`mlv.integer`返回所有最常见的值。（虽然 print 方法只显示一个值）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T01:15:40.050

为关系选择最低值的解决方案由下式给出：

```
modeStat = function(vals) {
  return(as.numeric(names(which.max(table(vals)))))
}
modeStat(c(1,3,5,6,4,5)) 
```

这将返回：

```
[1] 5 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-07T01:16:35.653

`mean`在 tie 上使用，并返回一个向量：

```
> x[-7]
##   x v1 v2 v3 v4 v5
## 1 1  3  4  5  4  5
## 2 2  7  4  7  4  7
## 3 3  3  4  4  4  3
## 4 4  3  2  2  2  3 
```

这与您的问题中的数据不完全相同。第一行已更改为引入平局。

```
require(functional)
apply(x[2:6], 1, Compose(table,
                         function(i) i==max(i),
                         which,
                         names,
                         as.numeric,
                         mean))

## [1] 4.5 7.0 4.0 2.0 
```

替换`mean`为您需要的任何打破平局的功能。

# c++ - Clang 访问修饰符顺序和 decltype

> ID：14188535
> 
> 赞同：4
> 
> 时间：2013-01-07T01:03:57.280
> 
> 标签：c++, templates, c++11, dependent-name

我一直在考虑创建一个同步器帮助器模板类，它基于 Herb Sutter 在本次[演讲](http://channel9.msdn.com/Shows/Going+Deep/C-and-Beyond-2012-Herb-Sutter-Concurrency-and-Parallelism)中关于包装器类的想法这在 msvc 中不起作用（除非我们删除大括号初始化）但是当大括号初始化被删除时就可以了.

在 clang/gcc (ubuntu 12.10, gcc4.7.2, clang (3.2) self built with libc++) 中，私有访问修饰符似乎必须出现在公众面前：这似乎有点奇怪。

gcc 中的错误是 `error: ‘t_’ was not declared in this scope`

铿锵是

```
error: use of undeclared identifier 't_'
  auto operator()(F f) const ->decltype(f(t_)) 
```

这可能是我不知道的模板/declytpe 问题，并且想知道是否有人可以帮助解决这个问题。（全部使用相关的 c++11 标志编译）

```
template <class T>
class Synchronised {
    public:
        Synchronised(T t = T{}) : t_{t} {}
        template <typename F>
        auto operator()(F f) const -> decltype(f(t_)) {
            std::lock_guard<std::mutex> lock{mutex_};
            return f(t_);
        }
        private: // place this before public: and this object compiles
            mutable T t_;
            mutable std::mutex mutex_;
}; 
```

编辑：添加约翰内斯的想法和全班，以防有人想要剪切和粘贴。

```
#include <future>
#include <iostream>
#include <thread>
#include <vector>

template <class T> T &self(T &t) { return t;  }
template<typename T> struct Dependent {  };

template<typename T>
class Synchronised : Dependent<T>{
 public:
  explicit Synchronised(T t = T()) : t_(t) {}
  template<typename Functor>
  auto operator()(Functor functor) const ->decltype(functor(self(*this).t_)) {
  //auto operator()(Functor functor) const ->decltype(functor(this->t_)) {
    std::lock_guard<std::mutex> lock(mutex_);
    return functor(t_);
  }
 private:
  mutable T t_;
  mutable std::mutex mutex_;
};

int main() {

    Synchronised<std::string> sync_string("Start\n");
    std::vector<std::future<void>> futures;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-13T23:10:24.143

以下仅足以使类模板定义本身有效。然而，使查找在类模板中找不到数据成员的相同规则（这需要引入空的依赖基类或依赖函数调用）也会使类模板的实例化找不到数据成员，并且从而会触发编译器错误。

我们告诉编译器“等等，也许你会在实例化时找到数据成员”，但我没有想到实际实例化时会发生什么。我们现在将使它的名称仍然依赖，即使在类的实例化发生之后。决议将不得不等到调用`operator()`.

```
// keep this little util somewhere :)
template<typename T>
struct self { 
  template<typename U> U &operator()(U &t) { return t; } 
};

template <class T>
class Synchronised {
    public:
// ...
        auto operator()(F f) const -> decltype(f(self<F>()(*this).t_)) {
// ...
}; 
```

使用类模板`self`代替函数模板也将防止发生依赖于参数的查找，从而防止作者`F`还编写一个`self`与参数匹配的函数调用`*this`（这也可能是下面部分解决方案的潜在问题）。

* * *

除了重新排序之外，您还有其他几个选择

1.  在依赖的左侧制作表达式`.`，但不仅仅是封闭类（因为它将是特殊情况）

    ```
    // keep this little util somewhere :)
    template <class T> T &self(T &t) { return t; }

    template <class T>
    class Synchronised {
        public:
    // ...
            auto operator()(F f) const -> decltype(f(self(*this).t_)) {
    // ...
    }; 
    ```

2.  引入一个依赖基类来解决封闭类的特殊外壳

    ```
    // Keep this little util somewhere
    template<typename T> struct Dependent { };

    template <class T>
    class Synchronised : Dependent<T> {
        public:
    // ...
            auto operator()(F f) const -> decltype(f(this->t_)) {
    // ...
    }; 
    ```

第一个是基于标准使`self(*this).t_`未知专业化的成员

> *   对象表达式的类型是依赖的，不是当前的实例化。

第二个是基于标准制作`this->t_`一个未知专业的成员

> *   对象表达式的类型为当前实例化，当前实例化至少有一个依赖基类，id-expression的名称查找没有找到当前实例化的成员或其非依赖基类；

这反过来又使`x->t_`这两种情况都成为依赖表达式，因此将在实例化时查找名称。标准说

> 如果表达式引用当前实例化的成员并且被引用成员的类型是依赖的，或者类成员访问表达式引用未知特化的成员，则类成员访问表达式 (5.2.5) 是类型相关的。

# emacs - 用于编辑文件的 Emacs 模式，其中缩进意味着结构

> ID：14188540
> 
> 赞同：9
> 
> 时间：2013-01-07T01:04:19.413
> 
> 标签：emacs, indentation

我想在 Emacs 中编辑一个大而多毛的 YAML 文件。缩进暗示文件结构：如果行 A 缩进十个空格，则 A 开始一个节，该节包含缩进十个以上空格的每个后续行。这是一个相当普遍的约定，远远超出 YAML 的使用范围。

我真正想要的是具有尊重这种结构的定义的 emacs 模式。例如：

*   我想`forward-sexp`跳过一个 sexp，其中一个 sexp 是由缩进而不是通过匹配的括号对来暗示的。同样，我希望有其他导航命令可以移动到当前部分结束后的行，移动到当前部分的下一个兄弟部分，依此类推。
*   我希望有一个命令来折叠当前部分或除当前部分之外的所有部分，类似于大纲模式可以折叠当前大纲部分的方式，但部分由缩进定义。
*   我希望模式行显示关于我所在部分的有用信息，正如缩进所暗示的那样。
*   我希望有一个选项可以自动突出显示当前行的所有祖先行。
*   其他我没有想到的。

我看过`yaml-mode`，但它没有做任何有用的事情。有几个人建议我尝试 Python 模式，但它不能很好地用于此目的。

通用缩进线模式似乎是很久以前有人会写的那种东西，但如果它存在，我找不到它。或者也许有一些方法可以`outline-mode`按照我想要的方式工作？

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T03:27:41.790

使用`outline-mode`和设置`outline-regexp`to`" *"`并不能得到我想要的东西，但它确实得到了相当多的东西。例如，默认情况下`hide-subtree`绑定到`C-c C-d`的，似乎以我上面描述的方式折叠当前部分。`outline-forward-same-level`, 绑定到`C-c C-f`, 也做我想要的。

有些事情仍然不能很好地工作。如果我发现任何其他有用的方法来调整，我会修改这个答案`outline-mode`。

这是对 José Antonio Ortega Ruiz 建议的轻微修改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-03-13T00:04:38.700

要转到下一个/当前兄弟姐妹，我写[了一个函数](https://gitlab.com/emacs-stuff/my-elisp/blob/master/yaml-utils.el)。加载文件并使用`M-x my-yaml-next-sibling`. 这个包仍然很简陋，但在 IMO 中非常有用！

**update** : 这个函数已经成长为一个真正的包[indent-tools](https://gitlab.com/emacs-stuff/indent-tools)。它的第一个目标是**在缩进块中导航**：转到相同缩进的下一个节点，到父节点等。然后缩进块，注释，折叠等很方便。

尚未在 melpa 中，但在此过程中。

# mongodb - Mongodb通过创建范围的id查询

> ID：14188541
> 
> 赞同：0
> 
> 时间：2013-01-07T01:04:29.550
> 
> 标签：mongodb

我不知道如何使用 mongodb 从 id 范围内搜索（id 表示数据库中的插入顺序）。

示例：我想从元素 id 0 查找到元素 id 19 -> 前 20 个元素

由于我正在存储 ObjectId，我如何查找这种搜索？

我的结构：

**{“_id”：ObjectId（“50e9ccb30364a89b9b286f7a”），“dataCriacao”：日期（1357499571496），“电子邮件”：“danielp@r7.com”，“nome”：“丹尼尔”，“版本”：0}**

我必须创建一个单独的身份证号码吗？

谢谢，

丹尼尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T01:33:54.873

You can sort and filter by `_id` just like you can with any other field. To get the first 20:

```
db.test.find().sort({_id: 1}).limit(20) 
```

However, while `ObjectId` values begin with a one-second resolution timestamp of their creation, that doesn't guarantee they're strictly ordered by creation time if the records are created by multiple clients as `ObjectId`s are generally created driver-side (as opposed to centrally by the MongoDB server).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T01:55:43.247

添加一个`CreatedOn`日期字段并对其进行排序。

对 an 进行排序`Id`是一个坏主意，因为：
- 它们不能保证是增量
的 - 它们不能用作商业价值

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T01:49:39.490

查找前 20 个用户（例如）：

```
db.users.find().limit(20) 
```

如果您想在eg和*之间*进行搜索：`ObjectId("50ea0918ec661588c2000001")``ObjectId("50ea0918ec661588c200000c")`

```
db.users.find({ _id: { $gt: ObjectId("50ea0918ec661588c2000001"), $lt: ObjectId("50ea0918ec661588c200000c") } }) 
```

但是，[ObjectId](http://docs.mongodb.org/manual/core/object-id/)是基于多个字段生成的（请参阅链接）。无法保证它们将按逻辑顺序排列。

# php - php mysql 无限循环

> ID：14188543
> 
> 赞同：0
> 
> 时间：2013-01-07T01:04:50.450
> 
> 标签：php, mysql, loops

我有以下代码，除非我注释 *$conn->query($insert_statement.$values);*. 注释了该行后，我得到了完全正确的打印输出，因为它将在最后一个插入语句处完成循环。

```
for($count =0; $count < $rs->num_rows; $count++){
        $values = "";
        foreach($keys as $key){        
            $values = $values . "'".$row->$key."', ";
        }        
        $values = substr($values, 0, strlen($values)-2) . ");\n";
        echo $insert_statement.$values."\n";
        $conn->query($insert_statement.$values);
} 
```

这是整个代码。我正在尝试制作一个备份表格的脚本。

```
<?

$date = getdate();

$date = $date['month']."_".$date['mday']."_".$date['year'];

$conn = new mysqli("localhost", "root", "ranger", "customers");

$conn->query("drop table if exists backup_$date");
$rs = $conn->query("DESCRIBE customers");

$create_statment = "create table backup_$date (";

$primary_key = "";
$keys = array();
$insert_statement = "insert into backup_$date (";

$count = 0;
while($row = $rs->fetch_object()) {
    if($count > 0){
        $keys[] =  "".$row->Field."";
        $insert_statement = $insert_statement . "`".$row->Field."` ,";
    }
    if($row->Null == "NO"){
        $create_statment = $create_statment . "`".$row->Field."` ".$row->Type." not null";        
        if($row->Extra == "auto_increment"){
            $create_statment = $create_statment ." not null auto_increment, ";      
        }else{
            $create_statment = $create_statment . ",";
        }
    }else{
        $create_statment = $create_statment . " `".$row->Field."` ".$row->Type.", ";
    }
    if($row->Key == 'PRI'){
        $primary_key = "primary key(".$row->Field.")";        
    }
    $count++;
}
$create_statment = $create_statment . " $primary_key);";

$conn->query($create_statment);

$rs = $conn->query("select * from customers;");

$insert_statement = substr($insert_statement, 0, strlen($insert_statement)-1).") values (";
$row = $rs->fetch_object();
for($count =0; $count < $rs->num_rows; $count++){
        $values = "";
        foreach($keys as $key){        
            $values = $values . "'".$row->$key."', ";
        }        
        $values = substr($values, 0, strlen($values)-2) . ");\n";
        echo $insert_statement.$values."\n";
        $conn->query($insert_statement.$values);
}

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T01:22:01.193

[我使用INSERT ... SELECT](http://dev.mysql.com/doc/refman/5.0/en/insert-select.html)创建备份。也许这对你有帮助。

# java - 在我从简单的 spring mvc json 服务的输出之前，我得到了一个额外的空 {} json 对象和一个 &&

> ID：14188545
> 
> 赞同：3
> 
> 时间：2013-01-07T01:05:02.993
> 
> 标签：java, json, spring, model-view-controller, jackson

好的，我有一个基于 spring mvc 的 json web 服务。这是一个测试应用程序，我在构建基于 spring mvc 的 restful json 服务时从未见过这样的问题。我的测试服务的输出总是返回空 json 对象，后跟 && 后跟我要返回的数据。所以结果看起来像这样：

{} && {"status":200,"serverTime":"2013 年 1 月 6 日 7:35:45 PM EST"}

我的控制器方法处理这个非常简单的 GET 请求的代码是：

```
 @RequestMapping(value = "/test.json", method = RequestMethod.GET)
public ModelMap test(ModelMap m, HttpServletRequest request,
        Locale locale) {
    Date date = new Date();
    DateFormat dateFormat = DateFormat.getDateTimeInstance(DateFormat.LONG,
            DateFormat.LONG, locale);

    String formattedDate = dateFormat.format(date);

    m.addAttribute("serverTime", formattedDate);
    m.addAttribute("status", 200);

    return m;
} 
```

我一生都无法弄清楚那个额外的空 {} json 对象是从哪里来的。我的弹簧配置如下所示：

```
<beans:bean
    class="org.springframework.web.servlet.view.ContentNegotiatingViewResolver">
    <beans:property name="mediaTypes">
        <beans:map>
            <beans:entry key="html" value="text/html" />
            <beans:entry key="json" value="application/json" />
        </beans:map>
    </beans:property>
    <beans:property name="defaultViews">
        <beans:list>
            <beans:bean
                class="org.springframework.web.servlet.view.json.MappingJacksonJsonView">
                <beans:property name="prefixJson" value="true" />
            </beans:bean>
        </beans:list>
    </beans:property>
    <beans:property name="viewResolvers">
        <beans:list>
            <beans:bean class="org.springframework.web.servlet.view.UrlBasedViewResolver">
                <beans:property name="viewClass"
                    value="org.springframework.web.servlet.view.JstlView" />
                <beans:property name="prefix" value="/WEB-INF/views/" />
                <beans:property name="suffix" value=".jsp" />
            </beans:bean>
        </beans:list>
    </beans:property> 
```

任何帮助将不胜感激。我在一个星期天花了 6 个小时试图弄清楚为什么会这样。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T01:12:51.517

从`MappingJacksonJsonView`javadoc ：

```
public void setPrefixJson(boolean prefixJson) 
```

> 指示此视图的 JSON 输出是否应以“{} &&”为前缀。默认为假。以这种方式为 JSON 字符串添加前缀有助于防止 JSON 劫持。前缀使字符串作为脚本在语法上无效，因此它不能被劫持。此前缀不会影响 JSON 的评估，但如果对字符串执行 JSON 验证，则需要忽略该前缀。

那么您是否尝试将 prefixJson 设置为 false ？

```
<beans:bean
    class="org.springframework.web.servlet.view.ContentNegotiatingViewResolver">
    <beans:property name="mediaTypes">
        <beans:map>
            <beans:entry key="html" value="text/html" />
            <beans:entry key="json" value="application/json" />
        </beans:map>
    </beans:property>
    <beans:property name="defaultViews">
        <beans:list>
            <beans:bean
                class="org.springframework.web.servlet.view.json.MappingJacksonJsonView">
                <beans:property name="prefixJson" value="false" />
            </beans:bean>
        </beans:list>
    </beans:property>
    <beans:property name="viewResolvers">
        <beans:list>
            <beans:bean class="org.springframework.web.servlet.view.UrlBasedViewResolver">
                <beans:property name="viewClass"
                    value="org.springframework.web.servlet.view.JstlView" />
                <beans:property name="prefix" value="/WEB-INF/views/" />
                <beans:property name="suffix" value=".jsp" />
            </beans:bean>
        </beans:list>
    </beans:property> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T10:11:46.043

我收到了同样的东西，我犯了和你在你提供的代码中一样的错误:)我只是不小心忘记`@ResponseBody`在控制器方法中添加注释。

# c# - JSON.NET 未知类型反序列化

> ID：14188546
> 
> 赞同：1
> 
> 时间：2013-01-07T01:05:03.773
> 
> 标签：c#, .net, json

假设我有以下 json 字符串，其中一些属性名称不同（“dataA”，“dataB”），但它包含相同的结构

```
{
  "mainprop": "val",
  "dataA": { "prop1":"val", "prop2":"val"}
} 
```

和

```
{
  "mainprop": "val",
  "dataB": { "prop1":"val", "prop2":"val"}
} 
```

如何将这些 json 反序列化为具有以下泛型类的对象

```
Class Generic
{
  string mainprop;
  DataClass data; 
}

Class DataClass
{
  string prop1;
  string prop2;
} 
```

换句话说，我如何根据属性名称处理反序列化。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T01:22:22.347

您始终可以进行通用反序列化 (to `Dictionary<string, object>`)，然后自己映射值，但我怀疑这不是您想要的。

我能想到的唯一方法是制作两个虚拟对象仅用于反序列化/序列化目的。

```
public class GenericA : Generic {
    public DataClass dataA { get { return data; } set { data = value; } }
}

public class GenericB : Generic {
    public DataClass dataB { get { return data; } set { data = value; } }
}

Generic a = JsonConvert.DeserializeObject<GenericA>("JSON using dataA");
Generic b = JsonConvert.DeserializeObject<GenericB>("JSON using dataB"); 
```

我没有测试过这段代码。

# 编辑

您可能希望为您的属性赋予`data`属性，`[JsonIgnore]`以便您可以序列化`GenericA`并且`GenericB`没有两次相同的属性。

# php - php smtp 不发送邮件

> ID：14188548
> 
> 赞同：0
> 
> 时间：2013-01-07T01:05:19.573
> 
> 标签：php, smtp

```
 while (! file_exists('php') )
        chdir('..');

include_once "php/Mail.php";

    $from = "<me@gmail.com>";
    $to = "<you@gmail.com>";
    $subject = "Hi!";
    $body = "Hi,\n\nHow are you?";

    $host = "ssl://smtp.gmail.com";
    $port = "465";
    $username = "foo@gmail.com";  //<> give errors
    $password = "xx";

    $headers = array ('From' => $from,
      'To' => $to,
      'Subject' => $subject);
    $smtp = Mail::factory('smtp',
      array ('host' => $host,
        'port' => $port,
        'auth' => true,
        'username' => $username,
        'password' => $password));

    $mail = $smtp->send($to, $headers, $body);

    if (PEAR::isError($mail)) {
      echo("<p>" . $mail->getMessage() . "</p>");
     } else {
      echo("<p>Message successfully sent!</p>");
     } 
```

你好; 我正在使用在 smtp 邮件中给出的答案；（相信它的第一个结果，如果搜索）

但是我仍然没有收到邮件；任何人都可以帮助发现任何错误或提供替代解决方案吗？我使用了内置的邮件程序，但它没有经过身份验证，请参阅 ->[使用 php imap 签署 gmail](https://stackoverflow.com/questions/14180358/signing-gmail-with-php-imap)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T01:53:26.807

您的 PHP ini 文件中是否启用了 SSL？

```
extension=php_openssl.dll 
```

# c# - 如何检查字符串 [] 的任何部分是否包含另一个字符串 [] 的任何部分？

> ID：14188550
> 
> 赞同：1
> 
> 时间：2013-01-07T01:05:25.630
> 
> 标签：c#, .net

这是我尝试使用的代码：

```
if (results.Contains<string>(split.Any<string>) {

} 
```

对于我正在编写的程序，我真的需要这个

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-07T01:06:06.300

```
if (result.Intersect(split).Any()) 
```

# css - html5音频播放器的谷歌浏览器特定背景溢出问题

> ID：14188551
> 
> 赞同：0
> 
> 时间：2013-01-07T01:05:30.157
> 
> 标签：css, html, google-chrome, overflow

我使用 soundmanager2 库创建了一个音频播放器，并使用新外观和一些过渡来定制 css 以适应我的网站设计。但是，我遇到的问题是 Chrome 的问题是在边框半径范围内不包含背景颜色，从而导致溢出问题。Firefox 或 Internet Explorer 中不存在此问题。

任何建议将不胜感激。几天以来，我一直在拼命尝试解决此问题。

这是我的音频播放器的页面，因此您可以了解背景情况。

[http://tinyurl.com/agvmue​​o](http://tinyurl.com/agvmueo)

PS：如果需要更多信息，请告诉我，我会提供。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T02:28:20.970

好的，经过20分钟的调试，答案很清楚了，这就是你要做的：

在类中 360player.css 的第 42 行添加`.sm2-inline-list .ui360-vis`：`background-color: white;`

`background-color:white`从`.sm2-inline-list .ui360-vis .sm2-360ui`第 43 行删除。

希望这可以解决问题。

# css - 整页 CSS 背景图像

> ID：14188555
> 
> 赞同：-1
> 
> 时间：2013-01-07T01:06:02.913
> 
> 标签：css

如果我有一个大图像`background-image`用于我的 html 页面，如何使整个页面加载更快？拥有大型背景图像的最佳做法是什么？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T01:09:02.413

最好的做法是有一个小的背景图像。如果您有重复的背景图像，请尝试将其限制为最小的重复单元；CSS 将自动在 x 和 y 方向上无限重复图像。'

如果您有非重复的背景图像，那么您显然无法裁剪图像以使其更小。在这种情况下，您可能需要设置`background-size:cover`，`background-repeat:no-repeat`以便整个图像填满整个碎石而不重复。这里的最佳做法可能是使用一些高压缩文件，例如 JPEG 而不是 PNG。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T01:10:48.740

尽可能压缩图像。您的瓶颈是通过网络传输的数据 - 页面等待 CSS 完成加载以“准备好”，因此需要传输的字节越少越好。或者，您可以将您的静态资产存储在像 Akamai 这样的 CDN 上，这将在离用户更近的位置以极快的速度提供服务。

# php - 动态添加元素到数组

> ID：14188560
> 
> 赞同：1
> 
> 时间：2013-01-07T01:06:42.840
> 
> 标签：php, arrays, recursion

我有一个包含动态元素数量的数组（它是用户生成的单词列表）。

我希望能够随时将数组元素除以 3：

我的想法是计算数组中的元素（使用`count($myArray)`），如果模数 != 0 我会递归地添加元素，直到它完成为止。

这是我的代码：

```
function adjustArray($myArray, $lineLimit = 3){
    $count = count($myArray);

    if ($count % $lineLimit != 0):
        $myArray[] = '';
        adjustArray($myArray, $lineLimit);

    else:
        return $myArray; //problem when returning is conditional (return won't work - returns NULL
    endif;

} 
```

我怎样才能修复这个代码，或者更好的是，我怎样才能更有效地做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T01:10:50.197

在 while 循环中执行此操作，这样您就没有进行函数调用的开销。

```
while(count($myArray) % $lineLimit !=0){
  $myArray[] = '';
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T01:11:10.170

这里不需要递归。只需添加所需的元素数量即可使长度成为 3 的倍数：

```
function adjustArray($myArray, $lineLimit = 3){
    $count = count($myArray);

    if ($count % $lineLimit != 0){
        for($i = 0; $i < $lineLimit - $count % $lineLimit; $i++)
            $myArray[] = "";
    }   

    return $myArray;
} 
```

这是一个演示：[http ://codepad.org/6viL1peq](http://codepad.org/6viL1peq)

或者，您可以使用：

```
$myArray = array_merge($myArray, array_fill(0, $lineLimit - $count % $lineLimit, "")); 
```

而不是循环，以使其更快。

可以在[此处](http://ideone.com/777qyc)找到此方法的演示。

# ruby - 如何部署 Rails 应用程序并在用户目录中安装 Ruby Native Extension

> ID：14188561
> 
> 赞同：2
> 
> 时间：2013-01-07T01:07:09.307
> 
> 标签：ruby, deployment, capistrano, bundler

有谁知道部署到服务器并将本机扩展安装在用户目录中的方法？

我正在使用 capistrano 和 bundler 并且没有对 /usr/local 的写入权限... 带有本机扩展的 Gems（在当前情况下为 bcrypt-ruby）不要安装。我最初的问题是无法找到“config.h”。

在对生成的 Makefile 进行一些调查时，这一行是罪魁祸首：

```
 $(OBJS): $(hdrdir)/ruby.h $(hdrdir)/ruby/defines.h $(arch_hdrdir)/ruby/config.h 
```

Mkmf 以这种方式定义 arch_hdrdir：

```
arch_hdrdir = $(extout)/include/$(arch) 
```

为什么这样做有点令人费解。不幸的是，$extout 是 ""，因此，Make 正在 /include/i686-linux/ruby/config.h 中寻找配置并失败。

对 mkmf 的进一步调查使我认为 $extout 被设置为在 install_dirs 中评估为 true 的东西，但最终在 makefile 中是一个空字符串。但是，我无法弄清楚它在哪里设置。

为了改变现状，我尝试在 extconf.rb 中设置 $extout。但...

1）如果我将它设置为“/usr/local/lib/ruby”，makefile 会尝试将 .so 安装到 /usr/local/lib/ruby... 我没有写入权限的地方。嘘。

2) 我尝试将 $extout 设置为“/home/crivens/railsapp/shared/bundle”。这实际上可以编译，但是应用程序找不到 .so 文件。我不得不做一堆黑客才能到达那里。

在花了很多时间之后，我正在寻找建议！

1.  甚至可以在不访问系统存储库的情况下安装带有本机扩展的 gem？
2.  这样做的最佳策略是什么？
3.  mkmf 是否记录在任何地方？（我肯定找不到太多注意事项）
4.  $extout 是做什么用的，它是如何设置的？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T01:29:10.433

我认为您正在寻找的是 ruby​​ 版本管理器 (rvm)。它在此处可用，并允许您管理 Ruby、Rails 和 Gem 集的版本。

[https://rvm.io/](https://rvm.io/)

这里也有一个很好的入门指南：[http ://rvm.beginrescueend.com/rvm/install/](http://rvm.beginrescueend.com/rvm/install/)

### 以下是安装过程：

```
[sam@mungr ~]$ \curl -L https://get.rvm.io | bash -s stable --ruby
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100 10956  100 10956    0     0   2240      0  0:00:04  0:00:04 --:--:--  2240
Please read and follow further instructions.
Press ENTER to continue.
Downloading RVM from wayneeseguin branch stable
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100 1243k  100 1243k    0     0   570k      0  0:00:02  0:00:02 --:--:--  929k

Installing RVM to /home/sam/.rvm/
    Adding rvm PATH line to /home/sam/.bashrc /home/sam/.zshrc.
    Adding rvm loading line to /home/sam/.bash_profile /home/sam/.zprofile.

# RVM:  Shell scripts enabling management of multiple ruby environments.
# RTFM: https://rvm.io/
# HELP: http://webchat.freenode.net/?channels=rvm (#rvm on irc.freenode.net)
# Cheatsheet: http://cheat.errtheblog.com/s/rvm/
# Screencast: http://screencasts.org/episodes/how-to-use-rvm

# In case of any issues read output of 'rvm requirements' and/or 'rvm notes'

Installation of RVM in /home/sam/.rvm/ is almost complete:

  * To start using RVM you need to run `source /home/sam/.rvm/scripts/rvm`
    in all your open shell windows, in rare cases you need to reopen all shell windows.

# sam,
#
#   Thank you for using RVM!
#   I sincerely hope that RVM helps to make your life easier and
#   more enjoyable!!!
#
# ~Wayne

rvm 1.17.7 (stable) by Wayne E. Seguin <wayneeseguin@gmail.com>, Michal Papis <mpapis@gmail.com> [https://rvm.io/]

No binary rubies available for: downloads/ruby-1.9.3-p362.
Continuing with compilation. Please read 'rvm mount' to get more information on binary rubies.
Fetching yaml-0.1.4.tar.gz to /home/sam/.rvm/archives
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100  460k  100  460k    0     0   342k      0  0:00:01  0:00:01 --:--:--  492k
Extracting yaml to /home/sam/.rvm/src/yaml-0.1.4
Configuring yaml in /home/sam/.rvm/src/yaml-0.1.4.
Compiling yaml in /home/sam/.rvm/src/yaml-0.1.4.
Installing yaml to /home/sam/.rvm/usr
Installing Ruby from source to: /home/sam/.rvm/rubies/ruby-1.9.3-p362, this may take a while depending on your cpu(s)...
ruby-1.9.3-p362 - #downloading ruby-1.9.3-p362, this may take a while depending on your connection...
ruby-1.9.3-p362 - #extracting ruby-1.9.3-p362 to /home/sam/.rvm/src/ruby-1.9.3-p362
ruby-1.9.3-p362 - #extracted to /home/sam/.rvm/src/ruby-1.9.3-p362
ruby-1.9.3-p362 - #configuring
ruby-1.9.3-p362 - #compiling
ruby-1.9.3-p362 - #installing 
Retrieving rubygems-1.8.24
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100  371k  100  371k    0     0   430k      0 --:--:-- --:--:-- --:--:--  611k
Extracting rubygems-1.8.24 ...
Removing old Rubygems files...
Installing rubygems-1.8.24 for ruby-1.9.3-p362 ...
Installation of rubygems completed successfully.
Saving wrappers to '/home/sam/.rvm/bin'.
ruby-1.9.3-p362 - #adjusting #shebangs for (gem irb erb ri rdoc testrb rake).
ruby-1.9.3-p362 - #importing default gemsets (/home/sam/.rvm/gemsets/), this may take time ...
Install of ruby-1.9.3-p362 - #complete 
Creating alias default for ruby-1.9.3-p362.
Recording alias default for ruby-1.9.3-p362.
Creating default links/files
Saving wrappers to '/home/sam/.rvm/bin'.

  * To start using RVM you need to run `source /home/sam/.rvm/scripts/rvm`
    in all your open shell windows, in rare cases you need to reopen all shell windows. 
```

### 完成后，我已经安装了 Ruby 1.9.3-p362 的全功能安装：

```
[sam@mungr ~]$ source /home/sam/.rvm/scripts/rvm
[sam@mungr ~]$ rvm list

rvm rubies

=* ruby-1.9.3-p362 [ x86_64 ]

# => - current
# =* - current && default
#  * - default 
```

### 哪个版本的 Ruby？

```
[sam@mungr ~]$ which ruby
~/.rvm/rubies/ruby-1.9.3-p362/bin/ruby 
```

### 一个小小的Hello World

```
[sam@mungr ~]$ ruby -e "puts 'Hello world'"
Hello world 
```

### 编辑#1

在讨论这个问题的过程中，作者[Crivens](https://stackoverflow.com/users/1797331/crivens)指出他遇到了以下错误：

> 错误 curl: (77) SSL CA 证书有问题（路径？访问权限？）并且操作系统是 Linux 版本 2.6.32-042stab055.16 (root@rh6-build-x64) (gcc 版本 4.4.4 20100726 (Red Hat) 4.4.4-13) (GCC) ) #1 SMP Fri Jun 8 19:22:28 MSD 2012\. 我仍然希望使用 ruby​​ 的系统安装。

如果您遇到此错误，通常意味着以下两种情况之一：

**1.**我认为您只是缺少此 RPM，ca-certificates-2010.63-3.el6。这些是证书。[我在 Ubuntu 8.04.4 机器上安装 RVM 失败。我应该将它安装为多用户吗？](https://stackoverflow.com/questions/10003329/my-install-of-rvm-on-a-ubuntu-8-04-4-machine-fails-should-i-install-it-as-multi)

### 解决方案#1

```
% yum install ca-certificates-2010.63-3.el6 
```

**2.** rvm 的开发者 Wayne 将 URL 从 rvm.beginrescueend.com 更改为 rvm.io，并且可能会弄乱 SSL 证书。[使用 RVM 安装 Ruby 1.9.2 时出现 Curl 证书错误](https://stackoverflow.com/questions/6414232/curl-certificate-error-when-using-rvm-to-install-ruby-1-9-2)

### 解决方案#2

```
% curl -L get.rvm.io | bash -s stable

-or-

% echo insecure > ~/.curlrc 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-11T23:32:58.617

如果您出于任何原因不想在服务器中安装 RVM 或 rbenv，您仍然可以使用具有权限（root？）权限的用户从服务器安装 gem，使用：

```
gem install bcrypt-ruby --install-dir /path/to/deploy/shared/bundle/ruby/1.9.1/` 
```

之后， bundle 将只使用该宝石。当然，如果你更新 gem 中的`Gemfile`你应该重复这个。

# html - 像 Dreamweaver 一样的 Text Wrangler 自动措辞

> ID：14188562
> 
> 赞同：0
> 
> 时间：2013-01-07T01:07:14.517
> 
> 标签：html, dreamweaver, textwrangler

我想知道如何在文本牧马人中获得像织梦者一样的自动措辞？知道如何在 Dreamweaver 中输入一个字母并选择单词。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T05:06:54.297

按 Ctrl+Space 它建议从 html 代码视图中输入的第一个字母开始的 html 标记

# cmake - 将 libsigc++ 与 cmake 一起使用

> ID：14188563
> 
> 赞同：0
> 
> 时间：2013-01-07T01:07:23.910
> 
> 标签：cmake, libsigc++

我发现很多使用[pkg-config](http://code.metager.de/source/xref/inkscape/CMakeScripts/Modules/FindSigC++.cmake)或[else](http://code.google.com/p/kpar2kde4/source/browse/trunk/cmake/Findlibsigc.cmake?r=2)的描述，但没有一个像 Boost 或 SDL 那样简单。有没有像这样更简单的方法：

```
FIND_PACKAGE( SigC++ REQUIRED ) 
```

如果不是，将 SigC++ 与 cmake 一起使用的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-11T22:02:40.363

不，除非有 FindSigC++.cmake 模块。我建议您使用 pkg-config，因为`pkg_check_modules (GLIB2 glib-2.0)`它并没有那么困难。

# c# - C# DLL 导入属性源码？

> ID：14188564
> 
> 赞同：1
> 
> 时间：2013-01-07T01:07:30.680
> 
> 标签：c#, attributes, dllimport

任何人都知道如何在 C# 中创建一个适用于外部函数的属性？

我需要编写一个属性来导入共享对象（这不适用于 Windows，我正在使用一个名为 Cosmos 的项目在 C# 中开发一个内核，我最近完成了我的 ELF32 加载器和动态链接器，并编写了一个执行此操作的属性）

```
[SOImport("/lib/screen.so")]
extern void print(string text); 
```

我以前从来没有真正写过自己的属性，但是我查阅了一些教程，找不到任何与外部方法相关的东西。我假设它返回一些排序函数指针。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T20:44:25.043

假设您的`SOImport`属性将像该`DllImport`属性一样起作用，您将无法使用它。Cosmos 不支持任何 P/Invoke 操作。Cosmos OS 中使用的任何东西都必须用 .NET 语言编写，而不是本机语言。

# regex - 如何按字母顺序搜索包含六个字母的单词

> ID：14188567
> 
> 赞同：3
> 
> 时间：2013-01-07T01:07:56.950
> 
> 标签：regex, perl

我最近创建了一个 Perl 脚本，它使用以下代码搜索以 D 和 E 开头的单词：

```
$infile = 'words.txt';
open(IN, $infile);
$count = 0;
while ($word = <IN>) {
chomp($word);
if ($word =~ /^d\w*e$/i) {
    print "$word\n";
    $count++;
  }
}
print "$count\n"; 
```

我最近决定分叉代码并创建一个脚本来搜索六个字母的单词，并且单词中的字母按字母顺序（A 到 Z）。我打算使用位于**usr/share/dict/words**的 Unix 标准字典，而不是使用**words.txt**。如何通过修改此代码来完成此操作？

 *** * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-07T02:28:47.270

看起来您真正需要的是一种算法，用于检查给定单词中的字母是否按字母顺序排列。有几种方法，但这个子例程通过将单词拆分为其组成字符的列表、对该列表进行排序并重新组合来工作。如果结果与原始单词匹配，则该单词已经排序。

```
use strict;
use warnings;

use feature 'fc';

for (qw/ a ab ba cab alt effort toffee /) {
  print "$_\n" if in_alpha_order($_);
}

sub in_alpha_order {
  my $word = fc(shift);
  my $new = join '', sort $word =~ /./g;
  return $new eq $word;
} 
```

**输出**

```
a
ab
alt
effort 
```

如果你真的想在正则表达式中做到这一点，你可以建立一个像

```
a(?=[a-z]) | b(?=[b-z]) | c(?=[c-z]) ... 
```

这是一个以这种方式工作的程序。它的输出与上面的输出相同。

```
use strict;
use warnings;

my $regex = join '|', map "${_}(?=[$_-z])", 'a'..'z';
$regex = qr/^(?:$regex)*.$/i;

for (qw/ a ab ba cab alt effort toffee /) {
  print "$_\n" if $_ =~ $regex;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T03:54:52.360

支持非 ASCII 字：

```
#!/usr/bin/perl
use strict;
use warnings;
use encoding 'utf8'; # Upgrade byte strings using UTF-8
use Unicode::Collate; # To sort letters alphabetically

use constant NCHARS => 6; # Consider only words with NCHARS characters in them
my $filename = '/usr/share/dict/words';
open (my $fh, '<:encoding(UTF-8)', $filename)
    or die "can't open '$filename' $!";

my $collator = Unicode::Collate::->new();
while (my $word = <$fh>) {
    chomp $word;
    my @chars = ($word =~ /\X/g); # Split word into characters
    # Print words with given length that have characters in alphabetical order
    print "$word\n" if (@chars == NCHARS &&
                        join('', $collator->sort(@chars)) eq $word);
}
close $fh; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-07T02:34:44.077

这是一个选项：

```
#!/usr/bin/env perl

use warnings;
use strict;

my $wordsFile = '/usr/share/dict/words';
my $count     = 0;

open my $fh, '<', $wordsFile or die $!;

while ( my $word = <$fh> ) {
    chomp $word;
    next unless length $word == 6;

    my $sorted = join '', sort split //, lc $word;

    if ( $sorted eq lc $word ) {
        print "$word\n";
        $count++;
    }
}

close $fh;

print "$count\n"; 
```

这`split`是按字母顺序排列字母的原始单词。这些字母被重新`join`编成一个新词。然后与原始单词进行比较。如果它们相同，则将其打印并计数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-07T02:51:34.480

我有一个类似于 Kenosis 和 Borodin 的解决方案，但是你需要小心大小写。Perl 的默认排序功能将所有大写字母放在小写之前。我下面的版本会处理这个问题。

```
#!/usr/bin/env perl

use strict;
use warnings;

sub is_six_letter_word {
    my $word = shift;
    return length($word) == 6;
}

sub is_letters_in_alphabetical_order {
    my $word = shift;
    $word = fc($word);

    my @chars = split("", $word);
    my $sorted_word = join("", sort(@chars));

    return $word eq $sorted_word;
}

open(my $fh_in, $ARGV[0]) or die "Error opening input file";

my $word = undef;
while ($word = <$fh_in>) {
    chomp($word);
    if (is_six_letter_word($word) && is_letters_in_alphabetical_order($word)) {
        printf("%s\n", $word);
    }
}

close($fh_in); 
```**

# ruby-on-rails - 在子关联上使用地理编码器，如何找到给定位置的所有父母？

> ID：14188568
> 
> 赞同：9
> 
> 时间：2013-01-07T01:08:06.027
> 
> 标签：ruby-on-rails, rails-geocoder

```
class User < AR
  has_many :locations
end

class Location < AR
  belongs_to :user
  geocoded_by :address
end 
```

如何编写执行此操作的查询？

```
@users = User._a_query_that_returns_users_in_'Paris'_ 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-07T02:10:19.447

可能有更优雅的方法，但您可以加入 Location 表并使用地理编码`near`器方法进行查询。像这样的东西：

```
near = Location.near('Paris, France')
@users = User.joins(:locations).merge(near) 
```

# iphone - 以编程方式缩小 UIlabel 内的文本

> ID：14188571
> 
> 赞同：0
> 
> 时间：2013-01-07T01:08:35.330
> 
> 标签：iphone, uilabel, xcode4.5

我正在尝试缩小 UILabel 中的文本。我的文本是一个字符串，我最多有 7 行，有时还不够，然后我需要缩小文本以适应这 7 行。这是我的代码。`

```
// create label
    UILabel *desc = [[UILabel alloc] initWithFrame:CGRectMake(5, 220, 310, 200)];
    desc.backgroundColor = [UIColor colorWithRed:0.8 green:0.8 blue:0.8 alpha:1];
    desc.font = [UIFont fontWithName:@"Helvetica" size:30];
    desc.numberOfLines = 7;
    desc.textColor = [UIColor blackColor];
    desc.layer.borderColor = [UIColor blackColor].CGColor;
    desc.layer.borderWidth = 1.0;
    desc.text = // MY string ;
    desc.adjustsFontSizeToFitWidth = YES;
    [self.view addSubview:desc];` 
```

我什至尝试过`[desc sizeToFit]`；

我无法弄清楚我做错了什么。我已经检查了所有关于此的帖子。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T02:02:28.153

您可以使用辅助函数来调整它的大小。 [这](http://www.11pixel.com/blog/28/resize-multi-line-text-to-fit-uilabel-on-iphone/)是一个例子。我只是将 lineBreakMode 更改为 NSLineBreakByWordWrapping （因为以前在 iOS6 中已弃用）。

```
+ (void)resizeFontForLabel:(UILabel*)aLabel maxSize:(int)maxSize minSize:(int)minSize
{
    // use font from provided label so we don't lose color, style, etc
    UIFont *font = aLabel.font;

    // start with maxSize and keep reducing until it doesn't clip
    for(int i = maxSize; i > 10; i--) {
        font = [font fontWithSize:i];
        CGSize constraintSize = CGSizeMake(aLabel.frame.size.width, MAXFLOAT);

        // This step checks how tall the label would be with the desired font.
        CGSize labelSize = [aLabel.text sizeWithFont:font constrainedToSize:constraintSize lineBreakMode:NSLineBreakByWordWrapping];
        if(labelSize.height <= aLabel.frame.size.height)
            break;
    }
    // Set the UILabel's font to the newly adjusted font.
    aLabel.font = font;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T01:15:06.870

据我所知，UILabel 不支持在多行模式下自动计算字体大小。您可以迭代字体大小，直到它适合。

也看看

[sizeWithFont:forWidth:lineBreakMode:](http://developer.apple.com/library/IOs/#documentation/UIKit/Reference/NSString_UIKit_Additions/Reference/Reference.html#//apple_ref/occ/instm/NSString/sizeWithFont%3aforWidth%3alineBreakMode%3a)

# matlab - MATLAB 将多个图形保存为 PDF

> ID：14188572
> 
> 赞同：7
> 
> 时间：2013-01-07T01:08:42.313
> 
> 标签：matlab

有没有办法做到这一点？

我知道如何使用 saveas ( `saveas(1, filename, 'pdf');`) 将一个图形保存到 PDF 文件，但是可以添加多个吗？所以像 ( `saveas(1,2,3) filename, 'pdf'));`.

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T01:12:35.363

我不这么认为——你需要以某种方式增加文件名。我会使用类似的东西：

```
for ii=1:3
    saveas(ii,[filename '-' num2str(ii)],'pdf)
end 
```

附带说明一下，在提交的手稿中包含 matlab 生成的 pdf 文件时，我曾多次遇到困难。我目前的解决方案是生成 eps 文件并使用 shell 脚本进行转换。

r/

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-10-04T11:22:33.853

回复晚了，但我想补充一点，您可以使用发布命令并发布为 pdf。使用绘图命令创建一个 m 文件“myfile.m”，如

```
plot(x1,y1);
plot(x2,y2); 
```

然后使用运行此文件

```
publish('myfile.m', 'pdf') 
```

这应该给你你想要的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-07T05:59:33.890

我认为可能值得指出的是，您的目标行为可以使用`hgsave`and获得`hgload`，但只有当您乐于使用 .fig 保存时。这些函数的文档骗了我一段时间，让我相信它们可以与其他扩展（例如 .pdf）一起使用，但我无法在我的机器上找到一个示例（Linux Mint v12，Matlab r2012b）。也许其他人可以做得更好。使用 .fig 扩展名的示例如下：

```
%# Create some example data
x = (0:10)';
y1 = (1/10) * x;
y2 = sin(x);

%# Create an array of figures and an array of axes
AllFig(1) = figure('Visible', 'off');
AllFig(2) = figure('Visible', 'off');
AllAxes(1) = axes('Parent', AllFig(1));
AllAxes(2) = axes('Parent', AllFig(2));

%# Plot the data on the appropriate axes
plot(AllAxes(1), y1);
plot(AllAxes(2), y2);

%# Save both figures to .fig in one hit using hgsave
hgsave(AllFig, 'TwoFigsOneFile.fig');

% Clear the workspace
clear

%# Load both figures in one hit using hgload
LoadFig = hgload('TwoFigsOneFile.fig');

%# Display the first figure and second figure
figure(LoadFig(1));
figure(LoadFig(2)); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-08-21T22:25:00.600

## MATLAB-PDFLaTeX 解决方案

`publish`正如其他答案所指出的，使用 MATLAB 的命令是一个很好的解决方案。如果您正在寻找对不同图形组合方式的更多控制，另一种解决方案是`pdflatex`将图形编译成单个 PDF。

1.  将图形打印为 PDF
2.  生成`LaTeX`包含数字的代码
3.  编译`PDFLaTeX`

下面是一个**概念证明，**它将文件名作为 a`char`和一些`function_handle`s 并生成包含这些数字的 PDF。

```
function res = save2pdf(name,varargin)
pathToPdflatex = '/Library/TeX/texbin/pdflatex' ; 

files = cell(size(varargin)) ;
for ii = 1:numel(varargin)
    files{ii} = sprintf('%s_fig%g.pdf',name,ii) ;
    print(varargin{ii},'-dpdf','-painters',files{ii}) ;
end

fh = fopen(sprintf('%s.tex',name),'w+') ;
fprintf(fh,'\\documentclass{article}\n') ;
fprintf(fh,'\\usepackage{graphicx}\n') ;
fprintf(fh,'\\begin{document}\n') ;
for ii = 1:numel(files)
    fprintf(fh,'\\includegraphics[width=\\textwidth]{%s}\n\\newpage\n',files{ii}) ;
end
fprintf(fh,'\\end{document}\n') ;
fclose(fh) ;

[~,res] = system(sprintf('%s %s.tex',pathToPdflatex,name)) ;
disp(res)
end 
```

**例子：**

```
n = 1e+5 ;
x0 = cumsum(randn(n,1)) ;
x1 = cumsum(randn(n,1)) ;
f0 = figure() ;
f1 = figure() ;
ax0 = axes('Parent',f0) ;
ax1 = axes('Parent',f1) ;
plot(ax0,x0) ;
plot(ax1,x1) ;

save2pdf('my_figures',f0,f1) 
```

瞧：

```
...
Output written on my_figures.pdf (2 pages, 169718 bytes).
Transcript written on my_figures.log. 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-08-19T07:07:35.747

没有内置命令可以将所有图形保存在一个 pdf 中，有很多解决方法很难

1.  为每个图形创建 pdf 文件，并使用易于使用的软件将它们组合起来。

2.  有一个名为 Export_fig ( [http://www.mathworks.com/matlabcentral/fileexchange/23629](http://www.mathworks.com/matlabcentral/fileexchange/23629) ) 的脚本可以将数字保存为单个 pdf

3.  以 .ps 格式保存所有数字并将 .ps 转换为 PDF（我觉得很容易使用）。fname = 'test.ps'; 打印（'-dpsc2'，fname，'-f1'）打印（'-dpsc2'，fname，'-append'，'-f2'）

# php - 拆分主页以每页显示 5 个帖子

> ID：14188583
> 
> 赞同：-2
> 
> 时间：2013-01-07T01:10:00.493
> 
> 标签：php, wordpress

如何将显示帖子摘录的主页拆分为不同的页面，每页仅显示 5 个摘录并具有显示旧帖子的链接？像这样： ![](../Images/b4312737dee1236a90e363e6dc6d7253.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T01:56:19.460

您需要查看[分页](http://en.wikipedia.org/wiki/Pagination) 您的脚本将具有与此类似的工作流程

```
<?php
$totalpost = 100;
$currentpost = 0;
$pagelimit = 5;
$current_page = 0;
$current_page_count = 0;
$totalpages = $totalpost / $pagelimit;
while($currentpost < $totalpost){
    $current_page_count = 0;
    while($current_page_count < $pagelimit){
        echo " $currentpost ";
        $currentpost++;
        $current_page_count++;
    }

    echo " <br> page $current_page <br>";
    $current_page++;
}
?> 
```

# python-3.x - 处理多个 Python 版本——不要独立运行

> ID：14188584
> 
> 赞同：3
> 
> 时间：2013-01-07T01:10:00.910
> 
> 标签：python-3.x, python-2.7

我的计算机（操作系统：Windows 7）上安装了 Python 2.7（我的首选版本）和 3.3（我的编程课程中使用的版本）。直到某一点，他们独立工作得很好。

有一天，我的一个程序（在 3.3 中）出现错误并崩溃（它在命令提示符下，而不是在 IDLE 中）。之后，我的所有 3.3 程序，当我尝试编辑它们（使用 IDLE 编辑）或运行它们（在命令提示符中）时，它们将作为 2.7 程序打开/运行。这是一个问题，因为 2.7 和 3.3 之间的一些语法和其他差异。

如何告诉我的 3.3 程序显式使用 Python 3.3？

现在，我要做的就是打开 IDLE（作为空白文件，而不是特定程序），然后使用`Open`IDLE 中的选项。此外，用命令处理器运行程序是不可能的。

我查了一下，看到了一些关于使用的东西，`#!/usr/bin/env`但我不确定如何使用它。Python 3.3 安装在以下文件夹中：（`C:\Python3.3`即文件路径）。

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-07T01:18:46.933

你可以使用[shebang 线](http://docs.python.org/3/using/windows.html#shebang-lines)：

```
#! /usr/bin/env python2 
```

对于 Python 2.x 脚本和：

```
#! /usr/bin/env python3 
```

用于 Python 3.x 脚本。您可以使用更具体的版本，例如，`python3.3`

您可以[配置默认 Python 版本](http://docs.python.org/3/using/windows.html#customizing-default-python-versions)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-08-21T11:10:42.957

您应该在此处关注 Windows 特定功能。直到最近，这种`#!`方法才对基于 Unix 的操作系统有用。

Python 3.3正是为此目的引入[了适用于 Windows 的 Python Launcher 。](http://docs.python.org/3/using/windows.html#launcher)在您的机器上安装 Python 3.3 后，安装程序会将`py.exe`和`pyw.exe`启动器复制到`c:\Windows`中，并且`.py`和`.pyw`扩展与启动器相关联。

这样，如果`.py`文件没有通过 Python 解释器显式启动，则使用 Python Launcher。您也可以显式启动`py script.py`.

如果没有关于 Python 版本的信息，则使用最高的 Python 2.x。有两种方法可以告诉启动器您要启动 Python 3：1) 显式，`py -3 script.py`2) 写入.`#!python3``script.py`

想要的 Python 版本可以更详细（执行特定版本的 Python）。请参阅提到的文档。我也在[你知道“Windows 的 Python 启动器”一文中总结](http://www.experts-exchange.com/Programming/Languages/Scripting/Python/A_10763-Do-you-know-the-Python-Launcher-for-Windows.html)*了我*对这种情况的惊讶。在专家交流。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-08-28T22:05:33.633

您可以从命令行使用特定版本的 python 启动，方法是使用 'py' 后跟版本标志（即 -2 或 -3）

这是您可以执行的操作的示例：

**蟒蛇2**

```
>>> py -2 your_script.py 
```

或者

**蟒蛇 3**

```
>>> py -3 your_script.py 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-08-21T10:38:46.293

python 3.2 的 Python 文档提供了帮助我分别调用不同的 python 2.7 和 3.3 的信息。

[http://docs.python.org/3/using/windows.html#customizing-default-python-versions](http://docs.python.org/3/using/windows.html#customizing-default-python-versions)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-07T03:33:39.117

你可以通过运行来调用 Python3.3 中的 python 解释器，`py filename.py`而如果你在 Python 2.7 中运行它们，你可以只运行`python filename.py`.

在我的 windows 框中，我有小批量脚本（称为 python2 和 python3），它们调用相关的 python 源。

```
filename:    python3.bat
code:        C:\Python32\python.exe %* 
```

# git - Git - 版本控制生产和开发服务器

> ID：14188586
> 
> 赞同：1
> 
> 时间：2013-01-07T01:10:11.017
> 
> 标签：git

> **可能重复：**
> [如何 Git 忽略这些文件](https://stackoverflow.com/questions/6990534/how-to-git-ignore-these-files)

我通过 ftp 将网站迁移到另一个主机。我想使用更安全的协议，所以我选择了带有ssh的git...我有一个git版本的文件的本地副本，但是它有不同的配置文件，会话文件，上传的图像等。我要推送当我开发站点时本地副本的更改但保留这些配置文件等......在两台机器上都保持不变。另一个问题，我必须备份上传的图像（大约 1.5Gb），所以我认为简单的忽略对我来说是不够的，但我没有分支技能。我应该怎么办？

# ios - 如何解决 UIView autoresizingMask 设置正确但无法解决？

> ID：14188587
> 
> 赞同：0
> 
> 时间：2013-01-07T01:10:25.387
> 
> 标签：ios, uikit, autoresizingmask

希望以下提供所需的一切。

在我的应用程序中有一行调整父视图的框架，并且根据我对 autoresizingMask 的期望，受影响的子视图没有以适当的方式响应。

viewController.view 子视图有 1 个子视图，所有边距都调整大小，框架为 0,0,320,270。

viewController.view 的 frame = 0,0,320,276

将 viewController.view 的大小调整为 0,64,1024,704 后

一个subview卡在底部，效果基本和subview没有灵活的底边距一样。

352,434,320,270。大小合适，没有调整大小。但是从它的superview顶部向下434点，加上高度270，=704，即superview的高度。

我希望 270 子视图高度和 704 之间的 434 差异在顶部和底部边距之间保持平衡。

但是顶部和底部边距都被指定为调整大小。我很困惑。可能是我的代码盲了，这很容易。

当一个边距为零但另一个边距不为零时，这可能与一些特殊处理有关。以前从未尝试过这种情况。

> po [viewController.view 子视图]
> 
> (id) $1 = 0x09696340 <__NSArrayM 0x9696340>(
> 
> < UIView: 0x9695790; 帧 = (0 0; 320 270); 自动调整大小 = LM+RM+TM+BM；层=<CALayer：0x96957f0>>
> 
> )
> 
> (lldb) po viewController.view
> 
> (UIView *) $2 = 0x09695ab0 < UIView: 0x9695ab0; 帧 = (0 0; 320 276); 自动调整大小 = W+H；层=<CALayer：0x9695b10>>

然后一行代码改变superview：

```
viewController.view.frame = {...}; 
```

> (lldb) po viewController.view
> 
> (UIView *) $3 = 0x09695ab0 < UIView: 0x9695ab0; 帧 = (0 64; 1024 704); 自动调整大小 = W+H；层=<CALayer：0x9695b10>>
> 
> (lldb) po [viewController.view 子视图]
> 
> (id) $4 = 0x09696340 <__NSArrayM 0x9696340>(
> 
> < UIView: 0x9695790; 帧=（352 434；320 270）；自动调整大小 = LM+RM+TM+BM；层=<CALayer：0x96957f0>>
> 
> )

编辑-

问题可能是我不知道的另一个属性。也许像自动布局或约束之类的东西，但自动布局已关闭。此外，superview 不是自定义 UIView 子类，在 layoutSubviews 中有一些花哨的东西。这都是简单的 UIKit 东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-10-26T07:16:26.600

您正在尝试从笔尖添加视图。因此，根据我的观点，nib 在应用程序启动时首先执行。此时您的视图不包含设备或超级视图的实际大小。因此，当应用程序启动时，它将采用您定义的实际大小，并添加初始大小的子视图。

所以，我的建议是在 ViewWillAppear() 或 ViewDidAppear() 中添加视图，因为此时获取设备的实际大小，您将获得视图的正确大小和位置。

# c# - C# 到 SQL Server

> ID：14188589
> 
> 赞同：0
> 
> 时间：2013-01-07T01:10:39.033
> 
> 标签：c#, sql-server

是否可以在本地使用 SQL Server 运行 C# 而无需在我的计算机上安装 SQL Server？我的意思是，它是否存在可以在 VS 2010 中加载的库，例如让运行连接到 SQL 数据库而无需为 SQL Server 安装所有包？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T01:16:08.443

考虑[SQL Server Compact](http://www.dotnetperls.com/sqlce)，这是一个嵌入式数据库，可让您在运行时生成它，因此无需预先安装 SQL Server。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T01:22:37.170

过去，我已经成功地使用 DataSets 和 AtaTables 创建了一个内存数据库，这是值得的。这不需要安装任何 SQL 服务器或组件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T01:29:18.167

[SQL Server Express LocalDB](http://msdn.microsoft.com/en-us/library/hh510202.aspx)是为独立应用程序提供本地 SQL Server 数据库的“新”方式。

# xcode - UIPageViewController - 第一次旋转将视图重置为初始页面？

> ID：14188592
> 
> 赞同：4
> 
> 时间：2013-01-07T01:10:56.120
> 
> 标签：xcode, ios6, uipageviewcontroller

我正在尝试了解 Apple 的基于页面的应用程序的默认模板。该模板显示了一种日历，一年中的每个月都有一个页面。

在没有任何更改的情况下编译模板时，我注意到了一些奇怪的事情。当应用程序启动时，它以纵向模式显示，并且当 - 在翻阅一些页面后（例如，到 6 月） - 您更改旋转时，它以横向模式重新加载，显示两个页面，但从 1 月开始。不过，这只会发生一次。在随后的方向更改时，它会跳转到正确的“currentViewController”。

这个代码似乎来自 RootViewController 文件，特别是

```
UIViewController *currentViewController = self.pageViewController.viewControllers[0]; 
```

坦率地说，第一次方向变化似乎被忽略了。

我试图理解为什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-17T09:09:18.443

在将应用程序更新为对 iPhone 5 友好时，我不得不处理同样的问题。使用 iOS 6 sdk 编译时，问题出现在 iOS 6 上，但不在 iOS 5 上。仅在横向进入 PageViewController 时才会出现。

一种解决方法：

创建一个属性以将当前状态保存在 .m 的 @interface 部分中：

```
@property (strong, nonatomic) NSArray *viewControllersSave; 
```

将 viewControllers 保存在`willRotateToInterfaceOrientation`：

```
(UIInterfaceOrientation)toInterfaceOrientation duration:(NSTimeInterval)duration {
    // some code here...
    self.viewControllersSave = self.pageViewController.viewControllers;
} 
```

使用保存的属性而不是`spineLocationForInterfaceOrientation`.

```
- (UIPageViewControllerSpineLocation)pageViewController: (UIPageViewController *)pageViewController
                   spineLocationForInterfaceOrientation: (UIInterfaceOrientation)orientation
{
   // some code
   NSArray *viewControllers = @[self.viewControllersSave[0]];
   [self.pageViewController setViewControllers:viewControllers
                            direction:UIPageViewControllerNavigationDirectionForward
                            animated:YES
                            completion:NULL];

return UIPageViewControllerSpineLocationMin;
} 
```

这可能是避免问题的一种可能性，但您应该向 Apple 提交错误报告以避免这种变通方法供以后使用。

# javascript - javascript删除所有克隆

> ID：14188593
> 
> 赞同：0
> 
> 时间：2013-01-07T01:11:07.670
> 
> 标签：javascript, clone, removechild, removeall

```
var counter = 0;

function moreFields() {
     counter++;
     var newFields = document.getElementById("input").cloneNode(true);
     newFields.id = counter;
     newFields.style.display = 'block';
     var newField = newFields.childNodes;
     for (var i=0;i<newField.length;i++) {
         var theName = newField[i].id;
         if (theName) {
             newField[i].id = theName + counter;
            }
        }
     var insertHere = document.getElementById("buttons");
     insertHere.parentNode.insertBefore(newFields,insertHere);
}

function clearData() {
     var pricetxt = document.getElementById('price1');
     pricetxt.value = "";
     var qtytxt = document.getElementById('qty1');
     qtytxt.value = "";
     while (counter > 0) {
         var cell = document.getElementById("input"+counter);
         cell.parentNode.parentNode.removeChild(cell.parentNode)
         counter--;
        }
     counter = 1;
}

window.onload = moreFields; 
```

[JSFiddle](http://jsfiddle.net/xjsc16x/AXUbP/)

我想删除按下按钮时由第一个函数动态创建的所有克隆。我用[它](http://www.quirksmode.org/dom/domform.html)来作为我的脚本的基础。我知道我可以采取简单的方法（他们这样做的方式），但我想学习如何这样做。

非常感谢所有答案！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T01:18:27.663

好吧，您有一个计数器，因此只需删除直到计数器值的所有节点，然后将其重置。

```
function startOver() {
    var element;
    for (var i = 1; i <= counter; i += 1) {
        element = document.getElementById(i);
        if (element.parentNode) {
            element.parentNode.removeChild(element);
        }
    }
    counter = 0;
    moreFields();
} 
```

演示：http: [//jsfiddle.net/AXUbP/1/](http://jsfiddle.net/AXUbP/1/)

# php - 如何在 Codeiginiter 中正确格式化 JSON 字符串？

> ID：14188598
> 
> 赞同：3
> 
> 时间：2013-01-07T01:11:45.417
> 
> 标签：php, json, codeigniter, codeigniter-2

我的 Codeiginiter 应用程序从数据库中检索数据并将其存储在 $result 变量中，然后将其转换为 JSON，我得到以下代码：

```
 $data = $query->result_array();  
    $result['result'] = $data;

   { "result":[
    {"name":"John","surname":"Smith"}] } 
```

但是我想获得以下 JSON 代码但没有任何成功。Count 表示行数。有任何想法吗？谢谢

```
{
"count": 8,
"result":[
{"name":"John","surname":"Smith"}] } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T01:27:44.027

我假设您正在调用`json_encode`数组`$result`？

尝试以下操作：

```
$data = $query->result_array();  
$result['result'] = $data;
$result['count'] = count($data);

echo json_encode($result); 
```

# android - 开始使用 PhoneGap 时遇到问题：Apache Cordova 错误

> ID：14188601
> 
> 赞同：5
> 
> 时间：2013-01-07T01:11:54.523
> 
> 标签：android, cordova

我一直在关注[Android 的 PhoneGap 入门指南](http://docs.phonegap.com/en/2.2.0/guide_getting-started_android_index.md.html#Getting%20Started%20with%20Android)。我在它说的步骤上：`Type in ./create <project_folder_path> <package_name> <project_name> then press "Enter"`

但是，每当我以以下形式执行此命令时，都会`./create ./test2 com.mytest MyTest`收到此错误：`An error occurred. Deleting project...`

我在正确的目录中，我不相信我按照他们的步骤做了任何不寻常的事情。

PS 我在 Mac OS X 10.7.5

**更新**：我尝试直接安装[phonegap-master](https://github.com/phonegap/phonegap) zip 作为建议的答案之一。现在，当我在该 android bin 目录中运行命令时出现新错误：`An unexpected error occurred: ANDROID_BIN="${ANDROID_BIN:=$( which android )}" exited with 1`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T21:01:02.947

我的问题是 Android SDK 的路径不正确。如果您直接按照说明进行操作，它会告诉您添加

```
export PATH=${PATH}:/Development/android-sdk-macosx/platform-tools:/Development/android-sdk-macosx/tools 
```

到 .bash_profile 或 .profile。我不得不改变我的

```
export PATH=/Users/my_username/Development/android-sdk-macosx/platform-tools:/Users/my_username/Development/android-sdk-macosx/tools:$PATH 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T05:54:45.277

尝试

> ./create ./test2/MyTest com.mytest MyTest

project_folder_path 应该是一个不存在的文件夹

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-19T14:09:03.373

如果您像我一样在安装后立即设置有点草率， `PATH`但从一个案例转移到案例位置通知 Phongap 的文档需要`/platform-tools`并`/tools`包含在内！

在我的情况下，仅`/platform-tools`包含并且开发工作正常以及`adb`对`android`可执行文件的 bash 访问，`/tools`因此除非您包含它，否则`which android`它将返回不匹配。

要意识到这个@Nverba 到 github 的链接非常有帮助，因为我终于偶然发现了[脚本](https://github.com/apache/incubator-cordova-android/blob/masater/bin/create)[的源代码：`create`](https://github.com/apache/incubator-cordova-android/blob/masater/bin/create)

搜索“意外的 [...]” 会出现以下错误处理：

```
function on_error {
    echo "An unexpected error occurred: $previous_command exited with $?"
    echo "Deleting project..."
    [ -d "$PROJECT_PATH" ] && rm -rf "$PROJECT_PATH"
    exit "$?"
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-07T16:02:47.473

尽管一切设置正确，但我一直遇到这个问题。

我最终从 Github 下载了 Phonegap zip，该文件最近已升级到 2.3.0 版

[https://github.com/phonegap/phonegap](https://github.com/phonegap/phonegap)

使用

```
./create ./my_new_cordova_project com.example.cordova_project_name CordovaProjectName 
```

工作就像一个魅力......

希望这会有所帮助，大约有一半的其他事情可能会导致此错误，但其他[答案](https://stackoverflow.com/a/13650568/902551)已涵盖了它们。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-12-05T08:51:44.997

This is probably because of a wrong PATH. You should edit your PATH variable. Refer this [blog post](http://mythoughtsandexperiments.blogspot.in/2013/12/an-unexpected-error-occurred.html) for solution.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-07T08:57:13.470

您应该首先导航到包含创建的文件夹，它将位于“phonegap（您从[站点](http://phonegap.com/download#)下载的）/lib/android/bin”中

例如：（在 Mac 上）

> cd /用户/用户名/桌面/phonegap/lib/android/bin/

或：（在 Windows 上）

> cd C:/users/user_name/Desktop/phonegap/lib/android/bin/

然后你可以完成代码

> ./create ./test2/MyTest com.mytest MyTest

那将解决您的问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-16T16:20:01.150

[在此入门指南](http://docs.phonegap.com/en/2.3.0/guide_getting-started_android_index.md.html#Getting%20Started%20with%20Android)之后，我遇到了同样的问题。在把头发扯了几个小时后，我遵循了这个[入门指南](http://docs.phonegap.com/en/1.8.1/guide_getting-started_android_index.md.html#Getting%20Started%20with%20Android)，我认为它比较老但有效。

另一件事是第一个入门指南告诉您在[此处下载 Cordova](http://cordova.apache.org/#download)，因此我试图通过该下载完成所有操作。

[取而代之的是从这里](http://phonegap.com/download/)下载 PhoneGap 包，从那里你会找到 Cordova js 和 jar 文件以及创建应用程序所需的 xml 文件夹。

# paypal - 发送订单信息到paypal快速结账？

> ID：14188603
> 
> 赞同：0
> 
> 时间：2013-01-07T01:12:04.970
> 
> 标签：paypal

我遇到了 PayPal 的 Check-Out 服务的实现——我假设它是 Express Checkout——一旦我被发送到 PayPal，个人详细信息和订购的产品已经列出并填写好了，只等我填写我的信用作为客人的卡信息。

我无法在 PayPal 的 API 中的任何地方找到相关说明。

这是如何实现的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T05:19:21.207

[PayPal为 Express Checkout](https://www.x.com/developers/paypal/development-and-integration-guides#ec)提供了大量文档。我建议专门查看[Express Checkout 集成指南](https://www.x.com/sites/default/files/pp_expresscheckout_integrationguide.pdf)和[NVP](https://www.x.com/sites/default/files/pp_nvpapi_developerguide.pdf)或[SOAP](https://www.x.com/sites/default/files/pp_api_reference.pdf)文档，具体取决于您更熟悉的内容。

要获得您指定的预期效果（客人结帐始终可用），您需要在 SetExpressCheckout 请求中传递 SOLUTIONTYPE=Sole 和 LANDINGPAGE= [Billing](https://www.x.com/developers/paypal/documentation-tools/api/setexpresscheckout-api-operation-nvp)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T01:31:27.997

您可以检查以下示例

```
<form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_blank">
<table width=750px>
<tr>
<td align=right valign=middle width=550px>
<font size=2 face=arial><b>To Purchase "Test Item Name" - $100.00Click Here ---></b></font>
</td>
<td width=200px valign=middle align=left>
 <input type="hidden" name="cmd" value="_xclick">
<input type="hidden" name="business" value="youPaypalid@domain.com">
 <input type="hidden" name="item_name" value="Test Item Name">
<input type="hidden" name="item_number" value="Test120">
<input type="hidden" name="amount" value="100.00">
<input type="hidden" name="quantity" value="1">     
<input type="hidden" name="no_note" value="1">
<input type="hidden" name="currency_code" value="USD">
<input type="hidden" name="lc" value="US">
<input type="image" src="http://www.paypal.com/en_US/i/btn/btn_buynow_LG.gif" border="0" name="submit" alt="Make payments with PayPal - it's fast, free and secure!">
    </td>
</tr>
</table>
</form> 
```

您可以在以下 URL 上查看有关它的详细信息

[Paypal 开发人员文档](https://www.x.com/developers/paypal/documentation-tools/express-checkout/integration-guide/ECGettingStarted)

# ruby-on-rails-3 - 在引用 super 之前，单表继承子类未知

> ID：14188608
> 
> 赞同：3
> 
> 时间：2013-01-07T01:13:38.983
> 
> 标签：ruby-on-rails-3

我定义了三个类，如下所示：

```
class Animal < ActiveRecord::Base
  attr_accessible :animal_definition_id, :aquarium_id

  belongs_to :animal_definition
  belongs_to :aquarium

  has_many :comments, as: :commentable
end

class Fish < Animal
end

class Coral < Animal
end 
```

如果我启动控制台并输入：

```
Coral.all 
```

我得到：

```
NameError: uninitialized constant Coral
    from (irb):1
    from /Users/gjr/.rvm/gems/ruby-1.9.3-p125@WebDev/gems/railties-3.2.10/lib/rails/commands/console.rb:47:in `start'
    from /Users/gjr/.rvm/gems/ruby-1.9.3-p125@WebDev/gems/railties-3.2.10/lib/rails/commands/console.rb:8:in `start'
    from /Users/gjr/.rvm/gems/ruby-1.9.3-p125@WebDev/gems/railties-3.2.10/lib/rails/commands.rb:41:in `<top (required)>'
    from script/rails:6:in `require'
    from script/rails:6:in `<main>' 
```

现在......如果我输入`Animal.all`它按预期工作。然后`Coral.all`工作正常！

为什么在珊瑚工作之前需要引用动物？顺便说一句，如果我做的事情不是`all`. `Coral.class`做同样的事情。

我还没有在我的实际应用程序中看到这种行为，但我担心它是一个等待发生的奇怪错误。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T05:35:03.650

Rails 在调用模型时动态加载模型。因此，当您第一次调用时，`Animal.all`您是在告诉 Rails 去查找`models/animal.rb`文件并加载它——您的其他类也会在那个时候加载。

如果你想能够调用`Coral`，`Fish`不管是否`Animal`已经加载，只要把它们放在文件`models/coral.rb`和`models/fish.rb`. 那应该对你有用。

# html - 将 HTML 元素相互分层

> ID：14188609
> 
> 赞同：1
> 
> 时间：2013-01-07T01:13:47.623
> 
> 标签：html, canvas

好的，所以，我需要有关如何将 HTML 元素（特别是`<canvas>`和`<div>`）按特定顺序和位置放置的帮助，因此，即使例如画布 2 的宽度或高度发生变化，它仍然保持相同的层顺序，并且将所有这些元素保存在 HTML 文档上的相同位置（div 1 over canvas 2 over canvas 3 over div 4 over div 5 over div 6 等）

**编辑：没关系**

# php - 在 PHP 中使用 Params 传递完整的 url

> ID：14188610
> 
> 赞同：1
> 
> 时间：2013-01-07T01:14:08.550
> 
> 标签：php, android

我想在我的 PHP 脚本中传递一个 url 作为参数。该 URL 来自我的 Android 应用程序，它传递一个 url 和 PHP 脚本自定义格式 XML 以返回到应用程序。所以我会传递我想要格式化的 url，PHP 脚本会做一些事情并回显结果。

例如我想传递这个网址：

> differentwebpage.com/search/?query=ford%20f150&

在我的 php 脚本（mywebpage.com/script.php）中：

```
$url = $_GET['url'];
$str = file_get_contents($url);
echo $str; 
```

所以完整的网址是：

> mywebpage.com/script.php?url=differentwebpage.com/search/?query=ford%20f150&

但这不起作用。我想我需要对 URL 进行编码/解码，但我没有取得任何成功。如何将完整的 URL 作为参数传递？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T01:18:30.763

传递时尝试在Android中对其进行编码。

`URLEncoder`您可以使用此处进行编码：http: [//developer.android.com/reference/java/net/URLEncoder.html](http://developer.android.com/reference/java/net/URLEncoder.html)

然后，您可以使用`urldecode`.

```
$url = urldecode($_GET['url']);
$str = file_get_contents($url);
echo $str; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T01:18:01.750

只需使用 php 函数`urlencode()`。它将像这样对您的示例中的 URL 进行编码：

```
differentwebpage.com%2Fsearch%2F%3Fquery%3Dford%2520f150%26 
```

可以完全解码。并且仅包含在 URL 中有效的字符。

# c++ - 是否允许实现将两个相同的函数定义放置在同一地址，或者不允许？

> ID：14188612
> 
> 赞同：25
> 
> 时间：2013-01-07T01:14:40.420
> 
> 标签：c++, language-lawyer

C++ 标准对等式运算符有以下说明`==`：

> `[C++11: 5.10/1]:` *[..]*相同类型的两个指针比较相等当且仅当它们都是空的，都指向同一个函数，或者都表示相同的地址。

我最初的解释是，在这个级别上，函数本身在语义上没有“地址”，因此“或两者都表示相同的地址”只能指代对象，而不是函数。否则为什么要使用“指向相同的功能”条款呢？

也就是说，两个相同类型的函数指针比较相等当且仅当它们都指向同一个函数，句点。

[这样做的结果是，在这个问题](https://stackoverflow.com/q/14176320/560648)中看到的行为（指向两个不同但相同的函数的指针具有相同的值）将是一个实现错误，因为指向不同函数的指针需要是唯一的。

我*觉得*这是该条款的意图，但我无法客观地捍卫这样一种观点，即这就是应该如何推断段落的含义，或者这确实是委员会的意图，现在我的解释[受到质疑](https://stackoverflow.com/questions/14176320/why-are-member-function-pointers-behaving-so-weirdly-in-visual-c/14176510#comment19667702_14176510)：

> [D] 与我讨论如何“[...] 或两者都代表同一个地址。” 对 Visual C++ 的行为不满意。*（@jstine）*

所以我的问题是关于这个标准段落的意图。

任何一个：

*   我在正确的轨道上：函数指针必须比较相等，*如果*它们都指向同一个函数（“地址”该死），或者

*   这段话有一个冗余：函数指针必须比较相等，*当且仅当*它们都指向同一个函数或都表示同一个地址；并且，通过扩展，允许实现使两个函数存在于同一地址。

*它是哪一个？*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-07T02:29:37.320

好吧，从逻辑上看这个语句。你有三个子句：

1.  两者都是空的。

2.  两者都指向相同的功能。

3.  两者的地址相同。

这些子句由逻辑“或”连接。因此，如果*其中任何一项*为真，则允许两个指针比较相等。如果编译器如此决定，则可能会失败 #3 但仍会通过 #2。逻辑“或”意味着这样的指针将比较相等。

另外，需要注意的是，成员指针没有传统意义上的“地址”。它们确实有一个值，但它不是内存地址。这就是为什么你不允许将它们投射到`void*`等等。

该段落保证，给定函数指针`t`，`u`如果`t == u`，那`t(...);`将导致与 相同的行为`u(...);`。该行为将引用 NULL、调用相同的函数或在相同地址执行代码。因此，具有相同的行为。

从技术上讲，[Mehrdad 的问题](https://stackoverflow.com/questions/14176320/why-are-member-function-pointers-behaving-so-weirdly-in-visual-c)在于他从两个不同的成员函数名称中获得了相同的值。所以#3 适用。我在标准中看不到任何要求不同成员函数名称在为它们获取函数时返回不同值的内容。

# asynchronous - 如何在 F# 中检测流的结束？

> ID：14188618
> 
> 赞同：1
> 
> 时间：2013-01-07T01:15:44.140
> 
> 标签：asynchronous, f#, stream

我有一个 F# 函数，如下所示：

```
open System.IO
open Microsoft.FSharp.Control.CommonExtensions

let rec copyData (ins:Stream) (outs:Stream) = async {   
    let! bytes = ins.AsyncRead(1)
    do! outs.AsyncWrite(bytes)
    return! moveData ins outs
} 
```

当`ins`流到达末尾时，它会引发`AtEndOfStream`异常。所以我必须在调用函数中捕获它。如何通过检测流当前处于末尾来防止此异常？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-07T11:32:25.620

您在此处使用的`AsyncRead`重载会尝试准确读取您指定的字节数（如果到达末尾则会失败，因为它无法读取指定的字节数）。

或者，您可以使用带缓冲区并返回读取的字节数的重载：

```
let rec copyData (ins:Stream) (outs:Stream) = async {   
  let buffer = Array.zeroCreate 1024
  let! bytes = ins.AsyncRead(buffer)
  if bytes > 0 then
    do! outs.AsyncWrite(buffer, 0, bytes)
    return! moveData ins outs
} 
```

此重载不会在流的末尾引发异常，而是会返回 0（并且不会将任何内容写入缓冲区）。因此，您可以检查读取的字节数是否大于 0，否则停止。

如果流在调用之前已经关闭，`copyData`那么您需要检查`CanRead`或处理异常，但如果流在调用之前打开`AsyncRead`，您只会得到 0。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T02:21:43.797

只需检查[`CanRead`](http://msdn.microsoft.com/en-us/library/system.io.stream.canread.aspx)属性，如下所示：

```
let rec copyData (ins:Stream) (outs:Stream) = async {
    if ins.CanRead then
        let! bytes = ins.AsyncRead(1)
        do! outs.AsyncWrite(bytes)
        return! moveData ins outs
} 
```

# cmd - 我如何使用 wget 从域中下载所有图像

> ID：14188621
> 
> 赞同：2
> 
> 时间：2013-01-07T01:16:26.133
> 
> 标签：cmd, wget, image

您好，我想从 www.demotywatory.pl 网站下载所有图片。我已经看到其他主题接受的答案，但这对我根本不起作用。答案是：

```
wget -r -P /save/location -A jpeg,jpg,bmp,gif,png http://www.domain.com 
```

所以我在几个网站上尝试过，但总是这样：看起来它只尝试保存一个文件 ![在此处输入图像描述](../Images/c2d6a77a57a4f53a3416c8e3624dc0ec.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T01:18:28.460

您是否尝试过这样做：wget -r -A.jpg [http://www.demotywatory.pl](http://www.demotywatory.pl)

它将从给定的 URL 下载所有 .jpg 文件。

# android - 应用程序在三星 S3 上运行时后台进程随机死亡

> ID：14188626
> 
> 赞同：9
> 
> 时间：2013-01-07T01:17:04.263
> 
> 标签：android, samsung-mobile

我编写了一个 Android 应用程序，它在我尝试过的所有手机上都可以正常运行，除了三星 S3。发生的情况是，当我的应用程序运行时，其他后台进程（即其他应用程序）将开始死亡。例如，使用我的应用一段时间后，动态壁纸会死机，用户退出我的应用后手机会出现黑色背景。最后，在使用了一段时间后，我的应用程序也被操作系统杀死了。令人沮丧的是，我在日志中看不到任何错误消息，可以提示我到底是什么问题。

这仅在三星 S3 上发生（而不是在 S2 上，例如）。

我认为这与内存有关，因为我的应用程序非常占用内存（它正在从网络加载大量图像），但我在日志中看不到任何“无内存”错误。

我还怀疑我使用的 HTTP 框架可能有问题，所以我从 Apache HttpComponents 切换到 java.net.HttpURLConnection，但没有帮助。

任何关于为什么会发生这种情况的想法或关于如何调试它的提示将不胜感激。

以下是日志的摘录，其中显示了一些后台进程正在死亡（例如，动态壁纸）：

```
01-07 01:57:37.245: I/InputDispatcher(2296): Delivering touch to current input target: action: 0x1
01-07 01:57:37.505: D/dalvikvm(29490): GC_FOR_ALLOC freed 1535K, 17% free 28032K/33735K, paused 71ms, total 71ms
01-07 01:57:37.580: D/dalvikvm(6718): WAIT_FOR_CONCURRENT_GC blocked 0ms
01-07 01:57:37.620: D/dalvikvm(6718): GC_EXPLICIT freed 91K, 9% free 17663K/19399K, paused 3ms+5ms, total 40ms
01-07 01:57:38.190: I/InputReader(2296): Touch event's action is 0x0 (deviceType=0) [pCnt=1, s=0.428 ]
01-07 01:57:38.190: I/InputDispatcher(2296): Delivering touch to current input target: action: 0x0
01-07 01:57:38.190: I/InputDispatcher(2296): Delivering touch to current input target: action: 0x0
01-07 01:57:38.190: I/InputDispatcher(2296): Delivering touch to current input target: action: 0x0
01-07 01:57:38.190: I/InputDispatcher(2296): Delivering touch to current input target: action: 0x0
01-07 01:57:38.190: I/InputDispatcher(2296): Delivering touch to current input target: action: 0x0
01-07 01:57:38.335: I/InputReader(2296): Touch event's action is 0x1 (deviceType=0) [pCnt=1, s=]
01-07 01:57:38.335: I/InputDispatcher(2296): Delivering touch to current input target: action: 0x1
01-07 01:57:38.335: I/InputDispatcher(2296): Delivering touch to current input target: action: 0x1
01-07 01:57:38.335: I/InputDispatcher(2296): Delivering touch to current input target: action: 0x1
01-07 01:57:38.750: D/dalvikvm(29490): GC_FOR_ALLOC freed 1688K, 18% free 27981K/33735K, paused 114ms, total 114ms
01-07 01:57:39.695: W/PowerManagerService(2296): Timer 0x3->0x3|0x0
01-07 01:57:39.700: D/PowerManagerService(2296): setTimeoutLocked::SmartSleep : after19500
01-07 01:57:39.930: I/InputReader(2296): Touch event's action is 0x0 (deviceType=0) [pCnt=1, s=0.429 ]
01-07 01:57:39.930: I/InputDispatcher(2296): Delivering touch to current input target: action: 0x0
01-07 01:57:39.930: I/InputDispatcher(2296): Delivering touch to current input target: action: 0x0
01-07 01:57:39.930: I/InputDispatcher(2296): Delivering touch to current input target: action: 0x0
01-07 01:57:39.930: I/InputDispatcher(2296): Delivering touch to current input target: action: 0x0
01-07 01:57:39.930: I/InputDispatcher(2296): Delivering touch to current input target: action: 0x0
01-07 01:57:40.020: D/DeviceInfo(2296): SysScope Service has unexpectedly disconnected!
01-07 01:57:40.065: I/InputReader(2296): Touch event's action is 0x1 (deviceType=0) [pCnt=1, s=]
01-07 01:57:40.065: I/InputDispatcher(2296): Delivering touch to current input target: action: 0x1
01-07 01:57:40.065: I/InputDispatcher(2296): Delivering touch to current input target: action: 0x1
01-07 01:57:40.065: I/InputDispatcher(2296): Delivering touch to current input target: action: 0x1
**01-07 01:57:40.080: I/ActivityManager(2296): Process com.android.smspush (pid 28031) (adj 1) has died.**
01-07 01:57:40.090: W/WallpaperService(2296): Wallpaper service gone: ComponentInfo{com.sec.ccl.csp.app.secretwallpaper.themetwo/com.sec.ccl.csp.app.secretwallpaper.themetwo.SecretWallpaperService}
01-07 01:57:40.125: D/KeyguardViewMediator(2296): setHidden false
**01-07 01:57:40.135: I/ActivityManager(2296): Process com.android.server.device.enterprise:remote (pid 28016) (adj 1) has died.**
**01-07 01:57:40.145: I/ActivityManager(2296): Process com.sec.ccl.csp.app.secretwallpaper.themetwo (pid 29715) (adj 1) has died.**
01-07 01:57:40.285: D/dalvikvm(29490): GC_CONCURRENT freed 1616K, 17% free 28289K/33735K, paused 27ms+21ms, total 178ms
01-07 01:57:40.285: D/dalvikvm(29490): WAIT_FOR_CONCURRENT_GC blocked 112ms
01-07 01:57:40.445: D/dalvikvm(2296): GC_CONCURRENT freed 1869K, 59% free 24186K/57991K, paused 26ms+12ms, total 197ms
01-07 01:57:40.660: D/dalvikvm(29490): GC_CONCURRENT freed 1587K, 16% free 28622K/33735K, paused 3ms+7ms, total 51ms
01-07 01:57:40.685: D/KeyguardViewMediator(2296): setHidden false 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-09T22:59:28.983

后台进程可能停止的主要原因有 3 个，我将从最可能的情况开始，从最可能的情况开始：

**你不经意地问它停止**

检查您的代码是否存在在尴尬情况下可能会请求服务停止的错误。这可能在服务中或在您的应用程序的其他活动中。

**未捕获的异常**

服务遇到未捕获的异常。在这种情况下，您应该能够看到日志中的信息，但是日志不会持续很长时间，您可能会丢失它。

为了解决这种可能性，您可以设置`DefaultUncaughtExceptionHandler`如下：

```
UncaughtExceptionHandler currentHandler = Thread.getDefaultUncaughtExceptionHandler();
if (!(currentHandler instanceof DefaultExceptionHandler)) {
    // Register default exceptions handler
    Thread.setDefaultUncaughtExceptionHandler(
            new DefaultExceptionHandler(currentHandler));
} 
```

并定义您的`DefaultExceptionHandler`类以写入临时文件，如下所示：

```
public class DefaultExceptionHandler implements UncaughtExceptionHandler {
    private UncaughtExceptionHandler defaultExceptionHandler;

    public DefaultExceptionHandler(UncaughtExceptionHandler pDefaultExceptionHandler)
    {
        defaultExceptionHandler = pDefaultExceptionHandler;
    }

    public void uncaughtException(Thread t, Throwable e) {
        final Writer result = new StringWriter();
        final PrintWriter printWriter = new PrintWriter(result);
        e.printStackTrace(printWriter);
        try {
            String filename = "your_temp_filename";
            BufferedWriter bw = new BufferedWriter(new FileWriter(filename));
            bw.write(result.toString());
        bw.flush();
        bw.close();
        } catch (Exception e2) {
            e2.printStackTrace();
        }
        defaultExceptionHandler.uncaughtException(t, e);        
    }
} 
```

**Android 操作系统要求服务停止**

根据您的描述，这是最可能的原因，也是您无法控制的原因。

当 Android 需要额外资源或认为您的服务运行时间过长时，无法阻止 Android 杀死您的应用程序。服务在被杀死之前运行的时间可能会因设备而异，因为它取决于分配的资源（即图像内存需求随屏幕大小而变化）和可用资源。

在这种情况下，您可以做的唯一合理的事情是`foreground service`使用以下方式启动您的服务：

```
 startForeground(int id, Notification notification); 
```

它通知操作系统您的服务具有用户可见性，并将被放入不太可能终止服务的列表中。我在一些设备上使用它的经验是，即使您同时使用几个其他应用程序，该服务也可以不间断地运行。

问候。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-15T18:07:20.660

我已经追查到了这个问题。它实际上是由 Typeface.createFromAsset() 方法引起的内存泄漏，如此[处](http://code.google.com/p/android/issues/detail?id=9904)所述。泄漏的内存是本机内存（不在 Java 堆上），所以这就是没有 OutOfMemory 异常的原因。

奇怪的是，这个问题应该从 Honeycomb (3.0) 开始解决，但就我而言，它发生在运行 JellyBean (4.1) 的 S3 上。（我尝试了几个 S3，它们都有这个问题）。如果有人可以访问运行 JellyBean 的不同手机进行测试，那将会很有趣，这样我们就可以看到它是否在那里重现（我发布的链接显示了一种重现它的简单方法）。

# sql - 不能使用特殊主体“sa”

> ID：14188629
> 
> 赞同：1
> 
> 时间：2013-01-07T01:17:31.783
> 
> 标签：sql, sql-server-2008

当我尝试运行命令时：

```
EXEC master..sp_addsrvrolemember @loginame = N'sa', @rolename = N'serveradmin'
GO 
```

我得到错误：

> 消息 15405，级别 11，状态 1，过程 sp_addsrvrolemember，第 45 行无法使用特殊主体“sa”。

欢迎提出想法/建议。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-07T03:26:11.663

'sa' 是系统管理员的保留登录名；它已经是 sysadmin 组的成员，该组胜过所有其他组。您不需要将其添加到任何角色，那么您为什么要这样做呢？

# javascript - 制作 Picker 的事件监听器

> ID：14188631
> 
> 赞同：1
> 
> 时间：2013-01-07T01:18:12.683
> 
> 标签：javascript, mobile, titanium-mobile

嗨，我正在为选择器制作一个 eventListener。这是我的代码：

```
var YahooScreen = require("YahooScreen");
var ESPNScreen = require("ESPNScreen");
var CBSScreen = require("CBSScreen");
var ApiWin = Titanium.UI.createWindow({
   backgroundColor : '#fff'
});
var ApiLabel = Titanium.UI.createLabel({
   text  : 'I am Fantasy Expert at',
   top   : '28%',
   left  : '10%',
   right : '10%',
   height: 'auto',
   width : 'auto',
   color : '#000',
   font  : { fontSize : 28,fontWeight : 'bold'},
   textAlign : 'center'
});

ApiWin.add(ApiLabel);

var ApiPicker = Ti.UI.createPicker({
   Top : '35%',
   left : '25%',
   width : '50%'
});

ApiPicker.addEventListener('change', function(e) {
   if (e.row == 'Yahoo!') {
      alert('I am in Yahoo')
   } else if (e.row == 'ESPN') {
      alert('I am in ESPN');
   } else {
      alert('I am in CBS')
   }
});

var data = [];
data.push(Titanium.UI.createPickerRow({
   title : 'Yahoo!'
}));

data.push(Titanium.UI.createPickerRow({
    title : 'Espn!'
}));
data.push(Titanium.UI.createPickerRow({
   title : 'CBS Sports!'
}));

ApiPicker.add(data);
ApiWin.add(ApiPicker);
ApiWin.open(); 
```

When Yahoo is selected Yahoo alert should be shown and likewise but it only showing I am in CBS alert could you solve this problem?

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T08:34:17.350

Wahab，这真的很简单。如果你想得到选中的行标题试试，我用下面的代码得到了标题

```
//Here you will get the title of selected row title
ApiPicker.addEventListener('change', function(e) {
   alert('Selected row = ' + ApiPicker.getSelectedRow(0).title);
   //e.row.title will also give the same effect but above one is the best way
}); 
```

读取[getSelectedRow 函数](http://docs.appcelerator.com/titanium/latest/#!/api/Titanium.UI.Picker-method-getSelectedRow)

这个也可以

```
ApiPicker.addEventListener('change', function(e) {
      //alert(e.row.title);
      if('Yahoo!' === e.row.title){
        alert('yahoo');
      } else if('Espn!' === e.row.title){
        alert('espn');
      } else{
        alert('cbs sports');
      }
}); 
```

您也可以将数据插入选择器，如下所示

```
//Your data list
var listData = ["Yahoo!","Espn!","CBS Sports"];
var data = [];
for( var index = 0,len = listData.length; index < len; index++ )
{
    data.push(Titanium.UI.createPickerRow({
        title : listData[index]
    }));
}

ApiPicker.add(data); 
```

这将比您的方法容易得多。如果您遵循此方法，您可以通过将标题添加到数组来创建更多行。否则你的代码会很大。这将是一个简单和容易的。

# c# - c# 图表控件的下标/上标；注入文本格式

> ID：14188633
> 
> 赞同：1
> 
> 时间：2013-01-07T01:18:20.690
> 
> 标签：c#, .net, charts, text-formatting

我使用`System.Windows.Forms.DataVisualization.Charting`库中的图表控件。它工作得很好，但它有一个很大的缺点：标签不能格式化，所以下标或上标字母是不可能的。

有什么方法，如何注入文本格式？我已经考虑了以下可能性：

*   用上标字符替换 sub/sup 字符。以下是这些字符的列表：[http](http://en.wikipedia.org/wiki/Unicode_subscripts_and_superscripts) ://en.wikipedia.org/wiki/Unicode_subscripts_and_superscripts 问题：并非所有字符都可用，并非所有字体都支持所有 unicode 功能，并且某些字符的大小未完全调整为大字符

*   覆盖`PrePaint`/`PostPaint`事件。问题：标签/标题绘制事件不会触发这些事件

*   注入`DrawString`钩子 - 这可能吗？

*   我还没有考虑过的事情？

# security - 哪些浏览器版本被认为太不安全？

> ID：14188642
> 
> 赞同：1
> 
> 时间：2013-01-07T01:18:59.640
> 
> 标签：security

我们正在尝试分析我们的一个 MVC 应用程序上的一些攻击向量，并且我们正在考虑编写一些代码来防止用户使用我们认为太不安全的浏览器[版本]访问我们的网站。

例如，任何低于 IE 7 的内容都将被我们的网站禁止。

任何未实现 HttpOnly cookie 或存在严重已知漏洞/脚本问题的浏览器 [+version] 都将在我们的观察列表中。

如果没有关于所有版本的 IE 完全不安全（！）的明显讽刺评论，您会认为哪些浏览器和/或版本有风险？IE 往往会受到所有负面报道，但 Chrome 的第 1 版或 Safari 的第 3 版等呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T08:16:25.013

老实说，我仍然认为最不安全的浏览器是 IE。IE 有很多崩溃和很多代码执行错误。在 2012 年的最后几天，蓝洞 0-day 漏洞被发现被广泛利用。但我不记得我见过的最后一个错误，它在启用 DEP 和 ASLR 的 Windows 7 中成功执行 shellcode。对于 Firefox 和 Chrome，那些日子几乎过去了。特别是 chrome 沙箱非常安全。我只看到 Vupen 发现了一个 0-day 漏洞，它像 1 年前一样在 Chrome 中执行代码。

您可以查看每个产品每年的漏洞列表，还可以查看错误分类。 [http://www.cvedetails.com/product/3264/Mozilla-Firefox.html?vendor_id=452](http://www.cvedetails.com/product/3264/Mozilla-Firefox.html?vendor_id=452)

将产品更改为 Chrome、Internet Explorer 和 Safari。

IE 也很容易受到第三方插件的攻击，你可以在 IE 上更轻松地实现代码执行。

如果您有更具体的问题，请询问。

# xml - Perl 和 XML::Smart - 如何从 XML 文件中删除节点

> ID：14188644
> 
> 赞同：5
> 
> 时间：2013-01-07T01:19:05.237
> 
> 标签：xml, perl

我正在编写一个简单的 Perl 脚本，它使用 XML::Smart 创建和解析 XML 文件。我遇到了删除 XML 节点的问题。我有以下代码：

```
if ( exists $XML->{object}[$n] ) {
    delete $XML->{object}[$n] ;
};
$XML->save('dane.xml') ; 
```

它执行预期的操作 - 即删除正确的节点。但是，当我稍后尝试使用下面的代码（通常有效）列出所有节点（特定根的子节点）时：

```
my @objects = $XML->{object}('@') ;
foreach my $object (@objects) {
    say "$object->{address}";
}; 
```

Perl 列出所有节点，直到被删除节点之前的节点，然后吐出以下错误：

```
Not a HASH reference at g:/Dwimperl/perl/site/lib/XML/Smart/Tie.pm line 48, <STDIN> line 2. 
```

我很难过 - 我尝试使用 $XML->data(); 的各种排列；但没有一个工作。我更愿意继续使用 XML::Smart 来完成这个任务，所以我希望这个问题可以在这个特定的库中得到解决。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T02:19:27.710

While `XML::Smart` is way better than `XML::Simple`, on which it is based, in my opinion it is still really not very good at representing XML data. In this case you have to be aware that the node you want to delete is an element of a Perl array, and using `delete` on it will simply set the element to `undef` while leaving it in place (unless it happens to be the last element of the array).

To manipulate arrays like this you need `splice`, which correctly removes elements and moves later ones down to fill the space. Use

```
splice @{ $XML->{object} }, $n, 1 
```

instead of your `delete` and your code should work for you.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T01:30:18.147

永远不要在数组元素上使用`exists`和。`delete`也不做任何有用的事情。

要从数组中删除一个元素，您需要下移所有其他元素。[`splice`](http://perldoc.perl.org/functions/splice.html)可以做到这一点。

```
splice(@{ $XML->{object} }, $n, 1); 
```

或者，如果它可以帮助您更好地理解，

```
splice(@{ $XML->{object} }, $n, 1, ()); 
```

# c# - 在 Silverlight 中使用字符串作为数据表单的数据模板时的事件处理程序

> ID：14188649
> 
> 赞同：7
> 
> 时间：2013-01-07T01:19:53.097
> 
> 标签：c#, silverlight, xaml

我正在尝试使用字符串以编程方式为数据表单形成一些 xaml。我可以让组合框出现。但是当我尝试使用在字符串中指定“MouseLeftButtonUp”或“Loaded”事件处理程序的代码时；进入后页面会变白（没有明显错误）。请参阅下面的相关代码。

```
 StringBuilder editTemplate = new StringBuilder("");
     editTemplate.Append("<DataTemplate ");
     editTemplate.Append("xmlns='http://schemas.microsoft.com/winfx/2006/xaml/presentation' ");
     editTemplate.Append("xmlns:toolkit='http://schemas.microsoft.com/winfx/2006/xaml/presentation/toolkit' ");
     editTemplate.Append("xmlns:navigation='clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls.Navigation' ");
     editTemplate.Append("xmlns:x='http://schemas.microsoft.com/winfx/2006/xaml' >");
     editTemplate.Append("<StackPanel>");
     editTemplate.Append(@"  <toolkit:DataField Label='" + GetFieldWithoutNumber(theInfo, theDataContext) + "'>");
     /* Won't Work */ editTemplate.Append(@" <ComboBox MouseLeftButtonUp='ComboBox_MouseLeftButtonUp' />");
     /* Will Work  */ editTemplate.Append(@" <ComboBox />");
     editTemplate.Append(@" </toolkit:DataField>");
     editTemplate.Append("</StackPanel></DataTemplate>");
     dynamicDataForm.EditTemplate = XamlReader.Load(editTemplate.ToString()) as DataTemplate; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T21:23:41.950

一种解决方案是处理`BeginningEdit`DataForm 的事件并使用它为您的事件处理程序订阅 ComboBox 的`MouseLeftButtonUp`事件。

为此，请在您的代码隐藏中添加一个名为`isEventWiredUp`. 我们将使用此字段来跟踪我们是否已订阅该事件并防止该事件被多次订阅。

接下来，将`x:Name="..."`属性添加到您的`ComboBox`. 我们使用此名称来访问组合框。

完成后，添加以下两个方法，它们*应该*可以满足您的需求。替换`yourComboBoxName`为`x:Name`您给组合框的内容：

```
 private void dynamicDataForm_BeginningEdit(object sender, CancelEventArgs e)
    {
        Dispatcher.BeginInvoke(OnBeginEdit);
    }

    private void OnBeginEdit()
    {
        if (!isEventWiredUp)
        {
            var combobox = dynamicDataForm.FindNameInContent("yourComboBoxName") as ComboBox;
            if (combobox != null)
            {
                combobox.MouseLeftButtonUp += combobox_MouseLeftButtonUp;
                isEventWiredUp = true;
            }
        }
    } 
```

将这两个方法中的第一个订阅到 DataForm 的`BeginningEdit`事件。

我不得不承认我无法`MouseLeftButtonUp`在 ComboBox 上触发该事件。我不确定为什么会发生这种情况，但这似乎是 ComboBox 的一个普遍问题，而不是由于您构建 XAML 的方式而发生的事情。但是，我能够为 ComboBox 的`SelectionChanged`事件获得一个事件处理程序来工作。

我也尝试用`Dispatcher.BeginInvoke`直接调用该`OnBeginEdit`方法来替换该行，但我发现这种方法不起作用。事件没有完全正确连接。再说一次，我不知道为什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T21:30:06.590

连接到 XAML 中的事件处理程序需要在连接到 XAML 文件的代码隐藏中声明。对于 ResourceDictionary 或从 XamlReader.Load 加载的任何内容，不能有任何代码隐藏，因此不能在 XAML 中设置事件处理程序。绕过此限制的最简单方法是不从字符串构建模板，只需在 XAML 文件的 Resources 部分中声明它，然后您可以这样做：

`Resources["MyTemplate"] as DataTemplate`

获取模板并像您在这里所做的那样在代码中分配它，或者只是在 XAML 中使用 StaticResource。只要它保留在连接到此代码的同一个 XAML 文件中，您当前拥有的事件处理程序应该可以正常工作。字符串的动态部分也需要更改以使用绑定。

如果您想坚持使用 XamlReader 方法，您需要解决 2 个问题。

1.  在呈现的模板中找到 ComboBox 实例
2.  等到模板被渲染后寻找 ComboBox

要找到 ComboBox，您首先需要在模板文本中为其指定一个 x:Name 属性（您可以只替换当前存在的事件代码）。接下来，您需要能够按名称在可视树中找到一个项目。这相当简单，您可以在[此处找到一个示例](http://pwnedcode.wordpress.com/2009/04/01/find-a-control-in-a-wpfsilverlight-visual-tree-by-name/)来执行此操作。

要在正确的时间调用此代码，您要么需要重写 OnApplyTemplate，不幸的是，如果您在像 UserControl 这样的东西中，这将不起作用，或者使用其他技巧来阻止它运行，直到所有控件都被呈现。这是一个完整的示例，可以进入构造函数并使用上面链接的 find 方法：

```
DataTemplate template = Resources["MyTemplate"] as DataTemplate;
dynamicDataForm.ContentTemplate = template;

Dispatcher.BeginInvoke(() =>
{
    ComboBox button = FindVisualChildByName<ComboBox>(this, "MyControl");
    if (button != null)
        button.MouseLeftButtonUp += (s, _) => MessageBox.Show("Click");
}); 
```

在您的情况下，您的模板看起来可能需要在呈现之前等待切换到编辑状态，在这种情况下，您需要推迟连接事件并在数据表单上找到在该状态更改时发生的其他事件.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-22T12:03:13.593

您可以使用交互性来绑定您的事件，而不是尝试直接连接事件

例如

```
...
editTemplate.Append("xmlns:i='clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity' ");
...
editTemplate.Append(@"
<ComboBox>
<i:Interaction.Triggers>
    <i:EventTrigger EventName='MouseLeftButtonUp'>

        <i:InvokeCommandAction Command='{Binding  DataContext.YourCommand,                                                                                 
           RelativeSource={RelativeSource AncestorType=XXX}}'  
           CommandParameter='{Binding}'/>

    </i:EventTrigger>
</i:Interaction.Triggers>
</ComboBox>"); 
```

您可能必须使用一些祖先绑定来获取定义处理程序的上下文。我使用 InvokeCommandAction 的自定义实现；基本上是 System.Windows.Interactivity.InvokeCommandAction 的副本，但经过扩展，以便将事件参数传递给命令，您可能也想做同样的事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-05-01T09:40:53.077

XamlReader.Load not allowed to attach eventHandlers in it. so use this technique to dynamically attach the eventHandlers to it.

1- Write your Xaml string without eventHandlers -But write the Name property of those Controls.

2- Load the string with `XamlReader.Load(str);`

3- Then load the content of DataTemplate from it. using `Grid template = ((Grid)(dt.LoadContent()));`

Note: here `Grid` is the parent Control in `DataTemplate`.

4- Find the Control by Name you want to attach the Event Handler. `Button img = (Button)template.FindName("MyButtonInDataTemplate");`

I hope it helps.

# android - 21.0.1 android sdk 上的 Android 预编译器错误

> ID：14188650
> 
> 赞同：19
> 
> 时间：2013-01-07T01:20:12.117
> 
> 标签：android, eclipse, adt

我在另一台电脑上检查了旧的 android 项目，每次保存时都会收到 Android Pre Compiler Null 指针异常错误，因此无法生成 R.java。该项目是使用其他库的库项目。

该项目不起作用的新系统是：64位ubuntu，ADT eclipse，Android sdk tools 21.0.1，Android sdk platform-tools 16 错误是：

> !ENTRY org.eclipse.core.resources 4 2 2013-01-07 02:07:15.177 !MESSAGE 从插件调用代码时出现问题：“org.eclipse.core.resources”。!STACK 0 java.lang.NullPointerException at com.android.ide.eclipse.adt.internal.build.builders.PreCompilerBuilder.build(PreCompilerBuilder.java:673) at org.eclipse.core.internal.events.BuildManager$2.run (BuildManager.java:728) 在 org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42) 在 org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:199) 在 org. eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:239) at org.eclipse.core.internal.events.BuildManager$1.run(BuildManager.java:292) at org.eclipse.core.runtime.SafeRunner .run(SafeRunner.java:42) 在 org.eclipse。
> 
> !ENTRY org.eclipse.core.resources 4 75 2013-01-07 02:07:15.717 !MESSAGE 在构建过程中发生错误。!SUBENTRY 1 com.android.ide.eclipse.adt 4 75 2013-01-07 02:07:15.717 !MESSAGE 在项目“MyProject”上运行构建器“Android Pre Compiler”时出错。!STACK 0 java.lang.NullPointerException at com.android.ide.eclipse.adt.internal.build.builders.PreCompilerBuilder.build(PreCompilerBuilder.java:673) at org.eclipse.core.internal.events.BuildManager$2.run (BuildManager.java:728) 在 org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42) 在 org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:199) 在 org. eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:239) 在 org.eclipse.core.internal.events.BuildManager$1。

该项目适用于旧系统：

老系统是：32位ubuntu，4.2.1 eclipse Juno，Android sdk tools 21，

Git 被用作版本控制系统。这是一个非常奇怪的问题，我检查了所有的 xml，用 lint 运行它们以找到 xml 构建问题，但每次保存都没有运气，我有同样的错误，并且没有生成 R.java。谢谢

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-01-14T22:24:08.490

21.0.1 中的 Android 预编译器似乎严重损坏，在 .svn 目录和 .DS_Store 文件以及没有文件扩展名的文件上崩溃。

对我有用的解决方案是按照以下步骤升级到 21.1 rc1：
1\. 按照此处的说明操作：[http](http://tools.android.com/preview-channel)
://tools.android.com/preview-channel 2\. 确保更新 SDK Manager 和 ADT
3\. 重新启动 Eclipse

有关更多信息，请参阅此错误： [http ://code.google.com/p/android/issues/detail?id=42051](http://code.google.com/p/android/issues/detail?id=42051)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-01-17T00:32:28.950

您可以在每个文件夹属性中添加*资源过滤器*`src`，以避免自动包含项目中不需要的文件。SVN 文件确实使该版本中的 Android 预编译器崩溃。

您应该单击*添加*并选择：*排除所有*/*文件和文件夹*/*所有子*项（递归）/并`.svn`在编辑框中写入。单击确定以保存过滤器。你可能需要干净的项目。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-07T13:44:53.840

就我而言，问题是由 src 文件夹中的 .svn 子文件夹引起的。我按照评论 6 中的建议为我解决了这个问题：[http ://code.google.com/p/android/issues/detail?id=42051](http://code.google.com/p/android/issues/detail?id=42051)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-12T11:14:58.770

我解决了安装 eclipse Juno 的问题并下载了 Android sdk 21 工具而不是 sdk 工具 21.0.1，它接缝我将跳过 21.0.1。所以对我来说，现在 ecrise form android 是个坏主意。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-14T13:43:49.633

也为 ADT 21.0.1 苦苦挣扎，恢复对我有帮助：Eclipse -> 关于 -> 安装详细信息 -> 安装历史 -> 选择 Android 版本为 21.0.0 的条目 -> 按恢复。

# c# - Xaml win8 问题：ListView 在设计时工作，而不是在运行时工作

> ID：14188652
> 
> 赞同：0
> 
> 时间：2013-01-07T01:20:54.457
> 
> 标签：c#, xaml, winrt-xaml

我在使用 Xaml/win8 中新创建的空白页时遇到问题。这是我的代码：

```
<common:LayoutAwarePage
    x:Name="pageRoot"
    x:Class="MyApp.Contents"
    DataContext="{Binding DefaultViewModel, RelativeSource={RelativeSource Self}}"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:MyApp"
    xmlns:common="using:MyApp.Common"
    xmlns:data="using:MyApp.Data"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">

    <Page.Resources>
        <!-- Collection of items displayed by this page -->
        <CollectionViewSource
        x:Name="itemsViewSource"
        Source="{Binding Items}"
        d:Source="{Binding TestSource.Items, Source={d:DesignInstance Type=data:MyDataSource, IsDesignTimeCreatable=True}}"/>
    </Page.Resources>

    <!-- Snip Grid and Back Button -->

        <ListView
            x:Name="itemListView"
            AutomationProperties.AutomationId="ItemsListView"
            AutomationProperties.Name="Items"
            TabIndex="1"
            Grid.Row="1"
            Margin="-10,-10,0,0"
            Padding="120,0,0,60"
            ItemsSource="{Binding Source={StaticResource itemsViewSource}}"
            IsSwipeEnabled="False"
            ItemTemplate="{StaticResource ItemTemplate}"/> 
```

这是支持它的 C#（TestSource 构造函数）：

```
for (int i = 0; i < 20; ++i)
    TestSource.Items.Add(new ExampleData(TestSource)); 
```

在设计器中，**这可以正常工作**。我完全按照您的预期看到了 20 个 ExampleData 的列表。

但是，当我运行该应用程序时，页面上没有显示任何内容。没有“ExampleData”项目出现（即使我确定“TestSource.Items”可观察集合已正确填充。

我主要从 SplitView 演示中复制/粘贴了这个绑定示例。有谁知道出了什么问题？=[

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T00:58:04.947

您的 CollectionViewSource 源指向 Items，而不是 TestSource.Items。您的设计来源是正确的，但是当您运行时它会是错误的。应该：

```
 <CollectionViewSource
    x:Name="itemsViewSource"
    Source="{Binding TestSource.Items}"
    d:Source="{Binding TestSource.Items, Source={d:DesignInstance Type=data:MyDataSource, IsDesignTimeCreatable=True}}"/> 
```

# javascript - 检测点击外部元素（vanilla JavaScript）

> ID：14188654
> 
> 赞同：103
> 
> 时间：2013-01-07T01:21:21.257
> 
> 标签：javascript

我到处都在寻找一个好的解决方案，但我找不到一个**不使用 jQuery**的解决方案。

是否有跨浏览器的正常方式（没有奇怪的黑客或容易破解的代码）来检测元素外部的点击（可能有也可能没有孩子）？

* * *

## 回答 #1

> 赞同：252
> 
> 时间：2015-02-10T12:50:20.467

添加一个事件侦听器`document`并使用它[`Node.contains()`](https://developer.mozilla.org/en-US/docs/Web/API/Node.contains)来查找事件的目标（即最内层单击的元素）是否在您指定的元素内。它甚至可以在 IE5 中使用

```
var specifiedElement = document.getElementById('a');

//I'm using "click" but it works with any event
document.addEventListener('click', function(event) {
  var isClickInside = specifiedElement.contains(event.target);

  if (!isClickInside) {
    //the click was outside the specifiedElement, do something
  }
}); 
```

```
var specifiedElement = document.getElementById('a');

//I'm using "click" but it works with any event
document.addEventListener('click', function(event) {
  var isClickInside = specifiedElement.contains(event.target);
  if (isClickInside) {
    alert('You clicked inside A')
  } else {
    alert('You clicked outside A')
  }
});
```

```
div {
  margin: auto;
  padding: 1em;
  max-width: 6em;
  background: rgba(0, 0, 0, .2);
  text-align: center;
}
```

```
Is the click inside A or outside?
<div id="a">A
  <div id="b">B
    <div id="c">C</div>
  </div>
</div>
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2013-01-07T01:28:28.133

您需要在文档级别处理单击事件。在事件对象中，您有一个`target`属性，即被单击的最内层 DOM 元素。有了这个，你可以检查它自己并沿着它的父元素直到文档元素，如果它们之一是你的观察元素。

请参阅[jsFiddle上的示例](http://jsfiddle.net/SCSBB/22/)

```
document.addEventListener("click", function (e) {
  var level = 0;
  for (var element = e.target; element; element = element.parentNode) {
    if (element.id === 'x') {
      document.getElementById("out").innerHTML = (level ? "inner " : "") + "x clicked";
      return;
    }
    level++;
  }
  document.getElementById("out").innerHTML = "not x clicked";
}); 
```

与往常一样，由于 addEventListener/attachEvent，这不是跨坏浏览器兼容的，但它的工作原理是这样的。

一个孩子被点击，当不是 event.target 时，但它的父母之一是被监视的元素（我只是为此计算级别）。如果找到或未找到元素，您也可能有一个布尔变量，以不从 for 子句中返回处理程序。我的示例仅限于处理程序仅在没有匹配项时完成。

添加跨浏览器兼容性，我通常是这样做的：

```
var addEvent = function (element, eventName, fn, useCapture) {
  if (element.addEventListener) {
    element.addEventListener(eventName, fn, useCapture);
  }
  else if (element.attachEvent) {
    element.attachEvent(eventName, function (e) {
      fn.apply(element, arguments);
    }, useCapture);
  }
}; 
```

这是跨浏览器兼容的代码，用于附加事件侦听器/处理程序，包括`this`在 IE 中的重写，作为元素，就像 jQuery 为其事件处理程序所做的那样。有很多论据要记住一些 jQuery ;)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-01-07T01:37:43.993

How about this:

**[jsBin demo](http://jsbin.com/evajew/3/edit)**

```
document.onclick = function(event){
  var hasParent = false;
    for(var node = event.target; node != document.body; node = node.parentNode)
    {
      if(node.id == 'div1'){
        hasParent = true;
        break;
      }
    }
  if(hasParent)
    alert('inside');
  else
    alert('outside');
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-11-09T20:09:29.680

为了找到更好的方法，我做了很多研究。JavaScript 方法 .contains 在 DOM 中递归地检查它是否包含目标。我在一个反应​​项目中使用了它，但是当反应 DOM 在设置状态下发生变化时，.contains 方法不起作用。所以我想出了这个解决方案

```
//Basic Html snippet
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Document</title>
</head>
<body>
<div id="mydiv">
  <h2>
    click outside this div to test
  </h2>
  Check click outside 
</div>
</body>
</html>

//Implementation in Vanilla javaScript
const node = document.getElementById('mydiv')
//minor css to make div more obvious
node.style.width = '300px'
node.style.height = '100px'
node.style.background = 'red'

let isCursorInside = false

//Attach mouseover event listener and update in variable
node.addEventListener('mouseover', function() {
  isCursorInside = true
  console.log('cursor inside')
})

/Attach mouseout event listener and update in variable
node.addEventListener('mouseout', function() {
    isCursorInside = false
  console.log('cursor outside')
})

document.addEventListener('click', function() {
  //And if isCursorInside = false it means cursor is outside 
    if(!isCursorInside) {
    alert('Outside div click detected')
  }
}) 
```

[工作演示 jsfiddle](https://jsfiddle.net/amrendra_pcs007/neu9q3hm/16/)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2019-11-22T17:10:01.110

解决此问题的另一种非常简单快捷的方法是将数组映射`path`到侦听器返回的事件对象中。如果您的元素的`id`or`class`名称与数组中的其中一个匹配，则单击在您的元素内。

（如果您不想直接获取元素，此解决方案可能很有用（例如：`document.getElementById('...')`，例如在 reactjs/nextjs 应用程序中，在 ssr..）。

这是一个例子：

```
 document.addEventListener('click', e => {
      let clickedOutside = true;

      e.path.forEach(item => {
        if (!clickedOutside)
          return;

        if (item.className === 'your-element-class')
          clickedOutside = false;
      });

      if (clickedOutside)
        // Make an action if it's clicked outside..
    }); 
```

我希望这个答案对你有帮助！（如果我的解决方案不是一个好的解决方案，或者您发现有什么需要改进的地方，请告诉我。）

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2016-10-31T13:33:09.457

要通过在元素外部单击来隐藏元素，我通常会应用这样简单的代码：

```
var bodyTag = document.getElementsByTagName('body');
var element = document.getElementById('element'); 
function clickedOrNot(e) {
	if (e.target !== element) {
		// action in the case of click outside 
		bodyTag[0].removeEventListener('click', clickedOrNot, true);
	}	
}
bodyTag[0].addEventListener('click', clickedOrNot, true);
```

# python - 如何让 PyC harm 在其控制台中显示 unicode 数据？

> ID：14188655
> 
> 赞同：9
> 
> 时间：2013-01-07T01:21:21.137
> 
> 标签：python, unicode, utf-8, ide, pycharm

我已经切换到 PyCharm 并在使用它时玩得很开心。我为使用英语以外的语言（即希伯来语和阿拉伯语）的项目编写代码，并且需要不时调试编码。出于某种原因，PyCharm 不会在其调试控制台中显示 Unicode 字符。

我已将 IDE 编码设置为 UTF-8，但没有帮助。

有任何想法吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2015-03-03T03:38:39.840

接受的答案不再正确。在默认字体中，它们都没有区别。我刚刚花了一段时间来解决同样的问题，最好的解决方案是修改你的 .bash_profile （或 .zshrc ）并包含以下行：

```
export PYTHONIOENCODING=UTF-8 
```

从理论上讲，您也可以将其添加到您可以在 Preferences->Build,Execution,Deployment->Python Console 中设置的环境变量中，但是这种方法似乎在我正在使用的构建中被破坏了（4.0.4）

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-01-24T11:54:27.827

您需要将**控制台字体**更改为包含所需 Unicode 字形的字体：

![控制台字体](../Images/41ffd0f94d5f76ce136ea0a35577701b.png)

# java - 将句子中的单个单词大写

> ID：14188656
> 
> 赞同：1
> 
> 时间：2013-01-07T01:21:30.617
> 
> 标签：java

我需要做的就是将每一行中搜索到的单词大写，所以我已经有了`

```
 File myFile = new File("AliceInWonderland.txt");
    Scanner scan = new Scanner(myFile);
    Scanner uInput = new Scanner(System.in);
    String word;
    int count = 0;

    ArrayList<String> Alice = new ArrayList<String>();

        System.out.println("Select the word that you would like to search for, from the book of alice and wonderland: ");
        word = uInput.next();

    while(scan.hasNext()){
        Alice.add(scan.nextLine());
    }

    for(int i = 0;i <= Alice.size();i++){
        if(Alice.get(i).contains(word)){
            System.out.println(Alice.get(i));
            count++;
        }
        else{
            System.out.println(Alice.get(i));
        }
    }` 
```

我可以写`System.out.println(Alice.get(i).ToUpper);`，但这会将所有带有搜索字词的行大写，我要做的就是突出显示搜索字词

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T01:51:40.980

尝试这个

```
int wordLength = word.length();
    for(int i = 0;i < Alice.size();i++){
        if(Alice.get(i).contains(word)){
            for(int c=0;c<Alice.get(i).length()-wordLength;c++){
                if(Alice.get(i).substring(c, c+wordLength).equals(word)){
                    System.out.print(Alice.get(i).substring(0, c));
                    System.out.print(Alice.get(i).substring(c, c+wordLength).toUpperCase());
                    System.out.print(Alice.get(i).substring(c+wordLength, Alice.get(i).length()) + "\n");
                }
            }
            count++;
        }
        else{
            System.out.println(Alice.get(i));
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T01:26:46.347

更改您的 for 循环，例如

```
for(int i = 0;i <= Alice.size();i++)          
{             
  if(Alice.get(i).contains(word))
  {
     System.out.println(word.toupperCase());

     count++;
  }
  else
 {
      System.out.println(Alice.get(i));
   }
} 
```

虽然您知道需要大写的单词，但为什么要从文件中获取字符串并将其大写。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T01:28:01.557

这是一种将字符串中的单词大写的方法：

```
private static String capWord(String s, String w) {
    int k = s.indexOf(w);
    if (k < 0)
        return s;
    return s.substring(0, k) + w.toUpper() + s.substring(k + w.length());
} 
```

在这里使用它：

```
System.out.println(capWord(Alice.get(i), word)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-07T02:01:35.157

首先，您应该将阅读循环更改为：

```
while(scan.hasNext()){
    Alice.add(scan.next());
} 
```

使用`next`代替`nextLine`读取下一个单词，而不是下一行。

但是，如果你想保留换行符，你也可以这样做：

```
while(scan.hasNextLine()){
    line = scan.nextLine();

    for (String w : line.split(" "))
        Alice.add(w);
} 
```

现在在搜索单词时，您可以使用该`equals`方法查找确切的单词，或者`equalsIgnoreCase`如果您想忽略单词大小写。这是它的外观`equals`：

```
for(String w : Alice){
    if(w.equals(word)) {
        System.out.print(w.toUpperCase());
        count++;        
    } else
        System.out.print(w); 
```

此外，您可以避免中间列表并在阅读时在线工作。像这样的东西：

```
while(scan.hasNextLine()){
    line = scan.nextLine();

    for (String w : line.split(" "))
        if(w.equals(word)) {
            System.out.print(w.toUpperCase());
            count++;        
        } else
            System.out.print(w);
} 
```

**编辑：**我没有考虑到该行的最后一个单词可能是您要查找的单词；在这种情况下，因为是最后一个单词，它将包含换行符（“\n”），因此它不会匹配到`w.equals(word)`. 为了解决这个问题，您可以使用`matches`方法而不是`equals`. `matches`采用正则表达式，因此您可以将示例中的 if 表达式替换为：

```
if (w.matches(word + "\s*")){
    ...
} 
```

是一个预定义的`\s`正则表达式匹配组，它将匹配任何空格，包括`\n`，并且`*`用于匹配其中的 0 个或更多。

# css - 在响应式布局中管理文本列

> ID：14188659
> 
> 赞同：0
> 
> 时间：2013-01-07T01:21:47.357
> 
> 标签：css, text, responsive-design, fluid-layout, paragraph

我正在一个使用响应式布局的网站上工作，但在解决较新的 CSS 多列属性的缺点时遇到了问题（http://dev.w3.org/csswg/css3-multicol/） .

当浏览器窗口足够宽时，我将文本分成两列，并带有一个用于较小图像的侧边栏。多列 css 属性效果很好，但它们不太聪明。

第一部分被均匀地分成两个等高的列，但它们太高了。对于阅读本节的人，他们必须沿着第一列向下滚动，然后返回到下一列的开头才能阅读其余部分。

第二部分也分成两个等高的栏，但是只有两个句子，看起来很别扭；没有足够的内容来证明用户必须阅读的第二列。

在我看来，解决方案是这样的：

1.  将部分分成具有固定最大高度的子部分。这样，您可以在不滚动页面的情况下跨栏阅读，它看起来更像是一篇文章。
2.  将短于该最大高度的部分保留为单列。

问题是 CSS3 多列不能以这种方式工作。我认为唯一的方法是某种 javascript 解决方案，涉及对字符数、css 文本属性和元素尺寸进行计算，然后拆分字符串/附加新的 html 元素以将内容分配到单独的部分以使列中断正确。

请记住两件事：

1.  这些列是流体宽度的，所以选择幻数是行不通的。
2.  该过程必须是可逆的，因此响应式布局可以在更窄的浏览器宽度下切换回 1 列。

有点棘手，但我认为这可能足以尝试。有没有人听说过有人可能已经在解决这个问题？或者，如果没有，您对如何为此组合算法有任何想法吗？

非常感谢你的帮助。

* * *

13 年 1 月 8 日：

为了澄清，这里有一些响应式设计的预期模式的图像。（因为我是新来的，所以只有两个链接）

模式一：移动端单列线性化

模式 2\. [iPad 侧边栏单栏/窄浏览器窗口](http://i.stack.imgur.com/oMLoK.png)

模式 3.[宽浏览器窗口的两列](http://i.stack.imgur.com/hhw5R.png)

模式 3 是问题所在。第一部分的内容太长而无法放在一个页面上，因此在这种情况下，我将其划分为适合浏览器高度的行。这就是我正在寻找的 JavaScript 解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T12:55:23.767

我想你要的是这个-> [http://codepen.io/justincavery/full/KsjHa](http://codepen.io/justincavery/full/KsjHa)

我在这里做的是使用 jquery 检查内容 div 中的字符数。

```
var $div = $( '#blah' );
if($div.text().length >= 600) {
$div.addClass('columns');
} 
```

如果字符数等于或大于 600，则它将“列”类添加到包含的 div。

需要明确的是，这意味着任何少于 600 个字符的文章都不会应用“列”类，而任何大于或等于 600 个字符的文章都不会。

现在我们已经对 DOM 进行了排序，然后是 CSS（请注意，此 codepen 有一些与此答案无关的样式，因此请仅用作指南）。

下一阶段是为超过 600 个字符的内容添加列，但我们仍然需要确保在较小的宽度上我们只有一个列，否则它看起来很奇怪。

```
@media screen and (min-width:48em) {
 /*     48.000em /*(ackkkkkk, device specific bad)768px*/
  .columns { 
  -webkit-column-count: 2; /* Saf3, Chrome*/
  -webkit-column-gap: 4%; /* Saf3, Chrome*/
  -moz-column-count: 2; /* FF3.5+ */
  -moz-column-gap: 4%; /* FF3.5+ */
  column-count: 2; /* Opera 11+*/
  column-gap: 4%; /* Opera 11+*/
}
} 
```

在这里，我选择了 48em 或更大（ipad 纵向及以上）作为定义列的点，允许任何较小的屏幕成为单列。

我后来发现的一个问题是，如果文本太长，您希望它再次出现在单个列中。在这种情况下，您需要删除该类以获得更高的值，或者检查字符数是否在两个值之间。

您可能还注意到，我开始研究将背景设置为粉红色并将内容设置为两列的垂直媒体查询，但它并没有达到您想要的效果。

* * *

问题正在研究的这种技术有几点。

1.  在我第三次阅读问题之前，我实际上并没有从图片中意识到它们是两个独立的部分。大多数人会假设左栏中的内容在移动到右栏（例如报纸和杂志）之前会继续到页面底部。您需要在每个部分之间进行某种中断来显示这一点。
2.  这是一个设计问题，所以我认为它主要用于登陆/教学页面，您希望在这些页面中投入更多的工作来设置内容的样式。考虑到这一点，您应该通过手动添加类来定制它。
3.  最后，网络不是印刷品，人们只能在一个页面上阅读内容，看看“ [The Great Discontent](http://www.thegreatdiscontent.com) ”读起来有多好

## 编辑

更新问题后，我认为您正在寻找的实现是在这项出色的工作上完成的 - [http://kaikkonendesign.fi/typesetting-responsive-css3-columns/](http://kaikkonendesign.fi/typesetting-responsive-css3-columns/)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-09-04T10:44:46.093

您可以单独使用 CSS 执行此操作：

```
.box {
    -o-text-overflow: ellipsis;   /* Opera */
    text-overflow:    ellipsis;   /* IE, Safari (WebKit) */
    overflow:hidden;              /* don't show excess chars */
    white-space:nowrap;           /* force single line */
    width: 300px;                 /* fixed width */
} 
```

希望这有帮助。

# javascript - AngularJS 和 Apiary.IO - 无法读取任何响应标头？

> ID：14188662
> 
> 赞同：4
> 
> 时间：2013-01-07T01:22:03.083
> 
> 标签：javascript, http-headers, angularjs, apiary.io

我使用 Apiary.io 模拟我的 API。但不知何故，我无法使用 angularJS 从响应对象中读取任何标题。而且我确信我至少通过检查萤火虫正确设置了 Content-Type: application/json 。Angular 中的代码也应该正确读取标题，因为我可以在将请求发送到 apiary.io 以外的其他地方时打印它们...

```
 $http.get('http://ies.apiary.io/some').then(function(response) {  
    console.log("ok",response.headers('Content-Type'));
    },function(response){console.log("err",response);}); 
```

[http://plnkr.co/edit/zMO0pXGsIdJkV0fZdBdw](http://plnkr.co/edit/zMO0pXGsIdJkV0fZdBdw)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-07T13:25:33.567

这一切都归结为 Firefox 中的一个错误：[https ://bugzilla.mozilla.org/show_bug.cgi?id=608735](https://bugzilla.mozilla.org/show_bug.cgi?id=608735)

对于 CORS 请求，firefox 没有为 req.getAllRequestHeaders() 返回任何内容，尽管 req.getRequestHeader('Content-Type') 返回正确。

要么必须修复 FF 错误，要么 Angular 必须解决它（就像 jQuery 所做的那样），或者您必须更深入并直接使用 XmlHttpRequest 实例。

* * *

这可能也是相关的，但可能不是核心问题：

* * *

然而，几天前，Apiary.io 并没有`Max-Age`在`CORS`headers 中设置。因此，如果您有一个最小的蓝图，您可能会`CORS`缓存飞行前响应，因此即使您向蓝图添加了额外的资源，后续请求也可能被禁止。

`Max-Age`现在设置为 10 秒，因此它应该可以正常工作。但是，根据您的浏览器，飞行前缓存可能仍会影响您。尝试清除它或在另一个浏览器中测试这个应用程序。

# sql - 使用内联查询或联接从另一个表中获取数据？

> ID：14188668
> 
> 赞同：2
> 
> 时间：2013-01-07T01:22:54.907
> 
> 标签：sql, sql-server-2008-r2, query-optimization

使用 SQL Server 2008 R2 哪个更好（更快、更少的中间表、更少的内存使用）和通常的做法？

```
SELECT staff.id, staff.name, details.address, salary.hourly_rate, 
manager.name, boss.name
FROM STAFF_TABLE staff
LEFT JOIN STAFF_DETAILS_TABLE details on staff.id = details.id
LEFT JOIN STAFF_SALARY_TABLE salary on staff.id = salary.id
LEFT JOIN STAFF_TABLE manager on staff.manager_id = manager.id
LEFT JOIN STAFF_TABLE boss on staff.boss_id = boss.id 
```

或者

```
SELECT staff.id, staff.name, 
(SELECT address FROM STAFF_DETAILS_TABLE  id = staff.id) [address], 
(SELECT hourly_rate FROM STAFF_SALARY_TABLE WHERE id = staff.id) [hourly_rate], 
(SELECT name FROM STAFF_TABLE WHERE id = staff.manager_id) [manager_name], 
(SELECT name FROM STAFF_TABLE WHERE id = staff.boss_id) [boss_name]
FROM STAFF_TABLE staff 
```

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T02:31:21.250

如果您在所有表中的所有适当 id 上都有索引，则查询应该生成相同的执行计划。一个细微的区别是优化器可能会以不同的方式处理内联查询，因为它们必须只返回一行（否则会产生错误）。

我更喜欢`from`在可能的情况下将所有表引用保留在子句中。我发现它使维护查询变得更容易——所有的表引用都在一个地方。所以，我更喜欢显式的格式`joins`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T01:31:40.067

获得答案的唯一真正方法是计时并检查各种查询的执行计划。我相信 SQL Server 会尝试优化查询，所以时间上的差异可能很小。带有 JOIN 的版本更具可读性，如果性能没有太大差异，我会更喜欢它。

# jquery - 仅从嵌套 Jsonp 数组中的一个对象读取数据

> ID：14188671
> 
> 赞同：0
> 
> 时间：2013-01-07T01:23:17.043
> 
> 标签：jquery, arrays, jsonp

我的 php 文件创建了一个 jsonp 响应，它有 4 个单独的对象，它们有自己的嵌套。我想知道如何只通过一个嵌套来执行 $.each() ，而不是一次检索所有值，因为我对待每个值都不同。例如，我只想使用 [SubmittedAddress] 下的 $.each 函数浏览所有数据。我通过 jquery ajax 函数调用它。为了便于阅读，这里是非 jsonp 格式的数组：

```
Array
(
    [SubmittedAddress] => Array
        (
            [address1] => 850 BRYANT STREET
            [address2] => 
            [addresscombined] => 850 BRYANT STREET
            [city] => SAN FRANCISCO
            [state] => CA
            [zip] => 94106
        )

    [CorrectAddress] => Array
        (
            [address1] => SUPERIOR COURT
            [addresscombined] => SUPERIOR COURT 850 BRYANT ST STE 306
            [address2] => 850 BRYANT ST STE 306
            [city] => SAN FRANCISCO
            [state] => CA
            [zip] => 94103
            [zip4] => 4667
        )

    [PercentMatch] => Array
        (
            [addresscombined] => 39
            [city] => 100
            [state] => 100
            [zip] => 80
        )

    [Response] => success
) 
```

这是我的 jsonp 得到的，它遍历每一个值，而不仅仅是 [SubmittedAddress] 中的值

```
success: function(data, textStatus){
    $.each(data, function(index, object) {
        $.each(object, function(property, value) {
            alert(property + "=" + value);
        }); 
    });
}, 
```

先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T01:32:24.480

If you want to process one property then do precisely that, e.g.

```
success: function(data, textStatus){
    $.each(data.SubmittedAddress, function(index, object) {
        alert(property + "=" + value);
    });
    $.each(data.CorrectAddress, function(index, object) {
        console.log(property + "=" + value);
    });
    //etc
}, 
```

# wpf - 在资源部分中为窗口中的所有控件定义的样式

> ID：14188672
> 
> 赞同：0
> 
> 时间：2013-01-07T01:23:25.560
> 
> 标签：wpf

当我们在 XAML 资源部分中定义 Style 并将其 TargetType 属性设置为特定控件类型时，我们不需要将 Style 属性设置为该类型的控件。例如

```
<Window.Resources>
        <Style TargetType="Button">
            <Setter Property="Content" Value="Style set for all buttons"/>
            <Setter Property="Background" Value="Gray"/>
        </Style>
    </Window.Resources>
    <Grid>
        <Button Height="27" HorizontalAlignment="Left" Margin="119,56,0,0" Name="button1" VerticalAlignment="Top" Width="140" />
        <Button Style="{x:Null}" Content="No Style" Height="27" HorizontalAlignment="Left" Margin="212,121,0,0" Name="button2" VerticalAlignment="Top" Width="141" />
        <Button  Content="Button" Height="25" HorizontalAlignment="Left" Margin="296,183,0,0" Name="button3" VerticalAlignment="Top" Width="158" />
    </Grid> 
```

但是当我们想为窗口中的所有控件定义样式时，我们需要为每个控件添加 Style 属性以具有该定义的样式。例如

```
<Window.Resources>
        <Style x:Key="Style1" TargetType="Control">
            <Setter Property="Control.Background" Value="Gray"/>
        </Style>
    </Window.Resources>
    <Grid>
        <Button Style="{StaticResource Style1}" Content="Button" Height="23" HorizontalAlignment="Left" Margin="67,52,0,0" Name="button1" VerticalAlignment="Top" Width="75" />
        <Label Style="{StaticResource Style1}" Content="Label" Height="27" HorizontalAlignment="Left" Margin="189,99,0,0" Name="label1" VerticalAlignment="Top" Width="83" />
    </Grid> 
```

我们不能在上面的示例中使用按钮和标签访问样式“Style1”，而无需在按钮和标签控件中专门设置样式属性吗？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T01:44:58.243

尝试`<Style TargetType="Button" BasedOn="{StaticResource style1}"/>`按钮，其他的标签等等......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T01:54:34.843

[与此处](https://stackoverflow.com/questions/802658/can-you-define-multiple-targettypes-for-one-xaml-style)类似的问题

普遍的共识是，您不能将样式应用于像控件这样深奥的东西。考虑到广泛的属性和控件，我可以理解为什么系统拒绝/忽略它。我建议也许这样的事情可以让你非常接近你想要的：

```
<Style x:Key="general" TargetType="{x:Type Control}">
        <Setter Property="Control.Background" Value="Green"/>
</Style>
<Style BasedOn="{StaticResource general}" TargetType="{x:Type Button}"/>
<Style BasedOn="{StaticResource general}" TargetType="{x:Type Label}"/>
<Style BasedOn="{StaticResource general}" TargetType="{x:Type CheckBox}"/> 
```

# javascript - 如何从客户端触发所有验证控件？

> ID：14188674
> 
> 赞同：0
> 
> 时间：2013-01-07T01:23:49.980
> 
> 标签：javascript, asp.net, validation-controls

在一个 aspx 页面中，我有不同的验证控件（一些是必需的，一些是自定义的）。请指导我如何在客户端代码中触发页面的所有验证控件。

我知道 ValidatorEnable() 接受控制 ID 并启用它。但我想使用客户端代码触发/执行所有这些。

请帮忙。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T01:42:41.607

如果您有验证组，请使用：

```
function myFunction(grop)
 {
  if (Page_ClientValidate(grop))
     {

        /*do stuff here*/

        }
} 
```

和没有组的 Page_ClientValidate()

# ruby - Rails act_as_paranoid 和 has_many :through

> ID：14188677
> 
> 赞同：9
> 
> 时间：2013-01-07T01:24:20.633
> 
> 标签：ruby, ruby-on-rails-3, scope, associations, acts-as-paranoid

所以我正在使用 rails3_acts_as_paranoid gem，并且在使用 has_many 控制范围时遇到了一些问题：通过关联。

例如

```
# User.rb
acts_as_paranoid
has_many :folders
has_many :files, :through => :folders 
```

-

```
# Folder.rb
acts_as_paranoid
belongs_to :user
has_many :files, :dependent => :destroy 
```

-

```
# File.rb
acts_as_paranoid
belongs_to :files 
```

现在让我们在 users_controller.rb 中的某处说我想查询属于用户的所有文件，无论它们是否被删除，和/或属于已删除的文件夹。所以很自然我会假设做如下的事情

```
current_user.files.with_deleted 
```

`with_deleted`方法是否可以删除`files.deleted_at IS NULL`

**...但是...**它不会删除在幕后使用的文件夹的 default_scope。所以我们仍然有一个`folders.deleted_at IS NULL`条件，阻止我检索属于那些已删除_at 不为空的文件夹的文件。

我想继续使用acts_as_paranoid，因为它在我的应用程序的所有其他地方都非常有用，并且我尽量不做手动过滤和弹出`.where_values`数组元素之类的事情。但我不太了解处理复杂的范围或可用的方法。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-07T16:23:39.100

好吧，我的问题被否决了，不知道为什么。但我找到了答案：

在 has_many through 上时，我遇到的问题是无法控制 through 模型的范围（在本例中为文件夹）。

原来你可以这样做

```
@myvar = Folder.unscoped { current_user.files.with_deleted } 
```

对于否决它的人-我想知道原因，以便下次我可以提出更好的问题。谢谢！

# asp.net - 重新访问页面时无法检索Cookie

> ID：14188678
> 
> 赞同：0
> 
> 时间：2013-01-07T01:24:28.303
> 
> 标签：asp.net, ios, vb.net, session, cookies

我有一个 Web 应用程序（由 ASP.NET、VB.NET 和 javascript 编写）在登录时存储 cookie“session_key”。身份验证通过后，应用程序跳转到下一页。在下一页上，有一个函数可以获取和检查 cookie “session_key”，以确保用户之前在合理的时间内登录过。该算法从第一天开始就在不同的浏览器以及 iPhone/iPad 和 Android 上运行良好。

不幸的是，由于我们的一些用户已将他们的 iPhone/iPad 升级到 iOS6，因此该算法根本无法在他们的设备上运行。用户第一次可以完美登录应用程序，但是在他们注销并重新登录后，cookie“session_key”就无法检索了。

查了下代码，发现“session_key”是在认证完成后保存在登录页面的，但是当应用跳转到下一页的时候就没有了，浏览器中只有“ASP.NET_cookie”反而。

这个问题只发生在 iOS6 而不是 iOS5 的 Wifi 或 3G 连接，所以它不是关于 iOS6 上的 Wifi 错误。

有人可以帮忙吗？任何提前将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T03:18:11.650

问题已经解决了！！

这是因为 iOS6 上的 Safari 会缓存带有参数值的函数，所以如果所有参数值相同，Safari 会从内存中调用函数。

为了解决这个问题，需要将时间戳传递给函数，因此参数的值不同，导致Safari再次从服务器调用函数而不是从内存中调用函数。

# doctrine-odm - Doctrine ODM / MongoDB：嵌入文档的索引

> ID：14188680
> 
> 赞同：0
> 
> 时间：2013-01-07T01:25:06.370
> 
> 标签：doctrine-odm

在我的应用程序中，我嵌入了两个名称不同但 targetDocument 相同的文档

```
# yml mapping
Content\Post:
    type: document
    embedOne:
        facebook:
            targetDocument: Content\PostEmbed
        twitter:
            targetDocument: Content\PostEmbed 
```

嵌入文档有一个`value`带索引的字段

```
Content\PostEmbed:
    type: embeddedDocument
    fields:
        value:
            type: int
            index:
                order: desc 
```

我的问题是当我运行MongoDb ODM的更新命令时，只`facebook.value`创建了索引，没有创建索引`twitter.value`

当然我可以手动创建它，但我想知道它是否有特殊的语法

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-28T20:21:22.160

您是否尝试过 yaml 标记的替代语法？

[http://docs.doctrine-project.org/projects/doctrine-mongodb-odm/en/latest/reference/yml-mapping.html](http://docs.doctrine-project.org/projects/doctrine-mongodb-odm/en/latest/reference/yml-mapping.html)

```
Content\Post:
  type: document
  facebook:
    embedded: true
    type: one
    targetDocument: Content\PostEmbed
  twitter:
    embedded: true
    type: one
    targetDocument: Content\PostEmbed 
```

# java - 为什么要在 Java 中同步单个语句？

> ID：14188682
> 
> 赞同：1
> 
> 时间：2013-01-07T01:26:01.330
> 
> 标签：java, android, synchronization, android-mediaplayer

我是一个模拟人，学习如何在 android 上编码，所以如果这个问题听起来很愚蠢，请多多包涵。

我了解同步的要点。如果我有两个线程可以访问和修改的数据，则可能导致两个线程中数据变量的值不一致。

使方法同步并锁定它们直到一个线程完成执行它（执行任何条件检查）是有意义的，但是为什么它对单个语句很重要？这对多个语句很重要，因为线程一个有可能在 2 个或多个语句之间退出可运行状态，但我不明白单个语句的意义何在。

这是一个例子

如果我有一个可以被调用的监听器，比如说一个游戏线程，它会修改一个数据变量，我为什么要这样做......

```
 public void onCompletionListener(MediaPlayer player){
    synchronized (this){
        isPrepared = false;
       }
    } 
```

我的音乐课中还有另一种方法叫停止

```
 public void stop(){
   mediaPlayer.stop()
    synchronized(this){
    isPrepared = false;
       }
    } 
```

我为什么要费心去做这件事？这样做是为了两个线程之间值的一致性吗？如果是这样，我可以使用 volatile 之类的东西吗？那会更好吗？

我问是因为我听说同步很昂贵。有更好的选择吗？

提前感谢大家回答我的问题。我很感激。编辑：我[在单个语句上阅读了此同步？](https://stackoverflow.com/questions/9669677/synchronization-on-single-statement)

我想我理解..如果有人能详细说明那将是很棒的。我最初关于 volatile 是否是更好的选择的问题的第二部分也没有得到解答:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T01:40:11.577

之所以这样做，是因为同步还对线程之间的内存可见性提出了要求。

如果该写入不是同步的或易失的，那么对于其他线程何时可以看到它没有任何硬性要求。另一个线程可能在其堆栈中有一个副本为`isPrepared`true，并且它可以永远运行而无需返回主内存并检查是否其他人已更改`isPrepared`，如果没有同步或易失性引用。

volatile 关键字将满足确保其他线程看到更新的直接要求。如果没有看到整个班级/系统，就不可能说它是否是可接受的替代品。可能还有其他同步方法，并且在其中一个处于执行中期时更改 isPrepared 的状态是非法的。显然，删除同步以支持易失性引用将是错误的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T01:36:05.163

在您的情况下，在布尔值上使用 volatile 也可以在没有同步的情况下工作。
原始布尔值表示为 4 字节值，并将写入一个（汇编程序）语句中。

这并不保证适用于 8 字节值（例如 long / double），其中一个线程可以写入较低的 4 个字节，而另一个线程可以写入较高的 4 个字节。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-12T10:06:52.610

作为对先前答案的补充，我想补充一点，在某些情况下，您的单行源代码可以转换为多行机器可执行代码，例如

> 计数器++

尽管它可能看起来像一个单独的操作，但表达式 counter++ 实际上是三个独立的操作：

> 1) 读取计数器的值
> 
> 2) 将此值加 1
> 
> 3) 将更新后的值存储在计数器中

因此，这种语句也应该在多线程上下文中同步。

# c++ - 非法使用这种类型作为表达式 - VS 2012

> ID：14188684
> 
> 赞同：-3
> 
> 时间：2013-01-07T01:26:15.963
> 
> 标签：c++

编译我的源代码时出现此错误， “MPageArrayCursor”：非法使用此类型作为源代码这一部分的**表达式：**

```
class MPageArrayCursor { 
protected: 
    int m_nIndex;

public: 
    MPageArrayCursor(int nIndex) { 
        m_nIndex = nIndex; 
    } 

    virtual ~MPageArrayCursor(); 

    int GetIndex() {
        return m_nIndex; 
    } 

    void SetIndex(int nIndex) {
        m_nIndex = nIndex;
    } 
};

void Add(T pData, MPageArrayCursor* pCursor=NULL)
{
    int nFreeSlot = m_UnusedQueue.top();
    m_UnusedQueue.pop();

    Set(nFreeSlot, pData, pCursor);
} 
```

最初是我移植到 2k12 的 VC++ 2k10 解决方案。为什么我会收到此错误？

这是完整的代码： http: [//pastebin.com/xjVKCZjZ](http://pastebin.com/xjVKCZjZ)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T01:28:26.877

您的代码工作正常，除了您需要在 VS2012 上包含[std::greater函数运算符的函数头](http://en.cppreference.com/w/cpp/utility/functional/greater)

```
#include <functional> 
```

# android - 自定义 ListView 适配器上的 Android onclick 事件不起作用

> ID：14188685
> 
> 赞同：2
> 
> 时间：2013-01-07T01:26:44.883
> 
> 标签：android, listview

我已经建立了一个自定义，并且对每一行`ListAdapter`的事件都有问题。`onclick`我想获取单击行的一些内容，以便稍后在另一个活动中使用它：

```
public class MainActivity extends Activity {

// ArrayList of type "Person". We are making not a list of string, sondern eine list of persons
ArrayList<Person> arrayOfWebData = new ArrayList<Person>();

class Person{
    public String person_id;
    public String name;
    public String birthday;
    public String favorite_color;
    public String profilbild;
}

// This is our new Adapter:
FancyAdapter aa = null;

// For each row we returned until we use the array to create our person obj
static ArrayList<String> resultRow;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    new getJson().execute();
}

// Params,Progress,Result
private class getJson extends AsyncTask<Void,Void,Void>
{
    @Override
    protected Void doInBackground(Void... arg0) {
        String result = "";
        try{
            HttpClient httpClient = new DefaultHttpClient();
            HttpPost httpPost = new HttpPost("xxxxx");
            HttpResponse httpResponse = httpClient.execute(httpPost);
            HttpEntity httpEntity = httpResponse.getEntity();
            InputStream is = httpEntity.getContent();
            // Convert response to String:
            try{
                BufferedReader reader = new BufferedReader(new InputStreamReader(is,"iso-8859-1"),8);
                StringBuilder sb = new StringBuilder();
                String line = null;

                while((line = reader.readLine()) != null){
                    sb.append(line+"\n");
                }
                is.close();
                result = sb.toString();
            }catch(Exception e){
                e.printStackTrace();
            }
        }catch(Exception e){
            e.printStackTrace();
        }
        // Parse JSON:
        try{
            JSONArray jArray = new JSONArray(result);
            for(int i = 0;i < jArray.length();i++)
            {
                // Get our object, this is on persons data:
                JSONObject json_data = jArray.getJSONObject(i);
                // Create a new person:
                Person resultRow = new Person();
                // Set thats persons attributes:
                resultRow.person_id = json_data.getString("id");
                resultRow.name = json_data.getString("name");
                resultRow.favorite_color = json_data.getString("favorite_color");
                resultRow.birthday = json_data.getString("birthday");
                resultRow.profilbild = json_data.getString("profilbild");
                arrayOfWebData.add(resultRow);
            }   
        }catch(Exception e){
            e.printStackTrace();
        }
        return null;    
    }
    @Override
    protected void onPostExecute(Void result) {
        // TODO Auto-generated method stub
        super.onPostExecute(result);
        populateListView();
    }   
}

public void populateListView()
{
    final ListView myListView = (ListView)findViewById(R.id.myListView);
    // initialite FancyAdapter object:
    aa = new FancyAdapter();
    myListView.setAdapter(aa);  

    // Click on ListView Row:
    myListView.setOnItemClickListener(new AdapterView.OnItemClickListener() 
    {
          @Override
          public void onItemClick(AdapterView<?> arg0, View arg1, int position, long arg3) 
          {
                 Object o = myListView.getItemAtPosition(position);
                // Here i want have values of the clicked row,- like the name and/or id...,- but i get the following:
                // Output o.toString(): com.example.customlistview.MainActivity$Person@41252310
                Log.i("TEST", o.toString()); 

                // Here i intend to Start a new Activity passing the "name" of the user (and/or id ...) to the new activity
          }
    }); 
}

class FancyAdapter extends ArrayAdapter<Person>
{
    FancyAdapter(){
        super(MainActivity.this,android.R.layout.simple_list_item_1,arrayOfWebData);
        //imageLoader = new ImageLoader(MainActivity.this);
    }
    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        final ViewHolder holder;
        if(convertView == null){
            LayoutInflater inflater = getLayoutInflater();
            convertView = inflater.inflate(R.layout.row3, null);
            holder = new ViewHolder(convertView);
            convertView.setTag(holder); 
        }else{
            holder = (ViewHolder)convertView.getTag();
        }
        holder.populateFrom(arrayOfWebData.get(position));
        return convertView; 
    }
}

class ViewHolder
{
    public TextView name = null;
    public TextView birthday = null;
    public TextView favorite_color = null;
    public ImageView profilbild = null;
    //public ImageLoader imageLoader;
    ImageLoader imageLoader = new ImageLoader(MainActivity.this);

    ViewHolder(View row){
        name = (TextView)row.findViewById(R.id.name);
        birthday = (TextView)row.findViewById(R.id.birthday);
        favorite_color = (TextView)row.findViewById(R.id.favorite_color);
        profilbild = (ImageView)row.findViewById(R.id.imageView1);  
    }
    // Notice we have to change our populateFrom() to take an argument of type "Person"
    void populateFrom(Person r){
        name.setText(r.name);
        birthday.setText(r.birthday);
        favorite_color.setText(r.favorite_color);
        imageLoader.DisplayImage(r.profilbild, profilbild); 
    }   
} 
```

请看一下`populateListView()`方法。运行应用程序并单击一行时，我在 Log.i 中看到的输出如下：

> // 输出 o.toString():
> com.example.customlistview.MainActivity$Person@41252310 Log.i("TEST", o.toString());

但我想从行中获取一些内容，例如名称或 ID。

我怎样才能做到这一点 ？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-07T01:40:20.653

我猜你`Adapter`持有类型的对象`Person`。由于您`Person`班级中的字段是公开的，因此您可以像这样访问它们。

```
@Override
public void onItemClick(AdapterView<?> arg0, View arg1, int position, long arg3) 
{
    // Get Person "behind" the clicked item
    Person p = (Person) myListView.getItemAtPosition(position);

    // Log the fields to check if we got the info we want
    Log.i("SomeTag", "Persons name: " + p.name);
    Log.i("SomeTag", "Persons id : " + p.person_id);

    // Do something with the data. For example, passing them to a new Activity

    Intent i = new Intent(MainActivity.this, NewActivity.class);
    i.putExtra("person_id", p.person_id);
    i.putExtra("person_name", p.name);

    MainActivity.this.startActivity(i);  
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-19T06:41:36.433

```
//set Item click listener for list view 

listView_matches.setOnItemClickListener(this);
//implement method for item click 

public void onItemClick(AdapterView<?> arg0, View arg1, int position, long arg3) {

    System.out.println("row Number Clicked "+ position);
    Intent intent = new Intent(this,Score.class);
    intent.putExtra("clicked",position);
    startActivity(intent);      

}` 
```

# caching - Apache - 缓存来自应用服务器的响应

> ID：14188687
> 
> 赞同：1
> 
> 时间：2013-01-07T01:26:50.077
> 
> 标签：caching, apache, reverse-proxy

在反向代理配置中，我有一个位于 Apache 2.4.2 后面的 Web 应用程序服务器。应用服务器返回包含以下标头的响应：

```
Pragma: no-cache
Vary: Accept-Encoding
Cache-Control: no-cache
Expires: Mon, 07 Jan 2013 01:21:30 GMT 
```

我有 Apache 2.4.2 在此应用程序服务器前作为反向代理工作，并希望缓存来自应用程序服务器的响应。我无法修改应用程序服务器。我如何在 Apache 中做到这一点？我对 CacheStoreExpired 和 CacheIgnoreCacheControl 抱有希望，但它们在这里没有帮助，因为 Apache 向后端发出有条件的请求 - 并且应用程序服务器总是希望用“现在”过期的新内容来刷新缓存。我想知道我是否可以重写从应用程序服务器返回的标头？

我在这个配置中使用 mod_cache （无济于事）：

```
CacheEnable disk /
CacheRoot "C:/Program Files/Apache Software Foundation/Apache2.4/cache/"

CacheIgnoreCacheControl On
CacheIgnoreNoLastMod On
CacheStoreNoStore On
CacheStoreExpired On

CacheStaleOnError on

LogLevel debug
CacheHeader on
CacheDetailHeader on

CacheDefaultExpire 120
CacheMaxExpire 120

SetEnv proxy-nokeepalive 1
ProxyPass / http://localhost:8080/ 
```

Apache 的调试日志也有点令人担忧：

```
[Fri Jan 04 16:27:52.113857 2013] [cache:debug] [pid 2824:tid 964] cache_storage.c(624): [client 192.168.4.36:51783] AH00698: cache: Key for entity /browse?(null) is http://192.168.4.189:80/browse?, referer: http://192.168.4.189/browse
[Fri Jan 04 16:27:52.113857 2013] [cache:debug] [pid 2824:tid 964] mod_cache.c(159): [client 192.168.4.36:51783] AH00750: Adding CACHE_SAVE filter for /browse, referer: http://192.168.4.189/browse
[Fri Jan 04 16:27:52.113857 2013] [cache:debug] [pid 2824:tid 964] mod_cache.c(169): [client 192.168.4.36:51783] AH00751: Adding CACHE_REMOVE_URL filter for /browse, referer: http://192.168.4.189/browse
[Fri Jan 04 16:27:53.503049 2013] [cache:debug] [pid 2824:tid 964] mod_cache.c(1190): [client 192.168.4.36:51783] AH00769: cache: Caching url: /browse, referer: http://192.168.4.189/browse
[Fri Jan 04 16:27:53.503049 2013] [cache:debug] [pid 2824:tid 964] mod_cache.c(1196): [client 192.168.4.36:51783] AH00770: cache: Removing CACHE_REMOVE_URL filter., referer: http://192.168.4.189/browse
[Fri Jan 04 16:27:53.643529 2013] [cache_disk:debug] [pid 2824:tid 964] mod_cache_disk.c(1318): [client 192.168.4.36:51783] AH00737: commit_entity: Headers and body for URL http://192.168.4.189:80/browse? cached., referer: http://192.168.4.189/browse
[Fri Jan 04 16:27:53.799618 2013] [cache:debug] [pid 2824:tid 964] cache_storage.c(624): [client 192.168.4.36:51783] AH00698: cache: Key for entity /browse?(null) is http://192.168.4.189:80/browse?, referer: http://192.168.4.189/browse
[Fri Jan 04 16:27:53.799618 2013] [cache_disk:debug] [pid 2824:tid 964] mod_cache_disk.c(569): [client 192.168.4.36:51783] AH00709: Recalled cached URL info header http://192.168.4.189:80/browse?, referer: http://192.168.4.189/browse
[Fri Jan 04 16:27:53.799618 2013] [cache_disk:debug] [pid 2824:tid 964] mod_cache_disk.c(865): [client 192.168.4.36:51783] AH00720: Recalled headers for URL http://192.168.4.189:80/browse?, referer: http://192.168.4.189/browse
[Fri Jan 04 16:27:53.799618 2013] [cache:debug] [pid 2824:tid 964] cache_storage.c(320): [client 192.168.4.36:51783] AH00695: Cached response for /browse isn't fresh.  Adding/replacing conditional request headers., referer: http://192.168.4.189/browse
[Fri Jan 04 16:27:53.799618 2013] [cache:debug] [pid 2824:tid 964] mod_cache.c(159): [client 192.168.4.36:51783] AH00750: Adding CACHE_SAVE filter for /browse, referer: http://192.168.4.189/browse
[Fri Jan 04 16:27:53.799618 2013] [cache:debug] [pid 2824:tid 964] mod_cache.c(169): [client 192.168.4.36:51783] AH00751: Adding CACHE_REMOVE_URL filter for /browse, referer: http://192.168.4.189/browse
[Fri Jan 04 16:27:55.235637 2013] [cache:debug] [pid 2824:tid 964] mod_cache.c(1190): [client 192.168.4.36:51783] AH00769: cache: Caching url: /browse, referer: http://192.168.4.189/browse
[Fri Jan 04 16:27:55.235637 2013] [cache:debug] [pid 2824:tid 964] mod_cache.c(1196): [client 192.168.4.36:51783] AH00770: cache: Removing CACHE_REMOVE_URL filter., referer: http://192.168.4.189/browse
[Fri Jan 04 16:27:55.298072 2013] [cache_disk:warn] [pid 2824:tid 964] (OS 5)Access is denied.  : [client 192.168.4.36:51783] AH00699: rename tempfile to file failed: C:/Program Files/Apache Software Foundation/Apache2.4/cache/aptmpcJvfPV -> C:/Program Files/Apache Software Foundation/Apache2.4/cache/A/3/xM0hz_t8XPQaojszgaGA.data, referer: http://192.168.4.189/browse
[Fri Jan 04 16:27:55.298072 2013] [cache_disk:debug] [pid 2824:tid 964] mod_cache_disk.c(617): [client 192.168.4.36:51783] AH00711: Deleting C:/Program Files/Apache Software Foundation/Apache2.4/cache/A/3/xM0hz_t8XPQaojszgaGA.header from cache., referer: http://192.168.4.189/browse
[Fri Jan 04 16:27:55.298072 2013] [cache_disk:debug] [pid 2824:tid 964] mod_cache_disk.c(634): [client 192.168.4.36:51783] AH00713: Deleting C:/Program Files/Apache Software Foundation/Apache2.4/cache/A/3/xM0hz_t8XPQaojszgaGA.data from cache., referer: http://192.168.4.189/browse
[Fri Jan 04 16:27:55.298072 2013] [cache_disk:debug] [pid 2824:tid 964] mod_cache_disk.c(674): [client 192.168.4.36:51783] AH00715: Deleting directory C:/Program Files/Apache Software Foundation/Apache2.4/cache/A/3 from cache, referer: http://192.168.4.189/browse
[Fri Jan 04 16:27:55.298072 2013] [cache_disk:debug] [pid 2824:tid 964] mod_cache_disk.c(1313): [client 192.168.4.36:51783] AH00736: commit_entity: URL 'http://192.168.4.189:80/browse?' not cached due to earlier disk error., referer: http://192.168.4.189/browse 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T01:32:15.513

你可以用 mod_cache 做到这一点

[http://httpd.apache.org/docs/current/mod/mod_cache.html](http://httpd.apache.org/docs/current/mod/mod_cache.html)

请考虑添加：

```
CacheIgnoreQueryString On 
```

默认情况下不缓存带有查询字符串参数的请求。

查看您的日志，最后一行有错误：`not cached due to earlier disk error`.
可能是您的 apache 服务器没有写入缓存目录的正确权限，或者您的磁盘已满...
您应该仔细检查 apache memcache 目录是否已正确创建。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-07-18T09:59:39.143

您可以使用 CacheIgnoreHeaders 忽略来自后端应用服务器的不需要的标头： [http ://httpd.apache.org/docs/current/mod/mod_cache.html#cacheignoreheaders](http://httpd.apache.org/docs/current/mod/mod_cache.html#cacheignoreheaders)

例如：

```
CacheIgnoreHeaders Set-Cookie Cookie Cookie2 X-Forwarded-For X-Forwarded-Host 
```

# node.js - 奇怪的 Cloudfoundry 错误

> ID：14188688
> 
> 赞同：0
> 
> 时间：2013-01-07T01:27:05.363
> 
> 标签：node.js, cloud-foundry

我有一个简单的节点应用程序，我试图在 cloudfoundry 上托管。我正在使用节点模块[srand](https://github.com/isaacs/node-srand)。

当我访问该网址时，我收到此错误。

```
Error: Cannot find module './build/default/srand.node'
    at Function.Module._resolveFilename (module.js:338:15)
    at Function.Module._load (module.js:280:25)
    at Module.require (module.js:362:17)
    at require (module.js:378:17)
    at Object.<anonymous> (/var/vcap/data/dea/apps/UnfoundedAccusations-0-8f4d453d8731dd95a14f10aeddc17eae/app/node_modules/srand/index.js:4:20)
    at Module._compile (module.js:449:26)
    at Object.Module._extensions..js (module.js:467:10)
    at Module.load (module.js:356:32)
    at Function.Module._load (module.js:312:12)
    at Module.require (module.js:362:17) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T02:16:49.307

最近，cloudfoundry 对 Node.js 模块的支持做了一些更改。看看这里[http://blog.cloudfoundry.com/2012/12/19/recent-changes-in-node-js-modules-support/](http://blog.cloudfoundry.com/2012/12/19/recent-changes-in-node-js-modules-support/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T10:52:42.000

您可能已经全局安装了该模块，这对于本地开发来说很好，但您需要*使用*该模块部署应用程序。

在通过 vmc 部署之前，`npm install`在项目目录中运行。

# java - 猜测方法（相当基础的java）

> ID：14188689
> 
> 赞同：-1
> 
> 时间：2013-01-07T01:27:10.640
> 
> 标签：java

如果猜测的辅音是原始单词的一部分，我正在使用以下代码将猜测的辅音添加到一串星中。最初，我一直`wordWithGuess`在调用`getCurrentResult`. 但这样做的结果是，新内容被添加到了末尾，并且`wordWithGuess`不断变长（而不是仅仅替换最近猜测的字母）。

运行下面的代码时，输​​出是

```
猜到r后：*****r******
猜后s：************
猜到t后：**tt********
猜后 l: ********ll**
猜测n后：***********n

```

我的目标是：

```
猜到r后：*****r******
猜到s后：*****r******
猜到t后：**tt*r******
猜到l后：**tt*r**ll**
猜测n后：**tt*r**ll*n

```

示例代码如下：

```
public class Sample {
    String targetWord;
    String wordWithGuess = "";

    public Sample(String targetWord) {
        this.targetWord = targetWord;
    }

    public void guess(String consonant) {
        wordWithGuess = "";

        for (int i = 0; i < targetWord.length(); i++) {
            if (targetWord.substring(i, i + 1).equals(" ")) {
                wordWithGuess += " ";
            } else if (targetWord.substring(i, i + 1).equals(consonant)) {
                wordWithGuess += consonant;
            } else {
                wordWithGuess += "*";
            }
        }
    }

    public String getCurrentResult() {
        return wordWithGuess;
    }

    public static void main(String args[]) {
        String targetWord = "bitterbollen";

        Sample sample = new Sample(targetWord);

        String[] guesses = { "r", "s", "t", "l", "n" };

        for (String guess : guesses) {
            sample.guess(guess);
            System.out.println("After guessing " + guess + ": "
                    + sample.getCurrentResult());
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T01:30:24.600

问题是您需要在调用`guess()`. 这意味着要么存储 的所有值`consonant`，要么找到将旧值`wordWithGuess`与新辅音合并的方法。

第一个选项意味着类似

```
import java.util.Set;
import java.util.HashSet;

class Sample {

    // ...

    Set<String> guesses = new HashSet<String>();

    public void guess(String consonant) {
        guesses.add(consonant);

        wordWithGuess = "";

        for (int i = 0; i < targetWord.length(); i++) {
            String cursor = targetWord.substring(i, i + 1);

            if (cursor.equals(" ")) {
                wordWithGuess += " ";
            } else if (guesses.contains(cursor)) {
                wordWithGuess += cursor;
            } else {
                wordWithGuess += "*";
            }
        }
    }

    // ...

} 
```

这会将旧的猜测存储为`Set`. 现在不仅检查最后的猜测，`guess()`还包括已猜测的任何字母。

事实上，您甚至可以添加一个构造函数来使用您希望默认包含的任何字符来初始化该集合。这将使您消除对空格的检查，因为它将在最初的猜测集中：

```
import java.util.Set;
import java.util.HashSet;

class Sample {

    // ...

    Set<String> guesses;

    public Sample() {
        this.guesses = new HashSet<String>();
        guesses.add(" ");
    }

    public void guess(String consonant) {
        guesses.add(consonant);

        wordWithGuess = "";

        for (int i = 0; i < targetWord.length(); i++) {
            String cursor = targetWord.substring(i, i + 1);

            if (guesses.contains(cursor)) {
                wordWithGuess += cursor;
            } else {
                wordWithGuess += "*";
            }
        }
    }

    // ...

} 
```

另一种选择是更新 wordWithGuess 以包含新的猜测。在 C 中很容易做到这一点，因为字符串可以像字符数组一样被修改（例如，`wordWithGuess[i] = consonant`.Java 更密切地保护它的字符串，但是没有理由不能使用数组`char`来达到相同的效果。

```
public class Sample {
    String targetWord;
    char[] currentResult;

    public Sample(String targetWord) {
        this.targetWord = targetWord;
        currentResult = new char[targetWord.length()];
        for (int i = 0; i < targetWord.length(); i++) {
            if(targetWord.charAt(i) == ' ') {
                currentResult[i] = ' ';
            } else {
                currentResult[i] = '*';
            }
        }
    }

    public void guess(String consonant) {
        for (int i = 0; i < targetWord.length(); i++) {
            String cursor = targetWord.substring(i, i + 1);

            if (cursor.equals(consonant)) {
                currentResult[i] = consonant.charAt(0);
            }
        }
    }

    public String getCurrentResult() {
        return new String(currentResult);
    }

    // ...

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T02:30:39.097

你应该存储所有猜测的辅音，并改变 `word.substring(i, i + 1).equals (consonant)`

类似于

`word.substring(i, i + 1) exists in the consonant guessed.` （当然是pusdo代码）

更多提示：查看 Set（或更准确地说，HashSet），或 String 的 contains() 或 indexOf() 方法。

* * *

给你一些额外的意见：

您正在调用 word.substring(i, i + 1) 而不存储返回的字符串，这是一个毫无意义的调用。

而不是多次调用 word.substring(i, i + 1) ，您可以调用一次并使用返回的字符串进行多重比较。

而且，当您每次比较一个字符时，您应该使用 char 来存储字符，并使用 charAt() 来获取某个位置的字符。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T01:41:32.077

您需要存储上一次迭代的结果。将代码`oldWordWithGuess = wordWithGuess`放在 for 循环的末尾。

然后，在您的循环中，您将需要以下代码：

```
...
if(oldWordWithGuess[i] != `*`) {
    wordWithGuess += oldWordWithGuess[i];
} else if (word.substring(i, i + 1).equals (" ")) {
... 
```

这样它就会把之前的猜测放进去。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-07T14:20:14.473

我实际上找到了一个不同的解决方案，我使用 char 数组并将每个字母存储在该数组的不同元素中。我真的可以这样做吗？这是否不需要太多资源来完成它的工作？

# ruby-on-rails - Rails 教程 - 命名路由

> ID：14188691
> 
> 赞同：3
> 
> 时间：2013-01-07T01:27:20.053
> 
> 标签：ruby-on-rails, ruby, railstutorial.org

我目前正在阅读 Michael Hartl 的 Rails 教程，但遇到了一个我无法理解的错误。

教程中有一节解释了如何在 routes.rb 文件中创建自定义 URI。本教程通过编码来解释：

```
match '/about', to: 'static_pages#about' 
```

应自动创建命名路由，如下所示：

```
about_path => '/about'
about_url  => 'http://localhost:3000/about' 
```

然后，下一节通过用这些变量替换某些代码位来帮助您修复 rspec 测试。但是当我这样做时，我最终会失败每次测试，因为找不到所有“自动创建的变量”......

谁能向我解释为什么没有找到它们，或者我可以在哪里查看它们是否实际上已经创建。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-07T01:41:00.877

据我所知，如果您不使用`as:`，则不会获得命名路线。有关更多信息，请参阅[指南](http://guides.rubyonrails.org/routing.html#naming-routes)。

在您的示例中，您可以执行以下操作：

```
get '/about', to: 'static_pages#about', as: 'about' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-19T01:42:36.833

你用的是spork吗？尝试重新启动 spork 服务器

[RSpec 找不到我的命名路线](https://stackoverflow.com/questions/19101618/rspec-not-finding-my-named-routes)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-06T23:07:01.203

指令是添加这样的一行：

```
match '/about', to: 'static_pages#about', via: 'get' 
```

注意`, via: 'get'`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-24T22:40:50.883

我迟到了这个线程，但我在教程的同一点遇到了同样的问题，但正如@pjam 之前提到的，我认为我们需要`as: 'about'`在 routes.rb 文件中添加选项，以及其他寻求帮助和联系方式，如教程中所述。它为我解决了测试的问题，现在它们都通过了。

# .net - 将 int32 添加到 64 位本机 int 的结果？

> ID：14188693
> 
> 赞同：13
> 
> 时间：2013-01-07T01:27:36.393
> 
> 标签：.net, integer, clr, specifications

*`int32`向64 位添加 时`native int`，CLR 是对 32 位整数进行符号扩展还是零扩展？最重要的是：根据什么信息做出这个选择？*

* * *

我正在编写一个 .NET 编译器并已通读 ECMA 规范，但找不到答案。

> CLI 在其对存储在其评估堆栈上的值的操作中仅支持这些类型的子集：`int32`、`int64`和`native int`。
> [-- [ECMA 335](http://www.ecma-international.org/publications/standards/Ecma-335.htm)，第 I 节 12.1：支持的数据类型]

由于评估堆栈上的值没有关于其符号性的信息，因此操作数的符号性重要的指令有两种变体：一种用于有符号整数，另一种用于无符号整数。`add`,`sub`和指令（那些不检查溢出的`mul`指令）不需要关心操作数的符号性，只要操作数大小相同，因此只有一个变体。但是，操作数并不总是相同的大小......

*[ECMA 335](http://www.ecma-international.org/publications/standards/Ecma-335.htm)，第 III 节 1.5：操作数类型表*规定 an`int32`和 a`native int`可以相加、相减、相乘和相除。结果又是一个`native int`。在 64 位系统上，a`native int`为 64 位宽。

```
ldc.i4.0            // Load int32 0
conv.i              // Convert to (64-bit) native int
ldc.i4.m1           // Load int32 -1
add                 // Add native int 0 and int32 0xFFFFFFFF together 
```

那么这里的结果是什么？请注意，根据规范，运行时不需要跟踪堆栈上值的确切类型或符号：它只知道`int32`,`int64`和`native int`（以及其他一些与此无关的内容）。

* * *

我想算术`IntPtr`，`UIntPtr`因为它在内部表示为本地整数，也会使用这种加法。但是，ILSpy 表明在 C# 中添加 an`IntPtr`和 an`Int32`会调用类上的重载 + 运算符，该运算符`IntPtr`仅接受带符号的`Int32`参数。

直接在 CIL 中执行（使用`add`指令）也表明整数被解释为有符号。它也应该在 Mono 中实现，但我找不到任何参考资料来支持我的发现。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-04T14:07:40.303

添加相同位大小的两个值时，符号性无关紧要。例如，将 32 位 -10 ( `0xfffffff6`) 添加到 32 位 10 ( `0x0000000a`) 将正确产生 0。因此，CIL（通用指令语言）中只有一条`add`指令。

但是，当添加两个不同位大小的值时，符号性*确实*很重要。例如，将 32 位 -10 加到 64 位 10 可以在`0x100000000`完成无符号时产生 4294967296 ( )，而在有符号时产生 0。

CIL`add`指令允许将*本机整数*和*32 位整数*相加。本机整数可能是 64 位（在 64 位系统上）。**测试表明`add`将 32 位整数视为有符号整数，并对其进行符号扩展。** [这并不总是正确](https://stackoverflow.com/a/6334135/146622)的，可能被认为[是一个错误](https://connect.microsoft.com/VisualStudio/feedback/details/675205/)。微软目前不会修复它。

因为溢出检查取决于操作数被视为无符号还是有符号，所以有两种变体`add.ovf`：（有`add.ovf`符号）和`add.ovf.un`（无符号）。但是，当将 32 位整数添加到本机整数时，这些变体也正确地对较小的操作数进行零扩展的符号扩展。

因此，根据 C# 的溢出检查设置，添加本机整数和无符号 32 位整数可能会产生不同的结果。显然，我无法弄清楚这一点是 CIL 语言设计中的错误或疏忽的结果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T08:28:58.083

您在这里处于未知领域，我不知道任何实际允许这样做的 .NET 语言。他们的语法检查器拒绝任何试图这样做的代码。即使添加两个本机整数也会被拒绝。最终由抖动来为其生成机器代码。如果您想知道会发生什么，那么只需进行实验。请务必至少测试 x86 和 x64 抖动。

鉴于不确定的语义以及未来抖动变化可能会打破您的假设的非常现实的可能性，我强烈建议您也用自己的语言拒绝这一点。它只是不是很有用，并且转换为 (long) 并且返回到 (IntPtr) 的结果具有明确定义的语义的简单解决方法。这本身就是一种在您自己的代码生成器中获得可预测行为的方法。

# mysql - 创建一个基于 mysql 事件的数据库

> ID：14188697
> 
> 赞同：0
> 
> 时间：2013-01-07T01:28:05.583
> 
> 标签：mysql

所以一开始我在想这样的事情。

```
CREATE TABLE `events` (
    `event_id` INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
    `event_name` VARCHAR(200),
    `date_added` DATETIME
    PRIMARY KEY(event_id)
);

CREATE TABLE `event_date` (
    `event_id` INTEGER UNSIGNED NOT NULL,
    `start_date` DATE,
    `end_date` DATE,
    FOREIGN KEY event_id REFERENCES events(event_id) ON DELETE CASCADE
);

CREATE TABLE `event_times` (
    `event_id` INTEGER UNSIGNED NOT NULL,
    `event_date` DATE,
    `start_time` TIME,
    `end_time` TIME,
    FOREIGN KEY event_id REFERENCES events(event_id) ON DELETE CASCADE
); 
```

是否可以使用此模式确保 even_times.event_date 在 event_date.start_date 和 event_date.end_date 范围内？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T12:08:34.147

通过这种结构，我认为您可以满足解释的需求

```
CREATE TABLE events(
  event_id INT(10) UNSIGNED NOT NULL AUTO_INCREMENT,
  event_name VARCHAR(200) DEFAULT NULL,
  date_added DATETIME DEFAULT NULL,
  PRIMARY KEY (event_id)
);

CREATE TABLE event_date(
  event_date_id INT(10) UNSIGNED NOT NULL AUTO_INCREMENT,
  event_id INT(10) UNSIGNED NOT NULL,
  start_date DATE DEFAULT NULL,
  end_date DATE DEFAULT NULL,
  PRIMARY KEY (event_date_id),
  INDEX FK_event_date_events_event_id (event_id),
  CONSTRAINT FK_event_date_events_event_id FOREIGN KEY (event_id)
  REFERENCES events (event_id) ON DELETE CASCADE ON UPDATE RESTRICT
);

CREATE TABLE event_times(
  event_time_id INT(10) UNSIGNED NOT NULL AUTO_INCREMENT,
  event_date_id INT(10) UNSIGNED NOT NULL,
  start_time TIME DEFAULT NULL,
  end_time TIME DEFAULT NULL,
  PRIMARY KEY (event_time_id),
  INDEX FK_event_times_event_date_event_date_id (event_date_id),
  CONSTRAINT FK_event_times_event_date_event_date_id FOREIGN KEY (event_date_id)
  REFERENCES event_date (event_date_id) ON DELETE CASCADE ON UPDATE RESTRICT
) 
```

;

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T02:04:20.397

我想您想创建事件详细信息，其中事件可以在一个或多个日期发生，每个日期可以完成一个或多个小时。

如果是这样，最好在“级联”中建立关系，其中甚至在 EVENT_DATE 中引用，进而将 even_date 与 even_time 相关联，从而消除表 even_time 中的日期字段

# java - 示例 MS Access 数据库

> ID：14188700
> 
> 赞同：0
> 
> 时间：2013-01-07T01:28:32.137
> 
> 标签：java, ms-access, jdbc

`School.mdb`对于 JDBC-ODBC Bridge，我使用了一个不超过 5 条记录的自制数据库。
一位社区成员告诉我使用“真实”数据库，例如`HL2D`（如果我的名字正确的话）。
这个数据库在哪里？
如果它可以在互联网上获得，我在哪里可以得到它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T01:43:46.463

他们可能意味着 Hypersonic SQL。您还可以尝试 Derby，它是 JDK 7 及更高版本的一部分。或 SQL 精简版。

比起 MS Access，我更喜欢所有这些。它们都具有类型 IV、纯 Java JDBC 驱动程序，可在 64 位操作系统上运行。JDBC-ODBC 桥驱动程序使用未移植到 64 位的 32 位操作系统的本机代码。

五个记录？您不需要数据库。加载到地图中的文件系统上的一个简单文件就可以做到这一点。

# php - 如何在不同时间将两个时间戳添加到 MySQL 表中的同一行

> ID：14188701
> 
> 赞同：0
> 
> 时间：2013-01-07T01:28:33.110
> 
> 标签：php, mysql

我正在研究基于互联网的时钟，并且是编程新手。我希望这个系统工作的方式是用户点击“打卡”按钮，该按钮只会在表格`PHP`的字段中添加一个时间戳`timeIn`，然后当用户点击“打卡”按钮时，它会添加一个`PHP`时间戳到`timeOut`同一行中的字段`timeIn`被输入。，以及其他几个字段，例如（工作日的描述、运行的设备等）。除了数据库结束之外，我建立的页面具有所有功能，问题是当我单击“时钟输入”按钮时，它会添加一个新行，然后当我点击“时钟输出”按钮时，它会添加另一个新行，其中包含所有的附加信息。是否有一种简单的方法可以确保将所有内容都添加到当天的同一行（假设员工在午夜后不工作）以保持数据库看起来干净？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T01:42:21.123

当你在做时间时，你会说类似

```
INSERT into tablename (employee_id, date, time_in, time_out) VALUES (x, CURDATE(), NOW(), NULL); 
```

当你想做timeOut时，

```
UPDATE tablename SET time_out = now() WHERE date=CURDATE() AND employee_id='x'; 
```

这不是完美的架构，但我希望你有基本的想法。

# c# - Windows 8 - XAML - 将网格放入 ListView

> ID：14188702
> 
> 赞同：4
> 
> 时间：2013-01-07T01:29:05.917
> 
> 标签：c#, xaml, windows-8, windows-store-apps

在我的 Windows 8 商店的 XAML/C# 应用程序中，我正在尝试创建一个 ListView，其中每个 ListItem 都是一个水平网格，所以我使用下面的 XAML：

```
 <ListView Name="ResultsView">
    <ListView.ItemTemplate>
      <DataTemplate>
        <Grid>
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="1*" />
            <ColumnDefinition Width="4*" />
            <ColumnDefinition Width="4*" />
          </Grid.ColumnDefinitions>
          <TextBlock Text="{Binding BestRank}" Grid.Column="0"/>
          <TextBlock Text="{Binding PlayerName}" Grid.Column="1"/>
          <TextBlock Text="{Binding BestScore}" Grid.Column="2"/>
        </Grid>
      </DataTemplate>
    </ListView.ItemTemplate>
  </ListView> 
```

当我运行这个程序时，列表视图包含它绑定到的列表中的所有项目（通过后面的代码）。然而，在每个列表项中，所有三列的内容都出现在一起，它们之间没有任何空格。当我在列表视图之外创建一个类似的网格时，它显示良好并占据屏幕的整个宽度，并将其划分为上面 XAML 中指定的三列。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-07T03:30:00.467

我相信问题是`ItemContainerStyle`需要有一个`HorizontalContentAlignment`. `Stretch`尝试将此添加到 ListView：

```
<ListView.ItemContainerStyle>
            <Style TargetType="ListViewItem">
                <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
            </Style>
        </ListView.ItemContainerStyle> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T02:29:20.397

据我回忆，默认的 ItemsPanelTemplate 是一个堆栈面板，这意味着它不会自动给它的孩子拉伸行为。您将需要更改它，我将在我的手机上等待我的笔记本电脑启动 :)

编辑：

呃不要忽略我在想的`ItemsControl`，JBrooks是对的，只要确保`HorizontalContentAlignment`设置`Stretch`为默认为`Left`。

```
<ListView Name="ResultsView" HorizontalContentAlignment="Stretch"> 
```

这应该可以正常工作 - 任何使用的控件`XXXXContentAlignment`似乎都默认使用`Left`，我认为它与其他控件（例如`Grid`）有点不一致

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T02:41:39.083

其实这不是 Listview 的问题。问题是你把它放在哪里？将您的列表视图放在网格中。它应该工作

```
<ListView Name="ResultsView" 
              HorizontalContentAlignment="Stretch">
        <ListView.ItemTemplate>
            <DataTemplate>
                <Grid Background="Yellow">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="1*" />
                        <ColumnDefinition Width="4*" />
                        <ColumnDefinition Width="4*" />
                    </Grid.ColumnDefinitions>
                    <TextBlock Text="{Binding BestRank}" Grid.Column="0"/>
                    <TextBlock Text="{Binding PlayerName}" Grid.Column="1"/>
                    <TextBlock Text="{Binding BestScore}" Grid.Column="2"/>
                </Grid>
            </DataTemplate>
        </ListView.ItemTemplate>
    </ListView> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-07T02:15:06.143

ListBox 和 Grid 都应该有 Horizo​​ntalContentAlignment="Stretch"

指定网格的宽度或将样式作为资源添加到网格。`</Grid.ColumnDefinitions>`在你的行之后添加这个。

```
 <Grid.Resources>
            <Style TargetType="TextBlock">
                <Setter Property="TextAlignment" Value="Right" />
                <Setter Property="Margin" Value="4" />
                <Setter Property="VerticalAlignment" Value="Center" />
            </Style>
 </Grid.Resources> 
```

这会将属性设置为网格中的所有文本块。您可能只需要 Margin 属性。还要考虑属性 Width 和 Padding。您可以通过将任何给定 TextBlock 上的属性设置为不是 Style 的默认值来覆盖此默认值。

# ruby - 如果在 Ruby 中将块作为参数传递 nil，它会运行吗？

> ID：14188704
> 
> 赞同：0
> 
> 时间：2013-01-07T01:29:14.880
> 
> 标签：ruby, regex, block

我在 ruby​​ 脚本中有以下块：

```
for line in allLines
    line.match(/aPattern/) { |matchData|
        # Do something with matchData
    }
end 
```

如果`/aPattern/`与行中的任何内容都不匹配，该块还会运行吗？如果没有，有没有办法可以强制它运行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T01:36:36.087

The answer is no, the match block will not be run if the match does not suceed. However, `for` is generally not used in Ruby anyways, `each` is more idiomatic, like:

```
allLines.each do |line|
  if line =~ /aPattern/
    do_thing_with_last_match($~) ## $~ is last match
  else
    do_non_match_thing_with_line
  end
end 
```

Note, `=~` is a regex match operator.

# twitter-bootstrap - 引导模态隐藏

> ID：14188708
> 
> 赞同：0
> 
> 时间：2013-01-07T01:30:08.053
> 
> 标签：twitter-bootstrap, modal-dialog

如何在不提交表单的情况下隐藏模式窗口？

在模态页脚中，我有两个按钮，

```
<button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
<button class="btn btn-primary">Save</button> 
```

当我点击保存时，表单将被提交。如何防止它被提交？

谢谢。

# windows - 将 PLX 32 位设备驱动程序移植到 64 位驱动程序

> ID：14188716
> 
> 赞同：2
> 
> 时间：2013-01-07T01:31:00.660
> 
> 标签：windows, 64-bit, driver, device-driver, 32-bit

在我问我的问题之前，这里有一些背景信息，以便您可以更好地了解我要完成的工作。我四处搜索并发现了类似的问题，但没有一个是我要问的。

我正在尝试将修改后的 32 位 PLX Pci9056 设备驱动程序移植到 64 位。我还有一些使用该驱动程序的用户应用程序。PLX 提供完整的 SDK，包括 dll 中的 PLX API、驱动程序源代码以及用于创建和调试用户应用程序的工具。它使用 Windows DDK 构建环境来构建驱动程序。以下是它们的交互方式：

用户应用程序 --> PLX API --> PLX Pci 9056 驱动程序 --> PLX 芯片

32 位驱动程序已经在 Windows 7 32 位系统上测试并且可以正常工作。我相信我应该能够简单地在 64 位 Windows DDK 构建环境中重建驱动程序（当然在处理任何指针转换之后。如果我错了，请纠正我。）此时驱动程序应该在 64- 上正常运行位Windows 7机器。

我知道通常 32 位应用程序可以在 64 位机器上正常运行，但在这种情况下，用户应用程序使用的是最初仅为支持 32 位而构建的 PLX API。我的用户应用程序在不更新的情况下是否仍可在 64 位操作系统中运行，还是会遇到问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2021-08-06T05:35:29.270

PLX PCI SDK（现为 Broadcom PCI/PCIe SDK）多年来一直支持具有相同源代码的 32b/64b 驱动程序。需要时使用特殊宏等。在 Windows 中，由于 WOW 层，您的 32 位应用程序将正常工作。PLX IOCTL 结构始终将指针存储在 64 位字段中，以确保在构建 32 位应用程序时结构不会发生变化。SDK 还提供 API 库的 64 位构建，因此您也可以将您的应用程序构建为原生 64 位。在大多数情况下，相同的应用程序级源代码应该可以在 Windows 和 Linux 中运行。SDK 中提供的示例对于 Win/Linux 都是相同的源。

# vb.net - 同步三个组合框

> ID：14188718
> 
> 赞同：0
> 
> 时间：2013-01-07T01:31:25.860
> 
> 标签：vb.net

我有 3 个从数据库加载但未绑定的组合框，具有不同的数据但具有相同的索引。
所有这些都是这样设置的：

```
 ComboBox1.AutoCompleteMode = AutoCompleteMode.Suggest
 ComboBox1.AutoCompleteSource = AutoCompleteSource.CustomSource
 ComboBox1.AutoCompleteCustomSource = mycolumn1
 ComboBox1.DropDownStyle = DropDownList 
```

我想获得这样的功能，当我在一个组合中选择一个项目时，其他两个选择具有相同索引的项目。敌人开始我很惊讶 _SelectedIndexChanged 从未触发，而我希望从那里获取索引。

为什么会这样以及如何获得所需的功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T05:32:10.113

我不确定您的问题，部分原因是您没有发布代码让我在您的情况下为您提供帮助。这是我为您完成的示例。这是一个快速的，但有效；您实际上可以在一个过程中完成此操作，但这样做是为了了解其工作原理。

```
 Public Class Form1

'Always give variable a default value'
Private selectedIndex As Integer = 0

Private Sub Form1_Load(sender As System.Object, e As System.EventArgs) Handles MyBase.Load
    Dim myArray() As String = {"1", "2", "3"}
    ComboBox1.Items.AddRange(myArray)
    ComboBox2.Items.AddRange(myArray)
    ComboBox3.Items.AddRange(myArray)
End Sub

'Handles one of your comboboxes'
Private Sub ComboBox1_SelectedIndexChanged(sender As Object, e As System.EventArgs) Handles ComboBox1.SelectedIndexChanged
    'Cast this as Integer for selected index and set your variable'
    selectedIndex = CType(ComboBox1.SelectedIndex.ToString, Integer)

    'Next lets make sure that we set the other comboboxes to this index'
    ComboBox2.SelectedIndex = selectedIndex
    ComboBox3.SelectedIndex = selectedIndex
End Sub

'Another one of your comboboxes'
Private Sub ComboBox2_SelectedIndexChanged(sender As Object, e As System.EventArgs) Handles ComboBox2.SelectedIndexChanged
    'Cast this as Integer for selected index and set your variable'
    selectedIndex = CType(ComboBox2.SelectedIndex.ToString, Integer)

    'Next lets make sure that we set the other comboboxes to this index'
    ComboBox1.SelectedIndex = selectedIndex
    ComboBox3.SelectedIndex = selectedIndex
End Sub

'Your last combobox'
Private Sub ComboBox3_SelectedIndexChanged(sender As Object, e As System.EventArgs) Handles ComboBox3.SelectedIndexChanged
    'Cast this as Integer for selected index and set your variable'
    selectedIndex = CType(ComboBox3.SelectedIndex.ToString, Integer)

    'Next lets make sure that we set the other comboboxes to this index'
    ComboBox1.SelectedIndex = selectedIndex
    ComboBox2.SelectedIndex = selectedIndex
End Sub
    End Class 
```

***您必须将全局变量添加到顶部，以便它可以用于保存当前组合框选定的索引。您也可以忽略加载事件，因为我将其用作参考。

谢谢！

# python - 从 Python 启动 Linux 守护进程

> ID：14188721
> 
> 赞同：2
> 
> 时间：2013-01-07T01:31:37.953
> 
> 标签：python, django, linux

快速提问，

我正在使用 Django 中的 python 脚本从网页启动一个 linux 守护程序（运动）。当我使用以下内容时：

```
def restartRecord():
    #restart the service
    config_file = os.path.join(os.path.abspath(os.path.dirname(__file__)), 'recorder/config/motion.conf')
    p = subprocess.call(['motion', '-c', config_file])
    return True 
```

它启动守护进程没有问题，但如果我使用从 django 开发服务器（端口 8000）运行它，它也会占用端口。这是正常的行为吗？- 为什么启动守护进程会占用那个端口？我可以通过停止开发服务器并尝试重新启动来测试它。

有没有更好的方法来启动这项服务？

干杯，本

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T22:06:17.470

它似乎在 apache 下工作正常，这是主要的。感谢您的回复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T03:31:12.973

`p = subprocess.call(['motion', '-c', config_file])`是同步调用，这意味着页面加载将被阻止，直到“运动”退出（或 fork-daemonizes 自身。）

Django 开发服务器是单线程的，因此在等待此请求成功时不会处理任何其他请求。

您可能需要考虑使用 unix`start-stop-daemon`实用程序来包装对运动的调用。

# multithreading - Multi-threading best practices

> ID：14188727
> 
> 赞同：0
> 
> 时间：2013-01-07T01:32:17.087
> 
> 标签：multithreading, synchronization

I have an application I've written in C#, although any similar language would apply here.

The application has the job of drawing a graphical scene to a window on a Form in real-time based on data it receives over various UDP and TCP sockets. Each UDP and TCP connection uses its own thread: these threads each modify various objects in memory which in turn modify the graphical display. I also have a user interface thread which is capable of receiving user events (button clicks, etc) which in turn modify those same objects and the display. Finally, I also have many timers that I fire which launch their own threads which modify those same objects and the display.

The objects in memory that are being modified consist of about 15 different classes.

Everything works pretty reliably, but with all of those different classes being modified by different threads, I've had to add a lot of synchronization locks. I've had to look at each class individually to determine which memory might be altered by more than one thread.

It seems very easy in this situation to miss one of those spots: to forget to add synchronization somewhere it's needed.

I'm curious as to whether others would implement this the way I did, or if there's some more elegant way: perhaps somehow putting all of the modification of class A on its own thread or something?

(P.S. I'm deathly afraid of asking a question here after things didn't go so well the first time. But I don't think my query here is super-obvious so I'm hoping you won't either. ;o)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T01:49:07.180

我相信对此没有直接的答案。

我帮助其他人更改设计以处理类似情况。最常用的技术之一是引入更好的抽象。

例如，假设您有多个线程需要更新包含用户的地图和另一个包含活动用户的集合，而不是为用户地图和活动用户集设置锁并让您的线程手动获取锁，我会建议引入一个抽象调用 UserRepository，其中包含用户映射和活动用户集。UserRepository 将为其他人提供一些对业务有意义的方法来操作 UserRepository。锁是在 UserRepository 的方法中获取的，而不是由调用者显式获取。

根据我过去的经验，通过像上面提到的示例这样更好的设计，可以大大简化 80% 以上的复杂同步。

还有其他可能的技术。例如，如果更新可以异步进行，那么您可以创建命令对象并放入生产者-消费者队列中，而不是让您的线程直接更新资源，并让专用线程执行更新。

此外，有时使用更少的锁更容易处理。例如，当更新多个资源时，我们可以将更新视为一个整体动作，而不是每个资源都拥有一个锁，并且只使用一个锁来进行线程之间的协调。当然它会增加争用，但有些情况下争用不是一个大问题，而是我们想要可维护性。

我相信还有很多其他方法可以处理类似情况，我只是分享我以前的一些经验（有效：P）

# jquery - AngularJS - Call jquery after load

> ID：14188729
> 
> 赞同：0
> 
> 时间：2013-01-07T01:33:04.870
> 
> 标签：jquery, slider, angularjs

I have an image slider on my page:
That is my call:

```
<div id="slider">
    <ul class="bjqs">
        <li ng-repeat="image in dealer.images"><img src="{{image}}" alt="{{image}}" /></li>   
    </ul>
</div> 
```

Somehow the slider doesn't work. I think I have to load the jQuery init after the images are loaded.
This is the call for the slider:

```
$('#slider').bjqs({
            height      : 420,
            width       : 130,
            responsive  : true
          }); 
```

How can I call this function after the images are loaded?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T01:46:28.820

如果您确定这是问题所在，则可以使用[Nick Craver 的解决方案](https://stackoverflow.com/a/3877079/603127)

```
$(".bjqs img").one('load', function() {
   $('#slider').bjqs({
       height      : 420,
       width       : 130,
       responsive  : true
   });  
}).each(function() {
   if(this.complete) $(this).load();
}); 
```

# c++ - Nested Classes and Inheritance C++

> ID：14188730
> 
> 赞同：1
> 
> 时间：2013-01-07T01:33:14.060
> 
> 标签：c++, inheritance, nested-class

this is rather a strange question but I am using nested classes to make property-like functionality in c++. I also made these work as ReadOnly by making the nested class's assignment operator protected and the host class a `Friend` of the nested class. Unfortunately it seems that any inheriting class (with `: public BaseClass`) still cant access the nested class's assignment operator.

I dont know if it matters but I did put the `Friend` in the public section of the class.

Anyone know how I can fix this? (or hack it) Thanks

EDIT: code example added

```
#define ReadOnlyProperty(type,name,parent) \
protected: \
class name : public PropertyBase<type> \
{ \
    parent* This; \
public: \
    friend class parent; \
    name(parent* instance) { This = instance; } \
protected: \
    void operator=(type value) {Set(value);} \
    void Set(type value); \
    type Get() const; \
}; \
public: name name; \
friend class name; \
private: 
```

Base class:

```
class Object
{
ReadOnlyProperty(char,Type,Object);

public:

Object() : Type(this) {}
}; 
```

Inheriting class

```
class A : public Object
{
public:
A() {Type = 'A';}
}; 
```

i get an error on the Type = 'A'

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-07T01:34:25.013

Friendliness is not inherited.

It's not clear what the best solution is; perhaps declare the nested class in the protected section of the base class, and make its members public? That way no friendship is needed, but stuff from outside the class hierarchy won't be able to fiddle with it.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T01:42:54.073

你把朋友声明放在哪个部分都没有关系。

也许，相反，将内部类放在受保护的部分，并将其接口公开。

# .net - Semantics of reducer and combiner in PLINQ

> ID：14188732
> 
> 赞同：2
> 
> 时间：2013-01-07T01:33:26.030
> 
> 标签：.net, plinq, reducers

Inspired by Clojure 1.5's `reducers` library, I've been playing with making PLINQ's `ParallelEnumerable.Aggregate()` method behave the same way. For the most part, it very straightforwardly does.

There's one possible behavior difference that I suspect may exist, though. In [Igor Ostrovsky's blog post about the 2007 CTP](http://blogs.msdn.com/b/pfxteam/archive/2008/01/24/7211660.aspx), he claims that `combineAccumulatorsFunc` has to be commutative. The modern documentation doesn't seem to say anything about it having to be commutative, and I haven't been able to force it to do anything that depends on commutativity, but I also haven't been able to force it to do anything that depends on associativity.

**Main question:** Are the semantics of `combineAccumulatorsFunc` defined anywhere? Even if not, am I going to be okay assuming that it may be called associatively but not commutatively?

I'm using the following LINQPad snippet to try to cause out-of-order `combineAccumulatorsFunc` invocations:

```
ParallelEnumerable.Range(0,1000000).AsUnordered().WithDegreeOfParallelism(10).
        WithExecutionMode(ParallelExecutionMode.ForceParallelism).
        Aggregate<int,IImmutableList<int>,IEnumerable<int>>(
  () => { Thread.Sleep(new Random().Next(5000)); return ImmutableList<int>.Empty; },
  (L,n) => n % 2 == 0 ? L.Add(n) : L,
  (L1,L2) => {new {L1 = L1.First(),L2 = L2.First()}.Dump("partition"); return L1.Concat(L2).ToImmutableList();},
  x => x.AsEnumerable()
).Dump(); 
```

# jquery - drop event or event.dataTransfer.files seem to cause weird mix up in the order of execution

> ID：14188733
> 
> 赞同：1
> 
> 时间：2013-01-07T01:33:32.530
> 
> 标签：jquery, html, drag-and-drop, event-bubbling

I have trouble understanding the order in which my script is beeing executed

i've got the following code in my jQuery drag and drop plugin

```
 //...
    drop : function( event ) {
        event.stopPropagation();
        event.cancelBubble = true;
        event.preventDefault();

        $(this).removeClass("dropboxHover");

        methods.processFiles(event.dataTransfer.files);
    },
    //... 
```

what i don't understand is, why my script first processes the file list (what takes quite some time) and then removes the class after everything else is done.
Shouldn't it be the other way around?
So after letting go of the mouse it takes seconds until one sees a visual effect. That suggests that the browser froze or something.

help or code is appreciated A LOT!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T12:26:34.620

尝试将 processFiles 包装在 setTimeout 0 中：

```
//...
drop : function( event ) {
    event.stopPropagation();
    event.cancelBubble = true;
    event.preventDefault();

    $(this).removeClass("dropboxHover");

    setTimeout(function(){methods.processFiles(event.dataTransfer.files);}, 0);
},
//... 
```

# ruby-on-rails-3 - 通过多个部分提交表单

> ID：14188734
> 
> 赞同：0
> 
> 时间：2013-01-07T01:33:40.543
> 
> 标签：ruby-on-rails-3, jquery

我有一个很长的表格，我想分成大约 5 个部分。当用户在每个部分的底部点击“下一步”时，我想使用 AJAX 加载下一个部分，直到最后一个部分将整个表单提交到数据库中。此外，如果用户点击“上一个”，我需要在字段中填充用户之前填写的内容。

到目前为止，我有这个不起作用：

**用户/new.html.erb**

```
<%= form_for(@user, :html => { :class => "form-horizontal" }, remote: true) do |f| %>
...
<%= f.submit "Next" %> 
```

**users_controller.rb**

```
 def create
    @user = User.new(params[:user])
    if @user.save
      respond_to do |format|
        format.html { flash[:success] = "Welcome to Friends First!"
                  redirect_to @user }
        format.js
      end
    else
      render :new
    end
  end 
```

**创建.js.erb**

```
$("#site_content").html("<%= escape_javascript(render('layouts/partial2')) %>"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T09:04:38.247

我会将 5 个部分中的每一个放入单独的 div（显示：无）中，并且只显示（显示：块）第一个。当用户单击“下一步”时，我会显示第二个等。最后提交到创建操作也可以通过 jquery 完成

```
$.ajax(
  url: '/users',
  type: 'post',
  data: $("form").serialize()
) 
```

我希望，这会有所帮助。

# php - 我怎样才能从这个例子中打破框架？

> ID：14188736
> 
> 赞同：0
> 
> 时间：2013-01-07T01:34:11.500
> 
> 标签：php, javascript, hidden, frames, clickjacking

一个随机网站决定通过以下代码加载我的一个网址...

```
<img src="http://mysite.com/" width="1" height="1" /> 
```

我尝试添加一个 javascript framebreaker 来检查和中断，但这不适用于此。如何确保我的网站摆脱这种情况并显示为完整的浏览器而不是隐藏？他们正在消耗宝贵的带宽。谢谢

这是我已经像往常一样从头脑中尝试过的帧中断代码......

```
if(stristr($_SERVER['HTTP_REFERER'],"badsite.com") == true){
echo '<script language="Javascript">
<!-- 
if (top.location != self.location) 
top.location.replace(self.location);
}
//--> 
</script>';
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T11:17:37.113

你不能。

HTML 被解析为图像。这会引发错误，并且不会执行您可能提供给它的任何客户端代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T14:15:42.413

正如其他人所说，这不是帧中断，也不涉及 PHP 代码。

你唯一能做的就是在你的服务器的配置中，比如添加一个规则来强制请求拥有一个正确的 HTTP Referer。

如果您使用 Apache，您可以[为此在服务器](http://regis.decamps.info/blog/2010/03/hotlinking/)[上上传一个`.htaccess`](http://regis.decamps.info/blog/2010/03/hotlinking/)（链接在我很久以前写的博客文章上）

```
# Prevent Files image hotlinking and bandwidth stealing
RewriteEngine On
RewriteBase /blog/wp-content/uploads/
RewriteCond %{HTTP_REFERER} !^http://www.exemple.com/.*$ [NC]
RewriteRule \.(gif|jpg|jpeg|swf|flv|png)$ / [F,L] 
```

编辑：在你的情况下，你可以做

```
RewriteCond %{HTTP_REFERER} ^http://nasty-site.exemple.com/.*$ [NC]
RewriteRule .* http://localhost/ 
```

这样，来自[http://nasty-site.exemple.com/](http://nasty-site.exemple.com/)的所有流量都被重定向到 localhost 并且没有人被打扰

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T14:28:04.737

是的你可以

简单的一步一步：

1-创建一个与以下内容相同的文件夹：images

2-在图像文件夹中创建一个名称为：image_folder 的文件夹并将您的图像文件放在“image_folder”中

3-通过此内容创建一个 .htaccess 文件

```
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteRule ^index\.php$ - 
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . index.php 
</IfModule> 
```

4- 通过以下内容在 images 文件夹中创建 index.php：

```
 <?
$filename  = urldecode(end(explode('/',$_SERVER['REQUEST_URI'])));
$subname = current(explode('.',$filename));

$extention = end(explode('.',$filename));
switch ($extention) {
    case 'gif':
        $mime = 'image/gif';
        break;
    case 'jpg':
    case 'jpeg':
    case 'jpe':
        $mime = 'image/jpeg';
        break;
    case 'png':
        $mime = 'image/png';
        break;
    case 'ico':
        $mime = 'image/x-icon';
        break;
    default:
        header("HTTP/1.0 404 Not Found");
        echo('image not finded');
        exit;
        break;
}
if(is_file("image_folder/".$filename)){
    header("Content-type: ".$mime);
    readfile("image_folder/".$filename);
}else{
    header("HTTP/1.0 404 Not Found");
    echo('image not finded');
} 
```

解释：**现在您可以轻松地在 index.php 中查看referer**

# git - 如果发生 git 合并冲突，如何将分支标记为获胜者？

> ID：14188749
> 
> 赞同：2
> 
> 时间：2013-01-07T01:36:12.613
> 
> 标签：git

假设我有两个分支 A 和 B 我想在 git 中合并，这两个分支会产生合并冲突。我想告诉 git 一些类似 Merge B into A 的内容，如果存在冲突，请从 B 中获取版本而不是 A 中的内容？

有没有办法自动宣布获胜者而不必对每个冲突的文件执行 git add ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T01:54:07.117

要在发生冲突时自动选择版本，您需要使用`-X`选项。

例如

1.  `git checkout branchA`
2.  `git merge -Xtheirs branchB`

如果您更喜欢分支A，您可以使用`-Xours`

注意不要将 -X 冲突选项与合并策略混淆，这是完全不同的概念。

请参阅[http://git-scm.com/docs/git-merge](http://git-scm.com/docs/git-merge) 并且[是否有“git merge -s ours”的“他们的”版本？](https://stackoverflow.com/questions/173919/git-merge-s-ours-what-about-their)

# cakephp - cakephp post switching to put

> ID：14188752
> 
> 赞同：0
> 
> 时间：2013-01-07T01:36:31.293
> 
> 标签：cakephp, post, put

I'm using cakephp, and I've run into a very strange thing. My form is setup to use a post method, but is using put automatically. Has anyone else come across this? How do I fix this? Why is this happening?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T16:47:00.553

这是由当前记录 id 字段的包含或遗漏引起的。如果您包含一个 id，表单会自动变为“编辑”，如果没有 id，它将是一个“创建”

# sql-server - 创建将从字符串中删除数字的触发器

> ID：14188757
> 
> 赞同：1
> 
> 时间：2013-01-07T01:37:00.297
> 
> 标签：sql-server, triggers

我创建了从字符串中删除数字的函数

```
create function RemoveNumber(@inp nvarchar(50))
returns nvarchar(50)
as
begin
declare @out varchar(50)
if (@inp is NOT NULL)
begin
    set @out = ''
    while (@inp <> '')
    begin
        if (@inp like '[0-9]%')
            set @out = @out + substring(@in, 1, 1)
        set @inp = substring(@inp, 2, len(@in) - 1)
    end
end
return(@out)
end 
```

然后我想在触发器中使用它

```
create trigger ut_RemoverName
on Worker
for insert
as
update Worker
set name = ut_RemoveNumber(name) 
```

它没有看到功能。但是如何从触发器内部的 RemoveNumber 创建循环？（字段`name`- `nvarchar(10)`）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T08:33:32.080

我猜你需要这个

```
create trigger ut_RemoverName on Worker
for insert
as
UPDATE w
SET Name = dbo.RemoveNumber(i.name)
FROM Worker w JOIN inserted i ON w.Id = i.Id 
```

[**SQLFiddle**](http://sqlfiddle.com/#!3/1d554/2/1)上的演示[](http://sqlfiddle.com/#!3/1d554/2/1)

# shell - Finding and Removing Unused Files Through Command Line

> ID：14188758
> 
> 赞同：0
> 
> 时间：2013-01-07T01:37:05.877
> 
> 标签：shell, search, command-line, ssh, command

My websites file structure has gotten very messy over the years from uploading random files to test different things out. I have a list of all my files such as this:

```
file1.html
another.html
otherstuff.php
cool.jpg
whatsthisdo.js
hmmmm.js 
```

Is there any way I can input my list of files via command line and search the contents of all the other files on my website and output a list of the files that aren't mentioned anywhere on my other files?

For example, if cool.jpg and hmmmm.js weren't mentioned in any of my other files then it could output them in a list like this:

```
cool.jpg
hmmmm.js 
```

And then any of those other files mentioned above aren't listed because they are mentioned somewhere in another file. Note: I don't want it to just automatically delete the unused files, I'll do that manually.

Also, of course I have multiple folders so it will need to search recursively from my current location and output all the unused (unreferenced) files.

I'm thinking command line would be the fastest/easiest way, unless someone knows of another. Thanks in advance for any help that you guys can be!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-23T06:02:41.190

是的！这很容易做到`grep`。在这种情况下，您将运行如下命令：

```
$ for orphan in `cat orphans.txt`; do \
    echo "Checking for presence of ${orphan} in present directory..." ;
    grep -rl $orphan . ; done 
```

orphans.txt 看起来像上面的文件列表，每行一个文件。如果你想不区分大小写，你可以添加`-i`到上面。`grep`您可能希望`/var/www`在您的发行版保留其 webroot 的地方或任何地方运行该命令。如果在您看到上面的“正在检查...”并且下面没有匹配项之后，您没有任何与该名称匹配的文件。

# javascript - Node.JS : forEach vs for loop Asynchronous nature

> ID：14188759
> 
> 赞同：1
> 
> 时间：2013-01-07T01:37:07.047
> 
> 标签：javascript, node.js, asynchronous, dom-events, event-loop

```
for(var i=0;i<50;i++) {
      functionWrappingAsycfuncs(i)
}

var nums = [0,1...50]
nums.forEach(functionWrappingAsyncfuns)

functionWrappingAsycfuncs(i){
  readFileAsync(i,function(){
    console.log(i);
  });
} 
```

In the above function , the expected nature of running it in for loop is logging of 50 50times ? But with forEach it does log 1 2 3 ....

Both these implementations look same but does really different tasks The first function calls all the async functions with 0 to 50 as params but doesn't really wait for the callbacks to complete

But the second one (in one of my projects) seems to wait for callback and proceed to next item in the array?

Are they both same?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T02:04:35.747

除了第二个是 50 而不是 49，它们在功能上是相同的。两者都不会在继续下一次迭代之前等待回调，并且在这两种情况下，每次调用都会捕获当前的 0...49 值作为本地参数，`functionWrappingAsycfuncs`因此它们都会记录 0 1 2 3...

# shell - 关于 awk 字段分隔符

> ID：14188762
> 
> 赞同：-2
> 
> 时间：2013-01-07T01:37:41.560
> 
> 标签：shell, unix, awk

想要从 du -h 命令获取第一个字段的小数部分。所以字段分隔符应该是字符 K 或字符 M。我用 -F 尝试了多个选项，但它不起作用。

```
du -h AWSD.????.20121123.????.LBB4.????.*.gz  |
    tr -s ' ' | 
    awk -F'K|M' 'BEGIN{x=0;} {print $1;} END{print x;} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T02:57:27.197

您似乎正在寻找一种 awk 解决方案，该解决方案将使用`K`或`M`用作字段分隔符。您的解决方案几乎是正确的，如果您将其封装`KM`为字符类，它将起作用：

```
du -h | awk -F '[KM]' '{ print $1 }' 
```

现在，在最初的问题中，您还想要总使用量。在这种情况下，删除`K`or`M`字符是不正确的 - 在这种情况下，最好使用`df -k`并且只对第 1 列求和：

```
$ du -k | awk '{ sum+=$1 } END { print sum, "k" }'
52939620 k
$ du -k | awk '{ sum+=$1*1024 } END { print sum/1e6, "x 1e6 bytes" }' 
54210.2 x 1e6 bytes
$ du -k | awk '{ sum+=$1*1024 } END { print sum/1e9, "x 1e9 bytes" }'
54.2102 x 1e9 bytes 
```

请注意此代码如何避免有关 MebiBytes 与 MegaBytes 的讨论。

注意2：但是，此代码为每个父目录再次计算子目录。在 Solaris 系统上，添加`-o`to`du -k`以防止这种情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T01:46:57.370

我认为您想要的是第一个字段：

```
du -h AWSD.????.20121123.????.LBB4.????.*.gz | cut -f1 
```

或没有单位的第一个字段：

```
du -h AWSD.????.20121123.????.LBB4.????.*.gz | cut -f1 | sed 's/[GMK]$//' 
```

或获取第一个字段的整数部分：

```
du -h AWSD.????.20121123.????.LBB4.????.*.gz | sed 's/\([0-9]*\).*/\1/' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T15:51:40.287

一个简单的答案是使用内置类型转换（nawk/gawk）：

```
du -h | nawk '{print $1+0}' 
```

该字段通过添加零转换为数字类型，不属于数字的尾随字符将被简单地忽略。（尽管您应该了解什么被接受为数字，例如像 "123e10" 这样的输入将被视为 123x10^10 。）

为此使用 FS 的一个缺点是，恢复存在哪个分隔符的唯一方法是检查 $0。就像是：

```
if ( match($1,/([0-9.]+)([KMGT])/,bb) ) {
  ...
} 
```

将是我的建议（gawk >=3.1.0）。

如果您正在处理大数字，您可能需要使用 printf()，或者修改默认的数字输出格式（OFMT 变量），而不仅仅是“打印”。我早就放弃了解析 ls/df/du 等依赖于平台的输出，根据我的经验，使用 GNU stat (coreutils) 更加健壮。

# macos - Mac terminal keeps giving message

> ID：14188765
> 
> 赞同：0
> 
> 时间：2013-01-07T01:37:53.043
> 
> 标签：macos, bash, terminal, directory

Whenever I open my terminal on my mac I get this message, `-bash: /usr/local/bin: is a directory`
How do I remove this? As I find it annoying and unneeded.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T06:56:15.553

在您的或您的中可能有一行试图执行`/usr/local/bin`（这是一个目录而不是可执行文件）`~/.bash_profile``~/.bashrc`

如果您想查看这些文件的内容（如上所述），您可以在打开终端后输入：

`cat ~/.bash_profile`

和

`cat ~/.bashrc`

您可以尝试`/usr/local/bin`通过键入以下命令来验证提到的行：

`cat ~/.bash_profile | grep "/usr/local/bin"`

和

`cat ~/.bashrc | grep "/usr/local/bin"`

# java - == 运算符的编译错误

> ID：14188766
> 
> 赞同：1
> 
> 时间：2013-01-07T01:38:16.147
> 
> 标签：java, equivalence

我已经将错误隔离到这一行： string.getClass() == jojo.getClass() 这行不应该创建两个 Class 对象，然后检查它们（如在两个引用中）是否指向同一个对象？代码不会运行，而不是返回 false 值。

```
public class Tester 
{
    public static void main(String[] args) 
    {
        OreoJar jojo = new OreoJar(0);
        OreoJar momo = new OreoJar(1);
        String string = "Hello";

        if (momo.getClass() == jojo.getClass())
        {
            System.out.println("Momo and jojo are of the same class");
        }

        if (string.getClass() == jojo.getClass())
        {
            System.out.println("String and jojo are of the same class");
        }
    }
}

public class OreoJar 
{
    int oreos;

    public OreoJar(int oreos)
    {
        this.oreos = oreos;
    }

    public void count()
    {
        System.out.println(oreos + " oreos in this jar!");
    }
} 
```

这个评论有点隐藏，我认为值得一提，因为它对初学者（比如我自己）最有意义

- 根据 JLS “如果无法通过强制转换将任一操作数的类型转换为另一个操作数的类型，则这是编译时错误”，因此可以比较类型 A 和 B 的两个引用，如果且仅如果，A 可以转换为 B，或者 B 可以转换为 A。——Patricia Shanahan

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-07T02:00:44.613

我同意 OP 应该引用编译错误。

无论如何，当任何人实际进行编译时，编译错误是非常明显的。

错误是：

```
Tester.java:15: incomparable types: java.lang.Class<capture#125 of ? extends java.lang.String> and java.lang.Class<capture#29 of ? extends OreoJar>
    if (string.getClass() == jojo.getClass()){
                          ^ 
```

原因似乎很明显。

来自 Object.getClass() 的 Javadoc：

```
The java.lang.Class object that represents the runtime class of the
object. The result is of type Class<? extends X> where X is the
erasure of the static type of the expression on which getClass is
called. 
```

这意味着，一个 String 实例将返回对 的引用`Class<? extends String>`，而 OreoJar 实例将返回对 的引用`Class<? extends OreoJar>`

这两种类型根本不兼容，因为编译器知道任何扩展 String 的类型都不可能是扩展 OreoJar 的类型。所以比较会导致编译错误。

* * *

有点跑题了，但我认为值得一提，你说：

> 这行不应该创建两个 Class 对象然后检查它们是否指向同一个对象

我认为最好有更清晰的认识。它不会“创建”两个 Class*对象*。getClass() 将返回对 Class 对象的*引用。*而且，它始终是可以指向*对象的**引用*，而不是指向*对象的**对象*（听起来也很奇怪）

 **** * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-07T01:50:50.440

我认为它无法编译的原因是因为 Class 具有通用组件。尝试使用`momo.getClass().equals(jojo.getClass())` And 您也可以尝试比较类的规范名称以获得类似的效果：`momo.getClass().getCanonicalName().equals(jojo.getClass().getCanonicalName())`

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-07T01:42:11.433

`getClass()`返回一个类的实例。`getClass().getName()`返回一个字符串。该`String.equals(otherString)`方法是比较字符串是否相等的正确方法。***

# perl - Perl IO::Socket/IO::Select - 从“ready-to-read”套接字读取

> ID：14188768
> 
> 赞同：2
> 
> 时间：2013-01-07T01:38:25.913
> 
> 标签：perl, sockets, select

这可能不是 Perl 特定的，但我的演示是在 Perl 中的。

我的主程序打开一个监听套接字，然后分叉一个子进程。孩子的第一份工作是连接到主人并打个招呼。然后它继续它的初始化，当它准备好时，它发送READY给master。

主人在分叉孩子之后，等待 HELLO 然后进行其他初始化（主要是分叉其他孩子）。一旦它分叉了所有的孩子并听到了每个孩子的 HELLO，它就会继续等待他们所有人说 READY。

它使用 IO::Select->can_read 执行此操作，然后使用 $socket->getline 检索消息。

简而言之，即使它是由孩子发送的，父母也没有收到 READY。

这是我的程序的一个匆忙精简的版本，演示是错误（我试图删除不相关的内容，但可能会保留一些）。我仍然对是否保留消息边界、是否需要“\n”以及使用哪种方法从套接字读取等问题感到困惑。我真的不想考虑组装消息片段，我希望 IO::Select 不会让我这样做。

为简单起见，该演示仅生成一个孩子。

```
#!/usr/bin/env perl 

use warnings;
use strict;
use Carp;
use File::Basename;
use IO::Socket;
use IO::Select;
use IO::File;                    # for CONSTANTS
use Net::hostent;                # for OO version of gethostbyaddr
use File::Spec qw{rel2abs};      # for getting path to this script
use POSIX qw{WNOHANG setsid};    # for daemonizing

use 5.010;

my $program    = basename $0;
my $progpath = File::Spec->rel2abs(__FILE__);
my $progdir  = dirname $progpath;

$| = 1;                          # flush STDOUT buffer regularly

# Set up a child-reaping subroutine for SIGCHLD.  Prevent zombies.
#
say "setting up sigchld";

$SIG{CHLD} = sub {
    local ( $!, $^E, $@ );
    while ( ( my $kid = waitpid( -1, WNOHANG ) ) > 0 ) {
        say "Reaping child process $kid";
    }
};

# Open a port for incoming connections
#
my $listen_socket = IO::Socket::INET->new(
    Proto     => 'tcp',
    LocalPort => 2000,
    Listen    => SOMAXCONN,
    Reuse     => 1
);
croak "Can't set up listening socket: $!\n" unless $listen_socket;

my $readers = IO::Select->new($listen_socket)
    or croak "Can't create the IO::Select read object";

say "Forking";

my $manager_pid;
if ( !defined( $manager_pid = fork ) ) {
    exit;
}
elsif ( 0 == $manager_pid ) {
    #
    # ------------------ BEGIN CHILD CODE HERE -------------------
    say "Child starting";

    my ($master_addr, $master_port) = split /:/, 'localhost:2000';

    my $master_socket = IO::Socket::INET->new(
        Proto    => "tcp",
        PeerAddr => $master_addr,
        PeerPort => $master_port,
    ) or die "Cannot connect to $master_addr:$master_port";

    say "Child sending HELLO.";

    $master_socket->printflush("HELLO\n");

    # Simulate elapsed time spent initializing...
    #
    say "Child sleeping for 1 second, pretending to be initializing ";

    sleep 1;
    #
    # Finished initializing.

    say "Child sending READY.";

    $master_socket->printflush("READY\n");
    say "Child sleeping indefinitely now.";

    sleep;
    exit;
    # ------------------- END CHILD CODE HERE --------------------
}

# Resume parent code

# The following blocks until we get a connect() from the manager

say "Parent blocking on ready readers";

my @ready = $readers->can_read;

my $handle;

for $handle (@ready) {
    if ( $handle eq $listen_socket ) {    #connect request?

        my $manager_socket = $listen_socket->accept();
        say "Parent accepting connection.";

        # The first message from the manager must be his greeting
        #
        my $greeting = $manager_socket->getline;
        chomp $greeting;
        say "Parent received $greeting";

    }
    else {
        say( $$, "This has to be a bug" );
    }
}

say "Parent will now wait until child sends a READY message.";
say "NOTE: if the bug works, Ill never receive the message!!";

################################################################################
#
# Wait until all managers have sent a 'READY' message to indicate they've
# finished initializing.
#
################################################################################

$readers->add($handle); # add the newly-established socket to the child

do {
    @ready = $readers->can_read;
    say "Parent is ignoring a signal." if !@ready;

} until @ready;

# a lot of overkill for demo

for my $socket (@ready) {
    if ( $socket ne $listen_socket ) {
        my $user_input;
        $user_input = $socket->getline;
        my $bytes = length $user_input;
        if ( $bytes > 0 ) {
            chomp $user_input;
            if ( $user_input eq 'READY' ) {
                say "Parent got $user_input!";
                $readers->remove($socket);
            }
            else {
                say( $$, "$program RECVS $user_input??" );
            }
        }
        else {
            say( $$, "$program RECVs zero length message? EOF?" );
            $readers->remove($socket);
        }
    }
    else {
        say( $$, "$program RECVS a connect on the listen socket??" );
    }
} # end for @ready
say "Parent is ready to sleep now."; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T02:14:29.137

我不知道这是否是您的（唯一）问题，但始终使用`sysread`with `select`。从未使用过缓冲 IO，例如`getline`. `getline`双重没有意义，因为它可以阻止尚未收到的数据。

您的`select`循环应如下所示：

1.  永远，
    1.  等待套接字准备好读取。
    2.  对于每个准备被读取的套接字，
        1.  ```
             sysread($that_socket, $buffer_for_that_socket, 64*1024,
                 length($buffer_for_that_socket)); 
            ```

        2.  如果`sysread`返回 undef，

            1.  处理错误。
        3.  如果`sysread`返回假，

            1.  处理关闭的套接字。不要忘记缓冲区中留下的数据。
        4.  否则，处理读取数据：

            1.  ```
                 while ($buffer_for_that_socket =~ s/^(.*)\n//) { my $msg = $1; ... } 
                ```

# sencha-touch-2 - Sencha Touch 2：内置生产

> ID：14188769
> 
> 赞同：0
> 
> 时间：2013-01-07T01:38:47.960
> 
> 标签：sencha-touch-2

我的应用程序在开发中运行良好，并且在构建生产过程中没有错误。当我访问生产版本时，它说：

使用消息评估[http://www.sentsa.com/build/cp/production/app.js](http://www.sentsa.com/build/cp/production/app.js)时出错：TypeError: Cannot call method 'setMasked' of undefined www.sentsa.com:9 Document was loaded from Application Cache with manifest [http ://www.sentsa.com/build/cp/production/cache.appcache](http://www.sentsa.com/build/cp/production/cache.appcache) Application Cache Checking event Application Cache NoUpdate event

setMasked 不要在 chrome 控制台中给我警告。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T22:06:18.487

查看您正在调用 setMasked 的对象的 ref。当我们指定我们自己的自定义选择器（即使用面板类型或按钮类型）时，我们遇到了问题。它在本地工作正常，但在生产构建中失败。答案是创建我们自己的 xtype，它在配置中有一个 paneltype，这很有效。

```
Ext.define('ux.form.PhoneTabPanel', {
    extend: 'Ext.Container',
    xtype: 'phonetabpanel',
    config: {
        paneltype: null
    }
}); 
```

# java - JSpinner 保持旋转，而 JOptionPane 显示在 ChangeListener 上

> ID：14188773
> 
> 赞同：2
> 
> 时间：2013-01-07T01:39:58.050
> 
> 标签：java, macos, swing, joptionpane, jspinner

所以我创建了一个 Java 应用程序，它使用 JSpinner 和 ChangeEventListener 在达到某些值时运行一些代码。当达到这些特定值时，会出现一个 JOptionPane。但随后 JSpinner 继续旋转。因此，如果 JSpinner 允许值 1-50，并且我将 JSpinner 从 20 增加到 21，则在 JOptionPane 打开时它会一直增加到 50。

奇怪的是，这是 Java 1.4.2 中的一个已知错误，但据说在 5.0 中已修复（[错误 ID：4840869](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4840869)）。我正在运行 Java 6u37。事实上，错误问题中提供的源代码（如下所示）对我来说与它对错误的原始海报所做的效果完全相同。它肯定没有为我修好。

我唯一能想到的可能是我正在运行 Mac OS 10.7.5，并且错误修复可能没有以某种方式进入我的版本。我能做些什么来防止这种行为发生吗？

演示这一点的源代码（最初来自错误报告）：

```
import javax.swing.JFrame;
import javax.swing.JOptionPane;
import javax.swing.JSpinner;
import javax.swing.SpinnerNumberModel;
import javax.swing.event.ChangeEvent;
import javax.swing.event.ChangeListener;

public class SpinnerFrame extends JFrame implements ChangeListener {

    private JSpinner spinner;

    private boolean changing;

    private SpinnerFrame() {
        super();
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        getContentPane().add(getSpinner());
        setSize(80,60);
        setLocation(200, 300);
        setVisible(true);
        changing = false;
    }

    private JSpinner getSpinner() {
        if (spinner == null) {
            spinner = new JSpinner();
            spinner.setModel(new SpinnerNumberModel(10, 1, 50, 1));
            spinner.addChangeListener(this);
        }
        return spinner;
    }

    public void stateChanged(ChangeEvent e) {
        JSpinner spinner = (JSpinner) e.getSource();
        int value = ((Integer) spinner.getValue()).intValue();
        System.out.println("Changed to " + value);
        if (changing) {
            return;
        }
        changing = true;
        if (value > 20) {
            JOptionPane.showMessageDialog(this, "20 exceeded");
            //While this is up, the JSpinner continues to 50
        }
        changing = false;
    }

    public static void main(String[] args) {
        new SpinnerFrame();
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T03:11:59.410

我可以在早期版本的 Mac OS X 上使用 JDK 5 和 6 重现类似的效果。使用鼠标而*不是*键盘时会出现这种效果。

1.  当鼠标按住微调器的向上箭头时，对话框出现在 处`21`。

2.  稍后释放鼠标并关闭第一个对话框时，会出现第二个对话框。

3.  鼠标按住的时间越长，报告的值就越高，直到最大值。

[作为检查您的版本的参考，错误报告](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4840869)中提到的相关代码是`autoRepeatTimer.stop()`在. 效果因 JDK 版本而异，并且可能是箭头在所选初始延迟内重复频率的人为因素。`private static class ArrowButtonHandler``BasicSpinnerUI`

```
autoRepeatTimer.setInitialDelay(300); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T10:59:20.890

我认为如果您在其中显示消息对话框，`EventQueue#invokeLater()`它不应该有这个问题。如果您想在显示后取消旋转到 21，只需在之后将值重置回 20。

# javascript - 当没有超时悬停时，菜单应该隐藏

> ID：14188774
> 
> 赞同：0
> 
> 时间：2013-01-07T01:40:00.240
> 
> 标签：javascript, jquery, timeout, settimeout

我想要完成的是有一个菜单，当单击“按钮”时会显示（按钮和菜单位于不同的元素中，因此鼠标最初不会悬停在菜单上）。

如果在超时期间没有悬停在菜单上，则菜单应自行隐藏（目前它会这样做，但仅在第一次单击时）。

另外，如果元素悬停，我想在鼠标悬停时隐藏并清除计时器并再次单击按钮将重置超时（它可能不会重置？）。

我已经尝试了几种化身，但我尝试过的任何一种行为都没有正确，正在寻求建议。这是我目前正在使用的：

```
var mytimer = window.setTimeout(function() {$('.menu-div').slideUp(function() {
        window.clearTimeout(this.mytimer);
})
}, 5000);

$().ready(function(){

    $('#menu-button').click(function () {
        $('.menu-div').slideDown();
        $(mytimer);
    });

    $('.menu-div').mouseenter(function() {
       window.clearTimeout(this.mytimer);
    });

    $('.menu-div').mouseout(function() {
        $('.menu-div').slideUp(200);
    });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T02:14:49.810

我认为您想要这样的东西（只是猜测，因为您没有提供任何 HTML）

```
$(function(){
    var mytimer=0;  
    $('#menu-button').click(function () {
        $('.menu-div').slideDown();
        mytimer = setTimeout(function(){
            $('.menu-div').slideUp();
        }, 5000);
    });

    $('.menu-div').mouseenter(function() {
        clearTimeout(mytimer);
    });

    $('.menu-div').mouseleave(function() {
        $('.menu-div').slideUp();
    });
}); 
```

[**演示**](http://jsfiddle.net/NCUDP/)。

# android - 日期对话结果月份增加 1

> ID：14188779
> 
> 赞同：0
> 
> 时间：2013-01-07T01:40:50.057
> 
> 标签：android, date, datepicker

我使用`DatePickerDialog`下面的代码。我在我的数据库中检索用户的出生日期，当我打开`dateDialog`它应该是用户的出生日期时。但是当它应该是九月时，它结束了十月。知道是什么原因造成的以及如何解决吗？

```
@Override
protected Dialog onCreateDialog(int id) {
    switch (id) {

    case DATE_DIALOG_ID:
        return new DatePickerDialog(this,
            mDateSetListener,
            mYear, mMonth, mDay);
    }
    return null;
}
@Override
protected void onPrepareDialog(int id, Dialog dialog) {
    switch (id) {

    case DATE_DIALOG_ID:
        ((DatePickerDialog) dialog).updateDate(mYear, mMonth, mDay);

        break;
    }
}   
private void updateDisplay() {
    dateText.setText(
        new StringBuilder()
        // Month is 0 based so add 1

        .append(mMonth +1).append("/")
        .append(mDay).append("/")
        .append(mYear).append(" "));
}

DatePickerDialog.OnDateSetListener mDateSetListener =
        new DatePickerDialog.OnDateSetListener() {

        @Override
        public void onDateSet(DatePicker view, int year, int monthOfYear,
                int dayOfMonth) {
            mYear = year;
            mMonth = monthOfYear;
            mDay = dayOfMonth;
            dob1 = (monthOfYear + "/" + dayOfMonth + "/" + year);
            if(maxYear - mYear <= 12){
                alertMessage = "User must be above age of 12.";
                dialogBox();
                year = mYear;
            }
            else{
                updateDisplay();
            }
        }
    }; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T02:27:54.230

根据评论，您似乎将值存储为基于 1 的索引。（因为 9 月是 9，正如您所说，这意味着 1 月是 1。）您需要将基于 0 的索引传递给`DatePickerDialog`. 当它被传递给构造函数时，只需从你的值中减去 1（假设这是你从数据库中提取它的地方）。

# c - 使用 write() 在 C 中写入文本

> ID：14188781
> 
> 赞同：2
> 
> 时间：2013-01-07T01:41:21.790
> 
> 标签：c

我想将文本写入文件。我必须使用 write() 而不是 fwrite()

```
void write(char *buffer, char *target){
int fh;
    if((fh=open(target, O_RDWR)) >= 0){
                    printf("It works\n");
    } else {
        printf("Cannot open\n");
    }

    if((write(fh, buffer, sizeof(buffer))) >= 0){
        printf("-> It works\n");
    } else {
        printf("Cannot write\n");
    }
    close(fh);
} 
```

我可以写入该文件，但我无法读取它。缓冲区包含一些文本，但是当我打开目标文件时，我得到的只是 \00\00\00\00

我听说 fopen 和 fwrite 可以，但我必须使用 open() 和 write()。我希望有一个人可以帮助我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T01:43:27.810

```
 if((write(fh, buffer, sizeof(buffer))) >= 0){ 
```

您需要将缓冲区的长度传递给您的函数。sizeof(buffer) 将返回 char* 数据类型的大小（4（32 位）或 8（64 位）字节）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T01:44:17.947

您真的不想定义自己的`write()`，因为它会给系统调用 C 包装器起别名，也称为 write。

另外，如果缓冲区中有一个字符串，您将需要准确地写入它的长度。

```
void mywrite(char *buffer, char *target) {
. . .
    write(fh, buffer, strlen(buffer)) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-07T01:46:04.377

a) 你自己的函数名是 write

b) 使用 strlen 而不是 sizeof 作为写入的最后一个参数。

所以

a）将您的函数名称更改为除 write 之外的其他名称。

b) 使用 strlen 代替 sizeof。

# vb.net - 使用 VB.net 在 PDF 中创建换行符

> ID：14188786
> 
> 赞同：3
> 
> 时间：2013-01-07T01:41:50.327
> 
> 标签：vb.net, pdf, newline

我有一个从集合中的项目创建列表的应用程序。然后对于每个项目，我会将它添加到一个空字符串中，然后在它的末尾添加一个换行符。所以理想情况下，我的字符串看起来像：

列表1\n列表2\n列表3\n

生成此字符串后，我将其发回以放置在 pdf 的占位符中。如果我在一个简单的控制台应用程序中尝试此代码，它会在换行符上打印所有内容。但在我的真实世界情况下，我必须将其打印为 pdf。这些项目只显示它们之间的空格而不是换行符。如何格式化我的字符串，以便 pdf 识别换行符而不是忽略它？

这是我用换行符生成字符串的代码。

```
 Private Function ConcatPlacardNumbers(ByVal BusinessPlacardCollection As BusinessPlacardCollection) As String
    Dim PlacardNumbersList As String = Nothing
    Dim numberofBusinessPlacards As Long = BusinessPlacardCollection.LongCount()
    For Each BusinessPlacard As BusinessPlacard In BusinessPlacardCollection
        numberofBusinessPlacards = numberofBusinessPlacards - 1
        PlacardNumbersList = String.Concat(PlacardNumbersList, BusinessPlacard.PlacardNumber)
        If numberofBusinessPlacards <> 0 Then
            PlacardNumbersList = String.Concat(PlacardNumbersList, Enviornment.newline)
        End If
    Next
    Return PlacardNumbersList
End Function 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T02:24:08.080

答案将取决于用于生成 PDF 的工具。由于换行不起作用，我实际上会尝试`\n`. 另一种可能性是 PDF 生成代码并非设计为发出多行；您只能通过检查生成代码来确定这一点。

但是，您应该在代码中解决一个重要的性能问题：您将使用此代码生成大量字符串对象。您应该更改设计以使用[System.Text.StringBuilder](http://msdn.microsoft.com/en-us/library/system.text.stringbuilder.aspx)，这将大大提高性能：

```
Private Function ConcatPlacardNumbers(ByVal BusinessPlacardCollection As BusinessPlacardCollection) As String
    Dim PlacardNumbersList As New System.Text.StringBuilder(10000)
    For Each BusinessPlacard As BusinessPlacard In BusinessPlacardCollection
        If PlacardNumbersList.Length <> 0 Then
            ' This is equivalent to Environment.NewLine
            'PlacardNumbersList.AppendLine()
            ' The attempt to use \n
            PlacardNumbersList.Append("\n")
        End If
        PlacardNumbersList.Append(BusinessPlacard.PlacardNumber)
    Next
    Return PlacardNumbersList.ToString
End Function 
```

请注意，您也不需要跟踪标语牌编号：您可以在第一个通道之后的每个通道的前一个条目的末尾添加一个换行符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T09:49:55.857

尝试添加`\u2028`：

```
Private Function ConcatPlacardNumbers(ByVal BusinessPlacardCollection As _
                                      BusinessPlacardCollection) As String

    Dim PlacardNumbersList As New StringBuilder()

    For Each BusinessPlacard As BusinessPlacard In BusinessPlacardCollection

        PlacardNumbersList.Append(BusinessPlacard.PlacardNumber)
        'PlacardNumbersList.Append(ChrW(8232)) '\u2028 line in decimal form
        PlacardNumbersList.Append(ChrW(8233)) '\u2029 paragr. in decimal form

    Next

    Return PlacardNumbersList.ToString

End Function 
```

对于段落，请`\u2029`改用。更多详情：http:
[//blogs.adobe.com/formfeed/2009/01/paragraph_breaks_in_plain_text.html](http://blogs.adobe.com/formfeed/2009/01/paragraph_breaks_in_plain_text.html)

# haskell-platform - 数据类型 Haskell 错误

> ID：14188790
> 
> 赞同：1
> 
> 时间：2013-01-07T01:42:21.737
> 
> 标签：haskell-platform, template-haskell, haskell

我声明一些数据类型如下：

```
数据 TX_OR_TY = TX | 泰
数据 TX = X Int
数据 TY = Y 浮点数

```

现在我写一些函数返回它们的数据类型：

```
函数TX :: TX
函数TX = X 3

功能 :: TY
功能 = Y 5

ordFuncTX :: TX -> Int -> Bool
ordFuncTX (X a) b = (a > b)

funcTX_TY :: TX_OR_TY
funcTX_TY = if (ordFuncTX funcTX 4) then funcTX else funcTY

```

函数 funcTX_TY 将 TX 的值与 4 进行比较，返回一个 TX_OR_TY 类型，如果较大则返回 TX，如果较小则返回 TY。但是在编译时，它宣布它无法将预期的类型**TX_OR_TY**与**TX**匹配。我该如何解决？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-07T02:00:34.720

您的数据声明可能不是您想要的。

TX_OR_TY 只定义了两个*构造函数*：TX 和 TY。

以下数据声明定义了TX 和 TY*类型。*

你可能的意思是

```
data TX_OR_TY = AnX TX | AnY TY
data TX = X Int
data TY = Y Float
-- Now I write some function return their data type:

funcTX :: TX
funcTX = X 3

funcTY :: TY
funcTY = Y 5

ordFuncTX :: TX -> Int -> Bool
ordFuncTX (X a) b = (a > b)

funcTX_TY :: TX_OR_TY
funcTX_TY = if (ordFuncTX funcTX 4) then AnX funcTX else AnX funcTY 
```

请注意，TX_OR_TY 是标准前奏中的[Either](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#t%3aEither)数据类型的特殊版本。要使用 Either，请省略 TX_OR_TY 的定义并更改函数：

```
funcTX_TY :: Either TX TY
funcTX_TY = if (ordFuncTX funcTX 4) then Left funcTX else Right funcTY 
```

# jquery - 为什么cfdiv绑定不触发

> ID：14188796
> 
> 赞同：0
> 
> 时间：2013-01-07T01:43:05.807
> 
> 标签：jquery, coldfusion

> **可能重复：**
> [jquery cfml trigger('change') not working](https://stackoverflow.com/questions/14174288/jquery-cfml-triggerchange-not-working)

```
<input name="btnScan" type="button" id="btnScan" style="WIDTH: 120;HEIGHT: 30" onClick="return btnScan_onclick()" value="Scan"/>
<input name="ScanDocument" id="ScanDocument" type="text" value="{DocType}" class="ScanDocument">
<cfselect name="DocType" id="DocType" class="selectClass" query="qGetDocTypes" display="name" value="DocTypeID">

<cfdiv style="border:1" id="handler_#docAreaID#" bind="url:#request.controlurl#documentHandler/?ScannedDocument={ScanDocument}">

$(".ScanDocument").val('changed to trigger bind'); 
```

如果我选择一种文档类型，输入字段会更改以反映它。但是 cfdiv 绑定没有被触发。

我可以将绑定更改为 {DocType} 并且每次选择不同的文档类型时都会发生绑定。但是，我无法从 Javascript 或 Jquery 模拟绑定，以便在上传新文件后，我可以刷新 cfdiv 中的列表。

# function - Fortran 函数：指针作为实际参数，目标作为形式

> ID：14188798
> 
> 赞同：3
> 
> 时间：2013-01-07T01:43:21.933
> 
> 标签：function, pointers, fortran

我正在尝试破译一个 fortran 代码。它将指向函数的指针作为实际参数传递，而形式参数则是目标。它在主程序中定义并分配一个 globalDATA 类型的指针，然后调用一个传递该指针的函数：

```
module dataGLOBAL
 type globalDATA
   type (gl_1)      , pointer :: gl1
   type (gd_2)      , pointer :: gd2
   type (gdt_ok)    , pointer :: gdtok
   ...
   ...
 end type globalDATA
end module dataGLOBAL

Program main
....
....
use dataGLOBAL   
...
type(globalDATA),pointer :: GD

allocate(GD)
returnvalue = INIT(GD)
....
....
end 
```

函数内容如下：

```
integer function INIT(GD) result(returnvalue)
....
....
use dataGLOBAL

type(globalDATA)  , target   :: GD

allocate (GD%gl1)
allocate (GD%gd2)
allocate (GD%gdtok)
....
....
end function INIT 
```

这样做有什么意义？为什么主程序中的指针和目标结构的单个组件都必须分配？谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-07T02:40:04.937

一些事情可能会发挥作用......

*   当您将指针作为实际参数提供给相应的虚拟参数不具有 POINTER 属性（此处为这种情况）的过程时，与虚拟参数关联的事物是实际参数指针的目标。所以在这种情况下，传递的东西是`GD`（在主程序中）指向的对象 - 由 allocate 语句分配的东西。（当实际参数和虚拟参数都具有 POINTER 参数时，则 POINTER 本身被“通过” - 您可以更改 POINTER 指向的内容，并且该更改会反映在调用范围中。）

*   因为`GD`函数内部的哑元具有目标属性，所以函数内部的指针可以指向哑元。您没有显示此类指针的任何声明，但它们可能在省略的代码中。如果**没有任何东西**指向`GD`虚拟参数（包括在可能由 INIT 函数调用的任何过程中），那么 TARGET 属性是多余的，但除了抑制一些优化之外是无害的。

*   具有指针属性的事物也（由语言规则自动）具有 TARGET 属性 - 因此`GD`在主程序中具有 TARGET 属性。`GD`在主程序和函数中都具有目标属性的事实可能是相关的，因为......

*   当虚拟参数具有 TARGET 属性并且作为实际参数传递的事物具有 TARGET 属性时，与过程中的虚拟参数相关联的指针也是“通常”的（共索引事物/非连续存在异常/处理器依赖性数组/向量下标部分太复杂以至于我记不住）与相应的实际参数相关联。如果指针不是局部变量（可能是在模块中声明的指针），则此关联在过程结束后仍然存在。也许这与省略的代码有关。（或者，如果实际参数没有 TARGET 属性，则与虚拟参数关联的任何指针在过程结束时都将变为未定义。）

*   该`globalDATA`类型的组件本身就是指针。因此，`GD`在主程序中是一个指向某物（由主程序中的单个 ALLOCATE 语句分配的东西）的指针，该指针本身包含指向其他东西的指针（那些其他东西由函数中的众多 ALLOCATE 语句分配）。您有两个级别的指针，因此有两个级别的 ALLOCATE。

*   在 Fortran 2003（或带有“可分配 TR”的 Fortran 95）之前，您不能在派生类型中有 ALLOCATABLE 组件，也不能有 ALLOCATABLE 虚拟参数 - 当动态分配的需求与您必须使用的这些以前的限制相冲突时而是使用指针，即使您只是将指针用作值。我强烈怀疑您的代码可以追溯到这个时代（大约十年前，对可分配 TR 的支持变得普遍）。在非常“现代”的 Fortran 指针中（应该？）仅在您可能想要指向其他事物的变量时使用（其他事物包括“无”）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T02:23:36.333

对于本身包含指针的用户定义类型的指针变量，您必须同时分配（即创建存储）整个变量和组件指针。当整体变量为时，组件不会自动分配。有人做出了设计选择，在主程序中分配整体变量，在子程序中分配组件。也许他们认为分配整体变量很简单，但分配所有组件变得复杂，并希望将其归为子程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T12:24:58.963

因为没有为虚拟参数指定指针属性，所以整个派生类型`GD`是从主代码（而不是指向它的指针）传递的。在子程序方面，你可以明确地写

```
integer function INIT(GD) result(returnvalue)
...
use dataGLOBAL

type(globalDATA), intent(inout), target :: GD 
```

让它更清楚。虚拟参数的目标属性仅确保您可以通过指针分配指向子例程*内的该参数。*

只要您只操作派生类型的字段，而不是整个派生类型（例如通过分配或解除分配），无论您是`INIT`通过传递指针还是派生类型来调用例程，它都不会有区别本身。

正如在其他答案中已经指出的那样，该程序的目的似乎是将派生类型及其组件的分配彼此分开。这种策略的一个可能优点是可以将指针和静态分配的派生类型都传递给`INIT`例程。

# wpf - 我应该使用哪个范围在 WPF 应用程序中将 DbContext 与 Ninject 绑定

> ID：14188799
> 
> 赞同：3
> 
> 时间：2013-01-07T01:43:22.313
> 
> 标签：wpf, ninject, entity-framework-5

在 Web 项目中，将 DbContext 绑定到我的真实数据库上下文时，我会使用 RequestScope。但是在 WPF 中，我应该选择单例还是跨界范围？我选择哪一个真的很重要吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T05:29:28.880

根据您的应用程序的复杂性，我将从`PerThreadScope`. 这样，您就有一个用于应用程序主线程和每个后台线程。它们由 ninject 跟踪并妥善处理。如果您的应用程序变得更复杂，您可以切换到`NamedScope`每个`InCallScope`RootView 的数据库上下文。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T03:46:41.897

在 Web 应用程序中使用 RequestScope 的原因是您不希望 DbContext 实例留在内存中。

WPF 或桌面应用程序也是如此，但它可能更棘手，具体取决于您如何使用数据访问组件（使用 DbContext 的东西）。大多数情况下，它可以设置在瞬态范围上，当您的屏幕关闭并消失时，它会被设置，例如，如果您直接在视图模型中使用它，一旦视图模型消失（正在显示另一个视图），将 ViewModel 和 DbContext 都设置为 Transient 并处置 ViewModel 将确保您的 DbContext 也被正确处置。

# android - 垂直视图分页器

> ID：14188802
> 
> 赞同：0
> 
> 时间：2013-01-07T01:43:51.577
> 
> 标签：android, android-viewpager

有没有人通过尝试更改 ViewPager 的源代码来实现垂直[ViewPager](http://code.google.com/p/openintents/source/browse/trunk/compatibility/AndroidSupportV2/src/android/support/v2/view/ViewPager.java?r=3488)？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T01:53:50.140

我认为您需要编辑 ViewPager 的源代码并换出所有 x,y 和 width,height 逻辑。DirectionalViewPager 应该可以完成这项工作。这是来源：[https ://github.com/JakeWharton/Android-DirectionalViewPager](https://github.com/JakeWharton/Android-DirectionalViewPager)

# haskell - 无法用 Parsec 计算出负前瞻

> ID：14188804
> 
> 赞同：0
> 
> 时间：2013-01-07T01:44:13.690
> 
> 标签：haskell, parsec, lookahead

我是 Haskell 的初学者，所以很明显我做错了什么......

在尝试解析时，我陷入了前瞻问题`"1:1,2, 2:18, 3:100"`。`[(1,1), (1,2), (2,18), (3,100)]`

要知道一个数字是否是诗句编号，它应该向前看一个冒号，因为那样它是一个章节编号。

问题在于最后一个函数`verseNr`，如果后面没有冒号，它应该解析+消耗数字，否则失败而不消耗任何东西（将数字作为章节号解析`refGroupByChapter`）。

除了这个问题，它似乎工作得很好:)

```
import Text.ParserCombinators.Parsec

main = do
  case (parse refString "(unknown)" "1:1,2, 2:18, 3:100") of
    Left  e -> do putStr "parse error at "; print e
    Right x -> print x  -- expecting: [(1,1), (1,2), (2,18), (3,100)]

refString :: GenParser Char st [(Int, Int)]
refString = do
  refGroups <- many refGroupByChapter
  eof
  return $ concat $ map flatten refGroups
  where flatten (_, [])   = []
        flatten (c, v:vs) = (c, v):(flatten (c, vs))

refGroupByChapter :: GenParser Char st (Int, [Int])
refGroupByChapter = do
  chapterNum <- many digit
  char ':'
  verseNums <- verseNrs
  return ((read chapterNum :: Int), verseNums)

verseNrs :: GenParser Char st [Int]
verseNrs = do
  first <- verseNr
  remaining <- remainingVerseNrs
  return (first:remaining)
  where
    remainingVerseNrs = do  -- allow for spaces around the commas
      (spaces >> oneOf "," >> spaces >> verseNrs) <|> (return [])
    verseNr = try $ do
      n <- many1 digit
      notFollowedBy $ char ':'  -- if followed by a ':' it's a chapter number
      return (read n :: Int) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T04:03:38.353

您的特定问题的诀窍是使用`sepBy`函数族。您正在解析用逗号分隔的数字列表，这正是`sepBy`它的用途。经文列表具有以下属性：必须至少有一个经文编号，并且结尾有一个逗号。结合两者，我们意识到我们需要这个`sepEndBy1`功能。这些函数通常写在中缀位置，所以你的代码看起来像这样：

```
verseNrs = verseNr `sepEndBy1` (spaces >> char ',' >> spaces) 
```

我认为您无需更改任何其他内容即可使代码正常工作。

其他一些次要样式说明：您有一些不必要的括号。这不重要，它只是让我个人感到恼火。例如，`case ... of`您*不需要*围绕`...`位的括号。此外，使用时不需要类型签名`read`——编译器可以推断类型。也就是说，由于`verseNrs`返回`[Int]`，编译器和我都完全清楚`read n`生成`Int`. 没有必要明确地说出来。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T15:13:31.090

有两个问题。首先，该函数`verseNr`可能并不总是成功解析一个数字，因为该数字后面可能跟一个`:`. 虽然该`verseNrs`函数始终假定`verseNr`通过模式匹配来成功解析数字作为`first`. 其次，该函数`verseNrs`不处理字符串中最后一位数字的大小写，该数字后面没有`,`.

我相信Tikhon的建议是最好的。但是，如果您坚持手动实现它，我会这样做。

```
import Control.Monad (void)
import Control.Applicative ((<*))

verseNrs :: GenParser Char st [Int]
verseNrs = do
    first <- fmap Just (try (many1 digit
                          <* spaces
                          <* (eof <|> void (char ','))
                          <* spaces))
             <|> return Nothing
    case first of
      Just first -> fmap (read first:) verseNrs
      Nothing    -> return [] 
```

其余代码相同。

# c++ - c++ 链表 - 插入对象

> ID：14188806
> 
> 赞同：0
> 
> 时间：2013-01-07T01:44:20.143
> 
> 标签：c++, list, object, insert, abstract

我有一个通用链表，它适用于各种类型的数据，包括对象和指向对象的指针等，但是当我从派生自**抽象类**的类中插入对象时，我无法使用该列表。

我有一个名为vehicle 的抽象类和2 个carr 和truck 类，我可以做这样的事情：

```
list<vehicle> lv;

vehicle * v1;
vehicle * v2;

v1 = new carr;
v2 = new truck;

cin >> *v1 >> *v2;

//But when I try to insert in the list

lv.insertEnd(*v1); 
```

我有错误：

**无法分配抽象类型“车辆”的对象**

并且编译器显示错误出现在我编写的部分链表代码的 insertEnd 方法中：

```
newNode->item = new Item; 
```

这是一个项目的一部分，我需要有一个车辆列表，车辆可以是轿车、卡车等。我有一组车辆用指向指针的指针实现，但我试图用车辆列表来做到这一点.

你能帮助我吗？

编辑：该项目在我的链表中，我将展示我的 insertEnd 方法：

```
template <class Item>
void list<Item>::insertEnd(const Item& item)
{
    node<Item> *newNode= new node<Item>;

    newNode->item = new Item;
    *(newNode->item) = item;
    newNode->next = 0;

    if(head == 0)
    {
       head = newNode;
       tail = newNode;
        _size++;
    }
    else
    {
        novoNo->prev = tail;
        tail->next = newNode;
        tail = newNode;
         _size++;
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-07T01:47:11.253

您正在尝试在链接列表中按值存储项目。按值使用项目会破坏多态性：只有指针或引用是多态的。

这是您看到的错误的原因是您在此处取消引用您的指针：`lv.insertEnd(*v1)`. 以这种方式传入一个值将导致 C++ 使用 中*指定的类型的复制构造函数`insertEnd`*来使对象在你的`insertEnd`函数内部（检查你的代码：参数`insertEnd`的类型肯定是你的模板中指定的类型 - 这是`vehicle`这里）。通过值传递，您是在告诉您的代码将整个 of 复制`v1`到`insertEnd`. 这分崩离析，因为`vehicle`它是一个抽象类：它的复制构造函数不能用于创建一个功能齐全的对象，因为它是抽象的。

这种阴影掩盖了这里真正发生的事情：您不能通过值传递对象并期望它们是多态的。如果您没有看到此错误，则可能发生的情况是您可能会对[object 进行切片](http://en.wikipedia.org/wiki/Object_slicing)，这可能会使调试变得更糟。做@billz 的建议并使用智能指针。

编辑：在看到您添加的 insertEnd 代码（通过引用传递的地方）后，有一个附录：编译器*不会*在`insertEnd`. 相反，您可能会在这一行看到错误：`newNode->item = new Item`. 在这里，您可以看到您尝试实例化抽象类的位置。将单词 ' `Item`' 替换为 ' `vehicle`' - 这就是您使用模板所做的 - 您可以非常清楚地看到它。

无论如何，通过引用传递给取消引用的指针确实是一件非常痛苦且容易出错的事情。引入错误太容易了：如果你`delete`在代码中的任何地方 v1，就像一个优秀的程序员所做的那样（伟大的程序员使用自动指针），你可能会让你的引用悬空：有一天指向内存中的一个空间——比如当某人重要的是运行您的代码 - 可能在您的参考不知情的情况下充满垃圾。这就是发疯的方式，我的朋友。

这就是为什么智能指针是 C++ 程序员最好的朋友的原因：一旦你*理解*了它们在做什么，你几乎可以忽略这种混乱，只是通过*值*自由地传递它们。他们的生命周期契约定义得很好，他们自己清理，他们是异常安全的。只要您不设置引用周期 - 这在日常使用中比通过引用传递取消引用的指针问题要小得多 - 或[尝试在标准容器中使用 auto_ptr 请阅读此链接并理解它](https://stackoverflow.com/questions/111478/why-is-it-wrong-to-use-stdauto-ptr-with-standard-containers)，你已经大大减少了你的记忆问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T01:47:07.930

在这种情况下你需要使用指针，更好的方法是使用智能指针。

```
std::list<std::shared_ptr<vehicle> > lv; 
```

在您的`list<vehicle> lv;`中，`lv`仅包含`vehicle`类型对象，`lv.insertEnd(*v1);`会将您的对象**切片**为车辆类型，这是不允许的，因为车辆是抽象类。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-07T01:50:08.347

由于无法实例化抽象类型的对象，因此无法构造用于插入的对象。

此外，stl 的复制构造语义不支持多态使用。“车辆”列表应该只包含车辆对象，而不是汽车对象。

您必须使用指针容器。

# python - Numpy：初学者

> ID：14188807
> 
> 赞同：9
> 
> 时间：2013-01-07T01:44:22.177
> 
> 标签：python, numpy, iteration

我正在尝试学习[nditer](http://docs.scipy.org/doc/numpy-dev/reference/arrays.nditer.html)以可能用于加速我的应用程序。在这里，我尝试制作一个有趣的重塑程序，该程序将采用大小为 20 的数组并将其重塑为 5x4 数组：

```
myArray = np.arange(20)
def fi_by_fo_100(array):
    offset = np.array([0, 4, 8, 12, 16])
    it = np.nditer([offset, None],
                      flags=['reduce_ok'],
                      op_flags=[['readonly'],
                                ['readwrite','allocate']],
                      op_axes=[None, [0,1,-1]],
                      itershape=(-1, 4, offset.size))

    while not it.finished:
        indices = np.arange(it[0],(it[0]+4), dtype=int)
        info = array.take(indices)
        '''Just for fun, we'll perform an operation on data.\
           Let's shift it to 100'''
        info = info + 81
        it.operands[1][...]=info
        it.iternext()
    return it.operands[1]

test = fi_by_fo_100(myArray)
>>> test
array([[ 97,  98,  99, 100]]) 
```

显然，程序将每个结果都覆盖到一行中。所以我尝试使用nditer的索引功能，但仍然没有骰子。

`flags=['reduce_ok','c_iter']`--> `it.operands[1][it.index][...]=info`=
`IndexError: index out of bounds`

`flags=['reduce_ok','c_iter']`--> `it.operands[1][it.iterindex][...]=info`=
`IndexError: index out of bounds`

`flags=['reduce_ok','multi_iter']`--> `it.operands[1][it.multi_index][...]=info`=
`IndexError: index out of bounds`

`it[0][it.multi_index[1]][...]=info`=
`IndexError: 0-d arrays can't be indexed`

...等等。我错过了什么？提前致谢。

## 奖金问题

我刚刚[在 nditer 上看到了这篇不错的文章](https://stackoverflow.com/questions/10112745/python-is-the-iteration-of-the-multidimensional-array-super-slow)。我可能是 Numpy 的新手，但这是我第一次看到 Numpy 速度基准如此落后。我的理解是人们选择 Numpy 是因为它的数值速度和能力，但迭代是其中的一部分，不是吗？如果它这么慢，那么 nditer 有什么意义？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-07T03:22:59.143

通过打印一路上发生的事情真的有助于分解事情。

首先，让我们用这个替换你的整个循环：

```
i = 0
while not it.finished:
    i += 1
print i 
```

它将打印 20，而不是 5。那是因为您正在进行 5x4 迭代，而不是 5x1。

那么，为什么这甚至接近工作？好吧，让我们更仔细地看一下循环：

```
while not it.finished:
    print '>', it.operands[0], it[0]
    indices = np.arange(it[0],(it[0]+4), dtype=int)
    info = array.take(indices)
    info = info + 81
    it.operands[1][...]=info
    print '<', it.operands[1], it[1] 
```

您会看到前五个循环经过`[0 4 8 12 16]`五次，生成`[[81 82 83 84]]`，然后`[[85 86 87 88]]`等。然后接下来的五个循环做同样的事情，一次又一次。

这也是您的`c_index`解决方案不起作用的原因——因为`it.index`范围从 0 到 19，而`it.operands[1]`.

如果您正确执行了 multi_index 并忽略了列，则可以使这项工作……但是，您仍然会进行 5x4 迭代，只是将每个步骤重复 4 次，而不是进行您想要的 5x1 迭代。

`it.operands[1][...]=info`每次循环时，您都会用 5x1 行替换整个输出。一般来说，你不应该做任何事情`it.operands[1]`——重点`nditer`是你只需要照顾好每一个`it[1]`，最后`it.operands[1]`就是结果。

当然，对行进行 5x4 迭代是没有意义的。对单个值进行 5x4 迭代，或者对行进行 5x1 迭代。

如果你想要前者，最简单的方法是重塑输入数组，然后迭代：

```
it = np.nditer([array.reshape(5, -1), None],
               op_flags=[['readonly'],
                         ['readwrite','allocate']])
for a, b in it:
    b[...] = a + 81
return it.operands[1] 
```

但这当然很愚蠢——它只是一种更慢、更复杂的写作方式：

```
return array+81 
```

建议“编写自己的方法`reshape`是先调用`reshape`，然后……”会有点愚蠢。

所以，你想遍历行，对吧？

让我们通过摆脱`allocate`并显式创建一个 5x4 数组来简化一些事情：

```
outarray = np.zeros((5,4), dtype=array.dtype)
offset = np.array([0, 4, 8, 12, 16])
it = np.nditer([offset, outarray],
               flags=['reduce_ok'],
               op_flags=[['readonly'],
                         ['readwrite']],
               op_axes=[None, [0]],
               itershape=[5])

while not it.finished:
    indices = np.arange(it[0],(it[0]+4), dtype=int)
    info = array.take(indices)
    '''Just for fun, we'll perform an operation on data.\
       Let's shift it to 100'''
    info = info + 81
    it.operands[1][it.index][...]=info
    it.iternext()
return it.operands[1] 
```

这有点滥用 . `nditer`，但至少它做了正确的事情。

由于您只是对源代码进行 1D 迭代而基本上忽略了第二次迭代，因此确实没有充分的理由在`nditer`此处使用。如果您需要对多个数组进行锁步迭代，`for a, b in nditer([x, y], …)`这比迭代`x`并使用索引访问`y`更干净——就像`for a, b in zip(x, y)`在`numpy`. 而且，如果您需要遍历多维数组，`nditer`通常比替代方案更干净。但是在这里，您真正要做的只是迭代`[0, 4, 8, 16, 20]`，对结果做一些事情，然后将其复制到另一个`array`.

此外，正如我在评论中提到的，如果您发现自己在 中使用迭代`numpy`，那么您通常做错了什么。所有的速度优势`numpy`都来自于让它在原生 C/Fortran 或更低级别的向量操作中执行紧密循环。一旦你在`array`s 上循环，你实际上只是在用稍微好一点的语法做慢速 Python 数字：

```
import numpy as np
import timeit

def add10_numpy(array):
    return array + 10

def add10_nditer(array):
    it = np.nditer([array, None], [],
                   [['readonly'], ['writeonly', 'allocate']])
    for a, b in it:
        np.add(a, 10, b)
    return it.operands[1]

def add10_py(array):
    x, y = array.shape
    outarray = array.copy()
    for i in xrange(x):
        for j in xrange(y):
            outarray[i, j] = array[i, j] + 10
    return out array

myArray = np.arange(100000).reshape(250,-1)

for f in add10_numpy, add10_nditer, add10_py:
    print '%12s: %s' % (f.__name__, timeit.timeit(lambda: f(myArray), number=1)) 
```

在我的系统上，打印：

```
 add10_numpy: 0.000458002090454
add10_nditer: 0.292730093002
    add10_py: 0.127345085144 
```

`nditer`这向您显示了不必要地使用的成本。

# php - 如何在 PHP 和 Mysql 中修复 html 字符串数据

> ID：14188808
> 
> 赞同：-1
> 
> 时间：2013-01-07T01:44:41.117
> 
> 标签：php, mysql

我正在将 html 数据保存到 mysql 中

像下面

```
<p>&lt;div id=&quot;aaa&quot;&gt;asdadad&lt;/div&gt;</p>
<p>&lt;div id=&quot;aaa&quot;&gt;asdadad&lt;/div&gt;</p>
<div class="something">some data</div> 
```

当使用 php 在前端将 html 显示为字符串时，它将所有 3 行（以上）转换为 html 内容而不仅仅是字符串

但我希望得到以下结果

**前 2 行作为字符串，第 3 行作为 html**

我用了：

```
html_entity_decode($content_from_db, ENT_QUOTES, 'utf-8'); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T01:51:49.997

不要对数据做任何事情，直接打印到浏览器。如果数据按您所说的那样存储，那么您将获得预期的行为。如果您没有得到预期的行为，那么：

*   数据未正确存储，在 MySQL 控制台或 RDBMS 中查看
*   从数据库中提取数据后，您正在对数据进行后处理

# visual-studio - Boost.Python 尝试使用 Visual C++ 链接 python27.lib

> ID：14188809
> 
> 赞同：0
> 
> 时间：2013-01-07T01:44:47.343
> 
> 标签：visual-studio, visual-c++, boost, visual-studio-2012, boost-python

我正在尝试使用 Python 3.2 构建 boost python。我正在链接 python32.lib 和 libboost_python3-vc110-mt-gd-1_52.lib。我还定义了 BOOST_ALL_NO_LIB 来禁用 boost 的自动链接功能。

我仍然收到以下错误：

```
fatal error LNK1104: cannot open file 'python27.lib' 
```

如何告诉 boost 使用 Python 3.2？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T10:53:31.133

您的计算机上是否安装了多个 Python？

您可能必须创建一个`user-config.jam`内容如下的文件：

```
using python : 3.2 : C:\Path\To\Python\python.exe ; 
```

请参阅： http: [//www.boost.org/doc/libs/1_53_0/libs/python/doc/building.html#configuring-boost-build](http://www.boost.org/doc/libs/1_53_0/libs/python/doc/building.html#configuring-boost-build)

# java - 用于生成带有“限制编辑”字段的 MSWORD 的 Java 库

> ID：14188810
> 
> 赞同：0
> 
> 时间：2013-01-07T01:44:48.723
> 
> 标签：java, ms-word, reporting

是否有任何 Java 库允许生成带有“限制编辑”字段的 Microsoft Word？这意味着我想禁止用户使用密码编辑某些字段，同时允许他们编辑其他字段。

我有谷歌，但是，像 apache-poi 这样的建议似乎不支持“限制编辑”功能。

我想知道是否可以用 Java 来做，或者我必须得到一个窗口服务器。

* * *

最后我没有得到一个青睐库，所以我决定自己在MS Word的setting.xml中添加保护标签，下面是参考链接 [http://itintheory.blogspot.hk/2012/06/remove-editing-限制-in-word.html](http://itintheory.blogspot.hk/2012/06/remove-editing-restrictions-in-word.html)

# jms - 如何实现 JMS 消息自动克隆？

> ID：14188813
> 
> 赞同：0
> 
> 时间：2013-01-07T01:45:12.860
> 
> 标签：jms

有什么方法可以让 WLS 从队列中自动克隆 JMS 消息并将其发送到另一个队列？

目前，我想为 JMS 消息实现自动备份功能。这意味着一旦 Queue-A 收到一条新的 jms 消息，它可以复制该消息并将其发送到另一个 JMS 队列 Queue-B，以备份来自 Queue-A 的原始消息。

我认为这个功能可以通过 WLS 配置来实现。但我需要一些指南来告诉我如何去做。

# devise - 在 Active Admin 中获取未定义的方法“user_id”

> ID：14188814
> 
> 赞同：1
> 
> 时间：2013-01-07T01:45:19.223
> 
> 标签：devise, ruby-on-rails-3.2, activeadmin

嘿，我在与我的用户模型相关的活动管理设置方面有点挣扎。我正在使用设计。

当我单击活动管理员中的用户选项卡时，我得到：

```
NoMethodError in Admin/users#index

Showing /Users/bweidlich/.rvm/gems/ruby-1.9.3-p286/gems/activeadmin-   0.5.1/app/views/active_admin/resource/index.html.arb where line #1 raised:

undefined method `user_id_contains' for #<MetaSearch::Searches::User:0x007fc0a9831cf8>
Extracted source (around line #1):

1: insert_tag renderer_for(:index) 
```

当我想编辑一个特定用户时，我得到：

```
NoMethodError in Admin/users#edit

Showing /Users/bweidlich/.rvm/gems/ruby-1.9.3-p286/gems/activeadmin-0.5.1/app/views/active_admin/resource/edit.html.arb where line #1 raised:

undefined method `user_id' for #<User:0x007fc0a47d3e28>
Extracted source (around line #1):

1: insert_tag renderer_for(:edit) 
```

有谁知道我应该在哪里寻找错误？

一如既往，任何帮助将不胜感激！

多谢你们

编辑：

应用用户模型

```
class User < ActiveRecord::Base
  rolify
  devise :database_authenticatable, :registerable,
     :recoverable, :rememberable, :trackable, :validatable,
     :confirmable

  attr_accessible :role_ids, :as => :admin
  attr_accessible :username, :first_name, :last_name, :email, :password, :password_confirmation, :remember_me, :avatar, :bio, :title, :company,:facebook,:twitter,:pinterest,:linkedin
  validates_presence_of :username
  validates_uniqueness_of :username, :email, :case_sensitive => false
  has_many :events
  has_many :relationships, foreign_key: "follower_id", dependent: :destroy
  has_many :reverse_relationships, foreign_key: "followed_id",
                               class_name:  "Relationship",
                               dependent:   :destroy
  has_many :followers, through: :reverse_relationships, source: :follower                              
  has_many :followed_users, through: :relationships, source: :followed
  has_many :comments

  has_one :avatar

  def update_without_password(params={})
    params.delete(:current_password)
    super(params)
  end

  def following?(other_user)
    relationships.find_by_followed_id(other_user.id)
  end

  def follow!(other_user)
    relationships.create!(followed_id: other_user.id)
  end

  def unfollow!(other_user)
    relationships.find_by_followed_id(other_user.id).destroy
  end
end 
```

活跃的管理员用户模型：

```
ActiveAdmin.register User do
  form do |f|
    f.inputs "User Details" do
      f.input :email
      f.input :password
      f.input :password_confirmation
      f.input :superadmin, :label => "Super Administrator"
    end
    f.buttons
  end

  create_or_edit = Proc.new {
    @user            = User.find_or_create_by_id(params[:id])
    @user.superadmin = params[:user][:superadmin]
    @user.attributes = params[:user].delete_if do |k, v| 
      (k == "superadmin") ||
      (["password", "password_confirmation"].include?(k) && v.empty? && !@user.new_record?)
    end
    if @user.save
      redirect_to :action => :show, :id => @user.id
    else
      render active_admin_template((@user.new_record? ? 'new' : 'edit') + '.html.erb')
    end
  }
  member_action :create, :method => :post, &create_or_edit
  member_action :update, :method => :put, &create_or_edit
end 
```

用户表架构

```
# == Schema Information
#
# Table name: users
#
#  id                     :integer          not null, primary key
#  email                  :string(255)
#  encrypted_password     :string(255)
#  reset_password_token   :string(255)
#  reset_password_sent_at :datetime
#  remember_created_at    :datetime
#  sign_in_count          :integer
#  current_sign_in_at     :datetime
#  last_sign_in_at        :datetime
#  current_sign_in_ip     :string(255)
#  last_sign_in_ip        :string(255)
#  created_at             :datetime
#  updated_at             :datetime
#  username               :string(255)
#  bio                    :text
#  title                  :string(255)
#  company                :string(255)
#  facebook               :text
#  twitter                :text
#  pinterest              :text
#  linkedin               :text
#  confirmation_token     :string(255)
#  confirmed_at           :datetime
#  confirmation_sent_at   :datetime
#  unconfirmed_email      :string(255)
#  first_name             :string(255)
#  last_name              :string(255)
#  avatar                 :string(255)
#  avatar_id              :integer
# 
```

# android - 自定义微调器 TextView 被切断

> ID：14188815
> 
> 赞同：3
> 
> 时间：2013-01-07T01:45:40.243
> 
> 标签：android, textview, spinner, android-spinner

因此，在随附的屏幕截图和代码示例中，您可以看到我的自定义微调器。如您所见，无论我尝试做什么，我的文字都会被截断。九个补丁图像也正确设置了文本填充。我几乎所有事情都是正确的，我完全不知所措......

自定义微调器

```
<CheckedTextView xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/spinner"
android:textColor="#555"
android:textSize="22sp"
android:textStyle="bold"
android:typeface="normal"
android:layout_width="wrap_content"
android:layout_height="40sp"
android:gravity="center_vertical|left"
android:singleLine="true" /> 
```

实现自定义微调器

```
<Spinner
    android:id="@+id/spinner_both20"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_alignBottom="@+id/b_both20"
    android:layout_alignTop="@+id/b_both20"
    android:layout_marginLeft="4sp"
    android:layout_marginRight="5sp"
    android:layout_toRightOf="@+id/b_both20"
    android:background="@drawable/buttons"
    android:padding="20sp" /> 
```

爪哇

```
ArrayAdapter<CharSequence> aBoth = ArrayAdapter
            .createFromResource(getActivity().getApplicationContext(),
            R.array.d20both, R.layout.spinner_settings) 
```

在如此简单的事情上花费这么多小时，我感到非常沮丧。任何帮助都会摇滚！

![在此处输入图像描述](../Images/48d134b4c04d203543c65caf9ab5a3bd.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-07T13:51:59.680

填充将切入您的内部文本。

# three.js - 如何停止轨迹球控制器？[三.js]

> ID：14188819
> 
> 赞同：2
> 
> 时间：2013-01-07T01:46:21.110
> 
> 标签：three.js, webgl

有没有办法在three.js中打开和关闭轨迹球控制器？

我有这个作为我的事件处理程序

```
function onDocumentMouseMove(event){

    if (CAN_MOVE == 1){
        // update the mouse variable
        mouse.x = ( event.clientX / window.innerWidth ) * 2 - 1;
        mouse.y = - ( event.clientY / window.innerHeight ) * 2 + 1;
    }
    else
    {
        //do nothing
        event.preventDefault();
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T15:48:05.123

是的。

```
controls.enabled = false; 
```

# cocoa-touch - 是否可以更改下载的 .html 文件并将编辑的内容显示到 UIWebView？

> ID：14188820
> 
> 赞同：0
> 
> 时间：2013-01-07T01:46:26.277
> 
> 标签：cocoa-touch, cocoa

我正在开发一个从 ftp 服务器下载 .html 文件的 iPhone 应用程序。是否可以在 UIWebView 中渲染之前编辑 html 文件？html 文件包含不相关的数据，因此我想删除部分内容。如果是这样，我将如何实现这一目标？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T15:34:10.420

在几个步骤中：

1.  自己执行 FTP 请求，使用`NSURLConnection`.
2.  将 HTML 转换为字符串，然后对其进行修改。
3.  调用[`-loadHTMLString:baseURL:`](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIWebView_Class/Reference/Reference.html#//apple_ref/occ/instm/UIWebView/loadHTMLString%3abaseURL%3a)以将修改后的文档传递给`UIWebView`.

# objective-c - 当我删除我的@synthesize 语句时，编译器错误“使用未声明的标识符”

> ID：14188823
> 
> 赞同：3
> 
> 时间：2013-01-07T01:46:43.420
> 
> 标签：objective-c, compiler-errors, clang, synthesize, declared-property

在最新的 LLVM 版本中，已删除对综合属性的要求。

因此，我能够删除我`@synthesize`的所有陈述，除了`NSFetchedResultsController`. 有谁知道为什么当我删除该`@synthesize fetchedResultsController;`行时编译器会警告我？

错误：

> 使用未声明的标识符“fetchedResultsController”，您的意思是 _fetchedResultsController 吗？

这是我的代码：

```
@property (nonatomic, strong) NSFetchedResultsController *fetchedResultsController;

@synthesize fetchedResultsController;

- (NSFetchedResultsController *)fetchedResultsController {
    if (fetchedResultsController) {
        return fetchedResultsController;
    }

    if (!self.managedObjectContext) {
        self.managedObjectContext = [(MyAppDelegate *)[[UIApplication sharedApplication] delegate] managedObjectContext];
    }

    NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
    NSEntityDescription *entity = [NSEntityDescription entityForName:@"Session" inManagedObjectContext:self.managedObjectContext];
    [fetchRequest setEntity:entity];

    [fetchRequest setPredicate: self.predicate];

    [fetchRequest setFetchBatchSize:20];

    NSSortDescriptor *sortDescriptor = [[NSSortDescriptor alloc] initWithKey:@"timeStamp" ascending:NO];
    NSArray *sortDescriptors = [[NSArray alloc] initWithObjects:sortDescriptor, nil];

    [fetchRequest setSortDescriptors:sortDescriptors];

    fetchedResultsController= [[NSFetchedResultsController alloc] initWithFetchRequest:fetchRequest managedObjectContext:self.managedObjectContext sectionNameKeyPath:nil cacheName:nil];
    fetchedResultsController.delegate = self;

    NSError *error = nil;
    if (![fetchedResultsController performFetch:&error]) {
        NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
        abort();
    }

    return fetchedResultsController;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T01:52:25.560

如果您没有`@synthesize`在代码中添加 ，则为支持该属性而创建的实例变量名为`_propertyName`。您指的是`fetchedResultsController`删除后不再存在的实例变量`@synthesize`。相反，将所有引用更改`fetchedResultsController`为`_fetchedResultsController`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T01:52:57.893

因为默认的合成变量`_fetchedResultsController`不是`fetchedResultsController`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-07T01:53:12.533

该属性`fetchedResultsController`会自动合成为`_fetchedResultsController`，并且对于每个合成变量都会发生这种情况。

您应该显式合成它以更改其名称。

# asp.net-mvc-4 - 从 ASP.NET MVC Web API 返回 400 而不是 404

> ID：14188827
> 
> 赞同：7
> 
> 时间：2013-01-07T01:47:08.120
> 
> 标签：asp.net-mvc-4, asp.net-web-api

我使用 VS2012 创建了 ASP.NET MVC Web API 项目的 hello world：

```
public class ValuesController : ApiController
{
    // GET api/values
    public IEnumerable<string> Get()
    {
        return new string[] { "value1", "value2" };
    }

    // GET api/values/5
    public string Get(int id)
    {
        return "value";
    }
} 
```

向该控制器发出 get 请求会返回状态为 200 的一些 XML 数据。到目前为止一切正常。

当我删除该方法时，如下所示：

```
public class ValuesController : ApiController
{
    // GET api/values
    //public IEnumerable<string> Get()
    //{
    //    return new string[] { "value1", "value2" };
    //}

    // GET api/values/5
    public string Get(int id)
    {
        return "value";
    }
} 
```

然后我得到一个 404 未找到。我想要的是 400 错误请求，因为必须提供 ID。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-07T04:27:51.017

您不必`Get()`为了抛出错误而保留该方法。将 Get by ID 方法的签名更改为：

```
public string Get(int? id = null)
{
    if (id == null) throw new HttpResponseException(HttpStatusCode.BadRequest);
    return "value";
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-07T01:47:08.120

一种方法是包含该方法，但会引发异常：

```
public class ValuesController : ApiController
{
    // GET api/values
    public void Get()
    {
        throw new HttpResponseException(HttpStatusCode.BadRequest);
    }

    // GET api/values/5
    public string Get(int id)
    {
        return "value";
    }
} 
```

# express - “ensureAuthentication”“isAuthenticated”护照功能的文档？

> ID：14188834
> 
> 赞同：44
> 
> 时间：2013-01-07T01:48:25.060
> 
> 标签：express, passport.js

我一直在寻找一段时间，但找不到确定的文档来源。当我搜索这些时，第一个谷歌结果是 StackOverflow。

还有类似的中间件功能吗？

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2013-01-13T07:53:27.237

虽然没有在任何容易找到的地方明确记录，但您可以在[https://github.com/jaredhanson/passport/blob/a892b9dc54dce34b7170ad5d73d8ccfba87f4fcf/lib/passport/http/request.js#L74](https://github.com/jaredhanson/passport/blob/a892b9dc54dce34b7170ad5d73d8ccfba87f4fcf/lib/passport/http/request.js#L74)`isAuthenticated`的 Passport 代码中查看和`isUnauthenticated`标志的设置位置.

`ensureAuthenticated`不是官方的，但可以通过以下方式实现：

```
function ensureAuthenticated(req, res, next) {
  if (req.isAuthenticated())
    return next();
  else
    // Return error content: res.jsonp(...) or redirect: res.redirect('/login')
}

app.get('/account', ensureAuthenticated, function(req, res) {
  // Do something with user via req.user
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-05-14T12:38:50.510

它返回 false 的原因主要是因为它在路由定义下方声明。我在其他文件中这样做，所以我像这样使用它

```
//auth check
function auth(req,res,next){
    if(req.isAuthenticated()){
        next();
    } 
    else{
        res.redirect("/fail");}
}

//routes
require("./routes/myroute")(app,auth); 
```

# c - 滚动菜单（c代码）

> ID：14188835
> 
> 赞同：3
> 
> 时间：2013-01-07T01:48:28.910
> 
> 标签：c

我想创建一个最多 10 行窗口的菜单，并在此窗口中显示 xml 文件中的所有项目（包含超过 10 个项目），方法是在窗口中向上/向下滚动行以查看文件的所有内容。

问题：如何在我的 API 中实现这一点（例如在 ncurses 滚动菜单中）：

“如果给一个窗口的子窗口不足以显示所有项目，那么菜单将是可滚动的。当你在当前列表的最后一个项目上时，如果你发送 REQ_DOWN_ITEM，它会被翻译成 REQ_SCR_DLINE 并且菜单滚动一项。你可以手动给 REQ_SCR_ 操作来做滚动。让我们看看它是怎么做的。

我的部分代码用于此功能：

```
static void menu( commands_t *cmd )
{
    /* this display only first 10 line */
    int i; 
    char string[ 128 ];
    for( i = 0; i < 10; i++ ) {
        snprintf( string, sizeof (string), "%s", list_get_name( cmd->listmgr, i ) );
        menu_list_set_text( cmd->menu, i, string );
    }
} 
```

目前，此功能只能显示列表中的前 10 个项目。

```
 A
                       B
                       C  
                       D
                       E
                -----------------
Line 01         |      F        |   
Line 02         |      G        |
Line 03         |      H        |
Line 04         |      I        |
Line 05         |      J        |    
Line 06         |      K        |   
Line 07         |      L        |
Line 08         |      M        |
Line 09         |      N        |
Line 10         |      O        |   
                -----------------
                       P
                       Q
                       R
                       S
                       T
                    .......
                       Z 
```

为此，我尝试创建能够在列表中的菜单行中设置文本的 API，在菜单中向上/向下移动光标，但我现在不知道如何向上或向下移动行。

```
typedef struct list_info_s list_info_t;
struct list_info_s
{
    int position;
    char name[ 50 ];

    list_info_t *next;
    list_info_t *prev;
};

const list_info_t *list_get_list( list_mgr_t *mgr, int pos)
{
    const list_info_t *tmp = mgr->first;
    int i;
    for (i = 0; tmp && i < pos; i++)
        tmp = tmp->next;
    return tmp;
}

const char *list_get_name( list_mgr_t *mgr, int position )
{
    const list_info_t *list = list_get_list(mgr, position);
    if( (list) && (*list->name) ) {
        return list->name;
    } else {
        return 0;
    }
}

TO MOVE UP/DOWN:

void commands_handle( commands_t *cmd, int prog_cmd )
{
    switch( prog_cmd ) {
    case MENU_UP:
        cmd->menu_position = (cmd->menu_position + cmd->menu_size - 1) % (cmd->menu_size);
        menu( cmd );
        break;
    case MENU_DOWN:
        cmd->menu_position = (cmd->menu_position + 1) % (cmd->menu_size);
        menu( cmd );
        break;
    return;
    }
} 

MENU:

static void menu( commands_t *cmd )
{
    /* this display only first 10 line */
    int i; 
    char string[ 128 ];
    for( i = 0; i < 10; i++ ) {
        snprintf( string, sizeof (string), "%s", list_get_name( cmd->listmgr, i ) );
        menu_list_set_text( cmd->menu, i, string );
    }
} 
```

菜单窗口最多可容纳 10 个项目行，因为 xml 可能包含大量项目。哪些编程选项必须通过按向上/向下按钮显示文件中的所有行才能在菜单上可见？

这是菜单的实际 API：

```
#define MENU_MAX 10

struct menu_s
{
    char *name;
    char text[ MENU_MAX ][ 128 ];
    char arguments[ MENU_MAX ][ 128 ];
    int commands[ MENU_MAX ];
    char back_argument[ 128 ];
    int back_command;
    int numlines;
    int cursor;
    int defaultcursor;
};

menu_t *menu_new( const char *name )
{
    menu_t *menu = malloc( sizeof( menu_t ) );
    if( !menu ) {
    return 0;
    }

    menu->numlines = 0;
    menu->cursor = 0;
    menu->defaultcursor = 0;
    menu->name = strdup( name );
    if( !menu->name ) {
        free( menu );
        return 0;
    }

    return menu;
}

void menu_delete( menu_t *menu )
{
    free( menu->name );
    free( menu );
}

void menu_reset_num_lines( menu_t *menu )
{
    menu->numlines = 0;
}

void menu_set_text( menu_t *menu, int line, const char *text )
{
    snprintf( menu->text[ line ], sizeof( menu->text[ 0 ] ), "%s", text );
    if( line >= menu->numlines ) menu->numlines = line + 1;
}

void menu_set_enter_command( menu_t *menu, int line, int command,
                         const char *argument )
{
    menu->commands[ line ] = command;
    snprintf( menu->argum#define MENU_MAX 10

struct menu_s
{
    char *name;
    char text[ MENU_MAX ][ 128 ];
    char arguments[ MENU_MAX ][ 128 ];
    int commands[ MENU_MAX ];
    char back_argument[ 128 ];
    int back_command;
    int numlines;
    int cursor;
    int defaultcursor;
};

menu_t *menu_new( const char *name )
{
    menu_t *menu = malloc( sizeof( menu_t ) );
    if( !menu ) {
    return 0;
    }

    menu->numlines = 0;
    menu->cursor = 0;
    menu->defaultcursor = 0;
    menu->name = strdup( name );
    if( !menu->name ) {
        free( menu );
        return 0;
    }

    return menu;
}

void menu_delete( menu_t *menu )
{
    free( menu->name );
    free( menu );
}

void menu_reset_num_lines( menu_t *menu )
{
    menu->numlines = 0;
}

void menu_set_text( menu_t *menu, int line, const char *text )
{
    snprintf( menu->text[ line ], sizeof( menu->text[ 0 ] ), "%s", text );
    if( line >= menu->numlines ) menu->numlines = line + 1;
}

void menu_set_enter_command( menu_t *menu, int line, int command,
                         const char *argument )
{
    menu->commands[ line ] = command;
    snprintf( menu->arguments[ line ], sizeof( menu->arguments[ 0 ] ),
          "%s", argument );
}

void menu_set_back_command( menu_t *menu, int command,
                        const char *argument )
{
    menu->back_command = command;
    snprintf( menu->back_argument, sizeof( menu->back_argument ),
          "%s", argument );
}

void menu_set_cursor( menu_t *menu, int cursor )
{
    menu->cursor = cursor;
}

const char *menu_get_name( menu_t *menu )
{
    return menu->name;
}

int menu_get_num_lines( menu_t *menu )
{
    return menu->numlines;
}

const char *menu_get_text( menu_t *menu, int line )
{
    return menu->text[ line ];
}

int menu_get_enter_command( menu_t *menu, int line )
{
    return menu->commands[ line ];
}

const char *menu_get_enter_argument( menu_t *menu, int line )
{
    return menu->arguments[ line ];
}

int menu_get_back_command( menu_t *menu )
{
    return menu->back_command;
}

const char *menu_get_back_argument( menu_t *menu )
{
    return menu->back_argument;
}

int menu_get_cursor( menu_t *menu )
{
    return menu->cursor;
}

int menu_get_default_cursor( menu_t *menu )
{
    return menu->defaultcursor;
} 
```

我尝试了一个丑陋的解决方案：

```
static void menu( commands_t *cmd )
{
    int i;
    for( i = 0; i < 10; i++ ) {
        char string[ 128 ];
        snprintf( string, sizeof (string), "%s", list_get_name( cmd->listmgr, i )
        menu_list_set_text( cmd->menu, i, string );
        int scroll;
        for( scroll = 0; scroll < list_size; scroll++ ) {
            if( cmd->curmenupos == 10 + scroll ) {
                snprintf( string, sizeof (string), "%s", list_get_name( cmd->listmgr, i + scroll + 1 )
                menu_list_set_text( cmd->menu, i, string );
            }
         }
      }
   } 
```

其中“cmd->curmenupos”是获取菜单行位置的命令，“list_size”是 xml 中的项目数

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T12:13:02.463

您可以通过使用基于数组的[环形缓冲区](http://en.wikipedia.org/wiki/Circular_buffer)实现来稍微简化您的解决方案，然后仅从左上角的头/尾打印菜单。然后滚动简单地变成推进头部/尾部并用新的覆盖消失的行。使用基于数组的实现应该没问题，因为无论如何您的行号都是恒定的。

根据 IO 的速度，您的软件可能会使用更少的 IO 资源，从而通过对旧行进行一些简单的缓存来提高性能。[请记住不要过早优化](http://en.wikipedia.org/wiki/Program_optimization#When_to_optimize)这可以通过让环形缓冲区的条目多于屏幕上的行数来完成，然后仅在滚动超过某个点时覆盖。

# java - 在运行的 JVM 的一个非常受限的部分中执行 Java 字节码

> ID：14188839
> 
> 赞同：1
> 
> 时间：2013-01-07T01:49:24.400
> 
> 标签：java, jvm, bytecode

有没有办法将一些 java 字节码运行到正在运行的 JVM 的一个特别受限的部分？我正在考虑访问非常小的内存（可能只有几十千字节）并且无法访问外部世界（除了那个内存）。

目标是在这个安全的环境中执行一些用户提供的字节码，以使主机永远不会崩溃或泄漏来自恶意字节码执行的信息。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T02:05:22.123

您可以在安全沙箱中运行不受信任的字节码，并设置沙箱，以便无法与外界通信。当您运行不受信任的小程序时，这是浏览器驻留的 JVM 所做的……除了您需要更严格的沙箱限制。（小程序沙箱不会阻止所有网络连接。）

参考：[如何创建 Java 沙箱？](https://stackoverflow.com/questions/1715036/how-do-i-create-a-java-sandbox)

但是，不可能完全控制流氓代码的作用。例如，如果它决定进入一个无限循环或分配一个巨大的数据结构，你的 JVM 的受信任部分没有防弹的方法来阻止它。如果 JVM、类库或沙箱中存在安全漏洞，那么流氓代码就有可能利用它。

* * *

请注意，这些都不涉及将代码限制在 RAM 的特定区域。你不能在 Java 中做到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T03:23:09.733

您可以使用[JavaPathfinder (JPF)](http://babelfish.arc.nasa.gov/trac/jpf)进行此类练习。`JPF`是一个模型检查工具，它获取源代码/字节码并在自己的虚拟机中执行它，您可以定义各种属性（无死锁、无限循环等）进行检查。

`JPF`作为一个独立的工具运行，因此很难将它集成到您​​的应用程序中，但也许您可以在外部调用它，然后只查询结果。

# ruby - Firefox 浏览器的 Watir 脚本超时问题

> ID：14188847
> 
> 赞同：2
> 
> 时间：2013-01-07T01:51:15.380
> 
> 标签：ruby, watir, watir-webdriver

我是 Watir 的新手，我在使用基于 AJAX 的 webapp 时遇到了这种奇怪的情况。应用程序可能会在页面上呈现通知窗口。这个通知是一个基于 JS 的模态窗口。如果我单击或将鼠标悬停在通知上它就会消失。所以在我的脚本中的某个地方我有：

```
@browser = Watir::Browser.new :firefox
...
notf = notification
notf.click if notf 
```

获取通知的方法是这样的：

```
def notification
  if browser.div(:class => "popupContent").present?
    Notification.new(browser.div(:class => "popupContent"))
  end
end 
```

脚本在 IE 和 Chrome 上运行良好，但在 Firefox 上，if 语句在 60 秒后出现“超时：错误”。当我以这种方式更改代码时：

```
def notification
  begin
    browser.div(:class => "popupContent").wait_until_present(1)
    Notification.new(browser.div(:class => "popupContent"))
  rescue Exception 
    puts "timeout..."
  end
end 
```

Chrome 和 IE 工作正常 - 只是在通知不存在的情况下增加 1 秒延迟。但如果通知不存在，Firefox 仍然有 60 秒超时？！？我做错了什么 - 我需要设置/检查一些 Firefox 设置吗？我有这样的配置： - 带有 Firefox 17.0.1 的 Win7 操作系统 - Ruby 1.9.3p125 - watir-webdriver (0.6.1) - selenium-webdriver (2.26.0)

感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T12:43:47.120

正如评论中提到的，解决方案是升级到最新版本的 selenium-webdriver (2.27.2)。

# paypal - Paypal Mass Pay API 响应处理

> ID：14188848
> 
> 赞同：1
> 
> 时间：2013-01-07T01:51:29.130
> 
> 标签：paypal, masspay

所以这可能更像是一个讨论项目，所以如果这应该转到其他地方，我深表歉意。

但我需要使用 Paypal MassPay API 处理响应 (IPN)。

目前我正在正确处理通知并跟踪过去的付款（版税支付系统）。

**问题 1：无人认领的付款**

但是我遇到了一个我似乎无法在沙盒网站上处理的问题，那就是无人认领的付款。现在根据 MassPay 指南：

> 如果收款人没有 PayPal 帐户，PayPal 会通知他们可以付款，并且他们必须创建一个 PayPal 帐户才能接收付款。

我认为这意味着 Paypal 向用户发送了一封电子邮件，我尝试对此进行测试，但没有收到任何通知

**问题 2：索赔无人认领的付款**

在上一个问题之后，我无法测试声称无人认领值的用户。所以我想知道有人知道Paypal如何处理这些以及响应的格式吗？

1.  响应是否包含所有先前要求的付款？
2.  响应是否包含所有无人认领的付款？
3.  响应是否包含该事务中所有传输的状态？

先感谢您

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T05:13:24.057

当您发送您的 MassPay 请求时，任何无人认领的付款都将处于待处理状态，直到它们被认领。您的 IPN 将显示“已处理”而不是“已完成”的状态。一旦他们要求付款，您将获得另一个显示付款已完成的 IPN。

在沙箱中工作时，您不会从他们的系统中收到任何实际的电子邮件。所有测试电子邮件都会显示在您的 developer.paypal.com 帐户中的测试电子邮件部分下。

# compilation - 包含与脚本不在同一目录中的文件

> ID：14188852
> 
> 赞同：0
> 
> 时间：2013-01-07T01:51:43.983
> 
> 标签：compilation, include, nsis

我有一个 NSIS 脚本，它试图包含一个位于不同文件夹中的 .NSI 文件。

**我的问题：**当我去编译我的脚本时，我得到了编译错误`!include: could not find: "../Utilities.nsi"`。该文件存在并且位于我指定的正确位置（在父目录中 - 后退一步）。

如何包含位于另一个目录中的文件？我希望它可能。

```
!include "../Utilities.nsi" # include error: '!include: could not find: "../Utilities.nsi"'

InstallDir  "abc"
Name        "def"        
OutFile     "def.exe"

Section
    DetailPrint "Hello World"
SectionEnd 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T16:16:20.373

该[手册](http://nsis.sourceforge.net/Docs/Chapter5.html#5.1.1)是这样说的`!include`：

> 该命令将包含“文件”，就好像它是原始脚本的一部分一样。请注意，如果文件包含在另一个目录中，则当前目录仍然是编译脚本的位置（而不是包含文件所在的位置）。如果编译器找不到该文件，它将在每个包含目录中查找它。有关详细信息，请参阅 !addincludedir。如果使用 /nonfatal 开关但没有找到文件，则会发出警告而不是错误。”

此外，手册中的示例不使用引号 - 您是否尝试删除它们？此外，“/”=>“\”。

# macos - 如何显示 NSTimer 下一次触发前的秒数

> ID：14188853
> 
> 赞同：1
> 
> 时间：2013-01-07T01:51:46.027
> 
> 标签：macos, cocoa, nstimer

我有一个简单的 OSX 菜单栏应用程序，状态项附有一个菜单，我有一个可以手动发送`fire`到 NSTimer 的菜单项。

我希望该菜单项显示下一次触发计时器之前的秒数。有没有办法获得下一次火灾的时间或 NSTimer 下一次被解雇的时间？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T01:56:29.533

NSTimer 具有返回 NSDate 的 fireDate。NSDate 有 timeIntervalSinceNow。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T09:39:53.323

我知道已经有一个公认的答案，但我突然想到，您实际上可能对 , 根本不感兴趣`fireDate`：

使用该日期，您只会看到相同的秒数，只要显示时间 - 如果它直接显示在菜单栏中，则没有进度指示......</p>

因此，我建议采用稍微不同的方法：

1.  计算并存储到期日期。
2.  安排一个重复计时器，该计时器以与您显示的精度匹配的间隔触发，并使用存储的到期日期更新剩余时间显示。
3.  一旦过了有效期，就让计时器失效，然后做任何你想做的事情。

### 那么，为什么不使用一秒定时器和递减计数器变量呢？

简单：`NSTimer`不是实时的东西。计时器触发的实际日期，其计划`fireDate`将略有不同。但是由于重复计时器会重新安排时间而不调整该差异，因此这些偏差会加起来。

这些偏差是完全不可预测的，因为它们不仅取决于应用程序的负载，还取决于整个系统。所以它们会在“完全可以忽略不计”和“ZOMFG”之间变化！

# shell - 如何使用“拆分”命令

> ID：14188855
> 
> 赞同：2
> 
> 时间：2013-01-07T01:52:23.880
> 
> 标签：shell, split

我有一个包含 2000 行的文件。我使用以下内容每 100 行拆分文件。

```
split -l 100 file.txt outputfile.txt 
```

我想在每个文件内容的末尾添加一个“FFFFFF”，在拆分之后我还想指定文件使用的扩展名，就像上面的命令一样，输出如下。

```
outputfile.txtxa, outputfile.txtxb etc... 
```

我已经阅读了拆分的手册页并浏览了网页，但是我找不到解决方案。

任何建议表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T02:21:53.080

For a one pass solution, you could use `awk` like this:

```
awk 'NR%100==1 { ++i } { print $0 (NR%100==0 ? "\nFFFFFF" : "") > "outputfile" i ".txt" }' file.txt 
```

Also, the advantage here is finer control over the output filenames to make them more pretty. Please let me know if you require something more fancy. Cheers.

* * *

Explanation for [user1937](https://stackoverflow.com/users/1890488/user1937):

If you are familiar with the [modulo operator](http://en.wikipedia.org/wiki/Modulo_operation), `NR%100==1` will return true for the 1st line, the 101st line, the 201st line, the 301st line etc. Each time it's true, the variable `i` is incremented. Notice how an `awk` statement is made up of condition/action blocks. So `NR%100==1` is the condition and `++i` is the action. What you'll then notice (hopefully) is that the block that has the print action lacks a conditional. Therefore every line of input is being printed (all of the time). The value of `i` simply determines which file the output is being printed to.

Another bit you may not be familiar with is: `(NR%100==0 ? "\nFFFFFF" : "")`. This is a [ternary operator](http://en.wikipedia.org/wiki/Ternary_operation) which is shorthand for: `if (NR%100==0) print "\nFFFFFF"; else print "")`. HTH.

* * *

`awk` code can be built using pattern/action statements in the form:

```
NR%100==1                             # pattern1
{
    ++i                               # action1
}

{
    print $0 ...                      # action2
} 
```

As you can see, pattern1 only applies to action1\. pattern1 does *not* apply to action2.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T02:10:31.763

你不能单独使用 split 来做到这一点。此代码可能会有所帮助：

```
split -l 100 file.txt outputfile_
find . -name outputfile_\* -exec sh -c 'echo "FFFFFF" >> {} && mv {} {}.txt' \; 
```

这将导致文件`outputfile_aa.txt`等`outputfileab.txt`，它们都将以`FFFFFF`.

其工作原理如下：首先我们使用前缀拆分文件`outputfile_`以生成文件`outputfile_aa`等`outputfile_ab`。然后我们调用`find`命令将它们全部收集起来并使用它执行命令。有一个小问题是你不能在 find 命令中使用重定向，所以我们将把重定向包装到一个 shell 脚本中并使用`sh`. 将`{}`被每个单独的文件名替换（`-exec`在`find`的手册页中查找）；因此，脚本将首先将`FFFFFF`字符串附加到文件的末尾，然后重命名文件以添加`txt`扩展名。

# asp.net - 验证 AJAX 工具包组合框正则表达式验证器

> ID：14188860
> 
> 赞同：-1
> 
> 时间：2013-01-07T01:53:02.190
> 
> 标签：asp.net, vb.net

我想知道是否可以`ajax toolkit combobox`使用正则表达式验证器来验证。我允许用户输入值，但只希望`regex [0-9]{0,1}[0-9]{1}|-7|-8|-9`允许某些值 ( )。我可以使用自定义验证器，但我还需要创建 javascript 函数来在客户端进行验证。如果有更好的方法，我很想听听。谢谢。这是组合框代码：

```
 <asp:ComboBox CssClass="required" DropDownStyle="Simple"  
     ID="DaysDeployed" Width="50" runat="server">
        <asp:ListItem Selected="True" Text="" Value="" />
        <asp:ListItem Text="Refused" Value="-7" />
        <asp:ListItem Text="Don't Know" Value="-8" />
        <asp:ListItem Text="Missing Data" Value="-9" />
    </asp:ComboBox> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T04:45:28.747

摘要：不要使用通常会触发回发的 asp.net 按钮，而是使用 html 制作一个。让 html 按钮运行一个 javascript 函数，该函数首先检查正则表达式验证，然后（如果有效）运行回发函数。

**首先**，我将删除用于触发服务器端代码的 asp.net 按钮，并将其替换为客户端按钮。如果您需要帮助创建此按钮，您可以按照我的另一个答案中的步骤操作。链接在这里：

[https://stackoverflow.com/questions/14062993/input-type-image-onclick-will-trigger-its-event-but-not-act-well-on-funct/14063911#14063911-堆栈溢出](https://stackoverflow.com/questions/14062993/input-type-image-onclick-will-trigger-its-event-but-not-act-well-on-funct/14063911#14063911)

**其次**，javascript 函数应首先使用正则表达式函数验证数据。使用这样的东西：

```
function validateCombobox(myComboboxValue) { 
    if(myComboboxValue.match(regularExpressionString)===null){
      return false
    } else {
      return true
    };
}; 
```

***注意：Regex 对我来说是一个薄弱环节，所以你可能需要稍微修改一下这个脚本。

**第三**，如果使用上面的脚本验证输入，则使用 javascript 调用回发。为此，请按照下列步骤操作：

1.  在asp页面上创建一个。这是必要的，因为没有它，站点将不会为所需的 buttonclick 事件生成事件处理程序。
2.  将链接按钮的 css 显示属性设置为“无”。请注意，链接按钮的“Visible”属性可能会设置为 true（这是因为 asp.net 甚至不会呈现带有 false visible 属性的控件的代码）。为了说明，如果您的链接按钮的 cssClass 名称是 myButton，请将其添加到您的 css 文件中：

    ```
    .myButton
    {
       display: none;
    } 
    ```

3.  现在按钮已创建并正确隐藏，您可以将回发功能添加到您的 javascript 函数中。postback 函数有两个参数，第一个是我们创建的链接按钮控件的*客户端 ID*。**请注意**，asp.net 控件的客户端 ID 与您在开发期间为其分配的 ID 不同。因此，我们使用 <%=Control.ClientId %> 来获取控件的*客户端 ID*。如果您的链接按钮 ID 是“myLinkBut​​ton”，则以下应该是您的回发功能：

    ```
    __doPostBack('<%=myLinkButton.clientid %>','') 
    ```

    请注意，此函数的开头有**两个**下划线字符。

* * *

以下是新按钮应调用的正则表达式验证函数和 javascript 函数的示例：

```
function validateCombobox(myComboboxValue) { 
    if(myComboboxValue.match(regularExpressionString)===null){
      return false
    } else {
      return true
    };
};

function comboBoxButton_click(){
   var myComboboxValue = $('#<%=myComboBox.clientid %>').val();
   if(validateCombobox(myComboboxValue)==true){
      __doPostBack('<%=myLinkButton.clientid %>','');
   };
}; 
```

我现在有很多分心的事情，而且有点心烦意乱，所以如果这些说明有点混乱，请原谅我。如果您需要更多帮助，请随时发表评论，我会尽快回来查看。

# c# - 为调色板创建一个组件

> ID：14188863
> 
> 赞同：1
> 
> 时间：2013-01-07T01:53:36.100
> 
> 标签：c#, components, controls

我以前从未创建过组件，但现在有一些基本上是 .cs 文件。它们属于 System.Windows.Forms.Control 类型。

但是，当我使用它们所属的解决方案时，它们仅在控制面板上可用。它使用 /Resources 文件夹中的一些图像。

有没有办法将组件制作成 DLL，以便我可以通过简单地引用它在任何项目中使用它？或者，让它成为一个总是出现在我的调色板中的组件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T01:57:30.690

您需要创建一个控件库项目，它是一个类库 (DLL)，其中包含继承`Control`.

然后，您可以添加对已编译 DLL 的引用（如果它在同一解决方案中，则添加到项目），控件将出现在您的工具箱中。

# google-play - 安装的 android 应用看不到在 Google Play 上发布的更新

> ID：14188864
> 
> 赞同：0
> 
> 时间：2013-01-07T01:53:36.873
> 
> 标签：google-play, auto-update

我在 Google Play 上发布了一个安卓应用。后来我还发布了市场更新。一切似乎都运行良好。但是，在已经安装了第一个版本的手机上，他们看不到新的更新并且不会安装，即使他们检查了“如果可用，自动安装新的更新”。

我检查了 Google Play 是否发布了我的新更新并且它已经发布了。因为如果我在没有第一个版本的手机上安装我的应用程序，我会得到更新的版本。当我发布更新时，我已经更改了应用程序版本。

有人知道这个问题吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T04:29:34.177

可能重复

[Android 应用程序未在 Market 中显示为“可用更新”](https://stackoverflow.com/q/8853818/1721946)

这可能是您正在寻找的答案：

[https://stackoverflow.com/a/13499092/1721946](https://stackoverflow.com/a/13499092/1721946)

# ruby - 在字符串中嵌入块

> ID：14188868
> 
> 赞同：0
> 
> 时间：2013-01-07T01:54:05.030
> 
> 标签：ruby, string, embed

有没有办法以像这样可执行的方式将块嵌入字符串中？

```
for i in 1..1000
  test "There once was #{if i=1{'a man'} else {'many men'} end} from kilkenny"
end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T02:00:53.473

是的，其中的所有内容都`#{}`将在使用字符串之前进行评估，因此必须是有效的 Ruby 代码。尝试：

```
1.upto(1000) do |i|
  puts "There once was #{i==1?"a man":"many men"} from kilkenny"
end 
```

在这里，我使用了 Ruby 和其他语言中使用的三元运算符，基本上是：

```
(boolean condition) ? (return this on true) : (return this on false) 
```

还要注意 double equal `==`，它是 Ruby 中的相等运算符。Single equal`=`是赋值运算符，在您的代码中，它会在每个循环中重置`i`to的值。`1`

因为除了 nil 和 false 之外的所有值在 Ruby 中都是真实的，所以您提出的 if .. then 将始终为真，因为`i=1`返回`1`，这是真的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T11:38:16.090

你已经得到了三元运算符的答案。

也许使用 %-method 的另一个版本可以为您提供更好的概览。三个不同版本的示例：

```
1.upto(10) do |i|
  puts "There once was %s from kilkenny" % (i==1 ? "a man" : "many men")
  puts "There once was %s from kilkenny" % if i==1;  "a man"; else  "many men"; end
  puts "There once was %s from kilkenny" % case i
      when 1;  "a man" 
      else   "many men"
      end      
end 
```

你也可以使用哈希来解决你的问题：

```
man = Hash.new("many men")
man[1] = "a man"
man[2] = "two men"
1.upto(10) do |i|
  puts "There once was #{man[i]} from kilkenny"
end

end 
```

或者使用另一个版本的哈希创建：

```
man = Hash.new(){|h, key|
  h[key] =case key
    when 1
      "a man"
    when 2
      "two men"
    else 
      "many men"
    end
}
1.upto(10) do |i|
  puts "There once was #{man[i]} from kilkenny"
end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-07T02:01:08.277

您可以使用 Ruby 的三元运算符：

```
for i in 1..1000
  puts "There once was #{i == 1 ? 'a man' : 'many men'} from kilkenny"
end 
```

# javascript - AND 在 JAVASCRIPT 中的 IF 条件下

> ID：14188870
> 
> 赞同：0
> 
> 时间：2013-01-07T01:54:21.817
> 
> 标签：javascript, if-statement, conditional-statements

你如何在javascript中的if条件下编写AND？我想要这段代码，但它会产生错误。

```
if(xmlDoc.selectSingleNode("//RentersInsuranceSetting/Row").getAttribute("ExcludeCorporateUnits")==1) AND (xmlDoc.selectSingleNode("//AllPeople/Row").getAttribute("BusinessCorporationBit")==1)
    {  
    confirmValidRentersInsurance.required = "noReq"
    confirmValidRentersInsurance.style.color = "blue"
    insuranceRequired = false   
    } 
```

javascript中AND的运算符是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T01:55:44.930

JavaScript 中的逻辑“与”运算符是`&&`.

这里还有一个[快速参考](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Logical_Operators)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T01:56:53.497

`&&`运营商会这样做。例如...

```
if (condition1 && condition2) 
{ // if 2 conditions are true, then execute this line... } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-07T01:58:00.437

您使用`&&`运算符。

您还需要另一组括号，以便您得到`if ((...) && (...))`而不是`if (...) && (...)`：

```
if ((xmlDoc.selectSingleNode("//RentersInsuranceSetting/Row").getAttribute("ExcludeCorporateUnits")==1) && (xmlDoc.selectSingleNode("//AllPeople/Row").getAttribute("BusinessCorporationBit")==1)) 
```

或者删除一些括号来制作它`if (... && ...)`。由于`==`运算符的优先级高于`&&`运算符，因此您不需要它们：

```
if (xmlDoc.selectSingleNode("//RentersInsuranceSetting/Row").getAttribute("ExcludeCorporateUnits")==1 && xmlDoc.selectSingleNode("//AllPeople/Row").getAttribute("BusinessCorporationBit")==1) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-07T01:56:51.987

```
&& 
```

见[http://www.w3schools.com/js/js_comparisons.asp](http://www.w3schools.com/js/js_comparisons.asp)

也许看看上面网站上的这些 javascript 教程。

# ruby-on-rails - Rails ActiveRecord 返回相关表中存在 id 的记录

> ID：14188872
> 
> 赞同：13
> 
> 时间：2013-01-07T01:54:57.000
> 
> 标签：ruby-on-rails, activerecord, active-record-query

我有一个客户模型和一个产品模型，其中一个客户有很多产品，一个产品属于一个客户。

我需要找到一个查询，如果他们在产品表中有记录，则只返回客户

客户表

```
id |      name
--------------
 1 | Company A
 2 | Company B
 3 | Company C 
```

产品表

```
id |      name |  client_id
---------------------------
 1 | Product A |         1
 2 | Product B |         1
 3 | Product C |         3
 4 | Product D |         3
 5 | Product E |         1 
```

我只需要客户 1 3

例如像

```
@clients = Client.where("client exists in products")  #something to this effect 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-01-07T06:13:55.007

最简单但不是最快的：

```
Client.where(:id => Product.select(:client_id).map(&:client_id)) 
```

SQL 子查询（更快）：

```
Client.where("EXISTS(SELECT 1 from products where clients.id = products.client_id)") 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-07-28T18:34:20.063

这是另一个解决方案。这是一个类似于 Valery 的第二个解决方案的子查询，但没有写出 sql：

```
Client.where(Product.where(client_id: Client.arel_table[:id]).exists) 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-08-30T18:53:59.120

这是使用[Where Exists](https://github.com/EugZol/where_exists) gem 的解决方案（披露：我是它的作者）：

```
Client.where_exists(:products) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-02-09T17:29:53.713

另一个存在的宝石：[activerecord_where_assoc](https://github.com/MaxLap/activerecord_where_assoc)（我是作者）

用它：

```
Client.where_assoc_exists(:products) 
```

如果你还必须指定一些产品，你什么时候可以这样做：

```
Client.where_assoc_exists(:products, id: my_products.map(&:id)) 
```

在没有宝石的情况下这样做很容易出错。

[在文档](https://maxlap.github.io/activerecord_where_assoc/ActiveRecordWhereAssoc/RelationReturningMethods.html)中阅读更多内容。这里有一个[介绍](https://github.com/MaxLap/activerecord_where_assoc/blob/master/INTRODUCTION.md)和[例子](https://github.com/MaxLap/activerecord_where_assoc/blob/master/EXAMPLES.md)。

# ruby-on-rails-3 - Rails 两足 OAuth 提供程序中的 401 未经授权的错误

> ID：14188873
> 
> 赞同：1
> 
> 时间：2013-01-07T01:55:02.970
> 
> 标签：ruby-on-rails-3, oauth, oauth-ruby, two-legged

我正在尝试在 Rails 上实现一个两条腿的 OAuth 提供程序。

我按照这些说明安装消费者和提供者：

[https://github.com/pelle/oauth-plugin](https://github.com/pelle/oauth-plugin)

使用这些说明使消费者工作

[Rails3 - oauth-plugin 问题](https://stackoverflow.com/questions/4925746/rails3-oauth-plugin-problem)

这些指令实现用户登录

[https://github.com/plataformatec/devise](https://github.com/plataformatec/devise)

并使用这些方法来测试连接

[http://oauth.rubyforge.org/rdoc/classes/OAuth/Consumer.html](http://oauth.rubyforge.org/rdoc/classes/OAuth/Consumer.html)

按照这些说明实施两条腿策略

[Rails 两条腿的 OAuth 提供者？](https://stackoverflow.com/questions/2775242/rails-two-legged-oauth-provider)

但在消费者方面，我得到

```
 Completed 500 Internal Server Error in 86ms
  OAuth::Unauthorized (401 Unauthorized ):
  oauth (0.4.7) lib/oauth/consumer.rb:216:in `token_request'
  oauth (0.4.7) lib/oauth/consumer.rb:136:in `get_request_token'
  ... 
```

在服务器端

```
Started POST "/oauth/request_token" for 127.0.0.1 at Sun Jan 06 22:02:08 -0300 2013
Processing by OauthController#request_token as */*
  Rendered text template (0.0ms)
Filter chain halted as #   <OAuth::Controllers::ApplicationControllerMethods::Filter:0x1111e0e80 @strategies=[:two_legged], @options={:interactive=>false, :strategies=>:two_legged}> rendered or redirected
Completed 401 Unauthorized in 3ms (Views: 2.1ms | ActiveRecord: 0.0ms) 
```

这篇文章似乎指向了同样的问题

[https://github.com/pelle/oauth-plugin/issues/106](https://github.com/pelle/oauth-plugin/issues/106)

我正在使用两条腿的实现来允许从我的原生 android 应用程序登录到我的 rails 应用程序。

这篇文章似乎与我的问题有关

[Rails Oauth：无法获取 request_token，过滤器链停止](https://stackoverflow.com/questions/10207341/rails-oauth-unable-to-get-request-token-filter-chain-halted)

我不知道在哪里查看或如何在服务器端获取更详细的日志。

任何帮助将不胜感激。谢谢！

# iphone - iPhone 和 iPad 中的手势处理方式相同

> ID：14188874
> 
> 赞同：0
> 
> 时间：2013-01-07T01:55:29.613
> 
> 标签：iphone, ios, simulator, gesture, tap

我现在正在开发一个应用程序，在该应用程序中，iPhone 上的点击处理方式与 iPad 上的处理方式相同。我没有iPhone，所以我现在使用模拟器进行测试。如果模拟器模拟水龙头，我想我可以简单地用鼠标在屏幕上单击，但这似乎不起作用。

所以我想到问题可能是我从 iPad 开始，后来创建了 iPhone 界面（尽管项目本身从一开始就是通用的）。

我从 iPad 的情节提要中复制了手势识别器（点击和两次滑动）并将它们粘贴到 iPhone 的情节提要中。我不认为这会奏效，但我希望这就是我所要做的。无论如何，似乎应该能够从两个故事板手势识别器链接相同的代码。

当这不起作用时，我使用 Control-drag 连接 iPhone 手势识别器，就像我在 iPad 上所做的那样。这创造了新的方法。由于可以使用相同的代码，我想我只需调用另一个代码：

```
- (IBAction)tapIphone:(UITapGestureRecognizer *)sender {
   [self tapIpad:sender];
}
- (IBAction)tapIpad:(UITapGestureRecognizer *)sender { 
```

省略代码

```
} 
```

那也没有用。所以接下来我尝试将代码从 iPad 方法复制/粘贴到 iPhone 方法。它仍然没有工作。

所以现在我想知道我是否不知道如何在 iPhone 模拟器上正确测试水龙头。我还能错过什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T02:54:14.473

很明显，tapIphone 方法根本没有被调用。您可以通过在方法中添加 @NSLog("tapIphone") 来解决这个问题，看看它是否记录。实际上将这些行放入各自的方法中：

```
@NSLog("tapIphone");
@NSLog("tapIpad"); 
```

如果 tapIphone WAS 被调用并且 tapIpad 方法在同一个类中，那么预期的行为应该已经发生。

您的第一个直觉是将项目从一个故事板复制并粘贴到另一个故事板，这很好。但是，当您执行此操作时，您会丢失所有 IBAction / IBOutlet 连接（它们不会将它们的链接传递到旧情节提要或从旧情节提要中传出），因此您每次都必须重新连接它们。当您尝试将一个设备的界面调整为另一个设备时，这有点痛苦。这并不意味着您必须创建新代码 - 它只是意味着您必须从每个情节提要项目中 CRTL 拖动到要重新连接到的*现有*IBAction 代码项目上（您可以通过从情节提要中按住 CTRL 拖动来实现相同的结果item 到相关的 controlView 故事板图标，它将为您提供要连接到的可选 IBAction 项目的列表）。您想要复制的任何 IBOutlet 连接也是如此。

这不是模拟器的问题，您只需要调整您对故事板接线的理解。

我不建议您建议使用单独的 IBAction 方法来处理不同设备上的不同行为。这将导致更多的布线复杂性，这对调试很不利。有更好的方法可以做到这一点，例如通过检查环境功能或使用：

```
if ([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPhone) {
   //iPhone code goes here
} else  {
   //ipad code goes here
} 
```

# ruby-on-rails - created_at != Date.today 用于新行

> ID：14188880
> 
> 赞同：2
> 
> 时间：2013-01-07T01:56:15.317
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord

如何检查今天是否更新了行？**updated_at 说它是 1 月 7 日**，而**Date.today 说它是 1 月 6 日。**

对于几毫秒前创建的行，下面的代码在每天几个小时内评估为 false。

```
up_votes.where(:post_id => params[:post_id]).order('updated_at DESC').limit(1).first.updated_at.to_date == Date.today 
```

我在控制器中使用 Date.today 与活动记录时间戳进行比较是否正确？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T02:06:41.063

> created_at 说它是 1 月 7 日，而 Date.today 说它是 1 月 6 日。

我希望这是真的，因为`Date.today`不在 GMT 区域，但 created_at 是。尝试 `Time.now.utc.to_date`代替`Date.today`

我还注意到您询问过 created_at 但在您的示例中使用了 updated_at

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T02:08:06.713

你不能只使用`today?()`api的功能吗？ [http://api.rubyonrails.org/classes/Date.html#method-i-today-3F](http://api.rubyonrails.org/classes/Date.html#method-i-today-3F)

# javascript - JQuery - 使用函数中的值

> ID：14188883
> 
> 赞同：1
> 
> 时间：2013-01-07T01:56:22.643
> 
> 标签：javascript, jquery

如何在 if 语句中使用函数的值。我有一个表单，我在脚本中使用了 return false，但我需要将其更改为 preventDefault。

```
<form id="percentageBiz" method="post">
<input type="text" id="sum1">
<input type="text" id="sum2">
<input type="submit" onclick="return" value="Get Total">
</form>
<div id="display"></div>​

<script>
$('#percentageBiz').submit(function(e) {
    var a = document.forms["percentageBiz"]["sum1"].value;
    var b = document.forms["percentageBiz"]["sum2"].value;
    var display=document.getElementById("display")
    display.innerHTML=parseInt(a,10)+parseInt(b,10);
    e.preventDefault();
});
if (display < 100) {
    $("#display").addClass("notequal");
}
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T02:02:56.253

```
$('#percentageBiz').submit(function(e) {
    e.preventDefault();

    var $display = $("#display", this);
    var a = $("#sum1", this).val();
    var b = $("#sum2", this).val();
    var sum = +a + +b;

    $display.text( sum );

    if ( sum < 100 ) {
        $display.addClass("notequal");
    }
}); 
```

# java - 带哈希图的 PreparedStatement

> ID：14188885
> 
> 赞同：1
> 
> 时间：2013-01-07T01:56:35.463
> 
> 标签：java, prepared-statement

我是 Java 的新手，我的问题是我试图将货币汇率插入我的 MySQL 数据库表中，称为货币，其中包含两列 Currency_name 和 rate。该程序从财务 yahoo API 获取货币汇率，我面临将数据存储到我的数据库中的问题。

```
void checkRateAllAtEnd() throws Exception {
       /** print message  */
    System.out.println("checkRateAllAtEnd :");
        long start = System.nanoTime();

        List<Callable<HashMap>> tasks = new ArrayList<Callable<HashMap>>();
        for (final String ccy : CURRENCY) {
                tasks.add(new Callable<HashMap>() {
                        public HashMap call() throws Exception {
                                return getRates(ccy);
                        }
                });
        }
        ExecutorService executorPool = Executors.newCachedThreadPool();
        final List<Future<HashMap>> listRates = executorPool.invokeAll(tasks, 3600, TimeUnit.SECONDS);

        for (Future<HashMap> rate : listRates) {
                HashMap ccyRate = rate.get();
                System.out.println("Value of £1 in " + ccyRate.get("CCY") + " is " + ccyRate.get("RATE"));
        } 
```

我缺乏将值从 hashmap 传递到preparedStatement 的功劳。

```
 String sql="update currency set currency_name='"+Value1+"'";
        preparedstatement=connection.prepareStatement(sql); 
        preparedstatement.execute(); 
```

我在这个链接上的整个班级都在充分发挥作用，以保持问题的清洁>> [linke](http://pastebin.com/HGtQ3qqW) <<<

这是我想存储到 MYSQL 中的程序的输出 理想情况下我想存储

> ccyRate.get("CCY") 和 ccyRate.get("RATE")

```
checkRateAllAtEnd :
Value of £1 in AED is 5.9201
Value of £1 in AFN is 82.4359
Value of £1 in ALL is 171.681
Value of £1 in AMD is 650.4296
Value of £1 in ANG is 2.8849
Value of £1 in AOA is 154.4766
Value of £1 in ARS is 7.9438
Value of £1 in AUD is 1.5345 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T02:04:48.660

您的 addCurrency 方法是错误的 - 通过提供preparedStatmenet 作为参数，您不仅没有获得任何东西，而且在尝试关闭它时您也没有获得任何东西，
因为此时它为空。
请向我们展示您遇到的确切错误/异常，我将相应地编辑我的答案。

# javascript - 页面加载时 jQuery 选项卡闪烁 (FOUC)

> ID：14188887
> 
> 赞同：6
> 
> 时间：2013-01-07T01:56:43.763
> 
> 标签：javascript, jquery, jquery-ui, jquery-ui-tabs, jquery-tabs

我有以下网站：

[http://cassidoo.public.iastate.edu/](http://cassidoo.public.iastate.edu/)

我正在为我的菜单使用 JQuery UI 选项卡。加载页面时，选项卡中的内容会闪烁。

我已经尝试了从`ui-tabs-hide`技巧到在 Javascript 中隐藏东西的所有方法。有没有我错过的技巧？我该怎么办？

感谢您的帮助！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-07T04:04:56.853

我遇到了类似的情况，这是我解决问题的方法：

(1.) 定义一个名为“hide”的css类并将其设置为“display:none”

(2.) 在每个具有“contentpanel”类的 div 中，在您的标记中在其旁边添加“hide”。这将确保页面加载时
不显示，而不是等待 javascript 处理它。

(3.) 创建 jquery.ui.tabs 选择器时，使用“tabscreate”方法从内容面板中删除“隐藏”类。所以你的选择器看起来像这样：

```
 //define tabs instance 
   $( "#tabs" ).tabs({

        create: function( event, ui ) {
           //when tabs are created, remove your class .hide from each content panel
           //so jquery tabs will control when panel content will surface
           $(your contentpanel selector).removeClass(hide);
        }
     //whatever else you need to do
     ....
     ...
     ..
    }); 
```

要了解有关 jQuery UI 选项卡内部方法的更多信息，请阅读以下内容：

[http://api.jqueryui.com/tabs/](http://api.jqueryui.com/tabs/)

并阅读

创建（事件，用户界面）

希望这可以帮助。

克里斯

# ruby - 用 Ruby 编写一个简单的 Windows 7 GUI 应用程序

> ID：14188890
> 
> 赞同：10
> 
> 时间：2013-01-07T01:57:03.530
> 
> 标签：ruby, user-interface, windows-7

有没有人使用 Ruby 为 Windows 7 开发简单的 GUI 应用程序？您使用了哪个 GUI 框架？我正在考虑将 tK 或 WxRuby 用于 GUI 并使用 Ocra 进行打包。我是否也需要安装程序来在用户机器上安装 ruby​​ 和 libs？

这对我来说是新的领域，想法会有所帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-08T10:30:32.453

鞋子是一个不错的工具包，可立即用于小 GUI。但是在第 3 版中，打包程序有些损坏。“green_shoes”是作为 gem 的鞋子实现，所以通过 ocra 打包应该可以工作。

如果您想构建更复杂的 UI，我建议使用 JRuby 和 Swing（或 SWT）。使用 JRuby，您可以使用 rawr-gem 将您的应用程序捆绑到单个 .jar、.exe 或 .app，其中包含您想要的所有内容。只需要在目标机器上安装 Java，现在这应该不是问题。Swing 坚如磐石且成熟，并且有一些工具可以使用可视化设计器构建 UI（例如：netbeans mantisse）。

另一种选择可能是[http://visualruby.net/](http://visualruby.net/)，它是使用 GTK 和 Glade-Designer 的 ruby​​ GUI 应用程序的某种 IDE。我还没有使用它，但它似乎工作顺利。

最后但并非最不重要的一点：Shoes 团队努力发布基于 JRuby 和 SWT 的 Shoes4。如果您喜欢鞋子 DSL，可以尝试一下，但它仍在开发中。

我或多或少知道的其他工具包：

*   TK（由于最新版本看起来不错，应该可以与 ocra 一起使用）
*   wxruby（似乎死了）
*   fxruby（有一个新的维护者，应该可以工作，有一本免费的书，但是我上次使用它时，它看起来非常丑陋和过时）
*   gtk+（可用，但请参阅 visualruby 以获得一些舒适和指导）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-02T16:11:06.260

Green_shoes 与 Ocra 合作。但是文件太大，点击图标后窗口需要很长时间才能出现。Tk 更小更快（但仍然很慢）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-07T04:26:26.297

> Shoes 是一个跨平台的工具包，用于使用 Ruby 轻松而巧妙地编写图形应用程序。与大多数其他 GUI 工具包不同，Shoes 旨在简单明了而不会失去功能。真的，很容易！

[**shoesrb.com**](http://shoesrb.com)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-23T00:46:02.897

使用 Shoes 后，我将我的免费项目迁移到 Jruby 和 Swing ......我得到了 Ruby sintax 和所有 Java 部署和运行 aventages ...... [http://sourceforge.net/projects/rmldonkey/](http://sourceforge.net/projects/rmldonkey/)

# javascript - 绘制直线元素html 5

> ID：14188894
> 
> 赞同：-1
> 
> 时间：2013-01-07T01:58:15.290
> 
> 标签：javascript, svg, html5-canvas, preview

我想在 html5 中画一个线元素

我想做的是这样

mousedown 事件将是我的起始位置（x，y）；

鼠标移动

当鼠标是 mouseup 时，它将是结束位置..

我已经完成了这部分

我真正想要的是在我移动鼠标时看到画布中绘制的线条当我已经松开鼠标时，线条将准确地绘制在画布中，因为它在鼠标移动并按下时预览

这是我的代码

```
canvas_draw.addEventListener('mousemove',function(e){
x=e.pageX-canvas_draw.offsetLeft;
y=e.pageY-canvas_draw.offsetTop;
},false);

canvas_draw.addEventListener('mousedown',function(e){
context_draw.beginPath();
context_draw.moveTo(x,y);
},false);

canvas_draw.addEventListener('mouseup',function(e){
context_draw.lineTo(x,y);
context_draw.stroke();
context_draw.closePath();

},false); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T09:21:26.940

我猜您的意图是用户实时看到一条“预览”线，该线在用户移动光标时移动，而您的问题是当您在 mousemove 事件期间绘制线时，该线不会被擦除光标移动到一个新位置。

我看到了两种解决这个问题的方法。

a) 在 mousedown 事件中创建画布的备份副本，方法是使用 .将其绘制到新的不可见画布上`drawImage()`。在 mousemove 中绘制线之前，将备份副本绘制回真实画布以擦除您在上一个 mousemove 事件中绘制的线（您可以通过仅复制上一行覆盖的部分来提高性能）。

b) 在真实画布之上创建一个新的透明画布，并将其用于任何用户界面元素，例如预览线。这样，您可以随意擦除它而不会损坏其下方的真实画布（请记住，大多数事件将被顶部画布捕获）。

# jsp - 在 JSP 中按用户名登录的单独结果

> ID：14188896
> 
> 赞同：0
> 
> 时间：2013-01-07T01:58:35.653
> 
> 标签：jsp, login

![这张表是我要显示的](../Images/21b144d3e56c909ea01837482fc9506a.png)![这是客户端（系统用户）表](../Images/cc7c6d56733444cdc2f88efec1cf396b.png)如何根据登录的用户分离数据库内容，以便每个用户只能看到他的内容。我不确定您是否需要来自 MySql 的实际表，如果需要，我将对其进行编辑。

登录

```
<%@ page language="java" import="java.sql.*" import="java.text.*" errorPage="" %>
<%

Connection conn = null;
Class.forName("com.mysql.jdbc.Driver").newInstance();
conn = DriverManager.getConnection("jdbc:mysql://localhost:3306/database","root",         "root");

ResultSet rsLoginFunction = null;
PreparedStatement psLoginFunction=null;

String sUserID=request.getParameter("username");
String sPassword=request.getParameter("password");
String message="User login successfully ";

try{
String sql ="Select * from clients where username=? and password=?";

psLoginFunction=conn.prepareStatement(sql);
psLoginFunction.setString(1,sUserID);
psLoginFunction.setString(2,sPassword);

rsLoginFunction=psLoginFunction.executeQuery();

if(rsLoginFunction.next())
{
  String username=rsLoginFunction.getString("Email")+"     "+rsLoginFunction.getString("clientID");

  session.setAttribute("Username",rsLoginFunction.getString("username"));
  session.setAttribute("Email",rsLoginFunction.getString("Email"));

 // session.setAttribute("iUserLevel",rsLoginFunction.getString("iUserLevel"));
 // session.setAttribute("sUserName",sUserName);

  response.sendRedirect("view_menu.jsp?error="+message);
}
else
{
  message="No user or password matched" ;
  response.sendRedirect("Login.jsp?error="+message);
}
}
catch(Exception e)
{
    e.printStackTrace();
}

/// close object and connection
try{
     if(psLoginFunction!=null){
         psLoginFunction.close();
     }
     if(rsLoginFunction!=null){
         rsLoginFunction.close();
     }

     if(conn!=null){
      conn.close();
     }
}
catch(Exception e)
{
    e.printStackTrace();
}

%> 
```

查看，但不分开

```
 <%@ include file="include/commonStrings.jsp"%>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"         "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<script type="text/javascript">
function del() {
    if (confirm("Do You Want to Delete this Menu?")) {
    } else {
        return false;
    }
}
</script>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title></title>
<link rel="stylesheet" href="images/style.css" type="text/css"
charset="utf-8" />
</head>
<body>
<%
    menu_slno1 = request.getParameter("menu_slno");
    if (menu_slno1 != null)
        menu_slno = Integer.parseInt(menu_slno1);
    delete_menu = request.getParameter("delete_menu");

    if ("yes".equals(delete_menu)) {
        MenuId = request.getParameter("MenuId");
        x = stmt1
                .executeUpdate("Delete from menu where MenuId="
                        + MenuId);
    }
%>

<h2>VIEW MENUS</h2>

<table width="736" height="97" border="1">
    <%
        if (x == 1) {
    %>
    <tr bgcolor="#000000">
        <th height="35" colspan="9"><div align="center">
                Menu (<%=MenuId%>) deleted successfully
            </div></th>
    </tr>
    <%
        }
    %>
    <tr bgcolor="#089937">
                        </div></td>
        <td><div align="center">
                <strong>MENU ID </strong>
            </div></td>
        <td><div align="center">
                <strong>MENU NAME </strong>
            </div></td>
        <td><div align="center">
                <strong>MENU INFO </strong>
            </div></td>
        <td><div align="center">
                <strong>MENU PRICE </strong>
            </div></td>
        <td><div align="center">
                <strong>MODIFY </strong>
            </div></td>
        <td colspan="2"><div align="center">
                <strong>DELETE</strong>
            </div></td>
    </tr>
    <%
        int icount = 0;

//here i only know how to display whole table
        rs = stmt.executeQuery("select * from menu");
        while (rs.next()) {
            //menu_slno = rs.getInt("menu_slno");
            MenuId = rs.getString("MenuId");
    %>
    <tr>
        <td><div align="center"><%=++icount%></div></td>

        <td><%=rs.getString("Name")%></td>
        <td><%=rs.getString("Info")%></td>
        <td><%=rs.getDouble("Price")%></td>

        <td><div align="center">
                <a href="edit_menu.jsp?MenuId=<%=MenuId%>">Edit</a>
            </div></td>
        <td><div align="center">
                <a
                    href="view_menu.jsp?delete_menu=yes&MenuId=        <%=MenuId%>&MenuId=<%=MenuId%>"
                    onclick="return del()">Delete</a>
            </div></td>
    </tr>
    <%
        }
    %>
</table>
<a href="add_menu.jsp">Add Menu</a>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T15:29:21.027

`role`首先在称为存储权限的数据库中创建附加字段。意味着如果用户具有管理员角色，他可以访问所有内容，否则他将受到一些限制。

然后您可以在向用户显示输出之前轻松检查它。如果您需要更多帮助，请告诉我。

**编辑**

您可以使用以下代码：在表中添加第三列后：

```
role=rsLoginFunction.getString("role")
if(role.equalsIgnoreCase("admin"))
{
    //show the contents with full functionality.
    //like Delete, Edit, Add option
}
else
{
    //show the contents with limited access
    //like Allow user to only see the data, not allow him to modify
} 
```

**编辑：**

您可以使用 SQL 查询来做到这一点，例如：

```
select * from menu where login.username=menu.username 
```

因此它将向您显示与该特定用户相关的记录。

**编辑：**

```
String s = request.getParameter("username");
String query = "select * from menu where menu.username= s"; 
```

然后执行此查询，这将为您提供所需的结果...

# php - 在 Yii 框架应用程序中嵌入 Wordpress 页眉和页脚

> ID：14188897
> 
> 赞同：1
> 
> 时间：2013-01-07T01:58:49.377
> 
> 标签：php, wordpress, yii

我正在构建一个使用 Wordpress 作为 CMS 并使用 Yii 框架构建的网站。所有的业务逻辑都可以正常工作。大多数可见页面都充满了来自 Wordpress 管理员的内容，只有用户个人资料部分是用 Yii 构建的。

我的问题是我想在 Yii 应用程序中重用 wordpress 页面的布局。最初，我尝试在一个空白的 PHP 文件中执行此操作，并且使用此代码一切正常：

```
<?php
要求（'/var/www/wordpress/wp-load.php'）；

get_header();
?>

<div>
这里有一些内容
</div>

<?php
get_footer();
?>

```

问题是当我在 Yii 中创建新布局以便我可以重用页眉和页脚时，它会崩溃并显示空白页。我尝试了`require('/var/www/wordpress/wp-blog-header.php');`和`require( '/var/www/wordpress/wp-load.php' );`。这是我用来在 Yii 中加载 wordpress 功能的代码，但不幸的是它不起作用。

```
<?php /* @var $this 控制器 */
spl_autoload_unregister(array('YiiBase','autoload'));

定义（'WP_USE_THEMES'，真）；
要求（'/var/www/wordpress/wp-blog-header.php'）；

//require('/var/www/wordpress/wp-load.php');
get_header();

spl_autoload_register(array('YiiBase', 'autoload'));

 ?>

```

任何帮助将非常感激。理想情况下，我想在 Yii 布局/视图中使用 wordpress 功能`get_header()`。`get_footer()`

谢谢

**更新**

我检查了 Apache 日志，当我尝试在浏览器中打开页面时，似乎记录了以下错误：`PHP Fatal error: Call to a member function get() on a non-object in /var/www/wordpress/wp-includes/query.php on line 27` 此外，当我注释掉该`get_header();`行时，页面打开时没有任何错误（也没有任何样式）。所以有些东西阻止了 get_header() 在 Yii 中工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T17:34:18.110

我最终`require( '/var/www/wordpress/wp-load.php' );`在初始化代码之前添加了 Yii 的 index.php 文件。然后我就可以在我的项目中使用所有的 WordPress 功能。`get_header()`这帮助我在 Yii 中使用和`get_footer()`函数重用了来自 WordPress 的页眉和页脚布局。

# webserver - 如何安装和配置 LAMP

> ID：14188899
> 
> 赞同：0
> 
> 时间：2013-01-07T01:59:45.210
> 
> 标签：webserver, lamp

首先，我是 Linux 新手。我有一个 CentOS 6.0 64 位 VPS 并想将它用作 Web 服务器。我在 Google 和 SO 上进行了搜索，发现了很多关于 LAMP 设置的教程，但是在配置部分它们都是不同的。（例如，对于文件夹权限，一个使用 chmod 750，另一个使用 chmod 2750，另一个使用不同的东西，但我看不出区别）

我想设置一个尽可能安全和轻便的可靠网络服务器。

你能告诉我从哪里开始或推荐一些关于 LAMP 配置的好教程吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T02:03:46.887

[本教程](https://www.digitalocean.com/community/articles/how-to-install-linux-apache-mysql-php-lamp-stack-on-centos-6)非常适合从 CentOS 上的 LAMP 开始。

# c++ - 循环中的 cin 函数有问题

> ID：14188908
> 
> 赞同：2
> 
> 时间：2013-01-07T02:01:13.527
> 
> 标签：c++, loops, cin

我只是想使用循环用字符串填充数组。我的问题是，当它进入循环输入名称时，它会立即为向量中的第一个插槽输入一个空行。为什么会这样？我该如何解决它。请不要介意我缺乏代码风格，在今年冬天开始上课之前，我是一个试图重新获得编程知识的菜鸟......

这是一些示例输出：

```
How many people are in your family?
4
Please enter the names of all of your family members
check name:
Please enter the names of all of your family members
Matt
check name:Matt
Please enter the names of all of your family members
Evan
check name:Evan
Please enter the names of all of your family members
Michelle
check name:Michelle

Matt
Evan
Michelle 
```

这是我的代码：

```
vector<string> Names;
bool complete=0;
while(!complete)
{
    int number;
    cout << "How many people are in your family?" << endl;
    cin >> number;

    for(int i=0; i<number; i++)
    {
        string names;
        cin.clear();
        cout << "Please enter the names of all of your family members" << endl;
        getline(cin,names);
        Names.push_back(names);
        cout << "check name:" << names << endl;
    }
    complete = 1;
}

for (int i=0; i< Names.size(); i++)
{
    cout << Names[i] << endl;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T02:16:12.930

您看到此行为的原因是将`>>`读取与 getline 混合。当您读取计数时，输入指针前进到数字输入的末尾，即 4，并在读取换行符之前停止。

这是你打电话的时候`getline`；读取换行符，并立即返回换行符。

要解决此问题，请在调用`getline`后立即添加`cin >> number`调用，并丢弃结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T02:11:18.103

我可以建议你试试吗

```
std::cin >> names; 
```

代替

```
getline(std::cin, names); 
```

getline 接受`std::endl`或 `\n`来自您的`std::cout`打印字符串。这个想法是 getline 将读取直到`\n`字符（这是结束行的指示），但它也会消耗结束行字符。这就是为什么它将换行符消耗到您的向量中的原因。

考虑这样做。. .

```
std::cin.get(); 
```

它将读取`std::endl`字符，然后使用 getline 函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-07T02:25:53.577

问题是将有格式输入 ( `std::cin >> number`) 与无格式输入 ( `std::getline(std::cin, names)`) 混合在一起。格式化的输入在第一个非整数字符处停止，很可能是您在计数后输入的换行符。最简单的解决方法是显式跳过前导空格：

```
std::getline(std::cin >> std::ws, names); 
```

请注意，您还需要在每次输入后检查它是否成功：

```
if (std::cin >> number) {
    // do something after a successful read
} 
```

# android - 从 ArrayAdapter 内部打开 ContextMenu

> ID：14188909
> 
> 赞同：1
> 
> 时间：2013-01-07T02:01:20.090
> 
> 标签：android, listview, contextmenu, android-arrayadapter

我的自定义 ArrayAdapter中的方法中有一个`setOnClickLisnter`方法。`getView`

我想要做的是，`imageButton`在每行内单击一次`ListView`，我希望它打开一个 ContextMenu。

当您长按`ListView`. 现在我想将相同的功能转移到上面提到的短按上。

我的里面有这个`onCreate`：

```
registerForContextMenu(getListView()); 
```

我也有一个`onCreateContextMenu`里面的Activity。 **我的主要问题是，您如何从内部访问它`ArrayAdapter`？**

**编辑：** 我不必在`setOncLickListner`方法中执行此操作，只需在`getView`

获取视图的代码：

```
@Override
    public View getView(int position, View convertView, ViewGroup parent) {
        final ViewHolder holder;

        LayoutInflater inflater = (LayoutInflater) context
                .getSystemService(Context.LAYOUT_INFLATER_SERVICE);

        if (convertView == null) {

            convertView = inflater.inflate(R.layout.commentlayout, parent,
                    false);
            holder = new ViewHolder();
            holder.ib1 = (ImageButton) convertView
                    .findViewById(R.id.labelChatIcon);

            convertView.setTag(holder);
        } else {
            holder = (ViewHolder) convertView.getTag();
            convertView.setOnCreateContextMenuListener(null);
        }

        holder.ib1.setBackgroundColor(Color.TRANSPARENT);

        holder.ib1.setBackgroundColor(Color.TRANSPARENT);
        holder.ib1.setOnClickListener(new OnClickListener() {

            public void onClick(View v) {

                // Open Context Menu here

            }
        });

        return convertView;
    } 
```

**更新：我想我正在改变我的计划，并将使用带有单选按钮的警报对话框。在这种情况下，上下文菜单可能不合适。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T03:24:55.370

您可以使用 Alert.Builder 而不是上下文菜单，您可以使用添加自定义视图 `builder.setView(View v);`

您将有一个布局文件，其中包含一堆不同宽度的按钮：match_parent。查看[此链接](http://developer.android.com/reference/android/app/AlertDialog.Builder.html)以获取所有可用的不同选项

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T03:50:19.620

按照这个链接[http://developer.android.com/guide/topics/ui/menus.html](http://developer.android.com/guide/topics/ui/menus.html)

并使用

```
@Override
public void onCreateContextMenu(ContextMenu menu, View v,
                                ContextMenuInfo menuInfo) {
    super.onCreateContextMenu(menu, v, menuInfo);
    MenuInflater inflater = getMenuInflater();
    inflater.inflate(R.menu.context_menu, menu);
}

@Override
public boolean onContextItemSelected(MenuItem item) {
    AdapterContextMenuInfo info = (AdapterContextMenuInfo) item.getMenuInfo();
    switch (item.getItemId()) {
        case R.id.edit:
            editNote(info.id);
            return true;
        case R.id.delete:
            deleteNote(info.id);
            return true;
        default:
            return super.onContextItemSelected(item);
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-11T20:49:09.873

这个问题很老，但万一其他人需要它：您不能直接打开上下文菜单。但是，您可以长按相应的视图。这将打开上下文菜单。在你的情况下：

```
holder.ib1.setOnClickListener(new OnClickListener() {

            public void onClick(View v) {

                // Open Context Menu here
                convertView.performLongClick();
            }
        }); 
```

但是，请注意，您想要的并不符合 Android 的设计准则。长按应该打开上下文菜单，而不是正常单击。

# jquery - 固定Jquery gmap的坐标

> ID：14188910
> 
> 赞同：0
> 
> 时间：2013-01-07T02:01:28.143
> 
> 标签：jquery, google-maps, jquery-gmap3

是否有可能有一个固定视图的 gmap？换句话说，没有手形光标可以让用户改变地图的位置吗？

这是我的代码：

```
$(document).ready(function(){
$("#map").gMap({ controls: false,
                  scrollwheel: false,
                      draggable: false,
                  markers: [{ latitude: 40.727047,
                              longitude: 1006.8,
                              icon: { image: "img/pin.png",
                                      iconsize: [32, 47],
                                      iconanchor: [32,47],
                                      infowindowanchor: [12, 0] } }
                            ],
                  icon: { image: "img/pin.png", 
                          iconsize: [26, 46],
                          iconanchor: [12, 46],
                          infowindowanchor: [12, 0] },
                  latitude: 44.47698,
                  longitude: 1006.8,
                  zoom: 15, }); 
```

});

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T06:41:13.330

如果您不使用任何控件，不妨使用静态地图：

[静态地图文档](https://developers.google.com/maps/documentation/staticmaps/)

否则，您可以自定义要添加的任何控件：

[控制](https://developers.google.com/maps/documentation/javascript/v2/reference#GControl)

# javascript - 防止 jQuery UI 菜单焦点

> ID：14188912
> 
> 赞同：1
> 
> 时间：2013-01-07T02:01:48.653
> 
> 标签：javascript, jquery, jquery-ui, selection

单击项目时，如何防止 jQuery UI 菜单聚焦在菜单上。

我有一个选择菜单，当单击一个项目时，它会立即应用一个动作，然后菜单关闭。

因为 jQuery UI 在点击时触发了焦点事件（[http://code.jquery.com/ui/1.9.2/jquery-ui.js](http://code.jquery.com/ui/1.9.2/jquery-ui.js)的第 10956 行），所以它在 Chrome 中失去了选择（Firefox 似乎可以工作）。

```
...
} else if ( !this.element.is( ":focus" ) ) {
    // Redirect focus to the menu
    this.element.trigger( "focus", [ true ] ); // <----- this line
    ...
}
... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T00:27:39.963

您可以采用的一种方法是使用您需要实现的特定方法/属性的自定义值来扩展 jquery.ui.menu 原型。您可以在 jquery 中创建一个使用 $.extend 的新小部件来执行此操作。这是扩展菜单小部件以使其使用表单输入的一个很好的示例（由 Kris Borchers 撰写）：

1.  演示页面在这里： http: [//kborchers.github.com/jquery-ui-extensions/menu/inputmenu.html](http://kborchers.github.com/jquery-ui-extensions/menu/inputmenu.html)

2.  脚本是这样定义的；

    //这是核心jquery ui库 < script src="http://code.jquery.com/ui/jquery-ui-git.js" ></script > //这是扩展的自定义输入菜单小部件默认菜单小部件 < script type="text/javascript" src="jquery.ui.menu.inputmenu.js" >

3\. 评估此模式以扩展默认菜单小部件：

```
 /*
 * jQuery UI Input Menu Extension
 *
 * Copyright 2010, Kris Borchers
 * Dual licensed under the MIT or GPL Version 2 licenses.
 *
 * http://github.com/kborchers/jquery-ui-extensions
 */
(function( $ ) {

**var proto = $.ui.menu.prototype,
    originalRefresh = proto.refresh;

$.extend( proto, {**
    refresh: function() {
        originalRefresh.call( this );
        var that = this;
......
...
..
. 
```

在此处查看 github 源： [https ://github.com/kborchers/jquery-ui-extensions/blob/master/menu/jquery.ui.menu.inputmenu.js](https://github.com/kborchers/jquery-ui-extensions/blob/master/menu/jquery.ui.menu.inputmenu.js)

如果您遵循此模式，您可以自定义任何小部件以满足您的需求。

希望这可以帮助。

克里斯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-03T04:34:03.980

我的快速修复解决方案是`setTimeout`0 并做焦点。原来 setTimeout 触发菜单将焦点返回到自身，所以如果你在 setTimout 之前聚焦，它将重新聚焦到菜单；

```
setTimeout(function(){
    $('#input-id').focus();
},0); 
```

另一个快速解决方法是在任何地方以编程方式单击，这会取消菜单的焦点回到自身。

```
 $(document).click();
or
    $('#input-id').click(); 
```

# javascript - 关于 JavaScript 中的闭包，在函数中声明另一个函数有什么意义？

> ID：14188916
> 
> 赞同：4
> 
> 时间：2013-01-07T02:02:59.807
> 
> 标签：javascript, closures

我仍然在努力思考 JavaScript 中的闭包（作为记录，我已经在 Stack Overflow 上阅读了 JavaScript 闭包的答案，以及“傻瓜的 JavaScript 闭包”，但仍然对它们感到困惑）。

我的主要问题是我无法理解在函数中声明另一个函数的重要性；我知道返回内部函数允许外部函数的局部变量保持活动状态，但在这个例子中不是这样吗？

```
function sayName(name) {
var say = "Hello, " + name;
alert(say);
}

var sayJohn = sayName("John"); 
```

在我创建的 sayJohn() 函数中，局部变量“say”仍在其局部范围之外被引用。那么这不是还在创建一个闭包吗？

请注意，对于这一切听起来多么混乱，我深表歉意，对于学习 JavaScript 和一般编程来说仍然很新鲜，所以请放轻松！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-07T02:08:42.160

你的例子确实不能显示关闭的力量。看看这个：

```
function makeAdder(add1){
    return function(add2){
       return add1 + add2;
    };
}

// add10 is a function which increments the input by 10(that's the closure's magic)
var add10 = makeAdder(10);

add10(12); // returns 22
add10(9); // returns 19 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T02:11:31.933

虽然@HuiZheng 的回答是正确的，但这里有一个更简单的闭包用例：

```
var getUniqueID = (function () {
    var counter = 0;

    return function () {
        return counter++;
    };
}());

getUniqueID(); // 0
getUniqueID(); // 1
getUniqueID(); // 2 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T02:11:23.933

say 没有在 sayName 函数之外被引用。“alert”是从 sayName 函数内部调用的，因此仍在 sayName 的范围内。

闭包是一个函数引用，即使在外部函数已从调用堆栈中删除后，它仍然保持外部函数变量处于活动状态

# html - IE 过滤器不会显示在重复的元素文本上

> ID：14188917
> 
> 赞同：0
> 
> 时间：2013-01-07T02:03:05.110
> 
> 标签：html, css, internet-explorer

几天来，我一直在苦苦寻找为什么我不能使用 MS 模糊和发光滤镜在 Internet Explorer 中生成出现在此页面上的阴影：

[http://kilianvalkhof.com/uploads/ieshadow.html](http://kilianvalkhof.com/uploads/ieshadow.html)

在这里，第二个文本元素位于第一个元素的下方，偏移了一点，并应用了过滤器。我的布局使用相同的技术，在顶部的 H1 元素上放置阴影，这在符合标准的浏览器中显示良好，但过滤后的元素未在 IE8 或 IE9 中显示：

[http://a11.cosd.com](http://a11.cosd.com)

我的标记使用了`<span>`类似的工作示例：

```
<h1>AREA11<span class="IEshadow">AREA11</span></h1> 
```

与 CSS 相同，除了选择器：

```
#headerContainer header h1 span.IEshadow {
  display: none;
}
.lt-ie10 #headerContainer header h1 span.IEshadow {
  display: block;
  position: absolute;
  left: -4px;
  top: -4px;
  z-index: -1;
  zoom: 1;
  filter: progid:DXImageTransform.Microsoft.Glow(Color=#000000,Strength=2) progid:DXImageTransform.Microsoft.blur(pixelradius=5,enabled='true');
  -ms-filter: "progid:DXImageTransform.Microsoft.Glow(Color=#000000,Strength=2) progid:DXImageTransform.Microsoft.blur(pixelradius=5,enabled='true')";
} 
```

但是在我的布局中，过滤器根本没有应用，即使我可以看到`filter:`属性列在 IE8 和 IE9 中，使用 (F12) 开发人员工具***。***这不是我第一次在设计中使用视觉过滤器，但在这种情况下，我逐个字符地复制了代码。

一件奇怪的事情：当我`filter:`在 IE8 开发人员工具中查看该属性时，它显示其他属性集中在同一行，尽管它们在 IE9 中正常显示，但问题仍然存在。

我已经尝试了我能想象到的一切，包括禁用页面中的所有其他 Javascript，简化标记和 CSS，以及避免`font-face`和`<span>`在工作示例中放入 IE 条件注释......没有变化。（我需要避免 IE 条件注释才能最终在 jQuery 中实现。）

关于为什么 MS 过滤器在这种情况下不起作用，我必须在这里遗漏一些非常基本的东西。如果我的布局在测试过程中发生变化，我绝对会在这里总结任何进展和发现。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T03:19:48.467

这是一个`z-index`问题。位于`.IEshadow`背景后面。

给你10`h1`分`z-index`，它应该可以工作。

```
#headerContainer header h1 {
    ...
    z-index: 10;
} 
```

您可能还想更改颜色`.IEshadow`

```
.lt-ie10 #headerContainer header h1 span.IEshadow {
    ...
    color: #000000;
    ...
} 
```

# java - 程序滚动时图片没有变化

> ID：14188918
> 
> 赞同：0
> 
> 时间：2013-01-07T02:03:28.787
> 
> 标签：java, eclipse, blackberry, blackberry-eclipse-plugin

我正在做一个程序，很简单。您只需在提供的字段中输入一个人的姓名。单击搜索，它会搜索数据库并检索信息。包括图片。这工作正常，但我有一个问题。如果我使用彼得进行搜索并且数据库中有两个“彼得”。当我滚动。除非我单击图片字段，否则图片不会更改。我相信我发布了相关代码。任何帮助将不胜感激。谢谢

```
public class DriverSearchResultScreen extends MainScreen implements FieldChangeListener{
    LabelField header,title;

    LabelField lblLicenseNumber,lblFirstName,lblLastName,lblBirthDate,lblLicenseExpiry,lblLicenseType,lblLicenseStatus;

    ColoredMultiLineLabelField clblLicenseNumber,clblFirstName,clblLastName,clblBirthDate,clblLicenseExpiry,clblLicenseType,clblLicenseStatus;

    CustomButtonField btnSearch;

    CustomImageButton btnLeft,btnRight;

    CustomImageButton bmpfDriverPhoto;

    Vector licenseInfoData;

    int currentIndex = 0;

    public DriverSearchResultScreen(Vector licenseInfoData ) {

        this.licenseInfoData = licenseInfoData;
        // TODO Auto-generated constructor stub
        title = new LabelField("License",LabelField.USE_ALL_WIDTH);
        /*header.setBackground(bg);*/
        setTitle(title);

        bmpfDriverPhoto = new CustomImageButton(Bitmap.getBitmapResource("default-profile.png")){
            public boolean isFocusable() { return true; };
        };
        bmpfDriverPhoto.setChangeListener(this);
        add(bmpfDriverPhoto);

        header = new LabelField("",LabelField.FIELD_HCENTER|LabelField.USE_ALL_WIDTH){
                public void paint(Graphics g){
                    int col = g.getColor();
                    g.setColor(Color.YELLOW);
                    super.paint(g);
                    g.setColor(col);
                }
                public int getPreferredWidth(){
                    return net.rim.device.api.system.Display.getWidth();
                }
            };
        this.getMainManager().setBackground(BackgroundFactory.createBitmapBackground(Bitmap.getBitmapResource("background.png")));
        header.setFont(Font.getDefault().derive(Font.SANS_SERIF_STYLE|Font.BOLD,25));

        add(header);
        add(new SeparatorField());

        Bitmap vfmBackground = Bitmap.getBitmapResource("rounded-border.png");
        VerticalFieldManager vfm = new VerticalFieldManager();
        vfm.setBorder(BorderFactory.createBitmapBorder(new XYEdges(12,12,12,12),vfmBackground));

        BHorizontalFieldManager hfm = new BHorizontalFieldManager();
        lblFirstName= new LabelField("First Name :");
        hfm.add(lblFirstName);
        clblFirstName = new ColoredMultiLineLabelField("Jhon",Color.GRAY);
        hfm.add(clblFirstName);
        vfm.add(hfm);
        vfm.add(new SeparatorField());

        BHorizontalFieldManager hfm1 = new BHorizontalFieldManager();

        lblLastName= new LabelField("Last Name :");
        hfm1.add(lblLastName);
        clblLastName = new ColoredMultiLineLabelField("Doe",Color.GRAY);
        hfm1.add(clblLastName);
        vfm.add(hfm1);
        vfm.add(new SeparatorField());

        BHorizontalFieldManager hfm2 = new BHorizontalFieldManager();

        lblBirthDate = new LabelField("Date Of Birth:");
        hfm2.add(lblBirthDate);
        clblBirthDate = new ColoredMultiLineLabelField("11-June-1982",Color.GRAY);
        hfm2.add(clblBirthDate);
        vfm.add(hfm2);
        vfm.add(new SeparatorField());

        BHorizontalFieldManager hfm3 = new BHorizontalFieldManager();

        lblLicenseNumber = new LabelField("License Number :");
        hfm3.add(lblLicenseNumber);
        clblLicenseNumber = new ColoredMultiLineLabelField("999999",Color.GRAY);
        hfm3.add(clblLicenseNumber);
        vfm.add(hfm3);
        vfm.add(new SeparatorField());

        BHorizontalFieldManager hfm4 = new BHorizontalFieldManager();

        lblLicenseType = new LabelField("License Type :");
        hfm4.add(lblLicenseType);
        clblLicenseType = new ColoredMultiLineLabelField("B",Color.GRAY);
        hfm4.add(clblLicenseType);
        vfm.add(hfm4);
        vfm.add(new SeparatorField());

        BHorizontalFieldManager hfm5 = new BHorizontalFieldManager();

        lblLicenseExpiry = new LabelField("Expiry Date:");
        hfm5.add(lblLicenseExpiry);
        clblLicenseExpiry = new ColoredMultiLineLabelField("25-Aug-2012",Color.GRAY);
        hfm5.add(clblLicenseExpiry);
        vfm.add(hfm5);
        vfm.add(new SeparatorField());

        BHorizontalFieldManager hfm6 = new BHorizontalFieldManager();

        lblLicenseStatus = new LabelField("Licenes Status:");
        hfm6.add(lblLicenseStatus);
        clblLicenseStatus = new ColoredMultiLineLabelField("Expired",Color.GRAY);
        hfm6.add(clblLicenseStatus);
        vfm.add(hfm6);
        vfm.add(new SeparatorField());

        add(vfm);

        btnLeft = new CustomImageButton(Bitmap.getBitmapResource("left-arrow-enable.png"),Bitmap.getBitmapResource("left-arrow-disable.png"));
        btnRight= new CustomImageButton(Bitmap.getBitmapResource("right-arrow-enable.png"),Bitmap.getBitmapResource("right-arrow-disable.png"));;

        HorizontalFieldManager arrowButtonHfm = new HorizontalFieldManager(){

            public int getPreferredHeight() {
                // TODO Auto-generated method stub
                return btnLeft.getPreferredHeight()*2;
            }

            public int getPreferredWidth() {
                // TODO Auto-generated method stub
                return Display.getWidth();
            }

            protected void sublayout(int maxWidth, int maxHeight) {
                // TODO Auto-generated method stub
                int count = getFieldCount();
                for(int i = 0 ; i < count ; i++ ){
                    Field f = getField(i);

                    if(f == btnLeft ){
                        setPositionChild(f, (getPreferredWidth() >> 1) - f.getPreferredWidth() - 30, getPreferredHeight()>>1);
                    }else if (f == btnRight ){
                        setPositionChild(f, (getPreferredWidth() >> 1) + 30, getPreferredHeight()>>1);
                    }
                    layoutChild(f, getPreferredWidth(), getPreferredHeight());
                }
                setExtent(getPreferredWidth(),getPreferredHeight());
            }

            public void subpaint(Graphics graphics){
                int count = getFieldCount();
                for(int i = 0 ; i < count ; i++ ){
                    net.rim.device.api.ui.Field f = getField(i);
                    paintChild(graphics,f);
                }
            }

        };

        /*add(new LabelField(){
            public int getPreferredHeight() {
                return 10;
            }
         });*/
        btnLeft.setChangeListener(this);
        btnRight.setChangeListener(this);
        btnLeft.setEnabled(false);
        arrowButtonHfm.add(btnLeft);
        arrowButtonHfm.add(btnRight);
        add(arrowButtonHfm);
        fillLicenseHolderInfoToField((LicenseObject)licenseInfoData.elementAt(currentIndex));
        setHeaderText();
        enableDisableButtons();
    }

    private void setHeaderText(){
        header.setText("Search Results. ( "+(currentIndex+1)+ " of "+ (licenseInfoData.size())+" )");
    }

     private void fillLicenseHolderInfoToField(LicenseObject licenseObject){
        bmpfDriverPhoto.setImage(licenseObject.getBmpImage());
        clblLicenseNumber.setText(licenseObject.getLicenseNum());
        clblFirstName.setText(licenseObject.getFirstName());
        clblLastName.setText(licenseObject.getLastName());
        clblBirthDate.setText(licenseObject.getDateOfBirth());
        clblLicenseExpiry.setText(licenseObject.getDateOfExpiry());
        clblLicenseType.setText(licenseObject.getLicenseType());
        clblLicenseStatus.setText(licenseObject.getLicenseStatus());
    }

    public void fieldChanged(Field field, int context) {
        // TODO Auto-generated method stub
        if(field == btnRight){

            if( currentIndex < (licenseInfoData.size() - 1)){
                currentIndex++;
                fillLicenseHolderInfoToField((LicenseObject)licenseInfoData.elementAt(currentIndex));
            }
        }else if(field == btnLeft){
            if( currentIndex > 0 ){
                currentIndex--;
                fillLicenseHolderInfoToField((LicenseObject)licenseInfoData.elementAt(currentIndex));
            }
        }else if( field == bmpfDriverPhoto ){
            ImagePopDialog dialog = new ImagePopDialog("loader-image-box.png");
            Bitmap scaledBitmap = new Bitmap(300, 300);
            Bitmap btnBitmap    = bmpfDriverPhoto.getImage();
            btnBitmap.scaleInto(0, 0, btnBitmap.getWidth(), btnBitmap.getHeight(),
                        scaledBitmap, 0, 0, scaledBitmap.getWidth(), scaledBitmap.getHeight(), 1);
            dialog.add(scaledBitmap);
            UiApplication.getUiApplication().pushScreen(dialog);

        }

        enableDisableButtons();
        setHeaderText();
    }

    private void enableDisableButtons(){
        btnLeft.setEnabled((currentIndex > 0)?true:false);
        btnRight.setEnabled((currentIndex < (licenseInfoData.size() - 1))?true:false);
    }
    protected boolean onSavePrompt() {
        // TODO Auto-generated method stub
        return true;
    }
} 
```

//自定义图片按钮

```
package com.app.ui.component;

import net.rim.device.api.system.Bitmap;
import net.rim.device.api.system.Display;
import net.rim.device.api.ui.Color;
import net.rim.device.api.ui.Field;
import net.rim.device.api.ui.Graphics;
import net.rim.device.api.ui.TouchEvent;

/**
 * * 
 * Class to Draw an Image Button
 */
public class CustomImageButton extends Field {

/** Bitmap for enabled image */
private Bitmap bmpEnabled;

/** Bitmap for disabled image */
private Bitmap bmpDisabled;

/** Label for Button*/
private String label;

private boolean mEnabled=true;

private int mCurrentTouchX = 0;

private int mCurrentTouchY = 0;

/**
 * Constructor with
 * @param image
 */
public CustomImageButton(Bitmap image) {
    super(Field.FOCUSABLE);
    this.bmpEnabled = image;
}

/**
 * Constructor with
 * @param enabled
 * @param disabled
 */
public CustomImageButton(Bitmap enabled,Bitmap disabled) {
    this(enabled);
    this.bmpDisabled = disabled;
}

public CustomImageButton(Bitmap enabled, Bitmap disabled, String label) {
    this(enabled);
    this.bmpDisabled = disabled;
    this.label = label;
}

protected void layout(int height, int width) {
    height = getPreferredHeight();
    width = getPreferredWidth();
    setExtent(width,height);

}

protected void paint(Graphics graphics) {
    if( isEnabled() ){
        if(isFocus()){
            int col = graphics.getColor();
            graphics.setColor(Color.WHITE);
            graphics.fillRect(0, 0, getPreferredHeight(), getPreferredHeight());
            graphics.setColor(col);
        }
        graphics.drawBitmap(5, 5, bmpEnabled.getWidth(), bmpEnabled.getHeight(), bmpEnabled,
            0, 0);          
        if(label != null && !label.equals("")) {
            graphics.setColor(Color.BLACK);
            graphics.drawText(label, bmpEnabled.getWidth()+5, (getPreferredHeight() - getFont().getHeight())/2);
        }
    }else{
        if( bmpDisabled != null )
            graphics.drawBitmap(5, 5, bmpDisabled.getWidth(), bmpDisabled.getHeight(), bmpDisabled,
                    0, 0);
        if(label != null && !label.equals("")) {
            graphics.setColor(Color.LIGHTGRAY);
            graphics.drawText(label, bmpEnabled.getWidth()+5, (getPreferredHeight() - getFont().getHeight())/2);
        }
    }
}

public int getPreferredWidth() {
    int prefwidth = 0;
    if(bmpEnabled != null) {    
        prefwidth =  bmpEnabled.getWidth(); 
    }   

    if(label != null && !label.equals("")) {    
        prefwidth = Display.getWidth()+10;
    }

    return (prefwidth+10);
}

public int getPreferredHeight() {
    if(bmpEnabled != null) {
        return bmpEnabled.getHeight()+10;
    }
    return 0;

}

/*protected boolean navigationClick(int status, int time) {
    fieldChangeNotify(0);
    return true;
}*/

/**
 * To set the focused background color and invalidating the entire screen
 */
protected void onFocus(int direction) {
    invalidate();
}

/**
 * To set the unfocused background color and invalidating the entire screen
 */
protected void onUnfocus() {
    invalidate();
}

/**
 * Draws the focus indicator for this field. 
 * @param graphics
 * @param on
 */
protected void drawFocus(Graphics graphics, boolean on) {
    super.drawFocus(graphics, on);
}

protected boolean navigationClick(int status, int time){
    if( mEnabled ){
        if (mCurrentTouchX >= 0 && mCurrentTouchX <= getPreferredWidth()
                && mCurrentTouchY >= 0
                && mCurrentTouchY <= getPreferredHeight())
            fieldChangeNotify(1);

        mCurrentTouchX = 0;
        mCurrentTouchY = 0;
        return true;
    }else{
        return false;
    }
}

protected boolean touchEvent(TouchEvent message) {
    if (mEnabled) {
        if (message.getEvent() == TouchEvent.CLICK) {
            mCurrentTouchX = message.getX(1);
            mCurrentTouchY = message.getY(1);
        }
    }
    return super.touchEvent(message);
}

public void setEnabled(boolean enabled) {
    // TODO Auto-generated method stub
    super.setEnabled(enabled);
    if(!enabled)
        this.focusRemove();
}

public void setImage(Bitmap image){
    this.bmpEnabled = image;
}

public Bitmap getImage(){
    return this.bmpEnabled;
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T15:03:45.197

In your `CustomImageButton` class you should change your setImage method:

```
public void setImage(Bitmap image){
    this.bmpEnabled = image;
} 
```

by adding an invalidate to cause a redraw:

```
public void setImage(Bitmap image){
    this.bmpEnabled = image;
    invalidate();
} 
```

The problem is that when your image is replaced, the change isn't seen on screen until the screen has been refreshed. `invalidate()` triggers a refresh of the screen(or layout), allowing any updates to be seen.

When you scroll or select the image, the `invalidate()` method is getting called so as the screen refreshes, which is why it isn't updating until then. A manual trigger of `invalidate()` solves this problem.

Make sure you are doing it on the Event Thread.

# django - django 模板中的 URL 模式处理 url arg 中的空间

> ID：14188921
> 
> 赞同：1
> 
> 时间：2013-01-07T02:04:02.540
> 
> 标签：django

我在以下代码行中遇到了一个问题，它通过了一个带有空格的争论。

```
<a href="{% url graph_exercisename exercise_name=e.exercisename|slugify %}" class="button" >Graph</a> 
```

当我从 html 文件中剪切上面的代码时，页面编译得很好。当一个没有空格的 arg 传递给 exercise_name 时，它​​也会编译。

这是我的网址模式

```
urlpatterns = patterns('',
url('^exercises/(\d{1,6})/$', exercises,name='displayexercises'),
url('^workouts/$',workouts,name="displayworkouts"),
url('^graph/$',bodyweight_graph), 
url('^graph/(?P<exercise_name>\w+)/$',graph_exercisename,name="graph_exercisename"), 
) 
```

最后是视图：

```
def graph_exercisename(request,exercise_name):
    exercise_name = exercise_name.replace('-'," ").title()

    exercises = Exercise.objects.filter(workout__user=request.user.id).filter(exercisename = exercise_name)
    exercises = exercises.order_by('workout__workoutdate')[:10]
    values = Rep_Table(exercises).table

    return render(request,'graph.html',{'values':values}) 
```

更奇怪的是，Django 根本没有在错误页面上给我任何代码，它只是说明 Django 遇到了错误。

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T05:36:42.787

请更改您的网址条目：

```
url('^graph/(?P<exercise_name>\w+)/$',graph_exercisename,name="graph_exercisename"), 
```

至：

```
url('^graph/(?P<exercise_name>[^/]+)/$',graph_exercisename,name="graph_exercisename"), 
```

# python - 如何使用 Python 将一行 Excel 工作表复制到另一个工作表

> ID：14188923
> 
> 赞同：3
> 
> 时间：2013-01-07T02:04:24.763
> 
> 标签：python, excel, xlrd, xlwt, openpyxl

我想将每一行的给定列的值与另一个值进行比较，如果值相等，我想将整行复制到另一个电子表格。

如何使用 Python 做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T02:10:56.540

请参考python excel库`xlrd`（用于excel阅读）/ `xlwt`（用于excel写作） [http://www.python-excel.org/](http://www.python-excel.org/)

例如（阅读）（[从此](http://www.pythonclub.org/python-files/excel)）：

```
import xlrd

fname = "sample.xls"
bk = xlrd.open_workbook(fname)
shxrange = range(bk.nsheets)
try:
    sh = bk.sheet_by_name("Sheet1")
except:
    print "no sheet in %s named Sheet1" % fname
    return None
nrows = sh.nrows
ncols = sh.ncols
print "nrows %d, ncols %d" % (nrows,ncols)

cell_value = sh.cell_value(1,1)
print cell_value

row_list = []
for i in range(1,nrows):
    row_data = sh.row_values(i)
    row_list.append(row_data) 
```

如果您使用 Excel 2007 处理，请使用`openpyxl`：[http ://packages.python.org/openpyxl/](http://packages.python.org/openpyxl/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-05T08:45:55.317

对于“xls”文件，可以使用 xlutils 包。由于 Excel 格式的结构，目前无法在 openpyxl 中的工作簿之间复制对象：到处都有很多依赖项需要管理。因此，客户端代码有责任手动复制所需的所有内容。如果时间允许，我们可能会尝试将一些 xlutils 功能移植到 openpyxl。

# php - 当（http）使用 Qt 发布时，php $_Files 无法保存文件

> ID：14188924
> 
> 赞同：0
> 
> 时间：2013-01-07T02:04:25.667
> 
> 标签：php, http, post, apache

我正在发布一个带有 Qt 图像的表单（我认为这并不重要）并尝试在服务器中使用相同的图像，但我的 php 文件不断给我以下错误。

***注意：未定义索引：第5*行 C:\wamp\www\fileupload.php 中的图像名**

 *我使用 tcp monitor 来检测消息，它们似乎很好，如下所示。

```
POST /fileupload.php HTTP/1.1
Accept-Encoding: gzip,deflate
Content-Type: multipart/form-data; boundary=---------------------------723690991551375881941828858
Content-Length: 467204
Connection: Keep-Alive
Accept-Language: en-US,*
User-Agent: Mozilla/5.0
Host: localhost:8089

-----------------------------723690991551375881941828858
Content-Disposition: form-data; name="imagename"

1.jpg
-----------------------------723690991551375881941828858
Content-Disposition: form-data; name="message"

This is a Test Message
-----------------------------723690991551375881941828858
Content-Disposition: form-data; name="file"; filename="1.jpg"
Content-Type: image/jpg 
```

然后附加到最后的图像内容。我正在使用以下代码将文件保存在服务器上。

```
<?php   
    $userMessage    = $_POST["message"];
    $imagefilename    = $_POST["imagename"];
    echo($userMessage.":".$imagefilename);
    if($_FILES['imagename']['error'] == 0){
         echo("Post is ready");
         move_uploaded_file($_FILES['imagename']['error'], './1.jpg');
    }else{
         echo("ERROR");   
    }

?> 
```

我正在关注以下文档，但我无法让它工作。如果有人可以给我一个解决问题的提示，我将不胜感激。我正在使用 PHP 5.3.18 和 apache 2.22。

[http://www.tizag.com/phpT/fileupload.php](http://www.tizag.com/phpT/fileupload.php)

[http://www.saaraan.com/2012/02/post-picture-to-facebook-user-wall-php](http://www.saaraan.com/2012/02/post-picture-to-facebook-user-wall-php)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T02:06:22.357

您尚未完成多部分请求。添加这个：

--------------------------723690991551375881941828858--

到你的帖子结束。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T02:32:11.287

```
<?php       $userMessage    = $_POST["message"];
echo($userMessage);
move_uploaded_file($_FILES['file']['tmp_name'], "./{$_FILES['file'] ['name']}"); 
?> 
```*

# arrays - F# 排序数组

> ID：14188927
> 
> 赞同：2
> 
> 时间：2013-01-07T02:04:44.390
> 
> 标签：arrays, f#, sorting

我有一个这样的数组，

```
[|{Name = "000016.SZ";
     turnover = 3191591006.0;
     MV = 34462194.8;}; 
  {Name = "000019.SZ";
     turnover = 2316868899.0;
     MV = 18438461.48;}; 
  {Name = "000020.SZ";
     turnover = 1268882399.0;
     MV = 7392964.366;};
  .......
    |] 
```

如何根据“营业额”对该数组进行排序？谢谢（没有太多上下文来解释代码部分？我应该写多少上下文）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-07T02:16:23.423

Assuming that the array is in `arr` you can just do

```
arr |> Array.sortBy (fun t -> t.turnover) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-03-24T14:11:39.950

我知道这已经得到了很好的回答；但是，我发现，像 Haskell 一样，F# 符合我的想法，并认为我会为其他新手添加这个:)

```
let rec sortData = 
  function 
  | [] -> []
  | x :: xs -> 
    let smaller = List.filter (fun e -> e <= x) >> sortData
    let larger = List.filter (fun e -> e > x) >> sortData
    smaller xs @ [ x ] @ larger xs 
```

注 1：“a >> b”是函数组合，意思是“创建一个函数 f，使得 fx = b(a(x))”，如“应用 a 然后应用 b”等等，如果它继续：a >> b >> c >>...

注 2：“@”是列表连接，如 [1..100] = [1..12] @ [13..50] @ [51..89] @ [90..100]。这比 cons 更强大但效率更低， "::" 一次只能添加一个元素，并且只能添加到列表的头部，a::[b;c;d] = [a;b;c ;d]

注 3：List.filter (fun e ->...) 表达式产生一个“柯里化函数”版本，包含提供的过滤 lambda。

注 4：我可以制作“更小”和“更大”的列表而不是函数（如“xs |> filter |> sort”）。我选择让它们发挥作用是任意的。

注 5：sortData 函数的类型签名声明它需要并返回一个列表，其元素支持比较：

```
_arg1:'a list -> 'a list when 'a : comparison 
```

注6：简洁明了（尽管有这个特殊的帖子:)）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-04T19:17:51.813

作为函数式语言算法清晰性的证明，上述过滤器排序的以下优化速度提高了三倍（由 VS Test Explorer 报告）。在这种情况下，每个枢轴（第一个元素）仅遍历列表一次，以生成较小和较大项目的子列表。此外，还引入了一个等价列表，该列表收集匹配元素以防止进一步比较。

```
let rec sort3 =
  function
  | [] -> []
  | x::xs ->
      let accum tot y =
        match tot with
        | (a,b,c) when y < x -> (y::a,b,c)
        | (a,b,c) when y = x -> (a,y::b,c)
        | (a,b,c) -> (a,b,y::c)
      let (a,b,c) = List.fold accum ([],[x],[]) xs
      (sort3 a) @ b @ (sort3 c) 
```

# visual-c++ - C++ 中的光标位置 GetCursorPos() 返回链接错误

> ID：14188931
> 
> 赞同：2
> 
> 时间：2013-01-07T02:05:13.937
> 
> 标签：visual-c++, linker, cursor, c++-cli

试图让它工作使用 VisualStudio VC++ 我试图检测光标的位置，同时获取 x 和 y 并将其用于东西，但无论如何 - 会发生链接错误。

```
public: System::Void pictureDrag_MouseDown(System::Object^  sender, System::Windows::Forms::MouseEventArgs^  e) {
            POINT coord;
            GetCursorPos(&coord);
            int xx = coord.x, yy = coord.y;
            pictureBox2->Location = Drawing::Point(xx, yy); 
        } 
```

给我这两个链接错误

```
Stuff.obj : error LNK2028: unresolved token (0A000011) "extern "C" int __stdcall GetCursorPos(struct tagPOINT *)" (?GetCursorPos@@$$J14YGHPAUtagPOINT@@@Z) referenced in function "public: void __clrcall Stuff::Form1::pictureDrag_MouseDown(class System::Object ^,class System::Windows::Forms::MouseEventArgs ^)" (?pictureDrag_MouseDown@Form1@Stuff@@$$FQ$AAMXP$AAVObject@System@@P$AAVMouseEventArgs@Forms@Windows@4@@Z)
Stuff.obj : error LNK2019: unresolved external symbol "extern "C" int __stdcall GetCursorPos(struct tagPOINT *)" (?GetCursorPos@@$$J14YGHPAUtagPOINT@@@Z) referenced in function "public: void __clrcall Stuff::Form1::pictureDrag_MouseDown(class System::Object ^,class System::Windows::Forms::MouseEventArgs ^)" (?pictureDrag_MouseDown@Form1@Stuff@@$$FQ$AAMXP$AAVObject@System@@P$AAVMouseEventArgs@Forms@Windows@4@@Z) 
```

请注意，开头有一个#include，我也尝试将 user32.lib 包含到项目中，但根本没有结果。代码本身非常简单，错过了一些重要的东西，这看起来像是我忘记了包含一些东西，但就是不知道是什么。我是 C++ 的新手，我们很快就要分手了！一旦我弄清楚这个。

向世界寻求帮助，再也受不了了。请帮助一个白痴！

# ruby-on-rails - 通过模型在自己的命名空间中创建多个连接器？

> ID：14188932
> 
> 赞同：0
> 
> 时间：2013-01-07T02:05:17.270
> 
> 标签：ruby-on-rails, ruby, connection, models

我有一个使用 ZendFramework 用 PHP 编写的应用程序，其中包含一个“连接”库，例如 MySQL、CSV、Twitter 等。

如果用户注册，他们可以连接到任何数据源，比如他们选择 MySQL 连接器和 Twitter 连接器。

根据他们在我的 UI 中输入的详细信息，我将连接到这些数据源并检索他们要求的数据。

我希望在 Ruby on Rails 中进行设置，但我不确定如何设置。基本上我想要的是：

```
@twitter_connection = Twitter.somefunction 
@mysql_connection = Mysql.somefunction 
```

上面的 Twitter 和 MySQL 模型将位于它们自己的命名空间中。我在我的应用程序中将其称为“连接”。我可以在 Rails 中有一个类似的命名空间并将所有连接模型存储在`/app/connections`文件夹中吗，所以它是：

```
/app/connections/mysql.rb
/app/connections/twitter.rb 
```

然后，在这些模型中，我会建立适当的连接，无论是连接到 MySQL，还是连接到 Twitter 之类的 API。无论哪种方式，模型都会连接到源并返回我需要的任何数据。

那可能吗？

//从评论编辑

我在“/app/connection/classname.rb”下有一堂课

文件内容为：

```
class Classname
   def function
   end
end 
```

如何在控制器中访问此类。

`@variable = Classname.function`不起作用。

# ruby-on-rails-3.2 - 强制链轮在测试期间编译资产

> ID：14188937
> 
> 赞同：3
> 
> 时间：2013-01-07T02:06:05.697
> 
> 标签：ruby-on-rails-3.2, asset-pipeline, sprockets

我有一个自定义链轮引擎和一个测试（rspec）。规范访问 /assets/application.js 然后检查内容。我想强制 spocket 在测试时编译（或渲染）资产，而不是从 tmp/cache 或它可能已经编译的任何其他地方提取它。

我该怎么做？我在 sprockets 代码中没有看到任何明显的“忽略缓存”。

提前谢谢你，佩里

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T20:38:10.263

也许将 a 设置`null_store`为缓存后端比`tmp`每次都清除文件夹要好。在您的测试设置上尝试这样的事情（在应用程序初始化之后）：

```
Rails.application.assets.cache = ActiveSupport::Cache.lookup_store(:null_store) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T00:53:02.897

我最终这样做了：

```
before(:each) do
  (Rails.root + "tmp/cache").rmtree
end 
```

按照建议，我的代码现在是这样的：

```
before(:each) do
  @original_cache = Rails.application.assets.cache
  Rails.application.assets.cache = ActiveSupport::Cache.lookup_store(:null_store)
end

after(:each) do
  Rails.application.assets.cache = @original_cache
end 
```

# .net - .NET HttpWebRequest oAuth 401 未经授权

> ID：14188938
> 
> 赞同：0
> 
> 时间：2013-01-07T02:06:05.637
> 
> 标签：.net, vb.net, oauth, httpwebrequest, authorization

我需要使用 VB.NET 应用程序中的 Web 资源。我已成功检索到访问令牌并准备使用它来调用受保护的资源。但是，每次我调用受保护的资源时，我都会收到 401 Unauthorized 响应，因为 Authorization 字段尚未添加到标头中。

这是我的代码。

```
WebRequest = DirectCast(Net.WebRequest.Create(ApiUri), HttpWebRequest)
WebRequest.Method = "POST"
WebRequest.ContentType = "application/json"
WebRequest.ContentLength = Bytes.Length
Dim RequestStream As IO.Stream = WebRequest.GetRequestStream
RequestStream.Write(Bytes, 0, Bytes.Length)
RequestStream.Close()
WebRequest.Headers("Authorization") = "OAuth " & _
                                      "oauth_version=""1.0""," & _
                                      "oauth_nonce=""" & Nonce & """," & _
                                      "oauth_timestamp=""" & TimeStamp & """," & _
                                      "oauth_consumer_key=""" & ConsumerKey & """," & _
                                      "oauth_token=""" & Token & """," & _
                                      "oauth_signature_method=""HMAC-SHA1""," & _
                                      "oauth_signature=""" & Signature & """"
WebResponse = DirectCast(WebRequest.GetResponse(), HttpWebResponse) 
```

然后我使用 Fiddler 监控请求。我在 Fiddler 中看到的只是带有 401 响应的请求，如下所示（不包括正文）。

要求

```
POST ***url*** HTTP/1.0
Content-Type: application/json
Host: ***host***
Content-Length: 45
Connection: Keep-Alive 
```

回复

```
HTTP/1.0 401 Unauthorized
X-Powered-By: PHP/5.3.13
WWW-Authenticate: Basic realm="***realm***"
Content-type: application/json
Content-Length: 79
Connection: keep-alive
Date: Mon, 07 Jan 2013 01:13:22 GMT
Server: lighttpd/1.4.28 
```

我在互联网上读到的所有地方都表明 HttpWebRequest 应该首先挑战服务器并收到 401 响应，正如我在这里看到的那样。然后它应该再次尝试将 Authorization 字段添加到标头并获得 200 OK 响应。这第二部分不会发生。我不明白这是如何正常工作的，还是我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T06:37:42.837

原来你需要使用 BinaryWriter 添加内容，而不是 Stream。

所以代替这个。

```
WebRequest.ContentLength = Bytes.Length
Dim RequestStream As IO.Stream = WebRequest.GetRequestStream
RequestStream.Write(Bytes, 0, Bytes.Length)
RequestStream.Close() 
```

做这个。

```
Using Writer As New IO.BinaryWriter(WebRequest.GetRequestStream)
    Writer.Write(Bytes)
End Using 
```

# facebook - 使用 fbgraph 终止 node.js 的 Facebook 会话

> ID：14188941
> 
> 赞同：0
> 
> 时间：2013-01-07T02:06:36.780
> 
> 标签：facebook, node.js, fb-graph

我正在创建一个使用 facebook 授权的应用程序。我正在使用 facebook api 页面上建议的 fbgraph api。但是，我目前无法找到使用 api 结束 facebook 会话的方法。

# iphone - 为 UITableView 创建部分索引标题的性能问题

> ID：14188945
> 
> 赞同：0
> 
> 时间：2013-01-07T02:07:13.983
> 
> 标签：iphone, ios, uitableview

我在表格视图中显示一组联系人（ [[ContactStore sharedStore]allContacts] ），并将列表划分为字母部分。我使用以下代码返回联系人首字母的数组，以及每个字母条目数的字典。

```
 //create an array of the first letters of the names in the sharedStore
nameIndex = [[NSMutableArray alloc] init];

//create a dictionary to save the number of names for each first letter
nameIndexCount = [[NSMutableDictionary alloc]init];

for (int i=0; i<[[[ContactStore sharedStore]allContacts]count]; i++){

//Get the first letter and the name of each person
    Contact *p = [[[ContactStore sharedStore]allContacts]objectAtIndex:i];
    NSString *lastName = [p lastName];
    NSString *alphabet = [lastName substringToIndex:1];

    //If that letter is absent from the dictionary then add it and set its value as 1 
    if ([nameIndexCount objectForKey:alphabet] == nil) {
        [nameIndex addObject:alphabet];
        [nameIndexCount setValue:@"1" forKey:alphabet];
    //If its already present add one to its value
    } else {

        NSString *newValue = [NSString stringWithFormat:@"%d", ([[nameIndexCount valueForKey:alphabet] intValue] + 1)];

        [nameIndexCount setValue:newValue forKey:alphabet];
    }
} 
```

这可行，但是当数组很大时它非常慢，我确信有更好的方法可以做到这一点，但我对此很陌生，所以不知道如何。有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T02:42:31.827

尽管 Bio Cho 有一个很好的观点，但您可能会看到通过调用

```
[[ContactStore sharedStore]allContacts] 
```

只有一次。例如：

```
nameIndex = [[NSMutableArray alloc] init];
nameIndexCount = [[NSMutableDictionary alloc] init];

/*
 Create our own copy of the contacts only once and reuse it
 */
NSArray* allContacts = [[ContactStore sharedStore] allContacts];

for (int i=0; i<[allContacts count]; i++){
    //Get the first letter and the name of each person
    Contact *p = allContacts[i];
    NSString *lastName = [p lastName];
    NSString *alphabet = [lastName substringToIndex:1];

    //If that letter is absent from the dictionary then add it and set its value as 1 
    if ([nameIndexCount objectForKey:alphabet] == nil) {
        [nameIndex addObject:alphabet];
        [nameIndexCount setValue:@"1" forKey:alphabet];
    //If its already present add one to its value
    } else {
        NSString *newValue = [NSString stringWithFormat:@"%d", ([[nameIndexCount 
            valueForKey:alphabet] intValue] + 1)];

        [nameIndexCount setValue:newValue forKey:alphabet];
    }
} 
```

虽然我不能肯定地说，但我猜反复访问您的共享商店是杀死您的原因。也许只访问一次就会给你你需要的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T02:30:36.443

考虑将联系人存储在 Core Data 中并使用 NSFetchedResultsController。

NSFetchedResultsController 只会加载表格视图中可见的行的子集，从而防止您的用户必须等待所有联系人被排序。

NSFetchedResultsController 还将按属性（即名字或姓氏）对您的联系人进行排序，并且您可以将部分标题设置为您正在排序的字段的第一个字母。

看看这个[问题](https://stackoverflow.com/questions/1741093/how-to-use-the-first-character-as-a-section-name)和这个[教程](http://www.raywenderlich.com/999/core-data-tutorial-how-to-use-nsfetchedresultscontroller)。

# svn - Tortoise SVN 合并 2 个分支（获取所有修订版）

> ID：14188946
> 
> 赞同：1
> 
> 时间：2013-01-07T02:07:17.990
> 
> 标签：svn, version-control, merge, tortoisesvn

我正在使用 Tortoise SVN 客户端与我的存储库进行通信。这就是我对合并感到困惑的地方。合并到最新版本时，是否所有以前的版本都随着合并而结转？

这是我通过合并完成的步骤。

1.  在 tortoise svn 菜单上，我选择了“合并”。
2.  选择“合并一系列修订”作为合并类型。点击下一步。
3.  在“要合并的修订范围”框中，单击“显示日志”按钮，然后出现修订列表。
4.  从包含修订列表的弹出窗口中，我选择/检查了最新的修订。点击确定

使用tortoise svn客户端合并两个分支是否正确？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T08:45:33.013

简短的回答 -**否**

*   合并时，合并**树的历史**，而不是修订本身
*   当您仅明确选择了*一些修订*（“合并自”中的最新版本是选择范围的边缘情况）时，仅合并选定的修订更改
*   使用具有合并跟踪（1.5+）的 SVN 客户端，您不必担心选择源范围（除非您知道，您这样做的情况除外）并将范围留空 - 来自源分支的所有修订（这是'之前没有合并）将被合并到目标

假设您想要合并从 A 到 B 的所有独特更改的良好（​​正确）工作流程

1.  拥有 B 的干净工作副本（没有混合修订，没有本地修改）
2.  选择合并合并范围
3.  要合并的 URL - A-URL
4.  修订范围 - 留空

# java - 动态增加Java程序的内存

> ID：14188948
> 
> 赞同：3
> 
> 时间：2013-01-07T02:07:39.047
> 
> 标签：java, memory-management

> **可能重复：**
> [在运行时设置 JVM 堆大小](https://stackoverflow.com/questions/763295/setting-jvm-heap-size-at-runtime)

`OutOfMemoryError`是否可以通过增加程序允许的内存来防止程序在遇到 a 时崩溃？
可以在运行时完成吗？

## 增加内存的原因

我正在谈论很多屏幕截图`java.awt.Robot`，但一段时间后，我的 Vector 内存不足。60岁`BufferedImage` 就出局了。
所以 1280 x 800 分辨率、3 字节 RGB`BufferedImage`和 60 张图像之后，矢量就出来了。
所以我猜消耗的内存是
1280 x 800 x 60 x 3 =**做数学**字节

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T02:13:39.610

简短的回答 - 不。或者至少，不使用 Hotspot JVM。

参考：

*   [在运行时设置 JVM 堆大小](https://stackoverflow.com/questions/763295/setting-jvm-heap-size-at-runtime)
*   [为什么我们要增加Java Heap？](https://stackoverflow.com/questions/852781/why-do-we-have-to-increase-the-java-heap)...其中的答案解释了为什么没有简单的解决方案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-07T02:16:34.970

Ok well you can't actually increase the heapsize, but you could spawn another process with a new heapsize. Have a play with this:

```
 public class SpawnAndChangeHeap {
     public static void main(String[] args){  

         //Get the jvm heap size.  
        long heapSize = Runtime.getRuntime().totalMemory();
    JOptionPane.showMessageDialog(null, "" + heapSize );  

    if(args.length > 0 && args[0].equals("-spawn")) {

        try {
            Process proc;
                proc = Runtime.getRuntime().exec("cmd.exe /c java -Xms32m -Xmx128m SpawnAndChangeHeap /n");
        }
        catch(Exception e) {System.out.println("something went wrong");  }
    }
    System.exit(0);

     }  
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-07T02:31:07.537

> 我正在谈论很多屏幕截图`java.awt.Robot`，但一段时间后我`Vector`的内存不足。

不要把它们放在一个`Vector`. 根本不需要将它们存储在内存中。

而是将每个图像保存到以下任一位置：

1.  没有压缩的 Zip 存档（这可以创建“1000 个文件” - 这本身就是有问题的）（zip 压缩对图像没有任何好处）。
2.  视频流（指向文件）。有关运行良好的基于​​ JMF 的版本，请参阅[Monte Media Library](http://www.randelshofer.ch/monte/)的 Movie Maker 。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-07T02:17:26.177

You may need to think of other solutions other than dynamically changing memory size including

*   allocating a reasonable amount of memory to start with.
*   decreasing the resolution of your captured images (which is what I did for a similar problem by decreasing image size)
*   caching your images to disk when not immediately needed vs. a combination.

# c++ - cocos2dx 如何通过 xml-content 创建粒子系统

> ID：14188949
> 
> 赞同：0
> 
> 时间：2013-01-07T02:07:41.707
> 
> 标签：c++, xml, cocos2d-x, particle-system

我有一个 xml 字符串（不是 xml 文件）。如何通过这个 xml 字符串创建 cocos2dx 的粒子系统？有人可以帮助我。非常感谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T04:55:29.803

```
CCParticleSystem *pRet = new CCParticleSystem();
if(pRet)
{
    CCDictionary *dict = CCDictionary::createWithContentsOfFileThreadSafe(xmlString.c_str());
    CCAssert( dict != NULL, "Particles: file not found");

    pRet->initWithDictionary(dict);
    dict->release();
    pRet->autorelease();

    this->addChild(pRet,100);
} 
```

希望它会有所帮助:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T05:01:27.850

使用粒子设计器并将粒子系统导出到 plist 文件并使用 Spencer Wong 的方法可能更容易。

# android - 有没有一种简单的方法可以将 excel forumla 转换为 android 应用程序？

> ID：14188950
> 
> 赞同：-2
> 
> 时间：2013-01-07T02:07:52.503
> 
> 标签：android, excel, formula

我对 android 很陌生，但我已经搜索了大约半天的时间来寻找答案，甚至是关于将 excel 公式转换为 android 的想法。我不是在寻找转换器，只是在寻找可以在 android 中获得相同结果的过程。请原谅我缺乏知识，我想学习并希望我能完成这项工作。

我的 excel 公式非常基础，它使用 4 个单元格的值来计算答案，这些值取决于用户输入。其中两个单元格是静态下拉列表，两个是用户输入的数字。我有一个与两个下拉列表相关的数字数据库，它是一堆 IF 语句，例如 IF,(A2="Pizza",C2)。其中C2=数据库中Pizza的预定值。

我的想法是我可以将四个框放在应用程序上，然后操作按钮会将两个微调器与它们的数据库值匹配，将它们和两个数值发送到公式，然后输出答案。

那有意义吗？是否可以？有人可以让我走上正确的道路，以便我进行更多研究吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T03:17:25.623

如果你的程序足够简单，你也许可以使用[App Inventor](http://appinventor.mit.edu/)之类的东西。它的功能有限，但它是为没有高级编程经验的人设计的。

如果这不能解决问题，那么您距离实现既定目标还有很长的路要走。您需要做的第一件事是[学习 Java 的基础知识](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/index.html)（这是 Android 的通用语言）。一旦您能够将您的“excel”逻辑转换为 Java，您就可以[开始组装一个 Android](http://developer.android.com/training/basics/firstapp/index.html)应用程序。Vogella 也有一些[相当不错的教程](http://www.vogella.com/articles/Android/article.html)。

祝你好运。

# nsstring - 比较两个 NSString 并检查拼写错误或缺少字母

> ID：14188958
> 
> 赞同：1
> 
> 时间：2013-01-07T02:09:35.530
> 
> 标签：nsstring, uitextfield, compare, spell-checking

我想比较两个字符串，一个是用户输入到 UITextField 中的，另一个是我存储的（我知道怎么做）。

但是，如果他们将输入的字符串与存储的字符串相比拼写错误，我想通知用户，任何人都可以阐明如何进行这种比较。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T03:42:21.460

[NSString 类参考](http://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html#//apple_ref/doc/uid/TP40003744)的**识别和比较字符串**部分正好提供了方法。请检查。

我相信在您的情况下，以下方法会有所帮助，

1)`isEqualToString:`示例，如果字符串相同则`[string1 isEqualToString:string2]`返回*YES ，否则返回**NO*

2) `caseInsensitiveCompare:`example [string1`caseInsensitiveCompare:string2]`比较字符串，不管它的大小写。返回一个`NSComparisonResult`. 如果是`NSOrderedSame`，则字符串匹配，否则不匹配。

3) `compare:options:`example`[string1 compare:string2 options:NSDiacriticInsensitiveSearch]`比较字符串，with `options`to compare 比如 an `NSDiacriticInsensitiveSearch`，其中搜索将 'ö' 和 'o' 等字符视为相同，`NSNumericSearch`其中字符串中的数字使用数值进行比较等等。（参考NSString 类参考的**搜索和比较选项）**

# html - Google Prettify 削减我的代码 - 需要修复

> ID：14188961
> 
> 赞同：1
> 
> 时间：2013-01-07T02:10:16.603
> 
> 标签：html, css, prettify, google-code-prettify

目前我的代码在 for 循环中的 < 处被截断，因为浏览器将其视为标签，有人对此有修复吗？：

```
<pre class="prettyprint">
int count_simd(char *arr, int len, char key) {
    int count = 0;
    __m128i sixteenValues = _mm_setzero_si128();
    __m128i result = _mm_setzero_si128();
    __m128i keyV = _mm_set1_epi8(key);
    for(int j=0; j < len/16*16; j+=16){
    sixteenValues =_mm_load_si128((__m128i*)(arr+j)); 
    result = _mm_sub_epi8(result, _mm_cmpeq_epi8(sixteenValues, keyV));
    }
    for(int i=len/16*16; i<len; i++){
        if(arr[i]==key)
            count++;
    }
    char A[16];
    _mm_store_si128((__m128i*)A, result);
    for(int k=0; k<16; k++){
        count+=*(A+k);
    }
    return count;
}
</pre> 
```

在渲染页面的源代码中，一切都会出现，直到：

```
<len; i++){="" if(arr[i]="=key)" count++;="" }="" char="" a[16];="" _mm_store_si128((__m128i*)a,="" result);="" for(int="" k="0;" k<16;="" k++){="" count+="*(A+k);" return="" count;="" <="" pre=""><span class="pln">
        </span></len;> 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T02:13:17.137

您的 HTML 无效。即使在`<pre>`元素内部`<`，`>`、 和`&`字符也必须分别编码为`&lt;`、`&gt;`和`&amp;`。

# android - 更优雅的方式来恢复 Android Application 子类的状态？

> ID：14188964
> 
> 赞同：3
> 
> 时间：2013-01-07T02:10:19.250
> 
> 标签：android

在我的应用程序中，我扩展了应用程序类以维护与经过身份验证的用户相关的信息。但是，在运行了一些我不允许后台进程的测试后，打开另一个应用程序（从而杀死我的），然后重新打开我的，我注意到这个状态丢失了（变量返回到它们的默认值）。我意识到 Application 类没有任何生命周期回调，除了 onCreate，就像活动一样，我认为这是优雅的解决方案。所以我决定将这些信息写入一个 SharedPreference，以便在需要时可以恢复。这是正确的解决方案，还是有更优雅的解决方案？

相关示例代码供参考：

```
public class ApplicationUser extends Application {

    private static final String PREF_KEY_USER = "prefKeyUser";
    private static final String PREF_KEY_ID = "prefKeyID";
    private static final String PREF_KEY_FIRST_NAME = "prefKeyFirstName";
    private static final String PREF_KEY_LAST_NAME = "prefKeyLastName";
    private static final String PREF_KEY_EMAIL = "prefKeyEmail";

    private User mUser;
    private SharedPreferences mSharedPreferences;

    @Override
    public void onCreate() {
    super.onCreate();
        mSharedPreferences = getSharedPreferences(PREF_KEY_USER,MODE_PRIVATE);
    }

    /**
     * 
     * @return the user
     */
    public User getUser() {
        if (mUser == null) {
            int id = mSharedPreferences.getInt(PREF_KEY_ID, -1);
            String firstName = mSharedPreferences.getString(PREF_KEY_FIRST_NAME, "");
            String lastName = mSharedPreferences.getString(PREF_KEY_LAST_NAME, "");
            String email = mSharedPreferences.getString(PREF_KEY_EMAIL, "");
            mUser = new User(id, firstName, lastName, email);
        }
        return mUser;
    }

    /**
     * sets user, writing to shared preferences as well
     * @param user
     */
    public void setUser(User user) {
        mUser = user;
        Editor e = mSharedPreferences.edit();
        e.putInt(PREF_KEY_ID, user.getID());
        e.putString(PREF_KEY_FIRST_NAME, user.getFirstName());
        e.putString(PREF_KEY_LAST_NAME, user.getLastName());
        e.putString(PREF_KEY_EMAIL, user.getEmail());
        e.commit();
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T19:57:04.987

看起来我这样做的方式是正确的，所以我只是将其添加为答案。如果这是不正确的程序，请纠正我。

# c++ - Visual Studio 不会在配置管理器中给我 64 位的平台选项..？

> ID：14188965
> 
> 赞同：21
> 
> 时间：2013-01-07T02:10:30.940
> 
> 标签：c++, visual-studio-2010, 64-bit, configurationmanager, building

我目前正在尝试为 64 位计算机构建一个项目，但配置管理器没有将 64 位列为选项。它给了我 Win32，但没有 x64（在“平台”下）。我正在使用 Visual Studio 2010 C++ Express。

它适用于我的另一台计算机，但不适用于这台计算机。我读过的大部分内容都在说要进入“Active Solution platform”下拉菜单，并在其中添加“x64”。我已经尝试过了，但它仍然只列出了 Win32。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2014-07-04T07:31:07.897

选择配置管理器，如下图所示。

![在此处输入图像描述](../Images/0c74091e798a3da413cb4dbffb9aef90.png)

如下图所示，从菜单中选择“新建”。

![在此处输入图像描述](../Images/775f18f0d3205afb5f54b17a76cb5e26.png)

之后，您将填充以下对话框。

![在此处输入图像描述](../Images/a52ccc6521143d9e4fa19264385df1b0.png)

该过程完成后，您将获得“x64”平台设置。现在您可以通过配置管理器选择平台。

# asp.net-mvc - 在布局页面中处理动作状态的正确方法是什么？

> ID：14188979
> 
> 赞同：0
> 
> 时间：2013-01-07T02:12:29.910
> 
> 标签：asp.net-mvc

我的意思是：我有一个布局页面，根据调用的操作显示*不同的图标。*所以我在布局中有一些代码，如下所示：

```
<link href="/images/favicon/@(AmbientPage.ShortName).ico" type="image/ico" rel="icon" /> 
```

该`AmbientPage`变量是在`Index`操作中设置的全局值，由布局文件读取，布局文件会动态写入所请求页面的图标文件名。这对我来说似乎真的很笨拙，但我也没有看到解决它的好方法。

当 Layout 页面需要知道 action 中发生的事情时，你会怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T03:01:10.230

通常我会使用子操作或部分来避免布局页面中出现逻辑。因此，在上述情况下，其他方法是将当前页面的名称传递给子操作，并让子操作确定要使用的图标/操作。

它会是这样的：

```
 @Html.Action("Icon", "Default", new { @ViewContext.RouteData["Action"] }) 
```

或者使用一个部分，在布局页面中，添加以下代码

```
 //true since they all required to have an icon
    @RenderSection("Icon", true) 
```

那么在你看来你只是做

```
@section Icon{
     <link href="/images/favicon/currentpage.ico" type="image/ico" rel="icon" />
 } 
```

就个人而言，我建议您使用部分方法来使代码“减少相互依赖”

# jquery - 获取当前或下一个兄弟元素匹配选择器

> ID：14188981
> 
> 赞同：0
> 
> 时间：2013-01-07T02:13:01.567
> 
> 标签：jquery, jquery-selectors

我最近发布了问题[Get Next Element that is Visible and Does Not Have Attribute](https://stackoverflow.com/questions/14168598/get-next-element-that-is-visible-and-does-not-have-attribute)，其中我询问了如何获取下一个既可见又没有属性的同级元素`id='count-me-out'`。

结果是以下语法似乎很好用：

```
var trNext = $(tr).nextAll('tr:visible:not("#count-me-out"):first'); 
```

我现在对此有一个变体，我想使用完全相同的过滤器，只是如果它通过过滤器，我想返回*当前*元素（在上面的示例中）。`tr`如果没有，那么我想继续查看下一个。换句话说，除了从当前元素而不是下一个元素开始之外，它的工作方式与上面的行完全相同。

我想一种方法是用来`prev()`获取前一个兄弟，然后使用上面的行来获取下一个匹配的。谁能说有没有更好的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T02:15:07.967

尝试

```
 var trNext;
 if ($(tr).is('tr:visible:not("#count-me-out")')){
     trNext = tr;
 }
 else{
     trNext = $(tr).nextAll('tr:visible:not("#count-me-out"):first');
 } 
```

[http://api.jquery.com/is/](http://api.jquery.com/is/)

# vb.net - 使用作为 SYSTEM 运行的 vb.net 应用程序，如何为每个登录用户启动一个分离的进程？

> ID：14188988
> 
> 赞同：3
> 
> 时间：2013-01-07T02:14:28.173
> 
> 标签：vb.net, service, system, interactive, createprocessasuser

在对这个主题进行了数周的研究之后，我终于决定开始我自己的线程，希望有经验的人可以提供帮助。我搜索了互联网，试图了解那里的各种编码示例，但我试图将一个可行的解决方案放在一起。让我从一些背景开始——

**背景：**
我有一个 vb.net 应用程序，它使用 CA IT Client Manager (ITCM) 交付到我组织中的 Windows 服务器和 PC。与 Microsoft SCCM 非常相似，CA ITCM 在每台 PC 上都有一个作为 SYSTEM 运行的代理服务。因此，当我的应用程序在目标 PC 上交付和执行时，它在“NT Authority\SYSTEM”上下文中运行。

**问题：**
在我的应用程序的初始阶段，有一个进程在我需要停止的每个登录用户的上下文中运行。在我的应用程序执行结束时，我需要为每个登录的用户重新启动此过程，以防止他们不得不注销并重新登录。我要停止的进程实际上是一个系统托盘进程，用户可以在他们的桌面上与之交互。

**寻找 VB.NET 解决方案：**
在互联网上无休止地研究，似乎没有针对此问题的本地 .NET 解决方案，而无需为每个登录用户设置密码或提示用户输入一些凭据。由于这对我来说不是一个选项，我需要找到一种方法来启动一个进程，而无需知道或需要登录用户的凭据。

研究这条途径使我找到了**CreateProcessAsUser** Windows API 函数。据我了解，我可以按照这些思路做一些事情——（见下文）

**注意：**
这是我第一次在 VB.NET 中对 Windows API 使用非托管代码调用。当我将各种帖子中的代码拼凑在一起时，常量、枚举和函数声明存在很多歧义。如果您发现这些声明中有任何错误，请告诉我。我有很多关于何时需要将数据类型“封送”为不同类型的问题。请仔细阅读！！

由于类似帖子中的示例不计其数，因此我尝试从 CreateProcessAsUser 页面遵循 MSDN 示例：

MSDN 链接： http:
[//msdn.microsoft.com/en-us/library/windows/desktop/ms682429 (v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682429(v=vs.85).aspx)

示例链接： http:
[//msdn.microsoft.com/en-us/library/windows/desktop/aa379608 (v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa379608(v=vs.85).aspx)

除了检查每个 Windows API 调用的有效性之外，请检查操作的整体顺序，如果我过于复杂甚至可能遗漏了什么，请告诉我。我没有从 Microsoft 示例中实现的唯一代码是允许每个 SID 完全访问交互式 Windows 站，然后允许 SID 完全访问交互式桌面。也许我错了，但我认为每个用户都应该已经可以访问他们的交互式桌面了！

```
Public Class WindowsAPI

    Private Const SE_CREATE_TOKEN_NAME As String = "SeCreateTokenPrivilege"
    Private Const SE_ASSIGNPRIMARYTOKEN_NAME = "SeAssignPrimaryTokenPrivilege"
    Private Const SE_LOCK_MEMORY_NAME = "SeLockMemoryPrivilege"
    Private Const SE_INCREASE_QUOTA_NAME = "SeIncreaseQuotaPrivilege"
    Private Const SE_UNSOLICITED_INPUT_NAME = "SeUnsolicitedInputPrivilege"
    Private Const SE_MACHINE_ACCOUNT_NAME = "SeMachineAccountPrivilege"
    Private Const SE_TCB_NAME = "SeTcbPrivilege"
    Private Const SE_SECURITY_NAME = "SeSecurityPrivilege"
    Private Const SE_TAKE_OWNERSHIP_NAME = "SeTakeOwnershipPrivilege"
    Private Const SE_LOAD_DRIVER_NAME = "SeLoadDriverPrivilege"
    Private Const SE_SYSTEM_PROFILE_NAME = "SeSystemProfilePrivilege"
    Private Const SE_SYSTEMTIME_NAME = "SeSystemtimePrivilege"
    Private Const SE_PROF_SINGLE_PROCESS_NAME = "SeProfileSingleProcessPrivilege"
    Private Const SE_INC_BASE_PRIORITY_NAME = "SeIncreaseBasePriorityPrivilege"
    Private Const SE_CREATE_PAGEFILE_NAME = "SeCreatePagefilePrivilege"
    Private Const SE_CREATE_PERMANENT_NAME = "SeCreatePermanentPrivilege"
    Private Const SE_BACKUP_NAME = "SeBackupPrivilege"
    Private Const SE_RESTORE_NAME = "SeRestorePrivilege"
    Private Const SE_SHUTDOWN_NAME = "SeShutdownPrivilege"
    Private Const SE_DEBUG_NAME = "SeDebugPrivilege"
    Private Const SE_AUDIT_NAME = "SeAuditPrivilege"
    Private Const SE_SYSTEM_ENVIRONMENT_NAME = "SeSystemEnvironmentPrivilege"
    Private Const SE_CHANGE_NOTIFY_NAME = "SeChangeNotifyPrivilege"
    Private Const SE_REMOTE_SHUTDOWN_NAME = "SeRemoteShutdownPrivilege"
    Private Const SE_UNDOCK_NAME = "SeUndockPrivilege"
    Private Const SE_SYNC_AGENT_NAME = "SeSyncAgentPrivilege"
    Private Const SE_ENABLE_DELEGATION_NAME = "SeEnableDelegationPrivilege"
    Private Const SE_MANAGE_VOLUME_NAME = "SeManageVolumePrivilege"
    Private Const SE_IMPERSONATE_NAME = "SeImpersonatePrivilege"
    Private Const SE_CREATE_GLOBAL_NAME = "SeCreateGlobalPrivilege"
    Private Const SE_PRIVILEGE_ENABLED As Integer = &H2

    Private Enum WindowShowStyle As UInteger
        Hide = 0
        ShowNormal = 1
        ShowMinimized = 2
        ShowMaximized = 3
        Maximize = 3
        ShowNormalNoActivate = 4
        Show = 5
        Minimize = 6
        ShowMinNoActivate = 7
        ShowNoActivate = 8
        Restore = 9
        ShowDefault = 10
        ForceMinimized = 11
    End Enum

    Private Enum STARTF As Integer
        STARTF_USESHOWWINDOW = &H1
        STARTF_USESIZE = &H2
        STARTF_USEPOSITION = &H4
        STARTF_USECOUNTCHARS = &H8
        STARTF_USEFILLATTRIBUTE = &H10
        STARTF_RUNFULLSCREEN = &H20
        STARTF_FORCEONFEEDBACK = &H40
        STARTF_FORCEOFFFEEDBACK = &H80
        STARTF_USESTDHANDLES = &H100
        STARTF_USEHOTKEY = &H200
    End Enum

    Private Enum CreateProcessFlags
        DEBUG_PROCESS = &H1
        DEBUG_ONLY_THIS_PROCESS = &H2
        CREATE_SUSPENDED = &H4
        DETACHED_PROCESS = &H8
        CREATE_NEW_CONSOLE = &H10
        NORMAL_PRIORITY_CLASS = &H20
        IDLE_PRIORITY_CLASS = &H40
        HIGH_PRIORITY_CLASS = &H80
        REALTIME_PRIORITY_CLASS = &H100
        CREATE_NEW_PROCESS_GROUP = &H200
        CREATE_UNICODE_ENVIRONMENT = &H400
        CREATE_SEPARATE_WOW_VDM = &H800
        CREATE_SHARED_WOW_VDM = &H1000
        CREATE_FORCEDOS = &H2000
        BELOW_NORMAL_PRIORITY_CLASS = &H4000
        ABOVE_NORMAL_PRIORITY_CLASS = &H8000
        INHERIT_PARENT_AFFINITY = &H10000
        INHERIT_CALLER_PRIORITY = &H20000
        CREATE_PROTECTED_PROCESS = &H40000
        EXTENDED_STARTUPINFO_PRESENT = &H80000
        PROCESS_MODE_BACKGROUND_BEGIN = &H100000
        PROCESS_MODE_BACKGROUND_END = &H200000
        CREATE_BREAKAWAY_FROM_JOB = &H1000000
        CREATE_PRESERVE_CODE_AUTHZ_LEVEL = &H2000000
        CREATE_DEFAULT_ERROR_MODE = &H4000000
        CREATE_NO_WINDOW = &H8000000
        PROFILE_USER = &H10000000
        PROFILE_KERNEL = &H20000000
        PROFILE_SERVER = &H40000000
        CREATE_IGNORE_SYSTEM_DEFAULT = &H80000000
    End Enum

    Private Enum ACCESS_MASK
        DELETE = &H10000
        READ_CONTROL = &H20000
        WRITE_DAC = &H40000
        WRITE_OWNER = &H80000
        SYNCHRONIZE = &H100000
        STANDARD_RIGHTS_REQUIRED = &HF0000
        STANDARD_RIGHTS_READ = &H20000
        STANDARD_RIGHTS_WRITE = &H20000
        STANDARD_RIGHTS_EXECUTE = &H20000
        STANDARD_RIGHTS_ALL = &H1F0000
        SPECIFIC_RIGHTS_ALL = &HFFFF
        ACCESS_SYSTEM_SECURITY = &H1000000
        MAXIMUM_ALLOWED = &H2000000
        GENERIC_READ = &H80000000
        GENERIC_WRITE = &H40000000
        GENERIC_EXECUTE = &H20000000
        GENERIC_ALL = &H10000000
        DESKTOP_READOBJECTS = &H1
        DESKTOP_CREATEWINDOW = &H2
        DESKTOP_CREATEMENU = &H4
        DESKTOP_HOOKCONTROL = &H8
        DESKTOP_JOURNALRECORD = &H10
        DESKTOP_JOURNALPLAYBACK = &H20
        DESKTOP_ENUMERATE = &H40
        DESKTOP_WRITEOBJECTS = &H80
        DESKTOP_SWITCHDESKTOP = &H100
        WINSTA_ENUMDESKTOPS = &H1
        WINSTA_READATTRIBUTES = &H2
        WINSTA_ACCESSCLIPBOARD = &H4
        WINSTA_CREATEDESKTOP = &H8
        WINSTA_WRITEATTRIBUTES = &H10
        WINSTA_ACCESSGLOBALATOMS = &H20
        WINSTA_EXITWINDOWS = &H40
        WINSTA_ENUMERATE = &H100
        WINSTA_READSCREEN = &H200
        WINSTA_ALL_ACCESS = &H37F
    End Enum

    <StructLayout(LayoutKind.Sequential)>
    Private Structure PROCESS_INFORMATION
        Public hProcess As IntPtr
        Public hThread As IntPtr
        Public dwProcessId As System.UInt32
        Public dwThreadId As System.UInt32
    End Structure

    <StructLayout(LayoutKind.Sequential)>
    Private Structure SECURITY_ATTRIBUTES
        Public nLength As System.UInt32
        Public lpSecurityDescriptor As IntPtr
        Public bInheritHandle As Boolean
    End Structure

    <StructLayout(LayoutKind.Sequential)>
    Private Structure STARTUPINFO
        Public cb As System.UInt32
        Public lpReserved As String
        Public lpDesktop As String
        Public lpTitle As String
        Public dwX As System.UInt32
        Public dwY As System.UInt32
        Public dwXSize As System.UInt32
        Public dwYSize As System.UInt32
        Public dwXCountChars As System.UInt32
        Public dwYCountChars As System.UInt32
        Public dwFillAttribute As System.UInt32
        Public dwFlags As System.UInt32
        Public wShowWindow As Short
        Public cbReserved2 As Short
        Public lpReserved2 As IntPtr
        Public hStdInput As IntPtr
        Public hStdOutput As IntPtr
        Public hStdError As IntPtr
    End Structure

    Private Enum SECURITY_IMPERSONATION_LEVEL
        SecurityAnonymous = 0
        SecurityIdentification = 1
        SecurityImpersonation = 2
        SecurityDelegation = 3
    End Enum

    Private Enum TOKEN_TYPE
        TokenPrimary = 1
        TokenImpersonation = 2
    End Enum

    Structure LUID
        Public LowPart As UInt32
        Public HighPart As Integer
    End Structure

    Structure TOKEN_PRIVILEGES
        Public PrivilegeCount As Integer
        Public TheLuid As LUID
        Public Attributes As Integer
    End Structure

    Enum TOKEN_INFORMATION_CLASS
        TokenUser = 1
        TokenGroups
        TokenPrivileges
        TokenOwner
        TokenPrimaryGroup
        TokenDefaultDacl
        TokenSource
        TokenType
        TokenImpersonationLevel
        TokenStatistics
        TokenRestrictedSids
        TokenSessionId
        TokenGroupsAndPrivileges
        TokenSessionReference
        TokenSandBoxInert
        TokenAuditPolicy
        TokenOrigin
        TokenElevationType
        TokenLinkedToken
        TokenElevation
        TokenHasRestrictions
        TokenAccessInformation
        TokenVirtualizationAllowed
        TokenVirtualizationEnabled
        TokenIntegrityLevel
        TokenUIAccess
        TokenMandatoryPolicy
        TokenLogonSid
        MaxTokenInfoClass
    End Enum

    <StructLayoutAttribute(LayoutKind.Sequential)>
    Public Structure SECURITY_DESCRIPTOR
        Public revision As Byte
        Public size As Byte
        Public control As Short
        Public owner As IntPtr
        Public group As IntPtr
        Public sacl As IntPtr
        Public dacl As IntPtr
    End Structure

    <DllImport("advapi32.dll", CharSet:=CharSet.Auto, SetLastError:=True)>
    Private Shared Function AdjustTokenPrivileges(ByVal TokenHandle As IntPtr,
                                                  ByVal DisableAllPrivileges As Boolean,
                                                  ByRef NewState As TOKEN_PRIVILEGES,
                                                  ByVal BufferLengthInBytes As UInt32,
                                                  ByRef PreviousState As TOKEN_PRIVILEGES,
                                                  ByRef ReturnLengthInBytes As UInt32) As Boolean
    End Function

    <DllImport("advapi32.dll", CharSet:=CharSet.Auto, SetLastError:=True)>
    Private Shared Function CreateProcessAsUser(ByVal hToken As IntPtr,
                                                ByVal lpApplicationName As String,
                                                ByVal lpCommandLine As String,
                                                ByRef lpProcessAttributes As SECURITY_ATTRIBUTES,
                                                ByRef lpThreadAttributes As SECURITY_ATTRIBUTES,
                                                ByVal bInheritHandles As Boolean,
                                                ByVal dwCreationFlags As UInteger,
                                                ByVal lpEnvironment As IntPtr,
                                                ByVal lpCurrentDirectory As String,
                                                ByRef lpStartupInfo As STARTUPINFO,
                                                ByRef lpProcessInformation As PROCESS_INFORMATION) As Boolean
    End Function

    <DllImport("advapi32.dll", CharSet:=CharSet.Auto, SetLastError:=True)>
    Private Shared Function DuplicateTokenEx(ByVal hExistingToken As IntPtr,
                                             ByVal dwDesiredAccess As UInteger,
                                             ByRef lpTokenAttributes As SECURITY_ATTRIBUTES,
                                             ByVal ImpersonationLevel As SECURITY_IMPERSONATION_LEVEL,
                                             ByVal TokenType As TOKEN_TYPE,
                                             ByRef phNewToken As IntPtr) As Boolean
    End Function

    <DllImport("advapi32.dll", CharSet:=CharSet.Auto, SetLastError:=True)>
    Private Shared Function ImpersonateLoggedOnUser(ByVal hToken As IntPtr) As Boolean
    End Function

    <DllImport("advapi32.dll", CharSet:=CharSet.Auto, SetLastError:=True)>
    Private Shared Function OpenProcessToken(ByVal ProcessHandle As IntPtr,
                                             ByVal DesiredAccess As Integer,
                                             ByRef TokenHandle As IntPtr) As Boolean
    End Function

    <DllImport("advapi32.dll", CharSet:=CharSet.Auto, SetLastError:=True)>
    Private Shared Function RevertToSelf() As Boolean
    End Function

    <DllImport("kernel32.dll", CharSet:=CharSet.Auto, SetLastError:=True)>
    Private Shared Function CloseHandle(ByVal hObject As IntPtr) As Boolean
    End Function

    <DllImport("user32.dll", CharSet:=CharSet.Auto, SetLastError:=True)>
    Private Shared Function GetProcessWindowStation() As IntPtr
    End Function

    <DllImport("user32.dll", CharSet:=CharSet.Auto, SetLastError:=True)>
    Private Shared Function OpenDesktop(ByVal lpszDesktop As String,
                                        ByVal dwFlags As Integer,
                                        ByVal fInderit As Boolean,
                                        ByVal dwDesiredAccess As Integer) As IntPtr
    End Function

    <DllImport("user32.dll", CharSet:=CharSet.Auto, SetLastError:=True)>
    Private Shared Function OpenWindowStation(ByVal lpszWinSta As String,
                                              ByVal fInherit As Boolean,
                                              ByVal dwDesiredAccess As ACCESS_MASK) As IntPtr
    End Function

    <DllImport("user32.dll", CharSet:=CharSet.Auto, SetLastError:=True)>
    Private Shared Function SetProcessWindowStation(ByVal hWinSta As IntPtr) As Boolean
    End Function

    Public Shared Function LaunchProcess(ByVal CmdLine As String) As Boolean

        ' Declare and initialize variables
        Dim ExplorerProcesses As Process()
        Dim UserTokenHandle As IntPtr
        Dim PrimaryTokenHandle As IntPtr
        Dim CurrentWinStationHandle As IntPtr
        Dim InteractiveWinStationHandle As IntPtr
        Dim InteractiveDesktopHandle As IntPtr
        Dim StartupInfo As STARTUPINFO
        Dim ProcessInfo As PROCESS_INFORMATION

        ' Get all explorer.exe IDs
        ExplorerProcesses = Process.GetProcessesByName("explorer")

        ' Verify explorers were found
        If ExplorerProcesses.Length = 0 Then

            ' Return
            Return True

        End If

        ' Iterate each explorer.exe process
        For Each ExplorerProcess As Process In ExplorerProcesses

            ' Get the user token handle address (Query access level)
            If OpenProcessToken(ExplorerProcess.Handle, TokenAccessLevels.MaximumAllowed, UserTokenHandle) = False Then

                ' Do some error handling

                ' Iterate the next process
                Continue For

            End If

            ' Get a primary token
            If DuplicateTokenEx(UserTokenHandle,
                                TokenAccessLevels.MaximumAllowed,
                                Nothing,
                                SECURITY_IMPERSONATION_LEVEL.SecurityImpersonation,
                                TOKEN_TYPE.TokenPrimary,
                                PrimaryTokenHandle) = False Then

                ' Do some error handling

                ' Iterate the next process
                Continue For

            End If

            ' Save a handle to the current window station
            CurrentWinStationHandle = GetProcessWindowStation()

            ' Check for valid handle to the windows station
            If CurrentWinStationHandle = IntPtr.Zero Then

                ' Do some error handling

                ' Iterate the next process
                Continue For

            End If

            ' Get a handle to the interactive window station
            InteractiveWinStationHandle = OpenWindowStation("winsta0", False, ACCESS_MASK.READ_CONTROL Or ACCESS_MASK.WRITE_DAC)

            ' Check for a valid handle
            If InteractiveWinStationHandle = Nothing Then

                ' Do some error handling

                ' Iterate the next user
                Continue For

            End If

            ' To get the correct default desktop, set the caller's window station to the interactive window station
            If SetProcessWindowStation(InteractiveWinStationHandle) = False Then

                ' Do some error handling

                ' Iterate the next user
                Continue For

            End If

            ' Get handle to interactive desktop
            InteractiveDesktopHandle = OpenDesktop("default",
                                                   0,
                                                   False,
                                                   ACCESS_MASK.READ_CONTROL Or
                                                   ACCESS_MASK.WRITE_DAC Or
                                                   ACCESS_MASK.DESKTOP_WRITEOBJECTS Or
                                                   ACCESS_MASK.DESKTOP_READOBJECTS)

            ' Restore the caller's window station
            If SetProcessWindowStation(CurrentWinStationHandle) = False Then

                ' Do some error handling

                ' Iterate the next user
                Continue For

            End If

            ' Check for a valid handle
            If InteractiveDesktopHandle = IntPtr.Zero Then

                ' Do some error handling

                ' Iterate the next user
                Continue For

            End If

            ' Initialize process and startup info
            ProcessInfo = New PROCESS_INFORMATION
            StartupInfo = New STARTUPINFO
            StartupInfo.cb = Marshal.SizeOf(StartupInfo)
            StartupInfo.lpDesktop = "winsta0\default"

            ' Impersonate client to ensure access to executable file
            If ImpersonateLoggedOnUser(PrimaryTokenHandle) = False Then

                ' Do some error handling

                ' Iterate the next user
                Continue For

            End If

            ' Launch the process in the client's logon session
            If CreateProcessAsUser(PrimaryTokenHandle,
                                   Nothing,
                                   CmdLine,
                                   Nothing,
                                   Nothing,
                                   False,
                                   CreateProcessFlags.CREATE_UNICODE_ENVIRONMENT Or
                                   CreateProcessFlags.NORMAL_PRIORITY_CLASS Or,
                                   Nothing,
                                   Nothing,
                                   StartupInfo,
                                   ProcessInfo) = False Then

                ' Do some error handling

                ' Iterate the next user
                Continue For

            End If

            ' End impersonation of client
            If RevertToSelf() = False Then

                ' Do some error handling

                ' Iterate the next user
                Continue For

            End If

        Next

        ' Check for open handle
        If Not PrimaryTokenHandle = IntPtr.Zero Then

            ' Close the handle
            CloseHandle(PrimaryTokenHandle)

        End If

        ' Return
        Return True

    End Function

End Class 
```

**我的结果：**
目前，我正在测试从我的管理员帐户调用 LaunchProcess 函数（在我的本地机器上从 Visual Studio 2010 运行我的解决方案）并通过 ITCM 交付应用程序（从我的本地机器上的 SYSTEM 帐户运行）。在这两种情况下，我都会在用户会话中启动指定的进程，但出现以下错误：

“应用程序无法正确启动（0xc0000142）。单击确定关闭应用程序。”

我希望有人可以查看我的代码并为我指明正确的方向。否则，请告知我如何调试这里到底出了什么问题。

非常感谢您提前提出的所有意见。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-24T17:27:47.863

**解决方案：**

在发布完整的代码解决方案之前，我想分享一下我是如何找到答案的。在重新访问 MSDN 关于 CreateProcessAsUser API 函数的文章后，我意识到我需要验证我的进程是否确实拥有文章中提到的所需权限：

SE_INCREASE_QUOTA_NAME

SE_ASSIGNPRIMARYTOKEN_NAME

此外，本文中未提及，但对于查找和调整令牌权限以启用上述权限的其他一些相关 Windows API 调用可能至关重要的是：

SE_TCB_NAME

回想一下，我的应用程序是使用 CA 的 IT 客户端管理器 (ITCM) 软件交付的，以针对 Windows 服务器和 PC。核心 CA ITCM 代理服务以“本地系统”身份登录，但其插件执行所有脏活启动并以 SYSTEM 帐户运行。显然 SYSTEM 帐户和“本地系统”帐户之间存在巨大差异。

使用 SysInternal 的 Process Explorer 工具，我能够检查我的应用程序并发现它没有拥有所有必需的权限。自从我进行测试以来已经有一段时间了，所以我忘记了实际上没有持有哪个特权。

我最初犯的错误是编写非托管的 Windows API 函数调用来尝试启用丢失的权限，但不幸的是，它并不能那样工作。您的进程要么拥有特权，要么没有特权。如果它拥有特权，那么您唯一的责任就是确保启用该特权。

为了克服这个问题，我不得不使用不同的方法。为了获得所需的权限，我的应用程序需要作为服务安装和执行，因此它可以作为“本地系统”帐户运行。但是，将整个应用程序重新设计为可安装的服务只是为了满足这个简单的要求是没有意义的。

相反，我创建了第二个 VB.NET 项目，这是我发布的代码。第二个项目是一个简单的 Windows 服务，它采用启动参数。第一个启动参数是您希望为每个登录用户启动的应用程序。任何剩余的启动参数都作为启动开关传递给您指定的应用程序:-)

有了现在拥有适当权限并且可以动态接收启动参数以准确指定您希望为每个登录用户启动的服务的服务，我将生成的可执行文件嵌入到我的第一个项目中。

我的第一个项目以 SYSTEM 帐户运行，具有安装新系统服务的权限/权限/特权。它还有权启动该系统服务，传递我为系统中每个登录用户启动托盘服务所需的参数。问题解决了！

这是我的 Windows 服务的代码——

启动服务.vb：

```
'****************************** Class Header *******************************\
' Project Name: LaunchService
' Class Name:   LaunchService
' File Name:    LaunchService.vb
' Author:       fonbr01
' 
' THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
' EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
' MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
' IN NO EVENT SHALL THE AUTHORS BE LIABLE FOR ANY CLAIM, DAMAGES OR
' OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,
' ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
' OTHER DEALINGS IN THE SOFTWARE.
'***************************************************************************/

Public Class LaunchService

    Protected Overrides Sub OnStart(ByVal args() As String)

        ' Local Variables
        Dim AppName As String

        ' Get the application name
        AppName = args(0)
        args(0) = " "

        ' Check for additional arguments
        If args.Length > 1 Then

            ' Shift the arguments
            For i As Integer = 1 To args.Length - 1

                ' Swap the args
                args(i - 1) = args(i)

            Next

            ' Remove the last argument
            args(args.Length - 1) = ""

        End If

        ' Launch the App for all users
        WindowsAPI.LaunchProcess(AppName, args)

    End Sub

    Protected Overrides Sub OnStop()

    End Sub

End Class 
```

WindowsAPI.vb：

```
'****************************** Class Header *******************************\
' Project Name: LaunchService
' Class Name:   WindowsAPI
' File Name:    WindowsAPI.vb
' Author:       fonbr01
' 
' THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
' EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
' MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
' IN NO EVENT SHALL THE AUTHORS BE LIABLE FOR ANY CLAIM, DAMAGES OR
' OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,
' ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
' OTHER DEALINGS IN THE SOFTWARE.
'***************************************************************************/

' Imports
Imports Microsoft.Win32.SafeHandles
Imports System.ComponentModel
Imports System.Runtime.InteropServices
Imports System.Security.Principal
Imports System.Diagnostics

' Windows API Class
Public Class WindowsAPI

    ' *************************
    ' * Windows API Functions
    ' *************************

    <DllImport("advapi32.dll", CharSet:=CharSet.Auto, SetLastError:=True)>
    Private Shared Function AdjustTokenPrivileges(
        <[In]()> ByVal TokenHandle As SafeTokenHandle,
        <[In](), MarshalAs(UnmanagedType.Bool)> ByVal DisableAllPrivileges As Boolean,
        <[In]()> ByRef NewState As TOKEN_PRIVILEGES,
        <[In]()> ByVal BufferLengthInBytes As UInt32,
        <Out()> ByRef PreviousState As TOKEN_PRIVILEGES,
        <Out()> ByRef ReturnLengthInBytes As UInt32) As <MarshalAs(UnmanagedType.Bool)> Boolean
    End Function

    <DllImport("advapi32.dll", CharSet:=CharSet.Auto, SetLastError:=True)>
    Private Shared Function CreateProcessAsUser(
        <[In]()> ByVal hToken As SafeTokenHandle,
        <[In](), MarshalAs(UnmanagedType.LPWStr)> ByVal lpApplicationName As String,
        <[In](), Out(), MarshalAs(UnmanagedType.LPWStr)> ByVal lpCommandLine As String,
        <[In]()> ByRef lpProcessAttributes As SECURITY_ATTRIBUTES,
        <[In]()> ByRef lpThreadAttributes As SECURITY_ATTRIBUTES,
        <[In](), MarshalAs(UnmanagedType.Bool)> ByVal bInheritHandles As Boolean,
        <[In]()> ByVal dwCreationFlags As UInteger,
        <[In]()> ByVal lpEnvironment As IntPtr,
        <[In](), MarshalAs(UnmanagedType.LPWStr)> ByVal lpCurrentDirectory As String,
        <[In]()> ByRef lpStartupInfo As STARTUPINFO,
        <Out()> ByRef lpProcessInformation As PROCESS_INFORMATION) As <MarshalAs(UnmanagedType.Bool)> Boolean
    End Function

    <DllImport("advapi32.dll", CharSet:=CharSet.Auto, SetLastError:=True)>
    Private Shared Function DuplicateToken(
        <[In]()> ByVal ExistingTokenHandle As SafeTokenHandle,
        <[In]()> ByVal ImpersonationLevel As SECURITY_IMPERSONATION_LEVEL,
        <Out()> ByRef DuplicateTokenHandle As SafeTokenHandle) As <MarshalAs(UnmanagedType.Bool)> Boolean
    End Function

    <DllImport("advapi32.dll", CharSet:=CharSet.Auto, SetLastError:=True)>
    Private Shared Function DuplicateTokenEx(
        <[In]()> ByVal hExistingToken As IntPtr,
        <[In]()> ByVal dwDesiredAccess As UInteger,
        <[In]()> ByRef lpTokenAttributes As SECURITY_ATTRIBUTES,
        <[In]()> ByVal ImpersonationLevel As SECURITY_IMPERSONATION_LEVEL,
        <[In]()> ByVal TokenType As TOKEN_TYPE,
        <Out()> ByRef phNewToken As SafeTokenHandle) As <MarshalAs(UnmanagedType.Bool)> Boolean
    End Function

    <DllImport("advapi32.dll", CharSet:=CharSet.Auto, SetLastError:=True)>
    Private Shared Function LookupPrivilegeValue(
        <[In](), MarshalAs(UnmanagedType.LPWStr)> ByVal lpSystemName As String,
        <[In](), MarshalAs(UnmanagedType.LPWStr)> ByVal lpName As String,
        <Out()> ByRef lpLuid As LUID) As <MarshalAs(UnmanagedType.Bool)> Boolean
    End Function

    <DllImport("advapi32.dll", CharSet:=CharSet.Auto, SetLastError:=True)> _
    Private Shared Function OpenProcessToken(
        <[In]()> ByVal hProcess As IntPtr,
        <[In]()> ByVal desiredAccess As UInt32,
        <Out()> ByRef hToken As SafeTokenHandle) As <MarshalAs(UnmanagedType.Bool)> Boolean
    End Function

    ' *************************
    ' * Structures
    ' *************************

    <StructLayout(LayoutKind.Sequential)>
    Private Structure PROCESS_INFORMATION
        Public hProcess As IntPtr
        Public hThread As IntPtr
        Public dwProcessId As System.UInt32
        Public dwThreadId As System.UInt32
    End Structure

    <StructLayout(LayoutKind.Sequential)>
    Private Structure SECURITY_ATTRIBUTES
        Public nLength As System.UInt32
        Public lpSecurityDescriptor As IntPtr
        Public bInheritHandle As Boolean
    End Structure

    <StructLayout(LayoutKind.Sequential)>
    Private Structure STARTUPINFO
        Public cb As System.UInt32
        Public lpReserved As String
        Public lpDesktop As String
        Public lpTitle As String
        Public dwX As System.UInt32
        Public dwY As System.UInt32
        Public dwXSize As System.UInt32
        Public dwYSize As System.UInt32
        Public dwXCountChars As System.UInt32
        Public dwYCountChars As System.UInt32
        Public dwFillAttribute As System.UInt32
        Public dwFlags As System.UInt32
        Public wShowWindow As Short
        Public cbReserved2 As Short
        Public lpReserved2 As IntPtr
        Public hStdInput As IntPtr
        Public hStdOutput As IntPtr
        Public hStdError As IntPtr
    End Structure

    Private Structure LUID
        Public LowPart As UInt32
        Public HighPart As Integer
    End Structure

    Private Structure LUID_AND_ATTRIBUTES
        Public Luid As LUID
        Public Attributes As Integer
    End Structure

    Private Structure TOKEN_PRIVILEGES
        Public PrivilegeCount As UInt32
        <MarshalAs(UnmanagedType.ByValArray)> Public Privileges() As LUID_AND_ATTRIBUTES
    End Structure

    ' ******************************
    ' * Enumerations
    ' ******************************

    Private Enum CreateProcessFlags
        DEBUG_PROCESS = &H1
        DEBUG_ONLY_THIS_PROCESS = &H2
        CREATE_SUSPENDED = &H4
        DETACHED_PROCESS = &H8
        CREATE_NEW_CONSOLE = &H10
        NORMAL_PRIORITY_CLASS = &H20
        IDLE_PRIORITY_CLASS = &H40
        HIGH_PRIORITY_CLASS = &H80
        REALTIME_PRIORITY_CLASS = &H100
        CREATE_NEW_PROCESS_GROUP = &H200
        CREATE_UNICODE_ENVIRONMENT = &H400
        CREATE_SEPARATE_WOW_VDM = &H800
        CREATE_SHARED_WOW_VDM = &H1000
        CREATE_FORCEDOS = &H2000
        BELOW_NORMAL_PRIORITY_CLASS = &H4000
        ABOVE_NORMAL_PRIORITY_CLASS = &H8000
        INHERIT_PARENT_AFFINITY = &H10000
        INHERIT_CALLER_PRIORITY = &H20000
        CREATE_PROTECTED_PROCESS = &H40000
        EXTENDED_STARTUPINFO_PRESENT = &H80000
        PROCESS_MODE_BACKGROUND_BEGIN = &H100000
        PROCESS_MODE_BACKGROUND_END = &H200000
        CREATE_BREAKAWAY_FROM_JOB = &H1000000
        CREATE_PRESERVE_CODE_AUTHZ_LEVEL = &H2000000
        CREATE_DEFAULT_ERROR_MODE = &H4000000
        CREATE_NO_WINDOW = &H8000000
        PROFILE_USER = &H10000000
        PROFILE_KERNEL = &H20000000
        PROFILE_SERVER = &H40000000
        CREATE_IGNORE_SYSTEM_DEFAULT = &H80000000
    End Enum

    Private Enum SECURITY_IMPERSONATION_LEVEL
        SecurityAnonymous = 0
        SecurityIdentification
        SecurityImpersonation
        SecurityDelegation
    End Enum

    Private Enum TOKEN_TYPE
        TokenPrimary = 1
        TokenImpersonation = 2
    End Enum

    ' ******************************
    ' * Constants
    ' ******************************

    Private Const SE_ASSIGNPRIMARYTOKEN_NAME As String = "SeAssignPrimaryTokenPrivilege"
    Private Const SE_INCREASE_QUOTA_NAME As String = "SeIncreaseQuotaPrivilege"
    Private Const SE_TCB_NAME As String = "SeTcbPrivilege"
    Private Const SE_PRIVILEGE_ENABLED As UInt32 = &H2

    ' ******************************
    ' * Safe Token Handle Class
    ' ******************************

    Private Class SafeTokenHandle
        Inherits SafeHandleZeroOrMinusOneIsInvalid

        Private Sub New()
            MyBase.New(True)
        End Sub

        Friend Sub New(ByVal handle As IntPtr)
            MyBase.New(True)
            MyBase.SetHandle(handle)
        End Sub

        <DllImport("kernel32.dll", CharSet:=CharSet.Auto, SetLastError:=True)>
        Friend Shared Function CloseHandle(ByVal handle As IntPtr) As Boolean
        End Function

        Protected Overrides Function ReleaseHandle() As Boolean
            Return SafeTokenHandle.CloseHandle(MyBase.handle)
        End Function

    End Class

    ' ******************************
    ' * Increase Privileges Function
    ' ******************************

    Public Shared Function IncreasePrivileges() As Boolean

        ' Local variables
        Dim hToken As SafeTokenHandle = Nothing
        Dim luid As LUID
        Dim NewState As TOKEN_PRIVILEGES
        NewState.PrivilegeCount = 1
        ReDim NewState.Privileges(0)

        ' Get current process token
        If OpenProcessToken(Diagnostics.Process.GetCurrentProcess.Handle, TokenAccessLevels.MaximumAllowed, hToken) = False Then

            ' Write debug
            WriteEvent("Error: Windows API OpenProcessToken function returns an error." + Environment.NewLine +
                       "Windows API error code: " + Marshal.GetLastWin32Error.ToString, EventLogEntryType.Error)

            ' Return
            Return False

        End If

        ' Lookup SeIncreaseQuotaPrivilege
        If Not LookupPrivilegeValue(Nothing, SE_INCREASE_QUOTA_NAME, luid) Then

            ' Write debug
            WriteEvent("Error: Windows API LookupPrivilegeValue function returns an error." + Environment.NewLine +
                       "Windows API error code: " + Marshal.GetLastWin32Error.ToString, EventLogEntryType.Error)

            ' Return
            Return False

        End If

        ' Enable SeIncreaseQuotaPrivilege
        NewState.Privileges(0).Luid = luid
        NewState.Privileges(0).Attributes = SE_PRIVILEGE_ENABLED

        ' Adjust the token privileges
        If Not AdjustTokenPrivileges(hToken, False, NewState, Marshal.SizeOf(NewState), Nothing, Nothing) Then

            ' Write debug
            WriteEvent("Error: Windows API AdjustTokenPrivileges function returns an error." + Environment.NewLine +
                       "Windows API error code: " + Marshal.GetLastWin32Error.ToString, EventLogEntryType.Error)

            ' Return
            Return False

        End If

        ' Lookup SeAssignPrimaryTokenPrivilege
        If Not LookupPrivilegeValue(Nothing, SE_ASSIGNPRIMARYTOKEN_NAME, luid) Then

            ' Write debug
            WriteEvent("Error: Windows API LookupPrivilegeValue function returns an error." + Environment.NewLine +
                       "Windows API error code: " + Marshal.GetLastWin32Error.ToString, EventLogEntryType.Error)

            ' Return
            Return False

        End If

        ' Enable SeAssignPrimaryTokenPrivilege
        NewState.Privileges(0).Luid = luid
        NewState.Privileges(0).Attributes = SE_PRIVILEGE_ENABLED

        ' Adjust the token privileges
        If Not AdjustTokenPrivileges(hToken, False, NewState, Marshal.SizeOf(NewState), Nothing, Nothing) Then

            ' Write debug
            WriteEvent("Error: Windows API AdjustTokenPrivileges function returns an error." + Environment.NewLine +
                       "Windows API error code: " + Marshal.GetLastWin32Error.ToString, EventLogEntryType.Error)

            ' Return
            Return False

        End If

        ' Lookup SeTcbPrivilege
        If Not LookupPrivilegeValue(Nothing, SE_TCB_NAME, luid) Then

            ' Write debug
            WriteEvent("Error: Windows API LookupPrivilegeValue function returns an error." + Environment.NewLine +
                       "Windows API error code: " + Marshal.GetLastWin32Error.ToString, EventLogEntryType.Error)

            ' Return
            Return False

        End If

        ' Enable SeTcbPrivilege
        NewState.Privileges(0).Luid = luid
        NewState.Privileges(0).Attributes = SE_PRIVILEGE_ENABLED

        ' Adjust the token privileges
        If Not AdjustTokenPrivileges(hToken, False, NewState, Marshal.SizeOf(NewState), Nothing, Nothing) Then

            ' Write debug
            WriteEvent("Error: Windows API AdjustTokenPrivileges function returns an error." + Environment.NewLine +
                       "Windows API error code: " + Marshal.GetLastWin32Error.ToString, EventLogEntryType.Error)

            ' Return
            Return False

        End If

        ' Return
        Return True

    End Function

    ' ******************************
    ' * Launch Process Sub
    ' ******************************

    Public Shared Sub LaunchProcess(ByVal CmdLine As String, ByVal args As String())

        ' Local variables
        Dim Arguments As String = ""
        Dim ExplorerProcesses As Process()
        Dim hToken As SafeTokenHandle = Nothing
        Dim principle As WindowsIdentity
        Dim phNewToken As SafeTokenHandle = Nothing
        Dim si As STARTUPINFO
        Dim pi As PROCESS_INFORMATION

        ' Process arguments
        For Each arg As String In args

            ' Build argument string
            Arguments += " " + arg

        Next

        ' Increase Privileges
        If IncreasePrivileges() = False Then

            ' Write debug
            WriteEvent("Warning: Failed to increase current process privileges.", EventLogEntryType.Warning)

        End If

        ' Get all explorer.exe IDs
        ExplorerProcesses = Process.GetProcessesByName("explorer")

        ' Verify explorers were found
        If ExplorerProcesses.Length = 0 Then

            ' Write debug
            WriteEvent("Warning: No explorer.exe processes found.", EventLogEntryType.Warning)

            ' Return
            Exit Sub

        End If

        ' Iterate each explorer.exe process
        For Each hProcess As Process In ExplorerProcesses

            ' Get the user token handle
            If OpenProcessToken(hProcess.Handle, TokenAccessLevels.MaximumAllowed, hToken) = False Then

                ' Write debug
                WriteEvent("Error: Windows API OpenProcessToken function returns an error." + Environment.NewLine +
                           "Windows API error code: " + Marshal.GetLastWin32Error.ToString, EventLogEntryType.Error)

                ' Iterate the next process
                Continue For

            End If

            ' Get the windows identity
            principle = New WindowsIdentity(hToken.DangerousGetHandle)

            ' Get a primary token
            If Not DuplicateTokenEx(hToken.DangerousGetHandle,
                TokenAccessLevels.MaximumAllowed,
                Nothing,
                SECURITY_IMPERSONATION_LEVEL.SecurityImpersonation,
                TOKEN_TYPE.TokenPrimary,
                phNewToken) Then

                ' Write debug
                WriteEvent("Error: Windows API DuplicateTokenEx function returns an error." + Environment.NewLine +
                           "Windows API error code: " + Marshal.GetLastWin32Error.ToString, EventLogEntryType.Error)

                ' Iterate the next process
                Continue For

            End If

            ' Initialize process and startup info
            pi = New PROCESS_INFORMATION
            si = New STARTUPINFO
            si.cb = Marshal.SizeOf(si)
            si.lpDesktop = Nothing

            ' Launch the process in the client's logon session
            If Not CreateProcessAsUser(phNewToken,
                Nothing,
                CmdLine + Arguments,
                Nothing,
                Nothing,
                False,
                CreateProcessFlags.CREATE_UNICODE_ENVIRONMENT,
                Nothing,
                Nothing,
                si,
                pi) Then

                ' Write debug
                WriteEvent("Error: Windows API CreateProcessAsUser function returns an error." + Environment.NewLine +
                           "Windows API error code: " + Marshal.GetLastWin32Error.ToString, EventLogEntryType.Error)

            Else

                ' Write debug
                WriteEvent("Created new user process: " + Environment.NewLine +
                           "User:     " + principle.Name + Environment.NewLine +
                           "Process:  " + CmdLine + Arguments + Environment.NewLine +
                           "PID:      " + pi.dwProcessId.ToString, EventLogEntryType.Information)

            End If

            ' Free resources
            hToken.Close()
            hToken = Nothing
            phNewToken.Close()
            phNewToken = Nothing
            principle = Nothing
            pi = Nothing
            si = Nothing

        Next

    End Sub

    ' ******************************
    ' * Write Event Log Sub
    ' ******************************

    Public Shared Sub WriteEvent(EventMessage As String, EntryType As EventLogEntryType)

        ' Check if event source exists
        If Not EventLog.SourceExists("WinOffline Launch Service") Then

            ' Create the event source
            EventLog.CreateEventSource("WinOffline Launch Service", "System")

        End If

        ' Write the message
        EventLog.WriteEntry("WinOffline Launch Service", EventMessage, EntryType)

    End Sub

End Class 
```

**执行：**

如上所述，我从我的第二个项目中获取了服务可执行文件，将它作为“现有项目”添加到 Visual Studio 中到我的第一个项目中。然后我更改了“构建操作”以将服务可执行文件嵌入到我的第一个应用程序可执行文件中。

当第一个应用程序在目标上执行时，它会运行代码以将嵌入式可执行文件提取到目标机器上。你可以用谷歌搜索该代码，它相当简单。

将嵌入式服务可执行文件解压缩到本地系统上的路径后，这是我运行的四个“sc”命令——

```
sc create <ServiceName> binpath= <Full Path to Service Executable> start= demand
sc start <ServiceName> <Full Path to App to Launch for all Users> <Parameters>
sc stop <ServiceName>
sc delete <ServiceName> 
```

注意：在第一个 sc 命令中，请记住在等号后放置空格。

使用 sc 命令比使用 installutil.exe 或创建安装项目以将服务打包到 MSI 中并安装它要简单得多。只需确保等待每个 sc 命令返回，然后再继续执行下一个命令。

**最后注：**

对于所有提供积极见解和反馈的人，非常感谢您的帮助。为了像你们这样的好人，我很乐意发布我的代码。对于所有告诉我这无法完成或试图断言戳入用户桌面并运行某些东西的人，我礼貌地鼓励您开始跳出框框思考。我不希望你在我的团队中工作！

带着这样的心态走过人生是一个滑坡，因为某些事情可能在坏人手中产生恶意或危险的影响，根本不应该完成。你发臭的想法与宇宙中所有美好的事物背道而驰。

# openerp - Openerp v7的消息系统

> ID：14188991
> 
> 赞同：1
> 
> 时间：2013-01-07T02:14:54.037
> 
> 标签：openerp

谁能分享我在发送消息时如何更改“发件人”字段值，因为它始终具有相同的电子邮件地址？

--我配置的外发邮件服务器的地址。

![在此处输入图像描述](../Images/11125cb217b149513ced35737722a15c.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T05:21:09.920

您甚至可以在不使用电子邮件模板的情况下发送邮件。

您可以使用**mail.message**和**mail.mail**对象。

```
def send_mail(cr, uid, ids, context=context):
    mail_server_obj = self.pool.get('ir.mail_server')
    mail_message_obj = self.pool.get('mail.message')
    mail_mail_obj = self.pool.get('mail.mail')
    for id in ids:
        mail_message_id = mail_message_obj.create(cr, uid, {'email_from': 'from_add', 'model': 'model_name', 'res_id': id, 'subject': 'subject_name', 'body': 'your_html_body'}, context=context)
        mail_server_ids = mail_server_obj.search(cr, uid, [], context=context)
        mail_mail_id = mail_mail_obj.create(cr, uid, {'mail_message_id': mail_message_id, 'mail_server_id': mail_server_ids and mail_server_ids[0], 'state': 'outgoing', 'email_from': 'from_add', 'email_to': 'to_add', 'body_html': 'your_html_body'}, context=context)
        if mail_mail_id:
            mail_mail_obj.send(cr, uid, [mail_mail_id], context=context)
    return True 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T04:41:32.713

发送邮件的方式有很多种。好的方法是创建一个电子邮件模板。

首先创建一个电子邮件模板。

```
def send_email(self, cr, uid, ids, context=None):
    email_template_obj = self.pool.get('email.template')
        template_ids = email_template_obj.search(cr, uid, [('model_id.model', '=', 'sale.order')])
    if template_ids:
        for id in ids:
            values = email_template_obj.generate_email(cr, uid, template_ids[0], id, context=context)
            print "values::  ", values 
            values['subject'] = your_subject
            values['email_to'] = your_mail_to_address
            values['email_cc'] = your_cc_address
            values['body_html'] = your_body_html_part
            values['body'] = your_body_html_part

            mail_mail_obj = self.pool.get('mail.mail')
            msg_id = mail_mail_obj.create(cr, uid, values, context=context)
            if msg_id:
                mail_mail_obj.send(cr, uid, [msg_id], context=context)
    return True 
```

希望这能解决您的问题。

谢谢你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T21:05:18.500

从显示您的登录名的右上角菜单更改您的电子邮件首选项。

# ruby-on-rails - Is it possible to have 'link_to' within application_helper.rb?

> ID：14188998
> 
> 赞同：0
> 
> 时间：2013-01-07T02:16:17.680
> 
> 标签：ruby-on-rails, ruby-on-rails-3

I'm trying to make a link in common. So I tried to make one in **application_helper.rb**.

But it seems not possible. How do I usually do this when I want to make link which will be used in common.

**application_helper.rb**

```
module ApplicationHelper

  def platform_search(genre_id)
      <%= link_to "<span class='btn btn-danger'>#{community.genre.name}</span>".html_safe, communities_path(:search => '' ,:genre => community.genre_id )%>
  end

end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T02:23:57.440

您应该能够`link_to`在助手中使用。由于`<%=`.

ERB的`<%= %>`is 语法（认为视图），而不是 Ruby。删除那些分隔符。