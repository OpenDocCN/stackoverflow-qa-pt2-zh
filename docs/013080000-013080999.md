# StackOverflow 问答 13080000-13080999

# java - c++ 中的 != 0-9 怎么说

> ID：13080003
> 
> 赞同：3
> 
> 时间：2012-10-26T02:35:45.797
> 
> 标签：java, c++, syntax

> **可能重复：**
> [如何检查给定的 c++ 字符串或 char* 是否仅包含数字？](https://stackoverflow.com/questions/8888748/how-to-check-if-given-c-string-or-char-contains-only-digits)

我想说

```
 if(string.at(i) != 0-9){
    b= true;
} 
```

有没有办法在不输入 value != 0 && value != 1 ...等的情况下说这个？此外，如果这存在并且是可能的，并且它在 java 中的不同，我也会发现这很有帮助。

谢谢你们总是乐于助人。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-26T02:37:21.413

C++：

```
#include <cctype>
using namespace std;
...
if (!isdigit(str[i]))

// or

if (str[i] < '0' || str[i] > '9') 
```

爪哇：

```
if (!Character.isDigit(str.charAt(i))) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T02:36:58.893

说`string[i] < 0 || string[i] > 9`。

确保您实际上是指`0`（值），而不是`'0'`（数字字符为零）。在后一种情况下（正如您在评论中建议的那样），您想要`string[i] < '0' || string[i] > '9'`. （数字保证在任何文本编码中都是连续的和有序的，所以这适用于任何平台。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T04:32:35.540

*使用ad hoc*解决方案可能更容易使用已经很笨拙了，但标准库实际上直接支持这一点：

```
#include <locale>
#include <iostream>
#include <iomanip>

int main() {

    char *inputs[] = { 
        "0983",
        "124test"
    };

    std::locale loc(std::locale::classic());

    std::ctype_base::mask m = std::ctype_base::digit;

    for (int i=0; i<2; i++) {
        char const *b = inputs[i];
        char const *e = b + strlen(b);

        std::cout << "Input: " << std::setw(10) << inputs[i] << ":\t";

        if (std::use_facet<std::ctype<char> >(loc).scan_not(m, b, e) == e)
            std::cout << "All Digits\n";
        else
            std::cout << "Non digit\n";
    }
    return 0;
} 
```

如果您使用的是 C++11，`std::all_of`几乎可以肯定更容易使用：

```
#include <string>
#include <algorithm>
#include <iostream>
#include <iomanip>
#include <ctype.h>

int main() {
    std::string inputs[] = {
        "0983",
        "124test"
    };

    std::cout << std::boolalpha;

    for (int i=0; i<2; i++)
        std::cout << std::setw(10) << inputs[i] << "\tAll digits?: "
            << std::all_of(inputs[i].begin(), inputs[i].end(), ::isdigit) << "\n";
    return 0;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-26T02:44:02.070

您可以使用集合成员资格：

```
!boost::empty(boost::find<boost::return_found_end>("0123456789", string.at(i))) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-26T02:49:29.617

> 如果字符串是“0983”，我希望它为真，但如果它是“124Test”，我希望它保持为假。

话虽如此，一种方法是检查字符是否不是数字，然后返回 false，而不是检查每个字符，直到字符串结尾。

```
bool b = true;
for(int i = 0; i < string.size(); i++)
{
    if(string.at(i) < '0' || string.at(i) > '9')
    {
        b = false;
        break;
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-26T02:56:59.810

对于 C++ 的答案，看看[这个](https://stackoverflow.com/questions/8888748/how-to-check-if-given-c-string-or-char-contains-only-digits)已经解决了一个非常相似的问题的问题，你可以很容易地适应你的情况。

至于Java，你可以这样做：

```
public boolean isInteger(String s) {
    return s.matches("^[0-9]+$");
} 
```

您可以修改正则表达式以满足您的要求。例如：`"^[4-8]+$"`。

**注意**：`String.matches`不是最佳的。如果您需要经常执行检查，请改用编译模式：

```
static final Pattern DIGITS = Pattern.compile("^[0-9]+$");

public void isInteger(String s) {
    return DIGITS.matcher(s).find();
} 
```

# mysql - “字段列表”中的未知列“cg.name”

> ID：13080004
> 
> 赞同：0
> 
> 时间：2012-10-26T02:35:49.953
> 
> 标签：mysql, opencart, mysql-error-1054

我正在使用 opencart，尝试在管理员中查看客户时出现此错误。我对 SQL 一无所知，但我认为它告诉我需要将 cg.name 放在某个地方。

> 完整错误：
> 
> 注意：错误：“字段列表”中的未知列“cg.name”
> 
> 错误编号：1054

```
SELECT *, 
    CONCAT(c.firstname, ' ', c.lastname) AS name, 
    cg.name AS customer_group 
FROM oc_customer c 
LEFT JOIN oc_customer_group cg 
    ON (c.customer_group_id = cg.customer_group_id) 
ORDER BY name ASC 
LIMIT 0,100 
```

> 在 /home4/pawpostc/public_html/system/database/mysql.php 第 49 行

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T10:48:42.200

客户组的名称在表格中，`customer_group_description`因此您还需要将该表格加入到表格中并使用它

```
SELECT *, 
    CONCAT(c.firstname, ' ', c.lastname) AS name, 
    cgd.name AS customer_group 
FROM oc_customer c 
LEFT JOIN oc_customer_group_description cgd 
    ON (c.customer_group_id = cgd.customer_group_id)
WHERE
    cgd.language_id = 1
ORDER BY name ASC 
LIMIT 0,100 
```

如果语言 ID 不正确，请务必更改 1

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T07:41:33.650

我下载了错误版本的mod...删除了mod，删除了问题...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-09-02T19:08:13.807

文件：admin/model/sale/customer.php

〜第76行

代替：

`$sql = "SELECT *, CONCAT(c.firstname, ' ', c.lastname) AS name, cg.name AS customer_group FROM " . DB_PREFIX . "customer c LEFT JOIN " . DB_PREFIX . "**customer_group** cg ON (c.customer_group_id = cg.customer_group_id)";`

和：

`$sql = "SELECT *, CONCAT(c.firstname, ' ', c.lastname) AS name, cg.name AS customer_group FROM " . DB_PREFIX . "customer c LEFT JOIN " . DB_PREFIX . "**customer_group_description** cg ON (c.customer_group_id = cg.customer_group_id)";`

# java - 无需下载 DTD 即可解析 XML 文档的标准方法

> ID：13080005
> 
> 赞同：5
> 
> 时间：2012-10-26T02:36:13.533
> 
> 标签：java, xml, spring

因此，我们的应用程序解析从 Web 服务（特别是[PubMed](http://www.ncbi.nlm.nih.gov/pubmed)）检索到的 XML 文档。这些文件声明了一个 DTD（[一个示例](http://eutils.ncbi.nlm.nih.gov/entrez/eutils/efetch.fcgi?db=pubmed&id=11748933,11700088&retmode=xml)）。默认情况下，与我天真的期望相反，我们使用的 XML 库（JDom2，我相信是基于 Xerces 构建的）在解析 XML 文档之前下载该 DTD。下载，如通过 Internet 向指定地址发出 HTTP 请求。

通过阅读此处的其他帖子，我的理解是阅读 DTD 是必要的，因为它可能包含解析 &foo; 所需的实体声明。文档中的位（顺便说一句，这在 XML 标准中很疯狂，对吧？）

我认为必须有一些简单、标准、任何人都知道他们在做什么的方式来指定我在本地拥有 DTD。但是，我所看到的只是提到设置 XML 目录（黑魔法）或创建自定义 EntityResolver（我的屁股）。

对于我遇到的其他问题，我在 Spring 或其他 Java 库中找到了一种克服它们的标准方法，而无需大量样板。然而，对于这个，我觉得我正在编写相对草率的脆弱代码来完成每个其他开发人员必须遇到的事情。

您如何使用众所周知的库编写 XML 应用程序，而不是一遍又一遍地发出 Web 请求来获取永不更改的文件？

PS：我发现这个问题是因为 PubMed 今天早些时候遇到了连接问题，并且当 XML 解析器无法检索 DTD 时，我的单元测试（使用基于真实查询的模拟文档）失败了。

PPS：当 W3C传播一个实际上乞求这种滥用的标准时，[我](http://www.w3.org/blog/systeam/2008/02/08/w3c_s_excessive_dtd_traffic/)觉得这真的很有趣。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-15T12:09:55.050

我能想到的从不同源加载 DTD 的最佳方法是使用 EntityResolver，它不应该在后面那么痛苦。我使用 DOM4j 和 EntityResolver 加载本地 xml 资源，并将文件放在我的 jar 中，以便使用以下代码轻松访问。

```
new org.xml.sax.EntityResolver() 
{
    @Override
    public InputSource resolveEntity(String publicId, String systemId)
    {
        if (systemId != null && systemId.equals("http://something.com/xml.dtd"))
            return new InputSource(getClass().getResourceAsStream("../xml/local.dtd"));;
    }
}; 
```

我认为这是“标准”方式。

另一种方法可能是通过字符串修改 xml 文档替换 dtd 引用并注入任何可能使用的实体引用。

# c++ - C++ 使用字符串库打印 char 数组

> ID：13080007
> 
> 赞同：0
> 
> 时间：2012-10-26T02:36:30.030
> 
> 标签：c++

假设我有一个 char 数组：Char[3]，其中包含 a、b、c。

在不使用任何 c++ 字符串库的情况下将 Char 打印为“abc”的最简单方法是什么。

我正在尝试重载 << 运算符，以便我可以将包含 char 数组的类 obj 打印回作为创建 obj 的原始字符串。

我对如何实施所提供的解决方案感到困惑。

我的词 objs 可以这样使用：

Word.length() 返回多长时间 Word[XXX] 将返回索引 XXX 处的内容

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T02:39:47.127

尝试`copy`：

```
#include <algorithm>
#include <iterator>
#include <iostream>

char data[3] = { 'a', 'b', 'c' };

std::copy(data, data + sizeof data, std::ostream_iterator<char>(std::cout)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T02:59:45.433

```
class OverloadedCharArrayClass {
 public:
  char* chars;

 friend ostream& operator<<(ostream& os, const OverloadedCharArrayClass& charArray){
  int i=0;
  while(charArray.chars[i]!='\0'){
   os<<charArray.chars[i];
   i++;
  }
  return os;
 }
} 
```

# android - 倒数计时器在android中无法正常工作

> ID：13080008
> 
> 赞同：1
> 
> 时间：2012-10-26T02:36:31.023
> 
> 标签：android, countdowntimer

我`CountDownTimer`在我的`Activity`班级中进行扩展，并将它用作同一班级中的全局变量。每次我引用一个`CountDownTimer`变量时，它就是我在顶部定义的一个变量。发生的问题是，当我想在两者之间重新启动计时器时（在倒计时结束之前），我调用`cancel()`它的方法，我也这样做

```
myCounter = null ; 
```

只是为了安全起见。然后我使用它创建一个新实例

```
myCounter = new MyCounter(TIMERCOUNT, TICKTIME); 
```

发生的事情是，`onFinished()`当我执行上述操作时正在调用该方法，并且无缘无故地调用了该操作（我正在显示一个对话框，说用户的时间已经结束）。如果用户想要停止计时器，他可以中途停止，然后随时重新启动。`onFinished()`仅当计时器成功完成倒计时而没有被用户中断时，才应调用该方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T03:13:30.447

这就是 CountDownTimer 的工作方式，您需要实现自己的简单标志/处理程序。[在这里](https://stackoverflow.com/questions/10927112/android-finish-of-countdowntimer-is-called-even-if-cancel-is-called)看到类似的问题。

# xamarin.ios - dismissViewControllerAnimated:completion:]: 无法识别的选择器发送到实例 - Monotouch

> ID：13080011
> 
> 赞同：1
> 
> 时间：2012-10-26T02:37:11.960
> 
> 标签：xamarin.ios, xamarin

当我调用此行时：

```
((UIImagePickerController)sender).DismissViewController (true, () => {}); 
```

我得到这个错误。请帮忙

```
MonoTouch.Foundation.MonoTouchException: Objective-C exception thrown.  Name: NSInvalidArgumentException Reason: -[UIImagePickerController dismissViewControllerAnimated:completion:]: unrecognized selector sent to instance 0xb647ed0
    at (wrapper managed-to-native) MonoTouch.ObjCRuntime.Messaging:void_objc_msgSend_bool_IntPtr (intptr,intptr,bool,intptr)
    at MonoTouch.UIKit.UIViewController.DismissViewController (Boolean animated, MonoTouch.Foundation.NSAction completionHandler) [0x00036] in /Developer/MonoTouch/Source/monotouch/src/UIKit/UIViewController.g.cs:678
    at ECPIInstructorObservationForm.Section1.Handle_FinishedPickingMedia (System.Object sender, MonoTouch.UIKit.UIImagePickerMediaPickedEventArgs e) [0x00142] in /Users/kjohnson/Projects/ECPIInstructorObservationForm/ECPIInstructorObservationForm/Section1.cs:298
    at MonoTouch.UIKit.UIImagePickerController+_UIImagePickerControllerDelegate.FinishedPickingMedia (MonoTouch.UIKit.UIImagePickerController picker, MonoTouch.Foundation.NSDictionary info) [0x00014] in /Developer/MonoTouch/Source/monotouch/src/UIKit/UIImagePickerController.g.cs:601
    at (wrapper managed-to-native) MonoTouch.UIKit.UIApplication:UIApplicationMain (int,string[],intptr,intptr)
    at MonoTouch.UIKit.UIApplication.Main (System.String[] args, System.String principalClassName, System.String delegateClassName) [0x0004c] in /Developer/MonoTouch/Source/monotouch/src/UIKit/UIApplication.cs:38
    at ECPIInstructorObservationForm.Application.Main (System.String[] args) [0x00000] in /Users/kjohnson/Projects/ECPIInstructorObservationForm/ECPIInstructorObservationForm/Main.cs:17 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T10:46:53.087

选择`dismissViewControllerAnimated:completion:`器是在 iOS 5.0 中引入的 - 您是否在早期的 iO​​S 版本上运行？

**更新**

我刚刚尝试运行此代码：

```
var picker = new UIImagePickerController ();
picker.DismissViewController (true, () => Console.WriteLine ("foo!")); 
```

它在我的机器上运行得很好，这意味着您显示的代码不足以重现您看到的问题 - 所以也许您可以展示您如何创建和使用图像选择器？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-04T14:08:14.337

使用 DismissViewController 完成处理程序是要走的路

```
picker.DismissViewController (true,() => {
    var labelPicsViewController = new LabelPicsViewController();
    PresentViewController(labelPicsViewController,true,null);
}); 
```

# c++ - std::list 的值是否 ::end() 修改列表后更改？

> ID：13080013
> 
> 赞同：11
> 
> 时间：2012-10-26T02:37:16.317
> 
> 标签：c++, list, stl, iterator

我试图利用这样一个事实，即列表的迭代器在插入和删除后仍然有效（除了你刚刚删除的迭代器）。这也是真的吗`std::list<T>::end();`

假设我尝试以下操作：

```
typedef std::list<int> list_int;

list_int myList;
list_int::iterator iter = myList.end();

myList.push_back(1);
myList.push_back(2);
myList.push_back(3);

if(iter == myList.end()) {
    /* do things here */
} else {
    /* do different things here */
    /* I don't expect this branch to ever execute */
} 
```

这很重要，因为在其他地方我可能会将一组迭代器存储到这个列表中，并且我会通过与`myList.end()`. 重要的是，即使在插入和删除之后，无效的迭代器仍然如此。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-10-26T03:31:28.870

`std::list`s 结束迭代器的值在列表的生命周期内永远不会改变。它总是有效的，总是相同的，并且总是对应于列表中虚构的“结束”元素。这意味着`some_list.end()`memorized 在列表生命周期中的任何时间点的值将始终`some_list.end()`与其生命周期中任何其他点的值相同。

语言规范没有明确说明。但是，列表上根本没有有效的操作会使结束迭代器无效或将其值与其他位置相关联。

在您的示例中，第二个分支`if`将永远不会执行。

如果我没有遗漏任何东西，那么同样`std::map`如此`std::set`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T02:50:24.523

`cout`您是否尝试过在 IF 语句的每个子句中放置一个简单的测试？通过这样做，您将意识到第**一个**子句 ( `iter == myList.end()`) 确实是**true**。

我将根据 end() 函数的文档进行推理：[http](http://www.cplusplus.com/reference/stl/list/end/) ://www.cplusplus.com/reference/stl/list/end/ 。它说：“返回一个迭代器，该迭代器引用列表容器中*的最后*一个元素。” *因此，如果返回指向过去*的迭代器，那么它不应该总是指向*过去*吗？*在此结束*点之前插入的元素不应影响迭代器指向的位置（即列表最后一个元素之后的位置）。

# haskell - 作为 Monad 实例的函数

> ID：13080014
> 
> 赞同：9
> 
> 时间：2012-10-26T02:37:17.483
> 
> 标签：haskell, monads

我很难理解一个函数如何成为一个单子。

`(->) r`根据以下声明，函数是一个 monad `Control.Monad.Instances`：

```
instance Monad ((->) r) where  
    return x = \_ -> x  
    h >>= f = \w -> f (h w) w 
```

甚至 Miran Lipovača[所说](http://learnyouahaskell.com/for-a-few-monads-more#state)的也让我感到困惑：

> for 的实现`>>=`似乎有点神秘，但实际上并非如此。当我们用`>>=`一个单子值给一个函数时，结果总是一个单子值。所以在这种情况下，当我们将一个函数提供给另一个函数时，结果也是一个函数。这就是为什么结果以 lambda 开始的原因。`>>=`到目前为止，所有的实现 总是以某种方式将结果与一元值隔离，然后将函数 f 应用于该结果。同样的事情也发生在这里。要从函数中获取结果，我们必须将其应用到某物上，这就是为什么我们在`(h w)`这里从函数中获取结果，然后将 f 应用到该函数上的原因。f 返回一个单子值，在我们的例子中是一个函数，所以我们也将它应用到 w 上。

(>>=) 的类型签名是这样的： (>>=) :: ma -> (a -> mb) -> mb

所以我认为`h`它的类型是 as`m a`和`f`as `(a -> m b)`。如果一个函数是`m a`，它是否返回一个`a`类型值？还是返回其他`a`类型的东西？

如果将 的非单子值`h`馈送到`f`，那么我们得到： f (hw) 看起来不错。既然`f`是一个函数并且接受了它的唯一参数，那么它已经是一个值了，不是吗？由于它是一元函数，因此该值也是一元值。那么为什么它需要另一个值`w`呢？喂食不是`w`让它`f something`成为非单子的，也就是说，它不再是一个函数，不是吗？我也无法理解为什么`f something`并`h`采用相同的参数`w`并返回不同的值类型（`m a`和`m b`）。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-26T03:11:24.347

首先，这是 的类型`(>>=)`：

```
(>>=) :: (Monad m) => m a -> (a -> m b) -> m b 
```

现在，`m`专门用于`((->) r)`：

```
(>>=) :: ((->) r) a -> (a -> ((->) r) b) -> ((->) r) b 
```

用所有功能箭头中缀重写：

```
(>>=) :: (r -> a) -> (a -> (r -> b)) -> (r -> b) 
```

删除一些多余的括号：

```
(>>=) :: (r -> a) -> (a -> r -> b) -> r -> b 
```

此时应该更容易看到发生了什么：将第三个参数（类型`r`）提供给第一个参数以获得 type 的东西`a`，然后将该结果和第三个参数都提供给第二个参数以获得一个类型的最终结果`b`。

因此，`((->) r)`作为 a`Monad`表示该 monad 中每个值的额外函数参数，并且当 monadic 值组合时，单个“额外”参数被复制并赋予每个输入值。本质上，这为一元值创建了一个“只读全局环境”。`Reader`这种解释是作为monad明确提供的，它只是`((->) r)`.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-26T03:10:24.780

通过查看做什么可能更容易理解这个 monad `join`，因为 monad 可以等效地使用`fmap`and来定义，`join`而不是`>>=`.

的一般形式`join`具有 type `Monad m => m (m b) -> m b`，因此它采用“两层”一元值并将其分解为一层。

使用函数 monad 时，`m ~ (a ->)`类型`join`也是`(a -> a -> b) -> (a -> b)`如此，因此它接受一个有两个参数的函数并返回一个只接受一个参数的函数。

```
join :: (a -> a -> b) -> (a -> b)
join f = \x -> f x x 
```

如您所见，它只是重复了参数。

同样，`fmap`on functions 只是函数组合，并且`return`是`const`.

我认为以这种方式理解比试图理解`>>=`.

# css - 如何删除引导程序定义的一些css属性

> ID：13080017
> 
> 赞同：0
> 
> 时间：2012-10-26T02:38:09.657
> 
> 标签：css, twitter-bootstrap

我正在使用引导程序，但是如果我想删除引导程序定义的一些 css 样式，我会发现一些问题。

例如，bootstrap 有一个样式：

```
img{
    max-height:100%;    
} 
```

现在，如果我想删除这个属性呢？

我试过这个：

```
img{
    max-height:"";
} 
```

似乎这不起作用。

所以我改用javascript：

```
$("img").each(function(){
    $(this).css("maxWidth","");
}); 
```

还有什么好主意吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T02:43:54.050

使用`max-height:none`（ 的[初始值`max-height`](http://www.w3.org/wiki/CSS/Properties/max-height)）并确保在引导 css 文件下方声明了它。

```
img{
    max-height:none;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T02:44:05.490

[max height](https://developer.mozilla.org/en-US/docs/CSS/max-height)的默认值为`none`，而不是空引号。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T02:40:56.890

检查以确保您正在修改正确的 .css 文件，您可能正在修改不正确的文件。如果我没记错的话，Bootstrap 有多个 CSS 文件。

# rft - Rational 功能测试器 - 我如何从数据库中读取数据而不是数据池中的静态数据？

> ID：13080018
> 
> 赞同：1
> 
> 时间：2012-10-26T02:38:18.457
> 
> 标签：rft

对于我的项目，我需要文本框从数据库而不是文件和数据池中的静态数据中获取它们的值。简单地说，我的应用程序正在从数据库中读取存储的数据，然后执行一些操作，然后将新数据保存到数据库中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T06:02:54.757

如何实现一个可以迭代数据库的迭代器。使用这个迭代器，我们可以从数据库中获取记录并将其提供给 RFT 脚本。然后，您可以再次使用一些返回数据库的实现来存储更新的值。据我所知，RFT 中没有 api 可以做到这一点，但是 RFT 脚本是普通的 java/vb 脚本，你可以用 java/vb 做任何可能的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-13T01:44:05.763

使用 JDBC 连接到您想要的数据库并从那里开始。

字符串 url = "jdbc:msql://athens.imaginary.com:4333/db_web";

```
 try {
      Class.forName("imaginary.sql.iMsqlDriver");
    }
    catch( Exception e ) {
      System.out.println("Failed to load mSQL driver.");
      return;
    }
    try {
      Connection con = DriverManager.getConnection(url, "borg", "");
      Statement select = con.createStatement();
      ResultSet result = select.executeQuery
                          ("SELECT key, val FROM t_test");         

      System.out.println("Got results:");
      while(result.next()) { // process results one row at a time
        int key = result.getInt(1);
        String val = result.getString(2);

        System.out.println("key = " + key);
        System.out.println("val = " + val);
      }
      select.close();
      con.close();
    }
    catch( Exception e ) {
      e.printStackTrace();
    } 
```

# azure-storage - Windows Azure 操作系统磁盘

> ID：13080021
> 
> 赞同：2
> 
> 时间：2012-10-26T02:38:20.807
> 
> 标签：azure-storage

需要澄清 Azure 上存储的计算方式。问题的简短版本是为虚拟机创建的操作系统磁盘是否计入存储帐户。

长版：我目前正在试用 VS Studio 终极订阅：[https](https://www.windowsazure.com/en-us/offers/ms-azr-0012p) ://www.windowsazure.com/en-us/offers/ms-azr-0012p ，最多允许 2 个小型实例和 45 GB 的存储空间. 但是当创建一个小实例时，它会自动创建一个 30GB 的操作系统磁盘，这意味着我不可能不付费就创建两个小实例（不是同时）？这是 Azure 的工作方式还是 45GB 的存储实际上是指数据磁盘。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T12:50:32.630

Azure 云服务自动附带一组： CPU。内存、存储和带宽限制...

[http://msdn.microsoft.com/en-us/library/windowsazure/ee814754.aspx](http://msdn.microsoft.com/en-us/library/windowsazure/ee814754.aspx)

如果您创建 2 个小型 VM，则无需付费……这大约是 1,500 个计算小时，并且将包含在您的订阅中。

如果您部署 VM 角色（而不是 PaaS Web 工作者）并附加剥离的驱动器，那么是的，您需要为存储/事务付费。所有 Azure OS 驱动器都与 blob 存储相关联，因此很容易确定成本。

顺便说一句...设置并使用一天，您可以在帐单中查看费用。Azure 在定价成本时需要考虑一些细微差别……例如，仅运行存储或空循环中的工作人员算作事务。价格对他们来说是如此之低，以至于通常都无所谓……但有一些方法可以进一步降低成本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-11T10:40:05.657

我相信您会因*使用*磁盘而被收费。例如，我可以创建一个小型 VM 并为其附加几个 1TB 磁盘，除非我开始用数据填充这些 1TB 磁盘，否则根本不会收取太多费用。

听起来您有 45GB 的配额，但您可以创建两个 30GB 的虚拟机就好了，尽管之后不会有太多的数据空间。

# shopify - Shopify：达到一定数量后更改价格

> ID：13080024
> 
> 赞同：0
> 
> 时间：2012-10-26T02:38:40.490
> 
> 标签：shopify

考虑将 Shopify 用于新版本，但我们要求产品的价格在达到添加到购物车的特定数量阈值后发生变化。

举个例子。

产品 A 每个 50 美元。

如果您购买 3 个，则为 150 美元。

但是，如果您购买 4 件*或更多*件……价格变为每件 40 美元。

购买 4 的价格为 160 美元、5 - 200 美元……等等。

我想知道实施这样一个系统的选项是什么。我能想出的所有想法都不是……我们应该说……优雅。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T17:15:33.770

您可以创建一个根据您的业务逻辑定价的产品选项，然后在前端隐藏关联的变体并装配添加到购物车按钮以根据数量添加正确的变体。

# php - Ruby on Rails + PHP | 如何在同一个 Web 服务器上配对 PHP 和 Ruby？

> ID：13080031
> 
> 赞同：3
> 
> 时间：2012-10-26T02:39:40.617
> 
> 标签：php, ruby-on-rails

是否可以在同一台服务器上将 PHP 和 Ruby on Rails 配对？虽然我会使用 RoR More，但我仍然想要 PHP，这可能吗？有什么主要的缺点吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T02:50:01.220

是的，这绝对是可能的。您可以启用/设置 mod_php 和 mod_passenger。这将取决于您的操作系统如何执行此操作。基本上，您需要启用这两个模块，然后拥有单独的虚拟主机：一个用于 PHP，一个用于 Ruby。

如果您让我知道您的操作系统或更多关于您想要实现的目标，我可以让这个答案更详细。

缺点是增加了内存使用，并且可能通过启用 PHP 来满足更复杂的安全需求。但这不是一个巨大的缺点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T04:56:15.430

这绝对是可能的。

有很多方法可以解决它。一种方法是在 Apache 中安装 PHP 和 Passenger 模块，并通过 Apache 路由请求。

另一种方法，也是我个人用来在同一台服务器上处理 PHP 和 Rails 的方法，是在您选择的 PHP/Rails 服务器机制之前设置 nginx，并让 nginx 重写请求。

Cookie（和会话）可以在 PHP 和 Rails 之间共享，以使您的用户体验顺畅。

# php - 交换多维数组的第一维中的位置

> ID：13080033
> 
> 赞同：0
> 
> 时间：2012-10-26T02:40:03.867
> 
> 标签：php, function, multidimensional-array, associative

所以我有以下数组：[http ://pastebin.com/raw.php?i=AazcQUbG](http://pastebin.com/raw.php?i=AazcQUbG)

在下面函数之外的部分代码中，我循环遍历这个特定的有序数组（按第二维的“team_points”排序）并确定“team_points”中是否存在平局。如果确定 team_points 的平局，我检查每个的 tie_breaker。

如果存在平局并且第一维中第二项的 tie_breaker 小于第一项，我希望进行第一维顺序切换。

以下功能不强制切换。有人可以帮我弄清楚为什么我无法在这个数组的第一维中切换位置并建议一种方法来实现吗？

```
function array_swap($key1, $key2, $array) {
  $newArray = array ();
  foreach ($array as $key => $value) {
    if ($key == $key1) {
      $newArray[$key2] = $array[$key2];
    } elseif ($key == $key2) {
      $newArray[$key1] = $array[$key1];
    } else {
      $newArray[$key] = $value;
    }
  }
  return $newArray;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T03:23:34.173

我认为这可能会更好：

**编辑：**此功能旨在在您的整个数据集上运行，使用您的排序字段作为 $key1 和 $key2

```
function array_swap($key1, $key2, $array) {
  $newArray = array ();

  // I chose a for loop because each iteration deals with two elements
  for ($i = 1; $i < count($array); $i++) { 
    if ($array[$i][$key1] == $array[$i - 1][$key1]){
      if ($array[$i][$key2] < $array[$i - 1][$key2]) { //money-condition
        $newArray[$i - 1] = $array[$i];
        $newArray[$i]     = $array[$i - 1];
        $i++
      } else {
        $newArray[$i - 1] = $array[$i - 1];
      }
    } else {
      $newArray[$i - 1] = $array[$i - 1];
    }
  }

  // there is special condition if that last two elements are flipped
  // and $i was incremented, in which this last step won't be required
  if ($i < count($array)){
    $newArray[$i] = $array[$i];
  }
  return $newArray;
} 
```

# acl - 鱿鱼 url_rewrite_program 例外

> ID：13080034
> 
> 赞同：0
> 
> 时间：2012-10-26T02:40:16.990
> 
> 标签：acl, squid

有没有办法限制 url_rewrite_program？例如，我有一组域，我将通过 url_rewrite_program 排除这些域。

假设我有始终允许 Yahoo、Google、Facebook 的 ACL，并且我不希望它们通过 url_rewrite_program。那可能吗？下面是我的配置：

```
###################################
acl good_url dstdomain "/etc/squid/good-sites.txt"
http_access allow good_url

url_rewrite_program /var/myRedirector
redirect_children 10
redirect_rewrites_host_header off
################################## 
```

在 url_rewrite_program 我希望排除 good_url 通过我的重定向器，因为它已经对 acl 感到满意。或者什么是正确的配置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T00:00:17.467

利用

```
url_rewrite_access allow !good_url 
```

# winforms - 在 Visual Studio 2010/2012 中发布应用程序

> ID：13080037
> 
> 赞同：-1
> 
> 时间：2012-10-26T02:40:30.950
> 
> 标签：winforms, visual-studio-2010, visual-studio-2012, clickonce

我有一个在 Visual Studio 2010 中构建的项目，它的副本是使用 Visual Studio 2012 构建的。每次单击以发布应用程序，然后通过电子邮件发送结果的压缩副本（在 2010 年或 2012 年）我都会遇到问题应用程序根本没有安装，出现一个错误，应该联系管理员，或者它安装了，然后同一应用程序的新副本没有（稍后在同一台机器上）。请问我该如何解决这个问题？我已经在许多线程上尝试了许多建议的 clickonce 修复，但我想知道是否有一种可靠的方法可以一劳永逸地处理这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-30T10:04:13.533

为了帮助您，我们需要有关您的设置的更多详细信息：

1.  WinForms/Web/控制台/服务应用
2.  您是在本地机器还是远程机器上发布它？
3.  错误信息的详细信息
4.  正在运行的命令的详细信息（VS -> Tools -> Options -> Projects & Solutions -> Build And Run -> MS Build Verbosity -> Diagnostic）
5.  您是否使用构建和部署包。

打开 msi 日志记录也有帮助。 [http://www.advancedinstaller.com/user-guide/msiexec.html](http://www.advancedinstaller.com/user-guide/msiexec.html)

为了在远程机器上安装*新*的 msi 包，您必须先卸载前一个，afaik vs 不会为您这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T03:29:56.747

这是 Visual Studio 2010 中的一个开放错误。考虑使用以下插件

[http://visualstudiogallery.msdn.microsoft.com/22c5f085-d1be-44a3-b5a4-4710a467b972](http://visualstudiogallery.msdn.microsoft.com/22c5f085-d1be-44a3-b5a4-4710a467b972)

Microsoft 连接问题跟踪系统中的问题

[https://connect.microsoft.com/VisualStudio/feedback/details/588047](https://connect.microsoft.com/VisualStudio/feedback/details/588047)

已针对 VS2012 进行了更正

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-05T22:06:01.760

我以前可能遇到过类似的事情...您是否尝试过在安装中包含与您的项目关联的所有 .dll 文件？

从 2010 年工作室看这个：

1.  在项目的属性页面中导航到发布选项卡
2.  在“安装模式和设置”下单击应用程序文件按钮
3.  在发布状态列下的应用程序文件对话框中，确保列出的所有文件都设置为先决条件（自动）、包含或包含（自动）

包含所有文件后，重新发布并重试。希望这可以帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-04T15:35:39.903

我猜目标机器没有安装应用程序需要的 .net 版本。您是否检查过用于编译应用程序的 .net 版本（可能是 4.0 或 4.5）已安装在目标计算机上？

# iphone - 为 NSMutableArray 目标 c 中的每个元素添加一个常量

> ID：13080039
> 
> 赞同：1
> 
> 时间：2012-10-26T02:40:45.283
> 
> 标签：iphone, objective-c, ios, xcode

我正在尝试为 NSMutableArray 中的每个元素添加一个整数，但找不到这样做的方法。例如，尝试将 5 加到 [3, 4, 7] 等元素数组中得到 [8,9,12]。

任何帮助都会很棒。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T02:45:32.423

假设里面的项目是`NSNumber`对象，你可以这样做：

```
for (int i = 0 ; i != arr.count ; i++) {
    NSNumber *n = [arr objectAtIndex:i];
    [arr replaceObjectAtIndex:i
                   withObject:[NSNumber numberWithInt:5 + [n intValue]]
    ];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T02:55:30.410

您循环整个数组并将当前对象替换为“对象值”+ 5。

```
For (int i=0, i<[myArray count], i++ {
      NSNumber *tmpNum = [myArray objectAtIndex:i];
      int tmpInt = [tmpNum intValue];
      tmpInt = tmpInt+5;
      tmpNum = [NSNumber numberWithInt:tmpInt];
      [myArray replaceObjectAtIndex:i withObject:tmpNum];
} 
```

这应该涵盖它。

我还没有测试过这段代码，所以如果它不起作用，请告诉我。这也是假设你的数组中的对象是 NSNumber 格式。

# java - 让Java函数对象封装泛型函数的正确方法

> ID：13080042
> 
> 赞同：2
> 
> 时间：2012-10-26T02:41:20.480
> 
> 标签：java, generics, metaprogramming, functor

这是一个对 Haskell 和 C++ 模板元编程做过多的人提出的一个复杂但有趣的问题。请多多包涵

我正在编写一些通用 Java 代码来检查函数的某些代数属性，并且我在为其中一些提出适当的类型时遇到了一些困难。

作为一个有效的例子，这是一个检查函数是否可交换的函数：

```
<E, R>
boolean checkCommutative( Binary<E,E,R> f
                        , Binary<R,R,Boolean> eq
                        , E a, E b)
{
    return eq.ap(f.ap(a,b), f.ap(b, a));
} 
```

这个函数应该是这样的：“一个`f`接受两个`E`并产生一个的二元函数`R`是可交换的（相等性由`eq`比较两个的函数定义`R`），如果对于任何类型的`a`和，应用到等于应用到。”`b``E``f``(a,b)``f``(b,a)`

`C.plus(Integer,Integer)`然后，我可以通过执行以下操作来测试给定函数是否可交换：

```
class Plus implements Binary<Integer, Integer, Integer> {
    Integer ap(Integer a, Integer b) { return C.plus(a,b); }
}

class Eq implements Binary<Integer, Integer, Boolean> {
    Boolean ap(Integer a, Integer b) { return a.equals(b); }
}

checkCommutative(new Plus(), new Eq(), rand(), rand()); 
```

一切都很好。

现在我想实现一些更复杂的东西。假设我有一个`Group<E>`带有 plus 方法的通用接口：

```
interface Group<E> {
    E plus(E,E);
} 
```

假设我有两个实现：`TheIntegers`和`TheRationals`：

```
class TheIntegers  implements Group<Integer> { ... }
class TheRationals implements Group<Fraction> { ... } 
```

现在，我希望能够捕捉到`F`从整数到有理数的通用函数与`g`类似`Group.plus`. 作为第一个剪辑，我想写这样的东西：

```
<E, R>
booleanCheckCommutesWith( Unary<E,R> f
                        , ?? g
                        , Binary<R,R,Boolean> eq
                        , E a, E b)
{
    return eq.ap(f.ap(g.ap(a,b)), g.ap(f.ap(a), f.ap(b));
}

class F implements Unary<TheIntegers, TheRationals> {
    Fraction ap (Integer x) { ... }
}

checkCommutesWith(new F(), new Plus(), new Eq(), rand(), rand()); 
```

这里的问题是类型应该是什么`g`？问题在于它`g`适用于两种不同的类型：`E`和`R`. 在具体示例中，我们希望`g`同时表示`Group<Integer>.plus(Integer,Integer)`和`Group<Fraction>.plus(Fraction,Fraction)`。

现在，`checkCommutesWith`上面的实现不可能工作，因为两个调用之间的唯一区别`g.ap`是泛型类型，它被删除了。因此，我将通过将域和范围添加为对象来对其进行一些修改：

```
boolean checkCommutesWith( Unary<DE,RE> f
                        , ?? g
                        , Binary<RE,RE,Boolean> eq
                        , S domain, S range
                        , E x, E y)
{
    return eq.ap( f.ap(g.ap(domain, x, y)),
                , g.ap(range, f.ap(x), f.ap(y))
                );
}

class Plus implements ??
{
    <E, G extends Group<E>>
    E ap (G gp, E x, E y) { return gp.plus(x,y); }
} 
```

那么界面（`??`）应该是什么样子的呢？如果这是 C++，我会写相当于

```
interface ?? <T> {
    <E, S extends T<E>>
    E ap(S, E, E);
} 
```

但 AFAICT Java 没有模板模板参数的等效项。这就是我卡住的地方。

请注意，我不想将 Group 作为 签名的一部分`checkCommutesWith`，因为我也希望能够将此代码与其他结构一起使用。我认为应该可以有一个通用的定义（对于“应该”的一些定义:)）。

**更新/澄清**这里问题的症结在于集合之间映射的定义属性是它们与 eq() 通勤。群同态的定义属性是它们与 plus() 交换。环同态的定义属性是它们与 times() 通勤。我正在尝试定义一个通用的 commutesWith 函数来捕捉这个想法，并且我正在寻找正确的抽象来封装 eq、plus 和 times（以及其他结构）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T18:19:19.223

作为第一个近似值，请参见代码

[https://github.com/rfqu/CodeSamples/blob/master/src/so/SoFun.java](https://github.com/rfqu/CodeSamples/blob/master/src/so/SoFun.java)

至少它编译时没有警告和错误:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T03:42:22.907

我不确定它是否足以满足您的目的，但您可能会检查[`JScience`](http://jscience.org/)库中定义的类型结构。特别是， 中指定的接口[`org.jscience.mathematics.structure`](http://jscience.org/api/org/jscience/mathematics/structure/package-summary.html)可能代表一个有用的起点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-26T13:42:11.367

我担心如果没有未经检查的强制转换，Java 类型系统不够强大，无法做到这一点。但是，它们的影响可以降到最低。

考虑用[范畴理论](http://en.wikipedia.org/wiki/Category_theory)术语来定义它。这足以表达一切，群同态是范畴对象之间态射的具体例子。

关于以下代码的注释： 1\. 我把你的关系`checkCommutesWith`变成了一个`morphismTester`关系。2.`eq`现在是一个属性`CategoryObject`而不仅仅是一个参数。3\. `castToConcreteObject`of`Category`用于进行未经检查的演员表。`GroupsCategory`在我们的示例中，如果使用 for only ，这是安全的`GroupObject`，并且没有不同的实现`CategoryObject<GroupsCategory, E>`。

```
public interface Category<C extends Category<C>>
{
    <E> CategoryObject<C, E>
    castToConcreteObject(CategoryObject<C, E> abstractObject);

    < DOM_E, COD_E
    , DOM_CO extends CategoryObject<C, DOM_E>
    , COD_CO extends CategoryObject<C, COD_E>
    >
    Binary<DOM_E, DOM_E, Boolean>
    morphismTester ( final Unary<DOM_E, COD_E> f
                   , DOM_CO domainObject
                   , COD_CO codomainObject
                   );
}

public interface CategoryObject<C extends Category<C>, E>
{
    Binary<E,E,Boolean> eq();
}

public interface GroupObject<E>
         extends CategoryObject<GroupsCategory, E>
{
    E plus(E a, E b);

    E invert(E a);

    @Override
    Binary<E,E,Boolean> eq();
}

public class GroupsCategory
  implements Category<GroupsCategory>
{
    @Override
    public <E>
    GroupObject<E>
    castToConcreteObject(CategoryObject<GroupsCategory, E> abstractObject)
    {
        return (GroupObject<E>) abstractObject;
    }

    @Override
    public < DOM_E, COD_E
           , DOM_CO extends CategoryObject<GroupsCategory, DOM_E>
           , COD_CO extends CategoryObject<GroupsCategory, COD_E>
           >
    Binary<DOM_E, DOM_E, Boolean>
    morphismTester ( final Unary<DOM_E, COD_E> f
                   , final DOM_CO abstractDomainObject
                   , final COD_CO abstractCodomainObject
                   )
    {
        final GroupObject<DOM_E> domainGroup
            = castToConcreteObject(abstractDomainObject);
        final GroupObject<COD_E> codomainGroup
            = castToConcreteObject(abstractCodomainObject);

        return new Binary<DOM_E, DOM_E, Boolean>()
        {
            @Override
            public Boolean ap(DOM_E a, DOM_E b)
            {
                return codomainGroup.eq().ap
                    (
                        codomainGroup.plus(f.ap(a), f.ap(b)),
                        f.ap(domainGroup.plus(a, b))
                    );
            }
        };
    }
} 
```

可能，要检查更多属性，您需要为每个属性定义一个类别。然后可能存在扩展其他几个类别的类别，这正是描述它们的对象的属性和它们之间的态射的内容。

# regex - 需要在 NOTEPAD++ 中修复 CSV 文件 使用 REGEX 查找和替换一些值

> ID：13080044
> 
> 赞同：1
> 
> 时间：2012-10-26T02:42:03.440
> 
> 标签：regex, csv, replace, find, notepad++

每个字段都用逗号分隔，但没有`""` 分隔。其中一些`values`包含大量数字，例如`10,203`左右`13,415`，`1,214`基本上这是破坏`CSV`文件。

我的解决方案是一些`REGEX`魔术，例如 FIND/REPLACE 在哪里`[\d],[\d]`找到一些临时的东西`[\d]#[\d]`，这样我就可以纠正其他`comma`限制器。

我希望我可以改变（例如：`10,203`to `10#203`or `1,214`to `1#214`all with`REGEX`但不幸的是我当前的方法正在返回：

```
Find => [\d],[\d] -> finds 10,203 replace => [\d]#[\d] -> result 1[\d]#[\d]03
Find => [\d],[\d] -> finds 10,203 replace => # -> result 1#03 
```

有什么建议么？谢谢！:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T02:57:32.737

使用这个正则表达式：`([\d]+),([\d]+)`和 Notepad++ 中的 Replace 函数（菜单 Search => Replace...），如下所示：

![在此处输入图像描述](../Images/458d25895a790d62639fec7d64ee803b.png)

字段中括号之间的捕获组由`Find what:`字段中的和`$1`表示。`$2``Replace with:`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T03:01:12.937

第一栏：`^(\d+(,\d{3})+),`

最后一栏： `,(\d+(,\d{3})+)$`

其他栏目：`,(\d+(,\d{3})),`

请注意，逗号包含在 $0 中

...这将使您替换为`"$1",`,`,"$1",`而`,"$1"`无需将逗号转换为哈希值。

# python - 如何将电子邮件解析为有意义的内容（尤其是文本/html 部分）？- 蟒蛇/pop3

> ID：13080049
> 
> 赞同：3
> 
> 时间：2012-10-26T02:42:26.893
> 
> 标签：python, email, html-email, pop3

好的。这是我的代码：

```
hotmail = poplib.POP3_SSL("pop3.live.com", 995)

hotmail.user("username")

hotmail.pass_("password")

mail_1= hotmail.retr(1)

message_1 = email.message_from_string("\n".join(mail_1[1]))

for part in message.walk():
    print part.get_content_type()

    print "\n"

    print part.get_payload()

    print "----------------------------------------------"

mail_2 = hotmail.retr(2)

message_2 = email.message_from_string("\n".join(mail_2[1]))

for part in message.walk():
    print part.get_content_type()

    print "\n"

    print part.get_payload()

    print "----------------------------------------------" 
```

我现在遇到的问题是，`mail_1`这是一封 hotmail 欢迎邮件，一切正常，尤其是`text/html`部分，它的格式正确。但这`mail_2`是一条`multipart/alternative`消息，我从中得到的`text/html`是一团糟，有很多填充物，比如和`=0D`到处都是，一些典型的线条看起来像这样：`3D``=`

```
<td id=3D"middle_column=
_content_cell" style=3D"background-color:#ffffff;=0D
                                                    -webkit-border-radius:6=
px; -moz-border-radius:6px; border-radius:6px;=0D
                                                    -webkit-box-shadow:0 1p=
x 3px rgba(0,0,0, 0.2);=0D
                                                    -moz-box-shadow:0 1px 3=
px rgba(0,0,0, 0.2);=0D
                                                    box-shadow:0 1px 3px rg=
ba(0,0,0, 0.2);">=0D
=0D
                                                        <span style=3D"font=
-family:'Helvetica Neue', Helvetica, Arial, sans-serif;=0D
                                                        font-size:16px; lin=
e-height:22px; color:#424242;">=0D 
```

那么我该怎么做才能获得有意义的`text/html`消息体呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T02:59:03.220

你想要[quopri](http://docs.python.org/library/quopri.html)模块：

```
import quopri

decoded_text = quopri.decodestring(encoded_text) 
```

# r - 在 Cloudera CDH4 上编译 R 包时 GCC 出错

> ID：13080053
> 
> 赞同：2
> 
> 时间：2012-10-26T02:42:41.883
> 
> 标签：r, gcc, hadoop, cloudera, rcpp

我正在尝试在 Cloudera 的 CDH4 Hadoop VM 上安装 RHadoop。RHadoop 是一个通过 R 编程接口使用 Hadoop 的框架。安装 RHadoop R 包“rmr”的先决条件之一是另一个名为 Rcpp 的 R 包，它用于从 R 调用 C++ 代码。当我尝试安装该包时，出现以下错误。我联系了 Rcpp 和 RHadoop 社区，都说这是 GCC 问题。当我尝试更新或重新安装 GCC 时，我得到“包 gcc-4.4.6-4.e16.x86_64 已安装且最新版本，无事可做。” 有什么建议么？

这是错误（来自 R 命令行）。

```
> install.packages("Rcpp")
Installing package(s) into ‘/usr/lib64/R/library’
(as ‘lib’ is unspecified)
--- Please select a CRAN mirror for use in this session ---
Loading Tcl/Tk interface ... done
 trying URL 'http://cran.csdb.cn/src/contrib/Rcpp_0.9.15.tar.gz'
Content type 'application/x-gzip' length 2119769 bytes (2.0 Mb)
opened URL
 ==============================
====================
downloaded 2.0 Mb

* installing *source* package ‘Rcpp’ ...
** package ‘Rcpp’ successfully unpacked and MD5 sums checked
** libs
g++ -m64 -I/usr/include/R -DNDEBUG -I../inst/include/ -I/usr/local/include    -fpic  -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic  -c Date.cpp -o Date.o
 g++ -m64 -I/usr/include/R -DNDEBUG -I../inst/include/ -I/usr/local/include    -fpic  -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic  -c DateVector.cpp -o DateVector.o
 g++ -m64 -I/usr/include/R -DNDEBUG -I../inst/include/ -I/usr/local/include    -fpic  -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic  -c Datetime.cpp -o Datetime.o
 g++ -m64 -I/usr/include/R -DNDEBUG -I../inst/include/ -I/usr/local/include    -fpic  -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic  -c DatetimeVector.cpp -o DatetimeVector.o
 g++ -m64 -I/usr/include/R -DNDEBUG -I../inst/include/ -I/usr/local/include    -fpic  -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic  -c Dimension.cpp -o Dimension.o
 g++ -m64 -I/usr/include/R -DNDEBUG -I../inst/include/ -I/usr/local/include    -fpic  -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic  -c DottedPair.cpp -o DottedPair.o
 g++ -m64 -I/usr/include/R -DNDEBUG -I../inst/include/ -I/usr/local/include    -fpic  -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic  -c Environment.cpp -o Environment.o
 g++ -m64 -I/usr/include/R -DNDEBUG -I../inst/include/ -I/usr/local/include    -fpic  -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic  -c Evaluator.cpp -o Evaluator.o
 g++ -m64 -I/usr/include/R -DNDEBUG -I../inst/include/ -I/usr/local/include    -fpic  -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic  -c Formula.cpp -o Formula.o
 g++ -m64 -I/usr/include/R -DNDEBUG -I../inst/include/ -I/usr/local/include    -fpic  -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic  -c Function.cpp -o Function.o
 g++ -m64 -I/usr/include/R -DNDEBUG -I../inst/include/ -I/usr/local/include    -fpic  -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic  -c Language.cpp -o Language.o
 g++ -m64 -I/usr/include/R -DNDEBUG -I../inst/include/ -I/usr/local/include    -fpic  -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic  -c Module.cpp -o Module.o
 {standard input}: Assembler messages:
{standard input}:10671: Warning: end of file not at end of a line; newline inserted
{standard input}:11544: Error: bad register name `%'
{standard input}:11544: Error: open CFI at the end of file; missing .cfi_endproc directive
 g++: Internal error: Killed (program cc1plus)
Please submit a full bug report.
See <http://bugzilla.redhat.com/bugzilla> for instructions.
make: *** [Module.o] Error 1
 ERROR: compilation failed for package ‘Rcpp’
* removing ‘/usr/lib64/R/library/Rcpp’

The downloaded source packages are in
    ‘/tmp/RtmpGdXO9h/downloaded_packages’
Updating HTML index of packages in '.Library'
 Making packages.html  ... done
Warning message:
In install.packages("Rcpp") :
  installation of package ‘Rcpp’ had non-zero exit status 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T03:06:13.163

作为 Rcpp 的作者之一，我可以保证错误可能在您的最后，并且可能是 gcc（不太可能）或 CDH。Rcpp 在 CRAN 上构建和重建了无数次（是的，有一些[页面总结了 CRAN](http://cran.r-project.org/web/checks/check_results_Rcpp.html)和[Debian](https://buildd.debian.org/status/package.php?p=rcpp)上的构建。该软件包通常不会杀死编译器。

你会用完盒子上的内存吗？

# javascript - 停止页面在 android 浏览器上滚动

> ID：13080056
> 
> 赞同：0
> 
> 时间：2012-10-26T02:43:35.343
> 
> 标签：javascript, android, jquery, css

我一直试图阻止我的网页滚动，这在桌面浏览器上很容易溢出：隐藏；但这在我的 android 选项卡上不起作用，无论我做什么，它似乎都在继续滚动。我在滚动时玩过 preventDefault ，但这似乎根本不起作用。

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T03:10:11.960

这应该有效：

```
document.ontouchmove = function(event){
    event.preventDefault();
} 
```

# iphone - iOS - 检查钥匙串凭据的频率

> ID：13080066
> 
> 赞同：0
> 
> 时间：2012-10-26T02:44:52.673
> 
> 标签：iphone, objective-c, xcode, ios6

验证用户凭据并将其存储在钥匙串中后，我需要多久检查一次它们是否仍然存在或仍然有效？我应该在每个 ViewDidAppear 上调用一个方法并检查它们是坏的还是不存在然后显示登录模式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T04:18:19.317

**注意**：一旦您成功地将用户凭据存储在钥匙串中，然后是钥匙串凭据`persist after your app is deleted`。所以需要担心检查它们是否仍然存在或仍然有效

也不要忘记在卸载应用程序之前从钥匙串中删除用户凭据

请参阅[钥匙串演示](https://developer.apple.com/library/ios/#samplecode/GenericKeychain/Introduction/Intro.html)链接。

# java - 使用 Action 数据模型值在 Struts2 JSP 中调用静态方法帮助程序类

> ID：13080067
> 
> 赞同：4
> 
> 时间：2012-10-26T02:44:58.480
> 
> 标签：java, jsp, struts2, static, ognl

我是 Struts2 新手。我将 Struts2 与`UserItem`Action 中的典型数据模型一起使用。与 Struts 标签一起使用时，数据模型看起来不太好`<s:property value="userItem.foo"/>`。

我想要做的是编写一个静态 util 方法`Helper.printNice(Foo)`，该方法接受参数 Foo 并在用户友好的显示中打印出 Foo 中包含的值。

如何在静态方法中使用 Struts 属性标记？像这样 的东西`com.helper.Helper.printNice(<s:property value="userItem.foo"/>)`。

这样做的原因是我的网络应用程序正在读取由供应商填充的数据，在许多列中看起来像这样 ["string1", "string2" , ...]。显然，我不想以这种格式向最终用户显示。辅助方法会使其看起来像 string1 <br> string2<br> 等...

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-26T09:47:28.553

**编辑**

从**2.3.20 和更高版本开始**，[静态方法访问将不再起作用](https://stackoverflow.com/a/27505604/1654265)，即使在配置中激活也是如此。

* * *

对于静态方法访问，您需要：

在 Struts.xml 中

```
<constant name="struts.ognl.allowStaticMethodAccess" value="true"/> 
```

在你的 JSP 中

```
<s:property value="@com.your.full.package.Classname@methodName(optionalParameters)" /> 
```

但正如 rees 所指出的，如果不是绝对必要的话，应该避免这样做，因为这不是最佳实践。

在你的具体情况下，我猜包含 ["String1","String2",...] 的对象是一个列表，或者一个向量，或者类似的东西。

那么您在 JSP 中所需要的只是这样的`<s:iterator>`标签：

```
<s:iterator name="yourObjectContainingAListOfString">
   <s:property /> 
   <br/>
</s:iterator> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-10T09:36:58.090

对于**静态方法访问**，您必须在文件中**添加**以下**常量。**`struts.xml`

```
<constant name="struts.ognl.allowStaticMethodAccess" value="true"/> 
```

示例： **struts.xml**：

```
<!DOCTYPE struts PUBLIC
"-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"
"http://struts.apache.org/dtds/struts-2.0.dtd">

<struts>
    <constant name="struts.ognl.allowStaticMethodAccess" value="true"/>
    <package name="default"  namespace="/" extends="struts-default">
        <action name="sampleAction" class="vaannila.SampleAction">
            <result name="success">/WEB-INF/JSP/sample.jsp</result>
        </action>     
    </package>
</struts> 
```

然后从您的 JSP 中，您可以通过各种方式访问​​它：

**示例 - 1：**

```
<b>Output :</b> <s:property value="@vaannila.SampleAction@getSTR()"/> <br> 
```

在哪里，

1.  `vaannila`= 包名称。
2.  `SampleAction`= 班级名称。
3.  `getSTR()`= 方法名称。

**示例 - 2：**

```
<b>Output :</b> <s:property value="@vs@getSTR()"/> <br> 
```

在哪里，

1.  `vs`= 价值栈。
2.  `getSTR()`= 方法名称。

**示例 - 3：**

```
<b>Output :</b> <s:property value="%{STR}"/> <br> 
```

在哪里，

1.  `STR`=`STR`在您的 Java 类中使用 getter 和 setter 方法声明并初始化为静态字符串

# visual-studio-2010 - Visual Studio 只在装配的第二行中断？

> ID：13080069
> 
> 赞同：5
> 
> 时间：2012-10-26T02:45:14.690
> 
> 标签：visual-studio-2010, assembly, masm

## 简短说明：

在汇编程序中我的段的第一行设置断点`.CODE`不会停止程序的执行。

## 问题：

如果 Visual Studio 的调试器无法在以汇编语言编写的程序的第一行创建断点，该怎么办？这是调试器的一些奇怪之处，多字节指令中断的情况，还是我只是在做一些愚蠢的事情？

## 细节：

我在 Visual Studio 中编译和运行了以下汇编程序：

```
; Tell MASM to use the Intel 80386 instruction set.
.386
; Flat memory model, and Win 32 calling convention
.MODEL FLAT, STDCALL
; Treat labels as case-sensitive (required for windows.inc)
OPTION CaseMap:None

include windows.inc
include masm32.inc
include user32.inc
include kernel32.inc
include macros.asm

includelib masm32.lib
includelib user32.lib
includelib kernel32.lib

.DATA
    BadText     db      "Error...", 0
    GoodText    db      "Excellent!", 0

.CODE
main PROC
        ;int 3           ; <-- If uncommented, this will not break.
        mov ecx, 6       ; <-- Breakpoint here will not hit.
        xor eax, eax     ; <-- Breakpoint here will.
_label: add eax, ecx
        dec ecx
        jnz _label
        cmp eax, 21
        jz _good
_bad:   invoke StdOut, addr BadText
        jmp _quit
_good:  invoke StdOut, addr GoodText
_quit:  invoke ExitProcess, 0
main ENDP
END main 
```

如果我尝试在 main 函数的第一行设置断点`mov ecx, 6`，它会被忽略，并且程序会在不停止的情况下执行。如果我将断点设置在之后的行`xor eax, eax`，或任何后续行上，才会命中断点。

我什至尝试插入一个软件断点，`int 3`作为函数的第一行，它也被忽略了。

我注意到的第一件事很奇怪：在遇到我的一个断点后查看反汇编给了我以下信息：

```
01370FFF  add         byte ptr [ecx+6],bh  
--- [Path]\main.asm 
        xor eax, eax
00841005  xor         eax,eax  --- <-- Breakpoint is hit here
_label: add eax, ecx
00841007  add         eax,ecx  
        dec ecx
00841009  dec         ecx  
        jnz _label
0084100A  jne         _label (841007h)  
        cmp eax, 21
0084100C  cmp         eax,15h 
```

这里有趣的`xor`是，在 Visual Studio 看来，这是我程序中的第一个操作。缺席的是行`move ecx, 6`。它认为我的源代码开始的正上方是实际设置`ecx`为 6 的行。因此，我的程序的实际启动已根据反汇编进行了破坏。

如果我制作程序的第一行，`int 3`那么反汇编中代码所在的上方显示的行是：

```
00F80FFF  add         ah,cl 
```

正如其中一个答案所建议的，我关闭了 ASLR，看起来反汇编更稳定了一些：

```
.CODE
main PROC
        ;mov ecx, 6
        xor eax, eax
00401000  xor         eax,eax  --- <-- Breakpoint is present here, but not hit.
_label: add eax, ecx
00401002  add         eax,ecx  --- <-- Breakpoint here is hit.
        dec ecx
00401004  dec         ecx 
```

在反汇编中可以看到完整的程序，但问题仍然存在。尽管我的程序从预期的地址开始，**并且**在反汇编中显示了第一个断点，但它仍然被跳过。将 an`int 3`作为第一行仍然会导致以下行：

```
00400FFF  add         ah,cl 
```

并且不会停止执行，*并*再次在反汇编中重新破坏我的程序的视图。然后我的程序的下一行位于 location `00401001`，我认为这是有道理的，因为`int 3`它是一个单字节指令，但为什么它会在反汇编中消失？

即使使用“Step Into (F11)”命令启动程序也不允许我在第一行中断。事实上，在没有断点的情况下，使用 F11 启动程序根本不会停止执行。

除了我在这里详细介绍的内容之外，我真的不确定我还能尝试什么来解决这个问题。这超出了我目前对汇编和调试器的理解。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-01T21:12:12.927

> 01370FFF 添加字节 ptr [ecx+6],bh

至少我可以解释一个谜。注意地址，0x1370fff。CODE 段永远不会从这样的地址开始，段开始于 0x1000 的倍数的地址。这使得起始地址的最后 3 个十六进制数字始终为 0。调试器感到困惑并开始反汇编错误地址的代码，减一。实际起始地址为 0x1371000。反汇编开始很糟糕，因为 0x1370fff 处有一个 0。那是一条多字节的 ADD 指令。所以它会显示一段时间的垃圾，直到它偶然赶上真正的机器代码指令。

您需要帮助它并给它一个命令，以便在正确的地址开始反汇编。在 VS 的地址框中，键入“0x1371000”。

另一个值得注意的怪癖是起始地址的奇怪值。进程通常从地址 0x400000 开始。您启用了一项名为 ASLR 的功能，即地址空间布局随机化。它是一种防病毒功能，可以使程序从不可预知的起始地址开始。不错的功能，但它并不能完全帮助调试程序。目前尚不清楚您是如何构建此代码的，但您需要 /DYNAMICBASE:NO 链接器选项将其关闭。

您需要记住的另一个重要的调试器怪癖是它们设置断点的方式。*他们通过修补*代码来做到这一点，用指令替换指令的起始字节`int 3`。当断点命中时，它会迅速用原始机器代码指令字节替换该字节。所以你永远不会看到这个。如果你选择了错误的地址来设置断点，就会出错，比如在多字节指令的中间。它现在不再破坏代码，改变的字节弄乱了原始指令。当你从一个糟糕的拆卸开始时，你很容易落入这个陷阱。

好吧，这样做是正确的方式。改为使用调试器的 STEP 命令开始调试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T06:22:53.327

我发现了问题的根源是什么，但我不知道为什么会这样。

创建另一个 MASM 项目后，我注意到新项目*会*在程序的第一行中断，并且反汇编似乎没有被破坏或更改。因此，我将其属性与我的原始项目（用于调试配置）进行了比较。我发现的唯一区别是我的原始项目禁用了增量链接。具体来说，它添加`/INCREMENTAL:NO`到链接器命令行。

从命令行中删除此选项（从而启用增量链接）导致程序在调试期间按预期运行；我在反汇编窗口中显示的代码保持不变，我可以在`main`过程的第一行打断点，并且`int 3`指令也可以作为第一行正确执行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-01T20:31:26.720

如果按 F+11（步入）而不是 Start Debugging，调试器将在第一行停止。

可能存在一些混乱的断点设置。删除项目目录中的所有 *.suo 文件以重置所有断点。

请注意，如果您的项目具有主要功能，则其中将包含一个秘密标题和内容。要在真正的入口点设置断点，请使用：Debug + New Breakpoint + Break at Function -> wWinMainCRTStartup 用于 Windows 程序或 ma​​inCRTStartup 或 wmainCRTStartup 用于控制台程序。

# playframework-2.0 - 使用 Ebean SqlQuery 的最有效方式

> ID：13080073
> 
> 赞同：2
> 
> 时间：2012-10-26T02:45:56.700
> 
> 标签：playframework-2.0, ebean

我有两个模型（为讨论而简化），父级和子级处于 OneToMany 关系。Child 具有 String 属性类型。我想创建一个方法

```
public List<String> Parent.getTypes() 
```

返回不同的类型列表。这是我能想到的最好的：

```
public List<String> getTypes() {
    String sql = "select distinct type from child where parent_id=:id";

    SqlQuery sqlQuery = Ebean.createSqlQuery(sql);
    sqlQuery.setParameter("parent", id);

    List<SqlRow> rows = sqlQuery.findList();
    List<String> types = new ArrayList<String>(rows.size());
    for (SqlRow row : rows)
        directions.add(row.getString("type"));

    return types;
} 
```

我希望经常调用此方法。我假设这不是很有效。一方面，我在每次调用 getTypes() 时创建一个新的 SqlQuery，即使查询除了参数之外是相同的。

初始化可重用 SqlQuery 的最佳位置在哪里？我试图在父模型的顶部执行此操作，但出现异常，因为我猜模型初始化时数据库尚未准备好。我想我可以在第一次调用 getTypes() 时将其设为 null 并对其进行初始化。这样做的“正确”方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T10:07:31.023

缓存非常便宜且有用，您可以将其缓存 10 分钟：

```
public List<String> getTypes(Integer parentId) {

    List<String> types = (List<String>) Cache.get("listOfTypes");
    if (types == null) {
        List<SqlRow> rows = Ebean
             .createSqlQuery("select distinct type from child where parent_id=:id")
             .setParameter("id", parentId)
             .findList();

        types = new ArrayList<String>(rows.size());
        for (SqlRow row : rows)
            types.add(row.getString("type"));

        Cache.set("listOfTypes", types, 600);
    }

    return types;
} 
```

# haskell - 咖喱产品类型

> ID：13080074
> 
> 赞同：13
> 
> 时间：2012-10-26T02:45:59.700
> 
> 标签：haskell, types

使用类型族，我们可以定义函数*折叠*类型和该类型的底层代数，表示为函数和常量值的*n元组。**这允许定义在Foldable*类型类中定义的通用*foldr*函数：

 *```
import Data.Set (Set)
import Data.Map (Map)
import qualified Data.Set as S
import qualified Data.Map as M

class Foldable m where
  type Algebra m b :: *
  fold :: Algebra m b -> m -> b

instance (Ord a) => Foldable (Set a) where
  type Algebra (Set a) b = (b, a -> b -> b)
  fold = uncurry $ flip S.fold

instance (Ord k) => Foldable (Map k a) where
  type Algebra (Map k a) b = (b, k -> a -> b -> b)
  fold = uncurry $ flip M.foldWithKey 
```

类似地，约束类型允许定义广义*映射*函数。*map*函数与*fmap*的不同之处在于它考虑了代数数据类型的每个值字段：

```
class Mappable m where
  type Contains m     :: *
  type Mapped   m r b :: Constraint
  map :: (Mapped m r b) => (Contains m -> b) -> m -> r

instance (Ord a) => Mappable (Set a) where
  type Contains (Set a)     = a
  type Mapped   (Set a) r b = (Ord b, r ~ Set b)
  map = S.map

instance (Ord k) => Mappable (Map k a) where
  type Contains (Map k a)     = (k, a)
  type Mapped   (Map k a) r b = (Ord k, r ~ Map k b)
  map = M.mapWithKey . curry 
```

从用户的角度来看，这两个功能都不是特别友好。特别是，这两种技术都不允许定义*柯里*化函数。这意味着用户不能轻松地部分应用*折叠*或*映射*函数。我*想要*的是一个类型级函数，它对函数和值的元组进行柯里化，以生成上述的柯里化版本。因此，我想写一些近似于以下类型函数的东西：

```
Curry :: Product -> Type -> Type
Curry ()       m = m
Curry (a × as) m = a -> (Curry as m b) 
```

如果是这样，我们可以从底层代数生成一个柯里化折叠函数。例如：

```
 fold :: Curry (Algebra [a] b) ([a] -> b)
≡ fold :: Curry (b, a -> b -> b) ([a] -> b)
≡ fold :: b -> (Curry (a -> b -> b)) ([a] -> b)
≡ fold :: b -> (a -> b -> b -> (Curry () ([a] -> b))
≡ fold :: b -> ((a -> b -> b) -> ([a] -> b))

  map :: (Mapped (Map k a) r b) => (Curry (Contains (Map k a)) b) -> Map k a -> r
≡ map :: (Mapped (Map k a) r b) => (Curry (k, a) b) -> Map k a -> r
≡ map :: (Mapped (Map k a) r b) => (k -> (Curry (a) b) -> Map k a -> r
≡ map :: (Mapped (Map k a) r b) => (k -> (a -> Curry () b)) -> Map k a -> r
≡ map :: (Mapped (Map k a) r b) => (k -> (a -> b)) -> Map k a -> r 
```

我知道 Haskell 没有类型函数，并且*n*元组的正确表示可能类似于类型级别的长度索引类型列表。这可能吗？

**编辑：**为了完整起见，下面附上了我目前对解决方案的尝试。我使用空数据类型来表示类型的产品，并使用类型族来表示上面的函数*Curry*。该解决方案似乎适用于*map*功能，但不适用于*fold*功能。我*相信*，但不确定，在类型检查时，*Curry*没有被适当地减少。

```
data Unit
data Times a b

type family Curry a m :: *
type instance Curry Unit        m = m
type instance Curry (Times a l) m = a -> Curry l m

class Foldable m where
  type Algebra m b :: *
  fold :: Curry (Algebra m b) (m -> b)

instance (Ord a) => Foldable (Set a) where
  type Algebra (Set a) b = Times (a -> b -> b) (Times b Unit)
  fold = S.fold

instance (Ord k) => Foldable (Map k a) where
  type Algebra (Map k a) b = Times (k -> a -> b -> b) (Times b Unit)
  fold = M.foldWithKey

 class Mappable m where
   type Contains m     :: *
   type Mapped   m r b :: Constraint
   map :: (Mapped m r b) => Curry (Contains m) b -> m -> r

 instance (Ord a) => Mappable (Set a) where
   type Contains (Set a)     = Times a Unit
   type Mapped   (Set a) r b = (Ord b, r ~ Set b)
   map = S.map

 instance (Ord k) => Mappable (Map k a) where
   type Contains (Map k a)     = Times k (Times a Unit)
   type Mapped   (Map k a) r b = (Ord k, r ~ Map k b)
   map = M.mapWithKey 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T08:13:17.210

好的，如果我理解正确，您可以创建不方便的折叠，但想要方便的咖喱折叠。

以下是如何将其作为一个单独的步骤来实现的说明。是的，它也可以一次完成，我以前做过类似的事情。但是，我认为单独的阶段可以更清楚地说明正在发生的事情。

我们需要以下语言扩展：

```
{-# LANGUAGE TypeFamilies, TypeOperators, FlexibleInstances #-} 
```

我正在使用以下产品和单位类型：

```
data U = U
data a :*: b = a :*: b

infixr 8 :*: 
```

例如，假设我们有一个不方便的列表折叠版本：

```
type ListAlgType a r = (U -> r)
                   :*: (a :*: r :*: U -> r)
                   :*: U

inconvenientFold :: ListAlgType a r -> [a] -> r
inconvenientFold   (nil :*: cons :*: U) []       = nil U
inconvenientFold a@(nil :*: cons :*: U) (x : xs) = cons (x :*: inconvenientFold a xs :*: U) 
```

我们有一个嵌套的产品类型，我们想对两个级别都进行咖喱。我为此定义了两个类型类，一个用于每一层。（使用更通用的功能可能是可行的，在这种情况下我没有尝试过。）

```
class CurryInner a where
  type CurryI a k :: *
  curryI   :: (a -> b) -> CurryI a b
  uncurryI :: CurryI a b -> a -> b

class CurryOuter a where
  type CurryO a k :: *
  curryO   :: (a -> b) -> CurryO a b
  uncurryO :: CurryO a b -> (a -> b) -- not really required here 
```

每个类型类都实现了 curried 和 uncurried 类型之间的同构。类型类看起来相同，但`CurryOuter`会调用`CurryInner`外部嵌套元组的每个组件。

这些实例相对简单：

```
instance CurryInner U where
  type CurryI U k = k
  curryI f   = f U
  uncurryI x = \ U -> x

instance CurryInner ts => CurryInner (t :*: ts) where
  type CurryI (t :*: ts) k = t -> CurryI ts k
  curryI f   = \ t -> curryI (\ ts -> f (t :*: ts))
  uncurryI f = \ (t :*: ts) -> uncurryI (f t) ts

instance CurryOuter U where
  type CurryO U k = k
  curryO f   = f U
  uncurryO x = \ U -> x

instance (CurryInner a, CurryOuter ts) => CurryOuter ((a -> b) :*: ts) where
  type CurryO ((a -> b) :*: ts) k = CurryI a b -> CurryO ts k
  curryO f   = \ t -> curryO (\ ts -> f (uncurryI t :*: ts))
  uncurryO f = \ (t :*: ts) -> uncurryO (f (curryI t)) ts 
```

就是这样。注意

```
*Main> :kind! CurryO (ListAlgType A R) ([A] -> R)
CurryO (ListAlgType A R) ([A] -> R) :: *
= R -> (A -> R -> R) -> [A] -> R 
```

（对于适当定义的占位符类型`A`和`R`）。我们可以按如下方式使用它：

```
*Main> curryO inconvenientFold 0 (+) [1..10]
55 
```

**编辑：**我现在看到你实际上只是在问关于咖喱外层。然后你只需要一个类，但可以使用相同的想法。我使用这个例子是因为我为基于积和的通用编程库编写了一些东西，该库之前需要两个级别的柯里化，并且起初认为你处于相同的设置中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-26T12:14:42.070

好的，我认为我的其他答案实际上并不能真正回答您的问题。对此感到抱歉。

在您的最终代码中，比较 和 的`fold`类型`map`：

```
fold :: Curry (Algebra m b) (m -> b)
map  :: (Mapped m r b) => Curry (Contains m) b -> m -> r 
```

这里有很大的不同。的类型`fold`只是一个类型族应用程序，而类型的`map`包含 final `m -> r`，提到了类参数`m`。因此，在 的情况下`map`，GHC 很容易从上下文中了解您希望在哪种类型上实例化该类。

不幸的是，在 的情况下并非如此`fold`，因为类型族不需要是单射的，因此不容易反转。因此，通过查看您使用的特定类型`fold`，GHC 不可能推断出`m`是什么。

这个问题的标准解决方案是使用代理参数来修复 的类型`m`，通过定义

```
data Proxy m = P 
```

然后给出`fold`这种类型：

```
fold :: Proxy m -> Curry (Algebra m b) (m -> b) 
```

您必须调整实例以采用和丢弃代理参数。然后你可以使用：

```
fold (P :: Proxy (Set Int)) (+) 0 (S.fromList [1..10]) 
```

或类似于在集合上调用 fold 函数。

为了更清楚地了解 GHC 难以解决这种情况的原因，请考虑这个玩具示例：

```
class C a where
  type F a :: *
  f :: F a

instance C Bool where
  type F Bool = Char -> Char
  f = id

instance C () where
  type F () = Char -> Char
  f = toUpper 
```

现在，如果您调用`f 'x'`，则 GHC 没有任何有意义的方法来检测您指的是哪个实例。代理在这里也会有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-26T17:33:26.997

类型级列表正是您所需要的！你已经非常接近了，但你需要两者的全部力量`DataKinds`才能`ScopedTypeVariables`正常工作：

```
{-# LANGUAGE ConstraintKinds, DataKinds, FlexibleContexts, FlexibleInstances, TypeFamilies, TypeOperators, ScopedTypeVariables #-}
import GHC.Exts (Constraint)
import Data.Set (Set)
import Data.Map (Map)
import qualified Data.Set as S
import qualified Data.Map as M

-- | A "multifunction" from a list of inhabitable types to an inhabitable type (curried from the start).  
type family (->>) (l :: [*]) (y :: *) :: *
type instance '[] ->> y = y
type instance (x ': xs) ->> y = x -> (xs ->> y)

class Foldable (m :: *) where
  type Algebra m (b :: *) :: [*]
  fold :: forall (b :: *). Algebra m b ->> (m -> b)

instance (Ord a) => Foldable (Set a) where
  type Algebra (Set a) b = '[(a -> b -> b), b]
  fold = S.fold :: forall (b :: *). (a -> b -> b) -> b -> Set a -> b

instance (Ord k) => Foldable (Map k a) where
  type Algebra (Map k a) b = '[(k -> a -> b -> b), b]
  fold = M.foldWithKey :: forall (b :: *). (k -> a -> b -> b) -> b -> Map k a -> b

class Mappable m where
  type Contains m :: [*]
  type Mapped m (b :: *) (r :: *) :: Constraint
  map :: forall (b :: *) (r :: *). Mapped m b r => (Contains m ->> b) -> m -> r

instance (Ord a) => Mappable (Set a) where
  type Contains (Set a) = '[a]
  type Mapped (Set a) b r = (Ord b, r ~ Set b)
  map = S.map :: forall (b :: *). (Ord b) => (a -> b) -> Set a -> Set b

instance (Ord k) => Mappable (Map k a) where
  type Contains (Map k a) = '[k, a]
  type Mapped (Map k a) b r = r ~ Map k b
  map = M.mapWithKey :: forall (b :: *). (k -> a -> b) -> Map k a -> Map k b 
```*

# web-services - web.xml 中的 web 服务源

> ID：13080075
> 
> 赞同：0
> 
> 时间：2012-10-26T02:46:05.580
> 
> 标签：web-services, tomcat, netbeans, web.xml

如何让我的 Web 服务客户端（在 Web 应用程序中）使用 web.xml 文件来获取 wsdl 的源代码？

我正在使用 netbeans 6.9 和 tomcat，到目前为止，我们的 Web 应用程序中有一个带有 wsdl url 的 Web 服务引用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T09:07:31.427

我不建议将此类资源存储在 中`web.xml`，因为它们将来可以更改。例如，如果部署的 Web 服务`http://theaddress:8080/webapp?wsdl`将被迁移到其他一些服务器并且 URL 将发生变化。然后你必须修改你的应用程序，在这种情况下它不是很有效的方法。

我建议[JNDI](http://tomcat.apache.org/tomcat-6.0-doc/jndi-resources-howto.html)像这样存储资源。在 中阅读[如何执行此操作](http://tomcat.apache.org/tomcat-6.0-doc/jndi-resources-howto.html)，`Tomcat`设置起来并不难。

另一种方法是使用文件，`.properties`但我宁愿选择`JNDI`.`.properties`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T05:34:18.037

如果它必须是 web.xml，您可以配置一个上下文参数（与其他任何参数一样），例如：

```
 <context-param>
    <param-name>webservice.Location</param-name>
    <param-value>http://theaddress:8080/webapp?wsdl</param-value>
   </context-param> 
```

如上所述配置后（`Webservice.Location`）是任意变量名称，您可以根据需要进行更改。如果您没有使用任何附加的 Web 应用程序层，例如 JSF 或 Struts 等，您现在可以`HttpServletRequest`像在 servlet 中那样引用这个变量（来自对象）

```
 String webServiceAddr = request.getServletContext().getInitParameter("webservice.Location"); //getServletContext() will give you an instance to a ServletContext object which basically is a representation of your entire web application deployment environment including configuration files. 
```

该变量`webServiceAddr`现在将包含配置的值

我建议您将这样的配置外部化为标准`.properties`文件，因为部署者在尝试设置它时会在您的 web.xml 中处理其他配置，这有点冒险。这也是应用程序配置管理的最佳实践。[这里](http://jaitechwriteups.blogspot.com/2007/01/how-to-read-properties-file-in-web.html)有一个关于属性文件的小教程

# c# - 如何从 C# 的设置文件中传递字符串文字

> ID：13080080
> 
> 赞同：4
> 
> 时间：2012-10-26T02:46:57.790
> 
> 标签：c#, string, settings, app-config, literals

我想创建一个配置设置以将字符串传递给我的应用程序。该字符串基于网页中的一些文本，这就是我需要允许从配置文件中更改它的原因。

我要传入的字符串是

一种）

```
Forecast Summary:</b> 
    <span class="phrase"> 
```

当我使用它来搜索页面时，字符串文字的格式是

b)

```
string myString = "Forecast Summary:</b> \n        <span class=\"phrase\">"; 
```

问题是传入的字符串（通过将上面（a）中的文本粘贴到应用程序设置屏幕中）以格式出现

C）

```
"Forecast Summary:</b> \r\n        <span class=\"phrase\">" 
```

（其中插入了回车）

有没有办法在 App.Config 中输入字符串作为“精确”字符串文字

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T03:01:55.513

您需要使用[CDATA](https://stackoverflow.com/questions/2784183/what-does-cdata-in-xml-mean)或 XML 转义码。

```
<myxml>
    <record>
        <![CDATA[
        Line 1 <br />
        Line 2 <br />
        Line 3 <br />
        ]]>
    </record>
</myxml> 
```

[有关XML 转义](http://tntluoma.com/sidebars/codes/)的更多信息，请参见此处

欲了解更多信息，请参阅：[此处](https://stackoverflow.com/questions/1222367/escape-quote-character-in-xml)和[此处](https://stackoverflow.com/questions/1091945/where-can-i-get-a-list-of-the-xml-document-escape-characters)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T23:17:45.597

我首先通过将 XML 编码字符直接输入 App.Config 来解决它。

```
<setting name="DataExtractFrom" serializeAs="String">
     <value>Forecast Summary:&lt;/b&gt; &#10;        &lt;span class="phrase"&gt;</value>
</setting> 
```

（之前我已经将它粘贴到必须添加额外回车的项目的设置屏幕中）

然后

正如上面建议的 pylover ，如果我使用 CDATA 格式编辑 App.Config 文件，它就可以工作。

```
<setting name="DataExtractFrom" serializeAs="String">
   <value><![CDATA[Forecast Summary:</b> \n        <span class=\"phrase\">]]></value>
</setting> 
```

这在配置文件中看起来更干净，所以我最终使用了这种格式。

# css - 阻止访问者浏览器从缓存加载网站

> ID：13080086
> 
> 赞同：1
> 
> 时间：2012-10-26T02:49:03.657
> 
> 标签：css, html, browser-cache

我更新了我网站上的图像和样式表，但我接到客户的电话说我的布局看起来很奇怪。当他们刷新页面时，它看起来很正常。

如何阻止他们的浏览器从缓存中加载我的网站？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T02:53:00.560

使用其中一种[静态文件版本控制](https://www.google.com/search?q=static+file+versioning)技术

例如向静态文件添加查询字符串`/img/image1.jpg?v=1.0`或重命名文件`/img/image1_1.0.jpg`

这适用于任何图像、JavaScript 或 CSS 文件

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T03:04:49.330

您可以使用元标记告诉浏览器不要缓存页面：

您还可以生成原始标题。请阅读[HTTP 规范](http://www.php.net/manual/en/function.header.php)

```
<?
header("Expires: Mon, 26 Jul 1997 05:00:00 GMT");
header("Last-Modified: " . gmdate("D, d M Y H:i:s") . " GMT");
header("Cache-Control: no-store, no-cache, must-revalidate");
header("Cache-Control: post-check=0, pre-check=0", false);
header("Pragma: no-cache");
?> 
```

# c++ - 从主进程执行多个进程

> ID：13080093
> 
> 赞同：0
> 
> 时间：2012-10-26T02:49:54.677
> 
> 标签：c++, exec, fork, control-flow

我想从一个主进程创建多个进程。我知道我想使用 exec 系列中的一个函数，但它似乎并没有按照我的预期进行。似乎 exec() 是一个阻塞调用，或者我只是用错了。无论如何，上代码：

```
const char* ROUTERLOCATION = "../../router";
int main(int argc, char** argv) {
  manager manager;
  vector<string> instructions = manager.readFile(argv[1]);
  ...
  //file gives me the number of proceses i want to spawn and that value goes in 
  //rCount
  for(int i = 0; i < rCount; i++){
    cout << "creating:" << i << endl;
    execl(ROUTERLOCATION, "",NULL);
    }
} 
```

我看到的输出是：

```
creating:0
HI!!! 
```

然后一切都优雅地退出。我不能使用 生成多个进程`execl()`吗？

另外，我想与这些进程中的每一个进行通信，所以我不想在这些进程运行时被阻塞。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T02:52:38.333

您需要`fork`在您的主进程中，在您的子进程中调用`execl`. （`exec`函数系列用您的新进程替换您当前的进程映像，因此为什么您的 for 循环永远不会完成。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T03:04:41.447

调用`exec()`意味着您当前的程序不再存在。您可能希望使用创建一个新流程`fork()`，然后调用`exec()`它，以便`exec()`替换您的新流程，并且您的主流程仍然按您的预期工作。

例子：

```
pid_t pid = fork();
if (pid == 0) {// child
    execl();
} else { // parent
} 
```

# javascript - 创建正确的数组结构

> ID：13080095
> 
> 赞同：0
> 
> 时间：2012-10-26T02:50:03.227
> 
> 标签：javascript, loops

一个集合返回 11 个项目，如下所示；

```
 ( 1, "Ball", "Result1") 
   ( 2, "Ball", " Result2") 
   ( 3, "Ball", " Result3") 
   ( 4, "Ball", " Result4") 
   ( 5, "Ball", " Result5") 
   ( 6, "Ball", " Result6") 
   ( 7, "Ball", " Result7") 
   ( 8, "Ball", " Result8") 
   ( 9, "Pool", " Pool 1") 
   ( 10, "Pool", " Pool 2") 
   ( 11, "Pool", " Pool 3") 
```

我想存储它们，将它们分组为四个项目.. 让我的数组看起来像这样

```
var data = [];
                    data.push({
                    myclass: "First4",
                    schedule: [ {
                        id : '1',
                        gameType: 'Ball',

                        result: 'Result11'
                    }, {
                        id: '2',
                        gameType: 'Ball',

                        result: 'Result2'

                    },...........  ]

                });
                                    //second group
                data.push({
                    divClass : "second4",
                    items : [ {
                        id : '5'
                        gameType: 'Ball',
                        result: 'Result5'
                    }, {
                        id : ''
                        gameType: 'Ball',
                        result: 'Result6

                    } ]
                }); 
```

我如何编写一个 for 循环，以便我可以动态实现相同的结果，而不是手动编写推送

```
for(var i = 0; i < collLength; i++){
// do push 1 with first four  //data.push(class, sheculde first 4 items, result)
// do second push with second four
// do third push with the remaining

  } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T03:13:50.863

```
var data = [];

for(var i = 0; i < collLength; i+=4) {
    data.push({
        divClass: "group" + (i / 4),
        items: collection.slice(i, i + 4).map(function(item) {
            return {id:item[0], gameType:item[1], result:item[2]};
        })
    });
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T03:08:59.897

```
var indata = [...]; // this is filled with your list of objects.
var outdata = [ ];

var n = indata.length;

for (var i = 0; i < n; i += 4)
{
    outdata.push({
        class: 'group' + outdata.length, 
        items: indata.slice(i, i + 4)
    });
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T03:26:47.403

```
var indata = [...]; // this is filled with your list of objects.
var outdata = [ ];

function mapper(element, i)
{
     var j = Math.floor(i / 4);

     if (outdata[j] == undefined)
         outdata[j] = { class: 'group' + j, items: [ ] };

     outdata[j].items.push(element);
}

indata.map(mapper); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-26T03:35:47.477

这是一种使用`.reduce()`.

```
var data = collection.reduce(function(arr, obj, i) {
    return i % 4 ? arr : 
                   arr.concat({
                      divClass: "group" + (i / 4),
                      items: collection.slice(i, i + 4).map(function(item) {
                          return {id:item[0], gameType:item[1], result:item[2]};
                      })
                   });
}, []); 
```

# android - 如何从方法中获取数据并放入 ListView？

> ID：13080101
> 
> 赞同：1
> 
> 时间：2012-10-26T02:50:40.057
> 
> 标签：android

我有这堂课：

```
public class Bookmark extends ArrayList<Bkm> {

    public static Bookmark getBookmark(Context context) {
        Bookmark bookmarks = new Bookmark ();

        String[] titles  = context.getResources().getStringArray(R.array.bookmark_titles);
        String[] urls    = context.getResources().getStringArray(R.array.bookmark_urls);
        TypedArray icons = context.getResources().obtainTypedArray(R.array.bookmark_icons);

        for (int i = 0; i < titles.length; i ++) {
            bookmarks.add(titles[i], urls[i], icons.getDrawable(i));
        }

        return bookmarks;
    }
} 
```

该类具有返回“书签”对象的“getBookmark”方法，它包含“标题”、“网址”和“图标”字段。我怎样才能在我的主要课程中获得这些字段？我想创建一个带有“标题”项目的 ListView 并访问 WebView 中的相应 url。

在我的主要课程中，我有这个 ListView

```
ListView lv = (ListView) findViewById(R.id.favoritos_listView); 
```

我正在尝试以这种方式获取数据

```
Context context = getApplicationContext();        
ArrayList<Bookmark> my_array = BookmarkCollection.getTestBookmarks(context);
ArrayAdapter<Bookmark> aa = new ArrayAdapter<Bookmark>(context, R.array.bookmark_titles, android.R.layout.simple_list_item_1, my_array);
ListView lv = (ListView) findViewById(R.id.favoritos_listView);
lv.setAdapter(aa); 
```

但是 ListView 没有出现。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T03:32:03.597

`Boomark`不需要扩展`ArrayList`。您需要做的是为您的书签对象创建一个自定义适配器并在您的 ListView 上使用该适配器。

首先创建您的书签模型类。

```
public class Bookmark {

    private String title;
    private String url;
    private Drawable icon;

    public Bookmark(String title, String url, Drawable icon) {

        this.title = title;
        this.url = url;
        this.icon = icon;
    }

    public String getTitle() {
        return title;
    }

    public void setTitle(String title) {
        this.title = title;
    }

    public String getUrl() {
        return url;
    }

    public void setUrl(String url) {
        this.url = url;
    }

    public Drawable getIcon() {
        return icon;
    }

    public void setIcon(Drawable icon) {
        this.icon = icon;
    }
} 
```

然后创建您的书签适配器

```
public class BookmarkAdapter extends BaseAdapter{

    private ArrayList<Bookmark> bookmarks;
    private Context context;

    public BookmarkAdapter(Context context, ArrayList<Bookmark> bookmarks) {

        this.context = context;
        this.bookmarks = bookmarks;
    }

    public int getCount() {

        return bookmarks.size();
    }

    public Object getItem(int position) {

        return bookmarks.get(position);
    }

    public long getItemId(int arg0) {

        return 0;
    }

    public View getView(int position, View convertView, ViewGroup parent) {

         View row = convertView;
           if ( row == null ) {

               row = View.inflate( context, R.layout.row_bookmark, null );
           }

           Bookmark bookmark = (Bookmark)getItem(position);

           if (  bookmark!= null ) {

               TextView name = (TextView) row.findViewById( R.id.title );

               if ( name != null ) {

                   name.setText( bookmark.getTitle() );
               }
           }

           return row;
    }
} 
```

这`row_bookmark.xml`

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

    <TextView
        android:id="@+id/title"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:textAppearance="?android:attr/textAppearanceMedium" />

</RelativeLayout> 
```

把它放在你的`Activity`xml中

```
<ListView
    android:id="@+id/bookmark_list"
    android:layout_width="match_parent"
    android:layout_height="wrap_content" >
</ListView> 
```

在您的活动中填充列表

```
 String[] titles  = getResources().getStringArray(R.array.bookmark_titles);
   String[] urls    = getResources().getStringArray(R.array.bookmark_urls);
   TypedArray icons = getResources().obtainTypedArray(R.array.bookmark_icons);

   ArrayList<Bookmark> bookmarks = new ArrayList<Bookmark>();

   for (int i = 0; i < titles.length; i ++) {

       bookmarks.add(new Bookmark(titles[i], urls[i], icons.getDrawable(i)));
   }

   ListView bookmarkList = (ListView)findViewById(R.id.bookmark_list);
   bookmarkList.setAdapter(new BookmarkAdapter(this, bookmarks)); 
```

要在选择列表项时获取 URL，您需要设置项目单击侦听器

```
bookmarkList.setOnItemClickListener(new OnItemClickListener() {

        public void onItemClick(AdapterView<?> parent, View view, int position, long id) {

            String url = ((Bookmark)parent.getAdapter().getItem(position)).getUrl();
        }
    }); 
```

# css - 带有下拉垂直线的 CSS 菜单

> ID：13080102
> 
> 赞同：0
> 
> 时间：2012-10-26T02:50:48.843
> 
> 标签：css, menu

![CSS 菜单](../Images/1ec0e4dde81cf912a79e4590aa5fbdd5.png)

**编辑** 所以基本上我能够在html css中创建上面显示的下拉菜单，但是当我将它转换为wordpress主题时，下拉菜单不再起作用，有人可以帮助我吗？感谢！

`关于工作的家

按客户按类别

客户联系`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T03:09:45.240

我在这里使用了一个伪元素，该伪元素绝对位于 li 元素的左侧。然后，这会将其向上对接到父 UL 元素的边框。为了让底部 li 上的线与边框底部对齐，我不得不使用 top position 属性将 li 向下撞，所以我添加了一些边距，这样它就不会与它下面的任何东西重叠。

```
ul{
    padding:16px 8px 0px 0px;
    border-left:1px solid #000;   
}

li{
    display:block;
    padding-left:12px;
    position:relative;
    top:9px;
    height:20px;    
} 
```

除了使用图像，这可能是涉及最少 css 的最简单方法。

[http://jsfiddle.net/PfChj/4/](http://jsfiddle.net/PfChj/4/)

**编辑**

这是修改后的小提琴。我几乎重做了你的 css，因为我有点难以跟上那些 sub ul 和 li 孩子。有时最好使用类来提高可读性，因此您将不得不重做一些样式。子菜单位于顶部 li 的中心，现在已设置宽度。如果您不希望它位于中心并且您的顶部 li 与链接宽度一起弯曲，您可以修改它。

[http://jsfiddle.net/FYnS4/2/](http://jsfiddle.net/FYnS4/2/)

# mysql - 如何组合这些按同一字段分组的查询？

> ID：13080106
> 
> 赞同：0
> 
> 时间：2012-10-26T02:51:14.820
> 
> 标签：mysql, sql

我有以下三个查询

```
SELECT COUNT(*) as cached_type_a, DATE(datetime) as datetime
    FROM requests
    WHERE cached = 'a'
    GROUP BY DAY(datetime);

SELECT COUNT(*) as cached_type_b, DATE(datetime) as datetime
    FROM requests
    WHERE cached = 'b'
    GROUP BY DAY(datetime);

SELECT COUNT(*) as cached_type_c, DATE(datetime) as datetime
    FROM requests
    WHERE cached = 'c'
    GROUP BY DAY(datetime); 
```

是否可以将它们组合成一个包含 4 列的查询

`cached_type_a`, `cached_type_b`, `cached_type_c`, `datetime`?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T02:54:14.807

如果你只有三个可能的值`cache`，你可以使用这个，

```
SELECT DATE(datetime) as datetime,
        SUM(CASE WHEN cached = 'a' THEN 1 ELSE 0 END) cached_a,
        SUM(CASE WHEN cached = 'b' THEN 1 ELSE 0 END) cached_b,
        SUM(CASE WHEN cached = 'c' THEN 1 ELSE 0 END) cached_c
FROM requests
GROUP BY DAY(datetime) 
```

否则，如果您有多个缓存，则可以使用`Prepared Statement`

```
SET @sql = NULL;
SELECT
  GROUP_CONCAT(DISTINCT
    CONCAT(
      'SUM(CASE WHEN cached =  ''',
      cached,
      ''' then 1 ELSE 0 end) AS ',
      CONCAT('cached_',cached)
    )
  ) INTO @sql
FROM requests;

SET @sql = CONCAT('SELECT DATE(datetime) as datetime, ', @sql, ' 
                   FROM requests 
                   GROUP BY DAY(datetime)');

PREPARE stmt FROM @sql;
EXECUTE stmt;
DEALLOCATE PREPARE stmt; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T02:55:50.007

```
 SELECT COUNT(a.datetime) as cached_type_a,
        COUNT(b.datetime) as cached_type_b,
        COUNT(c.datetime) as cached_type_c,
        DATE(a.datetime) as datetime
 FROM requests a, 
      requests b,
      requests c,  
 WHERE a.cached = 'a' 
   and b.cached = 'b'
   and c.cached = 'c'
 GROUP BY DAY(a.datetime), DAY(b.datetime), DAY(c.datetime); 
```

# mysql - 如何处理 MySQL 查询的搜索变体？

> ID：13080110
> 
> 赞同：0
> 
> 时间：2012-10-26T02:51:46.640
> 
> 标签：mysql

我的**PhoneNos**表上有电话号码列表

```
ID | PhoneNo
1 | +61 2 9666 8000 
```

我们尝试在我们的**内容**表中搜索这个电话号码（即 desc 字段）

挑战实际上是：

desc 字段是文本，输入可以是任何内容，例如：

```
ContentID | Desc    
1 | bla bla ... +61 (02) 9666 8000 ... bla bla
2 | bla bla ... +61-2-9666-8000 bla bla
3 | bla bla ... +61 2 96668000 bla bla
4 | bla bla ... +61296668000 00116129668000 bla bla 
```

或者可以是从额外间距安排的任何东西，例如

```
5 | bla bla ... +61  (02) 9666   8000 ... bla bla
6 | bla bla ... +61-2 9662 0382 ... bla bla 
```

那是澳大利亚的电话号码，但它可能是美国或任何其他国家/地区，因此与 1 个特定国家/地区并不紧密。

这款手机没有任何图案，之前和之后这款手机都没有。所以它可以是任何东西。

反正有没有容易处理这种事情？我可能可以在上面构建每个条件，但我只是想知道是否有更好的解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T05:21:27.627

只需将用户输入标准化为易于搜索的格式，即“+ [ x ]”。如果用户输入额外的空格，请将其删除。如有必要，添加国家代码。从开头删除 00 并替换为 +。您甚至可以将“电话号码”分成三列，以便于搜索。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T03:02:16.873

为什么不直接从电话号码中删除特殊符号并将它们存储为数字字符串？

您需要考虑的唯一情况是 +，因为它替换了 00。

所以基本上，你的记录只有数字，你的输入只有数字。只需确保将数据库和输入中的 + 标准化为某事。

我要做的是将它们全部存储为 00 而不是 +，这样当输入带有 00 的搜索输入通过时，它会起作用，以及带有 + 的搜索。希望这是有道理的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-26T05:10:17.097

我（高度未受过教育）的想法是使用正则表达式替换（参见[此处](https://stackoverflow.com/questions/986826/how-to-do-a-regular-expression-replace-in-mysql)）。基本上去掉内容中的所有内容，除了数字和加号（感觉很笨拙吗？:)），然后用相同的处理（`\\+\d+`基本上）与您的控制字符串进行比较。这做出了相当广泛的假设，即不会有另一个随机数字/字符与您的数字匹配的字符串产生误报（我认为从概率的角度来看不太可能，但总是有可能）。

我正在修补我确信是非常低效、不优雅且可能不正确的解决方案，并意识到它无法处理带有前导`0`内括号的情况（因为这似乎不存在于其他模式中）。如果您好奇，可以[在这里](http://sqlfiddle.com/#!2/513f6/16)找到它，但我认为正则表达式解决方案可能是最有效的处理方式。

# c++ - 重载 < 运算符的正确方法？

> ID：13080112
> 
> 赞同：0
> 
> 时间：2012-10-26T02:52:08.563
> 
> 标签：c++, operator-overloading

我有一个名为 user 的类，它有一个 lname 字段。这是重载“<”运算符的正确方法吗？

```
bool User::operator<(const User& other)
{
    std::cout << "< operator was called" << std::endl;
    if (this != &other)
    {
        if (lname.compare(other.lname) == 0)
        {
            return true;
        }
    }
    return false;
} 
```

我试图在一组更复杂的事情中使用它并且它失败了 - 只是想确保这一切是正确的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T03:04:54.733

正如其他人指出的那样，您`operator<`不允许左侧为`const`. 将函数签名更改为

```
bool User::operator<(const User& other) const 
```

是一种改进。但我实际上建议将其设为非成员函数：

```
class User {
public:
    friend bool operator<(const User& u1, const User& u2);
    // ...
};

bool operator<(const User& u1, const User& u2)
{
    // ...
} 
```

一方面，在我看来，它更清晰一些。

但是，它有时也会产生技术差异。对于非成员函数，表达式会`a < b`尝试对两者进行隐式转换，`a`并`b`查看您`operator<`的重载是否可行。但是对于成员函数，隐式转换可以应用于`b`，但不能应用于`a`:`a`必须是类型`User`或派生类型。`a < b`这可能导致编译但`b < a`不编译的令人惊讶的情况。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T03:07:02.847

对我来说，将“lname”字段隐藏为私有似乎更好。

```
return lname.compare(other.getName()) < 0; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-26T02:56:27.840

尝试：

```
bool User::operator<(const User& other) const
{
    return lname.compare(other.lname) < 0;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-26T02:57:22.643

正确的实现方式`operator<`是作为 const 函数：

```
bool User::operator<( const User& other ) const 
```

这意味着该函数不会修改其成员，因此可以在类的 const 实例上调用。

# html - 完成 HTML5 视频后显示新网页

> ID：13080113
> 
> 赞同：2
> 
> 时间：2012-10-26T02:52:09.243
> 
> 标签：html, video, autoplay

我有一个自动播放视频的页面。观看完视频后，我将如何重定向和/或显示网页？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T02:56:37.263

使用[事件](http://www.whatwg.org/specs/web-apps/current-work/multipage/the-video-element.html#event-media-ended)：[_`ended`](http://www.whatwg.org/specs/web-apps/current-work/multipage/the-video-element.html#event-media-ended)

```
var videoElement = document.querySelector('video'); // or whatever
videoElement.addEventListener('ended', function (){
    window.location = 'http://newpage.com';
}); 
```

在这里查看它的实际操作：http: [//jsfiddle.net/bCBhD/](http://jsfiddle.net/bCBhD/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T02:58:40.827

“onended”是您可以使用的 html 对象的标准事件。此处的文档：http: [//www.w3schools.com/tags/ref_eventattributes.asp](http://www.w3schools.com/tags/ref_eventattributes.asp)

# c# - 以编程方式将超链接添加到不是 DisplayMode=Hyperlink 的项目符号列表

> ID：13080120
> 
> 赞同：3
> 
> 时间：2012-10-26T02:53:41.540
> 
> 标签：c#, asp.net, controls, web-controls, bulletedlist

我有一个 ASP.NET 项目符号列表控件，直到今天，它才被创建并仅用于纯文本。一个新的设计请求要求我将其中一些项目变成超链接。因此项目符号列表最终需要包含一些纯文本项和一些超链接。如果我将它更改为 DisplayMode=Hyperlink，即使我将值留空，应该只是纯文本的条目仍然会变成可点击的链接。

我认为我可以实现的一种解决方案是使用 Literal 控件并`<a href...`在需要链接的行上使用 HTML ()。这将需要重新处理一些旧代码，所以在我尝试之前，我真的很想知道这是否可能与现有的 BulletedList 相关。

* * *

**编辑：**

我真的在任何地方都找不到任何关于此的信息，而且我通常认为自己是一个非常优秀的 Google 员工。因此，对于在未来十年的某个时候发现自己处于同一场景中的一两个迷失和困惑的灵魂，这是我对下面提供的出色答案的完整实现：

在页面的代码隐藏中：

```
foreach (SupportLog x in ordered)
{
    blschedule.Items.Add(new ListItem(x.Headline, "http://mysite/Support/editsupportlog.aspx?SupportLogID=" + x.SupportLogID));
}

blschedule.DataBind(); 
```

请注意最后的 DataBind --- 这是属于 DataBound 事件的必要条件：

```
protected void blschedule_DataBound(object sender, EventArgs e)
{
    foreach (ListItem x in blschedule.Items)
    {
        if (x.Value.Contains("http")) //an item that should be a link is gonna have http in it, so check for that
        {
            x.Attributes.Add("data-url", x.Value);
        }
    }
} 
```

在 .aspx 页面的头部：

```
<script src="<%# ResolveClientUrl("~/jquery/jquery141.js") %>" type="text/javascript"></script>
    <script>

        $(document).ready(function () {

           $('#<%=blschedule.ClientID %> li').each(function () {
               var $this = $(this);
               var attr = $this.attr('data-url');

               if (typeof attr !== 'undefined' && attr !== false) {
                   $this.html('<a href="' + $this.attr('data-url') + '">' + $this.text() + '</a>');
               }
           });
       });

    </script> 
```

if 语句需要确保只将具有“data-url”属性的项目转换为链接，而不是将所有项目转换为链接。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T03:27:53.777

[`<asp:Repeater />`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.repeater.aspx)您可能会发现将用于该任务更容易。

就像是：

```
<asp:Repeater ID="Repeater1" runat="server">
    <HeaderTemplate><ul></HeaderTemplate>
    <ItemTemplate>
        <li><%# string.IsNullOrEmpty(Eval("url").ToString()) ? Eval("text") : string.Format("<a href=\"{0}\">{1}</a>", Eval("url").ToString(), Eval("text").ToString()) %></li>
    </ItemTemplate>
    <FooterTemplate></ul></FooterTemplate>
</asp:Repeater> 
```

**黑客的方式**

将 URL 值设置为`DataValueField`数据绑定时`BulletedList`

使用`DataBound`事件遍历项目并为每个项目添加一个带有 URL 值的属性

```
protected void BulletedList1_DataBound(object sender, EventArgs e)
{
    foreach (ListItem i in BulletedList1.Items)
    {
        if (i.Value.Length > 0)
        {
            i.Attributes.Add("data-url", i.Value);
        }
    }
} 
```

使用 JavaScript/jQuery 应用必要的标记：

```
$('[data-url]').each(function() {
    var $this = $(this);
    $this.html('<a href="' + $this.attr('data-url') + '">' + $this.text() + '</a>');
}); 
```

没有测试这个 jQuery 但它应该很接近

# java - Java使用finalize关闭子线程？

> ID：13080123
> 
> 赞同：2
> 
> 时间：2012-10-26T02:55:19.820
> 
> 标签：java, multithreading, console-application, finalizer

我正在编写一个多线程 Java 控制台应用程序，我打算通过 Ctrl-C 杀死它。在这种情况下，如果我有一个封装单个线程的类，在封装类的 finalize 方法中关闭子线程是一种好习惯吗？

如果您 Ctrl-C 原始应用程序并且所有线程未正确关闭，是否可以让原始应用程序的工件保持运行？

伪代码：

```
public class ParentClass {

Thread childThread = new Thread(new ExampleRunnable());

  @Override protected void finalize() throws Throwable {
   childThread.shutdown();
  }
}

public class ExampleRunnable implements Runnable {

 private volatile boolean alive = false;

 @Override
 public void run() {
  alive = true;
  while(alive) {
   //do some work
  }
 }

  public void shutdown() {
   alive = false;
  }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T03:11:39.977

实施`finalize`可能会产生非常糟糕的副作用。回到过去，Java 很慢，原因之一是需要`finalize`在每个创建的对象上运行。现在 JVM 足够聪明，可以检查是否`finalize`存在重要的实现，而不是在收集的每个对象上盲目地调用它。只有一个类工具`finalize`可能还不错，但不要养成它的习惯。

如果您想在 JVM 正常关闭期间做一些特别的事情，请使用[关闭挂钩](http://docs.oracle.com/javase/7/docs/api/java/lang/Runtime.html#addShutdownHook%28java.lang.Thread%29)。

# object - 一个不渲染的简单顶点缓冲区对象 (C++)

> ID：13080125
> 
> 赞同：3
> 
> 时间：2012-10-26T02:55:46.777
> 
> 标签：object, opengl, buffer, vbo, vertex

我试图使用 VBO 将普通的 2d 纹理正方形渲染到 FBO 上。即时模式功能完美无缺，但不是这个 VBO。代码已启用 GL_TEXTURE_2D。它有什么问题？

```
unsigned int VBOid = 0;
unsigned int Iid = 0;

float *geometry;
unsigned int *indices;

int num_geometry = 1;
int num_vertices = 4;
int num_indices = num_geometry*num_vertices;
geometry = new float[num_geometry*num_vertices*4];
indices = new unsigned int[num_indices];

indices[0] = 0;
indices[1] = 1;
indices[2] = 2;
indices[3] = 3;

/* Fill geometry: 0, 1, = vertex_xy
*                2, 3 = tex_coord_uv
*/
geometry[0] = 0.0f;
geometry[1] = 0.0f;
geometry[2] = 0.0f;
geometry[3] = 0.0f;

geometry[4] = 50.0f;
geometry[5] = 0.0f;
geometry[6] = 1.0f;
geometry[7] = 0.0f;

geometry[8] = 50.0f;
geometry[9] = 50.0f;
geometry[10] = 1.0f;
geometry[11] = 1.0f;

geometry[12] = 0.0f;
geometry[13] = 50.0f;
geometry[14] = 0.0f;
geometry[15] = 1.0f;

glGenBuffers(1, &VBOid);
glBindBuffer(GL_ARRAY_BUFFER, VBOid);
glBufferData(GL_ARRAY_BUFFER, sizeof(geometry), geometry, GL_STATIC_DRAW);

glGenBuffers(1, &Iid);
glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, Iid);
glBufferData(GL_ELEMENT_ARRAY_BUFFER, sizeof(indices), indices, GL_STATIC_DRAW);

//GL_TEXTURE_2D is already enabled here
//Buffers are already bound from above

glBindTexture( GL_TEXTURE_2D, 2); //I used 2 just to test to see if it is rendering a texture correctly. Yes, 2 does exist in my program thats why i arbitrarily used it
//glClientActiveTexture(GL_TEXTURE0); I dont know what this is for and where to put it

glEnableClientState(GL_TEXTURE_COORD_ARRAY);
//glActiveTexture(GL_TEXTURE0); same here I dont know what this is for or where to put it
glVertexPointer(2, GL_FLOAT, sizeof(GLfloat)*4, 0);
glTexCoordPointer(2, GL_FLOAT, sizeof(GLfloat)*4, (float*)(sizeof(GLfloat)*2));

glDrawElements(GL_QUADS, num_indices, GL_UNSIGNED_INT, indices);

glDisableClientState(GL_VERTEX_ARRAY);
glDisableClientState(GL_TEXTURE_COORD_ARRAY);

glBindBuffer(GL_ARRAY_BUFFER, 0);
glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, 0); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T07:21:41.060

问题是您在调用中使用`sizeof(geometry)`（和相同的`indices`） 。`glBufferData`这些变量实际上只是指针，无论它们是否指向动态分配的数组（编译器不知道）。因此，您将始终获得指针的大小（4 或 8 个字节，具体取决于平台）。

替换`sizeof(geometry)`为`num_geometry*num_vertices*4*sizeof(float)`和。`sizeof(indices)`_ `num_indices*sizeof(unsigned int)`好吧，事实上你根本不需要任何索引，只需用一个简单的

```
glDrawArrays(GL_QUADS, 0, 4); 
```

始终注意实际（编译时大小）数组和指向动态分配数组的指针之间的差异，`sizeof`运算符的结果是这些差异*之一*（以及释放后者内存的要求使用`delete[]`在稍后的某个时间点是另一个但同样重要的区别）。

# ios - 使用 openURL 在 iOS 上打开 facebook URL 会导致 Facebook 应用程序页面损坏

> ID：13080127
> 
> 赞同：6
> 
> 时间：2012-10-26T02:55:53.760
> 
> 标签：ios, facebook

当我使用“openURL”以“http://www.facebook.com/SomePage”的形式打开一个 facebook url 时，它会被 Facebook 应用程序打开，并导致页面损坏（大部分屏幕是空白），或用户的“时间线”（取决于设备和应用程序的版本）。有什么办法可以强制 URL 转到 Safari？我不介意 facebook 应用程序接管 URL，但如果它不知道如何处理它，我宁愿让 Safari 来做。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-29T18:21:12.993

正如 pj4533 建议的那样，删除“www”。从网址的前面解决了这个问题。将此添加为答案，以便将其标记为答案并且对其他人更明显。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-19T14:41:33.083

最新的 facebook 应用程序有一个错误/功能，当您使用带有短名称的 url 时，它会打开最后一页或用户的新闻提要。您需要使用用户/组 ID。

您可以使用图形 API [https://graph.facebook.com/SHORT_NAME](https://graph.facebook.com/SHORT_NAME)在属性“id”下找到它

例子 ：

```
https://www.facebook.com/stackoverflowpage
https://www.facebook.com/11239244970 
```

只需在此处粘贴页面 URL [http://findmyfacebookid.com/](http://findmyfacebookid.com/)，您将获得页面 ID。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-26T07:59:50.010

请让我知道这对你有用吗，因为它对我来说很好......

```
[[UIApplication sharedApplication] openURL:[NSURL URLWithString: @"http://www.facebook.com/"]]; 
```

# ember.js - 在 Ember-Data 中同时保存孩子和孩子

> ID：13080130
> 
> 赞同：4
> 
> 时间：2012-10-26T02:56:28.213
> 
> 标签：ember.js, ember-data

在玩 ember 时，我试图同时拯救父母和孩子。我注意到孩子的 parent_id 总是被设置为零。

然后我在 GitHub 上看到了[这个问题。](https://github.com/emberjs/data/issues/437)似乎该功能已从 Ember-Data 中删除，但稍后将恢复。在那之前，我们将推出我们自己的适配器来做到这一点。

阅读@tomdale 的回复，实施起来似乎并不难，但我有一些实施问题。

您如何判断记录的 belongsTo 关联何时发生了变化？这将在什么适配器钩子下进行？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T17:51:40.130

商店跟踪与特殊对象的关系变化。您可以向商店询问更改对象的关系，如下所示：

```
store.relationshipChangeFor(child.get('clientId'), belongsToAssociationName); 
```

如果没有进行任何更改，它将不会返回任何内容。

但很可能你永远不需要这样做。在关系数据存储的情况下，子记录将负责保持其 belongsTo 关联。成功创建/更新后，您可以盲目地将所有这些关系标记为已解决，并且商店不会关心其中一些实际上是否不脏。

事实上，这正是现在[所做](https://github.com/emberjs/data/blob/master/packages/ember-data/lib/adapters/rest_adapter.js#L34)`DS.RESTAdapter`的：

```
DS.RESTAdapter = DS.Adapter.extend({
  // ...

  didSaveRecord: function(store, record, hash) {
    record.eachAssociation(function(name, meta) {
      if (meta.kind === 'belongsTo') {
        store.didUpdateRelationship(record, name);
      }
    });

    store.didSaveRecord(record, hash);
  }

  // ...
}); 
```

无论何时何地您决定准备将关系标记为已解决，只需调用`store.didUpdateRelationship(child, belongsToAssociationName)`.

* * *

话虽如此，真正的诀窍并不是将关系标记为已解决（因为这已经实现了）——它是将子节点的保存延迟到父节点创建之后。

我们实际上已经提交[了一个拉取请求](https://github.com/emberjs/data/pull/440)，就是这样做的。如果它对您的帮助与对我们的帮助一样多，我们将感谢您对请求的支持。

# ios - 取消或重新安排本地通知的推送通知？

> ID：13080138
> 
> 赞同：2
> 
> 时间：2012-10-26T02:57:36.763
> 
> 标签：ios, push-notification, uilocalnotification, alarm

我们正在研究构建一个警报风格的 iOS 应用程序作为网站的扩展。

我们计划通过推送通知将警报发送到设备。我们还希望将本地通知设置为比计划的推送通知稍晚一点的时间，以防万一没有网络连接并且推送通知无法到达用户。

但是，我们想取消这个本地通知，并在收到推送通知时重新安排它，这样它就不会因为不必要的通知而惹恼用户。

基本上有两种类型的推送通知：

*   设置为发送的实际警报（正常能力）
*   没有警报，但将本地通知重置为在下一个计划的警报时间之后一点点（未知能力）

这是一种可能吗？

也许有一些变通方法，比如能够像只处理推送通知的音频应用程序一样留在后台，我们可以要求苹果公司特别批准？

获得这样的特殊批准有多普遍？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T01:15:55.647

我不确定，像 Anthony Corbelli 一样，推送通知的原因是如果您要为相同的警报设置本地通知。

在任何情况下，如果您想从推送通知处理程序中取消和/或重新安排现有的 UILocalNotification，您可以获取通知列表

```
[[UIApplication sharedApplication]scheduledLocalNotifications] 
```

然后取消你想要的

```
[[UIApplication sharedApplication]cancelLocalNotification] 
```

然后，您可以根据需要修改通知（例如，将其 fireDate 移到未来）并根据需要重新安排它。

# c# - Kinect：如何用 PNG 图片而不是 DrawLine 绘制骨骼？

> ID：13080139
> 
> 赞同：0
> 
> 时间：2012-10-26T02:57:35.890
> 
> 标签：c#, wpf, xaml, kinect, system.drawing

Kinect：如何用 PNG 图片而不是 DrawLine 绘制骨骼？

[我想要这样的结果 http://www.hotzehwc.com/Resource-Center/Wellness-101/skeleton2.aspx](http://www.hotzehwc.com/Resource-Center/Wellness-101/skeleton2.aspx)

我将从 Kinect 获取关节位置。

```
JointA.x;
JointA.y;

JointB.x;
JointB.y; 
```

关节位置会发生变化，因此两个关节之间的 PNG 连接需要调整大小和旋转。

有任何示例代码可以使这更容易吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T03:40:57.257

理想情况下，您会想要使用 DrawLine 和其他内部绘图函数，以便您可以适当地缩放骨骼。让他们一开始看起来正确要困难得多。

使用图像，您可能希望将它们切割成单独的部分。Kinect 有一系列关节，连接线将是骨骼。首先查看由 Microsoft 提供的 SDK 工具包中的 SkeletonBasics-WPF 示例——它将向您展示它们在关节之间构建骨骼。

现在，您想以这样一种方式切割您的骨架图像，使每个图像有 1 个骨骼。`Image`在 XAML 中为每个图像创建一个对象。找出关节在图像中的位置——例如，肘部将靠近肱骨图像的底部，但可能在图像中只有几个像素，并且会朝向中间（宽度方向）。

当您从骨架中获取关节位置时，将图像中的适当坐标转换为这些位置。这将是很多数学！您将获得给定骨骼的关节，然后计算如何将骨骼图像转换为正确的位置和角度。

# javascript - 重新评估匿名构造函数的原型绑定可追溯至原始实例化对象

> ID：13080141
> 
> 赞同：0
> 
> 时间：2012-10-26T02:58:00.620
> 
> 标签：javascript, oop

这更像是一个理论问题，而不是一个如何做的问题。我正在做一个项目，其中对象可以“区分”成几种不同的类型，所以我决定探索一些 Javascript 的动态特性，但有一件事情让我非常困惑：

```
OriginalConstructor = function() {this.value = 42;}
originalInstance = new OriginalConstructor();
ModifiedConstructor = eval(originalInstance.constructor);
ModifiedConstructor.prototype.addedFunction = function(x) {return this.value + x;}
modifiedInstance = new ModifiedConstructor();
document.write("modified: " + modifiedInstance.addedFunction(10));
document.write("<br>original: " + originalInstance.addedFunction(20)); 
```

为什么`addedFunction`一定要`originalInstance`，即使`ModifiedConstructor`被抄通过`eval()`？当然这两个构造函数不能有相同的引用，不是吗？

有没有办法在不影响已经从同一个构造函数实例化的其他对象的情况下修改一个对象（或未来的实例）？我知道还有其他方法可以解决这个问题，但我想更深入地了解 Javascript。感谢您提供的任何见解。

@Felix Kling：感谢您提供快速、清晰和完整的答案。出于某种原因，我认为构造函数属性是一个可以由 eval() 解析的字符串，所以现在我明白为什么这不起作用了。我仍然没有完全理解原型继承，但至少现在我知道我需要研究什么。谢谢！

编辑：我现在明白了。如果您来自经典 OOP 的背景，原型继承似乎很奇怪，但它在概念上更简单，更容易理解，而且在某些方面它实际上更强大。如果你想了解更多关于 Javascript 的原型继承，我强烈推荐这些文章：

[http://javascript.crockford.com/prototypal.html](http://javascript.crockford.com/prototypal.html)

[http://www.laktek.com/2011/02/02/understanding-prototypical-inheritance-in-javascript/](http://www.laktek.com/2011/02/02/understanding-prototypical-inheritance-in-javascript/)

[http://blog.vjeux.com/2011/javascript/how-prototypal-inheritance-really-works.html](http://blog.vjeux.com/2011/javascript/how-prototypal-inheritance-really-works.html)

[http://howtonode.org/prototypical-inheritance](http://howtonode.org/prototypical-inheritance)

此外，如果您需要这种灵活性，您可能需要考虑使用“实体系统”，它可以提供一些优点作为复杂继承层次结构的替代方案。大多数关于实体系统的文章都关注游戏开发，但我认为这种架构也可以用于其他应用程序。对于 OOP 程序员来说，这是一个非常陌生的概念，所以抛开你所知道的关于 OOP 的一切，更多地从关系数据库设计的角度来思考。看看这个：

[http://cowboyprogramming.com/2007/01/05/evolve-your-heirachy/](http://cowboyprogramming.com/2007/01/05/evolve-your-heirachy/)

[http://t-machine.org/index.php/2007/09/03/entity-systems-are-the-future-of-mmog-development-part-1/](http://t-machine.org/index.php/2007/09/03/entity-systems-are-the-future-of-mmog-development-part-1/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T03:03:17.967

`ModifiedConstructor` **不是**的副本`OriginalConstructor`，它是一个相同的功能。

[`eval`的算法](http://es5.github.com/#x15.1.2.1)中的第一条指令是：

> 如果 Type( *x* ) 不是字符串，则返回*x*。

即，您只需取回您传入的内容。`OriginalConstructor === ModifiedConstructor`产量`true`。

> 有没有办法在不影响已经从同一个构造函数实例化的其他对象的情况下修改一个对象（或未来的实例）？

您可以通过原型继承：

```
ModifiedConstructor = function() {
    OriginalConstructor.apply(this, arguments);
};

ModifiedConstructor.prototype = Object.create(OriginalConstructor.prototype);
ModifiedConstructor.prototype.constructor = ModifiedConstructor; 
```

现在您可以在`ModifiedConstructor.prototype`不影响由`OriginalConstructor`.

如果您只想防止已创建的实例被扩展，您可以只覆盖`OriginalConstructor.prototype`，但这不是一个干净的解决方案，并且还会破坏`instanceOf`现有实例。

# c - Glibc 的实现中的 strtol 感到困惑

> ID：13080142
> 
> 赞同：0
> 
> 时间：2012-10-26T02:58:00.543
> 
> 标签：c, glibc

最近我正在阅读 Glibc(2.16) 最新版本的源代码。在上时`strtol`，我得到了以下代码

```
/* some other code ... */
while (*nptr >= '0' && *nptr <= '9') {
    unsigned long int digval = *nptr - '0';
        if (result > LONG_MAX / 10 ||
            (sign > 0 ? result == LONG_MAX / 10 && digval > LONG_MAX % 10
                : (result == ((unsigned long int) LONG_MAX + 1) / 10 &&
                      digval > ((unsigned long int) LONG_MAX + 1) % 10))) {
                        errno = ERANGE;
                        return sign > 0 ? LONG_MAX : LONG_MIN;
                }
                result *= base;
                result += digval;
                ++nptr;
} 
```

判断`ERANGE`错误的代码可能看起来很难阅读，为了更清楚，我这样重新编码

```
unsigned long int 
is_overflow(unsigned long int result, int sign, int digval) {
    if (result > LONG_MAX / 10) {
        goto error;
    }

    if (sign > 0) {
        if (result == LONG_MAX / 10 && digval > LONG_MAX % 10)
            goto error:
    } else {
        if (result == ((unsigned long int) LONG_MAX + 1) / 10 &&
                    digval > ((unsigned long int) LONG_MAX + 1) % 10)
                    goto error;
    }

error: 
    errno = ERANGE;
    return sign > 0 ? LONG_MAX : LONG_MIN;
} 
```

我编写了一些代码来测试 long-if 语句：

```
#include <stdio.h>
#define LONG_MAX 2147483647L
int main() {
        int sign = 0;
        int expr_val = 0;
        int digval = '2';

        /* without any modification */
        expr_val = LONG_MAX / 10 && digval > LONG_MAX % 10;
        printf("%d\n", expr_val);

        expr_val = (unsigned long int) LONG_MAX + 1) / 10 &&
                digval > ((unsigned long int) LONG_MAX + 1) % 10;
        printf("%d\n", expr_val);

        return 0;
} 
```

这些 glibc 源代码好像判断是否`result`等于`true`，因为`expr_val`总是等于`true`。

我的问题是为什么代码添加这样的测试`result`，是

```
result > LONG_MAX / 10 
```

足以判断连续溢出？`result == 1`并且无论`result == 0`它始终是有效的数字值，作者为什么要这样做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T03:21:46.043

```
if (result == LONG_MAX / 10 && digval > LONG_MAX % 10) 
```

方法

```
if ((result == LONG_MAX / 10) && (digval > LONG_MAX % 10)) 
```

并不是

```
if (result == (LONG_MAX / 10 && digval > LONG_MAX % 10)) 
```

`result > LONG_MAX / 10`仅检查是不够的，因为例如使用您的值`LONG_MAX`，如果`result`是`214748364`，那么我们还需要检查`digval`，因为`1`不会溢出，但`9`会溢出。

# android - 使用 ViewHolder 类使应用程序加载更快

> ID：13080143
> 
> 赞同：0
> 
> 时间：2012-10-26T02:58:15.873
> 
> 标签：android, json, performance, gridview, adapter

我已经制作了从 json 获取图像路径的 gridview 应用程序。它可以找到但是当它加载时它很慢。我试图找到解决方案，他们建议我使用 ViewHolder，但我不知道如何在我的 gridview 应用程序中使用。

如何在我的应用程序中使用 ViewHolder？我如何加快我的申请？

这段代码可以找到，但加载速度很慢。

```
public class MainActivity extends Activity {

String strUrl = "http://192.168.10.104/adchara1/";
GridView gridView;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    // Creating a new non-ui thread task to download json data
    DownloadTask downloadTask = new DownloadTask();

    // Starting the download process
    downloadTask.execute(strUrl);

    gridView = (GridView) findViewById(R.id.lv_countries);        
    gridView.setOnItemClickListener(new OnItemClickListener() {

        public void onItemClick(AdapterView<?> parent, View v, int positon,
                long id) {

             HashMap<String, Object> hm = (HashMap<String, Object>) gridView.getAdapter().getItem(positon);
             String imgPath = (String) hm.get("photo"); //get downloaded image path
             Intent i = new Intent(MainActivity.this, DisplayActivity.class); //start new Intent to another Activity.
             i.putExtra("ClickedImagePath", imgPath ); //put image link in intent.
             startActivity(i);
        }
    });
}

/** A method to download json data from url */
private String downloadUrl(String strUrl) throws IOException{
  String data = "";
  InputStream iStream = null;

    HttpClient httpClient = new DefaultHttpClient();
    HttpPost httpPost = new HttpPost(strUrl);
    ArrayList<NameValuePair> param = new ArrayList<NameValuePair>();
    try {
        httpPost.setEntity(new UrlEncodedFormEntity(param));
        HttpResponse httpResponse = httpClient.execute(httpPost);
        HttpEntity httpEntity = httpResponse.getEntity();
        iStream = httpEntity.getContent();
    } catch (Exception e) {
        Log.e("log_tag", "Error in http connection " + e.toString());
    }
    try {
        BufferedReader br = new BufferedReader(new InputStreamReader(iStream));
        StringBuilder sb = new StringBuilder();
        String line = "";
        while((line = br.readLine()) != null){
            sb.append(line + "\n");
        }
        iStream.close();
        data = sb.toString();
    } catch (Exception e) {
        Log.e("log_tag", "Error converting result " + e.toString());
    }
    return data;
}

/** AsyncTask to download json data */
private class DownloadTask extends AsyncTask<String, Integer, String>{
    String data = null;
    @Override
    protected String doInBackground(String... url) {
        try{
            data = downloadUrl(url[0]);
        }catch(Exception e){
            Log.d("Background Task",e.toString());
        }
        return data;
    }

    @Override
    protected void onPostExecute(String result) {

        // The parsing of the xml data is done in a non-ui thread
        GridViewLoaderTask gridViewLoaderTask = new GridViewLoaderTask();

        // Start parsing xml data
        gridViewLoaderTask.execute(result);
    }
}

/** AsyncTask to parse json data and load ListView */
private class GridViewLoaderTask extends AsyncTask<String, Void, SimpleAdapter>{

    JSONObject jObject;
    // Doing the parsing of xml data in a non-ui thread
    @Override
    protected SimpleAdapter doInBackground(String... strJson) {
        try{
            jObject = new JSONObject(strJson[0]);
            CountryJSONParser countryJsonParser = new CountryJSONParser();
            countryJsonParser.parse(jObject);
        }catch(Exception e){
            Log.d("JSON Exception1",e.toString());
        }

        // Instantiating json parser class
        CountryJSONParser countryJsonParser = new CountryJSONParser();

        // A list object to store the parsed countries list
        List<HashMap<String, Object>> countries = null;

        try{
            // Getting the parsed data as a List construct
            countries = countryJsonParser.parse(jObject);
        }catch(Exception e){
            Log.d("Exception",e.toString());
        }

        // Keys used in Hashmap
        String[] from = { "frame","photo"};

        // Ids of views in listview_layout
        int[] to = { R.id.iv_frame,R.id.iv_photo};

        // Instantiating an adapter to store each items
        // R.layout.listview_layout defines the layout of each item
        SimpleAdapter adapter = new SimpleAdapter(getBaseContext(), countries, R.layout.lv_layout, from, to);
        return adapter;
    }

    /** Invoked by the Android on "doInBackground" is executed */
    @Override
    protected void onPostExecute(SimpleAdapter adapter) {

        // Setting adapter for the listview
        gridView.setAdapter(adapter);

        for(int i=0;i<adapter.getCount();i++){
            HashMap<String, Object> hm = (HashMap<String, Object>) adapter.getItem(i);
            String frameUrl = (String) hm.get("frame_path");
            String imgUrl = (String) hm.get("photo_path");
            ImageLoaderTask imageLoaderTask = new ImageLoaderTask();

            HashMap<String, Object> hmDownload = new HashMap<String, Object>();
            hm.put("frame_path", frameUrl);
            hm.put("photo_path",imgUrl);
            hm.put("position", i);

            // Starting ImageLoaderTask to download and populate image in the listview
            imageLoaderTask.execute(hm);
        }
    }
} 

    /** AsyncTask to download and load an image in ListView */
    private class ImageLoaderTask extends AsyncTask<HashMap<String, Object>, Void, HashMap<String, Object>>{

        @Override
        protected HashMap<String, Object> doInBackground(HashMap<String, Object>... hm) {

            InputStream iStream = null;
            String imgUrl;
            String frameUrl;
            imgUrl = (String) hm[0].get("photo_path");
            frameUrl = (String) hm[0].get("frame_path");
            int position = (Integer) hm[0].get("position");

            URL url;
            URL urlFrame;
            try {
                url = new URL(imgUrl);
                urlFrame = new URL(frameUrl);
                // Creating an http connection to communicate with url
                HttpURLConnection urlConnection = (HttpURLConnection) url
                        .openConnection();

                // Connecting to url
                urlConnection.connect();

                // Reading data from url
                iStream = urlConnection.getInputStream();

                // Getting Caching directory
                File cacheDirectory = getBaseContext().getCacheDir();

                // Temporary file to store the downloaded image
                File tmpFile = new File(cacheDirectory.getPath() + "/wpta_"+ position + ".png");

                // The FileOutputStream to the temporary file
                FileOutputStream fOutStream = new FileOutputStream(tmpFile);

                // Creating a bitmap from the downloaded inputstream
                Bitmap b = BitmapFactory.decodeStream(iStream);

                // Writing the bitmap to the temporary file as png file
                b.compress(Bitmap.CompressFormat.PNG, 100, fOutStream);

                // Flush the FileOutputStream
                fOutStream.flush();

                // Close the FileOutputStream
                fOutStream.close();

                // Create a hashmap object to store image path and its position in the listview
                HashMap<String, Object> hmBitmap = new HashMap<String, Object>();

                // Storing the path to the temporary image file
                hmBitmap.put("photo", tmpFile.getPath());
                hmBitmap.put("frame", tmpFile.getPath());

                // Storing the position of the image in the listview
                hmBitmap.put("position", position);

                // Returning the HashMap object containing the image path and position
                return hmBitmap;
            } catch (MalformedURLException e) {
                return null;
            } catch (FileNotFoundException e) {
                return null;
            } catch (IOException e) {
                return null;
            }
        }

    @Override
    protected void onPostExecute(HashMap<String, Object> result) {
        // Getting the path to the downloaded image
        String path = (String) result.get("photo");
        String framePath = (String) result.get("frame");
        // Getting the position of the downloaded image
        int position = (Integer) result.get("position");

        // Getting adapter of the listview
        SimpleAdapter adapter = (SimpleAdapter ) gridView.getAdapter();

        // Getting the hashmap object at the specified position of the listview
        HashMap<String, Object> hm = (HashMap<String, Object>) adapter.getItem(position);

        // Overwriting the existing path in the adapter
        hm.put("photo",path);
        hm.put("frame", framePath);
        // Noticing listview about the dataset changes
        adapter.notifyDataSetChanged();
    }
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T03:05:19.377

您应该阅读[此处](http://docs.huihoo.com/google/io/2009/Th_0230_TurboChargeYourUI-HowtomakeyourAndroidUIfastandefficient.pdf)的幻灯片以提高性能。它包含使用 ViewHolder 的示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T04:19:14.210

看看我们在 Google I/O 2010 上的 Google Guys。他们在 Android 团队中有一个由谷歌软件工程师主持的会议，讨论了 ListView 和相关的东西，包括如何使用 ViewHolder 类优化 listview 的使用。我想你可以从中学到一些东西。这是链接[Google I/O 2010 - ListView Session](http://www.google.com/events/io/2010/sessions/world-of-listview-android.html)

# javascript - 使用 Javascript 在网页中查找 LaTex 指令的正则表达式

> ID：13080144
> 
> 赞同：4
> 
> 时间：2012-10-26T02:58:27.197
> 
> 标签：javascript, regex, latex, mathjax

我需要替换网页中的 LaTex 指令。LaTex 指令包含在两个“$”符号中，类似于 $a^2+b^2=1$（内联公式）或 $$a^2+b^2=1$$（将显示在新行中）。现在的问题是我想使用 Javascript 用一些图片（对应于这些指令）替换这些指令，因为浏览器本身显然无法以 LaTex 样式显示这些公式。（见图）[a^2+b^2=1](http://latex.codecogs.com/png.latex?a%5E2+b%5E2=1)如何使用正则表达式来做到这一点？我在下面展示了我的工作，但有一些问题。对于内联公式，我使用：

```
var reg = /\$([^$]|(\\$))*\$(?=[^$])/mg 
```

这意味着我想要一些以 $ 开头的文本，然后是 'not $' 还是 '\$' 或什么都没有，并以 '$' 结尾，但结尾之后不允许 $ 上升。听起来不错.. 但是对于像：$a^2\$b^2$ 这样的文本，我希望它会显示为（见图）[a^2\$b^2](http://latex.codecogs.com/png.latex?a%5E2%5C%24b%5E2)，但事实是正则表达式只替换了它就像'*replaced*b^2$'。我需要一些帮助~~

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T05:52:10.307

以下正则表达式

```
/(\${1,2})((?:\\.|.)*)\1/ 
```

将匹配包含在单美元或双美元中的 LaTex 块。请注意使用反向引用 \1 来匹配开始标记。

如果 LaTex 块可以扩展 ovver 行边界，则使用

```
/(\${1,2})((?:\\.|[\s\S])*)\1/ 
```

要在字符串中进行全局替换，请说`source`：

```
source.replace (/(\${1,2})((?:\\.|[\s\S])*)\1/g, function (m, tag, src) {
  // m is the entire match
  // tag is '$' or '$$' 
  // src is the internal text

  var rslt = ''; 

  // create what you want to appear in rslt.

  return rslt;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-03-09T09:25:11.223

以下正则表达式包括新行（有时您有很大的公式，因此有多行）：

`/(\${1,2})[^]*?[^\\]\1/gm`

如果您还想匹配分隔符之外的文本：

`/(\${1,2})[^]*?[^\\]\1|[^\$]+\1/gm`

[测试](https://regex101.com/r/4oL7ir/1)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T04:23:23.160

我不知道 LaTex，但看起来你正试图用一行代码做太多事情。尝试如下的逻辑 if else 语句：

```
if (var reg =/\$\$(.*?)\$\$/msg
    {block_formula=$1}

elsif (var reg=/\$(.*?)\$/msg
    {inline_formula=$1} 
```

这意味着“如果 reg 以 $$ 开头和结尾，它是一个包含 $$ 之间的任何内容的块公式。否则，如果 reg 以 $ 开头和结尾，它是一个包含 $ 之间的任何内容的内联公式。”

此外，如果它只是替换正则表达式的一部分，请务必放置 -s 标志以确保它与所有实例匹配。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-26T16:24:01.650

我不知道 LaTex，但看起来你正试图用一行代码做太多事情。尝试如下的逻辑 if else 语句：

if (var reg =/\$\$(.*?)\$\$/msg {block_formula=$1}

elsif (var reg=/\$(.*?)\$/msg {inline_formula=$1}

这意味着“如果 reg 以 $$ 开头和结尾，它是一个包含 $$ 之间的任何内容的块公式。否则，如果 reg 以 $ 开头和结尾，它是一个包含 $ 之间的任何内容的内联公式。”

编辑：尝试正则表达式更像 /(\${1,2})(\S{2,10}=\d+)$1/ 如果公式总是以 = 和数字结尾，以捕捉中间的那些 \$ . 如果这不起作用，请提供更多示例，以便我们找到匹配项。

# spring - 在 Cobertura 检测类的情况下，Spring @Autowired 失败

> ID：13080147
> 
> 赞同：12
> 
> 时间：2012-10-26T02:58:42.520
> 
> 标签：spring, maven, instrumentation, autowired, cobertura

### 问题

Cobertura 仪器在特定情况下会破坏自动接线的弹簧。有谁知道如何解决这个问题？

### 设想

*   我正在使用 cobertura-maven-plugin 版本 2.5.1 运行 MVN 3.0.4。
*   mvn 测试运行没有问题
*   mvn compile、package 等也可以正常运行。
*   mvn cobertura:cobertura 在添加 2 个新功能之前也没有任何问题，这些新功能引入了许多新类，包括两个新的 com.mycompany.executor 执行器类。（示例：除了现有的 MyExecutor 之外，还添加了 MyHappyExecutor 和 MySadExecutor）
*   从 cobertura 检测过程中排除 MyExecutor 似乎可以修复自动装配
*   检查 spring 自动装配输出确认正确的 bean 正在自动装配。

### 故障点

尝试在 myService 中自动装配 myExecutor 的检测版本时，自动装配失败。这在添加 MyHappyExecutor 和 MySadExecutor 之前运行良好。MyHappyExecutor 和 MySadExecutor 是自动装配的，并专门在 MyExecutor 中使用。

我在下面附上了异常输出。请不要编辑类和包名称。

```
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'myService': Injection of autowired dependencies failed; 
nested exception is org.springframework.beans.factory.BeanCreationException: Could not autowire field: private com.mycompany.executor.MyExecutor com.mycompany.service.impl.MyServiceImpl.myExecutor; 
nested exception is java.lang.IllegalArgumentException: Can not set com.mycompany.executor.MyExecutor field com.mycompany.service.impl.MyServiceImpl.myExecutor to $Proxy20 
```

### 结论

Cobertura 仪表过程中的某些东西弄乱了 Springs 的自动装配。

### 更新 1

强制 CGLIB 类代理会将错误类型更改为“java.lang.NoClassDefFoundError”错误。这会影响标准测试目标以及 Cobertura 目标。

```
<aop:config proxy-target-class="true"/> 
```

### 更新 2

这是相关 3 个类的 springs 启动过程的输出。

```
2012-11-01 16:21:51 INFO  [main] Overriding bean definition for bean 'myExecutor': replacing [Generic bean: class [com.mycompany.executor.MyExecutor]; scope=; abstract=false; lazyInit=false; autowireMode=1; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=null; factoryMethodName=null; initMethodName=null; destroyMethodName=null; defined in class path resource [configuration.xml]] with [Generic bean: class [com.mycompany.executor.MyExecutor]; scope=; abstract=false; lazyInit=false; autowireMode=1; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=null; factoryMethodName=null; initMethodName=null; destroyMethodName=null; defined in class path resource [configuration.xml]] - (DefaultListableBeanFactory.java:623)
2012-11-01 16:21:51 INFO  [main] Overriding bean definition for bean 'happyExecutor': replacing [Generic bean: class [com.mycompany.executor.HappyExecutor]; scope=; abstract=false; lazyInit=false; autowireMode=1; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=null; factoryMethodName=null; initMethodName=null; destroyMethodName=null; defined in class path resource [configuration.xml]] with [Generic bean: class [com.mycompany.executor.HappyExecutor]; scope=; abstract=false; lazyInit=false; autowireMode=1; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=null; factoryMethodName=null; initMethodName=null; destroyMethodName=null; defined in class path resource [configuration.xml]] - (DefaultListableBeanFactory.java:623)
2012-11-01 16:21:51 INFO  [main] Overriding bean definition for bean 'sadExecutor': replacing [Generic bean: class [com.mycompany.executor.SadExecutor]; scope=; abstract=false; lazyInit=false; autowireMode=1; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=null; factoryMethodName=null; initMethodName=null; destroyMethodName=null; defined in class path resource [configuration.xml]] with [Generic bean: class [com.mycompany.executor.SadExecutor]; scope=; abstract=false; lazyInit=false; autowireMode=1; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=null; factoryMethodName=null; initMethodName=null; destroyMethodName=null; defined in class path resource [configuration.xml]] - (DefaultListableBeanFactory.java:623) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-07-23T21:02:40.460

另一种选择是让执行器实现一个接口（比如说执行器）并在 MyService 中使用接口注入。Spring 将知道如何构建代理以实现接口。大多数时候，我更喜欢这种方法来代替 proxyTargetClass。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T02:55:15.297

对于您的测试，您需要设置`proxyTargetClass=true`

```
@EnableTransactionManagement(mode=AdviceMode.ASPECTJ, proxyTargetClass=true) 
```

如果这适用于您的测试，但是当您运行您的应用程序时它失败了，那么您需要为测试和您的应用程序单独配置。测试配置集`proxyTargetClass=true`和应用配置集`proxyTargetClass=false`

对于您的`NoClassDefFoundError`错误，我们需要查看堆栈跟踪。你可能没有包含 spring-aop 库

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-02-16T16:25:59.413

我们有一个关于 Aspect 和包私有类的类似问题。我们的修复非常简单，因为我们可以将我们的包私有类公开。

在那之后，还有更多关于 cobertura 的问题，我们搬到了 JaCoCo，并且对结果非常满意。默认情况下，使用 cobertura 的 maven 构建是这样配置的：

*   运行测试
*   通过 cobertura 检测代码
*   再次运行测试并测量覆盖率

由于 JaCoCo 使用代理而不是字节码工具来测量代码覆盖率，因此测试只运行一次，从而使构建方式更快。

如果您需要有关设置 JaCoCo 的更多信息，请参阅[此链接。](https://www.petrikainulainen.net/programming/maven/creating-code-coverage-reports-for-unit-and-integration-tests-with-the-jacoco-maven-plugin/)

# objective-c - UIImagePickerController 和应用程序后台模式

> ID：13080153
> 
> 赞同：1
> 
> 时间：2012-10-26T02:59:14.087
> 
> 标签：objective-c, xcode, uiimagepickercontroller, mpmovieplayercontroller, avaudiosession

我正在构建一个支持视频播放和录制的应用程序（不是同时，它只是它提供的两个独立的功能）。为了在应用程序进入后台并返回后播放视频，我必须在 plist 中添加一个`App plays audio`项目`Required background modes`（我`MPMoviePlayerController`用于播放）。

但是，这会导致我的视​​频录制出现问题（我正在使用`UIImagePickerController`它）。基本上，即使选择器被关闭（通过取消按钮或完成选择媒体时），应用程序仍然保持音频录制会话运行。

如果我`App plays audio`从 plist 中删除该项目，ImagePickerController 的音频会话将停止异常行为，但是我无法`MPMoviePlayerViewController`在从后台模式切换到应用程序时恢复播放。

有没有办法可以自定义音频会话的处理，以便`MPMoviePlayerController`和`UIImagePickerController`都可以正常工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T06:25:59.043

是的，有一种方法可以根据您的需要自定义音频会话的处理：不要尝试设置`App plays audio`设置。

相反，在您的 AppDelegate 代码（通常在提供的简单向导项目中的 AppDelegate.m 中）中，在`applicationWillResignActive:`方法中提供将停止播放的代码`MPMoviePlayerController`，然后用于`applicationDidBecomeActive:`在暂停时恢复播放如果需要的话。

这不仅允许视频在临时暂停后恢复，而且还允许您保存状态，以便在应用程序从内存中删除或用户导致它退出的情况下可以恢复视频。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T14:33:25.050

您可以从头开始使用背景模式，而是使用通知来暂停/恢复播放器。请参阅[UIApplication 类参考](https://developer.apple.com/library/ios/#documentation/UIKit/Reference/UIApplication_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40006728)中的`UIApplicationDidBecomeActiveNotification`和。`UIApplicationWillResignActiveNotification`

您可以获取一些代码并在[此类](http://code.google.com/p/cooliris-toolkit/source/browse/Classes/MovieView.m?r=e57b03fa47b60012428f1b953001751ef165963f)中看到它的实现。以下是该类的一些相关代码：

```
[[NSNotificationCenter defaultCenter] addObserver:self
                                             selector:@selector(_didBecomeActive:)
                                                 name:UIApplicationDidBecomeActiveNotification
                                               object:nil];
[[NSNotificationCenter defaultCenter] addObserver:self
                                         selector:@selector(_willResignActive:)
                                             name:UIApplicationWillResignActiveNotification
                                           object:nil];

- (void) _didBecomeActive:(NSNotification*)notification {
  if (_wasPlaying) {
    [_movieController play];
  }
}

- (void) _willResignActive:(NSNotification*)notification {
  _wasPlaying = _movieController.currentPlaybackRate != 0.0;
  if (_wasPlaying) {
    [_movieController pause];
  }
} 
```

# ruby - Rails 3 - 部分不渲染

> ID：13080159
> 
> 赞同：0
> 
> 时间：2012-10-26T03:00:45.707
> 
> 标签：ruby, ruby-on-rails-3, partial-views

在我看来，我有以下几点：

```
<div class="subject edit">
<%= form_for(:subject, :url => {:action => 'update', :id => @subject.id}) do |f| %>

<%= render(:partial => "form", :locals => {:f => f}) %>

<div class="form-buttons">
    <%= submit_tag("Update Subject") %>
</div>

<% end %> 
```

在同一个文件夹中，我创建了一个部分 (_form.html.erb)。但由于某种原因，它没有被渲染。

_form.html.erb：

```
<table summary="Subject form fields">
    <tr>
        <th>Name</th>
        <td><%= f.text_field(:name) %></td>
    </tr>
    <tr>
        <th>Position</th>
        <td><%= f.text_field(:position) %></td>
    </tr>
    <tr>
        <th>Visible?</th>
        <td><%= f.text_field(:visible) %></td>
    </tr> 
```

我正在运行rails 3.2.7。有人能看出我做错了什么吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T03:09:05.270

服务器重置解决了这个问题。嗬！

# r - 将排序函数应用于R中的矩阵后向量的作用

> ID：13080160
> 
> 赞同：-3
> 
> 时间：2012-10-26T03:01:03.290
> 
> 标签：r

`I`对矩阵列应用排序后向量的作用是什么`s`？

```
 n = 10
    I = c(2, 8)
    s = matrix(runif(n*20), nrow=20)
    M  = apply(s, 2, sort)[I,] 
```

我们可以用另一种更简单的方式编写这段代码吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T03:21:54.347

R 的幂是不是通过单个值而是通过向量来索引向量或数组。假设以下示例：

```
foo = 5:10 # foo = 5 6 7 8 9 10
foo[3]     # 7
foo[1:3]   # 5 6 7
foo[-2]    # excluding the 2nd item -> 5 7 8 9 10 
```

现在在数组上：

```
bar = data.frame(1:3, 4:6)
bar[,2]                    # The 2nd column: 4 5 6
bar[-1,]                   # Excluding the first row
bar[c(2,3),]               # Extracts the second and third rows 
```

在您的原始示例中，`apply(s, 2, sort)`对矩阵的每一列进行排序`s`（如果使用`apply(s, 1, sort)`它将对行进行排序），然后`[I,]`将先前命令的结果限制为仅第 2 行和第 8 行。因此，在此程序之后，您将只有`s`.

请注意，`I`它在 R 中可能有不同的含义。在您的情况下，它只是一个变量名，它可以是其他任何名称。但`I(x)`也是 R 中的一个函数。有关更多信息，您可以使用`?I`.

# php - 创建准备好的语句连接的最安全方法

> ID：13080164
> 
> 赞同：0
> 
> 时间：2012-10-26T03:01:16.720
> 
> 标签：php, mysqli, database-connection, prepared-statement

我正在将一些查询转换为准备好的语句，我目前在连接文件中有以下内容：

```
<?php

DEFINE ('DB_USER' , 'blah');

DEFINE ('DB_PASSWORD' , 'blah');

DEFINE ('DB_HOST' , 'localhost');

DEFINE ('DB_NAME' , 'blah');

//make the connection

$dbc = mysqli_connect (DB_HOST, DB_USER, DB_PASSWORD, DB_NAME)
        OR die ('Could not connect to MySQL: ' .
        mysqli_connect_error() );

?> 
```

我还能以某种方式使用 $dbc 吗？我不想将我的连接信息明文写成这样的语句：

```
 $mysqli = new mysqli("heres", "all", "my", "sensitive", "information"): 
```

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T03:04:22.417

您可以将敏感信息放在不在 webroot 中的文件中。

你可以使用 SSL 连接到 mysql 服务器

[http://dev.mysql.com/doc/refman/5.0/en/ssl-connections.html](http://dev.mysql.com/doc/refman/5.0/en/ssl-connections.html)

# spring - 将 JSF2 与 Spring3 和 Hibernate4 集成 - applicationContext.xml 错误？

> ID：13080166
> 
> 赞同：0
> 
> 时间：2012-10-26T03:01:24.437
> 
> 标签：spring, hibernate, jsf-2

我正在尝试创建一个 JSF2 应用程序，它使用 Spring3 进行 DI 和休眠来处理持久性。

我有以下错误，不知道如何继续：

```
26/10/2012 1:57:04 PM org.apache.catalina.core.StandardContext listenerStart
SEVERE: Exception sending context initialized event to listener instance of class org.springframework.web.context.ContextLoaderListener
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sessionFactory' defined in ServletContext resource [/WEB-INF/applicationContext.xml]: Invocation of init method failed; nested exception is org.hibernate.InvalidMappingException: Unable to read XML
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1455)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:519)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:567)
    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:913)
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:464)
    at org.springframework.web.context.ContextLoader.configureAndRefreshWebApplicationContext(ContextLoader.java:385)
    at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:284)
    at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:111)
    at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:4206)
    at org.apache.catalina.core.StandardContext.start(StandardContext.java:4705)
    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:799)
    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:779)
    at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:601)
    at org.apache.catalina.startup.HostConfig.deployDirectory(HostConfig.java:1079)
    at org.apache.catalina.startup.HostConfig.deployDirectories(HostConfig.java:1002)
    at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:506)
    at org.apache.catalina.startup.HostConfig.start(HostConfig.java:1317)
    at org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:324)
    at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:142)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1065)
    at org.apache.catalina.core.StandardHost.start(StandardHost.java:840)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1057)
    at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:463)
    at org.apache.catalina.core.StandardService.start(StandardService.java:525)
    at org.apache.catalina.core.StandardServer.start(StandardServer.java:754)
    at org.apache.catalina.startup.Catalina.start(Catalina.java:595)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:289)
    at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:414)
Caused by: org.hibernate.InvalidMappingException: Unable to read XML
    at org.hibernate.internal.util.xml.MappingReader.readMappingDocument(MappingReader.java:109)
    at org.hibernate.cfg.Configuration.add(Configuration.java:478)
    at org.hibernate.cfg.Configuration.add(Configuration.java:474)
    at org.hibernate.cfg.Configuration.add(Configuration.java:647)
    at org.hibernate.cfg.Configuration.addInputStream(Configuration.java:685)
    at org.springframework.orm.hibernate4.LocalSessionFactoryBean.afterPropertiesSet(LocalSessionFactoryBean.java:272)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1514)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1452)
    ... 36 more
Caused by: org.dom4j.DocumentException: Connection refused: connect Nested exception: Connection refused: connect
    at org.dom4j.io.SAXReader.read(SAXReader.java:484)
    at org.hibernate.internal.util.xml.MappingReader.readMappingDocument(MappingReader.java:78)
    ... 43 more 
```

我`applicationContext.xml`在下面列出：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:context="http://www.springframework.org/schema/context"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:p="http://www.springframework.org/schema/p"
    xmlns:tx="http://www.springframework.org/schema/tx"
    xsi:schemaLocation="http://www.springframework.org/schema/beans
                        http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
                        http://www.springframework.org/schema/tx
                        http://www.springframework.org/schema/tx/spring-tx-3.1.xsd
                        http://www.springframework.org/schema/context
                        http://www.springframework.org/schema/context/spring-context-3.1.xsd">

    <context:component-scan base-package="com.myapp.techrro" />
    <context:annotation-config />

    <bean class="org.springframework.beans.factory.config.CustomScopeConfigurer">
        <property name="scopes">
            <map>
                <entry key="view">
                    <bean class="com.myapp.util.ViewScope" />
                </entry>
            </map>
        </property>
    </bean>

    <bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource">
        <property name="driverClassName" value="net.sourceforge.jtds.jdbc.Driver">
        </property>
        <property name="url" value="jdbc:jtds:sqlserver://localhost:1433/myapp">
        </property>
        <property name="username" value="mydb"></property>
        <property name="password" value="somepass"></property>
    </bean>

    <bean id="sessionFactory"
        class="org.springframework.orm.hibernate4.LocalSessionFactoryBean">
        <property name="dataSource">
            <ref bean="dataSource" />
        </property>
        <property name="hibernateProperties">
            <props>
                <prop key="hibernate.dialect">org.hibernate.dialect.HSQLDialect</prop>
                <prop key="hibernate.show_sql">true</prop>
                <prop key="hibernate.c3p0.min_size">5</prop>
                <prop key="hibernate.c3p0.max_size">20</prop>
                <prop key="hibernate.c3p0.idle_test_period">300</prop>
                <prop key="hibernate.c3p0.timeout">1800</prop>
                <prop key="hibernate.c3p0.max_statements">50</prop>
                <prop key="cache.provider_class">org.hibernate.cache.NoCacheProvider</prop>
                <prop key="c3p0.acquire_increment">1</prop>
            </props>
        </property>
        <property name="mappingResources">
            <list>
                <value>com/myapp/techrro/hibernate/UserOrderHist.hbm.xml
                </value>
                <value>com/myapp/techrro/hibernate/UserAccessHist.hbm.xml
                </value>
                <value>com/myapp/techrro/hibernate/User.hbm.xml</value>
            </list>
        </property>
    </bean>

    <bean id="userOrderHistDAO" class="com.myapp.techrro.hibernate.userOrderHistDAO">
        <property name="sessionFactory">
            <ref bean="sessionFactory" />
        </property>
    </bean>

    <bean id="userAccessHistDAO" class="com.myapp.techrro.hibernate.userAccessHistDAO">
        <property name="sessionFactory">
            <ref bean="sessionFactory" />
        </property>
    </bean>

    <bean id="userDAO" class="com.myapp.techrro.hibernate.userDAO">
        <property name="sessionFactory">
            <ref bean="sessionFactory" />
        </property>
    </bean>

</beans> 
```

## 更新：

下面是我的映射文件，它们是由 myEclipse 生成的：

`User.hbm.xml`：

```
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd ">
<!-- 
    Mapping file autogenerated by MyEclipse Persistence Tools
-->
<hibernate-mapping>
    <class name="com.myapp.techrro.hibernate.User" table="User" schema="dbo" catalog="mydb">
        <id name="user_PK" type="java.lang.Long">
            <column name="user_PK" />
            <generator class="identity" />
        </id>
        <property name="username" type="java.lang.String">
            <column name="username" length="20" not-null="true" unique="true" />
        </property>
        <property name="password" type="java.lang.String">
            <column name="password" length="40" not-null="true" />
        </property>
        <property name="userRole" type="java.lang.String">
            <column name="userRole" length="1" not-null="true" />
        </property>
        <property name="active" type="java.lang.String">
            <column name="active" length="1" />
        </property>
        <property name="type" type="java.lang.String">
            <column name="type" length="3" not-null="true" />
        </property>
        <property name="firstName" type="java.lang.String">
            <column name="firstName" length="30" />
        </property>
        <property name="lastName" type="java.lang.String">
            <column name="lastName" length="30" />
        </property>
        <set name="userOrderHistLog" inverse="true">
            <key>
                <column name="user_PK" />
            </key>
            <one-to-many class="com.myapp.techrro.hibernate.userOrderHist" />
        </set>
        <set name="userAccessHistLog" inverse="true">
            <key>
                <column name="user_PK" not-null="true" />
            </key>
            <one-to-many class="com.myapp.techrro.hibernate.userAccessHist" />
        </set>
    </class>
</hibernate-mapping> 
```

`UserOrderHist.hbm.xml`：

```
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd ">
<!-- 
    Mapping file autogenerated by MyEclipse Persistence Tools
-->
<hibernate-mapping>
    <class name="com.myapp.techrro.hibernate.userOrderHist" table="userOrderHist" schema="dbo" catalog="mydb">
        <id name="userOrderHis_PK" type="java.lang.Long">
            <column name="userOrderHis_PK" />
            <generator class="identity" />
        </id>
        <many-to-one name="user" class="com.myapp.techrro.hibernate.User" fetch="select">
            <column name="user_PK" />
        </many-to-one>
        <property name="action" type="java.lang.String">
            <column name="action" length="1" not-null="true" />
        </property>
        <property name="prod" type="java.lang.String">
            <column name="username" length="20" not-null="true" />
        </property>
        <property name="type" type="java.lang.String">
            <column name="userRole" length="1" />
        </property>
        <property name="Updated" type="java.lang.String">
            <column name="deleteFG" length="1" />
        </property>
    </class>
</hibernate-mapping> 
```

`UserAccessHist.hbm.xml`：

```
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd ">
<!-- 
    Mapping file autogenerated by MyEclipse Persistence Tools
-->
<hibernate-mapping>
    <class name="com.myapp.techrro.hibernate.userAccessHist" table="userAccessHist" schema="dbo" catalog="mydb">
        <id name="userAccessHistPK" type="java.lang.Long">
            <column name="userAccessHistPK" />
            <generator class="identity" />
        </id>
        <many-to-one name="user_PK" class="com.myapp.techrro.hibernate.User" fetch="select">
            <column name="adminUserPK" not-null="true" />
        </many-to-one>
        <property name="createdDate" type="java.sql.Timestamp">
            <column name="createdDate" length="23" not-null="true" />
        </property>
        <property name="accessDetail" type="java.lang.String">
            <column name="accessDetail" length="100" not-null="true" />
        </property>
    </class>
</hibernate-mapping> 
```

有人可以请这种错误的可能原因吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T03:05:13.227

根据您的堆栈跟踪 ( `org.hibernate.InvalidMappingException: Unable to read XML`)，问题很可能出在您的休眠映射 XML 文件之一中。

更新：现在您已经发布了休眠文件，看起来您在 DTD 的末尾有一个额外的空间。删除尾随空格应该可以解决问题。

# c# - c#插件：未指定的错误

> ID：13080167
> 
> 赞同：0
> 
> 时间：2012-10-26T03:01:28.623
> 
> 标签：c#, visual-studio-2010, add-in

我创建了一个加载项，每次尝试将其添加到工具 -> 加载项管理器时，都会出现错误。

我已经注释了 Connect() 方法中的所有代码，以确保它没有给我一些隐藏的异常。

包含 dll 名称 - 相对路径，因为在每次构建后将其复制到 Addins 文件夹中更容易，而不必关闭 Visual Studio 才能重新构建。

我也尝试给它一个绝对路径......无论是使用绝对路径，还是使用没有扩展名的 dll，我都会得到：

```
Error message: Unspecified error
Error number: 80004005 
```

我还收到“参数不正确”错误，以及“系统找不到指定的文件”。

我已经看过教程，不止一次。第一次，它总是有效，dll 中没有任何内容 - 然后我关闭 Visual Studio，重新构建，重新启动，然后我又回到了我开始的地方。

我能找到的所有存在此问题的问题都建议使用绝对路径（尽管文档说它可以是绝对路径、相对路径或 url）。

我试图在我的代码中设置断点，但我不知道如何调试这个......

请帮忙 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T18:45:04.203

该错误是由于我在“ C : **\** **Users \** **user.name** **\ Documents\Visual Studio 2010\Addins** ”文件夹，我在说明中看到它的方式......

 ******我不明白这两个 xml 文件都代表相同的资源，因此自相矛盾。

“ **ProjectAddIn - For Testing AddIn** ”中的路径应该指向项目内的dll，并且只有在我完成调试后，我才能从AddIns文件夹中删除该项目并将其替换为安装项目，如果我愿意的话。******

# php - php 无法创建和分配数组

> ID：13080168
> 
> 赞同：1
> 
> 时间：2012-10-26T03:01:49.603
> 
> 标签：php, arrays, session, assign

在 PHP 中是否有可能在以前存储字符串的地方有一个数组？

```
echo "valuebefore: ".$_SESSION['REQUEST_TOKEN'][TL_MODE];
$_SESSION['REQUEST_TOKEN'][TL_MODE] = "somestring";

echo "typebefore: ".gettype($_SESSION['REQUEST_TOKEN'][TL_MODE]);
$_SESSION['REQUEST_TOKEN'][TL_MODE] = array();

echo "typeafter: ".gettype($_SESSION['REQUEST_TOKEN'][TL_MODE]);
if (!is_array($_SESSION['REQUEST_TOKEN'][TL_MODE]))
{
  echo "is not an array";
}
echo "valueafter: ".$_SESSION['REQUEST_TOKEN'][TL_MODE]; 
```

输出是：

```
valuebefore: A
typebefore: string 
typeafter: string   << the type didnt change to array!
is not an array
valueafter: A       << the value was not updated! 
```

为什么它不能只保存新数组？为什么价值也没有改变？

**编辑：**

这是涉及的其他变量的 vardump：

```
echo var_dump(TL_MODE)." <br/>";
echo var_dump($_SESSION['REQUEST_TOKEN'])." <br/>";
echo var_dump($_SESSION['REQUEST_TOKEN'][TL_MODE])." <br/>"; 
```

输出：

```
string(2) "FE"
string(32) "A96665c9f1e41d1745bf3a3d75cff33a"
string(1) "A" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T03:11:44.923

TL_MODE 的值是多少？如果您没有将其定义为常量，那么您只是添加数组项。这可以解释您所看到的行为。最后输出数组，看看你有什么。

```
var_dump($_SESSION['REQUEST_TOKEN']); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T03:18:48.857

附加以下代码的输出：

*   之前的值：A
*   typebefore: 字符串
*   打字后：数组
*   值后：数组

您应该回显 TL_MODE 和 $_SESSION 内容的值以进行调试。

```
<?php

    session_start();
    DEFINE('TL_MODE', 'tl_mode_constant');
    $_SESSION['REQUEST_TOKEN'][TL_MODE] = 'A';

    echo "valuebefore: ".$_SESSION['REQUEST_TOKEN'][TL_MODE] . '<br />';
    $_SESSION['REQUEST_TOKEN'][TL_MODE] = "somestring";

    echo "typebefore: ".gettype($_SESSION['REQUEST_TOKEN'][TL_MODE]) . '<br />';
    $_SESSION['REQUEST_TOKEN'][TL_MODE] = array();

    echo "typeafter: ".gettype($_SESSION['REQUEST_TOKEN'][TL_MODE]);
    if (!is_array($_SESSION['REQUEST_TOKEN'][TL_MODE])){
        echo "is not an array" . '<br />';
    }
    echo "valueafter: ".$_SESSION['REQUEST_TOKEN'][TL_MODE] . '<br />';

?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T11:40:40.760

这个较小的例子对我有用：

```
$ php -r '$a="foo"; $a=array("bar"); var_dump($a);'
array(1) {
  [0]=>
  string(3) "bar"
} 
```

您的 var_dumps 应该显示 (1)`$_SESSION['REQUEST_TOKEN']`是一个数组，并且 (2) 您的常量`TL_MODE`是一个非空值。如果它为 null，则`$_SESSION['REQUEST_TOKEN'][TL_MODE]`与 相同`$_SESSION['REQUEST_TOKEN'][]`，并且仅在您认为要重新分配时才添加数组元素。但是如果`$_SESSION['REQUEST_TOKEN']`是一个字符串，那么如果它是一个数组，就不能添加下标。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-30T20:06:38.907

@Brent Baisley 说得对，$_SESSION['REQUEST_TOKEN'] 不是数组而是字符串，但基本问题原来是与 cookie 相关的问题，它破坏了 $_SESSION 数据。

一旦我清除了网络浏览器中的 cookie 和缓存，一切正常。

# c# - 'Foo' 是一个“命名空间”，但用作“类型”

> ID：13080171
> 
> 赞同：3
> 
> 时间：2012-10-26T03:02:39.003
> 
> 标签：c#, namespaces

我正在构建一个名为“Fieldsearch”的库，我**需要**人们像这样调用它：

```
FieldSearch x = new FieldSearch(); 
```

问题是，如果我的解决方案被调用`FieldSearch`并且我的类库被调用`FieldSearch.Lib`，我不能调用实际的类`FieldSearch`。

```
'Foo' is a 'namespace' but is used like a 'type' 
```

你建议我为这种情况做些什么，而不是给我的实际班级打电话？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-26T04:08:55.747

一般来说，最佳实践是对命名空间使用复数形式，对其中的类使用单数形式。例如，`System.Windows.Forms`包含一个名为`Form`.

所以在这个例子中，你的命名空间可以被调用`FieldSearches`（或者`CompanyName.ProductName.FieldSearches`如果你想使用那个约定）。现在“FieldSearch”类将与命名空间不匹配。

# c# - 模型应该如何传递到 ViewModel 中？

> ID：13080172
> 
> 赞同：7
> 
> 时间：2012-10-26T03:02:50.030
> 
> 标签：c#, design-patterns, mvvm

在 MVVM 设计中，假设 View 创建 ViewModel，ViewModel 应该如何知道它的 Model？

我从几个地方读到，模型可以通过其构造函数传递给 ViewModel。所以它看起来像：

```
class ViewModel {
   private Model _model;
   public ViewModel(Model model) {
      _model = model;
   }
} 
```

由于 View 正在创建 ViewModel，并将 Model 传递给 ViewModel 的构造函数，因此 View 必须知道 Model。但是从我从大多数 MVVM 设计中看到的 UML 图来看，视图似乎对模型一无所知。

模型应该如何传递到 ViewModel 中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T03:34:10.023

你几乎走在正确的轨道上，你只是错过了一个重要的信息。

是的，可以将模型传递给构造函数上的视图模型——这称为依赖注入，或者称为[控制反转](https://stackoverflow.com/questions/3058/what-is-inversion-of-control)(IoC)。

[实现这一点的最简单方法是使用Prism](http://compositewpf.codeplex.com/)的 UnityContainer 。在应用程序启动的某个地方，您向统一容器注册接口及其相应的实现类型，从那时起，您调用`Resolve<MyInterface>()`Unity 容器以获取与该实例关联的类型的物理实例。

Unity 真正可以帮助您的地方是，当您告诉它解析类型时，它会自动解析尽可能多的构造函数参数。因此，如果您的视图模型上的构造函数如下所示：

```
public class MyViewModel : IMyViewModel
{
    public MyViewModel(IUnityContainer container, IMyModel model)
    {
        _container = container;
        _model = model;
        ...etc...
    }
} 
```

你的观点是这样的：

```
this.DataContext = container.Resolve<IMyViewModel>(); 
```

然后，统一容器将新建 MyViewModel 类的实例，因为它还将解析并新建与 IMyModel 关联的类的实例。

# android - 如何将最近使用的第三方活动放在前面？

> ID：13080177
> 
> 赞同：4
> 
> 时间：2012-10-26T03:04:13.440
> 
> 标签：android, android-activity

在我的应用程序中，我想以编程方式将最近使用的第三方 Activity 置于最前面。在这里查看其他答案后，我尝试使用从最近任务列表返回的 baseIntent 重新启动活动，但这似乎并没有将活动放在前面，而不是其他正在发生的事情。

我的最终目标是创建一个应用程序，用一个小的覆盖层替换来电屏幕，这样用户在接到电话时就不会完全退出他们正在使用的任何应用程序。我发现您无法替换默认的来电屏幕（如果这不是真的，请告诉我，因为我宁愿这样做）所以作为一种解决方法，我正在尝试调用最近使用的应用程序屏幕的前面（覆盖来电屏幕），然后在上面显示我的覆盖。

这是我正在使用的代码（活动是从广播接收器启动的）

```
public class BringMRUAppToFront extends Activity
{
    @Override
    protected void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);

        ActivityManager activityManager = (ActivityManager) getSystemService("activity");
        List<RecentTaskInfo> recentTasks = activityManager.getRecentTasks(1, ActivityManager.RECENT_WITH_EXCLUDED);
        if(recentTasks.size() > 2) {
            RecentTaskInfo recentTask = recentTasks.get(2);
            Intent testIntent = recentTask.baseIntent;
            Log.i("MyApp", "Recent task - " + recentTask.baseIntent.getComponent().getPackageName());

            testIntent.setFlags(Intent.FLAG_ACTIVITY_REORDER_TO_FRONT); 
            startActivity(testIntent);
        }
        finish();
    }
} 
```

是否有可靠的方法将任何第三方活动带到前台？该活动保证在内存中（如果一个不在内存中，那么我只会显示主屏幕），所以那里不应该有问题。我也不相信在这种情况下这会是一个安全问题，因为它只会显示一个在电话响起之前可见的应用程序——尽管我知道在 SDK 中打开它可能会带来风险。 ..仍然希望这是可能的。

编辑：稍微修改了代码以反映我在做什么。所需的任务几乎总是列表中的第三个任务 - 第一个是当前任务，第二个是响铃电话的任务。我可以将任务调用到前面，但它并不总是处于相同的状态（例如，转到浏览器的页面而不是浏览器中的设置屏幕）。最近的任务列表是如何做到这一点的？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-02T02:50:10.083

通过查看 Android 源代码弄清楚了——这正是“最近任务”屏幕所做的，无论是在 Honeycomb 之前还是之后：

```
RecentTaskInfo recentTask = recentTasks.get(1); // task 0 is current task
// maintains state more accurately - only available in API 11+ (3.0/Honeycomb+)
if(android.os.Build.VERSION.SDK_INT >= android.os.Build.VERSION_CODES.HONEYCOMB) {
    final ActivityManager am = (ActivityManager) getSystemService(Context.ACTIVITY_SERVICE);
    am.moveTaskToFront(recentTask.id, ActivityManager.MOVE_TASK_WITH_HOME);
} else { // API 10 and below (Gingerbread on down)
    Intent restartTaskIntent = new Intent(recentTask.baseIntent);
    if (restartTaskIntent != null) {
        restartTaskIntent.addFlags(Intent.FLAG_ACTIVITY_LAUNCHED_FROM_HISTORY);
        try {
            startActivity(restartTaskIntent);
        } catch (ActivityNotFoundException e) {
            Log.w("MyApp", "Unable to launch recent task", e);
        }
    }
} 
```

需要权限 android.permission.REORDER_TASKS 才能正常工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-03T04:27:41.313

从 Android L 开始，getRecentTasks() 返回应用程序自己的任务，可能还有其他一些非敏感任务（如 Home），所以你不能做这样的工作。

参考资料：[https ://developer.android.com/preview/api-overview.html#Behaviors](https://developer.android.com/preview/api-overview.html#Behaviors)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-26T05:28:15.750

为什么不使用所有活动都可以访问的全局静态变量，并且在其 onPause 上只需将该变量设置为该活动值例如我正在放置一个名为 ActivityName 的静态变量

```
public static String ActivityName = ""; 
```

并在每个活动的 onPause 中为其分配活动包名称

```
@Override
public void onPause() {
    super.onPause();
    // The static global variable 
    com.pacakagename.Utls.ActivityName = "com.pacakagename.Act1";
} 
```

因此，当任何活动暂停时，都会分配值，您将了解最近暂停的活动，您可以使用 Class.forName(ActivityName) 重新启动它

# ruby-on-rails - 'Encoding::UndefinedConversionError "\xE9" from ASCII-8BIT to UTF-8' 当使用一些在 ruby on rails 中使用 file.open 的 ruby gem 时

> ID：13080178
> 
> 赞同：4
> 
> 时间：2012-10-26T03:04:18.967
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3.2

## 我想要什么？

我想从 Rails 3.2 中的模板文件生成 .docx 文件或 .odt 文件
我想在其中使用日语。
在 ubuntu 服务器 12.04 & ruby​​ 1.9.3p194 & rails 3.2.8

## 发生了什么？

我尝试了 gems 'docx-templater' 和 'serenity'

### ruby-docx-模板

[https://github.com/jawspeak/ruby-docx-templater](https://github.com/jawspeak/ruby-docx-templater)

1 个示例效果很好
2 尝试在我的 rails 应用程序中做同样的事情

在控制器中作为示例

```
def gen_docx
  input_file = './app/template/ExampleTemplate.docx'
  data = {
    :teacher => "Priya Vora",
    :building => "Building #14",
    :classroom => :'Rm 202',
    :district => "Washington County Public Schools",
    :senority => 12.25,
    :roster => [
      {:name => 'Sally', :age => 12, :attendence => '100%'},
      {:name => :Xiao, :age => 10, :attendence => '94%'},
      {:name => 'Bryan', :age => 13, :attendence => '100%'},
      {:name => 'Larry', :age => 11, :attendence => '90%'},
      {:name => 'Kumar', :age => 12, :attendence => '76%'},
      {:name => 'Amber', :age => 11, :attendence => '100%'},
      {:name => 'Isaiah', :age => 12, :attendence => '89%'},
      {:name => 'Omar', :age => 12, :attendence => '99%'},
      {:name => 'Xi', :age => 11, :attendence => '20%'},
      {:name => 'Noushin', :age => 12, :attendence => '100%'}
    ],
      :event_reports => [
        {:name => 'Science Museum Field Trip', :notes => 'PTA sponsored event. Spoke to Astronaut with HAM radio.'},
        {:name => 'Wilderness Center Retreat', :notes => '2 days hiking for charity:water fundraiser, $10,200 raised.'}
    ],
      :created_at => "11-12-03 02:01"
  }
  DocxTemplater::DocxCreator.new(input_file, data).generate_docx_file()
end 
```

3但错误引发
了gem中以下点引发的错误（docx_templater.rb 22）

```
File.open(file_name, 'w') { |f| f.write(buffer) } 
```

### 宁静

[https://github.com/kremso/serenity](https://github.com/kremso/serenity)

1 个示例运行良好
2 在我的 rails 应用程序中执行相同的操作，并且运行良好
，如下所示

```
#encoding: utf-8
require 'serenity'
class Showcase
  include Serenity::Generator

  Person = Struct.new(:name, :items)
  Item = Struct.new(:name, :usage)

  def generate_showcase
    @title = 'Serenity inventory'

    mals_items = [Item.new('Moses Brothers Self-Defense Engine Frontier Model B', 'Lock and load')]
    mal = Person.new('Malcolm Reynolds', mals_items)

    jaynes_items = [Item.new('Vera', 'Callahan full-bore auto-lock with a customized trigger, double cartridge and thorough gauge'),
                Item.new('Lux', 'Ratatata'),
                Item.new('Knife', 'Cut-throat')]
    jayne = Person.new('Jayne Cobb', jaynes_items)

    @crew = [mal, jayne]

    render_odt 'app/template/showcase.odt'
  end
end 
```

3 我尝试了包含日语的模板，但出现了错误。
在 gem(template.rb 22) 中的以下点引发的错误

```
 def process context
  tmpfiles = []
  Zip::ZipFile.open(@template) do |zipfile|
    %w(content.xml styles.xml).each do |xml_file|
      content = zipfile.read(xml_file)
      odteruby = OdtEruby.new(XmlReader.new(content))
      out = odteruby.evaluate(context)

      tmpfiles << (file = Tempfile.new("serenity"))
      file << out    #!!!! HERE !!!!
      file.close

      zipfile.replace(xml_file, file.path)
    end
  end
end 
```

## 我做了什么？

*   我发现“宁静”在 gem 中对希腊语（UTF-8）进行了 rspec 测试。我以同样的方式尝试了日语。并且测试通过了！所以我认为问题不在于rails设置中的宝石。

*   将魔术注释“#encoding：utf-8”添加到我的控制器或lib文件

*   确认 config/application.rb 中的 'config.encoding = "utf-8"'
*   在“初始化！”上方的 config/enviroment.rb 中添加以下内容

    Encoding.default_external = 编码::UTF_8
    Encoding.default_internal = 编码::UTF_8

*   我不在我的 Rails 应用程序中使用任何数据库。

但一切都与我的案子无关......有什么想法吗？我可能不知道基本的东西......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-12T17:01:22.700

这有点老了，但我刚刚遇到了同样的情况。就我而言，这是在写入之前将临时文件设置为二进制模式的问题：

```
 tmpfiles << (file = Tempfile.new("serenity"))
  file.binmode
  file << out   
  file.close 
```

希望这可以帮助

# javascript - 将 pdf 直接发送到打印机对话框的链接

> ID：13080180
> 
> 赞同：2
> 
> 时间：2012-10-26T03:04:28.657
> 
> 标签：javascript, html, pdf, printing

我尝试了以下两种方法..

```
<embed src="assets/pdf/mypdf.pdf" id="Pdf1" name="Pdf1" hidden="true">

<a class="print" onClick="document.Pdf1.printWithDialog();"></a>

<a onClick="document.getElementById('Pdf1').printWithDialog()" style="cursor:hand;">Print file</a> 
```

又一次尝试。。

```
<script type="text/javascript">
function printPDF(pdfUrl) 
{
    var w = window.open(pdfUrl);
    w.print();
}
</script>

<a class="print" onClick="printPDF("assets/pdf/mypdf.pdf");">a</a> 
```

似乎没有一个工作。任何解决方案，以便我可以单击链接并将pdf发送到打印对话框？window.print 只是在对话框中显示实际站点，而不是 pdf。

# r - 我怎么能强制 R 显示 0.000 而不是 0？

> ID：13080184
> 
> 赞同：1
> 
> 时间：2012-10-26T03:04:51.973
> 
> 标签：r

> **可能重复：**
> [控制 R 中的数字](https://stackoverflow.com/questions/2287616/controlling-digits-in-r)

对于 0.12 或 0 等数字，有没有办法显示 R 中矩阵中每个数字的小数点后 3 位？我想强制 R 显示 0.120 和 0.000 而不是 0.12 或 0。

我想这样做是因为我的最终目标是将 R 矩阵作为表格导出到 Latex 中。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-26T03:07:26.127

我认为包的`digits`参数`xtable`可以满足您的要求：

```
> library(xtable)
> xtable(data.frame(a=0.12,b=0),digits=3)
% latex table generated in R 2.16.0 by xtable 1.7-0 package
% Thu Oct 25 23:06:50 2012
\begin{table}[ht]
\begin{center}
\begin{tabular}{rrr}
  \hline
 & a & b \\ 
  \hline
1 & 0.120 & 0.000 \\ 
   \hline
\end{tabular}
\end{center}
\end{table} 
```

# asp.net - 如何将 ContextKeys 属性用于 AjaxFileUpload 控件？

> ID：13080186
> 
> 赞同：5
> 
> 时间：2012-10-26T03:04:54.680
> 
> 标签：asp.net, ajaxcontroltoolkit

我开始研究 AjaxFileUpload 控件，特别是 ContextKeys 属性。但是，我不明白如何使用它。

[文档](http://www.asp.net/ajaxLibrary/AjaxControlToolkitSampleSite/AjaxFileUpload/AjaxFileUpload.aspx)说 AjaxFileUpload ContextKeys 用于在上传文件时将信息传递给服务器。但没有提供示例。网上有没有可以看的例子？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T09:21:12.587

虽然这样的功能没有实现（我相信它是计划好的，但由于某些原因被推迟了），没有什么可以保护你自己实现它。为此，您需要下载 AjaxControlToolkit 源代码并根据需要对其进行调整。

会有很多积分所以你可以在之前准备一杯咖啡:)

我将显示必须更改的文件名的更改。

**服务器/AjaxControlToolkit/AjaxFileUpload/AjaxFileUpload.cs**文件

首先，将 ContextKeys 属性添加到 AjaxFileUploadEventArgs.cs 文件（它位于同一文件夹中）：

```
/// <summary>
/// Gets or sets the context keys.
/// </summary>
public string ContextKeys
{
    get;
    set;
} 
```

之后打开 AjaxFileUpload 类代码并更改**OnPreRender**方法。这是此方法的一部分，带有自定义修改：

```
var eventArgs = new AjaxFileUploadEventArgs(guid, AjaxFileUploadState.Success,
"Success", uploadedFile.FileName,
uploadedFile.ContentLength, uploadedFile.ContentType,
stream.ToArray());

// NEW CODE HERE
eventArgs.ContextKeys = this.Page.Request.Form["contextKeys"]; 
```

这就是我们需要的服务器代码的所有更改。现在我们需要修改`Sys.Extended.UI.AjaxFileUpload`客户端类（文件**AjaxFileUpload.pre.js**）

首先让我们修改`_html5UploadFile`方法如下：

```
_html5UploadFile: function (fileItem) {
    this._guid = Sys.Extended.UI.AjaxFileUpload.utils.generateGuid();

    var uploadableFile = fileItem.get_fileInputElement();

    var fd = new FormData();
    fd.append("fileId", uploadableFile.id);
    fd.append("Filedata", uploadableFile.file);

    if (this.contextKeys) {
        if (typeof this.contextKeys !== "string") {
            this.contextKeys = Sys.Serialization.JavaScriptSerializer.serialize(this.contextKeys);
        }
        fd.append("contextKeys", this.contextKeys);
    }

    $common.setVisible(this._progressBar, true);
    this._setDisableControls(true);
    this._html5SetPercent(0);
    this._setStatusMessage(String.format(Sys.Extended.UI.Resources.AjaxFileUpload_UploadingHtml5File, uploadableFile.file.name, Sys.Extended.UI.AjaxFileUpload.utils.sizeToString(uploadableFile.file.size)));

    var url = this._postBackUrl;
    if (url.indexOf("?") != -1)
        url += "&";
    else
        url += "?";

    this._webRequest = new Sys.Net.WebRequest();
    this._executor = new Sys.Net.XMLHttpExecutor();
    this._webRequest.set_url(url + 'contextkey=' + this._contextKey + '&guid=' + this._guid);
    this._webRequest.set_httpVerb("POST");
    this._webRequest.add_completed(this.bind(this._html5OnRequestCompleted, this));

    //this._executor.add_load(this.bind(this._html5OnComplete, this));
    this._executor.add_progress(this.bind(this._html5OnProgress, this));
    this._executor.add_uploadAbort(this.bind(this._html5OnAbort, this));
    this._executor.add_error(this.bind(this._html5OnError, this));
    this._webRequest.set_executor(this._executor);

    this._executor.executeRequest(fd);
} 
```

正如您在上面看到的，我们将 contextKeys 添加到表单数据中，并通过 Ajax 请求发布。

我们需要修改`_uploadInputElement`方法：

```
_uploadInputElement: function (fileItem) {

    var inputElement = fileItem.get_fileInputElement();
    var uploader = this;
    uploader._guid = Sys.Extended.UI.AjaxFileUpload.utils.generateGuid();
    setTimeout(function () {
        uploader._setStatusMessage(String.format(Sys.Extended.UI.Resources.AjaxFileUpload_UploadingInputFile, Sys.Extended.UI.AjaxFileUpload.utils.getFileName(inputElement.value)));
        uploader._setDisableControls(true);
        uploader.setThrobber(true);
    }, 0);

    var url = uploader._postBackUrl;
    if (url.indexOf("?") != -1)
        url += "&";
    else
        url += "?";

    uploader._createVForm();
    uploader._vForm.appendChild(inputElement);

    if (this.contextKeys) {
        if (typeof this.contextKeys !== "string") {
            this.contextKeys = Sys.Serialization.JavaScriptSerializer.serialize(this.contextKeys);
        }

        var contextKeysInput = document.createElement("input");
        contextKeysInput.setAttribute("type", "hidden");
        contextKeysInput.setAttribute("name", "contextKeys");
        contextKeysInput.setAttribute("value", this.contextKeys);

        uploader._vForm.appendChild(contextKeysInput);
    }

    uploader._vForm.action = url + 'contextkey=' + this._contextKey + '&guid=' + this._guid;
    uploader._vForm.target = uploader._iframeName;

    setTimeout(function () {
        uploader._vForm.submit();
        uploader._waitTimer = setTimeout(function () { uploader._wait() }, 100);
    }, 0);
} 
```

在所有这些更改之后，您可以在代码隐藏中设置 ContextKeys 属性，并从`AjaxFileUploadEventArgs`UploadComplete 事件的参数中获取它的值，如下所示：

```
protected void Page_Load(object sender, EventArgs e)
{

    if (!IsPostBack && !AjaxFileUpload1.IsInFileUploadPostBack)
    {
        AjaxFileUpload1.ContextKeys = new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(new Dictionary<string, string> { { "1", "First" }, { "2", "Second" } });
    }

protected void AjaxFileUpload1_OnUploadComplete(object sender, AjaxFileUploadEventArgs file)
{
    if (!string.IsNullOrEmpty(file.ContextKeys))
    {
        var contextKeys = new System.Web.Script.Serialization.JavaScriptSerializer().Deserialize<Dictionary<string, string>>(file.ContextKeys);
    } 
```

此外，如果您将按照此处[**链接**](https://stackoverflow.com/a/11689062/360171)`OnClientUploadStarted`的建议实施客户端事件，您可以将您的 contextKeys 从客户端传递给服务器：[](https://stackoverflow.com/a/11689062/360171)

 **```
 function uploadStarted(sender, args) {
      sender.contextKeys = { "first": "1", "second": "2" };
 } 
```**

# php - 处理 URL 中带重音和空格的最佳方法 ($_GET)

> ID：13080189
> 
> 赞同：1
> 
> 时间：2012-10-26T03:05:46.017
> 
> 标签：php

我需要处理 $_GET['city'] 参数中的重音和空格。

发布和接收它的最佳方式是什么？

[http://www.teste.com/?city](http://www.teste.com/?city) =圣保罗

谢谢卢西亚诺

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T03:13:14.490

在通过 $_GET 传递数据之前，最好在 PHP 中使用 urlencode() 函数。然后在接收端，使用 urldecode()。

[http://php.net/manual/en/function.urlencode.php](http://php.net/manual/en/function.urlencode.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T03:29:34.627

怎么样`str_replace()`？

**发送城市与**

```
$cityurl = str_replace(' ', '_',$cityurl);//replace spaces with "_" 
```

链接是

```
http://www.teste.com/?city=$cityurl //url is like http://www.teste.com/?city=São_Paulo 
```

**接收城市**

```
$city = str_replace('_', ' ',$_GET['city']);//replace "_" with spaces 
```

# linq - 实体框架：如何在 OrderBy 之前解密字段

> ID：13080190
> 
> 赞同：0
> 
> 时间：2012-10-26T03:05:47.627
> 
> 标签：linq, entity-framework, linq-to-entities, entity

我有一个 IQueryable 客户实体列表（EntityFrameworks）。我需要在这个 IQueryable 列表上进行排序，但问题是我要用于排序的字段在数据库中是加密的。有什么方法可以在订购之前解密此字段？我可以为 OrderBy 编写某种 Linq 扩展吗？由于可能有成千上万的客户，我不想将列表具体化，以便对其进行排序......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T07:08:55.950

因为您有一个加密字段，所以如果不首先解密每一行，就不可能按解密值对任何列表进行排序。这当然是因为要订购您必须首先知道字段的值，所以除非您的加密中有某种模式会导致某种订购（在这种情况下它是一个糟糕的加密算法！）那么您就不走运了.

我不建议在 SQL 中使用任何解密技术，因为如果数据库遭到破坏，将无法防止有人访问加密值。例如，有人掌握了您的数据库的备份，其中包含所有客户的加密值，以及解密它们的方法！

一个可能的 hacky 解决方案是将某种排序索引存储在另一列中，该索引是根据加密值计算的。例如，假设您的数据是按字母顺序排列的，您可以将未加密值的第一个字母存储在另一列中，这至少可以让您最大限度地减少需要通过该行传输的行数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T04:50:41.893

现在似乎不可能。

只有在解密发生在数据库中并且解密算法无法转换为 SQL 语句的情况下才有可能，因此这是不可能的。

# web-applications - 嵌入 YouTube 播放列表，以便播放列表选项始终可见。

> ID：13080191
> 
> 赞同：4
> 
> 时间：2012-10-26T03:05:59.823
> 
> 标签：web-applications, youtube, youtube-api

有没有办法使用带有播放列表的 YouTube 嵌入式播放器并让播放列表始终可见？或者，有没有办法默认打开播放列表按钮？到目前为止，我的研究表明 showinfo=1 选项用于使播放列表始终可见，但这似乎不再起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T08:34:06.240

showinfo 仅适用于 Flash 播放器。它不影响 html5 播放器。在嵌入 Plalist 的 html5 youtube 播放器中，您必须手动单击右下角的微小播放列表图标，该图标仅在开始/播放视频后出现。

所以 atm 我在 html5player 下方发布了一条文本信息，告诉用户在开始播放视频后单击此图标，以查看播放列表控件和图标。这绝对不是用户友好的。

请谷歌，默认情况下在 HTML5Player 中包含并激活播放列表控件和播放列表缩略图。

[顺便说一句： https](https://developers.google.com/youtube/player_parameters#showinfo) ://developers.google.com/youtube/player_parameters#showinfo 上的官方信息已过时，原因是“请注意，此功能仅支持 AS3 播放器，因为它是唯一可以加载播放列表的播放器。”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-11-01T15:01:56.047

这是一个很好的 JS 插件，适用于 YouTube API v.3 [https://github.com/Giorgio003/Youtube-TV](https://github.com/Giorgio003/Youtube-TV)

它模仿了原生 YouTube 播放列表的外观和功能。您必须从 YouTube 频道获取 API 密钥并将其设置在 ytv.js 中。

```
var apiKey = 'YOUR_API_KEY_HERE'; 
```

链接 CSS 和 JS

```
<link href="src/ytv.css" type="text/css" rel="stylesheet" />
<script src="src/ytv.js" type="text/javascript"></script> 
```

创建您的播放列表容器。[注意：容器必须有高度。]

```
<div id="YourPlayerID"></div> 
```

然后调用JS

```
document.addEventListener("DOMContentLoaded", function(event) {
    var controller = new YTV('YourPlayerID', {
       user: 'YoutubeUsername'
    });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-14T01:29:40.737

Andrej，是正确的，在 html5 播放器嵌入下，在 Chrome 或 Firefox 上，showinfo=1 不会导致播放列表缩略图最初出现。用户很可能在遇到这样一个嵌入的播放列表时，错误地认为它只是一个视频，而完全错过了有视频选择的想法。让播放列表缩略图出现的唯一方法是单击屏幕左上角的播放列表图标。我从我网站上的 UI 测试中知道，人们完全没有看到视频不止一个 [http://www.jenshansen.com/pages/lord-of-the-rings-rings](http://www.jenshansen.com/pages/lord-of-the-rings-rings)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-26T04:54:01.050

`showinfo=1`应该会导致播放列表中所有视频的缩略图最初可见，如在

[http://apiblog.youtube.com/2012/03/new-player-options-for-lists-of-videos.html](http://apiblog.youtube.com/2012/03/new-player-options-for-lists-of-videos.html)

如果您看到不同的行为，能否请您给我们举个例子，让我们知道您使用哪个浏览器看到这种情况，以及您使用的是 Flash 还是 HTML5 视频？

没有办法强制播放列表缩略图条始终存在，因为用户总是可以根据需要将其关闭。

# c - 在 C 中读取一行并一次读取三个字母

> ID：13080195
> 
> 赞同：0
> 
> 时间：2012-10-26T03:06:22.460
> 
> 标签：c, lines, letter

每次尝试阅读 3 个字母时遇到问题，我想逐行阅读，并在每行中一次按顺序阅读 3 个字母。

当找到 \n 时读取该行时跳转到下一行...

我试试这个

```
while ((getline(&line, &lenght, file)) != -1){
   while ((strncpy(ch, line, 3)) != NULL) { 

        let = replaceletter(tab, ch);

        if (let != 0)
            printf("%c", let);
   }
} 
```

但它不起作用，只需阅读前 3 个字母，我就想要整行。我真的不知道该怎么做，我需要帮助，请

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T03:16:41.613

我不明白第二个 while 循环应该如何工作。strncpy 在这种情况下返回 s1, IE ch。ch 最好是 char *。

所以.. ch 怎么会变成 == NULL，除非它一开始就已经是 NULL？如果 ch 开始时为 NULL（未显示它的初始化），那么它已经是一个段错误:)

如果这条线是

```
while(*(strncpy(ch, line, 3)) != NULL)) { 
```

高温高压

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T03:27:43.217

在您的代码中可以做得更好的事情很少：

1.  该代码不检查读取了多少个字符。一条线太短了吗？
2.  目前尚不清楚为什么`strncpy`要检查`NULL`. 它不返回`NULL`。
3.  目前尚不清楚您是否初始化`line`以及初始化`lenght`为什么值。
4.  不幸的是，很难成为通灵者并猜测它是`replaceletter`什么，它做什么，以及如何`tab`和`ch`被宣布。
5.  为什么在循环`strncpy`中调用是一个谜。`while`
6.  您的程序似乎没有将换行符作为返回字符串的一部分。

换句话说，如果您想获得或多或少足够的帮助，最好提供一个小型、完整且有效的示例来展示您的问题。

如果我被分配了那个任务，我可能会这样写：

```
#include <stdlib.h>
#include <stdio.h>
#include <errno.h>

int main(void)
{
    int  ret     = EXIT_SUCCESS;
    char    *line    = NULL;
    size_t   linecap = 0;
    ssize_t  len;

    do {
        len = getline(&line, &linecap, stdin);
        if (len == -1) {
            if (errno != 0) {
                perror("readline");
                ret = EXIT_FAILURE;
            }
            break;
        }
        if (len < 4)
            continue; /* Line is too short, try again */
        /* printf("The line is: %s", line); */
        printf("First three letters are: '%.*s'\n", 3, line);
    } while(1);

    free(line); /* It is always a good idea to cleanup after yourself */
    return ret;
} 
```

我希望上面的片段是不言自明的。但是，如果有什么需要澄清的，请不要犹豫。

祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T03:11:21.800

当您的行长度小于 3 个字符时，您可能会遇到问题。尝试一种更好、更可靠的方法来指定 strncpy 应该复制的字节数，例如在 C 中使用某种 Min 函数实现（更多信息[在这里](https://stackoverflow.com/questions/3437404/min-and-max-in-c)）。

# ruby-on-rails - 巫术的问题

> ID：13080196
> 
> 赞同：1
> 
> 时间：2012-10-26T03:06:28.653
> 
> 标签：ruby-on-rails, simple-form, sorcery

我遇到了多个问题..

1.当我启动rails服务器并访问时`http://0.0.0.0:3000/users`，我可以看到我想要的所有用户但是，当我点击登录按钮时，输入我的凭据，然后尝试登录我会看到这个页面..

```
No route matches [POST] "/user_sessions/new" 
```

我很困惑，因为我已经在 new.html.erb 页面上？

2.我正在使用魔法和simple_form gem，然后我跑了

```
rails generate scaffold User username:string email:string crypted_password:string salt:string 
```

但是现在我在 db/migrate 中有两个迁移文件，我不确定我需要保留哪一个，因为我有一个 user_sessions 控制器和一个 users 控制器？

我所有的源代码都可以在[https://bitbucket.org/jasonriddle/stubmoney获得](https://bitbucket.org/jasonriddle/stubmoney)

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T05:40:06.567

嗯..这很尴尬..这..

```
resources :users
resources :user_sessions

match 'login'  => 'user_sessions#new',     :as => :login
match 'logout' => 'user_sessions#destroy', :as => :logout
match 'signup' => 'users#new', :as => :signup 
```

和这个不一样。。

```
match 'login'  => 'user_sessions#new',     :as => :login
match 'logout' => 'user_sessions#destroy', :as => :logout
match 'signup' => 'users#new', :as => :signup

resources :users
resources :user_sessions 
```

有人可以解释为什么订购很重要吗？

此外，当我输入我的凭据并点击登录按钮时，新页面会再次呈现..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-28T23:17:38.153

来自“从外到内的 Rails 路由”：

**routes.rb 文件在请求进来时从上到下进行处理。请求将被分派到第一个匹配的路由。如果没有匹配的路由，Rails 会向调用者返回 HTTP 状态 404。**

不知道为什么要再次呈现页面。

# haskell - 从边列表构造树：缺少叶子节点

> ID：13080197
> 
> 赞同：2
> 
> 时间：2012-10-26T03:06:29.577
> 
> 标签：haskell, ghci

我写了下面的代码来构造一个给定顶点的树，给定顶点之间的连接列表。

```
type Connection = (Int,Int)
data Tree = Leaf Int | Node Int [Tree] deriving (Eq,Read,Show)

makeTree :: Int -> [Connection] -> Tree
makeTree x [] = Leaf x
makeTree indx connections =  Node indx otherTrees where
  otherTrees = [makeTree i cx | i <- directConnections, let cx = removeConnectionsTo indx connections]
  directConnections = map (\(x,y) -> if (x == indx) then y else x) $ filter (\(x,y) -> x == indx || y   == indx) connections

removeConnectionsTo :: Int -> [Connection] -> [Connection]
removeConnectionsTo indx = filter (\(x,y) ->    x /= indx && y /= indx) 
```

出于某种原因，下面的输入给了我惊人的不同结果：

`makeTree 1 [(1,2),(1,3)]`给我`Node 1 [Leaf 2,Leaf 3]`

`makeTree 1 [(1,2),(1,5),(2,3),(2,4),(5,6),(5,7)]`给我`Node 1 [Node 2 [Node 3 [],Node 4 []],Node 5 [Node 6 [],Node 7 []]]`

我在 OS X 10.8.2 上运行 GHCi，版本 7.4.1。

我不明白为什么我在第一个示例中获得了两次 Leaf（正确），但在第二个示例中获得了空子树列表的节点（不正确）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T03:28:48.507

一个快速的解决方法`otherTrees`是在决定是否构建 a`Leaf`或 a之前检查是否为空`Node`，例如

```
makeTree indx connections
  | null otherTrees = Leaf indx
  | otherwise       = Node indx otherTrees
  where ... 
```

要了解这里发生了什么，让我们添加一些工具：

```
import Debug.Trace

makeTree :: Int -> [Connection] -> Tree
makeTree ix cs | traceShow (ix, cs) False = undefined
makeTree x [] = ... -- leave rest of the function as before 
```

现在将其加载到 GHCi 中，让我们看看递归调用是什么：

```
> import Control.DeepSeq
> (show $ makeTree 1 [(1,2),(1,5),(2,3),(2,4),(5,6),(5,7)]) `deepseq` ()
(1,[(1,2),(1,5),(2,3),(2,4),(5,6),(5,7)])
(2,[(2,3),(2,4),(5,6),(5,7)])
(3,[(5,6),(5,7)])
(4,[(5,6),(5,7)])
(5,[(2,3),(2,4),(5,6),(5,7)])
(6,[(2,3),(2,4)])
(7,[(2,3),(2,4)])
() 
```

如您所见，第二个参数中的列表不为空，这就是它与函数的第一种情况不匹配的原因，因此您需要像我的示例中那样添加一些额外的检查，或者确保您过滤掉其余的连接。

# javascript - Javascript 显示模块模式 - 在函数返回后公开初始化变量

> ID：13080207
> 
> 赞同：6
> 
> 时间：2012-10-26T03:08:57.310
> 
> 标签：javascript, knockout.js, revealing-module-pattern

我一直在使用 Javascript Revealing Module 模式，我喜欢它在公共接口和内部之间提供的清晰分离。但是，我不断遇到一种情况，这让我想知道我的整体使用模式是否正确，或者我是否应该使用该模式的一些变体。

问题是，当传递给模块的 init 函数并私下存储以供内部使用时，也需要在 Knockout 绑定表达式或其他模块中公开公开。模块的返回语句会立即执行，稍后会调用 init 函数，通常会传递一些动态参数，例如在 Razor 视图中的脚本块中呈现的 Ajax URL 或原始 JSON。因为模块的 return 语句只返回私有变量的副本而不是引用，所以我在 init 函数中设置该私有变量不能更改已经返回的内容。

```
var productsModule = function() {

var urls;

var init = function(ajaxUrls) {
    urls = ajaxUrls;
};

return {
    init: init,
    urls: urls,
    getUrls: function() { return urls; }
};

}();

var customersModule = function() {

var doSomethingWithProductsModule = function() {
    alert(productsModule.urls); // undefined
    alert(productsModule.getUrls()); // object   
} ;       

return {
    doSomethingWithProductsModule: doSomethingWithProductsModule
};

}();

var urls = {
getProduct: '/Product/'
};

productsModule.init(urls);

customersModule.doSomethingWithProductsModule(); 
```

我的解决方法是在一个函数中包装诸如“urls”之类的对象，然后通过 productsModule.getUrls() 访问它们。然而，这变得非常混乱，特别是如果变量是一个 Knockout observable，它本身就是一个函数，因此为了评估它，我需要使用像 productsModule.getMyObservable()() 这样的双括号。

有没有更好的方法来使用至少接近揭示模块模式的东西来获取最新的内部值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T03:26:02.720

基本类型按值传递，对象按引用传递；`urls`你可以利用这个，而不是覆盖`productsModule`你只是更新它。这样，在初始模块调用中返回的引用保持最新。我已经更新了您的代码以显示我的意思。

```
var productsModule = function() {

var urls = {};

var init = function(ajaxUrls) {
    // Merge properties into the original object instead; more robust approach
    // may be needed
    for ( name in ajaxUrls ) {
        if (ajaxUrls.hasOwnProperty(name)) {
            urls[name] = ajaxUrls[name];
        }
    }
};

return {
    init: init,
    urls: urls,
    getUrls: function() { return urls; }
};

}();

var customersModule = function() {

var doSomethingWithProductsModule = function() {
    alert(productsModule.urls); // undefined
    alert(productsModule.getUrls()); // object
} ;   

return {
    doSomethingWithProductsModule: doSomethingWithProductsModule
};

}();

var urls = {
    getProduct: '/Product/'
};

productsModule.init(urls);

customersModule.doSomethingWithProductsModule(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T07:19:05.287

尽管我不完全喜欢必须遍历对象的所有可能级别以像这样合并它们的想法，但 El Yobo 的回答让我考虑将模块函数本身的结果作为局部变量，我可以更新其属性.

```
var productsModule = function() {

var urls;

var init = function(ajaxUrls) {
urls = ajaxUrls;
result.urls = urls;
};

var result = {
init: init,
urls: urls
};

return result;

}();

// Before init
alert(productsModule.urls); // undefined

var urls = {
getProduct: '/Product/'
};

productsModule.init(urls);

alert(productsModule.urls.getProduct); // /Product/ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-26T10:22:34.450

为什么不让 urls 成为可观察的属性？

看我的例子：

[http://jsfiddle.net/Razaz/zkXYC/1/](http://jsfiddle.net/Razaz/zkXYC/1/)

```
var productsModule = function() {

    var urls=ko.observable();

    var init = function(ajaxUrls) {
        urls(ajaxUrls);
    };

    return {
        init: init,
        urls: urls,
        getUrls: function() { return urls(); }
    };

}();

var customersModule = function() {

    var doSomethingWithProductsModule = function() {
        alert(productsModule.urls()); // undefined
        alert(productsModule.getUrls()); // object   
    };       

    return {
        doSomethingWithProductsModule: doSomethingWithProductsModule
    };

}();

var urls = {
    getProduct: '/Product/'
};

productsModule.init(urls);

customersModule.doSomethingWithProductsModule();​ 
```

问候。

# delphi - 为什么我的组合框的 OnChange 事件在其父项是 TStringGrid 时不会触发？

> ID：13080209
> 
> 赞同：1
> 
> 时间：2012-10-26T03:09:02.033
> 
> 标签：delphi, tcombobox

> **可能重复：**
> [为什么 TStringGrid 的子控件不能正常工作？](https://stackoverflow.com/questions/11719454/why-dont-child-controls-of-a-tstringgrid-work-properly)

我有一个可变长度的 TStringGrid，一列有一个 TComboBox 来改变里面的数据。我已将其父级设为 TStringGrid，因此如果向下滚动，我可以使用所选矩形在 StringGrid 内的位置。

出现问题是因为我需要触发 OnChange 事件：问题是当它的父级是 StringGrid 时，触发 OnChange 事件的唯一方法似乎是使用键盘事件，并且选择它的项目不会触发事件。我还尝试在更改父事件和 OnClick 事件（无论如何都不会触发）后重新声明 OnChange 事件。

我不太确定为什么会发生这种情况，但这似乎是父级是 TStringGrid 的问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T06:05:57.963

这是 Parent = TStringGrid 的控件的常见问题。

[在这里](https://stackoverflow.com/questions/11719454/unable-to-toggle-checkboxes-in-string-grid)查看解决方案

# javascript - 当页面滚动到某个点时，如何使第二个固定标题出现

> ID：13080218
> 
> 赞同：0
> 
> 时间：2012-10-25T21:31:44.283
> 
> 标签：javascript, jquery

我有一个响应式页面，并且我还想添加一个标题，一旦访问者滚动一下就会出现。标题将取代主标题，以便在用户浏览页面时可见。

我认为这是人们使用的约定，我需要一些帮助，因为我无法真正从头开始编写代码。

有没有人看过这方面的例子或教程。我看过但想不出来。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T03:01:49.353

查看 Twitter Bootstrap 框架的 Navigation 标头[http://twitter.github.com/bootstrap/components.html#navbar](http://twitter.github.com/bootstrap/components.html#navbar)

> **静态顶部导航栏**通过添加 .navbar-static-top 创建一个随页面滚动的全宽导航栏。与 .navbar-fixed-top 类不同，您不需要更改主体上的任何填充。

# css - CSS 属性顺序有多重要？

> ID：13080220
> 
> 赞同：7
> 
> 时间：2012-10-25T17:48:46.533
> 
> 标签：css

CSS 声明中的属性顺序是否会影响 HTML 的呈现？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-25T18:14:50.760

这确实是一个比我最初想象的更棘手的问题。我的第一反应是：

在 CSS*规则*（也称为“规则集”）中，*声明*的顺序（表单属性：值）是无关紧要的。所以`foo { color: red; background: white; }`等价于`foo { background: white; color: red; }`。规范中没有关于此的单独声明（我想）；这是因为没有任何声明可以使该命令变得重要。

再想一想，我们也可以有

```
* { font: 100% Calibri; font-weight: bold; } 
```

如果切换顺序会发生什么？在浏览器中，它确实有效果。我不确定这应该如何根据 CSS 规范来解释，但浏览器显然并且自然地按顺序处理声明。所以规则使文本加粗，但如果你改变顺序，

```
* { font-weight: bold; font: 100% Calibri; } 
```

然后事情发生了变化。`font`速记设置`font-weight`为其初始值，因此`normal`文本不是粗体。

第三个想法，有许多基于顺序的方法和技巧。所以是的，声明的顺序很重要。

规则顺序的影响是一个完全不同的问题。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-26T03:14:32.177

显然顺序对结果没有任何直接影响。这里已经提到了这个主题：http: [//css-tricks.com/new-poll-how-order-css-properties/](http://css-tricks.com/new-poll-how-order-css-properties/)

根据这里它确实有影响：http: [//css-tricks.com/ordering-css3-properties/](http://css-tricks.com/ordering-css3-properties/)

这是另一个趋势： http: [//perishablepress.com/obsessive-css-code-formatting-patterns-and-trends/](http://perishablepress.com/obsessive-css-code-formatting-patterns-and-trends/)

最终判决：安排你判断最好的方式，它会起作用。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2020-03-11T13:12:58.357

**主要是 5 种 CSS 属性顺序：**

1.  随机
2.  分组依据
3.  按字母顺序
4.  按线长
5.  CSS 属性的重要性

**1.随机**

```
.module {
   border: 1px solid #ccc;
   width: 25%;
   padding: 20px;
   position: relative;
   min-height: 100px;
   z-index: 1;
   border-radius: 20px;
} 
```

**2\. 分组依据**

```
.module {
   width: 25%;
   min-height: 100px;
   padding: 20px;

   border: 1px solid #ccc;
   border-radius: 20px;

   position: relative;
   z-index: 1;
} 
```

**3\. 按字母顺序**

```
.module {
   border-radius: 20px;
   border: 1px solid #ccc;
   min-height: 100px;
   padding: 20px;
   position: relative;
   width: 25%;
   z-index: 1;
} 
```

**4.按线长**

```
.module {
   border: 1px solid #ccc;
   border-radius: 20px;
   position: relative;
   min-height: 100px;
   padding: 20px;
   z-index: 1;
   width: 25%;
} 
```

这是参考网址：[https ://css-tricks.com/new-poll-how-order-css-properties/](https://css-tricks.com/new-poll-how-order-css-properties/)

**5\. 按重要性排序 CSS 属性**

但按重要性排序 CSS 属性的最佳方法

1.  **布局属性**（位置、浮动、清除、显示）
2.  **盒子模型属性**（宽度、高度、边距、填充）
3.  **视觉属性**（颜色、背景、边框、框阴影）
4.  **排版属性**（字体大小、字体系列、文本对齐、文本转换）
5.  **其他属性**（光标、溢出、z-index）

**例子：**

```
.button {
    display:inline-block;
    margin:1em 0;
    padding:1em 4em;
    color:#fff;
    background:#196e76;
    border:0.25em solid #196e76;
    box-shadow:inset 0.25em 0.25em 0.5em rgba(0,0,0,0.3), 
               0.5em 0.5em 0 #444;
    font-size:3em;
    font-family:Avenir, Helvetica, Arial, sans-serif;
    text-align:center;
    text-transform:uppercase;
    text-decoration:none;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-26T02:54:47.593

通常不需要或规则来对 CSS 声明中的属性进行排序。我写的顺序就像我对设计和浏览器响应的要求一样，但是在萤火虫工具中它排列了 sin**字母**顺序。

最好的订购方法是

```
 1\. box model = width ->height->float
 2\. font related = font-size -> text-decoration, font-family
 3\. background images = width, height, border, image 
```

然后，根据我的经验，只有浏览器才能更快地为每个元素分配空间。

有些人订购如下类型：

随机的

按字母顺序

按类型分组

按属性长度

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-26T03:16:39.260

有一些指导方针。但是，归根结底，它归结为浏览器实现。尽量不要依赖某个命令总是有效的，因为它不会。在声明中，语句倾向于覆盖先前的语句。

# ios - 如何防止 UITableViewCell backgroundView 拉伸

> ID：13080232
> 
> 赞同：0
> 
> 时间：2012-10-26T03:11:23.770
> 
> 标签：ios, uitableview, uikit

我正在尝试向 UITableViewCell 添加背景图像，以便每个单元格在底部可以有一些间距。

我正在设置单元格的 backgroundView 属性，如下所示：

```
 [cell setBackgroundView:[[UIImageView alloc] initWithImage:[UIImage imageNamed:@"cell"]]]; 
```

“单元格”图像比 UITableViewCell 的实际高度高 20px，这是故意的，以便我的单元格在底部可以有一些间距。唯一的问题是，“单元格”图像将一直延伸到单元格的 contentView。

有没有办法让我防止单元格将 backgroundView 一直向下拉伸？

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T03:30:39.103

查看 UIView 的[contentMode](http://developer.apple.com/library/ios/documentation/uikit/reference/uiview_class/uiview/uiview.html#//apple_ref/occ/instp/UIView/contentMode)属性。如果背景图像的高度小于单元格的高度，并且您希望图像“粘在顶部”，请尝试设置

```
cell.backgroundView.contentMode = UIViewContentModeTop; 
```

查看[此页面](http://developer.apple.com/library/ios/#documentation/windowsviews/conceptual/viewpg_iphoneos/WindowsandViews/WindowsandViews.html)上的“内容模式”部分了解更多信息。它提到...

> “默认情况下，大多数视图的 contentMode 属性设置为 UIViewContentModeScaleToFill，这会导致视图的内容被缩放以适应新的帧大小。”

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T03:15:33.923

两种选择：

1）手动放大图像，在间隙中填充透明空间。（更简单的解决方案）。

2）在您的 UITableViewCell 中添加另一个 UIView，使其与图像一样大。在此视图中添加您的文本标签（如果有）。

# gnu-make - 如何在 GNUmake 中编写目标以仅创建 *.o 文件

> ID：13080233
> 
> 赞同：0
> 
> 时间：2012-10-26T03:11:25.143
> 
> 标签：gnu-make

有没有办法写一个目标

1）只创建目标文件？

2）只链接目标文件并创建二进制文件？

我希望能够分两步创建我的二进制文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T03:57:46.387

有一个[隐含的规则](http://www.gnu.org/software/make/manual/html_node/Implicit-Rules.html)。假设您有以下 Makefile：

```
CC=cc -g

all: client

client: client.c
    $(CC) client.c -o client

clean:
    -rm -f client 
```

如果你只想要目标文件，那么你只需要运行：

```
$ make client.o 
```

你会得到目标文件。但是，您也可以编写显式规则，例如：

```
%.o: %.c
    $(CC) -c $< 
```

前面的规则是从任何`.c`文件构建到对象 ( `.o`) 文件的规则。`$<`有助于获取规则所依赖的文件名。

如果您有多个对象文件，则可能需要定义变量：

```
objects = client.o foo.o bar.o

client: $(objects)
    $(cc) -o $@ $(objects)

$(objects): config.h

clean:
    -rm -f client $(objects) 
```

在这种情况下，`objects`是一个与您要编译的目标文件相关联的变量。它在规则`client`中用作依赖项和链接它们的参数，也用于定义依赖于头文件的规则（`config.h`在本例中），并且在规则中使用 finalle`clean`删除它们以重新开始。

`$@`是规则名称的替换。在最后一种情况下，它会是`client`.

[GNU Make 手册](http://www.gnu.org/software/make/manual/make.html#Rules)包含许多可以启发您学习过程的示例。

# asp.net - 在 ASP.NET 中使用 AjaxControlToolkit 的异步 AJAXFileUpload 控件返回数据

> ID：13080240
> 
> 赞同：3
> 
> 时间：2012-10-26T03:12:52.163
> 
> 标签：asp.net, ajax, ajaxcontroltoolkit

我正在使用上面的控件（注意它是 ASP.NET 控件。我似乎看到很多人使用用 javascript 编写的类似名称的控件）来允许上传多个带有进度条的文件上传，拖放，等等。那部分一切正常，但我需要与文件一起返回两条数据。具体来说，用户输入的纬度和经度来自两个文本框。由于上传控件是异步的，文本框的内容不会被发回，所以我无法访问它们。似乎有一个我可以挂钩的属性，ContextKeys，它将数据发送回服务器，但它是一个静态字段，我不知道如何动态操作它。我已经尝试从文本框中挂钩 ontextchanged 事件并使用它们来设置上下文键。

有谁如何以编程方式设置 ContextKeys 属性，或以其他方式通过上传发送回数据？

这是代码：

.ASPX

```
<div style="float:left; width: 325px;">
    <cc1:AjaxFileUpload ID="AjaxFileUpload1" runat="server" Width="325px" 
         onuploadcomplete="UploadComplete" ClientIDMode="Static" />
    <cc1:DynamicPopulateExtender ID="AjaxFileUpload1_DynamicPopulateExtender" 
        runat="server" Enabled="True" PopulateTriggerControlID="" 
        TargetControlID="AjaxFileUpload1">
    </cc1:DynamicPopulateExtender>
</div>
<div style="float:left">Latitude:
    <asp:TextBox ID="tbUploaderLat" runat="server" 
        ontextchanged="tbUploaderLat_TextChanged" AutoPostBack="True"></asp:TextBox><br />
    Longitude:
    <asp:TextBox ID="tbUploaderLon" runat="server"
        ontextchanged="tbUploaderLon_TextChanged" AutoPostBack="True"></asp:TextBox>
</div> 
```

代码隐藏：

```
protected void UpdateLatLon() //this is called from the two events above
{
    AjaxFileUpload1.ContextKeys = tbUploaderLat.Text + "|" + tbUploaderLon.Text;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T11:42:59.007

[您可以按照此处](https://stackoverflow.com/a/13084169/360171)和[此处](https://stackoverflow.com/a/11689062/360171)的描述自定义 AjaxFileUpload 控件，并将文本框值传递给 UploadCompleted 事件处理程序，如下所示：

```
function uploadStarted(sender, args) {
     var latitude = $get("<%= tbUploaderLat.ClientID %>").value;
     var longitude = $get("<%= tbUploaderLon.ClientID %>").value;
     sender.contextKeys = { "latitude": latitude, "longitude": longitude };
}​ 
```

之后，您可以在 UploadComplete 处理程序中获取纬度和经度值：

```
protected void AjaxFileUpload1_OnUploadComplete(object sender, AjaxFileUploadEventArgs file)
{
    if (!string.IsNullOrEmpty(file.ContextKeys))
    {
        var longLat = new System.Web.Script.Serialization.JavaScriptSerializer().Deserialize<Dictionary<string, string>>(file.ContextKeys);
        var longitude = longLat["longitude"];
        var latitude = longLat["latitude"];
    }

    //code to save file

} 
```

# javascript - 通过具有客户端证书身份验证的安全 http 服务器的 Websockets

> ID：13080248
> 
> 赞同：0
> 
> 时间：2012-10-26T03:13:55.267
> 
> 标签：javascript, websocket, client-certificates

我有一个 PSGI/Plack 应用程序托管在反向 https 代理后面。访问者使用客户端证书进行身份验证。我使用 websockets 来传递数据（比如，“tail -f”的输出异步到浏览器。直接访问时应用程序工作正常，但通过反向 https 代理访问时不能正常工作。有什么方法可以使用客户端证书身份验证网络套接字？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T07:27:42.400

有2个选项：

1.  让反向代理终止 TLS，执行基于客户端证书的身份验证并将未加密的流量转发到后面的 WebSocket 服务器

2.  让反向代理将未触及的 TLS 转发到 WebSocket 服务器

使用 2.，您将需要一个实现 TLS 和基于客户端证书的身份验证的 WebSocket 服务器。

这是一个基于 Autobahn（基于 Python/Twisted）的启用 TLS 的 WebSocket 服务器示例：

*   [https://github.com/tavendo/AutobahnPython/tree/master/examples/websocket/echo_tls](https://github.com/tavendo/AutobahnPython/tree/master/examples/websocket/echo_tls)

您可以按照此处的示例添加客户端证书身份验证：

*   [http://twistedmatrix.com/documents/current/core/howto/ssl.html#auto7](http://twistedmatrix.com/documents/current/core/howto/ssl.html#auto7)

免责声明：我是 Autobahn 的作者，为 Tavendo 工作。

# ruby-on-rails-3.2 - rails 3.2 环境中的 factory_girl_rails 4.1.0 产生“未注册工厂：用户”

> ID：13080249
> 
> 赞同：1
> 
> 时间：2012-10-26T03:13:58.010
> 
> 标签：ruby-on-rails-3.2, factory-bot, rspec-rails

我是 factory_girl 菜鸟，无法确定为什么工厂没有“注册”。不知道在哪里注册。

Gemfile 的相关部分：

```
...
group :development, :test do
  gem 'rspec-rails'
  gem 'factory_girl_rails'
end

group :test do
  gem 'faker'
  gem 'capybara'
  gem 'guard-rspec'
  gem 'launchy'
end
... 
```

config/application.rb 的相关部分：

```
...
module Appname
  class Application < Rails::Application
    ...
    config.generators do |g|
      g.test_framework :rspec,
        :fixtures => true,
        :view_specs => false,
        :helper_specs => false,
        :routing_specs => true,
        :controller_specs => true,
        :request_specs => true
      g.fixture_replacement :factory_girl, :dir => "spec/factories"
    end
    ...
  end
end 
```

spec/models/user_spec.rb 的相关部分：

```
require 'spec_helper'

describe User do
  it "has a valid factory" do
    FactoryGirl.create(:user).should be_valid
  end
  ...
end 
```

$rspec spec/models/user_spec.rb 的结果：

```
Failures:

  1) User has a valid factory
     Failure/Error: FactoryGirl.create(:user).should be_valid
     ArgumentError:
       Factory not registered: user 
```

* * *

更新：

规格/工厂/users.rb：

```
require 'faker'

FactoryGirl.define do
  factory :contact do |f|
    f.first_name { Faker::Name.first_name }
    f.last_name { Faker::Name.last_name }
    f.email { Faker::Internet.email }
    f.password { Faker::Name.last_name }
    f.password_confirmation { Faker::Name.last_name }
  end
end 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-27T00:26:58.020

从评论线程：您可能希望将`factory :contact`您的工厂更改为`factory :user`：

```
FactoryGirl.define do
  factory :user do |f|
    ...
  end
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T06:47:20.280

试试这个，在你的`app/spec/factories/`文件夹中创建`user.rb`并写入

```
require 'factory_girl'

FactoryGirl.define do
  factory :user do
    lname "test12"
    fname "test12"
    ... # whatever
  end
end 
```

在你的`user_spec.rb`

```
describe User do
  before { @user = FactoryGirl.create(:user, :fname => "abc", :lname => "fname") }
  subject { @user }
  it { should respond_to(:fname) }
  it { should respond_to(:lname)}
  it { should be_valid }
end 
```

# internet-explorer - 导致 IE 问题的 HTTP 标头？

> ID：13080250
> 
> 赞同：2
> 
> 时间：2012-10-26T03:14:28.133
> 
> 标签：internet-explorer, http

我有一个奇怪的问题，我无法追踪。Internet Explorer 的用户报告说，IE 在完成加载带有以下标头的页面后会抛出“页面无法显示”消息。他们短暂地看到该页面，但随后它消失并被错误页面取代。页面的内容是什么似乎并不重要。我似乎已经追踪到这些标题：

```
Expires: Fri, 13 Jan 2012 01:00:00 GMT
Date: Fri, 26 Oct 2012 02:02:33 GMT
Pragma: no-cache
Last-modified: Fri, 26 Oct 2012 02:02:33 GMT
Cache-control: private, no-cache, no-store, must-revalidate, max-age=0, pre-check=0, post-check=0
Content-Type: text/html; charset=ISO-8859-1 
```

在我见过的大多数情况下，用户的时钟似乎从服务器显着向前运行（最多半小时）。他们似乎都在运行 IE8 的笔记本电脑上。有任何想法吗？服务器也在端口 8181 而不是 80 上运行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T23:33:18.753

你是如何追踪到这些标题（而不是 html 文件的内容）的？我通常宁愿猜测它是文件的内容。您是否尝试过手写的、简单`<html><body>hi</body></html>`样式的 html 页面（有或没有您提到的那些可选标题）？

如果您可以访问可以重现问题的客户端，我会在客户端上使用**[Fiddler](http://www.fiddler2.com/fiddler2/)**记录一次请求，将它（/它们）拖到右侧“**自动响应”选项卡**中的列表中（您需要`Enable automatic responses`首先将请求放入列表中）然后让 Fiddler 返回响应，而不是服务器，每次删除单个标头或更改 html 以缩小范围。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T07:28:41.720

我不确定，您是否尝试在没有标题的情况下运行您的网站？如果它有效，那么您可能需要将`pragma`标题更改为`header ('Pragma: public');`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T07:39:00.583

当 Internet Explorer 连接到 Web 服务器并且从 DNS 服务器返回的 IP 地址列表包含多个 IP 地址时，Internet Explorer 会尝试按照接收到的顺序使用这些 IP 地址进行 TCP 连接。成功建立 TCP 连接后，Internet Explorer 将使用该 IP 地址向其发送 HTTP 请求。

检查下面的链接。

[http://support.microsoft.com/kb/2293762](http://support.microsoft.com/kb/2293762)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-02T05:06:23.557

我发现这是 mcafee 防病毒问题的问题。

# android - 移除 IOS/Android URL 标头 onchangeevent

> ID：13080257
> 
> 赞同：0
> 
> 时间：2012-10-26T03:15:15.077
> 
> 标签：android, jquery, ios, orientation-changes

我很难过......我正在尝试删除 IOS 中的 url 标头，用于 iPhone 和 Android。问题是我需要顶级房地产，而我在网上看到的仍然无法完成工作。

这是场景......在网站上，他们是一个弹出覆盖的链接。覆盖层内是我的 iframe 和我的内容（仅适用于横向模式）。为纵向显示此（有效）为横向显示此（有效）。但是 URL Header 占用了太多空间，我需要将其删除。

这是代码：

```
updateOrientation: function(){
    var parentWindow = parent.window;
    switch(parent.window.orientation){
    case 0:
        document.body.style.height = (window.outerHeight + 50) + 'px';
        setTimeout( function(){ window.scrollTo(0, 1);
        }, 50);
        $('section#portraitMode').show();
        break;
    default:
        setTimeout( function(){ window.scrollTo(0, 1); 
        }, 50);
        $('section#portraitMode').hide();

        break;
    }

},
changeParentViewport: function () {
    var parentWindow = window.parent.window;
    var parentDocument = window.parent.document;
    if (parentWindow.orientation == 0) {
        var metaViewport = $('meta[name="viewport"]', parentDocument);
        metaViewport.attr('content',"width=320, height=480 initial-scale=1.0, maximum-scale=1.0, user-scalable=no");
    } else {
        var metaViewport = $('meta[name="viewport"]', parentDocument);
        metaViewport.attr('content',"width=480, height=320 initial-scale=1.0, maximum-scale=1.0, user-scalable=no");
    }
} 
```

}

window.addEventListener("load", function(){ this.changeParentViewport(); this.updateOrientation(); var parentWindow = window.parent.window;

```
var supportsOrientationChange = 'onorientationchange' in parentWindow,
    orientationEvent = supportsOrientationChange ? 'orientationchange' : 'resize';

parentWindow.addEventListener(orientationEvent, function() {
    this.changeParentViewport();
    this.updateOrientation();
}, false); 
```

});

# log4j - DailyRollingFileAppender 不起作用

> ID：13080259
> 
> 赞同：4
> 
> 时间：2012-10-26T03:15:39.937
> 
> 标签：log4j, rollingfileappender

我使用 Log4j 编写一些日志我的程序。我在这个网站上找到并阅读了许多问题和答案，但我无法解决我的问题。

这是我的代码：

**1.log4j.xml**

```
<appender name="rollingfileAppender" class="org.apache.log4j.DailyRollingFileAppender">
    <param name="append" value="true"/>
    <param name="file" value="logs/process.log"/>
    <param name="DatePattern" value="'.'yyyy-MM-dd-HH"/>
    <layout class="org.apache.log4j.PatternLayout">
       <param name="ConversionPattern" value="%d{yyyy-MM-dd HH:mm:ss:SSS} %-5p [%c{1}] %m%n"/>
    </layout>
</appender>
<root>
    <level value="DEBUG"/>
    <appender-ref ref="rollingfileAppender"/>
    <appender-ref ref="stdout"/>
</root> 
```

**2.我的java代码**

```
package TestPacket;

import org.apache.log4j.Logger;
import org.apache.log4j.xml.DOMConfigurator;

public class TestLog4jXML {
    static Logger logger = org.apache.log4j.Logger.getLogger(TestLog4jXML.class.getName());
    public TestLog4jXML() {
    }
    public static void main(String[] args) {
        try {
            DOMConfigurator.configure("log4j1.xml");
            logger.trace("Entering application.");
            logger.debug("Debug");
            logger.info("info");
            logger.warn("warn");
            logger.error("error");
            logger.fatal("fatal");
            lungtng();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
    public static void lungtng()
    {
        logger.fatal("some text here");
        logger.info("hello picaso");
    }
} 
```

我用eclipse、windows os运行我的程序。但日志文件名只有：*process.log*不是每日格式：*process.log.yyyy-MM-dd-HH*

谁能给我解释一下？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-09-26T18:54:04.270

看来，如果您正在运行 Windows，这是一个已知的错误：

见这里：[http ://do.whileloop.org/2014/02/14/log4j-rolling-file-appenders-in-windows/](http://do.whileloop.org/2014/02/14/log4j-rolling-file-appenders-in-windows/)

见这里：[https ://issues.apache.org/bugzilla/show_bug.cgi?id=29726](https://issues.apache.org/bugzilla/show_bug.cgi?id=29726)

还有这里： http: [//www.coderanch.com/t/424837/java/java/Log-log-file-rolled-day](http://www.coderanch.com/t/424837/java/java/Log-log-file-rolled-day)

解决方案似乎是在这里使用附加功能：http: [//logging.apache.org/log4j/extras/](http://logging.apache.org/log4j/extras/)

尝试使用定义了正确策略的附加程序：

[http://logging.apache.org/log4j/extras/apidocs/org/apache/log4j/rolling/RollingFileAppender.html](http://logging.apache.org/log4j/extras/apidocs/org/apache/log4j/rolling/RollingFileAppender.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-26T10:19:13.407

org.apache.log4j.DailyRollingFileAppender 将为每天、每小时或每分钟创建新的日志文件，但当前日志的文件名将始终采用您在“文件”参数中指定的格式。在您的示例中，它是“process.log”。前几个小时的日志文件名将采用“process.log.yyyy-MM-dd-HH”格式。

# javascript - Web Audio API 延迟声音在 Chrome 中失真

> ID：13080260
> 
> 赞同：2
> 
> 时间：2012-10-26T03:15:45.310
> 
> 标签：javascript, html, web-audio-api

我正在使用带有 javascript 的 Web Audio API。

我创建了一个振荡器，将其连接到音量（gainNode），将其连接到目的地。

行。好的。

我想要一个延迟效果，我把它放在振荡器和音量之间。

好吧，那不起作用，我只听到延迟。虽然，很干净。

好的，所以我将 osc 连接到卷的延迟，将 osc 连接到卷，然后将卷连接到目的地。

现在它似乎被扭曲了。

我尝试将 osc 延迟到目的地的音量，将 osc 延迟到目的地，因此有两个到目的地的连接。这也是扭曲的。

那是在铬上。

在我不得不尝试的一小段时间里，它似乎在 iOS6 上运行良好。不知道野生动物园。

通过访问[http://cloudmusiccompany.appspot.com/watch.jsp](http://cloudmusiccompany.appspot.com/watch.jsp)并单击红色和绘图来尝试。这是一个正常的正弦振荡器。现在单击白色并绘制，这与延迟相同，并且在 chrome（Ubuntu）上它被扭曲了。不知道萨法尔。

显然，您可以在链接中看到完整的源代码，因为它是 javascript。

相关来源：

```
function makeNewChannel(color){
  var info = getInstrumentInfo(color);
  var chan = {osc: acontext.createOscillator(),
    freqs: [],
    times: [],
    pxdata: [],
    i: 0,
    muted: true,
    finishedLoop: false, 
    volume: acontext.createGainNode(), 
    gate: acontext.createGainNode(), 
    delay: acontext.createDelayNode(),
    delayGain: acontext.createGainNode(), 
    mute: function(){
      this.muted = true;
      this.volume.gain.value = 0;
    },
    unmute: function(){
      this.muted = false;
      this.volume.gain.value = player.defaultGain / (info.soft ? 2 : 1);
    }
  }
  chan.osc.type = info.type;

  //        chan.osc.connect(chan.gate);
  chan.osc.connect(chan.volume);

  chan.delayGain.gain.value = player.defaultGain ;
  /* ugh , the wet sounds ok, but somehow its distorting or doubling the dry signal
   * although it seems ok on iphone?
   * */
  if (info.delay){
    chan.delay.delayTime.value = 0.5;
    chan.volume.connect(chan.delay)
    chan.delay.connect(chan.delayGain);

    chan.delayGain.connect(acontext.destination);

  }
  chan.volume.gain.value = 0; //player.defaultGain;
  chan.gate.gain.value = 0;
  chan.volume.connect(acontext.destination);
  chan.osc.frequency.value = 0;

  chan.osc.noteOn(0);
  return chan;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T00:04:00.773

我刚刚有机会在 Windows 上的 Chrome 上使用它，它运行良好。延迟听起来应该。

这一定是Linux版本（chrome的）中的一个bug

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T11:06:26.410

您可以通过在上下文目的地之前添加一个压缩器来解决这个问题。所有路径都应该连接到它，然后压缩器连接到目的地。

[https://dvcs.w3.org/hg/audio/raw-file/tip/webaudio/specification.html#DynamicsCompressorNode](https://dvcs.w3.org/hg/audio/raw-file/tip/webaudio/specification.html#DynamicsCompressorNode)

# python - eclipse pydev 不能与 newClassName = oldClassName 一起工作

> ID：13080262
> 
> 赞同：0
> 
> 时间：2012-10-26T03:15:50.433
> 
> 标签：python, eclipse, python-3.x, pydev, kombu

一个kombu的例子：

```
#!/usr/bin/env python3
from __future__ import with_statement

from kombu import BrokerConnection

with BrokerConnection("amqp://guest:guest@localhost:5672//") as conn:
    with conn.SimpleQueue("kombu_demo") as queue:
        queue.put({"hello": "world"}, serializer="json", compression="zlib") 
```

它在控制台工作，但在eclipse+pydev中不能工作，问题是找不到BrokerConnection，我在kombu src中找到'BrokerConnection = Connection'，kombu有一个名为Connection的类，想给它一个别名BrokerConnection，但是ecrilpse+pydev 不能很好地处理这个问题，如何解决这个问题？

# mysql - mySQL 版本之间的强制迁移。收到 #1064 错误

> ID：13080264
> 
> 赞同：-1
> 
> 时间：2012-10-26T03:15:54.783
> 
> 标签：mysql

我正在尝试将在 mySQL 5.0.92 中创建的转储导入 mySQL 5.1.63。但是我收到一个错误。

```
Error
SQL query:

-- -- Database: 'removed_keyboard' -- -- -------------------------------------------------------- -- -- Table structure for table 'bindings' -- CREATE TABLE IF NOT EXISTS 'bindings' ( 'binding_id' int(10) unsigned NOT NULL auto_increment, 'game_id' int(5) unsigned NOT NULL, 'layout_id' tinyint(3) unsigned NOT NULL, 'key_number' tinyint(3) unsigned NOT NULL, 'normal_action' varchar(128) default NULL, 'normal_group' tinyint(2) unsigned default NULL, 'shift_action' varchar(64) default NULL, 'shift_group' tinyint(2) unsigned default NULL, 'ctrl_action' varchar(64) default NULL, 'ctrl_group' tinyint(2) unsigned default NULL, 'alt_action' varchar(64) default NULL, 'alt_group' tinyint(2) unsigned default NULL, 'altgr_action' varchar(64) default NULL, 'altgr_group' tinyint(2) unsigned default NULL, 'extra_action' varchar(64) default NULL, 'extra_group' tinyint(2) unsigned default NULL, 'image_file' varchar(256) default NULL, PRIMARY KEY ('binding_id')[...]

MySQL said: 

#1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''bindings' (
  'binding_id' int(10) unsigned NOT NULL auto_increment,
  'game_id' at line 11 
```

错误是什么？我不熟悉不同 mySQL 版本之间的差异。它们之间是否有一个对新手友好的语法差异列表？

谢谢！谢谢！

麦克风

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T06:18:27.247

看起来像使用 (') 而不是对象名称周围的反引号 (`) -

```
CREATE TABLE 'bindings' (
  'binding_id' int(10) unsigned NOT NULL auto_increment,
  'game_id' at line 11... 
```

将这些 (') 更改为 (`) -

```
CREATE TABLE `bindings` (
  `binding_id` int(10) unsigned NOT NULL auto_increment,
  `game_id` at line 11... 
```

*   ' 用于引用字符串文字
*   ` 用于引用标识符（表、列名等）

# javascript - 对单选按钮的困惑

> ID：13080265
> 
> 赞同：2
> 
> 时间：2012-10-26T03:16:12.133
> 
> 标签：javascript, jquery, html

我正在迭代以前的邻居单选按钮。我的 html 看起来像这样：

```
<div class="holder">
<span class="">some text</span>
<input type="radio" name="test_capability" value="primary" checked="" />
</div>

<div class="holder">
<span class="">some text</span>
<input type="radio" name="test_capability" value="primary" checked="checked" />
</div>

<div class="holder">
<span class="">some text</span>
<input type="radio" name="test_capability" value="primary" checked="" />
</div> 
```

我正在尝试添加类`red`以跨越其邻居单选按钮被选中。这是我尝试的方法：

```
$('.holder span').each(function(){
                var spanElement = $(this);
                if(spanElement.nextAll(':radio:first').is(':checked')){
                    spanElement.addClass("red");
                }
            }); 
```

我总是以最后一个跨度（第三个持有人 div 中的一个）结束 class `red`。但正如你所看到的，中间的被选中了。`checked=checked`当我设置第一个跨度时也会发生同样的事情

**更新**

也试过：

```
$('.holder span').each(function(){
                if($(this).next().attr("checked") == "checked"){
                    $(this).addClass("red");
                }
            }); 
```

同样的结果，不知道还有什么要尝试的。

**更新二**：

`checked=checked`Html 会使用从服务器端生成的先前信息进行渲染，因此一旦创建了 html ，就只能有一个单选输入元素。

我正在文档就绪功能中进行此迭代槽跨度。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T03:21:29.900

试试这个改变：

```
$('.holder span').each(function(){
                var spanElement = $(this);
                if(spanElement.next('input[type=radio]').is(':checked')){
                    spanElement.addClass("red");
                }
            }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T03:23:10.930

您可以选择选中的输入并将类添加到它的兄弟 span 元素。

```
$('.holder input[type=radio]:checked').prev('span').addClass('red') 
```

[http://jsfiddle.net/TdR7k/](http://jsfiddle.net/TdR7k/)

如果您想在更改事件中添加和删除类，您可以尝试以下操作：

```
$('.holder input[type=radio]').change(function() {
     $('.red').removeClass('red');
     $(this).prev('span').addClass('red')
}).change() 
```

[http://jsfiddle.net/dSv6P/](http://jsfiddle.net/dSv6P/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T03:46:54.277

问题是您定义单选按钮的方式，不要在 html 中包含选中的属性，否则默认情况下会检查它们：http: [//jsfiddle.net/TdR7k/1/](http://jsfiddle.net/TdR7k/1/)

```
<div class="holder">
<span class="">some text</span>
<input type="radio" name="test_capabiy" value="primary" checked="" />
</div>

<div class="holder">
<span class="">some text</span>
<input type="radio" name="test_capability" value="primary" checked="checked" />
</div>

<div class="holder">
<span class="">some text</span>
<input type="radio" name="test_capabiliy" value="primary" checked  />
</div>​ 
```

三个都被检查

单选按钮的正确定义是

```
<input type="radio" name="(Group)" value="(etc)"  /> 
```

并且默认情况下检查它，所有这些都是必需的：

```
<input type="radio" name="(Group)" value="(etc)" checked /> 
```

您正在添加默认情况下都选中的同一组的三个单选按钮，因此最后一个会覆盖前两个并获得红色类

但主要针对实际答案，不要将选中作为属性并将javascript作为onclicked事件应用，或者仅将选中添加到单个元素这里是onclick事件的示例：http: [//jsfiddle.net/7kbLf /2/](http://jsfiddle.net/7kbLf/2/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-26T04:17:13.937

如果单选按钮包含选中的属性。然后默认**选中**..

```
<input type="radio" name="group1" value="hello" checked>  // Checked by default. 
```

因此，删除其他两个 RadioButtons 的**checked 属性**。

```
<div class="holder"> 
    <span>some text</span> 
    <input type="radio" name="test_capability" value="primary" /> 
</div>
<div class="holder">
   <span>some text</span>
   <input type="radio" name="test_capability" value="primary" checked="checked"/> 
</div>
<div class="holder"> 
    <span>some text</span> 
    <input type="radio" name="test_capability" value="primary" />
 </div> 
```

如果您以这种方式设置 HTML，您的方法应该可以工作..

```
$('.holder span').each(function() {
    var spanElement = $(this);
    if (spanElement.nextAll(':radio:first').is(':checked')) {
        spanElement.addClass("red");
    }
});

// Change event 
$('input[type="radio"]').on('change', function() {
    $('span').removeClass('red');

    if( this.checked){
        $(this).closest('div.holder').find('span').addClass('red');
    }
}); 
```

**[检查小提琴](http://jsfiddle.net/sushanth009/MR2EL/)**

# python - 如何在两个可以使用 python 发送到 Reviewboard 的 Json 对象之间创建手动差异？

> ID：13080270
> 
> 赞同：0
> 
> 时间：2012-10-26T03:17:08.023
> 
> 标签：python, review-board

如何创建两个 json 对象的差异，以便它们采用可以发送到审查板的手动差异格式？我需要从 python 脚本中生成差异。我认为手动差异是使用“diff file1 file2”命令行实用程序生成的。我可以使用 difflib 生成类似的评论板兼容差异吗？还是我需要使用另一个库？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T03:25:38.213

使用 difflib：

```
def show_diff(seqm):
    output= []
    for opcode, a0, a1, b0, b1 in seqm.get_opcodes():
        if opcode == 'equal':
            output.append(seqm.a[a0:a1])
        elif opcode == 'insert':
            output.append("<ins>" + seqm.b[b0:b1] + "</ins>")
        elif opcode == 'delete':
            output.append("<del>" + seqm.a[a0:a1] + "</del>")
        elif opcode == 'replace':
            output.append("<del>" + seqm.a[a0:a1] + "</del>" + "<ins>" + seqm.b[b0:b1] + "</ins>" )
        else:
            raise RuntimeError, "Unexpected opcode"
    return ''.join(output) 
```

在您的情况下，您比较您的 json 文件（我只是使用了虚拟文本）：

```
In [4]: sm = difflib.SequenceMatcher(None, 'hello', 'hello world')

In [6]: diff = show_diff(sm)

In [7]: diff
Out[7]: 'hello<ins> world</ins>' 
```

如果您需要 difflib 的不同输出，请查看[文档](http://docs.python.org/library/difflib.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T03:34:26.793

我只是认为在通过差异之前，您应该重新格式化 JSON 对象，让我们按照字母和数字顺序说。

# java - 8 益智游戏打法

> ID：13080271
> 
> 赞同：0
> 
> 时间：2012-10-26T03:18:01.910
> 
> 标签：java, user-interface, puzzle

我做了一个 8 字谜游戏。我发现我的打乱方法有问题，但我不知道如何解决。有没有人可以帮助我的代码？这是打乱方法代码。我的代码问题是，点击打乱按钮后，数字只会显示两个数字图片，然后再次单击打乱，它只显示9个按钮中的一个数字。

```
public void scramble()
{
     for(int i = 0; i <SHUFFLE_NUM; i++)
    {
        int x1 = rand.nextInt(BOARD_SIZE);
        int x2 = rand.nextInt(BOARD_SIZE);
        int y1 = rand.nextInt(BOARD_SIZE);
        int y2 = rand.nextInt(BOARD_SIZE);

        Piece temp = board[x1][y1];
        board [x1][y1] = board[x2][y2];
        board[x1][y2] = temp;
    }
} 
```

***更新***

在这里我发现另一个错误，在我单击重置按钮后，当我尝试移动我的数字按钮时，移动步骤是错误的。在这里我附上我的移动方法和重置方法

```
public boolean move(int _x, int _y)
    {

    boolean valid = false;

    if(_x == currentCol-1 && _y == currentRow ) // on the left of empty one
        valid = true;

    else if(_x == currentCol+1&&_y == currentRow) //on the right of empty one
        valid = true;

    else if(_x == currentCol&&_y == currentRow-1) // on the top of empty one
        valid = true;

    else if(_x == currentCol &&_y == currentRow +1) // on the bottom of empty one
        valid = true; 

    if(valid)
    {
        Piece temp;
        temp = board[_x][_y];
        board[_x][_y] = board[currentCol][currentRow];
        board[currentCol][currentRow] = temp;

        currentCol = _x;
        currentRow = _y;
    }

    return valid;

} 
```

这是重置方法

```
public void reset()
    {

    for(int i =0; i<BOARD_SIZE; i++)
      for(int j =0; j<BOARD_SIZE; j++)
      {
          int value = i*BOARD_SIZE+j+1 ;
            String filePath;
            if(value!= BOARD_SIZE*BOARD_SIZE)
                filePath = "Piece" + value +".jpg"; //what is this mean?
            else
                filePath = "blank piece.jpg";
            board[i][j]= new Piece(new ImageIcon(filePath),i, j, value);

      }

} 
```

如果我没有点击重置按钮，移动是正确的..

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-26T03:22:40.023

虽然我相信答案是显而易见的，但我真的不想告诉你。

相反，我建议您学习如何调试。

拥有一个像 Eclipse 这样的现代 IDE，或者有一个单元测试或一个小应用程序，然后打开调试模式，然后运行你的代码。

在 for 循环中添加断点，单步执行，检查变量和`board`. 你会很容易知道答案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-26T03:21:31.150

```
 board[x1][y2] = temp; 
```

这不应该是

```
 board[x2][y2] = temp; 
```

**更新**

调用你的`reset()`方法后，你的`currentCol`and`currentRow`变量会出错；您需要更新它们以指向新的空块。在退出方法之前添加：

```
currentCol = BOARD_SIZE - 1;
currentRow = BOARD_SIZE - 1; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-26T03:22:34.877

您的交换代码有点错误...

```
Piece temp = board[x1][y1];
board [x1][y1] = board[x2][y2];
board[x1][y2] = temp; // You're mapping the wrong x position here 
```

它应该读

```
Piece temp = board[x1][y1];
board [x1][y1] = board[x2][y2];
board[x2][y2] = temp; 
```

# apache - Ubuntu 10 Apache 虚拟主机突然丢失

> ID：13080273
> 
> 赞同：0
> 
> 时间：2012-10-26T03:18:25.643
> 
> 标签：apache, ubuntu, apache2, virtualhost

我在 Ubuntu 机器上设置了一堆 apache 虚拟主机。他们工作了很长时间，现在他们不是：

```
$ a2ensite /etc/apache2/sites-available/somesite.com 
ERROR: No site found matching /etc/apache2/sites-available/somesite.com! 
```

我做错了什么？这发生在我机器上的所有虚拟主机上。它们都在下面，`/etc/apache2/sites-available/`但 apache 似乎没有看到它们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T03:42:09.623

你应该使用`a2ensite somesite.com`.

# python - 骰子游戏中的语法错误

> ID：13080280
> 
> 赞同：0
> 
> 时间：2012-10-26T03:19:29.557
> 
> 标签：python, syntax, dice

我在 python 中制作了这个骰子游戏，但是我的 inputdice 函数出现语法错误。下面是整个骰子游戏。运行时，游戏应该经过 10 轮并在第 10 轮后或用户用完钱时停止。有什么建议么？

```
from random import *

def dice1():
    print("+-----+")
    print("|     |")
    print("|  *  |")
    print("|     |")
    print("+-----+")

def dice2():
    print("+-----+")
    print("|*    |")
    print("|     |")
    print("|    *|")
    print("+-----+")

def dice3():
    print("+-----+")
    print("|*    |")
    print("|  *  |")
    print("|    *|")
    print("+-----+")

def dice4():
    print("+-----+")
    print("| * * |")
    print("|     |")
    print("| * * |")
    print("+-----+")

def dice5():
    print("+-----+")
    print("|*   *|")
    print("|  *  |")
    print("|*   *|")
    print("+-----+")

def dice6():
    print("+-----+")
    print("|*   *|")
    print("|*   *|")
    print("|*   *|")
    print("+-----+")

def drawdice(d):
    if d==1:
        dice1()
    elif d==2:
        dice2()
    elif d==3:
        dice3()
    elif d==4:
        dice4()
    elif d==5:
        dice5()
    elif d==6:
        dice6()
    print()

def inputdie():
    dice=input(eval("Enter the number you want to bet on --> "))
    while dice<1 or dice>6:
        print("Sorry, that is not a good number.")
        dice=input(eval("Try again. Enter the number you want to bet on --> "))
    return dice

def inputbet(s):
    bet=input(eval("What is your bet?"))
    while bet>s or bet<=0:
        if bet>s:
            print("Sorry, you can't bet more than you have")
            bet=input(eval("What is your bet?"))
        elif bet<=0:
            print("Sorry, you can't bet 0 or less than 0")
            bet=input(eval("What is your bet?"))
    return bet

def countmatches(numbet,r1,r2,r3):
    n=0
    if numbet==r1:
        n+=1
    if numbet==r2:
        n+=1
    if number==r3:
        n+=1
    return n

def payoff(c,betam):
    payoff=0
    if c==1:
        print("a match")
        payoff=betam
    elif c==2:
        print("a double match!")
        payoff=betam*5
    elif c==3:
        print("a triple match!")
        payoff=betam*10
    else:
        payoff=betam*(-1)
    return payoff

def main():
    dollars=1000
    rounds=1
    roll=0
    single=0
    double=0
    triple=0
    misses=0
    flag=True
    print("Play the game of Three Dice!!")
    print("You have", dollars, "dollars to bet with.")
    while dollars>0 and rounds<11 and flag==True:
        print("Round", rounds)
        dicebet=inputdie()
        stake=inputbet(dollars)
        for roll in randrange(1,7):
            roll1=roll
        for roll in randrange(1,7):
            roll2=roll
        for roll in randrange(1,7):
            roll3=roll
        drawdice(roll1)
        drawdice(roll2)
        drawdice(roll3)
        matches=countmatches(dicebet,roll1,roll2,roll3)
        dollarswon=payoff(matches,stake)
        if matches==1:
            single+=1
        elif matches==2:
            double+=1
        elif matches==3:
            triple+=1
        elif matches==0:
            misses+=1
        if dollarswon>0:
            print("You got a match!")
            print("You won $", dollarswon, sep='')
            dollars=dollars+dollarswon
            print("Your stake is $", dollars, sep='')
        else:
            print("You lost your bet! $", stake, sep='')
            dollars=dollarswon+dollars
        rounds+=1
    if rounds==10:
        print("*******Singles", single, "Doubles", double, "Triples", triple, "Misses", misses)
        answer=input("Want to play some more? (y or n)")
        if answer=="y":
            main()
        else:
            print("Have a good day")

main() 
```

任何帮助表示赞赏。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T03:41:27.667

近似的错误是`eval()`需要一个有效的 python 语法的表达式；
`"Enter the number you want to bet on -->"`或此程序中的任何其他字符串都不是有效的 Python 表达式，因此在运行时会产生语法错误。

该程序的更广泛的问题是，这`eval()`是不必要的，应该避免。

一个经验法则，特别是对于初学者来说，是**“eval() 是邪恶的”并且应该“从不”使用。**
请注意，“ *never* ”用引号引起来，以暗示确实有[非常]少数用例可以使 eval() 非常有用。
之所以`eval()`是这样一个“危险的盟友”，是因为它在运行时引入了 [通常是用户提供的] 任意 python 表达式，而且这种表达式很可能具有无效的语法（没什么大不了的）或更糟，可能包括相当有害甚至可能是恶意代码，当被调用时会在主机上执行各种坏事......

这就是说，**您根本不需要 eval() 来处理从 input() 方法获得的输入。**
我认为您可能打算使用以下模式：（
`myVar = eval(input("Enter some value for myVar variable"))`
即 eval 和输入以相反的顺序）
实际上这仍然不适用于 eval() 需要一个*字符串*参数，因此您需要
`myVar = eval(str(input("Enter some value for myVar variable")))`
但正如所说的 eval( ) 在这里没有保证。

另一个猜测是您使用`eval()`了，因为您希望 input() 的返回是字符串类型，并且 eval() 会将其转换为整数以用于程序逻辑......
`raw_input()`是返回字符串的方法，它当用户键入没有引号和其他无效值的文本时，您应该使用它来避免出现运行时错误。让用户输入整数值的常见习语是

```
int_in = None
while int_in == None:
   str_in = raw_input('some text telling which data is expected')
   try:
       int_in = int(str_in)
   except ValueError:
       # optional output of some message to user
       int_in = None 
```

通常我们将这种逻辑放在一个方法中以便于重用。

希望这可以帮助。你似乎在用 Python 做一些实际的事情：没有比编写代码更好的学习方法了 - 以及偶尔回顾文档和阅读相关书籍。一本好书的插件：[Alex Martelli 的 Python Cookbook](http://books.google.com/books?isbn=0596007973)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-26T04:59:22.337

首先，确保您使用的是 Python 3：

```
import sys
print(sys.version) 
```

它应该显示类似`3.2.1 (...)`

原因是 Python 2 和 Python 3 有一些重要的区别，特别是`input()`在 Python 3 中只会像你期望的那样运行（而在 Python 2 中你必须使用它`raw_input()`）

如果您正在学习一本书/教程，请确保您使用的是类似版本的 Python。

其次，在一些地方你颠倒了`input`and的顺序`eval`：

```
dice=input(eval("Enter the number you want to bet on --> ")) 
```

它应该是：

```
dice=eval(input("Enter the number you want to bet on --> ")) 
```

..因为`input(...)`返回一个类似的字符串`"123"`，那么你想`eval`用这个字符串调用。您当前的代码正在调用`eval("Enter the number..")`，这是不正确的。

也就是说，你几乎不需要使用`eval`它——使用它有很多问题，而且在 Python 中很少需要它。相反，由于您想获取包含数字的字符串，并将其转换为整数，请使用`int`：

```
dice=int(input("Enter the number you want to bet on --> ")) 
```

这不仅不太容易出现 的问题`eval`，而且当您输入无效值时，它会为您提供更好的错误消息

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-26T03:43:59.333

我对您的代码所做的更改：

*   移除`eval()`
*   修正了一个错字（数字而不是 numbet）
*   将`for roll in randrange(1,7): roll1=roll`块更改为`roll1=randrange(1,7)`
*   删除了`if rounds==10:`检查，因为它是 a) 没有必要和 b) 无效的，因为在最后一个循环之后回合将是 11
*   将 y/n 答案解析为字符串

* * *

```
from random import *

def dice1():
    print("+-----+")
    print("|     |")
    print("|  *  |")
    print("|     |")
    print("+-----+")

def dice2():
    print("+-----+")
    print("|*    |")
    print("|     |")
    print("|    *|")
    print("+-----+")

def dice3():
    print("+-----+")
    print("|*    |")
    print("|  *  |")
    print("|    *|")
    print("+-----+")

def dice4():
    print("+-----+")
    print("| * * |")
    print("|     |")
    print("| * * |")
    print("+-----+")

def dice5():
    print("+-----+")
    print("|*   *|")
    print("|  *  |")
    print("|*   *|")
    print("+-----+")

def dice6():
    print("+-----+")
    print("|*   *|")
    print("|*   *|")
    print("|*   *|")
    print("+-----+")

def drawdice(d):
    if d==1:
        dice1()
    elif d==2:
        dice2()
    elif d==3:
        dice3()
    elif d==4:
        dice4()
    elif d==5:
        dice5()
    elif d==6:
        dice6()
    print()

def inputdie():
    dice=input("Enter the number you want to bet on --> ")
    while dice<1 or dice>6:
        print("Sorry, that is not a good number.")
        dice=input("Try again. Enter the number you want to bet on --> ")
    return dice

def inputbet(s):
    bet=input("What is your bet?")
    while bet>s or bet<=0:
        if bet>s:
            print("Sorry, you can't bet more than you have")
            bet=input("What is your bet?")
        elif bet<=0:
            print("Sorry, you can't bet 0 or less than 0")
            bet=input("What is your bet?")
    return bet

def countmatches(numbet,r1,r2,r3):
    n=0
    if numbet==r1:
        n+=1
    if numbet==r2:
        n+=1
    if numbet==r3:
        n+=1
    return n

def payoff(c,betam):
    payoff=0
    if c==1:
        print("a match")
        payoff=betam
    elif c==2:
        print("a double match!")
        payoff=betam*5
    elif c==3:
        print("a triple match!")
        payoff=betam*10
    else:
        payoff=betam*(-1)
    return payoff

def main():
    dollars=1000
    rounds=1
    roll=0
    single=0
    double=0
    triple=0
    misses=0
    flag=True
    print("Play the game of Three Dice!!")
    print("You have", dollars, "dollars to bet with.")
    while dollars>0 and rounds<11 and flag==True:
        print("Round", rounds)
        dicebet=inputdie()
        stake=inputbet(dollars)
        roll1=randrange(1,7)
        roll2=randrange(1,7)
        roll3=randrange(1,7)
        drawdice(roll1)
        drawdice(roll2)
        drawdice(roll3)
        matches=countmatches(dicebet,roll1,roll2,roll3)
        dollarswon=payoff(matches,stake)
        if matches==1:
            single+=1
        elif matches==2:
            double+=1
        elif matches==3:
            triple+=1
        elif matches==0:
            misses+=1
        if dollarswon>0:
            print("You got a match!")
            print("You won $", dollarswon)
            dollars=dollars+dollarswon
            print("Your stake is $", dollars)
        else:
            print("You lost your bet! $", stake)
            dollars=dollarswon+dollars
        rounds+=1

    print("*******Singles", single, "Doubles", double, "Triples", triple, "Misses", misses)
    answer=str(input("Want to play some more? (y or n)"))
    if answer=="y":
        main()
    else:
        print("Have a good day")

main() 
```

# java - socket inputtread read()被阻塞了，但是线程在运行，怎么理解？

> ID：13080283
> 
> 赞同：0
> 
> 时间：2012-10-26T03:20:04.953
> 
> 标签：java, socket.io

socket inputtread read() 因没有收到数据而阻塞，但是线程正在运行，如何理解？

块的含义和与线程块状态的区别是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T03:26:44.480

好吧，如果线程在 read() 中被阻塞，则线程*不会*运行。你的意思是它是'RUNNABLE'吗？这只是意味着它不会在 Java 信号量中被阻塞，并且只要 read() 返回它就可以运行。它正在等待来自对等方的数据到达。

# matlab - 逻辑到 char

> ID：13080286
> 
> 赞同：2
> 
> 时间：2012-10-26T03:20:38.637
> 
> 标签：matlab

例如，我有一个表示二进制数的 char 数组

```
bit <1x8 char> '00110001' 
```

我想用逻辑值替换最后一个字符。触发以下错误：***无法从逻辑转换为 char。***

这是我的代码：

```
bit(end:end) = hiddenImg(i,j); 
```

我检查了 hiddenImg(i,j) 实际上是一个逻辑值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T03:38:20.210

这可能不是最佳的，但应该做你想做的（将逻辑转换为字符）：

```
>> bit = '10010100'

bit =

10010100

>> bit(end)=num2str(true)

bit =

10010101 
```

# android - Android 原生片段 vs roboguice 支持 v4 库片段

> ID：13080289
> 
> 赞同：0
> 
> 时间：2012-10-26T03:21:04.660
> 
> 标签：android, android-fragments, android-listfragment, roboguice, android-support-library

我有一个 XML 布局文件，它由一个 Activity 膨胀

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical"
>
<LinearLayout
      android:id="@+id/content2"
      android:background="@color/lighter_gray"
      android:layout_width="match_parent"
      android:orientation="horizontal"
      android:layout_height="match_parent" >

<fragment class="com.xyz.fragments.TabFragment"
          android:id="@+id/tabs"
  android:layout_weight="1"
  android:layout_width="0px"
  android:layout_height="match_parent"
  />
<FrameLayout
  android:id="@+id/fragment_holder"
  android:layout_weight="2"
  android:layout_width="0px"
  android:layout_height="match_parent" />

  </LinearLayout>
</RelativeLayout> 
```

Activity 是 FragmentActivity（来自 v4 库）的子类（不是直接的）。

现在，在 com.xyz.fragments.TabFragment 中，我有以下类声明

```
....
import android.support.v4.app.FragmentTransaction;
import roboguice.fragment.RoboListFragment;

public class TabFragment extends RoboListFragment {

.... 
.... 
```

运行时，应用程序崩溃，adb logcat 显示如下错误：

```
java.lang.RuntimeException: Unable to start activity     ComponentInfo{com.xyz/com.xyz.xxActivity}: android.view.InflateException: Binary XML file line #22: Error inflating class fragment 
```

所以第 22 行正是 xml 布局中的这一行

```
fragment class="com.xyz.fragments.TabFragment" 
```

它带有红色下划线......它说 TabFragment 不能分配给 android.app.fragment

好吧，我明白了，我正在使用来自支持库 v4 的 roboguice 的 FragmentList，与 android.app.fragment 不同

所以……我该怎么办？我假设这就是应用程序崩溃的原因。

下面的完整堆栈跟踪

0-25 20:59:54.535:INFO/ApplicationPolicy(1903):isApplicationInstallationEnabled:pkg com.xyz 10-25 20:59:55.455:INFO/PackageManager(1903):删除非系统包:com.xyz 10-25 20:59:55.455:INFO/ActivityManager(1903):强制停止包 com.xyz uid=10017 10-25 20:59:55.610:INFO/PackageManager(1903):ICS_DEBUG scanPackageLI 进入 com.xyz 10-25 20:59 ：55.610：INFO/PackageManager（1903）：ICS_DEBUG 检查 com.xyz 10-25 20:59:55.615：INFO/PackageManager（1903）：在 com.xyz 10-25 20:59:58.390 上运行 dexopt：INFO/ ActivityManager(1903): 强制停止包 com.xyz uid=10017 10-25 20:59:59.305: DEBUG/PackageManager(1903): 新包安装在 /data/app/com.xyz-2.apk 10-25 20 ：59：59.705：INFO / ActivityManager（1903）：强制停止包com.xyz uid = 10017 10-25 20：59：59.875：DEBUG / Launcher.LauncherModel（2152）：->包：com。xyz 10-25 21:00:00.050: INFO/SocialHub(6289): [UinboxReceiver] onReceive() >> intent.getData(): com.xyz 10-25 21:00:00.345: DEBUG/Launcher.LauncherModel(2152 ): --> 更新包 com.xyz 10-25 21:00:00.345: DEBUG/Launcher.LauncherModel(2152): --> 包:com.xyz 10-25 21:00:00.640: INFO/DebugDb(2152 ): 更新应用信息 -1 com.sec.android.app.twlauncher.ApplicationInfo xyz -1 4 15 75|-1|-1|-1|-1|0 com.sec.android.app.twlauncher.ApplicationInfo@ 421323f0 10-25 21:00:01.675：INFO/ActivityManager(1903)：从 PID 7524 10-25 21:00:01.775 开始 {flg=0x10000000 cmp=com.xyz/.TabActivity}：INFO/ActivityManager(1903)：为活动 com.xyz/.TabActivity 启动 proc com.xyz：pid=7536 uid=10017 gids={3003} java.lang.RuntimeException：无法启动活动 ComponentInfo{com.xyz/com.xyz.TabActivity}：android。视图.InflateException：二进制 XML 文件第 22 行：在 com.xyz.TabActivity.onCreate(TabActivity.java:25) 10-25 21:00:24.225：INFO/ActivityManager(1903)：处理 com.xyz (pid 7536) 时出错已经死了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T03:49:03.160

`name`不`class`这样使用：

```
<fragment android:name="com.cyz.fragments.TabFragment"
        android:id="@+id/fragment_tab"
        android:layout_weight="1"
        android:layout_width="0dp"
        android:layout_height="match_parent" /> 
```

确保片段附加到的活动扩展`RoboFragmentActivity`

确保覆盖片段中的 onCreateView

```
public static class ExampleFragment extends Fragment {
    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
                             Bundle savedInstanceState) {
        // Inflate the layout for this fragment
        return inflater.inflate(R.layout.example_fragment, container, false);
    }
} 
```

还要确保在尝试执行其他任何操作之前调用`super.onCreate(savedInstanceState);`Activity 。`onCreate()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T18:38:45.300

我不确定，但我在所有片段中都调用了超级类，这对我有用。

```
@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
    super.onCreateView(inflater, container, savedInstanceState);
    return inflater.inflate(R.layout.my_fragment, container, false);
} 
```

检查这是否有效。

# linux - grepping 数据 Apache access.log

> ID：13080294
> 
> 赞同：0
> 
> 时间：2012-10-26T03:22:07.933
> 
> 标签：linux, apache, bash

我想拥有 /var/log/apache2/access.log 的实时副本，以便我可以 grep、进行主机名解析等。

最好的方法是什么？

我很好奇正在经过什么样的交通

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T07:01:32.950

你可以：

1.  配置 apache 以通过 syslog 发送日志，而不是配置 syslog 以获取单独的日志文件（具有特定所有者）。看看：[O'Reilly：将 Apache httpd 日志发送到 Syslog](http://www.oreillynet.com/pub/a/sysadmin/2006/10/12/httpd-syslog.html)
2.  使用tail -f，但您必须确保以下命令没有缓冲才能立即读取事件

    `tail -f /var/log/apache2/access.log | grep --line-buffered "something"`或者

    `tail -f /var/log/apache2/access.log | sed -une "/something/p"`

3.  使用`tail -f | grep`perl 或 python（perl 是在日志文件中进行 grepping 的不错选择）。

（此示例是从 man perlfaq5 复制的：

```
for (;;) {
    for ($curpos = tell(GWFILE); <GWFILE>; $curpos = tell(GWFILE)) {
               # search for some stuff and put it into files
    }
    # sleep for a while
         seek(GWFILE, $curpos, 0);  # seek to where we had been
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T03:34:52.377

做这个：

```
#Customize as appropriate:
tail -f  /var/log/apache2/access.log | cut -f 0 -d ' ' &
tail -f  /var/log/apache2/access.log | grep foo & 
```

# jsf-2 - JFreeChart - 如何创建 BarRenderer 工具提示

> ID：13080295
> 
> 赞同：0
> 
> 时间：2012-10-26T03:22:07.980
> 
> 标签：jsf-2, jfreechart

BarRenderer Tooltip 是否与 jsf 一起使用？

```
 private JFreeChart createChart(CategoryDataset categorydataset) {
    JFreeChart jfreechart = ChartFactory.createStackedBarChart3D("Stacked Bar Chart 3D Demo 1", null, "Value", categorydataset, PlotOrientation.VERTICAL, true, true, false);
    CategoryPlot categoryplot = (CategoryPlot) jfreechart.getPlot();
    IntervalMarker intervalmarker = new IntervalMarker(5D, 10D, Color.gray, new BasicStroke(0.5F), Color.blue, new BasicStroke(0.5F), 0.5F);
    categoryplot.addRangeMarker(intervalmarker);
    BarRenderer barrenderer = (BarRenderer) categoryplot.getRenderer();
    barrenderer.setDrawBarOutline(false);
    barrenderer.setBaseItemLabelGenerator(new StandardCategoryItemLabelGenerator());
    barrenderer.setBaseItemLabelsVisible(true);
    barrenderer.setBasePositiveItemLabelPosition(new ItemLabelPosition(ItemLabelAnchor.CENTER, TextAnchor.CENTER));
    barrenderer.setBaseNegativeItemLabelPosition(new ItemLabelPosition(ItemLabelAnchor.CENTER, TextAnchor.CENTER));
    barrenderer.setBaseToolTipGenerator(new StandardCategoryToolTipGenerator(
            "Series {0}, Value {1}", NumberFormat.getInstance())); 
```

我看不到每个栏的工具提示

我是否遗漏了某些东西，或者它可能无法通过 jsf 工作？

谢谢

# php - 根据 BETWEEN 函数值将 INSERT 上的 DATETIME 值分配给 DB

> ID：13080296
> 
> 赞同：1
> 
> 时间：2012-10-26T03:22:22.350
> 
> 标签：php, mysql

我想，在向表 1 插入新记录时，根据另一个表的值为 DATETIME 分配一个值，但无法将它们放在一起。

TABLE1 具有 interval_id 和 submit_date 列（以及许多其他列）

TABLE2 有 interval_id、begin_time 和 end_time

例子：

*   日期时间为 2012-10-24 07:29:41 的 INSERT 语句
*   剥离时间
*   引用两个表中的 interval_id
*   查找 TIME 在 T2.begin_time 和 T2.end_time 之间的位置（在这种情况下为 06:00:00 和 07:59:59）
*   一旦确定，在 T1.interval_id 中为其分配相应的值

至今：

```
INSERT INTO `TABLE1` (null, now())
WHERE
  DATE(submit_date) = curdate()
  AND TIME(submit_date) 
```

----不确定在这里编码以将 TIME 与开始和结束时间列数据进行比较----

完整的插入语句：

```
 $sql        = "INSERT INTO `summary` VALUES (null,'$user_id','$task_id',NOW(),'$tcompleted_id','$minutes_id','$hourinterval_id')
                   SELECT NOW(), hourinterval_id 
                   FROM `hour_interval` H
                   WHERE TIME(NOW()) BETWEEN H.start_hour AND H.end_hour LIMIT 1" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T03:28:29.713

您可以插入`SELECT`语句的结果：

```
INSERT INTO `TABLE1`(curdate, interval_id)
SELECT now(), inteval_id FROM `TABLE2` t2 
WHERE TIME(now()) BETWEEN t2.start_time AND t2.end_time LIMIT 1 
```

# c# - Windows 8 - 启动地图应用程序

> ID：13080297
> 
> 赞同：1
> 
> 时间：2012-10-26T03:22:22.500
> 
> 标签：c#, .net, windows-8, microsoft-metro, windows-runtime

我们正在开发基于 C# Xaml 的 Windows 应用商店应用程序。

我们在应用程序中集成了必应地图，但我们想知道是否可以将“地图”应用程序启动到某个地址？

我们不想实现完整的方向，所以最好只提供一个按钮来启动地图，这样他们就可以从那里完成。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T03:54:06.677

结合[LaunchUriAsync](http://msdn.microsoft.com/en-us/library/windows/apps/windows.system.launcher.launchuriasync.aspx)查看地图应用程序的[URI 方案](http://msdn.microsoft.com/en-us/library/windows/apps/jj635237.aspx)，我认为它应该可以解决问题。

# cocos2d-iphone - 在 cocos2d 中将孩子转换为屏幕空间

> ID：13080298
> 
> 赞同：0
> 
> 时间：2012-10-26T03:22:30.070
> 
> 标签：cocos2d-iphone

目前我有 2 张图片，ImageA 和 ImageB。ImageB 是 ImageA 的孩子

假设 ImageA 位置在 (100, 100)；那么ImageB的局部位置是(10, 0)；

所以我想要做的是如何检索 ImageB 的屏幕位置，它会返回 (110, 100) 而不是 (10, 0)？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T04:41:37.443

您可以使用此 API 获取精灵的世界位置。

```
 CGPoint loc =[self convertToWorldSpace:sprite.position]; 
```

# python - 无法从 NLTK 库导入 Bigrams

> ID：13080301
> 
> 赞同：3
> 
> 时间：2012-10-26T03:22:37.793
> 
> 标签：python, nltk

让我困惑的快速问题。我已经安装了 NLTK，它一直运行良好。但是，我正在尝试获取语料库的二元组并希望基本上使用二元组（语料库）。但是它说当我“从 nltk 导入二元组”时未定义二元组

与三元组相同。我错过了什么吗？另外，我如何手动从语料库中获取二元组。

我也在寻找计算二元三元组和四元组的频率，但我不确定如何去做。

我将语料库在开头和结尾适当地标记为`"<s>"`and 。`"</s>"`到目前为止的程序：

```
 #!/usr/bin/env python
import re
import nltk
import nltk.corpus as corpus
import tokenize
from nltk.corpus import brown

def alter_list(row):
    if row[-1] == '.':
        row[-1] = '</s>'
    else:
        row.append('</s>')
    return ['<s>'] + row

news = corpus.brown.sents(categories = 'editorial')
print len(news),'\n'

x = len(news)
for row in news[:x]:
    print(alter_list(row)) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-26T03:54:52.403

我在 virtualenv 中对此进行了测试，它可以工作：

```
In [20]: from nltk import bigrams

In [21]: bigrams('This is a test')
Out[21]: 
[('T', 'h'),
 ('h', 'i'),
 ('i', 's'),
 ('s', ' '),
 (' ', 'i'),
 ('i', 's'),
 ('s', ' '),
 (' ', 'a'),
 ('a', ' '),
 (' ', 't'),
 ('t', 'e'),
 ('e', 's'),
 ('s', 't')] 
```

这是你得到的唯一错误吗？

顺便说一句，关于你的第二个问题：

```
from collections import Counter
In [44]: b = bigrams('This is a test')

In [45]: Counter(b)
Out[45]: Counter({('i', 's'): 2, ('s', ' '): 2, ('a', ' '): 1, (' ', 't'): 1, ('e', 's'): 1, ('h', 'i'): 1, ('t', 'e'): 1, ('T', 'h'): 1, (' ', 'i'): 1, (' ', 'a'): 1, ('s', 't'): 1}) 
```

对于单词：

```
In [49]: b = bigrams("This is a test".split(' '))

In [50]: b
Out[50]: [('This', 'is'), ('is', 'a'), ('a', 'test')]

In [51]: Counter(b)
Out[51]: Counter({('is', 'a'): 1, ('a', 'test'): 1, ('This', 'is'): 1}) 
```

这种按词分割显然是非常肤浅的，但根据您的应用程序，它可能就足够了。显然，您可以使用更加复杂的 nltk 标记化。

为了实现您的最终目标，您可以执行以下操作：

```
In [56]: d = "Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum."

In [56]: from nltk import trigrams
In [57]: tri = trigrams(d.split(' '))

In [60]: counter = Counter(tri)

In [61]: import random

In [62]: random.sample(counter, 5)
Out[62]: 
[('Ipsum', 'has', 'been'),
 ('industry.', 'Lorem', 'Ipsum'),
 ('Ipsum', 'passages,', 'and'),
 ('was', 'popularised', 'in'),
 ('galley', 'of', 'type')] 
```

我修剪了输出，因为它不必要地大，但你明白了。

# optimization - 加快 emacs 中的字符串匹配

> ID：13080303
> 
> 赞同：2
> 
> 时间：2012-10-26T03:22:46.110
> 
> 标签：optimization, elisp

我想在 emacs中实现[vim commandT 插件。](https://wincent.com/products/command-t)这段代码主要是从[matcher](https://github.com/wincent/Command-T/blob/master/ruby/command-t/match.c)翻译过来的。

我这里有一些 elisp 仍然太慢，无法在我的上网本上使用 - 我怎样才能加快速度？

```
(eval-when-compile (require 'cl))
(defun commandT-fuzzy-match (choices search-string)
  (sort (loop for choice in choices
              for score = (commandT-fuzzy-score choice search-string (commandT-max-score-per-char choice search-string))
              if (> score 0.0) collect (list score choice))
        #'(lambda (a b) (> (first a) (first b)))
        ))

(defun* commandT-fuzzy-score (choice search-string &optional (score-per-char (commandT-max-score-per-char choice search-string)) (choice-pointer 0) (last-found nil))
  (condition-case error
      (loop for search-char across search-string
            sum (loop until (char-equal search-char (elt choice choice-pointer))
                      do (incf choice-pointer)
                      finally return (let ((factor (cond (last-found (* 0.75 (/ 1.0 (- choice-pointer last-found))))
                                                         (t 1.0))))
                                       (setq last-found choice-pointer)
                                       (max (commandT-fuzzy-score choice search-string score-per-char (1+ choice-pointer) last-found)
                                            (* factor score-per-char)))))
    (args-out-of-range 0.0)   ; end of string hit without match found.
    ))

(defun commandT-max-score-per-char (choice search-string)
  (/ (+ (/ 1.0 (length choice)) (/ 1.0 (length search-string))) 2)) 
```

一定要编译那部分，因为这已经很有帮助了。和一个基准：

```
(let ((choices (split-string (shell-command-to-string "curl http://sprunge.us/FcEL") "\n")))
  (benchmark-run-compiled 10
      (commandT-fuzzy-match choices "az"))) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T15:01:24.907

以下是您可以尝试的一些微优化：

*   使用`car-less-than-car`而不是您的 lambda 表达式。这没有明显的效果，因为时间不是花在 中`sort`而是在 中`commandT-fuzzy-score`。
*   使用`defun`而不是`defun*`：那些具有非零默认值的可选参数具有不可忽略的隐藏成本。这将 GC 成本降低了近一半（您开始时花费了 10% 以上的 GC 时间）。
*   (* 0.75 (/ 1.0 XXX)) 等于 (/ 0.75 XXX)。
*   使用`eq`而不是`char-equal`（这会将行为更改为始终区分大小写，tho）。这产生了相当大的差异。
*   使用`aref`而不是`elt`.
*   我不明白你为什么要传递`last-found`你的递归调用，所以我显然不完全理解你的算法在做什么。但是假设这是一个错误，您可以将其转换为局部变量，而不是将其作为参数传递。这可以节省您的时间。
*   我不明白为什么你对`search-char`你找到的每一个都进行递归调用，而不仅仅是第一个。另一种看待这个问题的方法是，您`max`将“单字符分数”与“整个搜索字符串分数”进行比较，这似乎很奇怪。如果您将代码更改为使用递归调用 on`max`执行两个 s 的外部，那么在我的测试用例中它会加快 4 倍。`loop``(1+ first-found)`
*   乘法`score-per-char`可以移到循环之外（对于您的原始算法，这似乎不是真的）。

此外，在 Emacs 中实现的 Elisp 非常慢，因此您通常最好使用“大原语”，以便花更少的时间解释 Elisp（字节）代码，并花更多时间运行 C 代码。例如，这是一种替代实现（不是您的原始算法，而是我在移动`max`循环外部后得到的那个），使用正则表达式模式处理来执行内部循环：

```
(defun commandT-fuzzy-match-re (choices search-string)
  (let ((search-re (regexp-quote (substring search-string 0 1)))
        (i 1))
    (while (< i (length search-string))
      (setq search-re (concat search-re
                              (let ((c (aref search-string i)))
                                (format "[^%c]*\\(%s\\)"
                                        c (regexp-quote (string c))))))
      (setq i (1+ i)))

    (sort
     (delq nil
           (mapcar (lambda (choice)
                     (let ((start 0)
                           (best 0.0))
                       (while (string-match search-re choice start)
                         (let ((last-found (match-beginning 0)))
                           (setq start (1+ last-found))
                           (let ((score 1.0)
                                 (i 1)
                                 (choice-pointer nil))
                             (while (setq choice-pointer (match-beginning i))
                               (setq i (1+ i))
                               (setq score (+ score (/ 0.75 (- choice-pointer last-found))))
                               (setq last-found choice-pointer))
                             (setq best (max best score)))))
                       (when (> best 0.0)
                         (list (* (commandT-max-score-per-char
                                   choice search-string)
                                  best)
                               choice))))
                   choices))
     #'car-less-than-car))) 
```

# c# - 如何在 ASP.Net global.asax 中同步写入文件？

> ID：13080309
> 
> 赞同：1
> 
> 时间：2012-10-26T03:23:43.147
> 
> 标签：c#, asp.net, file-io

我正在通过下面的代码写入一个为一年中的每个日期创建的文件。每当 ASP.Net 应用程序中发生未处理的异常时，此代码就会运行。我的问题是当许多用户使用该网站时，由于同时发生多个错误，此代码可能会被命中，**这可能导致创建或写入同一文件的多个请求。**在这种情况下，只有一个请求执行与写入文件相关的代码，解决方案是什么？

```
 private void Application_Error(object sender, EventArgs e) 
{ 
    // Code that runs when an unhandled error occurs
    string errorGuid    = Guid.NewGuid().ToString("D");
    if (HttpContext.Current.Server.GetLastError() != null)
    {
        Exception err = HttpContext.Current.Server.GetLastError();
        string header = String.Format("/*****\t\t{0}:{1}\t\t*****/", "Start", errorGuid);
        string footer = String.Format("/*****\t\t{0}:{1}\t\t*****/", "End", errorGuid);
        string errorText = String.Format("{0}{5}Exception DateTime: {1}{5}Reference #: {2}{5}Exception:{5}=========={5}{3}{5}{4}{5}", header, System.DateTime.Now, errorGuid, err.ToString(), footer, Environment.NewLine);

        // '~/ErrorReports/Logs/ErrorLog.log' must exist, else we will get an error 

        using (System.IO.TextWriter write = new System.IO.StreamWriter(HttpContext.Current.Server.MapPath("~/ErrorReports/Logs/ErrorLog_" + DateTime.Now.ToShortDateString() + ".log"), true, System.Text.Encoding.UTF8))
        {
            write.WriteLine(errorText);
            write.Close();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T03:41:40.217

1 - 您可以使用单例模式并创建一个类来处理此文件创建/附加或

2 - 使用“锁定”

3 - 按照建议，使用 elmah

# android - Android：在调用下一个弹出窗口时关闭一个弹出窗口？

> ID：13080311
> 
> 赞同：0
> 
> 时间：2012-10-26T03:25:00.020
> 
> 标签：android

我有 3 个图像按钮，按下它们每个都会打开一个弹出窗口。问题是当我单击按钮 1 时，会出现一个弹出窗口，如果我不关闭该弹出窗口而是单击按钮 2，则会出现按钮 1 和按钮 2 的弹出窗口。按下新按钮时如何关闭任何打开的弹出窗口？

这是我的代码

```
final ImageButton rredButton=(ImageButton)findViewById(R.id.RredButton);
    rredButton.setOnClickListener(new View.OnClickListener() {

        public void onClick(View arg0) {
            LayoutInflater layoutInflater
            = (LayoutInflater)getBaseContext()      
            .getSystemService(LAYOUT_INFLATER_SERVICE);
            View popupView = layoutInflater.inflate(R.layout.popupright, null);
            final PopupWindow popupWindow = new PopupWindow(               
                    popupView,                
                    LayoutParams.WRAP_CONTENT,                       
                    LayoutParams.WRAP_CONTENT);     
            Button btnNxtScr = (Button)popupView.findViewById(R.id.nextscreen);             
            btnNxtScr.setOnClickListener(new Button.OnClickListener(){     
                @Override     
                public void onClick(View v) {      
                    Intent myintent1 = new Intent(colorActivity.this,colorBlueActivity.class);
                    startActivity(myintent1);
                }
            });
                    popupWindow.showAsDropDown(rredButton, 1, -1);
        }}); 
```

这是另一个按钮（使用类似的弹出方法）

```
final ImageButton ryellowButton=(ImageButton)findViewById(R.id.RyellowButton);
    ryellowButton.setOnClickListener(new View.OnClickListener() {
        @Override     
        public void onClick(View arg0) {          
            createWrongPop(arg0);      
            }}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T04:37:09.357

为此，您需要在显示弹出窗口时在类中保存对 PopupWindow 的引用，并在弹出窗口消失时将其清除。然后，如果您单击第二个按钮，您可以检查弹出窗口是否可用，如果是，则在其上调用 .dismiss() 并创建一个新按钮，或修改其内容。

# android - 如何在 android 中对 JSON 对象键进行排序/排列？

> ID：13080314
> 
> 赞同：7
> 
> 时间：2012-10-26T03:25:45.730
> 
> 标签：android, json, sorting

> **可能重复：**
> [按键排序 JavaScript 对象](https://stackoverflow.com/questions/5467129/sort-javascript-object-by-key)

我正在从 android 中的 JSONObject 创建 JSONArray。我想成为的 JSONArray 是： **[{"last_name":"cruz", "first_name":"juan", "middle_name":"sam"}]**

但它似乎 **[{"first_name":"cruz", "last_name":"juan", "middle_name":"sam"}]**

如何按照我想要的顺序排列阵列？

谢谢...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-26T06:02:17.317

```
1\. prepare a LinkedHashMap object with elements

2\. convert it to JSONObject 
```

**例子：**

```
Map obj = new LinkedHashMap();
obj.put("a", "String1");
obj.put("b", new Integer(1));
obj.put("c", new Boolean(true));
obj.put("d", "String2");
JSONObject json = new JSONObject(obj); 
```

下载这个库：

[https://github.com/douglascrockford/JSON-java](https://github.com/douglascrockford/JSON-java)

将所有文件保存在项目的新包中

而不是使用**org.json.JSONObject**使用您从下载的库中添加的**your.package.JSONObject 。**

现在打开**JSONObject.java**文件并在构造函数中将**HashMap()**更改为**LinkedHashMap()**

```
public JSONObject(Map map) 
```

这将使 JSONObject 按照您使用 put 输入值的顺序存储数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T05:03:41.530

您无法维护`JSONObject`响应的顺序，因为它本身在文档中被提及。

对象是一组无序的名称/值对。

我遇到了同样的问题，然后我需要使用 gson 库或通过你的逻辑制作 json ..

```
An object is an unordered set of name/value pairs. 
```

祝你好运。！

# ios - ios 释放通过 calloc 分配的二维内存的正确方法

> ID：13080318
> 
> 赞同：1
> 
> 时间：2012-10-26T03:26:30.463
> 
> 标签：ios, c, free, calloc

我有一个 iOS 应用程序。我分配 2d 内存，然后使用 free 函数解除分配。这是正确的释放方式吗？最近我遇到了指向自由声明的崩溃。我应该在循环中释放 buf[i] 吗？

```
+(int**) initArr:(int) Nr:( int) Nc 
{
int ** buf;
  buf = calloc(Nr,sizeof(int*));

for(int i = 0; i < Nr; i++)
{
    buf[i] = calloc(Nc,sizeof(int));

}
//Funny Processing 

//Release
for(int i = 0; i < Nr; i++)
    free(buf[i]);
free(buf);
} 
```

这是错误消息

```
2 libsystem_c.dylib 0x328b87ec _sigtramp + 48
3 libsystem_c.dylib 0x328ae20e pthread_kill + 54
4 libsystem_c.dylib 0x328a729e abort + 94
5 libsystem_c.dylib 0x32862380 free + 380
6 MyApp 0x0009be52 +[clsGlobalHelper resizeImageAvg:::] (clsGlobalHelper.m:300) 
```

# php - 处理独立于客户端的用户日志输入

> ID：13080320
> 
> 赞同：0
> 
> 时间：2012-10-26T03:26:41.673
> 
> 标签：php, javascript, jquery, session, login

假设有一个网页只能通过在单独的页面上输入用户名和密码来访问。该网页除了其正常功能外，还应跟踪用户登录的时间和用户注销的时间。

我目前使用的系统是 JavaScript 解决方案。使用提交按钮上的成功单击事件记录登录的功能和注销按钮上的注销功能。

这里显然有一些问题。如果用户关闭浏览器怎么办？该注销不会被记录。如果用户失去互联网连接怎么办？等等等等。我可以想到一些客户端处理程序可能出错的用例场景。我需要一些受保护的东西，一些服务器端的东西。**你们推荐什么方法来完成上述任务而没有客户端的缺陷？是否存在可行的客户端方法？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T04:32:44.587

使用 websocket 解决方案，当新用户连接或断开连接时，您可能会在服务器端注意到。这种解决方案的唯一“缺点”是，如果用户转到另一个页面（即使在同一个域中），那么就像用户断开连接一样。然后，如果在新页面中使用相同的 websocket 解决方案来跟踪用户登录，它将“重新连接”。

您可以通过“类似 ajax”的导航来避免这种情况，这样用户就不会离开一个页面。

有一些很酷的 API 可以实现 websocket，比如 Pusher。

[这是推送器的链接](http://pusher.com/)

# c++ - LLVM 下的非 ASCII wchar_t 文字

> ID：13080325
> 
> 赞同：1
> 
> 时间：2012-10-26T03:27:22.657
> 
> 标签：c++, ios, xcode4, llvm, wchar-t

我已将 Xcode iOS 项目从 Xcode 3.2.6 迁移到 4.2。现在，当我尝试使用带有非 ASCII 字符的文字初始化 wchar_t 时，我收到了警告：

```
wchar_t c1;
if(c1 <= L'я') //That's Cyrillic "ya" 
```

消息是：

> MyFile.cpp:148:28：警告：字符 unicode 转义序列对其类型而言太长 [2] MyFile.cpp:148:28：警告：忽略宽字符常量中的无关字符 [2]

并且文字没有按预期工作 - 比较失败。

我正在使用 -fshort-wchar 进行编译，源文件是 UTF-8 格式。Xcode 编辑器可以正常显示文件。它在 GCC（包括 Xcode 3 在内的多种版本）上编译和工作，在 MSVC 上工作。有没有办法让 LLVM 编译器识别这些文字？如果没有，我可以回到 Xcode 4 中的 GCC 吗？

编辑：Snow Leopard 上的 Xcode 4.2 - 长篇大论。

EDIT2：确认了一个全新的项目。文件扩展名无关紧要 - .m 文件中的行为相同。-fshort-wchar 也不影响它。看起来我必须回到 GCC，直到我可以升级到修复此问题的 Xcode 版本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T03:44:57.077

不是答案，但希望是有用的信息——我无法用 clang 4.0 (Xcode 4.5.1) 重现问题：

```
$ uname -a
Darwin air 12.2.0 Darwin Kernel Version 12.2.0: Sat Aug 25 00:48:52 PDT 2012; root:xnu-2050.18.24~1/RELEASE_X86_64 x86_64
$ env | grep LANG
LANG=en_US.UTF-8
$ clang -v
Apple clang version 4.0 (tags/Apple/clang-421.0.60) (based on LLVM 3.1svn)
Target: x86_64-apple-darwin12.2.0
Thread model: posix
$ cat test.c
#include <stdio.h>
#include <stdlib.h>

int main(void)
{
    wchar_t c1 = 0;
    printf("sizeof(c1) == %lu\n", sizeof(c1));
    printf("sizeof(L'Я') == %lu\n", sizeof(L'Я'));
    if (c1 < L'Я') {
        printf("Я люблю часы Заря!\n");
    } else {
        printf("Что за....?\n");
    }
    return EXIT_SUCCESS;
}

$ clang -Wall -pedantic ./test.c 
$ ./a.out 
sizeof(c1) == 4
sizeof(L'Я') == 4
Я люблю часы Заря!
$ clang -Wall -pedantic ./test.c -fshort-wchar
$ ./a.out 
sizeof(c1) == 2
sizeof(L'Я') == 2
Я люблю часы Заря!
$ 
```

使用 clang++（其中`wchar_t`是内置类型）观察到相同的行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T03:36:57.653

对于您的具体问题，我没有答案，但想指出 llvm-gcc 已永久停产。根据我处理 Clang 和 llvm-gcc 以及 gcc 之间的 delta 的经验，Clang 在 C++ 规范方面通常是正确的，即使这种行为令人惊讶。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-26T04:27:05.433

如果实际上源是 UTF-8，那么这不是正确的行为。但是我无法在最新版本的 Xcode 中重现该行为

> MyFile.cpp:148:28：警告：字符 unicode 转义序列对其类型而言太长 [2]

这个错误应该是指一个“通用字符名称”（UCN），它看起来像“\U001012AB”或“\u0403”。它表示转义序列表示的值大于封闭的文字类型能够容纳的值。例如，如果代码点值需要超过 16 位，则 16 位 wchar_t 将无法保存该值。

> MyFile.cpp:148:28：警告：宽字符常量中的无关字符被忽略 [2]

这表明编译器认为在宽字符文字中表示的代码点不止一个。例如`L'ab'`。行为是实现定义的，clang 和 gcc 都只使用最后一个代码点值。

您显示的代码不应该触发其中任何一个，至少在clang中。第一个是因为这只适用于 UCN，更不用说 'я' 很容易适合单个 16 位 wchar_t 的事实；第二个是因为他的源代码编码总是被认为是 UTF-8，它会将 'я' 的 UTF-8 多字节表示视为单个代码点。

您可以重新检查并确保源实际上是 UTF-8。然后你应该检查你使用的是最新版本的 Xcode。您也可以尝试在项目设置中切换编译器 > Compile for C/C++/Objective-C

# python - 将 Python (numpy) 中的小图像大小精确地调整为原始大小的倍数

> ID：13080327
> 
> 赞同：2
> 
> 时间：2012-10-26T03:27:27.123
> 
> 标签：python, numpy, scipy

> **可能重复：**
> [如何沿两个轴重复](https://stackoverflow.com/questions/7656665/how-to-repeat-along-two-axis)

假设我们有以下矩阵/图像：

```
x = array([[1, 0, 1],
           [0, 1, 0],
           [1, 0, 1]]) 
```

我想要的是一个 9x9 矩阵，它是上面的 3 倍放大版本，左上角有 3x3 个，中间顶部有 3x3 个 0，等等。

我已经尝试过的事情是：

**scipy.ndimage.interpolation.zoom** (x, 3, order=(anything))，例如 order=0 返回：

```
array([[1, 1, 0, 0, 0, 0, 1, 1, 1],
       [1, 1, 0, 0, 0, 0, 1, 1, 1],
       [0, 0, 1, 1, 1, 1, 0, 0, 0],
       [0, 0, 1, 1, 1, 1, 0, 0, 0],
       [0, 0, 1, 1, 1, 1, 0, 0, 0],
       [0, 0, 1, 1, 1, 1, 0, 0, 0],
       [1, 1, 0, 0, 0, 0, 1, 1, 1],
       [1, 1, 0, 0, 0, 0, 1, 1, 1],
       [1, 1, 0, 0, 0, 0, 1, 1, 1]]) 
```

**scipy.misc.imresize** (x, (9,9), interp="nearest") （实际上来自 PIL），它提出了不同的创意（但错误）解决方案。

同时，MATLAB imresize 完美解决了这个问题...

有任何想法吗？（注意：所有这些解决方案*都应该*有效，所以在提交之前，请尝试一下 :)）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-26T03:30:41.437

克罗内克产品：

```
numpy.kron(x,numpy.ones((3,3))) 
```

结果：

```
array([[ 1.,  1.,  1.,  0.,  0.,  0.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  0.,  0.,  0.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  0.,  0.,  0.,  1.,  1.,  1.],
       [ 0.,  0.,  0.,  1.,  1.,  1.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  1.,  1.,  1.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  1.,  1.,  1.,  0.,  0.,  0.],
       [ 1.,  1.,  1.,  0.,  0.,  0.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  0.,  0.,  0.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  0.,  0.,  0.,  1.,  1.,  1.]]) 
```

# android - 当带有surfaceView的Activity添加到TabActivity时，第一次激活tab时窗口会闪烁全屏黑屏

> ID：13080331
> 
> 赞同：2
> 
> 时间：2012-10-26T03:28:27.647
> 
> 标签：android, surfaceview, flicker, tabactivity

我有一个 TabActivity，它有两个选项卡。每个选项卡与一个 Intent 相关联。而第二个选项卡在布局中有一个 SurfaceView，为了解决这个问题，我只是放了一个 100dip 宽度和 100dip 高度的 SurfaceView Tag，什么都不做。当 TabActivity已经加载完毕，我按了第二个tab。然后全屏一闪一黑。</p>

更进一步，我写了一些代码让表面做一个canvas.drawColor(Color.red)；黑色的闪烁仍然发生。

有人可以帮忙吗？

这是我的代码。

# 选项卡活动

```
public class TestFlickerAcivity extends TabActivity {

  private TabHost tabHost;

  @Override
    public void onCreate(Bundle savedInstanceState) {
      super.onCreate(savedInstanceState);
      setContentView(R.layout.activity_test_flicker_acivity);
      tabHost = getTabHost();
      createTabs();
    }

  private void createTabs() {
    Intent tab1Intent = new Intent(this, Tab1Activity.class);
    tab1Intent.setFlags(Intent.FLAG_ACTIVITY_SINGLE_TOP);
    TabSpec tab1 = tabHost.newTabSpec("TAB1").setIndicator("tab1").setContent(tab1Intent);
    tabHost.addTab(tab1);

    Intent tab2Intent = new Intent(this, Tab2Activity.class);
    tab2Intent.setFlags(Intent.FLAG_ACTIVITY_SINGLE_TOP);
    TabSpec tab2 = tabHost.newTabSpec("TAB2").setIndicator("tab2").setContent(tab2Intent);
    tabHost.addTab(tab2);
  }
} 
```

# Tab2 布局

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
   xmlns:tools="http://schemas.android.com/tools" android:layout_width="match_parent"
   android:layout_height="match_parent">

    <SurfaceView android:layout_width="100dip" android:layout_height="100dip"
       android:id="@+id/tab2Surface" />

</RelativeLayout> 
```

# Tab2 活动：

```
public class Tab2Activity extends Activity implements Callback, Runnable {

  private boolean mIsRunning;
  private SurfaceHolder mHolder;

  @Override
    public void onCreate(Bundle savedInstanceState) {
      super.onCreate(savedInstanceState);
      setContentView(R.layout.activity_tab2);
      SurfaceView sv = (SurfaceView) findViewById(R.id.tab2Surface);
      sv.getHolder().addCallback(this);
    }

  @Override
    public boolean onCreateOptionsMenu(Menu menu) {
      getMenuInflater().inflate(R.menu.activity_tab2, menu);
      return true;
    }

  @Override
    public void surfaceChanged(SurfaceHolder arg0, int arg1, int arg2, int arg3) {

    }

  @Override
    public void surfaceCreated(SurfaceHolder holder) {
      mHolder = holder;
      Canvas canvas = mHolder.lockCanvas();
      canvas.drawColor(Color.RED);
      mHolder.unlockCanvasAndPost(canvas);
      Thread t = new Thread(this);
      mIsRunning = true;
      t.start();

    }

  @Override
    public void surfaceDestroyed(SurfaceHolder arg0) {
      mIsRunning = false;
    }

  @Override
    public void run() {
      while (mIsRunning) {
        Canvas canvas = mHolder.lockCanvas();
        canvas.drawColor(Color.RED);
        mHolder.unlockCanvasAndPost(canvas);
      }
    }
} 
```

# servicestack - ServiceStack.Data.SqlMapper.QueryMultiple 和 ServiceStack.Data.DynamicParameters 在哪里

> ID：13080333
> 
> 赞同：1
> 
> 时间：2012-10-26T03:28:31.207
> 
> 标签：servicestack

我最近升级了 ServiceStack 相关库（特别是 ServiceStack 2.9.25），在以前的版本中，我们有 ServiceStack.Data 命名空间，我们使用的是 ServiceStack.Data.DynamicParameter 类和 IDbConnection 扩展方法，例如 Execute 和 QueryMultiple。但是在最新版本中，我们没有这个命名空间，就像上面的类和方法一样。这些是否已移至其他地方以及要使用的任何替代类/方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T03:47:56.390

[SqlMapper / Dapper](https://github.com/ServiceStack/ServiceStack/blob/master/src/ServiceStack.Razor/Dapper/SqlMapper.cs)现在已移至项目`ServiceStack.Razor.Dapper`中的命名空间`ServiceStack.Razor`。

# regex - Postgres 正则表达式从路径获取子字符串

> ID：13080335
> 
> 赞同：3
> 
> 时间：2012-10-26T03:28:49.010
> 
> 标签：regex, postgresql

我需要从一个路径目录中获取一个子字符串，该路径目录由前面的 2 个数字组成，后面跟着一个“_”。字符串是这样的：

```
'P:\pgdfecol\71698384737978\INFENTECONTROL\2011_9_43\2011_9_46_43_29_10.ZIP' 
```

在这种情况下，我想在 46 之后获得 43。

路径按照下一条规则存储，在最后一个反斜杠之后：

```
'\TablesPK_twoCharactersClassification_twoCharactersDocumentType_anything.ZIP' 
```

我想得到分类。问题是表的主键可能不止一个字段，尽管我知道每种情况下 pk 中有多少字段。

我得到了这样的东西：

```
select substring(substring(substring('P:\pgdfecol\71698384737978\INFENTECONTROL\2011_9_43\2011_9_46_43_29_10.ZIP' from '([^\\]*(\.ZIP|zip))') from '([^_]*_){4}') from '[0-9]{2}') 
```

但我想要更简单的东西。

其他情况：

```
'P:\pgdfecol\71698384737978\INFENTECONTROL\2011_03_46\2011_03_46_46_48_.ZIP' 
```

（需要第二个46）

```
'P:\pgdfecol\71698384737978\INFCONTABLE\2009_05_INBP\2009_05_INBP_22_28_.ZIP' 
```

（需要INBP后的22）

```
'P:\pgdfecol\71698384737978\INFOFICIAL\2007_06_MB\2007_06_MB_29_28_.ZIP' 
```

（需要29）

```
'P:\pgdfecol\71698384737978\ASOCIADOS\8010625\8010625_02_04_20110111.ZIP' 
```

（02 后 8010625）

在最后一种情况下，pk只有一个字段，所以我把这句话改成了：

```
select substring(substring(substring('P:\pgdfecol\71698384737978\ASOCIADOS\8010625\8010625_02_04_20110111.ZIP' from '([^\\]*(\.ZIP|zip))') from '([^_]*_){2}') from '[0-9]{2}') 
```

对于一个 Pk，我需要第二组`([^_]*_)`，对于三个第四组，依此类推..

```
select substring(substring(substring('P:\pgdfecol\71698384737978\ACTASCOMITE\ACRE123\ACRE123_17_11_.ZIP' from '([^\\]*(\.ZIP|zip))') from '([^_]*_){2}') from '[0-9]{2}') 
```

（我得到 17 个）

我正在使用 postgres 9.0。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T03:50:08.057

我开始明白了。考虑这个测试用例：

```
WITH x(txt) AS ( VALUES
     ('P:\pgdfecol\71698384737978\INFENTECONTROL\2011_9_43\2011_9_46_43_29_10.ZIP')  -- 43
    ,('P:\pgdfecol\71698384737978\INFENTECONTROL\2011_03_46\2011_03_46_46_48_.ZIP')  --need the second 46
    ,('P:\pgdfecol\71698384737978\INFCONTABLE\2009_05_INBP\2009_05_INBP_22_28_.ZIP') --need the 22 after INBP
    ,('P:\pgdfecol\71698384737978\INFOFICIAL\2007_06_MB\2007_06_MB_29_28_.ZIP')      --need the 29
    )
SELECT txt, substring(txt, '\\(?:[^_\\]+_){3}(\d\d)_[^\\]*\.(?:ZIP|zip)$')
FROM   x 
```

`(?:)`.. 非捕获括号.. 具有除and
`[^_\\]`之外的任何字符的字符类.. 一个数字，有效地与 [0-9] 相同.. 1 个或多个匹配项（贪婪）.. 字符串结尾.. 具有数字和的字符类`\``_`
`\d`
`+`
`$`
`[_\d]``_`

只有一个 pk 的情况需要不同的模式。使用`{1}`而不是`{3}`.

不知道为什么要逃避反斜杠。在现代版本的 PostgreSQL[`standard_conforming_strings`](http://www.postgresql.org/docs/current/interactive/runtime-config-compatible.html)中是`on`默认的，所以你不需要在字符串中转义反斜杠 - 但当然仍然是正则表达式。

# java - 如何在 asp.net 响应中包含 java 页面？

> ID：13080338
> 
> 赞同：2
> 
> 时间：2012-10-26T03:29:33.730
> 
> 标签：java, .net, architecture

我正在将 asp.net webapp 用于业务应用程序。我需要解决一个需要这个 webapp 的新要求

1.  与第三方 java webapp 共享用户上下文。
2.  将 java webapp 页面响应作为 .net 应用响应的一部分。

我如何实现这一目标？我不能在我的 .net 响应中使用 iframe，因为如果我这样做了，用户的浏览器将不得不发送对 java webapp 的请求 - 它必须是服务器端包含/转发。在这一点上我能想到的唯一解决方案是在服务器端打开到 java webapp 的 url 连接并将数据发布到它，但我不喜欢这个解决方案是它不是很可扩展。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T03:59:49.333

如果您有一个 java 应用程序（打包在 jar 中），您可以使用[IKVM](http://www.ikvm.net) 将其转换为可在 .NET web 或 windows 应用程序中使用的 .NET dll 或 exe。

Java 文件通过 javac.exe 编译并通过 java.exe 运行，现在为了调用这两个 exe，您需要使用 System.Diagnostics.Process 类并将 java 文件（给 javac.exe 进行编译）或类文件（到 java.exe 来运行应用程序）作为 Process 类的参数

[http://www.csharp-station.com/HowTo/ProcessStart.aspx](http://www.csharp-station.com/HowTo/ProcessStart.aspx)

[http://msdn.microsoft.com/en-us/library/system.diagnostics.process.aspx](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.aspx)

浏览 IKVM 网站上的给定[教程](http://www.ikvm.net/userguide/tutorial.html)。

另请参阅此[Java.NET：Java 和 .NET 的集成](http://www.codeproject.com/Articles/26144/Java-NET-Integration-of-Java-and-NET)

# ruby-on-rails - 相关模型的表格未显示

> ID：13080339
> 
> 赞同：0
> 
> 时间：2012-10-26T03:29:57.550
> 
> 标签：ruby-on-rails

我正在尝试为相关模型显示一个表单，但是当我在浏览器中查看页面时它没有显示。**如何在我的 fields_for 中显示 url 字段？**

这是我的代码：

**用户模型：**

```
class UsersController < ApplicationController
  def new
    @user = User.new
    @user.websites.build
  end

  def create
    @user = User.new(params[:user])
    if @user.save
      redirect_to root_url, :notice => "Signed up!"
    else
      render "new"
    end
  end
end 
```

**网站型号：**

```
class Website < ActiveRecord::Base
  belongs_to :user
end 
```

**用户视图：**

```
<h1>Sign Up</h1>

<%= form_for @user do |f| %>
    <% if @user.errors.any? %>
...
    <% end %>
    <p>
      <%= f.label :email %><br/>
      <%= f.text_field :email %>
    </p>
    <p>
      <%= f.label :password %><br/>
      <%= f.password_field :password %>
    </p>
    <p>
      <%= f.label :password_confirmation %><br/>
      <%= f.password_field :password_confirmation %>
    </p>
    <% f.fields_for :websites do |builder| %>
        <%= builder.label :url %><br/>
        <%= builder.text_field :url %>
    <% end %>

    <p class="button"><%= f.submit %></p>
<% end %> 
```

**最终输出：**

![最终输出](../Images/29144c4ef664feb58457b2fa68d5c869.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T03:55:40.893

您错过了 erb 标签中的等号。

```
<% f.fields_for :websites do |builder| %> 
```

.. 应该 ..

```
<%= f.fields_for :websites do |builder| %> 
```

这能解决吗？

看起来您也可能混淆了单数和复数`fields_for`。用复数调用它`websites`然后将块视为单数网站是没有意义的。

# actionscript-3 - 第一次加载应用程序时，如何避免在flex中执行控件的onchange函数？

> ID：13080340
> 
> 赞同：0
> 
> 时间：2012-10-26T03:29:59.877
> 
> 标签：actionscript-3, apache-flex

我的 flex 应用程序中有一个组合框控件：

```
<mx:ComboBox id="ispList" width="230" borderColor="#000000"
             change="queryHandlerMaster(event)" color="#000000"> 
```

我观察到`queryHandlerMaster`刚加载应用程序时会不必要地调用它。
如何避免这个电话？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T22:52:55.997

有几种可能性

1.  不要在 Flex 中添加监听器。向父组件/应用程序添加“addToStage”侦听器，并在该处理程序中，使用 AS3 添加您的事件
2.  创建一个名为“initLoad”的全局布尔值并将其设置为 true。当您进入处理程序时，您会检查 initLoad。如果为真，则将其设置为假。如果为 false，则运行处理程序代码。如果有多个处理程序需要停止，这显然不起作用

也就是说，不应在 App init 上触发 onChange。我的猜测是您在应用程序初始化后不久修改 ComboBox，并且由于程序运行速度如此之快，您认为它发生在应用程序初始化时。

# c# - 意外的 DTD 声明错误

> ID：13080342
> 
> 赞同：2
> 
> 时间：2012-10-26T03:30:17.280
> 
> 标签：c#, asp.net, xml

XslCompiledTransform 有时会引发错误：“意外的 DTD 声明”。但大多数时候它工作。这是一段代码：

```
var writer = new XmlTextWriter(Response.OutputStream, Encoding.UTF8);
var xsl = new XslCompiledTransform();
xsl.Load(Server.MapPath("~/TestSite/OpenAccess/XmlToHtml.xsl"));
xsl.Transform(restfullUrl, writer); 
```

这是引发错误的第四行。

我正在做的是将一些 XML（由 restfullUrl 的休息服务提供服务）转换为 HTML。

打败我。有人注意到这里有什么奇怪的地方吗？有什么想法吗？

# qt - 在 QGridLayout 中放置小部件

> ID：13080343
> 
> 赞同：1
> 
> 时间：2012-10-26T03:30:23.360
> 
> 标签：qt, pyqt, grid-layout

我需要在不指定行和列索引的情况下创建`QWidget`( `QtoolButton`) 。`QgridLayout`它应该根据提到的行和列自动创建到布局中的下一个空单元格。

`QgridLayout`我在帮助中找不到任何方法。

我试过`.addWidget (self, QWidget w)`了，但它把所有的都添加`QWidget`到（0,0）的索引中，所有的按钮都相互重叠。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T09:17:50.147

假设您有`QGridLayout`4 行 3 列的 a，并且您想从上到下和从左到右自动向其添加按钮。如果您能够预测要添加的下一个按钮的位置，这很容易实现。在我们的例子中：

*   行 = 添加的按钮数 / 列数
*   列 = 添加的按钮数 % 列数

（其他类型的填充工作类似）。让我们把它放在代码中：

```
from PyQt4.QtGui import *

class MyMainWindow(QMainWindow):
    def __init__(self, parent=None):
        super(MyMainWindow, self).__init__(parent)
        self.central = QWidget(self)
        self.grid = QGridLayout(self.central)
        self.rows = 4
        self.cols = 3
        self.items = self.grid.count()
        while(self.items < (self.rows * self.cols)):
            self.addButton()
        self.setCentralWidget(self.central)

    def addButton(self):
        # the next free position depends on the number of added items
        row = self.items/self.cols
        col = self.items % self.cols
        # add the button to the next free position
        button = QPushButton("%s, %s" % (row, col))
        self.grid.addWidget(button, row, col)
        # update the number of items
        self.items = self.grid.count()

if __name__ == "__main__":
    import sys
    app = QApplication(sys.argv)
    ui = MyMainWindow()
    ui.show()
    sys.exit(app.exec_()) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T06:12:25.150

您可以通过自己计算行和列来处理“下一个空单元格”。例如，您可以根据需要子类 QGridLayout 来实现任何“下一个空单元格”算法：

```
class AutoGridLayout(QGridLayout):
    def __init__(self):
        QGridLayout.__init__(self)
        self.column = 0
        self.row = 0

    def addNextWidget(self, widget):
        self.addWidget(widget, self.row, self.column)
        self.column = self.column + 1   # Automatically advance to next column

# Setup main widget
app = QApplication(sys.argv)
mainWindow = QMainWindow()
centralWidget = QWidget()
mainWindow.setCentralWidget(centralWidget)

# Add widgets using the AutoGridLayout
layout = AutoGridLayout()
centralWidget.setLayout(layout)
layout.addNextWidget(QPushButton("1", centralWidget))
layout.addNextWidget(QPushButton("2", centralWidget))
layout.addNextWidget(QPushButton("3", centralWidget))

# Show and run the application
mainWindow.show()
app.exec_() 
```

此来源仅显示一般概念 - 您可以根据需要管理行和列索引。只需在 addNextWidget() 方法中通过计算下一个所需的行/列来实现必要的逻辑（在此示例中，使用第 0 行中的下一列）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-26T10:14:13.097

除了其他答案：如果您只需要具有可变数量的项目的行，而不是实际的*grid*，那么您应该使用嵌套在一个 QVBoxLayout 中的多个 QHBoxLayouts（每行一个）。这也将为您提供您想要的行为，按需创建新项目，没有令人讨厌的差距。

# html - 删除中心标签上的样式

> ID：13080344
> 
> 赞同：0
> 
> 时间：2012-10-26T03:30:25.180
> 
> 标签：html

我正在使用输出以下语法的系统（我无法更改）

```
<body>
  <div class="page">
    <center>
      [The page contents]
    </center>
  </div>
</body> 
```

我想取消`<center>`元素上的格式，因为它弄乱了我的响应式布局。任何想法如何取消该元素的样式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T03:46:40.180

使用 jQuery 重写事后的内容怎么样？就像是：

```
$(".page").replaceWith($(".page center").contents()); 
```

在行动中看到它：http: [//jsfiddle.net/5fuBm/1/](http://jsfiddle.net/5fuBm/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T03:35:49.090

这完全取决于您需要做什么，但是您可以`center`像这样在元素上使用 css：

```
center {
    text-align: left;
} 
```

或者可能：

```
center {
    float: left;
} 
```

尝试一些不同的东西，看看什么效果最好。

# android - android ndk未定义对方法的引用

> ID：13080345
> 
> 赞同：3
> 
> 时间：2012-10-26T03:30:31.273
> 
> 标签：android, android-ndk, static-libraries, undefined-reference, android-ndk-r7

嗨对不起，我正在尝试编译一些静态类，即 jsmn.c、json.c 和 buf.c，它们是我从[https://github.com/alisdair/jsmn-example下载的 jsmn json 库的一部分/下载](https://github.com/alisdair/jsmn-example/downloads)。

我正在编译两个 STATIC_LIBRARIES lib1 和 json_library.lib1 具有依赖于 json_library 的本机代码。然后我将两个库制作成一个包含 **gnustl_static 和 lib1的共享库**

我的文件夹结构如下

**jni/lib1/ANdroid.mk**

```
include $(CLEAR_VARS)
LOCAL_MODULE := json_library
LOCAL_SRC_FILES := /3rdParty/jsmn/json_library.a
LOCAL_SRC_FILES := /3rdParty/jsmn/jsmn.c /3rdParty/jsmn/buf.c /3rdParty/jsmn/log.c /3rdParty/jsmn/json.c 
LOCAL_C_INCLUDES := /3rdParty/jsmn/jsmn.h /3rdParty/jsmn/buf.h /3rdParty/jsmn/log.h /3rdParty/jsmn/json.h 
# Optional compiler flags.
LOCAL_LDLIBS   = -lz -lm
LOCAL_CFLAGS   = -Wall -pedantic -std=c99 -g
include $(BUILD_STATIC_LIBRARY)

  include $(CLEAR_VARS)
  # Module Name
  LOCAL_MODULE    := lib1
  LOCAL_STATIC_LIBRARIES := json_library
  ........
  .......
  ......
  include $(BUILD_STATIC_LIBRARY) 
```

**jni/Android.mk**

```
# Here we give our module name
LOCAL_MODULE    := lib2
# list the static modules included here!!!
LOCAL_STATIC_LIBRARIES :=   gnustl_static  lib1 
....
include $(BUILD_SHARED_LIBRARY) 
```

**jni/应用程序.mk**

```
APP_MODULES   :=  lib2
# Optimization for release
APP_OPTM := release
#Targets
APP_ABI := armeabi-v7a armeabi 
```

所以在 lib1 我有一个类，它从名为 **json_tokenise的 json 库中调用一个方法**

```
#include <string.h>
#include <stdio.h>
 #include <stdlib.h>
 #include <jsmn/jsmn.h>
#include <jsmn/json.h>
#include <jsmn/buf.h>

jsmntok_t *tokens=json_tokenise((char *)data);

typedef enum {
START,
WRAPPER,
MESSAGE,
ROUTE,
OBJECT,
ARRAY,
SKIP,
STOP
}parse_state; 
```

我收到以下错误

```
undefined reference to `json_tokenise(char*)'
collect2: ld returned 1 exit status
make: *** [obj/local/armeabi-v7a/lib2.so] Error 1

**** Build Finished **** 
```

当我查看 [obj/local/armeabi-v7a/ 内部时，我可以看到 **libjson_library.a liblib1.a libgnustl_static.a**正在为 armabi-v7 生成，并且由于错误而无法生成 lib2。

请帮助或指导我哪里出错了我花了两天时间做这件事，我是 NDK 的新手。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-27T02:36:04.290

你应该修复你的`jni/lib1/Android.mk`文件：

```
LOCAL_PATH := $(call my-dir)
include $(CLEAR_VARS)
LOCAL_MODULE := json_library
LOCAL_SRC_FILES := 3rdParty/jsmn/jsmn.c 3rdParty/jsmn/buf.c 3rdParty/jsmn/log.c 3rdParty/jsmn/json.c 
LOCAL_C_INCLUDES := $(LOCAL_PATH)/3rdParty/jsmn
# Optional compiler flags.
LOCAL_LDLIBS   = -lz -lm
LOCAL_CFLAGS   = -Wall -pedantic -std=c99 -g
include $(BUILD_STATIC_LIBRARY) 
```

如果在此之后仍然有问题，请在命令行上`ndk-build`使用参数运行`V=1`并发布此构建的完整输出和所有`Android.mk`文件的完整内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-19T18:44:58.097

我遇到了类似的问题。`json_library.a`应该包含在预构建静态库模块中。这应该针对所需的平台进行编译。

```
include $(CLEAR_VARS)
LOCAL_MODULE := json_core
LOCAL_SRC_FILES := /3rdParty/jsmn/json_library.a
include $(PREBUILD_STATIC_LIBRARY)

include $(CLEAR_VARS)
LOCAL_MODULE := json_library
LOCAL_SRC_FILES := /3rdParty/jsmn/jsmn.c /3rdParty/jsmn/buf.c /3rdParty/jsmn/log.c /3rdParty/jsmn/json.c 
```

无需单独包含每个文件。

```
LOCAL_C_INCLUDES := /3rdParty/jsmn/ 
```

最后，需要指定`json_library`模块依赖于`json_core`(prebuilt library) 。

```
LOCAL_STATIC_LIBRARIES := json_core 
# Optional compiler flags.
LOCAL_LDLIBS   = -lz -lm
LOCAL_CFLAGS   = -Wall -pedantic -std=c99 -g
include $(BUILD_STATIC_LIBRARY) 
```

通过这种方式，链接器知道在哪里可以找到每个模块的所有方法定义。

# java - 如何在 Java 中使用不同的 ClassLoader 重新加载已加载的类？

> ID：13080351
> 
> 赞同：0
> 
> 时间：2012-10-26T03:30:57.873
> 
> 标签：java, class, reflection

```
public class ClassScanner
{
  // scan extraClasspath for specific classes
  public List<Class<?>> scanClasspathForClass(String scanCriteria)
  {
    ...
  }

  public static Class<?> reloadClass(Class<?> clazz, ClassLoader clazzLoader)
  {
    // Question: how to reload a loaded class (ClassScanner in this example) with a different arbitrary ClassLoader?
  }

  // an example of how reloadClass() would be used
  // in real case, this function would be in different class
  public List<Class<?>> scan(URL[] extraClasspath)
  {
    URLClassLoader urlClazzLoader = new URLClassLoader(extraClasspath, null);
    Class<?> newClass = reloadClass(ClassScanner.class, urlClazzLoader);
    return ((ClassScanner) newClass.newInstance()).scanClasspathForClass();
  }
} 
```

上面的代码演示了这个问题以及为什么它是一个问题。我需要实施`reloadClass()`. 我想知道 Java 1.6 中是否有可靠的解决方案。一个有用的参考是[Find where java class is loaded from](https://stackoverflow.com/questions/227486/find-where-java-class-is-loaded-from)。

感谢帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T21:09:04.833

[从http://www2.sys-con.com/itsg/virtualcd/java/archives/0808/chaudhri/index.html](http://www2.sys-con.com/itsg/virtualcd/java/archives/0808/chaudhri/index.html)找到了自己的答案。

基本上我需要的是让一个 ClassLoader A 与另一个 ClassLoader B 共享其命名空间。我发现实现这一点的方法是使用 ClassLoader 父委托模型。这里，ClassLoader A 是父 ClassLoader。

```
public List<Class<?>> scan(URL[] extraClasspath) throws Exception
{
  URLClassLoader urlClazzLoader = new URLClassLoader(extraClasspath, ClassScanner.class.getClassLoader());
  return urlClazzLoader.loadClass(ClassScanner.getName()).newInstance();
} 
```

# java - 来自文本文件的 Java 参数

> ID：13080352
> 
> 赞同：0
> 
> 时间：2012-10-26T03:31:02.677
> 
> 标签：java

我正在尝试从文本文件传递参数并对 java 中的对象执行相应的操作。到目前为止，我有以下内容：

```
 public static void main(String[] args) throws FileNotFoundException {
    Portfolio portfolio=new Portfolio();
    Scanner reader = new Scanner(new FileInputStream(args[0])).useDelimiter("\n");
            while(reader.hasNext()){
        String arg=reader.next();
        if(reader.hasNextInt()){
            int cash=reader.nextInt();
                      portfolio.arg(cash);
        }
        else if(reader.hasNext()){
            String ticker=reader.next();
            int shares=reader.nextInt();
            float price=reader.nextFloat();
              portfolio.arg(ticker,shares,price);
                    }
        portfolio.arg();
    }
    reader.close();

} 
```

如何将第一个作为方法传递给投资组合对象，其余作为该方法的参数？遇到很多麻烦，谢谢。

# symfony - 当我为提供者部分设置我的实体时的 MappingException

> ID：13080353
> 
> 赞同：0
> 
> 时间：2012-10-26T03:31:03.953
> 
> 标签：symfony, symfony-2.1

我收到了这个错误

```
MappingException: The class 'Telnet\IPBBridgeBundle\Entity\Member' was not found in the chain configured namespaces Telnet\CSSBundle\Entity 
```

我有 2 个包含实体的捆绑包和几个与学说配置的连接

```
orm:
    default_entity_manager: site
    entity_managers:
        site:
            connection: siteConfig
            mappings:
                CSSBundle: ~
        forum:
            connection: forumConfig
            mappings:
                IPBBridgeBundle: ~ 
```

这进入提供者

```
providers:
    main:
        entity: { class: Telnet\IPBBridgeBundle\Entity\Member, property: username } 
```

我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T05:25:50.307

SecurityBundle 使用默认的Entity Manager，而实现UserInterface 的Entity 必须由默认的Entity Manager 处理。

# java - Java的类不是抽象的吗？涉及的接口使用

> ID：13080354
> 
> 赞同：0
> 
> 时间：2012-10-26T03:31:07.423
> 
> 标签：java, class, interface

我正在为家庭作业创建一个程序，该程序计算出使用界面的火车旅行的成本：

```
Train Class:

public class Train implements MassTransit {

public void getCapacity() {

    int capacity = 100;

}//end get Capacity

public int getRoundTripCost(int leave, int return_time){
    int cost = 0;
    cost = (return_time - leave) * 100;
    return cost;

} //end getRoundtrip

public static void main(String[] args) {

    Train train = new Train();
    train.getRoundTripCost(20,25);

}//end of main method

}//end train class 
```

和大众运输方法

```
public interface MassTransit {

public void getCapacity();
public void getRoundTripCost(int leave, int return_time);

}//end of MassTransit interface 
```

当我尝试编译 Train 类时，我得到的错误是“Train.java:6: error: Train is not abstract and does not override abstract method getRoundTripCost(int,int) in MassTransit”

和

“Train.java:19：错误：Train 中的 getRoundTripCost(int,int) 无法在 MassTransit 中实现 getRoundTripCost(int,int)”

我是一个完整的 Java 新手，但我仍然不熟悉 Java 接口。我做错什么了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T03:32:53.900

```
public int getRoundTripCost(int leave, int return_time){
    int cost = 0;
    cost = (return_time - leave) * 100;
    return cost;

} //end getRoundtrip 
```

上面被覆盖的方法返回类型应该`void`不是`int`。您的接口定义了返回类型的方法`void`。

```
public void getRoundTripCost(int leave, int return_time); 
```

按照[java教程](http://docs.oracle.com/javase/tutorial/java/IandI/override.html)

> 子类中具有相同签名（名称，加上其参数的编号和类型）和返回类型作为超类中的实例方法的实例方法会覆盖超类的方法。

# java - 当 Android 代码中引入任何类型的循环时，未加载 Main.xml

> ID：13080358
> 
> 赞同：0
> 
> 时间：2012-10-26T03:32:15.410
> 
> 标签：java, android

请参考以下代码，该代码从 PHP 脚本中获取一些信息，并将其显示在我的手机上：

```
package room.temperature;

import java.io.BufferedReader;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.util.ArrayList;

import org.apache.http.HttpEntity;
import org.apache.http.HttpResponse;
import org.apache.http.NameValuePair;
import org.apache.http.client.HttpClient;
import org.apache.http.client.entity.UrlEncodedFormEntity;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.impl.client.DefaultHttpClient;

import android.app.Activity;
import android.os.Bundle;
import android.util.Log;
import android.widget.TextView;

public class RoomTemperatureActivity extends Activity {

    String result = null;
    StringBuilder sb=null;

    TextView TemperatureText, DateText;
    ArrayList<NameValuePair> nameValuePairs;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        TemperatureText = (TextView) findViewById(R.id.temperature); 
        DateText = (TextView) findViewById(R.id.date); 
        nameValuePairs = new ArrayList<NameValuePair>();
    }

    @Override
    public void onResume() {
        super.onResume();
        //setValues();

        for (int i = 0; i < 10; i++) {
            setValues();
        }
    }

    public void setValues() {

        InputStream is = null;

        try {
            HttpClient httpclient = new DefaultHttpClient();
            HttpPost httppost = new HttpPost("http://mywebsite.com/tempscript.php");
            httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
            HttpResponse response = httpclient.execute(httppost);
            HttpEntity entity = response.getEntity();
            is = entity.getContent();
        }

        catch(Exception e)  {
            Log.e("log_tag", "Error in http connection" + e.toString());
        }

        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(is,"iso-8859-1"),8);
            sb = new StringBuilder();
            sb.append(reader.readLine());
            is.close();
            result=sb.toString();
        }

        catch(Exception e)  {
            Log.e("log_tag", "Error converting result " + e.toString());
        }

        System.out.println(result);

        String[] values = result.split("&");

        TemperatureText.setText(values[0]);
        DateText.setText(values[1]);

    }
} 
```

当我注释掉 for 循环并且只调用`setValues()`一次时，这段代码效果很好。但是，一旦我引入循环，`main.xml`（或屏幕上的任何内容）在循环完成之前不会加载。我认为它与活动生命周期有关，但无论我尝试将代码放在哪里，它都无法正常工作。本质上，我希望这些值在我每次调用时都保持更新`setValues()`。10 次迭代循环仅用于测试概念。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T03:35:57.153

您需要了解 UI 线程是如何工作的，以了解为什么在循环完成之前您什么都看不到。UI 线程包含一个消息循环，其中消息（您可以将它们视为小代码块）被推送到其中并串行执行（一次 1 个）。当 UI 线程运行您的代码时，它将执行您要求的所有操作，但屏幕上的值将被“发布”，或发送到消息循环中，以便在下一个可用时间实际放置在屏幕上。你不应该在 UI 线程上做长时间运行的操作，这就是为什么 Android 系统提出了多种处理长时间运行的操作的方法。最常见的场景是使用 AsyncTask。

Http 调用永远不应该在 UI 线程上执行，事实上这将在运行蜂窝或更高版本的设备上失败（除非您在代码中引入一些 hack）。

您应该将 http 调用放在方法中的[AsyncTask](http://developer.android.com/reference/android/os/AsyncTask.html)中`doInBackground`。然后设置`onPostExecute`可以调用 UI 方法的方法（.setText 方法）。您需要将所有数据放入某种数据结构中，例如 doInBackground 方法中的 ArrayList。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T05:54:26.310

非常有趣的问题，根据我的一位前辈的说法，当您提出更改或重绘 UI 的请求时，会调用 GPU 进行更改所以当第一行执行进行更改时，会通知 GPU 并进行更改并且控制现在回到下一行，在你的情况下它是一个循环，所以它基本上等待循环完成（循环内循环）然后重绘或重绘它

因此，如果您这样做，我建议您不要将其置于循环中

```
setValues(); // 1st Time
setValues(); // 2nd Time
setValues(); // 3rd Time
setValues(); // 4th Time
setValues(); // 5th Time
setValues(); // 6th Time
setValues(); // 7th Time
setValues(); // 8th Time
setValues(); // 9th Time
setValues(); // 10th Time 
```

并查看是否在每次通话中都进行了更改（我知道这不是您的解决方案，但这只是为了理解目的）

如果我要提出一个解决方案，那么我会说使用异步任务来更新 UI，因为在 3.0 蜂窝之后，无法从主线程对 UI 进行任何更改

有关异步任务，请参阅此[http://www.vogella.com/articles/AndroidPerformance/article.html](http://www.vogella.com/articles/AndroidPerformance/article.html)

# python - 从不比较两个列表元素两次的列表中的 Random.Choice (Python)

> ID：13080361
> 
> 赞同：4
> 
> 时间：2012-10-26T03:32:25.153
> 
> 标签：python, random, random-sample

我目前正在尝试创建一个程序，该程序一次从列表中随机选择两个项目供用户进行比较，而不**将两个项目比较两次**或将**同一项目与其自身**进行比较。

```
list1 = ['item1', 'item2', 'item3', 'item4', 'item5'] 
```

在`list1`，我想使用一个 random.choice：

```
item_chosen = random.choice(list1)
print(item_chosen)
item_chosen2 = random.choice(list1)
print(item_chosen2) 
```

这里的问题是`item_chose`可能与 相同`item_chosen2`，如果我设置一个循环，相同的比较将多次进行。此外，程序需要意识到何时将所有列表项相互比较（手动编写每个可能组合中所有多个项之间的比较将花费太长时间）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-26T03:37:07.103

使用`random.sample`：

```
item1, item2 = random.sample(list1, 2) 
```

这得到了两个独特的元素`list1`（即`item1`并且`item2`保证是不同的）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T03:40:17.683

打乱列表（使用[`random.shuffle`](http://docs.python.org/library/random.html#random.shuffle)）并从打乱列表中依次取出两个项目。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-26T03:42:31.847

你可能最好使用`random.shuffle()`而不是`random.choice()`：

```
list1 = ['item1', 'item2', 'item3', 'item4', 'item5']

random.shuffle(list1)
item_chosen = list1.pop()
print(item_chosen)
item_chosen2 = list1.pop()
print(item_chosen2) 
```

# c# - ViewModel 应该如何与 Model 通信，以便两者同步

> ID：13080366
> 
> 赞同：2
> 
> 时间：2012-10-26T03:33:03.540
> 
> 标签：c#, design-patterns, mvvm

在 MVVM 设计中，应该如何与`ViewModel`进行通信以`Model`使两者同步？

从我目前所阅读的内容来看，大多数文章都表明，由于`ViewModel`包装了`Model`，`ViewModel`可以`Model`直接访问 。在这种情况下，`ViewModel`可以直接检索和更新`Model`.

但是，如果 中的某些数据`Model`不是通过`ViewModel`? 在这种情况下，由于`ViewModel`没有观察或数据绑定到`Model`，因此`ViewModel`不会知道 中的数据`Model`已在外部更改（不是来自 ViewModel 本身）或当`Model`与其他模型交互并更改其数据时，并且`ViewModel`不会通知的`View`。

那么，应该如何`ViewModel`与the进行通信以`Model`使两者同步呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T08:16:29.533

该模型应实现 INotifyPropertyChanged 接口。然后 ViewModel 可以订阅相应的事件并在模型更改时触发其自己的 PropertyChanged 通知，以便更新视图。

> **模型类通常通过INotifyPropertyChanged**和**INotifyCollectionChanged**接口提供属性和集合更改通知事件。这使它们可以轻松地在视图中绑定数据。表示对象集合的模型类通常派生自**ObservableCollection**类。

取自[http://msdn.microsoft.com/en-us/library/gg405484%28PandP.40%29.aspx](http://msdn.microsoft.com/en-us/library/gg405484%28PandP.40%29.aspx)

为了不让 INotifyChanged 的​​东西弄乱你的模型（和其他任何东西），我建议使用*Notify Property Weaver Extension*：http: [//visualstudiogallery.msdn.microsoft.com/bd351303-db8c-4771-9b22-5e51524fccd3](http://visualstudiogallery.msdn.microsoft.com/bd351303-db8c-4771-9b22-5e51524fccd3)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T06:14:30.063

> 如果 Model 中的某些数据不是通过 ViewModel 更新会发生什么

如果是这种情况，并且您希望将此更新发布到模型之外 - 您的模型只需实现一些东西即可（例如事件）

然后，您的视图模型可以简单地订阅此事件并通知视图。

# android - Android - 2.3.3 和 4.0 操作系统中的异步任务行为

> ID：13080367
> 
> 赞同：5
> 
> 时间：2012-10-26T03:33:16.873
> 
> 标签：android, multithreading, threadpool

我正在测试一个应用程序，其中我们有一个列表视图，其中包含通过网络检索的图像列表。当我在 android 设备 2.3.3（WIFI 速度 512 KBPS）上运行应用程序并检查 DDMS（线程查看器）时，线程数一直从 25 增加到 50。但是当我在设备 4.0（WIFI 速度）上测试相同的应用程序时5 MBPS），线程数没有增加。

谁能帮我理解为什么会这样？是由于android操作系统的差异还是其他原因？

提前致谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-26T03:45:47.103

你在用`AsyncTask`. 在 Android 3.0 之后，默认行为`AsyncTask`是使用 SERIAL_EXECUTOR 在单线程中执行。

如果您想`AsyncTask`在任何系统版本上同时运行，您可以使用此代码。

```
AsyncTask task = new YourTask();
if (Build.VERSION.SDK_INT <= Build.VERSION_CODES.GINGERBREAD_MR1) {
    task.execute(params);
} else {
    task.executeOnExecutor(AsyncTask.THREAD_POOL_EXECUTOR, params);
} 
```

Pre OS 1.6 - 多个异步任务按顺序执行。OS 1.6 到 OS 2.3 - 异步任务并行运行。从 3.0 - 同样，异步任务按顺序执行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T03:35:53.927

您是否使用 AsyncTask 执行后台操作？我认为GB和ICS之间AsyncTask的实现是有区别的。

尝试在线程完成其工作时添加一些调试日志，并查看两个版本之间是否存在差异。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-12T06:59:28.770

对于 API < 11，您可以使用 AsyncTaskCompat.executeInParallel，您可以在 appcompat v4 库中找到此类。

使用示例：

```
AsyncTaskCompat.executeParallel(new AsyncTask<Void, Void, Bitmap>() {
        @Override
        protected Bitmap doInBackground(Void... params) {
            return MediaStore.Images.Thumbnails.getThumbnail(
                    imageView.getContext().getContentResolver(),
                    id,
                    MediaStore.Images.Thumbnails.MINI_KIND,
                    null);
        }
        @Override
        protected void onPostExecute(Bitmap bitmap) {
            imageView.setImageBitmap(bitmap);
            if (bitmap != null) {
                // Add the image to the memory cache first
                CACHE.put(id, bitmap);
                if (listener != null) {
                    listener.onImageLoaded(bitmap);
                }
            }
        }
    }); 
```

请享用

# java - 我的程序打印出奇怪的结果：cycle@530daa cycle@530daa cycle@a62fc3 cycle@a62fc3

> ID：13080369
> 
> 赞同：0
> 
> 时间：2012-10-26T03:33:49.483
> 
> 标签：java

发生这种情况是否有特殊原因，或者可能有很多不同的原因？我不知道为什么我的程序打印出它正在打印的值，因为我希望它打印出整数。相反，我得到了这个：

循环@173a10f 循环@a62fc3 循环@a62fc3 循环@a62fc3 循环@530daa 循环@a62fc3 循环@a62fc3 循环@530daa 循环@a62fc3

这是代码的一部分：（我还有一个循环类，以及一个堆栈和队列类）

```
 import java.io.*;
   import java.util.*;

public class PrintQ {

  public static void main(String args[]) throws FileNotFoundException {

     Scanner inFile = new Scanner(new FileReader("C:\\Users\\Whitney\\Desktop\\QueueIn.txt"));
     String job1;
     job1=inFile.next();

     char char1;
     int i=0;
     int FirstComma;
     int SecondComma;
     String charholder;

     QueueClass<cycle> list= new QueueClass(100);
     QueueClass<Integer> cyclelist= new QueueClass(100);
     cycle currentcycle= new cycle();
     cycle priorityCycle= new cycle();
     cycle Scycle= new cycle();

     while(inFile.hasNext()){

        switch(job1.charAt(0)) {

           case 'q': 
              {
                 FirstComma=job1.indexOf(',');
                 SecondComma=job1.lastIndexOf(',');
                 currentcycle.jobNumber=Integer.parseInt(job1.substring(FirstComma+1,SecondComma));
                 currentcycle.cycleNumber=Integer.parseInt(job1.substring(SecondComma+1));
                 cyclelist.addQueue(currentcycle.cycleNumber);
                 list.addQueue(currentcycle);  
                 break;
              }

           case 'p': 
              {                    
                 FirstComma=job1.indexOf(',');
                 SecondComma=job1.lastIndexOf(',');
                 priorityCycle.jobNumber=Integer.parseInt(job1.substring(FirstComma+1,SecondComma));
                 priorityCycle.cycleNumber=Integer.parseInt(job1.substring(SecondComma+1));
                 cyclelist.addQueue(priorityCycle.cycleNumber);
                 list.priorityinsert(priorityCycle);
                 break;
              }

           case 's': 
              {
                 FirstComma=job1.indexOf(',');
                 SecondComma=job1.lastIndexOf(','); 
                 Scycle.cycleNumber=Integer.parseInt(job1.substring(SecondComma+1));
                 list.addQueue(Scycle);
                 cyclelist.addQueue(Scycle.cycleNumber);
                 break;
              }

           case 'h': 
              {
                 StackClass<Integer> stackjob= new StackClass();
                 StackClass<Integer> stackcycle= new StackClass();
                 job1=(String) inFile.next();

                 while(inFile.hasNext()){

                    switch(job1.charAt(0)) {

                       case 'q':
                          {
                             FirstComma=job1.indexOf(',');
                             SecondComma=job1.lastIndexOf(',');
                             currentcycle.jobNumber=Integer.parseInt(job1.substring(FirstComma+1,SecondComma));
                             currentcycle.cycleNumber=Integer.parseInt(job1.substring(SecondComma+1));
                             stackjob.push(currentcycle.jobNumber);
                             stackcycle.push(currentcycle.cycleNumber);
                             break;
                          }
                       case 'p':
                          {
                             FirstComma=job1.indexOf(',');
                             SecondComma=job1.lastIndexOf(',');
                             priorityCycle.jobNumber=Integer.parseInt(job1.substring(FirstComma+1,SecondComma));
                             priorityCycle.cycleNumber=Integer.parseInt(job1.substring(SecondComma+1));
                             stackjob.push(priorityCycle.jobNumber);
                             stackcycle.push(priorityCycle.cycleNumber);
                             break;
                          }

                       case 's':
                          {
                             FirstComma=job1.indexOf(',');
                             SecondComma=job1.lastIndexOf(',');
                             Scycle.cycleNumber=0;
                             Scycle.cycleNumber=Integer.parseInt(job1.substring(SecondComma+1));
                             stackjob.push(0);
                             stackcycle.push(Scycle.cycleNumber); 
                             break;
                          }

                       case 'h': 
                          {
                             continue;
                          }

                    }
                    job1=(String) inFile.next();

                 }   
                 System.out.println();
                 System.out.println();

                 while((stackjob.isEmptyStack()==false) && (stackcycle.isEmptyStack()==false)) 
                 {
                    int printjob;
                    int printcycle;
                    Object peek;

                    printjob=stackjob.peek();
                    printcycle=stackcycle.peek();
                    System.out.println("Job Number: "+printjob+" "+"Cycles Remaining: "+printcycle);
                    stackcycle.pop();
                    stackjob.pop(); 

                 } 

                 continue;
              }           
        }
        job1=inFile.next();   
     }   

     cycle whilecurrent= new cycle();

     while(list.isEmptyQueue()==false) 
     {
        whilecurrent=list.front();
        int whilecurrentcycle= cyclelist.front();
        list.print();
        //System.out.println();

        while(whilecurrentcycle != 0)
        {
           whilecurrentcycle--;
           //System.out.println("loop "+whilecurrentcycle);  
        }
        //System.out.println();
        //System.out.println(whilecurrent);

        cyclelist.deleteQueue();
        list.deleteQueue();   
     }  
     System.out.println();
     list.print();
     System.out.println(); 
  } 
```

}

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-26T03:36:29.210

您正在打印`cycle`对象的某个地方，并且由于您没有覆盖`cycle.toString()`，它使用的是[默认`toString`实现](http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html#toString%28%29)。

要覆盖`toString`类的方法，您需要编写如下代码：

```
class Xxx {
    @Override
    public String toString() {
         StringBuilder sb = new StringBuilder();
         sb.append("Your");
         sb.append("Logic Here");
         return sb.toString();
    }
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-26T03:36:44.420

那是因为您没有覆盖`toString()`您尝试打印的类的默认方法。

# bson - BSON 到消息包

> ID：13080374
> 
> 赞同：0
> 
> 时间：2012-10-26T03:35:11.383
> 
> 标签：bson, msgpack, messagepack

我面临的问题是 BSON 带有 ObjectId 和 Timestamp ，它们在 Messagepack 中不受支持，并且无法为 Messagepack 定义自定义序列化程序（至少据我所知）。
我写了一段 python 代码来比较 pymongo 的 BSON 和 msgpack。在没有太多优化的情况下，我可以实现 300% 的性能提升。那么，有没有办法将 BSON 转换为 Messagepack？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T13:59:50.300

这是我解决问题的方法。
不幸的是，由于 mongodb none-REST API 没有用于文档检索的 Strict 或 JS 模式（与其 REST API 不同，您可以在其中指定要用于检索文档的格式），我们别无选择但要手动进行转换。

```
import json    
from bson import json_util
import msgpack

con = Connection()
db = con.test
col = db.collection
d = col.find().limit(1)[0]

s = json.dumps(d, default=json_util.default) # s is in JSON compatibale format (ObjcetId => '$0id'
packer= msgpack.Packer()
packer.pack(s) # messagepack can successfully convert since the format is JSON compatible. 
```

令人敬畏的观察是，即使增加了 json.dumps 一步，Messagepack 序列化程序也比 BSON 编码快，但不是 3 倍。对于 10000 次重复，差异是十分之三秒。

# c++ - 寻求 GMP 二进制搜索：如何使用 memcmp 比较两个 GMP mpz_t？

> ID：13080377
> 
> 赞同：1
> 
> 时间：2012-10-26T03:35:29.380
> 
> 标签：c++, gmp, bsearch

动机：我想使用`bsearch`（二进制搜索）快速搜索 121 位非负整数的排序列表（它们都有 121 位，尽管它们可能有前导零）。这些整数太大而无法存储为单独`int`的 s，依此类推，所以我打算制作它们`mpz_t`（使用[GMP](http://gmplib.org/)）。

翻阅手册，GMP 没有`bsearch`等效项（尽管，如果我错了，请纠正我），这导致我：

> **问题**：我们可以使用`memcmp`或类似的东西来比较两个具有相同位数的非负整数存储为`mpz_t`？如果是这样，正确的语法是什么？

如果这是可能的，搜索应该是非常有效的。

我也愿意接受有关以下方面的替代建议：（a）用于存储这些 121 位整数的数据结构，允许在 C++ 中进行快速搜索，（b）用于搜索不使用的整数的方法`memcmp`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T03:51:46.510

如果它们只是 121 位整数，为什么不使用本机 128 位 int 扩展： http: [//gcc.gnu.org/onlinedocs/gcc/_005f_005fint128.html](http://gcc.gnu.org/onlinedocs/gcc/_005f_005fint128.html)？这应该快得多，因为您可以避免任何“昂贵”的操作，如 memcpy，所有的比较都应该是一条指令。

# javascript - 斜边乘以多个数值

> ID：13080379
> 
> 赞同：0
> 
> 时间：2012-10-26T03:35:44.100
> 
> 标签：javascript

用数值计算斜边的简单数字代码，我不知道如何用Javascript语言解密斜边代码“hypo =（sidea squared plus sideb squared）的平方根”，当我转到我的网页时它只是显示为空白...我错过了什么请告诉我这是什么谢谢

```
<html>
<head>
<title> Quadratic</title>

<script type="text/javascript">
function Calculate() {
    var a =  document.getElementById("aBox").value;
    var b =  document.getElementById("bBox").value;
    var c = document.getElementById("cBox").value;
    var x = document.getElementById("xBox").value;  
    var y = 0;

    document.getElementById('outputDiv').innerHTML= 'result y = : 'y = ax2 + bx + c;">
}
</head>
<body>
<h2>Quadratic</h2>
<p>
 a: <input type="text" id="aBox" value="2">
<br>
 b: <input type="text" id="bBox" value="3">
<br>
 c: <input type="text" id="cBox" value="4">
 <br>
 x: <input type="text" id="xBox" value="5">
 <br>
 result y = : <input type="text" id="yBox" value="0">
</p>
<div id="outputDiv"> 
<input type="button" value="Calculate quadratic" onclick="Calculate();">
</div>
<hr>
</script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T03:37:41.900

您需要在正确的位置关闭脚本标签

```
}
</script>
</head>
<body> 
```

那么你的页面至少会显示

那么你需要解决这个问题

```
.innerHTML= 'result y = : 'y = ax2 + bx + c;"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T03:51:35.687

试试这个小提琴。[http://jsfiddle.net/harendra/CpBZu/](http://jsfiddle.net/harendra/CpBZu/) 这修复了你的计算函数来计算正方形的斜边。你也可以对其他方块做同样的事情。

```
function Calculate() {
var a =  parseInt(document.getElementById("aBox").value);
var b =  parseInt(document.getElementById("bBox").value);
var c = parseInt(document.getElementById("cBox").value);
var x = parseInt(document.getElementById("xBox").value);  
var y = Math.sqrt(a*a+a*a);
document.getElementById('yBox').value=y

//document.getElementById('outputDiv').innerHTML= 'result y = : 'y = ax2 + bx + c";
} 
```

# javascript - jQuery Tooltip 图像翻转显示更大的图像

> ID：13080387
> 
> 赞同：0
> 
> 时间：2012-10-26T03:36:21.830
> 
> 标签：javascript, jquery, tooltip, rollover

我有一个显示缩略图列表的图片库。我正在使用 jQuery Tooltip 插件在翻转时在工具提示中显示图像。

但是，我想显示比我的缩略图更大的图像。

```
$(document).ready(function(){
    $('.imageGalleryAlbum li a img').tooltip({ 
        delay: 0, 
        showURL: false, 
        bodyHandler: function() { 
            return $("<img/>").attr("src", this.src); 
        } 
    });
}); 
```

我的画廊列出的缩略图以以下“_thumb_150.jpg”结尾

我想显示同一目录/文件夹中的“_thumb_630.jpg”。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T03:38:47.407

尝试用当前图像源中的 630 替换 _150。

src.replace('150', '630')

```
bodyHandler: function() { 
    var new_source = this.src.replace('150', '630');

    return $("<img/>").attr("src", new_source); 
} 
```

# c++ - C++ 指针和向量

> ID：13080394
> 
> 赞同：0
> 
> 时间：2012-10-26T03:36:58.933
> 
> 标签：c++, pointers, casting

我有一个`vector<MyType*>*`，但我不完全确定它是如何被访问的。我正在声明`MyType* var = new MyType(params)`，它可以在创建它的类中正常访问。数字吐出来就好了。当我返回这些向量并尝试从另一个类（`int main()`方法）访问它时，我得到的数字完全不同。

我访问它的方式`int main()`是

```
MyType* Temp = reinterpret_cast<MyType*>(&ReturnedVector[i]); 
```

这里有什么遗漏吗？我是 C++ 新手。

编辑：添加代码以进行澄清。这是我的主要方法：

```
int main(array<System::String ^> ^args)
{
    MyAPI API;
    std::vector<MyClass*>* RetVector = API.GetVector();

    for (unsigned int i = 0; i < RetVector->size(); i++)
    {
        MyClass* Temp = reinterpret_cast< MyClass* >(&RetVector[i]);
        cout << Temp->value << endl;
    }
    return 0;
} 
```

这是另一个类中的向量返回方法：

```
vector<MyClass*>* MyAPI::GetVector()
{
vector<MyClass*>* Ret = new vector<MyClass*>();
for (int i = 0; i < 100; i++)
{
MyClass* Tmp = new MyClass(params);
Ret->push_back(Tmp);
}
return Ret;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T04:13:38.900

你不应该需要`reinterpret_cast`. 每当您这样做时，请仔细考虑为什么要这样做。如果要克服编译器给您的类型警告，则该警告可能完全有效。

```
vector<MyType*> *ReturnedVector = some_function_that_returns_a_vector_pointer();

// NAUGHTY!
MyType* Temp = reinterpret_cast<MyType*>(&ReturnedVector[i]); 
```

这是不好的。您假设这`ReturnedVector`是一个指向 的数组的指针`vector<MyType*>`，并请求`i`该数组的第 th 个元素。然后获取该元素的地址 ( `MyType**`) 并将其转换为`MyType*`. 难怪你的数字不同。你很幸运，你的程序没有吐出众所周知的假人。

请注意，`&ReturnedVector[i]`与 相同`ReturnedVector + i`。

这是正确的方法。您取消引用指针以获取 a `vector<MyType*>`，然后调用其数组索引运算符来检索第`i`th 元素。当然，那个元素是 a `MyType*`，不需要强制转换。

```
// NICE!
MyType* Temp = (*ReturnedVector)[i]; 
```

* * *

编辑，因为您现在已经发布了一些代码......从函数中填充和返回向量的一种更常见的方法是通过引用传递它。这样你就不用处理指向向量的指针和丑陋的取消引用，并且你不需要在之后删除向量。尝试这个：

```
void MyAPI::GetVector( vector<MyClass*> & vec )
{
    vec.clear();
    vec.reserve(100);

    for (int i = 0; i < 100; i++)
    {
        vec.push_back( new MyClass(params) );
    }
} 
```

* * *

更新。当我写这个答案时，我对返回值优化不是很熟悉，因此我对返回向量时可能发生的复制感到偏执。这实际上不是问题。现代方法是简单地返回向量：

```
vector<MyClass*> MyAPI::GetVector()
{
    vector<MyClass*> vec;
    vec.reserve(100);
    for (int i = 0; i < 100; i++)
    {
        vec.push_back( new MyClass(params) );
    }
    return vec;
} 
```

`std::shared_ptr`而且，随着 C++11 变得更加正常，我们开始放弃原始指针，转而支持`std::unique_ptr`移动语义：

```
vector<unique_ptr<MyClass> > MyAPI::GetVector()
{
    vector<unique_ptr<MyClass> > vec;
    vec.reserve(100);
    for (int i = 0; i < 100; i++)
    {
        vec.push_back( std::move( unique_ptr<MyClass>(new MyClass(params)) ) );
    }
    return vec;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T06:01:01.940

只是替换这个

```
for (unsigned int i = 0; i < RetVector->size(); i++)
{
    MyClass* Temp = reinterpret_cast< MyClass* >(&RetVector[i]);
    std::cout << Temp->value << std::endl;
} 
```

和

```
while(!RetVector->empty())
{
    MyClass* Temp = RetVector->pop_back();
    std::cout << Temp->value << std::endl;
} 
```

# c - C 中共享内存和信号量的错误

> ID：13080399
> 
> 赞同：2
> 
> 时间：2012-10-26T03:37:52.453
> 
> 标签：c, posix, ipc, shared-memory, semaphore

我正在尝试重新创建生产者/消费者问题。到目前为止，我得到的是使用 SystemV 创建共享内存和使用 POSIX 的信号量的主程序，以测试生产者进程是否可以访问它。到目前为止，这是我的代码：

有界缓冲区.c

```
#define SHMKEYPATH = "/dev/null" 
#define SHMKEYID 1
#define SEMKEYPATH = "/dev/null"
#define SEMKEYID 1

//Create Shared Memory
int shmid;
key_t shmkey;
void *shmaddress;
char *shm;

shmkey = ftok(SHMKEYPATH, SHMKEYID);
shmid = shmget(shmkey, sizeof(int) * 5, IPC_CREAT | S_IRUSR | S_IWUSR);
shmaddress = shmat(shmid, NULL, 0);
shm = (char*)(shmaddress);
*shm = 'b';
printf("Test share memory: currently %c",*shm);

//Create Semaphore
sem_t* my_semaphore;
char SEMAPHORE_NAME[] = "/my_semaphore5";
int my_semvalue = 10;
int value;

my_semaphore = sem_open(SEMAPHORE_NAME, O_CREAT | O_EXCL, S_IRUSR | S_IWUSR, my_semvalue);
sem_getvalue(my_semaphore, &value);
printf("sem val is %d\n", value);

//Execute Producer Process
int Ppid = fork();
if(Ppid == 0)
    execv("PATHTOPRODUCER", NULL);

//Print values from producer
shm = (char*)(shmaddress);
printf("%s", shm);

shmdt(shmaddress);
shmctl(shmid, IPC_RMID, NULL);

sem_getvalue(my_semaphore, &value);
printf("New val is %d", value);
sem_close(my_semaphore);
sem_unlink(SEMAPHORE_NAME); 
```

生产者.c

```
//Test shared memory
void *shm_address;
int semid, shmid, rc;
key_t shmkey;

shkey = ftok(SHMKEYPATH, SHMKEYID);
shmid = shmget(shmkey, sizeof(int) *5, IPC_CREAT | S_IRUSR | S_IWUSR);
shm_address = shmat(shmid, NULL, 0);
char *shm;
shm = (char*)(shm_address);
shm = "testing";
shmdt(shm_address); 
```

有两个问题。生产者正在更改共享内存，但是当我要求有界缓冲区告诉我内存是什么时，它和以前一样。这在某一时刻有效，但不再想工作。对于信号量，我不知道如何在不创建新信号量的情况下从生产者访问它们。

我一直在寻找很长时间，但我能找到的都是 POSIX 或两种 SystemV 解决方案，而不是 POSIX 用于信号量和 SystemV 用于共享内存（我必须使用它们，这是家庭作业）。

任何意见，将不胜感激。谢谢。

# jquery - jquery nivo 滑块标题

> ID：13080404
> 
> 赞同：0
> 
> 时间：2012-10-26T03:38:28.193
> 
> 标签：jquery, drupal, nivo-slider

我正在使用 Drupals Nivo Slider 模块，并希望当鼠标悬停在滑块 div 上时标题向上滑动，并在鼠标离开 div 时消失。我已经弄清楚了，但我遇到的问题是模块中的 html 具有 display:block 的内联样式，它使标题出现，我不希望标题显示直到有人将鼠标悬停在它上面。现在我必须将鼠标悬停在它上面以摆脱 display:block ，然后由于我正在使用的 mouseleave 事件它可以工作。

奇怪的是，直到第三张图片才出现问题，因为第一张图片没有标题，而第二张图片完全符合我的要求，直到有人鼠标悬停才显示标题。这是第三、第四和第五张图像在图像淡入时显示它们的标题。我尝试在我的 CSS 中添加 display:none !important ，这使得标题根本不出现。这是我的 jQuery，任何帮助将不胜感激，我很抱歉花了这么多文字来解释我的问题。

```
 $('.nivo-caption').css('display', '');

        $('#home_slider').hover(function(){
                $('.nivo-caption p').slideToggle('fast');
        }); 

        $('#home_slider').mouseleave(function(){
                $('.nivo-caption p').css("display", "none");
        }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T03:51:59.257

这个怎么样？

```
 $('.nivo-caption').hide();

    $('#home_slider').hover(
        function(){
            $('.nivo-caption').show('fast');
        },
        function(){
            $('.nivo-caption').hide('fast');
        },
    ); 
```

# c++ - OpenGL 颜色选择器/变量或字段“glReadPixels”声明为 void

> ID：13080405
> 
> 赞同：-1
> 
> 时间：2012-10-26T03:38:28.663
> 
> 标签：c++, opengl

我正在尝试在 OpenGL 中为我正在编写的程序制作颜色选择器。我不断收到错误“变量或字段'glReadPixels'声明无效”我已经研究过并且找不到错误的含义，这使得它难以纠正。

```
#ifdef __APPLE__
#  include <OpenGL/gl.h>
#  include <OpenGL/glu.h>
#  include <GLUT/glut.h>
#else
#  include <GL/gl.h>
#  include <GL/glu.h>
#  include <GL/glut.h>
#endif

#include <iostream>
#include <cmath>
using namespace std;

#define WIDTH 750
#define HEIGHT 750

int i=0,mousex, mousey;

unsigned char pick[3];

float A = pick[0]/255;
float B = pick[1]/255;
float C = pick[2]/255;

bool mouseleftdown = false;

void hex(void){
glBegin(GL_POLYGON);
    glColor3f(1,0,0);           //red
    glVertex2f(0, 2);           //top
    glColor3f(1,.38,.01);       //orange
    glVertex2f(2, 1);           //top right
    glColor3f(1,1,0);           //yellow
    glVertex2f(2, -1);          //bottom right
    glColor3f(0,1,0);           //green
    glVertex2f(0, -2);          //bottom
    glColor3f(0,0,1);           //blue
    glVertex2f(-2, -1);         //bottom left
    glColor3f(.8,0,.8);         //purple
    glVertex2f(-2, 1);          //top left
glEnd();

glEnd();
}

void square(void){
glBegin(GL_POLYGON);
glVertex2i(1, -1);
glVertex2i(1, 1);
glVertex2i(-1, 1);
glVertex2i(-1, -1);
glEnd();
}

void mouse(int button, int state, int x, int y){
// Save the left button state
if (button == GLUT_LEFT_BUTTON)
{
    mouseleftdown = (state == GLUT_DOWN);
    glutPostRedisplay();  // Left button has changed; redisplay!
}

// Save the mouse position
mousex = x;
mousey = y;

}

void glReadPixels(mousex , mousey , 1 , 1 , GL_RGB , GL_UNSIGNED_BYTE , pick);

void draw(void){
glClear(GL_COLOR_BUFFER_BIT);

glPushMatrix();
glColor3f(A,B,C);
glScalef(750,750,1);
square();
glPopMatrix();

glPushMatrix();
glScalef(20,20,1);
    hex();
glPopMatrix();

glFlush();

}

void my_init(void){
glClearColor(0, 0, 0, 0);               //sets clear color
glLineWidth(4);
gluOrtho2D(-100, 100, -100, 100);       //sets origin
}

int main(int argc, char* argv[ ]){
glutInit(&argc, argv);
glutInitDisplayMode(GLUT_SINGLE | GLUT_RGBA);
glutInitWindowSize(WIDTH, HEIGHT);
glutCreateWindow("Color Picker");
glutDisplayFunc(draw);
glutMouseFunc(mouse);

my_init();

glClearColor(1, 1, 1, 0);

glutMainLoop();                         //listens for events

return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T05:11:19.047

`void`从调用前面删除关键字to `glReadPixels`，然后移动它，使其位于您要调用它的位置的函数内，大概在`mouse()`左键单击`if`块内。

# xml - 序列 XSD 标签的含义

> ID：13080409
> 
> 赞同：0
> 
> 时间：2012-10-26T03:39:06.900
> 
> 标签：xml, schema

我不清楚序列的定义是如何工作的。

在ww3学校网站上，给出了下面的例子：

```
<xs:element name="pets">
  <xs:complexType>
    <xs:sequence minOccurs="0" maxOccurs="unbounded">
      <xs:element name="dog" type="xs:string"/>
      <xs:element name="cat" type="xs:string"/>
    </xs:sequence>
  </xs:complexType>
</xs:element> 
```

其中据说

> 该示例显示了一个名为“pets”的元素的声明，该元素在序列元素中可以包含零个或多个以下元素，狗和猫：

但是，这是什么意思？会不会有 5 个狗元素而没有猫元素。还是3个猫元素没有狗元素？或者 cat 和 dog 元素是否总是必须一起出现，当它们出现时，它们可以同时出现 0 到某个未定义的次数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T07:04:09.787

我发现 w3schools 是一个有用的资源，可以提醒自己曾经知道的语法细节，但如果你正在学习新概念，这不是一个好去处。给自己买一本关于 XML 模式的好书，例如 Priscilla Walmsley 或 Eric van der Vlist 的书 - 并阅读它。

您显示的语法类似于正则表达式中的 (dog, cat)*：即序列 (dog, cat) 的任意数量的重复。

# javascript - jquery点击模拟不起作用

> ID：13080413
> 
> 赞同：0
> 
> 时间：2012-10-26T03:40:05.553
> 
> 标签：javascript, jquery, click

试图使用这段代码来模拟一个对象的点击，我在 html 中注入了这段代码。

```
<script type='text/javascript'> 
   $(window).load(function() {
      $('#hellothere').click();
   });
</script> 
```

没有工作……完全没有！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T03:42:57.760

当 DOM 准备好时，您应该使用该`ready()`函数运行代码 - [http://api.jquery.com/ready/](http://api.jquery.com/ready/) - 该`load()`方法用于加载新内容 - [http://api.jquery.com/load/](http://api.jquery.com/load/) - 并且是不适合您的目的。然后，您可以使用`trigger()`在 DOM 对象上触发单击事件。

```
// run when the DOM is loaded
$(document).ready(function(){
    $('#hellothere')
         // Set up the click event
         .on('click', function(){ alert('you clicked #hellothere'); })
         // Trigger the click event
         .trigger('click');
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T03:43:10.133

如果你试图模拟点击对象，你应该使用 trigger 方法，

```
$(function){
   $('#hellothere').trigger('click');
}); 
```

这是触发器文档的链接：http: [//api.jquery.com/trigger/](http://api.jquery.com/trigger/)

这是点击方法的代码：

```
jQuery.fn.click = function (data, fn) {
  if (fn == null) {
    fn = data;
    data = null;
}

return arguments.length > 0 ? this.on(name, null, data, fn) : this.trigger(name);
} 
```

如你看到的; 如果没有参数被解析到函数，它将触发点击事件。

所以使用 .trigger("click") 因为你会少调用一个函数。 [https://stackoverflow.com/a/9666547/887539](https://stackoverflow.com/a/9666547/887539)

PS：

这是查看 jQuery 源代码的好工具：http: [//james.padolsey.com/jquery/](http://james.padolsey.com/jquery/)

# checkbox - 标签、复选框和单选按钮

> ID：13080416
> 
> 赞同：5
> 
> 时间：2012-10-26T03:40:26.477
> 
> 标签：checkbox, label, accessibility, radio, fieldset

我的 Web 应用程序使用如下示例所示的表单...

```
First Name      [____________]
Last Name       [____________]
Gender          () Male  () Female 
```

我使用的标记类似于...

```
<label for="firstName">First Name</label><input type="text" id="firstName" />
<label for="lastName">Last Name</label><input type="text" id="lastName" />
<label>Gender</label>
<fieldset>
  <legend>Gender</legend>
  <input type="radio" name="sex" id="sex-m" value="m">
  <label for="sex-m">Male</label>
  <input type="radio" name="sex" id="sex-f" value="f">
  <label for="sex-f">Female</label>
</fieldset> 
```

我有以下问题，我不知道如何解决......

1.  我希望像任何其他字段一样标记整个单选按钮组（如上图所示），但是没有任何东西可以链接标签（即没有任何关于它的“for”属性，因为组中的每个单选按钮都有它的仅针对单个单选按钮的值的自己的标签）没有“for”属性的标签将无法通过可访问性合规性。

2.  字段集的 <legend> 元素似乎复制了标签的功能。这真的有必要吗？

我曾考虑将 <legend> 标记的样式设置为看起来好像它是一个标签，并为单选按钮组完全省去标签，但这对我来说似乎有点 hacky，并且还会在我的代码的其他地方引入复杂性（其中依赖 <label> 元素来做一些漂亮的验证消息标记和其他各种事情）

提前致谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-26T15:16:55.370

索林格回答的第一部分是正确的：

代码应该是：

```
<label for="firstName">First Name</label><input type="text" id="firstName" />
<label for="lastName">Last Name</label><input type="text" id="lastName" />
<fieldset>
  <legend>Gender</legend>
  <input type="radio" name="sex" id="sex-m" value="m">
  <label for="sex-m">Male</label>
  <input type="radio" name="sex" id="sex-f" value="f">
  <label for="sex-f">Female</label>
</fieldset> 
```

当辅助技术点击男性单选按钮时，大多数会显示为：“性别：未选中男性单选按钮 1 of 2。”

然后你可以在`fieldset`, `legend`, 标签和`inputs`. 如果内存服务正确，字段集可能会让人难以接受，所以我最终可能会添加一个`<div>`：

```
<label for="firstName">First Name</label><input type="text" id="firstName" />
<label for="lastName">Last Name</label><input type="text" id="lastName" />
<fieldset>
  <legend>Gender</legend>
  <div>
  <input type="radio" name="sex" id="sex-m" value="m">
  <label for="sex-m">Male</label>
  <input type="radio" name="sex" id="sex-f" value="f">
  <label for="sex-f">Female</label>
  </div>
</fieldset> 
```

添加它`<div>`不会影响可访问性。

就像在 ssollinger 的回答中的评论一样，您可以转储`fieldset`and`legend`方法，但是您需要构建所有内容以使其可访问，[这是构建的示例](http://test.cita.illinois.edu/aria/radio/radio1.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T12:55:09.077

> 我曾考虑将`<legend>`标签设置为看起来像是一个标签，并为单选按钮组完全省去标签，......</p>

这是正确的做法。“性别”不是任何东西的标签，单选框的标签是“男性”和“女性”。“性别”是将单选按钮组合在一起的字段集的图例。实现此表单的正确方法是删除“性别”标签，并仅将字段集保留为`legend`“性别”。

从技术上讲，您可能可以`<div>`在单选按钮周围添加一个`for=`并将“性别”标签指向该标签，但我很确定这会导致可访问性问题（虽然尚未使用屏幕阅读器尝试过）所以我会强烈建议去掉“性别”的标签。

# clojure - 解析 little-endian 二进制文件，填充到矩阵中

> ID：13080418
> 
> 赞同：3
> 
> 时间：2012-10-26T03:41:01.187
> 
> 标签：clojure

我有一个包含 X x X 矩阵的二进制文件。文件本身是一系列单精度浮点数（小端序）。我想做的是解析它，并将其填充到一些合理的 clojure 矩阵数据类型中。

感谢[这个问题](https://stackoverflow.com/questions/749871/how-to-parse-binary-files-in-clojure)，我看到我可以用光泽解析二进制文件。我现在有如下代码：

```
(ns foo.core
  (:require gloss.core)
  (:require gloss.io)
  (:use [clojure.java.io])
  (:use [clojure.math.numeric-tower]))

(gloss.core/defcodec mycodec
  (gloss.core/repeated :float32 :prefix :none))

(def buffer (byte-array (* 1200 1200)))

(.read (input-stream "/path/to/binaryfile") buffer)

(gloss.io/decode mycodec buffer) 
```

这需要一段时间才能运行，但最终会输出一大串数字。不幸的是，这些数字都是错误的。经过进一步调查，这些数字被解读为大端序。

假设有某种方法可以将这些二进制文件作为小端读取，我想将结果填充到矩阵中。[这个问题](https://stackoverflow.com/questions/1674335/clojure-matrix-representation)似乎已经决定使用 Incanter 及其 Parallel Colt 表示，但是，这个问题来自 09 年，我希望坚持使用 clojure 1.4 和 lein 2。在我疯狂的谷歌搜索的某个地方，我看到了其他建议使用 jblas 或 mahout。这些天有用于clojure的“最佳”矩阵库吗？

**编辑**：读取二进制文件非常接近。多亏了这个方便的[nio wrapper](https://github.com/pjstadig/nio)，我能够将内存映射的字节缓冲区作为一个短的单线，甚至重新排序：

```
(ns foo.core
  (:require [clojure.java.io :as io])
  (:require [nio.core :as nio])
  (:import [java.nio ByteOrder]))

(def buffer (nio/mmap "/path/to/binaryfile"))

(class buffer) ;; java.nio.DirectByteBuffer

(.order buffer java.nio.ByteOrder/LITTLE_ENDIAN)
;; #<DirectByteBuffer java.nio.DirectByteBuffer[pos=0 lim=5760000 cap=5760000]> 
```

但是，在不执行中间 (def) 步骤的情况下重新排序会失败：

```
(.order (nio/mmap f) java.nio.ByteOrder/LITTLE_ENDIAN)

;; clojure.lang.Compiler$CompilerException: java.lang.IllegalArgumentException: Unable to resolve classname: MappedByteBuffer, compiling:(/Users/peter/Developer/foo/src/foo/core.clj:12)
;;  at clojure.lang.Compiler.analyzeSeq (Compiler.java:6462)
;;     clojure.lang.Compiler.analyze (Compiler.java:6262)
;; etc... 
```

我希望能够在不定义全局变量的情况下在函数内创建重新排序的字节缓冲区，但现在它似乎不喜欢那样。

此外，一旦我重新排序，我不完全确定如何处理我的 DirectByteBuffer，因为它似乎不是可迭代的。也许对于读取此缓冲区对象（进入 JBLAS 矩阵）的剩余步骤，我将创建第二个问题。

**编辑2：**我将下面的答案标记为已接受，因为我认为我最初的问题结合了太多东西。一旦我弄清楚了剩下的部分，我将尝试用完整的代码更新这个问题，该代码以这个 ByteBuffer 开头并读入 JBLAS 矩阵（这似乎是正确的数据结构）。

如果有人感兴趣，我可以创建一个返回正确排序的字节缓冲区的函数，如下所示：

```
;; This works!
(defn readf [^String file]
  (.order
   (.map
    (.getChannel
     (java.io.RandomAccessFile. file "r"))
    java.nio.channels.FileChannel$MapMode/READ_ONLY 0 (* 1200 1200))
   java.nio.ByteOrder/LITTLE_ENDIAN)) 
```

我发现的 nio 包装器看起来简化/美化了很多，但看起来我要么没有正确使用它，要么有什么问题。用 nio 包装器回顾一下我的发现：

```
;; this works
(def buffer (nio/mmap "/bin/file"))
(def buffer (.order buffer java.nio.ByteOrder/LITTLE_ENDIAN))
(def buffer (.asFloatBuffer buffer))

;; this fails
(def buffer
  (.asFloatBuffer
   (.order
    (nio/mmap "/bin/file")
    java.nio.ByteOrder/LITTLE_ENDIAN))) 
```

可悲的是，这是另一天的 clojure 谜团，或者可能是另一个 StackOverflow 问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T04:12:19.023

打开 a `FileChannel()`，然后获取内存映射缓冲区。网上有很多关于这一步的教程。

`order(endian-ness)`通过调用（不是 的无参数版本）将缓冲区的顺序切换为小端`order`。最后，提取浮点数的最简单方法是调用`asFloatBuffer()`它并使用生成的缓冲区来读取浮点数。

之后，您可以将数据放入您需要的任何结构中。

*编辑*这是一个如何使用 API 的示例。

```
;; first, I created a 96 byte file, then I started the repl
;; put some little endian floats in the file and close it
user=> (def file (java.io.RandomAccessFile. "foo.floats", "rw"))
#'user/file
user=> (def channel (.getChannel file))
#'user/channel
user=> (def buffer (.map channel java.nio.channels.FileChannel$MapMode/READ_WRITE 0 96))
#'user/buffer
user=> (.order buffer java.nio.ByteOrder/LITTLE_ENDIAN)
#<DirectByteBuffer java.nio.DirectByteBuffer[pos=0 lim=96 cap=96]>
user=> (def fbuffer (.asFloatBuffer buffer))
#'user/fbuffer
user=> (.put fbuffer 0 0.0)
#<DirectFloatBufferU java.nio.DirectFloatBufferU[pos=0 lim=24 cap=24]>
user=> (.put fbuffer 1 1.0)
#<DirectFloatBufferU java.nio.DirectFloatBufferU[pos=0 lim=24 cap=24]>
user=> (.put fbuffer 2 2.3)
#<DirectFloatBufferU java.nio.DirectFloatBufferU[pos=0 lim=24 cap=24]>
user=> (.close channel)
nil

;; memory map the file, try reading the floats w/o changing the endianness of the buffer
user=> (def file2 (java.io.RandomAccessFile. "foo.floats" "r"))
#'user/file2
user=> (def channel2 (.getChannel file2))                                                
#'user/channel2
user=> (def buffer2 (.map channel2 java.nio.channels.FileChannel$MapMode/READ_ONLY 0 96))
#'user/buffer2
user=> (def fbuffer2 (.asFloatBuffer buffer2))
#'user/fbuffer2
user=> (.get fbuffer2 0)
0.0
user=> (.get fbuffer2 1)
4.6006E-41
user=> (.get fbuffer2 2)
4.1694193E-8

;; change the order of the buffer and read the floats    
user=> (.order buffer2 java.nio.ByteOrder/LITTLE_ENDIAN)                                 
#<DirectByteBufferR java.nio.DirectByteBufferR[pos=0 lim=96 cap=96]>
user=> (def fbuffer2 (.asFloatBuffer buffer2))
#'user/fbuffer2
user=> (.get fbuffer2 0)
0.0
user=> (.get fbuffer2 1)
1.0
user=> (.get fbuffer2 2)
2.3
user=> (.close channel2)
nil
user=> 
```

# java - Webdriver cssSelector 方法的神秘 MissingMethodException

> ID：13080422
> 
> 赞同：0
> 
> 时间：2012-10-26T03:42:13.823
> 
> 标签：java, groovy, webdriver

通过以下代码在 groovy 中使用 Webdriver 2.25.0：

```
import org.openqa.selenium.By;
...
driver.findElement(By.cssSelector("div.test")) 
```

显示：

```
groovy.lang.MissingMethodException: No signature of method: static org.openqa.selenium.By.cssSelector() is applicable for argument types: (java.lang.String) values: 
```

[文档](http://seleniumhq.org/docs/03_webdriver.html#selenium-webdriver-api-commands-and-operations)声明此方法是有效的。我无法弄清楚这种方法是如何解决的，而“name()”是。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-25T05:29:41.270

终于想通了。我使用的是 HtmlUnitDriver，它[显然](https://groups.google.com/forum/?fromgroups=#!topic/webdriver/om3IR58boGI)没有[实现](http://www.goodercode.com/wp/use-css-selectors-with-htmlunit/)By.cssSelector。您可以想象我的惊讶，因为看似最新的文档[另有说明](http://selenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/By.html)。

我也许可以使用 com.gargoylesoftware.htmlunit.html.DomNode 上的“querySelector”方法来追踪替换功能，但我还没有弄清楚 com.gargoylesoftware.htmlunit 和 org.openqa.selenium.htmlunit 之间的关系。

# android - 将android源代码添加到intellij

> ID：13080427
> 
> 赞同：3
> 
> 时间：2012-10-26T03:43:22.240
> 
> 标签：android, intellij-idea

你如何将android源代码添加到

```
 intelli j 10 
```

以便我可以在 IDE 中浏览 android 代码？是的，这里有一个问答 [How to attach android source in IntelliJ 10?](https://stackoverflow.com/questions/6366503/how-to-attach-android-source-in-intellij-10)

```
but the answer fell short, the last step is 'navigate to the source on your computer!', 
```

源头在哪里？我在哪里下载它？

谢谢

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-10-26T04:27:29.297

如果您使用的是一些旧的 Android 平台，[请查看此答案](https://stackoverflow.com/a/8998234/104891)。

**否则， SDK 管理器**应该已经下载了源代码，并且可以在您的硬盘驱动器的 SDK 文件夹中找到源代码，例如：

```
%ANDROID_SDK%/sources/android-16 
```

该目录可以附加到 IntelliJ IDEA Android SDK。我还建议更新到最新的 IDEA 版本，Android 支持比 IDEA 10 好得多。

# java - 无法运行简单的 android 计算器应用程序

> ID：13080429
> 
> 赞同：1
> 
> 时间：2012-10-26T03:43:53.697
> 
> 标签：java, android

我花了一点时间浏览了一些 Google 的 android 教程，并决定将我自己的简单计算器应用程序放在一起。我对 JAVA 有一点了解，并且在几个 SDK 之前已经搞砸了一点 Android。我认为代码很好，但我就是无法让这个混蛋运行。我一直试图根据我的 LogCat 东西找到答案，但没有运气。首先，这是我的 MainActivity.java：

```
package com.AppliedArgonautics.calculator;

import android.app.Activity;
import android.os.Bundle;
import android.view.Menu;
import android.widget.EditText;
import android.widget.TextView;

public class MainActivity extends Activity {
    EditText editText1 = (EditText)findViewById(R.id.editText1);
    EditText editText2 = (EditText)findViewById(R.id.editText2);
    TextView textView1 = (TextView)findViewById(R.id.textView1);

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
}
public void Add(){
    float num1 = Float.parseFloat(editText1.getText().toString());
    float num2 = Float.parseFloat(editText2.getText().toString());
    float result = num1 + num2;
    textView1.setText(Float.toString(result));
}
public void Subtract(){
    float num1 = Float.parseFloat(editText1.getText().toString());
    float num2 = Float.parseFloat(editText2.getText().toString());
    float result = num1 - num2;
    textView1.setText(Float.toString(result));
}
public void Multiply(){
    float num1 = Float.parseFloat(editText1.getText().toString());
    float num2 = Float.parseFloat(editText2.getText().toString());
    float result = num1 * num2;
    textView1.setText(Float.toString(result));
}
public void Divide(){
    float num1 = Float.parseFloat(editText1.getText().toString());
    float num2 = Float.parseFloat(editText2.getText().toString());
    float result = num1 / num2;
    textView1.setText(Float.toString(result));
}
public void Clear(){
    editText1.setText("");
    editText2.setText("");
    textView1.setText("");
}
} 
```

我的清单文件：

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.AppliedArgonautics.calculator"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="15" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name=".MainActivity"
            android:label="@string/title_activity_main" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>

</manifest> 
```

然后，activity_main.xml

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <Button
        android:id="@+id/button1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_centerVertical="true"
        android:layout_marginLeft="32dp"
        android:onClick="Add"
        android:text="Add" />

    <Button
        android:id="@+id/button3"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/button1"
        android:layout_below="@+id/button1"
        android:layout_marginTop="45dp"
        android:onClick="Multiply"
        android:text="Multiply" />

    <Button
        android:id="@+id/button2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_above="@+id/button3"
        android:layout_alignParentRight="true"
        android:layout_marginRight="28dp"
        android:onClick="Subtract"
        android:text="Subtract" />

    <Button
        android:id="@+id/button4"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignBaseline="@+id/button3"
        android:layout_alignBottom="@+id/button3"
        android:layout_alignLeft="@+id/button2"
        android:onClick="Divide"
        android:text="Divide" />

     <Button
         android:id="@+id/button5"
         android:layout_width="wrap_content"
         android:layout_height="wrap_content"
         android:layout_below="@+id/button1"
         android:layout_centerHorizontal="true"
         android:onClick="Clear"
         android:text="Clear" />

     <EditText
        android:id="@+id/editText1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentTop="true"
        android:layout_alignRight="@+id/button1"
        android:layout_marginTop="37dp"
        android:ems="10"
        android:inputType="phone" >

        <requestFocus />
    </EditText>

    <EditText
        android:id="@+id/editText2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignBottom="@+id/editText1"
        android:layout_alignLeft="@+id/button2"
        android:layout_alignParentRight="true"
        android:layout_alignTop="@+id/editText1"
        android:ems="10"
        android:inputType="phone" />

    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/button5"
        android:layout_below="@+id/editText1"
        android:layout_marginTop="56dp"
        android:text="TextView" />

</RelativeLayout> 
```

这是我尝试运行 LogCat 时显示的内容：

```
/Trace   ( 3186): error opening trace file: No such file or directory (2)
D/AndroidRuntime( 3186): Shutting down VM
W/dalvikvm( 3186): threadid=1: thread exiting with uncaught exception (group=0x40a13300)
E/AndroidRuntime( 3186): FATAL EXCEPTION: main
E/AndroidRuntime( 3186): java.lang.RuntimeException: Unable to instantiate activity           ComponentInfo{com.AppliedArgonautics.calculator/com.AppliedArgonautics.calculator.MainActivi    ty}: java.lang.NullPointerException
E/AndroidRuntime( 3186):    at     android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1983)
E/AndroidRuntime( 3186):    at     android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2084)
E/AndroidRuntime( 3186):    at     android.app.ActivityThread.access$600(ActivityThread.java:130)
E/AndroidRuntime( 3186):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1195)
E/AndroidRuntime( 3186):    at android.os.Handler.dispatchMessage(Handler.java:99)
E/AndroidRuntime( 3186):    at android.os.Looper.loop(Looper.java:137)
E/AndroidRuntime( 3186):    at android.app.ActivityThread.main(ActivityThread.java:4745)
E/AndroidRuntime( 3186):    at java.lang.reflect.Method.invokeNative(Native Method)
E/AndroidRuntime( 3186):    at java.lang.reflect.Method.invoke(Method.java:511)
E/AndroidRuntime( 3186):    at  com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
E/AndroidRuntime( 3186):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
E/AndroidRuntime( 3186):    at dalvik.system.NativeStart.main(Native Method)
E/AndroidRuntime( 3186): Caused by: java.lang.NullPointerException
E/AndroidRuntime( 3186):    at android.app.Activity.findViewById(Activity.java:1825)
E/AndroidRuntime( 3186):    at com.AppliedArgonautics.calculator.MainActivity.<init>(MainActivity.java:10)
E/AndroidRuntime( 3186):    at java.lang.Class.newInstanceImpl(Native Method)
E/AndroidRuntime( 3186):    at java.lang.Class.newInstance(Class.java:1319)
E/AndroidRuntime( 3186):    at  android.app.Instrumentation.newActivity(Instrumentation.java:1053)
E/AndroidRuntime( 3186):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1974)
E/AndroidRuntime( 3186):    ... 11 more
W/ActivityManager(  160):   Force finishing activity com.AppliedArgonautics.calculator/.MainActivity 
```

如果有人可以看看这个，我将不胜感激。我认为学习 android 会很酷，但我对我什至无法启动这样一个简单的程序感到非常沮丧。谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T03:47:02.397

您的代码中可能存在很多问题，但首先要让您开始：

创建`EditText`和`TextView`作为实例变量。将视图分配给`onCreate`.

```
public class MainActivity extends Activity {
        EditText editText1;
        EditText editText2;
        TextView textView1;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
     editText1 = (EditText)findViewById(R.id.editText1);
     editText2 = (EditText)findViewById(R.id.editText2);
     textView1 = (TextView)findViewById(R.id.textView1);
    }
.........
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T04:00:17.903

我加载了您的应用程序，并在调试模式下运行该应用程序。断线了

```
EditText editText1 = (EditText)findViewById(R.id.editText1); 
```

它抛出了一个空指针异常，因为你还没有加载你的布局。这发生在您的 OnCreate 函数中。解决方案是在 SetContentView 命令之后将 findViewById 命令转移到您的 onCreate 函数中。IE：

```
public class MainActivity extends Activity {
    EditText editText1;
    EditText editText2;
    TextView textView1;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    editText1 = (EditText)findViewById(R.id.editText1);
    editText2 = (EditText)findViewById(R.id.editText2);
    textView1 = (TextView)findViewById(R.id.textView1);
} 
```

您的下一个问题是您的 Add、Subtract 等函数都需要采用 View 类型的参数。这是对被单击按钮的引用。（否则在找不到要调用的函数时会出现 IllegalStateException）

然后它会在 Float.parseFloat(editText1.getText().toString()) 上失败，因为 editText 包含空白，而不是数字。您需要强制编辑文本始终具有有效数字，或者修改您的函数以适应空字符串。

从这里祝你好运！:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-26T04:07:50.983

我在这里添加值..您在 xml 中创建了按钮，但没有在 java 代码中使用..我们需要在按钮单击侦听器下做我们的事情...

```
public class MainActivity extends Activity {
    EditText editText1 ;
    EditText editText2 ;
    TextView textView1 ;
    float num1, num2,result;
    Button add;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    editText1 = (EditText)findViewById(R.id.editText1);
    editText2 = (EditText)findViewById(R.id.editText2);
    textView1 = (TextView)findViewById(R.id.textView1);
    add = (Button)findViewById(R.id.button1);
    add.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub
             num1 = Float.parseFloat(editText1.getText().toString());
             num2 = Float.parseFloat(editText2.getText().toString());
             result = num1 + num2;
            textView1.setText(Float.toString(result));
        }
    });
}

} 
```

对所有方法应用相同的东西......

希望，这会帮助你..

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-26T03:57:06.607

写这些

```
EditText editText1; 
EditText editText2;
TextView textView1 ; 
```

而不是这些

```
EditText editText1 = (EditText)findViewById(R.id.editText1);
EditText editText2 = (EditText)findViewById(R.id.editText2);
TextView textView1 = (TextView)findViewById(R.id.textView1); 
```

并改变这个

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
} 
```

至

```
@Override
public void onCreate(Bundle savedInstanceState) {
 super.onCreate(savedInstanceState);
 setContentView(R.layout.activity_main);
 editText1 = (EditText)findViewById(R.id.editText1);
 editText2 = (EditText)findViewById(R.id.editText2);
 textView1 = (TextView)findViewById(R.id.textView1);

} 
```

您收到错误是因为您尝试访问视图而不指定您正在考虑的布局。

```
 setContentView(R.layout.activity_main); 
```

指定您正在考虑的布局

# c++ - OpenGL 优化

> ID：13080431
> 
> 赞同：1
> 
> 时间：2012-10-26T03:43:59.430
> 
> 标签：c++, windows, opengl

我正在尝试使用 OpenGL 渲染 3 个四边形（1 个 bg，2 个精灵）。我有以下代码：

```
void GLRenderer::onDrawObjects(long p_dt)
{
    float _log_last_time = ELAPSED_MS;
    fprintf(stdout, "-- starting draw: %.4f, dTime: %.4f\n", ELAPSED_MS, ELAPSED_MS - _log_last_time);

    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

    for(std::vector<queuedRenderable*>::iterator itr = m_displayList.begin();
        itr != m_displayList.end();
        itr++)
    {
        Sprite* spriteToRender = (*itr)->m_sprite;

        float _log_last_time1 = ELAPSED_MS;
        fprintf(stdout, "---- profiling object: %.4f, dTime: %.4f\n", ELAPSED_MS, ELAPSED_MS - _log_last_time1);

        glMatrixMode( GL_MODELVIEW );
        glLoadIdentity();

        // glTranslate, glRotate, glScale goes here

        fprintf(stdout, "---- transform done: %.4f, dTime: %.4f\n", ELAPSED_MS, ELAPSED_MS - _log_last_time1);
        _log_last_time1 = ELAPSED_MS;

        glEnable(GL_TEXTURE_2D);
        glBindTexture(GL_TEXTURE_2D, (*itr)->m_material->m_glId);

        fprintf(stdout, "---- set material done: %.4f, dTime: %.4f\n", ELAPSED_MS, ELAPSED_MS - _log_last_time1);
        _log_last_time1 = ELAPSED_MS;

        unsigned listIds[] = {
            (*itr)->m_mesh->m_glId
        };
        glCallLists(1, GL_UNSIGNED_INT, listIds);

        fprintf(stdout, "---- draw mesh done: %.4f, dTime: %.4f\n", ELAPSED_MS, ELAPSED_MS - _log_last_time1);
        _log_last_time1 = ELAPSED_MS;
    }

    fprintf(stdout, "-- flushing to card: %.4f, dTime: %.4f\n", ELAPSED_MS, ELAPSED_MS - _log_last_time);
    _log_last_time = ELAPSED_MS;

    glFlush();
    glFinish();

    fprintf(stdout, "-- flush done: %.4f, dTime: %.4f\n", ELAPSED_MS, ELAPSED_MS - _log_last_time);
    _log_last_time = ELAPSED_MS;
} 
```

我在控制台中得到以下结果：

```
-- starting draw: 24000.0000, dTime: 0.0000
---- profiling object: 24014.0000, dTime: 0.0000
---- transform done: 24033.0000, dTime: 19.0000
---- set material done: 24046.0000, dTime: 0.0000
---- draw mesh done: 24066.0000, dTime: 1.0000
---- profiling object: 24084.0000, dTime: 0.0000
---- transform done: 24102.0000, dTime: 18.0000
---- set material done: 24120.0000, dTime: 0.0000
---- draw mesh done: 24305.0000, dTime: 164.0000
---- profiling object: 24319.0000, dTime: 0.0000
---- transform done: 24338.0000, dTime: 19.0000
---- set material done: 24356.0000, dTime: 0.0000
---- draw mesh done: 24375.0000, dTime: 2.0000
-- flushing to card: 24389.0000, dTime: 389.0000
-- flush done: 24424.0000, dTime: 18.0000 
```

如您所见，第二个四边形的绘制需要很长时间（164 毫秒）。我不知道为什么会这样，因为它们都是四边形。我还检查了纹理（如果相关），但它比 bg（第一个四边形）小很多。如果它有任何相关性，我认为第一个四边形应该画得更长，而不是第二个。

我对 OpenGL 相当陌生（过去我做过很多 opengl，但只是初学者的东西）所以我对自己在做什么有*一些*了解。我只是不确定如何进一步优化它以删除 164 毫秒的过程。

如何删除或最小化 164 毫秒的进程？

我必须注意，我正在使用带有英特尔 GMA 450 机器的英特尔凌动。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-26T04:14:04.893

让我们假设这个神秘的`ELAPSED_MS`宏是一个周期精确的 CPU 计数器。我相当怀疑它是这样的，因为它似乎以毫秒为增量跳跃，但让我们假装是这种情况。

您分析 OpenGL 的方法是*完全错误*的。您没有测量渲染四边形所需的时间。您正在测量`glFinish`完成所需的时间。不能保证`glFinish`会在四边形完成渲染时返回。实际上，它可能会等待很长时间，可能是线程任务切换或其他什么。谁知道。

关键是您的分析方法不可靠。请停止使用它们。在 OpenGL 中获取实际渲染操作的分析数据的唯一准确方法是使用[计时器查询](http://www.opengl.org/wiki/Timer_Query#Timer_queries)（专门设计用于测试在 GPU 上完成操作需要多长时间）或使用[专有扩展](http://www.opengl.org/registry/specs/AMD/performance_monitor.txt)。

微分析（如分析绘制四边形所需的时间）很难正确完成。特别是四边形绘图通常不值得打扰分析。

> ELAPSED_MS 是 ((((float)clock()) / CLOCKS_PER_SEC) * 1000.0f)

那太没有帮助了。因为即使您的方法很好，`clock`也不是*进行*任何形式的计时的可靠方法。您必须使用[特定于平台的](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644904%28v=vs.85%29.aspx) [调用](http://pubs.opengroup.org/onlinepubs/9699919799/functions/clock_getres.html)，或者像[C++11 的 chrono](http://en.cppreference.com/w/cpp/chrono)（或 Boost 等价物）这样的平台中立库。

# asp.net-mvc - 参数字典包含方法的不可空类型“System.Int32”的参数“quoteId”的空条目

> ID：13080432
> 
> 赞同：1
> 
> 时间：2012-10-26T03:44:19.957
> 
> 标签：asp.net-mvc, iis

错误完整描述：

```
System.ArgumentException: The parameters dictionary contains a null entry for  
  parameter 'quoteId' of non-nullable type 'System.Int32' for method 
  'System.Web.Mvc.JsonResultGetQuoteSubTotal(Int32, System.String)' 
  in 'NI.Apps.WebSite.OliteBase.Controllers.QuotationController'. 
  An optional parameter must be a reference type, a nullable type,
  or be declared as an optional parameter.
Parameter name: parameters
   at System.Web.Mvc.ActionDescriptor.ExtractParameterFromDictionary(ParameterInfo parameterInfo, IDictionary`2 parameters, MethodInfo methodInfo)
   at System.Linq.Enumerable.WhereSelectArrayIterator`2.MoveNext()
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at System.Web.Mvc.ReflectedActionDescriptor.Execute(ControllerContext controllerContext, IDictionary`2 parameters)
   at System.Web.Mvc.ControllerActionInvoker.InvokeActionMethod(ControllerContext controllerContext, ActionDescriptor actionDescriptor, IDictionary`2 parameters)
   at System.Web.Mvc.ControllerActionInvoker.<>c__DisplayClass15.<InvokeActionMethodWithFilters>b__12()
   at System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodFilter(IActionFilter filter, ActionExecutingContext preContext, Func`1 continuation)
   at System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodWithFilters(ControllerContext controllerContext, IList`1 filters, ActionDescriptor actionDescriptor, IDictionary`2 parameters)
   at System.Web.Mvc.ControllerActionInvoker.InvokeAction(ControllerContext controllerContext, String actionName)
   at System.Web.Mvc.Controller.ExecuteCore()
   at System.Web.Mvc.ControllerBase.Execute(RequestContext requestContext)
   at System.Web.Mvc.MvcHandler.<>c__DisplayClass6.<>c__DisplayClassb.<BeginProcessRequest>b__5()
   at System.Web.Mvc.Async.AsyncResultWrapper.<>c__DisplayClass1.<MakeVoidDelegate>b__0()
   at System.Web.Mvc.MvcHandler.<>c__DisplayClasse.<EndProcessRequest>b__d()
   at System.Web.HttpApplication.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute()
   at System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) 
```

我的旧 Web 服务器上从未发生过该错误。旧的 Web 服务器环境：Windows Server 2003(64bit)/IIS 6/.NET 4。在我将环境升级到：Windows Server 2008R2/IIS 7.5/.NET 4 后，总是抛出错误，但并非所有请求都会导致错误。

所以这个问题是配置问题？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-14T08:19:44.020

当从浏览器发送的请求中缺少必需参数时，会出现此错误。检查期望传递给页面的参数值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T03:51:07.417

这是 unlikley 配置错误。看起来一些传入的请求缺少`quoteId`不是可选的参数。如果您对它们播放相同的请求，两台服务器很可能都会显示此行为（除非代码也不同）。

# php - 如何使用记事本++运行带参数的php文件

> ID：13080433
> 
> 赞同：3
> 
> 时间：2012-10-26T03:44:29.353
> 
> 标签：php, notepad++, nppexec

如何使用**记事本++运行带参数的php文件**

**测试.php**

```
<?php 
    /* ------- 
        test.php
    ------- */
    if(!isset($_GET['file'])){
        exit;
    }
    $code=file_get_contents($_GET['file']);
    echo $code;

?> 
```

* * *

> demo_file.php -----$(FULL_CURRENT_PATH)

内容：

**你好世界**

* * *

```
cd "D:\PHPnow-1.5.6\htdocs\zc_default\my_debug_fw"<br>
"d:\PHPnow-1.5.6\php-5.2.14-Win32\php.exe" "test.php" [what here?] 
```

如何将**“demo_file.php”**`$_GET['file']`发送到**test.php**？

控制台最终应该输出：`...... hello world`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T04:30:49.220

从命令行使用 PHP 时，参数不会作为 $_GET 超全局的一部分传入。它们作为 $_SERVER 的一部分传入 - 超全局，其中 $_SERVER['argc'] 是参数的数量， $_SERVER['argv'] 是参数值的数组。$_SERVER['argv'][0] 是 php 脚本的名称，$_SERVER['argv'][1] 是第一个参数。

```
 if($_SERVER['argc'] < 2){
        exit("Usage: php test.php <file>");
    }

    $code = file_get_contents($_SERVER['argv'][1]); 
```

根据您上面的示例...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-10T11:06:17.350

关闭记事本++后，转到记事本中`%APPDATA%/Notepad++`打开`shortcuts.xml`文件。在追加以下行。

`<Command name="Launch Server" Ctrl="yes" Alt="yes" Shift="no" Key="90">chrome &quot;http://localhost/index.php?file=$(FULL_CURRENT_PATH)&quot;</Command>`

现在将 htdocs 中默认 index.php 的内容更改为

```
<?php
    if (!empty($_SERVER['HTTPS']) && ('on' == $_SERVER['HTTPS']))
    {   $uri = 'https://'; }

    else
    {   $uri = 'http://'; }
    $uri .= $_SERVER['HTTP_HOST'];

    if(isset($_GET['file']))
    {
        $root = $_SERVER['DOCUMENT_ROOT'];
        $file = str_replace('\\', '/', $_GET['file']);
        $file = str_replace($root, '', $file);

        header("Location: http://localhost{$file}");
    }
    else
    {
        header('Location: '.$uri.'/xampp/');
        //header('Location: '.$uri.'/yourproject/');
    }
    exit;
?>
Something is wrong with the XAMPP installation :-( 
```

现在运行Xampp，点击`Notepad++>Run>Launch Server`或使用快捷键`CTRL+ALT+Z`直接运行代码！

# c# - 在 con.Open() 之前测试数据库连接是否正常

> ID：13080436
> 
> 赞同：3
> 
> 时间：2012-10-26T03:44:56.827
> 
> 标签：c#, sql, database, sql-server-ce

我为我的应用程序创建了一个通用数据库处理程序类。

我使用的是本地数据库，所以`SqlCeConnection`这里使用了类。

我想做的是测试连接字符串是否有效，所以在我执行之前更新用户的连接状态`connection.Open();`

让我们说

```
 SqlCeConnection conn = new SqlCeConnection(connectionString);

 //so far we have only created the connection, but not tried to open it
 //Would be nice to update the UI to say that conn is OK
 conn.testConnection();

 conn.Open(); 
```

我正在考虑编写一种尝试连接的方法，`open`我`close`的想法是正确的还是有更好的方法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-26T03:46:50.917

测试连接性会增加额外的开销。为什么不直接打开连接，把代码放进去`Try-Catch`

```
try
{
    conn.Open();
}
catch(SqlCeException ex)
{
    // output the error to see what's going on
    MessageBox.Show(ex.Message); 
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-26T03:53:58.303

您可以使用`DbConnectionStringBuilder`with 属性，如果[连接字符串格式不正确](http://msdn.microsoft.com/en-us/library/system.data.common.dbconnectionstringbuilder.connectionstring.aspx)`ConnectionString`，它将引发异常：

```
public static class Extension
{
    public static void TestConnection(this DbConnection connection)
    {
        var builder = new DbConnectionStringBuilder
            {
                ConnectionString = connection.ConnectionString
            };
    }
} 
```

通过这种方式，您不需要真正打开与数据库的连接。

# ios - CALayer 中的平滑动画孔？

> ID：13080440
> 
> 赞同：2
> 
> 时间：2012-10-26T03:45:26.057
> 
> 标签：ios, core-graphics, calayer, caanimation

好的，我根据 SO 上的各种帖子想出了如何做到这一点，而且效果很好。我正在研究一个覆盖层，它基本上会掩盖整个窗口，除了一个小区域。这是为了引起对我应用程序特定区域的关注。我正在使用一堆这样的调用`moveToPoint:`（`addLineToPoint:`这是在我的 CALayer 子类中`drawInContext:`）：

```
....

// inner path (CW)
[holePath moveToPoint:CGPointMake(x, y)];
[holePath addLineToPoint:CGPointMake(x + w, y)];
[holePath addLineToPoint:CGPointMake(x + w, y + h)];
[holePath addLineToPoint:CGPointMake(x, y+h)];

// outer path (CCW)
[holePath moveToPoint:CGPointMake(xBounds, yBounds)];
[holePath addLineToPoint:CGPointMake(xBounds, yBounds + hBounds)];
[holePath addLineToPoint:CGPointMake(xBounds + wBounds, yBounds + hBounds)];
[holePath addLineToPoint:CGPointMake(xBounds + wBounds, yBounds)];

// put the path in the context
CGContextBeginPath(ctx);
CGContextMoveToPoint(ctx, 0, 0);
CGContextAddPath(ctx, holePath.CGPath);
CGContextClosePath(ctx);

// set the color
CGContextSetFillColorWithColor(ctx, self.overlayColor.CGColor);

// draw the overlay
CGContextDrawPath(ctx, kCGPathFillStroke); 
```

（`holePath`是 的一个实例`UIBezierPath`。）

到目前为止，一切都很好。下一步是动画。为了做到这一点（我也在SO上找到了这种技术）我做了一个方法如下

```
-(CABasicAnimation *)makeAnimationForKey:(NSString *)key {
    CABasicAnimation *anim = [CABasicAnimation animationWithKeyPath:key];
    anim.fromValue = [[self presentationLayer] valueForKey:key];
    anim.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseInEaseOut];
    anim.duration = 0.5;

    return anim;
} 
```

并覆盖`actionForKey:`，`initWithLayer:`和`needsDisplayForKey:`（返回`makeAnimationForKey:`in的结果`actionForKey:`。现在，我得到了一个不错的“洞层”，它具有`holeRect`可使用隐式 CAAnimations 进行动画处理的属性！不幸的是，它非常不稳定。我每秒得到 2 或 3 帧。我以为可能是背景的问题，并尝试将其替换为快照，但没有骰子。然后，我使用 Instruments 进行分析，发现这里的 HUGE hog 是对`CGContextDrawPath()`.

tl;博士我想我的问题归结为：有没有一种更简单的方法来创建这个带有一个洞的图层，这样可以更快地重绘？我的直觉是，如果我可以简化我正在使用的路径，那么绘制路径会更轻松。或者可能掩盖？请帮忙！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-05T06:45:21.680

好的，我尝试了 phix23 的建议，它完全成功了！起初，我是子类化`CALayer`并添加 a`CAShapeLayer`作为子层，但我无法让它正常工作，此时我已经很累了，所以我放弃了，只是将我的子类完全替换为`CAShapeLayer`! 我在自己的方法中使用了上面的代码，返回`UIBezierPath`, 和动画像这样：

```
UIBezierPath* oldPath = [self pathForHoleRect:self.holeRect];
UIBezierPath* newPath = [self pathForHoleRect:rectToHighlight];
self.holeRect = rectToHighlight;

CABasicAnimation *animation = [CABasicAnimation animationWithKeyPath:@"path"];
animation.duration = 0.5;
animation.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseInEaseOut];
animation.fromValue = (id)oldPath.CGPath;
animation.toValue = (id)newPath.CGPath;
[self.holeLayer addAnimation:animation forKey:@"animatePath"];
self.holeLayer.path = newPath.CGPath; 
```

有趣的旁注——`path`不是隐含的动画。我想这是有道理的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-05T03:32:35.767

重绘很昂贵，动画则不然。当您设置“holeRect”的值时，您将指示整个图层重绘。**这与典型的性能优化属性动画不同。**如果图层是整个屏幕的大小，那么您实际上是在每一帧上重新创建一个新版本的图层。这是苹果为确保流畅的动画所做的事情之一。您想尽可能地防止重绘。

我建议创建一个中间有孔的图层，并确保该图层足够大以覆盖整个屏幕，无论孔位于何处。然后动画应该为图层的“位置”属性设置动画。虽然拥有如此庞大的层（其中只有约 30% 一次会被使用）似乎很浪费，但与在每一帧上重绘相比，它的浪费要少得多。如果你想维护你的“holeRect”界面，你可以，但是具有“holeRect”属性的层应该包含一个或多个以我描述的方式动画的子层（在 layoutSubviews 中，而不是 drawInContext:)。

总之，确保您正在为位置、不透明度、变换设置动画，因为这些是图层上最有效的动画之一，并且仅在必要时重绘。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-05T05:00:31.587

在您的示例中，您使用了一个矩形孔。如果您使用四个矩形层（见附图），实现这样的动画可能会更有效。要为孔矩形位置设置动画，您必须为蓝色层的宽度和红色层的高度设置动画。（如果孔矩形可以改变宽度，红色层的宽度也必须进行动画处理）

如果您需要一个非矩形孔，您可以在其中放置另一层，其中有孔并仅更改该层的位置（参见第二张图片）。调整这个非矩形孔的大小将导致只重新创建中间层的内容，所以如果我理解正确的话，它应该比原来的情况要快一点，在原来的情况下，这个层是屏幕大小。

![多层方法](../Images/4a5c9eedb8b9a69867b63f5cbadf9fe4.png) ![多层方法，非矩形孔](../Images/892dfb7bd09f36aa7b2c9c3721e5bbc9.png)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-10-31T08:22:43.347

我发布了一个 anwser，因为由于声誉问题，我（还）无法对您的问题发表评论。

我的问题是这是否必须以编程方式创建？如果只是创建一个注意区域，您可以使用另一种方法。

为什么不直接使用带有透明孔的黑色 png 呢？那么你在动画过程中就不会出现性能问题，并且在某种程度上，如果你选择好原始孔尺寸，你甚至可以调整它的大小。图像必须足够大，以便它独立于孔的当前位置覆盖视图的每个部分。孔外的部分还可以包括透明度，从而在注意力区域之外产生阴影效果。

# c++ - 关于在头文件中声明大小的查询

> ID：13080441
> 
> 赞同：0
> 
> 时间：2012-10-26T03:45:30.003
> 
> 标签：c++, header-files

我有一个包含指向固定大小内存的指针的结构。

说，

```
// Structure of a page
struct Page {
public:
    // Number of slots
    unsigned short numSlots;
    void *data = malloc(PF_PAGE_SIZE);
}; 
```

我想将此声明放在头文件中。我是否也应该明确地将`malloc`部分放入其中，或者它应该只包含`void *data`指针指向的内存量而不包含详细信息？

简而言之，声明应该类似于上面还是类似于以下内容：

```
// Structure of a page
struct Page {
public:
    // Number of slots
    unsigned short numSlots;
    void *data;
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T03:50:20.770

您不能使用第一种语法，它会给您一个编译器错误。
至于正确的方法，答案取决于您使用的是 C 还是 C++。

## 在 C++ 中：

您应该只在头文件中**声明结构成员。**
您在 C++ 源文件的成员初始化列表中对其进行**初始化****[。](https://stackoverflow.com/questions/1711990/what-is-this-weird-colon-member-syntax-in-the-constructor)**

**头文件：**

```
// Structure of a page
struct Page {
public:
    // Number of slots
    unsigned short numSlots;
    void *data;
}; 
```

**源文件：**

```
Page::Page():data(malloc(PF_PAGE_SIZE))
{} 
```

笔记：

*   使用智能指针总是比使用原始指针更好。
*   此外，在 C++ 中，通常会使用`new`而不是`malloc`，但由于您的指针是 type `void`，`malloc`根据使用情况也可能没问题。
*   上面的代码只是回答了你的直接问题，还有其他重要的事情需要考虑。你仍然需要遵循**[三法则，](https://stackoverflow.com/questions/4172722/what-is-the-rule-of-three)**因为你有一个指针成员，可以为你的结构动态分配内存。

## 在 C 中：

在 C 中，没有成员初始化列表，因此您必须在创建结构对象后初始化成员。

**头文件：**

```
// Structure of a page
struct Page {
    // Number of slots
    unsigned short numSlots;
    void *data;
}; 
```

**源文件：**

```
struct Page obj;
obj.data = malloc(PF_PAGE_SIZE); 
```

# php - PHP 将数据发布到 Touchnet

> ID：13080442
> 
> 赞同：0
> 
> 时间：2012-10-26T03:45:37.257
> 
> 标签：php, html, forms, post, curl

在用户在我的网站上注册后，我正试图将用户重定向到 touchnet 的 upay 网站。所以这就是我的网站的样子：

```
Registration.php
     |This is where the user will register for an account along with providing their information
Insert.php
     |This is the script that will take all the data posted from `Registration.php`'s form and insert them into the database. But it is also the script that will send the user to the payment page
touchnet
     |This is the site that will receive the posted data from `Insert.php` and take care of payment. 
```

所以这是我的卷曲设置：

```
$url='https://secure.touchnet.com:*/Something/*/*.jsp';

//open connection
$ch = curl_init();

//set the url, number of POST vars, POST data
curl_setopt($ch,CURLOPT_URL, $url);
curl_setopt($ch,CURLOPT_POST, true);
curl_setopt($ch,CURLOPT_POSTFIELDS, $fields_string);
curl_setopt ($ch, CURLOPT_RETURNTRANSFER, false);

//execute post
$result = curl_exec($ch);

//close connection
curl_close($ch); 
```

但是，当插入完成插入数据并使用 curl 重定向时，它实际上会转到`www.domain.com/Something/tapp`，即`www.domain.com`我的网站。浏览器说`/Something`未找到，显然是因为它甚至没有转到正确的 url。为什么 cURL 无法重定向到正确的 url？

# ruby-on-rails - 生产服务器无法识别 Figaro gem 设置的环境变量

> ID：13080445
> 
> 赞同：6
> 
> 时间：2012-10-26T03:46:16.560
> 
> 标签：ruby-on-rails

我在使用 Figaro gem 设置的外部文件 (config/application.yml) 中设置了 Sendgrid 密码。这在我的本地机器上工作正常，但在我的服务器上我收到一个错误，没有设置密码：

```
ArgumentError (SMTP-AUTH requested but missing secret phrase) 
```

当我将 Sendgrid 配置更改为纯文本密码时，它工作正常，所以我假设 Rails 无法识别环境变量。奇怪的是，当我进入`rails console production`并执行它时，`puts ENV["SENDGRID_PASSWORD"]`它工作正常。

有任何想法吗？

这是我的 Sendgrid 配置：

```
config.action_mailer.smtp_settings = {
  :address              => "smtp.sendgrid.net",
  :port                 => 587,
  :user_name            => "chrislawrence",
  :password             => ENV['SENDGRID_PASSWORD'],
  :domain               => "lakecinema.net.au",
  :authentication       => :plain,
  :enable_starttls_auto => true
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T04:50:44.573

我遇到了同样的问题，不明白为什么 Rails 认为我没有给它一个密码。原来我是`config.action_mailer.smtp_settings`在一个文件中定义的，然后在另一个文件中添加键值组合。问题是我使用`merge`的不是，`merge!`所以我的密码从来没有进入 smtp_settings 而是进入一个临时哈希。

从这次经历中，我了解到您收到的错误消息是 ActionMailer 说“密码在哪里？”的方式。

所以我的猜测是你的问题是[Rails 控制台和 Pow](https://stackoverflow.com/questions/10527372/environment-variable-in-rails-console-and-pow)中的环境变量的逆，其中环境变量在 Rails 服务器上工作，但不在 Rails 控制台中。尝试执行：

```
$ echo "$SENDGRID_PASSWORD" 
```

看看你得到了什么。我感觉未设置 Env 变量，但它只是 Rails 控制台中的局部变量。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2016-06-22T04:02:58.033

它应该是 :authentication => 'plain'

# jquery-templates - 每个中的第一项 - jQuery 模板

> ID：13080446
> 
> 赞同：3
> 
> 时间：2012-10-26T03:46:26.577
> 
> 标签：jquery-templates

我正在尝试编写一个 jQuery 模板，在其中循环遍历一个数组，并且数组的第一个元素产生与其余元素不同的输出

```
<script type='text/x-jquery-tmpl'>
  {{each things}}
    {{if ${index} == 0}}
      <div class='active'>${value}</div>
    {{else}}
      <div class='passive'>${value}</div>
    {{/if}}
  {{/each}}
</script> 
```

和数据：

```
{things: ["Val1", "Val2", ... , "Valn"]} 
```

但`{{if ${index} == 0}}`条件不起作用。如何使模板为数组的第一项与其余项产生不同的输出？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-01-11T15:20:35.180

尝试删除 ${index} 处的花括号

```
{{if $index == 0}} 
```

# javascript - 是否有使用事件委托的 Javascript“点击”事件库？

> ID：13080447
> 
> 赞同：3
> 
> 时间：2012-10-26T03:46:27.823
> 
> 标签：javascript, jquery, mobile, touch

理想情况下我能做到`$(document.body).on("tap", "#myElement", this.eventHandler);`

但是 jQuery 还没有做到这一点。

我看到了很多库——https: [//github.com/bebraw/jswiki/wiki/Touch](https://github.com/bebraw/jswiki/wiki/Touch)。该页面上有一个很长的列表。

他们似乎都使用老式的事件监听。比如，`$("#element").touchLibraryThingy(); $("#element").bind("tap")`。相当于`addEventListener`。

这对于 ID (Sorta) 来说很棒，但是当我有 50 个列表项都包含事件时，我不希望旧 Android 上的某个人有 50 个事件侦听器。出于性能原因！

有谁知道使用*完成*的事件委托的库？

这个 stackoverflow 问题很相似，但不是事实——[扩展 jQuery 的 .on() 以处理移动触摸事件](https://stackoverflow.com/questions/9311079/extend-jquerys-on-to-work-with-mobile-touch-events)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T04:28:08.990

看起来在[扩展 jQuery 的 .on() 以处理移动触摸事件一](https://stackoverflow.com/questions/9311079/extend-jquerys-on-to-work-with-mobile-touch-events)文中提到的 blob实际上可以解决问题……几乎。

图书馆链接！[https://github.com/jvduf/jquery-mobile-events/blob/master/jquery.mobile.events.js](https://github.com/jvduf/jquery-mobile-events/blob/master/jquery.mobile.events.js)

**桌面上的陷阱** “点击”似乎并不能阻止默认设置。我的网络应用程序中有奇怪的滚动行为和断断续续的菜单动画。

为了解决这个问题，我在应用程序的命名空间中创建了一个全局属性：

```
var R = window.R = window.R || {};
R.touchEvent = ('ontouchstart' in window') ? "tap" : "click";
window.$body = $(document.body); 
```

然后我所有的事件监听器都这样做：

```
$body.on(R.touchEvent, ".myHellaLongListItems", this.eventHandler); 
```

完毕！现在我们都可以拥有一个非常好的移动网站。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T00:51:24.450

更好的是，现在使用 jQuery Mobile 自定义构建器，您只能选择他们的移动事件并获取最新的触摸代码，这比上面的示例有所改进。

[http://jquerymobile.com/download-builder/](http://jquerymobile.com/download-builder/)

# php - facebook 移动网站 (getUser(); 总是返回 0)

> ID：13080451
> 
> 赞同：0
> 
> 时间：2012-10-26T03:46:56.823
> 
> 标签：php, facebook, mobile-website

我正在尝试建立一个 Facebook 应用程序（网站和移动网站）。构建后，我发现（ps我使用Facebook php API sdk），

索引.php：

```
<!DOCTYPE html>
<?php
header('P3P:CP="IDC DSP COR ADM DEVi TAIi PSA PSD IVAi IVDi CONi HIS OUR IND CNT"');
require_once('config/facebook.php'); 
```

配置/facebook.php：

```
<?php
//Initializing
require 'facebook-php-sdk/src/facebook.php';
// Create our Application instance (replace this with your appId and secret).
$facebook = new Facebook(array(
            'appId' => 'appId',
            'secret' => 'secret',
        ));
//End of Initializing
// Get User ID
$user = $facebook->getUser();
echo '<script>alert("' . $user . '");</script>'; 
```

PS我更新了最新版的facebook php api sdk

它在网站版本（画布网页）上运行顺畅。但是在移动设备中，它总是返回 0。

谁能帮我？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-04T12:45:22.503

这里没有登录处理逻辑，所以用户总是0。你需要引导用户登录到你的应用程序

```
if ($user) {
  $logoutUrl = $facebook->getLogoutUrl();
} else {
  $loginUrl = $facebook->getLoginUrl();
} 
```

# gnu-screen - GNU Screen：创建或附加到会话并获取文件

> ID：13080452
> 
> 赞同：1
> 
> 时间：2012-10-26T03:46:56.497
> 
> 标签：gnu-screen

使用“screen -D -R -S foo”，可以附加到名为“foo”的现有会话，或者如果所述会话不存在，则创建它。

如何获取包含屏幕命令的文件？

我认为这会起作用：

```
screen -D -R -S foo -X source file 
```

不幸的是，这条消息失败了：

```
No screen session found. 
```

* * *

编辑：正如 zebediah49 在评论中指出的那样，我错误地遗漏了“-X 源文件”中的“源”。现在更新了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T17:11:00.717

好的，仔细阅读我注意到的手册页：

```
 -X   Send the specified command to a running screen  session.  You  can
        use  the  -d or -r option to tell screen to look only for attached
        or detached screen sessions. Note that this command  doesn't  work
        if the session is password protected. 
```

*运行屏幕会话*。换句话说，我不相信你可以像那样只用一个命令就可以做到你想要的。但是，您可以

1.  如果窗口不存在则创建窗口
2.  将命令发送到窗口
3.  连接到窗口：

    NL=$'\n' NAME=foo 屏幕 -ls | grep "$NAME" || screen -d -m -S "$NAME" screen -r "$NAME" -X stuff "源文件$NL" screen -D -R -S "$NAME"

（澄清 -X 的工作原理，从[发送命令到 GNU 屏幕](https://stackoverflow.com/questions/6064548/send-commands-to-a-gnu-screen)）

# php - XML PHP 获取属性及其子值

> ID：13080454
> 
> 赞同：2
> 
> 时间：2012-10-26T03:47:09.910
> 
> 标签：php, xml, children

XML:

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<lessons>
    <lesson level="1" course="2">
                 <name type="Dog" category="Animals">Dog name</name>
          </lesson>
</lessons> 
```

我想像这样保存值：

```
$type = "Dog";
$category = "Animals";
$name = "dog name"; 
```

这就是我所做的：

```
 foreach($xml->name as $name){
        $type = $name['type'];
        $category = $name['category'];

        echo "Type: $type Category: $category<br>";
        // AND TO get the text, haven't figuered it out yet.. <name ..="" ..="">text</name>
    } 
```

但它不起作用。不要得到任何错误或任何输出。有任何想法吗？

编辑：好的。我改变了 foreach($xml->name as $name)

到 foreach($xml->lesson->name as $name)

所以我得到了属性的值。但是现在我不知道如何获得孩子的价值。我试过这个： $xml->lesson->children()

它打印 children()

已解决：$text = $xml->lesson->children(); 回声$文本；

问题是：我在其他代码中使用了 utf-8，但没有更改它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T04:00:39.927

**编辑**：这部分与问题错字有关。 ~~如果您直接从编辑位置复制了 xml，那么问题的一部分可能是它格式错误。您有一个开口`<lessons>`，但您似乎错误地尝试使用`</lesson>`.~~

此外，根据您的根节点设置，`->name`可能是也可能不是 $xml 对象的子节点。你能发布一个`var_dump()`并获得一些线索吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T04:12:36.257

我认为，您的 xml 中存在一些问题。

-> 您必须正确关闭课程标签。因为您输入的是`</lesson>`（见最后一行）而不是`</lessons>`. 如果您开始任何标签，您应该在关闭时使用相同的标签名称。

您可以使用此代码从您的 xml 中提取值，

```
<?php

$xmlstring='<lessons>
    <lesson level="1" course="2">
                 <name type="Dog" category="Animals">Dog name</name>
          </lesson>
</lessons>';

$xml = simplexml_load_string($xmlstring);
$ATTRIBUTE=array();
$counter = 0;
foreach($xml->children() as $key=>$child)
  {
    $counter++;
    $ATTRIBUTE[$counter]["type"]=$child->name->attributes()->type;
    $ATTRIBUTE[$counter]["category"]=$child->name->attributes()->category;
    $ATTRIBUTE[$counter]["value"]= $child->name;
  }

echo "<pre>";
print_r($ATTRIBUTE);
?> 
```

在这里，您将得到数组中的所有内容。所以你可以根据你的要求获取。

# c++ - 嵌入式linux PPC32动态内存检查工具？

> ID：13080455
> 
> 赞同：2
> 
> 时间：2012-10-26T03:47:11.237
> 
> 标签：c++, linux, embedded

系统只有 128 MB 内存，我无法成功运行 valgrind，它只会耗尽内存并且太慢而无法使用。处理器也很慢。

PPC32 上是否有更简单的工具来检查资源非常有限的 PPC 32 的堆损坏/泄漏？

我在想可能像 libsegfault.so 这样的小东西可以与 LD_PRELOAD 一起使用，但是要检查 malloc/free 问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T03:53:49.253

Electric Fence 是这个用例的理想选择（并且可以利用`LD_PRELOAD`，可以与 结合使用`libsegfault.so`）。

除了 efence 之外，您还可以使用其他功能，其中一些最终会花费周期和/或额外的内存开销（尽管仍然可能远低于`valgrind`）：

*   `gcc`的[挡泥板](http://gcc.gnu.org/wiki/Mudflap_Pointer_Debugging)
*   `gcc`的强化源
*   `glibc`的[`mcheck()`](https://www.gnu.org/software/libc/manual/html_node/Heap-Consistency-Checking.html),`MALLOC_CHECK_`
*   `clang`的[地址消毒剂](http://clang.llvm.org/docs/AddressSanitizer.html)

# jquery - RequireJS - 在上下文中隔离 jQuery 版本和插件

> ID：13080463
> 
> 赞同：10
> 
> 时间：2012-10-26T03:48:19.417
> 
> 标签：jquery, jquery-ui, requirejs, requirejs-text

我有一个项目，它利用多个需要上下文和动态加载的 jQuery 版本和插件。（jQuery 版本将集中获取，不会内联）。主机和每个上下文的 jQuery 完整性以及插件隔离是至关重要的。

我正在为 RequireJS 编写一个加载器插件来处理以下用例：

*   在特定的需求上下文中
*   在不影响托管页面的 fn 或任何其他需要上下文的情况下，我想：
    *   加载我需要的任何版本的 jQuery
    *   将插件加载到我的特定 jQuery 版本的 fn 上
    *   在所需的 jQuery 版本上具有引用完整性，以便我的 require 上下文中的任何模块都可以共享插件

[我在这里](https://github.com/leachryanb/getJQuery-require)有一个带有测试的加载器示例项目。

当我使用加载器进行第二次调用时，它在最后一个条件下失败，它正在吹走之前的版本。

我还使用 eval 将加载插件中的 $ 引用隔离到本地加载的 jQuery 版本范围。任何关于更好方法的想法将不胜感激。

如果有更简单/更清洁的解决方案，想要保持简单（愚蠢）。

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-03T23:46:37.000

我还必须在插件中执行此操作。您应该查看[http://api.jquery.com/jQuery.noConflict/](http://api.jquery.com/jQuery.noConflict/)。举个例子：

```
jQueryLocal = jQuery.noConflict(true); 
```

但是你当然应该尽量避免加载多个jQuery。例如，您可以检查是否已经加载了足够的版本（在我的情况下，我在加载任何内容之前检查了 1.9+ 是否可用，如果是，则将局部变量设置为对现有全局 jQuery 对象的简单引用，然后我没有使用插件。

您可以通过以下方式检查版本：

```
var jQueryLocal;
var versions = (jQuery && /^([0-9]+)\.([0-9]+)\./.exec( jQuery.fn.jquery )) || [0,0];
if( versions[0] > 1 || versions[1] >= 9 ) {
    jQueryLocal = jQuery;
} else {
    // load script with whatever you're doing. If it's asynchronous, set callbacks etc.
    jQueryLocal = jQuery.noConflict(true);
} 
```

# sencha-touch-2 - Sencha Touch 2 通过控制器修改 xtype 的属性？

> ID：13080465
> 
> 赞同：0
> 
> 时间：2012-10-26T03:48:29.707
> 
> 标签：sencha-touch-2

我仍然是 Sencha touch 2 中的菜鸟。所以我在这里遇到的问题是我使用的是其他人制作的这个日期时间选择器。我只想能够修改日期时间选择器的属性，但它没有通常的获取或设置方法。

```
 {
                            xtype: 'datetimepickerfield',
                            flex: 1,
                            id: 'approxBedtime',
                            action:'bedtime',
                            width: 110,
                            //placeHolder: '9:00 PM',
                            value: new Date('','','',22,0),
                            dateTimeFormat: 'h:i:A',
                            picker: {
                                useTitles: true,
                                minuteInterval: 1,
                                ampm: true,
                                slotOrder: ['hour', 'minute', 'ampm'],
                            },
                        }, 
```

在我看来，我想在控制器中使用 javascript 修改 ampm，或初始化函数。可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T14:09:00.183

在控制器中（例如，如果您在参考部分中定义：'dateTimePicker'：'#mypicker'）

```
var datetimepicker = this.getDateTimePicker();
var picker = datetimepicker.getPicker();
picker.setAmpm(true); 
```

干杯，奥列格

# iframe - 在 joomla 的文章中设置 iframe

> ID：13080468
> 
> 赞同：0
> 
> 时间：2012-10-26T03:49:21.570
> 
> 标签：iframe, joomla

我是 joomla 的新手。我正在使用 joomla 1.5.26。我创建了一篇文章并尝试在该文章中以 html 模式放置一个 iframe。但是当我试图保存它时，它变成了空白。如何解决这个问题。请帮我。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T07:40:48.783

我认为这是由于文本过滤而发生的。为了防止 Joomla 从您的内容中剥离 HTML，请参见下文（注意：在生产服务器中进行设置时要小心）：

1.  转到文章管理器。
2.  选择“选项”（右上角的按钮）。
3.  在文本过滤器选项下，选择： 过滤器组：选择允许使用 HTML 代码的组，例如超级管理员过滤器类型：白名单/不过滤。

还要检查您的编辑器设置。

# objective-c - 如何最好地设计包装其他代表的自定义代表

> ID：13080470
> 
> 赞同：2
> 
> 时间：2012-10-26T03:50:03.500
> 
> 标签：objective-c, delegates

我对 Objective C 比较陌生，并且有一个关于围绕现有委托创建自定义委托的架构问题。它可能最好用伪代码来描述。抱歉，我无法确定如何使它更简洁。

**总体期望架构总结**

我在某个库中有一个调用 Web 服务的类，该类在 Web 服务异步返回时接受回调委托。这个低级库被包裹在一个门面（一个单例）中以保护客户不知道它，门面方法可以接受一个有效地包装低级库的委托的委托，因此客户可以在门面时将自己分配为委托（本身是一个委托）从 Web 服务调用中获取数据）。

换句话说，客户端实例 A 调用外观 [f makeCallWithDelegate:self]，外观隐藏其内部工作，因此 A 只需实现外观的委托协议。

**伪代码**

低级类：

```
// The low-level class that calls a web service
// LowLevelClass.h
@protocol LowLevelClassDelegate
- (void)success:(LowLevelClass*) c;
@end

@interface LowLevelClass
- (void)makeAsynchronousCallWithDelegate:(id <LowLevelClassDelegate>) d;
@end

// LowLevelClass.m omitted 
```

包装低级类的外观。makeCallWithDelegate 选择器和成功委托回调中指出了该问题：

```
// partial Facade.h
@protocol FacadeDelegate
- (void)success;
@end

@interface Facade <LowLevelClassDelegate>  // the facade handles the delegate calls of the LowLevelClass
...
- (void)makeCallWithDelegate:(id <FacadeDelegate>) d;
...
@end

// Facade.m (pseudocode)
@implementation Facade

- (void)makeCallWithDelegate:(id <FacadeDelegate>) the_delegate {
  LowLevelClass * llc = ... // get instance
  [llc makeAsynchronousCallWithDelegate:self];  // delegate to self, catch events
  // Issue: have to somehow pass the_delegate to the "success" method below,
  // or have it available
}

// LowLevelClassDelegate implementation, hands result to the FacadeDelegate 
- (void)success:(LowLevelClass*) c {
  // Issue: need the_delegate to get down here somehow, or be reachable.
  [the_delegate success]
}

@end 
```

客户端：

```
// Client.m fragment, client implements the FacadeDelegate protocol
...
- (void)makeFacadeGetData {
  [facade makeCallWithDelegate:self];
}

- (void)success {
  NSLog(@"Hooray");
}
... 
```

**回顾**

Client 实例调用外观并将自己作为委托传递。外观依次调用低级类实例，将外观本身作为委托传递。门面听到来自低级类实例的响应，并将更好的结果返回给客户端实例。我正在解决的问题是如何确保在包装低级委托的响应时使用正确的外观委托。

用实例重申上述内容：客户端实例 A 调用外观 [f makeCallWithDelegate:self]。客户端实例 B 也调用外观 [f makeCallWithDelegate:self]。我需要确保客户端 A 用作客户端 A 调用的代表，客户端 B 用作客户端 B 调用的代表。

**影响设计的注释**

不能修改 LowLevelClass。如果可以的话，我可能会传递委托以调用“userdata”字段或其他东西......无论如何我都不喜欢这种方法，因为这会污染具有较高层知识的较低层类类。

外观是一个单例，有几个原因。也许这可以改变，我可以创建多个外观实例。

**可能的解决方案**

A. 现在，如果我可以保证 Facade 一次只被一个客户端使用，我可以将 the_delegate 存储在 Facade 成员变量中，我可以在 Facade success:selector; 中调用它。但是，我不能保证。几个不同的客户端实例可以调用门面，我需要确保每个客户端调用的委托都是客户端本身，而不是其他客户端（使用上面的实例示例，A 需要处理 A 的调用，B 需要处理 B 的调用）。

B. 我可以使外观成为非单例类，并将 the_delegate 存储在成员变量中。也许那是最好的解决方案……不过感觉有些不对劲。

C. 我在想也许我可以为每次调用 makeCallWithDelegate 分配一个唯一的键，并且外观单例实例将存储调用键的字典和为该调用传入的委托。（注意：对我来说唯一有意义的关键是 LowLevelClass 指针的实际值——毕竟，如果我生成一个随机字符串 ID，我只是在推迟这个问题——但这不知何故让人感觉不稳定。） “成功”方法可以访问字典，因此会调用正确的委托：

```
// Facade.m (pseudocode)
@implementation Facade

- (void)makeCallWithDelegate:(id <FacadeDelegate>) the_delegate
{
  LowLevelClass * llc = ... // get instance
  NSString* uniqueKey = makeUniqueKeyFromPointerValue(llc);
  [self.delegateDictionary setObject:the_delegate forKey:uniqueKey];
  [llc makeAsynchronousCallWithDelegate:self];  // delegate to self, catch events
}

// LowLevelClassDelegate implementation, hands result to the FacadeDelegate 
- (void)success:(LowLevelClass*) c
{
  NSString* uniqueKey = makeUniqueKeyFromPointerValue(c);
  id<FacadeDelegate> del = [self.delegateDictionary objectForKey:uniqueKey];
  [del success]
}

@end 
```

我希望以上内容足够详细和清晰。毕竟，我自己感到困惑（再次，目标 C 的新手）。

如果你做到了这一步，我感谢你（并祝贺你）。我想听听关于什么是解决这个问题的好设计的任何建议。

非常感谢你花时间陪伴。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T14:19:21.623

我相信@lnafziger 以上是正确的，B 是最好的答案（将外观更改为常规类，非单例，这也使设计远离单例问题）。在接受这个作为答案之前，我会等着看是否有任何其他建议出现。

# c++ - 在循环中提升 asio 问题

> ID：13080476
> 
> 赞同：0
> 
> 时间：2012-10-26T03:51:21.177
> 
> 标签：c++, boost, boost-asio

有人可以帮我解决以下问题吗？

1.  我试图在 while 循环中调用 async_send 。数据已正确发送到服务器，但根本没有调用 onSend 处理程序......如果我不使用 while 循环，一切正常（数据被发送和接收，所有处理程序都被调用）

2.  如果我们在服务器回答之前的消息之前发送一些消息，我的代码会正常工作吗？

这是TCP客户端代码

```
class TCPClient
{
    public:
        static const size_t maxBufLen = 100;
        static const size_t MAX_INPUT_SIZE = 10;

        TCPClient(boost::asio::io_service& IO_Service, tcp::resolver::iterator EndPointIter);
        void close();

    private:
        boost::asio::io_service& m_IOService;
        tcp::socket m_Socket;

        char recieveBuffer[maxBufLen];

        void promptTxMsgLoop();
        void onConnect(const boost::system::error_code& ErrorCode, tcp::resolver::iterator EndPointIter);
        void onReceive(const boost::system::error_code& ErrorCode);
        void onSend(const boost::system::error_code& ErrorCode);
        void doClose();
};

TCPClient::TCPClient(boost::asio::io_service& IO_Service, tcp::resolver::iterator EndPointIter)
: m_IOService(IO_Service), m_Socket(IO_Service)
{
    tcp::endpoint EndPoint = *EndPointIter;
    recieveBuffer[0] = '\0';

    m_Socket.async_connect(EndPoint,
        boost::bind(&TCPClient::onConnect, this, boost::asio::placeholders::error, ++EndPointIter));
}

void TCPClient::onConnect(const boost::system::error_code& ErrorCode, tcp::resolver::iterator EndPointIter)
{
    if (ErrorCode == 0)
    {
        this->promptTxMsgLoop();
    }
    else if (EndPointIter != tcp::resolver::iterator())
    {
        cout << "m_Socket.close();!" << endl;
        m_Socket.close();
        tcp::endpoint EndPoint = *EndPointIter;

        m_Socket.async_connect(EndPoint, 
            boost::bind(&TCPClient::onConnect, this, boost::asio::placeholders::error, ++EndPointIter));
    }
}

void TCPClient::promptTxMsgLoop()
{
    recieveBuffer[0] = '\0';
    while (true)
    {
        cout << "> " ;
        string tmp;
        cin >> tmp;

        cout << "Entered: " << tmp << endl;
        tmp += "\0";

        if (tmp.length() < MAX_INPUT_SIZE-1)
        {
            try
            {
                //lock untill buffer is emty
                while (strlen(recieveBuffer) > 1)
                {

                }
                //onSend handler is never is called inside while loop 
                m_Socket.async_send(boost::asio::buffer(tmp.c_str(),tmp.length()+1),
                    boost::bind(&TCPClient::onSend, this, boost::asio::placeholders::error));
            }
            catch(exception &e)
            {
                cerr << "Cannot add msg to send queue... " << e.what() << endl;
            }
        }
        else
            cout << "Error: input string is too long. Max length is " << MAX_INPUT_SIZE-1 << endl;
    }
}

void TCPClient::onSend(const boost::system::error_code& ErrorCode)
{
    cout << "Msg has been sent..." << endl;

    if (strlen(recieveBuffer) > 1)
        cout << "ERROR: recieveBuffer in not epmty. Data is overritten!" << endl;

    if (!ErrorCode)
    {
        m_Socket.async_receive(boost::asio::buffer(recieveBuffer, TCPClient::maxBufLen),
            boost::bind(&TCPClient::onReceive, this, boost::asio::placeholders::error));
    }
    else
    {
        cout << "onSend closing" << endl;
        cout << "ERROR! onSend..." << ErrorCode << endl;
        doClose();
    }
}

void TCPClient::onReceive(const boost::system::error_code& ErrorCode)
{
    cout << "Msg has been received..." << endl;

    if (ErrorCode == 0)
    {
        cout << recieveBuffer << endl;
        cout << "msg length: " << strlen(recieveBuffer) << endl;

        //unlock buffer
        recieveBuffer[0] = '\0';
    } 
    else 
    {
        cout << "ERROR! onReceive..." << ErrorCode << endl;
        doClose();
    }
}

void TCPClient::doClose()
{
    m_Socket.close();
}

int main()
{
    try 
    {
        boost::asio::io_service IO_Service;
        tcp::resolver Resolver(IO_Service);
        tcp::resolver::query Query("127.0.0.1", "1");
        tcp::resolver::iterator EndPointIterator = Resolver.resolve(Query);
        TCPClient Client(IO_Service, EndPointIterator);
        boost::thread ClientThread(boost::bind(&boost::asio::io_service::run, &IO_Service));
        ClientThread.join();
        Client.close();
    } 
    catch (exception& e)
    {
        cerr << e.what() << endl;
    }

    cout << "\nClosing";
    getch();

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T05:30:27.793

在你调用的“onConnect”完成处理程序`promptTxMsgLoop`中，它执行一个无限`while`循环，所以你实际上永远不会让它`io_service`继续它的工作——因此不会再调用完成处理程序。

此外，您`async_send`多次调用，而不等待上一个的完成处理程序`async_send`，这也是不正确的。

请参阅 asio 文档以找出正确的使用模式。

# android - 如何获得具有其 id 的图像的名称？

> ID：13080477
> 
> 赞同：0
> 
> 时间：2012-10-26T03:51:25.000
> 
> 标签：android, android-resources

我有一个int数组。这些整数是图片的资源 ID：

```
final int flags[] = new int[] { R.drawable.argentina, R.drawable.austria ... } 
```

和一个包含图像资源名称的字符串：

```
String flag = "R.drawable.argentina"; 
```

如何轻松检查标志字符串是否在标志数组中？

当我从数组中检索一个值并将其分配给变量时，例如：

```
int flag = flag[0]; 
```

这个标志变量将保存一些整数，如 2130837665，这是显而易见的。如何从该数组中检索确切的名称作为字符串，以便将其与标志字符串进行比较？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T05:29:26.747

您可以通过使用获取资源的名称

```
 String name = getResources().getResourceEntryName(flag]); 
```

`argentina`在您的情况下，这仅给出名称

您可以通过以下方式获取类型

```
String type = getResources().getResourceTypeName(flag); 
```

这将`drawable`在您的情况下返回。这样就可以查到id是否对应字符串

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T06:08:42.990

使用此代码

```
public class MainActivity extends Activity {

Button MyTranslateButton;   
private int  image[];   
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);        
  image =new int[]{R.drawable.adv_book,R.drawable.background,R.drawable.bid_active,R.drawable.break_finish};     

    MyTranslateButton = (Button)findViewById(R.id.TranslateButton);

    MyTranslateButton.setOnClickListener(MyTranslateButtonOnClickListener);
}

private Button.OnClickListener MyTranslateButtonOnClickListener
  = new Button.OnClickListener(){
@SuppressWarnings("null")
public void onClick(View v) {
     for(int i=0 ; i < image.length ; i++){     
         String names[]=new String[image.length];
         String name=getResources().getResourceEntryName(image[i]);         
        Log.i("Image Names is ",name);
        names[i]=getResources().getResourceEntryName(image[i]);

      }

}

}; 
```

}

# jquery - 如何使用动态 HTML 将 Fancybox 高度和宽度设置为百分比？

> ID：13080478
> 
> 赞同：1
> 
> 时间：2012-10-26T03:51:29.270
> 
> 标签：jquery, fancybox, overlay

我目前正在使用 Fancybox 2.1.2，想知道如何在我的 Web 应用程序上创建覆盖。我可以设置弹出窗口的高度和宽度（注意...这不是 iframe），它将使用静态值进行调整，但我希望能够将高度设置为动态值，例如 80%。我似乎无法让它工作。当我加载没有设置高度或宽度的fancybox时，我得到了这个非常小的灯箱，它没有达到默认值600px的高度和800px的宽度。这是因为我通过内容方法动态添加了灯箱的 HTML 吗？我还在灯箱加载完成后动态添加内容。目标是为我的应用程序创建一个完整的覆盖，并将高度设置为百分比。

当前代码是：

```
$.fancybox.open({
    'content' : '\
                  <div class="light_box upload">\
                      <div class="title">Your Photos of '+city+'</div>\
                      <div>\
                          <div class="uploadifive-queue" id="uploadifive-upload_photo-queue"></div>\
                      </div>\
                  </div>'
}); 
```

我的CSS是：

```
.light_box.upload{
    width: 980px;
} 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-10-26T09:32:13.767

是的，您可以关闭“autoSize”，然后将宽度设置为“auto”：

```
$.fancybox.open({
    content  : '<div id="test">Lorem ipsum dolor sit ame</div>',
    autoSize : false,
    width    : "auto",
    height   : "80%"
});​ 
```

查看实际操作：http: [//jsfiddle.net/2VmrG/](http://jsfiddle.net/2VmrG/)

# c# - 如何通过两个变化的坐标旋转和调整 PNG 图像的大小？

> ID：13080480
> 
> 赞同：-1
> 
> 时间：2012-10-26T03:51:34.230
> 
> 标签：c#, wpf, image, xaml, system.drawing

如果有一张PNG图像连接两个坐标（像一根绳子），

```
coordinateA.x;
coordinateA.y;

coordinateB.x;
coordinateB.y; 
```

这两个坐标会一直在变化，所以连接两个坐标的PNG图像需要调整大小和旋转。

有任何示例代码可以使这更容易吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T04:48:09.713

这是我的方法：

坐标.cs：

```
public class Coordinates : DependencyObject
{
    public Coordinates(double x, double y)
    {
        X = x;
        Y = y;
    }
    public Coordinates()
    {
        X = 0;
        Y = 0;
    }
    //X Dependency Property
    public double X
    {
        get { return (double)GetValue(XProperty); }
        set { SetValue(XProperty, value); }
    }
    public static readonly DependencyProperty XProperty =
        DependencyProperty.Register("X", typeof(double), typeof(Coordinates), new UIPropertyMetadata(0d));
    //Y Dependency Property
    public double Y
    {
        get { return (double)GetValue(YProperty); }
        set { SetValue(YProperty, value); }
    }
    public static readonly DependencyProperty YProperty =
        DependencyProperty.Register("Y", typeof(double), typeof(Coordinates), new UIPropertyMetadata(0d));
} 
```

几何.cs：

```
public class ConnectorLocationConverter : IMultiValueConverter
{
    public object Convert(object[] values, Type targetType, object parameter, CultureInfo culture)
    {
        var start = (Coordinates)values[0];
        var end = (Coordinates)values[1];
        return new Thickness(start.X, start.Y, 0, 0);
    }
    public object[] ConvertBack(object value, Type[] targetTypes, object parameter, CultureInfo culture)
    {
        return null;
    }
}
public class ConnectorAngleConverter : IMultiValueConverter
{
    public object Convert(object[] values, Type targetType, object parameter, CultureInfo culture)
    {
        var start = (Coordinates)values[0];
        var end = (Coordinates)values[1];
        //dy/dx = tan(t) => t = arcTan(dy/dx)
        double t = Math.Atan2(
                    Math.Abs(start.Y - end.Y),
                    Math.Abs(start.X - end.X)) * 180 / Math.PI;
        if (end.X <= start.X && end.Y >= start.Y) return 180 - t;
        if (end.X >= start.X && end.Y <= start.Y) return -t;
        if (end.X <= start.X && end.Y <= start.Y) return 180 + t;
        return t;
    }
    public object[] ConvertBack(object value, Type[] targetTypes, object parameter, CultureInfo culture)
    {
        return null;
    }
}
public class ConnectorWidthConverter : IMultiValueConverter
{
    public object Convert(object[] values, Type targetType, object parameter, CultureInfo culture)
    {
        var start = (Coordinates)values[0];
        var end = (Coordinates)values[1];
        //get side for states
        return Math.Abs(start.X - end.X);
    }
    public object[] ConvertBack(object value, Type[] targetTypes, object parameter, CultureInfo culture)
    {
        return null;
    }
}
public class ConnectorHeightConverter : IMultiValueConverter
{
    public object Convert(object[] values, Type targetType, object parameter, CultureInfo culture)
    {
        var start = (Coordinates)values[0];
        var end = (Coordinates)values[1];
        //get side for states
        return Math.Abs(start.Y - end.Y);
    }
    public object[] ConvertBack(object value, Type[] targetTypes, object parameter, CultureInfo culture)
    {
        return null;
    }
} 
```

MainWindow.xaml.cs：

```
 //nothing fancy here
    public MainWindow()
    {
        Start = new Coordinates();
        End = new Coordinates();
        DataContext = this;
        InitializeComponent();
    }
    //Start Dependency Property
    public Coordinates Start
    {
        get { return (Coordinates)GetValue(StartProperty); }
        set { SetValue(StartProperty, value); }
    }
    public static readonly DependencyProperty StartProperty =
        DependencyProperty.Register("Start", typeof(Coordinates), typeof(MainWindow), new UIPropertyMetadata(null));
    //End Dependency Property
    public Coordinates End
    {
        get { return (Coordinates)GetValue(EndProperty); }
        set { SetValue(EndProperty, value); }
    }
    public static readonly DependencyProperty EndProperty =
        DependencyProperty.Register("End", typeof(Coordinates), typeof(MainWindow), new UIPropertyMetadata(null));

    //--------------------------------------------------
    //Click causes the mouse position stick to Start/End
    //--------------------------------------------------
    bool flag = false;
    private void Canvas_MouseMove(object sender, MouseEventArgs e)
    {
        var p = e.GetPosition(this);
        if(flag) Start = new Coordinates(p.X, p.Y);
        else End = new Coordinates(p.X, p.Y);
    }

    private void Canvas_MouseDown(object sender, MouseButtonEventArgs e)
    {
        flag = !flag;
    } 
```

最后是 MainWindow.xaml：

```
<Window x:Class="WpfTest.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:WpfTest"
        Title="MainWindow" Height="650" Width="825">
    <Window.Resources>
        <local:ConnectorLocationConverter x:Key="connectorLocationConverter"/>
        <local:ConnectorAngleConverter x:Key="connectorAngleConverter"/>
        <local:ConnectorWidthConverter x:Key="connectorWidthConverter"/>
        <local:ConnectorHeightConverter x:Key="connectorHeightConverter"/>
    </Window.Resources>
    <Canvas Background="#2000"
        MouseMove="Canvas_MouseMove" MouseDown="Canvas_MouseDown">
        <Canvas Width="0" Height="0">
            <Image Source="/WpfTest;component/im.png" Stretch="Fill">

                <Image.Margin>
                    <MultiBinding Converter="{StaticResource connectorLocationConverter}">
                        <Binding Path="Start"/>
                        <Binding Path="End"/>
                    </MultiBinding>
                </Image.Margin>

                <Image.Width>
                    <MultiBinding Converter="{StaticResource connectorWidthConverter}">
                        <Binding Path="Start"/>
                        <Binding Path="End"/>
                    </MultiBinding>
                </Image.Width>

                <Image.Height>
                    <MultiBinding Converter="{StaticResource connectorHeightConverter}">
                        <Binding Path="Start"/>
                        <Binding Path="End"/>
                    </MultiBinding>
                </Image.Height>

                <Image.RenderTransform>
                    <RotateTransform CenterX="0" CenterY="0">
                        <RotateTransform.Angle>
                            <MultiBinding Converter="{StaticResource connectorAngleConverter}">
                                <Binding Path="Start"/>
                                <Binding Path="End"/>
                            </MultiBinding>
                        </RotateTransform.Angle>
                    </RotateTransform>
                </Image.RenderTransform>

            </Image>
        </Canvas>
    </Canvas>
</Window> 
```

# spring - Spring MVC 3 资源标签问题

> ID：13080485
> 
> 赞同：6
> 
> 时间：2012-10-26T03:52:14.360
> 
> 标签：spring, spring-mvc

我正在尝试设置我的第一个 spring 应用程序并想设置静态内容的映射。但是，在加载我的页面时出现以下异常：

```
    org.springframework.beans.factory.parsing.BeanDefinitionParsingException：配置问题：找不到元素的 BeanDefinitionParser [资源]
    违规资源：ServletContext 资源 [/WEB-INF/springMVC-servlet.xml]
        org.springframework.beans.factory.parsing.FailFastProblemReporter.fatal(FailFastProblemReporter.java:59)
        org.springframework.beans.factory.parsing.ReaderContext.fatal(ReaderContext.java:68)
        org.springframework.beans.factory.parsing.ReaderContext.fatal(ReaderContext.java:55)
        org.springframework.beans.factory.xml.NamespaceHandlerSupport.findParserForElement(NamespaceHandlerSupport.java:84)
        org.springframework.beans.factory.xml.NamespaceHandlerSupport.parse(NamespaceHandlerSupport.java:73)
        org.springframework.beans.factory.xml.BeanDefinitionParserDelegate.parseCustomElement(BeanDefinitionParserDelegate.java:1335)
        org.springframework.beans.factory.xml.BeanDefinitionParserDelegate.parseCustomElement(BeanDefinitionParserDelegate.java:1325)
        org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.parseBeanDefinitions(DefaultBeanDefinitionDocumentReader.java:135)
        org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.registerBeanDefinitions(DefaultBeanDefinitionDocumentReader.java:93)
        org.springframework.beans.factory.xml.XmlBeanDefinitionReader.registerBeanDefinitions(XmlBeanDefinitionReader.java:493)
        org.springframework.beans.factory.xml.XmlBeanDefinitionReader.doLoadBeanDefinitions(XmlBeanDefinitionReader.java:390)
        org.springframework.beans.factory.xml.XmlBeanDefinitionReader.loadBeanDefinitions(XmlBeanDefinitionReader.java:334)
        org.springframework.beans.factory.xml.XmlBeanDefinitionReader.loadBeanDefinitions(XmlBeanDefinitionReader.java:302)
        org.springframework.beans.factory.support.AbstractBeanDefinitionReader.loadBeanDefinitions(AbstractBeanDefinitionReader.java:143)
        org.springframework.beans.factory.support.AbstractBeanDefinitionReader.loadBeanDefinitions(AbstractBeanDefinitionReader.java:178)
        org.springframework.beans.factory.support.AbstractBeanDefinitionReader.loadBeanDefinitions(AbstractBeanDefinitionReader.java:149)
        org.springframework.web.context.support.XmlWebApplicationContext.loadBeanDefinitions(XmlWebApplicationContext.java:124)
        org.springframework.web.context.support.XmlWebApplicationContext.loadBeanDefinitions(XmlWebApplicationContext.java:93)
        org.springframework.context.support.AbstractRefreshableApplicationContext.refreshBeanFactory(AbstractRefreshableApplicationContext.java:130)
        org.springframework.context.support.AbstractApplicationContext.obtainFreshBeanFactory(AbstractApplicationContext.java:467)
        org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:397)
        org.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:442)
        org.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:458)
        org.springframework.web.servlet.FrameworkServlet.initWebApplicationContext(FrameworkServlet.java:339)
        org.springframework.web.servlet.FrameworkServlet.initServletBean(FrameworkServlet.java:306)
        org.springframework.web.servlet.HttpServletBean.init(HttpServletBean.java:127)
        javax.servlet.GenericServlet.init(GenericServlet.java:160)
        org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
        org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:99)
        org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:929)
        org.apache.catalina.connector.CoyoteAdapter.service（CoyoteAdapter.java:407）
        org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1002)
        org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:585)
        org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:310)
        java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
        java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
        java.lang.Thread.run(Thread.java:680)

```

我的servlet文件如下：

```

    <?xml 版本="1.0" 编码="UTF-8"?>
        <beans xmlns="http://www.springframework.org/schema/beans"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xmlns:context="http://www.springframework.org/schema/context"
         xmlns:mvc="http://www.springframework.org/schema/mvc"
         xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
          http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.1.xsd
          http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.1.xsd">

            <上下文：组件扫描
                base-package="web.controller" />

         <!-- 通过注解启用 Spring MVC 配置 -->
         <mvc:注解驱动 />
        <!-- 映射静态资源 -->
        <mvc:resources mapping="/css/**" location="/resources/" />
        <mvc:resources mapping="/js/**" location="/js/" />
        <mvc:resources mapping="/img/**" location="/img/" />

```

我在声明中遗漏了什么吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-26T06:41:30.333

您的文件的一个问题是您使用 Spring 3.0 jar，但使用 3.1 xml 架构`mvc`和`context`.

所以：

*   将你的 jar 升级到 spring 3.1，或者
*   使用 3.0 xml 模式，

但不要尝试将 3.1 xml 模式与 3.0 jar 一起使用，那将不起作用。

*顺便说一句，您应该决定是否引用具有显式版本的模式，就像您所做的那样`mvc`，`contect`或者使用 jar 中的最新版本，就像您所做的那样`beans`*

使用（显式）3.0 模式的示例：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
     xmlns:context="http://www.springframework.org/schema/context"
     xmlns:mvc="http://www.springframework.org/schema/mvc"
     xsi:schemaLocation="
      http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
      http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd
      http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd"> 
```

# ios - iOS：如何使用 GHUnit 进行不确定的异步单元测试？

> ID：13080487
> 
> 赞同：0
> 
> 时间：2012-10-26T03:52:38.213
> 
> 标签：ios, unit-testing

我使用 GHUnit 进行单元测试，并编写了 GHAsyncTestCase 的子类，但在我的情况下，Web 服务不像您发送请求并期望收到答案的主动服务请求，而不是这个，我的 Web 服务是被动类型您订阅频道的服务，然后它可以向您发送消息，但不能保证服务器向订阅者推送消息的频率，在这种情况下，订阅后 50 秒，服务器在 30 秒后推送一条消息和另一条消息，那么我应该这样做：

```
[self waitForStatus:kGHUnitWaitStatusSuccess timeout:50.0f]; 
```

验证第一条消息，或者有什么聪明的方法可以做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T09:10:53.367

这取决于你想做什么。如果你想验证来自你的服务器的数据，你可以向服务器发送一个请求，要求它立即推送一些东西并使用

```
[self waitForStatus:kGHUnitWaitStatusSuccess timeout:50.0f]; 
```

等待推送的消息。

如果您想验证您的 Objective-C 代码，您可以向您的对象发送一些虚假数据。如果您使用 NSURLConnection 获取数据，请在测试代码中使用一些假数据调用下面的委托方法

```
- (void)connection:(NSURLConnection *)aConnection didReceiveData:(NSData *)data 
```

单元测试背后的想法是“单元”测试。测试代码应该关注你想要测试的“单元”。从测试中排除其他不可控因素（如网络可用性）是一种很好的做法。

# vim - Vim 病原体不会加载 - E117：未知功能：病原体#infect

> ID：13080490
> 
> 赞同：9
> 
> 时间：2012-10-26T03:53:16.060
> 
> 标签：vim, pathogen

这应该是一个非常简单的问题。我有一个简单的`.vimrc`文件。它总共有 15 行：

```
filetype off
set nocompatible
call pathogen#infect()
syntax on
filetype plugin indent on

set hlsearch
set colorcolumn=79
set number
set list
set expandtab
set tabstop=4
set softtabstop=4

colorscheme vividchalk 
```

但是，当我尝试启动 vim 时，我收到以下错误消息：

```
Error detected while processing /Users/Jon/.vimrc:
line    3:
E117: Unknown function: pathogen#infect
line   15:
E185: Cannot find color scheme 'vividchalk' 
```

我已经工作了很长时间来解决这个问题，包括看这里：[Vim：Pathogen not loading](https://stackoverflow.com/questions/8723464/vim-pathogen-not-loading)和这里：[Pathogen does not load plugins](https://stackoverflow.com/questions/3383502/pathogen-does-not-load-plugins)和这里：[https ://github.com/tpope/vim-pathogen/issues/50](https://github.com/tpope/vim-pathogen/issues/50)

我将我所有与 vim 相关的文件存储在一个`~/.dotfiles/vim/`目录中`.vimrc`，`.gvimrc`并`.vim/`从我的主目录进行符号链接。我尝试加载三个插件：command-t、commentary 和 fugitive。这些插件都是 git 子模块。目录结构如下：

```
.dotfiles/
 ├──vim/
    ├── autoload/
    │   └── pathogen.vim
    ├── bundle/
    │   ├── command-t/
    │   ├── commentary/
    │   └── fugitive/
    ├── colors/
    │   ├── distinguished.vim
    │   └── vividchalk.vim
    ├── ftdetect/
    │   ├── markdown.vim
    │   └── vim.vim
    ├── gvimrc
    ├── snippets/
    │   └── markdown.snippets
    ├── syntax/
    │   ├── markdown.vim
    │   └── python.vim
    ├── test.txt
    └── vimrc 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-26T04:47:54.067

由于vividchalk也无法加载，我猜vim无法访问您的.vim。

你在 OS X 上吗？你在使用[MacVim](http://code.google.com/p/macvim/)吗？

您可能错误地创建了 ~/.vim。我会这样做（使用绝对路径）：

```
ln -s ~/.dotfiles/vim ~/.vim 
```

你可以试试这个：

```
mkdir ~/vim_archive
mv ~/.*vim* ~/vim_archive/.
mkdir -p ~/.vim/colors
cp ~/vim_archive/.vim/colors/vividchalk.vim ~/.vim/colors/.
echo colorscheme vividchalk > ~/.vimrc 
```

如果加载成功，则 vim 正在正确读取您的 vimrc 和 .vim。然后尝试使用链接文件夹。如果可行，则添加病原体并查看它是否加载。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-26T06:01:59.437

最明显的解决方案是将您的`~/.dotfiles/vim`文件夹从该`~/.dotfiles`目录移出到其正常位置和名称：

```
~/.vim 
```

您可以使用 pydave 的答案中的符号链接。

另一种解决方案是将以下行添加到您的`~/.vimrc`：

```
set runtimepath+=~/.dotfiles/vim/autoload (and all the other subdirs) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-13T15:57:33.387

我遇到了同样的问题，最后经过大量的谷歌和调整 vimrc 文件，找到了解决方案。希望下面的代码片段能解决这个问题。

在我的主目录中，所有文件都链接到它们的相关位置，如下所示

`ln -s ~/dotfiles/vim ~/.vim ln -s ~/dotfiles/vim/vimrc ~/.vimrc ln -s ~/dotfiles/bash/bashrc ~/.bashrc ln -s ~/dotfiles/bash/aliases ~/.bash_aliases`

将以下行添加到您的 vimrc 文件中。

`set nocp source /home/ameet/.vim/autoload/pathogen.vim "location of my pathogen.vim call pathogen#infect() call pathogen#helptags()`

# git - “错误：未能将一些参考资料推送到”有什么问题

> ID：13080491
> 
> 赞同：1
> 
> 时间：2012-10-26T03:53:32.623
> 
> 标签：git, branch, push

我将远程分支克隆到本地，
$git clone -b my_branch REMOTE_REPO
进行了一些更改，然后将推回远程分支。
$git push origin master:my_branch

但是推送被拒绝了：

```
Counting objects: 30, done.
Delta compression using up to 4 threads.
Compressing objects: 100% (12/12), done.
Writing objects: 100% (16/16), 4.15 KiB, done.
Total 16 (delta 8), reused 7 (delta 4)
remote: Resolving deltas: 100% (8/8)
remote: Processing changes: done
To ssh://user@gerrit.foo.net:29418/foo.git
 ! [remote rejected] my_branch -> my_branch (non-fast forward)
error: failed to push some refs to 'ssh://user@gerrit.foo.net:29418/foo.git' 
```

那么有什么问题呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T03:56:32.697

在推送到远程存储库之前提交到本地存储库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T04:01:45.107

自从您克隆它以来，其他人在远程存储库中更新了该分支。在推送更改之前，您需要将这些更改拉取并合并到您的分支副本中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T05:45:19.390

```
$git push origin master:my_branch 
```

在这里，您尝试将本地~~repo~~分支推`master`送到远程~~repo~~分支`my_branch`。

如果要将本地~~repo~~分支推`my-branch`送到远程~~repo~~分支`master`，那么命令应该是`$git push origin my_branch:master`.

我想这就是你想做的事情。

# django - Django-guardian - 在哪里分配对象创建的默认权限

> ID：13080500
> 
> 赞同：7
> 
> 时间：2012-10-26T03:54:30.257
> 
> 标签：django, django-permissions

我正在启动一个具有复杂权限结构的应用程序，这将不可避免地由用户自己管理。我在模型中有以下权限：

```
class Meta:
    permissions = (
    ('can_view', 'View project'),
    ('manage_view', 'Can assign View project'),
    ('can_edit', 'Edit project'),
    ('manage_edit', 'Can assign Edit project'),
    ('can_delete', 'Delete project'),
    ('manage_delete', 'Can assign Delete project'),
    ('creator', 'Full access to model features.'),
    ) 
```

这些将使用 Django-guardian 在对象级别进行管理，我正在使用自定义 mixins 来处理所有各种组合和功能。

“创建者”权限分配给对象的初始创建者，他们可以通过基于电子邮件的邀请系统将其他权限分配给用户。

我的问题围绕着为创建对象分配创建者权限的选项。

到目前为止我想到的一些方法：

**保存后在视图中分配**

```
newObject.save()
assign('creator', User, newObject) 
```

一般来说，我更喜欢将这些类型的事件排除在我的观点之外。

**覆盖保存（）**

这种方法的问题是我必须授予对 User 对象的保存访问权限，这意味着还要覆盖**init**以设置 self.request = request。

**post_save 信号**

我知道我可以利用这个信号，但与前两个相比，我还没有尝试过实现它。

希望这能提供足够的洞察力来了解我在哪里做的事情。

我很想知道这些方法中最好的方法是什么，或者，如果它们都是坏主意，那么替代实现可能是什么。

谢谢，

京东

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-07T22:26:07.230

**AD Override save()**：您可以将*用户*参数添加到`save`方法中（因此您也不必重写`init`）。`save`如果您尝试在不传递*用户*实例的情况下调用方法，这种方式代码会在运行时中断（并且只要您测试您的代码，您应该可以使用该方法）。

**AD post_save 信号**：如果你没有尝试过......试试吧！关于信号主题的文档非常好，而且它们很容易学习。可能棘手的是您应该在哪里连接信号（我更喜欢在*模型*模块的末尾这样做）。

不幸的是，您的答案没有最佳方法。另外，请记住，如果您使用原始 SQL 插入实例或执行（[https://docs.djangoproject.com/en/stable/ref/models/querysets/#bulk-create](https://docs.djangoproject.com/en/stable/ref/models/querysets/#bulk-create)） ，则不会触发`save`方法或信号。因此，请确定您希望发生这种自动权限分配的位置（无论如何这应该是一个地方）。`post_save``bulk_create`

**或者**，您可以将指向*创建者*的 FK 字段添加到模型中。您将能够使用该信息而不是检查监护人的许可（并且正如您所指出的那样，使用实际上也应该很好地解决您的问题的混入）。前段时间我将这种方法用于我的项目管理应用程序。

希望有帮助！

[https://docs.djangoproject.com/en/stable/ref/models/querysets/#bulk-create](https://docs.djangoproject.com/en/stable/ref/models/querysets/#bulk-create)

# django - 为 django 覆盖 .htaccess 文件中的 url

> ID：13080501
> 
> 赞同：1
> 
> 时间：2012-10-26T03:54:40.003
> 
> 标签：django, .htaccess, django-urls

我想更改显示的客户端 URL 的结构。我不太熟练使用 .htaccess 文件的正则表达式和编码。基本上，我有一个看起来像这样的结构：

```
www.abc.com/login/?lang=es 
```

我希望它在地址栏中显示为：

`www.abc.com/login/es`

所以请告诉我如何覆盖我的 .htaccess 文件中的现有 url。

谢谢

**编辑**

我的目录列表

`

> 我的项目

------------- >我的申请

------------- >settings/url 目录

> 媒体
> 模板`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T04:40:24.217

您需要做的第一件事是浏览所有代码并将登录链接更改为如下所示：

```
www.abc.com/login/es 
```

它将为您节省额外的连接和重定向。

然后，您需要**www.abc.com**文档根目录中的 htaccess 文件中的规则，以便在发出请求时将客户端重定向`/login/?lang=something`到看起来更漂亮的 URL：

```
RewriteEngine On
RewriteCond %{THE_REQUEST} ^(GET|POST|HEAD)\ /login/?\?lang=([^&\ ]+)
RewriteRule ^ /login/%2? [L,R=301] 
```

然后，您需要规则在内部将看起来更好看的 URL*重写**回*具有查询字符串的 URL：

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^/?login/(.*)$ /login/?lang=$1 [L] 
```

如果基本 URI 已更改（例如，更改`/login`为`/login/es`），您可能需要在登录页面中包含基本 URI，以便相关链接仍能正确解析。您可以通过在页面标题中添加此标签来做到这一点：

```
<base href="/"> 
```

# java - GAE、JDO：添加、移动和删除有序列表的实体

> ID：13080503
> 
> 赞同：0
> 
> 时间：2012-10-26T03:55:07.273
> 
> 标签：java, google-app-engine, jdo

嗨，我有一个父实体说 A，它有一个子实体列表说 List<B> children。

我需要维护子实体的顺序，因为它对我的应用程序很重要。

我使用的方法是： [https ://developers.google.com/appengine/docs/java/datastore/jdo/relationships#Owned_One_to_Many_Relationships](https://developers.google.com/appengine/docs/java/datastore/jdo/relationships#Owned_One_to_Many_Relationships)

有序集合如何维护它们的顺序。

`@Persistent`

 `@Element(dependent = "true")

@Order(extensions = @Extension(vendorName="datanucleus", key="list-ordering", value="index ASC"))` 

`private List objects;`

现在我添加到列表使用：

`newObj.setIndex(0);`

 `for (int i = 0; i < objList.size(); i++) {

objList.get(i).setIndex(i + 1);

}` 

`objList.add(newObj);`

移动使用：

`if (direction.equalsIgnoreCase("up")) {`

 `objList.get(index).setIndex(index - 1);

objList.get(index - 1).setIndex(index);

}

else if (direction.equalsIgnoreCase("down")) {

objList.get(index).setIndex(index + 1);

objList.get(index + 1).setIndex(index);` 

`}`

并删除使用：

`for (int i = index + 1; i < objList.size(); i++) {`

 `objList.get(i).setIndex(i - 1);

}` 

`objList.remove(index);`

这是正确的方法吗？添加和移动似乎工作。但是 Delete 的行为很奇怪。随机对象被删除，列表处于完全不一致的状态！

盖伊：1.7.2

DataNucleus 增强器（版本 3.1.0.m2）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T04:15:58.817

在调整所有索引之前尝试调用 objList.remove() 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T07:44:49.343

**在索引处删除仅对索引**列表（即标准 JDO 列表）有意义，而您没有使用它。当您使用 DataNucleus 和 RDBMS 调用它时，会引发异常。显然 GAE 并没有解决这些细节问题，但是逻辑会暗示它。从有序列表中删除某些东西确实应该调用*remove(Object)*。

使用此索引列的设置移动对象可能会起作用……在下次读入它们时；“排序”子句所做的唯一一件事就是在读入内容时对其进行排序。

# javascript - 正则表达式检查字母、数字和符号

> ID：13080505
> 
> 赞同：0
> 
> 时间：2012-10-26T03:55:24.267
> 
> 标签：javascript, regex

我正在尝试验证 Javascript 中的密码，并要求它有一个字母（大写或小写）、一个数字和一个符号。这是我的正则表达式

```
/(?=.*\d)(?=.*[a-zA-Z])(?=.*\W)/ 
```

这似乎不起作用。有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T04:09:43.630

您缺少几个星号。

`/(?=.*\d)(?=.*[a-zA-Z])(?=.*\W)/`

编辑：问题已被编辑。代码现在按原样工作。

# iphone - 一种实现：两种可能的超类——最干净的方法？

> ID：13080506
> 
> 赞同：0
> 
> 时间：2012-10-26T03:55:25.233
> 
> 标签：iphone, objective-c, inheritance, mkmapview, mkannotationview

我正在开发一个将自定义注释放在 MKMapView 上的模块。我的大部分逻辑目前都在一个继承自 MKAnnotationView 的类中。我已经手动将所有相同的代码复制并粘贴到另一个继承自 MKPinAnnotationView 的类中，因此客户端地图代表可以使用任一自定义子类，具体取决于他们是否需要默认的图钉图像/动​​画。

为了使这段代码更容易维护/调试，我很想干掉这段代码，让我的两个自定义类都继承自同一个类。但是，我还没有找到一个合适的干净的方法来实现这个继承图：

```
CustomAnnotationView              CustomPinAnnotationView
            \                       /
             \                     /
              V                   V
        CustomBaseAnnotationImplementation
            /                      \
           /                        \
          V                          V
 MKAnnotationView              MKPinAnnotationView 
```

我试着做这样的事情：

```
#if UsesPinAnnotationView
#define CustomStandInSuperClass MKPinAnnotationView
#else
#define CustomStandInSuperClass MKAnnotationView
#endif

@interface CustomBaseAnnotationViewImplementation : CustomStandInSuperClass 
```

然后把`#define UsesPinAnnotationView 0`我的`CustomAnnotationView`和`#define UsesPinAnnotationView 1`我的CustomPinAnnotationView放进去，没有一个像我想象的那样工作（我认为它只是使用了预处理器到达的第一个#define并丢弃了另一个#define——最后它使它成为MKAnnotationView的子类在所有情况下，我的代码都成功编译，但随后在无法识别的选择器上崩溃（setAnimatesDrop :)

我一直在研究使用 ObjC Runtime API 在运行时从公共实现文件向我的具体子类添加方法，但这似乎不是一个可行（或必要）的解决方案。

所以，这不是多重继承……它是变量继承。似乎在不规避框架约束的情况下应该可以做到的事情。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T04:31:26.837

你是对的：对运行时等进行黑客攻击对于如此适合更好解决方案的东西来说并不是一个好主意。

通过使用组合而不是继承，您可以将所有可重用逻辑隔离到每个类将包含的另一个类中：

```
CustomAnnotationView              CustomPinAnnotationView
     /      \                        /       \
    /       has a                 has a       \
 is a          V                   V          is a
   \    CustomBaseAnnotationImplementation     /
    \                                         /
     \                                       /
      V                                     V
 MKAnnotationView <----is a -- MKPinAnnotationView 
```

或者，在惯用的 Objective-C 中执行此操作的另一种方法是在 MKAnnotationView 上使用一个类别，该类别定义您的自定义逻辑/动画/hoo-hah，您将其标题导入到 CustomAnnotationView 和 CustomPinAnnotationView 的实现中。这利用了 MKPinAnnotationView 只是一个花哨的 MKAnnotationView 的事实，因此这些方法将在两个类上都可用。

这有帮助吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T04:16:49.057

您正在组合两种不同的预处理器指令方法。

这些中的任何一个都应该适合您：

```
// Method 1:

#define UsesPinAnnotationView
// or #undef UsesPinAnnotationView

#ifdef UsesPinAnnotationView
#define CustomStandInSuperClass MKPinAnnotationView
#else
#define CustomStandInSuperClass MKAnnotationView
#endif 
```

或者

```
// Method 2:

#define UsesPinAnnotationView (1) // or 0 instead of 1

#if(UsesPinAnnotationView)
#define CustomStandInSuperClass MKPinAnnotationView
#else
#define CustomStandInSuperClass MKAnnotationView
#endif 
```

但是请注意，虽然这可以解决您遇到的问题，但有更好的方法可以做到这一点（正如@AndrewPouliot 建议的那样，组合将是一个非常好的选择）。

# jms - 如何使用 JMS 中的消息选择器删除多条消息

> ID：13080511
> 
> 赞同：0
> 
> 时间：2012-10-26T03:56:12.467
> 
> 标签：jms

如何检索具有标头的队列中的所有消息 - "UniqueKey='Tomcat-User'" ，

```
MessageConsumer consumer = session.createConsumer(queue,"UniqueKey='Tomcat-User'");
message = consumer.receiveNoWait(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T12:43:37.227

只需`consumer.receiveNoWait();`在循环内调用：

```
Message message = null;
while((message = consumer.receiveNoWait()) != null); 
```

这将消耗与选择器匹配的所有可用消息。

# php - PHP：Foreach 循环不从零开始

> ID：13080512
> 
> 赞同：0
> 
> 时间：2012-10-26T03:56:18.280
> 
> 标签：php

我有这个变量：

```
$key = 'text1-text2-text3-021-039-947-927-827-927';
$key = explode ('-', $key); 
```

$key 的前三个`($key[0]...$key[2])`总是包含文本，这对我来说不是问题。但其余部分是动态的。

在这种情况下，它的其余部分还包含 6 个变量：`$key[3]...$key[8]`但在其他情况下，根据用户的输入，它可以是 10、9、2 等。

现在的问题是......如何通过使用 FOREACH 循环来回显每个键`$key[3]`？不是`$key[0]`。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T03:59:31.880

试试这样：

```
for($i=3; $i<count($key); $i++){
   echo $key[$i];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T04:09:26.757

试试这个代码你有关键和价值

```
$key = 'text1-text2-text3-021-039-947-927-827-927';
$key = explode ('-', $key);

foreach ($key as $k=>$val)
{
   if($k>=3)
   {
     echo "key=".$k ."and value=".$val;
     echo '<br />';
   }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T04:00:05.207

试试这个片段

```
$isFirst = 1
foreach ($arr as &$value) 
{
    if ($isFirst == 1)
    { 
        $isFirst = 0;
    }
    else
    {
        // do code here
    }
} 
```

为什么不使用`For Loop`？

```
for ($i = 1; $i <= 10; $i++){....} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-26T04:00:36.297

```
$key = 'text1-text2-text3-021-039-947-927-827-927';
$key = explode ('-', $key);

foreach($key as $count=>$values){
  if($count>=3) {
     echo $values."<br/>";
  }    
} 
```

输出=>

```
021
039
947
927
827
927 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-26T04:10:12.833

这可能不是最好的答案，但它只是它的地狱（因为我想提供另一个解决方案使用`foreach`）：

```
$key = 'text1-text2-text3-021-039-947-927-827-927';
$key = explode ('-', $key);

array_shift($key); //remove first element..
array_shift($key); //remove second element..
array_shift($key); //remove third element..

//there you go..
foreach($key as ..) 
```

# image-processing - OpenCV 中的 RotatedRect ROI

> ID：13080515
> 
> 赞同：8
> 
> 时间：2012-10-26T03:56:35.493
> 
> 标签：image-processing, opencv, mask, roi

我有一个[`RotatedRect`](http://opencv.willowgarage.com/documentation/cpp/basic_structures.html)，我想在旋转区域做一些图像处理（比如提取颜色直方图）。我怎样才能获得投资回报率？我的意思是获取区域（像素），以便我可以进行处理。

我找到[了 this](https://stackoverflow.com/questions/6653272/number-of-non-zero-pixels-in-a-cvrotatedrect)，但它通过使用[`getRotationMatrix2D`](http://opencv.willowgarage.com/documentation/cpp/geometric_image_transformations.html?highlight=rotationmatrix#getRotationMatrix2D)and改变了区域[`warpAffine`](http://opencv.willowgarage.com/documentation/cpp/geometric_image_transformations.html?highlight=warpaffine#warpAffine)，所以它不适用于我的情况（我需要处理原始图像像素）。
然后我发现[这](https://stackoverflow.com/questions/9074317/opencv-set-roi-with-angle)建议使用**mask**，这听起来很合理，但任何人都可以教我如何将面具作为下面的绿色 RotatedRect。
![绿色的 RotatedRect 是我想做一些处理的 ROI](../Images/35a8609b1dc165e28342ebc0c2be6a34.png)

除了口罩，还有其他解决办法吗？
感谢您的任何提示

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-31T06:29:43.320

这是我的解决方案，使用**mask**：
想法是`Mat mask`通过将 255 分配给 my来构造 a `RotatedRect ROI`。

如何知道 ROI 中的哪个点（应该分配给 255）？
我使用以下函数`isInROI`来解决这个问题。

```
/** decide whether point p is in the ROI.
*** The ROI is a rotated rectange whose 4 corners are stored in roi[] 
**/
bool isInROI(Point p, Point2f roi[])
{
    double pro[4];
    for(int i=0; i<4; ++i)
    {
        pro[i] = computeProduct(p, roi[i], roi[(i+1)%4]);
    }
    if(pro[0]*pro[2]<0 && pro[1]*pro[3]<0)
    {
        return true;
    }
    return false;
}

/** function pro = kx-y+j, take two points a and b,
*** compute the line argument k and j, then return the pro value
*** so that can be used to determine whether the point p is on the left or right
*** of the line ab
**/
double computeProduct(Point p, Point2f a, Point2f b)
{
    double k = (a.y-b.y) / (a.x-b.x);
    double j = a.y - k*a.x;
    return k*p.x - p.y + j;
} 
```

如何构建**面具**？
使用以下代码。

```
Mat mask = Mat(image.size(), CV_8U, Scalar(0));
for(int i=0; i<image.rows; ++i)
{
    for(int j=0; j<image.cols; ++j)
    {
        Point p = Point(j,i);   // pay attention to the cordination
        if(isInROI(p,vertices))
        {
            mask.at<uchar>(i,j) = 255;
        }
    }
} 
```

完成了，
万岁

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-04-25T20:54:40.010

我发现下面的帖子对做同样的事情非常有用。 [http://answers.opencv.org/question/497/extract-a-rotatedrect-area/](http://answers.opencv.org/question/497/extract-a-rotatedrect-area/)

唯一需要注意的是（a）这里的“角度”假设是围绕整个图像（不是边界框）中心的旋转和（b）在下面的最后一行（我认为）“rect.center”需要转换为旋转图像（通过应用旋转矩阵）。

```
 // rect is the RotatedRect 
    RotatedRect rect;
    // matrices we'll use
    Mat M, rotated, cropped;
    // get angle and size from the bounding box
    float angle = rect.angle;
    Size rect_size = rect.size;
    // thanks to http://felix.abecassis.me/2011/10/opencv-rotation-deskewing/
    if (rect.angle < -45.) {
        angle += 90.0;
        swap(rect_size.width, rect_size.height);
    }
    // get the rotation matrix
    M = getRotationMatrix2D(rect.center, angle, 1.0);
    // perform the affine transformation
    warpAffine(src, rotated, M, src.size(), INTER_CUBIC);
    // crop the resulting image
    getRectSubPix(rotated, rect_size, rect.center, cropped); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-26T21:08:51.923

如果您需要超快的解决方案，我建议：

*   裁剪一个包含您的 RotatedRect 的 Rect `rr`。
*   旋转+翻译回裁剪的图像，使 RotatedRect 现在等效于 Rect。（在旋转和平移 3x3 矩阵的乘积上使用 warpAffine）
*   保留旋转后图像的 roi ( `roi=Rect(Point(0,0), rr.size())`)。

编写起来有点费时，因为您需要计算组合仿射变换。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-02-06T23:56:57.740

如果您不关心速度并且想要为区域的任何形状创建快速原型，您可以使用 openCV 函数 pointPolygonTest() 如果内部点返回正值：

```
double pointPolygonTest(InputArray contour, Point2f pt, bool measureDist) 
```

简单代码：

```
vector<Point2f> contour(4);
contour[0] = Point2f(-10, -10);
contour[1] = Point2f(-10, 10);
contour[2] = Point2f(10, 10);
contour[3] = Point2f(10, -10);    
Point2f pt = Point2f(11, 11);
an double res = pointPolygonTest(contour, pt, false);
if (res>0)
    cout<<"inside"<<endl;
else
    cout<<"outside"<<endl; 
```

# javascript - Javascript Prototype Quirk - 谁能解释一下？

> ID：13080518
> 
> 赞同：5
> 
> 时间：2012-10-26T03:57:36.000
> 
> 标签：javascript, prototypal-inheritance

我对以下代码的期望是，如果我检查了`a.name`，它将搜索原型并在声明时返回它。谁能指出是什么阻止了 JS 承认我的原型？

```
var obj = function(parent){
    return {
        prototype: parent
    }
};

var me = { name: 'keith' };

var a = new obj(me)
// => undefined

a.name
// => undefined

a.prototype.name
// => "keith" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T04:17:35.343

在函数中，您没有触及函数原型。您只是返回一个具有属性“原型”的新对象，其父值作为值。因此，您只能通过该属性访问它。

似乎您正在尝试实现继承，这是一个很好的阅读： JavaScript 中[的原型继承和 JavaScript](http://javascript.crockford.com/prototypal.html)中的[经典继承](http://javascript.crockford.com/inheritance.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T05:37:25.150

一个名为“prototype”的属性只是一个属性，它并不指向该对象所继承的对象。使用[`Object.getPrototypeOf`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/GetPrototypeOf)or[非标准`__proto__`属性](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/proto)来获得它。

因此，您的函数`obj(me)`返回的只是一个具有属性“原型”的对象，该对象指向一个具有属性“名称”的对象，该属性指向字符串`keith`。[`new`由于您的函数返回一个对象，因此无论是否使用关键字](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/new)调用它都没有区别。

对于继承，构造函数 [object] 的“原型”属性值得关注。此构造函数（不返回对象）使用`new`关键字创建的每个对象都继承自*构造函数*的“原型”属性指向的对象。所以你可以这样做：

```
var Constructor = function() {
    console.log(this); // logs the currently created object
    // return nothing
}
Constructor.prototype = { name: 'keith' };

var a = new Constructor(); // logs an empty object
Object.getPrototypeOf(a) === Constructor.prototype; // true
a.name; // "keith" - inherited 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T04:02:29.223

我怀疑您正在`prototype`以类似于覆盖`undefined`“值”的方式覆盖属性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-26T04:42:11.143

这里的问题是您正在返回一个以`prototype`值 parent 命名的属性，它是一个对象，因此您正在返回该对`prototype = {name = 'keith'}`，并且当您调用 new obj 时，您正在添加`a`一个名为 的新属性的原型`prototype`。

你只需要一点改变，我需要这就是你想要做的。这会起作用，只是要小心重载属性。

```
var obj = function(parent){
   for(var propt in parent){
      this[propt] = parent[propt];
   }
}

var me = { name: 'keith' };
var a = new obj(me);
console.log(a);
// => Object { name="keith"}
console.log(a.name);
// => "keith" 
```

编辑：如果你正在寻找使用原型的继承，你应该[阅读这个](https://stackoverflow.com/questions/2064731/good-example-of-javascripts-prototype-based-inheritance)或尝试[TypeScript](http://www.typescriptlang.org/)，一个新的 javascript 类型和 OO 库

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-10-26T04:03:33.783

你似乎用假的原型覆盖了真实的原型。

# cmis - 了解远程 CMIS 文件夹大小的最有效方法

> ID：13080522
> 
> 赞同：0
> 
> 时间：2012-10-26T03:58:53.250
> 
> 标签：cmis

CMIS 文件夹可以包含许多子文件夹和文档，因此它们可以任意大。

我想在下载文件夹之前警告用户。
例如：`You are about to download 35TB. Are you sure?`
它对于进度条也很有用。

了解远程 CMIS 文件夹的递归大小的最有效方法是什么。

[我使用getDecendants](http://chemistry.apache.org/java/0.7.0/maven/apidocs/org/apache/chemistry/opencmis/client/api/Folder.html#getDescendants%28int%29)的天真方法（简化代码）：

```
// Get all descendants
depth = 99999999; // By the way, this is not great
descendants = cmisFolder.getDescendants(depth);

// Add up all sizes
size = 0;
foreach(descendants) {
  size += descendant.getSize();
} 
```

有没有更有效的方法，我和服务器之间的流量更少？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T08:35:32.797

使用查询更有效，因为它允许您过滤非文档对象（例如文件夹）和没有内容的文档。它还返回一个扁平列表，更易于遍历，并且支持分页，如果返回许多文档，这可能对客户端和服务器有所帮助。

# c# - Dapper：映射器查询没有像动态对象映射器查询那样获取值

> ID：13080523
> 
> 赞同：1
> 
> 时间：2012-10-26T03:59:09.040
> 
> 标签：c#, dapper

我是 dapper 的初学者。我正在浏览代码并构建示例。但我在检索数据时遇到问题。我的代码如下

```
 Console.WriteLine("Reading Values");
            string readSatement = "select * from employee where Id=@Id ";
             IEnumerable<Employee> objEmp1 = con.Query<Employee>(readSatement,
                 new {
                     Id = empId
                 });

             var objEmp2 = con.Query(readSatement, new { Id = empId }); 
```

在此代码中，objEmp2 从 db 中检索传递的 id 的值。但是 objEmp1 为对象的属性提供空值。

员工类如下

```
 public  class Employee
    {

      public int EmpId { get; set; }
      public string EmpName { get; set; }
      public int EmpAge { get; set; }
    } 
```

代码有什么问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T04:54:09.300

您需要确保所有数据库列与您用于查询的类中的属性匹配，或者返回名称匹配的列。例如，在您上面的查询中，我相信您可能想这样写：

```
select Id as EmpId, otherColumn as Propertyname, etc.. from employee
where Id = @Id 
```

# asp.net - 大内容的gridview大小增加（水平）

> ID：13080526
> 
> 赞同：1
> 
> 时间：2012-10-26T03:59:49.100
> 
> 标签：asp.net, c#-4.0

我有一个网格视图，当内容很大时它会水平增加。任何人都可以解决这个问题。谢谢我在我的网格视图上应用了这个 css ......

```
table#MainContent_grdAllQuestions
{
  border-style:none; 
  width:100%;
  margin-left:0px;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T04:03:40.127

使用具有固定值的网格的宽度属性。您还可以使用百分比或固定值设置各个列的宽度

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T04:42:30.270

您可以为 gridview 提供固定的，也可以通过指定属性来使用 itemtemplate 指定每个列的宽度。

```
 style="table-layout:fixed;" Width="1000px">  also you can apply style to the gridview 
```

# php - php代码后我的css不起作用

> ID：13080527
> 
> 赞同：1
> 
> 时间：2012-10-26T03:59:54.160
> 
> 标签：php, html, css

我的css在php代码之后不起作用。我必须在 elseif 之后重写整个 html 代码才能使格式正常工作。我已经尝试在 's 中插入 html 代码，但它仍然不会按应有的方式设置样式。我的导航也不会显示。我不明白。

```
if(isset($_POST['sby'])){
  $value = $_POST['sby'];
  if(isset($_POST['search'])){
      if($value == 'cname'){?>
            <!doctype html>
            <head>
            <meta charset="utf-8">
            <title>Untitled Document</title>
            <link href="../../css/style.css" rel="stylesheet" type="text/css" />
            <!--[if lt IE 9]>
            <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
            <![endif]-->
            </head>

            <body>

            <div class="container">
            <header>
              <a href="home.php"><img src="../../img/Intellibest-EMM Logo.jpg" alt="Insert Logo Here" name="Insert_logo" width="180" height="141" id="Insert_logo" style="background-color: #C6D580; display:block;" /></a>
            </header>
            <div class="sidebar1" style="height:auto">
              <ul class="nav">
                <li><a href="../home.php">Home</a></li>
                <li><a href="../look.php">Look For</a></</li>
                <li><a href="../make.php">Make Something</a></li>
                <li><a href="../settings.php">Settings</a></li>
              </ul>
            </div>
            <table>
              <thead id="tbl">
                  <tr>
                  <td><h3>Company Name</h3></td>
                  </tr>
              </thead>
                <?php do { ?>
                <tbody id="result">
                <tr>
                <td>
                  <?php echo $row_get_cname['Company Name'];?>
                </td>
                <?php } while ($row_get_cname = mysql_fetch_assoc($get_cname)); ?>
              </tr>
              </table>
          <?php }
          else if($value == 'ename'){?>

              <table>
              <thead id="tbl">
                  <tr>
                  <td><h3>First Name</h3></td>
                  <td><h3>Last Name</h3></td>
                  <td><h3>Position</h3></td>
                  <td><h3>Company Name</h3></td>
                  </tr>
              </thead>

                  <?php do { ?>
                      <tbody  id="result">
                      <tr>
                      <td>
                          <?php echo $row_get_ename['First Name'].' '.$row_get_ename['Last Name'].'<br>'.$row_get_ename['Position'].'<br>'.$row_get_ename['client companies (pana)`.`Company Name'];?>
                      </td>
                  <?php } while ($row_get_ename = mysql_fetch_assoc($get_ename)); ?>
             </tr>
             </tbody>
             </table>
          <?php }
          else if($value == 'iname'){

              echo "<table>
               <thead id=tbl>
                  <tr>
                  <td><h3>Company Name</h3></td>
                  <td><h3>Industry</h3></td>
                  </tr>
              </thead>";
                do { 
                echo "<tbody id=result>
                <tr>
                <td>";
                echo $row_get_iname['Company Name'].'</td><td>'.$row_get_iname['Industry'];
                echo "</td>";
                 } while ($row_get_iname = mysql_fetch_assoc($get_iname));
              echo "</tr>
              </tbody>
              </table>";    
      }
      else{
          echo "Please enter a valid search quer";  
      }
  }
  else{
      echo "Please define search";
  }
}
else{
  echo "Please enter a search query";
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T04:08:26.397

试试这个：

```
 <!doctype html>
 <head>
 <meta charset="utf-8">
 <title>Untitled Document</title>
 <link href="../../css/style.css" rel="stylesheet" type="text/css" />
 <!--[if lt IE 9]>
 <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
 <![endif]-->
 </head>

 <body>

 <div class="container">
 <header>
  <a href="home.php"><img src="../../img/Intellibest-EMM Logo.jpg" alt="Insert Logo Here" name="Insert_logo" width="180" height="141" id="Insert_logo" style="background-color: #C6D580; display:block;" /></a>
</header>
<div class="sidebar1" style="height:auto">
  <ul class="nav">
    <li><a href="../home.php">Home</a></li>
    <li><a href="../look.php">Look For</a></</li>
    <li><a href="../make.php">Make Something</a></li>
    <li><a href="../settings.php">Settings</a></li>
  </ul>
</div>
<?php
if(isset($_POST['sby'])){
  $value = $_POST['sby'];
  if(isset($_POST['search'])){
      if($value == 'cname'){?> 
```

这样，无论 $value 的值如何，您的页面顶部都会显示出来。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-15T00:27:02.067

我有一个类似的问题。如果它在任何其他类别下，`<a href>`那么不要将样式设置为正常`id`，但您必须将其与类别相同`#something a:hover` ，希望有帮助。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-26T04:06:27.900

尝试编辑这部分：

```
href="../../css/style.css" 
```

并将其更改为

```
href="css/style.css" 
```

或者您可以尝试手动操作

# android - 如何使用 (a) smack 在 Android 上保持 XMPP 连接稳定？

> ID：13080535
> 
> 赞同：27
> 
> 时间：2012-10-26T04:01:15.680
> 
> 标签：android, connection, xmpp, smack

我为 Android 使用 asmack-android-7-beem 库。我有一个后台服务正在运行，例如我的应用程序保持活动状态。但是 XMPP 连接迟早会在没有任何通知的情况下死掉。服务器说客户端仍然在线，但没有发送或接收数据包。

例如，当其他客户端有新的状态时，客户端不会收到任何状态数据包。我将 XMPPConnection 作为我的主要应用程序类的属性。
我`ConnectionConfiguration config.setReconnectionAllowed(true)`在建立连接之前进行了设置。
但重新连接不会发生。`XMPPConnection connection.isConnected()`返回真。

所以客户端不知道连接实际上已经丢失。

有什么办法可以保持连接活跃吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-24T13:37:14.223

使用 asmack 时，在您的应用程序中添加一些类似这样的代码，以使 Dalvik 加载 ReconnectionManager 类并运行它的静态初始化块：

```
static {
    try {
        Class.forName("org.jivesoftware.smack.ReconnectionManager");
    } catch (ClassNotFoundException ex) {
        // problem loading reconnection manager
    }
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-04-26T06:10:28.517

实际上重新连接管理器没有任何问题。首先，您需要将连接侦听器添加到连接管理器。

```
connection.addConnectionListener(new ConnectionListener() {

                    @Override
                    public void reconnectionSuccessful() {
                        Log.i("","Successfully reconnected to the XMPP server.");

                    }

                    @Override
                    public void reconnectionFailed(Exception arg0) {
                        Log.i("","Failed to reconnect to the XMPP server.");
                    }

                    @Override
                    public void reconnectingIn(int seconds) {
                        Log.i("","Reconnecting in " + seconds + " seconds.");
                    }

                    @Override
                    public void connectionClosedOnError(Exception arg0) {
                        Log.i("","Connection to XMPP server was lost.");
                    }

                    @Override
                    public void connectionClosed() {
                        Log.i("","XMPP connection was closed.");

                    }
                }); 
```

如果发生任何错误，连接关闭时将自动调用 connectionClosedOnError(Exception arg0)

```
 public void connectionClosed() {
                        Log.i("","XMPP connection was closed.");
                        //You can manually call reconnection code if you                  want to reconnect on any connection close
                    } 
```

然后检查它，这将调用 reconnectingin() 方法并尝试重新连接。

希望这会对你有所帮助。

使用以下代码检查连接 `PingManager pingManager = PingManager.getInstanceFor(connection); pingManager.setPingInterval(5000);`

添加用于 ping 失败处理的侦听器以处理连接是否连接，因为 isConnected 方法对于检查连接状态不可靠。

`pingManager.registerPingFailedListener(PingFailedListener);`

对于移动网络连接是非常大的问题，因此您需要使用广播接收器检查移动设备的网络连接，并且在数据重新连接时，您可以使用 pingMyServer 方法检查连接是否处于活动状态，如果您从服务器收到 ping 回复，则表示连接处于活动状态否则在 ping 失败时，您可以手动重新连接。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-12-02T07:51:48.557

这是我的代码适用于 ReconnectionManager

1）添加`addConnectionListener`xmpp连接

```
XMPPConnectionListener mConnectionListener = new XMPPConnectionListener(username);
connection.addConnectionListener(mConnectionListener); 
```

2）如果连接关闭，则使用`ReconnectionManager`类自动重新连接

```
 ReconnectionManager reconnectionManager = ReconnectionManager.getInstanceFor(connection);
 reconnectionManager.enableAutomaticReconnection();
 reconnectionManager.setEnabledPerDefault(true); 
```

3)`ConnectionListener`用于重新连接、连接并在服务器上进行身份验证。如果与服务器成功连接身份验证，则还要注册`PingManager`和`ServerPingWithAlarmManager`分类。

```
public class XMPPConnectionListener implements ConnectionListener {
    String username="";
    public XMPPConnectionListener(String username){
        this.username=username;
    }
    @Override
    public void connected(final XMPPConnection connectionObeject) {

        sendPresenceAvailable();
        Log.d(TAG, "xmpp Connected()");
        connected = true;

    }

    @Override
    public void connectionClosed() {

        Log.d(TAG, "xmpp ConnectionCLosed()");

        isAuthenticatedPreviouly=false;
        connected = false;

        loggedin = false;

    }

    @Override
    public void connectionClosedOnError(Exception arg0) {
        Log.d(TAG, "xmpp ConnectionClosedOnError() :"+System.currentTimeMillis());

        isAuthenticatedPreviouly=false;
        connected = false;

        loggedin = false;
    }

    @Override
    public void reconnectingIn(int arg0) {
        Log.d(TAG, "xmpp reconnectingIn() :"+System.currentTimeMillis());

        loggedin = false;
    }

    @Override
    public void reconnectionFailed(Exception arg0) {
        Log.d(TAG, "xmpp ReconnectionFailed!");
        connected = false;

       // chat_created = false;
        loggedin = false;
        try {
            connection.connect();
        } catch (SmackException | IOException | XMPPException | InterruptedException exception) {
            exception.printStackTrace();
        }
    }

    @Override
    public void reconnectionSuccessful() {
        Log.d(TAG, "xmpp ReconnectionSuccessful");
        connected = true;
        sendPresenceAvailable();
        loggedin = false;
    }

    @Override
    public void authenticated(XMPPConnection connection2, boolean resumed) {

        Log.d(TAG, "xmpp Type Main Authenticated() :" + connection.isAuthenticated());

        if(connection.isAuthenticated()) {

            ServerPingWithAlarmManager.getInstanceFor(connection).setEnabled(true);

            PingManager pingManager = PingManager.getInstanceFor(connection);
            pingManager.setPingInterval(10);

            try {
                pingManager.pingMyServer();
                pingManager.pingMyServer(true,10);
                pingManager.pingServerIfNecessary();
                pingManager.registerPingFailedListener(new PingFailedListener() {
                    @Override
                    public void pingFailed() {
                        Log.d("Ping","pingFailed");
                        disconnect();
                        connect();
                    }
                });

            registerAllListener();
     }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-07-20T06:41:18.870

我有同样的问题，除了我的程序在服务器端 JVM 上运行。
我首先使用了 smack 4.0。然后我更新到 smack 4.1，但问题仍然存在。终于找到了一个配置模块：[PingManager](https://www.igniterealtime.org/builds/smack/docs/latest/javadoc/org/jivesoftware/smackx/ping/PingManager.html)
使用这个后，出现这种情况的就是下拉。

```
 connection = new XMPPTCPConnection(config);     
    PingManager pingManager = PingManager.getInstanceFor(connection);
    pingManager.setPingInterval(300); // seconds 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-05-20T18:15:26.563

在 Smack 4.1 中，我使用`ServerPingWithAlarmManager`. 您可以在此处找到有关保持连接活跃[ramzandroid 博客的](https://ramzandroidarchive.wordpress.com/2016/03/14/handling-connection-break-issue-in-smack-4-1/)更多详细信息。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-09-14T23:26:02.110

对于这些情况，您需要手动处理断开连接，我的意思是您应该拦截任何断开连接，当您断开连接时通知连接侦听器。

**public void connectionClosedOnError（异常异常）**

```
 import android.util.Log;

    import com.dagm8.core.protocols.ConnectionState;
    import com.dagm8.core.service.XMPPService;
    import com.dagm8.events.ConnectionStateEvent;

    import org.greenrobot.eventbus.EventBus;
    import org.jivesoftware.smack.ConnectionListener;
    import org.jivesoftware.smack.SmackException;
    import org.jivesoftware.smack.XMPPConnection;
    import org.jivesoftware.smack.XMPPException;
    import org.jivesoftware.smack.tcp.XMPPTCPConnection;

    import java.io.IOException;

    import static com.dagm8.core.protocols.ConnectionState.CONNECTED;
    import static com.dagm8.core.protocols.ConnectionState.DISCONNECTED;
    import static com.dagm8.core.protocols.ConnectionState.RECONNECTING;

    /**
     * dagm8-android
     * Created by Bedoy on 8/28/17.
     */

    public class ConnectionController implements ConnectionListener {

        private String TAG = getClass().getCanonicalName();

        private XMPPTCPConnection mConnection;

        public void setConnection(XMPPTCPConnection connection) {
            mConnection = connection;
        }

        public void init(XMPPTCPConnection connection) throws InterruptedException, XMPPException, SmackException, IOException {

            setConnection(connection);

            mConnection.setPacketReplyTimeout(10000);
            mConnection.addConnectionListener(this);
            mConnection.connect();
        }

        @Override
        public void connected(XMPPConnection connection) {
            XMPPService.connectionState = RECONNECTING;

            notifyConnectionState(RECONNECTING);

            try {
                mConnection.login();
            } catch (XMPPException | SmackException | IOException | InterruptedException e) {
                e.printStackTrace();
            }

            Log.i(TAG, "connected()");
        }

        @Override
        public void authenticated(XMPPConnection connection, boolean resumed) {
            XMPPService.connectionState = CONNECTED;

            notifyConnectionState(CONNECTED);

            Log.i(TAG, "authenticated()");
        }

        @Override
        public void connectionClosed() {
            XMPPService.connectionState = DISCONNECTED;

            notifyConnectionState(DISCONNECTED);

            Log.i(TAG, "connectionClosed()");
        }

        @Override
        public void connectionClosedOnError(Exception e) {
            XMPPService.connectionState = DISCONNECTED;

            notifyConnectionState(DISCONNECTED);

            try {
                mConnection.connect();
            } catch (SmackException | IOException | XMPPException | InterruptedException exception) {
                exception.printStackTrace();
            }
            Log.i(TAG, "connectionClosedOnError()");
        }

        @Override
        public void reconnectingIn(int seconds) {
            XMPPService.connectionState = RECONNECTING;

            notifyConnectionState(RECONNECTING);

            Log.i(TAG, "reconnectingIn()");
        }

        @Override
        public void reconnectionSuccessful() {
            XMPPService.connectionState = CONNECTED;

            notifyConnectionState(CONNECTED);

            Log.i(TAG, "reconnectionSuccessful()");
        }

        @Override
        public void reconnectionFailed(Exception e) {
            XMPPService.connectionState = DISCONNECTED;

            notifyConnectionState(DISCONNECTED);

            Log.i(TAG, "reconnectionFailed()");
        }

        private void notifyConnectionState(ConnectionState state) {
            EventBus.getDefault().post((ConnectionStateEvent) () -> state);
        }

        public boolean isAuthenticated()
        {
            return mConnection.isAuthenticated();
        }

        public void login() {
            try {
                mConnection.login();
            } catch (XMPPException | SmackException | IOException | InterruptedException e) {
                e.printStackTrace();
            }
        }
    } 
```

# android - 是什么导致 Android 的 ContentResolver.query() 返回 null？

> ID：13080540
> 
> 赞同：72
> 
> 时间：2012-10-26T04:02:09.490
> 
> 标签：android

[ContentResolver.query](http://developer.android.com/reference/android/content/ContentResolver.html) ()在什么情况下返回null而不是游标对象？我之前得到了空游标，但刚刚意识到该方法也可以返回 null。不过，我无法追踪发生这种情况的情况。

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2013-04-19T15:43:16.200

由于我今天收到的针对我的应用程序的用户崩溃报告，我偶然发现了同样的问题。如果 Android 文档对某些内容不清楚，则查看源代码会有所帮助。这是我发现的`ContentResolver.query()`返回原因`null`：

1.  无法获取内容提供者。这可能是由于指定的问题`Uri`或因为它根本不存在于系统上。如果 Uri 是问题，原因是：协议不是`content://`或 Uri 没有权限字符串部分（Uri.getAuthority() == null）。

2.  获取的提供者的[查询方法](http://developer.android.com/reference/android/content/ContentProvider.html#query%28android.net.Uri,%20java.lang.String%5B%5D,%20java.lang.String,%20java.lang.String%5B%5D,%20java.lang.String%29)本身返回`null`.

3.  可以获取内容提供程序，但在查询期间引发了[RemoteException 。](http://developer.android.com/reference/android/os/RemoteException.html)

`null`特别是因为（2.），由于没有定义规则，因此可能导致结果的原因几乎是任意的。但通常，如果 SQLite 是 a 的后端，`ContentProvider`您可以期望至少有一些空的 Cursor 对象作为结果，而不仅仅是`null`.

Android 系统`ContentProvider`会在返回任何内容之前进行一些检查。如果输入与预期不符，则不太`null`可能返回。但老实说，这在我以前从未发生过。我通常会遇到`IllegalArgumentException`查询参数问题。`null`如果结果集为空，可能会返回一些 ContentProvider 实现。

无论哪种方式。似乎有必要***始终检查 null***。特别是原因号 (3.) 可能会在任何 Android 设备上发生。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-10-26T05:14:33.007

`ContentResolver.query`如果 uri 方案不属于这种形式`content://`，或者`contentProvider`for 方案本身不存在，则返回 null。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-26T05:15:11.917

> ContentResolver.query() 在以下情况下会返回 null：
> 
> 1.  如果您尝试传递数据库中不存在的列名（一个非常常见的情况是开发人员使用常量作为列名，因为它们看起来与列相似）。
>     
>     
> 2.  它可能为 null，因为您的 URI 参数无效。

在其他情况下，它可能会返回 null。但是，以上两种情况是开发人员拉扯头发的非常常见的原因:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-02-25T16:21:10.250

我有同样的问题。我的错误是不关闭提供者的游标，因此稍后的查询调用会导致 null。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-05-09T17:56:50.537

如果您忘记在清单中声明提供程序，您的查询可能会返回 null。

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2012-10-26T04:29:22.123

如果没有结果，则返回 null。我的意思是说，如果给定的数据库查询没有结果（甚至没有一行数据），那么 query() 将返回 null。

# sql-server - SQL Server 选择更新空值

> ID：13080543
> 
> 赞同：0
> 
> 时间：2012-10-26T04:02:33.703
> 
> 标签：sql-server

您好我尝试`varbinary`使用以下示例更新列中的图像[如何使用 sql server management studio 将 blob 插入数据库](https://stackoverflow.com/questions/1643627/how-to-insert-a-blob-into-a-database-using-sql-server-management-studio)

但是在更新列之后进行选择`varbinary`是空白的，知道为什么会发生这种情况吗？

```
UPDATE digital_files
   SET digital_file = (
        SELECT *
          FROM OPENROWSET( BULK N'C:\Program Files (x86)\Apache Software Foundation\Apache Tomcat 6.0.26\bin\celebrity-pictures-spongebob-patrick-meth-that.jpg',
                           SINGLE_BLOB) AS IMAGE)
WHERE digital_id = 1 
```

# python - Django不断抛出错误时间戳无效

> ID：13080544
> 
> 赞同：1
> 
> 时间：2012-10-26T04:02:34.750
> 
> 标签：python, django

我在模型中有这个

```
timestamp = models.DateTimeField() 
```

形式是这样的

```
timestamp = forms.DateTimeField(input_formats=('%Y-%m-%d %H:%M:%S')) 
```

我正在使用这里[给出的jquery DateTimePicker](http://trentrichardson.com/examples/timepicker/)

```
 $( ".datepicker input" ).datetimepicker({
     dateFormat: 'yy-mm-dd ',
 }); 
```

但是 Django 不断抛出错误`date format not valid`。当我选择一个随机日期时，它有时会起作用。但我不确定它何时起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T07:54:56.063

Django 设置允许您定义日期输入格式。[请参阅此处](https://docs.djangoproject.com/en/dev/ref/settings/#std%3asetting-DATE_FORMAT)的文档。检查您的 jQuery 脚本提交的日期/日期时间格式是否“允许”并在需要时覆盖默认设置。

默认日期时间输入格式为：

```
('%Y-%m-%d %H:%M:%S', '%Y-%m-%d %H:%M', '%Y-%m-%d',
'%m/%d/%Y %H:%M:%S', '%m/%d/%Y %H:%M', '%m/%d/%Y',
'%m/%d/%y %H:%M:%S', '%m/%d/%y %H:%M', '%m/%d/%y') 
```

您发送回服务器的日期显然不符合此规定。

# codeigniter - 使用 foreach 删除对象中的当前项 - CodeIgniter

> ID：13080545
> 
> 赞同：0
> 
> 时间：2012-10-26T04:02:52.310
> 
> 标签：codeigniter, foreach

我正在使用 CodeIgniter 并想在循环中从对象中删除一个项目

```
foreach($query->result() as $row){
     if($row->parent_id == 1){
         // code here to delete current record
    }
} 
```

我想使用 foreach 循环所有记录。如果循环中的当前项满足 if 中的条件，则删除 $query 对象中的当前行。

我可以在 CodeIgniter 中删除 $query 对象中的当前记录还是有其他方法可以做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T04:50:56.433

**在循环中从对象中删除项目**

```
$query = $this->db->query("YOUR QUERY");
$rows = $query->result();
foreach ($rows as $key => $row)
{
  if($row->parent_id == 1){
      unset($rows[$key]);
     // code here to delete current record
  }
}

print_r($rows) // remove row with parent_id = 1 
```

查看更多[@Removing an item from object in a loop](https://stackoverflow.com/questions/7843157/removing-an-item-from-object-in-a-loop)

您还可以更改您的 select 语句以获取 parent_id 不是 eq 1 的所有记录（或其他“where”逻辑来过滤行......请参见下面的示例和链接）

```
$this->db->get('mytable')
$this->db->where('parent_id !=', 1); 
```

或者

```
//get all except parent id 1,4 or 7
$parent_ids = array(1, 4, 7);
$this->db->where_not_in('parent_id', $parent_ids); 
```

**从数据库中删除记录作为您之前的问题标题建议（在 CodeIgniter 中使用 foreach 删除当前记录）**

您可以通过在 sql 中编写条件来使用 sql 查询而不使用任何 php 逻辑来执行此操作...在[http://codeigniter.com/user_guide/database/active_record.html中查看更多信息](http://codeigniter.com/user_guide/database/active_record.html)

例子

```
//delete record where parent_id = 1
$this->db->delete('mytable', array('parent_id' => 1)); 
```

或者

```
//delete record where parent_id = 1 or 5 or 8
$names = array(1, 5, 8);
$this->db->where_in('parent_id', $names);
$this->db->delete('mytable'); 
```

或者

```
//delete record where parent_id = 1
$this->db->where('parent_id', 1);
$this->db->delete('mytable'); 
```

或者

```
//delete all record where parent_id not eq 1
$this->db->where('parent_id !=', 1);

//delete all record where parent_id less than 10
$this->db->where('parent_id <', 10); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T06:48:52.530

进行反转并将其添加到新数组中：

```
$new_result = array();

foreach($query->result() as $row){
    if($row->parent_id != 1){
       $new_result[] = $row;
    }
} 
```

之后使用 $new_result 对象。

ps：在SQL查询中过滤行不是更容易吗？

# java - Java 扫描器未正确存储字符串

> ID：13080546
> 
> 赞同：3
> 
> 时间：2012-10-26T04:03:00.817
> 
> 标签：java

我正在尝试在控制台中创建一个菜单并让用户选择一个选项，由于某种原因，当我运行应用程序时，它会直接转到其他选项，绕过选项广告。

```
import java.util.Scanner;

public class UserChoice {

 public static void main(String[] args) 
{
    boolean status = true;
    while (status == true)
    {
    System.out.println("");
    System.out.println("MENU");
    System.out.println("");
    System.out.println("A : String Functions");
    System.out.println("B : Simple Arithmetic Functions");
    System.out.println("C : Temperature Conversion");
    System.out.println("D : Sequences");
    System.out.println("E : Exit Application");
    System.out.println("");
    System.out.println("Please make a selection.");
            Scanner keyboard = new Scanner(System.in);
    String choice =null;
    choice = keyboard.nextLine();

    if (choice == "a" || choice == "A")
    {
        StringFunctions();
    }

    else if (choice == "b" || choice == "B")
    {
        ArithmeticFunctions();
    }

    else if (choice == "c" || choice == "C")
    {
        TemperatureConversion();
    }

    else if (choice == "d" || choice == "D")
    {
        Sequences();
    }

    else if (choice == "e" || choice == "E")
    {
        System.exit(0);
    }
    else 
    {
        System.out.println("You have entered an invalid selection, please choose again.");

    }
    }

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T04:03:54.977

所有字符串/对象比较都应该使用`equals()`方法而不是`==`（字符串文字除外）

```
if (choice.equals("a") || choice .equals( "A")){....} 
```

也将相同的更改应用于其他 else/if 块。

`==`比较引用相等性。`equals()`方法检查内容是否相等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T04:11:09.557

您可能需要确保至少输入了一个字符：

```
 String choiceString ="";
   while(choiceString.length() <1){
         choiceString = keyboard.nextLine();
   } 
```

完成后，您可能希望从字符串中获取第一个字符：

```
 char choice = choiceString.charAt(0); 
```

现在，由于您的选择是 char，您可以使用单引号编写您的条件，如下所示：

```
 if (choice == 'a' || choice == 'A'){
    .......
    ...... 
```

此外，如果您愿意，您想将输入的字符串的大小写更改为大写或小写，获取字符，然后使用更简单的条件，如下所示：

```
 char choice = choiceString.toUpperCase().charAt(0);
      if (choice == 'A'){ 
       .....
      }else if(... 
```

# php - 如何在 Wordpress 中使用此布局？这是一个非常简单的问题，我只是真的不明白

> ID：13080547
> 
> 赞同：-3
> 
> 时间：2012-10-26T04:03:01.077
> 
> 标签：php, html, css, wordpress, content-management-system

响应式主题的示例网站：http: [//themeid.com/demo/responsive/](http://themeid.com/demo/responsive/)

我想用响应式主题制作一个这样的网站。我已经将它安装在 Wordpress 和所有东西上，但除了简单的博客文章之外，我不知道如何制作任何东西。它快把我逼疯了。

我选择“全宽页面”作为模板，然后输入内容，但我只得到一个基本页面。我怎么做才能有一个主要区域，然后是底部的三个框？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T04:25:45.170

那些“底部的三个框”是小部件。

阅读themeid [http://themeid.com/forum/topic/509/sidebar-widget-management/上的文档](http://themeid.com/forum/topic/509/sidebar-widget-management/)

在 wordpress.org [http://codex.wordpress.org/WordPress_Widgets](http://codex.wordpress.org/WordPress_Widgets)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T04:27:42.327

小部件框的功能可能不在全宽模板中。是否有一个称为主页之类的模板。如果您可能必须使用那个..看起来框是在小部件页面上控制的

# javascript - 如何使 javascript 匹配字符串的开头？

> ID：13080555
> 
> 赞同：0
> 
> 时间：2012-10-26T04:04:57.650
> 
> 标签：javascript

我有以下coce：

```
if (link.action === "Create") { 
```

但是我的 link.action 可能是：

```
Create xxxx 
```

有没有办法我可以改变这个匹配，所以它只是检查开始是“创建”吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T04:06:19.860

只需检查`string.indexOf(string_to_check)`。如果字符串中存在“string_to_check”，它将返回索引号。在您的情况下，您希望字符串以“Create”开头，因此在您的情况下索引应始终为 0。

所以，你可以试试这个

```
if (link.action.indexOf("Create") == 0) { 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T04:05:57.023

使用[正则表达式](https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Regular_Expressions)。

```
if (link.action.match(/^Create/) {

} 
```

`^`是一个特殊字符：一个仅匹配输入开头的锚点。

更多关于正则表达式的阅读：[http ://www.regular-expressions.info](http://www.regular-expressions.info)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-26T04:42:29.690

```
link.action.slice(0,6)=="Create" 
```

也可以按照上述方法工作。进一步阅读[java 脚本中的 String 对象引用](http://www.w3schools.com/jsref/jsref_obj_string.asp)。

# php - 安装 localhost 并出现错误

> ID：13080557
> 
> 赞同：0
> 
> 时间：2012-10-26T04:05:27.430
> 
> 标签：php, apache, cmd

好的，当我通过命令提示符安装 Apache 24 并将此代码放入它的 bin 时。

```
httpd.exe -k install 
```

然后我跑`httpd.exe`

我得到这个错误。

```
AH00558: httpd.exe: Could not reliably determine the server's fully qualified do
main name, using fe80::d939:4e4:4915:276\. Set the 'ServerName' directive globall
y to suppress this message
(OS 10013)An attempt was made to access a socket in a way forbidden by its acces
s permissions.  : AH00072: make_sock: could not bind to address [::]:80
(OS 10013)An attempt was made to access a socket in a way forbidden by its acces
s permissions.  : AH00072: make_sock: could not bind to address 0.0.0.0:80
AH00451: no listening sockets available, shutting down
AH00015: Unable to open logs 
```

然后我**ping 了**使用**80**的端口。我得到 4 的 PID，这是我的系统，带有 NT 内核和系统的描述。

无论如何我可以解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T04:11:32.130

您可以尝试以管理员身份运行命令提示符

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-10T20:58:35.363

端口 80 已被使用，当您尝试在文件 conf/httpd.conf 中修改它时，没有任何变化。我的错误是我假设安装文件夹是我选择通过安装使用的文件夹。如果您转到服务并找到 Apache 服务并检查可执行文件的路径，您会发现它没有指向您认为已安装它的文件夹。但是，如果您在从服务路径获取的文件夹中将 httpd.conf 文件中的“Listen 80”行更改为“Listen 8080”，它很可能允许您启动服务。

# vertica - 如何在 Vertica 中重新分割投影？

> ID：13080558
> 
> 赞同：1
> 
> 时间：2012-10-26T04:05:27.130
> 
> 标签：vertica

我在生产中的一些表上运行了 analyze_workload，对一些表的一个建议是重新分割某些预测。输出告诉我重新分割投影的影响很小。

一个小问题。我在有关执行此操作的文档中找不到任何内容。除了创建新投影和删除旧投影之外，还有其他方法吗？这听起来不像是低影响，所以我会这么认为。

感谢您提前提供任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T04:44:17.187

> 除了创建新投影和删除旧投影之外，还有其他方法吗？

我认为这就是重新细分的意思。投影刷新过程在某个后台处理池上，可以稍微调整其优先级。

就个人而言，我经常选择使用新的投影设计创建一个新表，将数据复制到其中并进行交换。这当然更激烈，但我可以更好地控制它何时发生，而且我对它需要多长时间有更好的直觉。

# c++ - 模板化函数指针从子类到父类的转换

> ID：13080559
> 
> 赞同：0
> 
> 时间：2012-10-26T04:05:31.433
> 
> 标签：c++, templates, inheritance, function-pointers

这是一个涉及继承、模板类和函数指针的问题。我正在开发一个模块化工具，这里是它的最小描述。

我有一个通用基类，我需要尽可能通用（原因未在此处说明）：

```
// base class
class Base {
public:
    virtual void assess( ) = 0;
}; 
```

然后我有一个更专业的派生类，我将其定义为模板：

```
// derived template class
template <typename T>
class Derived : public Base
{
protected:
    T mValue;
public:
    void assess( );
    T value( ) { return mValue; }
};

// function specialization here
template<>
inline void Derived<int>::assess( )
{
    mValue = 3;
} 
```

有些部分是专门的，如`assess()`函数，如上所示。

然后我有一个额外的继承层。主要思想是有一个通用`assess()`函数，该函数涉及一个以`Base`对象为参数的函数指针。

```
// class specialization for special evaluation through function pointers
template <typename T>
class DerivedFuncPtr : public Derived<T> {
protected:
    T (*mFuncPtr)( Base& );
    Base *mFuncVar;
public:
    DerivedFuncPtr<T>( T (*f)(Base&), Base& variable )
    {
        mFuncPtr = f;
        mFuncVar = variable;
    }
    void assess( )
    {
        mFuncVar->assess();
        this->mValue = (*mFuncPtr)(*mFuncVar);
    }
}; 
```

好的，问题是如何使用它。主要来源如下所示：

```
int squared( Derived<int>& );
int squared( Derived<int>& d )
{
    int val = d.value();
    return val*val;
}

int main (int argc, const char * argv[])
{
    Derived<int> object;
    object.assess();
    cout << object.value() << "\n" ;

    DerivedFuncPtr<int> objectFP( squared, object ); // (*)

    return 0;
} 
```

在线编译时出现错误`(*)`

```
Candidate constructor not viable: no known conversion from 'int (Derived<int> &)' to 'int (*)(Base &)' for 1st argument 
```

我是否会被迫将函数指针封装到模板`U (*)(Base&)`类中，还是我在这里遗漏了一些明显的东西？

为了美观，并且因为我真的不熟悉最近的 C++ 演变，我宁愿不使用`boost`库或 C++11，但是，如果不能帮助...谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T04:28:31.220

```
DerivedFuncPtr<T>( T (*f)(Base&), Base& variable ) 
```

构造函数的第一个参数是指向以 a`Base&`作为参数（并返回 a `T`）的函数的指针。`Base&`函数指针的参数与 的参数不匹配，`squared`后者采用`Derived<int>&`.

解决此问题的一种方法是制作`DerivedFuncPtr`一个带有两个模板参数的类模板，一个是`typename T`您已经拥有的，另一个是其他类型名，它将替换`Base`您的数据成员和构造函数中的使用。

`mFuncVar = variable;`顺便说一句，您还会在该构造函数中遇到错误。`mFuncVar`是指针，`variable`是引用。

# php - PHP 如何使用 MYSQL 检索存储在文档根目录之外的图像？

> ID：13080561
> 
> 赞同：1
> 
> 时间：2012-10-26T04:05:41.050
> 
> 标签：php, mysql, image, document-root

我对安全地上传 php 文件和检索这些文件感到非常困惑。出于安全原因，我被告知将上传的图像存储在文档根目录之外。我可以上传好，但我不确定我知道如何最好地提供这些图像，因为我的 MYSQL 和 HTML 结构。这可能是一种愚蠢的做法，但这是我的问题：

我的文档根目录中存储了 5 张图像。在我的 MYSQL 数据库中，我存储了该图像的 URL 路径（例如 www.mywebsite.com/images/123.jpg）。我的 HTML 索引将查询 MYSQL 并选择图像路径，然后列出图像的所有路径，然后显示图像。

但是，我将图像存储在文档根目录之外（出于安全原因）。有没有一种方法可以将像 www.mywebsite.com/images/outofroot.jpg 这样的 URL 路径存储到 MYSQL 中，然后像上面那样进行选择查询？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T04:36:49.543

我很好奇你提到的这些上述“安全原因”是什么，所以如果你能澄清一下，那就太好了！

我的 php 有点生锈，但据我所知，你应该为 jpeg 做这样的事情：

```
header("Content-type: image/jpeg");
$img = imagecreatefromjpeg("/path/to/file.jpg");
imagejpeg($img); 
```

首先，我们将 设置`header`为与 jpeg 图像匹配。接下来，我们将图像加载到内存中`imagecreatefromjpeg`。最后我们为图像服务`imagejpeg`

这个例子只限于jpegs，根据你的使用，你可能需要其他类型。您可以编写一些逻辑（作为练习；））以使这项工作适用于其他类型。查看和 PHP 文档`imagepng`中`imagegif`的其他文档以获取如何执行此操作的信息。

如果您需要进行某种安全检查（例如，用户必须有权查看图片），那么将它们存储在工作目录之外并像这样加载它们是一个好主意。

但是，如果您提供的图像不需要任何权限检查即可访问，那么您最好正常提供它们，而不是让中间人为它们提供服务。

# java - sendTextMessage() 在给出无效电话号码时引发 NullPointerException

> ID：13080562
> 
> 赞同：0
> 
> 时间：2012-10-26T04:05:54.260
> 
> 标签：java, android, sms

我在尝试向无效号码发送短信时收到 NullPointerException（无效是指包含字母字符等的电话号码，而不是停止服务的号码）

我使用的代码来自本教程： http: [//mobiforge.com/developing/story/sms-messaging-android](http://mobiforge.com/developing/story/sms-messaging-android)

```
//---sends an SMS message to another device---
private void sendSMS(String phoneNumber, String message)
{        
    String SENT = "SMS_SENT";
    String DELIVERED = "SMS_DELIVERED";

    PendingIntent sentPI = PendingIntent.getBroadcast(this, 0,
        new Intent(SENT), 0);

    PendingIntent deliveredPI = PendingIntent.getBroadcast(this, 0,
        new Intent(DELIVERED), 0);

    //---when the SMS has been sent---
    registerReceiver(new BroadcastReceiver(){
        @Override
        public void onReceive(Context arg0, Intent arg1) {
            switch (getResultCode())
            {
                case Activity.RESULT_OK:
                    Toast.makeText(getBaseContext(), "SMS sent", 
                            Toast.LENGTH_SHORT).show();
                    break;
                case SmsManager.RESULT_ERROR_GENERIC_FAILURE:
                    Toast.makeText(getBaseContext(), "Generic failure", 
                            Toast.LENGTH_SHORT).show();
                    break;
                case SmsManager.RESULT_ERROR_NO_SERVICE:
                    Toast.makeText(getBaseContext(), "No service", 
                            Toast.LENGTH_SHORT).show();
                    break;
                case SmsManager.RESULT_ERROR_NULL_PDU:
                    Toast.makeText(getBaseContext(), "Null PDU", 
                            Toast.LENGTH_SHORT).show();
                    break;
                case SmsManager.RESULT_ERROR_RADIO_OFF:
                    Toast.makeText(getBaseContext(), "Radio off", 
                            Toast.LENGTH_SHORT).show();
                    break;
            }
        }
    }, new IntentFilter(SENT));

    //---when the SMS has been delivered---
    registerReceiver(new BroadcastReceiver(){
        @Override
        public void onReceive(Context arg0, Intent arg1) {
            switch (getResultCode())
            {
                case Activity.RESULT_OK:
                    Toast.makeText(getBaseContext(), "SMS delivered", 
                            Toast.LENGTH_SHORT).show();
                    break;
                case Activity.RESULT_CANCELED:
                    Toast.makeText(getBaseContext(), "SMS not delivered", 
                            Toast.LENGTH_SHORT).show();
                    break;                        
            }
        }
    }, new IntentFilter(DELIVERED));        

    SmsManager sms = SmsManager.getDefault();
    sms.sendTextMessage(phoneNumber, null, message, sentPI, deliveredPI);        
} 
```

当用户碰巧输入无效的电话号码时让应用程序崩溃并不是最好的。所以我的问题是处理这个问题的好方法是什么？

我可以从这段代码中捕获 NullPointerExceptions 并引发错误 toast，但似乎 NullPointerException 也会引发其他错误，例如，如果消息太长并且应该是多部分的。

另一种 hacky 方法是限制 EditText 只接受数字和“+”字符。

我对这些解决方案中的任何一个都不满意 - 在我看来，理想情况下 sendTextMessage 方法应该引发更多信息异常或为此广播错误代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-27T23:46:13.110

将edittext的输入类型设置为电话号码效果很好。通过“电话号码”输入小部件输入的任何数字组合似乎都不会引发异常（例如“#*,()123”）

在 XML 中：

```
android:inputType="phone" 
```

感谢 awadm 为我指明了正确的方向

# php - 如何使用 Image Magick 模拟 Photoshop 的“颜色”图层透明度？

> ID：13080565
> 
> 赞同：1
> 
> 时间：2012-10-26T04:05:56.200
> 
> 标签：php, imagemagick

因此，在 Photoshop 中有一种称为“颜色”的透明图层模式，它保留下面图层的亮度，但从当前图层获取色调/饱和度。

我需要使用 PHP 动态更改某些图像的颜色，除了通常的乘法/加法/等之外，我无法找到有关执行此操作的算法的任何信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T04:41:17.960

我怀疑该算法是将两个图像从 RGB 转换为 HSV，然后将色调通道复制到基础图像。

ImageMagick 有一个[色调复合](http://www.imagemagick.org/Usage/compose/#hue)运算符，它是[`imagick::COMPOSITE_HUE`](http://www.php.net/manual/en/imagick.constants.php#imagick.constants.composite-hue)在 PHP 中的。根据[此处的评论](http://www.php.net/manual/en/imagick.compositeimage.php)，这应该有效：

```
<?php

$img1 = new Imagick("image1.png");
$img2 = new Imagick("image2.png");

$img1->compositeImage($img2, imagick::COMPOSITE_HUE, 0, 0);

header('Content-type: image/png');
echo $img1;

?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-03-17T17:55:11.723

有一个库可以帮助您满足“photoshop”风格要求。它被称为[pslayers](https://github.com/darrynten/pslayers)。

您可以使用任何您想要的混合模式，并根据需要堆叠任意数量的图层。它也支持过滤。

# ruby-on-rails - Rails 迷你裙在第二次运行时重复

> ID：13080567
> 
> 赞同：0
> 
> 时间：2012-10-26T04:06:24.013
> 
> 标签：ruby-on-rails, testing, factory, minitest, miniskirt

我目前正在一个非常基本的 rails 3.2 应用程序中运行 miniskirt 和 minitest。我遇到的问题是，如果我在同一个“describe”子句中声明两个“it”测试，那么 setup 方法中的迷你裙数据会被创建两次。我正在使用 Ryan Bates 在第 327 集中概述的设置。

```
def setup
    @res_a = Factory(:reservation)
    @res_b = Factory(:reservation)
end 
```

当我使用 rake test 运行测试时。我在第一次测试中总共得到 2 个预订，然后在第二次测试中得到 4 个。

有任何想法吗？

更新：

这是我正在运行的测试的示例

```
it "should return all reservations for a given date" do
  Reservation.for_date(Time.mktime(2012, 1, 1)).all.count.must_equal 2
end 
```

如果我用两种不同的 it 方法运行上面的测试，那么第二种方法会失败，因为实际计数是 4。所以在我看来 Miniskirt 并没有在测试之间回滚数据库。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T05:15:53.593

如果使用“描述”，请在前后使用：

[http://old.rspec.info/documentation/before_and_after.html](http://old.rspec.info/documentation/before_and_after.html)

=== 规格

```
 require 'minitest/autorun'

  describe Meme do
    before do
      @meme = Meme.new
    end

    describe "when asked about cheeseburgers" do
      it "must respond positively" do
        @meme.i_can_has_cheezburger?.must_equal "OHAI!"
      end
    end 
```

[https://github.com/seattlerb/minitest](https://github.com/seattlerb/minitest)

# vba - 如何使用 VBA 获取文本框中的浏览文件路径？

> ID：13080570
> 
> 赞同：0
> 
> 时间：2012-10-26T04:07:16.883
> 
> 标签：vba, excel

如何将浏览文件名放入文本框中？如果获取文件路径，如何拆分文件名？

我试过了`application.GetOpenFilename("Text Files(*.txt),*.txt")`

请建议显示到文本框中以及如何将确切的文件名拆分为仅读取文本文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T06:54:55.020

不要浪费时间重新发明轮子：[FileSystemObject](http://msdn.microsoft.com/en-us/library/6tkce7xa%28v=VS.85%29.aspx)会为您完成这项工作。

```
Dim FSO As Object: Set FSO = CreateObject("Scripting.FileSystemObject")
Sheet1.TextBox1.Text = FSO.GetFilename("C:\mydir\myfile.dat") 
```

文本框现在包含文本`myfile.dat`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-26T16:33:45.227

只要文件存在，Dir 函数就会为您提供文件名 - 如果您使用 GetOpenFilename，您将获得文件名。

```
Sub GetFileName()

    Dim sFullName As String
    Dim sFileName As String

    sFullName = Application.GetOpenFilename("*.txt,*.txt")
    sFileName = Dir(sFullName)

    Debug.Print sFullName, sFileName

End Sub 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-26T04:30:48.740

这是一个 VBA 例程，用于返回去除其路径的文件名。它很容易修改为返回路径，或两者兼而有之。

```
'====================================================================================
'     Returns the file name without a path via file open dialog box
'====================================================================================
' Prompts user to select a file.  Which ever file is selected, the function returns
' the filename stripped of the path.

Function GetAFileName() As String

Dim someFileName As Variant
Dim folderName As String
Dim i As Integer
Const STRING_NOT_FOUND As Integer = 0

'select a file using a dialog and get the full name with path included
someFileName = Application.GetOpenFilename("Text Files (*.txt), *.txt")

If someFileName <> False Then

    'strip off the folder path
    folderName = vbNullString
    i = 1

    While STRING_NOT_FOUND < i
        i = InStr(1, someFileName, "\", vbTextCompare)  'returns position of the first backslash "\"
        If i <> STRING_NOT_FOUND Then
            folderName = folderName & Left(someFileName, i)
            someFileName = Right(someFileName, Len(someFileName) - i)
        Else 'no backslash was found... we are done
            GetAFileName = someFileName

        End If
    Wend

Else
    GetAFileName = vbNullString
End If

End Function 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T03:49:16.423

Button1 点击

```
 OpenFileDialog1.ShowDialog()
    Me.TextBox1.Text = OpenFileDialog1.FileName
End Sub 
```

Textbox1 更改

```
 Dim File As System.IO.FileInfo
    File = My.Computer.FileSystem.GetFileInfo(TextBox1.Text)
    Dim Path As String = File.DirectoryName
    TextBox2.Text = Path
    Dim fileName As String = File.Name
    TextBox3.Text = fileName
End Sub 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-26T09:53:57.240

最简单的方法是简单地从 final 中读取`"\"`；

```
tbx.text = mid$(someFileName, 1 + InStrRev(someFileName, "\"), Len(someFileName)) 
```

# mkmapview - 根据 MapType 选择更改叠加 Alpha

> ID：13080571
> 
> 赞同：0
> 
> 时间：2012-10-26T04:07:21.527
> 
> 标签：mkmapview, mapkit, mkoverlay

我想知道是否可以根据选择地图类型来更改地图叠加 alpha 这是我认为可能有效但似乎没有用的代码。谁能提供一些煽动？

```
- (MKOverlayView *)mapView:(MKMapView *)mapView viewForOverlay:(id <MKOverlay>)overlay{
TileOverlayView *view = [[TileOverlayView alloc] initWithOverlay:overlay];
if(mapview.mapType == MKMapTypeHybrid) {
    view.tileAlpha = 0.55;
} else if(mapview.mapType == MKMapTypeSatellite) {
    view.tileAlpha = 0.0;
} else {
    view.tileAlpha = 0.75;
}
return [view autorelease];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T10:02:30.980

此代码工作正常

```
- (MKOverlayView *)mapView:(MKMapView *)mapView viewForOverlay:(id<MKOverlay>)overlay
{
    MKCircleView *circleView = [[MKCircleView alloc] initWithCircle:overlay];

    CGFloat alpha;

    if (mapView.mapType == MKMapTypeStandard) {
        alpha = 0.5f;
    } else {
        alpha = 1.0f;
    }

    circleView.fillColor = [[UIColor blackColor] colorWithAlphaComponent:alpha];

    return circleView;
} 
```

但是在 mapView:viewForOverlay 中，您根据当前地图类型设置 alpha。要在地图更改地图类型时更改 alpha，您需要使用 KVO 观察 mapType 属性。因此，当地图类型发生变化时，您只需为所有叠加层设置新的 alpha。获取视图以供叠加使用

```
[mapView viewForOverlay:(id<MKOverlay>)overlay]; 
```

# javascript - 使 HTML 页面大小为 0 javascript

> ID：13080574
> 
> 赞同：0
> 
> 时间：2012-10-26T04:08:00.733
> 
> 标签：javascript, jquery, html, iframe

有什么方法可以将 html 页面的大小从 javascript/jquery 减小到 width 和 height = 0 我从内部和 iframe 调用这个 html 页面，并且 iframe 调整为 html 页面大小，我希望 iframe 消失

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T04:53:40.367

如果你想隐藏真实`iframe`的你，`iframe`你需要通过访问`iframe`. 假设我们有两个页面：

**父.html：**

```
<htmL>
<head>
    <script type="text/javascript" src="./jquery.1.7.1.min.js"></script>
</head>
<body>
    <iframe id="parentFrame" src="./child.html"></iframe>
</body>
</html> 
```

**child.html:**

```
<htmL>
<head>
    <script type="text/javascript" src="./jquery.1.7.1.min.js"></script>
</head>
<body>
    <input type="button" value="hide me" onclick="$('#parentFrame', window.parent.document).hide();"/>
</body>
</html> 
```

我们使用 window.parent.document 获取父级，然后我们可以从那里访问父级中我们想要的任何内容，在这种情况下，我们只是隐藏了 iframe 本身。

# vb.net - 对数据网格列“对象必须是 Double 类型”进行排序时出现异常。更改值后

> ID：13080575
> 
> 赞同：1
> 
> 时间：2012-10-26T04:08:02.573
> 
> 标签：vb.net

我有一个`gridDetails`包含列`discount`并`total`从数据库填充的数据网格

`Total`是只读的，而`discount`不是。当折扣值改变时，总重新计算为

```
gridDetails.Item(1, e.RowIndex).Value -= (Val(gridDetails.Item(2, e.RowIndex).Value)) 
```

更改值后，无法对列进行排序。它产生一个异常

```
System.ArgumentException was unhandled
  Message="Object must be of type Double."
  Source="mscorlib"
  StackTrace:
       at System.Double.CompareTo(Object value)
       at System.Collections.Comparer.Compare(Object a, Object b)
       at System.Windows.Forms.DataGridViewRowCollection.RowComparer.CompareObjects(Object value1, Object value2, Int32 rowIndex1, Int32 rowIndex2)
       at System.Windows.Forms.DataGridViewRowCollection.RowArrayList.Pivot(Int32 left, Int32 center, Int32 right)
       at System.Windows.Forms.DataGridViewRowCollection.RowArrayList.CustomQuickSort(Int32 left, Int32 right)
       at System.Windows.Forms.DataGridViewRowCollection.RowArrayList.CustomSort(RowComparer rowComparer)
       at System.Windows.Forms.DataGridViewRowCollection.Sort(IComparer customComparer, Boolean ascending)
       at System.Windows.Forms.DataGridView.SortInternal(IComparer comparer, DataGridViewColumn dataGridViewColumn, ListSortDirection direction)
       at System.Windows.Forms.DataGridView.Sort(DataGridViewColumn dataGridViewColumn, ListSortDirection direction)
       at System.Windows.Forms.DataGridView.OnColumnHeaderMouseClick(DataGridViewCellMouseEventArgs e)
       at System.Windows.Forms.DataGridView.OnMouseClick(MouseEventArgs e)
       at System.Windows.Forms.Control.WmMouseUp(Message& m, MouseButtons button, Int32 clicks)
       at System.Windows.Forms.Control.WndProc(Message& m)
       at System.Windows.Forms.DataGridView.WndProc(Message& m)
       at System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message& m)
       at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message& m)
       at System.Windows.Forms.NativeWindow.DebuggableCallback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam)
       at System.Windows.Forms.UnsafeNativeMethods.DispatchMessageW(MSG& msg)
       at System.Windows.Forms.Application.ComponentManager.System.Windows.Forms.UnsafeNativeMethods.IMsoComponentManager.FPushMessageLoop(Int32 dwComponentID, Int32 reason, Int32 pvLoopData)
       at System.Windows.Forms.Application.ThreadContext.RunMessageLoopInner(Int32 reason, ApplicationContext context)
       at System.Windows.Forms.Application.ThreadContext.RunMessageLoop(Int32 reason, ApplicationContext context)
       at System.Windows.Forms.Application.Run(ApplicationContext context)
       at Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.OnRun()
       at Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.DoApplicationModel()
       at Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.Run(String[] commandLine)
       at cableguy.My.MyApplication.Main(String[] Args) in 17d14f5c-a337-4978-8281-53493378c1071.vb:line 81
       at System.AppDomain._nExecuteAssembly(Assembly assembly, String[] args)
       at System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args)
       at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()
       at System.Threading.ThreadHelper.ThreadStart_Context(Object state)
       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
       at System.Threading.ThreadHelper.ThreadStart()
  InnerException: 
```

我已经使用 Cdbl、DirectCast 等将结果转换为双倍。没有希望像 `gridDetails.Item(1, e.RowIndex).Value = Cdbl(gridDetails.Item(1, e.RowIndex).Value-Val(gridDetails.Item(2, e.RowIndex).Value))`

任何的想法？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T06:49:25.133

对，这就是我认为正在发生的事情。当您从数据库加载数据时，它在表中显示为字符串。这样它是可排序的，一切都很好。然后你去用你的减法改变一个值（很可能是第一行）。这会将排序更改为基于双打。由于您的整个表格都显示为字符串，因此它会崩溃。

所以基本上，eiter 确保从一开始就将双精度值插入 Datagridview，在加载表后转换列中的所有值或将更新的值作为字符串插入。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-09-20T18:06:25.577

如果要向 gridview 添加双精度、小数等，并且需要在没有值的地方添加零，请务必使用 Ctype：

```
If IsNumeric(drs.Item("qty")) then
   dgvX.row(I).cell(0).value = CType(drs.Item("qty"), decimal)
Else
   dgvX.row(I).cell(0).value = CType(0, decimal)
End If 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T07:16:55.817

@WozzeC 解释的原因是……我正在添加我所做的一切以使其正常……在添加到网格之前，我已将值转换为 Double。现在它的 okei .. :) :happy:

将数据读取到数据读取器并

```
 While data.Read = True
  Dim total_amount As Double = data("discount")
  Dim discount_amount As Double = data("total")
  gridDetails.Rows.Add(total_amount ,discount_amount)
 End While 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-11-16T06:20:47.707

```
 foreach(DataGridViewRow rowV in gridVerifyedData.Rows)
            {
                rowV.Cells["Tot_Work_hours"].Value = Convert.ToDouble(rowV.Cells["Tot_Work_hours"].Value);
            }
                gridVerifyedData.Sort(gridVerifyedData.Columns["Tot_Work_hours"], ListSortDirection.Descending); 
```

# android - 部分屏幕 WebView 与 切一半

> ID：13080578
> 
> 赞同：11
> 
> 时间：2012-10-26T04:08:43.780
> 
> 标签：android, android-webview, html5-video

我有一个具有拆分布局的平板电脑应用程序 - 左侧是列表，右侧是详细信息窗格。右侧窗格是一个 WebView，它包含一个`<video>`标签。这一切都很好，除了 WebView 的整个右侧被切断并呈现纯白色。

**为什么它会以这种方式呈现，以及如何在不插入大量黑客的情况下避免它？**

我把它归结为一个简单的测试项目，我已经发布[在 github 上](https://github.com/dokkaebi/android-webview-video-test/)。

这是一个**截图**：[http](http://d.pr/i/dfEh) ://d.pr/i/dfEh 。

左侧的灰色区域是列表视图所属的位置。为简单起见，我已将其更改为空`FrameLayout`。 ***WebView****右侧的截断部分与列表视图的宽度相同。* **还值得注意的是，视频下方的任何内容也被截断了——白色区域延伸了 WebView 的整个高度。**

 ****我尝试过的一些事情：**

*   用其他东西替换列表视图
*   启用和禁用`WebSettings`：javascript，使用宽视口，以概览模式加载
*   设置一个`WebViewClient`和一个`WebChromeClient`
*   打开和关闭硬件加速
*   `View.setScrollBarStyle`,`WebView.setVerticalScrollBarOverlay`和类似中的各种设置
*   调整`<video>`的高度/宽度属性和样式
*   各种视频格式，包括带 h264 和 aac 的 mp4、m3u8 和 youtube rtsp 流
*   各种设备，包括所示的 Fire HD、Nexus 7、Galaxy 10.1 和 Xoom
*   安卓版本 3.1、3.2、4.0、4.1

**当前解决方法：**

我最终通过使用全屏 WebView 解决了这个问题，将我的列表视图覆盖在它上面，并在 html 中最外层的容器元素上设置了左边距。这很麻烦，并且在各种密度和分辨率上获取列表视图的大小很容易出错，所以我真的很想以正确的方式解决这个问题。

**片段：**

正如我所提到的，在 github 上发布了一个（非）工作测试平台，但这里有一些重要的部分：

Html 加载到 WebView 中（这就是全部）：

```
<html>
<head><title>Title</title></head>
<body style="margin:0">
    <video x-webkit-airplay="allow" controls="controls" style="width:100%">
        <source src="http://clips.vorwaerts-gmbh.de/VfE_html5.mp4"></source>
    </video>
</body>
</html> 
```

主布局文件：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="horizontal"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    >

    <fragment android:name="com.concentricsky.android.webviewvideotest.ListFragment"
        android:id="@+id/item_list"
        android:layout_width="0dp"
        android:layout_height="match_parent"
        android:layout_weight="1" />

    <!-- The WebView is attached here -->
    <FrameLayout android:id="@+id/detail_container"
        android:layout_width="0dp"
        android:layout_height="match_parent"
        android:layout_weight="3" />

</LinearLayout> 
```

在`onCreateView`：

```
 View rootView = inflater.inflate(R.layout.fragment_detail, container, false);
    webView = (WebView) rootView.findViewById(R.id.webview);
    webView.setWebChromeClient(new WebChromeClient());
    webView.loadUrl("file:///android_asset/test.html");
    return rootView; 
```

我真的为这个问题摸不着头脑，我很惊讶我找不到任何提及它的内容。任何意见都值得赞赏，无论多么牵强。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T17:16:46.453

问题似乎出在硬件/opengl 层上。由于 VideoView 使用硬件层来渲染视频，我相信带有视频的 webView 也会发生同样的情况。

因此，如果您将图层设置正确，它们不应该相互干扰，所以就像我在评论中所说的那样，您应该将 ListView 设置为无图层或软件，以禁用硬件加速并在 webView 或窗口上启用它.

有关硬件加速的更多信息，请访问[http://developer.android.com/guide/topics/graphics/hardware-accel.html#controlling](http://developer.android.com/guide/topics/graphics/hardware-accel.html#controlling)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-10T15:33:27.767

我有同样的问题，它必须与我使用相对布局。将视频渲染到的图层不随 webview 移动。所以它将渲染视频，就好像 webview 定位在 0,0。

您可以通过将 webview 实际定位在 0 0 来解决此问题，在可能已经存在的任何组件后面。然后在 css 中给内容一个边距以将其放置在正确的位置。

它可能不干净，但我还没有找到其他解决方案。

编辑：在仔细查看您的问题后，我认为它与相对布局没有任何关系，因为您没有使用它。不过，这种解决方法对我有用。所以我猜无论你使用什么布局，“视频层”都保持在 0,0。顺便说一句，我只在 Galaxy Tab 2(android 4.0.3) 上遇到过这个问题。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-05-21T21:17:22.880

我在主/详细流布局中遇到了同样的问题。通过将图层类型设置为软件，我的视频被切成两半的问题就消失了。这将关闭 webview 的硬件加速。

```
webview.setLayerType(View.LAYER_TYPE_SOFTWARE, null); 
```

仅供参考，我只在亚马逊平板电脑上遇到过这个问题。**

# ios - 如何管理 AFNetworking 请求号？

> ID：13080580
> 
> 赞同：0
> 
> 时间：2012-10-26T04:09:01.120
> 
> 标签：ios, grand-central-dispatch, afnetworking

在我的 iOS 应用程序中，我有数百张图片下载。

我使用 AFNetworking 来获取这些图像。我想管理 AFWorking 的请求编号。

这是我的代码：

问题是：它会阻止我的用户界面。

THX 帮助我！

```
dispatch_group_t group = dispatch_group_create();
dispatch_queue_t queue = dispatch_queue_create(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);
dispatch_semaphore_t semaphore = dispatch_semaphore_create(5);

for (NSString *urlString in self.downloadImageList) {
    dispatch_semaphore_wait(semaphore, DISPATCH_TIME_FOREVER);
    dispatch_group_async(group, queue, ^{
        NSURL *url = [NSURL URLWithString:urlString];
        NSURLRequest *request = [NSURLRequest requestWithURL:url];
        NSString *filename = url.lastPathComponent;
        NSURL *outputFileURL = APPLICATION_DOCUMENTS_DIRECTORY;
        outputFileURL = [outputFileURL URLByAppendingPathComponent:[NSString stringWithFormat:@"%@/images/%@",self.boardId,filename]];

        dispatch_group_async(group, dispatch_get_main_queue(), ^{
            AFHTTPRequestOperation *operation = [[AFHTTPRequestOperation alloc] initWithRequest:request];
            operation.outputStream = [NSOutputStream outputStreamWithURL:outputFileURL append:YES];
            [operation setCompletionBlockWithSuccess:^(AFHTTPRequestOperation *operation, id responseObject) {
                [self.downloadImageList removeObject:urlString];
                NIDINFO(@"download success %@",filename);
                dispatch_semaphore_signal(semaphore);
            } failure:^(AFHTTPRequestOperation *operation, NSError *error) {
                NIDERROR(@"download image error:%@\n%@",error,urlString);
                dispatch_semaphore_signal(semaphore);
            }];
            [operation start];
        });

    });
}

dispatch_group_wait(group, DISPATCH_TIME_FOREVER);
dispatch_release(semaphore);
dispatch_release(group); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T06:40:50.337

> 问题是：它会阻止我的用户界面。

嗯，是的，这就是重点`dispatch_semaphore_t`。如果您删除这些调用，您的 AFNetworking 调用将在后台异步执行，而不会影响您的主/UI 线程。

我不知道这段代码在哪里使用的完整上下文，但看起来你可能想要考虑让调用它的方法接受一个块参数，一旦所有请求完成就可以调用它。您可能还想看看 AFHTTPClient 的批处理操作功能，它允许您跟踪一组操作的进度，分别获取每个操作的回调，以及所有操作何时完成。

# c# - 何时引发异常或返回 null？

> ID：13080585
> 
> 赞同：5
> 
> 时间：2012-10-26T04:09:38.133
> 
> 标签：c#, exception-handling

我在数据访问层上有一些功能

```
public Order RetrieveById(int id)
public List<Order> RetrieveByStatus(OrderStatus status) 
```

现在我对异常引发有点困惑。

在 RetrieveById 函数的情况下，小于 1 的 id 是无效的 id，因此我想引发异常。而且我想为数据库中不存在的 Id 返回 null 。然后感觉我太复杂了。

在 RetrieveByStatus 的情况下，当数据库中没有该状态的数据时，我想返回一个空列表。

但是我看到有些人在 RetrieveById 不能返回任何东西时引发异常，但是 RetrieveByStatus 在没有记录时不应该引发异常还是应该引发异常？

谁能为我澄清这些概念？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T04:15:30.957

> 我宁愿`null`在第一种情况下返回，`empty list` 在第二种情况下返回。

但是，如果你想引发异常，那么你可以引发异常，`public Order RetrieveById(int id)`因为这意味着它`id`无效，因为调用第一个方法意味着你知道`id`并且它需要在那里。

在第二种情况下，`OrderStatus`可能是有效的并且没有找到针对它的记录，因此返回一个空列表是个好主意。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-26T04:26:40.020

1.  首先阅读 MSDN：[Creating and Throwing Exceptions (C# Programming Guide)](http://msdn.microsoft.com/en-us/library/ms173163.aspx)。它列出了您应该抛出异常以及何时避免它的两种情况。
2.  还要考虑[C# 中 try/catch 的真正开销是什么？](https://stackoverflow.com/questions/52312/what-is-the-real-overhead-of-try-catch-in-c)

*在任何情况下，您都必须处理 null 返回或抛出的异常*

* * *

至于我自己，我宁愿在你的两种方法中都不要明确抛出异常。我想说，没有什么不好的，如果你的方法返回 null，如果它无法通过 id 找到对象。而该`RetrieveByStatus`方法可以返回一个空集合，而不是 null。

此外，您可以遵循 LINQ 中使用的模式，例如，您有[Enumerable.First](http://msdn.microsoft.com/ru-ru/library/bb291976.aspx)和[Enumerable.FirstOrDefault](http://msdn.microsoft.com/en-us/library/bb340482.aspx)方法（抛出异常或返回 null），因此您可以在特定情况下使用适当的方法，当`id`100 % 有效或相反，它可能会丢失。虽然返回元素序列的方法如果要返回的序列看起来是空的，则不会抛出异常；考虑[Enumerable.Where](http://msdn.microsoft.com/en-us/library/bb534803.aspx)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-26T04:34:44.540

在第一种情况下，我可能会去处理异常并自己处理，而不是返回 null。如果您的第一个方法以将返回的对象保存到 Order 引用的方式使用怎么办。 `NullReferenceException`被抛出的可能性非常高，当有人试图调用该对象的方法或属性时。

对于第二种方法，我会像一些人建议的那样选择一个空列表。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-10-26T04:59:19.940

我喜欢尽可能避免返回 null，因为`NullRefExceptions`它比特定异常更神秘，比如`OrderNotFoundException`. 此外，当您必须不断期望实体为空时，代码会变得非常迟钝。无论如何，这应该是一个例外情况——如果 db 中不存在该 id，你从哪里得到它？

On the cases you suspect this is more likely to throw an error, you could add a `DoesObjectExist` or `TryGet` type method (or even extension method).

# swing - 为什么我的背景颜色不显示？

> ID：13080587
> 
> 赞同：2
> 
> 时间：2012-10-26T04:09:40.467
> 
> 标签：swing, scala, user-interface, background

不知道为什么我的背景颜色没有出现？我在每个面板中设置了不透明度，我是否必须在 MainFrame 内容部分做其他事情？

```
// See http://www.artima.com/pins1ed/gui-programming.html
import scala.swing._
import java.awt.Color

object SecondSwingApp extends SimpleGUIApplication {
  def top = new MainFrame {
    title = "Second Swing App"

    val dealerPanel = new BoxPanel(Orientation.Horizontal) {
      background = new java.awt.Color(35, 125, 35)
      preferredSize = new java.awt.Dimension(800, 200)
      opaque = true
    }

    val botPlayerPanel = new BoxPanel(Orientation.Horizontal) {
      background = new java.awt.Color(35, 125, 125)
      preferredSize = new java.awt.Dimension(800, 200)
      opaque = true
    }

    val humanPlayerPanel = new BoxPanel(Orientation.Horizontal) {
      background = new java.awt.Color(125, 125, 35)
      preferredSize = new java.awt.Dimension(800, 200)
      opaque = true
    }

    contents = new BoxPanel(Orientation.Vertical) {
        contents += dealerPanel
        contents += botPlayerPanel
        contents += humanPlayerPanel
    }

  }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T07:55:17.093

我认为这是因为dealerPanel、botPlayerPanel 和humanPlayerPanel 中没有组件，所以背景颜色不显示。如果您向每个面板添加一些东西，那么颜色就会显示出来。例如，我添加了标签：

```
var label = new Label("dealer panel")
label.foreground = new java.awt.Color(255,255,255)
contents += label 
```

![在此处输入图像描述](../Images/eafdbaafef5cf7071e9b1d4dd60ea2e7.png)

尺寸和布局也存在问题，这可能是问题的一部分。

```
import scala.swing._
import java.awt.Color

object SecondSwingApp extends SimpleGUIApplication {
  def top = new MainFrame {
    title = "Second Swing App"

    val dealerPanel = new BoxPanel(Orientation.Horizontal) {
      background = new Color(35, 125, 35)
      preferredSize = new java.awt.Dimension(800, 255)
      var label = new Label("dealer panel")
      label.foreground = new java.awt.Color(255,255,255)
      contents += label
      opaque = true
    }

    val botPlayerPanel = new BoxPanel(Orientation.Horizontal) {
      background = new java.awt.Color(35, 125, 125)
      preferredSize = new java.awt.Dimension(800, 255)
      var label = new Label("bot player panel")
      label.foreground = new java.awt.Color(255,255,255)
      contents += label
      opaque = true
    }

    val humanPlayerPanel = new BoxPanel(Orientation.Horizontal) {
      background = new java.awt.Color(125, 125, 35)
      preferredSize = new java.awt.Dimension(800, 255)
      var label = new Label("human player panel")
      label.foreground = new java.awt.Color(255,255,255)
      contents += label
      opaque = true
    }

    contents = new BoxPanel(Orientation.Vertical) {
        contents += dealerPanel
        contents += botPlayerPanel
        contents += humanPlayerPanel
    }

  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T08:08:19.417

我也不是 Swing 专家，但如果面板没有任何内容（如另一个答案所示），它们看起来好像不占用空间。可能仅在`preferredSize`内容会迫使面板超过它时才相关`preferredSize`。您可以将`minimumSize`和设置`maximumSize`为相同的值，从而强制`BoxPanel`占用那么多空间，但这当然会使布局非常静态。

![在此处输入图像描述](../Images/e03c6b580a994ee6fe03f6eb6d4aa715.png)

```
val dealerPanel = new BoxPanel(Orientation.Horizontal) {
  background = new java.awt.Color(35, 125, 35)
  // preferredSize = new java.awt.Dimension(800, 200)
  minimumSize = new Dimension(100, 50)
  maximumSize = minimumSize
  opaque = true
}

val botPlayerPanel = new BoxPanel(Orientation.Horizontal) {
  background = new java.awt.Color(35, 125, 125)
  preferredSize = new java.awt.Dimension(800, 200)
  minimumSize = new Dimension(50, 100)
  maximumSize = minimumSize
  opaque = true
}

val humanPlayerPanel = new BoxPanel(Orientation.Horizontal) {
  background = new java.awt.Color(125, 125, 35)
  // preferredSize = new java.awt.Dimension(800, 200)
  minimumSize = new Dimension(200, 20)
  maximumSize = minimumSize
  opaque = true
} 
```

奇怪的是，您仍然需要指定其中一个`preferredSize`属性，因为否则窗口不会跨越任何东西，您所看到的只是应用程序的标题栏。

# javascript - Mongoose.js 使用不寻常但看似可接受的字符串值保存文档时出错

> ID：13080588
> 
> 赞同：1
> 
> 时间：2012-10-26T04:09:41.543
> 
> 标签：javascript, node.js, mongoose

我从 Node.js 将文档保存到 mongoose.js 时出错。这段代码已经运行了一段时间，但它现在导致 Javascript 对象出现问题，其键值看起来很好。

保存的是一个文档，其中一个成员是一个关联数组，为简单起见，它表示为`Schema.Types.Mixed`：

```
var formatSchema = new mongoose.Schema({
  name: {type: String, required: true},
  values: {type: mongoose.Schema.Types.Mixed, required: false}
}); 
```

当一个对象有一个像`"0038-"`. 具体来说，是破折号`-`导致了问题。如果我取出这些值（用于测试，而不是为了用户满意度），它加载得很好。将它隔离到这里，现在我不知道如何进行。

```
[
  {
    "name": "INJURYF",
    "values": {
        "0": "No",
        "1": "Yes"
    }
  },
  {
    "name": "RFVF",
    "values": {
        "10050": "Chills",
        "10100": "Fever",
        "10200": "General weakness",
        "10250": "General ill feeling",
        "00323": "Salmonella arthritis",
        "00324": "Salmonella osteomyelitis",
        "0038-": "Other specified salmonella infections",   // PROBLEM STARTS HERE
        "0039-": "Salmonella infection, unspecified",
        "0040-": "Shigella dysenteriae",
        ...
      }
    }, ...
  ] 
```

这是具体的错误信息，

```
Express
500 TypeError: Cannot call method 'path' of undefined
at getPositionalPath (/myproject/node_modules/mongoose/lib/schema.js:380:22)
at Schema.path (/myproject/node_modules/mongoose/lib/schema.js:199:9)
at Query._getSchema (/myproject/node_modules/mongoose/lib/query.js:1789:27)
at Query._walkUpdatePath (/myproject/node_modules/mongoose/lib/query.js:1721:16)
at Query._walkUpdatePath (/myproject/node_modules/mongoose/lib/query.js:1716:25)
at Query._castUpdate (/myproject/node_modules/mongoose/lib/query.js:1655:23)
at castDoc (/myproject/node_modules/mongoose/lib/query.js:2160:18)
at Query._findAndModify (/myproject/node_modules/mongoose/lib/query.js:2032:17)
at Query.findOneAndUpdate (/myproject/node_modules/mongoose/lib/query.js:1941:15)
at Function.Model.findOneAndUpdate (/myproject/node_modules/mongoose/lib/model.js:1127:16) 
```

[Mongoose 位置操作员错误](https://stackoverflow.com/questions/8874617/mongoose-positional-operator-errors)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T13:48:57.190

开始了：

这是旧 mongoose 版本的错误 - 请更新到最新版本。

# python - 刮台

> ID：13080591
> 
> 赞同：1
> 
> 时间：2012-10-26T04:09:52.397
> 
> 标签：python, beautifulsoup, urllib2

我通过爬取朋友（结构化，如果笨重）网站的过程来获得我的 BeautifulSoup 和 python 轴承，长期目标是将整个东西迁移到内容管理系统中。

`soup = BeautifulSoup(urllib2.urlopen("http://www.bicyclepaintings.com/archive/index.html")`如果我在控制台中准确地拉出一个单元格（ ）：

```
cell = soup.find_all('td',{'valign':'bottom'})[3] 
```

我可以玩弄拉出子串。这些都可以正常工作：`cell.br.next_sibling`, `cell.find('b').text`. 但是当我尝试使用 for 循环遍历所有单元格时：

```
def parse_archive(url):
    soup = get_soup(url)
    paintings = []
    for cell in soup.find_all('td',{'valign':'bottom'}):
        painting_title = cell.find('b').text
        painting_media = cell.br.next_sibling 
        record = painting_title, painting_media
        paintings.append(record)
    return paintings 
```

我收到一个属性错误 ( `AttributeError: 'NoneType' object has no attribute 'text'`)。我可以通过循环获得一些相同的信息：

```
 for item in cell.find_all('b'):
        painting_title = item.text 
```

但是我没有找到一种方法来获取兄弟姐妹，`<br/>`并且（更重要的是）我不明白为什么如果我拉出一个项目它会起作用，但如果我尝试通过 for 循环访问它们则不会。我在这里想念什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T04:28:45.400

您的问题是您尝试抓取的网站末尾有一堆`<td>`不包含标签的`<b>`标签：

```
<td nowrap valign="bottom"><!-- painting image -->
<p><font><!-- painting data, use &quot; for quotes --></font></p></td>
<td nowrap valign="bottom"><!-- painting image -->
<p><font><!-- painting data, use &quot; for quotes --></font></p></td>
<td nowrap valign="bottom"><!-- painting image -->
<p><font><!-- painting data, use &quot; for quotes --></font></p></td>
<td nowrap valign="bottom"><!-- painting image -->
<p><font><!-- painting data, use &quot; for quotes --></font></p></td>
<td nowrap valign="bottom"><!-- painting image -->
<p><font><!-- painting data, use &quot; for quotes --></font></p></td>
<td nowrap valign="bottom"><!-- painting image -->
<p><font><!-- painting data, use &quot; for quotes --></font></p></td> 
```

您只需要修改代码以忽略这些标签：

```
for cell in soup.find_all('td',{'valign':'bottom'}):
    title = cell.find('b')
    if title is None:
        continue
    painting_title = title.text
    painting_media = cell.br.next_sibling 
    record = painting_title, painting_media
    paintings.append(record) 
```

至于匹配`painting_media`你可以使用：

```
painting_media = list(cell.br.children)
painting_media = painting_media[0].strip() if painting_media else '' 
```

# c++ - 用于递归下降解析的 C++ n-ary 树实现

> ID：13080599
> 
> 赞同：9
> 
> 时间：2012-10-26T04:10:46.620
> 
> 标签：c++, parsing, data-structures, tree

我对 C++ 还是有点陌生​​，所以请耐心等待。我正在为一种名为 Core 的假设语言实现解释器，该语言由 BNF 语法描述。到目前为止，我已经实现了一个标记器，它给了我一个很好的代表核心程序的标记队列。我现在正在编写 Parser/Executer，它从标记器获取输出并使用它使用递归下降解析来填充 ParseTree 类的对象（我必须设计）。我了解如何做到这一点的基础知识，但在实现 ParseTree 类时遇到了麻烦。Core BNF 描述的产品通常有 2-5 个终端/非终端符号，但有些可能多达 20 个，所以我需要一个 n 叉树，其中每个节点可以有不同数量的子节点。

我想 ParseTree 类不一定需要使用树来实现它的实现，但这似乎是最有意义的（是否有可能更好/更容易的不同数据结构？）。我不知道 STL 中有任何符合我需要的容器。我查看了 Boost 属性树，但据我所知，这也不起作用。如果可能的话，我宁愿不要重新发明轮子并从头开始实现一棵树。此外，我无法使用除了 Boost 之外的任何外部库。实现我的 ParseTree 的最佳方法是什么？我可以使用任何好的预制树实现吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-26T04:26:25.467

我建议使用“左孩子，右兄弟”二叉树来表示解析树。它是 n 叉树的替代品。任何 n 叉树都可以使用“第一个孩子，下一个兄弟”二叉树来表示。

概念如下：如果 A 有 3 个孩子：B、C 和 D 并且 C 有 2 个孩子 E 和 F 如下

```
 A
            / | \
           B  C  D
              /\
             E  F 
```

这可以表示为

```
 A
             /
             B
              \
               C
              / \
             E   D
              \
               F 
```

即孩子总是去左节点，兄弟姐妹总是去右节点。它也很容易构建，并且这棵树的前序遍历与 n 叉树的前序遍历相同。

n 叉树的前序遍历：

```
display (node, level) {
    if (!node) return;
    print node;
    display (node->left, level+1);
    display (node->right, level+1);
} 
```

子兄弟二叉树的前序遍历

```
display (node, level) {
    if (!node) return;
    print node;
    display (node->left, level+1);
    display (node->right, level);
} 
```

如何构建这棵树：

```
1\. Throw your terminals and non-terminals in a Stack.
2\. When you want to combine n nodes under parent node 'p', pop 'n' elements from stack, making the last pop as the right child of the current pop.
3\. Finally make the nth pop the left child of node 'p'. 
```

# c++ - 在 Visual Studio 2012 中编译后出现 C0000409 异常

> ID：13080600
> 
> 赞同：1
> 
> 时间：2012-10-26T04:10:53.250
> 
> 标签：c++, exception, crash, visual-studio-2012

在从 VS2010 迁移到 VS2012 之后，我一遍又一遍地遇到同样的崩溃。代码为 C0000409 的 BEX 错误。

```
static void LoadBonus()
{
    // Get Bonus EXP
    {
        sql::Statement* stmt = mysql_con_sps->createStatement();
        sql::ResultSet* res = stmt->executeQuery("SELECT `value` FROM `variables` WHERE `name` = 'expbonus'");

        if (res->next())
        {
            dwBonusEXP = res->getInt("value");
            delete stmt;
            delete res;
        }
        else
        {
            delete stmt;
            delete res;
            printf("MySQL Error: GetBonusEXP Failed.\n");
            WriteToFile("SQLLog.txt", "MySQL Error: GetBonusEXP Failed.\n");
            ExitProcess(0);
        }
    }

    // Get Bonus SP
    {
        sql::Statement* stmt = mysql_con_sps->createStatement();
        sql::ResultSet* res = stmt->executeQuery("SELECT `value` FROM `variables` WHERE `name` = 'spbonus'");

        if (res->next())
        {
            dwBonusSP = res->getInt("value");
            delete stmt;
            delete res;
        }
        else
        {
            delete stmt;
            delete res;
            printf("MySQL Error: GetBonusSP Failed.\n");
            WriteToFile("SQLLog.txt", "MySQL Error: GetBonusSP Failed.\n");
            ExitProcess(0);
        }
    }

    printf("[Server] BonusExp: %d  BonusSP: %d\n", dwBonusEXP, dwBonusSP);
} 
```

在这个函数的末尾，编译器正在添加一个与 /GS 标志相关的调用，C0000409 崩溃在那里崩溃。

为什么会发生，我该如何解决？

谢谢你。

# haskell - 对“替代”类型类的含义及其与其他类型类的关系感到困惑

> ID：13080606
> 
> 赞同：75
> 
> 时间：2012-10-26T04:11:14.713
> 
> 标签：haskell, typeclass, alternative-functor, monadplus

我一直在浏览[Typeclassopedia](http://www.haskell.org/haskellwiki/Typeclassopedia)来学习类型类。我被困在理解中`Alternative`（并且`MonadPlus`，就此而言）。

我遇到的问题：

*   'pedia 说“Alternative 类型类适用于也具有幺半群结构的 Applicative 函子。” 我不明白——Alternative 不是意味着与 Monoid 完全不同的东西吗？即，我将 Alternative 类型类的要点理解为在两件事之间进行选择，而我将 Monoids 理解为关于组合事物。

*   为什么 Alternative 需要`empty`方法/成员？我可能是错的，但它似乎根本没有被使用......至少在我能找到的[代码中。](http://hackage.haskell.org/packages/archive/base/latest/doc/html/src/Control-Applicative.html#*%3E)而且这似乎不符合课堂的主题——如果我有两件事，并且需要选择一个，我需要一个“空”做什么？

*   为什么 Alternative 类型类需要一个 Applicative 约束，为什么它需要一种`* -> *`？为什么不只是有`<|> :: a -> a -> a`？所有实例仍然可以以相同的方式实现......我认为（不确定）。它提供了 Monoid 没有的什么价值？

*   `MonadPlus`类型类的意义何在？我不能通过同时使用 a`Monad`和来解锁它的所有优点`Alternative`吗？为什么不直接放弃呢？（我确定我错了，但我没有任何反例）

希望所有这些问题都是连贯的......！

* * *

赏金更新：@Antal 的回答是一个很好的开始，但 Q3 仍然开放：Alternative 提供了 Monoid 没有提供的什么？我觉得[这个答案](https://stackoverflow.com/questions/10167879/distinction-between-typeclasses-monadplus-alternative-and-monoid)不能令人满意，因为它缺乏具体的例子，以及关于 Alternative 的更高善意如何将其与 Monoid 区分开来的具体讨论。

如果要将 applicative 的效果与 Monoid 的行为结合起来，为什么不只是：

```
liftA2 mappend 
```

这对我来说更令人困惑，因为许多 Monoid 实例与 Alternative 实例完全相同。

这就是为什么我要寻找**具体的例子**来说明为什么 Alternative 是必要的，以及它与 Monoid 有何不同——或意味着不同的东西。

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2012-10-26T06:03:23.973

首先，让我为每个问题提供简短的答案。然后，我会将每个答案扩展为更长的详细答案，但这些简短的答案有望帮助导航这些答案。

1.  不，`Alternative`也`Monoid`没有不同的意思；适用于同时具有 of和 of`Alternative`结构的类型。“挑选”和“组合”是同一个更广泛概念的两种不同直觉。`Applicative``Monoid`

2.  `Alternative`包含`empty`以及`<|>`因为设计师认为这将是有用的，并且因为这会产生一个幺半群。在挑选方面，`empty`对应于做出不可能的选择。

3.  我们两者都需要`Alternative`，`Monoid`因为前者比后者遵守（或应该）*更多*的法律；这些定律与类型构造函数的单曲面和应用结构有关。另外，`Alternative`cannot 依赖于内部类型，while`Monoid`可以。

4.  `MonadPlus`略强于`Alternative`，因为它必须遵守更多的规律；除了应用结构之外，这些定律还将单曲面结构与一元结构联系起来。如果你有这两者的实例，它们应该是一致的。

* * *

> 不是`Alternative`意味着完全不同的东西`Monoid`吗？

并不真地！您感到困惑的部分原因是 Haskell`Monoid`类使用了一些非常糟糕（嗯，不够通用）的名称。这就是数学家定义幺​​半群的方式（非常明确）：

**定义。**一个*幺半群*是一个集合*M*配备了一个可区分的元素*ε* ∈ *M*和一个二元算子 · : *M* × *M* → *M*，用并列表示，这样以下两个条件成立：

1.  *ε*是恒等式：对于所有*m* ∈ *M*，*m* *ε* = *ε* *m* = *m*。
2.  · 是关联的：对于所有*m* ₁, *m* ₂, *m* ₃ ∈ *M* , ( *m* ₁<em>m₂) *m* ₃ = *m* ₁( *m* ₂<em>m₃)。

就是这样。在 Haskell 中，ε 是拼写的`mempty`，而 · 是拼写的`mappend`（或者，现在是`<>`），而集合*M*是中的类型`M`。`instance Monoid M where ...`

查看这个定义，我们看到它没有提到“组合”（或“挑选”）。它说了关于 · 和关于*ε*的事情，但仅此而已。现在，将事物与这种结构结合起来确实很有效：*ε*对应于没有事物，而*m* ₁<em>m₂ 表示如果我将*m* ₁ 和*m* ₂ 的东西放在一起，我可以得到一个包含所有它们的新事物东西。但这里有另一种直觉：*ε*对应于根本没有选择，*m* ₁<em>m₂ 对应于*m* ₁ 和*m* ₂ 之间的选择。这就是“挑选”的直觉。请注意，两者都遵守幺半群定律：

1.  一无所有和别无选择都是身份。
    *   如果我没有东西并将它与一些东西混合在一起，我最终会再次得到同样的东西。
    *   如果我在没有选择（不可能的事情）和其他选择之间做出选择，我必须选择其他（可能的）选择。
2.  将收藏集中在一起并做出选择都是关联的。
    *   如果我有三个集合，我将前两个放在一起然后第三个，或者最后两个放在一起然后第一个都没关系。无论哪种方式，我最终都会得到相同的整体系列。
    *   如果我可以在三件事之间进行选择，那么我是否（a）首先在第一或第二和第三之间进行选择，然后，如果需要，在第一和第二之间进行选择，或者（b）首先在第一和第二之间进行选择并不重要和第二或第三，然后，如果我需要，在第二和第三之间。无论哪种方式，我都可以选择我想要的。

（注意：我在这里玩得又快又松；这就是为什么它是直觉。例如，重要的是要记住 · 不必是可交换的，上面掩盖了这一点：完全有可能*m* ₁<em>m₂ ≠ *m* ₂ <em>m₁.)

看哪：这两种事情（以及许多其他事情——乘以数字真的是“组合”*还是*“挑选”？）都遵循相同的规则。拥有直觉对于发展理解很重要，但决定*实际*情况的是规则和定义。

最好的部分是这两种直觉可以由同一个载体来解释！令*M*为包含空集的某个集合（不是*所有*集合的集合！），令*ε*为空集 ∅，令 · 为并集 ∪。很容易看出 ∅ 是 ∪ 的恒等式，并且 ∪ 是关联的，因此我们可以得出 ( *M* ,∅,∪) 是幺半群的结论。现在：

1.  如果我们将集合视为事物的集合，那么 ∪ 对应于将它们聚集在一起以获得更多事物——“组合”直觉。
2.  如果我们认为集合代表可能的动作，那么 ∪ 对应于增加可供选择的可能动作池——“选择”直觉。

这正是`[]`Haskell 中正在发生的事情：`[a]`是 a `Monoid`for all `a`，并且`[]`作为应用函子（和 monad）用于表示不确定性。组合直觉和挑选直觉都在同一类型上重合：`mempty = empty = []`和`mappend = (<|>) = (++)`。

因此，`Alternative`该类只是用来表示对象，这些对象 (a) 是应用函子，并且 (b) 当以一种类型实例化时，它们具有遵循某些规则的值和二进制函数。有哪些规则？幺半群规则。为什么？因为事实证明它很有用:-)

* * *

> 为什么`Alternative`需要一个空的方法/成员？

好吧，刻薄的答案是“因为`Alternative`代表一个幺半群结构”。但真正的问题是：*为什么*是幺半群结构？为什么不只是一个半群，一个没有*ε*的幺半群？一个答案是声称幺半群更有用。我认为很多人（但也许不是[Edward Kmett](http://hackage.haskell.org/package/semigroups)）会同意这一点；几乎所有时间，如果你有一个明智的`(<|>)`/ `mappend`/·，你就可以定义一个明智的`empty`/ `mempty`/ *ε*。另一方面，具有额外的通用性很好，因为它可以让你在伞下放置更多的东西。

您还想知道这如何与“挑选”直觉相结合。请记住，在某种意义上，正确的答案是“知道何时放弃'挑选'直觉”，我认为您*可以*将两者统一起来。考虑`[]`，非确定性的应用函子。如果我将两个类型的值`[a]`与结合起来`(<|>)`，则对应于不确定地选择左侧的动作或右侧的动作。但有时，您将无法在一侧采取任何行动——这很好。同样，如果我们考虑解析器，`(<|>)`表示一个解析器，它解析左边的内容或右边的内容（它“挑选”）。如果你有一个总是失败的解析器，那最终就是一个身份：如果你选择它，你会立即拒绝那个选择并尝试另一个。

所有这一切，请记住，完全*有*可能拥有一个几乎类似的类`Alternative`，但缺少`empty`. 那将是完全有效的——它甚至可以是一个超类`Alternative`——但碰巧不是 Haskell 所做的。大概这是出于对有用的猜测。

* * *

> 为什么`Alternative`类型类需要一个`Applicative`约束，为什么它需要一种`* -> *`？... 为什么不只是 [使用] `liftA2 mappend`？

好吧，让我们考虑这三个提议的更改中的每一个：摆脱对;的`Applicative`约束。`Alternative`改变`Alternative`' 的论点的种类；并使用`liftA2 mappend`代替`<|>`和`pure mempty`代替`empty`。我们将首先查看第三个更改，因为它是最不同的。假设我们完全摆脱了`Alternative`这个类，并用两个简单的函数替换了这个类：

```
fempty :: (Applicative f, Monoid a) => f a
fempty = pure mempty

(>|<) :: (Applicative f, Monoid a) => f a -> f a -> f a
(>|<) = liftA2 mappend 
```

我们甚至可以保留 和 的`some`定义`many`。这*确实*给了我们一个幺半群结构，这是真的。但它似乎给了我们错误的一个。应该`Just fst >|< Just snd`失败，因为`(a,a) -> a`不是`Monoid`? 不，但这就是上面代码的结果。我们*想要*的幺半群实例是一个与内部类型无关的实例（借用[Matthew Farkas-Dyck](http://www.mail-archive.com/haskell-cafe@haskell.org/msg95527.html)在[一个非常相关的 haskell-cafe 讨论](http://www.mail-archive.com/haskell-cafe@haskell.org/msg95458.html)中的术语，该讨论提出了一些非常相似的问题）；该`Alternative`结构是关于由`f`' 结构确定的幺半群，而不是`f`' 参数的结构。

现在我们认为我们想`Alternative`作为某种类型类离开，让我们看看两种建议的改变它的方法。如果我们改变种类，我们*必须*摆脱`Applicative`约束；`Applicative`只讲善事`* -> *`，所以没有办法提及。这留下了两个可能的变化；第一个更小的变化是摆脱`Applicative`约束，但不理会这种约束：

```
class Alternative' f where
  empty' :: f a
  (<||>) :: f a -> f a -> f a 
```

另一个更大的变化是摆脱`Applicative`约束并改变种类：

```
class Alternative'' a where
  empty'' :: a
  (<|||>) :: a -> a -> a 
```

在这两种情况下，我们都必须摆脱`some`/ `many`，但这没关系；`(Applicative f, Alternative' f) => f a -> f [a]`我们可以将它们定义为类型为或的独立函数`(Applicative f, Alternative'' (f [a])) => f a -> f [a]`。

`Monoid`现在，在第二种情况下，我们更改类型变量的种类，我们看到我们的类与（或者，如果您仍想删除`empty''`, ）完全相同`Semigroup`，因此拥有一个单独的类没有任何优势。事实上，即使我们不理会 kind 变量但移除`Applicative`约束，也会`Alternative`变成`forall a. Monoid (f a)`，尽管我们无法在 Haskell 中编写这些量化的约束，即使使用所有花哨的 GHC 扩展也不行。（注意，这表达了上面提到的内在类型不可知论。）因此，如果我们可以做出这些改变中的任何一个，那么我们就没有理由保留`Alternative`（除了能够表达那个量化的约束，但这似乎很难令人信服） .

所以问题归结为“`Alternative`部件和作为两者的实例的部件之间是否存在关系？`Applicative`” `f`虽然文档中没有任何内容，但我要表明立场并说*是*的——或者至少，*应该*有。我认为这`Alternative`应该遵守一些与`Applicative`（除了幺半群定律之外）相关的定律；特别是，我认为这些法律类似于

1.  **（的）右分配`<*>`：**  `(f <|> g) <*> a = (f <*> a) <|> (g <*> a)`
2.  **右吸收（对于`<*>`）：**  `empty <*> a = empty`
3.  **左分布（的`fmap`）：**  `f <$> (a <|> b) = (f <$> a) <|> (f <$> b)`
4.  **左吸收（对于`fmap`）：**  `f <$> empty = empty`

`[]`这些定律对于and `Maybe`, and (假装它的`MonadPlus`实例是一个`Alternative`实例)似乎是正确的`IO`，但我没有做过任何证明或详尽的测试。（例如，我最初认为*左*分配性适用于`<*>`，但这对 的“执行效果”顺序错误`[]`。）但是，通过类比，确实`MonadPlus`期望遵守类似的定律（尽管[显然有一些含糊不清](http://www.haskell.org/haskellwiki/MonadPlus)）。我原本想主张第三定律，这似乎很自然：

*   **左吸收（对于`<*>`）：**  `a <*> empty = empty`

然而，尽管我相信`[]`并`Maybe`遵守这条法律，但我`IO`并不相信，而且我认为（原因将在接下来的几段中显而易见）最好不要要求它。

事实上，Edward Kmett 似乎[有一些幻灯片](http://comonad.com/reader/wp-content/uploads/2009/07/AllAboutMonoids.pdf)，他支持类似的观点。为此，我们需要简短地题外话，涉及一些更多的数学术语。最后一张幻灯片，“我想要更多的结构”，说“一个 Monoid 是一个 Applicative，就像一个正确的 Seminearring 是一个 Alternative”，“如果你扔掉 Applicative 的论点，你会得到一个 Monoid，如果你扔摆脱 Alternative 的论点，您将获得 RightSemiNearRing。”</p>

正确的半婚宴？“正确的半婚宴是如何参与其中的？” [我听到你哭了。](http://www.youtube.com/watch?v=UIKGV2cTgqA) 好，

**定义。***右半*半圆（也是*右半圆*，但前者似乎在 Google 上使用得更多）是四元组 ( R *,* +,·,0) 其中 ( *R* ,+,0) 是幺半群， ( *R* ,·)是一个半群，并且以下两个条件成立：

1.  · 在 + 上是右分配的：对于所有*r* , *s* , *t* ∈ *R* , ( *s* + *t* ) *r* = *sr* + *tr*。
2.  0 是右吸收的 ·：对于所有*r* ∈ *R*，0 *r* = 0。

类似地定义*左近半球。*

现在，这不太适用，因为`<*>`它不是真正的关联运算符或二元运算符——类型不匹配。我认为这就是 Edward Kmett 在谈到“抛弃争论”时所要表达的意思。另一种选择可能是说（我不确定这是否正确）我们实际上希望 ( `f a`, `<|>`, `<*>`, `empty`) 形成一个*右半环体*，其中“-oid”后缀表示二元运算符只能应用于特定的元素对（à la [*groupoids*](http://en.wikipedia.org/wiki/Groupoid#Algebraic)）。而且我们还想说 ( `f a`, `<|>`, `<$>`, `empty`) 是一个左近半环体，尽管可以想象这可以从`Applicative`规律和正确的近半环状结构。但现在我已经进入了我的脑海，这无论如何都不是很重要。

无论如何，这些定律比幺半群定律*更强大*，意味着完全有效的`Monoid`实例将变为无效`Alternative`实例。标准库中有（至少）两个这样的例子：`Monoid a => (a,)`和`Maybe`. 让我们快速看一下它们中的每一个。

给定任意两个幺半群，它们的乘积是一个幺半群；因此，元组可以以`Monoid`明显的方式作为一个实例（重新格式化[基本包的源](http://hackage.haskell.org/packages/archive/base/latest/doc/html/src/Data-Monoid.html#line-115)）：

```
instance (Monoid a, Monoid b) => Monoid (a,b) where
  mempty = (mempty, mempty)
  (a1,b1) `mappend` (a2,b2) = (a1 `mappend` a2, b1 `mappend` b2) 
```

`Applicative`类似地，我们可以通过累积 monoid 元素（重新格式化[基本包的 source](http://hackage.haskell.org/packages/archive/base/latest/doc/html/src/Control-Applicative.html#line-208) ）将其第一个组件是一个 monoid 元素的元组变成一个实例：

```
instance Monoid a => Applicative ((,) a) where
  pure x = (mempty, x)
  (u, f) <*> (v, x) = (u `mappend` v, f x) 
```

然而，元组不是 的一个实例`Alternative`，因为它们不可能——`Monoid a => (a,b)`所有类型都存在over 的幺半群结构`b`，并且`Alternative`的幺半群结构必须是内部类型不可知的。不仅必须`b`是 monad，为了能够表达`(f <> g) <*> a`，我们需要使用`Monoid`函数的实例，它是形式的函数`Monoid b => a -> b`。即使在我们拥有所有必要的单曲面结构的情况下，它也违反了*所有四个*`Alternative`定律。要看到这一点， let`ssf n = (Sum n, (<> Sum n))`和 let `ssn = (Sum n, Sum n)`。然后，写`(<>)`for `mappend`，我们得到以下结果（可以在 GHCi 中检查，偶尔使用类型注释）：

1.  正确分配：
    *   `(ssf 1 <> ssf 1) <*> ssn 1 = (Sum 3, Sum 4)`
    *   `(ssf 1 <*> ssn 1) <> (ssf 1 <*> ssn 1) = (Sum 4, Sum 4)`
2.  正确的吸收：
    *   `mempty <*> ssn 1 = (Sum 1, Sum 0)`
    *   `mempty = (Sum 0, Sum 0)`
3.  左分布：
    *   `(<> Sum 1) <$> (ssn 1 <> ssn 1) = (Sum 2, Sum 3)`
    *   `((<> Sum 1) <$> ssn 1) <> ((<> Sum 1) <$> ssn 1) = (Sum 2, Sum 4)`
4.  左吸收：
    *   `(<> Sum 1) <$> mempty = (Sum 0, Sum 1)`
    *   `mempty = (Sum 1, Sum 1)`

接下来，考虑`Maybe`。就目前而言，`Maybe`'`Monoid`和`Alternative`实例*不同意*。（虽然我在本节开头提到[的 haskell-cafe 讨论](http://www.mail-archive.com/haskell-cafe@haskell.org/msg95458.html)建议改变这一点，但[semigroups 包](http://hackage.haskell.org/packages/archive/semigroups/0.8.4.1/doc/html/Data-Semigroup.html#t:Option)中有[一个`Option`](http://hackage.haskell.org/packages/archive/semigroups/0.8.4.1/doc/html/Data-Semigroup.html#t:Option)新类型会产生相同的效果。）因为基础包没有半群类，它只是提升了幺半群，所以我们得到（重新格式化[基础包的源](http://hackage.haskell.org/packages/archive/base/latest/doc/html/src/Data-Monoid.html#line-223)）：`Monoid``Maybe``Nothing`

```
instance Monoid a => Monoid (Maybe a) where
  mempty = Nothing
  Nothing `mappend` m       = m
  m       `mappend` Nothing = m
  Just m1 `mappend` Just m2 = Just (m1 `mappend` m2) 
```

另一方面，作为`Alternative`,`Maybe`代表失败的优先选择，因此我们得到（再次重新格式化[基本包的 source](http://hackage.haskell.org/packages/archive/base/latest/doc/html/src/Control-Applicative.html#line-167)）：

```
instance Alternative Maybe where
  empty = Nothing
  Nothing <|> r = r
  l       <|> _ = l 
```

事实证明，只有后者符合`Alternative`法律。该`Monoid`实例的失败不如`(,)`'s; 它*确实*遵守关于 的定律`<*>`，尽管几乎是偶然的——它来自`Monoid`for 函数的唯一实例的行为，它（如上所述）将返回幺半群的函数提升到读者应用函子中。如果你解决它（这都是非常机械的），你会发现所有的右分配和右吸收`<*>`都适用于`Alternative`和`Monoid`实例，左吸收也适用于`fmap`。对于该实例，左分布`fmap`确实成立`Alternative`，如下所示：

```
f <$> (Nothing <|> b)
  = f <$> b                          by the definition of (<|>)
  = Nothing <|> (f <$> b)            by the definition of (<|>)
  = (f <$> Nothing) <|> (f <$> b)    by the definition of (<$>)

f <$> (Just a <|> b)
  = f <$> Just a                     by the definition of (<|>)
  = Just (f a)                       by the definition of (<$>)
  = Just (f a) <|> (f <$> b)         by the definition of (<|>)
  = (f <$> Just a) <|> (f <$> b)     by the definition of (<$>) 
```

但是，`Monoid`实例失败；`(<>)`为写作`mappend`，我们有：

*   `(<> Sum 1) <$> (Just (Sum 0) <> Just (Sum 0)) = Just (Sum 1)`
*   `((<> Sum 1) <$> Just (Sum 0)) <> ((<> Sum 1) <$> Just (Sum 0)) = Just (Sum 2)`

现在，这个例子有一个警告。如果您只要求`Alternative`s 与 s 兼容`<*>`，而不是与s 兼容`<$>`，那么`Maybe`很好。上面提到的 Edward Kmett 的幻灯片没有提及`<$>`，但我认为要求有关它的法律似乎也是合理的；尽管如此，我找不到任何支持我的东西。

因此，我们可以得出结论，作为`Alternative`a 的要求比作为 a*的*`Monoid`要求更高，因此它需要不同的类。最纯粹的例子是具有内部类型不可知`Monoid`实例的类型和`Applicative`彼此不兼容的实例；但是，基本包中没有任何此类类型，我想不出任何类型。（可能不存在，尽管我会感到惊讶。）然而，这些内部类型的诺斯替示例说明了为什么两个类型类必须不同。

* * *

> `MonadPlus`类型类的意义何在？

`MonadPlus`, like `Alternative`, 是加强的`Monoid`，但相对于`Monad`而不是`Applicative`。根据 Edward Kmett 在[他对“类型类](https://stackoverflow.com/a/10168111/237428)[,](https://stackoverflow.com/q/10167879/237428)[和](https://stackoverflow.com/q/10167879/237428)[?](https://stackoverflow.com/q/10167879/237428)[之间的区别`MonadPlus``Alternative``Monoid``MonadPlus`*`Alternative``empty <*> a``empty >>= f`*](https://stackoverflow.com/q/10167879/237428)*”问题的回答中[*，也*](https://stackoverflow.com/q/10167879/237428)[比](https://stackoverflow.com/q/10167879/237428)[强](https://stackoverflow.com/q/10167879/237428)[：](https://stackoverflow.com/q/10167879/237428)[例如，法律并不暗示这一点](https://stackoverflow.com/q/10167879/237428)[。](https://stackoverflow.com/q/10167879/237428) [AndrewC](https://stackoverflow.com/a/13124491/237428)提供了两个例子：`Maybe`和它的对偶。由于存在[两套潜在的法律，`MonadPlus`](http://www.haskell.org/haskellwiki/MonadPlus)这一事实使问题变得复杂。普遍认为`MonadPlus`应该与`mplus`和形成一个幺半群，`mempty`并且应该满足*左零*定律，`mempty >>= f = mempty`. 然而，一些`MonadPlus`ses 满足*左分布*, `mplus a b >>= f = mplus (a >>= f) (b >>= f)`; 和其他人满足*左接*，`mplus (return a) b = return a`。（请注意，左零/分布`MonadPlus`类似于`Alternative`;的右分布/吸收比`(<*>)`更类似于。）左分布可能“更好”，因此任何满足左捕获的实例，例如，都是但不是第一种的。由于 left catch 依赖于排序，你可以想象一个 newtype 包装器，它的实例是*右*偏而不是*左*偏的：`(=<<)``(>>=)``MonadPlus``Maybe``Alternative``MonadPlus``Maybe``Alternative`**`a <|> Just b = Just b`. 这既不满足左分布也不满足左捕获，但将是一个完全有效的`Alternative`.***

 ***但是，由于任何类型a*都*`MonadPlus`应该使其实例与其实例重合（我相信这与它是s 的 s`Alternative`所要求的`ap`和`(<*>)`相等的方式相同），您可以想象将类定义为`Monad``Applicative``MonadPlus`

```
class (Monad m, Alternative m) => MonadPlus' m 
```

该类不需要声明新函数；这只是对给定类型所遵守`empty`的法律的承诺。`(<|>)`这种设计技术没有在 Haskell 标准库中使用，但在一些更具有数学头脑的包中用于类似目的；例如，[lattices](http://hackage.haskell.org/package/lattices)包使用它来表达一个[lattice](http://hackage.haskell.org/packages/archive/lattices/1.2.1/doc/html/Algebra-Lattice.html#t:Lattice)只是通过吸收定律链接的相同类型的[连接半格](http://hackage.haskell.org/packages/archive/lattices/1.2.1/doc/html/Algebra-Lattice.html#t:JoinSemiLattice)和[相遇半格的想法。](http://hackage.haskell.org/packages/archive/lattices/1.2.1/doc/html/Algebra-Lattice.html#t:MeetSemiLattice)

`Alternative`即使您想保证`Alternative`并且`Monoid`始终重合，您也不能这样做的原因是种类不匹配。所需的类声明将具有以下形式

```
class (Applicative f, forall a. Monoid (f a)) => Alternative''' f 
```

但是（如上所述）甚至 GHC Haskell 都不支持量化约束。

另外，请注意，拥有`Alternative`as 的超类`MonadPlus`需要`Applicative`成为 的超类`Monad`，所以祝你好运。如果你遇到这个问题，总会有[`WrappedMonad`](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Control-Applicative.html#t:WrappedMonad)newtype，它以明显的方式将 any`Monad`变成 an `Applicative`；有一个`instance MonadPlus m => Alternative (WrappedMonad m) where ...`正是你所期望的。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-11-01T10:03:20.163

```
import Data.Monoid
import Control.Applicative 
```

让我们通过一个示例来追溯 Monoid 和 Alternative 如何与`Maybe`函子和`ZipList`函子交互，但让我们从头开始，部分是为了让所有定义在我们的脑海中保持新鲜，部分是为了停止一直切换标签到一些hackage，但是主要是这样我就可以[运行过去的 ghci](https://stackoverflow.com/questions/12666723/i-taught-ghci-to-compile-my-stackoverflow-posts-can-i-make-it-slicker)来纠正我的错字！

```
(<>) :: Monoid a => a -> a -> a
(<>) = mappend -- I'll be using <> freely instead of `mappend`. 
```

这是 Maybe 克隆：

```
data Perhaps a = Yes a | No  deriving (Eq, Show)

instance Functor Perhaps where
   fmap f (Yes a) = Yes (f a)
   fmap f No      = No

instance Applicative Perhaps where
   pure a = Yes a
   No    <*> _     = No
   _     <*> No    = No
   Yes f <*> Yes x = Yes (f x) 
```

现在是 ZipList：

```
data Zip a = Zip [a]  deriving (Eq,Show)

instance Functor Zip where
   fmap f (Zip xs) = Zip (map f xs)

instance Applicative Zip where
   Zip fs <*> Zip xs = Zip (zipWith id fs xs)   -- zip them up, applying the fs to the xs
   pure a = Zip (repeat a)   -- infinite so that when you zip with something, lengths don't change 
```

## 结构1：组合元素：Monoid

**也许克隆**

首先让我们看一下`Perhaps String`。有两种组合方式。首先串联

```
(<++>) :: Perhaps String -> Perhaps String -> Perhaps String
Yes xs <++> Yes ys = Yes (xs ++ ys)
Yes xs <++> No     = Yes xs
No     <++> Yes ys = Yes ys
No     <++> No     = No 
```

连接本质上在 String 级别工作，而不是真正的 Maybe 级别，将`No`其视为`Yes []`. 它等于`liftA2 (++)`。这是明智且有用的，但也许我们可以从仅使用`++`到使用任何组合方式进行概括——然后是任何 Monoid！

```
(<++>) :: Monoid a => Perhaps a -> Perhaps a -> Perhaps a
Yes xs <++> Yes ys = Yes (xs `mappend` ys)
Yes xs <++> No     = Yes xs
No     <++> Yes ys = Yes ys
No     <++> No     = No 
```

这个幺半群结构试图在这个层面上`Perhaps`尽可能多地工作。`a`注意`Monoid a`约束，告诉我们我们正在使用`a`关卡中的结构。这不是替代结构，它是派生（提升）的 Monoid 结构。

```
instance Monoid a => Monoid (Perhaps a) where
   mappend = (<++>)
   mempty = No 
```

在这里，我使用了数据 a 的结构来为整个事物添加结构。如果我正在组合`Set`s，我将能够添加一个`Ord a`上下文。

**ZipList 克隆**

那么我们应该如何将*元素*与 zipList 结合起来呢？如果我们将它们组合起来，它们应该压缩到什么位置？

```
 Zip ["HELLO","MUM","HOW","ARE","YOU?"] 
<> Zip ["this", "is", "fun"]
=  Zip ["HELLO" ? "this",   "MUM" ? "is",   "HOW" ? "fun"]

mempty = ["","","","",..]   -- sensible zero element for zipping with ? 
```

但是我们应该使用什么`?`。我说这里唯一明智的选择是`++`。实际上，对于列表，`(<>) = (++)`

```
 Zip [Just 1,  Nothing, Just 3, Just 4]
<> Zip [Just 40, Just 70, Nothing]
 =  Zip [Just 1 ? Just 40,    Nothing ? Just 70,    Just 3 ? Nothing]

mempty = [Nothing, Nothing, Nothing, .....]  -- sensible zero element 
```

但是我们可以使用什么`?`我说我们是要组合元素，所以我们应该再次使用 Monoid 中的元素组合运算符：`<>`.

```
instance Monoid a => Monoid (Zip a) where
   Zip as `mappend` Zip bs = Zip (zipWith (<>) as bs) -- zipWith the internal mappend
   mempty = Zip (repeat mempty)  -- repeat the internal mempty 
```

这是使用 zip 组合元素的唯一合理方式 - 所以它是唯一合理的 monoid 实例。

有趣的是，这不适用于上面的 Maybe 示例，因为 Haskell 不知道如何组合`Int`s - 它应该使用`+`or`*`吗？要获取数值数据的 Monoid 实例，您可以将它们包装起来`Sum`或`Product`告诉它要使用哪个 monoid。

```
Zip [Just (Sum 1),   Nothing,       Just (Sum 3), Just (Sum 4)] <> 
Zip [Just (Sum 40),  Just (Sum 70), Nothing]
= Zip [Just (Sum 41),Just (Sum 70), Just (Sum 3)]

   Zip [Product 5,Product 10,Product 15] 
<> Zip [Product 3, Product 4]
 =  Zip [Product 15,Product 40] 
```

**关键**

**请注意**， Monoid 中的类型有 kind`*`正是允许我们将`Monoid a`上下文放在这里的事实——我们也可以添加`Eq a`or `Ord a`。在 Monoid 中，原始元素很重要。Monoid 实例*旨在*让您操作和组合结构内的数据。

## 结构2：更高层次的选择：Alternative

选择运算符是相似的，但也不同。

**也许克隆**

```
(<||>) :: Perhaps String -> Perhaps String -> Perhaps String
Yes xs <||> Yes ys = Yes xs   -- if we can have both, choose the left one
Yes xs <||> No     = Yes xs
No     <||> Yes ys = Yes ys
No     <||> No     = No 
```

这里*没有连接*- 我们根本没有使用`++`- 这种组合纯粹在`Perhaps`级别上工作，所以让我们将类型签名更改为

```
(<||>) :: Perhaps a -> Perhaps a -> Perhaps a
Yes xs <||> Yes ys = Yes xs   -- if we can have both, choose the left one
Yes xs <||> No     = Yes xs
No     <||> Yes ys = Yes ys
No     <||> No     = No 
```

注意没有约束——我们没有使用`a`关卡的结构，只是使用关卡的结构`Perhaps`。这是一种替代结构。

```
instance Alternative Perhaps where
   (<|>) = (<||>)
   empty = No 
```

**ZipList 克隆**

我们应该如何在两个 ziplist 之间进行选择？

```
Zip [1,3,4] <|> Zip [10,20,30,40] = ???? 
```

在元素上使用会很诱人`<|>`，但我们不能，因为元素的类型对我们不可用。让我们从`empty`. 它不能使用元素，因为我们在定义 Alternative 时不知道元素的类型，所以它必须是`Zip []`. 我们需要它是 的左（最好是右）身份`<|>`，所以

```
Zip [] <|> Zip ys = Zip ys
Zip xs <|> Zip [] = Zip xs 
```

有两个明智的选择`Zip [1,3,4] <|> Zip [10,20,30,40]`：

1.  `Zip [1,3,4]`因为它是第一个 - 与 Maybe 一致
2.  `Zip [10,20,30,40]`因为它是最长的 - 与`Zip []`被丢弃一致

好吧，这很容易决定：因为`pure x = Zip (repeat x)`，两个列表可能都是无限的，所以比较它们的长度可能永远不会终止，所以必须选择第一个。因此，唯一合理的 Alternative 实例是：

```
instance Alternative Zip where
   empty = Zip []
   Zip [] <|> x = x
   Zip xs <|> _ = Zip xs 
```

这是我们可以定义的唯一明智的替代方案。请注意它与 Monoid 实例有多么不同，因为我们不能弄乱元素，我们甚至不能看它们。

**关键**

**请注意**，因为`Alternative`采用了一种构造函数，`* -> *`所以*不可能*添加`Ord a`or`Eq a`或`Monoid a`上下文。**不允许**替代项使用有关结构内数据的任何信息。不管你多么想对数据*做*任何事情，你都不能对数据做任何事情，除非把它扔掉。

# 关键点：Alternative 和 Monoid 有什么区别？

不是很多——它们都是幺半群，但总结最后两节：

**`Monoid *`实例使合并内部数据成为可能。`Alternative (* -> *)`实例使它不可能。Monoid 提供灵活性，Alternative 提供保证。种类`*`和`(* -> *)`是这种差异的主要驱动因素。拥有它们可以让您同时使用这两种操作。**

这是正确的事情，我们的两种口味都很合适。Monoid 实例`Perhaps String`表示将所有字符放在一起，Alternative 实例表示字符串之间的选择。

Maybe 的 Monoid 实例没有任何问题——它正在做它的工作，*结合*数据。
Maybe 的 Alternative 实例没有任何问题——它在做自己的工作，在事物之间进行*选择。*

Zip 的 Monoid 实例结合了它的元素。Zip 的 Alternative 实例被迫选择其中一个列表 - 第一个非空列表。

能够同时做到这两点很好。

## Applicative 上下文有什么用？

选择和申请之间有一些互动。请参阅[Antal SZ 在他的问题](https://stackoverflow.com/questions/13122489/whats-an-example-of-a-monad-which-is-an-alternative-but-not-a-monadplus)中或在他的回答中间陈述的法律。

从实际的角度来看，它很有用，因为 Alternative 是一些 Applicative Functors 用来选择的东西。该功能被用于 Applicatives，因此发明了一个通用接口类。Applicative Functor 非常适合表示产生值的计算（IO、解析器、输入 UI 元素......），其中一些必须处理失败 - 需要替代方案。

## 为什么 Alternative 有`empty`？

> 为什么 Alternative 需要一个空的方法/成员？我可能是错的，但它似乎根本没有被使用......至少在我能找到的代码中。而且这似乎不符合课堂的主题——如果我有两件事，并且需要选择一个，我需要一个“空”做什么？

这就像问为什么加法需要一个 0 - 如果你想添加东西，那么拥有不添加任何东西的东西有什么意义？答案是 0 是一切都围绕它旋转的关键数字，就像 1 对乘法`[]`至关重要，对列表至关重要（并且`y=e^x`对微积分至关重要）。实际上，您可以使用这些无所事事的元素来开始构建：

```
sum = foldr (+) 0
concat = foldr (++) []
msum = foldr (`mappend`) mempty          -- any Monoid
whichEverWorksFirst = foldr (<|>) empty  -- any Alternative 
```

## 我们不能用 Monad+Alternative 替换 MonadPlus 吗？

> MonadPlus 类型类的意义何在？我不能通过将某些东西同时用作 Monad 和 Alternative 来解锁它的所有优点吗？为什么不直接放弃呢？（我确定我错了，但我没有任何反例）

你没看错，没有反例！

您的有趣问题让 Antal SZ、Petr Pudlák 和我深入研究了 MonadPlus 和 Applicative 之间的关系究竟是什么。[在这里](https://stackoverflow.com/questions/13122489/whats-an-example-of-a-monad-which-is-an-alternative-but-not-a-monadplus) 和[这里](https://cstheory.stackexchange.com/questions/14143/what-are-the-relations-between-alternative-monadplusleftcatch-and-monadplusl)的答案 是，任何是 a `MonadPlus`（在左侧分布意义上 - 请点击链接了解详细信息）也是 a `Alternative`，但不是相反。

这意味着如果你创建一个 Monad 和 MonadPlus 的实例，它[无论如何都满足 Applicative 和 Alternative 的条件](https://stackoverflow.com/questions/13122489/whats-an-example-of-a-monad-which-is-an-alternative-but-not-a-monadplus)。这意味着如果您遵循 MonadPlus 的规则（左 dist），您也可以将您的 Monad 设为 Applicative 并使用 Alternative。

但是，如果我们删除 MonadPlus 类，我们会删除一个用于记录规则的合理位置，并且您将无法指定某个东西的 Alternative 而不是 MonadPlus（从技术上讲，我们应该为 Maybe 这样做）。这些都是理论上的原因。实际原因是它会破坏现有代码。（这也是为什么 Applicative 和 Functor 都不是 Monad 的超类的原因。）

## Alternative和Monoid不是一样的吗？Alternative和Monoid不是完全不同的吗？

> 'pedia 说“Alternative 类型类适用于也具有幺半群结构的 Applicative 函子。” 我不明白——Alternative 不是意味着与 Monoid 完全不同的东西吗？即，我将 Alternative 类型类的要点理解为在两件事之间进行选择，而我将 Monoids 理解为关于组合事物。

Monoid 和 Alternative 是以合理的方式从两个对象中获取一个对象的两种方法。Maths 不在乎你是在选择、组合、混合还是炸毁你的数据，这就是为什么 Alternative 被称为 Applicative 的 Monoid 的原因。你现在似乎对这个概念很熟悉，但你现在说

> 对于同时具有 Alternative 和 Monoid 实例的类型，这些实例应该是相同的

我不同意这一点，我认为我的 Maybe 和 ZipList 示例已仔细解释了它们为何不同。如果有的话，我认为它们相同的情况应该很少见。我只能想到一个例子，简单的列表，这是合适的。这是因为列表是具有 的幺半群的基本示例`++`，但在某些情况下，列表也被用作元素的不确定选择，因此`<|>`也应该是`++`。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-10-29T02:30:37.800

## 概括

*   我们需要为一些应用函子定义（提供相同操作的实例） Monoid 实例，它们真正在应用函子级别组合，而不仅仅是提升较低级别的幺半群。下面的示例错误`litvar = liftA2 mappend literal variable`显示`<|>`通常不能定义为`liftA2 mappend`; `<|>`在这种情况下，通过组合解析器而不是它们的数据来工作。

*   如果我们直接使用 Monoid，我们需要语言扩展来定义实例。`Alternative`是更高种类的，因此您可以在不需要语言扩展的情况下制作这些实例。

## 示例：解析器

假设我们正在解析一些声明，因此我们导入了我们需要的所有内容

```
import Text.Parsec
import Text.Parsec.String
import Control.Applicative ((<$>),(<*>),liftA2,empty)
import Data.Monoid
import Data.Char 
```

并考虑我们将如何解析类型。我们选择简单：

```
data Type = Literal String | Variable String  deriving Show
examples = [Literal "Int",Variable "a"] 
```

现在让我们为文字类型编写一个解析器：

```
literal :: Parser Type
literal = fmap Literal $ (:) <$> upper <*> many alphaNum 
```

含义：解析一个`upper`大小写字符，然后是`many alphaNum`eric 字符，将结果与纯函数组合成一个字符串`(:)`。然后，应用纯函数`Literal`将这些`String`s 变成`Type`s。我们将以完全相同的方式解析变量类型，除了以`lower`大小写字母开头：

```
variable :: Parser Type
variable = fmap Variable $ (:) <$> lower <*> many alphaNum 
```

太好了，`parseTest literal "Bool" == Literal "Bool"`正如我们所希望的那样。

## 问题 3a：如果要将 applicative 的效果与 Monoid 的行为结合起来，为什么不直接`liftA2 mappend`

编辑：哎呀-忘了实际使用`<|>`！
现在让我们使用 Alternative 组合这两个解析器：

```
types :: Parser Type
types = literal <|> variable 
```

这可以解析任何 Type:`parseTest types "Int" == Literal "Bool"`和`parseTest types "a" == Variable "a"`. 这结合了两个*解析器*，而不是两个*值*。这就是它在 Applicative Functor 级别而不是数据级别上工作的意义。

但是，如果我们尝试：

```
litvar = liftA2 mappend literal variable 
```

那将要求编译器在数据级别组合它们生成的两个*值。*我们得到

```
No instance for (Monoid Type)
  arising from a use of `mappend'
Possible fix: add an instance declaration for (Monoid Type)
In the first argument of `liftA2', namely `mappend'
In the expression: liftA2 mappend literal variable
In an equation for `litvar':
    litvar = liftA2 mappend literal variable 
```

所以我们发现了第一件事；Alternative 类做了一些与 真正不同的事情`liftA2 mappend`，因为它组合了不同级别的对象——它组合了解析器，而不是解析的数据。如果你喜欢这样想，它是真正更高层次的结合，而不仅仅是提升。我不喜欢这样说，因为`Parser Type`有 kind `*`，但确实可以说我们正在组合`Parser`s，而不是`Type`s。

（即使对于具有 Monoid 实例的类型，也不会`liftA2 mappend`为您提供与`<|>`.它失败了。）`Parser String``liftA2 mappend``<|>`

## 问题 3b：Alternative`<|> :: f a -> f a -> f a`与 Monoid有何不同`mappend :: b -> b -> b`？

首先，您正确地注意到它没有在 Monoid 实例上提供新功能。

然而，其次，直接使用 Monoid 存在一个问题：让我们尝试`mappend`在解析器上使用，同时显示它与以下结构相同`Alternative`：

```
instance Monoid (Parser a) where
    mempty = empty
    mappend = (<|>) 
```

哎呀！我们得到

```
Illegal instance declaration for `Monoid (Parser a)'
  (All instance types must be of the form (T t1 ... tn)
   where T is not a synonym.
   Use -XTypeSynonymInstances if you want to disable this.)
In the instance declaration for `Monoid (Parser a)' 
```

因此，如果您有一个 applicative functor `f`，该`Alternative`实例显示它`f a`是一个幺半群，但您只能将其声明为`Monoid`带有语言扩展的 a。

一旦我们`{-# LANGUAGE TypeSynonymInstances #-}`在文件顶部添加，我们就可以定义

```
typeParser = literal `mappend` variable 
```

令我们高兴的是，它起作用了：`parseTest typeParser "Yes" == Literal "Yes"`并且`parseTest typeParser "a" == Literal "a"`.

即使您没有任何同义词（`Parser`并且`String`是同义词，所以它们已经出局了），您仍然需要`{-# LANGUAGE FlexibleInstances #-}`定义一个像这样的实例：

```
data MyMaybe a = MyJust a | MyNothing deriving Show
instance Monoid (MyMaybe Int) where
   mempty = MyNothing
   mappend MyNothing x = x
   mappend x MyNothing = x
   mappend (MyJust a) (MyJust b) = MyJust (a + b) 
```

（Maybe 的幺半群实例通过提升底层幺半群来解决这个问题。）

使标准库不必要地依赖于语言扩展显然是不可取的。

* * *

所以你有它。Alternative 只是 Applicative Functors 的 Monoid（而且不仅仅是 Monoid 的提升）。它需要更高种类的类型`f a -> f a -> f a`，因此您可以在没有语言扩展的情况下定义一个。

## 为了完整起见，您的其他问题：

1.  为什么 Alternative 需要一个空的方法/成员？
    因为拥有一个操作的身份有时很有用。例如，您可以`anyA = foldr (<|>) empty`在不使用繁琐的边缘情况的情况下进行定义。

2.  MonadPlus 类型类的意义何在？我不能通过将某些东西同时用作 Monad 和 Alternative 来解锁它的所有优点吗？不，我请您回到[您链接到的问题](https://stackoverflow.com/questions/10167879/distinction-between-typeclasses-monadplus-alternative-and-monoid)：

> 此外，即使 Applicative 是 Monad 的超类，你最终还是需要 MonadPlus 类，因为`empty <*> m = empty`严格遵守并不足以证明这一点`empty >>= f = empty`。

....我想出了一个例子：也许。[我详细解释了这个答案](https://stackoverflow.com/questions/13122489/whats-an-example-of-a-monad-which-is-an-alternative-but-not-a-monadplus/13124491#13124491)，并在 Antal 的问题中提供了证据。出于此答案的目的，值得注意的是，我能够使用 >>= 来制作违反替代法的 MonadPlus 实例。

* * *

Monoid 结构很有用。Alternative 是为 Applicative Functors 提供它的最佳方式。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-10-31T22:44:02.333

我不会介绍 MonadPlus，因为对其法律存在分歧。

* * *

在尝试并未能找到任何有意义的示例之后，Applicative 的结构自然会导致与其 Monoid 实例不一致的 Alternative 实例*，我终于想出了这个：

**Alternative 的定律比 Monoid 的更严格，因为结果*不能*依赖于内部类型。这将大量 Monoid 实例排除在 Alternatives 之外。** 这些数据类型允许部分（意味着它们仅适用于某些内部类型） Monoid 实例，这些实例被该类型的额外“结构”禁止`* -> *`。例子：

*   Monoid 的标准 Maybe 实例假定内部类型是 Monoid => 而不是 Alternative

*   ZipLists、元组和函数都可以做成 Monoids，*如果*它们的内部类型是 Monoids => not Alternatives

*   具有至少一个元素的序列 - 不能是替代品，因为没有`empty`：

    ```
    data Seq a
        = End a
        | Cons a (Seq a)
      deriving (Show, Eq, Ord) 
    ```

另一方面，某些数据类型不能成为 Alternatives，因为它们是`*`-kinded：

*   单元 - `()`
*   `Ordering`
*   数字，布尔值

我推断的结论： **对于同时具有 Alternative 和 Monoid 实例的类型，这些实例应该是相同的。** 另请参阅[此答案](https://stackoverflow.com/a/12843218/894284)。

* * *

[排除可能，我认为这不算数，因为它的标准实例不应该要求 Monoid 作为内部类型，在这种情况下，它将与 Alternative 相同]

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-10-26T12:00:37.867

> 我将 Alternative 类型类的要点理解为在两件事之间进行选择，而我将 Monoids 理解为是关于组合事物。

如果您考虑一下，它们是相同的。

`+`结合事物（通常是数字），它的类型签名是（`Int -> Int -> Int`或其他）。

运算符在`<|>`选项之间进行选择，它的类型签名也是一样的：取两个匹配的东西并返回一个组合的东西。***

# android - endCall() 函数不起作用

> ID：13080615
> 
> 赞同：0
> 
> 时间：2012-10-26T04:12:03.437
> 
> 标签：android

我的 Manifest.xml：</p>

```
<uses-permission android:name="android.permission.READ_PHONE_STATE" />
<uses-permission android:name="android.permission.CALL_PHONE" /> 
```

我可以捕获所有收入电话号码并将其保存在我的数据库中。但在某些手机中，函数 endCall() 不起作用。钟声依旧响起。我怎么解决这个问题？谢谢。

```
public class CallReceiver extends BroadcastReceiver {

    public static final String TEST_NUMBER = "62419770";

    private static final String ACTION = "android.intent.action.PHONE_STATE";

    private ITelephony iTelephony;
    private AudioManager mAudioManager;

    public void onReceive(Context context, Intent intent) {
        mAudioManager = (AudioManager) context.getSystemService(Context.AUDIO_SERVICE);
        TelephonyManager telephonyMgr = (TelephonyManager) context.getSystemService(Context.TELEPHONY_SERVICE);

        try {
            Method getITelephonyMethod = TelephonyManager.class.getDeclaredMethod("getITelephony", (Class[]) null);
            getITelephonyMethod.setAccessible(true);
            iTelephony = (ITelephony) getITelephonyMethod.invoke(telephonyMgr,(Object[]) null);
        }
        catch (Exception e) {
            e.printStackTrace();
        }

        String action = intent.getAction();

        if (ACTION.equals(action)) {
            String state = intent.getStringExtra(TelephonyManager.EXTRA_STATE);
            String number = intent.getStringExtra(TelephonyManager.EXTRA_INCOMING_NUMBER);
            if (state.equalsIgnoreCase(TelephonyManager.EXTRA_STATE_RINGING)) {
                 if(NameListData.hasCallName(number,DataBase.NameRecord.TYPE_BLACK))
                 {
                    mAudioManager.setRingerMode(AudioManager.RINGER_MODE_SILENT);
                    try {
                        iTelephony.endCall();
                        mAudioManager.setRingerMode(AudioManager.RINGER_MODE_NORMAL);
                        NotificationUtils.showSingleNotification(context,
                                context.getString(R.string.notification_intercept_phone_title),
                                number, InterceptListActivity.class,NotificationUtils.mInterceptrCallNotificationId);    
                        HarassCallUtils.addHarassCall(context, new CallItem(0, number, new Date().getTime(), 0 ,false));
                    } catch (Exception e) {
                        e.printStackTrace();
                    }                    
                }
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-29T12:15:42.287

尝试像这样使用耳机功能：

```
public class CallReceiver extends BroadcastReceiver {
...
    try {
        endCallAidl(context);
    }
    catch (Exception e) {
        e.printStackTrace();
        Log.d("EndCall","Error trying to end call using telephony service.  Falling back to headset.");
            endPhoneHeadsethook(context);
    } 
...
}

private void endPhoneHeadsethook(Context context) {
Intent headSetUnPluggedintent = new Intent(Intent.ACTION_HEADSET_PLUG);
    headSetUnPluggedintent.addFlags(Intent.FLAG_RECEIVER_REGISTERED_ONLY);
    String origState = headSetUnPluggedintent.getStringExtra("state");
    headSetUnPluggedintent.putExtra("state", 1);
    headSetUnPluggedintent.putExtra("name", "Headset");

    // TODO: Should we require a permission?
    sendOrderedBroadcast(headSetUnPluggedintent, null);

    Intent buttonUp = new Intent(Intent.ACTION_MEDIA_BUTTON);             
    buttonUp.putExtra(Intent.EXTRA_KEY_EVENT, new KeyEvent(KeyEvent.ACTION_DOWN, KeyEvent.KEYCODE_HEADSETHOOK));
    getBaseContext().sendOrderedBroadcast(buttonUp, "android.permission.CALL_PRIVILEGED");

    // froyo and beyond trigger on buttonDown instead of buttonUp
    Intent buttonDown = new Intent(Intent.ACTION_MEDIA_BUTTON);             
    buttonDown.putExtra(Intent.EXTRA_KEY_EVENT, new KeyEvent(KeyEvent.ACTION_DOWN, KeyEvent.KEYCODE_HEADSETHOOK));
    context.sendOrderedBroadcast(buttonDown, "android.permission.CALL_PRIVILEGED");

    if (origState != "1"){
        headSetUnPluggedintent.putExtra("state", 0);
        sendOrderedBroadcast(headSetUnPluggedintent, null);
    } 
}

@SuppressWarnings({ "unchecked", "rawtypes" })
private void endCallAidl(Context context) throws Exception {

        // Set up communication with the telephony service (thanks to Tedd's Droid Tools!)
        TelephonyManager tm = (TelephonyManager) getSystemService(TELEPHONY_SERVICE);
        Class c = Class.forName(tm.getClass().getName());
        Method m = c.getDeclaredMethod("getITelephony");
        m.setAccessible(true);
        ITelephony telephonyService;
        telephonyService = (ITelephony)m.invoke(tm);

        // end the call!
        telephonyService.endCall(); 
} 
```

# browser - 什么样的编程语言或软件可以模拟用户与浏览器的交互？

> ID：13080616
> 
> 赞同：3
> 
> 时间：2012-10-26T04:12:06.493
> 
> 标签：browser, webrat

您好我正在寻找某种软件（网络老鼠）/某种类型的编程语言可以模拟用户与浏览器的交互。就像水豚在铁轨上进行黄瓜测试一样。

情况是我希望（软件/脚本语言）每天打开浏览器并登录论坛并单击某个链接。

你们有什么建议吗？

非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T04:13:59.553

请参阅 seleniumhq.org 上的 Selenium。

# java - 获取 Lotus Domino 文档的创建者和最后一个修改器

> ID：13080622
> 
> 赞同：2
> 
> 时间：2012-10-26T04:13:17.920
> 
> 标签：java, lotus-notes, lotus-domino, lotus

我想获取 Lotus Domino 文档的创建者和最后一个修改器。我怎么能这样做？

我找到了[`Authors`property](http://publib.boulder.ibm.com/infocenter/domhelp/v8r0/index.jsp?topic=%2Fcom.ibm.designer.domino.main.doc%2FH_NOTESNOTECOLLECTION_CLASS.html)，它是 a`Vector`但文档中没有定义它的顺序。我可以依赖第一个元素是创建者，最后一个元素是最后一个修饰符吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-01T21:35:06.760

最安全的解决方案是在设计上设置一个“组合时计算”类型字段，该字段在创建文档时设置为当前用户，另一个包含最后一个修饰符名称（类似于事件`@SetField("LastUpdatedby";@UserName)`中的名称`QuerySave`）。

在您的情况下，如果您只想从现有应用程序中收集数据并且没有可以使用的手动添加字段，则需要考虑一些事实：

1.) `$UpdatedBy`item 和 Authors 属性相同：使用 Lotusscript 中的 Authors 属性将返回从`$Updatedby`item 收集的数组。

2.）该`$UpdatedBy`项目不能被操纵=从这方面来说，使用它是安全的

3.) 假设您已经掌握了整个历史*，您将使用类似`@Subset($Updatedby;1)`或`Cstr(updatedbyarray(Lbound(updatedbyarray)))`in lotusscript的公式获得创建者

4.) 通过使用or查看`$Updatedby`数组中的最后一个条目，您将始终获得最后一个修饰符。`@Subset($Updatedby;-1)``Cstr(array(Ubound(array)))`

5 *。）您的数据库可能对条目有限制`$Updatedby`，因为这些可能会占用大量空间（数据库级别设置，最后一个选项卡，限制`$UpdatedBy`字段中的条目）。一旦达到此限制，Notes 将在有新条目添加时开始删除旧条目，并且查询数组的第一个成员将不再为您提供创建者。

6.) 由于您可能在数组中找不到创建者`$Updatedby`，您应该使用以下方式保护您的代码：

```
If Ubound(var)+1 <> db.LimitUpdatedBy Then 
    'You are safe
Else 
    Msgbox "Ouch!"
End If 
```

如果它是安全的，您可以继续使用该`$Updatedby`项目进行计算。顺便说一句，使用我们的 (Ytria) scanEZ 产品，您将能够为数据库中的所有文档收集这些值，而无需任何编码。几个简单的公式，您已经准备好将完整的报告导出到 DXL 或 CSV。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-26T09:14:47.323

尝试`$UpdatedBy`直接使用字段。（我认为`Authors`属性也使用它。）在这个字段中，所有更新程序都按时间顺序存储：发起者——首先，最后修改——最后。

*如果在数据库属性中设置了“限制字段中的**条目`$UpdatedBy`*”选项，它可能会向您显示错误的数据：当达到限制时，它会删除 中的第一个条目`$UpdatedBy`，因此您无法了解文档创建者。

# jquery - 使用 Jquery 如何添加基于 JSON 结果的 HTML 元素

> ID：13080629
> 
> 赞同：0
> 
> 时间：2012-10-26T04:15:15.200
> 
> 标签：jquery, html, ajax, json

如果我的 Json 对象返回 true，那么这就是我目前所拥有的，然后我将 class error_back 添加到#message 否则添加 class success_back。这可以正常工作，但现在我想添加一个按钮，所以我尝试了这个：

**无效的代码**

```
 $('#message').append((data.error === true) ? 
 '<input type='submit' name='submit' class='button' id='submit_btn' value='Go back' />' : '' ); 
```

**正常工作：**

```
 $('#message').removeClass().addClass((data.error === true) ? 'error_back' : 'success_back').text(data.msg); 
```

添加按钮的正确方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T04:22:39.067

如果您查看突出显示的代码，您会注意到它看起来很奇怪。您正在使用单引号来包装您的字符串，但您也在字符串中使用单*引号*。

就个人而言，我尽量避免构造 HTML 字符串：

```
if (data.error) {
    $('<input />', {
        type: 'submit',
        name: 'submit',
        'class': 'button',  // `class` is a reserved keyword
        id: 'submit_btn',
        value: 'Go back'
    }).appendTo('#message');
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-26T04:18:36.120

您的代码中存在语法错误，您不应嵌套单引号。

```
$('#message').append( data.error ? '<input type="submit" name="submit" class="button" id="submit_btn" value="Go back" />' : '' ); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-26T04:22:45.840

这是无效的，因为**引号** ..您正在使用**Single Quote '**来封装字符串并封装属性.. 所以它不会正确解释.. 为了避免使用**Double Quotes "**来修复它或需要转义单引号..

```
$('#message').append(data.error  ? 
 "<input type='submit' name='submit' 
              class='button' id='submit_btn' value='Go back' />" : " " ); 
```

\OR**转义引号**

```
$('#message').append(data.error ? 
     '<input type=\'submit\' name=\'submit\' 
                  class=\'button\' id=\'submit_btn\' value=\'Go back\' />' : ' ' ); 
```

# flash - 在执行 gotoAndPlay("loop"); 之前，循环素材在最后一个关键帧处暂停

> ID：13080633
> 
> 赞同：0
> 
> 时间：2012-10-26T04:15:36.137
> 
> 标签：flash, loops, actionscript

将 Flash Professional CS5 与 Actionscript 一起使用：我有一部 6 秒的电影，我需要在播放一次后从中途点连续循环播放。

我用过 gotoAndPlay("loop"); 脚本来循环它。但是，在每次循环之前，最后一个关键帧都有明显的停顿，这破坏了动画的基本流程。

可以在这里查看：http: [//vivalasvacations.com/108/W2U/W2UComp06 (LOOPED).swf](http://vivalasvacations.com/108/W2U/W2UComp06(LOOPED).swf)

地球在旋转一圈后暂停，然后再重复。

有人对我如何摆脱这个可怕的停顿项目有任何建议吗？也许另一种循环方法可以使事情变得更顺利？

谢谢，史蒂夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T09:25:02.503

循环时不应有任何明显的停顿。我的猜测是这是由于重复的帧。尝试以下操作：

1.  检查旋转地球动画的第一帧和最后一帧是否不相同
2.  检查动画的开始和结束是否有重复的帧

**更新：**

我从您的个人资料中看到，您之前曾两次问过同样的问题，并且在这两种情况下都收到了非常相似的回答。我的建议是您将文件上传到某处并将指向它的链接放在您的帖子和我的回答下的评论中。如果你这样做，我会看看，看看我是否能找出问题所在。

**更新二：**

我认为问题可能是因为您的动画是`FLV`基于的。我建议使用视频的每一帧的关键帧重新编码文件（编码软件中应该有一个设置允许这样做），这会增加文件大小，但应该意味着它可以顺利循环。

# matlab - 如何在 Matlab 中删除重复次数不够的行？

> ID：13080634
> 
> 赞同：0
> 
> 时间：2012-10-26T04:15:55.933
> 
> 标签：matlab, delete-row

我有一个这样的一列矩阵：

神经网络

神经网络

神经网络

AAA

AAA

CCC

CCC

DDD

DDD

DDD

我想删除我没有 3 次重复的所有行。这将导致删除第 4、5、6、7 行（结果将仅是矩阵，其余为：

神经网络

神经网络

神经网络

DDD

DDD

DDD

（PS：这些是字符串，而不是数字）。

有没有一种智能的方法可以使用 matlab 做到这一点？我的意思是，使用功能等？因为我用for解决了这个问题，但我认为这不是最好的方法，它必须有另一种方法。

我在这里先向您的帮助表示感谢！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T04:36:05.113

这应该这样做：

```
t=tabulate(x) % count how much each element appears
valid=t(cell2mat(t(:,2))>=3,1) % find strings that appear at least 3 times 
result=x(ismember(x,valid)) % select only these strings 
```

我在这里假设 x 是具有一列字符串的单元矩阵。如果 x 有其他列，则很容易解决。

# linux - 如何忽略脚本中的标准输入

> ID：13080636
> 
> 赞同：4
> 
> 时间：2012-10-26T04:16:14.123
> 
> 标签：linux, shell

我有一个程序“myprogram”，它在控制台上运行时等待输入键。在我们按下某个键后它会退出。我想在后台运行这个 myprogram 并忽略标准输入。

我有一个简单的脚本，

sample.sh 脚本

```
------
./myprogram &
exit 0
------ 
```

但是当我跑步时，

%sh 样本.sh

一些 myprogram 如何从 stdin 获取一些输入并退出。我想阻止它从 stdin 获取任何输入，所以即使在 sample.sh 退出后 myprogram 继续运行。

请建议我如何更新 sample.sh 脚本来实现这一点。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-26T04:21:12.433

您可以将程序的标准输入连接到`/dev/null`：

```
./myprogram < /dev/null & 
```

# php - 如果来自 Facebook，Referer 未显示

> ID：13080639
> 
> 赞同：2
> 
> 时间：2012-10-26T04:16:37.370
> 
> 标签：php, facebook, referer

好的，Facebook 上发生了一些非常可疑的事情（还有什么是新的），我已经研究和测试了一个多小时，但没有成功。

通过使用下面的 PHP 代码并将其发布到我的 Facebook 墙上然后单击它，一旦页面出现，它不会显示 Facebook 推荐地址。

但是，如果我从我自己的站点单击显示“测试链接”的链接，它会将我的服务器和文件 URL 显示为引用者。

还有其他人面临同样的问题吗？

我完全感到困惑。

这是我的代码：

```
<?php

echo $_SERVER['HTTP_REFERER'];

echo "<br>";

echo "<a href=\"test.php\">Test link</a>";

?> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-26T04:18:39.547

`HTTP_REFERER`不是强制性的 HTTP 标头。许多网站欺骗/删除它。Facebook 显然也是如此。

# python - 在 Fabric 中切换用户

> ID：13080643
> 
> 赞同：20
> 
> 时间：2012-10-26T04:16:49.067
> 
> 标签：python, fabric

我在使用 Fabric 模拟我的 SSH 工作流程来部署我的 Web 应用程序时遇到问题。

这是我通过 SSH 连接到服务器时的常用命令流程：

1.  SSH 使用 root 用户。ssh root@1.2.3.4
2.  切换到网页用户：su - web
3.  更改目录：cd /srv/web/prod/abc_project
4.  启动 virtualenv：workon abc_env
5.  执行 git pull：git pull origin master
6.  运行脚本： build_stuff -m build
7.  运行另一个脚本：./run

我尝试将其编写为 Fabric 中的部署脚本，并在输入 su - web 时得到 shell 输出。我必须按 Ctrl-D 才能继续脚本。我也无法激活我的 virtualenv ....因为：su - web 成功将用户切换到`web`但由于 Ctrl-d（以便我可以继续 Fabric 脚本），它会注销该用户并返回到 root .

这是我的脚本：

```
env.user = 'root'

@roles('web')
def deploy():
    dev_path = '/srv/web/prod'
    app_path = '/srv/web/prod/rhino'
    workon = 'workon rhino_env'
    with prefix('su - web'):
        puts('Switched to `web` user')
        with settings(warn_only=True):
            run('kill -9 `cat /srv/web/run/rhino/rhino.pid`')
            puts('Stopped rhino...')
        with cd(app_path):
            run('git reset --hard HEAD')
            puts('Discarded all untracked and modified files')
            run('git checkout master')
            run('git pull origin master')
            users = run('users')
            puts('Output from `users` command: %s' % users)
            run(workon)
            run('build_assets -m build')
        run('cd %(dev_path)s; chown -R web:ebalu rhino' % {'dev_path': dev_path})
        run('cd %(app_path)s; ./run' % {'app_path': app_path})
        pid = run('cat /srv/web/run/rhino/rhino.pid')
        puts('Rhino started again with pid: %s.' % pid) 
```

...还有一件事：不，我最初无法以 Web 身份登录，我必须以 root 身份登录。拥有 virtualenv 而不是 root 用户的是 web 用户。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-10-26T18:56:00.213

首先，您应该`sudo`在另一个用户下执行命令时使用。其次，`workon`为当前 shell 设置环境变量。由于fabric 为每个命令调用新的shell，因此您应该`workon rhino_env`在需要virtualenv（即作为前缀）的每个命令中运行。通过此编辑，您的代码应如下所示：

```
env.user = 'root'

@roles('web')
def deploy():
    dev_path = '/srv/web/prod'
    app_path = '/srv/web/prod/rhino'
    workon = 'workon rhino_env; '
    with settings(warn_only=True):
        run('kill -9 `cat /srv/web/run/rhino/rhino.pid`')
        puts('Stopped rhino...')
    with cd(app_path):
        sudo('git reset --hard HEAD', user='web')
        puts('Discarded all untracked and modified files')
        sudo('git checkout master', user='web')
        sudo('git pull origin master', user='web')
        users = run('users')
        puts('Output from `users` command: %s' % users)

        with prefix(workon):
            sudo('build_assets -m build', user='web')
    with cd(dev_path):
        run('chown -R web:ebalu rhino')

    with cd(app_path):
        sudo('./run', user='web')

    pid = run('cat /srv/web/run/rhino/rhino.pid')
    puts('Rhino started again with pid: %s.' % pid) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-02-16T13:21:50.170

我实现这一目标的方式是

```
from fabric.api import settings

with settings(user='otheruser'):
    ... 
```

系统将提示您输入 的密码`otheruser`，但只有一次。所以它不是等价`sudo su otheruser`的，root登录到没有密码的用户帐户，而是一种在脚本中切换用户的简单方法，只需输入每个密码一次

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-26T08:00:58.153

一种可能的解决方案是使用[sudo](http://docs.fabfile.org/en/1.4.3/api/core/operations.html#fabric.operations.sudo)操作，而不是使用`su`.

# assembly - 初学者：无法解码此汇编代码

> ID：13080647
> 
> 赞同：2
> 
> 时间：2012-10-26T04:17:23.863
> 
> 标签：assembly, stack, 64-bit, cpu-registers

我对汇编语言真的很陌生，我正在尝试解码从二进制文件（使用 gdb）生成的汇编文件。我无法理解以下代码（这是新功能的开始）。我在 x64 机器上，`%rdi`拥有 6 位数字（我的输入）。所以让我们说那是`0 1 2 3 4 5`）

```
 400e79:       55                      push   %rbp
   400e7a:       48 89 e5                mov    %rsp,%rbp
   400e7d:       48 83 ec 30             sub    $0x30,%rsp
   400e81:       48 89 7d d8             mov    %rdi,-0x28(%rbp)
   400e85:       48 8d 75 e0             lea    -0x20(%rbp),%rsi
   400e89:       48 8b 7d d8             mov    -0x28(%rbp),%rdi 
```

如果可以的话，我想向您展示我的想法：

`400e79`：所以当我们启动一个函数时，我们将旧的基指针压入堆栈。所以堆栈看起来像：

```
 RETURN ADDRESS
 old %rbp value  <--- %rsp 
```

`400e7a`：堆栈看起来像：

```
 RETURN ADDRESS
 old %rbp value <---- %rsp, %rbp 
```

`400e7d`：堆栈看起来像：

```
 RETURN ADDRESS
 old %rbp value  <----%rbp
 ----empty----
 ----empty----
 ----empty----
 ----empty----
 ----empty----
 ----empty----  <---%rsp 
```

`400e81`: 这里的东西让我很困惑。我们正在将`%rdi`( `0 1 2 3 4 5`) 中的内容移动到`-0x28(%rbp)`. 所以堆栈看起来像：

```
 RETURN ADDRESS
 old %rbp value  <----%rbp
 ----empty----
 ----empty----
 ----empty----
 ----empty----
 0 1 2 3 4 5
 ----empty----  <---%rsp 
```

但是，当我尝试通过在 gdb`-0x28(%rbp)`上运行来查看内容时`x/s $rbp-0x28`，我没有得到`0 1 2 3 4 5`预期的结果，但我得到了`"\020C"`. 我运行正确吗？

`400e85:`堆：

```
 RETURN ADDRESS
 old %rbp value  <----%rbp
 ----empty----
 ----empty----
 ----empty----
 ----empty---- <--- %rsi
 0 1 2 3 4 5
 ----empty----  <---%rsp 
```

`400e89:`我完全不明白这一点。刚才我们做`mov %rdi,-0x28(%rbp)`了，为什么现在做`mov -0x28(%rbp),%rdi`？这不是重复吗？

非常感谢！我知道这真的很长，感谢您抽出时间帮助我！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T05:10:42.510

你的分析是正确的。

运行时得到奇怪结果的原因`x/s $rbp-0x28`是您不能将字符串放入寄存器中。寄存器包含的值很可能是指向该字符串的指针，这意味着您需要另一个级别的间接来读取它。我相信这会奏效：

```
p/x *(char**)($rbp-0x28)
x/s $ 
```

至于无用的负载，这对于未经优化编译的代码很常见。编译器盲目地将每一行转换为汇编，而不考虑当前寄存器值。我已经看到代码通过几个寄存器将单个值传递回它最初所在的寄存器。

# c++ - 如何使用锁定缓冲区

> ID：13080659
> 
> 赞同：-2
> 
> 时间：2012-10-26T04:18:56.913
> 
> 标签：c++, buffer, boost-asio, blocking

我应该使用哪种锁来解决可能的使用冲突`recieveBuffer`？（锁定/解锁）。

这是我的坏锁的客户端代码：

```
class TCPClient
{
    public:
        static const size_t maxBufLen = 100;
        static const size_t MAX_INPUT_SIZE = 10;

        TCPClient(boost::asio::io_service& IO_Service, tcp::resolver::iterator EndPointIter);
        void close();

    private:
        boost::asio::io_service& m_IOService;
        tcp::socket m_Socket;

        char recieveBuffer[maxBufLen];

        void promptTxMsgLoop();
        void onConnect(const boost::system::error_code& ErrorCode, tcp::resolver::iterator EndPointIter);
        void onReceive(const boost::system::error_code& ErrorCode);
        void onSend(const boost::system::error_code& ErrorCode);
        void doClose();
};

TCPClient::TCPClient(boost::asio::io_service& IO_Service, tcp::resolver::iterator EndPointIter)
: m_IOService(IO_Service), m_Socket(IO_Service)
{
    tcp::endpoint EndPoint = *EndPointIter;
    recieveBuffer[0] = '\0';

    m_Socket.async_connect(EndPoint,
        boost::bind(&TCPClient::onConnect, this, boost::asio::placeholders::error, ++EndPointIter));
}

void TCPClient::onConnect(const boost::system::error_code& ErrorCode, tcp::resolver::iterator EndPointIter)
{
    if (ErrorCode == 0)
    {
        this->promptTxMsgLoop();
    }
    else if (EndPointIter != tcp::resolver::iterator())
    {
        cout << "m_Socket.close();!" << endl;
        m_Socket.close();
        tcp::endpoint EndPoint = *EndPointIter;

        m_Socket.async_connect(EndPoint, 
            boost::bind(&TCPClient::onConnect, this, boost::asio::placeholders::error, ++EndPointIter));
    }
}

void TCPClient::promptTxMsgLoop()
{
    recieveBuffer[0] = '\0';
    while (true)
    {
        cout << "> " ;
        string tmp;
        cin >> tmp;

        cout << "Entered: " << tmp << endl;
        tmp += "\0";

        if (tmp.length() < MAX_INPUT_SIZE-1)
        {
            try
            {
                //lock untill buffer is emty
                while (strlen(recieveBuffer) > 1)
                {

                }
                m_Socket.async_send(boost::asio::buffer(tmp.c_str(),tmp.length()+1),
                    boost::bind(&TCPClient::onSend, this, boost::asio::placeholders::error));
            }
            catch(exception &e)
            {
                cerr << "Cannot add msg to send queue... " << e.what() << endl;
            }
        }
        else
            cout << "Error: input string is too long. Max length is " << MAX_INPUT_SIZE-1 << endl;
    }
}

void TCPClient::onSend(const boost::system::error_code& ErrorCode)
{
    cout << "Msg has been sent..." << endl;

    if (strlen(recieveBuffer) > 1)
        cout << "ERROR: recieveBuffer in not epmty. Data is overritten!" << endl;

    if (!ErrorCode)
    {
        m_Socket.async_receive(boost::asio::buffer(recieveBuffer, TCPClient::maxBufLen),
            boost::bind(&TCPClient::onReceive, this, boost::asio::placeholders::error));
    }
    else
    {
        cout << "onSend closing" << endl;
        cout << "ERROR! onSend..." << ErrorCode << endl;
        doClose();
    }
}

void TCPClient::onReceive(const boost::system::error_code& ErrorCode)
{
    cout << "Msg has been received..." << endl;

    if (ErrorCode == 0)
    {
        cout << recieveBuffer << endl;
        cout << "msg length: " << strlen(recieveBuffer) << endl;

        //unlock buffer
        recieveBuffer[0] = '\0';
    } 
    else 
    {
        cout << "ERROR! onReceive..." << ErrorCode << endl;
        doClose();
    }
}

void TCPClient::doClose()
{
    m_Socket.close();
}

int main()
{
    try 
    {
        boost::asio::io_service IO_Service;
        tcp::resolver Resolver(IO_Service);
        tcp::resolver::query Query("127.0.0.1", "1");
        tcp::resolver::iterator EndPointIterator = Resolver.resolve(Query);
        TCPClient Client(IO_Service, EndPointIterator);
        boost::thread ClientThread(boost::bind(&boost::asio::io_service::run, &IO_Service));
        ClientThread.join();
        Client.close();
    } 
    catch (exception& e)
    {
        cerr << e.what() << endl;
    }

    cout << "\nClosing";
    getch();

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T04:27:52.550

您可能正在寻找一个`mutex`锁（又名“互斥锁”）。

# ruby-on-rails - 如何在没有文件或行参考的情况下运行指南针编译？

> ID：13080662
> 
> 赞同：6
> 
> 时间：2012-10-26T04:19:12.843
> 
> 标签：ruby-on-rails, sass, compass-sass, compass

如何在运行时抑制文件或行引用，例如下面的注释输出行，`compass compile`并可能`--output-style`在默认情况下保持扩展？

```
/* line 85, ../../../app/stylesheets/simpla/style.sass */
.align-right { 
  float: right;
} 
```

问题是每当我在 sass 中进行 1 行更改时，它都会对我的 css 进行 50 多行更改以更新所有已调整的参考行号。这使得阅读我的 git 提交中的实际更改变得非常困难。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-26T05:07:08.837

没关系，刚刚想通了。在 config/compass.rb 中，设置：

```
line_comments = false 
```

这将抑制/删除已编译 css 文件中的注释。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-29T10:14:55.003

只是为了更新之前的答案，由 Chase T.

对我来说，这不再起作用了。

```
line_comments = false 
```

应该成为

```
line_comments = 0 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-17T13:45:50.980

从命令行，尝试：

```
compass compile --no-line-comments 
```

* * *

如果您使用 Grunt 和[grunt-contrib-compass](https://github.com/gruntjs/grunt-contrib-compass)，它是`noLineComments: true`，例如

```
module.exports = function (grunt) {
    grunt.initConfig({
        watch: {
            src: {
                files: ['**/*.scss', '**/*.php'],
                tasks: ['compass:dev']
            },
            options: {
                livereload: true
            }
        },
        compass: {
            dev: {
                options: {
                    sassDir: 'sass',
                    cssDir: 'css',
                    imagesPath: 'img',
                    noLineComments: true,
                    outputStyle: 'compressed'
                }
            }
        }
    });
    grunt.loadNpmTasks('grunt-contrib-compass');
    grunt.loadNpmTasks('grunt-contrib-sass');
    grunt.loadNpmTasks('grunt-contrib-watch');
}; 
```

然后运行：`grunt compass`。

# android - Android - 用手机拉动

> ID：13080664
> 
> 赞同：0
> 
> 时间：2012-10-26T04:19:20.067
> 
> 标签：android

有谁知道是否有办法检测用户何时用手机做出动作。特别是我试图检测用户何时快速向后（或朝向自己）移动。

有人知道任何解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T04:38:15.223

听起来您正在寻找加速度计。这是一个实现 SensorEventListener 的示例类，它侦听传感器运动。

```
public class AccelerometerHandler implements SensorEventListener
{
    float accelX;
    float accelY;
    float accelZ;

    public AccelerometerHandler(Context paramContext)
    {
        SensorManager localSensorManager = (SensorManager)paramContext.getSystemService("sensor");

        if (localSensorManager.getSensorList(1).size() != 0)
            localSensorManager.registerListener(this, (Sensor)localSensorManager.getSensorList(1).get(0), 1);
    }

    public float getAccelX()
    {
        return this.accelX;
    }

    public float getAccelY()
    {
        return this.accelY;
    }

    public float getAccelZ()
    {
        return this.accelZ;
    }

    public void onAccuracyChanged(Sensor paramSensor, int paramInt)
    {
    }

    public void onSensorChanged(SensorEvent paramSensorEvent)
    {
        this.accelX = paramSensorEvent.values[0];
        this.accelY = paramSensorEvent.values[1];
        this.accelZ = paramSensorEvent.values[2];
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T04:35:45.563

您需要将 sensorListener 实现为：

```
public class MotionActivity extends Activity implements SensorListener {

} 
```

它在 onSensorChanged 上有一个方法，shake 上的所有功能都可以在这个方法中实现：

```
public void onSensorChanged(int sensor, float[] values) {

} 
```

您可以访问[此处](http://developer.android.com/guide/topics/sensors/sensors_motion.html)的链接以使用 android 中的传感器

另请访问 stackoverflow[内部链接](https://stackoverflow.com/questions/3801345/find-left-and-right-turn-in-android-mobile)以获取更多信息。

# haskell - 仅当 isJust 时才应用函数

> ID：13080665
> 
> 赞同：5
> 
> 时间：2012-10-26T04:19:24.403
> 
> 标签：haskell

我正在寻找一种惯用的做事方式

```
moveMaybeCreature Nothing world = world
moveMaybeCreature (Just creature) world = moveCreature creature world 
```

或者换句话说

```
if isJust c
    then doSomething (fromJust c) w
    else w 
```

我以为我可以这样：

```
moveMaybeCreature c w = foldr moveCreature w (maybeToList c) 
```

我可以不用转换`Maybe Creature`成`[Creature]`吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-26T04:27:14.527

只要类型`world`和类型`moveCreature (fromJust c) world`相同，您就可以执行此操作。您可以使用`maybe`来自`Data.Maybe`.

```
 moveMaybeCreature = maybe id moveCreature 
```

您在模式匹配的第一种方式也应该可以正常工作。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-26T04:55:19.067

我支持使用该`maybe`功能的建议。你问这个问题是对的，因为这个一般的经验法则（不仅对你，而且对任何阅读它的新手）：具有类似`Maybe Foo -> Bar`或`Maybe Foo -> Maybe Bar`直接定义的类型的函数是 Haskell 中的[代码异味](http://en.wikipedia.org/wiki/Code_smell)。您几乎从不想编写一个`Maybe Foo`以参数为参数的函数；你想要一个只接受 的函数`Foo`，并使用一个高阶函数来适应它`Maybe Foo`。

假设你有一个函数`f' :: Maybe Foo -> Maybe Bar`。这通常可以重构为：

1.  `f :: Foo -> Bar`和`fmap f :: Maybe Foo -> Maybe Bar`;
2.  `f :: Foo -> Maybe Bar`和`(>>=f) :: Maybe Foo -> Maybe Bar`

第一种情况有效，因为这是 的`Functor`实例`Maybe`：

```
instance Functor Maybe where
    fmap f Nothing = Nothing
    fmap f (Just x) = Just (f x)

-- or this:
--     fmap f = maybe Nothing (Just . f) 
```

第二种情况有效，因为这是 的`Monad`实例`Maybe`：

```
instance Monad Maybe where
    return = Just
    Nothing >>= f = Nothing
    (Just x) >>= f = f x

-- or this:
--     mx >>= f = maybe Nothing f mx 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-26T08:32:32.113

这是另一个选项，更接近您的原始代码：

```
import qualified Data.Foldable as F

moveMaybeCreature = flip (F.foldr moveCreature) 
```

# java - java - 为什么在java src中Integer类的toString方法中使用负int进行mod操作

> ID：13080667
> 
> 赞同：12
> 
> 时间：2012-10-26T04:19:31.760
> 
> 标签：java, tostring, modulo

看了java 1.7.0_09版本的源码，发现Integer类的toString方法的实现使用负int来计算mod运算，有什么意义吗？代码如下：

```
public static String toString(int i, int radix) {

    if (radix < Character.MIN_RADIX || radix > Character.MAX_RADIX)
        radix = 10;

    /* Use the faster version */
    if (radix == 10) {
        return toString(i);
    }

    char buf[] = new char[33];
    boolean negative = (i < 0);
    int charPos = 32;

    if (!negative) {     
        i = -i;                //***** change i to negative
    }

    while (i <= -radix) {
        buf[charPos--] = digits[-(i % radix)];   //***** change back to positive after 
                                                 //***** mod operation
        i = i / radix;
    }
    buf[charPos] = digits[-i];

    if (negative) {
        buf[--charPos] = '-';
    }

    return new String(buf, charPos, (33 - charPos));
} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-26T05:08:06.470

根据该算法，您需要一个小的 ( `< radix`) 非负整数流，它将用从右到左的数字填充字符缓冲区。进行这项工作的标准小学方法是在数字的开头放一个符号，然后打印数字的绝对值。

但是想象一下，如果规则`i`在那个循环中总是积极的：

```
if (negative) {
    i = -i; // change i to positive
} 
```

如果`i`恰好是`Integer.MIN_VALUE`，那么`-i`也恰好是`Integer.MIN_VALUE`。[二进制补码](http://en.wikipedia.org/wiki/Two's_complement)整数变量可以存储的[负整数比它们存储的正整数多一个](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/datatypes.html)。但是，如果不变量`i`始终是*负*绝对值，则它将始终适合`int`.

为什么不直接使用`Math.abs()`或`if`阻止？自然地，整数在许多计算机程序中被非常频繁地转换为字符串，因此`toString`尽可能快地保持是很有用的。问题是，当编译为机器代码时，`Math.abs()`和`if`语句都可能被编译为使用分支指令。[分支](http://en.wikipedia.org/wiki/Instruction_pipeline#Branches)往往会干扰[指令流水线](http://en.wikipedia.org/wiki/Instruction_pipeline)；因此，在关注性能时，您可能会选择`if`尽可能从循环中删除语句。

注意：这种优化很少是一个好主意！除非您的代码被非常频繁地调用（例如此代码），或者您正在构建一个拥有大量用户和很少读者/修改器的库（例如此代码），否则性能提升是微乎其微的，并且它使代码更难阅读、理解和改变。通过进行这种优化，Java 工程师可能会稍微加快您的代码速度——但如果您将这样的技术应用到您编写的代码中，您的同事/评分者可能不会倾向于询问 Stack Overflow 为什么您的代码如此难以理解。:)

**TL;DR：**只是一个有根据的猜测，但这是二进制补码数学和代码优化的组合。

# objective-c - 关闭呈现的视图控制器

> ID：13080671
> 
> 赞同：3
> 
> 时间：2012-10-26T04:20:22.547
> 
> 标签：objective-c, ios, ipad

我正在使用 ARC + 故事板。

我没有使用 segues 或 UINavigationController，而是使用以下内容呈现每个单独的视图：

```
UIStoryboard *storyBoard = [UIStoryboard storyboardWithName:@"MainStoryboard" bundle:nil];
SecondViewController *secondViewController = [storyBoard instantiateViewControllerWithIdentifier:@"SecondVC"];

[self presentViewController:secondViewController animated:YES completion:nil]; 
```

所以，我的应用程序的典型流程是：

MainViewController `presentViewController:` SecondViewController `presentViewController:` ThirdViewController ...等

继续前进之后，我不希望我之前呈现的视图控制器在内存中徘徊。

现在，在我转到我的第二个视图控制器之后，我可以在 MainViewController 的计时器函数中设置一个断点，并验证一切是否仍然存在。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T04:41:10.627

**注意**：viewcontroller 是`automatically retained`when `presentViewController:`，但在 ARC 中它将处理保留的对象并在适当的时候释放它。

稍后打电话`dismissModalViewController`会`release the retained controller automatically`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T04:53:53.997

只有我，也许我没有正确阅读？似乎对呈现和呈现的视图控制器存在误解？

如果您的 MainViewController 在顶部，然后您调用： `[mainViewController presentViewController:secondVC animated:YES completion:nil];`然后 secondVC 成为呈现的控制器，而 mainViewController 成为它的presentingViewController。

* * *

也就是说，您似乎希望从内存中卸载呈现的视图控制器？

> “现在，在我转到我的第二个视图控制器之后，我可以在 MainViewController 的计时器函数中设置一个断点，并验证一切是否仍然存在。”

如果是这样，这并不是视图控制器在这样呈现时的行为方式。它将一直在内存中，`presentingViewController`直到它收到内存警告通知，然后如果它不在顶部，它将只卸载它的视图。（控制器对象本身仍然存在）。

简单地释放呈现控制器并不是一个好主意，因为它会破坏控制器之间的父子关系。您可以手动修复此问题，但在某些情况下可能会有点麻烦。如果您知道自己在做什么，就推荐。

如果你想真正杀死 presentingViewController 可能更好，你[创建一个额外的自定义容器视图控制器](http://developer.apple.com/library/ios/#featuredarticles/ViewControllerPGforiPhoneOS/BasicViewControllers/BasicViewControllers.html)，以便它呈现视图控制器并释放前一个。视图控制器并不昂贵，它的视图就是这样:)

**请注意**，即使您使用导航控制器，有关加载/卸载其视图的行为也会相似。只有视图被卸载，因为导航控制器保留了它所有的视图控制器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-08T09:30:23.267

可能这会有所帮助。

[viewController.view removeFromSuperview];

我在这里找到了它：[我怎样才能忽略视图？](https://stackoverflow.com/questions/5593438/how-can-i-dismiss-view)

# php - 第 15 行的 PHP 语法错误

> ID：13080672
> 
> 赞同：1
> 
> 时间：2012-10-26T04:20:23.890
> 
> 标签：php, wordpress

我收到以下错误：

解析错误：语法错误，意外的 T_STRING，期待 ',' 或 ';' 在第 15 行

```
<?php 
    if ( is_single() && $post->post_parent ) {
        echo '<script src="<?php bloginfo'template_directory'); ?>/_/js/ZeroClipboard.min.js"></script>';
        echo '<script src="<?php bloginfo('template_directory'); ?>/_/js/functions.js"></script>';
    }
?> 
```

第 15 行：`echo '<script src="<?php bloginfo'template_directory'); ?>/_/js/ZeroClipboard.min.js"></script>';`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T04:22:18.970

您缺少左括号，而且您`<?php ?>`在无效的 echo 语句中使用

```
 bloginfo('template_directory'); ?> 
```

正确的语法

```
<?php 
    if ( is_single() && $post->post_parent ) {
?>
       <script src="<?php echo bloginfo('template_directory'); ?>/_/js/ZeroClipboard.min.js"></script>
       <script src="<?php echo bloginfo('template_directory'); ?>/_/js/functions.js"></script>
<?php
    }
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T04:24:19.883

您正在回显文本，并且还应在回显文本中包含 php 标记

```
<?php 
if ( is_single() && $post->post_parent ) { ?>
    <script src="<?php bloginfo('template_directory'); ?>/_/js/ZeroClipboard.min.js">  </script>;
    <script src="<?php bloginfo('template_directory'); ?>/_/js/functions.js"></script>;
<?php }
?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-26T04:25:51.737

您在 bloginfo 之后错过了一个左括号，而且您无法在 php 脚本中打开新的 php 标签，因此这一行应该可以工作。

```
echo '<script src="'.bloginfo('template_directory') .'/_/js/ZeroClipboard.min.js"></script>'; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-26T04:26:12.530

```
<?php 
    if ( is_single() && $post->post_parent ) {
        echo '<script src="'.bloginfo('template_directory').
'/_/js/ZeroClipboard.min.js"></script><script src="'. bloginfo('template_directory').
'/_/js/functions.js"></script>';
    }
?> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-26T04:29:47.757

试试这个

```
if ( is_single() && $post->post_parent ) {
        echo '<script src='.bloginfo("template_directory").'/_/js/ZeroClipboard.min.js"></script>';
        echo '<script src='.bloginfo("template_directory").'/_/js/functions.js"></script>';
} 
```

# javascript - Javascript 二十一点游戏

> ID：13080675
> 
> 赞同：5
> 
> 时间：2012-10-26T04:20:33.683
> 
> 标签：javascript, blackjack

我正在为我的一类人开发一个 JavaScript 二十一点游戏。到目前为止，我有一种方法可以为牌组、玩家和庄家创建堆栈。另一个创建套牌，一个创建每张卡片作为一个对象。另一个洗牌，一个从牌堆中分发牌，另一个将这些牌添加到其他牌堆中。我试图让一些显示器在我完成之前看到到目前为止发生的事情，但对于我的生活，我什么也得不到。我已经盯着这个看了好几个小时，完全期望它是一些愚蠢的语法错误。我非常感谢任何可以帮我看看这个并告诉我为什么我没有让我的显示器出现的人。随意复制和修补。

```
<html>

<head>
<script type="text/javascript">

function stack()
{
    this.cards = new Array();

    this.makeDeck  = createDeck();
    this.shuffle   = shuffle();
    this.deal      = dealHand();
    this.addCard   = AddCard();
    this.combine   = Combine();
    this.cardCount = CardCount();
}

function createDeck()
{
    var ranks = new Array("Ace", "2", "3", "4", "5", "6", "7", "8", "9", "10", "Jack", "Queen", "King");
    var suits = new Array("Clubs", "Diamonds", "Hearts", "Spades");

    var  count = ranks.length * suits.length;
    count = parseInt(count);

    this.cards = new Array(count);

    for (s = 0; s < suits.length; s++)
    {
      for (r = 0; r < ranks.length; r++)
      {
         this.cards[s * ranks.length + r] = new card(ranks[r], suits[s]);
      }
    }
}

function card (inrank, insuit)
{
    this.suit = insuit;
    this.rank = inrank;
}

function shuffle(n) 
{
  var i, j, k;
  var temp;

    for (i = 0; i < n; i++)
    for (j = 0; j < this.cards.length; j++)
    {
      k = Math.floor(Math.random() * this.cards.length);
      temp = this.cards[j];
      this.cards[j] = this.cards[k];
      this.cards[k] = temp;
    }

function dealHand()
{
    return this.cards.shift();
}

function addCard(card)
{
    this.cards.push(card);
}

function newGame()
{
    var deck = new stack();
    var player = new stack();
    var dealer = new stack();

    deck.makeDeck;
    deck.shuffle;
    player.addCard(deck.deal);
    player.addCard(deck.deal);
    dealer.addCard(deck.deal);
    dealer.addCard(deck.deal);

    display();
    document.write("here");
}

function display()
{
document.display.player_card_1.value ="here"; //player.cards.card[0].rank + " of " + player.cards.card[0].suit;
//document.display.player_card_1_val.value = player.cards.card[0].value;
}

</script>
<style type="text/css">
input {
    background:transparent
}
</style>

</head>

<body>
<script type="text/javascript">

</script>
<table bgcolor="#33CC33">
    <tr>
        <td style="font:14pt bold">Your cards</td>
        <td></td>
        <td style="font:14pt bold">Dealer's cards</td>
        <td></td>
    </tr>
    <tr>
        <td><input type="text" readonly="readonly" value="" name="player_card_1"></td>
        <td><input type="text" readonly="readonly" value="" name="p_card_1_val"></td>
        <td><input type="password" readonly="readonly" value="" name="dealer_card_1"></td>
        <td><input type="password" readonly="readonly" value="" name="d_card_1_val"></td>
    </tr>
    <tr>
        <td><input type="text" readonly="readonly" value="" name="player_card_2"></td>
        <td><input type="text" readonly="readonly" value="" name="p_card_2_val"></td>
        <td><input type="text" readonly="readonly" value="" name="dealer_card_2"></td>
        <td><input type="text" readonly="readonly" value="" name="d_card_2_val"></td>
    </tr>
    <tr>
        <td><input type="text" readonly="readonly" value="" name="player_card_3"></td>
        <td><input type="text" readonly="readonly" value="" name="p_card_3_val"></td>
        <td><input type="text" readonly="readonly" value="" name="dealer_card_3"></td>
        <td><input type="text" readonly="readonly" value="" name="d_card_3_val"></td>
    </tr>
    <tr>
        <td><input type="text" readonly="readonly" value="" name="player_card_4"></td>
        <td><input type="text" readonly="readonly" value="" name="p_card_4_val"></td>
        <td><input type="text" readonly="readonly" value="" name="dealer_card_4"></td>
        <td><input type="text" readonly="readonly" value="" name="d_card_4_val"></td>
    </tr>
    <tr>
        <td><input type="text" readonly="readonly" value="" name="player_card_5"></td>
        <td><input type="text" readonly="readonly" value="" name="p_card_5_val"></td>
        <td><input type="text" readonly="readonly" value="" name="dealer_card_5"></td>
        <td><input type="text" readonly="readonly" value="" name="d_card_5_val"></td>
    </tr>
    <tr>
        <td><input type="text" readonly="readonly" value="Total"></td>
        <td><input type="text" readonly="readonly" value=""></td>
        <td><input type="text" readonly="readonly" value="Total"></td>
        <td><input type="text" readonly="readonly" value=""></td>
    </tr>
</table>
<br>
<form name="buttons" action="">
<input type="button" value="Deal" name="deal" onclick="newGame()">
<input type="button" value="Hit" name="hit">
<input type="button" value="Stand" name="stand">
</form>

</body>

</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T04:36:19.690

对于初学者，您的`shuffle()`函数缺少右括号：

改变这个：

```
function shuffle(n) 
{
  var i, j, k;
  var temp;

    for (i = 0; i < n; i++)
    for (j = 0; j < this.cards.length; j++)
    {
      k = Math.floor(Math.random() * this.cards.length);
      temp = this.cards[j];
      this.cards[j] = this.cards[k];
      this.cards[k] = temp;
    } 
```

对此：

```
function shuffle(n) 
{
  var i, j, k;
  var temp;

    for (i = 0; i < n; i++)
    for (j = 0; j < this.cards.length; j++)
    {
      k = Math.floor(Math.random() * this.cards.length);
      temp = this.cards[j];
      this.cards[j] = this.cards[k];
      this.cards[k] = temp;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T05:39:46.470

## 一些语法和逻辑问题

行中适当值的括号：

```
this.cards[s * ranks.length + r] = new card(ranks[r], suits[s]); 
```

作为

```
(s*ranks.length) + r 

!= 

s * (ranks.length + r) 
```

**编辑：** 我也不喜欢你的 stack() 函数有这么多本地“成员”。例如，您的播放器对象是否真的需要保存 createDeck() 或 shuffle() 的本地实例？这些应该具有更高（全局）范围的methinks。

我相信你把事情复杂化了。如果你愿意，我可以为你提供额外的建议，但会先看看这能走多远。:)

# android - 地图视图问题

> ID：13080677
> 
> 赞同：0
> 
> 时间：2012-10-26T04:20:44.280
> 
> 标签：android, android-mapview

我正在尝试制作一个应用程序，当您点击设置按钮并单击“切换到地图”时将切换到 MapView 但是每次强制关闭时。我似乎无法弄清楚问题是什么。我的老师没有解释如何做这一切，并告诉我们我们可以在互联网上弄清楚......她很好，对吗？

这是似乎有问题的班级。

```
 package com.example.zip.code;

import android.app.Activity;
import android.content.Intent;
import android.location.Criteria;
import android.location.Location;
import android.location.LocationManager;
import android.os.Bundle;
import android.view.Menu;
import android.view.MenuInflater;
import android.view.MenuItem;

import com.google.android.maps.MapView;
import com.google.android.maps.GeoPoint;
import com.google.android.maps.MapActivity;
import com.google.android.maps.MapController;

public class OpenMap extends Activity {
    private MapController mapController;
     private LocationManager locationManager;
      private String provider;
      double lat;
      double lng;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.maplayout);

        Criteria criteria = new Criteria();
        provider = locationManager.getBestProvider(criteria, false);
        Location location = locationManager.getLastKnownLocation(provider);

        // Get Mapping Controllers etc
        MapView mapView = (MapView) findViewById(R.id.map_view);
        mapController = mapView.getController();

        // Center on Current Position
        mapController.setCenter(new GeoPoint((int) (location.getLatitude() * 1E6),
                                                  (int) (location.getLongitude() * 1E6)));
        mapController.setZoom(11);
        mapView.setBuiltInZoomControls(true);

    }

    protected boolean isRouteDisplayed() {
        // TODO Auto-generated method stub
        return false;
    }

    @Override
      public boolean onCreateOptionsMenu(Menu menu) {
          MenuInflater inflater = getMenuInflater();
          inflater.inflate(R.menu.mapsettings, menu);
          return true;
      }

      @Override
      public boolean onOptionsItemSelected(MenuItem item) {
          // Handle item selection
          switch (item.getItemId()) {
              case R.id.zipswap:
                  swapToZip();
                  return true;
              default:
                  return super.onOptionsItemSelected(item);
          }
      }

      public void swapToZip(){
          Intent i = new Intent(getApplicationContext(), MainActivity.class);
          startActivity(i);
      }
} 
```

这是相应的 XML 文件。

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent">

    <com.google.android.maps.MapView
        android:id="@+id/map_view"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:enabled="true"
        android:clickable="true"
        android:apiKey="ADD YOUR API KEY HERE"
        />

    <LinearLayout android:id="@+id/zoom"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:layout_centerHorizontal="true"
        /> 

</RelativeLayout> 
```

这是导致问题的类的类。包 com.example.zip.code；

```
import java.io.IOException;
import java.util.List;
import java.util.Locale;

import android.os.Bundle;
import android.app.Activity;
import android.view.Menu;
import android.view.MenuInflater;
import android.view.MenuItem;
import android.support.v4.app.NavUtils;
import android.content.Context;
import android.content.Intent;
import android.location.Address;
import android.location.Criteria;
import android.location.Geocoder;
import android.location.Location;
import android.location.LocationListener;
import android.location.LocationManager;
import android.widget.TextView;
import android.widget.Toast;

public class MainActivity extends Activity implements LocationListener {

     private TextView latituteField;
      private TextView longitudeField;
      private TextView zipField;
      private TextView cityField;
      private LocationManager locationManager;
      private String provider;
      double lat;
      double lng;

      @Override
      public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        latituteField = (TextView) findViewById(R.id.TextView02);
        longitudeField = (TextView) findViewById(R.id.TextView04);
        zipField = (TextView) findViewById(R.id.textView6);
        cityField = (TextView) findViewById(R.id.textView2);

        // Get the location manager
        locationManager = (LocationManager) getSystemService(Context.LOCATION_SERVICE);
        // Define the criteria how to select the locatioin provider -> use
        // default
        Criteria criteria = new Criteria();
        provider = locationManager.getBestProvider(criteria, false);
        Location location = locationManager.getLastKnownLocation(provider);

        // Initialize the location fields
        if (location != null) {
          System.out.println("Provider " + provider + " has been selected.");
          onLocationChanged(location);
        } else {
          latituteField.setText("Location not available");
          longitudeField.setText("Location not available");
        }

      }

      /* Request updates at startup */
      @Override
      protected void onResume() {
        super.onResume();
        locationManager.requestLocationUpdates(provider, 400, 1, this);
      }

      /* Remove the locationlistener updates when Activity is paused */
      @Override
      protected void onPause() {
        super.onPause();
        locationManager.removeUpdates(this);
      }

      @Override
      public void onLocationChanged(Location location) {
        lat = (location.getLatitude());
        lng = (location.getLongitude());
        latituteField.setText(String.valueOf(lat));
        longitudeField.setText(String.valueOf(lng));
        Geocoder geocoder = new Geocoder(this, Locale.getDefault());
        try {
            List<Address> addresses = geocoder.getFromLocation(lat, lng, 1);
            if (addresses != null && !addresses.isEmpty()) {
                Address address = addresses.get(0);
                String zip = address.getPostalCode();
                String city = address.getLocality();
                zipField.setText(zip);
                cityField.setText(city);

            }
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
      }

      @Override
      public void onStatusChanged(String provider, int status, Bundle extras) {
        // TODO Auto-generated method stub

      }

      @Override
      public void onProviderEnabled(String provider) {
        Toast.makeText(this, "Enabled new provider " + provider,
            Toast.LENGTH_SHORT).show();

      }

      @Override
      public void onProviderDisabled(String provider) {
        Toast.makeText(this, "Disabled provider " + provider,
            Toast.LENGTH_SHORT).show();
      }

      @Override
      public boolean onCreateOptionsMenu(Menu menu) {
          MenuInflater inflater = getMenuInflater();
          inflater.inflate(R.menu.zipsettings, menu);
          return true;
      }

      @Override
      public boolean onOptionsItemSelected(MenuItem item) {
          // Handle item selection
          switch (item.getItemId()) {
              case R.id.mapswap:
                  System.out.println("Derp");
                  swapToMap();
                  return true;
              default:
                  return super.onOptionsItemSelected(item);
          }
      }

      public void swapToMap(){
          Intent i = new Intent(getApplicationContext(), OpenMap.class);
          startActivity(i);
      }

} 
```

这就是第一类对应的XML。

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentTop="true"
        android:layout_centerHorizontal="true"
        android:layout_marginTop="16dp"
        android:text="@string/current"
        android:textColor="@color/Blue"
        android:textSize="@dimen/Header" />

    <TextView
        android:id="@+id/textView2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_below="@+id/textView1"
        android:layout_centerHorizontal="true"
        android:layout_marginTop="24dp"
        android:text="unknown"
        android:textColor="@color/Blue"
        android:textSize="@dimen/Text" />

    <TextView
        android:id="@+id/textView3"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_below="@+id/textView2"
        android:layout_centerHorizontal="true"
        android:layout_marginTop="48dp"
        android:text="@string/gps"
        android:textColor="@color/Red"
        android:textSize="@dimen/Header" />

    <TextView
        android:id="@+id/textView6"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:layout_centerHorizontal="true"
        android:layout_marginBottom="33dp"
        android:text="unknown"
        android:textColor="@color/Green"
        android:textSize="@dimen/Text" />

    <TextView
        android:id="@+id/textView5"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_above="@+id/textView6"
        android:layout_centerHorizontal="true"
        android:layout_marginBottom="20dp"
        android:text="@string/zip"
        android:textColor="@color/Green"
        android:textSize="@dimen/Header" />

    <TextView
        android:id="@+id/TextView01"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/textView1"
        android:layout_below="@+id/textView3"
        android:layout_marginTop="25dp"
        android:text="Latitude: "
        android:textColor="@color/Red"
        android:textSize="20dip" />

    <TextView
        android:id="@+id/TextView03"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/TextView01"
        android:layout_below="@+id/TextView01"
        android:layout_marginTop="51dp"
        android:text="Longitute: "
        android:textColor="@color/Red"
        android:textSize="20dip" />

    <TextView
        android:id="@+id/TextView02"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignBaseline="@+id/TextView01"
        android:layout_alignBottom="@+id/TextView01"
        android:layout_alignLeft="@+id/textView6"
        android:text="unknown"
        android:textColor="@color/Red"
        android:textSize="20dip" />

    <TextView
        android:id="@+id/TextView04"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignBaseline="@+id/TextView03"
        android:layout_alignBottom="@+id/TextView03"
        android:layout_alignLeft="@+id/TextView02"
        android:text="unknown"
        android:textColor="@color/Red"
        android:textSize="20dip" />

</RelativeLayout> 
```

这是我在手机上调试的 LogCat。

```
 10-25 23:00:05.610: I/System.out(28034): Provider network has been selected.
    10-25 23:00:06.438: D/libEGL(28034): loaded /system/lib/egl/libGLES_android.so
    10-25 23:00:06.438: D/libEGL(28034): loaded /vendor/lib/egl/libEGL_POWERVR_SGX540_120.so
    10-25 23:00:06.446: D/libEGL(28034): loaded /vendor/lib/egl/libGLESv1_CM_POWERVR_SGX540_120.so
    10-25 23:00:06.453: D/libEGL(28034): loaded /vendor/lib/egl/libGLESv2_POWERVR_SGX540_120.so
    10-25 23:00:06.711: D/OpenGLRenderer(28034): Enabling debug mode 0
    10-25 23:00:13.125: I/System.out(28034): Derp
    10-25 23:00:13.321: E/dalvikvm(28034): Could not find class 'com.google.android.maps.MapView', referenced from method com.example.zip.code.OpenMap.onCreate
    10-25 23:00:13.321: W/dalvikvm(28034): VFY: unable to resolve check-cast 438 (Lcom/google/android/maps/MapView;) in Lcom/example/zip/code/OpenMap;
    10-25 23:00:13.321: D/dalvikvm(28034): VFY: replacing opcode 0x1f at 0x002b
    10-25 23:00:13.321: D/dalvikvm(28034): DexOpt: unable to opt direct call 0x0c01 at 0x43 in Lcom/example/zip/code/OpenMap;.onCreate
    10-25 23:00:13.328: D/AndroidRuntime(28034): Shutting down VM
    10-25 23:00:13.328: W/dalvikvm(28034): threadid=1: thread exiting with uncaught exception (group=0x40aad210)
    10-25 23:00:13.336: E/AndroidRuntime(28034): FATAL EXCEPTION: main
    10-25 23:00:13.336: E/AndroidRuntime(28034): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.zip.code/com.example.zip.code.OpenMap}: android.view.InflateException: Binary XML file line #6: Error inflating class com.google.android.maps.MapView
    10-25 23:00:13.336: E/AndroidRuntime(28034):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2049)
    10-25 23:00:13.336: E/AndroidRuntime(28034):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2083)
    10-25 23:00:13.336: E/AndroidRuntime(28034):    at android.app.ActivityThread.access$600(ActivityThread.java:134)
    10-25 23:00:13.336: E/AndroidRuntime(28034):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1233)
    10-25 23:00:13.336: E/AndroidRuntime(28034):    at android.os.Handler.dispatchMessage(Handler.java:99)
    10-25 23:00:13.336: E/AndroidRuntime(28034):    at android.os.Looper.loop(Looper.java:137)
    10-25 23:00:13.336: E/AndroidRuntime(28034):    at android.app.ActivityThread.main(ActivityThread.java:4697)
    10-25 23:00:13.336: E/AndroidRuntime(28034):    at java.lang.reflect.Method.invokeNative(Native Method)
    10-25 23:00:13.336: E/AndroidRuntime(28034):    at java.lang.reflect.Method.invoke(Method.java:511)
    10-25 23:00:13.336: E/AndroidRuntime(28034):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:787)
    10-25 23:00:13.336: E/AndroidRuntime(28034):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:554)
    10-25 23:00:13.336: E/AndroidRuntime(28034):    at dalvik.system.NativeStart.main(Native Method)
    10-25 23:00:13.336: E/AndroidRuntime(28034): Caused by: android.view.InflateException: Binary XML file line #6: Error inflating class com.google.android.maps.MapView
    10-25 23:00:13.336: E/AndroidRuntime(28034):    at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:691)
    10-25 23:00:13.336: E/AndroidRuntime(28034):    at android.view.LayoutInflater.rInflate(LayoutInflater.java:739)
    10-25 23:00:13.336: E/AndroidRuntime(28034):    at android.view.LayoutInflater.inflate(LayoutInflater.java:489)
    10-25 23:00:13.336: E/AndroidRuntime(28034):    at android.view.LayoutInflater.inflate(LayoutInflater.java:396)
    10-25 23:00:13.336: E/AndroidRuntime(28034):    at android.view.LayoutInflater.inflate(LayoutInflater.java:352)
    10-25 23:00:13.336: E/AndroidRuntime(28034):    at com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:255)
    10-25 23:00:13.336: E/AndroidRuntime(28034):    at android.app.Activity.setContentView(Activity.java:1879)
    10-25 23:00:13.336: E/AndroidRuntime(28034):    at com.example.zip.code.OpenMap.onCreate(OpenMap.java:29)
    10-25 23:00:13.336: E/AndroidRuntime(28034):    at android.app.Activity.performCreate(Activity.java:4539)
    10-25 23:00:13.336: E/AndroidRuntime(28034):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
    10-25 23:00:13.336: E/AndroidRuntime(28034):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2013)
    10-25 23:00:13.336: E/AndroidRuntime(28034):    ... 11 more
    10-25 23:00:13.336: E/AndroidRuntime(28034): Caused by: java.lang.ClassNotFoundException: com.google.android.maps.MapView
    10-25 23:00:13.336: E/AndroidRuntime(28034):    at dalvik.system.BaseDexClassLoader.findClass(BaseDexClassLoader.java:61)
    10-25 23:00:13.336: E/AndroidRuntime(28034):    at java.lang.ClassLoader.loadClass(ClassLoader.java:501)
    10-25 23:00:13.336: E/AndroidRuntime(28034):    at java.lang.ClassLoader.loadClass(ClassLoader.java:461)
    10-25 23:00:13.336: E/AndroidRuntime(28034):    at android.view.LayoutInflater.createView(LayoutInflater.java:552)
    10-25 23:00:13.336: E/AndroidRuntime(28034):    at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:680)
    10-25 23:00:13.336: E/AndroidRuntime(28034):    ... 21 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T05:22:26.940

如果您尝试使用模拟器运行您的应用程序，请检查您是否已经创建了模拟器的目标，`Google's Api`如果不只是创建一个新`Android Virtual Deice (AVD)`的目标为`Google's Api`否则，您将无法`MapView`在您的模拟器中运行您的相关应用程序。对于前 -

[图片 http://intrepidusgroup.com/insight/wp-content/uploads/2011/08/Screen-Shot-2011-08-24-at-9.45.55-AM.png](http://intrepidusgroup.com/insight/wp-content/uploads/2011/08/Screen-Shot-2011-08-24-at-9.45.55-AM.png)

为您生成`API`密钥`MapView`您可以在下面的第二个教程链接中了解如何创建 api 密钥。并且，确保您在类中使用`MapView`组件的位置，您必须扩展该类，`MapActivity`而不是`Activity`不要忘记在清单文件中添加以下内容 -

```
<uses-library android:name="com.google.android.maps"/> 
```

上面一个是给你的`mapView`图书馆的。并且，以下一项是互联网许可

```
<uses-permission android:name="android.permission.INTERNET"/> 
```

无论如何看看下面的教程。它可以帮助你——

1.  [地图视图教程](https://developers.google.com/maps/documentation/android/hello-mapview)

2.  [如何在安卓中使用谷歌地图](http://www.android10.org/index.php/articleslocationmaps/253-how-to-use-google-maps-in-android)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T04:59:27.063

1.  扩展`MapActivity`而不是`Activity`

2.  在 Manifest 中，只需检查您是否实现了以下几行，

    < 使用库 android:name="com.google.android.maps" />

    并且您需要授予 INTERNET 权限

    < 使用权限 android:name="android.permission.INTERNET"/>

3.  另一个是MapKey，

从谷歌获取您`MapKey`的调试证书`MD5 API key`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T05:02:18.373

只需将以下行添加到您的清单中..它可能有效

```
<uses-library android:name="com.google.android.maps"/> 
```

从您的 CML 看来，您似乎还没有添加 API 密钥。

```
<com.google.android.maps.MapView
    android:id="@+id/map_view"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:enabled="true"
    android:clickable="true"
    android:apiKey="ADD YOUR API KEY HERE"             // here your API key which is provided by google map to you
    /> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-26T04:48:19.247

请检查您的 manifest.xml 文件。如果您没有在应用程序中添加使用用户库文件，那么您可以在应用程序清单文件中添加此用户库

 **像这样

```
<application
android:icon="@drawable/ic_launcher"
android:label="@string/app_name"
android:theme="@style/AppTheme" >
<activity
    android:name=".MainActivity"
    android:label="@string/title_activity_main" >
    <intent-filter>
        <action android:name="android.intent.action.MAIN" />

        <category android:name="android.intent.category.LAUNCHER" />
    </intent-filter>
 </activity>
<activity android:name="com.android.calendar.AgendaActivity"></activity>
<uses-library android:name="com.google.android.maps"/>
</application> 
```**

# javascript - jquery Tablesorter - 如果从中选择新选项，则不会正确排序 1）表格排序器解析器对行中的下拉字段进行排序，因为它们在页面加载时加载，但是如果我尝试编辑任何 s 然后尝试再次对列进行排序，那么它会按原始值而不是新值，你能帮忙解决这个问题吗？2）如果我尝试从下拉选项中选择新值然后单击列标题进行排序然后它不起作用，为什么并且你知道如何解决这个问题？我的代码现在看起来像这样： $(document).ready(function() { return $("#tab1").tab

> ID：13080681
> 
> 赞同：0
> 
> 时间：2012-10-26T04:21:31.823
> 
> 标签：javascript, jquery, tablesorter

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T06:40:32.690

Tablesorter 在内部缓存表数据。当您更改数据时，您必须通知 tablesorter 它应该更新其缓存。利用

```
$("#tab1").trigger("update"); 
```

在显示的表格排序器主页上查看[使用 Ajax 附加的表格数据。](http://tablesorter.com/docs/example-ajax.html)

# android - 以编程方式在任何活动的底部添加 FrameLayout

> ID：13080682
> 
> 赞同：1
> 
> 时间：2012-10-26T04:21:32.300
> 
> 标签：android, layout, android-activity

如何找到活动的根视图，然后在底部添加框架布局？相反，下面的代码添加到顶部，但不能添加到底部。

```
 FrameLayout aLayout = new FrameLayout(getActivity());
    aLayout.setLayoutParams(new LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.WRAP_CONTENT));

    ImageView image = new ImageView(getActivity());
    image.setLayoutParams(new LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.WRAP_CONTENT));
    image.setImageResource(R.drawable.alayer_0);
    adLayout.addView(image);

    ViewGroup content = (ViewGroup) getActivity().findViewById(android.R.id.content);
    content.addView(aLayout); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T04:48:19.517

可能是一种解决方案是您应该使用 xml，在 xml 中首先采用一个相对布局，然后在该相对布局内部采用您的框架布局并将框架布局的属性设置为 -

```
android:layout_alignParentBottom="true" 
```

所以你的框架布局将显示在屏幕底部。希望它对你完美。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T04:30:30.827

将一些分配`id`给您的根布局（XML 的主要布局）

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/linear_root"
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"> 
```

Activity 类，映射 Root 布局

```
LinearLayout mRootLayout;

mRootLayout=(LinearLayout) findViewById(R.id.linear_root);

mRootLayout.add(yourFrameLayout);// this will add your FrameLayout at the last 
```

**更新**：要获取任何活动的根布局，您可以使用[**getRootView**](http://developer.android.com/reference/android/view/View.html#getRootView%28%29)

或者`getWindow().getDecorView().findViewById(android.R.id.content)`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-26T04:44:47.173

*android.R.id.content*是一个`FrameLayout`. 所以你不能将子视图与底部对齐。

您可以做的是`RelativeLayout`在*android.R.id.content*中添加一个`FILL_PARENT`高度和宽度。

您现在可以将您的添加`FrameLayout`到`RelativeLayout`with 中`ALIGN_PARENT_BOTTOM`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-26T05:12:33.383

看起来你想添加一个页脚。使用 framelayout 启动您的 xml，然后将您的页脚包含在线性或相对布局中，并提供 android:layout_gravity="bottom"。这将解决您的问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-03-25T13:01:12.953

或者，您也可以在 FrameLayout 周围添加边距。无需额外的 RelativeLayout。

```
DisplayMetrics metrics = MyActivity.this.getResources().getDisplayMetrics();
LayoutParams params = new LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT);
params.setMargins(0, metrics.heightPixels - 20, 0, 0);
myFrameLayout.setLayoutParams(params); 
```

这会将 FrameLayout 定位在距屏幕底部 20 像素处。

# forms - Expression Engine 和 Safecracker - 上传 mp3 文件时出现问题

> ID：13080684
> 
> 赞同：0
> 
> 时间：2012-10-26T04:21:50.480
> 
> 标签：forms, upload, expressionengine, safecracker

我有 2 个大小为 24.7kb 和 11mb 的 mp3 文件。

当我尝试上传较小的文件时，我没有收到任何错误。

当我尝试上传更大的文件时，出现错误。在萤火虫中，我看到类似

```
NetworkError: 404 Not Found - http://domain.com/application/form/%3C!DOCTYPE%20HTML%3E%3C!--%5Bif.... 
```

在检查并解析“form/”之后的字符串后，它似乎是您所在网页的标记。

知道为什么会这样吗？

附言

*   我检查了我的 PHP.ini 和 Expression Engine 的文件上传首选项，并确保我的最大文件大小限制超过 10mb（使用 20mb）。

*   我将 ExpressionEngine 用于我的框架，将 Safecracker 用于我的表单

*   在 Mac 上，标记字符串似乎显示在 DOM 中的某个位置，您可以在页面中看到它。我在 Firefox 或 Chrome 中看不到它

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-26T09:05:41.300

您可能希望检查的是您的 XSS 设置。在`Admin`-> `Security and Privacy`->下`Security and Session Preferences`，设置以下内容`No`并再次测试您的上传：

`Apply XSS Filtering to uploaded files?`

它可能没有任何影响，但我见过一些 MP3 和 PDF 文件由于 XSS 过滤而导致一些非常随机的结果的情况；当然值得排除。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-26T07:54:28.393

这*可能*仍然是服务器问题，而不是特定于 EE 的问题。我将首先检查 php.ini 中的以下设置（除此之外`upload_max_filesize`，您听起来好像已经升级了，大致按以下顺序：

**`max_execution_time`**设置脚本在被解析器终止之前允许运行的最长时间（以秒为单位）。我认为最有可能的候选者是这个，因为在上传或上传后处理过程中很可能超过了这个值。PHP 5.3 中的默认值为“30”

**`post_max_size`**（必须大于upload_max_filesize）。设置允许的发布数据的最大大小，也会影响文件上传。PHP 5.3 中的默认值是“128M”，但一些主机会大大降低它。

**`memory_limit`** 设置允许脚本分配的最大内存量（以字节为单位）。不太可能是这个，因为你几乎肯定会得到一个 PHP 错误，但值得检查完整性。PHP 5.3 中的默认值为“8M”

# android - 我可以从非编译的 android XML 中膨胀 android 活动吗？

> ID：13080695
> 
> 赞同：2
> 
> 时间：2012-10-26T04:22:57.477
> 
> 标签：android, runtime, inflate

我想知道是否可以在运行时从非编译的 android XML 布局文件中扩展 Android 活动？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T04:34:57.913

API 中没有内置任何内容可以让您执行此操作。inflater 需要一个拉式解析器，该解析器可以处理已编译的 XML 文件。作为膨胀处理的一部分，系统会处理很多事情，比如资源绑定。从[文档中`LayoutInflater`](http://developer.android.com/reference/android/view/LayoutInflater.html)：

> 出于性能原因，视图膨胀在很大程度上依赖于在构建时完成的 XML 文件的预处理。因此，目前无法在运行时在纯 XML 文件上使用带有 XmlPullParser 的 LayoutInflater；它仅适用于从已编译资源（R.something 文件）返回的 XmlPullParser。

我想您可以构建自己的 XML 处理程序并自己完成，但这将是很多工作。

# php - 数组上 for 循环迭代的问题

> ID：13080696
> 
> 赞同：0
> 
> 时间：2012-10-26T04:23:03.120
> 
> 标签：php, arrays, for-loop, iteration

我似乎无法回显我的数组的内容。出于某种原因，仅显示了我所有数组中的第二个值。任何帮助将不胜感激。php代码如下：

```
<?php
// Characters from each item 
$char = 200;
echo '<table cellpadding="0" align="left" cellspacing="0" border="1" bordercolor="#585858" width=100%>';
foreach ($xml->Game as $Game) {
    $Date              = $Game->Date;
    $AwayTeam          = $Game->AwayTeam;
    $HomeTeam          = $Game->HomeTeam;
    $AwayRotation      = $Game->AwayRotation;
    $HomeRotation      = $Game->HomeRotation;
    $Total             = $Game->Total;
    $OverPrice         = $Game->OverPrice;
    $UnderPrice        = $Game->UnderPrice;
    $Line              = $Game->Line;
    $AwayTeamPrice     = $Game->AwayTeamPrice;
    $HomeTeamPrice     = $Game->HomeTeamPrice;
    $AwayTeamMoneyLine = $Game->AwayTeamMoneyLine;
    $HomeTeamMoneyLine = $Game->HomeTeamMoneyLine;
    // # items to display 
    $count             = 20;
    for ($i = 0; $i < $count; $i++) {
        $AwayTeamSpread         = " ";
        $HomeTeamSpread         = " ";
        $arrayDate              = $Date;
        $arrayARotation         = $AwayRotation;
        $arrayHRotation         = $HomeRotation;
        $arrayAwayTeam          = $AwayTeam;
        $arrayHomeTeam          = $HomeTeam;
        $arrayTotal             = $Total;
        $arrayLine              = $Line;
        $arrayOverPrice         = $OverPrice;
        $arrayUnderPrice        = $UnderPrice;
        $arrayAwayTeamMoneyLine = $AwayTeamMoneyLine;
        $arrayHomeTeamMoneyLine = $HomeTeamMoneyLine;
        $arrayAwayTeamPrice     = $AwayTeamPrice;
        $arrayHomeTeamPrice     = $HomeTeamPrice;
        $arrayLine              = $Line;
        $LineStrip              = str_replace("-", " ", $arrayLine);

        if ($arrayHomeTeamMoneyLine > 0); {
            $AwayTeamSpread = "-";
            $HomeTeamSpread = "+";
        }
        if ($arrayAwayTeamMoneyLine > 0); {
            $AwayTeamSpread = "+";
            $HomeTeamSpread = "-";
        }
        echo '<tr>';
        echo "<td>$arrayDate[$i]</td><td><table><tr><td>$arrayARotation[$i]</td></tr><tr><td>$arrayHRotation[$i]</td></tr></table></td><td><table><tr><td>$arrayAwayTeam[$i]</td></tr><tr><td>$arrayHomeTeam[$i]</td></tr></table></td><td><table><tr><td><input type='checkbox'/> $arrayAwayTeamMoneyLine[$i]</td></tr><tr><td>$arrayHomeTeamMoneyLine[$i]</td></tr></table></td><td><table><tr><td>$AwayTeamSpread $LineStrip ($arrayAwayTeamPrice)</td></tr><tr><td>$HomeTeamSpread $LineStrip ($arrayHomeTeamPrice)</td></tr></table></td><td><table><tr><td>Over $arrayTotal</td></tr><tr><td>Under $arrayTotal</td></tr></table></td>";
        echo '</tr>';
    }
    echo '</table>';
}
?> 
```

这是我的 php 代码的第一部分，很抱歉混淆了它们。我在这部分编码中声明了我的所有数组和变量。

```
<?php
require_once('db-config.php');
// rss page for Testing -  
$feed_url = "http://www.sportsbooks.com/lines/cgi/lines.cgi?tem=parse&sport=203&ct=text/xml&type=";
$xml      = simplexml_load_file($feed_url);
//Connect to mysql server  
$link     = mysql_connect(DB_HOST, DB_USER, DB_PASSWORD);
if (!$link) {
    die('Failed to connect to server: ' . mysql_error());
}
$arrayDate              = array(
    ''
);
$arrayLine              = array(
    ''
);
$arrayLineStrip         = array(
    ''
);
$arrayOverPrice         = array(
    ''
);
$arrayUnderPrice        = array(
    ''
);
$arrayARotation         = array(
    ''
);
$arrayHRotation         = array(
    ''
);
$arrayAwayTeam          = array(
    ''
);
$arrayHomeTeam          = array(
    ''
);
$arrayAwayTeamPrice     = array(
    ''
);
$arrayHomeTeamPrice     = array(
    ''
);
$arrayAwayTeamMoneyLine = array(
    ''
);
$arrayHomeTeamMoneyLine = array(
    ''
);
$Date                   = (string) $xml->Date;
$AwayTeam               = (string) $xml->AwayTeam;
$HomeTeam               = (string) $xml->HomeTeam;
$AwayRotation           = (string) $xml->AwayRotation;
$HomeRotation           = (string) $xml->HomeRotation;
$Total                  = (string) $xml->Total;
$OverPrice              = (string) $xml->OverPrice;
$UnderPrice             = (string) $xml->UnderPrice;
$Line                   = (string) $xml->Line;
$AwayTeamPrice          = (string) $xml->AwayTeamPrice;
$HomeTeamPrice          = (string) $xml->HomeTeamPrice;
$AwayTeamMoneyLine      = (double) $xml->AwayTeamMoneyLine;
$HomeTeamMoneyLine      = (double) $xml->HomeTeamMoneyLine;
$Title                  = (string) $xml->Title;
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T04:52:04.407

尝试像这样运行 foreach

```
foreach ($xml->Game as $Game=>$GameValue) {
    // print $Game and $GameValue here to test the output ;
} 
```

如果你得到数组，你可以迭代更多

# clojure - 在重复处停止和拆分生成的序列 - clojure

> ID：13080697
> 
> 赞同：4
> 
> 时间：2012-10-26T04:23:03.640
> 
> 标签：clojure, conditional, lazy-sequences

我正在尝试制作一个只会生成值的序列，直到它找到以下条件并返回列出的结果：

案例头 =

*   0 - 返回 {:origin [除 0 之外的所有生成] :pattern 0}
*   1 - 返回 {:origin nil :pattern [all-generated-values] }
*   重复值 - {:origin [values-before-repeat] :pattern [values-after-repeat]

{

```
; n = int
; x = int
; hist - all generated values

; Keeps the head below x 
(defn trim-head [head x]
  (loop [head head]
    (if (> head x)
      (recur (- head x))
      head)))

; Generates the next head
(defn next-head [head x n]
  (trim-head (* head n) x))

(defn row [x n]
   (iterate #(next-head % x n) n))

; Generates a whole row - 
; Rows are a max of x - 1.
(take (- x 1) (row 11 3)) 
```

## 在到达行尾之前停止的案例示例：

[9 8 *4* 5 6 7 *4* ] - 重复“4”，因此停止。返回前面作为原点，其余作为模式。

```
{:origin [9 8] :pattern [4 5 6 7]} 
```

[4 5 6 1] - 找到一个“1”所以停止，所以将所有内容作为模式返回

```
{:origin nil :pattern [4 5 6 1]} 
```

[3 *0* ] - 找到一个 '0' 所以停止

```
{:origin [3] :pattern [0]} 
```

:else 如果序列达到 x - 1 的长度：

```
{:origin [all values generated] :pattern nil} 
```

## 问题

我已经成功地使用 partition-by 在找到重复值的点拆分组，但我想懒惰地这样做。有什么方法可以使用 take-while、condp 或 for 循环的 :while 子句来创建一个在发现重复时进行分区的条件？

## 一些尝试

```
(take 2 (partition-by #(= 1 %) (row 11 4)))

(for [p (partition-by #(stop-match? %) head) (iterate #(next-head % x n) n)
        :while (or (not= (last p) (or 1 0 n) (nil? (rest p))]
  {:origin (first p) :pattern (concat (second p) (last p))})) 
```

## ＃ 更新

我真正想做的是找出一个值是否重复并在不使用索引的情况下对 seq 进行分区。那可能吗？像这样的东西-

{

```
(defn row [x n]
  (loop [hist [n]
         head (gen-next-head (first hist) x n)
         steps 1]
    (if (>= (- x 1) steps)
      (case head
        0 {:origin [hist] :pattern [0]}
        1 {:origin nil :pattern (conj hist head)}
        ; Speculative from here on out 
        (let [p (partition-by #(apply distinct? %) (conj hist head))]
          (if-not (nil? (next p)) ; One partition if no repeats.
            {:origin (first p) :pattern (concat (second p) (nth 3 p))}
            (recur (conj hist head) (gen-next-head head x n) (inc steps)))))
      {:origin hist :pattern nil}))) 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T05:55:57.033

> 我真正想做的是找出一个值是否重复并在不使用索引的情况下对 seq 进行分区。那可能吗？

我直接实施了您的更新要求。在这种情况下，`split-with`将优于`partition-by`.

```
;;; find out if a value has repeated, but considering zero and one.
(defn- generate
  "Returns a vector of [duplicate-value values-until-duplicate].
   duplicate-value might be zero or one."
  [s]
  (->> [s [] #{0 1}]
       (iterate (fn [[[head & more] generated idx]]
                  [more (conj generated head) (conj idx head)]))
       (take-while (comp seq first))
       (drop-while (fn [[[head & _] _ idx]]
                     (nil? (idx head))))
       first
       ((juxt ffirst second))))

;;; partition the seq without using the index.
(defn partition-by-duplicate
  [s]
  (let [[pivot generated-values] (generate s)]
    (cond (= 0 pivot) {:origin generated-values, :pattern [0]}
          (= 1 pivot) {:origin nil, :pattern (conj generated-values 1)}
          pivot (->> generated-values
                     (split-with (partial not= pivot))
                     (interleave [:pattern :origin])
                     (apply hash-map))
          :else {:origin s, :pattern nil}))) 
```

例子：

```
user> (map generate [[9 8 2 4 5 6 7 4] [4 5 6 1] [3 0]])
([4 [9 8 2 4 5 6 7]]
 [1 [4 5 6]]
 [0 [3]])

user> (map partition-by-duplicate [[9 8 2 4 5 6 7 4] [4 5 6 1] [3 0]])
({:pattern (9 8 2), :origin (4 5 6 7)}
 {:origin nil, :pattern [4 5 6 1]}
 {:origin [3], :pattern [0]}) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T05:06:23.323

懒惰是不可能的：你可以懒惰地消耗新元素，但你必须挂在所有旧元素上才能将它们用作模式，所以像`(iterate inc 2)`你这样的序列必须消耗所有可用内存。此外，`for`只允许您一次查看单个元素，因此它不适合此任务。但是，将其编写为循环/递归虽然有点乏味，但并不困难。如果序列在重复、1 或 0 之前结束，您没有指定要返回的内容，所以我只是猜测。

此外，您的第一个示例输出是错误的：它应该停在 1，而不是 4，所以我调整了您的输入。不过，除此之外，这个问题问得很好：感谢您清楚地说明问题，并描述您遇到的问题以及您尝试过的问题。

```
(defn trim-head [coll]                                                      
  (loop [so-far [], indexes {}, index 0, coll (seq coll)]                   
    (if-not coll                                                            
      {:origin nil, :pattern so-far} ;; ?? not specified in question        
      (let [x (first coll), xs (rest coll)]                                 
        (if (contains? indexes x)                                           
          {:origin (subvec so-far 0 (indexes x))                            
           :pattern (subvec so-far (indexes x))}                            
          (case x                                                           
            0 {:origin so-far, :pattern [x]}                                
            1 {:origin nil, :pattern (conj so-far x)}                       
            (recur (conj so-far x) (assoc indexes x index) (inc index) (seq xs))))))))

user> (map trim-head [[9 8 2 4 5 6 7 4] [4 5 6 1] [3 0]])                       
({:origin [9 8 2], :pattern [4 5 6 7]}
 {:origin nil, :pattern [4 5 6 1]} 
 {:origin [3], :pattern [0]}) 
```

# c# - iTextSharp modify pdf properties

> ID：13080699
> 
> 赞同：1
> 
> 时间：2012-10-26T04:23:18.257
> 
> 标签：c#, .net, itextsharp

I have a PDF I am trying to open up and alter slightly (just changing the ViewerPreferences) but can't seem to work out the exact usage of iTextSharp. The file that gets saved at the end is corrupt. Any ideas?

```
 PdfReader reader = new PdfReader(@"C:\4803.pdf");

        using (var stream = new MemoryStream())
        {
            PdfStamper stamper = new PdfStamper(reader, stream);
            stamper.ViewerPreferences = PdfWriter.AllowPrinting | PdfWriter.PrintScalingNone;

            stream.Position = 0;
            byte[] output = LoadFromStream(stream); // Convert it to a byte array
            SaveToFile(output, @"C:\4803_out.pdf"); // Save it to a file

            stamper.Close();
        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T04:39:08.240

Close the PdfStamper before converting the MemoryStream to a byte array and saving it. The way you do it, the pdf is not yet completed in the stream.

*PS*: To prevent the closing of the stamper from also closing the stream, use

```
stamper.Writer.CloseStream = false 
```

# sass - Sass 有类似的“避免编译”语法吗？

> ID：13080700
> 
> 赞同：0
> 
> 时间：2012-10-26T04:23:18.473
> 
> 标签：sass, less

少例子：</p>

```
.class {
filter: ~"ms:alwaysHasItsOwnSyntax.For.Stuff()";
} 
```

我在 sass 文档中找不到类似的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T04:33:57.890

```
.class
  filter: unquote("ms:alwaysHasItsOwnSyntax.For.Stuff()") 
```

在这种情况下有效。

# javascript - 如何在node.js上实现jQuery直接上传到Cloudinary

> ID：13080702
> 
> 赞同：8
> 
> 时间：2012-10-26T04:23:23.010
> 
> 标签：javascript, jquery, node.js, cloudinary

我正在尝试通过他们的 jQuery 插件将直接上传到 Cloudinary 到 Node.js 应用程序，并且想知道是否有人可以帮助我弥补他们示例中的一些空白。

这是解释如何做到这一点的博客文章：

[http://cloudinary.com/blog/direct_image_uploads_from_the_browser_to_the_cloud_with_jquery](http://cloudinary.com/blog/direct_image_uploads_from_the_browser_to_the_cloud_with_jquery)

在“其他开发框架和高级用法”部分，我坚持的部分是：

*   "将data-form-data设置为上传API参数的JSON表示。必填字段为api_key、时间戳、签名和回调。",

更具体地说：

*   “需要在服务器端生成签名以进行正确的身份验证。”

似乎没有任何例子说明如何实现这一目标。

这些例子是：

```
<input name="file" type="file" 
       class="cloudinary-fileupload" data-cloudinary-field="image_upload" 
       data-form-data=" ... html-escaped JSON data ... " ></input> 
```

data-form-data 的未转义 JSON 内容是：

```
{ "timestamp":  1345719094, 
  "callback": "https://www.example.com/cloudinary_cors.html",
  "signature": "7ac8c757e940d95f95495aa0f1cba89ef1a8aa7a", 
  "api_key": "1234567890" } 
```

你如何去生成签名？我知道我需要在 node.js 中执行此操作，并且它似乎需要在生成表单时发生，尽管据我所知，签名需要包含时间戳 - 到用户时肯定会过时填好表格了吗？

请求身份验证的文档在这里：[http ://cloudinary.com/documentation/upload_images#request_authentication](http://cloudinary.com/documentation/upload_images#request_authentication)

在我正在使用的[cloudinary_npm](https://github.com/cloudinary/cloudinary_npm)`uploader.coffee`模块中，有一个方法被调用`direct_upload`，它似乎是实现这一点的帮手，但我不清楚如何将它们实际绑定在一起。

博客文章中带有真实示例的两个框架，Rails 和 Django，通过它们自己的帮助器抽象了这种复杂性，例如，在 Django 中，您添加`{{ form.image }}`到表单中，它输出结果`image = cloudinary.forms.CloudinaryJsFileField()`- 不幸的是，如何在任何其他服务器端环境中复制它不包括在内。

如果有人可以对此有所了解，或者分享有关如何使其端到端工作的要点或示例，我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T13:53:19.467

请查看[https://github.com/cloudinary/cloudinary_npm/blob/67b7096c7fac2c2bed06603912966495d59dfa34/lib/uploader.coffee#L220](https://github.com/cloudinary/cloudinary_npm/blob/67b7096c7fac2c2bed06603912966495d59dfa34/lib/uploader.coffee#L220)上的 uploader.image_upload_tag 它返回可与 jquery.cloudinary 一起使用的输入标签的 html .js 将图像直接上传到 cloudinary。它将成为 npm 下一个版本的一部分（预计下周某个时间）。至于时间戳——签名有效期为1小时，所以应该有足够的时间让用户上传图片。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-08T16:01:57.810

如果您使用的是 nodejs，这可能会有所帮助

```
var querystring = require('querystring');

var toHash = querystring.stringify(req.query) + secret;

var signature = sha1(toHash);

function sha1(data) {
var generator = crypto.createHash('sha1');
generator.update(data)
return generator.digest('hex')
} 
```

# sql - 用于连接 2 个表并根据条件查找匹配行的 SQL 查询

> ID：13080703
> 
> 赞同：0
> 
> 时间：2012-10-26T04:23:55.100
> 
> 标签：sql

假设我正在尝试构建一个 SQL 查询来查找自 2012 年 6 月 1 日以来没有进行销售的所有人，并且我有 2 个表：

```
UserID    FirstName    LastName
1000      Ted          Ting
1001      Sally        Song
1002      Adam         Apple

UserID   SalesDate
1000     8/1/2012
1000     6/12/2012
1000     6/11/2012
1000     5/3/2012
1001     3/1/2012
1001     5/30/2012
1002     6/15/2012
1002     5/1/2011 
```

此查询的结果将包含以下列：

```
UserID   FirstName   LastName  LastSalesDate
1001     Sally       Song      5/30/2012 
```

请注意，这仅返回 Sally 的最新销售，而不是该日期之前的所有销售（它不显示 2012 年 3 月 1 日的销售）。获取此信息的正确 SQL 查询是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T03:06:24.107

```
SELECT t1.UserID, t1.FirstName, t1.LastName, MAX(SalesDate) AS SalesDate
FROM Table1 t1 JOIN Table2 t1 ON t1.UserId = t2.UserID
GROUP BY t1.UserID, t1.FirstName, t1.LastName
HAVING MAX(SalesDate) < '20120601' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T04:28:04.450

基本上，您只需要根据用户 ID 对表进行内部联接。然后您可以使用 where 过滤您定义的日期。

```
select top 1 * from table1 as t1 
  inner join table2 as t2 on t2.userid = t1.userid 
  where t2.lastsalesdate < '6/1/2012' order by t2.lastsalesdate desc; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T04:31:43.493

```
select t.userid,t.firstname,t.lastname,max(t1.salesdate) as lastsalesdate 
from table1 as t1 
left outer join table2 as t2 on t2.userid = t1.userid 
where t1.userid not in(select t3.userid from table2 where t3.lastsalesdate < '6/1/2012')
group by t2.userid; 
```

# apache - htaccess 创建子域的外观，但使用 MVC 控制器而不是文件夹

> ID：13080704
> 
> 赞同：1
> 
> 时间：2012-10-26T04:24:13.893
> 
> 标签：apache, .htaccess, mod-rewrite, subdomain

我正在使用 MVC，特别是 Codeigniter。

我需要在我正在构建的服务上创建一个子域。将服务的更多“移动”朋友版本传递给用户。通过 m.example.com。通常我只会添加一个虚拟主机，将所有内容放在一个文件夹中，依此类推，但由于我在这个项目中使用 MVC，所以大部分功能都存在于模型和库中，这些模型和库对于视图甚至是不可知的控制器，只要他们有输出。

所以我目前的思路是，在机器上创建一个与当前使用的 mvc 完全相同的东西的全新文件夹，只是为了将其用作 m.example，这将是一种资源浪费。 com。所以我想知道（因为它目前与 index.php 以这种方式工作）有没有办法说我通过 htaccess 假设当通过 m.example.com 的流量通过时，我使用特定的控制器路径，而不是文件夹小路？这样一来，就像它的大哥 index.php m.php（本例中的控制器）一样，可以处理所有核心流量，并且只有一堆连接到模型、库等的函数。

在我在下面对某人发表的评论中，我说：

> 不，m.php 不在根目录中，它是一个控制器。我正在尝试将任何对 m.example.com 的请求路由到 m.php 控制器（m.php 在控制器目录中，遵循 MVC 模式)，我可以按照 MVC 逻辑访问[http://example.com/m/function/param/](http://example.com/m/function/param/)，但我想拥有它，所以[http://m.example.com/function/param/](http://m.example.com/function/param/)等于mvc 逻辑

这最终意味着我试图通过 .htaccess 或其他方式提出一个逻辑，即[http://example.com/m/function/param/](http://example.com/m/function/param/)和[http://m.example.com/function/param/](http://m.example.com/function/param/)是完全相同的东西，最好不要制作整个 CI 安装和我在其上构建的代码的镜像副本，并将其放在名为`m`example 的目录中。我强调这个原因似乎有些混乱。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T04:38:25.653

您可能想看看这个，只需将其更改为使用 HTTP_HOST 而不是此处显示的 user_agent 库

[http://digitizor.com/2011/12/05/codeigniter-mobile-browser/](http://digitizor.com/2011/12/05/codeigniter-mobile-browser/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T04:34:13.983

如果您已经拥有`m.php`控制器，则**m.example.com**的 DNS指向同一服务器，并且您已将服务器设置为托管**m.example.com**和**example.com**的相同文档根目录，那么这就是全部您需要在文档根目录的 htaccess 文件中：

```
RewriteEngine On

# this condition ensures the request is for m.example.com
RewriteCond %{HTTP_HOST} ^m\.example\.com$ [NC]

# the usual routing conditions (may need to be changed to suit your specific needs)
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

# you can alternatively use this
# RewriteCond %{REQUEST_URI} !^/m.php

# route
RewriteRule ^(.*)$ /m.php [L]

# or
# RewriteRule ^(.*)$ /m.php/$1 [L]
# RewriteRule ^(.*)$ /m.php?url=$1 [L,QSA] 
```

这需要超越处理主站点路由的任何规则。

# php - 通过 ajax 加载页面/内容后初始化 video.js

> ID：13080708
> 
> 赞同：3
> 
> 时间：2012-10-26T04:24:34.077
> 
> 标签：php, jquery, ajax, wordpress, html5-video

我目前正在我的一个 wordpress 网站上设置[无限滚动](http://www.infinite-scroll.com/)，一旦你滚动到页面底部，它就会通过 ajax 加载下一组帖子。正因为如此，我一直无法让 videojs 正常工作（读作：根本）；所以我希望有人可以帮助我。

首先，我在我的主题中直接使用 videojs 代码，它从帖子自定义字段中提取数据，并将帖子 ID 添加到视频标签 ID 属性中。这是模板代码的示例：

```
<video id="video_<?php echo get_the_id(); ?>" class="video-js vjs-default-skin"  
  controls preload="auto" width="640" height="264"  
  poster="<?php echo $poster; ?>">  
 <source src="<?php echo $mp4vid; ?>" type='video/mp4' />  
</video> 
```

（注意，我稍后会添加ogg/webm）

我已经看到说要添加以下块的文档页面：

```
_V_("example_video_1", {}, function(){
  // Player (this) is initialized and ready.
}); 
```

但无论我在哪里添加它（添加了必要的属性），播放器都不起作用。我的意思是，有了上面的内容，我得到了标准的 html5 视频播放器，但没有 videojs 的任何好处。

任何人都有这样的工作解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T20:51:29.437

引用正确的 ID 可能会解决问题......

```
<script type="text/javascript">
_V_("video_<?php echo get_the_id(); ?>", {}, function(){
  // Player (this) is initialized and ready.
});
</script>

<video id="video_<?php echo get_the_id(); ?>" class="video-js vjs-default-skin"  
  controls preload="auto" width="640" height="264"  
  poster="<?php echo $poster; ?>">  
 <source src="<?php echo $mp4vid; ?>" type='video/mp4' />  
</video> 
```

# javascript - 如何在刷新页面时更改 a:visited 的颜色为其父颜色

> ID：13080716
> 
> 赞同：0
> 
> 时间：2012-10-26T04:25:42.220
> 
> 标签：javascript, html, css

我需要在刷新时将 a:visited 的颜色更改为其父颜色。怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T04:41:41.420

```
 .foo:visited {
    color: #f00;
 }

 document.getElementById('yourID').className += ' foo'; 
```

我希望这能帮到您

# c - 被错误地读入数组的东西

> ID：13080720
> 
> 赞同：2
> 
> 时间：2012-10-26T04:25:54.683
> 
> 标签：c, arrays

我不确定我做错了什么，我做了一个类似的问题，但是通过读取数字并且它可以工作，这个程序应该做的是在 names.txt 中读取这个文档包含名称（最后一个，第一个）

所以文字有

> 华盛顿，乔治
> 
> 亚当斯，约翰
> 
> 杰斐逊、托马斯等……

我的程序读取了名称，但我的输出不正确，输出为：

> 华盛顿，乔治
> 
> WAdams, 约翰
> 
> WAJefferson, GJ托马斯

那么当它读取下一行时，它会保留前一个名字的第一个字母吗？

```
#include <stdio.h>

int main(void)
{

    char first_n[70]; 
    char last_n[70];

    int i=0;
    FILE *oput;
    FILE *iput;

    iput = fopen( "names.txt","r" );
    while ( fscanf( iput,"%s %s", &last_n[i],&first_n[i] ) !=  EOF )
    {
        i++; 
        printf("%s %s\n",last_n,first_n);
    }

    oput=fopen("user_name_info.txt","wt"); //opens output file
    fprintf(oput, "Last\t\tFirst\n------------\t-------------\n%s\t%s\n",last_n,first_n);

    return 0;
} 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T04:30:00.817

`first_n`并且`last_n`是字符数组（即认为单个字符串）

你`fscanf`对待它们更像是你认为它们是一个字符串数组。您每次都在进一步读取字符串一个字符，即第一次将字符串放在偏移量 0 处，第二次将字符串放在偏移量 1 处...

尝试这个：

```
while ( fscanf( iput,"%s %s", last_n,first_n ) !=  EOF )
{
    i++; 
    printf("%s %s\n",last_n,first_n);
} 
```

您的最终打印将仅打印最后读取的“记录”。也许你真的想要一个字符串数组？看起来有点像这样（我并不是说这是解决问题的最佳方法，但它符合您原始代码的精神......）

```
/* Limited to 20 names of 70 chars each */
char first_names[20][70]; 
char last_names[20][70];

int i=0;
FILE *oput;
FILE *iput;

iput = fopen( "names.txt","r" );
while ( fscanf( iput,"%s %s", &last_names[i],&first_names[i] ) !=  EOF )
{
    printf("%s %s\n",last_names[i],first_names[i]);
    i++;
}

oput=fopen("user_name_info.txt","wt"); //opens output file
i--; /* ensure i points to the last valid data */
while(i >= 0) { 
    fprintf(oput, "Last\t\tFirst\n------------\t-------------\n%s\t%s\n",last_names[i],first_names[i]);
    i--;
}
return 0; 
```

# sqlite - 找到最好的汽车交易

> ID：13080721
> 
> 赞同：0
> 
> 时间：2012-10-26T04:25:55.310
> 
> 标签：sqlite

实际问题是关于优化缓存数据库，我将其重新表述为一个简单的场景：

一位汽车经销商想要摆脱旧车，并在表格中列出待售：

```
| Car_Number | Car_Year  | Car_Price |
|------------|-----------|-----------|
|1001........|1967.......|29000......|
|1002........|1930.......|29050......|
|1003........|2001.......|30000......|
|1004........|1980.......|10000......|
|1005........|1967.......|75000......|
|1006........|2005.......|80000......|
|1007........|1995.......|21000......|
|1008........|1920.......|55000......| 
```

客户希望在固定预算内选择最大数量的汽车，较旧的汽车优先于较新的汽车，或者如果两辆汽车的年份相同，则选择较旧的汽车。

我目前可以考虑这个问题的唯一方法是获得一个排序视图并在循环中手动添加价格，直到总和达到预算限制。然后，返回添加的汽车数量列表。

上述场景所需的最小 SQL 命令集是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T04:43:58.987

查找所有不超出预算的汽车：

```
SELECT Car_Number, Car_Year
  FROM Cars c
 WHERE (SELECT SUM(Car_Price)
          FROM Cars
         WHERE Car_Year < c.Car_Year
            OR (Car_Year = c.Car_Year AND Car_Number <= c.Car_Number)
       ) <= :Budget 
```

# ruby-on-rails - Ruby on Rails NoMethodError 在 CharactersController#new

> ID：13080729
> 
> 赞同：0
> 
> 时间：2012-10-26T04:27:12.437
> 
> 标签：ruby-on-rails, nomethoderror

直接在生成脚手架后，我在尝试创建一些新的测试虚拟数据时收到 NoMethodError。

我是 Rails 的新手，所以我可能做错了一些简单的事情，但 Rails 似乎不应该从一开始就生成带有错误的文件。

模型：

```
class Character < ActiveRecord::Base
  attr_accessible :cha, :class, :class_option, :con, :dex, :exp, :int, :name, :portrait_url, :str, :wis
end 
```

看法：

```
<h1>Listing characters</h1>

<table>
  <tr>
    <th>Name</th>
    <th>Exp</th>
    <th>Class</th>
    <th>Class option</th>
    <th>Str</th>
    <th>Dex</th>
    <th>Con</th>
    <th>Int</th>
    <th>Wis</th>
    <th>Cha</th>
    <th>Portrait url</th>
    <th></th>
    <th></th>
    <th></th>
  </tr>

<% @characters.each do |character| %>
  <tr>
    <td><%= character.name %></td>
    <td><%= character.exp %></td>
    <td><%= character.class %></td>
    <td><%= character.class_option %></td>
    <td><%= character.str %></td>
    <td><%= character.dex %></td>
    <td><%= character.con %></td>
    <td><%= character.int %></td>
    <td><%= character.wis %></td>
    <td><%= character.cha %></td>
    <td><%= character.portrait_url %></td>
    <td><%= link_to 'Show', character %></td>
    <td><%= link_to 'Edit', edit_character_path(character) %></td>
    <td><%= link_to 'Destroy', character, method: :delete, data: { confirm: 'Are you sure?' } %></td>
  </tr>
<% end %>
</table>

<br /> 
```

控制器：

```
class CharactersController < ApplicationController
  # GET /characters
  # GET /characters.json
  def index
    @characters = Character.all

    respond_to do |format|
      format.html # index.html.erb
      format.json { render json: @characters }
    end
  end

  # GET /characters/1
  # GET /characters/1.json
  def show
    @character = Character.find(params[:id])

    respond_to do |format|
      format.html # show.html.erb
      format.json { render json: @character }
    end
  end

  # GET /characters/new
  # GET /characters/new.json
  def new
    @character = Character.new

    respond_to do |format|
      format.html # new.html.erb
      format.json { render json: @character }
    end
  end

  # GET /characters/1/edit
  def edit
    @character = Character.find(params[:id])
  end

  # POST /characters
  # POST /characters.json
  def create
    @character = Character.new(params[:character])

    respond_to do |format|
      if @character.save
        format.html { redirect_to @character, notice: 'Character was successfully created.' }
        format.json { render json: @character, status: :created, location: @character }
      else
        format.html { render action: "new" }
        format.json { render json: @character.errors, status: :unprocessable_entity }
      end
    end
  end

  # PUT /characters/1
  # PUT /characters/1.json
  def update
    @character = Character.find(params[:id])

    respond_to do |format|
      if @character.update_attributes(params[:character])
        format.html { redirect_to @character, notice: 'Character was successfully updated.' }
        format.json { head :no_content }
      else
        format.html { render action: "edit" }
        format.json { render json: @character.errors, status: :unprocessable_entity }
      end
    end
  end

  # DELETE /characters/1
  # DELETE /characters/1.json
  def destroy
    @character = Character.find(params[:id])
    @character.destroy

    respond_to do |format|
      format.html { redirect_to characters_url }
      format.json { head :no_content }
    end
  end
end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T04:38:11.550

您设法使用一些保留字作为您的属性。特别`class`不应该用作模型属性。您会注意到`character.class`在您的视图中被调用，它应该返回“Character”，即该特定角色对象的类名。

这是保留关键字的列表：http: [//oldwiki.rubyonrails.org/rails/pages/ReservedWords](http://oldwiki.rubyonrails.org/rails/pages/ReservedWords)

# c# - 如何在 WinForms 和 EntityFramework 中生成 Pivot Datagridview

> ID：13080734
> 
> 赞同：2
> 
> 时间：2012-10-26T04:27:49.820
> 
> 标签：c#, winforms, linq

我想在 WinForms 和 EntityFramework 中生成一个 Pivot Datagridview，从这些实体开始：

```
public class Return
{
    public Return()
    {
        this.ReturnQty = new List<ReturnQty>();
    }

    public int Id { get; set; }
    public Nullable<System.DateTime> Date { get; set; }
    public Nullable<int> ReturnReason { get; set; }
    public Nullable<System.DateTime> Belastungsdatum { get; set; }
    public virtual ICollection<ReturnQty> ReturnQty  { get; set; }
}

public class ReturnQty
{
    public int ID { get; set; }
    public int Return_ID { get; set; }
    public string ItemNo { get; set; }
    public Nullable<decimal> Qty { get; set; }
    public virtual Return Return { get; set; }
} 
```

Pivot Dataviewgrid 应如下所示：

![在此处输入图像描述](../Images/d17eb5a28780267397789458cf33376b.png)

这就是我现在所拥有的：

```
public static class ReturnReasons
{

    public static string a { get { return "Grund nicht erfasst"; } }
    public static string a1 { get { return "Artikel mangelhaft"; } }
    public static string a2 { get { return "Bestellirrtum Kunde"; } }
    public static string a3 { get { return "Doppelbestellung Kunde"; } }
    public static string a4 { get { return "AV Kunde"; } }
    public static string a5 { get { return "Kundenadresse falsch"; } }
    public static string a6 { get { return "Kunde nicht erreichbar"; } }
    public static string a7 { get { return "Kundenstorno"; } }
    public static string a8 { get { return "Nichtgefallen"; } }
    public static string a9 { get { return "Transportschaden UPS/DHL/GLS"; } }
    public static string a10 { get { return "Transportschaden Spedition"; } }
    public static string a11 { get { return "Transportschaden verdeckt"; } }
    public static string a12 { get { return "Kommissionierungsfehler"; } }
    public static string a13 { get { return "Fehler Auftragserfasung"; } }
    public static string a14 { get { return "Lieferverzögerung"; } }
    public static string a15 { get { return "Warenrücksendung lt. Vereinbarung"; } }
    public static string a16 { get { return "ohne Grund/sonstiges"; } }
}

        public class RetourenPivot
    {
        public string Item{ get; set; }
        public IEnumerable<int?> ReturnReason{ get; set; }
        public IEnumerable<decimal?> Qty{ get; set; }
    }

        private void DG_databind()
    {
        var query = _data.RepositoryRetouren.GetAll<ReturnQty>();
        // A Linq to EF which creates a List of concreate class called RetourenPivot.
        var queryResults = (from iso in query
                            orderby iso.ItemNo ascending
                            group iso by iso.ItemNo into isoGroup
                            select new RetourenPivot()
                            {
                                Item = isoGroup.Key,
                                ReturnReason = isoGroup.Select(y => y.Return.ReturnReason),
                                Qty = isoGroup.Select(v => v.Qty)
                            }).ToList();

        // Call a function to create a dynamically created data table with the needed columns

        // Create a DataTable as a DataSource for the grid
        DataTable dt = new DataTable();
        // Create the DataColumns for the data table
        DataColumn dc = new DataColumn("Artikel", typeof(string));
        dt.Columns.Add(dc);

        // Get a list of Distinct Reasons
        var ReasonLabel = (from yList in queryResults.Select(Reason => Reason.ReturnReason)
                           from Reason in yList
                           select Reason.ToString()).Distinct().ToList();

        // Create the DataColumns for the table
        ReasonLabel.ForEach(delegate(string Reason)
        {
            var reasonTexts = typeof(ReturnReasons).GetProperties().Where(p => p.Name == "a" + Reason).ToList()[0].GetValue(null, null).ToString();
            dc = new DataColumn(reasonTexts, typeof(string));
            dt.Columns.Add(dc);
        });

        // Populate the rowa of the DataTable
        foreach (RetourenPivot rec in queryResults)
        {
            // The first two columns of the row always has a ISO Code and Description
            DataRow dr = dt.NewRow();
            dr[0] = rec.Item;

            // For each record
            var Reason = rec.ReturnReason.ToList();
            var Qty = rec.Qty.ToList();

            // Because each row may have different reasons I am indexing
            // the with the string name
            for (int i = 0; i < Qty.Count; i++)
            {
                var reasonTexts = typeof(ReturnReasons).GetProperties().Where(p => p.Name == "a" + Reason[i].ToString()).ToList()[0].GetValue(null, null).ToString();
                dr[reasonTexts] = Qty[i].Value;
            }

            // Add the DataRow to the DataTable
            dt.Rows.Add(dr);
        }

        // Bind the DataTable to the DataGridView
        dataGridViewSummary1.ColumnHeadersHeightSizeMode = DataGridViewColumnHeadersHeightSizeMode.EnableResizing;
        dataGridViewSummary1.ColumnHeadersHeight = 200;

        //Connect Grid with DataSource
        //this.dataGridViewSummary1.AutoGenerateColumns = true;
        this.dataGridViewSummary1.DataSource = dt;
    } 
```

问题是，queryResults 中的每个 RetourenPivot 可能有多个具有相同 ReturnReason 的数量，我不知道如何总结它们。例如，现在它看起来像

项目 123 ReturnReason {0, 0, 0, 0, 1, 16} 数量 {1, 1, 2, 1, 5, 1}

这意味着，由于 0 的原因，有 4 个数量。它应该看起来像

项目 123 ReturnReason { 0, 1, 16} 数量 {5, 5, 1}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T12:40:11.560

这不是一个食谱，而只是一些解决您问题的建议。

1) ReturnReason 应该是一个类：

```
public class ReturnReason
{
   public int Code { get; set; }
   public string Description {get; set;}
} 
```

2) 创建一个 ReturnReasonList 类。将其实现为单例并使用它来提供原因：

```
public sealed class ReturnReasonList
{
   protected List<ReturnReason> pInstance = new List<ReturnReason> {
      { .Code=1, .Description="whatever reason 1" },
      { .Code=2, .Description="whatever reason 2" },
      ... 
      { .Code=n, .Description="whatever reason n" }};

   private ReturnReasonList() {}

   public List<Returnreason> pInstance
   {
      get
      {
         return pInstance;
      }
   }
} 
```

3) 考虑每一对你真正需要的东西（ItemNo，ReturnReason）：

```
public class ReturnedQuantity 
{
   int ItemNumber { get; set; }
   Returnreason { get; set;}
   int Quantity {get; set;}
} 
```

4）现在您必须从您的返回数据创建一个列表：

```
var query = _data.RepositoryRetouren.GetAll<ReturnQty>();
List<ReturnedQuantity> returns = from r in query
                                 join rs in ReturnReasonList.Instance
                                 on r.ReturnReason = rs.Code
                                 group by rs, r.ItemNo
                                 select new ReturnedQuantity() {.ItemNo = r.ItemNo, .Reason= rs, .Quantity = SUM(r.Qty) }; 
```

5) 用 ReturnReasonList.Items 中的项目填充 DataGridView 列集合

6) 用文章列表中的项目填充 DataGridView 行集合。

7) 用数量填充您的 DataGridView 单元格。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T04:28:19.360

我在此回答我自己的问题。我不知道这个解决方案是否是最好的解决方案。

我为查询创建了两个临时类

```
 public class RetourenNeu
    {
        public string Artikel { get; set; }
        public int? Retourengrund { get; set; }
        public decimal? Anzahl { get; set; }
    }

    public class RetourenPivot
    {
        public string Artikel { get; set; }
        public IEnumerable<int?> Retourengrund { get; set; }
        public IEnumerable<decimal?> Anzahl { get; set; }
    } 
```

然后我做了两个查询。第一个查询按 ReturnReason 和 Itemnumber 分组并汇总数量。第二个查询按 Itemnumber 对第一个查询进行分组。

```
 var queryResults = from iso in query
                           orderby iso.Artikelnummer ascending
                           group iso by new { iso.Artikelnummer, iso.Retourenkopfdaten.Retourengrund } into isoGroup
                           select new RetourenNeu()
                           {
                               Artikel = isoGroup.Key.Artikelnummer,
                               Retourengrund = isoGroup.Key.Retourengrund.HasValue ? isoGroup.Key.Retourengrund.Value : 0,
                               Anzahl = isoGroup.Select(v => v.Anzahl).Sum()
                           };

            var neu = (from n in queryResults
                   group n by n.Artikel into source
                   select new RetourenPivot()
                   {
                       Artikel = source.Key,
                       Retourengrund = source.Select(s => s.Retourengrund),
                       Anzahl = source.Select(s => s.Anzahl)
                   }).ToList(); 
```

现在结果符合要求。

# c - 用户输入 .txt 文件搜索 C

> ID：13080743
> 
> 赞同：0
> 
> 时间：2012-10-26T04:29:03.540
> 
> 标签：c, file-io

我正在尝试制作一个接受用户输入并在 .csv 文件中搜索所有匹配结果的程序。我想要做的是输出 .csv 文件中与用户搜索匹配的所有字符串。现在它提示用户输入搜索，但无论输入什么字符串，输出总是相同的。

到目前为止，这是我的代码

```
#include <stdio.h>
#include <string.h>

int main()
{
    FILE *fp=fopen("file.csv","r+");
    char  buf[1000];
    char  str[25];

    printf("Enter your search:");
    scanf ("%s", str);

    while(fgets(buf, sizeof(buf),fp)!= NULL)
    {
        if (strstr(buf, "str")){
            printf("%s\n", buf);
        }    
    }

    fclose(fp);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T04:32:58.080

好吧，目前您只搜索`"Salmon"`，而不是用户的输入。

无论如何，您为文件打开模式指定了无效标志...

如果要读取和写入文件，请`"r+"`使用`"w+"`或`"a+"`.

如果您只想阅读，请使用 mode `"r"`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T08:42:56.757

在您最新的编辑中，代码在 str 变量周围有双引号，需要删除

```
if (strstr(buf, "str")){ 
```

应该

```
if (strstr(buf, str)){ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T05:51:15.783

如果是 .csv 文件。如果你能以“r+”模式打开它会很棒。在你的情况下，它应该是这样的。

```
FILE *fp=fopen("file.csv","r+"); 
```

r+ 和 w+ 我们都可以在文件上读取、写入，但是 r+ 不会截断（删除）文件的内容，如果这样的文件没有退出，它也不会创建新文件，而在 w+ 中也会截断文件的内容如果这样的文件不存在，则创建一个新文件

# database - 在 Visual Studio '12 中使用 WebMatrix 数据库助手是否需要做任何“特殊”操作？

> ID：13080754
> 
> 赞同：0
> 
> 时间：2012-10-26T04:30:13.500
> 
> 标签：database, razor, visual-studio-2012, webmatrix-2

我正在 WebMatrix 中进行一些基本的数据库查询。

就像是，

```
@{
  var db = Database.Open("test"); //test is the name of my database
  var selectQuery = "SELECT * FROM MY_CUSTOM_TABLE"
}

//Doing a `@foreach` and showing the items from the table 
```

当我在 Visual Studio 中做同样的事情时，

我`Connection String not found`在`var db = Database.Open("test");`.

我错过了一些`using`陈述吗？还是我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T15:31:49.623

第一个问题是，

我没有在我的 web.config 中定义连接字符串。

我这样做了，它给了我一个`Instance Error`.

这需要一段时间才能解决奇怪的转义序列行为的原因。[这](http://www.hanselman.com/blog/CommentView.aspx?guid=89c01cae-e045-4b06-bff1-8dd2d596e266)对我有帮助。

# mysql - 使用触发器将数据从 SQL Server 插入到 MySql

> ID：13080765
> 
> 赞同：3
> 
> 时间：2012-10-26T04:31:44.107
> 
> 标签：mysql, sql, sql-server-2008, triggers

我有两个数据库，一个在 SQL Server 中，另一个在 MySql 中。我想在 SQL Server 表中发生插入时将数据插入 MySQL 表中。是否可以在 SQL Server 中使用触发器？请给我一个答案？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T05:08:45.117

您可以通过阅读[这篇关于将 MSSQL 连接到 MySQL](http://dbperf.wordpress.com/2010/07/22/link-mysql-to-ms-sql-server2008/)`MSSQL`的文章来创建从到的连接。`MySQL`

成功创建 from`MSSQL`到 的连接后`MySQL`，您可以使用触发器中的 INSERT 查询编写触发器以在 MySQL 数据库中插入数据。

希望能帮助到你...

# linux - 理解 rt_rq(real time runqueue) 内核中数据成员的使用

> ID：13080766
> 
> 赞同：6
> 
> 时间：2012-10-26T04:32:16.400
> 
> 标签：linux, linux-kernel, kernel

以下是v3.5.4中的实时运行队列结构

```
struct rt_rq {
        struct rt_prio_array active;
        unsigned int rt_nr_running;
#if defined CONFIG_SMP || defined CONFIG_RT_GROUP_SCHED
        struct {
                int curr; /* highest queued rt task prio */
#ifdef CONFIG_SMP
                int next; /* next highest */
#endif
        } highest_prio;
#endif
#ifdef CONFIG_SMP
        unsigned long rt_nr_migratory;
        unsigned long rt_nr_total;
        int overloaded;
        struct plist_head pushable_tasks;
#endif
        int rt_throttled;
        u64 rt_time;
        u64 rt_runtime;
        /* Nests inside the rq lock: */
        raw_spinlock_t rt_runtime_lock;

#ifdef CONFIG_RT_GROUP_SCHED
        unsigned long rt_nr_boosted;

        struct rq *rq;
        struct list_head leaf_rt_rq_list;
        struct task_group *tg;
 #endif
}; 
```

我已经了解某些数据成员代表什么，但我不完全确定以下数据成员：

a）`rt_nr_migratory`：（我认为）它是一个计数器，用于计算可以推送到其他 CPU 的任务数量

b)`pushable_tasks`是可以推送到其他运行队列的任务列表，如果它们没有要运行的东西。

如果我对上述条目有误，请纠正我。

c) `rt_throttled`, `rt_time`, `rt_runtime`, `rt_nr_total`, `rt_nr_boosted`: 我不明白这个有什么用。

还有为什么`struct rq *rq;`只在有组调度时才需要。我的意思是它的意义是什么。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-06T03:33:13.540

这是一个很难回答的问题，部分原因是它实际上是同时出现了六个复杂的问题。因此，为了帮助您理解这些部分，我在添加每个字段时进行了查找。阅读提交消息以及可能引入每个字段的补丁应该会让您更接近于理解它们存在的原因。

`rt_nr_migratory`在提交计划中添加[：添加 RT-balance cpu-weight](http://git.kernel.org/?p=linux/kernel/git/torvalds/linux.git;a=commit;h=73fe6aae84400e2b475e2a1dc4e8592cd3ed6e69)。

`pushable_tasks`已添加到 commit [sched: create "pushable_tasks" 列表中，以将推送限制为一次尝试](http://git.kernel.org/?p=linux/kernel/git/torvalds/linux.git;a=commit;h=917b627d4d981dc614519d7b34ea31a976b14e12)。

`rt_throttled`并`rt_time`在 commit [sched: rt time limit](http://git.kernel.org/?p=linux/kernel/git/torvalds/linux.git;a=commit;h=fa85ae2418e6843953107cd6a06f645752829bc0)中添加。

`rt_runtime`在 commit [sched: rt-group: smp balance](http://git.kernel.org/?p=linux/kernel/git/torvalds/linux.git;a=commit;h=ac086bc22997a2be24fc40fc8d46522fe7e03d11)中添加。

`rt_nr_total`在提交[sched_rt 中添加：修复 rt 组调度上的过载错误](http://git.kernel.org/?p=linux/kernel/git/torvalds/linux.git;a=commit;h=a1ba4d8ba9f06a397e97cbd67a93ee306860b40a)。

`rt_nr_boosted`已在 commit [sched: rt-group: deal with PI](http://git.kernel.org/?p=linux/kernel/git/torvalds/linux.git;a=commit;h=23b0fdfc9299b137bd126e9dc22f62a59dae546d)中添加。（我相信这里的“PI”是指“优先级倒置”。）

`rq`已在 commit [sched: rt group scheduling](http://git.kernel.org/?p=linux/kernel/git/torvalds/linux.git;a=commit;h=6f505b16425a51270058e4a93441fe64de3dd435)中添加。

* * *

我曾经`git blame`查明每一行是什么时候引入的，但在这种情况下它相当复杂，因为自从所有这些工作完成以来，调度程序源代码已经经历了两次重大重组。所以当我使用时`git blame sched.h`，它告诉我整个结构是一次性添加的，但它命名的提交实际上是在结构被移出时`sched.c`。然后我经常`git blame <commit>~ -- sched.c`看到 sched.c 在更改之前的样子。最后，对于我认为可能重要的每个提交，我使用`git show <commit>`.

# java - 我不知道这个 void 方法是如何工作的

> ID：13080767
> 
> 赞同：5
> 
> 时间：2012-10-26T04:32:19.937
> 
> 标签：java, arrays, void

我的代码是：

```
public class MyProgram {
    public void start() {
        int a = 1; 
        int[] b = { 1, 2, 3}; 
        int[] c = { 1, 2, 3}; 

        method1(a,  b[0], c); 

        System.out.println("a   = " + a); 
        System.out.println("b[0]   = " + b[0]); 
        System.out.println("c[0]   = " + c[0]); 
    }

    private  void method1(int x, int y, int[] z) {
        x++; 
        y = 10; 

        if ( z.length >= 1   ) {  
            z[0] = 100;  
        }
        System.out.println(x); 
        System.out.println(y); 
    }
} 
```

输出是

```
a   = 1
b[0]   = 1
c[0]   = 100 
```

我真的不知道为什么只有 c[0] 发生了变化。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T04:35:55.727

`private void method1(int x, int y, int[] z)`

注意`int`type 是一个原始类型，所以它是按值传递的（值被复制过来）

而且`int[]`type是一个数组，所以是通过引用传递的（对数组的引用是传递过来的）

因此，当您修改`int`变量时，您正在更改副本 - 它们不会影响该函数范围之外的变量

当您修改数组时，它是通过传入的引用完成的 - 因此更改会持续存在。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T04:34:17.270

```
 if ( z.length >= 1   ) {  
        z[0] = 100;  
    } 
```

因为您在此处更改了它并且数组通过“引用值”传递（此引用的另一个副本，仍然指向相同的对象/数组）。

因此，当您执行以下代码时，会发生以下情况：

```
method1(a,  b[0], c); 
```

它将'c' 参考值传递给method1。

在内部`method1`，您没有将任何`new`数组分配给此引用值的副本，因此对此引用的操作会反映在原始数组上。

因此`z[0]`更新反映在`c[0]`索引处。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-26T04:34:04.900

因为数组是通过引用传递的，而其他变量都是本地的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-26T04:36:31.570

当您将变量传递给 Java 中的方法时，您会传递它们的“值”（因为 Java 仅支持按值传递）。对于像数组和对象这样的“引用类型”变量，您*仍然*传递它们的值，但它们的值是对内存中实际存储数据的某个位置的引用。

因此，您在`method1`方法内部对数组进行的任何修改都会改变数组的实际内容。

内存示例：

```
 (someplace in memory)
 -------            --------------
|   c   |  ----->   |     1      |   0
 -------            |     2      |   1
                    |     3      |   2
                    -------------- 
```

当您传递`c`给一个方法时，该方法中的参数获取的“值”`c`实际上是一个引用或指向存储数组数据的内存中某个空间的指针。您在方法中所做的任何更改`c`都将反映在数组中，因为它指向内存中的同一位置。

```
 (someplace in memory)
 -------            --------------
|   c   |  ----->   |    100     |   0
 -------            |     2      |   1
                    |     3      |   2
                    -------------- 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-26T04:37:10.810

```
method1(a,  b[0], c); 
```

由于在 Java 中，一切都是按值传递的，所以前两个参数`a`和`b[0]`，当在被调用方法中更改时，对调用方法没有影响。因为，当你改变它时，值会改变，而原始值保持不变。

但是，第三个参数`c`是您的数组的引用。这也是按值传递的。因此，当您将它传递给一个方法时，会生成一个引用副本，并且被调用方法 ( `z`) 中的参数也指向同一个数组对象。

现在，您使用传递的引用对数组所做的任何更改都将反映在指向该数组的所有引用中。

```
private  void method1(int x, int y, int[] z) 
```

因此，在这种方法中，`x`和是包含与和`y`相同值的不同变量。然而，具有不同的地址，指向与原始引用指向的相同对象。`a``b``z``reference``array``c`

```
 c[0] c[1] c[2]
         z[0] z[1] z[2] // So, if you change `z[0]`, `a[0]` will also see the change

c ---->  [ 1,   2,   3 ] -> // Any change in the array is reflected in 
          ^                 // both the reference a and z
          |
          |
z --------+

a -> someValue
x -> someValue -> // If we change this, the `someValue` for `a` won't be changed. 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-26T04:35:53.247

为什么它不会改变？

c 指向一个数组对象。当您将 c 传递给 method1 时，c 的副本（指针/引用，而不是数组本身）将作为 z 传递。但是， z 仍然指向 c 指向的同一个数组实例。如果您通过 z 更改该数组实例的内容，当然它会在您之后通过 c 访问时反映出来。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-10-26T04:47:23.960

方法method1有3个参数，前两个是原始int类型，最后一个是数组类型。Java 不通过引用传递方法参数；它按值传递它们。

原始类型不是对象，因此原始类型的副本将被传递到方法1

您需要了解 Java 按值复制和传递引用，而不是对象。当您在 java 中创建对象时，您可以通过其引用访问该对象。当您调用 method1 时，java 会做的是获取对数组的引用，复制该引用并将其传递给 method1。这意味着您将有两个指向数组的引用（一个在 start 方法中，一个在 method1 方法中）。因此，在 method1 中进行的任何修改最终都会影响数组，因为在 method1 中使用的引用指向数组

# gevent - 关于 gevent 的运行时间难题

> ID：13080768
> 
> 赞同：0
> 
> 时间：2012-10-26T04:32:29.033
> 
> 标签：gevent

有人可以帮助我 gevent 令人费解的行为吗？这是我的代码：
[https](https://gist.github.com/3956734) ://gist.github.com/3956734 。

我想知道怎么用`gevent.pool`。我一次产生一个greenlet，greelet除了睡10秒什么都不做。它应该只运行 10 秒，但在实际情况下运行 20 秒。

我的代码有什么问题？我已经阅读了 gevent 的文档，但仍然不知道。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T03:25:01.027

根据您代码中的注释：

```
#ids_set = {'945453','1909279'} 
```

根据你的问题，你的greenlets除了睡10秒什么都不做。

假设这两件事都是真的，那么你的代码......

```
 while ids_set is not None:
    id = ids_set.pop()
    print 'now id is', id
    pool.spawn(download_content_test,int(id))
    pool.join() 
```

... 应该运行 20 秒，因为您在*每次*生成后加入池。所以你的代码正在这样做：spawn，join（10 秒等待），spawn，join（10 秒等待）。

我认为你的意思是`pool.join()`在while循环之外。然后它只会等待10秒。

# mysql - mysql查询优化

> ID：13080770
> 
> 赞同：2
> 
> 时间：2012-10-26T04:32:36.083
> 
> 标签：mysql, sql, database, query-optimization

我的任务是帮助加快这个查询，我认为这些表上的一些索引没有正确设置。我也相信它们不会全部被使用 b/ca 函数应用于我有索引的 col。谁能看到我如何优化这些表或查询？该`requests`表将是 3 个表中最大的表，将有超过 20 万条记录。`devices`目前有约 500 条记录，并且`clients`也会更小。

询问：

```
explain extended SELECT MAX(Request.datetime) AS datetime, Device.id,
       Device.client_id, Device.mac_address, Device.type, Device.manufacturer,
       Device.model_number, Client.id, Client.email_address,
       Request.device_id, Request.datetime, Request.ip_address
  FROM livefi.devices AS Device
  LEFT JOIN livefi.clients AS Client
    ON (Client.id         = Device.client_id)
 INNER JOIN livefi.requests AS Request
    ON (Request.device_id = Device.id)
 GROUP BY Request.device_id, Request.client_id

+----+-------------+---------+--------+---------------------------------------------------------+---------------+---------+-------------------------+------+----------+---------------------------------+
| id | select_type | table   | type   | possible_keys                                           | key           | key_len | ref                     | rows | filtered | Extra                           |
+----+-------------+---------+--------+---------------------------------------------------------+---------------+---------+-------------------------+------+----------+---------------------------------+
|  1 | SIMPLE      | Device  | ALL    | PRIMARY                                                 | NULL          | NULL    | NULL                    |  617 |   100.00 | Using temporary; Using filesort |
|  1 | SIMPLE      | Client  | eq_ref | PRIMARY                                                 | PRIMARY       | 4       | livefi.Device.client_id |    1 |   100.00 |                                 |
|  1 | SIMPLE      | Request | ref    | idx_device_id,inx_requests_deviceId_datetime_ip_address | idx_device_id | 5       | livefi.Device.id        |  144 |   100.00 | Using where                     |
+----+-------------+---------+--------+---------------------------------------------------------+---------------+---------+-------------------------+------+----------+---------------------------------+
3 rows in set, 1 warning (0.04 sec) 
```

表：

```
CREATE TABLE `clients` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `email_address` varchar(100) DEFAULT NULL,
  `mac_address` varchar(17) DEFAULT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `email_address` (`email_address`),
  KEY `idx_mac_address` (`mac_address`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8

CREATE TABLE `devices` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `client_id` int(10) unsigned DEFAULT NULL,
  `mac_address` varchar(17) DEFAULT NULL,
  `type` varchar(25) DEFAULT NULL,
  `manufacturer` varchar(100) DEFAULT NULL,
  `model_number` varchar(50) DEFAULT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `mac_address` (`mac_address`),
  KEY `idx_mac_address` (`mac_address`),
  KEY `fk_devices_clients1` (`client_id`),
  CONSTRAINT `fk_devices_clients1` FOREIGN KEY (`client_id`) REFERENCES `clients` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION
) ENGINE=InnoDB AUTO_INCREMENT=492 DEFAULT CHARSET=utf8

CREATE TABLE `requests` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `client_id` int(10) unsigned DEFAULT NULL,
  `device_id` int(10) unsigned DEFAULT NULL,
  `domain_id` int(10) unsigned DEFAULT NULL,
  `ip_address` varchar(15) DEFAULT NULL,
  `datetime` datetime DEFAULT NULL,
  `gmt_offset` time DEFAULT NULL,
  `request_method` varchar(15) DEFAULT NULL,
  `url` text,
  `http_protocol` varchar(20) DEFAULT NULL,
  `http_status_code` varchar(20) DEFAULT NULL,
  `request_size` int(10) unsigned DEFAULT '0',
  `referer` text,
  `user_agent` text,
  `squid_cache_response` varchar(255) DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `idx_client_id` (`client_id`),
  KEY `idx_datetime` (`datetime`),
  KEY `idx_device_id` (`device_id`),
  KEY `idx_domain_id` (`domain_id`),
  KEY `idx_id` (`id`),
  KEY `idx_request_size` (`request_size`),
  KEY `inx_requests_deviceId_datetime_ip_address` (`device_id`,`datetime`,`ip_address`),
  CONSTRAINT `fk_requests_clients` FOREIGN KEY (`client_id`) REFERENCES `clients` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  CONSTRAINT `fk_requests_devices1` FOREIGN KEY (`device_id`) REFERENCES `devices` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  CONSTRAINT `fk_requests_domains1` FOREIGN KEY (`domain_id`) REFERENCES `domains` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION
) ENGINE=InnoDB AUTO_INCREMENT=200523 DEFAULT CHARSET=utf8 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T23:20:31.340

我会在（ Device_ID, ID ）上的设备上有一个索引，我过去曾提供过这个索引，显然对另一个人来说效果很好。日期可能是查询中的一个瓶颈，但整数很容易。

如果您仅对 Device AND MAX(ID) 进行预查询，这实质上将返回最新的日期/时间……由于 ID 是自动递增的，因此其日期/时间值将直接关联为最新的。 . 所以他们是一回事。

一个例外情况是，如果您处于多台服务器的某种集群环境中，可能会添加自己的 auto-inc ID 列，这可能会导致错误的最大条目。如果是这种情况，则将索引更改为 (Device_ID, DateTime)。

也就是说，我将执行以下操作

```
SELECT STRAIGHT_JOIN
      PerQuery.Device_ID,
      PreQuery.LastRequestID as Request_ID,
      RDtl.datetime, 
      d.client_id, 
      d.mac_address, 
      d.type, 
      d.manufacturer,
      d.model_number, 
      c.id, 
      c.email_address,
      r.ip_address
   FROM 
      ( select rq.Device_ID,
               MAX( rq.ID ) as LastRequestID
            from
               livefi.Requests rq
            group by
               rq.Device_ID ) PreQuery
         JOIN livefi.Request RDtl
            ON PreQuery.LastRequestID = RDtl.ID
            JOIN livefi.Clients c
               ON RDtl.ClientID = c.ID
         JOIN livefi.Devices d
               ON PreQuery.Device_ID = d.ID 
```

预查询是唯一具有分组依据的查询，并且会直接优化到索引...由于每个设备将只返回一条记录及其对应的“请求”ID，因此它将只加入“其他”的原始请求表" 详细信息、客户端和设备详细信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-01T21:54:18.763

我建议：

```
ALTER TABLE requests ADD INDEX (device_id, client_id, datetime); 
```

另外，请注意您不应该在您的条款中包含`Request.datetime`nor ，因为它们不是条款的一部分。这是因为其中的几行可能具有相同的和，并且选择哪个值或多少有些随机。`Request.ip_address``SELECT``GROUP BY``requests``device_id``client_id``datetime``ip_address`

# database - node.js 传递变量

> ID：13080771
> 
> 赞同：7
> 
> 时间：2012-10-26T04:32:41.747
> 
> 标签：database, node.js, variables

我正在从一些经验丰富的 node.js 程序员那里寻找一些方向。我遇到的最大问题是将变量传递到单独的模块中。例如，在我的 server.js 中，我有以下内容：

```
var db = mongoose.createConnection('localhost','test'); 
```

现在我没有在 server.js 文件中运行我的路由，它们被分成自己的文件。因此，对于博客示例，它可能是这样的：

```
app.get('/blog/post/:id',function(req,res){
    //do something here
} 
```

现在这就是问题所在。我不想在每条路由中都设置数据库连接，更不用说我认为它会建立大量连接。我该如何处理，那里有一个示例“REAL WORLD”应用程序，因为我似乎找不到任何关于这个的东西，而且我知道人们以前必须遇到这个问题。我知道节点缓存模块，但我无法想象它会缓存连接，因为它位于自己的模块中。我创建了一个仅保存站点配置的配置模块，因此在我需要的地方需要它不是问题。我想我还想做其他事情，所以最好现在就弄清楚。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T04:59:13.433

这是我在现实世界应用程序中所做的。

我有一个名为`redis`（这是我正在使用的数据库）的模块。它包含以下代码：

```
var store;

exports.store = store = redis.createClient(config.port, config.url); 
```

因此，如果需要，我可以直接访问客户端。我几乎从不这样做。相同的模块包含如下代码：

```
exports.getData = function(dataID, callback){

    var key = DATA_STORE_PREFIX;

    try{
        store.hget(key, dataID, callback);
    } catch(err){
        callback(err);
    }
} 
```

我通过将`redis`模块包含在一个或多个路由模块中并这样调用它来使用它：

```
var db = require('redis');

db.getData('someData', function(err, result){
    console.log(result); // real world code goes here!
}); 
```

节点模块系统负责其余的工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-26T04:51:31.740

一种方法是将连接添加为对象的属性，所有需要它的模块都可以使用该属性。例如，在我的快速应用程序中，我的主应用程序文件中有这样的内容：

```
require('./config/database')(app); 
```

`config/database`文件看起来像：

```
var mongoose = require('mongoose');

module.exports = function(app) {
  var database = app.get('env');
  var uri = database === 'production' ? 'something...' : 'localhost';
  return app.locals.db = mongoose.createConnection(uri, database);
}; 
```

任何需要数据库连接的模块都可以`app.locals.db`通过导出一个作为参数的函数来访问`app`（就像上面一样）。当然，如果您使用的是 express 以外的其他东西，则需要对其进行一些修改，但想法保持不变。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-26T08:34:40.417

你正在使用快递，我明白了。做就是了：

```
app.set('db',  mongoose.createConnection('localhost','test')) 
```

然后在任何模块构造函数中，确保传递`app`变量，您可以使用`app.get('db')`它来开始`db`工作。

# java - 如何在 JFace 向导页面之间传递数据..？

> ID：13080773
> 
> 赞同：1
> 
> 时间：2012-10-26T04:32:44.853
> 
> 标签：java, swt, jface, wizard

大家好，我正在研究有多个页面的 JFace 向导。在我的一个页面中，我有一个功能，用户可以从本地计算机中选择任意数量的文件夹并将它们添加到同一页面上的 SWT 列表中。

```
 selectedFoldersList = new List(container, SWT.BORDER);
   selectedFoldersList.add(selectedFolderPath); 
```

现在为了执行进一步的操作，我希望在向导的下一页上显示此列表，其中列表中的数据将显示到另一个列表组件中，如何通过单击页面上的下一步按钮在页面之间传递数据..？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T05:15:38.917

向导是一种逐步捕获数据以执行操作的模式。在您的情况下，您需要将在向导的每个页面中收集的数据填充到数据模型类中，最后当您单击完成时，您实际上会使用这些数据来执行某些操作。

# flex4 - 为什么我无法通过 mxml 中的 id 访问标签？

> ID：13080776
> 
> 赞同：0
> 
> 时间：2012-10-26T04:33:07.207
> 
> 标签：flex4, flex-spark

也许这个问题太简单了：

```
<?xml version="1.0" encoding="utf-8"?>
<s:View xmlns:fx="http://ns.adobe.com/mxml/2009" 
        xmlns:s="library://ns.adobe.com/flex/spark">
    <s:Label id="label1"/>
    <fx:Script>
        public function setMsg(msg:String):void
        {
            label1.text = msg;
        }
    </fx:Script>
</s:View> 
```

存在运行时错误，因为 label1 为空。但是当我将 s:View 更改为 s:Group 时，一切正常。为什么？

PS：把标签放在 SkinableContainer 里也会有这个问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T13:22:48.053

组件是异步实例化的。您可能想尝试此实现。

```
<?xml version="1.0" encoding="utf-8"?>
<s:View xmlns:fx="http://ns.adobe.com/mxml/2009"
        xmlns:s="library://ns.adobe.com/flex/spark">
  <fx:Script>
    <![CDATA[
    private var _message:String, _messageChanged:Boolean;

    public function get message():String {
      return _message;
    }

    [Bindable("messageChanged")]
    public function set message(value:String):void {
      if (_message == value) {
        return;
      }
      _message = value;
      _messageChanged = true;
      invalidateProperties();
      dispatchEvent(new Event('messageChanged'));

    }

    override protected function commitProperties():void {
      super.commitProperties();
      if (_messageChanged) {
        _messageChanged = false;
        label1.text = _message;
      }
    }
    ]]>
  </fx:Script>

  <s:Label id="label1"/>
</s:View> 
```

这是基于 Flex 组件生命周期的，它可以让你输入一点，但是如果你不能/不想像这个例子中那样使用数据绑定，那么使用模板也可以：

```
<?xml version="1.0" encoding="utf-8"?>
<s:View xmlns:fx="http://ns.adobe.com/mxml/2009"
        xmlns:s="library://ns.adobe.com/flex/spark">
  <fx:Script>

    [Bindable]
    private var _message:String;

    public function setMsg(msg:String):void
    {
      _message = msg;
    }
  </fx:Script>

  <s:Label id="label1" text="{_message}"/>
</s:View> 
```

这个例子可能也是我一个不错的选择 - 取决于您的需要。

# iphone - UIButton 文本大小问题

> ID：13080779
> 
> 赞同：4
> 
> 时间：2012-10-26T04:33:43.103
> 
> 标签：iphone, objective-c, ios, xcode, uibutton

我有以下代码：

```
UIButton *button = [UIButton buttonWithType:UIButtonTypeCustom];
[button setTitle:@"My Title" forState:UIControlStateNormal];
button.frame = myCustomRect;
UIColor *fontColor = [UIColor colorWithRed:0.43 green:0.84 blue:0.86 alpha:0.9];
[button setTitleColor:fontColor forState:UIControlStateNormal];
button.backgroundColor = [UIColor whiteColor];
button.titleLabel.textAlignment = NSTextAlignmentCenter;
button.titleLabel.font = [UIFont fontWithName:@"Cooperplate" size:9];
[button addTarget:self
                action:@selector(moreDetails:)
 forControlEvents:UIControlEventTouchUpInside];    
[self.view addSubview:button]; 
```

我正在尝试以编程方式向视图添加一个按钮。MyCustomRect 的参数是 (0,0,75,50)。

两件事：a）无论我输入什么字体，它总是显示系统字体。b）大小也根本没有变化。我尝试增加字体大小，它没有改变，我尝试减小字体大小，它也没有改变。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T04:55:15.510

您可以在项目中使用自己的自定义字体，如此[处所述](http://lawrenceleach.com/using-custom-fonts-in-ios-5)

将自定义字体添加到项目后，您可以将其用作，

```
[button.titleLabel setFont:[UIFont fontWithName:@"Cooperplate" size:24.0]]; 
```

> 首先，在 XCode 中找到应用程序 .plist 文件。通常称为 [YOUR_APP_NAME]-Info.plist。找到文件后，添加一个新的键行：“应用程序提供的字体”。XCode 将为您创建第一个键/值对。这是我的 .plist 文件条目的屏幕截图。

[图片](http://getfile3.posterous.com/getfile/files.posterous.com/temp-2011-12-08/rrgIctBcxEvemquElmrfFpjtznmDwDdcrmlAFkohiHeJFtgbIFHgvkCsprwC/Screen_Shot_2011-12-08_at_11.17.34_PM.png.scaled500.png)

> 在“值”列中添加字体文件的名称。请务必准确拼写字体文件的名称，因为它在项目的文件列表中显示。这不是您将在 UIFont 语句中引用的名称。这只是为了让您的应用知道在哪里可以找到您要引用的字体。
> 
> 接下来，您需要要使用的字体名称。现在你在你的应用程序中引用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T08:55:54.747

试试这个 UIButton

```
UIButton *btn = [UIButton buttonWithType:UIButtonTypeRoundedRect];
[btn setFrame:CGRectMake(20 , 13, 200, 85)];
UILabel *title = [[UILabel alloc]initWithFrame:CGRectMake(8, 8, 185, 30)];
[title setBackgroundColor:[UIColor clearColor]];
[title setFont:[UIFont fontWithName:@"Chalkboard" size:14]];
[title setFont:[UIFont boldSystemFontOfSize:18]];
title.text=@"This is the title";
[title setTextColor:[UIColor blackColor]];
[btn addSubview:title];
[title release];
[self.view addSubview:btn]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-26T04:36:09.473

尝试使用这个

```
[button.titleLabel setFont:[UIFont fontWithName:@"Helvetica-Bold" size:13.0]]; 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-10-26T05:13:01.290

在之后使用这行代码：这应该可以解决大小问题

```
button.titleLabel.font = [UIFont fontWithName:@"Cooperplate" size:9];
button.titleLabel.font = [UIFont systemFontOfSize:30]; 
```

# c#-4.0 - 带有 Crystal Reports Viewer 的应用程序未在 Windows XP 中加载

> ID：13080787
> 
> 赞同：1
> 
> 时间：2012-10-26T04:34:32.683
> 
> 标签：c#-4.0, crystal-reports, crystal-reports-xi

我`wpf application`在 Windows 7 中准备了一个使用 Visual Studio 2010，其中包括水晶报表查看器。

我尝试在另一`CR runtime`台已安装的 Windows 7 电脑上运行该应用程序，它工作正常。

我在 windows xp 上尝试了同样的事情，但每次加载水晶报告时都会出现未处理的异常，整个应用程序停止工作并关闭。

在这种情况下该怎么办？或者给我一些建议如何使用window-XP

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T05:04:06.007

有一个可再分发 (x86/x64) 是与 Crystal Reports .NET 集成的 .NET 应用程序的先决条件

您可以在 Business Objects“下载中心”下载它：

[http://downloads.businessobjects.com/akdlm/cr4vs2010/CRforVS_redist_install_32bit_13_0.zip](http://downloads.businessobjects.com/akdlm/cr4vs2010/CRforVS_redist_install_32bit_13_0.zip)

**更多信息/链接** [http://www.crystalreporthostingnews.com/index.php/archives/282](http://www.crystalreporthostingnews.com/index.php/archives/282)

# python - 方法工作正常，直到在函数中调用它，然后是 UnboundLocalError

> ID：13080788
> 
> 赞同：0
> 
> 时间：2012-10-26T04:34:38.457
> 
> 标签：python

我定义了一个名为 dist 的方法，用于计算两点之间的距离，我在直接使用该方法时正确地做到了这一点。但是，当我得到一个函数来调用它来计算两点之间的距离时，我得到 UnboundLocalError: local variable 'minkowski_distance' referenced before assignment

*编辑* 对不起，我刚刚意识到，这个功能确实有效。但是我有另一种调用它的方法。我把最后一个方法放在底部

这是方法：

```
class MinkowskiDistance(Distance):    
  def __init__(self, dist_funct_name_str = 'Minkowski distance', p=2):    
    self.p = p

  def dist(self, obj_a, obj_b):    
    distance_to_power_p=0    
    p=self.p    

    for i in range(len(obj_a)):    
      distance_to_power_p += abs((obj_a[i]-obj_b[i]))**(p)

    minkowski_distance = (distance_to_power_p)**(1/p)    
    return minkowski_distance 
```

这就是函数：（它基本上将元组 x 和 y 拆分为它们的数字和字符串分量，并计算 x 和 y 的数字部分之间的距离，然后计算字符串部分之间的距离，然后将它们相加。

```
def total_dist(x, y, p=2, q=2):    
    jacard = QGramDistance(q=q)    
    minkowski = MinkowskiDistance(p=p)

    x_num = []    
    x_str = []    
    y_num = []    
    y_str = []

    #I am spliting each vector into its numerical parts and its string parts so that the distances
    #of each part can be found, then summed together.

    for i in range(len(x)):

        if type(x[i]) == float or type(x[i]) == int:    
            x_num.append(x[i])    
            y_num.append(y[i])    
        else:
            x_str.append(x[i])    
            y_str.append(y[i])

    num_dist = minkowski.dist(x_num,y_num)

    str_dist = I find using some more steps
    #I am simply adding the two types of distance to get the total distance:

    return num_dist + str_dist

class NearestNeighbourClustering(Clustering):

  def __init__(self, data_file,
               clust_algo_name_str='', strip_header = "no", remove = -1):

      self.data_file= data_file    
      self.header_strip = strip_header    
      self.remove_column = remove

  def run_clustering(self, max_dist, p=2, q=2):    
      K = {}    

      #dictionary of clusters    
      data_points = self.read_data_file()    
      K[0]=[data_points[0]]    
      k=0

      #I added the first point in the data to the 0th cluster    
      #k = number of clusters minus 1

      n = len(data_points)    
      for i in range(1,n):    
          data_point_in_a_cluster = "no"

          for c in range(k+1):    
              distances_from_i = [total_dist(data_points[i],K[c][j], p=p, q=q) for j in range(len(K[c]))]
          d = min(distances_from_i)
          if d <= max_dist:
              K[c].append(data_points[i])
              data_point_in_a_cluster = "yes"

      if data_point_in_a_cluster == "no":
          k += 1
          K[k]=[data_points[i]]
  return K 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T04:38:26.940

`minkowski_distance = (distance_to_power_p)**(1/p)`仅当控件进入 for 循环时才执行该行

查看`len(obj_a)`

如果返回的值是`0`然后语句`return minkowski_distance`将抛出错误`local variable 'minkowski_distance' referenced before assignment`

`minkowski_distance = (distance_to_power_p)**(1/p)`您应该从 for 循环中取出该行

```
for i in range(len(obj_a)):
    distance_to_power_p += abs((obj_a[i]-obj_b[i]))**(p)

minkowski_distance = (distance_to_power_p)**(1/p) # this is only assignment, no need 
                                                  # for this to be inside the loop

return minkowski_distance 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T04:38:54.453

如果`obj_a`为空，`minkowski_distance`则永远不会设置

```
for i in range(len(obj_a)):

  distance_to_power_p += abs((obj_a[i]-obj_b[i]))**(p)

  minkowski_distance = (distance_to_power_p)**(1/p)

return minkowski_distance 
```

这将在 x 都不是整数或浮点数的情况下发生

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T04:39:54.277

你似乎有一个缩进问题：

```
class MinkowskiDistance(Distance):
  def __init__(self, dist_funct_name_str = 'Minkowski distance', p=2):
    self.p = p

  def dist(self, obj_a, obj_b):
    distance_to_power_p=0
    p=self.p

    for i in range(len(obj_a)):
      distance_to_power_p += abs((obj_a[i]-obj_b[i]))**(p)
      **minkowski_distance = (distance_to_power_p)**(1/p)**

    return minkowski_distance

```

`minkowski_distance = (distance_to_power_p)**(1/p)`是在一个`for`循环内，所以如果`for`循环永远不会运行，`minkowski_distance`永远不会设置，你的错误就会出现。

将该行降低一个缩进级别（两个空格），一切都应该工作。

# javascript - 如何使用 JavaScript 解析从 Ruby on Rails 控制器返回的多个 JSON 对象

> ID：13080791
> 
> 赞同：1
> 
> 时间：2012-10-26T04:35:01.360
> 
> 标签：javascript, ruby-on-rails, json

1.  在控制器上，我的代码如下：

    ```
    format.json {render :json=>{
      :entities => @entities,
      :entity_category_counters => @entity_category_counters
    }} 
    ```

2.  在浏览器端，我的代码如下：

    ```
    $.getJSON('/entities.json',function(data){
    //data.entities
    //data[0].entities
    //data['entities']
    }); 
    ```

    无论我使用哪种方式访问​​返回的 JSON 对象的数据，我都无法成功。

3.  返回的 JSON 如下：

    {"entities":[{"entity":{"created_at":"2011-08-01T18:14:32Z","description":"xxx"}},{"entity":{"created_at":"2011 -08-01T18:16:02Z","description":"xxx"}}],"entity_category_counters":[{"entity_category_counter":{"comment_category_id":1,"counter":4,"entity_id":1, "id":1,"important_tag":false}},{"entity_category_counter":{"comment_category_id":2,"counter":0,"entity_id":1,"id":2,"important_tag":false} },{"entity_category_counter":{"comment_category_id":3,"counter":0,"entity_id":1,"id":3,"important_tag":false}},{"entity_category_counter":{"comment_category_id":1,"counter":3,"entity_id":2,"id":4,"important_tag":false}},{"entity_category_counter":{"comment_category_id":2,"counter":0," entity_id":2,"id":5,"important_tag":false}},{"entity_category_counter":{"comment_category_id":3,"counter":1,"entity_id":2,"id":6,"重要标签“：假}}]}entity_id":2,"id":6,"important_tag":false}}]}entity_id":2,"id":6,"important_tag":false}}]}

4.  如果我直接使用 Alert 显示数据，如下所示：

    ```
    $.getJSON('/entities.json',function(data){
    //data.entities
    //data[0].entities
    //data['entities']
    alert(data);

    }); 
    ```

消息框中的结果如下：

```
 [object Object],[object Object] 
```

那么谁能告诉我如何解析和访问包含两个对象的返回 JSON 对象中的数据？提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T04:56:13.370

JSON 代表 JavaScript Object Notation，因此您现在使用的是纯 JavaScript。你可以这样做：

```
data.entities[0].entity.created_at // 2011-08-01T18:14:32Z 
```

我认为您的困惑在于实体是一个数组，因此您必须访问该数组的索引才能获取其中的实体。然后你也有实体类别。

我想你会发现几件事有帮助：

*   JSONLint ( [http://jsonlint.com/](http://jsonlint.com/) ) 粘贴到您的 json 代码中并对其进行格式化，以便您可以查看对象是可以直接访问还是在数组中，在这种情况下，您必须对其进行迭代或访问特定索引
*   您的浏览器控制台。在谷歌浏览器中，您可以右键单击页面，选择“检查元素”，然后单击控制台选项卡。从那里您可以在您所在页面的上下文中执行 javascript。我将您的 json 输出粘贴到控制台中以使用它：`test = {"entities...`

# c# - 解析 XML 的问题

> ID：13080799
> 
> 赞同：0
> 
> 时间：2012-10-26T04:36:17.890
> 
> 标签：c#, xml, linq-to-xml

我目前在解析我的 xml 文件时遇到问题，由于某种原因，我的 where caluse 的 .Value 给出了以下错误：

“System.Collections.Generic.IEnumerable”不包含“值”的定义

```
var data =
     from lv1 in LoadedFile.Descendants()
           where lv1.Element("TEST").Attributes("id").Value == "1"
           select new { 
               Header = lv1.Attribute("type").Value,
               Children = lv1.Attribute("text").Value
   }; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T04:38:18.163

您可以`Value`在**单个**属性上使用属性，而不是在多个属性上使用..

你应该使用`Attribute`而不是`Attributes`

所以应该是

```
where lv1.Element("TEST").Attribute("id").Value == "1" 
```

# php - PHP使变量和值成为数组的一部分

> ID：13080801
> 
> 赞同：0
> 
> 时间：2012-10-26T04:36:28.217
> 
> 标签：php, arrays, variables, foreach

我目前有这个功能可以在文本文件中搜索和替换。

```
// Input
$ect = array('Visssa', 'Lisssa', 'her');

// Placeholders in the file
$put =  array('lname', 'fname', 'hisher');

// Replace the placeholders
$oput = str_replace($put, $ct, 'tmpfile.txt'); 
```

这不是完整的程序，但想法是将 tmpfile.txt 中的值替换为 $etc 数组中的值。它完美无缺。

但是，我需要做的是获取所有传递的变量（get/post），然后制作数组，以便 var 是要替换的值，而值是要替换它的值。

所以，如果我发送网址[http://xyz.com/?lname=tom&ogre=yes](http://xyz.com/?lname=tom&ogre=yes)

文件中的所有 lname 实例都将替换为 tom，所有的 ogre 实例都将替换为 yes。

所以不知何故，它只是获取在 get/post 中传递的任何/所有变量，然后上面显示的数组将导致 var 被文件中的值替换。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T04:41:53.823

做这个：

```
 $etc = array_keys($_GET);
    array_walk($etc,"addBraces");
    $put = array_values($_GET);
    $oput = str_replace($etc, $put, 'tmpfile.txt'); 

    function addBraces(&$item)
    {
        $item = "{".$item."}";
    } 
```

当然，所有常规的“总是清理/转义您的数据”等......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T04:42:15.883

parse_str() 将是完美的

```
function addreplacetokens(&$input)
{
  $input = '{' . $input . '}';
}

$string = 'word {lname} word {fname} word {hisher} word';
$filter = array('lname','fname','hisher');
parse_str($_SERVER['QUERY_STRING'],$replacements);
foreach($replacements as $key => $value)
  if(in_array($key,$filter) == false)
    unset($replacements[$key]);
// this next block can be removed if you don't want a default
foreach($filter as $key)
  if(array_key_exists($key,$replacements) == false)
    $replacements[$key] = ''; // change this!
// copy the array so the keys can be filtered
$replacements_keys = array_keys($replacements);
array_walk($replacements_keys,'addreplacetokens');
$string = str_replace($replacements_keys,$replacements,$string);
echo $string; 
```

这样*?lname=hello*将输出

> 词你好词词词

下一个问题，你是否需要处理单词边界？

# database - Rake 任务在 Heroku 上运行两次

> ID：13080805
> 
> 赞同：0
> 
> 时间：2012-10-26T04:36:49.670
> 
> 标签：database, heroku, nokogiri, amazon-rds, rake-task

我在 heroku 上有一个应用程序，它可以从网站上抓取定价数据并定期保存。出于某种原因，每当我在本地运行 rake 任务时，它都会按预期运行，但是当我在 heroku 上运行该任务时，它会添加额外的输出并出于某种原因将对象保存两次。

当我在本地运行时输出

```
a,12.80 saved at 2012-10-26 03:36:17 UTC.
b,38.03 saved at 2012-10-26 03:36:24 UTC.
c,22.38 saved at 2012-10-26 03:36:31 UTC. 
```

我在heroku上运行时的输出

```
a,12.80 saved at 2012-10-26 03:36:17 UTC.
b,38.03 saved at 2012-10-26 03:36:24 UTC.
c,22.38 saved at 2012-10-26 03:36:31 UTC.
#<Stock:0x000000047bb5e8>,12.80 saved at 2012-10-26 03:36:45 UTC.
#<Stock:0x000000047baaf8>,38.03 saved at 2012-10-26 03:36:48 UTC.
#<Stock:0x000000047b00a8>,22.38 saved at 2012-10-26 03:36:52 UTC. 
```

代码

```
require 'open-uri'
require 'date'

namespace :data do 
  desc "import current blah stock price data to database"
  task :importblah => :environment do

  #pass in a stock and price and save it to the database
  def save_stock(stock, price)
    #store stock data in database
    p = stock.prices.build
    p.price = price
    p.datetime = Time.now.utc.to_datetime

    if p.save
      puts "#{stock.symbol},#{price} saved at #{p.datetime.to_s}."
    else
      puts "#{stock.symbol} didn't save."
    end
  end

  actives = Parent.where("test1 = ?", true)

  actives.each do |m|

    stocks = m.stocks.where('test2 = ?', false)
    stocks.each do |stock|
      if stock.title.start_with?('blah')
        #grab stock price data from blah.com
        url = "blah"+stock.symbol
        doc = Nokogiri::HTML(open(url))
        price = doc.at_css(".value").text[/\d+\.\d+/]
        save_stock(stock, price)
      end

    end
  end

  end
end 
```

对于不同的站点，我有一个几乎相同的 rake 任务，它没有两次保存定价数据。如果这会影响任何事情，我正在使用 Amazon RDS db。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T05:45:51.800

原来这是 git 跟踪的问题，我在本地删除了文件但忘记了

```
git rm oldraketask.rake 
```

它碰巧包含一个与我正在运行的同名的 rake 任务，因此 heroku 连续运行两个 rake 任务，第一个是新的，然后是旧文件中的一个仍然在 heroku 的服务器上。

# javascript - 强制音乐在浏览器中播放

> ID：13080808
> 
> 赞同：1
> 
> 时间：2012-10-26T04:37:11.973
> 
> 标签：javascript, html, audio, browser

在此网站：emuspin.com，创建者会在页面加载时自动播放音频文件。我尝试使用音频 html 标记来执行此操作，但几乎总是提示用户是否要下载文件或允许它播放，经过大量搜索后，我找不到强制播放此音频的作者源代码自动地。有谁知道他可能用什么来强制音频文件在用户的浏览器中自动播放？

编辑：只是为了指定，我正在制作一个书签，这就是为什么我需要在用户无需单击“接受”按钮或类似的东西的情况下进行播放，该程序对您当前所在的网页进行处理当你点击它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T04:56:17.210

```
<audio autoplay src="http://www.quackit.com/music/good_enough.mp3">
<p>If you are reading this, it is because your browser does not support the audio element.</p>
</audio>​ 
```

显然根据自己的喜好编辑 src 属性

我还想指出，自动播放会惹恼用户并且可能会阻止产生流量。

# ruby-on-rails - 回形针投递箱 gem 抛出错误的参数类型

> ID：13080809
> 
> 赞同：-1
> 
> 时间：2012-10-26T04:38:00.957
> 
> 标签：ruby-on-rails, ruby, rubygems

我正在尝试在[这里](https://github.com/janko-m/paperclip-dropbox/blob/master/README.md)使用回形针保管箱 gem ，但我在设置和传递我的凭据时遇到了问题。

在文档中，模型中的设置是这样完成的：

```
class User < ActiveRecord::Base
  has_attached_file :avatar,
   :storage => :dropbox,
   :dropbox_credentials => "#{Rails.root}/config/dropbox.yml",
   :dropbox_options => {...}
end 
```

我已经配置了我的 dropbox.yml 文件并将其放入 /config 文件夹，但 rails 告诉我该文件或目录不存在。

如果我使用环境变量在哈希中传递我的凭据，

```
:dropbox_credentials => {
                  app_key: ENV["DROPBOX_APP_KEY"],
                  app_secret: ENV["DROPBOX_APP_SECRET"],
                  access_token: ENV["DROPBOX_ACCESS_TOKEN"],
                  access_token_secret: ENV["DROPBOX_ACCESS_TOKEN_SECRET"],
                  user_id: ENV["DROPBOX_USER_ID"]
                }
:dropbox_options => {
                  :path => ":attachment/:id/:basename.:extension"
                } 
```

堆栈跟踪的顶部是：

```
paperclip-dropbox (1.0.0) lib/paperclip/storage/dropbox.rb:59:in `path_for_url'
paperclip-dropbox (1.0.0) lib/paperclip/storage/dropbox.rb:55:in `path'
paperclip-dropbox (1.0.0) lib/paperclip/storage/dropbox.rb:41:in `exists?'
paperclip (3.2.0) lib/paperclip/attachment.rb:436:in `block in queue_all_for_delete'
paperclip (3.2.0) lib/paperclip/attachment.rb:435:in `map'
paperclip (3.2.0) lib/paperclip/attachment.rb:435:in `queue_all_for_delete'
paperclip (3.2.0) lib/paperclip/attachment.rb:213:in `clear'
paperclip (3.2.0) lib/paperclip/attachment.rb:94:in `assign'
paperclip (3.2.0) lib/paperclip.rb:196:in `block in has_attached_file'
activerecord (3.2.6) lib/active_record/attribute_assignment.rb:85:in `block in       assign_attributes'
activerecord (3.2.6) lib/active_record/attribute_assignment.rb:78:in `each'
activerecord (3.2.6) lib/active_record/attribute_assignment.rb:78:in `assign_attributes'
activerecord (3.2.6) lib/active_record/persistence.rb:212:in `block in   update_attributes'
activerecord (3.2.6) lib/active_record/transactions.rb:295:in `block in   with_transaction_returning_status'
activerecord (3.2.6)  lib/active_record/connection_adapters/abstract/database_statements.rb:192:in `transaction'
activerecord (3.2.6) lib/active_record/transactions.rb:208:in `transaction'
activerecord (3.2.6) lib/active_record/transactions.rb:293:in  `with_transaction_returning_status'
activerecord (3.2.6) lib/active_record/persistence.rb:211:in `update_attributes'
app/controllers/users_controller.rb:45:in `update' 
```

然后 rails 说“错误的参数类型字符串预期 Proc”

我是 ruby​​ 新手，不太了解 procs。我该如何解决这个问题才能让它工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T20:53:37.960

根据自述文件，paperclip-dropbox 需要路径的 proc。你的路径中的参数是否`:avatar`意味着什么，或者这意味着是一个静态部分？

我认为你需要尝试这样的事情：

```
:path => proc { |style| "avatars/#{id}/#{style}/#{avatar.original_filename}" } 
```

您也可以在没有`|style|`变量的情况下尝试它，但您可能会收到错误数量的参数错误。通常，您会定义其他样式以自动将图像缩放到您网站上所需的尺寸 - 查看[文档](https://github.com/janko-m/paperclip-dropbox/blob/master/README.md)以获取更多信息。

# c# - 性能方面将 xml 数据发送到 c# 中的 php 文件的最佳方法

> ID：13080813
> 
> 赞同：0
> 
> 时间：2012-10-26T04:38:18.257
> 
> 标签：c#, php, xml

我有一个 XML 文件，我希望它发送 php 页面以将其写入 mysql 数据库。

例如，我有一个名为的类`data`，它的属性很少。然后将这些对象值作为 xml 文件保存在本地缓存中，如下所示：

```
<data>
   <value1></value1>
   <value2></value2>
   ..........
</data> 
```

所以我想将这些数据发送到 mysql 数据库。我的服务器端使用 php，我是 php 新手。那么发送这些数据的最佳方式是什么。

1.  通过访问数据对象（c#）将这些值作为参数发送

> 字符串数据 = "&value1=" + d.value1+"&value2="+ d.value2 ........；

2\. 将xml文件直接发送到php页面，在php文件中读取xml文件并获取所需数据

发送这些数据的最佳方式是什么？（性能方面）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-27T04:47:52.430

答案很可能是“视情况而定”。

1.  您的 XML 结构有多复杂，在服务器端 (PHP) 解析它有多容易？如果 XML 本身比较简单，并且参数的数量不太可能大幅增加，您可以考虑将它们作为 URL 的一部分发送。但是，如果 XML 将发生变化并变得更加复杂，那么您最终可能会不断发明使用这种方法将 XML 转换为 URL 参数的自行车。

2.  将 XML 直接发送到服务器端可能更容易，因为您不需要将 XML 转换为 URL 参数。此外，您不需要关心您的 XML 有多大，而您需要使用 URL 查询参数 - URL 不应超过[2083 个符号](http://www.google.com/search?q=URL%202083%20symbol&oq=URL%202083%20symbol&sugexp=chrome,mod=0&sourceid=chrome&ie=UTF-8)。

此外，如果您使用 URL 参数方法，请注意字符串连接 - 您需要转义数据值，例如使用[Uri.EscapeDataString](http://msdn.microsoft.com/en-us/library/system.uri.escapedatastring.aspx)方法。

性能方面，需要考虑三个方面：

1.  如果没有太多的 URI 转义并且参数的值相当小（即主要是数字/ASCII 字符），则由于使用 HTTP GET 而不是 HTTP POST 和要传输的数据量较少，参数可能会传输得更快。然而，传输收益将被将 XML 转换为参数的成本所抵消，尽管对于小型 XML 来说可以忽略不计。

2.  如果 XML 结构复杂并且数据中的值是任意长度的，那么它到 URL 参数的转换可能证明是低效的，在某些情况下甚至是不可能的。如果您最终使用 HTTP POST 而不是 HTTP GET，那么转换为参数是否有意义是非常值得怀疑的。

3.  在服务器端解析 XML 可能比解析 URL 参数慢。然而，这是有问题的，需要适当的测量。

最后，可能建议您考虑一下——为什么在开发的这个阶段您对性能的这种低级方面感兴趣？您是否有一些性能问题并发现瓶颈在于那个小细节？请[在此处查看 Eric Lippert 关于性能的出色文章](http://blogs.msdn.com/b/ericlippert/archive/2003/10/17/53237.aspx)。您最好继续使用最直接的解决方案（即最容易编码和维护）并稍后测量性能问题。

# javascript - jQuery - 2 个伪选择器？

> ID：13080814
> 
> 赞同：9
> 
> 时间：2012-10-26T04:38:19.873
> 
> 标签：javascript, jquery, css, jquery-selectors, css-selectors

> **可能重复：**
> [结合 jQuery :not 和 :nth-child 选择器](https://stackoverflow.com/questions/10510128/combining-jquery-not-and-nth-child-selectors)

这可能吗？

这是我的代码：

```
$("ul#filterlist li:nth-child(3n)").css("marginTop", "0"); 
```

如果我想将其应用于列表，但仅应用于列表中可见的那些项目（有些被隐藏，我不希望它们被计算在内），它将如何实现？我在想类似的事情：

```
$("ul#filterlist li:nth-child(3n)").not(":hidden").css("marginTop", "0"); 
```

但它不会起作用。我也不会尝试任何东西：可见

有任何想法吗？谢谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-26T04:43:55.807

您正在寻找的方法是`filter()`. 它将根据给定的选择器过滤掉一个 jQuery 对象列表。由于找不到“非`:hidden`”选择器，我使用了相反的`:visible`.

```
$("ul#filterlist li:nth-child(3n)").filter(":visible").css("marginTop", "0"); 
```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T08:56:43.177

如果您不想计算隐藏元素，可以尝试使用以下代码。

```
$("ul#filterlist li:visible").filter(function(index){ 
    return (index+1)%3 == 0?true:false;
}).css("marginTop", "0"); 
```

[在此处](http://jsfiddle.net/R8HQY/)查看 jsfiddle 中的示例

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-26T04:47:12.773

尝试链接：选择器

```
$("ul#filterlist li:nth-child(3n):not(:hidden)").css("marginTop", "0"); 
```

如这个答案所示：

[jQuery - 多个 :not 选择器](https://stackoverflow.com/questions/7144976/jquery-multiple-not-selector)

# java - 如何使用 java 在 oracle 中插入自定义日期时间？

> ID：13080818
> 
> 赞同：0
> 
> 时间：2012-10-26T04:38:27.613
> 
> 标签：java, oracle, date

嗨，我有一列（键入日期）。我想插入自定义日期和时间而不使用**Preparedstatement**。我使用过

```
String date = sf.format(Calendar.getInstance().getTime());
String query = "Insert into entryTbl(name, joinedDate, ..etc)  values ("abc", to_date(date, 'yyyy/mm/dd HH:mm:ss'))";
statement.executeUpdate(query); 
```

但我得到**文字不匹配**错误。所以甚至尝试使用**“SYSDATE”**。它只插入日期而不是时间。那么如何使用java将日期时间插入oracle？请任何人帮助..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T04:44:29.437

强烈建议用于`PreparedStatement`对抗潜在的 SQL 注入攻击，而不是构建原始 SQL 查询来与数据库交互。

也就是说，您也可以将日期列的值指定为`yyyy-MM-dd HH:mm:ss`格式中的字符串：

```
SimpleDateFormat sf = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
String date = sf.format(Calendar.getInstance().getTime());
String query = "INSERT INTO entryTbl(name, joinedDate, ..etc.,)  values ('abc', '" 
    + date + "', ...etc.,)";
statement.executeUpdate(query); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T04:45:19.997

我认为`yyyy/mm/dd HH:mm:ss`应该更新为 :`YYYY/MM/DD HH:MI:SS TZH:TZM`并在此处使用`to_timestamp`--[文档](http://docs.oracle.com/cd/B19306_01/server.102/b14200/functions194.htm)

```
 String query = "INSERT INTO entryTbl(name, joinedDate, ..etc.,) "+
           "values ('abc', "+
           "TO_TIMESTAMP('"+dateString+"', 'YYYY/MM/DD HH:MI:SS TZH:TZM'), etc.,)"; 
```

# c++ - C++ API DLL 项目

> ID：13080821
> 
> 赞同：0
> 
> 时间：2012-10-26T04:39:06.513
> 
> 标签：c++, winforms, api, winapi, dll

我有一个 C++ 项目，它使用 DLL 和 LIB 文件以及头文件附带的 API。我想创建一个 win32 表单项目。

我的问题是如何将项目与 dll 和 lib 文件链接起来。

但主要问题是，我如何订阅事件？在 API 中，我可以调用函数，这些函数在事件响应中返回，在 MFC 项目中我通常会在消息循环中订阅。但是在 Win32 中没有消息循环。

也许我自己把情况复杂化了，这比我想象的要容易。请为我澄清这种情况。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T04:46:45.783

当有人问多个问题时，总是很难回答......对于您的“主要问题”，请显示相关的 API 调用以订阅事件。你错了Win32中没有消息循环......只是没有*MFC*消息循环。

我现在正在回答一个简单的问题......“你如何链接 DLL”。我有点假设您使用的是 Visual Studio。那是对的吗？当我赶时间时，我这样做的方式是这样的：

```
#include "mylib.h"
#pragma comment(lib, "mylib.lib") 
```

这里的所有都是它的。当然我想要标题，但是当我在它的时候我告诉编译器也链接库。

我似乎还记得其他时候我只是将库文件拖到项目的解决方案视图中，有效地将其添加为源。这也有效。

漫长的方法是编辑您的项目设置，转到**链接器**部分，然后在**输入**子部分下，将您的库添加到**附加依赖**项列表中。您需要对所有配置执行此操作。有一些方法可以正确地维护它，但我不会在这里讨论。

如果您没有使用 Visual Studio，请忽略我的回答。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T04:48:29.377

您不能将项目与 dll 文件链接，您可以将项目与 lib 文件链接，您可以在项目设置对话框（链接器）中添加 lib 文件名

或者，您将其添加到您的代码中

```
#pragma comment(lib,"xxxx.lib") 
```

DLL 文件将在运行时加载。

对于消息循环，请参阅[http://msdn.microsoft.com/en-us/library/windows/desktop/ms644928(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644928(v=vs.85).aspx)

或者这个： http: [//msdn.microsoft.com/en-us/library/windows/desktop/ms644996 (v=vs.85).aspx#modeless_box](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644996(v=vs.85).aspx#modeless_box)

# android - OnActivityResult 在 Android 中总是返回 null Intent 数据

> ID：13080824
> 
> 赞同：1
> 
> 时间：2012-10-26T04:39:11.860
> 
> 标签：android

在我的项目中，我显示了联系人屏幕，当我单击任何联系人时，它应该返回到我需要显示所选联系人的虚拟屏幕。

现在的问题是当我从我的项目联系人列表中单击并选择联系人时，它总是出现在我的虚拟项目屏幕上，但数据总是为空。不明白为什么它为空。在我显示联系屏幕的项目中，我们遵循了很多路径。

> 1 HomeActivity->TabActivity->HomeTabFragment->BuddyFragment（用于显示联系人屏幕）

在好友片段中，我编写了以下代码：

```
 Intent intent = new Intent();

 intent.putExtra("chaton_buddy_number", buddy.getNo());
 intent.putExtra("chaton_buddy_name", buddy.getName());

 getActivity().setResult(Activity.RESULT_OK, intent);

 getActivity().finish();
 return true; 
```

在 dummyApplication 我写了以下代码。

```
public class MainActivity extends Activity { 
TextView tv; 

@Override 
public void onCreate(Bundle savedInstanceState) { 
super.onCreate(savedInstanceState); 
setContentView(R.layout.activity_main); 
tv = (TextView)findViewById(R.id.textView1); 
Button button =(Button)findViewById(R.id.button1); 
button.setOnClickListener(new Button.OnClickListener() {

         @Override
         public void onClick(View v) {
              Intent intent = new Intent();
              intent.setAction(Intent.ACTION_SEND);
              intent.putExtra("mChatONBuddies", true);

    //Launching HomeActivity of my project because that one is the first activity. 
    //intent.setComponent(new ComponentName("com.sec.myproject", "com.sec.chaton.HomeActivity"));

            startActivityForResult(intent, 0);
        }
    });
} 
```

意图（数据）总是出现在我的虚拟项目屏幕上。

我尝试了以下事情，但没有帮助我。

1.  打电话`getParent().getAcitivity().setResult(Activity_ResultOK, intent)`
2.  删除了`Intent.FLAG_ACTIVITY_CLEAR_TOP | Intent.FLAG_ACTIVITY_SINGLE_TOP`它使用的地方。它也不起作用

任何其他建议都将受到高度赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T05:05:35.007

在进行此类回调时，我很喜欢界面

如果您希望您的片段应该将数据传递回其包含的活动，那么请考虑使用接口来处理和传递数据。

步骤1

**在您的片段中声明以下接口**

```
public interface iContactHelper {
    public void onSelectContact(String contactNumber,String contactName);
} 
```

第2步

****在您的 Fragment 中声明以下内容。****

 **```
iContactHelper icontactHelper;

@Override
public void onAttach(Activity a) {
    super.onAttach(a);
    icontactHelper = (icontactHelper) a;
} 
```

第三步

**当您需要将联系信息发送到容器活动时，请致电以下。**

```
iContactHelper.onSelectContact(buddy.getNo(),buddy.getName()); 
```

第4步

**最后让您的容器活动实现 iContactHelper 接口**

```
@Override
public void onSelectContact(String contactNumber,String contactName) {
    Log.d("LOG","Contact Name " + contactName);
    Log.d("LOG","Contact Number " + contactNumber);
} 
```**

# javascript - 如何提高 IE8 中 javascript 功能测试的性能？

> ID：13080829
> 
> 赞同：1
> 
> 时间：2012-10-26T04:40:04.877
> 
> 标签：javascript, jquery, functional-testing

当我在 IE8 中运行功能测试时，我在 IE 分析器中获得功能，这需要更多时间，所以我如何提高功能测试的性能。这是最耗时的功能。

```
poller,
_open ,                          
class,
document loaded,
check for new document,
js script-window script block,
filter,
function.call,
sizzle,
function.apply,
init,
method,
find,
process,
run,
funcunit,
perform sync query, 
```

测试是这样的

```
module("test#009 - logo for legacy",{
   set up:function(){
   s.open("/demo/documentation/details/10");}
});

test("logo" ,function(){
   s("div.ui-pagelogo:eq(0)").exists function(){
   ok(true,"div with classname ui-pagelogo exists");
});

s("div.ui-pagelogo:eq(0)>a").exists(function(){
   ok(true,"dive.ui-pagelogo containing anchor tag exists");
});
s(div.ui-pagelogo:eq(0)>a").attr("href","http://www.google.com").existsfunction(){
  ok(true,"anchor tag exist with href attribut(e");
});
s(div.ui-pagelogo:eq(0)>a").attr("title","symbol of unity").existsfunction(){
  ok(true,"anchor tag exist with title attribute");
}); 
```

# c# - 有没有一种自动化的方法来捕捉财产自我分配？

> ID：13080833
> 
> 赞同：26
> 
> 时间：2012-10-26T04:40:21.573
> 
> 标签：c#

考虑以下代码：

```
class C
{
    public int A { get; set; }
    public int B;

    public C(int a, int b)
    {
        this.A = A;    // Oops, bug! Should be `this.A = a`. No warning
        this.B = B;    // Oops, bug! Should be `this.B = b`. `warning CS1717: Assignment made to same variable; did you mean to assign something else?`
    }
} 
```

`A`并且`B`几乎完全相同，但是有一个我会错过的错误。

有没有办法在编译时捕获第一个案例？

**编辑：**一些答案和评论想向我解释属性和字段不是一回事。我已经知道了。他们解释了为什么编译器在这里没有警告；我明白了。但是我写了一个bug，我不喜欢写bug。所以我的问题是“**我怎样才能确保我永远不会再写这个错误？** ”

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-26T05:44:51.060

您可能会使用 FxCop 等工具并使用 VisitAssignmentStatement 编写自定义规则：
一些示例：
[Example1](http://www.binarycoder.net/fxcop/html/check_and_visit.html)
[Example2](http://social.msdn.microsoft.com/Forums/en-US/vstscode/thread/1175d46d-00eb-42e5-b944-b031a95c94a5/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-29T08:37:25.430

你说的`A = A`和`B = B`是一样的，但事实并非如此！您可以在属性的 getter 和 setter 中进行更改，以便`A = A`可以更改变量，如下例所示：

```
public Int32 A
{
    get { return _A++; }
    set { _A = value; }
} 
```

所以编译器不知道这是否是一个错误。当然我会避免这种情况，因为使用这样的代码并不容易（例如，如果你只有一个程序集并且不知道为什么 A 每次都在改变）并且我会避免暴露这样一个属性的显式设置器并喜欢以下内容：

```
public UInt32 UniqueID { get { _UniqueID++; } }

public void Reset()
{
    _UniqueID = 0;
} 
```

### 结论

编译时错误在这里没有任何意义，因为编译器不知道属性中发生了什么（请记住：**属性只是两个方法的简化，`set_MyProperty`和`get_MyProperty`**），如果属性发生变化（例如通过虚拟）行为也可能改变。

## （编辑）避免误导性命名

我以与您相同的方式编写属性和参数。因此，作为一个简单类的外观示例：

```
public class MyClass
{
    public Int32 Sample { get; private set; }

    public MyClass(Int32 sample)
    {
        Sample = sample;
    }
} 
```

我每周大约 1 次像你一样陷入同样的​​陷阱，所以我从没想过改变命名。但是有一些你可以使用的建议：

*   使用`p`（参数）作为前缀，但这是我不推荐的，因为它使代码不可读恕我直言。
*   用作`value`后缀，这对我来说似乎没问题。因此，`sample`您将拥有`sampleValue`与`Sample`（属性名称）不同的名称，并且应该更容易检测是否使用属性名称而不是参数名称
*   用作`_`前缀。我不会使用它，因为我已经将`_`其用作成员的前缀以启用对它们的快速访问并使智能感知看起来很奇怪恕我直言。

我认为这完全取决于您个人或公司的编码风格，但我个人会`Value`用作后缀。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-01T13:56:21.137

这不是铸铁，但如果您安装了 ReSharper 并将其对“未使用参数”的检查设置为“错误”，并进一步打开其解决方案范围分析，您将在代码窗口中看到：

![在此处输入图像描述](../Images/50abaf0613bfdc83dca3c06e6bf3bff5.png)

这些红色指示器之一在右边距中：

![在此处输入图像描述](../Images/6b422a257e44ecac25d56e5a7a049261.png)

这在状态栏中：

![在此处输入图像描述](../Images/72ff93ec6cc4a6fdcb1d1d3c6ec0d60b.png)

作为 ReSharper 用户，您很快就会无法忽视它们的组合：)

不过，不会阻止你编译。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-11-01T16:57:10.913

杰伊，

一个很好的问题。我相信大多数相关点都已在各种回复中涵盖，但只是总结一下：

1.  没有办法隐式处理这个问题。.Net 编译器允许递归属性，这是这个问题的核心（就无法“捕获”它而言）。请注意，根据[这个问题](https://stackoverflow.com/questions/2336847/why-doesnt-the-c-sharp-compiler-stop-properties-from-referring-to-themselves)，这不太可能改变。
2.  因此，如果您想强制捕获此“错误”，则需要通过 3rd 方工具明确执行此操作。我和许多其他人一样是 ReSharper 粉丝，这使我们能够在必要时突出显示属性递归。同样正如其他人所提到的，使用 FXCop 以及有效的单元测试模式也将帮助您防止出现此类错误。
3.  命名约定为王。通过提供一个故意“无用”（！）变量和属性命名的示例，您已经准确地强调了为什么我们都应该使用有效的命名约定。您强调的问题已经引起了我们所有人的注意，并且随着代码库的增长而变得更加普遍。

虽然可能不是您想要的答案，但我认为＃3 是这里最重要的一点。正确命名项目是唯一最有效的解决方案。不仅如此，人们可能没有奢侈的依赖 ReSharper 和其他此类工具。

为此，我还推荐[StyleCop](http://stylecop.codeplex.com/)。它可能有点侵入性，但它是帮助开发人员或开发团队遵守一组语法约定的好工具，您会发现这些约定将很快消除诸如您突出显示的错误之类的错误。

快乐编码！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-11-02T20:50:02.983

除了上述所有答案之外，您还可以在项目属性中的构建选项卡下，启用“将警告视为错误”，只输入特定的警告。如果您使用的是命令行编译器，请使用：

csc /warnaserror C.cs

csc /warnaserror:1717 C.cs

来自文档：http: [//msdn.microsoft.com/en-us/library/406xhdz3.aspx](http://msdn.microsoft.com/en-us/library/406xhdz3.aspx)

这将使您的构建在所有警告或您指定的警告上失败。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-10-31T05:37:24.820

无序：

1.  使用 VB.NET

2.  单元测试您的代码。

3.  使用 ReSharper 并接受提示“Qualifer 'this' 是多余的” - 然后查找警告：`Assignment made to same variable; did you mean to assign something else?`

4.  我看到了 FxCop 的建议，并认为[使用自省的自定义代码分析规则](http://blog.tatham.oddie.com.au/2010/01/06/custom-code-analysis-rules-in-vs2010-and-how-to-make-them-run-in-fxcop-and-vs2008-too/)值得一提。

5.  使用更好的变量名称来识别参数与成员。这个技巧当然不是高科技。我经常在条件语句中将变量与常量、数字或函数的返回值进行比较。虽然有点难读，但我习惯将不能用作左值的操作数放在 == 运算符的左侧，忘记在 == 运算符中键入第二个等号将导致（非常明显的）编译器错误（五秒钟的修复），而不是稍后必须追踪逻辑错误（五分钟的修复）。我觉得这一点与刚刚让你一头雾水的非常小的语法错误有关。

**许多 C# 开发人员声明一个与类型名称相同的变量，除了第一个字母小写。这种做法可能是您希望改变的。**

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-10-29T08:59:26.667

为什么自分配字段`this.B = B;`是错误的？因为它什么都不做。`this.B`并且`B`是完全相同的东西。

为什么自分配财产`this.A = A;`没有错？因为 of 的含义`A`取决于`=`它所在的运算符的哪一侧。考虑编译器如何看待这段代码：

```
set_A(get_A()); 
```

这是两种不同方法的调用。如果你打电话给你，你认为这是一个警告`Foo(Bar());`吗？编译器也不行。在 getter 中更改后备存储并不好，但要考虑属性，在其中计算读数的数量，或进行一些日志记录，或放置任何其他逻辑。为什么编译器会警告你这个？

```
public int A
{
    get 
    {
       _log.Debug("Property A accessed by some user");
       _readingsCount++;
       // your logic goes here
       return _a;
    }    
} 
```

# yii - 如何在我有基于 jqrelcopy 的其他表的字段的主服务器中添加 Ajax 验证？

> ID：13080840
> 
> 赞同：0
> 
> 时间：2012-10-26T04:41:12.080
> 
> 标签：yii, yii-extensions

> > 在母版页（_form）中，我想保存三个字段
> 
> 1.  落下
> 2.  文本框
> 3.  选项列表，如果选择了选项列表中的某个选项，我需要出现一个 JQrelcopy，并且用户可以使用 JQrelcopy 添加许多值。存储在 JQrelcopy 中的值必须保存在其他表中。
>     
>     
>     
>     现在的问题是我想进行 AJAX 验证，例如字段不能为空，通过 JQrelcopy 插入的字段只允许使用字母字符。我想创建一个场景，但我做不到

```
<?php $form=$this->beginWidget('CActiveForm', array(  
'id'=>'symptom-form',  
'enableAjaxValidation'=>false,  
  'enableClientValidation'=>true, 
```

)); ?>

```
<?php echo $form->errorSummary($model,"Please fill up the required field in red","");?>  
<div class="row">  
    <div class="floatleft"><?php echo $form->labelEx($model,'body_system_id',   array ('id'=>'label_body_system', 'class'=>'label_name')); ?>  </div>
    <div class="floatright"><?php echo $form->dropDownList($model, 'body_system_id',    CHtml::listData(SystemMaster::model()->findAll("status != 'R'"),
                                    'id', 'system_name'),array('prompt' => ' ------------- Select ------------')); ?>  </div> 
    <?php echo $form->error($model,'body_system_id'); ?>
</div>

<div class="row">
    <div class="floatleft"><?php echo $form->labelEx($model,'symptom', array ('id'=>'label_symptom', 'class'=>'label_name')); ?></div>
    <div class="floatright"><?php echo $form->textField($model,'symptom',array('rows'=>6, 'cols'=>50)); ?></div>
    <?php echo $form->error($model,'symptom'); ?>
</div>

<div class="row">
    <div class="floatleft"><?php echo $form->labelEx($model,'symptom_type', array ('id'=>'symptom_type', 'class'=>'label_name')); ?></div>
    <div class="floatright"><?php echo $form->radioButtonList($model,'symptom_type',array('T'=>'TextBox','A'=>'TextArea', 'D'=>'DropDown', 'C'=>'CheckBox'), array("id"=>"r_list")); ?></div>
    <?php echo $form->error($model,'symptom_type'); ?>
</div>

<div class="form" id="symptom_value">
        <?php 
            $this->widget('ext.jqrelcopy.JQRelcopy',array(

            //the id of the 'Copy' link in the view, see below.
            'id' => 'copylink',

            //add a icon image tag instead of the text
            //leave empty to disable removing
            'removeText' => '<img src="images/delete.png" /><small>Delete</small>',

            //htmlOptions of the remove link

 'removeHtmlOptions' => array('style'=>'color:red;float:left;position:absolute;'),

            //options of the plugin, see http://www.andresvidal.com/labs/relcopy.html
            'options' => array(

                //A class to attach to each copy
                'copyClass'=>'newcopy',

                // The number of allowed copies. Default: 0 is unlimited
                'limit'=>0,

                //Option to clear each copies text input fields or textarea
                'clearInputs'=>true,

                //A jQuery selector used to exclude an element and its children
                //'excludeSelector'=>'.skipcopy',

                //Additional HTML to attach at the end of each copy.
                        //'append'=>CHtml::tag('span',array('class'=>'hint'),'You can remove this line'),
                'append'=>CHtml::tag('span',array('class'=>'hint'),''),
            )
            ))
        ?>

    <!-- ---------------The given codes are used to display Symptom Values if already exists ---------------->

    <div class="topHeading" id="sli_title" ><span class="label_name">Symptom Values</span></div>

     <?php 
        if (count($symptom)>0 & $flag == 'update')
        {
            ?>
            <?php
            for ($i=0; $i<count($symptom); $i++)
            {
                ?>
              <div class="row copy">

                            <?php
                            echo CHtml::Textfield('symptom_value[]', $symptom[$i] ,array('class'=>'skipcopy','style'=>'float:left; width:150px; margin-right:5px;'));?>

                            <?php if ($i>0)
                            {
                                ?>
                                <a href="#" onclick="$(this).parent().remove(); return false;" style="color: red;"><img src="images/delete.png"  align="" /><small>Delete</small></a>
                                                                <span class="hint"></span>

                            <?php 
                            } 

                            ?>

             </div> <?php  
            }
            ?>   
            <?php
        }
        else
        {
        ?>            
                        <div class="row copy">
                            <?php $i=0;
                            echo CHtml::Textfield('symptom_value[]', " " ,array('class'=>'skipcopy'));?>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                            <?php //echo $form->dropDownList($model, 'body_system_id', CHtml::listData(SystemMaster::model()->findAll("status != 'R'"),
                                  //'id', 'system_name'),array('prompt' => ' ------------- Select ------------')); ?>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                        <?php if ($i>0)
                        {
                            ?>
                            <div class="floatright"><a href="#" onclick="$(this).parent().remove(); return false;" style="color: red;"><img src="images/delete.png"  align="" /><small>Delete</small></a>
                                                            <span class="hint"></span>
                                                            </div>
                        <?php 
                        } $i++;

                        ?>

                        </div>
            <?php
        }
         ?>
            <div class="row"><div><a id="copylink" href="#" rel=".copy"> <img src="images/add.png" align="" /><small>Add Another</small></a></div></div>

                </div>

        <!-- Symptom Values -->
            <div class="row buttons">
    <div class="floatright"><?php //echo CHtml::submitButton($model->isNewRecord ? 'Save' : 'Save', array ('onClick'=>'validate()')); ?></div>
            <div class="floatright"><?php echo CHtml::submitButton($model->isNewRecord ? 'Save' : 'Save'); ?></div>
</div>
    <div class="floatright"><?php //echo CHtml::hiddenfield('Sys_val',' ' ,array ('id'=>'Sys_val')); ?></div>

<?php $this->endWidget(); ?>
</div><!-- form -->
<script>
$(document).ready(function() {
    check();

    function check()
    {

            if ($("#Symptom_symptom_type_2").prop('checked') || ($("#Symptom_symptom_type_3").prop('checked')))
            {
                $("#symptom_value").show()
            }
            else 
            {
                $("#symptom_value").hide()
            }
    }

});
if ($("#Symptom_symptom_type_2").click(function()
{
    $("#symptom_value").show()
}));

if ($("#Symptom_symptom_type_3").click(function()
{
    $("#symptom_value").show()
}));

if ($("#Symptom_symptom_type_1").click(function()
{
    $("#symptom_value").hide()
}));

if ($("#Symptom_symptom_type_0").click(function()
{
    $("#symptom_value").hide()
}));
function validate()
   {
   var body_system = document.getElementById("Symptom_body_system_id").value
   var symptom = document.getElementById("Symptom_symptom").value

   if ($("#Symptom_symptom_type_0").attr("checked") != "checked" 
      && $("#Symptom_symptom_type_1").attr("checked") != "checked" 
      && $("#Symptom_symptom_type_2").attr("checked") != "checked" 
      && $("#Symptom_symptom_type_3").attr("checked") != "checked"
      || (body_system == "" || symptom == ""))
   {
        alert("Please enter all the mandatory fields Body System , Symptom  and Symptom Type");
   }
   return;
   }
</script> 
```

# android - android NDK构建命令错误

> ID：13080842
> 
> 赞同：0
> 
> 时间：2012-10-26T04:41:15.527
> 
> 标签：android, android-ndk

这是我使用的构建命令，也是错误

```
D:\AndroidWorkSpace\CApplication>D:\android-ndk-r8b-windows\android-ndk-r8b\ndk-
build.cmd
Android NDK: Your APP_BUILD_SCRIPT points to an unknown file: ./jni/Android.mk
D:/android-ndk-r8b-windows/android-ndk-r8b/build/core/add-application.mk:133: **
* Android NDK: Aborting...    .  Stop. 
```

这是制作文件

```
LOCAL_PATH := $(call my-dir)
include $(CLEAR_VARS)
LOCAL_MODULE    := CApplication
LOCAL_SRC_FILES := ndk_demo.c
include $(BUILD_SHARED_LIBRARY) 
```

有人可以让我知道这个问题吗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-27T01:41:55.997

`ndk-build`不适用于*制作文件*。您发布的内容应该在项目目录`Android.mk`下的文件`jni`中。

正如[@Sunny 所](https://stackoverflow.com/users/941864/sunny-kumar-aditya)指出的，您运行时的*当前目录*`ndk-build`应该是您的项目根目录，即您的目录的父`jni`目录。

# apache2 - apache 2 无法在 Ubuntu 10 上启动

> ID：13080844
> 
> 赞同：0
> 
> 时间：2012-10-26T04:41:22.233
> 
> 标签：apache2, ubuntu-10.04

我是一台带有 Apache 2 虚拟主机的 Ubuntu 机器。

我无法诊断此问题，因为我的错误日志似乎没有反映问题

```
$ sudo /etc/init.d/apache2 start
* Starting web server apache2                            [fail] 

$ sudo /etc/init.d/apache2 status
Apache is NOT running. 
```

这似乎是在我编辑虚拟主机之后开始的，但我相当确定我修复了该文件，现在 Apache 不想再启动了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T13:02:53.360

感谢大家。我解决了。我的一个 apache 虚拟主机正在我重命名的目录中查找错误文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T04:42:49.163

尝试：

```
$ sudo service apache2 start 
```

# java - 更改一年的第一周

> ID：13080854
> 
> 赞同：6
> 
> 时间：2012-10-26T04:42:17.520
> 
> 标签：java, date, datetime, calendar

使用 Java 的日历或其他东西，假设我将日期设置为 2012-10-26。我希望这个日期是一年的第一天。假设一年的第一周从 2012 年 10 月 26 日开始，是否可以获得特定日期的周数 - 假设是 2012 年 12 月 10 日？

我知道我的问题听起来有点奇怪，但我可以使用任何有用的输入。

谢谢。

**- 细节**

我有一个名为*WeeklySchedule*的数据库表。在这个表中，我有从*Week1*到*Week52*的列，每一列都有一些关于该周天数的数据。不幸的是，第 1*周*实际上并不是一年中的第一周。*假设Week1*从*2012-08-26*开始，我需要进行计算。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T06:19:43.747

这是使用日历 API 的一种方法：

```
private static final Calendar START_CAL = createAugust26th2012Cal();

public int getWeekNumber(Calendar someCal) {
    int theWeek = someCal.get(Calendar.WEEK_OF_YEAR);
    int weekCount = 0;
    while (theWeek != START_CAL.get(Calendar.WEEK_OF_YEAR)) {
        someCal.add(Calendar.WEEK_OF_YEAR, -1);
        theWeek = someCal.get(Calendar.WEEK_OF_YEAR);
        weekCount++;
    }
    return weekCount;
} 
```

* * *

或者您可以获取两个日历之间的差异（以毫秒为单位），然后将结果除以一周中的毫秒数：

如果您使用这种方法，请不要忘记考虑 TimeZones 和 Daylight Saving Time。

我不记得*确切*的代码是什么样子来补偿 DST，但我认为它是这样的：（ *我不太记得是添加偏移量还是从两个操作数中减去偏移量）*

```
private static final long ONE_WEEK_MILLIS = 1000 * 60 * 60 * 24 * 7;

public int getWeeksBetween(Calendar calOne, Calendar calTwo) {
    long millisOne = calOne.getTime().getTime();
    long millisTwo = calTwo.getTime().getTime();
    long offsetOne = calOne.getTimeZone().getOffset(millisOne);
    long offsetTwo = calTwo.getTimeZone().getOffset(millisTwo);
    long diff = (millisTwo - offsetTwo) - (millisOne + offsetOne );
    return diff / ONE_WEEK_MILLIS;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T06:10:14.390

我从未见过为此的内置函数，只调用 like[`Calendar.get(WEEK_OF_YEAR)`](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Calendar.html#WEEK_OF_YEAR)或[Joda](http://joda-time.sourceforge.net/)的[`LocalDate.getWeekOfWeekyear()`](http://joda-time.sourceforge.net/apidocs/org/joda/time/LocalDate.html#getWeekOfWeekyear()). `java.util.Calendar`(and `Date`) 通常被认为是一个糟糕的图书馆，与 Joda Time 这样的图书馆相比。[这篇 SO 帖子](https://stackoverflow.com/questions/589870/should-i-use-java-date-and-time-classes-or-go-with-a-3rd-party-library-like-joda)有一个很好的优缺点列表。

请注意，如果您的数据库表适用于一年中的年复一年重复，您可能会遇到麻烦。有些年份（[每 400 年 71 年，或每 5.6 年大约 1 年](http://en.wikipedia.org/wiki/ISO_week_date)）有 53 周。

鉴于上述情况，您可能希望获得一个近似值，例如计算[两个日期之间的天](http://joda-time.sourceforge.net/apidocs/org/joda/time/Days.html)数除以 7（所有 mod 52），这将每年滑动少量，或者计算`(weekOfYear(date) - weekOfYear(startDate)) % 52`，这可能会重复日历年年初的一周。

# java - 使用 itext 转换 pdf 时遇到问题

> ID：13080859
> 
> 赞同：2
> 
> 时间：2012-10-26T04:43:06.773
> 
> 标签：java, pdf, pdf-generation, itext

这是我用于生成 PDF 的 Java 类。我正在使用 iText 生成 PDF。

```
public class pdfgen {
 public void createPdf(String inputFile, String outputFile, boolean isPictureFile)    

 {    
     Rectangle pageSize = new Rectangle(2780, 2525);    
      Document pdfDoc = new Document(pageSize); 
      String pdfFilePath = outputFile;    
      try  {
          FileOutputStream fileOutputStream = new FileOutputStream(pdfFilePath);  
          PdfWriter writer = null;    
          writer = PdfWriter.getInstance(pdfDoc, fileOutputStream);
          writer.open(); 
          pdfDoc.open();
          if (isPictureFile){
              pdfDoc.add(com.itextpdf.text.Image.getInstance(inputFile));
          }
          else{
              URL url=new URL(inputFile);
              URLConnection conn = url.openConnection();
              BufferedReader in = new BufferedReader(new InputStreamReader(conn.getInputStream()));
              String line; while ((line = in.readLine()) !=null ) {
                  System.out.println(line);
              }
              System.out.println(inputFile);
              in.close(); 
              File file = new File(inputFile);
              pdfDoc.add(new  Paragraph(org.apache.commons.io.FileUtils.readFileToString(file)));

          }
          pdfDoc.close();
          writer.close();
      }catch(DocumentException e){
          System.err.println("The error has occured in the document");
      }catch(FileNotFoundException e){
          System.err.println("Your file is not found.");
      }
      catch(Exception e){
          System.err.println("Exception: "+e);
      }
 }

} 
```

这是我在其中调用上述类的 JSP 文件

```
<%@ page language="java" contentType="text/html; charset=ISO-8859-1" pageEncoding="ISO-8859-1"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<%@ page import="java.util.Vector"  %>
<%@page import="com.dalkin.pdfgen" %>
<% Vector result=(Vector)request.getAttribute("val");%>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Output </title>
</head>
<body>

<%Vector names; %>
<%if(arrcol.size()!=0){  %>
            <div style="width:1024px;">
            <table cellpadding="5" cellspacing="5">

            <tr>                

            <td>
            <%for(int q=0;q<result.size();q+=3){ %>
            <div style="background:url(sample.gif) no-repeat; height:320px; width:500px; float:left;">
            <input type="text" size="50" value=<%=result.get(q) %>>
            <input type="text" size="50" value=  <%=result.get((q+1))%>>    
            <input type="text" size="50" value=<%=result.get((q+2))%>>              
            </div>

            <%}} %>                 
            </td>
            </tr>

</table>
</div>

<%pdfgen pf = new pdfgen();  
pf.createPdf("http://localhost:8080/New/FirstServlet","D:\\first.pdf",false);%>  

</body>
</html> 
```

当我运行程序时，我得到了`FileNotFoundException "http://localhost:8080/New/FirstServlet" Your file is not found.` 谁能帮助我在哪里做错了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T07:04:50.053

你这样调用你的PDF创建方法

```
pf.createPdf("http://localhost:8080/New/FirstServlet","D:\\first.pdf",false); 
```

在该方法中，您使用第一个参数（名为 inputFile），如下所示：

```
File file = new File(inputFile); 
```

“http://localhost:8080/New/FirstServlet” 没有文件，所以

```
FileUtils.readFileToString(file) 
```

一定会失败，但你得到的例外。

在你做之前的代码中

```
URL url=new URL(inputFile);
URLConnection conn = url.openConnection();
BufferedReader in = new BufferedReader(new InputStreamReader(conn.getInputStream())); 
```

然后使用 line = in.readLine() 遍历这些行。除了打印这些行之外，您还可以将这些行附加到一些 StringBuilder 并使用内置的 String

```
pdfDoc.add(new  Paragraph(...)); 
```

# soapui - 不同测试用例的持有对象

> ID：13080860
> 
> 赞同：0
> 
> 时间：2012-10-26T04:43:17.350
> 
> 标签：soapui

考虑我在第一个测试用例中有两个测试用例我使用 Groovy 创建了一个数组现在我想在第二个测试用例中使用相同的数组。有任何方法可以做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T11:30:52.513

您可以创建一个 dataGen 并在 dataGen 中创建数组。

创建测试套件 > 测试用例 > DataGen 步骤如下

通过双击左侧菜单打开 DataGen 编辑器

然后，单击 + 按钮添加新属性并选择“脚本”

现在您可以使用 groovy 脚本创建变量。

# c# - 如何在 C# 中检查给定字符串是否为十进制？

> ID：13080870
> 
> 赞同：-3
> 
> 时间：2012-10-26T04:44:41.167
> 
> 标签：c#, decimal, tryparse

我已经用字符串值完成了这个，比如 `65.34, 65,45, 34.45`

一切都返回 True ...

```
public void test()
{
   string value = "65" 0r "65.0" 0r "1,234.54";
   decimal number;

   if (Decimal.TryParse(value, out number))
      MessageBox.Show(value);
   else
      MessageBox.Show("Unable to parse '{0}'.", value);
 } 
```

这一切都返回它的十进制..

```
 If I type "0.65" .. I need to show error and it i type "65" it has to be exectued. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T05:25:51.413

你有两个选择

1.使用正则[表达式](https://stackoverflow.com/questions/2811031/decimal-or-numeric-values-in-regular-expression-validation)

或者

2.使用以下方法求小数位数

```
 static decimal CountDigitsAfterDecimalPoint(decimal decimalNumber)
        {
            int[] bits = Decimal.GetBits(decimalNumber);
            int exponent = bits[3] >> 16;
            int result = exponent;
            long lowDecimal = bits[0] | (bits[1] >> 8);
            while ((lowDecimal % 10) == 0)
            {
                result--;
                lowDecimal /= 10;
            }

            return result;
        } 
```

# mysql - 如何为 oracle 编写自己的 timestampdiff 函数

> ID：13080872
> 
> 赞同：3
> 
> 时间：2012-10-26T04:45:15.867
> 
> 标签：mysql, oracle, oracle11g

我正在尝试编写自己的 timestampdiff(DAY, first_date ,second_date) 函数，该函数与 MySql tumestampdiff 函数相同。

但我无法理解第一个参数的数据类型是什么，以便它可以接受关键字日、月或年。

需要专家评论，因为函数参数中这是哪种数据类型？

其次，我在哪里可以看到 mysql 内置函数的实现。

好的要增加清晰度：

我有一个查询`select * from application a where timestampdiff(DAY,a.created_date, CURRENT_TIMESTAMP(3)) >= 30;`

我希望上面的查询应该在 oracle 和 mysql 中运行。

希望你明白我的意思。我想在 oracle 中编写相同的函数，这样我就不必做任何代码更改，并且两个数据库都支持它。

现在在上面我无法确定我是否要编写函数应该是第一个参数类型。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T09:57:39.270

我认为您不需要编写自己的`timestampdiff`函数，因为 oracle 已经有一个：[EXTRACT](http://docs.oracle.com/cd/B19306_01/server.102/b14200/functions050.htm)

```
EXTRACT(DAY from (first_date - second_date)) 
```

如果出于某种原因，您确实想这样做，那么我认为没有`datatype`“日期字段”关键字（年、月、日等）。
但由于它是一个有限集，你可以得到 a`VARCHAR2`并在你的代码中有一些`if`语句......

# java - jeditor 窗格的打印

> ID：13080875
> 
> 赞同：1
> 
> 时间：2012-10-26T04:45:36.100
> 
> 标签：java, swing, printing, awt, jeditorpane

在摇摆中，我有一个带有 JScrollPane 的组件 JEditorPane 我想从 jeditorpane 的内容中打印出来。而且我应该可以灵活地在运行时更改打印页面的标题。我正在使用以下代码，但它不起作用

```
 try{
  JEditorPane editorpane1= new JEditorPane();
  editorpane1.setContentType("text/html");
  editorpane1.setEditable(false);
  File file1= new File("path of the html file");
  URL url= new URL(file1);
  editorpane1.setPage(url);
  JScrollPane jsp= new JScrollPane(editorpane1);
  editorpane1.print();
  }
 catch(Exception ex)
 {

  } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T05:55:33.050

您可以使用编辑器套件独立打印机[http://java-sl.com/JEditorPanePrinter.html](http://java-sl.com/JEditorPanePrinter.html)

要添加页眉，只需修改根视图的 paint() 方法，在上面添加您的内容。

# javascript - AngularJS 服务未在 save() 方法上调用错误回调

> ID：13080877
> 
> 赞同：9
> 
> 时间：2012-10-26T04:46:06.463
> 
> 标签：javascript, rest, angularjs

所以我正在使用 angularjs restful service $resource 并且我正在调用 $save 函数。但是，我传递给它的错误回调没有被调用。服务器正在发送一个 418 错误，我认为它不是 200 会导致调用错误回调。但是，它永远不会。我找不到任何说明哪些 http 错误代码将导致调用错误回调的文档。

这是我的代码：

```
var modalScope = $scope.$new();
modalScope.showPassword = false;
modalScope.message = null;
modalScope.user = new User();

modalScope.submit = function(user) {
    user.$save( {}, function(data,headers) {
        // do the success case
    }, function(data,headers) {
        // do the error case                
    });
}; 
```

modalScope.user 被传递给定义的提交函数。那么为什么没有调用这个错误回调的问题是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-26T08:44:51.750

我在 ngResource 源代码中找到了以下内容

```
$http({method: 'GET', url: '/someUrl'}).
    success(function(data, status, headers, config) {
        // this callback will be called asynchronously
        // when the response is available
    }).
    error(function(data, status, headers, config) {
        // called asynchronously if an error occurs
        // or server returns response with status
        // code outside of the <200, 400) range
    }); 
```

我对范围表示法有点困惑，但似乎它实际上应该调用错误方法。也许你发现了一个错误。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-11-13T12:49:08.103

有同样的问题，这里没有任何工作。原来我有一个自定义调试拦截器，它没有明确返回 $q.reject(response)。

显然，每个自定义调试拦截器都会完全覆盖默认行为。

有关我在哪里找到答案，请参阅[https://github.com/angular/angular.js/issues/2609#issuecomment-44452795 。](https://github.com/angular/angular.js/issues/2609#issuecomment-44452795)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-27T12:56:21.773

我也遇到了错误回调的问题，但似乎在更新版本的 AngularJS 中，错误回调方法现在必须像这样实现：

```
SomeResource.query({}, angular.noop, function(response){
  $scope.status = response.status; 
}); 
```

来源+更详细的描述：[https ://groups.google.com/d/msg/angular/3Q-Ip95GViI/at8cF5LsMHwJ](https://groups.google.com/d/msg/angular/3Q-Ip95GViI/at8cF5LsMHwJ)

此外，针对 Flek 帖子的评论，现在似乎只有 200 到 300 之间的响应不被视为错误。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-05-24T19:40:49.397

我无法得到 Alter 的工作答案，但这对我有用：

```
user.$save(function (user, headers) {
                    // Success
                    console.log("$save success " + JSON.stringify(user));
                }, function (error) {
                    // failure
                    console.log("$save failed " + JSON.stringify(error))
                }); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-02-25T00:49:50.973

我从[ngResource 文档](http://docs.angularjs.org/api/ngResource/service/$resource)中复制：

> 可以使用以下参数调用类对象或实例对象上的操作方法：
> 
> *   HTTP GET“类”操作：Resource.action([parameters], [success], [error])
> *   非 GET “类”操作：Resource.action([parameters], postData, [success], [error])
> *   非 GET 实例操作：instance.$action([parameters], [success], [error])
> 
> 使用 (value, responseHeaders) 参数调用成功回调。使用 (httpResponse) 参数调用错误回调。

`$save`被视为非 GET “类”操作，因此您必须使用额外的`postData`参数。使用相同的问题示例，这应该有效：

```
modalScope.submit = function(user) {
    user.$save( {}, {}, function(data,headers) {
        // do the success case
    }, function(response) {
        // do the error case                
    });
}; 
```

注意错误回调，与示例相比，仅使用一个参数进行调用，这会带来所有 http 响应。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2015-08-27T05:05:39.720

实际上，如果我们遵循文档。有用

```
 User.save(vm.user, function (response) {
              FlashService.Success('Registration successful', true);
              $location.path('/login');
      },
      function (response) {

          FlashService.Error(response.data);
          vm.dataLoading = false;

      }); 
```

以上是我的代码的片段，它可以工作。

# ios - Monotouch 绑定无法接受委托模型

> ID：13080879
> 
> 赞同：2
> 
> 时间：2012-10-26T04:46:09.723
> 
> 标签：ios, xamarin.ios

我对 Applifier API 有以下绑定：

```
namespace MonoTouch.Applifier {

[BaseType (typeof (NSObject))]
interface Applifier {
    [Export ("initWithApplifierID:withWindow:supportedOrientations:"), Static]
    Applifier InitWithApplifierId (string applifierId, UIWindow withWindow,
        UIDeviceOrientation firstOrientation, IntPtr orientationsPtr);

    [Export ("initWithApplifierID:withWindow:delegate:usingBanners:usingInterstitials:usingFeaturedGames:supportedOrientations:"), Static]
    Applifier InitWithApplifierId (string applifierId, UIWindow withWindow,
        ApplifierGameDelegate gameDelegate, bool usingBanners, bool usingInterstitials,
        bool usingFeaturedGames, UIDeviceOrientation firstOrientation, IntPtr orientationsPtr);

    [Export ("sharedInstance"), Static]
    Applifier SharedInstance { get; }

    [Wrap ("WeakDelegate")]
    ApplifierGameDelegate Delegate { get; set; }

    [Export ("gameDelegate", ArgumentSemantic.Retain)]
    NSObject WeakDelegate { get; set; }

    [Export ("prepareFeaturedGames")]
    void PrepareFeaturedGames ();

    [Export ("showFeaturedGames")]
    void ShowFeaturedGames ();

    [Export ("showBannerAt:")]
    void ShowBannerAt (PointF position);
}

[BaseType (typeof (NSObject))]
[Model]
interface ApplifierGameDelegate {
    [Export("applifierInterstitialReady"), Abstract]
    void InterstitialReady ();

    [Export("applifierFeaturedGamesReady"), Abstract]
    void FeaturedGamesReady ();

    [Export("applifierBannerReady")]
    void BannerReady ();

    [Export("applifierAnimatedReady")]
    void AnimatedReady ();

    [Export("applifierCustomInterstitialReady")]
    void CustomInterstitialReady ();

    [Export("pauseGame")]
    void PauseGame ();

    [Export("resumeGame")]
    void ResultGame ();
}
} 
```

我的 extras C# 文件中有两种方法可以更轻松地调用这些初始化方法。我认为它们在这里不相关，但如果需要，我可以将它们包括在内。

这是“gameDelegate”的 Obj-C 声明：

```
@property (nonatomic, retain) id<ApplifierGameDelegate> gameDelegate; 
```

以及ApplifierGameDelegate的协议定义：

```
@protocol ApplifierGameDelegate <NSObject>
- (void)applifierInterstitialReady;
- (void)applifierFeaturedGamesReady;
@optional
- (void)applifierBannerReady;
- (void)applifierAnimatedReady;
- (void)applifierCustomInterstitialReady;
- (void)pauseGame;
- (void)resumeGame;
@end 
```

这里的问题是，无论我尝试什么，我都无法在我的 monotouch 项目中获取委托实现的方法来从 Applifier 获取回调。一些注意事项：

我在 Xcode 中有一个非常简单的示例应用程序，遵循确实有效的应用程序教程（测试用例是当显示特色游戏时，在委托上调用“pauseGame”方法）

*   我注意到，如果我将任何对象分配给 WeakDelegate，没有任何抱怨，这让我大吃一惊。例如，没有错误或警告： Applifier.SharedInstance.WeakDelegate = new NSString("Foo");
*   我可以从共享实例中获取委托并自己调用该方法，它确实被调用了。例如：Applifier.SharedInstance.Delegate.PauseGame(); -- 无论我将委托实例分配给 WeakDelegate、Delegate 还是通过接受委托作为参数之一的 init 方法，这都是正确的。

我现在唯一的结论是，似乎有两件事是真的：

*   我可以通过绑定将任何对象分配给 gameDelegate，没有任何抱怨
*   某处无法识别我的 ApplifierGameDelegate 接口与 AppliferGameDelegate 协议匹配。

我注意到的另一个奇怪的事情是，在我在 monotouch-bindings git 项目中探索的所有其他示例绑定中，我没有看到任何其他在委托属性上使用保留属性的示例。

我的 monotouch-bindings 分支可以在[https://github.com/threerings/monotouch-bindings](https://github.com/threerings/monotouch-bindings)找到。当前的 HEAD 是一种组合解决方案，可以完成我们需要完成的工作，但我仍然希望最终得到一个完全正确的绑定（只需要委托在 C# 领域工作）。我在这个问题中写的原始绑定可以在提交 fdcff4662a36ac42fbe135c098ff7f71cbdf205d 中查看。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T20:34:17.173

我根据您的绑定编写了绑定，请检查此绑定是否适合您，我没有测试它们，因为我没有`ApplifierID`

[https://github.com/dalexsoto/AlexTouch.Applifier](https://github.com/dalexsoto/AlexTouch.Applifier)

我在 Delegate 类中添加了事件以便于使用并绑定了大部分 API。

希望这可以帮助

亚历克斯

# java - 我有一个处理图片的 Java 程序。它编译并运行，但没有任何显示...有人知道出了什么问题吗？

> ID：13080880
> 
> 赞同：0
> 
> 时间：2012-10-26T04:46:26.553
> 
> 标签：java, class, methods, image, main

我创建了一个在picture.java 中运行的方法。在我的 Main Method 中调用该方法后，运行它后什么都没有显示。

它应该拍摄一张图片（由 xMin、xMax、yMin、yMax 又名矩形/正方形指定）并根据 1）其当前颜色值和 2）更改像素的颜色我们输入的双倍值

这是我的代码：

```
import java.awt.*;
import java.awt.font.*;
import java.awt.geom.*;
import java.awt.image.BufferedImage;
import java.text.*;
import java.util.*;
import java.util.List;

// resolves problem with java.awt.List and java.util.List

/**
 * A class that represents a picture.  This class inherits from 
 * SimplePicture and allows the student to add functionality to
 * the Picture class.  
 * 
 * Copyright Georgia Institute of Technology 2004-2005
 * @author Barbara Ericson ericson@cc.gatech.edu
 */
public class Picture extends SimplePicture 
{
///////////////////// constructors //////////////////////////////////

/**
 * Constructor that takes no arguments 
 */
public Picture ()
{
  /* not needed but use it to show students the implicit call to super()
   * child constructors always call a parent constructor 
   */
  super();  
}

/**
 * Constructor that takes a file name and creates the picture 
 * @param fileName the name of the file to create the picture from
 */
public Picture(String fileName)
{
  // let the parent class handle this fileName
  super(fileName);
}

/**
 * Constructor that takes the width and height
 * @param width the width of the desired picture
 * @param height the height of the desired picture
 */
public Picture(int width, int height)
{
  // let the parent class handle this width and height
  super(width,height);
}

/**
 * Constructor that takes a picture and creates a 
 * copy of that picture
 */
public Picture(Picture copyPicture)
{
  // let the parent class do the copy
  super(copyPicture);
}

/**
 * Constructor that takes a buffered image
 * @param image the buffered image to use
 */
public Picture(BufferedImage image)
{
  super(image);
}

////////////////////// methods ///////////////////////////////////////

public class boolean manipulateBox(int xMin, int yMin, int xMax, int yMax, double amount)
{

Pixel pixel = null;
int x;
int y;
int value;
int amount2;

y = yMin;
while(y <= yMax)
{
  x = xMin;
  while(x <= xMax)
  {
    pixel = this.getPixel(x,y);

    amount2 = ((int)(amount));

    value = pixel.getBlue();

    pixel.setBlue(amount2 * value);
  }
  x = x + 1;
}
y = y + 1;
return true; 
}

public static void main(String[] args) 
{
   String fileName = FileChooser.pickAFile();
   Picture pictObj = new Picture(fileName);
   pictObj.manipulateBox(50,50,100,100,0.5);
   pictObj.explore();
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-24T21:49:22.897

x = x + 1;

必须在 x < xMax while 循环内

与您的 y 变量相同

否则，它将创建一个无限循环，从而导致冻结

我知道这是一个很晚的回应，所以这是给谷歌人阅读的:)

# c - 将用户输入存储到C中的字符串数组中

> ID：13080881
> 
> 赞同：1
> 
> 时间：2012-10-26T04:46:29.267
> 
> 标签：c, arrays, string

我正在编写一个程序，它应该从用户那里获取一个名称列表，将它们存储在一个数组中，然后在列表中搜索以检查用户输入的下一个名称是否是原始列表的一部分名字。

我遇到的问题是，当我输入姓名列表时，它只会保存输入到列表中的姓氏。这是我遇到问题的代码部分：

```
#include<stdio.h>
#include<conio.h>
#include<string.h>

#define MAX_NAMELENGTH 10
#define MAX_NAMES 5
void initialize(char names[MAX_NAMES][MAX_NAMELENGTH]);

int main()
{
    char names[MAX_NAMES][MAX_NAMELENGTH];

    initialize(names);
    getch();
    return 0;
}

void initialize(char names[MAX_NAMES][MAX_NAMELENGTH])
{
    int i,Number_entrys;

    printf("How many names would you like to enter to the list?");
    scanf("%d",&Number_entrys);

    if (Number_entrys>MAX_NAMES) {
       printf("Please choose a smaller entry");
    }   
    else {
        for (i=0; i<Number_entrys; i++){
            scanf("%s",names[i]);
        }   
    }   

    printf("%s",names); 
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T04:48:53.580

那应该读`scanf("%s",names[i]);`

现在，您将其存储为 `scanf("%s",names);`，相当于 `scanf("%s",names[0]);`

因此，您在每次传递中都覆盖了相同的数组条目。

**编辑：** 另外，当你传递`char names[][]`给一个函数时，它只传递指向第一个元素的指针。您应该声明它的至少一个边界，与您声明它的值相同。

```
int main(){
    //To accept 2 names of 2 characters each
    char names[2][2];// or char** names;
    initialize(names, 2,2);
}
void initialize(char names[][2],const int MAX_NAMES,const int MAX_NAMELENGTH){ .. }
                             ^ syntax error if index not present 
```

（**[参考](http://www.cplusplus.com/forum/general/11627/)**）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T04:51:22.177

您应该将名称存储到数组中的特定条目中：

```
scanf("%s", names[i]);
printf("%s\n", names[i]); 
```

还有一些通用问题：

*   在大多数情况下，像 MAX_NAMES 这样的大写名称用于定义而不是变量
*   scanf 不是一个安全的功能，因为您不能限制它读取和写入的字符数量

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T04:51:36.370

到目前为止，要检查您的条目，您需要从 to 循环`0`（`i-1`在阅读 into 之后`names[i]`）并检查每个条目与最近的条目。

要比较字符串，您可以使用`strcmp`：

```
if( strcmp(names[i], names[j]) == 0 ) {
    /* Duplicate name - reboot universe */
} 
```

# iphone - 如何在 uilabel 中设置有限的字符数

> ID：13080885
> 
> 赞同：0
> 
> 时间：2012-10-26T04:47:13.090
> 
> 标签：iphone, ios, uilabel

我正在开发一个应用程序。我必须为 UIlabel 设置有限数量的字符。所以请告诉我如何为 UILabel 设置有限数量的字符

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T05:01:12.450

检查您想要的长度。例如，您希望您的 uilabel 限制为最多 50 个字符。

```
if([lbl.text length] > 50)
     nslog(@"stop");
else
     nslog(@"your stuff goes here"); 
```

享受编程！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T04:51:18.590

`UILabel`本身没有设置属性最大长度的`text`属性，因此您不能使用类本身中的任何属性或方法来执行此操作。

您应该在设置之前检查字符串的长度并决定是否允许它

# java - 如何通过主报表的参数将结果集传递给子报表？

> ID：13080897
> 
> 赞同：0
> 
> 时间：2012-10-26T04:48:35.600
> 
> 标签：java, jasper-reports, subreport

我是*JasperReports*的新手。

我有一个作为参数传递给主报告的结果集。从主报告中，我需要将它作为*数据源*传递给我的*子*报告。

```
param = super.getParam(param, "MY_RESULT_SET", resultSet);
JasperPrint jasperPrint = JasperFillManager.fillReport("myJasper.jasper", param, dataSource); 
```

*myJasper.jrxml*的片段：

```
<parameter name="MY_RESULT_SET" class="java.sql.ResultSet"/>
<subreport>
    <reportElement x="285" y="0" width="270" height="20"/>              
    <dataSourceExpression><![CDATA[$P{MY_RESULT_SET}]]></dataSourceExpression>
    <subreportExpression><![CDATA["mySubreport.jasper"]]></subreportExpression>
</subreport> 
```

如上所述，我得到以下异常

```
java.lang.ClassCastException: com.mysql.jdbc.JDBC4ResultSet cannot be cast to net.sf.jasperreports.engine.JRDataSource
at net.sf.jasperreports.engine.fill.JRFillSubreport.evaluateSubreport(JRFillSubreport.java:356)
at net.sf.jasperreports.engine.fill.JRFillSubreport.evaluate(JRFillSubreport.java:275)
at net.sf.jasperreports.engine.fill.JRFillElementContainer.evaluate(JRFillElementContainer.java:257)
at net.sf.jasperreports.engine.fill.JRFillBand.evaluate(JRFillBand.java:473)
at net.sf.jasperreports.engine.fill.JRVerticalFiller.fillColumnBand(JRVerticalFiller.java:2021)
at net.sf.jasperreports.engine.fill.JRVerticalFiller.fillDetail(JRVerticalFiller.java:755)
at net.sf.jasperreports.engine.fill.JRVerticalFiller.fillReportStart(JRVerticalFiller.java:265)
at net.sf.jasperreports.engine.fill.JRVerticalFiller.fillReport(JRVerticalFiller.java:128)
at net.sf.jasperreports.engine.fill.JRBaseFiller.fill(JRBaseFiller.java:836)
at net.sf.jasperreports.engine.fill.JRBaseFiller.fill(JRBaseFiller.java:765)
at net.sf.jasperreports.engine.fill.JRFiller.fillReport(JRFiller.java:84)
at net.sf.jasperreports.engine.JasperFillManager.fillReport(JasperFillManager.java:624)
at net.sf.jasperreports.engine.JasperFillManager.fillReport(JasperFillManager.java:540) 
```

谁能指导我？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T10:03:05.850

您需要构造 a`JRResultSetDataSource`并传递它。这应该像添加一样简单：

```
JRDataSource myResultSetDS = new JRResultSetDataSource(resultSet) 
```

`myResultSetDS`然后作为参数而不是`resultSet`本身传递。

# android - android中的listview正常和悬停背景样式

> ID：13080900
> 
> 赞同：4
> 
> 时间：2012-10-26T04:49:01.097
> 
> 标签：android, android-layout, android-widget, android-listview

这是我的编码部分：

**列表视图.xml：**

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="vertical">

<ListView
    android:id="@+id/list"
    android:layout_width="fill_parent"
    android:layout_height="0dp"
    android:divider="#FFFFFF"
    android:dividerHeight="7dp"
     android:layout_weight="1"
    android:listSelector="@drawable/list_selector" />

 </LinearLayout> 
```

**list_selector.xml**文件：

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">

 <item 
android:state_selected="false"
android:state_pressed="false" 

android:drawable="@drawable/gradient_bg" />
<item android:state_pressed="true" 
android:drawable="@drawable/gradient_bg_hover" />
<item android:state_selected="true"
android:state_pressed="false" 
android:drawable="@drawable/gradient_bg_hover" />
</selector> 
```

**渐变bg.xml：**

```
<?xml version="1.0" encoding="utf-8"?>
 <shape xmlns:android="http://schemas.android.com/apk/res/android"
    android:shape="rectangle">
  <gradient
  android:startColor="#e8eef4"
  android:centerColor="#fdfdfd"
  android:endColor="#d3dfe8"
  android:angle="270" />
        <stroke android:width="1dp" android:color="#b7ccdd" />

    <padding android:left="6dp" android:top="6dp" android:right="6dp"
            android:bottom="6dp" />
     <margin android:left="15dp" android:top="15dp" android:right="15dp"
            android:bottom="15dp" />
        <corners android:radius="4dp" />
    </shape> 
```

**gradient_bg_hover.xml：**

```
<?xml version="1.0" encoding="utf-8"?>

  <shape xmlns:android="http://schemas.android.com/apk/res/android"
    android:shape="rectangle">
  <gradient
  android:startColor="#ffe181"
  android:centerColor="#f5cd4a"
  android:endColor="#e8c34e"
  android:angle="270" />
        <stroke android:width="1dp" android:color="#e3b52c" />

    <padding android:left="6dp" android:top="6dp" android:right="6dp"
            android:bottom="6dp" />
     <margin android:left="15dp" android:top="15dp" android:right="15dp"
            android:bottom="15dp" />
        <corners android:radius="4dp" />
     </shape> 
```

在这里我得到了 o/p ： ![在此处输入图像描述](../Images/5b495a2cdca30f4d745eaee53235092a.png)

但我希望需要像这样的o/p： ![在此处输入图像描述](../Images/395d63f935ff095c7bf81ac63e7de0ef.png)

请比较两个图像上的悬停状态并为此提供解决方案..

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-26T08:57:19.993

列表视图.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical">

    <ListView
        android:id="@+id/list"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:divider="#FFFFFF"
        android:dividerHeight="1dp"
        android:listSelector="@drawable/list_selector" />

</LinearLayout> 
```

list_selector.xml

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
<!-- Selector style for listrow -->
<item 
 android:state_selected="false"
    android:state_pressed="false" 
    android:drawable="@drawable/gradient_bg" />
<item android:state_pressed="true" 
    android:drawable="@drawable/gradient_bg_hover" />
<item android:state_selected="true"
 android:state_pressed="false" 
    android:drawable="@drawable/gradient_bg_hover" />
</selector> 
```

渐变bg.xml

```
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android"
    android:shape="rectangle">
  <!--  Gradient Bg for listrow -->
  <gradient
      android:startColor="#f1f1f2"
      android:centerColor="#e7e7e8"
      android:endColor="#cfcfcf"
      android:angle="270" />
</shape> 
```

gradient_bg_hover.xml

```
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android"
    android:shape="rectangle">
  <!-- Gradient BgColor for listrow Selected -->
  <gradient
      android:startColor="#18d7e5"
      android:centerColor="#16cedb"
      android:endColor="#09adb9"
      android:angle="270" />
</shape> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T08:55:53.437

您没有使用聚焦状态尝试使用以下代码

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <!--  Active tab -->
    <item android:state_selected="true" android:state_focused="false"
        android:state_pressed="false" android:drawable="@drawable/gradient_bg_hover" />
    <!--  Inactive tab -->
    <item android:state_selected="false" android:state_focused="false"
        android:state_pressed="false" android:drawable="@drawable/gradient_bg" />
    <!--  Pressed tab -->
    <item android:state_pressed="true" android:drawable="@drawable/gradient_bg_hover" />
    <!--  Selected tab (using d-pad) -->
    <item android:state_focused="true" android:state_selected="true"
        android:state_pressed="false" android:drawable="@drawable/gradient_bg_hover" />
</selector> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-07T16:04:46.037

迟到了，但为了其他:)

您需要将列表视图的选择器设置为透明色

```
listView.setSelector(R.color.transparent); 
```

在 color.xml 只需添加以下内容

```
<color name="transparent">#00000000</color> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-02-24T13:02:08.427

从 gradient_bg_hover.xml 和 gradient_bg.xml 中删除填充

而是将填充放在 ListView 中，例如：

```
<ListView
    android:id="@+id/Sales_List"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_centerHorizontal="true"
    **android:paddingLeft="6dp"
    android:paddingTop="6dp"
    android:paddingRight="6dp"
    android:paddingBottom="6dp"**
    android:dividerHeight="7dp"
    android:divider="@android:color/transparent"
    android:listSelector="@drawable/listviewselect"> 
```

它应该工作

# android - Android Arial 字体 - 编码问题

> ID：13080917
> 
> 赞同：0
> 
> 时间：2012-10-26T04:51:27.600
> 
> 标签：android, character-encoding, fonts

我在我的应用程序中使用 arial 字体，该字体已本地化为波兰语和德语。对于这两种语言，我无法显示几个字母。我正在使用 UTF-8 编码，但我仍然会时不时地看到矩形而不是“未知”字母。有人遇到过同样的问题吗？我需要更改 XML 字符串编码吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T04:57:47.630

在 android 中，您可以在 textview 控件中使用任何文本字体，但不能在 xml 布局文件中使用。您应该首先将 textview 控件膨胀到 TextView 实例。然后从 /asset 文件夹加载字体并设置为这些实例，如下所示：

```
 TextView tv=(TextView)findViewById(R.id.custom); 
  Typeface face=Typeface.createFromAsset(getAssets(), "fonts/arial.ttf"); 
  tv.setTypeface(face); 
```

# vhdl - VHDL - 逐次逼近寄存器

> ID：13080920
> 
> 赞同：0
> 
> 时间：2012-10-26T04:51:38.563
> 
> 标签：vhdl

我有一个关于我试图为 ADC 的逐次逼近寄存器编写的 VHDL 代码的问题。

在下面显示的代码中，DigitalOutTemp 是否会在整个 for 循环中不断更新？还是只会在流程结束时收到 OutTemp 的值？

我想我的逻辑可能有误，但我想做的是让 DigitalOutTemp 通过数模转换器，然后进入带有我正在测量的模拟信号的比较器。然后比较器将反馈到寄存器中。  

```
LIBRARY ieee;
USE     ieee.std_logic_1164.all;

ENTITY SARegister IS
PORT (
    Comparator, Clock                     : IN std_logic;
    DigitalOutFinal, DigitalOutTemp   : OUT std_logic_vector (13 downto 0)
);
END;

ARCHITECTURE Behavioural OF SARegister IS
BEGIN

PROCESS (CompIn, Clock)
    VARIABLE OutTemp : std_logic_vector (13 downto 0);
BEGIN
    IF (rising_edge(Clock)) THEN
        OutTemp := "10000000000000";

        FOR i IN 13 downto 0 LOOP

            IF (Comparator = '0') THEN
                OutTemp(i) := '0';
            END IF;

            IF (i > 0) THEN
                OutTemp(i - 1) := '1';
            END IF;

            DigitalOutTemp <= OutTemp;

        END LOOP;

        DigitalOutFinal <= OutTemp;

    END IF;

END PROCESS;
END; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T14:41:51.330

> 在下面显示的代码中，DigitalOutTemp 是否会在整个 for 循环中不断更新？还是只会在流程结束时收到 OutTemp 的值？

每次写入 DigitalOutTemp 时，信号都会获得*计划更新*的新值。然而，直到当前增量周期结束（即在所有触发的进程都完成之后），更新才会发生。

在那之前，如果您读取信号（在同一进程或任何其他进程中），您将保证读取相同的（起始）值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T09:05:37.700

我不清楚你的转换，你的代码太奇怪了。但我会指出你的代码有什么问题。**这不是 ANSWER**因为评论是两个狭窄的写。希望能让你的代码更好。

```
PROCESS (CompIn, Clock) 
```

这个敏感列表可能会导致一些我不知道的事情，因为我`CompIn`在你的代码中看不到信号了。如果你想要它是一个寄存器，请在这个列表上只放`clock`or `set`or`reset`信号（或`enable`使用时钟门控。

```
VARIABLE OutTemp : std_logic_vector (13 downto 0);
BEGIN
    IF (rising_edge(Clock)) THEN
    OutTemp := "10000000000000";

    FOR i IN 13 downto 0 LOOP

        IF (Comparator = '0') THEN
            OutTemp(i) := '0';
        END IF;

        IF (i > 0) THEN
            OutTemp(i - 1) := '1';
        END IF; 
```

两个`if`不会导致更好的结果，因为第二个会先覆盖。我确信在这之后`OutTemp`得到所有`1111..11`（甚至循环）。

```
 DigitalOutTemp <= OutTemp; 
```

请不要将此分配放在此循环中。即使您为其分配无限时间，此过程也仅在时钟上升沿时运行。

```
 END LOOP;

    DigitalOutFinal <= OutTemp;

END IF;
END PROCESS; 
```

我可以确定您的代码无法编译，因为缺少 CompIn。即使您添加 CompIn，结果`DigitalOut...`也将始终`1111...1`（全为）。

# algorithm - 获得排序组合数量的算法？

> ID：13080923
> 
> 赞同：5
> 
> 时间：2012-10-26T04:52:03.157
> 
> 标签：algorithm, combinations, sorted

假设有**“n”个**数字，我们从中选择**“p”**个数字**（p 小于 n）**，以便对选定的“p”个数字进行排序。可以重复选择的号码。我们如何计算可以选择的组合**数量**？例如，如果我们有一组数字，例如 {1,2,3,4,5,6} (n=6)，我们将从集合 (p=3) 中选择 3 个已排序的数字。所以我们可以有 {1,2,3}, {1,1,2}, {2,3,6}, {4,5,5}, {5,5,5} .... . 由于所有这些组合都已排序，因此它们是有效的。我们如何才能找到我们可以获得**的此类排序组合的数量？**

* * *

我的意思是，当我们从一**组****n 个**元素中选择 p 个元素时，应该对所选的**p****个**元素进行排序。

 ******举个小例子：

如果集合是`{1,2,3,4}`（所以 n = 4）并且我们要选择 3 个元素（p = 3），那么我们可以选择 p 个元素（有替换）的方式数将是`4*4*4=64`。所以选择会有`{1,1,1},{1,1,2},{1,1,3}{1,1,4},{1,2,1}.....{3,1,1}...{4,4,4}`. 但在这些选择中，并非所有选择都已排序。在本例中，`{1,2,1}`并`{3,1,1}`没有排序。

我想获得排序选择的数量。
谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-26T05:57:36.773

我看不到排序如何影响结果。对于每一个可能的重复组合，都会有一个对应的排序排列。

因此，问题归结为 n 个元素的组合数量，一次取 p 并替换。这是直接的公式， (n-1+p)C(p) = factorial(n-1+p) / (factorial(p) * factorial(n-1) )

![在此处输入图像描述](../Images/547201e169b824fad1434528593a5477.png)

这是[公式的解释](http://www.physicsforums.com/showthread.php?t=563379)，[另一个来自 wolfram](http://mathworld.wolfram.com/BallPicking.html)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-11-20T07:19:14.220

@BiGYaN[在这里](https://stackoverflow.com/questions/13080923/algorithm-to-get-the-number-of-sorted-combinations/13081535#13081535)的回答是正确的，但在获得这个结果的过程中缺乏幽默感（即使在提供的链接上），所以我决定添加这个 -

1.  首先OP不应该拿集合来类比，因为集合定义不考虑顺序，而且包含唯一项。

2.  如果我们采用相同的例子，其中 n = 6 或 [1,2,3,4,5,6]，现在我们要得到长度为 3 的序列，这样 -

    模式 = d1<=d2<=d3 （d 代表数字）。

我们需要这样的序列：{[1,1,1], [1,1,2], .... , [2,2,3], [2,2,4],...}。现在，对于这样的序列，从左侧扫描模式并尝试推理我们是否要增加数字。

例如：从 d1 的左侧开始，如果你决定不在这里增加 d1 的原因，如果你决定不 - d1 将是“1”，现在继续在 d2 之前提出相同的问题，如果你再次决定不向上，d2 再次为“1”。

你可以随时选择加注 5 次，因为范围是 [1-6] 并且 d1 至少应该是 6，如果你决定加注 5 次以获得 [6,6,6]。

所以，问题就变成了为 5 ups 选择合适的位置

```
[up up up up up d1 d2 d3] 
```

这可能是 [up d1 up up up up up d2 d3] 产生 [2,6,6]，或 [d1 up up up up up d2 up d3 up] 产生 [1,4,5] 或任何类似的组合。

所以，实际上答案是 - C(5 up's + 3 d's, 5 up's) 或更一般地说

```
C(n-1 up's + k digits, n-1 up's) or C(n-1+k, n-1) 
```

其中，要从 n 个事物中按排序顺序选择 k 个事物。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-26T05:04:37.013

您可以从一组元素中选择有替换元素的方法`k`的数量与您可以从一组元素中选择不带替换元素`n`的方法的数量相同。后一个值是二项式系数，其值为`k``n + k - 1``n+k-1 choose k``(n+k-1)!/(k! (n-1)!)`

非正式演示：

假设我有 n 个蓝色盒子。我把它们排成一排（这样它们就被排序了），然后拿了k个红球。我把红球放在行中我喜欢的任何地方，除了最后，所以行必须仍然以蓝色框结束。现在，对于每个红球，我选择以下蓝色框。如果两个或多个红球并排排列，则它们都对应同一个蓝色框。

所以红球和蓝盒子的每一次排列对应着一些蓝盒子替换的选择，而蓝盒子的每一次选择都对应着红球和蓝盒子的一些排列。

红球和蓝盒子有几种排列方式？我的行必须以一个蓝色盒子结束，所以我把那个拿走，现在我可以用我选择的任何方式排列剩余的 n-1 个蓝色盒子和 k 个红色球。或者，换句话说，我可以选择 k + n-1 个位置中的 k 个，然后将红球放在这些位置，用蓝色框填充剩余的位置。******

# sql-server - 分配给不同类型的值的计数频率

> ID：13080925
> 
> 赞同：0
> 
> 时间：2012-10-26T04:52:06.913
> 
> 标签：sql-server, tsql, sql-server-2005, count

我为我糟糕的描述提前道歉，我想不出更好的措辞，但我会尽力解释清楚。

假设我以这种方式设置了表格：

## 输入表

```
Itm Type
A   Apple
B   Orange
C   Apple
B   Grape
D   Peaches
B   Apple
C   Grapes
E   Apple
A   Apple 
```

目标是生成一个表格，显示每个项目（A、B、C、D 和 E）以及分配给该项目的每种类型的总数。

## 目标输出表

```
Itm    Apple  Orange  Grape  Peaches    
A       2       0       0       0   
B       1       1       1       0
C       1       0       1       0
D       0       0       0       1
E       1       0       0       0 
```

我现在使用的查询显示了一个表格，其中似乎汇总了所有项目的所有类型并将该值放在每一行上。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T05:00:30.837

```
SELECT 
    Item, 
    ISNULL([Apple], 0) 'Apple', 
    ISNULL([Orange], 0) 'Orange', 
    ISNULL([Grapes], 0) 'Grapes', 
    ISNULL([Peaches], 0) 'Peaches'
FROM
(
    SELECT 
        Item, Type, count(*) 'ItemTypeCount'
    FROM 
        ItemTypes
    GROUP BY Item, Type
) AS T
PIVOT
(
    SUM(ItemTypeCount) FOR Type IN ([Apple], [Orange], [Grapes], [Peaches])
) As PivotResults 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T05:27:41.243

## 查询：

```
select Itm, Apple, Orange, Grape, Peaches
from items
pivot(count(Type) for Type in (Apple, Orange, Grape, Peaches)) p 
```

示例架构和数据。在 StackOverflow 上发布问题时，您应该**始终提供这些。**

```
create table items(Itm char(1), Type varchar(10));
insert items select
'A',   'Apple' union all select
'B',   'Orange' union all select
'C',   'Apple' union all select
'B',   'Grape' union all select
'D',   'Peaches' union all select
'B',   'Apple' union all select
'C',   'Grapes' union all select
'E',   'Apple' union all select
'A',   'Apple'; 
```

结果：

```
| ITM | APPLE | ORANGE | GRAPE | PEACHES |
------------------------------------------
|   A |     2 |      0 |     0 |       0 |
|   B |     1 |      1 |     1 |       0 |
|   C |     1 |      0 |     0 |       0 |
|   D |     0 |      0 |     0 |       1 |
|   E |     1 |      0 |     0 |       0 | 
```

## [SQL小提琴](http://sqlfiddle.com/#!3/956ce/1/0)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T05:23:58.713

尝试运行这个

```
SELECT 
         ITEM 
         , SUM(APPLE) AS APPLE 
         , SUM(Grapes) AS Grapes
         ,SUM(Orange) AS Orange 
         , SUM(Peaches) AS Peaches
FROM(SELECT 
        ITEM 
        ,CASE WHEN TYPE = 'APPLE' THEN  COUNT(*) ELSE 0 END AS APPLE
        ,CASE WHEN TYPE = 'Grapes' THEN  COUNT(*) ELSE 0 END AS  Grapes
        ,CASE WHEN TYPE = 'Orange' THEN  COUNT(*) ELSE 0 END AS Orange
        ,CASE WHEN TYPE = 'Peaches' THEN  COUNT(*) ELSE 0 END AS Peaches 
    FROM ITEM
    GROUP BY ITEM , TYPE 
    ) AS A GROUP BY ITEM 
```

# c++ - 关于 MSDN 代码示例，“启用和禁用权限”

> ID：13080927
> 
> 赞同：2
> 
> 时间：2012-10-26T04:52:23.433
> 
> 标签：c++, windows, winapi

MSDN 文章[Enabling and Disabling Privileges in C++](http://msdn.microsoft.com/en-us/library/windows/desktop/aa446619%28v=vs.85%29.aspx)提供了一个代码示例来展示如何在访问令牌中启用或禁用权限。

我引用了有问题的部分：

```
tp.PrivilegeCount = 1;
tp.Privileges[0].Luid = luid;
if (bEnablePrivilege)
    tp.Privileges[0].Attributes = SE_PRIVILEGE_ENABLED;
else
    tp.Privileges[0].Attributes = 0; 
```

**成员的零值是什么意思`Attributes`？**

根据[TOKEN_PRIVILEGES](http://msdn.microsoft.com/en-us/library/windows/desktop/aa379630%28v=vs.85%29.aspx)结构的文档，权限的属性可以是以下值的组合：

*   `SE_PRIVILEGE_ENABLED`  （在**0x00000002L**中`WinNT.h`）
*   `SE_PRIVILEGE_ENABLED_BY_DEFAULT`  （在**0x00000001L**中`WinNT.h`）
*   `SE_PRIVILEGE_REMOVED`  （在**0x00000004L**中`WinNT.h`）
*   `SE_PRIVILEGE_USED_FOR_ACCESS`  （在**0x80000000L**中`WinNT.h`）

因此，我们看不到任何值为 0 的有效常量。我猜，零等于`SE_PRIVILEGE_REMOVED`。

再一次，如果零意味着禁用所有权限，我对此表示怀疑，因为只需将[AdjustTokenPrivileges()](http://msdn.microsoft.com/en-us/library/windows/desktop/aa375202%28v=vs.85%29.aspx)`DisableAllPrivileges`的参数设置为即可禁用所有权限。`TRUE`

这里的任何人都可以解释零值的*真正* 作用吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-02-19T16:47:24.753

*禁用*特权（允许您稍后再次启用它）与从令牌中*删除*特权之间存在区别。删除权限意味着以后*无法*重新启用它。

传递零表示`SE_PRIVILEGE_ENABLED`未设置该位，因此该权限被禁用。

令牌在创建时包含许多特权。在`SeChangeNotifyPrivilege`本地安全策略/组策略的用户权限分配部分中称为“绕过遍历检查”，默认情况下始终启用，不应禁用（有关详细信息，请参阅[KB823659](http://support.microsoft.com/kb/823659#method3)）。因此，该`DisableAllPrivileges`参数实际上没有用。

用户帐户控制（Windows Vista 和更高版本）获取原始登录令牌，对其进行克隆，并使用该`SE_PRIVILEGE_REMOVED`标志创建用于启动 shell 的“过滤令牌”。然后将原始令牌隐藏起来，以便“以管理员身份运行”功能可以使用它来启动程序。

[您可以使用Sysinternals Process Explorer](http://technet.microsoft.com/en-us/sysinternals/bb896653)查看进程令牌中启用的权限。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T05:07:58.520

`If SE_PRIVILEGE_REMOVED`等于零，它会被定义为这样。鉴于存在的定义，我建议零值意味着从未启用或随后使用/删除任何特权：存在并且从未存在任何令牌特权。

# type-inference - ML 中类型推断的局限性

> ID：13080932
> 
> 赞同：2
> 
> 时间：2012-10-26T04:53:12.690
> 
> 标签：type-inference, ml

我读过一些在行业中使用 ML 的人的轶事，他们说经常遇到类型推断限制并且必须在他们的程序中使用显式类型注释。谁能给出 ML 的类型推断在哪里遇到问题的明确示例，并可能解释这些限制是否与不可判定性有关？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T04:59:26.710

我现在不能举一个例子（我已经几个月没有在 Ocaml 中编码了），但在实践中可能发生的情况是当你犯了类型错误时（即传递了错误类型的参数），尤其是在使用 high -order 函数，类型错误消息的发生可能与您真正的错误相去甚远。

为了缓解这种情况，我养成了显式键入大多数内部顶级函数的习惯，例如

```
let f (x: int) : string = 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T12:00:54.723

[可能是这个问题/答案](https://stackoverflow.com/questions/10462479/what-is-a-fully-type-inferred-language-and-limitations-of-such-language/10470321#10470321)的副本。快速回答：Hindley/Milner 类型推断（在 ML 中使用）仅限于 rank-1 多态性，也就是说，多态类型是类型系统的二等公民，例如函数参数本身不能是多态的。众所周知，更高级别的多态性（如 System F 又名多态 lambda 演算）的类型推断是不可判定的。

# ruby-on-rails - Ruby on Rails - 在模型答案中定义答案的方式是真/假

> ID：13080933
> 
> 赞同：1
> 
> 时间：2012-10-26T04:53:12.643
> 
> 标签：ruby-on-rails, ruby-on-rails-3, database-design

我正在构建一个在线测试应用程序。在我的应用程序中，一个问题可以是真/假问题、单选（只接受一个答案）、多选（接受多个答案）。我创建模型：

```
class Question < ActiveRecord::Base
  has_many :answers
end

class Answer < ActiveRecord::Base
  belongs_to :question
end 
```

问题模型将`question_type_id`检查它是 T/F、单选还是多选。

Answer 模型将有一个名为`content`typed text 的列，而我将有一个 boolean 列`correct`，用于知道哪个答案被接受。对于单选题和多选题，我认为答案是文本可以很好地存储在`content`列中，但是对于 True/False 问题，如果我只将答案存储在`content`列中并设置诸如“True”、“False”之类的文本是否是个好主意列中接受 True for answer `correct`？我不知道另一种更好的方法来处理真/假问题，有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T05:24:54.953

将布尔值存储为字符串似乎是完成您想要的最合理的方式。我建议在保存时对值进行规范化，以便在您获取答案时 true 和 false 看起来总是相同的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T05:59:46.313

由于我已经完成了这种应用程序，然后才能帮助您....

首先，您应该区分数据库中不同类型的问题......假设我们给他们提供 ID，那么我们有

0 表示 T/F 问题 1 表示单个正确的 MCQ 2 表示多个正确的 MCQ

完成此操作后，您需要有一个名为 Options 的不同模型，

问题有很多选项，问题通过选项有一个答案

在选项模型中，我们应该 4 列假设（选项 A、B、C、D）它是一个四个选择题......

# php - 将 PHP 生成的网页下载为 HTML 文件

> ID：13080943
> 
> 赞同：5
> 
> 时间：2012-10-26T04:54:32.370
> 
> 标签：php, html, download, save

我正在使用基于 PHP 的 CMS，它`<include>`用于添加页面的页眉和页脚，并且页面的内容是使用 PHP/MySQL 从数据库中检索的。

我想在页面上创建一个按钮，将页面下载为 HTML 文件 - 就像您将页面源复制到空白文件或使用浏览器保存页面一样。

通常我会使用 PHP 来定位文件并下载它，因为这是一个 CMS 生成的页面，这些不是实际的文件。

有谁知道如何实现这一目标？

（ps - 这样做的目的是创建一个可下载的 HTML 电子邮件文件）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-26T05:12:56.160

```
<?php
$filename = 'filename.html';
header('Content-disposition: attachment; filename=' . $filename);
header('Content-type: text/html');
// ... the rest of your file
?> 
```

只需将上面的代码放在 PHP 文件的顶部即可。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-26T05:18:30.467

你可以试试这个 file_get_contents();

```
<?php

 //Link to download file...
 $url = "http://example.com/test.php";

 //Code to get the file...
 $data = file_get_contents($url);

 //save as?
 $filename = "test.html";

 //save the file...
 $fh = fopen($filename,"w");
 fwrite($fh,$data);
 fclose($fh);

 //display link to the file you just saved...
 echo "<a href='".$filename."'>Click Here</a> to download the file...";

?> 
```

# objective-c - 可可类初始化不运行

> ID：13080950
> 
> 赞同：0
> 
> 时间：2012-10-26T04:55:28.377
> 
> 标签：objective-c, cocoa, init

在一个简单的测试应用程序中，它启动并打开一个窗口，但从未到达类中的 init。调试器控制台与：`Running… (gdb)`

我什么都没有`UntitledAppDelegate.m`或.h

在 NSObject 类中，“untitled”`init`在 untitled.h 中声明，在 untitled.m 中我有

```
 @implementation untitled
   - (id)init {

    if (self = [super init])
    { 
       int i=1;
       i=i++;
       NSLog(@"%i here",i);
    }

    return self;
  }

 @end 
```

UntitledAppDelegate.m 中的断点表明它到达了最后一个}。

Xcode 设置为 3.2、OSX 10.6 和垃圾收集。

没有错误或警告；它运行。，

为什么init不运行，我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T08:35:20.323

您是否曾经为该类的任何实例调用 init ？在你的代码中你应该有的地方：

```
untitled *myObj = [[untitled alloc] init]; 
```

如果不是，那么这就是它不被调用的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T17:21:17.003

我向所有浪费时间查看我的愚蠢错误结果的人道歉。
几个结合在一起，但主要是我意识到那些作者正在使用带有 initWithFrame 的 NSView 类，它在启动时运行就像它应该在没有添加到 UntitledAppDelegate 的情况下一样。

我还没有弄清楚为什么 NSObject 类中的简单初始化不会在启动时运行。

```
- (id)init {  
if (self = [super init]) {  
NSLog(@"Foo");  
}  
return self;  
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T10:37:52.650

```
untitled *object = [untitled new]; 
```

# eclipse-rcp - 如何避免在一次选择中调用 ISelectionListener() 两次？

> ID：13080952
> 
> 赞同：1
> 
> 时间：2012-10-26T04:55:35.200
> 
> 标签：eclipse-rcp

```
getSite().setSelectionProvider(tViewer); 
```

`tViewer()`是具有各种类别的树查看器。单击任何类别时，我需要将其显示在表格查看器上`implements` `ISelectionListener()`，其方式与在线各种示例中给出的方式相同。但是，`ISelectionListener()`只需单击一次树查看器就会被调用两次。

任何帮助，将不胜感激。

# wordpress - 如何在 Wordpress 中创建类似以下的网站？出于某种荒谬的原因，我的心被这个融化了

> ID：13080955
> 
> 赞同：0
> 
> 时间：2012-10-26T04:55:45.763
> 
> 标签：wordpress, content-management-system

[http://www.renegrafisch.nl](http://www.renegrafisch.nl)

我想采用[响应式主题](http://themeid.com/responsive-theme/)并从中创建一个网站。但是，从全新安装开始，我不知道如何将它从看起来主要是带有侧边栏的博客网站转变为完全强大的商业网站。

是否有任何教程可以展示如何将诸如此类的主题转变为强大、功能齐全的商业网站？

我最终得到的只是关于创建模板的内容，但它看起来仍然像是在创建博客文章。

我想要网站上的单独部分，在普通的 web 开发中是 div 和 div。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T05:05:11.037

如果您想了解有关响应式设计的更多信息，我会查看[Twitter Bootstrap](http://twitter.github.com/bootstrap/)库，因为它具有该功能以及许多其他有助于加快开发过程的功能。

至于将其实际实现为 wordpress 主题，我会阅读他们的[文档](http://codex.wordpress.org/Theme_Development)，上次我这样做（大约 4 年前），还不错。

# delphi - 我可以在其他平台上使用 Free Pascal 进行交叉编译（不链接）吗？

> ID：13080956
> 
> 赞同：2
> 
> 时间：2012-10-26T04:55:51.687
> 
> 标签：delphi, cross-compiling, freepascal

我已经看到使用 Free Pascal 配置交叉编译是可能的，但并不容易，因为系统上必须有目标操作系统的库。

但我只需要快速语法检查来验证项目是否可以编译，不需要链接可执行文件。

那么：是否有编译器选项可用于（仅）使用 Free Pascal进行**跨平台测试编译？**

就我而言，在源代码控制中签入项目之前，我想在 Windows 工作站上验证编译器是否可以针对 Linux 或 OSX 目标进行编译。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T06:02:50.677

AFAIK，使用交叉编译器编译和链接应用程序是真正检查您的项目的唯一方法。这就是当今主要 IDE 的工作方式（后台编译）。

你只需要在你的主机上安装你需要的 CPU/OS 目标的交叉编译器。

[http://wiki.freepascal.org/Cross_compiling#Host_and_target_on_different_CPUs](http://wiki.freepascal.org/Cross_compiling#Host_and_target_on_different_CPUs)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T18:19:38.667

（请注意，问题的根源不是 FPC ，而是 Apple 不再发布其 binutils 的源代码，这与早期 (ppc) OS X 时代（当时有 cctools 版本可用）相反）

是的，这是可能的。基本上，然后（交叉）编译为汇编器，并尝试在目标上进行汇编和链接。

要查看的命令行参数是

*   -a 不删除汇编文件
*   -Aas 选择外部汇编器
*   -s 延迟链接

链接器命令行将被写入 ppas.bat/sh 文件。

将所有生成的 .s 汇编文件和 link.res 链接描述文件和 ppas.sh 传输到目标系统，然后运行 ​​ppas.sh

理论上应该汇编和编译，但实际上您可能需要调整 link.res 和 ppas.sh 以添加正确的搜索路径。许多新目标的早期移植都是以这种方式完成的（因为初始移植是在编译器中添加适当的目标之前完成的）

# c# - 如何在 Linq c# 中将一个对象分配给另一个对象而不创建新对象

> ID：13080969
> 
> 赞同：1
> 
> 时间：2012-10-26T04:57:13.867
> 
> 标签：c#, sql, linq, linq-to-sql

我在 Linq to SQL 中将一个对象分配给另一个对象时遇到了问题。在这个例子中：

```
Func<result, result> make = q => new result
{
    Id = q.Id,
    lName = q.lName,
    GroupId = q.GroupId,
    Age = (from tags in q.age where tags.Del == null && tags.lId == q.Id select age).ToEntitySet(),

};

p = (from q in dc.results
        where q.Id == Id.Value
        select make(q)).First(); 
```

我正在新建并分配对象，但我不想这样做，它会导致插入问题。我想在不创建新对象的情况下进行分配，这怎么可能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T05:00:44.880

Jon Skeet 和 Marc Gravell 有一个名为[MiscUtil](http://www.yoda.arachsys.com/csharp/miscutil/index.html)的库。在`MiscUtil`.Reflection 内部有一个名为的类`PropertyCopy`，它完全符合您的描述。它仅适用于 .NET 3.5。

它通过运行 SourceType 的公共属性，按名称将它们与 TargetType 的公共属性匹配，确保每个属性都可以从源分配到目标，然后为这两个创建和缓存复制功能类型（因此您不必每次都进行所有这些反思）。我已经在生产代码中使用了它，并且可以保证它的优点。

查看这篇文章以获取[代码示例](https://stackoverflow.com/questions/2624823/copy-values-from-one-object-to-another)。

# javascript - 循环变量传递给回调函数时未定义的变量

> ID：13080971
> 
> 赞同：0
> 
> 时间：2012-10-26T04:57:53.593
> 
> 标签：javascript

> **可能重复：**
> [JavaScript 回调函数中的变量总是在循环中获取最后一个值？](https://stackoverflow.com/questions/2520587/variable-in-javascript-callback-functions-always-gets-last-value-in-loop)

我无法将 k 的值传递给 fad​​eOut 函数的回调函数。我的循环如下所示。

```
 for(var k=0;k<image1.length;k++)
 {

    $(img[k]).fadeOut(200,function(k) {
        alert(k);
        $(this).attr('src', image2[k]);
        $(this).fadeIn(200);
    });
  } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T05:01:15.503

jQuery`fadeOut`函数采用不带参数的回调函数。从[jQuery 文档](http://api.jquery.com/fadeOut/)中，“回调未发送任何参数”。如果要捕获 的值`k`，请执行以下操作：

```
for(var k=0;k<image1.length;k++) {
    (function(k) {
        $(img[k]).fadeOut(200,function() {
            alert(k);
            $(this).attr('src', image2[k]);
            $(this).fadeIn(200);
        });
    })(k);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-26T05:03:10.750

您必须执行以下操作才能使回调访问您的变量：

```
for (var k = 0; k < image1.length; k++) {
    (function(k) {
        $(img[k]).fadeOut(200, function() {
            alert(k);
            this.src = image2[k];
            $(this).fadeIn(200);
        });
    })(k);
} 
```

# c - 如何使用 lapack 库解决 c 中矩阵乘法中的链接器错误？

> ID：13080974
> 
> 赞同：1
> 
> 时间：2012-10-26T04:58:22.263
> 
> 标签：c, visual-c++, matrix-multiplication

我使用 lapack 库进行了矩阵乘法，出现如下错误。谁能帮我？

```
"error LNK2019: unresolved external symbol "void __cdecl dgemm(char,char,int *,int *,int *,double *,double *,int *,double *,int *,double *,double *,int *)" (?dgemm@@YAXDDPAH00PAN1010110@Z) referenced in function _main"
1>..\bin\matrixMultiplicationUsingLapack.exe : fatal error LNK1120: 1 unresolved externals 
```

我在下面发布我的代码

```
 # define matARowSize 2      // -- Matrix 1 number of rows
    # define matAColSize 2      // -- Matrix 1 number of cols
    # define matBRowSize 2      // -- Matrix 2 number of rows
    # define matBColSize 2      // -- Matrix 2 number of cols

using namespace std;

   void dgemm(char, char, int *, int *, int *, double *, double *, int *, double *, int *,        double *, double *, int *);

    int main()
    {
    double iMatrixA[matARowSize*matAColSize];   // -- Input matrix 1   {m x n}
    double iMatrixB[matBRowSize*matBColSize];   // -- Input matrix 2   {n x k}
    double iMatrixC[matARowSize*matBColSize];   // -- Output matrix    {m x n * n x     k = m x k}

    double alpha = 1.0f;
    double beta = 0.0f;

    int n = 2;

    iMatrixA[0] = 1;
    iMatrixA[1] = 1;
    iMatrixA[2] = 1;
    iMatrixA[3] = 1;

    iMatrixB[0] = 1;
    iMatrixB[1] = 1;
    iMatrixB[2] = 1;
    iMatrixB[3] = 1;

    //dgemm('N','N',&n,&n,&n,&alpha,iMatrixA,&n,iMatrixB,&n,&beta,iMatrixC,&n);

    dgemm('N','N',&n,&n,&n,&alpha,iMatrixA,&n,iMatrixB,&n,&beta,iMatrixC,&n);

    std::cin.get();
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T05:19:31.070

链接器错误基本上是告诉您它找不到您的功能`void dgemm(...)`。

如果您查看 Main 函数上方，您的函数似乎`void dgemm(...)`没有主体。

放在括号内的代码代表函数的主体`{` `}`。

你应该有这样的东西：

```
void dgemm(...)
{
    // Do stuff
} 
```

这就是您遇到错误的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T05:24:18.323

发生链接器错误是因为编译器找不到函数定义......

*   要么你必须编写函数的定义。
*   或者，如果库中的函数定义必须在

    ProjectProperty-->Linker-->Input-->AdditionalDependencies-->"Add here.lib"

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T05:04:14.110

这是由于未解析的引用导致的链接器错误。你能显示你的make文件吗？尝试通过将库名称放在末尾来更改您的 make 文件。例如
`gcc <program_name> lapack.a -o exec`

# php - 奇怪的会话行为 - 会话消失

> ID：13080975
> 
> 赞同：0
> 
> 时间：2012-10-26T04:58:48.783
> 
> 标签：php, session, session-cookies

我在使用 PHP 和会话时遇到了一种非常奇怪的行为。

我正在使用的脚本已经运行了几个月，它正在使用各种 PHP 版本的各种服务器上运行。

脚本读取 URL 并根据 URL 重新路由，例如点击 /offer/abc1234.html 它将调用类 offer 并将 abc1234 作为参数传递。

我创建了一个“故障转移”类，换句话说，如果您编写 /abc1234.html，它将测试各种数据库条目，如果它发现一个自动包含该类，就像它被 URL 调用一样，只需一点额外的开销，区别是：

*   /offer/abc1234.html :: index.php -> offer.php -> home.php
*   abc1234.html :: index.php -> error.php -> failover.php -> offer.php -> home.php

现在，鉴于这一切都有效并且已经工作了几个月，我的问题在于会话。

如果我点击 /offer/abc1234.html 我会看到会话集和发送到浏览器的 cookie

如果我点击 /abc1234.html 会话设置正确，没有错误（E_STRICT+E_ALL），没有警告，没有任何内容，但 cookie 不会发送到浏览器。我什至尝试在脚本末尾打印 $_SESSION，并且会话被填充并且所有变量都是正确的，除了标题。

我尝试对其进行调试并在各个地方添加各种 var_dump，但除了 header_list() 从未包含 session_cookie 但它确实包含我手动设置的其他 cookie 之外，其他任何地方都没有什么不同：

我目前打印：

*   会话名称（）
*   session_id() - 每次刷新时都会发生变化，但在整个页面上是一致的
*   session_get_cookie_params()
*   headers_list() - 这不包含 session_start 应该具有的 set-cookie 标头

输出类似于：

*   字符串（6）“QSCSID”
*   字符串（26）“456disv3pl4u2j81dej6h6d717”
*   array(5) { ["lifetime"]=> int(0) ["path"]=> string(1) "/" ["domain"]=> string(0) "" ["secure"]=> bool(false) ["httponly"]=> bool(false) }
*   array(4) { [0]=> string(38) "过期时间：星期四，1981 年 11 月 19 日 08:52:00 GMT" [1]=> string(77) "缓存控制：无存储，无缓存, must-revalidate, post-check=0, pre-check=0" [2]=> string(16) "Pragma: no-cache" [3]=> string(68) "Set-Cookie: spi=17468 ;过期=星期六，2013 年 10 月 26 日 05:02:23 GMT；路径=/" }

再一次，我疯了，因为当天早些时候一切正常，然后我重新启动了 apache，它停止了工作。

我检查了服务器，文件夹未满，可写，文件被创建，当我调用 abcd1234.html 时为空

**编辑**
在处理它时，我开始直接在服务器上通过“ee”（FreeBSD 编辑器）打开文件。直到我打开/保存了一个类，没有对文件进行任何更改，我不小心添加了一个空格并删除了它，然后当我退出时，编辑器要求我保存，我说是。

PHP 是用 eaccelerator 编译的，我已经删除了缓存文件夹以及重新启动 apache 并看到文件夹自动填充。这样的类（failover.php）是一个简单的 4 函数，其中每个函数都是一个查询，然后该构造同时调用每个函数。

所以，它似乎工作，但我想知道是否有人经历过这样的事情，如果他们知道问题可能是什么

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T23:09:02.190

我无法复制它，一旦我打开文件并在 FreeBSD 上用“ee”关闭，一切正常。

# iphone - 音频文件的数字混合

> ID：13080976
> 
> 赞同：0
> 
> 时间：2012-10-26T04:59:02.450
> 
> 标签：iphone, ios, audio-recording

我想执行两个音频文件的数字混合。为此，我使用了 MixerHost-Apple 的示例代码。但我无法在磁盘上存储混合音频文件。如果有人知道该怎么做，请指导我。我已经尝试过发布其他人提出的相同问题的答案，但这只会录制我播放的音频的一部分，但我想要两个文件的混合音频。如何在磁盘上写入该文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T05:16:33.270

将 IO 单元添加到混音器，然后在新 IO 单元的回调函数上使用扩展音频文件服务将音频数据写入文件。您需要使用`ExtAudioFileWriteAsync`来编写数据包。

在此处查看参考： [https ://developer.apple.com/library/ios/#documentation/MusicAudio/Reference/ExtendedAudioFileServicesReference/Reference/reference.html](https://developer.apple.com/library/ios/#documentation/MusicAudio/Reference/ExtendedAudioFileServicesReference/Reference/reference.html)

# java - CSV , JAVA & HSQLDB

> ID：13080991
> 
> 赞同：2
> 
> 时间：2012-10-26T05:01:46.920
> 
> 标签：java, csv, hsqldb

我真的是java编程新手

我想询问有关**在 java 中读取 CSV 然后将其上传到 HSQLDB**的问题。我一直在阅读并通过教程尝试解决方案的示例，但仍然不太了解。根据我的阅读，**大多数人建议使用 OpenCSV**，但

1.  我可以读取带有分隔符的 csv 或带有 opencsv 的嵌套分隔符吗？
    *   opencsv 以不同的方式读取我的 *.csv 文件，一列中有多行。我希望它在一行中被读取。

下面是例子

B03BB510001T2001,,儿童咀嚼多种维生素*,,”“泛酸 7.5MG”,“对氨基苯甲酸 (PABA) 250MCG,”“叶酸 30MCG”,“生物素 50MCG”,“硝酸硫胺 + B6 + B12 6.6 MG," "CHOLINE 1MG," "VIT A + VIT E + VIT C REFER FILE," "肌醇 1MG",""片剂, 咀嚼片"",,,,B03,注册,75MG"

但我希望它显示在**一行中**

1.  如何直接从 csv 文件插入数据库？
    *   我目前必须使用 HSQLDB [独立服务器]。我是否必须使用第三方工具才能做到这一点

**我只熟悉使用 PHP 和 MYSQL 而非 java 和 hsqldb 从 csv 读取和上传到数据库

希望你能建议和帮助我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T22:46:09.843

这是我用来将数据加载到每个 fredt 的 HSQL 的示例脚本。您需要有一个持久数据库才能使用文本表。如果您在数据库管理器中运行，只需复制并一次执行一条语句。您还可以使用 sqltool（sql 脚本与 DB 位于同一文件夹中）：

```
\i demotexttable.sql 
```

这是 demotexttable.sql

```
/* file.txt needs to be in the same folder as the database
   first line of file is a header, others lines are data
--start file.txt
Col1|Col2|Col3
abcdef|My Company Name|0
--end file.txt
*/

--create the schema
create schema imp;

--create the normal table
create cached table imp.normalTable (
       Col1 char(6),
       Col2 nvarchar(200),
       Col3 int
);

--create the table that table
create text table imp.textfiletable (
       Col1 char(6),
       Col2 nvarchar(200),
       Col3 int
);

--setup the text file table
set table imp.textfiletable source "file.txt;ignore_first=true;fs=|";

--insert data from text file into the `normal` table
INSERT INTO imp.normalTable (Col1, Col2, Col3) select Col1, Col2, Col3 from imp.textfiletable;

--we are done with the text file table
drop table imp.textfiletable;
commit; 
```

我在之前的帖子中发现了一些错误，我已经在这个最新的 mod 中清理了它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T07:18:58.050

您可以将 CSV 文件直接加载到 HSQLDB 中。

有两种不同的方式：

1.  使用 HSQLDB 的 TEXT TABLE 功能。您的文件不需要任何特殊设置，因为分隔符是默认设置。
2.  使用 HSQLDB 的普通表并使用 SqlTool 加载 CVS，SqlTool 是 HSQLDB 提供的附加 jar。SqlTool 不仅可以与 HSLQLDB 一起使用，还可以与 MySQL 和其他数据库一起使用。

有关详细信息，请参见此处：

[http://hsqldb.org/doc/2.0/guide/texttables-chapt.html](http://hsqldb.org/doc/2.0/guide/texttables-chapt.html)

[http://hsqldb.org/doc/2.0/util-guide/sqltool-chapt.html#sqltool_csv-sect](http://hsqldb.org/doc/2.0/util-guide/sqltool-chapt.html#sqltool_csv-sect)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T06:27:21.153

如您所知，CSV 只不过是一个“逗号分隔值”。其他人建议 OpenCSV 的原因是因为它具有商业友好的许可证。虽然除此之外可以使用正常的方式来检索值。使用 FileInputStream 读取值。请找到链接：

[http://www.roseindia.net/java/beginners/java-read-file-line-by-line.shtml](http://www.roseindia.net/java/beginners/java-read-file-line-by-line.shtml)

之后使用分隔符解析单个字符串。例如：String[] tokens = wholeString.split(delimiter);

现在只需通过 java.sql 包使用 jdbc 连接即可轻松将值存储在 hsql 数据库中。请查看链接：

[http://www.hsqldb.org/doc/guide/apb.html](http://www.hsqldb.org/doc/guide/apb.html)

希望这可以帮助你; 问候，

阿南德

# c# - 检查代理匿名性

> ID：13080992
> 
> 赞同：0
> 
> 时间：2012-10-26T05:01:48.740
> 
> 标签：c#

我正在构建一个小型 C# 应用程序来检查代理的匿名程度。

为了确定代理绝对匿名，我应该执行哪些“测试”？

以下可靠吗？

```
http://www.iprivacytools.com/proxy-checker-anonymity-test/ 
```

如果是，我可以`httpwebrequest`使用给定的代理构建一个来解析结果

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T05:06:47.833

匿名代理不会在 HTTP 标头中公开您的 IP。所以是的，这个测试可以给出一个提示。

# asp.net-mvc-3 - html5 音频控制标签在 mvc3 代码中不起作用

> ID：13080994
> 
> 赞同：0
> 
> 时间：2012-10-26T05:02:07.000
> 
> 标签：asp.net-mvc-3, html

这是我的代码：

```
<audio controls>                    
                    <source src="@Url.Action(@"C:\WS\Soongs\Soong\Content\themes\base\songs\Test.wma")" type="audio/mp3" />
                    <p>Your browser does not support HTML 5 audio element</p>
                </audio> 
```

音频即将禁用？谁能告诉我如何解决这个问题？或者我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T07:20:20.703

该链接指向本地硬盘驱动器上的文件。那是行不通的。

更改`@Url.Action(...)`为`@Url.Content("~/example/test.wma")`并确保该文件是您项目的一部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-20T05:48:32.017

```
<audio controls>
        <source src="@Url.Action("myaudio")" type="audio/mp3" />
        <p>Your browser does not support HTML 5 audio element</p></audio> 
```

我的“myaudio”是您的带有完整路径和扩展名的文件名。

# git - 执行“git checkout SHA”后如何撤消对存储库的更改

> ID：13080995
> 
> 赞同：3
> 
> 时间：2012-10-26T05:02:08.987
> 
> 标签：git

如果我执行`git checkout <SHA>`where `<SHA>`is some `commit-id`hash from `git log`，我的存储库将返回到前一阶段。

我怎样才能扭转效果`git checkout <SHA>`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-26T05:06:36.650

`git checkout`不会删除您存储库的任何状态。只需`git checkout`在所需的 refspec 上再次运行即可返回您想要的位置。例如，如果您从 master 开始，请运行`git checkout master`.

如果您不知道从哪里开始，您可以使用它`git reflog`来检查您的存储库最近处于的所有不同状态。如果错误`git checkout`是您所做的最后一件事，那么第二行将是`git reflog`您所在的最后一点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T05:59:22.747

## 签出以前的提交

Git 有一个方便的快捷方式可以返回到您签出的最后一次提交：

```
git checkout - 
```

IE

```
[/tmp/popdemo(master)]$ git checkout develop
Switched to branch 'develop'
[/tmp/popdemo(develop)]$ git checkout -
Switched to branch 'master'
[/tmp/popdemo(master)]$ git checkout -
Switched to branch 'develop'
[/tmp/popdemo(develop)]$ 
```