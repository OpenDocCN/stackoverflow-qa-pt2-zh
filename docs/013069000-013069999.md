# StackOverflow 问答 13069000-13069999

# django - 在 django admin 中管理列表列表

> ID：13069001
> 
> 赞同：0
> 
> 时间：2012-10-25T12:50:07.900
> 
> 标签：django

我正在编写一个 django 应用程序，用于存储和显示员工的工作时间。

问题是，例如，儿科医生有两种工作时间——生病的孩子和健康的孩子分开。

所以我想，使用 HTML 表格来显示每个员工的工作时间会很酷。我的想法是有一个“ListField”代表表的每一行，外键是员工。这样，管理员可以创建如下列表：

```
['', 'Sick Children', 'Healthy Children'],
['Monday', '8-12', '12-14'],
['Friday', '12-15'] 
```

它会以 HTML 表格的形式出现在网站上，看起来很不错。

问题是，我希望它对于网站管理员来说看起来简单直观。因此，我希望将表格行保留为管理面板中员工的内联。所以，我创建了模型：

```
class TableRow(models.Model):
    employee = models.ForeignKey(Employee)

class TableCell(models.Model):
    content = models.CharField(max_length=20)
    row = models.ForeignKey(TableRow) 
```

并尝试了类似的东西：

```
class TableCellInline(admin.TabularInline):
    model = TableCell

class TableRowInline(admin.TabularInline):
    model = TableRow

class EmployeeAdmin(admin.ModelAdmin):
    inlines = [TableRowInline]

admin.site.register(Employee, EmployeeAdmin)
admin.site.register(TableRow, TableRowAdmin) 
```

哪个不起作用（正如我所料，但尝试并没有什么坏处）。在添加/编辑员工时，管理面板显示添加表格行的选项，但未显示将任何单元格添加到行的任何选项。

有没有办法允许在编辑/添加员工时添加行？或者也许是一种完全不同的方式来解决问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T15:52:32.807

您尝试执行的操作通常称为嵌套内联。不幸的是，恐怕管理员仍然不支持。有关详细信息，请参阅以下资源。

[在 Django 管理员中嵌套内联？](https://stackoverflow.com/q/3681258/687488)

[#9025 分配的新功能：管理员中的嵌套内联支持](https://code.djangoproject.com/ticket/9025)

# objective-c - 写入临时目录不起作用

> ID：13069006
> 
> 赞同：1
> 
> 时间：2012-10-25T12:50:25.137
> 
> 标签：objective-c, macos, temporary

我正在尝试将文件写入临时目录。我这样做是这样的：

```
NSString *_location = NSTemporaryDirectory();
NSString *_guid = [[NSCalendarDate calendarDate] descriptionWithCalendarFormat:@"%m%d%Y%H%M%S%F"];
_guid = [_guid stringByAppendingString:@".png"];
NSString *_tempFilePath = [NSString stringWithFormat:@"%@/%@", _location, _guid];
NSData *_temp_data = [imgRep representationUsingType: NSPNGFileType properties: nil];
[_temp_data writeToFile:_tempFilePath atomically: NO]; 
```

但这对我不起作用。它不会创建文件。有什么问题？

PS 我试图在 NSTemporaryDirectory 中创建一个具有唯一名称的目录，然后在那里写入一个文件，但它也不起作用。

* * *

我注意到它不会在任何地方创建文件。试图将位置设置为用户的文档文件夹，但它不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T12:57:21.393

写入图像的路径不正确：

```
NSString *_tempFilePath = [NSString stringWithFormat:@"%@/%@", _location,_guid]; 
```

或者

```
 NSString *_tempFilePath = [location stringByAppendingPathComponent:@"%@",guid]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T13:34:25.143

如果您写入可能是新目录中的文件，则必须首先创建目录：

```
[[NSFileManager defaultManager] createDirectoryAtPath:_directoryPath
                           withIntermediateDirectories:YES
                                            attributes:nil error:nil];

[_myData writeToFile:[_directoryPath stringByAppendingPathComponent:_fileName]
          atomically:YES]; 
```

# nhibernate - 使用 Criteria API 获取所需的属性？

> ID：13069010
> 
> 赞同：0
> 
> 时间：2012-10-25T12:50:31.380
> 
> 标签：nhibernate, c#-4.0, criteria-api

我有客户和客户地址类。CustomerAddress 类具有国家/地区 n 状态对象。当我加载客户时，我也想要 CustomerAddress 并且在 customerAddress 中我只想加载 contryName 和 countryID 其他详细信息必须为空。

简而言之，我想通过 Criteria APT 生成的 SQL 查询是

```
SELECT     Customer.Name, Country.CountryName, 
           Country.CountryID AS CountryID,    
           CustomerAddress.LocalAddressLine1
FROM       Customer INNER JOIN CustomerAddress 
           ON Customer.CustomerID = CustomerAddress.CustomerID 
           INNER JOIN Country 
           ON CustomerAddress.CountryID = Country.CountryID 
```

为了实现这一点，我做到了

```
 ICriteria criteria = session.CreateCriteria(typeof(Customer), "Customer")
              .CreateAlias("Customer.CustomerAddressList", "CustomerAddressList", NHibernate.SqlCommand.JoinType.LeftOuterJoin)
              .CreateCriteria("CustomerAddressList.Country", "Country", NHibernate.SqlCommand.JoinType.LeftOuterJoin)
              .SetProjection(Projections.ProjectionList().Add(Projections.Property("Country.CountryID"))
                                                         .Add(Projections.Property("Country.CountryName")))
                                                         .SetResultTransformer(NHibernate.Transform.Transformers.AliasToBean(typeof(Customer)))
              .Add(Restrictions.Eq("Customer.EstablishmentId", CustomerId)); 
```

但这给了我错误。怎么能这样。

**如何使用 Criteria API 获取指定的列。？**

**根据@Firo 的指导编辑**

我`.Add(Restrictions.Eq("Customer.EstablishmentId", CustomerId))`以前搬过`SetProjection`所以我的代码现在是

```
ICriteria criteria = session.CreateCriteria(typeof(Customer), "Customer")
                  .CreateAlias("Customer.CustomerAddressList", "CustomerAddressList", NHibernate.SqlCommand.JoinType.LeftOuterJoin)
                  .CreateCriteria("CustomerAddressList.Country", "Country", NHibernate.SqlCommand.JoinType.LeftOuterJoin)
                  .Add(Restrictions.Eq("Customer.EstablishmentId", CustomerId))                  
                        .SetProjection(Projections.ProjectionList().Add(Projections.Property("Country.CountryID"))
                                                         .Add(Projections.Property("Country.CountryName")))
                                                        .SetResultTransformer(NHibernate.Transform.Transformers.AliasToBean(typeof(Customer)));

customer = criteria.UniqueResult<Customer>(); 
```

这将成功执行，不会发生错误，但是当我查找`customer`对象时，它的所有属性都是`null`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T12:37:57.397

要使 AliasToBean 正常工作，您需要显式指定别名

```
.SetProjection(Projections.ProjectionList()
    .Add(Projections.Property("Country.CountryID"), "CountryID")
    .Add(Projections.Property("Country.CountryName"), "CountryName"))
    .SetResultTransformer(NHibernate.Transform.Transformers.AliasToBean(typeof(Country))); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T12:28:47.407

尽管您可以使用 Transformer 来做到这一点，但它可能不值得这样做。一方面，直接在方法中自己构造实例可能更清楚。如果您在 Criteria 实例上指定具有多个 Projections 的 ProjectionsList，那么 Hibernate 将带回 Object[] So ...

```
 List<Object[]> results = crit.SetProjection(Projections.ProjectionList()
        .Add(Projections.Property("Country.CountryID"), "CountryID")
        .Add(Projections.Property("Country.CountryName"), "CountryName")).list();

    List<Customer> customers = new ArrayList<Customer>();
    for ( Object[] row: results ) {
         Customer c = new Customer();
         c.setCountryId((Long) row[0]);
         // etc. for other properties
         customers.add(c);
    } 
```

另请参见[AliasToBeanResultTransformer(MyDTO.class) 无法实例化 MyDTO](https://stackoverflow.com/questions/9605821/aliastobeanresulttransformermydto-class-fails-to-instantiate-mydto)

# gwt - 如何在 GWT 中嗅探数据包？

> ID：13069012
> 
> 赞同：1
> 
> 时间：2012-10-25T12:50:43.190
> 
> 标签：gwt, sniffing

我正在寻找一种在 GWT 中嗅探数据包的方法，或者是否有其他方法可以执行此任务。我想根据它们的大小显示传入数据包的树形图。我认为的一种方法是使用命令行数据包嗅探工具，它将详细信息输出到文件中，该文件可以从 GWT 中读取，然后使用它来显示树形图。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-12-18T07:37:18.483

在做了一些研究并切换回这个项目之后，最简单的方法之一是借助一个可以生成文本文件的工具，该文件可以在 GWT 代码中导入。例如，tcpdump 可以在 Linux 上使用，一旦你将输出重定向到一个文件，在代码中读取该文件，然后在 GWT 代码中使用该信息

# asp.net-mvc - 使用区域的目标和好处是什么？

> ID：13069015
> 
> 赞同：11
> 
> 时间：2012-10-25T12:50:54.587
> 
> 标签：asp.net-mvc, asp.net-mvc-routing, asp.net-mvc-areas

我对使用区域的好处和它们的必要性有疑问。

我看到了一些对立面：

1.  MVC 模式有路由，它们需要脱离文件夹结构。
2.  但是当我们使用区域时，我们会创建映射到路线的文件夹。结果是我们终于又回到了文件夹结构？

确实需要 mvc 应用程序中的区域，因为它们迫使我们返回文件夹结构。

**在asp mvc 中使用领域的目标有哪些？使用领域的哪些好处。**

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-25T12:54:46.847

> ASP.NET MVC 依赖于某些文件夹和类命名约定来组织模型、视图和控制器。大型应用程序通常由功能独立的模块组成，因此主应用程序本质上是这些子应用程序的捆绑。在这种情况下，组织各种模型、视图和控制器可能很乏味。幸运的是，ASP.NET MVC 允许您将应用程序拆分为所谓的区域。每个区域都模仿 ASP.NET MVC 所需的文件夹结构和约定。
> 
> 有了适当的区域，每个模块都会复制 MVC 文件夹结构。例如，每个模块都有自己的 Models、Views 和 Controllers 文件夹。然后，您可以在 Blog 模块和 HelpDesk 模块中拥有 HomeController 类。

内容来自： http: [//www.codeguru.com/csharp/.net/net_asp/mvc/article.php/c20227/Using-Areas-in-ASPNET-MVC-Application.htm](http://www.codeguru.com/csharp/.net/net_asp/mvc/article.php/c20227/Using-Areas-in-ASPNET-MVC-Application.htm)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T13:34:20.033

**区域** *可帮助您对* **控制器** *（及其相关模型和视图）*进行分组。

在较小的应用程序中，大多数情况下您需要一个*控制器*来包装*单个模块*所需的所有操作。当模块的功能增加时（通常在大型应用程序中），您向控制器添加更多操作，显然它变成了**FAT**。那时，您开始考虑将可怜的**FAT**控制器分解成*更小*的控制器。现在这组*较小的控制器*是转变为一个*区域*的理想人选。因为现在一个模块的所有控制器、视图和模型都在一个地方，你可以*很容易地管理它们*。

# listview - 具有延迟加载图像的 Viewholder 模式

> ID：13069016
> 
> 赞同：0
> 
> 时间：2012-10-25T12:51:02.470
> 
> 标签：listview, android-listview, lazy-loading, lazy-evaluation

我正在编写一段代码，其中我有一个列表视图和一个自定义元素（项目）：relativelayout、textview、imageview 等。

```
public View getView(int position, View convertView, ViewGroup parent) {

    WindowManager wm = (WindowManager) context
            .getSystemService(Context.WINDOW_SERVICE);
    Display display = wm.getDefaultDisplay();
    int widthScreen = display.getWidth();
    int heightScreen = display.getHeight();

    if (convertView == null) {
        convertView = inflater
                .inflate(R.layout.program_specific_item, null);
        viewHolder = new ProgramInitialViewHolder();
        viewHolder.photo = (ImageView) convertView
                .findViewById(R.id.image_photo);
                .findViewById(R.id.start_time);
        viewHolder.endTime = (TextView) convertView
                .findViewById(R.id.end_time);
        viewHolder.type.setFocusable(false);
        viewHolder.endTime.setFocusable(false);
        viewHolder.startTime.setFocusable(false);
        convertView.setTag(viewHolder);
    } else {
    viewHolder = (ProgramInitialViewHolder) convertView.getTag();
    }
    final Event element = schedule.get(position);
try {

        imageLoader.DisplayImage(schedule.get(position).getPicture(),
                    viewHolder.photo);

} catch (Exception g) {
    g.printStackTrace();
}                     return convertView;        } -END- 
```

我实现了 viewHolder 模式，并尝试包含延迟加载代码以提高性能。似乎每次我向上/向下滚动时，我的图像都会被回收，并且延迟加载和自动显示图像（刷新）不起作用：我需要滚动才能以视觉方式获取图像（即使在逻辑上它们已经存在）。

那么，我应该停止使用这个 viewHolder 模式还是应该做其他事情才能成功创建我的列表视图和延迟加载？

PS：我已经检查了所有延迟加载和查看器模式的链接。

# asp.net - 尝试在 ASP.NET 中使用 HTML5 时出现错误的文档类型

> ID：13069018
> 
> 赞同：0
> 
> 时间：2012-10-25T12:51:07.333
> 
> 标签：asp.net, html, doctype

在我的 asp.net 3.5 项目中，我尝试`<!DOCTYPE html>`在母版页中将 doctype 更改为，但页面上实际呈现的是`<!DOCTYPE html PUBLIC "" "">`，这当然没有验证。

关于什么可能导致这种情况的任何提示？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T13:16:21.460

您使用的是哪个版本的 Visual Studio？如果您有 2010 SP1 或 2012，则可以从选项中选择 HTML5：

![在此处输入图像描述](../Images/6048710cab4af714d215a8fb7203db9a.png)

如果您仍然卡住，请告诉我们您在哪里声明了文档类型，并告诉我们您正在使用哪个版本的 VS。

# javascript - 在更改图像 src 时赋予淡入淡出效果

> ID：13069023
> 
> 赞同：1
> 
> 时间：2012-10-25T12:51:18.440
> 
> 标签：javascript, jquery, html

我正在使用响应式网页设计，我想在页面中滑动一些图像。我尝试了一些插件，但插件的问题是它使用宽度和高度属性，有些还分配绝对位置。所以我想用js自己改变图像的src，效果很好，但是我可以给它一些过渡效果吗？

我所做的是：

```
var i =0;
var total =2;
window.setInterval(function(){
  show_hide();
}, 1000);

function show_hide()
{
        var img=$('.image-holder img, .image-holder2 img');
        //alert(img.length);
        if(i%2==0)
        {

             img[0].src='http://digimind.com/blog/wp-content/uploads/2012/02/number2c.png';
             img[1].src='http://digimind.com/blog/wp-content/uploads/2012/02/number2c.png';

            i=0;
        }
        else
        {

             img[0].src='http://healthystartups.com/storage/600px-MA_Route_1.png?__SQUARESPACE_CACHEVERSION=1319542839834';
             img[1].src='http://healthystartups.com/storage/600px-MA_Route_1.png?__SQUARESPACE_CACHEVERSION=1319542839834';
        }

       i++;

} 
```

我的 html

```
<div  class="image-holder" >
<img src="http://healthystartups.com/storage/600px-MA_Route_1.png?__SQUARESPACE_CACHEVERSION=1319542839834"  />

</div>
<div  class="image-holder2" >
<img src="http://healthystartups.com/storage/600px-MA_Route_1.png?__SQUARESPACE_CACHEVERSION=1319542839834"  />
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T13:22:06.487

回答标题，在更改 src 的同时给一个 fadeIn/fadeOut 很容易，只需让元素 fadeOut，更改 src 并让它再次淡入。另外，我想指出，使用 jQuery，遍历这样的类会破坏使用它自己的选择器“ `.each()`”的目的

```
$('.image-holder img, .image-holder2 img').each(function() {
            $(this).fadeOut(200,function() {
                $(this).attr('src', 'http://digimind.com/blog/wp-content/uploads/2012/02/number2c.png');
                $(this).fadeIn(200);
            });
        }); 
```

[http://jsfiddle.net/tq9nV/1/](http://jsfiddle.net/tq9nV/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T12:59:36.163

将 jQuery 与`animate()`. 您还可以`show(N ms)`在其中一个图像和`hide(N ms)`另一个图像上运行。您还可以选择如何使用效果（如淡入和淡出）显示/隐藏图像。

另外，看看[http://api.jquery.com/fadeIn/](http://api.jquery.com/fadeIn/)和[http://api.jquery.com/fadeOut/](http://api.jquery.com/fadeOut/)

# sql - SQL 备份循环

> ID：13069025
> 
> 赞同：1
> 
> 时间：2012-10-25T12:51:44.217
> 
> 标签：sql, sql-server, backup

我在 SSMSE 2005 中构建了一个备份查询并保存为文本查询。

有没有办法遍历数据库并将每个都写为一个唯一的文件？

我所做的是复制/粘贴和查找/替换 database_name 并一次性运行两者。那行得通，但想要：

运行单个循环脚本，单独备份每个数据库或从 SSMSE GUI 批量备份

```
BACKUP DATABASE [ION_Data_Nov08] TO DISK =
N'C:\Documents and Settings\DB.control\Desktop\ION Database Backups\121025_0700\ION_Data_Nov08'
WITH noformat, init, name = N'ION_Data_Nov08-Full Database Backup', skip,
norewind, nounload, stats = 10 

go

DECLARE @backupSetId AS INT 

SELECT @backupSetId = position
FROM   msdb..backupset
WHERE  database_name = N'ION_Data_Nov08' 
        AND backup_set_id = (SELECT Max(backup_set_id)
                             FROM   msdb..backupset
                            WHERE  database_name = N'ION_Data_Nov08')

 IF @backupSetId IS NULL
   BEGIN
       RAISERROR(
N'Verify failed. Backup information for database ''ION_Data_Nov08'' not found.',
 16,1)
END

 RESTORE verifyonly FROM DISK =
  N'C:\Documents and Settings\DB.control\Desktop\ION Database Backups\121025_0700\ION_Data_Nov08'
 WITH FILE = @backupSetId, nounload, norewind

go 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T13:20:47.703

当然，您可以使用这样的脚本，其中包含要处理的数据库列表：

```
-- Houseclean.
set nocount on
if Object_Id( N'tempdb..#DatabasesToProcess' ) is not NULL
    drop table #DatabasesToProcess
go
declare @CurrentDateTime as DateTime = SysUTCDateTime()

-- We may wish to change the backup schedule:
--   Full backup daily.
--   Differential backup every two hours.  (12 per daily backup.)
--   Transaction log backup every 10 minutes.  (12 per differential backup.)
--   At most we should need to restore: most recent full backup, most recent differential backup, up to 12 log backups since the differential backup.

-- If this was a real emergency, we should attempt a tail-log backup to capture the last transactions from the ill database.
--   BACKUP LOG database_name TO backup_filename WITH NORECOVERY

-- NB: The compression option ("compression" or "no_compression") must be a keyword, variables are not supported.

-- Start with the list of databases to be managed and other configuration parameters.
--   IntervalSkew   lets us shift the backup cycle for each database so that we are not doing all of the full backups during the same interval.
declare @DatabaseNames as Table ( Name NVarChar(64), IntervalSkew Int )
insert into @DatabaseNames ( Name, IntervalSkew ) values
    ( N'master', 0 ), ( N'model', 0 ), ( N'msdb', 0 ), ( N'Foo', 1 ), ( N'FooElmah', 2 ), ( N'Bar', 0 )
-- Directory for the backup files.
declare @BackupDirectory as NVarChar(256) = 'C:\SQLServerBackups\'
-- Scheduled interval for this job.  We are assuming that we can get the backups done within this time.
--   NB: SQL Server Agent will not start a second instance of this job if the previous instance is still executing.
declare @MinutesPerInterval as Int = 10
-- Number of intervals between differential backups.  Two hours: 12 intervals * 10 minutes/interval.  Generates 12 differential backups/day.
declare @IntervalsPerDifferentialBackup as Int = 12
-- Number of intervals to shift daily operations from midnight UTC, e.g. 30 * 10 minutes/interval would cause the cycle to start at 05:00 UTC.
declare @IntervalOffset as Int = 30

-- It might be nice if we could use   msdb.dbo.sp_help_*   to confirm that we are scheduled to run at the correct interval.

-- Determine the backup type(s) for the current interval.
declare @CurrentDateTimeImprint as NVarChar(32) = Replace( Convert( NVarChar(19), @CurrentDateTime, 126 ), ':', '-' ) + 'Z' -- yyyy-mm-ddThh-mm-ssZ
declare @TimeOfDay as Time = @CurrentDateTime
declare @MinuteOfDay as Int = DatePart( hour, @TimeOfDay ) * 60 + DatePart( minute, @TimeOfDay )
declare @Interval as Int = ( @MinuteOfDay / @MinutesPerInterval - @IntervalOffset ) % ( 24 * 60 / @MinutesPerInterval )

print 'Pass started: ' + Convert( VarChar(23), @CurrentDateTime, 126 ) +
    ', Interval #: ' + Convert( VarChar(4), @Interval ) + ' (Offset ' + Convert( VarChar(4), @IntervalOffset ) + ')'

-- Get the metadata for the databases.
select d.name, d.recovery_model_desc, d.state_desc, drs.last_log_backup_lsn, DNs.IntervalSkew
    into #DatabasesToProcess
    from @DatabaseNames as DNs inner join
        sys.databases as d on d.name = DNs.Name inner join
        sys.database_recovery_status as drs on drs.database_id = d.database_id
declare @name as sysname
declare @recovery_model_desc as nvarchar(60) 
declare @state_desc as nvarchar(60)
declare @last_log_backup_lsn as numeric(25,0)
declare @IntervalSkew as Int

-- Process the databases.
declare @FullBackup as Bit
declare @DifferentialBackup as Bit
declare @LogBackup as Bit
declare @Database as NVarChar(128)
declare @BackupType as NVarChar(16)
declare @TargetFile as NVarChar(128)
declare DB cursor for
    select name, recovery_model_desc, state_desc, last_log_backup_lsn, IntervalSkew
        from #DatabasesToProcess
        order by name
open DB
fetch next from DB into @name, @recovery_model_desc, @state_desc, @last_log_backup_lsn, @IntervalSkew
while @@Fetch_Status = 0
    begin
    -- Process the database.
    set @Interval = ( @MinuteOfDay / @MinutesPerInterval - @IntervalOffset - @IntervalSkew ) % ( 24 * 60 / @MinutesPerInterval )
    set @FullBackup = case when @Interval = 0 then 1 else 0 end
    set @DifferentialBackup = case
        when @name = N'master' then 0 -- The   master   database does not support differential backups.
        when @Interval > 0 and @Interval % @IntervalsPerDifferentialBackup = 0 then 1
        else 0 end
    set @LogBackup = case
        when @recovery_model_desc = N'SIMPLE' then 0
        when @Interval % @IntervalsPerDifferentialBackup != 0 then 1
        else 0 end

    print '> Database: ' + @name + ', Recovery Model: ' + @recovery_model_desc + ', State: ' + @state_desc +
        ', Last Log LSN: ' + Coalesce( Convert( VarChar(32), @last_log_backup_lsn ), 'n/a' ) + ', Skew: ' + Convert( VarChar(4), @IntervalSkew ) +
        ', Adjusted Interval #: ' + Convert( VarChar(4), @Interval ) + 
        ', Full Backup: ' + case when @FullBackup = 1 then 'YES' else 'NO' end +
        ', Differential Backup: ' + case when @DifferentialBackup = 1 then 'YES' else 'NO' end +
        ', Log Backup: ' + case when @LogBackup = 1 then 'YES' else 'NO' end

    if @FullBackup = 1
        begin
        set @BackupType = 'FULL'
        set @TargetFile = @BackupDirectory + @name + '_' + @CurrentDateTimeImprint + '_' + @BackupType + '.bak'
        print '> > Backup Type: ' + @BackupType + ', Target File: ' + @TargetFile + ', Starting: ' + Convert( VarChar(23), SysUTCDateTime(), 126 ) + 'Z'
        backup database @name to disk = @TargetFile with init, skip, checksum, compression
        end

    if @DifferentialBackup = 1
        begin
        set @BackupType = 'DIFF'
        set @TargetFile = @BackupDirectory + @name + '_' + @CurrentDateTimeImprint + '_' + @BackupType + '.bak'
        print '> > Backup Type: ' + @BackupType + ', Target File: ' + @TargetFile + ', Starting: ' + Convert( VarChar(23), SysUTCDateTime(), 126 ) + 'Z'
        backup database @name to disk = @TargetFile with differential, init, skip, checksum, compression
        end

    if @LogBackup = 1
        begin
        set @BackupType = 'TLOG'
        set @TargetFile = @BackupDirectory + @name + '_' + @CurrentDateTimeImprint + '_' + @BackupType + '.bak'
        print '> > Backup Type: ' + @BackupType + ', Target File: ' + @TargetFile + ', Starting: ' + Convert( VarChar(23), SysUTCDateTime(), 126 ) + 'Z'
        begin try
            backup log @name to disk = @TargetFile with init, checksum
        end try
        begin catch
            print '> > ERROR: ' + Error_Message() + ' (' + Convert( VarChar(12), Error_Number() ) + ')'
        end catch
        end

    fetch next from DB into @name, @recovery_model_desc, @state_desc, @last_log_backup_lsn, @IntervalSkew
    end
close DB
deallocate DB
drop table #DatabasesToProcess

print 'Pass completed: ' + Convert( VarChar(23), SysUTCDateTime(), 126 ) + 'Z' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T13:16:52.473

看看[SSMS 工具包](http://www.ssmstoolspack.com/)。对于低于 2012 的版本，它是免费的，让您可以轻松地对多个目标数据库运行查询。

*免责声明：除了作为过去几年的用户之外，我对这个工具没有任何兴趣。*

# javascript - 如何像引用数组一样引用自定义数据结构？

> ID：13069028
> 
> 赞同：2
> 
> 时间：2012-10-25T12:51:47.300
> 
> 标签：javascript

> **可能重复：**
> [Javascript 自定义索引访问器](https://stackoverflow.com/questions/10905787/javascript-custom-index-accessor)

如果我要在 Javascript 中编写一个双向链表对象，有没有办法像数组一样引用这个新列表？

例如，如果我想要节点 5 的值，我想查询

```
newLinkedList[5] 
```

而不是做我一直在做的事情，就像

```
newLinkedList.getNode(5) 
```

基本上，有没有办法“美化”对自定义数据结构的引用，还是每次都必须将其作为自定义函数？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T12:59:01.120

Javascript 中的数组实际上只是对数值属性进行特殊处理的对象。您可以自己完成同样的事情，但目前 Javascript 没有提供简单的机制来透明地双向访问这些索引；您必须使用命名方法处理添加和删除对象，但您仍然可以从使用类似数组的索引读取它们中受益。

这是一个简单的自定义“Arrayish”对象的示例：

```
var ll_array = {};

ll_array.length = 0;

ll_array.addNode = function (newNode) {
    this[this.length] = newNode;
    this.length++;
};

ll_array.addNode('Foo');
ll_array.addNode('Bar');
console.log('Length: ' + ll_array.length);
console.log(ll_array);
console.log(ll_array[0]); 
```

​</p>

[http://jsfiddle.net/rbmsJ/1/](http://jsfiddle.net/rbmsJ/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T13:18:23.070

从你的问题：

1.  对象保存在双链表中。
2.  您知道获取第 n 个元素的 getNode(int n) 方法。

没有办法让您获得具有数组样式 [n] 的第 n 个元素。因为链表不是数组，链表中的元素是相互链接的，这种数据结构不同于普通的数组或 JavaScript 风格的数组：命名属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T13:02:55.973

遍历列表的蛮力方法，然后将遍历中的每个项目分配给数组元素，这是首先想到的：

假装你有一个 LinkedList 对象。我们还假设有用于迭代列表的方法，称为 Head 和 Next。现在，需要注意的是，这完全未经测试，您可以通过以下方式创建一个原型 toArray() 方法：

```
LinkedList.prototype.toArray() = function () {   var array={};
                                                 var currentItem = list.head; 
                                                 while (currentItem!=null){
                                                     array.addNode(currentItem);
                                                     currentItem=currentItem.Next;
                                                 }
                                                 return array;
                                              } 
```

显然这必须允许其他假定函数，但想法是遍历链表，并将对每个元素的引用放入数组中，然后返回它。希望在某种程度上有所帮助。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-10-25T13:25:01.883

数组是没有链接的双链表。向右遍历只需增加索引，向左遍历则减少索引。

您可以自己编写一组函数来执行基本的列表操作，并且仍然可以使用简单的索引来访问任何任意元素。

# php - Sphinx API (PHP) - 最多只返回 20 个“显示匹配”

> ID：13069029
> 
> 赞同：3
> 
> 时间：2012-10-25T12:51:48.460
> 
> 标签：php, sphinx

我已经安装了最新版本的 Sphinx（与 Sphinx PHP API 一起使用）它所有的设置和配置都正确 AFAIK 但是当我使用搜索守护程序时，无论我选择什么关键字，我总是最多得到“20 个显示匹配”

有我需要更改的设置吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T14:46:10.397

根据文档：

“有两个地方施加了每个查询最多 1000 个匹配项的默认限制。

首先，在服务器端，您必须更改**sphinx.conf中的****max_matches**设置，然后重新启动 searchd。（对于 0.9.9 及更高版本，您可以简单地使用 SIGHUP 重新加载配置文件。）

 **其次，SetLimits() API 调用的第三**个****参数**也默认为 1000，并且必须提高。（对于 SphinxSE，使用“maxmatches”选项。）“

 **文档链接：[http ://sphinxsearch.com/info/faq/#max-matches](http://sphinxsearch.com/info/faq/#max-matches)

希望这会有所帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-03-23T17:29:49.183

max_matches 仅允许 Sphinx 整体获取更多结果，但不会**显示**更多结果。

为此，您应该使用参数“限制”，例如：

```
SELECT * ...
WHERE query = "keyword;limit=1000"; 
```****

# java - GWT 等待 setVisibleRangeAndClearData 完成

> ID：13069034
> 
> 赞同：2
> 
> 时间：2012-10-25T12:51:59.913
> 
> 标签：java, gwt, synchronization, rpc, gwt-celltable

这是 GWT 中经典的“等待 rpc 调用问题”的变体。

我在 GWT 中完成了一个完整的 CRUD 屏幕，调用 RPC 来攻击 Oracle 数据库。它有一个用于搜索条件和结果表的面板，另一个用于详细信息字段。我根据需要交换两者的可见性。

结果表是一个 CellTable，我调用“setVisibleRangeAndClearData”方法来填充表，该表负责分页、列排序等（例如，当我从更新 RPC 调用返回时，我保持我来的范围从）。

我曾经通过将“后代码”放在 RPC 调用的“onSuccess”块中（即交换面板）来进行“同步”，但是当调用“setVisibleRangeAndClearData”时，cellTable 本身会启动另一个 RPC 调用以获取新的我无法控制的数据。所以，发生的事情是我交换了面板（这是立即的），然后用户看到表数据更新，这很难看。

所以问题是：我该如何控制它？当“setVisibleRangeAndClearData”完成时，我如何等待或被调用？

提前致谢，

大卫

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T17:10:19.170

1.  立即显示表格然后用数据填充它并不难看 - 事实上，从 UI 角度来看，这是正确的解决方案。用户期望他们的操作立即产生结果，并在按下按钮后立即向他们显示加载指示器是正确的方法。

2.  CellTable 有两种您可能会觉得有用的方法：

setLoadingIndicator() - 你的表格应该显示它，直到数据到达；

onLoadingStatusChange()。

# c++ - 我将如何更简洁地编写这个基本的 C++ 程序，以更高效地运行或返回更精确的数字？

> ID：13069042
> 
> 赞同：1
> 
> 时间：2012-10-25T12:52:22.573
> 
> 标签：c++

它应该评估 e^pi - pi。

```
#include <iostream>
#include <cmath>
#include <iomanip>

using namespace std;
long double Pie();
long double Factorial(double n);
long double E();

int main()
{
    long double answer = pow(E(),Pie()) - Pie();
    cout << setprecision(20);
    cout << answer;

    return 0;
}
long double Pie()
{
    long double a = 1;
    long double b = (1 / sqrtl(2));
    long double t = (1.0 / 4.0);
    long double p = 1;

    long double aPlaceholder;
    for (int i = 1; i < 5; i++)
    {
        aPlaceholder = a;
        a = (a + b) / 2;
        b = sqrtl(aPlaceholder * b);
        t = t - p * (aPlaceholder - a) * (aPlaceholder - a);
        p = 2 * p;
    }
    long double nicePie;
    nicePie = (a + b) * (a + b) / (4 * t);
    return nicePie;
}

long double E()
{
    long double e = 0;
    for(double i = 0; i < 20; i++)
    e += 1.0 / Factorial(i);
    return e;
}

long double Factorial(double n)
{
    if(n == 0)
    return 1;
    int i = n - 1;
    while (i > 0)
    {
      n *= i;
      i--;
    }
    return n;
} 
```

场景是我想评估 e，将其提升到 pi 的幂，然后从结果中减去 pi，然后将答案打印到屏幕上。该场景的另一个方面是这是一个基本的 C++ 程序。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T12:59:15.043

`cmath`提供***π***和***e***作为预定义常量，`M_PI`并且`M_E`在 的精度范围内准确`double`，但 C++ 标准并非强制要求。

你可以做`double pi = acos(-1);`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-25T13:06:21.220

*   `<cmath>`提供`double long exp(double long)`：[http](http://www.cplusplus.com/reference/clibrary/cmath/exp/) ://www.cplusplus.com/reference/clibrary/cmath/exp/以及`M_PI`双精度的 Pi 常数。
*   Boost 提供`long double`精确的 Pi：
    `const long double pi = boost::math::constants::pi<long double>();`

话虽如此，您的代码中有一些演算，您在不需要时多次执行：

*   `Pie`被调用两次。
*   In `E()`,`Factorial`在每次迭代时调用，而您可以将先前的结果与 相乘`i`。

.

```
long double E()
{
  long double e = 0;
  long double fact_i = 1;
  for(double i = 1; i < 20; i++)
  {
    fact_i *= i;
    e += 1.0 / fact_i;
  }
  return e;
} 
```

# java - html webview中的奇怪字符

> ID：13069043
> 
> 赞同：5
> 
> 时间：2012-10-25T12:52:28.460
> 
> 标签：java, android, html, utf-8, webview

我正在开发一个打开网页的 android 项目。如果用户没有互联网连接，我有一个听众。我没有显示标准的“找不到页面”，而是为 webview 提供了一个存储在我的资产文件夹中的本地 html 文件。通过这行代码：

```
web.loadUrl("file:///android_asset/html/404error.html"); 
```

在 HTML 文件中，我认为编码？是“utf-8”，如果相关的话，它会用javascript说一些东西。

一切正常，除了显示“ÅÄÖ”时，所有这些字符都被替换为“？”

有人知道解决方案吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T13:20:42.477

浏览器/Webview需要被告知文档是什么编码，否则会*猜测*一些编码或者使用默认的，可能会出错。通常，您使用 HTTP 标头传达编码。如果您从本地存储打开文件，显然不涉及 HTTP。因此，您需要使用在文档标题本身中指定编码

```
<meta http-equiv="Content-Type" content="text/html; charset=ENCODING HERE"> 
```

或者，对于 HTML 5 文档：

```
<meta charset="ENCODING HERE"> 
```

确保声明与文档的实际编码方式相匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T13:09:19.737

最近我也遇到了和你现在一样的问题。我通过将 HTML 文件中的特殊字符更改为它们各自的 HTML 代码来解决它。您可以在 google 上获取特殊字符的所有相应 HTML 代码，但此[链接](http://www.ascii.cl/htmlcodes.htm)可能会对您有所帮助。

# javascript - 从 JSON 数组对象转换为高图数组？

> ID：13069049
> 
> 赞同：3
> 
> 时间：2012-10-25T12:52:42.253
> 
> 标签：javascript, json

我正在使用 highchart 插件开发图表。用于为图表提供动态输入。因此，我需要将 JSON 格式更改为 Array。如何使用 javascript 将 JSON 数组对象格式更改为 Array？

```
[
        {
            "scoreCount": "108",
            "legendDesc": "Excellent ",
            "colorPatchCode": "#009900"
        },
        {
            "scoreCount": "20",
            "legendDesc": "Fail ",
            "colorPatchCode": "#FF0000"
        }
    ] 
```

转换数组格式，如

```
[
        [
            "scoreCount": "108",
            "legendDesc": "Excellent ",
            "colorPatchCode": "#009900"
        ],
        [
            "scoreCount": "20",
            "legendDesc": "Fail ",
            "colorPatchCode": "#FF0000"
        ]
    ] 
```

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T12:54:25.607

```
[
            "scoreCount": "108",
            "legendDesc": "Excellent ",
            "colorPatchCode": "#009900"
        ], 
```

不是有效的结构。数组可以包含单个元素。native 或包含另一个项目（属性）或数组的对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T13:12:08.030

如果试试这个怎么办：

```
var arr = [
        {
            "scoreCount": "108",
            "legendDesc": "Excellent ",
            "colorPatchCode": "#009900"
        },
        {
            "scoreCount": "62",
            "legendDesc": "Good ",
            "colorPatchCode": "#99CC00"
        },
        {
            "scoreCount": "55",
            "legendDesc": "Acceptable ",
            "colorPatchCode": "#FFFF00"
        },
        {
            "scoreCount": "31",
            "legendDesc": "Poor ",
            "colorPatchCode": "#FF9900"
        },
        {
            "scoreCount": "20",
            "legendDesc": "Fail ",
            "colorPatchCode": "#FF0000"
        }
    ];

for (i = 0;i<arr.length;i++) {
    var a = [];
    for (n in arr[i]) {
        a[n] = arr[i][n];
    }
    arr[i] = a;
}

for (i = 0;i<arr.length;i++) {
    alert(arr[i]['scoreCount']);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T13:08:42.620

[http://jsfiddle.net/sPN7z/](http://jsfiddle.net/sPN7z/)

```
var source = [
    {
        "scoreCount": "108",
        "legendDesc": "Excellent ",
        "colorPatchCode": "#009900"
    },
    {
        "scoreCount": "62",
        "legendDesc": "Good ",
        "colorPatchCode": "#99CC00"
    },
    {
        "scoreCount": "55",
        "legendDesc": "Acceptable ",
        "colorPatchCode": "#FFFF00"
    },
    {
        "scoreCount": "31",
        "legendDesc": "Poor ",
        "colorPatchCode": "#FF9900"
    },
    {
        "scoreCount": "20",
        "legendDesc": "Fail ",
        "colorPatchCode": "#FF0000"
    }
];

var out = [];

for (var i = 0; i < source.length; i++) {
    var tmp = [];
    for (var i2 in source[i]) {
        tmp.push(source[i][i2]);
    }
    out.push(tmp);
} 
```

然后将是：

```
[
    ["108","Excellent ","#009900"],
    ["62","Good ","#99CC00"],
    ["55","Acceptable ","#FFFF00"],
    ["31","Poor ","#FF9900"],
    ["20","Fail ","#FF0000"]
] 
```

正如其他人已经说过的那样..您不能将键值存储在javascript数组中。这就是 json 的用途。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-26T04:22:42.033

您可以使用 javascript 的面向对象功能以更简洁的方式完成此任务。

 `> `var jsonArray = [
>    {
>      "scoreCount": "108",
>      "legendDesc": "Excellent ",
>      "colorPatchCode": "#009900"
> },
> {
>      "scoreCount": "62",
>      "legendDesc": "Good ",
>      "colorPatchCode": "#99CC00"
> },
> {
>      "scoreCount": "55",
>      "legendDesc": "Acceptable ",
>      "colorPatchCode": "#FFFF00"
> },
> {
>      "scoreCount": "31",
>      "legendDesc": "Poor ",
>      "colorPatchCode": "#FF9900"
> },
> {
>      "scoreCount": "20",
>      "legendDesc": "Fail ",
>      "colorPatchCode": "#FF0000"
> }
> ];` 
> 
> `function MyJsObject(scoreCount, legendDesc, colorPatchCode) {
>      this.scoreCount = scoreCount;
>      this.legendDesc = legendDesc;
>      this.colorPatchCode = colorPatchCode;
> }
> 
> function createJSArray() {
>      var jsArray = new Array();
>      for(i = 0; i < jsonArray.length; i++) {
>          var m = new MyJsObject(jsonArray[i].scoreCount,                         jsonArray[i].legendDesc, jsonArray[i].colorPatchCode);
>          jsArray[i] = m;
>      }
>      alert(jsArray[4].scoreCount);***//access any object like this***
> }`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-25T15:00:22.017

虽然语法是错误的，但如果你愿意，无论如何你都可以制作这种格式的字符串。

但是，如您所知，您无法将其读回 JavaScript 变量。`

# javascript - 在更改图像 src 时赋予 fideIn fadeOut 效果

> ID：13069052
> 
> 赞同：0
> 
> 时间：2012-10-25T12:52:45.430
> 
> 标签：javascript, jquery, html

我正在使用响应式网页设计，我想将一些图像滑入页面。我尝试了一些插件，但插件的问题是它使用 width 和 height 属性并且还分配`position: absolute`. 所以我想`src`用js自己改变图像的效果，效果很好，但是我可以给它一些过渡效果吗？

[演示小提琴](http://jsfiddle.net/an7Fd/)

我所做的是：

```
var i = 0;
var total = 2;
window.setInterval(function() {
    show_hide();
}, 1000);

function show_hide() {
    var img = $('.image-holder img, .image-holder2 img');
    //alert(img.length);
    if (i % 2 == 0) {
        img[0].src = 'http://digimind.com/blog/wp-content/uploads/2012/02/number2c.png';
        img[1].src = 'http://digimind.com/blog/wp-content/uploads/2012/02/number2c.png';
        i = 0;
    }
    else {
        img[0].src = 'http://healthystartups.com/storage/600px-MA_Route_1.png?__SQUARESPACE_CACHEVERSION=1319542839834';
        img[1].src = 'http://healthystartups.com/storage/600px-MA_Route_1.png?__SQUARESPACE_CACHEVERSION=1319542839834';
    }
    i++;
} 
```

我的HTML如下：

```
<div  class="image-holder" >
    <img src="http://healthystartups.com/storage/600px-MA_Route_1.png?__SQUARESPACE_CACHEVERSION=1319542839834"  />
</div>
<div  class="image-holder2" >
    <img src="http://healthystartups.com/storage/600px-MA_Route_1.png?__SQUARESPACE_CACHEVERSION=1319542839834"  />
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T13:17:00.300

这是我放在一起的。[jsFiddle](http://jsfiddle.net/TheJoeFletch/fpp5d/)

javascript

```
var img = $(".image-holder img")
var i = 0;
var count = img.length - 1;

setInterval(function() {
    showImage(i);
    i++;
    if (i > count) i = 0;
}, 2000);

function showImage(i) {
    img.eq(i - 1).animate({
        "opacity": "0"
    }, 1000);
    img.eq(i).animate({
        "opacity": "1"
    }, 1000);
}​ 
```

HTML

```
<div  class="image-holder" >
<img src="http://healthystartups.com/storage/600px-MA_Route_1.png?__SQUARESPACE_CACHEVERSION=1319542839834"  />

</div>
<div  class="image-holder" >
<img src="http://digimind.com/blog/wp-content/uploads/2012/02/number2c.png"  />
</div>​ 
```

CSS

```
.image-holder img{ opacity: 0;}
.image-holder { position: absolute; } 
```

# asp.net - Visual Studio 2010 和 2012 ASP.Net 调试和布局问题

> ID：13069055
> 
> 赞同：3
> 
> 时间：2012-10-25T12:52:56.260
> 
> 标签：asp.net, visual-studio-2010, visual-studio-2012

我的机器上安装了 Visual Studio 2010 Ultimate 版本，并且我一直在使用 ASP.NET（我的工作）。我最近安装了 Visual Studio 2012 来测试它。注意到在安装 VS 2012、单元测试等之后，我在 VS 2010 上遇到了一些问题。

无论如何，我在 2012 年一直在调试和测试 ASP.NET 页面以进行测试。回到 VS 2010 上进行调试和测试，结果一切都出错了！有时它会调试，大多数时候它不会调试，而且当它调试时，布局和格式是非常错误的。

在我员工的机器上尝试了 ASP.NET 项目，它运行良好，布局正确。（他们使用 VS 2010）

我已经完全卸载了 VS 2012 并尝试在 VS 2010 中进行调试和测试，但我仍然遇到同样的问题！我也重新安装了 VS 2010 两次，但仍然无法正常工作。

有人知道它有什么问题吗？或者我还能做些什么来确保在我尝试再次重新安装之前正确卸载 VS 2010 和 2012 的东西？

谢谢你的时间..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-27T12:05:06.867

创建一个虚拟机并安装VS2010。在全新安装中，它应该可以正常工作。否则，VS2012 可能会对您的代码进行一些更改。我不会丢弃它 -¿config 文件？¿ 新版本的捆绑网络服务器？¿ 新功能？-。一旦您因新版本而放弃了代码更改，请尝试使用您喜欢的卸载软件并删除 VS2012...

# android - 编译 ICS/JB 相机应用程序 - 本机库 jni-mosaic 错误

> ID：13069056
> 
> 赞同：3
> 
> 时间：2012-10-25T12:52:56.590
> 
> 标签：android, android-ndk, java-native-interface, android-camera

我想使用 ICS/JB 相机应用程序具有的全景模式。我已经下载了源代码（带有资源）并设法解决了所有代码编译错误，但是一旦我在我的设备上启动应用程序（运行 JB），我就会收到这个错误：

```
10-25 14:42:53.617: E/AndroidRuntime(23147): FATAL EXCEPTION: GLThread 2586
10-25 14:42:53.617: E/AndroidRuntime(23147): java.lang.UnsatisfiedLinkError: Native method not found: com.app.camera.panorama.MosaicRenderer.reset:(IIZ)V
10-25 14:42:53.617: E/AndroidRuntime(23147):    at com.app.camera.panorama.MosaicRenderer.reset(Native Method)
10-25 14:42:53.617: E/AndroidRuntime(23147):    at com.app.camera.panorama.MosaicRendererSurfaceViewRenderer.onSurfaceChanged(MosaicRendererSurfaceViewRenderer.java:49)
10-25 14:42:53.617: E/AndroidRuntime(23147):    at android.opengl.GLSurfaceView$GLThread.guardedRun(GLSurfaceView.java:1505)
10-25 14:42:53.617: E/AndroidRuntime(23147):    at android.opengl.GLSurfaceView$GLThread.run(GLSurfaceView.java:1240) 
```

我确实有一个 libjni-mosaic 库，位于 armeabi-v7a/armeabi/x86 中，它似乎可以很好地加载它，但它可能不包含 MosaicRenderer 实现的方法。

我也尝试编译 CyanogenMod 相机应用程序[https://github.com/CyanogenMod/android_packages_apps_Camera/tree/ics](https://github.com/CyanogenMod/android_packages_apps_Camera/tree/ics)但我得到了同样的错误......

相机本身可以用于静止图像和视频录制，但是一旦我更改为全景模式，它就会崩溃。

谁能指出我正确的 jni-mosaic lib 或者我做错了什么？为了让我的应用程序使用 JNI/SO 文件，我需要做些什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-27T03:04:23.680

您将 Java 类 MosaicRenderer 移动到包`com.app.camera.panorama`中，但该`mosaic_renderer_jni.cpp`文件仍然具有引用的本机方法`com.android.camera.panorama`，例如

```
JNIEXPORT void Java_com_android_camera_panorama_MosaicRenderer_reset( 
```

您应该更改本机代码中的函数名称以反映新的包名称，例如

```
JNIEXPORT void Java_com_app_camera_panorama_MosaicRenderer_reset( 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-07T13:11:26.523

如果有人仍然对构建谷歌的原生相机应用程序感兴趣，我建议你这个存储库[https://android.googlesource.com/platform/packages/apps/Camera2/](https://android.googlesource.com/platform/packages/apps/Camera2/)它不需要构建所有 android OS 代码。它对我很有帮助很多。

# google-maps - 将谷歌地图自动完成位置存储到数据库中

> ID：13069058
> 
> 赞同：2
> 
> 时间：2012-10-25T12:53:00.083
> 
> 标签：google-maps

我已将 Google 地图自动完成功能集成到我的应用程序中。当用户键入 koramangala 时。他会得到完整的地址。这是注册的一部分。

```
 Can you please guide is it legal to store Google map auto complete address into my application?.

 If it is not legal can any one tell me how i can proceed.(Instead of storing country,city,state all into my database). 
```

谢谢和问候， Gokul

# ruby-on-rails - 为什么会发生此错误，我的服务器未启动且站点已关闭？

> ID：13069059
> 
> 赞同：0
> 
> 时间：2012-10-25T12:53:00.747
> 
> 标签：ruby-on-rails, ruby-on-rails-3, apache2, passenger

在我的 Rails 应用程序中，我正在使用

```
Apache + ruby 1.9.2p180 + Rails 3.0.5 + Phusion Passenger version 3.0.13 
```

这是我的错误

> 此应用程序进程当前以用户“nobody”和组“nobody”的身份运行，并且必须能够访问其应用程序根目录“/home/mystore /mystore”。然而，父目录 '/home/mystore' 有错误的权限，从而阻止了这个进程访问它的应用程序根目录。请先修复目录'/home/mystore'的权限。

当我查看我的应用程序时，它是空的，但我的数据库从 spree 中获取了样本。什么似乎是问题？

请有人帮助我

我正在使用 ruby​​ 1.9.2p180 Rails 3.0.5 Phusion Passenger 版本 3.0.13

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T10:19:10.470

我在上面找到了解决方案。它的发生是由于

```
PassengerUserSwitching on 
```

在乘客配置文件中。

我把它转向它`off`，它对我有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-11-15T12:32:20.997

如果您在 Rails 5 + Apache2 中遇到此问题，请将以下 2 [Passenger Security Option](https://www.phusionpassenger.com/library/config/apache/reference/#passengerdefaultuser)添加到您的 Apache 配置文件中：

```
PassengerDefaultUser username
PassengerDefaultGroup username 
```

然后重新启动 Apache 服务器。

# sharepoint - 在 sharepoint 2010 中创建和添加事件接收器

> ID：13069060
> 
> 赞同：0
> 
> 时间：2012-10-25T12:53:01.310
> 
> 标签：sharepoint, sharepoint-2010, sharepoint-workflow

如何创建和添加事件接收器。我需要授予查看我在 SPList 中添加的项目的权限。同样，我不应该授予在同一个 SPList 中查看我的项目的权限。我必须以编程方式设置权限..请帮助我..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T11:39:31.163

请参阅[在 Visual Studio 2010 中创建 SharePoint 2010 事件接收器](http://msdn.microsoft.com/en-us/library/gg252010.aspx)。

在 ItemAdded 中，您可以调用[BreakRoleInheritance(false)](http://msdn.microsoft.com/en-us/library/ee550474.aspx) on`properties.ListItem`以启用项目的自定义权限并清除现有权限。然后，您可以使用如下代码添加新的权限设置：

```
public void AddRoleAssignment(SPWeb web, SPUser user, SPListItem item, SPRoleType roleType)
{
    SPRoleDefinition role = web.RoleDefinitions.GetByType(roleType);
    SPRoleAssignment assignment = new SPRoleAssignment(user);
    assignment.RoleDefinitionBindings.Add(role);
    item.RoleAssignments.Add(assignment);
} 
```

# java - XSLT 跳过重复元素

> ID：13069062
> 
> 赞同：4
> 
> 时间：2012-10-25T12:53:04.883
> 
> 标签：java, xml, transformation, xslt

我是 XSLT 的初学者。

我的源 XML 如下：

```
<Passengers>
    <Passenger type="A" id="P1"/>
    <Passenger type="A" id="P2"/>
    <Passenger type="B" id="P3"/>
    <Passenger type="C" id="P4"/>
</Passengers> 
```

输出应如下所示：

```
<Pax_Items>
     <Item>
         <Type>A</Type>
         <Count>2</Count>
     </Item>
     <Item>
         <Type>B</Type>
         <Count>1</Count>
     </Item>
     <Item>
         <Type>C</Type>
         <Count>1</Count>
     </Item>
</Pax_Items> 
```

我创建了如下 XSLT

```
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    version="1.0" exclude-result-prefixes="xmlns">

    <xsl:output method="xml" indent="yes" omit-xml-declaration="yes" />
        <xsl:variable name="filter" select="'TK,AJ'"/>

    <xsl:template match="Passengers">
        <xsl:element name="Pax_Items">
            <xsl:apply-templates select="Passenger"/>
        </xsl:element>
    </xsl:template>

        <xsl:template match="Passenger">
              <xsl:element name="Item">
                     <xsl:element name="Type">
                           <xsl:value-of select="@type"/>
                     </xsl:element>
                     <xsl:element name="Count">
                           <xsl:value-of select="count(//Passenger[@type=current()/@type])"/>
                     </xsl:element>
              </xsl:element>
    </xsl:template>
</xsl:stylesheet> 
```

使用上面的 XSLT，我得到了以下输出：

```
<Pax_Items>
  <Item>
    <Type>A</Type>
    <Count>2</Count>
  </Item>
  <Item>
    <Type>A</Type>
    <Count>2</Count>
  </Item>
  <Item>
    <Type>B</Type>
    <Count>1</Count>
  </Item>
  <Item>
    <Type>C</Type>
    <Count>1</Count>
  </Item>
</Pax_Items> 
```

我怎样才能省略或跳过重复的元素？请帮忙。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-25T13:24:12.177

这实际上是分组问题的一个很好的例子。在 XSLT1.0 中，进行分组的最有效方法是使用一种称为“Muenchian Grouping”的技术，因此可能值得学习这一点。

在这种情况下，您希望通过其**@type属性对****乘客**元素进行分组，因此您将定义一个键来执行此操作

 **```
<xsl:key name="Passengers" match="Passenger" use="@type"/> 
```

然后，您需要为其**@type**属性选择恰好是该元素在组中第一次出现的**Passenger元素。**这是按如下方式完成的：

 **```
<xsl:apply-templates 
    select="Passenger[generate-id() = generate-id(key('Passengers', @type)[1])]"/> 
```

注意**generate-id**的使用，它为一个节点生成一个唯一的 ID，允许比较两个节点。

然后，要计算组中出现的次数，很简单

```
<xsl:value-of select="count(key('Passengers', @type))"/> 
```

这是完整的 XSLT

```
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
   <xsl:output method="xml" indent="yes" omit-xml-declaration="yes"/>
   <xsl:key name="Passengers" match="Passenger" use="@type"/>

   <xsl:template match="Passengers">
      <Pax_Items>
         <xsl:apply-templates select="Passenger[generate-id() = generate-id(key('Passengers', @type)[1])]"/>
      </Pax_Items>
   </xsl:template>

   <xsl:template match="Passenger">
      <Item>
         <Type>
            <xsl:value-of select="@type"/>
         </Type>
         <Count>
            <xsl:value-of select="count(key('Passengers', @type))"/>
         </Count>
      </Item>
   </xsl:template>
</xsl:stylesheet> 
```

应用于您的示例 XML 时，将输出以下内容

```
<Pax_Items>
   <Item>
      <Type>A</Type>
      <Count>2</Count>
   </Item>
   <Item>
      <Type>B</Type>
      <Count>1</Count>
   </Item>
   <Item>
      <Type>C</Type>
      <Count>1</Count>
   </Item>
</Pax_Items> 
```

另请注意，没有真正的理由使用**xsl:element**来输出静态元素。直接写出元素即可。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T13:10:13.187

`passenger`如下更新您的模板；我添加了 if 条件来检查重复节点，

```
<xsl:template match="Passenger">
    <xsl:if test="not(preceding-sibling::Passenger[@type = current()/@type])">
      <xsl:element name="Item">
        <xsl:element name="Type">
          <xsl:value-of select="@type"/>
        </xsl:element>
        <xsl:element name="Count">
          <xsl:value-of select="count(//Passenger[@type=current()/@type])"/>
        </xsl:element>
      </xsl:element>
    </xsl:if>
  </xsl:template> 
```****

# java - 在部署时编译所有jsp

> ID：13069067
> 
> 赞同：1
> 
> 时间：2012-10-25T12:53:31.173
> 
> 标签：java, jsp, webserver, weblogic

我希望在部署时编译所有 .jsp 文件，而不是在首次访问时编译。任何人都知道如何以与网络服务器无关的方式（通过 web.xml 可能？）。如果没有办法通过项目配置来做到这一点，我想知道如何在 Weblogic 上做到这一点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T13:00:16.123

您可以将服务器设置为在部署时预编译 JSP。请参阅[WebLogic JSP 参考](http://docs.oracle.com/cd/E13222_01/wls/docs81/jsp/reference.html)中的预编译 JSP 部分。从那里：

> 您可以将 WebLogic Server 配置为在部署或重新部署 Web 应用程序时或在 WebLogic Server 启动时预编译 JSP，方法是在 weblogic.xml 部署描述符的元素中将 precompile 参数设置为 true。为避免在每次服务器重新启动以及针对其他服务器时重新编译 JSP，请使用 weblogic.jspc 预编译它们并将它们放在 WEB-INF/classes 文件夹中并将它们存档在 .war 文件中。将源文件保存在与归档的 .war 文件不同的目录中将消除由于 JSP 依赖于类文件之一而导致错误的可能性。
> 
> 有关 web.xml 部署描述符的更多信息，请参阅 [组装和配置 Web 应用程序](http://docs.oracle.com/cd/E13222_01/wls/docs81/webapp/index.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T11:01:15.660

对于 weblogic，这里有两种方法（[http://m-button.blogspot.com.es/2008/09/using-jsp-precompilation-in-weblogic.html](http://m-button.blogspot.com.es/2008/09/using-jsp-precompilation-in-weblogic.html)）。我更喜欢在构建时这样做，因为它不会影响应用程序部署时间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-25T13:00:45.503

完成此操作的一种方法是将`jsp_precompile`作为请求参数添加到所需的 jsp，如

```
http://localhost/myApp/desired_page.jsp?jsp_precompile=true 
```

我个人并不提倡在请求中如此明显地发送这样的系统配置参数，因此您应该按照本[教程中的说明在页面（或页面组）内进行](http://javapapers.com/jsp/how-to-pre-compile-jsp/)

# web-applications - 当我从主屏幕 webapp 下载存折时“无法下载文件”

> ID：13069071
> 
> 赞同：2
> 
> 时间：2012-10-25T12:53:42.933
> 
> 标签：web-applications, ios6, iphone-web-app, passbook

我可以通过带有链接的*移动 Safari 浏览器*下载文件。`<a>`但是当我将我的网站保存为主*屏幕应用程序*时，我无法下载`.pkpass`（存折文件）。我收到了这个警告：

```
The file cannot be downloaded! 
```

然后我检查了请求，我发现用户代理不同：

**野生动物园浏览器：**

```
Mozilla/5.0 (iPhone; CPU iPhone OS 6_0 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Version/6.0 Mobile/10A5376e Safari/8536.25 
```

**主屏幕内部浏览器**

```
Mozilla/5.0 (iPhone; CPU iPhone OS 6_0 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Version/6.0 Mobile/10A5376e 
```

*是的，主屏幕应用程序*`safari`的请求中没有后缀

 *这是IOS6的bug吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T23:36:15.737

UIWebViewController 类通常不会像 Mobile Safari 对通行证或下载的文件所做的那样。我认为，但不确定，那些主屏幕应用程序使用该控制器，因此具有相同的限制。*

# c# - 如何检查 SQL Server Reporting Services 配置状态？

> ID：13069073
> 
> 赞同：1
> 
> 时间：2012-10-25T12:53:45.637
> 
> 标签：c#, sql-server-2008, reporting-services, registry, sql-server-2012

我正在为 SQL Server 编写安装自动化程序，在将`MSSQLSERVER`SQL Server 2008 的默认实例升级到 SQL Server 2012 时，我需要检查 Reporting Services 配置状态。

使用注册表可以检查报告服务是否已安装。但我没有得到任何线索来检查 Reporting Services 的配置状态。

如果您对如何检查 Reporting Services 的配置状态有任何想法，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T12:59:44.783

确保报表服务器服务正在 services.msc 中运行

[此](http://msdn.microsoft.com/en-us/library/ms178811%28v=sql.100%29.aspx)链接可能会对您有所帮助。

# c#-4.0 - 如何告诉 nunit-console 在 Mono 下使用 4.0？

> ID：13069078
> 
> 赞同：4
> 
> 时间：2012-10-25T12:53:59.257
> 
> 标签：c#-4.0, mono, nunit

我在 MonoDevelop 下建立了一个简单的项目，并且可以从那里成功运行测试 (*)。

当我从命令行尝试 nunit-console.exe 时，我得到了这个：

```
 .../mono2/bin/Debug$ nunit-console mono2.exe
 NUnit version 2.5.10.0
 ...
 Runtime Environment - 
   OS Version: Unix 2.6.32.44
  CLR Version: 2.0.50727.1433 ( 2.10.8.1 (Debian 2.10.8.1-1~dhx1~lucid1) )

 ProcessModel: Default    DomainUsage: Single
 Execution Runtime: Default
 Unhandled Exception:
 System.ArgumentException: NUnit components for version 4.0.30319 of the CLR are not installed
 ... 
```

如果我忽略了一些重要的事情，请告诉我。

nunit-gui 给出了同样的错误。nunit-gui 有一个从 2.0 切换到 4.0 的选项，但是当我尝试它时，它又给了我同样的错误，所以不允许我更改它。

更多细节：Ubuntu 10.04，使用[http://badgerports.org/lucid.html](http://badgerports.org/lucid.html)存储库，所以 Mono 2.10.8.1。

根据 MonoDevelop 中的项目选项，该项目设置为使用“Mono/.NET 4.0”。

**更多信息：**

/usr/bin/nunit-console 包含以下内容：

```
#!/bin/sh

exec /usr/bin/cli /usr/lib/nunit/nunit-console.exe "$@" 
```

/usr/lib/nunit/ 目录包含：

```
 3073 2011-03-14 18:13 nunit.exe.config
   2598 2011-03-14 18:13 nunit-console.exe.config
  23040 2012-02-29 10:19 nunit-console-runner.dll
   4608 2012-02-29 10:19 nunit-console.exe*
  76288 2012-02-29 10:19 nunit.uiexception.dll
 259072 2012-02-29 10:19 nunit.uikit.dll
 183808 2012-02-29 10:19 nunit-gui-runner.dll
   4096 2012-02-29 10:19 nunit.exe* 
```

nunit-console.exe.config 包含：

```
<?xml version="1.0" encoding="utf-8"?>
<configuration>

  <runtime>
    <!-- We need this so test exceptions don't crash NUnit -->
    <legacyUnhandledExceptionPolicy enabled="1" />

    <!-- Look for addins in the addins directory for now -->
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <probing privatePath="lib;addins"/>
   </assemblyBinding>

   <!--
    The following <assemblyBinding> section allows running nunit under 
    .NET 1.0 by redirecting assemblies. The appliesTo attribute
    causes the section to be ignored except under .NET 1.0
    on a machine with only the .NET version 1.0 runtime installed.
    If application and its tests were built for .NET 1.1 you will
    also need to redirect system assemblies in the test config file,
    which controls loading of the tests.
   -->
   <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1"
            appliesTo="v1.0.3705">

      <dependentAssembly> 
        <assemblyIdentity name="System" 
                          publicKeyToken="b77a5c561934e089" 
                          culture="neutral"/>
        <bindingRedirect  oldVersion="1.0.5000.0" 
                          newVersion="1.0.3300.0"/>
      </dependentAssembly>

      <dependentAssembly> 
        <assemblyIdentity name="System.Data" 
                          publicKeyToken="b77a5c561934e089" 
                          culture="neutral"/>
        <bindingRedirect  oldVersion="1.0.5000.0" 
                          newVersion="1.0.3300.0"/>
      </dependentAssembly>

      <dependentAssembly> 
        <assemblyIdentity name="System.Drawing" 
                          publicKeyToken="b03f5f7f11d50a3a" 
                          culture="neutral"/>
        <bindingRedirect  oldVersion="1.0.5000.0" 
                          newVersion="1.0.3300.0"/>
      </dependentAssembly>

      <dependentAssembly> 
        <assemblyIdentity name="System.Windows.Forms" 
                          publicKeyToken="b77a5c561934e089" 
                          culture="neutral"/>
        <bindingRedirect  oldVersion="1.0.5000.0" 
                          newVersion="1.0.3300.0"/>
      </dependentAssembly>

      <dependentAssembly> 
        <assemblyIdentity name="System.Xml" 
                          publicKeyToken="b77a5c561934e089" 
                          culture="neutral"/>
        <bindingRedirect  oldVersion="1.0.5000.0" 
                          newVersion="1.0.3300.0"/>
      </dependentAssembly>

    </assemblyBinding>

  </runtime>

</configuration> 
```

* * *

*：好吧，当我尝试使用更多奇特的 Nunit 属性时，我遇到了问题；这是我试图解决的*真正问题，这导致我遇到了上面描述的问题。*然而，上面使用的 exe 是一个只有两个简单测试的 exe，它们在 MonoDevelop 中运行良好。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-01T02:46:47.307

诀窍是修改 nunit-console，它（在 Ubuntu 10.04 上，使用 badgerports，看起来像`/usr/bin/cli /usr/lib/nunit/nunit-console.exe`），告诉*/usr/bin/cli*使用 .NET 4！

因此，当我执行此命令时：

```
/usr/bin/cli --runtime=v4.0 /usr/lib/nunit/nunit-console.exe mytest.exe 
```

我得到这个输出：

```
NUnit version 2.5.10.0
...
Runtime Environment - 
   OS Version: Unix 2.6.32.44
  CLR Version: 4.0.30319.1 ( 2.10.8.1 (Debian 2.10.8.1-1~dhx1~lucid1) )

ProcessModel: Default    DomainUsage: Single
Execution Runtime: Default
..
Tests run: 2, Errors: 0, Failures: 0, Inconclusive: 0, Time: 0.040103 seconds
  Not run: 0, Invalid: 0, Ignored: 0, Skipped: 0 
```

如果您只打算使用 NET 4，您可以编辑 /usr/bin/nunit-console 以始终设置它。

（*真正的*问题是 /usr/bin/cli 自动检测选择 NET 2 而不是 NET 4；但经过大量搜索后，我发现无法控制自动检测过程。）

* * *

**旁白**：我强调*/usr/bin/cli*的原因是，只是告诉 nunit-console 使用框架失败（见下文）。即运行时版本必须提供给/usr/bin/cli，而不是nunit-console！

```
/usr/bin/cli /usr/lib/nunit/nunit-console.exe -framework=v4.0 mytest.exe
NUnit version 2.5.10.0
...
Runtime Environment - 
   OS Version: Unix 2.6.32.44
  CLR Version: 2.0.50727.1433 ( 2.10.8.1 (Debian 2.10.8.1-1~dhx1~lucid1) )

ProcessModel: Default    DomainUsage: Single
Execution Runtime: v4.0
Unhandled Exception:
System.ArgumentException: NUnit components for version 4.0 of the CLR are not installed
Parameter name: targetRuntime
  at NUnit.Util.TestAgency.LaunchAgentProcess (NUnit.Core.RuntimeFramework targetRuntime, Boolean enableDebug) [0x00000] in <filename unknown>:0 
... 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-25T13:21:59.940

使用 nunit-console4 代替 nunit-console。

# ios - iOS 滚动到 UITable 视图中的一个部分

> ID：13069080
> 
> 赞同：0
> 
> 时间：2012-10-25T12:54:08.897
> 
> 标签：ios, uitableview

有谁知道如何以编程方式将表格视图滚动到索引路径处的部分。我想要做的是有 2 个部分的 tableview 和一个 if 语句，例如

```
if loading = true scroll the table view up to hide the first section
when finished loading scroll table view back down to show first section 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T12:55:40.733

这是片段：

```
NSIndexPath * indexPath = [NSIndexPath indexPathForRow:row inSection:section];
[_tableView scrollToRowAtIndexPath:indexPath atScrollPosition:UITableViewScrollPositionTop animated:YES]; 
```

# vba - VBA如何声明具有不同数据类型元素的数组

> ID：13069082
> 
> 赞同：6
> 
> 时间：2012-10-25T12:54:20.593
> 
> 标签：vba, excel

我创建了一个数组来存储错误记录，它具有以下元素：序列号、文件名、错误类型、错误单元格、错误单元格值

到目前为止，我已经像这样声明了我的数组，然后我稍后会填充这些值。

```
Dim errorArray() As String 
```

但理想情况下，我希望序列号是一个正确的整数，但它正在转换为字符串。我不知道如何正确声明这一点，以便我可以将 Long 数据类型用于第一个元素，将字符串用于下一个 3，并将变体用于最后一个元素。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-10-25T13:01:07.857

在您的代码中创建一个私有类型，如下所示：

```
Private Type ErrRecord
    SerialNo As Long
    FileName As String
    ErrorType As String
    ErrorCell As String
    ErrorCellValue As Variant
End Type 
```

然后在你的例程中，这样称呼它：

```
Dim errorArray(0) As ErrRecord
With errorArray(0)
    .SerialNo = 12345
    .FileName = "Test.xls"
    .ErrorType = "Bad error"
    .ErrorCell = "1234"
    .ErrorCellValue = "Test"
End With 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-25T13:03:05.767

您需要创建一个 Variant 类型的数组。Variant 类型的数组可以在其任何元素中存储任何数据类型。

```
Dim astrItems(0 To 9)    As String
Dim varItems             As Variant

varItems = astrItems 
```

# sql - 如何在 SQL Profiler 中配置警报和终止长时间运行的查询

> ID：13069084
> 
> 赞同：3
> 
> 时间：2012-10-25T12:54:20.893
> 
> 标签：sql, sql-server, sql-server-2008

无论如何我可以使用 SQL Profiler 或 Management Studios 中的其他东西配置警报并终止长时间运行的查询吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T13:04:54.187

[您可以编写一个存储过程来监视 master 中的 sysprocesses。当存储过程执行时间过长时](https://stackoverflow.com/questions/577233/sql-alert-when-stored-procedure-executes-for-too-long)，信用转到SQL Alert

首先，您需要一个新的 UDF，它将作业 ID 转换为 JOIN 的进程 ID：

```
CREATE FUNCTION dbo.udf_SysJobs_GetProcessid(@job_id uniqueidentifier)
RETURNS VARCHAR(8)
AS
BEGIN
    RETURN (substring(left(@job_id,8),7,2) +
    substring(left(@job_id,8),5,2) +
    substring(left(@job_id,8),3,2) +
    substring(left(@job_id,8),1,2))
END 
```

然后是存储过程：

```
CREATE PROC sp_check_job_running 
    @job_name char(50),
    @minutes_allowed int, 
    @person_to_notify varchar(50) 

AS 

DECLARE @minutes_running int, 
    @message_text varchar(255)

SELECT @minutes_running = isnull(DATEDIFF(mi, p.last_batch, getdate()), 0)
FROM master..sysprocesses p
JOIN msdb..sysjobs j ON dbo.udf_sysjobs_getprocessid(j.job_id) = substring(p.program_name,32,8)
WHERE j.name = @job_name

IF @minutes_running > @minutes_allowed 
    BEGIN
      SELECT @message_text = ('Job ' + UPPER(SUBSTRING(@job_name,1,LEN(@job_name))) + ' has been running for ' + SUBSTRING(CAST(@minutes_running AS char(5)),1,LEN(CAST(@minutes_running AS char(5)))) + ' minutes, which is over the allowed run time of ' + SUBSTRING(CAST(@minutes_allowed AS char(5)),1,LEN(CAST(@minutes_allowed AS char(5)))) + ' minutes.') 
      EXEC msdb.dbo.sp_send_dbmail
        @recipients = @person_to_notify,
        @body = @message_text,
        @subject = 'Long-Running Job to Check' 
    END 
```

然后您可以将存储的过程执行为

```
EXEC sp_check_job_running 'JobNameGoesHere', 5, 'admin@mycompany.com' 
```

# java - 在 org.apache.commons.io.FileUtils.copyURLToFile 上设置超时？

> ID：13069089
> 
> 赞同：1
> 
> 时间：2012-10-25T12:54:29.953
> 
> 标签：java, httpclient, apache-commons

我有一些使用 httpCore util copyURLtoFile() 复制的代码，但我似乎无法在文档中找到任何关于超时的信息，就像使用 httpClient 一样。它拉出的文件不应该拉出，但取决于那是....有趣。

```
 URL pjmUrl = new URL("myFile");
    File projLoad = new File("projLoad.txt");
    org.apache.commons.io.FileUtils.copyURLToFile(pjmUrl, projLoad); 
```

如果第三行应该超时，则程序无法根据运行时抛出错误或检查 threadInterrupted()

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T13:07:07.127

您一定正在查看旧的 javadocs。在当前版本 (2.4) 中，这里是`copyURLToFile`具有两个超时参数的方法的重载：

```
 public static void copyURLToFile(URL source,
                             File destination,
                             int connectionTimeout,
                             int readTimeout)
                      throws IOException 
```

正如 javadoc 解释的那样，时间单位是毫秒。

参考： [https ://commons.apache.org/proper/commons-io/javadocs/api-2.4/org/apache/commons/io/FileUtils.html](https://commons.apache.org/proper/commons-io/javadocs/api-2.4/org/apache/commons/io/FileUtils.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T13:51:41.427

不正确，重载的方法

```
FileUtils.copyURLToFile(URL source,
                        File destination,
                        int connectionTimeout,
                        int readTimeout) 
```

**在最新的 2.4 中不存在。version**，尽管该方法在 Javadoc 中列出：

[http://commons.apache.org/proper/commons-io/javadocs/api-release/org/apache/commons/io/FileUtils.html#copyURLToFile(java.net.URL,%20java.io.File,% 20int,%20int)](http://commons.apache.org/proper/commons-io/javadocs/api-release/org/apache/commons/io/FileUtils.html#copyURLToFile(java.net.URL,%20java.io.File,%20int,%20int))

我很确定我使用的是 2.4 版的 Apache commons-io。

PS：我还下载了源（[http://www.carfab.com/apachesoftware//commons/io/source/commons-io-2.4-src.zip](http://www.carfab.com/apachesoftware//commons/io/source/commons-io-2.4-src.zip)）以确保上述方法确实不存在（不再存在?) 里面`FileUtils.java`真的没有这样的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-11T23:53:18.437

检查您的 maven 依赖项，您的类路径中可能还有另一个旧版本的 common-io jar。我遇到过同样的问题。

# ms-access - MS Access 2003 - ADO 2.8 编译错误“未找到成员或数据成员”

> ID：13069097
> 
> 赞同：0
> 
> 时间：2012-10-25T12:54:52.417
> 
> 标签：ms-access, ado

我有一个 MS Access 2003 数据库，它使用 ADO 2.8 并建立在 Windows vista 32 位上。当我第一次尝试编译将数据库移植到 32 位和 64 位的 Windows 7 机器时，我收到错误“未找到成员或数据成员”。

```
Dim con As New ADODB.Connection
Dim err As ADODB.Error

On Error GoTo ErrHandle

con.Open "MyDSN", "User", "Pass"

Exit Sub

ErrHandle:
For Each err In con.Errors
    Debug.Print err.Description
Next 
```

显示错误的代码部分是“err.Description”。

当您尝试再次编译代码时，它工作正常。有什么想法或有人见过类似的问题吗？

# php - 会话在 chrome 中重置

> ID：13069098
> 
> 赞同：2
> 
> 时间：2012-10-25T12:54:54.787
> 
> 标签：php, codeigniter, session, google-chrome

我有两个域`abc.com`，`xyz.com`在一台服务器上，都有确切的代码。问题出在 xyz.com 中，codeigniter 会话变量在 chrome 浏览器中的页面刷新时被重置。但在 abc.com 中没有这样的问题。它在Mozilla在两个域中。问题的根源是什么？它与域有关吗？htaccess？请指教。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T13:02:24.113

我以前遇到过这个（或非常相似的）问题，我通过启用会话来使用数据库来解决它。

即在 config.php 中，使 sess_use_database 为 true，即

```
$config['sess_cookie_name']     = 'ci_session';
$config['sess_expiration']      = 7200;
$config['sess_expire_on_close'] = FALSE;
$config['sess_encrypt_cookie']  = FALSE;
$config['sess_use_database']    = TRUE;
$config['sess_table_name']      = 'ci_sessions';
$config['sess_match_ip']         = FALSE;
$config['sess_match_useragent'] = FALSE; //you can try this with TRUE and see if it works
$config['sess_time_to_update']  = 300; 
```

确保会话表也在数据库中设置。如果没有，这是sql，

```
CREATE TABLE IF NOT EXISTS `ci_sessions` (
  `session_id` varchar(40) CHARACTER SET utf8 COLLATE utf8_bin NOT NULL DEFAULT '0',
  `ip_address` varchar(16) CHARACTER SET utf8 COLLATE utf8_bin NOT NULL DEFAULT '0',
  `user_agent` varchar(150) CHARACTER SET utf8 COLLATE utf8_bin NOT NULL,
  `last_activity` int(10) unsigned NOT NULL DEFAULT '0',
  `user_data` text CHARACTER SET utf8 COLLATE utf8_bin NOT NULL,
  `session_data` text NOT NULL,
  PRIMARY KEY (`session_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8; 
```

# python - 如何在 scrapy/python 中使用 webkit 代码

> ID：13069100
> 
> 赞同：1
> 
> 时间：2012-10-25T12:55:01.887
> 
> 标签：python, webkit, scrapy

在[How to combine scrapy and htmlunit to crawl urls with javascript](https://stackoverflow.com/questions/8047666/how-to-combine-scrapy-and-htmlunit-to-crawl-urls-with-javascript)的问题中，建议使用 webkit 和 scrapy 来遍历 javascript。但是，这个[示例 Snipplr 片段](http://snipplr.com/view/66996/renderedinteractive-javascript-with-gtkwebkitjswebkit/)说：

```
import gtk
import webkit
import jswebkit 
```

我是 Python 新手。据我了解，webkit（用 C/C++ 编写）需要有 Python 包装器。我环顾四周，但找不到类似的东西。任何建议表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T05:52:45.463

这是您可以从这里开始的最简单的示例

```
import gtk 
import webkit 

view = webkit.WebView() 

sw = gtk.ScrolledWindow() 
sw.add(view) 

win = gtk.Window(gtk.WINDOW_TOPLEVEL) 
win.add(sw) 
win.show_all() 

view.open("http://w3.org/") 
gtk.main() 
```

您可以从这里了解更多信息[http://code.google.com/p/pywebkitgtk/](http://code.google.com/p/pywebkitgtk/) 也可以在这里查看 [http://dvlabs.tippingpoint.com/blog/2011/11/28/malicious-content-harvesting](http://dvlabs.tippingpoint.com/blog/2011/11/28/malicious-content-harvesting)

# php - pdf上下对齐

> ID：13069101
> 
> 赞同：4
> 
> 时间：2012-10-25T12:55:07.837
> 
> 标签：php, pdf, alignment, cell, fpdf

我需要在 pdf 文件创建中进行文本对齐（**顶部和底部）。**

我正在使用这条线：

```
$pdf->Cell(0,0,"Submitted To:$subto",0,0,'alignment area');

alignment area: L,R,C 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T11:08:10.253

我找到了一个似乎可以满足您需要的插件。你在这里：http: [//fpdf.de/downloads/addons/52/](http://fpdf.de/downloads/addons/52/)

该插件提供了一个功能

```
drawTextBox(string strText, float w, float h [, string align [, string valign [, int border]]]) 
```

允许在函数参数定义的矩形内对齐文本（水平和垂直）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-23T01:15:27.633

使用 TCell 对齐文本，使用 BCell 对齐下面的文本行。

这对我很有效，我希望它也能帮助你。

```
class TBFpdf extends FPDF{

    private $padding_top = 1, $padding_bottom = 1, $line_space = 1, $paragraph_space = 1;

    private function topBottom($type, array $args){
        if(!isset($args[0], $args[1], $args[2]))
            throw new Exception("Parameter error!");

        $height = $args[1];
        $width = $args[0];

        $y_old = $this->GetY();
        $x_old = $this->GetX();

        if($type == "T"){
            $this->SetXY($x_old, $y_old + $this->padding_top);
            $this->WriteLimit($width, $args[2], isset($args[5])? $args[5] : "L");
        }else{
            $text_height = $this->WriteLimit($width, $args[2], isset($args[5])? $args[5] : "L", true);
            $this->SetXY($x_old, $y_old + $height - $text_height - $this->padding_bottom + 2);
            $this->WriteLimit($width, $args[2], isset($args[5])? $args[5] : "L");
        }
        //var_dump($height);
        $this->SetXY($x_old, $y_old);

        $args[2] = "";//empty the text already written
        call_user_func_array([$this, 'Cell'], $args);
    }

    //the parameters are the same used by Cell
    public function TCell(){
        call_user_func_array([$this, 'topBottom'], ['T', func_get_args()]);
    }

    //the parameters are the same used by Cell
    public function BCell(){
        call_user_func_array([$this, 'topBottom'], ['B', func_get_args()]);
    }

    private function WriteLimit($width, $text, $align, $simulacao = false){
        $texts = explode(chr(13).chr(10), $text);
        $height = 0;

        for ($i = 0; $i < count($texts); $i++) { 

            $words = explode(' ', $texts[$i]);
            $line = "";
            $qtd_words = count($words);

            for ($j = 0; $j < $qtd_words; $j++) { 
                $new_word = $words[$j].' ';
                $line .= $new_word;

                if( ($line_width = $this->getStringWidth($line)) > $width ){
                    $y_old = $this->GetY();
                    $x_old = $this->GetX();
                    $write_line = substr($line, 0, (-1)*strlen($new_word));
                    $line = $words[$j].' ';

                    if(!$simulacao)
                        $this->AlignWrite($write_line, $width, $align);

                    $this->SetXY($x_old, $y_old + $this->FontSize + $this->line_space);//reset to the cell point
                    $height += $this->FontSize + $this->line_space;
                }

                if($j == $qtd_words-1){
                    if(!$simulacao)
                        $this->AlignWrite($line, $width, $align);
                }
            }

            $y_old = $this->GetY();
            $this->SetXY($x_old, $y_old + $this->FontSize + $this->paragraph_space);//reset to the cell point
            $height += $this->FontSize + $this->paragraph_space;

        }

        return $height;
    }

    private function AlignWrite($write_line, $width, $align){
        $x_old = $this->GetX();

        if($align == "C" || $align == "R"){
            $width_write_line = $this->getStringWidth($write_line);
            if($align == "C")
                $this->SetX($x_old + ($width - $width_write_line)/2 - 0.75);
            else
                $this->SetX($x_old + $width - $width_write_line - 1.5);
        }

        $this->Write( $this->FontSize, $write_line);
    }

    public function SetLineSpace($line_space){
        $this->line_space = (float)$line_space;
        return $this;
    }

    public function SetParagraphSpace($paragraph_space){
        $this->paragraph_space = (float)$paragraph_space;
        return $this;
    }

    public function SetPaddingTop($padding_top){
        $this->padding_top = (float)$padding_top;
        return $this;
    }

    public function SetPaddingBottom($padding_bottom){
        $this->padding_bottom = $padding_bottom;
        return $this;
    }

} 
```

如何使用：

```
$pdf = new TBFpdf();
$pdf->SetLineSpace(2)->SetPaddingTop(2)->SetParagraphSpace(3)->SetPaddingBottom(2);
$pdf->AddPage();

$pdf->SetY(30);
$pdf->SetX(15);
$pdf->SetMargins(0, 0, 0);
$pdf->SetFont('Arial','B', 20);
$pdf->TCell(60, 210, utf8_decode("  Não se trata de um exercício intelectual, como aprender álgebra ou a análise de um balanço contábil.
    O desenvolvimento da liderança servidora exige muita motivação, feedback e prática intensiva na vida cotidiana. O que vale é a motivação para mudar e crescer."), "LBTR", null, "L");
$pdf->SetFont('Courier','I', 15);
$pdf->BCell(60, 210, utf8_decode("Não se trata de um exercício intelectual, como aprender álgebra ou a análise de um balanço contábil.
O desenvolvimento da liderança servidora exige muita motivação, feedback e prática intensiva na vida cotidiana. O que vale é a motivação para mudar e crescer."), "LBTR", null, "C");
$pdf->SetFont('ZapfDingbats', null, 10);
$pdf->TCell(60, 210, utf8_decode("Não se trata de um exercício intelectual, como aprender álgebra ou a análise de um balanço contábil.
O desenvolvimento da liderança servidora exige muita motivação, feedback e prática intensiva na vida cotidiana. O que vale é a motivação para mudar e crescer."), "LBTR", null, "R");
$pdf->Output(); 
```

# php - 在 php 中使用 fpdf/fpdi 添加垂直文本

> ID：13069104
> 
> 赞同：2
> 
> 时间：2012-10-25T12:55:11.407
> 
> 标签：php, pdf

我有一个从数据库 blob 构建多页 pdf 的脚本。这个 pdf 可以工作并输出良好的电流，但我需要在每页的左侧添加一行垂直的文本。我已经设法使它适用于某些 pdf，但对于某些我收到损坏的文件错误。有没有人有不同的方式添加垂直文本我可以尝试使用 fpdf/fpdi。

这是我到目前为止所拥有的：

```
function buildBSIPDF($filename){
global $supplier;

$pdf = new FPDI();
$i = 1;
$pagecount = $pdf->setSourceFile($filename);

//create text to append
$sideline = "Some text here";

while($i <= $pagecount){

    //$pdf->setSourceFile($filename); 
    // import page 1 
    $tplIdx = $pdf->importPage($i); 
    //use the imported page and place it at point 0,0; calculate width and height
    //automaticallay and ajust the page size to the size of the imported page 

    //$s = $pdf->getTemplatesize($tplidx); 
    $pdf->AddPage();
    $pdf->useTemplate($tplIdx); 

    // now write some text above the imported page 
    $pdf->SetFont('Arial', '', '12'); 
    $pdf->SetTextColor(0,0,0);
    //set position in pdf document
    $pdf->SetXY(20, 20);
    //first parameter defines the line height
    $pdf->RotatedText(5,250,$sideline,90);
    $i++;
}
$pdf->Output($filename, 'F'); 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T13:28:47.070

Try this :

```
class PDF extends FPDF { 

function Rotate($angle,$x=-1,$y=-1) { 

    if($x==-1) 
        $x=$this->x; 
    if($y==-1) 
        $y=$this->y; 
    if($this->angle!=0) 
        $this->_out('Q'); 
    $this->angle=$angle; 
    if($angle!=0) 

    { 
        $angle*=M_PI/180; 
        $c=cos($angle); 
        $s=sin($angle); 
        $cx=$x*$this->k; 
        $cy=($this->h-$y)*$this->k; 

        $this->_out(sprintf('q %.5f %.5f %.5f %.5f %.2f %.2f cm 1 0 0 1 %.2f %.2f cm',$c,$s,-$s,$c,$cx,$cy,-$cx,-$cy));
     } 
  } 
} 

$pdf=new PDF(); 
$pdf->AddPage(); 
$pdf->SetFont('Arial','',10); 
$this->Rotate(10); 
$pdf->Write(20,'this text is crooked');
$this->Rotate(0); 
```

# reflection - Groovy NullObject 是否应该为空？

> ID：13069108
> 
> 赞同：2
> 
> 时间：2012-10-25T12:55:28.820
> 
> 标签：reflection, groovy, null-object-pattern

这个例子可以很容易地在 groovy 控制台中测试。

var a 被评估为非空，而 b 被评估为空。

两者都是 org.codehaus.groovy.runtim.NullObject 的实例

```
def b = null

println b.getClass()
println b == null

def a = null.getClass().newInstance()

println a.getClass()
println a == null 
```

有谁知道为什么？

在处理反射代码时这是一件棘手的事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:11:46.133

其实我想知道这是否不是一个错误。作为解释...... NullObject 是一种运行时/中​​间类型的对象。如果您对 null 执行任何操作，则使用 NullObject。这一点，以及 NullObject#equals 的实现说明 a==null 返回 true。它返回失败，因为在此之前有一些内部代码，例如确定是否调用 compareTo 而不是 equals 等。现在这段代码以

```
if (left == right) return true; 
if (left == null || right == null) return false; 
```

所以 null==null 将返回 true，但 NullObject==null 将返回 false。另一方面，如果可能，NullObject 不应泄漏。也许我们应该修复 newInstance() 以返回 null。

我为此填写了[http://jira.codehaus.org/browse/GROOVY-5769](https://web.archive.org/web/20150507205309/https://jira.codehaus.org/browse/GROOVY-5769)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T13:02:16.540

在 NullObject 的 equals 方法中，它仅`true`在[您将其](https://github.com/groovy/groovy-core/blob/master/src/main/org/codehaus/groovy/runtime/NullObject.java#L80)与`null`

作为`NullObject`is not strict的一个实例`null`，它返回 false...

如果你打电话反对另一个人是否`NullObject`应该返回可能是邮件列表中最好的问题......我会看看，看看我是否能找到任何以前的问题。`true``equals``NullObject`

# ruby-on-rails - 如何修复 JSON-1.7.5 和 UTF-8 编码错误？

> ID：13069109
> 
> 赞同：1
> 
> 时间：2012-10-25T12:55:31.637
> 
> 标签：ruby-on-rails, json, utf-8, rspec

我的报告有问题（涵盖带有规格测试的模型）。我的宝石：

```
group :development, :test do
  gem 'factory_girl_rails', '3.4.0'
  gem 'rspec-rails', '2.11.0'
  gem 'guard-rspec', '1.2.0'
  gem 'guard-bundler', '1.0.0'
  gem 'guard-cucumber'
  gem "shoulda-matchers", '1.1.0'
end

group :test do
  gem 'simplecov', :require => false
  #gem "simplecov-rcov", "~> 0.2.3"
gem 'cucumber-rails', require: false
  gem 'database_cleaner'
  gem "capybara"
  gem 'json_spec'
end 
```

错误信息：

```
Finished in 1.21 seconds
9 examples, 0 failures
/var/lib/gems/1.9.1/gems/json-1.7.5/lib/json/common.rb:285:in `encode': "\xD1" from ASCII-8BIT to UTF-8 (Encoding::UndefinedConversionError)
    from /var/lib/gems/1.9.1/gems/json-1.7.5/lib/json/common.rb:285:in `generate'
    from /var/lib/gems/1.9.1/gems/json-1.7.5/lib/json/common.rb:285:in `pretty_generate'
    from /var/lib/gems/1.9.1/gems/simplecov-0.6.4/lib/simplecov/result_merger.rb:77:in `block in store_result'
    from /var/lib/gems/1.9.1/gems/simplecov-0.6.4/lib/simplecov/result_merger.rb:75:in `open'
    from /var/lib/gems/1.9.1/gems/simplecov-0.6.4/lib/simplecov/result_merger.rb:75:in `store_result'
    from /var/lib/gems/1.9.1/gems/simplecov-0.6.4/lib/simplecov.rb:48:in `result'
    from /var/lib/gems/1.9.1/gems/simplecov-0.6.4/lib/simplecov/configuration.rb:133:in `block in at_exit'
    from /var/lib/gems/1.9.1/gems/simplecov-0.6.4/lib/simplecov/defaults.rb:51:in `call'
    from /var/lib/gems/1.9.1/gems/simplecov-0.6.4/lib/simplecov/defaults.rb:51:in `block in <top (required)>' 
```

如何解决？请帮忙！

**更新**
我所做的：1）卸载并重新安装了所有宝石[http://axonflux.com/uninstalling-and-reinstalling-all-ruby-gems](http://axonflux.com/uninstalling-and-reinstalling-all-ruby-gems)
2）删除了 .rvn 目录
3）注释掉了一些宝石

```
group :development do
#  gem 'growl'
group :test do
# gem 'json_spec'
  gem 'simplecov', :require => false
  #gem "simplecov-rcov", "~> 0.2.3" 
```

4) 安装 rvn
在任何这些阶段都没有运气....
必须找到那些违规角色的确切位置！

**更新**
尝试设置 Encoding.default_external = :'ASCII-8BIT' | :'UTF-8' 在 boot.rb 中。没运气

**更新** 试图通过运行脚本来解决问题

```
 #!/bin/bash
    FROM=us-ascii
    TO=UTF-8
    ICONV="iconv -f $FROM -t $TO"
    # Convert
    find gazsev32/ -type f -name "*" | while read fn; do
    cp ${fn} ${fn}.bak
    $ICONV < ${fn}.bak > ${fn}
    rm ${fn}.bak
    done 
```

**更新**
最后，恐怕是时候重新安装我的系统了。出现系统错误

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T13:02:00.750

### UTF-8 编码

你的踪迹说：

> /var/lib/gems/1.9.1/gems/json-1.7.5/lib/json/common.rb:285:in `encode': "\xD1" 从 ASCII-8BIT 到 UTF-8（编码::未定义的转换错误）

这显然是一个编码错误，这是 Ruby 1.9 下的常见问题。有时可以通过确保您具备以下条件来解决：

```
# encoding: utf-8 
```

在源文件的顶部，但如果不是，您可能需要使用shell 中的*/usr/bin/iconv*或一些 Ruby 蛮力删除违规字符，然后再尝试将代码转换为 JSON。问题显然出在您的 JSON 库中，但有问题的字符可能在您的源代码中的其他地方。

# xml - 从 MVC Web API 响应中删除 XML 命名空间属性

> ID：13069115
> 
> 赞同：2
> 
> 时间：2012-10-25T12:55:56.317
> 
> 标签：xml, asp.net-mvc, asp.net-web-api

我从 MVC Web Api 得到以下响应；

```
<Products xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="my.namespace.com">
<Product>
<Id>1</Id>
<Name>Tomato Soup</Name>
<Category>Groceries</Category>
<Price>1</Price>
</Product>
<Product>
<Id>2</Id>
<Name>Yo-yo</Name>
<Category>Toys</Category>
<Price>3.75</Price>
</Product>
<Product>
<Id>3</Id>
<Name>Hammer</Name>
<Category>Hardware</Category>
<Price>16.99</Price>
</Product>
</Products> 
```

我想删除 xmlns:* 标签。

我发现了各种帖子，包括一些在 SO 上提供选项的帖子，但这些似乎不起作用。

我尝试过的；

```
[XmlRoot("Products",Namespace = "my.namespace.com")]
    [DataContract(Namespace = "")]
    public class ProductsModel : List<Product>
    {
    }

[XmlRoot("Product")]
    [DataContract(Namespace = "", Name = "Product")]
    public class Product 
    {
        [DataMember]
        public int Id { get; set; }

        [DataMember]
        public string Name { get; set; }

        [DataMember]
        public string Category { get; set; }

        [DataMember]
        public decimal Price { get; set; }
    } 
```

和

```
GlobalConfiguration.Configuration.Formatters.XmlFormatter.UseXmlSerializer = true; 
```

这些都没有效果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T15:41:37.623

而不是`DataContract`使用`CollectionDataContract`，而不启用`XmlSerializer`。

# iphone - 访问 .plist 值

> ID：13069117
> 
> 赞同：0
> 
> 时间：2012-10-25T12:56:33.093
> 
> 标签：iphone, ios, xcode, ios5, ios6

我正在构建一个具有选择器视图的应用程序，因此，我创建了一个 .plist 文件来创建键和值。唯一的问题是我希望能够访问 .plist 值。问题是，这些值是名称字符串，当在选择器视图上选择时，我想创建一个 if 语句，我在其中调用手机号码。如果可能的话，我需要有关访问值的指南

关于如何执行此操作的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T13:00:27.267

```
NSString *pathToFile = [[NSBundle mainBundle] pathForResource:@"myList" ofType:@"plist"];
NSDictionary *dict = [NSDictionary dictionaryWithContentsOfFile:pathToFile]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T13:00:12.557

```
 NSString *path = [[NSBundle mainBundle] pathForResource:  // here data is file nale of plist
                    @"data" ofType:@"plist"];
    // Build the dictionary from the plist  
    NSDictionary *dictionary = [[NSDictionary alloc] initWithContentsOfFile:path]; 
```

# php - magento 从 1.4.0.1 升级到 1.4.2.0

> ID：13069119
> 
> 赞同：0
> 
> 时间：2012-10-25T12:56:41.513
> 
> 标签：php, mysql, magento, magento-1.4

我收到此错误： 完整性约束违规：1062 升级 magento 时键 'PRIMARY' 的重复条目 '7'。

知道如何解决吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T06:14:44.040

这是从任何版本升级的完整解决方案，因为我尝试了 mageto 的逐步版本升级，但我遇到了同样的问题。

[Magento 升级耗时太长且永远无法完成](https://stackoverflow.com/questions/13163847/magento-upgrade-takes-too-long-and-never-completes)

# jsf - 应用程序范围 bean 的视图未更新

> ID：13069125
> 
> 赞同：0
> 
> 时间：2012-10-25T12:57:19.310
> 
> 标签：jsf, jakarta-ee, jsf-2

我在应用程序范围的 bean 中有一个变量。用户可以通过方法调用触发此变量的更新。现在的问题是用户在刷新 jsf 页面后没有得到这个变量的更新视图。如果已经测试了变量是否正确更新并且是正确的，那么更新方法工作正常。应用程序范围 bean 中的变量是否声明为 final 或者这里有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T16:01:34.467

如果您使用了错误的注释组合，就会发生这种情况。例如

```
import javax.enterprise.context.ApplicationScoped;
import javax.faces.bean.ManagedBean;

@ManagedBean
@ApplicationScoped
public class App {} 
```

这里，范围注释来自 CDI，bean 管理注释来自 JSF。JSF 不识别 CDI 范围注释，因此默认为`@NoneScoped`. 即，在每一次 EL`#{app}`评估上都会重建 bean。这解释了您所看到的症状。

您还需要将范围注释修复为来自 JSF。

```
import javax.faces.bean.ApplicationScoped;
import javax.faces.bean.ManagedBean;

@ManagedBean
@ApplicationScoped
public class App {} 
```

CDI 范围注释只能与 CDI bean 管理注释结合使用`@Named`。

# objective-c - iOS6 是否有任何严重的变更日志？

> ID：13069129
> 
> 赞同：7
> 
> 时间：2012-10-25T12:57:34.493
> 
> 标签：objective-c, cocoa-touch, ios6

iOS6 是否有任何“严重”或“关键”的变更日志？我相信 Apple 关于“新功能”的官方文档对于导航来说非常糟糕（太大），因为只有“好”的新东西。但是没有人说过`IBAction`for`touchUpInside`现在优于`gestureRecognizer`或者`CLLocationManager`已经在主线程上运行。

这些是我后来在 Apple 文档中发现的。由于它太大了，阅读它然后记住它就太多了，然后在编写代码时，就像“哦，他们改变了这个，它在第 42 页......”。

是否有任何（甚至是粉丝/开发者/爱好者）页面/博客显示最痛苦的变化？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T13:15:23.757

除了[What's new](https://developer.apple.com/library/ios/releasenotes/General/WhatsNewIniOS/Introduction/Introduction.html)之外，还有[Release Notes](https://developer.apple.com/library/ios/releasenotes/General/RN-iOSSDK-6_0/)和[API Diffs ，在](https://developer.apple.com/library/ios/releasenotes/General/iOS60APIDiffs/)[Developer Library Release Notes](https://developer.apple.com/library/ios/releasenotes/General/iOS_DevLib_Release_Notes/index.html)中提到:)

# .net - .serializer 对 cdata 进行编码

> ID：13069132
> 
> 赞同：0
> 
> 时间：2012-10-25T12:57:37.877
> 
> 标签：.net, xml, serialization, xml-serialization

我们已经从 xml 模式构建了一个对象模型。然后我们使用序列化从 xml 到对象和从对象到 xml。如果我们从其中一个元素中包含 CDATA 的 xml 开始，它会很好地反序列化为对象，但是将其序列化回 xml 会导致 CDATA 丢失并且内容被 Xml 编码。有没有办法确保不会发生这种情况？

# rest - 编组列表 使用 JAX-RS

> ID：13069135
> 
> 赞同：2
> 
> 时间：2012-10-25T12:57:58.110
> 
> 标签：rest, jaxb, marshalling, jax-rs

我习惯于使用生成 wsdl 文件的 jax-ws，然后可以使用 maven 插件基于此 wsdl 文件及其 xsd 生成客户端。使用这个客户端一点也不麻烦，而且你不必真正考虑后台发生的事情，比如编组、http 传输等。

我目前正在使用 jaxb 来解组对象的 jax-rs 项目。那里的一种方法返回一个字符串列表，但似乎**jaxb 不知道如何编组 this**，这有点令人惊讶，因为它确实知道如何编组实体列表（例如，客户）。

另外，我自己为 jax-rs 服务编写了一个客户端，处理 http 响应和使用 jaxb 对有效负载进行解组。使用 jaxb 编组和解组确实很麻烦，因为它不能自动编组或解组添加到其上下文中的实体列表，更不用说字符串列表。

我想知道是否有一些巧妙的方法可以使用宁静的网络服务免费获得所有这些？这必须非常轻量级，并且客户端必须易于分发。

谢谢！鲁纳尔

使用 jaxrs 和 jaxb 不起作用的服务方法：

```
@GET
@Path("/{customerId}")
@Produces(MediaType.APPLICATION_XML)
public List<String> isCustomerLocked(@PathParam("customerId") Long customerId) {

} 
```

尝试编组/解组文本有效负载的客户端代码。添加到 jaxbcontext 的类未显示：

```
javax.xml.bind.Marshaller marshaller = jaxbContext.createMarshaller();
marshaller.marshal(obj, stringwriter)

javax.xml.bind.Unmarshaller unmarshaller = jaxbContext.createUnmarshaller();
unmarshaller.unmarshal(inputstream) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-25T13:10:32.470

我会使用 JAXB 来包装数据。简单来说，`List<String>`这可能看起来有点矫枉过正。但在大多数情况下，您想要取消/编组资源表示，而不是简单的对象。

记住：REST*不是*RPC！

如果你*真的*想要 tom un-/marshall`List<String>`写一个 JAX-RS Provider。但我更喜欢使用 JAXB。

**`S.java`**

```
@XmlRootElement
public class S {

    private String s;

    public S() {
    }

    public S(String s) {
        this.s = s;
    }

    public String getS() {
        return s;
    }

    public void setS(String s) {
        this.s = s;
    }
} 
```

**`Ss.java`**

```
@XmlRootElement(name="ss-wrapper")
public class Ss {

    private List<S> ss;

    public List<S> getSs() {
        return ss;
    }

    public void setSs(List<S> ss) {
        this.ss = ss;
    }

    public Ss(List<S> ss) {
        this.ss = ss;
    }

    public Ss() {
    }
} 
```

**JAX-RS 类**

```
@Path("/strings")
@GET
@Produces(MediaType.APPLICATION_XML)
public Response getListOfStrings() {
    S s1 = new S("foo");
    S s2 = new S("bar");
    List<S> strings = new ArrayList<S>();
    strings.add(s1);
    strings.add(s2);
    Ss ss = new Ss(strings);
    return Response.ok(ss).build();
} 
```

**XML**

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<ss-wrapper>
  <ss>
    <s>foo</s>
  </ss>
  <ss>
    <s>bar</s>
  </ss>
</ss-wrapper> 
```

# jquery - jQuery动态输入字段焦点

> ID：13069136
> 
> 赞同：16
> 
> 时间：2012-10-25T12:58:03.040
> 
> 标签：jquery, focus, jquery-click-event, input-field

我想使用以下 jQuery 向我的页面动态添加一个输入字段：

```
var inputNode = "<input id='inputNode' class='tiContent' type='text'
    placeholder='text input...'/>";
$("div").append(inputNode); 
```

这样做之后，我希望输入字段具有闪烁的文本光标的焦点，所以我想在创建后立即输入。

有人可以告诉我该怎么做吗？

我试过打电话

`$(inputNode).focus()`

并且也尝试过

`$(inputNode).trigger('click')`

但他们都没有工作。单击后我可以在该字段中输入，但正如我所说，我想立即输入而无需任何交互。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-25T13:03:27.940

当您尝试时`$(inputNode).focus()`，jQuery 只是构建了一个新的断开连接（来自 DOM）的`<input>`元素，该元素与您附加的元素不同 - 尽管这个断开连接的元素是集中的 :-)

有几种方法可以集中输入。

如果您可以使用 HTML5，则添加该`autofocus`属性将集中输入

```
var inputNode = '<input autofocus id="inputNode" class="tiContent" type="text" placeholder="text input..."/>';
$('div').append(inputNode); 
```

或者，使用 jQuery，您需要在创建元素`<input>` *后*找到它以调用[`.focus()`](http://api.jquery.com/focus/)它，因为`inputNode`您的代码中的 只是一个字符串而不是 jQuery 对象。

```
var inputNode = '<input id="inputNode" class="tiContent" type="text" placeholder="text input..."/>';
$('div').append(inputNode);
$('div input').focus(); // or $('#inputNode').focus(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-25T13:03:37.570

inputNode 不是 jQuery 元素，它是一个字符串。

你可能的意思是：

```
$('#inputNode').focus() 
```

相对于：

```
$(inputNode).focus() 
```

浏览器不会对此抱怨，因为您有一个具有该名称的变量

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-25T13:10:49.640

你需要这样的东西：

```
 $('<input />').appendTo('div').get(0).focus(); 
```

focus 方法是 DOM 元素的方法，而*不是*jQuery 对象，因此需要调用“get”。

您可能想阅读jQuery 文档中的[appendTo](http://api.jquery.com/appendTo/)和[get方法](http://api.jquery.com/get/)

希望这可以帮助

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-10-25T13:10:04.797

```
<input type="button" value="click me" id="btnCreateTxt" />
<div></div>

$(document).ready(function() {
    $('#btnCreateTxt').click(function() {        
        var inputNode = $("<input id='inputNode' class='tiContent' type='text' placeholder='text input...'/>");
        $("div").append(inputNode);
        inputNode.focus();    
    });
}); 
```

对我有用：http: [//jsfiddle.net/GqFap/9/](http://jsfiddle.net/GqFap/9/)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-10-25T13:03:25.797

您可以在将其附加到 dom 之前将其转换为 jQuery 对象，这样您就可以引用它。然后只需调用`.focus`引用的对象。

```
var $inputNode = $("<input id='inputNode' class='tiContent' type='text' placeholder='text input...'/>");
$('body').append($inputNode);​​​
​$inputNode.focus();​ 
```

这是一个[小提琴](http://jsfiddle.net/9V8r9/)。

# c# - 如何为 ListviewSubItem 设置工具提示

> ID：13069137
> 
> 赞同：6
> 
> 时间：2012-10-25T12:58:12.243
> 
> 标签：c#, controls, tooltip, listviewitem

我在详细信息视图中有一个 ListView 控件（将列表显示为网格的视图）

```
 mListView.View = View.Details; 
    mListView.mLVSelectedObject.ShowItemToolTips = true;

    ListViewItem listViewItem = mListView.Items.Add(lValue.Name);
    listViewItem.ToolTipText = "AAAAAAAAAAAAAAAAA"; 
```

问题是工具提示仅在光标位于第一个列表视图的列上时显示，而其余部分则不显示。我想知道是否有任何方法让它看起来“容易”？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-25T14:38:54.117

经过一番研究。我已经通过这种方式解决了这个问题，但我仍然想知道是否有另一种方法可以避免 EventHandlers；

```
 ToolTip     mTooltip;
    Point mLastPos = new Point(-1, -1);

    private void listview_MouseMove(object sender, MouseEventArgs e)
    {
        ListViewHitTestInfo info    =   mLV.HitTest(e.X, e.Y);

        if (mTooltip == null)
            mTooltip = new ToolTip();

        if (mLastPos != e.Location)
        {
            if (info.Item != null && info.SubItem != null)
            {
                mTooltip.ToolTipTitle = info.Item.Text;
                mTooltip.Show(info.SubItem.Text, info.Item.ListView, e.X, e.Y, 20000);
            }
            else
            {
                mTooltip.SetToolTip(mLV, string.Empty);
            }
        }

        mLastPos = e.Location;
    } 
```

# magento - 在 magento 购物车中禁用特定子类别的 url

> ID：13069140
> 
> 赞同：0
> 
> 时间：2012-10-25T12:58:31.743
> 
> 标签：magento, magento-1.7

刚拿到一个magento网站来更新。没有使用购物车的经验，所以我希望这些问题不要过于简单化。搜索了一下，并没有找到简单的答案
=> 对于我在 magento 购物车中显示的一些配件，我不希望在它们的标题和图像上链接，所以我是如何动态地制作这个的。任何帮助都是可观的

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T12:22:34.853

我在 /app/code/core/Mage/Checkout/Block/Cart/Item/Renderer.php 中创建了一个函数

```
 public function getCustumcatId()
    {
    $proid=$this->getProduct()->getId();
    $categoryIds=$this->getProduct()->getCategoryIds($proid);
    foreach($categoryIds as $categoryId)
    {
    $category = Mage::getModel('catalog/category')->load($categoryId);
    }
    return  $category->getName();
    } 
```

并在获取名称后在购物车的 default.phtml 上调用它我使用 if 和 else 删除链接感谢您的帮助和评论

# c# - 如何在 .NET/C# 下配置 SQLite 以在 NUnit 测试中运行？

> ID：13069141
> 
> 赞同：1
> 
> 时间：2012-10-25T12:58:42.190
> 
> 标签：c#, .net, sqlite, nunit, system.data.sqlite

我正在编写 NUnit 测试并希望将内存数据库 SQLite (.NET) 与我的 DAL 一起使用。我认为既然它是在内存中的，用它运行单元测试应该没什么大不了的。我可以毫不费力地设置与 SQLite 一起运行的可执行文件。我添加了 SQLite dll 引用并在 App.config 文件中包含了正确的 DbProviderFactories 设置，它可以工作。

但是，当我运行 nunit 测试时，我无法获取数据存储提供程序：

```
System.ArgumentException : The specified store provider cannot be found in the configuration, or is not valid.
  ----> System.ArgumentException : Unable to find the requested .Net Framework Data Provider.  It may not be installed. 
```

我尝试对测试项目执行与对可执行项目相同的过程，但它不起作用。

**如何配置 SQLite 以在 NUnit 测试中运行？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T13:53:13.140

我曾经也有过一样的问题。对我来说，当我将 SQLite 从 x86 切换到 x64 时它起作用了（反之亦然，不记得了）。

如果您使用的是 NuGet：[SQLite](http://nuget.org/packages?q=sqlite)有（令人困惑的）3 个不同的包。

我还结合使用 FluentNH 和[存储库](https://github.com/khellang/Hellang.Repository)模式进行数据访问。为测试和应用程序设置非常简单:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T13:43:28.747

不知道对你有没有帮助。

我使用 Fluent nHibernate，它轻巧而令人敬畏。

[http://www.dotnetguy.co.uk/post/2009/10/20/sqlite-nunit-fluent-nhibernate-test-your-data-access-layer/](http://www.dotnetguy.co.uk/post/2009/10/20/sqlite-nunit-fluent-nhibernate-test-your-data-access-layer/)

# android - Android：如何从 Atom 获取链接

> ID：13069142
> 
> 赞同：4
> 
> 时间：2012-10-25T12:58:41.767
> 
> 标签：android, rss, atom-feed

我正在为 Android 制作 RSS 阅读器，但我对 Atom 有疑问。在 RSS 2.0 我得到这个链接：

```
if (xpp.getName().equalsIgnoreCase("link")) 
```

它是这样制作的：

```
<link>http://wiadomosci.wp.pl/kat,1329,title,Kuratorium-odrzucilo-zastrzezenia-dyrektora-gimnazjum-salezjanskiego,wid,15039916,wiadomosc.html</link> 
```

所以没有问题。但在 Atom 中，它是以另一种方式制作的：

```
<link href="http://wiadomosci.onet.pl/media/spor-posla-po-z-wprost-czuje-sie-oszukany,1,5285815,wiadomosc.html"  rel="alternate" ></link> 
```

如何获取此链接？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T10:58:59.453

Rss、Atom 等有很多版本。您可以使用 Google Feed Api ( [https://developers.google.com/feed](https://developers.google.com/feed) ) 来获取任何 RSS 版本或 Atom 的一种数据结构。你只需要得到结果（例如 Json - [https://developers.google.com/feed/v1/jsondevguide](https://developers.google.com/feed/v1/jsondevguide)）并解析它。
希望它会有所帮助。

# iis - 从 IIS 7 上的 VBScript WMI 中删除虚拟目录

> ID：13069145
> 
> 赞同：1
> 
> 时间：2012-10-25T12:58:50.093
> 
> 标签：iis, iis-7, vbscript, wmi

使用以下 winmgmt：

`Set WebAdminWMI = GetObject("winmgmts:root\WebAdministration")`
`Set VDirWMI = WebAdminWMI.Get("VirtualDirectory")`

如何通过 Path 和 SiteName 删除特定的虚拟目录？

先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:02:04.213

尝试使用该[`Delete_`](http://msdn.microsoft.com/en-us/library/aa393771.aspx)方法

```
VDirWMI.Delete_ 
```

# c# - 我怎样才能有一个“通用”代表？

> ID：13069150
> 
> 赞同：0
> 
> 时间：2012-10-25T12:58:52.867
> 
> 标签：c#, delegates

我现在的情况是这样的：

我将这两个代表放在一个单独的文件中：

```
public delegate void EventHandler(Object obj, EventArgs e); 
public delegate void OtherEventHandler(Object obj, OtherEventArgs e); 
```

我有一个`Event`看起来像这样的类：

```
class Event {
   EventHandler _handler;
   public Event(EventHandler handler) {
      _handler = handler;
   }
} 
```

我有另一个以`Event`这种方式继承的类：

```
class OtherEvent : Event {
   OtherEventHandler _handler;
   public OtherEvent (OtherEventHandler handler) : base(handler) {
      _handler = handler;
   }
} 
```

这就是问题发生的地方。错误在于`base(handler)`. 因为`handler`in`OtherEvent`是一个`OtherEventHandler`，基类不能接受它；基类只接受`EventHandler`.

我的意图是拥有一个“通用”委托，这样当`OtherEvent`从 继承方法时`Event`，`OtherEvent`仍然可以灵活地使用其自己的委托类型，并使用与其父`handler`类字段不同的参数。

我能做些什么来实现我的意图？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T13:07:45.037

使用默认委托有什么问题[`EventHandler<TEventArgs>`](http://msdn.microsoft.com/en-us/library/db0etb8x.aspx)？它可以用任何类型参数化，继承自`EventArgs`.

我也不太了解`Event`上课的目的。您可以通过这种方式简单地定义事件：

```
public event EventHandler<OtherEventArgs> OtherEvent; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T13:02:06.307

也许使用泛型而不是继承？

```
class Event<TEvent>
{
    TEvent _handler;
    public Event(TEvent handler)
    {
        _handler = handler;
    }
} 
```

# c# - 使用 Excel 互操作 Com 对象时消除“2 点”的使用 - C#

> ID：13069153
> 
> 赞同：1
> 
> 时间：2012-10-25T12:59:00.607
> 
> 标签：c#, excel, excel-interop

我在发布 Excel Interop Com Objects 时遇到问题，当我尝试保存然后关闭通过 Excel Interop 创建的 Excel 工作簿时，这会导致我的 c# 应用程序崩溃。我觉得问题在于，在某些情况下，我将“2 点”与 excel 互操作 COM 对象一起使用，而我所阅读的内容是不允许的。我已经从大多数代码行中消除了 2 个点，但我一直在想办法重新创建以下代码行，以便它们只使用一个点。如果有人有任何建议，我将不胜感激。

```
workbook = (Excel.Workbook)app.Workbooks.Open(startForm.excelFileLocation,);

workbook = (Excel.Workbook)app.Workbooks.Add(1);

workSheet_range.Font.Color = System.Drawing.Color.FloralWhite.ToArgb();

workSheet_range.Font.Bold = font;

workSheet_range.Interior.Color = System.Drawing.Color.Red.ToArgb(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T13:10:53.447

验证每条指令的返回类型并分别分解。

您的第一行以“app.Workbooks”开头，它返回一个 Workbooks 类型的对象。然后 Open 指令返回一个 Workbook：

```
workbooks = app.Workbooks;
workbook = workbooks.Open(startForm.excelFileLocation); 
```

然后，您可以像这样拆分第二个：

```
workbook = workbooks.add(1); 
```

如果您没有“点缀”实际的 InterOp 对象，则可以使用多个点。

这是一个完整的示例：

```
Using Excel = Microsoft.Office.Interop.Excel;
public void Read()
{
    Excel.Application xlApp = new Excel.Application();
    Excel.Workbooks xlWorkBooks = xlApp.Workbooks;
    Excel.Workbook xlWorkBook = xlWorkBooks.Open(sourceFile);
    Excel.Worksheet xlWorkSheet = xlWorkBook.Worksheets[ 1 ];

    Excel.Range range = xlWorkSheet.UsedRange;
    range = range.Cells;
    Array myValues = ( Array )range.Value;    //now holds all the data in the sheet

    //The following is to ensure the EXCEL.EXE instance is released...
    //If you edit this code, know that using 2 dots (ex: range.Cells.Value) can create weird stuff!
    xlWorkBook.Close(false);
    xlWorkBooks.Close();
    xlApp.Quit();

    releaseObject(xlWorkSheet);
    releaseObject(xlWorkBook);
    releaseObject(xlWorkBooks);
    releaseObject(xlApp);

    xlWorkSheet = null;
    xlWorkBooks = null;
    xlWorkBook = null;
    xlApp = null;
}

private static void releaseObject( object obj )
{
try
{
    System.Runtime.InteropServices.Marshal.ReleaseComObject(obj);
    obj = null;
}
catch (Exception ex)
{
    obj = null;
    Console.WriteLine("Unable to release the Object " + ex.ToString());
}
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-12-03T01:56:02.480

在这里总结所有信息。

1.  分配时不要使用两个点。
2.  使用[AutoReleaseComObject](https://stackoverflow.com/a/349202/495455)类。
3.  使用 Microsoft KB 中描述的 ReleaseObject 方法（使用 while 循环）[：Office 应用程序在从 .NET 客户端自动化后不会退出](https://support.microsoft.com/en-us/kb/317109)。
4.  使用 GC.Collect 和 GC.WaitForPendingFinalizers。
5.  如果 Excel 进程在调试时保持活动状态，请不要感到惊讶，请始终通过运行应用程序来测试进程是否保持活动状态。

例如：

```
using Microsoft.Office.Interop.Excel;
...
var missing = Type.Missing;
using (AutoReleaseComObject<Microsoft.Office.Interop.Excel.Application> excelApplicationWrapper = new AutoReleaseComObject<Microsoft.Office.Interop.Excel.Application>(new Microsoft.Office.Interop.Excel.Application()))
{
    var excelApplicationWrapperComObject = excelApplicationWrapper.ComObject;
    excelApplicationWrapperComObject.Visible = true;

    var excelApplicationWrapperComObjectWkBooks = excelApplicationWrapperComObject.Workbooks;
    try
    {
        using (AutoReleaseComObject<Workbook> workbookWrapper = new AutoReleaseComObject<Workbook>(excelApplicationWrapperComObjectWkBooks.Open(@"C:\Temp\ExcelMoveChart.xlsx", false, false, missing, missing, missing, true, missing, missing, true, missing, missing, missing, missing, missing)))
        {
            var workbookComObject = workbookWrapper.ComObject;
            Worksheet sheetSource = workbookComObject.Sheets["Sheet1"];
            ChartObject chartObj = (ChartObject)sheetSource.ChartObjects("Chart 3");
            Chart chart = chartObj.Chart;
            chart.Location(XlChartLocation.xlLocationAsObject, "Sheet2");

            ReleaseObject(chart);
            ReleaseObject(chartObj);
            ReleaseObject(sheetSource);

            workbookComObject.Close(false);
        }
    }
    finally
    {
        excelApplicationWrapperComObjectWkBooks.Close();
        ReleaseObject(excelApplicationWrapperComObjectWkBooks);

        excelApplicationWrapper.ComObject.Application.Quit();
        excelApplicationWrapper.ComObject.Quit();
        ReleaseObject(excelApplicationWrapper.ComObject.Application);
        ReleaseObject(excelApplicationWrapper.ComObject);

        GC.Collect();
        GC.WaitForPendingFinalizers();
        GC.Collect();    
    }
}

private static void ReleaseObject(object obj)
{
    try
    {
        while (System.Runtime.InteropServices.Marshal.ReleaseComObject(obj) > 0);
        obj = null;
    }
    catch (Exception ex)
    {
        obj = null;
        Console.WriteLine("Unable to release the Object " + ex.ToString());
    }
} 
```

我知道释放所有对象，使用 GC.Collect 并且在分配时不使用两个点似乎在顶部**，但**至少当我退出 Excel 实例时，进程被释放，我不必以编程方式终止 Excel 进程！

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-25T13:31:43.507

使用两个点并不是“不允许的”，但它肯定会对性能产生影响，尤其是在紧密循环中运行时。

每个“点”都是对 Excel 库的 COM 调用，它可能比正常的 CLR 对象访问慢得多。通常，您希望将 COM 调用的数量减少到尽可能少。

*除非*您重用相同的变量，否则通过分成两行将两个点减少到一个不会产生任何影响。例如，改变

```
workSheet_range.Interior.Color = System.Drawing.Color.Red.ToArgb(); 
```

至

```
var interior = workSheet_range.Interior;
interior.Color = System.Drawing.Color.Red.ToArgb(); 
```

将对性能产生**零**`interior`影响，如果您不重新使用变量，甚至可能会“优化”回原始单行。

然而，改变

```
var font = workSheet_range.Font;
font.Color = System.Drawing.Color.FloralWhite.ToArgb();
font.Bold = font; 
```

将减少一次调用，`workSheet_range.Font`因此您会看到增量收益。

**底线**

我不会太担心更改*每个*两点调用，而是使用一个好的分析工具来确定您的代码在哪里花费的时间最多，然后首先解决该区域。

# python - pyparsing 关键字，它是如何工作的？

> ID：13069154
> 
> 赞同：3
> 
> 时间：2012-10-25T12:59:03.383
> 
> 标签：python, python-2.7, pyparsing

我曾经`pyparsing`解析大量文本并获得一些数字。我正在解析的文本是这样的：

```
asdkjh                  1      120   203
kajshd                  230   2309  2309
Activated Attempts      230   2309  2309
Activated Attempts      230   2309  2309
aksjdh                               300
... 
```

我需要搜索一个字符串并捕获紧跟在给定字符串之后的所有值。我写的代码看起来像这样，它工作正常。

```
returnValue= 0

integer = pyparsing.Word(pyparsing.nums).setParseAction(lambda toks: int(toks[0]))
attempted = integer.setResultsName("attempted")
text = "Activated Attempts"

row = text + attempted
table = pyparsing.ZeroOrMore(pyparsing.Group(row) | pyparsing.SkipTo(row).suppress())

attempteds = [row.asDict() for row in table.parseString(self.sendLine("lts_pm p"))]

for attempted in attempteds:
    returnValue+= attempted["attempted"]

return returnValue 
```

在上述情况下，它将返回 460。上述函数搜索给定的“激活的尝试”并存储该文本后跟的数字，汇总数字并返回。

但是我需要在同一个脚本中添加更多搜索查询，我尝试了：

```
text = pyparsing.Keyword("Activated Attempts") or pyparsing.Keyword("Non Attempts") 
```

但该脚本仅捕获“激活的尝试”并返回其编号并完全忽略第二个文本。`Keyword`如果不是这个有什么用？我也尝试过`Literal`，但也没有成功！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T17:16:03.013

```
from pyparsing import *

data = '''
asdkjh                  1      120   203
kajshd                  230   2309  2309
Activated Attempts      230   2309  2309
Activated Attempts      230   2309  2309
aksjdh                               300
'''

eventParser = Group(Word(alphas) + Optional(Word(alphas)))
rowParser = Group(eventParser + delimitedList(Word(nums),White(" ")))
tableParser = ZeroOrMore(rowParser)

def getValue(attemptsList, term):
    value = 0
    for attempt in attemptsList:
        if ' '.join(attempt[0]) == term:
            value += int(attempt[1])
    return value

attempts = getValue(tableParser.parseString(data), "Activated Attempts")
print attempts 
```

**编辑**

从文档

> 关键字 - 类似于 Literal，但必须紧跟空格、标点符号或其他非关键字字符；防止意外匹配以已定义关键字开头的非关键字。

# php - Symfony 1.4 & APC - “必须加载 apc 扩展才能使用此后端！”

> ID：13069155
> 
> 赞同：0
> 
> 时间：2012-10-25T12:59:06.380
> 
> 标签：php, symfony1, symfony-1.4, apc, ubuntu-12.04

我刚刚安装了 apc (lates stable / latest beta)，phpinfo() 显示了 apc 模块。如果我执行 symfony cc，我会收到消息“必须加载 apc 扩展才能使用此后端！”

我把它放在我的应用程序的配置类中：

```
public function configureDoctrine(Doctrine_Manager $manager)
{
  $manager->setAttribute(Doctrine::ATTR_QUERY_CACHE, new Doctrine_Cache_Apc());
} 
```

这在我的 php.ini 中：

```
extension=apc.so 
```

它在我的开发系统上运行良好，但在网络服务器上却不行。这个问题的原因是什么？

PHP 版本：带有 Suhosin-Patch (cli) 的 PHP 5.3.10-1ubuntu3.4（构建时间：2012 年 9 月 12 日 18:59:41） 版权所有 (c) 1997-2012 The PHP Group Zend Engine v2.3.0，版权所有 (c ) 1998-2012 Zend 技术

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T13:10:22.260

好的，我知道了。我还需要将“extension=apc.so”添加到命令行（/etc/php5/cli/php.ini）的 php.ini 中。

# java - Java三元运算符函数重载

> ID：13069159
> 
> 赞同：1
> 
> 时间：2012-10-25T12:59:18.340
> 
> 标签：java, ternary-operator, overloading

> **可能重复：**
> [Java 条件运算符？：](https://stackoverflow.com/questions/2615498/java-conditional-operator-result-type)
> [通过 Java 三元运算符的自动装箱行为的结果类型 NullPointerException](https://stackoverflow.com/questions/12763983/nullpointerexception-through-auto-boxing-behavior-of-java-ternary-operator)

假设我有两个功能：

```
f(MyObject o) { ... }
f(int i) { ... } 
```

我这样称呼他们：

```
f(someCondition ? 10 : null); 
```

这可以编译，但是当我运行它时，我得到一个空指针异常（抱歉，我不确定在哪种情况下）。我的一些问题是：

1.  为什么它甚至可以编译？是什么类型的`foo ? 10 : null`？
2.  它显然没有调用“正确”函数，因为这不会导致 NPE。那么它调用的是哪个函数呢？是吗`f((MyObject)10);`？`f((int)null)`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T13:13:25.833

首先，问题与您重载了`f`. 如果你只有那个版本`f`，`int`你会遇到同样的问题。

问题是三元表达式的两个可能结果（在 之前和之后`:`）必须具有相同的类型，因为整个表达式`condition ? expr1 : expr2`必须具有单一类型。您不能让此表达式计算为一种类型`condition`is `true`，如果它是另一种类型`false`。

因此，Java 编译器将查看它是否可以转换`expr1`为`expr2`单一类型。请注意，`int`不能`null`（因为它是原始类型）。但是，`10`可以`Integer`通过自动装箱转换为，`Integer`也可以是`null`. 所以整个三元表达式的类型被确定为 type `Integer`。结果要么是`Integer`包含值`10`的 要么`Integer`是`null`。

第二步是将其传递`Integer`给`f`. 因为`f`需要一个`int`，所以它是自动拆箱的。

如果你自动拆箱 an `Integer`that is `null`，你会得到一个`NullPointerException`- 这就是这里发生的事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T13:01:46.467

1.  类型是`Integer`- 对 10 进行*自动装箱*。
2.  `f(int)`被调用，因为它是唯一可接受的来自 Integer 的可用转换（假设没有其他重载）
    当您尝试将 a`null`转换为 an时`int`- 您会得到 NPE。

~~2.`f(Object)`被调用是因为 Integer 是一个 Object。这称为*引用类型扩展*~~
（抱歉最初的错误，请阅读为`f(Object)`）

# javascript - 查找 CKEDITOR 节点的（自身）内部文本

> ID：13069161
> 
> 赞同：0
> 
> 时间：2012-10-25T12:59:29.280
> 
> 标签：javascript, ckeditor, nodes

我有一个带有内部文本的节点，儿童也有内部文本。

我如何获取当前节点的内部文本**（没有子节点及其内部文本）。**

例如 ：

```
<myTag> 
myTag Text
<child1>ch1 Text</child1>
<child2>ch2<child3></child3> Text</child2>
some text
</myTag> 
```

所需结果（仅限 myTag 内部文本）：查找 myTag 的内部文本：

```
1.myTag Text
<child1>
2.some text
<child2> 
```

查找内部节点

```
x=myTagNode.getchildren()
for(var i=0;i<x.count();i++)
{
if(x[i].type==1)
{
alert(x[i].getName());
}
} 
```

**我怎样才能获得内部文本（没有子内部文本）？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T13:21:47.330

尝试使用treeWalker：

```
var mytag=document.getElementsByTagName("mytag")[0];
var treeWalker = document.createTreeWalker(mytag, NodeFilter.SHOW_TEXT);
var nodeList = [];
while(treeWalker.nextNode()) nodeList.push(treeWalker.currentNode); 
```

# image-processing - 在opencv中使用显着图自动高效地裁剪图像

> ID：13069164
> 
> 赞同：0
> 
> 时间：2012-10-25T12:59:35.880
> 
> 标签：image-processing, opencv

目前我正在研究一种基于显着性图的自动图像裁剪算法。

这个想法是，用户可以设置一些参数，以设置新图像的大小以及搜索具有最大显着性的最佳矩形的算法。

有人可以帮助我有效地找到具有最大显着性的最佳矩形吗？问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T08:50:30.673

我及时使用`NelderMead`来解决最小化问题。我认为这很好用。

# c - C：scanf 与 ==

> ID：13069167
> 
> 赞同：2
> 
> 时间：2012-10-25T12:59:39.140
> 
> 标签：c, scanf

我看到了这段代码。我在C方面很新，所以请原谅我。

下面的`while`循环将继续循环`if i < SIZE && scanf("%f",&Arr[i]) == 1`。

我明白了，`i < SIZE`但这是什么`scanf("%f",&Arr[i]) == 1`意思？我知道它正在从中获取值`scanf()`并将其分配给 array `Arr`。但是这`== 1`意味着什么？

谢谢 ：）

```
int readValue(float Arr[]) {
    int i = 0 ;
    while (i < SIZE && scanf("%f",&Arr[i]) == 1) 
        i++ ;  
    return i ;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T13:17:01.743

如果这里有更多括号来帮助记住[Operator Precedence](http://www.difranco.net/compsci/C_Operator_Precedence_Table.htm) ，可能会更清楚：

```
while (i < SIZE && scanf("%f",&Arr[i]) == 1) 
```

是相同的

```
while ((i < SIZE) && (scanf("%f", &Arr[i]) == 1)) 
```

所以如果`i`碰巧`>= SIZE`是`==`无关紧要的，因为它根本不会被执行。如果`i`小于`SIZE`则[scanf()](http://www.cplusplus.com/reference/clibrary/cstdio/scanf/)将被调用并返回参数列表中成功填充的项目数。因此，在您的情况下，如果这是 1 （如果我们得到一个浮点数并将其放入`Arr[i]`），那么条件就满足了。

因此，您将循环直到`i`大于或等于`SIZE`或输入无效条目`scanf()`

例如，如果您输入字母“h”，您的循环将中断，因为它不能进入​​特定的浮点数，因此`scanf()`将返回 0。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T13:01:48.040

[`scanf()`](http://en.cppreference.com/w/c/io/fscanf)返回进行的分配数，在这种`1`情况下，如果`scanf()`返回`1`，`&Arr[i]`则已成功分配值。从链接的参考页面中，返回值描述为：

> 成功分配的接收参数数，如果在分配第一个接收参数之前发生读取失败，则为 EOF

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-25T13:03:33.000

`scanf`返回成功读取的元素数：

从手册页：

> ...函数返回成功匹配和分配的输入项的数量，该数量可能少于提供的数量，或者在早期匹配失败的情况下甚至为零。

因此，如果单个浮点值的输入成功，`scanf()`将返回`1`并且条件将在条件的第二部分的 while 循环中为真。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-25T13:01:29.883

的返回值[`scanf`](http://www.cplusplus.com/reference/clibrary/cstdio/scanf/)是成功填充的参数列表的项目数。

由于只有一个参数，返回值`1`表示调用成功。如果输入不能被解释为浮点数，你会得到一个返回值`0`。

# android - 自定义列表视图适配器行选择

> ID：13069168
> 
> 赞同：1
> 
> 时间：2012-10-25T12:59:40.040
> 
> 标签：android, listview, highlight, custom-adapter

我有带有自定义适配器的列表视图。在每一行中，我有 2 个文本视图和一个按钮。我希望当我单击一个项目时突出显示它并保持突出显示，直到我单击另一个项目。我试图用列表选择器来做，但没有成功。然后我试着这样做：

```
public void onClick(View v) {
    ListView lvItems = context.lvLists;
    for (int i=0; i < lvItems.getChildCount(); i++) 
    {
        lvItems.getChildAt(i).setBackgroundColor(Color.BLACK);        
    }
    v.setBackgroundColor(Color.parseColor("#555555")); 
```

这是列表视图每一行的onclick。它有效，但我看到当我向下滚动时，选择了更多项目（我没有选择）。解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T13:05:24.180

如果要保存 ListView 项的某些属性，则不能依赖视图本身。您必须将它们存储在您的数据中，以便您的适配器知道哪个项目的状态已更改。有关详细信息，请参阅此问题的答案：

[Android：当我动态添加新的 ListView 条目时，ListView 中的微调器会丢失它们的值](https://stackoverflow.com/questions/9149550/android-spinners-within-a-listview-loose-their-values-when-i-add-dynamically-ne/9149774#9149774)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T13:05:02.673

您应该实现视图持有者模式，然后在持有者代码中，您可以有一个（布尔）变量来保存该项目的当前状态（突出显示或未突出显示），相应地更改背景颜色。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T13:07:38.660

您在 Stack Overflow 上有很多答案。试着检查一下[这个](https://stackoverflow.com/questions/3111354/android-listview-stay-selected)，[这个](https://stackoverflow.com/questions/4860085/force-a-listview-item-to-stay-pressed-after-being-clicked)还有[这个](https://stackoverflow.com/questions/5682053/listview-item-wont-stay-selected)。

# php - 使用 PHP 从数组中获取特定值

> ID：13069173
> 
> 赞同：0
> 
> 时间：2012-10-25T13:00:09.513
> 
> 标签：php

如果我有以下格式的数组：

```
Array ( [0] => stdClass Object ( [id] => 1 [c] => 1 [q] => value 1\. ) [1] => stdClass Object ( [id] => 2 [c] => 1 [q] => value 2... 
```

我需要得到

> 值 1

我不应该通过做类似的事情来得到它吗？

```
$myArray[0]['q'] 
```

由于某种原因，我没有得到任何东西......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T13:01:42.843

你需要使用`$myArray[0]->q`它是一个对象而不是一个数组。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T13:01:43.147

元素在里面`object`，你需要做，

```
 echo $myArray[0]->q; 
```

# php - 奇怪的行为 date() php 函数。漏洞？

> ID：13069179
> 
> 赞同：-2
> 
> 时间：2012-10-25T13:00:15.217
> 
> 标签：php, date

我试图添加 3 和 4 天至今。问题是 date() 在这两种情况下都返回相同的日期。为什么？

```
$intTime = strtotime('2012-10-25')+(3*86400);
date('Y-m-d', $intTime );

$intTime = strtotime('2012-10-25')+(4*86400);
date('Y-m-d', $intTime ); 
```

返回 2012-10-28

PHP 5.2.6-1

和

时区：欧洲/华沙，PHP：5.2.17

但

```
$intTime = strtotime('2012-10-25 +3 days'); 
echo date('Y-m-d', $intTime );

$intTime = strtotime('2012-10-25 +4 days'); 
echo date('Y-m-d', $intTime ); 
```

返回有效日期。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T13:11:03.227

您可能希望使用不同的方法来添加日常内容 - 这更容易理解：

```
$time = strtotime('+3 day',strtotime('2012-10-25'));
$data = date('Y-m-d', $time); 
```

我不确定上述是否会考虑到夏令时，但正如 Michael Berkowski 所提到的那样。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T13:11:46.533

不，这不是 PHP 中的错误——你正在违反夏令时。

您创建的日期`strtotime()`未指定时间，因此默认为午夜（即 00:00:00）。

当您将 24 小时添加到时间戳时，它通常会在第二天的同一时间结束。但是，由于本周末是某些国家/地区夏令时的结束，因此该特定日期要长一小时 - 因此添加 24 小时最终会得到一个时间戳，该时间戳映射到*同一天*的 23h00 。

这就是为什么你会得到这种奇怪的效果。

解决方案是：

1.  让您的系统仅在 UCT 时间工作，而不是本地时间。UCT 没有夏令时，因此不会受此影响。如果您需要以本地格式输入或输出时间，请在执行任何其他操作之前对其进行转换。您可以在 PHP.ini 文件中或使用[`date_default_timezone_set()`函数](http://php.net/manual/en/function.date-default-timezone-set.php)将系统设置为 UCT 。

2.  使用 PHP 的[`DateTime`类](http://www.php.net/manual/en/class.datetime.php)而不是旧式的日期函数。默认情况下，此类在 UCT 中工作，并包含一个`date_add()`允许您指定天数的方法，完全绕过了整个问题。（该类还有很多其他不错的功能，这些功能比旧式功能更好、更容易使用）。
    **注意：该`DateTime::add()`方法仅适用于 PHP 5.3。如果您卡在 5.2 上，则无法使用它（但如果是这样，我也强烈建议您升级，因为您已经严重过时了）

希望有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T13:12:04.087

根据您的时区、日期、夏令时、月相以及您那天早上是否见过黑猫，两个时间戳可能会在同一天结束，一个是清晨，另一个是深夜。一天并非始终如一的 86400 秒长。

使用适当的日期/时间处理函数。可以使用语法[`strtotime`](http://php.net/strtotime)添加时间，可用于创建新的时间戳，涉及一些数学，但该类是操作时间戳的最健壮和通用的方法。`+3 days`[`mktime`](http://php.net/mktime)[`DateTime`](http://php.net/DateTime)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T13:12:49.427

通常，当您所在的时区在这些日期经历夏令时时，就会发生这种情况。发生这种情况时，添加`86400`是错误的，因为现在一天中不再有 86400 秒。

尝试将您的日期生成更改为：

```
$intTime = strtotime('2012-10-25 +3 days'); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-25T13:12:55.303

尝试添加：

```
date_default_timezone_set('UTC'); 
```

# java - Google App Engine HR Datastore - Java - 以编程方式删除实体

> ID：13069181
> 
> 赞同：1
> 
> 时间：2012-10-25T13:00:17.130
> 
> 标签：java, google-app-engine

我在我的 Eclipse (Helios) IDE 中运行 Google App Engine。我使用 Java 来实现。测试在 localhost:8888 本地完成。

不幸的是，我无法解决以下问题。我将实体存储在 Google 应用引擎高复制数据存储中。关键是位置，所有事件都存储为各种位置（据我所知），现在没有特殊的唯一主键。我用：

```
DatastoreService dss;
Key key;
Entity event;

dss = DatastoreServiceFactory.getDatastoreService();
key = KeyFactory.createKey("location", location);  //location is String

event = new Entity("event", key);
event.setProperty("date", date);
event.setProperty("info", infostrg);
dss.put(event); 
```

这工作正常。

当我尝试让所有事件发生在特定位置时，我使用以下代码：

```
dss = DatastoreServiceFactory.getDatastoreService();

key = KeyFactory.createKey("location", location);
aktQuery = new Query ("event", key);

aktQuery.addSort("date", Query.SortDirection.DESCENDING);       
//List<Entity>
events = dss.prepare(aktQuery).asList(FetchOptions.Builder.withLimit(20));

for (Entity event : events) {
    //HTTPServeletResponse only prints out for test
    currentAktionen.getWriter().println(event.getProperty("date") + "," +   
               event.getProperty("info"));
} 
```

它提供所有事件并在我的网络浏览器站点中打印数据。--> 有效

但我无法删除这样的事件实体。我试过：dss.delete(key)，我试图在 for each 循环期间删除，...

有人知道如何通过查询以编程方式删除一个或所有事件吗？（在仪表板中删除对我没有帮助！）

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T16:08:35.287

我现在成功了，但我不知道为什么。以下代码现在可以工作：

```
for (Entity event : events) {

    currentAktionen.getWriter().println(event.getProperty("date") + "," +   
           event.getProperty("info"));
    Key key = aktion.getKey();
    dss.delete(key);

} 
```

不要问我为什么，....我在 for-each 开头的最后两行代码之前尝试了 15 次，但没有成功。

# sitecore - Sitecore：查找选定项目的字段值

> ID：13069184
> 
> 赞同：0
> 
> 时间：2012-10-25T13:00:27.393
> 
> 标签：sitecore

我正在尝试在我的子布局中创建一些自定义代码。

我要建立一个通讯，通讯可以组成多篇文章。一篇文章可以由标题/子标题/标题和图像组成。

可以，因为副标题或图片不是强制性的。为了避免时事通讯电子邮件中出现任何空白/丢失图像，我想根据内容创建一个特定的 HTML。

如果没有图片，不显示Image控件，如果没有Sub title，不显示Sub Title控件；

为此，我使用了以下不起作用的代码:(

```
 Sitecore.Data.Database master = Sitecore.Configuration.Factory.GetDatabase("master");
Sitecore.Data.Items.Item home = master.GetItem("/sitecore/content/Home");

if(home != null && home.Fields != null)
{
string name = home.Fields["Image"].Name; -> Which Fields["Image"] returns null.
} 
```

是否有另一种方法来检索所选文章的字段？由于我的代码根本不起作用，我不明白如何检索所选项目的字段值。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T13:03:43.810

在您的示例中， home.Fields 只是检查以确保 Fields 集合存在。在尝试提取名称之前，您没有检查 Image 字段中是否存在值。

你可能需要这样的东西：

```
if(home != null && home.Fields != null && home.Fields["Image"] != null)
{
   string name = home.Fields["Image"].Name;
} 
```

根据您的评论，您似乎实际上是在尝试从组件的数据源中提取图像字段。如果您想在这种情况下做某事之前有条件地检查图像字段，那么我想处理很多可能的空异常。代码可能应该是这样的：

```
var parent = ((Sitecore.Web.UI.WebControl)Parent);
if(parent != null){
   Item dataSourceItem = string.IsNullOrWhiteSpace(parent.DataSource) ? null : Sitecore.Context.Database.GetItem(parent.DataSource);

   if(dataSourceItem != null && dataSourceItem.Fields != null && dataSourceItem.Fields["Image"]!=null){
       string name=dataSourceItem.Fields["Image"].Name;
   }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-06-19T12:45:54.117

这是一种简单的方法：

```
Sitecore.Context.Item.Fields["You field name"] 
```

# php - SQL INSERT INTO 不起作用

> ID：13069193
> 
> 赞同：0
> 
> 时间：2012-10-25T13:00:50.527
> 
> 标签：php, mysql, insert

我正在尝试使用 PHP 向数据库添加一些值我从 Android 应用程序发送一些参数，它们也以正确的方式到达。我用 echo 检查了它并打印了我发送的所有参数。

```
id (PRIMARY_KEY, AUTO_INCREMENT)

deviceID (TEXT)

name (TEXT)

latitude (TEXT)

longitude (TEXT) 
```

这就是结构和数据库的名称是位置

这是我的查询，但它不起作用。

```
$deviceID = $_POST['deviceID'];
    $name = $_POST['name'];
    $latitude = $_POST['latitude'];
    $longitude = $_POST['longitude'];

$result = mysql_query("INSERT INTO position(deviceID, name, latitude, longitude) VALUES('$deviceID', '$name', '$latitude', '$longitude')"); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T13:11:45.397

[http://dev.mysql.com/doc/refman/5.1/en/string-functions.html#function_position](http://dev.mysql.com/doc/refman/5.1/en/string-functions.html#function_position)

`Position`是 MySQL 中的一个函数名：您应该使用反引号 (`) 对其进行转义，并且您需要`position`在括号和括号之间添加一个空格。

```
$result = mysql_query("INSERT INTO `position` (deviceID, name, latitude, longitude) VALUES('$deviceID', '$name', '$latitude', '$longitude')"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T13:15:04.527

听着，您需要停止使用已弃用的`mysql_*`功能。它们会让你很头疼。我建议你设置 mysql 来使用`PDO`. 这是一个例子。

首先连接到它并让它抛出异常供您自己处理。

```
try {
    $pdo = new PDO('mysql:host=localhost;dbname=myDatabase', $username, $password);
    $pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
} catch(PDOException $e) {
    echo 'ERROR: ' . $e->getMessage();
} 
```

现在运行您的更新。

```
try { 
  $stmt = $pdo->prepare('INSERT INTO position VALUES(:deviceId, :name, :latitude, :longitude)');
  $stmt->execute(array(
    ':deviceId' => $deviceID,
    ':name' => $name,
    ':latitude' => $latitude,
    ':longitude' => $longitude 
  ));

  // Affected Rows?
  echo $stmt->rowCount(); // 1

} catch(PDOException $e) {

  echo 'Error: ' . $e->getMessage();
} 
```

// 根据您对 json_encode 的问题

`execute()`在您以相同的方式（但使用 a ）调用语句之后，您`SELECT`只需要这样做。

```
$results = $stmt->fetchAll(PDO::FETCH_ASSOC); // This will be an array
$json_results = json_encode($results); 
```

如果您想将其作为对象（我更喜欢使用），请稍后再进行

```
$results = $stmt->fetchAll(PDO::FETCH_OBJ); 
```

此外，如果您想获得单个结果，请使用`fetch()`

```
$result = $stmt->fetch(PDO::FETCH_ASSOC); 
```

# java - 带有嵌入式数据库的 Java 桌面应用程序

> ID：13069195
> 
> 赞同：3
> 
> 时间：2012-10-25T13:01:04.010
> 
> 标签：java, database, netbeans, desktop-application

我正计划开始开发嵌入数据库的 java 桌面应用程序。它将是一个没有互联网连接的应用程序，仅用于插入、更新和删除数据库中的数据。会有很多数据。

那么，我想听听您的意见，我应该使用哪些库将数据库合并到应用程序中才能最终获得良好的性能？我应该使用已经与 netbeans 合并的 jdbc derby 吗？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T13:45:29.427

我多年来一直在生产中使用 Derby，它运行良好。H2 数据库看起来也不错，它应该提供比 Derby 更好的性能，但我没有在生产中使用它。这两者以及 HSQLDB 都是不错的选择，因为它们是纯 java，您需要做的就是将所需的 jar 文件与您的应用程序捆绑在一起。Sqlite 和 Berkely 是很好的产品，但不是用 Java 编写的，所以我想这些会更难使用。

您不需要任何特定的库。上述每个数据库都应该提供一个 JDBC 驱动程序，这是做事的标准方式。您当然可以使用 ORM，例如上面提到的 Hibernate。这使一些事情变得更简单，但如果你刚刚开始，最好一开始就避免这种情况。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T13:05:31.750

一些流行的选项是：

1.  [数据库](http://hsqldb.org)
2.  [伯克利数据库](http://www.oracle.com/technetwork/database/berkeleydb/overview/index-093405.html)
3.  [方镁石](http://www.sqlite.org)
4.  [德比](http://db.apache.org/derby/)

不可能说它们是否会“足够快”，因为它都是相对的。什么是足够快的？主机有多强大？你的数据集有多大？等等等等。

但是，我可以说我已经从 HSQLDB 看到了非常好的性能，在相当中等的桌面计算机上具有相当大的数据集（100K 记录 +）。我只为 android 探索过 Sqlite，但它在这个平台上非常令人印象深刻（考虑到它运行的硬件）。

我认为您应该做一些概念验证，并使用一些模拟数据对其进行测试。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-25T13:06:27.793

如果 Derby 可用，我会使用 Derby。HSQLDB 是另一个不错的选择。对于图书馆，我会查看一些用于数据库访问的图书馆。春天浮现在脑海。如果您可以控制数据库，我会考虑使用诸如 Hibernate 之类的 ORM 映射框架。

# java - 取消java上的复制操作

> ID：13069198
> 
> 赞同：0
> 
> 时间：2012-10-25T13:01:12.150
> 
> 标签：java, io, apache-commons, fileutils

我正在使用 Apache commons IO 来复制文件和目录，我需要添加取消功能。取消复制操作应该保留复制的文件，直到单击按钮。

以下代码用于复制：
**FileUtils.copyDirectory(srcDir, destDir);**

有什么想法可以取消此操作还是我需要更改复制代码以添加取消功能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T13:20:12.227

Commons-io 没有为取消/暂停/重启提供回调。

既然是开源的，你可以从源头做起，实现你所需要的。

# php - 使用虚拟邮箱配置 Postfix 以转发到脚本

> ID：13069199
> 
> 赞同：2
> 
> 时间：2012-10-25T13:01:15.247
> 
> 标签：php, mysql, postfix-mta, forwarding

我将 Postfix MTA 与 MySQL 的虚拟配置一起用于用户和转发。现在我希望将一些地址（动态生成，用于通过电子邮件写入论坛）转发到 php 脚本。

我已经尝试将引用和管道的脚本作为目标位它不起作用。"|php -q /path/to/script.php" 但是如果我向该域发送邮件，它会显示： 用户 "|php -q /path/to/script.php"@mydomain.tld not found

# python - Python：必须按 ctrl+c 才能得到结果

> ID：13069201
> 
> 赞同：1
> 
> 时间：2012-10-25T13:01:24.030
> 
> 标签：python, sockets, ports

我正在尝试创建一个 python 脚本来检查端口是否可用。下面是一段代码（不是整个脚本）。

但是当我运行脚本时，终端没有显示输出，当我按下 ctrl + c 时，我得到了脚本的一个结果，当我再次按下 ctrl+c 时，我得到了第二个结果。当脚本完成时，它终于退出了......

```
#!/usr/bin/python

import re
import socket
from itertools import islice

resultslocation = '/tmp/'
f2name = 'positives.txt'
f3name = 'ip_addresses.txt'
f4name = 'common_ports.txt'

#Trim down the positive results to only the IP addresses and scan them with the given ports in the common_ports.txt file

with open(resultslocation + f2name, 'r') as f2, open(resultslocation + f3name, 'w') as f3:
    hits = f2.read()
    list = re.findall(r'name = (.+).', hits)
    for items in list:
        ip_addresses = socket.gethostbyname(items)
        with open(resultslocation + f4name, 'r') as f4:
            for items in f4:
                ports = int(items)
                s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
                try:
                    s.connect((ip_addresses, ports))
                    s.shutdown(2)
                    print 'port', ports, 'on', ip_addresses, 'is open'
                except:
                    print 'port', ports, 'on', ip_addresses, 'is closed' 
```

我究竟做错了什么？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T13:14:28.070

默认情况下，套接字以阻塞模式创建。

因此，通常建议在调用`settimeout()`之前调用`connect()`或将超时参数传递给`create_connection()`并使用它而不是连接。由于您的代码已经捕获了异常，因此第一个选项很容易实现；

```
with open(resultslocation + f2name, 'r') as f2, open(resultslocation + f3name, 'w') as f3:
    hits = f2.read()
    list = re.findall(r'name = (.+).', hits)
    for items in list:
        ip_addresses = socket.gethostbyname(items)
        with open(resultslocation + f4name, 'r') as f4:
            for items in f4:
                ports = int(items)
                s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
                s.settimeout(1.0) # Set a timeout (value in seconds).
                try:
                    s.connect((ip_addresses, ports))
                    s.shutdown(2)
                    print 'port', ports, 'on', ip_addresses, 'is open'
                except:
                    # This will alse catch the timeout exception.
                    print 'port', ports, 'on', ip_addresses, 'is closed' 
```

# perl - 带占位符的 Regexp_like perl

> ID：13069202
> 
> 赞同：1
> 
> 时间：2012-10-25T13:01:26.457
> 
> 标签：perl, oracle

我需要一个查询来获取具有 az 后缀的名称。我知道 regexp_like 可以做到这一点。但是我应该如何将 regexp_like 与占位符一起使用？

`select id_name from name_table where regexp_like(name,'REM_45485[a-z]$');`

我应该如何使用占位符？感谢所有的建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T13:09:39.297

我认为你应该能够做到：

```
select id_name from name_table where regexp_like(name, ?); 
```

如果只有部分正则表达式来自占位符，请使用字符串连接：

```
select id_name from name_table where regexp_like(name, ? || '[a-z]$'); 
```

# php - 从亚马逊 S3 向 EC2 发出请求

> ID：13069204
> 
> 赞同：1
> 
> 时间：2012-10-25T13:01:29.703
> 
> 标签：php, javascript, ajax, amazon-s3, amazon-ec2

我正在使用 S3 存储生成的 HTML 和 JS 文件（来自 EC2 实例）。

我正在尝试从这些 JS 文件向我的 EC2 实例上的 PHP 文件发出 AJAX 请求。所以，我在我的 htaccess 中添加了这一行： Header set Access-Control-Allow-Origin *

当我在本地测试时，AJAX 请求是从 S3 向我的本地主机发出的，它运行良好。但是当我尝试向 EC2 发出这些请求时，我收到“Access-Control-Allow-Origin 不允许”消息......

有谁知道是否可以做这样的事情？如果没有，是否有动态将内容加载到 S3 文件？

谢谢

# arrays - 在 Mac 上将不同的数组从顶点传递到几何着色器

> ID：13069206
> 
> 赞同：2
> 
> 时间：2012-10-25T13:01:33.897
> 
> 标签：arrays, opengl, shader, vertex-shader, geometry-shader

我希望能够将每个顶点的任意数量的可变值从顶点着色器传递到几何着色器。我知道OpenGL没有动态数组，所以应该在编译时指定数字。整个过程应该在配备 NVIDIA GeForce 9400M 显卡和仅提供 OpenGL 2.1 的驱动程序以及一些扩展的 Apple MacBook 上运行。

这里的问题似乎是几何着色器以每个顶点一个元素的形式或数组的形式获取其输入。据我所知，我的设置中没有可用的数组数组，也没有包含数组的接口块数组。到目前为止，我能想到的最好的解决方案是指定一些变量来传递这些信息，这些信息是从顶点着色器中的数组中提取出来的，然后在几何着色器中变成具有一定步长的数组。这样，仍然可以使用计算的索引来执行对值的访问。

有没有更好、更优雅的方式？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-31T15:06:33.513

来自[EXT_geometry_shader4 规范](http://www.opengl.org/registry/specs/EXT/geometry_shader4.txt)：

> 用户定义的可变变量可以在顶点着色器中声明为数组。这意味着在输入到几何着色器时，必须将它们声明为二维数组。有关详细信息，请参阅 OpenGL 着色语言规范的第 4.3.6 和 7.6 节。

例如，在顶点着色器中，您可以指定

```
varying vec2 value[2]; 
```

在几何着色器中，这变成了一个二维数组，例如以三角形作为输入图元

```
varying in vec2 value[3][2]; 
```

注意数组索引的违反直觉的顺序！另请注意，必须使用整数常量明确指定数组维度。使用非常量整数变量或 gl_VerticesIn 会产生编译器错误。这两个评论都已在问题中提到的 MacBook Pro 型号上进行了测试。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T17:14:34.543

核心 OpenGL 的几何着色器不能像 EXT_geometry_shader4 那样工作是有原因的。这是其中之一。EXT_geometry_shader4 不允许输入数组，因为这意味着允许值数组的数组。而 GLSL 无法处理这个问题（好吧，直到最近，但这才 2 个月大）。

接口块*中可以*有数组。您的问题是 GLSL 1.20*没有 interface blocks*。

除了使用不同的变量并手动展开所有循环之外，您无能为力。您可以编写一个接受整数值并有条件地返回与该索引对应的不同值之一的函数，但这大约是您使用老式 GLSL 所能获得的最佳效果。

# sharepoint - 在 Sharepoint 中存储应用程序特定的配置数据？

> ID：13069212
> 
> 赞同：4
> 
> 时间：2012-10-25T13:01:58.623
> 
> 标签：sharepoint, web-config

我正在制作一个具有来自另一个主 Web 应用程序的功能的 Sharepoint 2010 WebPart。为了快速开发 Webpart，我导入了主 Web 应用程序中使用的业务逻辑程序集。Webpart 工作并从 Sharepoint web.config 文件中提取应用程序特定的配置信息。

这是存储这些信息的最佳位置吗？

如果不..

应用程序特定的配置数据应存储在哪里/如何存储在 Sharepoint 中？

配置数据包含 Web 服务的位置等项目。数据只需要由系统管理员编辑。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-25T17:53:32.230

恕我直言，Web.Config 是存储此类配置信息的糟糕场所——它难以部署且难以更改，尤其是在您使用多个 Web 前端时。

推荐的方法是通过 SPFarm、SPWeb.RootWeb（用于网站集）、SPWeb、SPList 等（取决于您需要的范围）的 .Properties 使用 PropertyBag（键/值对）。

[MSDN - 管理 SharePoint 应用程序的自定义配置选项](http://msdn.microsoft.com/en-us/library/ee855123(office.12).aspx#odcwss3_ManageCustConfigOptions_SharePtOptions)

有一个可用于生产的代码作为

[MSDN - SharePoint 指导库](http://msdn.microsoft.com/en-us/library/ff649628(v=pandp.10).aspx)

请参阅[分层配置管理器](http://msdn.microsoft.com/en-us/library/ff650495(v=PandP.10).aspx)

这使您能够以编程方式读取/写入这些值。如果您想在不使用指导库的情况下执行此操作，那么您将使用类似于以下代码的内容。

```
SPWeb web = SPContext.Current.Web;
if (web.Properties.ContainsKey("MyProperty"))
   string myProperty = web.Properties["MyProperty"]; 
```

如果您希望 UI 允许管理员轻松设置值，请使用[SharePoint 属性包设置之类的东西](http://pbs.codeplex.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T14:13:00.373

最简单的方法是创建仅对管理员可见的共享点列表。它可以有 3 列`description`, `title`, `value`. 它将存储所有配置值。您还可以将此列表的链接添加到站点设置页面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T14:52:14.857

网络配置总是一个好地方。但是，如果您想更改该数据，则必须强制执行某种站点重新编译，这对最终用户来说是一种痛苦。

在 codeplex 上有一个不错的小应用程序/解决方案与属性包值有关

[http://pbs.codeplex.com/](http://pbs.codeplex.com/)

这是一个与您的中央管理相关的出色的小应用程序/解决方案。

我认为它应该是内置的。

希望这可以帮助。

# sql - 从 x 年前开始计算运行总和

> ID：13069214
> 
> 赞同：5
> 
> 时间：2012-10-25T13:02:05.833
> 
> 标签：sql, postgresql, select, sum

我有一个实体名称、年份和活动编号的表格，如下所示。在某些年份，没有任何活动。

```
name | year | act_num
-----+------+---------
aa   | 2000 |       2
aa   | 2001 |       6
aa   | 2002 |       9
aa   | 2003 |      15
aa   | 2005 |      17
b    | 2000 |       3
b    | 2002 |       4
b    | 2003 |       9
b    | 2005 |      12
b    | 2006 |       2 
```

在 postgresql 上创建它；

```
CREATE TABLE entity_year_activity (
name character varying(10),
year integer,
act_num integer
);

INSERT INTO entity_year_activity
VALUES
    ('aa', 2000, 2),
    ('aa', 2001, 6),
    ('aa', 2002, 9),
    ('aa', 2003, 15),
    ('aa', 2005, 17),
    ('b', 2000, 3),
    ('b', 2002, 4),
    ('b', 2003, 9),
    ('b', 2005, 12),
    ('b', 2006, 2); 
```

我想获得过去 x 年的总数以及每个实体每年的今年活动数量，如下所示。

以 x = 三年为例。

```
name | year | act_num | total_3_years
-----+------+---------+---------------
aa   | 2000 |       2 |      2
aa   | 2001 |       6 |      8
aa   | 2002 |       9 |     17
aa   | 2003 |      15 |     30
aa   | 2004 |       0 |     24
aa   | 2005 |      17 |     32
b    | 2000 |       3 |      3
b    | 2001 |       0 |      3
b    | 2002 |       4 |      7
b    | 2003 |       9 |     13
b    | 2005 |      12 |     21
b    | 2006 |       2 |     14 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T13:16:29.373

[SQL小提琴](http://www.sqlfiddle.com/#!1/28f29/4)

```
select
    s.name,
    d "year",
    coalesce(act_num, 0) act_num,
    coalesce(act_num, 0)
    + lag(coalesce(act_num, 0), 1, 0) over(partition by s.name order by d)
    + lag(coalesce(act_num, 0), 2, 0) over(partition by s.name order by d)
    total_3_years
from
    entity_year_activity eya
    right join (
        generate_series(
            (select min("year") from entity_year_activity),
            (select max("year") from entity_year_activity)
        ) d cross join (
        select distinct name
        from entity_year_activity
        ) f
    ) s on s.name = eya.name and s.d = eya."year"
order by s.name, d 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-25T13:31:14.107

这是一种方法，它使用`sum`聚合作为具有基于范围的窗口框架的窗口函数的能力 - 查看`SUM(...) OVER (PARTITION BY name ORDER BY year ROWS 2 PRECEDING)`和[窗口框架](http://www.postgresql.org/docs/current/static/functions-window.html)。

```
WITH name_years(gen_name, gen_year) AS (
  SELECT gen_name, s
  FROM generate_series(
    (SELECT min(year) FROM entity_year_activity),
    (SELECT max(year) FROM entity_year_activity)
  ) s CROSS JOIN (SELECT DISTINCT name FROM entity_year_activity) n(gen_name)
),
windowed_history(name, year,act_num,last3_actnum) AS (
  SELECT
    gen_name, gen_year, coalesce( act_num, 0),
    SUM(coalesce(act_num,0)) OVER (PARTITION BY gen_name ORDER BY gen_year ROWS 2 PRECEDING)
  FROM name_years 
  LEFT OUTER JOIN entity_year_activity ON (gen_name = name AND gen_year = year)
)
SELECT name, year, act_num, sum(last3_actnum) as total_3_years
FROM windowed_history
GROUP BY name, year, act_num
HAVING sum(last3_actnum) <> 0
ORDER BY name, year; 
```

请参阅[SQLFiddle](http://sqlfiddle.com/#!12/e4b69/1)。

需要为本身没有条目的年份生成条目使此查询复杂化。我生成了一个包含所有 (name, year) 对的表，然后`left outer join entity_year_activity`在进行窗口求和之前在其上生成所有名称集的所有年份。这就是为什么事情如此复杂。然后我过滤聚合结果以排除总和为零的条目。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-25T13:09:15.353

```
SELECT en_key.name, en_key.year, en_key.act_num, SUM(en_sum.act_num) as total_3_years
FROM entity_year_activity en_key
  INNER JOIN entity_year_activity en_sum
     ON en_key.name = en_sum.name
WHERE en_sum.year BETWEEN en_key.year - 2 AND en_key.year
GROUP BY en_key.name, en_key.year 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-25T14:20:49.227

再试一次。但是，这个缺少 0 行年份：

```
select t1.name, t1.year, t1.act_num,
      (select sum(t2.act_num) from entity_year_activity t2
                              where t2.year between t1.year - 2 and t1.year
                                    and t2.name = t1.name) total
from entity_year_activity t1; 
```

# facebook-like - 如果用户未登录 Facebook，Facebook 之类的事件处理将不起作用

> ID：13069216
> 
> 赞同：1
> 
> 时间：2012-10-25T13:02:12.803
> 
> 标签：facebook-like, facebook-javascript-sdk

我有一个 Facebook 页面。我想知道一个人是否点击了like按钮并在`subscribe.event 'create-edge'`回调中做某事。如果一个人已经登录 Facebook，这可以正常工作。事件`'create-edge'`被触发。但是，如果一个人未登录，则不会触发此事件。

我没有`appId`，所以我什么都不发送。

供您参考的代码：

```
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:fb="http://ogp.me/ns/fb#" >
<head>
<meta charset="utf-8">
<title>Facebook Like Button</title>
</head>
<body>
<div id="fb-root"></div>
<script>
window.fbAsyncInit = function() {
FB.init({
  appId      : '', // App ID
  channelURL : '', // Channel File
  status     : true, // check login status
  cookie     : true, // enable cookies to allow the server to access the session
  oauth      : false, // enable OAuth 2.0
  xfbml      : true  // parse XFBML
});
FB.Event.subscribe('edge.create', function(response) {
    alert("say something");
    //my code
});
FB.Event.subscribe('auth.login', function(response) {
    alert('The status of the session is: ' + response.status);
});   
};

// Load the SDK Asynchronously
(function(d){
 var js, id = 'facebook-jssdk'; if (d.getElementById(id)) {return;}
 js = d.createElement('script'); js.id = id; js.async = true;
 js.src = "//connect.facebook.net/en_US/all.js";
 d.getElementsByTagName('head')[0].appendChild(js);
}(document));
</script>
<fb:like href="http://www.facebook.com/My_Page" send="false" layout="button_count"     width="450" show_faces="false"></fb:like>
</body>
</html> 
```

而且我也收到了这个错误：

> 在调用 FB.init() 之前调用 FB.getLoginStatus()。

好像我收到了，因为我没有`appId`要寄的东西`FB.init`。这是什么原因？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-03T18:30:32.767

如果用户已经喜欢您的页面并且未登录，则会发生这种情况。要解决此问题，我必须将 FB.init() 放入循环中.. 像这样：

```
setInterval(function()
        {
            FB.init({
                appId      : 'app_id'
                channelUrl : 'channel_url'
                status     : true, // check login status
                cookie     : true, // enable cookies to allow the server to access the session
                xfbml      : false  // parse XFBML
            });

        }, 5000); 
```

# javascript - 我什么时候需要backbone.js 中的模型？

> ID：13069218
> 
> 赞同：3
> 
> 时间：2012-10-25T13:02:18.247
> 
> 标签：javascript, backbone.js, model

我是 Backbone.js 的新手，从 JS 开发的“标准”模型中出来的人我有点不确定如何使用这些模型（或何时）。

视图看起来非常明显，因为它模拟了大多数 JS 开发人员熟悉的典型“监听事件并做某事”方法。

我构建了一个简单的待办事项列表应用程序，到目前为止还没有看到需要这个`model`方面，所以我很好奇是否有人可以给我一些关于如何将它应用到这个应用程序的见解，或者它是否可以发挥作用如果我正在处理更复杂的数据。

这是JS：

```
Todos = (function(){

    var TodoModel = Backbone.Model.extend({

      defaults: {
          content: null
      }

    });

    var TodoView = Backbone.View.extend({

      el: $('#todos'),
      newitem: $('#new-item input'),
      noitems: $('#no-items'),

      initialize: function(){
        this.el = $(this.el);
      },

      events: {
        'submit #new-item': 'addItem',
        'click .remove-item': 'removeItem'
      },

      template: $('#item-template').html(),

      addItem: function(e) {
        e.preventDefault();
        this.noitems.remove();
        var templ = _.template(this.template);
        this.el.append(templ({content: this.newitem.val()}));
        this.newitem.val('').focus();
        return this;
      },

      removeItem: function(e){
        $(e.target).parent('.item-wrap').remove();
      }

  });

  self = {};
  self.start = function(){
    new TodoView();
  };
  return self;

});

$(function(){

    new Todos(jQuery).start();

}); 
```

在这里运行：http: [//sandbox.fluidbyte.org/bb-todo](http://sandbox.fluidbyte.org/bb-todo)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T13:25:07.060

当您必须将更改*持久保存*到服务器时，需要[模型](http://backbonejs.org/#Model)和[集合。](http://backbonejs.org/#Collection)

 *例子：

```
var todo = new TodoModel(); 
```

创建一个新模型。当您必须保存保存更改时，请调用

```
todo.save(); 
```

您还可以将成功和错误回调传递给[save](http://backbonejs.org/#Model-save)。Save 是 jQuery 提供的 ajax 函数的包装器。

**如何在您的应用程序中使用模型。**

将 url 字段添加到您的模型

```
var TodoModel = Backbone.Model.extend({

  defaults: {
      content: null
  },
  url: {
      "http://localhost";  
  }

}); 
```

创建模型并保存。

```
addItem: function(e) {
        e.preventDefault();
        this.noitems.remove();
        var templ = _.template(this.template);
        this.el.append(templ({content: this.newitem.val()}));
        this.newitem.val('').focus();
        var todo = new TodoModel({'content':this.newitem.val()});
        todo.save();
        return this;
      }, 
```

确保您的服务器正在运行并设置 url 设置正确。

**学习资源：**

*   查看 Backbone 的带[注释](http://documentcloud.github.com/backbone/docs/backbone.html)的源代码，以很好地解释事情是如何在幕后落实到位的。
*   [这个 Quora 问题](http://www.quora.com/What-are-some-good-resources-for-Backbone-js)有很多很好的资源和示例应用程序的链接。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T13:20:11.373

如果您想在服务器端保存任何内容，该模型将非常有用。Backbone 的模型是围绕 RESTful 端点构建的。因此，例如，如果您将 URL 根设置为`lists`然后将列表信息存储在模型中，则模型`save`和`fetch`方法将允许您保存/接收描述模式的 JSON 到/从`lists/<id>`端点的服务器。IE：

```
 ToDoListModel = Backbone.model.extend( {
         urlRoot : "lists/" } );

   // Once saved, lives at lists/5
   list = new ToDoListModel({id: 5, list: ["Take out trash", "Feed Dog"] });
   list.save(); 
```

因此，您可以使用它与通过 RESTful 接口保留在服务器上的数据进行交互。有关更多信息，请参阅[本教程](http://backbonetutorials.com/what-is-a-model/)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-25T16:32:43.860

我不同意`model`只需要持久更改的想法（我在这里包括 LocalStorage，而不仅仅是服务器）。

拥有模型和集合的表示是很好的，这样您就可以使用对象而不仅仅是视图。在您的示例中，您只是在页面中添加和删除 div（html），这是您可以使用 jQuery 通常执行的操作。`Model`每次执行“添加”时都创建并添加到 a中，并且可能在`Collection`清除时将其删除，这将为您带来一些好处，例如排序（按字母顺序）或过滤（如果您想实现“完成”的概念-做）。

在您的代码中，例如：

```
var TodoModel = Backbone.Model.extend({
    defaults: {
        content: null
        complete: false
    }
});

var Todos = Backbone.Collection.extend({
    model: TodoModel
}) 
```

在视图中（跳过无关代码）：

```
// snip....
addItem: function(e) {
    e.preventDefault();
    this.noitems.remove();
    var templ = _.template(this.template);
    var newTodo = new TodoModel({ content: this.newitem.val() });
    this.collection.add(newTodo); // you get the collection property from free from the initializer in Backbone
    this.el.append(templ({model: newTodo})); // change the template here of course to use model
    this.newitem.val('').focus();
    return this;
}, 
```

像这样初始化：

```
self.start = function(){
    new TodoView(new Todos());
}; 
```

现在你有了一个支持集合，你可以做各种各样的事情，比如过滤。假设您有一个用于过滤已完成待办事项的按钮，您可以挂钩此处理程序：

```
_filterDone: function (ev) {
    filtered = this.collection.where({ complete: true });
    this.el.html(''); // empty the collection container, I used "el" but you know where you are rendering your todos
    _.each(filtered, function (todo) {
        this.el.append(templ({model: todo})); // it's as easy as that! :)
    });
} 
```

请注意，如果您的事件与内部视图挂钩，那么清空容器可能不是最好的事情，但作为初学者，这可以正常工作。

你可能需要一个钩子来设置待办事项。创建一个按钮或复选框，也许还有这样的功能：

```
_setDone: function (ev) {
    // you will need to scope properly or "this" here will refer to the element clicked!
    todo = this.collection.get($(ev.currentTarget).attr('todo_id')); // if you had the accuracy to put the id of the todo somewhere within the template
    todo.set('complete', true);
    // some code here to re-render the list
    // or remove the todo single view and re-render it
    // in the simplest for just redrawr everything
    this.el.html('');
    _.each(this.collection, function (todo) {
        this.el.append(templ({model: todo}));
    });
} 
```

如果没有模型和集合，上面的代码就不会那么容易了，你可以看到它与服务器没有任何关系。*

# c++ - 在 OpenGL 中跟踪圆形鼠标移动

> ID：13069220
> 
> 赞同：3
> 
> 时间：2012-10-25T13:02:20.973
> 
> 标签：c++, opengl, mouse

我正在用 C++ 开发一个简单的网格查看器实现，它具有平移、旋转、缩放等基本功能。我坚持使用鼠标实现对象沿 z 轴的旋转。我要实现的是以下内容：

1.  垂直单击并拖动鼠标（几乎垂直即可，因为我使用简单的阈值来过滤沿水平轴的轻微偏差）以沿 y 轴旋转对象（此部分已完成）。
2.  如上所述，单击并水平拖动鼠标以沿 x 轴旋转对象（这部分也已完成）。
3.  对于 z 轴旋转，我想检测圆形（或沿弧形）鼠标移动。我被这部分困住了，不知道如何实现。

对于以上两个，我只是使用 atan2() 来确定运动的角度。但是如何检测圆周运动？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T13:52:55.563

这不完全是您想要的，但应该足够接近。

选择一个圆形区域，其中编号为 1 和 2 的动作按照描述在其中工作（在图片中，这将是一些小于红色圆圈的区域。但是，当用户在圆形区域外单击时，您会保存初始单击位置（以绿色显示）。这定义了一个相对于屏幕 x 轴具有一定角度的点（您可以通过一些三角函数轻松找到它），它还定义了用户正在工作的圆的半径（红色）。释放鼠标会添加第二个点（蓝色）。然后您会找到该点相对于屏幕中心和 x 轴的角度（就像以前一样）。然后您将该角度投影到您的圆，半径由第一次单击确定。深红色的弧线定义了模型的旋转量。

![在此处输入图像描述](../Images/e2090b079f014ddcbe7aabb76616a51a.png)

这应该足以让你开始。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T13:29:38.077

The only way to deal with this is to have a delay between the user starting to make the motion and the object rotating:

When user clicks and begins to move the mouse you need to determine if its going to become a straight line movement, or a circular one. This will require a certain amount of data to be collected before that judgement can be made.

The most extreme case would be requiring the user to make one complete circle first, then the rotation begins (in reality you could do much better than this). Just how small you are able to cut this period down to will depend on a) how precise you dictate your users actions must be, and b) how good you are with pattern recognition algorithms.

To get you started heres an outline of an extremely poor algorithm:

On user click store the x and y coordinates. Every 1/10 of a second store the new coordinates and process_for_pattern.

in process_for_pattern you're looking for:

A period where the x coordinates and the y coordinates regularly both increase, both decrease, or one increases and one decreases. Over time if this pattern changes such that either the x or the y begins to reverse whilst the other continues as it was, then at that moment you can be fairly sure you've got a circle.

This algorithm would require the user to draw a quarter circle before it was detected, and it does not account for size, direction, or largely irregular movements.

If you really want to continue with this method you can get a much better algorithm, but you might want to reconsider your control method.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T13:11:25.573

我不认为它像那样工作......

您可以将鼠标滚轮旋转转换为 z 轴，或使用四元数相机方向，它几乎可以直观地沿每个轴旋转......

对于四分位数相机，情况正好相反：如果尝试沿直线旋转网格，则网格似乎会围绕其他一些奇怪的轴轻微旋转——为了弥补这一点，人们会直觉地尝试遵循一些略微弯曲的轨迹。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T14:02:20.103

我认为这不是一个好的输入法。因为您总是需要一些行进距离来区分直线和曲线，这意味着一些输入延迟。这是一个替代方案：

只有直线穿过屏幕中心的垂直鼠标才被认为是垂直的。水平也一样。在其他情况下，它被认为是一个旋转，为了计算它的幅度，计算最后一个鼠标位置和当前位置之间相对于屏幕中心的角度。

或者，如果您的应用程序是这样工作的，您可以使用所选网格的中心。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-25T14:21:35.870

您无法检测到接近 3D 模型查看所需精度的“圆形，沿弧线”鼠标移动。你想要的是这样的：[http ://thetechartist.com/?p=80](http://thetechartist.com/?p=80)

您可以使用可以用鼠标抓取的键盘快捷键或屏幕上的轴指示器来指定轴（x、y 或 z）。

这将比尝试检测“弧”手势精确得多。当您积累足够的鼠标样本来决定弧形手势是否已经开始时，任何“弧形”识别都必然会涉及延迟。像这样的手势识别很重要（我已经用 Wii-mote 做了一些手势工作）。同样，即使是简单的“垂直”和“水平”鼠标移动检测也出于同样的原因需要延迟。任何“过滤细微偏差的简单阈值”都会让人感到压抑和怪异。

对于 3d 查看，您需要 1:1 的鼠标响应，这意味着只需使用快捷键或 UI 等明确指定一个轴。对于 x 轴旋转，只需将其限制为鼠标 x，y 轴限制为鼠标 y。对于 z，您可以类似地限制 x 或 y 鼠标输入，或者只取总的 2d 鼠标移动距离。这取决于你觉得什么感觉最好。

作为替代方案，您可以尝试编写对 3D 鼠标（如[3dConnexion SpaceExplorer](http://www.3dconnexion.com/products/spaceexplorer.html) ）的支持。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-25T13:16:31.130

也许，您应该定义一个屏幕区域（例如，在窗口边界处），当单击该区域时，将启动弧形移动 - 或使用其他修饰符、按钮或其他任何东西。

然后单击鼠标，您可以在 2D 屏幕空间中捕获坐标和旋转中心（网格轴）。这会给你一个矢量（网格中心，按钮向下位置）

在每次鼠标移动时，您都会计算一个新向量（网格中心，鼠标位置），两个向量之间的角度就是旋转角度。

# android - Android 应用架构 - 如何避免片段服务代码重复

> ID：13069225
> 
> 赞同：2
> 
> 时间：2012-10-25T13:02:35.693
> 
> 标签：android, architecture, android-fragments

我的应用程序有几个`Fragments`. 每个都`Fragment`启动一个`Service`对来自服务器的资源的 GET 请求。每个响应都是一个 json 数组，该数组被解析为对象并保存到数据库表中，然后`Intent`广播到启动服务的 Fragment 以查询有问题的表并在列表中显示对象。因此，每个 fragment-service-dbtable 处理一个唯一类型的对象，但除此之外，每个 Fragment-Service 对的代码基本相同：

```
NewsFragment, NewsPostsRequestService (deals with NewsPostObjects)
UserFragment, UserRequestService (deals with UserObjects)
FavoritesFragment, FavoritesRequestServices (deals with FavsObjects) 
```

等等。

如何避免代码重复，让一个片段和一个服务可以用于所有请求？一种选择是将状态作为参数传递：

```
CustomFragment fragment = CustomFragment.newInstate(NewsState); 
```

然后做（伪代码）：

```
if(mState==NEWS) apiRequest("/news")
else if(mState==USERS) apiRequest("/users") 
```

等等。

但是，我理想中想要的解决方案是片段和服务完全独立于它们请求的资源，数据库表它们的保存和对象类型它们的处理，并且可以轻松添加新请求。如何做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T13:47:13.773

我认为你应该能够通过继承来解决这个问题。为公共代码实现 AbstractService 和 AbstractFragment ，然后在每个中为更改的内容添加抽象方法。

```
AbstractFragment<T>
AbstractPostsRequestService<T>
apiRequest(getRequestPath())
abstract String getRequestPath();

NewsFragment extends AbstractFragment<NewsPostObjects>
NewsPostsRequestService extends AbstractPostsRequestsService<NewsPostObjects>
String getRequestPath() {return "/news";} 
```

等等

# javascript - 什么是 PPB_Graphics2D.PaintImageData：矩形超出范围。铬错误？

> ID：13069227
> 
> 赞同：5
> 
> 时间：2012-10-25T13:02:41.777
> 
> 标签：javascript, google-chrome, browser

在此页面中：

[http://www.rockit.it/deniseproject/album/uninverse/20598](http://www.rockit.it/deniseproject/album/uninverse/20598)

当我在曲目列表上按“播放”时，浏览器开始出现错误。这似乎只是一个谷歌浏览器的问题。

你知道如何阻止这些错误吗？它似乎与用于听音乐的 swf 播放器相连，它是通过 javascript 控制的，它嵌入了 1 像素宽和 1 像素高。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T14:34:54.720

这是 Chromium PPAPI 的内部日志。这是问题的链接： [http ://code.google.com/p/chromium/issues/detail?id=141609](http://code.google.com/p/chromium/issues/detail?id=141609)

现在它已在当前的 Chrome 稳定版中得到修复。

# apache - 从 URL 中删除第二个问号

> ID：13069229
> 
> 赞同：0
> 
> 时间：2012-10-25T13:02:48.810
> 
> 标签：apache, .htaccess, mod-rewrite

外部应用程序使用以下 URL 调用我的网站： [http ://www.mydomain.com/index.php?route=checkout/success?ref=56](http://www.mydomain.com/index.php?route=checkout/success?ref=56)

这显然是错误的（因为它有 2 个问号）。

如何编写 .htaccess 重写规则将第二个问号转换为 ambersand (&) ？(http://www.mydomain.com/index.php?route=checkout/success&ref=56)

我已经尝试过了，但它不起作用。

```
RewriteEngine on
RewriteRule \? \& [L] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T22:29:02.987

经过一番研究，我想出了这个

```
RewriteCond %{QUERY_STRING} ^(.*)?\?ref=(.*)&?(.*)$
RewriteRule (.*) /$1?%1&ref=%2%3 [L] 
```

我不知道它是否是最好的，但它肯定有效

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T13:38:22.227

```
RewriteEngine on
RewriteRule /(.*)?(.*)?ref=(.*)$ /$1?$2&ref=$3  [R]
  RewriteLogLevel 9
RewriteLog "/var/log/rewrite.log" 
```

必须承认我没有看到它在我的最终工作，但它应该几乎在那里 - 启用重写日志，因此可以更容易地调试它

# dreamweaver - Sublime Text 2 像dreamweaver一样拆分活动屏幕

> ID：13069233
> 
> 赞同：2
> 
> 时间：2012-10-25T13:03:00.303
> 
> 标签：dreamweaver, sublimetext2, live-preview

在工作中，我必须跳入旧的 mysql_query 程序网站构建 higgledy-piggledy （一些 var 是驼峰式和下划线，没有缩进代码，页面是在表中构建的......）

无论如何，通常我使用 ST2，但在这里我不能。所以要搜索我的行代码，我使用dreamweaver 单击屏幕预览并将光标放在我想要的代码行上。我不喜欢也不知道dreamweaver。但由于代码是不可读的，这是我必须工作的唯一方法。（我的老板不想重建这些网站）。

这是我的问题，是否有人知道 ST2 的一种方式（或插件）来分屏并单击屏幕预览以直接进入代码行，就像 dreamweaver 预览一样？

问候。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-09T01:11:08.233

试试[Sublime CodeIntel](https://github.com/Kronuz/SublimeCodeIntel)，[这个页面](http://www.henriquebarroso.com/my-top-10sublime-2-plugins/)也说：

> *...这个插件为 ST2 带来了一些 IDE 功能。该插件读取您的所有代码，并能够完成代码、跳转到定义和函数调用工具提示。虽然有时看起来有点马车，但仍然值得拥有它。这可以节省大量时间，尤其是在您处理其他人的代码时。*

如果适合该项目，您可以稍后删除该包。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T21:53:04.870

答案很简单，你永远找不到这样的东西。

试试这里 - [http://webdesign.about.com/od/windowshtmleditors/tp/windows-wysiwyg-editors.htm](http://webdesign.about.com/od/windowshtmleditors/tp/windows-wysiwyg-editors.htm)

WYSWIG html 编辑器。

# git - 为什么“git push heroku master”会上传我的所有数据而不仅仅是更改？

> ID：13069235
> 
> 赞同：0
> 
> 时间：2012-10-25T13:03:09.127
> 
> 标签：git, heroku

当我将更改推送到 github 时，它只会推送更改。几KB。

```
git push origin 
```

当我将相同的更改推送到heroku时。

```
git push heroku master 
```

它上传所有数据，在我的例子中是 35MB。为什么是这样？我能做些什么呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T13:26:49.913

传输的数据量`git push`取决于本地和远程分支的状态。如果你`git push heroku master`再来一次会怎样？如果自上次推送以来您的本地分支没有任何更改，则传输应该小得多。

# javascript - Jquery - 创建后隐藏元素

> ID：13069238
> 
> 赞同：-1
> 
> 时间：2012-10-25T13:03:31.580
> 
> 标签：javascript, jquery

创建元素的功能：

```
function create_image(){
        <?php if(isset($avatar)) : ?>
            var brojac = 5;
        <?php else: ?>
            var brojac = 4;
        <?php endif; ?>
        var broj_slike = (5 - brojac) + 1,
        slike;
        for (var i = 0; i < brojac; i++) {
            slike += '<label for="image'+ broj_slike +'">Slika ' + broj_slike + '</label><input type="file" name="userfile" id="image' + broj_slike + '" />';
            broj_slike++;
        };
        return slike;
     } 
```

在页面上插入元素的函数：

```
var code = $('#code'),
     id = $('input[name=id]').val(),
     url = '<?php echo base_url() ?>mali_oglasi/mgl_check_paid';
     code.on('focusout', function(){
        var code_value = $(this).val();
        if(code_value.length != 16 ) {
            if ($('p[role=code_msg]').length != 0 ) $('p[role=code_msg]').remove() ;
            code.after('<p role=code_msg>Pogrešan kod je unešen.</p>');
        } else {
            if ($('p[role=code_msg]').length != 0 ) $('p[role=code_msg]').remove() ;
            $.post(url, {id : id, code : code_value}, function(data){
                if($.trim(data) != 'TRUE'){
                    code.after('<p role=code_msg>Uneti kod je neispravan.</p>');
                } else {
                    /*This part here put elements on the page*/
                    code.after('<p role=code_msg>Status malog oglasa je promenjen.</p>')
                    .after(create_image()).hide();
                    code.prev().remove();
                    code.remove();
                }
        });
        }
     }); 
```

如何隐藏新元素？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T13:06:11.847

我还没有看到完整的代码，但是隐藏元素就像使用 hide 方法一样简单。

```
$('<div/>').appendTo('#el').hide(); 
```

我正在创建元素并将其插入到 dom 中，然后再隐藏它——如果我理解正确的话，这个例子应该类似于你的。（但是，在 dom 中插入一个元素以在之后立即隐藏它是一种不好的做法 - 最好将其插入已隐藏的 dom 中 - 这样可以防止不必要的回流）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T13:24:12.077

我会在元素被添加到 DOM 之前隐藏它。

```
$('<div>').css({"display": "none"}).appendTo(elementInDOM); 
```

或者

```
$(elementInDOM).append(
   $('<div>').css({"display": "none"})
); 
```

我相信还有很多其他方法！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T13:05:18.563

有了这个：[`$(jqueryelement).hide()`](http://api.jquery.com/hide/)

# c# - 正则表达式允许非ASCII和外国字母？

> ID：13069240
> 
> 赞同：4
> 
> 时间：2012-10-25T13:03:33.763
> 
> 标签：c#, .net, regex

是否可以创建一个正则表达式以允许非 ascii 字母与拉丁字母一起使用，例如中文或希腊符号（例如允许 A汉语AbN汉语）？

我目前有以下`^[\w\d][\w\d_\-\.\s]*$`只允许拉丁字母。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-25T13:14:37.510

在 .NET 中，

```
^[\p{L}\d_][\p{L}\d_.\s-]*$ 
```

相当于您的正则表达式，另外还允许其他 Unicode 字母。

**解释：**

`\p{L}`是 Unicode 属性“字母”的简写。

警告：我*认为*您不想允许下划线作为初始字符（仅在第二个字符类中存在证明）。由于`\w`包含下划线，因此您的正则表达式确实允许它。您可能希望将它从我的解决方案中的第一个字符类中删除（当然，它*不*包含在`\p{L}`中）。

在 ECMAScript 中，事情并不那么容易。您必须定义自己的 Unicode 字符范围。幸运的是，StackOverflow 的一位用户已经站出来设计了一个 JavaScript 正则表达式转换器：

[https://stackoverflow.com/a/8933546/20670](https://stackoverflow.com/a/8933546/20670)

# jsf-2 - 摆脱 web.xml 警告：“对 PrimeFacesFileUploadFilter 的属性过滤器名称引用不是过滤器”？

> ID：13069249
> 
> 赞同：0
> 
> 时间：2012-10-25T13:03:59.227
> 
> 标签：jsf-2, primefaces

我在使用 PrimeFaces 库的 JSF 项目的 web.xml 文件中收到警告。

```
Attribute filter-name references to PrimeFacesFileUploadFilter that is not a filter 
```

看来代码没问题：

```
<filter>
    <filter-name>PrimeFacesFileUploadFilter</filter-name>
    <filter-class>org.primefaces.webapp.filter.FileUploadFilter</filter-class>
</filter>
<filter-mapping>
    <filter-name>PrimeFacesFileUploadFilter</filter-name>
    <servlet-name>Faces Servlet</servlet-name>
</filter-mapping> 
```

代码工作正常，但我能以某种方式摆脱这个警告吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T13:29:53.310

此警告不是来自 JSF、PrimeFaces 或 Servlet 过滤器。它来自 IDE 或其插件之一。谷歌搜索[确切的警告信息](http://google.com/search?q=%22Attribute%20filter-name%20references%20to%22%20%22that%20is%20not%20a%20filter%22)会导致我们（在您自己的问题中）找到[JBoss Tools 问题 10579](https://issues.jboss.org/browse/JBIDE-10579)。它是由错误的验证引起的（它也需要一些元素），并且*在*`<filter-name>`3.3.0.Beta1 中已修复。

因此，使用最新的稳定版本 3.3.0，您应该不会再收到此警告。同时，您可以通过`<description>`在`<filter-name>`.

```
<filter>
    <description>PrimeFaces file upload filter</description>
    <filter-name>PrimeFacesFileUploadFilter</filter-name>
    <filter-class>org.primefaces.webapp.filter.FileUploadFilter</filter-class>
</filter> 
```

# mysql - SQL类表继承，如何搜索字段

> ID：13069251
> 
> 赞同：0
> 
> 时间：2012-10-25T13:04:23.810
> 
> 标签：mysql, sql

我使用类表继承[http://martinfowler.com/eaaCatalog/classTableInheritance.html](http://martinfowler.com/eaaCatalog/classTableInheritance.html) 来存储不同类型的产品。

我想知道在这些表中搜索的最佳方法。

假设所有表格名称都在表格中`'product_%product_type%'`，并且我想搜索具有蓝色的产品。

颜色字段可能不会出现在所有表中。

我考虑 SHOW TABLES LIKE product_%，然后 SHOW COLUMNS FROM (result) LIKE 'color' 以获取具有该列的所有表，然后从结果中执行我的 SELECT。

还有其他解决方案吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T14:41:21.127

将颜色属性拉入 ProductColor 表中。

对于您的对象模型映射，请将其视为“套头衫实现 ProductColor”。

# vb.net - 将 Adob e Acrobat Viewer 进程杀死为免费的 pdf

> ID：13069252
> 
> 赞同：0
> 
> 时间：2012-10-25T13:04:25.473
> 
> 标签：vb.net

我有一个应用程序，它使用网络浏览器窗口来查看多种类型的文档。其中一种文档类型是 pdf 文件。在查看此文件并在表单中选择某些标准后，它将被上传到数据库。然后我想做的是将文件更多地放到我已经创建的临时目录中。问题是即使我已经从网络浏览器中删除了 pdf，一个进程仍然持有该 pdf。所以显然问题是adobe acrobat在后台运行并且仍然保留文件。

我确实修复了它..但不是以我满意的方式。本质上，我在程序中运行了一个 shell 脚本并杀死了 AcroRD32.exe。这释放了文件并让我能够移动。我真的不喜欢这样做......不是很优雅。有没有更好的方法来处理这种情况？

# javascript - 取消定义方法 submit_to_remote

> ID：13069256
> 
> 赞同：0
> 
> 时间：2012-10-25T13:04:43.063
> 
> 标签：javascript, ruby-on-rails, ruby-on-rails-3, jquery, ajax-on-rails

```
<%= submit_to_remote(:category, :url => params[:id].blank? ? {:action => 'create'} : {:action => "update", :id => @category}) do %>
    <table>
        <tr>
            <th>Name</th>

        </tr>

        <tr>
            <td><%= text_field(:category, :name, :size => 20) %></td>
            <td><%= submit_tag(params[:id].blank? ? "New": "Edit") %></td>
        </tr>
    </table>
<% end %> 
```

我想使用 Ajax 创建新记录。我收到**错误未定义的方法 submit_to_remote**我在布局中声明了原型文件。等待回答.......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T13:08:44.477

首先，看起来您`submit_to_remote`正在尝试定义`form`- 所以使用`form_for`or `form_tag`。

其次`submit_to_remote`，Rails 3 中不再存在。您需要 的`:remote => true`选项`form_tag`，这将使 UJS（Unobtrusive JavaScript）介入并使 AJAX 发生。

查看[一些文档](http://apidock.com/rails/ActionView/Helpers/FormTagHelper/form_tag)。

# ios - 使用 AFNetworking API 的 NSURLCache 图像

> ID：13069257
> 
> 赞同：1
> 
> 时间：2012-10-25T13:04:45.600
> 
> 标签：ios, image, caching, afnetworking

我有一个从服务器下载图像的应用程序。图片大约 56 KB，至少有 30 张。有时用户要么没有连接，要么没有边缘连接（拨号）。

我在我的 AppDelegate.h 中使用 NSURLCache，如下所示：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {   
    int cacheSizeMemory = 4*1024*1024; // 4MB
    int cacheSizeDisk = 32*1024*1024; // 32MB
    NSURLCache *sharedCache = [[[NSURLCache alloc] initWithMemoryCapacity:cacheSizeMemory diskCapacity:cacheSizeDisk diskPath:@"nsurlcache"] autorelease];
    [NSURLCache setSharedURLCache:sharedCache]; 
```

但由于某种原因，它不会缓存图像。如果我加载所有可用互联网连接的图像，然后断开连接或使用 Edge 网络，它会再次获取图像。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T13:15:04.547

*编辑*：如果您使用 NSURLRequest 的 NSURLRequestReturnCacheDataElseLoad cachePolicy 或返回适当的 Cache-Control 标头，iOS 5 及更高版本支持磁盘缓存。

这个关于缓存的问题在[AFNetworking FAQ](https://github.com/AFNetworking/AFNetworking/wiki/AFNetworking-FAQ)中有解释。

总而言之，似乎在 iOS 上，`NSURLCache`不提供磁盘缓存功能，即使您创建一个`NSURLCache`with a `diskCapacity>0`（似乎被忽略），解决方案是使用一些其他实现，`NSURLCache`如[`SDURLCache`](https://github.com/steipete/SDURLCache)常见问题解答中建议的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T17:47:54.337

您需要访问服务器以确保它为每个请求发送回缓存控制标头，以便 NSURLCache 可以使用。如果您没有或无法获得该设置（如在我的场景中），您将需要滚动自己的缓存层或使用 SDURLCache 或 RNCachingURLProtocol 之类的东西。

# php - 嵌入播放器无法连接到网络 - CURL

> ID：13069260
> 
> 赞同：2
> 
> 时间：2012-10-25T13:04:56.130
> 
> 标签：php, flash, curl, streaming, media-player

我已经使用 CURL 制作了登录到提供免费流媒体的页面的脚本，然后使用 CURL，我将使用选择的流来观看子页面。

脚本通过 localhost 运行时一切正常（我使用的是 xampp），但是当我将它放在我的网络服务器上时，它说它无法连接到网络。唯一看起来不同的是 cookie，在 Web 服务器上它没有新行 /n。一切都在一条线上。

如何处理？这是我的课程，我用它来连接页面：

```
class openTV {

public $channel;

function __construct($channel) {
    $this -> channel = $channel;    
}

function openChannel() {

    $login_email = 'mail@gmail.com';
    $login_pass = 'pass';

    $fp = fopen("cookie.txt", "w");
    fclose($fp); 

    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL, 'http://strona/user/login');
    curl_setopt($ch, CURLOPT_POSTFIELDS,'email='.urlencode($login_email).'&password='.urlencode($login_pass));
    curl_setopt($ch, CURLOPT_POST, 1);
    curl_setopt($ch, CURLOPT_HEADER, 0);
    curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);
    curl_setopt($ch, CURLOPT_COOKIEJAR, 'cookie.txt');
    curl_setopt($ch, CURLOPT_COOKIEFILE, 'cookie.txt');
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
    curl_setopt($ch, CURLOPT_USERAGENT, "Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.3) Gecko/20070309 Firefox/2.0.0.3");
    curl_setopt($ch, CURLOPT_REFERER, "http://strona/user/login");
    $page = curl_exec($ch);

    curl_setopt($ch, CURLOPT_URL, $this->channel);
    curl_setopt($ch, CURLOPT_USERAGENT, "Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.3) Gecko/20070309 Firefox/2.0.0.3");
    curl_setopt($ch, CURLOPT_REFERER, $this->channel);
    curl_setopt($ch, CURLOPT_COOKIEFILE, 'cookie.txt');
    curl_setopt($ch, CURLOPT_POST, 0);
    $info = curl_getinfo ($ch);
    $page = curl_exec($ch);

    preg_match('/session_token=\[[a-zA-Z0-9]{8}\]/', $page, $matches);
    $return['token'] = substr($matches[0], 31, 8); 

    preg_match('/<object(.*)>[.\s\S]*<\/object>/', $page, $matches);
    $return['player'] = $matches[0];
    //$return['player'] = $page;

    $return['channel'] = $this->channel;

    return $return;

}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T13:08:50.780

您正在`http://strona/`用作您的主机。

您的服务器可能使用不同的配置，当它无法直接找到主机时不会尝试附加`.example.com`，在 Linux 上可以看到[`/etc/resolve.conf`](http://theos.in/desktop-linux/resolve-conf-linux-example/)：

```
search example.com
nameserver 1.2.3.4 
```

使用完整的域名 ( `http://strona.example.com`) 或 IP 应该可以解决问题。

如果不是这样，请尝试您是否能够从服务器 ping（或以其他方式连接）到目标主机，这可能是网络问题。

# richfaces - JSF 应用程序从 JBoss AS 6 迁移到 7 - a4j:jsFunction 行为异常

> ID：13069266
> 
> 赞同：2
> 
> 时间：2012-10-25T13:05:13.120
> 
> 标签：richfaces, jboss7.x, mojarra

我目前正在将一个 JSF 应用程序（当前使用 JBoss AS6 / Mojarra 2.1.6 / RichFaces 4.1.0 运行）迁移到 JBoss 7.1.1，其中包含 JSF 实现（修改后的 Mojarra 2.1.7 afaik）。

现在，在我的代码中的某个时刻，我正在使用 a4j:jsFunction：

```
<a4j:jsFunction id="copyItems" name="copyItems" status="loader" render="popUpWindow" rendered="#{!cc.attrs.showForecasts}">
    <a4j:param name="selection" assignTo="#{itemListController.selectedItems}" />
</a4j:jsFunction> 
```

在 itemListController 我们有这样的设置：

```
public class ItemListController
{
    private String[] selectedItems;

    public void setSelectedItems(String[] selectedItems)
    {
        this.selectedItems = selectedItems;
    }

    //Getter for selectedItems and lots of other stuff follows here...
} 
```

在我的代码中，我有一个带有这个 onclick 处理程序的 a4j commandLink：

```
onclick="copyItems(['1']);" 
```

在 JBoss6 中，这导致了对 setSelectedItems() 的调用，其中 selectedItems 是一个包含字符串“1”的字符串数组。

然而，在 JBoss7 中，我收到一个异常，基本上说“字符串 1 不能转换为字符串”。

有任何想法吗？

# mobile - 用于测试和修改的简单 GSM 网络模拟器

> ID：13069276
> 
> 赞同：1
> 
> 时间：2012-10-25T13:05:46.557
> 
> 标签：mobile, simulation, simulator, gsm

有人可以为我提供最简单和最好的 GSM 网络模拟器之一，以便我可以对其进行测试并在基站（BSC）和 BTS 中进行一些修改...谢谢

# java - JNA - WriteProcessMemoryFloat（如何编写）

> ID：13069280
> 
> 赞同：1
> 
> 时间：2012-10-25T13:06:09.260
> 
> 标签：java, jna, kernel32

我需要在 JNA 中编写此方法：**WriteProcessMemoryFloat**。在c#中是这样写的 `[DllImport("kernel32", EntryPoint = "WriteProcessMemory")] private static extern float WriteProcessMemoryFloat(int Handle, int Address, ref float Value, int Size, ref int BytesWritten);` 但是在JNA中我不知道如何写EntryPoint。有谁知道如何做到这一点？

# ruby - Sinatra 对 gem 视而不见？

> ID：13069285
> 
> 赞同：0
> 
> 时间：2012-10-25T13:06:21.267
> 
> 标签：ruby, gem, sinatra

我正在使用 Sinatra + rack-flash3 gem。我安装了它，但尽管如此，它还是引发了异常。这里有一个`layout.haml`

```
!!!5
%html
  %body
    .my_div
      != haml :"shared/_flash"
      != yield 
```

和`_flash.haml`

```
.my-div2
  .flash-notice
    - if flash[:notice]
      .alert.alert-success
        = flash[:notice]
    - if flash[:error]
      .alert.alert-error
        = flash[:error]
    - if flash[:info]
      .alert.alert-info
        = flash[:info] 
```

错误是

```
undefined local variable or method `flash' for #<App:0x00000004226c90>
file: _flash.haml location: evaluate_source line: 3 
```

我想知道为什么会这样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T13:18:21.253

您是否正确地将 rack-flash3 包含到您的 sinatra 应用程序中？你必须`use Rack::Flash`在你的应用程序的顶部，像这样：

```
require 'sinatra/base'
require 'rack-flash'

class MyApp < Sinatra::Base
  enable :sessions
  use Rack::Flash

  post '/set-flash' do
    # Set a flash entry
    flash[:notice] = "Thanks for signing up!"

    # Get a flash entry
    flash[:notice] # => "Thanks for signing up!"

    # Set a flash entry for only the current request
    flash.now[:notice] = "Thanks for signing up!"
  end
end 
```

来源：[http ://rubydoc.info/gems/rack-flash3/1.0.1/frames](http://rubydoc.info/gems/rack-flash3/1.0.1/frames)

# css - iOS模拟器中缺少图标的按钮？

> ID：13069288
> 
> 赞同：1
> 
> 时间：2012-10-25T13:06:30.497
> 
> 标签：css

视频图标在**火狐浏览器**上是可以的，如下所示：

[对齐顶部 http://www.kerrydeaf.com/net.png](http://www.kerrydeaf.com/net.png "工具提示")

**iOS6 模拟器**上缺少视频图标，如下所示：

[对齐顶部 http://www.kerrydeaf.com/ios.png](http://www.kerrydeaf.com/ios.png "工具提示")

这是CSS3：

```
 .blue_small {
 height: 40px;
 width: 40px;
 margin-left:16px;
 margin-bottom:6px;
 background-color:#fff;
 background:url(../images/index_video_small2.svg) no-repeat 5px 7px;
 -moz-border-radius: 50%; 
 -webkit-border-radius: 50%; 
 border-radius: 50%;
 border: 3px solid #fff;
 -webkit-box-shadow: 0px 2px 6px rgba(64,80,85,0.8);  
 box-shadow: 0px 2px 6px rgba(64,80,85,0.8);} 
```

HTML5：

```
 <button class="blue_small" id="blue_small"></button> 
```

请问如何解决这个问题以使模拟器中的图标与**Firefox 浏览器**上的图标显示相同？

更新：

```
 <!DOCTYPE html>
  <html>
  <head>
  <title>APP</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <meta name="format-detection" content="telephone=no" />
  <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" /><!-- Cordova 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T13:20:20.923

删除`left`& `top`。像这样写：

```
background:url(../images/index_video_small2.svg) no-repeat 5px 7px; 
```

**而不是这个：**

```
background:url(../images/index_video_small2.svg) no-repeat left 5px top 7px; 
```

# java - 开发树形结构

> ID：13069290
> 
> 赞同：0
> 
> 时间：2012-10-25T13:06:40.037
> 
> 标签：java

请有人帮助！我是 Java 中的新手。我想从数组列表中创建一个树结构。我的输入是

```
1.1
1.2
1.3
1.3.1.1
1.3.1.2
1.4
1.4.1.1
1.4.2.1 
```

我的目标是得到一棵树

```
 1.1
               1.2
               1.3
       1.4           1.3.1.1
 1.4.1.1   1.5          1.3.1.2    
 1.4.1.2 
```

等等。

请在我的课程下面找到相同的内容。我在 test.tree.Node.addChild(Node.java:28) 得到一个 nullPoniter，我知道这是因为“孩子”为空，但我不知道如何第一次设置孩子。请帮忙... ：（

```
public class Tree {
private Node root;

public Tree(String rootData)
{
    root=new Node();
    root.data=rootData;
    root.children=new ArrayList<Node>();
}
public Tree() {
    super();
}
 public Node getRoot(){
    return this.root;
    }
 public void setRoot(Node rootElement) {
    this.root = rootElement;
}
} 
```

和节点类

```
class Node { 
String data;
Node parent;
List<Node> children;

public Node() {
    super();
}
public Node(String name)
{
    super();
    this.data=name;
}
public void addChild(String name) {
    this.addChild(new Node(name));
}
public void addChild(Node child) {
    this.children.add(child);
}
public void removeChild(Node child) {
    this.children.remove(child);
}
public void removeChild(String name) {
    this.removeChild(this.getChild(name));
}
public Node getChild(int childIndex) {
    return this.children.get(childIndex);
}
public Node getChild(String childName) {
    for (Node child : this.children) {
        if (child.data.equals(childName)) { return child; }
    }
    return null;
}
public List<Node> getChildren() {
    if (this.children == null) {
        return new ArrayList<Node>();
    }
    return this.children;
}
 public void setChildren(List<Node> children) {
    this.children = children;
}
public Node getParentNode() {
    return this.parent;
}
} 
```

测试类是

```
public class TreeTest {
public static void main(String[] args) {
    TreeTest tt = new TreeTest();
    ArrayList<String> newArr= new ArrayList<String>();
    newArr.add("1.1");
    newArr.add("1.2");
    newArr.add("1.3");
    newArr.add("1.3.1.1");
    newArr.add("1.3.1.2");
    newArr.add("1.4");
    newArr.add("1.4.1.1");
    newArr.add("1.4.2.1");
    int lCount=0;
    int maxCount= newArr.size();
    Tree tr= new Tree();
    Node rootNode = new Node();
    String parent_name=null;
    Node currentNode= new Node();
    for(String line: newArr){
        if(lCount==0){
        rootNode = tt.getTree(line);
        tr.setRoot(rootNode);
        currentNode= rootNode;
        }
        else{
            List<Integer> cur =  new ArrayList<Integer>();
            List<Integer> pre =  new ArrayList<Integer>();
            cur= tokenize(line);
            pre= tokenize(newArr.get(lCount-1));
            if(cur.size()==pre.size()){

                currentNode.addChild(tt.getTree(line));
                currentNode= tt.getTree(line);
                }
            else if (cur.size()>pre.size()){
                currentNode.addChild(tt.getTree(line));
                parent_name= newArr.get(lCount-1);
                currentNode= tt.getTree(line);
                }
            else if(cur.size()< pre.size()){
                currentNode= tt.getTree(parent_name);
                currentNode.addChild(tt.getTree(line));
                currentNode= tt.getTree(line);
            }
        }

        lCount++;
        }
        }
private Node getTree(String string) {
    // TODO Auto-generated method stub
        Node rootNode = new Node(string);
        return rootNode;
    }
private static List<Integer> tokenize(String line) {
    // TODO Auto-generated method stub
    List<Integer> line_Arr =  new ArrayList<Integer>();

    String[] tokens = line.split("\\.");
    int i=0;
    for(String atr: tokens)
        line_Arr.add(Integer.parseInt(atr));

    return line_Arr;
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T13:09:15.733

在`Node`类的两个构造函数中，在调用之后添加以下语句`super`：-

```
children = new ArrayList<Node>(); 
```

这将实例化您的`List children`.

```
public Node() {
    super();
    this.children = new ArrayList<Node>();
}

public Node(String name)
{
    super();
    this.children = new ArrayList<Node>();
    this.data=name;
} 
```

* * *

此外，您可以从以下位置更改您的`1-arg and 0-arg` `Tree`构造函数： -

```
public Tree(String rootData)
{
    root=new Node();
    root.data=rootData;
    root.children=new ArrayList<Node>();
}

public Tree() {
    super();
} 
```

到下面的一个，它将`Node`使用参数化构造函数实例化： -

```
public Tree(String rootData) {
    root=new Node(rootData);
}

public Tree() {
    root = new Node();
} 
```

**PS： -**

`super()`如果您只想调用超类`0-arg`构造函数，则不需要显式添加调用。编译器默认添加此调用。

# android - Listview 上的 ListSelector 不起作用

> ID：13069291
> 
> 赞同：3
> 
> 时间：2012-10-25T13:06:45.187
> 
> 标签：android, listview

我有这样的自定义列表选择器：

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android" >
    <item 
        android:state_pressed="true"
        android:drawable="@drawable/bg_list_hover"></item>
    <item 
        android:state_focused="true"
        android:drawable="@drawable/bg_list"></item>
</selector> 
```

和我的列表视图：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    android:background="@drawable/bg_dasar" >
    <TextView
                android:id="@+id/textView1"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="StoreCategory" 
                android:textSize="15sp"
                android:paddingLeft="10dip"
                android:paddingTop="10dip"
                android:paddingRight="10dip"
                android:textColor="@color/textcolor"/>

    <ListView
        android:id="@+id/listView1"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:padding="10dip"
        android:listSelector="@drawable/listselector">
    </ListView> 
```

我的问题是，当我不点击列表视图时，列表视图项目不使用焦点状态背景（`@drawable/bg_list`）...

任何人都可以帮助我吗？？？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-31T16:37:07.227

对于那些仍然需要它的人：关键是将 listSelector 设置为列表项的背景！

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="#819FF7"
    android:orientation="vertical" >

    <ListView
        android:id="@+id/mainList"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:cacheColorHint="#819FF7"
        />

 </LinearLayout> 
```

list_item.xml

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout 
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/lineItem"
    android:layout_width="wrap_content" 
    android:layout_height="wrap_content"
    android:background="@drawable/list_selector">

     <ImageView android:id="@+id/imageView"
        android:layout_width="96dp"
        android:layout_height="64dp"
        android:layout_centerVertical="true"
        android:layout_alignParentLeft="true"
        android:layout_marginLeft="10dp" 
        android:layout_marginTop="10dp" 
        android:layout_marginBottom="10dp" />

    <TextView
        android:id="@+id/textView"
        android:layout_toRightOf="@+id/imageView"
        android:layout_height="wrap_content"
        android:layout_marginLeft="10dip" 
        android:layout_centerVertical="true"
        android:textSize="18sp"
        android:textColor="#ff000000" 
        android:layout_width="wrap_content"
        />
    <Button 
        android:id="@+id/button" 
        android:gravity="center"
        android:layout_height="wrap_content" 
        android:layout_width="wrap_content"
        android:layout_centerVertical="true"
        android:layout_marginRight="10dp" 
        android:layout_alignParentRight="true"
        android:focusable="false" 
        android:text="Delete" />

</RelativeLayout> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-25T15:40:04.853

通过阅读一些参考资料，我已经解决了我的问题。我的列表选择器应该是这样的：

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android" >
    <item 
     android:state_pressed="true" 
     android:drawable="@drawable/bg_list_hover" />
 <item 
     android:drawable="@drawable/bg_list" />
</selector> 
```

我的列表视图布局：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    android:background="@drawable/bg_dasar" >
    <TextView
                android:id="@+id/textView1"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="StoreCategory" 
                android:textSize="15sp"
                android:paddingLeft="10dip"
                android:paddingTop="10dip"
                android:paddingRight="10dip"
                android:textColor="@color/textcolor"/>

    <ListView
        android:id="@+id/listView1"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:padding="10dip"
        **android:listSelector="@android:color/transparent"**>
    </ListView>

</LinearLayout> 
```

我还将我的列表选择器添加到我的列表项背景中：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="55dip"
    android:orientation="horizontal" 
    android:padding="15dip"
    android:gravity="center_vertical"
    **android:background="@drawable/listselector"**>

    <ImageView
        android:id="@+id/imageViewlogo"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginRight="10dip" />

    <TextView
        android:id="@+id/textViewcategory"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="TextView"
        android:textColor="@color/textcolor" 
        android:textSize="15sp"/>

</LinearLayout> 
```

感谢 Jay 和 danwilkie 回答我的问题.. :))

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T14:02:16.863

在 xml 中设置 android:focusable="true" 后，您是否尝试过在代码中的 listView 上调用“requestFocus()”？从查看文档：

“调用此方法以尝试将焦点赋予特定视图或其后代之一。如果视图不可聚焦（isFocusable() 返回 false），或者如果它可聚焦但无法聚焦，则视图实际上不会获得焦点设备处于触摸模式时的触摸模式 (isFocusableInTouchMode())。另请参见 focusSearch(int)，这就是您调用的方式，表示您有焦点，并且您希望您的父母寻找下一个。这相当于使用参数 FOCUS_DOWN 和 null 调用 requestFocus(int, Rect)。"

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T14:04:23.550

看起来您的选择器 xml 目前正在说当您单击一个项目时使用 bg_list_hover ，而当您专注于一个项目时使用 bg_list （例如，使用轨迹球）。

如果您想在项目既未单击也未聚焦时在默认情况下使用自定义可绘制对象，则需要为此添加一个条目：

我会使用这样的东西：

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android" >
    <item 
        android:state_pressed="true"
        android:drawable="@drawable/bg_list_pressed"></item>
    <item 
        android:state_focused="true"
        android:drawable="@drawable/bg_list_focused"></item>
    <item 
        android:drawable="@drawable/bg_list"></item>
</selector> 
```

# angularjs - AngularJS路线不起作用

> ID：13069295
> 
> 赞同：3
> 
> 时间：2012-10-25T13:07:18.830
> 
> 标签：angularjs

我尝试从 Angular JS 制作“入门”教程，但在设置链接的路由时遇到问题：当用户单击链接时，不会调用该路由的控制器。

这是我的代码：

```
angular.module('phonecat', []).
config(['$routeProvider',
    function ($routeProvider) {
        $routeProvider.
        when('/phones', {
            templateUrl: 'partials/phone-list.html',
            controller: PhoneListCtrl
        }).
        when('/phones/:phoneId', {
            templateUrl: 'partials/phone-detail.html',
            controller: PhoneDetailCtrl
        }).
        otherwise({
            redirectTo: '/phones'
        });
    }
]);

function PhoneDetailCtrl($scope, $routeParams, $http) {
    $scope.phoneId = $routeParams.phoneId;

    $scope.total = 4;
    $http.get('phones/' + $routeParams.phoneId + '.json').success(function (data) {
        $scope.phone = data;
    });
}

function PhoneListCtrl($scope, $http) {
    $http.get('phones/phones.json').success(function (data) {
        $scope.phones = data;
    });

    $scope.orderProp = 'age';
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T12:17:38.487

你用的是什么 angularjs 版本？我也遵循教程，它使用 angular-1.0.0rc7.js，如果我在 app.js 文件中查找，它使用`template`而不是`templateUrl`：

```
$routeProvider.when('/phones', {
    template: 'partials/phone-list.html',
    controller: PhoneListCtrl
}); 
```

因此，通过查看您的代码，您可能想要使用`angular-1.0.3.js`RC 或之前的版本

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-10T23:57:42.063

这应该可以，但是您需要确保链接位于作为应用程序根目录的 DOM 元素内；即`(ng-app='my-app')`。没有看到页面标记很难分辨。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-01T07:48:48.197

提问者解决了这个问题：

> 我解决了这个问题——实际上我有本教程下一步的 HTML，它弄乱了应用程序，主要是因为它与模型中尚不存在的属性绑定。

# php - 休息 API - JSON 对象

> ID：13069296
> 
> 赞同：-4
> 
> 时间：2012-10-25T13:07:20.217
> 
> 标签：php, json, api, rest

我的公司网站需要 php 调整。（我以前的程序员再也找不到了）

我对 js 知之甚少，所以我急需帮助。

**客户给我发了电子邮件：**

“基本上，我们需要您向我们提供一个 http rest API，我们将在其中提供跟踪代码，作为回报，您将向我们返回一个带有交付状态的 JSON 对象

**举个例子：**

```
TRACKING CODE: ABCDEFGHIJ 
URL: http://mydomain.com/...code=ABCDEFGHIJ 
METHOD: GET 
RESPONSE: {"status":2} 
```

其中 2 是状态货件​​的代码，定义为：

```
1 - GOOD 
2 - BETTER 
3 - BEST" 
```

我如何以及在哪里放置它？什么是“HTTP REST API”和“返回给我们一个 JSON 对象”

这对我来说都是胡言乱语！一些网络大师回答我好吗？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T13:14:33.913

我不会解释什么是 HTTP REST API，因为它是一个很大的话题，更好的 GOOGLE。但是检查这个 [http://en.wikipedia.org/wiki/Representational_state_transfer](http://en.wikipedia.org/wiki/Representational_state_transfer)

API 只不过是我们获得平台独立性的过程。

假设我的前端代码是用 JAVA 编写的，并且在美国。现在我的另一个拥有数据库访问和业务逻辑的团队坐在俄罗斯。我将如何让他们交流？答案是 API。

我们可以从 API 发送数据，基本上有两种类型，即 XML 和 Json。XML 是传统的 Json 是新的和轻量级的。

您的客户端一个 API，它将以 JSON 格式返回数据。他们会做的是 [http://apiWebAddress.com/1](http://apiWebAddress.com/1) 1 = 数据库中的 Id 列您的逻辑会捕捉到这一点，您将返回 {"status":2}

很简单，不是吗？:)

# sql - 在 SQL 查询中需要您的帮助

> ID：13069297
> 
> 赞同：0
> 
> 时间：2012-10-25T13:07:23.623
> 
> 标签：sql, database

有两个表：

*   **客户**( `id, name`)
*   **Order** ( `id, id_client, name`)，其中`id_client`- 外键。

编写一个查询，选择第一个表的标识符和名称以及第二个表中与之关联的记录数。结果应按姓氏降序排列。

我试过了

```
SELECT 
   Clients.id, Clients.name, count(id) 
FROM clients 
INNER JOIN Order ON Clients.id = Order.id_client 
GROUP BY 
   Clients.id, Clients.name 
ORDER BY 
   Clients.name DESC 
```

但它不起作用。怎么了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T13:09:07.273

```
SELECT
 c.ID,
 c.Name,
 COUNT(o.ID)
FROM
 Clients c
LEFT JOIN [Order] o
ON
 o.id_client = c.id
GROUP BY
 c.ID,
 c.Name
ORDER BY
 c.Name DESC 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T13:09:10.273

SELECT Clients.id, Clients.name, count(client.id) FROM clients INNER JOIN Order on Clients.id=Order.id_client GROUP BY Clients.id, Clients.name ORDER BY Clients.name DESC

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T13:09:39.233

更改`count(id)`为

`count(Clients.id)`或者`count(Order.id)`

我不知道你需要哪个表`count(id)`。我希望你明白问题出在哪里。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T13:12:45.033

```
SELECT
 c.ID,
 c.Name,
 COUNT(o.ID)
FROM
 Clients c,
 Order o
WHERE o.id_client = c.id
GROUP BY
 c.ID
 c.Name 
```

# c# - 处理由外部程序集引起的内存泄漏

> ID：13069302
> 
> 赞同：6
> 
> 时间：2012-10-25T13:07:45.707
> 
> 标签：c#, .net, memory-management, memory-leaks, dispose

我需要使用无法修改的外部程序集。假设我使用该程序集中的一个类，如下所示：

```
using (ExternalWidget widget = new ExternalWidget())
{
    widget.DoSomething();
} 
```

每次我调用此代码时，它都会泄漏非托管内存。`ExternalWidget`实现`IDisposable`，我已经将它包装在一个`using`语句中，但`ExternalWidget`没有清理它的非托管资源。

由于我无权访问`ExternalWidget`代码，因此我无法以正确的方式解决此问题。有没有其他方法可以释放所使用的内存资源`ExternalWidget`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T14:18:52.113

如果这是一个真正的*非托管*内存泄漏并且您无法更改代码，那么您几乎无能为力。框架无法接受这一点，也无法清理该代码。

在这种情况下，方法是隔离该组件。这意味着访问它会有很多开销，但您无能为力。

您不能在另一个应用程序域中运行代码，因为非托管代码没有应用程序域的概念。

这留下了过程级别。我建议在 WCF 中创建一个服务合同，模仿对方法的`ExternalWidget`调用`Shutdown`。

然后，您将创建一个 EXE，它将通过命名管道绑定公开此合同（使用会话，因此您可以保留`ExternalWidget`实例，除非每个调用都是无状态的）。

作为 EXE 的参数，它将采用唯一标识符（使用 a `Guid`）并将其用作为 WCF 服务设置端点的一部分。

然后，您将拨打电话，当您完成该实例时`ExternalWidget`，请拨打`Shutdown`; EXE 会知道停止等待，然后进程将退出，操作系统将回收内存。

当然，这里有*大量*的开销，所以如果你发现你正在进行很多调用并且不需要为每组调用创建一个新进程，你可以将这个想法扩展为一个计算调用的服务并然后在需要时回收该进程（服务仍然需要掏空，否则*将*耗尽资源）。

请注意，如果这是*托管*内存问题，那么您始终可以启动一个新的应用程序域，在那里运行您的代码（根据需要来回编组结果），然后释放应用程序域。

# java - 管理 Jackrabbit 组 ACL。访问被拒绝在具有组权限的节点上添加节点

> ID：13069303
> 
> 赞同：1
> 
> 时间：2012-10-25T13:07:46.737
> 
> 标签：java, jackrabbit, jcr

在 jackrabbit 存储库中，我正在尝试向 GROUP 添加权限。我想要什么“设计师”组可以写入 /templates 节点。

此节点 (/templates) 是类型为 nt:folder 的节点

首先，我创建了一个名为“设计师”的组

```
userManager = jkSession.getUserManager();

        Roles[] rolesTable = { Roles.EDITOR, Roles.DESIGNER,
                Roles.OPERATOR, Roles.ADMINISTRATOR };

        for (Roles role : rolesTable) {

                userManager.createGroup(role.toString());

            ... 
```

并为此组分配 /templates 节点的权限：

```
 p = principalManager.findPrincipals(
                                Roles.DESIGNER.toString(),
                                PrincipalManager.SEARCH_TYPE_GROUP)
                                .nextPrincipal();
    Node catalogNode = session.getRootNode().getNode("templates");

                AccessControlPolicyIterator accessControlPolicyIterator = accessControlManager
                        .getApplicablePolicies(catalogNode.getPath());

    AccessControlPolicy policy = accessControlPolicyIterator
                                .nextAccessControlPolicy();

                        if (polic

y instanceof AccessControlList) {

                        AccessControlList acl = (AccessControlList) policy;

                        JackrabbitAccessControlList jackAcl = (JackrabbitAccessControlList) acl;
                        jackAcl
                                .addEntry(
                                        p,
                                        new Privilege[] {
                                                accessControlManager
                                                        .privilegeFromName(Privilege.JCR_ADD_CHILD_NODES),
                                                accessControlManager
                                                        .privilegeFromName(Privilege.JCR_READ),
                                                accessControlManager
                                                        .privilegeFromName(Privilege.JCR_WRITE),
                                                accessControlManager
                                                        .privilegeFromName(Privilege.JCR_REMOVE_NODE) },
                                        true, null); 
```

现在，创建用户并使他成为设计师组的成员：

```
 Principal principal = principalManager.findPrincipals(DESIGNER.toString(),
            PrincipalManager.SEARCH_TYPE_GROUP).nextPrincipal();
Group roleToAssign = (Group) userManager.getAuthorizable(principal);

        user = userManager.createUser(login, password);

        roleToAssign.addMember(user); 
```

现在使用该用户登录并尝试将节点添加到 /templates

```
lCredentials = new SimpleCredentials(login, new String(pPassword)
                    .toCharArray());
        }

        Repository tmpRepository = null;

        try {
            tmpRepository = repositoryFactory.getRepository(repositoryParams);
            session = tmpRepository.login(lCredentials, pWorkspace); 
```

并将节点添加到 /templates：

session.getRootNode().getNode("templates").addNode("test","nt:unstructured");

但是抛出 accessDenied：

```
javax.jcr.AccessDeniedException: Access denied.
    at org.apache.jackrabbit.core.security.DefaultAccessManager.checkPermission(DefaultAccessManager.java:193)
    at org.apache.jackrabbit.core.NodeImpl.addNode(NodeImpl.java:1266)
    at org.apache.jackrabbit.core.session.AddNodeOperation.perform(AddNodeOperation.java:111)
    at org.apache.jackrabbit.core.session.AddNodeOperation.perform(AddNodeOperation.java:37)
    at org.apache.jackrabbit.core.session.SessionState.perform(SessionState.java:216)
    at org.apache.jackrabbit.core.ItemImpl.perform(ItemImpl.java:91)
    at org.apache.jackrabbit.core.NodeImpl.addNodeWithUuid(NodeImpl.java:1814)
    at org.apache.jackrabbit.core.NodeImpl.addNode(NodeImpl.java:1774)
    at org.apache.jackrabbit.commons.JcrUtils.getOrAddNode(JcrUtils.java:519) 
```

我没有在 jackrabbits 组上找到有关 ACL 的文档。请¿有人可以帮助我吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T13:26:18.107

固定的。

对于主体（组或用户）的权限，必须使用**基于主体的 ACL**，而不是像我在这篇文章中所做的那样使用资源 ACL。

Principal-Base ACL 描述如下：

[Jackrabbit ACL](http://wiki.apache.org/jackrabbit/AccessControl)（是的，这篇文章是 RTFM 案例）

但**另外**有必要在权限列表中添加权限**JCR_NODE_TYPE_MANAGEMENT**以添加特定类型的子节点。

```
 privileges = new Privilege[] {
                                    accessControlManager
                                            .privilegeFromName(Privilege.JCR_ADD_CHILD_NODES),
                                    accessControlManager
                                            .privilegeFromName(Privilege.JCR_READ),
                                    accessControlManager
                                            .privilegeFromName(Privilege.JCR_WRITE),
                                    accessControlManager
                                            .privilegeFromName(Privilege.JCR_NODE_TYPE_MANAGEMENT) }; 
```

谢谢。

# java - 在java中制作一个倒三角形

> ID：13069304
> 
> 赞同：0
> 
> 时间：2012-10-25T13:07:53.940
> 
> 标签：java, geometry

我正在尝试使我制作的三角形面朝下。尝试了很多次，但我不知道如何做到这一点。

我知道的代码是：

```
public static void drawPyramide(int lines, char symbol, boolean startDown) {
    //TRIANGLE

    if(startDown) {
                //The triangle up side down should be here. 
            }

    else {
        int c = 1;
        for (int i = 0; i < lines; i++) {
            for (int j = i; j < lines; j++) {
                System.out.print(" ");
            }
            for (int k = 1; k <= c; k++) {
                if (k%2==0) System.out.print(" ");

                else System.out.print(symbol);
            }

        System.out.print("\n");
        c += 2;
        }
    }

} 
```

有什么建议我可以“翻转”这个三角形吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T13:16:56.353

要翻转三角形，你真的只需要改变迭代的方向。而不是从`i = 0`到`i < lines`你需要从到下`i = lines-1`到`i >= 0`

您还需要将 更改`c`为要从多少个空格和符号开始。

可能看起来像这样：

```
int c = 2*lines;
for (int i = lines-1; i>=0; i--)
{
    for (int j = i; j < lines; j++)
    {
        System.out.print(" ");
    }
    for (int k = 1; k <= c; k++)
    {
        if (k % 2 == 0)
        {
            System.out.print(" ");
        }
        else
        {
            System.out.print(symbol);
        }
    }

    System.out.print("\n");
    c -= 2;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T13:18:55.290

反转第一个循环条件，即从行数开始并减少它。也相应地调整你`c`，让它从高到低，例如下面：

```
 int c = 2*lines-1;
    for (int i = lines; i > 0; i--) {
        for (int j = i; j < lines; j++) {
            System.out.print(" ");
        }
        for (int k = 1; k <= c; k++) {
            if (k%2==0) System.out.print(" ");

            else System.out.print(symbol);
        }

      System.out.print("\n");
      c -= 2;
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-03-13T05:41:53.983

```
import java.util.Scanner;

public class EquilateralTraingle {
    public static void main(String[] args) {
        Scanner sc = new Scanner(System.in);
        int side = sc.nextInt();
        constructEquTri(side);

    }

    private static void constructEquTri(int length) {
        // loop for each line
        for (int i = length; i > 0; i--) {
            // loop for initial spaces in each line
            for (int k = 0; k < length - i; k++) {
                System.out.print(" ");
            }
            // loop for printing * in each line
            for (int j = 0; j < i; j++) {

                System.out.print("*");
                System.out.print(" ");

            }
            System.out.println();
        }
    }

}
/*Output:
    10
    * * * * * * * * * * 
     * * * * * * * * * 
      * * * * * * * * 
       * * * * * * * 
        * * * * * * 
         * * * * * 
          * * * * 
           * * * 
            * * 
             * 
*/ 
```

# plugins - Munin：当插件文件名包含点时，使用 munin.conf 更改插件类别？

> ID：13069308
> 
> 赞同：3
> 
> 时间：2012-10-25T13:08:25.927
> 
> 标签：plugins, configuration, categories, munin

munin 中的每个插件都有一些配置设置，其中之一是它所属的类别（graph_category）。

我想将某些插件的类别更改为非默认类别。正如我在 munin.conf 手册页中看到的，我可以更改每个主机的插件的特定指令，如下所示：

```
[machine1.your.dom]
    address localhost
    load.graph_title Edited title of the load-graph 
```

现在我尝试使用 ping 插件和 graph_category 而不是 graph_title ，如本示例所示，但我无法让它工作。

我有一台机器 ping 不同含义的不同主机，所以我想将它们分组为不同的类别以便于访问。

例如：

```
ping_192.168.1.1    <- category: lan connectivity
ping_192.168.1.2    <- category: lan connectivity
ping_10.0.0.10      <- category: intranet connectivity
ping_10.0.0.20      <- category: intranet connectivity
ping_www.google.com <- category: internet connectivity 
```

更新：我对另一个插件进行了同样的尝试，它有效。我怀疑这与 ping 插件名称的域或 IP 地址中包含的句点有关。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T15:47:22.377

阅读以下票后，我刚刚找到了解决方案：

[http://munin-monitoring.org/ticket/526](http://munin-monitoring.org/ticket/526)

当插件名称包含点时，这些点必须替换为下划线。因此，我问题中示例的解决方案将如下所示：

```
[machine1.your.dom]
    address localhost
    ping_192_168_1_1.graph_category lan connectivity
    ping_192_168_1_2.graph_category lan connectivity
    ping_10_0_0_10.graph_category intranet connectivity
    ping_10_0_0_20.graph_category intranet connectivity
    ping_www_google_com.graph_category internet connectivity 
```

# c# - 如果可能，以它们之间有空格的格式获取 DateTime，而不是斜线

> ID：13069312
> 
> 赞同：0
> 
> 时间：2012-10-25T13:08:33.383
> 
> 标签：c#, sql, datetime

我正在尝试以这种格式获取日期

> “yyyy MM dd”

它们之间的空格不是斜线，但它不起作用

```
 using (SqlDataReader r = sqlComm.ExecuteReader())
    {
          if (r.Read())
          {
              DateTime Date 
= Convert.ToDateTime((r["Date"]).ToString("yyyy/MM/dd")); 
```

**我根本无法对 SQL 存储过程进行任何更改**

**编辑**

抱歉，它给了我这个**“25 10 2012 10:00:00:00 AM”**或其他东西，所以我不认为我做得对，我只想要这样的日期“yyyy MM dd”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T13:10:55.533

`\`变成太空怎么样？

```
.ToString("yyyy MM dd") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T13:10:48.767

从日期到字符串

```
var str= date.ToString("yyyy MM dd") 
```

和迄今为止的字符串

```
DateTime date = DateTime.ParseExact(string, "yyyy MM dd", CultureInfo.InvariantCulture); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-25T13:19:26.760

基于 Marc 的回答，您似乎对`DateTime`对象与`string`日期表示的实际工作方式有些混淆。这`DateTime`只是从起点的偏移量。

代码中的这一行首先从 SQL 阅读器中的 Date 列中获取值，然后将其转换为具有`"yyyy/MM/DD"`格式的字符串，最后将该字符串转换为`DateTime`对象。

`= Convert.ToDateTime((r["Date"]).ToString("yyyy/MM/dd"));`

如您所见，您最终得到的是一个`DateTime`对象，而不是`string`您想要的显示。如果您确实希望此代码仅返回 formatted `string`，那么您的最后一行应如下所示：

**编辑**

`= r.GetDateTime(r.GetOrdinal("Date")).ToString("yyyy MM dd");`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T13:10:58.100

所以你想要这种格式：“yyyy MM dd”，但你使用这个“yyyy/MM/dd”。

反而：

```
String dateString = r.GetDateTime(r.GetOrdinal("Date")).ToString("yyyy MM dd"); 
```

看：http: [//ideone.com/XecnUP](http://ideone.com/XecnUP)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-25T13:11:37.593

A`DateTime` *没有格式*。它只是“自 {epoch} 以来多久”，给予或接受一些偏移量/时区信息。如果源中的值*是*日期时间，那么您只需要：

```
DateTime date = (DateTime)r["Date"]; 
```

然后您可以稍后在 UI 中对其进行格式化。但要重复一遍： a`DateTime` *没有格式*。

# javascript - 在 JS 中第 n 次出现切片/拆分

> ID：13069313
> 
> 赞同：0
> 
> 时间：2012-10-25T13:08:41.733
> 
> 标签：javascript

我有一个由“|”分隔的字符串组成的数组：

```
LOG: 380|2|choice|Question_8_13240_1351170102936|||incorrect|2012-10-25T15:01:13|1|<ln>380|2|choice|Question_10_13280_1351170102995|||incorrect|2012-10-25T15:01:17|1| 
```

并且需要从每个字符串中获取 Question_8_13240_1351170102936 以便我可以查看是否有任何重复的问题，因此第三次出现“|”之后的字符串 4号之前

构建数组的代码：

```
 AssessmentManager.prototype.submit = function () {
  assessData = "";
  assessmentItemsLength = this.assessmentItems.length;
  for (i = 0; i < this.assessmentItems.length; i++) {
    if (!this.assessmentItems[i].getSubmitted()) {
      assessmentFlatDataItem = this.assessmentItems[i].getFlatData();
      if (assessmentFlatDataItem.length > 0) {
        if (assessData.length > 0)
          assessData += "<ln>";
          assessData += assessmentFlatDataItem;
        }
      }
    }
  } 
```

然后GetFlatdata：

```
 AssessmentItem.prototype.getFlatData = function () {
  result = _userScormModuleId + "|";

  if (this._interactionIdx)
    result += this._interactionIdx;
  result += "|";

  if (this._interactionType)
    result += this._interactionType
  result += "|";

  if (this._interactionId)
    result += this._interactionId
  result += "|";

  if (this._learnerResponse)
    result += this._learnerResponse
  result += "|";

  if (this._correctResponse)
    result += this._correctResponse
  result += "|";

  if (this._result)
    result += this._result
  result += "|";

  if (this._timeStamp)
   result += this._timeStamp
  result += "|";

 if (this._weighting)
   result += this._weighting
 result += "|";

 if (this._description)
  result += this._description

  return result;
} 
```

我将如何实现这一目标？谢谢

我现在有这个：

```
 learnerResponsesArray.push({ 
    key: j,
    value:  this.assessmentItems.split('<ln>')
  }); 
```

然后循环通过 learnerResponsesArray？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T13:12:37.403

```
var cells = mystring.split("|");
// nth item...
var myitem = cells[n]; 
```

但正如@mori57 所说，为什么要使用这种格式而不是 JSON？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T13:16:09.233

尝试这个

```
str = "LOG: 380|2|choice|Question_8_13240_1351170102936|||incorrect|2012-10-25T15:01:13|1|<ln>380|2|choice|Question_10_13280_1351170102995|||incorrect|2012-10-25T15:01:17|1| "
console.log(str.split(":")[1].split("|")[3]) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T14:05:54.157

如果您需要 3d 和 4th 之间的值`|`，可以使用：

```
var fourthelement = [yourstring].split(/\|/,4).pop(); 
```

# php - 如何使用 Doctrine 在死锁后重试事务？

> ID：13069315
> 
> 赞同：8
> 
> 时间：2012-10-25T13:08:42.883
> 
> 标签：php, mysql, database, doctrine-orm, deadlock

我正在编写一个 PHP 函数，它将大量数据存储/更新到一个表中，这可能会导致死锁。我尝试调查如何使用 Doctrine 重试失败的交易，但遗憾的是在网上找不到任何信息。我最终写了以下代码

```
 $retry = 0;
 $done = false;
 while (!$done and $retry < 3) {
     try {

         $this->entityManager->flush();
         $done = true;

     } catch (\Exception $e) {
         sleep(1);

         $retry++;
     }
 }

 if ($retry == 3) {
     throw new Exception(
         "[Exception: MySQL Deadlock] Too many people accessing the server at the same time. Try again in few minutes"
     );
 } 
```

**我的问题：**这种方法是否有可能在数据库中插入重复项？如果是这样，我怎样才能强制 Doctrine 回滚交易？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-10-31T03:03:15.470

死锁返回错误 1213，您应该在客户端处理该错误

请注意，死锁和锁等待是不同的东西。在僵局中，没有“失败”的交易：他们都是有罪的。不能保证哪一个会被回滚。

您必须使用`rollback`，您的样式代码将插入重复。例如你应该：

```
$retry = 0;

$done = false;

$this->entityManager->getConnection()->beginTransaction(); // suspend auto-commit

while (!$done and $retry < 3) {

    try {

        $this->entityManager->flush();

        $this->entityManager->getConnection()->commit(); // commit if succesfull

        $done = true;

    } catch (\Exception $e) {

        $this->entityManager->getConnection()->rollback(); // transaction marked for rollback only

        $retry++;

    }

} 
```

希望这有帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-09-02T23:46:28.987

这就是我使用 Sf2.7 和学说 2.4.7 重试失败事务的方式：

```
use Doctrine\Bundle\DoctrineBundle\Registry;
use Doctrine\ORM\EntityManager;

class Foo
{
    /**
     * @var Registry
     */
    protected $doctrine;

    public function __construct(Registry $registry)
    {
        $this->doctrine = $registry;
    }

    protected function doSomething($entity, $attempt)
    {
        $em = $this->getEntityManager();
        $conn = $em->getConnection();
        try{
            $conn->beginTransaction();
            $entity->setBar("baz");
            $em->flush();
            $conn->commit();
        } catch(\PDOException $e){
            $conn->rollBack();
            $attempt++;
            if($attempt <= 3){
                $this->doSomething($repayment, $attempt);
            }
        }
    }

    /**
     * @return EntityManager
     */
    protected function getEntityManager()
    {
        /** @var EntityManager $em */
        $em = $this->doctrine->getManager();
        if(!$em->isOpen()){
            $this->doctrine->resetManager();
            $em = $this->doctrine->getManager();
        }

        return $em;
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-04-23T14:30:13.277

# 重试事务片段

*   获得连接没有任何麻烦。
*   正确处理循环

## 代码

```
$connection = ...
$retry = 0;
$maxRetries = 3;

while ($retry < $maxRetries) {
    try {
        $connection->beginTransaction();

        // do stuff

        $connection->commit();

        break;
    } catch (Throwable $exception) {
        $connection->rollBack();

        $retry++;

        if ($retry === $maxRetries) {
            throw $exception;
        }
    }
} 
```

有关 Doctrine 交易的更多信息，请访问[https://www.doctrine-project.org/projects/doctrine-dbal/en/2.7/reference/transactions.html](https://www.doctrine-project.org/projects/doctrine-dbal/en/2.7/reference/transactions.html)

## 如何获得连接：

只需注入 Doctrine 的`EntityManager`( `Interface`) 或`Connection`例如。通过构造函数

**联系**

```
public function __construct(Connection $connection)
{
    $this->connection = $connection;
} 
```

**或实体管理器**

```
public function __construct(EntityManagerInterface $entityManager)
{
    $this->entityManager = $entityManager;
} 
```

并获得连接`$this->entityManager->getConnection()`

* * *

## 回答 #4

> 赞同：-5
> 
> 时间：2012-10-30T08:58:05.133

如果您没有使用 ORM，那么使用它会自动管理死锁情况。

# html - HTML 输入类型文件在 chrome 中不显示文件名

> ID：13069318
> 
> 赞同：4
> 
> 时间：2012-10-25T13:08:47.570
> 
> 标签：html, jquery-ui, google-chrome, jquery-ui-dialog, file-io

我正在使用 a`jqueryui dialog`来显示一个模式窗口，该窗口具有一个带有文件类型输入标签的表单。

在Chrome中，选择文件时，`file name is not displayed`。当我`hover`在浏览按钮上显示文件名时，除此之外什么也没有。它适用于Firefox。以下是问题的截图。

![铬错误](../Images/10cde3af927c344bade5abe72c597b17.png)

我想知道我应该怎么做才能在选择按钮旁边显示名称。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T13:16:06.277

我也有这个问题。为了处理它，我在浏览按钮旁边添加了一个字段，然后添加了这样的更改文本：

```
 $("#fileUpload").change(function (e) {
        var path = this.value;
        this.form.field.value = "..." + path.substring(11, path.length);
   }); 
```

添加了子字符串，因为它正在将 \fakepath\ 添加到路径名的开头。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T10:56:06.440

这很好用。

```
 <input type="file" class="button" id="fileupload" value="Upload file"  multiple onChange="handleFiles(this.files)"> 
```

# php - PHP stdClass 设置'id'属性奇怪的行为

> ID：13069319
> 
> 赞同：1
> 
> 时间：2012-10-25T13:08:47.887
> 
> 标签：php, stdclass

谁能解释这种行为？

```
 $object = new stdClass();

    //This works.
    $object->test = "Test";

    //This works.
    $arbitrary = "arbitrary";
    $object->$$arbitrary = "again, testing";

    //This works.
    $object->id = "2";

    //This fails
    $test = "id";
    $object->$$test  = "2";  // On this line. 
```

我正在尝试通过动态变量名称设置“id”属性。如果我明确说明，我可以很好地设置“id”属性。我可以动态设置其他变量名——即“任意”。有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T13:10:11.573

没有名为 的变量`$id`。

试试这个

```
$id = "2";

$test = "id";
$object->$$test  = "2";  // On this line. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T13:14:33.407

它是关于 php 如何评估的`$object->$$test`；

首先对 the`$$test`进行评估，这会导致一个 var`$id`并且给出一个`Notice: Undefined variable: id`

一个解决方案是定义一个变量`$id`，但更好的是使用 `$object->{$test}`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T13:11:54.140

存在语法错误。你想要这个我相信：

```
$object->{$test} 
```

代替

```
$object->$$test 
```

# sql - 在 azure sql 表中设置身份

> ID：13069323
> 
> 赞同：2
> 
> 时间：2012-10-25T13:08:54.430
> 
> 标签：sql, azure, azure-sql-database

我有一个包含标识列的表，但我无法删除标识属性。

有没有办法禁用它？或者一种在没有身份属性的情况下复制整个表的方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-25T13:29:27.523

请注意，如果列被聚集索引引用，您可能无法删除该列，并且您不能删除表的所有聚集索引，因为 SqlAzure 表必须始终具有聚集索引。

这意味着您可能必须跳过以下环节（至少对于您的最后一个聚集索引，这很可能是您的主键）：

*   重命名聚集索引
*   创建表的临时版本（使用新的聚集索引）
*   从当前表复制数据
*   删除当前表
*   将临时表重命名为当前名称

这大致看起来像这样：

```
-- Rename clustered index
EXECUTE sp_rename N'PK_My_Current_PK', N'PK_My_Current_PK_OLD',  'OBJECT'

-- If you have any FK constraints on the table, then drop them
ALTER TABLE dbo.MyTable DROP CONSTRAINT FK_My_Foreign_Key

-- Create the new version of your table - because this is SQLAzure it must have a clustered index
CREATE TABLE dbo.tmp_MyTable (
    MyID int NOT NULL,
    CONSTRAINT PK_My_Current_PK PRIMARY KEY CLUSTERED (MyID)
)

-- Copy the data into the temp table from the old table
INSERT INTO dbo.tmp_MyTable (MyID)
    SELECT MyID FROM dbo.MyTable 

-- Drop the old table 
DROP TABLE dbo.MyTable 

-- Rename the new table
EXECUTE sp_rename N'tmp_MyTable', N'MyTable', 'OBJECT' 

-- Recreate any foreign key constraints
ALTER TABLE dbo.MyTable WITH CHECK ADD FK_My_Foreign_Key FOREIGN KEY (MyID)
    REFERENCES dbo.MyForeignTable (MyID) 
```

希望有帮助

一种

**编辑：**正如@PhilBolduc 指出的那样，SqlAzure 表需要聚集索引，而不是主键。我已经相应地修改了上面的术语 - 答案的原则仍然存在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T13:18:25.977

不幸的是，您无法删除身份列而不删除它。或者添加一个具有临时名称的新列，更新新列值，然后删除前一列。

```
ALTER TABLE dbo.tablename ADD newcolumnname INT

UPDATE dbo.tablename SET newcolumnname = oldcolumnname FROM dbo.tablename

ALTER TABLE dbo.tablename DROP COLUMN oldcolumnname 
```

应该这样做。除非我误解了你的问题？

# google-api - 用于阿拉伯语的谷歌电子表格 API

> ID：13069325
> 
> 赞同：1
> 
> 时间：2012-10-25T13:09:02.243
> 
> 标签：google-api, google-sheets, google-api-java-client, google-spreadsheet-api, google-api-client

我正在尝试使用谷歌电子表格 api 阅读电子表格。一切都很顺利，但是当我将俄语或阿拉伯语文本放入电子表格时，我的程序会打印？？？？？？?? ？？？这些单元格值的值。下面是从我的谷歌帐户读取电子表格的代码。

```
 SpreadsheetService service = new SpreadsheetService("MyApp");
        service.setUserCredentials(USERNAME, PASSWORD);

URL feedUri = new URL("https://spreadsheets.google.com/feeds/spreadsheets/private/full?title-exact=true&title=internationalization_contents");

        // Make a request to the API and get all spreadsheets.
        SpreadsheetFeed feed = service.getFeed(feedUri, SpreadsheetFeed.class);
        List<SpreadsheetEntry> spreadsheets = feed.getEntries();

        SpreadsheetEntry spreadsheet = spreadsheets.get(0);

        // get the first work sheet
        WorksheetEntry workSheet = spreadsheet.getWorksheets().get(0);
        URL cellFeedUrl = workSheet.getCellFeedUrl();
        CellFeed cellFeed = service.getFeed(cellFeedUrl, CellFeed.class);

        List<CellEntry> entries = cellFeed.getEntries();
        for (int n = 0; n < entries.size(); n++) {
            Cell cell = entries.get(n).getCell();
            System.out.println(cell.getValue());
        } 
```

这打印出类似的东西

欢迎标题？？？?? ？？？

任何人都知道如何正确地将字符输入到我的 java 应用程序中。

# jquery - flash动画完成后加载body

> ID：13069328
> 
> 赞同：0
> 
> 时间：2012-10-25T13:09:08.723
> 
> 标签：jquery, flash

我有一个 Flash 介绍，我希望`<body>`在介绍完成后立即加载。我怎样才能做到这一点？

我不想在动画完成后重定向到新的 URL，我希望它在同一页面上。

我可以使用 jquery 代码捕获的 actionscript3 返回一个变量，还是 jQuery 本身可以检测动画何时完成？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T13:29:11.623

1) Flash intro: bad practice, especially as so many users are now surfing with devices that either don't come with Flash, or have disabled Flash entirely. Flash also completely destroys search engine results. #1 recommendation: learn how to do animation in HTML5/CSS3, if you absolutely must, but intro screens are incredibly harmful to usability in general. The only real excuse for using them is to provide some sort of feedback to users if you're trying to front-load assets (image sprites for a game, or data for a dashboard, for example).

2) You can't load Flash before the `<body>` of a page. It just doesn't work. However, given that, you could put together a structure like this:

```
<body>
    <div id="flashObj"><!-- object for Flash --></div>
    <div id="mainContent"><!-- rest of your page --></div>
</body> 
```

Then you could call a javascript function from the end of your Flash animation (see [http://www.kirupa.com/flash/calling_javascript_flash_using_as3.htm](http://www.kirupa.com/flash/calling_javascript_flash_using_as3.htm) for a tutorial) using the ExternalInterface object, but note that there are several browsers that still have issues with that object, so your cross-platform usability goes even further down.

Essentially, in your html, you would have:

```
<style>
    #mainContent { display:none; }
</style>

<script type="text/javascript">
    function startMainContent(){
        var flash = document.getElementById("flashObj");
        var main  = document.getElementById("mainContent");
        if(flash && main){
            flash.style.display == "none";
            main.style.display == "block";
        }
    }
</script> 
```

Then in your ActionScript, after your animation completes, you would add something like:

```
ExternalInterface.call("startMainContent()"); 
```

Assuming ExternalInterface is working correctly, and you've followed Adobe's documentation for setting the proper flags in your `<object />` tag to enable access to Javascript from your Flash object, that should do the trick.

See this for an official Adobe guide to ExternalInterface: [http://help.adobe.com/en_US/flex/using/WS2db454920e96a9e51e63e3d11c0bf626ae-7fe8.html#WS2db454920e96a9e51e63e3d11c0bf69084-7f31](http://help.adobe.com/en_US/flex/using/WS2db454920e96a9e51e63e3d11c0bf626ae-7fe8.html#WS2db454920e96a9e51e63e3d11c0bf69084-7f31)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-25T15:36:45.717

嘿，伙计，我在以愚蠢的方式回答这个问题时嘲笑我，但你可以这样做。你知道你的介绍播放了多少秒吗？如果是，请执行以下操作：假设您的介绍为 10 秒：

```
$(document).ready( function() {
$("INTRO_DIV").delay(10000).hide();
$("body").delay(10500).fadeIn();
}); 
```

我增加了 500 毫秒，以便您的介绍可以正确完成。

# c - C通过引用传递变量

> ID：13069337
> 
> 赞同：2
> 
> 时间：2012-10-25T13:09:23.997
> 
> 标签：c, pass-by-reference

我有以下代码：

```
main()
{
 uint8_t readCount;
 readCount=0;
 countinfunc(&readCount);
}

countinfunc(uint8_t *readCount)
{
 uint8_t i;
 i = readCount;
 ....
} 
```

问题是当它进入函数时，变量`i`的值与赋值后的 0 不同。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-25T13:11:25.530

这是因为在`countinfunc`变量中是一个*指针*。您必须使用指针取消引用运算符在函数中访问它：

```
i = *readCount; 
```

将变量作为对函数的引用传递的唯一原因是，如果它是一些复制成本可能很高的大数据，或者当您想在函数内部设置它的值时，它会在离开函数时保留该值。

如果要设置该值，请再次使用取消引用运算符：

```
*readCount = someValue; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-25T13:10:57.097

```
countinfunc(uint8_t *readCount)
{
 uint8_t i;
 i = *readCount;
 ....
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-25T13:10:58.603

代替

```
i = readCount; 
```

和

```
i = *readCount; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-25T13:11:39.490

您正在*设置*`i`为. 将分配更改为：*`readCount`*

 *```
i = *readCount; 
```

你会没事的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-25T13:16:59.560

只需更换

`i=readCount` 经过 `i=*readCount`

您不能分配`(uint8_t *)`给`uint8_t`

有关这方面的更多信息，请参阅下面的链接 [在 C 中通过引用传递](https://stackoverflow.com/questions/2229498/passing-by-reference-in-c)*

# c# - 将参数传递给 MS-Sql 存储过程时的 DateTimeFormat 问题

> ID：13069338
> 
> 赞同：2
> 
> 时间：2012-10-25T13:09:24.867
> 
> 标签：c#, sql-server-2008

我有一个存储过程，它有一个类似的参数`@CurrentDate datetime`，当我将值`DateTime.Now`从前端*（C#）*传递到这个存储过程时，它工作正常。

但是当我在我的系统/服务器中更改*日期格式*时，该时间将返回一个值，如. 我将此值传递给存储过程，我收到如下错误消息，`English(India)``DateTime.Now``25-10-2012 PM 05:23:27`

```
Msg 242, Level 16, State 3, Line 10
The conversion of a varchar data type to a datetime data type resulted in an out-of-range value. 
```

注意：我不想`GETDATE()`从 Sqlserver 使用，我想从 c# 传递参数。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-07-20T06:46:32.057

日期格式的问题是因为您将其转换为字符串，然后再转换回 DateTime 值。根据特定服务器上的文化设置，这可能有效，也可能无效。它也可能会误解数据，例如将日期从 2013-10-12 转换为 2013-12-10。

```
DateTime datet = new DateTime(year,month,day);
  startDateParam.Value = datet;
  endDateParam.Value = datet; 
```

“请注意，服务器存储的日期时间格式为 '1900-01-01 00:00:00.000'”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T13:13:36.730

您需要使用`Convert`函数将该值转换为有效的 DateTime。

更多信息：[http ://www.sql-server-helper.com/tips/date-formats.aspx](http://www.sql-server-helper.com/tips/date-formats.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T13:23:34.663

当您在国际上发布时，将日期存储在当地时区可能会让人头疼。如果您`GETUTCDATE()`在 SQL Server 端使用保存当前日期，您可以获得用户特定时区的时间，如下所示：

```
public DateTime GetDateByTimeZoneId(DateTime dateTime, string timeZone)
{
   if (dateTime == null)
   {
        return null;
   }

   dateTime = DateTime.SpecifyKind(dateTime, DateTimeKind.Utc);
   return TimeZoneInfo.ConvertTimeFromUtc(dateTime, TimeZoneInfo.FindSystemTimeZoneById(timeZone));
} 
```

然后，您可以传递用户相关的时区，例如`"GMT Standard Time"`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T13:29:16.457

您可以从 C# 使用此转换。希望这可以帮助

```
DateTime.Now.ToString(DateTimeFormatInfo.InvariantInfo) 
```

# php - 如何在 PHP 中产生 500 内部服务器错误？

> ID：13069344
> 
> 赞同：0
> 
> 时间：2012-10-25T13:09:54.553
> 
> 标签：php, apache

我想用 PHP 生成一个 500 内部服务器错误页面，我该怎么做？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-10-25T13:10:51.667

`header("HTTP/1.1 500 Internal Server Error");`在任何输出之前...输出。
使用此函数之后发送的输出，您可以显示一个自定义页面来解释错误。

```
<?php
    header('HTTP/1.1 500 Internal Server Error');
    exit("I error because foo");
?> 
```

您可以阅读[功能](http://php.net/header)[手册页以`header()`](http://php.net/header)获取更多信息。

如果你想让默认的 Apache 页面显示，没有直接从 PHP 加载它的方法，但你可以做一个这样的 hack：

```
<?php
    if ($error)
        require("badfile.php");
?> 
```

在 badfile.php 中：

```
<?php strpos) ?> 
```

例如。

另一种尝试的解决方案是，您可以抛出一个没人会捕捉到的异常。

```
<?php
    if ($error)
        throw new \Exception("Error because foo");
?> 
```

或者复制粘贴Apache使用的原始文件，出错后打印出来：

```
<?php
    header('HTTP/1.1 500 Internal Server Error');
    header('Content-Type: text/html');
    readfile('path/to/html/file.html');
    exit(1);
?> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-25T13:11:44.573

制作一个糟糕的 .htaccess 文件（在其中放入一些垃圾）。

# android - Android：以编程方式播放相机快门声音

> ID：13069345
> 
> 赞同：13
> 
> 时间：2012-10-25T13:09:58.443
> 
> 标签：android, audio, camera

我想以编程方式播放相机快门声音。我没有使用自动播放该声音的 ShutterCallback，因此我需要以其他方式进行操作。有人知道解决方案吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2016-08-19T10:59:08.403

来自 API 16 的 [MediaActionSound 。](https://developer.android.com/reference/android/media/MediaActionSound.html)

```
AudioManager audio = (AudioManager) getSystemService(Context.AUDIO_SERVICE);
    switch( audio.getRingerMode() ){
        case AudioManager.RINGER_MODE_NORMAL:
            MediaActionSound sound = new MediaActionSound();
            sound.play(MediaActionSound.SHUTTER_CLICK);
        break;
        case AudioManager.RINGER_MODE_SILENT:
        break;
        case AudioManager.RINGER_MODE_VIBRATE:
        break;
    } 
```

尊重 Android 中的振动/静音模式。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-10-25T13:58:54.837

他的资源解释了如何播放音频文件

[http://www.vogella.com/articles/AndroidMedia/article.html](http://www.vogella.com/articles/AndroidMedia/article.html)

您可能必须提供自己的快门音效。

如果系统文件在那里，您可以像这样使用它：

```
public void shootSound()
{
    AudioManager meng = (AudioManager) getContext().getSystemService(Context.AUDIO_SERVICE);
    int volume = meng.getStreamVolume( AudioManager.STREAM_NOTIFICATION);

    if (volume != 0)
    {
        if (_shootMP == null)
            _shootMP = MediaPlayer.create(getContext(), Uri.parse("file:///system/media/audio/ui/camera_click.ogg"));
        if (_shootMP != null)
            _shootMP.start();
    }
} 
```

# solr - SOLR 为空查询返回文档，但不为真实查询返回文档

> ID：13069349
> 
> 赞同：0
> 
> 时间：2012-10-25T13:10:13.717
> 
> 标签：solr

我有一个基本的 SOLR 实例

```
<?xml version="1.0" encoding="UTF-8" ?>
<schema name="my-solr" version="1.5">
  <types>
    <fieldType name="string" class="solr.StrField" sortMissingLast="true" indexed="true" />
    <fieldType name="text_general" class="solr.TextField" positionIncrementGap="100" indexed="true"/>
  </types>

  <fields>
    <field name="id" type="string" indexed="true" stored="true" required="true" />
    <field name="title" type="text_general" indexed="true" stored="true" multiValued="true"/>
  </fields>

  <uniqueKey>id</uniqueKey>
</schema> 
```

如果我从 SOLR 管理页面发出一个空查询，我会得到一些结果：

```
<response>
    <lst name="responseHeader">
    <int name="status">0</int>
    <int name="QTime">1</int>
    <lst name="params">
    <str name="indent">on</str>
    <str name="start">0</str>
    <str name="q">*:*</str>
    <str name="version">2.2</str>
    <str name="rows">10</str>
    </lst>
    </lst>
    <result name="response" numFound="5" start="0">
        <doc><str name="id">1</str><arr name="title"><str>Test</str></arr></doc>
        <doc><str name="id">2</str><arr name="title"><str>Other Test</str></arr></doc>
    </result>
</response> 
```

但是，如果我发出查询`title:"test"`（如果我的语法错误，请纠正我），我什么也得不到。

```
<response>
    <lst name="responseHeader">
    <int name="status">0</int>
    <int name="QTime">0</int>
    <lst name="params">
    <str name="indent">on</str>
    <str name="start">0</str>
    <str name="q">title:"test"</str>
    <str name="version">2.2</str>
    <str name="rows">10</str>
    </lst>
    </lst>
    <result name="response" numFound="0" start="0"/>
</response> 
```

帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T13:17:52.367

确保在您的架构中，标题字段设置为 indexed="true"。查询中只能指定索引字段（并且只能请求返回已存储=“true”的字段）。

如果您更改架构，我建议重新启动 solr 并重新索引所有内容。

从我在您的输出中看到的空查询来看，您似乎也将标题定义为多值/数组。在大多数情况下，这没有意义。标题字段示例：

`<field name="title" type="string" indexed="true" stored="true" required="true" multiValued="false"/>`

请注意，您应该只“存储”稍后需要返回的字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T13:43:38.253

事实证明它没有以我预期的方式建立索引，因为我没有使用合适的分析器。我采用了示例中提供的示例`text_general`类型`schema.xml`，并且非常有效。这足以开始了。转载于此。

```
<fieldType name="text_general" class="solr.TextField" positionIncrementGap="100">
  <analyzer type="index">
    <tokenizer class="solr.StandardTokenizerFactory"/>
    <filter class="solr.StopFilterFactory" ignoreCase="true" words="stopwords.txt" enablePositionIncrements="true" />
    <!-- in this example, we will only use synonyms at query time
    <filter class="solr.SynonymFilterFactory" synonyms="index_synonyms.txt" ignoreCase="true" expand="false"/>
    -->
    <filter class="solr.LowerCaseFilterFactory"/>
  </analyzer>
  <analyzer type="query">
    <tokenizer class="solr.StandardTokenizerFactory"/>
    <filter class="solr.StopFilterFactory" ignoreCase="true" words="stopwords.txt" enablePositionIncrements="true" />
    <filter class="solr.SynonymFilterFactory" synonyms="synonyms.txt" ignoreCase="true" expand="true"/>
    <filter class="solr.LowerCaseFilterFactory"/>
  </analyzer>
</fieldType> 
```

# cakephp - CakePHP 2.1 Avg 查询函数

> ID：13069353
> 
> 赞同：2
> 
> 时间：2012-10-25T13:10:41.043
> 
> 标签：cakephp, cakephp-2.1, average

我正在使用 cakephp 2.1，我想获得特定电影的平均电影收视率。其中“Movie”是一个模型，它包含“Language”和“CriticReview”作为模型。数组结构如下。

```
 array(
(int) 0 => array(
    'Movie' => array(
        'id' => '4',
        'name' => 'Maattrraan',
        'cover_image' => '/movies/4d0d1c41d956a2cb2ab93603d1fdf70c.jpg',
        'release' => '2012-10-12',
        'runtime' => '',
        'budget' => '65 crore',
        'box_office' => '',
        'language_id' => '2',
        'industry_id' => '3'
    ),
    'Language' => array(
        'id' => '2',
        'name' => 'tamil'
    ),
    'CriticReview' => array(
        (int) 0 => array(
            'rating' => '4',
            'movie_id' => '4'
        ),
                    (int) 1 => array(
                            'rating' => '3',
                            'movie_id' => '4'
                    )
    )
),
(int) 1 => array(
    'Movie' => array(
        'id' => '1',
        'name' => 'Romeo',
        'cover_image' => '/movies/32aa2788fa5e1584d4c627c56214574e.jpg',
        'release' => '2012-07-06',
        'runtime' => '',
        'budget' => '',
        'box_office' => '',
        'language_id' => '1',
        'industry_id' => '1'
    ),
    'Language' => array(
        'id' => '1',
        'name' => 'kannada'
    ),
    'CriticReview' => array(
        (int) 0 => array(
            'rating' => '6',
            'movie_id' => '1'
        ),
                    (int) 1 => array(
                            'rating' => '3',
                            'movie_id' => '1'
                    )
    )
)); 
```

所以我必须平均评论评论。请帮我找出解决方案。这项工作将是可观的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T21:00:00.037

我不知道您的查询现在如何，但您可以尝试添加此字段：

```
$this->Movie->find("all", array(
    "fields"     => array("AVG(CriticReview.rating) AS AverageRating"),
    "conditions" => ...
)); 
```

返回的数组现在将在每部电影中包含一个子数组，其键`0`如下

```
[0] => Array
    (
        [AverageRating] => AVG_CALCULATED_BY_MYSQL
    ) 
```

我个人更喜欢保存计算数据而不是即时计算。也许您想阅读这个问题：[MySQL - 即时计算字段与存储计算数据](https://stackoverflow.com/questions/4508705/mysql-calculating-fields-on-the-fly-vs-storing-calculated-data)

# node.js - 使用 mocha 的回调传递回的测试错误，应该

> ID：13069366
> 
> 赞同：4
> 
> 时间：2012-10-25T13:11:02.070
> 
> 标签：node.js, mocha.js, should.js

**2013 年 7 月 2 日更新**

使用包装匿名函数的最后一种方法可能会引入一些奇怪的测试行为。如果您预计会抛出错误，但实际执行中有错误，则测试将通过，但会传递任何错误，并且可能不是您期望的错误。我做了两件事，如果我指定它是一个错误，我确保从存根返回的错误文本和抛出的错误是相同的。如果它来自我不一定知道错误的第三方库，我会输入一些任意值，以便我知道通过特定于我正在测试的单元。使用 sinon.js 存根的示例。

```
 it('should return an error if the save fails', function(){
        stubCall.restore();
        stubCall = sinon.stub(Provider, 'save').callsArgWith(1, new Error('Save Error'));

        (function(){
            User.create(fakeUser, function(err, user){
               if(err)
                throw err;
            });
        }).should.throw("Save Error");
    }); 
```

* * *

我正在进入 Node.js 并尝试使用 Mocha 和 should.js（以及在某些时候的 sinon）做一些行为驱动开发（BDD）。

我遇到的一件事是测试回调返回的错误，例如这个简单的测试：

```
it('should return an error if you try and execute an invalid Query object', function () {
        var stubQuery = {}; 

        Provider.execute(stubQuery, function (err) {
            //should.not.exist(err);
            should.have.property('message', 'Invalid Query Object');
        });
    }); 
```

具有以下功能：

```
PostgresqlProvider.prototype.execute = function (query, cb) { 
```

};

我尝试和测试什么都没关系，测试总是通过（should.exist 等），我可以让它首先失败的唯一方法是添加 cb(null); 进入执行功能，这有点违背我正在做的事情，因为我试图在添加行为之前进行测试，而不是添加行为以使测试失败。

我知道我在这里犯了一些真正的新手错误，可能在几个级别上，但我没有掌握对作为回调传递的错误的测试没有抛出（我相信我可以更轻松地测试）！

**更新**

Using the code from Herman, i adjusted and that indeed words (the test is failing with no behavior defined)

```
 it('should return an error if you try and execute an invalid Query object', function () {
        var stubQuery = {};
        Provider.execute(stubQuery, function (err) {
            if (err) throw new Error(err);
        }).should.throw();
    }); 
```

issue now is i can't "catch" the error if sent in the callback to pass the test, the **should.throw** method doesn't get called, it just states that expected a throw to happen but didnt even though i am returning an error to the callback from my method. This could be down to scope but i am unsure if i should add some form of closure, and at what level.

**UPDATE 2**

Figured it out, i needed to wrap the call to the function inside a closure, not the callback (Doh!) and then place the assert (should.throw) at the end of the closure;

```
 it('should return an error if you try and execute an invalid Query object', function () {
        var stubQuery = {};
        (function(){
            Provider.execute(stubQuery, function (err) {     
                if (err) 
                    throw err;
            });
         }).should.throw();
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T13:58:59.570

You need to generate an exception inside your test function for the test to fail.

I'd add `if (err) throw "Invalid query error " + err` this way:

```
it('should return an error if you try and execute an invalid Query object', function () {
    var stubQuery = {}; 

    Provider.execute(stubQuery, function (err) {
        if (err) throw "Invalid query error " + err
    });
}); 
```

That should do.

**(ON UPDATE)**

`should.throw()`对我也不起作用......我做了这个肮脏的黑客来处理流程：

```
it('should return an error if you try and execute an invalid Query object', function () {
  var stubQuery = {}; 

  try {
    Provider.execute(stubQuery, function (err) {
      if (err) throw "Invalid query error " + err
    });
    // No error, keep on the flow
    noError ();
  } catch (e) {
    // Error, let's continue the flow there
    error (e)
  }

  function noError () {
    // The flow in the event we have no error
    // ... //
  }

  function error (errorObj) {
    // The flow, in the event we have error
    // ... //
  }

}); 
```

希望这可以帮助！

# javascript - 在实时站点上使用 Wymeditor 是否安全？自动化脚本可以禁用 javascript 吗？

> ID：13069368
> 
> 赞同：1
> 
> 时间：2012-10-25T13:11:03.760
> 
> 标签：javascript, security, xss, wymeditor

我很好奇，有问题的页面受密码保护，但它让我思考。我正在使用 Wymeditor J-Query 插件进行实验，它运行良好，并通过自动将尖括号转换为 html 字符等来处理 XSS 脚本尝试。

显然，通过直接访问，用户可以禁用 javascript，然后将任何形式的恶意标签插入数据库。但是我想知道如果自动脚本设法获得密码保护，是否有可能禁用javascript，从而将恶意脚本插入数据库，然后当数据库信息显示在另一个页面上时运行这些脚本？

*** 更新 ***

我可能应该扩大一点。我通常会使用 strip_tags() 并使用准备好的语句，但是如果 Wymeditor 对客户端有任何用处，那么我就不能使用 strip_tags()。我知道我可以编写一些代码来删除任何看起来有恶意的内容，但我不确定我会寻找多少恶意内容，我假设 XSS 攻击比<脚本>做坏事<脚本>类型的东西要多样化得多.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-25T13:17:13.653

规则 #1：**永远不要相信用户数据**。

推论：来自客户端的任何东西*都是*用户数据，无论您的页面采取什么浏览器内措施（自动化脚本可能根本没有运行 JS，或者可能注入页面上不存在的表单字段）。

因此，虽然 JS 编辑器不会降低网站*的*安全性，但它也不会提供任何*额外*的安全性：客户端措施（例如 JS 输入过滤）只是为了方便用户*，*并提供完全零保护；**无论客户端如何，您都*需要*在服务器端清理用户输入**。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T13:18:06.847

你应该`check your data upon insert`进入数据库......没有客户端脚本可以保护你。Wymeditor 可以使输入更容易并且可以提供很多帮助，但它不会保护您免受某些黑客试图插入的恶意代码的侵害。所以你必须做一个强大的服务器端检查。

# vaadin - Vaadin @PropertyId 如何访问内部 bean

> ID：13069369
> 
> 赞同：1
> 
> 时间：2012-10-25T13:11:20.463
> 
> 标签：vaadin

在 Vaadin 7 中，我正在创建一个简单的表单来按照此示例编辑 JavaBean [https://vaadin.com/wiki/-/wiki/Main/Creating%20a%20form%20using%20an%20existing%20layout](https://vaadin.com/wiki/-/wiki/Main/Creating%20a%20form%20using%20an%20existing%20layout)

但是，使用“@PropertyId”注释，我如何访问我的 bean 的非原始属性？就像是

```
public class MyBean {
  private MyStatus status;

  //getters/setters
}

public class MyStatus{
    private String statusName;

    //getters/setters
} 
```

我希望能够使用 @PropertyId("status.statusName") 之类的东西访问该属性，但这不起作用...

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T11:46:51.900

可能有点晚了，但是，您最好使用[`BeanFieldGroup`](https://vaadin.com/api/com/vaadin/data/fieldgroup/BeanFieldGroup.html)而不是仅仅使用[`FieldGroup`](https://vaadin.com/api/com/vaadin/data/fieldgroup/FieldGroup.html)：

```
public MyForm() {
   FormLayout layout = new FormLayout();
   binder = new BeanFieldGroup(MyBean.class);
   layout.addComponent(binder.buildAndBind("Status Name", "status.statusName"));
   setCompositionRoot(layout);
} 
```

# ruby-on-rails - 无法将 gem factory_girl_rails 捆绑到 rails 2.3.14

> ID：13069378
> 
> 赞同：1
> 
> 时间：2012-10-25T13:11:42.633
> 
> 标签：ruby-on-rails, factory-bot

在这篇文章之后[工厂女孩](http://robots.thoughtbot.com/post/19412394597/factory-girl-hits-3-0)

> 如果无法升级到 Ruby 1.9 和 Rails 3，可以继续使用 factory_girl_rails 版本 1.x 和 FactoryGirl 2.x；这些将继续支持 Ruby 1.8.7+ 和 Rails 2.3.9+。

我正在尝试使用 Ruby 1.8.7 将工厂女孩设置为 Rails 2.3.14，但仍然无法捆绑：

```
Bundler could not find compatible versions for gem "rails":
  In Gemfile:
    factory_girl_rails (= 1.0.0) ruby depends on
      rails (>= 3.0.0.beta4) ruby

    rails (2.3.14) 
```

宝石文件

```
source :rubygems
source "http://gems.github.com"
gem "rails", "2.3.14"
gem "rspec", "1.2.6"
gem "rspec-rails", "1.2.6"
gem "factory_girl_rails", "1.0.0" 
```

欢迎任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-22T20:42:30.743

我试图进行与您相同的设置，但根据[https://rubygems.org/gems/factory_girl_rails/versions/1.0](https://rubygems.org/gems/factory_girl_rails/versions/1.0)`factory_girl_rails`中的依赖项部分，自 1.0 版以来依赖于 Rails 3

你`Gemfile`应该是这样的：

```
source :rubygems
group :development, :test do
  gem "factory_girl", "2.6.4"
  gem "rspec", "1.3.2", :require => false
  gem "rspec-rails", "1.3.4", :require => false
end

group :test do
  gem "capybara", "1.1.1"
  gem "cucumber-rails", "0.3.2"
  gem "database_cleaner"
  gem 'email_spec'
end 
```

factory_girl_rails 所做的基本上是设置fixture_replacement 选项（我认为Rails 2.3 中不存在）、工厂路径和设置生成器。

我想我们必须调整这里的代码[https://github.com/thoughtbot/factory_girl_rails/blob/master/lib/factory_girl_rails/railtie.rb](https://github.com/thoughtbot/factory_girl_rails/blob/master/lib/factory_girl_rails/railtie.rb)通过调整 Rspec 和 Cucumber 配置文件使其适用于 Rails 2.3。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-10T13:17:44.593

你可以尝试改变你的 Gemfile 这个：
`source :rubygems`
`source "http://gems.github.com"`

为了这
`source 'http://rubygems.org'`

# maven - buildr 上传不会创建 maven-metadata.xml

> ID：13069382
> 
> 赞同：1
> 
> 时间：2012-10-25T13:11:48.610
> 
> 标签：maven, maven-2, buildr, maven-metadata

我正在两个项目上尝试构建器 - 一个依赖于另一个。

`buildr upload`似乎在 project1 上工作正常，但是当 project2 尝试构建它时`project1/0.0.1-SNAPSHOT/maven-metadata.xml`，它会在我的 repo 中查找，但它不存在。

我应该手动创建 maven-metadata.xml 文件吗？构建器文档中没有提到它。

这是 project2 上 builder 的输出：

```
...
Requesting http://repo1.maven.org/maven2/com/mydomain/project1/0.0.1-SNAPSHOT/maven-metadata.xml
Connecting to my-repo-server
connected
Downloading from /usr/share/repo/com/mydomain/project1/0.0.1-SNAPSHOT/maven-metadata.xml
Exception while invoking prerequisites of task <Buildr::CompileTask project2:compile => [(classpath deleted)]>
Exception while invoking prerequisites of task <Rake::FileTask ~/Documents/workspace/project2/bin => [project2:compile]>
Exception while invoking prerequisites of task <Rake::Task project2:build => [~/Documents/workspace/project2/bin, project2:test]>
Exception while invoking prerequisites of task <Rake::Task default => [build]>
Buildr aborted!
Net::SFTP::StatusException : Net::SFTP::StatusException (2, "no such file")
[Stacktrace deleted] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-27T03:02:52.260

是的，buildr 不会创建这种类型的 Maven 工件。

# c# - 如何表达一个参数需要在 C# 中实现多个接口

> ID：13069385
> 
> 赞同：2
> 
> 时间：2012-10-25T13:11:53.913
> 
> 标签：c#, interface, interface-design

类似于这个问题：[我如何需要一个方法参数来实现多个接口？](https://stackoverflow.com/questions/1500827/java-how-can-i-require-a-method-argument-to-implement-multiple-interfaces) 我想要一个方法参数来实现几个接口。

接口应该可以以任意方式组合，我不想为每个有效组合创建一个接口。

想一个文件。有可能：

1.  可读 =>`IReadable`
2.  可写 =>`IWriteable`
3.  档案=>`IArchive`
4.  自动生成 =>`IGenerated`

...

如果我想表达一个参数需要是一个可写的、生成的存档，我不想生成`IWritableGeneratedArchive`，因为组合太多，我想将它与一些我无法修改的现有类一起使用。

伪代码：

```
void WriteTo( IWritable + IGenerated + IArchive file)
{
   //...
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-25T13:11:53.913

我在这里找到的解决方案：[如何需要方法参数来实现多个接口？](https://stackoverflow.com/questions/1500827/java-how-can-i-require-a-method-argument-to-implement-multiple-interfaces)针对 C# 进行了调整。

学分去[迈克尔迈尔斯](https://stackoverflow.com/users/13531/michael-myers)

```
internal interface IF1
{
    void M1();
}

internal interface IF2
{
    void M2();
}

internal class ClassImplementingIF1IF2 : IF1, IF2
{

    public void M1()
    {
        throw new NotImplementedException();
    }

    public void M2()
    {
        throw new NotImplementedException();
    }

}

internal static class Test
{

    public static void doIT<T>(T t) where T:IF1,IF2
    {
        t.M1();
        t.M2();
    }

    public static void test()
    {
        var c = new ClassImplementingIF1IF2();
        doIT(c);
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-25T13:19:40.657

一个通用的 + 约束可能吗？

```
void WriteTo<T>( T file) where T : IWritable,IGenerated,IArchive
{
   //...
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-25T13:20:03.327

使用通用约束：

```
void WriteTo<T>(T file) where T: IWritable, IGenerated, IArchive
{
   //...
} 
```

请参阅[类型参数的约束（C# 编程指南）](http://msdn.microsoft.com/en-us/library/d5x73970%28v=vs.110%29.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T13:19:22.633

> 我不想生成 IWritableGeneratedArchive 因为组合太多

怎么组合太多了？无论有多少*潜在*的组合，您只需要为实际用作方法参数的组合创建一个组合接口，然后无论如何都要写出来。换句话说，实际上并没有那么多工作。

> 我想将它与一些我无法修改的现有类一起使用。

可以将 IWritableGeneratedArchive 类型传递给只需要 IArchive 或 IWritable 的东西。这仍然适用于您已经拥有的任何其他东西。

* * *

但是既然你已经决定反对这个，而且看起来你已经在这个架构上投入了很多，我想知道你是否看过**[Code Contracts](http://msdn.microsoft.com/en-us/library/dd264808.aspx)**。他们看起来可能会做你需要的事情。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-26T10:40:18.840

这个解决方案试图将 supercat 的想法与存储这样的“多接口”对象结合起来。

我通过将它们存储在一个`Holder`公开对象的指定接口的类中来做到这一点。

`Holder`对象可以被存储并且是预期的参数。缺点是您必须创建第一个，并且类型参数`Holder`的顺序很重要。`Holder`

从好的方面来说，您还可以动态创建`Holder`s，当然还可以存储“多接口”对象。

启用这些`holder.Get<T>()`方法（比 holder.t1 更好）会很好，但它不会编译。 **也许有人知道如何解决它？**我认为它需要添加约束`T1`不是`T2`，反之亦然。这个与 C# 泛型相关的接缝[*没有*实现某些东西](https://stackoverflow.com/questions/3842556/c-sharp-generic-does-not-implement-something)，他们没有找到解决方案。

```
internal interface IF1
{
    void M1();
}

internal interface IF1_extension : IF1
{
}

internal interface IF2
{
    void M2();
}

internal class ClassImplementingIF1IF2 : IF1_extension, IF2
{

    public void M1()
    {
        throw new NotImplementedException();
    }

    public void M2()
    {
        throw new NotImplementedException();
    }

}

internal interface Getter<T> where T : class
{
    T Get();
}

internal class Holder<T1, T2> //: Getter<T1>, Getter<T2> // not possible since T1 and T2 may be the same => won't compile!
    where T1 : class
    where T2 : class
{
    private Holder(T1 t1, T2 t2)
    {
        Debug.Assert(t1 != null, "Argument is no " + typeof(T1).Name);
        Debug.Assert(t2 != null, "Argument is no " + typeof(T2).Name);
        this.t1 = t1;
        this.t2 = t2;
    }

    public static Holder<T1, T2> CreateFrom<T>(T t) where T : T1, T2
    {
        return new Holder<T1, T2>(t, t);
    }
    public static Holder<T1, T2> CreateDynamicallyFrom(object t)
    {
        return new Holder<T1, T2>(t as T1, t as T2);
    }

    public readonly T1 t1;
    public readonly T2 t2;

    //T1 Getter<T1>.Get()
    //{
    //    return t1;
    //}
    //T2 Getter<T2>.Get()
    //{
    //    return t2;
    //}
}

internal class Holder<T1, T2, T3>  // Holder<T1,T2,T3,T4> etc. are defined in a similar way
    where T1 : class
    where T2 : class
    where T3 : class
{
    private Holder(T1 t1, T2 t2, T3 t3)
    {
        Debug.Assert(t1 != null, "Argument is no " + typeof(T1).Name);
        Debug.Assert(t2 != null, "Argument is no " + typeof(T2).Name);
        Debug.Assert(t3 != null, "Argument is no " + typeof(T3).Name);
        this.t1 = t1;
        this.t2 = t2;
        this.t3 = t3;
    }

    public static Holder<T1, T2,T3> CreateFrom<T>(T t) where T : T1, T2, T3
    {
        return new Holder<T1, T2, T3>(t, t, t);
    }
    public static Holder<T1, T2, T3> CreateDynamicallyFrom(object t)
    {
        return new Holder<T1, T2, T3>(t as T1, t as T2, t as T3);
    }

    public readonly T1 t1;
    public readonly T2 t2;
    public readonly T3 t3;

}

internal static class Test
{

    public static void doIt<T>(T t) where T : IF1, IF2
    {
        t.M1();
        t.M2();
    }

    public static void doIt(Holder<IF1, IF2> t) // Interfaces should be mentioned in alpahbetical order since Holder<IF1,IF2> != Holder<IF2,IF1>
    {
        t.t1.M1();
        t.t2.M2();
    }

    public static void doIt_extended<T1, T2>(Holder<T1, T2> t) // handles conversions from Holder<T1,T2> to Holder<T1 or base of T1, T2 or base of T2>
        where T1 : class, IF1
        where T2 : class, IF2
    {
        t.t1.M1();
        t.t2.M2();
    }

    public static void test()
    {
        var c = new ClassImplementingIF1IF2();
        doIt(c);
        var c_holder = Holder<IF1, IF2>.CreateFrom(c);
        doIt(c_holder);

        var another_c_holder = Holder<IF1_extension, IF2>.CreateFrom(c);
        doIt_extended(another_c_holder);

        object diguised_c = c;
        var disguised_c_holder = Holder<IF1, IF2>.CreateDynamicallyFrom(diguised_c);
        doIt(disguised_c_holder);

    }
} 
```

# javascript - 最简单的 GeoJSON 地图脚本

> ID：13069397
> 
> 赞同：0
> 
> 时间：2012-10-25T13:12:50.747
> 
> 标签：javascript, maps, geojson

我过去使用过 Polymaps，但谁能指出一些非常简单的脚本，它可以从 geojson 生成地图而没有额外的膨胀和库依赖？

我有一个包含 geojson 的 country.json 文件，并且想要在没有 d3、openLayers 或其他库的情况下渲染地图。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T13:24:35.963

它不是一个独立的脚本，而是一个库，但我过去使用过[OpenLayers](http://openlayers.org)。使用起来非常简单，可以与 GeoJson 一起使用。

他们网站上的[示例](http://openlayers.org/dev/examples/)也非常有用。从他们的[GeoJson 示例中](http://openlayers.org/dev/examples/geojson.html)：

```
 map = new OpenLayers.Map( 'map' );
            layer = new OpenLayers.Layer.WMS( "OpenLayers WMS", 
                    "http://vmap0.tiles.osgeo.org/wms/vmap0",
                    {layers: 'basic'} );
            map.addLayer(layer);
            map.setCenter(new OpenLayers.LonLat(lon, lat), zoom);
            var featurecollection = {
              "type": "FeatureCollection", 
              "features": [
                {"geometry": {
                    "type": "GeometryCollection", 
                    "geometries": [
                        {
                            "type": "LineString", 
                            "coordinates": 
                                [[11.0878902207, 45.1602390564], 
                                [15.01953125, 48.1298828125]]
                        }, 
                        {
                            "type": "Polygon", 
                            "coordinates": 
                                [[[11.0878902207, 45.1602390564], 
                                  [14.931640625, 40.9228515625], 
                                  [0.8251953125, 41.0986328125], 
                                  [7.63671875, 48.96484375], 
                                  [11.0878902207, 45.1602390564]]]
                        },
                        {
                            "type":"Point", 
                            "coordinates":[15.87646484375, 44.1748046875]
                        }
                    ]
                }, 
                "type": "Feature", 
                "properties": {}}
              ]
           };
           var geojson_format = new OpenLayers.Format.GeoJSON();
           var vector_layer = new OpenLayers.Layer.Vector(); 
           map.addLayer(vector_layer);
           vector_layer.addFeatures(geojson_format.read(featurecollection)); 
```

# java - Spring Bean 注入时的 ClassNotFoundException

> ID：13069398
> 
> 赞同：1
> 
> 时间：2012-10-25T13:12:51.150
> 
> 标签：java, spring, tomcat, classnotfoundexception

我有一个 Spring`beans.xml`指定通过**Autowiring**`my.package.Class`在我的代码中某处注入的某个类。该程序实际上是 Tomcat 容器内的 Web 应用程序。现在，当我启动 Tomcat 时，日志文件告诉我找不到，即使它的 JAR 位于类路径和 Web 应用程序的 lib/ 目录中。我是否也必须告诉 Tomcat 或 Spring 在哪里可以找到 JAR，如果是的话：如何？**`my.package.Class`**

 *** * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T13:42:57.640

确保您在上下文中有此代码：

```
<context:annotation-config />
<context:component-scan base-package="package.autowire.context" /> 
```

有关更多信息，您最好阅读[http://springindepth.com/book/in-depth-ioc-autowiring.html](http://springindepth.com/book/in-depth-ioc-autowiring.html)

顺便说一下，检查项目构建路径中的默认输出文件夹。这也可能是原因。**

# php - 当分号 (;) 包含在值中时，使用 PHP 解析 INI 文件

> ID：13069401
> 
> 赞同：10
> 
> 时间：2012-10-25T13:13:00.117
> 
> 标签：php, debugging, parsing, ini

我将翻译存储在系统中的 INI 文件中，它们以这种方式存储：

```
$ini=parse_ini_file('translations.ini',false,INI_SCANNER_RAW); 
```

根据文档，这个 INI_SCANNER_RAW 设置告诉 PHP：

> 如果提供了 INI_SCANNER_RAW，则不会解析选项值。

从技术上讲，这意味着它不应该对 INI 文件中的值进行任何解析，因此我不必引用或转义 INI 文件中的任何内容。这些都有效：

```
example1="one"
example2=one
example1='one'
example3="double quotes ("value")"
example4=double quotes ("value")
example3='double quotes ("value")' 
```

他们将输出为：

```
one
one
one
double quotes ("value")
double quotes ("value")
double quotes ("value") 
```

即使这样也有效：

```
semi-colon1="ˇ1234567890+´õü'äö-.,<>~:_ÖÄ*PÕÜ`?=)(/&%¤#"!@£$€{[]}\½" 
```

可预测的输出：

```
ˇ1234567890+´õü'äö-.,<>~:_ÖÄ*PÕÜ`?=)(/&%¤#"!@£$€{[]}\½ 
```

但这里有个问题。在我向 INI 值添加分号 (;) 的那一刻，我的解析中断，即使我试图转义它。

```
example1="semi-colon looks like (;) character"
example1="semi-colon looks like (\;) character"
example1="semi-colon looks like (\\;) character"
example1="semi-colon looks like (\\\;) character" 
```

所有的输出是：

```
"semi-colon looks like (
"semi-colon looks like (
"semi-colon looks like (
"semi-colon looks like ( 
```

（如果我使用单引号而不是双引号，情况也是如此）

我最好的猜测是，这是因为分号被认为是注释的字符，所以它被删除并留下了这段文本。起始引号保留在那里，因为结束引号在分号之后，因此它没有封装。

但这没什么意义，因为# 也被认为是 INI 文件的注释符号。

但这对我的系统来说是一个非常严重的问题，如何在 INI 文件的值字符串中使用分号？这是 PHP 中的错误还是预期的行为？

这也不会引发异常、通知或错误。

谢谢！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-25T13:17:27.127

这是一个已知的错误：

*   [带有 INI_SCANNER_RAW 的 parse_ini_file() 剪切一个包含分号的值](https://bugs.php.net/bug.php?id=51094)

它已[在 PHP 5.4.5 中修复](http://php.net/ChangeLog-5.php#5.4.5)

在 PHP 5.3.15 中也[已修复](http://php.net/ChangeLog-5.php#5.3.15)

# java - 高效实现：Java 中的“Python For Else Loop”

> ID：13069402
> 
> 赞同：36
> 
> 时间：2012-10-25T13:13:03.953
> 
> 标签：java, python, if-statement, for-loop

[在 Python 中，这里](http://docs.python.org/tutorial/controlflow.html#break-and-continue-statements-and-else-clauses-on-loops)描述了一个有效的 for else 循环实现

示例代码：

```
for x in range(2, n):
    if n % x == 0:
        print n, 'equals', x, '*', n/x
        break
else:
    # loop fell through without finding a factor
    print n, 'is a prime number' 
```

在 Java 中，我需要编写更多代码来实现相同的行为：

```
finishedForLoop = true;
for (int x : rangeListOfIntegers){
    if (n % x == 0)
    {
        //syso: Some printing here
        finishedForLoop = false
        break;
    }
}
if (finishedForLoop == true){
    //syso: Some printing here
} 
```

Java中的else循环有没有更好的类似于Python的实现？

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2013-06-24T17:51:53.990

它是这样完成的：

```
class A {
    public static void main(String[] args) {
        int n = 13;
        found: {
            for (int x : new int[]{2,3,4,5,6,7,8,9,10,11,12})
                if (n % x == 0) {
                    System.out.println("" + n + " equals " + x + "*" + (n/x));
                    break found;
                }
            System.out.println("" + n + " is a prime number");
        }
    }
} 
```

* * *

```
$ javac A.java && java A
13 is a prime number 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-10-25T13:15:49.217

当我需要做这样的事情时，如果不需要额外的信息，我通常会尝试将其分解为一个单独的方法——然后它可以返回`true`/`false`或者返回找到的值，或者如果没有找到则返回 null。它并不*总是*有效 - 它是非常特定于上下文的 - 但它是值得尝试的。

然后你可以写：

```
for (...) {
    if (...) {
       return separateMethod();
    }
}
return null; // Or false, or whatever 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-25T13:14:38.380

不，这是最简单的。它并不*复杂*，它只是语法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-11-11T13:07:20.143

由于 java8 有一种方法可以用“几乎没有”代码来编写它：

```
if(IntStream.range(2, n).noneMatch(x -> n % x == 0)) {
   System.out.println(n + " is a prime number");
} 
```

但是：这将比经典的循环中断和标志方法效率低。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-25T13:14:59.163

不，Java 中没有这样的机制

# express - 将 sass 与 expressjs 一起使用

> ID：13069403
> 
> 赞同：0
> 
> 时间：2012-10-25T13:13:04.740
> 
> 标签：express, sass

将 sass 与 express.js 框架一起使用的最佳方式是什么。我从我已经完成的地方开始

```
npm install sass 
```

我相信以前使用 express 2.x 可以做类似的事情 -

```
app.use(express.compiler({ src: pub, enable: ['sass'] })) 
```

但是使用 express 3.x 它给了我错误：

```
 app.init();
  return app;
} has no method 'compiler' 
```

express 3.x 中包含的替代语句是什么？

同样，如果有人可以让我知道如何插入咖啡脚本，那将是很大的帮助。

我见过使用 Cakefile 预编译的例子，但这是唯一的解决方案吗？这意味着添加一个运行 Cake 任务的额外步骤。与 express app.js / app.coffee 中定义的内容相比，这有什么优势。

我看过[connect-assets](https://github.com/TrevorBurnham/connect-assets)（它做的是 coffeescript 但不是 sass），还有一个地方也提到过[connect-assetmanager](https://github.com/mape/connect-assetmanager) pre hook，但没能做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T20:57:32.950

[https://github.com/visionmedia/express/wiki/Migrating-from-2.x-to-3.x](https://github.com/visionmedia/express/wiki/Migrating-from-2.x-to-3.x)说：

> 模板引擎合规性从`engine.compile(str, options)`=> 函数到`engine.__express(filename, options, callback)`

# java - 按时间升序对 Hashmap 数组进行排序

> ID：13069412
> 
> 赞同：2
> 
> 时间：2012-10-25T13:14:10.183
> 
> 标签：java, arrays, time, hashmap, sorting

我有一个 Hashmap 数组，每个 hashmap 包含**24 小时时间作为 key-value pair**。

我想按时间升序对该数组进行排序。我怎样才能做到这一点？

这是我的代码片段：

```
HashMap[] arr = new HashMap[100];

for(int i=0;i<100;i++) {
  HashMap<String,String> child=new HashMap<String,String>();
  child.put("some_time","21:09");  //time changes per iteration(time is in 24-hour format)
  arr[i]=child;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T13:22:47.163

您可以使用`Arrays.sort(T[], Comparator<T>)`. 这允许您传递任何类型的数组并编写自己的自定义比较器方法，如下所示：

```
Arrays.sort(arr, new Comparator<HashMap>() {
    public int compare(HashMap o1, HashMap o2) {
        // Compare values you're interested in and return int as specified by Comparator API
    }
}); 
```

有关返回内容的详细信息，请参阅[API 。](http://docs.oracle.com/javase/6/docs/api/java/util/Comparator.html#compare%28T,%20T%29)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T13:46:19.247

这是按时间对数组进行排序的完整代码，`hh:mm`格式为：

```
HashMap<String,String>[] harr = new HashMap[10];
final DateFormat df = new SimpleDateFormat("kk:mm");
// prepare your data
for(int i=0;i<harr.length;i++) {
   HashMap<String,String> child=new HashMap<String,String>();
   int ss = (int)(Math.random() * (59 + 1));
   //time changes per iteration(time is in 24-hour format)
   child.put("some_time", String.format("21:%02d", ss));
   harr[i]=child;
}
System.out.printf("map array is: %s%n", Arrays.deepToString(harr));

// now apply sort using a custom method
Arrays.sort(harr, new Comparator<HashMap<String,String>>() {
    public int compare(HashMap<String,String> o1, HashMap<String,String> o2) {
       String t1 = o1.get("some_time");
       String t2 = o2.get("some_time");
       try {
           Date dt1 = df.parse(t1);
           Date dt2 = df.parse(t2);
           return dt1.compareTo(dt2);
       } catch (ParseException e) {
           e.printStackTrace();
       }
       return 0;
    }
});
System.out.printf("sorted map array is: %s%n", Arrays.deepToString(harr)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-25T13:28:51.307

Before proceeding with this approach, do think about the comments and decide whether the array of hashmaps is the right way to go. If, as I pointed out, you have a bunch of maps, each containing large amounts of information, with one entry being your dates, then this may be the right thing to do, in which case the easiest way to sort the array would be to use `Arrays.sort` method:

```
HashMap[] arr=new Hashmap[100];

for(int i=0;i<100;i++){
    HashMap<String,String> child=new HashMap<String,String>();
    ... // put all the info into the HashMap
    child.put("some_time","21:09");  //time changes per iteration(time is in 24-hour format)
    arr[i]=child;
}

Arrays.sort(arr, new Comparator<HashMap>() {
    public int compare(HashMap o1, HashMap o2) {
        String d1 = o1.get("some_time");
        String d2 = o2.get("some_time");

        //compare the two dates.  If you're always in the same format, e.g. HH:MM (24 hours, two-digit hour, two-digit year), you might even be able to simply compare strings:
        return d1.compareTo(d2);
    }
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T13:20:22.487

正如 Bhavik 指出的那样，您可能没有充分发挥 JDK 的潜力——看看[SortedMap](http://docs.oracle.com/javase/6/docs/api/java/util/SortedMap.html)可能正是您正在寻找的；可能使用您自己的[Comparator](http://docs.oracle.com/javase/6/docs/api/java/util/Comparator.html)实现。

```
SortedMap arr = new TreeMap<String,HashMap<String,String>>();
for ( int i=0 ; i<100 ; i++ )
{
    Map<String,String> child = HashMap<String,String>();
    child.put( "some_time" , "21:09" );
    arr.put( "21:09" , child );
} 
```

然后你可以`arr.values().iterator()`用来得到你的排序`child`仁。

干杯，

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-25T13:22:57.610

一般的方法是编写一个基于键`Comparator`对一对`HashMap`对象进行排序，然后将其作为参数传递给`Arrays.sort(T[], Comparator<T>)`方法。

比较器看起来像这样：

```
 Comparator<HashMap> DATE_ORDER = new Comparator<HashMap>() {
        public int compare(Comparator<HashMap>h1, Comparator<HashMap>h2) {
            String time1 = h1.get("some_time");
            String time2 = h2.get("some_time");
            return time1.compareTo(time2);  // assuming that the time strings
                                            // can be ordered that way
        }
    }; 
```

* * *

话虽如此，您的问题具有在真正应该编写自定义类时尝试使用 Maps 的“气味”。

# uiwebview - webview 在 ios6 中出现旋转，但看起来没问题 <= ios 5.1 模拟器

> ID：13069413
> 
> 赞同：1
> 
> 时间：2012-10-25T13:14:10.527
> 
> 标签：uiwebview, ios6, ios5.1

嗨，我有一个应用程序，我在其中设置了支持的界面方向，在 .plist 文件中设置为横向（左主页按钮）、横向（右主页按钮）

并在 testviewcontroller.m 文件中

我有代码： -

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return (interfaceOrientation == UIInterfaceOrientationLandscapeLeft || interfaceOrientation == UIInterfaceOrientationLandscapeRight);
} 
```

我必须进行哪些更改才能使其在 ios6 模拟器上正常显示

谢谢

找到了答案：-

```
 if ([[UIDevice currentDevice].systemVersion floatValue] < 6.0)
{
    // how the view was configured before IOS6
    [self.window addSubview: navigationController.view];
    [self.window makeKeyAndVisible];
}
else
{
    // this is the code that will start the interface to rotate once again
    [self.window setRootViewController: self.navigationController];
} 
```

从这个链接 -

[IOS 6强制设备方向为横向](https://stackoverflow.com/questions/12640870/ios-6-force-device-orientation-to-landscape)

但现在 ios6 中的另一个问题 - 单击文本框不会调用键盘

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T23:54:43.660

[https://developer.apple.com/library/prerelease/ios/#releasenotes/General/RN-iOSSDK-6_0/_index.html](https://developer.apple.com/library/prerelease/ios/#releasenotes/General/RN-iOSSDK-6_0/_index.html)

UIKit 部分解释了如何在 iOS6 中进行旋转。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T14:05:34.060

```
 if ([[UIDevice currentDevice].systemVersion floatValue] < 6.0)
{
    // how the view was configured before IOS6
    [self.window addSubview: navigationController.view];
    [self.window makeKeyAndVisible];
}
else
{
    // this is the code that will start the interface to rotate once again
    [self.window setRootViewController: self.navigationController];
} 
```

# c - C 编程套接字缓冲区

> ID：13069419
> 
> 赞同：1
> 
> 时间：2012-10-25T13:14:35.263
> 
> 标签：c, sockets, buffer

回复：这个客户端<->服务器（foodrequest-foodinfo 场景）我正在尝试将接收发送到成功的客户端-服务器连接 sock_fd。在这个循环中，我收到了第一个信息，但下一次迭代在键盘输入处停止，即 readInFood()。我处理缓冲区的方式有什么问题吗？或其他。

```
RESPONSE_BUFFER = 2200;
INPUT_BUFFER = 100;
int numbytes;
char foodType[INPUT_BUFFER];
char foodResponse[RESPONSE_BUFFER];

do {

    //send a message to server
    if (send(sock_fd, readInFood(foodType), INPUT_BUFFER, 0) == -1)
        perror("send");

    //receive the message
    if ((numbytes = read(sock_fd, foodResponse, RESPONSE_BUFFER)) == -1) {
        perror("receive");
        exit(EXIT_FAILURE);
    }
    //end the buffer string
    foodResponse[numbytes] = '\0';

    //print the buffer
    printf("\nThis is the information you require: %s", foodResponse);

} while (foodType[0] != 'q' || foodType[0] != 'Q'); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T20:09:25.187

我的猜测是您的套接字正在阻塞，因为它需要更多信息或者它没有得到任何其他信息。在这种情况下 perror() 不会触发，但您的程序将继续等待信息。

# java - 方法和类的问题，以及使用它们形成的数组

> ID：13069424
> 
> 赞同：0
> 
> 时间：2012-10-25T13:14:57.080
> 
> 标签：java, arrays, class, methods, constructor

所以基本上，我有 2 个课程（到目前为止）“座位”和“剧院”以及我的主要方法。

我要制作一个电影院预订系统，为此我需要使用数组创建一个“电影院”。但是我希望能够制作尽可能多的这些电影院，并且我可能会添加其他变量，例如（时间、电影等），我想我会制作一个包含座位数组的“剧院”类在它的构造函数中，然后有一个显示数组的方法，但是我不确定如何执行它。

这是我到目前为止所拥有的”

主类：

```
public class CinemaSystem {

    public static void main(String[] args) {

        // Creating a cinema.

        Theatre cinema1 = new Theatre();

        Scanner scan = new Scanner(System.in);
        Scanner scan1 = new Scanner(System.in);
        System.out.print("Welcome to the Theatre Booking System. (QUIT to exit)"
                + "\nWould you like to purchase tickets or list available seats?"
                + "(/Purchase/List/Help)");
        String answer, answer2;

        answer = scan.nextLine();
        int count = 0;

        if (answer.equalsIgnoreCase("purchase")) {
            cinema1.DisplayTheatre(Seat 
            y[][]
          );

            } else if (answer.equalsIgnoreCase("list")) {
        } else if (answer.equalsIgnoreCase("help")) {
            // Code for help
        } else if (answer.equalsIgnoreCase("quit")) {
            System.exit(-1);
        } else {
            do {
                System.out.print("Sorry, incorrect input please enter"
                        + " a valid input (Purchase/List/Help or QUIT to exit");
                answer = scan1.nextLine();
                count++;

                if (answer.equalsIgnoreCase("purchase")) {
                    // Code for purchase  
                } else if (answer.equalsIgnoreCase("list")) {
                    // Code for list   
                } else if (answer.equalsIgnoreCase("help")) {
                    // Code for help
                } else if (answer.equalsIgnoreCase("quit")) {
                    System.exit(-1);
                } else if (count == 3) {
                    System.out.print("Are you stupid? Purchase/List/Help or Quit are your options. ... Terminating...");
                    System.out.println();
                    System.exit(1);
                }
            } while (!answer.equalsIgnoreCase("purchase")
                    || !answer.equalsIgnoreCase("list")
                    || !answer.equalsIgnoreCase("help")
                    || !answer.equalsIgnoreCase("quit"));

        }
    }
} 
```

座位等级：

```
public class Seat {

    public Seat() {
    }

    private String type;
    private boolean status;

    public String GetType() {
        return type;
    }

    public void SetType(String x) {

        type = x;
    }

    public boolean SetStatus() {
        return status;
    }

    public void GetStatus(boolean x) {
        status = x;
    }
} 
```

戏剧课：

```
public class Theatre{

    public Theatre() {
        Seat B = new Seat();
        Seat S = new Seat();
        Seat G = new Seat();

        Seat y[][] = {
            {B, B, B, B, B, B, B, B},
            {B, B, B, B, B, B, B, B},
            {B, B, B, B, B, B, B, B},
            {B, B, B, B, B, B, B, B, B, B, B, B, B, B, B, B, B, B},
            {B, B, B, B, B, B, B, B, B, B, B, B, B, B, B, B, B, B},
            {B, B, B, B, B, B, B, B, B, B, B, B, B, B, B, B, B, B},
            {B, B, B, B, S, S, S, S, S, S, S, S, S, S, B, B, B, B},
            {B, B, B, B, S, S, S, S, S, G, G, G, G, G, S, S, S, S, S, B, B, B, B},
            {B, B, B, B, S, S, S, S, S, G, G, G, G, G, S, S, S, S, S, B, B, B, B},
            {S, S, S, S, S, S, S, S, S, G, G, G, G, G, S, S, S, S, S, S, S, S, S},
            {S, S, S, S, S, S, S, G, G, G, G, G, G, G, G, G, S, S, S, S, S, S, S},
            {S, S, S, S, S, S, S, G, G, G, G, G, G, G, G, G, S, S, S, S, S, S, S},
            {S, S, S, S, S, S, S, G, G, G, G, G, G, G, G, G, S, S, S, S, S, S, S}
        };
    }

    public void DisplayTheatre(Seat x[][]) {
        for (int row = 0; row < x.length; row++) {
            for (int col = 0; col < x[row].length; col++) {
                System.out.print(x[row][col]);
            }
            System.out.println();
        }

    }
} 
```

因此，由于这不起作用，我知道我正在以错误的方式进行操作，我如何能够打印出 Theatre 类的构造函数中的数组？

任何帮助将不胜感激，在此先感谢您。^^

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T14:02:51.413

你做错了三件事。

1.  您没有做任何事情来区分对象，您`Seat()`为所有三个都调用了 new ，但您从来没有调用`setType()`来更改它们的值，因此它们都会以相同的方式打印。您可能需要考虑使用构造函数`Seat(String type)`并在那里加载值。
2.  Java 自然具有通过本机方法将所有`Object`s 转换为s 的能力如果您想要打印除默认输出以外的其他内容（几乎总是如此），您要么需要显式调用返回字符串的方法想要（例如，或在您的座位类中创建一个方法。`String``Object.toString()``System.out.print(x[row][col]);``Object``Seat.GetType()``public String toString()`
3.  构造函数中的变量都在剧院类的本地范围内。所以在构造函数完成后，它们都消失了。此外，由于在剧院中您似乎想将数组定义为剧院对象的一部分，您可能不应该将它作为参数传递，您应该只使用类中的字段。（总结版：将变量声明移到构造函数之外）

# javascript - 在 BLUR 上不开火

> ID：13069427
> 
> 赞同：4
> 
> 时间：2012-10-25T13:15:02.523
> 
> 标签：javascript, asp.net, vb.net, onblur

最近从编写小型 vb 应用程序更改为 Web 应用程序。目前还没有切换到 C#。

试图让一个 ASP.net 表单添加几个文本框并在另一个文本框中显示结果。

`FormView`这是在插入模式下使用控件的ASP.NET 4.0 表单。问题是，无论我在框中单击、Tab 进入或退出，它似乎都不会触发 JavaScript

```
<script language="javascript" type="text/javascript">
function SumCalc() 
{
    Window.alert("On Blur");
    var num1 = parseInt(document.getElementById("LeaveHoursTextBox").value);
    var num2 = parseInt(document.getElementById("LeaveHours2TextBox").value);
    var num3 = parseInt(document.getElementById("LeaveHours3TextBox").value);
    var TotalTime = num1 + num2 + num3

    document.getElementById("HoursTextBox").value = TotalTime;
}
</script> 
```

以下是我的html的一部分。页面很长，所以我没有发布它的全部..

```
<asp:TextBox ID="LeaveHoursTextBox" runat="server" 
Text='<%# Bind("LeaveHours") %>' 
onblur = "return sumCalc()"/> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T13:19:01.700

有两个问题，

**一**

更改`onblur = "return sumCalc()"`为`onblur = "return SumCalc()"/>`

您调用的 JS 函数有错字。

**二**

更改`Window.alert("On Blur");`为`alert("On Blur");`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-25T13:17:57.297

Javascript 区分大小写。将您的电话更改为`return SumCalc()`，也`Window.alert`不会工作，使用`window.alert`或只是`alert`代替。

进一步从 中删除空格`onblur = "return sumCalc()"`，有效的 html 将是 `onblur="return sumCalc()"`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-25T13:20:42.187

通过 jQuery blur 绑定它：http: [//api.jquery.com/blur/](http://api.jquery.com/blur/)

你可以这样做：

```
$("#LeaveHoursTextBox").blur(function(){
    Window.alert("On Blur");
    var num1 = parseInt(document.getElementById("LeaveHoursTextBox").value);
    var num2 = parseInt(document.getElementById("LeaveHours2TextBox").value);
    var num3 = parseInt(document.getElementById("LeaveHours3TextBox").value);
    var TotalTime = num1 + num2 + num3

    document.getElementById("HoursTextBox").value = TotalTime;
}) 
```

# wpf - WPF导航服务goBack不起作用

> ID：13069431
> 
> 赞同：1
> 
> 时间：2012-10-25T13:15:07.410
> 
> 标签：wpf, vb.net, navigationservice

我有一个 navigationWindow 和一些页面。应用程序 startupURI 设置为 'page1.xaml' 。

如果我显示 NavigatoinUI，前进和后退按钮可以正常工作，但是如果我调用 navigationserivce.goBack()，我会收到异常“无法导航，因为日志的后退堆栈中没有条目”。

导航到 page2 的代码

```
NavigationService.Navigate(New page2) 
```

不起作用的代码（在第 2 页中）

```
NavigationService.GoBack() 
```

有任何想法吗？我尝试了各种调用 navigationService 方法的方法。

干杯，

# apache - 用 apache solr 去除重音

> ID：13069434
> 
> 赞同：4
> 
> 时间：2012-10-25T13:15:17.257
> 
> 标签：apache, search, solr, schema

我正在尝试使用此方案[http://pastie.org/5114389](http://pastie.org/5114389)使用 apache solr 进行搜索，但是当我键入“josé”时，找到了文件，但是当我写“jose”时，我没有得到结果。

Efetuei 在互联网上搜索答案并不得不使用该课程，但是当我插入时没有任何区别。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-25T13:46:01.590

我从您的架构中看到您正在使用`ASCIIFoldingFilterFactory`已`text`分配给该`default`字段的 fieldType 。但是，它仅应用于该字段的索引。我建议您也将其应用于字段查询，以确保您的查询词被折叠以匹配索引中的项目。通常，在这种情况下，当您将过滤器工厂添加到索引时，您也会将其添加到查询中，以便查询词和索引词都被适当地转换/比较。

因此，我会将您的架构修改为以下内容：

```
<fieldType name="text" class="solr.TextField" omitNorms="false">
  <analyzer type="index">
    <tokenizer class="solr.WhitespaceTokenizerFactory"/>
    <filter class="solr.StopFilterFactory" ignoreCase="true" words="stopwords.txt"/>
    <filter class="solr.WordDelimiterFilterFactory" generateWordParts="1" generateNumberParts="1" catenateWords="0" catenateNumbers="0" catenateAll="0"/>
    <filter class="solr.LowerCaseFilterFactory" />
    <filter class="solr.ASCIIFoldingFilterFactory" words="mapping-FoldToASCII.txt"/>
    <filter class="solr.RemoveDuplicatesTokenFilterFactory" />
  </analyzer>
  <analyzer type="query">
    <tokenizer class="solr.WhitespaceTokenizerFactory"/>
    <filter class="solr.StopFilterFactory" ignoreCase="true" words="stopwords.txt"/>
    <filter class="solr.WordDelimiterFilterFactory" generateWordParts="1" generateNumberParts="1" catenateWords="0" catenateNumbers="0" catenateAll="0"/>
    <filter class="solr.LowerCaseFilterFactory" />
    <filter class="solr.ASCIIFoldingFilterFactory" words="mapping-FoldToASCII.txt"/>
    <filter class="solr.RemoveDuplicatesTokenFilterFactory" />
  </analyzer>
</fieldType> 
```

# actionscript-3 - getElementByName 似乎不起作用

> ID：13069440
> 
> 赞同：0
> 
> 时间：2012-10-25T13:15:47.540
> 
> 标签：actionscript-3, apache-flex, getelementbyid

我正在使用 Flex 4.6 并且有一个 AIR 应用程序

我有一个面板，上面有很多标签。我需要从另一个类访问这些标签。我不想传递所有标签对象。所以我考虑传入面板容器，然后通过 getElementByName() 方法访问标签。

这是我的标记：

```
<s:VGroup includeIn="SLA_textView" width="100%" height="100%"
paddingBottom="10" paddingRight="10">
<s:Panel id="SlaTextViewPanel" width="100%" height="100%"
 title="test View">
   <s:Label id="lbTotalBooks" name="test" x="82" y="62" />
</s:Panel>
</s:VGroup> 
```

动作脚本代码如下所示：

```
getLabels(Container:Panel){
  var _Container:Panel = Container;

//var tempLabel:Label =  _Container.getChildByName("test") as Label;

var n:int = _Container.numChildren;
  for (var i:int = 0; i < n; i++) {
    var c:DisplayObject = _Container.getChildAt(i); 
    trace(c.name);
}

var tempLabel:Label =  _Container.getChildByName("test") as Label; 
```

为什么`tempLabel`总是`null`？

所以我试图遍历面板上对象的名称，而测试标签甚至没有出现？所以我在某个地方出了点问题。

痕迹：

```
instance1333
PanelSkin1074 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T09:03:33.817

您何时何地调用`getLabels`方法？标签可能已创建但尚未初始化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-06-30T14:05:40.860

你可以使用这样的东西：

```
var element:Group = "searchId" in this ? this["searchId"] as Group : null; 
```

# joomla - 发布网站链接时显示正确的 joomla 网站信息

> ID：13069442
> 
> 赞同：1
> 
> 时间：2012-10-25T13:15:50.923
> 
> 标签：joomla, joomla2.5

我希望有人可以帮助我解决问题。当有人发布指向我的 joomla 创建网站的链接时，他们会得到标题“最新消息？”，这是该网站的默认文章页面。它是当前写的博客文章。

例如，如果有人在 facebook 上发布了我的链接，它将如下所示：

```
Whats New? 
MyDomain.com
Description of website goes here... 
```

除了“Whats New？”之外，一切看起来都很棒。有没有办法将我的网页名称而不是默认页面的名称？显示图像怎么样？在 Facebook 上发布时，只有文字，没有使用图像。

谢谢，任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T19:49:21.997

**Facebook 使用 Opengraph**数据来构建这些帖子。如果 facebook 没有提供 OpenGraph 数据，那么它将使用自己的方法来尝试查找所需的信息。有时会产生无用的结果。有很多选项可以解决此问题。Joomla 扩展有一些 opengraph 扩展供您安装，其中一些应该可以正常工作。您始终可以自己编写内容或在模板中添加数据。但不要马上期待结果，因为 facebook 会缓存这些媒体对象一段时间。

*   *打开图：* [https ://developers.facebook.com/docs/opengraph/](https://developers.facebook.com/docs/opengraph/)
*   *Joomla 扩展：* [http ://extensions.joomla.org/extensions/site-management/seo-a-metadata/open-graph](http://extensions.joomla.org/extensions/site-management/seo-a-metadata/open-graph)

有更多方法可以解决此问题，但这对您来说可能是最简单的。希望能帮助到你。

祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T13:19:51.657

在 Joomla 后端，执行以下操作：

1.  打开文章被分配到的菜单项。
2.  在右侧，打开**页面显示选项**面板
3.  将您喜欢的任何内容添加到**浏览器页面标题**参数。

希望这可以帮助

# matlab - 如何使用句柄在 MATLAB 中绘制多条曲线

> ID：13069444
> 
> 赞同：3
> 
> 时间：2012-10-25T13:15:52.827
> 
> 标签：matlab, real-time, handle, lineseries

我在 MATLAB 中实时绘制数据。我想用手柄。我的问题是我不知道如何绘制多个 Y 数据曲线。

我发现以下代码它显示了如何绘制一组 YData。有没有人想到将代码转换为两个或多个 Y 数据集，例如 sind(x) 作为图中的附加曲线？

```
x = 1:1000;
y = cosd(x);

xi = x(1);
yi = y(1);
h = plot(xi, yi, 'YDataSource', 'yi', 'XDataSource', 'xi');

for k = 2:1000...
xi = x(1:k);
yi = y(1:k);
refreshdata(h, 'caller');
drawnow;
end; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T13:52:43.777

如果您真的想使用句柄，下面的代码对我有用

```
x = 1:1000;
y = cosd(x);
y2 = sind(x);

xi = x(1);
yi = y(1);
yi2 = y2(1);
figure(1); clf;
h = plot(xi, yi, 'YDataSource', 'yi', 'XDataSource', 'xi');
hold on;
h2 = plot(xi, yi2, 'YDataSource', 'yi2', 'XDataSource', 'xi');

for k = 200:1000
    xi = x(1:k);
    yi = y(1:k);
    yi2 = y2(1:k);
    refreshdata(h);
    refreshdata(h2);
    drawnow;
end; 
```

你确实需要一个`hold on`.

此外，`refreshdata`您可以`set`按照安德烈的建议使用：

```
set(h,'Xdata',xi,'YData',yi);
set(h2,'Xdata',xi,'YData',yi2); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-25T13:20:06.987

首先，永远不要使用`refreshdata`. 请改用直接`set`方法。

```
 set(h,'Xdata',xi,'YData',yi); 
```

其次，你应该做两个情节

```
 h1 = plot(xi, yi);
      h2 = plot(xi, yi); 
```

并相应地更新每一个。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-25T13:25:18.543

您是否正在寻找[`hold`命令](http://www.mathworks.de/de/help/matlab/ref/hold.html)？

```
plot(1 : 10, (1 : 10).^2, 'r')
hold on
plot(1 : 10, (1 : 10).^3) 
```

编辑：

您可以`hold`结合使用`set`来更新情节（另见[安德烈的](https://stackoverflow.com/users/817452/andrey)回答）：

```
h1 = plot(1 : 10, (1 : 10).^2, 'r');
hold on;
h2 = plot(1 : 10, (1 : 10).^3);
set(h1, 'XData', 1 : 2 : 20);
set(h2, 'YData', 0.1 * (1 : 20).^3); 
```

轴将自动更新。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-20T16:44:03.887

如果您不太关心为所有曲线显示相同的颜色，只需将 x 数据连接到曲线组件之间由 NaN 分隔的单个向量（对 y 数据执行类似的操作）。然后“绘图”命令可以接收这些较大的 x 和 y 向量，并立即显示所有内容。您可以通过对 colordata 数组执行类似操作来解决颜色问题。

# svg - svg中的简单填充图案：对角线阴影

> ID：13069446
> 
> 赞同：83
> 
> 时间：2012-10-25T13:16:01.487
> 
> 标签：svg

如果可能的话，我将如何填充 SVG 形状，而不是使用单一颜色、图像或渐变，而是使用对角线的阴影图案。

已经 2 小时了，我什么也没找到（至少在 2005 年之后）。

我认为一个可能的 hack 将是一个作为填充的阴影 PNG，但这并不理想。

* * *

## 回答 #1

> 赞同：142
> 
> 时间：2013-01-24T11:17:20.743

我也没有在互联网上找到任何关于对角线孵化的东西，所以我将在这里分享我的解决方案：

```
<pattern id="diagonalHatch" patternUnits="userSpaceOnUse" width="4" height="4">
  <path d="M-1,1 l2,-2
           M0,4 l4,-4
           M3,5 l2,-2" 
        style="stroke:black; stroke-width:1" />
</pattern> 
```

（注意路径表达式中的小写“l”）

上面创建了一个从左下角到右上角的对角线，相距 4 个像素。除了对角线 ( `M0,4 l4,-4`) 之外，您还必须描边图案区域的左上角和右下角边缘，因为否则该线会因为与正方形边缘相交的位置被剪裁而“收缩”。

![应用上述步骤后的模式示例，它显示了它命名的模式如何制作最终产品](../Images/5672c8c4787ddbcc5cf616e49111e89a.png)

要使用此图案填充矩形，请执行以下操作：

```
<rect x="0" y="0" width="100%" height="100%" fill="url(#diagonalHatch)"/> 
```

* * *

## 回答 #2

> 赞同：81
> 
> 时间：2014-03-25T18:52:10.017

使用 patternTransform 属性旋转垂直（或水平）线段。此方法无缝拼接并使用最简单的路径。图案`width`属性控制平行影线的接近程度。

```
<pattern id="diagonalHatch" width="10" height="10" patternTransform="rotate(45 0 0)" patternUnits="userSpaceOnUse">
  <line x1="0" y1="0" x2="0" y2="10" style="stroke:black; stroke-width:1" />
</pattern> 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2012-10-25T13:28:43.253

您可以使用`<pattern>`标签创建您想要的内容。

作为起点，您可能会以[相应的 MDN 文档](https://developer.mozilla.org/en-US/docs/SVG/Element/pattern)为例：

```
 <?xml version="1.0"?>
    <svg width="120" height="120" viewBox="0 0 120 120"
         xmlns="http://www.w3.org/2000/svg" version="1.1"
         xmlns:xlink="http://www.w3.org/1999/xlink">

        <defs>
            <pattern id="Triangle"
                     width="10" height="10"
                     patternUnits="userSpaceOnUse">
                <polygon points="5,0 10,10 0,10"/>
            </pattern>
        </defs>

        <circle cx="60" cy="60" r="50"
                fill="url(#Triangle)"/>
    </svg>
```

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2014-07-09T00:10:19.830

[来自http://bl.ocks.org/jfsiii/7772281](http://bl.ocks.org/jfsiii/7772281)的这段代码看起来非常干净且可重用：

```
svg {
  width: 500px;
  height: 500px;
}

rect.hbar {
  mask: url(#mask-stripe)
}

.thing-1 {
  fill: blue;
}

.thing-2 {
  fill: green;
}
```

```
 <!DOCTYPE html>
    <html>
      <head>
        <meta charset=utf-8 />
        <title>SVG colored patterns via mask</title>
      </head>
      <body>
        <svg>
          <defs>
            <pattern id="pattern-stripe" 
              width="4" height="4" 
              patternUnits="userSpaceOnUse"
              patternTransform="rotate(45)">
              <rect width="2" height="4" transform="translate(0,0)" fill="white"></rect>
            </pattern>
            <mask id="mask-stripe">
              <rect x="0" y="0" width="100%" height="100%" fill="url(#pattern-stripe)" />
            </mask>      
          </defs>

          <!-- bar chart -->
          <rect class="hbar thing-2" x="0" y="0" width="50" height="100"></rect>
          <rect class="hbar thing-2" x="51" y="50" width="50" height="50"></rect>
          <rect class="hbar thing-2" x="102" y="25" width="50" height="75"></rect>

          <!-- horizontal bar chart -->
          <rect class="hbar thing-1" x="0" y="200" width="10" height="50"></rect>
          <rect class="hbar thing-1" x="0" y="251" width="123" height="50"></rect>
          <rect class="hbar thing-1" x="0" y="302" width="41" height="50"></rect>

        </svg>
      </body>
    </html>
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2013-07-19T10:09:25.670

在图案中绘制对角线的一个问题是，当图案平铺时，线条并不总是对齐 - 尤其是在高缩放时。（这取决于您碰巧使用的 SVG 渲染引擎）。@Ingo 上面的答案试图通过在左上角和右下角绘制三角形来解决这个问题 - 但同样，使用一些渲染引擎和高缩放，它并不总是看起来最好 - 有时这条线最终看起来有点像一串香肠。

另一种方法是在图案中画一条水平线并旋转图案，例如

```
 <svg:svg viewBox="0 0 100 100" version="1.1"
xmlns:svg="http://www.w3.org/2000/svg"
xmlns:xlink="http://www.w3.org/1999/xlink">
<svg:defs>
  <svg:pattern id="diagonalHatch" patternUnits="userSpaceOnUse" width="4" height="4" patternTransform="rotate(45 2 2)">
    <svg:path d="M -1,2 l 6,0" stroke="#000000" stroke-width="1"/>
  </svg:pattern>
</svg:defs>
<svg:rect x="0" y="0" height="100" width="100" fill="url(#diagonalHatch)"/> 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2015-12-22T18:07:52.723

这两个资源非常有帮助： [https ://bocoup.com/weblog/using-svg-patterns-as-fills](https://bocoup.com/weblog/using-svg-patterns-as-fills) [https://github.com/iros/patternfills/blob/master/public/patterns.css](https://github.com/iros/patternfills/blob/master/public/patterns.css)

例如：

```
<svg xmlns='http://www.w3.org/2000/svg' width='10' height='10'>
  <rect width='10' height='10' fill='red'/>
  <path d='M-1,1 l2,-2
           M0,10 l10,-10
           M9,11 l2,-2' stroke='orange' stroke-width='2'/>
</svg> 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2016-06-29T10:19:12.987

这是在图案中使用圆形的对角线的解决方案。您可以根据需要更改角度。

```
<svg width="500" height="500">
    <defs>
        <pattern id="transformedPattern"
            x="0" y="0" width="2" height="20"
            patternUnits="userSpaceOnUse"
            patternTransform="rotate(45)">

            <circle cx="1" cy="1" r="2" style="stroke: none; fill: #0000ff" />
        </pattern>
    </defs>

    <rect x="10" y="10" width="100" height="100"
        style="stroke: #000000; fill: url(#transformedPattern);" />
</svg> 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2019-03-11T14:34:18.513

我试过这个样本。希望，它可以帮助你很多。

```
<!DOCTYPE html>
<html>
  <head>
    <meta charset=utf-8 />
    <title>SVG colored patterns via mask</title>
  </head>
  <body>
    <svg viewBox="0 0 300 300" xmlns="http://www.w3.org/2000/svg">
      <defs>
        <pattern id="stripes" viewBox="0,0,8,8" width="16" height="16" patternUnits="userSpaceOnUse">
          <polygon points="0,0 4,0 0,4" fill="yellow"></polygon>
          <polygon points="0,8 8,0 8,4 4,8" fill="yellow"></polygon>
          <polygon points="0,4 0,8 8,0 4,0" fill="green"></polygon>
          <polygon points="4,8 8,8 8,4" fill="green"></polygon>
        </pattern>
      </defs>
	  <rect fill="url(#stripes)" x="150" y="20" width="100" height="50" />
      <circle cx="50"  cy="50" r="50" fill="url(#stripes)"/>
    </svg>
  </body>
</html> 
```

问候，武潘

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2020-05-21T17:36:56.427

SVG 2 有一个专门用于此目的的[`hatch`实体](https://www.w3.org/TR/2015/WD-SVG2-20150915/pservers.html#Hatches)。从该页面的示例部分：

```
<hatch hatchUnits="userSpaceOnUse" pitch="5" rotate="135">
  <hatchpath stroke="#a080ff" stroke-width="2"/>
</hatch> 
```

这是一种非常容易配置的创建影线的方法：

[![来自 w3c 的孵化标签插图](../Images/c8a7b90bed81d0fb1526a739c76560a1.png)](https://i.stack.imgur.com/HNyjT.png)

此外，[孵化路径](https://www.w3.org/TR/2015/WD-SVG2-20150915/pservers.html#Hatchpaths)也可以定制：

```
<hatchpath stroke-width="1" d="C 0,4 8,6 8,10 8,14 0,16 0,20"/> 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-06-20T04:15:01.377

对于 React Native 使用可以使用这个组件，用于制作背景线条图案。您应该添加到您的项目[react-native-svg](https://github.com/react-native-community/react-native-svg)

```
import PropTypes from 'prop-types';
import React, { PureComponent } from "react";
import { View } from "react-native";
import Svg, { Defs, Line, Pattern, Rect } from 'react-native-svg';

export default class PatternLineView extends PureComponent {

  static propTypes = {
    pattern: PropTypes.func.isRequired,
    space: PropTypes.number,
    backgroundColor: PropTypes.string,
    lineColor: PropTypes.string,
    lineWidth: PropTypes.number,
    rotation: PropTypes.number
  }

  static defaultProps = {
    pattern: () => { },
    space: 8,
    lineColor: "#D2D9E5",
    lineWidth: 3,
    rotation: 45
  }

  render() {
    const transform = `rotate(${this.props.rotation})`
    return <View style={{
      flex: 1,
      flexDirection: "row",
      height: "100%",
      width: "100%",
      position: "absolute",
      top: 0,
      start: 0,
      backgroundColor: this.props.backgroundColor
    }}>
      <Svg width="100%" height="100%">
        <Defs>
          <Pattern
            id="linePattern"
            patternUnits="userSpaceOnUse"
            patternTransform={transform}
            width={this.props.space}
            height={this.props.space}>
            <Line
              x1="0"
              y1="0"
              x2="0"
              y2="100%"
              stroke={this.props.lineColor}
              strokeWidth={this.props.lineWidth}
            />
          </Pattern>
        </Defs>

        <Rect
          fill="url(#linePattern)"
          x="0"
          y="0"
          width="100%"
          height="100%"
        />
      </Svg>
    </View>
  }
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-10-30T06:22:28.357

我在这里改编了[Ingo 的](https://stackoverflow.com/users/936832/ingo-kegel) [答案](https://stackoverflow.com/a/14500054/8915430)。

```
<defs>
    <pattern id="diagonalHatch" patternUnits="userSpaceOnUse" width="4" height="4">
        <!-- background -->
        <path id="background"
            d="M-1,3 L3,-1
               M1,5 L5,1" style="stroke:pink; stroke-width:10" />
        <!-- hatches -->
        <path id="hatches"
            d="M-2,2 L2,-2
               M0,4 L4,0
               M2,6 L6,2" style="stroke:red; stroke-width:1" />
    </pattern>
</defs> 
```

此图案包括两条路径，一条用于背景，另一条用于影线。背景颜色与 JS 相比是可寻址的，例如：

`const hatchPath = document.querySelector("path#hatches");`

`hatchPath.setAttribute('style', "stroke:blue; stroke-width:1")`

背景路径故意过宽，因此图案的任何部分都至少没有被背景覆盖。同时，可以调整舱口的宽度以改变线条的粗细。

# android - Galaxy S Blaze 4G 无法在 Linux 上使用 adb

> ID：13069449
> 
> 赞同：0
> 
> 时间：2012-10-25T13:16:11.890
> 
> 标签：android, linux, usb, adb, galaxy

我无法让我的三星 Galaxy S Blaze 4G 在 Ubuntu 12.04 上与 adb 一起使用。当我什么都不做时`adb devices`列出。

我在 dmesg 中有一条消息，例如：“usb 无法设置配置 #1，错误 -71”（有时我也收到“错误 -110”）

我将它移到了各种 USB 端口，既内置在主板中，也通过 PCI USB 2.0 卡，但没有成功。

我有一个`/etc/udev/rules.d/51-android.rules`我创建的，运行以下命令，拔下并重新插入手机上的 USB 电缆：

```
sudo services udev restart
adb kill-server
adb start-server 
```

如果我运行，`lsusb`我会看到列出的设备，手机在通知区域有 USB 图标，并且在开发人员选项中设置了 USB 调试。

当我有 2.3.3 固件时它曾经可以工作，但我最近升级到 ICS 4.0.4。而且我还在我购买的新 SSD 上重新安装了 Ubuntu，但 /home 没有改变，并且在我现有的 HDD 上。

关于现在出了什么问题以及如何解决它的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T02:45:23.540

对于其他看到此问题的人... USB 电缆原来是罪魁祸首。

# java - String Tokenizer 改变分隔符，不显示

> ID：13069450
> 
> 赞同：2
> 
> 时间：2012-10-25T13:16:12.093
> 
> 标签：java, delimiter, stringtokenizer

我需要拆分一个字符串“Kermit D.Frogge”，所以这是我使用的代码：

```
firstName = strTkn.nextToken();
middleInitial = strTkn.nextToken("."); 
//changing the delimiters to a . because there is no space between D and Frogge
lastName = strTkn.nextToken(" "); 
//changing delimiters back to a space
hourlyWage = Double.parseDouble(strTkn.nextToken()); 
```

然而，结果是：

```
Kermit
D
.Frogge 
```

我将如何使用字符串标记器而不保留句点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T13:19:14.310

使用带有两个参数的构造函数。第二个参数是一个字符串，其字符是分隔符。

```
StringTokenizer st = new StringTokenizer(string, " ."); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T13:19:26.340

一种可能的解决方案

```
strTkn.replace("."," ");
String[] name=strTkn.split(" "); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T13:36:32.180

应该使用在中间标记上设置的分隔符

```
String middleInitial = strTkn.nextToken(" ."); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T13:22:47.657

如果他的名字是“Kermit D. Frogge”（注意中间名首字母和姓氏之间的空格），那么他的名字将是“Kermit”，他的中间名首字母将是“D.”，而他的姓氏将是“青蛙”。

然后，您可以使用该[`replaceAll()`方法](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/String.html#replaceAll%28java.lang.String,%20java.lang.String%29)摆脱“。”。

# python - 我可以在 Dock 中不出现 Python 图标的情况下创建 wxPython 托盘图标应用程序吗？

> ID：13069452
> 
> 赞同：2
> 
> 时间：2012-10-25T13:16:18.903
> 
> 标签：python, macos, wxpython, system-tray

这是我在 SO 上找到的示例托盘图标应用程序的稍微修改的源代码：

```
import wx

TRAY_TOOLTIP = 'System Tray Demo'
TRAY_ICON = 'icon.png'

def create_menu_item(menu, label, func):
    item = wx.MenuItem(menu, -1, label)
    menu.Bind(wx.EVT_MENU, func, id=item.GetId())
    menu.AppendItem(item)
    return item

class TaskBarIcon(wx.TaskBarIcon):
    def __init__(self):
        super(TaskBarIcon, self).__init__()
        self.set_icon(TRAY_ICON)
        self.Bind(wx.EVT_TASKBAR_LEFT_DOWN, self.on_left_down)
    def CreatePopupMenu(self):
        menu = wx.Menu()
        create_menu_item(menu, 'Say Hello', self.on_hello)
        menu.AppendSeparator()
        create_menu_item(menu, 'Exit', self.on_exit)
        return menu
    def set_icon(self, path):
        icon = wx.IconFromBitmap(wx.Bitmap(path))
        self.SetIcon(icon, TRAY_TOOLTIP)
    def on_left_down(self, event):
        print 'Tray icon was left-clicked.'
    def on_hello(self, event):
        print 'Hello, world!'
    def on_exit(self, event):
        wx.CallAfter(self.Destroy)

class App(wx.App):
    def OnInit(self):
        self.SetTopWindow(wx.Frame(None, -1))
        TaskBarIcon()

        return True

def main():
    app = App()
    app.MainLoop()

if __name__ == '__main__':
    main() 
```

它成功显示了一个托盘图标，并且确实没有显示任何框架，但它确实在 Dock 中显示了 Python 图标。我假设它还会在 Windows 任务栏中显示一个 Python 图标。我该如何阻止这种情况发生？

*我在 OSX Mountain Lion 上的 Python 2.7 上使用 wxPython 2.9*

* * *

![在此处输入图像描述](../Images/8d82841034a5d417e2e07e0c1e635d33.png)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-10T21:43:23.577

您应该从您的应用程序创建一个包，并告诉指定您的应用程序是一种“背景”，因此它不应在停靠栏中显示图标。

为此，您必须将属性跟踪到您的捆绑属性文件 (Info.plist)。

```
<key>LSUIElement</key>
<string>1</string> 
```

请参阅以下文章：

*   如何创建应用程序包：[构建 OSX 应用程序包](https://stackoverflow.com/questions/1596945/building-osx-app-bundle)
*   如何从“码头”隐藏应用程序：http: [//www.macosxtips.co.uk/index_files/disable-the-dock-icon-for-any-application.php](http://www.macosxtips.co.uk/index_files/disable-the-dock-icon-for-any-application.php)

*   Apple 关于应用程序启动属性的参考：http: [//developer.apple.com/library/ios/#documentation/general/Reference/InfoPlistKeyReference/Articles/LaunchServicesKeys.html](http://developer.apple.com/library/ios/#documentation/general/Reference/InfoPlistKeyReference/Articles/LaunchServicesKeys.html)

# android - View 方法的 Context 参数何时不等同于 .getContext()

> ID：13069467
> 
> 赞同：2
> 
> 时间：2012-10-25T13:17:01.780
> 
> 标签：android

如果您能够调用 view.getContext() 来返回当前正在渲染视图实例的 Activity 的上下文，为什么某些 View 系列方法将 Context 作为参数？

这可能不是隐含的，或者当 getContext() 与传递给这些方法之一的 Context 不同时，是否存在这种情况？

这是一个例子： http: [//developer.android.com/reference/android/widget/ViewAnimator.html#setInAnimation(android.content.Context, int)](http://developer.android.com/reference/android/widget/ViewAnimator.html#setInAnimation%28android.content.Context,%20int%29)

非常感谢您解决这个问题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T13:25:14.113

`view.getContext()`实际上返回的是您的**Activity**的上下文，而不是应用程序的上下文。这就是初始化新视图时需要提供此类上下文的原因。

这两种情况之间存在差异。活动的上下文附加到该特定活动的生命周期。但是，应用程序的上下文是指应用程序的生命周期。

有关更多信息，请阅读[此](https://stackoverflow.com/questions/10347184/difference-and-when-to-use-getapplication-getapplicationcontext-getbasecon/10347346#10347346)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T13:37:09.497

我最近阅读了一些返回的 API [`IBinder`](http://developer.android.com/reference/android/os/IBinder.html)，例如[`getWindowToken()`](http://developer.android.com/reference/android/view/View.html#getWindowToken%28%29)and [`getApplicationWindowToken()`](http://developer.android.com/reference/android/view/View.html#getApplicationWindowToken%28%29)。引用后者：

> 检索标识此视图所附加到的窗口的顶级“真实”窗口的唯一标记。也就是说，这类似于 getWindowToken()，除非此视图所在的窗口是面板窗口（附加到另一个包含窗口），否则将返回包含窗口的令牌。

可能这个IPC机制和`View`API有关系。Android 设计者既不愚蠢也不热心：如果他们需要 a`Context`来构建 a `View`，这意味着 a`Context`就是他们所需要的，因此`View`必须使用应用程序上下文、服务上下文和 - 当然！ - 活动上下文来构建 a ，但是**不需要活动**。这`Context`只是一个用于检索资源、访问数据库、构建意图等的综合 API。

这不是您问题的答案，但也许可以作为帮助点。我自己在寻找答案。希望您的问题得到应有的关注。

# windows-phone-7 - 如何动态旋转页面

> ID：13069471
> 
> 赞同：1
> 
> 时间：2012-10-25T13:17:09.347
> 
> 标签：windows-phone-7, pivot

我需要考虑三个级别的列表来创建一个枢纽项目：

```
public class Value
{
    private DateTime DayMonth;
    private float value;
    private float variation;

    [...]
}

public class Element 
{
    private String description;
    private List<Value> values;
    private List<Element> elements;

    [...]
}

public class User 
{
    private String name;
    private List<Element> elements;

    [...]
} 
```

我需要为每个元素的每个不同 Value.DayMonth 制作数据透视页。因此，当我可视化数据时，我可以看到每个元素的值 e 变化，如果我想查看一个月中另一天的这些指标，我只需转到下一页。

# objective-c - 何时使用 Bound 以及何时使用 Frame

> ID：13069474
> 
> 赞同：4
> 
> 时间：2012-10-25T13:17:19.753
> 
> 标签：objective-c, cocoa-touch, frame, bounds

我发现

UIView 的边界是矩形，表示为相对于其自身坐标系 (0,0) 的位置 (x,y) 和大小 (width,height)。

UIView 的 frame 是一个矩形，表示为相对于它所在的 superview 的位置 (x,y) 和大小 (width,height)。

但我的疑问是在哪种情况下我会有使用范围。我们不能在中使用框架吗

所有的情况？是否需要使用 bound ？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-25T13:22:18.520

从[查看编程指南](http://developer.apple.com/library/ios/#documentation/WindowsViews/Conceptual/ViewPG_iPhoneOS/WindowsandViews/WindowsandViews.html#//apple_ref/doc/uid/TP40009503-CH2-SW5)：

*   **frame**属性包含框架矩形，它指定视图在其父视图坐标系中的大小和位置。
*   **bounds**属性包含边界矩形，它指定视图在视图自己的本地坐标系中的大小（及其内容原点）。

框架：

> 您主要使用 center 和 frame 属性来操作当前视图的几何图形。例如，您在构建视图层次结构或在运行时更改视图的位置或大小时使用这些属性。如果您只更改视图的位置（而不是其大小），则 center 属性是这样做的首选方式。center 属性中的值始终有效，即使缩放或旋转因子已添加到视图的变换中。frame 属性中的值也不是这样，如果视图的变换不等于恒等变换，则认为该值无效。

界限：

> **您主要在绘图期间使用 bounds 属性**。边界矩形在视图自己的局部坐标系中表示。这个矩形的默认原点是 (0, 0)，它的大小与框架矩形的大小相匹配。您在此矩形内绘制的任何内容都是视图可见内容的一部分。如果更改边界矩形的原点，则在新矩形内绘制的任何内容都将成为视图可见内容的一部分。

**因此，您对框架**执行以下操作：

*   调整视图大小
*   移动/重新定位视图

应该使用**bounds 的**情况：

*   当您在具有边界的视图内绘制时，例如`drawRect:`在`UIView`.
*   将子视图添加到父视图边界

# mysql - 查找列中最常见的条目 - SQL

> ID：13069484
> 
> 赞同：2
> 
> 时间：2012-10-25T13:17:59.323
> 
> 标签：mysql, sql

我有一个像这样的名为 MyTable 的表

```
A    B
101  Dog
209  Cat
209  Cat
209  Dog
193  Cow
193  Dog
101  Dog
193  Dog
193  Cow 
```

我想`B`为每个人提取最常见的，`A`所以它最终会是这样的（注意可能有联系）

```
 A    B
    101  Dog
    209  Cat
    193  Dog
    193  Cow 
```

我怎么能写 sql 来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T13:19:11.657

或者，您可以使用`HAVING`从句代替`JOIN`.

```
SELECT A, B
FROM table1 o
GROUP BY A, B
HAVING COUNT(*) = 
    (
        SELECT MAX(totalCOunt)
        FROM
        (
            SELECT A, B, COUNT(*) totalCount
            FROM table1
            GROUP BY A,B
        ) x
        WHERE o.A = x.A 
        GROUP BY x.A
    ) 
```

# [SQLFiddle 演示](http://sqlfiddle.com/#!2/19df7/18)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T13:24:10.123

您可以使用过滤连接列出`(A,B)`具有最高行数的组合：

```
select  src.*
from    (
        select  A
        ,       B
        ,       count(*) cnt
        from    YourTable
        group by
                A
        ,       B
        ) src
join    (
        select  A
        ,       max(cnt) as maxcnt
        from    (
                select  A
                ,       B
                ,       count(*) cnt
                from    YourTable
                group by
                        A
                ,       B
                ) comb
        group by
                A
        ) maxab
on      maxab.A = src.A
        and maxab.maxcnt = src.cnt 
```

[SQL Fiddle 的示例。](http://sqlfiddle.com/#!6/bb92f/8/0)

如果您的数据库支持窗口函数，您可以使用`dense_rank()`，例如：

```
select  *
from    (
        select  dense_rank() over (
                    partition by A
                    order by cnt desc) as rn
        ,       *
        from    (
                select  A
                ,       B
                ,       count(*) cnt
                from    YourTable
                group by
                        A
                ,       B
                ) t1
        ) t2
where   rn = 1 
```

[SQL Fiddle 的窗口函数示例。](http://sqlfiddle.com/#!6/bb92f/11/0) 窗口函数在 SQL Server、Oracle 和 PostgeSQL 的最新版本中可用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-25T13:24:16.580

```
select g3.A,g3.B
from
(
    select A,Max(C) MC
    from
    (
        select A,B,count(*) C
        from (<your entire select query>) tbl
        group by A,B
    ) g1
    group by A
) g2
join
(
    select A,B,count(*) C
    from (<your entire select query>) tbl
    group by A,B
) g3 on g2.A=G3.A and g3.C=g2.MaxC 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-25T13:41:22.680

[**SQL FIDDLE 示例**](http://sqlfiddle.com/#!3/d4f97/7)

```
select
    A, B
from
(
  select
      A, B, row_number() over (partition by A order by cnt desc) as RowNum
  from
  (
    select
       T.A, T.B, count(*) over (partition by T.A, T.B) as cnt
    from T
  ) as A
) as B
where RowNum = 1 
```

# php - jQuery发送表单未在firebug中显示

> ID：13069487
> 
> 赞同：0
> 
> 时间：2012-10-25T13:18:06.220
> 
> 标签：php, jquery, ajax, request, firebug

我想知道是否可以发送`ajax`数据并防止将其登录到 FireBug 等工具中。

我这样发送我的数据：

```
$("#submit").click(function() {
    var value = $("#value");
    var valuePost = value.val(); 
    $.post("submit.php", {value: valuePost},
    function(data){} 
    , "html");
}); 
```

但是当它被发送时，像 FireBug 这样的工具会捕获这些数据。我不希望那样，因为我正在发送密码。有什么方法可以防止像 FireBug 这样的工具捕获发送数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T13:56:58.433

把它作为一个答案：

当您从网页发送数据时，FireBug 等工具将始终能够捕获发送的内容。当您不使用`https`(SSL) 之类的加密时，FireBug 会显示数据的发送方式。

如果您确实使用了类似的加密`https`，那么 FireBUg 仍然能够以可读格式捕获并显示将要发送的数据。但你不必担心这一点。FireBug 只是一个“本地”工具来帮助你。所以你可以看到那个网页上发生了什么。当数据实际发送（通过互联网）时，它将被加密。

Nnyone 嗅探您的网络将看到加密数据，而不是您在 FireBug 中看到的数据。

所以不要担心像 FireBug 这样的工具。那只是为了帮助您（作为本地用户）。如果您想通过 Internet 发送重要数据（例如密码等），只需使用 SSL。

# android - 如何从 listView 中获取选定的项目

> ID：13069492
> 
> 赞同：-1
> 
> 时间：2012-10-25T13:18:25.990
> 
> 标签：android, listview, checkbox, cursor

我正在尝试找到一种将复选框添加到 ListView 布局的方法，该布局可用于允许用户选择要处理的项目。列表视图通过 SimpleCursorAdapter 使用游标填充。任何人都可以指出描述如何做这样事情的文档的方向。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T13:27:14.063

You need to manage the selected items in the listview in the getView method manually. At last you will get the selected items. use Arraylist or hashmap as per your need and comfort.

Hope it will help you.

Also refer these links:

[Android ListView with Checkboxes: How to capture checked items?](https://stackoverflow.com/questions/5557169/android-listview-with-checkboxes-how-to-capture-checked-items)

[Android ListView](http://developer.android.com/reference/android/widget/ListView.html)

[Adding CheckBoxes to a Custom ListView in Android](http://androidcocktail.blogspot.in/2012/04/adding-checkboxes-to-custom-listview-in.html)

[how to display all checked items from multiple choice listview](https://groups.google.com/forum/?fromgroups=#!topic/android-developers/cvZbSri07KA)

# cocoa-touch - 下拉列表对象，如 HTML“选择”标签

> ID：13069497
> 
> 赞同：2
> 
> 时间：2012-10-25T13:18:38.123
> 
> 标签：cocoa-touch, user-interface

`<select>`是否有任何库包含一个对象来为我的 iPhone 应用程序创建一个下拉列表（如 HTML ）？我有一个数组中的所有值，并希望允许用户选择一个。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T13:20:45.140

我将从查看[`UIPickerView`](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIPickerView_Class/Reference/UIPickerView.html)类参考和文档开始。OSX 文档中也有示例项目的链接。

有关UIPickerView 外观的示例，请参阅[此答案。](https://stackoverflow.com/questions/1262574/add-uipickerview-a-button-in-action-sheet-how)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T14:25:49.943

你可以看看这个 github 项目（免责声明：我写的）：[https](https://github.com/daschae/Nine90) ://github.com/daschae/Nine90 。选择控件尝试提供与移动 Safari 相同的体验。它对我很有帮助，我愿意接受有关它是否适合您的目的的反馈。

# objective-c - 在 MPMoviePlayerController 中禁用用户交互

> ID：13069502
> 
> 赞同：2
> 
> 时间：2012-10-25T13:18:51.877
> 
> 标签：objective-c, ios, mpmovieplayercontroller, mpmovieplayer

`MPMovieControlStyleNone`我需要在播放小视频期间禁用全部用户交互，我已经尝试将控件的样式设置为`UIView`无`MPMoviePlayerController`我关闭了视频，但它仍在后台播放，而且用户交互被禁用。以下是我的做法：

```
-(IBAction)startGame:(id)sender
{
    NSURL * url = [NSURL fileURLWithPath:[[NSBundle mainBundle] pathForResource:@"Teste" ofType:@"m4v"]];
    moviePlayer = [[MPMoviePlayerController alloc] initWithContentURL:url];

    [[NSNotificationCenter defaultCenter] addObserver:self
                                             selector:@selector(moviePlayBackDidFinish:)
                                                 name:MPMoviePlayerPlaybackDidFinishNotification
                                               object:moviePlayer];

    moviePlayer.controlStyle = MPMovieControlStyleNone;
    moviePlayer.shouldAutoplay = YES;
    [self.view addSubview:moviePlayer.view];
    [moviePlayer setFullscreen:YES animated:YES];

    mBlankView = [[UIView alloc] initWithFrame:moviePlayer.view.frame];
    mBlankView.userInteractionEnabled = NO;
    [mBlankView setMultipleTouchEnabled:NO];
    [mBlankView setBackgroundColor:[UIColor clearColor]];
    [self.view addSubview:mBlankView];
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T13:24:51.593

To disable Movieplayer control completely u need to disable your movieplayers view userinteraction as follows:

```
moviePlayer.view.userInteractionEnabled = NO; 
```

# python - 为什么循环覆盖我的文件而不是在文本之后写入？

> ID：13069508
> 
> 赞同：1
> 
> 时间：2012-10-25T13:19:17.490
> 
> 标签：python

```
i = 1 # keep track of file number
directory = '/some/directory/'

for i in range(1, 5170): #number of files in directory
    filename = directory + 'D' + str(i) + '.txt'
    input = open(filename)
    output = open('output.txt', 'w')
    input.readline() #ignore first line
    for g in range(0, 7): #write next seven lines to output.txt
        output.write(input.readline())

    output.write('\n') #add newline to avoid mess
    output.close()
    input.close()
    i = i + 1 
```

我有这段代码，我正在尝试获取一个文件并将其重写为 output.txt，但是当我想附加下一个文件时，我的代码会覆盖已附加的旧文件。结果当代码完成时，我有这样的东西：

```
dataA[5169]=26
dataB[5169]=0
dataC[5169]=y
dataD[5169]='something'
dataE[5169]=x
data_date[5169]=2012.06.02
```

而不是从文件 0 到 5169 的数据。任何提示如何修复它？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-25T13:20:49.437

您可能希望在for 循环`output.txt` *之前*`close`打开（以及之后）。正如它所写的那样，`output.txt`每次打开文件时都会覆盖它。（另一种方法是打开附加： `output = open('output.txt','a')`，但这绝对不是最好的方法......

当然，现在最好使用上下文管理器（`with`语句）：

```
i = 1 # keep track of file number <-- This line is useless in the code you posted
directory = '/some/directory/'  #<-- os.path.join is better for this stuff.
with open('output.txt','w') as output:

    for i in range(1, 5170): #number of files in directory
        filename = directory + 'D' + str(i) + '.txt'
        with open(filename) as input:

            input.readline() #ignore first line
            for g in range(0, 7): #write next seven lines to output.txt
                output.write(input.readline())

            output.write('\n') #add newline to avoid mess
        i = i + 1   #<---also useless line in the code you posted 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T13:22:20.637

您的问题是您以写入模式打开。要附加到您要使用附加的文件。见[这里](https://stackoverflow.com/questions/4706499/how-do-you-append-to-file-in-python)。

# c# - 显示 Spotify 专辑封面网页

> ID：13069510
> 
> 赞同：0
> 
> 时间：2012-10-25T13:19:24.763
> 
> 标签：c#, asp.net, web-applications, spotify

我有一个 ASP.NET 网站，用户可以在其中搜索 Spotify 上的专辑或艺术家。搜索结果需要显示专辑/艺术家及其相关艺术品，如专辑封面。

正如 [此处][1] 所讨论的，使用 Spotify 的 Web API 似乎无法做到这一点

这可以使用 LibSpotify API 吗？还是有其他方法可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T13:50:07.870

是的，libspotify 允许您获取专辑和艺术家的封面艺术（尽管很多艺术家没有图像）。获得图像后，您可以将其传递给您的应用程序以在 Web 上显示。

# java - 在 JAVA 中增加 https 安全性的用例

> ID：13069514
> 
> 赞同：0
> 
> 时间：2012-10-25T13:19:34.443
> 
> 标签：java, ssl, https

我正在编写一个应用程序，该应用程序应确保两方之间的安全连接（称它们为客户端和服务器）。

服务器应限制哪些客户端可以使用 https 进行连接。为此，服务器将颁发一定数量的证书，当客户端尝试连接时将对其进行检查。如果客户端使用的证书不在受信任列表中，则无法建立连接。

此证书应使用某种 USB 设备分发。因此，当使用我的应用程序的客户端尝试使用 https 从服务器获取某些内容时，应用程序应该从 USB 设备读取该证书并使用它来建立 https 连接。私钥应始终在设备上保密。

到目前为止，我设法在客户端和服务器 (JKS) 上创建本地密钥库，将它们添加到彼此的受信任列表中，并使用它们来实现正确的连接。

我的问题是：客户端证书是否可以由服务器颁发并传输到客户端，以及 https 连接所需的私钥？我不希望在客户端计算机上创建任何数据或密钥库，建立 https 连接所需的一切都应该在该设备上。设备可以有一些程序和 api 来帮助这个过程并确保私钥的保密性。

任何帮助将不胜感激 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T13:43:19.710

如果您不信任客户端来保护他们的凭据，那么用于身份验证的普通客户端证书方法效果不佳 - 这似乎是您的情况。

将证书放在 USB 设备上可使其远离客户端计算机的磁盘，但不会阻止客户端用户访问它并将其分发给其他人。另一方面，它降低了第 3 方从“静止”的客户端计算机窃取证书的风险——但前提是客户端正确保护了 USB 密钥。因此，您需要清楚您要防御哪些威胁，以及您信任谁。

使客户端用户的证书完全“私有”的唯一方法是将其放在某种防篡改设备上，并使用在身份验证期间不将证书传输到客户端计算机的方法。

将您的方法与用于网上银行的方法进行比较，在这些方法中，向客户发放可以使用银行卡和 PIN（双因素身份验证）进行质询响应的设备。卡的详细信息不受卡芯片的随意攻击；但是系统假设客户会照看他们的卡和 PIN，并及时报告盗窃（因为这是他们的钱有风险！）。如果客户没有动力去照看凭证，那么这种方法就没有意义。

如果您只想确保客户端具有不可共享的令牌，您可以考虑使用[SecurID](http://en.wikipedia.org/wiki/SecurID)设备或类似设备，它们是您问题的现成解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T13:56:14.930

> 客户端证书是否可以由服务器颁发并传输到客户端，以及 https 连接所需的私钥？

从技术上讲，他们可以，但如果您想确保私钥仅到达其预期用户，您将不得不通过其他方式对该连接进行身份验证。就您的整体方案而言，这并没有真正的帮助。此外，通过将私钥作为数据发送给客户端，他们可能能够以一种或另一种方式提取它。

如果您可以物理发送 USB 设备，则可以使用支持[PKCS#11](http://en.wikipedia.org/wiki/PKCS_%E2%99%AF11)的硬件加密令牌。此类令牌往往具有以无法提取的方式存储私钥的选项（它只能与设备一起使用）。它们倾向于以各种形式出现：作为智能卡（在这种情况下您需要读卡器）或作为 USB 令牌（它看起来像记忆棒，但事实并非如此）。根据型号的不同，USB 令牌实际上可以是带有嵌入式读卡器的智能卡。

Java 支持[PKCS#11 密钥库](http://docs.oracle.com/javase/7/docs/technotes/guides/security/p11guide.html)，因此如果此令牌带有 PKCS#11 驱动程序/库，则可以从 Java 中使用它。

# sharepoint - MOSS 2007 Powershell 运行 Report Builder Reports RDL

> ID：13069517
> 
> 赞同：2
> 
> 时间：2012-10-25T13:19:45.010
> 
> 标签：sharepoint, powershell, reporting-services, report, rdl

MOSS 2007：客户拥有在报表生成器和 SharePoint 中创建的报表库。这些“.RDL”文件存储在报告库​​内的特定文件夹中。

是否有允许这样做的 powershell 命令？

1.  给定一个特定的报告库

2.  对于库中的每个报告定义“RDL”

3.  如果报表定义上次运行失败，或者上次成功运行超过 X 天前

4.  对于 RDL 中的每个订阅

5.  运行订阅一次

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T21:33:53.413

可以遍历您想要的内容，但订阅运行的实际控制是通过 SQL 代理作业发生的。

因此，虽然您可以轻松地[迭代 SharePoint 文档库并](https://sharepoint.stackexchange.com/questions/3371/traverse-through-list-of-documents-using-powershell)[通过 Reporting Services Web 服务列出订阅](http://technet.microsoft.com/en-us/library/reportservice2010.reportingservice2010.listsubscriptions%28v=sql.105%29.aspx)（我将从尝试通过 powershell 调用它[开始](https://stackoverflow.com/questions/2022678/how-to-access-a-web-service-from-powershell)），但您将无法操作 SQL 代理作业。

您可以通过创建存储过程并[直接从 SQL Server 重新运行任何失败的作业](http://social.msdn.microsoft.com/Forums/en-US/sqlreportingservices/thread/8d548814-88c7-4190-b6ee-0d76f584425c/)来获得更好的效果。

# php - 如何从 joomla 2.5 文章中下载 .vcf 文件？

> ID：13069518
> 
> 赞同：0
> 
> 时间：2012-10-25T13:19:46.173
> 
> 标签：php

我有一篇 joomla 文章，其中包含姓名、电子邮件 ID、联系方式。我想将其下载为 vcard 或 vcf 文件。是否可以从 joomla 2.5 文章中下载 vcf 文件

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T14:13:40.070

Joomlas“联系人”组件已经包含管理联系人和将联系人详细信息下载为 vCard 的功能。您可以在文章中链接到该联系人。必须在 Components->Contact 和 Options-Button 中启用 vCard 功能，因为默认情况下这是隐藏的。

# node.js - 在 NodeJS 中修改 HTML 文件

> ID：13069522
> 
> 赞同：7
> 
> 时间：2012-10-25T13:19:58.397
> 
> 标签：node.js

让我先说两件事。我目前正在使用 grunt 来完成这些任务，而且我也知道 Yeoman 有我想要的东西。我真的很喜欢 Yeoman，但是对于我正在从事的这个特定项目来说，这有点太固执了。

所以我有以下 HTML 文件：

```
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">

        <!-- START-CSS-MIN:css/build/min.css -->
        <link rel="stylesheet" href="css/bootstrap/bootstrap-2.1.1.css">
        <link rel="stylesheet" href="css/normalize.css">
        <link rel="stylesheet" href="css/boilerplate.css">
        <!-- END-CSS-MIN -->

        <!-- START-JS-MIN:js/build/modernizr.js -->
        <script src="js/libraries/modernizr.js"></script>
        <!-- END-JS-MIN -->
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an outdated browser. <a href="http://browsehappy.com/">Upgrade your browser today</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to better experience this site.</p>
        <![endif]-->

        <p>Hello world! This is a basline HTML5 template (based on HTML5 Boilerplate).</p>

        <!-- START-JS-MIN:js/build/libraries.js -->
        <script src="js/libraries/underscore.js"></script>
        <script src="js/libraries/jquery/jquery.js"></script>
        <!-- END-JS-MIN -->
    </body>
</html> 
```

现在您可以看到 CSS-MIN 和 JS-MIN 注释。现在我已经有一个自定义的 grunt 构建任务，它可以正确地收集评论中的所有这些文件（使用 htmlparser），然后直接根据评论缩小和连接它们。构建过程的最后一步是创建该 HTML 文件的新版本（用于生产用途），用新文件替换注释。例如，上面的代码会变成这样：

```
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">

        <link rel="stylesheet" href="css/build/min.css">

        <script src="js/build/modernizr.js"></script>
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an outdated browser. <a href="http://browsehappy.com/">Upgrade your browser today</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to better experience this site.</p>
        <![endif]-->

        <p>Hello world! This is a basline HTML5 template (based on HTML5 Boilerplate).</p>

        <script src="js/build/libraries.js"></script>
    </body>
</html> 
```

我的问题是如何在 NodeJS 中做到这一点？htmlparser NPM 模块非常适合解析 HTML，但是我现在需要一些东西来修改 HTML（在特定位置删除和添加某些元素）。有没有关于如何在 NodeJS 代码中执行此操作的好的包/教程？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T17:42:59.783

我不太确定这是否对注释行有帮助，但这应该比 DOM 参考更容易解决。

考虑使用：[https ://github.com/tmpvar/jsdom](https://github.com/tmpvar/jsdom)

还有其他选择。（https://github.com/joyent/node/wiki/modules）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-03-18T11:32:36.703

你可以用[cheerio](https://www.npmjs.com/package/cheerio)

以下代码将准确生成您提供的输出（除了一些小的空白差异）

```
const $ = require('cheerio').load(inputHtml);

// Returns a filter function that selects the comments with the provided indexes
const commentRemovalFilter = (commentIndexes)=>{
    let commentIndex=-1;
    return (index, node)=>{
        const isComment = node.type === 'comment';
        if(isComment)commentIndex++;
        return isComment && commentIndexes.includes(commentIndex);
    }
}

$('head').contents().filter(commentRemovalFilter([0,1,2,3])).remove();
$('head link').remove();
$('head script').remove();

//Cheerio respects whitespace provided here
$('head').append(`
        <link rel="stylesheet" href="css/build/min.css">

        <script src="js/build/modernizr.js"></script>
`)

$('body').contents().filter(commentRemovalFilter([1,2])).remove();
$('body script').remove();
$('body').append(`      <script src="js/build/libraries.js"></script>
`)

console.log($.html()) 
```

**输出：**

```
<html><head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">

        <link rel="stylesheet" href="css/build/min.css">

        <script src="js/build/modernizr.js"></script>
</head>
    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an outdated browser. <a href="http://browsehappy.com/">Upgrade your browser today</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to better experience this site.</p>
        <![endif]-->

        <p>Hello world! This is a basline HTML5 template (based on HTML5 Boilerplate).</p>

      <script src="js/build/libraries.js"></script>
</body></html> 
```

# php - 提交表单和存储在数据库中的 PHP 问题，小问题给我带来了冲突

> ID：13069523
> 
> 赞同：0
> 
> 时间：2012-10-25T13:19:58.553
> 
> 标签：php, html, mysql

我正在尝试将通过表单发送的信息存储到 MySQL 数据库中。它不加载下一页也不存储信息。

我的标头需要 init.php，我可以确认它具有正确的数据库连接凭据。

以下是我的 HTML 和“上传器”脚本 - 我知道它一定很愚蠢，但这就是问题所在，在 html 和/或 uploader.php 中。

如果有人可以运行我的代码并指出每个问题（并且可能是我的代码的返工），那将非常感激！谢谢！！

**HTML** *（我减少了出生日期选项，所以这里的代码更少）*

```
 <h2>Choose Your File</h2>
                 <form id="submit-photo" action="index.php?p=uploader" enctype="multipart/form-data" method="POST">

    <input type="hidden" name="MAX_FILE_SIZE" value="5242880" />   
            <div id="FileUpload">

                <input type="file" name="photo" id="BrowserHidden" onchange="getElementById('FileField').value = getElementById('BrowserHidden').value;" />

                <div id="BrowserVisible"><input type="text" id="FileField" /></div>
            <span class="error"><?php if(isset($_SESSION['flash_message']['photo'])) echo $_SESSION['flash_message']['photo'] ?>
            </span></div>               

            <fieldset>
                <label for="name">Name</label>
                <input type="text" name="name" id="name">
            </fieldset>

            <fieldset>
            <label for="dob">DOB</label>
            <div class="dob-select">
            <select name="dob_day" id="dob_day">
            <option value="01">01</option>
            <option value="02">02</option>
            <option value="03">03</option>
            <option value="04">04</option>
            <option value="05">05</option>
            </select>
            </div>
            <div class="dob-select">
            <select name="dob_month" id="dob_month">
            <option value="01">Jan</option>
            <option value="02">Feb</option>
            <option value="03">Mar</option>
            <option value="04">Apr</option>
            </select>
            </div>
            <div class="dob-select">
            <select name="dob_year" id="dob_year">
            <option value="2012">2012</option>
            <option value="2011">2011</option>
            <option value="2010">2010</option>
            </select>
            </div>
            </fieldset>

            <fieldset>
                <label for="postcode">Postcode</label>
                <input type="text" class="short" name="postcode" id="postcode">
            </fieldset>

            <fieldset>
                <label for="email">Email</label>
                <input type="email" name="email" id="email">
            </fieldset>

            <fieldset>                
                <label for="subscribe"><input type="checkbox" class="left" id="subscribe"> <p class="left">subscribe</p></label>
                <input type="submit" name="submit">
            </fieldset>       
        </form> 
```

**数据库列**

*   id *（自动递增）*
*   姓名
*   照片*（文件路径）*
*   电子邮件
*   日期*（出生日期：日、月、年组合起来形成这个）*
*   邮政编码
*   订阅*（应该是 0 或 1）*
*   批准
*   创建*（时间戳）*

![数据库](../Images/ed6777dd78933d1c270405e062264846.png)

**上传器 PHP**

```
<?php $error = array();
require_once 'init.php';
//Is request?
if(strtolower($_SERVER['REQUEST_METHOD']) == 'post') {

    //$friend = ( $_POST['friend'] == 'true' ) ? 1 : 0;

    $required_array = array(
        'name' => 'Name',
        'dob_day' => 'Day',
        'dob_month' => 'Month',
        'dob_year' => 'Year',
        'postcode' => 'Postcode',
        'email' => 'Email Address',
        'subscribe' => 'subscribe'
    );
    $required_error = array();
    foreach( $required_array as $field_name => $field ) {
        if(!isset($_POST[$field_name]) OR empty($_POST[$field_name]) OR $_POST[$field_name] == '') {
            $required_error[$field_name] = 'Please insert your '. $field;
        }
    }

    $_POST['email'] = verify_email($_POST['email']);
    if($_POST['email'] == FALSE && !isset($error['email']))
        $error['email'] = 'Please use a valid email address';

    //Validate the form key
    if(!isset($_POST['form_key']) || !$formKey->validate()) {
        //Form key is invalid, show an error
        $error['general'] = 'Use the real form!';
    } else {
        if((!empty($_FILES["photo"])) && ($_FILES['photo']['error'] == 0)) {
            $filename = basename($_FILES['photo']['name']);
            $ext = substr($filename, strrpos($filename, '.') + 1);

            //Check if the file is JPEG image and it's size is less than 1Mb
            if ( ($ext == "jpg") && ($_FILES["photo"]["type"] == "image/jpeg") && ($_FILES["photo"]["size"] <= 5242880) ) {
                //Determine the path to which we want to save this file
                $newname = str_replace( ' ', '_', trim( strip_tags( $_POST['name'] ) ) ) . _ . $formKey->generateKey() . '_' . time() . '.jpg';

                //Check if the file with the same name is already exists on the server
                if (!file_exists($newname)) {
                    if (sizeof($required_error) == 0) {
                        //Attempt to move the uploaded file to it's new place
                        if ((move_uploaded_file($_FILES['photo']['tmp_name'], './photos/'. $newname))) {
                            $move_status = 'done';
                        } else {
                            $error['photo'] = "A problem occurred during file upload!";
                        }
                    }
                } else {
                    $error['photo'] = "File ".$_FILES["photo"]["name"]." already exists";
                }
            } else {
                $error['photo'] = "Only .jpg images under 5Mb are accepted for upload". $_FILES["photo"]["size"] . $_FILES["photo"]["type"] . '====' . $ext;
            }
        } else {
            $error['photo'] = "No photo uploaded";
        }
    }

    $error = $error + $required_error;

    if (sizeof($error) == 0 AND $move_status == 'done') {
                    $_POST['date'] = $_POST['dob_day'].'-'.$_POST['dob_month'].'-'.$_POST['dob_year'];
        $query = sprintf("INSERT INTO `$db_name`.`submissionform` (`id` , `name` , `photo` , `email` , `date` , `postcode` , `subscribe` , `approve` , `created` )
            VALUES ( NULL , '%s', '%s', '%s', '%s', '%s', '%s', '0', CURRENT_TIMESTAMP );",
            mysql_real_escape_string($_POST['name']),
            mysql_real_escape_string($newname),
            mysql_real_escape_string($_POST['email']),
            mysql_real_escape_string($_POST['date']),
            mysql_real_escape_string($_POST['postcode']),
            mysql_real_escape_string($_POST['subscribe']),
            mysql_real_escape_string($_POST['approve']),
            mysql_real_escape_string($_POST['message'])
            );
        mysql_query('SET AUTOCOMMIT=0');
        $result1 = mysql_query($query);

        $last_id = mysql_insert_id();

        if ($result1)
            $success = 'Done';
        else
            $error['general'] = 'Error when submitting your form, please try again.';

        //mysql_free_result($result);
        mysql_close();
    }

}

if ($success == 'Done') {
    $page = 'uploader';
    include 'header.php';
    echo '<img height="782" style="float:left;" src="./assets/img/success.png" />';
    include 'footer.php';
} else {
    $_SESSION['flash_message'] = $error;
    $_SESSION['recent_field'] = $_POST;
    header('Location: ./index.php');
}
?> 
```

**编辑**：我做了一些调试——放在`ini_set('display_errors', 'On'); error_reporting(E_ALL);`uploader.php的顶部

错误是：

注意：未定义的变量：成功在 ..../uploader.php 第 100 行

警告：无法修改标头信息 - 标头已由第 110 行 ....uploader.php 中的（输出开始于 ..../uploader.php:100）发送

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T13:22:42.883

复选框`subscribe`没有`name`字段，在这些行中，

```
<fieldset>                
   <label for="subscribe"><input type="checkbox" class="left" id="subscribe"> <p class="left">subscribe</p></label>
   <input type="submit" name="submit">
</fieldset> 
```

所以`check`内部`foreach`不会通过。

```
foreach( $required_array as $field_name => $field ) {
    if(!isset($_POST[$field_name]) OR empty($_POST[$field_name]) OR $_POST[$field_name] == '') {
        $required_error[$field_name] = 'Please insert your '. $field;
    }
} 
```

另外，`$_POST['form_key']`没有设置，不会通过这条线，

```
//and subsequently have an $error and not execute the query.
if(!isset($_POST['form_key']) || !$formKey->validate()) { 
```

是`id`主键吗？你在`NULL`查询中插入一个值。`id`如果您在查询中传递值，它不会自动递增。

# php - MySql bug in php

> ID：13069526
> 
> 赞同：0
> 
> 时间：2012-10-25T13:20:01.530
> 
> 标签：php, mysql, joomla, joomla2.5

I have used Joomla 2.5 and the administrator module manager displays this type of error.

```
Can't create/write to file 'C:\Windows\TEMP\#sql_490_0.MYD' (Errcode: 17) 
```

can you please help me?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T13:26:12.417

See [http://dev.mysql.com/doc/refman/5.0/en/cannot-create.html](http://dev.mysql.com/doc/refman/5.0/en/cannot-create.html)

There are several reasons for this Error:

1.  No disk space left
2.  Antivirus or Microsoft Security Essential blocks the file
3.  Running two instances of MySQL which are trying to write the same file
4.  The user running MySQL has sufficient rights on this folder

**Solutions**

*   Rename(delete) the file
    *   Stop MySQL, rename the file, start MySQL.
*   Add the folder to the Antivirus's/Microsoft Security Essential's exclude list
*   Check in the taskmanager if there are two instances running of mysql(d).
*   Running defrag
*   Restart Computer/MySQL
*   When you have PhpMyAdmin installed, select your database, scroll down and select and click "Repair".
*   When the error occurred when using mysqldump add this parameter: --skip-lock-tables and --lock-tables=false

Other, similar questions on [SO](https://stackoverflow.com/search?q=%22Errcode:%2017%22&submit=search), [Google](https://www.google.de/search?q=mysql%20windows%20Can%27t%20create/write%20to%20file&ie=utf-8&oe=utf-8).

# asp.net-mvc - 我们如何使用 ADO.NET 进行 MVC？

> ID：13069531
> 
> 赞同：-3
> 
> 时间：2012-10-25T13:20:11.620
> 
> 标签：asp.net-mvc

我有一项使用 ADO.NET 为 MVC 工作的任务。我们可以使用普通的 ADO.NET 来完成这项工作吗？如果可能的话，请提供一些有用的链接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T13:30:14.443

起初，如果不`raw`使用诸如 DataSet 之类的数据容器，ADO.NET 是不可能的。

原因是从动作方法提供模型，从内部视图查询该模型具有不同的范围。视图在操作方法退出后访问模型。考虑以下代码示例：

```
public ActionResult SomeAdoNetAccess(int id, string name) 
{
   ...
   using(var command = CreateSampleCommand()) 
   {
      command.Parameters["@Id"].Value = id;
      ..
      using(var reader = command.ExecuteReader())
      {
            return View(reader);
      }
   } 
} 
```

当视图试图访问阅读器时，阅读器已经被释放。所以需要某种容器。

对于其他事情，您可以将命令参数值作为操作参数传递，并使用 ViewState 将其他数据传递给视图，而无需使用类型化模型。这不是问题，但它需要更多的努力而不是常规模型。

# java - 我正在恢复数据库，我需要在执行此操作时从我的 Java 应用程序锁定任何活动

> ID：13069532
> 
> 赞同：4
> 
> 时间：2012-10-25T13:20:13.403
> 
> 标签：java, spring, hibernate

我正在使用带有 Spring 和 Hibernate 的 c3p0 ComboPooledDataSource，我想出的解决方案是一个自定义 Datasource 类，它在其构造函数中接受实际的 Datasource。我将所有责任委托给实际的数据源。我有一个锁定的布尔值，当设置为 true 时，会使 getConnection() 等到再次锁定为 false。

我只是想知道是否有人可以看到我的方法中的缺陷或有更好的选择？谢谢！

```
public interface LockableDataSource extends DataSource {
    public boolean isLocked();

    public void setLocked(boolean locked);
}

public class LockableDataSourceImpl implements LockableDataSource{

    private DataSource dataSource;
    private boolean locked = false;

    public LockableDataSourceImpl(DataSource dataSource) {
        this.dataSource = dataSource;
    }

    public Connection getConnection() throws SQLException {
        while(locked){
            try {
                Thread.sleep(500);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        }
        return dataSource.getConnection();
    }

    public Connection getConnection(String s, String s1) throws SQLException {
        while(locked){
            try {
                Thread.sleep(500);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        }
        return dataSource.getConnection(s, s1);
    }

    public PrintWriter getLogWriter() throws SQLException {
        return dataSource.getLogWriter();
    }

    public void setLogWriter(PrintWriter printWriter) throws SQLException {
        dataSource.setLogWriter(printWriter);
    }

    public void setLoginTimeout(int i) throws SQLException {
        dataSource.setLoginTimeout(i);
    }

    public int getLoginTimeout() throws SQLException {
        return dataSource.getLoginTimeout();
    }

    public <T> T unwrap(Class<T> tClass) throws SQLException {
        return dataSource.unwrap(tClass);
    }

    public boolean isWrapperFor(Class<?> aClass) throws SQLException {
        return dataSource.isWrapperFor(aClass);
    }

    public boolean isLocked() {
        return locked;
    }

    synchronized public void setLocked(boolean locked) {
        this.locked = locked;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T13:31:50.620

几个缺陷：

1.  您不会同步对标志变量的访问，因此您无法保证其他线程看到它的状态。
2.  您返回`null`on `InterruptedException`，这将导致调用代码中出现难以诊断的异常。
3.  您正在重新实现已经存在的同步原语。

到目前为止，最好的解决方案是在处理数据库时关闭您的应用程序。

如果您真的想在数据库关闭时让您的应用程序挂起，请查看[Semaphore](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/Semaphore.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T13:32:14.043

我会担心两个问题。

1.  当前代码不是线程安全的。
2.  大多数重要的系统需要使用多个应用程序实例。您的锁定不会阻止其他实例作用于数据库。

# ruby - 在 rspec 测试中填充实例变量

> ID：13069536
> 
> 赞同：8
> 
> 时间：2012-10-25T13:20:21.593
> 
> 标签：ruby, rspec, stubbing

我有一个具有以下初始化方法的类。

```
def initialize(my_var)
  @my_var = my_var
end 
```

我想测试然后做某事的方法`@my_var`

```
def split
  @my_var.split(",")
end 
```

`@my_var`在测试它是否正确返回数组之前如何更改？

如果没有访问器，这可能`@my_var`吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-10-25T13:24:35.223

这听起来不像是正确的做法。Rspec 应该测试你的类和模型的接口行为——而不是内部实现（实例变量无疑是）。有很多方法可以做到这一点，但您确定您不想拥有该变量的访问器吗？

无论如何，您可以使用`my_object.instance_variable_get("@my_var")`和`my_object.instance_variable_set("@my_var", value)`操作变量。

# c++ - 在 C++ 中读取文本文件中可用的一组序列

> ID：13069538
> 
> 赞同：-2
> 
> 时间：2012-10-25T13:20:24.273
> 
> 标签：c++, file-handling

我有一个名为 one.txt 的 .txt 文件。它包含以下三个序列。

> 1 -1 -1 1 1 1
> 1 1 1 -1 -1 -1
> 1 -1 1 -1 1 1

我正在使用嵌套的 for 循环来读取上述文件中可用的序列进行三个迭代，如下所示

```
int dd6[6];

ifstream f6;

for(int i=0;i<3;i++){

    f6.open("C:\\one.TXT");

        for(int i7=0;i7<3;i7++){

              for(int i8=0;i8<6;i8++){
                  f6>>dd6[i8];
                  cout<<dd6[i8]<<" ";
              } 
              cout<<"\n";   
        }
        f6.close();
        cout<<"\n";

} 
```

如上述程序所示，我需要将 one.txt 中可用的 3 个序列读取 3 次，如下所示，

> 1 -1 -1 1 1 1
> 1 1 1 -1 -1 -1
> 1 -1 1 -1 1 1

………………………………………………………………………………

> 1 -1 -1 1 1 1
> 1 1 1 -1 -1 -1
> 1 -1 1 -1 1 1

…………………………………………………………………………………………………………

> 1 -1 -1 1 1 1
> 1 1 1 -1 -1 -1
> 1 -1 1 -1 1 1

但是，当我使用上述程序时，我总是得到如下输出，其中第二个和第三个三元组似乎只有最后一个序列 (1 1 -1 -1 1 1) 三次。

> 1 1 1 -1 -1 -1
> 1 -1 1 -1 1 1
> 1 1 -1 -1 1 1

.....................

> 1 1 -1 -1 1 1
> 1 1 -1 -1 1 1
> 1 1 -1 -1 1 1

.....................

> 1 1 -1 -1 1 1
> 1 1 -1 -1 1 1
> 1 1 -1 -1 1 1

我的代码中可能存在什么问题？任何帮助表示赞赏。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T13:28:26.103

我不确定这是问题所在，但是您可以将 get 指针发送到文件的开头，而不是关闭和打开文件

```
f6.seekg(0, ios::beg); 
```

**编辑：已回答**

这是正确的代码。当流到达文件末尾时，它会设置一个错误标志，从那时起读数是错误的。您必须在再次阅读之前清除流。我编写了一个版本的程序，每次都没有重新打开流，但即使你打开和关闭文件，它也能工作。

```
int dd6[6];

ifstream f6;
f6.open("C:\\one.TXT");

for(int i=0;i<3;i++){

    //f6.open("C:\\one.TXT");

        for(int i7=0;i7<3;i7++){
              for(int i8=0;i8<6;i8++){

                  f6>>dd6[i8];
                  cout<<dd6[i8]<<" ";
              } 
              cout<<"\n";   
        }
        f6.clear(); //clear the error flags!
        f6.seekg(0, ios::beg);
        cout<<"\n";

} 
```

# string - KSH：搜索字符串以查找多个子字符串

> ID：13069542
> 
> 赞同：2
> 
> 时间：2012-10-25T13:20:36.267
> 
> 标签：string, substring, ksh

我有一个简单的方法来搜索单个字符串中的多个子字符串：

```
if [[ $string = *"string 1"* && $string = *"string 2"* && $string = *"string 3"* ]] 
```

（这里搜索`string 1`和）。`string 2``string 3``string`

我怎样才能简化这一点，以便只有一张支票？

我试过了：

```
if [[ $string = *"string 1"*"string 2"*"string 3"* ]] 
```

和

```
if [[ $string = *"string 1*string 2*string 3"* ]] 
```

注意：此处指定的三个字符串将*始终*按此顺序排列，因此我可以简化它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T14:06:00.787

在 ksh93 中，您可以使用`&`子模式分隔符。

```
$ [[ abcdefg == @(*bcd*&*cde*&*efg*) ]]; echo $?
0
$ [[ abcdefg == @(*bcdz*&*cde*&*efg*) ]]; echo $?
1 
```

不幸的是，只有 ksh93 有这个。在具有扩展匹配的 mksh、zsh 和 bash 中，否定子模式允许这种类似 DeMorgan 的等价。

```
$ [[ abcdefg == !(!(*bcd*)|!(*cde*)|!(*efg*)) ]]; echo $?
0
$ [[ abcdefg == !(!(*bcdz*)|!(*cde*)|!(*efg*)) ]]; echo $?
1 
```

要仅测试一种模式，请参阅[此常见问题解答](http://mywiki.wooledge.org/BashFAQ/066)

# video - 图像平面和透视变换/相机稳定

> ID：13069547
> 
> 赞同：0
> 
> 时间：2012-10-25T13:20:47.160
> 
> 标签：video, transformation, perspective, stability, projective-geometry

最近我一直在研究图像处理的几何学。我想要完成的是：

想象一个场景有两张照片。我想将第二张图片转换为第一张图片。我想恢复第二张照片的透视，以第一张照片为参考。

但是，我的问题是关于空间的。我了解到透视变换是一种投影变换，映射平面的特殊情况是欧几里得。

我想问一下图像平面是否是欧几里得？我认为它具有齐次坐标，因为当我使用 open cv 执行转换时，我会使用 x 向量，例如 (x,y,1)。我对欧几里得空间和射影空间的定义感到非常困惑。

两个平面的坐标是否齐次？我应该使用哪种转换来稳定旋转相机？

即使我认为我的问题令人困惑，但是，我很困惑......

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T06:25:44.183

> 我了解到透视变换是一种投影变换，映射平面的特殊情况是欧几里得。

你从哪里学来的？好的，输入和输出可能是欧几里得平面，但不一样：在一个设置中的无限远线可能最终成为另一种设置中的有限线（例如在地平线处）。

保持在同一欧几里得平面上的射影变换是[仿射变换](http://en.wikipedia.org/wiki/Affine_transformation)。

> 我想问一下图像平面是否是欧几里得？我认为它具有齐次坐标，因为当我使用 open cv 执行转换时，我会使用 x 向量，例如 (x,y,1)。

齐次坐标也可用于仿射变换，因为它们允许将这样的变换编写为单个矩阵乘法。但是仿射变换，与一般的射影变换相反，永远不会将最后一个分量从零更改为非零，反之亦然。

> 我对欧几里得空间和射影空间的定义感到非常困惑。

就空间而言，射影空间是当您将无限元素（在射影平面的情况下为无穷远处的线）添加到仿射空间时得到的。但我相信你会更多地考虑转换而不是空间。仿射变换将始终保留平行线，而射影变换则不会。因此，对于透视图，您需要投影变换。

> 坐标是否与两个平面齐次？

我建议使用齐次坐标，是的。

> 我应该使用哪种转换来稳定旋转相机？

四个点及其图像唯一地定义了一个射影变换。因此，一旦您注册了四个点，您就可以计算和应用转换。

像[Hugin](http://hugin.sourceforge.net/)这样的工具在这里做了很多更精细的工作，通过补偿各种光学失真，通过注册更多的点来更好地近似所有这些，等等。看一看。

# c++ - 没有函数模板 remove_if 的实例与参数列表匹配

> ID：13069552
> 
> 赞同：0
> 
> 时间：2012-10-25T13:21:08.903
> 
> 标签：c++

我正在尝试从字符串中删除空格

```
line.erase(remove_if(line.begin(), line.end(), isspace), line.end()); 
```

但是 Visual Studio 2010 (C++ Express) 告诉我

```
1   IntelliSense: no instance of function template "std::remove_if" matches the argument list   d:\parsertry\parsertry\calc.cpp 18 
```

**[完整来源](http://pastie.org/5114486)**

这是为什么？一段简单的代码

```
int main() {
    string line = "hello world   111    222";
    line.erase(remove_if(line.begin(), line.end(), isspace), line.end());
    cout << line << endl;

    getchar();

    return 0;
} 
```

验证功能是否有效？

有趣的是，尽管如此，它运行时给出了正确的结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T13:26:05.380

不要质疑 Intellisense，有时最好忽略它。解析器或数据库不知何故搞砸了，所以它不再正常工作了。通常，重新启动将解决问题。

如果您真的想知道代码是否格式错误，那么只需按 F7 即可编译。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T13:28:59.413

您的源代码使用 Visual C++ 11.0（Visual Studio 2012 附带的编译器）编译时甚至没有警告。

Intellisense 使用自己的规则，并不总是可靠的。

也就是说，您对除原始 7 位 ASCII 之外的所有字符集使用的`isspace`是**未定义行为。**这意味着您从中获得的高度赞成的答案只是胡说八道（这不足为奇）。您需要将参数转换为（C 库的）`isspace`以`unsigned char`避免负值和 UB。

**C99 §7.4/1**（来自 N869 草案）：

> 头文件`<ctype.h>`声明了几个对测试和映射字符有用的函数。在所有情况下，参数都是 an `int`，其值应表示为 an`unsigned char`或应等于宏的值`EOF`。如果参数有任何其他值，则行为未定义。

包装 C 函数的一种简单方法是

```
bool isSpace( char const c )
{
    typedef unsigned char UChar;
    return !!::isspace( UChar( c ) );
} 
```

为什么`typedef`？

1.  当您已经拥有这样的 时，它使代码更容易适应`typedef`，这并不少见；

2.  它使代码更清晰；和

3.  它避免了 C 语法转换，从而在通过正则表达式或其他模式匹配进行搜索时避免误报。

但是，为什么`!!`（否定运算符的双重应用）？考虑到从to的自动*隐式转换*？而且，如果有人绝对认为转换应该是明确的，那不应该是 a ，而不是？`int``bool``static_cast``!!`

好吧，`!!` 避免了来自 Visual C++ 编译器的愚蠢警告，

> “警告 C4800: 'int' : 强制值 bool 'true' 或 'false' (性能警告)”

并且 a`static_cast`不会停止该警告。最好的做法是消除该警告，并且由于 Visual C++ 是最常用系统（即 Windows）上的主要 C++ 编译器，因此最好在所有可移植的代码中执行此操作。

哦，好的，但是，既然函数无论如何都必须被包装，那么……为什么要使用旧的 C 库`isspace`（单参数）函数，而`<locale>`头文件提供了一个更灵活的 C++（两个参数）`isspace`函数？

嗯，首先，旧的 C`isspace`函数是*问题中使用的*函数，所以这就是这个答案中讨论的函数。我专注于讨论如何不错误地执行此操作，即如何避免未定义的行为。讨论*如何正确地做这件事*会把它带到一个完全不同的层次。

但是在实践中，可以认为同名的 C++ 级函数已被破坏，因为直到最近使用 g++ 编译器（甚至可能使用 g++ 4.7.2，我最近都没有检查过）只有 C 语言环境机制在 Windows 中有效，而 C++ 一级没有。它可能已经修复，因为 g++ 现在支持宽流，我不知道。无论如何，那里的 C 库`isspace`函数，除了在实践中更便携和通常在 Windows 中工作之外，还*更简单*，我相信，更*高效*（尽管为了提高效率，如果它被认为很重要，应该总是 MEASURE！）。

感谢 James Kanze 在评论中提出（基本上）上述问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T14:55:31.427

是什么`isspace`？根据包含的头文件和您使用的编译器，您的代码甚至可能无法编译。（我不了解 IntelliSense，但它可能正在查看所有标准标头，并看到歧义。）

标准中有两个`isspace`功能，一个是模板。将函数模板传递给另一个函数模板的模板参数并没有为编译器提供足够的信息来进行模板参数推导：为了解决 的重载`isspace`，它必须知道 期望的类型 `remove_if`，它只模板参数推导成功*后才*知道。并且要对 进行模板参数推导`remove_if`，它必须知道参数的类型，这意味着 的类型`isspace`，它只有在能够解决它的重载时才会知道。

（我真的很惊讶你的一点代码编译：你显然包含`<iostream>`，并且通常`<iostream>`会包含 `<locale>`，这将引入函数模板`isspace`。）

当然，函数模板`isspace`必须用两个参数调用，所以如果它被选择，实例化`remove_if` 不会编译（但编译器在 `remove_if`选择一个函数之前不会尝试实例化）。如果传递 a ， `isspace`in `<ctype.h>`将导致未定义的行为`char`，因此您不能使用它。通常的解决方案是为您的工具箱创建一组谓词对象，并使用它们。如果您只关心以下内容，则应该可以使用`char`：

```
template <std::ctype<char>::mask m>
class Is : public std::unary_function<char, bool>
{
    std::locale myLocale;  //  To ensure lifetime of following...
    std::ctype<char> const* myCType;
public:
    Is( std::locale const& loc = std::locale() )
        : myLocale( loc )
        , myCType( &std::use_facet<std::ctype<char> >( myLocale ) )
    {
    }

    bool operator()( char ch ) const
    {
        return myCType->is( m, ch );
    }
};
typedef Is<std::ctype_base::space> IsSpace; 
```

添加额外的 typedef 很简单，因此您可以获得完整的集合，而且我发现添加`IsNot`模板也很有用。这很简单，它避免了*所有*周围的问题。

# php - 在foreach中查询没有结果

> ID：13069558
> 
> 赞同：0
> 
> 时间：2012-10-25T13:21:45.753
> 
> 标签：php, mysql, arrays, search, foreach

我正在尝试将一个表中具有特定描述的用户与另一个表中的一般搜索描述进行匹配。我有一个包含一般描述的 foreach，并在 foreach 中创建了一个查询，希望提取出最适合该一般描述的用户。

问题是当我回显`username`. 当我回显结果 ['title'] 时，我得到了结果。

```
if (empty($errors)){
  $results = search_results($keywords);
  $results_num = count($results);

  echo '<p><strong style ="font-size:145%;font-family:georgia;"> Titles: </strong></p> ';

  foreach ($results as $result){
    $query = mysql_query("SELECT username, title from clothing 
    WHERE description LIKE '%$results%'");
    while($row=mysql_fetch_array($query)){
    $username=$row['username'];                     
    $title=$row['title'];
    echo $username;
    }
    echo '<p> <strong>',$result['title'],'</strong> </p>';
  }

} 
```

我很高兴知道为什么我的用户没有得到回应。此外，任何编程技巧都将不胜感激，因为我一直在学习，我总是想找到改进的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T13:25:19.800

您需要在查询中将 $results 替换为 $result：

```
$query = mysql_query("SELECT username, title from clothing WHERE description LIKE '%$result%'"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T13:26:41.683

如果计数等于 0，请尝试设置一项检查（带有错误消息）。并且 LIKE 子句值必须是结果而不是结果

```
if (empty($errors)){
                $results = search_results($keywords);
                $results_num = count($results);

                if($results_num==0) {
                    echo "NO RESULTS MESSAGE !!!"; 
                }
                else{

                    echo '<p><strong style ="font-size:145%;font-family:georgia;"> Titles: </strong></p> ';

                    foreach ($results as $result){
                      $query = mysql_query("SELECT username, title from clothing WHERE description LIKE '%$result%'");
                      while($row=mysql_fetch_array($query)){
                        $username=$row['username'];                     
                        $title=$row['title'];
                        echo $username;
                      }
                      echo '<p> <strong>',$result['title'],'</strong> </p>';
                    }
               }

           } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T13:28:42.190

```
SELECT username, title from clothing WHERE description LIKE '%$results%' 
```

`$results`，它似乎是一个数组。我想你必须在`$result`这里使用。

# maven - 在 Eclipse Tomcat 中部署 MavenWebApp

> ID：13069560
> 
> 赞同：0
> 
> 时间：2012-10-25T13:21:49.250
> 
> 标签：maven, m2e

我有以下问题：

我有一个带有一些子项目的 Maven MainProject。其中两个子项目是 WebApplications。（一个 WebApp 和一个 WebService）

`mvn clean package`如果我在命令行中使用2 个文件构建 MainProject，则`.war`可以在外部 Apache Tomcat 6.0 中部署。

如果我使用 Eclipse 在 Eclipse 中构建 MainProject，`m2e plugin`我还可以将 .war 文件部署到外部 Tomcat 中。

**但是**如果我想在 Eclipse 的 Apache Tomcat 中部署 WebProjects，它不会启动。问题是，内部 Tomcat 的 eclipse 构建的文件结构与 Maven 不同。

在 Maven 构建（控制台/m2e）中，路径正确地从例如`Project/src/main/java/com/...`到`WEB-INF/com...`

内部 Tomcat 的 Eclipse 构建创建了类似的结构`WEB-INF/main/java/com/...`

由于路径错误，找不到许多 Tomcat 引导所必需的 .xml 文件。

我如何告诉 eclipse 它应该在命令行上执行类似 m2e 或 maven 的构建，以便我可以在 eclipse 中使用内部 tomcat？

我在用

Eclipse Juno 4.2 或 Helios 3.6

m2e - Eclipse 的 Maven 集成 / 1.1.0.20120530-0009 / org.eclipse.m2e.feature.feature.group WTP 的 Maven 集成 / 0.15.2.20120306-2040 / org.maven.ide.eclipse.wtp.feature.feature.group

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T06:23:11.573

我解决了这个问题。

问题是 Eclipse 项目中的部署程序集选项。Eclipse 默认选项是部署`/src`到`/`文件夹。由于 Maven 结构`/src/main/java/com`，部署的文件夹也看起来像`/main/java/com`. 我只需要将源文件夹从更改`/src`为`/src/main/java`（目标仍然存在`/`）。如果还有其他必要的文件，我必须以相同的方式添加它们，例如`/src/main/resources`. 该`/src/main/webapp`文件夹已由 Eclipse 正确设置为`/WEB-INF`

# c#-4.0 - 如何通过 COM 互操作使用 VB6 中的结构？

> ID：13069574
> 
> 赞同：3
> 
> 时间：2012-10-25T13:22:34.613
> 
> 标签：c#-4.0, vb6, com-interop

这是场景：

我有一个 VB6 项目。它包含一个通过 ref 接收变体类型参数的方法。

```
Function GetFilledInfo(data As Variant) 
```

此方法用结构填充接收到的参数。这个结构在我的 VB6 项目中定义如下。

```
Public Type DATASTRUCTMAIN
   structChild As DATASTRUCTCHILD
End Type

Public Type DATASTRUCTCHILD
   m_bComputeRanges As Long
End Type 
```

我有一个 C# 程序，它通过引用 VB6 项目生成的 ActiveX dll 来调用此方法。

我想在我的 C# 程序中声明在 VB6 中定义的结构，并希望使用 VB6 方法来填充它。

我怎样才能做到这一点？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T16:57:55.957

我不禁注意到您只传递了一个 Long （除非您为了简洁而截断了这些结构定义）。在这种情况下，只需更改 VB6，使其公开一个返回 Long 的函数！

如果你有一个真正的结构......

将结构定义移动到 VB6 项目中的公共类。然后结构定义将通过 COM 公开提供给任何引用您的 VB6 项目的客户。

*希望*您能够在您的 C# 项目中使用它，并且您将能够声明该结构的实例。您确实在 C# 项目的项目引用中引用了 VB6 组件，对吗？对 .Net COM 互操作不太熟悉，因此对此不确定。

如果您在 C# 项目中声明结构实例时遇到任何问题，您可以将 VB6 结构更改为类吗？[显然结构在 COM 互操作中可能存在问题](https://stackoverflow.com/questions/10489368/returning-multiple-results-udt-from-an-interop-call-vb6-vb-net)

# tfs - 结帐时自动获取结帐锁（tfs2012）？

> ID：13069584
> 
> 赞同：12
> 
> 时间：2012-10-25T13:23:03.183
> 
> 标签：tfs, vcs-checkout

使用服务器工作区时，有什么方法可以自动获取结帐锁。我知道您可以通过工具->选项并在“签入项目->编辑”下指定“提示锁定结帐”，但我们希望它自动发生，而不必在他们面前抛出一个对话框并制作他们选择结帐锁。我们正在从 sourcesafe 迁移到 TFS，并且我们有一些用户不需要本地工作空间和/或多个结帐的灵活性。如果他们遇到合并冲突对话框，他们会吓坏的。有什么方法可以让 tfs 像 sourcesafe 一样工作？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-10-25T18:09:23.150

**禁用多个结帐**

团队 -> 团队项目设置 -> 源代码管理 -> 取消勾选“允许多次签出”

**将服务器工作区设置为默认值**

团队 -> 团队项目集合设置 -> 源代码管理 -> 工作区设置 -> 服务器工作区

# node.js - nodejs中间件延迟请求

> ID：13069591
> 
> 赞同：0
> 
> 时间：2012-10-25T13:23:34.550
> 
> 标签：node.js, middleware

我正在编写一个中间件，它将执行一系列操作。序列完成后，我希望中间件调用 next()。从这一点上中间件是多余的。我编写了以下代码：（这里的动作序列通过调用 setTimeout 来模拟）：

```
function myMiddleware(req, res, next){

   console.info("inside myMiddleware");

   if (actionDone) {
       console.info("middleware redundant. ActionDone, calling next");
       next();
   }

   setTimeout(doneWaiting, 30000);

   function doneWaiting(){
      actionDone = true;
      next();
   }
} 
```

此代码将不起作用，因为如果在操作完成之前有多个请求到达，则会一次又一次地调用 setTimeout。我希望 setTimeout 只被调用一次，并且只有在它完成后，我才想对迄今为止到达的所有请求调用 next() 。

实现这一目标的最佳方法是什么？

谢谢，李

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T13:38:46.343

如果我理解正确，您想在任务完成后执行任务并处理所有请求？在那之前他们会等吗​​？

所以这是不可扩展的方式：

```
var EventManager = new require("events").EventEmitter( );
var actionDone = "start";

function myMiddleware(req, res, next){

   console.info("inside myMiddleware");
   var handler = function( ) {
       console.info("middleware redundant. ActionDone, calling next");
       next();
   };

   if (actionDone === "finished" ) {
       handler( );
       return;
   }

   EventManager.once( "finished", handler );

   if (actionDone !== "working") {
       actionDone = "working";
       function doneWaiting(){
          actionDone = "finished";
          EventManager.trigger( "finished" );
       }
       setTimeout(doneWaiting, 30000);
   }
} 
```

显然它是不可扩展的，因为你不能`EventManager`在机器之间共享对象。为了在机器之间做到这一点，您可能必须从主服务器向所有其他服务器发出请求并以类似方式处理请求。

**警告：**您尝试做的事情看起来是一个非常非常糟糕的主意。毕竟请求不应该相互依赖。这很容易导致服务器崩溃。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T20:38:16.673

将`actionDone`变量设置为`req`, 这样

```
function myMiddleware(req, res, next){

console.info("inside myMiddleware");

if (req.actionDone) {
    console.info("middleware redundant. ActionDone, calling next");
    next();
}

setTimeout(doneWaiting, 30000);

function doneWaiting(){
   req.actionDone = true;
   next();
} 
```

}

# c# - 在运行时从字符串创建数学函数

> ID：13069594
> 
> 赞同：1
> 
> 时间：2012-10-25T13:23:37.553
> 
> 标签：c#, wpf, math, methods, delegates

我在问这个问题，因为我还没有找到任何与 C# 相关的帖子，并且可能有一些我找不到的内置方法。如果有，请告诉我，我可以结束这个问题。

基本上我有常见的情况：

1.  用户将一个或两个变量的函数键入一些`TextBlock`
2.  我拿这个字符串分析一下
3.  作为回报，我希望有一个方法的委托，该方法将接受一个或两个输入（变量）并根据用户输入的内容返回函数值。

现在，我可能会想到（我想自己做，因为我想用我的大脑）一个算法，逐步分析字符串以实际找出，首先要计算什么以及在什么方式。例如，首先扫描括号，在一组括号中查找表达式并根据更一般的函数等计算。

但最后我想“创建”这种分析的方法，以便轻松用作普通委托，并带有几个参数，这些参数将返回正确的函数值。C# 中是否已经包含任何方法，或者我必须自己去编程所有东西？

备注：我不想使用任何其他人的库，我只能接受 .NET 库。

**编辑：**在马特指出表达式树之后，我发现[这个](https://stackoverflow.com/questions/1574845/create-anonymous-method-from-a-string-in-c-sharp)线程是我问题的一个很好的例子。

**Edit2：**指出的示例仅包含简单函数，如果我想包含更复杂的函数（例如三角函数或指数函数），则将无用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T13:25:49.430

您可能想查看[表达式树](http://msdn.microsoft.com/en-us/library/bb397951.aspx)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T13:31:02.547

查看[NCalc](http://ncalc.codeplex.com/)了解如何执行此操作的一些示例。你不需要使用图书馆，但阅读源代码是很有教育意义的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-25T13:34:08.873

你所描述的是一个解析器。有许多不同的实现方式，尽管一般来说，对于复杂的语法，经常使用“解析器生成器”。

解析器生成器将获取语法的描述并将其转换为代码，该代码将符合语法的文本解析为可以由程序操作的某种形式的内部表示，例如解析树。

由于您表示要避免使用第三方库，因此我假设同样排除了解析器生成器的使用，这样您就可以实现自己的解析器（幸运的是，这是一个非常有趣的练习）。

[递归下降解析器](http://en.wikipedia.org/wiki/Recursive_descent_parser)的维基百科页面将特别有用。我建议通读它，并可能根据您的特定用例调整其中的示例代码。以此为起点，我自己已经为不同的语法做了很多次，所以可以证明它的有用性。

这种解析器的输出将是一个“解析树”。然后，您可以通过多种可能性将其转换为可执行委托。一种选择是在解析树节点上实现一个`Evaluate()`方法，该方法将采用一组变量并返回评估用户表达式的结果。正如其他人所提到的，您的解析树可以利用 .NET 的表达式树，或者您可以直接发出 IL（允许您从用户的表达式生成已编译的 .NET 程序集以供以后根据需要使用）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T15:39:34.607

我找到了一个非常有用的 pdf，解释了 C# 2.0 中的解析。[这个链接](http://www.itu.dk/people/kfl/parsernotes.pdf)提供了一个关于 C# 中使用的解析器的非常好的教程，并且稍后也将其应用于算术表达式。

由于这直接帮助并回答了我的问题，因此我将其发布为答案，而不是评论或编辑。

# iphone - UIImageView contentMode 在视网膜和非视网膜显示中不同

> ID：13069596
> 
> 赞同：0
> 
> 时间：2012-10-25T13:23:42.897
> 
> 标签：iphone, objective-c, ios, uiimageview

所以我在`UIImageView`它上面有一个图像。当我使用普通的 iPhone 显示器时，它会`UIImageView`完全按照预期在内部显示 - 在`UIImageView`边界内，问题是当我使用视网膜显示设备时，图像变大并且不符合`UIImageView`边界，一切正常在屏幕上。

我该如何解决这个问题？我希望 Retina 显示中的图像适合`UIImageView`尺寸。

这是我的代码：

```
- (UIImage *)loadScreenShotImageFromDocumentsDirectory
{
    UIImage * tempimage;
    NSArray *sysPaths = NSSearchPathForDirectoriesInDomains( NSDocumentDirectory, NSUserDomainMask, YES );
    NSString *docDirectory = [sysPaths objectAtIndex:0];
    NSString *filePath = [NSString stringWithFormat:@"%@/MeasureScreenShot.png", docDirectory];
    tempimage = [[UIImage alloc] initWithContentsOfFile:filePath];

    return tempimage;
}

- (void)viewDidLoad
{
    // Setting the image
    UIImage * Image = [self loadScreenShotImageFromDocumentsDirectory];
    theImageView.frame = CGRectMake(0, 166, 290, 334);
    theImageView.contentMode = UIViewContentModeCenter;        
    theImageView.image = Image;
} 
```

预先感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T13:28:23.280

尝试将内容模式设置为`UIViewContentModeScaleAspectFit`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T13:29:06.397

当我使用带有核心图的图像时，我必须为视网膜显示缩放图像。

```
 CPTImage *fillimage = [CPTImage imageWithCGImage:bubble.CGImage scale:bubble.scale]; 
```

图像文件的名称是气泡，我有一个气泡文件和一个气泡@2x 文件。这让图像适合任一显示的图像视图。希望这可以帮助。

# c# - 实体框架查询完成事件

> ID：13069597
> 
> 赞同：1
> 
> 时间：2012-10-25T13:23:43.010
> 
> 标签：c#, wpf, entity-framework

所以我的问题是：是否有查询完成事件？？？

我正在使用实体框架从数据库中查询一些数据并将其显示在 WPF 应用程序中。我的问题是渲染在实体框架从数据库服务器收到结果之前完成，因此我在 UI 上的数据列表仍然是空的。相反，如果我进入调试模式并在继续列出数据之前稍等片刻，则查询完成并列出数据。

我应该如何解决这个问题？

**编辑：** 这是我的代码：

```
public class DatabaseModel : DbContext, INotifyPropertyChanged
    {
        public ObservableCollection<Employee> observableCollection;
        public event PropertyChangedEventHandler PropertyChanged;

        public DbSet<Employee> Employees { get; set; }
        public ObservableCollection<Employee> ObservableEmployees
        {
            get
            {
                return observableCollection;
            }
            set
            {
                observableCollection = value;
                OnPropertyChanged("ObservableEmployees");
            }
        }

        public DatabaseModel()
        {
            ObservableEmployees = Employees.Local;
        }

        // Create the OnPropertyChanged method to raise the event 
        protected void OnPropertyChanged(string name)
        {
            PropertyChangedEventHandler handler = PropertyChanged;
            if (handler != null)
            {
                handler(this, new PropertyChangedEventArgs(name));
            }
        }
    } 
```

以及我如何通过 WPF 使用我的 DataBinding：在 App.Xaml 中，我定义了这个类的一个实例......

```
<Application.Resources>
        <local_database:DatabaseModel x:Key="DatabaseInstance"/>
</Application.Resources> 
```

并使用 Mainwindow.XAML 中的数据

```
<ListBox ItemsSource="{Binding Source={StaticResource DatabaseInstance}, Path=ObservableEmployees, NotifyOnSourceUpdated=True}" 
                             DisplayMemberPath="Name"
                             Binding.SourceUpdated="ListBox_SourceUpdated">
                    </ListBox> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T14:16:56.453

您的来源有两个问题。

1.  您使用`Employees.Local`，但我看不到任何加载员工的代码。
2.  从视图模型派生的视图模型`DbContext`破坏了视图模型的目的：关注点分离。视图模型不应参与数据层活动。您的控制器/演示者层应该*使用*数据层创建它。换句话说：创建一个作为 POCO 类并使用来自数据层的集合`DatabaseModel`填充它。`Employees`然后在 UI 开始渲染之前填充视图模型，您不需要任何复杂的接线来等待查询完成。

# mercurial - 从 Web 界面推送到已配置的 hg 存储库

> ID：13069601
> 
> 赞同：0
> 
> 时间：2012-10-25T13:23:58.297
> 
> 标签：mercurial, hgrc, rhodecode

我有一小群开发人员，我们都在自己的机器上开发。当我们有准备好测试的代码时，我们合并并推送到 RhodeCode 安装。我的中央 RhodeCode 存储库的 hgrc 文件设置如下：

```
[paths]
test_env = /www/mysite/test
prod_env = /www/mysite/prod
[hooks]
changegroup = hg push test_env 
```

因此，当有人将代码签入 RhodeCode 时，更改会自动推送到测试环境。（测试 repo hgrc 文件中有一个 hg 更新，因此代码在那里更新）。太棒了。

但是.. 我希望我们的 RhodeCode 管理员能够推送到 prod 而无需在服务器上访问 shell。有没有办法让某人从 RhodeCode 界面运行“hg push prod_env”？我认为既然 RhodeCode 可以完全控制 hg，那应该是可能的，但是这种能力是否存在于 RhodeCode 的某个地方？添加它会是一项艰巨的任务吗？

如果不是，您将如何允许经过身份验证的用户在没有 shell 访问权限的情况下将存储库推送到生产环境？我一直在谷歌搜索，但我似乎找不到任何东西。我知道我可以用 passthru("hg push test_env) 编写一个 php 脚本，但这似乎是一个权限噩梦，因为 apache 以“nobody”运行并且 rhodecode 拥有 repo。

想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-15T19:19:36.337

显然，你不能什么都不推。但是您可以尝试从 prod_env 的 RhodeCode 界面（允许这样做）添加或编辑一些文件。这应该会导致本地提交和推送，而无需访问 shell。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-25T10:43:52.900

对于那些看这个问题的人，我是这样解决的：

用 PHP 编写了一个带有执行此代码的按钮的密码页面：

```
shell_exec('hg pull -R ../wp-content/themes/2014'); 
```

然后我将 hg update 放入 prod 网站的 hgrc 文件中，并设置存储库的 web 用户和授权用户。

它工作得很好 - 由于产生的文件所有权，我有轻微的安全问题，但假设 PHP 遵循正确的做法，没有任何问题。

# java - 合并 list1 中的两个 arraylist 列表，同时保持排序

> ID：13069605
> 
> 赞同：1
> 
> 时间：2012-10-25T13:24:13.737
> 
> 标签：java, arraylist

在我的作业中，第三步是调用方法 merge 来合并 list1 中的两个列表，以便 list1**保持排序状态。**

我写了我的代码，但它不能很好地工作，输出显示错误，因为排序很重要

```
 public static void merge (ArrayList<Integer> list1, ArrayList<Integer> list2)
 {
        int i;
        int n=list1.size();
        int pos , j=0;

        for (pos =0 ;pos<n ; pos++)
        {
            for ( i=0 ; i<n ; i++)
                if (list1.get(j)>list2.get(pos))
                    list1.add(pos,list2.get(pos));
                else 
                    j++;
       } 
 } 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-25T13:48:02.153

假设两个列表都已排序，您只需要一个`for`循环：

```
public static void merge(List<Integer> l1, List<Integer> l2) {
    for (int index1 = 0, index2 = 0; index2 < l2.size(); index1++) {
        if (index1 == l1.size() || l1.get(index1) > l2.get(index2)) {
            l1.add(index1, l2.get(index2++));
        }
    }
} 
```

如果`l2`未排序，则需要两个循环：

```
public static void merge(List<Integer> l1, List<Integer> l2) {
    for (int index2 = 0; index2 < l2.size(); index2++) {
        for (int index1 = 0; ; index1++) {
            if (index1 == l1.size() || l1.get(index1) > l2.get(index2)) {
                l1.add(index1, l2.get(index2));
                break;
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T13:32:34.603

轻松修复：事后排序。

```
list1.addAll(list2);
Collections.sort(list1); 
```

使用集合来避免重复。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-25T13:35:40.780

```
public static void merge (ArrayList<Integer> list1, ArrayList<Integer> list2)
{
    list1.addAll(list2);
    Collections.sort(list1);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T13:33:09.190

合并列表后，调用排序方法如下。

```
Collections.sort(list1); // carries out natural ordering. 
```

如果您需要自定义排序，请使用 Comparator 对象

```
Collections.sort(list1, comparatorObject); 
```

检查[比较器示例](http://www.mkyong.com/java/java-object-sorting-example-comparable-and-comparator/)以获取更多详细信息。

这是您修改后的代码：

```
 public static void merge (ArrayList<Integer> list1, ArrayList<Integer> list2)
 {
    list1.add(list2); //merges list 2 to list1
    Collections.sort(list1); //natural ordering
 } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-25T13:37:19.700

如果您的输入列表不是太长，我建议只合并列表并使用`Collections.sort()`方法来恢复顺序：

```
public static void mergeAndSort(List<Integer> list1, List<Integer> list2) {
    List<Integer> combinedList = new ArrayList<Integer>(list1);
    combinedList.addAll(list2);
    Collections.sort(combinedList);
    return combinedList;
} 
```

作为旁注，您应该尽可能使用`List`接口而不是`ArrayList`实现类。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-04-27T02:30:42.433

```
public list mergeAndSort(List<integer> list1, List<integer> list2){
List<integer> list3;
int list2Size = list2.size();
for(int i=0;i<list2Size;i++){
    list1.add(list2(i));  
}
// Here we got all the elements in 1 list i.e list1

int list1Size = list1.size();
for(i=0;i<list1Size;i++){
    int small = 0;
    for(int j=i;j<list1size;j++){
        if(list1(i)> list2(j)){
            small = list2(j;
        }
    }
    list3.add(small); //Smallest 1 will be added to the new list
} 
```

}

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2015-07-03T00:26:27.047

```
 ArrayList<Integer> a = new ArrayList();
     ArrayList<Integer> b = new ArrayList();
     ArrayList<Integer> c = new ArrayList();

     a.add(1);
     a.add(3);
     a.add(5);
     a.add(7);
     a.add(17);
     a.add(27);
     a.add(37);

     b.add(0); 
     b.add(2);
     b.add(4);

     while( a.size() > 0 || b.size() >0){

        if( a.size() == 0 || b.size() == 0){
            c.addAll(b);
            c.addAll(a);
            break;
        }

        if(a.get(0) < b.get(0)){
            c.add(a.get(0));
            a.remove(0);
        }
        else{
            c.add(b.get(0));
            b.remove(0);
        }

    }

    System.out.println(c.toString()); 
```

# java - 在jsp页面中找不到控制器传递的对象

> ID：13069606
> 
> 赞同：0
> 
> 时间：2012-10-25T13:24:14.807
> 
> 标签：java, spring, jsp, spring-mvc, jstl

我正在开发一个简单的 spring mvc web 应用程序：一个简单的控制器：

```
public class LoginController extends MultiActionController {
    private final static String VIEW_LOGIN = "/login";

    public ModelAndView handleLogin(HttpServletRequest request,
            HttpServletResponse response){
        ModelAndView mv = new ModelAndView(VIEW_LOGIN);
        String prova = "PROVA123";
        mv.addObject(prova);
        return mv;
    }
} 
```

一个简单的jsp页面：

```
<%@ taglib uri='http://java.sun.com/jsp/jstl/core' prefix='c'%>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>   

    <title>Login - Gestione Studenti</title>

    <!--
    <link rel="stylesheet" type="text/css" href="styles.css">
    -->

  </head>

  <body>
    <p><c:out value="${prova}"/></p><br>
  </body>
</html> 
```

这是调度程序 servlet xml 文件

```
<bean id="loginController" class="it.mediosoft.gestionestudenti.web.LoginController">
        <property name="methodNameResolver" ref="handlerResolver"/>
    </bean>

    <bean id="urlMapping"
        class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping">
        <property name="mappings">
            <props>
                <prop key="/login.html">loginController</prop>
            </props>
        </property>
    </bean>

    <bean id="handlerResolver"
        class="org.springframework.web.servlet.mvc.multiaction.PropertiesMethodNameResolver">
        <property name="mappings">
            <props>
                <prop key="/login.html">handleLogin</prop>
            </props>
        </property>
    </bean>
     <bean id="viewResolver" class="org.springframework.web.servlet.view.InternalResourceViewResolver">
        <property name="viewClass"><value>org.springframework.web.servlet.view.JstlView</value></property>
        <property name="prefix"><value>/WEB-INF/jsp/</value></property>
        <property name="suffix"><value>.jsp</value></property>
    </bean> 
```

为什么在 login.jsp 中我不能使用 loginController 在 ModelAndView 返回的对象？"c:out" 不打印任何东西....有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T13:37:35.933

尝试：

```
mv.addObject("prova",prova); 
```

那应该可以解决您的问题

# php - 使用来自自我发布表单的 ajax 自动刷新动态内容

> ID：13069609
> 
> 赞同：1
> 
> 时间：2012-10-25T13:24:15.713
> 
> 标签：php, ajax, twitter

提交表单后，我需要自动刷新页面内容。内容是对主题标签的搜索，它需要每 x 秒更新一次。我正在努力解决的一点是，我的表单提交给自己，所以所有内容都在同一页面上处理。因此，我需要在刷新内容时保留用户搜索字符串，以便显示结果和找到的任何新结果。

[原则上与http://gigatweeter.com/](http://gigatweeter.com/)几乎相同

这是我一直在使用的代码。

```
<script type="text/javascript">
var auto_refresh = setInterval(
function ()
{
$('#load_page').load('twitter.php').fadeIn("slow");
}, 10000); // will auto refresh every 10 seconds
</script> 
```

如果页面提交给自己，我找不到任何支持或线程来解决这个问题，因此我们将不胜感激。

我可以调用页面顶部的 php 重新开始吗？

# entity-framework - 实体框架查询执行结果

> ID：13069612
> 
> 赞同：1
> 
> 时间：2012-10-25T13:24:23.100
> 
> 标签：entity-framework

我们正在考虑使用实体框架进行批量上传作业。因为我们对跟踪每个记录的单个结果感兴趣，所以我试图找出是否所有插入的项目都作为事务的一部分完成，以及单个故障是否会导致回滚，或者是否有跟踪结果的方法每个单独的结果。

我正在考虑只循环遍历项目并在每个项目上调用 Save() 并将其包装在 try/catch 块中，但如果我可以利用各个结果，仅在上下文中调用 save() 似乎更有效。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T13:32:31.297

默认情况下，每次调用时，`SaveChanges`所有待处理的记录都会立即保存。调用中的所有操作`SaveChanges`都在事务（[source](http://msdn.microsoft.com/en-us/library/bb336792.aspx)）中，因此如果特定的 SaveChanges 调用失败，它将回滚该特定调用中的查询，但显然不是以前成功的调用。

最终，这取决于您调用 SaveChanges 的位置以及您将获得多少回滚。`TransactionScope`您可以通过查看[这篇文章](http://forums.asp.net/t/1736586.aspx/1)来扩展事务的长度，以获取有关如何扩展范围的一些示例。

我自己的经验是，过于频繁地调用 SaveChanges 确实会降低性能，并大大减慢整个过程。但显然等待太久可能意味着更大的内存占用。我发现 EF 可以轻松处理数千行而不会出现太多内存问题。

将代码放在 try...catch 中会对您有所帮助，但您可能希望查看实体验证，因为您可以对对象设置限制，然后在生成任何 SQL 之前对对象进行验证。

# android - 如何在GreenDao中实现表继承

> ID：13069614
> 
> 赞同：5
> 
> 时间：2012-10-25T13:24:30.730
> 
> 标签：android, android-sqlite, greendao

我一直在尝试创建一个数据库，其中所有表都继承某个元素，以便有可能拥有元数据。

我在模型生成器的所有表声明中添加了这一行：

```
public Entity addSuperEntity(Schema schema) {
     Entity superEntity = schema.addEntity("superEntity");
     superEntity.addIdProperty().primaryKey();
     // SET RELATIONSHIP 1:m TO META DATA
}

public Entity addTable(Schema schema) {
    Entity mEntity = schema.addEntity("MyEntity");
    mEntity.setSuper("superEntity");
    mEntity.addIdProperty().PrimaryKey();
    // REST OF FIELDS
} 
```

问题是：

现在，在我将它生成到我的 Android 项目之后，我如何确保这仍然会在现实生活中发生？我现在需要改变什么吗？

官方文档没有关于继承的任何内容。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-30T10:05:05.523

使用 setSuperclass(String) 支持非实体超类的继承。另一种方法是使用 implementsInterface(String) 实现接口。

我在关于继承和接口的新部分更新了官方文档中的一些细节：http: [//greendao-orm.com/documentation/modelling-entities/](http://greendao-orm.com/documentation/modelling-entities/)

# objective-c - 为旧版 Mac 编译程序

> ID：13069618
> 
> 赞同：1
> 
> 时间：2012-10-25T13:24:44.677
> 
> 标签：objective-c, macos, compilation

我有一个客观的 c 脚本，它获取 Mac 的系统信息并将其作为带有特定标签的 XML 输出。它适用于 Mountain Lion 和 Lion，但不适用于除此之外的任何版本。高达 10.5 将是理想的。当我在 10.6.8 上运行它时，我得到一个 Bad CPU 错误。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:46:20.293

Xcode 4.5.1 附带 OS X 10.7 和 10.8 SDK。要编译在早期 OS X 版本上运行的程序，您必须在程序设置的信息选项卡中设置“OS X 部署目标”。

“自动引用计数”仅在 OS X 10.6 及更高版本上受支持（请参阅[Objective-C 功能可用性索引](http://developer.apple.com/library/ios/#releasenotes/ObjectiveC/ObjCAvailabilityIndex/_index.html)）。如果要部署到 10.5，则必须在没有 ARC 的情况下进行编译。所以要么

*   您创建一个新项目并取消选中“使用自动引用计数”，或者
*   您在构建设置中将“Objective-C 自动引用计数”设置为“否”。

要构建在 32 位处理器上运行的可执行文件，您必须在 Build settings 中将“Architectures”设置为“32-bit Intel”。默认情况下，Xcode 4.5.1 将针对编译机的体系结构进行编译（很可能是 64 位）。但是在这种情况下你不能使用 ARC，因为 ARC 需要所谓的“现代运行时”，它只在 64 位系统上可用。

# opera - Store log from opera dragonfly console

> ID：13069620
> 
> 赞同：2
> 
> 时间：2012-10-25T13:24:46.533
> 
> 标签：opera, opera-dragonfly

Do you know about some way how to save log from Opera Dragonfly console ? I did not find any, neither plugin for that. Thank you.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T14:13:10.550

您可以在opera：config中设置首选项，它位于“用户首选项”下，名为“控制台错误日志已启用”。在这里，您还可以控制保存位置以及 Opera 在保存时将包含哪些类型的错误：opera:config#UserPrefs|ConsoleErrorLog

# java - HL7 CDA Undefined clinical data

> ID：13069621
> 
> 赞同：2
> 
> 时间：2012-10-25T13:24:47.227
> 
> 标签：java, undefined, hl7, medical, cda

I recently started studying [HL7 CDA r2 documents](https://www.projects.openhealthtools.org/sf/sfmain/do/downloadAttachment/projects.mdht/discussion.modeling_users.topc11806/post21022;jsessionid=F61FD76C449F7962A6461B9DECE60ACB?id=atch5088), because I have some clinical data that needs to be as HL7 standards demands.

My doubt is the data I have (Body Mass Index (BMI), Weight, Height,BMI State, Sex, Age, Name ) doesn't fit in any template that CDA has.

**Question:** So, how can I build a CDA document with the data I have??

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T03:24:03.317

生成符合 CDA 的文档的最简单方法是在 Microsoft [HealthVault](http://www.microsoft.com/en-us/healthvault/)上创建一个帐户，输入提供的信息，然后导出为 CCD（通过菜单：健康信息 -> 更多操作 -> 导出信息）。这将为您提供受 CCD 模式约束的符合 CDA 的 XML 文档，您可以在[Things 参考](http://developer.healthvault.com/pages/types/types.aspx?/types/schema.aspx?id=1e1ccbfc-a55d-4d91-8940-fa2fbf73c195)中找到该文档。

CDA 仅描述基于 HL7v3 RIM 的通用 XML 结构。有多种模式（CCD、C32、C80、C83）将这种结构限制为更有用的东西。作为一般规则，说您有一份 CDA 文档并不是很有帮助，因为如果没有进一步的限制，您将无法严格验证或解析数据。有关CDA 和 CCD 之间的区别，请参阅[另一篇文章。](https://stackoverflow.com/questions/10107944/cda-ccd-hl7-version-3)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-04T01:22:29.620

CDA 实施使用实施指南来工作，该指南定义了要包含在特定类型的 CDA 中的数据，以便在特定上下文中使用。您应该使用包含您要建模的数据的其他实施指南（网上有很多，您只需通过谷歌搜索即可找到它们），或者创建自己的实施指南并定义自己的模板（我倾向于在几乎每时间给我的客户，因为他们需要对非常具体的临床数据进行建模）。

# c++ - C 语言中的信任区域反射算法库

> ID：13069627
> 
> 赞同：0
> 
> 时间：2012-10-25T13:24:56.507
> 
> 标签：c++, c, matlab, mathematical-optimization

我正在尝试在 C 中重建一些使用 fsolve 函数的 Matlab 代码。从文档来看，它使用了“信任区域反射”算法（我已经使用 Levenberg-marquardt 算法构建了它，它的收敛方式完全不同）。任何人都可以推荐一个在 C/C++ 中进行这种优化的库吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T13:42:38.337

不确定在“信任区域”定义中添加了什么“反射”。然而，[Knitro](http://www.ziena.com/knitro.html)是一个强大的信任域内点优化器，具有 C/C++ 接口。不幸的是，*Knitro*仅面向学生免费提供限量版。完整版需要商业许可证。

还有[Ipopt](https://projects.coin-or.org/Ipopt)，它*不是*信任区域，但仍然是一个强大的基于 C/C++ 的大规模非线性约束优化引擎，具有开源许可证。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-26T11:32:54.870

您是否尝试过检查您的函数是否是凸函数，如果 LM 和其他一些凸优化算法收敛不同，则基函数很可能不是凸函数。您还检查了成本函数是否至少为 2 阶。如果是这种情况，则最小化成本函数的平方可能比单独最小化成本函数更好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-25T17:43:04.123

有两种通用算法可以**保证全局收敛**（在标准假设下，不要问:)）。这些方法是线搜索和信任区域方法。[如果您愿意，您可以在Nocedal-Wright：数值优化](http://scholar.google.com/scholar?cluster=1428830653259556280&hl=en&as_sdt=0,5)一书中阅读更多关于此主题的信息。

我最近没有尝试过 Knitro。

[Ipopt](https://projects.coin-or.org/Ipopt)是我尝试过的最强大的求解器，我强烈推荐它。它实现了线搜索方法，并用 C++ 编写。

# javascript - jEditable 提交 onBlur 使用 ALT+TAB 失败

> ID：13069631
> 
> 赞同：0
> 
> 时间：2012-10-25T13:25:02.073
> 
> 标签：javascript, browser, submit, jeditable, onblur

我让 jEditable 可以很好地使用 textarea 来编辑对象内的内容。我正在使用 jEditable 的 onblur 选项直接将 onBlur 提交给函数（而不是 url），并且所有工作都按预期工作，除非您使用例如 alt+tab 更改窗口。当我使用 alt+tab 时，看起来内容是通过实际的 http 请求提交的，而忽略了我的回调函数。

我非常基本的示例实现如下所示：

```
$(".editable").editable(function(content,settings){
        content = content.replace(/\n/gi,"<br />");
        return content;
    },{
    data: function(value, settings) {
        return value.replace(/<br[\s\/]?>/gi, '\n');
    },
    type: "textarea",
    onblur: "submit"
});​ 
```

你可以在这里测试它：http: [//jsfiddle.net/xmajox/wePp5/](http://jsfiddle.net/xmajox/wePp5/)

我已经尝试过所有其他窗口操作：调整大小、移动等，甚至在浏览器上的选项卡之间移动都效果很好（提交数据并退出编辑模式）。

关于如何驯服它的任何想法？

更新：经过更多测试和其他人的一些合作，这似乎取决于操作系统（窗口管理器？）。它在统一的 ubuntu 12.10 上始终如一地发生，但在 mac 或 windows 上没有发生（尚未测试其他 linux 机器）。

此外，现在证明当我使用 alt-tab 时我的回调方法确实运行，但之后表单还是会被 POST。添加实时 preventDefault 似乎没有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T15:04:28.333

找到了解决方法，但不太明白为什么会在这种特定情况下发生。

首先，我必须是世界上（不）最幸运的人，因为我已经尝试了 10 次其他组合并且没有这个问题，我唯一能做到的地方是：

```
 Ubuntu 12.10 (with Unity) and Chrome (v22 at the time of this post) 
```

免责声明：这并不意味着它不会在其他地方发生，我只是无法在我测试的那些（或请朋友测试）上重现它。

**问题：** 当焦点丢失时，jEditable - 从版本 1.7.1 开始 - 在实际执行任何操作之前设置超时（默认为 200 毫秒），以根据源中的注释防止重复操作。如果您（使用上述浏览器/操作系统组合）在触发超时之前（也就是在提交数据并运行您的方法之前）将 alt+tab 退出浏览器窗口，它将强制使用数据进行 POST 请求，完全忽略preventDefaults 或返回 false。*如果你按下 alt 就不会出现这个问题...保持按下状态（超过 200 毫秒，即有足够的时间触发超时），然后按下 alt 移开。*

**解决方案：** 我编辑了 jEditable 的源代码以减少超时（甚至删除它）。所以我在第 280 行附近，上面写着：

```
(...)
    input.blur(function(e) {
         // prevent double submit if submit was clicked 
         t = setTimeout(function() {
              form.submit();
         }, 200);
    });
(...) 
```

我将其更改为：

```
(...)
    input.blur(function(e) {
        form.submit();
    });
(...) 
```

**注意：** 我删除了这个，因为在我的情况下（仅在模糊上提交 textareas 并且没有任何其他允许用户提交数据的控件）我无法重现 Mika Tuupola 在评论中提到的双重提交问题。如果您有文本输入字段（按 Enter 键提交）且提交 onBlur 处于活动状态，您可能会陷入这种情况。在这些情况下，我建议您减少超时或干脆避免使用 onBlur 提交。

# python - Python 守护进程和 systemd 服务

> ID：13069634
> 
> 赞同：82
> 
> 时间：2012-10-25T13:25:10.247
> 
> 标签：python, python-daemon, systemd

我有一个简单的 Python 脚本作为守护进程工作。我正在尝试创建 systemd 脚本以便能够在启动期间启动此脚本。

当前的 systemd 脚本：

```
[Unit]
Description=Text
After=syslog.target

[Service]
Type=forking
User=node
Group=node
WorkingDirectory=/home/node/Node/
PIDFile=/var/run/zebra.pid
ExecStart=/home/node/Node/node.py

[Install]
WantedBy=multi-user.target 
```

节点.py：

```
if __name__ == '__main__':
    with daemon.DaemonContext():
        check = Node()
        check.run() 
```

`run`包含`while True`循环。

我尝试使用`systemctl start zebra-node.service`. 不幸的是，服务从未完成说明序列 - 我必须按 Ctrl+C。脚本正在运行，但状态为激活，一段时间后变为停用。现在我正在使用 python-daemon （但在我尝试不使用它并且症状相似之前）。

我应该为我的脚本实现一些附加功能还是 systemd 文件不正确？

* * *

## 回答 #1

> 赞同：123
> 
> 时间：2015-05-12T11:29:02.770

它没有完成启动顺序的原因是，对于 Type，`forking`您的启动过程预计会分叉并退出（请参阅 $ man systemd.service - 搜索分叉）。

# 只使用主进程，不要守护进程

一种选择是少做。使用 systemd，通常不需要创建守护进程，您可以直接运行代码而无需守护进程。

```
#!/usr/bin/python -u
from somewhere import Node
check = Node()
check.run() 
```

这允许使用更简单的服务类型称为`simple`，因此您的单元文件看起来像。

```
[Unit]
Description=Simplified simple zebra service
After=syslog.target

[Service]
Type=simple
User=node
Group=node
WorkingDirectory=/home/node/Node/
ExecStart=/home/node/Node/node.py
StandardOutput=syslog
StandardError=syslog

[Install]
WantedBy=multi-user.target 
```

请注意，`-u`python shebang 不是必需的，但如果您将某些内容打印到 stdout 或 stderr，请`-u`确保没有输出缓冲到位，并且打印的行将立即被 systemd 捕获并记录在日志中。没有它，它会出现一些延迟。

为此，我在单元文件中添加了行`StandardOutput=syslog`和`StandardError=syslog`. 如果您不关心日记中的打印输出，请不要关心这些行（它们不必存在）。

## `systemd`使守护进程过时

虽然您的问题的标题明确询问了守护进程，但我想，问题的核心是“如何使我的服务运行”，而**使用主进程似乎要简单得多**（您根本不必关心守护进程），它可以考虑回答你的问题。

我认为，很多人使用守护进程只是因为“每个人都这样做”。使用 systemd 守护进程的原因通常是过时的。使用守护进程可能有一些原因，但现在这种情况很少见。

编辑：固定`python -p`到适当的`python -u`. 谢谢kmftzg

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2014-01-27T18:28:31.097

可以像 Schnouki 和 Amit 描述的那样进行守护进程。但是对于 systemd，这不是必需的。有两种更好的方式来初始化守护进程：socket-activation 和使用 sd_notify() 的显式通知。

套接字激活适用于希望在网络端口或 UNIX 套接字或类似端口上侦听的守护进程。Systemd 将打开套接字，侦听它，然后在连接进入时生成守护进程。这是首选方法，因为它为管理员提供了最大的灵活性。[1] 和 [2] 给出了很好的介绍，[3] 描述了 C API，而 [4] 描述了 Python API。

[1] [http://0pointer.de/blog/projects/socket-activation.html](http://0pointer.de/blog/projects/socket-activation.html)
[2] [http://0pointer.de/blog/projects/socket-activation2.html](http://0pointer.de/blog/projects/socket-activation2.html)
[3] [http://www.freedesktop .org/software/systemd/man/sd_listen_fds.html](http://www.freedesktop.org/software/systemd/man/sd_listen_fds.html)
[4] [http://www.freedesktop.org/software/systemd/python-systemd/daemon.html#systemd.daemon.listen_fds](http://www.freedesktop.org/software/systemd/python-systemd/daemon.html#systemd.daemon.listen_fds)

显式通知意味着守护程序自己打开套接字和/或进行任何其他初始化，然后通知 init 它已准备好并可以为请求提供服务。这可以通过“分叉协议”来实现，但实际上最好使用 sd_notify() 向 systemd 发送通知。Python 包装器称为 systemd.daemon.notify 并且将是使用 [5] 的一行。

[5] [http://www.freedesktop.org/software/systemd/python-systemd/daemon.html#systemd.daemon.notify](http://www.freedesktop.org/software/systemd/python-systemd/daemon.html#systemd.daemon.notify)

在这种情况下，单元文件将具有 Type=notify，并在建立套接字后调用 systemd.daemon.notify("READY=1")。不需要分叉或守护进程。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2012-10-26T07:25:18.240

您没有创建 PID 文件。

systemd 希望您的程序将其 PID 写入`/var/run/zebra.pid`. 如果您不这样做，systemd 可能会认为您的程序失败，因此将其停用。

要添加 PID 文件，请安装[lockfile](http://pypi.python.org/pypi/lockfile/)并将您的代码更改为：

```
import daemon
import daemon.pidlockfile 

pidfile = daemon.pidlockfile.PIDLockFile("/var/run/zebra.pid")
with daemon.DaemonContext(pidfile=pidfile):
    check = Node()
    check.run() 
```

（快速说明：最近的一些更新`lockfile`更改了它的 API 并使其与 python-daemon 不兼容。要修复它，请编辑`daemon/pidlockfile.py`，`LinkFileLock`从导入中删除，然后添加`from lockfile.linklockfile import LinkLockFile as LinkFileLock`。）

注意另一件事：`DaemonContext`将程序的工作目录更改为`/`，使`WorkingDirectory`您的服务文件无用。如果要`DaemonContext`chdir 进入另一个目录，请使用`DaemonContext(pidfile=pidfile, working_directory="/path/to/dir")`.

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-07-25T02:57:30.447

此外，您很可能需要`daemon_context=True`在创建`DaemonContext()`.

这是因为，如果`python-daemon`检测到它是否在 init 系统下运行，它不会与父进程分离。`systemd`期望运行的守护进程`Type=forking`会这样做。因此，您需要它，否则`systemd`将继续等待，最后终止该进程。

如果你好奇，在`python-daemon`的 daemon 模块中，你会看到这段代码：

```
def is_detach_process_context_required():
    """ Determine whether detaching process context is required.

        Return ``True`` if the process environment indicates the
        process is already detached:

        * Process was started by `init`; or

        * Process was started by `inetd`.

        """
    result = True
    if is_process_started_by_init() or is_process_started_by_superserver():
        result = False 
```

希望这能更好地解释。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2017-02-08T14:07:07.620

我在 CentOS 7 下尝试将一些 python init.d 服务转换为 systemd 时遇到了这个问题。这对我来说似乎很管用，把这个文件放在`/etc/systemd/system/`：

```
[Unit]
Description=manages worker instances as a service
After=multi-user.target

[Service]
Type=idle
User=node
ExecStart=/usr/bin/python /path/to/your/module.py
Restart=always
TimeoutStartSec=10
RestartSec=10

[Install]
WantedBy=multi-user.target 
```

然后我删除了旧的 init.d 服务文件`/etc/init.d`并运行`sudo systemctl daemon-reload`以重新加载 systemd。

我希望我的服务自动重启，因此有重启选项。我还发现使用`idle`for`Type`比`simple`.

> idle 的行为与 simple 非常相似；但是，服务二进制文件的实际执行会延迟，直到所有活动作业都被调度。这可用于避免 shell 服务的输出与控制台上的状态输出交错。

[有关我在此处](https://www.freedesktop.org/software/systemd/man/systemd.service.html)使用的选项的更多详细信息。

我还尝试保留旧服务并让 systemd 重新启动服务，但我遇到了一些问题。

```
[Unit]
# Added this to the above
#SourcePath=/etc/init.d/old-service 

[Service]
# Replace the ExecStart from above with these
#ExecStart=/etc/init.d/old-service start
#ExecStop=/etc/init.d/old-service stop 
```

我遇到的问题是，如果两者的名称相同，则使用 init.d 服务脚本而不是 systemd 服务。如果你杀死了 init.d 启动的进程，systemd 脚本就会接管。但如果你运行`service <service-name> stop`它，它将引用旧的 init.d 服务。所以我发现最好的方法是删除旧的 init.d 服务，而 service 命令引用 systemd 服务。

希望这可以帮助！

# ruby - Visual TCL，如何安装使用？

> ID：13069641
> 
> 赞同：1
> 
> 时间：2012-10-25T13:25:27.500
> 
> 标签：ruby, windows, user-interface, tcl, tk

我是 tk gui 编程的新手，我已经搜索了 TK gui 构建器 FOR WINDOWS 平台，我发现的最新程序是“Visual TCL”，但是在 WINDOWS 上安装它后，我得到一个充满 tcl 文件的文件夹。 .但是程序的任何exe ......所以我现在需要做什么才能运行它？？？

我已经阅读了自述文件，它说需要将 tcl 文件与“Wish”应用程序相关联...¿？我在谷歌上搜索过这个“愿望”应用程序，但是......什么都没有。

顺便说一句，如果你能推荐我一个好的 tk 8.5 的 gui 构建器（对于 Ruby，在 Windows 上），那么请......

但问题是我想要一个功能强大的新编辑器从这个开始，这就是为什么我选择“Visual TCL”（最后更新于 2012 年）的原因，我不想要一个旧的和废弃的应用程序，例如“ guibuilder”来自“活动状态”...或 tkbuilder...

谢谢你的阅读。PS：对不起我的英语

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T12:21:41.693

您应该在这里选择 vTcl_1.6.1a1 ..

[http://sourceforge.net/projects/vtcl/files/vtcl/1.6.1.a1/](http://sourceforge.net/projects/vtcl/files/vtcl/1.6.1.a1/)

并下载软件包。虽然它位于**.tar.gz**中，这是一个 Linux 可以理解的包文件，但您可以使用 WinZip 打开它。如果您已安装 WinZip，请尝试使用 WinZip 打开此文件（它会要求您通过其经典视图打开 - 单击确定）并将其内容**提取**到您想要的文件夹中。

**根文件夹中的vtcl.tcl**文件是您需要运行的主文件。

但在此之前，您应该在**ActiveState Tcl**的某个位置安装 Tcl/Tk 最新版本。这将自动将所有**.tcl**文件扩展名与**Wish Application**关联。

在单击**vtcl.tcl**之前，进入名为**lib**的文件夹并使用任何文本编辑器打开文件**tkcon.tcl 。**替换行（出现在第一个**if**条件中）

**包需要 -exact Tk $tcl_version**

至

**包需要 Tk $tcl_version**

保存并关闭它。

现在运行**vtcl.tcl**并享受使用这种强大的基于字符串的脚本语言。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T16:24:09.557

[对于 Windows，从http://www.activestate.com/activetcl](http://www.activestate.com/activetcl)安装 ActiveTcl

# c# - 包含 html 的格式字符串

> ID：13069642
> 
> 赞同：0
> 
> 时间：2012-10-25T13:25:30.417
> 
> 标签：c#, asp.net-mvc, razor

我有一个简单的字符串变量，其中包含一部分 HTML。例如：

```
string contents = "<div><p>Hi how are you. <a href="#">Click here</a> if you want to know more"; 
```

我想在页面中包含这个 HTML：

```
<div class="description">
    @contents
</div> 
```

但是，由于未关闭的标签，它会弄乱页面的其余部分。

是否有一个函数（或帮助程序）可以读取和格式化内部的 HTML，例如，完成 HTML 而不会出错：

```
@Html.DisplayProperHTML(contents) 
```

这将呈现为：

```
<div><p>Hi how are you. <a href="#">Click here</a> if you want to know more</p></div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T13:26:53.473

没有内置这样的功能。

您可以使用 HTML Agility Pack 来解析和修复损坏的 HTML。

# facebook - 在 Facebook 应用程序中使用 Google 字体

> ID：13069645
> 
> 赞同：3
> 
> 时间：2012-10-25T13:25:46.300
> 
> 标签：facebook, facebook-apps, google-font-api

尝试在 Facebook 应用程序中使用 Google Fonts Api 时，我度过了一段不愉快的时光。

*它适用*于我在 Facebook**之外**的应用程序，但是当我**在 Facebook 应用程序**中时，字体*不起作用*。

我以这种方式包含字体：

```
<link href='http://fonts.googleapis.com/css?family=Convergence|Satisfy' rel='stylesheet' type='text/css'/> 
```

如果需要，我很乐意提供更多信息。提前感谢您的时间和帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-25T13:28:43.803

You would need to change

```
<link href='http://fonts.googleapis.com/css?family=Convergence|Satisfy' rel='stylesheet' type='text/css'/> 
```

to

```
<link href='//fonts.googleapis.com/css?family=Convergence|Satisfy' rel='stylesheet' type='text/css'/> 
```

Facebook block external http resources.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-07-22T20:22:49.920

您也可以省略链接的协议部分：

```
<link href='//fonts.googleapis.com/css?family=Convergence|Satisfy' rel='stylesheet' type='text/css'/> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-15T14:25:10.993

问题出在http协议中。Facebook 应用程序不会加载任何不安全的资源 - 即未通过 https 链接。我遇到了同样的问题，将协议前缀更改为“https”有效。

# sql - 每天选择 50 个随机文件

> ID：13069649
> 
> 赞同：2
> 
> 时间：2012-10-25T13:26:00.353
> 
> 标签：sql, sql-server, tsql

自 2012 年 10 月 1 日以来，我每天尝试选择 50 个随机文件。例如：

*   10 月 1 日 = 50 个文件
*   10 月 2 日 = 50 个文件
*   10 月 3 日 = 50 个文件
*   等等……今天

到目前为止，我每天可以选择 1 个文件，但我需要 50 个。而且我需要它们是随机的

```
DECLARE @DaysBack AS INT
SET @DaysBack = -25

    SET NOCOUNT ON;

    SELECT FileDate, MAX(FileName)  FROM (
    SELECT 
    CONVERT(VARCHAR(10),DATEADD(second,actiondate, CAST('1970-01-01 00:00:00' AS datetime)), 101) AS FileDate

    ,'\\directory\' + filename AS FileName
    FROM   Tableq q
    JOIN tablec c
    on  q.projectid = c.projectid
           AND actiondate >= Datediff(s, '19700101 00:00:00:000',
                             Dateadd(DAY, @DaysBack, Getutcdate()))

    ) x

    GROUP BY FileDate
    ORDER  BY FileDate 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T13:33:02.963

我目前无权访问 SQL Server 实例（或 SQL Fiddle）。但这应该给每个 actiondate 一个随机的 id ...

*   `ROW_NUMBER() OVER (PARTITION BY actiondate ORDER BY NEWID())`

这意味着以下将在每个 actiondate 中随机选择 50 个项目...

```
DECLARE @DaysBack AS INT
SET @DaysBack = -25

SET NOCOUNT ON;

SELECT
  FileDate, FileName
FROM
(
  SELECT 
    DATEADD(DAY, actiondate / 86400, '19700101') AS FileDate,
    '\\\\directory\\' + filename AS FileName,
    ROW_NUMBER() OVER (PARTITION BY actiondate / 86400 ORDER BY NEWID()) AS random_daily_id
FROM
  Tableq q
JOIN
  tablec c
    ON  q.projectid = c.projectid
    AND actiondate >= Datediff(s, '19700101', Dateadd(DAY, @DaysBack, Getutcdate()))
) x
WHERE
  random_daily_id <= 50
ORDER BY
  FileDate 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T13:34:27.810

假设您使用的是 SQL Server 2005 或更高版本，您可以使用排名函数来执行此操作：

```
SELECT FileDate, MAX(FileName)
FROM (select x.*,
             ROW_NUMBER() over (partition by FileDate order by newid()) as seqnum
      from (SELECT CONVERT(VARCHAR(10),DATEADD(second,actiondate, CAST('1970-01-01 00:00:00' AS datetime)), 101
                          ) AS FileDate,
                   '\\directory\' + filename AS FileName
            FROM   Tableq q JOIN
                   tablec c
                   on  q.projectid = c.projectid and
                       actiondate >= Datediff(s, '19700101 00:00:00:000',
                                     Dateadd(DAY, @DaysBack, Getutcdate()))
           ) x
     ) x
where seqnum <= 50
ORDER  BY FileDate 
```

这用于`row_number()`为每个日期的文件添加一个序列号，编号随机分配。然后它会为每个日期选择前 50 名。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T13:35:35.533

我**强烈**建议您不要实施任何随机提取数据库端。我在一个项目中也有类似的需求，但最终我将随机化逻辑移到了业务端。

# javascript - 如何更新数组值javascript？

> ID：13069654
> 
> 赞同：13
> 
> 时间：2012-10-25T13:26:03.613
> 
> 标签：javascript, jquery

我在 javacsript 中有一个包含 3 个 keyValue 构造函数对象的数组：

```
 function keyValue(key, value){
    this.Key = key;
    this.Value = value;
  };

  var array = [];
  array.push(new keyValue("a","1"),new keyValue("b","2"),new keyValue("c","3")); 
```

我还有一个函数“更新”，它获取`keyValue object as parameter`并更新数组中该对象的值：

```
 function Update(keyValue, newKey, newValue)
  {
    //Now my question comes here, i got keyValue object here which i have to 
    //update in the array i know 1 way to do this 

    var index = array.indexOf(keyValue);
    array[index].Key = newKey;
    array[index].Value = newValue; 
  } 
```

但如果有的话，我想要一种更好的方法来做到这一点。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-10-25T13:28:28.483

> *“但我想知道一种更好的方法来做到这一点，如果有的话？”*

是的，由于您似乎已经拥有原始对象，因此没有理由再次从 Array 中获取它。

```
 function Update(keyValue, newKey, newValue)
  {
    keyValue.Key = newKey;
    keyValue.Value = newValue; 
  } 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-10-25T13:31:24.177

为什么不使用对象¹？

```
var dict = { "a": 1, "b": 2, "c": 3 }; 
```

然后你可以像这样更新它

```
dict.a = 23; 
```

或者

```
dict["a"] = 23; 
```

如果你不想删除²个特定的键，它很简单：

```
delete dict.a; 
```

[¹[有关键/值对，](https://stackoverflow.com/questions/688097/objects-vs-arrays-in-javascript-for-key-value-pairs)请参阅Javascript 中的对象与数组。
²见[`delete`](https://stackoverflow.com/questions/688097/objects-vs-arrays-in-javascript-for-key-value-pairs)操作员。]

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-10-25T13:32:18.683

```
function Update(key, value)
{    
    for (var i = 0; i < array.length; i++) {
        if (array[i].Key == key) {
            array[i].Value = value; 
            break;
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-10-25T13:35:02.803

怎么样;

```
function keyValue(key, value){
    this.Key = key;
    this.Value = value;
};
keyValue.prototype.updateTo = function(newKey, newValue) {
    this.Key = newKey;
    this.Value = newValue;  
};

array[1].updateTo("xxx", "999"); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2020-04-08T18:19:01.753

如果要重新分配数组中的元素，可以执行以下操作：

```
var blah = ['Jan', 'Fed', 'Apr'];

console.log(blah);

function reassign(array, index, newValue) {
    array[index] = newValue;
    return array;
}

reassign(blah, [2], 'Mar'); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-11-06T16:48:03.747

所以我有一个需要解决的问题。我有一个带有值的数组对象。如果值 == XI 需要将 X 值更新为 Y 值，我需要更新其中一个值。在这里查看示例，它们都不适合我需要或想要的。我终于想出了一个简单的解决问题的方法，实际上很惊讶它的工作原理。现在通常我喜欢将完整的代码解决方案放入这些答案中，但由于它的复杂性，我不会在这里这样做。如果有人发现他们无法使此解决方案工作或需要更多代码，请告诉我，我将尝试在以后更新此解决方案以提供帮助。在大多数情况下，如果数组对象具有命名值，则此解决方案应该可以工作。

```
 $scope.model.ticketsArr.forEach(function (Ticket) {
                if (Ticket.AppointmentType == 'CRASH_TECH_SUPPORT') {
                    Ticket.AppointmentType = '360_SUPPORT'
                }
            }); 
```

> 下面的完整示例 _____________________________________________________

```
 var Students = [
        { ID: 1, FName: "Ajay", LName: "Test1", Age: 20 },
        { ID: 2, FName: "Jack", LName: "Test2", Age: 21 },
        { ID: 3, FName: "John", LName: "Test3", age: 22 },
        { ID: 4, FName: "Steve", LName: "Test4", Age: 22 }
    ]

    Students.forEach(function (Student) {
        if (Student.LName == 'Test1') {
            Student.LName = 'Smith'
        }
        if (Student.LName == 'Test2') {
            Student.LName = 'Black'
        }
    });

    Students.forEach(function (Student) {
        document.write(Student.FName + " " + Student.LName + "<BR>");
    }); 
```

# ios - SQLite 路径 iOS

> ID：13069655
> 
> 赞同：0
> 
> 时间：2012-10-25T13:26:06.150
> 
> 标签：ios, sqlite, select

我正在尝试使用以下代码访问我的 SQLite 中的表：

```
fileMgr = [NSFileManager defaultManager];
    NSString *dbPath = [[[NSBundle mainBundle] resourcePath ]stringByAppendingPathComponent:@"movieData.sqlite"];

    if(sqlite3_open([dbPath UTF8String], &database) == SQLITE_OK){

        const char *sql = "SELECT movieName FROM myMovies";
        sqlite3_stmt *sqlStatement;
        if(sqlite3_prepare(db, sql, -1, &sqlStatement, NULL) != SQLITE_OK)
        {
            NSLog(@"Problem with prepare statement");
        } 
```

我的输出是“准备语句的问题”。我很确定我的表名和 *sql 中的其他内容。但还是不行。有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T14:47:32.600

添加

```
BOOL success = [fileMgr fileExistsAtPath:dbPath];
    if(!success)
    {
        NSLog(@"Cannot locate database file '%@'.", dbPath);
    }
    if(!(sqlite3_open([dbPath UTF8String], &db) == SQLITE_OK))
    {
        NSLog(@"An error has occured.");
    } 
```

就在之前`cont char *sql`，现在正在工作:)

# node.js - socket.io、节点集群、express、带 redis 的会话存储

> ID：13069659
> 
> 赞同：1
> 
> 时间：2012-10-25T13:26:17.497
> 
> 标签：node.js, express, websocket, redis, socket.io

我不确定如何描述这一点，但我正在运行一个节点应用程序，该应用程序在 4 核、端口 80 上运行一个集群，使用 RedisStore 作为 socket.io 存储、express.js 和 socket.io 监听它。

发生的一些有趣的行为是，在大约 40% 使用 Chrome（和 Firefox，但我们不再使用不同的浏览器，因为它似乎是全面的）连接到 socket.io 的客户端上，它首先连接并运行良好25-30 秒，然后有 60 秒的死区时间，从客户端发送请求但服务器没有接收或确认，并且在 1.5 分钟 - 1.6 分钟，客户端启动新的 websocket 连接。有时，新的 websocket 连接具有相同的行为，有时连接“捕获”并在接下来的几个小时内持续存在并且绝对没问题。

有趣的是，这种行为不会发生在我们运行在不同端口（也使用集群）上的测试服务器上；而且它不会发生在我们的任何本地开发服务器上（其中一些实现了集群，而另一些则没有）。

有任何想法吗？

# mouseenter - 在 VML 地图中的状态上悬停时，MouseEnter 事件不会间歇性触发

> ID：13069662
> 
> 赞同：2
> 
> 时间：2012-10-25T13:26:25.363
> 
> 标签：mouseenter, vml

我有一个像这样的 VML 地图：

（使用的结构示例）

```
<div class="map" jQuery1351170963063="74">
<div class="usmap" jQuery1351170963063="75">
<group class="g vg" style="visibility: visible;" jQuery1351170258860="79" height="256px" width="434px" coordsize="21600,21600">
<shape class="vmap" id="Maryland_md" jQuery1351170258860="105"/>
<shape class="vmap" id="Delaware_de" jQuery1351170258860="104"/>
<shape class="vmap" id="Alaska_ak" jQuery1351170258860="94">
</group>
</div>
</div> 
```

在 IE7 和 IE8 上，有时当鼠标悬停在形状节点上时不会触发 mouseenter 事件。

JS代码：

```
var $canvas = $(".usmap", $this);
var $canvasParent = $canvas.parent();
var mouseenterEvent = "mouseenter";
var mouseleaveEvent = "mouseleave";

$(".g", $canvas).delegate(element, mouseenterEvent + " " + mouseleaveEvent, onMouseEnterVMLShape)
                .add($canvas).add($keys).add($canvasParent).mouseleave(onMouseLeaveVMLShape); 
```

# iphone - plist 文本中的项目符号

> ID：13069664
> 
> 赞同：0
> 
> 时间：2012-10-25T13:26:40.680
> 
> 标签：iphone, ios, ipad, nsstring, plist

我有一个包含大量文本的 plist 文件。在文本中间，我必须添加项目符号。有没有办法在文本中添加项目符号，如 unicode character 2022 和 plist 将在 iPad 应用程序中使用？

我搜索了这个但没有找到任何解决方案。要求立即为我提供答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T13:35:22.447

在 mac 中你可以写 - **bullets = ALT + ***

# mysql - Grails 应用程序似乎持有对陈旧数据库连接的引用

> ID：13069668
> 
> 赞同：3
> 
> 时间：2012-10-25T13:26:52.350
> 
> 标签：mysql, hibernate, grails, jdbc, apache-commons-dbcp

**更新：Rackspace 已经回复我并告诉我他们的 MySQL 云使用了`wait_timeout`120 秒的值**

我一直在反对这个，所以我想我会问你们。您可能有的任何想法将不胜感激

```
util.JDBCExceptionReporter  - SQL Error: 0, SQLState: 08S01
util.JDBCExceptionReporter  - Communications link failure
The last packet successfully received from the server was 264,736 milliseconds 
ago. The last packet sent successfully to the server was 32 milliseconds ago. 
```

该错误间歇性发生，通常在相关服务器启动后几分钟。数据库在负载或连接方面远不及容量，我尝试了数十种不同的配置组合。

这个连接最后一次收到来自服务器的数据包是在 264 秒前，这一事实说明了这一点，因为它远高于 Rackspace 设置的 120 秒超时。我还从数据库端确认我的 30 秒限制得到遵守。

### 我尝试过的事情

*   将 DBCP 设置为在 30 秒后主动过期连接，并验证 MySQL 实例通过以下方式反映了此行为`SELECT * FROM PROCESSLIST`
*   将连接字符串从主机名切换到 IP 地址，因此这不是 DNS 问题
*   各种不同的连接设置组合
*   尝试在 DataSources.groovy 或 resources.groovy 中声明连接池设置，但我相当确定这些设置得到尊重，因为数据库反映了它们：超过 30 秒的任何内容都会很快被杀死

### 有任何想法吗？

现在我最好的猜测是，Grails 中的某些东西在足够长的时间内保持对陈旧连接的引用，以至于 120 秒的限制是有问题的……但这是一个绝望的理论，实际上我怀疑这是真的，但这让我没有想法。

我试过的最新配置：

```
dataSource {
    pooled = true
    driverClassName = "com.mysql.jdbc.Driver"
    dialect = 'org.hibernate.dialect.MySQL5InnoDBDialect'
    properties {
        maxActive = 50
        maxIdle = 20
        minIdle = 5 
        maxWait = 10000
        initialSize = 5
        minEvictableIdleTimeMillis = 1000 * 30
        timeBetweenEvictionRunsMillis = 1000 * 5
        numTestsPerEvictionRun = 50
        testOnBorrow = true
        testWhileIdle = true
        testOnReturn = true
        validationQuery = "SELECT 1"
    }
} 
```

堆栈跟踪：

```
2012-10-25 12:36:12,375 [http-bio-8080-exec-2] WARN  util.JDBCExceptionReporter  - SQL Error: 0, SQLState: 08S01
2012-10-25 12:36:12,375 [http-bio-8080-exec-2] ERROR util.JDBCExceptionReporter  - Communications link failure

The last packet successfully received from the server was 264,736 milliseconds ago.  The last packet sent successfully to the server was 32 milliseconds ago.
2012-10-25 12:36:12,433 [http-bio-8080-exec-2] ERROR errors.GrailsExceptionResolver  - EOFException occurred when processing request: [GET] /cart
Can not read response from server. Expected to read 4 bytes, read 0 bytes before connection was unexpectedly lost.. Stacktrace follows:
org.hibernate.exception.JDBCConnectionException: could not execute query
at grails.orm.HibernateCriteriaBuilder.invokeMethod(HibernateCriteriaBuilder.java:1531)
at SsoRealm.hasRole(SsoRealm.groovy:30)
at org.apache.shiro.grails.RealmWrapper.hasRole(RealmWrapper.groovy:193)
at org.apache.shiro.authz.ModularRealmAuthorizer.hasRole(ModularRealmAuthorizer.java:374)
at org.apache.shiro.mgt.AuthorizingSecurityManager.hasRole(AuthorizingSecurityManager.java:153)
at org.apache.shiro.subject.support.DelegatingSubject.hasRole(DelegatingSubject.java:225)
at ShiroSecurityFilters$_closure1_closure4_closure6.doCall(ShiroSecurityFilters.groovy:98)
at grails.plugin.cache.web.filter.PageFragmentCachingFilter.doFilter(PageFragmentCachingFilter.java:195)
at grails.plugin.cache.web.filter.AbstractFilter.doFilter(AbstractFilter.java:63)
at org.apache.shiro.grails.SavedRequestFilter.doFilter(SavedRequestFilter.java:55)
at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:449)
at org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)
at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)
at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)
at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:380)
at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)
at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)
at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
at java.lang.Thread.run(Thread.java:662)
Caused by: com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure

The last packet successfully received from the server was 264,736 milliseconds ago.  The last packet sent successfully to the server was 32 milliseconds ago.
at com.mysql.jdbc.Util.handleNewInstance(Util.java:411)
at com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:1116)
at com.mysql.jdbc.MysqlIO.reuseAndReadPacket(MysqlIO.java:3589)
at com.mysql.jdbc.MysqlIO.reuseAndReadPacket(MysqlIO.java:3478)
at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:4019)
at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2490)
at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2651)
at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2683)
at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:2144)
at com.mysql.jdbc.PreparedStatement.executeQuery(PreparedStatement.java:2310)
at org.apache.commons.dbcp.DelegatingPreparedStatement.executeQuery(DelegatingPreparedStatement.java:96)
at org.apache.commons.dbcp.DelegatingPreparedStatement.executeQuery(DelegatingPreparedStatement.java:96)
... 20 more
Caused by: java.io.EOFException: Can not read response from server. Expected to read 4 bytes, read 0 bytes before connection was unexpectedly lost.
at com.mysql.jdbc.MysqlIO.readFully(MysqlIO.java:3039)
at com.mysql.jdbc.MysqlIO.reuseAndReadPacket(MysqlIO.java:3489)
... 29 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-17T21:29:36.720

想通了。grails-elasticsearch 插件保留了陈旧的连接。这是该插件中的一个[已知问题，并且](https://github.com/mstein/elasticsearch-grails-plugin/issues/15)[通过此拉取请求进行了修复](https://github.com/mstein/elasticsearch-grails-plugin/pull/44)：

# database - How to dynamically connect to a database

> ID：13069679
> 
> 赞同：1
> 
> 时间：2012-10-25T13:27:38.963
> 
> 标签：database, django, database-connection

I want to connect Django to a database that the user will set in the main page.

The user will have to precise the engine (with a combobox), the database, login, password etc in a form, and I want to proceed the connection with the submit.

So far, I tried to set "`DATABASES = {}`" in *`settings.py`*, but it returns an error.

Have you got any clue about how to do it?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T14:08:03.167

You have to connect your app to a database.

There is no way that I know of to change the database connection dynamically. The only things I can think of are a bit convoluted:

1.  If you want to change your back-end database: I would suggest having a separate setting file for the database (I will call it `dbsettings.py`) that you will include in the settings file. At the submit, you would lunch a script that will change the `dbsettings.py` file, and restart the django server (with a CLI call for example)

2.  If the database is user specific, configure and fire up another django instance, and have the two instances communicate (you could use celery for messaging or django commands)

I (and other people) may come up with better solutions if we had a little more details

# c - How to restart a posix thread from another thread (monitor thread in my case)

> ID：13069680
> 
> 赞同：0
> 
> 时间：2012-10-25T13:27:41.057
> 
> 标签：c, multithreading, posix, deadlock

I am trying to handle a deadlock situation and need to restart a deadlocked thread from the monitor thread by resource pre-emption and rollback strategy for posix threads..Im clueless about how to restart a thread from another thread ,Kindly help!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T13:33:57.750

我不认为“重新启动”是典型线程实现提供的常见且定义明确的操作。我当然没有在 pthreads 中找到任何东西，我假设你正在使用它。

“重启”究竟会涉及什么？它与（以某种方式）销毁/停止线程并使用相同的代码和数据启动一个新线程有何不同？

# android - 如何用字符串数组填充 ListView？

> ID：13069685
> 
> 赞同：10
> 
> 时间：2012-10-25T13:27:57.303
> 
> 标签：android

我想在我的 ListView 中显示这些项目

```
<string-array name="bookmark_titles">
    <item>Google</item>
    <item>Bing</item>
    <item>Gmail</item>
</string-array> 
```

我有一个获取这些值的方法。

```
public static Collection getBookmarks(Context context) {
    Collection bookmarks = new Collection();

    String[] titles  = context.getResources().getStringArray(R.array.bookmark_titles);

    for (int i = 0; i < titles.length; i ++) {
        bookmarks.add(titles[i]);
    }

    return bookmarks;
} 
```

如何在 main.java 中调用 getBookmarks 方法来填充 ListView？

我已经创建了一个 ListView。这是：

```
<ListView
    android:id="@+id/my_listView"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:divider="#ECECEC"
    android:dividerHeight="1sp" /> 
```

main.java 我正在尝试做这样的事情：

```
ListView lv = (ListView) findViewById(R.id.my_listView);

ArrayList<Bookmark> my_array = BookmarkCollection.getTestBookmarks(context);
adapter = new ArrayAdapter(this, android.R.layout.simple_list_item_1, my_array);    
lv.setAdapter(adapter); 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-25T13:31:43.223

您可以使用单线创建适配器，查看静态方法 [ArrayAdapter createFromResource(Context context, int textArrayResId, int textViewResId)](http://developer.android.com/reference/android/widget/ArrayAdapter.html#createFromResource%28android.content.Context,%20int,%20int%29)

第一个参数可能是您的 Activity，第二个是`R.array.bookmark_titles`，第三个是要使用的布局。

为了根据评论进行澄清，该方法 Accept `int`，这正是您生成的`R`类中的常量存储的内容。

这是一个完整的示例，假设这是从 Activity 调用的：

```
ArrayAdapter<CharSequence> aa = ArrayAdapter.createFromResource(this, R.array.bookmark_titles, android.R.layout.simple_list_item_1);
myListView.setAdapter(aa); 
```

In this case, `android.R.layout.simple_list_item_1` refers to an XML layout that is provided by the Android SDK. You can change this if needed.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-25T13:42:07.013

You can do this with an ArrayAdapter and have it use either an Array or a List to give it data

```
lv.setAdatper(new ArrayAdapter<String>(context, R.layout.some_layout_to_use, R.id.some_textview_in_layout, listData); 
```

# ruby - 打开远程图像以在 GD2 上使用

> ID：13069686
> 
> 赞同：0
> 
> 时间：2012-10-25T13:27:59.403
> 
> 标签：ruby, gd

有没有办法“打开”要使用的远程图像[`GD2`](http://gd2.rubyforge.org/)？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T17:01:30.823

开放的方法是下载`tmp`目录中的图像，然后使用`gd2`

在这里，您如何将文件从远程位置下载到`tmp`

```
require "rubygems"
### Method 1
require "net/http"
require "uri"

uri = URI.parse("image path")
http = Net::HTTP.new(uri.host, uri.port)
File.open("/tmp/a_#{Date.now}.png", "wb+") do |file|
  file.write http.get(uri.path)
end

### Method 2

require "open-uri"

File.open("/tmp/a_#{Date.now}.png", "wb+") do |file|
 file.write open("image path").read
end 
```

确保用户有写入`tmp`目录的权限

# asp.net - 为什么我使用 Server.Transfer() 时没有创建 HTTP 标头？

> ID：13069687
> 
> 赞同：3
> 
> 时间：2012-10-25T13:28:00.200
> 
> 标签：asp.net, caching, http-headers, webserver, server.transfer

我正在使用 .aspx 页面根据给定的参数从文件系统中提供图像文件。

```
Server.Transfer(imageFilePath); 
```

当此代码运行时，会提供图像，但不会创建*Last-Modified* HTTP 标头。与同一个文件相反，直接从同一服务器上的 URL 调用。

因此浏览器不会发出*If-Modified-Since*并且不会缓存响应。

有没有办法让服务器像通常直接请求文件（在这种情况下为图像）一样创建 HTTP 标头，还是我必须手动创建标头？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T13:33:38.393

当您对文件进行传输时，服务器将返回与文件相同的标头`.aspx`，因为它基本上是由 .NET 引擎执行的。

你基本上有两个选择：

*   改为重定向到文件，以便浏览器发出请求。

*   设置您想要的标题，并使用`Request.BinaryWrite`（或类似）在响应中将文件数据发送回。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T15:24:05.150

我将扩展@Guffa 的答案并分享我选择的解决方案。

调用该`Server.Transfer`方法时，.NET 引擎将其视为一个`.aspx`页面，因此在提供静态文件时它不会添加所需的适当 HTTP 标头（例如用于缓存）。

有三个选项

*   使用`Response.Redirect`，因此浏览器发出适当的请求
*   设置所需的标题并`Request.BinaryWrite`用于提供内容
*   设置所需的标题并调用`Server.Transfer`

我选择第三个选项，这是我的代码：

```
 try
        {
            DateTime fileLastModified = File.GetLastWriteTimeUtc(MapPath(fileVirtualPath));
            fileLastModified = new DateTime(fileLastModified.Year, fileLastModified.Month, fileLastModified.Day, fileLastModified.Hour, fileLastModified.Minute, fileLastModified.Second);
            if (Request.Headers["If-Modified-Since"] != null)
            {
                DateTime modifiedSince = DateTime.Parse(Request.Headers["If-Modified-Since"]);

                if (modifiedSince.ToUniversalTime() >= fileLastModified)
                {
                    Response.StatusCode = 304;
                    Response.StatusDescription = "Not Modified";
                    return;
                }
            }
            Response.AddHeader("Last-Modified", fileLastModified.ToString("R"));
        }
        catch
        {
            Response.StatusCode = 404;
            Response.StatusDescription = "Not found";
            return;
        }
        Server.Transfer(fileVirtualPath); 
```

# mysql - 如何使用 Hibernate 从 Mysql 获取最后一条记录？

> ID：13069689
> 
> 赞同：14
> 
> 时间：2012-10-25T13:28:10.990
> 
> 标签：mysql, sql, hibernate, hql

```
List<Lahetys> last = session.createQuery("from lahetys order by lahetysNro DESC LIMIT 1").list(); 
```

在我得到的日志中：

```
INFO: Hibernate: select  from order by  lahetysNro DESC LIMIT 1
WARN: SQL Error: 1064, SQLState: 42000
ERROR: You have an error in your SQL syntax; check the manual that corresponds to your       MySQL server version for the right syntax to use near 'from order by  lahetysNro DESC LIMIT 1' at line 1 
```

“来自LAHETYS”发生了什么？使用 HQL 或/和 SQL 处理该问题的最佳实践是什么？

另一个问题：

```
Lahetys last = (Lahetys)session.createSQLQuery("select * from lahetys order by lahetysNro DESC LIMIT 1").uniqueResult();
session.getTransaction().commit(); 
```

我得到一个例外：

```
Ljava.lang.Object; cannot be cast to Lahetys 
```

所以我不能将一个对象投射到我的 Lahetys 对象上，奇怪吗？

谢谢！萨米人

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-10-25T14:13:00.983

您的 HQL 查询无效。LIMIT 不是有效的 HQL 子句。要在 Hibernate 中执行此操作，只需执行

```
Query query = session.createQuery("from lahetys order by lahetysNro DESC");
query.setMaxResults(1);
Lahetys last = (Lahetys) query.uniqueResult(); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-10-25T14:25:19.523

当您使用 HQL 时，您应该指定完全限定的 className 而不是 tableName。同样的方式你应该指定propertyName而不是columnName。还要记住，两者都是区分大小写的。

查看您的查询和遇到的异常，我假设**lahetys**是您的表名，**而 lahetysNro**是您的列名。

您应该使用例如：如果您的**Lahetys**类位于`com`文件夹中：

```
List<Lahetys> last = session.createQuery("from com.Lahetys order by lahetysNro DESC LIMIT 1").list(); 
```

对于你的第二个问题：

在这里，您使用了 SQL 而不是 HQL。当您以这种方式将 SQL 与 hibernate 一起使用时，它总是返回`List<Object[]>`& not `List<Lahetys[]>`。

# rally - How to delete Rally workspacepermission using REST API?

> ID：13069691
> 
> 赞同：0
> 
> 时间：2012-10-25T13:28:21.080
> 
> 标签：rally

Can anybody please explain how to pass reference strings for Delete actions of WorkspacePermission? I tried below,

`DeleteRequest delete = new DeleteRequest("/workspacepermission/9250166251u2788951014w1.js"); where

Workspacepermission id= 9250166251 User Object id= u2788951014 workspace number= w1`

Can anyone tell me how to pass them correctly?

Thanks!!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T16:38:42.933

Sharat，很好地找到了模式的问题。我已经与 Rally 开发人员进行了交谈，并继续在公共 Github 存储库上打开了 Java RestApi 的问题：

[https://github.com/RallyTools/RallyRestToolkitForJava/issues/5](https://github.com/RallyTools/RallyRestToolkitForJava/issues/5)

您可以在那里跟踪解决方案 - 可能很快就会推出新版本的 jar。

# php - CodeIgniter 在 404 页面上显示访问的路由/翻译的控制器

> ID：13069694
> 
> 赞同：1
> 
> 时间：2012-10-25T13:28:25.183
> 
> 标签：php, codeigniter, codeigniter-2, codeigniter-url, codeigniter-routing

现在，当 CodeIgniter 没有找到路由的控制器或 uri 的路由时，它会显示一个通用的 404 页面。如何显示访问的路由或控制器或一些有用的东西，可以让我调试为什么它显示 404？

代码：

```
switch ($_SERVER['HTTP_HOST']) {
    case 'multiplelines.domain.ro': 
             $route['default_controller'] = "subdomain"; break;
    default: $route['default_controller'] = "welcome"; break;
}

$route['scaffolding_trigger'] = "";
$route['404_override'] = '';
if($_SERVER['HTTP_HOST'] == "www.domain.ro" 
   || $_SERVER['HTTP_HOST'] == "domain.ro")
{
  // URI like '/en/about' -> use controller 'about'
  $route['^(romana|english|magyar)/(.+)$'] = "$2";

  // '/en', '/de', '/fr' and '/nl' URIs -> use default controller
  $route['^(romana|english|magyar)$'] = $route['default_controller'];
}
else
{

} 
```

期望的效果：当在 www 或空子域路由会像这样发生：/language/test 将转到测试控制器

当在另一个子域（我只列出一个案例）上时，将路由到子域控制器，因为我只想为这些子域使用一个控制器。

注意：现在，当在 www 或空子域上时，有代码可以自动为测试控制器的 /test 路由选择语言（uri 中没有语言目录）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T13:33:02.197

当 CI 找不到页面的正确路由时，它知道没有这样的页面，所以它给出 404 NOT EXISTING..

如果用户尝试在您的站点上打开 /sgasgasggsasga 页面，它会出于同样的原因得到 404..

你必须自己找出为什么它显示404......

查看[http://codeigniter.com/user_guide/general/routing.html](http://codeigniter.com/user_guide/general/routing.html)寻求帮助:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T15:00:52.203

在您的应用程序上启用[错误日志记录](http://codeigniter.com/user_guide/general/errors.html)。

然后，一旦您查找错误，您将看到生成 404 错误的请求的 URI。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T06:41:00.610

在计算机上会正确填写答案，但请查看[Debugging routes in codeigniter？](https://stackoverflow.com/questions/12446184/debugging-routes-in-codeigniter)它有路由记录

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-03-06T13:01:23.097

> 如何显示访问的路由或控制器或一些有用的东西，可以让我调试为什么它显示 404？

您可以在 404 视图中回显 $_SERVER['REQUEST_URI'] 以确定用户试图去哪里。

# git - .gitignore syntax issue

> ID：13069704
> 
> 赞同：2
> 
> 时间：2012-10-25T13:28:48.133
> 
> 标签：git, gitignore

I have a given `extension` directory containing plenty of other directories. Among those plenty, one particular named `important` that I want to be staged by git. The others I don't. So I created a `.gitignore` file within my `extension` directory with the following content:

```
*
!README
!.gitignore
!important/** 
```

My goal was saying to Git:

*   ignore everything in this directory
*   but keep the README file
*   and also keep the .gitignore file
*   and please, do keep also the `important` directory

But this is not working, only `README` and `.gitignore` are kept. The syntax seems the right one to me so... I do not know where I am wrong.

Any suggestion is most welcomed.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T13:33:16.550

您不需要`**`递归地通过目录。

```
*
!README
!.gitignore
!important/ 
```

看看这个答案[Make .gitignore 忽略除少数文件之外的所有内容](https://stackoverflow.com/questions/987142/make-gitignore-ignore-everything-except-a-few-files)

# c# - C#，用韩文字符串处理

> ID：13069707
> 
> 赞同：0
> 
> 时间：2012-10-25T13:28:59.087
> 
> 标签：c#, encoding

我有应用程序在 facebook API 中读取位置的 json 我尝试在韩国读取位置 json 中的字符串是：

> "名称": "\uc9c0\uc9c0\ud5a5",

我得到的结果：

> 项目[“名称”].ToString() = [][][][]

我怎样才能正确编码？

我试过了：

```
 Encoding korenEncoding = Encoding.GetEncoding(50225);
byte[] convertedToUtf8 = Encoding.Convert(korenEncoding,Encoding.UTF8,korenEncoding.GetBytes(Item["name"].ToString()));
string name = Encoding.UTF8.GetString(convertedToUtf8); 
```

而且没用，谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T14:17:35.787

你用什么来反序列化json？我试过了`System.Runtime.Serialization.Json`，它可以正确解码。还要确保您的数据库列支持 unicode 数据

```
[DataContract]
class thinger
{
    [DataMember]
    public string name;
}

string snip = @"{""name"": ""\uc9c0\uc9c0\ud5a5""}";
Byte[] bytes = Encoding.Unicode.GetBytes(snip);
MemoryStream jsonstream = new MemoryStream(bytes);
jsonstream.Write(bytes, 0, bytes.Length);
jsonstream.Seek(0, SeekOrigin.Begin);

DataContractJsonSerializer ser = new DataContractJsonSerializer(typeof(thinger));
thinger output = (thinger)ser.ReadObject(jsonstream);

//output.name = 지지향 
```

# batch-file - .bat file to rename and move files with prompt

> ID：13069708
> 
> 赞同：0
> 
> 时间：2012-10-25T13:29:01.297
> 
> 标签：batch-file

I am completely new to this, but I am trying to create a *`.bat`* file that will allow me to rename a pair of files within a designated folder and move them into a subfolder. The part I am having trouble with is that I am wanting a prompt to come up to identify/select the files to be renamed and moved.

Example file names are:

```
A1234, A1235, A1236, B1234, B1235, B1236, etc. 
```

Is there a way to bring up a prompt that allows the user to type the shared name (ex 1234)of the files and rename and move both files to the designated subfolder?

Any and all help would be appreciated!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T13:58:12.980

建议的方法

对于部分问题

> `part I am having trouble with is that I am wanting a prompt to come up to identify/select the files to be renamed and moved. Is there a way to bring up a prompt that allows the user to type the shared name (ex 1234)of the files and rename and move both files to the designated subfolder?`

使用搜索操作`wildcard`，就像`"?1234"`上面突出显示的情况一样（应该对所有可接受和预期的模式进行概括，这`"*1234*"`是最通用的）

现在对搜索得到的结果做一个`RENAME`内部循环。`For`

正如您建议您是 Batch 的新手，以下教程将帮助您构建文件。寻找类似的元素`Variables`，`For Loop`

[批处理教程](https://cs.senecac.on.ca/~albert.pang/ios100/dosbatch.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T14:53:47.343

干得好

```
@echo off
set /p file=Please type shared name: 
for %%a in (C:\Folder\?%file%.*) do (
move "%%a" subdir
ren "subdir\%%a" newname.*
) 
```

# wcf - 没有监听 WCF AuthenticationService 的端点

> ID：13069711
> 
> 赞同：0
> 
> 时间：2012-10-25T13:29:13.513
> 
> 标签：wcf, windows-phone-7, ssl, wcf-ria-services, wcf-security

我正在尝试使用托管在 IIS 7 中的 AuthenticationService WCF 对从 windows phone 7 登录的 用户**进行****身份****验证**。

 *****我在没有 SSL 的情况下尝试了它并且工作正常。但我想将其转换为 https。*

我得到的错误是当我从我的 WP7 模拟器中调用这个 WCF 时：

```
"EndpointNotFoundException" 
```

但是我的 web.config 有以下详细信息：

```
<system.serviceModel>
   <services>
     <service name="System.Web.ApplicationServices.AuthenticationService" 
    behaviorConfiguration="AuthenticationServiceTypeBehaviors">
       <endpoint contract="System.Web.ApplicationServices.AuthenticationService"  
         binding="basicHttpBinding"
         bindingConfiguration="userHttps" address="https://localhost:700/AuthenticationService.svc"
         bindingNamespace="http://asp.net/ApplicationServices/v200"/>
       <endpoint address="mex" 
      binding="mexHttpsBinding"
      contract="IMetadataExchange" /> 
     </service>

   </services>
   <bindings>
     <basicHttpBinding>
       <binding name="userHttps">
         <security mode="Transport">
           <transport clientCredentialType="None" />
         </security>
       </binding>
     </basicHttpBinding>
   </bindings>
   <behaviors>
     <serviceBehaviors>
       <behavior name="AuthenticationServiceTypeBehaviors" >
         <serviceMetadata httpsGetEnabled="true" />
         <serviceDebug includeExceptionDetailInFaults="true"  />
       </behavior>

     </serviceBehaviors>

   </behaviors>
   <serviceHostingEnvironment
     aspNetCompatibilityEnabled="true"/>
 </system.serviceModel> 
```

使用：AspNetSqlMembershipProvider，我避免使用这些细节来说明这一点。

在我的 IIS 7 中，我创建了一个应用程序池并将一个自签名证书关联到托管的 WCF，并在 SSL 设置选项中设置为“需要 SSL - 已选择”和“忽略客户端证书 - 已选中”

我可以浏览到`https://localhost:700/AuthenticationService.svc.`

我可以将其添加为手机中的服务参考，但是当我调用登录方法时，它会显示错误。

我已经指定了端点地址，即使这样它也显示错误。

谁能解释我如何调试它以获取更多详细信息或任何解决“通过 SSL 使用身份验证服务 WCF”的指针

**编辑 1**当我尝试通过浏览器访问服务时，我尝试使用 IP 地址和 svc URL

```
svcutil.exe https://mcname.domain.local:700/AuthenticationService.svc?wsdl 
```

**编辑 2**尝试禁用防病毒和防火墙，但仍然没有运气。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T23:21:27.927

根据@Rajesh 的评论，我在手机中安装了证书并开始工作。

我尝试了所有导出 .CER、.PFX 和 .P7B 格式的选项，只有 P7B 格式对我有用，才能将其安装在手机中。

使用 SSL 启用 AuthenticationService WCF 的 web.config 文件部分是

```
 <services>
          <service behaviorConfiguration="AppServiceBehaviors" name="System.Web.ApplicationServices.AuthenticationService">
            <endpoint binding="basicHttpBinding" bindingConfiguration="defaultBasicHttpBinding"
              bindingNamespace="http://asp.net/ApplicationServices/v200" contract="System.Web.ApplicationServices.AuthenticationService" />
          </service>

        </services>
        <behaviors>
          <serviceBehaviors>
            <behavior name="AppServiceBehaviors">
              <serviceMetadata httpsGetEnabled="true" />
              <serviceDebug includeExceptionDetailInFaults="true" />
            </behavior>
            <behavior name="">
              <serviceMetadata httpsGetEnabled="true" />
              <serviceDebug includeExceptionDetailInFaults="true" />
            </behavior>
          </serviceBehaviors>
        </behaviors>
        <serviceHostingEnvironment aspNetCompatibilityEnabled="true"
          multipleSiteBindingsEnabled="true" />
      </system.serviceModel>

      <system.web.extensions>
        <scripting>
          <webServices>
            <authenticationService enabled="true" requireSSL="true"/> 
```

使其工作的步骤：http: [//blogs.msdn.com/b/davidhardin/archive/2010/12/30/wp7-and-self-signed-ssl-certificates.aspx](http://blogs.msdn.com/b/davidhardin/archive/2010/12/30/wp7-and-self-signed-ssl-certificates.aspx)

*   主机名必须可由 http 代理通过 DNS、WINS、主机文件等解析。
*   SSL 证书的名称必须与主机名匹配。
*   受信任的根证书必须与 http
    代理一起安装，即在手机上。

将证书安装到 WP7 模拟器手机上是最棘手的部分。如前所述，P7B 文件托管在 IIS 上，并且通过模拟器浏览器访问 URL，这有助于我在手机上安装证书（对不​​起！我忘记了参考链接）。

安装后，端点问题消失并开始工作。由于这不是一个永久的解决方案（因为每次关闭模拟器时都需要重新安装 CERT），所以我正在处理[http://wp7certinstaller.codeplex.com/](http://wp7certinstaller.codeplex.com/)代码以使其在 IIS 中托管以进行测试时工作。

感谢@Rajesh 的帮助。****

# c# - Load large image with memory efficiency

> ID：13069713
> 
> 赞同：0
> 
> 时间：2012-10-25T13:29:24.730
> 
> 标签：c#, .net, image, memory

I am using .NET4.5, Windows Forms and C#.

I am loading an image onto a button using:

```
theButton.BackgroundImage = Image.FromFile("file.png"); 
```

The issue is that my button is 128x128 and the image is 4000x8000\. The line above consumes very large amounts of memory because file.png is so large.

Does anyone know of a technique I can use to reduce this memory footprint? I am thinking of some function like this:

```
Image.FromFile(file,width,height); 
```

Any pointers? Thanks.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T14:04:53.580

是的，它有效。调整图像大小然后将其显示在按钮上非常简单。

但是，我不认为上面的代码保持了图像的纵横比。

使用纵横比调整图像大小非常简单；然后显示在按钮上。下面是示例代码，可帮助您通过保持纵横比来调整图像大小。您可以定义一个新类或在现有类中实现“ResizeImage”方法。哪个对你来说舒服。

```
public class ImageManipulation
{
    public static Bitmap ResizeImage(Bitmap originalBitmap, int newWidth, int maxHeight, bool onlyResizeIfWider)
    {
        if (onlyResizeIfWider)
        {
            if (originalBitmap.Width <= newWidth)
            {
                newWidth = originalBitmap.Width;
            }
        }

        int newHeight = originalBitmap.Height * newWidth / originalBitmap.Width;
        if (newHeight > maxHeight)
        {
            // Resize with height instead
            newWidth = originalBitmap.Width * maxHeight / originalBitmap.Height;
            newHeight = maxHeight;
        }

        var alteredImage = new Bitmap(originalBitmap, new Size(newWidth, newHeight));
        alteredImage.SetResolution(72, 72);
        return alteredImage;
    }
} 
```

用法：

```
private void DisplayPhoto()
{
    // make sure the file is JPEG or GIF
                System.IO.FileInfo testFile = new System.IO.FileInfo(myFile);

    // Create a new stream to load this photo into
                FileStream myFileStream = new FileStream(myFile, FileMode.Open, FileAccess.Read);

    // Create a buffer to hold the stream of bytes
                photo = new byte[myFileStream.Length];
                // Read the bytes from this stream and put it into the image buffer
                myStream.Read(photo, 0, (int)myFileStream.Length);
                // Close the stream
                myFileStream.Close();

    // Create a new MemoryStream and write all the information from
            // the byte array into the stream
            MemoryStream myStream = new MemoryStream(photo, true);
            myStream.Write(photo, 0, photo.Length);

            // Use the MemoryStream to create the new BitMap object
            Bitmap FinalImage = new Bitmap(myStream);
            upicPhoto.Image = ImageManipulation.ResizeImage(
                                                FinalImage,
                                                upicPhoto.Width,
                                                upicPhoto.Height,
                                                true);

            // Close the stream
            myStream.Close();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T13:35:53.773

我认为您最好的方法是将图像大小调整为 128x128。一个大的图像总是会占用大量的内存，无论你用它做什么。

这也将允许您制作在该尺寸下看起来不错的图像。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T13:37:03.287

这是一个相当普遍的问题，AFAIK你几乎没有可能性

1.  在上传之前压缩图像，在现实世界中这是行不通的。
2.  检查图像的大小和尺寸，在现实世界中它可以工作，即使是linkedin、facebook，它们也不允许我们上传超过指定尺寸的图像。
3.  使用缓冲，这是您可以在 .net 中执行的最干净的方法
4.  使用一些第三方插件或开发环境，我在 Silverlight 中做过

# winapi - Letting the mouse pass through Windows C++

> ID：13069717
> 
> 赞同：9
> 
> 时间：2012-10-25T13:29:46.460
> 
> 标签：winapi, mouse, gdi, pass-through

I am working on an Win32 C++ application where I want to ignore the mouse events and let is pass through to the window beneath my window. Basically the window below mine will handle the mouse event. I would prefer not to send the mouse message using SendMessage to the window beneath mine or use SetCapture. Is there a way basically to ignore the mouse event and let it pass through with Windows APIs or with styles? Note that my window is not transparent.

Thanks in advance for the help.

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2018-05-09T04:26:11.193

因此，我在尝试创建一个在屏幕上覆盖图形显示而不影响任何其他交互（包括例如拖动窗口）的音乐播放器时发现了这个问题和其他问题。

我已经尝试了这两种`WM_NCHITTEST`方法，以及简单地添加`WS_EX_TRANSPARENT`到我的窗口中。这些方法都不起作用——它们似乎都捕获了鼠标单击事件，这是我不想要的。

但是，纯属巧合，我确实设法找到了可以传递给它的标志组合，`SetWindowLong(..., GWL_EXSTYLE, ...)`这似乎可以解决问题，导致以下代码：

```
LONG cur_style = GetWindowLong(hwnd, GWL_EXSTYLE);
SetWindowLong(hwnd, GWL_EXSTYLE, cur_style | WS_EX_TRANSPARENT | WS_EX_LAYERED); 
```

似乎[这里](https://msdn.microsoft.com/en-us/library/windows/desktop/ms632599(v=vs.85).aspx#layered "分层窗口的 MSDN 文档")记录了这种行为：

> 分层窗口的命中测试基于窗口的形状和透明度。这意味着窗口的颜色键或 alpha 值为零的区域将让鼠标消息通过。但是，如果分层窗口具有 WS_EX_TRANSPARENT 扩展窗口样式，分层窗口的形状将被忽略，鼠标事件将传递给分层窗口下的其他窗口。

扩展的[窗口样式文档](https://msdn.microsoft.com/en-us/library/windows/desktop/ff700543(v=vs.85).aspx "扩展窗口样式的 MSDN 文档")也非常有用。对于像我这样的应用程序，窗口不应该与之交互，`WS_EX_NOACTIVATE`也可能很有用，因为它可以防止一些用户交互。

为了子孙后代，我会注意到我用来确保我的窗口始终位于顶部的代码如下：

```
SetWindowPos(hwnd, HWND_TOPMOST, 0, 0, 0, 0, SWP_NOMOVE | SWP_NOSIZE); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T14:28:58.793

我一直在通过 2 个不同的 3rd 方使用 2 个不同的 RDC 解决方案对此进行测试。每个解决方案可能会以不同的方式创建自己的窗口，具有不同的样式等。如果我在 WindowProc 中执行以下操作：

```
 case WM_MOUSEMOVE:
    {   
        std::cout << "WM_MOUSEMOVE" << std::endl;
        VideoWindowWin32* window = reinterpret_cast<VideoWindowWin32*> (GetWindowLongPtr (hWnd, GWL_USERDATA));
        if (window)
        {               
            HWND rParent = GetParent(window->window);
            SetCapture(window->parent);
            //SendMessage(window->parent, uMsg, wParam, lParam);
        }
    }
    break; 
```

一切都适用于其中之一。但它不适合另一个。

如果您有什么建议，我将不胜感激。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-25T16:51:09.280

我会尝试处理[WM_NCHITTEST](http://msdn.microsoft.com/en-us/library/windows/desktop/ms645618%28v=vs.85%29.aspx)并返回`HTNOWHERE`.

我相信使用 WS_EX_TRANSPARENT 的方法会产生其他副作用，并且仅在底层窗口由同一线程拥有时才有用。从这个问题来看，不清楚底层窗口是同一应用程序的一部分还是下面的任何旧应用程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-11-12T16:59:59.573

基于 Adrian McCarthy，但实际上对我有用（尽管仅当父窗口拥有子窗口时，否则窗口将再次捕获鼠标）：

```
case WM_NCHITTEST: return HTTRANSPARENT; 
```

`HTNOWHERE`只是导致该窗口的 LoadCursor() 不再显示。

这些值似乎是可能的：

```
#ifndef NONCMESSAGES

/*
 * WM_NCHITTEST and MOUSEHOOKSTRUCT Mouse Position Codes
 */
#define HTERROR             (-2)
#define HTTRANSPARENT       (-1)
#define HTNOWHERE           0
#define HTCLIENT            1
#define HTCAPTION           2
#define HTSYSMENU           3
#define HTGROWBOX           4
#define HTSIZE              HTGROWBOX
#define HTMENU              5
#define HTHSCROLL           6
#define HTVSCROLL           7
#define HTMINBUTTON         8
#define HTMAXBUTTON         9
#define HTLEFT              10
#define HTRIGHT             11
#define HTTOP               12
#define HTTOPLEFT           13
#define HTTOPRIGHT          14
#define HTBOTTOM            15
#define HTBOTTOMLEFT        16
#define HTBOTTOMRIGHT       17
#define HTBORDER            18
#define HTREDUCE            HTMINBUTTON
#define HTZOOM              HTMAXBUTTON
#define HTSIZEFIRST         HTLEFT
#define HTSIZELAST          HTBOTTOMRIGHT
#if(WINVER >= 0x0400)
#define HTOBJECT            19
#define HTCLOSE             20
#define HTHELP              21
#endif /* WINVER >= 0x0400 */

/*
 * SendMessageTimeout values
 */
#define SMTO_NORMAL         0x0000
#define SMTO_BLOCK          0x0001
#define SMTO_ABORTIFHUNG    0x0002
#if(WINVER >= 0x0500)
#define SMTO_NOTIMEOUTIFNOTHUNG 0x0008
#endif /* WINVER >= 0x0500 */
#if(WINVER >= 0x0600)
#define SMTO_ERRORONEXIT    0x0020
#endif /* WINVER >= 0x0600 */
#if(WINVER >= 0x0602)
#endif /* WINVER >= 0x0602 */

#endif /* !NONCMESSAGES */ 
```

# grails - 3,Mapping column named 'interface' in Grails seems impossible

> ID：13069718
> 
> 赞同：0
> 
> 时间：2012-10-25T13:29:52.990
> 
> 标签：grails, grails-orm, grails-domain-class

It seems that it is impossible with Grails to map a domain class to a database table that has is a foreign key column named 'interface'. In my case there's a relationship with two tables INTERFACE and INTERFACE_DETAILS. They are legacy databases and column names can not be changed or added.

Put it simple INTERFACE_DETAILS has an FK column 'INTERFACE' referring to PK INTERFACE.ID

```
class Interface {
    String id;  

    static mapping = {
        table "INTERFACE"
        version false
        id generator: 'assigned'
        id column: 'id', sqlType:"varchar2(20)"
    }

class InterfaceDetails {

    Interface iface;    
    static belongsTo = [iface: Interface]

    static mapping = {
        table "INTERFACE_DETAILS"
        version false        
        id column: 'interface'
        iface column: 'INTERFACE', sqlType:"varchar2(20)", insertable: false, updateable: false
    }
} 
```

I'm currently using H2 database. When I try to add a row to InterfaceDetails this error occurs:

> Referential integrity constraint violation: "FK351396597E3917F9: PUBLIC.INTERFACE_DETAILS FOREIGN KEY(INTERFACE) REFERENCES PUBLIC.INTERFACE(ID)"; SQL statement: insert into INTERFACE_DETAILS (interface) values (null) [23506-164]

I wonder why hibernate adds null for 'interface' value ?

I do have to have line : "id column: 'interface'" because in other case Hibernate will generate an extra column: "iface_id" and this is not suitable. Existing database columns can not be changed.

This is quite puzzling. Please tell me that Grails can handle this situation.

stripped down schema:

```
create table interface (id varchar2(20) not null,primary key (id));
create table interface_details (interface varchar2(20) not null, name varchar(255) not null, primary key (interface));
alter table interface_details add constraint FK_INTERFACE foreign key (interface) references interface; 
```

# parsing - 轻松将 Key=Value 对的字符串解析为 Scala 案例类

> ID：13069721
> 
> 赞同：7
> 
> 时间：2012-10-25T13:30:00.540
> 
> 标签：parsing, scala, key-value, case-class

有什么方法可以轻松地将一串键值对解析为 scala 案例类？

例如来自以下字符串：

```
"consumer_key=1234ABC, consumer_secret=12345ABC" 
```

进入

```
case class Auth(consumerKey: String, consumerSecret: String) 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-25T14:02:27.310

您可以使用正则表达式和模式匹配：

```
scala> val R = "consumer_key=(.*), consumer_secret=(.*)".r
R: scala.util.matching.Regex = consumer_key=(.*), consumer_secret=(.*)

scala> "consumer_key=1234ABC, consumer_secret=12345ABC" match {
     |   case R(k, v) => Auth(k, v)
     | }
res0: Auth = Auth(1234ABC,12345ABC) 
```

用于`JavaTokenParsers`更灵活的解析：

```
import scala.util.parsing.combinator._

case class Auth( consumerKey: String, consumerSecret: Option[String])

class AuthParser extends JavaTokenParsers {
  def auth: Parser[Auth] = key ~ opt("," ~> secret) ^^ { case k ~ s => Auth(k, s)}
  def key: Parser[String] = value("consumer_key")
  def secret: Parser[String] = value("consumer_secret")
  def value(k: String): Parser[String] = k ~ "=" ~> "[^,]*".r
  def apply(s: String) = parseAll(auth, s)
} 
```

用法：

```
scala> val p = new AuthParser
p: AuthParser = AuthParser@433b9799

scala> p("consumer_key=1234ABC, consumer_secret=12345ABC").get
res0: Auth = Auth(1234ABC,Some(12345ABC))

scala> p("consumer_key=1234ABC").get
res1: Auth = Auth(1234ABC,None) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T07:12:52.150

我喜欢 scala Parsers 库，但它有点慢。如果你的字符串看起来都是这样，你可以很容易地做到：

```
case class Auth( consumerKey:String, consumerSecret:String)
object Auth {
  def fromString(string: String): Seq[Auth] = string.split(", ").toSeq map { pair =>
    val lst = pair.split("=")
    Auth(lst(0), lst(1))
  }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-04-06T20:13:06.143

开始`Scala 2.13`，如果您期望的模式足够简单，则可以通过[取消应用字符串插值器](https://www.scala-lang.org/files/archive/api/2.13.x/scala/StringContext$s$.html#unapplySeq(s:String):Option[Seq[String]])来匹配它：

```
// case class Auth(consumerKey: String, consumerSecret: String)
"consumer_key=1234ABC, consumer_secret=12345ABC" match {
  case s"consumer_key=$key, consumer_secret=$secret" => Auth(key, secret)
}
// Auth("1234ABC", "12345ABC") 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-29T02:02:40.280

我同意 nnythm 但该解决方案不能解决问题。这可能会更好：

```
case class Auth( consumerKey:String, consumerSecret:String)
object Auth {
  def fromString(s: String): Auth = {
    val p = s.split(", ").toSeq.map { pair => {
        val lst = pair.split("=")
        (lst(0), lst(1))
    }}.toMap
    Auth(p("consumer_key"), p("consumer_secret"))
  }
} 
```

这有一个额外的好处，就是能够拥有一个包含任意数量的键值对的字符串，并且您可以轻松地更改您选择使用的字符串。

# css - 输入文本显示在下一行

> ID：13069723
> 
> 赞同：0
> 
> 时间：2012-10-25T13:30:06.220
> 
> 标签：css

在[http://www.bigbasket.com](http://www.bigbasket.com)上，如果是 IE9，“数量”的输入将出现在下一行。它适用于 IE7/8、FF 和 Chrome。但由于某种原因，它在 IE9 上崩溃了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T13:35:01.477

问题可能是您没有正确使用标签。标签应包含文本“数量”，输入不应在标签内。例如

```
<label for="p10000159_qty">Qty:</label>
<input id="p10000159_qty" class="qtyTxtField" name="pqty" maxLength="2" value="1" type="text"> 
```

**如果您将宽度减小**3px**`.qtyTextField`或将`margin-left:3px`. 它正在转移到下一行，因为该行没有足够的空间供 IE 使用。**

# java - ToggleButton function is notchecked is not work

> ID：13069725
> 
> 赞同：1
> 
> 时间：2012-10-25T13:30:20.560
> 
> 标签：java, android

i have ToggleButton that do 2 function if it checked it will insert item in database mysql if not it will delete item from mysql the first function is work but the second is not it say that

```
10-25 16:14:05.618: D/Delete student In manage(401): {"message":"No student found","success":0} 
```

and i am sure about that the student is fund because i insert it before when i click check for the ToggleButton

```
toggle.setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener() {

                    public void onCheckedChanged(CompoundButton buttonView,
                            boolean isChecked) {
                        if (isChecked) {
                            // absent
                            id = student.get(holder.position)
                                    .get(TAG_StudentID);
                            new ManageAttendance().execute();

                        } else {
                            id = student.get(holder.position)
                                    .get(TAG_StudentID);
                            new DeleteInManage().execute();

                        }
                    }
                }); 
```

the whole code

```
public class MyCustomAdapter extends ArrayAdapter<HashMap<String, String>> {

    JSONParser jsonParser = new JSONParser();

    private static String url_delete_in_manage = "http://10.0.2.2/SmsPhp/delete_in_manage.php";
@Override
    public View getView(int position, View convertView, ViewGroup parent) {

        final ViewHolder holder;
        if (convertView == null) {
            LayoutInflater mInflater = (LayoutInflater) context
                    .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            convertView = mInflater.inflate(resource, parent, false);
            holder = new ViewHolder();
            convertView.setTag(holder);

        } else {
            holder = (ViewHolder) convertView.getTag();
        }
        holder.position = position;

        holder.toggle
                .setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener() {

                    public void onCheckedChanged(CompoundButton buttonView,
                            boolean isChecked) {
                        if (isChecked) {
                            // absent
                            id = student.get(holder.position)
                                    .get(TAG_StudentID);
                            new ManageAttendance().execute();

                        } else {
                            id = student.get(holder.position)
                                    .get(TAG_StudentID);
                            new DeleteInManage().execute();

                        }
                    }
                });

        return convertView;

    }

    private static class ViewHolder {

        ToggleButton toggle;
    }

    /*****************************************************************
     * Background Async Task to Delete student

    /*****************************************************************
     * Background Async Task to Delete student
     * */
    class DeleteInManage extends AsyncTask<String, String, String> {

        protected String doInBackground(String... args) {
            final Calendar c = Calendar.getInstance();
            mYear = c.get(Calendar.YEAR);
            mMonth = c.get(Calendar.MONTH);
            mDay = c.get(Calendar.DAY_OF_MONTH);
            Date = mYear + "-" + mMonth + "-" + mDay;

            c1 = "77";
        Status ="A";
            // Check for success tag
            int success;
            try {
                // Building Parameters
                List<NameValuePair> params = new ArrayList<NameValuePair>();
                params.add(new BasicNameValuePair("StudentID", id));
                params.add(new BasicNameValuePair("Date", Date));
                params.add(new BasicNameValuePair("SectionID", c1));
                params.add(new BasicNameValuePair("Status", Status));

                // getting student details by making HTTP request
                JSONObject json = jsonParser.makeHttpRequest(
                        url_delete_in_manage, "POST", params);

                // check your log for json response
                Log.d("Delete student In manage ", json.toString());

                // json success tag
                success = json.getInt(TAG_SUCCESS);
                if (success == 1) {
                    // student successfully deleted

                }

            } catch (JSONException e) {

                e.printStackTrace();
            }

            return null;
        }

    }

} 
```

the php code that call when it want to delete

```
<?php

/*
 * Following code will delete a student from table
 * A student is identified by student id 
 */
// array for JSON response
$response = array();

// check for required fields
if (isset($_POST['StudentID']) && isset($_POST['Date']) && isset($_POST['SectionID']) && isset($_POST['Status']))
 {
    $StudentID = $_POST['StudentID'];
      $Date = $_POST['Date'];
        $SectionID = $_POST['SectionID'];
           $Status  = $_POST['Status'];

    // include db connect class
    require_once __DIR__ . '/db_connect.php';
    // connecting to db
    $db = new DB_CONNECT();

    // mysql update row with matched pid
    $result = mysql_query("DELETE FROM attends WHERE StudentID = $StudentID && Date=$Date && SectionID=$SectionID && Status =$Status " );

    // check if row deleted or not
    if (mysql_affected_rows() > 0) 
    {
        // successfully updated 
        $response["success"] = 1;
        $response["message"] = " student successfully deleted";

        // echoing JSON response
        echo json_encode($response);
    } else
    {
        // no Section found
        $response["success"] = 0;
        $response["message"] = "No student found";

        // echo no users JSON
        echo json_encode($response);
    }
} else {
    // required field is missing
    $response["success"] = 0;
    $response["message"] = "Required field(s) is missing";

    // echoing JSON response
    echo json_encode($response);
}
?> 
```

can you help me to solve it

# java - 如何使用 EntityReferences 将内容插入 DOM 文档？

> ID：13069726
> 
> 赞同：2
> 
> 时间：2012-10-25T13:30:26.180
> 
> 标签：java, html

我在 Java 中使用 org.w3c.dom.Document 并插入 EntityReference 节点。这些添加正常，但被 javax.xml.transform.Transformer 删除。这段代码解释了我的意思：

```
 DOMImplementation dmi = DOMImplementationRegistry.newInstance().getDOMImplementation("");
    Document doc = dmi.createDocument(null, "html", null);
    doc.getDocumentElement().appendChild(doc.createTextNode("AT"));
    doc.getDocumentElement().appendChild(doc.createEntityReference("amp"));
    doc.getDocumentElement().appendChild(doc.createTextNode("T"));
    Transformer tr = TransformerFactory.newInstance().newTransformer();
    tr.setOutputProperty(OutputKeys.METHOD, "html");
    tr.transform(new DOMSource(doc), new StreamResult(System.out)); 
```

这个的输出是

```
<html>ATT</html> 
```

而且我要

```
<html>AT&amp;T</html> 
```

我知道如果我`doc.createTextNode("AT&T")`直接这样做，它会为我逃脱“&”，所以我正在寻找一种方法

*   保留我的 EntityReferences，或
*   让我查找定义的实体，或者
*   填写实体的文本作为 EntityReference 的子项。

我必须处理实体引用名称，因为我必须实现一个看起来像

```
interface Xxx {
 void addText(String text);
 void addEntity(String entName);
 ...
} 
```

# jaxb - 编组为 XML/JSON 时是否可以使用 Jersey/JAX-RS 注释跳过类成员？

> ID：13069729
> 
> 赞同：23
> 
> 时间：2012-10-25T13:30:39.987
> 
> 标签：jaxb, jersey, jax-rs

很直接的问题。我正在使用 Jersey 来构建一个 REST 系统。如果我有一个类，其值在处理期间需要使用，但不想在编组类时作为 XML 或 JSON 输出的一部分发送，有没有办法忽略它？就像是：

```
@XmlRootElement(name="example")
class Example {
    private int a;
    private String b;
    private Object c;

    @XmlElement(ignore=true)
    public int getA() { return a; }
    @XmlElement
    public String getB() { return b; }
    @Ignore
    public Object getC() { return c; }
    ... //setters, constructors, etc.
} 
```

我希望像`ignore=true`over`getA()`或`@Ignore`over之类的东西`getC()`会起作用，但我找不到任何文档。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-10-25T13:43:40.737

根据您要忽略的字段/属性的数量，有几个选项。

**选项1 -`@XmlTransient`**

如果您希望忽略不到一半的属性，那么我建议使用`@XmlTransient`. 这会将它们从 XML 映射中排除。

```
@XmlRootElement
class Example {
    private int a;
    private String b;
    private Object c;

    @XmlTransient
    public int getA() { return a; } // UNMAPPED

    public String getB() { return b; } // MAPPED

    @XmlTransient    
    public Object getC() { return c; } // UNMAPPED

    ... //setters, constructors, etc.
} 
```

**选项 #2 -`@XmlAccessorType(XmlAccessType.NONE)`**

如果您希望忽略一半以上的属性，我建议`@XmlAccessorType`在类型级别使用注释来设置`XmlAccessType.NONE`。这将导致只有带注释的属性被映射到 XML。

```
@XmlRootElement
@XmlAccessorType(XmlAccessType.NONE)
class Example {
    private int a;
    private String b;
    private Object c;

    public int getA() { return a; } // UNMAPPED

    @XmlElement
    public String getB() { return b; } // MAPPED

    public Object getC() { return c; } // UNMAPPED

    ... //setters, constructors, etc.
} 
```

**了解更多信息**

*   [http://blog.bdoughan.com/2012/04/jaxb-and-unmapped-properties.html](http://blog.bdoughan.com/2012/04/jaxb-and-unmapped-properties.html)

# java - Textalignment 在 java swing jTextPane 中不起作用

> ID：13069730
> 
> 赞同：3
> 
> 时间：2012-10-25T13:30:49.373
> 
> 标签：java, swing, text, styles, jtextpane

我想在同一行对齐两段文本：第一段应对齐到左侧，另一段应对齐到 java swing JTextPane 的右侧。我尝试使用样式界面和 Styleconstants 类来对齐文本，但没有奏效。但是当我在同一文本上应用其他一些样式时，例如**Styleconstants.setFontSize()、Styleconstants.setForeGroundColor()**，它工作正常。

这是我的代码：

```
JTextPane pane = new JTextPane();
StyledDocument sdoc = pane.getStyledDocument();
SimpleAttributeSet rightAlign = new SimpleAttributeSet();
StyleConstants.setAlignment(rightAlign, StyleConstants.ALIGN_RIGHT);
StyleConstants.setForeground(rightAlign, Color.lightGray);
StyleConstants.setFontSize(rightAlign, 11);
sdoc.insertString(sdoc.getLength(), "name", null);
sdoc.insertString(sdoc.getLength(), "timeHis" + "\n", rightAlign); 
```

它给出了类似的输出

**命名时间他的**

但我想要这样的输出

**命名**                                                     **时间他的**

（在同一行的 JTextpane 中正好相反）

我的代码有什么问题吗？我怎么解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T14:02:50.200

我认为您不能为*同一行设置**两种不同*的对齐方式（AFAIK，即使在专业的文本编辑器中您也无法做到这一点 -*只需设置对齐方式*）。我像这样重写了你的代码：

 **```
 SimpleAttributeSet rightAlign = new SimpleAttributeSet();
    SimpleAttributeSet leftAlign = new SimpleAttributeSet();

    StyleConstants.setAlignment(rightAlign, StyleConstants.ALIGN_RIGHT);
    StyleConstants.setForeground(rightAlign, Color.lightGray);
    StyleConstants.setFontSize(rightAlign, 11);

    StyleConstants.setAlignment(leftAlign, StyleConstants.ALIGN_LEFT);
    StyleConstants.setForeground(leftAlign, Color.black);
    StyleConstants.setFontSize(leftAlign, 13);

    String left = "name";
    String right = "timeHis\n";

    sdoc.insertString(0, left, leftAlign);
    sdoc.insertString(left.length(), right, rightAlign);

    sdoc.setParagraphAttributes(0, left.length(), leftAlign, false);               
    sdoc.setParagraphAttributes(left.length()+1, sdoc.getLength()-1-left.length(), rightAlign, false); 
```

大小和颜色都可以，但两个字符串的对齐方式都是正确的。如果你像这样在最后两行交换对齐：

```
 sdoc.setParagraphAttributes(0, left.length(),  rightAlign, false);               
    sdoc.setParagraphAttributes(left.length()+1, sdoc.getLength()-1-left.length(),leftAlign, false); 
```

两者都将左对齐，但如果您在左字符串中添加新行：

```
String left = "name\n"; 
```

对齐也变得很荣幸。[setParagraphAttributes](http://docs.oracle.com/javase/6/docs/api/javax/swing/text/StyledDocument.html#setParagraphAttributes%28int,%20int,%20javax.swing.text.AttributeSet,%20boolean%29)方法完全按照它所说的去做——关键是对齐是一个段落[属性](http://en.wikipedia.org/wiki/Paragraph#Paragraph_breaks)——打开 OO Writer 或 MS Word(pad)，写一些文本并对齐它——它会更清晰。

当我想在 MS Word/OO Writer 中实现该对齐时，我制作了一个带有不可见边框的表格，并将左列设置为左对齐，将右列设置为右对齐。这将得出结论，我们需要实现[StyledDocument 接口的 HTMLDocument（因为您可以在 HTML 中制作](http://docs.oracle.com/javase/6/docs/api/javax/swing/text/StyledDocument.html)[表格](http://www.w3schools.com/html/html_tables.asp)）类。所以我尝试了这个：

```
JTextPane pane = new JTextPane(new HTMLDocument()); 
```

这导致没有风格。这是有道理的，因为[层叠*样式表*](http://en.wikipedia.org/wiki/Cascading_Style_Sheets)是设置 HTML 样式的正确方法。这个[构造函数](http://docs.oracle.com/javase/6/docs/api/javax/swing/text/html/HTMLDocument.html#HTMLDocument%28javax.swing.text.html.StyleSheet%29)也解释了它：

```
public HTMLDocument(StyleSheet styles) 
```

这是[*StyleSheet*](http://docs.oracle.com/javase/6/docs/api/javax/swing/text/html/StyleSheet.html)构造函数参数的链接。

**但是，这可以解决问题：**

```
JTextPane pane = new JTextPane();
pane.setEditorKit(new HTMLEditorKit()); 
```

一个[编辑器套件](http://docs.oracle.com/javase/1.4.2/docs/api/javax/swing/text/EditorKit.html)：

> 建立文本组件所需的一组东西，使其成为*某种类型的文本内容*的合理运行的编辑器。EditorKit 充当某种策略的工厂。例如，可以提供可以用其他实现替换的 html 和 rtf 实现。

一些 EditorKit 方法是：

*   `createCaret()`
*   `getContentType()`
*   `read(Reader in, Document doc, int pos)`
*   `write(Writer out, Document doc, int pos, int len)`

[所以，基本上它是一个文本组件](http://docs.oracle.com/javase/6/docs/api/javax/swing/text/JTextComponent.html)的*文本内容*的可编程编辑器（通过读写方法），即[Document](http://docs.oracle.com/javase/6/docs/api/javax/swing/text/Document.html)：

> Document 是一个文本容器，用作摆动文本组件的模型。此接口的目标是从非常简单的需求（纯文本文本字段）扩展到复杂的需求（例如 HTML 或 XML 文档）。

因此，[HTMLEditorKit](http://docs.oracle.com/javase/1.4.2/docs/api/javax/swing/text/html/HTMLEditorKit.html)是文本组件的*HTML 文本内容*的可编程编辑器，即[HTMLDocument](http://docs.oracle.com/javase/6/docs/api/javax/swing/text/html/HTMLDocument.html) - 仔细看看这个类的继承链和实现接口 - 你会在整个答案中注意到几乎所有这些。

现在，这是来自 HTMLEditorKit apidoc 的神奇部分：

> 尽管 Document 默认提供 HTML 支持，但没有什么可以阻止对非 HTML 标记的支持，这些标记会导致替代元素结构。

所以看起来这个类的默认实现就像我们想要的那样将我们的[样式属性](http://docs.oracle.com/javase/1.5.0/docs/api/javax/swing/text/StyleConstants.html)转换为 HTML/CSS：在同一行中左对齐和右对齐。

这是有道理的，因为使用 HTML/CSS，您至少可以通过两种方式做到这一点：

*   制作一个两列表并分别设置它们的对齐方式
*   制作两个浮动 div 并分别设置它们的对齐方式

并且很可能有更多方法可以做到这一点。**

# iphone - 在tableviewcell中设置文本标签的位置？

> ID：13069731
> 
> 赞同：0
> 
> 时间：2012-10-25T13:30:52.793
> 
> 标签：iphone, ios, ipad

在我的应用程序中，我正在尝试调整 tableview 单元格中 textlabel 和 detailtextlabel 的位置。我正在这样做`

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath

{
     static NSString *CellIdentifier = @"Cell";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:CellIdentifier] autorelease];
        UIImageView* img = [[UIImageView alloc]initWithImage:[UIImage imageNamed:@"cell_with_arrow.png"]];
        [cell setBackgroundView:img];
        [img release];  

    }

    cell.textLabel.frame = CGRectMake(0,0, 150, 40);
    cell.detailTextLabel.frame = CGRectMake(155, 55, 150, 40);
    cell.textLabel.font = [UIFont fontWithName:@"Helvetica-Bold" size:14.0];
    cell.textLabel.textColor = [UIColor blackColor];
    cell.textLabel.backgroundColor = [UIColor clearColor];
    cell.textLabel.text =@"name";
    cell.detailTextLabel.text=@" status";

     cell.detailTextLabel.backgroundColor = [UIColor clearColor]; 
    //cell.detailTextLabel.textAlignment = UITextAlignmenteft;
    //cell.textLabel.textAlignment = UITextAlignmentLeft;

  return cell;
} 
```

`但似乎没有效果。谁能帮我指出我哪里出错了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T13:34:02.713

`textLabel`所以你不能改变它们`detailTextLabel`。`readonly`

```
@property(nonatomic, readonly, retain) UILabel *textLabel
@property(nonatomic, readonly, retain) UILabel *detailTextLabel 
```

看[这里](http://developer.apple.com/library/ios/documentation/uikit/reference/UITableViewCell_Class/Reference/Reference.html#//apple_ref/occ/instp/UITableViewCell/textLabel)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T13:34:19.127

我的建议是您可以创建自定义`UITableViewCell`，您可以更好地控制它的内容，也可以在其中添加自定义子视图。

这里有一些教程：

[来自 IB](http://www.galloway.me.uk/tutorials/custom-uitableviewcell/)

[从代码](http://jainmarket.blogspot.co.uk/2009/05/creating-custom-table-view-cell.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-25T13:38:43.360

你需要覆盖 layoutSubviews 方法

创建一个customcell类并用uitableviewcell继承

@试试这段代码

**自定义单元格.h**

```
#import <UIKit/UIKit.h>

@interface CustomCell : UITableViewCell

@end 
```

**CustomCell.m**

```
#import "CustomCell.h"

@implementation CustomCell

- (id)initWithStyle:(UITableViewCellStyle)style reuseIdentifier:(NSString  *)reuseIdentifier
{
    self = [super initWithStyle:style reuseIdentifier:reuseIdentifier];
    if (self) {
        // Initialization code
    }
    return self;
}

-(void)layoutSubviews{

    //Set here your frame

    self.textLabel.frame = CGRectMake(0, , 320, 30);
}

- (void)setSelected:(BOOL)selected animated:(BOOL)animated
{
    [super setSelected:selected animated:animated];

    // Configure the view for the selected state
}

@end 
```

# javascript - 如何在 jquery 或 javascript 中创建拖放事件？

> ID：13069734
> 
> 赞同：2
> 
> 时间：2012-10-25T13:30:56.460
> 
> 标签：javascript, jquery, mouseevent

我想使用以下 jquery 插件[http://flipbit.co.uk/jquery-image-annotation.html](http://flipbit.co.uk/jquery-image-annotation.html)对图像进行注释，但我希望用户拖动并绘制注释而不是单击确定按钮，那么我该如何实现这一点? 有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T22:36:30.140

该插件似乎只允许您在创建插件实例时或通过插件中的编辑对话框添加注释。

我创建了插件的一个分支：[https](https://github.com/mccannf/jquery-image-annotate) ://github.com/mccannf/jquery-image-annotate并带有一个名为的附加方法，`loadMore`该方法允许您以编程方式向带有注释的图像添加更多注释。

下面是处理带有一些示例 li 元素以尝试拖放的注释的代码。li 元素中的文本被添加到注释中。如果 li 元素具有类`editable`，则注释是可编辑的。

```
$(document).ready(function(){   

    // Used to set unique ids for each annotation
    var uniqueId = 100001;

    var annotatedImage = $("#trafalgar").annotateImage({
          editable: true,
          useAjax: false  
        });

    $("#label1").draggable({ revert: true, cursor: "crosshair" });
    $("#label2").draggable({ revert: true, cursor: "crosshair" });
    $("#label3").draggable({ revert: true, cursor: "crosshair" });
    $("#label4").draggable({ revert: true, cursor: "crosshair" });

    $(".image-annotate-view").droppable({
                    tolerance: "pointer",
                    hoverClass: "drop-hover",
                    drop: function(e, ui) {
                        alert("Dropped!");
                        var newPosX = ui.offset.left - $(this).offset().left;
        var newPosY = ui.offset.top - $(this).offset().top;
                        var note = createNote($(ui.draggable).text(), newPosY, newPosX, $(ui.draggable).hasClass("editable"));
                        $.fn.annotateImage.loadMore(annotatedImage, note);
            }
    });

    // Creates a note to be added to the image
    // Width and height are static, but could also be passed in as a configuration
    function createNote(noteText, dropTop, dropLeft, editFlag) {
        var thisNote = new Object();
        thisNote.id = (uniqueId++).toString();
        thisNote.text = noteText;
        thisNote.top = dropTop;
        thisNote.left = dropLeft;
        thisNote.width = 30;
        thisNote.height = 30;
        thisNote.editable = editFlag;
        return thisNote;
    }
}); 
```

这是一个实现此功能的 jsfiddle：http: [//jsfiddle.net/mccannf/Tsrku/17/](http://jsfiddle.net/mccannf/Tsrku/17/)

# asp.net-ajax - 单击asp.net按钮控件后显示消息

> ID：13069735
> 
> 赞同：1
> 
> 时间：2012-10-25T13:30:58.170
> 
> 标签：asp.net-ajax

单击 asp.net 按钮后，在按钮单击事件中，我有 5 个模块连续执行；

```
Protected Sub btnOK_Click(sender As Object, e As System.EventArgs) Handles btnOK.Click
       Module1()
       Module2()
       Module3()
       Module4()
       Module5()
End Sub 
```

现在我想向用户显示一条标签消息，显示正在执行的当前模块。类似于“处理模块 1....”

注意：每个模块都在服务器中执行一些繁重的数据处理工作，这些工作会消耗大量时间，具体取决于数量。任何人都可以提供一些示例代码吗？我对 ajax 更新面板没问题。

# function - PowerShell 中的函数参数顺序

> ID：13069737
> 
> 赞同：0
> 
> 时间：2012-10-25T13:31:02.530
> 
> 标签：function, powershell, parameters

我的 PowerShell 脚本之一中有此代码：

```
function callCommandWithArguments([String] $arg1, [String] $arg2)
{
    [string]$pathToCommand = "C:\command.exe";
    [Array]$arguments = "anArg", "-other", "$arg2", "$arg1";
# the real code is
#   & $pathToCommand $arguments;
# but was not working, so I change it to debug
    Write-Host $pathToCommand $arguments;
}

callCommandWithArguments("1", "2"); 
```

由于`$arguments`数组中的参数顺序发生了变化，我希望这个输出：

```
C:\command.exe anArg -other  2 1 
```

但相反，我收到一个奇怪的消息：

```
C:\command.exe anArg -other  1 2 
```

我错过了一些明显的东西吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T13:43:42.870

尝试像这样调用你的函数：

```
callCommandWithArguments "1" "2" 
```

在 powershell 中，您将参数传递给函数，而不用`()`空格分隔。

在您的代码中，您正在传递一个类型的参数数组`object[]`

# c# - 将内容读取为空 XML 元素的整数

> ID：13069740
> 
> 赞同：0
> 
> 时间：2012-10-25T13:31:07.367
> 
> 标签：c#, xml, xml-parsing

使用 XMLReader 在 C# 中解析 XML 时遇到问题。

这是一个例子：

```
string text = xNode.ReadElementContentAsString().Length > 0 ? xBonusesNode.ReadElementContentAsString() : null;
int nmb = xNode.ReadElementContentAsInt(); 
```

所以，在我试图获取字符串值的地方，有一个简单的内联 if 语句来检查元素是否有数据。

我怎样才能用整数做类似的事情？或者如何正确并以最佳方式捕获异常？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T13:33:40.343

您可以像这样使用[int.TryParse](http://msdn.microsoft.com/en-us/library/system.int32.tryparse.aspx)：

```
 int number;
  bool result = Int32.TryParse(xNode.ReadElementContentAsString, out number); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T13:33:51.093

```
string text = xNode.ReadElementContentAsString().Length > 0 ? xBonusesNode.ReadElementContentAsString() : null;
Int32.TryParse(text,out myInt); 
```

应该管用。

我不确定 xml 库是否支持可为空的类型（int？），但以上内容应该可以正常工作 - 基本上我将它作为字符串读取，然后尝试解析它。如果 TryParse 失败，myInt 将保持以前的状态（并且 tryParse 返回“false”）

# actionscript-3 - Flash as3数组和循环和函数

> ID：13069748
> 
> 赞同：0
> 
> 时间：2012-10-25T13:31:20.897
> 
> 标签：actionscript-3

我有一个数组：

```
var type:Array = [[[1,2,3], [1,2,3],[1,2,3]],
          [[1,2,3], [1,2,3],[1,2,3]]]; 
```

然后我循环它来调用一个函数：

```
for(var i:int = 0;i<type.length;i++) {
    addGrid(type[0][i]);
} 
```

我调用的函数是：

```
public function addGrid(col,row:int, type:Array) {
    var newGird:GridE = new GirdE();
    newGird.col = col;
    newGird.row = row;
    newGird.type = type;
} 
```

希望清楚我需要什么。我的网格可能很大，因为这里的数组样本的数组是 3(Columns)x2(Rows)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T15:58:17.323

ActionScript 3[多维数组](http://help.adobe.com/en_US/ActionScript/3.0_ProgrammingAS3/WS5b3ccc516d4fbf351e63e3d118a9b90204-7ee9.html)可以通过循环行和列来使用多个数组索引来引用。

根据您的数组结构，您首先定义行，然后定义列。

这将查找单元格值：

```
grid[row][col] 
```

迭代所有元素可以实现为：

```
private var grid:Array = [[[ 1, 2, 3 ], [ 1, 2, 3 ], [ 1, 2, 3 ]],
                          [[ 1, 2, 3 ], [ 1, 2, 3 ], [ 1, 2, 3 ]]];

public function loop()
{
    // for every row...
    for (var row:uint = 0; row < grid.length; row++)
    {
        // for every column...
        for (var col:uint = 0; col < grid[row].length; col++)
        {
            // your value of "1, 2, 3" in that cell can be referenced as:
            //    grid[row][col][0]  = 1
            //    grid[row][col][1]  = 2
            //    grid[row][col][2]  = 3

            // to pass row, col, and the value array to addGrid function:
            addGrid(row, col, grid[row][col]);
        }
    }
}

public function addGrid(row:int, col:int, value:Array):void
{
    /* ... */
} 
```

# ruby-on-rails - 在 Rails 3 下，如何让我的邮件程序将邮件发送到包含变音符号的地址？

> ID：13069752
> 
> 赞同：0
> 
> 时间：2012-10-25T13:31:23.443
> 
> 标签：ruby-on-rails, actionmailer

这是我的邮件：

```
class MyUserMailer < ActionMailer::Base
  default from: "me@mail.com",
          :content_transfer_encoding => "7bit"
  def build_email(user)
    mail(:to => user.email,:subject => "Welcome")
  end
end 
```

我正在使用包含 umlauts: 的地址进行测试`äardvark@mail.com`，但是当我尝试发送电子邮件时，我不断收到以下错误：

```
'to' parameter is not a valid address. please check documentation 
```

文档说邮件程序将使用 UTF-8 对所有字段进行编码。我怎样才能使这项工作？

编辑：我正在使用 Rails 3.2.5

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T09:29:07.520

问题是由我使用 mailgun Rails gem 引起的。在我切换到直接使用 smtp 后，问题就消失了。

# c - 在 c99 中使用 clock_gettime 时出现编译错误

> ID：13069758
> 
> 赞同：9
> 
> 时间：2012-10-25T13:31:47.907
> 
> 标签：c, c99

当我在代码片段中使用 clock_gettime 并使用标志 -std=c99 进行编译时，出现如下错误：

```
warning: implicit declaration of function 'clock_gettime'
error: 'CLOCK_REALTIME' undeclared (first use in this function) 
```

我已经包含了文件'time.h'。任何人都知道如何解决它。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-25T13:45:08.713

在您使用 -std=c99 的原始代码中，尝试添加

```
#define _POSIX_C_SOURCE >= 199309L 
```

clock_gettime 的手册页表明这是必要的功能测试宏要求。

# javascript - Selenium HtmlUnitDriver 编译的javascript模式

> ID：13069760
> 
> 赞同：2
> 
> 时间：2012-10-25T13:32:04.147
> 
> 标签：javascript, playframework-2.0, rhino, selenium-webdriver

我在播放应用程序（play.api.test.TestBrowser.webDriver 是 HtmlUnitDriver 的一个实例）中使用 HtmlUnitDriver 来测试用户交互。我有一个 JavaSrcipt 文件，它在使用后定义了一些函数。这不会在浏览器中引起问题，但在驱动程序中会出现问题。司机抱怨说函数“x”不存在。

当我阅读 HtmlUnitDriver 时，我发现它使用的是 Rhino (https://developer.mozilla.org/en-US/docs/Rhino) JavaScript 解释器。似乎它在解释器而不是编译模式下工作，导致这种类型的问题。

这是一种告诉 HtmlUnitDriver 在编译的 JavaScript 模式下使用 Rhino 的方法吗？我仍然想使用 HtmlUnitDriver 而不是像 Firefox 这样的 GUI 版本。

可以使用一些系统属性、配置文件等来完成吗？

# jquery - 无法通过单击使我的 jquery 动画回来

> ID：13069761
> 
> 赞同：1
> 
> 时间：2012-10-25T13:32:10.923
> 
> 标签：jquery, html, click, jquery-animate

如果已经回答，抱歉发布此问题。但我已经搜索并无法理解该怎么做。

我有一个带有加号图像的 div 和一个带有一些信息的 div。当我单击加号时，两个 div 都会动画，但是当我再次单击加号时，没有任何反应。

我希望它像这样工作 - 单击加号两个 div 动画，单击加号或离开 bigdiv 动画它回来。

这是我到目前为止得到的：

```
jQuery(document).ready(function(e){
    $('.plussign').click(function(event) {
        $('#bigdiv').animate({height : '400px'}, 200);
        $('.plussign').animate({bottom : '400px'}, 200);
    }).click(function(event) {
        $('#bigdiv').animate({height : '80px'}, 200);
        $('.plussign').animate({bottom : '80px'}, 200);
    });;
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T13:41:26.790

```
jQuery(document).ready(function(e){
    $('.plussign').toggle(function(event) {
        $('#bigdiv').animate({height : '400px'}, 200);
        $('.plussign').animate({bottom : '400px'}, 200);
    }, function(event) {
        $('#bigdiv').animate({height : '80px'}, 200);
        $('.plussign').animate({bottom : '80px'}, 200);
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T13:43:42.473

你应该使用切换。试试下面的脚本

```
jQuery(document).ready(function(e){
    $('.plussign').toggle(
        function() {
            $('#bigdiv').animate({height : '400px'}, 200);
            $('.plussign').animate({bottom : '400px'}, 200);
        }, function() {
            $('#bigdiv').animate({height : '80px'}, 200);
            $('.plussign').animate({bottom : '80px'}, 200);
        }
    );
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T13:44:47.920

尝试这个：

```
//  BTW, if you're using newer jQuery and no other library that namespaces the $ symbol, 
//  you can replace that long document.ready line with the following:
//  $(function() {
jQuery(document).ready(function(e){
    //  call just one click function
    $('.plussign').click(function(e) {
        //  using toggle function will allow you to operate between the two clicks
        $(this).toggle(function(e) {    //  click odd
            //  If both elements are recieving the same action, then call them in the same line, 
            //  simply seperate with a comma
            $('#bigdiv, .plussign').stop().animate({height : '400px'}, 200);
            //  the .stop() function will stop any previous animation and continue with the new, 
            //  this is usefull for FAST CLICKING
        },
        function(e) {   //  click even
            $('#bigdiv, .plussign').stop().animate({height : '80px'}, 200);
        });
    });
}) 
```

> **然而**

我建议使用基类和切换类并使用 jQuery 的 .toggleClass 功能，因为它的编码要少得多并且更容易控制，因为您可以简单地调整 css。例如：

> CSS

```
.open { 
    height: 400px;
}
.closed { 
    height: 80px;
} 
```

> 脚本

```
$(function() {
    //  if you dont add the closed class to the html element itself on the HTML, 
    //  you can add it here before setting your click event
    $('#bigdiv, .plussign').addClass("closed");
    //  then set your click event with the toggleClass function
    $('.plussign').click(function(e) {
        $('#bigdiv, .plussign').toggleClass("open closed");
        // if you add jQueryUI to the mix you can control the speed in time as follows
        // $('#bigdiv, .plussign').toggleClass("open closed", 10000);
    });
}) 
```

# matlab - Matlab：拆分矩阵

> ID：13069762
> 
> 赞同：0
> 
> 时间：2012-10-25T13:32:13.327
> 
> 标签：matlab

不知道该怎么做，这真的让我发疯。我有一个大矩阵，有 3 列显示：

1.  当年销售的物品数量
2.  商品售出的第一年
3.  去年这些物品已售出。

因此，在以下示例中，2000 年至 2010 年间每年售出 13 件商品，而 2003 年和 2004 年售出 44 件：

```
Matrix_A = {13,    2000,    2010;
            44,    2003,    2004} 
```

我试图按年份分开这些值，以计算每年售出的物品总数。因此，2003 年和 2004 年将售出 57 (13 + 44) 件商品，其他年份将售出 13 件。

生成的矩阵如下所示：

```
{13, 2000;
 13, 2001;
 13, 2002;
 13, 2003;
 13, 2004;
 13, 2005;
 13, 2006;
 13, 2007;
 13, 2008;
 13, 2009; 
 13, 2010;
 44, 2003;
 44, 2004} 
```

* * *

我尝试为每年创建一个单独的空矩阵，循环遍历 Matrix_A 并将行分配给适当的年度矩阵。因此，对于 Matrix_A：

*   13 将添加到 2000 年至 2010 年的矩阵中，并且，
*   44 到 2003 年和 2004 年的矩阵。

但这似乎涉及动态变量名，我无法实现。

总之，我迷路了。有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T13:40:45.710

这是生成您在问题中显示的矩阵的数据集的简单循环

```
B = [];
A = [13,    2000,    2010;
     44,    2003,    2004];

for i=1:size(A,1)
    years = [A(i,2):A(i,3)]';
    start = size(B, 1);
    B(start+1:start+numel(years),2) = years;
    B(start+1:start+numel(years),1) = A(i,1);
end
B =

      13        2000
      13        2001
      13        2002
      13        2003
      13        2004
      13        2005
      13        2006
      13        2007
      13        2008
      13        2009
      13        2010
      44        2003
      44        2004 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T13:50:42.950

您可以使用 MATLAB 的矩阵索引功能来完成此操作。无论您拥有多少年或产品，这种方法都应该有效。

```
A = [13,2000,2010;44,2003,2004];
%# grab the earliest year in your matrix
firstYear = min(A(:,2));
%# grab the last year in your matrix
lastYear = max(A(:,3));
%# create a list of all years
years = firstYear:lastYear;
%# initialize the product sum for each year
productTotals = zeros(size(years));
% loop through and add up your totals
for yy = 1:numel(years)
for aa = 1:size(A,1)
%# check to see if the product was sold that year
if years(yy)>=A(aa,2) && years(yy)<=A(aa,3)
productTotals(yy) = productTotals(yy) + A(aa,1);
end
end
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T13:41:27.650

为什么每年都需要单独的矩阵？

你可以有一个数组，它的每个元素代表一年。第一个元素是第一年（第二列的最小值）。

编辑：使用 s 对非标量元素也可以做到这一点`cell`（见下面的评论）

# bash - 用变量清除内存

> ID：13069766
> 
> 赞同：2
> 
> 时间：2012-10-25T13:32:25.570
> 
> 标签：bash, unix

目前我正在 BASH 中创建一个小脚本，要求用户填写新的 IP 地址、子网和网关。该输入进入一个文件，该文件将被写入 /etc/network/interface..

我得到了脚本的工作，但它不是防弹的。

当用户输入的不是数字而是字母时，返回，用户需要重新填写一个数字。当用户仍然使用字母字符时，脚本会继续，即使给出错误。

我的代码：

```
 echo "Fill in your IP"
    read NEW_IP

    oldIFS=$IFS
    IFS=.
    set -- $NEW_IP

    while [ $# -ne "4" ]; do  
      echo "Must have 4 parts"
        read NEW_IP
        set -- $NEW_IP 
    done

    for oct in $1 $2 $3 $4; do
      echo $oct | egrep "^[0-9]+$" >/dev/null 2>&1 
      while [ "$?" -ne "0" ]; do
          echo "$oct is not numeric. fill your IP in the correct format;"
        read NEW_IP
      set -- $NEW_IP 
    done 
```

我是 bash 的新手，上面不是我自己做的。我在互联网上找到了这个脚本。while 和 do 是我自己做的一个循环。每次用户填写错误的数字它必须返回，直到用户填写正确的格式。

真正的问题在于代码的后半部分。当我填写错误的 IP（如 10.10.10.a）时，我得到了我想要的错误，我必须第二次填写我的 IP。当我输入 10.41.12.r 时，出现了一个错误，但这一次，没有抱怨最后的 r，但仍然抱怨我首先插入的 a。10.41.12 将被检查，但最后一个字符不同。

我可以想象一切都将存储在内存中，但我该如何清除呢？unset 或 $oct=
不起作用

希望有人可以帮助我。这是我第一次编程，这让我很头疼

谢谢。

戴夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T13:58:01.437

`for`不会多次评估条件。它只运行了 4 次，设置`$oct`为`$1`... `$4`如果您尝试多次，您的输入将被接受，即使不是数字。此外，在循环输入后，您应该再次检查“必须有 4 个部分”。

顺便说一句，您应该检查每个`$oct <= 255`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-20T09:20:50.340

重复的代码通常很糟糕。最好在一个地方读取输入并每次都进行相同的测试。

```
prompt="Fill in your IP"
while
    echo $prompt
    read NEW_IP
    IFS=.
    set -- $NEW_IP
    IFS=
    if [ $# -ne 4 ]
    then
        prompt="Must have 4 parts"
        continue
    fi
    for oct
    do  if [[ ! "$oct" =~ ^[0-9]+$ ]]
        then
            prompt="$oct is not numeric. fill your IP in the correct format;"
            continue 2
        fi
        # You might add more checks here.
    done
do  break
done 
```

# javascript - FileReader.readAsDataURL 上传到 express.js

> ID：13069769
> 
> 赞同：6
> 
> 时间：2012-10-25T13:32:32.070
> 
> 标签：javascript, node.js, express

我有以下代码要上传到我的 Node.js/Express.js 后端。

```
var reader = new FileReader();
reader.readAsDataURL(file);

reader.onload = function (e) {
  var result = http.post('/files', e.target.result);
  result.success(function () { 
    alert('done'):
  });
} 
```

我的路线看起来像：

```
app.post('/files', function (req, res) {
  var cws = fs.createWriteStream(__dirname + '/media/file');
  req.pipe(cws);
  res.send('success');
}); 
```

当我使用图像应用程序打开 /media/file 时，我收到一条警告说它无法读取它。当我用文本编辑器打开图像文件时，我看到里面有 base64 编码的字符串。在将字符串写入桌面之前是否需要先转换字符串？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-25T14:30:52.923

问题是 DataURL 是由元数据前置的。在创建 base64 缓冲区之前，您首先需要删除该部分。

```
var data_url = req.body.file;
var matches = data_url.match(/^data:.+\/(.+);base64,(.*)$/);
var ext = matches[1];
var base64_data = matches[2];
var buffer = new Buffer(base64_data, 'base64');

fs.writeFile(__dirname + '/media/file', buffer, function (err) {
  res.send('success');
}); 
```

[从这个问题](https://stackoverflow.com/questions/11335460/how-do-i-parse-a-data-url-in-node)中得到了大部分代码。

# wpf - 更新窗口数据。WPF

> ID：13069771
> 
> 赞同：0
> 
> 时间：2012-10-25T13:32:36.253
> 
> 标签：wpf, module, prism, reload

我有一个带有 PRISM 的 WPF 项目。在我的引导程序中，我有以下代码。

```
 protected override DependencyObject CreateShell()
      {
        Form1 form1= new Form1();
        Form2 form2= new Form2();

        var mainWindow = new MainWindow();
        mainWindow.Show();
        mainWindow.Activate();

        RegionManager.SetRegionManager(form1, this.Container.Resolve<IRegionManager>());
        RegionManager.SetRegionManager(form2, this.Container.Resolve<IRegionManager>());
        RegionManager.UpdateRegions();

        return mainWindow;
    }

    protected override IModuleCatalog GetModuleCatalog()
    {
        var moduleCatalog = new ModuleCatalog();
        moduleCatalog.AddModule(typeof(MainModule));
        moduleCatalog.AddModule(typeof(Form1Module), InitializationMode.OnDemand);
        moduleCatalog.AddModule(typeof(Form2Module), InitializationMode.OnDemand);
        return moduleCatalog;
    } 
```

在 MainForm 我有`ListBox`和按钮。当我们在其中选择一些项目`ListBox`并单击“显示”按钮时，form1 会显示一些数据，并且主窗口被隐藏。Form1 也有按钮“Go to Main”，当用户单击它时，我会这样做`form1.Hide()`（用数据隐藏 form1）和`mainWindow.Show()`（再次显示 mainWindow）。在 mainWindow 上，用户从中选择另一个项目`ListBox`并单击“显示”-显示 form1，它应该显示新数据，因为用户在 mainWindow 上选择了新项目，但 form1 显示旧数据（第一次加载 form1 的模块时显示的数据）。

示例 - 在主窗口中，我们有一个列表框，其中包含一些公司的办公室列表，我们选择“Office1”并单击“显示”，此主窗口隐藏并加载 form1，form1 显示“Office1”的费用列表。当我在 mainWindow 上选择另一个办公室时，例如“Office2”form1 应该显示“Office2”的费用，但它显示“Office1”的费用。

当用户单击主窗口上的“显示”按钮时，我会执行 moduleManager.LoadModule("")。我发现无法重新加载模块的信息，这意味着模块只有在我们第一次单击“显示”按钮时才会加载，但是我们如何更新视图上的数据呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T17:45:13.637

我不确定我是否完全遵循，但我会对此进行尝试。

CreateShell 应该仅用于您的主窗口。Prism 使用它来设置应用程序的第一个窗口。我看到在这里制作多个可视窗口的唯一原因是为了启动闪屏。

所以让 CreateShell 制作你的 MainWindow。然后，让 MainWindow 根据需要创建其他表单。如果您每次都需要新数据，则每次都可以添加`new`它们。

您问题的 LoadModule 部分也有点令人困惑。ModuleManager 是一种让您无需硬引用即可获取应用程序部分的方法。

# google-app-engine - 我可以将 OAuthSerice 对象存储在 jdo 中吗

> ID：13069773
> 
> 赞同：0
> 
> 时间：2012-10-25T13:32:41.637
> 
> 标签：google-app-engine

嗨，请检查我得到的代码 2012-10-25 18:22:17.803

com.cloudcodes.ErrorHandler errorHandler：异常消息：org.scribe.oauth.OAuth10aServiceImpl

2012-10-25 18:22:17.804

com.cloudcodes.ErrorHandler errorHandler：LinkedInCallBackUrl 类中的错误

2012-10-25 18:22:17.804

com.cloudcodes.ErrorHandler errorHandler:
java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1197)

2012-10-25 18:22:17.804

com.cloudcodes.ErrorHandler errorHandler:
java.io.ObjectOutputStream.writeObject(ObjectOutputStream.java:363)

这个错误
OAuthService service = new ServiceBuilder() .provider(LinkedInApi.class) .apiKey("jfih0cg6ihc1") .apiSecret("nFxDxjA4T6jgq5JD").scope("r_network rw_nus") .callback("http://mygbuddy.appspot. com/DisplayConnections.jsp") .build(); 令牌 requestToken=service.getRequestToken(); HttpSession 会话=req.getSession();

```
 ByteArrayOutputStream bos = new ByteArrayOutputStream();
    ObjectOutputStream oos = new ObjectOutputStream(bos);
    oos.writeObject(service);
    byte[] oauthobject = bos.toByteArray();
    String oauth=new String(oauthobject);
    String tokenvalue=requestToken.getToken();
    String tokenSecert=requestToken.getSecret(); 
```

我通过使用我的bean类将这些细节存储在jdo中

# asp.net - 无法通过 OnRowEditing 事件在 EditTemplate 中找到控件

> ID：13069775
> 
> 赞同：3
> 
> 时间：2012-10-25T13:32:46.880
> 
> 标签：asp.net, gridview, edit

我有一个`GridView`这样的：

```
<asp:GridView runat="server" ID="grdPractices" PageSize="10" AutoGenerateColumns="False" DataKeyNames="Id" 
    CssClass="linkGrid" AllowSorting="True" OnSorting="grdPractices_OnSorting" OnRowDataBound="grdPractices_OnRowDataBound"
    OnRowEditing="grdPractices_OnRowEditing" OnRowCancelingEdit="grdPractices_OnRowCancelingEdit" OnRowUpdating="grdPractices_OnRowUpdating">
    <Columns>
        <asp:BoundField DataField="Name" HeaderText="Name" meta:resourcekey="PracticeName" ReadOnly="True" SortExpression="Name" ItemStyle-Width="400px" />
        <asp:BoundField DataField="Code" HeaderText="Code" meta:resourcekey="Code" ReadOnly="True" SortExpression="Code" ItemStyle-Width="200px" />
        <asp:TemplateField meta:resourcekey="SiteName" ItemStyle-Width="200px" SortExpression="SiteName">
            <ItemTemplate>
                <asp:Literal runat="server" Text='<%# Eval("SiteName") %>' />
            </ItemTemplate>
            <EditItemTemplate>
                <asp:DropDownList runat="server" ID="lstSites" />
            </EditItemTemplate>
        </asp:TemplateField>
        <asp:TemplateField meta:resourcekey="NumOfUsers" ItemStyle-Width="200px" SortExpression="NumOfUsers">
            <ItemTemplate>
                <asp:LinkButton runat="server" OnCommand="OnLinkButtonCommand" CommandName="ViewUsers" Text='<%# Eval("NumOfUsers") %>' />
            </ItemTemplate>
        </asp:TemplateField>
        <asp:CommandField ShowDeleteButton="False" ShowCancelButton="True" 
            ShowInsertButton="False" ShowEditButton="True" EditText="Edit"
            CancelText="Cancel" UpdateText="Update" meta:resourcekey="Edit" ItemStyle-Width="200px" />
    </Columns>
</asp:GridView> 
```

这是 OnRowEditing 事件的代码：

```
protected void grdPractices_OnRowEditing(object sender, GridViewEditEventArgs e)
{
    this.grdPractices.EditIndex = e.NewEditIndex;

    var sitesDropDown = this.grdPractices.Rows[e.NewEditIndex].Controls[0].FindControl("lstSites") as DropDownList;

    if (sitesDropDown == null)
    {
        return;
    }
} 
```

我的问题是我无法`lstSites`控制位于 EditTemplate 中的控件。我尝试过使用以下内容：

*   this.grdPractices.Rows[e.NewEditIndex].Controls[0].FindControl("lstSites") as DropDownList;
*   this.grdPractices.Rows[e.NewEditIndex].FindControl("lstSites") as DropDownList;
*   this.grdPractices.Rows[e.NewEditIndex].FindControlRecursive("lstSites") as DropDownList;

结果总是一样的，`NULL`返回a。

在 OnRowEditing 事件中，您到底应该如何连续获得控件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T10:54:24.663

好的，在这行之后我没有做什么：

`this.grdPractices.EditIndex = e.NewEditIndex;`

然后重新绑定网格的数据。所以在重新绑定数据之后，然后调用：

```
var sitesDropDown = this.grdPractices.Rows[e.NewEditIndex].FindControlRecursive("lstSites") as DropDownList; 
```

我现在能够与`siteDropDown`变量交互，因为它现在包含对`lstSites`控件的引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T14:47:37.477

尝试使用`GridViewRow`如下...

```
protected void grd_RowEditing(object sender, GridViewEditEventArgs e) 
{
     GridViewRow selectRow = grd.Rows(e.NewEditIndex);
     DropDownList sitesDropDown =(DropDownList)selectRow.Cells[2].FindControl("lstSites"); 
} 
```

# r - 峰高斯函数估计

> ID：13069777
> 
> 赞同：0
> 
> 时间：2012-10-25T13:32:55.237
> 
> 标签：r, matlab, math

我有一个连续的输入数据流：超过 100.000。时间和强度有两个值。数据包含许多峰。让se部分数据。

![这是需要分析的数据的一部分](../Images/184c9051f4b6f3e53bdc56f5624cf7d2.png)

目标：搜索峰 -> 识别它们 -> 计算面积。

问题：例如，一个巨大的峰值（如 8.0 和 8.5 之间的一个）可能包含多个高斯（这只是一个“正常”，还有其他类型的估计函数）峰值。

问题：我怎样才能“去卷积”这个峰以测量它们的面积。

示例：我想做类似下面的 matlab 代码：

[爱峰](http://terpconnect.umd.edu/~toh/spectrum/InteractivePeakFitter.htm)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T13:49:33.257

好吧，如果“iPeak”足够好，只需将代码移植到 R。R 中有几个包可以进行阈值峰值查找。我自然而然地忘记了他们的名字，远离我的主机。如果我能刷新我的大脑......可能适合你：PROcess、ppc、seewave、Peaks，以及我喜欢的一个：pracma。

注意：我使用非常有用的工具找到了这些`sos`

# ant - HTML5Boilerplate Build Script - 如何在命令行上传递 dir.source 变量

> ID：13069778
> 
> 赞同：1
> 
> 时间：2012-10-25T13:32:58.637
> 
> 标签：ant, build, html5boilerplate

我们在 Windows 上使用 HTML5 Boilerplate Build Script，我想知道是否可以在运行**ant build时在命令行上指定****dir.source**参数，而不是每次我们想要构建一个时在**default.properties**文件中编辑它模板在不同的目录中。

 ****> dir.source = ./template/company1

**dir.source**参数不断变化，就像在我们的 CMS 的不同目录中构建模板一样，例如**./template/company1**和**./template/company2**等

如果我们可以避免每次想要在不同的目录中构建模板时都编辑 default.properties 文件，那就太好了，非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T16:36:48.917

尝试使用类似的东西：

```
<javac srcdir="${srcdir}" destdir="${build.dir}"/> 
```

并调用它：

```
ant -Dsrcdir="template/company1" 
```

这是你需要的吗？****

# java - 将字符串拆分为没有分隔符的三部分（Java）

> ID：13069782
> 
> 赞同：0
> 
> 时间：2012-10-25T13:33:07.350
> 
> 标签：java

我有一个`String`

```
String test = "7462356098660AE"; 
```

我想把它分成：

```
test1 = "746";
test2 = "2356";
test3 = "0986";
test4 = "60AE"; 
```

字符串的长度`test`将始终相同。

我将如何做到这一点？

PS：我检查了其他问题，但找不到合适的答案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-25T13:35:21.023

```
String test = "7462356098660AE";
String test1 = test.substring(0,3);
String test2 = test.substring(3,7);
String test3 = test.substring(7,11);
String test4 = test.substring(11,15); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-25T14:01:01.633

为方便起见，您可以编写这种 Splitter 类：

```
public class Splitter {
  private final int[] borders;
  private final String s;
  public Splitter(String s, int... borders) {
    this.s = s;
    this.borders = borders;
  }
  public String seg(int seg) {
    return s.substring(seg == 0? 0 : borders[seg-1], borders[seg]);
  }
} 
```

你会这样使用它：

```
final Splitter splitter = new Splitter("7462356098660AE", 3, 7, 11, 15);
for (int i = 0; i < 4; i++) System.out.println(splitter.seg(i)); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-25T13:36:35.657

不确定您的用例是什么，但如果代码的子字符串总是相同的长度，您可以使用[`substring()`method](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/String.html#substring%28int,%20int%29)。你只需给它你想要的子字符串的开始和结束索引。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-25T13:35:10.793

如果字符串对于您想要的所有字段的宽度都是固定的，您可以使用 String 的 substring/subSequence 方法，或者您可以创建正则表达式并获取捕获组的值。

# ruby-on-rails - 如何从继承的类中覆盖“acts_as”方法？

> ID：13069787
> 
> 赞同：0
> 
> 时间：2012-10-25T13:33:28.067
> 
> 标签：ruby-on-rails, ruby, inheritance, methods, overriding

我正在使用 Ruby 1.9.2 和 Ruby on Rails 3.2.2。我有以下陈述：

```
class A < ActiveRecord::Base
  acts_as_something :arg1A, :arg2A, :argNA
end

class B < A
  acts_as_something :arg1B, :arg2B, :argNB
end 
```

在继承 ( ) 时，中所述的方法`B < A`似乎*没有*被中所述的方法覆盖：当我检查与类的方法相关的参数时，那些仍然指的是, , （*而不是*, , ）。`acts_as_something``A`*`acts_as_something``B``acts_as_something``B``:arg1A``:arg2A``:argNA`*`:arg1B``:arg2B``:argNB`**

 **可能发生了什么？如何正确覆盖该`acts_as_something`方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T15:10:46.343

这些`acts_as_something :arg1A, :arg2A, :argNA`行不是方法定义，而是类范围内的类方法调用。因此，您不能覆盖它们。

但是，根据“acts_as”方法的实现，您可以覆盖它们在子类中的效果。但这完全取决于所讨论的“acts_as”方法的作用......**

# ruby-on-rails - Rails 3.2 ActiveRecord 并发

> ID：13069788
> 
> 赞同：2
> 
> 时间：2012-10-25T13:33:29.860
> 
> 标签：ruby-on-rails, activerecord, concurrency

我有一个应用程序是任务管理器。

每个用户都可以选择分配给自己的新任务。

如果 2 个用户同时接受同一个任务，是否存在并发问题？

我的代码如下所示：

```
if @user.task == nil
  @task.user = @user
  @task.save
end 
```

如果 2 个不同的用户，在 2 个不同的机器上同时打开这个 url。我会有问题吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-25T13:52:29.600

您可以使用[乐观锁定](http://api.rubyonrails.org/classes/ActiveRecord/Locking/Optimistic.html)来防止将其他“陈旧”记录保存到数据库中。要启用它，您的模型需要有`lock_version`一个默认值为 的列`0`。

当从数据库中获取记录时，电流`lock_version`随之而来。当记录被修改并保存到数据库时，数据库行会通过限制获取记录时存在的`UPDATE`on有条件地更新`lock_version`。如果它没有改变，`UPDATE`将增加`lock_version`. 如果它已更改，则更新将不执行任何操作，并且将引发异常 ( `ActiveRecord::StaleObjectError`)。这是 ActiveRecord 的默认行为，除非如下关闭：

```
ActiveRecord::Base.lock_optimistically = false 
```

您可以（可选）使用除`lock_version`. 要使用自定义名称，请在模型类中添加如下所示的行：

```
set_locking_column :some_column_name 
```

乐观锁定的替代方法是[悲观锁定](http://api.rubyonrails.org/classes/ActiveRecord/Locking/Pessimistic.html)，它依赖于数据库级别的表级或行级锁。此机制将阻止对锁定行的所有访问，因此可能会对您的性能产​​生负面影响。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-25T14:01:34.570

从未尝试过，但您可以使用[http://api.rubyonrails.org/classes/ActiveRecord/Locking/Pessimistic.html](http://api.rubyonrails.org/classes/ActiveRecord/Locking/Pessimistic.html)

您应该能够获得对特定任务的锁定，例如：

```
@task = Task.find(some_id)

@task.with_lock do

  #Then let's check if there's still no one assigned to this task
  if @task.user.nil? && @user.task.nil?
    @task.user = @user
    @task.save
  end
end 
```

再说一次，我从来没有用过这个，所以我会用一个大`sleep`的内部锁来测试它，以确保它实际上按照你想要的方式锁定了所有东西

我也不确定`reload`这里。由于该行被锁定，它可能会失败。但是你必须确保你的对象在获取锁后是从数据库中更新的，可能还有另一种方法可以做到这一点。

编辑：无需重新加载，我检查了源代码并`with_lock`为您完成。 [https://github.com/rails/rails/blob/4c5b73fef8a41bd2bd8435fa4b00f7c40b721650/activerecord/lib/active_record/locking/pessimistic.rb#L61](https://github.com/rails/rails/blob/4c5b73fef8a41bd2bd8435fa4b00f7c40b721650/activerecord/lib/active_record/locking/pessimistic.rb#L61)

# jsf - selectManyListbox 正在返回 null

> ID：13069792
> 
> 赞同：1
> 
> 时间：2012-10-25T13:33:41.420
> 
> 标签：jsf, jsf-2

使用 Apache MyFaces JSF 2.0。

XHTML 代码：

```
<h:form id="searchUser" prependId="false">
    <h:selectManyListbox value="#{listManyBean.listUser}" id="userList"  size="10">
    <f:selectItems value="#{listManyBean.selListUser}"/> 
    </h:selectManyListbox>
    <h:commandButton id="clickGo" value="#{bundle.btn_login}"
     type="submit" 
    action="#{listManyBean.submitList}"/>
    <input type="button" value="Add" onclick="addUserToList();" />
</h:form> 
```

添加到列表的脚本：

```
function addUserToList(){
     var UserListBox = document.getElementById('UserList');
     var UserNum = document.getElementById('UserNumber').value.toUpperCase();
     var UserOption = new Option(UserNum,UserNum);
     UserListBox.options[UserListBox.options.length] = UserOption;    
} 
```

豆：

```
import java.util.ArrayList;
import java.util.List;

import javax.faces.bean.ManagedBean;
import javax.faces.bean.RequestScoped;
import javax.faces.model.SelectItem;

@ManagedBean
@RequestScoped
public class ListManyBean {
    private List<String> listUser;
    private List<SelectItem> selListUser;

public List<SelectItem> getSelListUser() {
    return selListUser;
}

public List<String> getListUser() {
    return listUser;
}

public void setListUser(List<String> listUser) {
    this.listUser = listUser;
}

    public void submitList() {
        System.out.println("User List Value***" + this.listUser);
        System.out.println("User ListPan***++"+selListUser);
    }
} 
```

无论添加一条或多条记录，我总是得到空值。请让我知道这里出了什么问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T17:07:50.810

您正在使用 JS 而不是使用 JSF 添加新项目。这样，JSF 就不会知道有关新项目的任何信息。此信息绝不会提交给服务器端。

用理智的 JSF 方法替换错误的 JS 方法：

```
<h:form>
    <h:selectManyListbox value="#{bean.selectedUsers}" size="10">
        <f:selectItems value="#{bean.availableUsers}" /> 
    </h:selectManyListbox>
    <h:commandButton value="submit" action="#{bean.submit}" />
    <h:inputText value="#{bean.user}" />
    <h:commandButton value="Add" action="#{bean.add}">
        <f:ajax execute="@form" render="@form" />
    </h:commandButton>
</h:form> 
```

和

```
@ManagedBean
@ViewScoped
public class Bean {

    private List<String> selectedUsers;
    private List<String> availableUsers = new ArrayList<String>();
    private String user;

    public void add() {
        availableUsers.add(user);
        user = null;
    }

    public void submit() {
        System.out.println("Selected users: " + selectedUsers);
        System.out.println("Available users: " + availableUsers);
    }

    // ...
} 
```

# business-objects - 指向文件夹的 Opendoc 链接

> ID：13069793
> 
> 赞同：1
> 
> 时间：2012-10-25T13:33:50.517
> 
> 标签：business-objects, infoview

我正在使用 BO XI 3，想知道是否可以使用 OpenDocument 链接打开 InfoView 文件夹？

例如，InfoView 中的每个项目都有一个 CUID。因此，要打开网络情报报告，我可以执行以下操作：

```
http://Server_name:6060/OpenDocument/opendoc/openDocument.jsp?iDocID=ABCDEFGHIJKLMNOPQRST&sIDType=CUID 
```

InfoView 中的文件夹也有一个 CUID，那么是否可以使用此方法链接到它们以将用户直接带入文件夹？每当我尝试时，我都会收到一条错误消息（**发生错误：尝试查看文档时发生错误**），有没有办法解决这个问题？

我猜答案将是“OpenDocument 用于打开**文档****，**而不是文件夹”。反正我想问...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T01:08:32.017

我不这么认为，因为这个原因：openDocument.jsp/.aspx 命令实际上只是在*运行*一个对象，所以它需要一个报告对象或一个实例（在 .rpt .pdf .rtf .xls 等中）它可以在另一个应用程序中呈现或打开。尽管文件夹是带有 CUID 的合法对象，但它不是您“运行/查看”的东西，而是您浏览的东西。

干杯! 斯特凡

[http://www.sdn.sap.com/irj/boc/index?rid=/webcontent/uuid/5001d5de-f867-2b10-00bf-8d27683c85a0#section5](http://www.sdn.sap.com/irj/boc/index?rid=/webcontent/uuid/5001d5de-f867-2b10-00bf-8d27683c85a0#section5)

# exchange-server - EWS：如何在会议开始/结束时获取通知以交换 2010

> ID：13069795
> 
> 赞同：2
> 
> 时间：2012-10-25T13:33:55.117
> 
> 标签：exchange-server, exchangewebservices

会议开始和结束时我必须做一些操作。但是我无论如何都找不到在会议开始和结束时从 EWS 获得通知。

我尝试推送订阅并订阅文件夹 ID“日历”，然后执行 GetItem 以获取会议信息。但是这种方法的问题是我必须存储所有会议项目的时间，并让我的逻辑（计时器）找到会议开始和结束的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-07T02:54:57.847

我意识到这是一篇旧帖子，但我偶然发现它并认为有人可能仍然会找到有用的答案。

在这种情况下，EWS 通知将无法使用 - 您可以订阅的通知只会提醒您有新邮件、删除、修改、移动、复制和创建的项目。关于会议开始时间的通知没有内置任何内容。

所以我建议您使用带有 CalendarView 元素的 EWS FindItem 操作来获取接下来 N 小时内发生的所有日历项目，以确定当天发生的约会，然后创建您自己的逻辑/计时器来执行在适当的时候进行您的操作。希望有帮助。

# ms-access - MS Access：对象“_Recordset”的方法“打开”失败

> ID：13069798
> 
> 赞同：1
> 
> 时间：2012-10-25T13:34:04.210
> 
> 标签：ms-access

我正在使用的代码：

```
Dim rs As New ADODB.Recordset

rs.Open "select * from QueryName", CurrentProject.Connection, adOpenDynamic, adLockReadOnly 
```

为什么在大火中这会返回一个打开的错误？查询本身完全没问题。

查询，顺便说一句：

```
SELECT DISTINCT Zone.Office, ledger.representative
FROM ledger LEFT JOIN [Zone] ON ledger.branch = Zone.app_office
WHERE (((Zone.Office)<>"" And (Zone.Office) Is Not Null) AND ((ledger.representative)<>"" And (ledger.representative) Is Not Null))

UNION SELECT DISTINCT Zone.Office, ClientList.representative
FROM ClientList LEFT JOIN [Zone] ON ClientList.branch = Zone.app_office
WHERE (((Zone.Office)<>"" And (Zone.Office) Is Not Null) AND ((ClientList.representative)<>"" And (ClientList.representative) Is Not Null))

UNION SELECT DISTINCT Zone.Office, ghs.representative
FROM ghs LEFT JOIN [Zone] ON ghs.branch = Zone.app_office
WHERE (((Zone.Office)<>"" And (Zone.Office) Is Not Null) AND ((ghs.representative)<>"" And (ghs.representative) Is Not Null))

UNION SELECT DISTINCT Zone.Office, Prospects.representative
FROM Prospects LEFT JOIN [Zone] ON Prospects.branch = Zone.app_office
WHERE (((Zone.Office)<>"" And (Zone.Office) Is Not Null) AND ((Prospects.representative)<>"" And (Prospects.representative) Is Not Null)) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T14:35:11.933

您将需要参考`Microsoft DAO x.x Object Library`2010 年（或 2007 年？）或之后的`Microsoft Office x.x Access Database Engine Object Library`

```
Dim rs As DAO.Recordset

Set rs = CurrentDB.OpenRecordset("NameOfquery") 
```

# api - 两种相反的 API 游戏设计

> ID：13069799
> 
> 赞同：2
> 
> 时间：2012-10-25T13:34:06.477
> 
> 标签：api, oop, design-patterns

例如，在为游戏设计 API 时。将数据结构保持私有会更好，还是将结构返回给开发人员/谁曾经使用过被认为是好的设计的 API？所以这里有一个例子。

假设我有一个棋盘游戏 API。以下两个例子中哪一个会被认为是“更好的”？请注意，出于这个问题的目的，我假设棋盘大小可以变化并且由开发人员控制。

```
public void createboard(ChessBoard board);
public void move(Player playerNumber, Move move); 
```

或者

```
public void createboard(int x, int y);
public void move(Player playerNumber, int from[], int to[]); 
```

我知道可能没有更好的答案，这只是设计决策的问题。我只是想看看其他人的想法，或者是否有任何有用的提示。

基本上，我假设游戏包含一个名为 ChessBoard 的对象，其中包含实际棋盘的 2D 数组。

第一个示例要求开发人员创建对象并传递它，并要求开发人员实际知道底层数据结构是什么。

然而，第二个要求开发人员只传递数字。这将要求开发人员使用它来维护自己的数据结构。

您会考虑哪种方法更好的设计？有小费吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T13:55:53.800

在我看来，你希望你的“引擎”有多通用很重要。

如果您只想显示国际象棋，您可以对 API 用户隐藏实际的棋盘。如果您希望 API 用户能够将引擎扩展到 Archon 克隆，那么您希望他能够根据自己的喜好扩展开发板。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T13:44:08.847

当您公开 API 时，您隐藏的内部实现越多越好。否则，您将来可能会在进一步增强/更改方面限制自己，因为您不希望使用先前版本的 API 破坏与开发人员的二进制兼容性。（在“现实世界”的情况下，客户和客户之间可能会就 API 达成书面协议，声明未经客户明确许可不得破坏这些 API）。

您的目标应该是允许通过 API 进行配置，但不要在内部将自己锁定到任何特定的实现。它比听起来更难，使用的语言也是一个因素。

# c# - MeasureString() 没有返回足够的宽度

> ID：13069801
> 
> 赞同：0
> 
> 时间：2012-10-25T13:34:09.673
> 
> 标签：c#, label, measurestring

我有以下代码在 a`Label`上创建 a `PictureBox`：

```
Label l = new Label();
l.Text = _name;
l.Size = CreateGraphics().MeasureString(_name, l.Font).ToSize();
l.BackColor = Color.White; 
```

但标签总是丢弃最后一个字符。如果我在通话中添加一个字符：

```
l.Size = CreateGraphics().MeasureString(_name+".", l.Font).ToSize(); 
```

它工作正常，但感觉不对。

标签中的文本之前似乎有一些空白，但`Padding`设置为 0。我怎样才能以正确的方式解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T13:44:54.930

不能使用`AutoSize`楼盘吗？

`MeasureString`是出了名的不准确，尽管通常它返回的大小比您预期的要大：

> MeasureString 方法设计用于单个字符串，并在字符串前后包含少量额外空间，以允许悬垂字形。此外，DrawString 方法会调整字形点以优化显示质量，并且可能会显示比 MeasureString 报告的更窄的字符串。要获取适合布局中相邻字符串的度量（例如，在实现格式化文本时），请使用 MeasureCharacterRanges 方法或采用 StringFormat 的 MeasureString 方法之一，并传递 GenericTypographic. 此外，确保图形的 TextRenderingHint 是 AntiAlias。

[http://msdn.microsoft.com/en-us/library/6xe5hazb.aspx](http://msdn.microsoft.com/en-us/library/6xe5hazb.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-25T13:43:44.883

ToSize() 将 SizeF 的值截断为下一个较低的整数值。

因此，为避免损失，您可以执行以下操作：

```
l.Size = (CreateGraphics().MeasureString(_name, l.Font) + new SizeF(1, 0)).ToSize(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T13:37:43.553

与 UI 字体大小相比，当您声明字体时，是否像错误的大小一样简单？

# c# - 通过 winform 循环切换

> ID：13069803
> 
> 赞同：3
> 
> 时间：2012-10-25T13:34:15.033
> 
> 标签：c#, winforms, visual-studio, tabstop

我有一个应用程序，其中有几个表格。它是在 .NET 4.O 中构建的基于 C# Windows 窗体的应用程序。我有几种用户输入数据的表格。有显示数据的网格和表单上的大量控件。相信我！这么多控件的混乱。我必须`TabIndex`为每个控件设置。我实际上已经禁用了`TabStop`某些我不想被标记的控件的属性。但是，一旦我完成了我想要的订单，我就会对其进行 TAB，并且它可以工作，但是一旦到达最后一个框，则需要 3-4 倍的选项卡才能到达第一个字段。我尝试禁用`TabStop`我不想要的控件的属性。但我认为可能有某些我看不到的控件，但它们可能包含在 Tab 属性中。我的问题是，有什么方法可以将`TabStop`winform上所有控件的属性设置为`false`，然后将其设置`true`为我只想包含的控件。

我也愿意接受是否有其他方法可以实现这一点？

如果需要进一步解释，请告诉我！

我附上了一张图片，这就是我想要的顺序，然后循环回来，但不知何故它不起作用。此外，表单中还有两个面板，我已禁用它们的`TabStop`属性`False`。 ![在此处输入图像描述](../Images/962fd669cd7ba4acc1528dd27e23c862.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T15:10:24.637

1.  转到`View`菜单并单击`Tab Order`。这将激活表单上的选项卡顺序选择模式。`TabIndex`值将在每个控件上显示为数字。
2.  单击控件，以便您需要将它们标记为选项卡。这将为`TabIndex`控件设置适当的值。
3.  完成后，进入`View`菜单并关闭`Tab Order`。
4.  选择您不想被选项卡和设置的控件`TabStop = false`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T13:48:38.420

您应该尝试以下代码：

```
foreach (Control ctrl in this.Controls) 
ctrl.TabStop = false; 
```

您也可以尝试检查最后一个 tabindex。然后转到您的 form.designers.cs 并找到所有具有更大 tabindex 的控件，然后将它们删除：添加

```
ctrlTabStop = false; 
```

我没有测试任何这些，所以要小心：之前备份你的 *.designer.cs。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-25T15:44:00.863

一个简单的解释是，您失去了与另一个重叠的控件下方的控件。或者它位于表格边缘之外。找回它的一个好工具是 View + Other Windows + Document Outline。

如果这没有帮助，那么通过添加标签和计时器来诊断它。像这样编写 Tick 事件处理程序：

```
private void timer1_Tick(object sender, EventArgs e) {
    if (this.ActiveControl != null) label1.Text = this.ActiveControl.Name;
} 
```

# opengl-es - 在 OpenGL ES 中优化骨骼动画的顶点

> ID：13069809
> 
> 赞同：5
> 
> 时间：2012-10-25T13:34:26.673
> 
> 标签：opengl-es, opengl-es-2.0, skeletal-animation

所以我正在使用 2D 骨骼动画系统。

有 X 个骨骼，每个骨骼至少有 1 个部分（一个四边形，两个三角形）。平均而言，我大概有 20 块骨头和 30 个部分。大多数骨骼都依赖于父级，骨骼将在每一帧中移动。每个动画总共最多 1000 帧，我使用了大约 50 个动画。每次在内存中总共加载大约 50,000 帧。骨骼实例之间的零件不同。

我采用的第一种方法是计算每个骨骼的位置/旋转，并为每个部分构建一个顶点数组，其中包含以下内容：

```
[x1,y1,u1,v1],[x2,y2,u2,v2],[x3,y3,u3,v3],[x4,y4,u4,v4] 
```

并将其传递给每一帧的 glDrawElements。

看起来不错，涵盖了我需要的所有场景，不使用太多内存，但表现得像狗一样。在 iPod 4 上，渲染 10 个这样的骨骼可能会达到 15fps。

我发现大部分性能都被每帧复制这么多顶点数据消耗掉了。我决定走另一个极端，并“预先计算”动画，在开始时为每个角色建立一个顶点缓冲区，其中包含单个角色中每一帧、每一部分的 xyuv 坐标。然后，我计算应该在特定时间使用的帧的索引，并计算一个 delta 值，该值被传递到用于在当前帧和下一帧 XY 位置之间进行插值的着色器。

每帧的顶点看起来像这样

```
[--------------------- Frame 1 ---------------------],[------- Frame 2 ------]
[x1,y1,u1,v1,boneIndex],[x2, ...],[x3, ...],[x4, ...],[x1, ...][x2, ...][....] 
```

顶点着色器如下所示：

```
attribute vec4 a_position;
attribute vec4 a_nextPosition;
attribute vec2 a_texCoords;
attribute float a_boneIndex;

uniform mat4 u_projectionViewMatrix;
uniform float u_boneAlpha[255];

varying vec2 v_texCoords;

void main() {
    float alpha = u_boneAlpha[int(a_boneIndex)];
    vec4 position = mix(a_position, a_nextPosition, alpha);
    gl_Position = u_projectionViewMatrix * position;
    v_texCoords = a_texCoords;  
} 
```

现在，性能很棒，屏幕上有 10 个，它以 50fps 的速度舒适地坐着。但是现在，它使用了一公吨的内存。我已经通过在 xyuv 上失去一些精度来优化它，现在是 ushorts。

还有一个问题是骨骼依赖性丢失了。如果有两个骨骼，一个父子，一个子子在0s和2s有一个关键帧，父子在0s，0.5s，1.5s，2s有一个关键帧，那么子子在0.5s和2s之间不会改变1.5s 应该的。

我想出了一个解决这个骨骼问题的解决方案——通过强迫孩子在与父母相同的点上拥有关键帧。但这使用更多的内存，并且基本上杀死了骨骼层次结构的点。

这就是我现在的位置。我试图在性能和内存使用之间找到平衡。我知道这里有很多冗余信息（特定部分的所有帧的 UV 坐标都是相同的，所以重复了大约 30 次）。并且必须为每组零件创建一个新的缓冲区（具有唯一的 XYUV 坐标——位置会发生变化，因为不同的零件尺寸不同）

现在，我将尝试为每个角色设置一个顶点数组，其中包含所有部分的 xyuv，并计算每个部分的矩阵，并在着色器中重新定位它们。我知道这会起作用，但我担心性能不会比我刚开始时为每一帧上传 XYUV 更好。

有没有更好的方法来做到这一点而不会失去我所获得的性能？

有什么疯狂的想法我可以尝试吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T19:44:10.427

更好的方法是动态转换 30 个零件，而不是在不同位置复制数千个零件。您的顶点缓冲区将包含您的顶点数据的一份副本，从而节省大量内存。然后，每一帧都可以通过一组转换来表示，这些转换作为一个统一传递给您的顶点着色器，用于您通过调用绘制的每个骨骼`glDrawElements()`。每个从属骨骼的变换都是相对于父骨骼构建的。然后，根据您想要动画的手工制作和程序生成之间的连续性，您的变换集可能会占用更多或更少的空间和 CPU 计算时间。

Jason L. McKesson 的免费书籍*[Learning Modern 3D Graphics Programming](http://www.arcsynthesis.org/gltut/index.html)*在第 6 章中很好地解释了如何实现这一点。本章末尾的示例程序展示了如何使用矩阵堆栈来实现分层模型。[我在这个程序的 iOS 端口上有一个 OpenGL ES 2.0 可用](https://bitbucket.org/mr_berna/ios-gl-tutorial/src)。

# database - 避免在 Lotus Notes 的姓名字段中提前输入搜索用户的个人联系人列表

> ID：13069812
> 
> 赞同：0
> 
> 时间：2012-10-25T13:34:39.573
> 
> 标签：database, lotus-notes, lotus-domino, lotusscript

我喜欢 Lotus Notes 中的提前输入功能，但我希望它避免建议任何不在“PUBLIC”数据库中的名称。我们遇到的问题是用户在我们正在开发的自定义 Notes 应用程序中获得“不明确的名称”对话框并选择了错误的名称。有没有办法让提前输入功能仅在“PUBLIC”数据库中搜索自定义应用程序的名称，但在其他任何地方保持默认搜索范围相同？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T14:15:21.183

我不知道为特定应用程序关闭该功能的方法，但如果您想显示可供选择的用户下拉列表，@NameLookup 公式可以提供帮助：

[http://publib.boulder.ibm.com/infocenter/domhelp/v8r0/index.jsp?topic=%2Fcom.ibm.designer.domino.main.doc%2FH_NAMELOOKUP_7699.html](http://publib.boulder.ibm.com/infocenter/domhelp/v8r0/index.jsp?topic=%2Fcom.ibm.designer.domino.main.doc%2FH_NAMELOOKUP_7699.html)

# linq - 在 foreach 循环中更新对象

> ID：13069813
> 
> 赞同：1
> 
> 时间：2012-10-25T13:34:40.433
> 
> 标签：linq, entity-framework-4, foreach

我第一次使用 EF4/LINQ 并遇到了问题。我正在使用 foreach 循环遍历 LINQ 查询的结果，如下所示：

```
 private static void OnTimedEvent(object source, ElapsedEventArgs e) 
   {
      CallOutcomeSubmission los = new CallOutcomeSubmission();      
      client = connectToService();

      try
      {
         using (var context = new CallOutcomeContext())
         {
            // List of available actions
            private static string ACTION_CALL_ATTEMPT = "Call Attempt";
            DateTime oneDayAgo = DateTime.Now.AddHours(-24);
            var query = from co in context.T_MMCallOutcome
                        join ca in context.T_Call on co.CallID equals ca.CallID
                        join lv in context.T_LeadVendorEmailHeader on co.LeadVendorEmailID equals lv.LeadVendorEmailID
                        where co.EnteredOn > oneDayAgo && co.MMLeadActionID == null
                        select new
                        {
                            co.CallOutcomeID,
                            co.CallID,
                            co.LeadVendorEmailID,
                            MMLeadID = lv.email_text,
                            ca.OutcomeID,
                            lv.FranchiseNumber,
                            co.MMLeadActionID,
                            co.LeadAction
                        };

            // if any results found for query
            if (query.Any())
            {
               foreach (var call in query.ToList())
               {
                  // if the franchise exists 
                  if (client.FranchiseExists(int.Parse(call.FranchiseNumber)))
                  {
                     switch (call.OutcomeID)
                     {
                        case 39:    // Not Answered
                           call.LeadAction = ACTION_CALL_ATTEMPT;  
                           break;
                        case 43:    // Remove from Call List
                           break;
                        default:    // If the OutcomeID is not identified in the case statement
                           break;
                     }  // switch

                  }
                  else
                  {
                     los.eventLog.WriteEntry("CallOutcomeSubmission.OnTimedEvent: No franchise found with franchise ID " + call.FranchiseNumber);
                  }

                  // Save any changes currently on context
                  context.SaveChanges();

               }  // foreach

            }

            // if no results found from query write system log stating such
            else 
            {
               los.eventLog.WriteEntry("CallOutcomeSubmission.OnTimedEvent: No new entries found");
            }
         }  // using

         client.Close();
      }
      catch (System.TimeoutException exception)
      {
         los.eventLog.WriteEntry("CallOutcomeSubmission.OnTimedEvent:" + exception.ToString());
                    client.Abort();
      }
      catch (System.ServiceModel.CommunicationException exception)
      {
         los.eventLog.WriteEntry("CallOutcomeSubmission.OnTimedEvent:" + exception.ToString());
                    client.Abort();
      }
    } 
```

当我尝试做作业时：

```
call.LeadAction = ACTION_CALL_ATTEMPT; 
```

我得到一个构建错误

```
Property or indexer 'AnonymousType#2.LeadAction' cannot be assigned to -- it is read only 
```

在进行 Google 搜索时，我似乎无法找到有关此特定错误的任何信息，并且不确定我做错了什么。是因为原始查询包含连接吗？

如何在 foreach 循环中分配 call.LeadAction？

我还想知道我编写查询或执行任何操作的方式是否存在设计问题，因为这是我第一次涉足 EF/LINQ。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T13:56:56.250

您正在创建一个新的匿名类型 - 使用 Linq 连接，然后尝试设置该值。您真正想要做的是更新通话是否`LeadAction`正确？

EF 如何知道将您的新查询转换回实体，以便它可以返回数据库？它必须经过很多圈，而且它没有能力做到这一点。

您可以做的是`Call`从您的数据库中检索并设置该`LeadAction`方式 - 我正在使用 Find，假设这`CallID`是您的 PK：

```
 case 39:    // Not Answered
                       var thisCall = context.T_Call.Find(call.CallID)
                       thisCall.LeadAction = ACTION_CALL_ATTEMPT;                              
                       break; 
```

# javascript - 尝试在没有事件的情况下调用 jquery 函数

> ID：13069816
> 
> 赞同：1
> 
> 时间：2012-10-25T13:34:57.957
> 
> 标签：javascript, jquery

所以把和图像变成这样的链接

```
var imgCell = '<a href="javascript:storeInfo(&quot;text&quot;,&quot;text&quot;,&quot;ActiveProjects&quot;);"><img src="https://cubistmediagroup.sharepoint.com/sites/canvas/PublishingImages/details_open.png"></a>'; 
```

这将调用 storeInfo 函数，该函数将获取“文本”“文本”和“活动项目”并将它们设置为全局变量，以便它们可以被多个 javascript 函数使用......

```
function storeInfo (filePath, webAddress, projectStatus){
theFilePath = filePath;
theWebAddress = webAddress;
controlButton(projectStatus);} 
```

然后在 storeInfo 函数中我调用这个函数......

```
function controlButton (projectStatus){
$('#'+projectStatus+' tbody td img').live('click', function () {
    var theTable = ActiveProjectsTable;

    var nTr = this.parentNode.parentNode.parentNode;
    if ( this.src.match('details_close') )
        {
            // This row is already open - close it 
            this.src = "https://cubistmediagroup.sharepoint.com/sites/canvas/PublishingImages/details_open.png";
            theTable.fnClose( nTr );
        }
    else
        {
            // Open this row 
            this.src = "https://cubistmediagroup.sharepoint.com/sites/canvas/PublishingImages/details_close.png";
            theTable.fnOpen( nTr, fnFormatDetails(theTable, nTr), 'details' );
        }
});
} 
```

因此，第一次单击 img 它会调用 store info 函数，该函数反过来调用 controlButton 函数......然后在控制按钮函数中有 jquery 代码函数，需要再次点击......我想知道是否有一种在没有事件的情况下调用 jquery 函数的方法，这样我就不需要点击 2 次。

调用 controlButton 后如何调用 jquery 函数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T13:42:20.537

```
function controlButton (projectStatus){
    // save the function into a variable
    var funct = function () {
        var theTable = ActiveProjectsTable;

        var nTr = this.parentNode.parentNode.parentNode;
        if ( this.src.match('details_close') )
        {
            // This row is already open - close it 
            this.src = "https://cubistmediagroup.sharepoint.com/sites/canvas/PublishingImages/details_open.png";
            theTable.fnClose( nTr );
        }
        else
        {
            // Open this row 
            this.src = "https://cubistmediagroup.sharepoint.com/sites/canvas/PublishingImages/details_close.png";
            theTable.fnOpen( nTr, fnFormatDetails(theTable, nTr), 'details' );
        }
    }
    // Retrieve the DOM node
    var node = $('#'+projectStatus+' tbody td img');

    // Apply the event listener to the node
    node.live('click', funct);

    // Call the function, with the retrieved node as the call instance('this')
    funct.call(node);
} 
```

# php - CakePHP 中的自定义排序依据

> ID：13069822
> 
> 赞同：0
> 
> 时间：2012-10-25T13:35:06.843
> 
> 标签：php, cakephp, cakephp-2.0

我在 CakePHP 中遇到问题

我有一个数组 ($A) 及其值

```
Array  // in $A
( 
    [0] => 3
    [1] => 4
    ...
} 
```

控制器内部：

```
$conditions[]=array('Room.place_id' =>$A,'Room.status'=>'1');

$this->paginate= array(

                'limit' =>50,

                'recursive' => 2,

                'conditions' => $conditions,

                ); 
```

现在结果是：

```
Array
(
    [0] => Array
        (
            [Room] => Array
                (
                    [id] => 1
                    [place_id] => 1
                    [type] => place
                 )
               )
    [1] => Array
        (
             [Room] => Array
                (
                    [id] => 2
                    [place_id] => 3
                 )
         ).
    ... 
```

现在我想使用 $A 值（在 Place id 中）订购...

我希望第一条记录是 [place_id] => 3 的房间（因为 $a[0] = 3）

第二条记录应该是 [place_id] => 4 的房间（因为 $a[1] = 4）等等

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-25T14:42:33.313

在 mysql 中，您可以使用以下命令按特定字段值排序`ORDER BY FIELD`：

```
SELECT * FROM rooms WHERE place_id IN (3,1) ORDER BY FIELD(place_id, 3, 1); 
```

这将按照您想要的自定义顺序对您的房间进行排序（首先是带有 的那些，`place_id=3`然后是带有 的那些 `place_id=1`）。

在蛋糕中做到这一点：

```
$this->paginate= array(
   'order' => 'FIELD(Room.place_id, '.implode(',', $A).')',
   ... 
```

我假设`$A`它只包含数字，否则你必须清理进入`FIELD`表达式的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-06-16T09:11:49.760

field1 将仅显示顶部为零的值，您还可以在其他列上添加订单。

```
$this->paginate= array(
    'limit' =>50,
    'recursive' => 2,
    'conditions' => $conditions,
    'order' => "FIELD(field1, value) DESC , field2 DESC" // "FIELD(status, 2) DESC , id DESC"
); 
```

# asp.net - 网页表单的打字稿

> ID：13069825
> 
> 赞同：8
> 
> 时间：2012-10-25T13:35:20.417
> 
> 标签：asp.net, webforms, typescript, asp.net-4.5

网页表单是否支持打字稿？

我有一个现有的 asp.net 4.5 网络表单项目，其中打字稿似乎不起作用。我无法创建新文件，但即使我将现有文件重命名为 .ts 它似乎也不起作用。没有构建，没有智能，什么都没有！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-26T09:16:23.360

找到了我的问题的答案：

1.  我试图在“添加新项目”对话框的 Web 文件夹中找到“Typescript 文件”，尽管它位于“Visual C#”文件夹中......为什么？

2.  除非您在项目中使用“添加新项目”创建了 .ts 文件，否则文件属性的“构建操作”上的选项“TypeScriptCompile”**不可用**，并且会引发异常。创建第一个文件后，您会找到此选项并可以手动将其设置为 .ts 文件。

3.  选项“Typescript 文件”在“添加文件”选项中不可用，除非您在项目中使用“添加新项目”创建了一个 .ts 文件**并且**您位于“脚本”文件夹中（如果您命名不同的文件夹您要添加此文件，此选项将不可用）。当然，您可以从“添加新项目”中添加一个 .ts 文件。

4.  您无法**轻松地**自己创建 ts 文件，您**必须**使用菜单中的“新建 Typescript 文件”。那是因为：**A）** *文件的代码页* ***不能是 Unicode***（我试图找出这个问题好几个小时）。如果你尝试用 tsc 编译一个 unicode .ts 文件，什么都不会发生！！在我将 .ts 文件保存为希腊语（Windows）之后——就我而言——一切正常！**B)**为使每个文件正常工作必须设置的 .csproj 属性非常复杂。（我试图从 .js 文件开始创建一个 .ts 文件，然后重命名......然后使用 .csproj）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-25T13:49:23.820

我刚刚使用 Web 表单（空项目）创建了一个新的 Web 应用程序。

我发现我必须将目标添加到我的项目文件中......

```
 <Target Name="BeforeBuild">
    <Exec Command="&quot;$(PROGRAMFILES)\Microsoft SDKs\TypeScript\0.8.0.0\tsc&quot; @(TypeScriptCompile ->'&quot;%(fullpath)&quot;', ' ')" />
  </Target> 
```

您需要右键单击并选择“卸载项目”，然后右键单击并选择“编辑”。这个块可以在最后，就在`</Project>`标签之前。

我在 Visual Studio 2012 中添加 TypeScript 文件没有任何问题。

# jquery - 无法发布到 Django Tastypie 跨域 XHR

> ID：13069828
> 
> 赞同：3
> 
> 时间：2012-10-25T13:35:23.480
> 
> 标签：jquery, ajax, django, angularjs, tastypie

试图发布到这个 Django Tastypie API： [http ://lit-hollows-9760.herokuapp.com/api/food](http://lit-hollows-9760.herokuapp.com/api/food)

我安装了这个中间件以允许跨域 XHR： [https ://gist.github.com/1369619](https://gist.github.com/1369619)

```
 from django import http

try:
    from django.conf import settings
    XS_SHARING_ALLOWED_ORIGINS = settings.XS_SHARING_ALLOWED_ORIGINS
    XS_SHARING_ALLOWED_METHODS = settings.XS_SHARING_ALLOWED_METHODS
    XS_SHARING_ALLOWED_HEADERS = settings.XS_SHARING_ALLOWED_HEADERS
    XS_SHARING_ALLOWED_CREDENTIALS = settings.XS_SHARING_ALLOWED_CREDENTIALS
except AttributeError:
    XS_SHARING_ALLOWED_ORIGINS = '*'
    XS_SHARING_ALLOWED_METHODS = ['POST', 'GET', 'OPTIONS', 'PUT', 'DELETE']
    XS_SHARING_ALLOWED_HEADERS = ['Origin', 'Content-Type', 'Accept']
    XS_SHARING_ALLOWED_CREDENTIALS = 'true'

class XsSharing(object):
    """
    This middleware allows cross-domain XHR using the html5 postMessage API.

    Access-Control-Allow-Origin: http://foo.example
    Access-Control-Allow-Methods: POST, GET, OPTIONS, PUT, DELETE

    Based off https://gist.github.com/426829
    """
    def process_request(self, request):
        if 'HTTP_ACCESS_CONTROL_REQUEST_METHOD' in request.META:
            print request.META
            response = http.HttpResponse()
            response['Access-Control-Allow-Origin']  = XS_SHARING_ALLOWED_ORIGINS 
            response['Access-Control-Allow-Methods'] = ",".join( XS_SHARING_ALLOWED_METHODS ) 
            response['Access-Control-Allow-Headers'] = ",".join( XS_SHARING_ALLOWED_HEADERS )
            response['Access-Control-Allow-Credentials'] = XS_SHARING_ALLOWED_CREDENTIALS
            return response

        return None

    def process_response(self, request, response):
        #print request.META
        response['Access-Control-Allow-Origin']  = XS_SHARING_ALLOWED_ORIGINS 
        response['Access-Control-Allow-Methods'] = ",".join( XS_SHARING_ALLOWED_METHODS )
        response['Access-Control-Allow-Headers'] = ",".join( XS_SHARING_ALLOWED_HEADERS )
        response['Access-Control-Allow-Credentials'] = XS_SHARING_ALLOWED_CREDENTIALS
        #print response
        return response 
```

我可以使用 JSONP 来检索 GET 请求，但我不知道如何让 POST 工作。我只是一个301，没有别的了。

```
"OPTIONS /api/food HTTP/1.1" 301 0 
```

演示：http: [//jsfiddle.net/rob_balfre/vgrJD/](http://jsfiddle.net/rob_balfre/vgrJD/)

这就是我用 jQuery 调用 POST 的方式：

```
$.ajax({
  type: 'POST',
  url: 'http://lit-hollows-9760.herokuapp.com/api/food',
  data: '{"name": "Tapas"}',
  success: console.log('jquery worked'),
  dataType: "application/json",
  processData:  false,
  contentType: "application/json"
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T15:13:43.570

我需要将 json 添加到：

```
 serializer = Serializer(formats=['jsonp', 'json']) 
```

美味的资源

# c# - 代码运行时的 ASP.NET 应用程序日志/进度条

> ID：13069829
> 
> 赞同：3
> 
> 时间：2012-10-25T13:35:23.990
> 
> 标签：c#, asp.net, .net, progress-bar, message-queue

我正在我的 ASP 表单 web 应用程序中构建一个 OCR 扫描模块。您可能知道这样的操作可能需要一些时间。因此，我正在使用一个后台服务应用程序来响应运行代码的消息队列，因此用户甚至不必停留在同一个网页上。

我想做的是通知用户在服务运行时发生了什么。如果假设用户上传了 5 个文档，我希望在文字、标签或中继器控件中看到类似的内容。这些项目不必保存在数据库中，我也不想这样做。

*处理文档 1 of 5
文档 1 处理代码 6732842
处理文档 2 of 5
文档 2 处理代码 8732457
处理文档 3 of 5
文档 3 处理代码 8725347
处理文档 4 of 5
文档 4 无法处理“无法识别 OCR 字符串” <br/> 处理文档 5 of 5
文档 5 已处理，代码为 4372537
已完成：已处理 5 个文档中的 4 个已收到*

如果发生错误，我希望看到类似的内容

*发生错误。扫描过程已停止。*

我有一些想法，但我不知道最佳实践是什么。

选项 1：
我可以将上述项目保存在静态类中，并让 javascript 每 5 秒发布一次。通过网络方法获得该值。

选项 2：
当我让 JavaScript 每 5 秒发布一次时，我可以将上述项目保存在返回更新的会话对象的会话中。我不知道这在使用服务应用程序时是否可用。

如果您有任何其他选择（最好是更好的选择），那将不胜感激。

提前谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T13:42:49.167

将进度项保存在数据库中，为每个用户的上传提供不同的 id，使用 Web 服务发布此数据。在浏览器中，使用 JavaScipt 从 Web 服务中检索进度。
当然，数据库需要定期删除，例如每隔一分钟。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T13:46:49.930

我希望我能给你一个可行的例子，但是你想要做的并不容易，而且由于你没有使用 ASP.NET MVC 这使得异步工作更容易，因此变得更加困难。您将需要编写一系列异步任务来为您完成一些工作。这篇文章会给你一个好的开始：http: [//blogs.msdn.com/b/tmarq/archive/2010/04/14/performing-asynchronous-work-or-tasks-in-asp-net-applications.aspx](http://blogs.msdn.com/b/tmarq/archive/2010/04/14/performing-asynchronous-work-or-tasks-in-asp-net-applications.aspx)

# emacs - 如何在emacs中操作线路访问历史？

> ID：13069832
> 
> 赞同：1
> 
> 时间：2012-10-25T13:35:44.557
> 
> 标签：emacs, ide

在**eclipse**中，有一个快捷键*Alt-LeftArrow*可以跳转到最后一行访问。我想知道emacs的编码工具中是否有类似的功能，例如**cedet**。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T13:55:57.323

您可以通过调用跳转到当前文件中最后访问的行`C-u C-SPACE`。

您可以重复调用此命令，以便访问标记环中的所有行。

实际上，emacs 保留了两个标记环——本地和全局。跳到全球响铃中的最新标记`C-x C-SPACE`。对于本地标记环，您可以重复执行此操作。

# c# - 在 C# 中为字符串列表的重复元素添加索引

> ID：13069839
> 
> 赞同：0
> 
> 时间：2012-10-25T13:36:08.450
> 
> 标签：c#, duplicates

我需要一种算法帮助，该算法将为 C# 中的字符串列表中的重复元素添加索引。

IE

```
A, B, C, D, A, B, E, F, A 
```

会变成

```
A, B, C, D, A (1), B (1), E, F, A (2) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T13:40:20.523

```
Dictionary<char,int> counts = new Dictionary<char,int>();

foreach (char c in myCharArray)
{
if (counts.Keys.Contains(c))
{
counts[c]++;
myOutputList.Add(c + "(" + counts[c] + ")");
}
else 
{
counts.Add(c,0);
} 
```

}

添加：

我基本上在做的是一次遍历一个字符的数组。我在字典中记录“我看到每个字符的次数”——每次看到一个新字符时我都会增加。

当我看到一个我已经看过的 - 我按照要求在括号中添加数字。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T14:24:15.130

使用兰巴/LINQ

```
 string x = "A, B, C, D, A, B, E, F, A";
  x = x.Replace(" ", "").Replace(",", ""); //Remove the spaces and commas
  var l = x.Select((v, i) => String.Format("{0}({1})", v, x.Substring(0, i).Count(c => c.Equals(v))));

  var s = l.Select(c=>c.Replace("(0)","")).ToArray();
  string result = String.Join(", ", s); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T13:46:17.550

```
var strings = new string[] { "A", "B", "C", "D", "A", "B", "E", "F", "A" };

Dictionary<string, int> counts = new Dictionary<string, int>();
for (int i = 0; i < strings.Length; ++i)
{
    if (counts.ContainsKey(strings[i]))
        strings[i] = string.Format("{0} ({1})", strings[i], counts[strings[i]]++);
    else
        counts.Add(strings[i], 1);
} 
```

# java - 在 SOLR 中创建集合

> ID：13069841
> 
> 赞同：4
> 
> 时间：2012-10-25T13:36:10.673
> 
> 标签：java, solr, solrj

在网上搜索 SOLR 中的集合时，我只发现了有关分布式搜索等的信息，但是当我了解正确集合的概念时，它们使用相同的模式在同一服务器实例上运行，但在逻辑上是完全分离的。这个对吗？所以我可以有 3 个集合，搜索一个集合不会输出另一个集合的结果，对吗？是否可以*一次*搜索多个集合？

但我的首要任务是：如何创建第二个系列？即使是一个好的文档的链接也将不胜感激。在我的 solr.xml 我有

```
 <cores adminPath="/admin/cores" defaultCoreName="web-collection" host="${host:}" hostPort="${jetty.port:}">
    <core name="web-collection" instanceDir="." />
  </cores> 
```

创建第二个核心条目并设置不同的路径就足够了吗？喜欢...

```
 <cores adminPath="/admin/cores" defaultCoreName="web-collection" host="${host:}" hostPort="${jetty.port:}">
    <core name="web-collection" instanceDir="web" />
    <core name="test-collection" instanceDir="test" />
  </cores> 
```

instanceDir 是关于什么的？它是相对于 SOLR-Home 的索引目录吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-25T14:11:58.517

您可以使用多个核心。每个核心都是一个单独的 lucene 索引。
`instanceDir`是该特定核心的配置文件的位置，包含`conf`目录的文件夹，其中包含`schema.xml`等等`solrconfig.xml`。通常每个核心都有一个子文件夹`solr.xml`（SOLR_HOME），并使用相对路径在其内部引用它们`solr.xml`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T16:49:22.787

有关设置核心及其工作方式的更多信息，请参阅[Solr Wiki - CoreAdmin](http://wiki.apache.org/solr/CoreAdmin)了解更多详细信息和一些示例。

您添加第二个核心条目的示例就足够了。

实例目录是相对于您的 SOLR 主值的索引目录。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-07-23T20:29:08.007

除了 REST API，您还可以使用 SolrJ 创建新内核。在自己努力创建一个之后，这就是我最终做的事情：

```
SolrServer aServer =  new HttpSolrServer("http://127.0.0.1:8983/solr");
CoreAdminResponse aResponse = CoreAdminRequest.getStatus(collectionName, aServer);

if (aResponse.getCoreStatus(aNewInstance.getCollection()).size() < 1)
{
    CoreAdminRequest.Create aCreateRequest = new CoreAdminRequest.Create();
    aCreateRequest.setCoreName(collectionName);
    aCreateRequest.setInstanceDir(collectionName);
    aCreateRequest.process(aServer);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-04-18T16:34:57.037

# **用 Solr 6.x 测试**

幸运的是，现在有一个标准`create`的脚本选项`bin/solr`能够检测 Solr 在哪种模式下运行（独立或 SolrCloud），然后采取适当的操作（创建核心或创建集合）。

```
$ bin/solr create -help

Usage: solr create [-c name] [-d confdir] [-n configName] [-shards #] [-replicationFactor #] [-p port] 
```

例如，假设您在 port 上运行最新版本的 Solr `8983`，请创建一个正在运行的新内核：

```
bin/solr create -c collection1 -d /path/to/solr/conf 
```

对于有时在集合和核心之间发生的混淆，必须做一个重要的区分。从客户端的角度来看没有区别，所以创建一个核心或集合取决于 Solr 是在独立（核心）还是 SolrCloud 模式（集合）下运行。

如需更完整的区别，请参阅[Solr Collection vs Cores](https://stackoverflow.com/questions/17044640/solr-collection-vs-cores)

# c# - 非静态字段需要对象引用

> ID：13069842
> 
> 赞同：1
> 
> 时间：2012-10-25T13:36:11.900
> 
> 标签：c#, asp.net, oop

所以我有一个嵌套类 - PeerReviews。我正在尝试在 ASPX 页面上创建一个列表框，并且我正在实例化 PeerReviews 的对象，如下所示：

```
PeerReviews obj = new PeerReviews(); 
```

但是，我收到一条错误消息，表明此行导致我的代码出现问题：

```
listBox1.Items.Add(new ListItem(r["first_name"], r["first_name"])); 
```

这是嵌套类的完整代码：

```
class PeerReviews
        {
            private static void PeerReview()
            {

                MySqlConnection con = new MySqlConnection("server=localhost;database=hourtracking;uid=username;password=password");
                MySqlCommand cmd = new MySqlCommand("select first_name from employee where active_status=1", con);
                con.Open();
                MySqlDataReader r = cmd.ExecuteReader();

                while (r.Read())
                {
                    listBox1.Items.Add(new ListItem(r["first_name"], r["first_name"]));
                }
                con.Close();

            }
        } 
```

如何引用列表框项？我试图将它实例化为一个对象（这似乎不正确）。

我对 OOP 编程只是马马虎虎（我已经完成了一些，但我在 C# 中工作的原因之一是强迫自己使用它）而且我仍然几乎是 C# 的新手ASP.NET

编辑：

这是 ASPX 代码：

```
<asp:ListBox ID="listBox1" runat="server">
</asp:ListBox> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T13:45:17.807

我认为您需要删除函数`static`上的关键字。`PeerReview`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T13:46:29.517

将对具有 listbox1 的对象的引用传递给静态 PeerReview 方法。类的静态方法不能访问其类或任何其他类的非静态字段/属性/方法。它只能访问其他静态类字段/属性/方法、局部变量和参数

你需要类似的东西（我不确定 System.Web.UI.Page 的实例是否包含 listBox1，但我正在询问）

```
private static void PeerReview(System.Web.UI.Page page)
{
//...
page.listBox1.Items.Add(new ListItem(r["first_name"], r["first_name"]));
//...
} 
```

或如罗林所说：

```
 private static void PeerReview(System.Web.UI.WebControls.ListBox listbox)
    {
    //...
    listbox.Items.Add(new ListItem(r["first_name"], r["first_name"]));
    //...
    } 
```

# c# - 在 CurrentCellChanged 上获取 WPF DataGrid 的单元格内容

> ID：13069845
> 
> 赞同：4
> 
> 时间：2012-10-25T13:36:26.990
> 
> 标签：c#, wpf, datagrid

我有一个`WPF` `DataGrid`. 我想`cell`在用户编辑它后获取该值。`DataGrid`已经填充了数据。用户可以编辑以前的数据。为了保存数据，我想`cell`从`event handler`

给我一个简单的代码来做到这一点。建议一`event handler`。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-25T14:56:32.190

您可以使用 CellEditEnding 事件在用户编辑单元格时获得通知。

这个简单的程序说明了它：

**XAML**

```
<Window x:Class="WpfApplication1.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:WpfApplication1"
        Title="MainWindow" Height="500" Width="500">
    <Grid>
        <DataGrid x:Name="grid" CellEditEnding="cellEditEnding" />
    </Grid>
</Window> 
```

**代码隐藏**

```
public partial class MainWindow : Window
{
    public class MyClass
    {
        public string Prop1 { get; set; }
        public string Prop2 { get; set; }
        public string Prop3 { get; set; }
    }

    public MainWindow()
    {
        InitializeComponent();

        var objects = new[] 
        { 
            new MyClass { Prop1 = "Object1", Prop2 = "Test1", Prop3 = "Hello" },
            new MyClass { Prop1 = "Object2", Prop2 = "Test2", Prop3 = "Goodbye" },
            new MyClass { Prop1 = "Object3", Prop2 = "Test3", Prop3 = "Welcome" }
        };

        grid.ItemsSource = objects;
    }

    private void cellEditEnding(object sender, DataGridCellEditEndingEventArgs e)
    {
        //Only handles cases where the cell contains a TextBox
        var editedTextbox = e.EditingElement as TextBox;

        if (editedTextbox != null)
            MessageBox.Show("Value after edit: " + editedTextbox.Text);
    }
} 
```

# c# - 模块是在没有调试信息的情况下构建的

> ID：13069846
> 
> 赞同：1
> 
> 时间：2012-10-25T13:36:29.583
> 
> 标签：c#, msbuild, finalbuilder

将调试器附加到进程时出错：

> “要调试此模块，请将项目构建配置更改为调试模式。”

我正在使用 MSBUILD 运行 finalbuilder。输出说：

> 使用参数运行 C:\Windows\Microsoft.NET\Framework\v4.0.30319\MSBuild.exe：/t:Build /nr:false /logger:FinalBuilderLogger,"C:\Program Files (x86)\FinalBuilder 7\FinalBuilder。 MSBuild.Logging.v4.0.dll" /noconlog /p:Configuration="Debug";Platform="AnyCPU" /v:normal /m /p:solutionDir="C:\TFS10\Ecc\TestBranch\" "ProjectName .csproj"

除非我错过了什么（不会是第一次），否则这些参数建议使用没有优化的 Debug 构建。那么为什么会出错呢？

注意：我在 finalbuilder 中进行构建时遇到了一个奇怪的问题，我必须在 msbuild 的第一个属性组中设置输出路径：

```
<Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration> 
 <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
 <OutputPath>bin\Debug\</OutputPath>/* this has to be here */ 
```

在这个组中`<DebugType>`并**没有**设置。所以它们是默认值。`<DebugSymbols>`

 **如果它设置在下一个属性组中，`'Debug|AnyCPU'`单独的属性组我得到一个关于找不到输出路径的构建错误：

```
<PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
    <OutputPath>bin\Debug\</OutputPath> 
```

这表明构建条件是默认（空白）而不是出于某种原因调试。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T15:09:26.020

FinalBuilder 没有复制 PDB 文件。在我的情况下，服务器已经有 PDB 文件，但它们与当前版本不匹配。因此，由于错误，问题很难追查。希望他们说“找不到 PDB 文件”而不是模糊的优化被关闭......**

# php - 如何获取 apache 400（错误请求）和 401（需要授权）？

> ID：13069853
> 
> 赞同：1
> 
> 时间：2012-10-25T13:36:39.657
> 
> 标签：php, apache

我想重现 400（错误请求）和 401（需要授权）错误。有人可以告诉我如何在我的服务器上制作它们吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T13:41:12.950

```
header("HTTP/1.0 401 Bad Request"); 
```

如此处可见[http://php.net/manual/en/function.header.php](http://php.net/manual/en/function.header.php)

# screen-scraping - scrapy如何设置referer url

> ID：13069854
> 
> 赞同：11
> 
> 时间：2012-10-25T13:36:41.377
> 
> 标签：screen-scraping, scrapy

我需要设置引荐来源网址，在抓取网站之前，该网站使用基于引荐来源网址的身份验证，因此如果引荐来源网址无效，我将无法登录。

有人可以告诉如何在 Scrapy 中执行此操作吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-14T13:41:59.070

如果您想更改蜘蛛请求中的引用者，可以[`DEFAULT_REQUEST_HEADERS`](https://docs.scrapy.org/en/latest/topics/settings.html#default-request-headers)在**settings.py**文件中进行更改：

```
DEFAULT_REQUEST_HEADERS = {
    'Referer': 'http://www.google.com' 
} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2014-02-15T13:23:43.913

您应该完全按照@warwaruk 的指示进行操作，以下是我对爬行蜘蛛的详细说明：

```
from scrapy.spiders import CrawlSpider
from scrapy import Request

class MySpider(CrawlSpider):
  name = "myspider"
  allowed_domains = ["example.com"]
  start_urls = [
      'http://example.com/foo'
      'http://example.com/bar'
      'http://example.com/baz'
      ]
  rules = [(...)]

  def start_requests(self):
    requests = []
    for item in self.start_urls:
      requests.append(Request(url=item, headers={'Referer':'http://www.example.com/'}))
    return requests    

  def parse_me(self, response):
    (...) 
```

这应该在您的终端中生成以下日志：

```
(...)
[myspider] DEBUG: Crawled (200) <GET http://example.com/foo> (referer: http://www.example.com/)
(...)
[myspider] DEBUG: Crawled (200) <GET http://example.com/bar> (referer: http://www.example.com/)
(...)
[myspider] DEBUG: Crawled (200) <GET http://example.com/baz> (referer: http://www.example.com/)
(...) 
```

将与 BaseSpider 相同。最后 start_requests 方法是 BaseSpider 方法，CrawlSpider 继承自该方法。

[文档](http://doc.scrapy.org/en/latest/topics/request-response.html#request-objects)解释了除了 headers 之外要在 Request 中设置的更多选项，例如：cookies、回调函数、请求的优先级等。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-11-29T08:24:40.967

只需在请求标头中设置Referer url

> `class scrapy.http.Request(url[, method='GET', body, headers, ...`
> 
> `headers (dict) – the headers of this request. The dict values can be strings (for single valued headers) or lists (for multi-valued headers).`

例子：

`return Request(url=your_url, headers={'Referer':'http://your_referer_url'})`

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-10-28T15:40:13.377

覆盖[`BaseSpider.start_requests`](http://doc.scrapy.org/en/latest/topics/spiders.html#scrapy.spider.BaseSpider.start_requests)并在那里创建您的自定义[请求](http://doc.scrapy.org/en/latest/topics/request-response.html#request-objects)，并将其传递给您的`referer`标头。

# c++ - 你如何使用这个数组而不是要求输入？

> ID：13069858
> 
> 赞同：1
> 
> 时间：2012-10-25T13:36:52.293
> 
> 标签：c++, arrays

在课堂上学习数组。尝试通过使用我的数组而不是下面的示例来玩下面的代码来理解它们。

数组示例：

```
string[16] = {"Toelle","Red Lightning","Penguins","Tigers","You Know It","VP4LIFE","OG      WOW","Indy","Ok","NOSER","LAK State","THE State","NY","Ks","Tahaa","Fosda"}; 
```

代码：

```
#include <fstream>
#include <iostream>
#include <string>
#include <vector>
using namespace std;

// This program inputs a list of team names and runs a random tournament to find the winner.

void print_teams(string *ptr, int size)
{
    for(int team = 0; team < size; team++)
    {
        cout << "Team "<<team<<"="<<ptr[team]<<endl;
    }
}
int main()
{
    const int NTEAMS=4;
    string *teams = new string[NTEAMS];

    // Get input from the user for the teams
    for(int team = 0; team < NTEAMS; team++)
    {
        cout <<"Enter the name for team #"<<team<<":";
        getline(cin, teams[team]);
    }
    print_teams(teams, NTEAMS);

    int teams_left = NTEAMS;
    string *team_ptr = teams;

    for(int round = 0; teams_left > 1; round++) {
        // Allocate space for the winners
        int new_size = teams_left/2;
        string *new_teams = new string[new_size];
        // Run a round of the tournament
        for(int team = 0; team < teams_left; team+=2) 
        {
            // Pick a winner
            int winner = rand()%2;
            //update the winners array
            new_teams[team/2] = team_ptr[team+winner];
        }
        cout << "Round "<<round<<endl;
        print_teams(new_teams, new_size);
        // Update the size and team pointer for the next round
        teams_left = new_size;
        // Free up the space for the old teams list
        delete[] team_ptr;
        team_ptr = new_teams;
    }
    system("pause");

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T13:57:52.787

您需要将与数组一起使用的代码移动到一个单独的函数，该函数接收数组作为参数。可以从 cin、硬编码或任何其他来源读取该数组。这样您就可以在这两种情况下重用您的代码。这里的关键概念是将输入与实际计算分离。

# javascript - Phonegap Jquery Mobile 将数据保存到手机

> ID：13069859
> 
> 赞同：2
> 
> 时间：2012-10-25T13:36:57.917
> 
> 标签：javascript, jquery, cordova, jquery-mobile

我在下面尝试一些简单的东西。我想接受用户输入他们的名字，点击一个按钮保存它，当应用程序第二次加载时，它会显示名字。

我在下面哪里出错了？

我需要把这个代码块放在别的地方吗？

```
 <script type="text/javascript">

$(function(){
$('#saveButton').click(function() {
        window.localStorage.setItem("name", $('#name').val());
});
    $('#newpage').live('pageshow', function() {
        var personName = window.localStorage.getItem("name");
        if(personName.length>0){
                $('#name').val(personName);
        }
    });

});
</script> 
```

完整的 html 文件

```
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="format-detection" content="telephone=no" />
<meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
<link rel="stylesheet" type="text/css" href="jquery.mobile-1.2.0.css" />
<script type="text/javascript" src="jquery-1.8.2.js"></script>
<script type="text/javascript" src="jquery.mobile-1.2.0.js"></script>

<script type="text/javascript">

$(function(){
$('#saveButton').click(function() {
        window.localStorage.setItem("name", $('#name').val());
});
    $('#newpage').live('pageshow', function() {
        var personName = window.localStorage.getItem("name");
        if(personName.length>0){
                $('#name').val(personName);
        }
    });

});
</script>

<title>Hello World</title>
</head>
<body>
<div id="home" data-role="page">
    <div data-role="header">
        <h1>
            Home Page</h1>
    </div>
    <div data-role="content">
        hello Phone Gap and JQuery Mobile! <a href="#newpage" data-role="button">new page</a>
    </div>
    <div data-role="footer" data-position="fixed">
        <h4>
            footer</h4>
    </div>
</div>

<div id="newpage" data-role="page">
    <div data-role="header">
        <h1>
            new Page</h1>
    </div>
    <div data-role="content">
        <label for="name">what is your name?</label>
        <input id="name" type="text" name="name" value="" />
        <a id="saveButton" href="" data-role="button">Save</a>
    </div>
    <div data-role="footer" data-position="fixed">
        <h4>
            footer</h4>
    </div>
</div>
<script type="text/javascript" src="cordova-2.1.0.js"></script>
<script type="text/javascript" src="js/index.js"></script>
<script type="text/javascript">
    app.initialize();
</script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-25T13:42:50.203

是的，您需要在事件中放置按钮单击事件连接`pageinit`- 他们甚至在[文档中指定了这一点](http://jquerymobile.com/demos/1.2.0/docs/api/events.html)

```
$(document).on("pageinit","#newpage",function(){
    $('#saveButton').click(function() {
        localStorage.setItem("name", $('#name').val());
    });
});

$(document).on('pageshow','#newpage', function() {
    var personName = localStorage.getItem("name");
    if(personName.length>0){
            $('#name').val(personName);
    }
}); 
```

**对于 iOS 设备测试：**如果您的更改未反映在您的设备上，请确保`touch`在部署之前检查您的文件。Phonegap 的默认项目模板已经这样做了，但是他们的命令对我不起作用。查看我的回答：[https ://stackoverflow.com/a/12707386/561545](https://stackoverflow.com/a/12707386/561545)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-21T12:50:24.830

小修正！`.val`应该是`.html`。请看下面的代码。

```
$('#my_name').html(personName); 
```

添加：

```
div id="my_name" 
```

# xcode - 我是否必须显式调用 setDelegate: 和 setDatasource: 来获取作为 UIViewController 属性的 UITableView？

> ID：13069862
> 
> 赞同：0
> 
> 时间：2012-10-25T13:37:12.253
> 
> 标签：xcode, uitableview

背景优先：我有一个 UIViewController 和 3 个工作 UITableViews。我添加了第四个表，但我的控制器从未为我的第四个表调用任何 UITableViewDelegate 或 UITableViewDataSource 方法（例如 tableView:cellForRowAtIndexPath），仅对前三个表调用。在哭泣和咬牙切齿之后，我发现我需要打电话给`[self.myFourthTable setDelegate:self]`我`[self.myForthTable setDelegate:self]`的`viewDidLoad`.

我从来没有为我的前 3 个表调用这些方法中的任何一个。这里发生了什么？为什么我必须为我的第四张桌子调用这些，而不是前三张？据我所知，第四个应该和前三个一样对待——它们都是我的视图控制器的属性，它们都是合成在一起的，我在我的代码中以同样的方式处理它们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T13:40:45.437

我的猜测是这些 UITableViews 是在 Interface Builder 中添加的。前三个通过 Interface Builder 中的插座设置了它们的数据源和委托。你没有这样做，所以需要通过代码来做。

![截图示例](../Images/570c2ba5d7703a77bf99768ea5d23ddf.png)

# java - SWT - 继承父对话框外壳？

> ID：13069865
> 
> 赞同：0
> 
> 时间：2012-10-25T13:37:29.293
> 
> 标签：java, dialog, swt

我真的需要了解父/子对话框的工作原理。

我的用户使用名为 Teamcenter 的 OTB 应用程序。我正在编写一个从 Teamcenter 应用程序中的菜单选择调用的附加应用程序。

当他们单击菜单项时，它将执行一个处理程序类并为我的应用程序创建基本对话框。

```
public class AplotDialogHandler extends AbstractHandler {
  private static AplotBaseDialog dlg = null;

  public AplotDialogHandler() {

  }// end Constructor

  //////////////////////////////////////////////////////////////////////////
  //                            execute()                                 //
  //////////////////////////////////////////////////////////////////////////
  @Override 
  public Object execute(final ExecutionEvent event) throws ExecutionException {
     if (dlg == null) {
        try {
           AbstractAIFApplication app = AIFDesktop.getActiveDesktop().getCurrentApplication();
        TCSession session = (TCSession) app.getSession();
        TCUserService userService = session.getUserService();

        AplotVersion.negotiateVersion(userService);
        AplotQueryCapabilities.initialize(userService);

        dlg = new AplotBaseDialog(null, session);
     }
     catch (Exception ex) {
        MessageBox.post(HandlerUtil.getActiveWorkbenchWindowChecked(event).getShell(), ex, true);
     }
  }

  dlg.create();
  dlg.getShell().setSize(700, 400);
  dlg.open();

  return null;
 }// end execute()
}// end EdiDialogHandler() 
```

问题 1\. 我的应用程序似乎没有绑定到 Teamcenter 应用程序。这意味着我可以关闭 Teamcenter 并且我的应用程序保持打开状态。

问题 2\. 我应该获取工作区外壳并将其传递到基本对话框中吗？但是即使我的应用程序打开了，用户仍然需要能够使用 Teamcenter 应用程序来选择要发送到我的应用程序的数据

问题 3\. 从我的基本对话框打开对话框时，我是否应该始终将基本对话框外壳传递给这些对话框？

问题 4\. 当用户完成后，我应该关闭对话框是否有标准方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T16:14:32.980

您需要将父 Shell 传递给对话框，以便在关闭父 Shell 时，子 Shell 也将关闭。

你应该让你的对话框MODELESS（`SWT.MODELSS`用作样式。注意：它是提示），这样它就不会阻塞你的父shell。

这是示例代码：

```
 public static void main(String[] args) {

    Display display = new Display();
    final Shell shell = new Shell(display);
    shell.setLayout(new GridLayout(1, false));
    shell.setSize(200, 200);
    Button b = new Button(shell, SWT.NONE);
    b.setText("Click");
    b.addSelectionListener(new SelectionListener() {

      @Override
      public void widgetSelected(SelectionEvent e) {

         CDialog dialog = new CDialog(shell);

         dialog.open();
      }

      @Override
      public void widgetDefaultSelected(SelectionEvent e) {

        // TODO Auto-generated method stub

      }
    });

    shell.open();

    while (!shell.isDisposed()) {
      if (!display.readAndDispatch())
        display.sleep();
    }
    display.dispose();
  }  

  private static class CDialog extends Dialog
  {

    /**
     * @param parentShell
     */
    protected CDialog(Shell parentShell) {

      super(parentShell);
    }

    /* (non-Javadoc)
     * @see org.eclipse.jface.dialogs.Dialog#createDialogArea(org.eclipse.swt.widgets.Composite)
     */
    @Override
    protected Control createDialogArea(Composite parent) {

      Composite comp =  (Composite) super.createDialogArea(parent);

      Label lbl = new Label(comp, SWT.NONE);
      lbl.setText("Test modeless dialog");

      return comp;
    }
    /* (non-Javadoc)
     * @see org.eclipse.jface.window.Window#getShellStyle()
     */
    @Override
    protected int getShellStyle() {
      return SWT.DIALOG_TRIM|SWT.MODELESS;
    }

  } 
```

# sqlite - 在内存中预填充 SQLite 数据库以进行 Nhibernate 测试

> ID：13069866
> 
> 赞同：1
> 
> 时间：2012-10-25T13:37:32.373
> 
> 标签：sqlite, unit-testing, nhibernate

目前，我有一个单元测试框架，我在内存中使用带有 NHibernate 的 SQLite 数据库进行单元测试。每个单元测试都在自己的会话中运行以确保独立性。在大多数情况下，这很棒，但是当我接近 150 次测试时，它开始运行有点慢。这样做的主要原因是，在每次测试之前，我必须在数据库中插入大量数据。

基本上我的应用程序是一个工作流应用程序，我们在数据库中存储了很多关于工作流的信息（步骤数、每个步骤的字段等）。除非有这些东西，否则应用程序无法运行，因此我的测试需要它。

此时，我的总测试时间中大约有 4 分钟用于在每个单元测试之前填充数据库。我很想在每次测试执行时让这个人口发生一次，但由于在会话关闭时内存数据库被破坏，我不确定如何。有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T14:33:40.563

您可以将预填充的数据库文件复制到临时目录（如果可能，在 RAM 磁盘上）。

[或者，您可以使用SQLite 备份 API](http://www.sqlite.org/backup.html)将数据库的内容复制到内存数据库中。

# ruby-on-rails - 增加数据库中的计数器

> ID：13069871
> 
> 赞同：17
> 
> 时间：2012-10-25T13:37:43.263
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord

我的数据库中有一个名为 ads_counter 的字段，每次呈现此广告时我都需要增加它的值。

我尝试编写一个自定义方法并在负责此数据的控制器中使用它，但这不起作用。是否有任何内置方法可以增加数据库中字段的值？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-10-25T13:48:54.460

是的`increment`，您可以在 ActiveRecord 中调用该方法。

供参考：[增量](http://apidock.com/rails/ActiveRecord/Persistence/increment)

**编辑：**

要使其直接保存，请使用`increment!`

你可以这样使用它：

```
instance.increment!(:ads_counter) 
```

它会自动增加 1

```
instance.increment!(:ads_counter, <number>) 
```

它按提供的数字递增

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T13:48:54.147

您有[`increment!`](http://apidock.com/rails/v3.2.8/ActiveRecord/Persistence/increment!)增加属性并保存记录的方法

```
your_object.increment!(:ads_counter) 
```

将此代码放入`show`控制器的方法中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-11-09T04:06:23.073

你可以试试[增量！](https://railsguide.org/rails/ActiveRecord::Callbacks/increment!)方法

```
object.increment!(:method_name) 
```

# perl - Perl DBI 与 PostgreSQL 的连接在数据库错误时不会死（）

> ID：13069873
> 
> 赞同：1
> 
> 时间：2012-10-25T13:38:04.020
> 
> 标签：perl, postgresql, error-handling

当 SQL 出错时，我习惯于 Perl “崩溃”我的脚本，但 Postgres 只是将错误提供给 Apache 错误日志并且脚本继续。调试代码的邪恶行为。

现在我已经问过谷歌的甲骨文，但要么我问错了问题，要么很不可能，我是唯一一个有这个问题的人。;)

简而言之：我希望 Postgres 出现与 MySQL 相同的错误行为，即“崩溃”脚本并注意`use CGI::Carp qw(fatalsToBrowser);`并向我显示错误的 SQL 语句。

如果这很重要，我正在使用 good old`DBI`在我的服务器上的 Ubuntu 10.04 上访问 PG-DB、Postgres 8.4 和 Perl 5.10.1。所有软件包均来自官方代表。

编辑：感谢理查德赫克斯顿，这已经解决了，让其他人找到解决方案。

```
our $dbh = DBI->connect($DBUrl, $DBUser, $DBPass,{ RaiseError => 1}
           ) || die "Could not connect to database: $DBI::errstr"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T13:49:23.400

当然，您只需要在建立连接时设置 RaiseError 吗？

[https://metacpan.org/module/DBI](https://metacpan.org/module/DBI)

# vbscript - 使用 WScript 从错误消息对话框中读取消息

> ID：13069875
> 
> 赞同：3
> 
> 时间：2012-10-25T13:38:09.790
> 
> 标签：vbscript, wsh

问题定义：编写 wscript 以单击错误消息对话框的“确定”按钮并获取/读取对话框中给出的错误消息。错误消息是通过宏验证 Excel 生成的。

实现：我可以点击msgbox的“OK”按钮

卡住：我无法阅读错误消息

代码编写：

```
Set oShell = CreateObject("WScript.Shell") 

Do 
    bResult = oShell.AppActivate("Save As") 
    If bResult = True Then 
        oShell.SendKeys "{ENTER}" 
        Exit Do 
    End If 
    WScript.Sleep 500 
Loop 
```

# url - CakePHP2.1 删除 url 中的 id

> ID：13069878
> 
> 赞同：0
> 
> 时间：2012-10-25T13:38:13.443
> 
> 标签：url, cakephp-2.1

我正在使用 cakephp 2.1，并且我已经编写了一些操作，例如查看、编辑和删除。在 url 中，它看起来像 'view/1'、'edit/1'、'delete/1'，这样我就可以更改 url 中的 id。我不想在 url 中更改它，它不应该允许编辑 id。请帮我这样做。工作会更有价值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T22:15:31.533

好的......我想我理解你的问题。您担心如果人们可以编辑 ID，因为它们在 URL 中可见，那么这将是一个安全威胁？

一、查看动作：

您应该在服务器端检查用户是否有权查看具有该特定 ID 的记录。如果他们不这样做，那么你可以给出一个错误。如果他们这样做了，那么让他们查看它 - 不要担心他们是如何到达那里的，无论他们是否编辑了 URL 中的 ID。如果他们有权查看记录，就让他们查看。

二、删除动作：

同样，就像查看操作一样，您应该在服务器端检查用户是否有权删除记录。如果他们这样做，那么让他们删除它！如果他们编辑了 URL 中的 ID，请不要担心。如果用户没有删除记录的权限，那么您的服务器端检查将阻止他们，即使他们已经编辑了 URL 中的 ID。

三、编辑动作：

这稍微复杂一些，但仍然很容易。我假设您正在使用 HTML 表单编辑记录，并通过 POST 提交。好的，所以 URL 中的 ID 决定了要获取和编辑的记录。与查看和删除一样，您应该进行服务器端检查以确保用户有权编辑该项目。如果他们确实获得许可，则返回表格。

一旦表单加载完毕，浏览器中显示的 URL 就不再重要了。表单提交到的 URL 以及表单提交的数据很重要。现在，默认情况下，编辑表单会将 ID 存储在隐藏的输入字段中。用户可以更改该 ID，从而更改他们正在编辑的记录。

为了防止这种情况，请使用 CakePHP 的安全组件。您需要做的就是包含该组件，CakePHP 会在表单加载时自动在表单上放置一个散列，当表单提交时它会再次检查该散列。如果用户编辑了隐藏的输入字段，则此检查将失败，并且 CakePHP 将不允许继续进行编辑。

请注意，要以这种方式使用安全组件，您必须使用 CakePHP 的表单助手（您可能已经使用）构建表单。

最后一点......有时人们对任何人在他们的数据库中看到 ID 有点偏执 - 因此不希望他们显示在 URL 或其他任何地方。但是，几乎在所有情况下，ID 都没有什么“秘密”。谁看到他们并不重要。它们只是您的应用程序和数据库识别记录的一种手段。只要您的应用程序是安全的，那么您应该能够向全世界展示您的所有 ID，而无需担心。

# android - 以编程方式将按钮宽度设置为父 LinearLayout 的 50%

> ID：13069882
> 
> 赞同：5
> 
> 时间：2012-10-25T13:38:21.600
> 
> 标签：android, android-layout, android-linearlayout

我使用 LinearLayout 创建了一个对话框，在这个对话框中，我有一个按钮。我想将其宽度设置为 Dialog 宽度的 50%，但无论我做什么，按钮仍会填充整个宽度。主要问题似乎是我无法以编程方式设置按钮的权重。我尝试创建第二个水平线性布局，它将权重设置为 0.5f 的按钮（父级的 weightSum 为 1），但这并没有改变任何东西。如何将按钮设置为宽度的一半？

我查看了所有其他问题，但其中大多数都使用 xml，因此它们不相关，而以编程方式解决它的问题是使用以像素为单位的硬编码值，这显然是问题的错误解决方案。

编辑：添加一些代码

```
LinearLayout linearLayout = new LinearLayout(mContext);
linearLayout.setOrientation(LinearLayout.VERTICAL);
linearLayout.setWeightSum(1);

// I use these params when I call addContentView
LinearLayout.LayoutParams layoutParams = new LinearLayout.LayoutParams(LinearLayout.LayoutParams.MATCH_PARENT, LinearLayout.LayoutParams.MATCH_PARENT);

testButton = new Button(mContext);
testButton.setText("Test");
testButton.setId(1);
testButton.setWidth(0);
testButton.setGravity(Gravity.CENTER);

LinearLayout buttonLayout = new LinearLayout(mContext);
butonLayout.setOrientation(LinearLayout.HORIZONTAL);

LinearLayout.LayoutParams buttonParams = new LinearLayout.LayoutParams(LinearLayout.LayoutParams.MATCH_PARENT, LinearLayout.LayoutParams.WRAP_CONTENT, 0.5f);
testButton.setLayoutParams(buttonParams);
buttonLayout.addView(testButton);

linearLayout.addView(buttonLayout);

...

this.addContentView(scrollView, layoutParams); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-25T15:21:19.860

随着我尝试越来越多的选项，代码变得一团糟。我决定从头开始，这段代码最终奏效了：

```
LinearLayout forButton = new LinearLayout(mContext);
forButton.setOrientation(LinearLayout.HORIZONTAL);
LinearLayout.LayoutParams forButtonParams = new LinearLayout.LayoutParams(LinearLayout.LayoutParams.MATCH_PARENT, LinearLayout.LayoutParams.WRAP_CONTENT);
forButton.setGravity(Gravity.CENTER);

DisplayMetrics dm = new DisplayMetrics();
this.getWindow().getWindowManager().getDefaultDisplay().getMetrics(dm);
int width = dm.widthPixels;

forButton.addView(testButton);
testButton.getLayoutParams().width = width/2; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-25T13:46:31.400

您是否也将宽度值设置为 0dp ？这是布局引擎自动分别使用布局权重所必需的。

**编辑**

我认为这条线会给你你正在寻找的结果：

```
LayoutParams buttonParams = new LinearLayout.LayoutParams(0, LinearLayout.LayoutParams.WRAP_CONTENT, 0.5f); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-25T13:55:18.853

查找对话框宽度

```
DisplayMetrics dm = new DisplayMetrics();
     dialog.getWindow().getWindowManager().getDefaultDisplay().getMetrics(dm);
    int width = dm.widthPixels ; 
```

以编程方式设置值

```
final LayoutParams lparams = new LayoutParams(Height,width/2); // Width , height
    final Button button = new Button(this);
    button.setLayoutParams(lparams); 
```

**编辑**

```
WindowManager.LayoutParams lp = new WindowManager.LayoutParams();

lp.copyFrom(alertDialog.getWindow().getAttributes());
lp.width = 200;
lp.height = 200;
alertDialog.getWindow().setAttributes(lp); 
```

# sql-server-2008-r2 - SQL Server Management Studio - 服务器名称消失

> ID：13069892
> 
> 赞同：9
> 
> 时间：2012-10-25T13:38:55.687
> 
> 标签：sql-server-2008-r2, ssms, sql-server-2008

打开 SSMS（我的是 2008 R2）时出现的第一个对话框允许您选择要连接的服务器。

我在该列表中至少有六台服务器，包括一个名为的本地服务器`MYPC/SQLSERVEREXPRESS`

Windows 更新昨晚运行并重新启动了我的机器，现在我的 SSMS 服务器列表不见了。我可以选择`(local)`或`(browse for more)`

我之前保存的服务器及其保存的登录信息发生了什么变化？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T13:52:48.590

存储这些 2008 的文件位于 c:\%UserProfile%\Microsoft\Microsoft SQL Server\100\Tools\Shell\SqlStudio.bin

我的猜测是它仍然存在，但已被您的一个更新覆盖，您可以检查它以查看上次修改的时间。

如果再次发生这种情况，您应该使用已注册的服务器并导出文件以节省时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T09:20:42.077

据我了解，您想从该文件中检索您的凭据。

如果您仍然有 sqlstudio.bin 文件并且您可以在那里看到“密码”条目，那么有一种方法可以恢复您的密码。

首先，一些理论：当 SSMS 保存连接对象时，它使用某种加密方法加密密码，即绑定到您的 Windows 登录。如果您尝试将 sqlstudio.bin 复制到其他机器/用户配置文件，密码将不会被解密。因此，重要的是您在同一个 Windows 帐户下执行所有操作，然后生成 sqlstudio.bin。我不能告诉你，如果你可以直接操作 sqlstudio.bin - 我想那里有一些校验和会禁止直接操作，但还有另一种方法。

我知道我上面写的信息，因为我自己开发了一个 SSMS - [SSMSBoost](http://www.ssmsboost.com)的插件。我已经在那里实现了管理首选连接的逻辑（这样你实际上就不再需要标准对话了）。我使用完全相同的 SSMS 对象来存储连接并序列化为 XML，因此更易于操作。下图显示了相同连接的 sqlstudio.bin 和 SSMSBoostSettings.xml 的内容。您可以识别，用户名和密码二进制数据是相同的。因此，要恢复您的密码，您必须：

1.  安装 ssmsboost

2.  使用 sql server 安全性添加到任何数据库的首选连接

3.  打开 SSMSBoostSettings.xml（保存设置后，您将在设置对话框中看到该文件的路径。只需保存，关闭并重新打开它。路径显示在底部）

4.  关闭 SSMS，在编辑器中打开 sqlstudio.bin 和 ssmsboostsettings.xml

5.  修改 ssmsboostsettings.xml 中的条目 - 从 sqlstudio.bin 输入服务器的数据 - 地址、数据库名称、用户名。仔细复制密码数据。

6.  保存 xml 并打开 SSMS - SSMSBoost 现在将在首选连接中显示您的连接，您将能够连接到数据库。（见第二张图）

![找回密码 ssms 连接](../Images/80751288f4bd92b48cee274e58b6f4a4.png) ![在此处输入图像描述](../Images/fb44f1e213ec2940557c21b7cd62935c.png)

# iphone - iOS - 如何在动画期间拖动元素

> ID：13069896
> 
> 赞同：0
> 
> 时间：2012-10-25T13:39:37.467
> 
> 标签：iphone, ios, animation, drag-and-drop

我需要在动画期间拖动一个元素。该元素从屏幕顶部掉落，我需要用户可以将其拖动到任何他想要的地方，即使在动画期间也是如此。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T13:59:56.797

您可以使用 touchesBegan 方法来检测用户何时触摸元素。

```
-(void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {
    UITouch *touch = [touches anyObject];
    if (touch != nil && (touch.view == elementView))
        //do your stuff
} 
```

然后将元素的位置设置为触摸位置，并移除动画。

```
elementView.center = [touch locationInView:self.view];
[elementView.layer removeAllAnimations]; 
```

这应该有效。然后可以使用类似的 touchesMoved 方法在拖动过程中更新位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T14:24:34.500

由于您使用的是`UIView`基于块的动画，请尝试使用：

```
animateWithDuration:delay:options:animations:completion: 
```

与`UIViewAnimationOptionAllowUserInteraction`选项。

# vb.net - 仅基于日期的 64 位 VBScript 评估

> ID：13069899
> 
> 赞同：1
> 
> 时间：2012-10-25T13:40:01.430
> 
> 标签：vb.net, visual-studio, vbscript, 64-bit

由于 VBScript 在 64 位编译的应用程序中不可用，有没有办法评估基本的基于 DATE 的 VBScript：

```
cdate("01/01/" & year(now())) 
```

如您所见，上面的 VBScript 会将今天的日期计算为“01/01/2012”。是否有一种简单的方法可以在 VB.Net 或 C# 中评估该表达式？

需要明确的是，我不需要支持所有的 VBScripting……只需要简单、扁平、基于日期的表达式，就像上面的例子一样。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T13:42:48.493

您可以在 64 位中重用 VBScript。在 SO 上看到这个答案：[parse and execute JS by C#](https://stackoverflow.com/questions/4744105/parse-and-execute-js-by-c-sharp)

它也适用于 VBScript，如下所示：

```
Console.WriteLine(ScriptEngine.Eval("vbscript", "cdate(\"01/01/\" & year(now()))")); 
```

# php - 并行运行多个 PHP 进程

> ID：13069900
> 
> 赞同：1
> 
> 时间：2012-10-25T13:40:07.590
> 
> 标签：php, parallel-processing

我们正在用 PHP 编写一个与 SEO 相关的脚本，一旦完成爬取过程，我们需要同时运行不同的模块（每个模块都是一个文件 .php）。**换句话说，我们需要并行执行 10 多个 .php 文件。**

该应用程序曾经使用序列，因此当一个脚本结束时，用户的浏览器会被转发到下一个脚本。每个脚本都与数据库建立连接，并将不同的 HTTP 数据包发送到爬取的 Web 应用程序。

我知道这可以使用 popen 来解决？有没有办法从每个模块接收信息到触发它们的主脚本中？任何人都可以提供一个非常简短的片段来看看它是如何工作的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T13:55:41.827

如果 PHP 中的各种文件没有依赖关系，我认为您可以使用多卷曲方法，该方法可以实现如下所示：-

```
 $linkArray = array('file1.php', 'file2.php','file3.php','file4.php','file5.php');
    $nodes = ($linkArray);
    $node_count = count($nodes);

    $curl_arr = array();
    $master = curl_multi_init();
    $counter = 0;
    for($i = 0; $i < $node_count; $i++)
    {
      $url =$nodes[$i];
      $curl_arr[$i] = curl_init($url);
      curl_setopt($curl_arr[$i], CURLOPT_RETURNTRANSFER, true);
      curl_multi_add_handle($master, $curl_arr[$i]);
    }

do {
    curl_multi_exec($master,$running);
} while($running > 0);

for($k=0;$k<$node_count;$k++){

  $result = curl_multi_getcontent  ($curl_arr[$k]); // contains the output of individual files

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T13:45:46.423

尝试使用这种技术在 PHP 中运行多个并行作业。在此示例中，我们有两个作业文件：我们要运行的 j1.php 和 j2.php。示例作业没有做任何花哨的事情。文件 j1.php 如下所示：

```
$jobname = 'j1';
set_time_limit(0);
$secs = 60;

while ($secs) {
        echo $jobname,'::',$secs,"\n";
        flush(); @ob_flush();  ## make sure that all output is sent in real-time
        $secs -= 1;
        $t = time();
        sleep(1); // pause
} 
```

我们flush()的原因；@ob_flush(); 是当我们回显或打印时，字符串有时会被 PHP 缓冲，直到稍后才发送。这两个功能确保立即发送所有数据。

然后我们有第三个文件 control.php，它负责协调作业 j1 和 j2。该脚本将使用 JobStartAsync() 中的 fsockopen 异步调用 j1.php 和 j2.php，因此我们能够并行运行 j1.php 和 j2.php。使用 JobPollAsync() 将 j1.php 和 j2.php 的输出返回到 control.php。

```
#
# control.php
#
function JobStartAsync($server, $url, $port=80,$conn_timeout=30, $rw_timeout=86400)
{
    $errno = '';
    $errstr = '';

    set_time_limit(0);

    $fp = fsockopen($server, $port, $errno, $errstr, $conn_timeout);
    if (!$fp) {
       echo "$errstr ($errno)<br />\n";
       return false;
    }
    $out = "GET $url HTTP/1.1\r\n";
    $out .= "Host: $server\r\n";
    $out .= "Connection: Close\r\n\r\n";

    stream_set_blocking($fp, false);
    stream_set_timeout($fp, $rw_timeout);
    fwrite($fp, $out);

    return $fp;
}

// returns false if HTTP disconnect (EOF), or a string (could be empty string) if still connected
function JobPollAsync(&$fp) 
{
    if ($fp === false) return false;

    if (feof($fp)) {
        fclose($fp);
        $fp = false;
        return false;
    }

    return fread($fp, 10000);
}

###########################################################################################

if (1) {  /* SAMPLE USAGE BELOW */

    $fp1 = JobStartAsync('localhost','/jobs/j1.php');
    $fp2 = JobStartAsync('localhost','/jobs/j2.php');

    while (true) {
        sleep(1);

        $r1 = JobPollAsync($fp1);
        $r2 = JobPollAsync($fp2);

        if ($r1 === false && $r2 === false) break;

        echo "<b>r1 = </b>$r1<br>";
        echo "<b>r2 = </b>$r2<hr>";
        flush(); @ob_flush();
    }

    echo "<h3>Jobs Complete</h3>";
} 
```

好读

[PHP中的分而治之和并行处理](http://phplens.com/phpeverywhere/?q=node/view/255)

[从源头](http://phplens.com/phpeverywhere/?q=node/view/254)

# .net - 来自网络服务组件的 COM 提升

> ID：13069902
> 
> 赞同：2
> 
> 时间：2012-10-25T13:40:12.850
> 
> 标签：.net, com, managed, elevation, moniker

我正在编写一个 .NET 插件程序集，该程序集加载到使用“网络服务”凭据运行的预先存在的服务中。

插件需要执行一些提升的操作，为此我需要启动提升的托管 COM 服务器。

我可以访问插件代码和 COM 服务器代码。

我的要求是在不以任何方式提示用户的情况下提升 COM 服务器启动。服务器需要按需启动并在工作完成后终止。

如果有人可以帮助我如何实现这一目标，那将会有所帮助。谢谢。

如果在安装时需要进行任何更改，则可以这样做。

PS：我发现了“COM Elevation Moniker”，但它似乎有助于调出不符合我要求的 UAC 海拔对话框。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T14:31:34.043

因为您可以访问 COM 服务器，所以我建议将其安装为[COM+ 应用程序](http://msdn.microsoft.com/en-us/library/windows/desktop/ms685978%28v=vs.85%29.aspx)。

将其作为 COM+ 应用程序安装后，您可以[将应用程序标识设置](http://msdn.microsoft.com/en-us/library/ee250098%28v=bts.10%29.aspx)为执行操作所需的帐户。

从那里开始，假设 COM 组件与您正在运行的代码安装在同一台机器上，您*应该*能够以相同的方式在 .NET 中访问 COM 组件，因为[`CoCreateInstance`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms686615%28v=vs.85%29.aspx)将知道 COM+ 正在拦截实现。

# unix - awk print 在行尾添加一个 control-m 字符

> ID：13069905
> 
> 赞同：14
> 
> 时间：2012-10-25T13:40:23.990
> 
> 标签：unix, awk

我在 bash 脚本中使用 awk 并执行以下操作：

```
awk -F, -v result_file=$2'{
print $2 $1 > result_file
}' $data_file 
```

在输出文件中，每行末尾都有一个 control-M '^M' 字符。怎么了？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-10-26T06:50:18.250

记录分隔符自动设置为当前系统的行尾，在`\n`基于 Unix 的系统上为 LF ( `\r\n`)，在 MS 系统上为 CR-LF ( )，`\r`在 Mac OS X 之前的 Mac OS 上为 CR ( )。所以要工作在 MS 系统上记录的文件上，适当地设置记录分隔符，在您的情况下：

```
awk -v RS='\r\n' ... 
```

# ruby-on-rails - 基于邮政编码的搜索

> ID：13069907
> 
> 赞同：1
> 
> 时间：2012-10-25T13:40:30.730
> 
> 标签：ruby-on-rails, ruby, thinking-sphinx

我有一个应用程序，店主可以在其中输入 10 个邮政编码，他们可以在其中提供服务。目前，这些邮政编码存储在单个表列中。现在基于此进行搜索的最佳和有效方法是什么？我应该将所有邮政编码（所有美国邮政编码）存储在表格中并建立`many to many`关系还是使用思维狮身人面像根据当前字段进行文本搜索？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T15:32:54.823

数据库专家的观点。. .

由于您在谈论使用 Sphinx，我假设您将所有 10 个邮政编码存储在一行中，就像这样。

```
shop_id  zip_codes
--
167      22301, 22302, 22303, 22304, 22305, 22306, 22307, 22308, 22309, 22310 
```

出于搜索和其他几个原因，您最好像这样存储它们。

```
shop_id  zip_codes
--
167      22301
167      22302
167      22303
167      22304
167      22305
167      22306
167      22307
167      22308
167      22309
167      22310

-- Example in SQL.
create table serviced_areas (
  shop_id integer not null references shops (shop_id), -- Table "shops" not shown.
  zip_code char(5) not null,
  primary key (shop_id, zip_code)
); 
```

在进行此单一更改后，您可以为停止提供一个很好的理由。

但是，如果您的 dbms 支持正则表达式，则无需对数据库进行任何其他更改即可显着提高数据完整性。有了这种 dbms 支持，您可以保证 zip_code 列只包含 5 个整数，没有字母。（可能还有其他方法可以保证 5 个整数且没有字母。）

邮政编码表将进一步提高数据完整性。但是您可以很容易地争辩说，店主首先输入有效的邮政编码有既得利益，而这不值得您付出更多的努力。邮政编码经常变化；不要期望邮政编码的“完整”表在很长时间内都是准确的。而且您需要有一个定义明确的程序来处理新的和过期的邮政编码。

```
-- Example in SQL
create table zip_codes (
  zip_code char(5) primary key
);

create table serviced_areas (
  shop_id integer not null references shops (shop_id),
  zip_code char(5) not null references zip_codes (zip_code),
  primary key (shop_id, zip_code)
); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T22:50:48.603

如果您使用 sphinx 进行地理空间搜索（不是真的，我想您可以使用文本文件或 xml），您将需要数据库中的邮政编码和纬度/经度。

通过地理空间搜索，我的意思是“查找您所在位置 20 英里内的商店”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T16:23:47.273

为了灵活性和效率，我会选择#1 ....

> “将所有邮政编码存储在一个表中并建立多对多关系”

...假设您还需要存储其他邮政编码数据字段（城市、州、县、纬度/经度等）。在这种情况下，您的交叉点将是：shop_id 到 zipcode_id(s)。但是，如果您不需要/没有扩展邮政编码数据字段，那么在我看来，一个单独的带有 shop_id 到实际邮政编码（不是 id）的表就可以了。

# c# - 是否可以使用 Selenium Webdriver 和 C# 测试在外部 css 文件中定义的某些元素的 css 属性？

> ID：13069909
> 
> 赞同：1
> 
> 时间：2012-10-25T13:40:40.180
> 
> 标签：c#, selenium, webdriver, selenium-webdriver, acceptance-testing

如何测试在外部 css 文件中定义的任何网页元素的 css 属性。如果我有，例如：

```
<div id="some-div" style="opasity: 10;"></div> 
```

我可以只取`style`属性的值，**但是**我在外部 ccs 文件中定义了所有 css 属性。如何测试这些元素及其属性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T16:48:37.143

**使用 IWebElement.GetCssValue**

有一种方法可以获取计算出的 css 样式。我相信在 c# 中它是[IWebElement.GetCssValue](http://selenium.googlecode.com/svn/trunk/docs/api/dotnet/html/M_OpenQA_Selenium_IWebElement_GetCssValue.htm)方法。

请注意，在 ruby​​ 和 java 中此方法的文档中说明了以下内容。我认为它适用于 c#，即使它没有被提及。

> 请注意，根据[DOM CSS2 规范](http://www.w3.org/TR/DOM-Level-2-Style/css.html#CSS-CSSStyleDeclaration)，不返回速记 CSS 属性（例如 background、font、border、border-top、margin、margin-top、padding、padding-top、list-style、outline、pause、cue） - 您应该直接访问普通属性（例如背景颜色）以访问所需的值。

**示例（红宝石）**

由于我只在ruby中做过selenium-webdriver，所以我只能举一个ruby的例子（想法是一样的，虽然api略有不同）：

```
require "selenium-webdriver"

driver = Selenium::WebDriver.for :firefox
driver.navigate.to "http://yourpage.com"

element = driver.find_element(:id, 'id')
puts element.css_value('color') 
```

# php - 序列化 POST 数组以便能够通过链接传递大量数据

> ID：13069914
> 
> 赞同：0
> 
> 时间：2012-10-25T13:40:48.170
> 
> 标签：php, html, forms, zen-cart

我有一个菜鸟问题，我想知道如何才能完成这项工作。

我有一个页面列出了我的数据库中的产品。在该页面上有一个过滤器表单，它会发布大量数据以优化产品列表，即每页有多少结果、排序顺序、pricefrom、priceto 加上一组子类别

我还有一个分页系统，它只是标准的 zencart（以防`splitpageresults::dsplaylinks`有人熟悉）分页系统，它显示下一个、上一个和一些页码的链接。通常它会`$_GET`在链接末尾传递参数，但我有我制作的所有这些花哨的过滤器。

我的想法是序列化`$_POST`数组并将其作为`$_GET`链接中的参数发送：

```
<a href="index.php&arr=<?php echo serialize($_POST[]);?>">nxt</a> 
```

但这似乎对所有的序列化和反序列化都不好。

这样做的最佳方法是什么？

我想不通！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T13:43:39.783

您可以删除`[]`和`urlencode()`序列化数据：

```
<a href="index.php&arr=<?php echo urlencode(serialize($_POST));?>">nxt</a> 
```

但是你最好使用[session](http://php.net/manual/en/features.sessions.php)。请参阅[手册](http://php.net/manual/en/ref.session.php)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T16:59:56.817

查看高级搜索和高级搜索结果页面，了解使用 POST 处理大量数据的示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-01T13:54:53.933

试试这个

```
 /* View.php*/

    $image_arr=array("1.jpg","2.jpg","3.jpg","4.jpg","5.jpg","6.jpg");
    $serial_arr=urlencode(base64_encode(serialize($image_arr)));

    echo '<a href="process.php?arr='.$serial_arr.'">Link</a>';

    /* process.php */
    $image_arr=unserialize(base64_decode(urldecode($_GET['arr'])));

    foreach($image_arr as $value){
       /* do anything here 
        * just as an example
        * https://gist.github.com/vdite/30644e28301916789ff5
        */
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-29T13:34:10.380

恕我直言，$_GET 或 $_POST 上的 serialize() 和 deserialize() 远非一个好主意，我可以想到两个主要方面：

1.  安全
2.  最佳实践

有关安全方面的更多详细信息，请查看[[PDF, owasp.org]](https://www.owasp.org/images/f/f6/POC2009-ShockingNewsInPHPExploitation.pdf)上的 Stefen Esser 的 OWASP 演示文稿，第 27 页。一般来说，没有很多人希望我们相信的那么严重，但仍然可能成为一个令人讨厌的安全问题（如 phpBB2、Zend 等）。

最佳做法是使用 JSON（json_encode 和 json_decode 是更好的选择）。使用 JSON，您可以执行更多基于标准的 AJAX，以及用户友好的 JavaScript 或基于 jQuery 的分页或过滤器。

# linux - svn 提交不工作

> ID：13069917
> 
> 赞同：1
> 
> 时间：2012-10-25T13:40:56.653
> 
> 标签：linux, svn

当我使用

```
svn st -u 
```

我将以下待处理文件视为

```
? Pairwise.py
Status against revision:   1003 
```

然后当我使用

```
svn commit 
```

什么都没发生。当我再次检查

```
svn st -u 
```

我看到的和以前一样。请让我知道有什么问题。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T13:44:20.820

`?`意味着你还没有运行 svn add，所以 svn 不会对它做任何事情。

# installation - Wix .NET 4.0 框架根目录

> ID：13069921
> 
> 赞同：3
> 
> 时间：2012-10-25T13:41:12.690
> 
> 标签：installation, wix, wix3.5

对于 Wix 中的 .NET 3.5，我能够使用此 [NETFRAMEWORK35INSTALLROOTDIR] 获取 3.5 根目录的路径，因此我可以执行以下操作... [NETFRAMEWORK35INSTALLROOTDIR]\aspnet_iapi.dll

我正在尝试做类似的事情，但指向 .NET 4.0 目录。我正在尝试进行通配符映射。这是 WIX Web 应用程序扩展元素。

```
<iis:WebApplicationExtension CheckPath="no"
    Script="yes"
    Executable="[NETFRAMEWORK40INSTALLROOTDIR]aspnet_isapi.dll"
    Verbs="GET,HEAD,POST DELETE PUT"/> 
```

问题是在 IIS 6 中，通配符路径总是简单的“aspnet_isapi.dll”，所以很明显框架根变量不起作用。

我做错了什么还是有其他方法可以可靠地获取 .net 4.0 根目录？如果重要的话，我使用的是 WIX 3.5。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-25T13:45:12.030

答案在于[WixNetFxExtension](http://wix.sourceforge.net/manual-wix3/wixnetfxextension.htm)的文档：

> NETFRAMEWORK40FULLINSTALLROOTDIR
> 
> 设置为 .NET Framework 4.0 完整版的安装目录 (%windir%\Microsoft.NET\Framework\v4.0)。此属性从 WiX v3.5 开始可用。
> 
> NETFRAMEWORK40FULLINSTALLROOTDIR64
> 
> 设置为 64 位 .NET Framework 4.0 完整版的安装目录 (%windir%\Microsoft.NET\Framework64\v4.0)。此属性从 WiX v3.5 开始可用。

客户端配置文件也有单独的属性：

> NETFRAMEWORK40CLIENT安装根目录
> 
> NETFRAMEWORK40CLIENT安装根目录IR64

# templates - 何时为 Ext JS 组件呈现模板 (.tpl)？

> ID：13069923
> 
> 赞同：4
> 
> 时间：2012-10-25T13:41:18.857
> 
> 标签：templates, extjs

我正在尝试将另一个组件注入到由另一个 Coomponent 的模板呈现的元素中。但在 afterrender 事件中，模板尚未呈现，因此对 Ext.get(el-id) 的调用返回 null: `TypeError el is null`。

```
 tpl: 
    new Ext.XTemplate(
      '<tpl for=".">',
        '<ul>',
          '<li class="lang" id="cultureSelector-li"></li>',
        '</ul>',

      '</tpl>'
      ),

  listeners: {
    afterrender: {
      fn: function (cmp) {
        console.log(Ext.get('cultureSelector-li')); // < null :[
        Ext.create('CultureSelector', { 
          renderTo: 'cultureSelector-li' 
        });
      }
    }
  }, 
```

那么我什么时候可以添加这个组件，以便在 DOM 中创建目标元素？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T14:04:30.943

我认为这取决于您正在使用的组件。例如，Data Grid View 有一个“viewready”事件可以满足您的需求，并且根据您的尝试，“boxready”功能可以用于组合框（尽管只有第一个渲染）。除此之外，您可以通过元素的父类搜索被调用的 XTemplate 渲染函数（可能在布局管理器中）并将其扩展以在那里触发事件，或者冒着竞争条件并在setTimeout() 以合理的延迟调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T14:17:32.377

我最终不得不自己做这项工作。所以，我现在将模板作为一个名为 的属性`theTpl`，然后在 中渲染它`beforerender`，然后我能够在 中获取元素的句柄`afterrender`。这似乎完全违反直觉，有没有人有任何见解？

```
beforeRender: {
      fn: function (me) {
        me.update(me.theTpl.apply({}));
      }
    }, 
```

**编辑**实际上我只是扩展了 Component ：

```
Ext.define('Ext.ux.TemplatedComponent', {
  extend: 'Ext.Component',
  alias: 'widget.templatedComponent',
  template: undefined,
  beforeRender: function () {
    var me = this;
    var template = new Ext.XTemplate(me.template || '');
    me.update(template.apply(me.data || {}));
    me.callParent();
  }
}) 
```

...`template`接受一个 html 片段数组

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T10:24:50.980

原来我使用了错误的东西——显然我们应该为这种类型的东西使用 render* 配置（那么`tpl`&`data`配置是干什么用的？）

这是sencha论坛为我提供的一个工作小提琴：

[http://jsfiddle.net/qUudA/10/](http://jsfiddle.net/qUudA/10/)

# ios - 通过 instagram API 删除对 instagram 媒体的评论

> ID：13069925
> 
> 赞同：1
> 
> 时间：2012-10-25T13:41:25.530
> 
> 标签：ios, api, instagram

我正在开发一个 Instagram 应用程序。一切都很好，直到我从 Instagram 媒体上删除评论。这是我的请求网址：

```
https://api.instagram.com/v1/media/[media_id]/comments?access_token=[access_token] 
```

并发布正文

```
--xXxBoUnDaRyxXx
Content-Disposition: form-data; name="comment_id"

309854812055300359
--xXxBoUnDaRyxXx
Content-Disposition: form-data; name="_method"

DELETE
--xXxBoUnDaRyxXx 
```

我试图删除`_method=DELETE`and 设置`httpmethod`为`DELETE`，但没有运气。服务器只返回空数据，没有错误，没有元信息。有人尝试过并成功了吗？请帮忙。

**编辑** 我刚刚发现服务器正在返回带有代码 405 的响应 - 不允许远程 url 返回错误 405 方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T04:55:40.320

好的，我在 Will [https://github.com/wfleming/WFInstagramAPI/issues/1#issuecomment-9779870](https://github.com/wfleming/WFInstagramAPI/issues/1#issuecomment-9779870)的帮助下解决了这个问题。实际上，我必须向 https://api.instagram.com/v1/media/{media-id}/comments/{comment-id}?access_token=foo: 之类的 URL 发送 DELETE 请求。Instagram 文档必须更新。

# c - 字符数组填充

> ID：13069927
> 
> 赞同：0
> 
> 时间：2012-10-25T13:41:26.433
> 
> 标签：c, file-io

我想声明字符数组，然后想填充它。但出现错误：

```
char line[BUFSIZE+1];
strcpy(line,"Memory is Full", sizeof(line)); 
```

错误是：

```
wrong number of arguments in call to strcpy. 
```

有没有其他方法可以实现这一目标？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T13:57:48.373

如果有，请使用`strlcpy()`. 它做你可能期望`strncpy()`做的事情。

如果做不到这一点，我建议使用`snprintf()`，如果你有的话。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T13:43:40.853

`strcpy()`需要 2 个参数，`strncpy()`需要 3 个。

我认为您正在考虑使用[strncpy](http://www.cplusplus.com/reference/clibrary/cstring/strncpy/)，它需要目标、源和大小。

IE：

```
int main()
{
    char i[6];
    strncpy(i, "Hello", sizeof(i));
    printf("%s\n", i);    
    return 0;
}

>> ./a.out
>> Hello 
```

**注意：**`'\0'`如果您完全填写您的 char[]，您必须自己附加，否则`strncpy()`将为您完成（如我的示例中所示）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-25T13:43:34.047

`strcpy`不接受大小/长度参数。改为使用`memcpy`，但给它正在复制的字符串的大小（长度+1），而不是缓冲区的大小，否则您将面临未定义的行为/段错误的风险。

# vb.net - 从平面文件excel导入值

> ID：13069929
> 
> 赞同：0
> 
> 时间：2012-10-25T13:41:33.917
> 
> 标签：vb.net, excel, vba

嗨，我必须按以下方式将值导入 excel 文件：

必须根据每行的最后 8 个字符（即 00004100）导入值。假设 00004 是第 5 列，而 100 是第 6 列。

我需要为每对独特的 column5 和 column6 将值导入单独的 Excel 工作表。即最后 8 位为 00002100 的所有行都将放入一张 Excel 表格中，依此类推。

```
1234 john smith  america 00002100
1234 john smith  america 00002100
1234 john smith  america 00002200
1234 john smith  america 00002200
1234 john smith  america 00003100
1234 john smith  america 00003200
1234 john smith  america 00003200
1234 john smith  america 00004100
1234 john smith  america 00002100 
```

如何根据vb中的给定标准生成excel表！？

提前谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T13:49:12.703

我不确定为什么这是一个 VB 问题？你使用互操作吗？由于我不知道这一点，我正在使用伪代码 - 但我想你会明白的。它更像 vb.net - 如果您使用 vba，一般的 Idea 将起作用。

通常我会执行以下操作：遍历每一行并连接一个新字符串。像这样：

```
For row = 0 to rows.count-1
dim str as new stringbuilder()

 for col = 0 to rows(row).count-1
    str.append(rows(row).item(col)
 next

dim lasteight=str.tostring
lasteight=lasteight.substring(lasteight.length-8)

'here do the following: have a list of your sheetnames. If this list contains lasteight goto this page and append the row. if no sheet exist, create one and append as well.
next 
```

# iphone - 如何相对于原始图像大小比设置 UIimageview 宽度

> ID：13069932
> 
> 赞同：1
> 
> 时间：2012-10-25T13:41:37.723
> 
> 标签：iphone, objective-c, uiimageview, uiimage

在我的 iphone 应用程序中，我需要在图像视图中设置图像。

**图像视图高度始终为 100 像素。**

**`we need to set the width of the image view with respect to the original image scale ratio.`**

即假设图像的宽度X高度为**300x400（原始）（4x3）**

我们显示的图像视图图像大小为**75X100**

图像的宽度 X 高度为**512x512（原始）（1x1）**

我们显示的图像视图图像大小将是**100X100**

图像的宽度 X 高度为**128 x 256（原始）（1x2）**

我们显示的图像视图图像大小将是**50X100**

*`in all those cases image view height 100pixel should be same, but the width need to varie with respect to the image ratio.`*

最后**图像视图应该在视图的中心**

如何实现

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-25T13:47:19.033

有几种方法可以实现这一目标。最简单的就是在Interface Builder中将image view上的缩放模式设置为Aspect Fill，或者

```
imageView.contentMode = UIViewContentModeScaleAspectFit; 
```

第二种方法是计算图像的纵横比并设置宽度。就像是：

```
UIImage *myImage = [UIImage imageNamed:@"MyImage"];
float aspectRatio = myImage.size.width / myImage.size.height;
float viewWidth = 100 * aspectRatio; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T13:46:35.847

好吧，这取决于你的逻辑。
你可以得到`UIImage`高度和宽度。

```
 UIImage *image = [UIImage imageNamed:@"anyImage.png"];
 float imageHeight = image.size.height;
 float imageWidth = image.size.width; 
```

之后，您可以计算 imageViewWidth-。
**根据您的要求 -**

```
float value = imageHeight/100.0;
float iV_Width = imageWidth/value; 
```

# android - 如何在android中将sqlite表值列显示为行？

> ID：13069933
> 
> 赞同：1
> 
> 时间：2012-10-25T13:41:43.037
> 
> 标签：android, sqlite, android-tablelayout

现在我正在创建图表应用程序。我必须根据 sqlite 表值创建图表。我的数据库[http://pastie.org/5114056](http://pastie.org/5114056)中有以下值。我获取所有数据并存储到相应的数组中。现在我想像这样在表格视图中显示所有值![在此处输入图像描述](../Images/bcc5b6551b8a2500ea6d20ed236bb12c.png)

所有列值必须显示为行值。并且所有行值都动态显示为列值。我怎样才能做到这一点？有谁能够帮我？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T14:07:12.230

海都只需点击此链接，您将获得正确的输出，用于将数据库基本列值显示为行 [如何使用 java 代码在 android 中创建多列表视图？](https://stackoverflow.com/questions/6080556/how-to-create-a-multiple-column-table-view-in-android-using-java-code)

# java - 在 Java 中旋转 tiff 图像的最干净、最有效的技术？

> ID：13069935
> 
> 赞同：1
> 
> 时间：2012-10-25T13:41:46.563
> 
> 标签：java, image, image-processing, tiff, jai

我正在将 tiff 图像文件从一个目录复制到另一个目录，并且需要将它们顺时针旋转 90 度以更正它们的页面方向。这些图像是技术图纸，质量已经不是很好，所以我需要尽可能地使用无损技术。每批每天可能要处理数千张图纸，因此内存和时间效率也是两个考虑因素。

我做的图像处理很少，所以我对可用的库不是很熟悉。在做了一些阅读之后，我正在考虑使用 JAI 的“转置”：

[http://docs.oracle.com/cd/E17802_01/products/products/java-media/jai/forDevelopers/jai-apidocs/javax/media/jai/operator/TransposeDescriptor.html](http://docs.oracle.com/cd/E17802_01/products/products/java-media/jai/forDevelopers/jai-apidocs/javax/media/jai/operator/TransposeDescriptor.html)

任何使用过这种技术的人都可以在功能或效率方面推荐或反对它吗？

对其他方法有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T13:51:11.473

好吧，如果你只想将它们旋转 90 度，你只需要读取图像的列并将它们写成行。那时完全没有损失。

伪代码：

```
for x in oldimage.width
    for y in oldimage.height
        newimage[y][x] = oldimage[x][y] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T13:45:46.490

你可以考虑使用这样的东西：

```
PlanarImage pi = PlanarImage.wrapRenderedImage(image);
        BufferedImage bi = pi.getAsBufferedImage();
        AffineTransform at = new AffineTransform();
        at.translate(-(image.getWidth() - image.getHeight()) / 2, (image.getWidth() - image.getHeight()) / 2);
        at.rotate(Math.toRadians(90),bi.getWidth()/2,bi.getHeight() / 2);
        AffineTransformOp opRotated = new AffineTransformOp(at,
                    AffineTransformOp.TYPE_BILINEAR);
        image = opRotated.filter(bi, null); 
```

# java - SVG 蝾螈图像

> ID：13069944
> 
> 赞同：1
> 
> 时间：2012-10-25T13:42:07.257
> 
> 标签：java, image-processing, svg, rasterize, svg-salamander

在过去的几天里，我一直在尝试使用 SVG Salamander 和 Java 处理和光栅化 svg 文件，但无法让它工作。

这是我的 SVG 文件，由 Adob​​e Illustrator 生成。它基本上包含一些随机文本，其中一个 tspan 被设置为显示黄色文本。

通过我的程序，我的目标是更改一些 tspan 文本颜色，然后将 svg 光栅化为 .png。第一种方法遍历 SVG 文档树并将唯一的 id 添加到所有标签。第二种方法随机选择一组这些 id，选择相应的 tspan 并设置填充属性（直到这里一切似乎都工作正常，一些调试显示我得到了正确的 tspan 并且填充属性设置正确）然后栅格化 svg。这是问题开始的地方：生成的 .pngs 不显示更改的字体颜色（文本颜色只是纯黑色，即使示例 xml 中的黄色 tspan 以某种方式“更改”为黑色。一些测试告诉我, 它甚至不显示更改的 tspan 文本内容。下面是设置属性和渲染的代码：

```
 <?xml version="1.0" encoding="utf-8"?>
    <!-- Generator: Adobe Illustrator 14.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 43363)  -->
    <!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
         width="595.28px" height="841.89px" viewBox="0 0 595.28 841.89" enable-background="new 0 0 595.28 841.89" xml:space="preserve">
    <text transform="matrix(1 0 0 1 117 180)"><tspan x="0" y="0" font-family="'MyriadPro-Regular'" font-size="12">asdfasdfasdfasdfasdfasdfasdf</tspan><tspan x="0" y="14.4" font-family="'MyriadPro-Regular'" font-size="12">asdfiausldÃ¶fjaÃ¶ljfdÃ¶lajsdf</tspan><tspan x="0" y="28.8" font-family="'MyriadPro-Regular'" font-size="12">adsfal+sdfajksdflkasdf</tspan><tspan x="0" y="57.6" fill="#FFDE17" font-family="'MyriadPro-Regular'" font-size="12">asdlfkÃ¶ajsdÃ¶fjkaÃ¶lsdfj</tspan></text>
    </svg>
```

```
SVGElement element = tempDiagram.getElement(String.valueOf(curId));
if (!element.hasAttribute("fill", AnimationElement.AT_CSS)) {
   element.addAttribute("fill", AnimationElement.AT_CSS, "#ff0000");
} else {
   element.setAttribute("fill", AnimationElement.AT_CSS, "#ff0000");
}
   tempDiagram.updateTime(0f);
   BufferedImage bi = new BufferedImage(2480,3508,BufferedImage.TYPE_INT_ARGB);
   Graphics2D ig2 = bi.createGraphics();
   ig2.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
   ig2.setRenderingHint(RenderingHints.KEY_COLOR_RENDERING, RenderingHints.VALUE_COLOR_RENDER_QUALITY);
   tempDiagram.render(ig2);
   ImageIO.write(bi, "png", new File("test" + String.valueOf(i) + ".png")); 
```

到目前为止，您有什么可以解释我的问题的吗？任何帮助表示赞赏！

Ps：如果我使用 Illustrator 在 SVG 中放置一个红色矩形，则该矩形在生成的 .png 中也是红色的。所以不知何故，这个问题似乎只影响我在我的程序中“触摸”的 tspan 或标签......

# javascript - jQuery递归删除空孩子

> ID：13069947
> 
> 赞同：8
> 
> 时间：2012-10-25T13:42:11.587
> 
> 标签：javascript, jquery, recursion

我有一组嵌套的 html 标签，我想删除所有标签及其子项，而没有文本。

**例子：**

```
<div id="mydiv">

<span></span>
<span><br></span>
<span> <span><br></span> </span>
<span>   <span><br> <span></span> </span>  </span>

<span> <img src="someimg.jpg" width="100" height="100"> </span>
<span>some text</span>

</div>​ 
```

所以我希望图像和文本的跨度留下，而其他人离开。

**在我的函数之后我需要那个结果**：

```
<div id="mydiv">

<span> <img src="someimg.jpg" width="100" height="100" /> </span>
<span>some text</span>
</div>​ 
```

我想通了，这将通过 JavaScript 或 jQuery 使用其方法 .children() 递归地完成，这是我想使用的代码，但我不知道如何构建递归：

```
 var remove_filter = function () {
            children= $(this).children();

            for (var i = -1, l = children.length; ++i < l;) {
                if ($(children[i]).text() == "") {
                    $(children[i]).remove();
                }
                //may be recursion here
                //else if(){
                //}
            }
            return $(this).text() == "" && $(this).children().length == 0;
}
$('#mydiv').find('span').filter(remove_filter).remove(); 
```

此代码已损坏，它删除并留下空跨度...我如何通过递归获得结果？

**已编辑**

这是我的 jsfiddle：http: [//jsfiddle.net/EGVQH/](http://jsfiddle.net/EGVQH/)

**编辑了 2 次**

我在正确答案中发现了一个错误，但它很小。如果我有这样的代码：

```
<div id="mydiv">
<span> <br> Some text</span>
<span>   <span><br> <span></span> </span>  </span>

<span> <img src="someimg.jpg" width="100" height="100"> </span>
<span>some text</span>

</div>​ 
```

我认为它会导致：

```
<div id="mydiv">
<span> Some text</span>
<span> <img src="someimg.jpg" width="100" height="100" /> </span>
<span>some text</span>
</div>​ 
```

以前对我的问题的“正确”答案是在`<span> <br> Some text</span>`. 测试了一下后其他答案是错误的。

见我的 JSfiddle：http: [//jsfiddle.net/EGVQH/2/](http://jsfiddle.net/EGVQH/2/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T15:59:30.910

```
function rem(root) {
    var $root = $(root);
    $root.contents().each(function() {
        if (this.nodeType === 1) {
            rem(this);
        }
    });

    if (!$root.is("area,base,col,command,embed,hr,img,input,keygen,link,meta,param,source,track,wbr") && !$root.html().trim().length) {
        $root.remove();
    }
}

rem("#mydiv");​ 
```

使用：

```
<div id="mydiv">
<span> <br> Some text</span>
<span>   <span><br> <span></span> </span>  </span>

<span> <img src="someimg.jpg" width="100" height="100"> </span>
<span>some text</span>

</div>​ 
```

树叶：

```
<div id="mydiv">
<span>  Some text</span>

<span> <img src="someimg.jpg" width="100" height="100"> </span>
<span>some text</span>

</div> 
```

[http://jsfiddle.net/LEKaL/1/](http://jsfiddle.net/LEKaL/1/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T14:07:39.447

你可以试试这个，不用递归，使用每个，检查非文本包含标签，比如 img

```
$(function(){
    $('#mydiv').find('span').each(function(){
        var self = $(this);
        if($.trim(self.html())==""){
            self.remove();
        }else if($.trim(self.text())=="" && self.has('img').length ==0)
            self.remove();
    });
}); 
```

您可以更改`$(this).has('img').length ==0`输入、iframe 或任何其他包含标签的非文本`$(this).has('img, input, iframe').length ==0`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-25T14:15:48.047

这是解决问题的一种非常快速而肮脏的方法

```
$('#mydiv span br').remove();
while($('#mydiv span:empty').length > 0){
    $('#mydiv span:empty').remove();
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-25T14:07:03.673

这应该这样做。但这也会删除图像。您需要添加条件以不删除图像。

```
removeempty($('#mydiv'));
function removeempty(parentnode){
var children=$(parentnode).children();
for(var i=0;i<children.length;i++){
    var text=$(children[i]).text();
    if($.trim(text).length==0){
        $(children[i]).remove();
    }
    else{
        removeempty($(children[i]));
    }
}
return;
}​ 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-25T14:14:39.197

您可以使用过滤器功能来获取您需要的元素，而不是试图找到您不需要的元素..然后克隆并将它们添加到您的 div

```
var x = $('#mydiv *').filter(function(){
   // return elements with a children of img or with some text
   return  $(this).children('img').length || $.trim($(this).text()).length ;
}).clone();
$('#mydiv').html(x); 
```

[http://jsfiddle.net/wirey00/5jymK/](http://jsfiddle.net/wirey00/5jymK/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-10-25T14:21:02.207

```
$.each($("#mydiv").find("span"),function(index,value){
   if($.trim($(value).html()))
   {
        $(value).remove();
   }
}); 
```

如果要删除中断，请在每个语句之前添加：

```
$("#mydiv br").remove(); 
```

# serial-port - 我从串口读取的内容与超级终端所做的内容之间存在差异

> ID：13069948
> 
> 赞同：1
> 
> 时间：2012-10-25T13:42:13.177
> 
> 标签：serial-port, hyperterminal

我正在使用超级终端从传感器读取输入。该传感器发送一个字符串，其格式应为 6 位或 5 位和一个小数点（但它可以是 2 个空格，然后是 3 位和一个小数）制表符分隔符 测量单位（“Ci”，“mCi”等）制表符分隔符字符串 例如（F-18 或 C-11）制表符分隔符制表符 CRLF 字符串结束标识符。

如果我通过超级终端监视此输入它会完美读取

```
0.00  kBq      F-18 2D 
```

但是，当我阅读它时，我大部分时间都会得到字符串的断线段，有时我会得到正确的字符串，下面显示了我可以返回的示例。

```
0.00  k□□□□□□□□□□□□□

Bq      F-18 2D□□□□□□□□□

0.00  kBq      F-18 □□□

0.002D
□□□□□□□□□□ 
```

我使用的代码来自 RXTX 库。

```
public void serialEvent (SerialPortEvent event){  
    if (event.getEventType()== SerialPortEvent.DATA_AVAILABLE){  
       byte[] readBuffer = new byte[19];  
       try{  
            while (inputStream.available() > 0){  
                int numBytes = inputStream.read(readBuffer);  
                }
       catch (IOException e) {}  
       input_line = new String (readBuffer);  
       inter.update(input_line);}} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T13:50:08.730

这是设计使然。您假设您将从 Read() 调用中获取*所有*字节。这不是它的工作原理，它只会给你到目前为止已经收到的字节。这也发生在超级终端中，但你永远不会注意到，因为你的眼睛没有那么快。

您需要将 readBuffer 移到方法之外并逐步填充它，直到您收到完整的响应。然后处理它。

如果设备只发送简单的 ASCII 文本和行终止符，这很常见，那么调用 SerialPort.ReadLine() 是确保您获得响应中所有字符的好方法。如有必要，调整 NewLine 属性。

# r - 删除属于指定长度因子的数据集的行

> ID：13069949
> 
> 赞同：5
> 
> 时间：2012-10-25T13:42:17.597
> 
> 标签：r

我有一个类似于以下的data.frame：

```
df <- data.frame(population = c("AA","AA","AA","BB","BB","CC","CC","CC"),
                 individual = c("A1","A2","A3","B1","B2","C1","C2","C3"),
                 Haplotype1 = rep(1:4,2),
                 Haplotype2 = rep(5:8,2))
 > df
  population individual Haplotype1 Haplotype2
1         AA         A1          1          5
2         AA         A2          2          6
3         AA         A3          3          7
4         BB         B1          4          8
5         BB         B2          1          5
6         CC         C1          2          6
7         CC         C2          3          7
8         CC         C3          4          8 
```

我想创建一个新数据集，其中从数据集中省略任何由少于指定数量的个体组成的人口。例如，我想仅重新分析具有三个或更多个体的人群的数据。以下是我想要的数据集：

```
> df <- df[!df$population=="BB",]
> df
  population individual Haplotype1 Haplotype2
1         AA         A1          1          5
2         AA         A2          2          6
3         AA         A3          3          7
6         CC         C1          2          6
7         CC         C2          3          7
8         CC         C3          4          8 
```

但是，我有 400 个种群，大小从 5 到 155 不等，手动按名称挑选种群是不可行的。我想写一个函数，我本质上说“给我一个包含 X 个或更多个体的所有人口的数据集，并删除那些少于 X 的人。” 任何帮助或反馈表示赞赏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T14:02:47.857

这应该可以解决问题：

```
tab <- table(df$population) > 2
df[df$population %in% names(tab)[tab], ]

#   population individual Haplotype1 Haplotype2
# 1         AA         A1          1          5
# 2         AA         A2          2          6
# 3         AA         A3          3          7
# 6         CC         C1          2          6
# 7         CC         C2          3          7
# 8         CC         C3          4          8 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-25T16:40:27.690

我能想到的最直接的方法是使用`data.table()`“data.table”包：

```
library(data.table)
DT <- data.table(population = c("AA","AA","AA","BB","BB","CC","CC","CC"),
                 individual = c("A1","A2","A3","B1","B2","C1","C2","C3"),
                 Haplotype1 = rep(1:4,2), Haplotype2 = rep(5:8,2),
                 key = "population")
## Or, convert your existing data.frame "df" to data.table:
## DT <- data.table(df, key = "population")
DT[, .SD[length(unique(individual)) >= 3], by = key(DT)]
#    population individual Haplotype1 Haplotype2
# 1:         AA         A1          1          5
# 2:         AA         A2          2          6
# 3:         AA         A3          3          7
# 4:         CC         C1          2          6
# 5:         CC         C2          3          7
# 6:         CC         C3          4          8 
```

* * *

## 更新

我不确定这对您是否重要，但请注意，对于 Tyler 和 Sven 当前的解决方案，尽管根据您发布的问题中的数据输出是正确的，但实际上存在一些***潜在***的有缺陷的想法.

我写“潜在地”是因为您提到您正在寻找`df$population`有三个或更多个人（来自 ）的组（来自`df$individual`）。*但是，他们的两种解决方案目前都只关注人口*的长度，而根据您的实际问题，我会假设您需要人口提到的唯一个体的数量。

这是一个简单的例子。使用您原来的“df”，将第 3 行中的个人更改为“A2”（`df[3, 2] <- "A2"`）。现在，根据您在问题中的标准，只`population == "CC"`应返回带有的行。

如果您的数据已经只有独特的个人，那么没问题 - 但我想我会提到它；）

* * *

考虑到此逻辑的基本 R 解决方案是：

```
uniqueIndividuals <- ave(as.character(df$individual), 
                         df$population, FUN = function(x) length(unique(x)))
df[which(as.numeric(uniqueIndividuals) >= 3), ] 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-25T14:07:12.923

这也可以：

```
lens <- tapply(df$population , df$population, length)
df[df$population %in% names(lens)[lens > 2], ] 
```

编辑：根据 mrdwab 的敏锐阅读，我已经编辑了我的答案。我必须承认我只查看了输入和输出：

```
lens <- tapply(df$individual, df$population, function(x) length(unique(x)))
df[df$population %in% names(lens)[lens > 2], ] 
```

# python - Django - 在模型中加载大默认值的正确方法

> ID：13069952
> 
> 赞同：4
> 
> 时间：2012-10-25T13:42:20.707
> 
> 标签：python, django, django-models

我有一个`schema`在 django 模型中调用的字段，它通常包含一个相当大的 json 字符串。在创建任何新实例时，我想添加一个默认值（大约 2000 个字符）。

我发现将整个内容转储到`models.py`变量中是相当不干净的。在我的架构（即 a `TextField`）中加载此默认值的最佳方法是什么？

例子：

```
class LevelSchema(models.Model):
    user = models.ForeignKey(to=User)
    active = models.BooleanField(default=False)
    schema = models.TextField() # Need a default value for this 
```

我想了一下。如果我使用 json 文件将默认值存储在某处，那么放置它的最佳位置是什么？显然，如果它位于文件夹中的同一个应用程序中，则更可取。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T14:01:15.983

我发现变量的使用并不是特别不干净。`default`但是您可以“滥用”所有字段都支持的参数可以是可调用的事实。

所以你可以做这个“疯狂”的事情：

```
def get_default_json():
    json_text = open('mylargevalue.json').read()
    return json_text 
```

然后在你的领域：

```
schema = models.TextField(default=get_default_json) 
```

我没有尝试过类似的方法，但我想它可以工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T14:07:07.113

> 文字比较庞大。将跨越文件的一半，因为它是格式化的 json，我希望将来可以编辑。我更喜欢从文件（如固定装置）加载它，只是我想知道 Django 中是否已经存在一个方法。

在 django 中，您有两种选择：

1.  监听[post_save](https://docs.djangoproject.com/en/dev/ref/signals/#post-save)，当`created`为 true 时，通过读取文件设置对象的默认值。

2.  将默认值设置为可调用（一个函数），并在该方法中读取文件（确保之后关闭它），并返回其内容。

您还可以将数据粘贴在一些 k/v 存储（如 redis 或 memcache）中，以便更快地访问。这也会更好，因为您不会经常打开和关闭文件。

最后，最具限制性的选项是在数据库上设置一个触发器，为您进行填充。您必须将 json 存储在数据库中的某个位置。这种方法的另一个好处是您可以编写一个 django 前端来更新 json。缺点是它会将您的应用程序限制为您决定使用触发器支持的那些数据库。

# java - 为什么日志消息不能在文本文件中\n？

> ID：13069960
> 
> 赞同：2
> 
> 时间：2012-10-25T13:42:49.447
> 
> 标签：java, logging

我使用了一个初始化记录器和参数的函数。虽然我在控制台中调用了这个函数 LogMsg 和换行符，但它在文本文件中只给出了一行。为什么呢？

```
String logmsg="Line1\n"+"Line2\n";

public static void LogMsg(Logger logger,String pathname,Level level,String logmsg){
    //logger=Logger.getLogger("LogMsg");
    FileHandler fh=null;
    try {
        fh = new FileHandler(pathname,300000,1,true);
        fh.setFormatter(new SimpleFormatter());
         LogRecord record1 = new LogRecord(level, logmsg);
         logger.addHandler(fh);
            logger.log(record1);
            fh.close();

    } catch (SecurityException e) {
        // TODO Auto-generated catch block

        //e.printStackTrace();
        System.out.println("Failed to log message due to lack of permissions.");
    } catch (IOException e) {
        // TODO Auto-generated catch block
        //e.printStackTrace();

        System.out.println("Failed to log message");
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T13:49:42.413

尝试

```
String logmsg="Line1\r\n"+"Line2\r\n"; 
```

或者更好

```
logmsg = String.Concat("Line1",Environment.NewLine,"Line2",Environment.NewLine); 
```

或者最好还是使用 StringBuilder 之类的东西

```
logmsg = CreateLogMessage(new string [] {"Line1", "Line2"});

public static CreateLogMessage(string[] argLines);
{
  StringBuilder sb = new StringBuilder(argLines.Length);
  foreach(String line in argLines)
  {
    sb.AppendLine(line);
  }
  return sb.ToString();
} 
```

Environment.Newline 将根据预期的行尾标记来处理操作系统差异。

# android - Android中的命名按钮

> ID：13069963
> 
> 赞同：0
> 
> 时间：2012-10-25T13:42:52.597
> 
> 标签：android, android-widget

我正在尝试在带有名称的 Android 布局中创建一个按钮，`"="`Eclipse 说：

> 这是不可接受的。

如何创建带有名称`"="`等的按钮`"1"`？

这是按钮：
![在此处输入图像描述](../Images/0c20668c10147f6931285e6adf99e28f.png)

这是xml代码

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="fill_parent"
android:layout_height="fill_parent" >

   <Button
    android:id="@+id/button1"
    style="?android:attr/buttonStyleSmall"
    android:layout_width="50dp"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_marginLeft="29dp"
    android:layout_marginTop="98dp"
    android:text="7" />

    <Button
    android:id="@+id/button2"
    style="?android:attr/buttonStyleSmall"
    android:layout_width="50dp"
    android:layout_height="wrap_content"
    android:layout_alignBottom="@+id/button1"
    android:layout_toRightOf="@+id/button1"
    android:text="8" />

    <Button
    android:id="@+id/button3"
    style="?android:attr/buttonStyleSmall"
    android:layout_width="50dp"
    android:layout_height="wrap_content"
    android:layout_alignBottom="@+id/button2"
    android:layout_toRightOf="@+id/button2"
    android:text="9" />

    <Button
    android:id="@+id/button4"
    style="?android:attr/buttonStyleSmall"
    android:layout_width="50dp"
    android:layout_height="wrap_content"
    android:layout_alignLeft="@+id/button1"
    android:layout_below="@+id/button1"
    android:text="4" />

    <Button
    android:id="@+id/button5"
    style="?android:attr/buttonStyleSmall"
    android:layout_width="50dp"
    android:layout_height="wrap_content"
    android:layout_alignBottom="@+id/button4"
    android:layout_alignLeft="@+id/button2"
    android:text="5" />

    <Button
    android:id="@+id/button6"
    style="?android:attr/buttonStyleSmall"
    android:layout_width="50dp"
    android:layout_height="wrap_content"
    android:layout_alignBottom="@+id/button5"
    android:layout_toRightOf="@+id/button2"
    android:text="6" />

    <Button 
    android:id="@+id/button7"
    style="?android:attr/buttonStyleSmall"
    android:layout_width="50dp"
    android:layout_height="wrap_content"
    android:layout_alignLeft="@+id/button4"
    android:layout_below="@+id/button4"
    android:text="1" />

    <Button
    android:id="@+id/button8"
    style="?android:attr/buttonStyleSmall"
    android:layout_width="50dp"
    android:layout_height="wrap_content"
    android:layout_alignBottom="@+id/button7"
    android:layout_toRightOf="@+id/button4"
    android:text="2" />

    <Button
    android:id="@+id/button9"
    style="?android:attr/buttonStyleSmall"
    android:layout_width="50dp"
    android:layout_height="wrap_content"
    android:layout_alignBottom="@+id/button8"
    android:layout_toRightOf="@+id/button5"
    android:text="3" />

    <Button
    android:id="@+id/button10"
    style="?android:attr/buttonStyleSmall"
    android:layout_width="50dp"
    android:layout_height="wrap_content"
    android:layout_alignLeft="@+id/button7"
    android:layout_below="@+id/button7"
    android:text="." />

    <Button
    android:id="@+id/button11"
    style="?android:attr/buttonStyleSmall"
    android:layout_width="50dp"
    android:layout_height="wrap_content"
    android:layout_alignBottom="@+id/button10"
    android:layout_toRightOf="@+id/button7"
    android:text="0" />

    <Button
    android:id="@+id/button12"
    style="?android:attr/buttonStyleSmall"
    android:layout_width="100dp"
    android:layout_height="wrap_content"
    android:layout_alignBaseline="@+id/button11"
    android:layout_alignBottom="@+id/button11"
    android:layout_alignLeft="@+id/button9"
    android:text="=" />

    <Button
    android:id="@+id/button13"
    style="?android:attr/buttonStyleSmall"
    android:layout_width="50dp"
    android:layout_height="wrap_content"
    android:layout_above="@+id/button6"
    android:layout_toRightOf="@+id/button3"
    android:text="/" />

    <Button
    android:id="@+id/button14"
    style="?android:attr/buttonStyleSmall"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBaseline="@+id/button6"
    android:layout_alignBottom="@+id/button6"
    android:layout_alignRight="@+id/button13"
    android:layout_toRightOf="@+id/button3"
    android:freezesText="true"
    android:text="-" />

    <Button
    android:id="@+id/button15"
    style="?android:attr/buttonStyleSmall"
    android:layout_width="50dp"
    android:layout_height="wrap_content"
    android:layout_alignBaseline="@+id/button9"
    android:layout_alignBottom="@+id/button9"
    android:layout_toRightOf="@+id/button6"
    android:text="+" />

    <TextView
    android:id="@+id/textView1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignLeft="@+id/button1"
    android:layout_alignParentTop="true"
    android:layout_marginTop="70dp"
     android:text="@string/hello_world"
    tools:context=".MainActivity" />

    </RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T14:21:03.330

您将按钮名称与按钮上显示的文本混淆了。因此，请将您的按钮命名为“buttonEquals”（或类似名称），并将其文本（或标签）设置为“=”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T17:10:00.427

```
Button mybtn = (Button)findViewById(R.id.YOURBUTTONID);
mybtn.setText("="); 
```

# windows-8 - JsonObject.GetNamedString 正在返回而不是空间

> ID：13069966
> 
> 赞同：0
> 
> 时间：2012-10-25T13:43:04.550
> 
> 标签：windows-8

JsonObject 的 GetNamedString 方法返回   以获得空间。例如，“字符串”返回为  字符串 。是否有任何解决方法来解决此问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T18:17:28.883

如何通过[HtmlDecode](http://msdn.microsoft.com/en-us/library/windows/apps/ee388354.aspx)或[ConvertToText](http://msdn.microsoft.com/en-us/library/windows/apps/windows.data.html.htmlutilities.converttotext.aspx)运行它- 取决于您期望字符串中的内容：

```
JsonObject s = new JsonObject();
s.Add(new KeyValuePair<string, IJsonValue>("val",  JsonValue.CreateStringValue("&nbsp;The String&nbsp;")));
var t = System.Net.WebUtility.HtmlDecode(s.GetNamedString("val")); 
```

顺便说一句，我确实必须明确地将其`nbsp;`放入字符串中以使其显示，因此怀疑您获得的 JSON 已嵌入（而不是默认情况下这样做）。

# css - IE8中伪元素悬停的背景颜色

> ID：13069969
> 
> 赞同：1
> 
> 时间：2012-10-25T13:43:05.103
> 
> 标签：css, internet-explorer-8, hover, background-color, pseudo-element

我正在与（又一个）IE8 错误作斗争。

基本上，我有一个小的方形容器，里面有一个用 :before 和 :after 伪元素构建的箭头。HTML 是这样的：

```
<div class="container">
    <div class="arrow" />
</div>​ 
```

而 CSS 是

```
.container {
    height: 58px;
    width: 58px;
    background-color: #2a5a2a;
}

.arrow {
    padding-top: 7px;
}

.arrow:before {
    margin: 0 auto;
    content: '';
    width: 0;
    border-left: 12px transparent solid;
    border-right: 12px transparent solid;
    border-bottom: 13px gray solid;
    display: block;
}

.arrow:after {
    margin: 0 auto;
    content: '';
    width: 12px;
    background-color: gray;
    height: 14px;

    display: block;
} 
```

现在，当我将鼠标悬停在容器上时，我希望其中的箭头改变颜色。我添加了这个 CSS：

```
.container:hover .arrow:after {
    background-color: white;
}

.container:hover .arrow:before {
    border-bottom-color: white;
}​ 
```

这就是问题开始的地方。这适用于大多数浏览器，但在 IE8 上， background-color 属性没有被覆盖。所以我只得到了新颜色的箭头尖端，而不是构成它“主体”的正方形。

为了让事情更有趣，如果我添加以下内容也将容器背景颜色更改为稍微不同的东西，那么一切都会开始工作并且箭头的背景颜色会发生变化！

```
.container:hover {
    background-color: #2a5a2b;
} 
```

如果我只为容器设置 :hover 状态，并且设置它已经拥有的相同背景颜色，那么它不起作用。如果我想改变背景颜色，我必须改变它。

如果您想尝试一下，这里有一个 jsfiddle：http: [//jsfiddle.net/Ke2S6/](http://jsfiddle.net/Ke2S6/)现在它与悬停时的容器具有相同的背景颜色，因此它不适用于 IE8。更改一个数字，它将开始工作。

所以......有什么想法吗？

# c - 具有循环缓冲区的多生产者单消费者

> ID：13069970
> 
> 赞同：0
> 
> 时间：2012-10-25T13:43:06.080
> 
> 标签：c, multithreading, synchronization, pthreads, mutex

需要帮助才能使以下工作。

我有多个生产者线程（每个都写 100 字节的数据）到 ringbuffer。和一个单一的读者（消费者）线程，一次读取 100 个字节并写入标准输出。（最后我想根据数据写入文件）

通过这个实现，我有时会从环形缓冲区读取数据错误。见下文由于环形缓冲区的大小很小，它会变满并且部分数据丢失。这不是我目前的问题。

> ** 问题：

1.  在打印从 ringbuffer 读取的数据时，一些数据被交换！我找不到错误。
2.  逻辑/方法是否正确？（或）有没有更好的方法来做到这一点

> **环形缓冲区.h**

```
#define RING_BUFFER_SIZE  500
struct ringbuffer
{
    char *buffer;
    int wr_pointer;
    int rd_pointer;
    int size;
    int fill_count;
}; 
```

> **环形缓冲区.c**

```
#include <stdio.h>
#include <stdlib.h> 
#include <string.h>
#include "ringbuffer.h"

int init_ringbuffer(char *rbuffer, struct ringbuffer *rb, size_t size)
{
    rb->buffer = rbuffer;
    rb->size = size;
        rb->rd_pointer = 0;
        rb->wr_pointer = 0; 
        rb->fill_count = 0;
    return 0;
}

int rb_get_free_space (struct ringbuffer *rb)
{ 
    return (rb->size -  rb->fill_count);
}

int rb_write (struct ringbuffer *rb, unsigned char * buf, int len)
{
    int availableSpace;
    int i;

    availableSpace = rb_get_free_space(rb);
    printf("In Write AVAIL SPC=%d\n",availableSpace);
    /* Check if Ring Buffer is FULL */
    if(len > availableSpace)
    {
       printf("NO SPACE TO WRITE - RETURN\n");
       return -1;
    }

    i = rb->wr_pointer;
    if(i == rb->size) //At the end of Buffer 
    {
       i = 0;
    }    
    else if (i + len > rb->size)
    {
        memcpy(rb->buffer + i, buf, rb->size - i);
        buf += rb->size - i;
        len = len - (rb->size - i);
        rb->fill_count += len;
        i = 0;
    }
    memcpy(rb->buffer + i, buf, len);
    rb->wr_pointer = i + len;
    rb->fill_count += len;

    printf("w...rb->write=%tx\n", rb->wr_pointer );
    printf("w...rb->read=%tx\n", rb->rd_pointer );
    printf("w...rb->fill_count=%d\n", rb->fill_count );
    return 0;
}

int rb_read (struct ringbuffer *rb, unsigned char * buf, int max)
{
    int i;

    printf("In Read,Current DATA size in RB=%d\n",rb->fill_count);
    /* Check if Ring Buffer is EMPTY */
    if(max > rb->fill_count) 
    {
      printf("In Read, RB EMPTY - RETURN\n");
      return  -1; 
    }  

    i = rb->rd_pointer;
    if (i == rb->size)
    {
       i = 0;
    }
    else if(i + max > rb->size)
    {
        memcpy(buf, rb->buffer + i, rb->size - i);
        buf += rb->size - i;
        max = max - (rb->size - i);
        rb->fill_count -= max;
        i = 0;
    }
    memcpy(buf, rb->buffer + i, max);
    rb->rd_pointer = i + max;
    rb->fill_count -= max;

    printf("r...rb->write=%tx\n", rb->wr_pointer );
    printf("r...rb->read=%tx\n", rb->rd_pointer );
    printf("DATA READ ---> %s\n",(char *)buf);
    printf("r...rb->fill_count=%d\n", rb->fill_count );
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-23T11:56:37.327

（作者可能会晚一点，但如果其他人搜索“多生产者单一消费者”）

我认为该实现中的基本问题是 rb_write 修改了全局状态（rb->fill_count 和其他 rb->XX），而无需在多个写入器之间进行任何同步。

有关替代想法，请查看：[http](http://www.linuxjournal.com/content/lock-free-multi-producer-multi-consumer-queue-ring-buffer) ://www.linuxjournal.com/content/lock-free-multi-producer-multi-consumer-queue-ring-buffer 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T16:52:47.283

至于你的问题—— 1\. 我也找不到那个错误——事实上，我已经尝试过你的代码并且没有看到这种行为。2\. 你问这是否逻辑/方法正确——好吧，就目前而言，这确实实现了一种环形缓冲区。您的测试用例恰好是大小的整数倍，并且记录大小是恒定的，因此这不是最好的测试。

在尝试你的代码时，我发现有很多线程饥饿——第一个运行的生产者线程（最后一个创建的）非常困难，在第一次 5 次之后尝试并失败，将东西填充到缓冲区中，而不是给出消费者线程有机会运行（甚至启动）。然后，当消费者线程启动时，它会在释放 cpu 之前保持相当长的一段时间，并且下一个生产者线程最终会启动。这就是它在我的机器上的工作方式——我敢肯定，它在不同的机器上会有所不同。

太糟糕了，您当前的代码没有办法结束——创建 10 或 100 的 MB 文件......很难涉足。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T14:54:14.020

在生产者处，您还需要等待条件变量的`has empty space`条件。这两个条件变量都应该无条件地发出信号，即当消费者从环形缓冲区中删除一个元素时，它应该向生产者发出信号；当生产者将某些东西放入缓冲区时，它应该向消费者发出信号。此外，我会将这个等待/信令逻辑移动到 rb_read 和 rb_write 实现中，因此您的环形缓冲区对于您的程序的其余部分来说是一个“完整的使用解决方案”。

# svn - Maven 程序集 - 将结果复制到 svn

> ID：13069974
> 
> 赞同：1
> 
> 时间：2012-10-25T13:43:08.943
> 
> 标签：svn, maven, target, maven-assembly-plugin

我正在使用程序集插件创建 ZIP。我想将这个全新的文件提交给我的 svn。你知道最好的方法吗？

我尝试了一些不同的解决方案但没有成功。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T20:46:45.647

是的，这是可能的。使用[Maven SCM 插件](http://maven.apache.org/scm/maven-scm-plugin/usage.html)。您可以配置`<executions>`附加到您的包阶段（更有可能是`<profile>`）的特定插件，这些插件运行[`scm:add`目标](http://maven.apache.org/scm/maven-scm-plugin/add-mojo.html)，然后是[`scm:checkin`目标](http://maven.apache.org/scm/maven-scm-plugin/checkin-mojo.html)。

# c - 将 8 位 sse 寄存器转换为 16 位短路

> ID：13069976
> 
> 赞同：3
> 
> 时间：2012-10-25T13:43:21.173
> 
> 标签：c, optimization, sse

我有一个`__m128i`包含 8 位值的寄存器，内容如下：

```
{-4,10,10,10,10,10,10,-4,-4,10,10,10,10,10,10,-4} 
```

现在我想将它转换为`_m128i`寄存器中的八个 16 位值。它应该看起来像：

```
{-4,10,10,10,10,10,10,-4} 
```

用尽可能少的指令如何做到这一点？我最多想用SSSE3。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T13:49:26.900

假设您只想要 16 个值中的前 8 个值，并且将忽略其他 8 个（您提供的示例数据有些模棱两可），那么您可以像这样使用 SSE2 执行此操作：

```
v = _mm_srai_epi16(_mm_unpacklo_epi8(v, v), 8); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-02-05T16:29:02.350

您可以使用一条 SSE2 指令来执行此操作（忽略初始化）

```
__m128i const zero = _mm_setzero_si128(); // (if you're in a loop pull this out)
__m128i       v;

v = _mm_unpacklo_epi8(v, zero); 
```

# mysql - Access中的查询非常慢，SQL服务器可以做得更好吗

> ID：13069977
> 
> 赞同：0
> 
> 时间：2012-10-25T13:43:21.903
> 
> 标签：mysql, sql, database, ms-access

我正在使用 MSAccess 快速加载数据并执行一些分析。由于数据超过 200,000 条记录，它变得非常慢，并且永远需要或永远不会返回结果。我知道这是意料之中的。

在这种情况下，安装像 MySQL 这样的 SQL 服务器（免费提供）会更好吗？（即使是一百万个类似的记录）

我不能要求付费软件来执行分析。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T13:52:23.437

你不是在谈论很多记录。如果您使用的查询没有针对性能进行优化，那么安装 SQL Lite 对您没有多大帮助。我建议尝试优化您的查询和/或增加查询超时，以便可以返回结果。索引表也会稍微提高性能，但查询优化是最重要的。

# django - django - 在 html 中看不到 my_error 值

> ID：13069978
> 
> 赞同：0
> 
> 时间：2012-10-25T13:43:22.127
> 
> 标签：django, django-templates

它看起来像一个愚蠢的错误，但我没有看到它（（我在模板中看不到 my_error 值。

这是我的意见.py

```
def tasks(request, my_error=''):
    print my_error.encode('utf8')
    user = request.user.username
    try:
        fio = Worker.objects.get(login=user)
    except Worker.DoesNotExist:
        fio = 'Нет такого пользователя'
    if user not in admins:
        tasks = Task.objects.filter(worker=fio)
    else:
        tasks = Task.objects.filter()
    # here I can still see value of my_error
    print my_error.encode('utf8')
    return render_to_response('tasks.html',{'user':user,'fio':fio,'tasks':tasks, 'my_error':my_error}) 
```

我的模板：

```
{% extends "base.html" %}
{% block title %}
Список тикетов
{% endblock %}
{% block style %}
<meta http-equiv="refresh" content="60">
{% endblock %}
{% block content %}
    Привет, {{ fio.fio }}
<br />

{# {% if my_error %} #}
<h1>{{my_error}}</h1>
{# {% endif %} #}

<ol>
    {% for task in tasks %}
        <li><a href="../task/{{task.id}}">{{task.name}}<a></li>
    {% endfor %}
</ol>
<a href="/new_ticket/">Добавить задачу</a> <br />

{% endblock %} 
```

这里我用 my_error 调用 tasks()：

```
tasks(request, my_error=u'Такой задачи нет. Возможно она была уже удалена') 
```

但是，如果我使用

```
return render_to_response('tasks.html',{'user':user,'fio':fio,'tasks':tasks, 'my_error':'my_error'}) 
```

我在 html 中看到

# 我的错误

. 怎么了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T13:46:18.707

```
except Task.DoesNotExist:
    print 'here'
    tasks(request, my_error=u'Такой задачи нет. Возможно она была уже удалена') 
```

应该

```
except Task.DoesNotExist:
    print 'here'
    return tasks(request, my_error=u'Такой задачи нет. Возможно она была уже удалена') 
```

ps：将代码的重要部分粘贴到初始帖子中，因此其他人可能实际上知道这里发生了什么而无需挖掘评论（又名：粘贴调用tasks（）的视图）

# sql - 在 SQL Server 2005 中不使用 RTRIM 对字符串进行 RTRIM 的最有效方法是什么？

> ID：13069980
> 
> 赞同：-1
> 
> 时间：2012-10-25T13:43:28.023
> 
> 标签：sql, sql-server-2005

在单选语句中，我需要`RTRIM`在 SQL Server 2005 环境中使用字符串。

在您看来，实现这一目标的最有效技术是什么？

例子：

```
'ALPHA    ' ==> 'ALPHA' (the blanks at the end are removed)
' BETA  ' ==> ' BETA'  (the blank in first position remains, the two blanks at the end are removed)
' GAMMA' ==> ' GAMMA'  (the blank in first position remains) 
```

预先感谢您的帮助。

编辑：我无权使用`RTRIM`！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:24:26.507

一种`LEN(CHAR_FIELD_OR_VAR)`忽略尾随空格的方法；

```
left(fld, len(fld)) 
```

或者

```
select left(fld, (len(fld + '.')-1)-patindex('%[^ ]%', reverse(fld))+1) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T03:32:24.350

尝试这个

```
Declare @str Varchar(50) = '      GAMMA    ' 
;With Cte As
( 
    Select Data = Substring(@str,Number,1) 
    From master.dbo.spt_values 
    where Number Between 1 And Len(@str) And Type='P' 
) 
Select Data = Replace(Bar,'&#x20;',' ') 
From (Select Cast(Data As Varchar(Max)) From Cte For Xml Path(''))Foo(Bar) 
```

**结果**

```
Data
      GAMMA 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T13:47:27.573

```
Select rtrim(ltrim(col)) from.... 
```

这将修剪柱子的两侧

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T13:47:48.870

我认为您的答案在标题中：

```
SELECT Columm1
, RTRIM(Column1) as Column1Trimmed
FROM Table1 
```

RTRIM 是最有效的 Right TRIMming 方法。

没有 RTRIM：

```
select '*          *'
, REPLACE('*          *',' ','') 
```

# asp.net - 根据域名服务特定页面

> ID：13069995
> 
> 赞同：2
> 
> 时间：2012-10-25T13:44:04.573
> 
> 标签：asp.net

我们有一个客户域名 (d1) 指向我们的一个站点 (s1)，它是一个 .NET 4 Web 表单站点。客户端在不同的域 (d2) 上设置了一个子域，并将其指向 s1 IP 地址。如果使用 d2 域并且 URL 中没有该页面，我们需要在 s1 上提供特定页面。如果可能的话，我想在没有重定向的情况下实现这一点。

例如

example.com -> 网站

x.example.net -> 站点 /thepage.aspx（但希望地址栏中的 URL 保留 x.example.net，而不是 x.example.net/thepage.aspx）。

我已经尝试在开始请求中执行 Server.Transfer，虽然这有效，但回发没有（我假设是因为传输，但我不知道如何在开始请求中检测回发，因此不传输） .

我认为可能有一种方法可以利用路由，但不会有路径（只有域名），所以任何像这样设置的路由都可能会将所有请求路由到这个页面，如果它们没有被捕获是以前的路由 - 不是理想的）。

所以，简而言之：有没有办法在 global.asax 中的 Application_BeginRequest 中检测回发，所以我只传输初始请求？或者有没有一种将域名映射到页面而不重定向的方法？是否有一些我不知道的功能可以实现这一目标？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T13:57:00.237

您可以编写一个检查传入请求的 HttpModule - 如果请求是针对 x.domain2.com，那么您可以像这样调用 thepage.aspx：

```
Type page_type = BuildManager.GetCompiledType ("~/thepage.aspx");
Page page = (Page) Activator.CreateInstance (page_type);
page.ProcessRequest (Context); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T19:47:21.130

您可以设置重写规则来执行此操作。仅当主机与 x.example.net 匹配时，以下规则才会将根 Url 重写为 /thepage.aspx。

```
RewriteCond  %{HTTP_HOST} (^x.example.net$)
RewriteRule ^$ / [NC,L] 
```

**如果您有 IIS7**：您可以使用[URL Rewrite](http://www.iis.net/downloads/microsoft/url-rewrite)执行此操作。

![网址重写](../Images/8bb93f2a47130b0aaff0baaee93ba953.png)

**如果你有 IIS6** ：你可以在服务器上设置[ISAPI Rewrite 。](http://www.isapirewrite.com/)

*根据您的设置，第二行可能包含斜杠：*

*RewriteRule ^/$ /thepage.aspx [NC,L]*

# spring - 带有 JNDI 和 JPA 事务管理器的 Spring Transaction

> ID：13069999
> 
> 赞同：1
> 
> 时间：2012-10-25T13:44:11.347
> 
> 标签：spring, jpa-2.0

我在 Context.xml(JNDI) 中定义了 DataSource，我想在 Spring 应用程序 Context.xml 中使用 JPA 事务管理器。我不想使用 JTA Transaction，因为我使用的是 tomcat 服务器。

谁能帮助我如何通过示例实现这一目标？我在 DAO 和服务中使用 @transactional 注释。

问候维杰

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T14:09:45.237

you can Define DataSource: Use JndiObjectFactoryBean class. To define the data source by providing JNDI binding name.

```
<!– Data Source JNDI –&gt;
<bean id=”dataSource” class=”org.springframework.jndi.JndiObjectFactoryBean”&gt;
<property name=”jndiName”&gt;
<value>jdbc/SampleDS</value>
</property>
</bean> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T14:05:43.487

这是一个例子：

```
<?xml version="1.0" encoding="UTF-8"?>
    <beans xmlns="http://www.springframework.org/schema/beans"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xmlns:jee="http://www.springframework.org/schema/jee"
         xmlns:tx="http://www.springframework.org/schema/tx"
         xsi:schemaLocation="
         http://www.springframework.org/schema/beans 
         http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
         http://www.springframework.org/schema/jee 
         http://www.springframework.org/schema/jee/spring-jee-3.0.xsd
         http://www.springframework.org/schema/tx
         http://www.springframework.org/schema/tx/spring-tx-3.0.xsd">

  <!-- Provides access to the JNDI datasource -->
  <jee:jndi-lookup id="dataSource" jndi-name="jdbc/jpetstore"/> 

  <!-- Defines transaction manager -->
  <bean id="txManager" class="org.springframework.jdbc.datasource.DataSourceTransactionManager">
       <property name="dataSource" ref="dataSource"/>
  </bean>

  <!-- Enables transactional behavior -->
  <tx:annotation-driven />

  <!-- other <bean/> definitions here -->

</beans> 
```

用于`<jee:jndi-lookup/>`访问`JNDI`数据源。然后，将获得的数据源引用传递给适当的`PlatformTransactionManager`，例如`DataSourceTransactionManager`.

此外，`<tx:annotation-driven />`应该为`@Transactional`要激活的注释提供。

为了更好地理解 Spring 事务管理，我建议阅读[此处](http://static.springsource.org/spring/docs/3.0.x/reference/transaction.html)提供的 Spring 参考的第 10 章。