# StackOverflow 问答 15143000-15143999

# c# - Windows Phone 应用程序，Convert.tobase64 给出 ArgumentOutOfRange 异常

> ID：15143003
> 
> 赞同：0
> 
> 时间：2013-02-28T18:31:52.487
> 
> 标签：c#, windows-phone-8, azure-mobile-services

```
Convert.ToBase64CharArray(_imageBytes, 0, 120000, outa, 0); 
```

_imagebytes 是来自可写位图的字节数组。如果大小大于 120000，则会引发 ArgumentOutOfRange 异常。

有没有更好的（甚至是有效的）方法将图像序列化为字符数组？

需要使用它将图像序列化为字符数组以将其存储在 Azure 移动服务中

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T18:50:36.510

base64 编码将三个字节存储在四个字符中，因此您可以取出可以被 3 整除的数组部分并分别进行转换。

例如，将转换 10000 个字节的工作分成四个部分：

```
Convert.ToBase64CharArray(_imageBytes, 0, 3000, outa, 0);
Convert.ToBase64CharArray(_imageBytes, 3000, 3000, outa, 4000);
Convert.ToBase64CharArray(_imageBytes, 6000, 3000, outa, 8000);
Convert.ToBase64CharArray(_imageBytes, 9000, 1000, outa, 12000); 
```

# xslt - 是否可以计算 xslt 键中的项目数？

> ID：15143006
> 
> 赞同：2
> 
> 时间：2013-02-28T18:31:57.920
> 
> 标签：xslt, key

我有这把钥匙，它可能是空的：

```
<xsl:key 
         name="k1" 
         match="div[contains(@class, 'contents')]/node()[not(self::br) and not(ancestor-or-self::p)]" 
         use="generate-id(following-sibling::br[1])"/> 
```

目前要检查它是否为空（在与 div[contains(@class, 'contents')] 匹配的 xsl:template 块中）我重新运行 xpath（例如）：

```
 <xsl:when test="count(node()[not(self::br) and not(ancestor-or-self::p)]) > 1"> 
```

有什么原因我可以只计算一个键中的项目，例如：

```
 <xsl:when test="count(key('k1', *) > 1"> 
```

我考虑过使用 a`<xsl:for-each>`并将 isempty var 分配给 false，但希望有一种更清洁的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T19:48:06.707

您可以计算映射到*特定*键值的节点数，但不能计算整个键已知的节点总数（除了映射到每个值的所有节点集的联合）。我会用相同`match`但不同的定义第二个键`use`：

```
<xsl:key 
     name="k2" 
     match="div[contains(@class, 'contents')]/node()[not(self::br) and not(ancestor-or-self::p)]" 
     use="generate-id(..)"/> 
```

然后`div[contains(@class, 'contents')]`使用获取模板中的计数`count(key('k2', generate-id()))`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-15T19:34:56.710

如果您使用use 属性中的*常量*创建*第二个*键：

 *```
<xsl:key 
     name="k1_all" 
     match="div[contains(@class, 'contents')]/node()[not(self::br) and not(ancestor-or-self::p)]" 
     use="'all'"/> 
```

然后你可以简单地使用：

```
<xsl:value-of select="count(key('k1_all','all'))"/> 
```

至少像这样，您可以将两个键（一个用于查找，一个用于计数）直接相邻放置在 XSLT 文件中，这样复杂的 XPath 就更易于维护。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T04:18:08.603

**只需使用**：

```
count(//div[contains(@class, 'contents')]/node()
                              [not(self::br) and not(ancestor-or-self::p)]) 
```*

# php - .htaccess 引用子目录中的图像

> ID：15143008
> 
> 赞同：2
> 
> 时间：2013-02-28T18:32:08.527
> 
> 标签：php, .htaccess

我会尽量把这个简短。这是我第一次尝试使用 HTACCESS 创建“用户友好的 URL”。我已经设置了我的 .htaccess 文件，以便当用户单击*似乎*位于子文件夹中的链接时，它会在根目录中加载一个文件。前任：

```
    重写引擎开启
    RewriteRule ^([^\.]+)$ $1.php [NC,L]
    RewriteRule ^current-communities/(.*)$ $1 [L]

```

因此，如果我单击“/current-communities/my-community”之类的链接，它将加载文件“my-community.php”。那里没问题。但是，现在我正在尝试制定另一个规则，当我单击“ floor-plans”链接， floor-plans.php 文件将根据其查询字符串从数据库加载数据：

```
    RewriteRule ^floor-plans/([^/]+)-([^/]+).php floor-plans.php?communityname=$1&modelname=$2 [NC]

```

因此，如果用户单击“/floor-plans/my-community-myhouse”之类的链接，它将加载“floor-plans.php”文件，其中“my-community”作为第一个查询字符串变量，“myhouse” “作为第二个。

我在这里遇到的问题是“floor-plans.php”文件没有显示图片。它正在查找一个名为“images”的文件夹以获取图形，但由于“images”实际上位于根目录中，我只得到一个非常空的页面，但由于某种原因，这不是“current-”的虚拟目录的问题社区”。你能帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T17:58:47.983

您好尝试使用文档头部的下一个代码，基本上它的作用是将所有脚本和 css 文件的路径设置为 php 文档的实际根目录，而不是设置浏览器中的地址以供您使用。所以它实际上所做的是在导入任何其他内容之前在头部设置一次如果你在 css/style.css 上给出 php 将自动设置路径，php 将在返回浏览器之前设置它[http://www.myweb .com/css/style.css](http://www.myweb.com/css/style.css)

它适用于我的网站，希望对您有所帮助。

```
<BASE href="http://<?php echo $_SERVER['SERVER_NAME']."/".$_SERVER['PHP_SELF'] ?>"> 
```

# linux - 如何同时使用 Bumblebee 和 QtCreator？

> ID：15143011
> 
> 赞同：0
> 
> 时间：2013-02-28T18:32:26.047
> 
> 标签：linux, qt-creator, nvidia

如何在 Bumblebee 中不启动 QtCreator 的情况下同时使用 Bumblebee 和 QtCreator？

**对于那些不知道大黄蜂是什么的人：**

*它是 Linux 中 Nvidia Optimus 的非官方版本。它允许您仅在需要时激活 dGPU。但是如果你是一个图形程序员，你可能想用你的 dGPU 创建你的 OpenGL 上下文。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T18:32:26.047

1.) 创建你的项目。

2.) 在我的示例中，转到您的项目调试文件夹`/home/maik/untitled-build-Desktop_Qt_5_0_1_GCC_64bit-Debug`

3.) 创建一个新文件。称它为`optimus.sh`

4.) 打开 optimus.sh 并编写以下内容 ->`optirun ./untitled`

*请注意，无标题只是调试文件夹中可执行文件的名称，在我的情况下它是“无标题”*

5.) 转到 QtCreator -> `Projects`-> `Build & Run`-> 选择您要使用的套件 -> 转到`Run`-> 在`'Run'`单击`'Add'`-> `Custom executable`-> 在 下`'Command'`，选择您的`optirun.sh`文件 -> 打开`Run in Teminal`。

现在每次您在 QtCreator 中单击运行时，您的可执行文件都将使用 optirun 启动。现在，您的 dGPU 只有在您运行应用程序时才会被激活，而不是一直被激活。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-01-05T20:42:03.597

另一个答案有效，但我觉得我的方式更干净：

*   在 Qt Creator 中，转到`Projects`选项卡。
*   转到 `Build & Run`-> `[your kit]`-> `Run`。
*   在右侧，在 下`Run`，单击以添加`Custom executable`。
*   `Executable`填写`/usr/bin/optirun`（或任何输出`which optirun`）。
*   如果您的可执行文件已命名并位于构建目录中，请`Command line arguments`填写。`./foobar``foobar`
*   保持`Working directory`为`%{buildDir}`.

# javascript - 将 OBJECT ARRAY 绑定到 AngularJs 中 SELECT 的 OPTIONS VALUES

> ID：15143013
> 
> 赞同：3
> 
> 时间：2013-02-28T18:32:32.770
> 
> 标签：javascript, angularjs

我有一个对象散列，这个散列的 ID 绑定到一个 RADIO BUTTON。当用户选择此单选时，我需要使用基于此模型属性的选项填充选择标签。很难解释，所以我创建了一个 Codepen 来展示我想要的内容： [http ://codepen.io/rizidoro/pen/BeJjf](http://codepen.io/rizidoro/pen/BeJjf)

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T07:31:00.197

这是一个动态绑定到单个 SELECT 元素的[codepen 演示，在选择更改时使用工作 ng-model 绑定：](http://codepen.io/adnan-i/pen/gLtap)

HTML：

```
<div ng-controller="TestCtrl">
  <ul>
    <li ng-repeat="attr in data">
      <input type="radio" name='data-attr' value='{{attr.id}}' ng-model="selected.id" />{{attr.name}}
    </li>
  </ul>

  <select ng-model="selected.value" ng-options="item.name for item in selectedAttr.values "></select>
</div> 
```

JS：

```
function TestCtrl($scope) {
  $scope.selected = {};

  $scope.data =  [
    {"id":"113000",
      "name":"Size",
      "values":
          [{"id":"92029","name":"Size A"},
           {"id":"92030","name":"Size B"}]
    },
    {"id":"113002",
      "name":"Color",
      "values":
          [{"id":"94029","name":"Blue"},
           {"id":"94030","name":"Black"}]
    }
  ];

  $scope.$watch('selected.id', function(id){
    delete $scope.selected.value;
    angular.forEach($scope.data, function(attr){
      if(attr.id === id){
        $scope.selectedAttr = attr;
      }
    });
  });
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-01T02:08:38.860

我创建了一个小提琴，可以解决你的问题。[http://jsfiddle.net/qY2Zz/](http://jsfiddle.net/qY2Zz/)。

1.  将数据分离到服务中。

    `animateAppModule.service('data', function(){...})`

2.  将模型分配给选择框。

    `ng-model="$scope.selectedOption"`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T19:05:04.247

[http://jsfiddle.net/wagedomain/afuz5/](http://jsfiddle.net/wagedomain/afuz5/)

我稍微改写了您的 HTML - 在 div 或 span 就足够的情况下不使用 ul / li 标签。使它更容易。

基本上，在 ng-repeat 中，您可以这样做：

```
<div ng-repeat="attr in data">
      <input type='radio' name='data-attr' value='{{attr.id}}' />{{attr.name}}   
      <select ng-model="selected" ng-options="item.name for item in attr.values "></select>
</div> 
```

正是 ng-options 使这项工作发挥了作用。我还添加了一个 $scope.selected 变量来模型绑定，但我没有在小提琴中做任何事情。根据需要使用。

# c++ - 使用 boost::filtering_ostream 时，为什么它没有 sync() 函数？

> ID：15143017
> 
> 赞同：3
> 
> 时间：2013-02-28T18:33:03.140
> 
> 标签：c++, boost, iostream

根据[文档](http://www.boost.org/doc/libs/1_53_0/libs/iostreams/doc/classes/filtering_stream.html)，应编译以下内容：

```
boost::iostreams::filtering_ostream out;
out.sync(); 
```

但神秘的是它没有。我的 vs2010 编译器喊道：

```
error C2039: 'sync' : is not a member of 'boost::iostreams::filtering_stream<Mode>'
      with
      [
          Mode=boost::iostreams::output
      ] 
```

我正在使用 boost 1.50.0 但 boost.iostreams 自 boost 1.46.0 以来没有改变

# javascript - 收到响应时更新 rails 视图

> ID：15143024
> 
> 赞同：0
> 
> 时间：2013-02-28T18:33:22.483
> 
> 标签：javascript, ruby-on-rails, ruby, ajax, api

我想这样做：

```
In the view, have a button_to "Find"
The button click submits the search query to the rails action (controller)
The action calls some external api
A response comes back in 1ms up to 20secs (who knows? it's an external webservice, right?)
When the response is returned, the view which originally contains the button_to and the search field is updated with the response (via javascript) 
```

1.  这背后的基本思想是什么？
2.  这叫什么？
3.  返回响应时如何更新视图？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T18:57:49.703

1.  当您想更改发出请求的页面时，您的按钮将触发 AJAX 调用。在服务器端，您只需要使用像[HTTParty](https://github.com/jnunemaker/httparty)这样的库来进行调用，等待响应到达服务器，根据需要进行处理，然后自己发送响应。

2.  AFAIK 这个动作没有特定的名称；但是我们可以说您的服务器充当另一个服务的*代理*，如果您重新处理来自许多不同 API 的答案，那么您的服务就是一种*聚合器*

3.  要更新视图，这取决于您如何实现 ajax 调用。您可以：

    *   使用 JSON 数据响应一些，您的回调将处理并用于更新页面，可能使用像[把手这样的模板系统](http://handlebarsjs.com/)
    *   用一些 JS 响应，通常是一个将在客户端上执行的片段，例如

        $('#my_element').replaceWith('<%= j( render partial: "some_partial" ) %>');

# mongodb - mongodb使用casbah流体语法查询正则表达式

> ID：15143027
> 
> 赞同：0
> 
> 时间：2013-02-28T18:33:46.873
> 
> 标签：mongodb, scala, casbah

我在使用流畅的 dsl 语法查询正则表达式时遇到问题，我想说的是`("id" -> foo)`使用流体。foo 是一个正则表达式，所以在正则表达式上没有 $elemMatch，所以我得到“从 Regex 到 DBObject 没有可用的隐式视图”。

所以，目前我必须按以下方式构建我的查询：

`("someval" $gte 5) ++ ("id" -> foo)`，我必须把 id 部分放在最后，因为它没有通过 dsl。我想要的是

```
("id" [WHAT OP HERE?] foo.r) ++ ("someval" $gte 5) 
```

我如何做到这一点？请注意，我知道如何使用 "regular" ("foo" -> MongoDbObject(... 语法，我想使用 dsl 来做同样的事情。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T16:33:29.047

这不仅仅是正则表达式的问题，而是任何进行相等性度量的流畅语法，例如：

```
("name" -> "rozza") ++ ("forum" -> "stackoverflow") 
```

这也失败了，目前您必须包装一个`MongoDBObject`实例。

# c++ - Executing a member function of a class

> ID：15143031
> 
> 赞同：3
> 
> 时间：2013-02-28T18:33:58.397
> 
> 标签：c++, multithreading, c++11, stdthread

I am trying to experiment the C++11 threads in a way that it accepts a member function of a class as a parameter into the thread constructor as shown in the first code snippet below on line 20 that is marked . The class definition is given in the 2nd code snippet. When this code is compiled, I am getting a bunch of errors shown in the 3rd snippet. Can anyone tell me what I am doing wrong? Thanks.

**SNIPPET 1: Thread initialization (main_app.cpp)**

```
#include <thread>
#include "ServiceRegistrar.hpp"

#define SERVER_TYPE  100065
#define SERVER_INST_LOWER  1
#define SERVER_INST_UPPER  2
#define TIMEOUT  500000

int main()
{
  ServiceRegistrar sr1(SERVER_TYPE, TIMEOUT, SERVER_INST_LOWER, SERVER_INST_LOWER);
      /*LINE 20 is the following*/
  std::thread t(&ServiceRegistrar::subscribe2TopologyServer, sr1);
t.join();
  sr1.publishForSRs();

} 
```

**SNIPPET 2: Class definition**

```
class ServiceRegistrar
{
  public:
    ServiceRegistrar(int serverType, int serverTimeOut, int serverInstanceLower, int serverInstanceUpper)
       : mServerType(serverType),
         mServerTimeOut(serverTimeOut),
         mServerInstanceLower(serverInstanceLower),
         mServerInstanceUpper(serverInstanceUpper)
         { }

     void subscribe2TopologyServer();
     void publishForSRs();
     void publishForServices();

  private:
     int mServerType;
     int mServerTimeOut;
     int mServerInstanceLower;
         int mServerInstanceUpper;           
  }; 
```

**SNIPPET 3: Compilation output**

```
 $ g++ -g -c -Wall -std=c++11 main_app.cpp -pthread
  In file included from /usr/include/c++/4.7/ratio:38:0,
             from /usr/include/c++/4.7/chrono:38,
             from /usr/include/c++/4.7/thread:38,
             from main_app.cpp:8:
  /usr/include/c++/4.7/type_traits: In instantiation of ‘struct    std::_Result_of_impl<false, false, std::_Mem_fn<void (ServiceRegistrar::*)()>,    ServiceRegistrar>’:
  /usr/include/c++/4.7/type_traits:1857:12:   required from ‘class std::result_of<std::_Mem_fn<void (ServiceRegistrar::*)()>(ServiceRegistrar)>’
  /usr/include/c++/4.7/functional:1563:61:   required from ‘struct std::_Bind_simple<std::_Mem_fn<void (ServiceRegistrar::*)()>(ServiceRegistrar)>’
 /usr/include/c++/4.7/thread:133:9:   required from ‘std::thread::thread(_Callable&&,  _Args&& ...) [with _Callable = void (ServiceRegistrar::*)(); _Args = {ServiceRegistrar&}]’
 main_app.cpp:20:64:   required from here
/usr/include/c++/4.7/type_traits:1834:9: error: no match for call to     ‘ (std::_Mem_fn<void (ServiceRegistrar::*)()>) (ServiceRegistrar)’ 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-28T18:40:03.843

Apparently it's a [gcc 4.7 bug](https://stackoverflow.com/questions/15080200/gcc-4-7-2-stdthread-with-pointer-to-member-function)...use

```
std::thread t(&ServiceRegistrar::subscribe2TopologyServer, &sr1); 
```

instead.

EDIT: actually, you probably don't want to be copying `sr1` to the thread-local-storage of `t`, so this is better anyway.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T18:41:41.137

Try:

```
std::thread t(std::bind(&ServiceRegistrar::subscribe2TopologyServer, sr1)); 
```

Hope it helps.

# ruby - Ruby Koans 与 Ruby 2.0.0 不兼容？

> ID：15143040
> 
> 赞同：8
> 
> 时间：2013-02-28T18:34:30.270
> 
> 标签：ruby, rvm, ruby-2.0

在成功升级到 Ruby 2.0.0 的稳定版本（耶！）后，我决定继续我的 Koans **Path to Enlightenment**。但是，`rake`像往常一样在 koans 文件夹中运行命令时，我收到此错误：

```
rake
cd koans
/Users/jordanthornquest/.rvm/rubies/ruby-2.0.0-p0/bin/ruby path_to_enlightenment.rb
/Users/jordanthornquest/programming/ruby-koans/koans/edgecase.rb:399:in `rescue in meditate': uninitialized constant EdgeCase::Sensei::AssertionError (NameError)
    from /Users/jordanthornquest/programming/ruby-koans/koans/edgecase.rb:407:in `meditate'
    from /Users/jordanthornquest/programming/ruby-koans/koans/edgecase.rb:470:in `block in walk'
    from /Users/jordanthornquest/programming/ruby-koans/koans/edgecase.rb:481:in `block (3 levels) in each_step'
    from /Users/jordanthornquest/programming/ruby-koans/koans/edgecase.rb:479:in `each'
    from /Users/jordanthornquest/programming/ruby-koans/koans/edgecase.rb:479:in `block (2 levels) in each_step'
    from /Users/jordanthornquest/programming/ruby-koans/koans/edgecase.rb:478:in `each'
    from /Users/jordanthornquest/programming/ruby-koans/koans/edgecase.rb:478:in `each_with_index'
    from /Users/jordanthornquest/programming/ruby-koans/koans/edgecase.rb:478:in `block in each_step'
    from /Users/jordanthornquest/programming/ruby-koans/koans/edgecase.rb:476:in `catch'
    from /Users/jordanthornquest/programming/ruby-koans/koans/edgecase.rb:476:in `each_step'
    from /Users/jordanthornquest/programming/ruby-koans/koans/edgecase.rb:469:in `walk'
    from /Users/jordanthornquest/programming/ruby-koans/koans/edgecase.rb:491:in `block in <top (required)>'
rake aborted!
Command failed with status (1): [/Users/jordanthornquest/.rvm/rubies/ruby-2...]
/Users/jordanthornquest/programming/ruby-koans/Rakefile:90:in `block in <top (required)>'
/Users/jordanthornquest/.rvm/gems/ruby-2.0.0-p0/bin/ruby_noexec_wrapper:14:in `eval'
/Users/jordanthornquest/.rvm/gems/ruby-2.0.0-p0/bin/ruby_noexec_wrapper:14:in `<main>'
Tasks: TOP => default => walk_the_path 
```

我今天还从 GitHub 安装了一个全新的 Koans 批次，以确保这不是我的问题。都不适合我！它在 1.9.3 中仍然运行良好。值得注意的是，我还通过 RVM 安装了 Ruby 2.0。在这样做之前，我确保更新到最新的 RVM。

似乎是什么问题？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-28T19:43:20.690

有一个拉取请求来解决这个问题，但它尚未被接受：[https ://github.com/neo/ruby_koans/pull/84](https://github.com/neo/ruby_koans/pull/84)

现在，您可以将第 149 行编辑`src/edgecase.rb`为：

```
in_ruby_version("1.9", "2.0") do 
```

# git - 变基后无法推送到分支

> ID：15143042
> 
> 赞同：144
> 
> 时间：2013-02-28T18:34:41.053
> 
> 标签：git, merge, rebase, git-merge, git-rebase

我们使用 git 并有一个 master 分支和 developer 分支。我需要添加一个新功能，然后将提交重新设置为 master，然后将 master 推送到 CI 服务器。

问题是，如果我在 rebase 期间发生冲突，我无法在 rebase 完成后推送到我的远程开发人员分支（在 Github 上），直到我拉出我的远程分支。这会导致重复提交。当没有冲突时，按预期工作。

问题：在 rebase 和冲突解决之后，如何在不创建重复提交的情况下同步本地和远程开发人员分支

设置：

```
// master branch is the main branch
git checkout master
git checkout -b myNewFeature

// I will work on this at work and at home
git push origin myNewFeature

// work work work on myNewFeature
// master branch has been updated and will conflict with myNewFeature
git pull --rebase origin master

// we have conflicts
// solve conflict
git rebase --continue

//repeat until rebase is complete
git push origin myNewFeature

//ERROR
error: failed to push some refs to 'git@github.com:ariklevy/dropLocker.git'
hint: Updates were rejected because the tip of your current branch is behind
hint: its remote counterpart. Merge the remote changes (e.g. 'git pull')
hint: before pushing again.
hint: See the 'Note about fast-forwards' in 'git push --help' for details.

// do what git says and pull
git pull origin myNewFeature

git push origin myNewFeature

// Now I have duplicate commits on the remote branch myNewFeature 
```

## 编辑

**所以听起来这会破坏工作流程：**

developer1 在 myNewFeature 上工作 developer2 在 hisNewFeature 上工作都使用 master 作为主分支

developer2 将 myNewFeature 合并到 hisNewFeature

developer1 变基，解决冲突，然后强制推送到 myNewFeature 的远程分支

几天后，developer2 再次将 myNewFeature 合并到 hisNewFeature

这会导致其他开发者讨厌 developer1 吗？

* * *

## 回答 #1

> 赞同：98
> 
> 时间：2013-02-28T19:44:13.357

首先，您和与您一起工作的人需要就主题/开发分支是用于共享开发还是仅用于您自己的开发达成一致。其他开发人员知道不要合并到我的开发分支上，因为它们随时会被重新定位。通常工作流程如下：

```
o-----o-----o-----o-----o-----o       master
 \
   o-----o-----o                      devel0
                \
                  o-----o-----o       devel1 
```

然后，为了与遥控器保持同步，我将执行以下操作：

```
 git fetch origin
 git checkout master
 git merge --ff origin/master 
```

我这样做有两个原因。首先是因为它允许我查看是否有远程更改，而无需从我的 devel 分支切换。其次，这是一种安全机制，可确保我不会覆盖任何未隐藏/提交的更改。另外，如果我不能快进到 master 分支，这意味着有人已经重新设置了远程 master 的基础（为此他们需要被严厉地鞭打），或者我不小心提交给 master 并且需要清理我的结束。

然后当远程发生变化并且我快速转发到最新的时，我将重新设置：

```
git checkout devel0
git rebase master
git push -f origin devel0 
```

然后其他开发人员知道他们需要从我的最新版本中重新定义他们的开发分支：

```
git fetch <remote>
git checkout devel1
git rebase <remote>/devel0 
```

这导致更清晰的历史：

```
o-----o                                 master
       \
         o-----o-----o                  devel0
                      \
                        o-----o-----o   devel1 
```

**不要**随心所欲地来回合并提交。它不仅会创建重复提交并使历史无法跟踪，而且几乎不可能从特定更改中找到回归（这就是您首先使用版本控制的原因，对吗？）。您遇到的问题是这样做的结果。

此外，听起来其他开发人员可能正在对您的开发分支进行提交。你能证实这一点吗？

合并的唯一时间是当您的主题分支准备好被`master`.

在旁注中。如果多个开发人员提交到同一个存储库，您都应该考虑使用命名分支来区分开发人员的开发分支。例如：

```
git branch 'my-name/devel-branch' 
```

因此，所有开发人员主题分支都位于他们自己的嵌套集中。

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2013-02-28T18:39:22.243

您需要强制推送，因为您已将提交进一步移到 git 期望您将提交添加到分支的尖端。`git push -f origin myNewFeature`将解决您的问题。

提示：以上是强制推送的合法用法。永远不要在可公开访问的存储库上重写历史，否则很多人会讨厌你。

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2013-02-28T18:52:20.740

这里要记住的主要事情是 pull 和 rebase 在幕后做了什么。

拉取基本上会做两件事：获取和合并。当您包含 --rebase 时，它​​将执行变基而不是合并。

变基非常类似于存储分支以来的所有本地更改，将分支快速转发到目标上的最新提交，然后按顺序取消存储更改。

（这解释了为什么在执行 rebase 时可能会收到多个冲突解决提示，而不是在合并时可能会收到一个冲突解决提示。您有机会解决正在 rebase 的每个提交的冲突，以便以其他方式保留您的提交。 )

您永远不想将重新设置的更改推送到远程分支，因为这是重写历史。Ofcoarse, never is a bit strong 因为几乎总是有例外。例如，您需要维护本地存储库的远程版本以在特定环境中工作的情况。

这将要求您有时使用强制推送重新调整的更改：

```
git push -f origin newfeature 
```

或者在某些情况下，您的管理员可能已删除强制功能，因此您必须删除并重新创建：

```
git push origin :newfeature
git push origin newfeature 
```

无论哪种情况，如果其他人在您的远程分支上与您合作，您必须绝对确定您知道自己在做什么。这可能意味着您最初与合并一起工作，并将它们重新设置为更易于管理的提交格式，然后再去掌握和删除您的工作分支。

请记住，您几乎总是可以通过以下优势回退到 git 的 GC：

```
git reflog 
```

这是一个巨大的救命稻草，因为如果您在所有变基/冲突管理中迷失方向，您可以重置回更稳定的状态。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-28T18:39:12.180

您需要执行强制推送，即`git push -f origin myNewFeature`

哦，你最好确保人们不会在你的开发分支上建立任何东西——通常你不应该发布你正在重写历史的分支（或者更确切地说，一旦发布就不要重写历史）。一种方法是使用分支名称`wip/myNewFeature`，然后提到`wip`分支将不时重新设置为 master。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-11-17T22:22:43.747

已经给出的一般答案——`git push -f origin myNewFeature`在推送重新调整的更改时使用——是一个很好的起点。我写这个答案是为了解决关于它是否会破坏你的工作流程的编辑。

如果我们假设您将使用`git pull --rebase ...`（或一些变体）然后强制推送到远程分支，那么在您的示例中破坏工作流的事情是 developer2 正在合并`myNewFeature`到`hisNewFeature`. 只要没有其他人在该分支上工作，就能够重新定位您自己的功能分支是有意义的，因此您需要规则来划分分支领域。

您可以通过 a) 建立一个只从 合并的规则`master`，或 b) 创建一个集体`develop`分支，您自己的分支基于该`myNewFeature`分支，并建立一个您只从 合并的规则`develop`。 `master`然后将仅保留用于里程碑或发布（或者您想要设置的其他内容），并且`develop`当您准备好将每个功能集成到其他功能分支中时，它将是您推送每个功能的地方。

我相信这可以被认为是 Gitflow 工作流程的简化版本。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-11-29T14:33:28.413

我同意[MrCholo](https://stackoverflow.com/users/5047085/mrcholo)的观点，也许[Trevor Norris](https://stackoverflow.com/users/591166/trevor-norris)可以考虑更新它的[好答案](https://stackoverflow.com/a/15144275/7351594)来替换

```
git push -f origin devel0 
```

和

```
git push --force-with-lease origin devel0 
```

# java - HTTP 请求在 Eclipse 中有效，但在编译的 JAR 包中失败

> ID：15143043
> 
> 赞同：1
> 
> 时间：2013-02-28T18:34:41.340
> 
> 标签：java, apache-httpclient-4.x

我正在使用 Apache HTTPclient 4 将 SPARQL 查询发送到远程存储库。虽然程序相同，但我的 JAR 包得到的响应是 HTTP 406，错误消息是“找不到可接受的文件格式”。在 Eclipse 中，我的查询成功接收 HTTP 200 响应和所需的结果。

什么可能导致具有相同代码的两个环境运行不同？

Eclipse 消息：（HTTP 200）

```
19:32:23.584 [main] DEBUG o.a.c.h.MultiThreadedHttpConnectionManager - HttpConnectionManager.getConnection:  config = HostConfiguration[host=http://asimov.ludat.lth.se], timeout = 0
19:32:23.585 [main] DEBUG o.a.c.h.MultiThreadedHttpConnectionManager - Allocating new connection, hostConfig=HostConfiguration[host=http://asimov.ludat.lth.se]
19:32:23.585 [main] DEBUG o.a.c.httpclient.HttpConnection - Open connection to asimov.ludat.lth.se:80
19:32:23.589 [main] DEBUG httpclient.wire.header - >> "POST /openrdf-sesame/repositories/KnowRob HTTP/1.1[\r][\n]"
19:32:23.590 [main] DEBUG o.a.c.httpclient.HttpMethodBase - Adding Host request header
19:32:23.593 [main] DEBUG httpclient.wire.header - >> "Content-Type: application/x-www-form-urlencoded; charset=utf-8[\r][\n]"
19:32:23.594 [main] DEBUG httpclient.wire.header - >> "Accept: application/x-binary-rdf-results-table[\r][\n]"
19:32:23.594 [main] DEBUG httpclient.wire.header - >> "Accept: application/sparql-results+xml;q=0.8[\r][\n]"
19:32:23.595 [main] DEBUG httpclient.wire.header - >> "Accept: application/xml;q=0.8[\r][\n]"
19:32:23.596 [main] DEBUG httpclient.wire.header - >> "Accept: text/tab-separated-values;q=0.8[\r][\n]"
19:32:23.596 [main] DEBUG httpclient.wire.header - >> "Accept: text/csv;q=0.8[\r][\n]"
19:32:23.597 [main] DEBUG httpclient.wire.header - >> "User-Agent: Jakarta Commons-HttpClient/3.1[\r][\n]"
19:32:23.597 [main] DEBUG httpclient.wire.header - >> "Host: asimov.ludat.lth.se[\r][\n]"
19:32:23.598 [main] DEBUG httpclient.wire.header - >> "Content-Length: 836[\r][\n]"
19:32:23.598 [main] DEBUG httpclient.wire.header - >> "[\r][\n]"
19:32:23.599 [main] DEBUG httpclient.wire.content - >> "quer[...]rue"
19:32:23.600 [main] DEBUG o.a.c.h.m.EntityEnclosingMethod - Request body sent
19:32:24.304 [main] DEBUG httpclient.wire.header - << "HTTP/1.1 200 OK[\r][\n]"
19:32:24.304 [main] DEBUG httpclient.wire.header - << "HTTP/1.1 200 OK[\r][\n]"
19:32:24.305 [main] DEBUG httpclient.wire.header - << "Server: Apache-Coyote/1.1[\r][\n]"
19:32:24.305 [main] DEBUG httpclient.wire.header - << "Vary: Accept[\r][\n]"
19:32:24.306 [main] DEBUG httpclient.wire.header - << "Content-Disposition: attachment; filename=query-result.brt[\r][\n]"
19:32:24.306 [main] DEBUG httpclient.wire.header - << "Content-Type: application/x-binary-rdf-results-table;charset=ISO-8859-1[\r][\n]"
19:32:24.306 [main] DEBUG httpclient.wire.header - << "Content-Language: en-US[\r][\n]"
19:32:24.307 [main] DEBUG httpclient.wire.header - << "Transfer-Encoding: chunked[\r][\n]"
19:32:24.307 [main] DEBUG httpclient.wire.header - << "Date: Thu, 28 Feb 2013 18:28:24 GMT[\r][\n]"
19:32:24.307 [main] DEBUG httpclient.wire.header - << "[\r][\n]"
19:32:24.308 [main] DEBUG org.openrdf.http.client.HTTPClient - reponse MIME type is application/x-binary-rdf-results-table 
```

JAR 消息：（HTTP 406）

```
19:15:35.178 [main] DEBUG o.a.c.h.MultiThreadedHttpConnectionManager - HttpConnectionManager.getConnection:  config = HostConfiguration[host=http://asimov.ludat.lth.se], timeout = 0
19:15:35.179 [main] DEBUG o.a.c.h.MultiThreadedHttpConnectionManager - Allocating new connection, hostConfig=HostConfiguration[host=http://asimov.ludat.lth.se]
19:15:35.179 [main] DEBUG o.a.c.httpclient.HttpConnection - Open connection to asimov.ludat.lth.se:80
19:15:35.183 [main] DEBUG httpclient.wire.header - >> "POST /openrdf-sesame/repositories/KnowRob HTTP/1.1[\r][\n]"
19:15:35.184 [main] DEBUG o.a.c.httpclient.HttpMethodBase - Adding Host request header
19:15:35.187 [main] DEBUG httpclient.wire.header - >> "Content-Type: application/x-www-form-urlencoded; charset=utf-8[\r][\n]"
19:15:35.188 [main] DEBUG httpclient.wire.header - >> "Accept: text/tab-separated-values;q=0.8[\r][\n]"
19:15:35.188 [main] DEBUG httpclient.wire.header - >> "Accept: text/csv;q=0.8[\r][\n]"
19:15:35.189 [main] DEBUG httpclient.wire.header - >> "User-Agent: Jakarta Commons-HttpClient/3.1[\r][\n]"
19:15:35.189 [main] DEBUG httpclient.wire.header - >> "Host: asimov.ludat.lth.se[\r][\n]"
19:15:35.189 [main] DEBUG httpclient.wire.header - >> "Content-Length: 836[\r][\n]"
19:15:35.190 [main] DEBUG httpclient.wire.header - >> "[\r][\n]"
19:15:35.191 [main] DEBUG httpclient.wire.content - >> "query[...]er=true"
19:15:35.191 [main] DEBUG o.a.c.h.m.EntityEnclosingMethod - Request body sent
19:15:35.717 [main] DEBUG httpclient.wire.header - << "HTTP/1.1 406 Not Acceptable[\r][\n]"
19:15:35.717 [main] DEBUG httpclient.wire.header - << "HTTP/1.1 406 Not Acceptable[\r][\n]"
19:15:35.718 [main] DEBUG httpclient.wire.header - << "Server: Apache-Coyote/1.1[\r][\n]"
19:15:35.718 [main] DEBUG httpclient.wire.header - << "Vary: Accept[\r][\n]"
19:15:35.718 [main] DEBUG httpclient.wire.header - << "Content-Type: text/plain;charset=UTF-8[\r][\n]"
19:15:35.719 [main] DEBUG httpclient.wire.header - << "Content-Language: en-US[\r][\n]"
19:15:35.719 [main] DEBUG httpclient.wire.header - << "Content-Length: 32[\r][\n]"
19:15:35.719 [main] DEBUG httpclient.wire.header - << "Date: Thu, 28 Feb 2013 18:11:35 GMT[\r][\n]"
19:15:35.720 [main] DEBUG httpclient.wire.header - << "[\r][\n]"
19:15:35.720 [main] DEBUG o.a.c.httpclient.HttpMethodBase - Buffering response body
19:15:35.720 [main] DEBUG httpclient.wire.content - << "No acceptable file format found."
19:15:35.721 [main] DEBUG o.a.c.httpclient.HttpMethodBase - Resorting to protocol version default close connection policy
19:15:35.721 [main] DEBUG o.a.c.httpclient.HttpMethodBase - Should NOT close connection, using HTTP/1.1
19:15:35.721 [main] DEBUG o.a.c.httpclient.HttpConnection - Releasing connection back to connection manager.
19:15:35.721 [main] DEBUG o.a.c.h.MultiThreadedHttpConnectionManager - Freeing connection, hostConfig=HostConfiguration[host=http://asimov.ludat.lth.se]
19:15:35.722 [main] DEBUG o.a.c.h.util.IdleConnectionHandler - Adding connection at: 1362075335721
19:15:35.722 [main] DEBUG o.a.c.h.MultiThreadedHttpConnectionManager - Notifying no-one, there are no waiting threads
19:15:35.722 [main] WARN  org.openrdf.http.client.HTTPClient - Server reports problem: No acceptable file format found. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T18:42:42.503

在第一种情况下，您的应用程序/环境将标头发送为

```
19:32:23.594 [main] DEBUG httpclient.wire.header - >> 
"Accept: application/x-binary-rdf-results-table[\r][\n]" 
```

但这在第二种情况下丢失了，因此您的第二种环境不能接受 type 的响应`'application/x-binary-rdf-results-table'`。你在哪里运行你的第二个查询？jar 部署在哪里？您可能需要将此编码/类型添加到您的应用服务器。

我不太清楚你在哪里使用它，但好的起点是看看为什么`"Accept: application/x-binary-rdf-results-table`在第二种情况下丢失。

# php - 如何将名为_（下划线）的对象访问到变量中

> ID：15143044
> 
> 赞同：0
> 
> 时间：2013-02-28T18:34:44.303
> 
> 标签：php

我有以下对象。在这种情况下，如何将 GrossAmount (1.10) 的值作为变量？

我试过了：

```
$gross = $object->GrossAmount->_; 
```

然而`$id = $object->GrossAmount->currencyID;`

是否给了我当前的英镑代码

但这行不通。

```
Array
(
    [TransactionID] => 9BBXH1113VA716445A
    [ParentTransactionID] => 
    [ReceiptID] => 
    [TransactionType] => express-checkout
    [PaymentType] => instant
    [PaymentDate] => 2013-02-28T18:26:43Z
    [GrossAmount] => stdClass Object
        (
            [_] => 1.10
            [currencyID] => GBP
        )

    [FeeAmount] => stdClass Object
        (
            [_] => 0.21
            [currencyID] => GBP
        )

    [TaxAmount] => stdClass Object
        (
            [_] => 0.00
            [currencyID] => GBP
        )

    [ExchangeRate] => 
    [PaymentStatus] => Completed
    [PendingReason] => none
    [ReasonCode] => none
) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T18:37:43.053

嗯，您的顶级对象是一个数组，而不是一个对象。因此，您应该使用`$object['GrossAmount']->_`来访问该字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T18:44:15.420

简单地做

```
$object->GrossAmount->{'_'} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-28T18:37:43.420

你可以试试

```
$gross = $object->GrossAmount->{"_"}; 
```

# android - 更改油漆颜色时，现有笔划也会更改

> ID：15143052
> 
> 赞同：4
> 
> 时间：2013-02-28T18:35:11.710
> 
> 标签：android, colors, paint

我正在使用下面的代码捕获绘图。为了更改笔触颜色或宽度，我正在调用该`setPaintAttribute()`方法。但是当我改变颜色时，整个绘图都会改变，包括我之前画的线条。我怎样才能改变油漆的颜色并且不改变以前的图纸？我试图创建一个新路径，但之前的绘图消失了。

```
public void setPaintAttributes(float STROKE_WIDTH, int color)
    {
        paint=new Paint();
        paint.setAntiAlias(true);
        paint.setColor(color);
        paint.setStyle(Paint.Style.STROKE);
        paint.setStrokeJoin(Paint.Join.ROUND);
        paint.setStrokeWidth(STROKE_WIDTH);
    }
 public boolean onTouchEvent(MotionEvent event) {
        scrollView.requestDisallowInterceptTouchEvent(true);
        btnSaveSignature.setEnabled(true);
        btnSaveSignature.setBackgroundResource(R.drawable.save);
        float eventX = event.getX();
        float eventY = event.getY();           

        switch (event.getAction()) {
        case MotionEvent.ACTION_DOWN:
            path.moveTo(eventX, eventY);
            lastTouchX = eventX;
            lastTouchY = eventY;
            return true;

        case MotionEvent.ACTION_MOVE:

        case MotionEvent.ACTION_UP:

            resetDirtyRect(eventX, eventY);
            int historySize = event.getHistorySize();
            for (int i = 0; i < historySize; i++) {
                float historicalX = event.getHistoricalX(i);
                float historicalY = event.getHistoricalY(i);
                path.lineTo(historicalX, historicalY);
            }
            path.lineTo(eventX, eventY);
            break;
        }

        invalidate((int) (dirtyRect.left - HALF_STROKE_WIDTH),
                (int) (dirtyRect.top - HALF_STROKE_WIDTH),
                (int) (dirtyRect.right + HALF_STROKE_WIDTH),
                (int) (dirtyRect.bottom + HALF_STROKE_WIDTH));

        lastTouchX = eventX;
        lastTouchY = eventY;

        return true;
    }

    private void resetDirtyRect(float eventX, float eventY) {
        dirtyRect.left = Math.min(lastTouchX, eventX);
        dirtyRect.right = Math.max(lastTouchX, eventX);
        dirtyRect.top = Math.min(lastTouchY, eventY);
        dirtyRect.bottom = Math.max(lastTouchY, eventY);
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-30T10:15:46.887

创建一个包含一对路径和绘画的arraylist，然后将每个路径添加到arraylist，它对我有用，

```
ArrayList<Pair<Path, Paint>> paths = new ArrayList<Pair<Path, Paint>>(); 
```

使用如下：

```
 mCanvas = new Canvas();
    mPath = new Path();
    Paint newPaint = new Paint(mPaint);
    paths.add(new Pair<Path, Paint>(mPath, newPaint)); 
```

# iframe - 使用 iframe 设置 div 的 innerHTML，显示在萤火虫中但不在页面上

> ID：15143054
> 
> 赞同：2
> 
> 时间：2013-02-28T18:35:14.327
> 
> 标签：iframe, extjs4, innerhtml

我正在使用 extjs 库。我有一个空白面板，我想用 iframe 将我的另一个 ext 项目加载到其中。这是我的功能（从按钮调用），“面板”是我的空白面板。

```
function(button){
    var div = document.getElementById('thepanel');
    div.innerHTML = "<iframe src=\"../../../project2/?&type=grades&gradeitem1=40691&\"></iframe>";
} 
```

当我运行该函数时，我可以在 firebug 的控制台中看到 GET 请求，当我在 firebug 中查看 HTML 但浏览器中没有显示任何新内容时，我的所有第二个项目代码/数据都显示在 iframe 中。任何可能阻止我的 iframe 内容显示的想法

我正在使用 MVC 架构，这是声明我的面板的代码：

```
items:[{
        xtype:'panel',
        itemId:'two',
        id:'thepanel',
        region:'center',
}] 
```

**更新**：我尝试将 iframe 移动到面板的 html 配置选项，而不是通过单击按钮通过 jquery 添加它。同样，我可以看到 iframe 中 url 的代码显示在 firebug 中，但我的应用程序中没有显示任何内容。这是声明我的面板的代码：

```
xtype:'panel',
itemId:'two',
id:'thepanel',
region:'center',
html:'<iframe src=\"../../../extjproh2/?&type=grades&gradeitem1=40691\"></iframe>',
height:400,
width:400, 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T20:12:00.647

最终使用了 sencha 论坛中的这个插件： [http ://www.sencha.com/forum/showthread.php?110311-iframePanel&p=943573#post943573](http://www.sencha.com/forum/showthread.php?110311-iframePanel&p=943573#post943573)

# c# - 写入和读取应用程序配置设置

> ID：15143057
> 
> 赞同：1
> 
> 时间：2013-02-28T18:35:21.010
> 
> 标签：c#

我有一个应用程序需要检查数据库是否存在特定代码；如果确实存在，则必须加载该代码的相应值，否则返回 null。

我不想为每个代码（运行大约 200.000 个代码）访问数据库。

所以我得到了这个小应用程序来测试 app.conf

```
public static void setAppSetting(string key, string value)
{
   Configuration config =  ConfigurationManager.OpenExeConfiguration(System.Reflection.Assembly.GetExecutingAssembly().Location);

   if (config.AppSettings.Settings != null)
   {            
      config.AppSettings.Settings.Remove(key);
   }

   config.AppSettings.Settings.Add(key, value);
   config.Save(ConfigurationSaveMode.Modified);
 }

public static string getAppSetting(string key)
{
   try
   {
      Configuration config = ConfigurationManager.OpenExeConfiguration(System.Reflection.Assembly.GetExecutingAssembly().Location);
      return config.AppSettings.Settings[key].ToString();
   }

   catch (Exception ex)
   {
      throw ex;
   }
}

private static void loadKeysValues()
{
   using (SqlConnection Gcon = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["constr"].ConnectionString))
   {
      //Open Connection
      Gcon.Open();
      using (SqlCommand sqlCmd = new SqlCommand("SELECT key,value FROM tables", Gcon))
      {
         using (SqlDataReader reader = sqlCmd.ExecuteReader())
         {
            if (reader.HasRows)
            {
               while (reader.Read())
               {
                  System.Console.WriteLine(reader.GetString(0) + " , " + reader.GetString(1));
                  setAppSetting(reader.GetString(0), reader.GetString(1));
               }
            }
         } // End of SqlDataReader

      } // end of SqlCommand
    }
  }

static void Main(string[] args)
{
   System.Console.WriteLine("Loading.........");
   loadKeysValues();
   System.Console.WriteLine("Completed");
   System.Console.WriteLine("Input a key to get its value");
   var input = System.Console.Read().ToString();
   System.Console.WriteLine(getAppSetting(input));
   System.Console.ReadLine();
} 
```

但是我在这一行遇到了 getAppSetting() 错误：

```
return config.AppSettings.Settings[key].ToString(); 
```

错误：对象引用未设置为对象的实例。

请帮忙

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T19:08:10.377

确保该值不为空。尝试这个：

```
if (config.AppSettings.Settings.ContainsKey(key) && 
    config.AppSettings.Settings[key] != null)
{
    return config.AppSettings.Settings[key].ToString();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T18:41:03.090

您很可能正在尝试访问不存在的设置。您可以在 catch 块中处理该异常并在这种情况下返回 null。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-14T14:54:42.323

ToString() 方法不返回值，尝试使用 Value 属性：

```
return config.AppSettings.Settings[key].Value; 
```

# java - Android：布尔值不正确 - 奇怪

> ID：15143065
> 
> 赞同：1
> 
> 时间：2013-02-28T18:35:56.027
> 
> 标签：java, android, bitmap, boolean, surfaceview

我正在构建一个surfaceView 类来显示来自相机的图像。我花了一段时间才让它工作，但我添加了一些 toasts、对话框和一些布尔变量来在 AnnotateSurface 类和 Activity 类中调试它。如果它是真的，我在 if 语句中使用其中一个来运行线程以将图像绘制到表面（这就是阻止它工作的原因）。

```
if(bitmapState){

     drawSomething(canvas);
} 
```

我已经让它工作了，但只有在我发现布尔值 bitmapState 被重置为 false 之后。它被初始化为 false，但我在 getBitmap 方法中将其更改为 true。这是编辑该布尔变量的唯一方法。

setBitmap 方法中的 toast 显示“true”，但是当我从 Activity 类调用 getStuff 方法时，它显示为 false，并且当我使用以下命令时，run 方法中的 if 语句也不起作用：

```
if (surfaceState == bitmapState == true) {

    drawSomething(canvas);
} 
```

这真的很令人困惑，因为所有其他布尔值都表现正确。如果有人有任何见解，我很想听听。

```
public class AnnotateSurface extends SurfaceView implements Callback, Runnable {

    // create a holder to manage the surface of the view
    SurfaceHolder ourHolder;

    // Create a thread
    Thread ourThread = null;

    // Create a boolean to determine when to stop the animation
    boolean isRunning = false;
    boolean surfaceState = false;
    boolean bitmapState = false;

    public static Bitmap bmpIm = null;

    Context c;

    Canvas canvas;

    int ws, hs;

    public AnnotateSurface(Context context) {...
    }

    public AnnotateSurface(Context context, AttributeSet attrs) {...
    }

    public AnnotateSurface(Context context, AttributeSet attrs, int defStyle) {...
    }

    // create a method to pause the thread
    public void pause() {...

    }

    public void resume() {...
    }

    // create a method to resume the thread
    public void setBitmap(Bitmap b) {

        bmpIm = b;

        // bmpIm = AnnotateImage.bmpAnnotate;
        // isRunning = true;

        bitmapState = true;

        Toast toast = new Toast(c);

        Toast.makeText(c, Boolean.toString(bitmapState), Toast.LENGTH_LONG)
                .show();

    }

    @Override
    public void surfaceChanged(SurfaceHolder holder, int format, int width,
            int height) {...
    }

    @Override
    public void surfaceCreated(SurfaceHolder holder) {...
    }

    @Override
    public void surfaceDestroyed(SurfaceHolder holder) {
        // TODO Auto-generated method stub
        surfaceState = false;
    }

    // @Override
    public void drawSomething(Canvas canvas) {...
    }

    public String getstuff() {

        String Data = "not drawing" + Boolean.toString(this.bitmapState)
                + Boolean.toString(surfaceState) + Boolean.toString(isRunning)
                + Integer.toString(ws) + Integer.toString(hs);

        return Data;

    }

    public Bitmap getstuffImage() {...
    }

    @Override
    public void run() {...
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T18:47:07.930

过去我遇到过布尔值和“if”语句的问题，处理它的最好方法是更明确地处理它们，例如：

```
if (surfaceState == bitmapState && bitmapState == true) {
drawSomething(canvas);
} 
```

干杯!
麦克风

# java - 读取文件时出错？

> ID：15143066
> 
> 赞同：0
> 
> 时间：2013-02-28T18:36:04.653
> 
> 标签：java, file

我正在为java开发一个项目，我希望编译器区分数字和单词，但是当我按原样尝试代码时，由于字符串为-1，它会返回错误。另外，如何将我正在读入的数字变成图表中的 * 符号？任何帮助将不胜感激

奥维尔的英亩，114.8 43801

霍夫曼山，77.2 36229

快速快速农场，89.4 24812

Jolly Good 种植园，183.2 104570

Organically Grown Inc., 45.5 14683（我正在阅读的内容）

```
import java.io.BufferedReader;
import java.io.FileReader;
import java.io.IOException;
import java.util.Scanner;
import javax.swing.*; 
import java.io.*;
public class Popcorn { 

  public static void main (String [] args) throws IOException { 

            JFileChooser chooser = new JFileChooser();
            chooser.showOpenDialog(null);
            File f = chooser.getSelectedFile();
            String filename = f.getName();

            Scanner infile = new Scanner(new FileReader( filename)); 
            String line = "" ; 
            while (infile.hasNextLine())
            {  line= infile.nextLine(); 

             // int endingIndex =line.indexOf(','); 
            //String fromName = line.substring(0, endingIndex);

              System.out.println(line);}
    infile.close(); 
 }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T18:39:03.920

用来`Integer.parseInt()`知道它是否是一个数字。有一个`catch`异常块，如果它出现在 catch 块中，你就会知道它不是数字

# swagger - 使用 source2swagger 的静态 API 文档

> ID：15143068
> 
> 赞同：0
> 
> 时间：2013-02-28T18:36:11.140
> 
> 标签：swagger, api-doc

source2swagger 在一个 json 文件中生成一个包含所有 api 的 swagger 规范。swagger-ui 真的可以使用它吗？当我使用 swagger-ui 探索生成的 json 文件时，它会尝试从规范中的路径读取 api 描述，而不是使用单个 json 文件中的描述/操作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T15:40:11.113

Swagger-UI 将处理将所有 json 放在一个文件中。我还不确定是否可以有多个顶级资源列表。

这是一个工作示例：

```
{"basePath":"http://localhost:3001/", "resourcePath":"/", "swaggerVersion":"1.1", "apiVersion":"1.0", "apis":[
    {
        "path":"/pay",
        "format":"json",
        "description":"Create a transaction with the given amount and token.",
        "operations":[
            {
                "httpMethod":"GET",
                "tags":["production"],
                "nickname":"pay",
                "deprecated":false,
                "summary":"Create a transaction with the given amount and token.",
                "parameters":[
                    {
                        "name":"token",
                        "description":"The token representing the pay card",
                        "dataType":"string",
                        "allowMultiple":false,
                        "required":true,
                        "paramType":"query"
                    },
                    {
                        "name":"amount",
                        "description":"The amount to pay",
                        "dataType":"string",
                        "allowMultiple":false,
                        "required":true,
                        "paramType":"query"
                    }
                ]
            }
        ]
    },
    {
        "path":"/customer",
        "format":"json",
        "description":"Create an HTML form for adding a customer.",
        "operations":[
            {
                "httpMethod":"GET",
                "tags":["production"],
                "nickname":"createCustomerForm",
                "deprecated":false,
                "summary":"Create an HTML form for adding a customer.",
                "parameters":[
                    {
                        "name":"customerId",
                        "description":"Your customer id",
                        "dataType":"string",
                        "allowMultiple":false,
                        "required":true,
                        "paramType":"query"
                    }
                ]
            }
        ]
    },
    {
        "path":"/customer/{customerId}",
        "format":"json",
        "description":"Delete the customer info for given id.",
        "operations":[
            {
                "httpMethod":"DELETE",
                "tags":["production"],
                "nickname":"deleteCustomer",
                "deprecated":false,
                "summary":"Delete the customer info for given id.",
                "parameters":[
                    {
                        "name":"customerId",
                        "description":"the customer id to delete",
                        "dataType":"string",
                        "allowMultiple":false,
                        "required":true,
                        "paramType":"path"
                    }
                ]
            }
        ]
    },
    {
        "path":"/card",
        "format":"json",
        "description":"Create an HTML form for adding a credit card.",
        "operations":[
            {
                "httpMethod":"GET",
                "tags":["production"],
                "nickname":"createCardForm",
                "deprecated":false,
                "summary":"Create an HTML form for the given customer to add a credit card.",
                "parameters":[
                    {
                        "name":"customerId",
                        "description":"Your customer id",
                        "dataType":"string",
                        "allowMultiple":false,
                        "required":true,
                        "paramType":"query"
                    }
                ]
            }
        ]
    },
    {
        "path":"/card/{token}",
        "format":"json",
        "description":"Delete a card record by token.",
        "operations":[
            {
                "httpMethod":"DELETE",
                "tags":["production"],
                "nickname":"deleteCard",
                "deprecated":false,
                "summary":"Delete the card info for given token.",
                "parameters":[
                    {
                        "name":"token",
                        "description":"the token to delete",
                        "dataType":"string",
                        "allowMultiple":false,
                        "required":true,
                        "paramType":"path"
                    }
                ]
            }
        ]
    }
]} 
```

# javascript - 写jQuery插件比写javascript函数好？

> ID：15143075
> 
> 赞同：-1
> 
> 时间：2013-02-28T18:36:35.120
> 
> 标签：javascript, jquery, jquery-ui, jquery-plugins

有人可以解释下面的利弊。

我有一个函数来获取 url 查询字符串参数，但我需要知道哪个是编写函数的最佳方法。例如：如果我使用 jquery 插件样式创建函数，那么每次我需要使用目标元素来访问函数，如下所示

```
$("#targetDom").getQueryString("name"); 
```

但是，如果我使用 javascript 类或 javascript 设计模式创建函数，它将是

```
getQueryString("name"); 
```

这是一个小例子，但考虑到大型应用程序，哪种方法最好？使用 jquery 插件方式有什么缺点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T18:40:11.263

答案将取决于你问谁。

我的回答是，如果您已经在页面上使用 jQuery（这意味着利用 jQuery 不需要您导入额外的资源），那么请继续使用 jQuery 来编写您的扩展。jQuery 进行内部 chaching，*我相信*在某些情况下，这实际上可以让您的代码比使用原生 JavaScript 更快。

如果您还没有使用 jQuery，那么在您的特定任务中使用 vanilla JavaScript 并不足以成为需要（甚至建议您可能想要使用）jQuery 的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T18:40:52.683

*您不必*为每个功能都创建一个 jQuery 函数，特别是*如果您不打算处理 DOM*，这似乎是您的情况。

* * *

但是，您可能希望将这些函数分组到您自己的应用程序的一个小型库中，这样也可以在其他应用程序中重用。

例如：

```
var utils = {
    getQueryString : function(name){}
}; 
```

并像这样访问它...

```
utils.getQueryString("name"); 
```

* * *

> 例如：如果我使用 jquery 插件样式创建函数，那么每次我需要使用目标元素来访问函数，如下所示

不，你没有。您也可以像这样运行该函数`$.fn.getQueryString("name");`。

# sql - 加入状态历史

> ID：15143085
> 
> 赞同：0
> 
> 时间：2013-02-28T18:37:07.890
> 
> 标签：sql

我有一张表格，列出了遇到的患者天数。下面是一次相遇的样本。患者在医院的每一天，都会在午夜创建一个记录，直到出院。

```
Enc_iD  Day_Id      ServiceDtTm        AdmitDate
2616350 34707672    2/21/2013 23:59    21/FEB/13 12:19:00
2616350 34733898    2/22/2013 23:59    21/FEB/13 12:19:00
2616350 34748155    2/23/2013 23:59    21/FEB/13 12:19:00
2616350 34760403    2/24/2013 23:59    21/FEB/13 12:19:00
2616350 34784357    2/25/2013 23:59    21/FEB/13 12:19:00
2616350 34808228    2/26/2013 23:59    21/FEB/13 12:19:00
2616350 34814512    2/27/2013 10:10    21/FEB/13 12:19:00 
```

在单独的表格中，用户不定期地维护每次遭遇的状态。

```
Enc_iD  TransDtTm       Status
2616350 2/21/2013 12:20 
2616350 2/21/2013 13:29 1
2616350 2/22/2013 7:28  3
2616350 2/25/2013 13:44 2
2616350 2/27/2013 10:10 2 
```

我想用 SQL 创建一个结果集，如下所示。因此，对于顶部表中的每一天，该状态都是最新的`ServiceDtTm`。

```
Enc_iD  Day_Id      DtTime             AdmitDate            Status
2616350 34707672    2/21/2013 23:59    21/FEB/13 12:19:00   1
2616350 34733898    2/22/2013 23:59    21/FEB/13 12:19:00   3
2616350 34748155    2/23/2013 23:59    21/FEB/13 12:19:00   3
2616350 34760403    2/24/2013 23:59    21/FEB/13 12:19:00   3
2616350 34784357    2/25/2013 23:59    21/FEB/13 12:19:00   2
2616350 34808228    2/26/2013 23:59    21/FEB/13 12:19:00   2
2616350 34814512    2/27/2013 10:10    21/FEB/13 12:19:00   2 
```

任何帮助表示赞赏。无法弄清楚这个SQL。仅在 excel 中使用具有近似匹配的 vlookup。

罗伯特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T18:42:43.343

我认为最简单的解决方案是相关子查询。下面是 SQL Server 中的语法：

```
select pd.*,
       (select top  1  status
        from status s 
        where s.enc_id = pd.enc_id and s.transdttm <= pd.servicedttm
        order by s.transdttm
       ) as MostRecentStatus
from patientdays pd 
```

对于大多数其他数据库，它看起来像：

```
select pd.*,
       (select status
        from status s 
        where s.enc_id = pd.enc_id and s.transdttm <= pd.servicedttm
        order by s.transdttm
        limit 1
       ) as MostRecentStatus
from patientdays pd 
```

# java - 正则表达式处理某些字符的大小写

> ID：15143088
> 
> 赞同：0
> 
> 时间：2013-02-28T18:37:16.713
> 
> 标签：java

```
public class BioHomework {
  public static void main(String[] args) {
    if(args.length < 2) {
       throw new IllegalArgumentException("two args required");
    }
    String sequence = args[1];
    if (!sequence.toLowerCase().matches("[atgc]{10,20}")){
      throw new IllegalArgumentException("second arg should be 'atgc' string between 10 and 20 characters");
    }
    if ("u".equals(args[0])) {
      System.out.println(sequence.toUpperCase());
    } else if ("l".equals(args[0])) {
      System.out.println(sequence.toLowerCase());
    } else {
      throw new IllegalArgumentException("first argument must be either 'u' or 'l'");
    }

  }
} 
```

如何通过提供命令行参数以大写和小写形式打印 dna 序列。上面的代码只给我消息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T18:48:09.323

只需更改正则表达式以接受大写或小写字符。从

```
[atgc]{10,20} 
```

至

```
[aAtTgGcC]{10,20} 
```

# android - 是否可以显示操作栏后退按钮而不是向上按钮？

> ID：15143101
> 
> 赞同：0
> 
> 时间：2013-02-28T18:37:50.900
> 
> 标签：android, android-actionbar

我的应用程序中有一个 UI 子流程，我想在操作栏上提供前进和后退导航控件。请注意，我说的是向后导航，而不是“向上”。

我知道 Android 中的向上导航按钮功能。在我的 UI 的这一部分中，我想用后退按钮（和它的图标）替换向上按钮。

我的问题是，如何覆盖向上按钮的 UI 以显示后退按钮？

注意我在这里谈论的是 UI。导航行为很容易实现。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T19:02:57.013

您听说过 ActionBarSherlock (ABS) 吗？我问的原因是，ABS 非常接近原生实现，一旦你下载了源代码，你会发现很多有趣的东西。搜索主页按钮（在*可绘制*文件夹中）显示该图标名为`abs__ic_ab_back_holo_light.png`。

搜索该名称会`<homeAsUpIndicator>@drawable/abs__ic_ab_back_holo_light<homeAsUpIndicator>`导致`Theme.Sherlock.Light`. 那么这是什么意思呢？对于 ABS，您可以派生一个新主题并使用您自己的可绘制对象覆盖*homeAsUpIndicator标记。*

那么原生 Android 方案呢？很可能只是要覆盖的相同标签。如果您不使用从标准主题派生的 ABS。

示例：在这里我重新定义了向上指标（使用 ABS）

> ```
> <style name="MyAppStyle" parent="@style/Theme.Sherlock.Light">
>     <item name="homeAsUpIndicator">@drawable/new_indicator</item>
>     <item name="android:homeAsUpIndicator">@drawable/new_indicator</item> 
> ```

希望有帮助！干杯……

# css - JavaFX FadeTransition 与 CSS -fx-opacity 冲突

> ID：15143105
> 
> 赞同：1
> 
> 时间：2013-02-28T18:38:01.430
> 
> 标签：css, animation, javafx-2, fadein, conflict

我在 JavaFX 中使用一个按钮构建了一个自定义复合 UI 控件，如果将鼠标悬停在控件上的某个位置，它应该从 0 淡入到 0.1 不透明度。如果将鼠标悬停在按钮本身上，不透明度应更改为 1.0，这可以通过 CSS 轻松实现。

这里是 FadeTransition：

```
// unfortunately, animations cannot be defined in CSS yet
FadeTransition fadeInButton =
    new FadeTransition(Duration.millis(300), settingsButton);
fadeInButton.setFromValue(0);
fadeInButton.setToValue(0.1); 
```

这里是按钮的 CSS：

```
.settings-button {
    -fx-background-image: url("settings_32_inactive.png");
    -fx-background-repeat: no-repeat;   
    -fx-background-position: center center;
    -fx-opacity: 0; /* button shall be initially invisible, will be faded in */
}

.settings-button:hover {
    -fx-background-image: url("settings_32.png");
    -fx-opacity: 1.0; /* why is this ignored if used together with animations? */
} 
```

动画和 CSS 属性分别很好地工作。不幸的是，结合起来，动画似乎覆盖了 CSS 文件中的 -fx-opacity 属性。任何想法如何使动画和 CSS 属性一起工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T13:18:13.320

没有办法让 css over API 调用，请参阅下一个主题：[JavaFX：无法在 CSS 设置字体后以编程方式设置字体大小](https://stackoverflow.com/questions/12333985/javafx-can-not-set-font-size-programmatically-after-font-being-set-by-css/12334881#12334881)

但是你可以做下一个技巧：

*   不透明度为 0.1 的按钮未悬停，悬停时为 1
*   将按钮放入窗格并将此窗格从 0 设置为 1

请参阅下一个 css：

```
/*Button*/
.b1 { -fx-opacity: 0.1; }
.b1:hover { -fx-opacity: 1.0; }
/*Pane*/
.p1 {
    -fx-border-color: red;
    -fx-opacity: 0;
} 
```

和代码：

```
public class OpacityCss extends Application {

    private static final Duration DURATION = Duration.millis(300);

    @Override
    public void start(Stage primaryStage) {
        Pane pane = new Pane();
        pane.getStyleClass().add("p1");
        pane.setMinSize(100, 100);
        pane.setMaxSize(100, 100);

        final Button btn = new Button("Fading Button");
        btn.getStyleClass().add("b1");
        pane.getChildren().add(btn);

        final FadeTransition fade = new FadeTransition(DURATION, pane);
        fade.setAutoReverse(true);
        fade.setFromValue(0);
        fade.setToValue(1);

        pane.setOnMouseEntered(new EventHandler<MouseEvent>() {
            @Override
            public void handle(MouseEvent t) {
                fade.setCycleCount(1); // this way autoreverse wouldn't kick
                fade.playFromStart();
            }
        });

        pane.setOnMouseExited(new EventHandler<MouseEvent>() {
            @Override
            public void handle(MouseEvent t) {
                fade.setCycleCount(2); // starting from autoreverse
                fade.playFrom(DURATION);
            }
        });

        StackPane root = new StackPane();
        root.getChildren().addAll(pane);
        Scene scene = new Scene(root, 300, 250);
        scene.getStylesheets().add(getClass().getResource("/css/btn.css").toExternalForm());
        primaryStage.setScene(scene);
        primaryStage.show();
    }

    public static void main(String[] args) { launch(); }
} 
```

# c# - HttpClient HttpRequestException

> ID：15143107
> 
> 赞同：7
> 
> 时间：2013-02-28T18:38:05.247
> 
> 标签：c#, httpclient

我有问题`HttpClient`，我一直在`HttpRequestException occurred in mscorlib.dll`。我已经从 SVN 下载了以前的工作版本，并且一直收到相同的异常。

为什么我会突然得到这个异常，即使我运行的代码已经运行了好几个星期？

现在我正在尝试使用这个简单的代码进行调试，但是无论我做什么都会遇到同样的异常

```
HttpClient client = new HttpClient();
client.DefaultRequestHeaders.Accept
    .Add(new System.Net.Http.Headers.MediaTypeWithQualityHeaderValue(
              "application/json"));
HttpResponseMessage response
    = await client.GetAsync("http://api.themoviedb.org/3/movie/550?api_key=x");
return await response.Content.ReadAsStringAsync(); 
```

我的 innerException 如下：

```
The remote name could not be resolved: 
    api.themoviedb.org System.Exception System.Net.WebException 
```

我尝试的每个网址都得到相同的结果，它们都在我的浏览器中工作。这是异常和堆栈跟踪：

```
res "System.Net.Http.HttpRequestException: An error occurred while sending the request. 
---> System.Net.WebException: The remote name could not be resolved: 'api.themoviedb.org'
at System.Net.HttpWebRequest.EndGetResponse(IAsyncResult asyncResult)
at System.Net.Http.HttpClientHandler.GetResponseCallback(IAsyncResult ar)
--- End of inner exception stack trace ---
at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotificat‌​ion(Task task) 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-28T19:36:02.663

这是您网络上的 DNS 问题。您的工作站（或出现错误的服务器）无法解析 DNS 名称“api.themoviedb.org”。这个 DNS 名称可以很好地从我的计算机和[其他在线网络](http://www.kloth.net/services/nslookup.php)解析。

请咨询您的本地网络管理员。

**更新**

因此，您的机器可以解析名称，但 HttpClient 不能。让我们看看我们是否可以解决这个问题。我假设这是一个桌面应用程序，而不是一个网站。如果我错了，请告诉我——还有一些额外的注意事项。

您将必须按照本指南启用网络跟踪：[如何：配置网络跟踪](http://msdn.microsoft.com/en-us/library/ty48b824.aspx)。您希望按照该链接中的指定配置您的 App.config 文件。简而言之，您应该在配置文件中添加如下内容：

```
<configuration>
    <system.diagnostics>
        <sources>
            <source name="System.Net" tracemode="includehex" maxdatasize="1024">
                <listeners>
                    <add name="System.Net"/>
                </listeners>
            </source>
        </sources>
        <switches>
            <add name="System.Net" value="Verbose"/>
        </switches>
        <sharedListeners>
            <add name="System.Net"
                type="System.Diagnostics.TextWriterTraceListener"
                initializeData="network.log" />
        </sharedListeners>
        <trace autoflush="true"/>
    </system.diagnostics>
</configuration> 
```

该值`network.log`应根据您的需要进行更改。继续执行此操作，然后查看输出文件。

现在，诀窍是使用该文件来找出问题所在。有关如何解释该文件的提示，请参阅[解释网络跟踪，尽管信息很少。](http://msdn.microsoft.com/en-us/library/46fcs6sz.aspx)我们正在寻找的是无法解析 DNS 的原因。因此，在该文件中搜索“api.themoviedb.org”。如果您愿意，请使用结果更新问题，我会看看是否可以从那里帮助您。

# python - Python 在并发运行时只有一个对象的字典实例

> ID：15143110
> 
> 赞同：-1
> 
> 时间：2013-02-28T18:38:17.710
> 
> 标签：python, multithreading

使用 threading 和 Queue 库运行线程时，我在线程 run() 函数中创建一个对象。假设课程是这样启动的：

```
class Test():
    def __init__(self, dictionary={}):
        self.dict = dictionary 
```

当我尝试在不同的线程中访问字典时，Python 似乎只创建了一个字典实例。这是线程类。我开始了其中的两个：

```
class ThreadTest(threading.Thread):
    def run(self):
        while True:
            // interact with Queue items
            obj = Test()
            print "%s - %s" % (self.name, id(obj.dict))
            queue.task_done() 
```

和输出：

```
Thread-1 - 19219616
Thread-2 - 19219616 
```

这真的很令人困惑，因为 Test 类被创建了两次，但它共享同一个字典。

在这种情况下，有没有办法创建一个新的字典实例？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T18:40:11.827

默认参数仅在`def`遇到该行时评估一次。因此，您的默认参数`dictionary={}`在所有实例之间共享。

改为使用`dictionary=None`，并且

```
if dictionary is None:
    self.dict = {}
else:
    self.dict = dictionary 
```

每次创建一个新实例。

# unit-testing - Grails Spock 单元测试在本地通过但在 CI 环境中失败

> ID：15143118
> 
> 赞同：1
> 
> 时间：2013-02-28T18:38:30.663
> 
> 标签：unit-testing, grails, grails-2.0, grails-domain-class, spock

我有一组基于 Spock 的单元测试，它们在本地通过，但在我的 CI (Jenkins) 服务器上记录了以下两个异常而失败。有些测试在这两个例外情况下都失败了，但有些测试只在第一个例外情况下失败。

所有测试都失败，但出现以下异常：

```
Account field name is nullable using null(com.vsnap.site.entities.account.organization.OrganizationSpec)
|
java.lang.IllegalStateException: Already value [org.grails.datastore.mapping.transactions.SessionHolder@7f5083c7] for key [org.grails.datastore.mapping.simple.SimpleMapDatastore@62987889] bound to thread [main]
at org.grails.datastore.mapping.core.DatastoreUtils.bindSession(DatastoreUtils.java:337)
at grails.test.mixin.domain.DomainClassUnitTestMixin.connectDatastore(DomainClassUnitTestMixin.groovy:108)
at org.spockframework.util.ReflectionUtil.invokeMethod(ReflectionUtil.java:138)
at org.spockframework.runtime.extension.builtin.JUnitFixtureMethodsExtension$FixtureType$FixtureMethodInterceptor.intercept(JUnitFixtureMethodsExtension.java:145)
at org.spockframework.runtime.extension.MethodInvocation.proceed(MethodInvocation.java:84)
at org.spockframework.util.ReflectionUtil.invokeMethod(ReflectionUtil.java:138)
at org.spockframework.util.ReflectionUtil.invokeMethod(ReflectionUtil.java:138)
at org.spockframework.util.ReflectionUtil.invokeMethod(ReflectionUtil.java:138) 
```

除了第一个之外，有些失败了：

```
java.lang.NullPointerException: Cannot invoke method isActive() on null object
at grails.test.mixin.support.GrailsUnitTestMixin.shutdownApplicationContext(GrailsUnitTestMixin.groovy:232)
at org.spockframework.util.ReflectionUtil.invokeMethod(ReflectionUtil.java:138)
at org.spockframework.runtime.extension.builtin.JUnitFixtureMethodsExtension$FixtureType$FixtureMethodInterceptor.intercept(JUnitFixtureMethodsExtension.java:145)
at org.spockframework.runtime.extension.MethodInvocation.proceed(MethodInvocation.java:84)
at org.spockframework.util.ReflectionUtil.invokeMethod(ReflectionUtil.java:138) 
```

在这些单元测试中，我所做的只是测试域对象的约束：

```
@TestFor(User)
class UserSpec extends Specification {
    def "test user field constraints"() {
        when:
        def user = new User(name: name)

        then:
        user.errors['name'] == error

        where:
        error      | name
        'blank'    | ''
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-03-25T04:37:06.133

只要我在上面留下评论，我就发现堆栈跟踪实际上是在试图告诉我一些有用的东西:) 问题是在我的情况下，IntelliJ 正在拉入同一个库，并且两个实例都在向侦听器注册自己。 ...在我的情况下，Maven 正在拉入 grails-testing-plugin 并且 IntelliJ 有 grails 文件夹，其中包含依赖树（模块设置）上的相同 jar。删除其中一个可以解决问题....现在转到下一个:)

# vb.net - 在 VB.NET 中打开 Crystal Report Viewer

> ID：15143121
> 
> 赞同：0
> 
> 时间：2013-02-28T18:38:40.957
> 
> 标签：vb.net, visual-studio-2012, crystal-reports

我有一个想要从 VB.net 表单打开的 Crystal Report。唯一的问题是我很难找到如何从 VB.net 打开 Crystal Report Viewer。我正在使用 Visual Studio 2012，并且我有 Crystal Reports 的更新，可以在 Visual Studio 2012 中使用它。如果有人有任何建议，将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T16:15:30.213

答案是按照此处列出的步骤[在 Visual Studio 2010 中使用 Crystal Reports Viewer](https://stackoverflow.com/questions/4533291/crystal-reports-viewer-in-visual-studio-2010) 唯一的区别是，您无需转到项目设计器中的编译选项卡，而是转到应用程序选项卡

# sql-server - 密码保护 SQL 数据库文件

> ID：15143123
> 
> 赞同：-2
> 
> 时间：2013-02-28T18:38:48.277
> 
> 标签：sql-server

我在 Visual Studio 中为我的 ASP.NET MVC 3 项目创建了一个 SQL 数据库文件。如何使用密码保护我的 SQL 数据库文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T19:29:19.657

如果您的主机有任何大脑，黑客就无法访问文件本身。

即使他们可以，他们也需要一些方法来关闭 SQL Server，以便他们可以直接获取文件。

你需要关心的是：

*   为您的 Web 应用程序用户设置一个非常强大的密码，
*   给予网络用户极其有限的权利（最小特权原则），
*   确保主机将数据库放置在不受外界影响的单独服务器上，以及
*   确保您的应用程序不会懒惰地防止 SQL 注入（例如，使用参数化语句）。

# ios - 如何在字典中获得具有相同键的特定 objectForKey？

> ID：15143125
> 
> 赞同：-1
> 
> 时间：2013-02-28T18:39:00.287
> 
> 标签：ios, objective-c, nsdictionary

我从一个 url 得到一个 JSON，但它重复具有相同的“密钥”。

这是 JSON ->[链接](http://maps.googleapis.com/maps/api/geocode/json?latlng=37.785834,-122.406417&sensor=true)

我将所有数据传递给 NSDictionary 并选择我想要的特定节点，即“long_name”：

```
[[[allDataDictionary objectForKey:@"results"]valueForKey:@"address_components"]valueForKey:@"long_name"] 
```

结果：

> （1，“斯托克顿街”，市中心，“S\U00e3o Francisco”，“旧金山”，“旧金山”，“Calif\U00f3rnia”，“Estados Unidos”，94108）

我想要第五个元素。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T18:44:36.693

我找到了解决方案，我必须使用 NSMutableDictionary：

这有点复杂，但有效

```
[[[[[allDataDictionary objectForKey:@"results"]valueForKey:@"address_components"]valueForKey:@"long_name"]objectAtIndex:0]objectAtIndex:5] 
```

答案是：旧金山

谢谢。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T18:45:16.647

这是一个 JSON 数组，因此您可以使用 objectAtIndex 访问每个元素：

```
id obj1= [json objectAtIndex: i]; 
```

If you use a newer compiler it's the equivalent of this:

```
id obj1= json[i]; 
```

# google-chrome - ExtJs 4.1 和 Chrome 25 的布局损坏

> ID：15143129
> 
> 赞同：2
> 
> 时间：2013-02-28T18:39:22.467
> 
> 标签：google-chrome, layout, extjs

我在 sencha 论坛上将此作为错误发布，但我认为在堆栈溢出时将其删除可能是有利的：

[http://www.sencha.com/forum/showthread.php?257622-Serious-layout-Issue-with-ExtJs-4.1-and-Chrome-25&p=943170#post943170](http://www.sencha.com/forum/showthread.php?257622-Serious-layout-Issue-with-ExtJs-4.1-and-Chrome-25&p=943170#post943170)

在这里可以看到它的屏幕截图：

[http://www.sencha.com/forum/showthread.php?257508-Strange-behaviors-in-Chrome-25-with-Ext-4.1](http://www.sencha.com/forum/showthread.php?257508-Strange-behaviors-in-Chrome-25-with-Ext-4.1)

**基本上**，使用 ExtJs 4.1，在升级到 Chrome 25 后，我们的用户偶尔会在我们的应用程序中看到布局失败。

通常会注意到窗口“关闭”按钮偏斜出现在窗口的左侧而不是右侧，并且所有表单字段都垂直显示。一旦发生，随后渲染的每个组件都将一团糟。

恢复到 chrome 24 或使用 Firefox 会使问题消失。运行 Chrome Frame 25 时，该问题出现在 IE 中。

我们已经禁用了自定义 CSS，但问题仍然存在。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T14:35:20.380

Amphro 的回答确实解决了这个问题，但并没有完全根除它。

**我找到的唯一真正的解决方案是升级到 ExtJs 4.2。**

我仍然可以在 Chrome 26 中复制 ExtJs 4.1.2 的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T17:48:11.240

我们的 Ext 应用程序遇到了类似的问题。我们最终将其缩小到面板高度和宽度的浮动数字。例如，如果您有任何类似 的代码，请将其`panel.setWidth(v1 / v2)`更改为`panel.setWidth(Math.round(v1 / v2))`. 希望有帮助。

# javascript - 使用 Ember.js 时的模型代码重复

> ID：15143134
> 
> 赞同：2
> 
> 时间：2013-02-28T18:39:44.767
> 
> 标签：javascript, ember.js, ember-data

我正在考虑为我的 Sinatra 应用程序之一切换到 Ember.js。我们当前的设置是使用服务器端 Handlebars 渲染以及用于 CRUD 操作的 RESTful 路由和用于推送通知的 Websockets。

然而，我主要担心的是模型代码的重复。

> Ember Data 是一个库，用于从持久层（例如 JSON API）加载模型，更新这些模型，然后保存更改。它提供了许多您可以在 ActiveRecord 等服务器端 ORM 中找到的功能，但它是专门为浏览器中 JavaScript 的独特环境而设计的。

据我了解，要使用 Ember.js，我需要在 Javascript 中定义我的模型，从而复制我们已经在服务器端拥有的许多 Mongo 模型。这个对吗？将 Ember.js 与 Ruby 后端结合使用时，如何减少模型中的代码重复？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T01:55:08.413

您可能希望在客户端完成和服务器端完成之间拆分一些任务。

模型本身将被复制，因为如果您有 Ember Data 模型，它可以更轻松地使用 Ember。不过，您可以即时构建自己的模型，只需对所有内容进行 api 调用（可能不建议）。您可以通过在`model`路由的钩子中执行 api 调用来做到这一点。

但是，一旦您设置了 Ember Data 模型，您就可以保持逻辑相当简单，并让服务器处理更复杂的任务。但这在很大程度上取决于应用程序的特定需求。

# spring-mvc - Java Spring org.springframework.beans.factory.BeanCreationException

> ID：15143139
> 
> 赞同：1
> 
> 时间：2013-02-28T18:39:58.950
> 
> 标签：spring-mvc

我已经在新笔记本电脑上安装了 myEclipse，并导入了一个我用旧计算机上安装的 myEclipse 完成的项目。问题是我无法使用 Tomcat 6 运行该应用程序。

这是我得到的例外：

```
INFO: Mapping collection: com.thelearningbar.pojos.ScrapbookEntry.tags -> ScrapbookEntryTag
10:54:33,901 ERROR [ContextLoader] Context initialization failed
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'emailSurveyListsMgr' defined in ServletContext resource [/WEB-INF/service-context.xml]: Cannot resolve reference to bean 'transactionManager' while setting bean property 'transactionManager'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'transactionManager' defined in ServletContext resource [/WEB-INF/hibernate-context.xml]: Cannot resolve reference to bean 'sessionFactory' while setting bean property 'sessionFactory'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sessionFactory' defined in ServletContext resource [/WEB-INF/hibernate-context.xml]: Invocation of init method failed; nested exception is org.hibernate.MappingException: Could not determine type for: com.thelearningbar.persistence.hibernate.GenericEnumUserType, at table: Characteristic, for columns: [org.hibernate.mapping.Column(characteristicTypeCd)]
    at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:275)
    at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveValueIfNecessary(BeanDefinitionValueResolver.java:104)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyPropertyValues(AbstractAutowireCapableBeanFactory.java:1244)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1008)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:470)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory$1.run(AbstractAutowireCapableBeanFactory.java:409)
    at java.security.AccessController.doPrivileged(Native Method)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:380)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:264)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:217)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:261)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:185)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:164)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:423)
    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:729)
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:381)
    at org.springframework.web.context.ContextLoader.createWebApplicationContext(ContextLoader.java:255)
    at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:199)
    at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:45)
    at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:3827)
    at org.apache.catalina.core.StandardContext.start(StandardContext.java:4334)
    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:791)
    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:771)
    at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:525)
    at org.apache.catalina.startup.HostConfig.deployDirectory(HostConfig.java:920)
    at org.apache.catalina.startup.HostConfig.deployDirectories(HostConfig.java:883)
    at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:492)
    at org.apache.catalina.startup.HostConfig.start(HostConfig.java:1138)
    at org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:311)
    at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:117)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1053)
    at org.apache.catalina.core.StandardHost.start(StandardHost.java:719)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1045)
    at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:443)
    at org.apache.catalina.core.StandardService.start(StandardService.java:516)
    at org.apache.catalina.core.StandardServer.start(StandardServer.java:710)
    at org.apache.catalina.startup.Catalina.start(Catalina.java:566)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:288)
    at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:413) 
```

# c++ - 硬件高效的OpenGL

> ID：15143140
> 
> 赞同：1
> 
> 时间：2013-02-28T18:39:59.313
> 
> 标签：c++, opengl

我编写了一个 c++ 代码，并将我的帧数据存储在缓冲区中。由于我正在开发自己的 DSP 算法来进行眼睛检测，因此我需要处理数据以适合我的算法。但是，好消息是我必须一次对所有像素应用相同的指令。这就是为什么我想知道OpenGL是否有一种有效的方法（例如一次将所有像素乘以一个数字）？

不幸的是，在我正在使用的硬件平台上，OpenCV 不支持 SIMD，这就是我不能使用 OpenCV 的原因。但是，支持 OpenGL，并且大多数函数调用都是硬件优化的（这意味着它们可以直接与 GPU 对话）。因此，我很好奇是否可以在 OpenGL 中执行此类功能，如果可以，任何人都可以给我一些示例代码，以了解如何有效地处理大数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T19:06:02.650

是的，你可以做到。它的基本要点是，您将输入数据作为纹理或顶点数据加载到 GPU 上，使用进行计算的着色器进行渲染，然后将结果读回内存。GPGPU.org 是此类事情的一个很好的资源，因为它们自 CUDA/OpenCL 之前的日子就已经存在。

[http://gpgpu.org/developer/legacy-gpgpu-graphics-apis](http://gpgpu.org/developer/legacy-gpgpu-graphics-apis)

# java - 这是糟糕的 MVC 设计吗？

> ID：15143146
> 
> 赞同：3
> 
> 时间：2013-02-28T18:40:13.433
> 
> 标签：java, model-view-controller

我想知道这是否不好；让视图了解控制器，以便它可以委托视图中发生的操作等，并让控制器了解视图（这显然是正确的），但是我想知道这是双向关系是否正确？我想在视图中引用控制器，因为我想将所有工作委托给控制器并保持视图清洁。

这是一个糟糕的设计吗？如果是这样，我可以做些什么不同的事情并仍然达到同样的效果？

**控制器：**

```
public class Controller {

    private View view;

    public Controller() {
        view = new View(this);
    }

    public void doSomeButtonAction() {
        // More code...
    }
} 
```

**看法：**

```
public class View implements ActionListener {

    private Controller controller;
    private Button button;

    public View(Controller controller) {
        this.controller = controller;

        // Code for initializing button reference etc.
    }

    @Override
    public void actionPerformed(ActionEvent event) {
        controller.doSomeButtonAction();
    }    
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T19:20:57.640

意见会有所不同，但是，我喜欢将模型设计为应用层中的顶级客户端，这意味着仅由容器（应用服务器 + 任何框架）调用，当然不是由视图或模型调用。为了清晰起见，我远离视图组件在语言级别直接与控制器对象对话，而是通过协议使其通过容器。因此，如果网页需要向 Java servlet 提供额外的请求，而不是直接调用 servlet，而是向服务器提交 HTTP（或任何其他协议）请求，并让服务器将其路由到适当的控制器组件。这样，您在 MVC 的不同组件之间就有了一个抽象层，

所以我的回答是肯定的，视图与控制器对话是不好的。事实上，我喜欢在设计 MVC 时依赖完全[的控制反转，](http://en.wikipedia.org/wiki/Inversion_of_control)即没有组件直接访问另一个组件，而是有一个由容器管理的抽象层。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T18:47:05.490

你有一个大致的想法：把逻辑（actionPerformed() 的实现放到控制器中。视图会有可见的小部件，例如，面板中的按钮。这对我来说不像“MVC”，而是“ VC”，看不到数据模型。

这里没有足够的代码让我称之为“坏”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T21:03:48.270

分配特定按钮执行的功能是视图级别的问题*。*控制器负责提供*how*，但它不会向上告诉视图它的按钮应该做什么。视图可以“知道”“这是一个调用保存操作的按钮”。视图的全部目的是将人工输入转换为软件操作！

如果您想要可重用的组件，您当然可以在其中添加另一层抽象，但是分配按钮执行的操作的代码在概念上仍然是“视图”的一部分，无论您将其粘贴到何处。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-28T18:50:35.437

它不是 MVC 设计，MVC 应该将模型、视图和控制器分层分离，以获得设计模式的好处。

您似乎正在使用 JSF ，因此您的 View 和 Controller 类实际上都是 JSF 中 View 层的一部分。您最好将它们重命名为 PageAction、ViewFinder、ViewFrontController 等。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-28T18:43:56.020

稍后可能会派上用场的一件事是删除您`Controller`的构造函数中的依赖项。将视图作为参数传递或使用 setter。

```
public class Controller {

    private View view;

    public Controller(View view) {
        this.view = view;
    }

    public void doSomeButtonAction() {
        // More code...
    }
} 
```

这样，您的控制器不负责创建`View`. 您的程序本身（例如 Main）将负责创建所需的`View`实现，并在创建`Controller`. 如果您想使用模拟视图或控制器，这也将有助于测试。

您的视图负责用户程序交互。当它接收到一些用户输入时，它需要通知一些控制器，所以你必须对它有一个引用。然后，它的字段`View`也应该有一个设置器。`Controller`通过这种方式，您可以构建两者并相互传递。

# javascript - 将页面的一部分（圆形按钮/ PNG）固定在 JQuery Mobile 页面上的最佳方法是什么？

> ID：15143147
> 
> 赞同：0
> 
> 时间：2013-02-28T18:40:16.880
> 
> 标签：javascript, jquery, css, jquery-mobile, css-transitions

在我使用 JQuery Mobile 的项目中，我希望将圆形 PNG 按钮固定在屏幕的右下角（正确处理移动方向更改等），而 JQuery Mobile 页面内容显示在下方。当滚动下方的内容或 JQuery Mobile 页面从一个切换到另一个时，该按钮应保持固定在右下角并且不会移动。

在没有 JQuery 的空白页面上，这个直接的 CSS 似乎可以工作：

```
img.roundButton {
  position: absolute !important;
  bottom: 5px;
  right: 5px;
  z-index: 99;
} 
```

以上内容在页面外部的 JQuery 文档中停止工作（并且在页面内部，当页面出现并作为新页面的一部分重新出现时它会消失 - 而我需要它保持通过任何转换和页面（数据角色="page") 加载。

我已经尝试过 data-position="fixed" data-fullscreen="true" （对于 img 或 div data-role="footer"）但它不起作用 - 此外，在 iPhone 上，考虑到垂直位置计算错误网址工具栏，使按钮上方的适当角落位置的距离等于移动 Safari 栏的宽度，处于下降状态。

任何建议将不胜感激。萨沙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T19:19:55.910

```
img.roundButton {
position: absolute !important;
...
} 
```

...解决了这个问题。显然是我的疏忽！谢谢你。

# meteor - 如何使用流星在控制台中查看集合中的名称列表

> ID：15143148
> 
> 赞同：2
> 
> 时间：2013-02-28T18:40:18.610
> 
> 标签：meteor

如何查看集合中所有名称的列表。

在下面的示例中，我想在控制台中查看每个**synth + counterDivItem的列表。**我知道如何使用**savedState.find({}).count(); 查看给定条目的数字；** 但我不明白如何实际查看名称列表。

```
savedState.insert({Category:"SYNTHS", items: [{Name:"synth" + counterDivItem }]}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T19:00:04.133

在查找光标上执行 forEach 并遍历项目，将 Name 的值推送到列表中。

```
var list = [];

savedState.find().forEach(function(state){
    for (a = 0; a < state.items.length; a++) {
        list.push(state.items[a].Name);
    }
});

console.log(list); 
```

# c++ - 在 boost iostream filtering_ostream 中，sync()、strict_sync() 和 flush() 有什么区别？

> ID：15143149
> 
> 赞同：1
> 
> 时间：2013-02-28T18:40:23.213
> 
> 标签：c++, boost, iostream, boost-iostreams

考虑一个简单的计数过滤器：

```
class CountableOstreamFilter : public boost::iostreams::multichar_output_filter {
public:
    CountableOstreamFilter(): m_written(0) { 
    }

    template<typename Sink>
    std::streamsize write(Sink& dest, const char* s, std::streamsize n)
    {
            auto result  = boost::iostreams::write(dest, s, n);
            assert(n == result);
            m_written += result;
            return result;
    }

    inline std::streamsize writtenBytes() const {
        return m_written;
    }

private:
    std::streamsize m_written;
}; 
```

并因此使用它：

```
boost::iostreams::filtering_ostream counted_cout;
counted_cout.push(CountableOstreamFilter());
counted_cout.push(std::cout);
counted_cout << "hello world"; 
```

调用sync()、strict_sync() 或flush() 有什么区别？counted_cout.sync(); // 与此调用有何不同 counted_cout.strict_sync(); // 到这个调用 counted_cout.flush(); // 这个电话？

我正在使用提升 1.50.0

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-28T19:59:57.220

`sync`、`strict_sync`和之间的主要区别在于`flush`它们的返回值。他们三个。`filtering_stream`它们都在满足[Flushable](http://www.boost.org/doc/libs/1_53_0/libs/iostreams/doc/concepts/flushable.html)概念的任何过滤器或设备上调用 flush 方法。任何不支持 Flushable 概念的过滤器/设备都会被跳过。

`sync`除非可冲洗过滤器/设备之一返回 false，否则返回 true。这意味着如果存在属于 的一部分的不可刷新的过滤器/设备`filtering_stream`，数据可能会卡在其中，但`sync`会返回 true，因为它们不是可刷新的。

`strict_sync`类似，除非遇到不可冲洗的过滤器/设备。在这种情况下，`strict_sync`即使所有可冲洗过滤器/设备都可能返回 true，也会返回 false。这样做的原因是调用者`strict_sync`知道如果它返回 true，则所有数据都已成功刷新。

该成员`flush`简单地返回对流的引用，有效地丢弃刷新是否成功。非成员`flush` [根据输入值对返回的内容有自己的规则](http://www.boost.org/doc/libs/1_53_0/libs/iostreams/doc/functions/flush.html)

在您的情况下，`CountableOstreamFilter`不是 Flushable （它不能转换为必要的 flushable_tag）。`sync`因此，只要底层流上的刷新成功，调用就会返回 true。但是，`strict_sync`应该返回 false。

# algorithm - 保留对有限许可证的访问权的算法

> ID：15143157
> 
> 赞同：2
> 
> 时间：2013-02-28T18:40:52.853
> 
> 标签：algorithm

我们的情况是许可证较少（用于 GUI 测试工具 Silktest）和更多用户。

我正在尝试构建一个系统，通过预订可以访问许可证。

要执行自动化套件，用户必须创建一个预订，这反过来会用完一个许可证。同时其他许可证将是免费的。

一个简单的 FIFO 队列无法解决它，因为单个用户一次只能执行一个套件。

是否有任何标准算法可以帮助有效地分发许可证。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-24T20:53:16.043

定义一个时代。统计数据发生在一个时代。（说两个小时）。

定义一个刻度。许可证请求在每个滴答声中都被接受/解决。（比如说 30 秒）

保留有关每个许可证持有多长时间以及由谁持有的统计信息。

为每个用户分配一个权重，他们使用许可证的次数越多，权重就会减少，但仅限于设定的时间。

每个刻度：

1.  收集想要许可证的人。
2.  记录许可证的发布并收集每个用户统计的许可证签出时间。
3.  对于每个可用许可证：
4.  在请求权重最高的用户和最长的等待时间之间进行选择。如果超过一个用户在这两个标准上并列，则随机选择。
5.  安排减少获胜用户的权重，时间等于他们之前持有许可证的平均时间加上他们持有此许可证的时间。

每个时代：

1.  调整统计数据，使其不会超出

希望这将根据用户使用许可证的差异自动调整许可证签出。那些想要长时间或频繁或偶尔使用它的人仍然应该获得一个许可证，随着时间的推移，它有望达到平衡。

另一个

# algorithm - 大 O 表示法和递归

> ID：15143167
> 
> 赞同：1
> 
> 时间：2013-02-28T18:41:27.970
> 
> 标签：algorithm, recursion, complexity-theory, big-o

我在为这两个递归函数计算大 O 表示法时遇到了一些麻烦：

```
int calc (int n) 
{
  if (n <= 0)
    return 0 ;
  else if (n > 10) 
    return n ;
  else
    return calc (5 + calc(5n));
} 
```

在上述情况下，我认为大 O 表示法可能是 O(n^2) 因为数据集中的嵌套迭代？

```
boolean method (int k ,int [] arr, int i, int j)
{
    if (i > j)
       return false;
    if (arr [(i+j)/2] == k)
       return true;
    if (arr [(i+j)/2] < k)
       return method (k, arr, i, ( (i+j)/2) - 1) ;
    else
       return method (k, arr, ((i+j)/2)+1, j) ;
} 
```

在这里，我认为大 O 表示法可能是 O(log N)，因为每次迭代输入数据集减半？

但是，我对 Big O 表示法非常陌生，非常感谢任何帮助或解释！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T19:31:13.697

**对于`calc`：**

在递归期间，此函数永远不会被调用超过 5 次。从简短的分析中很容易看出并用一些值代替`n`. 就这样`O(1)`。*提示：函数将被调用的次数越小`n`（超过某个阈值）。*

也许有点大胆的说法，但我相信任何函数（假设`n`是输入/输入大小）`if (n > max) return const;` **都必须**是`O(1)`（只是让“常数”成为所花费的最大时间`n <= max`）。

**对于`method`：**

是的，它是`O(log n)`。

该功能实际上是二进制搜索，这是一件好事。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T19:52:03.840

杜克林是正确的。第一个是 O(1)，第二个是 O(log N)

但是鉴于这个问题的标题，我认为重要的是要记住递归并不特殊。任何递归函数都可以重写为循环，与标准循环相比，它们没有区别。

# visual-studio - 智能感知在 vs2012 中不起作用

> ID：15143168
> 
> 赞同：1
> 
> 时间：2013-02-28T18:41:28.183
> 
> 标签：visual-studio, user-controls, visual-studio-2012, telerik, intellisense

我有一个包含 50 个项目的解决方案。它是用 VS2010 编写的，后来转换为 VS2012。**除了用于“telerik”标签和自定义创建控件的标记智能感知（Aspx、ascx ..）之外，**所有智能感知都工作得很好。**asp标签工作正常**

如果我创建一个新项目并引用 Telerik，那么 intelisense 就可以工作，所以我猜我的项目有问题。我试图并排比较 web.configs。它们看起来一模一样。组件看起来也一样。我的 web.config 看起来像这样：

```
<controls>
        <add tagPrefix="asp" namespace="System.Web.UI" assembly="System.Web.Extensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
        <add tagPrefix="asp" namespace="System.Web.UI.WebControls" assembly="System.Web.Extensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
        <add tagPrefix="asp" namespace="System.Web.UI.DataVisualization.Charting" assembly="System.Web.DataVisualization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
        <add tagPrefix="telerik" namespace="Telerik.Web.UI" assembly="Telerik.Web.UI" />
        <add tagPrefix="custom" src="src/to/control" tagName="myControl1" />
        <add tagPrefix="custom" src="path...." tagName="myControl2" />
      </controls> 
```

我尝试过的事情：
1\. 工具->选项->文本编辑器->C#（或所有语言）->常规在右侧窗格中启用自动列表成员和参数信息。
2.工具->导入和导出设置->重置所有设置。
3.删除Roaming\Microsoft\VisualStudio\11.0\ReflectedSchemas中的数据
4.删除ProgramFiles\VisualStudio中的缓存...
5.重新安装visual studio
6.以管理员身份运行

如果您有任何线索或可能的解决方案，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-12T07:10:45.350

在 Gac 中注册 Telerik.Web.UI.dll，这个解决方案对我有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-23T12:58:38.290

我在 Visual Studio 2013 中发生了这种情况。这是我为恢复 Intellisense 所做的工作：

1.  在您的项目中添加对 Telerik.Web.Design.dll 的引用。
2.  保存您的项目。
3.  在 IDE 中重新加载您的项目。（我重新启动了VS，以防万一。）

！

# c - 在二叉树中找到最左边的节点

> ID：15143172
> 
> 赞同：3
> 
> 时间：2013-02-28T18:41:35.270
> 
> 标签：c, algorithm, binary-tree

我需要在二叉树中找到最左边的节点。这听起来可能很幼稚，但事实并非如此。我试过了，但我认为它会失败：

```
Node* findLeftMostNode(Node* root){
    if(root->left==null)
       return root;
    findLeftMostNode(root->left);
} 
```

问题是左模式节点可以在任何级别，所以我们需要处理它。

```
 X
          \
           X
           /\
          X  X
         /
        X
       /
      X 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T19:28:01.910

使用这种计算节点“左”的方法，您总是必须递归到两个子节点，因为任何子节点都可能包含一个*n节点的序列，对于任何**n*来说都是向左的。

因此，解决方案实际上非常简单：计算树中每个节点的 x 并返回最小的一个：

```
Node* findLeftmostNode(Node* current, int x = 0)
{
    current->x = x;

    Node* best;
    // leftmost child in the left subtree is always better than the root
    if (current->left == null)
        best = current;
    else
        best = findLeftmostNode(current->left, x - 1);

    if (current->right != null)
    {
        Node* found = findLeftmostNode(current->right, x + 1);
        if (found->x < best->x)
            best = found;
    }

    return best;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T19:45:38.263

```
Node *findLeftMostNode(Node* root){
    for( ; root; root =root->left)
    if (!root->left) break;
    }
  return root;
} 
```

# git - npm 安装没有 package.json 的 git 存储库

> ID：15143173
> 
> 赞同：37
> 
> 时间：2013-02-28T18:41:35.023
> 
> 标签：git, npm

我有一个依赖于几个第三方库的项目。

我的 package.json 看起来像：

```
"dependencies": {
    "vendor-name": "git://github.com/vendor/name.git#v1.1",
    ...
} 
```

只要`vendor-name`存储库包含`package.json`.

如果没有这样的文件，我会得到：

```
npm ERR! path /var/folders/0l/temp-folder/package.json
npm ERR! code ENOENT 
```

实际上， a`npm install git://github.com/vendor/name.git#v1.1`也不起作用。

所以我的问题是：有没有办法安装（包括）`dependencies`没有的 git 存储库（在 中）`package.json`？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2013-09-06T03:13:33.807

是的，您可以使用此软件包：[https ://npmjs.org/package/napa](https://npmjs.org/package/napa)

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2016-10-29T05:57:09.770

napa 所做的似乎是过度设计的。我认为只需将安装脚本添加到 package.json 中就足够了。

```
"scripts": {
    "install": "git clone https://github.com/vendor/name.git -b v1.1 node_modules/name"
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-25T11:04:26.970

[不，根据npm 文档](https://npmjs.org/doc/install.html)，这是不可能的

# javascript - 如何对 1 个大 Javascript 文件进行范围或分区

> ID：15143174
> 
> 赞同：1
> 
> 时间：2013-02-28T18:41:35.553
> 
> 标签：javascript, ruby-on-rails, asp.net-mvc, web-applications

这适用于所有服务器/客户端 Web 应用程序，但我想知道它适用于 rails 或 asp.net。

一个好的做法是拥有 1 个包含我所有 JavaScript 的大 application.js 文件。因此，当我有多个页面或操作时，如何确定 javascript 的范围。

例如，我有一个登录页面和客户输入表单。

在登录页面上，我想将焦点放在用户名上`document.ready`，在我想`focus`在名字的文本框上设置的客户输入表单中，做一些繁重的 Ajax 和客户端验证。如何确保脚本不会发生冲突并正确确定它们的范围？

脚本的两个部分都存在于一个文件中，那么如何在正确的时间访问正确的脚本部分？

是否有任何最佳实践建议？我不想为单个控制器操作加载单独的文件...

任何帮助都会很棒...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T18:46:47.920

您是否考虑过在 javascript 中进行位置检查？

就像是...

```
if(location.href.match(/login\.aspx/)){
    //code here
} else if(location.href.match(/otherpage\.aspx/)){
    //other code here
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T18:57:15.813

**只执行代码的特定部分**

我遇到了类似的问题，但不是在rails中，而是在asp.net中。

这个 javascript 解决方案应该可以在任何地方工作：

[http://paulirish.com/2009/markup-based-unobtrusive-comprehensive-dom-ready-execution/](http://paulirish.com/2009/markup-based-unobtrusive-comprehensive-dom-ready-execution/)

这基本上是基于 DOM 的路由之母。您将属性赋予指定您所在位置的 body 标记。通读一遍，它非常简单且实用。

基于 DOM 的路由现在非常流行，并且已经在很多框架中实现（我很确定 rails 有它自己的解决方案），但是这个简单的版本可以在任何地方轻松实现。

该帖子中还有一些后续链接，您也应该阅读它们并确定最适合您的链接。

**捆绑脚本**

在 JavaScript 中“您编写/调试的内容就是您发布的内容”是一种误解：

由于它是一种在客户端解释的脚本语言，您可以直接通过网络发送它而无需任何处理，但这会导致不必要的大文件和大量单独的请求：每个文件一个请求。因此，您可以从中删除所有注释/空格并将所有代码放入一个文件中，但这会导致代码无法维护。您可能认为这是一个必要的权衡，但事实并非如此！

您可以“构建”将它们捆绑在一起的 javascript 文件，并将它们的内容缩小到更小的大小。它有很多工具，我相信 rails 有它自己的解决方案（在你最喜欢的搜索提供商上搜索捆绑 javascript）。您可以在测试环境中使用未捆绑/未缩小的代码，因此开发和调试非常容易。当您需要将其发布到生产环境时，您可以捆绑您的脚本。

然后，您可以在不同的文件中定义对象/函数，例如：

文件1：

```
var FOO = {

}; 
```

文件2：

```
FOO.common = {
  init     : function(){ ... },
  finalize : function(){ ... }  
}; 
```

文件3：

```
FOO.shopping = {
  init     : function(){ ... },
  cart     : function(){ ... },
  category : function(){ ... }
}; 
```

这样，您基本上可以获得与 1 个文件相同的结果，而且在设计应用程序时阅读起来也更清晰一些。

编辑：此解决方案使用 jQuery 的`$(document).ready()`功能。如果这是不可取的，您还可以将其连接到任何其他就绪事件。

# c# - 关闭 winform 表单并停止执行

> ID：15143177
> 
> 赞同：1
> 
> 时间：2013-02-28T18:41:47.277
> 
> 标签：c#, winforms

~~我所有的表单都继承自一个基本表单（“Base”）。~~

在那里，当它初始化时，我调用一个名为“Acceso”（访问）的方法，该方法根据当前用户的访问权限返回真或假。

```
public Base()
    {
        InitializeComponent();
        Acceso();
    }

public void Acceso()
    {
        Type tipo = this.GetType();
        if (Metodos.Login.Acceso(tipo) == false)
        {
            WMessageBox.Show("Su usuario no posee los privilegios necesarios para acceder a esta ventana.", "Error", 2, false);
            this.Close();
            this.Dispose();
        }
    } 
```

问题是，如果它返回 false，表单会完美关闭，但之后会出现异常。显然，表单继续运行。我试图通过处理它来解决这个问题，但我遇到了同样的问题。

~~如何终止表格？有没有办法停止和销毁实例？~~

编辑：实际上发生这种情况是因为它想显示已删除的表单。

```
form.Show(); 
```

我写了这个问题，因为我认为它正在发生与另一种形式相同的事情。

在那种形式中，我有一个面板，我可以在其中加载我的用户控件。当我创建 UserControl 的实例并将其添加到面板时，我将表单分配给 UserControl 中的 Form 类型变量。那是因为如果用户在该 UserControl 中遇到异常，我会执行 form.Close() 来关闭整个表单。

这就是我加载用户控件的方式（它在一个按钮中）：

```
 private void btn_Administracion_grupos_Click(object sender, EventArgs e)
    {
        Dispose_User_Control();
        ABM.frm_Administracion_Grupos administracion_grupos = new ABM.frm_Administracion_Grupos();
        administracion_grupos.form = this;
        pnl_UserControl.Controls.Add(administracion_grupos);
    } 
```

administracion_grupos 是表单。

在 Dispose_User_Control() 中，我从面板中删除 UserControl 并处理它：

```
public void Dispose_User_Control()
    {
        if (pnl_UserControl.Controls.Count > 0)
        {
            try
            {
                UserControl frm = (UserControl)pnl_UserControl.Controls[0];
                frm.Dispose();
            }
            catch
            {

            }

            pnl_UserControl.Controls.Clear();
        }
    } 
```

然后，在 FormClosing() 事件中，我在面板和表单中处理 UserControl。

```
private void frm_Configuracion_FormClosing(object sender, FormClosingEventArgs e)
    {
        Dispose_User_Control();
        this.Dispose();
    } 
```

当我的 UserControl 出现异常时，我会这样做：

```
try
            {
                db.SaveChanges();
                WMessageBox.Show("Grupo guardado con éxito.", "Confirmación", 3, false);
            }
            catch(Exception excep)
            {
                Control.Mensajes_error.Error_transaccion(excep);
                form.Close();
            } 
```

我接受它，然后关闭表单（带有面板的表单）。

但是在关闭之后（不再显示表单），我在 UserControl 内的代码行中出现异常。这就是为什么我想要一种方法来终止整个表单。

我得到的例外是在我使用datagridview的一行代码中。它只是说空引用。然后我说，主窗体关闭，用户控件被释放，但它只是继续执行代码！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T18:45:02.233

您可以为此使用[Environment.Exit](http://msdn.microsoft.com/en-us/library/system.environment.exit.aspx)方法

# c - Checknullarray 结构

> ID：15143187
> 
> 赞同：1
> 
> 时间：2013-02-28T18:42:41.417
> 
> 标签：c, arrays, for-loop, structure

```
struct contact list[3];
int checknullarray()
{
    for(int x=0;x<10;x++)
    {
        if(strlen(contact[x].name)==0)
        {
        return x;
        break;
        }
    }
} 
```

我遇到了 checknullarray 的问题。它说我的类型名称`(contact[x].name)`是不允许的。我现在该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T19:38:54.213

假设联系人有一个成员`char name[n];`

```
struct contact list[3];

int checknullarray(void) /* void is a better option when no params */
{
    for (int x = 0; x < 10; x++) /* 3 or 10 ? I think you want x < 3 */
    {
        /*
        if(strlen(contact[x].name)==0) No need to strlen, you can check if name[0] == 0
        */
        if (list[x].name[0] == '\0')
        {
               return x;
            /*
               break; why break if you return in previous line?
            */
        }
    }
    return x; /* As suggested by qPCR4vir you need an alternative return */
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T08:49:52.990

只是为了好玩:-)（其他解决方案很好）

```
#include "contact.h"
#define N 3
struct contact list[N];

int checknullarray(void)
{
    int x;
    for ( x = 0; x < N && *list[x].name; x++) ;
    return x; 
}
int main(void)
{
   /* initialice list */
   int R;
   R=checknullarray();
   if (R==N) /* No name in list =="" */;
} 
```

# emacs - 缩写在emacs中不起作用

> ID：15143191
> 
> 赞同：0
> 
> 时间：2013-02-28T18:42:43.787
> 
> 标签：emacs

当我添加缩写时 `("s:", "std::")`

当上面和下面的其他缩写起作用时，它不起作用。

语法有问题吗？我怎样才能让它工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T03:25:19.037

正如 ring0 解释的那样，它不起作用，因为默认情况下，缩写仅在它们由“单词成分”和“：”不是单词成分的字符组成时才起作用。您可以为给定的表更改此规则，例如`(abbrev-table-put <table> :regexp "\\<\\(\\w+:?\\)\\W*")`，正则表达式`"\\<\\(\\w+:?\\)\\W*"`几乎可以重现默认行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T20:57:39.450

字符`:`和空格`?`... 不被认为是*单词*的一部分（根据 Emacs 定义），并触发*abbrev*机制，该机制检测在此之前键入的单词`:`是否是缩写词并且必须扩展（[使用 Word缩写](http://docstore.mik.ua/orelly/unix/upt/ch32_11.htm)）。

因此，虽然`s:`定义了缩写，但输入`:`of

```
s: 
```

使 Emacs 触发`s`作为缩写的搜索。在顺序词中，包含标点符号的缩写不能扩展。

例如，更简单的解决方案是选择数字+字母

```
8s or s8 
```

--

有一个正则*表达式*可以识别触发缩写搜索的字符，但它仅适用于[动态缩写](http://www.gnu.org/software/emacs/manual/html_node/emacs/Dabbrev-Customization.html#Dabbrev-Customization)。

我试图修改*后向词*的行为，但在最近的 Emacs 版本中它甚至没有用于捕获后向词（缩写）。

# java - 如何在安卓上使用 FileLock？

> ID：15143195
> 
> 赞同：3
> 
> 时间：2013-02-28T18:42:52.670
> 
> 标签：java, android, filelock

我认为我们能够锁定文件以进行独占访问，因为我看到了这个链接：http: [//developer.android.com/reference/java/nio/channels/FileLock.html](http://developer.android.com/reference/java/nio/channels/FileLock.html)

我想在后台进程（服务）和真正的前台应用程序中创建一个保存/加载文件。他们可能会尝试同时访问此文件，在这种情况下，应该等待。

我在 android 上找不到 FileLock 的真实示例，我刚刚阅读了许多线程，这在 Android 上是不可能的。但如果是这样，为什么文档中有一个“FileLock”部分？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-28T18:46:27.860

这适用于普通的 Java 应用程序：

```
File file = ...;
FileInputStream fis = new FileInputStream(file); // or FileOutputStream fos = new FileOutputStream(file);
FileLock lock = fis.getChannel().lock(); // or FileLock lock = fos.getChannel().lock();

// do whatever you want with the file

lock.release(); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-10-04T13:03:55.480

1.  您可以尝试`lock()`使用阻塞和`trylock()`不阻塞
2.  `FileLock`不工作`FileInputStream`。
3.  在 Android 中，`FileLock`可以在进程之间工作，但不能在进程中的线程之间工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-11-04T09:09:40.637

FileLock 仅在作为共享锁获取时才对 FileInputStream 起作用。

```
 FileInputStream fis = new FileInputStream(file + ext);
  FileChannel fileChannel = fis.getChannel();
  FileLock fileLock = fileChannel.tryLock(0L, Long.MAX_VALUE, /*shared*/true); 
```

其实这是有道理的。共享锁意味着可以有任意数量的同时读取者，但不允许写入者。而默认独占锁则赋予进程独占访问写入权限。由于您无法使用 FileInputStream 进行编写，因此您必须在其上获取共享锁。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-08-27T05:30:05.637

我认为文件锁定适用于“内部”手机内存，但不适用于 SD 卡。

# ruby-on-rails - 为 Rails 引擎运行测试时出错

> ID：15143198
> 
> 赞同：0
> 
> 时间：2013-02-28T18:42:59.210
> 
> 标签：ruby-on-rails, rake, factory-bot, rails-engines, social-stream

我正在构建一个基于社交流 gem 的应用程序，它是一个 Rails 引擎。我有一个 Rakefile。我已经在我的 Gemfile 中包含了 factory-girl gem，但由于某种原因，该类的 rake 任务失败了。

gem中有很多测试，我想执行。Rails 应用程序位于：/Users/sean/dropbox/fluent/sstest

gem中的失败代码：

```
# Helpers for building the post activity
#
class ActivityObjectSpecHelper < ActiveRecord::Base
  set_table_name "activity_objects"
end

class PostSpecHelper < ActiveRecord::Base
  set_table_name "posts"

  belongs_to :activity_object_spec_helper, :foreign_key => "activity_object_id"
end

Factory.define :activity_object_spec_helper do |a|
  a.object_type "Post"
  a.description "Post spec helper"
end

Factory.define :post_spec_helper do |p|
  p.association :activity_object_spec_helper
end

/Users/sean/.rvm/gems/ruby-1.9.3-p327/gems/social_stream-base- 1.1.4/spec/factories/activity.rb:13:in `<top (required)>': uninitialized constant Factory   (NameError)
from /Users/sean/Dropbox/fluent/sstest/spec/spec_helper.rb:22:in `block in <top  (required)>' 
```

**耙文件**

```
#!/usr/bin/env rake

require 'rspec/core'
require 'rspec/core/rake_task'
require 'resque/tasks'

require File.expand_path('../config/application', __FILE__)

Resque.after_fork = Proc.new { ActiveRecord::Base.establish_connection } if Resque.present?

# Include social_stream-base spec
def bsp(str)
  base_spec_path = File.join(Gem::Specification.find_by_name('social_stream- base').full_gem_path, 'spec/')
  File.join(base_spec_path, str)
end
RSpec::Core::RakeTask.new(:spec) do |s|
  s.pattern = ['./spec/**/*_spec.rb',
            bsp('./controllers/users_controller_spec.rb'),
            bsp('./controllers/notifications_controller_spec.rb'),
            bsp('./controllers/likes_controller_spec.rb'),
            bsp('./controllers/profiles_controller_spec.rb'),
            bsp('./controllers/comments_controller_spec.rb'),
            bsp('./controllers/frontpage_controller_spec.rb'),
            bsp('./controllers/posts_controller_spec.rb'),
            bsp('./controllers/representations_spec.rb'),
            bsp('./controllers/groups_controller_spec.rb'),
            bsp('./controllers/settings_controller_spec.rb'),
            bsp('./models/profile_spec.rb'),
            bsp('./models/user_spec.rb'),
            bsp('./models/tie_spec.rb'),
            bsp('./models/activity_spec.rb'),
            bsp('./models/actor_spec.rb'),
            bsp('./models/group_spec.rb'),
            bsp('./models/like_spec.rb'),
            bsp('./models/post_spec.rb')
      ]
end

task :default => [ :spec, 'assets:precompile' ]

Sstest::Application.load_tasks 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T21:10:10.867

我认为工厂是为旧版本的 factory-girl 创建的，因为班级名称在某些时候发生了更改。尝试在 Gemfile 中指定版本 1.3.3。

如果要使用最新版本，则需要更新语法。首先替换`Factory`为`FactoryGirl`. 查看文档以获取更多信息[https://github.com/thoughtbot/factory_girl/blob/master/GETTING_STARTED.md](https://github.com/thoughtbot/factory_girl/blob/master/GETTING_STARTED.md)

# gmail - 无法将电子邮件发送到 Google Apps 地址；Gmail 可以正常接收相同的电子邮件

> ID：15143200
> 
> 赞同：3
> 
> 时间：2013-02-28T18:43:06.490
> 
> 标签：gmail, google-apps, spf

我有一个安装了 Webform 模块的 Drupal 站点，用于向一小群拥有 Google 应用程序帐户的人发送电子邮件。它曾经工作过；现在，没有任何改变，他们根本没有收到消息。他们不在垃圾邮件中；他们只是永远不会到达时期。但是，如果我输入我自己的个人 Gmail 地址作为收件人，我会很好地收到它……而不是垃圾邮件或任何东西。

我想问题可能是我的域（托管在 MediaTemple）没有 SPF 记录，所以我添加了一个：

```
v=spf1 include:spf.mail01.mtsvc.net include:_spf.google.com ~all 
```

但是，谷歌仍然不喜欢它。当我查看在我的个人帐户中收到的消息的标题时，它说：

```
Delivered-To: me@gmail.com
Received: by 10.195.13.109 with SMTP id ex13csp22977wjd;
        Thu, 28 Feb 2013 09:58:05 -0800 (PST)
X-Received: by 10.49.16.135 with SMTP id g7mr12547512qed.8.1362074284935;
        Thu, 28 Feb 2013 09:58:04 -0800 (PST)
Return-Path: <info@freeyourlegs.com>
Received: from freeyourlegs.com (freeyourlegs.com. [72.10.49.208])
        by mx.google.com with ESMTPS id fo1si2728187qab.100.2013.02.28.09.58.04
        (version=TLSv1 cipher=RC4-SHA bits=128/128);
        Thu, 28 Feb 2013 09:58:04 -0800 (PST)
Received-SPF: softfail (google.com: domain of transitioning info@freeyourlegs.com does not designate 72.10.49.208 as permitted sender) client-ip=72.10.49.208;
Authentication-Results: mx.google.com;
       spf=softfail (google.com: domain of transitioning info@freeyourlegs.com does not designate 72.10.49.208 as permitted sender) smtp.mail=info@freeyourlegs.com
Received: (qmail 1658 invoked by uid 48); 28 Feb 2013 09:58:04 -0800
Date: 28 Feb 2013 09:58:04 -0800
Message-ID: <20130228175804.1656.qmail@freeyourlegs.com>
To: me@gmail.com
Subject: Form submission from: Schedule an Appointment
X-PHP-Originating-Script: 10001:mail.inc
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8; format=flowed; delsp=yes
Content-Transfer-Encoding: 8Bit
X-Mailer: Drupal Webform (PHP/5.3.5)
Errors-To: info@freeyourlegs.com
Sender: info@freeyourlegs.com
From: "Vein Care Institute" <info@freeyourlegs.com> 
```

我对“softfail ...不指定为允许的发件人”位感到困惑。此外，每个选项组合（包括 v=spf1 +all）都会在[http://www.kitterman.com/spf/validate.html](http://www.kitterman.com/spf/validate.html)上的 SPF 测试仪上给我一个 HELO/EHLO 软故障（这甚至看起来不可能)，即使根据测试人员的说法，我当前的记录确实“通过”。

我确实知道为我的域设置了反向 DNS。

我错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T13:22:23.767

首先要尝试的是更正 SPF 记录。我会建议：

v=spf1 包括：_spf.google.com ip4:72.10.49.208 ~all

spf.mail01.mtsvc.net 中的 IP 范围与电子邮件来自的 IP 不匹配——我查找了 MediaTemple，他们的说明适用于您在使用他们托管电子邮件时。该电子邮件来自该网站的 IP，即 72.10.49.208

编辑：如果这不能解决问题，那么问题可能与发送服务器有关。建议您查看这篇文章（以及其中的链接）：

[无法向我自己域中的地址发送电子邮件](https://stackoverflow.com/questions/1107730/php-cant-send-email-to-addresses-at-my-own-domain)

# gcc - 如何在 arm 板上设置 gcc 以便它可以自己编译

> ID：15143201
> 
> 赞同：2
> 
> 时间：2013-02-28T18:43:11.043
> 
> 标签：gcc, compiler-construction, arm

我想要一个板载编译器，以便它能够自行编译。如您所知，自编译是“PC”的一项关键能力。ubuntu 运行在 arm 板上，所以如果有办法在板上设置 gcc，那么我可以使用 arm 板开发简单的程序。

有项目这样做吗？船上有端口 gcc 的方法吗？任何线索都可以提供帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T20:34:49.353

当然，制作自托管编译器是可能的。最直接的方法就是使用与为开发板编译“普通”应用程序相同的交叉编译器工具链来构建 GCC。然而，这不是一个简单的过程。

以下是几个项目，它们生成了在目标本身上运行的工具链：

引导-Linux：[https ://github.com/pikhq/bootstrap-linux](https://github.com/pikhq/bootstrap-linux)

原住民 Linux： http: [//landley.net/code/aboriginal/](http://landley.net/code/aboriginal/)（包括预构建的二进制文件）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T09:07:48.087

如果您有功能齐全的 Ubuntu，只需执行以下操作：

```
sudo apt-get update
sudo apt-get install build-essential 
```

如果您没有足够的内存或缺少 apt，您必须手动将 ARM 架构和您的 Ubuntu 版本的软件包从 Internet 下载到您的板上，然后执行

```
dpkg -i <package_name.deb> 
```

在这个阶段你会得到很多不满意的依赖，所以你也必须下载并安装它们。

# c# - EWL 中有没有办法根据我的位置动态设置页面标题？

> ID：15143202
> 
> 赞同：1
> 
> 时间：2013-02-28T18:43:15.553
> 
> 标签：c#, web-applications, page-title, enterprise-web-library

我的页面的标题（在这种情况下，我关心显示在 Firefox 选项卡上的文本）始终是系统的长名称，然后我的位置被添加到它的末尾。我处于一种情况，我想在同一个保护伞下拥有两个站点，并且我想在适当的时候显示不同的基本标题。我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T23:16:34.933

`EwfApp.AppDisplayName`在你的`Global.asax`类中覆盖。

# c - 堆栈周围的变量损坏？C

> ID：15143203
> 
> 赞同：0
> 
> 时间：2013-02-28T18:43:15.607
> 
> 标签：c, string, variables, whitespace, corruption

我有两个问题，但这是更紧迫的一个......

```
printf("Enter the term: "); scanf("%d", &input);
fprintf(inputf, "%d,", input);

printf("Enter the id: "); scanf("%d", &input);
fprintf(inputf, "%d,", input);

printf("Enter last name: "); scanf("%s", name);
fprintf(inputf, "%s,", name);

printf("Enter first name: "); fgets(name, 15, stdin);
fprintf(inputf, "%s,", name);

printf("Enter the subject: "); scanf("%s", subsec);
fprintf(inputf, "%s,", subsec);

printf("Enter the catalog number: "); scanf("%d", &input);
fprintf(inputf, "%d,", input);
//ISSUE HERE!
printf("Enter the section: "); scanf("%s", subsec);
fprintf(inputf, "%s\n", subsec); 
```

每当我输入所有这些信息并在最后一个变量条目上按 Enter 键时，我都会看到一个窗口显示“运行时检查失败 #2 - 变量 'subsec' 周围的堆栈已损坏”。我可以继续，该程序几乎可以按照我的意愿运行，但为什么会发生这种情况？

我的第二部分是当我输入姓氏，然后想输入名字时，当我按 Enter 键输入名字字符串变量时，它会包含“\n”字符，显然不希望发生这种情况，但是两者名字和姓氏需要能够保存带有空格的字符串。如何用一块石头杀死两只鸟？我使用 fget 来允许我保留空格，但它解决了我的“\n”捕获问题，但是如果我将它改回 scanf，我就无法保留空格！

编辑：这是亚秒

```
char subsec[MAX_SUBSEC]; 
```

MAX_SUBSEC 设置为 3，如您所见，我以前使用它，但我认为第二个 scanf（用于部分，而不是主题）会覆盖输入 subsec 的原始用途，我会说我错了吗？而且我不允许这样做，因此问题...

主题的输入将是“CSE”，部分的输入将是“R01”，是的，这一切都将被放入一个文件中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T18:54:41.203

如果`MAX_SUBSEC`是 3 并且您为主题或小节输入超过 2 个字符，您将超出`subsec`堆栈上的数组并损坏堆栈框架（这可能会或可能不会导致问题。您应该使用

```
scanf("%2s", subsec);         /* read up to two non-whitespace characters for subsec */ 
```

确保它不会尝试读取和存储超过 2 个字符（加上尾随 NUL）到`subsec`

您可能还想添加一个

```
scanf("%*[^\n]");             /* discard the rest of the input line */ 
```

在每个 scanf 之后，您当前必须丢弃输入行的其余部分（以防某些输入的数据项超过您想要的单个数据项。您可以将两者与

```
scanf("%2s%*[^\n]", subsec);  /* read 2 chars and discard the rest of the line */ 
```

如果你想。

要输入最多 15 个字符（包括 NUL）且名字/姓氏有空格的字符串，请使用：

```
scanf(" %14[^\n]", name);     /* read up to 14 chars from the line */ 
```

这将丢弃任何前导空格（包括上一行的换行符）然后读入`name`，但如果有人输入它们，则不会丢弃名称中的尾随空格（您可能想要清理它们）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T18:49:49.200

检查 inputf（我认为它是指向已打开文件的指针）是否正确读取了变量。换句话说，检查文件是否正确打开，并且该文件包含您要读取的所有数据。

# html - 如何禁用智能手机上的水平滚动？（HTML 网页视图）

> ID：15143206
> 
> 赞同：0
> 
> 时间：2013-02-28T18:43:36.183
> 
> 标签：html, css, webview

这次我正在使用 webview。我在这里有一个奇怪的行为。

overflow-x 设置为隐藏，在浏览器上运行良好。但是当涉及到任何移动设备时，它根本不尊重溢出。

[http://www2.madeinweb.com.br/jobs/adc/prototype/html/](http://www2.madeinweb.com.br/jobs/adc/prototype/html/)

这是它的网址。如果您尝试打开菜单，它将按预期工作。但我可以滚动我放在左边的内容。这不会发生在浏览器上。

我知道我可以使用 jQuery 完全禁用滚动，但我找不到仅禁用水平滚动的正确方法。

有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T15:33:55.977

我已经设法用 touchmove 对其进行了调整。谢谢没人回答

# jquery - 让标题占据身体的整个宽度

> ID：15143207
> 
> 赞同：0
> 
> 时间：2013-02-28T18:43:39.567
> 
> 标签：jquery, html, css

我正在制作一个标题，我需要它占据身体的整个宽度。我已经尝试`width: 100%;`过标题`div`，但两边仍然有空白。我尝试将它向左移动并使宽度超过 100%，但所做的只是添加一个水平滚动条，如果向右滚动，它的右侧仍然会有空白。

HTML：

```
<div id="header">
      <img id="logo" src="images/logo.png" alt="">
      <div id="nav">
            <a href="index.html">Home</a>
            <a href="about.html">About</a>
            <a href="gallery.html">Gallery</a>
            <a href="contact.html">Contact</a>
      </div>
 </div> 
```

CSS：

```
#header {
    position: relative;
    left: -9px;
    bottom: 8px;
    padding-top: 5px;
    padding-bottom: 5px; 
    background: url(images/dark_dotted.png);
    width: 105%;
    text-align: center;
    border-bottom: 4px orange solid;
}

#header #logo {
    padding-right: 700px;   
}

#nav {
    position: relative;
    bottom: 30px;   
    font-size: 28px;
    right: -300px;
    font-family: roboto;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T18:48:52.920

首先为这样的身体重置你的CSS

```
body
{
margin:0;
padding:0;
} 
```

这将从您的 div 的两侧删除该空白区域

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T18:57:45.900

问题是你`<div id="nav">`有`right: -300px;`它（大概是为了抵消`text-align: center;`标题。不知道你网站的要求，我可能建议这样做：

```
body {
    margin: 0;
    padding: 0;
}
#header {
    background: url("images/dark_dotted.png") repeat scroll 0 0 transparent;
    border-bottom: 4px solid orange;
    height: 150px;
    padding: 5px 0;
    width: 100%;
}
#header #logo {
    float: left;
    margin: 20px 0 0 100px;
}
#nav {
    float: right;
    font-family: roboto;
    font-size: 28px;
    margin: 90px 30px 0 0;
} 
```

这利用浮动来定位您的 div，但确实需要指定标题的高度，因为在计算容器大小时不考虑浮动。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T18:46:38.997

问题在于您的 id nav div。

它的宽度 > 1k 像素，远离页面的一侧。

您应该尝试（在您的导航上）：

```
margin:0;
padding:0;
width:100%;
max-width:100%; 
```

更多信息：

我的浏览器为导航 ID 计算的 css：

```
bottom: 30px;
display: block;
font-family: roboto;
font-size: 28px;
height: 37px;
position: relative;
right: -300px;
text-align: center;
width: 1326.140625px; 
```

如您所见，宽度超出了图表范围；尝试为其分配一个 100% 的固定值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-28T19:00:19.243

```
html, body
{
margin:0;
padding:0;
} 
```

这将使所有内容都适合视口（只要内容不使用绝对定位、负边距扩展它）。

您在项目上有大量填充（徽标上的 700）。考虑删除这些或使它们更小。

标题宽度需要为 100%；

最好使用带有填充和边距的静态（默认）定位和控制，而不是尝试通过像素和相对定位来移动它。

首页 关于图库 联系方式

CSS：

```
#header {
background: url(images/dark_dotted.png);
width: 100%;
text-align: center;
border-bottom: 4px orange solid;
}

#nav {
position: relative;
bottom: 30px;   
font-size: 28px;
float:right;
font-family: roboto; //this should be extended.. 'Robosto', serif (or appropriate type)
} 
```

这假设您没有使用`align="center"`您的 html。`margin:auto`您可以更有效地水平居中。

# javascript - jQuery复选框样式问题

> ID：15143214
> 
> 赞同：0
> 
> 时间：2013-02-28T18:44:09.077
> 
> 标签：javascript, jquery, input, checkbox, styling

我有一段 jQuery 代码，用于检查是否未选中复选框。如果不是，它会引发一个事件。这里是：

```
 $('#Button').click(function() {
        if(!$('input[@name=\"image_id\"]:checked').val()){
            //Do Something
            return false;
            }
}); 

```

它很好用，但我决定使用[jQuery Checkbox](http://widowmaker.kiev.ua/checkbox/)插件设置默认复选框的样式。

现在问题来了，这是样式化后的输出：

```
<input type="radio" name="answer_id" value="37" style="position: absolute; z-index: -1; visibility: hidden;">`
<span class="jquery-safari-checkbox jquery-safari-checkbox-checked"><span class="mark"><img src="empty.png"></span></span> 
```

因此让我无法查看是否检查了输入。关于我能做什么（如果有的话）的任何想法还是我应该恢复到旧的复选框？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T18:50:45.023

在我看来，这样做有点混乱，但是：

```
if($(".jquery-safari-checkbox").hasClass("jquery-safari-checkbox-checked")){
   //Do something
   return false;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T19:08:47.937

你不必做任何特别的事情。原始复选框仍然存在并保持其状态。当您单击花哨的复选框时，插件会更新隐藏的复选框以匹配当前状态。

如果您使用最新的 jQuery，您也可以稍微更新您的代码。您的代码已经过时了：

```
$('#Button').click(function () {
    if (!$('input[name=image_id]').prop('checked')) {
        //Do something
        return false;
    }
}); 
```

演示：http: [//jsfiddle.net/k2d6E/](http://jsfiddle.net/k2d6E/)

# ant - 启用 groovy 的 AntBuilder 的详细输出

> ID：15143221
> 
> 赞同：6
> 
> 时间：2013-02-28T18:44:16.290
> 
> 标签：ant, groovy, antbuilder

有没有办法为 groovy 的 AntBuilder 打开调试/详细输出？换句话说，我想启用更详细的输出，就像`ant -verbose`从命令行获得的那样。

我知道[记录器任务，如此](http://ant.apache.org/manual/Tasks/recorder.html)[处](https://stackoverflow.com/a/5233382/539048)所述，但这会写入文件，我想写入标准输出或可能的记录器（就像为[用 groovy 编写的 maven 插件](http://docs.codehaus.org/display/GMAVEN/Implementing+Maven+Plugins)提供的记录器一样）。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-28T18:50:24.050

[受谷歌第一个结果的](http://shrubbery.mynetgear.net/c/display/W/AntBuilder)启发（为 Groovy 简洁而重写）：

```
ant.project.buildListeners[0].messageOutputLevel = 4 
```

[此处记录了](https://ant.apache.org/manual/api/constant-values.html#org.apache.tools.ant.Project.MSG_DEBUG)值，其中 4 是最详细的。

# java - Android解析开户错误

> ID：15143226
> 
> 赞同：0
> 
> 时间：2013-02-28T18:44:33.153
> 
> 标签：java, android

我正在尝试通过 parse.com 开设一个新帐户：

[https://www.parse.com/docs/android_guide](https://www.parse.com/docs/android_guide)

但是，当我到达线路时：

user.setUsername("a");

然后它向我显示一个弹出窗口：“应用程序必须停止......”然后它退出

这是日志猫：

```
02-28 18:35:42.849: E/AndroidRuntime(1862): FATAL EXCEPTION: main
02-28 18:35:42.849: E/AndroidRuntime(1862): java.lang.ExceptionInInitializerError
02-28 18:35:42.849: E/AndroidRuntime(1862):     at com.parse.ParseUser.stripAnonymity(ParseUser.java:327)
02-28 18:35:42.849: E/AndroidRuntime(1862):     at com.parse.ParseUser.put(ParseUser.java:319)
02-28 18:35:42.849: E/AndroidRuntime(1862):     at com.parse.ParseUser.setUsername(ParseUser.java:274)
02-28 18:35:42.849: E/AndroidRuntime(1862):     at com.example.salebook.RegisterActivity$1.onClick(RegisterActivity.java:34)
02-28 18:35:42.849: E/AndroidRuntime(1862):     at android.view.View.performClick(View.java:4204)
02-28 18:35:42.849: E/AndroidRuntime(1862):     at android.view.View$PerformClick.run(View.java:17355)
02-28 18:35:42.849: E/AndroidRuntime(1862):     at android.os.Handler.handleCallback(Handler.java:725)
02-28 18:35:42.849: E/AndroidRuntime(1862):     at android.os.Handler.dispatchMessage(Handler.java:92)
02-28 18:35:42.849: E/AndroidRuntime(1862):     at android.os.Looper.loop(Looper.java:137)
02-28 18:35:42.849: E/AndroidRuntime(1862):     at android.app.ActivityThread.main(ActivityThread.java:5041)
02-28 18:35:42.849: E/AndroidRuntime(1862):     at java.lang.reflect.Method.invokeNative(Native Method)
02-28 18:35:42.849: E/AndroidRuntime(1862):     at java.lang.reflect.Method.invoke(Method.java:511)
02-28 18:35:42.849: E/AndroidRuntime(1862):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
02-28 18:35:42.849: E/AndroidRuntime(1862):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
02-28 18:35:42.849: E/AndroidRuntime(1862):     at dalvik.system.NativeStart.main(Native Method)
02-28 18:35:42.849: E/AndroidRuntime(1862): Caused by: java.lang.RuntimeException: You must call Parse.initialize(context, oauthKey, oauthSecret) before using the Parse library.
02-28 18:35:42.849: E/AndroidRuntime(1862):     at com.parse.ParseUser.checkApplicationContext(ParseUser.java:858)
02-28 18:35:42.849: E/AndroidRuntime(1862):     at com.parse.ParseUser.getCurrentUser(ParseUser.java:731)
02-28 18:35:42.849: E/AndroidRuntime(1862):     at com.parse.ParseUser.registerAuthenticationProvider(ParseUser.java:929)
02-28 18:35:42.849: E/AndroidRuntime(1862):     at com.parse.ParseAnonymousUtils.initialize(ParseAnonymousUtils.java:42)
02-28 18:35:42.849: E/AndroidRuntime(1862):     at com.parse.ParseAnonymousUtils.<clinit>(ParseAnonymousUtils.java:36)
02-28 18:35:42.849: E/AndroidRuntime(1862):     ... 15 more 
```

这是我的代码（我必须说服务器中不存在“a”用户名）

```
regbutton.setOnClickListener(new View.OnClickListener(){
            @Override
            public void onClick(View v) {
                ParseUser user = new ParseUser();
                user.setUsername("a");
                user.setPassword("a");
                user.setEmail("email@example.com");
                try {
                    user.signUp();
                } catch (ParseException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }
            }
        }); 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T18:46:56.207

在使用 Parse 库之前，您必须调用 Parse.initialize(context, oauthKey, oauthSecret)。

# mysql - 抑制 MYSQL 错误 1452

> ID：15143231
> 
> 赞同：0
> 
> 时间：2013-02-28T18:44:39.893
> 
> 标签：mysql, mysql-error-1452

我有一个用来保存每日股票相关数据的表，价格日期是我日历表的外键。日历表列出了**不包括周末**的所有有效日期。我刚刚获得了 20 年的每日货币兑换数据，而且似乎至少包括一些周末。我已经为**所有内容**创建了带有插入命令的脚本，知道我会在周末记录中收到错误 1452（表示外键约束失败）。我对此完全没问题，因为 mysql 会尝试插入记录，失败，然后继续。问题是对于所有数千个插入错误，错误消息都会回显到控制台。所有这些额外的标准输出打印大大减慢了我的第一个插入脚本（仅 1 年，至少需要 10 分钟）。

如何抑制此错误消息？请不要说错误消息是“告诉我一些重要的事情”或者我应该“注意它”或者我应该“调试我的脚本”。我确切地知道为什么会出现错误，并且只是想压制它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T19:03:28.397

你可以尝试使用[`INSERT IGNORE`](http://dev.mysql.com/doc/refman/5.6/en/insert.html)

例如：

```
INSERT IGNORE INTO myTable (myColumn) values ('myValue'); 
```

应该抑制您的错误消息...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-12-16T18:34:48.627

打开 MySQL 控制台并运行：

```
SET GLOBAL FOREIGN_KEY_CHECKS=0; 
```

完成后，撤消它：

```
SET GLOBAL FOREIGN_KEY_CHECKS=1; 
```

# asp.net-mvc - MVC 控制器是否保存状态？

> ID：15143234
> 
> 赞同：2
> 
> 时间：2013-02-28T18:44:46.427
> 
> 标签：asp.net-mvc

在 MVC 模式中，控制器是否适合以任何方式保存状态。

请注意，我意识到控制器不会在 ASP.Net 上保存状态。我没有使用 ASP.Net。我想知道这种模式是否限制了这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T18:48:44.007

该模式会让您将状态保存到模型/模型，而不是控制器。控制器*可以*修改状态，或者模型可以包含内部来修改它自己的状态。

# java - 更改 JTabbedPane 的外观

> ID：15143241
> 
> 赞同：1
> 
> 时间：2013-02-28T18:45:06.217
> 
> 标签：java, swing, ms-word, look-and-feel, jtabbedpane

![JTabbedPane](../Images/bf88697ed1186af4a1786d6ef57ef315.png) ![女士丝带](../Images/a828bd5d181c6164a97452aa7c78d4a9.png)

我非常了解如何使用 a`JTabbedPane`但它看起来不像您在 MS Word 的功能区中获得的选项卡。我想知道是否有一种方法可以使`JTabbedPane`外观看起来像 MS Word 中的功能区（或任何其他改变其外观的方法）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-28T18:56:03.910

是的，这取决于外观和感觉。[Substance](http://java.net/projects/substance/)具有您想要的外观和感觉。您也可以拥有一个完整的开源功能区组件，请参阅此问题：

[如何在 Java 程序中获取“功能区”UI 组件，如 Office 2007 中的？](https://stackoverflow.com/questions/1530363/how-to-get-a-ribbon-ui-component-like-in-office-2007-in-a-java-program)

请注意，[Insubstantial](https://github.com/Insubstantial/insubstantial)是 Substance 的一个分支，它被积极维护。看到这个：[https ://stackoverflow.com/questions/5898028/what-happened-to-the-substance-laf](https://stackoverflow.com/questions/5898028/what-happened-to-the-substance-laf)

# ruby-on-rails - Ruby - 如何创建动态模型属性？

> ID：15143242
> 
> 赞同：0
> 
> 时间：2013-02-28T18:45:07.533
> 
> 标签：ruby-on-rails, ruby, arrays, model, attributes

我有一个带有模型属性的数组（这些模型属性是数据库表中的列）。我正在尝试遍历这个数组并自动创建一条我想保存到数据库表的记录，如下所示：

```
columns.each_with_index do |c, i|
  user.c = data[i]
  puts user.c
end 
```

`user`是模型。但是如果我尝试上面的代码片段，我会得到

```
undefined method `c=' for #<User:0x007f8164d1bb80> 
```

我也试过

```
columns.each_with_index do |c, i|
  user."#{c}" = data[i]
  puts user."#{c}"
end 
```

但这也行不通。

数组中的数据`columns`取自发送用户的表单，所以我只想保存他发送给我的数据，但我仍然无法弄清楚......

我想请你帮忙......提前谢谢你！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T18:47:41.850

```
user.send("#{c}=".to_sym, data[i]) 
```

此外，您可以将属性作为散列访问。

```
user.attributes[c] = data[i] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T18:48:58.807

最好的办法可能是构建一个哈希并使用 update_attributes：

```
mydata = {}
columns.each_with_index{|c, i| mydata[c] = data[i]}
user.update_attributes(mydata) 
```

这样您就可以保留`attr_accessible`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T18:54:56.633

如果这实际上是在控制器中，您可以使用一些基本的 rails 约定并像这样构建用户记录：

```
@user = User.new(params[:user])
if @user.save
  # do something
else
  # render the form again
end 
```

尽管您可以使用 设置值`send`，但我同意@DaveS 您可能希望通过`attr_accessible`s 保护自己。如果您计划使用 Rails 4，[这里有一个很好的概述](http://rubysource.com/rails-4-quick-look-strong-parameters/)。

# java - 需要帮助的菜鸟如何在 Java 中退出我的程序

> ID：15143246
> 
> 赞同：3
> 
> 时间：2013-02-28T18:45:33.247
> 
> 标签：java

我不明白我应该如何让这个程序停止。基本上它想要我做的是当我输入 -1 时程序关闭。我只是不知道怎么做。哦！“sida”在瑞典语中的意思是边。不知道有没有用！在这里得到你们的帮助会很棒！

```
import java.util.Scanner;
public class triangle
{

//Triangle is going up
public static void triangelUpp(int sida)
{

    for(int i = 0; i <= sida; i++)
    {
        for(int j = 1; j <= i; j++)
        System.out.print("*");
        System.out.println();
    }       
}

//Triangle going down
public static void triangelNed(int sida)
{

    for(int i = 0; i <= sida; i++)
    {
        for(int j = 1; j <= sida - i; j++)
        System.out.print("*");
        System.out.println();
    }       
}

public static void main(String[] args)
{

    //Variables 
    Scanner keyboard = new Scanner(System.in);
    int vinkel = 0;
    int sida = 0;

    //Rules
    while(sida !=-1)
    {
        if(vinkel == 0)
            triangelNed(sida);

        else if(vinkel == 1)
            triangelUpp(sida);

    System.out.println("Write the length of the triangle and end with -1");
    sida = keyboard.nextInt();

    System.out.println("Is the angle going to be up(1) or down?(0)");
    vinkel = keyboard.nextInt();

    }

}

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-28T18:53:49.240

最简单的方法：更改`while-loop`to`while(true)`然后在分配 sida 之后：`if (sida < 0) { break; }`

换句话说：

```
while(true) {
    //some logic here...
    sida = keyboard.nextInt();
    //if (sida < 0) {
    //since you don't like the regular approach, changing it to fit your odd needs
    if (sida == -1) {
        //breaks the while loop
        break;
    }
    //rest of code...
} 
```

使用`System.exit(0)`只会终止进程，显示示例

```
while(true) {
    //code here...
    //same here
    //if (sida < 0) {
    if (sida == -1) {
        //comment/uncomment the options to see the program behavior
        //using this, the message after the while loop will be printed
        break;
        //using this, the message after the while loop won't be printed
        //System.exit(0);
    }
}
System.out.println("Thanks! See ya later"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T19:07:21.290

与问题无关，编程时最好的办法是用英文写你的变量和注释。

但是break确实是最好的方法。虽然我会检查它是否等于 -1 而不是小于 0。（这是对 Luigi Mendoza 的回答的补充）

```
if (sida == -1) { 
```

而不是

```
if (sida < 0) { 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-28T18:48:11.617

要退出程序，您可以使用 system.exit(0);

# php - max_num_pages 返回帖子数而不是页数

> ID：15143248
> 
> 赞同：0
> 
> 时间：2013-02-28T18:45:40.487
> 
> 标签：php, ajax, wordpress

我正在使用 PBD Load Next Post 插件，它运行良好，但我无法弄清楚为什么 max_num_pages 返回 44（该类别中的帖子数）而不是 4（应该是页数）。以下是所有应该相关的代码：

[http://pastebin.com/ezAbD2eH](http://pastebin.com/ezAbD2eH)

这是它正在运行的页面：garthreckers(dot)com/category/united-states/（抱歉，没有足够的代表发布另一个完整链接）

它也在欧洲页面上运行，但在那里返回 20 个（再次发布帖子数量）。

此外， if(mobile...) 来自 mooble 插件，如果这有所作为。我已经尝试剥离代码并停用它，但它仍然无法正常工作。

任何帮助都会很好，因为我已经尝试解决这个问题 3 天了，但没有成功。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T19:07:00.847

我可能发现了你的问题。目前在您的 PHP 代码中显示所有帖子时，您有一个需要类别的查询

```
wp_list_categories('show_option_none=&orderby=name&show_count=1&hide_empty=1&use_desc_for_title=1&child_of='.$cat.'&title_li='); 
```

目前，这是基于类别列表编号显示 max_num_pages 的数字。我会更改您显示帖子的方式，以便它不使用 wp_list_categories 来检索它们。

参考：[http ://codex.wordpress.org/Template_Tags/get_posts](http://codex.wordpress.org/Template_Tags/get_posts)

```
<?php
$args = array( 'numberposts' => 3 );
$lastposts = get_posts( $args );
foreach($lastposts as $post) : setup_postdata($post); ?>
    <h2><a href="<?php the_permalink(); ?>"><?php the_title(); ?></a></h2>
    <?php the_content(); ?>
<?php endforeach; ?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-03T04:36:04.767

我知道这可能不是最好的方法，但是如果您愿意，可以更改 javascript 中的默认数字作为解决方法

你的 JS [http://pastebin.com/ezAbD2eH](http://pastebin.com/ezAbD2eH)

第 58 行：

```
var max = parseInt(pbd_alp.maxPages); 
```

改成：

```
var max = parseInt(pbd_alp.maxPages/12);  //divide it by the number of posts per page. 
```

如果您愿意，您可以将其设置为变量并在 $arg 所在的其他地方使用它，以便全局设置该数字。在 PHP 部分中设置 $posts_per_page = 12。

```
var max = parseInt(pbd_alp.maxPages/<?php echo $posts_per_page; ?>); 
```

# python - 是否有关于 scipy、numpy、pandas、scikit 生态系统中包之间相互依赖关系的文档？Python

> ID：15143253
> 
> 赞同：3
> 
> 时间：2013-02-28T18:45:54.583
> 
> 标签：python, numpy, scipy, pandas, scikit-learn

是否有任何关于 scipy、numpy、pandas、scikit 生态系统中包之间的相互依赖关系和关系的文档？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-28T19:15:54.100

AFAIK，这里是依赖树（numpy 是一切的依赖）：

*   麻木的
    *   scipy
        *   scikit-学习
    *   熊猫

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-29T14:34:10.063

[Anaconda](http://docs.continuum.io/anaconda/pkgs.html) 有很好的 conda-meta 文件，列出了 100 多个包的要求。
这个[gist](https://gist.github.com/denis-bz/6194276)有一个简短的 shell 脚本来总结这些信息；比如八月份（不包括numpy）——

```
pandas-0.11.0-np17py27_1.json       dateutil 2.1     pytz 2013b     scipy 0.12.0
statsmodels-0.4.3-np17py27_1.json   pandas 0.11.0    scipy 0.12.0
... 
```

# cakephp - CakePHP 缺少控制器语言路径

> ID：15143254
> 
> 赞同：0
> 
> 时间：2013-02-28T18:45:55.097
> 
> 标签：cakephp

我将 CakePHP 应用程序从一台服务器移动到另一台服务器，但在新服务器上运行会出现此错误，请记住 ita 是语言路径，其中 URL 看起来像这样 [http://www.c2cistanbul.com/ita/post /263](http://www.c2cistanbul.com/ita/post/263)

缺少控制器错误：找不到 ItaController。错误：在以下文件中创建类 ItaController：app/controllers/ita_controller.php

```
<?php
class ItaController extends AppController {

    var $name = 'Ita';
}
?> 
```

注意：如果要自定义此错误消息，请创建 app/views/errors/missing_controller.ctp

路线

```
Router::connect('/pages/*', array('controller' => 'pages', 'action' => 'display'));
$par = Router::parse(substr($_SERVER['REQUEST_URI'],6));
Router::reload();
Router::connect('/',  array('controller' => 'site', 'action' => 'home','ita'));
Router::connect('/admin', array('controller' => 'utente', 'action' => 'logged'));
$url = array('home');   
if (in_array($par['controller'],$url))
{
    Router::connect($par['controller'].'/*/', array('controller' => 'site','action' => $par['controller']));
}

$lang = array('ita', 'eng', 'deu', 'rus','fra');
if (in_array($par['controller'], $lang)){
    Router::connect('/ita/_(.*)', array('controller' => 'site', 'action' => 'stdpage','ita',$par['action'],));
    Router::connect('/eng/_(.*)', array('controller' => 'site', 'action' => 'stdpage','eng',$par['action']));
    Router::connect('/fra/_(.*)', array('controller' => 'site', 'action' => 'stdpage','fra',$par['action']));
    Router::connect('/rus/_(.*)', array('controller' => 'site', 'action' => 'stdpage','rus',$par['action']));

    Router::connect('/ita/', array('controller' => 'site','action' => 'home','ita'));
    Router::connect('/eng/', array('controller' => 'site','action' => 'home','eng'));
    Router::connect('/fra/', array('controller' => 'site','action' => 'home','fra'));
    Router::connect('/rus/', array('controller' => 'site','action' => 'home','rus'));

    Router::connect('/ita/'.$par['action'].'/*/', array('controller' => 'site','action' => $par['action'],'ita'));
    Router::connect('/eng/'.$par['action'].'/*/', array('controller' => 'site','action' => $par['action'],'eng'));
    Router::connect('/fra/'.$par['action'].'/*/', array('controller' => 'site','action' => $par['action'],'fra'));
    Router::connect('/rus/'.$par['action'].'/*/', array('controller' => 'site','action' => $par['action'],'rus')); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T08:16:51.330

明白了，谢谢大家，错过了

```
$par = Router::parse(substr($_SERVER['REQUEST_URI'],6)); 
```

对于那个很抱歉。

# c# - 无法加载在引用中可见的程序集 (.DLL)

> ID：15143255
> 
> 赞同：2
> 
> 时间：2013-02-28T18:45:56.327
> 
> 标签：c#, visual-studio-2010, dll, oauth

如屏幕截图所示，VS 2010 无法加载我的 OAuth 参考，尽管它就在我的参考文件夹中。我究竟做错了什么？我已经重新启动了 VS 2010。

![在此处输入图像描述](../Images/932034b20f2bba1a999fe5646d51d405.png)

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-28T18:50:14.487

程序集（DLL）*不一定*需要为命名空间使用与 DLL 名称相同的名称。这意味着您的程序集 ( `EvernoteOAuthNet.dll`) 可能使用完全不同的命名空间结构，即：`Evernote.OAuth`。您可以双击引用中的程序集以在对象浏览器中查看它，并检查它包含的类型，包括它们的命名空间。这可以帮助您为您的`using`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-28T19:07:48.083

问题是 VS 2010 每次我尝试构建时都会删除程序集。我找到了解决方案：

您需要将目标框架从“.NET Framework 4 Client Profile”更改为“.NET Framework 4”

参考。 [http://social.msdn.microsoft.com/Forums/en-US/vststest/thread/1537c41b-52b9-4e47-91b2-2e38b8fdfbfa/](http://social.msdn.microsoft.com/Forums/en-US/vststest/thread/1537c41b-52b9-4e47-91b2-2e38b8fdfbfa/)

# jsp - 通过 JSTL 从数据库动态填充下拉菜单

> ID：15143256
> 
> 赞同：0
> 
> 时间：2013-02-28T18:46:01.387
> 
> 标签：jsp, jstl, jsp-tags

我的网络应用程序有以下设置：

1.) 一个 Bean 类。
2.) 一个 DAO 类，它返回一个包含 Bean 的数组列表。
3.) 具有下拉菜单的 JSP 页面。

我需要从步骤 2 中创建的 arraylist 填充这个下拉菜单。我对 JSTL 了解不多。我设法通过 scriptlet 填充我的下拉菜单（使用每个循环并迭代存储在会话中的 arraylist）。
现在我需要从 scriptlet 中释放我的代码。我应该学习 JSTL 还是使用 AJAX（或 jquery）？`<jsp:useBean>`如果我打算使用标签，我是否还需要先调用一个 servlet 来返回一个数组列表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T18:56:47.257

```
<select>
     <c:forEach var="item" items="${list}">
          <option><c:out value="${item}"/></option>
     </c:forEach>
</select> 
```

关于你的第二个问题。是的，您可以调用 request.setAttribute(...) 并使用 RequestDispatcher 转发到 JSP 页面，然后该页面使用 useBean 标记。

# ms-access - 使用 VBA 从 tns 文件中获取 Service_Name

> ID：15143257
> 
> 赞同：0
> 
> 时间：2013-02-28T18:46:03.603
> 
> 标签：ms-access, oracle11g, vba

有没有办法使用 VBA 从 TNS 文件中提取 Service_Name？因为任何人都可以为他们的 TNS 条目命名任何他们想要的名称——我的直通查询在他们的计算机上不起作用。

如果有办法通过使用 TNS 条目本身而不是 SERVICE_NAME 来设置查询 - 那也可以。我只是想确保我的数据库在任何方面都不是特定于计算机的。

例如，这是我的无 DSN 连接字符串

> [ODBC] DRIVER={Oracle in Oracle1}
> UID=username
> Pwd=password DBQ=myTNSEntryName.ourcompany.com
> Trusted_Connection=Yes
> server= (DESCRIPTION= (ADDRESS= (PROTOCOL=TCP)
> (HOST=ourhost.ourcompany.com) (PORT =9999) )
> (CONNECT_DATA= (SERVICE_NAME=myTNSEntryName.ourcompany.com)
> )

这是我的 TNS 条目

> myTNSEntryName.ourcompany.COM=
> (DESCRIPTION=
> (ADDRESS=
> (PROTOCOL=TCP)
> (HOST=ourhost.ourcompany.com)
> (PORT=9999)
> )
> (CONNECT_DATA=
> (SERVER=dedicated)
> (SERVICE_NAME=ourdatabasename.ourcompany.com)
> ) )

在 TNS 文件中，SERVICE_NAME 是我们的数据库名称，但由于我将 TNS 条目命名为 myTNSEntryName - 现在使用 report.ourcompany.com 作为 SERVICE_NAME 不起作用。

谢谢你

编辑：澄清一点，基本上我正在寻找一种方法来设置一个 DSN'less 连接字符串，然后我可以在 MS Access Pass-Through 查询的 PROPERTIES 和 Docmd 中的 ODBC CONNECT STR 行中使用它.Transfer数据库。

或者，找到一种方法来读取用户的 TNS 条目名称（不是数据库名称，而是他们选择的任何名称）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T19:26:59.857

`DBQ`参数是您要使用的 TNS 名称。Oracle ODBC 驱动程序不使用`SERVER`or`TRUSTED_CONNECTION`参数。Microsoft 的 ODBC Driver for Oracle 使用该`SERVER`参数。我不确定驱动程序可能会使用该`trusted_connection`参数或在 Oracle 上下文中可能会做什么（如果有的话）。这两个都应该被删除。

当然，Oracle ODBC 驱动程序的名称在不同机器上可能会有所不同，因为它包含 Oracle Home 的名称，用户可以在安装 Oracle 客户端时自由设置。如果您希望它在任意机器上工作，您需要询问 ODBC 驱动程序管理器（使用该`SQLDrivers`功能）或者您需要查询注册表项`HKEY_LOCAL_MACHINE\SOFTWARE\ODBC\ODBCINST.INI\ODBC Drivers`

# python - Pandas 中 DataFrame 的矩阵（位置）索引

> ID：15143258
> 
> 赞同：0
> 
> 时间：2013-02-28T18:46:04.617
> 
> 标签：python, pandas

假设我有以下数据框：

```
tmp = np.random.randn(10,4)
df = pd.DataFrame(tmp, index=pd.date_range('1/1/2012', periods=tmp.shape[0]), 
                 columns=['A', 'B', 'C', 'D'])

> b
                   A         B         C         D
2012-01-01  0.471846  1.130041 -0.614117  0.882738
2012-01-02 -1.431566  0.680617 -0.615331  0.288740
2012-01-03  0.398567 -0.115388 -0.869855 -1.273666
2012-01-04  0.379501  0.192329 -1.942184  0.694004
2012-01-05  1.306329 -0.803856  0.417033 -0.655907
2012-01-06 -0.599877  0.696549 -0.252789  1.367977
2012-01-07 -1.618916  0.216571 -0.499880  0.386853
2012-01-08  0.415002  0.139775  0.251842  0.021379
2012-01-09  2.536787  0.737672 -0.740485 -0.890189
2012-01-10 -1.553530 -0.100950 -0.237478 -0.295612 
```

我能怎么做：

1.  特定行/列的位置索引？（并获取对应的子**数据框**）
2.  行/列范围的位置索引？（并获取对应的子**数据框**）

## 对于单项矩阵索引：

例如，假设我想在位置索引子数据帧`[1,2]`（在 numpy “matricial” 表示法中）。输出应该是：

```
 C
2012-01-02 -0.615331 
```

我尝试了以下三种方法，但都没有奏效::

```
df[1,2]
df[1][2]
df.take([1])[2] 
```

唯一有效的方法似乎是：

```
df.ix[1,2]
df.irow(1)[2] 
```

但：

*   使用位置索引是危险的，因为如果我的索引是整数（与上述情况中的日期相反），`.ix`它将默认为**标签索引。**在此处查看更多信息：[开始：停止切片 numpy 和 Pandas 之间的不一致？](https://stackoverflow.com/questions/15125961/startstop-slicing-inconsistencies-between-numpy-and-pandas).

*   使用`irow`很麻烦，因为它需要从`()`符号切换到`[]`符号（`irow`返回一个`Series`对象）

## 对于范围矩阵索引：

例如，假设我想`[1:3,2:3]`在（numpy 矩阵符号）中的位置索引元素。输出应该是：

```
 B
2012-01-02 -0.615331  
2012-01-03 -0.869855 
```

请注意，我**不包括**停止**索引**（即我坚持使用 numpy 表示法）。

有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T22:00:46.960

这个经常要求的功能很快就会到位 [https://github.com/pydata/pandas/pull/2922](https://github.com/pydata/pandas/pull/2922) 如果你想用它进行测试，你可以把它从分支中拉出来

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-28T22:42:56.147

这是一种解决方法（直到@Jeff 提到的功能请求被提交）：

```
In [178]: df = pd.DataFrame(tmp, index=pd.date_range('2012-1-1', periods=tmp.shape[0]), columns='A B C D'.split())

In [179]: df.ix[df.index[1], df.columns[2]]
Out[179]: -0.3021434106214243

In [180]: df.ix[df.index[1:3], df.columns[2:3]]
Out[180]: 
                   C
2012-01-02 -0.302143
2012-01-03 -1.430387 
```

这表明即使使用打乱的整数索引，语法也以相同的方式工作：

```
In [206]: df2 = df.reset_index(drop=True)

In [207]: index = range(10)

In [208]: import random

In [209]: random.shuffle(index)

In [210]: df2.index = index

In [212]: df2.ix[df2.index[1], df2.columns[2]]
Out[212]: -0.3021434106214243

In [213]: df2.ix[df2.index[1:3], df2.columns[2:3]]
Out[213]: 
          C
7 -0.302143
2 -1.430387 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-11T09:52:53.103

来自熊猫文档：

Pandas 提供了一套方法来获得纯粹的基于整数的索引。语义紧跟 python 和 numpy 切片。这些是基于 0 的索引。切片时，包括起始边界，而排除上限。尝试使用非整数，即使是有效标签也会引发 IndexError。

.iloc 属性是主要的访问方法。以下是有效输入：

整数，例如 5 整数列表或数组 [4, 3, 0] 整数 1:7 的切片对象

# batch-file - 将标志添加到批处理脚本

> ID：15143259
> 
> 赞同：12
> 
> 时间：2013-02-28T18:46:05.090
> 
> 标签：batch-file, flags

我正在编写一个将在目录上运行的批处理脚本。我希望能够添加一个标志（例如 -r 或 /r 或类似的东西），这将使脚本运行文件夹树而不是单个目录。是否可以使用批处理添加标志选项？

谢谢

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-02-28T19:17:04.540

当然有可能。命令行参数以 %1、%2 等形式传入批处理文件（%0 是批处理文件的名称。）

```
IF "%1"=="/r" ECHO You passed the /r flag. 
```

用于`SHIFT`删除第一个参数并将所有其他参数移动一个。如果您想允许 /r 出现在命令行中的任何位置，您可以使用它来变得更漂亮。例如：

```
:processargs
SET ARG=%1
IF DEFINED ARG (
    IF "%ARG%"=="/r" ECHO You passed the /r flag.
    SHIFT
    GOTO processargs
) 
```

或者在这样的循环中使用`%*`（扩展到整个参数列表） ：`FOR`

```
FOR %%A IN (%*) DO (
    IF "%%A"=="/r" ECHO You passed the /r flag.
) 
```

# python - Python v2.6 用小数（货币）四舍五入？

> ID：15143260
> 
> 赞同：0
> 
> 时间：2013-02-28T18:46:06.423
> 
> 标签：python

所以我对 Python 很陌生，并且有一个关于四舍五入的问题。

```
product_price = '79.98'
subtotal = Decimal(product_price)
cal_tax = '0.0825'
tax_conv = Decimal(cal_tax)
tax_total = subtotal * tax_conv
total_tax = round(tax_total, 2)
print total_tax
self.assertEqual(total_tax, '6.60') 
```

total_tax 返回`6.6`，断言失败：

```
AssertionError: u'6.60' != 6.5999999999999996 
```

我确信我犯了一个新手错误。在这种情况下，我希望 'total_tax' 通过我的断言四舍五入到 6.60。我将不胜感激任何人提供的任何提示。再次感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T18:48:29.420

不要`round`在小数上使用，`round`返回`float`. 使用`quantize`：

```
total_tax = tax_total.quantize(Decimal('0.01')) 
```

然后将其与另一个进行比较`Decimal`：

```
self.assertEqual(total_tax, Decimal('6.60')) 
```

如果要严格四舍五入，请像这样量化：

```
from decimal import Decimal, ROUND_UP
total_tax = tax_total.quantize(Decimal('0.01'), rounding=ROUND_UP) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T18:48:32.230

`round`正在返回一个无法准确表示该数字的浮点数`6.6`。然后你将它与一个导致比较失败的字符串进行比较......（因为字符串和浮点数永远不会比较相等）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T18:48:40.327

您正在比较一个字符串和一个浮点值。

你有两个选择：

1.  格式`total_tax`也为字符串；这将自动将浮点值四舍五入到所需的位数：

    ```
    self.assertEqual(format(total_tax, '.02f'), '6.60') 
    ```

2.  将`total_tax`值与浮点文字进行比较，但有一个容差（因为浮点不精确）：

    ```
    self.assertTrue((total_tax - 6.60) < 0.01) 
    ```

# c# - C# 中的 SQL 查询不支持希伯来语

> ID：15143262
> 
> 赞同：5
> 
> 时间：2013-02-28T18:46:10.407
> 
> 标签：c#, sql

使用希伯来语进行 SQL 查询时遇到问题：

```
"select ProductName From Products WHERE TypeOfProduct ='מעבד'" 
```

我已经`TypeOfProduct`设置，它的值是 'מעבד'，但查询返回`null`.

如果我用数字或英文单词替换希伯来语单词，一切都会好起来的。

**如何在 SQL 查询中使用希伯来语？**

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-28T18:48:20.433

您应该在 where 子句中使用字符串之前的“N”前缀，即 N'מעבד' 来使用 Unicode...

```
 select ProductName From Products WHERE TypeOfProduct = N'מעבד' 
```

您还需要确保您的列是 type`nvarchar`而不是`varchar`.

如果不能使用`nvarchar`Unicode 字符串，则必须将数据库的排序规则从 更改`LATIN`为`HEBREW`.

# ios - 添加子视图控制器并更改其标签

> ID：15143265
> 
> 赞同：2
> 
> 时间：2013-02-28T18:46:15.560
> 
> 标签：ios, objective-c, xcode, storyboard

我的故事板中有一个名为 IntroViewController 的视图控制器，我想将其作为子级添加到另一个视图控制器，如下所示：

```
 IntroViewController *introViewController = [self.storyboard instantiateViewControllerWithIdentifier:@"View1"];
     [introViewController.textLabel setText:@"test"];
     [self addChildViewController:introViewController]; 
```

在 IntroViewController 上，我在情节提要中放置了一个名为 textLabel 的标签，如果我运行程序，它可以工作并向我显示视图控制器，但文本不会改变。知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T18:52:55.620

当您从情节提要中实例化视图控制器时，视图不会加载，直到它实际呈现在屏幕上。在您发布的代码中，您发布`introViewController.textLabel`的内容为零。

您可以做的一个选择是向您的`IntroViewController`类添加一个属性，然后设置：

```
introViewController.initialText = @"test"; 
```

然后，在`-viewDidLoad`您`IntroViewController`的标签内部将被实例化，以便您可以拨打电话：

```
[self.textLabel setText:self.initialText]; 
```

还值得注意的是，在大多数情况下，建议使用视图控制器来为其拥有的视图设置值，而不是其他视图控制器。

# css - css：在一个段落中的行之间创建空白

> ID：15143266
> 
> 赞同：0
> 
> 时间：2013-02-28T18:46:20.437
> 
> 标签：css

我有一个可变宽度的多行段落。每行的背景应该是纯色，但在两行之间我想看到背景图像。

示例： http: [//piccsy.com/2012/03/the-ysp-herself](http://piccsy.com/2012/03/the-ysp-herself)

我试图设置，`line-height`但这不会在行之间创建空间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T18:53:42.940

试试这个 ：

```
span {
    background-color:grey;
    font-size:14px;
    line-height:18px;
} 
```

[在这里摆弄](http://jsfiddle.net/YaB5j/)

# android - 如何通过代码将apk文件复制到我的SD卡？

> ID：15143269
> 
> 赞同：0
> 
> 时间：2013-02-28T18:46:32.433
> 
> 标签：android, backup, apk, sd-card

我想创建一个类似于“应用程序备份和恢复”的应用程序，它将 apk 文件从 /data/app 存储到 sdcard，然后在我们选择恢复时重新安装它。

如何才能做到这一点？

# sql - SQL MIN_ACTIVE_ROWVERSION() 值长时间不变

> ID：15143275
> 
> 赞同：16
> 
> 时间：2013-02-28T18:46:47.257
> 
> 标签：sql, sql-server, transactions, data-synchronization, rowversion

我们正在通过链接服务器连接对两个 SQL Server 数据库、不同服务器（均为 SQL Server 2008 Enterprise 64 位 SP2 - 10.0.4000.0）中的一种同步框架进行故障排除，我们达到了排序的点卡住了。

识别哪些是“待同步”记录的逻辑当然是基于`ROWVERSION`值，包括`MIN_ACTIVE_ROWVERSION()`避免脏读的使用。

所有`SELECT`操作都封装在每个“源”端的 SP 中。这是一个 SP 的示意图示例：

```
 PROCEDURE LoaderRetrieve(@LastStamp bigint, @Rows int)
    BEGIN
    ...
    (vars handling)
    ...

    SET TRANSACTION ISOLATION LEVEL SNAPSHOT

    Select TOP (@Rows) Field1, Field2, Field3
    FROM Table
    WHERE [RowVersion] > @LastStampAsRowVersionDataType    
    AND [RowVersion] < @MinActiveVersion  
    Order by [RowVersion] 

    END 
```

该方法工作得很好，我们通常以 600k/小时的预期速率同步记录（作业每 30 秒，批量大小 = 5k），但在某些时候，同步过程找不到任何要传输的单条记录，即使有几千条记录的`ROWVERSION`值大于`@LastStamp`参数。

在检查原因时，我们发现`MIN_ACTIVE_ROWVERSION()`的值小于（或略大于，仅 5 或 10 个增量）`@LastStamp`正在搜索的值。这当然不应该是一个问题，因为`MIN_ACTIVE_ROWVERSION()`引入该方法是为了避免脏读和后期问​​题，**但是**：

我们在某些情况下看到的问题，在上述场景发生期间，是`MIN_ACTIVE_ROWVERSION()`在很长（非常长）的时间段内，例如 30/40 分钟，有时超过一小时，的值不会改变。而这个价值远远低于`@@DBTS`价值。

我们首先认为这与尚未提交的待处理数据库事务有关。根据关于`MIN_ACTIVE_ROWVERSION()`（[链接](http://msdn.microsoft.com/en-us/library/bb839514.aspx)）的 MSDN 定义：

> *返回当前数据库中的最低活动 rowversion 值。如果在尚未提交的事务中使用 rowversion 值，则它是活动的*。

但是在此问题期间检查会话 ( `sys.sysprocesses`)*`open_tran > 0`*时，我们找不到任何等待时间大于几秒的会话*，*只有一两次出现 +/- 5 分钟的*等待*时间会话。

**所以在这一点上，我们正在努力理解这种情况：`MIN_ACTIVE_ROWVERSION()`在很长一段时间内没有变化，并且在这个时间范围内没有发现长时间等待的未提交事务。**

我不是 DBA，可能是我们在图片中遗漏了一些东西来分析这个问题，在论坛和博客上做一些研究找不到任何其他线索。到目前为止， open_tran > 0 是正当的原因，但在我暴露的情况下，很明显还有别的东西，不知道为什么。

任何反馈表示赞赏。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-07T04:15:44.953

好吧，我在挖掘更多之后终于找到了解决方案。

问题是我们正在寻找等待时间较长的*会话*，但真正的问题是找到一段时间以来具有*活动批次*的会话。

如果有一个会话，其中 open_tran = 1，要准确获取该事务何时打开（当然仍然处于活动状态，尚未提交），`sys.sysprocesses`则应检查 last_batch 字段。

使用此查询：

```
 select 
    batchDurationMin= DATEDIFF(second,last_batch,getutcdate())/60.0,
    batchDurationSecs= DATEDIFF(second,last_batch,getutcdate()),
    hostname,open_tran,* from sys.sysprocesses a
    where spid > 50
    and a.open_tran >0  
    order by last_batch asc 
```

我们可以识别一个开放 tran 活跃 30 分钟以上的会话。通过主机名值和 Web 服务中的更多检查（以及使用`dbcc inputbuffer`），我们找到了负责的进程。

所以，最后一个问题实际上是“确实存在一个带有未提交事务的活动会话”，因此`MIN_ACTIVE_ROWVERSION()`不会改变。我们只是在寻找具有错误标准的流程。

既然我们知道哪个过程的行为是这样的，下一步将是改进它。

希望这个结果对其他人有用。

# jquery - 如何在 Twitter Bootstrap 中从一个选项卡链接到另一个选项卡？

> ID：15143287
> 
> 赞同：2
> 
> 时间：2013-02-28T18:47:10.557
> 
> 标签：jquery, html, twitter-bootstrap, tabs, custom-data-attribute

假设您有几个使用 Twitter Bootstrap 创建的选项卡。如何在同一页面上从一个选项卡链接到另一个选项卡？

例如，假设在我的第一个选项卡上，我想链接到我的第二个选项卡。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-02T13:13:54.927

建议的解决方案的轻微变体，更适合我：

HTML：

```
<a class="btn" href="#login-signup" data-toggle="destination-tab">Sign up</a> 
```

JS：

```
$(document).on('click', 'a[data-toggle="destination-tab"]', function(event) {
    event.preventDefault();
    var hash = this.href.replace(/^.+#/, '#');
    $('a[href="' +hash+ '"][data-toggle=tab]:first').click();
}); 
```

此版本的优点是能够使用 href 属性进行链接，确保您“单击”的链接实际上是一个切换选项卡的链接，并且（并非不重要）限制了链接的数量。一。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T18:47:10.557

在官方 Bootstrab Git repo 上有一个关于这个的[问题。](https://github.com/twitter/bootstrap/issues/3319)Fat 的回答花了我一秒钟的时间才弄清楚，我想让它相对容易扩展。

这是一些代码和一个工作小提琴。

```
$("a[data-tab-destination]").on('click', function() {
    var tab = $(this).attr('data-tab-destination');
    $("#"+tab).click();
}); 
```

除了使用上面的 jquery 之外，您还必须为每个选项卡锚点指定一个 ID：

```
<ul class="nav nav-tabs" id="myTabs">
  <li class="active"><a id="tab-1" href="#one" data-toggle="tab">TAB #1</a></li>
  <li><a href="#two" id="tab-2" data-toggle="tab">TAB #2</a></li>
  <li><a href="#three" id="tab-3" data-toggle="tab">TAB #3</a></li>
</ul> 
```

然后在自定义数据属性中引用该 ID，如下所示：

```
<a data-tab-destination="tab-2">Go to Tab #2</a> 
```

这是一个工作小提琴：http: [//jsfiddle.net/technotarek/3hJ46/](http://jsfiddle.net/technotarek/3hJ46/)

# php - SQL 在 MySQL 和 PHP 中实现多个类别的 nn 关系

> ID：15143291
> 
> 赞同：0
> 
> 时间：2013-02-28T18:47:33.627
> 
> 标签：php, mysql, sql

我想知道需要传递什么 SQL 来实现一篇文章的多个类别。

我创建了 3 个表。

```
ARTICLES:
id, title, content

CATEGORIES:
id, name

RELATION:
article_id, cat_id 
```

我成功地创建了前两个表，并在用户提交表单时将数据存储在其中。但是，我不知道如何更新`RELATION`表格。我在stackoverflow上进行了搜索，我了解到我需要使用多对多关系。我对此有想法。但是，我不知道如何实际操作，即 SQL。

发布帖子时显然添加了类别，因此我需要在前两个表更新后才更新此表。

如果有人可以指导我进行教程或正确的方向，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T18:53:38.320

这应该由您的 SQL DBMS 处理。例如，如果您将关系的外键设置为级联删除或更新，当父项发生更改时，子项也将被删除/更新。您能否给我一个示例，说明您希望对前两个表进行的更新以及对 RELATION 表的结果更新？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T19:20:19.810

假设**帖子**和**文章**是同义词，那么每次发布新帖子并确定其类别时，您需要将一条记录“插入”到“关系”表中。

当您最初创建表时，您需要识别**主**键和**外**键 (CONSTRAINTS) 并（如果需要）指定是否`CASCADE`应启用。

显然您已经知道如何处理`CREATE`表格和`INSERT`行。

您可能希望谷歌搜索 PRIMARY KEY、FOREIGN KEY、CASCADE ON DELETE 以及 MYSQL 和 PHP。

另请参阅以下内容是否有帮助：[如何在 mysql 中删除级联？](https://stackoverflow.com/questions/511361/how-do-i-use-on-delete-cascade-in-mysql).

# android - 如何在 45 秒时发出哔声

> ID：15143292
> 
> 赞同：-1
> 
> 时间：2013-02-28T18:47:38.483
> 
> 标签：android, call, alert, duration

如何创建一个 Android 应用程序以在接近 1 分钟标记之前发出哔声（比如说在 45 秒，只是让用户知道的哔声，在它过去一分钟前 15 秒）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T19:01:24.383

为此，您可以使用本机 MediaPlayer。

```
 new CountDownTimer(//put time required here) {

    @Override
    public void onFinish() {
        timeUp();
    }

    @Override
    public void onTick(long millisUntilFinished) {
        //get time remaining here
    }

}.start(); 
```

使用 Uri soundUri = RingtoneManager.getDefaultUri(RingtoneManager.TYPE_NOTIFICATION); 创建一个 Uri

然后是铃声 - 并调用 play()。

# java - 创建一种方法来返回 DNA 链的 WC 互补序列

> ID：15143295
> 
> 赞同：1
> 
> 时间：2013-02-28T18:47:53.070
> 
> 标签：java

好的，所以我被要求创建一个方法补充WC()，它的工作原理如下：

```
public String complementWC() 
```

*返回 Watson Crick 补码，它是表示互补 DNA 链（即双螺旋中的另一条链）的字符串。因此，将所有 T 与 A 交换，将所有 A 与 T 交换，将所有 C 与 G 交换，将所有 G 与 C 交换。*

这就是我设法做到的：

```
private String dna;

    public String complementWC(){
        String dnaWC = "";
        for(int i=0;i<dna.length();i++){
            if(dna.charAt(i) == 'T'){
                dna.replace(dna.charAt(i), 'A');
            }
            if(dna.charAt(i) == 'A'){
                dna.replace(dna.charAt(i), 'T');
            }
            if(dna.charAt(i) == 'C'){
                dna.replace(dna.charAt(i), 'G');
            }
            if(dna.charAt(i) == 'G'){
                dna.replace(dna.charAt(i), 'C');
            }   
            dnaWC = dna;
        }
        return dnaWC;
    } 
```

现在，问题是这个方法只返回原始 dna 而不是 WCcomplement。所以，我不确定如何将 for 循环中的字符串存储到一个名为“dnaWC”的新字符串中。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-28T18:52:16.497

字符串是不可变的。当您调用 时`replace`，它返回一个新字符串，而不是更改原始字符串，并且您会立即忽略返回的字符串。这就是为什么您的原始字符串从未更改过的原因。

您可以使用 构建新字符串`StringBuilder`，这样可以节省每次替换字符时创建新字符串的开销，因为只会创建一个新字符串。

```
public String complementWC(){
    StringBuilder builder = new StringBuilder();
    for(int i=0;i<dna.length();i++){
        char c = dna.charAt(i);
        if(dna.charAt(i) == 'T'){
            builder.append('A');
        }
        if(dna.charAt(i) == 'A'){
            builder.append('T');
        }
        if(dna.charAt(i) == 'C'){
            builder.append('G');
        }
        if(dna.charAt(i) == 'G'){
            builder.append('T');
        }   
    }
    return builder.toString();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-07-02T20:43:48.650

的补码`G`是`C`(not `T`)。所以应该是...

```
 if(dna.charAt(i) == 'G'){
        builder.append('C');
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-11-30T15:36:33.517

```
public static String complementWC(String dna) {
    char[] chars = dna.toCharArray();
    for(int i = 0; i < chars.length; i++) {
        chars[i] = getComplement(chars[i]);
    }

    return new String(chars);
}

private static char getComplement(char c) {
    switch(c) {
        case 'A': return 'T';
        case 'T': return 'A';
        case 'C': return 'G';
        case 'G': return 'C';
    }

    return c;
} 
```

# javascript - 一个js循环结构的算法设计

> ID：15143303
> 
> 赞同：0
> 
> 时间：2013-02-28T18:48:20.300
> 
> 标签：javascript

我有一个数组`[1,2,3,4]`

我需要先遍历被选中的 [2]，设置他的样式，**然后再**遍历其他孩子并重置他们的样式。

目前，**我的算法**如下：

```
for item in array
    if item == chosenEl
        set chosen classes
for item in array
    if item != chosenEl
        reset chosen classes for the rest of the children 
```

或**咖啡**：

```
for item in @array
    if item.element is element
        item.selected = true
        item.element.classList.add @selectedClass
        item.element.focus()
for item in @array
    if item.element isnt element
        item.selected = false
        item.element.classList.remove @selectedClass 
```

由于框架中的一些限制，我需要设计这样的函数，而不是简单的 forElse 循环。

如何改进此代码？

谢谢你。

**说明**- 我需要这个设计的原因是因为重复调用了 2 个不同的函数，它们相互冲突。

我正在为 LG TV 开发一个应用程序。LG 电视有自己的库。现在在我的函数中，我设置了所选元素的样式。当我关注所选元素时，我激活了 LG TV onFocus 侦听器，该侦听器反过来控制所选样式。

因此，当我循环第二个或第三个孩子时，我再次设置已清除元素的选定样式。TLDR，但这就是循环如何相互冲突。一个人打断了另一个人的工作。

代码不是我写的。我进入了一个现有的项目，我还没有编写这个函数，所以我不能只删除 Focus() 函数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T18:52:52.100

而不是循环两次，考虑下面的代码

```
for item in array
{
    if item == chosenEl
    {
        set chosen classes
        continue; <--use this to return to next iteration without executing next statements
    } 
   reset chosen classes for the rest of the children
} 
```

它将是 O(n) 而不是 O(n) + O(n)

**编辑：**

对不起，我没看懂你的解释。如果您只需要一个可以重复调用的函数，那么就在这里，通过传递选定的值多次调用 resetStyles。请注意，由于您没有提供确切的数据类型，我假设它们是整数。

```
<script>
var resetStyles = function(selecteditem)
{
   var arr = [1,2,3,4];
   for(var i=0; i < arr.length; i++)
   {
      if(arr[i] == selecteditem)
      {
        //set class here

        continue;
      }
      //remove class here
   }
};
resetStyles(2);//call this by changing the values
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T18:51:30.867

为什么要循环两次？更容易做到：

```
for( var i=0, l=array.length; i<l; i++) {
    if( item == chosenEl) {
        // set styles
    }
    else {
        // clear styles
    }
} 
```

# ruby-on-rails - 删除由 SimpleForm 生成的选择字段的空白选项

> ID：15143306
> 
> 赞同：55
> 
> 时间：2013-02-28T18:48:27.617
> 
> 标签：ruby-on-rails

我有这段代码：

```
= f.input :category, :as => :select, :label => false, :collection => Choices["Categories"] 
```

Choices["Categories"] 只是 key=>value 对的散列。

SimpleForm 生成一个包含所有需要选项的选择字段，但它也使第一个选项为空。
此空白选项出现在 SimpleForm 生成的所有选择字段中。

但我不想有一个空白选项。有没有办法摆脱它？

像`:allow_blank_option => false`什么？

我试图对此属性进行存在验证，希望 SimpleForm 能够检测到它，但它没有帮助。

* * *

## 回答 #1

> 赞同：102
> 
> 时间：2013-02-28T18:54:23.823

您可以传递一个`include_blank: false, include_hidden: false`选项：

```
= f.input :category, :as => :select, :label => false, :collection => Choices["Categories"], include_blank: false, include_hidden: false 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-03-18T22:19:48.970

或者您可以在模型中自定义回调操作以删除数组参数中的任何空字符串，假设参数名称为“types”：

```
before_validation :remove_empty_string

def remove_empty_string
  types.reject! { |l| l.empty? }
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-07-06T14:46:56.053

要从选择中删除空白字段，有必要显示选定的因此添加`selected: 1` 然后将提示设置为类似`prompt: "Please Select"` 的任何内容最终输出将是 `<%= select("social_links",:option_id, Option.all.collect {|p| [ p.name, p.id ] },{ selected: 1 , prompt: "Please Select"}, { class: 'form-control' , required:true})%>`

# codeigniter - 在另一个控制器中对 codeigniter 使用 ion auth 身份验证

> ID：15143313
> 
> 赞同：2
> 
> 时间：2013-02-28T18:48:35.710
> 
> 标签：codeigniter, session, authentication, ion-auth

我正在尝试使用 codeigniter 构建一个 Web 应用程序。我已安装 Ion Auth 作为我的身份验证模型。

默认的 Auth.php 控制器对用户进行身份验证并设置会话。

```
<?php defined('BASEPATH') OR exit('No direct script access allowed');

class Auth extends CI_Controller {

    function __construct()
    {
        parent::__construct();
        $this->load->library('ion_auth');
        $this->load->library('session');
        $this->load->library('form_validation');
        $this->load->helper('url');

        $data['title']="Login Page";
        $this->load->view("view_site_header",$data);

        // Load MongoDB library instead of native db driver if required
        $this->config->item('use_mongodb', 'ion_auth') ?
        $this->load->library('mongo_db') :

        $this->load->database();    

        $this->form_validation->set_error_delimiters($this->config->item('error_start_delimiter', 'ion_auth'), $this->config->item('error_end_delimiter', 'ion_auth'));
    }

    //redirect if needed, otherwise display the user list
    function index()
    {
        // if not logged in - go to home page
        if (!$this->ion_auth->logged_in())
        {
            //redirect them to the login page
            redirect('auth/login', 'refresh');
        }
        // if user is an admin go to this page
        elseif ($this->ion_auth->is_admin())
        {
            // if an admin, go to admin area

            //set the flash data error message if there is one
            $this->data['message'] = (validation_errors()) ? validation_errors() : $this->session->flashdata('message');

            //list the users
            $this->data['users'] = $this->ion_auth->users()->result();
            foreach ($this->data['users'] as $k => $user)
            {
                $this->data['users'][$k]->groups = $this->ion_auth->get_users_groups($user->id)->result();
            }

            $this->_render_page('auth/view_users', $this->data);                
        }   else
    {
        //redirect them to the default home page 
        $data['title']="IMS Home Page";
        $this->load->view("generic/view_site_header",$data);
        $this->load->view("generic/view_generic_nav");
        $this->load->view("generic/view_content_generic");
        $this->load->view("view_site_footer");
    }
} 
```

我想要做的是为我的应用程序逻辑创建一个新的控制器，并留下身份验证控制器进行身份验证。

在访问我的新控制器时，如何使用 auth 控制器来确保我的用户已登录？此外，我需要新控制器可以使用会话信息。

我的新控制器 master_data 具有以下代码：

```
<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');

class Masterdata extends CI_Controller{

    function index ()
    {
            $data['title']="Master Data Home Page";
            $this->load->view("master_data/view_master_data_header",$data);
            $this->load->view("master_data/view_master_data_nav");
            $this->load->view("master_data/view_content_master_data_home");
            $this->load->view("master_data/view_master_data_footer");

            echo $this->session->userdata('username');

    }
} 
```

显然这`echo $this->session->userdata('username');`不起作用，因为新控制器不知道身份验证控制器会话。

一如既往地感谢任何帮助。

亲切的问候，

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-01T03:37:06.227

首先自动加载 ion_auth 库。如果您只是想检查用户是否已登录，只需在您加载的每个控制器的构造函数中检查它

```
public function __construct() {  
    parent::__construct();

    if (!$this->ion_auth->logged_in()) {
       // redirect to login view
    } 
} 
```

如果你碰巧有多个组，你可以在 application/core/MY_controller 中创建一个新的控制器。这个控制器将检查用户是否登录。你可以扩展这个基本控制器来创建新的控制器。对此给出了很好的解释大卫约翰。检查这个[链接](http://jondavidjohn.com/blog/2011/01/scalable-login-system-for-codeigniter-ion_auth)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-28T19:49:11.207

> 显然 echo $this->session->userdata('username'); 不起作用，因为新控制器不知道身份验证控制器会话。

嗯...如果会话库已加载，那么是的...调用它的控制器将能够访问会话变量 $username。

我们处理这个问题的方法是在 application/core 目录中创建一个新的控制器父类，如 MY_Controller 。此类加载公共库/包（如 session 和 ion_auth）。您还可以自动加载库和助手。

由于 ion_auth 将所有用户配置文件数据存储在会话 var 中，因此您（在后续的、未经过身份验证的）页面上只需要会话库来检索有关登录用户的会话数据。

你真的应该检查他们的身份验证状态，并优雅地失败：

```
if (!$this->ion_auth->logged_in()) {
    // echo a login link
} else {
    // echo session var for username
} 
```

那样的东西...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T20:11:48.173

jcorry 的方法应该有效。另一种方法（将为您的整个应用程序提供更大的灵活性是使用模块化布局 - [https://bitbucket.org/wiredesignz/codeigniter-modular-extensions-hmvc](https://bitbucket.org/wiredesignz/codeigniter-modular-extensions-hmvc)

您将不得不做一些摆弄才能让它与 ion auth 很好地配合使用，但是按照这个问题中的说明对我有用：[Using Ion Auth as a separate module in the HMVC structure](https://stackoverflow.com/questions/6352980/using-ion-auth-as-a-separate-module-in-the-hmvc-structure)（看看 forks of ion在 git hub 上进行身份验证 - 我想有人可能已经为你做了）

这种方法将允许您使用这种语法从应用程序的任何位置（如果需要，甚至从视图）访问任何控制器中的任何方法：`modules::run('module/controller/method', $params);`

这实际上将允许您将现有的 ion auth 控制器开发为用户管理控制器，您可以从您创建的任何其他控制器访问它（又好又干）。

# c# - 将javascript更新限制为asp：UpdatePanel

> ID：15143316
> 
> 赞同：1
> 
> 时间：2013-02-28T18:48:41.650
> 
> 标签：c#, javascript, asp.net, updatepanel

当用户单击展开按钮时，我有一个`GridView`内部并使用 javascript 来切换行的可见性。`UpdatePanel`上面有很多信息`GridView`，但我只想`UpdatePanel`更新相应的信息，以便屏幕保持原样，但是 JavaScript 调用导致整个屏幕刷新并且窗口跳回顶部。

我使用的代码`GridView`实际上来自`ExtGridView`CodeProject ( [http://www.codeproject.com/Articles/12299/ExtGridView](http://www.codeproject.com/Articles/12299/ExtGridView) ) 上的控件-它将 a 的最后`asp:TemplateField`一个`GridView`变成其他项目下方的新行。

我对 JavaScript 很陌生，对 ASP.NET 也很陌生，所以我可能会遗漏一些简单的东西。有没有办法让 JavaScript 刷新到`UpdatePanel`导致它的相应位置？

这是 JavaScript 代码：

```
<script type="text/javascript">
//<![CDATA[
function TglRow(ctl)
{
    var row = ctl.parentNode.parentNode;
    var tbl = row.parentNode;
    var crow = tbl.rows[row.rowIndex + 1];
    var ihExp = ctl.parentNode.getElementsByTagName('input').item(0);

    tbl = tbl.parentNode;

    var expandClass = tbl.attributes.getNamedItem('expandClass').value;
    var collapseClass = tbl.attributes.getNamedItem('collapseClass').value;
    var expandText = tbl.attributes.getNamedItem('expandText').value;
    var collapseText = tbl.attributes.getNamedItem('collapseText').value;

    if (crow.style.display == 'none')
    {
        crow.style.display = '';
        ctl.innerHTML = collapseText;
        ctl.className = collapseClass;
        ihExp.value = '1';
    }
    else
    {
        crow.style.display = 'none';
        ctl.innerHTML = expandText;
        ctl.className = expandClass;
        ihExp.value = '';
    }
}//]]>
</script> 
```

以下是摘录`GridView`：

```
 <asp:UpdatePanel ID="UpdatePanelChapter11" runat="server" 
           ChildrenAsTriggers="false" UpdateMode="Conditional">
      <ContentTemplate>
        <cc1:ExtGridView ID="gvChapter11" runat="server" AutoGenerateColumns="False" DataSourceID="odsChapter11"
          DataKeyNames="pkChapter11ID" ShowFooter="True" SkinID="GridViewSKin" Width="85%"
          onrowcommand="gvChapter11_RowCommand" 
          onrowdatabound="gvChapter11_RowDataBound" 
          onrowupdating="gvChapter11_RowUpdating" 
          CollapseButtonCssClass="GridCollapseButton" 
          ExpandButtonCssClass="GridExpandButton" CollapseButtonText="" 
          ExpandButtonText="" onrowcreated="gvChapter11_RowCreated">
          <Columns>
            <asp:TemplateField HeaderText="Name of<br/>Party" SortExpression="Name">
              <EditItemTemplate>
                <asp:TextBox ID="tbName" runat="server" Text='<%# Bind("Name") %>'></asp:TextBox>
                <br /><asp:RequiredFieldValidator ID="tbNameValidator" runat="server" ErrorMessage="*Name Required" ControlToValidate="tbName"
                 Display="Dynamic" CssClass="Error" ValidationGroup="SaveChapter11Validation"></asp:RequiredFieldValidator>
              </EditItemTemplate>
              <FooterTemplate>
                <asp:TextBox ID="tbName" runat="server" Text='<%# Bind("Name") %>'></asp:TextBox>
                <br /><asp:RequiredFieldValidator ID="tbNameValidator" runat="server" ErrorMessage="*Name Required" ControlToValidate="tbName"
                 Display="Dynamic" CssClass="Error" ValidationGroup="NewChapter11Validation"></asp:RequiredFieldValidator>
              </FooterTemplate>
              <ItemTemplate>
                <asp:Label ID="Label4" runat="server" Text='<%# Eval("Name") %>'></asp:Label>
              </ItemTemplate>
            </asp:TemplateField>
            <asp:TemplateField>
              <EditItemTemplate>
                <asp:LinkButton CssClass="Button" ID="SaveLink" runat="server" CommandName="Update" Text="Save" ValidationGroup="SaveChapter11Validation"></asp:LinkButton>
                <asp:LinkButton CssClass="Button" ID="CancelLink" runat="server" CommandName="Cancel" Text="Cancel"></asp:LinkButton>
              </EditItemTemplate>
              <ItemTemplate>
                <asp:LinkButton CssClass="Button" ID="EditLink" runat="server" CommandName="Edit" Text="Edit"></asp:LinkButton>
                <asp:LinkButton CssClass="Button" ID="DeleteLink" runat="server" CommandName="Delete" Text="Delete"
                OnClientClick="return confirm('Are you sure you want to delete this entry?');" ></asp:LinkButton>
              </ItemTemplate>
              <FooterTemplate>
                <asp:LinkButton CssClass="Button" ID="AddLink" runat="server" CommandName="Insert" Text="<<< Add" ValidationGroup="NewChapter11Validation"></asp:LinkButton>
              </FooterTemplate>
            </asp:TemplateField>
            <asp:TemplateField HeaderText="Plan">
              <EditItemTemplate>
                <div class="ExtGridRow" style="vertical-align:top;">Plan: </div>
                <asp:TextBox ID="tbPlan" runat="server" Text='<%# Bind("Plan") %>'></asp:TextBox>
              </EditItemTemplate>
              <ItemTemplate>
                <div class="ExtGridRow" style="vertical-align:top;">Plan: </div>
                <asp:Label ID="Label9" runat="server" Text='<%# Eval("Plan") %>'></asp:Label>
              </ItemTemplate>
              <FooterTemplate>
                <div class="ExtGridRow" style="vertical-align:top;">Plan: </div>
                <asp:TextBox ID="tbPlan" runat="server"></asp:TextBox>
              </FooterTemplate>
            </asp:TemplateField>
          </Columns>
        </cc1:ExtGridView>
      </ContentTemplate>
      <Triggers>
        <asp:AsyncPostBackTrigger ControlID="gvChapter11" EventName="DataBound" />
      </Triggers>
    </asp:UpdatePanel> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T19:05:12.420

好吧拍摄...多玩一点`ExtGridView`代码，我想通了。调用 javascript 的展开/切换按钮也分配了一个 HRef，作为一个链接，所以当它被点击时，它不仅会调用 JavaScript，而且就像点击了一个链接一样，导致页面刷新。

来自的罪魁祸首代码`ExtGridView`：

```
 // ...
       else if (RowType == DataControlRowType.DataRow || RowType == DataControlRowType.Footer)
        {       
            _expCell = new TableCell();

            _ctlExpand = new HtmlAnchor();
            //_ctlExpand.HRef = "#";          -- Commenting this out worked!
            _ctlExpand.Attributes["onclick"] = "TglRow(this);";

            _ihExp = new HtmlInputHidden();
            _ihExp.ID = "e" + this.DataItemIndex.ToString();

            _expCell.Controls.Add(_ctlExpand);
            _expCell.Controls.Add(_ihExp);      
        }

        if (_expCell != null)
        {
            _expCell.Width = Unit.Pixel(20);
            Cells.AddAt(0, _expCell);
        } 
```

# mysql - 能够从表中选择，但不能计算行数

> ID：15143320
> 
> 赞同：2
> 
> 时间：2013-02-28T18:48:52.007
> 
> 标签：mysql

我一直在为一个一次性项目运行一个小型 MySQL 数据库，并将该文件转储给一位同事，他能够让一切运行起来。

我们正在使用 C#，并运行两个查询，其中之一是：

```
SELECT * FROM someview LIMIT 20 OFFSET 0; 
```

另一个是：

```
SELECT COUNT(*) FROM someview; 
```

我将使用 SELECT SQL_CALC_FOUND_ROWS * 和 FOUND_ROWS()，但这显然不受 MySQLDataReader 存储过程之外的支持。

无论如何，问题是，这两个查询在我的系统上都可以正常工作。在他身上，第一个工作得很好，但是 SELECT COUNT(*) 语句失败并出现以下错误：

```
Error Code: 1356\. View 'db.someview' references invalid table(s) or column(s) or function(s) or definer/invoker of view lack rights to use them 
```

我们检查了 SHOW GRANTS 的结果，并且具有相同的权限，都以相同的用户（root）运行。这不是 C# 问题，因为如果他在 MySQL 命令行或 Workbench 中运行它，就会发生完全相同的事情。

他还能够成功地针对数据库中的任何其他表或视图发出 SELECT COUNT(*) 查询，包括第一个视图所依赖的视图。这只是一个特殊的视图，他可以选择 *，但不能选择 COUNT(*)。

有没有其他人经历过类似的事情？

服务器版本：5.5.29 MySQL 社区服务器（GPL）

**编辑：这里是两个视图创建脚本，根据**[Evan Miller 的 How Not To Sort By Average Rating](http://evanmiller.org/how-not-to-sort-by-average-rating.html)，精简到仍然存在问题的相关部分。

```
CREATE VIEW
    product_rating_counts
AS
SELECT
    p.id AS productId,
    sum(case when (r.rating = 1) then 1 else 0 end) AS 1_star,
    sum(case when (r.rating = 2) then 1 else 0 end) AS 2_star,
    sum(case when (r.rating = 3) then 1 else 0 end) AS 3_star,
    sum(case when (r.rating = 4) then 1 else 0 end) AS 4_star,
    sum(case when (r.rating = 5) then 1 else 0 end) AS 5_star,
    sum(case when (r.rating < 3) then 1 else 0 end) AS negative_ratings,
    sum(case when (r.rating > 3) then 1 else 0 end) AS positive_ratings,
    sum(case when (r.rating = 3) then 1 else 0 end) AS neutral_ratings
FROM
    product p
INNER JOIN
    review r
ON
    p.id = r.productId
GROUP BY
    p.id;

CREATE VIEW
    ranked_products
AS
SELECT
    p.id AS ID,
    p.SKU AS SKU,
    p.Name AS Name,
    prc.1_star,
    prc.2_star,
    prc.3_star,
    prc.4_star,
    prc.5_star,
    prc.positive_ratings AS Positive,
    prc.negative_ratings AS Negative,
    prc.neutral_ratings AS Neutral,
    ((prc.positive_ratings + 1.9208) / (prc.positive_ratings + prc.negative_ratings) -
               1.96 * SQRT((prc.positive_ratings * prc.negative_ratings) / (prc.positive_ratings + prc.negative_ratings) + 0.9604) /
                      (prc.positive_ratings + prc.negative_ratings)) / (1 + 3.8416 / (prc.positive_ratings + prc.negative_ratings))
    AS ci_lower_bound
FROM
    product p
INNER JOIN
    product_rating_counts prc
ON
    p.id = prc.productId
WHERE
    (prc.positive_ratings + prc.negative_ratings) > 0
ORDER BY
    ci_lower_bound DESC; 
```

所以对我有用的是：

```
SELECT * FROM ranked_products LIMIT 20 OFFSET 0;
SELECT COUNT(*) FROM ranked_products; 
```

但是对于我的同事来说，第一个查询返回得很好，而第二个给他无效的表/列/权限错误。

无论如何，我们可能会放弃这个，但我讨厌不知道为什么有些东西不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T04:30:18.857

快速搜索会产生以下结果：

`NULL`当视图中的结果集中存在时，会发生[此记录的错误#59005 (5.1.36-5.5.9)](http://bugs.mysql.com/bug.php?id=59005)

当视图中的表具有相同的列名时会发生[此错误#60295 (5.1.57-5.6.3)](http://bugs.mysql.com/bug.php?id=60295)

另一方面，[此链接](https://bugs.launchpad.net/maria/+bug/1006160/comments/5)表明您可能会遇到[bug#33000 (5.0-5.6.6)](http://bugs.mysql.com/bug.php?id=33000)的变体，并且可行的解决方案是运行`FLUSH TABLES`

可以在这里找到另一个尝试的解决方案：[视图和权限](http://sourceforge.net/apps/trac/ogsa-dai/wiki/MySQLUseful#Viewsandprivileges)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-28T20:41:22.343

```
SELECT *, COUNT(*) as `totalcount` FROM ranked_products LIMIT 20 OFFSET 0; 
```

# wxpython - 在 wxPython 中滚动绘制的框架

> ID：15143323
> 
> 赞同：0
> 
> 时间：2013-02-28T18:48:56.610
> 
> 标签：wxpython, paint, gdi

我目前有一个 wxPanel，我通过使用来自 wx.PaintDC 的设备上下文来绘制线条、文本等以响应绘制事件。但是，我的绘图可能会超出面板的大小，并且会继续超出可见屏幕。查看更多绘图的唯一方法是扩展应用程序窗口，这是不切实际的，并且在非常大的绘图的情况下仍然可能无法看到完整的绘图。理想情况下，我希望能够滚动绘图，这样应用程序窗口就不需要调整大小并且可以看到大图。

环顾四周，似乎我可能想使用 wxScrolledPanel 而不是 wxPanel。但是，我使用它没有成功 - 使用 wxScrolledPanel 是否仅在使用控件（例如按钮、文本字段）而不是在设备上下文上绘画时才有效？

滚动已绘制的面板的适当方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T22:06:32.743

它应该与 ScrolledPanel 一起使用，但如果您不打算在面板上使用其他小部件，那么它可能不是正确的答案，因为它取决于有一个 sizer 来设置虚拟大小。

尝试改用 wx.ScrolledWindow，并在演示中查看其示例以获取一些代码。基本上你只需要设置窗口的虚拟大小，它会为你处理滚动条和滚动。您还需要在您的绘图事件处理程序中调用 PrepareDC，以便它会偏移绘图以匹配滚动的视口原点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T22:08:07.920

我在 StackOverflow 上找到了以下答案，我认为您可能想看看：

*   [wxPython：制作可滚动的 DC](https://stackoverflow.com/questions/677590/wxpython-making-a-scrollable-dc)
*   [无闪烁可绘制 ScrolledWindow](https://stackoverflow.com/questions/3147613/flicker-free-drawable-scrolledwindow)

这些答案似乎集中在 wx.ScrolledWindow 上，但是我认为您可以使用这些答案中的概念并将它们与 ScrolledPanel 一起使用。我还发现了这个有趣的话题：

*   [http://www.daniweb.com/software-development/python/threads/73283/scrolles-canvas-in-wxpython](http://www.daniweb.com/software-development/python/threads/73283/scrolles-canvas-in-wxpython)

# python - 如何在Python的递归中使用for循环中的另一个列表更新原始列表

> ID：15143325
> 
> 赞同：-2
> 
> 时间：2013-02-28T18:49:00.010
> 
> 标签：python, list, recursion, for-loop

假设我有一个列表 ,`L = [a,b,c,d]`和这个列表的副本，还有一个包含递归代码的 for 循环：

```
 for item in L:
        if:
            *some base code*
            Lcopy.remove(item)
            L = []
            L += Lcopy[:]
        else:
            *some recursion code*
    return ... 
```

但每次递归完成后，L 又回到原来的样子。我知道一旦代码进入递归，Python 会为它使用的列表 (L) 提供一个新的内存地址，但是是否有可能使原始 L，即第一个 L，来更新和删除这些值那应该被删除？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T18:52:57.223

问题出在`L = []`

`L`这是指向另一个值，一个新创建的列表之后的时刻。

Python 没有对递归中的引用做任何特别的事情。列表总是通过引用传递。赋值打破了对`L`旧列表的引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T19:00:06.717

当您拥有`L = []`该函数的本地名称时，您将重新分配`L`给一个全新的列表。如果您想清空同一个列表，则需要删除其所有内容，如下所示：`del L[:]`

有关 Python 执行模型的更详细说明，以及分配给变量的实际作用，请查看[Jeff Knupp 的这篇博文](http://www.jeffknupp.com/blog/2013/02/14/drastically-improve-your-python-understanding-pythons-execution-model)。

# scala - 使用 X.par.view 与 X.view.par 构建 Scala 并行视图？

> ID：15143326
> 
> 赞同：8
> 
> 时间：2013-02-28T18:49:05.423
> 
> 标签：scala, parallel-processing, scala-collections, parallel-collections

根据关于并行集合和互联网搜索的论文，并行集合应该与视图一起使用，但我不清楚两者之间的区别

```
coll.par.view.someChainedIterations 
```

和

```
coll.view.par.someChainedIterations 
```

似乎`coll.view.par`失去了收藏的视野：

```
scala> val coll = 1 to 3
coll: scala.collection.immutable.Range.Inclusive = Range(1, 2, 3)

scala> coll.view.par
res2: scala.collection.parallel.ParSeq[Int] = ParArray(1, 2, 3)

scala> coll.par.view
res3: java.lang.Object with scala.collection.parallel.ParSeqView[Int,scala.collection.parallel.immutable.ParSeq[Int],scala.collection.immutable.Seq[Int]] = $anon$1(1, 2, 3) 
```

但我不知道为什么。它是一个功能还是一个错误？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-28T19:35:47.693

这可能是一个疏忽，应该修复。

`par`on 顺序视图可以通过调用 on 集合来实现，`par`这`underlying`将导致一连串的递归`par`调用，直到`underlying`是最初从中获取视图的严格集合。如果这个集合可以高效地转化为对应的并行集合，那么新获得的并行视图就可以高效地构建（见[这里](http://docs.scala-lang.org/overviews/parallel-collections/conversions.html)）。

# xpath - 如何在 drupal 中使用 Feed_Xpath 模块？

> ID：15143327
> 
> 赞同：0
> 
> 时间：2013-02-28T18:49:09.900
> 
> 标签：xpath, drupal-7

我试图将 Dspace 内容提取到 Drupal 中。

我找到了一种方法。我有 RestFulWebServices(Xmls)。

我在 Drupal7 中安装了 Feed Xpath 模块。

我已将 Import Url 指定为“ [http://library.leadingtochoices.org/dspace-rest-1.8.1/collections.xml](http://library.leadingtochoices.org/dspace-rest-1.8.1/collections.xml) ”

和作为 Xpath 解析器设置：Contecxt：/collections 标题：/collection body：/communities/name

它会附带整个 xml 而不是查询的。

我只想知道名称 Attribute ，但它带有整个文件。

请让我知道如何使用 Feed Xpath 模块。

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T05:26:36.287

尝试这个。

上下文：//集合

标题：身体

身体：名字

# algorithm - 如何在有序字典中查找所有元素，该字典实现为具有键 k 的二叉树

> ID：15143329
> 
> 赞同：2
> 
> 时间：2013-02-28T18:49:16.437
> 
> 标签：algorithm, binary-search-tree

给定一棵二叉树，我需要实现一个方法 findAllElements(k) 来查找树中键等于 k ​​的所有元素。

我的想法是你第一次遇到带有键 k 的元素。所有具有相同键的元素都应该在左孩子的右子树或右孩子的左子树中。但有人告诉我可能不是这样？

我只需要找到一种实现算法的方法。所以需要伪代码。

我可能应该添加这个抱歉。但是实现是左子树包含小于或等于根键的键，右子树包含大于或等于根键的键。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T19:06:03.853

这取决于您的树实现，二叉树我假设您的意思是二叉搜索树，并且您使用 operator< 来比较键。也就是说，节点的左子树仅包含键小于（<）的节点，而节点的右子树仅包含键**不小于**（！<）的节点。

例如

```
 7 
 / \
4   7
   / \
  6   8 
```

如果树中有多个相等的键，请执行此操作

```
k < current_node_key,  search left subtree
k > current_node_key,  search right subtree
k == current_node_key, record current node , then search right tree 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T18:54:09.350

查看当前节点。如果它的key大于k，则搜索左子树。如果它较低，则搜索右子树。如果相等，则搜索左右子树（并在结果中包括当前节点）。

从根节点开始递归地执行此操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T20:03:47.287

以为我会在与老师交谈后回来解释结果应该是什么。因此，如果您执行一个 findElement(k) 方法，该方法将找到键等于 k ​​的元素，它找到的元素应该是键为 k 的树中最高的元素（让我们将此元素表示为 V）。

然后从这个元素 V 开始，包含 key=k 的其他元素要么在左子子树中（特别是一直到右边），要么在右子子树中（特别是在左边）。所以对于左孩子来说，继续到下一个节点右孩子，直到找到一个 key=k 的元素......现在......以这个节点为根的子树中的每个元素都必须有一个 key=k（这是我一开始没认出的部分）因此可以对这个完整的子树进行任何形式的遍历，以查找并存储该子树中的所有元素（访问其中的每个节点）。必须为右孩子重复这种类型的事情，但要访问每个左孩子，直到找到一个 key=k 的元素。

显然，这只是一个词的描述，对于长度和任何混淆感到抱歉。希望这将帮助其他试图解决类似问题的人。

# ios - 检测子视图的旋转

> ID：15143330
> 
> 赞同：0
> 
> 时间：2013-02-28T18:49:16.903
> 
> 标签：ios, objective-c, uikit

我有一个包含几个子视图的视图。我可以使用 UIRotationGestureRecognizer 检测并让用户仅旋转一个子视图或包含视图。但我希望能够旋转任何方形子视图集合，如下所示：

初始状态：

![初始状态](../Images/ac12193f8d26411aad14179ebc93d415.png)

逆时针旋转右上角的正方形

![旋转右上角的方块](../Images/9a4b9c87303a40460d9d855a9054499c.png)

到达这里

![到达这里](../Images/4d5a8102b8f9c55bba1b1f4e07d6d0eb.png)

我怎样才能实现这种行为？我应该如何嵌套我的视图层次结构？

任何指针表示赞赏:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T19:26:27.153

这就是我要做的（伪代码）：

```
when rotation recognized:
    create new_layer
    new_layer.bounds = union_rect( frames of tiles to be rotated )
    new_layer addSublayers:(tiles to be rotated)

while rotation in progress:
    new_layer.transform = CATransform3DMakeRotation( angle, 0, 0, 1 )

when rotation complete:
    (original view).layer addSublayers:(tiles to be rotated)
    (tiles to be rotated) rearrange after rotation 
```

# tfs - 在 TFS 中，我应该为生产版本添加标签还是创建分支？

> ID：15143331
> 
> 赞同：11
> 
> 时间：2013-02-28T18:49:24.427
> 
> 标签：tfs, branch

在进行生产部署时，我应该用标签标记我的代码还是为生产中的代码创建一个分支？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2014-07-02T15:07:16.650

在 TFS 中，我会有一个带有标签的 Release 分支，用于标识要发布到生产环境的特定版本。

这意味着你有其他分支机构我可以建议以下

*   三大分支：Main、Develop 和 Release。
*   您当前火灾的一个修补程序分支。
*   0 到 N 个主要功能分支，以遏制开发中断。

### 细节

*   主枝
    *   包含最新的稳定版本
    *   **标记/标记**每​​个版本
*   开发分支
    *   从主分支
    *   大部分工作完成的地方
    *   发布前合并回 Main
*   发布分支
    *   从以下之一分支：
        *   开发分支
        *   或主分支（这可能会更好，因为它是“稳定的”）
    *   错误修复在这里完成
    *   修复测试并发布后，
        *   合并到开发分支
        *   或合并到主分支，然后转发集成（FI - 这是从父级到子级的合并）到开发
    *   **标记/标记**每​​个版本或错误修复
*   修补程序分支
    *   从主要分支
    *   合并回 Main
    *   前向整合合并到发展
    *   用于让 Main 保持“稳定”
*   主要功能分支
    *   从开发分支
    *   合并回开发
    *   用于可能会破坏常规开发路径的主要功能

参考：

*   另一个堆栈溢出问题：[when-to-use-a-tag-label-and-when-to-branch](https://stackoverflow.com/questions/542029/when-to-use-a-tag-label-and-when-to-branch)特别是 Martin Woodward 的回答
*   Eric Sink 的[源代码控制方法](http://www.ericsink.com/scm/source_control.html)
*   Vincent Driessen [成功的 Git 分支模型](http://nvie.com/posts/a-successful-git-branching-model/)
    *   这包含一个非常好的分支模型图形

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-28T19:04:21.507

理想情况下，两者兼而有之。

您可能希望拥有一个*标签*，以便准确了解您为特定版本交付的内容。但是，您可能还想创建一个*分支*，以便您可以对已发布的内容执行小错误修复并创建新版本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-28T19:01:00.273

在实践中，您可以通过以下两种方式之一来处理它：

*   有一个持续的开发时间表，为您的每个生产版本分支：

例子：

```
 ------------------------->dev
     |      |      |
     |      |      |
     |      |      |
    v1.0   v2.0   v3.0 
```

*   让您的生产版本彼此“级联”：

例子：

```
---->v1.0---->v2.0---->v3.0 
```

最终，由您决定采用哪种架构，只要它是一致的并且对您有意义。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-04T11:39:24.723

您可以将两者结合使用。以下是我们在内部为所有项目执行此操作的方式。

对于每个次要和主要版本，我们都有包含文件夹分支和子文件夹的结构。我们还使用我们在各个子文件夹上设置的标签，以便我们可以在未来任何时候轻松地重建任何特定版本。

```
$\Branches
    \2012.01
    \2012.02 (branched from 2012.01)
    \2012.03 (branched from 2012.02)
    \2013.01 (branched from 2012.03) 
```

您还可以查看[Visual Studio Team Foundation Server 分支和合并指南](http://vsarbranchingguide.codeplex.com/)了解更多详细信息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-28T19:01:42.067

我已经看到两者都完成了，标签更轻量级，对我来说更容易。但是，有人指出，标签可以很容易地删除。除非“销毁”，否则分支实际上不会被删除，从而防止这种情况发生。我不喜欢使用分支的原因是我讨厌隐藏它们，因为我倾向于从根目录获取最新信息，并且不希望所有这些分支填满我的硬盘

作为记录，由于有人向我指出标签被删除，我已经从除管理员和构建服务帐户之外的所有人删除了标签权限，以帮助缓解这种情况。

# sql - 当我加入另一个表时，SUM 不正确

> ID：15143335
> 
> 赞同：0
> 
> 时间：2013-02-28T18:49:43.550
> 
> 标签：sql, join, sum

我正在尝试对各种总计应用折扣。每个折扣都有自己的折扣代码，因此我想将代码应用于其等效总数。但有时此代码可能会出现不止一次。如果是这样，我想将折扣代码相加以产生一个折扣。

我的第一次尝试是不正确的，但准确地显示了我刚刚试图解释的内容，即。折扣码出现多次：

```
SELECT bdto.dto_fac_cod_descuento,
    COUNT(bdto.dto_fac_cod_descuento) howmany,
    CASE
        WHEN COUNT(bdto.dto_fac_cod_descuento) > 1
            THEN ABS (ROUND (SUM(bdto.dto_fac_importe_dto), 0))
            ELSE ABS (ROUND (bdto.dto_fac_importe_dto, 0))
            END AS descuento
    FROM 
         bren_descuentos bdto
GROUP BY bdto.dto_fac_cod_descuento, bdto.dto_fac_importe_dto

dto_fac_cod_descuento   howmany descuento
714         1   4274.00
X23         1   4040.00
X23         1   3300.00
X23         1   2800.00
336         1   2584.00
E35         1   2519.00
713         1   1458.00
335         1   920.00
G07         1   610.00
M48         1   350.00
715         1   310.00
368         2   450.00
G07         1   94.00
168         1   70.00
349         1   62.00
X73         1   20.00
BN3         1   10.00
M47         1   2.00
A40         2   0.00
S11         1   0.00 
```

经过深思熟虑，我目前有以下查询，它给了我正确的答案（我怀疑代码是最好的，但我现在不关心）

```
SELECT bdto.dto_fac_cod_descuento,
            CASE
        WHEN COUNT(bdto.dto_fac_cod_descuento) > 1
            THEN 
                ABS (ROUND (SUM(bdto.dto_fac_importe_dto), 0))
            ELSE 
                (SELECT ABS (dto_fac_importe_dto) FROM bren_descuentos bd
                    WHERE bdto.dto_fac_cod_descuento = bd.dto_fac_cod_descuento) 
        END AS descuento
    FROM 
         bren_descuentos bdto
GROUP BY bdto.dto_fac_cod_descuento 

dto_fac_cod_descuento   descuento
168         70.44
335         919.85
336         2584.31
349         62.16
368         450.00
713         1458.05
714         4273.73
715         309.62
A40         0.00
BN3         10.00
E35         2519.00
G07         704.00
M47         2.46
M48         349.77
S11         0.00
X23         10140.00
X73         20.00 
```

我的问题是我需要加入另一个表，因为这个查询只是我需要的一部分，当我应用 JOIN 时，我的结果变得混乱，我不知道如何解决它！

应用 JOIN 后，我得到了这个：

```
SELECT bdto.dto_fac_cod_descuento,
            CASE
        WHEN COUNT(bdto.dto_fac_cod_descuento) > 1
            THEN 
                ABS (ROUND (SUM(bdto.dto_fac_importe_dto), 0))
            ELSE 
                (SELECT ABS (dto_fac_importe_dto) FROM bren_descuentos bd
                    WHERE bdto.dto_fac_cod_descuento = bd.dto_fac_cod_descuento) 
        END AS descuento
    FROM bren_detalle bdet
         JOIN
         bren_descuentos bdto
ON bdet.det_unidad_medida = 'megabytes'
GROUP BY bdto.dto_fac_cod_descuento

dto_fac_cod_descuento   descuento
168         318177.00
335         4154962.00
336         11673328.00
349         280777.00
368         2032650.00
713         6586012.00
714         19304438.00
715         1398554.00
A40         0.00
BN3         45170.00
E35         11378323.00
G07         3179968.00
M47         11112.00
M48         1579911.00
S11         0.00
X23         45802380.00
X73         90340.00 
```

@Dukeling 使用 JOIN 的“完整”代码：

```
SELECT bdet.det_tipo_trafico tipo_trafico, 
        COUNT (bdet.det_tipo_trafico) total_numero, 
        ROUND (SUM (bdet.det_cantidad_medida_originada + bdet.det_cantidad_medida_recibida), 0) total_megas,
        ROUND (SUM (bdet.det_importe), 2) total_importe,
        ABS (ROUND (SUM(bdto.dto_fac_importe_dto), 0)) AS descuento,
        ROUND ((SUM (bdet.det_cantidad_medida_originada + bdet.det_cantidad_medida_recibida)) / NULLIF (COUNT (bdet.det_tipo_trafico), 0), 0) mb_conxn
    FROM bren_detalle bdet
        JOIN
         bren_descuentos bdto
ON bdet.det_unidad_medida = 'megabytes'
    AND bdet.dto_fac_cod_descuento = bdto.dto_fac_cod_descuento
GROUP BY bdet.det_tipo_trafico, bdto.dto_fac_importe_dto, bdto.dto_fac_cod_descuento 
```

给出这个结果：

```
tipo_trafico            total_numero    total_megas total_importe   descuento   mb_conxn
DATOS EN ITINERANCIA        224     2176        653,88      0.00        10
MENSAJES MULTIMEDIA EN ITINERA  1       0       0,7     10.00       0
DATOS INTERNET          4389        38338       1789,19     412566.00   9
MENSAJES MULTIMEDIA     15      2       6,36        37785.00    0
DATOS INTERNET          4389        38338       1789,19     2677290.00  9 
```

正如你所看到的，我得到了两个“DATOS INTERNET”，因为 descuento 有两个不同的值，它不会对它们求和。而且它仍然给出了一个巨大的折扣数字，它的总和太多了。

bren_detalle 的内容示例（有更多列，但我没有使用它们）

```
det_tipo_trafico            det_unidad_medida   det_importe dto_fac_cod_descuento   dto_fac_cod_descuento2
TRAFICO NAC.OTROS OPER.MOVILES      Minutos         3,6588          714         368
TRAFICO NAC.OTROS OPER.MOVILES      Minutos         1,4035          714         368
DATOS INTERNET  Megabytes   0,0583  G07 NULL
TRAFICO NAC.OTROS OPER.MOVILES  Minutos 8,756   714 368
TRAFICO NAC.OTROS OPER.MOVILES  Minutos 0,5195  714 368
DATOS INTERNET  Megabytes   0,0097  G07 NULL
INTERNO CORPORATIVO Minutos 0,1758  335 368
INTERNO CORPORATIVO Minutos 0,2617  335 368
TRAFICO NAC.OTROS OPER.MOVILES  Minutos 1,8313  714 368
INTERNO MOVILES Minutos 1,5993  336 368
TRAFICO NAC.OTROS OPER.MOVILES  Minutos 1,2165  714 368
INTERNACIONAL   Minutos 1,541   M48 NULL
TRAFICO NAC.OTROS OPER.MOVILES  Minutos 1,2108  714 368
DATOS INTERNET  Megabytes   0,3351  G07 NULL
DATOS INTERNET  Megabytes   0,9028  G07 NULL
DATOS INTERNET  Megabytes   0,0102  G07 NULL
RESTO DE TRAFICO NACIONAL   Minutos 2,4196  715 368
DATOS INTERNET  Megabytes   0,0271  G07 NULL
TRAFICO NAC.OTROS OPER.MOVILES  Minutos 2,8372  714 368
DATOS INTERNET  Megabytes   0,1574  G07 NULL 
```

bren_descuentos 表的内容（同样有更多列但未使用）：

```
dto_fac_cod_descuento   dto_fac_importe_dto
S11 0.00
A40 0.00
BN3 -10.00
G07 -94.00
X23 -4040.00
168 -70.44
335 -919.85
336 -2584.31
349 -62.16
368 -225.00
368 -225.00
713 -1458.05
714 -4273.73
715 -309.62
A40 0.00
E35 -2519.00
M47 -2.46
M48 -349.77
X23 -3300.00
G07 -610.00
X23 -2800.00
X73 -20.00 
```

举个例子，折扣代码 G07 与 DATOS INTERNET 流量一起使用，所以我应该有 610+94=704 的总折扣。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T19:15:20.387

它确实取决于`bren_detalle`看起来像什么，但您可能需要**指定一个要`JOIN`打开**的字段（否则它将基本上是一个`CROSS JOIN`- 一行与另一个表中的其他行匹配）：

```
bren_detalle bdet
JOIN bren_descuentos bdto
  ON bdet.somefield = bdto.someotherfield
  AND bdet.det_unidad_medida = 'megabytes' 
```

请注意，您在第一个查询中得到不需要的结果的原因是因为**`dto_fac_importe_dto`在`GROUP BY`**. 这将导致 和 的每个不同组合出现`dto_fac_cod_descuento`一行`dto_fac_importe_dto`。只需删除它，它应该可以工作：（也`CASE`似乎有点多余）

```
SELECT bdto.dto_fac_cod_descuento,
    COUNT(bdto.dto_fac_cod_descuento) howmany,
    ABS (ROUND (SUM(bdto.dto_fac_importe_dto), 0)) AS descuento
FROM bren_descuentos bdto
GROUP BY bdto.dto_fac_cod_descuento 
```

**编辑：**

问题是您的表格看起来像：

```
table 1    table 2
f1 f2      f1 f3
1  8       1  10
1  9       1  11 
```

然后，当你`JOIN`在 f1 上时，你会得到 4 行，每个行的组合匹配一个。因此`SUM(f2)`= (8+9)*2（表 2 中的 2 行）。

[SQLFiddle](http://www.sqlfiddle.com/#!2/e09e8/2)。

可能有更有效的方法，但我现在能想到的唯一方法来解决它：

```
...
FROM (SELECT dto_fac_cod_descuento, SUM(someField), SUM(someOtherField)
      FROM bren_detalle
      WHERE det_unidad_medida = 'megabytes'
      GROUP BY dto_fac_cod_descuento) bdet
  JOIN
     (SELECT dto_fac_cod_descuento, SUM(someField), SUM(someOtherField)
      FROM bren_descuentos
      GROUP BY dto_fac_cod_descuento) bdto
    ON bdet.dto_fac_cod_descuento = bdto.dto_fac_cod_descuento 
```

# c - 当标志是 char 字符串指针而不是 int 时，open() 函数错误

> ID：15143339
> 
> 赞同：0
> 
> 时间：2013-02-28T18:49:50.523
> 
> 标签：c, unix

```
#include <stdio.h>
#include <unistd.h>  
#include <sys/stat.h>
#include <sys/types.h>
#include <fcntl.h>

int main(int argc,char *argv[])
{
    int fd;
    int i=1;
    for(i=1;i<argc;++i)
    {
        char temp;
        fd=open(argv[i],"O_RDWR"); 
        if (fd==-1)
            perror("file:");
        while (read(fd,&temp,1)!=EOF)
        {
            putchar(temp);
        }
    }
} 
```

我执行`./a.out a b`. `a`并且`b`是我目录中的文件。我收到一条错误消息`File exists`。该行`open(argv[i],"O_RDWR")`未打开文件。

`-1`由于文件存在，它正在返回。那么我应该如何使用`open`系统调用打开文件？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-28T18:51:10.473

> ```
> fd=open(argv[i],"O_RDWR");
>                 ^      ^ 
> ```

您传递的是 a`char *`而不是整数常量。删除`"`，它应该只是：

```
fd = open(argv[i], O_RDWR); 
```

* * *

有趣但可能跑题了，`open`一定以为你通过了`O_CREAT | O_EXCL`，这就是它抱怨文件已经存在的原因。

* * *

> 那么我所写的是正确的???但是代码将进入无限的外观，打印什么都没有

该函数`read(2)`不返回`EOF`at 和 输入，而是返回`0`.

# algorithm - 在什么情况下，在 [0,1) 上生成的随机数与在 [0,1] 上生成的随机数之间的差异会产生影响？

> ID：15143341
> 
> 赞同：1
> 
> 时间：2013-02-28T18:49:54.143
> 
> 标签：algorithm, random, stochastic

我习惯于在半开区间 [0,1) 中返回浮点值的伪随机数生成器。

我已经看到一些对 RNG 的引用，它们可以在闭合区间 [0,1] 上返回值，例如[Mersenne Twister 的这个实现](http://www.bedaux.net/mtrand/mtrand.h.html)。

我可以看到您出于数学原因想要排除一个或两个端点的原因，例如

`exponentially_distributed=-logf( 1.0-rng() )`

如果 总是产生一个有效的数字`0.0<=rng()<1.0`。

但我想不出用产生 [0,1) 的 rng 替换产生 [0,1] 的 rng 会产生任何实际差异的情况。

在什么情况下，绝对有必要在闭区间 [0,1] 上返回值的浮点伪随机数生成器？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T18:54:37.447

也许如果您随机生成事件发生的概率？如果允许 0，则必须允许 1。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T19:01:40.223

不能，弄清楚封闭区间何时有用，但开放结束区间似乎是唯一合理的使用方式。

让我们抛硬币：

如果你说`rnd() < 0.5`是头，其余的是尾，如果你使用闭区间，你会得到比头更多的尾。还有多少尾巴取决于实际得到 1 的可能性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T19:10:01.000

使用半开区间的一个令人信服的理由是您为某个数组选择随机数组索引的用例。当您从 [0, 1) 缩放到 [0, arrayLength] 中的整数时，永远不要获取值 arrayLength 很有帮助，因为在许多语言实现中这不是数组中的索引。例如，Java 和 ArrayIndexOutOfBoundsException。半开区间在这里非常方便。

具有闭区间 [0, 1] 的原因是 Albin 的概率论点。但值得注意的是，从数学上讲，在 [0, 1] 中选择任何特定随机数（包括 1）的概率为零。但是，对于伪随机数生成器，它会偶尔弹出。

# php - Paypal 定期付款

> ID：15143342
> 
> 赞同：0
> 
> 时间：2013-02-28T18:49:54.350
> 
> 标签：php, paypal, recurring-billing

我正在使用[Lionite PayPal](http://www.binpress.com/c/20/14808)类来处理 PayPal 定期付款，但是我似乎没有通过 IPN 获得我设置的自定义变量。

这就是我通过快速结帐的方式：

```
$item = array(
    'subscription_description' => 'Monthly ' . $plan['title'] . ' subscription',
    'cost' => $plan['price'],
);
$options = array(
    'return' => $this->base . 'action/subscription/', // Confirmation URL
    'cancel' => $this->base . 'action/cancel/', // Cancellation URL
    'cost' => $plan['price'],
    'item_cost' => $plan['price'],
    'custom' => 999 //config('user:id')
);

$result = $this->paypal->getCheckoutUrl($options, $item);

if (is_string($result)) {
    //Redirection URL generated successfully! redirecting to Paypal
    header('Location: ' . $result);
} 
```

如果他们完成购买，他们会被重定向到我创建订阅配置文件的订阅页面： $date = date('c', strtotime('+1 months')); //下个月开始

```
$profile = array(
    'period' => 'Month', // Subscription Period
    'frequency' => 1, // Frequency x period equals 1 billing cycle (up to 1 year)
    'total_cycles' => 12, // End profile after 1 year (12 cycles)
    // Regular subscription amount
    'start_date' => $date, // Profile start date
    'currency' => 'USD' // Payment currency
);

//select user info
$user = $this->Db->selectOne(array('id' => config('user:id')), 'users');

//get user's plan
$plan = $this->Db->selectOne(array('id' => $user['plan']), 'plans');

$profile['cost'] = $profile['init_amount'] = $plan['price'];
$profile['desc'] = 'Monthly ' . $plan['title'] . ' subscription';

$profileId = $this->paypal->createRecurringProfile($profile); 
```

之后，我收到了 txn_type 为 recurring_payment_profile_created 但自定义变量丢失的 IPN。有什么想法吗？我应该如何跟踪我的哪些用户注册了订阅？

**编辑：** IPN 消息

```
Array
(
    [payment_cycle] => Monthly
    [txn_type] => recurring_payment_profile_created
    [last_name] => Bernotas
    [initial_payment_status] => Completed
    [next_payment_date] => 03:00:00 Mar 28, 2013 PDT
    [residence_country] => GB
    [initial_payment_amount] => 0.01
    [currency_code] => USD
    [time_created] => 08:52:45 Feb 28, 2013 PST
    [verify_sign] => xxxx
    [period_type] =>  Regular
    [payer_status] => verified
    [tax] => 0.00
    [payer_email] => xxxx
    [first_name] => Ignas
    [receiver_email] => xxxx
    [payer_id] => xxxx
    [product_type] => 1
    [initial_payment_txn_id] => xxxx
    [shipping] => 0.00
    [amount_per_cycle] => 0.01
    [profile_status] => Active
    [charset] => windows-1252
    [notify_version] => 3.7
    [amount] => 0.01
    [outstanding_balance] => 0.00
    [recurring_payment_id] => xxxxx
    [product_name] => Monthly Basic subscription
    [ipn_track_id] => xxx
) 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T19:29:12.207

您拥有的代码似乎是正确的。我也在我的系统上使用定期付款对此进行了测试，并且自定义变量似乎没有在 IPN 中被发回。我建议在 www.paypal.com/mts 上使用 PayPal MTS 开一张票，以解决可能存在的错误。这样，通过打开票证，您也会在问题得到解决后收到通知。

# android - 撤消/重做动作android绘图与imageView布局

> ID：15143343
> 
> 赞同：1
> 
> 时间：2013-02-28T18:49:56.670
> 
> 标签：android, drawing, imageview, undo-redo

对不起我的英语。我想开发一个可绘制的应用程序，我需要撤消和重做功能。这是我的代码。我的 xml 是只有 imageview 的线性布局，按钮是 imageview 我不知道问题出在哪里。我需要你的帮助！提前致谢！

```
UndoRedo.java

public class UndoRedo extends Activity {

private ArrayList<Path> undonePaths = new ArrayList<Path>();
private ArrayList<Path> paths = new ArrayList<Path>();
FrameLayout frmLayout;
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.first_activity);

    frmLayout=(FrameLayout)findViewById(R.id.linearLayout2);     
    final DrawingPanel dp = new DrawingPanel(this);
    frmLayout.addView(dp);
    ((Button) findViewById(R.id.imageViewUndo))
            .setOnClickListener(new OnClickListener() {
                public void onClick(View v) {
                    // TODO Auto-generated method stub
                    if (paths.size() > 0) {
                        undonePaths.add(paths.remove(paths.size() - 1));
                        dp.invalidate();
                    }
                }
            });
    ((Button) findViewById(R.id.imageViewRedo))
            .setOnClickListener(new OnClickListener() {
                public void onClick(View v) {
                    // TODO Auto-generated method stub
                    if (undonePaths.size()>0) {
                        paths.add(undonePaths.remove(undonePaths.size()-1));
                        dp.invalidate();
                    }
                }
            });
}

public class DrawingPanel extends View implements OnTouchListener {

    private Canvas mCanvas;
    private Path mPath;
    private Paint mPaint, circlePaint, outercirclePaint;

    // private ArrayList<Path> undonePaths = new ArrayList<Path>();
    private float xleft, xright, xtop, xbottom;

    public DrawingPanel(Context context) {
        super(context);
        setFocusable(true);
        setFocusableInTouchMode(true);

        this.setOnTouchListener(this);

        circlePaint = new Paint();
        mPaint = new Paint();
        outercirclePaint = new Paint();
        outercirclePaint.setAntiAlias(true);
        circlePaint.setAntiAlias(true);
        mPaint.setAntiAlias(true);
        mPaint.setColor(0xFF000000);
        outercirclePaint.setColor(0x44FFF000);
        circlePaint.setColor(0xAADD5522);
        outercirclePaint.setStyle(Paint.Style.STROKE);
        circlePaint.setStyle(Paint.Style.FILL);
        mPaint.setStyle(Paint.Style.STROKE);
        mPaint.setStrokeJoin(Paint.Join.ROUND);
        mPaint.setStrokeCap(Paint.Cap.ROUND);
        mPaint.setStrokeWidth(6);
        outercirclePaint.setStrokeWidth(6);
        mCanvas = new Canvas();
        mPath = new Path();
        paths.add(mPath);
    }

    public void colorChanged(int color) {
        mPaint.setColor(color);
    }

    @Override
    protected void onSizeChanged(int w, int h, int oldw, int oldh) {
        super.onSizeChanged(w, h, oldw, oldh);
    }

    @Override
    protected void onDraw(Canvas canvas) {

        for (Path p : paths) {
            canvas.drawPath(p, mPaint);
        }

    }

    private float mX, mY;
    private static final float TOUCH_TOLERANCE = 0;

    private void touch_start(float x, float y) {
        mPath.reset();
        mPath.moveTo(x, y);
        mX = x;
        mY = y;
    }

    private void touch_move(float x, float y) {
        float dx = Math.abs(x - mX);
        float dy = Math.abs(y - mY);
        if (dx >= TOUCH_TOLERANCE || dy >= TOUCH_TOLERANCE) {
            mPath.quadTo(mX, mY, (x + mX) / 2, (y + mY) / 2);
            mX = x;
            mY = y;
        }
    }

    private void touch_up() {
        mPath.lineTo(mX, mY);
        // commit the path to our offscreen
        mCanvas.drawPath(mPath, mPaint);
        // kill this so we don't double draw
        mPath = new Path();
        paths.add(mPath);
    }

    public boolean onTouch(View arg0, MotionEvent event) {
        float x = event.getX();
        float y = event.getY();

        switch (event.getAction()) {
        case MotionEvent.ACTION_DOWN:
            // if (x <= cx+circleRadius+5 && x>= cx-circleRadius-5) {
            // if (y<= cy+circleRadius+5 && cy>= cy-circleRadius-5){
            // paths.clear();
            // return true;
            // }
            // }
            touch_start(x, y);
            invalidate();
            break;
        case MotionEvent.ACTION_MOVE:
            touch_move(x, y);
            invalidate();
            break;
        case MotionEvent.ACTION_UP:
            touch_up();
            invalidate();
            break;
        }
        return true;
    }
} 
```

}

```
 CanvasView.java

    public class CanvasView extends View{

private static final float STROKE_WIDTH = 5f;
private static final float HALF_STROKE_WIDTH = STROKE_WIDTH/2;
Paint erasePaint = new Paint();
Paint paint = new Paint();
Path path = new Path();

float lastTouchX,lastTouchY;

AlertDialog.Builder alert;

RectF ovalRectangle = new RectF();
RectF dirtyRect = new RectF();

MyRectangle myRectangle;
MyOval myOval;
MyCircle myCircle;
MyFreehand myFreehand; 
MyLine myLine;
MyEraser myEraser;
UndoRedo undoredo;

List<MyEraser> eraserList = new ArrayList<MyEraser>();
List<MyLine> lineList = new ArrayList<MyLine>();
List<MyFreehand> freehandList  = new ArrayList<MyFreehand>();
List<MyCircle> circleList = new ArrayList<MyCircle>();
List<MyOval> ovalList = new ArrayList<MyOval>();
List<MyRectangle> rectangleList = new ArrayList<MyRectangle>();
List<UndoRedo> undoredoList = new ArrayList<UndoRedo>();

public boolean dashedLine = false;
public DashPathEffect dashEffect = new DashPathEffect(new float[]{20,30}, 0);
private Paint mBitmapPaint;
private Bitmap mBitmap; 

public String textValue;

public CanvasView(Context context, AttributeSet attrs) {
    super(context, attrs);
    setBackgroundColor(Color.WHITE);

    if (android.os.Build.VERSION.SDK_INT >= 11) 
    {
        turnOffHardwareAcc();
    }

    erasePaint.setColor(Color.WHITE);
    //erasePaint.setXfermode(new PorterDuffXfermode(PorterDuff.Mode.CLEAR));

    erasePaint.setAntiAlias(true);
    erasePaint.setStyle(Paint.Style.STROKE);
    erasePaint.setStrokeJoin(Paint.Join.ROUND);
    erasePaint.setStrokeWidth(12);

    paint.setColor(Color.BLACK);
    paint.setStyle(Paint.Style.STROKE);

    paint.setAntiAlias(true);
    paint.setStrokeJoin(Paint.Join.ROUND);
    paint.setStrokeWidth(STROKE_WIDTH);
    paint.setTextSize(34);

    setMode(7);//default = 7 - free hand;

    mBitmap = Bitmap.createBitmap(320, 480, Bitmap.Config.ARGB_8888);
    mBitmapPaint = new Paint(Paint.DITHER_FLAG);

    /* input dialog*/

     //setInputDialog();

}
EditText input;
public void setInputDialog(){

    alert = new AlertDialog.Builder(getContext());
    alert.setTitle("Title");
    alert.setMessage("Write text");

    // Set an EditText view to get user input 
    input = new EditText(getContext());
    alert.setView(input);

    alert.setPositiveButton("Ok", new DialogInterface.OnClickListener() {
    public void onClick(DialogInterface dialog, int whichButton) {
         textValue= input.getText().toString();
         Toast.makeText(getContext(), textValue, Toast.LENGTH_SHORT).show();
      // Do something with value!
      }
    });

    alert.setNegativeButton("Cancel", new DialogInterface.OnClickListener() {
      public void onClick(DialogInterface dialog, int whichButton) {
        // Canceled.
      }
    });

    //alert.show();

}

public void setDashLine(){

    dashedLine = true;
    paint = new Paint();
    paint.setPathEffect(dashEffect);
    paint.setStyle(Paint.Style.STROKE);
    paint.setAntiAlias(true);
    paint.setStrokeJoin(Paint.Join.ROUND);
    paint.setStrokeWidth(STROKE_WIDTH);
}

public void setNormalLine(){
    //paint.setColor(Color.BLACK);
    dashedLine = false;

    paint.setPathEffect(null);
    paint.setStyle(Paint.Style.STROKE);
    paint.setPathEffect(null);
    paint.setAntiAlias(true);
    paint.setStrokeJoin(Paint.Join.ROUND);
    paint.setStrokeWidth(STROKE_WIDTH);
}

@TargetApi(11)
public void turnOffHardwareAcc() // to enable dashed lines
{

    this.setLayerType(View.LAYER_TYPE_SOFTWARE, null);
}

//public void setPaint(int color,)

@TargetApi(11)
protected void onDraw(Canvas canvas) {

    if(dashedLine){
        paint.setPathEffect(dashEffect);
    }
    else {
        paint.setPathEffect(null);
    }

    if(bitmap!=null){

        canvas.drawBitmap(bitmap, 0, 0, paint);
         for(MyCircle circle:circleList){// draw circles

             myCanvas.drawCircle(getCircleMidPointX(circle.firstX, circle.lastX),getCircleMidPointY(circle.firstY, circle.lastY),circle.radius,myPaint);
         }

    }

    for(MyLine line:lineList){ //draw lines
         if(dashedLine)
             line.paint.setPathEffect(dashEffect);
         else
             line.paint.setPathEffect(null);
            canvas.drawLine(line.xStart, line.yStart, line.xEnd, line.yEnd, line.paint);
      }

     for(MyCircle circle:circleList){// draw circles

         canvas.drawCircle(getCircleMidPointX(circle.firstX, circle.lastX),getCircleMidPointY(circle.firstY, circle.lastY),circle.radius,paint);
     }

     for(MyOval oval:ovalList){
         if(dashedLine)
             oval.paint.setPathEffect(dashEffect);
         else oval.paint.setPathEffect(null);

           ovalRectangle.set(oval.getX1(),oval.getY1(),oval.getX2(),oval.getY2());
           canvas.drawOval(ovalRectangle, oval.paint);
     }

     for(MyRectangle rectangle:rectangleList){
         if(dashedLine)
             rectangle.paint.setPathEffect(dashEffect);
         else rectangle.paint.setPathEffect(null);

           canvas.drawRect(rectangle.getX1(),rectangle.getY1(),rectangle.getX2(),rectangle.getY2(),rectangle.paint);
     }  

     for(MyEraser e:eraserList){
            canvas.drawPath(e.p,erasePaint);
            invalidate();
     }
     if(textValue!= null)
         canvas.drawText(textValue, xStart, yStart, paint);
     canvas.drawPath(path, paint);
     //path.reset();

}

final OnTouchListener drawLineListener = new OnTouchListener() {
    public boolean onTouch(View v, MotionEvent event) {

        FirstActivity.ll.setVisibility(LinearLayout.GONE);

        switch (event.getAction()) {
          case MotionEvent.ACTION_DOWN:
              myLine = new MyLine();
              myLine.xStart = event.getX();
              myLine.yStart = event.getY();

            return true;

          case MotionEvent.ACTION_MOVE:
          case MotionEvent.ACTION_UP:
            myLine.xEnd = event.getX();
            myLine.yEnd = event.getY();
            invalidate();
            lineList.add(myLine); 
            break;

          default:
            Log.d("mock it up", "Unknown touch event  " + event.toString());
            return false;
        }
        return true;

    }
};

final OnTouchListener drawDashedLineListener = new OnTouchListener() {
    public boolean onTouch(View v, MotionEvent event) {

        FirstActivity.ll.setVisibility(LinearLayout.GONE);

        switch (event.getAction()) {
          case MotionEvent.ACTION_DOWN:
             return true;

          case MotionEvent.ACTION_MOVE:
          case MotionEvent.ACTION_UP:

            break;

          default:
            Log.d("mock it up", "Unknown touch event  " + event.toString());
            return false;
        }
        return true;

    }
};

final OnTouchListener drawCircleListener = new OnTouchListener(){

    public boolean onTouch(View v, MotionEvent event) {

        FirstActivity.ll.setVisibility(LinearLayout.GONE);

        float eventX = event.getX();
        float eventY = event.getY();

        switch (event.getAction()) {
          case MotionEvent.ACTION_DOWN:
           //  path.moveTo(eventX, eventY);
              Toast.makeText(getContext(), "action down - circle",Toast.LENGTH_SHORT).show();
              myCircle = new MyCircle();
              myCircle.firstX = eventX;
              myCircle.firstY = eventY;

            // There is no end point yet, so don't waste cycles invalidating.
            return true;

          case MotionEvent.ACTION_MOVE:

          case MotionEvent.ACTION_UP:
            myCircle.lastX = eventX;
            myCircle.lastY = eventY;

            myCircle.radius = getRadius(myCircle.firstX,myCircle.firstY,myCircle.lastX,myCircle.lastY);

            circleList.add(myCircle);

            invalidate();
            break;

          default:
            Log.d("mock it up", "Unknown touch event  " + event.toString());
            return false;
        }
  return true;
    }

};

final OnTouchListener drawOvalListener = new OnTouchListener() {
        public boolean onTouch(View v, MotionEvent event) {

            FirstActivity.ll.setVisibility(LinearLayout.GONE);

            switch (event.getAction()) {
              case MotionEvent.ACTION_DOWN:
                myOval = new MyOval();
                myOval.setX1(event.getX());
                myOval.setY1(event.getY());
                // There is no end point yet, so don't waste cycles invalidating.
                return true;

              case MotionEvent.ACTION_MOVE:
              case MotionEvent.ACTION_UP:

                  myOval.setX2(event.getX());
                  myOval.setY2(event.getY());

                  invalidate();
                  ovalList.add(myOval);

              default:
                Log.d("mock it up", "Unknown touch event  " + event.toString());
                return false;
            }

        }
    };

final OnTouchListener drawRectangleListener = new OnTouchListener() {

        public boolean onTouch(View v, MotionEvent event) {

            FirstActivity.ll.setVisibility(LinearLayout.GONE);

            switch (event.getAction()) {
              case MotionEvent.ACTION_DOWN:
                  myRectangle = new MyRectangle();
                  myRectangle.setX1(event.getX());
                  myRectangle.setY1(event.getY());
                return true;

              case MotionEvent.ACTION_MOVE:

              case MotionEvent.ACTION_UP:

                  myRectangle.setX2(event.getX());
                  myRectangle.setY2(event.getY());
                  invalidate();
                  rectangleList.add(myRectangle);

                break;

              default:
                Log.d("mock it up", "Unknown touch event  " + event.toString());
                return false;
            }

            return true;
        }
};

final OnTouchListener eraseListener = new OnTouchListener() {

    public boolean onTouch(View v, MotionEvent event) {

    //  erasePaint.setXfermode(new PorterDuffXfermode(PorterDuff.Mode.CLEAR));
        //FirstActivity.ll.setVisibility(LinearLayout.GONE);

        switch (event.getAction()) {
          case MotionEvent.ACTION_DOWN:
             myEraser = new MyEraser();
              lastTouchX = event.getX();
              lastTouchY = event.getY();
              myEraser.mouseDown(event.getX(), event.getY());
              return true;

          case MotionEvent.ACTION_MOVE:
          case MotionEvent.ACTION_UP:
              resetDirtyRect(event.getX(),event.getY());
              int historySize = event.getHistorySize();
              for(int i=0;i<historySize;i++){
                  float historicalX = event.getHistoricalX(i);
                  float historicalY = event.getHistoricalY(i);
                  expandDirtyRect(historicalX, historicalY);

                  myEraser.mouseUp(historicalX, historicalY);
            }
              myEraser.mouseUp(event.getX(), event.getY());
              eraserList.add(myEraser);
             break;

          default:
            Log.d("mock it up", "Unknown touch event  " + event.toString());
            return false;
        }

        invalidate(
                (int) (dirtyRect.left - HALF_STROKE_WIDTH),
                (int) (dirtyRect.top - HALF_STROKE_WIDTH),
                (int) (dirtyRect.right + HALF_STROKE_WIDTH),
                (int) (dirtyRect.bottom + HALF_STROKE_WIDTH));

            lastTouchX = event.getX();
            lastTouchY = event.getY();
       return true;
    }
};

final OnTouchListener drawFreeHandListener = new OnTouchListener() {

    public boolean onTouch(View v, MotionEvent event) {

        FirstActivity.ll.setVisibility(LinearLayout.GONE);

        float eventX = event.getX();
        float eventY = event.getY();

        switch (event.getAction()) {
          case MotionEvent.ACTION_DOWN:
             // path.reset();
            path.moveTo(eventX, eventY);
            lastTouchX = eventX;
            lastTouchY = eventY;
            // There is no end point yet, so don't waste cycles invalidating.
            return true;

          case MotionEvent.ACTION_MOVE:
          case MotionEvent.ACTION_UP:
            // Start tracking the dirty region.
            resetDirtyRect(eventX, eventY);

            // When the hardware tracks events faster than they are delivered, the
            // event will contain a history of those skipped points.
            int historySize = event.getHistorySize();
            for (int i = 0; i < historySize; i++) {
              float historicalX = event.getHistoricalX(i);
              float historicalY = event.getHistoricalY(i);
              expandDirtyRect(historicalX, historicalY);
              path.lineTo(historicalX, historicalY);
            }

            // After replaying history, connect the line to the touch point.
            path.lineTo(eventX, eventY);
            //path.reset();
            break;

          default:
            Log.d("mock it up", "Unknown touch event  " + event.toString());
            return false;
        }

        // Include half the stroke width to avoid clipping.
        invalidate(
            (int) (dirtyRect.left - HALF_STROKE_WIDTH),
            (int) (dirtyRect.top - HALF_STROKE_WIDTH),
            (int) (dirtyRect.right + HALF_STROKE_WIDTH),
            (int) (dirtyRect.bottom + HALF_STROKE_WIDTH));

        lastTouchX = eventX;
        lastTouchY = eventY;

        return true;
    }
};

float xStart,yStart;
final OnTouchListener textListener = new OnTouchListener() {

    public boolean onTouch(View v, MotionEvent event) {
        FirstActivity.ll.setVisibility(LinearLayout.GONE);

    //  Toast.makeText(getContext(), "add some text", Toast.LENGTH_SHORT).show();

        switch (event.getAction()) {
          case MotionEvent.ACTION_DOWN:
              //
              setInputDialog();
              xStart = event.getX();
              yStart = event.getY();
              alert.show();
            break;

          case MotionEvent.ACTION_MOVE:
          case MotionEvent.ACTION_UP:
            //  setInputDialog();
                  break;

          default:
            Log.d("mock it up", "Unknown touch event  " + event.toString());
            return false;
        }

        return true;
    }
};

final OnTouchListener DrawingPanel = new OnTouchListener() {

    public boolean onTouch(View v, MotionEvent event) {

        FirstActivity.ll.setVisibility(LinearLayout.GONE);

    float eventX = event.getX();
    float eventY = event.getY();

    switch (event.getAction()) {
        case MotionEvent.ACTION_DOWN:
         // path.reset();
        path.moveTo(eventX, eventY);
        lastTouchX = eventX;
        lastTouchY = eventY;
        // There is no end point yet, so don't waste cycles invalidating.
        return true;

      case MotionEvent.ACTION_MOVE:
      case MotionEvent.ACTION_UP:
        // Start tracking the dirty region.
        resetDirtyRect(eventX, eventY);

        // When the hardware tracks events faster than they are delivered, the
        // event will contain a history of those skipped points.
        int historySize = event.getHistorySize();
        for (int i = 0; i < historySize; i++) {
          float historicalX = event.getHistoricalX(i);
          float historicalY = event.getHistoricalY(i);
          expandDirtyRect(historicalX, historicalY);
          path.lineTo(historicalX, historicalY);
        }

        // After replaying history, connect the line to the touch point.
        path.lineTo(eventX, eventY);
        //path.reset();
        break;

      default:
        Log.d("mock it up", "Unknown touch event  " + event.toString());
        return false;
    }
    invalidate(
        (int) (dirtyRect.left - HALF_STROKE_WIDTH),
        (int) (dirtyRect.top - HALF_STROKE_WIDTH),
        (int) (dirtyRect.right + HALF_STROKE_WIDTH),
        (int) (dirtyRect.bottom + HALF_STROKE_WIDTH));

    lastTouchX = eventX;
    lastTouchY = eventY;

    return true;
} 
```

};

```
/**
 * Called when replaying history to ensure the dirty region includes all
 * points.
 */
private void expandDirtyRect(float historicalX, float historicalY) {
  if (historicalX < dirtyRect.left) {
    dirtyRect.left = historicalX;
  } else if (historicalX > dirtyRect.right) {
    dirtyRect.right = historicalX;
  }
  if (historicalY < dirtyRect.top) {
    dirtyRect.top = historicalY;
  } else if (historicalY > dirtyRect.bottom) {
    dirtyRect.bottom = historicalY;
  }
}

/**
 * Resets the dirty region when the motion event occurs.
 */
private void resetDirtyRect(float eventX, float eventY) {

  // The lastTouchX and lastTouchY were set when the ACTION_DOWN
  // motion event occurred.
  dirtyRect.left = Math.min(lastTouchX, eventX);
  dirtyRect.right = Math.max(lastTouchX, eventX);
  dirtyRect.top = Math.min(lastTouchY, eventY);
  dirtyRect.bottom = Math.max(lastTouchY, eventY);
}

public void setMode(int mode){
    switch(mode){
    case 1://draw line
        Toast.makeText(getContext(), "draw line", Toast.LENGTH_SHORT).show();
        setOnTouchListener(drawLineListener);
        break;
    case 2://draw dashed line
        Toast.makeText(getContext(), "dashed line", Toast.LENGTH_SHORT).show();
        break;
    case 3:// draw circle
        setOnTouchListener(drawCircleListener);
        break;
    case 4: //draw oval
        setOnTouchListener(drawOvalListener);
        break;
    case 5: //draw rectangle
        setOnTouchListener(drawRectangleListener);
        break;
    case 6: //erase
        setOnTouchListener(eraseListener);
        break;
    case 7: //free-hand
        setOnTouchListener(drawFreeHandListener);
        break;
    case 8:
        setOnTouchListener(textListener);
        break;
    case 9:
        setOnTouchListener(DrawingPanel);
        break;
    }
}

private Bitmap bitmap;
private Canvas myCanvas;
public Paint myPaint;

public void setImage(Bitmap b){
    Toast.makeText(getContext(), "set Bitmap",Toast.LENGTH_SHORT).show();
    bitmap = b.copy(Bitmap.Config.ARGB_8888, true);
    myCanvas = new Canvas(bitmap);

    myPaint = new Paint();
    myPaint.setColor(Color.YELLOW);
    myPaint.setAntiAlias(true);
    myPaint.setStrokeWidth(8);

    invalidate();
}

public void changeColor(int color){
    paint = new Paint(paint);
    paint.setColor(color);
    //myPaint.setColor(color);
}

public float getRadius(float x1,float y1,float x2,float y2){
      float r = (float) (Math.sqrt((double)(Math.pow((y2-y1), 2.0)+Math.pow((x2-x1), 2.0)))/2);
      return r;
  }

public float getCircleMidPointX(float x1,float x2){
      return (x1+x2)/2;
  }

public float getCircleMidPointY(float y1,float y2){
      return (y1+y2)/2;
  } 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-27T11:35:43.113

我认为有一种更简单的撤消方法。每次进行更改之前，使用 getDrawingCache() 检索位图并将其保存到 arrayList。

```
Bitmap b=Bitmap.createBitmap(getDrawingCache());
undos.push(b);
destroyDrawingCache(); 
```

每次单击撤消按钮时，都会检索 arrayList 中的最后一个对象并将其设置为画布的位图。

```
if(!undos.isEmpty()) {
        canvas.drawBitmap(undos.pop(), 0, 0, canvasPaint);
        invalidate();
    } 
```

# cordova - SQL 文件中的 PhoneGap 本地数据库

> ID：15143345
> 
> 赞同：0
> 
> 时间：2013-02-28T18:49:58.720
> 
> 标签：cordova

我有一个 SQL 文件，我想在我的 HTML 中使用它——如何在我的项目中使用它？

我将使用 phonegap 部署我的 html 以在手机中使用。

手机本地不用sql文件，本地怎么获取信息？

（喜欢`select * from from person`）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-29T09:23:38.017

查看存储部分的文档[http://docs.phonegap.com/en/3.0.0/cordova_storage_storage.md.html#Storage](http://docs.phonegap.com/en/3.0.0/cordova_storage_storage.md.html#Storage)

我想最简单的解决方案是将 SQL 直接嵌入到 JS 中（如果它只有少量），就像文档中的这个示例一样：

```
function populateDB(tx) {
    tx.executeSql('DROP TABLE IF EXISTS DEMO');

    //replace these lines with your table schema and starting data
    tx.executeSql('CREATE TABLE IF NOT EXISTS DEMO (id unique, data)');
    tx.executeSql('INSERT INTO DEMO (id, data) VALUES (1, "First row")');
    tx.executeSql('INSERT INTO DEMO (id, data) VALUES (2, "Second row")');
}

function errorCB(err) {
    alert("Error processing SQL: "+err.code);
}

function successCB() {
    alert("success!");
}

//this needs to be called after the phonegap event onDeviceReady() has been called
var db = window.openDatabase("Database", "1.0", "Cordova Demo", 200000);
db.transaction(populateDB, errorCB, successCB); 
```

# servlets - “捕获并记录响应正文”帖子 - 需要一些说明

> ID：15143349
> 
> 赞同：0
> 
> 时间：2013-02-28T18:50:23.660
> 
> 标签：servlets

@BalusC 给出的[“捕获并记录响应正文”](https://stackoverflow.com/questions/3242236/capture-and-log-the-response-body)的答案对我有用。但我想知道为什么只有 3 个 write 方法被覆盖。PrintWriter 中有 print 和 append 方法以及另外 2 个 write 方法。我担心的是我不会因为不覆盖它们而丢失一些响应内容吗？

（我猜这`write(String s)`是在打电话`write(String s, int off, int len)`，这就是你没有覆盖的原因`write(String s)`。同样适用`write(char[] buf)`。请确认，并请我指出任何说明这一点的文档。）

# javascript - 使用第二个切换删除在第一个切换中实现的跨度

> ID：15143351
> 
> 赞同：0
> 
> 时间：2013-02-28T18:50:28.190
> 
> 标签：javascript, jquery

我无法删除在第一次单击切换时创建并在第二次单击切换时删除的跨度。

```
$(document).ready(function(){
$("td").toggle(
    function(){
        var current = $("input[name=prices]:checked").val();
        $(this).html("<img src='images/1.gif'/>");
        $(".summary").append("<br><span class = 'newticket' id = 'null'>");
        $("#null").attr("id",$(this).attr("id"));
        $(".summary").append("1 x ");
        if(current == 'full'){
            $(".summary").append("full price ticket.");
        }
        $(".summary").append(" Seat: ");
        $(".summary").append($(this).attr("id"));
        if(current == 'full'){
            $(".summary").append(" Price: £10</span>");
        }

    },
    function(){
        $(this).html("<img src='images/a.gif'/>");
        $("span#" + $(this).attr("id")).remove();
});
}); 
```

如果我单击表值，则会添加跨度，但是如果我再次单击表值，则不会删除跨度。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T18:53:02.377

您不应该附加未闭合的标签创建一个字符串然后附加它。完整的解决方案。

```
$(document).ready(function(){

    $("td").toggle(
        function(){
            var current = $("input[name=prices]:checked").val();
            $(this).html("<img src='images/1.gif'/>");
            var html = "<br><span class = 'newticket' id = 'null'>";
            htnl += "1 x ";
            if(current == 'full'){ 
                html +="full price ticket.";
            }
           html +=" Seat: " + $(this).attr("id");
            $(".summary").append($(this).attr("id"));
            if(current == 'full'){
                 html +=" Price: £10"
            }

            html += "</span>";
            $(".summary") .append(html);   
        },
        function(){
            $(this).html("<img src='images/a.gif'/>");
            $(".summary span.newticket").remove();
    });

}); 
```

# php - 如何在包含某些内容的数组中搜索值？

> ID：15143356
> 
> 赞同：0
> 
> 时间：2013-02-28T18:50:40.647
> 
> 标签：php, json, google-maps-api-3, multidimensional-array

我有一个从[Google Maps API](https://developers.google.com/maps/)返回的 JSON ，我想只检索州/县/地区和国家/地区。

我使用以下简单代码通过 PHP 获取此 json：

```
$url = 'http://maps.googleapis.com/maps/api/geocode/json?address=the+address&sensor=true&key=my+api+key';

// make the HTTP request
$data = @file_get_contents($url);

$jsondata = json_decode($data,true); 
```

回显 $data 给了我类似的东西：

```
{
"results" : [
  {
     "address_components" : [
        {
           "long_name" : "9",
           "short_name" : "9",
           "types" : [ "street_number" ]
        },
        {
           "long_name" : "Hanover Street",
           "short_name" : "Hanover St",
           "types" : [ "route" ]
        },
        {
           "long_name" : "Edinburgh",
           "short_name" : "Edinburgh",
           "types" : [ "locality", "political" ]
        },
        {
           "long_name" : "City of Edinburgh",
           "short_name" : "City of Edinburgh",
           "types" : [ "administrative_area_level_2", "political" ]
        },
        {
           "long_name" : "Scotland",
           "short_name" : "Scotland",
           "types" : [ "administrative_area_level_1", "political" ]
        },
        {
           "long_name" : "United Kingdom",
           "short_name" : "GB",
           "types" : [ "country", "political" ]
        },
        {
           "long_name" : "EH2",
           "short_name" : "EH2",
           "types" : [ "postal_code_prefix", "postal_code" ]
        },
        {
           "long_name" : "Edinburgh",
           "short_name" : "Edinburgh",
           "types" : [ "postal_town" ]
        }
     ]
  }
],
"status" : "OK"
} 
```

我想要访问的是多维数组 *address_components* 内部，我假设来自 Google 的每个 JSON 响应每次都会给我相同数量的数组，所以我一直在使用简单的数字索引来访问我需要的数据.

即我认为某些东西`$jsondata['results'][0]['address_components'][4]['long_name']`总是会给我'administrative_area_level_2'的long_name值 - 在这种情况下是'爱丁堡市'，但我错了。

有时地址组件更多，有时更少。这意味着我需要一种搜索​​这个数组然后获取它的索引的方法。

这是怎么做的？如，我如何搜索哪个地址组件的类型为“administrative_area_level_1”，然后返回它的“long_name”值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T19:07:08.110

您可以尝试`foreach`通过结果循环检查您需要的数据。如果您专门在地址组件之一中寻找“administrative_area_level_1”，您可以检查它的`type`.

像这样的东西：

```
foreach ($jsondata['results'][0]['address_components'] as $comp) {
    //loop through each component in ['address_components']
    foreach ($comp['types'] as $currType){
        //for every type in the current component, check if it = the check
        if($currType == 'administrative_area_level_1'){
            echo $comp['long_name'];
            //Do whatever with the component, print longname, whatever you need
            //You can add $comp into another array to have an array of 'administrative_area_level_1' types
        }
    }
} 
```

这应该是按组件级别循环/搜索组件上的结果集。从那里，您可以处理“当前组件”，您可以对其进行进一步的逻辑/解析。在那个“当前组件”中，你有你正在检查的“类型”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T19:07:20.813

您可以使用函数循环遍历所有数组并返回所需的值（如果找到的话）。

```
$jsondata = json_decode($data, true);

function getAdministrativeAreaLevel2($addresses) {
    if (!is_array($addresses) || empty($addresses)) {
        return; // we need an array with data
    }

    foreach ($addresses as $address) {
        if (!isset($address['address_components']))
            continue; // nothing to look at
        foreach ($address['address_components'] as $compontent) {
            // should be an array with types
            if (is_array($compontent['types']) && !empty($compontent['types'])) {
                foreach ($compontent['types'] as $type) {
                    if ($type == 'administrative_area_level_2') {
                        return $compontent['long_name'];
                    }
                }
            }
        }
    }
}
echo getAdministrativeAreaLevel2($jsondata['results']); 
```

# google-drive-api - 如何通过 google drive api 获取准确的文件列表

> ID：15143359
> 
> 赞同：1
> 
> 时间：2013-02-28T18:50:54.553
> 
> 标签：google-drive-api

我正在使用 Google drive api（`java`版本）开发应用程序。该应用程序将文件保存在模仿文件系统的 Google 驱动器上（即具有文件夹树）。我首先使用 files.list() 方法检索 Google 驱动器上的所有现有文件，但随着文件数量的增加（在几百个之后），响应变得更慢。

Java Google API 将响应超时硬编码为 20 秒。我更改了代码以递归方式一次加载一个文件夹（使用`files.list().setQ("'folderId' in parents)`）。这种方法解决了超时问题，但它始终丢失了我文件夹中大约 2% 的文件（每次都丢失了相同的文件）。如果我直接搜索文件名，我可以通过 Google 驱动器 Web 浏览器界面甚至通过 Google 驱动器 API 看到这些文件`files.list().setQ("title='filename'")`。

我假设“在父母中”搜索使用了一些可能只会定期更新的不精确索引。我需要一个更强大、更准确的文件列表。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-11-21T17:04:29.357

您能否利用 Page 机制进行多次查询，而每个查询只要求少量结果？

# python - 创建一个类级别的装饰器来自动添加一个属性

> ID：15143364
> 
> 赞同：3
> 
> 时间：2013-02-28T18:51:10.290
> 
> 标签：python, python-2.7, python-3.x, properties, python-decorators

我想创建一个类级别的装饰器，它会自动将属性添加到对象，包括适当的 getter 和 setter 方法以及支持变量。例如：

```
@autoproperty("foo", can_get=True, can_set=True, allow_null=False, default_value=0)
@autoproperty("baz", can_get=True, can_set=False, allow_null=True, default_value=0)
@autoproperty("bar")
class SomeNonTrivialClass(object):
   def __init__(self):
      #lots of stuff going on here

   def discombobulate(self):
      #this is obviously a very trivial example
      local_foo = self.foo;

      if (local_foo > 10):
         raise RuntimeError("Foo can never be more than 10")
      else:
         #do whatever with foo

if __name__ == '__main__':
   test = SomeNonTrivialClass()

   test.foo = 5
   test.discombobulate()
   test.foo = 11
   test.discombobulate() 
```

我经常发现自己创建了许多“半复杂”的 getter/setter（它们可以只用一个简单的属性来完成，但它们需要默认值和 null 保护。我希望能够指定一个能够完成繁重工作的装饰器在类的新实例上创建属性。

如果我在这种方法上偏离了基础，我对同样可行的方法持开放态度。

任何帮助，将不胜感激。

我正在使用 python 3.X 和 python 2.7，所以在任何一个中都可以使用的东西是首选但不是必需的。

更新：我在我正在寻找的东西中添加了更多种类。一般来说，我需要能够创建很多这些简单的自动属性（ala C# auto-property，但具有更多的灵活性）。我不一定要公开后备存储，但我确实想确保对实例化对象（不一定是类）的检查显示已创建的属性。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-28T19:00:53.327

下面的类装饰器会这样做：

```
def autoproperty(name, can_get=True, can_set=True, allow_null=False, default_value=0):
    attribute_name = '_' + name
    def getter(self):
        return getattr(self, attribute_name, default_value)
    def setter(self, value):
        if not allow_null and value is None:
            raise ValueError('Cannot set {} to None'.format(name))
        setattr(self, attribute_name, value)

    prop = property(getter if can_get else None, setter if can_set else None)

    def decorator(cls):
        setattr(cls, name, prop)
        return cls

    return decorator 
```

但您也可以创建一个属性工厂：

```
def autoproperty(attribute_name, can_get=True, can_set=True, allow_null=False, default_value=0):
    def getter(self):
        return getattr(self, attribute_name, default_value)
    def setter(self, value):
        if not allow_null and value is None:
            raise ValueError('Cannot set {} to None'.format(name))
        setattr(self, attribute_name, value)
    return property(getter if can_get else None, setter if can_set else None) 
```

然后在类中设置：

```
class SomeNonTrivialClass(object):
    # ...

    foo = autoproperty('_foo', can_get=True, can_set=True, allow_null=False, default_value=0) 
```

*如果您需要创建多个*属性（可能具有相互依赖关系），那么类装饰器会更有意义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T19:00:36.757

这是一种更直接的方法，它避免了装饰类。

```
class SomeNonTrivialClass(object):
   def __init__(self):
      #lots of stuff going on here

   foo = autoproperty("foo", can_get=True, can_set=True, allow_null=False, default_value=0)

   def discombobulate(self):
      #this is obviously a very trivial example
      local_foo = self.foo;

class autoproperty(property):
    def __init__(self, name, can_get, can_set, allow_null, default_value):
        ... 
```

# qt - OS X 上的 QT，如何检测单击应用程序 Dock 图标

> ID：15143369
> 
> 赞同：6
> 
> 时间：2013-02-28T18:51:18.180
> 
> 标签：qt

我有一个开放的 Qt Mac 应用程序。我正在单击应用程序图标

有没有办法在应用程序中获得通知？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2015-03-02T20:17:50.943

由于弃用警告（OS X 10.5 后）和类型错误，我无法获得正确编译的原始答案；我更改了一些类型名称并对其进行编译，但代码仍然无法正常工作。

事实证明，较新版本的 Qt（4.8.7+，包括 5.x；我使用 5.4.1）实现了我们要添加的方法，`class_addMethod`如果该方法已经存在，则会失败。看到[这个 QTBUG](https://bugreports.qt.io/browse/QTBUG-42627)。
注意：上面的错误报告包含一个稍微不同的解决方案（我自己修复问题后发现的）。

一种对我有用的解决方案是检查该方法是否存在。如果是，我们将其替换。如果没有，我们只需添加它。
我没有在旧的 Qt 版本上测试过这段代码，但它使用了 OPs 逻辑，所以它应该可以工作。

这是我的代码。在 OP 的情况下，所有代码都在 QApplication 子类的 .cpp 文件中。

```
#ifdef Q_OS_MAC
#include <objc/objc.h>
#include <objc/message.h>
void setupDockClickHandler();
bool dockClickHandler(id self,SEL _cmd,...);
#endif 
```

我的 QApplication 子类构造函数包含

```
#ifdef Q_OS_MAC
    setupDockClickHandler();
#endif 
```

最后，在同一个文件的某个地方（在我的例子中，在底部）：

```
#ifdef Q_OS_MAC
void setupDockClickHandler() {
    Class cls = objc_getClass("NSApplication");
    objc_object *appInst = objc_msgSend((objc_object*)cls, sel_registerName("sharedApplication"));

    if(appInst != NULL) {
        objc_object* delegate = objc_msgSend(appInst, sel_registerName("delegate"));
        Class delClass = (Class)objc_msgSend(delegate,  sel_registerName("class"));
        SEL shouldHandle = sel_registerName("applicationShouldHandleReopen:hasVisibleWindows:");
        if (class_getInstanceMethod(delClass, shouldHandle)) {
            if (class_replaceMethod(delClass, shouldHandle, (IMP)dockClickHandler, "B@:"))
                qDebug() << "Registered dock click handler (replaced original method)";
            else
                qWarning() << "Failed to replace method for dock click handler";
        }
        else {
            if (class_addMethod(delClass, shouldHandle, (IMP)dockClickHandler,"B@:"))
                qDebug() << "Registered dock click handler";
            else
                qWarning() << "Failed to register dock click handler";
        }
    }
}

bool dockClickHandler(id self,SEL _cmd,...) {
    Q_UNUSED(self)
    Q_UNUSED(_cmd)
    // Do something fun here!
    qDebug() << "Dock icon clicked!";

    // Return NO (false) to suppress the default OS X actions
    return false;
}
#endif 
```

另请参阅[有关 applicationShouldHandleReopen:hasVisibleWindows: 方法的 Apple 文档](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/NSApplicationDelegate_Protocol/#//apple_ref/occ/intfm/NSApplicationDelegate/applicationShouldHandleReopen:hasVisibleWindows:)。

为了编译它，您还需要链接一些额外的框架。
使用 qmake，我将以下内容添加到我的 .pro 文件中：

```
LIBS += -framework CoreFoundation -framework Carbon -lobjc 
```

如果您手动编译，这些标志当然正是您应该添加到 c++ 或 clang++ 命令行的内容。
这应该是所需要的一切。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-12T14:17:36.330

这很疯狂，但我明白了，而且没有任何 Objective-C 编码：

我派生了QApplication。在派生类的 *.cpp 部分中，我输入：

```
#ifdef Q_OS_MAC

#include <objc/objc.h>
#include <objc/message.h>

bool dockClickHandler(id self,SEL _cmd,...)
{
    Q_UNUSED(self)
    Q_UNUSED(_cmd)
   ((MyApplictionClass*)qApp)->onClickOnDock();
     return true;
}

#endif 
```

在我的派生应用程序类构造函数中，我输入：

```
#ifdef Q_OS_MAC

    objc_object* cls = objc_getClass("NSApplication");
    SEL sharedApplication = sel_registerName("sharedApplication");
    objc_object* appInst = objc_msgSend(cls,sharedApplication);

    if(appInst != NULL)
    {
        objc_object* delegate = objc_msgSend(appInst, sel_registerName("delegate"));
        objc_object* delClass = objc_msgSend(delegate,  sel_registerName("class"));
        const char* tst = class_getName(delClass->isa);
        bool test = class_addMethod((objc_class*)delClass, sel_registerName("applicationShouldHandleReopen:hasVisibleWindows:"), (IMP)dockClickHandler,"B@:");

        if (!test)
        {
            // failed to register handler...
        }
    }

#endif 
```

在我的应用程序类中添加了这个简单的方法（注意它是从我的答案顶部的处理程序中引用的）

```
void MyApplictionClass::onClickOnDock()
{
  // do something... 
} 
```

像魅力一样工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-09-29T12:08:34.890

QEvent::ApplicationActivate 的问题在于它会在每次激活时发出 - 例如，即使您在 Application Switcher 上切换到应用程序。本机行为是仅在 Dock 图标单击时显示应用程序，而不是在您通过 cmd+tab 切换时显示应用程序。

但是，有一个至少适用于 Qt 5.9.1 的 hack。Dock 图标单击会产生 2 个连续的 QEvent::ApplicationStateChangeEvent 事件，同时 cmd+tab - 只有一个。因此，此代码将非常准确地发出 Dock click 信号。App 类是继承自 QApplication 的应用程序类，也是自身的事件过滤器。

```
bool App::eventFilter(QObject* watched, QEvent* event)
{
#ifdef Q_OS_MACOS
    if (watched == this && event->type() == QEvent::ApplicationStateChange) {
        auto ev = static_cast<QApplicationStateChangeEvent*>(event);
        if (_prevAppState == Qt::ApplicationActive
                && ev->applicationState() == Qt::ApplicationActive) {
            emit clickedOnDock();
        }
        _prevAppState = ev->applicationState();
    }
#endif // Q_OS_MACOS
    return QApplication::eventFilter(watched, event);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-09-07T11:34:45.340

从 Qt5.4.0 开始，您可以处理与单击 Dock 相关的 QEvent：QEvent::ApplicationActivate。

[https://bugreports.qt.io/browse/QTBUG-10899](https://bugreports.qt.io/browse/QTBUG-10899)

[https://doc.qt.io/qt-5/qevent.html](https://doc.qt.io/qt-5/qevent.html)

# ws-security - WS 安全 Java 客户端

> ID：15143370
> 
> 赞同：1
> 
> 时间：2013-02-28T18:51:19.757
> 
> 标签：ws-security

我确实编写了一个 Java 客户端并使用 WS-security 调用了一个 web 服务。为了生成类，我使用了轴。

基本上，我有一个类 Credentials，它有一个用户和密码，一个包含凭据的类标头，以及另一个包含标头的类 ServiceDispatcherRequest。

我试过这段代码

```
 ServiceDispatcherServiceLocator service = new ServiceDispatcherServiceLocator();

ServiceDispatcherPortType port = service.getServiceDispatcherPortType();

ServiceDispatcherRequest request = new ServiceDispatcherRequest();

Credentials auth = new Credentials ("1", "xpto", "xpto");

Credentials[] credentials = new Credentials[10];

credentials[1]= auth;

Header header = new Header();

header.setCredentials(credentials);

request.setHeader(header);

ServiceDispatcherResponse response = port.serviceDispatcherOp(request); 
```

但我收到以下错误

**已针对安全性配置服务“服务”，但无法在消息上下文中找到任何 AuthenticationRequest。没有 AuthenticationRequest 无法进行身份验证。**

所以我搜索了 AuthenticationRequest 类并尝试了这个：

```
 Message message  = MessageFactory.getInstance().getMessage();

    AuthenticationRequest authRequest = new AuthenticationRequestImpl.Builder().username(user).password(pass.toCharArray()).build(); 

    message.getContext().setContext(SecurityService.AUTH_REQUEST,  authRequest); 
```

但我不知道如何将 AuthenticationRequest 发送到网络服务。

如果有任何帮助，我将不胜感激。

# php - Highcharts、MYSQL 和向下钻取

> ID：15143374
> 
> 赞同：0
> 
> 时间：2013-02-28T18:51:29.847
> 
> 标签：php, mysql, highcharts, drilldown

我真的需要能够对数据列执行向下钻取。请注意，每月将有 4 列数据。

我还在 Highcharts 网站上看到了下钻列的示例。如果数据是硬编码的，我确实理解它是如何工作的。但是这些数据需要从数据库中提取。

我可以从以下 my_data.php 文件中获取基本图表。

```
[{"name":"ONE","data":[1077668]},{"name":"TWO","data":[39657923]}, {"name":"THREE","data":[99428783]},{"name":"FOUR","data":[4431354]}]

<script type="text/javascript">
    $(function () {
        var chart;
        $(document).ready(function() {
            $.getJSON("my_data.php", function(json) {

                chart = new Highcharts.Chart({
                    chart: {
                        renderTo: 'container',
                        type: 'column',
                        marginRight: 130,
                        marginBottom: 25
                    },
                    title: {
                        text: 'testing',
                        x: -20 //center
                    },
                    subtitle: {
                        text: '',
                        x: -20
                    },
                    xAxis: {
                        categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
                    },
                    yAxis: {
                        title: {
                            text: 'Amount'
                        },
                        plotLines: [{
                            value: 0,
                            width: 1,
                            color: '#808080'
                        }]
                    },
                    tooltip: {
                        formatter: function() {
                            formatter: function() {
                                return '<b>'+ this.series.name +'</b><br/>'+
                                    this.x +': '+ this.y;
                            }

                        },
                    legend: {
                        layout: 'vertical',
                        align: 'right',
                        verticalAlign: 'top',
                        x: -10,
                        y: 100,
                        borderWidth: 0
                    },
                    series: json
                });
            });
        });
    });
</script> 
```

我真的很困惑在这种类型的图表中我会在哪里放置下钻调用？我知道它应该像下面这样。我还认为不同的钻取会有多个 if/else 语句。

```
click: function() {
    var drilldown = this.drilldown;
    if (drilldown) { // drill down
        var chart = this.series.chart;
        $.getJSON(...., function(data){
            chart.setTitle({
                text: data.name
            });
            setChart(data.name, data.categories, data.data, data.color, data.level);
        });
    } else { // restore
        setChart(name, categories, data, null, level);    
    }
} 
```

如果我使用了错误的图表数据，请告诉我。我可以使用这样的东西，但我在使用数据库中的初始数据生成图表时遇到问题。因为我会在哪里设置钻孔名称（如 0 级、1 级等）有同样的问题

```
var colors = Highcharts.getOptions().colors,
categories = ['MSIE', 'Firefox', 'Chrome', 'Safari', 'Opera'],
name = 'Browser brands',
data = [{
    y: 55.11,
    color: colors[0],
    drilldown: {
        name: 'MSIE versions',
        categories: ['MSIE 6.0', 'MSIE 7.0', 'MSIE 8.0', 'MSIE 9.0'],
        data: [10.85, 7.35, 33.06, 2.81],
        color: colors[0]
    }
}, {
    y: 21.63,
    color: colors[1],
    drilldown: {
        name: 'Firefox versions',
        categories: ['Firefox 2.0', 'Firefox 3.0', 'Firefox 3.5', 'Firefox 3.6', 'Firefox 4.0'],
        data: [0.20, 0.83, 1.58, 13.12, 5.43],
        color: colors[1]
    }
}, { 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T11:49:49.427

您需要以 JSON 格式从 php 获取数据，用于向下钻取。

从 php 准备数据的解决方案可在此处获得：http: [//docs.highcharts.com/#preprocessing](http://docs.highcharts.com/#preprocessing)

# c# - 参数名称前面的@ 有什么作用？

> ID：15143377
> 
> 赞同：6
> 
> 时间：2013-02-28T18:51:41.100
> 
> 标签：c#, sql, winforms, visual-studio

`@`在参数 SQL 查询前面插入符号有什么作用？

例如：

```
using (SqlCommand cmd = new SqlCommand("INSERT INTO [User] values (@Forename, @Surname, @Username, @Password)", con))
{
    cmd.Parameters.AddWithValue("@Forename", txtForename.Text);
    cmd.Parameters.AddWithValue("@Surname", txtSurname.Text);
    cmd.Parameters.AddWithValue("@UserName", txtUsername.Text);
    cmd.Parameters.AddWithValue("@Password", txtPassword.Text);

    cmd.ExecuteNonQuery();
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-28T18:53:13.463

这正是表明它*是*查询中的参数名称的原因——而不是尝试使用列中的字段。

目前尚不清楚在构造对象时是否严格需要它`SqlParameter`，但我认为保持一致是有意义的:)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-28T19:07:44.230

与其他人在这里所说的相反，这个`@`角色本身并没有做任何事情。您可以添加参数

```
.AddWithValue("ParaName",value); 
```

或者

```
.AddWithValue("@ParaName",value); 
```

它们都将与`@ParamName`数据库端命名的参数匹配。所以它不是必需的。

话虽如此，始终`@`在参数前面使用 是一种非常标准的做法，因为这正是它在数据库端的命名方式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-28T18:53:09.593

没什么神奇的——这只是 SQL 用来表示参数和局部变量的语法。`@`它与告诉编译器不要处理字符串文字中的转义序列的 C#字符不同：

```
string stringWithSlashes = @"Use '\n' to add a new line"; 
```

或者允许您使用保留字作为变量名：

```
string @class = "Geometry"; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-28T18:53:18.853

`@`表示它是一个输入/输出参数，其值可以从脚本外部传递。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-28T18:54:13.483

`@`符号表示*参数名称*。使用列中的字段。[`SqlParameterCollection`](http://msdn.microsoft.com/en-us/library/4wce29x9.aspx)

 *```
Parameters

parameterName
Type: System.String

The name of the parameter. 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-28T18:54:43.657

在这种情况下，@ 是 SQL Server 构造。由于 T-SQL（SQL Server 编程语言）使用 @ 符号表示变量，因此 SQL Server 查询的参数使用 @ 符号指定。*

# javascript - webgl应用程序中的gl-matrix“无法读取未定义的属性0”

> ID：15143378
> 
> 赞同：2
> 
> 时间：2013-02-28T18:51:48.510
> 
> 标签：javascript, 3d, webgl

我通过阅读 Apress 的 HTML5 开始 WebGl 开始学习 webgl，它推荐 gl-matrix.js 来处理矩阵运算，当使用 mat4.translate 函数时，它具有以下实现

```
mat4.translate = function (out, a, v) {
    var x = v[0], y = v[1], z = v[2],
    a00, a01, a02, a03,
    a10, a11, a12, a13,
    a20, a21, a22, a23;

if (a === out) {
    out[12] = a[0] * x + a[4] * y + a[8] * z + a[12];
    out[13] = a[1] * x + a[5] * y + a[9] * z + a[13];
    out[14] = a[2] * x + a[6] * y + a[10] * z + a[14];
    out[15] = a[3] * x + a[7] * y + a[11] * z + a[15];
} else {
    a00 = a[0]; a01 = a[1]; a02 = a[2]; a03 = a[3];
    a10 = a[4]; a11 = a[5]; a12 = a[6]; a13 = a[7];
    a20 = a[8]; a21 = a[9]; a22 = a[10]; a23 = a[11];

    out[0] = a00; out[1] = a01; out[2] = a02; out[3] = a03;
    out[4] = a10; out[5] = a11; out[6] = a12; out[7] = a13;
    out[8] = a20; out[9] = a21; out[10] = a22; out[11] = a23;

    out[12] = a00 * x + a10 * y + a20 * z + a[12];
    out[13] = a01 * x + a11 * y + a21 * z + a[13];
    out[14] = a02 * x + a12 * y + a22 * z + a[14];
    out[15] = a03 * x + a13 * y + a23 * z + a[15];
}

return out; 
```

};

通过以下调用

```
mat4.translate(mvMatrix,[0, 0, -2.0]); 
```

我收到以下错误：尝试分配 vec3 v 组件时给出“无法读取未定义的属性 0”。

有什么帮助吗？问候

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T15:41:23.667

本书使用的 glMatrix 版本很可能是[1.3.7](https://github.com/toji/gl-matrix/tree/v1.3.7)，而最近发布的版本是 2.1.0。自 2.0 起，界面已更改以保持一致性，与您在书中看到的不符。

如果您想使用最新最好的 glMatrix，您需要参考[文档](http://glmatrix.net/docs/2.1.0/)以获取正确的参数。否则只需下载 1.3.7 并按照书中的说明使用它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-12-21T16:19:08.260

更新 gl-matrix 中的新 API：

```
mat4.perspective(pMatrix, 45, canvas.width / canvas.height, 0.1, 100.0);                                                               
mat4.identity(mvMatrix);                                     
mat4.translate(mvMatrix, mvMatrix, [0, 0, -2.0]); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-12-29T15:22:52.283

**旧 API：gl-matrix-1.x**

```
mat4.perspective(45, gl.viewportWidth / gl.viewportHeight, 0.1, 100.0, pMatrix);
mat4.identity(mvMatrix);
mat4.translate(mvMatrix, [-1.5, 0.0, -7.0]); 
```

**新 API：gl-matrix-2.x**

```
mat4.perspective(pMatrix, 45, canvas.width / canvas.height, 0.1, 100.0);                                                               
mat4.identity(mvMatrix);
mat4.translate(mvMatrix, mvMatrix, [-1.5, 0.0, -7.0]); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-09-02T07:39:08.523

是的，我在最新的 glmatrix.min.js 中遇到了同样的问题。[但是，在使用来自https://www.versioneye.com/javascript/toji:gl-matrix/1.3.7](https://www.versioneye.com/javascript/toji:gl-matrix/1.3.7)的1.3.7 版后 ，它得到了解决。

# linux - 在 iptables 中匹配 PREROUTING 链中的数据包

> ID：15143379
> 
> 赞同：1
> 
> 时间：2013-02-28T18:51:52.993
> 
> 标签：linux, firewall, iptables, netfilter

我正在尝试配置一个防火墙，它将根据数据包的内容阻止或更改数据包的目的地，具体来说 - 对某些主机上某些页面的 HTTP 请求（是的，这是另一个“伟大的防火墙”）。我对阻塞没有问题，它很简单：

```
iptables -A FORWARD -m string --string "Host: www.host.com" --algo bm -j DROP 
```

问题在于更改目标地址。只有在 nat 表中的 PREROUTING 链中才有可能。但规则如

```
iptables -t nat -A PREROUTING -m string --string "Host: www.host.com" --algo bm -j DNAT --to-destination 1.2.3.4 
```

只是永远不会触发。我试图在 mangle 表中标记 PREROUTING 链中的数据包并检查 nat/PREROUTING 中的标记。数据包被标记但从未在 nat/PREROUTING 中捕获。

我做错了什么（当然，除了这整件事）？

# android - 无法在 AVD Manager 中更改目标 API

> ID：15143381
> 
> 赞同：13
> 
> 时间：2013-02-28T18:52:01.100
> 
> 标签：android, eclipse, avd

当我在 AVD Manager 中创建新的虚拟设备时，在目标下拉菜单中我只有两个可用选项：API 级别 8 和 17（2.2 和 4.2.2），尽管我已经安装了所有 API 及其所有子组件. 更重要的是，如果我选择了 4.2.2，则 OK 按钮被禁用。

如何将目标 API 添加到 AVD 管理器？它们不是直接链接到我安装的 SDK 吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-02-28T18:54:33.950

它们与您安装的 SDK 版本无关；可用的 AVD 版本与您通过 SDK 管理器安装的系统映像相关联。

例如，您可以在 SDK 管理器中看到 Android 4.2 (API17) 下的 ARM EABI v7a System Image、Intel x86 Atom System Image 和 MIPS System Image。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-11-06T14:44:19.317

刚遇到同样的事情。尝试重新启动 Eclipse。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-30T10:23:56.957

也许您需要检查 SDK 位置的路径，它可能指向仅安装了 Android 4.2.2-API Level 17 和 Android 2.2-API Level 8 的其他 SDK 位置。

您可以通过转到 Window -> Preferences（在您的 Eclipse 中），在 Preferences goto Android 中执行此操作，在 Android 中您将看到 SDK Location。浏览并将 SDK Location 更改为安装 Android SDK 工具的 SDK 位置。例如：C:\Program Files (x86)\Android\android-sdk

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-12-28T10:22:52.737

只需转到 Android SDK Manager 1) 确保您安装 SDK 的路径点

2）检查Android 4.2.2（API 17）复选框

3）按安装按钮

# jquery - 如何删除onclick功能并通过jquery使用相同的功能启用它？

> ID：15143382
> 
> 赞同：0
> 
> 时间：2013-02-28T18:52:05.337
> 
> 标签：jquery, onclick, disable-link

我有以下代码。我想要实现的是，当我单击 1 时，它应该禁用 1 onclick 功能，其余的需要可用。当我单击 2 时，1 和 3 需要 onclick 功能，但 2 不需要它。

我需要实现分页。我该怎么做。

```
<div class="test">
  <a href="javascript:void(0);" onclick="test1(1);">1</a>
  <a href="javascript:void(0);" onclick="test1(2);">2</a>
  <a href="javascript:void(0);" onclick="test1(3);">3</a>
</div>

function test1(val)
  {
    $(this).attr('onclick','').unbind('click');
            alert("hai");
  } 
```

但是我每次都收到警报。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T18:59:02.637

我想你想禁用最后点击按钮的功能。你可以这样做：

```
<div class="test">
  <a href="javascript:void(0);" onclick="test1(1);">1</a>
  <a href="javascript:void(0);" onclick="test1(2);">2</a>
  <a href="javascript:void(0);" onclick="test1(3);">3</a>
</div> 
```

Javascript

```
var lastClickedInt;
function test1(val)
  {
    if (val !== lastClickedInt) {
        lastClickedInt = val;
        alert("hai");
    }
  } 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-28T18:59:43.547

最好的方法是使用类和事件委托：

```
<div class="test">
  <a href="javascript:void(0);" onclick="test1(1);">1</a>
  <a href="javascript:void(0);" onclick="test1(2);">2</a>
  <a href="javascript:void(0);" onclick="test1(3);">3</a>
</div>

$('div.test').on('click','a',function(e) {
  if(!$(this).hasClass('disabled')) {
    //you're event delegation code
  }

  //disable this link and "enable" it's siblings
  $(this).addClass('disabled').siblings().removeClass('disabled');
}); 
```

# symfony - PropelParamConverter 不工作

> ID：15143385
> 
> 赞同：0
> 
> 时间：2013-02-28T18:52:12.440
> 
> 标签：symfony, propel

有人可以告诉我如何让 PropelParamConverter 为 Symfony2 项目工作吗？我已经安装了 'SensioFrameworkExtraBundle' 捆绑包并为隐式案例工作（控制器上方没有注释）。但使用此代码：

```
/**
 * @ParamConverter("user", class="AcmeBundle:User", options={"mapping"={"username":"username"}})
 * @ParamConverter("gallery", class="AcmeBundle:Gallery", options={"mapping"={"id":"id"}})
 */
public function showAction(User $user, Gallery $gallery)
{
     ...
} 
```

我得到以下异常：

> [语义错误] Acme\AcmeBundle\Controller\Frontend\GalleryController::showAction() 方法中的注释“@Sensio\Bundle\FrameworkExtraBundle\Configuration\ParamConverter”不存在，或无法自动加载。

异常似乎是在 Doctrine 代码（DocParse 对象）中引发的，这让我感到惊讶，因为我的 AppKernel 中甚至没有激活 DoctrineBundle！

请告诉我是否遗漏了 Symfony2/Propel/FrameworkExtra 配置中的某些内容？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T22:45:08.713

SensioFrameworkExtraBundle 附带的 ParamConverter 不支持 Propel，只有一个 Doctrine - 和 DataTime ParamConverter。

如果您安装了[PropelBundle](https://github.com/propelorm/PropelBundle)（如果您使用 Propel，则应该安装），它将附带一个 Propel ParamConverter。请参阅[文档](https://github.com/propelorm/PropelBundle/blob/1.1/Resources/doc/param_converter.markdown)如何使用它。

# python - 修改列表中的元组

> ID：15143388
> 
> 赞同：2
> 
> 时间：2013-02-28T18:52:17.630
> 
> 标签：python, python-2.7

我有这样的时间输入：

```
09:00 12:00
10:00 13:00
11:00 12:30
12:02 15:00
09:00 10:30 
```

我正在尝试将其构建为元组列表，转换为分钟：

```
[(540, 720), (600, 780), (660, 750), (722, 900), (540, 630)] 
```

我想要一种更干净、更 Pythonic 的方式来进行转换。我目前有一种笨拙的方法：

```
def readline(): 
    return sys.stdin.readline().strip().split()

natimes = [tuple(readline()) for _ in xrange(linesofinput))]
for i, (a,b) in enumerate(natimes):
    c = int(a.split(':')[0])* 60 + int(a.split(':')[1])
    d = int(b.split(':')[0])* 60 + int(b.split(':')[1])
    natimes[i] = (c,d) 
```

只是觉得我在这里没有正确使用 Python。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-28T19:01:27.017

使用功能：

```
def time_to_int(time):
    mins,secs = time.split(':')
    return int(mins)*60 + int(secs)

def line_to_tuple(line):
    return tuple(time_to_int(t) for t in line.split())

natimes = [line_to_tuple(line) for line in sys.stdin] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-28T19:02:32.290

避免重复昂贵的操作，例如`str.split`. 下面是一个简单的答案：

```
>>> print(s)
09:00 12:00
10:00 13:00
11:00 12:30
12:02 15:00
09:00 10:30
>>> def to_minutes(s):
...     hour, min = map(int, s.split(":"))
...     return hour * 60 + min
... 
>>> to_minutes("12:30")
750
>>> res = []
>>> for i1, i2 in map(str.split, s.split("\n")):
...     res.append((to_minutes(i1), to_minutes(i2)))
... 
>>> res
[(540, 720), (600, 780), (660, 750), (722, 900), (540, 630)] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-28T19:13:02.390

这是另一个选项，使用正则表达式：

```
import re
regex = re.compile('\s*(\d\d):(\d\d)\s+(\d\d):(\d\d)\s*')
natimes = []

for line in sys.stdin.readline():
    m = regex.match(line)
    if m:
        natimes.append((int(m.group(1))*60 + int(m.group(2)),
                        int(m.group(3))*60 + int(m.group(4)))) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-28T19:07:17.623

这是我的做法（但在此示例中使用数据字符串）：

```
data = """09:00 12:00
10:00 13:00
11:00 12:30
12:02 15:00
09:00 10:30
"""

def minutes(s):
    hr, min = s.split(":")
    return int(hr) * 60 + int(min)

rv = []
for line in data.splitlines(): # may also use readlines from a file object
    rv.append(tuple([minutes(s) for s in line.split()]))

rv
# OUT: [(540, 720), (600, 780), (660, 750), (722, 900), (540, 630)] 
```

# php - 自定义类别模板显示所有类别

> ID：15143394
> 
> 赞同：-3
> 
> 时间：2013-02-28T18:52:44.253
> 
> 标签：php, wordpress, templates, categories

这是模板。我的类别 slug 是“新闻”，类别 id 是 40。我将 php 文件命名为 category-news.php 和 category-40.php。这两个文件都提供了正确的模板，但是当我想要的只是单个类别时，它会显示所有类别。为了显示单个类别，我必须更改什么？

```
<?php
/*
Template Name: Category PAGE
*/ 
get_header();?>

<?php
    if ( have_posts() ) : while ( have_posts() ) : the_post();

    $blog_style = $hana_post_meta['blog_style'];
    if($blog_style=='fluid') $hana_page_options['layout'] = 'full';
?>
<div class="blog-container <?php echo $blog_style;?>-blog">

    <div id="content" class="<?php echo ($blog_style!='fluid')?vintage_content_class():'';?>">

        <?php
        //query posts
        $postsPerPage=hana_get_opt('_post_per_page_on_blog')==''?5:hana_get_opt('_post_per_page_on_blog');
        $excludeCat=explode(',',hana_get_opt('_exclude_cat_from_blog'));
        query_posts(array(
            'category__not_in' => $excludeCat,
            'paged' => get_query_var('paged'),
            'posts_per_page' => hana_get_opt('_post_per_page_on_blog')
        ));

        $blog_loop = array();
        $blog_loop['layout'] = $hana_page_options['layout'];
        $blog_loop['column'] = $hana_post_meta['blogcolumn'];

        get_template_part( 'loop', $blog_style );

        wp_reset_query();?>

    </div>

    <?php get_sidebar();?>
    <?php vintage_get_addtional_products(); ?>
</div><?php

endwhile; endif;?>    

<?php get_footer(); ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T19:01:51.457

`query_posts()`需要在循环之前去。[请参阅 query_posts() 的 Wordpress 函数参考](http://codex.wordpress.org/Function_Reference/query_posts#Usage)。

# javascript - 使用文本输入值更新父级

> ID：15143395
> 
> 赞同：0
> 
> 时间：2013-02-28T18:52:50.193
> 
> 标签：javascript, jquery, dialog, textinput

好的，所以我有一个输入对话框。关闭对话框时，有一个更新父 UL 的功能。该 UL 中的父 LI 应具有文本输入值。它不工作。请帮忙。我在我的更新中放了一个警报，看看这个值是否在那里。没运气。[http://jsfiddle.net/C9EbG/](http://jsfiddle.net/C9EbG/)

**jQuery**

```
 $("input.save").click(function () {         
      $('#numbers tbody tr').each(function(i,v){            
        var ele = $(v);
        var adjName = $('input[name=adjName]',ele).val();
        parent.updateParent2(adjName);
      });
    });   
//////////////////////////////
function updateParent2(adjName){
    alert(adjName);
      var ul = $('ul.adjTabs');
      var li = ul.find('li:first').clone().val(adjName);
      li.find('li:first input');
      li.appendTo(ul)//.val(adjName);
  } 
```

**HTML**

```
 <table id="numbers">
      <tbody>
        <tr id="cloneableRow" class="prototype">        
          <td >
          <input type="text" name="adjName" value="" class="text214 apni"/>
          </td>
        </tr>
      </tbody>
    </table>
<input type='button' value='save' class='save' />

            <ul class="tabs adjTabs">
              <li class="selected"><a href="#">Adjustments ABC</a></li>
              <li><a href="#">Adjustments DEF</a></li>
            </ul> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T18:58:28.093

试试这个：http: [//jsfiddle.net/C9EbG/6/](http://jsfiddle.net/C9EbG/6/)

您可以在此处查看更改：

```
$("input.save").click(function () {         
  $('#numbers tbody tr').each(function(i,v){            
    var ele = $(v);
    var adjName = $('input[name=adjName]',ele).val();
    updateParent2(adjName);
  });
});   

//////////////////////////////
function updateParent2(adjName){
  var ul = $('ul.adjTabs');
  var li = ul.find('li:first').clone();
  li.children('a').text(adjName);
  li.find('li:first input');
  li.appendTo(ul)//.val(adjName);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T18:57:37.973

你的 jsfiddle 没有引用 jQuery。我修复了这个问题和你的错误：http: [//jsfiddle.net/C9EbG/3/](http://jsfiddle.net/C9EbG/3/)

错误是你不应该`updateParent2(adjName)`打电话`parent.updateParent2(adjName)`

# bash - 在 Bash 中使用带有 bc 的负指数

> ID：15143399
> 
> 赞同：4
> 
> 时间：2013-02-28T18:52:59.880
> 
> 标签：bash, exponent, bc

我`bc`在 Bash 程序中使用负指数时遇到了困难。如果我执行`echo "2*1.86929*10^05" | bc`，我会得到一个结果，`373858.00000`而如果我执行`echo "2*1.86929*10^-05" | bc`，我只会得到一个结果`0`。使用负指数时如何获得更好的准确性？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-28T18:56:49.503

默认情况下， 的输出`bc`四舍五入为整数。要保留结果的小数部分，请使用`bc -l`，如下所示：

```
$ echo "2*1.86929*10^-05" | bc -l
.00003738580000000000 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-28T18:58:53.580

您需要设置“比例”的值 - 所以

```
scale=50
2*1.86929*10^-05 
```

给出 .000037385800000000000000000000000000000000000000000

# php - GET变量不解析

> ID：15143400
> 
> 赞同：-2
> 
> 时间：2013-02-28T18:53:00.250
> 
> 标签：php

我似乎无法理解为什么会收到此错误。这似乎适用于`$pid`变量，但不适用于`$type`.

更新：我已经修复了错误，但现在连接变量 ' 。$类型。''; 在下面的链接中根本没有显示在页面上。

第 5 行是：

```
$page=$_GET["type"]; 
```

代码：

```
 if (!$_GET["type"]){
 $page="";
 }else{
$page=$_GET["type"];
}

  $sqlCommand="SELECT id,Type FROM cart WHERE Type='$page'";
$query = mysql_query($sqlCommand) or die (mysql_error());
 $menu ="";
while($row=mysql_fetch_array($query)){
$pid=$row["id"];
  $type=$row["Type"];

  $menu= '<a STYLE="text-decoration:none; color:white" href="pt.php?pid=1&type=' .       $type .    '">' . $type . '</a>';
 $menu2= '<a STYLE="text-decoration:none; color:white" href="pt.php?pid=7&type=' .     $type . '">' . $type . '/a>'; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T19:00:21.807

如果在 $_GET 全局变量中找不到 'type' 键，它会给你 PHP Notice Undefined index。如果你不想要这个通知 - 尝试做

```
if (! isset($_GET["type"]))
{
...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T18:59:46.317

你的问题似乎与

```
$sqlCommand="SELECT id,Type FROM cart WHERE Type='$page'"; 
```

有时，

> 你传递 NO $page 变量

，所以你得到这个错误

您应该为 $page .. 设置一些默认值，例如

```
if(!isset($_GET["type"])){
 $page="default";
 }else{
$page=$_GET["type"];
} 
```

`default`将保留`default`您页面的内容

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T19:19:43.300

要`$_GET['type']`进行设置，URL 必须如下所示：`http://domain.tld/someplace.php?type=stuff`

此外，对其进行适当的测试是这样的：

```
if(isset($_GET['type'])
    $page=$_GET['type'];
else
    $page = ""; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-28T18:57:10.073

如果您要这样做`var_dump($_GET)`，您可能会发现“类型”没有条目。该错误告诉您该`$_GET`数组没有此条目。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-28T19:53:43.493

@马克-埃文斯；V_K 的回复被标记为答案。我更喜欢使用三元运算符：

```
$page = isset($_GET['type']) ? $_GET['type'] : ''; 
```

如果设置了 $_GET['type']，则将其分配给 $page。我更喜欢这样的循环

```
if(!isset($_GET['type'])) {...} else {...} 
```

PS：不要忘记在查询中使用 mysql_real_escape_string() 你的 $page var！或者更好的是，使用 mysqi 和准备好的语句。ext/mysql 函数已弃用，将在 PHP 的未来版本中删除。这将防止 SQL 注入和跨站点脚本攻击（有点）。

# sql - 检查表行是否包含两件事？

> ID：15143406
> 
> 赞同：0
> 
> 时间：2013-02-28T18:53:20.317
> 
> 标签：sql, upload, contains

我想检查上传的文件是否属于当前登录的用户，所以其他人无法编辑它。我尝试了以下但没有奏效：

```
$query = $DB->prepare("SELECT * FROM files WHERE id='$file_id' AND userid=".$_SESSION['userid']);
$query->execute();
if ($query->rowCount() != 1){
    echo "This file is not yours.";
}
else {
    echo "EDIT";
} 
```

# xamarin - 如何使用 mdtool 构建 MonoTouch 项目

> ID：15143410
> 
> 赞同：3
> 
> 时间：2013-02-28T18:53:37.337
> 
> 标签：xamarin, xamarin.ios

我正在尝试在 Jenkins 构建上设置 MonoTouch (Xamarin.iOS 2.0) 项目。我有一个为构建设置的用户，并且我已将所有必需的证书和密钥添加到他们的钥匙串中。

当我尝试在终端中使用 mdtool（如此[处](https://stackoverflow.com/questions/5624060/automated-builds-in-monotouch)和[此处](https://stackoverflow.com/a/8498018/1017797)所述）时。具体来说，我运行的命令是. 当我这样做时，我得到这个输出`"/Applications/Xamarin Studio.app/Contents/MacOS/mdtool" -v build <path to .sln>`

```
MonoDevelop Build tool
ERROR [2013-02-28 10:31:36Z]: Android SDK not found, needed by Xamarin.Android add in 
Loading solution: <path to .sln>
   Loading solution: <path to .sln>
      Loading projects ..
Building Solution: <Project name> (Ad-Hoc|iPhone)
   Building: <project name> (Ad-Hoc|iPhone) 
```

此时，构建停止。如果我在自己的用户而不是 Jenkins 用户下运行相同的命令，这将按预期工作。我已经检查过我确实拥有 jenkins 用户中的所有证书和密钥，并且所有供应配置文件都可以通过 XCode 访问。我对此有点束手无策，非常感谢一些帮助。

更令人困惑的是，如果我尝试在 jenkins 用户下使用 Xamarin Studio 构建此项目，则该过程会成功且没有问题。但是为了自动化构建过程，我必须创建一个可以通过 shell 运行的命令。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-28T20:26:20.593

这是因为产品许可证文件安装在您的用户帐户（它可以工作）上，但无法在您的构建服务器帐户下找到（它不能工作）。

您需要从以下位置复制许可证文件：

`/Users/***you username**/Library/MonoTouch/License.v2`

到：

`/Users/***your build server account**/Library/MonoTouch/License.v2`

请注意，某些 Xamarin.iOS 版本（例如 Starter 和 Indie）的许可证不允许您执行此操作（因此它可能不起作用）。

# html - IE8 中没有边框半径，css3PIE 不起作用？

> ID：15143413
> 
> 赞同：0
> 
> 时间：2013-02-28T18:53:47.310
> 
> 标签：html, internet-explorer-8, css, css3pie

我看到这个问题有很多变体，但我的尝试都没有奏效。

我想在 IE8 中获得圆角，就像在 Firefox、Chrome 中一样……这是我的 css，下载 css3PIE 后：

```
border-top-right-radius: 10px;
border-top-left-radius: 10px;
border-bottom-right-radius: 10px;
border-bottom-left-radius: 10px;
-webkit-border-radius: 10px; -moz-border-radius: 10px;
behavior:url(/PIE.php);
position:relative;
z-index: 0; 
```

我用“PIE.htc”替换了“PIE.php”，但没有任何效果。我的 html 索引文件与 PIE 文件和 css 表位于同一目录中。我尝试根据我在这里看到的帖子添加 z-index 和位置规则，但在那里也没有效果。我也尝试简单地将 PIE.htc 和 PIE.php 作为路径，但没有运气......

还有什么我可以做的，或者这里有什么问题吗？谢谢，杰森

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T20:21:45.493

CSS3 PIE 只识别`border-radius`，没有前缀。

`border-radius: 10px`在前缀版本之后添加。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-30T14:13:26.160

尝试这样的事情

```
-webkite-border-radius: 10px;
-moz-border-radius: 10px;
border-radius: 10px;
behavior: url(/PIE.htc); 
```

# visual-studio - StudioShell 在退出 Visual Studio 2012 时不保存 DTE:\WindowConfigurations

> ID：15143418
> 
> 赞同：1
> 
> 时间：2013-02-28T18:54:06.243
> 
> 标签：visual-studio, powershell, visual-studio-2012, studioshell

[当我使用StudioShell](http://studioshell.codeplex.com/)创建新窗口配置时，如下例所示，它不会在退出 Visual Studio 2012 时保存配置。是否应该运行 cmdlet 来强制进行此更改？

```
cd dte:\windowconfiguration
new-item Work 
```

```
ls dte:\windowconfigurations

Location: studioshell\PSDTE::WindowConfigurations
Available Operations: d+ <      

           Name                                                                                                                               
---------- ----                                                                                                                               
  ~<>    i Debug                                                                                                                              
  ~<>    i Design                                                                                                                             
  ~<>    i NoToolWin 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T20:41:54.183

窗口配置很棘手，似乎从 2008 年到 2010 年（以及代理 2012 年）改变了行为。

TL;DR：使用 new-item 创建一个新配置，然后立即在新配置上调用 invoke-item。然后，当您退出 Visual Studio 时，配置将被保存，并在您再次启动 Visual Studio 时重新加载。

窗口配置作为 winprf（Windows 配置文件）xml 文件保存到 %APPDATA%\microsoft\visualstudio\11.0 文件夹。此外，还有一个 windows.index 文件，它基本上是 winprf 文件的配置名称索引。

使用 new-item 向 windows.index 文件添加一个条目；但是它不会强制创建实际存储 Windows 设置的 winprf 文件。这似乎只有在应用 Windows 配置时才完成（使用调用项）。这与 2008 年的行为不同，在 2008 年，支持 new-item 的 dte 操作会神奇地为您创建索引条目和 winprf 文件。

我已经更改了 windows 配置路径的 new-item 的行为，以强制 windows 配置的持久性。它将在下一个维护版本中可用；在那之前，解决方法是这样的：

```
new-item dte:/windowconfigurations/myawesomeconfig # this creates the index
invoke-item dte:/windowconfigurations/myawesomeconfig # this forces VS to acknowledge the profile and save it on exit. 
```

# jquery - 是否可以在 jQuery 中获取 Ajax 请求的全局设置？

> ID：15143420
> 
> 赞同：0
> 
> 时间：2013-02-28T18:54:10.067
> 
> 标签：jquery, ajax

我调用了 $.ajaxSetup() 来设置一些参数。

后来我想得到一个特定设置的值（比如超时）。

有可能得到吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T18:55:27.133

是的，您可以执行以下操作

```
$.ajaxSetup()['timeout'] 
```

AjaxSetup 返回一个对象，您可以从中查询任何属性（例如超时或缓存）。

# class - 为从 DLL 导入的未知 C++ 类定义别名

> ID：15143423
> 
> 赞同：1
> 
> 时间：2013-02-28T18:54:14.293
> 
> 标签：class, dll, alias, typedef

我对在类上使用 dllimport 感到困惑，希望能得到一些帮助！我已经构建了以下 C++ 代码并将其打包为动态库：

```
class __declspec(dllexport) normaldog {
    normaldog(){};
    ~normaldog(){};
    char* call() { return "woof!"; }
}

class __declspec(dllexport) stupiddog {
    stupiddog(){};
    ~stupiddog(){};
    char* call() { return "meow?"; }
} 
```

现在，我想在我的主程序中使用其中一个类（实例化、调用方法和销毁），就像我对普通类所做的那样。我的问题是，我不知道在运行时之前我会使用哪个：我可以在第一个 exec 上调用一个*normaldog ，在第二个 exec 上调用一个愚蠢的**狗*。我想在我的编译代码中为此使用别名，这将在运行时解析。

怎么做？我会说*typedef*是我最好的选择，但我找不到正确的语法来使用它......

在此先感谢您的帮助 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T19:58:13.787

该问题与 DLL 无关（如果类是在实际程序中定义的，则情况相同）。

Typedef 不是你想要的。这是一个完全静态的功能，因此它不会帮助您在运行时解决任何问题。

你想要的是多态性。让两个类都继承自一个（可能是抽象的）基类：

```
class __declspec(dllexport) Dog
{
public:
    Dog() {}
    virtual ~Dog() {}

    virtual const char* Call() = 0;
};

class __declspec(dllexport) NormalDog : public Dog
{
public:
    NormalDog() {}
    ~virtual NormalDog() {}

    virtual const char* Call() { return "woof!"; }
};

class __declspec(dllexport) StupidDog : public Dog
{
public:
    StupidDog() {}
    virtual ~StupidDog() {}

    virtual const char* Call() { return "meow?"; }
}; 
```

然后，您可以在运行时决定要实例化哪个，然后通过 Dog 指针使用它：

```
Dog* pDog;

if (...)
    pDog = new NormalDog();
else
    pDog = new StupidDog();

pDog->Call(); 
```

编辑：如果你不能修改 DLL 的类，你可以使用这个解决方法：

```
class DogObject
{
public:
    DogObject() {}
    virtual ~DogObject {}
};

class NormalDogObject : public DogObject
{
private:
    NormalDog m_dog; // the DLL's NormalDog

public:
    NormalDogObject() {}
    virtual ~NormalDogObject() {}

    NormalDog& GetNormalDog() { return m_dog; }
    const NormalDog& GetNormalDog() const { return m_dog; }
};

class StupidDogObject : public DogObject
{
private:
    StupidDog m_dog; // the DLL's StupidDog

public:
    StupidDogObject() {}
    virtual ~StupidDogObject() {}

    StupidDog& GetStupidDog() { return m_dog; }
    const StupidDog& GetStupidDog() const { return m_dog; }
}; 
```

然后使用 dynamic_cast 找出 DogObject 的运行时类型并对其调用方法：

```
DogObject* pDog;

if (...)
    pDog = new NormalDogObject();
else
    pDog = new StupidDogObject();

if ((NormalDogObject* pNormalDog = dynamic_cast<NormalDogObject*>(pDog)) != nullptr)
    pNormalDog->Call();
else if ((StupidDogObject* pStupidDog = dynamic_cast<StupidDogObject*>(pDog)) != nullptr)
    pStupidDog->Call(); 
```

当然，如果所有类都具有相同的方法（如本例所示），您可以在 DogObject 中将这些方法声明为纯虚拟方法，并让派生类通过委托对 DLL 类的方法的调用来实现它们（基本上将所有内容包装在你自己的类层次结构）。这会引出一个问题，为什么 DLL 的开发人员一开始不这样做？

# c++ - 在 .NET 中使用 Windows API 函数

> ID：15143425
> 
> 赞同：1
> 
> 时间：2013-02-28T18:54:19.630
> 
> 标签：c++, vb.net, c++-cli

前段时间我在这里问了一个问题：[COM vs non-COM DLL](https://stackoverflow.com/questions/12680981/com-vs-non-com-dll)关于从 .NET 调用经典 C++ 程序。

答案（来自 Hans Passant）是用 Visual C++ 编写一个包装类，这在我的项目中效果很好（我确实从另一个在 C++ 方面更有商业经验的开发人员那里得到了一些帮助）。

我的问题是：是否为 WINAPI 中的某些函数创建了包装类。例如，下面的代码在没有包装类的情况下工作：

```
Imports System.Runtime.InteropServices
Imports System.Text

Public Class Form1

    <DllImport("user32.dll", SetLastError:=True, CharSet:=CharSet.Ansi)> _
    Public Shared Function MessageBox(ByVal hwnd As IntPtr, <MarshalAs(UnmanagedType.LPStr)> ByVal lpString As String, <MarshalAs(UnmanagedType.LPStr)> ByVal lpString2 As String, ByVal cch As Integer) As Integer
    End Function

    Private Sub Form1_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        MessageBox(0, "HelloWorld", "HelloWorld", 0)
    End Sub
End Class 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-28T19:03:02.847

围绕 WINAPI 调用的现有包装类称为**System.Windows**命名空间。;-)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-28T19:16:18.547

汉斯对您的另一个问题的评论说：

> 您不能直接使用在 .NET 程序中导出类的 C++ DLL。需要使用 C++/CLI 语言编写的包装器。

As he said, the reason, in that situation, why a wrapper was needed is because .NET cannot use a *class* that is exported by C++. In this case, however, the `MessageBox` function is simply a *function* that is exported by a DLL that was compiled from C++, not a *class*. VB.NET can very easily be used to invoke API functions, as you have demonstrated. The problem is not with calling API *functions*. The problem is with using C++ classes.

As others have said, though, in this case, you just want to use the managed `MessageBox.Show`.

# web-crawler - 关于使用 Internet 收集信息

> ID：15143436
> 
> 赞同：0
> 
> 时间：2013-02-28T18:54:55.667
> 
> 标签：web-crawler, google-search-api

现在，我遇到了一个有趣的情况……我的目标是拥有一个软件，它可以接受一个人的全名、出生日期和其他一些凭据（它们是有争议的），并从互联网上提取尽可能多的关于他的信息尽可能...

现在我做了一些研究，发现通过使用 google 的搜索 API 和诸如 Scrapy 之类的网络爬虫，我可以在一定程度上实现这个目标......但简单地在 google 上用双引号搜索人名并不总是会产生正确的结果...

这里想到了两个问题......如何提高准确性，其次，我是否在重新发明轮子（因为有些网站有能力找到人......）？如果是这样，那么那里是否已经有开源代码（或任何可用的东西）可以做到这一点或类似的东西......？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T19:02:19.833

这个答案与如何在大量 URL 上使用刮板有关。例如，您可以从 SmokeDoc 开始。

# android - 使用 Android Endless Listview 进行屏幕旋转

> ID：15143438
> 
> 赞同：1
> 
> 时间：2013-02-28T18:54:58.603
> 
> 标签：android, android-listview, commonsware-cwac

我正在尝试 CommonsWare 的 android endlist 适配器。

[https://github.com/commonsguy/cwac-endless](https://github.com/commonsguy/cwac-endless)

加载几页后，我旋转了屏幕，列表视图丢失了除第一个页面之外的所有页面。它不应该保留加载的项目吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T20:04:09.873

> 它不应该保留加载的项目吗？

那是你的工作，不是适配器的。适配器不会“保留”“项目”，无论是否`EndlessAdapter`涉及。

默认情况下，当设备发生配置更改（例如屏幕旋转）时，Activity 会被销毁并重新创建。发生这种情况时，您需要安排挂起您的模型数据，方法是：

*   `setRetainInstance()`在动态片段上使用，或
*   使用`onSaveInstanceState()`, 或
*   使用`onRetainNonConfigurationInstance()`, 或
*   在最坏的情况下，使用`android:configChanges`，如另一个答案中所建议的那样

# javascript - 如何检查是否在 chrome 存储上设置了变量

> ID：15143439
> 
> 赞同：7
> 
> 时间：2013-02-28T18:55:00.597
> 
> 标签：javascript, google-chrome-extension, local-storage, chrome-web-store, google-chrome-storage

我有一个使用 LocalStorage 的小片段，但我还不能让它在 Chrome 存储方案上运行。

当我的应用程序启动时，我检查 localStorage 中的变量

```
var bookNarration=parseInt(localStorage.getItem("narration")); 
```

如果该变量未定义，则意味着我的应用程序已首次打开，并且我在使用“默认”声明的开关中处理 bookLanguage 之后。

```
switch(window.bookNarration)
  {
    case 2:
        window.narrationShift = window.spanishShift;
    break;
    case 3:
        window.narrationShift = window.frenchShift;
    break;
    case 10:
        window.narrationShift = window.neutralShift;
    break;
    default:
        window.narrationShift = 0; } 
```

为了使其与 Chrome 存储一起使用，我以这种方式更改了我的代码：

```
var bookNarration=parseInt(chrome.storage.local.get("narration")); 
```

但我立即收到此错误：

> 调用表单 get(string) 与定义 get(可选字符串或数组或对象键，函数回调) 不匹配

我一直在寻找很多小时试图找到一个解决方案，但我无法让它发挥作用。我只需要检查该值是否已经定义，如果不是，我可以使用 set() 方法来存储我的默认值。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-28T18:58:45.143

该函数[需要一个回调](https://developer.chrome.com/extensions/storage.html#method-StorageArea-get)：

```
chrome.storage.local.get("narration", function(data)
{
    if(chrome.runtime.lastError)
    {
        /* error */

        return;
    }

    var bookNarration = parseInt(data.narration);

    switch(bookNarration)
    {
        /* ... */
    };
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-11-06T07:58:12.897

现在不需要使用 catch （这意味着我不知道自从接受的答案和现在这是否发生了变化）。

如果该项目不存在，您可以传入您想要的项目以及默认值

```
chrome.storage.local.get({narration: "", num: 0, books: []}, function(data)
{
    var bookNarration = parseInt(data.narration);

    switch(bookNarration)
    {
        var numBooks= data.books.length
        /* ... */
    };
}); 
```

# xcode - iOS 6 presentviewcontroller 显示黑屏

> ID：15143440
> 
> 赞同：0
> 
> 时间：2013-02-28T18:55:05.917
> 
> 标签：xcode, view, ios6

我刚刚构建了一个小应用程序来测试以编程方式更改视图的使用，所以我在故事板和我的两个类中有我的两个视图。现在我希望当我点击 ViewController 中的按钮时，它会显示 RedViewController。但是当我点击这个按钮时，我只能黑屏。有谁知道如何解决这个问题？

```
-(IBAction)showred:(id)sender{

    RedViewController *viewController = [[RedViewController alloc] init];
    [self presentViewController:viewController animated:YES completion:nil];
} 
```

谢谢迈克尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T20:03:22.440

如果您正在使用情节提要并在那里定义了您`RedViewController viewcontroller`的视图，则无需编写任何代码来切换到此视图，也不必将按钮连接到`IBAction`. 相反，您必须从应该启动转换的按钮拖动到情节提要中 RedViewController 的视图。
在您的代码中，您创建了一个`RedViewController`带有 的新对象`init`，即没有任何信息，它的视图应该是什么样子 - 因此它是黑色的。

# tcl - Tcl参数列表说明

> ID：15143447
> 
> 赞同：0
> 
> 时间：2013-02-28T18:55:35.933
> 
> 标签：tcl

我遇到了以下问题，无法弄清楚这个参数列表的含义：

```
proc IsSpecificationLive { specificationDate { onDate "" } } 
```

更具体地说，`{ onDate"" }`进入参数列表的目的是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T19:57:50.170

可选参数的空默认值`onDate`。

从[proc的手册页](http://www.tcl.tk/man/tcl8.5/TclCmd/proc.htm)

> *Args*指定过程的形式参数。它由一个可能为空的列表组成，其每个元素都指定一个参数。每个参数说明符也是一个包含一个或两个字段的列表。如果说明符中只有一个字段，则它是参数的名称；如果有两个字段，则第一个是参数名称，第二个是其默认值。具有默认值且后跟非默认参数的参数成为必需参数。在 8.6 中，这将被视为错误。

例子：

```
proc IsSpecificationLive { specificationDate { onDate "" } } {
    puts $onDate
}

IsSpecificationLive foo bar; # outputs "bar"
IsSpecificationLive baz; # outputs an empty line 
```

有关更多详细信息，请参阅[proc](http://www.tcl.tk/man/tcl8.5/TclCmd/proc.htm)的文档。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T19:56:51.167

这是可选参数的语法。所以，这个过程有两个参数。第一个是必需的（specificationDate），第二个是可选的。如果仅使用一个参数调用该过程，则 onDate 将设置为“”。如果使用两个参数调用它，则 onDate 将设置为第二个参数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-28T19:58:17.677

这允许您使用单个参数调用该过程，并且默认值为`onDate`空字符串。这是交互式 tclsh 会话的片段：

```
% proc IsSpecificationLive { specificationDate { onDate "" } } {
    puts $specificationDate
    puts $onDate
}
% IsSpecificationLive
wrong # args: should be "IsSpecificationLive specificationDate ?onDate?"
% IsSpecificationLive one two
one
two
% IsSpecificationLive one 
one

% IsSpecificationLive one two three
wrong # args: should be "IsSpecificationLive specificationDate ?onDate?" 
```

# java - 当响应未按预期出现时，如何使用 GSON 解析 json？

> ID：15143448
> 
> 赞同：1
> 
> 时间：2013-02-28T18:55:47.053
> 
> 标签：java, json, parsing, gson

我正在开发与响应为 JSON 的 Rest 服务的集成。

我做的第一个请求是登录，它有两个可能的返回。

通常积极的登录响应如下所示：

```
 {"data":{"userID":"4f561b74001ff932afd58200a752b821","sessionID":"6cc960751eef45db83dd8db7f47337a6","versionInformation":{"currentAPI":"v2.0","buildNumber":"28b12d751c5ea88d393e68285ac57ed309ae04fa","apiVersions":{"v1.0":"\/attask\/api\/v1.0\/","v2.0":"\/attask\/api\/v2.0\/"},"lastUpdated":"2013\/02\/12 17:42:57","release":"R16","version":"4.0"},"locale":"pt_BR","timeZone":"America\/Sao_Paulo","timeZoneName":"Brasilia Time","iso3Country":"BRA","iso3Language":"por","currency":{"useNegativeSign":true,"fractionDigits":2,"symbol":"R$","ID":"BRL","groupingSeparator":".","decimalSeparator":","}}} 
```

假设它永远不会改变格式，我可以使用 GSON 反序列化它。但是，如果 JSON 响应以不同的方式出现怎么办？就像我尝试使用错误的用户名/密码登录一样？

否定的反应是这样的：

```
 {"error":{"class":"com.attask.biz.externallogin.ExternalLoginException","message":"The following error occurred while authenticating with an external system: Invalid password"}} 
```

所以我的问题是，有没有办法让 GSON 选择最适合反序列化的对象，或者我是否必须尝试反序列化，假设它已经正确并在 catch 块上处理它？

我希望我能说清楚，我期待着建议。

干杯

保罗·阿尔梅达

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T19:00:12.190

假设一个适当的 REST 服务，响应代码应该指示请求是否成功。在这种情况下，您可以根据不同的响应代码做出决定。

对于未正确实施的 REST 服务，您可能希望将响应数据反序列化为“弱”（映射）类型，例如 JsonObject（如果需要，您可以进一步处理，具体取决于处理数据的内容）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T19:01:09.137

我所做的是使用 com.google.gson.JsonParser 而不是尝试反序列化为对象。使用该界面，您可以检查顶级元素（可能检查特定属性），然后决定做什么。

# core-bluetooth - 响应 peripheralManager:didReceiveWriteRequests 的正确方法是什么？

> ID：15143453
> 
> 赞同：4
> 
> 时间：2013-02-28T18:56:17.007
> 
> 标签：core-bluetooth

什么是正确的回应方式`peripheralManager:didReceiveWriteRequests:`？

标头文档指出：

“对于此方法的每次调用都`respondToRequestWithResult`应该只调用一次。”

在`didReceiveWriteRequests`多个写入请求中，使用`NSArray`.

如果所有写请求都被成功处理，我们是否只是从列表中任意选择一个请求并将其用作参数，`respondToRequestWithResult`因为该`respondToRequestWithResult`方法只接受一个`CBATTRequest`参数而不是`CBATTRequest`s 附带的列表`didReceiveWriteRequests`？

我期望一个以请求列表作为参数的对称响应方法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-10-09T18:14:12.507

来自 Apple 文档：[这里](https://developer.apple.com/library/ios/documentation/NetworkingInternetWeb/Conceptual/CoreBluetooth_concepts/PerformingCommonPeripheralRoleTasks/PerformingCommonPeripheralRoleTasks.html#//apple_ref/doc/uid/TP40013257-CH4-SW1)

处理来自连接中心的写入请求也很简单。当一个连接的中心发送一个写入一个或多个特征值的请求时，外围管理器调用它的委托对象的 peripheralManager:didReceiveWriteRequests: 方法。这一次，委托方法以包含一个或多个 CBATTRequest 对象的数组的形式将请求传递给您，每个对象代表一个写入请求。在确保可以完成写入请求后，您可以写入特征的值，如下所示：

```
myCharacteristic.value = request.value; 
```

虽然上面的例子没有说明这一点，但是在写你的特征值时一定要考虑到请求的偏移属性。

正如您响应读取请求一样，每次调用 peripheralManager:didReceiveWriteRequests: 委托方法时，只需调用一次 respondToRequest:withResult: 方法。也就是说，respondToRequest:withResult: 方法的第一个参数需要一个 CBATTRequest 对象，即使您可能从 peripheralManager:didReceiveWriteRequests: 委托方法收到了一个包含多个对象的数组。您应该传入数组的第一个请求，如下所示：

```
[myPeripheralManager respondToRequest:[requests objectAtIndex:0]

    withResult:CBATTErrorSuccess]; 
```

# c# - 将数据发布为多维数组并将值分配给类型化对象

> ID：15143454
> 
> 赞同：0
> 
> 时间：2013-02-28T18:56:18.520
> 
> 标签：c#, .net-4.0, multidimensional-array, http-post

我需要服用：

```
<input type="text" name="option[0]['value']" value="test@email.com"/>
<input type="hidden" name="option[0]['option_key']" value="email_from" />

<input type="checkbox" name="option[1]['value']" value="1" checked="checked"/>
<input type="hidden" name="option[1]['option_key']" value="email_asHtml" /> 
```

从表单中访问这些值以将其作为类型化对象。我一直试图让它运行。我所做的是加载，[FastMember](http://marcgravell.blogspot.com/2012/01/playing-with-your-member.html)帮助完成工作，但我什至可以通过抛出的错误

> 将参数“选项”转换为 System.Collections.Object[] 时出现异常。检查内部异常以获取详细信息

从

```
public void save_config(dynamic[,] option)
{
    site.options.Clear();
    foreach (Hashtable item in option)
    {
        options tmp = new options();
        var accessor = TypeAccessor.Create(tmp.GetType());
        foreach (string key in item.Keys)
        {
            accessor[tmp, key] = item[key];
        }
        site.options.Add(tmp);
    }

    ActiveRecordMediator<site>.Save(site);
    RedirectToAction("configuration");
} 
```

我的一个想法是我可以跳过参数，这样我就不会收到绑定错误并使用以下方法调用参数：

```
HttpContext.Current.Request.Form["option"]; 
```

但是如何打破它是未知的。

**这里的问题是如何像在 php.ini 中一样使用多维数组发布数据值。**

---更新---所以解释为什么在评论中这不只是被注销为“你不知道你在做什么”的评论风格*（不是一个不好的原因，就像我一样拿了它）*，我确实想到了一个可能会更好的新回合。*（看到他们非常有帮助：D）*

因此，我不会像我一样发送帖子数据，而是删除 muiltde 并设置一个简单的数组，这样我就可以使用我在评论中列出的相同技巧。在我尝试像这样发送数据之前。

```
option[0]['value'] = usedev
option[0]['option_key'] = email_from
option[1]['value'] = 1
option[1]['option_key'] = asfasf 
```

如果我只是使用键来连接我需要的两个值，那么我可以获得“值”的长度，然后用 var i++ 循环它并获得我需要的值。很简单，您只需要将数据移动到此模式：

```
option_key[0]   usedev
option_key[1]   email_from
value[0]    1
value[1]    asfasf 
```

然后在循环中调用它会很好

```
string value = HttpContext.Current.Request.Form["value[" + i+ "]"];
string option_key= HttpContext.Current.Request.Form["option_key[" + i+ "]"];
i++; 
```

那么一切都会好起来的。完成后我会发布最终解决方案。

--第二次更新--

因此，从多维数组中展平并使用数组键作为绑定，就好像它是一个多维数组一样，可以让您获取值。交易是如果 i 不是迭代值会更好。这就是我所拥有的。我相信

```
 public void save_config(
            [ARDataBind("site", Validate = true, AutoLoad = AutoLoadBehavior.NewRootInstanceIfInvalidKey)] site site,
        String[] value,
        String[] option_key
        ) {
        site.options.Clear();
        int i = 0;
        foreach (String item in value) {

            options tmp = new options(){
                value = item,
                option_key = option_key[i]
            };
            i++;
            site.options.Add(tmp);
        }
        ActiveRecordMediator<site>.Save(site);
        RedirectToAction("configuration");
    } 
```

* * *

我相信答案是 C# 无法处理多维混合类型数组

# asp.net-mvc - Asp.Net MVC 和 Web API 和/或 Knockout 的使用

> ID：15143462
> 
> 赞同：0
> 
> 时间：2013-02-28T18:57:11.943
> 
> 标签：asp.net-mvc, knockout.js, asp.net-web-api

我即将开始一个新的 Asp.Net MVC 开发，我想做出最好的选择。在我之前的 MVC 开发中，我喜欢一系列的事情，比如：

*   基于视图模型的视图
*   客户端验证
*   远程验证

我在网上阅读了很多关于 Web API 和 Knockout 的内容。我理解每个元素的原理，但在我看来，如果我使用这些元素中的一个（或两个），我将无法从上面列出的优点中受益。

我的新开发将主要是一些基于搜索结果的列表，然后对它进行 CRUD 操作。

我想听听您对在我的新项目中使用 Web API 和/或 Knockout 的意见。我知道这部分是主观的选择，但社区的意见对我来说很重要。也许你已经不得不做出这些选择？

感谢您的意见。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T20:51:29.790

同时使用 WebAPI 和淘汰赛绝对没有坏处。knockout 只是一个客户端绑定库，WebAPI 是一个服务层。

1.  您仍然可以创建从 WebAPI 返回的视图模型。
2.  您仍然可以使用 MVC 控制器返回您的视图。
3.  您可以使用敲除来管理您的客户端视图模型和交互。

一个通用的方法（请阅读很多关于 WebAPI 和 Web API 中的模型绑定）将是。

1.  MVC 项目 -> 包含一个仅根据请求的操作提供视图的控制器。
2.  Web API -> 业务逻辑的服务层。
3.  模块化 Javascript（使用 requirejs，敲除并阅读有关在 Javascript 中揭示模块模式的信息）来定义您的视图模型（不要将其视为 API 提供的视图模型，这些视图模型还将定义客户端交互、计算的 observables 等）
4.  Create a Binder JS module that will take in a viewmodel and bind to a DOM.

Things you need to know when you follow this approach. 1\. If there are bindings on your Layout and any partials and you call ko.applyBindings(new vm()); you will see errors. Instead, bind to a particular div or element that will act as the container for your viewmodel data. 2\. Web API model binders are different than ASP.Net MVC model bindings. Read up on this. 3\. Separate out your Javascript files into smaller modules doing specific things and you can handle things better.

If you wish to learn more about this, look up Single Page Application using ASP.Net. The new release of ASP.Net and VS2012 update has SPA templates and lots of examples on using knockout/WebAPI and other libraries such as Ember, Angular .etc.

Hope that helps.

Cheers!

# css - 为什么 css3 过渡不能同时做不止一件事？用小提琴

> ID：15143467
> 
> 赞同：2
> 
> 时间：2013-02-28T18:57:30.073
> 
> 标签：css

我正在尝试做一个简单的效果：

Div 有一个带有`RGBA(255,255,255,0.5)`背景的图像和文本。

在悬停时，我想让图像降低不透明度+文本背景消失在一个平滑的过渡中。

这一切都按预期工作，除了当我尝试给 img 和 text 一个过渡时，而不是两个东西都过渡，图像通过过渡降低了它的不透明度，但文本的背景没有。

任何想法为什么会发生这种情况？

**更新**：在firefox上测试过，效果很好。问题似乎出在 Windows 上的 Chrome 上（我使用的是最新版本），其他使用 chrome/windows 的人是否也可以告诉我他们是否也看到了问题？

你可以在这里看到一个[演示](http://jsfiddle.net/rCf3k/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T21:02:50.077

用于`span::after`做背景并使`span`背景保持透明。然后你可以使用`opacity`而不是`rgba()`.

**演示：** [[[[![jsFiddle](../Images/827f57786617d886d70c0bce0ccca6b6.png)](http://jsfiddle.net/ThinkingStiff/6Z8Q6/)]]]

### CSS：

```
span{
    display:block;
    position:absolute;
    bottom:10px; 
    left:0; 
    padding:5px 10px; 
    font-size:10px;
    z-index: 1;
   }
span::after {
    background-color: white;
    content: '\A0';
    position: absolute;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    opacity: .5;
    z-index: -1;
}
img, span, span::after {
    -webkit-transition: all .8s; 
    -moz-transition: all 0.8s; 
    -ms-transition: all 0.8s; 
    -o-transition: all 0.8s; 
    transition: all .8s; 
}
div {
    position:relative;
}
div:hover span::after {
    opacity:0; 
}
div:hover span {
    bottom:50px;
}
div:hover img {
    opacity: 0.35;
    -webkit-transform: scale(1.1, 1.1);
    -moz-transform: scale(1.1, 1.1);
    -ms-transform: scale(1.1, 1.1);
    -o-transform: scale(1.1, 1.1);
    filter: progid:DXImageTransform.Microsoft.Alpha(Opacity=35);
    transform: scale(1.1, 1.1);
} 
```

### HTML：

```
<div><img src="http://placekitten.com/200/300" />
<span>Text Text Text</span>
</div> 
```

`<div>`这是另一个使用 a而不是 的演示`::after`，正如您提到的那样。

**演示：** [[[[![jsFiddle](../Images/827f57786617d886d70c0bce0ccca6b6.png)](http://jsfiddle.net/ThinkingStiff/9vRGc/)]]]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T19:59:02.137

使用过渡时，您必须定义开始和结束。代替背景无，使用 rgba(255,255,255,0); 所以开头和结尾说的是同一种语言。

CSS 不理解诸如“背景颜色”->“无”之类的过渡。此外，在这种情况下，您可能希望使用透明，因为“none”对于背景颜色来说不是有效的 CSS。

我还认为您的 CSS 的某些部分可能不兼容。如果你删除了规模的东西，事情就会按照他们应该的方式行事。真可惜。看看我的第二个小提琴，这似乎工作，所以也许你只需要写一些更干净的代码或什么？我使用了图形而不是图像，但它的作用应该相同。希望这可以帮助！

这是[您更新的小提琴](http://jsfiddle.net/sheriffderek/gZyu7/)，然后是[我的小提琴。](http://jsfiddle.net/sheriffderek/6hwb5/)

```
<figure>

    <figcaption>without scale</figcaption>

</figure>

<figure class="scale">

    <figcaption>with scale</figcaption>

</figure> 
```

--

```
 .trans, figure, figcaption {

  -webkit-transition: all .5s linear; 
     -moz-transition: all .5s linear; 
       -o-transition: all .5s linear; 
          transition: all .5s linear; 
}

figure {
    position: relative;
    width: 20em;
    height: 10em;
    background-color: rgba(255,0,104,1);
}

figure:hover {
    background-color: rgba(255,0,104,.2);
}

figcaption {
    position: absolute;
    width: 100%;
    bottom: 0; left: 0;
    padding: 2em 1em;
    background-color: rgba(255,255,255,.8);
}

figure:hover figcaption {
    bottom: 20px;
    background-color: rgba(255,255,255,.0);
}

.scale:hover {
       -webkit-transform: scale(1.1, 1.1);
       -moz-transform: scale(1.1, 1.1);
       -ms-transform: scale(1.1, 1.1);
       -o-transform: scale(1.1, 1.1);
       transform: scale(1.1, 1.1);
   } 
```

# java - Jax-ws 多个 web 服务

> ID：15143476
> 
> 赞同：0
> 
> 时间：2013-02-28T18:57:46.683
> 
> 标签：java, web-services, wsdl, jax-ws

最初，我从第 3 方收到了一个 wsdl，并选择了 jax-ws 作为解决方案。我很快意识到 web 服务并没有包含所有功能，当我询问它时，我又收到了 4 个 wsdls ......每个功能一个。

每个函数都有自己的 wsdl。第一阶段一切正常，因为只有 5 个函数，但在接下来的 3 个月里，我们又增加了 40 个函数。有人可以建议我如何处理这个吗？我需要一些方法来停止重复代码。目前，我有 5 段代码看起来非常相似，用于设置服务。我不想把它复制 40 次。

更糟糕的是，它们都共享一个共同的 xsd，但实际上并没有使用 xsd，只是将类型扩展为看起来相同，但在所有 wsdl 中具有不同的名称。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T19:13:50.343

解决方案是使用反射和泛型。我有一个可以构造服务并根据类型连接到端口的基类。

不过，这并不理想，您真的不想要这么多 wsdls。

# javascript - 即使父窗口已重新加载，也停止子窗口重新加载

> ID：15143477
> 
> 赞同：1
> 
> 时间：2013-02-28T18:57:48.893
> 
> 标签：javascript, jquery, parent-child

我有这个子窗口和一个条件，如果在窗口仍然打开且变量“myStatus”等于“处理”时再次单击“发送”，则该窗口会阻止重新加载。问题是如果打开子窗口，然后刷新父页面并再次单击“发送”，则 childPage 变量会丢失并且允许重新加载子页面。有没有办法解决这个问题？谢谢。

```
var childPage = null;

$('#send').click(function(){

    if(childPage && !childPage.closed && childPage.myStatus == "processing"){
      alert('child window is open and processing');
    }else{
     childPage = window.open("test.html","send","width = 300,height=300");
}): 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T19:11:37.870

我有同样的问题

我使用两种方式通信解决了它

如果用户刷新父页面将此信息发送到子窗口。子窗口将运行一个计时器，该计时器将继续检查父页面是否重新加载。重新加载父页面后，在父页面中创建子窗口的引用

代码：

在父窗口中

```
 window.onbeforeunload =function (){
  childPage.reconnect();
}

window.saveChildReference =function (ref){
  childPage = ref;
} 
```

在子窗口中

```
window.reconnect = function(){
     var i =0;
   var timer = setInterval(function(){
    i++;
        if(window.opener && window.opener.saveChildReference ){
               window.opener.saveChildReference(window);
             clearTimeout(timer );
         }

        if(i > 100){
         clearTimeout(timer );// stop trying as parent may be closed.
      }

   }, 100);

}; 
```

# python - 使用 mongoengine 将多文档插入到 mongodb

> ID：15143482
> 
> 赞同：21
> 
> 时间：2013-02-28T18:58:10.627
> 
> 标签：python, mongodb, flask, mongoengine

在我的烧瓶应用程序中，我使用的是 MongoeEgine。我正在尝试将多个文档插入到我的 MongoDB 中的位置集合中。

我的文档类定义为

```
class places(db.Document):

  name = db.StringField(max_length=200, required=True)    
  loc = db.GeoPointField(required=True)

  def __unicode__(self):
    return self.name

    a=[]
    a.append({"name" : 'test' , "loc":[-87,101]})
    a.append({"name" : 'test' , "loc":[-88,101]})
    x= places(a) 
```

最后一条语句失败

```
x= places(a)
TypeError: __init__() takes exactly 1 argument (2 given) 
```

我也尝试将其保存到我的实例中

```
places.insert(x)
places.save(x) 
```

都失败了。请帮忙。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2013-03-01T09:54:29.723

`Places.objects.insert`不需要字典列表，它必须是`Places`实例。正常操作是创建单个实例`Places`并保存或插入，例如：

```
Places(name="test", loc=[-87, 101]).save()
Places(name="test 2", loc=[-87, 101]).save() 
```

但是，如果您想进行批量插入，您可以传递`Places`实例列表并调用`insert`查询集，`objects`例如：

```
Places.objects.insert([Places(name="test", loc=[-87, 101]), 
                       Places(name="test 2", loc=[-87, 101])]) 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-03-01T06:55:45.733

您尝试一次为多个文档初始化**Document**对象。如果您查看 mongoengine 的**BaseDocument**类，您会发现它的`__init__`方法采用关键字参数字典，这些参数与单个文档的字段相关。

如果要进行批量保存，则必须创建一个**地点**实例列表并将其传递给**insert()**方法。

```
a = []
a.append(places(**{"name": 'test', "loc": [-87,101]}))
a.append(places(**{"name": 'test', "loc": [-88,101]}))
x = places.objects.insert(a) 
```

# javascript - 带有 JS 重定向的 HTML 5 中的 FB 登录按钮

> ID：15143486
> 
> 赞同：1
> 
> 时间：2013-02-28T18:58:16.313
> 
> 标签：javascript, facebook-php-sdk, facebook-social-plugins, facebook-login

在旧版本的 FB 登录按钮中，这对我来说效果很好

```
<fb:login-button scope='email,publish_stream'>Login</fb:login-button>
<div id='fb-root'></div>

 <script type='text/javascript' src='http://connect.facebook.net/en_US/all.js'></script>     
 <script>window.fbAsyncInit = function() {FB.init({
      appId: '<?php echo $facebook->getAppID(); ?>',
      cookie: true,
      xfbml: true,
      oauth: true
   });
   FB.Event.subscribe('auth.login', function(response) {
      window.location = '/fb_redirect.php';
   });
  FB.Event.subscribe('auth.logout', function(response) {
      window.location.reload();
  });
   };
  (function() {
     var e = document.createElement('script'); 
      e.async = true;e.src =   document.location.protocol +'//connect.facebook.net/en_US/all.js';document.getElementById('fb-root').appendChild(e);}());
  </script> 
```

但是，我的一个朋友最近建议切换到新的 HTML 5 登录按钮，如下所示：

```
 <div id='fb-root'></div>
        <script>
            (function(d, s, id) {
                var js, fjs = d.getElementsByTagName(s)[0];
                if (d.getElementById(id)) return;
                js = d.createElement(s); js.id = id;
                js.src = '//connect.facebook.net/en_US/all.js#xfbml=1&appId=APPID';
                fjs.parentNode.insertBefore(js, fjs);
            }(document, 'script', 'facebook-jssdk'));
        </script> 
```

这也很有效。除了我找不到 JS 触发重定向到 /fb_redirect.php 的方法。在较早的示例中，

```
FB.Event.subscribe('auth.login', function(response) {
      window.location = '/fb_redirect.php';
   }); 
```

工作得很好。但是，我需要将用户重定向到 /fb_redirect.php，以便 PHP 可以启动会话并将一些用户的 FB 信息插入数据库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T07:03:06.153

这是您的默认参数

```
<div id="fb-root"></div>
<script type="text/javascript">
window.fbAsyncInit = function() {
FB.init({
  appId      : <?php echo $facebook->getAppID() ?>,
  status     : false,
  cookie     : true,
  xfbml      : true
 });
};

(function(d){
 var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 if (d.getElementById(id)) {return;}
 js = d.createElement('script'); js.id = id; js.async = true;
 js.src = "//connect.facebook.net/en_US/all.js";
 ref.parentNode.insertBefore(js, ref);
}(document)); 
```

这是我的自定义 fb_login 函数，我的自定义函数 fb_login () 获取 uid 和 accessToken 值并执行其余操作。这次它仅在单击登录按钮时发生。

```
function fb_login() {
        FB.login(function(response) {
          if (response.status === 'connected') {
            var uid = response.authResponse.userID; 
            var accessToken = response.authResponse.accessToken;
                if ((parseFloat(uid) == parseInt(uid)) && !isNaN(uid)) {
                  window.location = '/fb_redirect.php';

                  }
     }
        });
      }

</script> 
```

我已经使用 onlogin 事件扩展了 FB 登录按钮，当用户单击使用 facebook 按钮登录并成功登录时，该事件调用 JS 函数 fb_login()。

```
<div class="fb-login-button" onlogin="fb_login()"></div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T18:48:43.720

这原来是我的一个签名粗心的错误。答案在这个问题的第一部分。

它只是添加

```
FB.Event.subscribe('auth.login', function(response) {
  window.location = '/fb_redirect.php'; 
```

});

# ruby-on-rails-3 - Rails - 从控制器动作重定向到渲染部分

> ID：15143501
> 
> 赞同：0
> 
> 时间：2013-02-28T18:59:37.453
> 
> 标签：ruby-on-rails-3, controller, partial-views

我正在 Rails 中构建单页应用程序。我在像这样单击按钮的根页面中成功填充了部分内容；

```
<div class="span12" style="margin-bottom:20px;">
            <%= link_to "Messages", "/messages", :class=>"btn btn-large btn-primary span12", :remote => true %>
</div> 
```

这成功地呈现了`_index.html.erb`部分。在此页面中有一个消息列表和删除它们的链接。当我删除它们时，我收到一个模板缺失错误，因为它正在寻找 index.html.erb 并`localhost:3000/messages`在删除消息后重定向到。这是我的销毁操作，在删除消息后被重定向

```
if @message.destroy
      flash[:notice] = "Message was successfully deleted"
      redirect_to messages_path
else
      flash[:error] = "Message could not be deleted please try again"
      redirect_to messages_path
end 
```

我怎样才能让这个动作`_index.html.erb`再次渲染部分`localhost:3000/`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T19:28:03.753

每次删除消息时都不应该呈现部分索引。它应该只在javascript中完成。

我认为您可以执行以下操作：

```
$(".messages").on(".message .destroy-link", "ajax:success", function(data) {
    var $link = $(this);
    $link.closest(".message").remove();
}) 
```

在您的控制器中，您不会在任何地方重定向`format.js`.

# c++-amp - C++ AMP如何在GPU内存中返回值？

> ID：15143503
> 
> 赞同：1
> 
> 时间：2013-02-28T18:59:43.743
> 
> 标签：c++-amp

假设我有一个这样的算法：

```
array a = foo();
array b = bar(a);
array c = foobar(a, b);
array d = fbar(a, c); 
```

现在这在 CPU 和 CUDA 上都很好，我可以让函数返回指向 gpu 内存块的指针，然后让另一个函数消耗该中间值。

你如何在 C++ AMP 中做到这一点？我猜你必须使用 concurrency::array 对象，但我找不到任何这样做的示例代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T05:27:29.637

这是一个实际的 C++ AMP 示例：

```
concurrency::array<int, 1> bar(const concurrency::array<int, 1>& input)
{
  parallel_for_each(b.extent, [&b, &r](concurrency::index<1> idx)
  {
    input[idx] = ...;
  });
  return input;
} 
```

正如 Simon 指出的那样，array<> 支持移动，所以这应该非常有效。您可能需要考虑使用 array_view 来获得更好的代码灵活性，而不是使用 array<>。

您可以通过移动 bar 的返回值来进一步整理它，而不是进行隐式复制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-09T00:53:39.953

concurrency::array 类就像 C++ 中的任何其他模板类一样。这里没有语法魔法。所以你可以这样做：

```
using namespace concurrency;  // because I hate typing

array<int, 1> foo(int size)
{
    return array<int, 1>(size);
}

array<int, 1> bar(array<int, 1> input)
{
    // do something to input
    return input;
}

array<int> a = bar(foo(1024)); 
```

这可能会产生比您想要的更多的深层副本。但是以任何你喜欢的方式使用指针或引用都可以解决这个问题。

但这些都不是 AMP 特有的。这只是在此代码中使用 C++11。

# regex - 正则表达式查找同一单词的多个实例

> ID：15143504
> 
> 赞同：0
> 
> 时间：2013-02-28T18:59:44.260
> 
> 标签：regex

我试图想出一个正则表达式，它只会在重复超过 5 次时找到“icmp”这个词。我正在尝试“permit icmp{6,20} 但我想这仅在它们之间没有任何换行符时才有效。是否存在仅在找到超过 5 个单词实例时才会触发的正则表达式？下面是我希望此正则表达式找到的一些文本的示例。请注意，其中有 6 行包含单词“icmp”。正则表达式是否可以找到这个？

130 允许 gre 对象组 RemoteTunnel 对象组 LocalTunnel
140 允许 esp 对象组 RemoteTunnel 对象组 LocalTunnel（63043121 匹配）
150 允许 icmp 对象组 bcbsscnets 对象组 augustanets echo-r​​eply（35251 匹配）
160 允许 icmp 对象组bcbsscnets 对象组 augustanets 数据包太大
170 允许 icmp 对象组 bcbsscnets 对象组 augustanets 源淬火
180 允许 icmp 对象组 bcbsscnets 对象组 augustanets 时间超过（17 个匹配项）
190 允许 icmp 对象组 bcbsscnets 对象-group augustanets 参数问题
200 允许 icmp 对象组 snmpmgr 对象组 augustanets 回显（207603 匹配）
210 允许 udp 1.1.1.1 eq ntp 1.1.1.1 eq ntp
220 允许 udp 1.1.1.1 eq ntp 1.1.1.1 eq ntp

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T19:01:54.600

您可以使用此正则表达式：

```
(.?icmp.?){6,20} 
```

如果您希望“icmp”成为一个词，请使用这个：

```
(.?\bicmp\b.?){6,20} 
```

# c++ - C/C++ - 在 Linux 下寻找实时时序事件

> ID：15143521
> 
> 赞同：5
> 
> 时间：2013-02-28T19:00:44.557
> 
> 标签：c++, c, linux

我正在寻找一种在 Linux 下在 C/C++ 中进行计时事件的方法。
例如，每 100 毫秒执行一段代码。（不多不少，软实时）

到目前为止，我看到的唯一选择是：

*   无限循环，每次检查是否到了执行时间。
*   休眠线程直到运行时间。

无限检查是否到了运行时间，缺点是它（太）CPU 密集型。
一直睡到时间，缺点是不准确。睡眠时间只是一个指导方针，它可以睡得更多。

现在我想知道你们中是否有人知道如何在 Linux 下用 C/C++ 进行实时计时事件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-28T19:20:13.627

你要使用什么几乎无关紧要——a `select()`, `epoll()`, `usleep()`, `settimer()`. 有些方法可以“采取”更高分辨率的超时，有些则不能。但是 Linux 不是一个实时操作系统，甚至不应该期望它会在那个时候唤醒你的进程。现在，即使您旋转 CPU，如果内核决定将该 CPU 分配给其他进程或中断处理程序，内核也可以轻松挂起您的进程。

从 API 的角度来看（以及最近的趋势），您可能应该坚持使用[`timerfd()`](http://www.kernel.org/doc/man-pages/online/pages/man2/timerfd_create.2.html)——您可以告诉它使用什么时钟，并且它与 Linux 的其他事件调度机制（epoll、AIO 等）很好地集成在一起。

除此之外，它超出了您作为程序员的控制范围。为了从 Linux 获得近乎实时的行为，通常需要付出很大的努力。它的范围从构建一个定制的修补内核和为整个世界配置亲和力，包括中断屏蔽，到修补你的 BIOS 和调整硬件。

实际上，假设您在负载不高的商品 x86_64 服务器上运行新的 vanilla 内核，预计您的唤醒时间大约为 50 µs（您可以轻松地对其进行基准测试以大致了解您的系统）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-28T19:10:39.883

在非实时操作系统上运行，没有任何用户空间方法是完全可靠的。没错，睡眠是不精确的，你可能会睡过头，但循环也是如此：操作系统可能无法及时安排你的任务，你会错过你的时间。

根据您需要的可靠性，考虑使用实时操作系统 (RTOS)，例如[QNX](http://www.qnx.com/)或[RTLinux](https://rt.wiki.kernel.org/index.php/Main_Page)。RTLinux 的 wiki 有点过时了，所以我不确定它的活跃程度。

另一种方法是依靠某些硬件设备（例如 GPS 卡）的计时。您的程序将对外部事件做出反应，而不是尝试自行计时。例如，硬件设备可以公开一个“文件”。您的程序将打开它并阻止`read()`. 每隔 100 毫秒，硬件设备就会向您发送一些数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-28T19:07:18.453

你可以试试[RTAI](https://www.rtai.org/)，Linux 的实时应用程序接口。

> [...] 让您可以为自己喜欢的操作系统编写具有**严格时序约束的应用程序。**与 Linux 本身一样，该软件是社区的成果。

从初学者指南：

> RTAI 提供与 Linux 内核核心相同的服务，增加了**工业实时操作系统的特性**。它基本上由一个中断调度程序组成：RTAI 主要捕获外围设备中断，并在必要时将它们重新路由到 Linux。它不是对内核的侵入性修改；它使用 HAL（硬件抽象层）的概念从 Linux 获取信息并捕获一些基本功能。此 HAL 对 Linux 内核的依赖很少。这导致在 Linux 内核中的简单适配、从版本到 Linux 版本的简单 RTAI 移植以及更容易使用其他操作系统而不是 RTAI。RTAI 将 Linux 视为在没有实时活动发生时运行的后台任务。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-28T19:59:49.917

您还可以考虑 Linux 特定的[timerfd_create(2)](http://www.kernel.org/doc/man-pages/online/pages/man2/timerfd_create.2.html) -and friends-（使用[poll(2)](http://www.kernel.org/doc/man-pages/online/pages/man2/poll.2.html)进行多路复用/等待，或者一些事件库，如`libev`or `libevent`，或者 Gtk 或 Qt 事件循环，它们将`poll`在内部调用）或 Posix [timer_create( 2)](http://www.kernel.org/doc/man-pages/online/pages/man2/timer_create.2.html)。另请参阅[clock_gettime(2)](http://www.kernel.org/doc/man-pages/online/pages/man2/clock_gettime.2.html)和朋友

我强烈建议阅读[time(7)](http://www.kernel.org/doc/man-pages/online/pages/man7/time.7.html)手册页。它解释了很多。正如 Vlad[回答](https://stackoverflow.com/a/15143894/841108)的那样，Linux 不是真正的实时内核（即使它可能很接近）。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-02-28T19:04:09.207

查看 libevent： http: [//libevent.org/](http://libevent.org/)

> 当文件描述符上发生特定事件或达到超时后，libevent API 提供了一种执行回调函数的机制。此外，libevent 还支持由于信号或定期超时而引起的回调。

# java - BasicHttpParams - 添加日期格式（ClassCastException）

> ID：15143524
> 
> 赞同：0
> 
> 时间：2013-02-28T19:00:54.397
> 
> 标签：java, android, classcastexception

相关代码片段：

```
BasicHttpParams params = new BasicHttpParams();
Object dateFormats = "E, dd-MMM-yyyy HH:mm:ss zzz";
List<Object> dateFormatList = new ArrayList<Object>();

dateFormatList.add(dateFormats);

params.setParameter(CookieSpecPNames.DATE_PATTERNS, dateFormatList);

HttpClient client = new DefaultHttpClient(params);
HttpGet httpGet = new HttpGet("http://twitter.com/statuses/user_timeline/sample_user.json");

try {
    HttpResponse response = client.execute(httpGet); 
```

我试图用字符串转换列表，一个数组，在字符串数组上使用 Arrays.asList，我能想到的一切。但是每次我得到一个 ClassCastException 如下所示。我浏览了源代码，在发生异常的那一行，BestMatchSpecFactory 使用 getParameter() 来检索在 CookieSpecPNames.DATE_PATTERNS（应该是我的 List<>）中设置的参数并将其保存到集合中。

这是来自第 49 行 org.apache.http.impl.cookie 中 BestMatchSpecFactory.java 的代码：

```
Collection<?> param = (Collection<?>) params.getParameter(CookieSpecPNames.DATE_PATTERNS); 
```

ArrayList 实现了 List 实现了 Collection，那么这里的强制转换到底有什么问题呢？

```
02-28 10:09:29.117: W/System.err(1222): java.lang.ClassCastException: java.util.ArrayList
02-28 10:09:29.137: W/System.err(1222):     at org.apache.http.impl.cookie.BestMatchSpecFactory.newInstance(BestMatchSpecFactory.java:49)
02-28 10:09:29.137: W/System.err(1222):     at org.apache.http.cookie.CookieSpecRegistry.getCookieSpec(CookieSpecRegistry.java:113)
02-28 10:09:29.137: W/System.err(1222):     at org.apache.http.client.protocol.RequestAddCookies.process(RequestAddCookies.java:147)
02-28 10:09:29.147: W/System.err(1222):     at org.apache.http.protocol.BasicHttpProcessor.process(BasicHttpProcessor.java:290)
02-28 10:09:29.147: W/System.err(1222):     at org.apache.http.protocol.HttpRequestExecutor.preProcess(HttpRequestExecutor.java:160)
02-28 10:09:29.167: W/System.err(1222):     at org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:401)
02-28 10:09:29.167: W/System.err(1222):     at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:555)
02-28 10:09:29.181: W/System.err(1222):     at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:487)
02-28 10:09:29.181: W/System.err(1222):     at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:465)
02-28 10:09:29.181: W/System.err(1222):     at com.duderlabs.candr.MainActivity.readTwitterFeed(MainActivity.java:80)
02-28 10:09:29.181: W/System.err(1222):     at com.duderlabs.candr.MainActivity.onCreate(MainActivity.java:39)
02-28 10:09:29.189: W/System.err(1222):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
02-28 10:09:29.217: W/System.err(1222):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1611)
02-28 10:09:29.217: W/System.err(1222):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1663)
02-28 10:09:29.217: W/System.err(1222):     at android.app.ActivityThread.access$1500(ActivityThread.java:117)
02-28 10:09:29.217: W/System.err(1222):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:931)
02-28 10:09:29.238: W/System.err(1222):     at android.os.Handler.dispatchMessage(Handler.java:99)
02-28 10:09:29.238: W/System.err(1222):     at android.os.Looper.loop(Looper.java:123)
02-28 10:09:29.258: W/System.err(1222):     at android.app.ActivityThread.main(ActivityThread.java:3683)
02-28 10:09:29.258: W/System.err(1222):     at java.lang.reflect.Method.invokeNative(Native Method)
02-28 10:09:29.258: W/System.err(1222):     at java.lang.reflect.Method.invoke(Method.java:507)
02-28 10:09:29.258: W/System.err(1222):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
02-28 10:09:29.258: W/System.err(1222):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
02-28 10:09:29.258: W/System.err(1222):     at dalvik.system.NativeStart.main(Native Method) 
```

**更新**

我已根据以下答案更新了代码：

```
BasicHttpParams params = new BasicHttpParams();
String dateFormat = "E, dd-MMM-yyyy HH:mm:ss zzz";
Collection<String> dateFormatList = new ArrayList<String>();

dateFormatList.add(dateFormat);

params.setParameter(CookieSpecPNames.DATE_PATTERNS, dateFormatList);

HttpClient client = new DefaultHttpClient(params);
HttpGet httpGet = new HttpGet("http://twitter.com/statuses/user_timeline/sample_user.json");

try {
    HttpResponse response = client.execute(httpGet); 
```

但仍然得到同样的例外。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T20:12:10.733

根据[Spec](http://hc.apache.org/httpcomponents-client-ga/tutorial/html/statemgmt.html)，这是您应该注册的方式`CookieSpecPNames.DATE_PATTERNS`（尽管您的代码是正确的）：

```
BasicHttpParams params = new BasicHttpParams();
String dateFormats = "E, dd-MMM-yyyy HH:mm:ss zzz";
java.util.Collection<String> dateFormatList = new ArrayList<String>();

dateFormatList.add(dateFormats);

params.setParameter(CookieSpecPNames.DATE_PATTERNS, dateFormatList); 
```

对于调试，我也会尝试看看是否

```
client.getParams().setParameter(CookieSpecPNames.DATE_PATTERNS, dateFormatList); 
```

导致`ClassCastException`. 如果不是，那么您的`params`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-06T23:42:03.877

实际上，它应该是

```
client.getParams().setParameter(CookieSpecPNames.DATE_PATTERNS, new String[] { ... }); 
```

# mongodb - 在 MongoDB 聚合管道中引用整个文档

> ID：15143525
> 
> 赞同：14
> 
> 时间：2013-02-28T19:00:54.640
> 
> 标签：mongodb, aggregation-framework

我可以使用“$”运算符引用 MongoDB 聚合管道中属性的各个值的值。但是，我如何访问（参考）整个文档？

* * *

**更新**：提供一个示例来解释场景。

这是我正在尝试做的一个例子。我有一系列推文。每条推文都有一个成员“集群”，这表明特定推文属于哪个集群。

```
{
    "_id" : "5803519429097792069",
    "text" : "The following vehicles/owners have been prosecuted by issuing notice on the basis of photographs on dated... http://t.co/iic1Nn85W5",
    "oldestts" : "2013-02-28 16:11:32.0",
    "firstTweetTime" : "4 hours ",
    "id" : "307161122191065089",
    "isLoc" : true,
    "powertweet" : true,
    "city" : "new+delhi",
    "latestts" : "2013-02-28 16:35:05.0",
    "no" : 0,
    "ts" : 1362081807.9693,
    "clusters" : [
        {
            "participationCoeff" : 1,
            "clusterID" : "5803519429097792069"
        }
    ],
    "username" : "dtptraffic",
    "verbSet" : [
        "date",
        "follow",
        "prosecute",
        "have",
        "be"
    ],
    "timestamp" : "4 hours ",
    "entitySet" : [ ],
    "subCats" : {
        "Generic" : [ ]
    },
    "lang" : "en",
    "fns" : 18.35967,
    "url" : "url|109|131|http://fb.me/2CeaI7Vtr",
    "cat" : [
        "Generic"
    ],
    "order" : 7
} 
```

由于我的收藏中有几十万条推文，我想按“clusters.clusterID”对所有推文进行分组。基本上，我想编写如下查询：

```
db.tweets.aggregate (
{ $group : { _id : '$clusters.clusterID', 'members' : {$addToSet : <????> } } }
) 
```

我想访问当前正在处理的文档并在上面查询中引用它。有谁知道该怎么做？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2015-02-18T11:00:23.643

使用[**`$$ROOT`**](https://docs.mongodb.com/manual/reference/aggregation-variables/index.html#variable.ROOT)变量：

> 引用当前在聚合管道阶段处理的根文档，即顶级文档。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-01T13:46:24.233

目前在聚合框架中没有访问完整文档的机制，如果您只需要字段的子集，您可以这样做：

```
db.tweets.aggregate([ {$group: { _id: '$clusters.clusterID',
                                  members: {$addToSet :  
                                       { user: "$user",
                                         text: "$text", // etc for subset 
                                                        // of fields you want
                                       }
                                  } 
                               } 
                       } ] ) 
```

不要忘记，如果有几十万条推文，聚合整个文档将使您进入返回聚合框架结果文档的 16MB 限制。

您可以通过 MapReduce 执行此操作，如下所示：

```
var m = function() {
  emit(this.clusters.clustersID, {members:[this]});
}

var r = function(k,v) {
  res = {members: [ ] };
  v.forEach( function (val) {
     res.members = val.members.concat(res.members);
  } );
  return res;
}

db.tweets.mapReduce(m, r, {out:"output"}); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-28T20:42:10.780

我认为 MapReduce 对这项任务更有用。

正如 Asya Kamsky 在评论中所写，我的示例对于 mongodb 是不正确的，请使用mongoDB 的[官方文档](http://docs.mongodb.org/manual/reference/method/db.collection.mapReduce/#requirements-for-the-reduce-function)。

# php - FullCalendar 从议程周活动中删除拖动条

> ID：15143530
> 
> 赞同：0
> 
> 时间：2013-02-28T19:01:12.817
> 
> 标签：php, javascript, json, fullcalendar

我正在使用 FUllCalendar 并且非常喜欢它。我主要使用议程周视图来显示许多具有由 JSON 生成的半小时时间段的单个事件。我不希望用户能够使用每个事件底部的 = 栏来拖动事件时间。有没有办法从事件中删除这个拖动条。它基本上看起来像每个事件底部的等号，例如 =。我在文档中的任何地方都看不到这是可能的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T19:12:33.580

有一个[eventResize](http://arshaw.com/fullcalendar/docs/event_ui/eventResize/)事件可以传入。只需让回调调用revert 函数即可。您也可以添加到您的 css`.ui-resizable-handle { display:none }`中。我建议两者都只是为了确保。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T21:57:16.890

您可以使用[disableResizing](http://arshaw.com/fullcalendar/docs/event_ui/disableResizing/)；另请参阅[可编辑](http://arshaw.com/fullcalendar/docs/event_ui/editable/)的。

# dart - 从 Dart2js 输出创建 Javascript 部署集

> ID：15143531
> 
> 赞同：3
> 
> 时间：2013-02-28T19:01:17.807
> 
> 标签：dart, dart-webui

在开发了基于 Dart 的 Web 应用程序的 alpha 版本之后，我有兴趣测试我的应用程序的 Dart2js 部署潜力。但是，似乎没有一种“干净”的方式来创建应用程序的 JS 部署版本 - dart2js 代码将内容输出到 out 目录，但那里也有其他 Dart 内容。似乎事情引用回到了 web 父目录，然后是所有的包引用。我想把所有的东西都复制到一个单独的目录中，但这似乎不起作用。

有没有一种干净的方法来创建一个 Dart 应用程序的 Javascript 版本的部署？

提前致谢，

-D

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-28T20:31:36.817

这是生活在最前沿的乐趣之一……

看看这个答案： [什么是 pubspec on dart 的部署策略](https://stackoverflow.com/questions/12336685/what-could-be-a-deployment-strategy-with-pubspec-on-dart)

在 web ui 项目上要跟踪的另一个问题是：

*   [资源（css等）的路径修复破坏了部署](https://github.com/dart-lang/web-ui/issues/292)

（基本上，您正在等待`pub deploy`创建命令）

**更新**：[Dartbug 6006](https://code.google.com/p/dart/issues/detail?id=6006)目前正在开发中，并表示它的工作方式如下：

> 它会将“web”中的所有内容复制到部署目录中，在所有入口点上运行 dart2dart 和 dart2js，并清理 Dart 源文件。这将生成一个无需任何额外步骤即可提供服务的目录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-05T11:37:35.270

刚刚尝试这样做。

以下步骤应该有效：

1.  创建运行配置。务必使用 out 目录中的 html 作为目标。
2.  生成所有必要的文件（JS、CSS 等）
3.  将 out 目录中的所有文件复制到您想要的位置（例如您的网站）。
4.  更改 html 文件中的支持文件位置。特别是 css 和脚本 src="packages/browser/dart.js"

现在您可以通过双击 html 文件直接运行和/或在 Web 服务器中启动它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-06T17:18:32.563

你试过了吗：http: [//pub.dartlang.org/doc/pub-build.html](http://pub.dartlang.org/doc/pub-build.html)

> 准备好部署 Web 应用程序时使用 pub build。当您运行 pub build 时，它会为当前包及其所有依赖项生成资产，并将它们放入名为 build 的新目录中。

# iphone - 选项卡式应用程序

> ID：15143536
> 
> 赞同：0
> 
> 时间：2013-02-28T19:01:32.823
> 
> 标签：iphone, ios, picker

我看到以前有人问过类似的问题，但没有人回答。所以我要重新问一下。

我为我的 iPhone 创建了一个简单的选项卡式应用程序，只有两个视图。

第一个有一些简单的文本字段和标签等。没什么特别的。

当秒视图仍然为空时，一切正常。我可以毫无问题地在第一视图和第二视图之间导航。但是，我在第二个视图中添加了一个 Picker View 组件并正确设置它，也就是说，我添加了所需的方法和一个数组，其中包含将填充选择器的数据。而已。

所以发生了什么事？该应用程序现在不会转到第二个选项卡。当我单击第二个视图按钮时，应用程序崩溃并出现以下异常：

-[__NSCFString 属性：atIndex:effectiveRange:]：无法识别的选择器发送到实例 0x2103df30 2013-02-28 09:01:01.540 我的应用程序 [5040:907] *** 由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：“ -[__NSCFString 属性：atIndex:effectiveRange:]：无法识别的选择器发送到实例

在那之后还有很多十六进制数字。

此时，我尝试使用相同的选择器和代码创建单个视图应用程序。我只是复制并粘贴它。该应用程序加载得很好。我不知道为什么带有选择器视图的选项卡式应用程序会崩溃。显然这是其他人也经历过的事情，并在此论坛上询问过（请参阅下面的链接）

有什么建议吗？这似乎是一个已知问题（或者新开发人员不知道的问题，所以我们犯了同样的错误）。

这是与遇到相同问题的人的另一个主题的[链接。](https://stackoverflow.com/questions/10570643/uipickerview-crashing-when-used-in-a-tabbed-application)

# java - 提交按钮上的 HtmlUnit 点击事件不起作用

> ID：15143543
> 
> 赞同：0
> 
> 时间：2013-02-28T19:01:49.487
> 
> 标签：java, htmlunit

这周我开始做作业，在这个论坛上阅读我找到了我的问题的“解决方案”。我的程序解析网站的 HTML 页面并获取一些数据。好吧，这并不难。我的问题是如何在网站上获取数据。使用 HtmlUnit 我知道这是可能的，并阅读了他们的教程和网络上的一些代码，我编写了我的简单测试：

```
import org.junit.Test;

import com.gargoylesoftware.htmlunit.WebClient;
import com.gargoylesoftware.htmlunit.html.HtmlForm;
import com.gargoylesoftware.htmlunit.html.HtmlPage;
import com.gargoylesoftware.htmlunit.html.HtmlSubmitInput;

public class MyTest {

  @Test
  public void myClient() throws Exception {

    final WebClient webClient = new WebClient();

    HtmlPage page = webClient.getPage("http://www.atb.bergamo.it/ITA/Default.aspx?SEZ=2&PAG=38&MOD=LINTRV");

    final HtmlForm form = page.getFormByName("form1");

    final HtmlSubmitInput filtra = form.getInputByName("ctl13$btnFilter");

    page = filtra.click();

    final String pageAsXml = page.asXml();

    System.out.println(pageAsXml);

    webClient.closeAllWindows();
  }
} 
```

此代码获取远程页面，单击页面表单中的提交按钮，然后在控制台上打印提交结果。

问题是当我使用点击事件时，因为网页中没有任何变化。事实上，它必须出现一个新表，其中包含我想要收集的一些数据，但事实并非如此。

你能告诉我我哪里错了吗？

你知道另一种方法来做我想做的事吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T15:30:58.090

似乎这段代码在加载初始页面（特别是执行 JavaScript）时引发了异常。根据我的经验，这并不少见，可以归因于 HtmlUnit 的 JavaScript 引擎（Rhino）。

我建议改用 Selenium WebDriver。

此代码应获取页面的来源：

```
package javaapplication1;

import java.util.List;
import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.firefox.FirefoxDriver;
import org.openqa.selenium.support.ui.ExpectedCondition;
import org.openqa.selenium.support.ui.WebDriverWait;

public class Selenium  {
    public static void main(String[] args) throws InterruptedException {
        WebDriver driver = new FirefoxDriver();

        driver.get("http://www.atb.bergamo.it/ITA/Default.aspx?SEZ=2&PAG=38&MOD=LINTRV");
        WebElement filtra = driver.findElement(By.name("ctl13$btnFilter"));
        filtra.click();
        //make sure to wait till the results div is loaded
        //waits 10 seconds or then throws an exception
        (new WebDriverWait(driver, 10)).until(new ExpectedCondition<Boolean>() {
            public Boolean apply(WebDriver d) {
                List<WebElement> divTags = d.findElements(By.tagName("div"));
                for(WebElement tag: divTags){
                    if(tag.getAttribute("id").equalsIgnoreCase("ctl13_divRisultati")){
                        return true;
                    }
                }
                return false;
            }
        });
        String pageSource = driver.getPageSource();
        System.out.println(pageSource);
        driver.quit();
    }
} 
```

# restructuredtext - 如何在重组文本的链接中制作逐字文本？

> ID：15143546
> 
> 赞同：3
> 
> 时间：2013-02-28T19:01:56.007
> 
> 标签：restructuredtext, docutils

如何在重组文本的链接中制作逐字文本？

这是我想要实现的目标：

[`example`](http://example.com)

我尝试了以下

```
```example`` <http://example.com>`__
` ``example`` <http://example.com>`__ 
```

但两种情况都呈现为

```
` example <http://example.com>`__ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-26T18:52:23.693

~~据我所知并且可以在文档中找到，您根本无法做到这一点。~~

~~尝试将链接设置为粗体或斜体也是如此（这是我正在寻找的）。~~

显然**有**可能（参见@jJason S 的评论）在下面指向[在 reStructuredText 的链接中格式化文本](https://stackoverflow.com/questions/4743845/format-text-in-a-link-in-restructuredtext/4836544#4836544)

# c++ - 后续：执行一个类的成员函数

> ID：15143547
> 
> 赞同：0
> 
> 时间：2013-02-28T19:01:57.480
> 
> 标签：c++, multithreading, c++11, stdthread

[这是我之前在Executing a member function of a class 中](https://stackoverflow.com/questions/15143031/executing-a-member-function-of-a-class)发布的问题的后续。

我正在尝试以某种方式试验 C++1.1 线程，即它接受一个类的成员函数作为线程构造函数的参数，如下面第 20 行标记的第一个代码片段所示。类定义在第二个代码片段中给出。根据之前相关帖子中给出的答案，代码现在可以很好地编译。但是，现在我在第一个片段的第 20 行遇到了运行时错误。GDB 回溯显示在第三个片段中。我是 C++ 新手，无法正确解释此错误。你能告诉我有什么问题吗？谢谢。

**片段 1：线程初始化（main_app.cpp）**

```
#include <thread>
#include "ServiceRegistrar.hpp"

#define SERVER_TYPE  100065
#define SERVER_INST_LOWER  1
#define SERVER_INST_UPPER  2
#define TIMEOUT  500000

int main()
{
  ServiceRegistrar sr1(SERVER_TYPE, TIMEOUT, SERVER_INST_LOWER, SERVER_INST_LOWER);
      /*LINE 20 is the following*/
  std::thread t(&ServiceRegistrar::subscribe2TopologyServer, &sr1);
t.join();
  sr1.publishForSRs();

} 
```

**片段 2：类定义**

```
class ServiceRegistrar
{
  public:
    ServiceRegistrar(int serverType, int serverTimeOut, int serverInstanceLower, int serverInstanceUpper)
       : mServerType(serverType),
         mServerTimeOut(serverTimeOut),
         mServerInstanceLower(serverInstanceLower),
         mServerInstanceUpper(serverInstanceUpper)
         { }

     void subscribe2TopologyServer();
     void publishForSRs();
     void publishForServices();

  private:
     int mServerType;
     int mServerTimeOut;
     int mServerInstanceLower;
         int mServerInstanceUpper;           
  }; 
```

**片段 3：GDB 回溯**

```
 (gdb) r
  Starting program: /home/......./src/main_app 
  terminate called after throwing an instance of 'std::system_error'
  what():  Operation not permitted

  Program received signal SIGABRT, Aborted.
  0xb7fdd424 in __kernel_vsyscall ()
  (gdb) bt
  #0  0xb7fdd424 in __kernel_vsyscall ()
  #1  0xb7d471df in raise () from /lib/i386-linux-gnu/libc.so.6
  #2  0xb7d4a825 in abort () from /lib/i386-linux-gnu/libc.so.6
  #3  0xb7f2e8ad in __gnu_cxx::__verbose_terminate_handler() ()
  from /usr/lib/i386-linux-gnu/libstdc++.so.6
  #4  0xb7f2c4f3 in ?? () from /usr/lib/i386-linux-gnu/libstdc++.so.6
  #5  0xb7f2c52f in std::terminate() ()
  from /usr/lib/i386-linux-gnu/libstdc++.so.6
  #6  0xb7f2c7ce in __cxa_throw () from /usr/lib/i386-linux-gnu/libstdc++.so.6
  #7  0xb7f8772e in std::__throw_system_error(int) ()
  from /usr/lib/i386-linux-gnu/libstdc++.so.6
  #8  0xb7f8883c in   std::thread::_M_start_thread(std::shared_ptr<std::thread::_Impl_base>) () from   /usr/lib/i386-linux-gnu/libstdc++.so.6
  #9  0x0804981a in std::thread::thread<void (ServiceRegistrar::*)(),     ServiceRegistrar*>(void (ServiceRegistrar::*&&)(), ServiceRegistrar*&&) (this=0xbffff050, 
  __f=
  @0xbffff058: (void (ServiceRegistrar::*)(ServiceRegistrar * const)) 0x80491d2   <ServiceRegistrar::subscribe2TopologyServer()>)
   at /usr/include/c++/4.7/thread:133
  #10 0x08049526 in main () at main_app.cpp:20 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T19:05:05.527

这可能意味着您尚未启用线程支持。尝试添加`-pthread`到编译器的命令行参数（在链接步骤中）。

# php - 如何从 php 文件 2 调用 php 文件 1 中的函数，而不必在文件 2 中包含文件 1？

> ID：15143552
> 
> 赞同：0
> 
> 时间：2013-02-28T19:02:15.637
> 
> 标签：php, jquery, ajax

我正在为一个网站编写一个实时聊天功能，除了显示输入的文本外，我一切正常，我可以让我的默认语句显示在聊天框中，但是我必须有一个完全可以做到这一点的功能这里的单独页面是功能

```
 if(isset($_POST['method']) === true && empty($_POST['method']) === false)
    {
        $method = trim($_POST['method']);

        if($method === 'fetch')
        {
            $messages = fetchMessages();

            if(empty($messages) === true)
            {
                echo 'A representative will be with you shortly';
            }else
            {
                foreach($messages as $message)
                {
                    $ts = $message['timestamp'];
                    ?>
                    <div class = "message">
                        <a href = "#"><?php echo date('n-j-Y h:i:s a', $ts); ?>
                        <?php echo $message['username']; ?></a>says:<p>
                        <?php echo nl2br($message['message']); ?></p>
                    </div>
                    <?php
                }
            }
        }
    } 
```

我当然是在调用`fetchMessage()`这个文件中的函数。但是，要使该功能正常工作，我必须将它放在 chatRoom.php 文件中，以便我可以将会话 ID 传递给它，以便它仅获取引用该特定会话的聊天。

如果我将此脚本移动到 chatRoom.php 文件或在此文件中包含 chatRoom.php 文件，聊天室会中断并在应该进行聊天的聊天框中显示其自身的第二个副本，并且不会执行任何操作。

如果我使用此代码将 fetchMessage 移动到文件中，我只会得到默认消息，不会显示任何其他消息。

我正在使用 jquery 和 ajax 对聊天进行增量获取，该聊天存储在我数据库的表中。如果您需要任何其他信息，请询问我很乐意添加此信息，但不确定需要什么。我对 jquery 和 ajax 还是很陌生。

好的，这里是 chatRoom.php 的代码

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
    <html xmlns="http://www.w3.org/1999/xhtml">
    <?php
    session_start();
    include 'conection.php';

    $name = $_GET['name'];
    $query = "SELECT * FROM chatSession WHERE user_name = '$name'";
    $result = mysql_query($query, $con) or die(mysql_error());
    $row = mysql_fetch_array($result);

    $session = $row['session_id'];

    function fetchMessages()
    {
$get = ("SELECT * FROM chatRoom WHERE session_id = '$session' ORDER BY chat.timestamp ASC");
$hold = mysql_query($get, $con);
$show = mysql_fetch_array($hold);

return $show;
    }

    if(isset($_GET['submitmsg']))
    {
$message = mysql_real_escape_string($_GET['usermsg']);
$throw = "INSERT INTO chatRoom(session_id, source, message, timestamp) VALUES('".$_GET['id']."', '".$_GET['source']."', '$message', UNIX_TIMESTAMP())";

if (!mysql_query($throw,$con))
{
    die('Error: ' . mysql_error());
}else
{

}
    }
    ?>
<head>
    <title></title>
    <link type="text/css" rel="stylesheet" href="css/chatStyle.css" />
    <script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
</head>
<body>
    <div id="wrapper">
        <div id="menu">
            <p class="welcome"><b>Welcome, <?php echo $row['user_name']; ?></b></p>
            <p class="logout"><a href="nameSub.php?logout=true&name=<?php echo $row['user_name']; ?>&id=<?php echo $row['session_id']; ?>">Exit Chat</a></p>
            <div style="clear:both"></div>
        </div>
        <div id="chatbox">
        </div>
        <form name = "message" action = "<?php echo $_SERVER['PHP_SELF']; ?>" method = "get">
            <input type = "hidden" name = "name" value = "<?php echo $_GET['name']; ?>" />
            <input name = "id" type = "hidden" value = "<?php echo $row['session_id']; ?>" />
            <input name = "source" type = "hidden" value = "<?php echo $row['user_name']; ?>" />
            <input name = "usermsg" type = "text" id = "usermsg" size = "63" />  
            <input name = "submitmsg" type = "submit"  id = "submitmsg" value = "Send" />  
        </form> 
    </div>
    <script type="text/javascript">
        $(document).ready(function()
        {
            fetchMessages = function()
            {
                $.ajax
                ({
                    url:'functions.php',
                    type:'post',
                    data:{method:'fetch'},
                    success:function(data)
                    {
                        $('#chatbox').html(data);
                    }
                });
            }

            setInterval(fetchMessages, 5000);
            fetchMessages();
        });
    </script>
</body> 
```

我希望这有帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T19:04:39.240

`functions.php`将所需的功能移动到两个文件都包含的外部文件（例如）。

**编辑：**详细说明：

PHP文件1：

```
 include('functions.php');
 $myvar = $_GET['myvar']; // jQuery GET variable
 $othervar = $_POST['myvar'];

 commonFunction($myvar,$othervar); 
```

PHP文件2：

```
include('functions.php');
 $myvar = $_GET['myvar']; // jQuery GET variable
 $othervar = $_POST['myvar'];

 commonFunction($myvar,$othervar); 
```

函数.php：

```
function commonFunction($var1, $var2) { 
  // Do common proccessing here
} 
```

# arrays - 使用R将文件导入数组

> ID：15143555
> 
> 赞同：3
> 
> 时间：2013-02-28T19:02:35.397
> 
> 标签：arrays, r, loops, import

我在一个文件夹中有多个 csv 文件。每个 csv 文件包含一个 200 行和 200 列的表。我可以单独引入每个文件并将其显示为矩阵。我也可以做一个目录并列出它们所在文件夹中的每个文件。我需要做的是引入每个文件，打开它们，然后将它们组合成一个数组。当我这样做时，虽然我收到警告说没有这样的文件。

我的代码是

```
x <- dir(path=" ", pattern = ".csv")
num <- array(0,dim=c(200,200,length(x)))
for(i in 1:length(x)){
  temp <- read.csv(x[i], skip=1)
  temp2 <- temp[,2]
  num[,i]<-temp2

} 
```

这给了我警告

```
Error in file(file, "rt") : cannot open the connection
In addition: Warning message:
In file(file, "rt") :
  cannot open file 'test_1.csv': No such file or directory 
```

同样，当我处理单个文件时，我可以很好地导入它们并列出它们并将它们作为矩阵打开。为什么我会收到此警告？为什么当我一次做一个但不能一次做多个时，R 能够找到我的文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T20:01:14.830

首先，您确定您正在正确地将文件列表读入变量中`x`。我认为您的 for 循环存在一些问题。您还确定您与这些文件位于同一目录中吗？在您为变量`dir`输入的命令中，我不确定这意味着什么。试试这个`" "``path`

```
> x <- dir(pattern = ".csv")
> num <- array(0,dim=c(200,200,length(x))) # in my case `length(x)` is 9.
> m <- matrix(rnorm(200*200),nrow=200,ncol=200) # generate some 200x200 matrix
> for(i in 1:length(x)){
    num[,,i] <- m # notice its num[,,i] and not num[,i]
}
> num[1:4,1:4,9]
           [,1]        [,2]       [,3]       [,4]
[1,] -1.5674073  0.05364477  0.8367233  1.7995047
[2,] -0.8613244  1.00400787 -0.2464169 -1.2897856
[3,] -0.7907845 -1.40617992  1.0596680 -0.5270983
[4,] -0.5206049  0.66253519  1.6820722  1.2017410 
```

# python - 尝试打印包含python中给定模式的行之前的每一行

> ID：15143556
> 
> 赞同：0
> 
> 时间：2013-02-28T19:02:44.310
> 
> 标签：python, regex

基本上我有一个巨大的文本文件，其中有几行除了一个'@'符号之外什么都没有。

我想打印第一行之前的每一行，这只是一个'@'符号。

我是 python 新手，但对正则表达式非常熟悉，但我就是想不通。这是我到目前为止所得到的：

```
original = open('oldfile.txt')
for each_line in original:  
    pattern = re.compile("(^.*)(^@\s)", re.M)
    m = re.match(pattern, each_line).group(1)
    print(m)

original.close 
```

我发誓我已经阅读了一个半小时的 python 在线文档和其他 stackoverflow 文章，但不知何故我仍然没有得到这个。

该代码的结果是：

> AttributeError：“NoneType”对象没有属性“组”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T19:06:09.090

这里不需要正则表达式，其实很简单：

```
with open('file.txt') as file:
    for line in file:
        line = line.rstrip("\n")
        if line == "@":
            break
        print(line) 
```

我们打开文件（使用`with`更易读的语句，并确保文件关闭，即使发生异常），然后循环遍历文件中的行。如果该行只是`"@"`，我们将跳出循环，否则，我们打印该行并继续。

正如评论中所指出的，我们需要从行中删除换行符（或检查`"@\n"`（如果我们这样做，我们还需要`print(line, end="")`在 3.x 或`print line,`2.x 中这样做以停止`print()`添加额外的换行符）。

正如 Martijn Piters 指出的那样，还有另一种方法可以做到这一点，使用[`takewhile()`](http://docs.python.org/3/library/itertools.html#itertools.takewhile)函数 from [`itertools`](http://docs.python.org/3/library/itertools.html)。这会从可迭代对象中获取项目，直到满足条件，这正是我们想要的：

```
import itertools

with open('file.txt') as file:
    for line in itertools.takewhile(lambda x: x != "@\n", file):
        print(line, end="") 
```

我会争辩说，对于仅将值打印出来，这很难阅读，但是在某些情况下它可能很有用（例如，如果您希望列出值，或者将它们传递给另一个函数，让它们作为一个可迭代的是有用的）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T19:09:21.297

正如 Lattyware 所提到的，您不需要正则表达式。

至于您的代码的问题，当字符串与模式不匹配时，`re.match`返回`None`而不是匹配对象。在这种情况下，您可以调用该`group`属性。这就是异常的原因：`None`，它是类型的实例（*实例*）`NoneType`，没有属性`group`。

此外，该`re.compile`语句应该在循环之外，否则显式编译正则表达式没有多大意义。

# c - 在 .c 文件上显然没有任何作用的代码块是什么？

> ID：15143562
> 
> 赞同：1
> 
> 时间：2013-02-28T19:03:03.763
> 
> 标签：c

这段代码是什么意思？具体来说，花括号在做什么？它们不在函数的中间。

```
yyerror(s) char * s;

{
    fputs(s,stderr), putc('\n',stderr);
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-28T19:04:26.180

这看起来像 K&R 语法。在标准 C 中，它看起来像：

```
int yyerror(char *s)
{
    fputs(s,stderr), putc('\n',stderr);
} 
```

在这种情况下，函数体中的逗号运算符实际上也是空操作。您可以轻松地用分号替换它，并获得这个看起来更熟悉（和等效）的代码：

```
int yyerror(char *s)
{
    fputs(s,stderr);
    putc('\n',stderr);
} 
```

请注意，`int`由于未指定返回类型，因此默认情况下假定此函数返回，但该函数不包含`return`语句。这意味着您不应该在程序中的任何地方依赖此函数的返回值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-28T19:04:32.500

旧式函数声明。

然后在函数体中：

```
fputs(s,stderr), putc('\n',stderr); 
```

相当于

```
fputs(s,stderr); putc('\n',stderr); 
```

# jquery - 为什么 JQuery .live 可以删除动态添加的项目，但 JQuery .on 或 .bind 不能？

> ID：15143564
> 
> 赞同：2
> 
> 时间：2013-02-28T19:03:06.503
> 
> 标签：jquery

我听说 JQuery .live 已被弃用，不应再使用。我在下面有一些示例代码，我已经在我有一个按钮的地方编写了一个 ID 为 adddiv 的 div，它将一个 ID 为 seconddiv 的 div 附加到一个 ID 为 firstdiv 的现有 div 中。

在 seconddiv 中，我有另一个按钮，其 id 为删除，单击该按钮时，我想删除 seconddiv。代码按原样工作正常，但是如果我将捕获删除按钮的单击事件的 JQuery 更改为使用 .on 或 .bind，它将无法工作。

谁能告诉我如何更改它以使用 .on 或 .bind 使其工作？

HTML：

```
<div id="firstdiv">
Pre Existing Div
<input type="button" id="adddiv" value="Add Div" />
</div> 
```

Javascript：

```
<script type="text/javascript">
    $().ready(function () {

        $('#adddiv').click(function () {
            $('#firstdiv').append('<div id="seconddiv"> Click here to delete the second div: <input type="button" id="delete" value="Delete Div"></div>')
        });

        $('#delete').live('click', function (e) { 
            $(this).parent('#seconddiv').remove();
        });   
    });
</script> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-28T19:07:13.013

[jQuery 的`.on()`](http://api.jquery.com/on/)设置是这样的：
`.on( events [, selector ] [, data ], handler(eventObject) )`.

基本上，您需要将其绑定到已经存在的选择器，因此对于本示例，您可以使用以下选择器：

*   `$(document).on()`
*   `$('body').on()`
*   `$('#firstdiv').on()`

* * *

接下来，您指定什么`event`：

*   `$(document).on('click')`
*   `$('body').on('click')`
*   `$('#firstdiv').on('click')`

*注意：*如果要绑定多个事件，请在事件之间添加空格：

`$(document).on('click mouseover')`

演示：http: [//jsfiddle.net/dirtyd77/uBuH7/1/](http://jsfiddle.net/dirtyd77/uBuH7/1/)

* * *

然后，你说哪些元素触发了事件：

*   `$(document).on('click', '#delete')`
*   `$('body').on('click', '#delete')`
*   `$('#firstdiv').on('click', '#delete')`

*注意：*如果要绑定多个元素，请使用逗号：

`$(document).on('click', '#delete, #delete2')`

演示：http: [//jsfiddle.net/dirtyd77/uBuH7/2/](http://jsfiddle.net/dirtyd77/uBuH7/2/)

* * *

最后，添加一个处理程序：

*   `$(document).on('click', '#delete', function(){ })`
*   `$('body').on('click', '#delete', function(){ })`
*   `$('#firstdiv').on('click', '#delete', function(){ })`

* * *

JAVASCRIPT：

```
 $().ready(function () {
    $('#adddiv').click(function () {
        $('#firstdiv').append('<div id="seconddiv"> Click here to delete the second div: <input type="button" id="delete" value="Delete Div"></div>')
    });

    $(document).on('click', '#delete', function(e) {
        $(this).parent('#seconddiv').remove();
    });   
}); 
```

演示：http: [//jsfiddle.net/dirtyd77/uBuH7/](http://jsfiddle.net/dirtyd77/uBuH7/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T19:07:25.503

```
 <script type="text/javascript">
    $().ready(function () {

        $('#adddiv').click(function () {
            $('#firstdiv').append('<div id="seconddiv"> Click here to delete the second div: <input type="button" id="delete" value="Delete Div"></div>')
        });

        $('body').on('click', '#delete', function (e) { 
            $(this).parent('#seconddiv').remove();
        });   
    });
</script> 
```

如果`on`我将`body`其作为事件处理程序，它可以是任何元素，只要它是您将要调用的元素的父元素，在您的情况下是`#delete`. 用于事件处理程序的 DOM 树越靠前，冒泡效果就越远。

但是，在选择事件处理程序时要记住的一件事是，您必须确保它在 DOM 中可用，因此在这种情况下，将其`$(document)`用作事件处理程序始终是安全的。

[请参阅此处](http://api.jquery.com/on/)的 jQuery`on`文档

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T19:59:11.367

我想改变很多事情：

```
<script type="text/javascript">

    // Event handler to delete a second div
    var onDelete = function (e) { 
        $(this).closest('#seconddiv').remove();
    };
    // Event handler to add a second div
    var onAdd = function () {
        // create div
        var div = $('<div/>', {
           id: 'seconDiv',
           text: 'Click here to delete the second div:'
        });
        // create button
        var button = $('<input/>', {
            id: 'delete',
            type: 'button',
            value: 'Delete Div'
        });
        // wrap them together and append
        div.append(button).appendTo('#firstDiv');
    };

    // Event binding .on(event, selector, handler)
    $(document).on('click', '#addiv', onAdd);
    $(document).on('click', '#delete', onDelete);
</script> 
```

1.  使用 时，只要绑定事件时 DOM 中存在第一个选择器`.on()`，就不需要。`$().ready()`因此`$(document)`选择器。简化代码。
2.  如果您使用`.on()`，请尝试坚持使用它。使用`.on('click'..)`and`.click()`是混乱和混乱的。
3.  混合 html 和 javascript 很麻烦，那么为什么不使用 jQuery 方式构造 html 元素呢？在尝试找出刚刚创建的元素的属性时，可以避免水平滚动。另外，即使在您将元素注入 dom 之前，您也可以轻松获得完整的 jQuery 支持
4.  使用`.closest()`而不是`.parent()`允许在不破坏代码的情况下对 html 进行较小的更改。
5.  当然，使用`.on()`而不是弃用`.live()`是一个好主意。
6.  我也喜欢将事件绑定和处理分开。将所有事件绑定器紧密堆叠在一起，可以更轻松地确定文档中存在哪些事件。

# jquery - 选项卡通过单选按钮

> ID：15143567
> 
> 赞同：0
> 
> 时间：2013-02-28T19:03:09.670
> 
> 标签：jquery

默认的浏览器行为是，当您在表单元素中切换并进入单选按钮组时，焦点会转到组中的第一个单选按钮，您需要按空格键来选择它。即使在同一组中，我也需要能够继续切换并转到下一个单选按钮。

下面的代码不仅会跳转到单选按钮，还会选择它，我如何继续在其余单选按钮之间切换，然后再到其他元素？

```
$(':input:visible').keypress(function(event) {
     if(event.keyCode == '9') { // Tab
           $(':radio').focus(function () {
                this.checked = true;
           });
     }
}); 
```

我知道这是一个“黑客”......是的，每个元素都有一个唯一的 tabindex 值；）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T19:21:22.447

当单选按钮集中时，您可以使用箭头键选择另一个
**或**
尝试类似：

```
$('input[name="something"]').on("keypress", function(e) {
    if(e.keyCode == '9')
        $(this).next().focus().attr("checked", true)
}); 
```

希望这有效并有所帮助；-)

# objective-c - DDHotKey - 跟踪而不取消事件

> ID：15143571
> 
> 赞同：2
> 
> 时间：2013-02-28T19:03:19.507
> 
> 标签：objective-c, macos, cocoa, nsevent, ddhotkey

我正在使用[DDHotKey](https://github.com/davedelong/DDHotKey)来跟踪一些系统范围的键盘快捷键。当事件被触发时，只有我的应用程序才能交付它。是否可以在不阻止事件传递到其原始目标应用程序的情况下观察它？

* * *

以下是此模块注册事件处理程序的方式：

```
InstallApplicationEventHandler(&dd_hotKeyHandler, 1, &eventSpec, NULL, NULL); 
```

和事件处理程序本身：

```
OSStatus dd_hotKeyHandler(EventHandlerCallRef nextHandler, EventRef theEvent, void *userData) {
    @autoreleasepool {
        EventHotKeyID hotKeyID;
        GetEventParameter(theEvent, kEventParamDirectObject, typeEventHotKeyID, NULL, sizeof(hotKeyID),NULL,&hotKeyID);

        UInt32 keyID = hotKeyID.id;

        NSPredicate *predicate = [NSPredicate predicateWithFormat:@"hotKeyID = %u", keyID];
        NSSet *matchingHotKeys = [[DDHotKeyCenter sharedHotKeyCenter] hotKeysMatchingPredicate:predicate];
        if ([matchingHotKeys count] > 1) { NSLog(@"ERROR!"); }
        DDHotKey *matchingHotKey = [matchingHotKeys anyObject];

        NSEvent *event = [NSEvent eventWithEventRef:theEvent];
        NSEvent *keyEvent = [NSEvent keyEventWithType:NSKeyUp
                                             location:[event locationInWindow]
                                        modifierFlags:[event modifierFlags]
                                            timestamp:[event timestamp]
                                         windowNumber:-1
                                              context:nil
                                           characters:@""
                          charactersIgnoringModifiers:@""
                                            isARepeat:NO
                                              keyCode:[matchingHotKey keyCode]];

        [matchingHotKey invokeWithEvent:keyEvent];
    }

    return noErr;
} 
```

* * *

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-28T20:31:09.853

不，热键功能的全部意义在于事件被注册键的应用程序吞没。

您需要一个[全局事件监视器](http://developer.apple.com/library/mac/documentation/Cocoa/Reference/ApplicationKit/Classes/NSEvent_Class/Reference/Reference.html#//apple_ref/doc/uid/20000016-SW16)，它允许您观察系统中其他任何地方的关键事件，但不会影响它们。

```
[NSEvent addGlobalMonitorForEventsMatchingMask:NSKeyUpMask
                                       handler:^(NSEvent * event){
    // See if the key is the one you want and act on it.
}]; 
```

# javascript - 为什么这个新代码比我的旧代码慢？

> ID：15143574
> 
> 赞同：3
> 
> 时间：2013-02-28T19:03:35.280
> 
> 标签：javascript, google-chrome, optimization, garbage-collection, v8

**问题**

我已经用一些我期望性能更好的新代码替换了一些我遇到性能问题的代码。相反，它的表现更差。我想了解为什么会这样，以便我可以使用 chrome 的 V8 运行时而不是反对它。

**的背景**

我的代码用于基于浏览器的游戏。在正常操作期间，许多 xy 坐标在函数之间传递。在我“修复”事情之前的一个例子是这样的：

```
function doSomething1(x,y) {
    /* Do work here */
    return {x: newx, y: newy};
}

function doSomething2(x,y) {
    /* Do work here */
    return {x: newx, y: newy};
}

function doSomething3(x, y) {
    var result1 = doSomething1(x, y);
    var result2 = doSomething2(result1.x, result1.y);

    /* Do work here */
    return {x: newx, y: newy};
} 
```

你明白了.. 很多函数互相调用，返回带有 xy 属性的小匿名对象并从中提取值。

当我的游戏运行时，它有垃圾收集问题。内存图非常刺眼，帧速率不平滑。为了缓解这种情况，我决定重写我的代码，使其遵循以下模式：

```
function doSomething(x,y,out) {
    /* Do work here */
    out[0] = newx;
    out[1] = newx;
}

var xy = [0,0]; /* Some 2-length array for results */
doSomething(5,6,xy);
/* 'Return' value in xy */ 
```

这样，只有一个“分配”，并且数组中的值在它调用链中的函数时被替换。

这确实具有平滑内存分配图的效果。它还具有将我的帧速率降低 50% 的意外副作用！

为什么会这样？我可能会绕过哪些优化？如何更好地编写此代码以与 V8 运行时一起使用？

**更新**

进一步的调查表明，代码实际上并没有慢 50%。只有当新代码托管在 127.0.0.1 和旧代码托管在互联网上时，它才会更慢。这很奇怪，但不是同一个问题。我将关闭这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T19:12:51.710

当你写

```
out[0] = newx 
```

V8 只会知道分配一个带有 '0' 字段的新对象并坚持`newx`下去。当你继续

```
out[1] = newy 
```

它必须追踪它刚刚分配的对象，并为“1”字段分配更多空间。这比后一种情况要贵得多`{x: newx, y:newy}`，因为在后一种情况下，V8 已经知道将有多少个字段。

我对优化 javascript 或您的游戏知之甚少，因此我很难提出进一步的建议。希望您已经研究过算法问题，现在正尝试进行一些微调——算法是可以进行重大改进的地方。

# wix - 使用 ThemeFile 时，Wix Bootstrapper 不会运行

> ID：15143575
> 
> 赞同：2
> 
> 时间：2013-02-28T19:03:36.710
> 
> 标签：wix, themes, bootstrapper, burn

我创建了一个 wix 引导程序，当没有使用主题文件时，它可以在所有计算机上正常运行。如果我使用主题文件，它将在我的计算机上运行，​​但不能在其他任何人的计算机上运行。

`<BootstrapperApplicationRef Id="WixStandardBootstrapperApplication.RtfLicense" >` `<bal:WixStandardBootstrapperApplication LicenseFile="C:\eula.rtf"` `ThemeFile="C:\myTheme.xml" />` `</BootstrapperApplicationRef>`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-28T19:26:44.083

首先，查看其他机器上的捆绑日志文件以查看错误。该消息可能会表明加载主题时出现问题。如果是这种情况，请确保主题文件中到松散文件的所有路径（例如，`Image`元素`ImageFile`属性）都是相对路径。最后，确保将松散文件作为`Payload`元素包含在`BootstrapperApplicationRef`.

与 .wxs 文件不同，主题文件的松散文件不会自动包含在内。这就是为什么您必须`Payload`自己添加元素的原因。

# java - 如何从线程运行的 ServerSocket 向客户端发出命令？

> ID：15143576
> 
> 赞同：-1
> 
> 时间：2013-02-28T19:03:37.807
> 
> 标签：java, android, multithreading, sockets, serversocket

我正在使用本指南：

[将套接字编程结合到您的应用程序中](http://thinkandroid.wordpress.com/2010/03/27/incorporating-socket-programming-into-your-applications/)

在我的这部分代码中，我试图让服务器发送消息以响应 UI 按钮按下：

```
public class MusicServerThread implements Runnable {
        Socket client;

        public void run() {
            try {
                if (SERVERIP != null) { //'Success' case when there is an Internet connection.
                    handler.post(new Runnable() {
                        @Override
                        public void run() {
                            Log.d(WiFiDirectActivity.TAG, "MusicServerThread_run: ServerIP = " + SERVERIP);
                            //TODO serverStatus can't be null. Fix this.
                            //serverStatus.setText("Listening on IP: " + SERVERIP);
                        }
                    });
                    serverSocket = new ServerSocket(SERVERPORT);
                    Log.d(WiFiDirectActivity.TAG, "MusicServerThread_run: serverSocket created on port " + SERVERPORT);
                    while (true) {
                        // listen for incoming clients
                        client = serverSocket.accept();
                        Log.d(WiFiDirectActivity.TAG, "MusicServerThread_run: Client connection recieved.");
                        handler.post(new Runnable() {
                            @Override
                            public void run() {
                                //serverStatus.setText("Connected.");
                            }
                        });

                        try {
                            //This line takes the client commands.
                            BufferedReader in = new BufferedReader(new InputStreamReader(client.getInputStream()));
                            String line = null;
                            while ((line = in.readLine()) != null) {
                                //TODO Stop endless loop from being a radge. Play music command
                                Log.d(WiFiDirectActivity.TAG, "Command issued " + line);
                                if (line.toLowerCase(Locale.getDefault()).trim().equals("play")){ //if the command is play
                                    Log.d(WiFiDirectActivity.TAG, "Server says: client command accepted " + line);

                                    //MediaPlayer mediaPlayer = MediaPlayer.create(getActivity(), R.raw.mse5251);
                                    //mediaPlayer.start(); // no need to call prepare(); create() does that for you

                                    handler.post(new Runnable() {
                                        @Override
                                        public void run() {
                                            // do whatever you want to the front end
                                            // this is where you can be creative
                                            MediaPlayer mediaPlayer = MediaPlayer.create(getActivity(), R.raw.metallica_guitar);
                                            mediaPlayer.start(); // no need to call prepare(); create() does that for you

                                        }
                                    });
                                }

                                if (line.toLowerCase(Locale.getDefault()).trim().equals("join")){ //if the command is join
                                    Log.d(WiFiDirectActivity.TAG, "Server says: client command accepted " + line);

                                    //Just for fun server will play as well.
                                    //Todo: add a timer to delay start
                                    MediaPlayer mediaPlayer = MediaPlayer.create(getActivity(), R.raw.metallica_guitar);
                                    mediaPlayer.start(); // no need to call prepare(); create() does that for you

                                    try {
                                        PrintWriter out = new PrintWriter(new BufferedWriter(new OutputStreamWriter(client
                                                .getOutputStream())), true);
                                        // where you issue the commands
                                        out.println("play");
                                    } catch (Exception e) {
                                        Log.e(WiFiDirectActivity.TAG, "S: Error", e);
                                    }

                                    handler.post(new Runnable() {
                                        @Override
                                        public void run() {
                                            // do whatever you want to the front end
                                            // this is where you can be creative

                                        }
                                    });
                                }

                                break;// Play command received, break.
                            }
                            break;
                        } catch (Exception e) {
                            handler.post(new Runnable() {
                                @Override
                                public void run() {
                                    //serverStatus.setText("Oops. Connection interrupted. Please reconnect your phones.");
                                }
                            });
                            e.printStackTrace();
                        }
                    }
                } else {
                    handler.post(new Runnable() {
                        @Override
                        public void run() {
                            //serverStatus.setText("Couldn't detect internet connection.");
                        }
                    });
                }
            } catch (Exception e) {
                handler.post(new Runnable() {
                    @Override
                    public void run() {
                        //serverStatus.setText("Error");
                    }
                });
                e.printStackTrace();
            }
        }

        /*Method used by the server to send command strings.*/
        public void sendCommand(String command){
            Log.d(WiFiDirectActivity.TAG, "MusicServerThread_sendCommand: Method reached.");

            try {
                PrintWriter out = new PrintWriter(new BufferedWriter(new OutputStreamWriter(client
                        .getOutputStream())), true);
                // where you issue the commands
                out.println("play");
            } catch (Exception e) {
                Log.e(WiFiDirectActivity.TAG, "S: Error", e);
            }
        } 
```

但是我在我的 SendCommands 方法中收到了我认为是客户端的空指针异常。

甚至可以让服务器线程运行，等待命令，而我尝试使用它的 SendCommands 方法向客户端发送命令？

更新：

这是错误的堆栈跟踪：

```
03-04 16:35:44.055: E/wifidirectdemo(4202): S: Error
03-04 16:35:44.055: E/wifidirectdemo(4202): java.lang.NullPointerException
03-04 16:35:44.055: E/wifidirectdemo(4202):     at com.example.android.wifidirect.DeviceDetailFragment$MusicServerThread.sendCommand(DeviceDetailFragment.java:465)
03-04 16:35:44.055: E/wifidirectdemo(4202):     at com.example.android.wifidirect.DeviceDetailFragment$4.onClick(DeviceDetailFragment.java:201)
03-04 16:35:44.055: E/wifidirectdemo(4202):     at android.view.View.performClick(View.java:3538)
03-04 16:35:44.055: E/wifidirectdemo(4202):     at android.view.View$PerformClick.run(View.java:14330)
03-04 16:35:44.055: E/wifidirectdemo(4202):     at android.os.Handler.handleCallback(Handler.java:608)
03-04 16:35:44.055: E/wifidirectdemo(4202):     at android.os.Handler.dispatchMessage(Handler.java:92)
03-04 16:35:44.055: E/wifidirectdemo(4202):     at android.os.Looper.loop(Looper.java:156)
03-04 16:35:44.055: E/wifidirectdemo(4202):     at android.app.ActivityThread.main(ActivityThread.java:4977)
03-04 16:35:44.055: E/wifidirectdemo(4202):     at java.lang.reflect.Method.invokeNative(Native Method)
03-04 16:35:44.055: E/wifidirectdemo(4202):     at java.lang.reflect.Method.invoke(Method.java:511)
03-04 16:35:44.055: E/wifidirectdemo(4202):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
03-04 16:35:44.055: E/wifidirectdemo(4202):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
03-04 16:35:44.055: E/wifidirectdemo(4202):     at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T11:45:11.203

我的猜测是你`sendCommand`之前的调用`client`已经初始化，导致`NullPointerException`上线：

```
PrintWriter out = new PrintWriter(new BufferedWriter(new OutputStreamWriter(
                    client.getOutputStream())), true); 
```

因为`client`是空的。

根据堆栈跟踪，从类中的方法`sendCommand`调用，第 201 行。`onClick``DeviceDetailFragment`

您的主要选择是：

*   输入时`sendCommand`，请确保它`client`不为空，如果是，请让用户知道您尚未连接。
*   禁用该`onClick`方法（例如通过禁用相应的按钮），直到建立连接并且`client`不为空

# ios - iOS 应用程序不在后台运行 = YES - 我如何检查用户何时退出应用程序

> ID：15143578
> 
> 赞同：0
> 
> 时间：2013-02-28T19:03:41.563
> 
> 标签：ios, appdelegate

在我的 info.plist 文件中，我的应用程序不会在后台运行 = YES。这是一个企业应用程序，我正在尝试在用户退出（点击主页按钮）时记录。但是在 AppDelegate 中，我登录到控制台以查看将调用什么方法，但它们都不是（applicationWillResignActive、applicationDidEnterBackground、applicationWillTerminate）。有没有办法确定用户何时退出我的 plist 设置>？

谢谢

这是 willTerminate 方法，它是开箱即用的：

```
- (void)applicationWillTerminate:(UIApplication *)application
{
    NSLog(@"goodbye");
    // Called when the application is about to terminate. Save data if appropriate. See also applicationDidEnterBackground:.

} 
```

我已经更改了 plist 设置，现在可以从 applicationDidEnterBackground 登录。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T19:10:00.813

因此，您不希望应用程序在后台运行，但您想知道应用程序何时终止？做这个

```
UIApplication *app = [UIApplication sharedApplication];
[[NSNotificationCenter defaultCenter] addObserver:self
                                         selector:@selector(applicationWillTerminate:)
                                             name:UIApplicationWillTerminateNotification
                                            object:app]; 
```

然后填写你自己的 applicationWillTerminate 方法。你不会有太多时间做事。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T19:13:59.693

如果您已将 ApplicationDoesNotRunInBackgound 设置为 YES，那么这必须有效，

将此方法放入您的 appDelegate.m

```
-(void)applicationWillTerminate:(UIApplication *)application
{
    NSLog(@"user exits app");
} 
```

在我的应用程序中，使用相同的 plist 设置，此方法会触发

# nservicebus - 为什么我不能在 NServiceBus 中对自己进行 Bus.Reply()？

> ID：15143597
> 
> 赞同：0
> 
> 时间：2013-02-28T19:04:43.950
> 
> 标签：nservicebus

当我的端点`Bus.Reply()`向我发送一条使用 发送的消息时`Bus.SendLocal()`，我收到以下错误消息，导致消息失败：

```
2013-02-28 13:54:16,994 [Worker.15] WARN  NServiceBus.Unicast.Transport.Transact
ional.TransactionalTransport [(null)] <(null)> - Failed raising 'transport messa
ge received' event for message with ID=42e4b3ed-d0a2-4ab0-acfb-3531d8dafa3e\2056
7
NServiceBus.Unicast.Transport.TransportMessageHandlingFailedException: Exception
 of type 'NServiceBus.Unicast.Transport.TransportMessageHandlingFailedException'
 was thrown.
   at NServiceBus.Unicast.UnicastBus.HandleTransportMessage(IBuilder childBuilde
r, TransportMessage msg) in c:\BuildAgent\work\nsb.master_6\src\unicast\NService
Bus.Unicast\UnicastBus.cs:line 1331
   at NServiceBus.Unicast.UnicastBus.TransportMessageReceived(Object sender, Tra
nsportMessageReceivedEventArgs e) in c:\BuildAgent\work\nsb.master_6\src\unicast
\NServiceBus.Unicast\UnicastBus.cs:line 1248
   at System.EventHandler`1.Invoke(Object sender, TEventArgs e)
   at NServiceBus.Unicast.Transport.Transactional.TransactionalTransport.OnTrans
portMessageReceived(TransportMessage msg) in c:\BuildAgent\work\nsb.master_6\src
\impl\unicast\transport\NServiceBus.Unicast.Transport.Transactional\Transactiona
lTransport.cs:line 480 
```

这是我的配置：

```
 Configure
     .With(AllAssemblies.Except("evointernal.dll")) // This is a COM assembly and should not be scanned.
     .StructureMapBuilder(ObjectFactory.Container)
     .JsonSerializer()
     .UnicastBus().DoNotAutoSubscribe()
     .Sagas(); 
```

# javascript - 需要帮助理解 Javascript setinterval 和函数声明

> ID：15143599
> 
> 赞同：0
> 
> 时间：2013-02-28T19:04:49.610
> 
> 标签：javascript, jquery

我对 js 和 jquery 非常陌生，需要帮助理解为什么这个脚本不起作用。我已经检查了很多次，但在我所有的研究中，我都缺少一些东西。任何帮助，将不胜感激。代码应该每 2 秒在 div 中设置一次文本值。我把这段代码从它的真正功能中删掉了，所以忽略它什么都不做的事实。如果我没有正确发布此内容，请原谅并纠正我。这是我的第一篇文章。下面的代码：

```
<html>
  <head>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js" type="text/javascript">
    </script>
    <script type="text/javascript">
      var test=0;
      var timer = setInterval(save_it(), 2000);
      var test=0;
        $(document).ready(function(){
          var save_it = function(){
            testdiv.innerhtml = test++;
          };
        });
     </script>
  </head>
<body>
  <div id="testdiv"></div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T19:16:44.730

试试这个例子（jsFiddle [http://jsfiddle.net/Br59d/](http://jsfiddle.net/Br59d/)）

HTML：

```
<div id="testdiv"></div> 
```

javascript:

```
var test=0;

$(document).ready(function(){
    var timer = setInterval(save_it, 2000);
});

function save_it(){
    $('#testdiv').html(test.toString());
    test++;
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T19:24:21.977

提供一些输入：

```
var save_it = function() { 
```

和

```
function save_it() { 
```

采取两种不同的方式。如果您使用 var save_it = function() 您不能在声明之前调用该函数。

即你不能这样做：

```
save_it();
var save_it = function() {
    alert('k');
} 
```

但是，如果您使用函数 save_it() 就可以。

```
save_it();
function save_it() {
    alert('k');
} 
```

JSFiddle：http: [//jsfiddle.net/jeffshaver/nmSD6/](http://jsfiddle.net/jeffshaver/nmSD6/)

# javascript - 事件未在backbone.js 视图中触发

> ID：15143603
> 
> 赞同：3
> 
> 时间：2013-02-28T19:05:05.767
> 
> 标签：javascript, backbone.js

这是我对单行作为“tr”的看法。我想单击名称单元格并弹出该单元格的视图。我无法触发事件..

我错过了什么吗？谢谢！

所以这个问题由gumballhead解决，我遇到的问题是需要有一个与ItemRowView关联的tagName。然后在渲染函数中，我需要做 self.$el.html(this.template(model));

觉得分享一下可能会有帮助。。

```
 ItemRowView = Backbone.View.extend({

    initialize : function() {
    },
    template : _.template($('#item-row-template').html()),
    render : function() {       
        var self=this;        
        var model = this.model.toJSON();
        self.$el = this.template(model);
        return self.$el;
    },

    events : {
        "click td .item-name" : "viewOneItem"
             //Even if I change it to "click td":"viewOneItem", still not firing
    },
    viewOneItem : function() {
        console.log("click");
    }
}); 
```

收藏视图：

```
ItemsView = Backbone.View.extend({

    initialize : function() {
    },
    tagName : "tbody",

    render : function() {
        var self = this;
        this.collection.each(function(i) {
            var itemRowView = new ItemRowView({
                model : i
            });
            self.$el.append(itemRowView.render()); 
        });
        return self.$el;
    }

}); 
```

应用视图：AppView = Backbone.View.extend({ this.items = new Items();

```
 this.items.fetch();
  this.itemsView = new ItemsView({collection:this.items});    

  $('#items-tbody').html(itemsView.render());

}); 
```

对于模板：

```
<script type="text/template" id="item-row-template">
<tr>
    <td class="item-name">{{name}}</td>
    <td>{{description}}</td>
</tr>
</script>

 <table>
    <thead>
        <tr>
        <th>name</th>
        </tr>
    </thead>
    <tbody id="items-tbody">

    </tbody>
 </table> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-28T19:13:00.050

用于`"click td.item-name"`您的选择器。您当前正在侦听对 td 的后代的点击，该类为“item-name”。

仅供参考，您的模板中还有一个锚元素的结束标签，而没有开始标签。

编辑：我认为你想要 `self.$el.html(this.template(model));`而不是`self.$el = this.template(model);`

但是没有必要使用您发布的代码`this`来别名。`self`

编辑2：很高兴你把它整理好了。让我给你一个解释。

所有主干视图都需要一个根元素。这是事件哈希中的事件在实例化时委托给的元素。当在没有现有元素的情况下实例化主干视图时，它将根据配置设置创建一个，例如`tagName`，其默认值为`"div"`. 在您显式注入之前，该元素不会出现在 DOM 中。

因此，当您在 render 方法中设置 self.$el 时，您将覆盖根元素（以及事件，尽管它们永远不会触发，因为它会侦听对 td 的点击，该 td 是 div 的后代DOM 中不存在）。

作为旁注，在您的情况下这不是正确的方法，您可以`this.setElement($(this.template(model));`将事件从实例化时创建的 div 重新委托给原始模板创建的 tr 。

# ios - XCode Interface Builder 中的对象与外部对象

> ID：15143606
> 
> 赞同：8
> 
> 时间：2013-02-28T19:05:27.137
> 
> 标签：ios, xcode, interface-builder

IB中的对象和外部对象有什么区别？
我应该什么时候使用每个？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-18T14:18:03.713

添加到另一个答案：您可以使用“外部对象”来访问多个 xib 中的公共对象。您也可以通过其他方式执行此操作，但这会很方便。

例如，如果您对多个 xib 上的按钮单击执行“大”操作，并且如果您有许多此类操作（另外，如果您正在执行此操作的数据相同），而不是调用`addTarget:action...`，您可以创建此类的代理对象并将其连接到按钮。

您可以使用以下代码将代理对象连接到您的 xib：

```
 id *proxy = <someObject>; //The object you want to wire up
//In the below line of code use the same key as the identifier you give for the proxy object in the Interface Builder
 UINib *nib = [UINib nibWithNibName:@"ViewController" bundle:Nil];
NSDictionary *dict = [NSDictionary dictionaryWithObjectsAndKeys:proxyObject,@"proxy", nil];
NSDictionary *dict2 = [NSDictionary dictionaryWithObjectsAndKeys:dict,UINibExternalObjects, nil];
NSArray  *nibArray = [nib instantiateWithOwner:self options:dict2];
self.view = [nibArray objectAtIndex:0]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-28T19:09:52.047

对象实际上是嵌入在笔尖中的东西。

外部对象是加载 nib 的代码承诺在加载时提供的对象（我相信通过将键映射到外部对象的字典）。

除了文件所有者（已经为您提供）之外，大多数人从不使用任何外部对象。你几乎肯定只想要对象。

# c++ - 声纳 - 请求服务器版本失败

> ID：15143608
> 
> 赞同：2
> 
> 时间：2013-02-28T19:05:28.770
> 
> 标签：c++, sonarqube

我正在为 C++ 二进制文件设置声纳系统，我正在尝试使用 https 设置。

请参阅 Server.xml 中的连接器元素

```
 <Connector port="8443" protocol="org.apache.coyote.http11.Http11Protocol" SSLEnabled="true"
     maxThreads="150" scheme="https" secure="false"
     clientAuth="false" sslProtocol="TLS"
     keystoreFile="D:/sonar_framework/apache-tomcat-7.0.35/conf/.keystore" keystorePass="changeit"
     ciphers="SSL_RSA_WITH_RC4_128_MD5, SSL_RSA_WITH_RC4_128_SHA, TLS_RSA_WITH_AES_128_CBC_SHA, TLS_DHE_RSA_WITH_AES_128_CBC_SHA, TLS_DHE_DSS_WITH_AES_128_CBC_SHA, SSL_RSA_WITH_3DES_EDE_CBC_SHA, SSL_DHE_RSA_WITH_3DES_EDE_CBC_SHA,SSL_DHE_DSS_WITH_3DES_EDE_CBC_SHA"/> 
```

和 sonar.host.url= [https://b1.co:8443/sonar/](https://b1.co:8443/sonar/) 在 Sonar-runner.properties

我也给了本地主机以供下一次尝试，

但它显示了错误

```
Exception in thread "main" java.lang.IllegalStateException: Fail to request server version
        at org.sonar.runner.Bootstrapper.getServerVersion(Bootstrapper.java:73)
        at org.sonar.runner.Runner.checkSonarVersion(Runner.java:220)
        at org.sonar.runner.Runner.execute(Runner.java:150)
        at org.sonar.runner.Main.execute(Main.java:84)
        at org.sonar.runner.Main.main(Main.java:56)
Caused by: javax.net.ssl.SSLHandshakeException: java.security.cert.CertificateException: No name matching <machine Name> found
        at sun.security.ssl.Alerts.getSSLException(Alerts.java:192)
        at sun.security.ssl.SSLSocketImpl.fatal(SSLSocketImpl.java:1902)
        at sun.security.ssl.Handshaker.fatalSE(Handshaker.java:276)
        at sun.security.ssl.Handshaker.fatalSE(Handshaker.java:270)
        at sun.security.ssl.ClientHandshaker.serverCertificate(ClientHandshaker.java:1341)
        at sun.security.ssl.ClientHandshaker.processMessage(ClientHandshaker.java:153)
        at sun.security.ssl.Handshaker.processLoop(Handshaker.java:868)
        at sun.security.ssl.Handshaker.process_record(Handshaker.java:804)
        at sun.security.ssl.SSLSocketImpl.readRecord(SSLSocketImpl.java:1032)
        at sun.security.ssl.SSLSocketImpl.performInitialHandshake(SSLSocketImpl.java:1328)
        at sun.security.ssl.SSLSocketImpl.startHandshake(SSLSocketImpl.java:1355)
        at sun.security.ssl.SSLSocketImpl.startHandshake(SSLSocketImpl.java:1339)
        at sun.net.www.protocol.https.HttpsClient.afterConnect(HttpsClient.java:515)
        at sun.net.www.protocol.https.AbstractDelegateHttpsURLConnection.connect(AbstractDelegateHttpsURLConnection.java:185)
        at sun.net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLConnection.java:1299)
        at java.net.URLConnection.getContent(URLConnection.java:748)
        at sun.net.www.protocol.https.HttpsURLConnectionImpl.getContent(HttpsURLConnectionImpl.java:434)
        at org.sonar.runner.Bootstrapper.remoteContent(Bootstrapper.java:125)
        at org.sonar.runner.Bootstrapper.getServerVersion(Bootstrapper.java:71)
        ... 4 more
Caused by: java.security.cert.CertificateException: No name matching blrkmis1977pc.in002.siemens.net found
        at sun.security.util.HostnameChecker.matchDNS(HostnameChecker.java:208)
        at sun.security.util.HostnameChecker.match(HostnameChecker.java:93)
        at sun.security.ssl.X509TrustManagerImpl.checkIdentity(X509TrustManagerImpl.java:347)
        at sun.security.ssl.X509TrustManagerImpl.checkTrusted(X509TrustManagerImpl.java:203)
        at sun.security.ssl.X509TrustManagerImpl.checkServerTrusted(X509TrustManagerImpl.java:126)
        at sun.security.ssl.ClientHandshaker.serverCertificate(ClientHandshaker.java:1323)
        ... 18 more 
```

帮我解决这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T05:11:56.977

您需要告诉 Java 接受自签名证书。请参阅[此](https://stackoverflow.com/questions/2893819/telling-java-to-accept-self-signed-ssl-certificate)SO 帖子（已接受答案中的选项 1）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-04T07:44:40.233

我想你应该检查你的声纳服务器，在你的日志中，你的服务器正在使用端口 8443，所以你应该使用下面的命令来检查这个端口是否还在监听？网络统计-anl | grep 8443

或者

您只需重新启动声纳服务器。

# actionscript-3 - 在关闭应用程序之前做事的方法？

> ID：15143609
> 
> 赞同：2
> 
> 时间：2013-02-28T19:05:30.113
> 
> 标签：actionscript-3, apache-flex, actionscript, flex4

有没有办法在应用程序关闭之前执行某些操作？
例如，有人关闭了应用程序，但在它发生之前我必须向服务器发送一些数据......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T19:14:58.007

请说明是哪个平台！！！

对于浏览器，您必须使用 JavaScript onbeforeunload 事件和 Flash externalInterface。[这是一个如何链接！](http://sierakowski.eu/list-of-tips/74-flash-detecting-browser-window-close.html)

对于android，它看起来像这样！

```
if(Capabilities.cpuArchitecture=="ARM") // check if Android
{
    NativeApplication.nativeApplication.addEventListener(Event.ACTIVATE, handleActivate, false, 0, true);
    NativeApplication.nativeApplication.addEventListener(Event.DEACTIVATE, handleDeactivate, false, 0, true);
    NativeApplication.nativeApplication.addEventListener(KeyboardEvent.KEY_DOWN, handleKeys, false, 0, true);
}

private function handleActivate(event:Event):void
{
    // load your stuff again or whatever 
    NativeApplication.nativeApplication.systemIdleMode = SystemIdleMode.KEEP_AWAKE;
}

private function handleDeactivate(event:Event):void
{
    // Save your Stuff and do whatever!!!
    NativeApplication.nativeApplication.exit();
}

private function handleKeys(event:KeyboardEvent):void
{
    if(event.keyCode == Keyboard.BACK){
        // Save your Stuff and do whatever!!!
        NativeApplication.nativeApplication.exit();
    }
} 
```

# javascript - 在 onClick 中传递数据的替代方法？

> ID：15143610
> 
> 赞同：0
> 
> 时间：2013-02-28T19:05:31.233
> 
> 标签：javascript, jquery

我有一个网页，其中列出了来自某个服务器的所有数据库记录。每行旁边都有几个按钮，可让您重命名或删除记录。

```
INPUT( _value='Rename', _type="button", _class='appbutton', _onclick='renameApplication({0},"{1}")'.format(app.id,app.name)) 
```

这会产生类似的东西：

```
<input class="appbutton" type="button" value="Rename" onclick="renameApplication(3,"My Application")"></input> 
```

（后端模板引擎是 web2py，但这并不重要。）

我正在动态生成这些按钮。目前我通过 onClick 传递每个按钮所需的数据。

根据[jQuery.click() vs onClick](https://stackoverflow.com/questions/12627443/jquery-click-vs-onclick)我不应该再这样做了。但如果是这种情况，我应该如何传递数据，以便每个按钮单击都可以使用写入服务器端的动态数据（本例中的应用程序 ID 和名称。）

我不能通过记录进行 dom 遍历来获取数据，因为行结构可能会改变。

我不能使用自定义属性，因为我需要支持低于 HTML 5，而且我不会修改 doctype！（[我可以在 HTML 标签中添加自定义属性吗？](https://stackoverflow.com/questions/1735230/can-i-add-custom-attribute-to-html-tag)）

我唯一能想到的就是将数据放入 id 属性中然后解析它，但这似乎很骇人听闻。

有没有更好的办法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T19:14:10.270

您可以尝试使用[jQuery on](http://api.jquery.com/on/)将事件挂接到每个按钮上。您可以将服务器 ID 放在 jQuery 可以理解的数据属性中，而不会出现重大问题：

```
<input class="appbutton" type="button" value="Rename" data-id="3"></input> 
```

然后是js：

```
$('#container').on('click', '.appbutton', function () {
  var serverId = $(this).data('Id'); //this binds to html input
  renameApplication(serverId);
}); 
```

# javascript - 将活动状态添加到锚点？

> ID：15143611
> 
> 赞同：0
> 
> 时间：2013-02-28T19:05:37.740
> 
> 标签：javascript, jquery, html

我有一个简单的 2 链接切换，我正在尝试添加一个`active`类，以便我可以设置活动切换的样式。

HTML：

```
<div id="togglebuttons">
<span>Current Subscription</span>
<a href="#" class="member-button">Member</a>
<a href="#" class="trainer-button">Fitness Trainer</a>
</div> 
```

Javascript：

```
$(document).ready(function(){

$("#member").hide();
$("#fitness-trainer").hide();
$('.member-button').click(function(){

    $("#fitness-trainer").fadeOut(function() {$("#member").fadeIn();});
});
$('.trainer-button').click(function(){

    $("#member").fadeOut(function() {$("#fitness-trainer").fadeIn();});
});
}); 
```

我会在哪里添加这样的东西

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T19:23:04.747

我认为这就是你要找的：

```
$(document).ready(function(){    

$("#member").hide();
$("#fitness-trainer").hide();

$('.member-button').click(function () {
    $("#fitness-trainer").fadeOut(function () {
        $("#member").fadeIn();
    });
    $(".trainer-button").removeClass("active");
    $(this).addClass("active");
});

$('.trainer-button').click(function () {
    $("#member").fadeOut(function () {
        $("#fitness-trainer").fadeIn();
    });
    $(".member-button").removeClass("active");
    $(this).addClass("active");
});
}); 
```

# android-file - 从保存的电子邮件附件中读取 kml 文件

> ID：15143612
> 
> 赞同：0
> 
> 时间：2013-02-28T19:05:38.753
> 
> 标签：android-file

我在我的应用程序中设置了一个文件“导入 - 导出”过程（使用 gmail 客户端），允许用户在彼此之间甚至只是在设备之间共享 kml 文件。请阅读用户所经历的步骤以最好地理解。

归档过程：
1) 用户将地标添加到地图。
2) 用户使用用户定义的名称将 kml 格式的地标保存在 /sdcard 上（比如说“Saved.kml”）。
3) 用户通过 gmail 附件“导出”Saved.kml。

处理中的文件：
1) 用户将 gmail 附件保存到设备上的下载文件夹。
2) 用户选择“导入 KML”并从列表中选择 Saved.kml。
3）一切都很完美！地标出现在地图上，就像导出/预期的一样！

除了一个主要缺陷...这仅在您使用相同的设备进行导入/导出时才有效。我有两个设备；Nexus 7 和 LG Motion，它在其中任何一个上都运行良好。但我无法让它在两者之间发挥作用，我开始感到非常沮丧。这是我尝试过的：

清单更改：
android:sharedUserId="com.xxx.xxx"
android:sharedUserLabel="@string/sharedUserLabel"

Runtime.getRuntime().exec("chmod 444 Saved.kml"); //（需要支持Android 4级）

甚至在解析 Saved.kml 之前尝试过这个 -- importFileIn.renameTo(importFileOut); 并且文件被重命名但仍然无法解析。

adb shell 显示：-rw-rw-r-- root sdcard_rw 867 2013-02-28 10:39 Saved.kml -rw-rw-r-- root sdcard_rw 867 2013-02-28 11:44 SavedRenamed.kml

我使用了“adb push”，它在推送的文件上显示了完全相同的用户 ID/权限，但仍然无法加载。

当我发现这一点时，我正处于发布前的最后一分钟测试阶段。在同一台设备上进行测试从来没有一个问题......请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T19:40:23.323

对不起，伙计们，通过 Stack Overflow 提出这个问题让我输入了我一直在思考的所有内容，最终让我相信这不是文件权限问题。通过使用 Log.i，我打印出异常并发现这实际上是“找不到文件”错误。这当然是完全不同的事情！路径错误，问题解决！谢谢你对我的耐心。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T14:30:29.973

更具体地说，尝试提供帮助：
我正在从设备“下载”文件夹中的文件中提取数据。
在 Nexus 7 上，这是：“/storage/emulated/0/Download”。
在 LG Motion 上，这是：“/sdcard/Download”。
通过使用 "root.getAbsolutePath() + "/download" 我的问题得到了解决。

# linux - 从 Ubuntu 中的程序保存后文件所有权更改为 root

> ID：15143614
> 
> 赞同：1
> 
> 时间：2013-02-28T19:05:45.400
> 
> 标签：linux, ubuntu, webstorm

我有一个文件，所有者是我（userx）。我用程序 WebStorm.sh (sudo sh webstorm.sh) 打开了文件。当我保存文件时，文件的所有者更改为 root。

我不希望这个程序（webstorm）改变文件的所有者。有什么建议么？谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-28T19:08:05.723

这不是 webstorm，而是您以 root (sudo) 身份运行的事实。停止这样做，所有者信息不会改变。

# html - IE7自动设置内联样式高度

> ID：15143615
> 
> 赞同：1
> 
> 时间：2013-02-28T19:05:45.693
> 
> 标签：html, internet-explorer-7, inline-styles

这是我的交易：老板让我修复一个在 IE7 中无法正常显示的页面。

我正在使用最初设置为的 div 标签：

```
<div id="login_content" style="left: 0px; text-align: center;"> 
```

因此它在 Firefox、Chrome、Safari 和 IE9 中呈现。问题出现在 IE7 中——当 IE7 自动决定设置高度为 8px 的内联样式时，div 被切断了。

没有脚本可以修改它（正如我所说，它不会在其他现代浏览器中被触及）并且在使用 IE9 开发人员工具检查时，它不是从样式表继承的。有谁知道可能导致这种行为的原因？

![开发者工具中 IE7 渲染 div 的截屏](../Images/d4ea8cd45eaaef6f2c9f31a4e4e49c00.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T19:08:34.487

如果它通过外部脚本运行，则可能是其中的内联样式。如果您发布链接，我们可以使用检查工具。

您可以使用条件`<!--[if IE7] code to fix it [endif]-->`来更改它在 IE7 上的呈现方式。

# java - 如何使用java实现expect“interact”命令

> ID：15143619
> 
> 赞同：9
> 
> 时间：2013-02-28T19:05:53.790
> 
> 标签：java, unix, tcl, expect, expectj

我想使用 java 实现期望的“交互”命令。在预期中，可以打开一个 ssh 会话，进行身份验证，然后使用“interact”命令将控制权交还给用户。用java可以吗？我尝试过使用 expectJ、expect4J 和 expectForJava，但文档很少，几乎没有关于如何执行此操作的示例。TIA。

更新：对于“交互”命令参考，请查看：[http ://wiki.tcl.tk/3914](http://wiki.tcl.tk/3914)

> “Interact 是一个 Expect 命令，它将当前进程的控制权交给用户，以便将击键发送到当前进程，并返回当前进程的 stdout 和 stderr。”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-08-21T12:22:31.037

如果有人感兴趣，我已经为[ExpectIt](https://github.com/Alexey1Gavrilov/ExpectIt)添加了基本的交互式循环支持，我自己的开源 Expect 用于 Java 实现（对不起，自我推销），从 0.8 版开始。

下面是一个在 Java 8 中与系统输入流交互的[示例：](https://github.com/Alexey1Gavrilov/ExpectIt/blob/master/expect-java8/src/main/java/net/sf/expectit/java8/Java8Example.java)

```
 try (final Expect expect = new ExpectBuilder()
                .withInputs(System.in)
                .build()) {
            expect.interact()
                    .when(contains("abc")).then(r -> System.out.println("A"))
                    .when(contains("xyz")).then(r -> System.err.println("B"))
                    .until(contains("exit"));
            System.out.println("DONE!");
        }
        System.in.close(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-20T13:39:37.990

这些库可能更适合您的需求：

**SSHJ**

[https://github.com/shikhar/sshj](https://github.com/shikhar/sshj)

**JSCH**

[http://www.jcraft.com/jsch/](http://www.jcraft.com/jsch/)

# javascript - 做出选择后字段值更新停止

> ID：15143626
> 
> 赞同：0
> 
> 时间：2013-02-28T19:06:11.650
> 
> 标签：javascript, forms

我正在处理潜在客户表单，并且有一个烦人的错误，我似乎无法理解。

每次对某些字段进行更改时，都会更新隐藏字段以反映此更改。但是，如果您执行某些步骤，那么该字段将停止自我更新，我不知道。

JSfiddle 不适用于元素 javascript，所以这里有一个测试页面：（链接已删除）。

我已取消隐藏自动更新的字段，它位于`textarea`.

重现步骤：

*   选择美国作为原产国。
*   从“您要运送什么？”中选择任何选项 场地。
*   从“告诉我们更多”字段中选择“添加我自己的描述”。
*   编辑 textarea 并取消聚焦该字段以查看其下方的字段更新其内容。
*   现在，再次打开“告诉我们更多”下拉菜单，这次选择任何汽车品牌。
*   将出现一个“模型”下拉菜单，您可以从中选择或忽略以查看“隐藏”字段如何更新。
*   返回“告诉我们更多”字段，再次选择“添加我自己的描述”。
*   编辑 textarea 以发现隐藏字段不再自行更新。
*   您必须再次选择一个品牌，然后重新选择自己的描述以强制它更新对文本区域所做的任何更改。

我怎样才能阻止它破裂？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T19:24:55.553

你的错误在这一行`var strModel = model.options[model.selectedIndex].text;`

这是说它无法读取`text`未定义的属性。您可能需要在代码中的某处定义`model.selectedIndex`.

我在这里看到您正在定义事件`make`中的 's `onblur`：

```
info.onblur=function() {
    if (info.value=="") info.value=info.defaultValue;
    if (info.value!=info.defaultValue) {
        Show('quote_form_Make');
        BuildMakeSelect();
        make.selectedIndex = 2;
    }
} 
```

当我选择一个品牌时，模型菜单显示“模型”，结果如下：

```
document.getElementById('quote_form_Model').selectedIndex // 0 
```

当我选择“添加您自己的描述”时，结果如下：

```
document.getElementById('quote_form_Model').selectedIndex // -1 
```

这应该让你开始你的调试冒险。

# moq - 如何模拟通用抽象类

> ID：15143629
> 
> 赞同：4
> 
> 时间：2013-02-28T19:06:26.040
> 
> 标签：moq

假设我有一个接口 IReportBuilderService 和具体类 ReportBuilderService

```
e.g. public class ReportBuilderService : IReportBuilderService { } 
```

我可以开始用 Moq 模拟这项服务

```
Mock<IReportBuilderService> _reportBuilderServiceMock = new Mock<IReportBuilderService>(); 
```

并在模拟课上模拟期望等，没问题。

问题：如何模拟以下方法签名？

```
public abstract class ReportBuilder<TReport> where TReport : Report, new() 
```

其中 TReport 定义为

```
public class SomeReport : ReportBuilder<Report>, IMapper{} 
```

而报告类很简单

```
public class Report { } 
```

在抽象类 ReportBuilder 中有一系列 Property Get/Sets，我试图伪造/模拟这些值。

但是我无法开始对这个抽象类进行正确的模拟

希望这是有道理的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T07:33:39.567

鉴于您的抽象类如下所示：

```
public abstract class ReportBuilder<TReport> where TReport : Report, new() 
{
    public abstract Int32 SomeThing { get; set; }
} 
```

嘲笑它完全没有问题：

```
var m = new Mock<ReportBuilder<Report>>();
m.SetupProperty(r => r.SomeThing, 19); 
```

但请注意，您的所有属性都必须是`virtual`or `abstract`。

因此，如果不是这种情况（并且您不能或不想更改它），您可以`interface`从基类中提取一个并使用它（如果您愿意相应地更改代码），或者只是通过子类化创建存根/模拟：

```
public class StubReportBuilder : ReportBuilder<Report>
{
    public override Int32 SomeThing { get { return 42; } set { } }
} 
```

# c# - 如何选择单元格的值？

> ID：15143630
> 
> 赞同：4
> 
> 时间：2013-02-28T19:06:31.663
> 
> 标签：c#, winforms, datagridview

我有一个`DataGridView`，我想选择第一列的单元格。

这是我的`datagridview.Click`方法：

```
private void dataGridView1_CellClick(object sender, DataGridViewCellEventArgs e)
{
    name = dataGridView1.CurrentRow.Cells[0].Value.ToString();
} 
```

目前我的名字变量是`null`.

我究竟做错了什么？

![在此处输入图像描述](../Images/c8b1e60dacfde20ecf8e8fb7aceaceef.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T19:15:15.237

CurrentRow 可能尚未设置，因此请使用 RowIndex 属性作为事件参数。试试这种方式：

```
void dataGridView1_CellClick(object sender, DataGridViewCellEventArgs e) {
  if (e.RowIndex > -1 && dataGridView1.Rows[e.RowIndex].Cells[0].Value != null) {
    name = dataGridView1.Rows[e.RowIndex].Cells[0].Value.ToString();
  }
} 
```

以防万一，请确保事件已连接：

```
public Form1() {
  InitializeComponent();
  dataGridView1.CellClick += dataGridView1_CellClick;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T19:34:52.280

你可以这样做：

```
 private void dataGridView1_CellClick(object sender, DataGridViewCellEventArgs e)
    {
      var view = (sender as DataGridView); //<-- notes this
      var currentCellString = view.CurrentCell.Value.ToString();
    } 
```

有时您需要`sender`在使用时抓取对象 - 因为它总是会更新。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-28T19:22:44.957

```
private void dataGridView1_CellClick(object sender, DataGridViewCellEventArgs e)
{
    object name = dataGridView1.Rows[e.RowIndex].Cells[0].Value;
    MessageBox.Show(name.ToString() == string.Empty ? "myvalue" : name.ToString());
} 
```

# iphone - ios - 查找一周内即将到来的生日

> ID：15143633
> 
> 赞同：1
> 
> 时间：2013-02-28T19:06:39.440
> 
> 标签：iphone, ios, objective-c, cocoa

我试图在 iOS 上找到一周内即将到来的生日。我从 Facebook 中提取了生日数据并修剪了年份部分（因为根据用户的隐私设置，某些用户可能无法使用它）因此生日数据是`NSString`带日期格式的`@"MM/dd"`

```
NSDateFormatter *dateFormatter = [[NSDateFormatter dateFormatterWithFormat:@"MM/dd"] retain];
NSDate *today = [NSDate date];
NSDateComponents *todayComponents = [dateFormatter.calendar components:NSYearCalendarUnit | NSMonthCalendarUnit | NSDayCalendarUnit
                                                              fromDate:today];
todayComponents.hour = 13;
todayComponents.minute = 0;
todayComponents.second = 0;
today = [dateFormatter.calendar dateFromComponents:todayComponents];

[facebookFriends enumerateObjectsUsingBlock:^(NSDictionary *friend,
                                              NSUInteger idx,
                                              BOOL *stop) {

    NSDate *birthday = [dateFormatter dateFromString:[friend objectForKey:@"birthday"]];
    NSDateComponents *birthdayComponents = [dateFormatter.calendar components:NSMonthCalendarUnit | NSDayCalendarUnit
                                                                     fromDate:birthday];
    birthdayComponents.year = todayComponents.year;
    birthdayComponents.hour = todayComponents.hour;
    birthdayComponents.minute = todayComponents.minute;
    birthdayComponents.second = todayComponents.second;

    birthday = [dateFormatter.calendar dateFromComponents:birthdayComponents];
    NSDateComponents *difference = [dateFormatter.calendar components:NSDayCalendarUnit
                                                             fromDate:today
                                                               toDate:birthday
                                                              options:0];
    if (difference.day >= 0 &&
        difference.day < 7) { // 7 days in a week
        [birthdaysToShow[difference.day] addObject:friend];
    }
}];
[dateFormatter release]; 
```

上`dateFormatterWithFormat:`的类别在哪里`NSDateFormatter`：

```
+ (NSDateFormatter *)dateFormatterWithFormat:(NSString *)formatString
{
    NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
    NSCalendar *calendar = [[[NSCalendar alloc] initWithCalendarIdentifier:NSGregorianCalendar] autorelease];
    dateFormatter.calendar = calendar;
    dateFormatter.dateFormat = formatString;
    dateFormatter.timeZone = [NSTimeZone timeZoneWithAbbreviation:@"GMT"];

    return [dateFormatter autorelease];
} 
```

这里有2个问题：

1-我在这段代码中有一个错误，如果距离新年不到一周，我将无法显示新年的生日，因为我将生日的年份设置为当年和`difference.day`新年的生日将远小于 0。我该如何解决这个问题？

2- 正如你从上面的代码片段中看到的那样，我做了很多跳舞：首先我得到今天的日期和时间`[NSDate date]`，然后我把它撕成它的组件并将它组装回一个`NSDate`中午的时间而不是当前的时间时间。我这样做的原因是如果`[NSDate date]`返回一个时间是 23:00:00 的日期，并且如果生日时间是 00:00:00（1 小时后，意味着生日是明天），那么`difference.day`等于`0`而不是想要的`1`。我在上面的代码片段中所做的是正确的方法吗？我想我可能为看似如此简单的事情做了太多的工作，你将如何解决这种安排，这样我就不必将组件分割成组件`today`并将`birthday`它们放回`NSDate`?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T19:52:12.797

为每个生日组件对象设置正确的年份：

```
birthdayComponents.year=todayComponents.year; //default

if(birthdayComponents.month< todayComponents.month) birthdayComponents.year=todayComponents.year+1; //their next birthday is next year.

if(birthdayComponents.month==todayComponents.month && birthdayComponents.day<todayComponents.day) birthdayComponents.year=todayComponents.year+1; //their next birthday is next year 
```

# android - Android ActivityManager.RunningTaskInfo 如何获取Task全名

> ID：15143634
> 
> 赞同：2
> 
> 时间：2013-02-28T19:06:40.267
> 
> 标签：android

我有财产`ActivityManager.RunningTaskInfo taskinfo`

现在我可以变得`ClassName`像`taskinfo.baseActivity.getClassName()`

但我能以某种方式将其转换为`ApplicationInfo`.

为什么？我想获得像 Opera, Youtube,.. 这样的任务名称，而不仅仅是类名

这可能吗？

# c# - c#中的多线程和打开文件

> ID：15143638
> 
> 赞同：0
> 
> 时间：2013-02-28T19:06:59.250
> 
> 标签：c#, multithreading, image, file, video-capture

我想要 2 个线程打开 1 个文件，然后执行一些进程。详细地说，我的文件是 .avi 视频，我从文件中提取帧。我用 1 个线程提取奇数帧，用另一个线程提取偶数帧。

这是我的代码的重要部分：

```
Capture video = new Capture("c:\\5.avi");
Image<Bgr, Byte> Imageframe;
Imageframe = video.QueryFrame(); 
```

但是，当第二个线程工作并打开同一个文件（ 5.avi ），甚至是另一个文件时，它会给我这个消息（无法从 c:\5.avi 创建捕获）请告诉我该怎么做，我线程编程新手

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T19:09:13.213

我建议让一个线程（仅）读取文件，并为两个工作线程提供框架。不一定是唯一的方法，但会产生更清晰的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T19:09:14.807

听起来您只能运行一个“捕获”进程。

# php - 突出显示非字母数字字符的单词

> ID：15143641
> 
> 赞同：0
> 
> 时间：2013-02-28T19:07:09.237
> 
> 标签：php, regex, utf-8, preg-replace

这段代码

```
$text = 'xxx AA BB xxx xäxAAx xBBBxóx ';
$words = array('AA BB', 'AA','BB');
$text = preg_replace('/(\w*('.implode("|",$words).')\w*)/i', '[b]$1[/b]', $text); 
```

返回

```
xxx [b]AA BB[/b] xxx xä[b]xAAx[/b] [b]xBBBx[/b]óx 
```

如何修改接收

```
xxx [b]AA BB[/b] xxx [b]xäxAAx[/b] [b]xBBBxóx[/b] 
```

问题在于非字母数字字符，文件在 utf-8 中，文本来自 utf-8 中的 mysql

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T21:13:27.217

`\w`在 php 中仅基于 ASCII。将此替换为 Unicode 字符属性`\p{L}`，它将起作用。

```
 $text = preg_replace('/(\p{L}*('.implode("|",$words).')\p{L}*)/ui', '[b]$1[/b]', $text); 
```

`\p{L}`是一个[Unicode 字符属性](http://www.regular-expressions.info/unicode.html#prop)，匹配来自任何语言的任何类型的字母

`\w`还包含数字，如果你想要这个，你需要像这样创建自己的字符类：

```
[\p{L}\d] 
```

这将匹配字母和数字。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T21:10:31.320

您必须在模式正则表达式的末尾添加修饰符`u`

```
$text3 = preg_replace('/(\w*('.implode("|",$words).')\w*)/iu', '[b]$1[/b]', $text); 
```

并得到：

```
xxx [b]AA BB[/b] xxx [b]xäxAAx[/b] [b]xBBBxóx[/b] 
```

[你可以在这里](http://www.php.net/manual/en/reference.pcre.pattern.modifiers.php)看到模式修饰符

# java - label.setVisible(true) 在过程完成之前什么都不做

> ID：15143642
> 
> 赞同：2
> 
> 时间：2013-02-28T19:07:11.180
> 
> 标签：java, swing, swingworker, event-dispatch-thread

我有一个包含几个按钮的对话框。单击特定按钮时，它的 ActionListener 会启动一个需要几秒钟才能完成的过程。在此期间，我想向用户提供一些反馈。采取一种简单的方法，我在“计算...”对话框中有一个标签，该标签最初是不可见的。代码段如下所示

```
button_OpenHoursReport.addActionListener(new ActionListener() {
    public void actionPerformed(ActionEvent arg0) {
        lbl_Computing.setVisible(true);
        new runAndRenderReport();
        RunAndRenderReport.main(null);
        lbl_Computing.setVisible(false);
    }
}); 
```

问题是，在 RunAndRenderReport 完成之前，lbl_Computing 文本不会变得可见。显然，这对用户没有多大帮助。不知道从这里去哪里。这与线程有关吗？如果是这样，我可以使用一些关于如何开始的指导。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-28T19:10:06.477

`actionPerformed()`在 GUI 线程 ( [EDT](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/dispatch.html) ) 上执行，因此请避免对其执行密集操作。而是使用[SwingWorker](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/worker.html)。

请参阅[SwingWorker 的工作原理](https://stackoverflow.com/a/11546203/597657)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T19:21:36.403

一个比使用 SwingWorker 更容易的技巧是在调用 setVisible(true) 之后在标签上调用[paintImmediately 。](http://docs.oracle.com/javase/7/docs/api/javax/swing/JComponent.html#paintImmediately%28int,%20int,%20int,%20int%29)您应该立即看到效果。

```
lbl_Computing.paintImmediately(0, 0, lbl_Computing.getWidth(), lbl_Computing.getHeight()); 
```

但是，如果您希望 GUI 在报告运行时也以其他方式响应，则 SwingWorker 是您的最佳选择。

# android - Google Maps V2 连接问题

> ID：15143645
> 
> 赞同：4
> 
> 时间：2013-02-28T19:07:14.660
> 
> 标签：android, google-maps, broadcastreceiver

我收到了一些崩溃报告，我不确定是什么原因造成的。

仅在最近的更新中才开始发生这种情况。这可能意味着它之前没有发生过或者我介绍过它。唯一与网络有关的事情是在 Android Manifest 中注册一个检查网络的权限。

无论如何，我希望你能指出我的方向。这是崩溃报告。

```
java.lang.RuntimeException: Error receiving broadcast Intent { act=android.net.conn.CONNECTIVITY_CHANGE flg=0x10000000 (has extras) } in maps.z.bz@405d7d40
at android.app.LoadedApk$ReceiverDispatcher$Args.run(LoadedApk.java:722)
at android.os.Handler.handleCallback(Handler.java:587)
at android.os.Handler.dispatchMessage(Handler.java:92)
at android.os.Looper.loop(Looper.java:123)
at android.app.ActivityThread.main(ActivityThread.java:3691)
at java.lang.reflect.Method.invokeNative(Native Method)
at java.lang.reflect.Method.invoke(Method.java:507)
at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:847)
at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:605)
at dalvik.system.NativeStart.main(Native Method)
Caused by: java.lang.IllegalArgumentException: Receiver not registered: maps.z.bz@405d7d40
at android.app.LoadedApk.forgetReceiverDispatcher(LoadedApk.java:610)
at android.app.ContextImpl.unregisterReceiver(ContextImpl.java:853)
at android.content.ContextWrapper.unregisterReceiver(ContextWrapper.java:331)
at maps.z.bz.onReceive(Unknown Source)
at android.app.LoadedApk$ReceiverDispatcher$Args.run(LoadedApk.java:709)
... 9 more 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T10:53:58.743

如果您将 Maps V2 api 与旧版（修订版 4）库和新版（3.0.25）Google Play 服务一起使用，则会发生这种情况。

谷歌似乎打破了向后兼容性，所以如果人们升级他们的谷歌播放服务，使用旧库发布的应用程序将会被破坏。

此时您有两种可能性：

1.  发布您的应用程序的新版本并更新到新库
2.  恢复到旧地图

我提出了一张票，谷歌已经承认了：

[http://code.google.com/p/gmaps-api-issues/issues/detail?id=5025&thanks=5025&ts=1362047877](http://code.google.com/p/gmaps-api-issues/issues/detail?id=5025&thanks=5025&ts=1362047877)

请给它加星标以从 Google 获得更高的优先级。

# css - IE9 无法正确显示，我的 html 标头是否正确？

> ID：15143650
> 
> 赞同：0
> 
> 时间：2013-02-28T19:07:21.293
> 
> 标签：css, header, internet-explorer-9

我问这个是因为我不知道为什么在 IE9 中我的网站看起来像这样：

![在此处输入图像描述](../Images/d9c7af6ff283a7a5c391c9fa09bd8db2.png)

另一个浏览器正确显示：

![在此处输入图像描述](../Images/12321bdbb5d06bed735b09acb3d7473c.png)

我假设这是由于头文件中的位置不佳，但并非完全如此，这是我项目的最后一部分，它在 IE9 中看起来不错。

**我的 index.php 的一般结构**

```
<!DOCTYPE html>
<html lang="es">
<head>
    <?php include 'configHead.php' ?>
    <title>Panel de Servicio</title>
</head>
<body>
.......
</body> 
```

**配置头文件**

```
<meta charset="utf-8">
<link rel="shortcut icon" href="media/favicon.png" />
<script src="js/prefixfree.min.js" type="text/javascript"></script>
<link href='http://fonts.googleapis.com/css?family=Open+Sans:300' rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="css/style.css" type="text/css"/>
<link rel="stylesheet" href="css/jquery-ui-1.9.2.custom.css" type="text/css"/>
<link rel="stylesheet" href="css/jquery.dataTables.css" type="text/css"/>

<script src="js/jquery-1.8.3.js" type="text/javascript"></script>
<script src="js/jquery-ui-1.9.2.custom.js" type="text/javascript"></script>
<script src="js/jquery-ui-timepicker-addon.js" type="text/javascript"></script>
<script src="js/functions.js" type="text/javascript"></script>
<script src="js/jquery.dataTables.js" type="text/javascript"></script> 
```

有人知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T19:12:05.693

您不能有**任何**评论或任何文字`<!DOCTYPE html>`...删除顶部的评论，您的网站将在 IE 中正常工作..它目前触发您的页面进入怪癖模式（大致相当于 IE5）.. 到目前为止就 IE 而言，您没有文档类型。

现在你有这样的评论：

```
<!--Aplicación: Sistema de tickets y pólizas.
Cliente: MA Consulting.
Desarrollador: XXX XXX XXX
Twitter: @_xxx
Email: xxx@gmail.com
Fecha: Julio/2012 - Febrero/2013
-->

<!DOCTYPE html> 
```

在您的文档类型之前 ..**在之后移动该评论** `<!DOCTYPE html>`

# c# - 验证用户凭据

> ID：15143658
> 
> 赞同：1
> 
> 时间：2013-02-28T19:07:38.740
> 
> 标签：c#, windows-security

我有一个独特的困境。

我正在开发一个测试用户帐户权限的类，我已经涵盖了大部分基础。但我最关心的是针对`Null`或测试一个`SID`.

我担心的原因是：

```
if(user != null)
{
   role.IsInRole(WindowsBuiltInRole.Administrator);
} 
```

显然是一个简单的实现来演示，但是`WindowsBuiltInRole`检查会严格基于单个机器还是针对域？如果用户域帐户确实是管理员，它会成功测试吗？

或者测试五个或六个域`SID`令牌的更好方法是什么？其他用户帐户（例如*网络服务帐户*）是否会以相同的方式进行操作？确保令牌价值真实性的最佳方法是什么。

任何输入都会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T19:40:09.603

根据在以下位置找到的 WindowsBuiltInRole 枚举的定义：

[WindowsBuiltInRole 枚举](http://msdn.microsoft.com/en-us/library/system.security.principal.windowsbuiltinrole.aspx)

WindowsBuiltInRole.Administrator 角色确实适用于计算机和域，没有限制。

WindowsBuiltInRole.PowerUser 将能够运行应用程序，但不能安装或卸载东西。

WindowsBuiltInRole.AccountAdministrator 可以管理帐户甚至更改权限，但不能进行域范围的更改（如在分布式部署中）。

WindowsBuiltInRole.BackupOperator 可以仅出于备份或还原文件的目的而覆盖安全限制。

WindowsBuiltInRole.Replicator 支持域中的文件复制。

这些不同的角色可能看起来很模糊，但可以推断出除了管理员之外的所有人都可以执行一些管理员任务，但不是全部。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-30T08:33:16.930

[WindowsBuiltInRole 枚举与 Windows SID](http://en.wikipedia.org/wiki/Security_Identifier)完全对应，并且与与**Windows 内置组**关联的众所周知的 SIDS完全对应：[Windows 操作系统中的知名安全标识符](http://support.microsoft.com/kb/243330/en-us)，所有 SID 都以“S-1-5-32-”开头.

枚举值的整数值对应的是sid中的最后一个数字，所以，因为WindowsBuiltInRole.Administrator是544，所以对应的是S-1-5-32-544。因此，您使用此代码检查的内容实际上是用户是否属于管理员组：

> SID：S-1-5-32-544
> 
> 姓名：管理员
> 
> 描述：内置组。操作系统初始安装后，该组的唯一成员是管理员帐户。当计算机加入域时，域管理员组将添加到管理员组。当服务器成为域控制器时，Enterprise Admins 组也被添加到 Administrators 组中。

# c# - 如何检查gridview中的复选框是否被选中

> ID：15143660
> 
> 赞同：2
> 
> 时间：2013-02-28T19:07:46.897
> 
> 标签：c#, gridview, checkbox, grid, devexpress

我有一个 devexpress gridview，其中一列是一个复选框。我想检查是否在焦点行中选中了该列中的复选框，如果是，则执行一些操作。我应该如何检查复选框是否被选中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T09:12:23.783

```
 bool value = (bool) gridView.GetRowCellValue(gridView.FocusedRowHandle, column); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T12:00:29.050

```
DataRow[] rows = new DataRow[gvExcelSheet.RowCount];
                for (int j = 0; j < gvExcelSheet.RowCount; j++)
                {
                    rows[j] = gvExcelSheet.GetDataRow(j);
                    if ((bool)rows[j]["yourcheckboxcolumnname"] == true)
                    {
                        //your code
                    }
                } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T11:12:10.447

如果您使用的是 DataBinding，这非常容易。例如：

```
public class MyClass(){
   public MyClass(){

   }

   public bool IsTrue
   {
     get{;}
     set{;}
   }
}

List<MyClass> manyMyClassObjects = new List<MyClass>();
//Add some values for sure

GridControl.DataSource = manyMyClassObjects; 
```

现在 IsTrue 属性已绑定到 Grid。GridView 只显示底层数据。如果您更改 Grid 中的值，它会更改 DataSource 对象的值。这将适用于任何实现了 setter 的 Property。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-18T12:52:03.803

简单如下：

```
bool value = Convert.ToBoolean(gvMain.SelectedRowsCount); 
```

# c# - 在c#中将所有值设置为一个变量

> ID：15143664
> 
> 赞同：0
> 
> 时间：2013-02-28T19:07:59.977
> 
> 标签：c#, variables, request, assign

我有一个 foreach 语句，将客户 ID 列表输出到日志文件：

```
foreach(var customer in _response.CustomersList)
{
      log.WriteLine(customer.CustID);
} 
```

Id 的输出正确，但我遇到的问题是我无法将它们放入一个变量中使用它们。

例如我想提出这个要求：`_request2.CustID = customer.CustID`但这是不正确的。

我需要这些 ID，因为我有一个取消客户请求：

```
 public void Cancel()
            {
                _request2 = new CancelCust();
                _request2.CommandUser = _request.CommandUser;      
                _request2.CustID = "This is where I would put the variable that holds the customer ID's"         
                _request2.Company = _request.Company;      
            } 
```

那么，如何将这些 id 分配给稍后在我的请求中使用的变量？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T19:16:38.217

我不完全清楚你想用上面的代码完成什么。但是，您可以使用一些[`LINQ`](http://msdn.microsoft.com/en-us/library/vstudio/bb397926.aspx)并获取 ID 列表，然后根据需要传递该列表：

```
var customerIDs = _response.CustomersList.Select(customer => customer.CustID); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T19:17:58.563

您可以随时存储所有客户 ID：

```
var customerIds = new List<int>();
foreach (var customer in _response.CustomersList)
{
    customerIds.Add(customer.CustId);
    log.WriteLine(customer.CustID);
} 
```

或通过使用 LINQ

```
var customerIds = _response.CustomersList.Select(c => c.CustId); 
```

正如我在评论中指出的那样，如果属性 Request.CustId 不是一个集合，这将无助于您一次请求所有这些。你能改变请求的定义吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T19:13:24.350

听起来您的变量`_request2.CustID`类型错误。你从编译器得到什么错误信息？（或者，您得到的是运行时错误吗？）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-28T19:19:16.213

像这样的东西？

```
public void Cancel()
{
    foreach(var customer in _response.CustomersList)
    {
        _request2 = new CancelCust();
        _request2.CommandUser = _request.CommandUser;      
        _request2.CustID = customer.CustID;         
        _request2.Company = _request.Company;      
    }
} 
```

# c++ - 如何在二进制文件上使用 fread() 将数据读入 std::vector？

> ID：15143670
> 
> 赞同：4
> 
> 时间：2013-02-28T19:08:13.987
> 
> 标签：c++, arrays, vector, ifstream, fread

[关于我之前的一个问题](https://stackoverflow.com/questions/15136992/why-does-my-program-crash-when-using-fread-in-the-constructor)的后续问题，已经得到了完美的回答。快速回顾一下，我在创建一个包含巨大数组的类时遇到了麻烦（堆栈溢出错误）。在答案中，一些用户建议我改用 std::vector 。

读取数据的函数如下所示：

```
Test()
{
   memset(myarray, 0, sizeof(myarray));
   FILE* fstr = fopen("myfile.dat", "rb");
   size_t success= fread(myarray, sizeof(myarray), 1, fstr);
   fclose(fstr);
} 
```

对于一个看起来像这样的 myarray：

```
int myarray[45000000]; 
```

我的问题是：我怎样才能把它读成一个更可取的：

```
std::vector<int> myvector; 
```

我搜索了谷歌，找到了多个答案，通常指向以下代码：

```
std::ifstream input("myfile.dat", std::ios::in | std::ifstream::binary);
std::copy(std::istream_iterator<int>(input), 
     std::istream_iterator<int>(), 
     std::back_inserter(myvector)); 
```

在实现这个之后，当调用 myvector.size() 时，我得到 16（无论出于何种原因），并且访问向量元素会导致超出向量边界的立即崩溃。

那么我该怎么做才能做到这一点呢？我曾经在某处读到我可以简单地使用“旧”方法，然后将数组读入向量，但这似乎违背了首先使用向量的目的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-28T19:11:12.347

`fread()`读取您的文件*binary*，同时`ifstream_iterator`尝试提取*格式化的*整数（如`42`）。

你想要`resize`你的`vector`并使用[`input.read(...)`](http://en.cppreference.com/w/cpp/io/basic_istream/read)：

```
const size_t size = 45000000; // change this to the appropriate value
std::vector<char> myvector(size, 0);
std::ifstream input("myfile.dat", std::ios::in | std::ifstream::binary);
input.read(&myvector[0], myvector.size()); 
```

请注意，您需要使用 a`std::vector<char>`因为`read`期望第一个参数是 a `char *`。`T`如果正确转换类型，则可以使用其他类型：

```
input.read(reinterpret_cast<char*>(&myvector[0]), myvector.size() * sizeof(T)); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-28T19:17:06.580

如果您使用 C++，您应该尽量避免同时使用 C `FILE`API——这样您就走在了正确的轨道上。您遇到的问题是`istream_iterator`将输入读取为文本，而不是二进制 - 它需要 ASCII 数字。这不是：

```
std::vector<int> vec(45000000);

std::filebuf fb;
fb.open("myfile.dat", std::ios_base::in | std::ios_base::binary);
fb.sgetn((char*)&vec[0], vec.size() * sizeof(vec[0])); 
```

# javascript - 未捕获的 ReferenceError：使用 FB.getLoginStatus 时未定义 FB

> ID：15143671
> 
> 赞同：33
> 
> 时间：2013-02-28T19:08:14.417
> 
> 标签：javascript, facebook, facebook-login

我正在尝试检查用户是否已使用 facebook 登录并在 JS 控制台中收到该错误。我的代码如下所示：

```
<div id="fb-root"></div>
<script>
    window.fbAsyncInit = function () {
        FB.init({
            appId: '######', // App ID
            status: true, // check login status
            cookie: true, // enable cookies to allow the server to access the session
            xfbml: true  // parse XFBML
        });
    };

    // Load the SDK Asynchronously
    (function (d) {
        var js, id = 'facebook-jssdk'; if (d.getElementById(id)) { return; }
        js = d.createElement('script'); js.id = id; js.async = true;
        js.src = "//connect.facebook.net/en_US/all.js";
        d.getElementsByTagName('head')[0].appendChild(js);
    }(document));

    FB.getLoginStatus(function (response) {
        if (response.status === 'connected') {
            // the user is logged in and has authenticated your
            // app, and response.authResponse supplies
            // the user's ID, a valid access token, a signed
            // request, and the time the access token
            // and signed request each expire
            var uid = response.authResponse.userID;
            var accessToken = response.authResponse.accessToken;
        } else if (response.status === 'not_authorized') {
            // the user is logged in to Facebook,
            // but has not authenticated your app
        } else {
            // the user isn't logged in to Facebook.
        }
    });
</script> 
```

可能是什么问题，对于如何解决它有什么建议吗？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2013-04-12T21:34:46.623

在 Chrome 中，您会收到错误消息：*Uncaught ReferenceError: FB is not defined*。

我喜欢在 Facebook 的初始化函数*fbAsyncInit()*中触发自定义事件。然后我不限于在 fbAsyncInit 函数中执行所有与 FB 相关的脚本。我可以把它放在任何地方，只需监听要触发的自定义事件。

```
window.fbAsyncInit = function() {
    FB.init({
        appId      : '123456789',
        status     : true,
        cookie     : true,
        xfbml      : true  
    });

    $(document).trigger('fbload');  //  <---- THIS RIGHT HERE TRIGGERS A CUSTOM EVENT CALLED 'fbload'
};

//MEANWHILE IN $(document).ready()
$(document).on(
    'fbload',  //  <---- HERE'S OUR CUSTOM EVENT BEING LISTENED FOR
    function(){
        //some code that requires the FB object
        //such as...
        FB.getLoginStatus(function(res){
            if( res.status == "connected" ){
                FB.api('/me', function(fbUser) {
                    console.log("Open the pod bay doors, " + fbUser.name + ".");
                });
            }
        });

    }
); 
```

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2013-02-28T19:48:56.717

您在加载和/或初始化 SDK 之前调用 FB.getLoginStatus。等待它，这就是 fbAsyncInit 事件的用途。所以把方法调用放在那里。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2015-03-13T14:36:15.017

我使用了以下简单的方法，它可以正常工作：

在`head`我加载 SDK 的部分中：

```
<script type="text/javascript" src="//connect.facebook.net/en_US/sdk.js"></script> 
```

然后在`body`您的实际内容所在的页面中，我使用了这个：

```
<script>

  function statusChangeCallback(response) {
    console.log('statusChangeCallback');
    console.log(response);
    if (response.status === 'connected') {
      testAPI();

    } else if (response.status === 'not_authorized') {
      FB.login(function(response) {
        statusChangeCallback2(response);
      }, {scope: 'public_profile,email'});

    } else {
      alert("not connected, not logged into facebook, we don't know");
    }
  }

  function statusChangeCallback2(response) {
    console.log('statusChangeCallback2');
    console.log(response);
    if (response.status === 'connected') {
      testAPI();

    } else if (response.status === 'not_authorized') {
      console.log('still not authorized!');

    } else {
      alert("not connected, not logged into facebook, we don't know");
    }
  }

  function checkLoginState() {
    FB.getLoginStatus(function(response) {
      statusChangeCallback(response);
    });
  }

  function testAPI() {
    console.log('Welcome!  Fetching your information.... ');
    FB.api('/me', function(response) {
      console.log('Successful login for: ' + response.name);
      document.getElementById('status').innerHTML =
        'Thanks for logging in, ' + response.name + '!';
    });
  }

  $(document).ready(function() {
    FB.init({
      appId      : '1119999988888898981989819891',
      xfbml      : true,
      version    : 'v2.2'
    });
    checkLoginState();
  });
</script> 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-10-13T14:22:29.693

只需在标签中直接使用带有 facbook sdk 的脚本

```
 <script type="text/javascript" src="//connect.facebook.net/en_US/all.js#xfbml=1&appId=YOUR_APP_ID" id="facebook-jssdk"></script> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-12-15T07:50:26.223

我们面临同样的问题，并且由于 FB sdk 没有加载（或加载延迟），这在某些情况下会导致问题（或破坏 javascript），这取决于它。

为了解决这个问题，我们委托了所有与 facebook 相关的调用。我们创建了一个类似的函数：

```
function callOnFBSDKLoad(callback){
    if (window.isFBInitialized) {
        callback();
    }
    else {
        jQuery(document).bind('fbInitialized', callback);
    }
} 
```

自定义事件在哪里`fbInitialized`可以在此处了解有关自定义事件的更多信息[。](https://learn.jquery.com/events/introduction-to-custom-events/) 并且`window.isFBInitialized`是加载 SDK 时设置的变量。

callback 是封装 FB 相关事件的方法。例如

```
var FBLogin = function(){
   FB.login(...);
}

callOnFBSDKLoad(FBLogin) 
```

PS：请忽略语法和命名约定，我基本上是在分享解决此类问题的想法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-06-24T18:52:02.423

一个更简单和可靠的解决方案。SDK 加载时调用函数。我会命名它`triggerLoginCheck()`。

```
<script>
  window.fbAsyncInit = function() {
    FB.init({
      //TO DO: Add your unique Facebook app ID (All numbers).
      appId      : '***unique_app_id***',
      cookie     : true,
      xfbml      : true,
      version    : 'v2.8'
    });
    //Call the function here
    triggerLoginCheck();

    FB.AppEvents.logPageView();   
  };

  (function(d, s, id){
     var js, fjs = d.getElementsByTagName(s)[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement(s); js.id = id;
     js.src = "//connect.facebook.net/en_US/sdk.js";
     fjs.parentNode.insertBefore(js, fjs);
   }(document, 'script', 'facebook-jssdk'));
</script> 
```

稍后，在任何地方，放置这个：

```
function triggerLoginCheck() {       
       FB.getLoginStatus(function(response) {
       statusChangeCallback(response);
       console.log(response);  
       });
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-09-05T21:13:51.950

这对我来说很好。必须包括对象“Log.info.bind”。

```
var Log = { info: { bind: function(){ alert('Hi'); 测试API(); } } }
```

# ektron - 将 Ektron smartform 嵌入另一个 Ektron smartform

> ID：15143674
> 
> 赞同：0
> 
> 时间：2013-02-28T19:08:36.873
> 
> 标签：ektron

（使用 Ektron 版本 8.6.1）

假设我有一个 smartform `ContactInfo`，例如：

```
<ContactInfo>
    <Name></Name>
    <Email></Email>
</ContactInfo> 
```

我想创建另一个智能表单（例如）并在里面`NewsArticle`“嵌入”`ContactInfo`

```
<NewsArticle>
    <Title></Title>
    <Summary></Summary>
    ...
    <ContactInfo>
        <Name></Name>
        <Email></Email>
    </ContactInfo>
</NewsArticle> 
```

到目前为止，我的解决方案是包含一个`Resource Selector`字段来添加对现有 smartform*实例*的引用。我更愿意在*配置*级别进行关联，以使数据输入工作流程更直观。

我正在使用 Bill Cava`ContentTypes`并从 smartform XSD 生成类，因此它还可以使演示代码更自然和类型安全，因为可以直接访问嵌入式字段（而不是必须基于引用 ID 发出另一个请求，这可能是也可能不是我期望的智能表单的 ID）。

我认为这是不可能开箱即用的；我不反对破解 Workarea 代码来完成类似的工作。有没有人有这样的场景经验？

我从 Ektron 代表那里听说，他们计划在即将到来的夏季版本中提升 smartforms 的作用——谁能提供更多关于这一点的信息？也许会支持像我描述的那样的 smartform 组合？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-09T19:25:29.243

目前无法进行 smartform 合成。根据为什么/如果您确实需要第二个 smartform 定义，您可以只在新闻文章中定义联系信息。

如果联系信息智能表单以一对多或多对多的方式与新闻文章相关，那么使用资源选择器是我所知道的创建您正在寻找的关系的唯一方法。

如果关系是一对一或多对一的，那么我建议取消单独的 smartform 定义。

如果您可以为内容作者阐明您尝试实现的工作流程，我可能会做出更好的回应。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-26T22:50:21.970

内容[类型](http://www.ektron.com/Webinars/Details/Ektron-Content-Types/)将代表 CMS 中的数据。假设在您的示例中，NewsArticle 包含对 ContactInfo 的引用。从表示的角度来看，将 ContactInfo 嵌入到 NewsArticle 中可能是有意义的，但它会将 ContentTypes 变成单向数据模型。您将失去构建新 NewsArticle 并将其保存到 CMS 中的能力。

可能对您有用的方法是将内容类型保持原样，并使用资源选择器中的 ContactInfo 的 id。然后创建一个 NewsArticleDisplayModel... 本质上是一个包含新闻文章数据以及 ContactName 和 ContactEmail 的视图模型。

现在，如果您需要可搜索的联系信息，您可以使用[CMS 扩展](http://documentation.ektron.com/cms400/v85/webhelp/Developer/Creating_a_new_extension.htm)并挂钩到 OnBeforePublish 事件以使用 ContactInfo 中的名称更新可搜索的元数据，以便可以使用来自的值搜索 NewsArticle其他“嵌入式”资源。不过，这可能会有点棘手……理想情况下，您还必须挂钩到 ContactInfo 对象的发布事件，以防该方面也发生变化。然后，您是否创建了一个自定义数据库表来跟踪哪些 NewsArticle 内容 ID 正在使用特定的 ContactInfo？

您的解决方案可以根据需要变得复杂，但我会将内容块分开。如果不出意外，您最终会得到一个更易于维护和升级的解决方案。

# android - GPS 位置在 Android 2.2 和 Android 2.3 中不断更新

> ID：15143675
> 
> 赞同：0
> 
> 时间：2013-02-28T19:08:41.777
> 
> 标签：android, gps, location

我开发了一个应用程序，每 30 秒后使用当前位置。该应用程序已完成。它可以在 ICS (Android 4)、JellyBean(Android 4.1) 设备上完美运行，但是当我在 Android 2.3 或 Android 2.2 上运行该应用程序时，应用程序 GPS 每隔 2/3 秒就会更新一次并不断更新。虽然我的代码完成了 30 秒，并且在 Android 4,4.1 中完美运行（30 秒后），但在 Android 2.3 或 2.2 中不起作用。

我正在分享代码......

```
 public class GPSManager
{
    //private static final int gpsMinTime = 60000;
    //private static final int gpsMinDistance = 0;

    private long gpsMinTime = 0;
    private float gpsMinDistance = 0;

    private static LocationManager locationManager = null;
    private static LocationListener locationListener = null;
    private static GPSCallback gpsCallback = null;

    public GPSManager(long gpsMinTime,float gpsMinDistance)
    {   
        this.gpsMinTime = gpsMinTime;
        this.gpsMinDistance = gpsMinDistance;

        GPSManager.locationListener = new LocationListener()
        {
            @Override
            public void onLocationChanged(final Location location)
            {
                if (GPSManager.gpsCallback != null)
                {
                    GPSManager.gpsCallback.onGPSUpdate(location);
                }
            }

            @Override
            public void onProviderDisabled(final String provider)
            {

            }

            @Override
            public void onProviderEnabled(final String provider)
            {

            }

            @Override
            public void onStatusChanged(final String provider, final int status, final Bundle extras)
            {

            }
        };
    }

    public GPSCallback getGPSCallback()
    {
        return GPSManager.gpsCallback;
    }

    public void setGPSCallback(final GPSCallback gpsCallback)
    {
        GPSManager.gpsCallback = gpsCallback;
    }

    public void startListening(final Context context)
    {
        if (GPSManager.locationManager == null)
        {
            GPSManager.locationManager = (LocationManager) context.getSystemService(Context.LOCATION_SERVICE);
        }

        final Criteria criteria = new Criteria();

        criteria.setAccuracy(Criteria.ACCURACY_MEDIUM);  // accuracy_midium
        criteria.setSpeedRequired(true);
        criteria.setAltitudeRequired(false);
        criteria.setBearingRequired(true);
        criteria.setCostAllowed(true);
        criteria.setPowerRequirement(Criteria.POWER_MEDIUM);

        final String bestProvider = GPSManager.locationManager.getBestProvider(criteria, true);

        if (bestProvider != null && bestProvider.length() > 0)
        {
            GPSManager.locationManager.requestLocationUpdates(bestProvider, this.gpsMinTime,
                    this.gpsMinDistance, GPSManager.locationListener);

        }
        else
        {
            final List<String> providers = GPSManager.locationManager.getProviders(true);

            for (final String provider : providers)
            {
                GPSManager.locationManager.requestLocationUpdates(provider, this.gpsMinTime,
                        this.gpsMinDistance, GPSManager.locationListener);
            }
        }
    }

    public void stopListening()
    {
        try
        {
            if (GPSManager.locationManager != null && GPSManager.locationListener != null)
            {
                GPSManager.locationManager.removeUpdates(GPSManager.locationListener);
            }

            GPSManager.locationManager = null;
        }
        catch (final Exception ex)
        {

        }
    }

} 
```

我的位置更新代码在这里：

```
private static final long GPS_MINTIME = 30000;
private static final float GPS_MINDISTANCE = 100;
gpsManager = new GPSManager(GPS_MINTIME,GPS_MINDISTANCE);
                gpsManager.startListening(getApplicationContext());
                gpsManager.setGPSCallback(this); 
```

任何想法为什么会发生这种情况。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T19:20:37.853

[请在 SO https://stackoverflow.com/a/4245527/1438915](https://stackoverflow.com/a/4245527/1438915)上查看此答案

在 api < 4.0 min 时间没有强制考虑它有时可能是不准确的。**像提示一样工作**。

**更新**

来自 docs [INFO](http://developer.android.com/reference/android/location/LocationManager.html#requestLocationUpdates%28long,%20float,%20android.location.Criteria,%20android.app.PendingIntent%29)我认为您应该阅读此内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T19:47:00.547

根据我的评论，这是一个已知的（但未广泛报道的错误/功能）。请参阅[Google Groups Post](https://groups.google.com/forum/?fromgroups=#!search/%22sean%2420barbeau%22/android-platform/NElQDFGppZk/so-drODfyjIJ) 我确实添加了对此提案的支持，但该线程现已关闭，因为它已在 4.1 中修复

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T19:15:45.163

更改`GPS_MINTIME`大于`6000`
它将完美运行。

# php - 为什么 php base64_decode 返回 null？

> ID：15143679
> 
> 赞同：1
> 
> 时间：2013-02-28T19:08:59.453
> 
> 标签：php, android, base64

我已将位图从 java 方法编码为 Base64 字符串。然后我将此字符串作为 JSON 发送到一个 php web 服务，该服务会将其插入到 longBlob 中。

> iVBORw0KGgoAAAANSUhEUgAAAtAAAAQOCAYAAADysw/5AAAABHNCSVQICAgIfAhkiAAAIABJREFU\neJzs3c1WG1maLuBwr76A8A004szPkuxxrxJ4Xghzxg6cfcbgco0L48weW.....

但由于某种原因，当我这样做时

```
$cust_sign = base64_decode($encodedString);

`$cust_sign` is `null`. 
```

这是我用来编码的：

```
 ByteArrayOutputStream baos = new ByteArrayOutputStream();
        b.compress(Bitmap.CompressFormat.PNG,50,baos);
        byte[] bytes=baos.toByteArray();
        String base64Image = Base64.encodeToString(bytes,Base64.DEFAULT); 
```

我在 php 脚本中也有这个：

```
if (base64_decode($cust_sign, true)) 
   { 
       echo "valid"; 
   } 
```

它确实回显有效

你知道为什么吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T19:15:34.770

由于某种原因，您的字符串包含换行符（ \n ）。删除它们，它应该可以工作。

*编辑：*尝试将 Base64.encodeToString() 中的第二个参数从 Base64.DEFAULT 更改为 Base64.NO_WRAP。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T19:31:12.853

尝试添加 strict 参数以检查字符串是否包含 base64 字母表之外的字符。如果函数返回 FALSE，则可能表明您的 base64 字符串格式错误

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T19:17:02.680

“\”不包含在 Base64 中。您的代码“\n”中似乎有换行符。失败的不是您的解码，而是您对内容进行编码的方式。使用您正在使用的过程更新您的问题，我将更多地编辑我的答案以更具体。

# spring - 使用 Spring Data JPA、Hibernate 和多事务管理器：未定义名为“transactionManager”的 bean

> ID：15143681
> 
> 赞同：13
> 
> 时间：2013-02-28T19:09:02.427
> 
> 标签：spring, hibernate, cxf, spring-data-jpa, transactionmanager

**编辑**：对于任何可能对此问题感兴趣的人，我会在问题的末尾提供问题的分析以及相关的解决方案。

我正在为使用 Spring 3.2、Hibernate 4.1、Spring Data JPA 1.3 和 Apache CXF 2.5（特别是 JAX-RS 模块）的 Web 应用程序配置一个模块。我有以下配置（它工作得很好，为简洁起见省略了详细信息）：

```
 @Bean(name = "entityManagerFactory")
  public LocalContainerEntityManagerFactoryBean getEntityManagerFactory() throws SQLException{
    LocalContainerEntityManagerFactoryBean factory = new LocalContainerEntityManagerFactoryBean();
    //...    
    return factory;
  }

  @Bean(name = "transactionManager")
  public JpaTransactionManager getTransactionManager() throws SQLException{
    JpaTransactionManager manager = new JpaTransactionManager();
    //...    
    return manager;
  }

  @Bean(name = "persistenceExceptionTranslator")
  public PersistenceExceptionTranslator getPersistenceExceptionTranslator(){
    return new HibernateExceptionTranslator();
  } 
```

我的问题是我必须依赖一些定义自己的外部模块`PlatformTransactionManager`，所以我发现自己同时使用更多的事务管理器。这个问题很容易通过[Transactional.html#value()](http://static.springsource.org/spring/docs/3.2.x/javadoc-api/org/springframework/transaction/annotation/Transactional.html#value%28%29)解决，所以无论我需要在哪里使用`@Transactional`，我都使用我必须用于该事务的事务管理器的名称来限定注释。
我想将我在模块中定义的事务管理器的名称更改为更有意义的名称，以满足外部模块的标准。因此，例如，`externalModule1`将其经理定义为`externalModule1TransactionManager`并且我想拥有

```
 @Bean(name = "myModuleransactionManager")
  public JpaTransactionManager getTransactionManager() throws SQLException{
    JpaTransactionManager manager = new JpaTransactionManager();
    //...    
    return manager;
  } 
```

这似乎很容易，不幸的是，当我进行此更改时（并且我`@Transactional#value()`相应地更改了用法，我得到了一个例外。

```
java.lang.RuntimeException: org.apache.cxf.interceptor.Fault: No bean named 'transactionManager' is defined
    at org.apache.cxf.interceptor.AbstractFaultChainInitiatorObserver.onMessage(AbstractFaultChainInitiatorObserver.java:110)
    at org.apache.cxf.phase.PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:323)
    at org.apache.cxf.transport.ChainInitiationObserver.onMessage(ChainInitiationObserver.java:123)
    at org.apache.cxf.transport.http.AbstractHTTPDestination.invoke(AbstractHTTPDestination.java:207)
    at org.apache.cxf.transport.servlet.ServletController.invokeDestination(ServletController.java:213)
    at org.apache.cxf.transport.servlet.ServletController.invoke(ServletController.java:154)
    at org.apache.cxf.transport.servlet.CXFNonSpringServlet.invoke(CXFNonSpringServlet.java:126)
    at org.apache.cxf.transport.servlet.AbstractHTTPServlet.handleRequest(AbstractHTTPServlet.java:185)
    at org.apache.cxf.transport.servlet.AbstractHTTPServlet.doGet(AbstractHTTPServlet.java:113)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:621)
    at org.apache.cxf.transport.servlet.AbstractHTTPServlet.service(AbstractHTTPServlet.java:164)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:222)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123)
    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:171)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:99)
    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:936)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
    at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1004)
    at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:589)
    at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:312)
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:895)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:918)
    at java.lang.Thread.run(Thread.java:662)
Caused by: org.apache.cxf.interceptor.Fault: No bean named 'transactionManager' is defined
    at org.apache.cxf.service.invoker.AbstractInvoker.createFault(AbstractInvoker.java:155)
    at org.apache.cxf.service.invoker.AbstractInvoker.invoke(AbstractInvoker.java:121)
    at org.apache.cxf.jaxrs.JAXRSInvoker.invoke(JAXRSInvoker.java:167)
    at org.apache.cxf.jaxrs.JAXRSInvoker.invoke(JAXRSInvoker.java:94)
    at org.apache.cxf.interceptor.ServiceInvokerInterceptor$1.run(ServiceInvokerInterceptor.java:58)
    at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:439)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
    at java.util.concurrent.FutureTask.run(FutureTask.java:138)
    at org.apache.cxf.workqueue.SynchronousExecutor.execute(SynchronousExecutor.java:37)
    at org.apache.cxf.interceptor.ServiceInvokerInterceptor.handleMessage(ServiceInvokerInterceptor.java:106)
    at org.apache.cxf.phase.PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:263)
    ... 25 more
Caused by: org.springframework.beans.factory.NoSuchBeanDefinitionException: No bean named 'transactionManager' is defined
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.getBeanDefinition(DefaultListableBeanFactory.java:568)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getMergedLocalBeanDefinition(AbstractBeanFactory.java:1099)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:278)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:198)
    at org.springframework.transaction.interceptor.TransactionAspectSupport.determineTransactionManager(TransactionAspectSupport.java:246)
    at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:100)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
    at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:155)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
    at org.springframework.data.jpa.repository.support.LockModeRepositoryPostProcessor$LockModePopulatingMethodIntercceptor.invoke(LockModeRepositoryPostProcessor.java:92)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
    at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:91)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
    at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:155)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
    at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:204)
    at sun.proxy.$Proxy98.save(Unknown Source)
    at myModule.package.SomeOtherClass.someOtherMethod(SomeOtherClass.java:114)
    at myModule.package.SomeOtherClass$$FastClassByCGLIB$$2bda5a73.invoke(<generated>)
    at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:204)
    at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:698)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:150)
    at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:110)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
    at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:631)
    at myModule.package.SomeClass$$EnhancerByCGLIB$$37044080.myMethod(<generated>)
    at myModule.package.SomeClass.someMethod(SomeClass.java:64)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.cxf.service.invoker.AbstractInvoker.performInvocation(AbstractInvoker.java:173)
    at org.apache.cxf.service.invoker.AbstractInvoker.invoke(AbstractInvoker.java:89)
    ... 34 more 
```

特别是，我想把注意力集中在

```
myModule.package.SomeOtherClass.someOtherMethod(SomeClass.java:114) 
```

和

```
myModule.package.SomeClass.someMethod(SomeClass.java:64) 
```

他们的代码看起来像

```
@Transactional("myModuleransactionManager")
public ... someOtherMethod(){
   ...
} 
```

和

```
public ... someMethod(){
   ...
} 
```

所以，据我了解，这个配置应该可以工作，为什么它会抛出那个异常？是否需要标准的命名事务管理器？还是因为 cxf？我在同一个应用程序中发现了一些与多个事务管理器相关的问题（[示例 1](https://stackoverflow.com/questions/12606257/spring-multiple-transaction-manager-issue)、[示例](https://stackoverflow.com/questions/10719646/no-bean-named-transactionmanager-is-defined)2 ），但这些问题中公认的答案推动了我的解决方案。我误解了什么，我做错了什么？
感谢所有愿意阅读这个长问题的人！

**编辑根据 Michail 的回答提供完整的解释**：使用[Spring Data JPA](http://www.springsource.org/spring-data/jpa)需要定义存储库接口以连接到数据库。`someOtherMethod`确实在调用我的存储库之一，该存储库定义为：

```
@Repository("myRepository")
@Transactional(propagation = Propagation.NESTED, value = "myModuleransactionManager")
public interface MyRepository extends JpaRepository<MyEntity, Integer>
{

} 
```

这看起来还不错，但是查看`JpaRepository`实现源代码（因此，查看`org.springframework.data.jpa.repository.support.SimpleJpaRepository`我发现`save`（以及其他更新方法）带有注释`@Transactional`。代码来自`SimpleJpaRepository`

```
 @Transactional
    public <S extends T> S save(S entity) {

        if (entityInformation.isNew(entity)) {
            em.persist(entity);
            return entity;
        } else {
            return em.merge(entity);
        }
    } 
```

因此，在使用 Spring Data JPA 时，默认事务管理器（名为 的`transactionManager`）是强制性的。对我的目标不利，但至少我现在知道就是这样！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-28T21:53:20.530

看起来您`someOtherMethod`调用了任何其他`@Transactional`组件（带有`save`方法的某些类）。而且我认为它具有`@Transactinal()`（空）注释（使用名为的默认bean `transactionManager`）。

您可能会`TransactionInterceptor`在堆栈跟踪中看到 2 个位置。请提供一些有关它的详细信息。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-11-14T11:15:57.647

我怀疑您只需要确保您的存储库在您的 @EnableJpaRepositories 注释中使用正确命名的事务管理器。

IE

```
@Configuration
@EnableTransactionManagement
@EnableJpaRepositories(
        entityManagerFactoryRef = "fooEntityManagerFactory", 
        transactionManagerRef = "fooTransactionManager",
        basePackages = {"com.sctrcd.multidsdemo.integration.repositories.foo"})
public class FooConfig {
    //...
} 
```

我花了一段时间才弄清楚细节，所以我在这里提供了一个关于如何配置 Spring Data JPA 存储库以使用多个数据源的更完整的解释：

[xml配置中的多个jpa：repositories，如何使用Spring java config配置@EnableJPARepositories？](https://stackoverflow.com/questions/15008809/multiple-jparepositories-in-xml-config-how-to-configure-with-enablejpareposit/19976132#19976132)

一个完整的项目在这里展示它：

[https://github.com/gratiartis/multids-demo](https://github.com/gratiartis/multids-demo)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-01-25T08:36:13.793

实际上，有一种方法可以将命名的 TransactionManager 与 Spring Data JPA 一起使用。这对我有用：

```
<bean id="myTransactionManager" class="org.springframework.orm.jpa.JpaTransactionManager">
    <property name="entityManagerFactory" ref="myEntityManagerFactory" />
</bean>
<tx:annotation-driven transaction-manager="myTransactionManager"/>

<jpa:repositories base-package="com.xxx.yyy" entity-manager-factory-ref="myEntityManagerFactory" transaction-manager-ref="myTransactionManager">
</jpa:repositories> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-01T12:38:01.300

我发现你的问题在概念上非常有趣。从而能够修改一些我早已遗忘的概念。看起来它是对 java config 方面的限制。因此，您将不得不在两者之间使用一些 xml，然后给**transactionmanager**类似的东西

```
<tx:annotation-driven transaction-manager="myModuletransactionManager"/> 
```

然后你可以使用你的事务管理器。默认**SimpleJpaRepository** 也将只使用新的。

**更新：**或者顺便说一下，你现在也可以通过 Config 使用它，它似乎是[EnableTransactionManagement](http://static.springsource.org/spring/docs/3.1.0.M2/javadoc-api/org/springframework/transaction/annotation/EnableTransactionManagement.html "启用事务管理")

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-09-22T19:09:48.167

我在我的服务层有资格@Transactional。在我看来，我们可以在 Spring Data 存储库中禁用事务管理，如下所示：

```
<jpa:repositories base-package="ru.xdsoft.conn.thanksapp.thanks.dao.repository"
                  entity-manager-factory-ref="thanksEntityManagerFactory"
                  enable-default-transactions="false"
/>
<jpa:repositories base-package="ru.xdsoft.conn.thanksapp.orgstruct.dao"
                  entity-manager-factory-ref="orgStructEntityManagerFactory"
                  enable-default-transactions="false"
/> 
```

100% 不确定，但错误消失了。在这里找到它：[https://github.com/spring-projects/spring-data-jpa/blob/master/src/test/resources/org/springframework/data/jpa/repository/support/disable-default-transactions。 xml](https://github.com/spring-projects/spring-data-jpa/blob/master/src/test/resources/org/springframework/data/jpa/repository/support/disable-default-transactions.xml)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-06-04T13:59:20.930

我已经完成了几次，所以这里是如何完全用 Java 代码（没有 xml）来完成它。不过，我确实使用 Lombok，我强烈推荐。我只关注所提出的问题，所以如果您以前从未这样做过，请阅读 Spring 文档以配置有关 JPA 方言和 spring 数据源驱动程序类的更多详细信息。

`findAll()`说明：当调用 JPA或TransactionInterceptor之类的嵌入式方法时`save()`，将查找默认`"transactionManager"` 的这是**通过 Hibernate 和 JPA 连接多个数据库所需的**。

1.  在`application.properties`

```
first.datasource.url=my/database/url/example
first.datasource.username=username-example
first.datasource.password=password-example

second.datasource.url=my/database/url/example
second.datasource.username=username-example
second.datasource.password=password-example 
```

2.  创建你的数据库配置

```
import org.apache.commons.dbcp2.BasicDataSource;
import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.boot.autoconfigure.jdbc.DataSourceProperties;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.boot.orm.jpa.EntityManagerFactoryBuilder;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Primary;
import org.springframework.data.jpa.repository.config.EnableJpaRepositories;
import org.springframework.orm.jpa.JpaTransactionManager;
import org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean;
import org.springframework.transaction.PlatformTransactionManager;
import org.springframework.transaction.annotation.EnableTransactionManagement;

import javax.persistence.EntityManagerFactory;
import javax.sql.DataSource;

@Configuration
@EnableTransactionManagement
@EnableJpaRepositories(
        entityManagerFactoryRef = "firstEntityManagerFactory", basePackages = {
        "be.company.appname.repository.firstdatabase", "be.company.appname.config.firstdatabase"
})
public class FirstDatabaseConfig {

    @Value("${first.datasource.url}")
    private String url;
    @Value("${first.datasource.username}")
    private String username;
    @Value("${first.datasource.password}")
    private String password;
    @Value("${spring.datasource.driver-class-name}")
    private String driver;

    @Primary
    @Bean(name = "firstDataSourceProperties")
    @ConfigurationProperties("first.datasource")
    public DataSourceProperties dataSourceProperties() {
        return new DataSourceProperties();
    }

    @Primary
    @Bean(name = "firstDataSource")
    @ConfigurationProperties("first.datasource.configuration")
    public DataSource dataSource(@Qualifier("firstDataSourceProperties") DataSourceProperties dataSourceProperties) {
        BasicDataSource dataSource = new BasicDataSource();
        dataSource.setDriverClassName(driver);
        dataSource.setUrl(url);
        dataSource.setUsername(username);
        dataSource.setPassword(password);
        dataSource.setRemoveAbandonedOnBorrow(true);
        dataSource.setRemoveAbandonedOnMaintenance(true);
        dataSource.setInitialSize(10);
        dataSource.setMaxTotal(20);
        dataSource.setValidationQuery("select 1 from MY_SCHEMA.TABLE");
        dataSource.setValidationQueryTimeout(900_000);
        dataSource.setTestWhileIdle(true);
        dataSource.setLogAbandoned(true);
        dataSource.setTestOnReturn(true);
        dataSource.setTestOnBorrow(true);
        dataSource.setDefaultAutoCommit(false);
        return dataSource;
    }

    @Primary
    @Bean(name = "firstEntityManagerFactory")
    public LocalContainerEntityManagerFactoryBean entityManagerFactory(
            EntityManagerFactoryBuilder builder,
            @Qualifier("firstDataSource") DataSource firstDataSource
    ) {
        return builder
                .dataSource(firstDataSource)
                .packages("be.company.appname.model.firstdatabase")
                .persistenceUnit("first")
                .build();
    }

    @Primary
    @Bean(name = "firstTransactionManager")
    public PlatformTransactionManager transactionManager(
            @Qualifier("firstEntityManagerFactory") EntityManagerFactory firstEntityManagerFactory
    ) {
        return new JpaTransactionManager(firstEntityManagerFactory);
    }
} 
```

对此有几点说明：

*   注意`@Primary`！您只需要在**其中 1 个 databaseConfigs**上使用它！对于您的第二个数据库，您可以使用相同的代码并进行明显的更改，包括名称更改（例如 firstEntityManagerFactory 变为 secondEntityManagerFactory 等）、更改适当的变量、更改 ValidationQuery 和定义正确的包。
*   在第二个 databaseConfig 中，我`"be.company.appname.config.firstdatabase"`从`basePackages = {}`声明中删除了。只有指向存储库包的指针才可以。

3.  `firstEntityManagerFactory`在您在bean 中定义的包中创建您的 databaseObject 。

```
@Entity
@Table(name = "USER")
@Getter
@Setter
@Builder
@NoArgsConstructor
@AllArgsConstructor
public class MyUser {

    @Id
    @Column(name = "ID")
    private Long id;

    @Column(name = "USERNAME")
    private String userName;

    @Column(name = "UID")
    private String uid;

    @Column(name = "FIRST_NAME")
    private String firstName;

    @Column(name = "LAST_NAME")
    private String lastName; 
```

*   `@Table`是您的数据库表的确切名称
*   `@Column`是您的数据库表列的确切名称。您自己的字段变量不必匹配，但我这样做是出于习惯（例如，声明`@Column(name = "USERNAME") private String name;` 也可以

4.  在您在 databaseConfig 类中声明的包中创建您的存储库

```
@Repository
@Transactional(value = "firstTransactionManager")
public interface MyUserRepository extends JpaRepository<MyUser, Long> {

    List<MyUser> findAll();
} 
```

是什么原因导致出现询问者的异常？例如：

我`MyUserRepository.findById(1L)`在没有在我的存储库中声明的方法的情况下调用。它是 JPA 默认嵌入的已知简写。查看您自己的[JPA 速记查询](https://docs.spring.io/spring-data/jpa/docs/current/reference/html/#jpa.query-methods.query-creation)的详细信息。`transactionManager`如果未在存储库中声明，您的应用程序将绕过您的存储库接口查找默认值。但是通过声明该方法，您的应用程序将知道寻找您自己的自定义`firstTransactionManager`

**注意：**的创建`BasicDataSource`可能会因您使用的数据库而异。我正在使用`DB2Dialect`for 连接到 AS400。

# php - 用 $_POST 覆盖 HTML 页面

> ID：15143682
> 
> 赞同：-1
> 
> 时间：2013-02-28T19:09:09.843
> 
> 标签：php, post, overwrite

我预计单击“提交”按钮会用两个回显语句覆盖 HTML 页面。但是，不会发生覆盖。该页面已连接到 Apache。

```
<?php
$username = $_POST['username'];
$password = $_POST['password'];

if (!isset($_POST['submit'])) 
{
    // if page is not submitted to itself echo the form
} 
else {
    echo("Hello, " . $_POST['username']);
    echo("Your password is " . $_POST['password'] . "!");
}
?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
    <title>Visual Debate Home</title>
</head>
<body>
    <h1>Visual Debate</h1>
    <form method="post" action="?">
        <div>Username: </div><div><input type="text" name="username" size="20" maxlength="20"></div>
        <div>Password: </div><input type="password" name="password" size="15" maxlength="15"></div>
        <div><input type="submit" value="submit" name="submit"></div>
    </form>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T19:11:48.653

如果我对您的理解正确，那么您正在寻找这个：

```
<?php
$username = $_POST['username'];
$password = $_POST['password'];

if (!isset($_POST['submit'])) 
{
    // if page is not submitted to itself echo the form
} 
else {
    echo("Hello, " . $_POST['username']);
    echo("Your password is " . $_POST['password'] . "!");
    die(); // stops the script execution! note that you can use die("like this") to output the "like this" and stop the script execution there.
}
?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
    <title>Visual Debate Home</title>
</head>
<body>
    <h1>Visual Debate</h1>
    <form method="post" action="?">
        <div>Username: </div><div><input type="text" name="username" size="20" maxlength="20"></div>
        <div>Password: </div><input type="password" name="password" size="15" maxlength="15"></div>
        <div><input type="submit" value="submit" name="submit"></div>
    </form>

</body>
</html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T19:17:28.577

页面的 HTML 超出了`if` `else`PHP 的逻辑，这意味着它将始终显示。我个人会做这样的事情：

```
<?php
    $username = $_POST['username'];
    $password = $_POST['password'];

    if (isset($_POST['submit'])):
        // Form was submitted to itself -- overwrite the form 
        echo("Hello, " . $_POST['username']);
        echo("Your password is " . $_POST['password'] . "!");
    else: 
?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
    <title>Visual Debate Home</title>
</head>
<body>
    <h1>Visual Debate</h1>
    <form method="post" action="?">
        <div>Username: </div><div><input type="text" name="username" size="20" maxlength="20"></div>
        <div>Password: </div><input type="password" name="password" size="15" maxlength="15"></div>
        <div><input type="submit" value="submit" name="submit"></div>
    </form>

</body>
</html>
<?php endif; ?> 
```

# c# - 我应该如何通过 SqlConnection 正确检索数据库记录？

> ID：15143685
> 
> 赞同：0
> 
> 时间：2013-02-28T19:09:14.157
> 
> 标签：c#, .net-4.0, standards, sqlconnection

我敢肯定这个问题已经被问过很多次了，我挖掘了一些类似的问题，但找不到一个真正像我想要的那样彻底解决它的问题。

我有一个应用程序，它使用数据库助手类来连接和检索数据库中的记录。我正在考虑重写它，并想知道最好的方法是什么。

现在大致是这样设置的（注意：这已经到位，并且有数千行这样的东西）。

[**数据库助手.CS**](http://pastie.org/6355776)

```
 private SqlConnection conn; 

    public DatabaseHelper()
    {
        // Create database connection
        conn = new System.Data.SqlClient.SqlConnection();
        SqlConnectionStringBuilder connection = new SqlConnectionStringBuilder();
        connection.ConnectTimeout = 150; // Microsft fix for timeout error (known bug)
        connection.MinPoolSize = 20; // Microsft fix for timeout error (known bug)
        connection.DataSource = Properties.Settings.Default.DBString;
        connection.InitialCatalog = Properties.Settings.Default.DBInitCatalog;
        connection.IntegratedSecurity = true;

        if (conn.State != ConnectionState.Connecting)
        {
            conn.ConnectionString = connection.ConnectionString;
        }
     }

    public bool Open()
    {
        if (this.IsOpen()) // IsOpen is just a method that checks connectionstate.
        { return true; }
        else
        {
            try
            {
                conn.Open();
                return true;
            }
            catch (System.Data.SqlClient.SqlException ex)
            {
                // omitted for post
            }
        }
        return false;
    }

    public bool Close()
    {
        if (!this.IsOpen())
        { return true; }
        try
        {
            conn.Close();
            return true;
        }
        catch (System.Data.SqlClient.SqlException ex)
        {
           // omitted for post
        }
        return false;
    }

    public List<string> GetTeamLeaders(string team)
    {
        List<string> leaders = new List<string>();
        string query = "Select Leader FROM Teams WHERE Team = @team_vc";
        try
        {
            using (SqlCommand cmd = new SqlCommand(query, conn))
            {
                cmd.Parameters.Add("@team_vc", SqlDbType.NVarChar).Value = team;
                using (SqlDataReader sdr = cmd.ExecuteReader())
                {
                    int column = sdr.GetOrdinal("Leader");
                    while (sdr.Read())
                    {
                        leaders.Add(sdr[column].ToString());
                    }
                }
            }
        }
        catch (Exception ex)
        {
            // omitted for post
        }
        return leaders;
    }

    private string GetTeamAbbrev(string team)
    {
        string abbrev= "";

        string query = "SELECT Abbrev FROM Teams where Team = @team_vc";
        using (SqlCommand cmd = new SqlCommand(query, conn))
        {
            cmd.Parameters.Add("@team_vc", SqlDbType.NVarChar).Value = team;
            try
            {
                abbrev= Convert.ToString(cmd.ExecuteScalar());
            }
            catch (Exception ex)
            {
                // omitted for post
            }
        }
        return (string.IsNullOrEmpty(location)) ? "None" : abbrev;
    } 
```

[**主应用程序.CS**](http://pastie.org/6355781)

```
 private DatabaseHelper dbHelper;

    public MainApp()
    {
        InitializeComponent();
        dbHelper= new DatabaseHelper(); // Instantiate database controller
    }

    private void someButton_Click(object sender, EventArgs e)
    {
        List<string> teamLeaders = new List<string>();

        if (dbHelper.Open())
        {
            teamLeaders = dbConn.GetTeamLeaders(textboxTeam.Text);
            dbHelper.Close();
        }
        else
        {
            return;
        }
        // all the code to use results
    }

    private void someOtherButton_Click(object sender, EventArgs e)
    {
        List abbreviation = string.Empty;

        if (dbHelper.Open())
        {
            abbreviation = dbConn.GetTeamLeaders(textboxTeam.Text);
            dbHelper.Close();
        }
        else
        {
            return;
        }
        // all the code to use results
    } 
```

现在我确信这是如何设置的一些非常严重的问题，但对我来说，我最大的抱怨总是不得不打开和关闭连接。

我的第一步是在DatabaseHelper 方法中移动open 和close，这样每个方法（即GetTeamLeaders）都会自己调用open 和close。但问题是，如果它确实无法打开，则很难将其反馈给主程序，主程序将尝试使用变量在创建时包含的任何值运行。我在想我几乎需要一个“out”布尔值来标记查询是否完成，并且可以检查 make 并检查任何时候我使用我需要从数据库中获取一些东西，但我确定有问题至。

这种方法的另一个大问题是，每当我想从另一个表单进行调用时，我必须在该表单上创建另一个助手实例，或者传递对主表单的引用。（目前我解决这个问题的方法是预先检索我需要的所有信息`MainApp`，然后将其传递给新表单）。我不确定当我重写它时是否有一种很好的静态方法来设置它，以便我可以从任何地方调用它。

那么这里有什么值得保留的吗，还是需要将它们全部剥离并从头开始重建？

# sql - 如何表示可互换的列

> ID：15143688
> 
> 赞同：6
> 
> 时间：2013-02-28T19:09:23.480
> 
> 标签：sql, ruby-on-rails, erd

我不太确定如何表达这一点，但是有没有一种好方法来实现一个列本质上可以互换的表？

示例：您有一个用户模型，并希望允许两个用户成为“朋友”。对我来说，显而易见的方法是创建一个包含两列（“friend1”和“friend2”）的表，每列都包含用户的密钥。这使得说“是 user1 和 user2 的朋友”之类的话很尴尬，因为您必须检查“(friend1=user1 ANDfriend2=user2) OR (friend1=user2 ANDfriend2=user1)”。它会起作用，但对我来说似乎很尴尬，每次您想从该表中获取某些内容时，您都在查看两列。有没有更优雅的方式来做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-28T19:31:23.060

建立友谊关系时的一个关键选择是确定它是否是双向的。Twitter 以下是单向友谊和 Facebook 友谊是双向的示例。听起来你致力于双向，所以你有两个选择：

1）检查两个方向

```
select *
from friendships 
where (friend1 = 123 and friend2 = 456) OR (friend2 = 123 and friend1 = 456) 
```

2) 总是将较低的user_id 放入friend1，较高的user_id 放入friend2，那么您的测试只需要检查一个方向。这有点难以维护，所以我只会出于性能原因才这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T19:16:49.717

实现这一点的方式可能看起来有点尴尬。这个想法是在一个有两列的表中有一个“friendshipId”：friendshipId 和 user。现在用户可以互换。

要确定 user1 和 user2 是否是朋友：

```
select friendshipId
from friends
group by friendshipId
having sum(case when name = user1 then 1 else 0 end) > 0 and
       sum(case when name = user2 then 1 else 0 end) > 0 
```

明智地使用约束、触发器和存储过程将确保朋友关系只有两个用户，某人不能自己成为朋友，等等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T19:36:32.920

您可以通过 has_many 或 has_and_belongs_to_many [http://guides.rubyonrails.org/association_basics.html](http://guides.rubyonrails.org/association_basics.html)

任何你想要一个链接你的用户模型的连接表。

例如

```
class User < ActiveRecord::Base
  has_many :followings
  has_many :followers, :through => :followings, :class_name => "User"
  has_many :followees, :through => :followings, :class_name => "User"
end

class Following < ActiveRecord::Base 
  # fields: follower_id followee_id (person being followed)
  belongs_to :follower, :class_name => "User"
  belongs_to :followee, :class_name => "User"
end 
```

就像[用户有很多：用户一样，还是我必须使用另一种方式来建立基于朋友的社交网络？](https://stackoverflow.com/questions/2268672/user-has-many-users-or-must-i-use-another-way-for-a-friend-based-social-networ)

# html - CSS - Span div 覆盖页面的整个高度

> ID：15143690
> 
> 赞同：3
> 
> 时间：2013-02-28T19:09:29.003
> 
> 标签：html, css

我已经对我的 div 进行了编码，以便它们（几乎）看起来完美。正确的 div 在彼此上方/下方，并且跨越页面的整个宽度。我发现它没有跨越页面的整个高度。任何建议将不胜感激！另外，我有一个水平滚动条，我很想离开。:)

**CSS：**

```
body {
  color: #333;
  font-size: 11px;
    font-family: "Myriad Pro", Arial, Helvetica, Arial, 'DejaVu Sans', 'Liberation Sans', Freesans, sans-serif;
  position: relative;
}

.container_16 {
  margin-left: auto;
  margin-right: auto;
  width: 960px;
  margin-top:0px;
  padding-top:0px;
      min-height:800px; 
    background-image:url(../images/Content_bkg.gif);
        box-shadow: 0px 0px 15px rgb(0,0,0);
    -webkit-box-shadow: 0px 0px 15px rgb(0,0,0);
}
.container_24 {
    background-image: url(../images/headerFooter_bkg.gif);
    height: 60px;
    margin: 0px;
    padding: 0px;
    border: 1px solid rgb(71, 89, 32);
    box-shadow: 0px 0px 15px rgb(0,0,0);
    -webkit-box-shadow: 0px 0px 15px rgb(0,0,0);
    position:relative;
    width:100%;
} 
```

**HTML：**

```
<body>
       <div class="container_24">
            <div class="grid_16">
                <input type="text" value="Username" /><input type="text" value="Password" /><input type="button" value="Submit" /><span class="mainLink">Register</span>
            </div>
       </div>
       <div class="container_16">
            <form id="form1" runat="server">
                <asp:ContentPlaceHolder ID="Body" runat="server">

                </asp:ContentPlaceHolder>
            </form>
       </div>
       <div class="container_24"></div>

</body> 
```

更新：这是我的代码与下面提供的包装器概念的样子。

```
.wrapper{
    height:100%;
}

.container_16 {
  margin-left: auto;
  margin-right: auto;
  width: 960px;
  margin-top:0px;
  padding-top:0px;
    background-image:url(../images/Content_bkg.gif);
        box-shadow: 0px 0px 15px rgb(0,0,0);
    -webkit-box-shadow: 0px 0px 15px rgb(0,0,0);
}
.container_24 {
    background-image: url(../images/headerFooter_bkg.gif);
    height: 60px;
    margin: 0px;
    padding: 0px;
    border: 1px solid rgb(71, 89, 32);
    box-shadow: 0px 0px 15px rgb(0,0,0);
    -webkit-box-shadow: 0px 0px 15px rgb(0,0,0);
    position:relative;
    width:100%;
} 
```

HTML：

```
<body>
    <div class="wrapper">
       <div class="container_24">
            <div class="grid_16">
                <input type="text" value="Username" /><input type="text" value="Password" /><input type="button" value="Submit" /><span class="mainLink">Register</span>
            </div>
       </div>
       <div class="container_16">
            <form id="form1" runat="server">
                <asp:ContentPlaceHolder ID="Body" runat="server">

                </asp:ContentPlaceHolder>
            </form>
       </div>
       <div class="container_24"></div>
        </div>
</body> 
```

截屏：

![在此处输入图像描述](../Images/fc16dd0fdf8f95f037c6d9553560c2b1.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T19:12:05.053

你已经明确地给`height`了每个容器，拥有（视觉上）全高的唯一方法是将所有东西都包含在一个有`height: 100%`或类似的包装器中

**编辑：**澄清示例：

```
<body>
  <div id="wrapper">
     <!--Your stuff here-->
  </div>
</body> 
```

在上面的示例中，包装器获得 100% 的高度，而不是内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T19:12:57.450

您可能想使用 javascript 来获取页面的高度。然后对每个容器进行一些数学运算，以获得容器与高度的正确比率以填充页面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T19:34:33.930

我认为您想准确确定页面的高度和宽度。我以前曾问过类似的问题。看看：[如何在 Opera 12 中查找页面宽度（适用于桌面 Windows）？](https://stackoverflow.com/questions/13953913/how-to-find-page-width-in-opera-12-for-desktop-windows/13960641#13960641)

我做了同样的 RnD 并得出了[结果](https://docs.google.com/spreadsheet/ccc?key=0AsiIb2IL4qASdDczbW56a1d6NFpPTTNXX1pjOHJpZFE)

# sed - SED 搜索和替换数据库文件中的子字符串

> ID：15143691
> 
> 赞同：0
> 
> 时间：2013-02-28T19:09:33.340
> 
> 标签：sed

对所有人来说，

我花了很多时间寻找解决方案，但找不到。

仅作为背景，我有一个包含数千条记录的文本数据库。每条记录由 :

"0 @nnnnnn@ Xnnn" // 没有引号

记录在自己的一行上有很多字段，但我有兴趣搜索和替换子字符串（注意空格）的字段：

" 1 X94 User1.faculty.ventura.ca" // 没有引号

我想使用 sed 将子字符串“.faculty.ventura.ca”更改为“.students.moorpark.ut”，在全球范围内不更改所有记录。

我已经测试了很多东西，结果都是负面的。

如何才能做到这一点 ？

感谢您的帮助。鲍勃·佩雷斯 (robertperez1957@gmail.com)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T23:08:16.320

如果我理解正确，你想要这个：

```
sed 's/1 X94 \(.*\).faculty.ventura.ca/1 X94 \1.students.moorpark.ut/' mydatabase.file 
```

这会将表单的所有记录替换`1 X94 XXXXXX.faculty.ventura.ca`为`1 X94 XXXXX.students.moorpark.ut`。

以下是所有功能的详细信息：

*   `''`让您的脚本中有空格和其他混乱。
*   `s/` 意味着替代
*   `1 X94 \(.*\).faculty.ventura.ca` 是您将要替换的内容。将`\(.*\)`任何内容存储在该正则表达式中以用于替换
*   `1 X94 \1.students.moorpark.ut` 是用什么来替换你找到的东西。\1 填写第一个匹配的内容`\(.*\)`。（您可以在一行中有多个，然后下一个将是 \2。）
*   最后`/`只是告诉 sed 你已经完成了。如果您的数据库没有用于分隔其记录的换行符，您需要以 , 结尾`/g`，以便每行多次进行此更改。
*   mydatabase.file 应该是数据库的文件名。

请注意，这将输出到标准输出。您可能需要添加

```
> mynewdatabasefile.name 
```

到行尾，将所有输出保存在文件中。（这对你的终端没有多大好处。）

### 编辑，根据您的评论

如果要替换`1 F94 bperez.students.Napvil.NCC`为`1 F94 bperez.JohnSmith.customer`，可以使用另一组`\(.*\)`，如：

```
sed 's/1 X94 \(.*\).\(.*\).Napvil.NCC/1 X94 \1.JohnSmith.customer/' 251-2.txt 
```

这与上面类似，只是它匹配两个存储的参数。在此示例中，`\1`计算结果为`bperez`并且`\2`计算结果为`students`。我们匹配`\2`，但不要在表达式的替换部分使用它。您可以使用任意数量的存储参数来执行此操作。（Sed 可能有一些限制，但我从来没有打过足够复杂的字符串来打它。）例如，我们可以将 sed 脚本设为`'\(.\) \(...\) \(.*\).\(.*\).\(.*\).\(.*\)/\1 \2 \3.JohnSmith.customer/'`，这将使 \1 = 1, \2 = X94, \3 = bperez，\4 = Napvil 和 \5 = NCC，我们将忽略 \4 和 \5。虽然这实际上不是最好的答案 - 只是表明它可以做到。这不是最好的，因为它更丑，也因为它更容易接受。然后它会在一行上进行查找和替换`2 Z12 bperez.a.b.c`，这可能不是你想要的。我在编辑中输入的查找查询尽可能具体，同时仍然足够通用以适合您的任务。

### 另一个编辑！

你知道我怎么说“尽可能具体”吗？由于`.`性格特殊，我没有。事实上，我很一般。意思是“`.`完全匹配任何字符”，而不是“匹配句点”。正则表达式是“贪婪的”，尽可能地匹配，所以`\(.*\).\(.*\)`总是尽可能地填充第一个`\(.*\)` （这就是说，“将 0 用于许多字符并将其保存为以后的匹配”）。尝试使用：

```
 sed 's/1 X94 \(.*\)\.\(.*\).Napvil.NCC/1 X94 \1.JohnSmith.customer/' 251-2.txt 
```

这个额外的`\`充当转义序列，并将`.`“任何字符”更改为“只是句点”。仅供参考，因为我不（但应该）逃避其他时期，技术上 sed 将被`1 X94 XXXX.StdntZNapvilQNCC`视为有效匹配。因为`.`意味着任何字符，Z 或 Q 都将被认为是合适的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-26T22:21:16.110

以下教程帮助我 [sed - 替换文件中的子字符串](http://www.folkstalk.com/2012/01/sed-command-in-unix-examples.html)

尝试使用**-i**前缀直接替换文件中的相同内容

> sed -i 's/unix/linux/' file.txt

# c# - 如何通过视图模型有效地替换域的模型使用

> ID：15143693
> 
> 赞同：1
> 
> 时间：2013-02-28T19:09:48.590
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3

我一直看到直接使用域模型作为视图的参数是不好的做法。但不这样做似乎过于复杂且容易出错。例子：

这是编辑的视图`ItemViewModel`：

```
@model ItemViewModel 

@using (Html.BeginForm())
{
    <p>@Html.ValidationSummary()</p>

    @Html.LabelFor(o => o.ItemId) : @Html.EditorFor(o => o.ItemId)      
    @Html.LabelFor(o => o.MyItemProperty) : @Html.EditorFor(o => o.MyItemProperty)
} 
```

这是处理此问题的控制器方法

```
public ActionResult Edit(int? id) 
{
    Item itemViewModel = new ItemViewModel();

    if (id != null && id != 0)
    {
        var item = itemRepository.Items.FirstOrDefault(c => c.Id == id);
        if (item != null)
        {
            itemViewModel.ItemId = item.ItemId;
            itemViewModel.MyItemProperty = item.ItemId;
        }
    }

    return View(itemViewModel);
}

[HttpPost]
public ActionResult Edit(ItemViewModel itemViewModel)
{
    var item = itemRepository.Items.FirstOrDefault(c => c.Id == itemViewModel.Id);
    item.Id = itemViewModel.Id;
    item.MyItemProperty = itemViewModel.MyItemProperty;
    itemRepository.Save(item);

    return View("Success");
} 
```

这意味着我必须再次转换`Item`为。如果我添加一个新属性而我忘记将它添加到转换中，我最终会得到未保存的更改。`ItemViewModel``Item``Item`

这是你的做法还是我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T20:45:19.380

有几件事。正如您在上面查询的那样，我会从 Item 转换为 ItemModel 到 Item。然后有另一个名为 SomethingRelevantViewModel 的类，它具有您的 ItemModel 作为属性并且是视图的 @model。然后，您基本上可以将许多不同的 SomethingModel 附加到 DropDowns、Grids 等的 SomethingsModel 视图或列表中。

当您添加 DataAnnotations 时，您的 ItemModel 的真正魔力将是，因为您使用的是 LabelFor，所以看起来您可能正在使用它。您还可以将 DataAnnotations 用于所需和更复杂的事情。

我们经常使用数据优先的实体框架，并通过复制粘贴 T4 自动生成的类作为SomethingModel 的起点来作弊。有很多方法可以加快这个过程。

# jquery - 如何为多选做加法？

> ID：15143701
> 
> 赞同：0
> 
> 时间：2013-02-28T19:10:14.460
> 
> 标签：jquery, html, select, onchange

我想使用 2 个选择来更改总价的值。

```
<span id="totalprice">$10</span>

<select id="upgrade1">
    <option value="10">A</option>
    <option value="20">B</option>
</select>
<select id="upgrade2">
    <option value="10">C</option>
    <option value="20">D</option>
</select> 
```

因此，例如选择 B 和 D，总价将反映 40 美元。

这是我到目前为止的 jQuery，但我不知道添加部分是什么......

```
$('#upgrade1, #upgrade2').on('change', function() {
    $('#totalprice').text($(this).val());
}); 
```

我如何做 jQuery 添加部分？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T19:17:05.450

您的下拉元素缺少结束标记 ( `</select>`)。请参阅下面的代码，并使用此 jsFiddle 来查看它的实际效果。[http://jsfiddle.net/3eVc6/](http://jsfiddle.net/3eVc6/)

**HTML：**

```
<span id="totalprice">$10</span>

<select id="upgrade1">
    <option value="10">A</option>
    <option value="20">B</option>
</select>
<select id="upgrade2">
    <option value="10">C</option>
    <option value="20">D</option>
</select> 
```

**JavaScript（包括 jQuery 库）**

```
$('#upgrade1, #upgrade2').on('change', function () {
    sum = Number($('#upgrade1').val()) + Number($('#upgrade2').val());
    $('#totalprice').html('$' + sum);
}); 
```

**感谢@Blazemonger 指出这`parseInt(val)`可能会导致解析问题（因为未指定基数）。我已将其替换为`Number()`**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T19:15:27.367

## HTML：

*一些小的更正 - 关闭选择语句*

```
<span id="totalprice">30</span>

<select id="upgrade1">
    <option value="10">A</option>
    <option value="20">B</option>
</select>
<select id="upgrade2">
    <option value="10">C</option>
    <option value="20">D</option>
</select> 
```

## Javascript（jQuery）：

*获取每个必填字段的值，通过`parseInt`转换为数字，并将它们相加*

```
$('#upgrade1, #upgrade2').on('change', function() {
  $('#totalprice').text("$"+parseInt($('#upgrade1').val())+parseInt($('#upgrade2').val()));
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T19:15:28.407

你已经很接近了。

```
$('#upgrade1,#upgrade2').on('change', function() {
    $('#totalprice').text("$" + (parseInt($('#upgrade1').val(),10) +
                                 parseInt($('#upgrade2').val(),10)) );
}); 
```

# javascript - 标题标签html内的sup标签

> ID：15143702
> 
> 赞同：4
> 
> 时间：2013-02-28T19:10:15.693
> 
> 标签：javascript, html

我需要注册商标作为工具提示中的上标。我尝试使用`sup`内部标题标签

```
<p title="Normal <sup>R</sup>hello">Hello World</p> 
```

但我`sup`在工具提示中看到。

如何确保 sup 标记被忽略并且 R 在工具提示中显示为上标。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-28T19:12:48.100

改为使用`&reg;`。你也可以只写`®`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-28T19:13:04.643

利用

```
<p title = "Normal &#174; hello">Hello</p> 
```

或者

```
<p title = "Normal &reg; hello">Hello</p> 
```

**奖励**：这是大多数[**HTML 实体的列表，分类和格式**](http://www.danshort.com/HTMLentities/)都很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T22:45:01.067

您不能在`title`属性中使用标记。

考虑分析您是否需要上标 R（*不是*注册商标标志），首先是否需要商标指示符，如果需要，为什么要将其放入可能会或可能不会被看到的属性中用户，通常不是。

# python - TraitsUI，共享对象

> ID：15143705
> 
> 赞同：0
> 
> 时间：2013-02-28T19:10:23.783
> 
> 标签：python, traits, enthought, traitsui

我正在使用 HasTraits 对象构建一个 gui。我有一个主要对象，然后是 gui 的每个组件的对象。我想跨多个组件共享一个对象。例如，我有一个主窗口**A**，其中包含组件**B**和**C**。**C** 需要访问**B**中的内容。目前我正在这样做

```
class B(HasTraits):
     ...

class C(HasTraits):
     ...

class A(HasTraits):
    b = Instance(B,())
    c = Instance(C)
    ...

def _c_default(self):
    return C(b = self.b,...)
    ... 
```

这似乎不是最好的方法。还有子子组件，所以**ACD**和**D**需要**AB**中的东西。

这是使用特征共享对象的最佳方式吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T09:17:19.397

这在一定程度上取决于用例，但您的建议看起来像是第一种方法。

一些评论：

1.  您可以收听 b 上的更改以确保 C 与 a 上的更改保持同步。
2.  您可以将 DelegatesTo 与 C 特征一起使用，以将某些 B 特征暴露给 C。

如果您在应用程序设计方面谈论更多，您可能会查看 Envisage 以及它如何使用服务和扩展点在可插入应用程序中正确共享对象。

例子 ：

```
class B(HasTraits):
    name = Str

class C(HasTraits):
     b = Instance(B)
     name = DelegatesTo(b)

class A(HasTraits):
    b = Instance(B,())
    c = Instance(C)
    ...

    def _c_default(self):
        return C(b = self.b,...)
        ...

    def _b_changed(self):
         self.c.b = b 
```

# javascript - Nodejs获取`required`模块的目录

> ID：15143709
> 
> 赞同：1
> 
> 时间：2013-02-28T19:10:35.090
> 
> 标签：javascript, node.js, require

是否可以确定`required`脚本来自的目录？

我的最终目标是...

```
// return the directory where `mysql` module is found
var mysqldir = requiredir('mysql')
if(fs.existsSync(mysqldir+"/README.md")){
  console.log(fs.readFileSync(mysqldir+"/README.md").toString())
} 
```

所以我可以对所有这些模块有一个方便的参考，希望未来的人们会包括打算以这种方式访问​​的模块文档/备忘单

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T19:31:53.260

[`required.resolve(...)`](http://nodejs.org/api/globals.html#globals_require_resolve)可能是您正在寻找的：

```
function requiredir(id) {
    return path.dirname(require.resolve(id));
} 
```

不过，这将遵循以下[`main`](https://npmjs.org/doc/json.html#main)设置：

```
> requiredir('grunt')
.../node_modules/grunt/lib/ 
```

（***更新****：API 的文档不再可用，因此可能不支持它的使用。*）另一个选择可能是使用`npm`'s `view`，尽管这仅限于已注册的包：

```
npm.load({}, function (err) {
    npm.commands.view(['mysql', 'readme'], true, function (err, readme) {
        console.log(readme);
    });
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-28T19:22:44.520

如果要确定模块的绝对路径，可以使用`require.resolve('module')`

[http://nodejs.org/api/globals.html#globals_require_resolve](http://nodejs.org/api/globals.html#globals_require_resolve)

您可以通过正则表达式提取文件夹路径

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-03-23T21:24:52.033

如果您想以编程方式了解 nodejs 正在使用的模块主目录，这是可行的

```
require.resolve('module_name').replace(/(.*node_modules.)(.*?)(\/)(.*)/, `$1$2`) 
```

# 例子

例如，如果您想知道`jquery`您在 nodejs 代码中使用的模块的模块主目录在哪里，第一部分

```
require.resolve('jquery') 
```

返回（在我的情况下）

```
/home/jfolpf/autocosts/node_modules/jquery/dist/jquery.js 
```

注意`jquery.js`不存放在模块主目录中；尽管如此

```
require.resolve('jquery').replace(/(.*node_modules.)(.*?)(\/)(.*)/, `$1$2`) 
```

返回

```
/home/jfolpf/autocosts/node_modules/jquery 
```

这考虑到要解析模块的路径，节点总是递归地寻找名为的文件夹`node_modules`，如[文档](https://nodejs.org/api/modules.html#modules_loading_from_node_modules_folders)中所示。

# jquery - jquery 验证插件来检查日期，但不是他们的占位符文本

> ID：15143711
> 
> 赞同：0
> 
> 时间：2013-02-28T19:10:40.580
> 
> 标签：jquery, validation, date, jquery-validate

我有占位符值的输入，例如：

```
<input type="text" name="mydate" value="yyyy-mm-dd"> 
```

如何更改我的规则以仅在值不是 "yyyy-mm-dd" 时才执行？

```
$(document).ready(function(){
   $("form.myclasstovalidate").validate({
       rules: {    
    mydate: {
            date: true
               }
       }
 }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T19:16:35.770

基本上你有一个问题，因为你的占位符文本只是输入框中的一个值，它“模仿”了占位符功能。您可能会在单击时将其删除，如果用户清空输入框的内容，则将其返回，当然进行验证调整以不将占位符验证为真实值等等......

[您可以使用 html5 的占位符](http://davidwalsh.name/html5-placeholder)属性代替上述所有内容；）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T20:07:05.910

无论出于何种原因，如果您不想使用该属性，您可以使用[插件的](http://docs.jquery.com/Plugins/Validation/Validator/addMethod#namemethodmessage)[方法](http://docs.jquery.com/Plugins/Validation/Validator/addMethod#namemethodmessage)`placeholder`创建自定义规则。即使 OP 采用了替代方法，这也是关于如何创建新规则的一个很好的教训。[`addMethod()`](http://docs.jquery.com/Plugins/Validation/Validator/addMethod#namemethodmessage)

由于您声明您只希望`date`在值为 not 时进行验证`"yyyy-mm-dd"`，因此我只是添加了一个条件，该条件检查输入的值与元素的[`defaultValue`](http://www.w3.org/TR/DOM-Level-2-HTML/html.html#ID-6043025)，并将默认`date`方法/规则代码放入其中。

```
jQuery.validator.addMethod("mydaterule", function (value, element) {
    if (value != element.defaultValue) {
        return this.optional(element) || !/Invalid|NaN/.test(new Date(value));
    } else {
        return true;
    }
}, 'please enter a valid date'); 
```

您可以根据需要进一步调整它。

应用新规则如下：

```
$('#myform').validate({
    rules: {
        mydate: {
            mydaterule: true
        }
    }
}); 
```

**演示：http: [//jsfiddle.net/Acew7/](http://jsfiddle.net/Acew7/)**

**重要说明**：`"yyyy-mm-dd"`不是满足默认`date`规则的正确格式。但是，`"yyyy/mm/dd"`会工作。

例如

*   2013-02-28`date`验证将失败
*   2013/02/28 将通过`date`验证

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T19:38:39.570

在您的标记中使用 placeholder 属性将解决您的问题，因为它不是实际值，而是真正的占位符并且可以正常工作。顺便说一句，您的 javascript 也有语法错误。我已经在我的回答中修复了它们。

```
<input type="text" name="mydate" placeholder="yyyy-mm-dd" />

$(document).ready(function(){
   $("form.myclasstovalidate").validate({
       rules: {    
    mydate: {
            date: true
               }
       }
    });
 }); 
```

# linq-to-entities - 尝试在扩展方法中创建 ObservableCollection 的异常

> ID：15143712
> 
> 赞同：1
> 
> 时间：2013-02-28T19:10:42.823
> 
> 标签：linq-to-entities, extension-methods, observablecollection

当我们使用 MVVM 时，我们在视图模型中使用了相当多的 ObservableCollections，为了节省一些输入，我认为拥有一个将 IEnumerable 直接转换为 ObservableCollection 的扩展方法会很有用，而不必创建一个新的 ObservableCollection每一次。

因此，而不是打字...

```
ObservableCollection fred = new ObservableCollection(myCollection); 
```

...我们可以输入...

```
ObservableCollection fred = myCollection.ToObservableCollection(); 
```

显然，在上面的人为示例中，这样做几乎没有什么好处，但在更大的 Linq 查询中，这可以清理代码。

无论如何，我写了一个像这样的简单扩展方法......

```
public static ObservableCollection<T> ToObservableCollection<T>(this IEnumerable<T> collection) {
  if (collection != null) {
    return new ObservableCollection<T>(collection);
  }
  throw new ArgumentNullException("collection");
} 
```

但是，当我尝试使用它时，我得到了一个例外......

LINQ to Entities 无法识别方法 'System.Collections.ObjectModel.ObservableCollection`1[VisionRT.CRM.Entities.SiteOverview] ToObservableCollection[SiteOverview](System.Collections.Generic.IEnumerable`1[VisionRT.CRM.Entities.SiteOverview] )' 方法，并且该方法不能翻译成商店表达式。

如果不是因为 ToList() 扩展方法做了完全相同的事情，但可以工作，我会理解这一点。

任何人有任何想法为什么我的方法失败，以及如何解决它？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T19:21:46.190

我认为问题在于您正在针对 enrity 框架运行查询。查询实际上是在 sql server 上运行的。因为那里不支持您的扩展方法（与列出相反），所以它失败了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T12:23:21.370

过去我遇到过类似的问题（尤其是使用 LINQ-to-Entities），一般的解决方案是使用[表达式树](http://msdn.microsoft.com/en-us/library/bb397951.aspx)在编译时构建 LINQ，而不是将其推迟到运行时。

你有没有试过这个：

```
public static ObservableCollection<T> ToObservableCollection<T>(this IEnumerable<T> collection)
{
    var observableCollection = new ObservableCollection<T>();

    foreach (var item in collection)
    {
        observableCollection.Add(item);
    }

    return observableCollection;
} 
```

我不知道这是否会有所作为，但值得一试。

**至于[omer schleifer 的回答](https://stackoverflow.com/questions/15143712/exception-trying-to-create-an-observablecollection-in-an-extension-method#15143926)：**

让 Entity Framework 允许扩展方法的一个例子是试图概括它的`dbContext.Set<T>`名字。而不是这样做：

```
dbContext.People.Where(p => p.Id == 1234); 
```

我希望能够做到这一点：

```
dbContext.Get<Person>(p => p.Id == 1234); 
```

此方法不起作用：

```
public static T Get<T>(this DapperDbContext dbContext, int id, string property = "Id") where T : class
{
    return dbContext.Set<T>().FirstOrDefault(t => (int)t.GetType().GetProperty(property).GetValue(t) == id);
} 
```

但是，这个确实有效：

```
public static T Get<T>(this DapperDbContext dbContext, int id, string property = "Id") where T : class
{
    var parameter = Expression.Parameter(typeof(T));
    var lambda = Expression.Lambda<Func<T, bool>>(Expression.Equal(Expression.Property(parameter, property)
        , Expression.Constant(id)), parameter);
    return dbContext.Set<T>().FirstOrDefault(lambda);
} 
```

您可能可以为您的场景做类似的事情。

希望这可以帮助。

# c# - 使用 SQLite 时，Fluent Nhibernate 是否会自动在所有 CreateSQLQuery 调用上设置外键约束？

> ID：15143715
> 
> 赞同：0
> 
> 时间：2013-02-28T19:10:48.647
> 
> 标签：c#, sqlite, nhibernate, fluent-nhibernate

所以我正在尝试升级 SQLite 数据库。我的升级需要我更改列数据类型。因此，我的思考过程是（我将调用表格`foo`）：

1.  创建一个`foo_temp`表。
2.  将 foo 中的旧数据插入`foo_temp`表中。
3.  放下旧`foo`桌子。
4.  将表更改`foo_temp`为 foo。

但是，由于外键约束，它在第 3 步失败。我已经尝试了从`PRAGMA foreign_keys = OFF;`在 drop 之前插入 a 到将 a 附加`foreign keys=false;`到连接字符串的所有方法。Fluent Nhibernate 似乎不会让我放弃这张桌子。当我配置“Fluently”连接时，也许有一个设置可以禁用？我似乎找不到它。

我注意到当我使用 UI 客户端（如 SQLiteSpy）时，删除表没有问题。这可能是什么原因造成的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T19:48:36.650

所以我想出了一个似乎可行的解决方案。使用我在这里找到的代码（归功于 ppiotrowicz）：

[在 nhibernate 中启用 SQLite 外键](https://stackoverflow.com/questions/5850331/enabling-sqlite-foreignkeys-in-nhibernate)

我基本上换掉并引用了那个驱动`PRAGMA foreign_keys = ON`程序`PRAGMA foreign_keys = OFF``SQLiteConfiguration.Standard.ConnectionString(cs).Driver<MyDriver>()`

# c# - 在 C# 中创建一个库类

> ID：15143720
> 
> 赞同：2
> 
> 时间：2013-02-28T19:11:14.477
> 
> 标签：c#, dll

我对此很陌生，我需要一些帮助来将方法转换为用作 dll 的库类。我的问题是如何处理用于获取从用户传入的数据的文本框值。

这是我正在使用的方法，并希望将其用作可用的库类：

```
public Microsoft.Office.Interop.Excel.Workbook excelWorkbook { get; set; }
    void ExcelToPdf(string convertFilePath)
    {
        Microsoft.Office.Interop.Excel.Application appWord = new Microsoft.Office.Interop.Excel.Application();
        excelWorkbook = appWord.Workbooks.Open(DocumentUNCPath.Text);

        excelWorkbook.ExportAsFixedFormat(XlFixedFormatType.xlTypePDF, convertFilePath);
        excelWorkbook.Close();
        appWord.Quit();
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T19:14:39.707

因此，当您将其移至库时，您将希望将这些值注入方法中：

```
public Microsoft.Office.Interop.Excel.Workbook excelWorkbook { get; set; }

void ExcelToPdf(string convertFilePath, string documentUncPath)
{
    Microsoft.Office.Interop.Excel.Application appWord = new Microsoft.Office.Interop.Excel.Application();
    excelWorkbook = appWord.Workbooks.Open(documentUncPath); // WAS DocumentUNCPath.Text

    excelWorkbook.ExportAsFixedFormat(XlFixedFormatType.xlTypePDF, convertFilePath);
    excelWorkbook.Close();
    appWord.Quit();
} 
```

因此，当您调用该方法时，您`DocumentUNCPath.Text`将从表单中传递 的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T19:16:14.960

如果我正确理解你的问题。

在 Visual Studio 中选择，文件 - 新建 - 项目 - 类库。将您的代码复制并粘贴到类中，应如下所示：

```
namespace ClassLibrary1
{
    public class Class1
    {
        public Microsoft.Office.Interop.Excel.Workbook excelWorkbook { get; set; }
        void ExcelToPdf(string convertFilePath)
        {
            Microsoft.Office.Interop.Excel.Application appWord = new Microsoft.Office.Interop.Excel.Application();
            excelWorkbook = appWord.Workbooks.Open(DocumentUNCPath.Text);

            excelWorkbook.ExportAsFixedFormat(XlFixedFormatType.xlTypePDF, convertFilePath);
            excelWorkbook.Close();
            appWord.Quit();
        }
    }
} 
```

构建应用程序，您将在输出 bin 文件夹中找到您的 dll。

# ruby - RSpec：字符串应该在数组中

> ID：15143723
> 
> 赞同：1
> 
> 时间：2013-02-28T19:11:32.957
> 
> 标签：ruby, rspec

我正在测试一个随机字符串生成器，它接受两个单词数组，然后从中选择随机单词。我需要能够测试它实际上是随机的。例如：

```
FrostyMeadow.generate(:nouns => ["hello", "world"], :adjectives => ["hello","world"] 
```

应生成以下字符串之一：

```
["hello world", "world world", "world hello", "hello hello"] 
```

有没有办法给 rspec 那个数组并检查生成的字符串是否在那里？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-28T20:58:45.007

随机性很难测试，但在您的情况下，您可以通过以下方式实现：

```
word = FrostyMeadow.generate(:nouns => ["hello", "world"], :adjectives => ["hello","world"]
["hello world", "world world", "world hello", "hello hello"].should include(word) 
```

# r - 如何格式化包含所有时间和 id 值记录的数据透视表？

> ID：15143725
> 
> 赞同：3
> 
> 时间：2013-02-28T19:11:37.347
> 
> 标签：r, reshape

我正在用 3 列在 R 中收集日志：
周、探测和观察次数。
没有观察就没有记录。

```
week=c(1,2,2,4)  
probe=c("A","C","B","C")  
obs=c(2,4,3,1)
logs=data.frame(week,probe,obs)

logs

week probe obs  
1     A   2
2     C   4
2     B   3
4     C   1 
```

我想重新格式化数据，使其包括所有周和所有探测，即使没有观察，它看起来像这样：

```
week probe obs  
1     A   2  
1     B   0  
1     C   0  
1     D   0  
2     A   0  
2     B   0  
2     C   3  
2     D   4  
3     A   0  
3     B   0  
3     C   0  
3     D   0  
4     A   0  
4     B   0  
4     C   1  
4     D   0 
```

我在这里有所有探针的列表：

```
allprobes=c("A","B","C","D") 
```

我想看看这几周：

```
allweeks=c(1:4) 
```

我一直在研究熔化、铸造、重塑，但我只能设法每个 id 或每月获得 1 行......因为我实际上想保留日志的原始格式。一开始似乎很容易，但我现在陷入困境......关于如何以这种方式格式化数据的任何建议？

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-28T19:17:18.567

基础 R 中的两个选项：

### 使用`expand.grid`和`merge`：

```
> fullFrame <- expand.grid(allweeks, allprobes)
> names(fullFrame) <- c("week", "probe")
> merge(fullFrame, logs, all = TRUE)
   week probe obs
1     1     A   2
2     1     B  NA
3     1     C  NA
4     1     D  NA
5     2     A  NA
6     2     B   3
7     2     C   4
8     2     D  NA
9     3     A  NA
10    3     B  NA
11    3     C  NA
12    3     D  NA
13    4     A  NA
14    4     B  NA
15    4     C   1
16    4     D  NA 
```

`expand.grid`将创建`data.frame`“allprobes”和“allweeks”对象的所有可能组合。然后，我们重命名该新的列以匹配使用时`data.frame`“日志”中的相关列。该参数告诉用 填充缺失值。`data.frame``merge``all = TRUE``merge``NA`

如果您想要零而不是`NA`，请执行以下操作：

```
fullFrame <- expand.grid(allweeks, allprobes)
names(fullFrame) <- c("week", "probe")
finalLogs <- merge(fullFrame, logs, all = TRUE)
finalLogs[is.na(finalLogs)] <- 0 
```

### `xtabs`将“week”和“probe”转换为因子后使用

如果您将“week”和“probe”转换为包含所有相关级别的因素，那么您可以简单地使用`xtabs`Wrapped in `data.frame`：

```
logs$week <- factor(logs$week, levels=c(1, 2, 3, 4))
logs$probe <- factor(logs$probe, levels=c("A", "B", "C", "D"))
data.frame(xtabs(obs ~ week + probe, logs))
#    week probe Freq
# 1     1     A    2
# 2     2     A    0
# 3     3     A    0
# 4     4     A    0
# 5     1     B    0
# 6     2     B    3
# 7     3     B    0
# 8     4     B    0
# 9     1     C    0
# 10    2     C    4
# 11    3     C    0
# 12    4     C    1
# 13    1     D    0
# 14    2     D    0
# 15    3     D    0
# 16    4     D    0 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-11-13T08:34:24.053

包中的`complete`函数`tidyr`是这个操作的一个很好的实用程序：

```
# get all the levels in the factor
logs$probe = factor(logs$probe, levels = allprobes)
logs$week = factor(logs$week, levels = 1:4)

tidyr::complete(logs, week, probe, fill = list(obs = 0))
# # A tibble: 16 × 3
#      week  probe   obs
#    <fctr> <fctr> <dbl>
# 1       1      A     2
# 2       1      B     0
# 3       1      C     0
# 4       1      D     0
# 5       2      A     0
# 6       2      B     3
# 7       2      C     4
# 8       2      D     0
# 9       3      A     0
# 10      3      B     0
# 11      3      C     0
# 12      3      D     0
# 13      4      A     0
# 14      4      B     0
# 15      4      C     1
# 16      4      D     0 
```

# javascript - Bootstrap 侧边栏导航记住展开的项目

> ID：15143728
> 
> 赞同：0
> 
> 时间：2013-02-28T19:11:45.537
> 
> 标签：javascript, jquery, cookies, twitter-bootstrap

我有一个带有嵌套可折叠链接的引导侧边栏。每个链接当然会在单击时重新加载页面，这会导致菜单折叠。我想知道是否有办法让侧边栏导航在页面加载之间保持扩展。这样用户就不必在浏览时一遍又一遍地扩展相同的项目。

从我到目前为止所读到的内容来看，显然有一种方法可以使用 cookie 来做到这一点，但我完全不知道如何实现它。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T19:57:26.870

查看这个 SO 问题，了解有关如何使用 jQuery 实现 cookie 的一些想法： [如何使用 jQuery 设置/取消设置 cookie？](https://stackoverflow.com/questions/1458724/how-to-set-unset-cookie-with-jquery)

您可以将此 jquery 插件用于 cookie： [https ://github.com/carhartl/jquery-cookie](https://github.com/carhartl/jquery-cookie)

使用上面的内容，您可以设置一个带有菜单显示/隐藏状态的 JSON 对象，可以读回：

```
$.cookie.json = true;
var sidebarstate = '[ {Item: "blah", expand: true}, {Item: "2", expand: false}]';
$.cookie('sidebar', sidebarstate );
...

var sidebar = $.cookie('sidebar');
alert('sidebar: ' + sidebar); 
```

# php - 如何检查字符串是否存在于字符串数组中

> ID：15143731
> 
> 赞同：1
> 
> 时间：2013-02-28T19:11:48.370
> 
> 标签：php

我将数据存储在一个字符串中：例如`$string='12';`
'12'代表2条数据，`1`并且`2`

在 3 列中，我存储了相同的 id，数组显示为：

```
ex1: $array= ('num1' => 1, 'num2' => 2, 'num3' => )
ex2: $array= ('num1' => 5, 'num2' => 4, 'num3' => 3) 
```

如果两个地方都存在数字，我如何比较这些并返回 true？

例如：使用上面的示例：对于 ex1： `12`将`return TRUE`

`34`会`return FALSE` 为 ex2: `345`会`return TRUE`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T19:21:07.703

尝试 in_array() 函数 [http://php.net/manual/en/function.in-array.php](http://php.net/manual/en/function.in-array.php)

但我不明白为什么 345 会返回 true

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T19:17:58.683

试试这个：你可以使用**array_intersect** ()。

```
$string = '12';

//split string into array of characters
$arr = str_split($string);

//testing columns
$compare1 = array('num1' => 1, 'num2' => 2, 'num3' => '');
$compare2 = array('num1' => 5, 'num2' => 4, 'num3' => 3);

//returns an array containing all the values of $arr inside $compare1
$int1 = array_intersect($arr, $compare1);

//returns an array containing all the values of $arr inside $compare2
$int2 = array_intersect($arr, $compare2);

//if $arr contents are in $compare1 return true, otherwise false
echo ! empty($int1);

//if $arr contents are in $compare2 return true, otherwise false
echo ! empty($int2); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-28T20:28:45.457

**这行得通，请参见下面的结果：（值必须存在于两个数组中才能返回 true。**

```
 $result = true;
    $string1 = '43';
    $string = str_split($string1);
    $example1 = array('num1' => 1, 'num2' => 2, 'num3' => 3,  'num4' => 4, 'num5' => 5);
    $example2 = array('num1' => 5, 'num2' => 4, 'num3' => 3);
    foreach ($string as $st) {
        if((in_array($st, $example1) && in_array($st, $example2))  && $result == true){
            $result = true; //true
        } else {
            $result = false;
        }
    }
    if($result == true){
            echo 1; //true
        } else {
            echo 0; //false
        }
    exit;
    //Test Results:
    //$string1 = '12'; //result 0
    //$string1 = '34'; //result 1
    //$string1 = '55'; //result 1
    //$string1 = '43'; //result 1 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-28T23:07:53.453

我参加聚会迟到了……但我已经开始了，所以也可以！这是我的解决方案：

```
function yayOrNay($array, $string) {

    $stringArray = str_split($string);

    $arrayDiff = array_diff($stringArray, array_values($array));

    return empty($arrayDiff);
} 
```

`**[LIVE DEMO](http://codepad.org/Ymw9fbdc)**`

# hibernate - 使用条件进行子查询

> ID：15143732
> 
> 赞同：2
> 
> 时间：2013-02-28T19:11:55.437
> 
> 标签：hibernate, criteria, hibernate-criteria, detachedcriteria

我的数据库中有两个表，Tuser 和 TCompany，
其中

```
Tuser : id | name | email  
Tcompany : id | companyName | userId 
```

其中 userId 是 Tuser 表的外键。

我写了一个查询来获取所有名称以 a 开头的用户

```
Criteria criteria = ctx.getSession().createCriteria(Tuser.class);  
criteria.add(Restrictions.like("name", "a%"));  
List res = criteria.list() 
```

现在我需要获取所有不属于公司的用户。
在 sql 中，我们可以使用子查询，但我不知道它是如何使用标准完成的？

# java - 使用 FloatMath 或 Math 和演员表？

> ID：15143735
> 
> 赞同：36
> 
> 时间：2013-02-28T19:11:58.547
> 
> 标签：java, android, floating-point, double, android-lint

在 Android API 的最新更新中，[`FloatMath`](http://developer.android.com/reference/android/util/FloatMath.html)标记有以下 lint-warning：

> 在旧版本的 Android 中，出于性能考虑，建议在浮点数上使用 android.util.FloatMath。然而，在现代硬件上，double 与 float 一样快（尽管它们占用更多内存），并且在最新版本的 Android 中，由于 JIT 优化 java.lang.Math 的方式，FloatMath 实际上比使用 java.lang.Math 慢. 因此，如果您只针对 Froyo 及更高版本，则应使用 Math 而不是 FloatMath。

[这里](http://developer.android.com/training/articles/perf-tips.html#AvoidFloat)还提到，double 和 float 在最近的硬件上速度相等。

我在我目前正在处理的应用程序中使用了一些三角数学（针对 Froyo 及更高版本），但不需要高精度，`FloatMath`所以到目前为止我一直在使用浮点数，并且不需要切换到双精度数。
但是，“use `Math`over `FloatMath`”-recommendation 并没有说明如果 float 是所需的结果，则使用哪一个。

所以，简而言之；哪个更可取？

```
float foo = FloatMath.sin(bar); 
```

或者

```
float foo = (float) Math.sin(bar); 
```

*顺便说一句，我只有一个 Froyo 设备，所以我不能自己做任何适当的基准测试。*

**从 API 级别 22 开始，FloatMath 类已被弃用，取而代之的是常规的 Math 类。**

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-09-04T18:06:27.297

从下面的结果可以看出，使用 java.lang.Math 处理浮点数比使用双精度数更快，并且比 FloatMath 更快。此外，在 API 级别 17 之前，FloatMath 没有 .exp() 或 .pow()。

在三星 GT_i9295 (4.2.2) 上，2^24 个周期

```
Math.exp(D)      Total:     7405 ms,     Per Op: 0.0004414 ms
(F)Math.exp(F)   Total:     5153 ms,     Per Op: 0.0003071 ms
FloatMath.exp(F) Total:     8533 ms,     Per Op: 0.0005086 ms 
```

三星上没有 Math.sin 的数据，因为它随机决定忽略 Log.d() >:(

在 HTC Hero_HT99VL (2.3.7) 上，2^12 个周期

```
Math.sin(D)      Total:       42 ms,     Per Op: 0.0102539 ms
(F)Math.sin(F)   Total:       33 ms,     Per Op: 0.0080566 ms
FloatMath.sin(F) Total:       38 ms,     Per Op: 0.0092773 ms

Math.exp(D)      Total:       56 ms,     Per Op: 0.0136719 ms
(F)Math.exp(F)   Total:       47 ms,     Per Op: 0.0114746 ms 
```

FloatMath.exp()、.pos() 和 .hypot() 需要 API 级别 17

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-28T19:26:11.430

[文档`FloatMath`](http://developer.android.com/reference/android/util/FloatMath.html)说：

> 数学例程类似于数学中的例程。**直接对浮点值执行计算，**而不会产生与 double 之间的转换开销。

你的报价说：

> **在浮点数上操作时，**出于性能原因，建议使用 android.util.FloatMath

 **据推测， 的好处`FloatMath`总是专门针对您想要 a 时的`float`，但现在这种好处已被否定。

所以使用：

```
float foo = (float) Math.sin(bar); 
```

还要考虑到，如果性能如此关键以至于您需要担心这一点，那么也许切换到`double`毕竟是有道理的（因为不会产生转换成本）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-15T17:12:35.370

我最近只是在研究同样的问题，并发现了这个关于该问题的[错误报告](https://code.google.com/p/android/issues/detail?id=36199)。这些`Math`函数的性能比`FloatMath`那些函数高出一个数量级，如下面的引用所示：

> 使用 DDMS，我分析了有问题的代码。下面的每个函数都被调用了 100 倍以上。

```
 Name                 | Cpu Time / Call
----------------------------------------------
java/lang/Math.sin (D)D     | 0.005
java/lang/Math.cos (D)D     | 0.007
java/lang/Math.sqrt (D)D    | 0.004
android/util/FloatMath.sin  | 0.017
android/util/FloatMath.cos  | 0.017
android/util/FloatMath.sqrt | 0.016 
```

如果您遵循AOSP 树中的[文档更改，您会](https://android-review.googlesource.com/#/c/52224/)[在此处](https://android-review.googlesource.com/#/c/52224/1/core/java/android/util/FloatMath.java)看到`Math`函数优先于`FloatMath`具有 JIT 的 android 版本，这基本上是 Froyo (2.2) 及更高版本的任何内容。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-28T19:40:56.580

如果性能如此重要，那么您可能不想在`double`每次计算某些东西时浪费时间与 s 进行转换。

据我了解，在较旧的硬件上，浮点数比双精度更快，因此您需要一个用于浮点数的数学库。现在，“*在现代硬件上，双精度与浮点数一样快*”，因此您应该使用`Math`带双精度的默认值。

如果值是浮点数对您的应用程序很重要（例如，因为内存消耗），您应该继续使用 FloatMath，因为`float foo = (float) Math.sin(bar);`如果您经常使用它会变得烦人。**

# html - 我想制作一个将在许多页面中使用的按钮

> ID：15143738
> 
> 赞同：-2
> 
> 时间：2013-02-28T19:12:12.047
> 
> 标签：html, css, class, button, dreamweaver

我有一堆图片，我想用 3 个按钮制作一系列页面：返回、下一步和主页。反正有没有使用类来完成这个？我试了一下，结果是这样的：
HTML

```
<div id = "back" class="btn_back"> 
```

CSS

```
.btn_back {
background-color:#C00; 
display:block; 
width:110px; 
height: 20px; 
text-align:center, justify; } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T19:21:12.507

好吧，你有你的按钮！恭喜...现在尝试实际使用后退和前进按钮。您可以使用 html 和 javascript 的组合。

在 HTML 中，您可以将链接设置为“下一个”和“上一个”。然而，所有这些都是将页面链接在一起，通常用于博客。您需要使用 javascript 来动态更新每个按钮在单击时的作用。

HTML 示例：

```
<link rel="next" href="next_page.html">
<link rel="prev" href="prev_page.html"> 
```

JavaScript 示例：

```
var back = document.getElementsById("back")[0];
var next = document.getElementsById("next")[0];
back.onClick = function() { window.location = 'prev_page.html' }
next.onClick = function() { window.location = 'next_page.html' } 
```

但是，请注意，我提供的 HTML 和 Javascript 示例彼此不相关。但是您可以将 设置为由和`window.location`的值定义的变量。到这个时候，你可以在谷歌上搜索如何做到这一点。`link next``link prev`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T19:21:10.467

要向前和向后访问，您需要 DOM 控制。你可以通过javascript来做到这一点。或者，您可以独立链接每个页面，返回将您带到上一页，然后将您带到看不见的页面。

说这是第 2 页

```
<a href="1.html">Back</a>
<a href="home.html">Home</a>
<a href="3.html">Forward</a> 
```

您的问题并不容易回答，因为有很多方法可以完成您的要求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T19:18:03.627

这绝不是一个动态的答案，但它适用于初学者。以下假设您在第 3 页。

*   以前的
*   家
*   以前的

CSS：

ul li { display: inline-block; }

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-28T19:18:10.317

您发布的代码没有（功能上）错误。你还记得包含你的样式表吗？如果该功能不起作用，那将是一个`javascript`问题，不是`CSS`，我们需要查看您当前的`javascript`代码。

# gdb - 使用 libtool e gdb

> ID：15143739
> 
> 赞同：4
> 
> 时间：2013-02-28T19:12:21.737
> 
> 标签：gdb, autotools, libtool

我正在开发一个使用 GNU autotools 的项目，因此为了使用 gdb 调试代码，我在 libtool 中运行 gdb：

```
libtool --mode=execute gdbtui foobar 
```

是否可以重新加载项目的修改版本而不必退出 gdb/libtool 并重新启动？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-06-05T19:03:22.160

`libtool --mode=execute`创建一个传递给 gdb 的临时可执行文件。此可执行文件在重建时被删除。诀窍是用类似的东西重新创建它

```
libtool --mode=execute echo ./hello 
```

（Libtool 将重新创建临时可执行文件并将其名称传递给`echo`命令。您可以使用任何其他命令代替`echo`，例如`true`抑制输出，甚至是不存在的输出。）

要重新加载可执行文件，请使用 gdb[`file`*`filename`*](https://sourceware.org/gdb/current/onlinedocs/gdb/Files.html#index-file)命令文件。启动时gdb显示可执行实名：

```
$ libtool --mode=execute gdb --args ./hello
...
Reading symbols from /path/to/.libs/lt-hello...done.
(gdb) 
```

它也由 gdb[`info inferiors`](https://sourceware.org/gdb/current/onlinedocs/gdb/Inferiors-and-Programs.html#index-info-inferiors)命令显示：

```
(gdb) info inferiors 
  Num  Description       Executable        
* 1    <null>            /path/to/.libs/lt-hello 
```

当然，通过上述`echo`命令。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T19:48:58.513

很难辨别你到底在问什么，但我希望我能正确理解你。

是的，您通常可以从内部再次运行已调试的命令`gdb`，只要它是首先启动`gdb`的。事实上，这是`gdb`. 在一个窗口/选项卡/窗格中使用它来调试你的东西并在另一个中修复代码，在第三个中重建等等。

一种`gdb`开始的方法是：

```
# gdb --args command arg1 arg2 ... 
```

另一个是：

```
# gdb command 
```

在后一种情况下，无论如何您只能像这样从 gdb 提示符启动程序。

```
(gdb) run arg1 arg2 ... 
```

在前者中，参数是*隐含*的（并被 记住`gdb`）。无论哪种情况，您都可以在事后使用以下方法检索参数：

```
(gdb) show args 
```

一旦你遇到、分析和修复了一个错误，重新运行它`run`（它重用以前的参数）并验证修复或继续调试另一个问题，这是很常见的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-05-31T22:16:56.260

根据@Ilia 的回答（以及[关于](https://stackoverflow.com/questions/62105922/gdb-set-variable-using-pipe-and-awk)如何将可执行文件名称解析为 gdb 变量的回答），解决方案是在以下位置定义以下`custom make`命令`~/.gdbinit`：

```
define lmake
  python gdb.execute('set $f = "' + str(gdb.selected_inferior().progspace.filename) + '"')
  make
  eval "file %s", $f
end 
```

# sql-server - 从 Excel 执行存储过程，该存储过程本身会生成动态代码并执行它

> ID：15143741
> 
> 赞同：0
> 
> 时间：2013-02-28T19:12:30.330
> 
> 标签：sql-server, excel, tsql, stored-procedures

我生成了一个 SQL 查询，该查询生成一个 SQL 查询并执行它。

我希望在视图或 Excel 中将此查询提供给不使用 SQL Server Management Studio 的用户。

我发现[了几个](http://codebyjoshua.blogspot.de/2012/01/get-data-from-sql-server-stored.html) 描述如何从 Excel 运行存储过程的[博客文章。](http://blogs.office.com/b/microsoft-excel/archive/2010/06/07/running-a-sql-stored-procedure-from-excel-no-vba.aspx)

可悲的是，它们不适合我。

这里是存储过程的查询/SQL：

```
DECLARE @template nvarchar(1000)
DECLARE @script nvarchar(max)
DECLARE @dbname nvarchar(max)
DECLARE c CURSOR FOR
select name from  master.sys.databases
WHERE name LIKE '%REPORTING'
OPEN c

SET @template = 'SELECT 
    ''CUSTOMER_PLACEHOLDER'' AS Customer
      ,rd.[ReportName]        
      ,min(ri.RenderingStart) AS FirstRequest
      ,max(ri.RenderingEnd) AS LastRequest
      ,count(ri.ReportInstanceGUID) AS TimesRendered
  FROM [DBNAME_PLACEHOLDER].[dbo].[ReportDefinition] rd
  LEFT JOIN DBNAME_PLACEHOLDER.dbo.ReportJob rj ON rj.ReportDefinitionGUID = rd.ReportDefinitionGUID
  LEFT JOIN DBNAME_PLACEHOLDER.dbo.ReportInstance ri ON ri.ReportJobGUID = rj.ReportJobGUID
  GROUP BY rd.ReportName'

SET @script = ''

FETCH NEXT FROM c INTO @dbname

DECLARE @first bit
SET @first = 1

WHILE @@FETCH_STATUS = 0
BEGIN   
    DECLARE @customer nvarchar(6)

    SET @customer = SUBSTRING(@dbname,14,6)
    IF @first = 1
        BEGIN
            SET @script = @template
            SET @first = 0
        END
    ELSE
        --SET @script = @script+'
        --UNION ALL
        --'+@template

    SET @script = REPLACE(@script,'CUSTOMER_PLACEHOLDER', @customer)
    SET @script = REPLACE(@script,'DBNAME_PLACEHOLDER', @dbname)

    FETCH NEXT FROM c 
    INTO @dbname

END
    EXEC (@script)
CLOSE c
DEALLOCATE c 
```

该`ELSE`部分已被注释以在 Excel 中查看错误。

查询会在这样执行时运行。

在 Excel 中调用它时，出现以下错误（以管理员身份启动 Excel 时已验证同样发生）：

![错误图片](../Images/9deb73ce74a6cbd4cee51fd63d480b43.png)

我不知道从哪里继续。表值函数也不起作用，因为它们中不允许执行 EXEC。如果可能的话，我想保留动态部分，因为数据库的数量和名称可能会发生变化 - 我想保持它不具体。

提示？

# pointers - 将指向设备 __constant__ 内存的指针传递给内核，而不是直接使用

> ID：15143746
> 
> 赞同：0
> 
> 时间：2013-02-28T19:12:47.977
> 
> 标签：pointers, memory, cuda, constants

我在带有 gcc 4.6 的 ubuntu 12.10 上使用 CUDA 5.0 和 GTX 670，并且我编写了一个名为 Grid 的类：

[https://github.com/benadler/octocopter/blob/master/basestation/grid.cu](https://github.com/benadler/octocopter/blob/master/basestation/grid.cu)

[https://github.com/benadler/octocopter/blob/master/basestation/grid.cuh](https://github.com/benadler/octocopter/blob/master/basestation/grid.cuh)

Grid-class 正在其他两个类中使用：

*   点云cuda
*   粒子系统

现在我想在pointcloudcuda和particlesystem的内核中使用Grid的（非静态）方法，即使它们将使用不同的网格（具有不同值的不同网格对象）。因此，对于我使用 Grid 的所有类，我有两个选择：

1）我只是做

```
Grid hostGrid(...);
cudaMalloc(gridOnDeviceGlobal, sizeof(Grid))
cudaMemcpy(gridOnDeviceGlobal, &hostGrid, sizeof(Grid), cudaMemcpyHostToDevice)
cloudKernel<<< numBlocks, numThreads >>>(someDate, gridOnDeviceGlobal); 
```

这很简单，但是内核必须从全局内存中读取网格值。这可能很慢。

2）由于网格值很少改变，我放了一个

```
__constant__ Grid myGridForPointCloudCuda 
```

进入pointcloudcuda.cu，连同两个函数

```
void copyParametersToGpu(Grid *hostGrid)
{
    cudaMemcpyToSymbolAsync(myGridForPointCloudCuda, hostGrid, sizeof(Grid))
}

void getDevicePointerOfGridForPointCloudCuda(Grid** ptr)
{
    cudaGetSymbolAddress((void**)ptr, myGridForPointCloudCuda);
} 
```

现在，在 pointcloudcuda.cpp 中，我可以

```
Grid hostGrid(...);
copyParametersToGpu(&hostGrid);
Grid* gridOnDeviceConstant;
getDevicePointerOfGridForPointCloudCuda(&gridOnDeviceConstant);
cloudKernel<<< numBlocks, numThreads >>>(someDate, gridOnDeviceConstant); 
```

在我看来，2) 的优点是可以更快地访问内核中的常量内存。但是，在其他地方，我读到这不起作用，因为编译 CUDA 内核的编译器在编译时不知道传递的网格指针是指向全局内存还是常量内存，因此必须使用较慢内存获取指令。

在 Geforce GTX 670 上 2) 会比 1) 快吗？

有没有更好的方法来做我想做的事？我只需要将不同的网格实例传递给内核。在我开始使用多个网格实例之前，一个常量变量是一个舒适且快速的选择。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T21:13:36.937

如果您有多个 Grid 实例而不是简单地在常量内存中分配一个 Grid Array，请将 Grid 实例复制到该数组中，并在调用内核时将一个索引传递给 Grid Array，而不是指向特定 Grid 实例的指针。在内核内部使用索引来访问特定的 Grid 实例。

# javascript - 我正在尝试使用 onclick 事件在循环内定义一个函数，但它不像我预期的那样工作。我应该怎么做？

> ID：15143750
> 
> 赞同：3
> 
> 时间：2013-02-28T19:12:50.217
> 
> 标签：javascript, function, loops

我正在尝试使用 javascript 为 html 页面中的 div 添加边框。我似乎无法使用 onclick 事件来做到这一点。这是我的 JavaScript：

```
var attacker = document.getElementsByClassName('attacker');
for (var i = 0; i < attacker.length; i++) {
attacker[i].onclick = function() {
    attacker[i].style.border = "3px solid blue";
}}; 
```

这是我的html：

```
<div  class="attacker">
  <img src="img/'.$race2.'/'.$units2[$i].'.jpg" />
  <div class="hp"></div>
</div> 
```

当我通过输入attacker[0].style.border =“3px solid blue”更改添加边框时；直接进入javascript它正在工作，但是当我使用onclick事件时它说我无法设置未定义的属性。知道我哪里出错了吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-28T19:16:21.093

这是因为`i`没有被关闭，所以该`.onclick`函数将始终`i`用作列表的长度`.attacker`+ 1。有几种解决方案，但我最喜欢的是迭代节点列表，`.forEach`以便自动关闭：

```
Array.prototype.forEach.call(document.getElementsByClassName('attacker'),
function (elem) {
    elem.addEventListener('click', function () {
        this.style.border = "3px solid blue";
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T19:17:22.227

这里提出了一个解决方案：

*   [http://jsfiddle.net/XjKEj/](http://jsfiddle.net/XjKEj/)

`this`在您的匿名函数中使用，而不是`attacker[i]`，因为它在该函数范围内不可用。

# c# - Excel不插入前导零

> ID：15143753
> 
> 赞同：2
> 
> 时间：2013-02-28T19:12:59.043
> 
> 标签：c#, openxml, openxml-sdk, spreadsheetml

我正在使用 Office OpenXml 写入 Excel 文件。该文件是一个模板，因此它已经包含了我所有的标题和列的格式。我正在将前导零的数字插入“特殊”列，该列基本上是一个 10 位数字。但是在我的代码中，我可以看到它正在将值设置为 example `0000000004`。工作表中的结果，`4`该单元格中的值为 ，实际单元格显示`0000000004`。

这是我写入单元格的代码。

```
 if (reader[2].ToString().Length < 9)
  {

        myworksheet.Cell(firstrow, 12).Value = reader[2].ToString(); //0045678945

  }
  else
  {
        myworksheet.Cell(firstrow, 12).Value = reader[2].ToString().Substring(0, 9); //0045678945

  } 
```

当我像上面所说的那样打开 excel 表时，我的值`45678945`是`0045678945`

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-28T19:30:16.583

获得所需结果的最简单方法是在单元格中输入的值前面加上撇号 - 这告诉 Excel 它是一个字符串：

```
Cell.Value= "'" & "000123" 
```

将显示为`000123`

这里有一些代码来展示事情是如何工作的（至少它们对我来说是如何工作的，在 Excel 2010 中）：

```
Sub testFormat()
[A1].Value = "000123"
[A2].Value = "'000123"
[A3].Value = "000123"
[A3].NumberFormat = "@"
[A4].Value = "'000123"
[A4].NumberFormat = "@"
End Sub 
```

结果如下：

![带前导零的格式](../Images/5720b1b11b2718d4a0d4ad9c046c323e.png)

如您所见，有三个单元格显示前导零：

1.  我在其中输入带有撇号的字符串的单元格
2.  使用`"@"`(="text") 格式格式化的单元格
3.  具有撇号和文本格式的单元格

我不确定你做了什么让撇号出现在你的电子表格中......但我希望以上内容能激励你解决你的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T19:19:46.793

如果我理解正确：

Excel 显示带有前导零的数字，通过 OOXML 从 C# 读取它们，您看不到前导零。

Excel 可能会设置一些格式规则，而不是存储实际的前导零。

有几种方法可以抵消这一点。以下是想到的“最便宜”的，选择一个：

*   将 Excel 中的列格式化为文本
*   在 C# 代码中不要期望前导零，而是添加它们

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T19:20:23.570

为了不从 Excel 中截断前导零，您需要将单元格的数字格式设置为`Text`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-03T14:05:34.630

我相信如果您将单元格的 DataType 设置为 String 或 SharedString ，则会保留前导 0。Excel 会将其视为文本并仅按字面意思处理该值，而不尝试应用任何格式规则。

```
cell.DataType = new EnumValue<CellValues>( CellValues.SharedString ); 
```

或 cell.DataType = new EnumValue( CellValues.String );

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-01-16T06:15:12.793

如果您使用的是 DataTable，则需要获取另一个 DataTable，然后您需要遍历数据表中的整个单元格，并在单元格文本前面加上空格，即使用“ ”；我们不能修改同一个表中的行，因为它会抛出一个异常说“集合已修改”。我们必须采用一个新的数据表。

考虑以下代码。

```
 //To get the result with leading zero's in excel this code is written.
    DataTable dtUpdated=new DataTable();
    //This gives similar schema to the new datatable
    dtUpdated = dtReports.Clone();
        foreach (DataRow row in dtReports.Rows)
        {
            for (int i = 0; i < dtReports.Columns.Count; i++)
            {
                string oldVal = row[i].ToString();
                string newVal = "&nbsp;"+oldVal;
                row[i] = newVal;
            }
            dtUpdated.ImportRow(row); 
        } 
```

我们可以将此更新后的表格绑定到数据网格，以便它可以用于 Excel 转换。

# text - JavaFX 文本构造函数与重定位

> ID：15143760
> 
> 赞同：1
> 
> 时间：2013-02-28T19:13:12.717
> 
> 标签：text, javafx-2, placement

在自定义 JavaFX UI 控件中，我想在控件的角落放置一些文本。这是我的 Skin 类的源代码：

```
double width = control.getWidth();
double height = control.getHeight();

Text test1Text = new Text(0, 0, "top left");
Text test2Text = new Text(0, height-1, "bottom left");
Text test3Text = new Text("top right");
test3Text.relocate(width - test3Text.getLayoutBounds().getWidth(), 0);
Text test4Text = new Text("bottom right");
test4Text.relocate(width - test4Text.getLayoutBounds().getWidth(), height-1); 
```

不幸的是，无论我是在给定坐标处构造文本，还是在没有坐标的情况下构造文本并在之后将其重新定位，这似乎都会有所不同：

*   在第一种情况下，构造函数中的坐标将是文本的左下角坐标。
*   在第二种情况下，给定的坐标将是左上角的坐标。

对于这种奇怪的行为有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T13:52:51.900

`Text`正在从 (0,0) 位置向右和向上绘制。例如，如果您创建`new Text("Hello")`并要求它边界，您将看到它们的垂直坐标为负`[minX:0.0, minY:-12.94921875]`

恕我直言，下一个原因是：`Text`在控件中绘制，他们更关心文本的基线。想象一下带有文本“water”和“Water”的 2 个按钮——你真的希望它们与基线对齐，而不是左上角：

![在此处输入图像描述](../Images/74527619d76c86533491291699bfb2e7.png)

`relocate()`另一方的方法使用常规`Node`的 s 并操作总是为左上角计算的布局。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T20:02:06.867

由于 JavaFX 的大部分部分都是开源的，因此这里是 (JavaFX 8)
[javafx.scene.text.Text](http://hg.openjdk.java.net/openjfx/8/master/rt/raw-file/eb8fe386f751/javafx-ui-common/src/javafx/scene/text/Text.java)和[javafx.scene.Node](http://hg.openjdk.java.net/openjfx/8/master/rt/raw-file/5badf4a1d5b3/javafx-ui-common/src/javafx/scene/Node.java)的代码。
我无法深入研究，但很明显`Text constructor`and`Node#relocate()`正在做不同的事情：
Text constructor

```
public Text(double x, double y, String text) {
    this(text);
    setX(x);
    setY(y);
} 
```

节点#relocate()

```
public void relocate(double x, double y) {
        setLayoutX(x - getLayoutBounds().getMinX());
        setLayoutY(y - getLayoutBounds().getMinY());

        PlatformLogger logger = Logging.getLayoutLogger();
        if (logger.isLoggable(PlatformLogger.FINER)) {
            logger.finer(this.toString()+" moved to ("+x+","+y+")");
        }
} 
```

这都是我的想法，对不起。

# c# - 在 ASP.NET(VB/C#) 中扩展 XML 注释片段

> ID：15143761
> 
> 赞同：1
> 
> 时间：2013-02-28T19:13:18.923
> 
> 标签：c#, asp.net, vb.net, visual-studio-2012, xml-comments

我正在尝试扩展默认的 XML 注释片段。经过一番研究，我发现了生成此 xml 的文件名是什么——VBXMLDoc.xml。但是，我无法在我的系统上找到它。我正在使用 VSTS 2012。对于 2010，看起来它将位于 C:\Users\AppData\Roaming\Microsoft\VisualStudio\10.0

但是，我找不到它。请在 2012 年告诉我，如何扩展自动生成的 XML 注释片段（''' 是快捷键）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T19:28:25.697

您需要先创建它并将其保存在我认为与 vs2010 相同的文件夹中。请参阅：http: [//blogs.msdn.com/b/lisa/archive/2010/05/25/how-to-customize-the-xml-comments-that-are-inserted-by-the-visual-basic-代码编辑器.aspx](http://blogs.msdn.com/b/lisa/archive/2010/05/25/how-to-customize-the-xml-comments-that-are-inserted-by-the-visual-basic-code-editor.aspx)

# c# - 使用 Google GData API 更新联系人时服务器上的奇怪修改时间

> ID：15143766
> 
> 赞同：0
> 
> 时间：2013-02-28T19:13:29.020
> 
> 标签：c#, web-services, rest, google-api, gdata-api

我正在尝试为 Google 联系人开发一个同步工具，但是我看到了一些奇怪的行为。

简而言之，这是我的问题：

我发送请求以修改联系人`X`。
该请求将采取`X+1ms.`
snycing 的整个过程`X+2ms`。
我将更新我的时间戳`X+2ms`。
无论出于何种原因，我修改的联系人都显示了上次修改的时间戳，`X+20ms`因此在下一次同步期间被发送回另一个方向。坏的。

我正在使用的 Google GData .NET 库是同步的，因此在以太中并没有根本没有完成的调用。

这是请求/响应/和呼叫时间的粘贴箱。

[http://pastebin.com/Bw01S3C0](http://pastebin.com/Bw01S3C0)

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T19:35:59.007

有一个鲜为人知的一阶*狭义相对论*效应限制了多个时钟在地球表面的同步程度。两个时钟可以精确地相互同步，但三个或更多时钟不能比大约 4 或 5 毫秒更精确地同步（如果我从第 3 年物理中正确回忆了这个数字）。虽然大多数狭义相对论效应是光速 c 的 2 阶或 3 阶，但这是 c 的一阶，因此很容易用现代硬件检测到。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T19:28:35.413

不，你不是。尽管事实上我一直将我的系统时钟同步到同一台服务器，但发出这些调用的 VPS 似乎落后了 20 秒。早该了解我的。

我注意到响应的标题也提前了 20 秒，因此它不是特定于修改时间。

呃。

# c# - 捆绑和缩小问题

> ID：15143767
> 
> 赞同：2
> 
> 时间：2013-02-28T19:13:32.010
> 
> 标签：c#, asp.net, asp.net-mvc-3, webgrease

我正在尝试使用 asp.net**捆绑和缩小**功能。问题是当我在包中包含 jquery ui 自定义脚本时，该脚本未在我的布局页面中呈现。代码是：

```
bundles.Add(new ScriptBundle("~/bundles/jqueryui").Include(
         "~/Scripts/jquery-ui-{version}.custom.js"));

bundles.Add(new StyleBundle("~/content/jquery").Include(
            "~/Content/jquery-ui-{version}.custom.css")); 
```

以上 CSS 和脚本都不包括在内。我在这里做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T19:30:16.647

创建捆绑包后，您需要将它们添加到 HTML 中的某个位置。通常在**_Layout.cshtml**中，你需要这样一行：

```
@Scripts.Render("~/bundles/jqueryui") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T08:52:38.680

调试问题的另一种选择是安装提琴手并在发出网页请求时检查下载的文件只需单击提琴手中缺少的文件名并检查返回的内容是什么。在我的情况下，它返回错误消息无法加载文件或程序集 WebGrease。我已删除并添加了引用，现在脚本文件已呈现。

# javascript - 没有调试器 (F12)，Javascript 将无法在 IE 上运行

> ID：15143773
> 
> 赞同：0
> 
> 时间：2013-02-28T19:14:05.080
> 
> 标签：javascript, internet-explorer, debugging, dynamics-crm

我正在处理一个 MSCRM 页面，它仅使用两种方法加载一个简单的 Javascript。一种加载外部 Javascript 的方法和另一种调用该外部方法并将结果写入 MSCRM 页面的方法。这些是代码

```
function addJavascript(jsname, pos) {
    var th = document.getElementsByTagName(pos)[0];
    var s = document.createElement('script');
    s.setAttribute('type', 'text/javascript');
    s.setAttribute('src', jsname);
    th.appendChild(s);
}

addJavascript('http://maps.google.com/maps/api/js?v=3&sensor=true&key=xxxxxxx', 'body');

function getLatLang() {
    var geocoder = new google.maps.Geocoder();
    var address = Xrm.Page.getAttribute("address1_line1").getValue() + "," + Xrm.Page.getAttribute("address1_city").getValue();
    if (address != '') {
        geocoder.geocode({ "address": address }, function (results, status) {
            if (status == google.maps.GeocoderStatus.OK) {
                Xrm.Page.getAttribute("address1_latitude").setValue(results[0].geometry.location.lat());
                Xrm.Page.getAttribute("address1_longitude").setValue(results[0].geometry.location.lng());
                return;
            }
        });
    }
} 
```

它们工作正常，但前提是我在调试（IE F12）中运行它，或者我在我真的不想做的 IE 高级选项中取消选中“禁用脚本调试”。我读到了由调用`console.log()`方法引起的错误，您可以从上面的代码片段中看到根本没有调用该方法。

所以简而言之，我如何让 javascript 函数在没有调试器的情况下工作？

任何指针表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T19:18:14.370

您可以通过在它不可用时尝试创建它来检查问题是否是由 console.log 引起的。在您的代码之前添加：

```
var console = console || {};
console.log = console.log || function () {}; 
```

如果它有效，您可能缺少地图脚本所需的包含。

# spring - 使用反射按类类型查找对象以实例化 Spring Data Repository

> ID：15143776
> 
> 赞同：2
> 
> 时间：2013-02-28T19:14:12.723
> 
> 标签：spring, spring-data

我正在尝试对我的数据库应用程序进行“按类型查找”研究。特别是，我有一个类型的层次结构：Mother <-- Child1，Child2。我有 3 个相应的存储库，即注释 @Repository 和扩展 PagingAndSortingRepository 的类。

现在，我有一个控制器需要在数据库中加载所有 Child1（或 Child2）类型的实例。

这是我对 ControllerClassForTheSearch 类中的方法的建议：

```
public List<? extends Mother> findMotherByType(Class classToSearch)
        throws FindException {

    PagingAndSortingRepository<? extends Mother, Long> repo;
    try {
        repo = beanFactory.createBean(classToSearch);
    } catch (Exception e) {
        throw new FindException (this
                .getClass().getName(), classRepository);
    }

    return repo.findAll();
} 
```

beanFactory 变量在同一个类中定义如下：

```
@Controller
public class ControllerClassForTheSearch implements BeanFactoryAware {
    private AutowireCapableBeanFactory beanFactory;

    @Override
    public void setBeanFactory(final BeanFactory beanFactory)
        throws BeansException {
       this.beanFactory = (AutowireCapableBeanFactory) beanFactory;
    }
    [...] // rest of the class code 
```

但是，它不起作用：我的存储库是接口，因此无法创建它们（这是我得到的错误）。在其他类中，存储库是自动装配的变量，它们工作正常，包括 Mother、Child1 和 Child2 的存储库。

你有什么想法我可以找到找到 Child1 类型的类的结果吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-03T12:19:04.667

您可能想看看[`Repositories`](http://static.springsource.org/spring-data/commons/docs/1.5.0.RELEASE/api/org/springframework/data/repository/support/Repositories.html)Spring Data Commons 中的帮助程序类。您可以从 a 创建一个`ListableBeanFactory`，然后按托管域类型访问存储库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T05:01:45.950

我用 getBean 替换了 createBean 并且它有效。

# c# - xmldocument的顺序错误

> ID：15143781
> 
> 赞同：0
> 
> 时间：2013-02-28T19:14:41.637
> 
> 标签：c#, automation, code-generation

我正在通过阅读示例制表符分隔的文档来构建代码自动化。我的 xml 文档结构已关闭。我的逻辑有什么问题？我看到两种情况来找到 xml 节点的正确父节点。

```
for (int lines = 0; lines < files.Length; lines++)  //start
{
    var firstNode = files[lines].TrimEnd('\t');
    NodeNames.Add(files[lines].Replace("\t","") + lines);

    levels.Add(TextTool.CountStringOccurrences(firstNode, "\t"));  //first count
    if (lines == 0)
    {
        newXml += "XmlNode " + NodeNames[lines] + "Node" + " = xmlDoc.CreateElement(\"" + files[lines].Replace("\t", "") + "\");" + System.Environment.NewLine;
        //set value to empty
        newXml += NodeNames[lines] + "Node" + ".InnerText = String.Empty;" + System.Environment.NewLine;
        newXml += "xmlDoc.AppendChild(" + NodeNames[lines] + "Node);" + System.Environment.NewLine;

    }
    else{
        if (levels[levels.Count - 1] > levels[levels.Count - 2])
        {
            //create new ele
            newXml += "XmlNode " + NodeNames[lines] + "Node" + " = xmlDoc.CreateElement(\"" + files[lines].Replace("\t", "") + "\");" + System.Environment.NewLine;
            //set value to empty
            newXml += NodeNames[lines] + "Node" + ".InnerText = String.Empty;" + System.Environment.NewLine;
            //add new ele as child to previous ele
            newXml += NodeNames[lines - 1] + "Node" + ".AppendChild(" + NodeNames[lines] + "Node" + ");" + System.Environment.NewLine;
        }
        else
        {
            //create new ele
            newXml += "XmlNode " + NodeNames[lines] + "Node" + " = xmlDoc.CreateElement(\"" + files[lines].Replace("\t", "") + "\");" + System.Environment.NewLine;
            var lastSmallest = levels.Count - 1;
            var current = levels[levels.Count - 1];
            var checker = levels[levels.Count - 1];
            while (checker >= current)
            {
                lastSmallest = lastSmallest - 1;
                checker = levels[lastSmallest];
            }
            //set node value to empty;
            newXml += NodeNames[lines] + "Node" + ".InnerText = String.Empty;" + System.Environment.NewLine;
            newXml += NodeNames[checker] + "Node" + ".AppendChild(" + NodeNames[lines] + "Node" + ");" + System.Environment.NewLine;

        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T22:21:37.580

```
 for (int i = lines; i > 0;i-- )
                    {
                        if (levels[i] < levels[lastSmallest])
                        {
                            checker = i;
                            break;
                        }
                    } 
```

而不是 while 或将检查器更改为变量为 lastsmallest。我正在分配列表值而不是索引值

# javascript - 如果变量在 JS 中的大括号之外，如何使用它？

> ID：15143782
> 
> 赞同：0
> 
> 时间：2013-02-28T19:14:49.387
> 
> 标签：javascript

我不明白这一点-如何在条件`var`内定义的 a 在该`if`条件之外使用？

示例 JS：

```
if (1===2) {
  var myVar = "I live in brackets";
}
$("#debug").append("myVar = " + myVar);
$("#debug").append("but I'm about to throw a 'not defined' exception right... now " + firstAppearanceVar); 
```

渲染：`myVar = I live in brackets`

的范围不`myVar`只是在那个`if (1===2)`条件之内吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T19:16:08.553

范围仅适用于函数，不适用于其他块。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-28T19:16:16.063

Javascript 没有**块***作用域*，它只有函数*作用域*。

换句话说，由 声明的变量可以在*函数*`var`范围内访问，无处不在，就在那里，而不是在外面。

 ** * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-28T19:17:16.660

由于[提升](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/var#var_hoisting)，每个变量声明都会弹出到函数范围的顶部。

```
alert(foo); // undefined (no error because of the hoisting.)
var foo = 2;
alert(bar); Error 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-28T19:23:08.450

定义 javascript 变量时，声明被提升到函数范围的顶部。

所以这：

```
if (1===2) {
  var myVar = "I live in brackets";
}
$("#debug").append("myVar = " + myVar);
$("#debug").append("but I'm about to throw a 'not defined' exception right... now " + firstAppearanceVar); 
```

相当于这个

```
var myVar;
if (1===2) {
  myVar = "I live in brackets";
}
$("#debug").append("myVar = " + myVar);
$("#debug").append("but I'm about to throw a 'not defined' exception right... now " + firstAppearanceVar); 
```

因此，在函数中定义的任何变量都可以在该函数的任何位置或任何内部函数内部访问。它们在函数之外是不可访问的。

所以

```
(function(){
    if (1===2) {
      var myVar = "I live in brackets";
}}())
$("#debug").append("myVar = " + myVar); //reference exception 
```*

# python - 正则表达式匹配Python

> ID：15143788
> 
> 赞同：2
> 
> 时间：2013-02-28T19:15:08.893
> 
> 标签：python, regex

我正在解析一个文件，并想在我的文件中找到任何位置`<color = orange>`或`<color>`开始位置。

然后我想拉出橙色的值。

我将如何使用正则表达式来做到这一点。

到目前为止，我有这个（这还不够，因为它不寻找颜色有值的情况）：

```
def main():
    basefile = open ("base.txt")
    libfile = open ("file.txt")
    lines = []
    while 1:
        line = libfile.readline()
        lines.append("%s" % libfile.readline())
        if not line:
            break
    inlibrary = 0 
    newlibrary = []
    for line in lines:
        if "<color>" in line: 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T19:24:06.080

如果您的问题是匹配的正则表达式，请查看它们：

```
>>> m = re.match("<color(?:\s*=\s*(.*?))?>", "<color>asdfsdaf")
>>> m, m.groups()
(<_sre.SRE_Match object at 0x7fb0579467b0>, (None,))
>>> m = re.match("<color(?:\s*=\s*(.*?))?>", "<color=fuschia>asdfsdaf")
>>> m, m.groups()
(<_sre.SRE_Match object at 0x7fb057946738>, ('fuschia',))
>>> m = re.match("<color(?:\s*=\s*(.*?))?>", "foobarbaz")
>>> m #None
>>> 
```

但是你真的应该使用 XML 解析器来完成这项工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T19:24:45.720

如果您不想使用完整的 XML 解析器，应该这样做：

```
import re
with open("file.txt") as libfile:
    lines_with_color = []
    for line in libfile.readlines():
       if re.match("<color(=[^>]+)?>", line):
           lines_with_color.append(line) 
```

# excel - 使用shell将csv文件保存为excel文件

> ID：15143791
> 
> 赞同：3
> 
> 时间：2013-02-28T19:15:17.597
> 
> 标签：excel, bash, shell, csv, cmd

无论如何使用shell脚本/命令提示符将csv文件保存为excel文件？

我知道我可以通过保存在 excel gui 中手动完成，但是如何使它成为一个自动化过程？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-08T05:57:20.100

[csv2df](http://csv2odf.sourceforge.net)：

```
csv2odf data.csv template.xlsx output.xlsx 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T21:03:18.120

看看[http://www.perlmonks.org/?node_id=635437](http://www.perlmonks.org/?node_id=635437) 您可以使用 Perl 模块来解析和编写 Excel 电子表格。

你会需要：

[https://metacpan.org/pod/Spreadsheet::WriteExcel](https://metacpan.org/pod/Spreadsheet::WriteExcel)
和
[https://metacpan.org/pod/Text::CSV::Simple](https://metacpan.org/pod/Text::CSV::Simple)

或者

```
sudo apt-get install libspreadsheet-writeexcel-perl libtext-csv-perl 
```

那么那个脚本应该适合你 -

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T19:27:30.620

如果您不介意在 Excel 中执行此操作，您可以使用 VBA 执行一些操作，该操作将同时处理多个文件。

更喜欢：[http](http://www.go4expert.com/forums/convert-xls-csv-using-vbscript-t18188/) ://www.go4expert.com/forums/convert-xls-csv-using-vbscript-t18188/但更改保存类型。

# elevated-privileges - 添加 [不仅仅是启用] SeDebugPrivilege

> ID：15143796
> 
> 赞同：0
> 
> 时间：2013-02-28T19:15:30.190
> 
> 标签：elevated-privileges

Win7 上的 IE 和 Firefox 都有一个可怕的问题，冷启动后几分钟或退出睡眠后，开始一两分钟的密集磁盘活动，关闭所有其他进程，甚至停止光标移动。无法进入任务管理器来识别罪魁祸首，尽管它必须是 IE 或 Firefox。想要编写一个程序来监视进程并暂停任何劫持机器的进程。可以 EnumProcesses 但不能执行 OpenProcess 或其他与 SeDebugPrivilege 相关的功能，因为我的令牌尽管是管理员，但没有 SeDebugPrivilege。这当然意味着 AdjustTokenPrivileges 无效，因为它不能添加权限，只能操作现有权限。StackOverflow 上的几个线程讨论了这个问题，其中一个提到了 RunWithDebugEnabled 程序。我想做的和 Visual Studio 一样：调试另一个进程。如何将 SeDebugPrivilege 放入我现有的令牌中？诺顿一无所获；诺顿论坛没有帮助。MalwareBytes 什么也没找到。谢谢。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-17T00:19:29.007

本地安全 API。必须刻录 MSDN 支持票才能了解这一点。似乎令人难以置信，没有其他人意识到这一点。

# python - 无穷无尽的一行代码，在事件之后被删除，在另一个之后产生

> ID：15143798
> 
> 赞同：-1
> 
> 时间：2013-02-28T19:15:34.107
> 
> 标签：python, pygame, lines, blit

我的游戏发射了一颗子弹，但问题是你不能射出比你投入的数量更多的子弹（imageA、imageB、imageC 等......）所以，我必须写大约 30 次“blit blah blah imageA”为每一位玩家的每一把枪。这很烦人。

有没有办法根据角色射出多少子弹来产生代码，然后产生一个代码来对它进行blit？然后，当它离开屏幕时，我可以删除该新代码。（我只是想知道如何删除，而不是当它离开屏幕时如何让它这样做，我知道。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T20:40:41.893

我相信您以错误的方式解决问题。假设你有一个玩家，他有一把枪。所以我们的玩家类部分看起来像这样：

```
class Player
    def __init__(self):
        self.position = [0,0]
        self.bullets = [] 
```

我们还需要一个子弹类，它也会有一个位置。现在，例如，每次玩家按空格键时，您都会在列表中添加一个新项目符号。

```
def shoot(self):
    self.bullets += Bullet(self.position) 
```

然后，在 while 循环中，在您绘制玩家的地方，您还需要执行一次 foreach 来绘制子弹。无需为每个子弹命名，甚至可以拥有自己的图片。

# javascript - 将数组中的字符串拆分为子数组

> ID：15143801
> 
> 赞同：2
> 
> 时间：2013-02-28T19:15:45.230
> 
> 标签：javascript, google-apps-script

我在尝试将数组中的字符串拆分为子数组然后将其推回原始数组时遇到问题。

我得到错误：

> TypeError：在对象中找不到函数拆分

这是我的代码：

```
// Split chapter into scenes
for(c in files){
  var ID = files[c].getId();
  var chapter = DocumentApp.openById(ID);
  var text = chapter.getText();

  // Splits chapter into scenes and pushes them to scenes
  scenes.push(text.split("*"));

  // Splits scenes into n,s,b
  for(s in scenes){
    scenes[s] = scenes[s].split("~");
  }

  // Push in scene wordcount
  for(b in scenes){
    var wordCount = scene[b][2].split(" ");
    scenes[b].push(wordCount.length);
  }
} 
```

脚本导入的章节文档格式如下：

> 场景标题
> ～场景
> 概要
> ～场景
> 主体……是的。
> 
> *
> 
> 到银河系
> ~
> 就这样……
> ~
> 就这样，一切都是这样那样。对。
> 
> *
> 
> 结束
> ~
> 这就是结束。
> ~
> 所以事情就是这样，一切都是这样那样。对。结束。

我有两个数组，一个称为`chapters`包含章节号、名称和总字数的数组，然后是场景，它包含特定章节中的所有场景（也细分为场景名称、摘要、正文和字数）。章节标题使用 DocsList 函数导入到章节数组中。

我从驱动器中获取作为章节的特定文档中的文本，并首先使用字符 * 将其拆分为场景。

然后，在一个完美的世界中，我将逐步通过场景数组将对象数组中的每个字符串拆分为 s 子数组，该子数组使用字符 ~ 将场景编号、场景名称和场景主体分隔在一个子数组中，然后将该数组推入原始数组。

因此，如果

```
scenes = ["The Beginning ~ In the beginning, blah blah blah ~ Body of the scene goes here", "The Beginning ~ In the beginning, blah blah blah ~ Body of the scene goes here"] 
```

处理后会变成：

```
scenes = [["The beginning", "In the beginning, blah blah blah", "Body of the scene goes here"], ["The beginning", "In the beginning, blah blah blah", "Body of the scene goes here"]] 
```

问题是当我将章节文档拆分为场景时，它似乎将场景作为对象而不是字符串推送到数组中，这使得无法进一步拆分场景数组中的字符串。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T06:28:19.017

这样的事情会做你想要的吗？

```
function test(){ // replace this with the DocumentApp that gets your chapters
var chapter = "Scene Title~Summary of scene~Body of the scene...yeah.*To the Galaxy~And so it goes...~And so it goes like this that everything was this and that. Right.*The End~This is the end.~And so it goes like this that everything was this and that. Right. The end."
Logger.log(splitText(chapter))
}

function splitText(chapter){
  var temp = []
  var text = []
  var scenes=[]
  var wordCount
  // Splits chapter into scenes and pushes them to scenes
  temp=(chapter.split("*"));

  for(t in temp){
    text = temp[t].split("~")
    Logger.log(t+'  '+text)
    wordCount = temp[t].split(" ").length
    text.push(wordCount)
    scenes.push(text)
    }
 return scenes  
} 
```

日志结果：

```
0  Scene Title,Summary of scene,Body of the scene...yeah.
1  To the Galaxy,And so it goes...,And so it goes like this that everything was this and that. Right.
2  The End,This is the end.,And so it goes like this that everything was this and that. Right. The end.
[[Scene Title, Summary of scene, Body of the scene...yeah., 7.0], [To the Galaxy, And so it goes..., And so it goes like this that everything was this and that. Right., 18.0], [The End, This is the end., And so it goes like this that everything was this and that. Right. The end., 19.0]] 
```

# .net - 如果不是 IsDefaultAppDomain，从任何 AppDomain 调用的 Environment.Exit 是否会退出整个过程？

> ID：15143810
> 
> 赞同：4
> 
> 时间：2013-02-28T19:16:10.480
> 
> 标签：.net, appdomain

我最初对 Environment.Exit 的看法是：

1.  如果从默认 AppDomain 调用，该进程将终止。

2.  如果从默认以外的 AppDomain 调用，AppDomain 将终止并将退出代码推送到 AppDomain.ExecuteAssembly 的返回中。

这对我来说似乎是合乎逻辑的，因为加载的 AppDomain 由于调用 Environment.Exit 而不是像[https://stackoverflow.com/questions接受的答案那样以“}”结尾而不是在“}”处结束，因此可以预见是不希望的/3971101/c-sharp-whats-the-best-way-to-end-a-program](https://stackoverflow.com/questions/3971101/c-sharp-whats-the-best-way-to-end-a-program)谈到了。

但是 Environment.Exit 的[MSDN 描述](http://msdn.microsoft.com/en-us/library/system.environment.exit.aspx "MSDN 说明")如下：

> 终止此进程并为底层操作系统提供指定的退出代码。

所以这让我想知道，Environment.Exit 是否像 MSDN 所说的那样杀死了整个过程，还是像我最初的假设一样工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T19:48:26.887

MSDN 库文章当然是准确的。不，您不能只调用 Environment.Exit() 并希望它能够工作，它有 CAS 需求。高大上，必须信任代码才能运行危险代码 SecurityPermissionFlag.UnmanagedCode。您通常只能完全信任它。

AppDomain 中的沙盒代码非常简单，[这个 MSDN 页面](http://msdn.microsoft.com/en-us/library/bb763046.aspx)显示了如何。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-28T19:36:04.247

我已经创建了一个测试解决方案来测试这个，看起来 MSDN 是正确的。

如果从任何地方调用 Environment.Exit，整个过程都会退出。考虑到这一点，Environment.Exit 仅应在您希望终止代码正在运行的进程时使用，而不仅仅是退出您的应用程序。

调用 Environment.Exit 以退出您的应用程序，可能会导致在 AppDomain 中加载您的软件的其他应用程序出现问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T19:50:50.783

我会说 Environment.Exit 理想情况下不应该被使用，如果使用它，很可能在应用程序中存在设计错误。当不再有前台线程运行时，“.NET 进程”将自动退出。如果您退出主线程，并且没有其他前台线程，那么您的应用程序将退出。您应该能够跟踪所有前台线程，并有一种安全的方式让它们一个接一个地退出。

如果你必须依赖 Environment.Exit 那么你就有问题了。

# objective-c - 字符串 Xcode Objective-C

> ID：15143817
> 
> 赞同：0
> 
> 时间：2013-02-28T19:16:29.607
> 
> 标签：objective-c

我是 Objective-C 和 Xcode 的新手。

我做了第一个程序“Hello Word”，现在我想将“hello word”消息更改为另一条消息。这是我的代码中的示例：

**。H**

```
#import <UIKit/UIKit.h>    
@interface ViewController : UIViewController {

 IBOutlet UILabel * label;
 IBOutlet UIButton * boton;
 }
 -(IBAction)click:(id)sender;
 @end 
```

**.m**

```
 #import "ViewController.h"

 @interface ViewController ()

 @end

 @implementation ViewController

 -(IBAction)click:(id)sender{
     label.text = @"hello Word" ;
     label.text = @"here is the second string"; 
      // i would like when i touch again the button to change to this string
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T19:19:47.050

如果你想在两者之间切换，你可以尝试条件

```
if ([label.text isEqualToString:@"hello World"]) {
     label.text = @"here is the second string";
} else {
   label.text = @"hello World";
} 
```

注意 NSString equivalence 的测试`isEqualToString:`。更通用的形式`isEqual:`也可以，但如果您知道您正在处理 NSString 对象，则前者被认为更有效。

如果这不是您所追求的，那么您可以使用逻辑 - 例如

```
NSString* firstString = @"hello world";
NSString* secondString = @"here is the second string";

if ([label.text isEqualToString:firstString] 
{
     label.text = secondString;
} else if ([label.text isEqualToString:secondString] {
   return;
} else {
  label.text = firstString;
} 
```

或者使用@HotLicks 建议的整数标志.. 有很多方法可以使用逻辑，但没有一种特定于objective-C。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T02:37:16.657

一种方法是创建一个 NSMutableArray。一个更好的方法是有一个按钮和一个标签。当您按下按钮时，标签会显示您想要的文本。

这是您可以做到的最好方法：

.h 文件

```
@interface ViewController : UIViewController

{

int currentTextIndex;

// The model objects

NSMutableArray *text;

// The view objects

IBOutlet UILabel *labelName;

}

- (IBAction)showText:(id)sender; 
```

.m 文件

```
@interface ViewController ()

@end

@implementation ViewController

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    // Call the init method implemented by the superclass
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
     text = [[NSMutableArray alloc] init];

// Add text to the arrays
    [text addObject:@"Whatever text you want in here];

    [text addObject:@"other text you want in here"];

}

return self;

- (IBAction)showText:(id)sender
{
    //Step to the next statement
    currentQuestionsIndex++;

    //Am I past the last statement?
    if (currentTextIndex == [text count])
    {

        //Go back to the first statement
        currentTextIndex = 0;
    }
//Get the string at that index in the text array
    NSString *statement = [text objectAtIndex:currentTextIndex];

    //Log the string to the console
    NSLog(@"displaying text: %@", text);

    //Display the string in the question field
    [labelName setText:question];

} 
```

让我知道这个是否奏效？可能有点偏

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-09T16:04:38.493

这个答案是您问题的不同方法。下一步将插入一个文本字段、一个标签和一个按钮，因此当您按下按钮时，标签将随着文本字段的内容而改变。

将这些项目添加到您的视图中，将 Text Field 和 Label 声明为 Outlets，将 Button 声明为视图头文件 (iE ViewController.h) 中的 Action。然后在您的实现文件（ViewController.m）中：

```
 -(IBAction)myButton:(id)sender{
   [self updateLabel];
 }

-(void)updateLabel{
   _myLabel.text = _myTextField.text;
} 
```

请注意，一旦键盘出现，您的“问题列表”可能会变长。我的意思是，一旦它显示出来，你需要隐藏它（也许）并在按下键盘上的“return”键时执行和操作，因为起初它什么都不做。

下面是一些实现“Return”键的代码：

```
//"Return" key
-(BOOL)textFieldShouldReturn:(UITextField *)textField{
   [_myTextField resignFirstResponder]; //This takes out the "focus" from the textfield
   [self updateLabel];
   return YES;
} 
```

在这个答案中，您应该已经了解： - 如何设置标签的文本值 - 如何调用函数 - 如何为“返回”键设置操作

就是这样。快乐编码！

# sql-server-2008 - SSIS 文件加载的动态列列表

> ID：15143819
> 
> 赞同：0
> 
> 时间：2013-02-28T19:16:32.117
> 
> 标签：sql-server-2008, ssis

我得到了一个分成几部分的文件。节由“start-of-<sectionName>”和“end-of-<sectionname>”行分隔。我关心的两个部分是字段列表和实际数据。这是一个简短的例子：

```
start-of-fields
a
b
c
end-of-fields
start-of-data
1|2|3
2|3|4
end-of-data 
```

我的问题出现在给定文件可能没有所有字段的地方。***文件有***哪些字段列在字段部分。数据流任务中的脚本组件中是否有办法解析出存在哪些列，然后相应地解析数据部分？我目前有一个工作脚本组件 (C#)，它忽略字段部分并假设所有列都在那里。我注意到在我的任务输出缓冲区的父类中，有一个名为 BufferColumnIndexes 的成员，但它受到保护，因此我无法从我的脚本中获取它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T18:33:20.430

当然，脚本组件可以逐行读取输入文件。当它找到该`start-of-fields`行时，它可以构建一个漂亮的小列标题数组，当它到达该`end-of-fields`行时停止。然后它可以读取`start-of-data`和行之间的每一行`end-of-data`，解析出值，并使用提供的值和您想要的任何默认值将一行添加到输出缓冲区。

然而，这是非常多的有状态编码。由于您实际上无法在 SSIS 2008 中调试脚本组件，因此让它工作将是一件非常痛苦的事情。

编写一个成熟的自定义数据流组件可能会更好。甚至编写一个完全独立的控制台应用程序。

# sql - 尝试避免重复时缺少 NULL 关键字错误

> ID：15143827
> 
> 赞同：6
> 
> 时间：2013-02-28T19:16:51.840
> 
> 标签：sql, oracle11g

我正在尝试对包含与 Oracle 11g 下人员有关的记录的表进行更新。我有一列包含 ID，其中一些包含连字符。该表对此 ID 有限制，因此两个不同的人不能拥有相同的 ID。我的目标是删除连字符，同时在我进行更新时避免任何违反约束的情况。所以我尝试了这个查询来检测违反约束的记录：

```
SELECT count(*) FROM people
WHERE externalid LIKE '%-%' AND
replace(externalid, '-') IS IN (SELECT externalid FROM people); 
```

然后失败并出现 ORA-00908: missing NULL 关键字。我知道这是由于最后一行，但我不知道如何构造查询的该部分以检测已使用非连字符 ID 的记录。如何检测这些违反约束的记录？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-28T19:22:49.730

`IS`关键字在 中使用，`something IS NULL`而不是与`IN`关键字一起使用。这就是为什么数据库认为缺少 NULL 的原因。只需删除`IS`：

```
SELECT count(*) FROM people
WHERE externalid LIKE '%-%' AND
replace(externalid, '-') IN (SELECT externalid FROM people); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-28T19:22:59.727

我不确定这是否适用于 oracle，但值得一试：

```
SELECT * FROM people p1
Inner Join people p2 on replace(p1.externalid, '-') = p2.externalid
and p1.externalid < p2.externalid --prevents duplicate matches
Where p1.externalid LIKE '%-%' 
```

# r - 将矩阵中一行的值重复 N 次

> ID：15143829
> 
> 赞同：4
> 
> 时间：2013-02-28T19:16:55.410
> 
> 标签：r, matrix

如果我在 R 中有一个如下所示的矩阵：

```
1,3
7,1
8,2

```

我将如何编写创建这样的矩阵的代码：

```
1,3
1,3
1,3
7,1
8,2
8,2

```

它在哪里根据正确的 .column 值重复该行？请记住，我有一个实际上比 2 行多得多的矩阵

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-28T19:46:45.570

```
# construct your initial matrix
x <- matrix( c( 1 , 3 , 7 , 1 , 8 , 2 ) , 3 , 2 , byrow = TRUE )

# take the numbers 1 thru the number of rows..
1:nrow(x)

# repeat each of those elements this many times
x[ , 2 ]

# and place both of those inside the `rep` function
rows <- rep( 1:nrow(x) , x[ , 2 ] )

# ..then return exactly those rows!
x[ rows , ]

# or save into a new variable
y <- x[ rows , ] 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-28T19:46:56.193

这是您的原始矩阵：

```
a<-matrix(c(1,7,8,3,1,2),3,2) 
```

这使您成为第一列：

```
rep(a[,1],times=a[,2]) 
```

这使您成为第二列：

```
rep(a[,2],times=a[,2]) 
```

将这些与 cbind 结合起来：

```
cbind(rep(a[,1],times=a[,2]),rep(a[,2],times=a[,2]))

     [,1] [,2]
[1,]    1    3
[2,]    1    3
[3,]    1    3
[4,]    7    1
[5,]    8    2
[6,]    8    2 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-01-13T18:19:40.610

```
A <- matrix( c( 1 , 3 , 7 , 1 , 8 , 2 ) , 3 , 2 , byrow = TRUE )

a<-c(3,1,2)

f<-function(i1){
 rep(A[i1,],a[i1])
}

matrix(unlist(sapply(1:3,f)),ncol=2,byrow=TRUE) 
```

# java - 找不到 log4j.xml 时关闭 HTTPclient 记录器

> ID：15143830
> 
> 赞同：0
> 
> 时间：2013-02-28T19:17:01.233
> 
> 标签：java, apache-httpclient-4.x

我正在使用芝麻框架中的 HttpClient。当我不想要它时，客户端会在控制台中转储相当多的数据。经过研究，我发现我需要在 log4j.xml 文件中关闭，但是，我找不到该文件。我拥有的唯一文件是 apache“.jar”文件，如果是这种情况，我在哪里可以关闭记录器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T20:47:59.037

如果您的类路径中有 log4j.xml 或 log4j.properties 文件，那么您应该使用那个文件。如果您没有，则在您的类路径中创建一个（或在您的 WEB-INF/classes 中，如果是 webapp）

# c# - Windows Phone 8 可以播放 WAV 文件但不能播放 MP3

> ID：15143834
> 
> 赞同：2
> 
> 时间：2013-02-28T19:17:05.613
> 
> 标签：c#, audio, windows-phone-8, mp3, wav

在 Windows Phone 8 上，我可以使用以下代码播放 WAV 文件，但不能播放 MP3 文件。我有什么特别需要做的吗？

我的要求是根据用户的选择，一个接一个地播放 MP3。我在同一个 xaml 页面上一个接一个地播放它们。MP3 包含为内容（始终复制）。

```
private void PlayAudioTrack(string audiofilename)
{
    try
    {
        using (var stream = TitleContainer.OpenStream(@"Audio/" + audiofilename))
        {
            var effect = SoundEffect.FromStream(stream);
            FrameworkDispatcher.Update();
            effect.Play();
        }
    }
    catch
    {
       //....
    }             
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-28T06:04:39.640

我猜最初提出这个问题的人已经找到了他的解决方法。我仍然想为寻找相同答案的其他人添加此注释。

以下是有关如何在 windows phone 8 上播放音频（包括 mp3）的详细演练：

[http://msdn.microsoft.com/en-us/library/windowsphone/develop/hh202978(v=vs.105).aspx](http://msdn.microsoft.com/en-us/library/windowsphone/develop/hh202978(v=vs.105).aspx)

以及支持的格式列表：

[http://msdn.microsoft.com/en-us/library/windowsphone/develop/ff462087(v=vs.105).aspx](http://msdn.microsoft.com/en-us/library/windowsphone/develop/ff462087(v=vs.105).aspx)

播放 mp3 对我来说很好。在模拟器和设备上。

希望这可以帮助某人。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-11T16:30:29.550

XNA SoundEffect 类不支持 MP3，不幸的是只支持 WAV。如果您想使用它，您需要先将您的 MP3 转换为 WAV。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-07T17:49:13.217

我发现了一种在 wp8.1 中播放 wav 文件的厚颜无耻的方式，我的应用程序保存了 wav 文件。此外，它还可以通过电子邮件等方式共享它们。

在测试时，我注意到在onenote中，如果我通过我的应用程序的共享功能发送wav文件，它会附加它。另外，您可以在发送之前播放文件，哈哈。

# multithreading - 如何在 Python 中的循环内多线程操作

> ID：15143837
> 
> 赞同：83
> 
> 时间：2013-02-28T19:17:13.807
> 
> 标签：multithreading, python-2.7, python-multithreading

假设我有一个非常大的列表，我正在执行如下操作：

```
for item in items:
    try:
        api.my_operation(item)
    except:
        print 'error with item' 
```

我的问题有两个：

*   有很多项目
*   api.my_operation 需要永远返回

我想使用多线程一次启动一堆 api.my_operations，这样我就可以一次处理 5 个或 10 个甚至 100 个项目。

如果 my_operation() 返回异常（因为也许我已经处理了该项目） - 没关系。它不会破坏任何东西。循环可以继续到下一项。

**注意**：这是针对 Python 2.7.3

* * *

## 回答 #1

> 赞同：146
> 
> 时间：2013-02-28T19:27:05.133

首先，在 Python 中，如果您的代码受 CPU 限制，多线程将无济于事，因为只有一个线程可以持有全局解释器锁，因此一次运行 Python 代码。因此，您需要使用进程，而不是线程。

如果您的操作“需要永远返回”，则情况并非如此，因为它是 IO 绑定的，即在网络或磁盘副本等上等待。我稍后再谈。

* * *

接下来，一次处理 5 个或 10 个或 100 个项目的方法是创建一个由 5 个或 10 个或 100 个工作人员组成的池，并将这些项目放入工作人员服务的队列中。幸运的是，stdlib[`multiprocessing`](http://docs.python.org/3/library/multiprocessing.html)和[`concurrent.futures`](http://docs.python.org/3/library/concurrent.futures.html)库都为您提供了大部分细节。

前者对于传统编程来说更加强大和灵活；如果您需要编写future-waiting，则后者更简单；对于琐碎的情况，您选择哪个并不重要。（在这种情况下，每个最明显的实现需要 3 行和`futures`4 行`multiprocessing`。）

如果您使用的是 2.6-2.7 或 3.0-3.1，`futures`则不是内置的，但您可以从[PyPI](https://pypi.python.org/pypi/futures) ( `pip install futures`) 安装它。

* * *

最后，如果您可以将整个循环迭代转换为函数调用（您可以，例如传递给`map`），那么并行化事情通常要简单得多，所以让我们先这样做：

```
def try_my_operation(item):
    try:
        api.my_operation(item)
    except:
        print('error with item') 
```

* * *

把它们放在一起：

```
executor = concurrent.futures.ProcessPoolExecutor(10)
futures = [executor.submit(try_my_operation, item) for item in items]
concurrent.futures.wait(futures) 
```

* * *

如果你有很多相对较小的工作，多处理的开销可能会淹没收益。解决这个问题的方法是将工作分批成更大的工作。例如（使用`grouper`来自[`itertools`recipes](http://docs.python.org/3/library/itertools.html#recipes)，您可以将其复制并粘贴到您的代码中，或者从`more-itertools`PyPI 上的项目中获取）：

```
def try_multiple_operations(items):
    for item in items:
        try:
            api.my_operation(item)
        except:
            print('error with item')

executor = concurrent.futures.ProcessPoolExecutor(10)
futures = [executor.submit(try_multiple_operations, group) 
           for group in grouper(5, items)]
concurrent.futures.wait(futures) 
```

* * *

最后，如果你的代码是 IO 绑定的怎么办？然后线程与进程一样好，并且开销更少（并且限制更少，但在这种情况下，这些限制通常不会影响您）。有时，“较少的开销”足以意味着您不需要使用线程进行批处理，但您需要处理进程，这是一个不错的胜利。

那么，如何使用线程而不是进程呢？只需更改`ProcessPoolExecutor`为`ThreadPoolExecutor`.

如果您不确定您的代码是受 CPU 限制还是受 IO 限制，请尝试两种方式。

* * *

> 我可以为我的 python 脚本中的多个函数执行此操作吗？例如，如果我想要并行化的代码中的其他地方有另一个 for 循环。是否可以在同一个脚本中执行两个多线程函数？

是的。事实上，有两种不同的方法可以做到这一点。

首先，您可以共享同一个（线程或进程）执行程序并在多个地方使用它，没有问题。任务和未来的全部意义在于它们是独立的。您不在乎它们在哪里运行，只需将它们排队并最终得到答案。

或者，您可以在同一个程序中有两个执行程序，这没有问题。这有性能成本——如果你同时使用两个执行器，你最终会尝试在 8 个内核上运行（例如）16 个繁忙的线程，这意味着会有一些上下文切换。但有时它是值得做的，因为，比如说，两个执行器很少同时忙，它使你的代码更简单。或者，一个执行器正在运行可能需要一段时间才能完成的非常大的任务，而另一个执行器正在运行需要尽快完成的非常小的任务，因为对于部分程序而言，响应能力比吞吐量更重要。

如果您不知道哪个适合您的程序，通常是第一个。

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2013-02-28T20:11:38.487

有 multiprocesing.pool，下面的示例说明了如何使用其中之一：

```
from multiprocessing.pool import ThreadPool as Pool
# from multiprocessing import Pool

pool_size = 5  # your "parallelness"

# define worker function before a Pool is instantiated
def worker(item):
    try:
        api.my_operation(item)
    except:
        print('error with item')

pool = Pool(pool_size)

for item in items:
    pool.apply_async(worker, (item,))

pool.close()
pool.join() 
```

现在，如果您确实确定您的进程是@abarnert 提到的 CPU 绑定，请将 ThreadPool 更改为进程池实现（在 ThreadPool 导入下注释）。您可以在此处找到更多详细信息：http: [//docs.python.org/2/library/multiprocessing.html#using-a-pool-of-workers](http://docs.python.org/2/library/multiprocessing.html#using-a-pool-of-workers)

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2013-02-28T19:33:22.653

您可以使用以下方法将处理拆分为指定数量的线程：

```
import threading                                                                

def process(items, start, end):                                                 
    for item in items[start:end]:                                               
        try:                                                                    
            api.my_operation(item)                                              
        except Exception:                                                       
            print('error with item')                                            

def split_processing(items, num_splits=4):                                      
    split_size = len(items) // num_splits                                       
    threads = []                                                                
    for i in range(num_splits):                                                 
        # determine the indices of the list this thread will handle             
        start = i * split_size                                                  
        # special case on the last chunk to account for uneven splits           
        end = None if i+1 == num_splits else (i+1) * split_size                 
        # create the thread                                                     
        threads.append(                                                         
            threading.Thread(target=process, args=(items, start, end)))         
        threads[-1].start() # start the thread we just created                  

    # wait for all threads to finish                                            
    for t in threads:                                                           
        t.join()                                                                

split_processing(items) 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2019-09-06T06:23:59.737

```
import numpy as np
import threading

def threaded_process(items_chunk):
    """ Your main process which runs in thread for each chunk"""
    for item in items_chunk:                                               
        try:                                                                    
            api.my_operation(item)                                              
        except Exception:                                                       
            print('error with item')  

n_threads = 20
# Splitting the items into chunks equal to number of threads
array_chunk = np.array_split(input_image_list, n_threads)
thread_list = []
for thr in range(n_threads):
    thread = threading.Thread(target=threaded_process, args=(array_chunk[thr]),)
    thread_list.append(thread)
    thread_list[thr].start()

for thread in thread_list:
    thread.join() 
```

# python - 可以生成大型熊猫数据框视图的布尔索引？

> ID：15143842
> 
> 赞同：13
> 
> 时间：2013-02-28T19:17:19.917
> 
> 标签：python, dataframe, pandas

得到了一个大数据框，我想对它进行切片（根据多个布尔标准），然后修改这些切片中的条目以更改原始数据框 - 即我需要原始数据框`view`。问题是，花哨的索引总是返回一个`copy`. 想到了`.ix`方法，但是用该方法进行布尔索引`df.ix[]`也返回一个副本。

本质上，如果`df`是我的数据框，我想要一个 C 列的视图，`C!=0, A==10, B<30,...`等等。在熊猫中有没有快速的方法来做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-28T20:16:14.217

即使`df.loc[idx]`可能是 , 的一部分的副本`df`，[**赋值**也会`df.loc[idx]`](http://pandas.pydata.org/pandas-docs/stable/indexing.html#why-does-the-assignment-when-using-chained-indexing-fail)修改`df`自己。`df.iloc`（对于和也是如此`df.ix`。）

例如，

```
import pandas as pd
import numpy as np
df = pd.DataFrame({'A':[9,10]*6,
                   'B':range(23,35),
                   'C':range(-6,6)})

print(df)
#      A   B  C
# 0    9  23 -6
# 1   10  24 -5
# 2    9  25 -4
# 3   10  26 -3
# 4    9  27 -2
# 5   10  28 -1
# 6    9  29  0
# 7   10  30  1
# 8    9  31  2
# 9   10  32  3
# 10   9  33  4
# 11  10  34  5 
```

这是我们的布尔索引：

```
idx = (df['C']!=0) & (df['A']==10) & (df['B']<30) 
```

`df`我们可以通过赋值来修改where`idx`为 True 的那些行`df.loc[idx, ...]`。例如，

```
df.loc[idx, 'A'] += df.loc[idx, 'B'] * df.loc[idx, 'C']
print(df) 
```

产量

```
 A   B  C
0     9  23 -6
1  -110  24 -5
2     9  25 -4
3   -68  26 -3
4     9  27 -2
5   -18  28 -1
6     9  29  0
7    10  30  1
8     9  31  2
9    10  32  3
10    9  33  4
11   10  34  5 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-28T20:17:30.067

pandas 文档有一个关于[返回视图与副本](http://pandas.pydata.org/pandas-docs/dev/indexing.html#returning-a-view-versus-a-copy)的部分：

> 关于何时返回数据视图的规则完全取决于 NumPy。**每当索引操作涉及标签数组或布尔向量时，结果将是一个副本。**使用单个标签/标量索引和切片，例如`df.ix[3:6]`or `df.ix[:, 'A']`，将返回一个视图。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T20:28:05.213

以 unutbu 的示例为基础，您还可以在 df.index 上使用布尔索引，如下所示：

```
In [11]: df.ix[df.index[idx]] = 999

In [12]: df
Out[12]:
      A    B    C
0     9   23   -6
1   999  999  999
2     9   25   -4
3   999  999  999
4     9   27   -2
5   999  999  999
6     9   29    0
7    10   30    1
8     9   31    2
9    10   32    3
10    9   33    4
11   10   34    5 
```

# java - Hibernate DAO/SessionFactory 使用

> ID：15143843
> 
> 赞同：0
> 
> 时间：2013-02-28T19:17:20.107
> 
> 标签：java, spring, hibernate

在我的应用程序中，我有一个 DAO bean，我通过 Spring 注入了一个 Hibernate sessionFactory（配置了 c3p0 连接池）。我的 sessionFactory bean 定义如下：

```
<bean id="sessionFactory" class="org.springframework.orm.hibernate4.LocalSessionFactoryBean">
...
</bean> 
```

在线程环境中使用包装 DAO bean 的最佳实践和/或最佳性能是什么？我应该将它定义为单例 bean 并让它在线程之间共享，同时依赖 sessionFactory 的线程安全性吗？或者我应该为每个线程创建一个单独的 DAO 实例？这还重要吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T19:19:01.240

如果您的 DAO 除了 SessionFactory 之外没有任何成员字段，请将每个字段用作传递给所有线程的 Singleton。

Spring 的一个常见做法是将 DAO 实现与实例注释`@Repository`到`@Autowired`您的服务或其他需要使用它的类中。

`SessionFactory#openSession()`和分别返回一个新的`SessionFactory#getCurrentSession()`Session 实例和一个线程本地的 Session，因此线程之间没有共享任何内容。

# java - 康威处理过程中的生命游戏

> ID：15143846
> 
> 赞同：-1
> 
> 时间：2013-02-28T19:17:31.857
> 
> 标签：java, processing, conways-game-of-life

因此，代码正在编译并完美运行。但是，通常，康威的生命游戏会在一段时间后稳定下来，而这段代码会无限期地运行，而不会出现死分支，如果有人能帮助我找出原因，我会很高兴。

```
int[][] world;
int SCALE_FACTOR = 4;
float DENSITY = 0.1;

void setup() {
  size(500,500);
  world = new int[width/SCALE_FACTOR][height/SCALE_FACTOR];
  for(int i = 0; i < width/SCALE_FACTOR; i++) {
    for (int j = 0; j < height/SCALE_FACTOR; j++) {
      int r = (int)random(100);
      world[i][j] = r % (int)(1/DENSITY) == 0 ? 1 : 0;
    }
  }
  frameRate(1);
  stroke(0, 255, 0);
}

void draw() {
  scale(SCALE_FACTOR);
  background(0);
  for(int i = 0; i < width/SCALE_FACTOR; i++) {
    for (int j = 0; j < height/SCALE_FACTOR; j++) {
      if (world[i][j] == 1) point(i, j);
    }
  }
  lifeCycle();    
}

void lifeCycle() {
  int[][] newworld = new int[width/SCALE_FACTOR][height/SCALE_FACTOR];
  for(int i = 0; i < width/SCALE_FACTOR; i++) {
    for (int j = 0; j < width/SCALE_FACTOR; j++) {
      if (world[i][j] == 1) {
        if (neighbours(i, j) == 3) {
          newworld[i][j] = 1;
        } else {
          newworld[i][j] = 0;
        }
      } else {
        if (neighbours(i, j) == 2 || neighbours(i, j) == 3) {
          newworld[i][j] = 1;
        } else {
          newworld[i][j] = 0;
        }
      }
    }
  }
  for (int i = 0; i < width/SCALE_FACTOR; i++) {
    for (int j = 0; j < height/SCALE_FACTOR; j++) {
      world[i][j] = newworld[i][j];
    }
  }
}

int neighbours(int x, int y) {
  int px = (x == width/SCALE_FACTOR - 1) ? 0 : (x+1);
  int py = (y == height/SCALE_FACTOR - 1) ? 0 : (y+1);
  int mx = (x == 0) ? (width/SCALE_FACTOR - 1) : (x-1);
  int my = (y == 0) ? (height/SCALE_FACTOR - 1) : (y-1);
  return world[mx][my] + world[mx][y] + world[mx][py]
    + world[x][my] + world[x][py]
    + world[px][my] + world[px][y] + world[px][py];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T19:20:03.190

好吧，这看起来是错误的：

```
for (int j = 0; j < width/SCALE_FACTOR; j++) { 
```

当然应该是这样`height`。

下一步：目前你的逻辑是，“如果广场之前是活着的，只有在它有三个邻居的情况下，它才在下一轮活着；如果它之前是死的，如果它有两三个邻居，它在下一轮是活着的。” 这是错误的方式。*创造*生命需要三个活着的邻居，但*维持*生命只需要两三个邻居。

这就是我可以立即看到的所有问题，但是关于诊断问题的提示：

*   我强烈建议保持和`width`游戏*术语*而不是像素大小，我认为这是本意。绘制时按比例放大单位*，*但根据实际网格元素保留所有逻辑。`height`*`SCALE_FACTOR`*
***   如果您将 UI 与“业务逻辑”隔离开来，您可以轻松地对其进行单元测试。*   当您使用 UI 显示板时，您可能希望为其提供“手动前进”模式，以便您可以更轻松地准确查看正在发生的事情。**

# jsf-2 - 如何在支持 bean 中确定 ap:dialog 是否打开？

> ID：15143857
> 
> 赞同：7
> 
> 时间：2013-02-28T19:18:25.383
> 
> 标签：jsf-2, primefaces

如果在浏览器中打开了 Primefaces 对话框，有没有办法从支持 bean 中判断？

这就是我在 facelet 上显示对话框的方式：

```
<p:menuitem value="Click me" oncomplete="dialogWidget.show();" /> 
```

当我从 中查找 Dialog 对象时，即使未显示对话框`ViewRoot`，两者`dialog.isVisible()`和都返回 true。`dialog.isInView()`或者，是否有一个标志告诉我主窗口是否变灰（显示模式对话框时会发生这种情况）？

背景信息：我正在尝试找出在哪里显示我的 FacesMessages。我的应用程序可以在 2 个位置显示消息：主窗口或对话框弹出窗口。打开模式对话框时，我希望消息仅显示在对话框中。如果没有显示对话框，我希望消息显示在主窗口中。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-28T19:48:36.853

## 通过侦听器跟踪支持 bean 中的对话框状态

您可以将对话框的打开状态保留为 bean 中的布尔变量。

为此，您可以附加一个`actionListerer`属性`<p:menuItem>`，将 bean 的布尔`openStatus`属性设置为 true。要将该属性切换回 false，本质上是处理关闭，您可以使用适当定义的侦听器嵌套`<p:ajax event="close" listener="#{dialogBean.dialogClosed}">`在您的内部。`<p:dialog>`

豆子：

```
@ManagedBean
@ViewScoped
public class DialogBean implements Serializable {

    private boolean openStatus = false;//getter + setter

    public void dialogOpened(ActionEvent event) {
        openStatus = true;
    }

    public void dialogClosed(CloseEvent event) {
        openStatus = false;
    }

} 
```

风景：

```
<h:form>
    <p:menu>
        <p:menuitem value="Open dialog" oncomplete="dialog.show();" update="dialogopen"/>
    </p:menu>
    <p:dialog widgetVar="dialog">
        <h:outputText value="This is your dialog"/>
        <p:ajax event="close" listener="#{dialogBean.dialogClosed}" update="dialogopen"/>
    </p:dialog>
    <h:outputText id="dialogopen" value="Is dialog open? #{dialogBean.openStatus}"/>
</h:form> 
```

## 通过更新 bean 属性`<p:remoteCommand>`

就完全客户端事件而言`dialogWidgetVar.show()`，`dialogWidgetVar.hide()`组件的状态不包括对话框的“开放状态”。正如您可以从 primefaces 文档中获得的那样，`dialog.isVisible()`获取`visible`a 的属性，该属性`<p:dialog>`指示在页面加载时打开对话框。至于`dialog.isInView()`方法，它只是检查组件是否存在于视图中，并且也没有对您所追求的对话框状态的任何引用。

另请注意，将您的对话框绑定到类型的支持组件变量`org.primefaces.component.dialog.Dialog` [会引起臭名昭著的问题](https://stackoverflow.com/questions/8026082/jsf-2-0-why-my-viewscope-beans-is-re-created-even-though-still-on-same-view)。

尽管如此，如果您不想将额外的侦听器连接到`menuitem`，最好的办法是使用`<p:remoteCommand>`，它会为您完成更新。请注意，应该存在关闭侦听器，以便将变量设置回 false。

改良豆：

```
@ManagedBean
@ViewScoped
public class DialogBean implements Serializable {

    private boolean openStatus = false;//getter + setter

    public void dialogClosed(CloseEvent event) {
        openStatus = false;
    }

} 
```

修改后的视图：

```
<h:form>
    <p:menu>
        <p:menuitem value="Open dialog" oncomplete="dialog.show(); updateOpenStatus();"/>
    </p:menu>
    <p:dialog widgetVar="dialog">
        <h:outputText value="This is your dialog"/>
        <p:ajax event="close" listener="#{dialogBean.dialogClosed}" update="dialogopen"/>
    </p:dialog>
    <p:remoteCommand name="updateOpenStatus" update="dialogopen">
        <f:setPropertyActionListener value="#{true}" target="#{dialogBean.openStatus}"/>
    </p:remoteCommand>
    <h:outputText id="dialogopen" value="Is dialog open? #{dialogBean.openStatus}"/>
</h:form> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T06:05:35.300

如果您想对所有开发人员透明地执行此操作，您可以创建可以完成这项工作的复合组件。

# android - 如何将 RoboDialogFragment 与自定义布局一起使用

> ID：15143861
> 
> 赞同：4
> 
> 时间：2013-02-28T19:18:46.443
> 
> 标签：android, android-dialog, android-dialogfragment, roboguice

谁能告诉我，指向一个示例或演示，或者如何使用 RoboDialogFragment 在自定义 DialogFragment 上注入视图？（roboguice 和 Fragments 领域的任何帮助或示例都会有所帮助！）

我正在实现 RoboDialogFragment、覆盖 onCreateDialog 并膨胀我的布局 - 但我看不到如何或在哪里可以注入视图（例如 ListView）。我可以调用 view.findViewById - 但我希望为此使用注入。

任何帮助表示赞赏！

# string - 变量替换中的bash冒号运算符？

> ID：15143863
> 
> 赞同：45
> 
> 时间：2013-02-28T19:18:49.220
> 
> 标签：string, bash, variables, colon, variable-substitution

我继承了一些 bash 代码，这两行让我感到困惑：

```
branch_name=`git describe --contains --all HEAD`
branch_name=${branch_name:-HEAD} 
```

我对`:`冒号运算符的理解是，它基于索引创建子字符串，因此`-HEAD`在这种情况下，使用字符串没有任何意义。

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2013-02-28T19:20:14.290

这需要变量`branch_name`，如果它已定义。如果未定义，请`HEAD`改用。

有关详细信息，请参阅[Shell 参数扩展](http://www.gnu.org/software/bash/manual/bashref.html#Shell-Parameter-Expansion)：

> 3.5.3 Shell参数扩展
> 
> '$' 字符引入了参数扩展、命令替换或算术扩展。...参数扩展的基本形式是${parameter}。
> ...
> 当不执行子字符串扩展时，使用下面描述的形式（例如，':-'），Bash 测试未设置或为空的参数。省略冒号会导致仅对未设置的参数进行测试。换句话说，如果包含冒号，则运算符会测试两个参数的存在以及它的值是否不为空；如果省略冒号，则运算符仅测试是否存在。
> 
> **${参数：-字}**
> 
> 如果参数未设置或为空，`word`则替换为的扩展。否则，`parameter`替换 的值。

* * *

下面几行介绍了子字符串。两者的区别在于

```
${parameter:-word} 
```

对比

```
${parameter:offset}
${parameter:offset:length} 
```

> **${参数：偏移}**
> **${参数：偏移：长度}**
> 
> 这称为子字符串扩展。它扩展到从 offset 指定的字符开始的参数值的最大长度字符。
> ...
> 如果 offset 计算为小于零的数字，则该值用作从参数值末尾开始的字符偏移量。...*请注意，负偏移量必须与冒号隔开至少一个空格，以避免与 ':-' 扩展混淆。*

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2013-02-28T20:12:10.223

在这种情况下，冒号只是`-`运算符的修饰符。`${branch-HEAD}`仅当`branch`未设置时才会扩展为“HEAD”，而`${branch:-HEAD}`如果`branch`也是空字符串则扩展为“HEAD”。

```
$ branch=master
$ echo "${branch-HEAD} + ${branch:-HEAD}"
master + master
$ branch=""
$ echo "${branch-HEAD} + ${branch:-HEAD}"
 + HEAD
$ unset branch
$ echo "${branch-HEAD} + ${branch:-HEAD}"
HEAD + HEAD 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-02-28T19:37:30.520

在 bash 中，`${VAR1:-VAR2}`相当于 SQL`coalesce(VAR1, VAR2)`或 C# 的`VAR1 ?? VAR2`.

在你的情况下：

```
branch_name=`git describe --contains --all HEAD`
branch_name=${branch_name:-HEAD} 
```

第一行执行`git`命令并设置`branch_name`变量中的值，然后，第二行合并其值，分配`HEAD`if`branch_name`的值为 null。

如您所说`${VAR1:NUM}`，是字符串前缀操作（`left`在 SQL 中），当与负数一起使用时， as`${VAR1: -NUMBER}`变为后缀（`right`）操作。请注意减号之前的空格：如果您跳过该空格，它将成为`coalesce`我之前所说的操作。

# xml - XSLT 1.0：如何在保持标记完整的同时将段落格式化为多行？

> ID：15143864
> 
> 赞同：3
> 
> 时间：2013-02-28T19:18:55.837
> 
> 标签：xml, xslt, jaxb, format

我想将一个长句子分成多行，同时将整个单词保留在句子的末尾。我的行长为 40，因此它应该打印当前单词，然后如果将行长推到 40 以上，则继续下一行。所有定界符都是空格，我目前没有将单词作为标记检索。这似乎非常困难，因为我仅限于使用 XSLT 1.0。

**示例来自：**

```
Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean ut mi neque, sit amet tincidunt magna. Phasellus eleifend suscipit neque, at pretium enim facilisis non. Aenean a ornare eros. 
```

**所需的示例：**

```
Lorem ipsum dolor sit amet, consectetur
adipiscing elit. Aenean ut mi neque, sit
amet tincidunt magna. Phasellus eleifend
suscipit neque, at pretium enim facilisis
non. Aenean a ornare eros. 
```

**目前我正在使用现有的 XSL 方法：**

```
<xsl:template name="nextline">
    <xsl:param name="return"/>
    <xsl:param name="width"/>
    <xsl:choose>
        <!-- when the string-length is greater than the width -->
        <xsl:when test="(string-length($return) div string-length($width)) &gt; 1">
            <xsl:value-of select="concat(substring($return,1,$width - 1), '&#10;')"/>
            <xsl:call-template name="nextline">
                <xsl:with-param name="return" select="substring($return, $width)"/>
                <xsl:with-param name="width" select="$width"/>
            </xsl:call-template>
        </xsl:when>
        <!-- just print the string length -->
        <xsl:otherwise>
            <xsl:value-of select="substring($return,1,$width - 1)"/>
        </xsl:otherwise>
    </xsl:choose>
</xsl:template> 
```

**当前不受欢迎的示例：**

```
Lorem ipsum dolor sit amet, consectetur
 adipiscing elit. Aenean ut mi neque, s
it amet tincidunt magna. Phasellus elei
fend suscipit neque, at pretium enim fa
cilisis non. Aenean a ornare eros. 
```

**下面的部分解决方案导致：**

```
Lorem ipsum dolor sit amet, consectetur

adipiscing elit. Aenean ut mi neque, sit

amet tincidunt magna. Phasellus eleifend

suscipit neque, at pretium enim facilisis

non. Aenean a ornare eros. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T20:18:32.830

我很想为此目的使用扩展函数，而不是尝试在纯 XSLT 中对其进行编码。您在问题中说您正在使用`javax.xml.transform`，默认情况下使用 Xalan，它支持 Java 扩展功能。Apache [commons-lang 3.1](http://commons.apache.org/proper/commons-lang/)提供了一个静态方法[WordUtils.wrap](http://commons.apache.org/proper/commons-lang/apidocs/org/apache/commons/lang3/text/WordUtils.html#wrap%28java.lang.String,%20int%29)它似乎完全可以满足您的需求，如果您将该库添加到您的项目中，那么您可以将其作为扩展调用，如下所示

```
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0"
     xmlns:wu="xalan://org.apache.commons.lang3.text.WordUtils"
     exclude-result-prefixes="wu">

  <xsl:template match=".....">
     <xsl:value-of select="wu:wrap(stringToWrap, 40)" />
  </xsl:template>
</xsl:stylesheet> 
```

如果您要从元素中获取要包装的值，则可能需要使用该`string`函数，即`wu:wrap(string(someElement), 40)`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T04:02:51.710

**这是使用[FXSL](http://fxsl.sf.net)`str-split-to-lines`模板的解决方案：**

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:f="http://fxsl.sf.net/">
 <xsl:import href="strSplit-to-Lines.xsl"/>

 <xsl:output indent="yes" omit-xml-declaration="yes"/>

 <xsl:template match="/">
  <xsl:call-template name="str-split-to-lines">
    <xsl:with-param name="pStr" select="concat(/*, ' ')"/>
    <xsl:with-param name="pLineLength" select="40"/>
    <xsl:with-param name="pDelimiters" select="' &#9;&#10;&#13;'"/>
  </xsl:call-template>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于以下 XML 文档时：**

```
<t>    Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean ut mi neque, sit amet tincidunt magna. Phasellus eleifend suscipit neque, at pretium enim facilisis non. Aenean a ornare eros.</t> 
```

**产生了想要的正确结果：**

```
Lorem. ipsum dolor$ sit ame, consectetur 
adipiscing elit? Aenean ut mi neque, sit 
amet tincidunt magna. Phasellus eleifend 
suscipit neque, at pretium enim 
facilisis non. Aenean a ornare eros. 
```

**请注意**：

此解决方案允许将被视为单词之间分隔符的任何（多值）字符指定为参数。

# javascript - Javascript 正则表达式在逗号分隔的字符串中拆分单词

> ID：15143867
> 
> 赞同：4
> 
> 时间：2013-02-28T19:19:01.383
> 
> 标签：javascript, regex

我正在尝试使用正则表达式拆分逗号分隔的字符串。

```
var a = 'hi,mr.007,bond,12:25PM'; //there are no white spaces between commas
var b = /(\S+?),(?=\S|$)/g;
b.exec(a); // does not catch the last item. 
```

任何关于捕获所有项目的建议。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-28T19:24:46.687

使用否定字符类：

```
/([^,]+)/g 
```

将匹配非逗号组。

```
< a = 'hi,mr.007,bond,12:25PM'
> "hi,mr.007,bond,12:25PM"
< b=/([^,]+)/g
> /([^,]+)/g
< a.match(b)
> ["hi", "mr.007", "bond", "12:25PM"] 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-28T19:20:33.803

为什么不直接使用`.split`？

```
>'hi,mr.007,bond,12:25PM'.split(',')
["hi", "mr.007", "bond", "12:25PM"] 
```

如果出于某种原因*必须使用正则表达式：*

```
str.match(/(\S+?)(?:,|$)/g)
["hi,", "mr.007,", "bond,", "12:25PM"] 
```

（注意包含逗号）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-06-19T15:12:51.413

如果您传递的是 CSV 文件，您的某些值可能有双引号，因此您可能需要一些更复杂的东西。例如：

```
Pattern splitCommas = java.util.regex.Pattern.compile("(?:^|,)((?:[^\",]|\"[^\"]*\")*)");

Matcher m = splitCommas.matcher("11,=\"12,345\",ABC,,JKL");

while (m.find()) {
    System.out.println( m.group(1));
} 
```

或在 Groovy 中：

```
java.util.regex.Pattern.compile('(?:^|,)((?:[^",]|"[^"]*")*)')
        .matcher("11,=\"12,345\",ABC,,JKL")
            .iterator()
                .collect { it[1] } 
```

此代码处理：

*   空行（上面没有值或逗号）
*   空列，包括最后一列为空
*   处理用双引号括起来的值，包括双引号内的逗号
*   但不处理用于转义双引号本身的两个双引号

该模式包括：

*   `(?:^|,)`匹配最后一列之后的行首或逗号，但不将其添加到组中

*   `((?:[^",]|"[^"]*")*)`匹配列的值，包括：

    *   一个收集组，它收集零个或多个字符，它们是：

        *   `[^",]`是不是逗号或引号的字符
        *   `"[^"]*"`是一个双引号，后跟零个或多个以另一个双引号结尾的其他字符
    *   使用非收集组将它们或在一起：`(?:[^",]|"[^"]*")`

    *   使用 a`*`重复上述任意次数：`(?:[^",]|"[^"]*")*`
    *   并进入收集组以赋予列值：`((?:[^",]|"[^"]*")*)`

将双引号转义留给读者作为练习

# mysql - Sql Query返回叶节点？

> ID：15143868
> 
> 赞同：0
> 
> 时间：2013-02-28T19:19:02.557
> 
> 标签：mysql, sql, hierarchical-data

嗨我有一个表如下

```
ID  ||  NAME ||  PARENTID ||  LEAF  
1   ||   A   ||    NULL   ||   0      
2   ||   B   ||     1     ||   0  
3   ||   c   ||     2     ||   1  
4   ||   A   ||     1     ||   1 
```

它是数据表中的一种树形结构。我想检索特定父节点的所有叶节点（Leaf=1），有人可以建议我对此进行 sql 查询吗？

我试过这个：

```
select ( SELECT LEAF,NAME FROM Tablex WHERE PARENTID=1) from Tablex where LEAF=1 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T19:43:01.753

数据库中的树结构是一个非常常见的问题。

有许多可能的方法。

SQL（在 MySQL 中）不是处理树结构的最佳方法，因为树结构可能有无限的层次，并且在 MySQL 中没有（有效的）处理递归的方法，因为您必须 JOIN 表 n 次，其中n 是树的级别数。当级别数可能不同时 - 您必须在 PL/SQL（过程 SQL）中使用一些存储过程，这将比 PHP、C 或其他语言中的简单循环更有效（更慢并且会使用更多内存）。

请考虑使用其他语言（PHP 或您正在使用的其他语言）将表格转换为树。

正如 Gordon Linoff 和 ypercube 在评论中所写，有更高级的数据库（如 Oracle），在这些数据库中处理树在编程/编码中更加有效和舒适。

附加信息：

[在 MySQL 中管理分层数据（作者 Mike Hillyer）](http://mikehillyer.com/articles/managing-hierarchical-data-in-mysql/)

[谷歌搜索：sql树结构](http://www.google.com/search?q=sql%20tree%20structure)

PHP方法：

[php/Mysql 最好的树形结构](https://stackoverflow.com/questions/5916482/php-mysql-best-tree-structure)

[类别和子类别的 PHP 树结构，无需循环查询](https://stackoverflow.com/questions/4843945/php-tree-structure-for-categories-and-sub-categories-without-looping-a-query)

还有一个来自[ypercube](https://stackoverflow.com/users/344949/ypercube)的有用链接：

[分层数据模型 - Bill Karwin / Karwin Software Solutions LLC 的介绍](http://www.slideshare.net/billkarwin/models-for-hierarchical-data)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T20:11:41.780

您尝试的查询应如下所示：

```
select tt.* FROM 
( SELECT LEAF,NAME FROM Tablex WHERE PARENTID IS NOT NULL and PARENTID=1 ) AS tt 
WHERE leaf=1; 
```

如果您想进一步使用它，这里是 SQL Fiddle：[http ://sqlfiddle.com/#!2/2d95b8/2](http://sqlfiddle.com/#!2/2d95b8/2)

# python - 如果数据库被锁定，重试 SQLite 查询的最简单方法是什么？

> ID：15143871
> 
> 赞同：9
> 
> 时间：2013-02-28T19:19:06.140
> 
> 标签：python, sqlite

我不太确定在哪里问，我希望它就在这里。

我搜索的是在数据库繁忙时重试 SQLite 查询的最简单解决方案。我在服务器上使用 quassel 作为我的 IRC 客户端，我想将旧日志移动到单独的数据库以保持它使用的小型数据库。我为此编写的脚本是：

```
CREATE TEMP TABLE delfrom (id integer,val integer);
ATTACH '/home/irc/oldlog.db' as log;
BEGIN IMMEDIATE;
REPLACE INTO delfrom (id,val) select 1337,messageid from backlog where time < strftime('%s', 'now','-14 days') ORDER BY messageid DESC LIMIT 1;
INSERT INTO log.log (messageid,time,bufferid,type,flags,senderid,message) SELECT messageid,time,bufferid,type,flags,senderid,message FROM backlog WHERE messageid < (SELECT val FROM delfrom where id=1337);
DELETE FROM backlog WHERE messageid < (SELECT val FROM delfrom where id=1337);
PRAGMA incremental_vacuum;
COMMIT; 
```

我使用 sqlite3 quassel-storage.sqlite < movelog.sql 运行它

问题是，由于 quassel 在执行时正在运行，有时会`BEGIN IMMEDIATE;`因为数据库被锁定而失败。

有人可以建议我一种简单的方法来更改该设置，以便每隔几秒钟重试一次查询，直到它起作用？我读到 python SQLite 包装器有内置的吗？有没有一种特殊的方法我必须激活它，更重要的是，我可以使用 python 附加第二个数据库吗？有一个超时参数，`sqlite3.connect`但我不太确定它是如何工作的。Python 是否会锁定整个数据库以便在每次连接时进行写入？

我绝不会执着于使用 Python。我更喜欢的解决方案是 sqlite3 在发生此错误时返回 0，然后将其包装在 shell 中的循环中，但这似乎不起作用。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2014-03-28T09:30:08.117

*如果表*被锁定，Python 会定期重试。*如果数据库*被锁定，它将不会重试。表锁只能通过线程、共享连接或其他方法在同一进程内传播。

当多个进程写入文件时会导致数据库锁定，并且（简单地说）只要日志存在就存在。

为避免这种情况，WAL 模式可用于日志。(pragma journal_mode=wal;)

要使用数据库锁，您需要使用以下内容包装执行函数：

```
for x in range(0, timeout):
  try:
    with connection:
      connection.execute(sql)
  except:
     time.sleep(1)
     pass
  finally:
     break
else:
    with connection:
        connection.execute(sql) 
```

最后一个连接块将使其正确返回异常。这应该通过检查数据库锁定的异常并引发原始异常来改进，但这留给读者作为练习。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2016-09-01T07:22:08.610

Sqlite 使用 WAL 模式，如果你的版本大于 3.7 [https://www.sqlite.org/wal.html](https://www.sqlite.org/wal.html)

```
connect = sqlite3.connect(DB, **kwargs)
connect.execute("PRAGMA journal_mode=WAL") 
```

根据文档，“WAL 提供了更多的并发性，因为读取器不会阻塞写入器，写入器不会阻塞读取器。读取和写入可以同时进行。”

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-02-28T19:59:50.977

如果您将超时设置得足够高，SQLite 库本身会定期重试。

在默认的 Python 包装器中，这是[sqlite3.connect](http://docs.python.org/2/library/sqlite3.html#sqlite3.connect)的第二个参数。

# android - 使用 Proguard 和 Dagger 在 Release Build 上的 Android 应用程序崩溃

> ID：15143872
> 
> 赞同：7
> 
> 时间：2013-02-28T19:19:14.447
> 
> 标签：android, proguard, runtimeexception, dagger

我是使用 Proguard 和 Dagger for Android 应用程序的新手，所以如果有人能给我一些指示，我将不胜感激。

Proguard 和 Dagger 已在应用程序中实现。通过调试模式（即从 Eclipse 推送）安装应用程序时，运行应用程序没有问题。但是，当我运行应用程序的发布版本时，它会崩溃并显示以下跟踪：

```
No injectable members on com.example.test.d. Do you want to add an injectable constructor? required by com.example.test.d com.example.test.SampleActivity.a
No injectable members on com.b.a.b. Do you want to add an injectable constructor? required by com.b.a.b com.example.test.SampleActivity.b
    at dagger.internal.h.a(ThrowingErrorHandler.java:34)
    at dagger.internal.Linker.a(Linker.java:136)
    at dagger.d.a(ObjectGraph.java:264)
    at dagger.d.a(ObjectGraph.java:238)
    at com.example.test.SampleApplication.a(SampleApplication.java:24) 
```

我遵循了以下建议：https: [//plus.google.com/108620120050432268974/posts/AAjvwg3Hmgg](https://plus.google.com/108620120050432268974/posts/AAjvwg3Hmgg)，在 proguard-project.txt 中实施以下内容：

```
-keep class * extends dagger.internal.Binding
-keep class * extends dagger.internal.ModuleAdapter
-keep class * extends dagger.internal.StaticInjection 
```

但这似乎无法解决问题。建议？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T21:50:01.897

Proguard 和 dagger（预）编译在发布版本中似乎不能很好地协同工作。见 [https://plus.google.com/117210567825404150882/posts/HGjnJJHbfMj](https://plus.google.com/117210567825404150882/posts/HGjnJJHbfMj)

“问题”是未混淆的包名将被编译到类中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T10:21:46.247

您是否已将其添加到 proguard 配置文件中？

```
-keepattributes *Annotation* 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-09T14:58:02.060

看看[https://stackoverflow.com/a/18109765/654026](https://stackoverflow.com/a/18109765/654026)以防万一它帮助你。在那里，您将看到有关我的应用程序的 proguard 配置的一些详细信息，这些详细信息使我可以在使用 Dagger 时跳过应用程序崩溃。

# php - SQL 和 PHP 聚合统计，使用 COUNT 数百次的性能问题

> ID：15143874
> 
> 赞同：3
> 
> 时间：2013-02-28T19:19:16.937
> 
> 标签：php, mysql, sql

我有一个 PHP 页面做 1000 个 SQL 查询。它提供用户列表中发生的事件的统计信息。页面加载时间有点长（现在调整了索引 6 秒）。我想知道是否有比 1000 个单独查询更好的方法来做到这一点。有没有更快的方法，尤其是随着数据的增长。

这 1000 个 SQL 查询的结果被放入 PHP 数组并最终填充 html 表的单元格，如下所示：

```
 Installs    Called    Early Install   Event4   Event5    (... 9
George     5           6          3              5        29      different event
Greg       9           7          1              8        23      types, up to
David      4           1          2              4        0       maybe 15
Dan        15          17         4              20       10      eventually)
...        ...         ...        ...            ...      ...
...        ...         ...        ...            ...      ...
Totals     351         312        82             289      1220

(... there are up to ~50 users, maybe 100 total in the next two years) 
```

有些列实际上是在 PHP 中根据 (event4/installs)*100 等数据动态计算的百分比。

该表始终在给定的数据范围内，例如：
选择日期范围：`Dates Jan 15, 2013 - March 31, 2013`。

`event`表的字段：`id, event_type, user_id, event_date`

数据本身存储为由特定日期发生的事件组成的表格。PHP 页面最常见的 SQL 语句类型是计数查询，如下所示：

```
SELECT COUNT(id)
FROM events
WHERE userid = 10
    AND `event_date` BETWEEN '2013-01-01' AND '2013-02-15'
    AND event_type = 'Install';

SELECT COUNT(id)
FROM events
WHERE userid = 10
    AND `event_date` BETWEEN '2013-01-01' AND '2013-02-15'
    AND event_type = 'Called';

SELECT COUNT(id)
FROM events
WHERE userid = 10
    AND `event_date` BETWEEN '2013-01-01' AND '2013-02-15'
    AND event_type = 'Early Install';

/* and so on for each event type and user id */ 
```

这些 counts() 填充 html 表的单元格。它在一个遍历每个用户（代表 html 输出表中的每一行）的 php 循环中执行这些 counts()，并在每一行中遍历每个事件类型（列）并`COUNT`为每个事件类型执行一次。约 50 个用户，约 10 种事件类型，您在一页上获得约 1000 个单独的 SQL 请求。

1.  有没有一种合理的方法来组合所有这些单独的 SQL操作，或者在没有来自 PHP`COUNT`的所有单独调用的情况下更快或更正确地完成这一切？`COUNT`也许是一个存储过程......这有意义吗？如果是这样，如何处理（一堆计数查询或游标或什么）？以及如何从存储过程构造/返回计算计数数据的行？

我想我想知道，这是“正确的方式”吗？

我并不是要求整个问题的答案，而只是回答您可能能够回答的部分，或者您将如何处理。

另外（＃2）如何缓存这些东西？通过将所有 COUNT 值带入 PHP 进行缓存，然后将这些值从 PHP 写入 mysql 表，其中每个用户和每个日期范围都有一行，或者缓存在某处/以其他方式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T19:23:37.240

想到分组。

```
SELECT userid, event_type, COUNT(id) AS cnt
FROM events
WHERE `event_date` BETWEEN '2013-01-01' AND '2013-02-15'
GROUP BY userid, event_type
ORDER BY userid, event_type 
```

这将返回一个数组，其中每一行大致具有以下结构：

```
array(
    userid=>10,
    event_type=>'Installs',
    cnt=>5
); 
```

你可以迭代它来构建你的表。

```
//iterate over the data first constructing a new array for below
$newData = array();
$headers = array();

foreach($data as $row){
    //save the data in a multi dimensional array under the userid
    if(!isset($newData[$row['userid']])){
        $newData[$row['userid']]=array();
    }
    $newData[$row['userid']][$row['event_type']] = $row['cnt'];
    $headers[$row['event_type']]=1;
}
//get the headers
$headers = array_keys($headers);

//display the data for debugging
echo '<pre>'.print_r($newData,1).'</pre>';

echo "<table colspan=0 cellspacing=0 border=1>\n";
//add "user id" to the headers
array_unshift($headers, "User ID");
//echo the headers
echo "\t<thead>\n\t\t<th>".implode("</th>\n\t\t<th>", $headers)."</th>\n\t</thead>\n";
//remove the user id column from headers
array_shift($headers);

echo "\t<tbody>\n";
//now loop over the new data and display.
foreach($newData as $userID=>$row){
    //start row
    echo "\t\t<tr>\n";
    //user id
    echo "\t\t\t<td>{$userID}</td>\n";
    //loop over the headers. there should be corresponding keys for each header
    foreach($header as $key){
        //get the count if the key exists and '-' if not.
        $cnt = isset($row[$key])?$row[$key]:'-';
        echo "\t\t\t<td>{$cnt}</td>\n";
    }
    echo "\t\t</tr>\n";
}
echo "\t</tbody>\n</table>\n"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T19:21:48.607

像这样的事情应该这样做。

```
SELECT 
  userid,
  event_type,
  COUNT(id)
FROM 
  events
WHERE 
  `event_date` BETWEEN '2013-01-01' AND '2013-02-15'
GROUP BY 1, 2 
```

编辑：这只是部分答案。我并不是真正的缓存权威:) 抱歉，这部分我帮不上忙。

# c# - 在单个代码行 C# 中分配多个变量

> ID：15143878
> 
> 赞同：0
> 
> 时间：2013-02-28T19:19:29.657
> 
> 标签：c#, pointers, assignment-operator, assign

我不确定我想在 C# 中执行的操作称为什么，但我知道它可以在其他语言中完成。

假设我有三个变量并将它们设置为相同的值：

```
MyObject Ob1 = new MyObject(ID:1); 
MyObject Ob2 = Ob1;
MyObject Ob3 = Ob1; 
```

（假设这些变量不在同一个上下文中，我不能用它们代替一个，我也不知道它们是否存在。它们可以是一个、两个或数百个代表同一个对象......）

我知道我通过 对对象所做的`Ob3`更改实际上会更改其中的对象（当然`Ob1`，`Ob2`它们都表示具有 ID：1 的同一个对象）。

`Ob3`但是，如果我使用为 分配一些东西`Ob3 = new MyObject(ID:2)`，这不会改变 和 的值`Ob1`，`Ob2`因为它们将继续表示 ID:1 的对象。

```
// What happens:
Ob3 = new MyObject(ID:2);
// Ob3 is no longer the same as Ob1 and Ob2, wich are still the ID:1 object. 
```

我想要做的是一次分配所有三个变量，就像当我写一些对应的代码到时`Ob3 = new MyObject(ID:2);`，所有其他变量都代表 ID:2 的对象，而不是 ID:1 了。

```
//What I want:
Ob3 = new MyObject(ID:2); //using the suited operators I don't know
//And Ob1 and Ob2 become the ID:2 object as well. 
```

我知道可以使用 C++ 中的指针来完成（显然在声明和赋值中进行了一些更改），但我不想用非托管语言管理事物。那么是否有类似的方法可以在 C# 中进行“向后”分配？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T19:42:12.393

你可以这样做：

```
MyObject Ob1 = new MyObject(ID:1), Ob2 = Ob1, Ob3 = Ob1; 
```

并且所有 3 都将指向同一个对象。但是，如果你接着说

```
Ob3 = new MyObject(ID:2); 
```

Ob1 和 Ob2 仍将指向同一个 MyObject，而 Ob3 将指向一个新的 MyObject。那是因为它们是引用类型，所以存储在 Ob1 中的值基本上是指向对象本身的指针。您想要的是所有 3 件事都指向同一件事。如果 MyObject 是可更新的，你可以说类似

```
Ob3.Reset(ID:2); 
```

如果没有，你可以试试这个，但这很愚蠢。这会让你做你想做的事情，但最好考虑一下你正在做的事情是否真的是你想做的事情。

```
Tuple<MyObject> Ob1 = new Tuple<MyObject>(new MyObject(ID:1)), Ob2 = Ob1, Ob3 = Ob1;
Ob3.Item1 = new MyObject(ID:2); 
```

编辑：我想证明我认为这通常不是一件好事，它有点像黑客。可能在少数情况下它很有用，但是将变量保存在元组中通常不是什么事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T19:30:38.577

```
MyObject obj1  //This create a reference variable on the stack
obj1 = new MyObject(ID:1)  //This create a new object of type MyOjbect on the heap and then assigns the memory location of this new object to obj1.

MyObject obj2 //This creates a reference variable on the stack, pointing at nothing
obj2 = obj1   //This assigns the memory location of the object (already created) on the heap to the reference variable on the stack 
```

obj3 也是一样。

你想做的事情是不可能的，你需要明确地告诉引用变量 obj1 和 obj2 指向这里创建的对象：

```
Ob3 = new MyObject(ID:2); 
```

因为 obj1 不是对象，obj2 不是对象，obj3 不是对象。它是对对象内存位置的引用。因此，如果您告诉 obj3 在堆上创建一个新实例（创建一个 MyObject 类型的新对象），那绝对与 obj1 或 obj2 指向的位置无关

这是一张有助于理解的图片

![在此处输入图像描述](../Images/f8533b0fea999eec97998db14346e920.png)

**引用变量保存对象在堆上的内存位置的十六进制数。因此，当您将一个引用变量分配给另一个引用变量时，您实际上只是将一个十六进制数字从一个复制到另一个，这个十六进制数字代表对象所在的位置**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-28T19:30:54.663

你可以这样做：

```
MyObject Obj1, Obj2, Obj3 = new MyObject(ID:1);
Obj1 = Obj2 = Obj3 = new MyObject(ID:2); 
```

# python - 在 python 中跨多个模块定义值

> ID：15143887
> 
> 赞同：0
> 
> 时间：2013-02-28T19:19:57.250
> 
> 标签：python, python-module

我有几个不同的模块，**它们**都有：

```
if not __name__ == '__main__':
    try:
        logger = logging.getLogger()
    except:
        from MainApp.lib import setLogging
        logger = setLogging.initLogging("install.log")
else:
    from MainApp.lib import setLogging
    logger = setLogging.initLogging("install.log")
    setLogging.enableDebugLogging() 
```

例如，是否可以在 __init__.py 级别定义所有这些？

# arrays - smarty中的处理数组

> ID：15143891
> 
> 赞同：0
> 
> 时间：2013-02-28T19:20:10.000
> 
> 标签：arrays, loops, smarty

我正在尝试使用 section 命令访问 smarty 中的数组。我想在 smarty 中使用 section 命令迭代 1-128，但主要是循环必须为 65。现在我可以使用 $smarty.section.foo.index 访问最多 64 的索引。我想使用常量 {$lan.printer[$smarty.section.foo.index]+64} 访问索引 > 64 中的值。但它不起作用。请帮我解决这个问题。

我的代码如下

```
{section name=foo start=1 loop=65 step=1}
       {$lan.printer[$smarty.section.foo.index]}
       {$lan.printer[$smarty.section.foo.index]+64}
{/section} 
```

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T02:26:15.563

除了代码中明显的错字之外，要将表达式用作数组的索引，您需要先将其分配给变量，以便可以引用它：

```
{section name=foo start=1 loop=65 step=1}
   {assign var=offsetIndex value=$smarty.section.foo.index+64}
   {$lan.printer[$smarty.section.foo.index]}
   {$lan.printer[$offsetIndex]}
{/section} 
```

# jakarta-ee - 如何在 SOA 堆栈中部署独立服务？基于 Java EE

> ID：15143893
> 
> 赞同：0
> 
> 时间：2013-02-28T19:20:13.760
> 
> 标签：jakarta-ee, architecture, soa

我在 Java EE 中有一个 Web 服务堆栈，但我遇到了一个问题：每次我需要更改特定服务、部署并重新启动应用程序时，其他的也需要重新启动。

我想知道是否有一些架构（开源）可以在不同的上下文中部署我的服务。我想创建一个 SOA 结构。

逻辑思维：为每个 web 服务创建一个应用程序。但是，我真的相信存在一个更简单的选择。

我需要审核每项服务（持续时间、输入参数、结果、如果出现错误）

你有什么建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-03T14:21:56.420

您没有提供很多细节，但是如果您有真正的服务（即通过接口进行通信的独立组件），那么无论如何都没有真正的理由将它们放在同一个应用程序中。

更重要的是，将每项服务放在自己的应用程序中，您可以进行更改、扩展等

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T15:32:03.127

不确定您对运行时环境有什么要求。

如果有太多的服务无法作为单独的应用程序处理，通常会将此类服务分组到应用程序中。如果您有一组相关的服务，例如“订单服务”、“金融服务”、“物流服务”或您有什么。

当您需要更改一项时，您很有可能还需要对相关服务进行更改，例如更新模式或其他什么。在这种情况下，不需要重新启动所有服务，只需一个“组”（应用程序）。

也有针对这些情况量身定制的容器，特别是针对集成层中的服务。

我正在考虑[Apache Service Mix](http://servicemix.apache.org/)，它将 SOA 服务部署为易于处理且彼此分离的 OSGi 捆绑包。

如果您稍微更改配置和打包，应该可以部署 Web 应用程序。

# c++ - 无法专门化来自另一个命名空间的模板

> ID：15143903
> 
> 赞同：0
> 
> 时间：2013-02-28T19:20:32.423
> 
> 标签：c++, templates, opencv

我已经从 opencv 中分叉出来，当我尝试在我的命名空间中修改一次模板化代码以进行专业化时，我收到错误：

```
make -k 

[100%] Building CXX object object_detection.cpp.o
In file included from object_detection.cpp:1:0:
object_detection.h:370:75: error: specialization of 'void cv::Ptr<_Tp>::delete_obj() [with _Tp = CvHaarClassifierCascade]' in different namespace [-fpermissive]
object_detection.h:370:30: error:   from definition of 'void cv::Ptr<_Tp>::delete_obj() [with _Tp = CvHaarClassifierCascade]' [-fpermissive] 
```

我知道我不应该能够在不同的命名空间中专门化模板代码，但有出路吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T19:27:04.893

1.  重新打开他们的命名空间，并专注于它。
2.  对于函数，如果通过 ADL 忠实地使用它，请在参数的命名空间中创建覆盖。
3.  检查源模板是否正在使用可以拦截的特征类或其他类似技术。

# powershell - PowerShell 错误检查/日志记录

> ID：15143905
> 
> 赞同：1
> 
> 时间：2013-02-28T19:20:36.510
> 
> 标签：powershell, error-handling, error-logging

我有以下 powershell 脚本，它循环浏览文件列表并重命名它们。我想在下面的异常中加入一些错误检查和日志记录：

> 使用“1”参数调用“GetFile”的异常：“没有名为“/cmms”的 Web。” 在 C:\eam\Exportjbh.ps1:18 char:22 + $file = $web.GetFile <<<< ($FullPath) + CategoryInfo : NotSpecified: (:) [], MethodInvocationException + FullyQualifiedErrorId : DotNetMethodException
> 
> 您不能在空值表达式上调用方法。在 C:\eam\Exportjbh.ps1:19 char:35 + $binary = $file.OpenBinary <<<< () + CategoryInfo : InvalidOperation: (OpenBinary:String) [], RuntimeException + FullyQualifiedErrorId : InvokeMethodOnNull
> 
> 为“Write”和参数计数找到多个模棱两可的重载：“1”。在 C:\eam\Exportjbh.ps1:27 char:22 + $writer.write <<<< ($binary) + CategoryInfo : NotSpecified: (:) [], MethodException + FullyQualifiedErrorId : MethodCountCouldNotFindBest
> 
> ```
> [System.Reflection.Assembly]::LoadWithPartialName("Microsoft.SharePoint")
> 
> $Url = "https://....."
> $UrlSub = "docs"
> $FullPath = $Url + $UrlSub
> $destinationFolder = "c:\022713\"
> $sourceCsv = "c:\filename.CSV"
> 
> $Site = New-Object -TypeName Microsoft.SharePoint.SPSite $Url 
> $web =  $Site.OpenWeb($UrlSub)
> $fileObjects = Import-CSV $sourceCsv 
> 
> ForEach ($fileObject in $fileObjects) 
> {
>     $fileUrl = $fileObject.DOC_FILENAME.replace($Url,"")
>     $file = $web.GetFile($FullPath)
>         $binary = $file.OpenBinary()
> 
>     $dateTimeStamp = Get-Date -format s
>     $newFileName = $fileObject.DocumentType + "_" + $fileObject.SAPObjectNumber + "_" + 
> ```
> 
> $dateTimeStamp.replace(":","").replace("-","") $extension = [System.IO.Path]::GetExtension($file.Name)
> 
> ```
>  $stream = New-Object System.IO.FileStream(($destinationfolder + $newFileName + $extension), [System.IO.FileMode]::Create)
>     $writer = New-Object System.IO.BinaryWriter($stream)
>     $writer.write($binary)
>     $writer.Close() } $web.Dispose() 
> ```

# forms - Spring MVC 表单未从下拉列表中返回值

> ID：15143912
> 
> 赞同：1
> 
> 时间：2013-02-28T19:21:01.463
> 
> 标签：forms, spring, spring-mvc

我是一个老 servlet/html 人。我知道这应该如此简单，但我找不到我正在尝试做的事情的例子。也许我的方法是错误的，但希望得到一些建议。

我可以使用 Spring 表单标记加载下拉列表，其中包含我从表中检索到的键和值的 List<>，但是当提交表单时，我得到一个 EMPTY List<> (size=0)。我能够从表单中检索答案（输入=文本）。

我的控制器：

```
 @RequestMapping(value = "/getQuestions", method = RequestMethod.GET)
public ModelAndView getQuestionsPage() {
    List<Question> questionsList = questionDAO.getAll();
    return new ModelAndView("questions", "questionsList", questionsList);
}

    @RequestMapping(method = RequestMethod.POST)
public ModelAndView processForm(@ModelAttribute("answer1") String answer1, @ModelAttribute("questionsList") java.util.ArrayList question) {
    ModelAndView model = new ModelAndView("home");
    return model;
} 
```

jsp的表单部分：

```
<form action="questions" method="post" modelAttribute="questionsList">

<table>
    <tr>
        <td>Questions :</td>
        <td><form:select path="questionsList">
            <form:option value="0" label="Select" />
            <form:options items="${questionsList}" itemValue="id" itemLabel="question" />
            </form:select>
        </td>
    </tr>
    <tr>
        <td>Answer :</td>
        <td><input type="text" name="answer1"></td>
    <tr>
        <td><input type="submit" /></td>
    </tr>   
</table> 
```

我想这可能与它有关？？

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T20:57:03.500

您`name`缺少`form:select`. 为了让它与它一起工作，`@ModelAttribute("questionsList")`它必须是这样的：

```
<form:select path="questionsList" name="questionsList"> 
```

虽然我真的不鼓励这样做，因为它会导致与 path 属性的很多混淆，它具有完全不同的目的。

此外，您的帖子数据将仅包含与选择名称关联的选定值（例如：questionsList:1），因此将其设置为列表没有多大意义。

你可以这样尝试：

JSP：

```
<form:select path="questionsList" name="questionId"> 
```

控制器：

```
public ModelAndView processForm(@ModelAttribute("answer1") String answer1, @ModelAttribute("questionId") Integer questionId) { 
```

# mercurial - 如何将基本修订版移动到 mercurial 中的另一个分支？

> ID：15143917
> 
> 赞同：0
> 
> 时间：2013-02-28T19:21:13.397
> 
> 标签：mercurial, branch, revision

我读过这个问题：[如何将一些变更集移动到 mercurial 中的新分支](https://stackoverflow.com/questions/2219756/how-to-move-some-changeset-to-a-new-branch-in-mercurial)

但我的问题略有不同。我所拥有的是：

```
NULL -> 1 -> 2 -> 3 -> 4 -> etc   #default
 \ 
  10  #default (new head without parent)
   \ 
    11 -> 12 -> 13 -> 14  #new-empty-branch 
```

当然，我应该从一开始就在 de new-empty-branch 中提交 rev 10，但我没有，所以现在我想将修订 10 从默认分支移动到 #new-empty-branch。不幸的是，所有修订都已被推送。

这就是我想要的结果：

```
NULL -> 1 -> 2 -> 3 -> 4 -> etc   #default
 \ 
  10 -> 11 -> 12 -> 13 -> 14  #new-empty-branch 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T01:50:14.123

你确定你真的想要你在后来的照片中展示的东西吗？那是一个有两个根的存储库（两个没有父母的修订）。这并不违法，但不正常，而且绝对不是人们分支的方式。

如果你真的想要那个（相信我你几乎肯定不会）你将不得不修改变更集 10（因为命名分支是修订的散列组件）和它之后的每个变更集（因为父的散列是修订的散列组件），您最终会得到一个不同的存储库，并且克隆它的每个人都必须删除他们的克隆并重新克隆。

或者你可以

```
hg update 10
hg commit --close-branch 
```

并收工。这足以让 10 人停止出现在`hg heads`

# ffmpeg - 如何使用 ffmpeg 和 c++ 将自制流发布到 rtmp 服务器？

> ID：15143918
> 
> 赞同：2
> 
> 时间：2013-02-28T19:21:17.387
> 
> 标签：ffmpeg, h.264, rtmp, libavcodec, libavformat

祝你们有美好的一天，人们！

我正在为 Windows 编写一个应用程序，它将捕获屏幕并通过 rtmp（用于广播）将流发送到 Wowza 服务器。我的应用程序使用 ffmpeg 和 Qt。我使用 WinApi 捕获屏幕，将缓冲区转换为 YUV444（因为它最简单）并按照文件decode_encoding.c（来自 FFmpeg 示例）中的描述对帧进行编码：

```
///////////////////////////
//Encoder initialization
///////////////////////////
avcodec_register_all();
codec=avcodec_find_encoder(AV_CODEC_ID_H264);
c = avcodec_alloc_context3(codec);
c->width=scr_width;
c->height=scr_height;
c->bit_rate = 400000;
int base_num=1;
int base_den=1;//for one frame per second
c->time_base= (AVRational){base_num,base_den};
c->gop_size = 10;
c->max_b_frames=1;
c->pix_fmt = AV_PIX_FMT_YUV444P;
av_opt_set(c->priv_data, "preset", "slow", 0);

frame = avcodec_alloc_frame();
frame->format = c->pix_fmt;
frame->width  = c->width;
frame->height = c->height;

for(int counter=0;counter<10;counter++)
{
///////////////////////////
//Capturing Screen
///////////////////////////
    GetCapScr(shotbuf,scr_width,scr_height);//result: shotbuf is filled by screendata from HBITMAP
///////////////////////////
//Convert buffer to YUV444 (standard formula)
//It's handmade function because of problems with prepare buffer to swscale from HBITMAP
///////////////////////////
    RGBtoYUV(shotbuf,frame->linesize,frame->data,scr_width,scr_height);//result in frame->data
///////////////////////////
//Encode Screenshot
///////////////////////////
    av_init_packet(&pkt);
    pkt.data = NULL;    // packet data will be allocated by the encoder
    pkt.size = 0;
    frame->pts = counter;
    avcodec_encode_video2(c, &pkt, frame, &got_output);
    if (got_output) 
    {
        //I think that  sending packet by rtmp  must be here!
        av_free_packet(&pkt);             

    }

}
// Get the delayed frames
for (int got_output = 1,i=0; got_output; i++)
{
    ret = avcodec_encode_video2(c, &pkt, NULL, &got_output);
    if (ret < 0)
        {
            fprintf(stderr, "Error encoding frame\n");
            exit(1);
        }
        if (got_output)
        {
        //I think that  sending packet by rtmp  must be here!
        av_free_packet(&pkt);      
        }
}

///////////////////////////
//Deinitialize encoder
///////////////////////////
avcodec_close(c);
av_free(c);
av_freep(&frame->data[0]);
avcodec_free_frame(&frame); 
```

我需要将此代码生成的视频流发送到 RTMP 服务器。换句话说，我需要这个命令的 c++/c 模拟：

```
ffmpeg -re -i "sample.h264" -f flv rtmp://sample.url.com/screen/test_stream 
```

它很有用，但我不想将流保存到文件中，我想使用 ffmpeg 库对屏幕截图进行实时编码，并将编码帧发送到我自己的应用程序中的 RTMP 服务器。请给我一个小例子，如何正确初始化 AVFormatContext 并将我的编码视频 AVPackets 发送到服务器。

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-03T16:32:29.080

我的问题可以通过使用 ffmpeg 源代码中的示例来解决。需要文件`muxing.c`。它位于`ffmpeg\docs\examples`ffmpeg 源代码的文件夹中。将示例流写入 rtmp 服务器或文件所需的所有源代码。我必须只了解这些来源并添加我自己的流数据而不是示例流。可能会出现意想不到的问题，但总的来说 - 有一个解决方案。

# c# - Web 请求中的 CSV 格式

> ID：15143920
> 
> 赞同：0
> 
> 时间：2013-02-28T19:21:25.513
> 
> 标签：c#, javascript, asp.net, csv, asp.net-web-api

我正在使用需要 CSV 输入的 javascript 图表控件（d3 散点图）。该控件有两种请求 CSV 数据的可用方法 - 指向 CSV 文件或将返回 CSV 数据的 URL。我需要使用的方法是后者。通过 IE 开发人员工具查看响应时，我可以看到从 CSV 文件加载数据时，我得到以下响应：

![在此处输入图像描述](../Images/3ee871f0c320d0b0595995d8c6efffff.png)

当我尝试创建 CSV 字符串服务器端（ASP.Net Web API）时，将返回以下内容：

![在此处输入图像描述](../Images/e7bcfdd3fbf12204e00df43c7a8e07fb.png)

我这里有两个问题：

1) 响应用引号括起来

2) 字符串显示 /r/n 而不是实际的回车

下面是生成测试 CSV 字符串的服务器端代码。

![在此处输入图像描述](../Images/1655e77307846aa3f21dc627187e7206.png)

如何从我的服务器端方法生成格式正确的 CSV 数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T19:28:50.570

由于 JsonMediaTypeFormatter 正在编写此响应，因此响应采用 json 格式。相反，您可以返回一个具有 StringContent 的 HttpResponseMessage，它不会通过格式化程序。

一个更优雅的解决方案可能是为这些场景实现一个 CSV 媒体类型格式化程序。此处示例： [http ://www.tugberkugurlu.com/archive/creating-custom-csvmediatypeformatter-in-asp-net-web-api-for-comma-separated-values-csv-format](http://www.tugberkugurlu.com/archive/creating-custom-csvmediatypeformatter-in-asp-net-web-api-for-comma-separated-values-csv-format)

# emacs - 当服务器繁忙时，如何从 emacsclient 中向 emacs 发送 Cg/quit 信号？

> ID：15143922
> 
> 赞同：1
> 
> 时间：2013-02-28T19:21:28.657
> 
> 标签：emacs, elisp, emacsclient

在我当前的设置中，我`emacs --daemon`在启动时运行，然后用于`emacsclient`工作。但是，我注意到了这个问题。当发生复杂的处理块时，`C-g`停止工作：复杂的工作不能提前停止或终止。据我所知，这是因为在处理来自客户端的任何输入之前，emacs 客户端需要等待服务器确认。因此，`C-g`当我最需要它时，它就不起作用了——以摆脱耗时或可能具有破坏性的过程。

是否有任何解决方法，或者告诉服务器进程“停止它！”？手册的“[退出](http://www.gnu.org/software/emacs/manual/html_node/emacs/Quitting.html)”或“[紧急逃生](http://www.gnu.org/software/emacs/manual/html_node/emacs/Emergency-Escape.html)”部分似乎没有承认存在这个问题 - 所以这也可能是我做错了什么的结果。如果是这样，我做错了什么？

如果答案是“不，没有办法做你想做的事；`emacsclient`进程无法应对服务器被阻塞一段不平凡的时间”，我会将代码或文档中指出的答案标记为已接受哪里可以得到答案：我一直没能找到这样的东西。:(

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2017-11-02T08:30:28.680

到目前为止，我发现唯一可行的方法是`SIGUSR2`使用命令行向繁忙的 emacs 进程发送信号`kill`——无论它是否作为服务器运行（使用`--daemon`）。这不会强制终止 emacs 进程，同时能够中断它正在做的事情。让我们尝试一个示例来打破`sleep-for`在 emacs 服务器上运行的循环。（是的，`sleep-for`可以中断，`C-g`但这只是一个示例。它适用于emacs 不响应键盘命令的*某些情况。）*

首先，启动 emacs 服务器，然后使用`emacsclient`连接到它，输入`M-: (sleep-for 120)`. 现在转到另一个终端并使用命令行查找服务器的进程 ID `ps x|grep 'emacs.*--daemon'`：。假设我们在这里找到的 PID 是 12345。现在使用终端来破解它：

`kill -USR2 12345`

我们现在应该看到`sleep-for`循环中断了。在某些情况下，我需要多次发送此信号。

另请注意，建议`SIGUSR1`不`SIGUSR2`要这样做，这可能仅适用于高于 v24 的 Emacs 版本。希望这可以帮助！

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-01T00:10:10.447

不幸的是，我认为没有优雅的解决方案。一种可能性是创建一个备用的 emacsclient 会话，隐藏在 tmux/screen 会话中，您可以将其重新启动，然后在其中插入 Cg。但这有点恶心。

# class - 考试不及格

> ID：15143925
> 
> 赞同：0
> 
> 时间：2013-02-28T19:21:38.413
> 
> 标签：class, testing, salesforce, apex-code

我正在研究此处发布的解决方案：http: [//mysalesforcecode.blogspot.com/2012/09/how-to-copy-record-owner-from-cloning.html](http://mysalesforcecode.blogspot.com/2012/09/how-to-copy-record-owner-from-cloning.html)

按钮和触发器按预期工作，但由于我的测试中的第二个系统断言（测试机会所有者是否根据原始所有者字段保留。我是一个顶点新手，所以我可能是做一些明显错误的事情......希望如此 - 谢谢！

按钮：

```
{!URLFOR( $Action.Opportunity.Clone,Opportunity.Id,     
[cloneli=1,opp11='Prospecting',opp12='10',opp9= 
TEXT(MONTH(Opportunity.CloseDate))+"/" 
+TEXT(DAY(Opportunity.CloseDate))+"/" 
+TEXT(YEAR(Opportunity.CloseDate)+1) 
])}&00NZ0000000kfYf={!Opportunity.OwnerId}&retURL={!Opportunity.Id} 
```

触发器（根据下面的答案更新）：

```
trigger OwnerIdChange on Opportunity (before insert)
{
 for(Opportunity o : Trigger.new)
 {
  if(o.OriginalOwner__c != null)
     o.OwnerId = o.OriginalOwner__c;
 }
} 
```

测试类：

```
@istest
private class Opportunities_Test {

    static testMethod void Opportunities_Test1() {
    test.starttest();

      Profile p = [SELECT Id FROM Profile WHERE Name='Standard User'];
      User u = new User(Alias = 'standt', Email='standarduser@testorg.com',
      EmailEncodingKey='UTF-8', LastName='Testing', LanguageLocaleKey='en_US',
      LocaleSidKey='en_US', ProfileId = p.Id,
      TimeZoneSidKey='America/Los_Angeles', UserName='standarduser@testorg.com');
      insert u;

      Profile s = [SELECT Id FROM Profile WHERE Name='System Administrator'];
      User u2 = new User(Alias = 'admin', Email='admin@testorg.com',
      EmailEncodingKey='UTF-8', LastName='Testing2', LanguageLocaleKey='en_US',
      LocaleSidKey='en_US', ProfileId = s.Id,
      TimeZoneSidKey='America/Los_Angeles', UserName='admin@testorg.com');
      insert u2;

     Account a = new account(Name = 'Test1');
     insert a;

     List <Opportunity> Opportunity;
            Opportunity O1 = new Opportunity();
            O1.ownerid = u.id;
            O1.accountid = a.id;
            O1.Amount= 1;
            O1.CloseDate = Date.today();
            O1.Name = 'Testing';
            O1.StageName= 'Prospecting';
            insert O1;

 Account b = new account(Name = 'Test2');
 insert b;

      List <Opportunity> Opportunity2;
        Opportunity O2 = new Opportunity();
        O2.accountid = b.id;
        O2.ownerid = u.id;
        O2.Amount= 1;
        O2.CloseDate = Date.today();
        O2.Name = 'Testing2';
        O2.StageName= 'Prospecting';
        O2.OriginalOwner__c= u2.id;
        insert O2;  

List<Opportunity> z = [SELECT Id, Ownerid, Name FROM Opportunity WHERE id= :O2.id];

 system.assertEquals(O1.ownerid, u.id);
 system.assertEquals(O2.OwnerID, u2.id);

     test.stoptest();          
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T07:33:53.077

您的触发逻辑有点疯狂，尝试将其更改为以下内容，看看是否会得到不同的结果。

```
trigger OwnerIdChange on Opportunity (before insert)
{
   for(Opportunity o : Trigger.new)
   {
      if(o.OriginalOwner__c != null)
         o.OwnerId = o.OriginalOwner__c;
   }
} 
```

编辑：根据下面的评论，还应该指出，在插入和更新记录后，他没有获得记录的更新值。重新查询机会记录并根据这些返回值进行断言。

# asp.net - 我无法让图像显示在简单的 ASP.Net 自定义控件中

> ID：15143928
> 
> 赞同：0
> 
> 时间：2013-02-28T19:21:57.237
> 
> 标签：asp.net, custom-controls

我有使用 .ascx 用户控件的经验，但我想熟悉自定义控件。

我创建了一个包含嵌入文件（css、jQuery 和 prettyBox 文件）以及图像的简单控件。

这个控件所做的只是显示一个 img 链接，该链接将在 prettyBox 窗口中启动一些内联内容。

我可以毫无问题地启动内联内容，但我用作链接按钮的 img 没有显示，我不确定如何正确引用它。

这就是我引用所有嵌入文件的方式。img 与所有其他文件位于根目录中。

```
//Embedded Resources (reference files using project namespace)
[assembly: WebResource("CustomControlDemo.slide1.jpg", "image/jpg")]
[assembly: WebResource("CustomControlDemo.control.css", "text/css")]
[assembly: WebResource("CustomControlDemo.jquery-1.6.1.min.js", "text/javascript")]
[assembly: WebResource("CustomControlDemo.jquery.prettyPhoto.js", "text/javascript")]
[assembly: WebResource("CustomControlDemo.control.js", "text/javascript")] 
```

然后我只是发出了一些简单的html。问题是当我使用浏览器工具检查时找不到 img。

```
 protected override void RenderContents(HtmlTextWriter writer)
        {
            writer.Write(@"<a href=""#inline"" rel=""prettyPhoto"">
                             <img src=""slide1.jpg"" alt="""" 
                                  width=""100px"" height=""67px""/>
                           </a>

                           <div id=""inline"" class=""hidden"">
                              <h1>This is inline content!</h1>
                           </div>");
        } 
```

您究竟如何在自定义控件中引用嵌入的 img？我希望能够将它们放在他们自己的文件夹中，但现在我只想能够显示一个根 img。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T19:28:38.920

[这个问题](https://stackoverflow.com/questions/7785173/setting-css-background-image-where-the-image-is-a-resource-or-webresource-in-a)（这是我的）询问了如何使用带有 CSS 的嵌入式图像，但我相信问题和答案中的一些链接适用于图像控件。

这是一个例子：

```
<img src="<%= ClientScript.GetWebResourceUrl(typeof(Westwind.Web.Controls.AjaxMethodCallback),
                                        "Westwind.Web.Controls.Resources.calendar.gif") %>" /> 
```

# c# - 哪些软件可用于创建服务器端 PDF 文件？

> ID：15143930
> 
> 赞同：3
> 
> 时间：2013-02-28T19:22:02.970
> 
> 标签：c#, asp.net, asp.net-mvc, pdf, pdf-generation

我需要一个强大的产品，用于使用用于 ASP.NET WebForms/MVC 的 C# API 从 Web 服务器上的网页创建 PDF 文件。该产品应支持标记中的 SVG 和 PATH 标记，并且能够呈现通过在呈现页面后触发的 ajax 调用创建的标记。以下步骤将使您更好地了解我要完成的工作。

1.  用户单击网页上的“导出为 PDF”按钮。这会将请求发送到通用处理程序（ashx 文件）。

2.  通用处理程序验证用户的凭据和安全许可，然后将要呈现为 PDF 文件的网页的 URL 传递给 PDF 生成工具（这是 C# API 发挥作用的地方）。

3.  PDF 生成工具将 PDF 文件保存在服务器上的临时文件夹中。

4.  临时 PDF 被读入字节数组并发送到响应流，然后用户可以在其中下载文件。

5.  如果 PDF 生成工具支持它，它会将 PDF 文件返回到用户的浏览器，而不是保存到服务器上的临时位置。

我目前正在使用 activePDF 的 WebGrabber 工具来完成此操作，但在渲染 Kendo DataViz 图表时遇到问题（它们使用 SVG 和 PATH 标签）。我也试过 Aspose.Pdf 这太可怕了。我想知道是否有人对此有任何经验并且可以推荐可以处理这些要求的专业工具。

只是一些最后的笔记：

*   WebBrowser.Print() 方法不是一个选项。
*   Adobe 是否针对这些要求提供任何服务？
*   我查看了 iText，但不知道它是否支持 Kendo DataViz 图表。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T19:35:13.453

我们需要使用我们的 WCF 服务在服务器中生成 PDF。我们需要创建 PDF 并合并，我们使用了 PDFSharp，不确定它是否可以处理您所描述的内容。

[http://www.pdfsharp.net/](http://www.pdfsharp.net/)

我们还使用了 ActiveReports 服务器版本 7，它以 xml 格式输入并以 PDF、WORD 和 HTML 格式输出

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T19:32:13.460

我通常使用[ActiveReports](http://www.componentone.com/SuperProducts/ActiveReports/)来生成 PDF，但这更像是一个可以导出为 PDF 的报告引擎。如果您可以获取截图作为图像，您可以将图像动态添加到报告中，然后将其发送到 PDF。

或者，如果要求打印特定页面，例如收据，那么我不会获取 URL。相反，我会将收据布置为报告，然后提供适当的数据来生成该报告，将其导出为 PDF，并将其传送到浏览器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-28T22:44:43.403

我之前在 ASP.NET MVC 中使用[wkhtmltopdf](http://code.google.com/p/wkhtmltopdf/)从网页渲染了 PDF 。但是，我一直将其称为 exe，而不是 API。

看起来有一个项目在[这里](https://github.com/pruiz/WkHtmlToXSharp)为其提供 C# API 。

# c# - 带有多线程的 Console.ReadKey() 的奇怪行为

> ID：15143931
> 
> 赞同：10
> 
> 时间：2013-02-28T19:22:09.910
> 
> 标签：c#, multithreading, console-application

`Console.ReadKey()`在多线程程序中使用时遇到一个奇怪的问题。

我的问题是：为什么会这样？这是一个错误，还是因为我在滥用`Console`？（请注意，[根据文档，控制台](http://msdn.microsoft.com/en-us/library/43zwz7ys.aspx)*应该*是线程安全的。）

用代码最容易解释这一点：

```
using System;
using System.Threading;
using System.Threading.Tasks;

namespace ConsoleApplication2
{
    internal class Program
    {
        private static void Main(string[] args)
        {
            Console.WriteLine("X");  // Also try with this line commented out.
            Task.Factory.StartNew(test);
            Console.ReadKey();
        }

        private static void test()
        {
            Console.WriteLine("Entering the test() function.");
            Thread.Sleep(1000);
            Console.WriteLine("Exiting the test() function.");
        }
    }
} 
```

*如果您运行它并且不*按任何键，您认为会打印出什么？

答案正是您所期望的：

```
X
Entering the test() function.
Exiting the test() function. 
```

现在注释掉`Console.WriteLine("X")`并再次运行它（不按任何键）。我希望看到这个输出：

```
Entering the test() function.
Exiting the test() function. 
```

相反，我*什么也*没看到。然后当我按下一个键时，它会说：

```
Entering the test() function. 
```

……就是这样。程序退出（当然）并且没有时间进入下一个`WriteLine()`.

我觉得这种行为很神秘。这很容易解决，但我对它为什么会发生很感兴趣。

[编辑]

如果我在它按预期工作`Thread.Sleep(1)`之前立即添加。`Console.ReadKey()`当然，这不应该是必要的，因为`Console.ReadKey()`无论如何都应该永远等待。

所以看起来它可能是某种竞争条件？

更多信息：Servy 发现（并且我已经复制）该线路`Console.WriteLine("Entering the test() function.")`被阻塞，直到按下任何键。

**构建配置**

Visual Studio 2012，Windows 7 x64，四核，英语（英国）。

我已经尝试了 .Net4、.Net4.5、x86、AnyCPU 以及调试和发布的所有组合，但它们都不能在我的 PC 上运行。但是发生了一件非常奇怪的事情。当我第一次尝试 .Net4 的 AnyCPU 版本时它开始工作，但随后又停止工作。看起来很像只影响某些系统的竞争条件。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-02-28T20:06:22.767

这是一个竞争条件。这是第一个 Console.WriteLine 不存在时发生的情况：

1.  任务已创建，但未运行
2.  Console.ReadKey 执行，锁定 Console.InternalSyncObject，并阻塞等待输入
3.  Task 的 Console.WriteLine 调用 Console.Out，Console.Out 调用 Console.InitializeStdOutError 进行首次初始化设置控制台流
4.  Console.InitializeStdOutError 尝试锁定 Console.InternalSyncObject，但 Console.ReadKey 已经拥有它，因此它阻塞
5.  用户按下一个键，Console.ReadKey 返回，释放锁
6.  对 Console.WriteLine 的调用被解除阻塞并完成执行
7.  进程退出，因为 ReadKey 调用后 Main 中没有任何内容
8.  任务中剩余的代码没有机会运行

将 Console.WriteLine 留在其中时行为不同的原因是因为对 Console.InitializeStdOutError 的调用没有与 Console.ReadKey 并行发生。

所以简短的回答是：是的，您正在滥用控制台。您可以自己初始化控制台（通过取消引用 Console.Out），或者在启动 Task 之后但在 ReadKey 之前等待事件，然后在第一次调用 Console.WriteLine 后让 Task 发出事件信号。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-22T13:55:24.197

已确认 .NET 4.5 中的内部错误。例如，这里已经报道过：[https ://connect.microsoft.com/VisualStudio/feedback/details/778650/undocumented-locking-behaviour-in-system-console](https://connect.microsoft.com/VisualStudio/feedback/details/778650/undocumented-locking-behaviour-in-system-console)

这适用于 .NET 3.5 和 .NET 4。

更多信息：http: [//blogs.microsoft.co.il/blogs/dorony/archive/2012/09/12/console-readkey-net-4-5-changes-may-deadlock-your-system.aspx](http://blogs.microsoft.co.il/blogs/dorony/archive/2012/09/12/console-readkey-net-4-5-changes-may-deadlock-your-system.aspx)

您可以使用简单的解决方法来初始化内部结构并避免阻塞。只需将其添加到开头（来自@renestein）：

```
Console.Error.WriteLine(); 
Console.WriteLine(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T19:27:46.740

这可能是因为它是多线程的。在您的异步任务有机会报告回来之前，您的主线程正在继续并退出。当主线程退出时，所有子线程都被杀死。

如果您在 ReadKey 之前放置一个等待会怎样？它输出正确吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-03-22T15:46:26.277

根据我的评论，如果启用了“QuickEdit”（Windows 控制台功能，而不是 .NET），则可能会发生这种情况。在这种情况下，单击控制台窗口将阻止写入。

在窗口外单击、按转义键或禁用 QuickEdit 可修复此问题：

相关：[命令提示符中的 QuickEdit 模式如何以及为什么会冻结应用程序？](https://stackoverflow.com/questions/30418886/how-and-why-does-quickedit-mode-in-command-prompt-freeze-applications)

# php - 通过 php 进行文本简化以简化搜索

> ID：15143938
> 
> 赞同：0
> 
> 时间：2013-02-28T19:22:58.140
> 
> 标签：php, search, similarity, string-hashing

我正在开发一个允许在同一个城市搜索人的功能。

由于我不期待使用地理位置，我让用户输入他们的城市。因此，为了让人们找到彼此，他们需要输入相同的城市名称。

现在，我正在使用区分大小写的数据库，因此字符串需要匹配，所以我想有一个简化过程，如下所示：

```
- user inputs city "New York"
  ->new york
  ->newyork 
```

接下来我期待做的是确保输入“new yprk”作为拼写错误的人仍然能够找到彼此。

我不想重新发明轮子，所以，是否有一个脚本，你知道那种“散列”单词，以便稍微不同的单词算作相同？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T19:40:13.030

不幸的是，没有地理位置就无法做到这一点，因为城市是名称，如果这些是任意的英语单词，您可以使用某种拼写检查库来生成匹配并运行固定查询，但由于这些是城市，您需要地理位置数据库。

现在有一种潜在的解决方法是使用世界城市数据库作为拼写检查库的字典，但我不确定它的准确性如何。如果您不希望有大量流量，请使用谷歌免费层地理编码，或者这是一个免费的替代方案：

[http://wiki.openstreetmap.org/wiki/Nominatim#Reverse%5FGeocoding%5F.2F%5FAddress%5Flookup](http://wiki.openstreetmap.org/wiki/Nominatim#Reverse%5FGeocoding%5F.2F%5FAddress%5Flookup)

如果没有某种字典或第 3 方服务，就无法猜测名称。其他方法包括使用谷歌预测 API 并使用所有城市名称加载它，但当然这也是第 3 方......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T19:35:44.533

不，因为像那样聪明会带来很多误报。你为什么不再次检查你的城市已知城市列表，如果它存在继续，否则会引发错误

[http://www.maxmind.com/en/worldcities](http://www.maxmind.com/en/worldcities)

一个

# javascript - 删除选择的焦点

> ID：15143946
> 
> 赞同：6
> 
> 时间：2013-02-28T19:23:24.217
> 
> 标签：javascript, html, css, internet-explorer

我的问题可能很愚蠢，但我想知道是否有机会改变这种行为。

我注意到，当您单击选择标签的箭头打开下拉选项时，当您指向一个选项时，它会以蓝色背景突出显示，这没关系。

但是在 IE 中，当您单击要选择的选项并成为选定选项时，蓝色突出显示将一直保持，直到您单击选择标记之外的其他位置（在 firefox - 中并非如此）。但是我明白我应该做什么，并在选择一个选项时从元素中移除焦点。

```
$('select').change(function() {
    $(this).blur();
}) 
```

但是仍然存在一个小问题 - 如果选择的选项与前一个相同（例如我连续两次选择一个元素），焦点将保持在选择上并且蓝色突出显示再次打开。有什么办法可以改变

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-04-05T02:10:50.503

在 IE11（不确定以前的版本）中，您可以使用以下命令从焦点选择元素中删除蓝色背景

```
select::-ms-value {background: none;} 
```

[这是一个 dabblet 演示](http://dabblet.com/gist/9986628)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-28T19:26:41.730

在css中试试这个：

```
input:focus,
select:focus,
textarea:focus,
button:focus {
    outline: none;
} 
```

我想这就是你要找的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T19:47:02.860

您可以在 css 中设置选定的下拉菜单背景颜色：

```
select:focus { 
    background: #fff;
} 
```

至于删除元素的焦点，您将产生比您解决的问题更多的问题，如果有必要，我会重新考虑。

# c# - 使用自定义任务工厂创建但不启动任务？

> ID：15143948
> 
> 赞同：8
> 
> 时间：2013-02-28T19:23:45.103
> 
> 标签：c#, task-parallel-library

我希望能够在不启动任务的情况下创建任务，类似于运行`var a = new Task(); a.Start();`但使用自定义工厂。工厂提供`StartNew()`，但我找不到将这两个动作分开的方法。这可能吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-28T19:28:02.913

A`TaskFactory`基本上是两组默认选项（创建和继续）、一个默认取消令牌和一个任务调度程序。

您可以在刚刚新建任务时指定取消令牌和创建选项 - 然后在您想要的任何调度程序上启动它。所以：

```
Task task = new Task(action,
                     factory.CancellationToken,
                     factory.CreationOptions);
...
task.Start(factory.Scheduler); 
```

应该做除了延续选项以外的工作。延续选项仅在您添加延续时才相关，您可以直接指定。有什么不属于这个的吗？

（需要注意的一点是，基于任务的异步模式通常围绕“热”任务展开，这些任务在您看到它们时就已启动。因此，您可能希望避免过于广泛地暴露未启动的任务。）

# android - 在一个请求中获取读取和发布权限

> ID：15143951
> 
> 赞同：20
> 
> 时间：2013-02-28T19:23:56.740
> 
> 标签：android, facebook, facebook-android-sdk, android-facebook

在你们都说不可能之前，打开 Spotify 应用程序并点击使用 Facebook 登录按钮。

我想知道他们是如何做到的，以及如何在一个请求中获得“publish_stream”和基本权限/电子邮件。

另外，如果我有上次会话的某些信息（他们上次使用该应用程序），我是否可以使用 Facebook SDK 重新打开 Facebook 会话？

**编辑**下面的屏幕截图以获取 MUSICALLY AVERT

![Spotify 魔术](../Images/5f283e58067b14dacf9ad77e8368e9ae.png)

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-03-11T07:19:02.583

你在 Spotify 上看到的不是`publish_stream`.What 他们使用的是[Open Graph](http://developers.facebook.com/docs/concepts/opengraph/)

开放图概念涉及将应用程序的操作与 FB 活动帖子集成，并通过他们使用的应用程序与用户共享。在上述链接中阅读更多相关信息。

* * *

编辑***说明***： [检查 Open Graph Permissions](https://developers.facebook.com/docs/reference/login/open-graph-permissions/)

示例活动：

```
public class MainActivity extends Activity implements StatusCallback {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        OpenRequest open = new OpenRequest(this);
        open.setLoginBehavior(SessionLoginBehavior.SUPPRESS_SSO);
        open.setPermissions(Arrays.asList(new String[]{"email", "publish_actions", "user_birthday", "user_hometown"}));
        open.setCallback(this);
        Session s = new Session(this);
        s.openForPublish(open);
    }

    @Override
    public void call(Session session, SessionState state, Exception exception) {
    }

    @Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data) {
        super.onActivityResult(requestCode, resultCode, data);
        if(Session.getActiveSession()!=null)
            Session.getActiveSession().onActivityResult(this, requestCode, resultCode, data);
    }
} 
```

此活动将显示此内容（如果用户未登录）：

![在此处输入图像描述](../Images/9d3459c947ed456b04197c78ae3dc599.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T12:54:12.060

在我的应用程序中，我为 OpenRequest 创建了一个实例，并为其设置了权限。

```
Session currentSession = Session.getActiveSession();
if (currentSession == null || currentSession.getState().isClosed()) 
{
    Session session = new Session.Builder(context).build();
    Session.setActiveSession(session);
    currentSession = session;
}

if (currentSession.isOpened()) 
{
    //Do whatever u want. User has logged in
}
else if(!currentSession.isOpened())
{
    //Ask for username and password
    OpenRequest op = new Session.OpenRequest(context);

    op.setLoginBehavior(SessionLoginBehavior.SUPPRESS_SSO);
    op.setCallback(null);

    List<String> permissions = new ArrayList<String>();
    permissions.add("publish_stream");
    op.setPermissions(permissions);

    Session session = new Builder(InvitePartners.this).build();
    Session.setActiveSession(session);
    session.openForPublish(op);
} 
```

它可能对你有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-05-04T01:06:42.900

我只是在 onCreate 方法中单独设置。

```
 LoginButton authButton = (LoginButton) view.findViewById(R.id.authButton);
    authButton.setPublishPermissions("publish_actions");
    authButton.setFragment(this);
    Session.NewPermissionsRequest newPermissionsRequest = new 
            Session.NewPermissionsRequest(this, Arrays.asList("read_stream"));
    Session.getActiveSession().requestNewReadPermissions(newPermissionsRequest); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-04T23:51:06.347

转到您的应用程序仪表板。然后点击编辑应用。现在在页面的左侧你会看到`Permission`。点击它。一个新的页面将会到来。找出`User & Friend Permissions:`框。在这里输入`publish_actions`。现在保存。

现在从您的 Android 应用程序中，您只需登录一次即可将故事发布到 Facebook。我的意思是，只需使用 登录`LoginButton`，然后尝试发布一些内容。它应该工作。

让我知道发生了什么。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-05T16:07:00.350

对于任何想知道我的问题的第二部分的人：

要使用 Facebook SDK 重新打开 Facebook 会话，请使用此代码

```
if(Session.openActiveSession(this) == null) { //Haven't logged in yet
    openSessionForRead(getString(R.string.app_id), Arrays.asList("email"));
} 
```

Facebook 缓存令牌。

# javascript - 无法从 Javascript 中删除文档中的一组节点

> ID：15143958
> 
> 赞同：0
> 
> 时间：2013-02-28T19:24:24.240
> 
> 标签：javascript, html, xml, rss

我正在尝试从网页上的 rss 文档中删除节点。

我想从：

```
<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0">
<channel>

 <title></title>
 <link></link>
 <description></description>

 <item>
  <title>53w5</title>
  <link>est</link>
  <description></description>      
 </item>

</channel>
</rss> 
```

到：

```
<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0">
 <channel>

 <title></title>
 <link></link>
 <description></description>

</channel>
</rss> 
```

只是删除该项目（以及他的所有孩子）。

这是我加载 XML 的函数：

```
function loadXMLDoc(dname) {

        if (window.XMLHttpRequest) {
            xhttp = new XMLHttpRequest();
        }
        else {
            xhttp = new ActiveXObject("Microsoft.XMLHTTP");
        }
        xhttp.open("GET", dname, false);
        xhttp.send("");
        return xhttp.responseXML;
    } 
```

这是我必须删除块的代码：

```
 xmlDoc = loadXMLDoc("rssFeed.xml");        
    it = xmlDoc.getElementsByTagName("item");        
    it.parentNode.removeChild(it); 
```

在 Chrome 中运行时，我总是遇到错误“Uncaught TypeError: Cannot call method 'removeChild' of undefined”。我的 xml 文件正确加载，因为我可以在请求后在网络中看到它。

帮助将不胜感激。

安托万

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T19:38:23.447

```
var it = xmlDoc.getElementsByTagName("item");

for (var i = it.length; i--; )
    it[i].parentNode.removeChild(it[i]); 
```

# c# - MathEvaluator 解析器

> ID：15143967
> 
> 赞同：-1
> 
> 时间：2013-02-28T19:25:08.330
> 
> 标签：c#, .net, wpf

如何？但是我需要一个解析器，它只解析一次字符串并且有一个像这样的接口

```
Func<double,double> MathEvaluator(string input) 
```

或者像这样

```
LambdaExpression MathEvaluator(string input) 
```

它存在吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T19:44:04.790

我想参考[这个](https://stackoverflow.com/questions/5312225/best-free-c-sharp-math-parser-using-variables-user-defined-functions-custom-op)线程，引用由[Rick](https://stackoverflow.com/users/770263/rick)、[Oliver](https://stackoverflow.com/users/177710/oliver)和[Max](https://stackoverflow.com/users/166132/max)的答案提供的结果。

*   [计算](http://ncalc.codeplex.com/)
*   [数学解析器 .NET](http://www.codeproject.com/Articles/274093/Math-Parser-NET)
*   [解析器](http://muparser.beltoforion.de/)
*   [表达式解析器](http://www.lundin.info/mathparser.aspx)
*   [铁蟒](http://ironpython.codeplex.com/)
*   [谷歌](https://www.google.com/search?q=.net%20math%20parser)

您需要考虑，哪个最符合您的要求。例如，Math Parser .NET 支持`^`幂，而其他的则不支持。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T05:52:44.470

所以我做了一个库，如果你愿意，你可以使用它，我认为它已经足够好了。有一些正则表达式，将 a^b 之类的结构替换为 Math.Pow(a,b) 等。它可能会更好，但这对我来说很难，但我正在努力。

```
using System;
using System.CodeDom.Compiler;
using System.IO;
using System.Reflection;
using System.Text.RegularExpressions;
using Microsoft.CSharp;

namespace MathEvalNS
{
public class MathEvaluator
{
    private readonly Delegate parsedFunction;
    private readonly string normalized;
    public double Invoke(double x)
    {
        if (parsedFunction == null)
            throw new NullReferenceException("No function to invoke");
        return (double)parsedFunction.DynamicInvoke(x);
    }
    private const string Begin =
        @"using System;
namespace MyNamespace
{
    public static class LambdaCreator 
    {
        public static Func<double,double> Create()
        {
            return (x)=>";
        private const string End = @";
        }
    }
}";

    public MathEvaluator(string input)
    {
        normalized = Normalize(input);
        var provider = new CSharpCodeProvider();
        var parameters = new CompilerParameters { GenerateInMemory = true };
        parameters.ReferencedAssemblies.Add("System.dll");
        CompilerResults results = provider.CompileAssemblyFromSource(parameters, Begin + normalized + End);
        try
        {
            var cls = results.CompiledAssembly.GetType("MyNamespace.LambdaCreator");
            var method = cls.GetMethod("Create", BindingFlags.Static | BindingFlags.Public);
            parsedFunction = (method.Invoke(null, null) as Delegate);
        }
        catch (FileNotFoundException)
        {
            throw new ArgumentException();
        }
    }

    private string Normalize(string input)
    {
        return input.ReplaceMath().ReplacePow().ReplaceMultipling().ReplaceToDoubles();
    }
}

public static class StringHelper
{
    public static string ReplaceMultipling(this string input)
    {
        return Regex.Replace(input, @"(\d+)(x)", @"$1*$2");
    }

    public static string ReplacePow(this string input)
    {
        var result = input.ReplacePow(@"(\d*x)\^(\d+\.?\d*)");
        return result.ReplacePow(@"\(([^\^]+)\)\^(\d+\.?\d*)");
    }

    private static string ReplacePow(this string input, string toReplace)
    {
        return Regex.Replace(input, toReplace, "Math.Pow($1,$2)");
    }

    public static string ReplaceToDoubles(this string input)
    {
        return Regex.Replace(input, @"(\d+)(?:[^\.]\d+)", "$1.0");
    }

    public static string ReplaceMath(this string input)
    {
        return
            input.ReplaceMath("sin", @"Math.Sin")
                 .ReplaceMath("cos", @"Math.Cos")
                 .ReplaceMath("ctg", @"1.0/Math.Tan")
                 .ReplaceMath("tg", @"Math.Tan");
    }

    private static string ReplaceMath(this string input, string name, string dotNetName)
    {
        return Regex.Replace(input, name, dotNetName, RegexOptions.IgnoreCase);
    }
}
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-16T08:48:00.550

我有一个 MathParser：http: [//github.com/MathewSachin/MathParser](http://github.com/MathewSachin/MathParser)

我希望你想要的可以这样完成：

```
Fuc<double, double> Parse(string Expression)
{
    MathParser P = new MathParser();
    Variable V = new Variable("x", 0); // The Variable you use with default value
    P.Variables.Add(V);

    P.Parse(Expression);

    return (Input) =>
        {
            V.Value = Input;
            return P.Evaluate();
        }
} 
```

我唯一担心的是垃圾收集。

# regex - 使用正则表达式选择多行数据？

> ID：15143968
> 
> 赞同：3
> 
> 时间：2013-02-28T19:25:10.463
> 
> 标签：regex, textpad

我正在处理`TextPad`. 我想在两颗星之间选择多行数据。例如：

```
abc
*
cvb
vvnbj
vnbvn
*
cvb 
```

我想选择两颗星之间的三行。我们如何使用正则表达式选择这些`TextPad`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-07-23T07:23:36.320

这个正则表达式字符串应该捕获星星以及介于两者之间的任何内容。

```
\*[^*]+\* 
```

[正则表达式测试器永久链接](http://regexpal.com/?flags=gs&regex=%5C%2a%5B%5E%2a%5D%2B%5C%2a&input=abc%0A%2aazasdasd%0Acvb%0Avvnbj%0Avnbvn%0A%2aasdasd%0Acvb)

# c# - 检索祖先属性

> ID：15143969
> 
> 赞同：3
> 
> 时间：2013-02-28T19:25:16.993
> 
> 标签：c#, xml, configuration-files

我正在尝试为多个应用程序构建一个外部 XML 配置文件，以容纳它们的连接字符串。该文件看起来像这样：

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<configuration>
  <Connection Name = "Primary">
    <Server Name = "DisneyWorld">
      <Database Name ="MagicKingdom">
        <Project Name ="Rides">
          <Login Username="Mickey" Password="Mouse" Encrypted="False"/>
        </Project>
        <Project Name = "Food">
          <Login Username="Goofy" Password="123456" Encrypted="True"/>
        </Project>
        <Project Name ="Shows">
          <Login Username ="Minnie" Password="Mouse" Encrypted="False"/>
        </Project>
      </Database>
    </Server>
    <Server Name = "Epcot">
      <Database Name ="LandOfTomorrow">
        <Project Name = "Innovation">
          <Login Username="Daffy" Password="Duck" Encrypted="False"/>
        </Project>
      </Database>
    </Server>
  </Connection>
</configuration> 
```

将有一个辅助连接，以防主要连接断开。我想要做的是搜索项目：食物获取其登录信息、数据库和服务器。我可以用这段代码来做：

```
XDocument doc = XDocument.Load(path);
var query = from connection in doc.Descendants("Connection")
            where connection.Attribute("Name").Value == "Primary"
            from project in connection.Descendants("Project")
            where project.Attribute("Name").Value == targetProject
            select new
            {
                Server = connection.Element("Server").Attribute("Name").Value,
                Database = project.Parent.Attribute("Name").Value,
                UserName = project.Element("Login").Attribute("Username").Value,
                Password = project.Element("Login").Attribute("Password").Value,
                Encrypted = project.Element("Login").Attribute("Password").Value
            }; 
```

该代码运行良好，但它被硬编码为当前结构。上线

```
Server = connection.Element("Server").Attribute("Name").Value, 
```

和

```
Database = project.Parent.Attribute("Name").Value, 
```

我希望能够从 project.Ancestors("Server") 中获取它们的值，但我确实了解如何实现这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T19:32:02.597

你的意思是这样的：

```
Server = project.Ancestors("Server").Single().Attribute("Name").Value;
Database = project.Ancestors("Database").Single().Attribute("Name").Value; 
```

当然，这是假设给定元素*只会*有一个祖先。

# java - 从网络交换数据

> ID：15143970
> 
> 赞同：-1
> 
> 时间：2013-02-28T19:25:33.213
> 
> 标签：java, android

我正在创建一个计算地球上接收到的太阳辐射的程序。该程序已完成且正在运行。我专门为我的城市制作了它，但我想将它推广到全世界。我和我的目标之间只有一件事：

```
double Hm[] = {
  4.38, 5.18, 5.93, 6.65, 6.67, 6.40, 5.44, 5.27, 5.62, 5.24, 4.5, 4.11
}; 
```

这个数据是我唯一想概括的东西。这些值仅适用于我的城市。我想将经度和纬度作为输入，然后将此输入转到 NASA 网站，仅提取我想要的数据并在数组中返回这些值，如上所示。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T19:36:02.450

您可以使用[LocationManager](http://developer.android.com/reference/android/location/LocationManager.html)获取位置。您可以将 Lat Lon 发送到您的网络服务，您可以通过类似的方式进行响应`JSON`

# csh - 如何在 csh 脚本中加入变量

> ID：15143973
> 
> 赞同：0
> 
> 时间：2013-02-28T19:25:47.087
> 
> 标签：csh

我正在尝试在 csh 脚本中连接两个变量

这是脚本的一部分

```
#!/bin/csh -f

set encname = _11111k_1920x1080_x264_5200_quicktime_128.mp4

set lowerisrc = `echo $isrc | tr "[:upper:]" "[:lower:]"`

echo "$lowerisrc$encname" 
```

这输出：

```
_11111k_1920x1080_x264_5200_quicktime_128.mp4 
```

lowerisrc 变量应该是一个值，例如“ggttgttgg”

似乎 lowerisrc 变量没有被识别为使用 lower 函数的字符串

如何获得以下结果作为输出？

```
ggttgttgg_11111k_1920x1080_x264_5200_quicktime_128.mp4 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T19:41:38.833

双引号不会这样嵌套。将设置的行更改`lowerisrc`为：

```
set lowerisrc = "`echo $isrc | tr '[:upper:]' '[:lower:]'`" 
```

使用您当前的代码，该行：

```
set lowerisrc = "`echo $isrc | tr "[:upper:]" "[:lower:]"`" 
```

包含 3 个双引号字符串：

```
"`echo $isrc | tr "
" "
"`" 
```

并且`[:upper:]`and`[:lower:]`可能被 shell 扩展为文件匹配模式。

**更新：**现在您已经更改了问题中的代码。我刚刚尝试了您修改后的代码（添加了一行来设置 的值`$isrc`），它可以正常工作，这使问题变得毫无意义。

这是一个适合我的完整脚本：

```
#!/bin/csh -f

set isrc = GGttGttGG
set encname = _11111k_1920x1080_x264_5200_quicktime_128.mp4
set lowerisrc = "`echo $isrc | tr '[:upper:]' '[:lower:]'`"
echo "$lowerisrc$encname" 
```

输出是：

```
ggttgttgg_11111k_1920x1080_x264_5200_quicktime_128.mp4 
```

# java - Android检测是否在设计模式下调用了构造函数？

> ID：15143975
> 
> 赞同：5
> 
> 时间：2013-02-28T19:25:54.680
> 
> 标签：java, android, xml, layout, constructor

众所周知，当 Eclipse 必须在 XML 图形布局中显示组件时，它会调用组件的构造函数，因此它知道组件的外观。

如果调用是针对设计时（以上情况）或实际运行时进行的，我如何检查构造函数调用？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-28T19:28:56.327

我想你正在寻找[`View.isInEditMode()`](http://developer.android.com/reference/android/view/View.html#isInEditMode())

# python - 用于跟踪转换和记录过程的 MongoDB Schema

> ID：15143977
> 
> 赞同：0
> 
> 时间：2013-02-28T19:25:57.503
> 
> 标签：python, mongodb, schema-design, nosql

我正在使用更灵活的 MongoDB 重新设计一个非常规范化的数据库。当前的问题是现有结构不支持在不广泛更改 MySQL 模式的情况下实施的新流程。与其修改现有系统，MongoDB 的理念似乎对业务的未来更具颗粒感。

业务规则如下：

必须跟踪原材料。将根据分析制作有关此原材料的日志。原材料将被加工并转化为组件。必须保留有关此多步骤转换的日志。一个组件将被加工成一个零件。必须保留有关此过程的日志。零件可以在装配体中使用。零件或组件可以运送给客户。此外，不同的材料完成转化的过程系统也不同。此外，它需要是动态的，以防发现优化的过程。

收藏品和文件：

*   系统 - 一组进程
*   流程 - 系统的子文档，每个系统将有许多流程
*   日志 - 带有时间戳的信息日志，其中包括机器或操作员记录的数据和事实。日志将具有不同的类型，具体取决于它们适用的过程。每个日志条目将链接回上述进程和组件之一。
*   原材料 - 跟踪原材料中的项目
*   组件 - 跟踪已从原材料转换为组件的项目
*   零件 - 跟踪从组件或原材料转换而来的物品

我的问题是关于父母和孙子对象之间的关系。我是否应该将它们包含在与子文档相同的文档中，IE（孙子代表部分）：

```
parent(Raw material): {
    name: 'parent item'
    desc: 'parent desc'
    child(component from raw material processed): [
         {
         name: 'child name'
         desc: 'child desc'
         child-property: 'some property'
         grandchild(a part): [
               {
               name: 'grandchild'
          },
            {   name: 'grandchild2'}
           ]
          },
        {
         name: 'child name 2'
         desc: 'child desc 2'
         child-property: 'some property 2'
         grandchild: [
               {
               name: 'grandchild of 2'
          },
            {   name: 'grandchild of 2 - 1'}
           ]
          }
} 
```

我预计会有大量的孙子孙女，最好的处理方法是什么？

# xcode - 将 SDL 与 XCode 4.4 一起使用

> ID：15143978
> 
> 赞同：1
> 
> 时间：2013-02-28T19:25:59.377
> 
> 标签：xcode, sdl

我正在尝试使用 XCode 4.4 运行 SDL，但遇到了问题。我完全按照该站点[http://www.lazyfoo.net/SDL_tutorials/lesson01/mac/xcode/index.php](http://www.lazyfoo.net/SDL_tutorials/lesson01/mac/xcode/index.php)的指示进行操作，但它没有编译并给我以下错误。

> ld /Users/Jeffrey/Library/Developer/Xcode/DerivedData/SDL_test1-gymiyuicyswxljbpwkggciejevaj/Build/Products/Debug/SDL_test1 normal x86_64 cd /Users/Jeffrey/Documents/Documents/Engineering/SDL_test1 setenv MACOSX_DEPLOYMENT_TARGET 10.8 /Applications/Xcode.app/ Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/clang++ -arch x86_64 -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.8.sdk -L/Users /Jeffrey/Library/Developer/Xcode/DerivedData/SDL_test1-gymiyuicyswxljbpwkggciejevaj/Build/Products/Debug-F/Users/Jeffrey/Library/Developer/Xcode/DerivedData/SDL_test1-gymiyuicyswxljbpwkggciejevaj/Build/Products/Debug-F/Library/Frameworks -filelist /Users/Jeffrey/Library/Developer/Xcode/DerivedData/SDL_test1-gymiyuicyswxljbpwkggciejevaj/Build/Intermediates/SDL_test1。build/Debug/SDL_test1.build/Objects-normal/x86_64/SDL_test1.LinkFileList -mmacosx-version-min=10.8 -framework SDL -framework Cocoa -o /Users/Jeffrey/Library/Developer/Xcode/DerivedData/SDL_test1-gymiyuicyswxljbpwkggciejevaj/构建/产品/调试/SDL_test1
> 
> 架构 x86_64 的未定义符号：“_main”，引用自：-u 命令行选项（也许您的意思是：_SDL_main） ld：未找到架构 x86_64 的符号 clang：错误：链接器命令失败，退出代码为 1（使用 - v 查看调用）

唯一的差异在于第 9 步（进入您添加的 SDLmain.m 模板文件并将 #include "SDL.h" 更改为 #include "SDL/SDL.h"）我实际上并没有找到包含语句，而是一个进口声明。然而，我尝试了两种方式。任何帮助，将不胜感激。我正在使用带有 Mountain Lion 操作系统的 Macbook Pro。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-16T10:31:16.577

不确定您是否仍然遇到此问题，但如果您遇到问题，我已经为 OSX 制作了一些教程来设置 SDL。

Xcode -[在 Xcode 中的 OSX 上设置 SDL](http://zamma.co.uk/setup-sdl2-in-xcode-osx/)

Eclipse -[在 Eclipse 中的 OSX 上设置 SDL](http://zamma.co.uk/setup-sdl2-in-eclipse-osx/)

Xcode 版本有一个指向我的 Xcode SDL2 模板的链接，这使得启动非常容易。

# shell - 是否可以将标准输出附加到另一个标准输出？

> ID：15143979
> 
> 赞同：0
> 
> 时间：2013-02-28T19:26:02.167
> 
> 标签：shell, unix, append, tail

我正在尝试运行如下命令：

```
gunzip -dc file.gz | tail +5c 
```

所以这会将**二进制**文件内容减去前 4 个字节输出到标准输出，并且它可以工作。现在我需要在流的末尾附加 3 个额外的字节，但只使用标准输出，而不是文件。

想象一下文件包含：

```
1234567890 
```

使用当前命令，我得到：

```
567890 
```

但是我需要：

```
567890000 
```

所以……有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T19:35:54.083

试试这个 ：

```
{ gunzip -dc file.gz | tail -c 5 | tr -d '\n'; echo 000; } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T14:21:41.587

好的，所以根据答案，最终的解决方案是：

```
gzcat file.gz | tail -c +5 | echo 000 
```

我不需要，实际上也不应该使用`tr -d '\n'`，因为它会删除文件中间的换行符。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-28T19:30:16.557

可能像

$ echo "`gunzip -dc file.gz | tail +5c`BBB"

（BBB 是你的三个额外字节）对你有用吗？

# javascript - AngularJs 中两个模块之间的通信

> ID：15143984
> 
> 赞同：14
> 
> 时间：2013-02-28T19:26:37.070
> 
> 标签：javascript, angularjs

这很容易想象，但我还没有找到任何资源提到解决这个问题的正确方法。

我想在一个角度**模块**中广播事件并在另一个模块中接收它。这两个模块完全不同，具有不同的代码库和用途。它们唯一的共同点是它们在同一域的网站中运行（由于相同的来源策略可能很重要）。

我知道这是可能的，例如通过 HTML5 的本地存储同步事件。我只是想知道如何正确地做到这一点。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-12-08T19:36:52.030

## “适当地”

我将首先描述应用程序的*规模*方面，以便清楚地说明要*“正确”*实现这一目标的实现方式。

首先，您有一个在*服务器*上运行的*应用程序*，其中包含一个封装*模块的**核心*。您从这里开始的较低级别可能包含*更多模块*或*控制器*。我将解决这两个问题。

 ***先决条件包括但不限于：

*   为控制器实现 Angular*范围事件*（如有必要）
*   根据规范实现[中介者模式。](http://addyosmani.com/largescalejavascript/)
*   使用自定义事件实现*SharedWorker*。
*   在服务器端实现*Event-Hub*（如有必要）

如果您需要*控制器之间的通信网络，请在**模块*中使用标准的 Angular `$scope`& `$rootScope` `.$broadcast`、`.$emit`和`.$on`实用程序——您可能已经想到了这一点；）

 *要在*模块之间进行通信，请在您的**核心*中实现中介者模式——可能，这将实现为每个模块都可以引入的服务；否则，您的模块可以被初始化并提供一个注入了*Mediator/Director的沙箱。*现在您的*应用程序核心中的**模块*可以通信了。

 *说，您需要此*应用程序*/*核心*与另一个*应用程序*进行通信。使用自定义事件实现*SharedWorker*。您可以在这里看到我为 UCLA 构建的框架[“worker.io”](https://github.com/cScarlson/worker.io)。该项目可能需要一些修饰，因此请随意将其用作编写自己的参考 -**重点**是它使用*Pseudo Port-Entanglement*。这是因为工人只允许一个`onmessage`处理程序，所以你想创建一个`new MessageEvent`; 将其作为 JSON 字符串发送到另一个端口，然后 JSON.parse` 消息以获取自定义事件并在接收事件的端口上调度该事件 - 这为您提供自定义事件。现在，任何应用程序都可以利用这个*SharedWorker*并通过它与其他应用程序进行通信——它甚至允许***在浏览器选项卡之间***进行通信。

如果您想要一种更全局的*事件驱动架构*方法，例如，让*服务器*上的模块有机会（从任何地方）响应事件——在您的服务器上实现一个*事件中心。*这可能更像是一个项目，而不是您想开始的，但是有一本很棒的书描述了如何设置它：可测试的[JavaScript，Mark Ethan Trostler](https://rads.stackoverflow.com/amzn/click/com/1449323391)。

也就是说，完全有可能在后端使用*Mediators*、*SharedWorkers*和*EventHubs为基于事件的系统优雅地实现高度优化的架构。*

上面提到的*worker.io*框架使用两个库：*Apis*（拉丁语中的Bee）和*Scriptorium*（拉丁语中的Hive）。但是，要查看如何实现库，请参阅[js 目录](https://github.com/cScarlson/worker.io/tree/master/js)。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-28T19:36:39.433

> 我只是想知道如何正确地做到这一点。

“正确”是相当主观的。“正确”是指任何有效、易于理解且可维护的方法。

也就是说，为什么不直接使用`$window`在两个单独运行的 Angular 应用程序之间传递值呢？

```
function persistFoo($scope, $window) {
   //watch window.foo
   $scope.$watch(function (){
      return $window.foo;
   }, function(v) {
      if($scope.foo !== v) {
         $scope.foo = v;
      }
   });

   //watch scope.foo
   $scope.$watch('foo', function(v) {
      if($window.foo !== v) {
         $window.foo = v;
      }
   });
}

//Module 1
app1.controller("MyCtrl1", function($scope, $window) {
  persistFoo($scope, $window);
});

//Module 2
app2.controller("MyCtrl2", function($scope, $window) {
  persistFoo($scope, $window);
}); 
```

如果您需要保留数据以供后续访问，localStorage 也可以使用。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-26T22:25:26.187

我偶然发现了一个类似的问题。这是一个 plunker，它展示了如何解决这样的问题：[http ://plnkr.co/edit/uk7ODSbgXfzqw0z6x4EH?p=preview](http://plnkr.co/edit/uk7ODSbgXfzqw0z6x4EH?p=preview)

```
var app1 = angular.module('App1', []);

app1.controller('App1Controller', function($scope) {

    // use this function to send a value to app2
    var sendText = function(newText) {
        angular.element(document.getElementById('app2')).scope().setText(newText);
    };

    $scope.$watch('text', function(newText) {
        sendText(newText);
    });

    // initial value
    $scope.text = "Some text";
});

/*

 The code above and below do not share any module, service, etc.

*/

var app2 = angular.module('App2', []);
app2.controller('App2Controller', function($scope) {

    // this function will be called from app1 when text changes
    $scope.setText = function(newText){
        $scope.$apply(function() {
            $scope.text = newText;
        });
    };

}); 
```*****

# jquery - 根据类拆分表 - Jquery

> ID：15143986
> 
> 赞同：0
> 
> 时间：2013-02-28T19:26:42.937
> 
> 标签：jquery, split, html-table

我一直在研究这个小脚本，它删除了表格上一些不必要的行和列。每个`rowspan=4`都是下面行的标题。

我不确定如何从每个 rowspan 标签下的内容创建单独的表格（保留标题）。下面的示例/jsfiddle 将是 3 个单独的表。这将是动态的，因为行的数量会有很大的变化，但列的数量不会。如果您需要更多信息，请告诉我。

如果我不清楚，请告诉我。我在这方面遇到了困难，所以任何帮助都会非常有帮助。

```
$(document).ready(function() {
  var c1 = $("table tbody tr[rowspan='4'] td");    
  var c2 = $("table tbody tr[rowspan='4']").addClass("Header");
  var d1 = $(c1).closest("tr").next("tr");
  var d2 = $("td:nth-child(2),td:nth-child(3),td:nth-child(4)");
  var d3 = $("tr").find("td[align='right']").remove(); 
  var newTable = $(c2).nextUntil(c2).addClass("item");

  $(d1).remove();
  $(d2).remove();
  $(d3).remove(); 

  });

  <table>

  <tr rowspan="4">
    <td><b>Channel: A&amp;E</b></td>
 </tr>
  <tr>
    <td>Show Name</td>
    <td>Number of Episodes</td>
    <td>Duration (min)</td>
    <td>Type</td>
 </tr>
 <tr>
        <td>Zoo</td>
        <td>1</td>
        <td>43.32</td>
        <td>TV Show</td>
     </tr>

     <tr>
        <td>Hoarders</td>
        <td>1</td>
        <td>43.32</td>
        <td>TV Show</td>
     </tr>
     <tr>
        <td align="right"><b>Total:</b></td>
        <td><b>1</b></td>
        <td colspan="2"><b>43.32 m<br>0.72 h</b></td>
     </tr>
     <tr rowspan="4">
        <td><b>Channel: Adult Swim</b></td>
     </tr>
     <tr>
        <td>Show Name</td>
        <td>Number of Episodes</td>
        <td>Duration (min)</td>
        <td>Type</td>
     </tr>
     <tr>
        <td>The Brak Show</td>
        <td>3</td>
        <td>35.3</td>
        <td>TV Show</td>
     </tr>
     <tr>
        <td>Delocated</td>
        <td>9</td>
        <td>201.46</td>
        <td>TV Show</td>
     </tr>
     <tr>
        <td>Durarara!!</td>
        <td>5</td>
        <td>113.89</td>
        <td>TV Show</td>
     </tr>
     <tr>
        <td>Fullmetal Alchemist Brotherhood</td>
        <td>5</td>
        <td>113.24</td>
        <td>TV Show</td>
     </tr>
     <tr>
        <td>Home Movies</td>
        <td>5</td>
        <td>114.68</td>
        <td>TV Show</td>
     </tr>
     <tr>
        <td>The Venture Bros</td>
        <td>10</td>
        <td>229.05</td>
        <td>TV Show</td>
     </tr>
     <tr>
        <td>Titan Maximum</td>
        <td>1</td>
        <td>23.16</td>
        <td>TV Show</td>
     </tr>
     <tr>
        <td>Off the Air</td>
        <td>5</td>
        <td>56.52</td>
        <td>TV Show</td>
     </tr>
     <tr>
        <td>Sealab 2021</td>
        <td>3</td>
        <td>33.46</td>
        <td>TV Show</td>
     </tr>
     <tr>
        <td>Stroker and Hoop</td>
        <td>2</td>
        <td>45.62</td>
        <td>TV Show</td>
     </tr>
     <tr>
        <td>Black Dynamite</td>
        <td>5</td>
        <td>113.89</td>
        <td>TV Show</td>
     </tr>
     <tr>
        <td>Samurai 7</td>
        <td>5</td>
        <td>111.23</td>
        <td>TV Show</td>
     </tr>
     <tr>
        <td>Sym-Bionic Titan</td>
        <td>7</td>
        <td>164.14</td>
        <td>TV Show</td>
     </tr>
     <tr>
        <td>Tenchi Muyo! GXP</td>
        <td>5</td>
        <td>111.09</td>
        <td>TV Show</td>
     </tr>
     <tr>
        <td align="right"><b>Total:</b></td>
        <td><b>70</b></td>
        <td colspan="2"><b>1466.73 m<br>24.45 h</b></td>
     </tr>
     <tr rowspan="4">
        <td><b>Channel: AMC</b></td>
     </tr>
     <tr>
        <td>Show Name</td>
        <td>Number of Episodes</td>
        <td>Duration (min)</td>
        <td>Type</td>
     </tr>
     <tr>
        <td>The Walking Dead</td>
        <td>2</td>
        <td>10.86</td>
        <td>TV Show</td>
     </tr>
     <tr>
        <td align="right"><b>Total:</b></td>
        <td><b>2</b></td>
        <td colspan="2"><b>10.86 m<br>0.18 h</b></td>
     </tr> 
```

[http://jsfiddle.net/arkjoseph/DRCrg/2/](http://jsfiddle.net/arkjoseph/DRCrg/2/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T01:36:14.837

您可以使用数据集对元素进行分组。即`$(e).data('set', i)`在for循环中。

然后遍历所有`tr`并过滤带有`'set'`数据键的那些。

最后将它们格式化成表格。

```
...
var c2 = $("table tbody tr[rowspan='4']").each(function (i, e) {
    $(e).addClass("Header").data('set', i);
});
...
var newTable = $(c2).nextUntil(c2).each(function (i, e) {
    var set = $(e).prevUntil('.Header').last().prev().data('set');
    $(e).addClass("item").data('set', set);
});
...
$(".Header").prev().remove();
var html = [];
$('#old tr').each(function (i, e) {
    if (!html[$(e).data('set')]) html[$(e).data('set')] = '';
    html[$(e).data('set')] += $(e)[0].outerHTML;
});
for (var i = 0; i < html.length; i++) {
    var result = '<br><table><tbody>' + html[i] + '</tbody></table>';
    $('body').append(result);
} 
```

演示：http: [//jsfiddle.net/indream/DRCrg/3/](http://jsfiddle.net/indream/DRCrg/3/)

注意：我在上面的演示中使用了 outerHTML，这可能会在某些浏览器中引起一些错误。

# xcode - 使用名称和密码对 Github 远程进行身份验证

> ID：15143995
> 
> 赞同：3
> 
> 时间：2013-02-28T19:27:05.993
> 
> 标签：xcode, git, github

我需要将项目上传到朋友的 github 帐户。我有登录名和密码。当我尝试推送项目时，它总是询问名称和密码，我尝试输入登录名和密码或 github 的主目录（在屏幕上用黑色绘制）密码，尝试使用空密码，但始终注意名称不正确或密码。我尝试在 github 上创建 repo 并将其克隆到我的 Mac，然后将文件复制到这个克隆的 repo 并在提交后 - 推送。但我再次需要输入名称和密码。它是什么？一些画面：

```
repo on github 
```

![在此处输入图像描述](../Images/e1d076e2c80821bf2af8f42703812128.png)

```
add repo in xcode 
```

![在此处输入图像描述](../Images/7e0c564e5858ead339d5650bd508b05d.png)

```
What I need type in this fields? 
```

![在此处输入图像描述](../Images/46e01a8cd0ece6f33d36664b829553f3.png)

尝试输入登录名和密码、主目录标题和密码、git-password 以及所有这些名称，密码字段为空。我总是看到： ![在此处输入图像描述](../Images/61fc97b2038caa74d659ac93a95776ab.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-28T19:33:26.857

您正在使用 SSH URL，这需要您（生成和）在 Github 上注册公共 RSA 密钥，然后才能进行身份验证。

如果这是一次性的，您可以切换到 HTTPS URL（请参阅 github 上的 repo 页面），它允许您使用 github 用户名和密码组合进行身份验证。

**编辑：**

*   有关如何生成和使用 SSH 密钥的更多信息，请查看[Github 的 SSH 帮助文章](https://help.github.com/categories/56/articles)
*   Git支持的传输协议和优缺点的详细对比，相对于Github，请看[这篇对比文章](https://gist.github.com/grawity/4392747)