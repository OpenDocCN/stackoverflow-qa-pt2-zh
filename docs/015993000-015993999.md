# StackOverflow 问答 15993000-15993999

# mysql - 无法将值插入到 Ruby Mysql 中的表中

> ID：15993000
> 
> 赞同：1
> 
> 时间：2013-04-13T21:12:18.497
> 
> 标签：mysql, ruby

我正在尝试使用 Ruby 将值插入到本地主机上的 MySQL 中。我要插入的值是 Twitter 搜索的结果。我的程序可以成功地将结果写入文件，所以现在我想将结果插入 MySQL。这是我的代码的一部分：

```
results = @search.perform("yahoo", 100)
client = Mysql2::Client.new(:host => "localhost", :username => "root", :password => "123", :database => "db1")
results.map do |status|
insert = client.query ("INSERT INTO table1 (fromuser, tweet) VALUES (#{status.from_user},#{status.text})")
end 
```

错误是“您的 SQL 语法有错误；请查看与您的 MySQL 服务器版本相对应的手册，以在第 1 行 (Mysql2::Error) 的“tweet”附近使用正确的语法。
是什么导致了错误？

我发现的另一个问题是，当我使用以下代码向 MySQL 插入值时，出现另一个错误：“'字段列表'中的未知列 'a' (Mysql::ServerError::BadFieldError)”

```
require 'mysql'
require 'rubygems'
sql = Mysql.real_connect("localhost", "root", "123", "db1")
st1 = "a"
st2 = "b"
user_string = "(#{st1},#{st2})"
query="INSERT INTO table1 (fromuser, tweet) VALUES" + user_string
sql.query(query) 
```

我想在表格中插入“a”和“b”。如何解决这个问题？

提前致谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T21:56:30.983

就像 Andrew 说的，你肯定想逃避你的数据。

我认为您还需要引用这些值：

```
insert = client.query("插入推文 (from_user, tweet_text)
                       值 ('#{client.escape(status.from_user)}',
                               '#{client.escape(status.text)}')")

```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T21:18:50.197

您需要使用`CREATE TABLE`在数据库中创建一个表来插入数据。目前您说要将数据插入数据库名称（“db1”）本身。

此外，您必须先转义您的数据：

```
insert = client.query("INSERT INTO tweets (from_user, tweet_text)
                       VALUES (#{client.escape(status.from_user)},
                               #{client.escape(status.text)})") 
```

# c# - 返回自定义异常

> ID：15993003
> 
> 赞同：23
> 
> 时间：2013-04-13T21:12:22.187
> 
> 标签：c#, exception

我正在尝试在 C# 中实现我自己的异常类。为此，我创建了一个从 Exception 派生的 CustomException 类。

```
class CustomException : Exception
{
    public CustomException()
        : base() { }

    public CustomException(string message)
        : base(message) { }

    public CustomException(string format, params object[] args)
        : base(string.Format(format, args)) { }

    public CustomException(string message, Exception innerException)
        : base(message, innerException) { }

    public CustomException(string format, Exception innerException, params object[] args)
        : base(string.Format(format, args), innerException) { }
} 
```

然后我用它

```
static void Main(string[] args)
{
    try
    {
        var zero = 0;
        var s = 2 / zero;
    }
    catch (CustomException ex)
    {
        Console.Write("Exception");
        Console.ReadKey();
    }
} 
```

我期待我会得到我的例外，但我得到的只是一个标准的 DivideByZeroException。如何使用我的 CustomException 类捕获除以零异常？谢谢。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-04-13T21:14:44.423

您不能神奇地更改现有代码引发的异常类型。

您需要`throw`您的异常才能捕获它：

```
try 
{
   try
    {
        var zero = 0;
        var s = 2 / zero;
    }
    catch (DivideByZeroException ex)
    { 
        // catch and convert exception
        throw new CustomException("Divide by Zero!!!!");
    }
}
catch (CustomException ex)
{
    Console.Write("Exception");
    Console.ReadKey();
} 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-04-13T21:16:49.067

首先，如果您想查看自己的异常，您应该`throw`在代码中的某处查看：

```
public static int DivideBy(this int x, int y)
{
    if (y == 0)
    {
        throw new CustomException("divide by zero");
    }

   return x/y; 

} 
```

然后：

```
int a = 5;
int b = 0;
try
{
      a.DivideBy(b);
}
catch(CustomException)
{
//....
} 
```

# python - 如何（实时）向线程提供外部参数？

> ID：15993006
> 
> 赞同：0
> 
> 时间：2013-04-13T21:12:36.417
> 
> 标签：python, multithreading, sockets, python-multithreading

**背景**

我正在尝试为[Raspberry Pi Stackexchange 上的问题编写解决方案。](https://raspberrypi.stackexchange.com/q/6981/6609)此人正在创建一个信息亭，并希望 Midori（Raspbian Wheezy 上的浏览​​器）在网络断开然后重新连接时重新加载。为了检查互联网连接，我决定让程序尝试连接到 Google。我使用`up`根据连接状态分配给 0（向下）或 1（向上）的变量。

我在将新的重新分配`up`变量发送到线程时遇到问题。我从我的线程中得到一个永久的“Up has not been reassigned”流。

**代码**

```
up = -1 #Undefined state

test_net = ("www.google.com", 80)

#Import modules
import subprocess as sub
from time import sleep
import socket
import threading

def reloader(up):
    print "A new thread is born." #Debug
    while True:
        if up == 1:
            print "The system is up."
        elif up == 0:
            print "The system is down."
            #sub.call(["midori", "-e", "Reload"])
        else:
            print "Up has not been reassigned."
        sleep(5)

#Check if internet is up

threading.Thread(target = reloader, args = (up,)).start()

while True:
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    try:
        s.connect(test_net)
        up = 1
        print up
    except socket.error:
        up = 0
        print up
    s.close()
    sleep(10) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T22:29:57.660

您的问题是对如何将参数传递给 Python 中的函数的误解。当你这样做时，你期望

```
up = 1 
```

或者

```
up = 0 
```

在全局范围内，该`reloader`函数将在其范围内看到反映在`up`变量中的更改，因为您将该变量作为参数传递给它。这不是它的工作原理。

您将全局范围内的名称作为参数*指向**的对象*`reloader`传递给函数，然后在全局范围内为该名称分配了一个*新对象*。作用域中的名称仍然指向它最初传递的对象，即整数。*`up`**`up``reloader``-1`*

 *您有两种选择来获得您想要的行为：

**1\. 通过闭包而不是通过传递参数来共享状态**

如果您对代码进行以下两项更改，一切都会按照您的预期进行：

*   替换`def reloader(up):`为`def reloader():`
*   替换`threading.Thread(target = reloader, args = (up,)).start()`为`threading.Thread(target = reloader, args = ()).start()`

为什么？因为 Python 中的函数可以引用在其父作用域中定义的所有名称。当您需要`reloader`一个名为 的参数时，您是在`up`其中定义一个局部变量，从而将同名变量隐藏在父范围中。但是，如果您只是删除参数，那么当您尝试从 inside 读取时，Python 将看到没有这样的*局部*变量，而是在父范围内查找。因此，外部范围内的分配将在.`up``reloader``up``reloader`*`up``reloader`*

 ****或者***

**2\. 通过改变作为参数传递的对象来共享状态**

不要将整数作为参数传递给，而是传递一个包含 的可变对象， `-1`然后在您当前将新对象分配给的任何位置修改该对象。您会不时看到建议的一种 hack（通常当人们希望对函数内的变量进行分配时从外部范围可见；您通常会遇到相反的问题，这只能在使用线程时发生）是将变量包装在一个列表中（即初始化为而不是，然后在将其作为参数传递给函数时始终引用而不是除外），这在这种情况下有效。`reloader``-1``up``up``[-1]``-1``up[0]``up`

或者，一个不那么难看的基于可变对象的解决方案可能是使用[`Value`multiprocessing 模块中的类](http://docs.python.org/2/library/multiprocessing.html#multiprocessing.Value)，它正是为此目的而存在的。（请注意，通过闭包在*进程*之间共享状态是不可能的，因为它对于线程来说是不可能的，这使得在使用多处理时使用可变对象来共享状态更加必要。也许这就是为什么多处理模块有`Value`类但线程模块有没有——据我所知——有类似的东西。）

使用这种方法的工作代码如下所示：

```
test_net = ("www.google.com", 80)

#Import modules
import subprocess as sub
from time import sleep
import socket
import threading
from multiprocessing import Value

up = Value('i', -1) #Undefined state

def reloader(up):
    print "A new thread is born." #Debug
    while True:
        if up.value == 1:
            print "The system is up."
        elif up.value == 0:
            print "The system is down."
            #sub.call(["midori", "-e", "Reload"])
        else:
            print "Up has not been reassigned."
        sleep(5)

#Check if internet is up

threading.Thread(target = reloader, args = (up,)).start()

while True:
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    try:
        s.connect(test_net)
        up.value = 1
        print up
    except socket.error:
        up.value = 0
        print up
    s.close()
    sleep(10) 
```**

# c - 以编程方式获取 Linux 上函数的总时间和忙碌时间

> ID：15993007
> 
> 赞同：2
> 
> 时间：2013-04-13T21:12:39.277
> 
> 标签：c, linux, function, time, profiling

有没有办法以编程方式获取 C 程序运行的总时间，以及在特定函数中花费的时间量？我需要在代码中执行此操作，因为我想将这两个值用作另一个函数的参数。由于我在 Linux 上，我可以使用 gprof 或 perf 来执行此操作吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T21:52:27.130

1.  获取程序启动时的系统时间。然后，无论何时，您都可以获得当前时间并减去开始时间。这告诉你已经跑了多长时间，在挂钟时间。

2.  有一个全局布尔 Q，当你的函数进入时设置为 True，当它退出时设置为 False，所以它只有在程序“进入”函数时才为 True（包括）。

3.  设置一个定时器中断，每 N ms 关闭一次，并有两个全局计数器，A 和 B。（N 不必很小。）当定时器中断时，不管它增加 B，但只有在 Q 为真时才增加 A .

这样，您就知道已经过去了多少时间，而 A/B 是您的函数在堆栈上的时间的一部分。

顺便说一句：如果函数是递归的，让 Q 是一个整数“深度计数器”。否则，没有变化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T21:35:48.217

您也可以使用[gprof](http://www.cs.utah.edu/dept/old/texinfo/as/gprof.html#SEC4)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-13T21:22:50.237

是的，您可以使用[`gprof`](http://www.manpagez.com/man/1/gprof/)，但这需要*重新编译*您要测量的二进制文件以插入所需的监控代码。默认情况下，程序不会花时间记录这些数据，因此您必须添加它。使用 gcc，这是使用[`-pg`](http://gcc.gnu.org/onlinedocs/gcc/Debugging-Options.html#index-g_t_0040command_007bgprof_007d-580)选项完成的。

# scheme - 如何使用 DrRacket 创建和保存带有 .scm 文件扩展名的 Scheme 程序？

> ID：15993009
> 
> 赞同：4
> 
> 时间：2013-04-13T21:12:43.687
> 
> 标签：scheme, racket

我能够在 DrRacket 中制作的只是球拍文档文件，但我需要这些文件具有 Scheme 文件扩展名或更具体地说是 .scm

我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-13T21:18:27.820

单击“文件”菜单下的“将定义另存为...”项并将文件名写入为`<something>.scm`. SCM 是 DrScheme（DrRacket 的前身）中使用的文件扩展名，但您仍然可以使用它来保存程序。

# c# - 以编程方式生成的数字签名电子邮件在 Outlook 中显示正确，但在 Gmail 中显示不正确

> ID：15993011
> 
> 赞同：3
> 
> 时间：2013-04-13T21:12:56.673
> 
> 标签：c#, .net, outlook, gmail, smime

我正在使用 C#、.NET 4.0 发送经过数字签名的电子邮件，如下所示：

```
private void SendMailMessage(string emailTo)
{
    MailMessage message = new MailMessage();
    message.From = new MailAddress(fromAddress);
    message.To.Add(new MailAddress(emailTo));
    message.Subject = "Regarding your lottery winnings";
    message.IsBodyHtml = false;
    string body = "Content-Type: text/plain;charset=\"iso-8859-1\"\nContent-Transfer-Encoding: quoted-printable\n\nThe URL to your secret is: " + url + "\nIt can only be viewed once.";                
    byte[] messageBytes = Encoding.ASCII.GetBytes(body);
    ContentInfo content = new ContentInfo(messageBytes);
    SignedCms signedCms = new SignedCms(content, false);
    CmsSigner Signer = new CmsSigner(SubjectIdentifierType.IssuerAndSerialNumber, emailCert);
    signedCms.ComputeSignature(Signer);
    byte[] signedBytes = signedCms.Encode();
    MemoryStream ms = new MemoryStream(signedBytes);
    AlternateView av = new AlternateView(ms, "application/pkcs7-mime; smime-type=signed-data;name=smime.p7m");
    message.AlternateViews.Add(av);                
    SmtpClient client = new SmtpClient(smtpServer, int.Parse(smtpServerPort));
    client.DeliveryMethod = SmtpDeliveryMethod.Network;
    client.Send(message);
    message.Dispose();
    client = null;
} 
```

请注意，`message.Body`它留空，只有 AlternateView 被添加到电子邮件中。当我发送这封电子邮件并在 Outlook 中查看它时，它会完美显示，在电子邮件消息上带有一个证书图标，并且 S/MIME Outlook 扩展程序会成功并自动验证签名。

王牌。

（如果我向 中添加任何内容`message.Body`，它就会中断。Outlook 不再将其识别为已签名的电子邮件，我只看到`message.Body`文本，而不是 AlternateView。）

但是，如果我将这封电子邮件发送到 Gmail 地址，例如，它会显示为带有 smime.p7m 作为附件的空白电子邮件，并且在其中我看到了电子邮件的文本，但它被看起来像一吨的东西包围二进制乱码。

有没有办法让这个数字签名的电子邮件与 Outlook 客户端和 Gmail 网络客户端兼容？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-06-14T17:29:05.343

当 Outlook 生成签名的电子邮件时，它会添加一个带有签名消息的替代视图、另一个带有 html 版本的替代视图，然后是另一个带有纯文本版本的替代视图。我认为如果您也这样做，那么它将适用于大多数电子邮件客户端。

有一个未签名的纯文本替代视图 Content-Type: text/plain; charset="us-ascii" 内容传输编码：7bit

有一个未签名的 html 版本 Content-Type: text/html; charset="us-ascii" 内容传输编码：quoted-printable

有一个签名的备用视图 Content-Type: application/pkcs7-signature; name="smime.p7s" 内容传输编码：base64 内容处置：附件；文件名="smime.p7s"

# java - Slick2d | 渲染和更新的最佳方式

> ID：15993012
> 
> 赞同：1
> 
> 时间：2013-04-13T21:12:58.960
> 
> 标签：java, render, solution, slick2d

## 问题：

您认为渲染和更新实体的最佳方式是什么？
目前我正在使用世界一流的来做到这一点。

**链接：**

> [***游戏（完）***](https://www.dropbox.com/s/dhvf5vbqj25sgyw/game.jar)

**代码（来自 World.java）：**

```
List<Entity> entities = new ArrayList<Entity>();

public void render(GameContainer gc, Graphics g, Camera camera) {
    // Draw background
    background.draw(0 - camera.getX(), 0 - camera.getY(), 2100, 2100);

    // Loop through all entities and render
    for (int i = 0; i < entities.size(); i++) {
        Entity entity = entities.get(i);

        // A very long if... render only if visible
        if (entity.getX() < player.getX() + ((gc.getWidth() / 2) + entity.getWidth() + 50) &&
            entity.getX() > player.getX() - ((gc.getWidth() / 2) + entity.getWidth() + 50) &&
            entity.getY() < player.getY() + ((gc.getHeight() / 2) + entity.getHeight() + 50) &&
            entity.getY() > player.getY() - ((gc.getHeight() / 2) + entity.getHeight() + 50)) {
                entity.render(gc, g);
            }
        }
    }

    public void update(GameContainer gc, int delta) {
        // Loop through entities and update all time
        for (int i = 0; i < entities.size(); i++) {
            Entity entity = entities.get(i);
            entity.update(gc, delta);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T21:22:57.943

```
List<Entity> entities = new ArrayList<Entity>();

public void render(GameContainer gc, Graphics g, Camera camera) {
   background.draw(0 - camera.getX(), 0 - camera.getY(), 2100, 2100);
   for( Entity entity : entities ) {
      if( entity.isVisible( player, gc )) {
         entity.render( gc, g );
      }
   }
}

public void update(GameContainer gc, int delta) {
   for( Entity entity : entities ) {
      entity.update( gc, delta );
   }
} 
```

`Entity.update()`不应该修改列表，在原地使用：

```
private final List< Entity > toBeRemoved = new LinkedList<>();

public void update(GameContainer gc, int delta) {
   toBeRemoved.clear();
   for( Entity entity : entities ) {
      if( entity.update( gc, delta )) {
         toBeRemoved.add( entity );
      }
   }
   entities.removeAll( toBeRemoved );
} 
```

`Entity.update()`当实体需要移除时返回 true。

# visual-studio-2010 - 更改 Visual Studio 中“已保存/未保存”颜色栏的颜色？

> ID：15993014
> 
> 赞同：0
> 
> 时间：2013-04-13T21:13:09.127
> 
> 标签：visual-studio-2010, visual-studio

是否可以更改屏幕左侧的条的颜色，`green`如果该行被保存，`yellow`如果没有，等等？我在“选项”菜单的“字体和颜色”选项卡或 MSDN 上找不到

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T23:30:03.233

在阅读了选项菜单中的所有条目后，我找到了哈哈

![截屏](https://i.stack.imgur.com/DMzcG.png)

# asp.net-mvc - 使 PagedListPager 使用英国日期格式作为参数

> ID：15993016
> 
> 赞同：0
> 
> 时间：2013-04-13T21:13:25.460
> 
> 标签：asp.net-mvc, pagedlist

[PagedListPager](https://github.com/TroyGoode/PagedList)如何解释日期参数，因为它似乎将`01/04/2003`一个寻呼机项目视为 2003 年 4 月 1 日，而将另一个寻呼机项目视为 2003 年 1 月 4 日。

在我的剃须刀标记中，我显示了 2 个文本框以允许用户选择报告的开始日期和结束日期，我在底部放置了寻呼机，以允许用户浏览结果。现在奇怪的是，如果我输入诸如 2003 年 4 月 1 日之类的日期并返回我的结果，则底部的寻呼机将在寻呼到其他页面之一时将日期设置为 1 月 4 日。但是，一旦打开，例如第 2 页，情况正好相反。它将需要 1 月 4 日并将其转换为 4 月 1 日...？我只需要在这里保持一致 - 但实际上对英国日期格式进行硬编码没有问题。

```
<label for="StartDate">Start Date: </label> 
<input type="text" class="datepicker" id="StartDate" name="StartDate" 
       value="@ViewBag.StartDate" />  
<label for="EndDate">End Date:</label> 
<input type="text" class="datepicker" id="EndDate" name="EndDate" 
       value="@ViewBag.EndDate" /> 
```

ViewBag 在那里，因此在结果之间进行分页时输入的值保持不变，并且 PagedListPager 使用相同的值

```
@Html.PagedListPager(@Model, page => Url.Action("ReadyBox", 
        new { page = page, 
        sortOrder = ViewBag.CurrentSort, 
        startDate = ViewBag.StartDate, 
        endDate = ViewBag.EndDate }), 
        PagedListRenderOptions.ClassicPlusFirstAndLast) 
```

这个控制器是

```
public ActionResult ReadyBox(string sortOrder, int? page, 
                             DateTime? startDate, DateTime? endDate)
{
    ViewBag.CurrentSort = sortOrder;
    ViewBag.NameSortParam = string.IsNullOrWhiteSpace(sortOrder) ? "Name desc" : "";
    ViewBag.DateSortParam = sortOrder == "Date" ? "Date desc" : "Date";

    int pageNumber = page ?? 1;

    if (startDate == null)
        startDate = DateTime.Now.AddMonths(-1);

    if (endDate == null)
        endDate = DateTime.Now;

    ViewBag.StartDate = ((DateTime)startDate).ToShortDateString();
    ViewBag.EndDate = ((DateTime)endDate).ToShortDateString();

    // rest of the controller
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T07:22:05.527

对于 GET 请求，我建议您使用 InvariantCulture 格式：

```
@Html.PagedListPager(
    Model, 
    page => Url.Action(
        "ReadyBox", 
        new { 
            page = page, 
            sortOrder = ViewBag.CurrentSort, 
            startDate = ViewBag.StartDate.ToString("yyyy-MM-dd"), 
            endDate = ViewBag.EndDate.ToString("yyyy-MM-dd") 
        }
    ), 
    PagedListRenderOptions.ClassicPlusFirstAndLast
) 
```

默认模型绑定器在绑定来自 GET 请求的参数时始终使用不变的区域性格式，而在绑定来自 POST 请求的参数时始终使用当前区域性。您可以阅读更多关于它的信息[`this blog post`](http://weblogs.asp.net/melvynharbour/archive/2008/11/21/mvc-modelbinder-and-localization.aspx)。

# javascript - 通过数据绑定实现表的固定列数

> ID：15993017
> 
> 赞同：0
> 
> 时间：2013-04-13T21:13:27.613
> 
> 标签：javascript, knockout.js, data-binding, html-table

我有一个带有绑定数据（[KnockoutJS](http://knockoutjs.com/)）的表，如下所示：

```
...
<tr>

 <th class="rotated">Row 1</th>               
 <!-- ko foreach: Dog-->            
  <td>
     <p data-bind="text: Name">
     </p>
  </td>
 <!-- /ko -->
</tr>
... 
```

问题是我想要固定数量的列，例如 5，但有时数据不多，所以生成的列少于 5。我想知道添加列的最佳方法是什么，以便它们始终为 5。

我制作了一个 Javascript 函数，它遍历所有行，计算标签并在需要时`<td>`添加标签。`<td>`还有其他选择吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T02:56:06.093

即使其中包含空值，您也应该始终使用包含 5 个项目的数组。

例如：

```
 var Dog = [{Name:"dog1"},{Name:"dog2"},{Name:""},{Name:"dog3"},{Name:""}]; 
```

# javascript - 时钟和日期javascript

> ID：15993018
> 
> 赞同：0
> 
> 时间：2013-04-13T21:13:28.337
> 
> 标签：javascript

我正在创建一个 JS 时钟/日期。我以前有时间完美地工作，然后我决定在我的时钟（日期）上添加更多。现在我无法弄清楚为什么它不起作用。如果有人能给我提示或想法如何解决它，我将不胜感激。

```
function timedate()
    {
    var currentTime = new Date();
    var hours = currentTime.getHours();
    var minutes = currentTime.getMinutes();
    var dn="PM"
    var d = currentTime.getDate(); <--
    var day = (d < 10) ? '0' + d : d;
    var m = currentTime.getMonth() + 1; <--
    var month = (m < 10) ? '0' + m : m;
    var yy = currentTime.getYear(); <--
    var year = (yy < 1000) ? yy + 1900 : yy;
    if (hours<12)
 {
    dn="AM"
 }
    if (hours>12)
 {
    hours=hours-12
 }
    if (hours==0)
 {
    hours=12
 }
    if (minutes<=9)
 {
    minutes="0"+minutes 
 }
 var clocklocation = document.getElementById('timedate');
 clocklocation.innerHTML = "" +hours+":"+minutes+dn+""+day + "/" + month + "/" + year;
 setTimeout("timedate()", 1000); 
    }
timedate(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T21:21:21.583

您的代码有效，只是不可见，因为您没有显示秒数

也改变

```
setTimeout("timedate()", 1000); 
```

至

```
setTimeout(timedate, 1000); 
```

因为不推荐

**并删除 <--**

确保它在加载时运行或在要显示它的标签之后运行

或者删除该行并更改

```
timedate(); 
```

至

```
setInterval(timedate,1000) 
```

```
const pad = num => ("0" + num).slice(-2);
const timedate = () => {
  const currentTime = new Date();
  let hours = currentTime.getHours();
  const minutes = pad(currentTime.getMinutes());
  const seconds = pad(currentTime.getSeconds());

  const d = currentTime.getDate();
  const day = pad(d);
  const month = pad(currentTime.getMonth() + 1);
  const yy = currentTime.getFullYear();

  let dn = "PM"
  if (hours <= 12) dn = "AM";
  if (hours >= 12) hours -= 12;
  if (hours == 0) hours = 12;
  hours = pad(hours);
  document.getElementById('timedate').innerHTML = "" +
    hours + ":" +
    minutes + ":" +
    seconds + dn + " " +
    day + "/" + month + "/" + yy;
}
window.addEventListener("load", function() {
  setInterval(timedate, 1000);
});
```

```
<span id="timedate"></span>
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T21:23:27.447

如果您使用`setTimeout(timedate, 1000)`而不是当前的魔术字符串版本设置超时，[则可以使用](http://jsfiddle.net/DBMsC/2/)¹。

* * *

^(¹我还冒昧地在您的代码中添加了秒数，以明确时钟更新。当然，您还需要`<--`从代码中删除。)

# ruby-on-rails - 生成的脚手架的视图链接与路线图不正确对应

> ID：15993020
> 
> 赞同：0
> 
> 时间：2013-04-13T21:13:50.630
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rails-routing

我对生成的视图路径有疑问。我的 routes.rb 如下所示

```
Project::Application.routes.draw do
  resources :project_templates do
    resources :awards
  end
... 
```

project_template.rb 像这样

```
class ProjectTemplate < ActiveRecord::Base

  belongs_to :user
  has_many :awards #...

  attr_accessible :user_id #...

  ... 
```

奖.rb 喜欢

```
class Award < ActiveRecord::Base
  belongs_to :project_template
  attr_accessible :tier #..
  ... 
```

并且生成的视图链接是这样的：`awards_path` 这种方式应用程序不起作用，我需要全部替换为`project_template_awards_path`

我不知道为什么生成器在没有`project_template`前缀的情况下这样做，但我要求你帮助我找到解决这个问题的方法。也许有一些生成器命令会将缺少的后缀添加到路径中？我必须对另一个班级做同样的事情，`requirement.rb`并且对此也有看法，所以我希望有一些神奇的命令可以解决我的问题。

* * *

`rake routes | grep awards`给出以下输出：

```
project_template_awards     GET     /project_templates/:project_template_id/awards(.:format)          awards#index
                            POST    /project_templates/:project_template_id/awards(.:format)          awards#create
new_project_template_award  GET     /project_templates/:project_template_id/awards/new(.:format)      awards#new
edit_project_template_award GET     /project_templates/:project_template_id/awards/:id/edit(.:format) awards#edit
project_template_award      GET     /project_templates/:project_template_id/awards/:id(.:format)      awards#show
                            PUT     /project_templates/:project_template_id/awards/:id(.:format)      awards#update
                            DELETE  /project_templates/:project_template_id/awards/:id(.:format)      awards#destroy 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T03:42:40.430

生成的路由是正确的。如果你想拥有这个助手，你可以将它添加到你的 route.rb

```
Project::Application.routes.draw do
  resources :project_templates
  resources :awards
end 
```

或者实现像这样的助手

```
def awards_path(award)
  project_template_awards(awards.project_template, awards)
end 
```

[有关红宝石指南](http://edgeguides.rubyonrails.org/routing.html#nested-resources)的更多信息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T22:30:53.083

您可以尝试输入`$ rake routes`项目目录并在那里发布输出吗？它仍然显示 Awards 资源的 Awards_path 吗？

PS。控制器在这里无关，因为您可以在 app/.

# c# - 对象列表的Linq联合列表（属性）

> ID：15993027
> 
> 赞同：0
> 
> 时间：2013-04-13T21:14:29.450
> 
> 标签：c#, linq, list, linq-to-entities

我有两个类，Person 和 Group

```
class Person {
    public virtual ICollection<Group> GroupsWhereIAmMember { get; set; }
    public virtual ICollection<Group> GroupsWhereIAmSender { get; set; }
}

class Group {
    public virtual ICollection<Person> Members { get; set; }
    public virtual ICollection<Person> Senders { get; set; }
} 
```

给定一个人实例 p，**我如何获取属于 p 是发件人的组的所有人？**

对象方式的 linq 将是这样的：

```
List<Person> results = new List<Person>();

foreach (Group group in p.GroupsWhereIAmSender)
{
     results.AddRange(group.Members);
} 
```

但我想以“linq-to-entities”的方式来做，这样我就不会耗尽内存。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T22:42:13.867

“linq-to-objects”方式将`SelectMany`按照已经建议的方式使用，“linq-to-entities”方式也将使用`SelectMany`但将 a`DataContext`作为源（`IQueryable`准确地说是 an）。

在这两种情况下，表达式都是：（`p.GroupsWhereIAmSender.SelectMany(g => g.Members)` 您可能希望添加`Distinct`到结果中以避免重复值）。

“linq-to-objects”和“linq-to-entities”的区别在于“linq-to-entities”使用`IQueryable`了一个可以在运行时转换成T-SQL的表达式树。这样可以在底层数据库上进行过滤和排序，而不是将所有内容加载到内存中。

但是，您的代码没有显示任何提示存在`DataContext`. 所以我必须假设你所有的数据都已经在内存中了。`SelectMany`因此，您不会因为不会加载/生成新数据而耗尽内存。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T21:24:59.467

使用`SelectMany`：

```
results = p.GroupsWhereIAmSender.SelectMany(g => g.Members); 
```

# postgresql - 修改 Devise 以支持 UUID 主键

> ID：15993028
> 
> 赞同：2
> 
> 时间：2013-04-13T21:14:29.697
> 
> 标签：postgresql, devise, uuid, ruby-on-rails-4

我想修改 Devise 以使其与带有 PostgreSQL 的 UUID 主键的用户表一起使用。

这是迁移：

```
class DeviseCreateUsers < ActiveRecord::Migration

  def change
    create_table :users, id: false do |t|
      t.uuid :uuid, null: false
      # ...
    end

    change_table :users do |t|
      t.index :uuid, unique: true
      # ...
    end
  end

  def migrate(direction)
    super
    if direction == :up
      # This is only necessary because the following does not work:
      # t.uuid :uuid, primary: true, null: false
      execute "ALTER TABLE users ADD PRIMARY KEY (uuid);"
    end
  end
end 
```

这是`User`模型：

```
class User < ActiveRecord::Base

  primary_key = :uuid

  devise :database_authenticatable, :recoverable, :registerable,
    :rememberable, :trackable, :validatable

  validates :uuid, presence: true
  before_validation :ensure_uuid
  def ensure_uuid; self.uuid ||= SecureRandom.uuid end

end 
```

这是错误：

```
PG::Error: ERROR:  operator does not exist: uuid = integer
LINE 1: ...ECT  "users".* FROM "users"  WHERE "users"."uuid" = 1  ORDER...
                                                             ^
HINT:  No operator matches the given name and argument type(s). You might need to add explicit type casts.
: SELECT  "users".* FROM "users"  WHERE "users"."uuid" = 1  ORDER BY "users"."uuid" ASC LIMIT 1

Extracted source (around line #5):

1    .navbar-inner
2      .container
3        = a_nav_tag "App", root_path
4        - if user_signed_in?
5          %ul.nav.pull-right
6            %li.dropdown#user_menu
7              %a.dropdown-toggle(data-toggle="dropdown" href="#") 
```

如您在上面看到的，`user_signed_in?`已损坏。我预计从“正常”自动递增 ID 到 UUID 需要进行一些更改。

现在，我只是发布问题。我将在今天晚些时候对此进行讨论。如果您碰巧知道如何做到这一点——或者知道 Devise fork，我将不胜感激。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-14T12:02:53.067

我在 Rails 4 中通过在创建表时将 id 列设置为 uuid 数据类型来完成此操作，并且没有任何其他配置更改。IE。不要创建名为“uuid”的列，只需将“id”列的类型更改为 uuid。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-13T22:16:30.207

只需清除 Web 应用程序的浏览器 cookie（在我的例子中是`localhost`）。上面的错误是因为会话保留了旧用户主键，`1`.

在那之后，事情在我的测试中起作用。我希望这不仅仅是运气，如果 Devise 不知道主键，这将是一个很好的设计。（在 Devise 的代码中，我发现在某些测试中没有使用`.id`except。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-06-28T12:20:59.310

2020年答案：

创建用户表时，将ID设置为uuid

```
def change
  enable_extension 'pgcrypto' # needed if not already enabled 
  create_table :users, id: :uuid do |t|
    t.string :email,
    ... 
```

# mysql - 如何允许远程访问 phpmyadmin

> ID：15993029
> 
> 赞同：1
> 
> 时间：2013-04-13T21:14:31.757
> 
> 标签：mysql, apache, phpmyadmin

我正在运行安装了 Apache2 和 PHPMyAdmin 的 Linux 服务器。我可以使用我的 root 帐户远程登录，但不能使用为其他人创建的帐户。新用户的主机设置应该是“%”。但是，当我尝试使用他的帐户登录时，我收到了错误...

```
#1045 Cannot log in to the MySQL server 
```

有人可以帮助我吗？我知道应该有类似添加到文件中以允许权限的东西，但我似乎无法让它工作。

**已解决：**我想出了修复它的方法。我不得不进入 SSH 并使用命令“mysql_secure_installation”并回答问题:) 谢谢大家！我希望这可以帮助其他有同样问题的人。

# android - RelativeLayout 的子级没有填充 RelativeLayout 的高度

> ID：15993030
> 
> 赞同：13
> 
> 时间：2013-04-13T21:14:35.187
> 
> 标签：android, layout, fill-parent

我有一个用RelativeLayouts 填充的ListView。这些相对布局的内容可以改变，从而分别改变它们的高度。在每个 RelativeLayout 上，我在布局的左侧都有一个与布局高度匹配的小竖线。

与此类似 ->[链接](http://ec2-184-72-209-30.compute-1.amazonaws.com/wp-content/uploads/screen_tablet.jpg)

尽管出于某种原因，我使用的 View 对象并没有扩展到布局的高度。

我究竟做错了什么？

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/post"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:background="@drawable/column_post_selector"
android:orientation="horizontal" >

<!-- Status bar (THIS ISN'T FILLING TO PARENTS' HEIGHT) -->
<View
    android:id="@+id/status"
    android:layout_width="3dp"
    android:layout_height="fill_parent"
    android:layout_alignLeft="@id/post"
    android:layout_marginBottom="2dp"
    android:layout_marginTop="2dp"
    android:background="#33B5E5" />

<ImageView
    android:id="@+id/thumbnail"
    android:layout_width="80dip"
    android:layout_height="80dip"
    android:layout_toRightOf="@id/status"
    android:contentDescription="@string/empty"
    android:layout_marginRight="5dp"
    android:scaleType="fitStart" />

<!-- Title -->

<TextView
    android:id="@+id/title"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignTop="@id/post"
    android:layout_toRightOf="@id/thumbnail"
    android:textColor="#ffffff"
    android:textSize="14sp"
    android:typeface="sans" />
<!-- Rightend Duration -->

<TextView
    android:id="@+id/date"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentRight="true"
    android:layout_alignTop="@id/title"
    android:layout_marginRight="5dip"
    android:gravity="right"
    android:textColor="#10bcc9"
    android:textSize="12sp"
    android:textStyle="bold" />

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2015-11-30T11:32:00.273

我的单元格中有一个类似的问题，`RecyclerView`其中有一个 RelativeLayout 作为根元素。

对我来说，一个解决方法是在根 RelativeLayout 元素周围包裹一个额外的 LinearLayout。

所以你的卡片看起来像这样：

```
<LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content">

        <RelativeLayout 
                    android:layout_width="match_parent"
                    android:layout_height="match_parent">
            <View
                android:id="@+id/view_with_same_height_as_parent"
                android:layout_width="10dp"
                android:layout_height="fill_parent"
                android:layout_alignParentBottom="true"
                android:layout_alignParentTop="true"/>
...

    </RelativeLayout>
</LinearLayout> 
```

来源： [https ://stackoverflow.com/a/28799251/3708094](https://stackoverflow.com/a/28799251/3708094)

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2017-02-24T00:48:18.773

如果您的 RelativeLayout 在 ScrollView 内，则需要在 ScrollView 上添加 fillViewPort 参数并将其设置为`true`

```
 <ScrollView
      android:layout_width="match_parent"
      android:layout_height="match_parent"
      android:fillViewport="true"> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-10-29T15:25:33.063

我在 a `RelativeLayout`inside a中遇到了类似的问题`ScrollView`。[根据文档](http://developer.android.com/reference/android/widget/RelativeLayout.html)，如果将其添加到滚动容器（如 ListView）中，则（最高版本 17）中存在一个**错误**，`RelativeLayout`该错误会导致测量高度错误。

所以要解决这个问题，你应该以编程方式计算高度。

您可以创建扩展类并覆盖该`onMeasure`方法或将 a 添加`OnGlobalLayoutListener`到父视图。

我选择第二种方式。这是我的解决方案：

![例子](https://i.stack.imgur.com/1NUwv.jpg)

```
findViewById(R.id.scroll_view).getViewTreeObserver().addOnGlobalLayoutListener(new OnGlobalLayoutListener() {
    @Override
    public void onGlobalLayout() {
        float topElementPosition = findViewById(R.id.top_element).getY();
        float bottomElementPosition = findViewById(R.id.bottom_element).getY();
        int bottomElementHeight = findViewById(R.id.bottom_element).getMeasuredHeight();
        int height = (int)(bottomElementPosition-topElementPosition+bottomElementHeight);
        findViewById(R.id.view).setMinimumHeight(height);
        findViewById(R.id.scroll_view).getViewTreeObserver().removeGlobalOnLayoutListener(this);
    }
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-31T13:56:01.437

I fixed by manually set layout during `onLayout` for invalid view:

```
@Override
protected void onLayout(boolean changed, int left, int top, int right, int bottom) {
    super.onLayout(changed, left, top, right, bottom);

    int rootMarginRight = ((MarginLayoutParams)root.getLayoutParams()).rightMargin;
    int paddingRight = root.getPaddingRight() + rootMarginRight;

    //invalid view
    actionsContainer.layout(
            right - actions.getWidth() - paddingRight,
            0,
            right - paddingRight,
            getHeight()
    );
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-25T09:12:07.817

有同样令人讨厌的问题，顺便说一句没有意义。最后对我有用的是将`android:layout_height`RelativeLayout标签中的标签更改为`fill_parent`这样

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" 
  ... 
```

希望这可以帮助

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-02-24T03:03:48.330

如果您知道要设置的确切高度，则可以为此组件（视图）设置 Height 或 MinHeight。在您的情况下，您可以设置为：android:minHeight="76dp"，或者您可以使用 LayoutParams 以编程方式设置它。希望能帮助到你！

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2016-03-04T23:15:07.497

我的问题是以下行

```
android:fitsSystemWindows="true" <-- In the parent view 
```

去掉了。添加回来后，它现在可以正常工作了。

* * *

## 回答 #8

> 赞同：-7
> 
> 时间：2013-04-13T21:20:19.477

您需要添加`layout_alignParentTop="true"`and `layout_alignParentBottom="true"`to `status`- 这将确保视图同时触及`post`'s的顶部和底部`RelativeLayout`。

# java - 连贯性：错误：无法找到或加载主类 com.tangosol.net.DefaultCacheServer

> ID：15993037
> 
> 赞同：0
> 
> 时间：2013-04-13T21:15:19.247
> 
> 标签：java, oracle, caching

我是 oracle coherence 的新手，尝试使用以下配置启动 coherence 实例，但出现此错误：

```
java -cp COHERENCE_HOME\config;COHERENCE_HOME\lib\coherence.jar com.tangosol.net.DefaultCacheServer
Error: Could not find or load main class com.tangosol.net.DefaultCacheServer 
```

环境：Java 1.7.17，配置为：
`JAVA_HOME=JAVA_HOME=C: \Program Files\Java\jdk1.7.0_17`
`JRE_HOME=C:\Program Files\Java\jdk1.7.0_17\jre`
`COHERENCE_HOME=C:\coherence-java-3.7.1.0b27797\coherence`

尝试了多种选择，但无法获得太多帮助来解决此问题。

```
Error: Could not find or load main class com.tangosol.net.DefaultCacheServer 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T21:28:01.620

如果您使用的是 Windows，系统变量将用作`%COHERENCE_HOME%`，而不是`COHERENCE_HOME`。

即你的命令应该看起来像`java -cp %COHERENCE_HOME%\config;%COHERENCE_HOME%\lib\coherence.jar com.tangosol.net.DefaultCacheServer`

另外请检查`com.tangosol.net.DefaultCacheServer`该类是否在类路径上。

# javascript - 如何遍历定位特定属性并将其内容推送到数组的 JSON 对象？

> ID：15993038
> 
> 赞同：3
> 
> 时间：2013-04-13T21:15:27.383
> 
> 标签：javascript, json, node.js, recursion

我正在使用一个 JSON 对象，它可以`ids`在任何叶子上都有一个属性。我想遍历该对象并找到该`ids`属性的所有实例并将每个 id 存储在一个集合中。

模拟 JSON 对象（该`ids`属性可能位于更深的属性位置）。

```
{
  "id": "b38a683d-3fb6-408f-9ef6-f4b853ed1193",
  "foo": {
    "ids": [
      {
        "id": "bd0bf3bd-d6b9-4706-bfcb-9c867e47b881"
      },
      {
        "id": "d1cc529d-d5d2-4460-b2bb-acf24a7c5999"
      },
      {
        "id": "b68d0c8c-548e-472f-9b01-f25d4b199a71"
      }
    ],
    "baz": "super"
  },
  "bar": {
    "ids": [
      {
        "id": "bd0bf3bd-d6b9-4706-bfcb-9c867e47b881"
      },
      {
        "id": "d1cc529d-d5d2-4460-b2bb-acf24a7c5999"
      },
      {
        "id": "b68d0c8c-548e-472f-9b01-f25d4b199a71"
      }
    ]
  }
} 
```

我正在使用下面的代码来遍历上面的 JSON。

```
var jsonFile = require('./file_test.json'); // the above in my local directory

function traverse(obj, ids) {
  for (var prop in obj) {
    if (typeof obj[prop] == "object" && obj[prop]) {
      if (prop == 'ids') {
        for (var i = obj[prop].length - 1; i >= 0; i--) {
          ids.push(obj[prop][i]._id);
        };
      }
      traverse(obj[prop], ids);
    }
  }
}

var ids = new Array();
traverse(jsonFile, ids);

console.log('ids', ids); 
```

上述内容如下：

```
ids
[
  'b68d0c8c-548e-472f-9b01-f25d4b199a71',
  'd1cc529d-d5d2-4460-b2bb-acf24a7c5999',
  'bd0bf3bd-d6b9-4706-bfcb-9c867e47b881',
  'b68d0c8c-548e-472f-9b01-f25d4b199a71',
  'd1cc529d-d5d2-4460-b2bb-acf24a7c5999',
  'bd0bf3bd-d6b9-4706-bfcb-9c867e47b881'
] 
```

虽然我的代码有效，但我不相信我这样做是最有效或最好的方式。有没有更好的方法来查找该`ids`属性的所有实例？也许没有传入一个数组而是返回一个？`ids`或者使用数组设置回调？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-13T23:15:39.863

如果数据实际上是 JSON 字符串，而不是 JavaScript 对象，您可以有如下内容：

```
// assuming `json` is the data string
var ids = [];
var data = JSON.parse(json, function(key, value) {
    if (key === "id") 
        ids.push(value);

    return value;
}); 
```

请参阅`reviver`JSON.parse[方法](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/JSON/parse)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-13T21:53:43.317

你所拥有的很好，但这有点短并使用 .map 函数：

```
var jsonFile = require('./file_test.json'); // the above in my local directory
function traverse(obj) {
    var ids = [];
    for (var prop in obj) {
        if (typeof obj[prop] == "object" && obj[prop]) {
            if (prop == 'ids') {
                ids = obj[prop].map(function(elem){
                   return elem.id;
               })
            }
            ids =ids.concat(traverse(obj[prop]));
        }
    }
    return ids;
}

var ids =traverse(jsonFile);

console.log('ids', ids); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-14T02:03:43.300

假设 ES5 可以原生或通过[shim](https://github.com/kriskowal/es5-shim)获得：

```
function gimmeIds(obj) {
    return Object.keys(obj||{})
        .reduce(function(ids, key) {
            if(key === 'ids') {
                return ids.concat(obj[key].map(function(idObj) {
                    return idObj.id;
                }));
            }

            if(obj[key] && typeof obj[key] == 'object') {
                return ids.concat(gimmeIds(obj[key]));
            }

            return ids;
        }, []);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-13T21:41:38.070

你基本上想做的是对这个 JSON 对象进行树搜索，对吗？因此，如果我们假设它`ids`始终是一个叶子，那么我们不需要`traverse`这些节点，因为我们知道它们在叶子上并且将包含我们想要的内容。

*   更改`if {...} traverse` **为** `if {...} else {traverse}`

如果可以将数据结构更改`ids`为字符串列表而不是对象列表，那么您将能够保存对数组的迭代并将其合并到`ids`传入的数组中，但这完全取决于上下文以及您是否可以进行此更改！

对不起，我没有更多的帮助！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-12-27T01:34:30.740

使用[对象扫描](https://github.com/blackflux/object-scan)，这变得非常简单。请注意，您可以轻松地指定目标（在这种情况下`**.ids[*].id`）

```
// const objectScan = require('object-scan');

const data = { id: 'b38a683d-3fb6-408f-9ef6-f4b853ed1193', foo: { ids: [{ id: 'bd0bf3bd-d6b9-4706-bfcb-9c867e47b881' }, { id: 'd1cc529d-d5d2-4460-b2bb-acf24a7c5999' }, { id: 'b68d0c8c-548e-472f-9b01-f25d4b199a71' }], baz: 'super' }, bar: { ids: [{ id: 'bd0bf3bd-d6b9-4706-bfcb-9c867e47b881' }, { id: 'd1cc529d-d5d2-4460-b2bb-acf24a7c5999' }, { id: 'b68d0c8c-548e-472f-9b01-f25d4b199a71' }] } };

const findIds = (input) => objectScan(['**.ids[*].id'], { rtn: 'value' })(input);

console.log(findIds(data));
/* => [ 'b68d0c8c-548e-472f-9b01-f25d4b199a71',
  'd1cc529d-d5d2-4460-b2bb-acf24a7c5999',
  'bd0bf3bd-d6b9-4706-bfcb-9c867e47b881',
  'b68d0c8c-548e-472f-9b01-f25d4b199a71',
  'd1cc529d-d5d2-4460-b2bb-acf24a7c5999',
  'bd0bf3bd-d6b9-4706-bfcb-9c867e47b881' ]
 */
```

```
.as-console-wrapper {max-height: 100% !important; top: 0}
```

```
<script src="https://bundle.run/object-scan@13.7.1"></script>
```

*免责声明*：我是[对象扫描的作者](https://www.npmjs.com/package/object-scan)

# php - cURL 到公共网站没有收到 SYN_ACK 数据包？

> ID：15993042
> 
> 赞同：0
> 
> 时间：2013-04-13T21:15:43.470
> 
> 标签：php, linux, networking, curl, tcp

我正在编写一个脚本，该脚本需要非常简短地抓取公共网站的 URL。我正在用 PHP 编写脚本，但我也从命令行进行了测试，并且存在同样的问题。

基本上，这是我得到的错误：

```
curl: (7) couldn't connect to host 
```

我看了这个命令：

```
netstat -ac 5 |grep tcp 
```

我可以看到 SYN_SENT 数据包出站（尽管它们似乎在端口 58047 上离开，即使我使用 cURL 指定了端口 80），但服务器从不响应 SYN_ACK。

使用浏览器，我可以很容易地查看相同的确切地址。

大约一周前，他们的服务器遭受了某种攻击，所以我不得不想象他们正在防火墙上丢弃我的数据包或使用 iptables，但我只是想发送一个请求。

我已经尝试发送一个浏览器代理字符串，我知道服务器会使用 cURL 进行响应，但唉，什么也没有。该脚本位于 AWS EC2 实例上。

就消除我的未知数而言，我什至不确定该怎么做。我不知道如何真正监控 TCP 流量，或者了解我所看到的内容，但我想弄清楚这一点。

有什么建议吗？

PS：我已经确认 cURL 工作正常。它完全没有任何麻烦地拉动了 google.com。

# android - Android - colorToHSV 不起作用

> ID：15993044
> 
> 赞同：0
> 
> 时间：2013-04-13T21:16:07.057
> 
> 标签：android, graphics, colors

我正在尝试使用`Color.colorToHSV`此代码的功能：

```
float[] hsv = new float[3];
android.graphics.Color.colorToHSV(color, hsv); 
```

但是 hsv 数组中的结果总是`{0.0, 0.0, 0.0}`，什么磨损了？这是一个错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T17:16:17.347

显然，在编辑模式下使用 colorToHSV (View.isInEditMode()) 时，该函数返回零。当它在设备上运行时，它可以工作......

# jquery - 如何使用数据库中的标志动态更改 Flexigrid 行颜色？

> ID：15993046
> 
> 赞同：0
> 
> 时间：2013-04-13T21:16:33.310
> 
> 标签：jquery, colors, row, flexigrid

我从 json 中的数据库读取数据并将它们放入 flexigrid 表中。数据库表中的一个单元格的名称为“color”，其值为 0 或 1。

**如果“color = 0”如何将行颜色更改为蓝色，如果“color = 1”如何更改为红色？**

我在 flexigrid.js 中找到了这段代码，但不能使用它：

```
// If the content has a <BGCOLOR=nnnnnn> option, decode it.
var offs = td.innerHTML.indexOf( '<BGCOLOR=' );
if( offs > 0 ) {
    $(td).css('background', text.substr(offs+7,7) );
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T20:49:25.553

**我找到了解决方案：**

在 flexigrid.js 中找到这段代码：

```
// If the content has a <BGCOLOR=nnnnnn> option, decode it.
var offs = td.innerHTML.indexOf( '<BGCOLOR=' );
if( offs > 0 ) {
    $(td).css('background', text.substr(offs+7,7) );
} 
```

并用这个改变它

```
var offs = td.innerHTML.indexOf('[BGCOLOR=');
var numcolor = td.innerHTML.substr(offs+9,7);
if(offs >= 0) {
    $(td).css('backgroundColor', numcolor);
    td.innerHTML = td.innerHTML.replace("[BGCOLOR="+numcol+"]", "");
} 
```

现在，JSON 中的每个文本**[BGCOLOR=#123456]**都将被删除，编号**#123456**将被设置为表格中单元格的背景颜色。

我希望这会对某人有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T21:19:52.297

该`bgcolor`属性在 HTML5 中已弃用。改用 CSS `background-color`。

# javascript - 如何删除数组中的空格？

> ID：15993047
> 
> 赞同：1
> 
> 时间：2013-04-13T21:16:36.220
> 
> 标签：javascript, arrays

我正在尝试创建一个将单词存储在数组中的程序，我所做的是无论程序找到分隔符（“”或“，”）它都会将它推入数组，我的问题是它甚至存储分隔符（我必须使用数组分隔符）。

```
var sentence = prompt("");

var tab = [];

var word = "" ;

var separators = [" ", ","];

for(var i = 0 ; i< sentence.length ; i++){

    for(var j = 0 ; j < separators.length ; j++){

    if(sentence.charAt(i) != separators[j] && j == separators.length-1){

           word += sentence.charAt(i); 

        }else if(sentence.charAt(i) == separators[j]){

           tab.push(word);
           word = "";

        }

    }

}

tab.push(word);
console.log(tab); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-13T21:19:39.327

你可以试试这个：

```
var text = 'Some test sentence, and a long sentence';
var words = text.split(/,|\s/); 
```

如果您不想要空字符串：

```
var words = text.split(/,|\s/).filter(function (e) {
    return e.length;
});
console.log(words); //["some", "test", "sentence", "and", "a", "long", "sentence"] 
```

如果你需要使用数组，你可以试试这个：

```
var text = 'Some test sentence, and a long sentence',
    s = [',', ' '],
    r = RegExp('[' + s.join('') + ']+'),
    words = text.split(r); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-13T21:19:14.700

我只会使用正则表达式：

```
var words = sentence.split(/[, ]+/); 
```

如果要修复代码，请使用`indexOf`而不是`for`循环：

```
for (var i = 0; i < sentence.length; i++) {
    if (separators.indexOf(sentence.charAt(i)) === -1) {
        word += sentence.charAt(i);
    } else {
        tab.push(word);
        word = "";
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-13T21:26:42.010

重新检查问题后，我认为您需要结合本机字符串函数和[来自优秀下划线库的紧凑方法，该库](http://underscorejs.org/#compact)删除数组中的“虚假”条目：

```
$('#textfield).keyup(analyzeString);
var words;
function analyzeString(event){
    words = [];
    var string = $('#textfield).val()
    //replace commas with spaces
    string = string.split(',').join(' ');
    //split the string on spaces 
    words = string.split(' ');
    //remove the empty blocks using underscore compact
    _.compact(words);
} 
```

# c++ - 转换旧代码库（列表/向量迭代器不可取消引用）

> ID：15993055
> 
> 赞同：1
> 
> 时间：2013-04-13T21:17:15.470
> 
> 标签：c++, stl, iterator

我有一个旧代码库，我想在 vs2012 上编译，现在在删除了许多旧头文件之后，我最终得到了一个可以正确编译和运行的版本，但它因（List iterator not dereferencable）错误而崩溃。我发现这仅发生在对列表或向量进行操作的 .erase 调用上。原始代码库使用 vs2003.net。

现在的问题是，我知道如何转换它们，但问题是有 400 多个地方会发生此错误，而我无法手动转换所有这些。有谁知道一些方法/黑客使新的矢量类与旧的编码方式兼容？STLPort 或一些自定义 STL 或一些定义或什么？

# ruby-on-rails - 如何在rails 2中做同样的事情？

> ID：15993058
> 
> 赞同：2
> 
> 时间：2013-04-13T21:17:42.883
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

ActiveSupport 的示例 Rails 3 代码

```
set_callback :save, :before, :before_meth
set_callback :save, :after,  :after_meth, :if => :condition
set_callback :save, :around, lambda { |r| stuff; result = yield; stuff } 
```

谁能建议如何在 rails 2 中执行此操作，因为没有 set_callback 方法我需要在 rails 2 中的方法调用之前执行一些操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T21:29:27.407

使用 before_save 和 after_save。[http://railsapi.com/doc/v2.3.2/#M001840](http://railsapi.com/doc/v2.3.2/#M001840)

# bash - Bash 脚本缺少']'

> ID：15993062
> 
> 赞同：100
> 
> 时间：2013-04-13T21:18:21.613
> 
> 标签：bash, scripting

我在文件 test.sh 中收到错误 ./test.sh: line 13: [: missing `]' 我尝试使用方括号和其他选项，例如 -a 或检查文件 p1 的大小，但错误是总是在那里，无论给定的输入如何，总是执行 else 语句。我什至尝试删除 ; 在第 13 行，但它没有帮助。

测试.sh

```
#!/bin/bash
echo "Enter app name"
read y
$y &
top -b -n 1 > topLog.log
#-w checks for the whole word not and sub string from that word
grep -w "$y" topLog.log > p1
#-s option checks if the file p1 is present or not
if [ -s "p1"];  #line 13
then 
    echo "Successful "
else
    echo "Unsuccessful"
fi
rm p1 
```

我是 bash 脚本的新手。所以如果有任何愚蠢的错误，请原谅。

* * *

## 回答 #1

> 赞同：252
> 
> 时间：2013-04-13T21:20:25.830

改变

```
if [ -s "p1"];  #line 13 
```

进入

```
if [ -s "p1" ];  #line 13 
```

注意空间。

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2017-01-18T21:05:06.877

尝试`&&`在单括号内使用运算符时出现此错误，例如`[ ... && ... ]`. 我不得不切换到`[[ ... && ... ]]`.

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2013-04-13T21:20:31.593

您在 之后缺少一个空格`"p1"`：

```
if [ -s "p1" ]; 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2013-04-13T21:20:16.130

在右括号前添加一个空格

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2019-12-18T10:39:21.940

如果您在 windows 上创建了脚本并希望在 linux 机器上运行它，并且您确定您的代码没有错误，请在 linux 机器上安装**dos2unix**并运行`dos2unix yourscript.sh`. 然后，运行脚本。

# php - 如何制作服务器端幻灯片

> ID：15993067
> 
> 赞同：-2
> 
> 时间：2013-04-13T21:18:57.660
> 
> 标签：php, javascript, slideshow, server-side

我试图找到制作服务器端幻灯片的最佳方法，程序将从名为 /inviteuploads 的文件夹中获取图片，并在幻灯片中显示该文件夹的内容（该文件夹将只包含图像）。我很乐意使用 Javascript、HTML、PHP 或您建议的任何其他内容。也许这甚至不可能，但请告诉我！
我还看到了这篇文章：[How to create dynamic video/slideshow from pictures in PHP](https://stackoverflow.com/questions/7546302/how-to-create-dynamic-video-slideshow-from-pictures-in-php) 但这并没有真正回答我的问题，我需要从文件夹中获取上传并将它们显示在幻灯片中。此外，我不*只是*想使用 php，我对任何其他建议的语言都持开放态度。
谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-13T21:27:42.953

使用全局函数。

请参阅：[使用 PHP 列出目录中的所有图像](https://stackoverflow.com/questions/3738270/listing-all-images-in-a-directory-using-php)

现在使用图像路径制作幻灯片。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T21:44:16.863

代码在 asp.net 中...动画需要 jquery 库

我正在使用 scriptmanager 的 pagemethods 属性访问文件夹“inviteuploads”中存在的图像，然后将它们显示在 div 容器中...返回值将包含由“\u000d”分隔的图像的位置...我正在使用淡入淡出和淡出效果..您可以使用您选择的任何效果:)

见下面的代码：

**服务器端代码**

```
[System.Web.Script.Services.ScriptMethod, System.Web.Services.WebMethod]
public static string slideshow()
{
    string filename = string.Empty;

    try
    {
        string[] Files = Directory.GetFiles(HttpContext.Current.Server.MapPath("inviteuploads"));

        for (int i = 0; i < Files.Length; i++)
        {
            filename += "inviteupload/" + Path.GetFileName(Files[i]) + "\u000d";
        }
    }
    catch (Exception ex)
    {
    }
    return filename;
} 
```

**客户端代码**

```
 function slideshow() {

        PageMethods.slideshow(successslideshow, failureslideshow);

        function successslideshow(msg) {
            var arr = msg.split("\u000d");
            var i = 0;

            for (j = 0; j < (arr.length - 1); j++) {
                $("#divslideshow").append("<img id=imgslideshow_" + j + " src=" + arr[j] + " width=700px height=700px style='display:none; max-height: 700px; max-width: 700px;' />");
            }

            $("#imgslideshow_" + i).fadeIn();
            setInterval(function () {
                $("#imgslideshow_" + i).fadeOut(function () {
                    i++;
                    if (i <= (arr.length - 2)) {
                        $("#imgslideshow_" + i).fadeIn();
                    }
                    else {
                        i = 0;
                        $("#imgslideshow_" + i).fadeIn();
                    }
                });
            }, 6000);
        }

        function failureslideshow(msg) {
        }
    } 
```

# vb.net - 我看不出这是如何给我一个 nullref 异常

> ID：15993070
> 
> 赞同：1
> 
> 时间：2013-04-13T21:19:03.410
> 
> 标签：vb.net, nullreferenceexception

为什么下面粘贴的代码会给我一个空引用异常？因为我似乎根本无法找出原因。

注意：文本框具有正确的名称，并且当我收到异常时它们不是空的。

我的代码：（我突出显示了错误所在的行）

```
txtGuid.BackColor = Color.White
    txtName.BackColor = Color.White
    If txtGuid.Text <> "" And txtName.Text <> "" Then
        Dim name As String = txtName.Text
        Dim guid As String = txtGuid.Text
        **frmWhitelist.names.Add(name)**
        frmWhitelist.guids.Add(guid)
        Me.Close()
    Else
        If txtGuid.Text = "" Then
            txtGuid.BackColor = Color.Red
        End If
        If txtName.Text = "" Then
            txtName.BackColor = Color.Red
        End If
        lblError.Text = "Please check your input in the red-colored fields."
    End If 
```

调用堆栈：

`> DayZAdminApp.exe!DayZAdminApp.inptBoxWhitelist.btnOk_Click(Object sender, System.EventArgs e) Line 15 + 0x3d bytes Basic`

调试时，`txtGuid.text`和`txtName.text`都在我的 Locals 选项卡中具有文本值。

PS：如果这是由于我正在尝试 2 将项目添加到另一个表单上的公共变量，我该如何解决这个问题？

PPS：`frmWhitelist.names`and`frmWhitelist.guids`声明如下：

`Public names, guids As List(Of String)`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T21:30:05.173

这些列表是`Nothing`因为您尚未初始化它们。

所以你在这里得到一个例外：

```
frmWhitelist.names 
```

这避免了异常：

```
Public names As New List(Of String)
Public guids As New List(Of String) 
```

您只是在这里声明它们：

```
Public names, guids As List(Of String) 
```

`Nothing`即使他们被宣布，他们仍然在这一点上。

# cloud-foundry - Spring Data / REST - 在 Cloud Foundry 上托管时绝不会暴露任何内容

> ID：15993076
> 
> 赞同：2
> 
> 时间：2013-04-13T21:19:35.557
> 
> 标签：cloud-foundry, spring-data, spring-data-jpa, spring-data-rest

我有一个非常基本的调查应用程序：

*   一个 JPA 实体 ( `Survey.java`)
*   一个 Spring MVC 控制器 ( `SurveyController.java`)
*   一个 Spring Data/JPA 存储库 ( `SurveyRepository.java`)
*   3 个主要步骤，每个步骤都匹配一个特定的验证组
*   通过 Spring Data/REST 配置公开的 REST API（请参阅 参考资料`ApiConfiguration.java`）

你可以在这里看到它：http: [//survey-preprod.cloudfoundry.com/](http://survey-preprod.cloudfoundry.com/)。来源可在此处获得：[https ://github.com/fbiville/spring-example-survey](https://github.com/fbiville/spring-example-survey) ://github.com/fbiville/spring-example-survey 。

只需正确填写表格（3 个步骤 - 只需回答任何问题），直到您看到“谢谢！” 页。然后继续：[http ://survey-preprod.cloudfoundry.com/api/survey](http://survey-preprod.cloudfoundry.com/api/survey) ://survey-preprod.cloudfoundry.com/api/survey并注意根本没有内容！

我推送到 Cloud Foundry 的所有 Spring Data / REST 都会发生这种情况。在本地运行时，根本没有任何问题。

有什么我错过的吗？

提前致谢， 罗尔夫

编辑：即使有

`curl -v -H "Accept: application/json" -X GET http://survey-preprod.cloudfoundry.com/api/survey`

（因此正确设置了接受标头），没有内容被暴露...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T18:17:46.633

好吧，伙计们，就像（可悲地）经常一样，这是一个明显的 PEBKAC 实例。

ApiConfiguration 正在导入 CoreConfiguration（它已经按照 web.xml 的定义加载了一次）。因此，再次加载了相同的“核心”bean，但 CloudFoundry 自动重新配置仅在声明的数据源上第一次发生，并让复制的数据源保持原样（即：H2 数据库，当然没有任何内容）。

# ruby-on-rails - sidekiq - 当 redis 服务器未运行时回退到标准同步 ruby 代码

> ID：15993080
> 
> 赞同：3
> 
> 时间：2013-04-13T21:20:03.483
> 
> 标签：ruby-on-rails, redis, sidekiq

我在 Rails 应用程序中使用[sidekiq](http://mperham.github.io/sidekiq/)异步发送一些电子邮件。即使 Redis 服务器未运行，如何确保代码（作业本身）也能执行。

```
CommentsWorker.perform_async(@user.id, @comment.id) 
```

在评论工作者中，我正在获取用户和评论，并发送一封电子邮件：

```
def perform(user_id, comment_id)
  user = User.find(user_id)
  comment = Comment.find(comment_id)

  CommentMailer.new_comment(user, comment).deliver
end 
```

如果我停止 Redis 服务器，我的应用程序会引发异常`Redis::CannotConnectError`

即使服务器停止，我仍然想使用老式同步代码发送该电子邮件。我试图`rescue`摆脱那个异常，但由于某种原因它不起作用。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-13T22:22:47.360

弄清楚了。解决方案是测试 redis 连接并从异常中救援，但*在*调用`perform_async`. 现在只有必须等待连接超时的小问题，但我想我可以忍受。

```
redis_available = true
Sidekiq.redis do |connection|
  begin
    connection.info
  rescue Redis::CannotConnectError
    redis_available = false
  end
end

if redis_available
  CommentsWorker.perform_async(user.id, @comment.id, @award.id)
else
   #sync code
   user = User.find(user_id)
   comment = Comment.find(comment_id)

   CommentMailer.new_comment(user, comment).deliver
end 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-08-31T16:49:31.337

我知道这已经得到解答，我喜欢@mihai 的方法，但我们希望在我们的应用程序的其他地方为多个工作人员重用代码。此外，我们想让它更通用地与任何工人一起工作。

我们决定使用下面定义`Sidekiq::Worker`的附加方法进行扩展`perform_async_with_failover`：

```
module Sidekiq
  module Worker
    module ClassMethods
      def perform_async_with_failover(*args)
        redis_available = true
        Sidekiq.redis do |connection|
          begin
            connection.info
          rescue Redis::CannotConnectError
            redis_available = false
          end
        end
        if redis_available
          # process the job asynchronously
          perform_async(*args)
        else
          # otherwise, instantiate and perform synchronously
          self.new.perform(*args)
        end
      end
    end
  end
end 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-02-15T11:21:07.453

改进上面的凯尔解决方案，因为我猜想使用`connection.info`的是查看是否有可用的连接。但我的理解是，`info`当 redis 在线时会发送额外的命令，这是不必要的。我只会从以下位置捕获异常`perform_async`：

```
module Sidekiq
  module Worker
    module ClassMethods
      def perform_async_with_failover(*args)
        begin
          # process the job asynchronously
          perform_async(*args)
        rescue Redis::CannotConnectError => e
          # otherwise, instantiate and perform synchronously
          self.new.perform(*args)
        end
      end
    end
  end
end 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-13T21:27:16.877

**编辑**：
你可能想看看[sidekiq 错误处理部分](https://github.com/mperham/sidekiq/wiki/Error-Handling)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-11-09T23:52:01.393

实施@mihai 的回答我最终创建了一个服务来封装“优雅地发送电子邮件”的动作。

调用类的示例：

```
message = MyMailer.order_confirmation(email_arguments)
GracefullyDeliverEmail.call(message) 
```

班上：

```
class GracefullyDeliverEmail
  ###
  # Attempts to queue email for async sending but fails
  # gracefully to delivering it immediately.
  #
  # @param context.message {ActionMailer::MessageDelivery}
  ###
  def self.call(message)
    validate!(message)

    if redis_available?
      message.deliver_later(wait: 2.mins)
    else
      message.deliver_now # Fallback to inline delivery
    end
  end

  # == Private Methods ======================================================
  private

  # https://stackoverflow.com/questions/15993080/sidekiq-fall-back-to-standard-sync-ruby-code-when-redis-server-is-not-running/42247913#42247913
  def redis_available?
    redis_available = true
    Sidekiq.redis do |connection|
      begin
        connection.info
      rescue Redis::CannotConnectError
        redis_available = false
      end
    end
    redis_available
  end

  def validate!(message)
    if !message.is_a?(ActionMailer::MessageDelivery)
      raise "message must be of class ActionMailer::MessageDelivery"
    end
  end
end 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-13T21:52:56.313

您应该检查是否有活动的 redis 客户端，例如：

```
def perform(user_id, comment_id)
  user = User.find(user_id)
  comment = Comment.find(comment_id)

  redis_info = Sidekiq.redis { |conn| conn.info }

  CommentMailer.new_comment(user, comment).deliver

  rescue Redis::CannotConnectError
    CommentMailer.new_comment(user, comment)
end 
```

应该这样做。

# dns - 如何读取 DNS SOA 记录？

> ID：15993085
> 
> 赞同：21
> 
> 时间：2013-04-13T21:20:35.253
> 
> 标签：dns

我在阅读 SOA 记录时遇到了一些麻烦。`dig`在用于获取我控制的域的 SOA 记录后，我得到以下响应。

```
SOA ns1.example.com. xxx.gmail.com. 2013041357 14400 14400 1209600 86400 
```

我应该如何知道每个字段与哪个值相关联？根据[这篇文章](http://www.zytrax.com/books/dns/ch8/soa.html)，一个 SOA 记录可以有九个字段。

我想象每个空格都表示一个值的结尾，我可以看到第二个值是电子邮件地址。但是我如何确定哪个是刷新值，哪个是重试值？它们只是旁边没有字段名称的数字！

我在这里错过了什么吗？提前致谢。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2013-04-13T21:24:03.687

如果您使用`+multiline`dig 参数，您将看到更详细的输出。

```
dig SOA +multiline yahoo.com

yahoo.com.      1800 IN SOA ns1.yahoo.com. hostmaster.yahoo-inc.com. (
                2013041300 ; serial
                3600       ; refresh (1 hour)
                300        ; retry (5 minutes)
                1814400    ; expire (3 weeks)
                600        ; minimum (10 minutes)
                ) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-13T21:22:52.903

请参阅[此链接](http://support.microsoft.com/kb/163971)。

如图所示：

```
@   IN  SOA     nameserver.place.dom.  postmaster.place.dom. (
          1      ; serial number
       3600      ; refresh   [1h]
        600      ; retry     [10m]
      86400      ; expire    [1d]
       3600 )    ; min TTL   [1h] 
```

# mysql - 将 MySQL 服务器作为服务启动 (Win 8)

> ID：15993089
> 
> 赞同：14
> 
> 时间：2013-04-13T21:21:33.060
> 
> 标签：mysql, database, service, windows-8, mysql-workbench

我正在尝试安装工作台（gui）的 MySQL（Windows 8）。

我仍在安装/配置过程中。我想创建一个新的数据库。因此，在工作台的欢迎屏幕上，我选择了`New Server Instance- Register a new Server instance to manage`.

为了做到这一点，我经历了以下配置步骤：

1.  指定`localhost`为服务器主机，

2.  给它我正在使用的用户名和密码。

然后它测试数据库连接，并在下一步中要求我

> 从下面的列表中选择要管理的服务。它还将帮助查找配置文件。

**但是，可能的服务列表是空的，如果我单击 [下一步]，它会说**

> 错误：为了管理 MySQL 服务，它必须作为服务安装。向导在目标机器上找不到任何 MySQL 服务，因此无法启动服务器实例。

我认为我必须以某种方式启动 MySQL 服务，因为它可能在我安装整个 MySQL 工具集时已经安装。

那么：**我将如何在 Windows 8 下启动这个 MySQL 服务？**

**我尝试过的一些事情：**

[手册](http://dev.mysql.com/doc/refman/5.1/en/windows-start-command-line.html)说尝试：

```
C:\> "C:\Program Files\MySQL\MySQL Server 5.1\bin\mysqld" 
```

以便将其安装为服务。然而，什么也没发生，我得到以下信息（删除了一些冗长的 [Note]）：

```
2013-04-13 23:44:22 0 [Warning] TIMESTAMP with implicit DEFAULT value is depreca
ted. Please use --explicit_defaults_for_timestamp server option (see documentati
on for more details).
2013-04-13 23:44:22 2592 [Warning] Can't create test file c:\Program Files\MySQL
\MySQL Server 5.6\data\gast.lower-test
2013-04-13 23:44:22 2592 [Warning] Can't create test file c:\Program Files\MySQL
\MySQL Server 5.6\data\gast.lower-test
[...]
2013-04-13 23:44:22 2592 [ERROR] InnoDB: read can't be opened in .\ibdata1 mode
2013-04-13 23:44:22 2592 [ERROR] InnoDB: The system tablespace must be writable!

2013-04-13 23:44:22 2592 [ERROR] Plugin 'InnoDB' init function returned error.
2013-04-13 23:44:22 2592 [ERROR] Plugin 'InnoDB' registration as a STORAGE ENGIN
E failed.
2013-04-13 23:44:22 2592 [ERROR] Unknown/unsupported storage engine: InnoDB
2013-04-13 23:44:22 2592 [ERROR] Aborting

2013-04-13 23:44:22 2592 [Note] Binlog end
[...]
2013-04-13 23:44:22 2592 [Note] mysqld: Shutdown complete 
```

要将服务器安装为服务，我使用了此命令（[根据手册](http://dev.mysql.com/doc/refman/5.1/en/windows-start-service.html)）。

```
C:\> "C:\Program Files\MySQL\MySQL Server 5.1\bin\mysqld" --install 
```

再一次，“什么都没有”发生，我得到了（同样，大部分冗长的 [Note] 都被删除了）：

```
Install/Remove of the Service Denied!

c:\Program Files\MySQL\MySQL Server 5.6\bin>mysqld -p --install
2013-04-13 23:43:24 0 [Warning] TIMESTAMP with implicit DEFAULT value is depreca
ted. Please use --explicit_defaults_for_timestamp server option (see documentati
on for more details).
2013-04-13 23:43:24 3764 [Warning] Can't create test file c:\Program Files\MySQL
\MySQL Server 5.6\data\gast.lower-test
2013-04-13 23:43:24 3764 [Warning] Can't create test file c:\Program Files\MySQL
\MySQL Server 5.6\data\gast.lower-test
[...]
2013-04-13 23:43:24 3764 [ERROR] InnoDB: read can't be opened in .\ibdata1 mode
2013-04-13 23:43:24 3764 [ERROR] InnoDB: The system tablespace must be writable!

2013-04-13 23:43:24 3764 [ERROR] Plugin 'InnoDB' init function returned error.
2013-04-13 23:43:24 3764 [ERROR] Plugin 'InnoDB' registration as a STORAGE ENGIN
E failed.
2013-04-13 23:43:24 3764 [ERROR] mysqld: unknown option '-p'
2013-04-13 23:43:24 3764 [ERROR] Aborting

2013-04-13 23:43:24 3764 [Note] Binlog end
[...]
2013-04-13 23:43:24 3764 [Note] mysqld: Shutdown complete 
```

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2013-12-12T11:20:18.653

在开始中输入 cmd 并右键单击并以管理员身份运行，

然后将以下文本粘贴到命令提示符中，

```
"C:\Program Files (x86)\MySQL\MySQL Server 5.1\bin\mysqld" --install 
```

如果你不以管理员身份运行 cmd，你会看到`Install/Remove of service denied.`，

因此，运行提升的命令提示符（开始->cmd->以管理员身份运行）以查看`Service Successfully installed`消息。

![拒绝服务截图](https://i.stack.imgur.com/oHsL5.png)

***注意****：即使您在 Windows 7/8 中以管理员身份登录也是如此。*

如果您想卸载该服务，请执行以下操作，将以下内容复制粘贴到命令提示符中（再次提升命令提示符）运行此命令，

`sc delete MySQL`

这里`MySQL`的命令是 mysql 在 Windows PC 中默认创建的服务名称。确保您看到服务已安装在服务列表中（任务管理器 -> 服务选项卡 -> 检查 Mysql 服务名称列）。

![服务删除命令提示符截图](https://i.stack.imgur.com/35XDR.png)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-06-02T16:11:00.853

我也有同样的问题。我在管理员模式下启动了命令提示符，然后进入`C:> "C:\Program Files\MySQL\MySQL Server 5.1\bin\mysqld"`然后输入。它工作正常。

**第二种方式：**在安装 mysql 工作台时，它会询问用户名和密码。默认情况下，用户名是 root，所以如果您设置了密码并且仍然记得它，那么启动 MySQL 命令行客户端并输入密码，然后启动工作台。它会正常工作。

希望这可以帮助你。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-14T09:08:35.173

Hans，首先，MySQL 安装程序应该已经将新服务器安装为服务。您无需手动执行此操作。如果您已经在那里看到服务，请查看您的服务列表。在安装服务器/服务时，您是否在 MySQL 安装程序中收到错误消息？

另一点是服务器无法启动，正如您在日志输出中看到的那样。InnoDB 存储出现严重问题。您是否以某种方式更改了配置？请记住，MySQL 数据不得写入应用程序文件夹，而应写入应用程序数据路径。默认情况下，MySQL 安装程序也应该处理这个问题。

最后，如果您在没有连接/服务器实例的情况下启动 MySQL Workbench，它将扫描服务以查找现有 MySQL 服务器并为它们自动创建连接和实例。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2014-05-28T09:49:52.153

我就是这样安装的`mysqld`：

```
"e:\denwer\usr\local\mysql-1-5.5\my.ini" --install "mysqld" --defaults-file="e:\denwer\usr\local\mysql-5.5\my.ini" 
```

我也以管理员身份运行命令提示符。

# javascript - Google Maps API v3，地理位置未正确返回

> ID：15993091
> 
> 赞同：1
> 
> 时间：2013-04-13T21:21:48.430
> 
> 标签：javascript, google-maps, google-maps-api-3

我有一个问题，如果我将地理编码的结果放入一个变量中，该变量返回空。这是我的代码：

**地图初始化：**

```
function init_map() {
  geocoder = new google.maps.Geocoder();

  var center_address = get_long_lat("Salisbury, UK");
  var latlng = new google.maps.LatLng(center_address);

  var mapOptions = {
    zoom: 8,
    center: latlng,
    mapTypeId: google.maps.MapTypeId.ROADMAP
  }

  map = new google.maps.Map(document.getElementById("gmap"), mapOptions);
} 
```

如您所见，我正在尝试通过使用自定义函数 get_long_lat 将地址转换为 Long 和 Lat 来将地图中心定位到我的家乡：

**获得长和纬**

```
function get_long_lat(address) {

      var result = "";

      geocoder.geocode( { 'address': address, 'region': 'uk' }, function(results, status) {
          if (status == google.maps.GeocoderStatus.OK) {
              result = results[0].geometry.location;
          } else {
            result = "Unable to find address: " + status;
          }
      });

      return result;
  } 
```

现在，结果作为空字符串返回。但是，如果我要显示 results[0].geometry.location 的警报，它会显示我期望的正确值吗？

为什么它不想返回这个值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T21:38:04.880

地理编码器是异步的。您不能从异步函数返回结果。您应该使用`result`回调内部的值。

更具体地说，正在发生的事情是您的`return result;`行实际上`result`是在分配变量之前执行的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T21:36:07.103

```
geocoder.geocode( { 'address': address, 'region': 'uk' }, function(results, status) {}); 
```

这段代码调用 Google 服务器以检索地理编码信息。在收到来自 Google 服务器的响应后，它会执行指定的回调函数。

```
return result; 
```

此行在回调函数检索到信息之前被命中，因此结果仍然为空。检索到信息后，将调用回调函数并填充结果。但为时已晚，“get_long_lat”函数已经返回了它的结果，返回的时候还是空的。

问题是返回结果的回调函数是异步运行的。

如果你这样写它会起作用：

```
function init_map() {
  geocoder = new google.maps.Geocoder();

  geocoder.geocode( { 'address': 'Salisbury, UK', 'region': 'uk' }, function(results, status) {
      if (status == google.maps.GeocoderStatus.OK) {

        var mapOptions = {
          zoom: 8,
          center: results[0].geometry.location,
          mapTypeId: google.maps.MapTypeId.ROADMAP
        }

        map = new google.maps.Map(document.getElementById("gmap"), mapOptions);

      } else {
        //Do whatever you want to do when the address isn't found.
        //result = "Unable to find address: " + status;
      }
  });

} 
```

现在 mapOptions 仅在 Google 服务器返回响应后才被初始化。

# objective-c - 自定义 UINavigationBar 和 DRY 规则

> ID：15993097
> 
> 赞同：1
> 
> 时间：2013-04-13T21:22:54.527
> 
> 标签：objective-c, uinavigationbar

我有很多与更改`UINavigationBar`元素相关的代码。我几乎必须在我的每一个视图控制器中使用它，并且每次我需要设置一个`UILabel` `titleLabel`带有视图标题的自定义项时。

在许多视图中使用此代码而不重复相同代码的最佳方法是什么？我是否应该创建另一个类，然后将其导入我的视图控制器并使用该类中的方法每次设置标题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T21:45:09.023

您可以通过执行以下操作全局设置外观设置：

```
UINavigationBar *navigationBar = [UINavigationBar appearance];
[navigationBar setBackgroundImage:[UIImage imageNamed:@"nav-background"] forBarMetrics:UIBarMetricsDefault]; 
```

我从开源 cheddar 应用程序的 appdelegate 中获取了这个代码片段：

[https://github.com/nothingmagical/cheddar-ios/blob/master/Classes/CDIAppDelegate.m](https://github.com/nothingmagical/cheddar-ios/blob/master/Classes/CDIAppDelegate.m)

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T21:50:57.560

我将创建一个`UIViewController`包含所有“通用”内容的子类，并让所有特定的视图控制器都继承自该子类。

# jquery - jQuery 移动应用程序

> ID：15993099
> 
> 赞同：3
> 
> 时间：2013-04-13T21:23:03.480
> 
> 标签：jquery, cordova, jquery-mobile, jsfiddle

您好，我正在编写一个 jQuery 移动应用程序作为项目的一部分。

我知道 jQuery Mobile 广泛用于跨平台应用程序。

所以我有一个（也许是愚蠢的）问题。在我的计算机中，有所有需要的文件（jQuery Mobile、html 文件、css 文件等），我通过从 Web 浏览器查看 html 文件来测试我的应用程序。

如果我想在 Android 手机中测试应用程序（例如），我应该怎么做？

将整个文件夹传输到我的手机并从浏览器查看 html 文件，或者有一种方法可以构建所有文件并像应用程序一样在手机中运行它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T21:24:43.600

只需将您的文件上传到网络服务器。有一些免费的选项非常适合测试。

您可以将 PC 设置为服务器，并通过手机的 wi-fi 访问它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-14T08:49:54.433

您的问题有几种解决方案，我将列举它们从最简单的解决方案到更难的解决方案。

## [jsFiddle](http://jsfiddle.net/)

如果您有一个简单的应用程序，您可以在**[jsFiddle](http://jsfiddle.net/)**网络工具中对其进行测试。它可以提供几乎完整的 jQuery Mobile 功能，除了表单提交和多 HTML 支持。

这是一个简单的 jQuery Mobile jsFiddle 示例：http: [//jsfiddle.net/Gajotres/yWTG2/](http://jsfiddle.net/Gajotres/yWTG2/)

当您想测试它时，只需转到共享选项并单击全屏，如下所示：

[http://jsfiddle.net/Gajotres/yWTG2/embedded/result/](http://jsfiddle.net/Gajotres/yWTG2/embedded/result/)

jsFiddle 的一个好处是您不需要完整的 HTML（就像我的示例中一样），您可以使用基本页面 HTML 对其进行测试：

```
<div data-role="page" id="index">
    <div data-theme="a" data-role="header">
        <h3>
            First Page
        </h3>
        <a href="#second" class="ui-btn-right">Next</a>
    </div>

    <div data-role="content">

    </div>

    <div data-theme="a" data-role="footer" data-position="fixed">

    </div>
</div> 
```

示例：http: [//jsfiddle.net/Gajotres/fEV3J/](http://jsfiddle.net/Gajotres/fEV3J/)

## 托管

如果您有自己的虚拟主机，只需上传您的文件并通过互联网进行测试。

## 本地网络服务器

您可以在本地计算机上安装 PHP Web 服务器包并在本地 LAN 中测试所有内容。这不需要 PHP，我们只需要一个配置好的 Apache 服务器。虽然您可以单独下载并自行安装，但下载预构建包要容易得多，例如：

*   [**XAMPP**](http://www.apachefriends.org/en/xampp.html) - 赢

*   [**WAMP**](http://www.wampserver.com/en/) - 赢

*   [**灯**](http://en.wikipedia.org/wiki/LAMP_%28software_bundle%29)——Linux

*   [**MAMP**](http://www.mamp.info/en/index.html) -Mac

## [Phonegap/Cordova 应用程序](http://phonegap.com/)

Phonegap 是一个移动应用程序框架，它充当原生应用程序和 Web 应用程序之间的包装器。您可以使用它来创建混合移动应用程序，基本上是一个充当本机移动应用程序的 Web 应用程序。

我不会再写任何关于这个解决方案的内容，因为关于这个主题还有很多其他答案，但为了让你更容易，这里是我关于 Phonegap 和 jQuery Mobile 的另一个答案：[https ://stackoverflow.com/a/14166593/ 1848600](https://stackoverflow.com/a/14166593/1848600)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-15T08:46:44.347

您应该使用[build.phonegap.com](http://build.phonegap.com)上传您的 zip，它会自动为您提供不同平台所需的二进制文件，在您的情况下，对于 android，您将轻松获得一个 .apk 文件。

如果您想在系统上进行本地测试，请安装 WAMP（适用于 Windows）、LAMP（适用于 Linux）或 MAMP（适用于 Mac）。

另外，安装谷歌浏览器。然后，为 Chrome 安装 Ripple Emulator：[https](https://chrome.google.com/webstore/detail/ripple-emulator-beta/geelfhphabnejjhdalkjhgipohgpdnoc?hl=en) ://chrome.google.com/webstore/detail/ripple-emulator-beta/geelfhphabnejjhdalkjhgipohgpdnoc?hl=en 。您可以在 Ripple 中模拟不同的设备。AFAIK，对于 Ripple，你甚至可能不需要 WAMP/LAMP/MAMP。它直接从文件系统中读取。

# css - Opencart 缩放背景

> ID：15993100
> 
> 赞同：2
> 
> 时间：2013-04-13T21:23:04.053
> 
> 标签：css, opencart

我正在建立我的 opencart 商店。我有一张大图片作为整个网页的背景。然后所有的内容都在它上面滚动并保持不变。问题是背景没有正确缩放。它的缩放比例大于页面。如何使用 opencart 将其扩展到 100%？

在我的主页上，我有一个 img 元素，然后使用它来缩放和定位它。

```
img.bg  {
    min-height: 100%;
    width: 100%;
    height: auto;
    position: fixed;
    top:0;
    left:0;
    z-index: -999;
} 
```

但是对于打开的购物车，我必须使用样式表而不是图像元素来发送图像。所以我不确定如何将这些样式应用于背景类。图像设置为 body 类的背景属性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T22:13:31.257

身体 CSS 可能是问题所在。你可以试试这个

```
body {
    max-height:100%;
    max-width:100%;
} 
```

# php - mysql_fetch_array() 期望参数 1 是资源（我知道，重复，但其他都不符合我的需要）

> ID：15993103
> 
> 赞同：-5
> 
> 时间：2013-04-13T21:23:31.197
> 
> 标签：php, login, system

我知道，还有很多关于此的其他主题，但没有一个与我需要帮助的主题相匹配。我正在尝试创建一个用户配置文件系统，它给了我标题中的错误。这是我的鳕鱼：

```
<?php
$dbname="users";
$host="localhost";
$user="root";
$pass="";

$link = mysql_connect($host, $user, $pass);
mysql_select_db($dbname, $link);

$sql_statement = 'SELECT username, name, aboutme, website FROM userprofile';
$result = mysql_query($sql_statement, $link);

while($row = mysql_fetch_array($result))
  {
  echo "<b>User:</b> ".$row['username'].'<br>';
  }
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T21:27:04.960

通常当发生这种情况并且传递的变量显然是结果资源时，如此处所示，您遇到了 MySQL 语法问题。

尝试从 MySQL 命令行执行该查询。它可能会抱怨语法或未知的列或表。非常*非常*仔细地查看查询中的列名，并检查它们是否与数据库中的内容*完全*匹配。

或者，根据您的错误级别，您甚至可能没有连接到数据库。您拥有的代码很好，SQL和PHP之间的事务存在问题。

# python - 如何使用漂亮的汤获取 html 中 span 标签的值？

> ID：15993105
> 
> 赞同：2
> 
> 时间：2013-04-13T21:23:43.310
> 
> 标签：python, beautifulsoup

我的跨度标签包括：`<span id="internal-source-marker_0.9510186333209276"><span>`

我想要做的是将其转换为`<span><span>`

基本上，我想检查 span 是否有 id 值，然后将其完全删除。我完全不知道该怎么做。应该是正则表达式还是漂亮的汤？

正则表达式的问题是我不确定如何替换匹配的子字符串。

也许做一个漂亮的汤和正则表达式的组合？（不确定这是否是一个好的和有效的想法。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T21:26:51.897

只需从`attrib`映射中删除属性；假设您`<span>`在局部变量中有对标记的引用`span`：

```
if span.has_key('id'):
    del span['id'] 
```

演示：

```
>>> soup = BeautifulSoup('<span id="internal-source-marker_0.9510186333209276"></span>')
>>> span = soup.find('span')
>>> span
<span id="internal-source-marker_0.9510186333209276"></span>
>>> if span.has_key('id'):
...     del span['id']
... 
>>> span
<span></span> 
```

# perl - 安装 CPAN 模块

> ID：15993107
> 
> 赞同：0
> 
> 时间：2013-04-13T21:24:01.933
> 
> 标签：perl, module, installation, cpan

当我想安装 perl 模块时遇到问题，我制作“cpan”来安装 cpan，但我得到了这个“

> 终端不支持 AddHistory。
> 
> 您的配置建议 CPAN.pm 应该使用 /home/cyrine/.cpan的工作
> 目录 不幸的是， 由于权限问题， 我们无法创建锁定文件 /home/cyrine/.cpan/.lock 。
> 
> 请确保配置变量 $CPAN::Config->{cpan_home} 指向可以写入 .lock 文件的目录。您可以在 @INC 路径中的 CPAN/MyConfig.pm 或 CPAN/Config.pm 中设置此变量；您似乎还没有用户配置 (MyConfig.pm)。

我做了“y”然后我收到了这个奇怪的信息：

> mkdir /home/cyrine/.cpan/CPAN：权限在 /usr/share/perl/5.10/CPAN/Shell.pm >line 656 被拒绝

请问有什么想法吗？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-13T23:16:16.727

此问题的直接原因是您没有对`/home/cyrine/.cpan`. 以我的经验，这通常是作为普通用户登录的结果，然后`cpan`在会话中第一次在该帐户上运行`su`，导致创建 CPAN 配置`~cyrine`（因为你有 cyrine 的环境），但拥有root （因为`su`已经给了你 root 的权限）。假设是这种情况，您应该能够`su`以 root 身份解决此问题，运行命令`chown -R cyrine.cyrine /home/cyrine/.cpan`，然后`cpan`以用户 cyrine 身份运行。

# css - 引导菜单在 IE7 上重叠

> ID：15993109
> 
> 赞同：1
> 
> 时间：2013-04-13T21:24:10.230
> 
> 标签：css, internet-explorer, twitter-bootstrap, internet-explorer-7

我正在使用 Bootstrap 和 html5shiv.js 构建一个站点。

我有两个“导航栏”div，一个在屏幕上。在 Chrome、Firefox 和 IE9 中，它们看起来和工作正常。在 IE7 和 IE8（或者更确切地说，IE8 模式下的 IE9）上，顶部的下拉菜单出现在其下方导航栏的部分后面。![重叠的菜单](https://i.stack.imgur.com/8d6WM.png)在这张图片中，顶部的“概述”有一个包含三个项目（“Person”、“RSS”、“Wiki”）的下拉菜单，其下方的导航栏有一个项目“2013-01 rev”，这是一个下拉菜单，它是通过 Overview 下拉面板显示，第二个活动项目“Step 1 - People”显示在下拉面板的前面。

我检查了 IE9 开发人员工具，它在下拉面板上显示了 z-index（“RSS”和“Wiki”的部分是 1000，并且它下面的那个没有 z-index。我有尝试将 z-index 放在它下面的那个上，但它没有帮助。

由于 jsfiddle 似乎不适用于 IE7，因此我在[http://xen1.xcski.com/tmp/ie7_problem.html](http://xen1.xcski.com/tmp/ie7_problem.html)上制作了一小部分页面来演示该问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T03:42:36.700

尝试在顶部导航中添加一个正的 z-index 值（即带有概览、购物车、访问评论等的那个）。

```
<div id="top-bar" class="navbar">
  <div class="navbar-inner">
    <div class="container">
      <ul class="nav" style="z-index:1;">...</ul>
    </div>
  </div>
  <div class="navbar-inner">
    <div class="container">
      <ul class="nav">...</ul>
    </div>
  </div>
</div> 
```

# php - 从父类访问受保护的方法

> ID：15993110
> 
> 赞同：0
> 
> 时间：2013-04-13T21:24:14.243
> 
> 标签：php, oop, class

我知道当我希望它仅可用于扩展当前类以及当前类的所有类时，我应该使方法“受保护”。

好的，grandChildClass::method2() 应该受到保护，因为孙子是从孩子扩展而来的。

但是如果从父类如 parentClass::method2() 访问应该是什么？

```
class parentClass
{
    public function method1() {$this->method2();}
}

class childClass extends parentClass
{
    protected function method2() {}
}

class grandChildClass extends childClass 
{
    public function method3() {$this->method2();}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T21:27:57.773

如果你尝试

```
$p = new parentClass;
$p->method1(); 
```

对于未定义的方法，您会收到致命错误。

> 致命错误：在线调用...中未定义的方法`parentClass::method2()`...

但是，这将正常工作：

```
$c = new childClass;
$c->method1();

$g = new grandChildClass;
$g->method1();
$g->method3(); 
```

所有这些都将`method2`按照`childClass`.

# php - PHP gmp_perfect_square 不起作用

> ID：15993119
> 
> 赞同：0
> 
> 时间：2013-04-13T21:26:00.620
> 
> 标签：php

我需要检查一个数字是否是一个完美的正方形，我`gmp_perfect_square`在手册中找到了这个函数，但它给了我这个错误： `PHP Fatal error: Call to undefined function gmp_perfect_square()`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-13T21:29:25.483

您的服务器是否启用/安装了 GMP 扩展？因为我相信你不会。

phpinfo() 对此有什么看法？( [http://www.php.net/manual/en/gmp.installation.php](http://www.php.net/manual/en/gmp.installation.php) )

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T21:32:03.273

您安装的 PHP 版本中不存在该功能。您可以安装添加此功能的扩展程序，也可以实现自己的完美平方功能。

# wcf - 具有证书身份验证的 WCF 自托管服务

> ID：15993122
> 
> 赞同：1
> 
> 时间：2013-04-13T21:26:23.920
> 
> 标签：wcf, rest, authentication, certificate

我创建了一个具有基本 http 身份验证的自托管 WCF RESTful 服务，该服务通过带有自签名 SSL 证书的 https 运行。一切正常。当用户通过网络浏览器访问服务操作时，他们会弹出一个询问凭据（登录名/密码）的窗口。

现在我想做证书认证而不是基本认证，但它不起作用。客户端的浏览器（IE/chrome/firefox）从不提示选择证书，我总是收到 HTTP 403 错误，并且当我在自定义证书验证器中设置断点时，它永远不会命中。所以我肯定在这里遗漏了一些东西。我尝试使用 Fiddler 进行调试，它确认请求中没有身份验证标头。

这是我托管服务的代码。

```
Uri baseAdress = new Uri("https://localhost:8446/"); 
WebServiceHost host = new WebServiceHost(typeof(RestService));
WebHttpBinding wb = new WebHttpBinding();
wb.Security.Mode = WebHttpSecurityMode.Transport;
wb.Security.Transport.ClientCredentialType = HttpClientCredentialType.Certificate;
host.AddServiceEndpoint(typeof(IRestService), wb, baseAdress);
host.Credentials.ClientCertificate.Authentication.CertificateValidationMode = 
X509CertificateValidationMode.Custom;
host.Credentials.ClientCertificate.Authentication.CustomCertificateValidator = 
new MyX509CertificateValidator()
host.Open(); 
```

感谢您的任何提示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T16:33:30.273

我发现这篇文章可能会对您有所帮助：http: [//blogs.msdn.com/b/james_osbornes_blog/archive/2010/12/10/selfhosting-a-wcf-service-over-https.aspx](http://blogs.msdn.com/b/james_osbornes_blog/archive/2010/12/10/selfhosting-a-wcf-service-over-https.aspx)

它谈到了某种将证书注册到 netsh，..

另外，请确保您的证书颁发给本地主机（因为您调用的 url 中的域部分应该与证书相同。颁发给）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T12:23:47.560

感谢您的输入。我发现出了什么问题。

当我使用 makecert 工具为 ssl 端口绑定创建自签名证书时，我添加了“-eku”密钥，该密钥使证书用于服务器身份验证。我在没有该选项的情况下重新创建了另一个，因此它可以用于所有目的。

我还确保我的证书在当前用户的个人存储中。之后，当客户输入我的服务的 url 时，他们会弹出一个窗口，要求他们选择一个证书，这是我创建的一个。

对于那些面临同样问题的人，这篇[文章](https://stackoverflow.com/questions/8309195/mvc-web-app-https-calling-a-wcf-service-https-that-also-requires-a-ssl-certi)可能很有用。

# actionscript-3 - 如何确定某些东西是用 Flash 制作的？

> ID：15993124
> 
> 赞同：0
> 
> 时间：2013-04-13T21:26:36.487
> 
> 标签：actionscript-3, flash-builder, flash-cs5, flash

如果您右键单击网站中的电影游戏并看到一个底部有“About Adob​​e Flash Player...”的框，这是否一定意味着内容是使用 Flash 制作的（Flash Pro、Flash Builder、FDT ，Flash开发）？

这是否意味着创作者肯定使用了 AS3，或者您是否可以在 Flash 播放器中运行 html5 或联合项目？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T21:42:50.577

是的，这意味着内容是用 Flash 制作的。如果您查看网站的源代码，flash 制作的内容具有 .swf 扩展名。

但是创作者可能没有使用过 AS3，如果较旧的话，可能是使用 AS2 制作的。

# javascript - 切换内容点击可编辑

> ID：15993128
> 
> 赞同：6
> 
> 时间：2013-04-13T21:27:02.117
> 
> 标签：javascript, html, contenteditable

我试图在单击时创建一个 div contentEditable，然后在鼠标移出时将 contentEditable 设置为 false，但到目前为止我还没有成功。单击链接似乎会突出显示它，但除此之外什么都不做：

[http://jsfiddle.net/GeVpe/19/](http://jsfiddle.net/GeVpe/19/)

```
<div id="content" contentEditable="true" onclick = "this.contentEditable = true;" onmouseout = "this.contentEditable = false;">
    Surprisingly, <a href="http://google.com">clicking this link does nothing at all.</a> How can I fix this problem?
</div> 
```

我希望链接在单击时将我带到链接的页面，但相反，它在单击时突出显示并且没有做任何其他事情。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-13T22:00:40.987

永远不要使用内联 html 脚本声明，这是一种不好的做法。我认为你的链接没有做任何事情的原因是，当你为你的 div 设置它时，事件监听器在它上面冒泡/传播并改变了它的默认 onclick 事件。

我建议你做这样的事情。

```
 window.onload = function() {
            var div = document.getElementById('editable');
            div.onclick = function(e) {
                this.contentEditable = true;
                this.focus();
                this.style.backgroundColor = '#E0E0E0';
                this.style.border = '1px dotted black';
            }

            div.onmouseout = function() {
                this.style.backgroundColor = '#ffffff';
                this.style.border = '';
                this.contentEditable = false;
            }
        }

        // And for HTML

        <div id="content">
            <span id='editable'>Surprisingly,</span>
            <a href="http://google.com">clicking this link does nothing at all.</a>
        </div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-12-16T07:16:10.830

在这里，我们可以使用此代码使 html 元素可编辑真假。

```
 $( "#mylabel" ).click(function() {
// we get current value of html element
        var value = $('#editablediv').attr('contenteditable');
//if its false then it make editable true
    if (value == 'false') {
        $('#editablediv').attr('contenteditable','true');
    }
    else {
//if its true then it make editable false
        $('#editablediv').attr('contenteditable','false');
    }
    }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-14T00:25:25.707

尝试将目标设置为`blank`：

```
<div id="content" contentEditable="true" onclick = "this.contentEditable = true;" onmouseout = "this.contentEditable = false;">
    Surprisingly, <a href="http://google.com" target = "blank">clicking this link does nothing at all.</a> How can I fix this problem?
</div> 
```

# camera - 如何在实时取景中检测相机方向以正确绘制完成图像？

> ID：15993130
> 
> 赞同：2
> 
> 时间：2013-04-13T21:27:14.977
> 
> 标签：camera, orientation, autofocus, edsdk

我怎样才能：

1.  在实时取景模式下检测相机方向？
2.  将自动对焦设置为拍摄的图像？
3.  检测情况，何时设置自动对焦失败

我正在使用 EDSDK 2.10 和佳能 EOS 500D 相机。

# asp.net-web-api - ASP.NET Web API：客户端设计实践

> ID：15993133
> 
> 赞同：4
> 
> 时间：2013-04-13T21:27:20.863
> 
> 标签：asp.net-web-api, client

对于遵循相当新`ASP.NET Web API`的 .

我最近一直在设计一个用于 Web 和移动客户端的大型 API。我注意到在通过 Microsoft 提供的 ASP.NET Web API 模板中`NuGet`Web API 包提供的 ASP.NET Web API 模板中，他们对视图采用了非常简单的方法，并带有一个稍微漂亮的主页。

这在某种程度上把我带回来了。主要是因为我会假设 Web API 正是为此而设计的，即 Web API，仅此而已。

在其他人看来，开发 Web 客户端（与您的 API 接口）是标准的吗

*   在 Web API 项目内部？

    **或者**

*   在 Web API 项目之外将 Web 客户端分开，就像您的移动或桌面客户端一样？

在可维护性和代码清洁度方面，第二个选择对我来说似乎是合乎逻辑的，但在使用 ASP.NET Web API 进行设计时，可能还有其他方面可能会有所帮助。你怎么看？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T01:19:42.627

很高兴看到您使用 Web API！

关于您的第一个问题，您说得对，将 Web API 与视图分开在概念上是有意义的。我建议在 MVC 新项目对话框中使用“空”项目类型，然后添加 API 控制器。或者自己将 NuGet 包添加到一个空的 Web 项目中。这些包不应该向您的项目添加任何视图。

关于客户端，我强烈建议将客户端库分离到单独的项目中以实现可维护性。不过，您可以在客户端和 Web API 之间共享通用数据类型。在这种情况下，将模型移动到单独的 dll 并让客户端和 Web API 引用该库中的类型是一种常见的模式。

您希望客户端和 Web API 分开的几个原因（还有更多）：

*   如果您分发库，您希望分发客户端代码而不是 Web API 代码
*   您希望在客户端和服务器之间创建一个干净的合同，并避免让客户端依赖于服务器实现，反之亦然。

# jquery - 如何使用 jquery 显示基于无线电选择的 2 个或更多 div？

> ID：15993134
> 
> 赞同：0
> 
> 时间：2013-04-13T21:27:21.577
> 
> 标签：jquery, jquery-selectors, radio-button, show-hide

## **问题已解决，但如果您有更有效的解决方案，那么欢迎您。**

我知道以前有人问过这样的问题，但我无法让它发挥作用。

我正在尝试根据无线电选择显示一些 div。HTML 是由自动生成的，`wptheming option-framework`所以我无法更改它。我可以更改的是我尝试编写的 jQuery 函数，但没有运气。

[这是我编写的代码][1] 来测试我的想法，但它不起作用。

我再说一遍，我可以更改 jQuery 部分，但不能更改 HTML。我究竟做错了什么？

对于不想去 jsfiddle 的人，这里是代码：

[这是代码更正者：](http://jsfiddle.net/downloadtaky/4aCtP/8/) **@Zakary Kniebel**

**[或基于](http://jsfiddle.net/rmw32/3/)@Zakary Kniebel 编写的“FOR”的“ciclic”版本**

实际上代码会这样做：

如果选择 1，则仅显示 1 个部分，如果选择 2，则仅显示 2 个部分，依此类推。

副作用，不需要但很好，第一次选择后，无论您选择哪个数字，其他任何数字`<section>`都会消失，让您专注于单选按钮，如果您不需要此效果，只需在此`//`之前放置：

```
$(".section").not("#section-how_many_custom_posts").hide(); 
```

或者写下不会消失的部分的选择器。

> HTML

```
<div id="section-how_many_custom_posts" class="section section-radio hidden" style="display: block;">

<h4 class="heading">Choose how many Custom Posts you would like to generate</h4>

    <div class="option">
        <div class="controls">
            <input class="of-input of-radio" type="radio" name="mdframework[how_many_custom_posts]" id="mdframework-how_many_custom_posts-0" value="0" checked="checked">
            <label for="mdframework-how_many_custom_posts-0">0</label>
            <input class="of-input of-radio" type="radio" name="mdframework[how_many_custom_posts]" id="mdframework-how_many_custom_posts-1" value="1">
            <label for="mdframework-how_many_custom_posts-1">1</label>
            <input class="of-input of-radio" type="radio" name="mdframework[how_many_custom_posts]" id="mdframework-how_many_custom_posts-2" value="2">
            <label for="mdframework-how_many_custom_posts-2">2</label>
            <input class="of-input of-radio" type="radio" name="mdframework[how_many_custom_posts]" id="mdframework-how_many_custom_posts-3" value="3">
            <label for="mdframework-how_many_custom_posts-3">3</label>
            <input class="of-input of-radio" type="radio" name="mdframework[how_many_custom_posts]" id="mdframework-how_many_custom_posts-4" value="4">
            <label for="mdframework-how_many_custom_posts-4">4</label>
            <input class="of-input of-radio" type="radio" name="mdframework[how_many_custom_posts]" id="mdframework-how_many_custom_posts-5" value="5">
            <label for="mdframework-how_many_custom_posts-5">5</label>
        </div>
        <div class="explain">It depends on you, how many custom posts would you like?</div>
    </div>
</div>
<div id="section-custom_posts_n1" class="section section-radio hidden">

<h4 class="heading">Test first custom Post show/hide</h4>

    <div class="option">
        <div class="controls">
            <input class="of-input of-radio" type="radio" name="mdframework[custom_posts_n1]" id="mdframework-custom_posts_n1-0" value="0">
            <label for="mdframework-custom_posts_n1-0">0</label>
            <input class="of-input of-radio" type="radio" name="mdframework[custom_posts_n1]" id="mdframework-custom_posts_n1-1" value="1" checked="checked">
            <label for="mdframework-custom_posts_n1-1">1</label>
            <input class="of-input of-radio" type="radio" name="mdframework[custom_posts_n1]" id="mdframework-custom_posts_n1-2" value="2">
            <label for="mdframework-custom_posts_n1-2">2</label>
            <input class="of-input of-radio" type="radio" name="mdframework[custom_posts_n1]" id="mdframework-custom_posts_n1-3" value="3">
            <label for="mdframework-custom_posts_n1-3">3</label>
            <input class="of-input of-radio" type="radio" name="mdframework[custom_posts_n1]" id="mdframework-custom_posts_n1-4" value="4">
            <label for="mdframework-custom_posts_n1-4">4</label>
            <input class="of-input of-radio" type="radio" name="mdframework[custom_posts_n1]" id="mdframework-custom_posts_n1-5" value="5">
            <label for="mdframework-custom_posts_n1-5">5</label>
        </div>
        <div class="explain">Test first custom Post show/hide</div>
    </div>
</div>
<div id="section-custom_posts_n2" class="section section-radio hidden">

<h4 class="heading">Test second custom Post show/hide</h4>

    <div class="option">
        <div class="controls">
            <input class="of-input of-radio" type="radio" name="mdframework[custom_posts_n2]" id="mdframework-custom_posts_n2-0" value="0">
            <label for="mdframework-custom_posts_n2-0">0</label>
            <input class="of-input of-radio" type="radio" name="mdframework[custom_posts_n2]" id="mdframework-custom_posts_n2-1" value="1" checked="checked">
            <label for="mdframework-custom_posts_n2-1">1</label>
            <input class="of-input of-radio" type="radio" name="mdframework[custom_posts_n2]" id="mdframework-custom_posts_n2-2" value="2">
            <label for="mdframework-custom_posts_n2-2">2</label>
            <input class="of-input of-radio" type="radio" name="mdframework[custom_posts_n2]" id="mdframework-custom_posts_n2-3" value="3">
            <label for="mdframework-custom_posts_n2-3">3</label>
            <input class="of-input of-radio" type="radio" name="mdframework[custom_posts_n2]" id="mdframework-custom_posts_n2-4" value="4">
            <label for="mdframework-custom_posts_n2-4">4</label>
            <input class="of-input of-radio" type="radio" name="mdframework[custom_posts_n2]" id="mdframework-custom_posts_n2-5" value="5">
            <label for="mdframework-custom_posts_n2-5">5</label>
        </div>
        <div class="explain">Test second custom Post show/hide</div>
    </div>
</div>
<div id="section-custom_posts_n3" class="section section-radio hidden">

<h4 class="heading">Test Third custom Post show/hide</h4>

    <div class="option">
        <div class="controls">
            <input class="of-input of-radio" type="radio" name="mdframework[custom_posts_n3]" id="mdframework-custom_posts_n3-0" value="0">
            <label for="mdframework-custom_posts_n3-0">0</label>
            <input class="of-input of-radio" type="radio" name="mdframework[custom_posts_n3]" id="mdframework-custom_posts_n3-1" value="1" checked="checked">
            <label for="mdframework-custom_posts_n3-1">1</label>
            <input class="of-input of-radio" type="radio" name="mdframework[custom_posts_n3]" id="mdframework-custom_posts_n3-2" value="2">
            <label for="mdframework-custom_posts_n3-2">2</label>
            <input class="of-input of-radio" type="radio" name="mdframework[custom_posts_n3]" id="mdframework-custom_posts_n3-3" value="3">
            <label for="mdframework-custom_posts_n3-3">3</label>
            <input class="of-input of-radio" type="radio" name="mdframework[custom_posts_n3]" id="mdframework-custom_posts_n3-4" value="4">
            <label for="mdframework-custom_posts_n3-4">4</label>
            <input class="of-input of-radio" type="radio" name="mdframework[custom_posts_n3]" id="mdframework-custom_posts_n3-5" value="5">
            <label for="mdframework-custom_posts_n3-5">5</label>
        </div>
        <div class="explain">Test Third custom Post show/hide</div>
    </div>
</div>
<div id="section-custom_posts_n4" class="section section-radio hidden">

<h4 class="heading">Test Fourth custom Post show/hide</h4>

    <div class="option">
        <div class="controls">
            <input class="of-input of-radio" type="radio" name="mdframework[custom_posts_n4]" id="mdframework-custom_posts_n4-0" value="0">
            <label for="mdframework-custom_posts_n4-0">0</label>
            <input class="of-input of-radio" type="radio" name="mdframework[custom_posts_n4]" id="mdframework-custom_posts_n4-1" value="1" checked="checked">
            <label for="mdframework-custom_posts_n4-1">1</label>
            <input class="of-input of-radio" type="radio" name="mdframework[custom_posts_n4]" id="mdframework-custom_posts_n4-2" value="2">
            <label for="mdframework-custom_posts_n4-2">2</label>
            <input class="of-input of-radio" type="radio" name="mdframework[custom_posts_n4]" id="mdframework-custom_posts_n4-3" value="3">
            <label for="mdframework-custom_posts_n4-3">3</label>
            <input class="of-input of-radio" type="radio" name="mdframework[custom_posts_n4]" id="mdframework-custom_posts_n4-4" value="4">
            <label for="mdframework-custom_posts_n4-4">4</label>
            <input class="of-input of-radio" type="radio" name="mdframework[custom_posts_n4]" id="mdframework-custom_posts_n4-5" value="5">
            <label for="mdframework-custom_posts_n4-5">5</label>
        </div>
        <div class="explain">Test Fourth custom Post show/hide</div>
    </div>
</div>
<div id="section-custom_posts_n5" class="section section-radio hidden">

<h4 class="heading">Test Fifth custom Post show/hide</h4>

    <div class="option">
        <div class="controls">
            <input class="of-input of-radio" type="radio" name="mdframework[custom_posts_n5]" id="mdframework-custom_posts_n5-0" value="0">
            <label for="mdframework-custom_posts_n5-0">0</label>
            <input class="of-input of-radio" type="radio" name="mdframework[custom_posts_n5]" id="mdframework-custom_posts_n5-1" value="1" checked="checked">
            <label for="mdframework-custom_posts_n5-1">1</label>
            <input class="of-input of-radio" type="radio" name="mdframework[custom_posts_n5]" id="mdframework-custom_posts_n5-2" value="2">
            <label for="mdframework-custom_posts_n5-2">2</label>
            <input class="of-input of-radio" type="radio" name="mdframework[custom_posts_n5]" id="mdframework-custom_posts_n5-3" value="3">
            <label for="mdframework-custom_posts_n5-3">3</label>
            <input class="of-input of-radio" type="radio" name="mdframework[custom_posts_n5]" id="mdframework-custom_posts_n5-4" value="4">
            <label for="mdframework-custom_posts_n5-4">4</label>
            <input class="of-input of-radio" type="radio" name="mdframework[custom_posts_n5]" id="mdframework-custom_posts_n5-5" value="5">
            <label for="mdframework-custom_posts_n5-5">5</label>
        </div>
        <div class="explain">Test Fifth custom Post show/hide</div>
    </div>
</div> 
```

> JS

```
jQuery(document).ready(function ($) {
$types = $('.of-radio');
$types.change(function () {
    $(".section").not("#section-how_many_custom_posts").hide();
    $this = $(this).val();
    if ($this == "1") {
        $('#section-custom_posts_n1').show();
    } else if ($this == "2") {
        $('#section-custom_posts_n1').show();
        $('#section-custom_posts_n2').show();
    } else if ($this == "3") {
        $('#section-custom_posts_n1').show();
        $('#section-custom_posts_n2').show();
        $('#section-custom_posts_n3').show();

    } else if ($this == "4") {
        $('#section-custom_posts_n1').show();
        $('#section-custom_posts_n2').show();
        $('#section-custom_posts_n3').show();
        $('#section-custom_posts_n4').show();

    } else if ($this == "5") {
        $('#section-custom_posts_n1').show();
        $('#section-custom_posts_n2').show();
        $('#section-custom_posts_n3').show();
        $('#section-custom_posts_n4').show();
        $('#section-custom_posts_n5').show();
    }
}); 
```

});

> CSS

```
.hidden {
    display:none
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T21:35:26.787

你需要改变：

`$types = $('#section-how_many_custom_posts');`

至

`$types = $('.of-radio');`

这是因为，您的 ID 是唯一的，并且您没有将该 ID 应用于您的单选按钮。您的所有单选按钮都有一个公共类`of-radio`，因此您要做的是选择具有该类的所有元素，并`div`根据单击该类的单选按钮显示所需的 s。

[更新小提琴](http://jsfiddle.net/4aCtP/1/)

**更新**

根据您代码中新发现的错误，我已经更新了您的修复方法：

[更新小提琴 2](http://jsfiddle.net/4aCtP/7/)

**更新 2**

这不是您最初的问题，但在您的一条评论中，您提到您想尝试将您的代码变成一个循环。这是工作小提琴：

[更新小提琴 3](http://jsfiddle.net/rmw32/3/)

# javascript - jQuery验证忽略规则

> ID：15993144
> 
> 赞同：0
> 
> 时间：2013-04-13T21:28:20.013
> 
> 标签：javascript, jquery, jquery-validate

这个问题困扰了我一段时间。这可能是一件容易的事情，但在这个时候我没有看到它。HTML & JavaScript 包括在下面。jQuery 1.8.3 在 jQuery validate 之前加载，并且没有 JS 错误。

问题实际上是即使提交一个空值，验证器也只是接受它作为一个接受的条目并提交表单（控制台中没有错误）。

HTML：

```
<form method="POST" id="reactieform">
<input type="hidden" name="reactie" value="1" />

<table style="float:left;">
    <tr>
        <td width="250">Voornaam</td>
        <td width="650"><input maxlength="150" type="text" name="voornaam" /></td>
        <td width="100"></td> 
    </tr>

    <tr>
        <td>&nbsp;</td>
        <td><input type="submit" value="Reactie opslaan" /></td>
    </tr>                   
</table>
</form> 
```

JavaScript：

```
$(document).ready(function() {          
    $('#reactieform').validate({            
        voornaam: {
            required: true,
            minlength: 10
        }
    });
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T21:31:21.487

尝试这个 -

```
 rules:{
         voornaam: {
            required: true,
            minlength: 10
         }
       } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T21:37:00.923

您的代码`rules`完全缺少该选项。您的规则声明必须放在*选项*内`rules`。

```
$(document).ready(function() {          
    $('#reactieform').validate({    
        rules: {
            voornaam: {
                 required: true,
                 minlength: 10
            }
        }
    });
}); 
```

**工作演示：http: [//jsfiddle.net/4kXuF/](http://jsfiddle.net/4kXuF/)**

# c++ - 来自 opencv 的 Imshow 不再工作

> ID：15993145
> 
> 赞同：2
> 
> 时间：2013-04-13T21:28:27.763
> 
> 标签：c++, opencv

我使用 imshow 函数编写了一些简单的程序。它工作得很好几次。我试图在处理之前和之后查看两张图片。第一次它运行良好，但第二次它使我的应用程序崩溃。

现在每次都显示崩溃应用程序。

如何解决？

```
#include <iostream>
#include <iostream>
#include <opencv2/imgproc/imgproc.hpp>
#include <opencv2/core/core.hpp>
#include <opencv2/highgui/highgui.hpp>

using namespace std;
using namespace cv;

int main()
{
    Mat image, gray_image;
    string file_path;

    cout << "Input file path: ";
    cin >> file_path;

    image = imread(file_path, CV_LOAD_IMAGE_UNCHANGED);
    if (image.data==NULL)
        {
            cout << "No image found!";
            return 1;
        }

    cvtColor(image, gray_image, CV_BGR2GRAY);

    namedWindow("Orig", CV_WINDOW_AUTOSIZE);
    namedWindow("Gray", CV_WINDOW_AUTOSIZE);

    imshow("Orig", image);
    imshow("Gray", gray_image);

    cout << "Output file path: ";
    cin >> file_path;

    imwrite(file_path, gray_image);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-14T01:14:57.383

你需要[waitKey](http://docs.opencv.org/modules/highgui/doc/user_interface.html#waitkey)

看看[OpenCV 中的 waitKey (30) 是什么意思？](https://stackoverflow.com/questions/12452118/what-does-waitkey-30-mean-in-opencv)

# java - Google+ 登录 Java PhotoHunt 示例不显示 Google+ 登录按钮

> ID：15993148
> 
> 赞同：1
> 
> 时间：2013-04-13T21:28:55.733
> 
> 标签：java, google-app-engine, angularjs, google-plus

我是 Google+ 登录的新手，正在尝试构建一个实现此功能的应用程序。

[所以我在https://developers.google.com/+/photohunt/java](https://developers.google.com/+/photohunt/java)上查找示例教程并尝试遵循它。但是，当我将此应用程序部署到 App Engine 或在我的 localhost:8888 上运行它时，Google+ 登录按钮不显示。我不能用这个应用程序做任何事情。

你们中有人遇到过这个问题吗？我附上了我在部署此应用程序时看到的屏幕截图。

![截屏](https://dl.dropboxusercontent.com/u/371737/Screen%20Shot%202013-04-13%20at%205.11.21%20PM.png)

“邀请您的朋友”按钮也不起作用。我注意到在 index.html 的内部标记中，它没有像其他 angularjs 应用程序那样具有“ng-app”属性。我也是 angularjs 的新手，所以我不知道这是否是问题所在。似乎没有调用 angularjs 方法之类的。

任何建议都会有所帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T14:23:21.463

[对于 Angular JS，安装Angular JS batarang](https://chrome.google.com/webstore/detail/angularjs-batarang/ighdmehidhipcmcojjgiloacoafjmpfk?hl=en)会很有帮助。就未呈现的登录按钮而言，这可能是由很多事情引起的。

您应该尝试的几件事：

*   您可以尝试断开应用与[https://plus.google.com/apps](https://plus.google.com/apps)的连接，然后重新登录
*   检查您在[Google API 控制台](https://code.google.com/apis/console)中的授权来源是否正确。请注意，http 与 https 有所不同。当您从在 AppEngine 上运行切换时，这可能特别容易错过，因为它很容易同时支持这两者。
*   在浏览器中打开 javascript 控制台，看看是否有任何错误，这可能会引导您找到解决方案。
*   [从Chrome 开发者工具](https://developers.google.com/chrome-developer-tools/)的网络部分观察网络流量，这也可能会导致更多关于失败的信息
*   通过查看您的页面源代码并检查源代码中的链接（尤其是 client|plus.js）来验证所有脚本是否正在加载。
*   验证 Google 客户端是否正常工作，您可以在控制台中输入以下命令：

    ```
    gapi.client.load('plus','v1'); 
    ```

如果这些解决方案都没有帮助或让您朝着正确的方向前进，您可能需要考虑重新下载示例，因为您的 PhotoHunt 文件夹可能发生了一些事情。

另外，你在哪个浏览器上尝试这个？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-05T05:55:32.463

从[文档](https://developers.google.com/+/photohunt/java#google_sign-in_button)：

> **未登录的**访问者会看到页面右上角的 Google+ 登录按钮。

您是否使用您的谷歌帐户登录？

这是HTML：

```
<span id="signin" ng-show="immediateFailed">
    <span id="myGsignin"></span>
</span> 
```

我也不知道`Angular.js`，但我猜`ng-show`手段显示元素 if `immediateFailed`。立即是指立即登录，如果您已经登录到您的谷歌帐户，这是谷歌所做的。如果您没有登录，并且它仍然没有显示，请查看该`controllers.js`文件并了解为什么 $scope.immediateFailed 会是`false`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-10T08:46:35.337

它可能不是确切的解决方案，但它适用于我的情况。

在下面的代码中，

```
<span id="signin" ng-show="immediateFailed">
    <span id="myGsignin"></span>
</span> 
```

当我删除`ng-show="immediateFailed"`部分时，它确实有效。我不知道为什么，但我认为 ng-show 标签无法识别，因此阻止了谷歌登录按钮的呈现。当它被移除时，按钮渲染成功。

# html - 滚动条，但没有内容

> ID：15993149
> 
> 赞同：4
> 
> 时间：2013-04-13T21:28:56.243
> 
> 标签：html, css

我的网站没有向上或向下的内容，但滚动条可见并允许您滚动。

不幸的是，我不知道是什么原因导致我假设它与这段 CSS 代码有关，但老实说我不知道​​。

```
html, body
{
    height:100%;
}
.centre
{
    position:absolute;
    left:50%;
    top:50%;
}
#wrapper {
    height:100%;
    position:relative;
    left:0px;
    top:0px;
    min-height:600px;
    min-width:600px;
} 
```

网站上的所有内容都基于中心课程。并`<div id="wrapper"></div>`围绕所有内容。

我知道我不是很有帮助，但据我了解，如果在可视区域之外有内容并且没有内容，则应该只有滚动条。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-13T21:30:43.647

要么删除`height: 100%`from `<html/>`，`<body/>`要么`#wrapper`添加

```
html, body { margin: 0; } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-13T21:31:15.363

尝试将此 CSS 添加到您的样式表中：

```
body {margin:0;} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-13T21:31:33.740

只需将`body`边距设置为零：

```
body {
  margin: 0;
} 
```

通常浏览器会为 body 设置一个默认值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-13T21:51:07.573

只需在您的 CSS**上进行重置即可。**换句话说，这应该是第一行：

```
* { margin: 0; padding: 0; outline: 0; } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-08-11T07:49:01.067

首先，您必须重置`default styles`.To`document(browser default styles)`为此，请将以下代码添加到`css`文件顶部。

```
html, body, div, span, applet, object, iframe,
h1, h2, h3, h4, h5, h6, p, blockquote, pre,
a, abbr, acronym, address, big, cite, code,
del, dfn, em, img, ins, kbd, q, s, samp,
small, strike, strong, sub, sup, tt, var,
b, u, i, center,
dl, dt, dd, ol, ul, li,
fieldset, form, label, legend,
table, caption, tbody, tfoot, thead, tr, th, td,
article, aside, canvas, details, embed, 
figure, figcaption, footer, header, hgroup, 
menu, nav, output, ruby, section, summary,
time, mark, audio, video {
    margin: 0;
    padding: 0;
    border: 0;
    font-size: 100%;
    font: inherit;
    vertical-align: baseline;
}
/* HTML5 display-role reset for older browsers */
article, aside, details, figcaption, figure, 
footer, header, hgroup, menu, nav, section {
    display: block;
}
body {
    line-height: 1;
}
ol, ul {
    list-style: none;
}
blockquote, q {
    quotes: none;
}
blockquote:before, blockquote:after,
q:before, q:after {
    content: '';
    content: none;
}
table {
    border-collapse: collapse;
    border-spacing: 0;
} 
```

信用[链接](http://meyerweb.com/eric/tools/css/reset/)

# ravendb - RavenDB：如何强制 RavenDB 安全释放 RAM？

> ID：15993151
> 
> 赞同：1
> 
> 时间：2013-04-13T21:28:57.573
> 
> 标签：ravendb

与[这个问题有关](https://stackoverflow.com/questions/15992053/ravendb-how-can-i-prevent-high-ram-utilization)...

如果您没有正确配置 RavenDB，它很容易耗尽服务器的 RAM。

*   [链接 1](https://groups.google.com/d/msg/ravendb/Ce9oNFD33hI/E6MNHAF_pP4J)
*   [链接 2](http://ayende.com/blog/160386/ravendb-2-0-stopship-bug-memory-is-nice-let-us-eat-it-all)
*   [链接 3](https://groups.google.com/forum/m/?fromgroups#!topic/ravendb/6wVIvApjXMs)

如果您发现自己处于这种困境中，您如何强制 RavenDB**安全地**释放此 RAM？

我认为回收服务可以解决问题。不幸的是，这破坏了我的整个 RavenDB 安装（幸运的是在测试环境中）。在 Silverlight GUI 中，RavenDB 甚至无法检索已安装数据库的列表；所以我看不到我的文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T00:50:20.410

*不要*在服务器管理器中回收服务。

相反，在 RavenDB\Server 目录的命令提示符下发出以下命令：

```
Raven.Server.exe /restart 
```

耐心点。重新启动服务可能需要几分钟时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-14T05:40:39.840

Jim，您可以要求 RavenDB 使用以下命令释放内存：

```
 POST /admin/gc 
```

# excel - Applescript/Excel 我想丢失十进制答案

> ID：15993152
> 
> 赞同：1
> 
> 时间：2013-04-13T21:29:01.800
> 
> 标签：excel, formatting, applescript

我正在编写一个applescript来处理XML的电子表格，它几乎完成了，但我发现每当它从单元格中检索值并且该值是一个数字时，它都会使用小数对其进行格式化。

4 变成 4.0

我怎样才能强迫它只得到整数？数字并不是它所能获得的唯一价值。

以下是相关代码：

```
-- Copy field from SS
    tell application "Microsoft Excel"
        activate
        goto reference cellNum
        set GotValue to value of active cell as string
        delay 0.3
        --tell application "System Events" to keystroke "c" using command down
        delay 2
    end tell 
```

而且我知道我可以通过一个函数来处理它，该函数仅在小数点前分隔并保留第一部分，但就像我说的，除了数字之外，还有更多的东西可以通过它，段落也可以。所以那不会是好事。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T23:13:11.313

对于任何在看的人来说，这是通过创建一个函数来检查输入是否为实数，如果是，将其转换为整数然后转换为字符串来解决。像这样：

```
on isReal(x)
    return ({class of x} is in {real})
end isReal

if isReal(GotValue) then
        set GotValue to GotValue as integer
    end if
    set GotValue to GotValue as string 
```

# java - java：使用客户端证书加载 HTTPS url

> ID：15993160
> 
> 赞同：0
> 
> 时间：2013-04-13T21:30:10.370
> 
> 标签：java, https, ssl-certificate

我安装了 pkcs12 证书，可以在浏览器上加载 url “httpsURL”。

但是我的独立 java 程序不能做同样的事情。

```
System.setProperty("javax.net.ssl.keyStore", "d:/keys2222/prince.p12");
System.setProperty("javax.net.ssl.keyStorePassword", "password");
URL url = new URL("httpsURL"); // URL is perfect
URLConnection con = url.openConnection(); // fails here 
```

请帮我

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T21:55:00.953

由于您使用的是自签名证书，JVM 不信任它，因此`https`URL 不起作用。您需要将其添加到 JVM 的密钥库中，`keytool` 请参阅[本文](http://www.webfarmr.eu/2010/04/import-pkcs12-private-keys-into-jks-keystores-using-java-keytool/)。

**编辑：**对不起，我忘了提到您需要指定 JVM 默认密钥库`cacerts`。本文[将向](https://forums.oracle.com/forums/thread.jspa?threadID=1533825)您展示它是如何完成的。

另请注意，您的证书必须与您的 URL**完全**匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T10:08:47.390

您获得的原因`java.security.cert.CertificateException: No name matching localhost found`是`CN`证书的名称与您访问服务器的 URL 的主机名不匹配。因此，您要么需要创建一个正确的证书`CN`，要么您可以编写自己的证书`HostNameVerifier`来忽略该问题。但是，如果您这样做，请确保在完成测试后删除该代码。[本文档](http://docs.oracle.com/cd/E19355-01/820-1072/ahicy/index.html)指定了如何执行此操作：

```
javax.net.ssl.HttpsURLConnection.setDefaultHostnameVerifier(
    new javax.net.ssl.HostnameVerifier(){

        public boolean verify(String hostname, javax.net.ssl.SSLSession sslSession) {
            if (hostname.equals("theHostname")) {
                return true;
            }
            return false;
        }
    };
); 
```

# eigen - 如何使用特征沿对角矩阵设置值？

> ID：15993162
> 
> 赞同：3
> 
> 时间：2013-04-13T21:30:19.017
> 
> 标签：eigen

我正在尝试使用特征构造一个对角矩阵，然后沿对角线设置值：

```
 Eigen::DiagonalMatrix<int, Eigen::Dynamic> diagonal_matrix(5);
        for (int i = 0; i < 5; ++i) {
            diagonal_matrix(i, i) = i * i + 2;
        } 
```

但是，这不起作用，因为`diagonal_matrix`缺少`()`操作员。使用特征设置对角矩阵的对角值的正确方法是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-14T19:52:13.727

该运算符不可用，因为我们必须禁止使用 (i,j) 和 i!=j 调用它，因此这样的函数没有什么意义。您必须使用更详细的方法，包括采用对角线：

```
diag_mat.diagonal()[i] = ...; 
```

在这里， .diagonal() 成员将对角线的表达式返回为一维向量。您还可以使用高级例程设置它，例如线性间隔值的随机值。要重现您的示例：

```
diag_mat.diagonal() = ArrayXi::LinSpaced(5,0,4).square() + 2; 
```

# php - 为什么PHP的爆炸错误？

> ID：15993165
> 
> 赞同：1
> 
> 时间：2013-04-13T21:31:00.670
> 
> 标签：php

这是PHP代码：

```
var_dump($value); 
```

```
string(103) "0e0cU\0Z‚dddd.is.moar.awesome‚A6A32C2074B787893DF506F6F466F5919516C44F3" 
```

```
var_dump(explode(',', $value)); 
```

```
数组（1）{
  [0]=>
  string(103) "0e0cU\0Z‚dddd.is.moar.awesome‚A6A32C2074B787893DF506F6F466F5919516C44F3"
}
```

为什么字符串不以逗号分隔？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-13T21:37:02.077

因为您要尝试的字符串中的字符`explode()`不是逗号 - 好吧，不是[ASCII 逗号：`,`(decimal code point `44`)](http://www.fileformat.info/info/unicode/char/2C/index.htm)。字符串中的逗号是[Unicode 字符“SINGLE LOW-9 QUOTATION MARK”（十进制代码点`8218`）。](http://www.fileformat.info/info/unicode/char/201A/index.htm)

在你的 JavaScript 控制台中试试这个：

```
> '‚' === ','
  false 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T23:42:50.900

经过大量调查，真正的问题是输入字符串采用 Windows-1252 编码。因此，尝试替换 U+201A 直到我先将其转换为 unicode 才起作用。

# google-analytics - Ember.js 和谷歌分析

> ID：15993168
> 
> 赞同：11
> 
> 时间：2013-04-13T21:31:30.460
> 
> 标签：google-analytics, ember.js

既然我们有一个稳定的 Ember RC，我想在这里得到一个明确的答案供以后参考。前 2 个[搜索结果](https://www.google.com/#hl=en&output=search&sclient=psy-ab&q=emberjs+google+analytics&oq=emberjs+google+analytics&gs_l=hp.3..0i10.727.727.0.1376.1.1.0.0.0.0.70.70.1.1.0...0.0...1c.2.9.psy-ab.eU_0ckbSIWY&pbx=1&bav=on.2,or.r_cp.r_qf.&bvm=bv.45175338,d.cGE&fp=720839aef4a154b5&biw=1274&bih=650)的组合`emberjs google analytics`表明这是跟踪路线变化的好方法：

```
App.ApplicationController = Ember.Controller.extend
  routeChanged: ( ->
    return unless window._gaq
    Em.run.next ->
      page = if window.location.hash.length > 0 then window.location.hash.substring(1) else window.location.pathname
      _gaq.push(['_trackPage', page])
  ).observes('currentPath') 
```

但随后我也看到了将[事件跟踪](https://developers.google.com/analytics/devguides/collection/gajs/eventTrackerGuide)用于单页 Web 应用程序的结果。

~~我还没有测试上面的代码，需要几个小时才能将更改传播到 GA 仪表板。~~ **更新**：这不会显示在我的 Google Analytics 仪表板上的内容类别下。不在“页面”或“事件”下。

如果有人有建议，或者如果我在某处遗漏了什么，请告诉我。我还可以根据此处的答案公关该网站的指南。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-01-08T11:18:54.090

Alex DiLiberto 在他的 EmberConf 2014 演讲中就将 Google Analytics 添加到 ember 应用程序的稳健且可扩展的方式进行了非常精彩的[演讲](http://confreaks.com/videos/3456-emberconf2014-extending-ember-with-analytics)。-[幻灯片](http://alexdiliberto.com/talks/extending-ember-with-analytics/) - [GitHub](https://github.com/alexdiliberto/emberconf-2014-demo)

```
App.ApplicationRoute = Ember.Route.extend({
   actions: {
     didTransition: function() {
       Ember.run.once(this, function() {
         ga('send', 'pageview', this.router.get('url'));
       });
     }
   }
}); 
```

该演讲旨在独立于使用的分析库。

[现在还有一本关于在此处](http://emberjs.com/guides/cookbook/helpers_and_components/adding_google_analytics_tracking/)实施 Google Analytics 的官方 Ember Cookbook 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T21:58:08.670

对于具有可路由 URL 的事物，我会使用 _trackPageview，而对于没有可路由 URL 的事物，我会使用 _trackEvent。

在[事件跟踪](https://developers.google.com/analytics/devguides/collection/gajs/eventTrackerGuide)链接中，当他们引用“嵌入式 AJAX 页面元素”时。它们不是指 SPA，而是指 URL 保持不变的情况，但您希望跟踪的某些事件发生在页面内（在通过 AJAX 的情况下）。

可能在其他情况下使用 _trackEvent 是有意义的，但对于路由转换，我会使用 _trackPageview。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-19T13:44:46.757

使用 routeChanged() 不是跟踪动态段（例如 /category/food /category/something）的好方法，因为它只会被触发一次。我在这里写了一篇关于此的文章：[http](http://www.randomshouting.com/2013/05/04/Ember-and-Google-Analytics.html) ://www.randomshouting.com/2013/05/04/Ember-and-Google-Analytics.html 。我还咨询了 Ember 背后的人，并确认这确实是跟踪 Google Analytics 的 url 更改的正确方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-04-18T22:37:00.523

这些答案中的大多数已经过时了。您应该使用 mixin 并将其添加到您的路由器以侦听`didTransition`事件并在那里触发您的综合浏览量。这样它就适用于所有路线。那里有几个插件，包括我写的一个叫做[ember tracker](https://tsteuwer.github.com/ember-tracker)的插件，它为您提供`pageviews`开箱即用的事件跟踪。

[你可以在这里](https://github.com/tsteuwer/ember-tracker/blob/master/addon/mixins/google-analytics-route.js)看到我是如何做到的。这是相当直接的。

# wordpress - Wordpress 评论表单简单

> ID：15993171
> 
> 赞同：-1
> 
> 时间：2013-04-13T21:31:55.070
> 
> 标签：wordpress, forms, comments

我正在从头开始使用 wordpress，问题是我只是不知道如何添加评论表单。它可以是具有某种风格的基本评论表单（电子邮件+用户名+发表您的评论）。

每次我尝试运行插件时它都不起作用。不知道为什么插件在 single.php 中不起作用。我的代码有问题吗？

感谢您，感谢您的时间和帮助我。如您所见，我仍然是初学者；）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T01:42:02.600

您还可以查看您的设置，看看您是否允许评论？在 wp-admin 仪表板中单击 Settings-> Discussion 并查看您的评论设置。

# c++ - Boost C++ UDP 示例无法通过 Internet 传输

> ID：15993180
> 
> 赞同：0
> 
> 时间：2013-04-13T21:33:32.497
> 
> 标签：c++, sockets, boost, udp, boost-asio

您好，我正在尝试使用 Boost C++ UDP 客户端-服务器。

我采用了 ASIO 附带的示例之一并对其进行了一些修改。

它在本地网络上运行良好，但是当我将服务器托管到我们的一台服务器并正确转发端口时，它不起作用。

我运行 UDP 服务器并尝试通过 Internet 从家里与客户端进行传输，但没有任何数据包到达服务器。我确信端口被正确转发并且防火墙没有妨碍。

就UDP通信而言，本地网络和互联网之间有什么区别吗？

以下是客户端和服务器的代码：

- - 客户 - -

```
#include <cstdlib>
#include <cstring>
#include <iostream>
#include <boost/asio.hpp>

using boost::asio::ip::udp;
enum { max_length = 1024 };

int main(int argc, char* argv[])
{
char request[max_length];
try
{

    boost::asio::io_service io_service;

    udp::socket s(io_service, udp::endpoint(udp::v4(), 0));

    udp::resolver resolver(io_service);
    udp::resolver::query query(udp::v4(), "MyPublicIp", "3002");
    udp::resolver::iterator iterator = resolver.resolve(query);

    using namespace std; // For strlen.
    std::cout << "Write to me: ";
    while(1)
    {
        std::cin.getline(request, max_length);
        size_t request_length = strlen(request);
        s.send_to(boost::asio::buffer(request, request_length), *iterator);

        char reply[max_length];
        udp::endpoint sender_endpoint;
        size_t reply_length = s.receive_from(boost::asio::buffer(reply, max_length), sender_endpoint);
        std::cout << Say:";
        std::cout.write(reply, reply_length);
        std::cout << "\n";
        std::cout << Say What?" ;
    }
  }
  catch (std::exception& e)
  {
    std::cerr << "Exception: " << e.what() << "\n";
  }
  std::cin.getline(request, max_length);
  return 0;
} 
```

- - - 服务器 - - - - - -

```
#include <boost/chrono.hpp>
#include <cstdlib>
#include <iostream>
#include <boost/bind.hpp>
#include <boost/asio.hpp>
#include <boost\thread\thread.hpp>
#include <ctime>
using boost::asio::ip::udp;

class server
{
public:
  server(boost::asio::io_service& io_service, short port)
    : io_service_(io_service),
      socket_(io_service, udp::endpoint( boost::asio::ip::address_v4::any(), port))
  {
      std::fill(data_, data_ + max_length, 0);
    socket_.async_receive_from(
        boost::asio::buffer(data_, max_length), sender_endpoint_,
        boost::bind(&server::handle_receive_from, this,
          boost::asio::placeholders::error,
          boost::asio::placeholders::bytes_transferred));
  }

  void handle_receive_from(const boost::system::error_code& error,
      size_t bytes_recvd)
  {
    if (!error && bytes_recvd > 0)
    {
        td::cout  << "Connection from: " << sender_endpoint_.address().to_string() << " " << sender_endpoint_.port() << std::endl;

      socket_.async_send_to(
          boost::asio::buffer(data_, strlen(data_)), sender_endpoint_,
          boost::bind(&server::handle_send_to, this,
            boost::asio::placeholders::error,
            boost::asio::placeholders::bytes_transferred));
    }
    else
    {
      socket_.async_receive_from(
          boost::asio::buffer(data_, max_length), sender_endpoint_,
          boost::bind(&server::handle_receive_from, this,
            boost::asio::placeholders::error,
            boost::asio::placeholders::bytes_transferred));
    }
  }

  void handle_send_to(const boost::system::error_code& /*error*/,
      size_t /*bytes_sent*/)
  {  

      std::fill(data_, data_ + max_length, 0);
    socket_.async_receive_from(
        boost::asio::buffer(data_, max_length), sender_endpoint_,
        boost::bind(&server::handle_receive_from, this,
          boost::asio::placeholders::error,
          boost::asio::placeholders::bytes_transferred));

  }

private:
  boost::asio::io_service& io_service_;
  udp::socket socket_;
  udp::endpoint sender_endpoint_;
  enum { max_length = 300 };
  char data_[max_length];
};

int main(int argc, char* argv[])
{
  try
  {
    std::cout << "Starting server" << std::endl;

    boost::asio::io_service io_service;
    short port = 3002;
    using namespace std; 
    server s(io_service, port);
    std::cout << "Server started. Listening on port:" <<port << std::endl;
    io_service.run();
  }
  catch (std::exception& e)
  {
    std::cerr << "Exception: " << e.what() << "\n";
  }
  return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-14T17:26:38.860

从传输层的角度来看，本地网络和互联网之间的 UDP 没有区别。但是，有多种因素可以发挥作用：

*   UDP 缺乏可靠性。执行单次写入并同步阻塞等待响应将在 LAN 上产生良好的结果，并且大部分时间噪声最小。但是，可能值得修改客户端以在通过 Internet 时预期数据丢失。如果应用程序需要高度的可靠性，请考虑使用不同的传输层协议，例如 TCP。
*   如果服务器和客户端在同一个网络上，但客户端尝试通过网络的外部 IP 连接到服务器，则验证网关是否支持环回以外部 IP 为目的地的内部流量。
*   执行 traceroute 以验证 IP 数据包的[生存时间](http://en.wikipedia.org/wiki/Time_to_live)字段是否足够高，以便在客户端和服务器之间进行路由。
*   验证客户端和服务器之间路由设备的正确 NAT 支持。 [RFC 4787](https://www.rfc-editor.org/rfc/rfc4787)详细描述了 UDP 和 NAT 要求。 如果服务器实际上不可公开访问，则可能需要[UDP 打孔。](http://en.wikipedia.org/wiki/UDP_hole_punching)

在大多数情况下，如果客户端和服务器在 LAN 上工作，则通常是网络问题。[使用netcat](http://en.wikipedia.org/wiki/Netcat)等基本工具和使用可靠的基于连接的协议（如 TCP）调试网络可能是值得的。一旦观察到连接，然后切换到使用 UDP 客户端和服务器。

# nservicebus - 使用 NServiceBus 在特定日期执行转换

> ID：15993181
> 
> 赞同：0
> 
> 时间：2013-04-13T21:33:33.617
> 
> 标签：nservicebus

我正在开发一个系统，其中订阅的生命周期由状态机处理，我正在寻找 NServiceBus 作为状态之间转换管理的替代品。

**例子**

客户有一个有效的互联网订阅，并希望在未来 3 个月内取消它。

**当前解决方案**

在数据库中创建一个转换，例如

```
tranistionId: 10000,
subscriptionId: 1337,
transition: "execute-inactivation"
due-date: {current date + 3 months} 
```

该表每 10 秒扫描一次，以查看是否有任何新的/到期的转换。

**服务总线**

我认为可以通过以下方式复制当前的解决方案：

```
Schedule.Every(TimeSpan.FromSeconds(5)).Action(() => 
{ 
    Bus.Send<CheckForDueTransitions>(); 
}); 
```

但这不会消除对数据库的喋喋不休的问题。

另一个重要特性是可以*中止排队的转换*，例如取消取消。

是否有针对我的问题的首选 NServiceBus 解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T09:40:25.530

我建议看看[NServiceBus Sagas](http://support.nservicebus.com/customer/portal/articles/860458-sagas-in-nservicebus)。您可能会认为每个订阅都是它自己的长期运行进程（Saga 实例），并使用超时管理器来管理它们。然后，您可以使用超时功能按需自动取消您的订阅，或者如果用户延长他们的订阅，则为该订阅创建一个新的超时到新的到期日期。

# asp.net-mvc - 如何使用程序集版本重命名构建名称？

> ID：15993182
> 
> 赞同：1
> 
> 时间：2013-04-13T21:33:40.487
> 
> 标签：asp.net-mvc, azure, visual-studio-2012, msbuild, azure-devops

请看截图。我已经设置了与 tfsservice 的持续集成。它在每次签入后构建和部署。

如果该词存在，我想附加或预先附加程序集版本，以便我可以轻松识别哪个构建生成了哪个版本，并且我可以轻松识别哪个构建中出现了错误。![在此处输入图像描述](https://i.stack.imgur.com/ftQ9S.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T11:04:36.013

如果您的意思是在构建期间需要从库中获取版本号，那么您可以使用 MSBuild Extensions Pack 中的[Assembly](http://www.msbuildextensionpack.com/help/4.0.6.0/html/2610c1b7-348a-901e-3c90-84a3deb99c38.htm)类从所需的库中获取版本号。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T13:40:28.933

这是可行的，但您需要自定义构建模板。一个很好的起点是 Visual Studio ALM Rangers 的[BRDLite 参考模板](http://vsarbrdlite.codeplex.com/)。请参阅**BRDLite.Asp.NetTemplate.2012.2.xaml**模板中的**程序集版本控制**示例。

 **![BRDLite 程序集版本控制](https://i.stack.imgur.com/4z4oa.png)**

# haskell - uncurry ($) 有什么作用？

> ID：15993186
> 
> 赞同：13
> 
> 时间：2013-04-13T21:34:26.383
> 
> 标签：haskell, functional-programming, currying

我正在做一些练习，我必须添加一个函数的类型并解释它的作用。我坚持这个：

```
phy = uncurry ($) 
```

根据 GHCi，类型是`phy :: (a -> b, a) -> b`. 我的haskell知识是基础的，所以我真的不知道它是做什么的。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-13T23:37:25.147

让我们系统地拼出类型部分。我们将从 and 的类型`uncurry`开始`($)`：

```
uncurry :: (a -> b -> c) -> (a, b) -> c
($)     :: (a -> b) -> a -> b 
```

由于目标表达式`($)`作为 的参数`uncurry`，让我们排列它们的类型以反映这一点：

```
uncurry :: (a       -> b -> c) -> (a, b) -> c
($)     :: (a -> b) -> a -> b 
```

整个类型`($)`与 的第一个参数类型对齐`uncurry`，并且参数和结果类型`($)`与的第一个参数类型`uncurry`对齐，如图所示。这是对应关系：

```
uncurry's a  <==> ($)'s a -> b
uncurry's b  <==> ($)'s a
uncurry's c  <==> ($)'s b 
```

这有点令人困惑，因为一种类型中的`a`and`b`类型变量与另一种类型不同（就像`x`in`plusTwo x = x + 2`与`x`in不同`timesTwo x = x * 2`）。但是我们可以重写类型来帮助解释这一点。在像这样的简单 Haskell 类型签名中，任何时候你看到一个类型变量，你都可以用任何其他类型替换它的所有出现，也可以得到一个有效类型。如果您选择*新*的类型变量（原始类型中没有出现的类型变量），您将得到一个*等效*类型（可以转换回原始类型）；如果您选择非新鲜类型，您将获得适用于更窄范围类型的原始版本的*专用版本。*

但无论如何，让我们将此应用于`uncurry`::的类型

```
-- Substitute a ==> x, b ==> y, c ==> z:
uncurry :: (x -> y -> z) -> (x, y) -> z 
```

让我们使用重写的类型重做“排队”：

```
uncurry :: (x       -> y -> z) -> (x, y) -> z
($)     :: (a -> b) -> a -> b 
```

现在很明显`x <==> a -> b`：`y <==> a`和`z <==> b`。现在，将 的类型变量替换`uncurry`为 中的对应类型`($)`，我们得到：

```
uncurry :: ((a -> b) -> a -> b) -> (a -> b, a) -> b
($)     ::  (a -> b) -> a -> b 
```

最后：

```
uncurry ($) :: (a -> b, a) -> b 
```

* * *

所以这就是你如何确定类型。它的作用如何？好吧，在这种情况下，最好的方法是查看类型并仔细考虑，弄清楚我们必须编写什么才能获得该类型的函数。让我们用这种方式重写它，让它更加神秘：

```
mystery :: (a -> b, a) -> b
mystery = ... 
```

由于我们知道`mystery`它是一个参数的函数，我们可以扩展这个定义以反映：

```
mystery x = ... 
```

我们也知道它的参数是一对，所以我们可以扩展一点：

```
mystery (x, y) = ... 
```

因为我们知道这`x`是一个函数 and `y :: a`，所以我喜欢用它`f`来表示“函数”并将变量命名为与其类型相同的名称——这有助于我推理函数，所以让我们这样做：

```
mystery (f, a) = ... 
```

现在，我们在右手边放什么？我们知道它必须是 type `b`，但我们不知道 type`b`是什么（它实际上是调用者选择的任何内容，所以我们*不*知道）。所以我们必须以某种方式`b`使用我们的 function`f :: a -> b`和 value `a :: a`。啊哈！我们可以使用以下值调用函数：

```
mystery (f, a) = f a 
```

我们没有看 就写了这个函数`uncurry ($)`，但事实证明它做的事情和做的一样`uncurry ($)`，我们可以证明它。让我们从 and 的定义`uncurry`开始`($)`：

```
uncurry f (a, b) = f a b
f $ a = f a 
```

现在，用equals代替equals：

```
uncurry ($) (f, a) = ($) f a         -- definition of uncurry, left to right
                   = f $ a           -- Haskell syntax rule
                   = f a             -- definition of ($), left to right
                   = mystery (f, a)  -- definition of mystery, right to left 
```

因此，攻击您在 Haskell 中不理解的类型的一种方法是尝试编写一些具有该类型的代码。Haskell 与其他语言的不同之处在于，这通常是比尝试阅读代码更好的策略。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-04-13T21:42:29.467

```
uncurry :: (a -> b -> c) -> (a, b) -> c

($) :: (a -> b) -> a -> b

uncurry ($) :: (a -> b, a) -> b 
```

如果您检查类型`uncurry`及其`$`描述：

> uncurry 将 curried 函数转换为对上的函数。

它所做的只是接受一个函数`(a -> b -> c)`并返回一个将参数作为元组的函数。

`phy`与 做同样的事情`$`，但不是`f $ x`or你`($) f x`叫它 like `phy (f, x)`。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-04-14T14:29:39.270

其他两个答案都很好。我只是对此略有不同。

```
uncurry :: (a -> b -> c) -> (a, b) -> c
($)     :: (a -> b) -> a -> b 
```

由于类型签名中的“->”与右侧相关联，因此我可以等效地编写这两个类型签名，如下所示：

```
uncurry :: (a -> b -> c) -> ((a, b) -> c)
($)     :: (a -> b) -> (a -> b) 
```

`uncurry`接受两个输入的任意函数并将其更改为一个参数的函数，其中该参数是原始两个参数的元组。

`($)`接受一个简单的单参数函数并将其变成......它自己。它的唯一作用是语法。 `f $`相当于`f`。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-02-19T21:58:15.663

^(（确保您了解高阶函数和柯里化，阅读有关[高阶函数](http://learnyouahaskell.com/higher-order-functions)*的 Learn You a Haskell*章节，然后阅读[.（点）和 $（美元符号）](https://stackoverflow.com/q/940382/596361)与[函数组合 (.) 和函数应用 ($)之间的区别](https://stackoverflow.com/q/3030675/596361)[成语](https://stackoverflow.com/q/3030675/596361)))

`($)`只是一个函数应用，`f $ x`相当于`f x`. 但这很好，因为我们可以使用显式函数应用程序，例如：

```
map ($2) $ map ($3) [(+), (-), (*), (**)] -- returns [5.0,1.0,6.0,9.0] 
```

这相当于：

```
map (($2) . ($3)) [(+), (-), (*), (**)] -- returns [5.0,1.0,6.0,9.0] 
```

检查`($)`:的类型`($) :: (a -> b) -> a -> b`。你知道类型声明是右关联的，因此类型`($)`也可以写成`(a -> b) -> (a -> b)`. 等一下，那是什么？接收一元函数并返回相同类型的一元函数的函数？这看起来像一个特定版本的标识函数`id :: a -> a`。好的，首先是一些类型：

```
($) :: (a -> b) -> a -> b
id :: a -> a
uncurry :: (a -> b -> c) -> (a, b) -> c
uncurry ($) :: (b -> c, b) -> c
uncurry id :: (b -> c, b) -> c 
```

在编写 Haskell 代码时，请始终查看类型，它们甚至在您查看代码之前就为您提供了大量信息。那么，什么是`($)`? 它是 2 个参数的函数。什么是`uncurry`? 它也是 2 个参数的函数，第一个是 2 个参数的函数。所以`uncurry ($)`应该进行类型检查，因为^第一个参数`uncurry`应该是 2 个参数的函数，即`($)`。现在尝试猜测`uncurry ($)`. 如果`($)`'s 的类型是`(a -> b) -> a -> b`，则将其替换为`(a -> b -> c)`: `a`become `(a -> b)`, `b`become `a`, `c`become `b`，因此`uncurry ($)`返回一个 type 的函数`((a -> b), a) -> b`。或者`(b -> c, b) -> c`如上所述，这是同一件事。那么这种类型告诉我们什么？`uncurry ($)`接受一个元组`(function, value)`. 现在尝试仅从类型猜测它的作用。

现在，在回答之前，一个插曲。Haskell 是[强类型](https://wiki.haskell.org/Typing)的，如果类型声明有一个类型变量作为返回值类型，它禁止返回一个具体类型的值。所以如果你有一个带有 type 的函数`a -> b`，你就不能 return `String`。这是有道理的，因为如果您的函数的类型是`a -> a`并且您总是返回`String`，那么用户如何能够传递任何其他类型的值？您应该有一个类型`String -> String`，或者有一个类型`a -> a`并返回一个完全取决于输入变量的值。但是这种限制也意味着不可能为某些类型编写函数。type 没有函数`a -> b`，因为没有人知道应该用什么具体类型来代替`b`. 或者`[a] -> a`，你知道这个函数不能是[total](https://wiki.haskell.org/Partial_functions)，因为用户可以传递一个空列表，在这种情况下函数会返回什么？类型`a`应该取决于列表内部的类型，但列表没有“内部”，它是空的，所以你不知道空列表中元素的类型是什么。这个限制只允许在特定类型下为可能的函数留出非常狭窄的肘部空间，这就是为什么你仅仅通过阅读类型就可以获得关于函数可能行为的如此多信息的原因。

`uncurry ($)`返回 type 的东西`c`，但它是一个类型变量，而不是具体的类型，所以它的值取决于也属于 type 的东西`c`。我们从类型声明中看到元组中的函数返回 type 的值`c`。同一个函数要求一个类型的值`b`，它只能在同一个元组中找到。没有具体的类型也没有类型类，所以唯一`uncurry ($)`能做的就是取`snd`一个元组的 ，把它作为一个参数放在`fst`一个元组的函数中，返回它返回的任何东西：

```
uncurry ($) ((+2), 2) -- 4
uncurry ($) (head, [1,2,3]) -- 1
uncurry ($) (map (+1), [1,2,3]) -- [2,3,4] 
```

有一个可爱的程序[djinn](http://lambda-the-ultimate.org/node/1178)可以根据类型生成 Haskell 程序。试一试，看看我们对`uncurry ($)`'s 功能的类型猜测是正确的：

```
Djinn> f ? a -> a
f :: a -> a
f a = a
Djinn> f ? a -> b
-- f cannot be realized.
Djinn> f ? (b -> c, b) -> c
f :: (b -> c, b) -> c
f (a, b) = a b 
```

这也表明，`fst`并且`snd`是唯一可以具有各自类型的函数：

```
Djinn> f ? (a, b) -> a
f :: (a, b) -> a
f (a, _) = a
Djinn> f ? (a, b) -> b
f :: (a, b) -> b
f (_, a) = a 
```

# java - 自定义 JButton 的边距 - Java

> ID：15993188
> 
> 赞同：0
> 
> 时间：2013-04-13T21:34:43.417
> 
> 标签：java, swing, user-interface, jbutton

我通过扩展 Jbutton 为我的应用程序创建了一个自定义按钮，并且我已经让它按照我想要的方式绘制，但由于某种原因，即使我`setMargin()`在构造函数中调用，按钮的边距为 0，如下所示：

![在此处输入图像描述](https://i.stack.imgur.com/vtAzc.png)

我的代码有什么地方做错了吗？标准 JButtons 有边距，但我的自定义按钮没有边距是怎么回事？

我的按钮的java代码：

```
public class CToolbarButton extends JButton
{
        private static final Dimension SIZE = new Dimension(48, 48);

        private static final int MARGIN_VAL = 50;
        private static final Insets MARGIN = new Insets(MARGIN_VAL, MARGIN_VAL, MARGIN_VAL, MARGIN_VAL);

        private static final Color FILL_NORM = Color.GRAY;
        private static final Color FILL_ACTIVE = new Color(FILL_NORM.getRed()-25, FILL_NORM.getGreen()-25, FILL_NORM.getBlue()-25);

        private static final Color BORDER_NORM = Color.BLACK;
        private static final Color BORDER_ACTIVE = Color.YELLOW;

        public CToolbarButton()
        {
                super();
                setContentAreaFilled(false);
                setFocusable(false);
                setMargin(MARGIN);
        }

        @Override
        public void paintComponent(Graphics g)
        {
                if (getModel().isArmed())
                {
                        g.setColor(FILL_ACTIVE);
                }
                else
                {
                        g.setColor(FILL_NORM);
                }
                g.fillRect(0, 0, getWidth(), getHeight());
        }

        @Override
        public void paintBorder(Graphics g)
        {
                if (getModel().isArmed())
                {
                        g.setColor(BORDER_ACTIVE);
                }
                else
                {
                        g.setColor(BORDER_NORM);
                }
                g.drawRect(0, 0, getWidth(), getHeight());
        }

        @Override
        public boolean contains(int x, int y)
        {
                return (x >= 0 &&
                                x <= getWidth() &&
                                y >= 0 &&
                                y <= getHeight());
        }

        @Override
        public Dimension getPreferredSize()
        {
                return SIZE;
        }

        @Override
        public Dimension getMinimumSize()
        {
                return SIZE;
        }

        @Override
        public Dimension getMaximumSize()
        {
                return SIZE;
        }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T03:24:31.483

我不会尝试覆盖按钮的绘制方法，而是使用图像来模拟按钮的不同外观。

# c# - DropNet 集成 - GetAccessTokenAsync 错误

> ID：15993190
> 
> 赞同：2
> 
> 时间：2013-04-13T21:35:08.353
> 
> 标签：c#, windows-phone, dropbox-api, dropnet

我正在尝试在我的 Windows Phone 应用程序中实现[DropNet 库](http://dkdevelopment.net/what-im-doing/dropnet/)`GetAccessTokenAsync`，但在调用该方法时出现错误。

**第 1 步：从 Dropbox 获取 oauth 令牌**

```
public void ConnectToDropbox()
{
    _client = new DropNetClient(API_KEY, API_SECRET);
    _client.UseSandbox = true;

    // Get Request Token (oauth token) from Dropbox
    _client.GetTokenAsync(
        (userLogin) =>
        {
            // Authorise app with Dropbox
            var url = _client.BuildAuthorizeUrl();
            browser.LoadCompleted += new System.Windows.Navigation.LoadCompletedEventHandler(browser_LoadCompleted);
            browser.Navigate(new Uri(url));
        },
        (error) =>
        {
            Debug("Error: GetTokenAsync");
        });

} 
```

这似乎工作正常并返回一个 oauth 授权码。浏览器导航到的 URL 是 [https://www.dropbox.com/1/oauth/authorize?oauth_token=TSLEY7lLS8K2Mmnr](https://www.dropbox.com/1/oauth/authorize?oauth_token=TSLEY7lLS8K2Mmnr)

**第 2 步：将 oauth 令牌转换为可用的 Dropbox API 令牌**

```
void browser_LoadCompleted(object sender, System.Windows.Navigation.NavigationEventArgs e)
{
    Debug("Callback URL: " + e.Uri.AbsoluteUri);
    if (e.Uri.AbsolutePath == "/1/oauth/authorize")
    {

        //The User has logged in!
        //Now to convert the Request Token into an Access Token
        _client.GetAccessTokenAsync(
            (response) =>
            {
                Debug("User is logged in");
                LoadContents();
            },
                (error) =>
                {
                    Deployment.Current.Dispatcher.BeginInvoke(() =>
                    {
                        Debug("Error getting access token (GetAccessTokenAsync)");
                        MessageBox.Show(error.Message);
                    });
                });
    }
    else
    {
        //Probably the login page loading, ignore
    }
} 
```

该`GetAccessTokenAsync`方法在运行时抛出以下异常：

*System.Windows.ni.dll 中发生了“System.Net.WebException”类型的异常，并且在托管/本机边界之前未处理*

应用内消息框显示： *'DropNet.Exceptions.DropboxException' 类型的异常被抛出。*

DropboxException 对象的所有属性如下：

**响应：** RestSharp.RestResponse

**状态码：** 未授权

**堆栈跟踪：**

**数据：** System.Collections.ListDictionaryInternal

**基本异常：** DropNet.Exceptions.DropboxException：引发了“DropNet.Exceptions.DropboxException”类型的异常。

**内部异常：**

**类型：** DropNet.Exceptions.DropboxException

状态码*未经授权*是否相关？我正在使用 Dropbox 提供的适当 API 密钥和秘密。

如果在使用 DropNet 时遇到过类似问题的任何人能给我一些解决此问题的建议，我将不胜感激。如果需要，很乐意提供任何进一步的信息。

提前致谢，

安德鲁

# compiler-construction - IntelliJ 不能与 Java 一起使用？

> ID：15993191
> 
> 赞同：1
> 
> 时间：2013-04-13T21:35:08.493
> 
> 标签：compiler-construction, sdk, compiler-errors, intellij-idea, java

最近，我下载并安装了 IntelliJ 来试用一下。这似乎是一个不错的界面，我真的很想尝试一下，但它似乎不适用于我的 JDK。我给了它以下代码：

```
public class HelloWorld
{
  public static void main (String [] args)
  {
    System.out.println("Hello World. ");
  }
} 
```

令我惊讶的是，当我编译它时，我得到了这个错误：

> java：致命错误：无法在类路径或引导类路径中找到包 java.lang

我在网上查了更多帮助，很多事情都说要查：

> “文件”->“项目结构”->“平台设置”->“SDK”

然后添加您的 JDK（JDK 1.7）。那没有用，所以我尝试了 JDK 1.6，它也给了我同样的错误。任何帮助，将不胜感激。谢谢！

# android-layout - 图形布局编辑器为 eclipse Juno 中的所有 XML 文件提供 nullpointerexception

> ID：15993193
> 
> 赞同：1
> 
> 时间：2013-04-13T21:35:37.193
> 
> 标签：android-layout, nullpointerexception, android-xml, eclipse-juno, eclipse-adt

我的 Eclipse 中的图形布局编辑器停止工作，它给了我这个消息：

```
java.lang.NullPointerException
Exception details are logged in Window > Show View > Error Log 
```

我的错误日志中有这个：

```
eclipse.buildId=v21.1.0-569685
java.version=1.7.0_01
java.vendor=Oracle Corporation
BootLoader constants: OS=win32, ARCH=x86_64, WS=win32, NL=en_US
Framework arguments:  -product com.android.ide.eclipse.adt.package.product
Command-line arguments:  -os win32 -ws win32 -arch x86_64 -product
com.android.ide.eclipse.adt.package.product

!ENTRY org.eclipse.egit.ui 2 0 2013-04-14 00:03:01.507
!MESSAGE Warning: EGit couldn't detect the installation path "gitPrefix" of native Git. Hence     
EGit can't respect system level
Git settings which might be configured in ${gitPrefix}/etc/gitconfig under the native Git    
installation directory.
The most important of these settings is core.autocrlf. Git for Windows by default sets this parameter to true in
this system level configuration. The Git installation location can be configured on the
Team > Git > Configuration preference page's 'System Settings' tab.
This warning can be switched off on the Team > Git > Confirmations and Warnings preference page.

!ENTRY com.android.ide.eclipse.adt 4 0 2013-04-14 00:03:08.208
!MESSAGE dialog_game_paused.xml: java.lang.NullPointerException
!STACK 0
java.lang.NullPointerException
at android.graphics.Bitmap_Delegate.nativeWidth(Bitmap_Delegate.java:291)
at android.graphics.Bitmap.nativeWidth(Bitmap.java)
at android.graphics.Bitmap.getWidth(Bitmap.java:909)
at android.graphics.Bitmap.getScaledWidth(Bitmap.java:957)
at android.graphics.drawable.BitmapDrawable.computeBitmapSize(BitmapDrawable.java:179)
at android.graphics.drawable.BitmapDrawable.setBitmap(BitmapDrawable.java:187)
at android.graphics.drawable.BitmapDrawable.<init>(BitmapDrawable.java:555)
at android.graphics.drawable.BitmapDrawable.<init>(BitmapDrawable.java:110)
at com.android.layoutlib.bridge.impl.ResourceHelper.getDrawable(ResourceHelper.java:239)
at com.android.layoutlib.bridge.bars.CustomBar.loadIcon(CustomBar.java:196)
at com.android.layoutlib.bridge.bars.CustomBar.loadIconById(CustomBar.java:188)
at com.android.layoutlib.bridge.bars.CustomBar.loadIconById(CustomBar.java:155)
at com.android.layoutlib.bridge.bars.FakeActionBar.<init>(FakeActionBar.java:38)
at com.android.layoutlib.bridge.impl.RenderSessionImpl.inflate(RenderSessionImpl.java:333)
at com.android.layoutlib.bridge.Bridge.createSession(Bridge.java:332)
at com.android.ide.common.rendering.LayoutLibrary.createSession(LayoutLibrary.java:325)
at com.android.ide.eclipse.adt.internal.editors.layout.gle2.RenderService.createRenderSession(RenderService.java:440)
at com.android.ide.eclipse.adt.internal.editors.layout.gle2.GraphicalEditorPart.renderWithBridge(GraphicalEditorPart.java:1545)
at com.android.ide.eclipse.adt.internal.editors.layout.gle2.GraphicalEditorPart.recomputeLayout(GraphicalEditorPart.java:1302)
at com.android.ide.eclipse.adt.internal.editors.layout.gle2.GraphicalEditorPart.changed(GraphicalEditorPart.java:718)
at com.android.ide.eclipse.adt.internal.editors.layout.gle2.GraphicalEditorPart.onTargetChange(GraphicalEditorPart.java:1189)
at com.android.ide.eclipse.adt.internal.editors.layout.LayoutEditorDelegate.onDescriptorsChanged(LayoutEditorDelegate.java:916)
at com.android.ide.eclipse.adt.internal.editors.layout.LayoutEditorDelegate.delegateInitUiRootNode(LayoutEditorDelegate.java:835)
at com.android.ide.eclipse.adt.internal.editors.layout.gle2.GraphicalEditorPart$TargetListener.updateEditor(GraphicalEditorPart.java:946)
at com.android.ide.eclipse.adt.internal.editors.layout.gle2.GraphicalEditorPart$TargetListener.onTargetLoaded(GraphicalEditorPart.java:910)
at com.android.ide.eclipse.adt.AdtPlugin$11.run(AdtPlugin.java:1754)
at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)
at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:135)
at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:4144)
at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3761)
at org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2701)
at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2665)
at org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2499)
at org.eclipse.ui.internal.Workbench$7.run(Workbench.java:679)
at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)
at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:668)
at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)
at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:124)
at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196)
at  org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110)
at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79)
at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:353)
at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:180)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
at java.lang.reflect.Method.invoke(Method.java:601)
at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:629)
at org.eclipse.equinox.launcher.Main.basicRun(Main.java:584)
at org.eclipse.equinox.launcher.Main.run(Main.java:1438) 
```

我认为我的代码没有问题，因为有一段时间一切正常，然后 3 天前就发生了。

# android - 在正在进行的语音通话期间播放音频文件，以便来电者可以听到

> ID：15993195
> 
> 赞同：1
> 
> 时间：2013-04-13T21:35:47.287
> 
> 标签：android

我正在尝试制作答录机。

当我的设备中有来电时，我会接听它并启动一个启用扬声器的音频文件，以便麦克风可以接收扬声器的声音并且呼叫者可以听到它。

该应用程序正在运行。这就是我实施的。但问题是当我接到电话并开始播放音频时，扬声器已打开，但麦克风不会从扬声器中拾取任何东西，尽管它可以从其他来源拾取声音。因此来电者无法在此处播放音频。

有人对这个问题有见解吗？我的意思是为什么麦克风不会从扬声器中拾取声音，但同时从其他来源中拾取声音？

# ruby - Ruby - 读取文件时如何跳过/忽略特定行？

> ID：15993198
> 
> 赞同：6
> 
> 时间：2013-04-13T21:36:04.887
> 
> 标签：ruby, parsing, cucumber, lines, skip

在读取/解析文件（使用 Ruby）时忽略某些行的最佳方法是什么？

我正在尝试仅解析 Cucumber .feature 文件中的场景，并希望跳过不以 Scenario/Given/When/Then/And/But 开头的行。

下面的代码有效，但很荒谬，所以我正在寻找一个聪明的解决方案:)

```
File.open(file).each_line do |line|
  line.chomp!
  next if line.empty? 
  next if line.include? "#"
  next if line.include? "Feature" 
  next if line.include? "In order" 
  next if line.include? "As a" 
  next if line.include? "I want" 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-13T21:47:35.580

你可以这样做：

```
a = ["#","Feature","In order","As a","I want"]   
File.open(file).each_line do |line|
  line.chomp!
  next if line.empty? || a.any? { |a| line =~ /#{a}/ }
end 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-13T21:59:45.450

该`start_with?`方法接受多个参数：

```
File.open(file).each_line do |line|
  next unless line.start_with? 'Scenario', 'Given', 'When', 'Then', 'And', 'But'
  # do something with line.
end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-14T05:39:17.870

## 使用正则表达式实现紧凑性

您可以用一个使用交替的正则表达式替换大部分当前循环。您可能还想使用[String#chomp！](http://ruby-doc.org/core-2.0/String.html#method-i-chomp-21)作为条件表达式的一部分。例如：

```
File.open(file).each do |line|
  next if line.chomp! =~ /^$|#|Feature|In order|As a|I want/
  # something else
end 
```

这将您的代码块减少了六行代码。无论您是否发现这种替代方法更易于阅读，它肯定更短且更惯用。你的旅费可能会改变。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-13T21:48:52.307

这并没有太大帮助，但是您可以使用数组交集来减少代码。

```
words = ["#", "Feature", "In order", "As a", "I want"]

File.open(file).each_line do |line|
  line.chomp!
  next if line.empty? || !(line.split & words).empty? 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-14T05:00:25.733

使用`abstract method`重构方法！您可以在抽象方法中使用任何技术，聪明或不那么聪明。

```
File.open(file).each_line do |line|
         line.chomp!
         next if ignore(line)
end

def ignore line
#do whatever you like here, clever or straightforward. 
#All the techniques others has posted could be applied here
end 
```

# clojure - 如何增加地图中的值

> ID：15993203
> 
> 赞同：10
> 
> 时间：2013-04-13T21:36:48.547
> 
> 标签：clojure, state, immutability

我正在考虑 Clojure 中的状态。我来自可以改变状态的语言。例如，在 Python 中，我可以创建一个字典，将一些字符串 => 整数对放入其中，然后遍历字典并递增值。

我将如何在惯用的 Clojure 中做到这一点？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-13T21:55:15.807

```
(def my-map {:a 1 :b 2})
(zipmap (keys my-map) (map inc (vals my-map)))
;;=> {:b 3, :a 2} 
```

按键只更新一个值：

```
(update-in my-map [:b] inc) ;;=> {:a 1, :b 3} 
```

从 Clojure 1.7 开始，也可以使用`update`：

```
(update my-map :b inc) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-13T21:44:03.253

只需[生成](https://stackoverflow.com/questions/1676891/mapping-a-function-on-the-values-of-a-map-in-clojure)一张新地图并使用它：

```
(def m {:a 3 :b 4})

(apply merge 
  (map (fn [[k v]] {k (inc v) }) m))

; {:b 5, :a 4} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-13T22:41:07.127

要更新多个值，您还可以利用 reduce 获取已填充的累加器，并在该累加器和以下集合的每个成员上应用一个函数。

```
=> (reduce (fn [a k] (update-in a k inc)) {:a 1 :b 2 :c 3 :d 4} [[:a] [:c]])
{:a 2, :c 4, :b 2, :d 4} 
```

请注意需要包含在向量中的键，但您仍然可以在嵌套结构中执行多个更新，如原始更新。

如果你把它变成一个通用函数，你可以通过用 coll? 测试它来自动将一个向量包裹在一个键上：

```
(defn multi-update-in
  [m v f & args]
       (reduce
         (fn [acc p] (apply
                       (partial update-in acc (if (coll? p) p (vector p)) f)
                       args)) m v)) 
```

这将允许单级/密钥更新，而无需将密钥包装在向量中

```
=> (multi-update-in {:a 1 :b 2 :c 3 :d 4} [:a :c] inc)
{:a 2, :c 4, :b 2, :d 4} 
```

但仍然可以进行嵌套更新

```
(def people
  {"keith" {:age 27 :hobby "needlefelting"}
   "penelope" {:age 39 :hobby "thaiboxing"}
   "brian" {:age 12 :hobby "rocket science"}})

=> (multi-update-in people [["keith" :age] ["brian" :age]] inc)
   {"keith" {:age 28, :hobby "needlefelting"},
    "penelope" {:age 39, :hobby "thaiboxing"},
    "brian" {:age 13, :hobby "rocket science"}} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-19T21:57:18.707

我一直在玩同样的想法，所以我想出了：

```
(defn remap 
  "returns a function which takes a map as argument
   and applies f to each value in the map"
  [f]
  #(into {} (map (fn [[k v]] [k (f v)]) %)))

((remap inc) {:foo 1})
;=> {:foo 2} 
```

或者

```
(def inc-vals (remap inc))

(inc-vals {:foo 1})
;=> {:foo 2} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-10-18T18:37:27.850

稍微改进@Michiel Brokent 的回答。如果密钥已经不存在，这将起作用。

```
(update my-map :a #(if (nil? %) 1 (inc %))) 
```

# java - 在 Java 中对动画使用线程

> ID：15993204
> 
> 赞同：0
> 
> 时间：2013-04-13T21:36:58.293
> 
> 标签：java, multithreading, paint

我创建了一个具有两种形状的类，即两个椭圆形。我在这里画它们。

```
import ...;

public class Drawings extends JPanel{
    public double degrees = 0;

    public void paintComponent(Graphics g){
        super.paintComponent(g);
        int xcen =  getWidth() / 2;
        int ycen =  getHeight()/ 2;

        int radius = 10;
        degrees++;

        double radians = Math.toRadians(degrees);
        int posx = (int)(100.getDistance() * Math.cos(radians));
        int posy = (int)(100.getDistance() * Math.sin(radians));

        g.setColor(Color.BLUE);
        g.FillOval(xcen + posx, ycen + posy, 20, 20);

        g.setColor(Color.GREEN);
        g.drawOval(xcen + posx, ycen + posy, 100,100)

   }
} 
```

现在我在 main.js 中实现它。

```
import ....;

public class Animate extends JFrame{
  public static void main(String [] args)
  {

   JFrame window = new JFrame();
   window.add(new Drawings());
   window.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
   window.setSize(500,500);
   window.setLocationRelativeTo(null); 
   window.setVisible(true);

   //now I implement the thread to animate the two shapes
   Thread paintThread = new Thread(new Runnable(){
   @Override
        public void run(){
              while(true)
              {
                   window.repaint();
                   try{
                        Thread.sleep(25);//determines how slow the ovals will move
                   }catch(InterruptedException e){
                       e.printStackTrace();
                   }
                 }
               }
             });

              paintThread.start();//start the animation

            }  
         } 
```

当程序运行时，两个椭圆在屏幕上旋转。但是这两个椭圆的旋转速度与我预期的相同，但我希望这两个椭圆以不同的速度移动。

我尝试使用一种方法以不同的速度移动它们，但没有成功。如何让两个椭圆以不同的速度移动？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T22:12:20.553

制作一个代表椭圆的类。做两个实例。给这两个实例不同的角速度。目前，因为您每 25 毫秒将度数增加 1.0，所以角速度固定为每秒 40 度。如果每个椭圆都有自己的度数字段，并且您将两者增加不同的量，则椭圆将以不同的速率旋转。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T22:41:40.463

最简单的方法是：

```
import ...;

public class Drawings extends JPanel{
public double degrees = 0;

private int firstOvalSpeed;
private int secondOvalSpeed;

public void paintComponent(Graphics g){
    super.paintComponent(g);
    int xcen =  getWidth() / 2;
    int ycen =  getHeight()/ 2;

    int radius = 10;
    degrees++;

    double radians = Math.toRadians(degrees);
    int posx = (int)(100.getDistance() * Math.cos(radians));
    int posy = (int)(100.getDistance() * Math.sin(radians));

    g.setColor(Color.BLUE);
    g.FillOval(xcen + posx*firstOvalSpeed, ycen + posy*firstOvalSpeed, 20, 20);

    g.setColor(Color.GREEN);
    g.drawOval(xcen + posx*secondOvalSpeed, ycen + posy*secondOvalSpeed, 100,100)

 }
public void setFirstOvalSpeed(int firstOvalSpeed) {
    this.firstOvalSpeed = firstOvalSpeed;
}

public void setSecondOvalSpeed(int secondOvalSpeed) {
    this.secondOvalSpeed = secondOvalSpeed;
}

} 

public class Animate extends JFrame {
public static void main(String[] args) {

    final JFrame window = new JFrame();
    Drawings drawings = new Drawings();
    drawings.setFirstOvalSpeed(1);
    drawings.setSecondOvalSpeed(2);

    window.add(drawings);
    window.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    window.setSize(500, 500);
    window.setLocationRelativeTo(null);
    window.setVisible(true);

    // now I implement the thread to animate the two shapes
    Thread paintThread = new Thread(new Runnable() {
        @Override
        public void run() {
            while (true) {
                window.repaint();
                try {
                    Thread.sleep(25);// determines how slow the ovals will
                                        // move
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
            }
        }
    });

    paintThread.start();// start the animation

} 
```

}

# c# - 什么时候对象会被垃圾回收？

> ID：15993209
> 
> 赞同：4
> 
> 时间：2013-04-13T21:37:45.300
> 
> 标签：c#, garbage-collection

在 C# 中，当没有对它的引用时，对象会被垃圾回收。假设是这种情况，是否会收集以下任何一种，或者垃圾收集器是否足够聪明以丢弃它们？

```
class Program
{
    static void Main()
    {
        A a = new A();
        a.b = new B();
        a.b.a = a;
        a = null;
    }

{

class A
{
    public B b;
}

class B
{
    public A a;
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-13T21:41:00.587

一旦不再需要它们，它们都将有资格收集。这意味着在某些情况下，甚至可以在定义对象的范围结束之前收集对象。另一方面，实际收集也可能发生得更晚。

.NET 垃圾收集器不基于引用计数，因此循环依赖没有区别。

它基于[mark-and-sweep](http://www.brpreiss.com/books/opus5/html/page424.html)算法，将所有对象视为收集的候选对象，然后从可用的根（局部变量、静态变量）遍历对象图，将它们标记为仍然“活着”。那些没有被标记为仍在使用的，被收集起来。请注意，这有点简化描述：.NET 中真正的算法是采用 mark-and-sweep，托管堆分为 3 代 + 大对象堆，finalization 完全忽略等。

我建议查看[Maoni Stephens 的博客](http://blogs.msdn.com/b/maoni/)以获取更多信息。

# javascript - angularFire 路由解析

> ID：15993212
> 
> 赞同：1
> 
> 时间：2013-04-13T21:38:10.193
> 
> 标签：javascript, angularjs, firebase

我想让我的`angularFire`收藏解决路线加载问题。就像是：

```
App.config ($routeProvider, angularFireProvider) ->
  $routeProvider.when '/test',
    templateUrl: 'views/test.html'
    controller: 'TestCtrl'
    resolve: angularFireProvider.resolve 'testItems' 
```

是否有可能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T02:28:28.123

我不确定为什么您希望集合在路由加载时解决，而不是在控制器中解决 - 您能详细说明一下吗？例如，以下内容也可以：

```
App.config ($routeProvider, angularFireProvider) ->
  $routeProvider.when '/test',
  controller: 'TestCtrl'

function TestCtrl($scope, angularFire) {
  angularFire("https://<example>.firebaseio.com", $scope, "collection").
    then(function() {
      // The collection has been resolved and available in $scope.collection
    });
} 
```

主要是语法方便还是我缺少上面想要的功能？

更新：对于要在`$routeChangeSuccess`事件触发之前解析的值：

```
 App.config(['$routeProvider', 'angularFire', function($routeProvider, angularFire) {
   $routeProvider.when("/test", {
     templateUrl: 'views/test.html'
     controller: 'TestCtrl',
     resolve: {collection: angularFire("https://<example>.firebaseio.com")}
   });
 }]);

 function TestCtrl(collection) {
   // collection has already been resolved to its value.
 } 
```

# php - 我的 wordpress 自定义帖子和元框不保存或显示元框值？

> ID：15993213
> 
> 赞同：0
> 
> 时间：2013-04-13T21:38:14.690
> 
> 标签：php, wordpress

我最近决定尝试开发一个带有自定义帖子类型的 wordpress 网站，用于存储“摩托车”。而不是使用自定义字段，我更愿意为任何人使用自定义元框来存储摩托车信息，例如要在网站前端显示的速度。

这是代码，请注意我的元数据的保存功能，我没有使用随机数等等，这是因为我一直试图让它简单地保存元框输入。

这是我的代码：

```
 function kc_mgb_initate(){
#this function is the first function that will be called to initiate our plugiin
#this will be incharge of creating the Menu and Submenu's, as well as initate the custom post's, meta box's and taxonomies
#Hang on, this plugin does not need options so no need for menus, skepping to creating custom posts

//add_menu_page('Motorbike_Garage', 'Motor Bike Garage'); #the function that registers the menu pages

#first create the labels for our custom post

 $customlabels = array(
                'name' => 'Motorbike Garage',
                'singular_name' => 'Motorbike Garage',
                'add_new' => 'Add New Motorbike',
                'add_new_item' => 'Add New Motorbike',
                'edit' => 'Edit',
                'edit_item' => 'Edit Motorbikes',
                'new_item' => 'New Motorbikes',
                'view' => 'View',
                'view_item' => 'View Motorbikes',
                'search_items' => 'Search Motorbikes',
                'not_found' => 'No Motorbikes found',
                'not_found_in_trash' => 'No Motorbikes found in Trash',
                'parent' => 'Parent Motorbike Review'
            );

#array for our custom supports
$customsupports = array( 'title', 'editor', 'comments', 'thumbnail', 'custom-fields' );

#now a new array for our custom post args

$customargs = array('labels' => $customlabels, 'public' => true, 'menu_position' => 5, 'supports' => $customsupports, 'taxonomies' => array('motorbike_category'), 'has_archive' => true, 'register_meta_box_cb' => 'add_motorbikes_metaboxes'
); #this function registers the new custom post's
#the 'register_meta_box_cb' => 'add_motorbikes_metaboxes' adds the meta box information needed for this post by calling the add_motorbikes_metaboxes function

#now for the custom taxonomy we shall call 'motorbike_categories'

#the variables

$taxonomylabels = array('name' => _x( 'motorbikes', 'taxonomy general name' ),
            'singular_name' => _x( 'motorbike', 'taxonomy singular name' ),
            'search_items' =>  __( 'Search Motorbikes' ),
            'all_items' => __( 'All Motorbikes' ),
            'parent_item' => __( 'Parent Motorbike' ),
            'parent_item_colon' => __( 'Parent Motorbike:' ),
            'edit_item' => __( 'Edit Motorbike' ),
            'update_item' => __( 'Update Motorbike' ),
            'add_new_item' => __( 'Add New Motorbike' ),
            'new_item_name' => __( 'New Motorbike Name' ),
            'menu_name' => __( 'Motorbike Categories' ),
        );

$taxonomyslugs = array('slug' => 'motorbikes', 'hierarchical' => true, 'with_front' => false);

#our function to add the taxonomy

register_taxonomy('motorbike_category', 'post', array('hierarchical' => true, 'labels' => $taxonomylabels, 'rewrite' => $taxonomyslugs));
register_post_type('motorbikes', $customargs);
}

function add_motorbikes_metaboxes(){
#this adds the metabox information for our meta data
add_meta_box('motorbikegaragedata', 'Motorbike Garage Information', 'create_motorbike_meta_box', 'motorbikes', 'side', 'default');
}

function create_motorbike_meta_box($post, $box){
#this function will create the form for us

#we need year, top mph, weight, seat height, engine in cc, power and 1/4 mile
$mbg_top_mph = get_post_meta($post->ID, 'mbg_top_mph', true);
$mbg_year = get_post_meta($post->ID, 'mbg_year', true);
$mbg_weight = get_post_meta($post->ID, 'mbg_weight', true);
$mbg_seat_height = get_post_meta($post->ID, 'mbg_seat_height', true);
$mbg_engine = get_post_meta($post->ID, 'mbg_engine', true);
$mbg_power = get_post_meta($post->ID, 'mbg_power', true);
$mbg_sec = get_post_meta($post->ID, 'mbg_sec', true);
?>
<p> Motorbike MPH </p>
<input type="text" name="mbg_top_mph" value="<?php echo $mbg_top_mph; ?>" /> <br />
<p> Motorbike Year </p>
<input type="text" name="mbg_year" value="<?php echo $mbg_year; ?>" /> <br />
<p> Motorbike Weight(KG) </p>
<input type="text" name="mbg_weight" value="<?php echo $mbg_weight; ?>" /> <br />
<p> Motorbike Seat Height(CM) </p>
<input type="text" name="mbg_seat_height" value="<?php echo $mbg_seat_height; ?>" /> <br />
<p> Motorbike Engine(cc)</p>
<input type="text" name="mbg_engine" value="<?php echo $mbg_engine; ?>" /><br />
<p> Motorbike Power(BHP) </p>
<input type="text" name="mbg_power" value="<?php echo $mbg_power; ?>" /><br />
<p> Motorbike 1/4 Mile(SECs) </p>
<input type="text" name="mbg_sec" value="<?php echo $mbg_sec; ?>" />
<?php
}

function save_motorbikes_metaboxes($post_id, $post){
#this saves the motorbike meta data
update_post_meta($post->ID, 'mbg_top_mph', $_POST['mbg_top_mph']);
update_post_meta($post->ID, 'mbg_year', $_POST['mbg_year']);
update_post_meta($post->ID, 'mbg_weight', $_POST['mbg_weight']);
update_post_meta($post->ID, 'mbg_seat_height', $_POST['mbg_seat_height']);
update_post_meta($post->ID, 'mbg_engine', $_POST['mbg_engine']);
update_post_meta($post->ID, 'mbg_power', $_POST['mbg_power']);
update_post_meta($post->ID, 'mbg_sec', $_POST['mbg_sec']);
}

#this is the action that will now call the function to add our custom posts
add_action('init', 'kc_mgb_initate'); # 'init' is when wordpresss has initiated properly

add_action('save_post', 'save_motorbikes_metaboxes'); #this is too call the save function 
```

我已经检查了我的变量名，所以，我只是想弄清楚为什么它没有保存我的元框信息。

您拥有的任何提示或信息将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T00:26:31.967

您永远不会连接`add_motorbikes_metaboxes`或连接`save_motorbikes_metaboxes`到任何钩子（应该分别是`add_meta_boxes`和`save_post`），因此它们永远不会被调用。

# html - 水平引导形式：将两个输入彼此相邻对齐

> ID：15993216
> 
> 赞同：4
> 
> 时间：2013-04-13T21:38:24.773
> 
> 标签：html, css, forms, twitter-bootstrap, responsive-design

我试图弄清楚如何在 Bootstrap 中使用`form-horizontal`. 我尝试将`div.row`包装器与`spanX`类结合使用`input-block-level`。

或者，我试图省略`div.row`但直接给输入`spanX`类。

问题是，输入的宽度不同。也许这是一个错误，但在某个视口（需要`bootstrap-responsive.css`）它可以正常工作 - 但不是大视口，有时会出现水平滚动条。

Bootstrap 的响应式样式表不应该调整大小吗？将整个代码包装在 a 中`div.container`会使情况变得更糟。

也许您甚至可以向我展示一些完全不同的解决方案？

我为你准备了一个[jsFiddle](http://jsfiddle.net/aKnzS/)和一些截图。您可以在标题中找到窗口的大小和视口的大小（在方括号中）。单击图像以查看全尺寸。

[![](https://i.stack.imgur.com/cxcsym.png)](https://i.stack.imgur.com/cxcsy.png) [![](https://i.stack.imgur.com/pjbx2m.png)](https://i.stack.imgur.com/pjbx2.png) [![](https://i.stack.imgur.com/Vufctm.png)](https://i.stack.imgur.com/Vufct.png) [![](https://i.stack.imgur.com/oVpNom.png)](https://i.stack.imgur.com/oVpNo.png) [![](https://i.stack.imgur.com/5cVMvm.png)](https://i.stack.imgur.com/5cVMv.png) [![](https://i.stack.imgur.com/pMNCNm.png)](https://i.stack.imgur.com/pMNCN.png) [![](https://i.stack.imgur.com/d5ATGm.png)](https://i.stack.imgur.com/d5ATG.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T19:13:37.060

您必须记住，`spanX`类是用百分比实现的，因此当将多个输入区域放在同一行时，有时边缘不会正确对齐。所以当你使用一个`span12`类时，它的成员`div`可能会被扭曲。

标签是每行多输入场景中的另一个问题。它们占用 160 像素，因此它们与`span12`输入区域不兼容。它们最适合每行一个输入，并且`span1-span10`.

```
<form class="container-fluid">
    <div class="control-group">

        <div class="controls row-fluid">
            <input type="text" class="span11" placeholder="Street" />
        </div>

        <div class="controls controls-row row-fluid">
            <input type="text" class="span4" placeholder="Zip" />
            <input type="text" class="span7" placeholder="City" />
        </div>
    </div>
</form> 
```

我在您的第二行添加了另外两个类，`controls-row`并且`row-fluid`- 第一个将行对齐在一起，而另一个使长度变得流畅。

**一个更好的设计决策将是摆脱标签 - 占位符已经完成了他们的工作 - 在同一行上有多个输入区域的情况下。这样您就可以使用整个 11 列。**

由于 12 列的结构，水平滚动条有时会​​出现，所以通过在 body 元素上设置“overflow-x:hidden”来摆脱它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T19:14:59.770

因为您要更改的样式仅适用于移动屏幕设备。如果你使用上面的代码；

```
.input-block-level{
    width:60%;

} 
```

您只会发现仅在移动视口 example-320px/480px 及更高版本上对齐的**zip**和**country**输入将不起作用。所以你必须添加任何这样的样式来添加其他媒体查询，比如 768px 或任何你想要的。您的代码将不惜一切代价通过`class`方法或通过`input[type="text"]`方法对其进行样式化，只有它们应该在确切的媒体查询中。

# php - 使用sha1进行散列时避免php中的散列冲突

> ID：15993217
> 
> 赞同：1
> 
> 时间：2013-04-13T21:38:25.650
> 
> 标签：php, security, hash, sha

假设我假设我在 php 中使用 sha1 函数时是否发生哈希冲突。

这段代码会永久避免它还是我必须使用任何其他方式

```
$filename=sha1($filename.'|'.microtime());

OR

$filename=sha1($filename.'|'.rand()); 
```

如果没有，则此代码不提供哈希冲突保护。

如果我假设 db 中可能有超过 100,000 个条目，我应该怎么做才能避免任何类型的哈希冲突。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-13T22:01:45.773

sha1 不太可能发生哈希冲突。sha1 碰撞的概率可以忽略不计

并且哈希冲突风险是不切实际的。到目前为止还没有人发现 sha1 碰撞。所以你可以安全地使用它。

使用像微时间或随机数这样的盐可能会降低概率，但你根本无法避免它。

而您使用的是 sha1(string)，无论字符串是混合值还是单个字符串。所以使用 microtime 和 rand 函数不会影响哈希冲突的概率。

因此，sha1(mixedvalue) 冲突可能等于或大于 sha1(filename) 的冲突，所以这当然没有用。

所以不要担心，如果你愿意，可以使用这种或简单的方法，它不会在未来产生问题，考虑哈希冲突是浪费时间，机会非常非常少。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-13T21:43:56.283

需要明确的是，您不能完全避免哈希冲突。它是对有限数量的输出的无限数量的输入，但您可以考虑文件大小、当前系统时间和其他数据以用作[盐](http://en.wikipedia.org/wiki/Salt_%28cryptography%29)，这将增加您的消息摘要的熵。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-13T21:42:06.167

这些都不能避免哈希冲突。

当您有一个算法生成特定大小的散列时，就会发生散列冲突，而不管起始值如何。

哈希冲突是指两个不同的值，例如“mypassword”和“dsjakfuiUIs2kh-1jlks”，由于对它们执行的数学运算而最终生成*相同的哈希。*

您无法编写代码来防止哈希冲突，这种情况发生的频率取决于您使用的哈希算法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-13T21:42:08.293

只需 sha1() 整个文件路径，而不仅仅是文件名。文件名 xy.png 只能是目录中的一个，因此您的哈希对于该文件名将是唯一的。此外，这样做的好处是你不会有重复的文件（而使用 rand()/microtime() 你可以在同一个目录中获得同一个文件 10 次，如果它是一个 1GB 的文件可能会导致问题）

# jquery-ui - 使用插件的自定义事件方法的语法

> ID：15993218
> 
> 赞同：1
> 
> 时间：2013-04-13T21:38:31.947
> 
> 标签：jquery-ui, jquery-plugins, click, jquery

当插件/小部件需要使用自定义“事件”方法而不是标准 jQuery 事件时，我无法确定要使用的正确语法。

[jQuery UI MultiSelect Widget](http://www.erichynds.com/blog/jquery-ui-multiselect-widget)不支持该方法`change`，而是提供了一个`click`在选中或取消选中复选框时触发的事件。我正在尝试使用小部件文档中为`click`事件提供的语法，以便我可以替换几个更改函数，包括下面显示的函数，但我无法找出正确的语法。该`click`事件的结构是：

```
$("[name=Item]").on("multiselectclick", function (event, ui) {...}); 
```

我试过在大括号之间插入函数，我也试过`.on("multiselectclick", function () {...});`没有成功，所以我假设我需要在这里插入一些东西：`(event, ui)`

我已经设法通过使用稍微不同的方法使功能部分工作`$("[name=Item]").multiselect({ click: function (event, ui) {...}`，但我真的很想了解如何使用插件的自定义事件，以便让功能正常工作。我在这里发布了一个非常简单的例子[http://jsfiddle.net/chayacooper/cZRy9/5/](http://jsfiddle.net/chayacooper/cZRy9/5/)的小提琴，并附上了说明什么不正常工作的注释。

我试图`change`用小部件的`click`事件替换事件的功能之一：

```
$("[name=Item]").change(function(){
    $("#Styles1, #Styles2").hide();
    $(".accordion").accordion("option", "active", false);
    if( $("[name=Item]").val() === "Dresses"){
        $("#Styles1").show();
        $(".accordion").accordion("option", "active", 0);
        $('varItem').val('Dresses');
    }
    else {...} 
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T22:24:00.857

`Styles`关于未选中时不隐藏元素的第一个问题`dresses`很简单。代码中没有任何内容可以检查复选框的状态，只有值

修复：

```
if ((ui.value) === "Dresses" && ui.checked) 
```

在 jQuery UI 模式化小部件中使用`ui`对象通常是数据或状态的最佳来源，而不是使用 jQuery 选择器来查找相同的东西。

我从来没有使用过这个插件，所以为了弄清楚我可以使用什么，我只是`console.log(ui)`在点击处理程序中使用，这样我就可以检查`ui`对象以查看它包含哪些属性，并找到`checked`要添加到上述`if`条件的属性

如果您在更复杂的小部件（如 jQueryUI 日期选择器）上执行相同操作，将会看到相当多的`ui`属性，其中一些也是方法函数

DEMO（使用自定义事件）

[http://jsfiddle.net/cZRy9/2/](http://jsfiddle.net/cZRy9/2/)

# linq - LINQ 错误聚合操作中不支持该类型

> ID：15993224
> 
> 赞同：0
> 
> 时间：2013-04-13T21:39:14.633
> 
> 标签：linq

我有 LINQ 代码，但收到以下错误：`System.ServiceModel.FaultException: The type 'ObjectMgmt' is not supported in aggregation operations.`

```
(from cinnost in edc.CinnostSOPs
 where cinnost.LegislativneVyznamna == true &&
       cinnost.ObjektId == objektid
 select (from o in edc.PlanRealizaces
         where o.CinnostSOPIdSOP == cinnost.IdSOP &&
               o.DatumPlatnosti <= DateTime.Now &&
               o.Provest == true &&
               o.DatumProvedeni == null
         orderby o.DatumPlatnosti descending
         select new ObjectMgmt
         {
             Datum = (DateTime.Now.Date - o.DatumPlatnosti.Value).TotalDays
         }).Max(m => m)).ToList<ObjectMgmt>(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T21:53:04.700

该消息谈到聚合。我看到的唯一聚合是`Max`调用。这是调试问题所需的提示。

您关心计算一系列`ObjectMgmt`实例的最大值，这显然是不可能的。把它改成你真正的意思。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T23:23:57.323

您得到的编译器错误告诉您`ObjectMgmt`不能用作聚合的来源。发生这种情况是因为`Max`需要`ObjectMgmt`类型实现`IComparable`。

在格式化查询以使其更具可读性之后，您似乎想要找到具有最大值的`ObjectMgmt`实例。`Datum`

由于您已经对值进行了降序排序，因此`DatumPlatnosti`您知道`ObjectMgmt`实例是按`Datum`值递增排序的。因此，您根本不需要聚合。只需取序列的最后一个元素（但是我会按升序排序，然后取第一个元素）。

```
(from cinnost in edc.CinnostSOPs
 where cinnost.LegislativneVyznamna == true &&
       cinnost.ObjektId == objektid
 select (from o in edc.PlanRealizaces
         where o.CinnostSOPIdSOP == cinnost.IdSOP &&
               o.DatumPlatnosti <= DateTime.Now &&
               o.Provest == true &&
               o.DatumProvedeni == null
         orderby o.DatumPlatnosti
         select new ObjectMgmt
         {
             Datum = (DateTime.Now.Date - o.DatumPlatnosti.Value).TotalDays
         }).First()).ToList<ObjectMgmt>(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-14T07:27:56.007

Because your `ObjectMgmt` objects have only one property filled by query: `Datum`, change your `Max` call to get max of `Datum`, not the `ObjectMgmt` itself:

```
(from cinnost in edc.CinnostSOPs
 where cinnost.LegislativneVyznamna == true &&
       cinnost.ObjektId == objektid
 select (from o in edc.PlanRealizaces
         where o.CinnostSOPIdSOP == cinnost.IdSOP &&
               o.DatumPlatnosti <= DateTime.Now &&
               o.Provest == true &&
               o.DatumProvedeni == null
         orderby o.DatumPlatnosti descending
         select new ObjectMgmt
         {
             Datum = (DateTime.Now.Date - o.DatumPlatnosti.Value).TotalDays
         }).Max(m => m.Datum)).ToList<ObjectMgmt>(); 
```

# c# - Windows 表达式编码器 ScreenCaptureJob 问题

> ID：15993227
> 
> 赞同：0
> 
> 时间：2013-04-13T21:40:00.390
> 
> 标签：c#, screen-capture, expression-encoder, expression-encoder-sdk, expression-encoder-4

嗯，这很简单。当我尝试创建一个新的`ScreenCaptureJob`：

```
job = new ScreenCaptureJob(); 
```

它表示当前上下文中不存在名称“工作”。

我已经进口`Microsoft.Expression.Encoder.ScreenCapture`了，所以我不知道它可能是什么。

如果有人有任何想法，那就太好了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-25T23:55:52.677

简单地写：

```
ScreenCaptureJob job = new ScreenCaptureJob(); 
```

# algorithm - 调度算法最短作业优先

> ID：15993229
> 
> 赞同：0
> 
> 时间：2013-04-13T21:40:23.490
> 
> 标签：algorithm, cpu, scheduling

我正在尝试了解最短作业优先算法的工作原理，我是否以正确的方式这样做，请帮助

```
Proc     Burst1    Burst2
+------+---------+--------+
|  A   |   10    |   5    |
|  B   |   3     |   9    |
|  C   |   8     |   11   |
+------+---------+--------+

B1->3->C1->11->B2->20->A1->30->A2->35->C2->46 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T19:39:38.860

“最短作业优先”实际上并不是一种算法，而是一种策略：在准备执行的作业中，总是选择执行时间最短的作业。你的序列看起来不错。一开始，以下作业已准备好执行（括号中为执行时间）：

```
A1(10), B1(3), C1(8) 
```

所以`B1`选择了，之后作业`B2`也准备好执行，所以这里是准备好的作业的更新列表：

```
A1(10), B2(9), C1(8) 
```

现在`C1`被选中，依此类推。

“最短作业优先”策略有多种变体，其中考虑了所有突发事件的总时间，即`A1 + A2`, `B1 + B2`, ...。那么选择的序列将是：

```
B1, B2, A1, A2, C1, C2 
```

# android - Android 应用程序开发：带有动作监听器的多个切换按钮

> ID：15993230
> 
> 赞同：1
> 
> 时间：2013-04-13T21:40:35.177
> 
> 标签：android, togglebutton

我正在尝试创建一个带有多个切换按钮的 android 应用程序。每个 ToggleButton 有两种状态。开或关，最初所有按钮都设置为默认值，即关。

我必须听取用户操作并采取相应的行动。如何使用多个切换按钮执行此操作。

切换按钮被安排通知矩阵，一旦用户单击简单按钮，我想将状态读取到矩阵。

请注意，我是移动应用程序开发的初学者。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-06-21T07:15:49.490

```
@Override
public void onClick(View v) {

    switch (v.getId()) {

        case R.id.toggleOne:
            // In this section u can pass intent , toast[message] on button click.
            break;

        case R.id.toggleTwo:
            // do your code
            break;

        case R.id.toggleThird:
            // do your code
            break;

        default:
            break;
    }

} 
```

你必须实现`onClickListener`接口来覆盖`onClick`方法

# python - 如果 Ri > T 得到验证，则给每个元素 i 添加到列表 L 的机会均等

> ID：15993236
> 
> 赞同：0
> 
> 时间：2013-04-13T21:41:18.630
> 
> 标签：python, algorithm, probability

使用下面的简单算法，如果使用测试`if Ri > T:`，那么我们在 L 中得到或多或少的 30 个元素，在 U 中得到 70 个元素，这是可以的，因为 T 的值设置为 0.7。

现在，如果我想添加一个约束，即：除了放置 L 的元素 i 是那些 Ri > T 的元素之外，我还希望 L 不包含超过 B=20（也就是说，我想要最后，当 i=n 时，L 的大小将或多或少 B=20)。

但问题是，如果我将测试`if Ri > T:`替换`if Ri > T and len(L) < B:`为在 L)。但我希望从 i = 1 到 n 的所有元素都有平等的机会进入 L （而不是只利用第一个元素）。

注意：`Ri > T`不应从我的代码中删除将元素放入 L 的条件。这对我来说很重要：只有在时间 i 时 $Ri$ 高于 T 的元素才允许在 L 中；并且 len(L) 不应超过 B（或多或少）。

```
import random

T = 0.7 # or any value T in ]0,1[
n = 100 # or any value n > B
B = 20 # or any value B < n

L = []
U = []

for i in range(1,n+1):
   xi = input("please give a new data x")
   Ri = 1\. - random.random() # normally it is Ri = 1\. - Proba(xi) depending on xi, but lets simplify using random() ...
   if Ri > T:
      Pay 1 euro and buy yi the label of xi
      L.append((xi, yi))
   else:
      U.append(xi)

print len(L), L
print
print len(U), U 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T00:46:48.867

我倾向于同意这些评论，这些评论表明这并没有像它可能的那样详细说明。但是，如果我没看错，您可以使用一种[水库采样](http://en.wikipedia.org/wiki/Reservoir_sampling)：

```
def some_accept(value_stream, p, max_num_to_accept):
    accepted = []
    passed = (v for v in value_stream if random.random() < p)
    for i, value in enumerate(passed):
        if len(accepted) < max_num_to_accept:
            accepted.append(value)
        else:
            replace_i = random.randint(0, i)
            if replace_i < max_num_to_accept:
                accepted[replace_i] = value
    return accepted 
```

这使

```
>>> some_accept(range(100), 0.7, 10)
[34, 26, 30, 16, 22, 38, 32, 86, 33, 12]
>>> some_accept(range(100), 0.05, 10)
[16, 17, 83, 95] 
```

现在，这可能违反了关于 的“成本”条件`L`，因为我们确实可能“添加”了 10 多个元素，但我认为每次我替换一个元素时，你都必须返还一个硬币。

频率分布的快速健全性检查看起来不错（很容易产生一个错误导致偏差）：

```
import matplotlib.pyplot as plt

fig = plt.figure()
ax = fig.add_subplot(111)
for i in range(100):
    s = sum((Counter(some_accept(range(10), 0.25, 4)) for i in range(10**3)), Counter())
    x, y = zip(*sorted(s.items()))
    ax.plot(x,y)

plt.savefig("test.png") 
```

给

![在此处输入图像描述](https://i.stack.imgur.com/S1tlk.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T00:40:41.627

最简单的解决方案是首先确定要添加元素的列表，方法是选择一个随机数并将其与 B/n 进行比较；然后使用在相关列表范围内的随机值创建项目：

```
for i in range(n):
  rt = random.randint(1,n)
  if (rt <= B):
    r1 = random.uniform(T, 1)
    # add x1 with r1 to L
  else:
    r1 = random.uniform(0, T)
    # add x1 with r1 to U 
```

顺便说一句，`[0, 1)`从 1 中减去范围内的随机数不会反转概率；它仍然有 30% 的可能性`> 0.70`。（它确实将范围更改为`(0, 1]`，但这在大多数情况下并不重要。）我怀疑这不是您想要的，但很难知道；无论如何，我更改了它，以便 70% 的值落入`L`. 根据需要调整上述内容。

# python - Python：Int() Base 10 的无效文字

> ID：15993238
> 
> 赞同：5
> 
> 时间：2013-04-13T21:41:29.507
> 
> 标签：python, literals, base

我正在为一个项目编写代码以确定信用卡的有效性，但我碰壁了，似乎到目前为止我尝试过的所有事情都不起作用。

这给了我一个 sumofodds 函数的错误，其中 j=int(card[i])

错误是“Invalid Literal for Int() with Base 10

有没有人可以给我一些建议？

```
def sumofdoubles():
    card=input()
    x=len(card)
    summ=0

    for i in range(x-2,-1,-2):
        j=int(card[i])
        u=j+j

        if u>9:
            h=u/2
            summ=summ+h

     return(summ)

def sumofevens():
    card=input()
    x=len(card)
    summ=0

    for i in range(x-2,-1,-2):
        j=int(card[i])
        u=j+j
        if u<9:
            summ=summ+u

    return(summ)

def sumofodds():
    summ=0
    card=input()
    x=len(card)

    for i in range(x-1,-1,-2):
        j=int(card[i])
        summ=summ+j

    return(summ)

def main():
    card=input()
    length=len(card)
    summ=0

    while(card!="#####"):
        if (card[0]=='4' or card[0]=='5' or card[0]=='6' or (card[0]=='3' and      card[1]=='1')):
            dbls=sumofdoubles()
            evens=sumofevens()
            odds=sumofodds()
            if((dbls+evens+odds)%10==0):
                print("Valid")

main() 
```

对于那些想知道的人来说，这是完整的追溯

```
 python test.py<s.input
    File "test.py", line 52 in <module>
      main()
    File "test.py", line 48, in main
      odds=sumofodds()
    File "test.py", line 33, in sumofodds
      j=int(card[i])
ValueError: invalid literal for int() with base 10: '#' 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-13T21:47:34.577

好吧，无论你做什么，你都输入了一些实际上不是 Base 10 数字的东西。这包括任何不是数字字符或空格的内容。所以不要输入那个。:-)

例子：

```
>>> int('04.9')
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ValueError: invalid literal for int() with base 10: '04.9'

>>> int('4-')
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ValueError: invalid literal for int() with base 10: '4-'

>>> int("Jack")
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ValueError: invalid literal for int() with base 10: 'Jack' 
```

更新：是的，您输入了“#”。那不是一个有效的数字。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T21:50:57.657

您`input`每次进入`sumofodds`、`sumofevens`或时都会打电话`sumofdoubles`，因此他们每个人都将使用一个单独的信用卡号码。您可能只想调用并且应该作为参数传递`input`给其他每个函数。`main``card`

您的函数可能看起来像这样：

```
def sum_of_odds(card):
    x = len(card)
    # ...

# ...

def main():
    while True:
        card = input()
        if card == '#####':
            break
        odds = sum_of_odds(card)
        # ... 
```

# java - 此代码是传输 1kb 还是以位为单位？有点困惑

> ID：15993241
> 
> 赞同：0
> 
> 时间：2013-04-13T21:41:53.693
> 
> 标签：java, networking, units-of-measurement

我一直在尝试测试网络性能，但有一个问题

```
static public void main(String[] args) 
{
    MPI.Init(args);
    int myrank = MPI.COMM_WORLD.Rank();
    int tag = 99;
    int maxlen = 104857600; 
    int minlen = 1; //1kb ?
    char [] sendbuff = new char [maxlen];
    char [] recvbuff = new char [maxlen];
    long speedKbps;
    long speedMbps;
    if (myrank == 0) 
    {
        for (int len = minlen; len <= maxlen; len *= 2) 
        { //len=*2 doubles the ping size each time
            long startTime = System.nanoTime();                  
            MPI.COMM_WORLD.Send(sendbuff, 0, len, MPI.CHAR, 1, tag);
            MPI.COMM_WORLD.Recv(recvbuff, 0, len, MPI.CHAR, 1, tag);
            long endTime = System.nanoTime();
            long duration = endTime - startTime;
            System.out.println("Time for the ping to be sent and recived of " + len + " kb is " + duration + " nanoseconds");
            double transferRate = (len/ duration ) ; //amount of data in kilobytes transferred in 1 second
            System.out.println("transferRate: " + transferRate + "KB per second");
        }
    }
} 
```

，这`minlen = 1`是什么大小，是 1 KB，1 位，1 字节吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T21:46:04.633

由于您的发送缓冲区使用 char 作为数据类型，因此它是字节。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T21:49:26.230

由于您是从字符数组发送项目，因此循环的每次迭代中的 len 是要发送的字符数。所以 minlen=1 的大小是 1 个字符的大小，在 Java 中是 2 个字节。

[Java char 大小的来源](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/datatypes.html)

# android - 当您已经有选项卡和菜单时，将“添加按钮”添加到顶部的操作栏

> ID：15993247
> 
> 赞同：5
> 
> 时间：2013-04-13T21:43:16.387
> 
> 标签：android, android-fragments, android-actionbar, drawable

我正在尝试在操作栏的顶部添加一个“添加项目”按钮。（在应用程序图标和标题的右侧）。

在操作栏的正下方，我有两个可以在它们之间滑动的选项卡。我还为设置菜单定义了一个菜单 XML 文件。

我认为操作栏也使用菜单 XML。所以我添加了一个操作栏菜单 XML，但是当我使用

```
actionBar.setDisplayOptions(ActionBar.DISPLAY_SHOW_HOME | ActionBar.DISPLAY_SHOW_TITLE | ActionBar.DISPLAY_SHOW_CUSTOM);
actionbar.setCustomView(R.menu.actionbar); 
```

我的程序崩溃了。我相信我这样做完全不正确。

我的操作栏 XML：

```
<?xml version="1.0" encoding="utf-8"?>
<menu xmlns:android="http://schemas.android.com/apk/res/android" >
    <item android:id="@+id/item1" android:icon="@android:drawable/ic_menu_add"></item>

</menu> 
```

我阅读了一些教程，我应该将项目添加到操作栏并通过 mainActivity 中的 OnCreateOptionsMenu 函数填充它。但这就是填充我的选项菜单的地方，而不是我的操作栏。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-13T21:51:32.673

活动在其 onCreateOptionsMenu() 方法中填充 ActionBar。

而不是使用 setcustomview()，只需像这样覆盖 onCreateOptionsMenu

```
@Override
public boolean onCreateOptionsMenu(Menu menu){
    MenuInflater inflater = getMenuInflater();
    inflater.inflate(R.menu.mainmenu, menu);

   return true;
} 
```

如果选择了 ActionBar 中的操作，则调用 onOptionsItemSelected() 方法。它接收选定的动作作为参数。根据此信息，您的代码可以决定要执行的操作，例如：

```
@Override
public boolean onOptionsItemSelected(MenuItem item) {
    switch (item.getItemId()) {
        case R.id.menuitem1:
           Toast.makeText(this,"Menu Item 1 selected",Toast.LENGTH_SHORT).show();
           break;
        case R.id.menuitem2:
           Toast.makeText(this,"Menu item 2 selected",Toast.LENGTH_SHORT).show();
           break;
        default:
           break;
    }

    return true;
} 
```

# c++ - 使用主要是 NaN 创建 NetCDF 文件

> ID：15993248
> 
> 赞同：1
> 
> 时间：2013-04-13T21:43:20.060
> 
> 标签：c++, netcdf

我正在创建一个主要包含 NaN 值的 NetCDF 文件。有没有办法可以指定它被压缩而不是占用大量磁盘空间？我正在使用 University Corporation for Atmospheric Research C++ NetCDF 库。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T20:42:07.373

是的，但这取决于您使用的 netCDF C++ API、旧版 (netcdf-cxx-4.2) C++ API 还是较新的 netcdf-cxx4-4.2 C++ API。

[使用此处](http://www.unidata.ucar.edu/netcdf/docs/cxx4/)记录的 netCDF-4 C++ 库，只需使用 NcVar::setCompression 方法。

使用遗留的 netCDF-3 C++ 库，没有 C++ 方法可以直接执行您想要的操作。但是该库是作为 netCDF C 库之上的一个薄层实现的，因此通过添加一个通过调用 C 函数 nc_def_var_deflate 设置压缩级别的 NcVar 构造函数，它应该相当简单。当然，您必须确保构建您的旧 C++ 库以使用以前安装的 netCDF-4 库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-01-24T10:19:04.677

显然，最好在创建时生成 netcdf4 压缩文件，但我只想补充一点，如果已经编写了以未压缩方式生成文件的代码，则可以在现有文件上使用 CDO 转换为 netcdf4 约定和同时压缩：

```
cdo -f nc4c -z zip_9 copy in.nc out.nc 
```

# java - Minesweeper 实现输出似乎没问题，但未通过 UVa Judge 测试

> ID：15993250
> 
> 赞同：1
> 
> 时间：2013-04-13T21:43:44.737
> 
> 标签：java

输入

输入将由任意数量的字段组成。每个字段的第一行包含两个整数 n 和 m (0 < n,m <= 100)，分别代表字段的行数和列数。接下来的 n 行正好包含 m 个字符并代表该字段。每个安全方块都用一个“.”表示。字符（不带引号），每个地雷方块由“*”字符表示（也不带引号）。n = m = 0 的第一条场线表示输入结束，不应处理。

输出

对于每个字段，您必须单独在一行中打印以下消息：

字段 #x：其中 x 代表字段的编号（从 1 开始）。接下来的 n 行应包含带有“.”的字段。字符替换为该方格的相邻地雷数。字段输出之间必须有一个空行。

样本输入

```
4 4

*...

....

.*..

....

3 5

**...

.....

.*...

0 0 
```

样本输出

```
Field #1:

*100

2210

1*10

1110

Field #2:

**100

33200

1*100 
```

我得到给定输入的正确输出。

```
import java.util.*;

public class Main{

    public static void main(String[] args) {
        //field size
        int n, m;
        //string to hold a row of a minesweeper board
        String line;
        //array to hold all the minesweeper boards entered
        ArrayList<char[][]> allBoards = new ArrayList<char[][]>();

        Scanner scan = new Scanner(System.in);

        //get the field size
        n = scan.nextInt();
        m = scan.nextInt();

        //keep going until n=0 and m=0
        while ((n+m)!=0) {

            //create the minesweeper board
            //the field sizes are 2 spaces bigger to prevent error checking 
            //at the edges of the minesweeper board            
            char[][] board = new char[n + 2][m + 2];

            //fill the appropriate spaces with the mines '*' and blank spaces '.'
            for (int row = 1; row < board.length - 1; row++) {
                line = scan.next();
                for (int col = 1; col < board[0].length - 1; col++) {
                    board[row][col] = line.charAt(col - 1);
                }
            }

            //add the current minesweeper board to the array
            allBoards.add(board);

            //get new field size
            n = scan.nextInt();
            m = scan.nextInt();
        }

        printResults(allBoards);
    }

    //function to find out how many mines are around a certain position
    //check all positions surrounding the current one.
    public static int getMines(char[][] board, int row, int col) {
        int nMines = 0;

        if (board[row - 1][col - 1] == '*') {
            nMines++;
        }

        if (board[row - 1][col] == '*') {
            nMines++;
        }

        if (board[row - 1][col + 1] == '*') {
            nMines++;
        }

        if (board[row][col - 1] == '*') {
            nMines++;
        }

        if (board[row][col + 1] == '*') {
            nMines++;
        }

        if (board[row + 1][col - 1] == '*') {
            nMines++;
        }

        if (board[row + 1][col] == '*') {
            nMines++;
        }

        if (board[row + 1][col + 1] == '*') {
            nMines++;
        }

        return nMines;
    }

    //print the results
    private static void printResults(ArrayList<char[][]> allBoards) {
        for (int i = 1; i <= allBoards.size(); i++) {
            System.out.println("Field #" + i + ":");
            for (int row = 1; row < allBoards.get(i - 1).length - 1; row++) {
                for (int col = 1; col < allBoards.get(i - 1)[0].length - 1; col++) {
                    if (allBoards.get(i - 1)[row][col] != '*') {
                        System.out.print(getMines(allBoards.get(i - 1), row, col));
                    } else {
                        System.out.print("*");
                    }
                }
                System.out.println();
            }
            System.out.println();
        }
    }
} 
```

# c - C：如何将一个字符添加到另一个字符/字符集？

> ID：15993252
> 
> 赞同：0
> 
> 时间：2013-04-13T21:43:53.077
> 
> 标签：c

假设我有一个值为 42 (*) 的字符。我需要在 n 行中打印此字符，其中 n 由用户定义。但是，对于每行移位，必须打印另一个 *。如果用户输入“6”，那么结果将是这样的：

```
*
**
***
****
*****
****** 
```

我正在考虑让程序重复打印并跳转一行 n 次，在每个循环结束时将另一个 * 添加到 char 中。是否有任何命令可以将 * 变成 ** 然后变成***等等？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-13T21:47:38.393

您不需要进行任何字符串操作。对于每一行，如果行号是`i`，只需打印一个星号（带`putchar()`或类似）`i`次，然后是换行符。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-13T21:51:44.650

为此，您可以使用嵌套的 for 循环...

```
for(i=0;i<n;i++)     //n is your user value
{
    for(j=0;j<=i;j++)
         {
          printf("%c",your_char);     //print char here
         }
    printf("\n");                    //for going to next line
} 
```

顶部`for`循环将处理行，而内部`for`循环将处理列...

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-13T21:55:35.737

尝试这个：

```
 void print_n_chars(char c, size_t count)
 {
     char *buffer;
     size_t i;

     buffer = malloc(count + 1);
     memset(buffer, 0, count + 1);

     for (i = 0; i < count; i++)
     {
         buffer[i] = c;

         printf("%s\n", buffer);
     }

     free(buffer);
 } 
```

该算法具有`O(n)`性能，优于`O(n^2/2)`两个循环。

编辑：固定名称错字，添加性能评论

# java - JAXB - 未创建 XML 声明

> ID：15993256
> 
> 赞同：0
> 
> 时间：2013-04-13T21:44:17.067
> 
> 标签：java, xml, jaxb

我正在使用以下代码使用 JAXB 创建 XML，但是在创建 XML 时不包含 XML 声明。

代码：

```
ServletContext ctx = getServletContext();
            String filePath = ctx.getRealPath("/xml/"+username + ".xml");

            File file = new File(filePath);
            JAXBContext context= JAXBContext.newInstance("com.q1labs.qa.xmlgenerator.model.generatedxmlclasses");
            Marshaller jaxbMarshaller = context.createMarshaller();

            jaxbMarshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, true);
            OutputStream os = new FileOutputStream(file);
            jaxbMarshaller.marshal(test, os);

            response.setContentType("text/plain");
            response.setHeader("Content-Disposition",
                             "attachment;filename=xmlTest.xml");

            InputStream is = ctx.getResourceAsStream("/xml/"+username + ".xml"); 
```

XML 声明：

`<?xml version="1.0" encoding="ISO-8859-1"?>`

如何让它输出 XML 声明？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T22:27:01.107

您不需要写入文件，您可以像这样在内存中执行它：

```
...
ByteArrayOutputStream os = new ByteArrayOutputStream();
jaxbMarshaller.marshal(test, os);

StringBuffer content = new StringBuffer("<?xml version=\"1.0\" encoding=\"ISO-8859-1\"?>");
content.append(os.toString());
System.out.println("jaxb xml = " + os.toString());

response.setContentType("text/plain");
response.setHeader("Content-Disposition", "attachment;filename=xmlTest.xml");

String generatedXML = content.toString();
System.out.println("full xml = " + generatedXML);
InputStream is = new ByteArrayInputStream(generatedXML);

final int bufferSize = 4096;
OutputStream output = new BufferedOutputStream(response.getOutputStream(), bufferSize);
for (int length = 0; (length = is.read(buffer)) > 0;) {
  output.write(buffer, 0, length);
}
output.flush();
output.close(); 
```

顺便说一句，您应该考虑使用 UTF-8。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-14T13:53:15.827

[这个问题在这里](https://stackoverflow.com/questions/277996/jaxb-remove-standalone-yes-from-generated-xml)得到了很好的回答

总而言之，您需要做的就是：

```
marshaller.setProperty(Marshaller.JAXB_FRAGMENT, Boolean.FALSE); 
```

# excel - 在单元格公式中使用 vba 函数

> ID：15993258
> 
> 赞同：2
> 
> 时间：2013-04-13T21:44:18.183
> 
> 标签：excel, vba

我需要对两个值进行四舍五入然后对它们求和。问题是，我有**捷克文版的 MS Excel**，舍入函数叫做“ **Zaokrouhlit** ”

![在此处输入图像描述](https://i.stack.imgur.com/jvWrX.png)

所以我的公式看起来像`=ZAOKROUHLIT(A1, 2) + ZAOKROUHLIT(A2, 2)`

现在我在想，如果我将文件发送给使用不同语言版本的 excel 的人，它会起作用吗？

所以我尝试了*默认*功能`=ROUND(A1, 2) + ROUND(A2, 2)`

![在此处输入图像描述](https://i.stack.imgur.com/xn4g6.gif)

但是我的excel版本对这样的功能一无所知。

幸运的是，我可以在 VBA 子程序中使用这个函数，所以我的问题是：
**如何在公式中使用 VBA 函数？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T21:52:39.467

尝试以下本地化解决方案：

[VanTed Bits：Excel VBA 提示：在本地语言和英语之间翻译公式](http://vantedbits.blogspot.nl/2010/10/excel-vba-tip-translate-formulas.html)

[excel-macro-inserting-internationally-valid-formula-during-run-time](https://stackoverflow.com/questions/13247771/excel-macro-inserting-internationally-valid-formula-during-run-time)

有几个答案，它们之间应该可以帮助你

# c# - ServiceStack.Text 和 ISODate("")

> ID：15993259
> 
> 赞同：6
> 
> 时间：2013-04-13T21:44:23.457
> 
> 标签：c#, json, deserialization, servicestack

为什么 ServiceStack.Text DeserializeFromString 不能转换 ISODate 格式。

例如，我有类似的 json 字符串

```
{ "Count" : 4, "Type" : 1, "Date" : ISODate("2013-04-12T00:00:00Z") } 
```

和班级

```
public class TestClass
{
    public int Count { get; set; }
    public int Type { get; set; }
    public DateTime Date { get; set; }
} 
```

当我尝试从字符串反序列化时

```
JsonSerializer.DeserializeFromString<TestClass>(json); 
```

给我输出 ![在此处输入图像描述](https://i.stack.imgur.com/ws6U9.png)

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-06-18T22:14:20.723

ServiceStack.Text 也理解 ISO8601。

您可以将其配置为默认行为：

```
JsConfig.DateHandler = JsonDateHandler.ISO8601; 
```

有关更多信息，请参阅[此答案](https://stackoverflow.com/a/11887560/6884)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T21:55:33.660

`JSON`期望这样的日期格式

```
"LastRequestTime":"\/Date(928129800000+0530)\/" 
```

因此，更改`Json`字符串中的日期值，然后尝试。它将正确反序列化该属性。

# interface - 公开协议缓冲区接口

> ID：15993262
> 
> 赞同：5
> 
> 时间：2013-04-13T21:44:47.677
> 
> 标签：interface, protocol-buffers

我正在构建一个分布式系统，该系统由具有由 protobuf 消息定义的接口的模块/应用程序组成。

将这些 protobuf 消息直接公开给客户端是个好主意吗？...或者最好准备一个共享库，该库负责将基于方法的接口转换为基于每个模块的 protobuf，并且客户端根本不知道 protobuf？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-13T21:48:43.913

这既不是“好主意”也不是坏主意。这取决于您是否*要将*协议缓冲区强加给您的消费者。该决定的很大一部分是：

*   你的消费者是谁？你介意向他们公开 protobuf 的细节吗？
*   客户端会用支持 protobuf 的语言编写吗？

我的 0.02 美元是协议缓冲区的完美用例，因为它们是专门为跨系统、跨语言交换而设计的。该`.proto`文件对数据格式进行了简洁、独立于语言的全面描述。当然，如果您决定走这条路，还有其他类似/竞争格式和库可供考虑（请参阅： [Thrift](http://thrift.apache.org/)、[Cap'n Proto](http://kentonv.github.io/capnproto/)等） [。](https://code.google.com/p/thrift-protobuf-compare/wiki/Benchmarking)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T07:59:14.073

如果您计划定义将 Google Protobuf 消息类作为参数的接口，而不是根据Google 的 Protobuf 文档中的[这个](http://code.google.com/p/protobuf/source/browse/tags/2.5.0/README.txt#123)和[那个](http://code.google.com/p/protobuf/source/browse/tags/2.5.0/vsprojects/readme.txt#28)部分，直接向客户端公开 Protobuf 消息不是一个好主意。简而言之，对于每个版本的 Protobuf，生成的代码都可能与旧代码不兼容。所以不要这样做！

但是，如果您打算定义将包含序列化 Protobuf 消息的字节数组作为函数/方法参数的接口，那么我完全同意 Matt Ball 的[回答](https://stackoverflow.com/a/15993288/721095)。

# drupal - Drupal：如何覆盖一个特定论坛术语的高级论坛主题列表

> ID：15993265
> 
> 赞同：0
> 
> 时间：2013-04-13T21:45:19.010
> 
> 标签：drupal

我正在使用 Drupal 7，并安装了高级论坛模块。

但是，我想在论坛的一个版块中展示一些 Ubercart 产品，称为 Marketplace 以使它们更加可见，因为用户将能够添加自己的产品。

但是，显然在本节中我想以不同的方式显示论坛主题列表，包括价格和其他此类字段。

有没有一种简单的方法可以做到这一点，也许是使用视图？我真的不知道该怎么办。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-29T05:03:06.427

首先，您应该通过创建一个新页面来覆盖一个特定术语的页面模板，如下所示：

```
page__forum_TERMID 
```

要详细了解您需要在此自定义页面中显示的内容，您可能需要安装[Devel](http://drupal.org/project/devel) & [Theme Developer](http://drupal.org/project/devel_themer)模块。

使用 Theme developer，您将能够检查页面各个部分的 Drupal 输出，以找出它来自哪个预处理函数或哪个模板。

使用 Devel，您将能够输出一些您可能需要对其进行操作的变量，以生成您的自定义布局。

我建议您查看 [高级论坛更多样式](http://drupal.org/project/advanced_forum_more_styles) 的实现，以了解如何创建自己的高级论坛样式，这基本上意味着一个文件夹，其中您可以存储将覆盖高级论坛模板的各种自定义模板。

最近，我做了一些类似于你想要实现的事情，我创建了一个自定义模块来保存各种预处理函数，并且该模块包含一个样式文件夹，声明如下：

```
功能 YOURMODULENAME_ctools_plugin_directory($module, $plugin) {
  if ($module == 'advanced_forum') {
    返回“样式”；
  }
}

```

如果您查看 AF 模块中的样式，您会发现它们只覆盖了几个模板，因此您可能必须在基本样式（例如“Naked”样式）中找到您要查找的模板。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T17:11:27.893

您应该能够只创建一个带有页面显示的新视图，该视图显示您想要的内容，然后将视图的 URL 设置为当前用于您要覆盖的论坛列表的 URL，以便无需任何额外工作，指向它的链接仍然有效。

# javascript - google drive api，javascript列表文件不返回任何内容

> ID：15993268
> 
> 赞同：4
> 
> 时间：2013-04-13T21:45:43.683
> 
> 标签：javascript, google-drive-api

我刚刚开始使用 Drive API 调用，我正在尝试列出我的文件。

到目前为止，我的函数如下所示：

```
 var retrieveAllFiles = function () {
            var retrievePageOfFiles = function(request, result) {
                request.execute(function(resp) {
                    console.log(resp);
                    result = result.concat(resp.items);
                    var nextPageToken = resp.nextPageToken;
                    console.log("nextPageToken ="+nextPageToken);
                    if (nextPageToken) {
                        request = gapi.client.drive.files.list({'pageToken': nextPageToken});
                        retrievePageOfFiles(request, result);
                    } else {
                        printFileList(result);
                    }
                });
            }
        var initialRequest = gapi.client.drive.files.list({'maxResults': 10});
        console.log("initialRequest = "+initialRequest);
         retrievePageOfFiles(initialRequest, []);
        } 
```

在 firebug 中，我看到响应如下所示：

```
[
 {
  "id": "gapiRpc",
  "result": {
  "kind": "drive#fileList",
  "etag": "\"vGmlhiWxP02tugPmRvLynwC_A0Y/vyGp6PvFo4RvsFtPoIWeCReyIC8\""
  }
 }
] 
```

这不是我所期望的，因为我的云端硬盘包含两个文件。

谁能指出我的错误是什么？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-13T22:44:36.257

我自己解决了这个问题，这是范围的问题。

我正在使用

[https://www.googleapis.com/auth/drive.file](https://www.googleapis.com/auth/drive.file)

但这仅授予对使用发出请求的应用程序创建的文件的访问权限。要访问我必须添加的所有文件

[https://www.googleapis.com/auth/drive](https://www.googleapis.com/auth/drive)

我只是通过使用另一个应用程序才发现它并注意到它要求不同的范围。

# html - html 复选框通过电子邮件发送

> ID：15993276
> 
> 赞同：-1
> 
> 时间：2013-04-13T21:46:49.983
> 
> 标签：html, email, checkbox, html-email, checklistbox

我是 HTML 新手，我正在尝试创建一些预填充的复选框项目（一些是自定义文本，即输入您自己的值的输入框），以便用户输入数据并检查列表。本质上，我正在创建类似于 TO-DO-LIST 的东西。

我不知道如何添加两件事：

1.  用户能够保存表单、导航到其他地方并返回继续
2.  用户能够以包含其复选框值的格式通过电子邮件发送完成的表单。

有人可以帮忙吗！

早间清单

## 早间清单

*   醒来
*   刷牙
*   呜呜呜
*   ## 通过电子邮件发送

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T22:14:12.607

在这里阅读[http://www.w3schools.com/php/php_mail.asp](http://www.w3schools.com/php/php_mail.asp)。您需要一个 PHP 脚本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T10:32:54.590

只需一些 HTML 和 JavaScript 即可完成您的任务。[jQuery](http://jquery.com/)和[Sisyphus](https://github.com/simsalabim/sisyphus) JavaScript 库在这里为您提供帮助。[使用普通的 html/javascript 发送邮件](https://stackoverflow.com/questions/271171/sending-emails-with-javascript)非常容易。

我将一些示例 HTML 放在一起（它比我想象的要广泛一些，但你已经有了）：

```
<!DOCTYPE html>
<html>
  <head>
    <script type='text/javascript' src='http://code.jquery.com/jquery-1.9.1.js'></script>
    <script type='text/javascript' src='http://sisyphus-js.herokuapp.com/assets/application-09059f9f54cc3c3bff98487cf866644b.js'></script>
    <script type='text/javascript'>
      function sendMail() {
        var mailbody = "My Checklist: \n\n"
                       + $('input[type="checkbox"]').map(
                            function(id, box){ return (box.checked ? "[x]" : "[ ]") + " " + box.name;}
                          ).get().join("\n");
        var link = "mailto:me@example.com"
                    + "?cc=myCCaddress@example.com"
                    + "&subject=" + escape("This is my subject")
                    + "&body=" + escape(mailbody);
        window.location.href = link;
      }

      $(function(){
        $( "#checklist" ).sisyphus();
      });
    </script>
  </head>
  <body>
    <form id="checklist">
      <label><input type="checkbox" name="buy" />Buy some tee</label><br />
      <label><input type="checkbox" name="brew" />Brew the tee</label><br />
      <label><input type="checkbox" name="drink" />Drink tee</label><br />
      <button onclick="sendMail(); return false">Send Mail</button>
  </form>
  </body>
</html> 
```

Sisyphus 是一个将表单数据保存在浏览器本地存储中的库。这样，您可以离开页面，稍后再回来，仍然保留您的表单值（如果您在同一台计算机上使用相同的浏览器返回）。

该`sendMail()`函数构建了一个 mailto 链接，该链接打开您的本地电子邮件客户端，其中包含准备发送的新邮件。

编辑：缩短的示例代码

# objective-c - 基于文档的 OSX 应用程序 - 打开文档的数量限制为一个

> ID：15993277
> 
> 赞同：0
> 
> 时间：2013-04-13T21:46:56.297
> 
> 标签：objective-c, macos, cocoa, nsdocument

我试图弄清楚如何将基于 NSDocument 的应用程序一次限制为一个打开的文档。它很快变得一团糟。

有没有人能够以简单可靠的方式做到这一点？

////EDIT//// 我希望能够提示用户保存现有的打开文档并在创建/打开新文档之前将其关闭。

////EDIT 2 如果有任何文档正在打开，我现在正试图返回一个带有适当消息的错误——但是，错误消息没有显示我的 NSLocalizedKeyDescription。这是在我的 NSDocumentController 子类中。

```
-(id)openUntitledDocumentAndDisplay:(BOOL)displayDocument error:(NSError **)outError{

if([self.documents count]){

    NSMutableDictionary* dict = [NSMutableDictionary dictionaryWithObject:@"Only one document can be open at a time. Please close your document." forKey:NSLocalizedDescriptionKey];

    *outError = [NSError errorWithDomain:@"Error" code:192 userInfo:dict];

    return nil;
}
return     [super openUntitledDocumentAndDisplay:displayDocument error:outError];
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-13T22:03:34.287

这不是一个简单的解决方案，因为它是一个非常复杂的类，但我建议你继承`NSDocumentController`并注册你自己的子类，这会禁止打开超过一定数量的文档。这将允许您通过将文件放在 Dock 中的应用程序图标上或在 finder 中打开来防止打开文件之类的事情，这两者都绕过了`Open`菜单项。

您仍然需要覆盖 GUI/菜单激活码，以防止`Open...`在您已经打开文档时可用，但这只是为了确保您不会混淆用户。

您的文档控制器需要在任何其他文档控制器之前创建，但这很容易通过`DocumentController`在您的实例中放置一个实例`MainMenu.xib`并确保将类设置为您的子类。（这将导致它调用`-sharedDocumentController`，这将创建您的实例。）

然后，在您的文档控制器中，您将需要覆盖：

```
- makeDocumentForURL:withContentsOfURL:ofType:error:
- makeUntitledDocumentOfType:error:
- makeDocumentWithContentsOfURL:ofType:error: 
```

检查并查看文档是否已打开并返回 nil，将错误指针设置为显示适当消息的新创建的错误 ( `NSLocalizedDescriptionKey`)。

那应该处理拖放，applescript等的情况。

**编辑** 至于您对开幕事件的关闭/保存提示的附加请求，这是一个更棘手的问题。你可以：

1.  保存信息（基本上是`make`请求的参数）
2.  将`-closeAllDocumentsWithDelegate:didCloseAllSelector:contextInfo:`with`self`作为委托发送，将新创建的例程作为选择器发送
3.  当您收到选择器时，要么清除保存的参数，要么使用保存的参数重新执行命令。

请注意，第 2 步和第 3 步可能需要延迟完成`performSelector`

我自己没有尝试过这个（我之前做过的其余部分），但它似乎应该工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T16:43:51.887

这是我最终得到的解决方案。所有这些都在 NSDocumentController 子类中。

```
- (NSInteger)runModalOpenPanel:(NSOpenPanel *)openPanel forTypes:(NSArray *)extensions{

    [openPanel setAllowsMultipleSelection:NO];

    return [super runModalOpenPanel:openPanel forTypes:extensions];
}

-(NSUInteger)maximumRecentDocumentCount{
    return 0;
}

-(void)newDocument:(id)sender{

    if ([self.documents count]) {

        [super closeAllDocumentsWithDelegate:self
                         didCloseAllSelector:@selector(newDocument:didCloseAll:contextInfo:) contextInfo:(void*)sender];

    }
    else{
        [super newDocument:sender];
    }
}

- (void)newDocument:(NSDocumentController *)docController  didCloseAll: (BOOL)didCloseAll contextInfo:(void *)contextInfo{

    if([self.documents count])return;

    else [super newDocument:(__bridge id)contextInfo];

}

-(void)openDocument:(id)sender{

    if ([self.documents count]) {

        [super closeAllDocumentsWithDelegate:self
                         didCloseAllSelector:@selector(openDocument:didCloseAll:contextInfo:) contextInfo:(void*)sender];

    }
    else{
        [super openDocument:sender];
    }

}

- (void)openDocument:(NSDocumentController *)docController  didCloseAll: (BOOL)didCloseAll contextInfo:(void *)contextInfo{

    if([self.documents count])return;
    else [super openDocument:(__bridge id)contextInfo];

} 
```

此外，不幸的是，我需要从主菜单中删除“打开最近”选项。我还没有想出如何解决这种情况。

# c# - 在一个视图中编辑/列出多个模型

> ID：15993285
> 
> 赞同：1
> 
> 时间：2013-04-13T21:47:58.677
> 
> 标签：c#, asp.net-mvc-4, ef-code-first, entity-framework-5, viewmodel

我是 MVC 和 EF 世界的新手。我首先使用代码定位 MVC 4 EF 5。

我正在寻找使用一个视图编辑两个相关模型的最佳实践。为简单起见，我有以下两个模型：

```
namespace AddressBook.Models
{
    public class Contact
    {
        public int ID { get; set; }
        public string First_Name { get; set; }
        public string Last_Name { get; set; }
        public List<PhoneNumber> PhoneNumbers { get; set; }
     }
} 
```

和

```
namespace AddressBook.Models
{
    public class PhoneNumber
    {
        public int ID { get; set; }
        public string Number { get; set; }
        public bool Primary { get; set; }
    }
} 
```

具有以下上下文：

```
using System.Data.Entity;
namespace AddressBook.Models
{
    public class DataContext : DbContext
    {
        public DbSet<Contact> Contacts { get; set; }
        public DbSet<PhoneNumber> PhoneNumbers { get; set; }
    }
} 
```

Contact 和 PhoneNumber 之间的关系是一对多的，但是我希望能够在 Primary 设置为 true 时编辑 first_name、last_name 和 Number，因此我们将只编辑每个联系人记录的一个电话号码。

我看过类似的帖子，这些帖子指向使用 ViewModel，但我看到的唯一示例是在传递下拉信息时使用而不是 viewbag。

我想我有几个问题：

1.  ViewModel 会像下面这样吗？

    ```
    public class ContactPrimaryNumberViewModel
    {
        public Contact ContactToEdit {get; set;}
        public PhoneNumber PhoneNumberToEdit {get;set;}
    } 
    ```

2.  编辑（发布）和编辑（获取）会是什么样子？

任何帮助将不胜感激，以帮助我解决这个问题...

如果联系人没有关联的电话号码，这是修改为支持的编辑（获取）

' // GET: /联系人/编辑/5

```
 public ActionResult Edit(int id = 0)
    {
        ContactPrimaryNumberViewModel ContactPrimaryNumber = (from pn in db.PhoneNumbers
                                                              where pn.ContactID == id && pn.Primary == true
                                                              select new ContactPrimaryNumberViewModel { ContactID = pn.ContactID, First_Name = pn.Contact.First_Name, Last_Name = pn.Contact.Last_Name, Number = pn.Number }).SingleOrDefault();

        if (ContactPrimaryNumber == null)
        {
            ContactPrimaryNumber = (from c in db.Contacts
                                                                  where c.ID == id
                                                                  select new ContactPrimaryNumberViewModel { ContactID = c.ID, First_Name = c.First_Name, Last_Name = c.Last_Name, Number = null }).Single();

        }
        return View(ContactPrimaryNumber);
    }' 
```

所以在大家帮助后的最终解决方案是：

型号：

```
 public class PhoneNumber
{
    public int ID { get; set; }
    public string Number { get; set; }
    public bool Primary { get; set; }

    [Required]
    public int ContactID { get; set; }
    public Contact Contact { get; set; }

}

    public class Contact
{
    public int ID { get; set; }
    public string First_Name { get; set; }
    public string Last_Name { get; set; }
    public List<PhoneNumber> PhoneNumbers { get; set; }

} 
```

控制器编辑（获取和发布）

```
 // GET: /Contact/Edit/5

    public ActionResult Edit(int id = 0)
    {

        ContactPrimaryNumberViewModel ContactPrimaryNumber = (from c in db.Contacts
                                                              join pn in db.PhoneNumbers
                                                              on c.ID equals pn.ContactID into outer
                                                              from _pn in outer.Where(p => p.Primary ==true).DefaultIfEmpty()
                                                              where c.ID == id 
                                                              select new ContactPrimaryNumberViewModel { ContactID = c.ID, First_Name = c.First_Name, Last_Name = c.Last_Name, Number = ((_pn == null) ? "" : _pn.Number) }).FirstOrDefault();

        if (ContactPrimaryNumber == null)
        {
            return HttpNotFound();
        }
        return View(ContactPrimaryNumber);
    }

    // POST: /Contact/Edit/5

    [HttpPost]
    public ActionResult Edit(ContactPrimaryNumberViewModel ContactPrimaryNumber)
    {
        Contact c = db.Contacts.Find(ContactPrimaryNumber.ContactID);
        PhoneNumber pn = db.PhoneNumbers.FirstOrDefault(x => x.ContactID == ContactPrimaryNumber.ContactID && x.Primary == true);

        if (ModelState.IsValid)
        {
            c.First_Name = ContactPrimaryNumber.First_Name;
            c.Last_Name = ContactPrimaryNumber.Last_Name;

            if (pn == null) //if there is no phone number associated with the contact in the DB
            {
                if (!String.IsNullOrEmpty(ContactPrimaryNumber.Number))
                {
                    //Add a new phonenumber in the database

                    PhoneNumber Px = new PhoneNumber();

                    Px.ContactID = ContactPrimaryNumber.ContactID;
                    Px.Number = ContactPrimaryNumber.Number;
                    Px.Primary = true;

                    db.PhoneNumbers.Add(Px);

                }

            }
            else //if there is a phone number associated with the contactin the DB
            {
                if (String.IsNullOrEmpty(ContactPrimaryNumber.Number))
                {
                    //delete the existing number
                    db.PhoneNumbers.Remove(pn);

                }
                else
                {
                    //modify the existing number
                    pn.Number = ContactPrimaryNumber.Number;
                }
            }

            db.SaveChanges();
            return RedirectToAction("Index");
        }
        return View(c);
    } 
```

和视图模型

```
 public class ContactPrimaryNumberViewModel
{

    public int ContactID { get; set; }
    public string First_Name { get; set; }
    public string Last_Name { get; set; }
    public string Number { get; set; }

} 
```

再次感谢你的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T00:31:19.720

好的，试试这个：

**电话号码**

```
public class PhoneNumber
{
    [Key]
    [DatabaseGenerated(DatabaseGeneratedOption.Identity)]
    public int Id { get; set; }
    public string Number { get; set; }
    public bool Primary { get; set; }

    [ForeignKey("Contact"), DatabaseGenerated(DatabaseGeneratedOption.None)]
    public int? ContactId { get; set; }

    public virtual Contact Contact { get; set; }
} 
```

**接触**

```
public class Contact
{  
    [Key]
    [DatabaseGenerated(DatabaseGeneratedOption.Identity)]
    public int ContactId { get; set; }
    public string FirstName { get; set; }
    public string LastName { get; set; }
    public List<PhoneNumber> PhoneNumbers { get; set; }
} 
```

**SaveContact**：取决于您如何设置 Repositories 或 Ef 类。这可以进入您的 EfRepository 实现或您的 EfDb 类。

```
public void SavePlayer(Contact contact)
    {
        using (var context = new EfDb())
        {                
            if (contact.ContactId == 0)
            {                    
                context.Contacts.Add(contact);
            }
            else if (contact.ContactId > 0)
            {
                var currentContact = context.Contacts
                    .Include(c => c.PhoneNumber)
                    .Single(c => c.ContactId== contact.ContactId);

                context.Entry(currentContact).CurrentValues.SetValues(contact);
                currentContact.PhoneNumber= contact.PhoneNumber;
            }
            context.SaveChanges();
        }
    } 
```

**编辑操作**

```
 [HttpGet]
    public ActionResult Edit(int id)
    {
        var contact= _dataSource.Contacts.FirstOrDefault(c => c.Id == id);

        return View(player);
    }

    [HttpPost]
    public ActionResult Edit(Contact contact)
    {
        try
        {
            if (ModelState.IsValid)
            {
                _dataSource.SaveContact(contact);
                return RedirectToAction("About", "Home");
            }
        }
        catch (Exception)
        {
            ModelState.AddModelError("", "Unable to save changes. Try again, and if the problem persists, see your system administrator.");
        }            
        return View(contact);
    } 
```

**意见**

在您`Contact View Folder`添加`EditorTemplates folder`. 然后 Scaffold a`Create Strongly Typed PhoneNumber Partial View to this folder`并`PhoneNumber`像它的模型一样命名它。

脚手架一个`Create Strongly Typed Contact View`名字吧`Create`

然后添加`@Html.EditorFor(model => model.PhoneNumber)`到主创建视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T22:18:41.377

我认为您的视图模型应如下所示：

```
public class ContactPrimaryNumberViewModel
{
    public int ID { get; set; }
    public string First_Name { get; set; }
    public string Last_Name { get; set; }
    public string Number { get; set; }
} 
```

您的更新将类似于：

```
Contact c = context.Contacts.Find(id);
PhoneNumber p = context.PhoneNumbers
    .FirstOrDefault(x => x.id == id && x.Primary == true);
//validate input
//update as necessary
//SaveChanges() etc... 
```

* * *

根据您的评论-您新建了模型类`ContactPrimaryNumberViewModel`：

```
var ContactPrimaryNumber = 
    from pn in db.PhoneNumbers 
    where pn.ContactID == id && pn.Primary == true 
    select new ContactPrimaryNumberViewModel() {
        ContactID = pn.ContactID, 
        First_Name = pn.Contact.First_Name, 
        Last_Name = pn.Contact.Last_Name, 
        Number = pn.Number
    }; 
```

# python - 在 Pygame 中启用全屏切换的正确语法是什么？

> ID：15993287
> 
> 赞同：1
> 
> 时间：2013-04-13T21:48:15.320
> 
> 标签：python, user-interface, pygame

我查看了文档，但似乎无法实现全屏切换。有人可以给我看一个正确语法的例子吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-07T03:34:52.600

您可以使用以下代码片段。

```
size=(640,480)
....
#init your pygame
pygame.init()
screen=pygame.display.set_mode(size, DOUBLEBUF)
flags=screen.get_flags()   
...
#events in your pygame app
event1 = pygame.event.poll()
if event1.type == KEYDOWN:
    if event1.key == K_ESCAPE:
        break    
    elif event1.key ==K_f:
        #toggle fullscreen by pressing F key.
        if flags&FULLSCREEN==False:
            flags|=FULLSCREEN
            pygame.display.set_mode(size, flags)
        else:
            flags^=FULLSCREEN
            pygame.display.set_mode(size, flags) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-03-03T05:57:03.500

`pygame.display.toggle_fullscreen()` 使用这个功能

# django - 无法在中间件中反转视图

> ID：15993290
> 
> 赞同：1
> 
> 时间：2013-04-13T21:48:45.427
> 
> 标签：django, django-context

我正在尝试使用中间件在 Django rotue 中捕获丢失的变量 - 但是我无法反转 URL，因为 Django 找不到视图（即使它存在于 urlconf 中）。例如：

使用这条路线：

```
# matches /test and /game/test
url(r'^((?P<game>[A-Za-z0-9]+)/)?test', 'hyp.views.test'), 
```

我正在尝试检测是否未给出游戏部分，并在这种情况下使用中间件重定向：

```
class GameMiddleware:
    def process_view(self, request, view_func, view_args, view_kwargs):
        if 'game' in view_kwargs:
            game = view_kwargs['game']

            if game is None:

                # As a test, attempt to resolve the url
                # Correctly finds ResolverMatch for hyp.views.test, game=TestGame
                print resolve('/TestGame/test', urlconf=request.urlconf)

                # Fails with "Reverse for 'hyp.views.test' with arguments '()'
                # and keyword arguments '{'game': 'TestGame'}' not found."
                return HttpResponseRedirect(reverse(
                    request.resolver_match.url_name, # 'hyp.views.test'
                    urlconf=request.urlconf,
                    kwargs={'game': 'TestGame'}
                ))

        return None 
```

`request.urlconf`确实包含测试网址：

```
{ '__name__': 'urlconf', '__doc__': None, 'urlpatterns': [
    <RegexURLPattern None ^$>,
    <RegexURLPattern None ^((?P<game>[A-Za-z0-9]+)/)?test>
], '__package__': None } 
```

我唯一能想到的是 URL 重写器可能无法处理包含可选部分的正则表达式 - 更好的解决方案是为这些情况创建单独的视图（我将有很多视图可选`game`参数）或者我可以修复它吗？

## 更新

我设法通过删除路线中的包装括号来使其工作（因此它读取`r'^(?P<game>[A-Za-z0-9]+/)?test'`并通过'TestGame /'作为游戏传递 - 但这并不理想，因为我`game.rstrip('/')`每次都必须调用（尽管仅在中间件中） . 也很难使用标签作为以预期`{% url %}`结尾的名称。`/`

如果有人有更好的解决方案，请保持打开状态。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T22:45:40.840

感谢[托德对另一个问题的回答](https://stackoverflow.com/questions/1352834/optional-get-parameters-in-django)，我找到了一种干净的方法：定义两条路线（一条有游戏，一条没有），将游戏指定为`None`没有模式的路线：

```
url(r'^test$', 'hyp.views.test', {'game': None}),
url(r'^(?P<game>[A-Za-z0-9]+)/test', 'hyp.views.test'), 
```

这会正确触发中间件`if game is None`部分，并且还允许指定游戏而不使用斜杠。

# php - 未定义变量错误

> ID：15993292
> 
> 赞同：0
> 
> 时间：2013-04-13T21:49:08.553
> 
> 标签：php, html

当我在下面更改表格行时出现错误`Undefined variable: last_name in C:\xampp\htdocs\how are things\admin panel\editaggrement.phpon line 130`，有没有办法可以使这个错误定义变量但是当我将表格行更改为 div 时，我得到了错误

```
<tr>
     <td width="179"><b><font color='#663300'>Last Name<em>*</em></font></b></td>
     <td><label>
      <input type="text" name="last_name" value="<?php echo $last_name; ?>" />
     </label></td>
   </tr> 
```

在我的表单上像下面这样的 div

```
 <div class="field">
    <label for="last_name">Last Name:</label>
   <input type="text" class="input" id="last_name" name="last_name" value="<?php echo $last_name; ?>" maxlength="30"/>
<p class="hint">30 characters maximum (letters only)</p>
    </div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-13T21:51:01.300

做类似的事情

```
<?php echo isset($last_name) ? $last_name : '' ?> 
```

如果未定义变量，您将只输出一个空字符串 ( `''`)。

# mysql - MySQL：将外键添加到表时出错（无错误代码）

> ID：15993293
> 
> 赞同：-1
> 
> 时间：2013-04-13T21:49:17.463
> 
> 标签：mysql, phpmyadmin, foreign-keys

我有两个表-`topics`并且`articles`我正在尝试向`articles.arTopic`（普通索引）添加一个外键，该外键将引用`topics.topicId`（AI PRIMARY 键）。

但是，当我尝试在 phpMyAdmin 中执行此操作时，我收到一个错误，但没有任何错误代码（它只是说“错误”）。两个表都是 InnoDB 并且它们目前是空的（当它们填充相同的结果时尝试过），两个列都是 int(11) 无符号的。`SHOW ENGINE INNODB STATUS`没有显示任何有用的信息，`LATEST FOREIGN KEY ERROR`部分中的记录与此问题无关。

我已经为此苦苦挣扎了两个小时，除非我明显遗漏了一些明显的东西，否则我不知道可能出了什么问题。任何人都可以帮忙吗？

提前致谢。

为 SQL 编辑：

```
CREATE TABLE IF NOT EXISTS `articles` (
  `arId` int(11) NOT NULL AUTO_INCREMENT,
  `arText` longtext COLLATE utf8_czech_ci NOT NULL,
  `arTopic` int(255) unsigned DEFAULT NULL,
  PRIMARY KEY (`arId`),
  KEY `arTopic` (`arTopic`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_czech_ci ROW_FORMAT=COMPACT AUTO_INCREMENT=1 ; 
```

```
CREATE TABLE IF NOT EXISTS `topics` (
  `topicId` int(255) unsigned NOT NULL AUTO_INCREMENT,
  `topicName` text COLLATE utf8_czech_ci NOT NULL,
  PRIMARY KEY (`topicId`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_czech_ci AUTO_INCREMENT=1 ; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T22:27:11.937

两列之间实际上是有区别的——一列是`not null`，另一列是`Default null`。差异会给你一个错误。

# javascript - 替代 $.load() 不使用 AJAX

> ID：15993294
> 
> 赞同：1
> 
> 时间：2013-04-13T21:49:26.197
> 
> 标签：javascript, jquery, ajax, web-applications

我正在开发一个充分利用 HTML5 离线/应用程序缓存的 web 应用程序，除了一个症结点之外，它运行得非常好......

我`$.load()`在页面之间切换时使用该功能加载内容。我正在加载的文件是同一服务器上的文件，但是由于在内部`$.load`使用`$.ajax`，这些文件不会从 AppCache 中获取（调用根本失败）。

```
var newPage = $('#slider').append('<div id="'+name+'">');
$('#'+name).load(someurl, function() {
    // Display the loaded content 
```

（注意：`someurl`表示 AppCache 中已经存在的文件，只是没有使用上面的代码加载）

有谁知道`$.load`我可以用来读取包含 javascript 的 .html 文件的替代方法，这些文件在脱机时可以工作？

理想情况下，这将只是替换`$.load`, 将内容从一个文件加载到节点中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T22:02:48.153

尝试在 ajax 设置中将缓存设置为 true。

```
var newPage = $('#slider').append('<div id="'+name+'">');
$.ajaxSetup( {cache:true});
$('#'+name).load(someurl, function() {
    // Display the loaded content 
```

# java - Google 应用引擎邮件发送无误，但在收件箱中找不到

> ID：15993297
> 
> 赞同：0
> 
> 时间：2013-04-13T21:49:32.963
> 
> 标签：java, google-app-engine, jakarta-ee

我正在使用谷歌应用引擎的邮件发送电子邮件。贝娄是我的代码

```
Properties props = new Properties();
Session session = Session.getDefaultInstance(props, null);

Message msg = new MimeMessage(session);
try {
msg.setFrom(new InternetAddress(from));
msg.addRecipient(Message.RecipientType.TO, new InternetAddress(to));
msg.setSubject(subject);
msg.setText(message);
Transport.send(msg);
    } catch (AddressException e) {
        throw new InvalidMailInputException("Invalid email.");
    } catch (MessagingException e) {
        throw new InvalidMailInputException("Unable to send eamil at this time.");
    } 
```

日志：

```
Apr 13, 2013 5:26:29 PM com.google.appengine.api.mail.dev.LocalMailService log
INFO: MailService.send
Apr 13, 2013 5:26:29 PM com.google.appengine.api.mail.dev.LocalMailService log
INFO:   From: myaddress@gmail.com
Apr 13, 2013 5:26:29 PM com.google.appengine.api.mail.dev.LocalMailService log
INFO:   To: myaddress@gmail.com
Apr 13, 2013 5:26:29 PM com.google.appengine.api.mail.dev.LocalMailService log
INFO:   Reply-to: myaddress@gmail.com
Apr 13, 2013 5:26:29 PM com.google.appengine.api.mail.dev.LocalMailService log
INFO:   Subject: Appoint has been cancelled successfully (5)
Apr 13, 2013 5:26:29 PM com.google.appengine.api.mail.dev.LocalMailService log
INFO:   Body:
Apr 13, 2013 5:26:29 PM com.google.appengine.api.mail.dev.LocalMailService log
INFO:     Content-type: text/plain
Apr 13, 2013 5:26:29 PM com.google.appengine.api.mail.dev.LocalMailService log
INFO:     Data length: 147 
```

在日志消息中，我没有收到任何错误。但是，我也没有收到电子邮件。

感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T09:51:36.147

看起来您正在使用本地开发服务器。在这种情况下，实际上不会发送任何邮件。

来自： [https ://developers.google.com/appengine/docs/java/mail/overview#Development_Server](https://developers.google.com/appengine/docs/java/mail/overview#Development_Server)

> 当开发服务器中运行的应用程序调用邮件服务发送电子邮件消息时，该消息将打印到日志中。Java 开发服务器不发送电子邮件。

# ruby - Ruby 允许用户创建一个帖子，它只允许其他某些选定的用户编辑某些部分

> ID：15993307
> 
> 赞同：0
> 
> 时间：2013-04-13T21:50:49.077
> 
> 标签：ruby, devise, ruby-on-rails-3.2, user-roles

我是 ruby​​ 新手，但尝试创建一个项目，在做了一些研究后我发现使用 Devise、cancan 和角色模型，但是我运气不好，非常感谢一些帮助或指导，我可以去哪里做这个！

基本上我正在尝试创建一个允许体育教练/运动员注册的网站，然后教练可以设置不同的每周计划，运动员将每天填写其中，仅在某些选定区域但仍然可以查看教练有什么书面。一旦运动员填写了其中的报告，教练就可以打印出该周的报告

[我已经安装了 devise、cancan 和 rolemodel，并使用此http://www.phase2technology.com/blog/authentication-permissions-and-roles-in-rails-with-devise-cancan-and-role](http://www.phase2technology.com/blog/authentication-permissions-and-roles-in-rails-with-devise-cancan-and-role-model/)设置了基础知识[-model/](http://www.phase2technology.com/blog/authentication-permissions-and-roles-in-rails-with-devise-cancan-and-role-model/)，但是我很难看到我如何将运动员注册为“运动员”并将教练注册为“教练”，即使那时只允许教练选择某些运动员（他们的运动员）来分配训练计划。

谢谢你的帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T21:59:13.450

我会使用基于其他模型的模型，比如 User 模型，其中混入了 Devise。然后您可以创建从 User 继承的 Athlete 和 Coach 模型。

在视图中，您只需添加新的注册字段（例如，在这两个模型之间进行选择的单选按钮）。这将需要对 Devise 的基本约定进行一些更改，但会为您节省大量分别实现 2 个设计模型的时间。

# ios - 检查 gdata 访问令牌的有效性

> ID：15993308
> 
> 赞同：2
> 
> 时间：2013-04-13T21:50:53.577
> 
> 标签：ios, youtube-api, gdata, gdata-api

我正在使用 gdata sdk 将视频上传到 youtube。今天我正在测试如果我撤销我的应用程序对 youtube 的访问权限会发生什么。在 Google 帐户安全（[https://accounts.google.com/b/0/IssuedAuthSubTokens](https://accounts.google.com/b/0/IssuedAuthSubTokens)）中撤销访问权限后，我尝试将视频上传到 youtube。奇怪的是，我完成的选择器没有被错误或成功调用。这让我相信，如果我有权上传到 youtube，我应该以某种方式进行更彻底的检查。

问题是我不知道该怎么做。这是我当前检查是否需要登录的代码：

```
 - (BOOL)isSignedIn
    {
        NSString *clientID = @"CLIENT_ID";
        NSString *clientSecret = @"CLIENT_SECRET";
        NSString *keychainName= @"KEYCHAIN_NAME";

        GTMOAuth2Authentication *auth = [GTMOAuth2ViewControllerTouch authForGoogleFromKeychainForName:keychainName
                                                                     clientID:clientID
clientSecret:clientSecret];

        [[self youTubeService] setAuthorizer:auth];
        return  auth.canAuthorize;

    } 
```

这是在 isSignedIn 返回 NO 时登录的代码：

```
-(void)performSignIn:(id)arg
{       
    NSString *scope = [GDataServiceGoogleYouTube authorizationScope];

    NSString *clientID = @"CLIENT_ID";
    NSString *clientSecret = @"CLIENT_SECRET";
    NSString *keychainName= @"KEYCHAIN_NAME";

    SEL finishedSel = @selector(viewController:finishedWithAuth:error:);

    GTMOAuth2ViewControllerTouch *viewController;
    viewController = [GTMOAuth2ViewControllerTouch controllerWithScope:scope
                                                              clientID:clientID
                                                          clientSecret:clientSecret
                                                      keychainItemName:keychainName
                                                              delegate:self
                                                      finishedSelector:finishedSel];

    UINavigationController *aNavController = [[UINavigationController alloc] initWithRootViewController:viewController];
    [self presentModalViewController:aNavController animated:YES];
    [aNavController release];

} 
```

有没有办法检查我的访问令牌是否仍然有效？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-22T21:40:21.813

通常，您可以通过调用来检查 Google 颁发的 OAuth 2 访问令牌是否有效，`https://www.google.com/accounts/AuthSubTokenInfo?bearer_token=OAUTH_2_TOKEN`并查看您是否收到 HTTP 200 或 40x 响应。

更有意义的是做一个“廉价的”经过身份验证的 YouTube API 调用，比如 for `https://gdata.youtube.com/feeds/api/users/default?v=2`，看看你是否得到了有效的响应或错误。

# c# - 嵌入式数据库表中的 SQLite 连接

> ID：15993313
> 
> 赞同：7
> 
> 时间：2013-04-13T21:51:06.803
> 
> 标签：c#, sqlite, join, windows-store-apps, sqlite-net

我目前正在为 Windows 8 编写一个 Windows 应用商店应用程序，并且我正在使用 SQLite 在 Windows 应用程序的类库中的嵌入式数据库上进行持久性。我正在尝试连接来自嵌入式数据库中两个不同表的数据，但 SQLite 不断从其 GenerateCommand 方法中抛出不受支持的异常。

我目前在两个表中都有数据，并且它们在每个表中都有一个 questionId 可以加入。我尝试了两种不同的方法，它们都抛出相同的错误。

第一种方法：

```
 var q = (from gameTable in db.Table<Model.GameSaved>()
                 join qTable in db.Table<Questions>() on gameTable.QuestionId equals qTable.QuestionId
                 select qTable
                ).First(); 
```

第二种方法：

```
 var q =
                (from question in db.Table<Model.GameSaved>()
                 select question
                ).Join(db.Table<Questions>(), 
                       game => game.QuestionId, 
                       questionObject => questionObject.QuestionId,
                       (game,questionObject) => questionObject)
                 .First(); 
```

我不确定我在这里缺少什么，但它必须简单明了。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-15T03:44:51.773

你没有错过任何东西。Sqlite-net 目前不支持通过 linq 连接。您可以通过提供自己的 SQL 并使用该`Query`方法来解决此问题。您从上面的第一个查询看起来像：

```
var q = db.Query<Questions>(
    "select Q.* from Questions Q inner join GameSaved G"
    + " on Q.QuestionId = G.QuestionId"
).First(); 
```

如果您愿意，该`Query`方法还支持参数。来自[Sqlite-net 自述文件](https://github.com/praeclarum/sqlite-net)：

```
db.Query<Val>(
    "select 'Price' as 'Money', 'Time' as 'Date' from Valuation where StockId = ?",
     stock.Id); 
```

# android - 在 Robotium 中单击操作栏菜单项

> ID：15993314
> 
> 赞同：7
> 
> 时间：2013-04-13T21:51:07.553
> 
> 标签：android, actionbarsherlock, robotium

我正在尝试在 Robotium 中运行一些自动化测试。我的应用程序中有以下代码，它设置了一个选项菜单：

```
 public boolean onCreateOptionsMenu(com.actionbarsherlock.view.Menu menu) {
    com.actionbarsherlock.view.MenuInflater inflater = getSupportMenuInflater();
        inflater.inflate(R.layout.logoutmenu, menu);
        return super.onCreateOptionsMenu(menu);
   } 
```

我尝试使用以下代码单击 Robotium 中的菜单：

```
solo.sendKey(Solo.MENU);
solo.clickOnView(solo.getView(R.id.share)); //share is the id of the menu item 
```

但是我的测试因错误而失败：

```
View is null and therefore cannot be clicked. 
```

我也尝试过使用下面的代码，但也失败了：

```
solo.clickOnView(solo.getView(R.id.logoutmenu));
solo.clickOnMenuItem("Share My Artists"); 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-04-19T09:15:04.330

如果您在 Android 4.0+ 上运行 Robotium 测试，请考虑使用`solo.clickOnActionBarItem()`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-03-27T11:14:34.530

这样做：

```
solo.sendKey(Solo.MENU);
solo.clickInList(5); 
```

5 是位置，只需将其更改为您的菜单项的位置 First 是 1 ， Second 是 2 等等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-28T16:11:17.050

我可以让它在所有的 SDK 上工作，使用这个：

```
View ab = _solo.getCurrentActivity().findViewById(R.id.action_bar);
ArrayList<View> views = _solo.getViews(ab);
for (int i = 0; i <views.size(); i++) {
    if (views.get(i).getClass().getName().contains("ActionMenuPresenter")) {
        _solo.clickOnView(views.get(i));
        _solo.waitForText(SOME_TEXT);
    }
} 
```

# android - 尝试连接到 Microsoft Azure 下载数据时，我的应用程序崩溃/停止

> ID：15993318
> 
> 赞同：0
> 
> 时间：2013-04-13T21:51:35.677
> 
> 标签：android

我正在测试一个小型 Android 应用程序，它所做的只是连接到 Microsoft Azure SQL 数据库以提取数据并进行处理。我刚开始使用连接代码并解决了所有错误，但现在应用程序在加载后崩溃/停止工作。

```
package com.example.azureconnectionstringtest;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.Statement;

import android.app.Activity;
import android.os.AsyncTask;
import android.os.Bundle;
import android.view.Menu;
import android.widget.Toast;

public class MainActivity extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        new DownloadDataTask().execute();
    }

    private class DownloadDataTask extends AsyncTask<Void, Void, Void> {

        @Override
        protected Void doInBackground(Void... params) {
            // TODO Auto-generated method stub
            String connectionString = "jdbc:sqlserver://ocgiy0eg0n.database.windows.net" + ";" + 
                "database=MyDatabaseName " + ";" + 
                "user=MyUserName" + ";" +  
                "password=MyPassword";
            Connection connection = null;  // For making the connection
            Statement statement = null;    // For the SQL statement 
            ResultSet resultSet = null;    // For the result set, if applicable 
            try {
                // Ensure the SQL Server driver class is available.
                Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");              
                // Establish the connection.
                connection = DriverManager.getConnection(connectionString);
                String sql = "Select * from Master_Product_List";
                statement = connection.createStatement();
                resultSet = statement.executeQuery(sql);
                if(resultSet.next()) {
                    //TO DO data processing....
                }               
            } catch (Exception ex) {
                Toast.makeText(getApplicationContext(), ex.toString(), Toast.LENGTH_LONG).show();
            }
            return null;
        }
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }
} 
```

下面是我的 logcat：当我运行应用程序时出现此错误：不幸的是 AppName 已停止。

```
04-14 13:33:40.200: E/AndroidRuntime(1016): FATAL EXCEPTION: AsyncTask #1
04-14 13:33:40.200: E/AndroidRuntime(1016): java.lang.RuntimeException: An error occured while executing doInBackground()
04-14 13:33:40.200: E/AndroidRuntime(1016):     at android.os.AsyncTask$3.done(AsyncTask.java:299)
04-14 13:33:40.200: E/AndroidRuntime(1016):     at java.util.concurrent.FutureTask.finishCompletion(FutureTask.java:352)
04-14 13:33:40.200: E/AndroidRuntime(1016):     at java.util.concurrent.FutureTask.setException(FutureTask.java:219)
04-14 13:33:40.200: E/AndroidRuntime(1016):     at java.util.concurrent.FutureTask.run(FutureTask.java:239)
04-14 13:33:40.200: E/AndroidRuntime(1016):     at android.os.AsyncTask$SerialExecutor$1.run(AsyncTask.java:230)
04-14 13:33:40.200: E/AndroidRuntime(1016):     at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1080)
04-14 13:33:40.200: E/AndroidRuntime(1016):     at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:573)
04-14 13:33:40.200: E/AndroidRuntime(1016):     at java.lang.Thread.run(Thread.java:856)
04-14 13:33:40.200: E/AndroidRuntime(1016): Caused by: java.lang.RuntimeException: Can't create handler inside thread that has not called Looper.prepare()
04-14 13:33:40.200: E/AndroidRuntime(1016):     at android.os.Handler.<init>(Handler.java:197)
04-14 13:33:40.200: E/AndroidRuntime(1016):     at android.os.Handler.<init>(Handler.java:111)
04-14 13:33:40.200: E/AndroidRuntime(1016):     at android.widget.Toast$TN.<init>(Toast.java:324)
04-14 13:33:40.200: E/AndroidRuntime(1016):     at android.widget.Toast.<init>(Toast.java:91)
04-14 13:33:40.200: E/AndroidRuntime(1016):     at android.widget.Toast.makeText(Toast.java:238)
04-14 13:33:40.200: E/AndroidRuntime(1016):     at com.example.azureconnectionstringtest.MainActivity$DownloadDataTask.doInBackground(MainActivity.java:56)
04-14 13:33:40.200: E/AndroidRuntime(1016):     at com.example.azureconnectionstringtest.MainActivity$DownloadDataTask.doInBackground(MainActivity.java:1)
04-14 13:33:40.200: E/AndroidRuntime(1016):     at android.os.AsyncTask$2.call(AsyncTask.java:287)
04-14 13:33:40.200: E/AndroidRuntime(1016):     at java.util.concurrent.FutureTask.run(FutureTask.java:234)
04-14 13:33:40.200: E/AndroidRuntime(1016):     ... 4 more
04-14 13:33:40.280: W/Trace(1016): Unexpected value from nativeGetEnabledTags: 0
04-14 13:33:40.360: W/Trace(1016): Unexpected value from nativeGetEnabledTags: 0
04-14 13:33:41.760: W/Trace(1016): Unexpected value from nativeGetEnabledTags: 0
04-14 13:33:41.860: W/Trace(1016): Unexpected value from nativeGetEnabledTags: 0
04-14 13:33:42.622: W/Trace(1016): Unexpected value from nativeGetEnabledTags: 0
04-14 13:33:42.622: W/Trace(1016): Unexpected value from nativeGetEnabledTags: 0
04-14 13:33:42.710: W/Trace(1016): Unexpected value from nativeGetEnabledTags: 0
04-14 13:33:43.091: W/Trace(1016): Unexpected value from nativeGetEnabledTags: 0
04-14 13:33:43.091: I/Choreographer(1016): Skipped 91 frames!  The application may be doing too much work on its main thread.
04-14 13:33:53.800: I/Process(1016): Sending signal. PID: 1016 SIG: 9 
```

# c++ - 定义模板类、运算符和迭代器的麻烦

> ID：15993320
> 
> 赞同：1
> 
> 时间：2013-04-13T21:51:52.533
> 
> 标签：c++, templates, iterator, operators

所以我试图定义一个模板类“TwoWayVector”和“TwoWayVectorIterator”，但我遇到了很多问题。我想在 TwoWayVector 中定义 == 以返回引用并将 const TwoWayVector 作为参数，这就是我定义其他运算符的方式，而 g++ 没有抱怨，但由于某种原因，下面的代码会产生错误

```
TwoWayVector.cc: In member function ‘bool& TwoWayVector<T>::operator==(TwoWayVector<T>)         [with T = int]’:
Test.cc:10:   instantiated from here
TwoWayVector.cc:40: error: passing ‘const TwoWayVector<int>’ as ‘this’ argument of ‘T&       TwoWayVector<T>::operator[](int) [with T = int]’ discards qualifiers
Test.cc:10:   instantiated from here
TwoWayVector.cc:32: warning: reference to local variable ‘result’ returned 
```

测试.cc

```
#include <iostream>
#include "TwoWayVector.cc"
int main(){
TwoWayVector<int> numbers;
TwoWayVector<int> numbers2;
numbers.push_back(3);
numbers.push_back(2);
numbers2.push_back(3);
numbers2.push_back(2);
cout << (numbers==numbers2);
cout << endl;
return 0;
} 
```

双向矢量.cc

```
using namespace std;
#include "TwoWayVectorIterator.cc"
template <class T> class TwoWayVector{
public:

T* data;
int capacity;
int nextFree;

TwoWayVector(){
    capacity = 10;
    nextFree = 0;
    data = new T[capacity];
}

~TwoWayVector(){
    delete data;
}

T& operator[](const int index){
    if( index >= capacity || capacity + index < 0){
        string number = static_cast<ostringstream*>( &(ostringstream() << index) )->str();
        string error = "index " + number + " is out of bounds";
        throw error;
    }
    else if(index < 0){
        return data[nextFree+index];
    }
    return  data[index];
}
bool& operator==(const TwoWayVector vector2){
    bool result = true;
    if(capacity != vector2.capacity){
        result = false;
    }
    if(nextFree != vector2.nextFree){
        result = false;
    }
    for(int i=0; i<nextFree ; i++){
        if(data[i] != vector2[i]){
            result = false;
        }
    }
    return result;
}
 //memory leaks?
void push_back(T object){
    if(capacity <= nextFree){
        capacity = capacity*2;
        T* tmp = new T[capacity];
        for(int i=0; i<capacity; i++){
            tmp[i] = data[i];
        }
        delete data;
        data = tmp;
    }
    data[nextFree] = object;
    nextFree++;
}

T pop_back(){
    nextFree--;
    T result = data[nextFree];
    data[nextFree] = NULL;
    return result;
}

int size(){
    return nextFree;
}

TwoWayVectorIterator<T>* begin(){
    TwoWayVectorIterator<T>* i = new TwoWayVectorIterator<T>(0,this);
    return (i);
}
TwoWayVectorIterator<T>* end(){
    TwoWayVectorIterator<T>* i = new TwoWayVectorIterator<T>(nextFree,this);
    return(i);
}

}; 
```

TwoWayVectorIterator.cc

```
#include <sstream>

using namespace std;

template<typename T> class TwoWayVector;

template <class T> class TwoWayVectorIterator{
public:
TwoWayVector<T>* vector;
int currentPosition;
TwoWayVectorIterator(TwoWayVector<T>& vec){
    currentPosition = 0;
    vector = vec;
}
TwoWayVectorIterator( int pos , TwoWayVector<T>* vec){
    currentPosition = pos;
    vector = vec;
}

bool& operator==(const TwoWayVectorIterator vector2){
    bool contents, position;
    contents = (vector == vector2) ? true : false;
    position =(currentPosition == vector2->currentPosition) ? true : false;
    return (contents && position);
}

bool& operator!=(const TwoWayVectorIterator vector2){
    bool contents, position;
    contents = (vector == vector2) ? false : true;
    position=(currentPosition == vector2->currentPosition) ? false : true;
    return (contents || position);
}

TwoWayVectorIterator& operator++(){
    return *this;
    currentPosition = (currentPosition+1);

}
TwoWayVectorIterator& operator++(int){
    currentPosition = (currentPosition+1);
    return *this;
}
TwoWayVectorIterator& operator=(TwoWayVectorIterator* vector2){
    &vector = vector2;
    currentPosition = vector2->currentPosition;
    return *this;
}
TwoWayVectorIterator& operator+(int n){
    currentPosition = currentPosition+n;
    return *this;
}
TwoWayVectorIterator& operator-(int n){
    currentPosition = currentPosition-n;
    return *this;
}
bool& operator<(TwoWayVectorIterator* vector2){
    return (currentPosition<vector2->currentPosition);
}
T& operator*(){
    return vector[currentPosition];
}
}; 
```

如果我将 TwoWayVector.cc 中的 == 运算符定义更改为

```
bool operator==(TwoWayVector vector2){
    bool result = true;
    if(capacity != vector2.capacity){
        result = false;
    }
    if(nextFree != vector2.nextFree){
        result = false;
    }
    for(int i=0; i<nextFree ; i++){
        if(data[i] != vector2[i]){
            result = false;
        }
    }
    return result;
} 
```

然后一切都编译了，但是当我运行它时，我得到了

```
1
a.out(40908) malloc: *** error for object 0x7fe4f2c03b40: pointer being freed was not   allocated
*** set a breakpoint in malloc_error_break to debug
Abort trap: 6 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T22:04:38.047

在内部`operator==`调用`operator[]`const 变量，它是非常量的`vector2`。

您应该添加运算符的替代只读版本：

```
const T & operator[](const int index) const; 
```

但是您应该像这样使用 object 参数的引用：

```
bool operator==(const TwoWayVector &vector2) const; 
```

否则，该`const`关键字实际上并没有多大作用，因为它只表示您的对象副本（刚刚在堆栈上为函数创建）不能被修改，这并不重要。（因此解决此问题的最简单方法是从中删除 const 关键字，`vector2`但这并不完全正确。）

而且，当然，不要将 bool 值作为引用返回，因为它引用了变量`result`，一旦您离开函数，该变量将不再存在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T22:14:04.330

由于缺少复制构造函数，基本上会发生崩溃。见[三法则](https://stackoverflow.com/questions/4172722/what-is-the-rule-of-three)。什么时候

```
bool operator==(TwoWayVector vector2){ 
```

在 main 中使用，创建了 vector 的副本，持有 numbers2 的指针，然后在退出形式 operator == 时，副本被删除，留下 numbers2 的指针指向已经释放的内存，它试图在 main() 退出时删除，这会导致错误。

# mule - Mule CPU 以非常小的负载最大化

> ID：15993322
> 
> 赞同：1
> 
> 时间：2013-04-13T21:52:11.573
> 
> 标签：mule, cpu-usage, esb

被测系统：Mule ESB 3.3.1 操作系统：CentOS 5.1 64 位四核 3 GHz 32 GB RAM

Mule ESB 只是拦截 SOAP 请求；验证有效令牌的 SOAP 请求并简单地将请求转发到托管 Web 服务的预定 Web 服务器。

当我们使用 SOAP UI 运行性能测试时，CPU 以每秒 10 个请求的速度非常快地达到 100%。

```
<spring:beans>
     <spring:bean class="ca.mpac.soa.BAMNotificationListener" id="BAMNotificationListener"/>
     <context:component-scan base-package="ca.mpac.soa"/>
     <util:properties id="appProps" location="classpath:bedrock.properties"/>
</spring:beans>
<notifications>
    <notification event="COMPONENT-MESSAGE"/> <notification-listener ref="BAMNotificationListener"/>
</notifications>

<context:property-placeholder location="bedrock.properties"/>
<object-to-string-transformer name="SecurityTokenResponseToString" doc:name="Object to String"/>
<custom-transformer name="WSDLTransformer" class="ca.mpac.soa.WSDLTransformer" doc:name="Java"/>

<flow name="bedrock" doc:name="bedrock">
            <http:inbound-endpoint exchange-pattern="request-response" host="${proxy.host}" port="${proxy.port}" doc:name="proxy">
                    <not-filter>
                            <wildcard-filter pattern="/favicon.ico" caseSensitive="true"/>
                    </not-filter>
            </http:inbound-endpoint>
    <component class="ca.mpac.soa.HttpAccessLog" doc:name="HttpAccessLog"/>
    <!-- <logger message="#[header:INBOUND:http.version] #[header:INBOUND:http.method] #[header:INBOUND:Host]#[header:INBOUND:http.request.path]?#[header:INBOUND:http.query.string] #[header:INBOUND:MULE_REMOTE_CLIENT_ADDRESS] #[header:INBOUND:User-Agent]" level="INFO" doc:name="Header Information" category="mule.http.accesslog"/> -->
    <!-- logger message="Incoming request: #[payload]" level="INFO" doc:name="Incoming request"/> -->
    <choice doc:name="Choice">
        <when evaluator="groovy" expression="message.getInboundProperty('http.request.path')==~'^/rest/.*'">
            <processor-chain>
                <flow-ref name="REST" doc:name="REST Flow"/>
            </processor-chain>
        </when>
        <when evaluator="groovy" expression="message.getInboundProperty('http.request.path')==~'^/soap/.*'">
            <processor-chain>
                <flow-ref name="SOAP" doc:name="SOAP Flow"/>
            </processor-chain>
        </when>
        <otherwise>
            <processor-chain>
                <flow-ref name="404NotFound" doc:name="404 Not Found"/>
            </processor-chain>
        </otherwise>
    </choice>
</flow>
<sub-flow name="REST" doc:name="REST">
    <!-- logger message="Launching REST Flow: #[payload]" level="INFO" doc:name="Launching REST Flow"/> -->
    <choice doc:name="Choice">
        <when evaluator="groovy" expression="message.getInboundProperty('http.request.path')==~'^/rest/security/gettoken$'">
            <processor-chain>
                <choice doc:name="Choice">
                    <when evaluator="header" expression="INBOUND:http.method=POST">
                        <processor-chain>
                            <mulexml:xml-to-object-transformer returnClass="ca.mpac.soa.ClientAuthenticationRequest" doc:name="XML to Object">
                                <mulexml:alias name="credential" class="ca.mpac.soa.ClientAuthenticationRequest"/>
                            </mulexml:xml-to-object-transformer>
                            <!-- logger message="Accessing to ${openam.host}:${openam.port}/openam/identity/authenticate?username=#[payload.username]&amp;password=#[payload.password]&amp;uri=realm=${openam.realm}" level="INFO" doc:name="Accessing to URL"/> -->
                            <http:outbound-endpoint exchange-pattern="request-response" host="${openam.host}" port="${openam.port}" path="openam/identity/authenticate?username=#[payload.username]&amp;password=#[payload.password]&amp;uri=realm=${openam.realm}" method="GET" responseTransformer-refs="SecurityTokenResponseToString" doc:name="OpenAM Get Token"/>
                            <choice doc:name="Choice">
                                <when evaluator="header" expression="INBOUND:http.status=200">
                                    <processor-chain>
                                        <logger message="Getting Token: #[payload]" level="INFO" doc:name="Getting Token"/>
                                    </processor-chain>
                                </when>
                                                        <otherwise>
                                                            <processor-chain>
                                                                            <!-- <logger message="401 Access Denied: Invalid Account Information" level="INFO" doc:name="401 Access Denied"/> -->
                                                                                <set-payload value="401 Access Denied: Invalid Account Information" doc:name="401 Access Denied" />
                                                                            <http:response-builder status="401" doc:name="HTTP 401" contentType="text/plain"/>
                                                                </processor-chain>
                                                        </otherwise>
                            </choice>
                        </processor-chain>
                    </when>
                                <otherwise>
                                    <processor-chain>
                                        <flow-ref name="405MethodNotAllowed" doc:name="405 Method Not Allowed"/>
                                    </processor-chain>
                                </otherwise>
                </choice>
            </processor-chain>
        </when>
        <otherwise>
            <processor-chain>
                <flow-ref name="404NotFound" doc:name="404 Not Found"/>
            </processor-chain>
        </otherwise>
    </choice>
</sub-flow>

<sub-flow name="SOAP" doc:name="SOAP">
    <!-- <logger message="Launching SOAP Flow: #[payload]" level="INFO" doc:name="Launching SOAP Flow"/> -->
            <choice doc:name="Choice">
        <when evaluator="groovy" expression="message.getInboundProperty('http.request')==~'^/soap/BuildingPermitService/v1/BuildingPermit\\?.*'">
            <processor-chain>
                <choice doc:name="Choice">
                    <when evaluator="header" expression="INBOUND:http.method=GET">
                        <processor-chain>
                            <!-- <logger message="Accessing to ${bpe.host}:${bpe.port}#[header:INBOUND:http.request.path]?#[header:INBOUND:http.query.string]" level="INFO" doc:name="Accessing to URL"/> -->
                            <http:outbound-endpoint exchange-pattern="request-response" address="http://${bpe.host}:${bpe.port}#[header:INBOUND:http.request.path]?#[header:INBOUND:http.query.string]" method="GET" doc:name="SOAP Service" responseTransformer-refs="WSDLTransformer"/>
                        </processor-chain>
                    </when>
                                <otherwise>
                                    <processor-chain>
                                        <flow-ref name="405MethodNotAllowed" doc:name="405 Method Not Allowed"/>
                                        </processor-chain>
                                </otherwise>
                </choice>
            </processor-chain>
        </when>
        <when evaluator="groovy" expression="message.getInboundProperty('http.request')==~'^/soap/BuildingPermitService/v1/BuildingPermit$'">
            <processor-chain>
                <choice doc:name="Choice">
                    <when evaluator="header" expression="INBOUND:http.method=POST">
                        <processor-chain>
                            <component class="ca.mpac.soa.HttpRequestToAuthorization" doc:name="HttpRequest To Authorization"/>
                                        <choice doc:name="Choice">
                                            <when evaluator="header" expression="INVOCATION:authResult=true">
                                                <processor-chain>
                                                    <!--
                                                    <logger message="Accessing to ${bpe.host}:${bpe.port}#[header:INBOUND:http.request]" level="INFO" doc:name="Accessing to URL"/>
                                        <component class="ca.mpac.soa.SoapRequest" doc:name="SOAP Request"/>
                                                    <http:outbound-endpoint exchange-pattern="request-response" address="http://${bpe.host}:${bpe.port}#[header:INBOUND:http.request]" doc:name="SOAP Service" >
                                                            <cxf:proxy-client payload="envelope" />
                                                            <logger message="#[payload]" level="INFO" doc:name="Logger"/>
                                                    </http:outbound-endpoint>
                                                    -->
                                                    <http:outbound-endpoint exchange-pattern="request-response" address="http://${bpe.host}:${bpe.port}/soap/BuildingPermitService/v1/BuildingPermit" doc:name="SOAP Service" >
                                                            <cxf:proxy-client payload="envelope" />
                                                            <!-- <logger message="#[payload]" level="INFO" doc:name="Logger"/> -->
                                                    </http:outbound-endpoint>
                                                    <!-- <logger message="Discovered an Authorization Request" level="INFO" doc:name="Discovered an Authorization Request"/> -->
                                                </processor-chain>
                                            </when>
                                            <when evaluator="header" expression="INVOCATION:authResult=false">
                                                <processor-chain>
                                                                            <logger message="403 Authorization Failure" level="INFO" doc:name="403 Authorization Failure"/>
                                                                            <expression-component doc:name="403 AuthorizationFailure"><![CDATA[
                                                                                             message.payload = '<?xml version=\'1.0\' encoding=\'UTF-8\'?>'
                                                                                                             + '<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">'
                                                                                                             + '<soap:Body>'
                                                                                                             + '<soap:Fault>'
                                                                                                             + '<faultcode>soap:Server</faultcode>'
                                                                                                             + '<faultstring>A security fault has occured</faultstring>'
                                                                                                             + '<detail>'
                                                                                                             + '<ns2:securityFault xmlns:ns3="http://services.mpac.ca/soap/security/v1.0/schema" xmlns:ns2="http://services.mpac.ca/soap/common/faulttypes/v1.0/schema" xmlns="http://services.mpac.ca/soap/buildingpermit/v1.0/schema">'
                                                                                                             + '<ns2:name>AuthorizationFailure</ns2:name>'
                                                                                                             + '<ns2:status>403</ns2:status>'
                                                                                                             + '<ns2:reason>Client is unauthorized to use this service | please contact your MPAC representative</ns2:reason>'
                                                                                                             + '</ns2:securityFault>'
                                                                                                             + '</detail>'
                                                                                                             + '</soap:Fault>'
                                                                                                             + '</soap:Body>'
                                                                                                             + '</soap:Envelope>';
                                                                                    ]]></expression-component>
                                                                            <http:response-builder status="403" doc:name="HTTP 403" contentType="text/xml"/>
                                                </processor-chain>
                                            </when>
                                            <when evaluator="header" expression="INVOCATION:authResult=401">
                                                <processor-chain>
                                                                            <logger message="401 Access Denied: Invalid Token" level="INFO" doc:name="401 Access Denied"/>
                                                                                <expression-component doc:name="401 Access Denied: AuthenticationFailed"><![CDATA[
                                                                                             message.payload = '<?xml version=\'1.0\' encoding=\'UTF-8\'?>'
                                                                                                             + '<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">'
                                                                                                             + '<soap:Body>'
                                                                                                             + '<soap:Fault>'
                                                                                                             + '<faultcode>soap:Server</faultcode>'
                                                                                                             + '<faultstring>A security fault has occured</faultstring>'
                                                                                                             + '<detail>'
                                                                                                             + '<ns2:securityFault xmlns:ns3="http://services.mpac.ca/soap/security/v1.0/schema" xmlns:ns2="http://services.mpac.ca/soap/common/faulttypes/v1.0/schema" xmlns="http://services.mpac.ca/soap/buildingpermit/v1.0/schema">'
                                                                                                             + '<ns2:name>AuthenticationFailed</ns2:name>'
                                                                                                             + '<ns2:status>401</ns2:status>'
                                                                                                             + '<ns2:reason>Client authentication has failed | please contact your MPAC representative</ns2:reason>'
                                                                                                             + '</ns2:securityFault>'
                                                                                                             + '</detail>'
                                                                                                             + '</soap:Fault>'
                                                                                                             + '</soap:Body>'
                                                                                                             + '</soap:Envelope>';
                                                                                    ]]></expression-component>
                                                                            <http:response-builder status="401" doc:name="HTTP 401" contentType="text/xml"/>
                                                </processor-chain>
                                            </when>
                                                        <otherwise>
                                                            <processor-chain>
                                                                            <component class="ca.mpac.soa.SoapActionErrorLog" doc:name="SoapActionErrorLog"/>
                                                                            <http:response-builder status="400" doc:name="HTTP 400" contentType="text/plain"/>
                                                                </processor-chain>
                                                        </otherwise>
                                        </choice>
                        </processor-chain>
                    </when>
                                <otherwise>
                                    <processor-chain>
                                        <flow-ref name="405MethodNotAllowed" doc:name="405 Method Not Allowed"/>
                                        </processor-chain>
                                </otherwise>
                </choice>
            </processor-chain>
        </when>
        <otherwise>
            <processor-chain>
                <flow-ref name="404NotFound" doc:name="404 Not Found"/>
                </processor-chain>
        </otherwise>
    </choice>
</sub-flow>

<sub-flow name="404NotFound" doc:name="404NotFound">
    <logger message="404 Not Found: #[header:INBOUND:http.request]" level="INFO" doc:name="404 Not Found"/>
    <set-payload value="404 Not Found" doc:name="404 Not Found" />
    <http:response-builder status="404" doc:name="HTTP 404" contentType="text/plain"/>
</sub-flow>

<sub-flow name="405MethodNotAllowed" doc:name="405MethodNotAllowed">
    <logger message="405 Method Not Allowed: #[header:INBOUND:http.method]" level="INFO" doc:name="405 Method Not Allowed"/>
    <set-payload value="405 Method Not Allowed" doc:name="405 Method Not Allowed" />
    <http:response-builder status="405" doc:name="HTTP 405" contentType="text/plain"/>
</sub-flow> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T02:45:30.613

这是一个影响 Mule 3.3.0 和 3.3.1的[已知问题](http://www.mulesoft.org/jira/browse/MULE-6183)

它已得到解决，该修复将成为即将发布的 3.4.0 版本的一部分

# java - ./ 在 URL 中没有正确考虑

> ID：15993326
> 
> 赞同：0
> 
> 时间：2013-04-13T21:52:27.583
> 
> 标签：java, url, normalization

我想解析一些网址。为此，我采用以下结果：

```
 new URL(new URL(baseurl), link); 
```

这种方法似乎在何时`baseurl="http://www.site.com"`失败`link="./"`

您将得到以下结果`http://www.site.com/./`，而不仅仅是`http://www.site.com/`

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T23:28:49.317

使用[`URI.normalize()`](http://docs.oracle.com/javase/7/docs/api/java/net/URI.html#normalize%28%29).

```
import java.net.*;

class TestURL {

    public static void main(String[] args) throws Exception {
        String s = "http://www.site.com/./";
        URL url = new URL(s);
        System.out.println(url);
        URI uri = url.toURI();
        System.out.println(uri.normalize().toURL());
    }
} 
```

## 输出

```
http://www.site.com/./
http://www.site.com/ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T21:56:14.710

也许这会起作用？

`new URI(baseUrl).resolve(link).toURL()`

[java.net.URI](http://docs.oracle.com/javase/6/docs/api/java/net/URI.html)有一个 resolve 方法，它可能是您正在寻找的方法和 toURL 以将其放入 URL 。

**编辑**

以下似乎对我有用..

```
import java.net.URL;

public class UrlTest {

    private static URL resolve(URL base, String link) throws Exception {
        if (base.getPath().isEmpty()) {
            link = "/" + link;
        }       
        URL u1 = base.toURI().resolve(link).normalize().toURL();
        return u1;
    }

    private static void resolveUrls(URL baseUrl) throws Exception {
        String link = "abcd";
        String link2 = "./";
        String link3 = "./foo";
        System.out.println(resolve(baseUrl, link));
        System.out.println(resolve(baseUrl, link2));
        System.out.println(resolve(baseUrl, link3));
    }

    public static void main(String[] args) throws Exception {   
        String baseUrlStr = "http://www.somesite.com";
        URL baseUrl = new URL(baseUrlStr);
        resolveUrls(baseUrl);
        baseUrl = new URL(baseUrlStr + "/index.html");
        resolveUrls(baseUrl);
        baseUrl = new URL(baseUrlStr + "/path/index.html");
        resolveUrls(baseUrl);
    }

} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-13T21:56:56.453

你可以试试这个

```
new URL(new URL(baseurl), link.replace("./"), ""); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-14T01:09:17.393

*这是一个很长的帖子，虽然内容丰富，但在很大程度上没有帮助，但实际上最后有一个答案。*

这都是一个有点悲伤的故事。这显然是完全疯狂的：

```
URI base = new URI("http", "example.org", null, null);
URI link = new URI(null, null, "index.html", null);
System.out.println(base.resolve(link)); 
```

应该打印：

```
http://example.orgindex.html 
```

而不是：

```
http://example.org/index.html 
```

然而它确实如此。为什么？因为[`java.net.URI`](http://docs.oracle.com/javase/7/docs/api/java/net/URI.html)...

> [表示由RFC 2396](https://www.rfc-editor.org/rfc/rfc2396)定义的 URI 引用：统一资源标识符 (URI)：通用语法

并且忠实地这样做。特别是，该[`resolve`](http://docs.oracle.com/javase/7/docs/api/java/net/URI.html#resolve%28java.net.URI%29)方法...

> 以符合 RFC 2396[第 5.2 节的方式构造新的分层 URI](https://www.rfc-editor.org/rfc/rfc2396#section-5.2)

遗憾的是，第 5.2 节中指定的算法是错误的。具体来说，虽然它说...

> 路径组件永远不会未定义，尽管它可能为空

它不能确保针对具有空路径的基本 URI 解析相对 URI 的结果是有效的 URI。问题出在第 6 步，它处理将来自基本 URI 和相对 URI 的路径合并到一个缓冲区中，该缓冲区将用于形成解析的 URI。步骤 6 的前两个子步骤是：

> a) 除了基 URI 的路径组件的最后一段之外的所有部分都被复制到缓冲区。换句话说，最后一个（最右边的）斜线字符之后的任何字符（如果有）都将被排除。
> 
> b) 引用的路径组件附加到缓冲区字符串。

如果基础 URI 的路径为空，则在子步骤 a 之后，缓冲区将为空。如果相对 URI 有一个不以 / 开头的路径，那么在子步骤 b 之后，缓冲区将包含一个不以 / 开头的字符串。以下步骤处理点规范化，并且不添加前导 /。最后一步是：

> h) 剩余的缓冲区字符串是引用 URI 的新路径组件。

因此，解析的 URI 有一个不以 / 开头的路径。然后，第 7 步将其构建为已解析 URI 的最终字符串形式，而无需任何插入 / 的规定。因此，将没有前导 / 的相对 URI 解析为具有空路径的基本 URI 会导致胡说八道。这是 RFC 2396 指定的内容，也是`java.net.URI`如此。

哎呀！

故事并没有就此结束。2005 年 1 月，发布了[RFC 3986](https://www.rfc-editor.org/rfc/rfc3986)。此已过时的 RFC 2396，并在[第 5.2 节](https://www.rfc-editor.org/rfc/rfc3986#section-5.2)中再次包含 URI 解析的新定义。这个定义以更严格（或至少看起来很严谨）的风格完全重写，并在[5.2.3 节](https://www.rfc-editor.org/rfc/rfc3986#section-5.2.3)中指定了路径的合并，首先要做到这一点：

> 如果基本 URI 具有已定义的权限组件和空路径，则返回由“/”与引用路径连接的字符串

因此，如果更新 Java 以符合 8 年前的 RFC，而不是 14 年前的 RFC，整个问题就会得到解决。这样做是[错误 6791060](http://bugs.sun.com/view_bug.do?bug_id=6791060)中所要求的，该错误于 2009 年开放，最后一次触及是在 2010 年。孙，我很失望。

无论如何，有了这种理解，我们可以看到正确的解决方案是：

```
public static URI fix(URI uri) {
    if (uri.getPath().isEmpty()) {
        try {
            return new URI(uri.getScheme(), uri.getAuthority(), "/", uri.getQuery(), uri.getFragment());
        }
        catch (URISyntaxException e) {
            AssertionError ae = new AssertionError("highly implausible error fixing URI " + uri);
            ae.initCause(e);
            throw ae;
        }
    }
    else {
        return uri;
    }
}

fix(new URI(baseurl)).resolve(link); 
```

# java - 键绑定代码不起作用

> ID：15993331
> 
> 赞同：1
> 
> 时间：2013-04-13T21:52:57.530
> 
> 标签：java, key-bindings

我一直在尝试学习如何在 Java 中使用键绑定。这是我到目前为止所拥有的，但它似乎没有工作。当我按“w”时，它应该打印“你好！”。但是按'w'什么也没做。

```
import java.awt.*;
import java.awt.event.*;
import java.net.*;
import java.util.HashMap;
import java.util.Map;
import javax.swing.*;

public class Space extends JPanel {

    public static void createAndShowUI() {
        JFrame frame = new JFrame("Space");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.getContentPane().add(new Space());
        frame.pack();
        frame.setVisible(true);

        Action wKey = new AbstractAction() {
        public void actionPerformed(ActionEvent e) {
        System.out.println("Hello");
    };    
    }; 

        InputMap im = frame.getRootPane().getInputMap(JComponent.WHEN_ANCESTOR_OF_FOCUSED_COMPONENT);
        ActionMap am = frame.getRootPane().getActionMap();
        im.put(KeyStroke.getKeyStroke("w"),"doSomething");
        am.put("doSomething", wKey);

    }

    public static void main(String[] args) {
        java.awt.EventQueue.invokeLater(new Runnable() {

            @Override
            public void run() {
                createAndShowUI();
            }
        });

    }} 
```

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-13T22:05:15.137

1）您正在更改错误的 InputMap：

```
//InputMap im = frame.getRootPane().getInputMap(JComponent.WHEN_ANCESTOR_OF_FOCUSED_COMPONENT);
InputMap im = frame.getRootPane().getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW); 
```

2）您创建的 KeyStroke 不正确。该字符串应包含使用 KeyEvent_VK? 时找到的值。

因此，在您的情况下，您可以使用“W”，它将映射到 KeyEvent.VK_W。这将映射到“w”的 keyPressed。

您还可以对 keyTyped 事件进行绑定：

```
im.put(KeyStroke.getKeyStroke('w'),"doSomething"); // or
im.put(KeyStroke.getKeyStroke("typed w"),"doSomething"); 
```

# java - Primefaces fileUploadSingle 不显示

> ID：15993332
> 
> 赞同：0
> 
> 时间：2013-04-13T21:53:00.857
> 
> 标签：java, html, spring, jsf, primefaces

我想在我的应用程序中使用[fileUploadSingle](http://www.primefaces.org/showcase/ui/fileUploadSingle.jsf)：

但是，当我添加组件时。什么都没有显示。

```
<h:form enctype="multipart/form-data">  

    <p:fileUpload fileUploadListener="#{fileUploadController.handleFileUpload}"  
            mode="advanced"   
            update="messages"  
            sizeLimit="100000"   
            allowTypes="/(\.|\/)(gif|jpe?g|png)$/"/>  

    <p:growl id="messages" showDetail="true"/>  

</h:form> 
```

我在用：

```
 <junit-version>4.8.2</junit-version>
        <mockito-version>1.9.0</mockito-version>
        <dbunit-version>2.2</dbunit-version>
        <hibernate-version>4.0.1.Final</hibernate-version>
        <hibernate-validator-version>4.2.0.Final</hibernate-validator-version>
        <c3p0-version>0.9.1.2</c3p0-version>
        <spring-version>3.1.1.RELEASE</spring-version>
        <aspectj-version>1.5.4</aspectj-version>
        <jsf-version>2.1.3_01</jsf-version>
        <primefaces-version>3.0.M1</primefaces-version> 
```

我还在我的应用程序中包含了`commons-fileupload`和`commons-io`。但是，我的页面上没有显示任何内容

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T10:02:01.247

您是否在 web.xml 中添加了以下代码？

```
<filter>
    <filter-name>PrimeFaces FileUpload Filter</filter-name>
    <filter-class>org.primefaces.webapp.filter.FileUploadFilter</filter-class>
</filter>
<filter-mapping>
    <filter-name>PrimeFaces FileUpload Filter</filter-name>
    <servlet-name>Faces Servlet</servlet-name>
</filter-mapping> 
```

# asp.net - SortedDictionary 的扩展方法 OrderByDescending 不适用于网页 ASP.NET C#

> ID：15993335
> 
> 赞同：1
> 
> 时间：2013-04-13T21:53:33.657
> 
> 标签：asp.net, dictionary, sorteddictionary

我正在尝试按`SortedDictionary`..中的值对项目进行排序

我已经做到了，`mySortedDictionary.OrderByDescending(key => key.Value);`它返回排序的键值对..

但以同样的方式，我`OrderByDescending`在 ASP.NET 网页中使用方法，但是说

> System.Collections.Generic.SortedDictionary' 不包含 'OrderByDescending' 的定义，并且找不到接受类型为 'System.Collections.Generic.SortedDictionary' 的第一个参数的扩展方法 'OrderByDescending'（您是否缺少 using 指令或装配参考？）

我怎样才能在我的网页中实现这个操作？

任何替代技术？？？

提前致谢..

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-13T21:55:58.687

`OrderByDescending`是`System.Linq`.

确保您在班级顶部有相关的 using statemenet

`using System.Linq;`

# php - CakePHP 中 SSL 的最佳实践

> ID：15993337
> 
> 赞同：1
> 
> 时间：2013-04-13T21:53:54.247
> 
> 标签：php, .htaccess, cakephp, ssl, https

我想为所有页面实现 HTTPS。

我使用带有“Auth”组件的 CakePHP 2.3。

实际上，我发现的唯一一种方法是添加“beforeFilter-condition”。

但这很脏，因为由于 Auth-Component，我有很多“非 SSL”请求。

*AppController.php* --->

```
class AppController extends Controller {

  public function beforeFilter() {
    if (env("SERVER_PORT") != "443") {
      $this->Security->blackHoleCallback = 'forceSSL';
      $this->Security->requireSecure();
    }
  }

  public function forceSSL() {
    $this->redirect('https://' . env('SERVER_NAME') . $this->here);
  }

} 
```

当我未登录并尝试访问我的网站时出现问题

*   *请求 --> 响应（因为）*
*   GET hxxp://MYSITE/ --> **302** hxxp **s** ://MYSITE/ (beforeFilter-redirection)
*   GET hxxp **s** ://MYSITE/ --> **302** hxxp://MYSITE/users/login (Auth 组件)
*   GET hxxp://MYSITE/users/login --> **302** hxxp **s** ://MYSITE/users/login (beforeFilter-redirection)
*   获取 hxxp **s** ://MYSITE/users/login --> **200**
*   POST hxxp **s** ://MYSITE/users/login（带有凭据）--> **302** hxxp://MYSITE/（身份验证组件）
*   获取 hxxp://MYSITE/ --> **302** hxxp **s** ://MYSITE/
*   获取 hxxp **s** ://MYSITE/ --> **200**

所以，你知道另一种方法吗？

注意：我不得不强制在 core.php 中保护我的 cookie，因为它们不是。

核心.php --->

```
Configure::write('Session', array(
  'defaults' => 'php',
  'ini' => array(
    'session.cookie_secure' => true
  ))); 
```

请注意，我还尝试通过修改 .htaccess 来强制使用 SSL，但我得到的只是无限循环。

编辑 ：

CakePHP 中默认的 .htaccess 是

```
<IfModule mod_rewrite.c>
   RewriteEngine on
   RewriteRule    ^$ app/webroot/    [L]
   RewriteRule    (.*) app/webroot/$1 [L]
</IfModule> 
```

我试图添加的内容：

```
RewriteCond %{SERVER_PORT} 80 
RewriteRule ^(.*)$ https://www.example.com/$1 [R,L] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T21:46:07.917

最后，我选择的解决方案是：

*   删除 /app/webroot/.htaccess 和 /app/.htaccess

*   将 /.htaccess 修改为

.htaccess --->

```
RewriteEngine on
RewriteCond %{SERVER_PORT} !^443$
RewriteRule .* https://%{SERVER_NAME}%{REQUEST_URI} [R,L] 
```

*   在 Cake 中禁用 URL 重写

核心.php --->

```
Configure::write('App.baseUrl', env('SCRIPT_NAME')); 
```

现在访问是通过**hxxps://www.mysite.com/index.php/controller/action**

# opengl - 矩阵变换的Opengl顺序

> ID：15993339
> 
> 赞同：17
> 
> 时间：2013-04-13T21:54:09.020
> 
> 标签：opengl, matrix, transformation

假设我有一个蓝色的 3D 框（顶部为红色）。

1.  现在我调用 glScalef(1, 10, 1)。
2.  然后我调用 glRotatef(90, 0, 1, 0)。
3.  然后我渲染立方体。

我期望看到红色的一面朝向屏幕（沿模型的 Y 轴）伸展。

但我看到的是：红色的一面朝向屏幕（如预期的那样）。但是拉伸发生在视图空间（而不是模型）的 Y 轴上。

我知道如果我沿 Z 轴设置比例，那么我会得到正确的结果。但我的困惑是，我认为在 Y 轴上放大，然后旋转盒子，会给我正确的结果。

我错过了什么？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-04-14T02:13:53.987

OpenGL 以所谓的[`column major`顺序](http://en.wikipedia.org/wiki/Row-major_order#Column-major_order)读取它的矩阵。结果是每个后续操作都是之前所有操作的预乘，而不是后乘。因此，对 OpenGL 操作（glScale、glTranslate、glRotate）的每个*后续调用都是影响对象的****第一***件事，并且它的顺序与您编写它的顺序相反。

因此，您需要更改乘法顺序：

```
glRotatef(90, 0, 1, 0); // Notice how this is the first operation ...
// ... but will be applied after
glScalef(1, 10, 1); // This will be applied first, but is the last operation
// Zany, right? 
```

说实话，当您编写程序并使用计算机必须以相反的顺序指定事物时，感觉不太直观。但是，被决定的图形之神就是他们希望 OpenGL 的矩阵堆栈的行为方式（以及 HLSL、GLSL 和其他系统：请参阅上面关于列优先排序的链接）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-17T00:56:55.333

如果您有一个表示 4x4 矩阵的数组，如下所示：

```
float mat[16] = { 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15 }; 
```

并将其加载到 OpenGL 矩阵中，OpenGL 将看到前 4 个浮点数作为矩阵的第一列，第二个 4 个浮点数作为第二列，第三个 4 个浮点数作为矩阵的第 3 列，依此类推。

因此，每 4 个浮点数，OpenGL 将其视为另一列。这称为列主要顺序。它将数据存储在列中。如果您必须转置一个以列为主的矩阵，它最终会成为一个以行为主的矩阵，反之亦然。

因为您有一个以列为主的矩阵，所以您还需要使用列向量，这意味着您的乘法顺序将为：**M*v**。

为了向自己证明这一点，请使用一个带有 2x1 列向量的简单 2x2 矩阵，乘以**M*v**。设 K=transpose(M)，r=行向量 (1x2)。

那么 **M * v** = **r * K**

最重要的是，一旦您在代码中使用列或行主要符号，您就必须坚持下去。

# c++ - 是否可以将统一初始化和构造函数结合起来？

> ID：15993343
> 
> 赞同：2
> 
> 时间：2013-04-13T21:54:53.977
> 
> 标签：c++

我知道我可以通过使用数组来存储 Matrix 的数据来做到这一点。

```
Matrix<2, 2> m = { 1, 2
                   3, 4 }; 
```

但是我想这样做并改用向量，因为当矩阵变大并且堆栈空间用完时，使用数组非常糟糕

```
Matrix m(2, 2) = { 1, 2
                   3, 4 }; 
```

可以这样做（或类似的事情）吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-14T13:16:49.347

如果您在编译时有固定大小，但想使用动态分配，您可以单独选择每个对象的分配类型（“堆栈”/“堆”）或将动态分配构建到`Matrix`类中。

类外动态分配的一个例子`Matrix`。请注意，使用初始化列表可以防止在编译时检查传递给 ctor at 的元素数量（而不是通过声明`contexpr`的实例`Matrix`）。因此，我引入了一个相当愚蠢的补充来演示编译时大小检查。

```
#include <memory>
#include <iostream>
#include <array>

template < typename T, std::size_t rows, std::size_t columns >
struct Matrix
{
public:
    Matrix(std::initializer_list<T> p)
    {
       if(p.size() != rows*columns) { /* throw */ }

       std::copy( p.begin(), p.end(), storage_member.begin() );
    }
    Matrix(std::array<T, columns*rows> const& p)
    {
       std::copy( p.begin(), p.end(), storage_member.begin() );
    }

    Matrix(std::initializer_list< std::initializer_list<T> > p)
    {
       if(p.size() != rows) { /* throw */ }

       auto itRow = p.begin();
       for(std::size_t row = 0; row < rows; ++row, ++itRow)
       {
          if(itRow->size() != columns) { /* throw */ }

          auto itCol = itRow->begin();
          for(std::size_t col = 0; col < columns; ++col, ++itCol)
          {
             storage_member[col+row*columns] = *itCol;
          }
       }
    }
    Matrix(std::array<std::array<T, columns>, rows> const& p)
    {
       for(std::size_t row = 0; row < rows; ++row)
       {
          for(std::size_t col = 0; col < columns; ++col)
          {
             storage_member[col+row*columns] = p[row][col];
          }
       }
    }

    // getters, setters
    T& operator() (std::size_t row, std::size_t col)
    {
        return storage_member[col+row*columns];
    }
private:
    // storage, e.g.
    std::array<T, columns*rows> storage_member;
};

template < typename T, typename... TP>
constexpr std::array<T,sizeof...(TP)+1> m(T&& p, TP... pp)
{
   return {{p, pp...}};
}

// usage:
int main()
{
   using My_Matrix_Type = Matrix < int, 2, 2 >;

   std::unique_ptr < My_Matrix_Type > pmyMatrix0{ new My_Matrix_Type( {1,2,3,4} ) };
   std::unique_ptr < My_Matrix_Type > pmyMatrix1{ new My_Matrix_Type( {{1,2},{3,4}} ) };

   // with compile-time size checks
   std::unique_ptr < My_Matrix_Type > pmyMatrix2{ new My_Matrix_Type( m(1,2,3,4) ) };
   std::unique_ptr < My_Matrix_Type > pmyMatrix3{ new My_Matrix_Type( m(m(1,2), m(3,4)) ) };
   // a more fancy but possible syntax, would require some additional effort:
   //std::unique_ptr < My_Matrix_Type > pmyMatrix4{ new My_Matrix_Type( b(1,2)(3,4) ) };

   std::cout << (*pmyMatrix0)(1,1) << std::endl;
   std::cout << (*pmyMatrix1)(1,1) << std::endl;
   std::cout << (*pmyMatrix2)(1,1) << std::endl;
   std::cout << (*pmyMatrix3)(1,1) << std::endl;
} 
```

在上面的示例中，您可以立即用`storage_member`动态分配的数组替换以使动态分配内置。

* * *

如果您在编译时不知道大小，则必须将动态分配构建到`Matrix`类中（如上所述）。正如您可以推断出 2 级初始化器列表的大小（列、行），您只需删除采用固定大小数组的 ctor 并更改采用 1 级初始化器列表的 ctor，例如：

```
template < typename T > // no size parameters!
struct Matrix
{
    Matrix(std::size_t columns, std::size_t rows, std::initializer_list<T> p);
    Matrix(std::initializer_list< std::initializer_list<T> > p);
    // maybe an additional ctor for dynamically allocated arrays

    // getters, setters, data members
};

// usage:
Matrix myMatrix0( 2, 2, {1,2,3,4} );
Matrix myMatrix1( {{1,2},{3,4}} ); 
```

# visual-studio-2010 - 在 Visual Studio 中自动设置选定的键盘快捷键

> ID：15993346
> 
> 赞同：3
> 
> 时间：2013-04-13T21:55:10.953
> 
> 标签：visual-studio-2010, visual-studio-2012, import, keyboard-shortcuts

Visual Studio 允许[导出和导入快捷键](http://msdn.microsoft.com/en-us/library/5zwses53.aspx)。然而，它似乎全有或全无。

我想将一个文件分发给其他开发人员，他们可以使用该文件来设置特定的快捷方式**，而不会丢失所有现有的自定义快捷方式。**

如果我使用导入和导出设置向导并编辑 .vssettings 文件以（例如）将 UserShortcuts 部分减少为以下内容：

```
<UserShortcuts>
    <Shortcut Command="View.ObjectBrowser" Scope="Global">Alt+=</Shortcut>
</UserShortcuts> 
```

导入它可以，但会清除所有其他自定义快捷方式。

*最好*的情况是我可以：

*   添加新的快捷方式
*   删除*冲突*的现有快捷方式
*   保留所有其他快捷方式（自定义或默认）
*   在 VS 2012 和 2010 中
*   无需花费数天时间开发自定义解决方案。

可以做到这一点，如果可以，怎么做？

# android - 一种将适配器与从不同资源获取的数据合并的方法

> ID：15993354
> 
> 赞同：0
> 
> 时间：2013-04-13T21:55:57.543
> 
> 标签：android, listview, adapter, listadapter, android-cursoradapter

我有一个 CursorAdapter 用于从数据库中获取的一些数据和从 WebService 中获取的另一组数据，有没有办法为他们两个使用一个适配器（所以我可以将它设置为单个 ListView）知道它们属于同类型？

我已经使用 Loader 实现从后台的两个数据源中获取。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T22:17:32.043

如果两个源都提供相同的类型，您应该能够使用自定义列表适配器。从您的加载程序调用 setList() 和适配器应该完成其余的工作。

下面是一个示例骨架实现：

```
public class MyListAdapter extends BaseAdapter {

private Context          context;
private LayoutInflater   layoutInflater;
private ArrayList<T> list;

public CartListAdapter(Context context) {
    this.context = context;
}

public void setList (ArrayList<T> list) {
    this.list = list;
}

@Override
public int getCount() {
    return ((list == null) ? 0 : list.size());
}

@Override
public Object getItem (int position) {
    //  In theory we should not be called if getCount() returned 0;
    return list.get(position);
}

@Override
public long getItemId (int position) {
    return position;
}

@Override
public View getView (int position, View convertView, ViewGroup parent) {

    }
    if (list == null) {
        //Incase something crazy happens put something here to allow graceful failure
    }

    ViewHolder holder = null;

    if (convertView != null)
        holder = (ViewHolder) convertView.getTag();
    if (holder == null) // not the right view
        convertView = null;
    if (convertView == null) {
        convertView = //your custom list view layout               

        holder = new ViewHolder();
        //Assign the different views to your holder

        convertView.setTag(holder);//Store the holder in the tag

    }
    else holder = (ViewHolder) convertView.getTag();

    //Populate your views from your list

    return convertView;
}

private LayoutInflater getLayoutInflator() {
    if (layoutInflater == null) {
        layoutInflater = (LayoutInflater)
                this.context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    }
    return layoutInflater;
}

static class ViewHolder {

         //Place your views here 
}   
} 
```

从您的评论看来，您正在寻找混合适配器。我以前没有尝试过实现这一点。我的第一个冲动是修改上面的骨架，使其具有一个公共方法，该方法设置一个布尔值来决定您正在使用哪个数据源。就像是：

```
public void useCursorData(boolean cursorIsSource) 
```

然后测试覆盖中的数据源，例如：

```
@Override
public int getCount() {//this was written in off the cuff so there might be some minor errors.
    if (cursorIsSource)
        return cursor.getCount();
    else
        return list.size();
} 
```

请记住，使用混合适配器可能会导致您的 onClickListeners 出现困难。例如，当使用游标时，位置是显示索引，id 是行 id。相反，当使用支持数组的适配器时，位置和 id 都引用数组中的位置。

# java - Iterator 的 remove 方法实际上是如何删除一个对象的

> ID：15993356
> 
> 赞同：32
> 
> 时间：2013-04-13T21:56:04.047
> 
> 标签：java, loops, collections, iterator

我们都知道，在迭代时从集合中删除对象的最安全“可能也是唯一安全”的方法是首先检索`Iterator`，执行循环并在需要时删除；

```
Iterator iter=Collection.iterator();
while(iter.hasNext()){
    Object o=iter.next()
    if(o.equals(what i'm looking for)){
        iter.remove();
    }
} 
```

我想了解但不幸的是还没有找到深入的技术解释是如何执行此删除，
如果：

```
for(Object o:myCollection().getObjects()){
    if(o.equals(what i'm looking for)){
        myCollection.remove(o);
    }
} 
```

will throw a `ConcurrentModificationException`，“从技术上讲”`Iterator.remove()`是做什么的？它会移除对象、中断循环并重新启动循环吗？

我在官方文档中看到：

> “删除当前元素。`IllegalStateException`如果尝试调用`remove()`之前没有调用 next() 则抛出。”

“删除当前元素”部分让我想到了在“常规”循环 => 中发生的完全相同的情况（执行相等测试并在需要时删除），但为什么迭代器循环 ConcurrentModification 安全？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-04-13T22:05:09.943

迭代列表时不能修改列表的原因是迭代器必须知道 hasNext() 和 next() 返回什么。

这是如何完成的是特定于实现的，但您可以查看 ArrayList/AbstractList/LinkedList 等的源代码。

另请注意，在某些情况下，您可以使用类似这样的代码作为替代：

```
List<Foo> copyList = new ArrayList<>(origList);
for (Foo foo : copyList){
  if (condition){
    origList.remove(foo);
  }
} 
```

但是这段代码可能会运行得稍微慢一些，因为必须复制集合（仅限浅复制）并且必须搜索要删除的元素。

另请注意，如果您直接使用迭代器，建议使用 for 循环而不是 while 循环，因为这会限制变量的范围：

```
for (Iterator<Foo> iterator = myCollection.iterator(); iterator.hasNext();){
...
} 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-04-13T22:04:22.097

Iterator 如何准确地移除元素取决于它的实现，对于不同的 Collections 可能会有所不同。绝对不会破坏你所处的循环。我刚刚查看了 ArrayList 迭代器是如何实现的，下面是代码：

```
public void remove() {
    if (lastRet < 0)
        throw new IllegalStateException();
    checkForComodification();

    try {
        ArrayList.this.remove(lastRet);
        cursor = lastRet;
        lastRet = -1;
        expectedModCount = modCount;
    } catch (IndexOutOfBoundsException ex) {
        throw new ConcurrentModificationException();
    }
} 
```

因此它检查并发修改，使用公共 ArrayList *remove*方法删除元素，并增加列表修改的计数器，以便在下一次迭代时不会抛出 ConcurrentModificationException。

# c# - 如何在另一个字符串C#中获取字符串的所有IndexOf实例

> ID：15993357
> 
> 赞同：4
> 
> 时间：2013-04-13T21:56:12.390
> 
> 标签：c#, .net

我有一个巨大的字符串（内容页面）我想获取子字符串实例的所有索引。

示例：**你好吗，****你**在哪里？

 **我如何在上面的句子中**获得所有人的索引。**

请帮忙。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-13T22:06:34.157

您可以使用以下扩展。它[`IndexOf`](http://msdn.microsoft.com/en-us/library/vstudio/ms224423.aspx)在一个带有重载的循环中使用，它允许传递您想要开始搜索的索引。循环直到它返回`-1`并将找到的索引添加到集合中：

```
public static IList<int> AllIndexOf(this string text, string str, StringComparison comparisonType)
{
    IList<int> allIndexOf = new List<int>();
    int index = text.IndexOf(str, comparisonType);
    while(index != -1)
    {
        allIndexOf.Add(index);
        index = text.IndexOf(str, index + 1, comparisonType);
    }
    return allIndexOf;
} 
```

您以这种方式使用它：

```
string text = " How are you and where are you?";
var allIndexOf = text.AllIndexOf("you", StringComparison.OrdinalIgnoreCase);
Console.WriteLine(string.Join(",", allIndexOf));  // 9,27 
```

`StringComparison`允许不区分大小写地搜索。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-13T21:57:52.873

您可以在循环中使用[带有 startIndex 参数](http://msdn.microsoft.com/en-us/library/7cct0x33.aspx)的IndexOf 方法，并将其传递`last_match_index + 1`给它。

就像是：

```
int pos=-1, count=0;

while((pos=str.IndexOf("you",pos+1))!=-1)
{
   count++;
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-04-13T21:59:43.937

```
string input = "How are you and where are you?";
var indexes = Regex.Matches(input, "you").Cast<Match>().Select(m => m.Index)
                   .ToList(); 
```**

# actionscript-3 - 如何在 ActionScript 3 中修改 Sprite 类？

> ID：15993359
> 
> 赞同：1
> 
> 时间：2013-04-13T21:56:24.503
> 
> 标签：actionscript-3, prototype, sprite

我想在 ActionScript-3 中为 Sprite 类添加更多功能。基本上添加变量和方法。我有这个我不太喜欢的工作解决方案，因为我需要通过其完整路径引用 Sprite：

```
package myPackage
{
    import flash.display.Sprite;
    import myPackage.Sprite;

    public class Sprite extends flash.display.Sprite
    {
        public function Sprite()
        {
            super();
            graphics.lineStyle(3, 0xff00ff);
            graphics.drawRect(0, 0, 64, 64);
            doStuff();
        }

        public function doStuff(): void
        {
            trace("hello world");
            if (Math.random() < 0.9)
                addChild(new myPackage.Sprite());
        }
    }
} 
```

尽管没有这两个导入，Java 编译器可以很好地处理，但缺少导入给了我这些错误：

*   错误：对 Sprite 的引用不明确。
*   错误：未找到基类 Sprite 的定义。

**是否有另一种方法可以将变量、属性和方法添加到 Sprite 并在之后使用新的 Sprite 作为类？如果进行原型设计，是否有一个简单易行的示例？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T22:38:52.180

I recommend picking another class name for your subclass. Even if you find a way to replace Adobe's Sprite with your own, this is a bad idea. Also, unless you have the source code for an existing subclass of Sprite, I recommend against trying to change it directly (eg. recompiling as a child of your Sprite class rather than Adobe's Sprite class).

Sprite is a very commonly used class, and you will probably want another developer to be able to follow your code some day. If you use 'EnhancedSprite' or similar, it will be obvious that there is more/different functionality available.

It is obvious why you need to use the full class path when you try to use the same class name. This will always be the case within your Sprite/EnhancedSprite file. If you really must use the name 'Sprite', You need to find a way to have your actionscript compiler import all of the Adobe classes except Sprite, plus your own sprite class.

If you want all sprite subclasses to extend from your improved class, you basically need to recompile them all (MovieClip being the big one I personally don't mess with under the hood). This is also a bad idea, because an existing subclass could have a method matching the name of your own method and would cause further problems. For example, if you have a method stop(), how will MovieClip be compiled? Before using 'doStuff' as a method name, you would have to check that no existing subclass of Sprite already has that as a method or variable name, whether public or private.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T21:28:50.573

首先，您的 myPackage.Sprite 类中不需要这一行：

```
import myPackage.Sprite; 
```

可能发生的情况是，在您创建此 Sprite 实例的任何类中，您都导入了两个 Sprite 类，但您没有在该类中明确指定包。

例如，如果在您的 Main 类中，您有以下导入：

```
 import flash.display.Sprite;
 import myPackage.Sprite; 
```

无论您在何处使用该类名，都需要明确。如果你不是，你很可能会得到你一直得到的错误。

例如，如果您同时导入了以下内容，则会出现该错误：

```
var mySprite:Sprite = new Sprite; 
```

您应该在适当的地方执行以下操作：

```
var mySprite:myPackage.Sprite = new myPackage.Sprite;
var regSprite:flash.display.Sprite = new flash.display.Sprite; 
```

另外，您是用 CS6 还是 Flash Builder 或 Flash Develop 编译？

# php - PHP - Mysql 语法错误

> ID：15993363
> 
> 赞同：-1
> 
> 时间：2013-04-13T21:56:59.720
> 
> 标签：php, mysql, syntax

**当我尝试运行该代码时，会出现该错误：** 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 '' 附近使用正确的语法

而且我不知道是什么问题，有人可以帮助我吗？

**代码：**

```
<?php include_once("includes/head.php"); ?>
<?php require_once("includes/connect/connect.php"); ?>
<?php require_once("includes/functions.php"); ?>
<?php require_once("includes/jquery.php"); ?>

<?php function friend_request_notification(){
global $db;
global $userid;

$userid = $_SESSION['userid'];

$query_id_see = "SELECT user_id FROM friend_requests WHERE user_id={$userid}";
$result_set3 = mysql_query($query_id_see, $db) or die(mysql_error());

$insert_table = "INSERT INTO friend_requests_notificated (id, user_id, user_id_requester)";
$change_table2 = mysql_query($insert_table) or die(mysql_error());

$select_table = "SELECT id, user_id, user_id_requester FROM friend_requests WHERE user_id={$userid}";
$change_table1 = mysql_query($select_table) or die(mysql_error());

if ($id_requests = mysql_fetch_array($result_set3)){

if ($id_requests2 = mysql_fetch_array($change_table2))
{
}

if ($id_requests1 = mysql_fetch_array($change_table1)) 
{
}

}
else
{
}

}

friend_request_notification();
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T21:59:00.230

您的插入查询是错误的。您指定了一堆要使用的字段，但不提供任何值：

```
INSERT INTO friend_requests_notificated (id, user_id, user_id_requester)
                                                                        ^^^^---?? 
```

它应该是

```
INSERT INTO ... (...) VALUES (x,x,x)
                     ^^^^^^^^^^^^^^^ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T21:59:16.597

在插入语句中，您应该给出一些值：

```
 $insert_table = "INSERT INTO friend_requests_notificated (id, user_id, user_id_requester) 
                     values (..."; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-13T22:00:03.310

INSERT 语句可能会产生语法错误。

*基本*INSERT 语句的格式为：

插入 [table] 值 ([val1], [val2], ...);

# opengl - 在OpenGL中使用统一参数（使用glm）

> ID：15993365
> 
> 赞同：0
> 
> 时间：2013-04-13T21:57:21.757
> 
> 标签：opengl, glm-math

我必须执行以下操作：“将纹理拆分为多个部分。你有一个纹理，你应该传递纹理坐标 az uniform 参数。”

具体来说，我有 15 个立方体，我想应用一个纹理来覆盖它们的上侧（制作一张大图）

问题是，我不知道统一参数是什么，以及如何使用它来解决问题。它可能与这些方法之一有关吗？[http://www.khronos.org/opengles/sdk/docs/man/xhtml/glUniform.xml](http://www.khronos.org/opengles/sdk/docs/man/xhtml/glUniform.xml)

以下是我的代码的相关部分：

```
struct Vertex
{
    glm::vec3 p;
    glm::vec3 c;
    glm::vec2 t; // texture coordinates
}; 
```

-

```
 Vertex vert[] =
    { 

//          x,  y, z             R, G, B
        {glm::vec3(0, 0, 0), glm::vec3(1, 1, 1)}, //0
        {glm::vec3(1, 0, 0), glm::vec3(1, 1, 1)}, //1
        {glm::vec3(0, 1, 0), glm::vec3(1, 1, 1)}, //2

        {glm::vec3(1, 1, 0), glm::vec3(1, 1, 1)}, //3
        {glm::vec3(0, 0, 1), glm::vec3(1, 1, 1)}, //4

        {glm::vec3(1, 0, 1), glm::vec3(1, 1, 1)}, //5

        {glm::vec3(0, 1, 1), glm::vec3(1, 1, 1)}, //6

        {glm::vec3(1, 1, 1), glm::vec3(1, 1, 1)}, //7

    };

    GLushort indices[]=
    {       

        6,7,2,
        7,3,2,

        0,1,4,
        1,5,4,

        6,2,4,
        2,0,4,

        7,6,5,
        6,4,5,

        3,7,1,
        7,5,1,

        2,3,0,
        3,1,0,

    }; 
```

-

```
for(int i=0; i<15; i++)
{
    m_matWorld[i] = glm::translate<float>( (float)(i%4), (float)(i/4), 0.0f);
} 
```

-

```
for(int i=0; i<15; i++)
        {
glUniformMatrix4fv( m_loc_world, 1, GL_FALSE, &(m_matWorld[i][0][0]) ); //az elso i azt jelenti, h hanyadik kockarol van szo a 15-bol
            glDrawElements( GL_TRIANGLES, 36, GL_UNSIGNED_SHORT, 0);

        } 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-13T23:28:04.913

统一是一个着色器变量，对于所有顶点/片段都是恒定的。可以在[http://www.opengl.org/wiki/Uniform_(GLSL)](http://www.opengl.org/wiki/Uniform_%28GLSL%29)找到更好的解释，并且您在上面链接的页面具有您可以设置它的所有方式

# actionscript-3 - 从子类访问 b2world

> ID：15993369
> 
> 赞同：0
> 
> 时间：2013-04-13T21:57:43.287
> 
> 标签：actionscript-3, flash, box2d

我试图在舞台上放置一个对象（Object.as）并让它引用（Main.as）_world：b2world。我怎么能做到这一点？

来自 Main.as（文档类）

```
public class Main extends MovieClip {

        public var World:b2World;
} 
```

如何从已使用自己的类添加到舞台的对象中访问变量 World？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T03:24:55.807

您需要传递`World`给您创建的对象。您可以通过将其直接设置为属性或将其传递给 Objects 构造函数来实现。

```
public class YourObject
{
    private var world:b2World;

    public function YourObject(world:b2World):void
    {
        this.world = world; // store a reference to world, now you can use `world` in this class
    }
} 
```

现在从 Main.as 创建对象时，您可以将世界传递给构造函数。

```
public class Main extends MovieClip 
{

    public var World:b2World;
    public function test():void
    {
        var obj:YourObject = new YourObject(World);
    }
} 
```

# php - 使用 PHP 获取并输出 html 的源代码（shoutcast 7.html）

> ID：15993371
> 
> 赞同：1
> 
> 时间：2013-04-13T21:57:53.957
> 
> 标签：php, html

您好，我正在寻找一些 html 并将其显示在另一个页面上。我正在做一个直播服务器，我想从 7.html 中获取歌曲标题，但我只需要歌曲的标题。只是我尝试过 fsockopen 的注释，但我的网络主机阻止了它，所以我无法连接并获取这样的歌曲标题。

html 的源代码如下所示

```
<HTML><meta http-equiv="Pragma" content="no-cache"></head><body>0,1,0,5000,0,96,SONG TITLE HERE</body></html> 
```

我只需要显示“SONG TITLE HERE”我将如何仅将该信息设置为 php 变量

我知道下面的方法，但这里的问题是它会得到一切。我只需要源html的一部分。

```
<?php
$homepage = file_get_contents('http://www.example.com/');
echo $homepage;
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T22:07:46.367

```
<?php
    $doc = new DOMDocument;
    $doc->loadhtmlfile('http://www.example.com/');

    $body = $doc->getElementsByTagName('body');
    $content = $body->item(0)->textContent;

    $arr = explode(',', $content);

    $song = end($arr);
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T22:06:09.193

尝试这样的事情：

```
<?php
$content = file_get_contenst("7.html");
$dom = new DOMDocument();
$dom->loadHTML($content);

$body = $dom->getElementsByTagName('body');

$info = $body->item(0)->nodeValue;

$infoArr = str_getcsv($info);

$title = array_pop($infoArr);
?> 
```

有很多方法可以处理这个。你也可以使用这样的东西：

```
preg_match("/<body>(.*?)<\/body>/i", $html, $matches); 
```

而不是 DOMDocument。或explode() 而不是str_getcsv()。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-05T20:12:11.423

我能够使用 iframe 从服务器的 7.html 中获取所有内容

adeneo 答案本来可以完美的，但是我的主机不允许我以这种方式连接到其他服务器。

# python - 第一类到第二类的局部变量

> ID：15993372
> 
> 赞同：0
> 
> 时间：2013-04-13T21:57:57.043
> 
> 标签：python, class, variables, local

有什么办法可以让局部变量从一等到二等？

```
class Position:
    positionX = 0.0   #starting value of positionX, but I need to change this in counting method when I push arrow key

    def counting(self, posX):
        self.positionX = posX   #posX is for example position X of my cursor which I move with arrows so value is changing when I push to arrow key.

class Draw:
    posInst = Position()
    print posInst.positionX   #here I need to get positionX variable from Position class. But its show me just 0.0\. I need to get exact value which is change when I push arrow key and its change in counting method. If I push arrow key and value in counting method will be 20 I need this number in Draw class. But everytime is there 0.0. 
```

有什么办法可以做到这一点？感谢您的建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T23:18:33.603

在您的代码中显示该行的原因

```
print posInst.positionX 
```

prints 0.0 是因为 Draw 创建了它自己的 Position 实例，您没有调用它的计数方法来更改它。

```
class Position:
    positionX = 0.0

    def counting(self, posX):
        self.positionX = posX

class Draw:
    posInst = Position()
    posInst.counting(20)
    print posInst.positionX

draw = Draw() 
```

在您的实际代码中，Draw 类实际上是在创建自己的 Position 类实例。

如果是，那么当您想调用计数时，您可以执行 draw_instance.posInst.counting(value)。

如果您要创建一个单独的位置实例，您想直接调用其计数方法，那么您最好传入以绘制位置实例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T10:21:59.283

所以它以这种方式工作。

```
class Position:
    def __init__(self):
        self.positionX = 0.0

    def counting(self, posX):
        self.positionX = posX

def mainLoop:
    position = Position()

    while running:
        position.positionX 
```

我在另一堂课上尝试过，但它只是循环工作。但它的工作。谢谢大家的建议：）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-14T06:13:21.223

执行此操作的“正确”方法是`get`在您的`Position`类中包含一个方法，该方法返回`positionX`. 直接访问其他类的内部变量被认为是不好的做法。

```
class Position:
    positionX = 0.0

    def counting(self, posX):
        self.positionX = posX

    def getPosition(self):
        return self.positionX

class Draw:
    posInst = Position()
    print posInst.getPosition() 
```

# plugins - JavaFX 和 Applet 沙盒模型

> ID：15993374
> 
> 赞同：0
> 
> 时间：2013-04-13T21:58:06.493
> 
> 标签：plugins, applet, javafx-2, ria, intranet

鉴于最近对 Web 浏览器 Java 插件安全问题的恐慌，我发现广泛的 JavaFX 热情有点奇怪。

我对完全基于 Java 的客户端 Web 技术不是很熟悉。我想小应用程序几乎不在图片中，但是在互联网上使用时，FX 不应该有相同的沙盒模型安全问题吗？

Oracle 对 JavaFX 的热情主要是为内网保留的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T22:40:23.280

> Is Oracle's JavaFX enthusiasm mainly reserved for intranets?

No, you can use JavaFX also as standalone application or with Java Web Start.

There are even some native package bundlers.

# html - 仅缩放 HTML 元素高度

> ID：15993376
> 
> 赞同：0
> 
> 时间：2013-04-13T21:58:41.150
> 
> 标签：html, height, scale

我有一张表格，其中单元格高度设置为不同的固定值。现在我希望这张表在某些动作上进行缩放，以便单元格宽度保持不变，但高度将按相同的因子缩放。

当然，我可以使用 JavaScript 循环遍历所有单元格并为它们设置高度，但我希望能发现一些只能缩放高度的单一幻数。

这种可能性存在吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T22:03:48.690

用 jQuery 制作很简单

```
$('td').each(function(){
    $(this).css({height:$(this).height(),width:'auto'});
}); 
```

或者您只需要在需要时在您的 CSS 中设置 width:auto

# php - Drupal 7 / CiviCRM 4.2.8 - 合并联系人

> ID：15993378
> 
> 赞同：0
> 
> 时间：2013-04-13T21:58:57.637
> 
> 标签：php, drupal-7, civicrm

我是 CiviCRM 的新手，我很好奇是否有允许自动完成合并联系人功能的配置？

我已经阅读了有关“Strict”和“Fuzzy”两种规则类型的文档，听起来 Strict 正是我想要的，因为它会在通过在线注册事件创建新联系人时自动运行。

我想要这样做，以便从活动的在线注册创建的新联系人将与属于特定家庭的现有联系人合并。

目前，CiviCRM 根据活动在线注册信息创建新联系人，但不会将其与具有与配置严格规则以将联系人标记为重复的相同信息的联系人合并。

如果我进入合并规则并手动运行它，它将找到两个联系人并将它们显示为重复，所以我想知道为什么当通过在线注册创建新联系人时它不合并它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T11:16:27.670

感谢您试用 CiviCRM！

我认为您发现的问题已在 CiviCRM 的最新版本中得到解决，问题是联系人仅在事件注册时的电子邮件地址上匹配，有效地忽略了严格的规则。

这是JIRA问题

[http://issues.civicrm.org/jira/browse/CRM-12117](http://issues.civicrm.org/jira/browse/CRM-12117)

如您所见，它已在 CiviCRM 4.2.9 中修复

谢谢

Parvez Saleh（Veda Consulting Limited - 英国 CiviCRM 咨询公司）

# javascript - 检查输入的值是否匹配每次击键

> ID：15993385
> 
> 赞同：0
> 
> 时间：2013-04-13T21:59:21.717
> 
> 标签：javascript, jquery

在每个键上，或者在用户输入一个字母后，我需要检查它是否匹配或匹配两个单词之一。如果键入的内容等于或更长且不等于其中一个短语，我将运行我的自定义 fail() 函数。如果匹配，则如果第一个单词匹配，则我使用参数 1 运行 pass 函数，如果第二个单词匹配，则使用参数 2 运行。

现在，我正在使用大量 if 和 else if 语句来检查值，使用 .val(), === 短语来执行此操作。if 语句位于页面上唯一输入的 keyup 函数内。

必须有比所有这些比较陈述更好的方法来做到这一点。可能在键上检查 val 是否开始匹配或确实匹配数组中的任何短语。如果它确实匹配数组中的任何短语（每个元素都是一个元素），则运行 pass() ，参数是数组+1中匹配单词的索引。当它的长度等于或更长且不等于数组中的任何短语时，运行 fail() 函数。

我该怎么做？

或者如果您有更好的解决方案，请分享。

以下是会导致通过的内容：“帮助”或“搜索”。

会导致失败的事情：'serach'（开始匹配，但长度相等但不匹配）、lpeh（长度相等但不匹配）'或'bike'（长度相等但不匹配' t 匹配），或 'dealt'（长度较长且不匹配），或 'editor'（长度相等且不匹配），或 'magazine'（长度较长且不匹配）。

感谢您提供的所有帮助——我非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T22:08:02.270

尝试这个：

1.  创建一个允许的字符串数组。
2.  遍历数组。
    *   当输入和数组条目相等时，返回数组索引 (+1)。
    *   如果 array_entry.indexOf(input) 为 0 则退出（即输入是数组条目的开头）
3.  到达数组末尾时调用 fail()。

# matlab - 谱图分析

> ID：15993395
> 
> 赞同：-1
> 
> 时间：2013-04-13T22:00:22.683
> 
> 标签：matlab, audio, signal-processing, speech-recognition

我有一个使用 matlab 进行音频匹配的项目。所以，有几个正确和错误的声音文件。每个正确的文件都是一个人说“4,6,8”的声音。每个错误文件都有不同的数字序列，例如“6,4,8”或“4,8,6”。如果说正确的序列，我应该用 matlab 检测。因此，如果播放正确的声音，我必须显示“ACCEPTED”，如果播放错误的声音，我必须显示“NOT ACCEPTED”。

我知道我应该对每个正确的声音进行时间频率分析并识别一个模式。然后，我可以简单地为每个时间间隔设置一个频率阈值。EG：从 0.1 秒到 0.9 秒，如果频率为 1KHz，则显示“ACCEPTED”。

但是，我不知道如何为此编写程序。另外，如何获得时频分析中每个数字的频率的准确值？

到目前为止，这是我的规范图代码

```
[right1, Fs] = wavread('C:\Users\Fazrina\Downloads\CorrectSequence1');

figure (1)

subplot(2,1,1), plot(right1), axis('tight');

subplot(2,1,2), specgram(right1,512,Fs); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T22:56:40.950

这不是匹配频谱图图像的简单案例。单看频谱图分析，由于许多因素，您正在执行一项失败的任务。如果您不想深入 HMM 分析的阴暗面，那么动态时间扭曲与您获得可靠结果一样简单。[Dan Ellis](http://www.ee.columbia.edu/ln/labrosa/matlab/dtw/)在这方面有一些整洁的 Matlab 资料。

# python - Python 的 csv DictReader 为字段值返回“无”；有任何想法吗？

> ID：15993396
> 
> 赞同：0
> 
> 时间：2013-04-13T22:00:24.563
> 
> 标签：python, parsing, csv

我是一个菜鸟编码器，在使用 Python csv 模块解析 csv 文件时遇到问题。问题是我的输出显示该行中的字段值对于除第一个字段之外的所有字段都是“无”的。

这是我试图解析的丑陋 csv 文件中的第一行（其余行遵循相同的格式）：

```
0,213726,NORTH FORK SLATE CREEK,CAMPGROUND,North Fork Slate Creek Campground | Idaho |      Public Lands Information Center | Recreation Search, http://www.publiclands.org/explore/site.php?plicstate=ID&id=2268,NA,NA,NA,NA,(208)839-2211,"Nez Perce National Forest  Operating Days: 305<br>Total Capacity: 25<br>

5 campsites at the confluence of Slate Creek and its North Fork. A number of trails form loops in the area. These are open to most traffic, including trail bikes.","From Slate Creek, go 8 miles east on Forest Road 354.",NA,http://www.publiclands.org/explore/reg_nat_forest.php?region=7&forest_name=Nez%20Perce%20National%20Forest,NA,NA,NA,45.6,-116.1,NA,N,0,1103,2058 
```

这是我为解析 csv 文件而编写的代码（它不能正常工作！）：

```
import csv

#READER SETTINGS
f_path = '/Users/foo'
f_handler = open(f_path, 'rU').read().replace('\n',' ')
my_fieldnames = ['col1', 'col2', 'col3', 'col4', 'col5', 'col6', 'col7', 
'col8', 'col9', 'col10', 'col11', 'col12', 'col13', 'col14', 'col15', 
'col16', 'col17', 'col18', 'col19', 'col20', 'col21', 'col22', 'col23', 
'col24','col25']
f_reader = csv.DictReader(f_handler, fieldnames=my_fieldnames, delimiter=',', dialect=csv.excel)

#NOW I TRY TO PARSE THE CSV FILE
i = 0
for row in f_reader:
    print "my first row was %s" % row
    i = i + 1
    if i > 0:
        break 
```

这是输出。它说除了第一个之外的所有字段都是空白的，我不知道为什么！任何建议将不胜感激。

```
my first row was {'col14': None, 'col15': None, 'col16': None, 
'col17': None, 'col10': None, 'col11': None, 'col12': None, 
'col13': None, 'col18': None, 'col19': None, 'col2': None, 'col8': None, 
'col9': None, 'col6': None, 'col7': None, 'col4': None, 'col5': None, 
'col3': None, 'col1': '0', 'col25': None, 'col24': None, 
'col21': None, 'col20': None, 'col23': None, 'col22': None} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-13T22:22:41.000

尝试这个：

```
#!/usr/bin/env python

import csv

my_fieldnames = ['col' + str(i) for i in range(1,26)]

with open('input.csv', 'rb') as csvfile:
    my_reader = csv.DictReader(csvfile, fieldnames=my_fieldnames,
                               delimiter=',', dialect=csv.excel,
                               quoting=csv.QUOTE_NONE)

    for row in my_reader:
        for k,v in row.iteritems():
            print k, v 
```

第一行输入的输出（记住字典是无序的）：

```
col14 None
col15 None
col16 None
col17 None
col10 NA
col11 (208)839-2211
col12 "Nez Perce National Forest  Operating Days: 305<br>Total Capacity: 25<br>
col13 None
col18 None
col19 None
col8 NA
col9 NA
col6  http://www.publiclands.org/explore/site.php?plicstate=ID&id=2268
col7 NA
col4 CAMPGROUND
col5 North Fork Slate Creek Campground | Idaho |      Public Lands Information Center | Recreation Search
col2 213726
col3 NORTH FORK SLATE CREEK
col1 0
col25 None
col24 None
col21 None
col20 None
col23 None
col22 None 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-07T15:57:27.263

不同的软件系统称为 CSV 的事物的世界变化很大。幸运的是，Python 出色的 CSV 模块非常擅长处理这些细节，因此您无需手动处理这些事情。

让我强调一些使用@metaperture 的答案的东西，但没有解释：您可以通过自动检测方言来避免在 Python 中读取 CSV 文件的所有猜测。一旦你确定了那个部分，就不会再有更多的错误了。

让我给你一个简单的例子：

```
 import csv

    with open(filename, 'rb') as csvfile:
        dialect = csv.Sniffer().sniff(csvfile.read(10024))
        csvfile.seek(0)
        qreader = csv.reader(csvfile, dialect)
        cnt = 0
        for item in qreader:
            if cnt >0:
                #process your data
            else:
                #the header of the csv file (field names)    
            cnt = cnt + 1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-07T15:27:46.420

当你这样做时：

```
f_handler = open(f_path, 'rU').read().replace('\n',' ') 
```

您正在删除所有换行符，这就是 csv.excel 方言检测新行的方式。由于文件只有一行，它只会返回一次。

此外，您正在执行以下操作：

```
if i > 0:
    break 
```

在第一次迭代后终止你的 for 循环。

关于为什么它们是空白的，默认的 restval 是 None （参见[http://docs.python.org/3.2/library/csv.html](http://docs.python.org/3.2/library/csv.html)），所以键可能不匹配。尝试不包括 fieldnames 参数，您可能会看到您在这种方言中的键是沿着“col2”、“col3”或类似的行。

我用的一个可爱的小包装：

```
def iter_trim(dict_iter):
#return (dict(zip([k.strip(" \t\n\r") for k in row.keys()], [v.strip(" \t\n\r") for v in row.values()])) for row in dict_iter)
 for row in dict_iter:
    try:
        d =  dict(zip([k.strip(" \t\n\r") for k in row.keys()], [v.strip(" \t\n\r") for v in row.values()]))
        yield d
    except:
        print "row error:"
        print row 
```

示例用法：

```
def csv_iter(filename):
    csv_fp = open(filename)
    guess_dialect = csv.Sniffer().sniff(csv_fp.read(16384))
    csv_fp.seek(0)
    csv_reader = csv.DictReader(csv_fp,dialect=guess_dialect)
    return iter_trim(csv_reader)
for row in csv_iter("some-file.csv"):
    # do something...
    print row 
```

# html - 将 Favicon 添加到网站

> ID：15993397
> 
> 赞同：0
> 
> 时间：2013-04-13T22:00:37.143
> 
> 标签：html, web, favicon

所以我试图在我的网站上添加一个网站图标，但每次我打开网站时，网站图标都不会显示。所以在我的主模板文件中，我有这个：

```
<link rel="icon" type="image/ico" href="images/favicon.ico"  /> 
```

但我的网站看起来像这样： ![在此处输入图像描述](https://i.stack.imgur.com/FyzFe.jpg)

我试过刷新缓存并进入隐身模式，但似乎没有任何效果......有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T22:02:21.087

看看[https://code.google.com/p/chromium/issues/detail?id=51270](https://code.google.com/p/chromium/issues/detail?id=51270)。似乎`file://`在 Chrome 中使用 favicon 不起作用。如果您想看到问题得到解决，请给问题加注星标！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T22:23:10.000

首先是做一些大多数转速忽略的事情。几个月前，我写了一篇博客文章，其中包含一些关于网站图标的资源。

[网络性能提示添加网站图标](http://professionalaspnet.com/archive/2012/04/30/Web-Performance-Tip_3A00_-Make-Sure-You-Have-a-FavIcon.aspx)

# javascript - 为什么这个简单的回调函数不起作用？

> ID：15993401
> 
> 赞同：0
> 
> 时间：2013-04-13T22:01:14.523
> 
> 标签：javascript, jquery, callback

我第一次尝试使用回调函数并且无法使其正常工作。这是我的代码的简化版本：

```
var unsavedChanges = 1;

function saveData(callback)
{
    // save data

    if(typeof callback === "function")
    {
        unsavedChanges = 0;
        callback.apply(arguments);
    }
}

function nextStep(val)
{
    if(unsavedChanges == 1)
    {
        saveData(nextStep, val);
        return false;
    }

    console.log(val);
}

nextStep("test"); 
```

JSFiddle：http: [//jsfiddle.net/tXqn3/](http://jsfiddle.net/tXqn3/)

在我真正的“saveData”函数中，我正在使用保存数据，并且函数`$.ajax()`中有回调`.done()`。因此，这样，如果页面上有未保存的数据，则将其保存，然后执行调用的原始函数。

使用此代码，该值`undefined`会在代码运行时打印到控制台。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-13T22:10:40.127

您的代码有两个问题。

首先看下定义`apply`：[https ://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/apply](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/apply)

您缺少第一个参数`thisArg`，它应该`this`在您应用的函数中使用。

其次，我认为您实际上并不想通过`arguments`申请。你想要的只是第一个参数，因为第一个参数是`callback`. 因此，您可以使用`Array.prototype.slice.call(arguments).slice(1)`获取除第一个参数之外的所有参数，并将其传递给`apply`.

这是这些更改的工作小提琴：http: [//jsfiddle.net/UkdT7/1/](http://jsfiddle.net/UkdT7/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T22:08:29.723

如果您想使用接受参数的回调，最简单、惯用的方法是传递一个处理参数传递的闭包：

```
var unsavedChanges = 1;

function saveData(callback)
{
    // save data

    if(typeof callback === "function")
    {
        unsavedChanges = 0;
        callback(); // no callback.apply
    }
}

function nextStep(val)
{
    if(unsavedChanges == 1)
    {
        saveData(function () { 
            nextStep(val);
        });
        return false;
    }

    console.log(val);
}

nextStep("test"); 
```

[http://jsfiddle.net/mattball/YxDkg](http://jsfiddle.net/mattball/YxDkg)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-13T22:08:48.990

apply 函数将 thisArg 作为第一个参数，然后将数组作为第二个参数，所以你需要这样做

```
callback.apply(this,arguments); 
```

[https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/apply](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/apply)

# .net - 如何查找 DLL 的 .NET 版本

> ID：15993402
> 
> 赞同：0
> 
> 时间：2013-04-13T22:01:15.433
> 
> 标签：.net, frameworks

我有几个第三方 DLL 并怀疑它们在使用最新的 .NET 框架编写时会引起问题。

有人可以建议找出编写 DLL 的 .NET 版本的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T03:31:25.710

足够好的反编译器应该向您显示程序集的预期运行时版本，

[http://www.lextm.com/2013/02/how-to-tell-net-45-only-assemblies.html](http://www.lextm.com/2013/02/how-to-tell-net-45-only-assemblies.html)

正如我在博文中所写，JustDecompile 就是这样的反编译器之一。对于 ILSpy，需要对其进行修补以区分 .NET 4 和 4.5。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T22:07:53.210

您可以使用 MSIL 反汇编程序 (ildasm.exe) 查看包含所用版本的清单信息。这是一个带有说明的链接：

[http://geekswithblogs.net/gpro/archive/2008/08/27/determine-.net-framework-version-of-an-application.aspx](http://geekswithblogs.net/gpro/archive/2008/08/27/determine-.net-framework-version-of-an-application.aspx)

# java - 我的函数中的意外输出

> ID：15993405
> 
> 赞同：0
> 
> 时间：2013-04-13T22:01:55.347
> 
> 标签：java

```
public class Backhand {
    int state = 0;

    Backhand(int s) {
        state = s;
    }

    public static void main(String... hi) {
        Backhand b1 = new Backhand(1);
        Backhand b2 = new Backhand(2);
        System.out.println( b2.go(b2));
    }

    int go(Backhand b) {
        if(this.state ==2) {
            b.state = 5;
            go(this);
        }
        return ++this.state;
    }
} 
```

当它运行时，它输出 7。我认为 `++this.state;`应该在方法 go 中只执行一次，输出应该是 6。有人可以解释这里发生了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T22:03:35.243

更改`++this.state`为`this.state++`，它工作正常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T22:09:57.197

你得到 7 的原因是因为你`go(this)`在自己内部调用了`go`方法，所以最后`state`会增加两次。

# php - 使用带有 MD5 的 RAND 在 MYSQL 唯一字段中生成唯一键。可能的？可接受的做法？

> ID：15993406
> 
> 赞同：6
> 
> 时间：2013-04-13T22:02:07.300
> 
> 标签：php, mysql, random, md5, unique

我正在尝试为我的网站实施一个简单的密码重置系统。这个想法是这样的：

1.  用户请求密码重置链接。
2.  CodeIgniter 系统通过 MYSQL 使用 RAND 和 MD5（我知道它不安全且损坏，可能最好使用 SHA1 或更好，不是重点）通过 MYSQL 生成随机字符串并将其散列，产生 32 位密钥。
3.  向用户发送包含密钥的链接。
4.  其余的相当明显。

我想知道是否——

答：MYSQL 函数 RAND 与 MD5（或更好）被生成到设置为 UNIQUE 的字段中，如果它们碰巧生成了该字段下的表中已经存在的键，则会自动重新生成。

B：这是一种可接受的生成密码重置链接的方法。还是最好用盐对用户的电子邮件地址进行哈希处理以防止重复？

显然，这只是围绕整个过程的基本实现和安全需求。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T22:09:06.403

对简单、可预测的值使用更复杂的散列并没有多大意义。将电子邮件用作盐会有所帮助——但作用不大。如果您只需要一个随机值，那么为什么不使用随机值 - 用伪密码修饰它对安全性没有帮助（它实际上在这里破坏了它）。只需生成一个随机数（实际上，您可能想要生成几个随机数，转换为更紧凑的基数并连接）并将其与登录信息一起存储（您需要保留原始密码并在用户登录时取消解锁无论如何成功）。

# python - Flask：如何在会话中存储凭据并检索它们？

> ID：15993408
> 
> 赞同：2
> 
> 时间：2013-04-13T22:02:12.683
> 
> 标签：python, rest, authentication, flask, flask-sqlalchemy

我正在做一个项目，我的每个`REST`端点都需要经过身份验证。一个例子是

```
@login_required
def get_transactions(self):
  pass 
```

我有一个`User`看起来像的模型

```
class User(UserMixin, db.Model):
    __tablename__ = 'users'
    # noinspection PyShadowingBuiltins
    uuid = Column('uuid', GUID(), default=uuid.uuid4, primary_key=True,
                  unique=True)
    email = Column('email', String, nullable=False, unique=True)
    _password = Column('password', String, nullable=False)
    created_on = Column('created_on', sa.types.DateTime(timezone=True),
                        default=datetime.utcnow(), nullable=False)
    last_login = Column('last_login', sa.types.DateTime(timezone=True),
                        onupdate=datetime.utcnow())

    def __init__(self, email, password):
        self.email = email
        self._password = hash_password(password) # hash_password does md5 of password 
```

*   用户登录后，我想在客户端会话中存储一个安全令牌，并希望每个进一步的请求都拥有该令牌
*   我查找了示例，但不明白如何在客户端会话 PLUS 中保存这样的安全令牌
*   如何确保进一步的请求从客户端会话向我发送该令牌。

我不知道它是如何工作的，请帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T22:36:40.710

There is no way for a server to make REST clients accept and return cookies. Web browsers will do it under certain conditions when the user logs in manually, but unless your service is accessed only by interactive web applications hosted in the same domain and every user has an account on your service, you might as well forget this approach. (Even CORS won't help for browsers/users that refuse cross-domain cookies.)

The most common solution is requiring the REST client to send its credentials in every request, often using standard http auth headers, and securing the transmission with https.

OAuth/OAuth2 can be useful here if you want to separate authentication from authorization, at the expense of simplicity.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T22:17:44.320

你见过这个例子吗？[http://flask.pocoo.org/docs/patterns/viewdecorators/?highlight=login_required](http://flask.pocoo.org/docs/patterns/viewdecorators/?highlight=login_required)

如果您不想自己重写这些东西，那么还有这样的模块：

*   [http://pythonhosted.org/Flask-Login/](http://pythonhosted.org/Flask-Login/)
*   [http://pythonhosted.org/Flask-Auth/](http://pythonhosted.org/Flask-Auth/)

无论如何，至于在会话中存储数据，这应该是相当容易的。简单地把它放在flask.session中：

```
import flask
# You want to automatically generate the token and store it somewhere on the server (database for example)
flask.session['some_token'] = some_token 
```

您的令牌可能是这样的：

```
class Session(db.Model):
    token = Column('token') # auto generated thingy
    # foreign key to user for example
    # expiration time/date 
```

# python - 垂直/居中打印列表 - 帕斯卡三角

> ID：15993409
> 
> 赞同：0
> 
> 时间：2013-04-13T22:02:19.183
> 
> 标签：python, python-2.7

我很困惑似乎是一个简单的问题。一切都被正确计算和显示。我希望它水平打印并居中。此外，删除括号和逗号的方法将是加号。

```
from math import factorial
numcheck = False
while numcheck == False:
try:
    height = (raw_input("Input height of Pascal's Triangle (must be integer): "))
    height = int(height)
    numcheck = True
except ValueError:
    print "Not an integer!"
pascaltri = [[factorial(n) // (factorial(k) * factorial(n - k)) for k in range(n+1)]
 for n in range(height)]
print pascaltri 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T22:47:09.340

你可以这样格式化：

```
maxlen = len(" ".join([str(i) for i in pascaltri[-1]]))
formatted = '\n'.join([ " ".join([str(i) for i in line]).center(maxlen) for line in pascaltri])
print formatted 
```

但是看看 Fredrik 的链接，有很多有趣的想法，包括更有效的生成三角形的方法。

# python - Python二十一点：如果语句不起作用

> ID：15993414
> 
> 赞同：-1
> 
> 时间：2013-04-13T22:03:08.437
> 
> 标签：python, if-statement, python-3.x, blackjack

嘿，我正在努力在 Python 中为我的二十一点游戏添加投注，由于某种原因，我的代码现在不会首先通过 if 语句。任何帮助将不胜感激。

我的代码如下：

```
def play(): 
       """ Function that involves all gameplay and allows the user to play blackjack. All 
   other functions are to support the gameplay while this function covers the actual 
   gameplay. """

   #initializing a counter for how many times the user has played
   global total_play_count

   #total winnings of a player if they already played from last hand
   global total_winnings 

   if total_play_count == 0:
        play_count = 0
   else: 
        play_count = total_play_count

    #setting a variable to hold the users total cash
    if play_count == 0: 
        winnings = 100
    else: 
        winnings = total_winnings

    #dealing user and dealer their cards
    global user_show_cards 
    global dealer_show_cards

    user_show_cards = [card(), card()]
    dealer_show_cards = [card(), card()]

    #declaring total variables
    global user_total 
    global dealer_total

    user_total = 0  
    dealer_total = 0

    #lists to hold numerical values of the hand
    global user_total_cards 
    global dealer_total_cards

    user_total_cards = [] 
    dealer_total_cards = []

    #initializing the values of cards and storing them in the lists above
    user_total_cards = ready_for_total(user_show_cards, user_total_cards, user_total)
    dealer_total_cards = ready_for_total(dealer_show_cards, dealer_total_cards, dealer_total) 

    #getting initial player totals
    user_total = sum(user_total_cards)
    dealer_total = sum(dealer_total_cards)

    #printing what is initially shown on screen
    print "" 
    print "Let's play Blackjack" 
    print "Note: Dealer stays on ALL 17s"
    print "" 
    if play_count == 0: 
        print "You start with $100"
    else: 
        pass
    bet = int(raw_input("Enter your bet: "))
    winnings -= bet
    print ""
    print "You now have $%s" %(winnings)
    print ""
    print "Your cards are %s %s" %(str(user_show_cards[0]), str(user_show_cards[1]))
    print "The dealer's up card is a(n) %s" %(str(dealer_show_cards[0])) 
```

> 代码不会通过上面的行

```
 #first condition to see if the player has Blackjack 
    if user_total == 21: 
        print "Blackjack! You Win!"
        bet1 = bet * 2
        print "You receive $%s" %(bet1) 
        winnings += bet + bet1
        print "Your winnings now total $%s" %(str(winnings))

    elif dealer_total == 21: 
        print "Dealer got Blackjack. You lose."
        print "" 
        print "You now have $%s" %(winnings)
    else: 
        total_winnings = winnings 
        return total_winnings
        hit_or_stay()  

    print ""
    play_again = raw_input("Play again? (y/n): ") 

    if play_again == "y": 
        total_winnings = winnings 
        play_count += 1
        total_play_count = play_count
        play() 
        return total_play_count 
        return total_winnings
    else: 
        print "" 
        print "Your winnings totaled $%s" %(winnings)
        print "Goodbye, come back soon!"

play() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T22:09:52.173

看起来 if 语句下的所有代码都是缩进的，我认为这不是您想要的。另外我认为 if 语句对你没有任何作用。

```
if total_play_count == 0:
        play_count = 0
   else: 
        play_count = total_play_count 
```

应该只是

```
play_count = total_play_count 
```

也不要使用全局变量。请不要。

# memory - 高全局内存指令开销 - 不知道它来自哪里

> ID：15993416
> 
> 赞同：1
> 
> 时间：2013-04-13T22:03:16.603
> 
> 标签：memory, cuda, gpu

我编写了一个内核来计算给定 D 维向量`q`（存储在常量内存中）和 N 个向量数组`pts`（也是 D 维）之间的欧几里德距离。

内存中的数组布局是这样的，前 N 个元素是所有 N 个向量的第一个坐标，然后是 N 个第二个坐标的序列，依此类推。

这是内核：

```
__constant__ float q[20];

__global__ void compute_dists(float *pt, float *dst,
        int n, int d) {
    for (int i = blockIdx.x * blockDim.x + threadIdx.x; i < n; 
             i += gridDim.x * blockDim.x) {
        float ld = 0;
        for (int j = 0; j < d; ++j) {
            float tmp = (q[j] - pts[j * n + i]); 
            ld += tmp * tmp;
        }
        dst[i] = ld;
    }
}r 
```

它的调用方式如下：

```
const int N = 1000000, D = 20;
compute_dists<<<32, 512>>>(vecs, dists, vec, N, D); 
```

现在，在 Quadro K1000M 上使用 NVIDIA Visual Profiler 分析此内核会导致以下警告：

*   高指令重播开销 (31.2%) 和
*   高全局内存指令开销 (31,2%)。

这对我来说非常令人惊讶，因为据我所知，内存访问是合并的（因为线程中的第一个扭曲`j * n + i`始终是`32`128 字节对齐的倍数）并且没有分支分歧。

是否还有其他一些因素会影响指令重播开销指标，或者我是否遗漏了其他内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-08T23:01:27.190

我认为您有来自“pts [j * n + i]”的高TLB（翻译后备缓冲区）未命中率的问题。连续的第 j 个元素很有可能不存在于加载的内存页面中，因为*n*很大。TLB 硬件在加载给定内存位置的页面所在的信息时具有很高的延迟。这会导致内存加载指令重播。如果缓存中不存在数据或页面未加载到 TLB，则重新发出每个内存加载指令。尽管我不完全确定后者，但可能就是这种情况。希望能帮助到你。我有同样的问题，但更严重，97% 重播。[我的问题](https://stackoverflow.com/questions/17004557/how-to-avoid-tlb-miss-and-high-global-memory-replay-overhead-in-cuda-gpus)也可能会回答你的问题。

# android - 将按钮添加到图库视图时出现 java.lang.NullPointerException

> ID：15993417
> 
> 赞同：0
> 
> 时间：2013-04-13T22:03:19.750
> 
> 标签：android, button, image-gallery

我试图在我的galleryview中添加按钮，当运行应用程序java.lang.NullPointerException时，该按钮将保存图像到sd卡：

我的画廊代码：

```
class InfiniteGalleryAdapter extends BaseAdapter { 
private Context mContext;
private int[] images;   
private String[] name;
public InfiniteGalleryAdapter(Context c, int[] imageIds,String[] names) { 
this.mContext = c; 
images = imageIds;
name=names;
inflater = (LayoutInflater)mContext.getSystemService (
Context.LAYOUT_INFLATER_SERVICE); }

public int getCount() { 
return Integer.MAX_VALUE; } 

public Object getItem(int position) { 
return position; } 

public long getItemId(int position) { 
return position; } 

private LayoutInflater inflater=null; 

public class ViewHolder{ 
public TextView text; 
public ImageView image; 
public Button button;}

public View getView(int position, View convertView, ViewGroup parent) { 
ImageView i = getImageView(); 

int itemPos = (position % images.length); 

try { i.setImageResource(images[itemPos]); ((BitmapDrawable)
i.getDrawable()).setAntiAlias(true); } 

catch (OutOfMemoryError e) { Log.e("InfiniteGalleryAdapter", "Out of
memory creating imageview. Using empty view.", e); } 

view vi=convertView; 
ViewHolder holder; 
if(convertView==null){ 
vi = inflater.inflate(R.layout.gallery_items, null); 
holder=new ViewHolder(); 
holder.text=(TextView)vi.findViewById(R.id.textView1); 
holder.image=(ImageView)vi.findViewById(R.id.image); 

////// HERE WHERE TO ADD BUTTON ////

holder.button=(Button)vi.findViewById(R.id.button_save);
holder.button.setOnClickListener(new OnClickListener() {

public void onClick(View arg0) {

Toast.makeText(getApplicationContext(), "button clicked", Toast.LENGTH_LONG).
show();}});

vi.setTag(holder); } 

else holder=(ViewHolder)vi.getTag(); 
holder.text.setText(name[itemPos]); 

final int stub_id=images[itemPos]; 
holder.image.setImageResource(stub_id); 

return vi; } 

private ImageView getImageView() { 

ImageView i = new ImageView(mContext); 

return i; } } 
```

**日志猫：**

```
 FATAL EXCEPTION: main
        java.lang.NullPointerException
  at android.widget.Toast.<init>(Toast.java:90)
  at android.widget.Toast.makeText(Toast.java:232)
  at com.test.demo.InfiniteGalleryAdapter$1.onClick(DayGallery.java:290)
  at android.view.View.performClick(View.java:2485)
  at android.view.View$PerformClick.run(View.java:9080)
  at android.os.Handler.handleCallback(Handler.java:587)
  at android.os.Handler.dispatchMessage(Handler.java:92)
  at android.os.Looper.loop(Looper.java:130)
  at android.app.ActivityThread.main(ActivityThread.java:3687)
  at java.lang.reflect.Method.invokeNative(Native Method)
  at java.lang.reflect.Method.invoke(Method.java:507)
  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run
          (ZygoteInit.java:867)
  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:625)
  at dalvik.system.NativeStart.main(Native Method) 
```

任何建议将不胜感激，谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T22:07:55.427

尝试改变你`Toast`的

```
Toast.makeText(mContext, "button clicked", Toast.LENGTH_LONG).
show(); 
```

至

```
Toast.makeText(DayGallery .this, "button clicked", Toast.LENGTH_LONG).
show(); 
```

我相信您需要使用您`Activity context`的附加`Toast`到您的`Activity`非应用程序上下文

如果这不能解决问题，则指出哪一行是 290。此行在 logcat 中

```
at com.test.demo.InfiniteGalleryAdapter$1.onClick(DayGallery.java:290) 
```

说有东西`null`在第 290 行

# javascript - HTML 明文编辑器：如何丰富“智能节标题”？

> ID：15993422
> 
> 赞同：2
> 
> 时间：2013-04-13T22:03:55.830
> 
> 标签：javascript, jquery, editor, selection, textrange

我正在尝试在 HTML 页面中创建一个（纯文本）编辑器。

我希望用户能够在编辑器内的任何地方创建节和小节标题。这些标题具有预定义的 CSS 和智能功能，例如控制部分展开/折叠或拖放部分移动的能力。

到目前为止，我已经创建了一个树状结构，其中包含多组部分标题，然后是文本区域。每个文本区域都包含上述（子）部分的文本。因此，有很多文本区域..

```
<div id="tree">
    <!-- tree root -->
    <div class="layoutitem"> <!-- a layoutitem groups an item (=tree or leaf) and some tools -->
      <div class="itemgroup">
        <div class="title">
          [<span class="data">My Document Title</span>]
          <a>title functions:</a>
          <a href="#" class="someTool">tools here</a>
        </div>
          <!-- this is a tree itemgroup -->
        <div class="tree">
          <!-- tree root -->
          <div class="layoutitem"> <!-- a layoutitem groups an item (=tree or leaf) and some    tools -->
            <div class="itemgroup">
              <div class="title">
                <span class="titledata">Summary</span>
                <a>title functions:</a>
                <a href="#" class="someTool">tools here</a>
              </div>
               <!-- this is a leaf with a text value -->
              <div class="text">
                <div>
                  <textarea class="textdata">here is some text.</textarea>
                </div>
                <div>
                  <a href="#" class="someTool">tools here</a>
                </div>
              </div>
            </div>
... 
```

用 JS 丰富它给了我我需要的功能，

除了：我无法弄清楚如何做到这一点，以便用户可以跨多个文本区域选择文本。这非常重要，因为就像在“普通”编辑器中一样，应该可以跨节标题边界选择文本片段。

我没主意了。

*   有没有办法让我的标题和文本区域集合全面可选？
*   或者，我在这里没有看到简单的选项吗？我应该更好地使用基于 JS 的编辑器并以某种方式将这些部分添加为“特殊浮动元素”吗？这有多难？

如果该解决方案不适用于“旧”浏览器，我很好，需要像 jquery 或其他这样的框架。我只是希望任何能引导我进入一个好的方向的指针！

# c# - 带有关闭按钮的 WPF 自定义 TabItem

> ID：15993423
> 
> 赞同：0
> 
> 时间：2013-04-13T22:04:10.877
> 
> 标签：c#, wpf, xaml, tabitem

我正在使用 WPF 和 C#。我正在尝试创建一个包含关闭按钮的自定义 TabItem。我确实遵循了一个教程并设法让它工作 - 但是我想使用图像作为我的关闭按钮。在尝试这个时，我遇到了一些例外。

System.Deployment.dll 中出现“System.Deployment.Application.InvalidDeploymentException”类型的第一次机会异常 mscorlib.dll 中出现“System.IO.DirectoryNotFoundException”类型的第一次机会异常“System.IO”类型的第一次机会异常PresentationCore.dll 中发生 .DirectoryNotFoundException 类型“System.IO.DirectoryNotFoundException”的第一次机会异常发生在 mscorlib.dll 中

我相信这是在抱怨找不到图像源。要设置图像源，我使用属性窗格并在源下拉菜单中选择适当的资源。这应该没问题，但它根本不合适。

我想知道是否有人可以告诉我该怎么做？这很奇怪，因为如果它说找不到资源，那么资源就在那里。我使用 Resources.resx 添加了图像，并将它们添加到我的 Resources 文件夹中。这一切都在那里......只是我的 XAML 不喜欢它。

这是我的 XAML

```
<UserControl x:Class="WpfApplication1.CloseableHeader"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
  xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
  mc:Ignorable="d" 
  d:DesignHeight="23" d:DesignWidth="81" Margin="0">
<UserControl.Resources>
    <Style TargetType="Button" x:Key="close_hover">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Button}">
                    <Image Source="pack://siteoforigin:,,,/Resources/CloseIco.png" />
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <Style TargetType="Button" x:Key="close_normal">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Button}">
                    <Image Source="pack://siteoforigin:,,,/Resources/CloseIco_BW.png" />
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
</UserControl.Resources>
<Grid>
    <Button
        Name="button_close"
        ToolTip="Close"
        HorizontalAlignment="Right"
        VerticalAlignment="Center"
        Margin="0,0,5,0"
        Width="14"
        Height="14"
        Style="{DynamicResource close_normal}"/>
    <Label Content="TabItem"  Height="23" HorizontalAlignment="Left" 
      Margin="4,1,0,0" Name="label_TabTitle" VerticalAlignment="Top" 
      FontFamily="Courier" FontSize="12" />
</Grid> 
```

我还应该注意，在 Visual Studio 的设计器视图中，它会按应有的方式显示选项卡（带有图像！）。

提前致谢。

* * *

更新

* * *

我现在在我的项目中走得更远，我面临的唯一问题是 Visual Studio 上的路径不存在，但是当我调试时 - 它们确实存在。资源文件夹位于 bin/Debug 内，因此图像将在调试时显示...但这意味着我将始终在设计器中出现错误。有没有办法解决这个问题，所以它适用于两者？

这是更新的 XAML（相当大的变化）

```
<UserControl x:Class="WpfApplication1.CloseableHeader"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
  xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
  mc:Ignorable="d" 
  d:DesignHeight="23" Margin="0">
<UserControl.Resources>
    <Style TargetType="{x:Type Button}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Button}">
                    <Border Name="border"
                            BorderThickness="0"
                    >
                        <Border.Background>
                            <ImageBrush ImageSource="pack://siteoforigin:,,,/Resources/CloseIco_BW.png" />
                        </Border.Background>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter Property="Background" TargetName="border">
                                <Setter.Value>
                                    <ImageBrush ImageSource="pack://siteoforigin:,,,/Resources/CloseIco.png" />
                                </Setter.Value>
                            </Setter>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
</UserControl.Resources>
<Grid Background="White">
    <Button
        Name="button_close"
        ToolTip="Close"
        HorizontalAlignment="Right"
        VerticalAlignment="Center"
        Margin="0,0,5,0"
        Width="14"
        Height="14"/>
    <Label Content="TabItem"  Height="23" HorizontalAlignment="Left" 
      Margin="4,1,19,0" Name="label_TabTitle" VerticalAlignment="Top" 
      FontFamily="Courier" FontSize="12" />
</Grid> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T07:18:36.670

有一种更简单的方法可以使用`Stackpanel`组件将图像（或任何您想要的）设置为按钮。此处的按钮将具有“close.ico”作为图标和“关闭”作为水平排列的文本

 `````
 <Button Name="button_close">
     <StackPanel Orientation="Horizontal">
      <Image Source="Resources\close.ico" Width="14" Height="14" />
      <TextBlock>
       <Run Text="Close" />
      </TextBlock>
     </StackPanel>
    </Button> 
````  `回到您的问题，通过 pack-URI 设置资源地址，除非您使用嵌入式资源/内容构建操作玩一些技巧，否则您不会显示它（实际上是已加载） - 但是您需要为应用程序提供文件; 改用直接链接 (Resources\close.ico)``

# backbone.js - Backbone.js - 从搜索结果中过滤集合

> ID：15993425
> 
> 赞同：0
> 
> 时间：2013-04-13T22:04:11.253
> 
> 标签：backbone.js, collections, filter

我正在使用浏览器 localStorage 用 Backbone.JS 对概念进行原型设计。希望更好地了解其结构并构建模型、集合以及 REST 服务应包含的内容。我遇到困难的场景是在显示匹配的结果表之前过滤集合（基于表单文本框）。

**从我的收藏：**

```
 initialize: function(){
    this._meta = {};

    this.meta("sortOrder", "asc");
    this.meta("sortColumn", "trackNumber");

    //this.fetch();
    console.log("TrackCollection - Initialize: Collection has " +  this.length + " items");
    if(this.length == 0) { 
        console.log("Generating new items into collection");

        var trackItem1 = new TrackModel();
        this.add(trackItem1);
        this.add(trackItem1);
        this.add(trackItem1);
        this.add(trackItem1);
        this.add(trackItem1);

    }

}

searchLocalStorage: function(trackItems) { 
    console.log("TrackCollection - searchLocalStorage: Collection has " +  this.length + " items before filter");

    if (trackItems == "") { 
        console.log("No Search terms provided");
        return this;
    }

    var searchTerms = trackItems.split(', ');

    console.log("Search Terms: " + _.isArray(searchTerms) + " / " + searchTerms.length + " / " + JSON.stringify(searchTerms));

    var filteredCollection = [];

    _(this.filter(function(data) {
        if( _.contains(searchTerms, data.get("trackNumber")) ) {
            console.log('Matched ' + data.get("trackNumber"));
            console.log(data);
            filteredCollection += data;
        }
    }));

    console.log(filteredCollection);
    this.reset(filteredCollection); 

    console.log("TrackCollection - searchLocalStorage: Now Collection has " +  this.length + " items");

}, 
```

**从我的搜索视图**

```
 var TrackSearchView = Backbone.View.extend({
el: $("#page"),

events: {
    'click #buttonTrackSearch': 'searchSubmit'
},

render: function(){
  $('.menu li').removeClass('active');
  $('.menu li a[href="'+window.location.hash+'"]').parent().addClass('active');
  this.$el.html(trackSearchTemplate);

  // add the sidebar 
  var sidebarView = new SidebarView();
  sidebarView.render();
},

searchSubmit: function (ev) {
    ev.preventDefault();

    console.log("View - TrackSearchView - searchSubmit");

    var searchData = $("#search").val();

    //this.collection.meta("searchData", searchData);

    this.collection = this.collection.searchLocalStorage(searchData);

    Backbone.history.navigate('summary', true); 
}, 
```

**从我的列表视图中：**

```
 var TrackSummaryView = Backbone.View.extend({
el: $("#page"),

events: {
    'click #summaryTrackItems thead th a': 'sortItemsByColumn'
},

render: function(){
  $('.menu li').removeClass('active');
  $('.menu li a[href="'+window.location.hash+'"]').parent().addClass('active');

  this.$el.html(trackSummaryTemplate);

  console.log("trackSummaryView - Collection has " + this.collection.length + " entries");
  this.collection.forEach(this.setupSummaryTableRow, this);

},

setupSummaryTableRow: function(trackItem) {
    var trackSummaryRowView = new TrackSummaryRowView({ model: trackItem, collection: this.collection});

    $(this.el).find("#summaryTrackItems").append(trackSummaryRowView.render().$el);
    return this;
}, 
```

**从我的路由器：**

```
 var initialize = function(){

var app_router = new AppRouter;

var trackCollection = new TrackCollection();

app_router.on('route:trackSearch', function(){

    var trackSearchView = new TrackSearchView({ collection: trackCollection });
    trackSearchView.render();

});

app_router.on('route:trackSummary', function(){

    var trackSummaryView = new TrackSummaryView({ collection: trackCollection});
    trackSummaryView.render();

});

Backbone.history.start();
 }; 
```

# arrays - 使用起始和长度说明符通过引用传递静态/动态数组的切片

> ID：15993428
> 
> 赞同：12
> 
> 时间：2013-04-13T22:04:18.123
> 
> 标签：arrays, delphi, slice

使用 ,将数组（动态或静态）传递给方法/过程/函数[`open array parameters`](http://docwiki.embarcadero.com/RADStudio/XE3/en/Parameters_%28Delphi%29#Open_Array_Parameters)，声明如下所示：

```
procedure WorkWithArray( const anArray : array of Integer);
(* or procedure WorkWithArray( var anArray : array of Integer); *)
var
  i : Integer;
begin
  for i := Low(anArray) to High(anArray) do
  begin
    // Do something with the "open array" anArray
    WriteLn(anArray[i]);
  end;
end;

...
var
  staticArray : array[0..2] of Integer;
  dynArray : array of integer;
  dynArrayG : TArray<Integer>;
begin
  SetLength(dynArray,10);
  SetLength(dynArrayG,10);

  WorkWithArray(staticArray);  // Using a static array
  WorkWithArray(dynArray);     // Using a dynamic array
  WorkWithArray(dynArrayG);    // Using a dynamic generic array
  ...
end; 
```

像这样传递数组是整个 Delphi RTL 中使用的一个非常常见的习惯用法，包括一些用于处理数据数组的非常优化的函数/过程。

* * *

假设我们需要调用`WorkWithArray`数组的子范围。然后我们可以使用内在[`Slice()`](http://docwiki.embarcadero.com/Libraries/XE3/en/System.Slice)函数。

首先没有偏移，从第一个索引开始：

```
Type
  // Helper declarations
  TIntLongArray = array[0..MaxInt div SizeOf(Integer) - 1] of integer;
  PIntLongArray = ^TIntLongArray;

WorkWithArray(Slice(staticArray,2)); // No type cast needed for static arrays
WorkWithArray(Slice(PIntLongArray(@dynArray)^,2));
WorkWithArray(Slice(PIntLongArray(@dynArrayG)^,2)); 
```

注意：动态数组不能直接放入`Slice()`函数中，请参阅[`"Slice does not work with dynamic arrays"`](http://qc.embarcadero.com/wc/qcmain.aspx?d=4669). 所以必须使用类型转换的解决方法。

* * *

如果我们想使用不是从第一个元素开始的子范围怎么办？

也可行：

```
WorkWithArray(Slice(PIntLongArray(@staticArray[1])^,2));
WorkWithArray(Slice(PIntLongArray(@dynArray[1])^,2));
WorkWithArray(Slice(PIntLongArray(@dynArrayG[1])^,2)); 
```

注意：偏移量和切片的总和不能超过数组的元素数。

> 我知道使用**Copy(myArray,x1,x2)**可以在输入声明为 const 的情况下使用，但这会复制数组，并且对于大型数组效率低下。（也有堆栈溢出的风险）。

* * *

最后，我的问题：

虽然这演示了一种通过引用使用起始索引和长度说明符来传递数组子范围的方法，但它看起来有点尴尬。有更好的选择吗？如果有，怎么做？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-13T22:04:18.123

**更新**了查看泛型解决方案。

这是一种替代方法，它封装了函数内部偏移所需的类型转换，该函数驻留在声明为类函数的高级记录中。除了隐藏类型转换之外，偏移量还根据数组的高索引进行范围检查。

如果需要，可以添加更多类型。

```
Type
  SubRange = record
    Type
      TIntLongArray = array[0..MaxInt div SizeOf(Integer) - 1] of integer;
      PIntLongArray = ^TIntLongArray;
      TByteLongArray = array[0..MaxInt div SizeOf(Byte) - 1] of Byte;
      PByteLongArray = ^TByteLongArray;

    class function Offset( const anArray : array of Integer; 
                                 offset  : Integer) : PIntLongArray; overload; static;
    class function Offset( const anArray : array of Byte; 
                                 offset  : Integer) : PByteLongArray; overload; static;
    // ToDo: Add more types ...
  end;

class function SubRange.Offset(const anArray : array of Integer; 
                                     offset  : Integer): PIntLongArray;
begin
  Assert(offset <= High(anArray));
  Result := PIntLongArray(@anArray[offset]);
end;

class function SubRange.Offset(const anArray : array of Byte; 
                                     offset  : Integer): PByteLongArray;
begin
  Assert(offset <= High(anArray));
  Result := PByteLongArray(@anArray[offset]);
end; 
```

注意：偏移量和切片的总和不能超过数组的元素数。

示例调用：

```
WorkWithArray( Slice(SubRange.Offset(staticArray,1)^,2));
WorkWithArray( Slice(SubRange.Offset(dynArray,1)^,2));
WorkWithArray( Slice(SubRange.Offset(dynArrayG,1)^,2)); 
```

虽然这看起来更好，但我仍然不相信这是最佳解决方案。

* * *

**更新**

在编写上述解决方案时，我将泛型解决方案作为最终目标。

这是一个使用匿名方法和泛型来实现`Slice(anArray,startIndex,Count)` 可用于静态和动态数组的方法的答案。

直接的泛型解决方案将依赖于在使用它的每个位置关闭范围检查，这不是一个很好的解决方案。原因是`SizeOf(T)`不能用于声明最大大小的静态数组类型：

> TGenericArray = array[0..MaxInt div SizeOf(T) - 1] of T; // SizeOf(T) 未解析

所以我们必须使用：

> TGenericArray = array[0..0] of T;

反而。这会在它打开时触发范围检查，对于索引 > 0。

**解决方案**

但是这个问题可以通过另一种策略来解决，`callbacks`或者更现代的术语是`Inversion of Control`（IoC）或`Dependeny Injection`（DI）。最好用“不要打电话给我，我们打电话给你”来解释这个概念。

我们不使用直接函数，而是将操作代码作为匿名方法与所有参数一起传递。现在范围检查问题包含在`Slice<T>`框架内。

```
Slice<Integer>.Execute(
  procedure(const arr: array of Integer)
  begin
    WriteLn(Math.SumInt(arr));
  end, dArr, 2, 7); 
```

* * *

```
unit uGenericSlice;

interface

type
  Slice<T> = record
  private
    type
      PGenericArr = ^TGenericArr;
      TGenericArr = array [0..0] of T;
  public
    type
      TConstArrProc = reference to procedure(const anArr: array of T);
    class procedure Execute(       aProc: TConstArrProc;
                             const anArray: array of T;
                                   startIndex,Count: Integer); static;
  end;

implementation

class procedure Slice<T>.Execute(aProc: TConstArrProc;
  const anArray: array of T; startIndex, Count: Integer);
begin
  if (startIndex <= 0) then
    aProc(Slice(anArray, Count))
  else
  begin
    // The expression PGenericArr(@anArray[startIndex]) can trigger range check error
    {$IFOPT R+}
      {$DEFINE RestoreRangeCheck}
      {$R-}
    {$ENDIF}
    Assert((startIndex <= High(anArray)) and (Count <= High(anArray)-startIndex+1),
      'Range check error');
    aProc(Slice(PGenericArr(@anArray[startIndex])^, Count));
    {$IFDEF RestoreRangeCheck}
      {$UNDEF RestoreRangeCheck}
      {$R+}
    {$ENDIF}
  end;
end;

end. 
```

以下是一些示例用例：

```
program ProjectGenericSlice;

{$APPTYPE CONSOLE}

uses
  Math,
  uGenericSlice in 'uGenericSlice.pas';

function Sum(const anArr: array of Integer): Integer;
var
  i: Integer;
begin
  Result := 0;
  for i in anArr do
    Result := Result + i;
end;

procedure SumTest(const arr: array of integer);
begin
  WriteLn(Sum(arr));
end;

procedure TestAll;
var
  aProc: Slice<Integer>.TConstArrProc;
  dArr: TArray<Integer>;
  mySum: Integer;
const
  sArr: array [1 .. 10] of Integer = (
    1,2,3,4,5,6,7,8,9,10);

begin
  dArr := TArray<Integer>.Create(1, 2, 3, 4, 5, 6, 7, 8, 9, 10);

  aProc :=
    procedure(const arr: array of Integer)
    begin
      WriteLn(Sum(arr));
    end;

  // Test predefined anonymous method
  Slice<Integer>.Execute( aProc, dArr, 2, 7);

  // Test inlined anonymous method
  Slice<Integer>.Execute(
    procedure(const arr: array of Integer)
    begin
      WriteLn(Sum(arr));
    end, dArr, 2, 7);

  // Test call to Math.SumInt
  Slice<Integer>.Execute(
    procedure(const arr: array of Integer)
    begin
      WriteLn(Math.SumInt(arr));
    end, dArr, 2, 7);

  // Test static array with Low(sArr) > 0
  Slice<Integer>.Execute(
    procedure(const arr: array of Integer)
    begin
      WriteLn(Sum(arr));
    end, sArr, 3 - Low(sArr), 7);

  // Using a real procedure
  Slice<Integer>.Execute(
    SumTest, // Cannot be nested inside TestAll
    dArr, 2, 7);

  // Test call where result is passed to local var
  Slice<Integer>.Execute(
    procedure(const arr: array of Integer)
    begin
      mySum := Math.SumInt(arr);
    end, dArr, 2, 7);
  WriteLn(mySum);

end;

begin
  TestAll;
  ReadLn;
end. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-18T19:22:08.913

如何避免开放数组和切片并使用这样的东西？

```
type
   TArrayRef<T> = record
   strict private
     type PointerOfT = ^T;
     FItems: PointerOfT;
     FCount: Integer;
   public  
     // FItems := @AItems[Offset]; FCount := Count;
     constructor Create(AItems: array of T; Offset, Count: Integer);
     property Items[Index: Integer]: T read GetItem; // Exit(FItems[Index])
     property Count: Integer read FCount; 
   end;
   TArrayRef = record // helpers
     class function Create<T>(AItems: array of T; Offset, Count: Integer); static;
     class function Create<T>(AItems: array of T; Count: Integer); static;
     class function Create<T>(AItems: array of T); static;
   end; 

procedure WorkWithArray(const anArray : TArrayRef<Integer>);
var
  I: Integer;
begin
  for I := 0 to anArray.Count - 1 do WriteLn(anArray[I]);
end;

WorkWithArray(TArrayRef.Create(StaticArray, 3)); // first three items
WorkWithArray(TArrayRef.Create(DynArray, 10, 3)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-08-19T23:29:02.873

以防其他人像我一样被绊倒。在旧版本的 Delphi（D2007 和更早版本。不确定 XE 版本）中，如果使用重载，也会出现 E2193 错误：

```
 procedure Polygon(Points: array of TPoint); overload;
  procedure Polygon(Points: array of TDPoint); overload; 
```

如果删除过载有效：

```
 procedure Polygon(Points: array of TPoint); 
  procedure PolygonD(Points: array of TDPoint); 
```

这在 Delphi 10.3.0（可能还有其他旧版本）中已修复。

# ruby-on-rails - 3.2.12引擎同型号名称不同的厂妹怎么称呼？

> ID：15993437
> 
> 赞同：1
> 
> 时间：2013-04-13T22:05:15.963
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rspec, factory-bot, factory

projectx 和 customerx rails 3.2.12 引擎中都有 misc_definition 模型。在同一个 rails 应用程序中需要 Projectx 和 customerx。现在有一个关于如何调用具有相同型号名称但属于不同rails引擎的工厂女孩​​的问题：

customerx 中 misc_definition 的工厂女孩​​定义是：

```
factory :misc_definition, :class => 'Customerx::MiscDefinition' do
... 
```

文件名是`customerx_misc_definitions.rb`

projectx 中 misc_definition 的工厂女孩​​定义是：

```
factory :misc_definition, :class => 'Projectx::MiscDefinition' do
... 
```

文件名是`projectx_misc_definitions.rb`

下面是如何调用 rspec 中的工厂女孩​​（用于 customerx 中的 misc_definition）：

```
cate = FactoryGirl.create(:misc_definition, :for_which => 'customer_status', :name => 'order category') 
```

rspec 错误是：

```
c:/Ruby193/lib/ruby/gems/1.9.1/gems/factory_girl-4.2.0/lib/factory_girl/decorator.rb:10:in `method_missing': Factory already registered: misc_definiti
on (FactoryGirl::DuplicateDefinitionError) 
```

如何称呼同型号名称但属于不同rails引擎的工厂女孩​​？

# ios - iOS标签栏控制器：未选择标签项的主页消息

> ID：15993438
> 
> 赞同：0
> 
> 时间：2013-04-13T22:05:20.430
> 
> 标签：ios, uitabbarcontroller

我已经构建了一个基于 a 的 iOS 应用程序，其中`tab bar controller`包含多个`view controllers`.

当应用程序启动时，第一个视图控制器的视图出现（通常）。

我想打印一个与标签栏的视图控制器无关的“主页消息”。当用户单击选项卡时，将打印关联的视图。

这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T02:16:32.177

您只需要将视图添加到选项卡栏的视图层次结构中。完成后将其删除。

像这样的东西在标签栏视图的顶部添加了一个标签视图：

```
# somewhere in your .m:
UILabel *label;

# later on:
- (void)viewDidLoad
{
    [super viewDidLoad];
    label = [[UILabel alloc] initWithFrame:CGRectMake(20, 20, 140, 44)];
    [label setText:@"Hello"];
    [self.view addSubview:label];
} 
```

我在 中做过`viewDidLoad`，但你可以在任何对你的代码有意义的地方做。

然后，您可以使用以下方法使其消失：

```
# even further along:
- (void)tabBarController:(UITabBarController *)tabBarController didSelectViewController:(UIViewController *)viewController
{
    [label removeFromSuperview];
} 
```

每当触摸任何选项卡时，这都会使其消失。

# html - Bootstrap 导航栏活动

> ID：15993444
> 
> 赞同：7
> 
> 时间：2013-04-13T22:06:20.670
> 
> 标签：html, css, twitter-bootstrap, navbar

我正在使用引导程序中的导航栏，但是每当我单击其中一个页面标题时，导航栏都不会突出显示它以显示我在该页面上。例如，如果我在主页上，则导航栏如下所示：
![在此处输入图像描述](https://i.stack.imgur.com/Tx1Y1.jpg)

但是，如果我单击`About`，我会转到 About 页面，但导航栏仍然如下所示：
![在此处输入图像描述](https://i.stack.imgur.com/nOuwd.jpg)

如何让它突出显示它所在的页面？谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-13T22:09:47.873

阅读[文档](http://twitter.github.io/bootstrap/components.html#navbar)。您需要应用到要激活`class="active"`的元素。`li`它不会自动处理。您需要以您认为合适的方式实施它。

它可以是 JQuery 解决方案或服务器端解决方案。根据您网站的构建方式，任何一种都可能或多或少合适。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-07-09T11:01:40.813

我正在使用 MVC4、Razor 和 Bootstrap，最终使用了 coderwall.com ( [https://coderwall.com/p/hwtkng](https://coderwall.com/p/hwtkng) ) 的解决方案

```
<li @if (@ViewContext.RouteData.GetRequiredString("controller") == "Home") { @Html.AttributeEncode("class=active");}>
                        @Html.ActionLink("Home", "Index", "Home")
                    </li> 
```

# python - 用于高效添加、删除和随机选择的 Python 数据结构

> ID：15993447
> 
> 赞同：22
> 
> 时间：2013-04-13T22:06:38.267
> 
> 标签：python, data-structures

我正在寻找一个内置的 Python 数据结构，它可以在比 O(n) 时间更好的时间内`add`创建一个新元素、一个现有元素并选择一个随机元素。`remove`

我希望`set`可以做到这一点，但是 AFAIK，从 Python 集中选择随机元素的唯一方法是`random.choice(list(my_set))`，这需要 O(n) 时间。

我非常喜欢内置于 Python 中的解决方案，因为我需要效率和易于部署。不幸的是，Python 似乎没有内置的树数据类型。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-04-13T22:13:38.593

Python 没有满足您所有 3 个要求的*内置*数据结构。

也就是说，自己实现一棵树相当简单。

* * *

另一种选择是将字典与列表相结合，以创建有效的集合，该集合还维护其项目列表：

```
import random

class ListDict(object):
    def __init__(self):
        self.item_to_position = {}
        self.items = []

    def add_item(self, item):
        if item in self.item_to_position:
            return
        self.items.append(item)
        self.item_to_position[item] = len(self.items)-1

    def remove_item(self, item):
        position = self.item_to_position.pop(item)
        last_item = self.items.pop()
        if position != len(self.items):
            self.items[position] = last_item
            self.item_to_position[last_item] = position

    def choose_random_item(self):
        return random.choice(self.items) 
```

由于在列表上完成的唯一操作是`.pop()`、`.append()`和 索引检索和赋值，因此它们所花费的时间不应超过恒定时间（至少在大多数 Python 实现中）。

您可以使用额外的方法扩展上述定义以支持其他有用的操作，例如`len`、`in`和迭代：

```
class ListDict(object):
    ... # methods from above

    def __contains__(self, item):
        return item in self.item_to_position

    def __iter__(self):
        return iter(self.items)

    def __len__(self):
        return len(self.items) 
```

# php - 在 PHP 中读取 XML 和 JSON

> ID：15993449
> 
> 赞同：2
> 
> 时间：2013-04-13T22:06:48.313
> 
> 标签：php, xml, json, api

我正在尝试使用 PHP（我很陌生）从 API 读取一些数据。我对 JSON 不是很熟悉，也没有 XML 经验。那么，这是一个好的开始。

有问题的资源是：

[http://scores.nbcsports.msnbc.com/ticker/data/gamesMSNBC.js.asp?jsonp=true&sport=MLB&period=20130413](http://scores.nbcsports.msnbc.com/ticker/data/gamesMSNBC.js.asp?jsonp=true&sport=MLB&period=20130413)

查看此页面的来源，它似乎是相当结构化的。我试图在这个 url 上同时使用`file_get_contents`和`simplexml_load_file`来看看会发生什么。在第一种情况下，我只收到浏览器中显示的文本（在我未经训练的眼睛看来，这就像一个空数组）。第二种情况完全失败（“预期开始标签”）。

这些数据是什么格式的，我应该如何访问它？如何下拉数据，例如，提取某些标签的值？

**更新**

我忘了提到我也试图`json_decode`在 url 上回显无济于事。什么都没有回响。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-13T22:25:59.060

您的链接包括以下内容：

[http://scores.nbcsports.msnbc.com/ticker/data/gamesMSNBC.js.asp?jsonp=true&sport=MLB&period=20130413](http://scores.nbcsports.msnbc.com/ticker/data/gamesMSNBC.js.asp?jsonp=true&sport=MLB&period=20130413)

```
shsMSNBCTicker.loadGamesData({
"sport": "MLB", 
"period": "20130413", 
"games": [
"<ticker-entry gamecode=\"330413105\" gametype=\"Regular Season\" league=\"AL\"><visiting-team display_name=\"Chi White Sox\" alias=\"CWS\" nickname=\"White Sox\" id=\"4\" division=\"ALC\" league=\"AL\" score=\"4\"><score heading=\"1\" value=\"2\"></score><score heading=\"2\" value=\"0\"></score><score heading=\"3\" value=\"0\"></score><score heading=\"4\" value=\"0\"></score><score heading=\"5\" value=\"0\"></score><score heading=\"6\" value=\"0\"></score><score heading=\"7\" value=\"2\"></score><score heading=\"8\" value=\"0\"></score><score heading=\"R\" value=\"4\"></score><score heading=\"H\" value=\"6\"></score><score heading=\"E\" value=\"0\"></score></visiting-team><home-team display_name=\"Cleveland\" alias=\"Cle\" nickname=\"Indians\" id=\"5\" division=\"ALC\" league=\"AL\" score=\"9\"><score heading=\"1\" value=\"2\"></score><score heading=\"2\" value=\"0\"></score><score heading=\"3\" value=\"1\"></score><score heading=\"4\" value=\"0\"></score><score heading=\"5\" value=\"6\"></score><score heading=\"6\" value=\"0\"></score><score heading=\"7\" value=\"0\"></score><score heading=\"R\" value=\"9\"></score><score heading=\"H\" value=\"9\"></score><score heading=\"E\" value=\"1\"></score></home-team><gamestate status=\"In-Progress\" display_status1=\"Top\" display_status2=\"8th\" href=\"http://scores.nbcsports.msnbc.com/mlb/boxscore.asp?gamecode=330413105\" tv=\"CSN/STOh\" gametime=\"4:05 PM\" gamedate=\"4/13\" is-dst=\"1\" is-world-dst=\"1\" reason=\"\"></gamestate></ticker-entry>"
,"<ticker-entry gamecode=\"330413110\" gametype=\"Regular Season\" league=\"AL\"><visiting-team display_name=\"Baltimore\" alias=\"Bal\" nickname=\"Orioles\" id=\"1\" division=\"ALE\" league=\"AL\" score=\"5\"><score heading=\"1\" value=\"1\"></score><score heading=\"2\" value=\"1\"></score><score heading=\"3\" value=\"2\"></score><score heading=\"4\" value=\"1\"></score><score heading=\"5\" value=\"0\"></score><score heading=\"6\" value=\"0\"></score><score heading=\"7\" value=\"0\"></score><score heading=\"R\" value=\"5\"></score><score heading=\"H\" value=\"10\"></score><score heading=\"E\" value=\"1\"></score></visiting-team><home-team display_name=\"NY Yankees\" alias=\"NYY\" nickname=\"Yankees\" id=\"10\" division=\"ALE\" league=\"AL\" score=\"3\"><score heading=\"1\" value=\"0\"></score><score heading=\"2\" value=\"2\"></score><score heading=\"3\" value=\"0\"></score><score heading=\"4\" value=\"0\"></score><score heading=\"5\" value=\"0\"></score><score heading=\"6\" value=\"1\"></score><score heading=\"7\" value=\"0\"></score><score heading=\"R\" value=\"3\"></score><score heading=\"H\" value=\"8\"></score><score heading=\"E\" value=\"1\"></score></home-team><gamestate status=\"In-Progress\" display_status1=\"Bot\" display_status2=\"7th\" href=\"http://scores.nbcsports.msnbc.com/mlb/boxscore.asp?gamecode=330413110\" tv=\"MASN/YES\" gametime=\"4:05 PM\" gamedate=\"4/13\" is-dst=\"1\" is-world-dst=\"1\" reason=\"\"></gamestate></ticker-entry>"
,"<ticker-entry gamecode=\"330413111\" gametype=\"Regular Season\" league=\"AL\"><visiting-team display_name=\"Detroit\" alias=\"Det\" nickname=\"Tigers\" id=\"6\" division=\"ALC\" league=\"AL\" score=\"7\"><score heading=\"1\" value=\"0\"></score><score heading=\"2\" value=\"0\"></score><score heading=\"3\" value=\"1\"></score><score heading=\"4\" value=\"4\"></score><score heading=\"5\" value=\"0\"></score><score heading=\"6\" value=\"2\"></score><score heading=\"7\" value=\"0\"></score><score heading=\"R\" value=\"7\"></score><score heading=\"H\" value=\"9\"></score><score heading=\"E\" value=\"0\"></score></visiting-team><home-team display_name=\"Oakland\" alias=\"Oak\" nickname=\"Athletics\" id=\"11\" division=\"ALW\" league=\"AL\" score=\"1\"><score heading=\"1\" value=\"0\"></score><score heading=\"2\" value=\"1\"></score><score heading=\"3\" value=\"0\"></score><score heading=\"4\" value=\"0\"></score><score heading=\"5\" value=\"0\"></score><score heading=\"6\" value=\"0\"></score><score heading=\"7\" value=\"0\"></score><score heading=\"R\" value=\"1\"></score><score heading=\"H\" value=\"3\"></score><score heading=\"E\" value=\"0\"></score></home-team><gamestate status=\"In-Progress\" display_status1=\"Bot\" display_status2=\"7th\" href=\"http://scores.nbcsports.msnbc.com/mlb/boxscore.asp?gamecode=330413111\" tv=\"FSDT/CSCA\" gametime=\"4:05 PM\" gamedate=\"4/13\" is-dst=\"1\" is-world-dst=\"1\" reason=\"\"></gamestate></ticker-entry>"
,"<ticker-entry gamecode=\"330413109\" gametype=\"Regular Season\" league=\"IL\"><visiting-team display_name=\"NY Mets\" alias=\"NYM\" nickname=\"Mets\" id=\"21\" division=\"NLE\" league=\"NL\" score=\"4\"><score heading=\"1\" value=\"0\"></score><score heading=\"2\" value=\"0\"></score><score heading=\"3\" value=\"0\"></score><score heading=\"4\" value=\"0\"></score><score heading=\"5\" value=\"4\"></score><score heading=\"6\" value=\"0\"></score><score heading=\"7\" value=\"0\"></score><score heading=\"8\" value=\"0\"></score><score heading=\"R\" value=\"4\"></score><score heading=\"H\" value=\"9\"></score><score heading=\"E\" value=\"0\"></score></visiting-team><home-team display_name=\"Minnesota\" alias=\"Min\" nickname=\"Twins\" id=\"9\" division=\"ALC\" league=\"AL\" score=\"1\"><score heading=\"1\" value=\"0\"></score><score heading=\"2\" value=\"0\"></score><score heading=\"3\" value=\"0\"></score><score heading=\"4\" value=\"0\"></score><score heading=\"5\" value=\"0\"></score><score heading=\"6\" value=\"0\"></score><score heading=\"7\" value=\"1\"></score><score heading=\"8\" value=\"0\"></score><score heading=\"R\" value=\"1\"></score><score heading=\"H\" value=\"1\"></score><score heading=\"E\" value=\"0\"></score></home-team><gamestate status=\"In-Progress\" display_status1=\"Bot\" display_status2=\"8th\" href=\"http://scores.nbcsports.msnbc.com/mlb/boxscore.asp?gamecode=330413109\" tv=\"SNY/FSN\" gametime=\"4:10 PM\" gamedate=\"4/13\" is-dst=\"1\" is-world-dst=\"1\" reason=\"\"></gamestate></ticker-entry>"
,"<ticker-entry gamecode=\"330413124\" gametype=\"Regular Season\" league=\"NL\"><visiting-team display_name=\"Milwaukee\" alias=\"Mil\" nickname=\"Brewers\" id=\"8\" division=\"NLC\" league=\"NL\" score=\"0\"><score heading=\"1\" value=\"0\"></score><score heading=\"2\" value=\"0\"></score><score heading=\"3\" value=\"0\"></score><score heading=\"4\" value=\"0\"></score><score heading=\"5\" value=\"0\"></score><score heading=\"6\" value=\"0\"></score><score heading=\"7\" value=\"0\"></score><score heading=\"R\" value=\"0\"></score><score heading=\"H\" value=\"3\"></score><score heading=\"E\" value=\"1\"></score></visiting-team><home-team display_name=\"St. Louis\" alias=\"StL\" nickname=\"Cardinals\" id=\"24\" division=\"NLC\" league=\"NL\" score=\"8\"><score heading=\"1\" value=\"0\"></score><score heading=\"2\" value=\"0\"></score><score heading=\"3\" value=\"1\"></score><score heading=\"4\" value=\"0\"></score><score heading=\"5\" value=\"0\"></score><score heading=\"6\" value=\"7\"></score><score heading=\"R\" value=\"8\"></score><score heading=\"H\" value=\"10\"></score><score heading=\"E\" value=\"0\"></score></home-team><gamestate status=\"In-Progress\" display_status1=\"Top\" display_status2=\"7th\" href=\"http://scores.nbcsports.msnbc.com/mlb/boxscore.asp?gamecode=330413124\" tv=\"FSWI/FSMW\" gametime=\"4:15 PM\" gamedate=\"4/13\" is-dst=\"1\" is-world-dst=\"1\" reason=\"\"></gamestate></ticker-entry>"
,"<ticker-entry gamecode=\"330413123\" gametype=\"Regular Season\" league=\"NL\"><visiting-team display_name=\"Cincinnati\" alias=\"Cin\" nickname=\"Reds\" id=\"17\" division=\"NLC\" league=\"NL\" score=\"\"><score heading=\"R\" value=\"\"></score><score heading=\"H\" value=\"\"></score><score heading=\"E\" value=\"\"></score></visiting-team><home-team display_name=\"Pittsburgh\" alias=\"Pit\" nickname=\"Pirates\" id=\"23\" division=\"NLC\" league=\"NL\" score=\"\"><score heading=\"R\" value=\"\"></score><score heading=\"H\" value=\"\"></score><score heading=\"E\" value=\"\"></score></home-team><gamestate status=\"Pre-Game\" display_status1=\"7:05 PM\" display_status2=\"\" href=\"http://scores.nbcsports.msnbc.com/mlb/preview.asp?g=330413123\" tv=\"FSOH/ROOT\" gametime=\"7:05 PM\" gamedate=\"4/13\" is-dst=\"1\" is-world-dst=\"1\" reason=\"\"></gamestate></ticker-entry>"
,"<ticker-entry gamecode=\"330413107\" gametype=\"Regular Season\" league=\"AL\"><visiting-team display_name=\"Toronto\" alias=\"Tor\" nickname=\"Blue Jays\" id=\"14\" division=\"ALE\" league=\"AL\" score=\"\"><score heading=\"R\" value=\"\"></score><score heading=\"H\" value=\"\"></score><score heading=\"E\" value=\"\"></score></visiting-team><home-team display_name=\"Kansas City\" alias=\"KC\" nickname=\"Royals\" id=\"7\" division=\"ALC\" league=\"AL\" score=\"\"><score heading=\"R\" value=\"\"></score><score heading=\"H\" value=\"\"></score><score heading=\"E\" value=\"\"></score></home-team><gamestate status=\"Pre-Game\" display_status1=\"7:10 PM\" display_status2=\"\" href=\"http://scores.nbcsports.msnbc.com/mlb/preview.asp?g=330413107\" tv=\"RSN/FSKC\" gametime=\"7:10 PM\" gamedate=\"4/13\" is-dst=\"1\" is-world-dst=\"1\" reason=\"\"></gamestate></ticker-entry>"
,"<ticker-entry gamecode=\"330413128\" gametype=\"Regular Season\" league=\"NL\"><visiting-team display_name=\"Philadelphia\" alias=\"Phi\" nickname=\"Phillies\" id=\"22\" division=\"NLE\" league=\"NL\" score=\"\"><score heading=\"R\" value=\"\"></score><score heading=\"H\" value=\"\"></score><score heading=\"E\" value=\"\"></score></visiting-team><home-team display_name=\"Miami\" alias=\"Mia\" nickname=\"Marlins\" id=\"28\" division=\"NLE\" league=\"NL\" score=\"\"><score heading=\"R\" value=\"\"></score><score heading=\"H\" value=\"\"></score><score heading=\"E\" value=\"\"></score></home-team><gamestate status=\"Pre-Game\" display_status1=\"7:10 PM\" display_status2=\"\" href=\"http://scores.nbcsports.msnbc.com/mlb/preview.asp?g=330413128\" tv=\"CSN/FSFL\" gametime=\"7:10 PM\" gamedate=\"4/13\" is-dst=\"1\" is-world-dst=\"1\" reason=\"\"></gamestate></ticker-entry>"
,"<ticker-entry gamecode=\"330413129\" gametype=\"Regular Season\" league=\"NL\"><visiting-team display_name=\"LA Dodgers\" alias=\"LAD\" nickname=\"Dodgers\" id=\"19\" division=\"NLW\" league=\"NL\" score=\"\"><score heading=\"R\" value=\"\"></score><score heading=\"H\" value=\"\"></score><score heading=\"E\" value=\"\"></score></visiting-team><home-team display_name=\"Arizona\" alias=\"Ari\" nickname=\"Diamondbacks\" id=\"29\" division=\"NLW\" league=\"NL\" score=\"\"><score heading=\"R\" value=\"\"></score><score heading=\"H\" value=\"\"></score><score heading=\"E\" value=\"\"></score></home-team><gamestate status=\"Pre-Game\" display_status1=\"8:10 PM\" display_status2=\"\" href=\"http://scores.nbcsports.msnbc.com/mlb/preview.asp?g=330413129\" tv=\"KCAL/FSAZ\" gametime=\"8:10 PM\" gamedate=\"4/13\" is-dst=\"1\" is-world-dst=\"1\" reason=\"\"></gamestate></ticker-entry>"
,"<ticker-entry gamecode=\"330413125\" gametype=\"Regular Season\" league=\"NL\"><visiting-team display_name=\"Colorado\" alias=\"Col\" nickname=\"Rockies\" id=\"27\" division=\"NLW\" league=\"NL\" score=\"\"><score heading=\"R\" value=\"\"></score><score heading=\"H\" value=\"\"></score><score heading=\"E\" value=\"\"></score></visiting-team><home-team display_name=\"San Diego\" alias=\"SD\" nickname=\"Padres\" id=\"25\" division=\"NLW\" league=\"NL\" score=\"\"><score heading=\"R\" value=\"\"></score><score heading=\"H\" value=\"\"></score><score heading=\"E\" value=\"\"></score></home-team><gamestate status=\"Pre-Game\" display_status1=\"8:40 PM\" display_status2=\"\" href=\"http://scores.nbcsports.msnbc.com/mlb/preview.asp?g=330413125\" tv=\"ROOT/FSSD\" gametime=\"8:40 PM\" gamedate=\"4/13\" is-dst=\"1\" is-world-dst=\"1\" reason=\"\"></gamestate></ticker-entry>"
,"<ticker-entry gamecode=\"330413103\" gametype=\"Regular Season\" league=\"AL\"><visiting-team display_name=\"Houston\" alias=\"Hou\" nickname=\"Astros\" id=\"18\" division=\"ALW\" league=\"AL\" score=\"\"><score heading=\"R\" value=\"\"></score><score heading=\"H\" value=\"\"></score><score heading=\"E\" value=\"\"></score></visiting-team><home-team display_name=\"LA Angels\" alias=\"LAA\" nickname=\"Angels\" id=\"3\" division=\"ALW\" league=\"AL\" score=\"\"><score heading=\"R\" value=\"\"></score><score heading=\"H\" value=\"\"></score><score heading=\"E\" value=\"\"></score></home-team><gamestate status=\"Pre-Game\" display_status1=\"9:05 PM\" display_status2=\"\" href=\"http://scores.nbcsports.msnbc.com/mlb/preview.asp?g=330413103\" tv=\"CSN/FSW\" gametime=\"9:05 PM\" gamedate=\"4/13\" is-dst=\"1\" is-world-dst=\"1\" reason=\"\"></gamestate></ticker-entry>"
,"<ticker-entry gamecode=\"330413112\" gametype=\"Regular Season\" league=\"AL\"><visiting-team display_name=\"Texas\" alias=\"Tex\" nickname=\"Rangers\" id=\"13\" division=\"ALW\" league=\"AL\" score=\"\"><score heading=\"R\" value=\"\"></score><score heading=\"H\" value=\"\"></score><score heading=\"E\" value=\"\"></score></visiting-team><home-team display_name=\"Seattle\" alias=\"Sea\" nickname=\"Mariners\" id=\"12\" division=\"ALW\" league=\"AL\" score=\"\"><score heading=\"R\" value=\"\"></score><score heading=\"H\" value=\"\"></score><score heading=\"E\" value=\"\"></score></home-team><gamestate status=\"Pre-Game\" display_status1=\"9:10 PM\" display_status2=\"\" href=\"http://scores.nbcsports.msnbc.com/mlb/preview.asp?g=330413112\" tv=\"FSSW/ROOT\" gametime=\"9:10 PM\" gamedate=\"4/13\" is-dst=\"1\" is-world-dst=\"1\" reason=\"\"></gamestate></ticker-entry>"
,"<ticker-entry gamecode=\"330413102\" gametype=\"Regular Season\" league=\"AL\"><visiting-team display_name=\"Tampa Bay\" alias=\"TB\" nickname=\"Rays\" id=\"30\" division=\"ALE\" league=\"AL\" score=\"1\"><score heading=\"1\" value=\"0\"></score><score heading=\"2\" value=\"0\"></score><score heading=\"3\" value=\"1\"></score><score heading=\"4\" value=\"0\"></score><score heading=\"5\" value=\"0\"></score><score heading=\"6\" value=\"0\"></score><score heading=\"7\" value=\"0\"></score><score heading=\"8\" value=\"0\"></score><score heading=\"9\" value=\"0\"></score><score heading=\"10\" value=\"0\"></score><score heading=\"R\" value=\"1\"></score><score heading=\"H\" value=\"6\"></score><score heading=\"E\" value=\"1\"></score></visiting-team><home-team display_name=\"Boston\" alias=\"Bos\" nickname=\"Red Sox\" id=\"2\" division=\"ALE\" league=\"AL\" score=\"2\"><score heading=\"1\" value=\"0\"></score><score heading=\"2\" value=\"0\"></score><score heading=\"3\" value=\"0\"></score><score heading=\"4\" value=\"0\"></score><score heading=\"5\" value=\"1\"></score><score heading=\"6\" value=\"0\"></score><score heading=\"7\" value=\"0\"></score><score heading=\"8\" value=\"0\"></score><score heading=\"9\" value=\"0\"></score><score heading=\"10\" value=\"1\"></score><score heading=\"R\" value=\"2\"></score><score heading=\"H\" value=\"7\"></score><score heading=\"E\" value=\"0\"></score></home-team><gamestate status=\"Final\" display_status1=\"Final\" display_status2=\"10\" href=\"http://scores.nbcsports.msnbc.com/mlb/recap.asp?g=330413102\" tv=\"FOX\" gametime=\"1:05 PM\" gamedate=\"4/13\" is-dst=\"1\" is-world-dst=\"1\" reason=\"\"></gamestate></ticker-entry>"
,"<ticker-entry gamecode=\"330413116\" gametype=\"Regular Season\" league=\"NL\"><visiting-team display_name=\"San Francisco\" alias=\"SF\" nickname=\"Giants\" id=\"26\" division=\"NLW\" league=\"NL\" score=\"3\"><score heading=\"1\" value=\"0\"></score><score heading=\"2\" value=\"0\"></score><score heading=\"3\" value=\"0\"></score><score heading=\"4\" value=\"0\"></score><score heading=\"5\" value=\"1\"></score><score heading=\"6\" value=\"1\"></score><score heading=\"7\" value=\"1\"></score><score heading=\"8\" value=\"0\"></score><score heading=\"9\" value=\"0\"></score><score heading=\"R\" value=\"3\"></score><score heading=\"H\" value=\"9\"></score><score heading=\"E\" value=\"1\"></score></visiting-team><home-team display_name=\"Chi Cubs\" alias=\"ChC\" nickname=\"Cubs\" id=\"16\" division=\"NLC\" league=\"NL\" score=\"2\"><score heading=\"1\" value=\"0\"></score><score heading=\"2\" value=\"0\"></score><score heading=\"3\" value=\"0\"></score><score heading=\"4\" value=\"0\"></score><score heading=\"5\" value=\"0\"></score><score heading=\"6\" value=\"0\"></score><score heading=\"7\" value=\"2\"></score><score heading=\"8\" value=\"0\"></score><score heading=\"9\" value=\"0\"></score><score heading=\"R\" value=\"2\"></score><score heading=\"H\" value=\"7\"></score><score heading=\"E\" value=\"0\"></score></home-team><gamestate status=\"Final\" display_status1=\"Final\" display_status2=\"\" href=\"http://scores.nbcsports.msnbc.com/mlb/recap.asp?g=330413116\" tv=\"FOX\" gametime=\"1:05 PM\" gamedate=\"4/13\" is-dst=\"1\" is-world-dst=\"1\" reason=\"\"></gamestate></ticker-entry>"
,"<ticker-entry gamecode=\"330413120\" gametype=\"Regular Season\" league=\"NL\"><visiting-team display_name=\"Atlanta\" alias=\"Atl\" nickname=\"Braves\" id=\"15\" division=\"NLE\" league=\"NL\" score=\"3\"><score heading=\"1\" value=\"0\"></score><score heading=\"2\" value=\"0\"></score><score heading=\"3\" value=\"2\"></score><score heading=\"4\" value=\"0\"></score><score heading=\"5\" value=\"0\"></score><score heading=\"6\" value=\"0\"></score><score heading=\"7\" value=\"0\"></score><score heading=\"8\" value=\"0\"></score><score heading=\"9\" value=\"1\"></score><score heading=\"R\" value=\"3\"></score><score heading=\"H\" value=\"8\"></score><score heading=\"E\" value=\"1\"></score></visiting-team><home-team display_name=\"Washington\" alias=\"Was\" nickname=\"Nationals\" id=\"20\" division=\"NLE\" league=\"NL\" score=\"1\"><score heading=\"1\" value=\"0\"></score><score heading=\"2\" value=\"0\"></score><score heading=\"3\" value=\"0\"></score><score heading=\"4\" value=\"0\"></score><score heading=\"5\" value=\"1\"></score><score heading=\"6\" value=\"0\"></score><score heading=\"7\" value=\"0\"></score><score heading=\"8\" value=\"0\"></score><score heading=\"9\" value=\"0\"></score><score heading=\"R\" value=\"1\"></score><score heading=\"H\" value=\"4\"></score><score heading=\"E\" value=\"1\"></score></home-team><gamestate status=\"Final\" display_status1=\"Final\" display_status2=\"\" href=\"http://scores.nbcsports.msnbc.com/mlb/recap.asp?g=330413120\" tv=\"FOX\" gametime=\"1:05 PM\" gamedate=\"4/13\" is-dst=\"1\" is-world-dst=\"1\" reason=\"\"></gamestate></ticker-entry>"
]}
); 
```

这是一个包含一堆 XML 的 JSON 记录。您可以使用 PHP 解析 JSON“信封”以及 XML“数据记录”数组。我上面提供的链接应该为您指明正确的方向。

'希望有帮助

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-13T22:37:37.703

Just do it like this:

```
$url = 'http://scores.nbcsports.msnbc.com/ticker/data/gamesMSNBC.js.asp?sport=MLB&period=20130413';

$data = file_get_contents($url);
$records = json_decode($data);

$xmlDocument = implode("\n", $records->games);
$xmlObjects = simplexml_load_string('<?xml version=\'1.0\'?> <document>'. $xmlDocument . '</document>');

foreach($xmlObjects AS $xml){
    // get all attributes
    foreach($xml->attributes() AS $attribute=>$value){
        echo $attribute . ' = '.$value ."\n"; // i.e: gamecode = 330413105
    }

    // visiting team: 
    $visitingTeam='visiting-team';
    print_r($xml->$visitingTeam);

    // get visiting team attributes, like display_name, etc
    foreach($xml->$visitingTeam->attributes() AS $attribute => $value){
        echo $attribute . ' = '.$value ."\n"; 
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-13T22:23:27.513

**编辑** 正如 Diego 指出的那样，不要使用您当前的 url，只需`jsonp=true`完全删除参数并解析原始 JSON。

看看这是否有帮助。本质上，我们使用正则表达式提取 {} 之间的所有内容，然后将 json_decode() 应用于每个匹配项。

```
<?php

    $data = 'shsMSNBCTicker.loadGamesData({ "sport": "MLB", "period": "20130413", "games": [ "" ,"" ,"" ,"" ,"" ,"" ,"" ,"" ,"" ,"" ,"" ,"" ,"" ,"" ,"" ]} );';

    //this will extract everything between and including the {}
    preg_match("/(\{.*\})/", $data, $matches);

    echo "<pre>";
    //print everything that matched
    print_r($matches);

    //now you can decode it
    $firstMatch = json_decode($matches[0]);

    //print out the first match
    print_r($firstMatch);

    //now you can do stuff like

    echo $firstMatch->sport;

?> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-13T22:11:24.680

PHP 有：

```
json_decode(); 
```

用于读取 JSON。括号内的数据是一个 JSON 对象。

# c++ - 带有静态链接的 Python 3.3 未定义引用

> ID：15993450
> 
> 赞同：1
> 
> 时间：2013-04-13T22:06:49.453
> 
> 标签：c++, python, g++, static-linking, python-3.3

操作系统：Ubuntu 12.04 x86_64

我已经从源代码编译了 libpython3.3m.a 以及相关的头文件。我编写了以下 Makefile（具体来说，请查看我的 CFLAGS 变量，其中包括 -lpython3.3m）...

```
BINS=python python-d
SOURCES=python.cpp

LIBROOT=/home/uberblah/lib/cpp
LIBDIR=$(LIBROOT)/lib
BINDIR=$(LIBROOT)/bin
INCDIR=$(LIBROOT)/include

CFLAGS= -I$(INCDIR)/python3.3m -L$(LIBDIR) -lpython3.3m

all: $(BINS)

python-d: $(SOURCES)
    g++ $(CFLAGS) -g -o $@ $^

python: $(SOURCES)
    g++ $(CFLAGS) -o $@ $^

clean::
    rm -r -f *~ $(BINS)

edit::
    gedit $(SOURCES) Makefile & 
```

我编写了以下 .cpp 源文件...

```
#include <Python.h>

int main(int argc, char** argv)
{
  Py_SetProgramName((wchar_t*)argv[0]);  /* optional but recommended */
  Py_Initialize();
  PyRun_SimpleString("from time import time,ctime\n"
                     "print 'Today is',ctime(time())\n");
  Py_Finalize();
  return 0;
} 
```

在 Makefile 的目录中键入 make 会导致以下消息。

```
g++ -I/home/uberblah/lib/cpp/include/python3.3m -L/home/uberblah/lib/cpp/lib -lpython3.3m -o python python.cpp
/tmp/ccBD4sLY.o: In function `main':
python.cpp:(.text+0x1a): undefined reference to `Py_SetProgramName'
python.cpp:(.text+0x1f): undefined reference to `Py_Initialize'
python.cpp:(.text+0x2e): undefined reference to `PyRun_SimpleStringFlags'
python.cpp:(.text+0x33): undefined reference to `Py_Finalize'
collect2: ld returned 1 exit status
make: *** [python] Error 1 
```

根据我对 g++ 的“-l”参数的理解，它正在找到 libpython3.3m.a，否则它会告诉我它无法找到库并退出。

那么，如果它正在查找库，为什么不定义这些函数呢？

补充说明...

使用 --prefix 和 altinstall 构建 Python 以将其安装到新目录（我在 makefile 中指向 LIBROOT 的目录）。

我已经确认 libpython3.3m.a 在 $(LIBDIR)

使用 nm 检查 Py_SetProgramName ...

```
uberblah@uberblah-N80Vm:~/lib/cpp/lib$ nm libpython3.3m.a | grep Py_SetProgramName
                 U Py_SetProgramName
0000000000001c00 T Py_SetProgramName
                 U Py_SetProgramName 
```

详细运行 Make...

```
 ...
    Finished prerequisites of target file `python'.
  Must remake target `python'.
g++ -I/home/uberblah/lib/cpp/include/python3.3m -L/home/uberblah/lib/cpp/lib -lpython3.3m -o python python.cpp
Putting child 0x00a585b0 (python) PID 16811 on the chain.
Live child 0x00a585b0 (python) PID 16811 
/tmp/cc2dom1S.o: In function `main':
python.cpp:(.text+0x1a): undefined reference to `Py_SetProgramName'
python.cpp:(.text+0x1f): undefined reference to `Py_Initialize'
python.cpp:(.text+0x2e): undefined reference to `PyRun_SimpleStringFlags'
python.cpp:(.text+0x33): undefined reference to `Py_Finalize'
collect2: ld returned 1 exit status
Reaping losing child 0x00a585b0 PID 16811 
make: *** [python] Error 1
Removing child 0x00a585b0 PID 16811 from chain. 
```

如果我将编译拆分为对象阶段然后是二进制阶段，则二进制阶段将失败，并显示与最初提到的相同的错误消息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T06:33:37.050

找到了解决方案：Python 实际上安装了它自己的解决方案。在这篇文章中谈到了它（我知道我的标题没有丢失，但我很愚蠢并试图自己将它们链接起来，想“哦，这正是任何人都需要做的让 Python 在我的平台上工作” )...

[缺少 Python.h 标头](https://stackoverflow.com/questions/10622668/python-h-header-missing)

# jquery - 在 jquery 中将事件附加到 window.on("load", function(){})

> ID：15993451
> 
> 赞同：2
> 
> 时间：2013-04-13T22:06:54.063
> 
> 标签：jquery, dom

我编写了一些代码，其工作方式类似于 jquery 插件，根据元素彼此的高度将 css 分配给元素。我一直在试图弄清楚如何使插件工作而无需从函数的外部调用/包装在 window.on("load", function(){}) 块中。我应该补充一点，如果我从外部调用它，一切都会运行良好

```
 $(window).on("load",function(){}) 
```

堵塞。我的两个问题是：

1.  我可以为 $(window).on("load", function(){}) 事件分配多少次不同的操作？如果我多次分配某些内容，每个后续分配都会替换第一个，我应该添加类似 javascript addEventListener 方法的内容吗？

2.  如何从

    ```
     (function( $ ) { $.fn.resizeCss = function() {}; })(jQuery); 
    ```

    堵塞？

真的很难过，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-13T22:10:50.640

您应该能够根据需要`$(window).on("load"...`多次为其分配操作。使用的主要好处之一`.on`是它使您能够命名您的事件处理程序，如果您愿意的话。

例如，在：

```
$(window).on("load.loading1", function(){}) 
```

这`loading1`是事件处理程序的特定实例的名称。这很有帮助，因为除了事件之外，您还可以根据名称选择删除处理程序。

例如：

```
$(window).off("load.loading1") 
```

将仅解除绑定`loading1`事件处理程序，其中

```
$(window).off("load") 
```

将取消绑定所有`load`事件处理程序。

至于你的第二个问题，我为造成的混乱道歉，但我弄错了`(function($)`。这实际上意味着其中的代码是自动执行的。换句话说，它在自己的时间自动执行，无需放入处理程序中。

我仍然建议您将其绑定到外部，因为它是更好的编码实践，并且通常会使您的插件更具可扩展性。

**更新**

根据您的评论，我可以告诉您，您*可以*这样做，这样`$(window).load`就不必由使用您的插件的开发人员输入，但这是非常糟糕的编码实践。但是，它会使您的插件的可扩展性显着降低。此外，如果您使用 执行此操作`$(document).ready`，则仅在插件的调用者不是元素时才有效。这样做的原因是因为调用它的元素必须已经被 jQuery 找到，并且为了找到它，文档必须已经准备好让它可见。

您可以做的是`$(window).load`在插件本身中添加处理程序。换句话说，它将在用 . 声明的函数内部`$.fn....`。您可能还想创建一些反馈，以便您的开发人员可以判断是否在加载窗口之前调用了该函数。但是，如前所述，我强烈建议不要这样做。更好的做法是在您的文档中记下该插件通常应该从`$(window).load...`事件中调用。这确实应该留给开发人员。

# c# - 使用实体框架插入引用来自其他表的记录的记录

> ID：15993452
> 
> 赞同：2
> 
> 时间：2013-04-13T22:07:03.923
> 
> 标签：c#, entity-framework, c#-4.0, entity-framework-4

这是一个相当基本的问题，但我很惊讶在任何地方都找不到合适的答案。

考虑以下数据库模式：

```
Person {PersionID, Name, CountryOfBirthID [references Country]}
Country {CountryID, CountryName} 
```

该应用程序在启动期间从数据库中读取所有国家，并将它们保存在一个列表中。每当我添加一个新人时，我都会使用上面提到的列表中的 ID 和数据创建一个新的 Country 对象。我期待 EF 插入一个 ID 引用 Country 表中记录的新 Person，但它会向 Country 表中插入一条新记录并为其分配一个新 ID，这显然不是我想要的。

插入引用其他表中记录的新记录的常规方法是什么？我假设，每当我添加 Persion（在同一上下文下）并重用获取的记录时，我都可以按 ID 获取 Country 记录，但是还有其他方法可以让我只访问 Person 表吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T22:10:48.097

简单的答案是你需要`'Attach'`你的`Country`第一个（即让实体框架知道它已经存在于上下文/数据库中）：

```
 var person = new Person { ... };
 var country = new Country { Id = ... } // or _countriesList[2] in your case;
 person.Country = country;

 context.Attach(country);
 context.SaveChanges(); 
```

此外，如果您使用 Visual Studio 中的设计器创建实体，则您的实体应包含一个名为的属性`'EntityReference'`，您可以使用该属性来实现相同的结果：

```
var person = new Person {};
person.Country.EntityReference = new EntityKey("MyEntities.Countries", "CountryId", countryId); 
```

（用适当的值替换“MyEntities.Countries”和“CountryId”）

然而，我相信最简单的方法是在您的实体中“公开”外键：

```
class Person
{
  ....
  Country CountryOfBirth { get; set; }
  int CountryOfBirthID { get; set; } 
}

//then:

var person = new Person { ... };
person.CountryOfBirthId = 2; 
```

如果您正在寻找一种更通用的方法来处理此问题，请查找该`Identity Map`模式。

# php - 为什么 mysqli_fetch_array() 返回数组大小的两倍？

> ID：15993454
> 
> 赞同：-6
> 
> 时间：2013-04-13T22:07:23.173
> 
> 标签：php, mysql, mysqli, lamp

我正在做一个非常简单的 php 语句，例如

```
print_r($my_rec);
$row = mysqli_fetch_array($my_rec);
echo "\nP_Id " . $row['P_Id'] . ' Length ' . sizeof($row) . "\n";
$row = mysqli_fetch_array($my_rec);
echo "\nP_Id " . $row['P_Id'] . ' Length ' . sizeof($row) . "\n"; 
```

现在当 print_r 打印到屏幕上时，它报告每个数组中只有 16 个字段/列。这是真实的。但是，当我获取一个数组时，它给了我双倍的字段。换句话说，数组在重复自己，这是没有意义的。例子 ...

我的数据库中有

```
 Col1  Col2
 "hi1" "bye1" 
```

当我做

```
 $row = mysqli_fetch_array($my_rec);
 foreach($row as $x){
       echo $x . "\n";
 } 
```

它会打印

```
 hi1
 hi1
 by2
 by2 
```

为什么我会出现这种行为？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-13T22:10:02.423

因为它还包括一个填充了列位置的数组（即：0、1、2、3 和 id、用户名、密码、电子邮件）。两者都`id`保存`0`相同的数据。

如果你只想要字符串索引，你可以使用`mysqli_fetch_assoc`（[http://php.net/mysqli_fetch_assoc](http://php.net/mysqli_fetch_assoc)）

# android - Android：ICS 上没有来自 NETWORK_PROVIDER 的位置更新

> ID：15993456
> 
> 赞同：0
> 
> 时间：2013-04-13T22:07:35.537
> 
> 标签：android, locationmanager, locationlistener

关于这个问题有类似的[帖子。](https://stackoverflow.com/questions/15747543/locationlistener-of-network-provider-is-enabled-but-onlocationchanged-is-never)这似乎与某些运行 ICS 及以上的设备有关，一段时间后（设备进入“睡眠模式”——如果有的话？）即使启用了网络提供商，也不再来自 NETWORK_PROVIDER 的位置更新。GPS_PROVIDER 在露天仍然可以正常工作。曾尝试切换 Wifi 等，但似乎唯一有帮助的是重新启动设备。必须是这个的解决方案？

# java - 如何实现 Linkedlist 类中的方法来反转我的linkedList？

> ID：15993457
> 
> 赞同：0
> 
> 时间：2013-04-13T22:07:36.753
> 
> 标签：java

如何使用linkedList类中的方法以相反的顺序打印我的linkedlist数组：

```
for (int j = 0; j < FutureValueLinkedList.size(); j++)
     {

        String myArrayLinkedList = FutureValueLinkedList.get(j);
        System.out.println(myArrayLinkedList + "\t"); 
     }
    System.out.println(); 
```

addLast() 能做到这一点吗？

```
import java.util.*;
import java.text.*;

public class FutureValueApp
 {
public static void main(String[] args)
{
    LinkedList<String> FutureValueLinkedList = new LinkedList<>();
    // display a welcome message
    System.out.println("Welcome to the Future Value Calculator");
    System.out.println();

    // perform 1 or more calculations
    Scanner sc = new Scanner(System.in);
    String choice = "y";
    while (choice.equalsIgnoreCase("y"))
    {

        // get the input from the user
        System.out.println("DATA ENTRY");
        double monthlyInvestment = getDoubleWithinRange(sc,
            "Enter monthly investment: ", 0, 1000);
        double interestRate = getDoubleWithinRange(sc,
            "Enter yearly interest rate: ", 0, 30);
        int years = getIntWithinRange(sc,
            "Enter number of years: ", 0, 100);

        // calculate the future value
        double monthlyInterestRate = interestRate/12/100;
        int months = years * 12;
        double futureValue = calculateFutureValue(
            monthlyInvestment, monthlyInterestRate, months);

        // get the currency and percent formatters
        NumberFormat currency = NumberFormat.getCurrencyInstance();
        NumberFormat percent = NumberFormat.getPercentInstance();
        percent.setMinimumFractionDigits(1);

        // format the result as a single string
        String results =
              "Monthly investment:\t"
                  + currency.format(monthlyInvestment) + "\n"
            + "Yearly interest rate:\t"
                  + percent.format(interestRate/100) + "\n"
            + "Number of years:\t"
                  +  years + "\n"
            + "Future value:\t\t"
                  + currency.format(futureValue) + "\n";

        // print the results
        System.out.println();
        System.out.println("FORMATTED RESULTS");
        System.out.println(results);

      String monthlyInvestmentFormat = currency.format(monthlyInvestment);
      String interestRateFormat = percent.format(interestRate/100);
      String futureValueFormat = currency.format(futureValue);

      FutureValueLinkedList.add(monthlyInvestmentFormat + "\t" + 
      interestRateFormat +  "\t" + Integer.toString(years) +
              "\t" + futureValueFormat);

        // see if the user wants to continue
        System.out.print("Continue? (y/n): ");
        choice = sc.next();
        System.out.println();
    }

     System.out.println("Future Value Calculations ");
     System.out.println();
     System.out.print("Inv/Mo.\tRate\tYears\tFuture Value\n");
     for (int j = 0; j < FutureValueLinkedList.size(); j++)
     {

        String myArrayLinkedList = FutureValueLinkedList.get(j);
        System.out.println(myArrayLinkedList + "\t"); 
     }
    System.out.println();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T22:15:58.237

如果您只想输出反向列表，则可以按照 Ostap 的建议使用descendingIterator。但是，如果您想将反向列表存储在某处，则可以这样做：

```
LinkedList<String> reversedFutureValueLinkedList = Collections.reverse(FutureValueLinkedList ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T22:16:35.143

看看[LinkedList#descendingIterator()](http://docs.oracle.com/javase/6/docs/api/java/util/LinkedList.html#descendingIterator%28%29)

```
LinkedList<Integer> l = new LinkedList<Integer>();
l.add(1);
l.add(2);
l.add(3);

Iterator i = l.descendingIterator();
while(i.hasNext()) {
    System.out.print(i.next() + " ");
} 
```

打印出来：

```
3 2 1 
```

# django - Eclipse 与 Django 单元测试

> ID：15993459
> 
> 赞同：0
> 
> 时间：2013-04-13T22:07:41.110
> 
> 标签：django, eclipse, pydev, django-testing

我有一组在 Eclipse 中失败的简单 Django 测试用例。特别是如果我有类似的东西：

```
resp =self.client.get('/accounts/newUser/')
self.assertEqual(resp.status_code,200)
self.assertTrue('user' in resp.context) 
```

那么它会失败，因为 resp.context 是无。我已经设法使用 eclipse 从 eclipse 运行`django.test.utils.setup_test_environment()`，但是我必须做一些`resp.context[0][0][0]['user']`不太理想的事情。

有没有更聪明的方法让 python 单元测试从 Eclipse 运行？我已经看到[这个解决方案使用来自 eclipse 的 django-nose](https://stackoverflow.com/questions/5677386/is-there-a-way-to-hook-djangos-unittest-into-pyunit-in-eclipse)并且我上面的原始解决方案[来自这里](https://stackoverflow.com/questions/14392537/django-unit-test-client-response-has-empty-context)。

# jquery - jquery验证引擎格式错误

> ID：15993466
> 
> 赞同：0
> 
> 时间：2013-04-13T22:08:40.053
> 
> 标签：jquery, jquery-validation-engine

在我的一生中，我无法弄清楚如何让验证引擎只返回自定义错误消息。如果我做一些简单的事情：

```
<input type="text" class="input-block-level validate[required,custom[email]]" name="email" id="email" placeholder="Email address"> 
```

然后在我的表单中将电子邮件输入留空，我收到验证说“*此字段是必需的”和“*无效的电子邮件地址”。我只想显示“*无效的电子邮件地址”。演示表明这是可能的（[验证演示](http://www.position-relative.net/creation/formValidator/demos/demoRegExp.html#)），但演示的源代码看起来像我的，但演示仅正确显示“*无效的电子邮件地址”！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-19T12:50:20.413

在验证演示页面上，它只显示一条消息，因为他们已经在输入框中提供了一些值。尝试从字段中删除值并点击提交。它也会在那里显示 2 条消息。

# c# - 无法更改关系，因为一个或多个外键属性不可为空

> ID：15993468
> 
> 赞同：8
> 
> 时间：2013-04-13T22:08:57.320
> 
> 标签：c#, sql-server, .net-4.0, entity-framework-4

（注意：这**不是**[这个问题](https://stackoverflow.com/questions/5538974/the-relationship-could-not-be-changed-because-one-or-more-of-the-foreign-key-pro)的重复，即使它有相同的例外。）

我有一个*穷人的交易*，策略是：

1.  插入父子记录。
2.  执行长时间运行的操作。
3.  如果长时间运行失败，去删除之前插入的父子记录。

当我尝试第 3 步时，我收到以下消息：

> 操作失败：无法更改关系，因为一个或多个外键属性不可为空。当对关系进行更改时，相关的外键属性将设置为空值。如果外键不支持空值，则必须定义新关系，必须为外键属性分配另一个非空值，或者必须删除不相关的对象。

我大体上理解这意味着什么，但我认为我是在遵守规则，无论我多么努力地遵守规则，我都不确定为什么会收到这条消息。

我们使用*自我跟踪实体*，我的代码实际上是这样的：

```
var parent = new Parent(1,2,3);
var child = new Child(4,5,6);
parent.Children.Add(child);

MyContext.Parents.ApplyChanges(parent);
MyContext.SaveChanges(SaveOptions.AcceptAllChangesAfterSave);

// At this point, inserts were successful and entities are in an Unchanged state.
// Also at this point, I see that parent.Children.Count == 1

var shouldDeleteEntities = false;
try
{
  // This is not database-related. This process does some
  // encryption/decryption and uploads some files up to
  // Azure blob storage. It doesn't touch the DB.
  SomeLongRunningProcess();
}
catch
{
  // Oops, something bad happened. Let's delete the entities!
  shouldDeleteEntities = true;
}

// At this point, both entities are in an Unchanged state, child still
// appears in parent.Children, nothing is wrong that I can see.
parent.MarkAsDeleted();
child.MarkAsDeleted();

// I've tried MyContext.ApplyChanges here for both entities, no change.

// At this point, everything appears to be in the state that
// they're supposed to be!
try
{
  MyContext.SaveChanges(SaveOptions.AcceptAllChangesAfterSave);
}
catch
{
  // This exception was thrown and I can't figure out why!
} 
```

这个逻辑有什么问题？为什么我不能简单地删除这两条记录？`MyContext.ApplyChanges`我打电话后试过打电话`MarkAsDeleted`。我已经尝试了各种各样的事情，无论如何，无论我多么努力地告诉上下文我想要删除**它们**，它都会不断抛出这个异常。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-14T19:46:26.193

[@Slauma](https://stackoverflow.com/users/270591/slauma)在上述评论中提供了这个答案，但要求我发布答案。

问题是实体框架的自我跟踪实体模板中实际上存在一个“错误”（Microsoft 不再建议您使用）。可以[在此处找到](http://blog.alner.net/archive/2011/11/01/dont_reuse_context_with_entity_framework_self_tracking_entities.aspx)专门针对此主题的博客文章。

具体来说，问题是 Context`ObjectStateManager`与（附加的）实体不同步，`ChangeTracker.State`并且您最终拥有对象，`entity.ChangeTracker.State == ObjectState.Deleted`但当`context.ObjectStateManager`认为状态设置为`EntityState.Unchanged`. 这两个显然是非常不同的。因此，此修复有效地查找附加到上下文的任何对象，`EntityState.Unchanged`但深入挖掘并检查每个对象的`ChangeTracker.State`修复`ObjectState.Deleted`内容。

可以在 Context 的 T4 模板中通过将`#region Handle Initial Entity State`块替换为以下代码来解决此问题（对我们来说效果很好）的简单且功能非常全面的解决方法：

```
#region Handle Initial Entity State

var existingEntities = context
    .ObjectStateManager
    .GetObjectStateEntries(System.Data.EntityState.Unchanged)
    .Select(x => x.Entity as IObjectWithChangeTracker)
    .Where(x => x != null);

var deletes = entityIndex.AllEntities
                    .Where(x => x.ChangeTracker.State == ObjectState.Deleted)
                    .Union(existingEntities
                            .Where(x => x.ChangeTracker.State == ObjectState.Deleted));

var notDeleted = entityIndex.AllEntities
                    .Where(x => x.ChangeTracker.State != ObjectState.Deleted)
                    .Union(existingEntities
                            .Where(x => x.ChangeTracker.State != ObjectState.Deleted));

foreach (IObjectWithChangeTracker changedEntity in deletes)
{
    HandleDeletedEntity(context, entityIndex, allRelationships, changedEntity);
}

foreach (IObjectWithChangeTracker changedEntity in notDeleted)
{
    HandleEntity(context, entityIndex, allRelationships, changedEntity);
}

#endregion 
```

# jquery - 使用自定义属性分配“已选择”

> ID：15993478
> 
> 赞同：1
> 
> 时间：2013-04-13T22:09:44.653
> 
> 标签：jquery, select

我有一个带有自定义选项属性的非常简单的选择：

```
 <select name='beverage' id='beverage'>
        <option value='0' desc='Tea'>Tea</option>
        <option value='1' desc='Coffee'>Coffee</option>
        <option value='2' desc= ‘Lemonade'>Lemonade</option>
    </select> 
```

如果我传递了一个基于“值”的变量，我可以通过以下方式轻松地使相应的选项“选定”：

```
 Var chosen = 1;
    $("#beverage").val( chosen ).attr('selected',true); 
```

但是，如果我通过了一个基于 'desc' attr 的 var，如下所示：

```
 Var chosen = 'Coffee'; 
```

我该如何选择？我尝试过无数种组合，例如：

```
 ($("#beverage").attr( 'desc' = chosen )).attr('selected',true); 
```

或者

```
 ($("#beverage").attr( ['desc' = chosen] )).attr('selected',true); 
```

并且还尝试使用过滤器选项但没有成功。非常令人沮丧，因为我知道这是一个简单的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T22:11:41.183

您可以使用属性选择器，但您必须针对具有属性的选项而不是 select ：

```
var chosen = 'Coffee';
$("#beverage option[desc='" + chosen + "']").prop('selected', true); 
```

[**小提琴**](http://jsfiddle.net/EJALL/)

请注意，这`desc`不是一个有效的属性，您应该`data-desc`改用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T22:11:21.353

```
$('#beverage[descr="chosen"]').attr('selected',true); 
```

# input - 如何使用 vb.net 以当前活动形式获取输入键盘语言？

> ID：15993485
> 
> 赞同：0
> 
> 时间：2013-04-13T22:09:59.593
> 
> 标签：input

我试着用
`RichTextBox1.Text = Application.CurrentInputLanguage.LayoutName`

如果我的 FORM1 现在使用“美国”语言，但我当前关注的应用程序使用“JPN”语言。此代码仅检测 FORM1 中的语言，因此我的`richtextbox`. （这是错误的，我应该从我现在关注的当前应用程序中获取“JPN”）

我应该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-21T16:46:17.263

**虽然你的问题有点难以理解，**
但我从我身边尝试过......
这可能会帮助你：

```
Dim myCurrentLanguage As InputLanguage = InputLanguage.CurrentInputLanguage
   RichTextBox1.Text = myCurrentLanguage.Culture.EnglishName & ControlChars.Cr 
```

# android - 使用“com.facebook.android.LoginButton”和“com.facebook.widget.LoginButton”有什么区别？

> ID：15993486
> 
> 赞同：0
> 
> 时间：2013-04-13T22:10:00.520
> 
> 标签：android, facebook-android-sdk

在 facebook-android-sdk 示例应用程序中提到 Facebook 的登录操作时，我发现在示例应用程序“Scrumptious”中，使用了“com.facebook.widget.LoginButton”，在另一个名为“Hackbook”的示例应用程序中，“ com.facebook.android.LoginButton" 被使用。

谁能告诉我**“com.facebook.android.LoginButton”**和**“com.facebook.widget.LoginButton”**之间的区别？？？？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T11:10:16.293

对于 facebook-android-sdk，只有小部件包的 LoginButton。另一个是仅在 HackBook 示例中定义的类。

从[GitHub](http://github.com/facebook/facebook-android-sdk)可以看出，src 文件夹中没有 LoginButton 这样的类。

# ruby-on-rails - 多站点应用程序 Rails 中的 URL 模型名称

> ID：15993488
> 
> 赞同：1
> 
> 时间：2013-04-13T22:10:15.943
> 
> 标签：ruby-on-rails, activerecord

我正在为客户在 Rails 中构建一个多站点应用程序。功能是创建新网站并管理它们。

我已经为每个网站设置了子域。前任。

```
site1.example.com 
site2.example.com 
```

每个网站都有我们可以创建、编辑和销毁的页面。例子：

```
site1.example.com/pages/1 
```

问题是这些网站有一些页面名称相同，例如“联系人”。所以我希望在 url 中显示页面的名称。例子：

```
site1.example.com/contact
site2.example.com/contact 
```

不管是不是：

```
site1.example.com/pages/contact 
```

def_param 不好，因为它在名称之前显示页面的 id。Friendly_id gem 具有 slug 功能，但我们有 2 个同名页面。它在名字后面加上一个数字。例子：

```
site1.example.com/pages/contact
site2.example.com/pages/contact--2 
```

关于如何构建它的任何想法？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T22:18:13.703

validates_uniqueness_of 可以在范围参数中这样做。

```
class Page < ActiveRecord::Base
  validates_uniqueness_of :url, :scope => :site_id
end 
```

[http://apidock.com/rails/ActiveRecord/Validations/ClassMethods/validates_uniqueness_of](http://apidock.com/rails/ActiveRecord/Validations/ClassMethods/validates_uniqueness_of)

当然，控制器会根据子域查找页面，因此路由看起来很正常。

以防万一这是您获取子域的方式

```
request.subdomain 
```

[如何从 url 获取子域值？](https://stackoverflow.com/questions/4310547/how-to-get-the-subdomain-value-from-a-url)

# json - Yesod：如何以 JSON 格式发送 Redis 结果

> ID：15993496
> 
> 赞同：2
> 
> 时间：2013-04-13T22:10:46.813
> 
> 标签：json, haskell, io, redis, yesod

提前为我的 Haskell 缺乏经验道歉。我正在为一个学习项目的 Redis 实例编写一个小包装器。到目前为止，Yesod 绝对是一个奇迹。凭借很少的 Haskell 经验，我得到了 browserId Auth 工作，并且我成功快速地将记录插入 Redis。

我一直在弄清楚如何将 Redis 响应转换为 JSON 并发回。这是一个工作的、非脚手架的应用程序，它显示了获取静态 RepJson 或带有 Redis 信息的 RepPlain（应用程序称为 LRedis）：

```
{-# LANGUAGE OverloadedStrings, TemplateHaskell, TypeFamilies,
             MultiParamTypeClasses, QuasiQuotes #-}

import Yesod
import Data.Text
import Data.Text.Encoding
import Data.ByteString.UTF8
import Database.Redis
import qualified Data.ByteString.Lazy as L

data LRedis = LRedis

instance Yesod LRedis where

mkYesod "LRedis" [parseRoutes|
    / HomeR GET
    /learnJson LearnJsonR GET
    /redisWorks RedisWorksR GET
    |]

getHomeR :: Handler RepHtml
getHomeR = do
    defaultLayout[whamlet|
    <p>Hi this is a headless API thing.
    |]

getLearnJsonR :: Handler RepJson
getLearnJsonR = do
    jsonToRepJson $ object [("json", ("ftw"::Text))]

getRedisWorksR :: Handler RepPlain
getRedisWorksR = do
    conn <- liftIO $ connect defaultConnectInfo
    liftIO $ runRedis conn $ do
        result <- Database.Redis.get (fromString "hello")
        case result of
            Left e -> return $ RepPlain "Error"
            Right mAnswer -> do
                case mAnswer of
                    Nothing -> return $ RepPlain "Not found."
                    Just x -> return $ RepPlain (toContent x)

main :: IO()
main = do
    warpDebug 3000 $ LRedis 
```

同样，一切正常。如果您 curl ，它将返回存储在 redis 中“hello”中的字符串，如果您 curl `/redisWorks`，它将返回 JSON `/learnJson`，但我想将 redis 答案作为 JSON 给出，而不是纯字符串。我以为我可以天真地将两者结合起来，例如：

```
getRedisJsonR :: Handler RepJson
getRedisJsonR = do
    conn <- liftIO $ connect defaultConnectInfo
    liftIO $ runRedis conn $ do
        result <- Database.Redis.get (fromString "hello")
        case result of
            Left e -> jsonToRepJson $ object [("response", ("error"::Text))]
            Right mAnswer -> do
                case mAnswer of
                    Nothing -> jsonToRepJson $ object [("response", ("Nothing"::Text))]
                    Just x -> jsonToRepJson $ object [("response", ((decodeUtf8 x)::Text))] 
```

但是在添加路由后，`/redisJson RedisJsonR GET`它会因为这个编译错误而失败：

```
Couldn't match expected type `Redis a0'
            with actual type `GHandler sub0 master0 RepJson'
In the expression:
  jsonToRepJson $ object [("response", ("error" :: Text))]
In a case alternative:
    Left e -> jsonToRepJson $ object [("response", ("error" :: Text))]
In a stmt of a 'do' block:
  case result of {
    Left e -> jsonToRepJson $ object [("response", ("error" :: Text))]
    Right mAnswer
      -> do { case mAnswer of {
                Nothing -> ...
                Just x -> ... } } } 
```

似乎它告诉我我需要`result`在出现错误的情况下做一些不同的事情，但我不知道那会是什么，或者考虑到 RepPlain 版本正在运行，为什么它是必要的。

**有没有在 Yesod 中将 Redis 的结果转换为 JSON 的示例？
是否有一些简单的事情我在 IO 上做错了什么？**

Hedis 文档的便捷链接：http://hackage.haskell.org/package/hedis[感谢](http://hackage.haskell.org/package/hedis) 您帮助我。如果事实证明它非常简单，再次抱歉。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T14:57:22.720

```
getRedisJsonR :: Handler RepJson
getRedisJsonR = do
    conn <- liftIO $ connect defaultConnectInfo
    res <- liftIO $ runRedis conn $ do
        result <- Database.Redis.get (fromString "hello")
        case result of
            Left e -> return $ jsonToRepJson $ object [("response", ("error"::Text))]
            Right mAnswer -> do
                case mAnswer of
                    Nothing -> return $ jsonToRepJson $ object [("response", ("Nothing"::Text))]
                    Just x -> return $ jsonToRepJson $ object [("response", ((decodeUtf8 x)::Text))]
    res 
```

实际上，我不相信自己能解释为什么这行得通，而您的原始代码却行不通——我每天都在 Haskell 中编程不到三个月，所以我对什么会起作用有一种正在发展的直觉，但是我真的还没有在理论方面，特别是当涉及到堆叠的 monad 时，我认为这是我们在这里处理的（Redis 位于 Handler 之上，反之亦然，liftIO 正在促进堆叠） .

希望其他人可以参与进来——这似乎是一个很好的具体例子来说明一些 monad 概念。

# php - 为什么 json_decode 返回奇怪的字符？

> ID：15993507
> 
> 赞同：0
> 
> 时间：2013-04-13T22:12:18.473
> 
> 标签：php, unicode

为什么下面的代码： var_dump(json_decode('"\u201A"')); echo json_decode('"\u201A"');

打印：

```
string(3) "â€š"
â€š 
```

代替：

```
string(1) "‚"
‚ 
```

[这](http://www.fileformat.info/info/unicode/char/201a/index.htm)是 unicode 页面的链接。

此外，这不可能是浏览器显示问题：请注意 PHP 输出如何显示存在三个字符。

此外：

```
var_dump(str_split(json_decode('"\u201A"'))); 
```

输出：

```
array(3) {
  [0]=>
  string(1) "â"
  [1]=>
  string(1) "€"
  [2]=>
  string(1) "š"
} 
```

在上下文中：

```
$unicodeChar = '\u201A';
$value = str_replace(json_decode('"'.$unicodeChar.'"'), ',', $value); 
```

不是用真正的字符替换 unicode 字符。为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T23:16:29.423

当您`','`直接在源文件中写入时，您正在编写一串字节，这取决于您的文本编辑器中使用的编码。从我可以看到您的文本编辑器正在使用 Windows-1252/"ANSI" IE，您正在`0x82`文件中写入字节。

PHP 字符串是具有非托管编码的字节数组，所以任何事情都会发生。

`json_decode`以 UTF-8 格式返回结果，因此 PHP 字符串中的低引号是 3 个字节：`0xE2 0x80 0x9A`.

因此，您正在尝试替换`0x82`并且没有匹配项，如您所见。

您可以通过以下代码看到这是正确的：

```
<?php
$win1252 = ",";
$utf8 = json_decode('"\u201A"');
echo bin2hex($win1252) . "\n<br>";
echo bin2hex($utf8); 
```

* * *

为避免头疼，您必须始终使用单一编码。否则，为了正确处理，您最终会得到到处都是晦涩难懂的转换代码或令人尴尬的字符编码错误。我建议选择 UTF-8，因为`json_*`它不能与其他任何东西一起使用，这是一个明显的原因。

您需要做的第一件事是将文本编辑器设置为以 UTF-8 保存文件并为浏览器声明 UTF-8：

```
header("Content-Type: text/html; charset=UTF-8"); 
```

接下来是数据库传输**和**存储编码（分开的东西），以及其他可能在您的应用程序中发生文本<->字节解释的地方。

# ios - 在 UIButton 之间滑动

> ID：15993511
> 
> 赞同：2
> 
> 时间：2013-04-13T22:13:12.843
> 
> 标签：ios, objective-c, uibutton, uigesturerecognizer

假设我有 2 个彼此相邻的 UIButton，当我将手指放在它们上时，它们都会从白色变为黑色。

这显然工作正常，但是如果我将手指放在按钮 1 上，它会变黑，然后当我将手指移到按钮 2 上而不抬起手指时，按钮 2 不会变黑，按钮 1 仍然是黑色的。

那么我怎样才能在一个按钮上“滑动”然后在另一个按钮上“滑动”并将突出显示的按钮从第一个按钮更改为第二个按钮。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-06-09T19:22:23.840

在您的视图控制器中覆盖 touchesMoved 事件。这将告诉您何时发生触摸。问题是您的按钮必须将 userInteractionEnabled 设置为 NO，以便它们不会吞噬触摸事件。如果您尝试执行自定义滑块或不需要实际按钮事件的操作，这将是可以的。

然后在 touchesMoved 中，您可以遍历您的按钮并查看按下了哪个按钮。[这是在拖动输入时突出显示按钮](https://stackoverflow.com/questions/7938445/highlight-the-button-when-drag-enter)的出色答案中窃取的一些代码

```
-(void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event {
for (UITouch *t in touches) {
    CGPoint touchPoint = [t locationInView:self.view];

    CGPoint testPoint = [self.view convertPoint:touchPoint toView:aButton];
    if ([aButton pointInside:testPoint withEvent:event]) {
        //Do something
    }
    //rest of code 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-13T22:57:34.023

```
[self.button1 addTarget:self
                 action:@selector(dragEnter:)
      forControlEvents:UIControlEventTouchDragEnter];
[self.button2 addTarget:self
                 action:@selector(dragEnter:)
       forControlEvents:UIControlEventTouchDragEnter];

[self.button1 addTarget:self
                 action:@selector(dragExit:)
       forControlEvents:UIControlEventTouchDragExit];
[self.button2 addTarget:self
                 action:@selector(dragExit:)
       forControlEvents:UIControlEventTouchDragExit];

- (void)dragEnter:(id)sender
{
    UIButton *button = (UIButton *)sender;
    button.highlighted = YES;
}

- (void)dragExit:(id)sender
{
    UIButton *button = (UIButton *)sender;
    button.highlighted = NO;
} 
```

# c# - c#中两个列表的连接

> ID：15993519
> 
> 赞同：1
> 
> 时间：2013-04-13T22:13:57.960
> 
> 标签：c#, linq

```
public class Co
{
    public int Id { get; set; }
    public string Title { get; set; }
    public List<string> Cards { get; set; }
}

class Program
{
    static void Main(string[] args)
    {
        List<Co> coll = new List<Co>();
        Co c1 = new Co();
        c1.Id = 1;
        c1.Title = "A";
        coll.Add(c1);
        Co c2 = new Co();
        c2.Id = 2;
        c2.Title = "B";
        coll.Add(c2);
        List<KeyValuePair<int, int>> list = new List<KeyValuePair<int, int>>();
        list.Add(new KeyValuePair<int, int>(1, 2));
        list.Add(new KeyValuePair<int, int>(1, 3));
        list.Add(new KeyValuePair<int, int>(1, 1));
        list.Add(new KeyValuePair<int, int>(2, 1));

        Console.ReadKey();
    } 
```

我想 通过将来自对象的 ID与来自的键进行比较，为其中的所有对象分配 Cards 属性，`coll`其中的值的逗号分隔值`list``coll``list`

输出：对于第一个对象 c.Cards ="2,3,1" 对于第二个对象 c.cards="1"

我可以用 foreach 循环来做到这一点。谁能告诉我 linq 的解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T22:16:39.950

首先，请注意您的示例数据不正确，因为您使用了`c`两次相同的对象。它应该是这样的：

```
List<Co> coll = new List<Co>();
Co c = new Co();
c.Id = 1;
c.Title = "A";
coll.Add(c);
c = new Co(); // HERE
c.Id = 2;
c.Title = "B";
coll.Add(c);
List<KeyValuePair<int, int>> list = new List<KeyValuePair<int, int>>();
list.Add(new KeyValuePair<int, int>(1, 2));
list.Add(new KeyValuePair<int, int>(1, 3));
list.Add(new KeyValuePair<int, int>(1, 1));
list.Add(new KeyValuePair<int, int>(2, 1)); 
```

现在，请注意您的`Cards`属性是 a `List<string>`，而不是 a `string`，所以我不知道您所说的“逗号分隔值”是什么意思。如果`Cards`是一个字符串：

```
coll.ForEach(co => co.Cards = String.Join(",",
    list.Where(l => l.Key == co.Id)
        .Select(l => l.Value))); 
```

您当前的定义为`List<string>`：

```
coll.ForEach(co => co.Cards =
    list.Where(l => l.Key == co.Id)
        .Select(l => l.Value.ToString()).ToList()
); 
```

# jsf - 在 primefaces JSF 中使用模板

> ID：15993522
> 
> 赞同：0
> 
> 时间：2013-04-13T22:14:10.190
> 
> 标签：jsf, primefaces, managed-bean

我有主页 index.xhtml ，其中声明了放置内容的位置取决于单击的页面。

```
 <br>
            <div id="centerContent">
        <ui:insert name="centerContent" >
              <ui:param name="mainTag" value="" />
        <ui:include src="/template/commonContent.xhtml" />
        </ui:insert>
                <h4>#{mainTag}</h4>
           </div>
            </br><br></br>
            <p:panel id="content">
                        <h:form>
    <h:inputText id="namez" ></h:inputText>
</h:form>
            </p:panel>       
        </p:layoutUnit> 
```

我的模板 commonContent 是：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"   
      xmlns:ui="http://java.sun.com/jsf/facelets"
      >
    <body>
        <ui:composition>
        <h1>Ubezpieczamy najlepiej!</h1>
        </ui:composition>
    </body>
</html> 
```

发送电子邮件的页面是：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"   
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      >
    <h:body>

        <ui:composition template="index.xhtml">

            <ui:define name="centerContent">
                <h2>Zapytaj</h2>
                        <h:commandButton actionListener="#{mySendBean.sendMail2()}" value="Welcome Me">
            </h:commandButton>
                        <ui:param name="mainTag" value="Z chęcią odpowiemy" />
            </ui:define>

        </ui:composition>

    </h:body> 
```

当 commandButton 放在主页上时它可以工作，发送电子邮件，但是当通过模板加载时它不起作用。万事俱备，但不是`<h:commandButton actionListener="#{mySendBean.sendMail2()}" value="Welcome Me">`。**为什么通过单击的模板加载时它不起作用**？

豆代码：

```
import javax.faces.bean.ManagedBean;
import javax.faces.bean.SessionScoped;
import javax.mail.*;
import org.apache.commons.mail.DefaultAuthenticator;
import org.apache.commons.mail.Email;
import org.apache.commons.mail.EmailException;
import org.apache.commons.mail.SimpleEmail;

/**
 *
 * @author root
 */
@ManagedBean
@SessionScoped
public class mySendBean {

    private myEmailSend mE;
    /**
     * Creates a new instance of mySendBean
     */
    public mySendBean() {
        mE=new myEmailSend();
    }

    private static int j;

    /**
     * Get the value of j
     *
     * @return the value of j
     */
    public int getJ() {
        return j;
    }

    /**
     * Set the value of j
     *
     * @param j new value of j
     */
    public void setJ(int j) {
        this.j = j;
    }

        private String name="iop";

    /**
     * Get the value of name
     *
     * @return the value of name
     */
    public String getName() {
        return name;
    }

    /**
     * Set the value of name
     *
     * @param name new value of name
     */
    public void setName(String name) {
        this.name = name;
        sendMail2();
    }

    public String getSayWelcome(){
       //check if null?
       if("".equals(name) || name ==null){
        return "";
       }else{
        return "Ajax message : Welcome " + name;
       }
    }

    public void setSendMail(){
        sendMail2();
    }
    public void sendMail2(){ 
        j=getJ();
        setJ(++j);

        Email email = new SimpleEmail();
        try {
        //send mail
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T22:33:25.157

必须包含以下内容`<h:form>`：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"   
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      >
    <h:body>

        <ui:composition template="index.xhtml">

            <ui:define name="centerContent">
                    <h:form>
                        <ui:param name="mainTag" value="Z chęcią odpowiemy" />
                <h2>Zapytaj</h2>
                        <h4>#{mainTag}</h4>
                        <h:commandButton actionListener="#{mySendBean.sendMail2()}" value="Welcome Me">
            </h:commandButton>
                    </h:form>
            </ui:define>

        </ui:composition>

    </h:body>

</html> 
```

# php - onclick 函数仅在第一次加载后加载

> ID：15993524
> 
> 赞同：0
> 
> 时间：2013-04-13T22:14:24.807
> 
> 标签：php, jquery, forms

我有一个带有单选按钮的 html 表单。每个按钮都有以下 onclick 命令。

```
onclick='position(); this.form.submit();' 
```

position 是在页面顶部通过 php 包含的 js 函数表中定义的函数。

```
function position(){
            var p = $(document).scrollTop();
            var hidden = document.createElement("input");
            hidden.type = "hidden";
            hidden.name = "scroll";
            hidden.value = p;
            var f = document.getElementById("quiz");
            f.appendChild(hidden);
            } 
```

position 函数将滚动位置传递到处理表单的页面，然后将用户返回到他们上次访问的页面部分。

页面第一次加载位置函数没有被写入。（通过浏览器查看源代码）。

```
onclick='this.form.submit();' 
```

提交表单后，一旦功能出现，之后每次。

```
onclick='position(); this.form.submit();' 
```

如果有任何影响，输入单选按钮正在用 php 编写。

```
 echo "<div class='ans'><input type ='radio' onclick='position(); this.form.submit();' class='radio' name = 'question" . $num . "' value = 'A' checked> " . $row['op1'] . "</input></div>"; 
```

任何帮助，将不胜感激！！

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T23:05:36.840

放弃`onlick='position(); this.form.submit()'`并在页面加载时执行此操作：

```
$(function() {
  $('.ans .radio').click(function() {
    position();
    $(this).closest('form').submit();
  });
}); 
```

那应该行得通。您可能希望在选择器上更具体一点，因为这会将单击事件绑定到带有 cöass='ans' 的 div 中 class='radio' 的所有单选按钮

# c# - 不能在 MVC 中延迟加载我的相关数据

> ID：15993525
> 
> 赞同：1
> 
> 时间：2013-04-13T22:14:26.323
> 
> 标签：c#, entity-framework, asp.net-mvc-4

我一直在使用 MVC 中的实体框架，但我似乎遇到了关于“延迟加载”的问题。我有一个简单的 Web 应用程序，它从著名的电影数据库中抓取数据，并允许用户将这些数据保存到数据库中。我有一个 Film 类，其中包含标题、发布日期、导演等详细信息。我还有一个 Genre 类，并且我在 Film 类中有一个流派的集合。

我遇到的问题是，当我想将 IEnumerable 查询传递给视图时，我似乎无法加载流派信息。

这是电影课：

```
 public class Film
{
    [Key]
    public int FilmId { get; set; }
    public string FilmTitle { get; set; }
    public int FilmReleaseYear { get; set; }
    public string FilmDirector { get; set; }
    public string FilmRating { get; set; }
    public string FilmImageUrl { get; set; }
    public string FilmImdbUrl { get; set; }
    public virtual ICollection<Genre> FilmGenres { get; set; }
    public virtual ICollection<FilmCastMember> FilmCastList { get; set; }
    public virtual ICollection<FilmReview> FilmReviews { get; set; }

    public Film()
    {
        FilmGenres = new List<Genre>();
        FilmCastList = new List<FilmCastMember>();
        FilmReviews = new List<FilmReview>();
    }
} 
```

这是我的流派课程：

```
public class Genre
{   
    [Key]
    public int GenreId { get; set; }
    public string GenreType { get; set; }
} 
```

这是我的操作方法

```
public ActionResult MyFilms()
    {
        IEnumerable<Film> films = from film in db.Films.Include("Genres")
                                  select film;

        return View(films);
    } 
```

我遇到的问题是，当我在此方法的视图中时，我尝试使用 foreach 循环访问电影的 GenreType，但是，它没有给我那个选项。所有数据都链接在我的数据库中，所以我不确定我做错了什么。任何帮助都会很棒。

新动作方法：

```
public ActionResult MyFilms()
    {
        IEnumerable<Film> films = from film in db.Films.Include("FilmReviews").Include("FilmGenres").Include("FilmCastList")
                                  select film;

        return View(films);
    } 
```

该方法的新视图：

```
 @model IEnumerable<MvcFilmFinder.Models.Film>

 @{
     ViewBag.Title = "MyFilms";
  }

  @foreach (var film in Model)
  {
      <h2>@film.FilmTitle</h2>
      <img src="@film.FilmImageUrl" alt="@film.FilmTitle" />

      foreach (var genre in film.FilmGenres)
      {
         <p>@genre.GenreType</p>
      }

      foreach (var genre in film.FilmGenres)
      {
         <p>@genre.GenreId</p>
      }

      foreach (var review in film.FilmReviews)
      {
         <p>@review.ReviewAuthor</p>
      }
  } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T23:40:28.627

将您的控制器代码更改为：

```
public ActionResult MyFilms()
{
    var films = from film in db.Films.Include("FilmGenres")
                select film;

    return View(films);
} 
```

您的视图应如下所示：

```
@model IEnumerable<projectname.Models.Film>

@foreach (var film in Model)
{
    foreach (var genre in film)
    {
        // genre stuff
    }
} 
```

# node.js - Node.js 发送 html 文件不加载链接文件（css，js）

> ID：15993526
> 
> 赞同：4
> 
> 时间：2013-04-13T22:14:40.240
> 
> 标签：node.js, extjs

我正在尝试使用 Node.js 服务器制作 az ExtJS 应用程序。我的服务器代码目前如下所示：

```
var express = require('express');

var app = express();

app.get('/', function (req, res) {
    res.sendfile(filedir + '/index.html');
});

app.get('/employees', function(req, res){
console.log("hello");
});

app.listen(3000); 
```

当我在浏览器中打开 localhost:3000 时，会加载 html 文件，但不正确。检查萤火虫我发现它无法在 html 中找到链接的文件。例如

```
"NetworkError: 404 Not Found - http://localhost:3000/ext-4/ext-debug.js". 
```

这是非常合乎逻辑的，因为该 URL 上不存在该文件。我的问题是如何解决这个问题，以便它可以找到我文件系统上的每个链接文件。

我显然做错了什么或遗漏了什么，我在 node.js 中是全新的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-13T22:28:13.453

看起来您没有配置 Express 的静态文件处理程序。

尝试添加此代码：

```
app.configure(function() {
    app.use(express.static(path.join(__dirname, 'public')));
    app.use(express.bodyParser());
    app.use(express.logger("short"));
}); 
```

它会`var app = ...`像这样紧随其后：

```
var express = require('express');

var app = express();
app.configure(function() {
    app.use(express.static(path.join(__dirname, 'public')));
    app.use(express.bodyParser());
    app.use(express.logger("short"));
});

app.get('/', function (req, res) {
    res.sendfile(filedir + '/index.html');
});

app.get('/employees', function(req, res){
    console.log("hello");
});

app.listen(3000); 
```

然后将您的静态文件放在该`./public`目录下。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-13T22:26:27.867

您需要使用一些静态中间件，例如：[http ://www.senchalabs.org/connect/static.html](http://www.senchalabs.org/connect/static.html)

注意 express 继承了 connect 所以你可以

```
app.use(express.static(filedir)); 
```

或完整的东西：

```
var express = require('express');

var app = express();

app.use(express.static(filedir));

app.get('/employees', function(req, res){
  console.log("hello");
  res.send("hello");
});

app.listen(3000); 
```

# ios - Interface Builder 网点管理

> ID：15993531
> 
> 赞同：0
> 
> 时间：2013-04-13T22:15:16.853
> 
> 标签：ios, xcode, interface-builder, outlet

我想创建 UIViewController 子类，它将成为其他两个控制器的容器，并且它具有属性

```
@property (nonatomic, strong) UIViewController *firstController;
@property (nonatomic, strong) UIViewController *secondController; 
```

然后我想通过接口生成器连接这些属性以自动实例化它们。但如果我只是让它们成为 IBOutlets

```
@property (nonatomic, strong) IBOutlet UIViewController *firstController;
@property (nonatomic, strong) IBOutlet UIViewController *secondController; 
```

我无法连接其他控制器。但是 UINavigationController 有属性 rootViewController 我们可以连接 IB 中的其他控制器。如果可以在自定义控制器中制作这样的技巧，请帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T01:08:59.623

您不能将一个控制器的插座连接到另一个控制器——插座只能在一个控制器内工作，而不是跨控制器工作。

如果您希望一个控制器成为其他两个控制器的容器，您应该将两个容器视图拖到情节提要中控制器的视图中。您将自动获得两个控制器，这些控制器使用嵌入 segues 连接到这些容器视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T22:30:58.210

它应该按照您现在的方式工作。您确定要在 XIB 中添加 View Controller 对象吗？您的 UIViewController 子类 xib 文件应如下所示：

![在此处输入图像描述](https://i.stack.imgur.com/nmRTh.png)

然后您应该能够右键单击并拖动 firstController 和 secondController 的连接。

# ruby-on-rails - Rails 3.2 时间前的文字方法返回 html 内容

> ID：15993532
> 
> 赞同：3
> 
> 时间：2013-04-13T22:15:23.430
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1, ruby-on-rails-3.2

我想用文字显示日期时间，例如“1 小时前”，我尝试了以下方法，但它以字符串格式返回返回 html，如下所示。

# 方法

```
helper.time_ago_in_words(Time.now) 
```

# 结果

```
=> "<span class=\"translation_missing\" title=\"translation missing: en.less_than_x_minutes\">Less Than X Minutes</span>" 
```

导轨控制台输出：

```
>> helper.time_ago_in_words(Time.now)
=> "<span class=\"translation_missing\" title=\"translation missing: en.less_than_x_minutes\">Less Than X Minutes</span>"
>> I18n.locale = :de
=> :de
>> helper.time_ago_in_words(Time.now)
=> "<span class=\"translation_missing\" title=\"translation missing: de.less_than_x_minutes\">Less Than X Minutes</span>"
>> I18n.locale = :en
=> :en
>> helper.time_ago_in_words(Time.now)
=> "<span class=\"translation_missing\" title=\"translation missing: en.less_than_x_minutes\">Less Than X Minutes</span>" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T22:24:10.237

您在配置中使用任何语言环境吗？英语肯定是默认的，它应该可以正常工作。

```
2.0.0p0 :001 > helper.time_ago_in_words(Time.now)
 => "less than a minute" 
2.0.0p0 :002 > I18n.locale = :de
 => :de 
2.0.0p0 :003 > helper.time_ago_in_words(Time.now)
 => "translation missing: de.datetime.distance_in_words.less_than_x_minutes" 
2.0.0p0 :004 > I18n.locale = :en
 => :en 
2.0.0p0 :005 > helper.time_ago_in_words(Time.now)
 => "less than a minute" 
```

您可以尝试在辅助对象上调用此方法，就像我在控制台（rails c）中所做的那样？输出是什么？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-12T21:24:34.463

在 Rails 控制台中，如果我只使用 ActionView::Helpers 中的 time_ago_in_words，我将收到 translation_missing 错误消息。但是，如果我从 ActionView::Helpers::DateHelper 中包含，它将按预期工作。

作品：

```
[2] pry(main)> include ActionView::Helpers::DateHelper
=> Object 
[3] pry(main)> time_ago_in_words(Time.now)
=> "less than a minute" 
```

翻译缺失：

```
[1] pry(main)> include ActionView::Helpers
=> Object [2] 
pry(main)> time_ago_in_words(Time.now)
=> "<span class=\"translation_missing\" title=\"translation missing: en.less_than_x_minutes\">Less Than X Minutes</span>" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-03T15:30:37.933

尝试这个：

> time_ago_in_words(Time.now)

# android - 如何使用xml创建导航菜单项

> ID：15993533
> 
> 赞同：0
> 
> 时间：2013-04-13T22:15:31.860
> 
> 标签：android, android-actionbar, actionbarsherlock

我有导航菜单项。目前我在 onCreateOptionsMenu 中手动创建它：

```
public boolean onCreateOptionsMenu(Menu menu) {
    mLocations = getResources().getStringArray(R.array.locations);
    Context context = getSupportActionBar().getThemedContext();
    ArrayAdapter<CharSequence> list = ArrayAdapter.createFromResource(
    context, R.array.locations, R.layout.sherlock_spinner_item);
    list.setDropDownViewResource(R.layout.sherlock_spinner_dropdown_item);
    getSupportActionBar().setNavigationMode(ActionBar.NAVIGATION_MODE_LIST);
    getSupportActionBar().setListNavigationCallbacks(list, this);
} 
```

有没有办法在 XML 中定义它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T04:35:54.107

您需要做两件事：一是设置 xml，二是对其进行膨胀。这是**main.xml**：

```
<menu xmlns:android="http://schemas.android.com/apk/res/android" >

<item
    android:id="@+id/action_settings"
    android:orderInCategory="100"
    android:showAsAction="never"
    android:title="@string/action_settings"/>

<item
    android:id="@+id/exit"
    android:orderInCategory="200"
    android:showAsAction="never"
    android:title="@string/exit"/>

</menu> 
```

**然后，在主要活动**上膨胀 XML ：

```
@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getSupportMenuInflater().inflate(R.menu.main, menu);
    return true;
} 
```

如果您使用的是片段，它应该看起来像这样：

```
@Override
public void onCreateOptionsMenu(Menu menu, MenuInflater inflater) {
    // Inflate the menu; this adds items to the action bar if it is present.
    inflater.inflate(R.menu.fragment, menu);
} 
```

当然还有与之匹配的 fragment.xml。

祝你好运！

# javascript - 在 Internet Explorer 和 Firefox 中隐藏 JavaScript 代码

> ID：15993534
> 
> 赞同：-2
> 
> 时间：2013-04-13T22:15:34.383
> 
> 标签：javascript

我写了以下代码：

```
<script type='text/javascript'>
    var imageID = 0;
    function changeimage(every_seconds) {

        //Change the image
        if (!imageID) {
            document.getElementById("myimage").src = "jesus.jpg";
            imageID++;
        } else { if(imageID==1) {
            document.getElementById("myimage").src="crucifixion.jpg";
            imageID++;
        } else { if(imageID==2) {
            document.getElementById("myimage").src="resurrection.jpg";
            imageID++;
        } else { if(imageID==3) {
            document.getElementById("myimage").src="trinity.jpg";
            imageID=0;
        }}}}

        //Call the same function again for x number of seconds
        setTimeout("changeimage("+every_seconds+")",((every_seconds)*1000));
    }

    var k=0;

    <!--[if gte IE, FF]><!-->

    var k=1;

    <!--><![endif]-->

    function mytext1() {
        if (k==1) {
            document.getElementById("mylink").href="king.html";
            document.getElementById("mytext").innerHTML="THE KING OF KINGS";
        } else { if(k==2) {
            document.getElementById("mylink").href="crucifixion.html";
            document.getElementById("mytext").innerHTML="HE WAS PUNISHED FOR OUR SINS";
        } else{ if(k==3) {
            document.getElementById("mylink").href="resurrection.html";
            document.getElementById("mytext").innerHTML="HE WON DEATH";
        } else { if(k==4) {
            document.getElementById("mylink").href="trinity.html";
            document.getElementById("mytext").innerHTML="THE HOLY TRINITY";
            k=0;
        }}}}
        k++;
    }
</script> 
```

要使程序在所有浏览器中运行，k 在 Chrome 中必须等于 1，在 Internet Explorer 和 Firefox 中必须等于 0。

如何隐藏`K=1;`Internet Explorer 和 Firefox？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T09:46:19.907

要检测 Internet Explorer，您可以使用`navigator.appName`属性：

```
if (navigator.appName == 'Microsoft Internet Explorer') k = 1; 
```

要检测 Chrome，您可以使用

```
if (window.chrome) k = 0; 
```

要检测 Firefox，我建议使用`navigator.userAgent`属性

```
if (navigator.userAgent.toLowerCase().indexOf('firefox') > -1) k = 1; 
```

另请参阅[此问题](https://stackoverflow.com/questions/9847580/how-to-detect-safari-chrome-ie-firefox-and-opera-browser)

# c# - asp.net中的div截图

> ID：15993535
> 
> 赞同：1
> 
> 时间：2013-04-13T22:15:34.493
> 
> 标签：c#, javascript, asp.net, html, screenshot

我想在 asp.net 中截取一个 Div 元素并将其保存到磁盘。我不想使用 html2canvas 库或 html5 画布元素。方法可以是服务器端或客户端。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T22:40:24.437

Untested, but found this:

```
public Bitmap GenerateScreenshot(string url, int width, int height)
{
    // Load the webpage into a WebBrowser control
    WebBrowser wb = new WebBrowser();
    wb.ScrollBarsEnabled = false;
    wb.ScriptErrorsSuppressed = true;
    wb.Navigate(url);
    while (wb.ReadyState != WebBrowserReadyState.Complete) 
    { 
        Application.DoEvents(); 
    }

    // Set the size of the WebBrowser control
    wb.Width = width;
    wb.Height = height;

    if (width == -1)
    {
        // Take Screenshot of the web pages full width
        wb.Width = wb.Document.Body.ScrollRectangle.Width;
    }

    if (height == -1)
    {
        // Take Screenshot of the web pages full height
        wb.Height = wb.Document.Body.ScrollRectangle.Height;
    }

    // Get a Bitmap representation of the webpage as it's rendered in the WebBrowser control
    Bitmap bitmap = new Bitmap(wb.Width, wb.Height);
    wb.DrawToBitmap(bitmap, new Rectangle(0, 0, wb.Width, wb.Height));
    wb.Dispose();

    return bitmap;
} 
```

[http://pietschsoft.com/post/2008/07/c-generate-webpage-thumbmail-screenshot-image.aspx](http://pietschsoft.com/post/2008/07/c-generate-webpage-thumbmail-screenshot-image.aspx)

# jquery - jQuery 功能仅在某些页面上

> ID：15993536
> 
> 赞同：0
> 
> 时间：2013-04-13T22:15:42.963
> 
> 标签：jquery, wordpress, function

我正在尝试为不同的 wordpress 页面触发一个功能。

我想根据加载的页面打开我的 jquery 手风琴的不同“切片”。

我努力了

```
if ( is_page( 'sea-freight' ) )
        $(".va-slice-1").click(); 
```

我的功能有问题吗？

这是我的代码

```
<div class="container">

            <div id="va-accordion" class="va-container" style="width: 100%!important; height: 450px;"> 
                <div class="va-nav">
                    <span class="va-nav-prev">Previous</span>
                    <span class="va-nav-next">Next</span>
                </div>
                <div class="va-wrapper">
                    <div class="va-slice va-slice-1">
                        <div class="va-title">Airfreight</div>
                        <div class="va-content">
                            <p>Henry Watson</p>
                            <ul>
                                <li><a href="#">About</a></li>
                                <li><a href="#">Portfolio</a></li>
                                <li><a href="#">Contact</a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="va-slice va-slice-2">
                        <div class="va-title">Seafreight</div>
                        <div class="va-content">
                            <p>Keith Johnson</p>
                            <ul>
                                <li><a href="#">About</a></li>
                                <li><a href="#">Portfolio</a></li>
                                <li><a href="#">Contact</a></li>
                            </ul>
                        </div>  
                    </div>
                    <div class="va-slice va-slice-3">
                        <div class="va-title">Satellite Tracking</div>
                        <div class="va-content">
                            <p>Andrew Alaniz</p>
                            <ul>
                                <li><a href="#">About</a></li>
                                <li><a href="#">Portfolio</a></li>
                                <li><a href="#">Contact</a></li>
                            </ul>
                        </div>  
                    </div>
                    <div class="va-slice va-slice-4">
                        <div class="va-title">Guarding</div>
                        <div class="va-content">
                            <p>Ben Freeman</p>
                            <ul>
                                <li><a href="#">About</a></li>
                                <li><a href="#">Portfolio</a></li>
                                <li><a href="#">Contact</a></li>
                            </ul>
                        </div>  
                    </div>
                    <div class="va-slice va-slice-5">
                        <div class="va-title">Machine Moving</div>
                        <div class="va-content">
                            <p>Alex Schuman</p>
                            <ul>
                                <li><a href="#">About</a></li>
                                <li><a href="#">Portfolio</a></li>
                                <li><a href="#">Contact</a></li>
                            </ul>
                        </div>  
                    </div>
                    <div class="va-slice va-slice-6">
                        <div class="va-title">Investigations</div>
                        <div class="va-content">
                            <p>Maria Wales</p>
                            <ul>
                                <li><a href="#">About</a></li>
                                <li><a href="#">Portfolio</a></li>
                                <li><a href="#">Contact</a></li>
                            </ul>
                        </div>  
                    </div>
                    <div class="va-slice va-slice-7">
                        <div class="va-title">Transport</div>
                        <div class="va-content">
                            <p>Paul White</p>
                            <ul>
                                <li><a href="#">About</a></li>
                                <li><a href="#">Portfolio</a></li>
                                <li><a href="#">Contact</a></li>
                            </ul>
                        </div>  
                    </div>
                </div>
            </div>

        </div>
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
        <script type="text/javascript" src="wp-content/themes/FSI5/jquery.easing.1.3.js"></script>
        <script type="text/javascript" src="wp-content/themes/FSI5/jquery.mousewheel.js"></script>
        <script type="text/javascript" src="wp-content/themes/FSI5/jquery.vaccordion.js"></script>
        <script type="text/javascript">

                       $(function() {
                $('#va-accordion').vaccordion({
                    visibleSlices   : 5,
                    expandedHeight  : 250,
                    animOpacity     : 0.1,
                    contentAnimSpeed: 100
                });

if ( is_page( 'sea-freight' ) )
        $(".va-slice-1").click()
            });

        </script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T22:20:02.637

你不是在附和它。尝试

```
<?php if ( is_page( 'sea-freight' ) )
   echo ' $(".va-slice-1").click();'; ?> 
```

**[编辑]** 你还需要添加 php 标签。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T22:20:54.853

尝试这个：

```
<?php if (is_page('sea-freight')): ?>
$(".va-slice-1").click();
<?php endif; ?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-13T22:22:31.113

我不知道，也许 is_page() 它是您使用的引擎的功能。如果没有，浏览器没有基本的 js 功能，你可以在 javascript 上构建自己的

```
function is_page(page){
    if(page==window.location.pathname){
        return true;
    }
return false;
}

if ( is_page( 'sea-freight' ) )
    $(".va-slice-1").click()
        }); 
```

在某处打印 console.log(window.location); 并观察它包含的内容

# json - 使用 scala Play 框架处理多维 JSON

> ID：15993540
> 
> 赞同：0
> 
> 时间：2013-04-13T22:16:02.260
> 
> 标签：json, scala, playframework, playframework-2.0

我正在尝试使用 JSON 请求将数据从客户端发送到服务器。JSON 请求的正文如下所示：

```
[
 [
  {"x":"0","y":"0","player":0},
  {"x":"0","y":"1","player":0},                      
  {"x":"0","y":"2","player":1}
 ],
 [
  {"x":"1","y":"0","player":0},
  {"x":"1","y":"1","player":2},
  {"x":"1","y":"2","player":0}
 ],
 [
  {"x":"2","y":"0","player":0},
  {"x":"2","y":"1","player":1},
  {"x":"2","y":"2","player":2}
 ]
] 
```

在服务器端，我想使用 Play 2 框架将数据转换为 Scala 2D 列表，如下所示：

```
List(
 List(0,0,1),
 List(0,2,0),
 List(0,1,2)
) 
```

这是 3x3，但它可以像 50x50 左右一样可变。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T13:52:32.610

它可能不完整（不知道您是否也想对方阵约束进行建模）但类似的事情可能是一个好的开始：

首先是控制器（和模型）部分可以定义的内容

```
import play.api.libs.json.Json._
import play.api.libs.json._

type PlayerT = (String, String, Int)

implicit val playerTripleReads:Reads[PlayerT] = (
  (__ \ "x").read[String] and
  (__ \ "y").read[String] and
  (__ \ "player").read[Int]
  tupled
)

def getJson = Action(parse.json) { request =>
  request.body.validate[List[List[PlayerT]]].map{
    case xs => Ok(xs.mkString("\n"))
  }.recoverTotal{
    e => BadRequest("Detected error:"+ JsError.toFlatJson(e))
  }
} 
```

在此版本中，您将获得一个列表列表，其中包含已验证的表单元组，该表单`(String, String, Int)`已使用`PlayerT`类型别名以节省一些输入。

如您所见，阅读器是通过组合（使用`and`组合器）三个基本块“手动”创建的，并且使用运算符将​​结果展平`tupled`。

使用此解决方案，您现在可以使用这些元组，但 IMO 代码的可读性会很差，因为使用`_1`,`_2`并且`_3`在此过程中。

所以这里有一种不同的方法（实际上更容易......）来解决这个理智编码的问题，这将简单地定义一个模拟你的原子数据的“案例类”

```
case class Player(x:String, y:String, player:Int)

implicit val playerReads = Json.reads[Player]

def getJson = Action(parse.json) { request =>
  request.body.validate[List[List[Player]]].map{
    case xs => Ok(xs.mkString("\n"))
  }.recoverTotal{
    e => BadRequest("Detected error:"+ JsError.toFlatJson(e))
  }
} 
```

`case class`请注意，由于在编译时使用了读取器的隐式创建，读者将始终关注数据表示的进一步变化，即's 字段。

现在，您将能够使用`x`,`y`和`player`字段而不是`_1`,`_2`和`_3`。

# compiler-construction - 猎鹰语言保留关键字

> ID：15993542
> 
> 赞同：0
> 
> 时间：2013-04-13T22:16:32.373
> 
> 标签：compiler-construction, keyword, lexical-analysis, falcon

我正在为 Falcon 编写一个编译器（作为我的研究生编译器课程的课程项目）。目前我正在研究词法分析器。在那我需要弄清楚一个词位是关键字还是标识符。我找不到 Falcon 的所有保留关键字的列表。对于像 C、C++ 这样的语言，它可以在 Wikipedia 页面或一些标准书籍上轻松获得。

我做的一个肮脏的黑客行为是我为 Falcon 下载了 vim 语法文件以找出所有关键字，但通过这种方法我得到了大约 70 个单词，但我在某处读到 Falcon 有大约 30 个关键字，如 C。我还查看了 Falcon 的参考手册，但有我也无法在一个地方找到所有关键字的编译列表。有谁知道我在哪里可以获得 Falcon 的所有关键字列表？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T04:43:13.907

在他们完成（或开始）编写他们的[语言参考](http://www.falconpl.org/index.ftd?page_id=sitewiki&prj_id=_falcon_site&sid=wiki&pwid=Home&wid=Documentation)之前，除了对他们的解析器进行逆向工程之外，我真的看不出你能做什么。请注意，该页面上的链接不起作用，这就是重点。

# mysql - 如何将 MyISAM 中的大表转换为 INNODB？

> ID：15993548
> 
> 赞同：2
> 
> 时间：2013-04-13T22:17:41.880
> 
> 标签：mysql, innodb, upgrade, myisam

我有一个最初在 MySQL 3.x 中创建的游戏数据库，并且还有一些 MyISAM 表。

由于不同的原因（这是一个单独讨论的主题），我想将它们迁移到 INNODB。

其中一张表有 1.2 亿行（准确地说是 120 262 514）。我已经执行了它到 INNODB 的转换......它昨天开始并且仍在继续......

除了更改引擎之外，我还想更改几个字段的类型。查询如下：

```
ALTER TABLE gb_vfm5.my_table
    CHANGE COLUMN matchId matchId INT(11) NOT NULL DEFAULT 0,
    CHANGE COLUMN team team INT(11) NOT NULL DEFAULT 0,
    CHANGE COLUMN pl1 pl1 INT(11) NOT NULL DEFAULT 0,
    CHANGE COLUMN actionId actionId TINYINT(2) UNSIGNED NOT NULL DEFAULT 0,
    CHANGE COLUMN src src TINYINT(2) UNSIGNED NOT NULL DEFAULT 0,
    CHANGE COLUMN opponent opponent INT(11) NOT NULL DEFAULT 0, ENGINE = INNODB 
```

**问题：**

1.  为什么查询执行需要这么长时间？可能我应该首先更改引擎，然后更改字段？

2.  进行此类更改的最佳/正确方法是什么？

3.  这种类型的转换对 MySQL 服务器的负载有多大？

PS现在我正在考虑将DB复制到

要转换的表的 PPS 定义：

```
CREATE TABLE my_moment(
  Id INT(11) NOT NULL AUTO_INCREMENT,
  matchId INT(10) UNSIGNED NOT NULL DEFAULT 0,
  mTime TINYINT(3) UNSIGNED NOT NULL DEFAULT 0,
  team INT(10) UNSIGNED NOT NULL DEFAULT 0,
  pl1 INT(10) UNSIGNED NOT NULL DEFAULT 0,
  actionId TINYINT(1) UNSIGNED NOT NULL DEFAULT 0,
  src TINYINT(1) UNSIGNED NOT NULL DEFAULT 0,
  pos2 SMALLINT(5) UNSIGNED NOT NULL DEFAULT 0,
  pl2 INT(11) NOT NULL DEFAULT 0,
  poss1 SMALLINT(5) UNSIGNED NOT NULL DEFAULT 0,
  poss2 SMALLINT(5) UNSIGNED NOT NULL DEFAULT 0,
  mRes TINYINT(4) NOT NULL DEFAULT 0,
  opponent INT(10) NOT NULL DEFAULT 0,
  move TINYINT(3) UNSIGNED NOT NULL DEFAULT 0,
  PRIMARY KEY (Id),
  INDEX actionId (actionId, pl1, mRes),
  INDEX matchId (matchId),
  INDEX NewIndex1 (mRes),
  INDEX NewIndex3 (actionId, pl2),
  INDEX pl1 (pl1),
  INDEX pos2 (pos2),
  INDEX UK_my_table_MatchTeamAction (matchId, team, actionId)
)
ENGINE = MYISAM
AUTO_INCREMENT = 125433749
AVG_ROW_LENGTH = 36
CHARACTER SET cp1251
COLLATE cp1251_general_ci
COMMENT = 'My table description'; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-16T00:22:36.863

我不喜欢留下未答复的消息，所以我将 Joshua 的建议作为答案发布。

> 更改表时，MySQL 将使用新属性（或新引擎类型）创建第二个表，将第一个表的所有行复制到第二个表，然后用第二个表替换第一个表。对于大型表，此操作将需要很长时间。

所以背后的想法是在我自己的表中创建，将记录从原始表逐个移动到新表中，然后重命名表。最后一步是重新创建外键。

# jquery - 将 jquery 添加到 CSS 菜单

> ID：15993551
> 
> 赞同：0
> 
> 时间：2013-04-13T22:18:12.780
> 
> 标签：jquery, html, css, menu, onhover

我有一个需要 jquery 的 CSS 菜单。可悲的是，我很难弄清楚。下面是它的模型。当您将鼠标悬停在最顶部的菜单上时，将出现一个下拉菜单。使用 jquery，如果您将鼠标悬停在其他子链接上并打开其子链接，则第一个子节点应打开其子节点然后切换类。

![小样](https://i.stack.imgur.com/WIMr1.png)

```
Here is my fiddle: http://jsfiddle.net/ciancastillo/wtruM/ 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T22:28:00.377

如果要向 HTML 元素添加 jQuery 函数，请使用 load()

```
 <script type="text/javascript">
     $('#idOfItem').load(function() {
          $("td").hover( 
               function () {
                    $(this).addClass("hover");
               }, 
               function () {
                    $(this).removeClass("hover");
          });
      });
 </script> 
```

[http://api.jquery.com/load-event/](http://api.jquery.com/load-event/)

如果您想绑定到整个类（例如 .dropdownItem），请使用不同的选择器：

```
 $('.dropdownItem').load(function() {
          //Your code here
      }); 
```

更多 jQuery 选择器：[http ://api.jquery.com/category/selectors/](http://api.jquery.com/category/selectors/)

添加或删除 CSS 类：[http :](http://api.jquery.com/addClass/) [//api.jquery.com/removeClass/ http://api.jquery.com/addClass/](http://api.jquery.com/removeClass/)

# angularjs - 带有 angular.js 的补丁请求被发送到错误的 url

> ID：15993553
> 
> 赞同：2
> 
> 时间：2013-04-13T22:18:13.677
> 
> 标签：angularjs

我的 REST API 被配置为接受这种请求

```
public function lockUserAction($slug)
{} // "lock_user"     [PATCH] /users/{slug}/lock 
```

所以发送补丁请求到

```
/api/users/2/lock 
```

将锁定 id=2 的用户。这是我在 angular.js 中的休息服务

```
angular.module('UserService',['ngResource']).factory('User', function($resource){
    var User = $resource('/api/users/:id',
        {},
        { 
          list: { method: 'GET' },
          lock: { method: 'PATCH' }
        }
    );   
    return User;
}); 
```

列表仅适用于查找，但锁定不起作用。控制台打印：

```
PATCH /api/users 405 (Method Not Allowed) 
```

我这样调用它

```
$scope.lock = function(user){
    user.$lock();
} 
```

在错误消息中，我看到的是 url`/api/users`而不是`/api/users/2/lock`. 这是正常行为吗？`/api/users`当然，仅列出 GET 请求和 PATCH 请求除外`/api/users/{slug}/lock`。

为什么调用 /api/users 而不是 /api/users/{slug}/lock 的任何想法。任何想法如何解决这一问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-13T23:17:32.827

当您调用`$lock`angular 时，不知道您打算调用与以前相同的 url，并带有一些额外的路径元素。角度也无法知道`:id`参数的值是什么。

比让角度知道锁定：

```
var User = $resource('/api/users/:id/:action', //add param to the url
        {}, 
        { 
          list: { method: 'GET' },
          lock: { method: 'PATCH',params:{action:"lock",id:"@id"}} //set param value, so angular knows where to send request, @id refers to user id in json representation of user
        }
    ); 
```

# java - 在运行时单击添加按钮？

> ID：15993555
> 
> 赞同：0
> 
> 时间：2013-04-13T22:18:31.043
> 
> 标签：java, android

```
public class MainActivity extends Activity implements View.OnClickListener {
    int i, j, butNum, lay1num = 1, lay2num = 100, lay3num = 100, store;
    Button[] Button;
    EditText numBut;
    LinearLayout mainLayout;
    LinearLayout[] subLayout;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        butNum = 5;
        Button = new Button[butNum];
        subLayout = new LinearLayout[3];
        LinearLayout mainLayout = new LinearLayout(this);
        mainLayout.setOrientation(LinearLayout.HORIZONTAL);
        mainLayout.setWeightSum(90);
        mainLayout.setLayoutParams(new LayoutParams(LayoutParams.MATCH_PARENT,
                LayoutParams.MATCH_PARENT));

        subLayout[0] = new LinearLayout(this);
        subLayout[0].setOrientation(LinearLayout.VERTICAL);
        subLayout[0].setLayoutParams(new LayoutParams(
                LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT, 30));
        subLayout[0].setGravity(Gravity.CENTER_HORIZONTAL);
        subLayout[1] = new LinearLayout(this);
        subLayout[1].setOrientation(LinearLayout.VERTICAL);
        subLayout[1].setLayoutParams(new LayoutParams(
                LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT, 30));
        subLayout[2] = new LinearLayout(this);
        subLayout[2].setOrientation(LinearLayout.VERTICAL);
        subLayout[2].setLayoutParams(new LayoutParams(
                LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT, 30));
        subLayout[0].setGravity(0x10);
        for (i = 0; i < 3; i++) {
            for (j = 0; j < butNum; j++) {
                int value = j + 1;
                Button[j] = new Button(this);
                Button[j].setText("" + value);
                Button[j].setLayoutParams(new LayoutParams(
                        LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));
                Button[j].setTextSize(20);
                Button[j].setWidth(100 + j * 20);
                Button[j].setTag(value);
                Button[j].setId(j);
                subLayout[i].addView(Button[j]);
                Button[j].setOnClickListener(this);
            }
        }

        TextView text = new TextView(this);
        text.setText("" + store);
        subLayout[0].addView(text);
        mainLayout.addView(subLayout[0]);
        mainLayout.addView(subLayout[1]);
        mainLayout.addView(subLayout[2]);

        setContentView(mainLayout);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

    public void onClick(View v) {
        // TODO Auto-generated method stub
        LinearLayout.LayoutParams layoutParams = new LinearLayout.LayoutParams(
                LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT);
        switch (v.getId()) {
        case 0:
            subLayout[0].addView(Button[0], layoutParams);
            break;
        }

    }

} 
```

我使用 java 创建了三个布局并将它们添加到主布局中。活动开始时，我在第一个布局中添加了按钮。我想要做的是在我们单击按钮时向 subLayout[1] 添加一个新按钮。但是当我运行程序时，当我单击按钮时它崩溃（说程序已意外停止）。LogCat 是：

```
 04-14 03:52:39.174: D/AndroidRuntime(349): Shutting down VM
04-14 03:52:39.174: W/dalvikvm(349): threadid=1: thread exiting with uncaught exception (group=0x4001d800)
04-14 03:52:39.184: E/AndroidRuntime(349): FATAL EXCEPTION: main
04-14 03:52:39.184: E/AndroidRuntime(349): java.lang.IllegalStateException: The specified child already has a parent. You must call removeView() on the child's parent first.
04-14 03:52:39.184: E/AndroidRuntime(349):  at android.view.ViewGroup.addViewInner(ViewGroup.java:1970)
04-14 03:52:39.184: E/AndroidRuntime(349):  at android.view.ViewGroup.addView(ViewGroup.java:1865)
04-14 03:52:39.184: E/AndroidRuntime(349):  at android.view.ViewGroup.addView(ViewGroup.java:1845)
04-14 03:52:39.184: E/AndroidRuntime(349):  at com.creos.towerofhanoi.MainActivity.onClick(MainActivity.java:85)
04-14 03:52:39.184: E/AndroidRuntime(349):  at android.view.View.performClick(View.java:2408)
04-14 03:52:39.184: E/AndroidRuntime(349):  at android.view.View$PerformClick.run(View.java:8816)
04-14 03:52:39.184: E/AndroidRuntime(349):  at android.os.Handler.handleCallback(Handler.java:587)
04-14 03:52:39.184: E/AndroidRuntime(349):  at android.os.Handler.dispatchMessage(Handler.java:92)
04-14 03:52:39.184: E/AndroidRuntime(349):  at android.os.Looper.loop(Looper.java:123)
04-14 03:52:39.184: E/AndroidRuntime(349):  at android.app.ActivityThread.main(ActivityThread.java:4627)
04-14 03:52:39.184: E/AndroidRuntime(349):  at java.lang.reflect.Method.invokeNative(Native Method)
04-14 03:52:39.184: E/AndroidRuntime(349):  at java.lang.reflect.Method.invoke(Method.java:521)
04-14 03:52:39.184: E/AndroidRuntime(349):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
04-14 03:52:39.184: E/AndroidRuntime(349):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
04-14 03:52:39.184: E/AndroidRuntime(349):  at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T23:20:50.020

我终于解决了，我必须在 onclick 中指定按钮参数。这是一个小错误

```
public void onClick(View v) {
        // TODO Auto-generated method stub

        switch (v.getId()) {
        case 0:

            Button[0] = new Button(this);
            Button[0].setLayoutParams(new LayoutParams(
                    LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));
            subLayout[1].addView(Button[0]);

            break;
        }

    } 
```

# user-interface - 我可以更改 pygame 窗口标题栏中的 pygame 徽标吗？

> ID：15993557
> 
> 赞同：0
> 
> 时间：2013-04-13T22:18:43.943
> 
> 标签：user-interface, pygame, titlebar

是否可以将 Pygame 窗口标题栏中的 Pygame 徽标更改为我自己的程序徽标？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T11:45:54.627

Yes, you can use [`pygame.display.set_icon()`](http://www.pygame.org/docs/ref/display.html#pygame.display.set_icon):

> **pygame.display.set_icon()**
> 
> *Change the system image for the display window*
> 
> `set_icon(Surface) -> None`
> 
> Sets the runtime icon the system will use to represent the display window. All windows default to a simple pygame logo for the window icon.
> 
> You can pass any surface, but most systems want a smaller image around 32x32\. The image can have colorkey transparency which will be passed to the system.
> 
> Some systems do not allow the window icon to change after it has been shown. This function can be called before pygame.display.set_mode() to create the icon before the display mode is set.

# ios - CLLocationManager 委托不起作用

> ID：15993562
> 
> 赞同：0
> 
> 时间：2013-04-13T22:19:15.863
> 
> 标签：ios, objective-c

我的 ViewController 中有以下代码：

```
#import "ViewController.h"

@interface ViewController ()
@end

@implementation ViewController

- (void)viewDidLoad
{
    [super viewDidLoad];
}

-(void)locationManager:(CLLocationManager *)manager didUpdateToLocation:(CLLocation *)newLocation fromLocation:(CLLocation *)oldLocation
{
    int desiredHA = 200;
    RemoteDataController *rdc = [[RemoteDataController alloc]init];
    double ha = newLocation.horizontalAccuracy;

    if (ha <= desiredHA)
    {
        [rdc addLoc];
        [self.locationManager stopUpdatingLocation];
        return;
    }
}

-(void)startLogging
{
    if(self.locationManager==nil)
    {
    self.locationManager=[[CLLocationManager alloc] init];
    self.locationManager.delegate = self;
    self.locationManager.desiredAccuracy=kCLLocationAccuracyBest;
    self.locationManager.distanceFilter=kCLDistanceFilterNone;
    }

    if([CLLocationManager locationServicesEnabled])
    {
        NSLog(@"Start Location Tracking");
        [self.locationManager startUpdatingLocation];
    }
}

-(void)addLocResponse
{
    NSLog(@"send checkin response");
    self.silenceTimer = [NSTimer scheduledTimerWithTimeInterval:10 target:self
                         selector:@selector(onTick:) userInfo:nil repeats:NO];
}

-(void)onTick:(NSTimer *)timer
{
    [self startLogging];
} 
```

然后我的 RemoteDataController.m 文件如下所示：

```
@implementation RemoteDataController

-(void)addLoc
{
    ViewController *vc = [[ViewController alloc]init];
    [vc addLocResponse];
    NSLog(@"Add Loc");
}

@end 
```

我知道这现在看起来很愚蠢，但我删除了很多细节，所以它并不太复杂。

我的问题是当我`addLocResponse`从 RemoteDataController 类调用时，计时器运行，然后再次`onTick`触发 which fires `startLogging`。我可以看到它`startLogging`再次从 NSLog 运行，但它没有再次运行 locationManager 委托。

如果我将所有这些都保留在其中，`ViewController`它可以正常工作，但是当我尝试外出`RemoteDataController`和返回时，它就不起作用了。

我只是想弄清楚我在这里做错了什么。

这是iOS6。

任何帮助都会很棒。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T02:02:22.020

您没有为视图控制器使用正确的初始化程序。另外，在 ViewController 实例的 dealloc 方法上放置一个断点。很有可能它正在被释放（如果您使用的是 ARC），因为您没有对它做任何事情（模态演示或推送）。

# php - 使用 JMS 序列化器仅将实体关系序列化为 Id

> ID：15993565
> 
> 赞同：26
> 
> 时间：2013-04-13T22:19:25.583
> 
> 标签：php, symfony, jmsserializerbundle

我正在尝试使用 JMS Serializer 序列化实体关系。

这是实体：

```
class Ad
{ 

    /**
     * @Type("string")
     * @Groups({"manage"})
     * 
     * @var string
     */
    private $description;

    /**
     * @Type("Acme\SearchBundle\Entity\Country")
     * @Groups({"manage"})
     * 
     * @var \Acme\SearchBundle\Entity\Country
     */
    private $country;

    /**
     * @Type("string")
     * @Groups({"manage"})
     * 
     * @var string
     */
    private $title;

    /**
     * Set description
     *
     * @param string $description
     * @return Ad
     */
    public function setDescription($description)
    {
        $this->description = $description;

        return $this;
    }

    /**
     * Get description
     *
     * @return string 
     */
    public function getDescription()
    {
        return $this->description;
    }

    /**
     * Set country
     *
     * @param \Acme\SearchBundle\Entity\Country $country
     * @return Ad
     */
    public function setCountry($country)
    {
        $this->country= $country;

        return $this;
    }

    /**
     * Get country
     *
     * @return string 
     */
    public function getCountry()
    {
        return $this->country;
    }

    /**
     * Set title
     *
     * @param string $title
     * @return Ad
     */
    public function setTituloanuncio($title)
    {
        $this->title = $title;

        return $this;
    }

    /**
     * Get title
     *
     * @return string 
     */
    public function getTitle()
    {
        return $this->title;
    }

} 
```

以及关系的实体：

```
class Country
{

    /**
     * @Type("string")
     * @Groups("manage")
     * 
     * @var string
     */
    private $id;

    /**
     * @Type("string")
     * @Groups("admin")
     * 
     * @var string
     */
    private $description;

    /**
     * Set description
     * @Groups("")
     *
     * @param string $description
     * @return Country
     */
    public function setDescripcionpais($description)
    {
        $this->description = $description;

        return $this;
    }

    /**
     * Get description
     *
     * @return string 
     */
    public function getDescription()
    {
        return $this->description;
    }

    }

    /**
     * Get id
     *
     * @return string 
     */
    public function getId()
    {
        return $this->id;
    }
} 
```

我序列化实体，但我不知道如何将国家属性转换为简单字段。

我在 json 中得到这个结果：

```
{"description":"foo", "title":"bar", "country":{"id":"en"} } 
```

但我想像这样获得国家的 id 字段：

```
{"description":"foo", "title":"bar", "country": "en" } 
```

JMS 序列化器可以吗？

谢谢你。

**[编辑]**

@VirtualProperty 不起作用。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-04-14T08:39:20.857

是的，您可以使用`@VirtualProperty`注释：

```
/**
 * @VirtualProperty
 * @SerializedName("foo")
 */
public function bar()
{
    return $this->country->getCode();
} 
```

但是在反序列化方面要注意：

> @VirtualProperty 这个注解可以定义在一个方法上，表示该方法返回的数据应该看起来像对象的一个​​属性。
> 
> **> 注意：这仅适用于序列化，在反序列化过程中完全被忽略。**

希望这可以帮助...

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2016-03-24T11:34:56.803

只需遵循已回答的问题：

如果您不喜欢为您拥有的每个关系编写一种方法 - 只需编写您自己的处理程序。这很容易

```
final class RelationsHandler
{
    /**
     * @var EntityManagerInterface
     */
    private $manager;

    /**
     * RelationsHandler constructor.
     *
     * @param EntityManagerInterface $manager
     */
    public function __construct(EntityManagerInterface $manager) { $this->manager = $manager; }

    public function serializeRelation(JsonSerializationVisitor $visitor, $relation, array $type, Context $context)
    {
        if ($relation instanceof \Traversable) {
            $relation = iterator_to_array($relation);
        }

        if (is_array($relation)) {
            return array_map([$this, 'getSingleEntityRelation'], $relation);
        }

        return $this->getSingleEntityRelation($relation);
    }

    /**
     * @param $relation
     *
     * @return array|mixed
     */
    protected function getSingleEntityRelation($relation)
    {
        $metadata = $this->manager->getClassMetadata(get_class($relation));

        $ids = $metadata->getIdentifierValues($relation);
        if (!$metadata->isIdentifierComposite) {
            $ids = array_shift($ids);
        }

        return $ids;
    }
} 
```

注册处理程序

```
 jms_serializer.handler.relation:
      class: MyBundle\RelationsHandler
      arguments:
      - "@doctrine.orm.entity_manager"
      tags:
      - { name: jms_serializer.handler, type: Relation, direction: serialization, format: json, method: serializeRelation}
      - { name: jms_serializer.handler, type: Relation, direction: deserialization, format: json, method: deserializeRelation}
      - { name: jms_serializer.handler, type: Relation<?>, direction: serialization, format: json, method: serializeRelation}
      - { name: jms_serializer.handler, type: Relation<?>, direction: deserialization, format: json, method: deserializeRelation} 
```

这允许您用 `Type("Relation") 替换虚拟 getter 方法。

如果您也不想反序列化关系 - 您应该告诉每个`@Type("Relation")`类名 ( `@Type("Relation<FQCN>")`) 它应该反序列化到哪个类名 ( ) 或用一个为您执行此操作的元数据驱动程序包装元数据驱动程序。

```
 public function deserializeRelation(JsonDeserializationVisitor $visitor, $relation, array $type, Context $context)
    {
        $className = isset($type['params'][0]['name']) ? $type['params'][0]['name'] : null;

        if (!class_exists($className, false)) {
            throw new \InvalidArgumentException('Class name should be explicitly set for deserialization');
        }

        $metadata = $this->manager->getClassMetadata($className);

        if (!is_array($relation)) {
            return $this->manager->getReference($className, $relation);
        }

        $single = false;
        if ($metadata->isIdentifierComposite) {
            $single = true;
            foreach ($metadata->getIdentifierFieldNames() as $idName) {
                $single = $single && array_key_exists($idName, $relation);
            }
        }

        if ($single) {
            return $this->manager->getReference($className, $relation);
        }

        $objects = [];
        foreach ($relation as $idSet) {
            $objects[] = $this->manager->getReference($className, $idSet);
        }

        return $objects;
    } 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2014-02-16T01:52:00.160

我知道这已经得到解答，但您也可以使用@Accessor。这可能（可能，我不能确定）也适用于反序列化。

```
/**
 * @Type("Acme\SearchBundle\Entity\Country")
 * @Groups({"manage"})
 * 
 * @var \Acme\SearchBundle\Entity\Country
 *
 * @Serializer\Accessor(getter="getCountryMinusId",setter="setCountryWithId")
 */
private $country;

/**
 * @return string|null
 */
public function getCountryMinusId()
{
    if (is_array($this->country) && isset($this->country['id'])) {
        return $this->country['id'];
    }

    return null;
}

/**
 * @param string $country
 * @return $this
 */
public function setCountryWithId($country)
{
    if (!is_array($this->country)) {
        $this->country = array();
    )

    $this->country['id'] = $country;

    return $this;
} 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2015-12-17T14:44:08.327

您可以使用 `@Type`和`@Accessor`注释：

```
/**
 * @Type("string") 
 * @Accessor(getter="serializeType",setter="setType") 
 */
protected $type;
public function serializeType()
{   
  return $this->type->getId();
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-10-06T08:23:25.643

作者希望保留属性名称，这不适用于已接受的答案。据我了解，ScayTrase 的答案将保留原始属性名称，但根据评论还有另一个缺点：如果您使用 Doctrine ORM，将获取相关对象`@ManyToOne`，从而降低性能。

如果要保留原始属性名称，则必须定义`@VirtualProperty`at 类级别和`@Exclude`原始属性。否则，序列化的属性名称将派生自 getter 方法（`countryId`在本例中）：

```
/**
 * @Serializer\VirtualProperty(
 *     "country",
 *     exp="object.getCountryId()",
 *     options={@Serializer\SerializedName("country")}
 * )
 */
class Ad {
    /**
     * @Serializer\Exclude
     */
    private $country;

    public function getCountryId() {
        return $this->country === null ? null : $this->country->getId();
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-04-20T15:40:46.943

或者，您可以`@inline` `$country`将其属性序列化到父关系中。然后你可以`@Expose`将 Country`$id`设置`@SerializedName`为`"country"`. 与虚拟属性不同，**序列化和反序列化都适用于内联属性**。

为此，您需要`@ExclusionPolicy("All")`在每个类上使用 ，并明智地`@Expose`使用您在任何组中需要的属性。[无论如何，这是一个更安全的策略](https://en.wikipedia.org/wiki/Principle_of_least_privilege)。

```
/**
 * @ExclusionPolicy("All")
 */
class Ad
{ 

    //...

    /**
     * @Type("Acme\SearchBundle\Entity\Country")
     * 
     * @Expose()
     * @Inline()
     * @Groups({"manage"})
     *
     * @var \Acme\SearchBundle\Entity\Country
     */
    private $country;

    //...

} 
```

```
/**
 * @ExclusionPolicy("All")
 */
class Country
{

    //...

    /**
     * Get id
     *
     * @Expose()
     * @Groups({"manage"})
     * @SerializedName("country")
     * @return string 
     */
    public function getId()
    {
        return $this->id;
    }
} 
```

# dart - 如何从 build.dart 将参数传递给 Web UI 的 dwc 编译器？

> ID：15993566
> 
> 赞同：3
> 
> 时间：2013-04-13T22:19:33.217
> 
> 标签：dart, dart-webui

我想通过 dwc（Web UI 编译器）关闭 URL 重写。我通过 build.dart 运行 dwc。如何将 build.dart 中的参数传递给 dwc？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-13T22:19:33.217

之后的任何参数`--`都将传递给 dwc。

```
void main() {
  var args = new List.from(new Options().arguments);
  args.addAll(['--', '--no-rewrite-urls']);

  build(args, ['web/clock_page.html']);
} 
```

阅读更多关于[dwc](http://www.dartlang.org/articles/web-ui/tools.html)的信息。

# wolfram-mathematica - Mathematica 中特定 x、y、z 值的函数梯度

> ID：15993571
> 
> 赞同：0
> 
> 时间：2013-04-13T22:20:41.577
> 
> 标签：wolfram-mathematica

我正在寻找一种方法来找到函数的梯度，然后在特定的 x、y、z 值处评估输出。到目前为止，我有

```
Needs["VectorAnalysis`"]
Clear[x, y, z]
v1 = Grad[x^2 + y^2 + z^2 - 9, Cartesian[x, y, z]] 
```

输出 {2 x, 2 y, 2 z}。例如，我如何在 x=2、y=2 和 z=1 时对此进行评估？这对于上面的函数来说似乎微不足道，但对于更复杂的函数来说却非常有用。非常感谢您的任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T22:57:19.813

您可以使用以下`Replace`值按变量`Rule`：

`v1/.{x->2,y->2,z->1}`

# android - R.java 文件实际上做了什么以及如何

> ID：15993572
> 
> 赞同：9
> 
> 时间：2013-04-13T22:20:53.237
> 
> 标签：android

我一直在研究一个简单的android教程，在浏览项目文件夹时，我`R.java`在文件夹中找到了这个文件`gen`......

打开的时候，我觉得是一团糟……

*   首先`R`本身是一个`class`.
*   它已`multiple Inner classes`在例如`drawable`, `id`,`layout`等中定义。
*   并且内部类有许多声明如下的变量，这些变量分配了十六进制值

    公共静态最终 int addr=0x7f080003; ... ... 以及更多

R 是自动生成的，并充当其他文件的指针

R.java 的问题

*   它基本上是为了什么
*   这个怎么运作
*   为什么
*   值是十六进制
*   它在实际应用程序运行时扮演什么角色

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-13T22:33:07.057

“充当指向其他文件的指针”实际上是绝对正确的，现在的问题是它指向哪些文件它是如何完成的。

## 它包含什么？

R 文件包含`res`项目文件夹中所有资源的 ID，以及您自己定义的一些附加 ID（例如在布局中）。Android 资源管理系统需要这些 ID 从 APK 中检索文件。每个 ID 基本上是一个数字，对应于资源管理系统中的某个资源。

该文件本身是必需的，因此您可以通过将资源的 ID 提供给资源管理器来从代码中访问或引用资源。说，如果你想在活动中设置视图，你打电话

```
setContentView(R.layout.main); 
```

`main`R文件中包含的数字被Android资源管理系统理解为布局文件，称为main。

## 为什么它比简单的文件名更好？

生成的字段更难出错。如果你写错了字段名，你的程序将无法编译，你会立即知道有错误。但是，如果您编写的字符串不正确，则应用程序在启动之前不会失败。

如果你想阅读更多关于这个主题的内容，你应该查看 Android 文档，尤其是[访问资源](http://developer.android.com/guide/topics/resources/accessing-resources.html)部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T22:25:10.837

这包含您的资源ID。所以当你做类似的事情时

```
TextView tv = (TextView) findViewById(R.id.mytextview); 
```

它会在此处查找您的 id `View`，`layout`等等...这样，该应用程序可以轻松查找您的 id，同时您可以使用容易记住的名称。任何时候你创建一个`resource`它都会自动`id`为它创建一个并将它存储在这里。这就是为什么您永远不想自己尝试编辑此文件的原因。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-22T11:11:59.503

一种思考 R.java 价值的方法，想象一个没有它的世界。令人惊奇的是，android 将 xml 和 java 世界结合在一起，以帮助避免完全手动编写 UI。使用 Java 语言构建遗留的 Java 用户界面是一件痛苦的事情。无价。

使用 Android，您不仅可以仅使用 xml 构建 UI，还可以在构建时查看它。无价。

xml 中的每个元素都可以在 java 代码中引用，而无需编写一行代码来解析 xml:)。只是 R.id.nameOfElement。无价。

快速开发在 android 中完美完成。想象一下，如果 iPhone 有 5000 个屏幕来容纳一段代码，他们会在 XCode 上崩溃。Google 仅使用 R.java 就完成了出色的工作。无价。

# php - 获取此数组的一部分以在 php 中打印出来

> ID：15993575
> 
> 赞同：-2
> 
> 时间：2013-04-13T22:20:57.893
> 
> 标签：php, arrays, wordpress

这是我的代码，

```
$menu_name = 'featured-page'; // Name of Custom Navagation in the back end

if ( ( $locations = get_nav_menu_locations() ) && isset( $locations[ $menu_name ] )) {
    $menu = wp_get_nav_menu_object( $locations[ $menu_name ] );
    $menu_items = wp_get_nav_menu_items($menu->term_id);
}

foreach ( $menu_items as $menu_item ) {
  $numbers[] = get_post_meta( $menu_item->ID, '_menu_item_object_id', true );
}

var_dump($numbers) ; 
```

* * *

```
var_dump($numbers) ; 
```

会显示这个

数组(3) { [0]=> 字符串(2) "11" [1]=> 字符串(1) "9" [2]=> 字符串(1) "8" }

我需要打印出来

11,9,8

如何才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T23:00:50.650

使用内爆

```
echo implode(',', $numbers); 
```

# c++ - 使用辅助 .cpp 和 .h 处理链接错误

> ID：15993576
> 
> 赞同：0
> 
> 时间：2013-04-13T22:21:07.350
> 
> 标签：c++, header, lnk2005

首先，我遇到问题的代码片段；

设置.h

```
 namespace
{
int WINDOW_WIDTH;
int WINDOW_HEIGHT;
bool FULLSCREEN;
}

void settings_init(); 
```

设置.cpp

```
#include "DX_Constants.h"

void settings_init()
{
 WINDOW_WIDTH = 1920;
 WINDOW_HEIGHT = 1080;
 FULLSCREEN = true;

} 
```

main.cpp //只是重要的部分..我没有忘记winapi需要的其他部分

```
#include "settings.h"

int WINAPI WinMain(...)
{
settings_init();

if(//verifies values entered are seen here correctly ...NOTE triggers on != )
return false;

....code continues
} 
```

我的问题：

1.  以这种格式运行代码会触发 if 语句检查并关闭程序。

2.  如果我删除命名空间匿名，我会得到变量的 LNK 2005 错误。

3.  如果我简单地注释掉所有 settings.cpp 并将函数定义放入头文件中，我可以让代码运行，但这对我来说是一个简写。

我需要什么：显然对标头和辅助 .cpp 文件有更多的了解......并且可能是链接。我有几本书；kelly 的“2d 游戏编程”、harbour 的“beginning game programming”和 horton 的“visual C++ 2010”。有人可以指出一个地方的方向来更详细地了解我的问题，即让函数存在于 .cpp 中，而声明存在于标题中，或者推荐一本书来教我理解这些问题？

解决方案编辑：感谢 Mats Petersson（见评论）

代码的解决方案最终是；

1.  删除匿名命名空间和括号。
2.  在 settings.h 中的全局变量类型声明前应用 extern 前缀。
3.  将普通的全局变量声明（例如 int window_width;）添加到 settings.cpp 文件中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T22:51:07.997

名称`WINDOW_HEIGHT`和`WINDOW_WIDTH`可能在 Windows 环境中用作宏或其他名称。使用全是大写名称的变量通常不是一个好主意，因为这是宏的约定，因此与某些头文件中定义的某些宏意外冲突的可能性很大，您甚至不知道它被包含在内更大。

我建议您更改变量的名称，以免它们发生冲突 - 简单的方法是使用小写名称，`window_height`and`window_width`等。

# javascript - Javascript 函数覆盖原型

> ID：15993578
> 
> 赞同：4
> 
> 时间：2013-04-13T22:21:22.303
> 
> 标签：javascript, oop, function, object, prototype

我在 SO 上找到了一些有趣的例子。其中包括[本文](http://www.mollypages.org/misc/js.mp)的链接。据说：

> `Function.__proto__`指向`Function.prototype`. 这导致：

```
 Function.constructor === Function 
```

> 也就是说：函数是它自己的构造函数！

```
Object instanceof Object == true. 
```

这是因为：

```
Object.__proto__.__proto__.constructor == Object 
```

> 另请注意，与`Object instanceof Object`,不同`Foo instanceof Foo == false`。这是因为：`Foo`不作为它自己的原型链的构造函数存在。

从 Mozilla 开发者网络我发现原型和构造函数都可以很容易地被覆盖。而且由于[`instanceof`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/instanceof)只是检查`constructor.prototype`原型链，我真的不明白为什么我的代码仍然返回`false`。

```
function Foo() { } ;
Foo.prototype = Foo
Foo.constructor = Foo
Foo instanceof Foo // still false 
```

还有一些关于原型的问题。我做对了吗，原型本身是一个单独的辅助对象？这个对象就像另一个对象上的指针——通常`Object`。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-14T00:06:05.107

`obj instanceof`不查找`constructor`in `obj.prototype`，而是在对象的内部`__proto__`属性中查找。

javascript 中的每个对象都有一个`__proto__`引用对象原型的内部属性。当使用`new`运算符构造对象时，该对象的内部`__proto__`属性设置为构造函数的`prototype`属性。

因此，当您说 时`Foo instanceof Foo`，javascript VM 将在`Foo.__proto__`. 因为 Foo 是一个函数，`Foo.__proto__`所以是`Function.prototype`（ `Function`函数的构造函数在哪里）。

由于您实际上无法更改对象的内部`__proto__`属性，因此 Foo 永远不能是 Foo 的实例。

* * *

关于你的小问题：在 javascript 中，一切都是对象。这包括原型**和**函数。事实上，ECMAScript 5 添加了一个函数`Object.create`( [MDN](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/create) )，它以一个对象作为其第一个参数，然后使用第一个对象作为其内部原型对象创建一个新对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-14T00:32:53.097

重要的是要记住，作为原型链一部分的对象的实际内部原型引用与对象的原型*属性*不同。对象的内部原型设置为其构造函数的原型*属性*。

我在学习这个时发现最容易理解的文章实际上是[这篇](http://beej.us/blog/data/javascript-prototypes-inheritance/)文章。

换句话说，改变`prototype`对象属性的唯一要点是该对象是否是一个应该用作构造函数的函数。除此之外，它没有什么神奇之处，它只是一个属性。改变`prototype`不会改变`__proto__`，也不会影响对象的原型链。

所以，通过代码：

```
function Foo() {} 
```

Foo 的构造函数此时实际上是 Function，而 Function.prototype 是 Foo 的实际内部原型，或者`__proto__`如果你愿意的话。

```
Foo.prototype = Foo; 
```

这只会改变 Foo 的原型*属性*，但不会改变它的内部原型。

```
Foo.constructor = Foo 
```

这实际上只在 Foo 上设置了 constructor 属性，它对 Foo.prototype.constructor 没有任何作用，它也对 Foo 的内部原型的构造函数没有任何作用，这是`instanceof`检查的内容。

* * *

试试这个代码序列，希望它会更清楚一点：

```
function Foo() { } ;

(Foo.prototype != Function.prototype && Foo.__proto__ == Function.prototype);

Foo.prototype = Foo;

(Foo.prototype == Foo && Foo.__proto__ != Foo && Foo.__proto__ == Function.prototype);

Foo.constructor = Foo;

(Foo.constructor == Foo && Foo.prototype.constructor == Foo && Foo.__proto__.constructor != Foo); 
```

# php - 将数组值从 php 传递到 javascript 数据仅返回一个值

> ID：15993580
> 
> 赞同：2
> 
> 时间：2013-04-13T22:21:34.487
> 
> 标签：php, javascript

这个函数工作正常，但它只返回一个值。我在这里缺少什么？

这是我的代码：

```
 <script type='text/javascript'>
$(function () {

<?php
//Get the names and id's
$get_info=mysql_query("select * from table where id = '1'");

if($get_info){
while($row_info=mysql_fetch_array($get_info))
{
$username=$row_info['name'];
$user_id=$row_info['profile_id'];
?>

onDataRequest:function (mode, query, callback) {
 var data = [

{ id:<?php echo $user_id;?>, name:'<?php echo $username;?>', 'avatar':'http://cdn0.4dots.com/i/customavatars/avatar7112_1.gif', 'type':'contact' }

 ];

     data = _.filter(data, function(item) { return item.name.toLowerCase().indexOf(query.toLowerCase()) > -1 });
     callback.call(this, data);
    }
  });

<?php
}}
?>
});
</script> 
```

**预期结果：**

```
{
    id: 295,
    name: 'Mike',
    'avatar': 'http: //cdn0.4dots.com/i/customavatars/avatar7112_1.gif',
    'type': 'contact'
},
{
    id: 296,
    name: 'John',
    'avatar': 'http: //cdn0.4dots.com/i/customavatars/avatar7112_1.gif',
    'type': 'contact'
} 
```

**实际输出：**

```
{
    id: 295,
    name: 'Mike',
    'avatar': 'http: //cdn0.4dots.com/i/customavatars/avatar7112_1.gif',
    'type': 'contact'
} 
```

它只返回 1 个项目。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T22:40:03.207

Every time you loop, you are assigning new values for your onDataRequest javascript function, however, it's the same function every time. You should think about execution order - first, you do PHP&MySQL server-side and what is generated as HTML or Javascript code there gets rendered and/or executed client-side later.

Basically, you have a PHP loop that goes over a set of values and those values are put inside a Javascript code that is within a HTML code block. So whatever you fetch from your database server last, is what is **actually** executed client-side.

The main idea here is that you shouldn't mix your server-side PHP code with client-side HTML or Javascript code.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-13T22:25:15.867

您的数据库提取循环不会保留每个提取的值。您只需用当前 fetch 覆盖先前的 fetch 调用。也许你的意思是这样的：

```
while ($row_info = mysql_fetch_asssoc($result)) {
    $username[] = $row_info['name'];
    $user_id[] = $row_info['profile_id'];
} 
```

vars 上的`[]`符号告诉 PHP 将 vars 视为数组并将新值推送到数组中。

然后，您可以使用以下命令将数组插入 javascript：

```
var usernames = <?php echo json_encode($username); ?>;
var user_ids = <?php echo json_encode($user_id); ?>; 
```

# javascript - 初始拒绝后使用 getUserMedia() 重新提示权限

> ID：15993581
> 
> 赞同：98
> 
> 时间：2013-04-13T22:21:35.507
> 
> 标签：javascript, webrtc, getusermedia

在被拒绝一次后，我们如何使用 getUserMedia() 请求相机/麦克风访问权限？

我正在使用 getUserMedia 访问用户的相机并将数据传输到画布。那一点都很好。

在测试中，我点击了一次拒绝。此时在 Chrome 和 Firefox 中，任何带有 getUserMedia() 的后续请求都默认为拒绝状态。

我们显然不想在被拒绝后在每个页面加载时请求相机/麦克风的权限来惹恼我们的用户。地理定位 API 已经够烦人的了。

但是，必须有一种方法可以再次请求它。仅仅因为用户点击一次拒绝并不意味着他们想要一直拒绝网络摄像头访问。

我一直在阅读规范并在谷歌上搜索了一段时间，但我没有找到任何关于这个问题的明确信息。

编辑：进一步研究，似乎在 Chrome 中点击拒绝会将当前站点添加到阻止列表中。这可以通过 chrome://settings/content 手动访问。滚动到媒体。管理例外，删除被阻止的站点。

链接到 chrome://settings/content 不起作用（在我们想要添加有用的链接以让人们重新启用权限的情况下）。

处理 getUserMedia 权限的整个 UX 很糟糕。=(

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-10-07T23:29:42.907

jeffreyveon 的回答将有助于减少您的用户选择拒绝的机会，因为她只需选择一次。

如果她确实单击了拒绝，您可以提供一条消息，说明您需要许可的原因以及如何更新她的选择。例如：

```
navigator.getUserMedia (
   // constraints
   {
      video: true,
      audio: true
   },

   // successCallback
   function(localMediaStream) {
      var video = document.querySelector('video');
      video.src = window.URL.createObjectURL(localMediaStream);
      video.onloadedmetadata = function(e) {
         // Do something with the video here.
      };
   },

   // errorCallback
   function(err) {
    if(err === PERMISSION_DENIED) {
      // Explain why you need permission and how to update the permission setting
    }
   }
); 
```

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2018-10-08T11:31:20.853

Chrome 实现了[`Permissions API`](https://developer.mozilla.org/en-US/docs/Web/API/Permissions_API)in `navigator.permissions`，这也适用于`camera`和`microphone`权限。

所以到目前为止，在调用之前`getUserMedia()`，您可以使用此 API 来查询您的相机和麦克风的权限状态：

```
 navigator.permissions.query({name: 'microphone'})
 .then((permissionObj) => {
  console.log(permissionObj.state);
 })
 .catch((error) => {
  console.log('Got error :', error);
 })

 navigator.permissions.query({name: 'camera'})
 .then((permissionObj) => {
  console.log(permissionObj.state);
 })
 .catch((error) => {
  console.log('Got error :', error);
 }) 
```

成功时，`permissionObj.state`将返回`denied`，`granted`或`prompt`。

有用的 SF 问题/答案[在这里](https://stackoverflow.com/questions/23048083/how-to-detect-if-microphone-permissions-have-been-granted-in-chrome?noredirect=1&lq=1)

对于跨浏览器解决方案，一种简单的方法是监控`getUserMedia()`Promise 被调用与被拒绝或解决之间的时间差，如下所示：

```
// In the Promise handlers, if Date.now() - now < 500 then we can assume this is a persisted user setting
var now = Date.now();
navigator.mediaDevices.getUserMedia({audio: true, video: false})
.then(function(stream) {
  console.log('Got stream, time diff :', Date.now() - now);
})
.catch(function(err) {
  console.log('GUM failed with error, time diff: ', Date.now() - now);
}); 
```

这篇[Medium 文章](https://medium.com/the-making-of-appear-in/getusermedia-prompts-ea912fba9e5d)提供了更多详细信息。

希望这可以帮助！

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2013-04-14T14:05:17.503

使用 HTTPS。当用户授予一次权限时，它会被记住，并且 Chrome 不会再次请求该页面的权限，并且您可以立即访问媒体。这不会为您提供再次强制用户使用权限栏的方法，但至少可以确保一旦用户授予权限一次，您就不必继续要求它。

> 如果您的应用程序从 SSL (https://) 运行，则此权限将是持久的。也就是说，用户不必每次都授予/拒绝访问权限。

见：[http ://www.html5rocks.com/en/tutorials/getusermedia/intro/](http://www.html5rocks.com/en/tutorials/getusermedia/intro/)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2016-10-18T12:54:22.917

请注意以下几点。

`1\. Localhost: In Localhost Chrome Browser asking permission only one time and Firefox every pageload.`

`2\. HTTPS: Both Browsers Chrome and Firefox asking permission only one time.`

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-04-14T22:15:02.517

对此的更新答案是，当请求通过 HTTP 时，Chrome（目前在 73 上测试）不再持续提示相机访问。

然而，Firefox 确实如此。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2021-09-21T00:53:30.167

理想情况下，您应该能够在调用之前使用[Permissions API](https://www.w3.org/TR/permissions/)[`getUserMedia()`](https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia)来查明用户是否已经授予或拒绝对相机和麦克风的访问权限，但这在占用户很大一部分的[Safari 上尚不可用。](https://developer.mozilla.org/en-US/docs/Web/API/Permissions_API#permissions_interface)`getUserMedia()`以下任何一种情况调用都会报错：

*   用户点击“阻止”并且不允许摄像头/麦克风访问
*   浏览器本身没有访问摄像头或麦克风的系统权限（macOS 常见）
*   另一个像 Zoom 这样的应用程序已经在使用视频流（在 Windows 上很常见）
*   ...和更多

在用户解决问题后，您可能希望在任何这些情况下再次提示权限。

[Philippe Sultan 的](https://stackoverflow.com/a/52701322/6643002)使用答案`getUserMedia()`是在所有浏览器中提示摄像头和麦克风权限的绝佳解决方案。不幸的是，来自浏览器和操作系统的错误`getUserMedia()`非常不一致。Chrome 将出现“NotReadableError”和“NotAllowedError”，而 Firefox 出现“NotFoundError”或“NotAllowedError”。Firefox 是唯一带有任何类型[错误文档](https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia#exceptions)的浏览器。

您可以使用该[`mic-check`](https://github.com/gtechnologies/mic-check)软件包来请求摄像头和麦克风的权限。它将检查浏览器/操作系统以将所有错误分组到更多用户可操作的错误类别中，例如 UserPermissionDenied、SystemPermissionDenied 和 CouldNotStartVideoSource。

`npm i mic-check`使用或安装它`yarn add mic-check`。

将其与以下代码一起使用：

```
import {
  MediaPermissionsError
  MediaPermissionsErrorType,
  requestMediaPermissions
} from 'mic-check';

requestMediaPermissions()
    .then(() => {
        // can successfully access camera and microphone streams
        // DO SOMETHING HERE
    })
    .catch((err: MediaPermissionsError) => {
        const { type, name, message } = err;
        if (type === MediaPermissionsErrorType.SystemPermissionDenied) {
            // browser does not have permission to access camera or microphone
        } else if (type === MediaPermissionsErrorType.UserPermissionDenied) {
            // user didn't allow app to access camera or microphone
        } else if (type === MediaPermissionsErrorType.CouldNotStartVideoSource) {
            // camera is in use by another application (Zoom, Skype) or browser tab (Google Meet, Messenger Video)
            // (mostly Windows specific problem)
        } else {
            // not all error types are handled by this library
        }
    }); 
```

希望这可以帮助！[您还可以在此处](https://medium.com/joinglimpse/how-to-build-beautiful-camera-microphone-permission-checking-for-websites-e6a08415fa76)了解有关该问题的更多信息。

# c# - 禁用命令提示符 c# 空项目

> ID：15993582
> 
> 赞同：0
> 
> 时间：2013-04-13T22:21:52.707
> 
> 标签：c#, command-prompt

我正在使用 Visual Studio 制作一个简单的文本编辑器表单程序。我使用了项目类型“empty”，当程序运行时，命令提示符与表单对象一起出现。

我怎样才能阻止这个 system32\cmd.exe shell 启动？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T22:26:36.883

在选择项目类型时，您不应该使用控制台应用程序，而是根据您要使用的 GUI 技术选择合适的类型。

您可以执行以下操作，具体取决于 Visual Studio 的版本（我目前没有打开它）：

1) 转到项目设置 -> 常规设置
2) 将应用程序类型更改为 Windows 应用程序

# python - Python - 识别列表中的负数

> ID：15993583
> 
> 赞同：3
> 
> 时间：2013-04-13T22:21:59.510
> 
> 标签：python, list, count, identify

我需要帮助做一个程序，它应该接收十个数字并返回我输入的负整数的数量。

例子：

如果我输入：

```
1,2,-3,3,-7,5,4,-1,4,5 
```

该程序应该返回我`3`。

我该怎么做？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2013-04-13T22:24:24.380

分解你的问题。你能找出一种方法来检查一个数字是否为负吗？

```
if number < 0:
    ... 
```

现在，我们有很多数字，所以我们循环它们：

```
for number in numbers:
    if number < 0:
        ... 
```

那么我们想要做什么呢？数一数。所以我们这样做：

```
count = 0
for number in numbers:
    if number < 0:
        count += 1 
```

[更理想的](http://docs.python.org/3.3/library/functions.html#sum)是，这可以很容易地使用[生成器表达式](http://www.youtube.com/watch?v=pShL9DCSIUw)和[内置的](http://docs.python.org/3.3/library/functions.html#sum):[`sum()`](http://docs.python.org/3.3/library/functions.html#sum)

```
>>> numbers = [1, 2, -3, 3, -7, 5, 4, -1, 4, 5]
>>> sum(1 for number in numbers if number < 0)
3 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2013-04-14T00:31:52.080

```
sum(n < 0 for n in nums) 
```

这是最 Pythonic 的方式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-13T22:32:26.240

或者您可以使用[*过滤器*](http://docs.python.org/2/library/functions.html#filter)“过滤”出负面因素。

`total = len(filter(lambda x: x < 0, my_list))`

# javascript - 以编程方式选择远程查看

> ID：15993586
> 
> 赞同：0
> 
> 时间：2013-04-13T22:22:11.083
> 
> 标签：javascript, kendo-ui, kendo-mobile

我正在尝试 Kendo Mobile。到目前为止，我对它印象深刻。我已经阅读了本[教程](http://docs.kendoui.com/tutorials/build-apps-with-kendo-ui-mobile)，并正在根据我的需要对其进行一些修改。

我在标签条中添加了一个附加元素以包含“登录”视图。因为我的登录表单又长又复杂，所以我不想要 index.html 中的实际代码。因此，我将它包含在一个单独的 html 文件中：login.html。

现在，当用户单击选项卡上的登录图标时，GUI 会自动转换到登录表单。都好。

当 GUI 加载时，我正在使用 JS 来检测用户是否登录。如果没有，我希望 GUI 自动加载登录页面。我可以使用剑道的“导航”功能来做到这一点。不幸的是，这将用户从主应用程序页面中带出布局。是否有一个外部 html 页面，当导航到该页面时将包含主应用程序布局？

```
<footer data-role="footer">
    <div data-role="tabstrip" id="defaultTabStrip">
        <a href="#home" data-icon="home">Home</a>        
        <a href="about.html" data-icon="about">Home</a>  
        <a href="#foo" data-icon="action">Foo</a>
        <a href="login.html" data-icon="settings">Home</a>  
    </div> 
</footer> 
```

这会正确加载 login.html 页面，但我周围没有 GUI。我想导航到此内容，但在我的主要布局中。：

```
if ( ! loggedIn ) {
  app.navigate("login.html");
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T00:55:31.887

所以……这很尴尬。

现在，当我使用它时：

```
if ( ! loggedIn ) { 
```

app.navigate("login.html"); }

一切正常。我什么也没做。我稍后再试一次，登录页面在 GUI 布局中正确加载。所以，我想我们可以认为这个问题已经解决了。

# java - java Process, getInputStream, 只读取最新行

> ID：15993591
> 
> 赞同：1
> 
> 时间：2013-04-13T22:22:56.013
> 
> 标签：java, process, bufferedreader

在下面的 while 循环中，我只想从 Process p 的输出中读取最新的行，而忽略在循环休眠时进入缓冲区的任何其他内容。我怎么做？

```
String s;
Runtime r = Runtime.getRuntime();
Process p = r.exec("SomeContinuousProgram");
myInput = new BufferedReader(new InputStreamReader(p.getInputStream()));

while (true){
  if ((s = myInput.readLine()) != null) {
    System.out.println(s);
  }
Thread.sleep(sleep);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T22:35:58.147

您不能“跳到”从该过程写入的最新行。您必须阅读它之前的所有行。

将程序拆分为 2 个线程。主线程将从中读取`BufferedReader`并跟踪最新的行是什么。另一个线程将休眠，然后显示最新的行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T10:14:54.977

```
while (true){
  if ((s = myInput.readLine()) != null) {
    System.out.println(s);
  } 
```

这段代码没有任何意义。如果`readLine()`返回null，则表示流结束，唯一明智的做法是关闭流并退出读取循环。

# javascript - 从模拟端口读取时从 Arduino 串行接收到错误数据

> ID：15993595
> 
> 赞同：0
> 
> 时间：2013-04-13T22:23:18.607
> 
> 标签：javascript, node.js, arduino, analog-digital-converter, node-serialport

也许这只是一派胡言，但它让我发疯。我正在尝试读取 Arduino 中的一个模拟端口，并使用 node.js 通过串行端口将值发送到 JavaScript。当我在 Arduino 控制台中显示数据时，一切正常，但是当我在 Mac 中使用终端时，一些值出现在两行中。

```
460
460
4
60
460 
```

我正在使用的代码是：

阿杜诺：

```
const int analogInPin = A0;
int sensorValue = 0;

void setup() {
  Serial.begin(500000);
}

void loop() {
  sensorValue = analogRead(analogInPin);
  Serial.print(sensorValue);
  delay(200);
} 
```

节点：

```
var com = require('serialport').SerialPort;

var opts = {baudrate: 500000};

var serialPort = new com('/dev/tty.usbmodem641', opts);

serialPort.on('data', function(data) {
  console.log(data.toString());
}); 
```

代码再简单不过了，但仍然无法正常工作。我知道我错过了一些东西，但我看不到它。我测试了不同的波特率，但没有任何效果。请你帮助我好吗？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T02:54:15.587

我认为[Elias Benevedes](https://stackoverflow.com/users/1730405/elias-benevedes)可能试图在他们的回答中提出这一点：现在您的 Arduino 数据根本没有分隔。假设你`sensorValue`总是读为`1`. 在这种情况下，Arduino 的输出将是

```
11111111111111111111111111111111111111111111111111111111111.... 
```

等等; 因为您打印的整数值没有任何分隔符。因此，将其解析为不同数字的方式与数据到达的时间有关。然后继续上面的示例，有时您的值被读取为`1`，有时为`11`，有时为`111`等等，这取决于读取和写入的时间。

开始修复它的方法是在传感器读数输出之间插入一些非数字数据。一个（同样，这可能是[Elias Benevedes](https://stackoverflow.com/users/1730405/elias-benevedes)的想法）是在每个打印的数字之间插入换行符

```
 Serial.println(sensorValue); 
```

另一种方法是在数据之间添加空格

```
 Serial.print(sensorValue);
 Serial.print(" "); 
```

任何一种解决方案都会将您的数字读数彼此分开，这就是您想要的。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-13T22:32:10.780

我也遇到过这种情况。Serial.print() 将数据发送到 arduino。Serial.println() 会将信息从 arduino 发送到计算机串行留言板（或任何您想称呼它的名称。

# ios - 如何在 Xcode 的表格视图底部添加搜索栏？

> ID：15993597
> 
> 赞同：1
> 
> 时间：2013-04-13T22:23:26.163
> 
> 标签：ios, objective-c, uitableview, uisearchbar

我正在开发一个 iOS 应用程序，我想添加一个搜索按钮来启动对表格视图的搜索。搜索时，搜索栏不应与表格单元格一起滚动。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T15:40:18.810

要使搜索栏（或任何视图）“粘”在顶部或底部，`UITableView`有两种方法：

*   将表格的框架调整为视图高度减去栏的高度，然后将栏的框架设置为`{0, 0, CGRectGetWidth(self.tableView.frame), CGRectGetHeight(self.tableView.frame)}`，这会将其静态定位在视图的底部。如果您使用的是 stock `UITableViewController`，则需要做一些额外的工作，因为`self.view`两者`self.tableView`都指向同一个对象。您需要设置一个新`UIView`的`self.view`，然后将其作为表格视图和搜索栏视图的容器。

*   将栏添加为表格的子视图，然后`UIScrollViewDelegate`在您的控制器中实现并使用`scrollViewDidScroll:`（每当用户滚动视图时触发）来更新栏的位置。新职位将类似于：

    ```
    CGRect adjustedFrame = self.searchBarView.frame;
    adjustedFrame.origin.y = self.tableView.contentOffset.y + CGRectGetHeight(self.tableView.frame) - CGRectGetHeight(self.searchBarView.frame);
    self.searchBarView.frame = adjustedFrame; 
    ```

# c# - 我需要在线使用存储文章的 sql 创建数据

> ID：15993602
> 
> 赞同：-4
> 
> 时间：2013-04-13T22:24:15.690
> 
> 标签：c#, sql

我需要上线使用存储文章的sql创建数据库..比如新闻..换句话说，数据库应该有文章的图像和标题以及文章的自动编号ID及其类别ID和文本..我的网站设计已准备就绪，我正在使用 Visual Studio 2010 C# ..我需要每篇文章都有链接，当我按下它时，用它的图像、正文和标题查看它..对不起我的语言..如果有的话可以帮助我提供提示或链接，这会很棒..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T22:39:58.680

您需要阅读[常见问题解答](https://stackoverflow.com/faq)和[如何提问](https://stackoverflow.com/questions/how-to-ask)

关于你的问题。在不知道如何处理数据并将其保存在数据库中的情况下，您如何准备好您的网站？

你做了一个非常笼统的问题，但没有提供任何关于到目前为止你是如何解决问题的信息，或者你正在使用什么技术。

有很多方法可以做你想做的事。我建议您使用[Entity Framework](http://msdn.microsoft.com/en-us/data/ef.aspx)或[NHibernate](http://nhforge.org/)。

然后可能会查看有关如何使用它们实现 CRUD 的示例。

# dart - build.dart 构建后如何运行命令？

> ID：15993603
> 
> 赞同：4
> 
> 时间：2013-04-13T22:24:16.003
> 
> 标签：dart, dart-webui

`build.dart`文件更改时由 Dart 编辑器运行。许多开发人员使用 build.dart 来编译他们的 Web UI 应用程序。Web UI 编译器完成后如何运行其他命令？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-13T22:24:16.003

该`build()`函数返回一个`Future`. 您可以注册一个回调以在 build() 运行后运行。

这是一个例子：

```
import 'package:web_ui/component_build.dart';
import 'dart:io';
import 'dart:async';

void main() {
  var args = new List.from(new Options().arguments);
  args.addAll(['--', '--no-rewrite-urls']);

  Future dwc = build(args, ['web/clock_page.html']);

  dwc
    .then((_) => Process.run('cp', ['packages/browser/dart.js', 'web/out/dart.js']))
    .then((_) => Process.run('cp', ['App.css', 'out']));
} 
```

学到更多：

*   [未来](http://api.dartlang.org/docs/releases/latest/dart_async/Future.html)
*   [过程](http://api.dartlang.org/docs/releases/latest/dart_io/Process.html)

# ios - 如何使用来自 App Delegate 的托管对象上下文实例化恢复的视图控制器？

> ID：15993607
> 
> 赞同：1
> 
> 时间：2013-04-13T22:24:45.267
> 
> 标签：ios, core-data, ios6, restore

# 问题陈述

`applicationWillFinishLaunchingWithOptions`在我的应用程序中，我在我的应用程序委托的方法中实例化了一个托管对象上下文 (moc) 。在正常操作期间，我通过为每个视图控制器设置的自定义 initWithMoc 初始化方法将相同的 moc 传递给层次结构中的所有视图控制器。

一切正常，但现在我正在尝试使用 iOS6 的内置状态恢复功能。

当我进入`viewControllerWithRestorationIdentifierPath`视图控制器中的恢复方法时，我不确定如何从应用程序委托访问新创建的 moc。

## 问题

如何将每个视图控制器的 moc 指向来自应用程序委托的同一个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T06:38:49.320

根据 Apple 的[iOS App Programming Guide: State Preservation and Restoration](http://developer.apple.com/library/ios/#documentation/iphone/conceptual/iphoneosprogrammingguide/StatePreservation/StatePreservation.html)，

> 值得注意的是，如果您为视图控制器指定恢复类，UIKit 不会尝试隐式查找您的视图控制器。

和，

> 如果您选择使用恢复类，则 viewControllerWithRestorationIdentifierPath:coder: 方法的实现应该创建该类的新实例，执行一些最小的初始化，并返回结果对象。

您将能够使用您的旧`initWithMOC:`方法创建子视图控制器的实例，以供*State Preservation and Restoration API*使用。

但是，通过这种方式，您将失去“**它可以正常工作，您需要做的就是在情节提要中指定恢复标识符**”的好处。

有谁知道更好的方法？显而易见的方法是从应用程序委托中检索它，但这确实是一种非首选方式，因此请不要推荐。除了概念层面的所有邪恶之外，从应用程序委托中检索它会扼杀使用可丢弃嵌套上下文的好处。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-10-25T21:34:13.733

一种方法是通过's注册您的`NSPersistentContainer`子类或自己的核心数据堆栈对象（采用 UIStateRestoring 协议），然后在视图控制器子类的恢复方法中对指针进行编码和解码。`UIApplication``registerObjectForStateRestoration`

# java - 如何显示包含多个小数点的结果

> ID：15993608
> 
> 赞同：0
> 
> 时间：2013-04-13T22:24:49.083
> 
> 标签：java

我正在尝试显示结果，但它只是返回 0，即使您计算答案它不是零，但在零之后需要更多小数点

编码 ：

```
 long transferRate = ((len*2) / durationseconds ) ; //amount of data in bytes transferred in 1 second. Currently returning 0 for every result
                System.out.println("transferRate: " + transferRate + " bytes per second"); 
```

是我需要返回许多小数位的答案的部分，我该如何指定？

因为目前它正在显示结果：

```
Time for the ping to be sent and recived of 2 bytes is 365636931 seconds
transferRate: 0 bytes per second
Time for the ping to be sent and recived of 4 bytes is 43375591 seconds
transferRate: 0 bytes per second
Time for the ping to be sent and recived of 8 bytes is 51079641 seconds
transferRate: 0 bytes per second
Time for the ping to be sent and recived of 16 bytes is 54751211 seconds
transferRate: 0 bytes per second
Time for the ping to be sent and recived of 32 bytes is 57195731 seconds
transferRate: 0 bytes per second
Time for the ping to be sent and recived of 64 bytes is 48524461 seconds
transferRate: 0 bytes per second
Time for the ping to be sent and recived of 128 bytes is 51243251 seconds
transferRate: 0 bytes per second 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-13T22:29:14.117

```
long transferRate = ((len*2) / durationseconds ) ; 
```

您不能将小数存储在`long`. 尝试：

```
double transferRate = ((len*2) / (double) durationseconds ) ; 
```

您必须将其中一个操作数转换为 a `double`，否则无论如何您仍将进行整数除法。

例如，`1 / 2`将评估为`0`。然而，`1 / 2.0`会`0.5`。

# ios - CoreData to-many 添加错误

> ID：15993619
> 
> 赞同：6
> 
> 时间：2013-04-13T22:26:02.037
> 
> 标签：ios, core-data, one-to-many

不知道我在这里做错了什么。

School 对 Student 有一对多，Student 有它的逆。 ![在此处输入图像描述](https://i.stack.imgur.com/lIacL.png)

* * *

![在此处输入图像描述](https://i.stack.imgur.com/x9JU6.png)

* * *

一点测试代码如下：

```
@class Student;

@interface School : NSManagedObject

@property (nonatomic, retain) NSString * name;
@property (nonatomic, retain) NSOrderedSet *students;
@end

@interface School (CoreDataGeneratedAccessors)

- (void)insertObject:(Student *)value inStudentsAtIndex:(NSUInteger)idx;
- (void)removeObjectFromStudentsAtIndex:(NSUInteger)idx;
- (void)insertStudents:(NSArray *)value atIndexes:(NSIndexSet *)indexes;
- (void)removeStudentsAtIndexes:(NSIndexSet *)indexes;
- (void)replaceObjectInStudentsAtIndex:(NSUInteger)idx withObject:(Student *)value;
- (void)replaceStudentsAtIndexes:(NSIndexSet *)indexes withStudents:(NSArray *)values;
- (void)addStudentsObject:(Student *)value;
- (void)removeStudentsObject:(Student *)value;
- (void)addStudents:(NSOrderedSet *)values;
- (void)removeStudents:(NSOrderedSet *)values;
@end

// Meanwhile, elsewhere...
-(void)go {
   AppDelegate *app = (AppDelegate *)[[UIApplication sharedApplication] delegate];
   NSManagedObjectContext *context = [app managedObjectContext];

   School *school = (School *)[NSEntityDescription insertNewObjectForEntityForName:@"School" inManagedObjectContext:context];
   [school setName:@"Stanford"];

   Student *student = (Student *)[NSEntityDescription insertNewObjectForEntityForName:@"Student" inManagedObjectContext:context];
   [student setName:@"Eric"];

   //[school addStudentsObject:student];

   NSMutableSet *students = [school mutableSetValueForKey:@"students"];
   [students addObject:student];

   NSError *__autoreleasing error;
   BOOL success = [context save:&error];

   if (!success) {
      @throw [NSException exceptionWithName:NSGenericException
                                     reason:[error description]
                                   userInfo:nil];
   }
} 
```

* * *

使用注释`addStudentsObject:`失败：

```
2013-04-13 16:22:58.648 CDTMTest[2098:c07] *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '*** -[NSSet intersectsSet:]: set argument is not an NSSet'
*** First throw call stack:
(0x1fa2012 0x13dfe7e 0x2030a4a 0xb85ec6 0xb087f9 0xb85d33 0x11aa638 0x7ee2069 0x2b4d 0xacd5b3 0x1f61376 0x1f60e06 0x1f48a82 0x1f47f44 0x1f47e1b 0x1efc7e3 0x1efc668 0x13ffc 0x1bdd 0x1b05)
libc++abi.dylib: terminate called throwing an exception 
```

* * *

使用`mutableSetValueForKey:`失败

```
2013-04-13 16:07:05.111 CDTMTest[2012:c07] *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: 'NSManagedObjects of entity 'School' do not support -mutableSetValueForKey: for the property 'students''
*** First throw call stack:
(0x1fa3012 0x13e0e7e 0x11370da 0x3af3 0xace5b3 0x1f62376 0x1f61e06 0x1f49a82 0x1f48f44 0x1f48e1b 0x1efd7e3 0x1efd668 0x14ffc 0x2b7d 0x2aa5)
libc++abi.dylib: terminate called throwing an exception 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-14T05:08:56.893

您可能想尝试这个添加到集合中：

```
mutableOrderedSetValueForKey: 
```

当您选择要订购的多对多关系时。但我相信以另一种方式设置关系会更容易：

```
student.school = school; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-14T01:32:34.877

我有一个类似的问题。我在某处读到，对多关系的基本核心数据实现并不总是正常工作。它与只接受 nsset 和生成的 setter 没有正确地将传入参数转换为 nsset 的关系有关。要修复它，请尝试使用以下内容覆盖 addStudentsObject: 方法：

```
static NSString *const kItemsKey = @"students";

- (void)addStudentsObject:(Student *)value {
   NSMutableSet* tempSet = [NSMutableSet setWithSet:self.students];
   NSSet* newObject = [NSSet setWithObject:value];
   [self willChangeValueForKey:kItemsKey withSetMutation:NSKeyValueUnionSetMutation usingObjects:newObject];
   [tempSet addObject:value];
   self.students = tempSet;
   [self didChangeValueForKey:kItemsKey withSetMutation:NSKeyValueUnionSetMutation usingObjects:newObject];
} 
```

# java - 计数器大小的同步（）

> ID：15993621
> 
> 赞同：0
> 
> 时间：2013-04-13T22:26:27.540
> 
> 标签：java, multithreading

打印出来的结果是`-20000000`，证明我不需要同步`size()`方法。但我的理解是我也应该同步`size()`。这里的真实情况是什么？

```
public class Test {
    public static void main(String[] args){
        Counter c = new Counter();
        T1 t1 = new T1(c);
        T1 t2 = new T1(c);
        t1.start();
        t2.start();

        try{
            t1.join();
            t2.join();
        } catch (Throwable t) {

        }

        System.out.println("c=" + c.size());
    }   
}

class T1 extends Thread{
    private Counter c;

    public T1(Counter c){
        this.c = c;
    }
    public void run(){
        for(int i=0; i<10000000; i++){
            c.decrement();
        }
    }
}

class Counter {
    private int c = 0;

    public synchronized void increment() {
        c++;
    }
    public synchronized void decrement() {
        c--;
    }
    public int size() {
        return c;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T22:38:47.373

It does work in your example, because after `t1.join()` and `t2.join()`, any changes made in t1 and t2 are visible to the main thread.

quoting [http://docs.oracle.com/javase/specs/jls/se7/html/jls-17.html#jls-17.4.4](http://docs.oracle.com/javase/specs/jls/se7/html/jls-17.html#jls-17.4.4)

> The final action in a thread T1 synchronizes-with any action in another thread T2 that detects that T1 has terminated.
> 
> T2 may accomplish this by calling T1.isAlive() or T1.join().

Basically, when a thread starts, it should see all prior changes; after a thread finishes, what it has changed should be visible to others. If thread A starts B, and thread C joins thread B

```
 A         B        C
    |
    w1
    |
 start B --> o
    .        |
    .        |
    .        r1       .
             w2       .
             |        .       
             |        |
             o -->  join B
                      |
                      r2 
```

It's guaranteed that r1 sees w1, r2 sees w2.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T22:37:17.487

it will be good if you write

```
public int  synchronized size() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-13T22:32:27.910

> 证明我不需要同步size()方法

实际上，它只是证明你的计数器*有时**可以*工作。应该同步，因为基本上，它访问的字段可以同时缓存在多个寄存器中，并且没有任何迹象表明该字段在线程之间共享，多个线程可以在同一字段的纯本地副本上工作，而无需同步回到主内存。*`size()`*

 *运行它时看不到任何问题的事实只是证明以这种风格编写并发代码是一个坏主意。*

# ruby-on-rails - rspec 文件缺少结尾，但在我拥有它时会引发错误

> ID：15993623
> 
> 赞同：0
> 
> 时间：2013-04-13T22:26:36.247
> 
> 标签：ruby-on-rails

我有一个 rspec 文件，看起来它缺少两个“末端”，但是当我把这些末端放在上面时，我的测试会抛出一个错误“意外结束”......这是文件：

```
require File.dirname(__FILE__) + '/../spec_helper'

describe Invoice do

  describe 'creation' do

    before(:each) do
      @invoice = FactoryGirl.build(:invoice)
    end

    it 'is invalid without a user'  do
      invoice = @invoice
      invoice.user = nil
      invoice.should_not be_valid
    end

    it 'is invalid without a client'  do
      invoice = @invoice
      invoice.client = nil
      invoice.should_not be_valid
    end

    it 'is invalid without a public_id'  do
      invoice = @invoice
      invoice.public_id = nil
      invoice.should_not be_valid
    end

    it 'is invalid without a payment_term'  do
      invoice = @invoice
      invoice.payment_term = nil
      invoice.should_not be_valid
    end

    it 'is invalid without an issue_date'  do
      invoice = @invoice
      invoice.issue_date = nil
      invoice.should_not be_valid
    end

    it 'is invalid without a client_invoice_id'  do
      invoice = @invoice
      invoice.client_invoice_id = nil
      invoice.should_not be_valid
    end
  end

  describe 'method has_payment_date?' do

    it "should return true when payment_term is not 'None'"
      @invoice = FactoryGirl.build(:invoice)
      @invoice.payment_term = "Net 15"
      @invoice.has_payment_date?.should == true
    end

    it "should return false when payment_term is 'None'"
      @invoice = FactoryGirl.build(:invoice)
      @invoice.payment_term = "Net 15"
      @invoice.has_payment_date?.should == true
    end 
```

现在看来上面的代码缺少两个“结束”但是当它像这样时它通过并且当我把结束放回去时抛出一个错误。我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T23:18:33.570

您在最后两个示例中缺少两个“do”，在“Invoice”和“method has_payment_date？”中缺少两个“end”。描述。

# matlab - 使用龙格库塔求解贝塞尔函数

> ID：15993625
> 
> 赞同：0
> 
> 时间：2013-04-13T22:26:38.233
> 
> 标签：matlab, differential-equations, bessel-functions, runge-kutta

我正在为我的一个班级做作业，我应该使用我选择的程序（我选择 Matlab）编写代码，以使用四阶龙格-库塔方法求解贝塞尔函数微分方程。作为参考，贝塞尔函数 DE 是：

x^2*(J_n)''+x*(J_n)'+(x^2-n^2)*J_n=0。

我可以通过以下方式将其分成两个耦合的一阶 DE：

(J_n)'=Z_n 和

(Z_n)'+(1/x)*Z_n+[(x^2-n^2)/x^2]*J_n=0。

在此任务之前，我没有使用 Matlab 或任何其他编程语言的经验。我知道 Matlab 有“ode45”命令，但我应该自己编写代码，而不是依赖于 Matlab 的命令。到目前为止，我一直在研究 Bessel 函数的 n=0 情况，但是当我尝试绘制函数时，我一直收到错误消息。我说的当前错误是：“'double' 类型的输入参数的未定义函数或方法 'J'。” 但我不知道如何解决这个错误，也不知道我的代码是否正确。有人可以告诉我哪里出了问题或者编写此代码的正确方法是什么？

```
h=0.01;             %step size

J_0(1)=1;           %initial condition for J_0

Z_0(1)=1;           %initial condition for Z_0-This value should be zero
                    %but Matlab gives me an error. To fix this, I input
                    %Z_0(1)-1 to use the correct value for Z_0(1).

x(1)=0.001;         %first value of x

dZ(Z_0,J_0)=(-1/x)*(Z_0-1)-J_0;

for i=[1:1:10]

    dZ1=(-1/x)*(Z_0-1)-J_0;
    dJ1=(Z_0(1)-1)*h;

    dZ2=(-1/x)*(Z_0-1+0.5*h)-(J_0+0.5*h*dJ1);
    dJ2=((Z_0(1)-1)+dZ1)*h;

    dZ3=(-1/x)*(Z_0-1+0.5*h)-(J_0+0.5*h*dJ2);
    dJ3=((Z_0(1)-1)+dZ1+dZ2)*h;

    dZ4=(-1/x)*(Z_0-1+h)-(J_0+h*dJ3);
    dJ4=((Z_0(1)-1)+dZ1+dZ2+dZ3)*h;

    J(i+1)=J(i)+(h/6)*(dJ1+2*dJ2+2*dJ3+dJ4);
end

plot(J_0); 
```

提前感谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T22:38:29.880

你的问题是在线：

```
J(i+1)=J(i)+(h/6)*(dJ1+2*dJ2+2*dJ3+dJ4); 
```

在赋值运算符的右侧，您使用`J`以前从未设置过的变量`i`取值 1。对我来说看起来像是一个错字（应该`J_0`改为吗？）

另外，在循环中`i`计算你的`dJ`和`dZ`东西时不要忘记你的索引。`for`

# php - 有时调用 cron 两次或三次

> ID：15993626
> 
> 赞同：0
> 
> 时间：2013-04-13T22:26:42.843
> 
> 标签：php, cron

我不得不做类似“cron Job”之类的事情，因为我无权访问 cPanel

我对这个 cron Job 类的逻辑是，当有人从网站上点击某些东西时，验证时间并调用该类。

...所以....

这是我的 cronJob 类，**我的问题是有时它会调用该类两次或三次**..（*可能两个或多个用户的当前时间相同......*）

```
<?php
class cronJob extends Core {
    public function execute() {
        include("interfaces/cronJob.php");
        $items = $this->query("SELECT `id`, `class`, `interval`, `time` FROM `cron_job`");
        while($item = $this->fetch($items))
        {
            if($this->getTime() > $item['time']) {
                $this->query("UPDATE `cron_job` SET `time` = '".($this->getTime() + $item['interval'])."' WHERE `id` = '".$item['id']."'");
                $this->getLog("cronJob: ".$this->getTime()." Class: ".$item['class']);

                include_once("cron/".$item['class'].".php");
                $job = new $item['class'];
                $job->run();
            } 
        }
    }
}
?> 
```

...和...这是时间函数（我认为没有必要：P）

```
public function getTime() {
    return time() + 305;
} 
```

日志：

```
2013-04-14 12:59:02 - cronJob: 1365890342 Class: updateFiles
2013-04-14 12:59:37 - cronJob: 1365890377 Class: updateTrivia
2013-04-14 01:00:13 - cronJob: 1365890413 Class: updateTrivia
2013-04-14 01:00:49 - cronJob: 1365890449 Class: updateTrivia
2013-04-14 01:01:25 - cronJob: 1365890485 Class: updateTrivia
2013-04-14 01:02:01 - cronJob: 1365890521 Class: updateTrivia
2013-04-14 01:02:37 - cronJob: 1365890557 Class: updateTrivia
2013-04-14 01:03:13 - cronJob: 1365890593 Class: updateTrivia
2013-04-14 01:03:49 - cronJob: 1365890629 Class: updateTrivia
2013-04-14 01:04:25 - cronJob: 1365890665 Class: updateTrivia
2013-04-14 **01:05:01** - cronJob: 1365890701 Class: updateTrivia
2013-04-14 **01:05:01** - cronJob: 1365890701 Class: updateTrivia 
```

桌子：

![在此处输入图像描述](https://i.stack.imgur.com/nyPcf.png)

所以......有没有人有任何想法来解决它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T22:38:22.630

What you need is a feature commonly referred to as an [**exclusive lock**](http://en.wikipedia.org/wiki/Lock_%28computer_science%29).

[Another question on SO](https://stackoverflow.com/questions/325806/best-way-to-obtain-a-lock-in-php) might give you some inspiration on how to implement a lock in your case.
Note, that the mentioned `APC` feature is an optional PHP module not shipped with most standard distributions (and not present on many web hosts)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T22:29:02.363

您可以尝试：

*   使用数据库阻止它：例如，锁定表/启动事务（小心，选项在 MyISAM 引擎上不可用）。
*   写入和读取文件。如果文件的内容 != "x"，则跳过更新。

# java - 字符串中的换行符未传递到文件

> ID：15993631
> 
> 赞同：0
> 
> 时间：2013-04-13T22:27:09.360
> 
> 标签：java, android, string, newline, fileoutputstream

我看到了类似的 issie

[字符串中的换行符未写入文件](https://stackoverflow.com/questions/1133131/newlines-in-string-not-writing-out-to-file)

但它没有帮助我，这是我的代码

```
 try { 
           String StringBudy =String.format(mailBuddy,System.getProperty("line.separator")); 

            FileOutputStream fOut = openFileOutput("My_Sms.txt",
                                                    MODE_WORLD_READABLE);
            OutputStreamWriter osw = new OutputStreamWriter(fOut); 

            osw.write(StringBudy);
            osw.flush();
            osw.close();
        } catch (IOException ioe) {
            ioe.printStackTrace();
    } 
```

任何想法为什么字符串中的换行符不写入文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T13:23:42.693

在创建使用 \n 换行的字符串时，请按照 windows 的要求使用 \r\n 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T23:21:30.247

`String.format()`只会用`%s`换行符替换第一个。

例如：

```
String.format("this%sis%sa%stest", System.getProperty("line.separator")) 
```

将产生

```
this
isatest 
```

`%s`一种解决方案是用换行符替换所有出现的 ：

```
String str = mailBuddy.replace("%s", System.getProperty("line.separator")); 
```

# android - 如何以编程方式阻止手机通过 USB 充电

> ID：15993635
> 
> 赞同：14
> 
> 时间：2013-04-13T22:27:49.487
> 
> 标签：android, battery, setvalue

我试图做尽可能多的研究，但找不到这个相当简单的问题的答案（想在我设置 SDK 和所有东西之前弄清楚这一点）。我正在考虑开发我的第一个应用程序，我想知道`BATTERY_STATUS_CHARGING`from是否`BatteryManager`仅包含一个`get`功能或还包含一个`set`功能。

我不想制作一个应用程序，我可以在其中手动停止手机充电而无需将其从充电器上拔下（通过 USB），所以我想知道这是否真的可行。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-13T23:13:59.823

不，这在无根设备上是不可能的。它与 一起使用`Settings.System`，`ADB_ENABLED`但它`ADB_ENABLED`是一个不能被应用程序更改的安全系统设置。

是的，它可以在有根手机上完成。

需要添加权限`android.permission.WRITE_SECURE_SETTINGS.`

Google Play 上相同类型的应用程序：https: [//play.google.com/store/apps/details?id=com.jim2&hl=en](https://play.google.com/store/apps/details?id=com.jim2&hl=en)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-11-12T15:13:29.673

你可以硬连线它：12欧姆的串行仍然可以让手机被电脑识别，但会慢慢放电。见附图。[![插入 PCB 的 microUSB 电缆。 PCB 显示 VCC 通过 12Ω 电阻连接到电线，而 D-、D+ 和 GND 直接连接到电线。 所有电线都连接到电缆图像中](https://i.stack.imgur.com/sMJXI.jpg)](https://i.stack.imgur.com/sMJXI.jpg)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2017-06-01T22:30:50.940

我知道这个帖子很旧，但无论如何都会为稍后到达这里的人发布我的答案。试试这个： -
`echo 0 > /sys/class/power_supply/batterycharging_enabled/charging_enabled`

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-10-06T05:39:20.823

不幸的是，这是不可能的。Android 只有读取电池数据的 API。ADB_EN​​ABLED 在这种情况下也无济于事，因为它只是通过 USB 启用调试。

电池充电控制在 Android 内核和电池 IC 模块内部。制造商确实会不时更改它，但它不适用于没有 root 权限且没有通过一些棘手的接口控制 IC（集成芯片）模块的应用程序，这实际上对于几乎所有设备来说都是不同的！

最好的情况是，如果我们幸运的话，一个 sysfs 接口可能会帮助做到这一点，但它再次需要 root 并且可能因设备而异。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-04-24T05:44:36.300

连接到 USB 时，使用以下命令停止移动/手持设备的充电：

> adb shell dumpsys 电池组 ac 0; dumpsys电池组usb 0；

# symfony - 在使用 FOSUserBundle 进行用户注册期间添加默认角色

> ID：15993637
> 
> 赞同：25
> 
> 时间：2013-04-13T22:28:06.907
> 
> 标签：symfony, fosuserbundle

版本：Symfony 2.2

当用户在我的网站上注册时，我正在尝试添加默认角色。我使用 FOSUserBundle，我看到当用户注册时，角色字段在数据库中为空。我从这个巨大的捆绑包开始，它不是很容易理解。所以我阅读了所有文档，但我不知道该怎么做。

现在，我创建了一个事件来动态添加这个角色，但它不起作用（我没有错误，但我的数据库仍然是空的）我什至不知道这是做到这一点的好方法吗？

我的活动：

```
use FOS\UserBundle\FOSUserEvents;
use FOS\UserBundle\Event\FormEvent;
use Symfony\Component\DependencyInjection\Container;
use Symfony\Component\EventDispatcher\EventSubscriberInterface;
use Symfony\Component\DependencyInjection\ContainerInterface;

class AddDefaultRoleListener implements EventSubscriberInterface {

  private $container;

  public function __construct(Container $container)
  {
    $this->container = $container;
  }

  /**
   * {@inheritDoc}
   */
  public static function getSubscribedEvents()
  {
    return array(
        FOSUserEvents::REGISTRATION_SUCCESS => 'onAddDefaultRoleSuccess',
    );
  }

  public function onAddDefaultRoleSuccess(FormEvent $event)
  {
    $doctrine = $this->container->get('doctrine');
    $em = $doctrine->getManager();

    $user = $event->getForm()->getData();
    $user->addRole('ROLE_USER');
    //$user->setRoles(array('ROLE_USER'));

    $em->persist($user);
  }
} 
```

如您所见，我创建了一个简单的事件来监听 REGISTRATION_SUCCESS，但似乎没有任何效果。这是我第一次尝试使用事件和服务。所以如果有人有建议，我会接受的:)

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2013-06-22T20:53:06.860

正如 FOSUserBundle 的主要贡献者（[在此处链接的评论中](https://github.com/FriendsOfSymfony/FOSUserBundle/issues/928#issuecomment-11840801)）所指出的那样，推荐的方法是在 REGISTRATION_SUCCESS 事件上注册一个事件侦听器并使用`$event->getForm()->getData()`来访问用户并对其进行修改。遵循这些准则，我创建了以下监听器（有效！）：

```
<?php

// src/Acme/DemoBundle/EventListener/RegistrationListener.php

namespace Acme\DemoBundle\EventListener;

use FOS\UserBundle\FOSUserEvents;
use FOS\UserBundle\Event\FormEvent;
use Symfony\Component\EventDispatcher\EventSubscriberInterface;

/**
 * Listener responsible for adding the default user role at registration
 */
class RegistrationListener implements EventSubscriberInterface
{
    public static function getSubscribedEvents()
    {
        return array(
            FOSUserEvents::REGISTRATION_SUCCESS => 'onRegistrationSuccess',
        );
    }

    public function onRegistrationSuccess(FormEvent $event)
    {
        $rolesArr = array('ROLE_USER');

        /** @var $user \FOS\UserBundle\Model\UserInterface */
        $user = $event->getForm()->getData();
        $user->setRoles($rolesArr);
    }
} 
```

此外，服务需要注册如下：

```
// src/Acme/DemoBundle/Resources/config/services.yml
services:
    demo_user.registration_listener:
        class: Acme\DemoBundle\EventListener\RegistrationListener
        arguments: []
        tags:
            - { name: kernel.event_subscriber } 
```

请注意，在 User 类 __construct() 中添加默认角色可能会出现一些问题，如[this other answer](https://stackoverflow.com/a/12403785/1362009)所示。

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2013-04-14T09:08:03.543

我所做的是覆盖实体构造函数：

这是我的 Entity/User.php 的一部分

```
public function __construct()
{
    parent::__construct();
    // your own logic
    $this->roles = array('ROLE_USER');
} 
```

这是偷懒的方式。如果您想要正确和更好的方法，请参阅@RayOnAir[答案](https://stackoverflow.com/a/17255193/1396839)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-10-31T10:02:00.663

我认为@RayOnAir 解决方案是这样做的正确方法。[但由于FOS 默认角色处理](https://github.com/FriendsOfSymfony/FOSUserBundle/blob/master/Model/User.php#L138)，它不起作用

为了能够在数据库中保留默认角色，需要重写 User::setRoles() 方法（将其添加到您的 User 实体）：

```
/**
 * Overriding Fos User class due to impossible to set default role ROLE_USER 
 * @see User at line 138
 * @link https://github.com/FriendsOfSymfony/FOSUserBundle/blob/master/Model/User.php#L138
 * {@inheritdoc}
 */
public function addRole($role)
{
    $role = strtoupper($role);

    if (!in_array($role, $this->roles, true)) {
        $this->roles[] = $role;
    }

    return $this;
} 
```

测试下：

Symfony [2.3.6](https://github.com/symfony/symfony/commit/d0597156c4c03ceca039f6b7770a47397ba295f0)版，FOSUserBundle [2.0.x-dev](https://github.com/FriendsOfSymfony/FOSUserBundle/commit/0cb03029c7c1c833a11c7bebf30125276f0aa5b9)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-08-14T01:31:40.663

您可以将事件订阅者添加到表单类并使用表单事件“formEvents::POST_SUBMIT”

```
<?php

//src/yourNS/UserBundle/Form/Type/RegistrationFormType.php

use Symfony\Component\Form\FormBuilderInterface;
use FOS\UserBundle\Form\Type\RegistrationFormType as BaseType;
use yourNS\UserBundle\Form\EventListener\AddRoleFieldSubscriber;

class RegistrationFormType extends BaseType
{        
    public function buildForm(FormBuilderInterface $builder, array $options)
    {
        parent::buildForm($builder, $options);

        // add your custom field
        $builder->add('firstName')
            ->add('lastName')
            ->add('address')
            //...
            //...
            ->add('phone');
        $builder->addEventSubscriber(new AddRoleFieldSubscriber());
    }

    public function getName()
    {
        return 'yourNS_user_registration';
    }
} 
```

现在添加角色字段的逻辑位于它自己的订阅者类中

```
<?php
//src/yourNS/UserBundle/Form/EventListener/AddRoleFieldSubscriber.php

namespace yourNS\UserBundle\Form\EventListener;

use Symfony\Component\Form\FormEvent;
use Symfony\Component\Form\FormEvents;
use Symfony\Component\EventDispatcher\EventSubscriberInterface;

class AddRoleFieldSubscriber implements EventSubscriberInterface
{
    public static function getSubscribedEvents()
    {
        return array(FormEvents::POST_SUBMIT => 'setRole');
    }

    public function setRole(FormEvent $event)
    {
        $aRoles = array('ROLE_USER');

        /** @var $user \FOS\UserBundle\Model\UserInterface */
        $user = $event->getForm()->getData();
        $user->setRoles($aRoles);
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-13T23:25:48.527

好的，现在它正在使用它：

```
 public function onAddDefaultRoleSuccess(FilterUserResponseEvent $event)
{
    $doctrine = $this->container->get('doctrine');
    $em = $doctrine->getManager();

    $user = $event->getUser();
    $user->addRole('ROLE_BLOGGER');

    $em->persist($user);
    $em->flush();
} 
```

我改变了我的听众并知道使用**REGISTRATION_COMPLETED**。如果有人有更好的主意，请不要犹豫:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-10-26T14:22:43.000

```
public function __construct()
{
    parent::__construct();
    $this->setRoles(["ROLE_WHATEVER"]);
} 
```

# php - 将变量从 php 页面传递到使用 javascript 生成的另一个 php 页面

> ID：15993639
> 
> 赞同：0
> 
> 时间：2013-04-13T22:28:14.410
> 
> 标签：php, javascript, ajax

我有一个 php 页面（calendar.php），它使用 javascript 加载 php 日历（calendar_start.php）并在页面中心显示日历。

我正在尝试在 calendar_start.php 页面上获取一个变量，但是我无法访问可以从 calendar.php 页面访问的变量。

以下是 calendar.php 上用于生成 canendar_start.php 的脚本之一：

```
<script language="javaScript" type="text/javascript">
function initialCalendar(){
    var hr = new XMLHttpRequest();
    var url = "calendar_start.php";
    var currentTime = new Date();
    var month = currentTime.getMonth() + 1;
    var year = currentTime.getFullYear();
    showmonth = month;
    showyear = year;
    var vars = "showmonth="+showmonth+"&showyear="+showyear;
    hr.open("POST", url, true);
    hr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
    hr.onreadystatechange = function() {
        if(hr.readyState == 4 && hr.status == 200) {
            var return_data = hr.responseText;
            document.getElementById("showCalendar").innerHTML = return_data;
        }
    }
    hr.send(vars);
    document.getElementById("showCalendar").innerHTML = "processing...";
}
</script> 
```

以下是我生成日历的页面 calendar.php 的一部分：

```
<body onLoad="initialCalendar(<?php $_GET['page']; ?>);"> 
```

我无法获取 calendar_start.php 上的变量，非常感谢任何帮助。

最诚挚的问候，瑞恩

编辑：：

这可能会有所帮助，这是我尝试在 calendar_start.php 上显示变量时出现的错误

注意：未定义索引：C:\wamp\www\project\calendar_start.php 中的页面

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T22:37:19.690

Change $_GET['page'] to $_REQUEST['page'].

$_REQUEST combines $_GET and $_POST together (with $_POST taking precedence). That way you won't have to worry about backward comaptibility if you change it in the future.

It is, however, a bad idea to echo ANY of these variable unsanitized to users browser.

EDIT:

Although your main problem is that you forgot the "echo" command in front of the variable.

# mongodb - MongoDB子文档查询以限制元素

> ID：15993640
> 
> 赞同：1
> 
> 时间：2013-04-13T22:28:18.360
> 
> 标签：mongodb, mongoose, aggregation-framework

这是我的文档的样子。

```
{
    ID: "XYZ",
    messages: [
        {
            ID: "AAA",
            text: "this is a message"
        },
        {
            ID: "BBB",
            text: "this is a message"
        },
        {
            ID: "CCC",
            text: "this is a message"
        },
        {
            ID: "DDD",
            text: "this is a message"
        },
        {
            ID: "EEE",
            text: "this is a message"
        },
        {
            ID: "FFF",
            text: "this is a message"
        },
        {
            ID: "GGG",
            text: "this is a message"
        }
    ]
} 
```

我想汇总和获取消息，例如从`CCC`到`FFF`

```
{
    ID: "XYZ",
    messages: [
        {
            ID: "CCC",
            text: "this is a message"
        },
        {
            ID: "DDD",
            text: "this is a message"
        },
        {
            ID: "EEE",
            text: "this is a message"
        },
        {
            ID: "FFF",
            text: "this is a message"
        }

    ]
} 
```

那么这怎么可能呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-05-20T12:06:11.960

这可以通过使用 $slice 运算符来实现。 [查看 $slice 上的 mongodb 文档](http://docs.mongodb.org/manual/reference/operator/projection/slice/)。运行查询以获取文档并将切片运算符与查询一起使用：

```
query.slice('messages', [numOfElementsToSkip, numOfElementsToReturn]); 
```

或更具体到您的要求：

```
query.slice('messages', [2, 4]); // Return 4 elements after skipping 2 
```

# list - 我的测试脚本未在动态 Web 列表控件中找到项目 - 代码中的列表未使用当前信息更新

> ID：15993644
> 
> 赞同：0
> 
> 时间：2013-04-13T22:29:09.863
> 
> 标签：list, dynamic, qtp

我在选择 Web 列表框时在 QTP 中遇到问题，我已经用尽我所知道的方法来解决它。我希望有人可以提供帮助。

一个容器中有5个控件，2个webedit控件和3个weblist控件。它们一起允许输入与客户关联的帐户，并且任何客户都可以有 16 个帐户。任何时候只有五个控件处于活动状态，无论是编辑还是输入帐户信息。输入并接受帐户信息后，它会变为只读表格行，并且在其下方出现一组新控件，用于输入下一个帐户。

在这些控件中输入的信息是帐号、类型、描述、名称和状态。状态值取决于指定，并且列表中的项目根据用户为指定指定的内容而动态变化。在指定指定之前，不会启用状态列表。

经过一些时间试验后，我能够解决一个问题，即第一个帐户的状态列表被 QTP 视为已禁用，即使它已明确启用。然后我可以进入第二个帐户。

我更改了第二个帐户的名称，并尝试在状态列表中选择适当的项目（在数据表中指定）。我从未找到数据表中的规范。我认为这是措辞差异的问题，而且我可能应该预料到这个问题并现在解决它，所以我编写了一个函数来接受三个参数、列表和最多两个搜索项。我的函数搜索传递给它的列表框，并在它收到的搜索项上查找匹配项（全部或部分）。这是我遇到一个重大问题的地方。

我的函数收到的控制列表来自上一次测试迭代，对应于该帐户的指定。这就是为什么我的函数没有找到选择项的原因。屏幕上的列表显示了相应的项目，这表明我正在查看错误的对象。当我使用 select 语句将数据表值直接放入列表时，也会收到“对象已禁用”消息。

活动控件显示在先前输入帐户的只读表示下方。我对 QTP 很陌生，但我也阅读了文档。在这一点上，我唯一的理论是 ATP 没有将正确的列表传递给我的函数……也许它是如何学习的，包括位置，每次都会改变。但是，间谍将屏幕控制识别为我为前一个帐户处理的同一项目，这使我的理论受到怀疑。此外，其他四个不是动态变化的控件也不存在同样的问题。我可以始终如一地将信息放入其中。

对于这个问题的长度，我深表歉意，但我想尽可能彻底和清楚。谁能帮我克服这个障碍。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T14:39:16.293

我今天早上很早就想通了。使用了 4 个不同的列表框，每个列表框都是可见或启用的，具体取决于前一个列表的选择。这就是为什么间谍在我使用它时发现了列出的项目，以及为什么列表中的项目不适合我选择的项目，以及为什么它似乎对 QTP 禁用但对我启用。

我在尝试监视它时选择了相同的名称。很直观，控件都是一样的。我也是一名 Windows 程序员，每次我都会用适当的列表项填充同一个列表，我认为这就是 Web 开发人员正在做的事情。事实并非如此，而且花了一些时间才弄清楚。现在我弄清楚了，一切正常，我回来报告。这是一堂重要的、耗时的课程。

非常感谢您的意见。它仍然很有用，因为我对 QTP 很陌生，我学到的每一件事都是有价值的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T12:42:49.887

它暴露这种行为的原因有很多，所以让我们从简单的事情开始：

*   在对列表框进行操作之前，您是否尝试过`myWebList.Refresh`通话？`Refresh`重新识别对象。
*   您是否在自定义函数中放置了一个断点（红点）。看看那里发生了什么。使用调试查看器，您可以在该功能范围内输入实时命令，例如`msgbox myWebList.exist(0)`或`myWebList.Highlight`
*   你能看到 disabled 属性是如何传播到网页的吗？如果您可以将其“对象间谍”作为 TO 属性，则可以将其添加到 GUI 地图描述中。
*   `Description`一种更复杂的方法是使用 weblist 属性创建一个。如果您可以`disabled`从“Object Spy”中将该属性读取为 RO 属性，则可以将其用作标识符，例如`"attribute/customDisabledProperty:=false"`.
*   如果您无法正确读取 disabled 属性，您可以创建一个描述对象并计算与该页面上的描述匹配的项目数量，`numberOfLists = Browser("my browser").Page("my page").ChildObjects(myDescription).Count`并获取最后一个列表`Set lastList = Browser("my browser").Page("my page").ChildObjects(myDescription)(numberOfLists-1)`

随时通知我们。根据结果​​如何，我们可以找到解决方案的方向。

# sdl - 如何强制 SDL_Init() 失败？

> ID：15993646
> 
> 赞同：4
> 
> 时间：2013-04-13T22:29:27.383
> 
> 标签：sdl

有没有办法可靠地强制`SDL_Init()`在测试用例中使用失败？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-10T07:41:09.853

我认为您可以通过不包含 SDL 动态链接库 (SDL.dll) 来强制它失败。

# google-maps - Google Maps API V3 标记未加载

> ID：15993648
> 
> 赞同：0
> 
> 时间：2013-04-13T22:29:53.540
> 
> 标签：google-maps, google-maps-api-3

我正在尝试为我正在做的网站在谷歌地图上显示一个标记。没有标记代码，地图加载正常并显示正确的位置（没有标记），当我添加标记代码时，地图不再加载。显然我错过了一些简单的东西，但我对 Jquery 不太熟悉。

```
 <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
<style type="text/css">
  html { height: 100% }
  body { height: 100%; margin: 0; padding: 0 }
  #map-canvas { height: 100% }
</style>
<script type="text/javascript"
  src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBWJYTBt3bKUIsQKKsQPSnR1IHNdkAmBQs&sensor=false">
</script>
<script type="text/javascript">
  function initialize() {
    var mapOptions = {
      center: new google.maps.LatLng(53.154662, -1.208357),
      zoom: 15,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    };
    var map = new google.maps.Map(document.getElementById("map-canvas"),
        mapOptions);
  }
var marker = new google.maps.Marker({
  position:(53.154662, -1.208357),
  map: map-canvas,
  title:"Hello World!"
});
  google.maps.event.addDomListener(window, 'load', initialize);

</script> 
```

感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T22:32:39.140

`map`-property 应该是-instance，而`google.maps.Map`position-property 必须是`google.maps.LatLng`：

此外，您必须在地图已经创建并在地图实例可访问的范围内创建标记，例如在`initialize()`.

```
function initialize() {
    var mapOptions = {
      center: new google.maps.LatLng(53.154662, -1.208357),
      zoom: 15,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    };
    var map = new google.maps.Map(document.getElementById("map-canvas"),
        mapOptions);

    var marker = new google.maps.Marker({
      position:new google.maps.LatLng(53.154662, -1.208357),
      map: map,
      title:"Hello World!"
    });
  } 
```

# c - 如何找到elf文件的节头字符串表的偏移量？

> ID：15993652
> 
> 赞同：9
> 
> 时间：2013-04-13T22:30:45.883
> 
> 标签：c, linux, elf

我必须编写一个打印 ELF 文件的 C 程序。我无法确定节标题字符串表的位置。

假设我有一个文件，它给了我以下输出：

读取 -h

```
ELF Header:
  Magic:   7f 45 4c 46 01 01 01 00 00 00 00 00 00 00 00 00 
  Class:                             ELF32
  Data:                              2's complement, little endian
  Version:                           1 (current)
  OS/ABI:                            UNIX - System V
  ABI Version:                       0
  Type:                              REL (Relocatable file)  
  Machine:                           Intel 80386
  Version:                           0x1
  Entry point address:               0x0
  Start of program headers:          0 (bytes into file)
  Start of section headers:          17636 (bytes into file)
  Flags:                             0x0
  Size of this header:               52 (bytes)
  Size of program headers:           0 (bytes)
  Number of program headers:         0
  Size of section headers:           40 (bytes)
  Number of section headers:         23
  Section header string table index: 20 
```

与：

阅读器-S：

```
There are 23 section headers, starting at offset 0x44e4:
Section Headers:
  [Nr] Name              Type            Addr     Off    Size   ES Flg Lk Inf Al
  [ 0]                   NULL            00000000 000000 000000 00      0   0  0
  [ 1] .text             PROGBITS        00000000 000034 000028 00  AX  0   0  4
  [ 2] .rel.text         REL             00000000 0049d0 000018 08     21   1  4
  [ 3] .data             PROGBITS        00000000 00005c 000000 00  WA  0   0  4
  [ 4] .bss              NOBITS          00000000 00005c 000000 00  WA  0   0  4
  [ 5] .rodata           PROGBITS        00000000 00005c 00000a 00   A  0   0  1
  [ 6] .debug_info       PROGBITS        00000000 000066 00008f 00      0   0  1
  [ 7] .rel.debug_info   REL             00000000 0049e8 0000b0 08     21   6  4
  [ 8] .debug_abbrev     PROGBITS        00000000 0000f5 000041 00      0   0  1
  [ 9] .debug_loc        PROGBITS        00000000 000136 000038 00      0   0  1
  [10] .debug_aranges    PROGBITS        00000000 00016e 000020 00      0   0  1
  [11] .rel.debug_arange REL             00000000 004a98 000010 08     21  10  4
  [12] .debug_line       PROGBITS        00000000 00018e 0001b3 00      0   0  1
  [13] .rel.debug_line   REL             00000000 004aa8 000008 08     21  12  4
  [14] .debug_macinfo    PROGBITS        00000000 000341 003fb9 00      0   0  1
  [15] .debug_str        PROGBITS        00000000 0042fa 0000bf 01  MS  0   0  1
  [16] .comment          PROGBITS        00000000 0043b9 00002b 01  MS  0   0  1
  [17] .note.GNU-stack   PROGBITS        00000000 0043e4 000000 00      0   0  1
  [18] .eh_frame         PROGBITS        00000000 0043e4 000038 00   A  0   0  4
  [19] .rel.eh_frame     REL             00000000 004ab0 000008 08     21  18  4
  [20] .shstrtab         STRTAB          00000000 00441c 0000c5 00      0   0  1
  [21] .symtab           SYMTAB          00000000 00487c 000130 10     22  16  4
  [22] .strtab           STRTAB          00000000 0049ac 000021 00      0   0  1
Key to Flags:
  W (write), A (alloc), X (execute), M (merge), S (strings)
  I (info), L (link order), G (group), T (TLS), E (exclude), x (unknown)
  O (extra OS processing required) o (OS specific), p (processor specific) 
```

我将如何计算节标题字符串表的位置？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-13T23:09:09.660

这就是我所做的：

```
#pragma pack(push,1)

typedef struct
{
  uint8  e_ident[16];
  uint16 e_type;
  uint16 e_machine;
  uint32 e_version;
  uint32 e_entry;
  uint32 e_phoff;
  uint32 e_shoff;
  uint32 e_flags;
  uint16 e_ehsize;
  uint16 e_phentsize;
  uint16 e_phnum;
  uint16 e_shentsize;
  uint16 e_shnum;
  uint16 e_shstrndx;
} Elf32Hdr;

typedef struct
{
  uint32 sh_name;
  uint32 sh_type;
  uint32 sh_flags;
  uint32 sh_addr;
  uint32 sh_offset;
  uint32 sh_size;
  uint32 sh_link;
  uint32 sh_info;
  uint32 sh_addralign;
  uint32 sh_entsize;
} Elf32SectHdr;

#pragma pack(pop)

{
  FILE* ElfFile = NULL;
  char* SectNames = NULL;
  Elf32Hdr elfHdr;
  Elf32SectHdr sectHdr;
  uint idx;

  // ...

  // read ELF header
  fread(&elfHdr, 1, sizeof elfHdr, ElfFile);

  // read section name string table
  // first, read its header
  fseek(ElfFile, elfHdr.e_shoff + elfHdr.e_shstrndx * sizeof sectHdr, SEEK_SET);
  fread(&sectHdr, 1, sizeof sectHdr, ElfFile);

  // next, read the section, string data
  SectNames = malloc(sectHdr.sh_size);
  fseek(ElfFile, sectHdr.sh_offset, SEEK_SET);
  fread(SectNames, 1, sectHdr.sh_size, ElfFile);

  // read all section headers
  for (idx = 0; idx < elfHdr.e_shnum; idx++)
  {
    const char* name = "";

    fseek(ElfFile, elfHdr.e_shoff + idx * sizeof sectHdr, SEEK_SET);
    fread(&sectHdr, 1, sizeof sectHdr, ElfFile);

    // print section name
    if (sectHdr.sh_name);
      name = SectNames + sectHdr.sh_name;
    printf("%2u %s\n", idx, name);
  }

  // ...
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-15T16:05:57.023

以下是获取部分名称字符串表的方法：

*   ELF Executable Header (EHDR)的`e_shstrndx`字段指定描述包含节名称的字符串表的节头表条目的索引。
*   EHDR的`e_shentsize`字段指定每个节头表条目的大小（以字节为单位）。
*   EHDR的`e_shoff`字段指定到节头表开头的文件偏移量。

因此，字符串表的标题条目将位于文件偏移量处：

```
header_table_entry_offset = (e_shentsize * e_shstrndx) + e_shoff 
```

根据对象的 ELF 类，此头表条目将是 an`Elf32_Shdr`或 an `Elf64_Shdr`。请注意，头表条目的文件表示形式可能与运行程序的主机上的内存中表示形式不同。

标题条目中的字段将指定`sh_offset`字符串表的起始文件偏移量，而该`sh_size`字段将指定其大小。

进一步阅读：“ [libelf by Example](http://sourceforge.net/projects/elftoolchain/files/Documentation/libelf-by-example/20120308/libelf-by-example.pdf/download) ”教程更深入地介绍了 ELF 可执行文件头和 ELF 节头表。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-13T22:52:19.523

您想要的似乎是 STRTAB，它的偏移量为 0x441c（第 [20] 行）。标头在文件中开始 17636 字节（根据

```
Start of section headers:          17636 (bytes into file) 
```

所以我猜你的字符串表从文件开始的 17636 + 17436 = 35072 字节开始。

我可能完全错了，但这就是我要开始的地方。您知道如何使用`od`或某些此类实用程序来转储文件字节吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-09-19T05:38:34.510

节标题表从`starting point of your file`+开始`e_shoff`。该`elf.h`文件已经有`Elfxx_Shdr`struct 和一个`Elfxx_Ehdr`struct，其中上面的 xx分别代表 32 位`32`或`64`64 位。

您可以使用`e_shentsize`from`Elfxx_Ehdr`获取节标题字符串表索引，然后使用`sh_name`and `sh_offset`from `Elfxx_Shdr`。`sh_name`会给你一个索引`strtab`，如果你添加`sh_offset`. 这将为您提供该部分的全名。`sh_type`通过 using等对类型、标志和其他内容相同`sh_flag`。

我建议您阅读[可执行和可链接格式](https://en.wikipedia.org/wiki/Executable_and_Linkable_Format) 的维基百科文章和[efl.h 文件手册页](https://linux.die.net/man/5/elf)。

# opengl - 为什么带有 Opengl 3.0 上下文的 SFML 会绘制两次？

> ID：15993656
> 
> 赞同：3
> 
> 时间：2013-04-13T22:30:59.837
> 
> 标签：opengl, 3d, sfml, opengl-3

我一直在开发一个使用 SFML 来创建上下文和 OpenGL 3.0 的 3D 应用程序。出于某种原因，当我尝试使用 OpenGL 3.0 创建上下文时，它似乎将图像绘制得稍微变窄并加倍，中间有一个黑条，并且由于某种原因，屏幕似乎被绿色而不是红色清除了。如果我将上下文更改为 2.1，它会正常绘制。最初我在使用现代 OpenGL 代码时遇到了这个问题，但我提供了一个使用固定函数管道的示例，这样问题就更清楚了。

```
#include <SFML/Window.hpp>
#include <SFML/OpenGL.hpp>

int main()
{
    // create the window
    sf::ContextSettings settings;
    settings.depthBits = 24;
    settings.stencilBits = 8;
    settings.antialiasingLevel = 4;
    settings.majorVersion = 3;
    settings.minorVersion = 0;

sf::Window window(sf::VideoMode(800, 600), "OpenGL", sf::Style::Default, settings);

// load resources, initialize the OpenGL states, ...
glClearColor(1.0, 0.0, 0.0, 1.0);

// run the main loop
bool running = true;
while (running)
{
    // handle events
    sf::Event event;
    while (window.pollEvent(event))
    {
        if (event.type == sf::Event::Closed)
        {
            // end the program
            running = false;
        }
    }

    // clear the buffers
    glClear(GL_COLOR_BUFFER_BIT);

    // draw...
    glBegin(GL_TRIANGLES);
    glVertex3f( 0.0, 1.0, 0.0);
    glVertex3f(-1.0,-1.0, 0.0);
    glVertex3f( 1.0,-1.0, 0.0);
    glEnd();

    // end the current frame (internally swaps the front and back buffers)
    window.display();
}

return 0;
} 
```

如果我改变这两行：

```
 settings.majorVersion = 3;
   settings.minorVersion = 0; 
```

对这些：

```
 settings.majorVersion = 2;
   settings.minorVersion = 1; 
```

窗口正常绘制。

以下是正在发生的事情的屏幕截图。 ![OpenGL 2.1 截图](https://i.imgur.com/MR6Tjik.png) ![OpenGL 3.0 截图](https://i.imgur.com/NYtLQr9.png)

第二张图片有点乱，因为我的电脑滞后。它不应该有那种橙色调。

我的设置是：

Ubuntu 12.10 英特尔 i7-3630QM 英特尔高清显卡 4000

来自 glxinfo：OpenGL 渲染器字符串：Mesa DRI Intel(R) Ivybridge Mobile OpenGL 版本字符串：3.0 Mesa 9.0.2 OpenGL 着色语言版本字符串：1.30

来自 lspci：正在使用的内核驱动程序：i915

我认为这可能是一个驱动程序问题，但我已经成功地使用 GLUT 运行了 OpenGL 3.0 程序并且没有弃用的功能，因此它一定是在创建一个有效的 OpenGL 3.0 上下文并正常工作。

我很困惑为什么会这样。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-28T21:08:30.473

SFML 使用兼容性上下文，因为在内部它仍然有一些旧样式的 opengl。您可以使用 glBegin 和 glEnd 等的原因是因为兼容性上下文。我没有你的问题的答案，但它是在一年前提出的。如果您有解决方案，请发布。

# lua - Lua 字符串拆分

> ID：15993657
> 
> 赞同：0
> 
> 时间：2013-04-13T22:31:03.827
> 
> 标签：lua, coronasdk

嗨，我在 JavaScript 中有这个函数：

```
 function blur(data) {
    var trimdata = trim(data);
    var dataSplit = trimdata.split(" ");
    var lastWord = dataSplit.pop();
    var toBlur = dataSplit.join(" ");
 } 
```

这样做是需要一个字符串，例如“Hello my name is bob”，并将返回 toBlur =“Hello my name is”和 lastWord =“bob”

有没有办法我可以在 Lua 中重写它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-13T23:06:51.777

你可以使用 Lua 的模式匹配工具：

```
function blur(data) do
    return string.match(data, "^(.*)[ ][^ ]*$")
end 
```

模式是如何工作的？

```
^      # start matching at the beginning of the string
(      # open a capturing group ... what is matched inside will be returned
  .*   # as many arbitrary characters as possible
)      # end of capturing group
[ ]    # a single literal space (you could omit the square brackets, but I think
       # they increase readability
[^ ]   # match anything BUT literal spaces... as many as possible
$      # marks the end of the input string 
```

所以`[ ][^ ]*$`必须匹配最后一个单词和前面的空格。因此，`(.*)`会返回它面前的一切。

为了更直接地翻译你的 JavaScript，首先要注意 Lua 中没有`split`函数。虽然有`table.concat`，它的工作原理类似于`join`. 由于您必须手动进行拆分，您可能会再次使用模式：

```
function blur(data) do
    local words = {}
    for m in string.gmatch("[^ ]+") do
        words[#words+1] = m
    end
    words[#words] = nil     -- pops the last word
    return table.concat(words, " ")
end 
```

`gmatch`不会立即为您提供表格，而是提供所有匹配项的迭代器。因此，您将它们添加到您自己的临时表中，然后调用`concat`它。`words[#words+1] = ...`是一个 Lua 习惯用法，用于将元素附加到数组的末尾。

# java - 解析 HTML 网页

> ID：15993660
> 
> 赞同：1
> 
> 时间：2013-04-13T22:31:11.793
> 
> 标签：java, html-parsing, jsoup

我使用 JSoup 解析来自该网站的数据：

```
http://www.skore.com/en/soccer/england/premier-league/results/all/ 
```

我得到球队的名字和结果，我还需要得到得分手的名字（它在结果下）。

我正在尝试但遇到了麻烦，因为它不在 HTML 中。

可能吗？如果是怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-13T23:46:32.093

得分者信息是在 AJAX 请求之后获取的（当您单击得分链接时会发生该请求）。您必须提出这样的请求并解析结果。

例如，以第一场比赛（曼联 1x2 曼城）为例，它的标签是：

```
<a data-y="r1-1229442" data-v="england-premierleague-manchesterunited-manchestercity-13april2013" style="cursor: pointer;">1 - 2</a> 
```

Take `data-y`，删除前导`r`并发出 get 请求：

```
http://www.skore.com/en/scores/soccer/id/<DATA-Y_HERE>?fmt=html 
```

如：[http](http://www.skore.com/en/scores/soccer/id/1-1229442?fmt=html) ://www.skore.com/en/scores/soccer/id/1-1229442?fmt=html 。然后解析结果。

## 完整的工作示例：

```
import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.nodes.Element;
import org.jsoup.select.Elements;

public class ParseScore {

    public static void main(String[] args) throws Exception {
        Document doc = Jsoup.connect("http://www.skore.com/en/soccer/england/premier-league/results/all/").get();
        System.out.println("title: " + doc.title());

        Elements dls = doc.select("dl");

        for (Element link : dls) {
            String id = link.attr("id");

            /* check if then it is a game <dl> */
            if (id != null && id.length() > 3 && "rid".equals(id.substring(0, 3))) {

                System.out.println("Game: " + link.text());

                String idNoRID = id.replace("rid", "");
                // String idNoRID = "1-1229442";
                String scoreURL = "http://www.skore.com/en/scores/soccer/id/" + idNoRID + "?fmt=html";
                Document docScore = Jsoup.connect(scoreURL).get();

                Elements trs = docScore.select("tr");
                for (Element tr : trs) {
                    Elements spanGoal = tr.select("span.goal");
                    /* only enter if there is a goal */
                    if (spanGoal.size() > 0) {
                        Elements score = tr.select("td.score");
                        String playerName = spanGoal.get(0).text();
                        String currentScore = score.get(0).text();
                        System.out.println("\t\tGOAL: " + currentScore + ": " + playerName);
                    }

                    Elements spanGoalPenalty = tr.select("span.goalpenalty");
                    /* only enter if there is a goal */
                    if (spanGoalPenalty.size() > 0) {
                        Elements score = tr.select("td.score");
                        String playerName = spanGoalPenalty.get(0).text();
                        String currentScore = score.get(0).text();
                        System.out.println("\t\tGOAL: " + currentScore + ": " + playerName + " (penalty)");
                    }

                    Elements spanGoalOwn = tr.select("span.goalown");
                    /* only enter if there is a goal */
                    if (spanGoalOwn.size() > 0) {
                        Elements score = tr.select("td.score");
                        String playerName = spanGoalOwn.get(0).text();
                        String currentScore = score.get(0).text();
                        System.out.println("\t\tGOAL: " + currentScore + ": " + playerName + " (own goal)");
                    }
                }
            }
        }
    }
} 
```

**输出：**

```
title: Skore : Premier League, England - Soccer Results (All)
Game: F T Arsenal 3 - 1 Norwich
        GOAL: 0 - 1: Michael Turner
        GOAL: 1 - 1: Mikel Arteta (penalty)
        GOAL: 2 - 1: Sébastien Bassong (own goal)
        GOAL: 3 - 1: Lukas Podolski
Game: F T Aston Villa 1 - 1 Fulham
        GOAL: 1 - 0: Charles N´Zogbia
        GOAL: 1 - 1: Fabian Delph (own goal)
Game: F T Everton 2 - 0 Queens Park Rangers
        GOAL: 1 - 0: Darron Gibson
        GOAL: 2 - 0: Victor Anichebe
Game: F T Reading 0 - 0 Liverpool
Game: F T Southampton 1 - 1 West Ham
        GOAL: 1 - 0: Gaston Ramirez
        GOAL: 1 - 1: Andrew Carroll
Game: F T Manchester United 1 - 2 Manchester City
        GOAL: 0 - 1: James Milner
... 
```

使用了 JSoup 1.7.1。如果使用 Maven，请将其添加到您的`pom.xml`：

```
<dependency>
    <groupId>org.jsoup</groupId>
    <artifactId>jsoup</artifactId>
    <version>1.7.1</version>
</dependency> 
```

# javascript - 将 Data-URL 转换为有效的字节字符串

> ID：15993661
> 
> 赞同：3
> 
> 时间：2013-04-13T22:31:15.930
> 
> 标签：javascript, binary, blob, data-url

我试图允许用户保存已渲染到画布的图像。可能有多个图像，我希望用户能够一次下载所有图像作为单个 tar 文件。我正在尝试编写代码来生成这个 tar 文件。我已经完成了大部分工作，但是当最后将 tar 文件下载到我的计算机时，我发现构成 png 文件的一些二进制数据已损坏。以下是相关代码：

```
var canvBuffer = $('<canvas>').attr('width', canvasWidth).attr('height', canvasHeight);
var ctxBuffer = canvBuffer[0].getContext('2d');

imgData.data.set(renderedFrames[0]);
ctxBuffer.putImageData(imgData,0,0);

var strURI = canvBuffer[0].toDataURL();
var byteString = atob(decodeURIComponent(strURI.substring(strURI.indexOf(',')+1)));

toTar([byteString]);

function toTar(files /* array of blobs to convert */){
        var tar = '';

        for (var i = 0, f = false, chkSumString, totalChkSum, out; i < files.length; i++) {

            f = files[i];
            chkSumString = '';

            var content  = f;

            var name = 'p1.png'.padRight('\0', 100);
            var mode = '0000664'.padRight('\0', 8);
            var uid = (1000).toString(8).padLeft('0', 7).padRight('\0',8);
            var gid = (1000).toString(8).padLeft('0', 7).padRight('\0',8);
            var size = (f.length).toString(8).padLeft('0', 11).padRight('\0',12);

            var mtime = '12123623701'.padRight('\0', 12); // modification time
            var chksum = '        '; // enter all spaces to calculate chksum
            var typeflag = '0';
            var linkname = ''.padRight('\0',100);
            var ustar = 'ustar  \0';
            var uname = 'chris'.padRight('\0', 32);
            var gname = 'chris'.padRight('\0', 32);

            // Construct header with spaces filling in for chksum value
            chkSumString = (name + mode + uid + gid + size + mtime + chksum + typeflag + linkname + ustar + uname + gname).padRight('\0', 512);

            // Calculate chksum for header
            totalChkSum = 0;
            for (var i = 0, ch; i < chkSumString.length; i++){
                ch =  chkSumString.charCodeAt(i);
                totalChkSum += ch;
            }

            // reconstruct header plus content with chksum inserted
            chksum = (totalChkSum).toString(8).padLeft('0', 6) + '\0 ';
            out = (name + mode + uid + gid + size + mtime + chksum + typeflag + linkname + ustar + uname + gname).padRight('\0', 512);
            out += content.padRight('\0', (512 + Math.floor(content.length/512) * 512)); // pad out to a multiple of 512
            out += ''.padRight('\0', 1024); // two 512 blocks to terminate the file
            tar += out;
        }

        var b = new Blob([tar], {'type': 'application/tar'});
        window.location.href =  window.URL.createObjectURL(b);

    } 
```

我将先前渲染的帧放在未渲染的画布上，并使用 canvases toDataURL() 方法对带有 Base64 编码的帧的编码 png 版本。接下来，我使用 atob 将其转换为字节字符串，以便可以将其附加到我正在生成的 tar 文件的内容中。

当我在十六进制编辑器中查看文件时，我的 tar 标头是正确的，但 png 的内容并不完全正确。ASCII 内容看起来很正常，但二进制数据是加扰的。

提供的任何帮助将不胜感激。谢谢。

附言

我附上了我看过的相关帖子的链接。他们很有帮助，但我还没有看到任何可以完全解决我的问题的东西。谢谢。

[将 Data URI 转换为 File，然后附加到 FormData](https://stackoverflow.com/questions/4998908/convert-data-uri-to-file-then-append-to-formdata)，并将[Data URI 转换为 Object URL，在 chrome/ff 中使用 createObjectURL](https://stackoverflow.com/questions/9388412/data-uri-to-object-url-with-createobjecturl-in-chrome-ff)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T23:23:56.650

好的，我已经解决了这个问题。问题在于 toTar 末尾的 Blob 构造函数。向它传递一个字符串会导致 blob 将我的数据视为 UTF-8 而不是二进制，我需要将它传递给 arrayBuffer 以获得无符号整数数组。以下是我的解决方案

```
 var byteArray = new Uint8Array(tar.length);
  for (var b = 0; b < tar.length; b++) {
       byteArray[b] = tar.charCodeAt(b);
  }

  var b = new Blob([byteArray.buffer], {'type': 'application/tar'});
  window.location.href =  window.URL.createObjectURL(b); 
```

我应该重写 toTar 以在 Uint8Array 中构建文件并消除最后转换的需要，但这充分回答了我的问题，并希望对其他人有所帮助。谢谢。

# iphone - 展开单元格以显示 nib 文件视图

> ID：15993662
> 
> 赞同：0
> 
> 时间：2013-04-13T22:31:17.937
> 
> 标签：iphone, ios

![伊姆古尔](https://i.imgur.com/2PQGVWV.jpg)

我想在选择时展开单元格以显示如上图所示的一行按钮。我有一个`xib`文件显示一个 320 宽 x 140 高的单元格。我已经把它分类了`UITableViewCell`。此外，我还有另一个`xib`文件，其中包含上图中以蓝色墨水显示的按钮行。

我可以使用[一个非常聪明的人的](https://stackoverflow.com/questions/7588066/loading-custom-uiview-from-nib-all-subviews-contained-in-nib-are-nil/7589220#7589220)`initWithCoder`答案来加载按钮行！

但是，它会覆盖 MyCustomCell 中的所有其他视图。

如何在单元格展开时加载 xib，使其位于 140pt 高单元格的下半部分？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T05:10:01.783

我不确定你的两个 xib 文件中有什么，但我的做法是为较短的单元格设置一个 xib 文件，为较高的单元格设置一个 xib 文件（其中包含您在绘图中显示的所有内容）。我是这样做的，上面提到了两个 xib 文件：

```
#import "TableController.h"
#import "ShortCell.h"
#import "TallCell.h"

@interface TableController ()
@property (strong,nonatomic) NSArray *theData;
@property (strong,nonatomic) NSIndexPath *selectedPath;
@end

@implementation TableController 

- (void)viewDidLoad {
    [super viewDidLoad];
    [self.tableView registerNib:[UINib nibWithNibName:@"ShortCell" bundle:nil] forCellReuseIdentifier:@"ShortCell"];
    [self.tableView registerNib:[UINib nibWithNibName:@"TallCell" bundle:nil] forCellReuseIdentifier:@"TallCell"];
    self.theData = @[@"One",@"Two",@"Three",@"Four",@"Five",@"Six",@"Seven",@"Eight",@"Nine"];
    [self.tableView reloadData];
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {
    return self.theData.count;
}

-(CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath {
    if ([indexPath isEqual:self.selectedPath]) {
        return 88;
    }else{
        return 44;
    }
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

    if (! [self.selectedPath isEqual:indexPath]) {
        NSLog(@"returning short");
        ShortCell *cell = [tableView dequeueReusableCellWithIdentifier:@"ShortCell" forIndexPath:indexPath];
        cell.label.text = self.theData[indexPath.row];
        return cell;
    }else{
        NSLog(@"returning long");
        TallCell *cell = [tableView dequeueReusableCellWithIdentifier:@"TallCell" forIndexPath:indexPath];
        cell.label.text = self.theData[indexPath.row];
        return cell;
    }

}

#pragma mark - Table view delegate

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath{
    if ([self.selectedPath isEqual:indexPath]) {
        self.selectedPath = nil;
        [self.tableView reloadRowsAtIndexPaths:@[indexPath] withRowAnimation:UITableViewRowAnimationAutomatic];
        return;
    }

    NSIndexPath *lastSelectedPath = self.selectedPath;
    self.selectedPath = indexPath;
    if (lastSelectedPath != nil) {
         [self.tableView reloadRowsAtIndexPaths:@[indexPath,lastSelectedPath] withRowAnimation:UITableViewRowAnimationAutomatic];
    }else{
        [self.tableView reloadRowsAtIndexPaths:@[indexPath] withRowAnimation:UITableViewRowAnimationAutomatic];
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T03:58:42.600

在做了更多的研究之后，我发现了一种不同的方法来做一些你想做的事情，比如只使用一个细胞。在此方法中，您只有较高的单元格，但返回的高度只能让您看到单元格的上半部分，除非它被选中。你必须在你的细胞设计中做两件事来完成这项工作。首先在 IB 中选择“剪辑子视图”框，这样按钮就不会显示在它们的视图（单元格）之外。其次，进行约束，使按钮全部相互垂直排列，并为其中一个在单元格顶部的 UI 元素之一提供垂直间距约束。确保没有任何按钮对单元格底部有约束。通过这样做，按钮将与顶部元素保持固定距离（与单元格顶部应该有固定空间），当单元格较短时，这将导致它们被隐藏。要动画高度变化，您所要做的就是在表格视图上调用 beginUpdates 和 endUpdates。

```
#import "TableController.h"
#import "TallCell.h"

@interface TableController ()
@property (strong,nonatomic) NSArray *theData;
@property (strong,nonatomic) NSIndexPath *selectedPath;
@end

@implementation TableController 

- (void)viewDidLoad {
    [super viewDidLoad];
    [self.tableView registerNib:[UINib nibWithNibName:@"TallCell" bundle:nil] forCellReuseIdentifier:@"TallCell"];
    self.theData = @[@"One",@"Two",@"Three",@"Four",@"Five",@"Six",@"Seven",@"Eight",@"Nine"];
    [self.tableView reloadData];
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {
    return self.theData.count;
}

-(CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath {
    if ([indexPath isEqual:self.selectedPath]) {
        return 88;
    }else{
        return 44;
    }
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

    TallCell *cell = [tableView dequeueReusableCellWithIdentifier:@"TallCell" forIndexPath:indexPath];
    cell.label.text = self.theData[indexPath.row];
    return cell;
}

#pragma mark - Table view delegate

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {

    if ([self.selectedPath isEqual:indexPath]) {
        self.selectedPath = nil;
    }else{
        self.selectedPath = indexPath;
    }

    [tableView beginUpdates];
    [tableView endUpdates];
} 
```

我认为，当您选择第一个单元格时，这会为您提供所需的动画，但是如果您随后选择当前所选单元格下方的单元格，则会得到一些不同的动画。我不知道有什么办法。

# jquery - 加载后删除并替换 img

> ID：15993664
> 
> 赞同：-1
> 
> 时间：2013-04-13T22:31:46.070
> 
> 标签：jquery, css

我试图弄清楚是否有一种方法可以从 DOM 中删除元素，对其进行处理，然后在加载后将其重新插入完全相同的位置。例如，如果我有一个图像，我将如何隐藏它，使用 jQuery 重新调整它的大小，然后以一种看起来像我新指定的大小加载的方式使其可见？显然，这对于 CSS 是可能的，但是如果我试图将图像重新调整为相对于其他元素的大小，那么 Javascript 实际上是有用的。

过去我使用 CSS 解决了这个问题：

```
visibility: hidden; 
```

但是，如果使用 jQuery 来处理对象的空间维度，这并不能解决加载问题。

具体来说，我想知道如何将元素重新插入到与之前相同的位置（与 DOM 相关）。jQuery 的 append 方法只将元素附加到其父元素的末尾。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T22:39:58.540

To answer the "specifically i want to know" part: You can use [`Node.insertBefore`](https://developer.mozilla.org/en-US/docs/DOM/Node.insertBefore) to place an element in the correct position. (Note that jQuery is not necessary for this operation). This of course means, you have to know where it was (after which element), for which you can play with `Node.previousSibling`.

# android - 在 viewpager 中替换片段

> ID：15993665
> 
> 赞同：0
> 
> 时间：2013-04-13T22:31:52.833
> 
> 标签：android, android-fragments, android-viewpager

我目前在将 ViewPager 中的某个片段替换为另一个片段时遇到问题。喜欢替换的片段 id 是我的“部门”，它有一个 Imagebutton id，喜欢用来开始替换。我尝试应用其他类似问题的一些建议（其中大部分是旧的并且在允许嵌套片段的新 api 版本之前）并且没有成功。使用嵌套片段会更容易吗？我是 android 应用程序开发的新手，所以任何帮助都会很棒。提前致谢。

这是我的 FragmentAcitivty

```
 public class ViewPagerStyle extends FragmentActivity {
    private ViewPager mViewPager;
    private ViewPagerAdapter adapter;
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        setUpView();
        setTab();
    }
    private void setUpView(){       
     mViewPager = (ViewPager) findViewById(R.id.viewPager);
     adapter = new ViewPagerAdapter(getApplicationContext(),getSupportFragmentManager());
     mViewPager.setAdapter(adapter);
     mViewPager.setCurrentItem(0);
    }
    private void setTab(){
            mViewPager.setOnPageChangeListener(new OnPageChangeListener(){

                        @Override
                        public void onPageScrollStateChanged(int position) {}
                        @Override
                        public void onPageScrolled(int arg0, float arg1, int arg2) {}
                        @Override
                        public void onPageSelected(int position) {
                            // TODO Auto-generated method stub
                            switch(position){
                            case 0:
                                findViewById(R.id.first_tab).setVisibility(View.VISIBLE);
                                findViewById(R.id.second_tab).setVisibility(View.INVISIBLE);
                                findViewById(R.id.third_tab).setVisibility(View.INVISIBLE);
                                break;

                            case 1:
                                findViewById(R.id.first_tab).setVisibility(View.INVISIBLE);
                                findViewById(R.id.second_tab).setVisibility(View.VISIBLE);
                                findViewById(R.id.third_tab).setVisibility(View.INVISIBLE);
                                break;

                            case 2:
                                findViewById(R.id.first_tab).setVisibility(View.INVISIBLE);
                                findViewById(R.id.second_tab).setVisibility(View.INVISIBLE);
                                findViewById(R.id.third_tab).setVisibility(View.VISIBLE);
                                break;
                            }
                        }

                    });

    }
} 
```

FragmentPagerAdapter

```
 public class ViewPagerAdapter extends FragmentPagerAdapter {

    private Context _context;

    public ViewPagerAdapter(Context context, FragmentManager fm) {
        super(fm);  

          _context = context;
        }
    @Override
    public Fragment getItem(int position) {
        Fragment f = new Fragment();
        switch(position){
        case 0:
            f=PubView.newInstance(_context);    
            break;
        case 1:
            f=MyView.newInstance(_context); 
            break;
        case 2:
            f=Departments.newInstance(_context);
            break;

        }

        return f;
    }
    @Override
    public int getCount() {
        return 3;
    }

} 
```

带按钮的部门片段

```
 public class Departments extends Fragment {
    public static Fragment newInstance(Context context) {
        Departments f = new Departments();  

        return f;
    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,Bundle savedInstanceState) {
        View root = (View) inflater.inflate(R.layout.activity_departments, null);   

        ImageButton engineeringButton = (ImageButton)root.findViewById(R.id.engineeringButton);
        engineeringButton.setOnClickListener(new View.OnClickListener(){

            @Override
            public void onClick(View v){
                Fragment newFragment = Engineering.newInstance(null);
                FragmentTransaction transaction = getChildFragmentManager().beginTransaction();
                transaction.addToBackStack(null);
                transaction.replace(R.id.viewPager, newFragment).commit();

            }
        });

        return root;
    }

} 
```

另外，这是我的 main.xml 文件，它托管了 viewpager

```
 <?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="@color/purple"
    android:orientation="vertical" >

    <TableLayout
        style="@style/layout_f_w"
        android:stretchColumns="*" >

        <TableRow
            android:id="@+id/tableRow1"
            style="@style/layout_wrap"
            android:background="@color/white" >

            <!-- First Tab -->

            <LinearLayout
                android:id="@+id/first_text"
                style="@style/layout_f_w"
                android:orientation="vertical" >

                <TextView
                    android:id="@+id/textView1"
                    style="@style/text_title"
                    android:text="pubView"
                    android:textColor="@color/purple" />
            </LinearLayout>

            <!-- Second Tab -->

            <LinearLayout
                android:id="@+id/second_text"
                style="@style/layout_f_w"
                android:orientation="vertical" >

                <TextView
                    android:id="@+id/textView1"
                    style="@style/text_title"
                    android:gravity="center"
                    android:text="myView"
                    android:textColor="@color/purple" />
            </LinearLayout>

            <!-- Third Tab -->

            <LinearLayout
                android:id="@+id/third_text"
                style="@style/layout_f_w"
                android:orientation="vertical" >

                <TextView
                    android:id="@+id/textView1"
                    style="@style/text_title"
                    android:text="Dept."
                    android:textColor="@color/purple" />
            </LinearLayout>
        </TableRow>
    </TableLayout>
    <!-- Include Tab Indicator -->

    <include
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        layout="@layout/indicator" />

    <android.support.v4.view.ViewPager
        android:id="@+id/viewPager"
        android:layout_width="fill_parent"
        android:layout_height="450dp" />

    <ImageButton
        android:id="@+id/settingsButton"
        android:layout_width="wrap_content"
        android:layout_height="30dp"
        android:layout_marginLeft="50dp"
        android:background="@drawable/settings_button"
        android:src="@drawable/settings_button" />

</LinearLayout> 
```

我感到困惑的一件事是我不知道将哪个 id 放入 transaction.replace(r.id.viewPager, newfragment) 的第一个参数中...我读过它需要容器的 id 但是当我使用这个我从 logcat 收到运行时错误：

```
04-13 21:41:48.680: E/AndroidRuntime(960): java.lang.IllegalArgumentException: No view found for id 0x7f0a0029 (com.pvcalendar:id/viewPager) for fragment Engineering{4089a730 #0 id=0x7f0a0029} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-30T10:16:43.797

我认为重点是使用片段作为容器。

在您的 ViewPagerAdapter 中：

```
 @Override
    public Fragment getItem(int position) {
        /*
         * IMPORTANT: This is the point. We create a RootFragment acting as
         * a container for other fragments
         */
        if (position == 0)
            return new RootFragment();
        else
            return new StaticFragment();
    } 
```

RootFragment 布局应如下所示：

```
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
  xmlns:tools="http://schemas.android.com/tools"
  android:layout_width="match_parent"
  android:layout_height="match_parent"
  android:id="@+id/root_frame" >
</FrameLayout> 
```

直接用你的第一个“真实”片段填充它：

```
public class RootFragment extends Fragment {

private static final String TAG = "RootFragment";

@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,
        Bundle savedInstanceState) {
    /* Inflate the layout for this fragment */
    View view = inflater.inflate(R.layout.root_fragment, container, false);

    FragmentTransaction transaction = getFragmentManager()
            .beginTransaction();
    /*
     * When this container fragment is created, we fill it with our first
     * "real" fragment
     */
    transaction.replace(R.id.root_frame, new FirstFragment());

    transaction.commit();

    return view;
}
} 
```

最后，您可以替换片段。例如，在您的“真实”片段中，您可以有一个按钮：

```
btn.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {
            FragmentTransaction trans = getFragmentManager()
                    .beginTransaction();
            /*
             * IMPORTANT: We use the "root frame" defined in
             * "root_fragment.xml" as the reference to replace fragment
             */
            trans.replace(R.id.root_frame, new SecondFragment());

            /*
             * IMPORTANT: The following lines allow us to add the fragment
             * to the stack and return to it later, by pressing back
             */
            trans.setTransition(FragmentTransaction.TRANSIT_FRAGMENT_OPEN);
            trans.addToBackStack(null);

            trans.commit();
        }
    }); 
```

我开发了一个显示类似概念的示例应用程序。您可以替换 ViewPager 中的片段，而无需更改为新的 Activity。该代码可用于：

[https://github.com/danilao/fragments-viewpager-example](https://github.com/danilao/fragments-viewpager-example)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T04:49:46.093

我假设您希望`Engineering`片段位于一个全新的页面上，因为您没有在`ViewPagerAdapter`. 如果是这种情况，请在布局中创建一个新`Activity`的 ,`Engineering`片段，`Activity`然后`engineeringButton`单击启动。

问题是您正试图将 Engineering 片段推入 的 View 层次结构中`R.layout.activity_departments`，并且（希望）`ViewPager`那里没有，因此出现错误。

# css - knockout.js 如何绑定动态css

> ID：15993671
> 
> 赞同：1
> 
> 时间：2013-04-13T22:32:31.690
> 
> 标签：css, twitter-bootstrap, knockout.js

致力于学习 bootstrap 和 knockout.js。这更像是一个淘汰赛的问题。

我想填充表的新行（使用 addSeat 函数），如果该新行上的名称字段为空，则将引导程序“错误”类添加到该行。默认为空。输入名称字段后，样式应更改为“成功”。

基本代码取自座位预订示例。这是标记：

```
 <div id="food" class="span10">
<h2>Your seat reservations (<span data-bind="text: seats().length"></span>)</h2>

<table class="table table-condensed table-hover">
    <thead>
     <tr>
        <th>Passenger name</th><th>Meal</th><th>Surcharge</th><th></th>
    </tr></thead>
    <tbody data-bind="foreach: seats">
        <tr data-bind="css: isnameBlank">
            <td><input data-bind="value: name" /></td>
            <td><select data-bind="options: $root.availableMeals, value: meal, optionsText: 'mealName'"></select></td>
            <td data-bind="text: formattedPrice"></td>
            <td><a href="#" data-bind="click: $root.removeSeat"><i class="icon-remove"></i>Remove</a></td>
        </tr>    
    </tbody>
</table>

<button data-bind="click: addSeat, enable: seats().length < 8">Reserve another seat</button>

<h3 data-bind="visible: totalSurcharge() > 0">
    Total surcharge: $<span data-bind="text: totalSurcharge().toFixed(2)"></span>
</h3>
    </div> 
```

这是js文件：

```
 // Class to represent a row in the seat reservations grid
function SeatReservation(name, initialMeal) {
    var self = this;
    self.name = ko.observable(name);
    self.meal = ko.observable(initialMeal);

    self.formattedPrice = ko.computed(function () {
        var price = self.meal().price;
        return price ? "$" + price.toFixed(2) : "None";
    });

    self.isnameBlank = ko.computed(function () {
        var ib = self.name().length;
        console.log(ib);
        return ib == 0 ? "warning" : "success";
    }, self);

}

// Overall viewmodel for this screen, along with initial state
function ReservationsViewModel() {
    var self = this;

    // Non-editable catalog data - would come from the server
    self.availableMeals = [
        { mealName: "Standard (sandwich)", price: 0 },
        { mealName: "Premium (lobster)", price: 34.95 },
        { mealName: "Ultimate (whole zebra)", price: 290 }
    ];

    // Editable data
    self.seats = ko.observableArray([
        new SeatReservation("Steve", self.availableMeals[0]),
        new SeatReservation("Bert", self.availableMeals[0])
    ]);

    // Computed data
    self.totalSurcharge = ko.computed(function () {
        var total = 0;
        for (var i = 0; i < self.seats().length; i++)
            total += self.seats()[i].meal().price;
        return total;
    });

    // Operations
    self.addSeat = function () {
        self.seats.push(new SeatReservation("", self.availableMeals[0]));
    }
    self.removeSeat = function (seat) { self.seats.remove(seat) }
}

ko.applyBindings(new ReservationsViewModel(), document.getElementById('food')); 
```

当我运行它时，控制台会记录正确的长度（ib 变量），但 css 类不会改变。

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T22:41:17.883

你有这条线的地方：

```
var ib = self.name.length; 
```

你应该这样做：

```
var ib = self.name().length; 
```

当我在 Chrome 中测试它时，这似乎工作得很好。这是jsFiddle：

[http://jsfiddle.net/Xfv2g/](http://jsfiddle.net/Xfv2g/)

我唯一可以假设的是，您希望它会随着他们键入而改变。为了做到这一点，您必须`name`通过将`valueUpdate: 'afterkeydown'`修饰符放在[值绑定](http://knockoutjs.com/documentation/value-binding.html)来更改字段绑定的时间。

这是唯一的区别。

[http://jsfiddle.net/Xfv2g/1/](http://jsfiddle.net/Xfv2g/1/)

# ruby - 如何正确处理 Ruby CSV 中的 Unicode CSV 文件？

> ID：15993674
> 
> 赞同：0
> 
> 时间：2013-04-13T22:32:47.933
> 
> 标签：ruby, csv, encoding

我正在尝试处理一些 Google Adwords csv 文件。这些文件以 UNICODE 格式提供。当我使用 Ruby CSV 解析器解析文件时。我无法读取文件。字符显示为 \x00a \x00b 等。

我最终不得不在 OpenOffice 中打开文件并选择 UTF-8 来呈现文件，然后保存它。之后，Ruby CSV 可以处理该文件。我还必须删除 csv 文件中看起来像黑色圆圈中的数字 8 的第一个字符，因为它不是有效的 UTF-8 字符。这个特殊字符是 OpenOffice 中 UNICODE 到 UTF-8 转换的结果。

那么将 csv 文件转换为没有非法字符的 Ruby 友好编码的最佳方法是什么？

要了解我的意思，您可以尝试打开 Ruby CSV 来打开此文件并解析这些行。

[https://github.com/zben/encoding_test/blob/master/encoding_test.csv](https://github.com/zben/encoding_test/blob/master/encoding_test.csv)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T22:38:36.177

[This page](http://www.ruby-forum.com/topic/206554) suggests using `Iconv.iconv` to convert:

```
doc = Iconv.iconv('UTF-8', 'UTF-16', doc) 
```

# c# - 在 WinPhone 7 模拟器中单击超链接按钮会出现错误 - “无法发送，请确保您已设置帐户”

> ID：15993675
> 
> 赞同：1
> 
> 时间：2013-04-13T22:32:49.530
> 
> 标签：c#, .net, windows-phone-7, emulation

我有一个使用 Expression Blend 和 Visual Studio 2012 创建的 Windows Phone 7 的 C# 项目。我有一个带有超链接按钮的关于页面，可将用户带到应用程序的支持网页。当我单击按钮时，我会在模拟器中看到一个屏幕，上面写着：

“无法发送。请确保您已设置帐户。”

这最终会在 VS2012 调试器的 System.Windows.ni.dll 中触发 NULL 参数异常。没有可见的查看异常详细信息选项。我已经三重检查了**NavigateUri**值，我知道它是一个有效的网页。我尝试“ [http://google.com/](http://google.com/) ”只是为了确定，但我仍然收到错误，所以这是一个比 URL 更根本的问题。为什么我会收到此错误，我该如何解决？

**更新**：我正在显示按钮的 XAML 以响应 Den 的回复。我没有手动输入 XAML，我使用了 Property Editor 窗口。我认为问题在于它被视为电子邮件命令，而我尚未设置电子邮件服务。

这是 HyperLink 按钮的 XAML：

```
<HyperlinkButton 
            Grid.Row="3" 
            Content="Technical Support/Feedback Email" 
            Margin="0,0,0,23" 
            HorizontalAlignment="Left" 
            Foreground="{StaticResource PhoneAccentBrush}" 
            FontSize="{StaticResource PhoneFontSizeNormal}" 
            Command="{Binding SendAnEmailCommand}" Width="446" NavigateUri="http://google.com/"/> 
```

但是，**在删除命令绑定后，**我现在从底层**导航**调用超链接按钮触发器中得到一个异常。我收到带有以下错误消息的参数异常：

*System.ArgumentException：仅支持作为片段、以“/”开头或包含“;component/”的相对 URI 导航。参数名称： uri at System.Windows.Navigation.NavigationService.Navigate(Uri source)} System.Exception {System.ArgumentException}*

似乎超链接按钮不适用于外部 URI？这对我来说真的很奇怪。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T23:09:25.187

好像你在声明`HyperlinkButton`. 它应该是这样的：

```
<HyperlinkButton TargetName="_blank" NavigateUri="http://www.microsoft.com" Content="Microsoft"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T14:55:43.937

或者，为什么不尝试将 urikind 属性设置为绝对值？用这个测试并告诉我。

# javascript - 什么是 chrome 对象？

> ID：15993677
> 
> 赞同：13
> 
> 时间：2013-04-13T22:33:03.520
> 
> 标签：javascript, google-chrome

我刚刚在 chrome 中偶然发现了一个名为 chrome 的全局对象，我不知道这个对象是什么，也找不到关于它的任何信息（这与应用程序/扩展的 chrome 对象不同）。这就像 chrome 用来测试新功能的某种对象吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-13T23:01:02.657

鉴于对象的名称，我猜想 if 的目的是作为 Chrome 扩展开发人员的实用程序，即使它公开了可能对不在扩展范围内的常规网站有用的方法。

一些 API 似乎有一个非常狭窄的用途，[`chrome.webstore.install()`](https://developers.google.com/chrome/web-store/docs/inline_installation)例如用于扩展安装。其他方法和属性，例如[`chrome.csi().pageT`](https://developers.google.com/chrome/web-store/docs/inline_installation)获取页面加载后的时间，可能在扩展的上下文之外很有用，但由于没有其他浏览器可能会公开它们，我看不到外部 API 的任何良好用途有预期的上下文。

不幸的是，Chrome 开发者网站今天有点胡思乱想，抛出 HTTP 500，但至少根据谷歌搜索结果，一旦开发者网站活跃并再次启动，您应该能够找到有关`chrome.webstore`和API 的信息。不过似乎与桌面通知有关。`chrome.appNotifications``chrome.appNotifications`

该对象似乎是一个隐藏的宝藏，我无法找到一个像样的列表，描述所有暴露的 API。因此，就目前而言，获取各种 API 信息的最简单方法可能是`chrome`在开发工具中检查对象，然后在谷歌上搜索吸引您眼球的方法。

# ios - 居中 UIView

> ID：15993679
> 
> 赞同：0
> 
> 时间：2013-04-13T22:33:08.980
> 
> 标签：ios, uiviewcontroller

我有一个 UIViewController 子类，它实例化一个 UIView 子类（我们称之为 viewA）。然后，viewA 有时会实例化另一个 UIView，我们称之为 viewB。

我希望 viewB 在视图控制器中居中。

我的问题是，“这样做的（正确）方法是什么？”

TIA

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T22:41:12.453

有很多正确的方法，但也许最好的方法是使用 center-property：

```
[viewB setCenter: viewA.center]; 
```

或者，也许你需要使用..

```
[viewB setCenter: viewA.navigationController.center]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T22:51:32.953

你必须小心，不要在一点点上结束。在非视网膜上，您需要满分，但对于视网膜，您可以在 0.5 上

一种方法是使用`center`然后调整

```
viewB.center = viewA.center;
viewB.frame = CGRectIntegral(viewB.frame); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-13T22:39:38.247

I don't know a shorter way to do it than this one:

```
CGFloat x = CGRectGetMidX(self.view.bounds) - viewBWidth / 2;
CGFloat y = CGRectGetMidY(self.view.bounds) - viewBHeight / 2;

viewB.frame = CGRectMake(x,y,viewBWidth,viewBHeight); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-13T22:40:36.787

```
viewB.frame = [MyClass centeredFrameForSize:desiredSize inRect:viewA.bounds];

+ (CGRect)centeredFrameForSize:(CGSize)size inRect:(CGRect)rect
{
    CGRect frame;
    frame.origin.x = rintf((rect.size.width - size.width)/2) + rect.origin.x;
    frame.origin.y = rintf((rect.size.height - size.height)/2) + rect.origin.y;
    frame.size = size;

    return frame;
} 
```

# html - 自定义字体渲染问题

> ID：15993682
> 
> 赞同：4
> 
> 时间：2013-04-13T22:33:25.573
> 
> 标签：html, css, font-face, custom-font

所以我有时想强调一些这样的词：

```
<h1>I want to <span class="emphasis">emphasize</span> some text.</h1> 
```

同时，我想为 h1 文本使用自定义字体：

```
@font-face
{
    font-family: 'MuseoSlab';
    src: url('https://digital_time_capsules.s3.amazonaws.com/fonts/Museo_Slab_500-webfont.eot');
    src: url('https://digital_time_capsules.s3.amazonaws.com/fonts/Museo_Slab_500-webfont.eot?#iefix') format("embedded-opentype"), url('https://digital_time_capsules.s3.amazonaws.com/fonts/Museo_Slab_500-webfont.svg#MuseoSlab500Regular') format("svg"), url('https://digital_time_capsules.s3.amazonaws.com/fonts/Museo_Slab_500-webfont.woff') format("woff"), url('https://digital_time_capsules.s3.amazonaws.com/fonts/Museo_Slab_500-webfont.ttf') format("truetype");
    font-weight: normal;
    font-style: normal;
} 
```

[这里的例子。](http://jsfiddle.net/PMqX9/)

问题是，Windows 中的 Chrome 与跨度文本重叠：

![镀铬重叠](https://i.stack.imgur.com/fcEQm.png)

Firefox 和 IE 似乎无法顺利呈现字体：

![看起来参差不齐](https://i.stack.imgur.com/uyUkp.png)

Opera 似乎以我想要的方式呈现它：

![在此处输入图像描述](https://i.stack.imgur.com/B5xtJ.png)

谁能告诉我发生了什么，以及如何解决这些问题？

**编辑**：

有时我在 Chrome 中遇到了这个令人震惊的问题；有时我没有。我也安装了最新的 Chrome：

![在此处输入图像描述](https://i.stack.imgur.com/THPKr.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T05:52:48.967

Firefox 和 IE 以它们的方式显示字体的原因是该`h1`元素`font-weight: bold`默认具有，并且您将字体声明为`normal`粗细。这个浏览器所做的可以说是正确的举动：在缺乏粗体字体的情况下，它们在算法上将字母加粗。

为避免这种情况，请添加`h1 { font-weight: normal; }`. 或者，使用字体系列的粗体字。

Chrome 中奇怪的重叠听起来像是特定于安装的问题，因此您应该首先考虑更新或重新安装 Chrome。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-06T14:43:57.720

我曾经在 Chrome 上遇到过完全相同的问题。它似乎与 Chrome 中 SVG 字体的渲染有关。如果您更改字体文件的顺序，`@font-face`使 SVG 位于列表的末尾，问题就会消失。您在 jsfiddle 上的示例在当前版本的 Chrome (29.0.1547.76) 中仍然呈现不正确，因此呈现错误仍然存​​在。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-12T06:32:07.820

希望这对将来的某人有所帮助，但我能够通过遵循以下问题中的解决方案来纠正此问题：[Chrome svg-Font-Rendering breaks Layout](https://stackoverflow.com/questions/13674808/chrome-svg-font-rendering-breaks-layout/14345363)

这成功地修复了不平滑的边缘，而不会破坏布局和/或挤压字体。

# ios - UICollectionView 数据被重新排序

> ID：15993683
> 
> 赞同：1
> 
> 时间：2013-04-13T22:34:15.110
> 
> 标签：ios, uikit, uicollectionview

我正在使用 UICollectionView 和 LXReorderableCollectionViewFlowLayout 的修改版本，并且我最后两个单元格中的数据被混淆了。

每个单元格中显示 2 个单独的图像，下面有一个标签，当我离开 viewController 并返回时，我调用 reloadData。每次调用时，单元格中的图像都会交换。但是，标签保留在同一个地方。

这是我用来绘制有问题的单元格的代码。

```
SettingsTile *setTileD = (SettingsTile *)[collectionView dequeueReusableCellWithReuseIdentifier:@"settingsReuse" forIndexPath:indexPath];

    NSString *songTitle = [colors objectAtIndex:indexPath.row];

    MPMediaQuery *query = [MPMediaQuery songsQuery];
    [query addFilterPredicate:[MPMediaPropertyPredicate predicateWithValue:songTitle forProperty:MPMediaItemPropertyTitle]];
    if ([query items].count > 0)
    {
        MPMediaItemArtwork *art = [[[query items] objectAtIndex:0] valueForProperty:MPMediaItemPropertyArtwork];
        UIImage *im = [art imageWithSize:CGSizeMake(145, 145)];

        setTileD.titleLabel.text = songTitle;
        setTileD.titleLabel.textColor = [UIColor whiteColor];
        UIImageView *imView = [[UIImageView alloc] initWithFrame:CGRectMake(0, 0, 145, 145)];
        imView.image = im;
        [setTileD addSubview:imView];
        [setTileD sendSubviewToBack:imView];
        return setTileD;
    }
    else
    {
        return nil;
    } 
```

应用程序第一次运行时，图像混合在一起，可能是因为 viewDidAppear 在第一次显示 viewController 时也被调用，而当用户返回它时，图像并没有混合在一起。这个过程不断重复。

reloadData 被正常调用（例如 [collectionView reloadData]; ）。

我是 UICollectionView 的新手，它是附带的课程，所以请善待。:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T20:05:05.637

我通过将 UIImageViews 放在 backgroundView 中解决了这个问题，而不是直接将它们添加为子视图。

我只能想象这个问题是由 UICollectionView 的 cellForRowAtIndexPath: 方法在我调用它们时抓取图像的方式引起的，或者是由 LXReorderableCollectionViewFlowLayout 的工作方式引起的。

# html - 内部链接不适用于多页文档

> ID：15993686
> 
> 赞同：0
> 
> 时间：2013-04-13T22:34:37.733
> 
> 标签：html, jquery-mobile

我有一个多页文档，主页链接到其他页面没有问题，但是如果我尝试从页面内容链接到另一个页面，它什么也不做，链接就死了。移动端和桌面端一样。这是整个第 4 页的代码（我试图插入这些链接的页面）我的文档总共有 7 页。第一个问题在第 16 行，我的链接是：

```
<a href="#webdesign"> 
```

但是，即使我有一个名为“webdesign”的页面，这也无济于事

```
<!-- Start of fourth page -->
<script>
$(document).on('click', 'a.webdesign', function () { $.mobile.changePage('#webdesign'); });
</script>    

<div data-role="page" id="services">

<div data-role="header1">
<div align="center"><img src="http://www.magnetikmedia.co.uk/m/images/magnetikmedia_header.png" width="90%"></div>
</div>
<div>
<div align="center"><img src="http://www.magnetikmedia.co.uk/m/images/services_banner.png" width="100%"></div>
</div><!-- /header -->

<div data-role="content">   
<div data-role="collapsible-set">

<div data-role="collapsible" data-collapsed="true">
<h3>Website Design</h3>
<p>We offer a full website design service whether you are looking for a basic, low maintenance site to create your online presence, a responsive site to attract more mobile browsers or an advanced, dynamic e-commerce site to power your business to the next level. We also offer a website content management service so whether you need any information editing or amending your current site or would like a page or two adding then we can do this for you. <a href="#" class="webdesign">Read more about our website design services</a></p>
</div>

<div data-role="collapsible" data-collapsed="true">
<h3>facebook Development</h3>
<p>The most striking part of any facebook business page is the cover image. This, along with your profile, can make or break a facebook page. We design custom cover images perfectly suited to your industry and business to really enable you to stand out and make visitors want to 'like' you! <a href="#facebookdesign">Read more about facebook timeline design</a></p>
</div>

<div data-role="collapsible" data-collapsed="true">
<h3>twitter Design</h3>
<p>We can create custom backgrounds for your Twitter pages that can incorporate your logo, contact details or, in fact, anything you like. This helps you move one step closer to catching the eye of potential customers who will be passing by (and there will be a lot based on the fact there are over 140 million active users!) <a href="#twitterdesign">Read more about twitter design</a></p>
</div>

<div data-role="collapsible" data-collapsed="true">
<h3>Email Marketing</h3>
<p>Our dynamic e-mail campaign service means we can create a custom newsletter, an advert for a special offer or just a courtesy message to your customer base that is professionally designed and can be mailed out to as many customers as you wish. Not only that but it will be fully trackable so you can keep tabs on who has read the email or who has yet to open it. We can even add a secure, online subscription form to your website or facebook page where potential new customers can sign up to your mailing campaigns which are then integrated automatically so they are ready to be included in your next mailout.  <a href="#emailmarketing">Read more about email marketing</a></p>
</div>

<div data-role="collapsible" data-collapsed="true">
<h3>Animation</h3>
<p>From animated email footers to full promotional videos, flash animation can be a useful tool to showcase your product or services to the world in an attractive and fun way. <a href="#animation">Read more about our animation services</a></p>
</div>

</div>
<div align="center"><!-- /content -->

<div id="footer1">
<div id="footer_left">
<div align="center"><a href="http://www.facebook.com/magnetikmedia"><img src="http://www.magnetikmedia.co.uk/m/images/fbook_foot.png" width="30" height="30" style="margin-right:10px;" ></a><a href="http://www.twitter.com/magnetikmedia"><img src="http://www.magnetikmedia.co.uk/m/images/twitter_foot.png" width="30" height="30" style="margin-right:10px;" ></a><a href="http://magnetikmedia.blogspot.co.uk"><img src="http://www.magnetikmedia.co.uk/m/images/blogger_foot.png" width="30" height: "30" style="margin-right:10px;" ></a><a href="http://www.linkedin.com/in/magnetikmedia"><img src="http://www.magnetikmedia.co.uk/m/images/linkedin_foot.png" width="113" height="30" style="margin-right:10px;" ></a></div>
</div>
<div style="clear:both;"></div>
</div>
</div>
  <div align="center"><!-- /footer --> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-02T12:55:12.727

缺少一个关闭 div，添加了该 div 并全部修复。

# c# - 获取 Facebook 用户令牌

> ID：15993691
> 
> 赞同：6
> 
> 时间：2013-04-13T22:35:07.687
> 
> 标签：c#, facebook, token

我正在尝试通过这样做来检索 facebook 用户令牌。我知道它可以在 python 中完成。

```
 public string GetToken(string Username, string Password)
    {
        wb.DownloadData("https://login.facebook.com/login.php?login_attempt=1");
        var data = new NameValueCollection();
        data["email"] = UserName;
        data["pass"] = Password;
        byte[] responsebytes = wb.UploadValues("https://login.facebook.com/login.php?login_attempt=1", "POST", data);
       string responsebody = Encoding.UTF8.GetString(wb.("https://www.facebook.com/dialog/oauth?client_id=282892925078054&redirect_uri=https://www.facebook.com/&response_type=token"));
        Console.WriteLine(responsebody);

        return responsebody;
    } 
```

但它没有返回令牌。我知道这是可以做到的，因为我已经在 python 中看到了这一点。还有一种简单的方法可以从这里获取用户标识吗？

编辑：

这就是它在python中的完成方式：

```
def get_token(self, username, password):
    self.session.get("https://login.facebook.com/login.php?login_attempt=1")
    self.session.post("https://login.facebook.com/login.php?login_attempt=1", data={'email': username, 'pass': password})    
    return self.session.get("https://www.facebook.com/dialog/oauth?client_id=282892925078054&redirect_uri=https://www.facebook.com/&response_type=token").url.split("=")[1].split("&")[0] 
```

* * *

好的，我已经走到了这一步。

```
 //Login to facebook.
        string formUrl = "https://login.facebook.com/login.php?login_attempt=1"; // NOTE: This is the URL the form POSTs to, not the URL of the form (you can find this in the "action" attribute of the HTML's form tag
        string formParams = string.Format("email_address={0}&password={1}", email, pass);
        string cookieHeader;
        HttpWebRequest req = (HttpWebRequest)WebRequest.Create(formUrl);
        req.ContentType = "application/x-www-form-urlencoded";
        req.Method = "POST";
        byte[] bytes = Encoding.ASCII.GetBytes(formParams);
        req.ContentLength = bytes.Length;
        using (Stream os = req.GetRequestStream())
        {
            os.Write(bytes, 0, bytes.Length);
        }
        WebResponse resp = req.GetResponse();
        cookieHeader = resp.Headers["Set-cookie"];
        Console.WriteLine(cookieHeader);
        Console.WriteLine();
        //Get token
        HttpWebRequest webRequest = (HttpWebRequest)WebRequest.Create("https://www.facebook.com/dialog/oauth?client_id=282892925078054&redirect_uri=https://www.facebook.com/&response_type=token");
        webRequest.Headers.Add("Cookie", cookieHeader);
        //webRequest.AllowAutoRedirect = false;
        HttpWebResponse response = (HttpWebResponse)webRequest.GetResponse();
        string redirectUrl = response.Headers.Get("Location");

        Console.WriteLine(redirectUrl); 
```

但它没有给我正确的 URL。我究竟做错了什么？

编辑：我试过 AllowautoRedirect true/false。使用 false 它返回此 URL。 [https://www.facebook.com/login.php?api_key=282892925078054&skip_api_login=1&display=page&cancel_url=https%3A%2F%2Fwww.facebook.com%2F%3Ferror_reason%3Duser_denied%26error%3Daccess_denied%26error_description%3DThe%2Buser% 2Bdenied%2Byour%2Brequest.&fbconnect=1&next=https%3A%2F%2Fwww.facebook.com%2Fdialog%2Fpermissions.request%3F_path%3Dpermissions.request%26app_id%3D282892925078054%26client_id%3D282892925078054%26redirect_uri%3Dhttps%26redirect_uri%3D 252Fwww.facebook.com%252F%26display%3Dpage%26response_type%3Dtoken%26fbconnect%3D1%26from_login%3D1&rcount=1](https://www.facebook.com/login.php?api_key=282892925078054&skip_api_login=1&display=page&cancel_url=https%3A%2F%2Fwww.facebook.com%2F%3Ferror_reason%3Duser_denied%26error%3Daccess_denied%26error_description%3DThe%2Buser%2Bdenied%2Byour%2Brequest.&fbconnect=1&next=https%3A%2F%2Fwww.facebook.com%2Fdialog%2Fpermissions.request%3F_path%3Dpermissions.request%26app_id%3D282892925078054%26client_id%3D282892925078054%26redirect_uri%3Dhttps%253A%252F%252Fwww.facebook.com%252F%26display%3Dpage%26response_type%3Dtoken%26fbconnect%3D1%26from_login%3D1&rcount=1)

我期待这样的事情：

```
https://www.facebook.com/#access_token=BAAEBSiRPCiYBAH0yF1cmZB14RBs9ZBvN7xQJaDvZAxd29WZCAZCpZAVzHXONNlUd9MOZAsTcSUimW7GITwrvN3px1XJSZBvK3wATdLzlQVOqQmlpBfs0ZCpsfydQV4ZCJEmpk4lmh9JCKbli78IDozYZBONxVszFZACQAgL2WPXF7680NGDQtD2IHl0oj6xbfqAtqpURSdJJmoZBXZAQZDZD&expires_in=5822 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-07-22T10:22:09.320

除非你想自己重写这个库，否则你可以使用 Facebook C# SDK，这就是注册你的 appKey 和 appId。

看看：[https ://github.com/facebook-csharp-sdk/facebook-winclient-sdk](https://github.com/facebook-csharp-sdk/facebook-winclient-sdk)

和例子： http: [//facebooksdk.net/docs/web/permissions/](http://facebooksdk.net/docs/web/permissions/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-22T10:36:54.823

```
CallbackManager callbackManager;

 protected void onCreate(Bundle savedInstanceState) 
{

 FacebookSdk.sdkInitialize(getApplicationContext());

  callbackManager  = CallbackManager.Factory.create();

  facebookLogin = (LoginButton) findViewById(R.id.login_button);

  facebookLogin.setReadPermissions("user_friends");

   LoginManager.getInstance().registerCallback(callbackManager,new FacebookCallback<LoginResult>()

 {

            @Override

            public void onSuccess(LoginResult loginResult) {

                Log.d("Access Token" ,loginResult.getAccessToken().getToken());

               //here you get you access token

            }

            @Override

            public void onCancel() {

                Log.d("Cancel" ,"On cancel");

            }

            @Override

            public void onError(FacebookException e)
 {
                Log.d("Error","Error");

            }
        });

  //Must set this on activity result

  @Override

    protected void onActivityResult(int requestCode, int resultCode, Intent data)
 {

        super.onActivityResult(requestCode, resultCode, data);

        callbackManager.onActivityResult(requestCode, resultCode, data);

    } 
```

# ruby - Ruby：按键排序哈希并打破价值

> ID：15993693
> 
> 赞同：2
> 
> 时间：2013-04-13T22:35:29.943
> 
> 标签：ruby, sorting, associative-array

是否可以服用`Hash`红宝石，例如

```
{"aaa" => 255, "abc" => 255, "acb" => 255, "dcv" => 2300, "abe" => 1} 
```

并把它分类成`Array`这样的

```
[["dcv", 2300], ["aaa", 255], ["abc" => 255], ["acb" => 255], ["abe", 1]] 
```

使用`sort_by`方法？这种排序应该产生一个数组数组，首先按出现的数字按降序排序，然后在平局上，它应该按字符串的字母顺序按升序排序。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-13T22:39:14.447

```
h = {"aaa" => 255, "abc" => 255, "acb" => 255, "dcv" => 2300, "abe" => 1}
h.sort_by { |k,v| [-v,k] }
# => [["dcv", 2300], ["aaa", 255], ["abc", 255], ["acb", 255], ["abe", 1]] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-29T00:50:09.907

另一种解决方法

```
h = h.sort_by { |k,v| v }.reverse

puts h.inspect 
```

# ember.js - 具有 ID 以外的属性的 Ember 路由/查找

> ID：15993694
> 
> 赞同：1
> 
> 时间：2013-04-13T22:35:44.463
> 
> 标签：ember.js, ember-data

我以为我对具有`find`除 ID 以外的属性的模型有一个相当简单的解决方案，但我遇到了一个问题。

### 当前设置：

灰烬路由器：

```
App.Router.map ->
  @resource "posts", ->
    @route "show", {path: ':slug'}

App.PostsShowRoute = Ember.Route.extend
  serialize: (model, params) ->
    object = {}
    name = params[0]
    object[name] = model.get('slug')
    return object
  model: (params) -> App.Post.find(params.slug) 
```

导轨控制器：

```
class PostsController < ApplicationController
  def show
    @post = Post.find_by_slug(params[:id])
    render json: @post
  end
end 
```

### 问题

如果`params.slug == "some-post"`，当`post`对象从服务器返回时，`post.id == "some-post"`。这弄乱了所有的关联。

这可能是因为`DS.Store`假设如果我打电话`find(something)`，`something`就是`id`。我原以为来自服务器的响应会覆盖这个假设，但事实并非如此。

有一个更好的方法吗？我的用例非常简单。我需要做的就是`post`通过 slug 属性对对象进行序列化和反序列化。

我正在使用 Ember Data 修订版 11

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T20:45:44.880

解决方案原来是`findQuery`。我前段时间正在使用它，但我不知道如何使用promise。

```
model: (params) ->
  @get('store').findQuery(App.Post, {slug: params.slug}).then (data) ->
    return data.get('firstObject') 
```

在铁轨一侧：

```
class PostsController < ApplicationController
  def index
    @posts = params[:slug] ? Post.where(slug: params[:slug]) : Post.homepage
    render json: @posts
  end 
```

# c++ - 将 OOP 与结构代码混合

> ID：15993697
> 
> 赞同：0
> 
> 时间：2013-04-13T22:36:13.577
> 
> 标签：c++, c

我在不同的文件中有几个类。我想在`main()`函数中使用从文件机制读取的简单 C - 只需从两个文件中读取两个整数，仅此而已。

现在，我应该创建一个单独的 File 类并从那里处理它吗？

`"file.cpp"`我应该在单独的文件中创建标准函数吗？

我应该直接写这 3-5 行代码`main()`吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T22:46:55.337

我认为您的意思是您将 OOP 与过程编程混合在一起。如果是这样，很好。C++ 旨在同时利用这两者。

如果你想写一个没有任何状态的函数，不要让它成为一个类的成员。只需编写一个名为`read_values_from_file`或任何您想要的免费函数。确定代码中的个人职责并将其分解为函数绝对是一种好习惯。

你应该把它放在哪个文件中取决于你是否会重用它。如果您只打算在开头使用它`main`，只需将其放入`main.cpp`. 不要仅仅为了它而给它自己的文件。否则，如果您想在多个翻译单元中使用相同的函数，将其声明放在头文件中并将其定义放在实现文件中可能会很有用。

不管你把它放在哪里，都不要让这个函数成为一个类的成员。这就是 Java 程序员所做的，因为他们别无选择。C++ 相信你知道什么时候最适合创建一个类：什么时候有状态。

但是，我认为您没有充分的理由使用任何 C 库函数从文件中读取。没有理由不能编写使用 C++ 标准库的过程代码。只需使用文件流（例如[std::istream](http://en.cppreference.com/w/cpp/io/basic_istream)）来读取值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T22:39:13.130

Since the question is tagged as c++, I suggest checking the topic of [c++ streams](http://www.cplusplus.com/doc/tutorial/files/). I don't see why would you have to write file reading related classes.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-13T22:46:52.147

这项任务是如此之小，以至于很难说“最佳实践”是否适用。

现在让它工作，使用`scanf`or`std::cin`或任何方便的东西，如果你以后发现自己需要更多功能，然后开始设计更强大的东西。

不要浪费大量时间过度设计一些简单的东西，直到你知道你将需要这些额外的功能。

# spring - 数据库连接死锁

> ID：15993698
> 
> 赞同：1
> 
> 时间：2013-04-13T22:36:20.827
> 
> 标签：spring, ibatis, spring-3

我们有一个运行良好多年的 Web 应用程序。Web 应用程序使用 mysql、spring-1.2.6 和 ibatis。

将 spring-1.2.6 替换为 spring-3.2.0 后，我们开始注意到一个问题，即对特定页面的多个并发请求总是由于某种原因而挂起。

jConsole 为每个并发线程显示以下内容：

```
 java.lang.Thread.State: WAITING on 
   org.apache.commons.pool.impl.GenericObjectPool$Latch@b6b09e
   at java.lang.Object.wait(Native Method)
   at java.lang.Object.wait(Object.java:485)
   at org.apache.commons.pool.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:1104) 
```

经过调查，我们发现这个问题与如下所示的resultMap有关。使用 spring-1.2.6，无论结果集中有多少行，每个线程只需要一个连接。但是，对于 spring-3.2.0，每个线程都需要 N+1 个连接（取决于返回的行数）。因此陷入僵局。（我们在配置中使用 maxActive 属性的默认值 (8)。）

如何修复它以便在这种情况下重用连接？谢谢。

```
<resultMap id="resultBlog" type="Blog">
    <id property="id" column="idBlog" />
    <result property="name" column="blogname" />
    <result property="url" column="blogurl" />
    <result property="author" column="idBlog" select="selectAuthor" />
</resultMap> 
```

# iphone - UITableViewController 不会显示我正在创建的单元格

> ID：15993707
> 
> 赞同：0
> 
> 时间：2013-04-13T22:37:19.727
> 
> 标签：iphone, ios, uitableview

首先，我是 iOS 开发的新手，所以这可能是一个简单的问题，

我有以下代码

```
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    return 1;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    return 1;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";

    UITableViewCell *cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier] ;

    cell.textLabel.text = @"Hello!";
    cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;
    NSLog(@"Creating cell for %i:%i", indexPath.section, indexPath.row );

    return cell;
} 
```

现在表格显示，但所有行都是空白的。并且正在创建细胞。不确定这是否重要，但我没有使用 xib 或故事板，所以我不知道它是否是样式问题。

我真的对我在做什么一无所知。我尝试过一些教程，但每次我都在同一个地方找到一张空白表。

谢谢大家的帮助！我对想法和可能的教程等持开放态度。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T23:08:24.137

（这更像是评论，但对于评论字段来说太大了。）

我已将您的方法完全复制到我的 .m 文件中，并且可以正常工作。文件的其余部分如下所示：

```
@interface MYViewController ()

@end

@implementation MYViewController

- (void)viewDidLoad
{
    [super viewDidLoad];
    UITableView *table = [[UITableView alloc] initWithFrame:CGRectMake(0, 0, 320, 640) style:UITableViewStylePlain];
    [table setDataSource:self];
    [table setDelegate:self];
    [self.view addSubview:table];
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
} 
```

我假设您设置了数据源，因为您要打印 NSLogs。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T23:18:47.800

您确定 UITableView 没有隐藏，没有 0 alpha，并且高于所有其他视图吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-14T02:53:33.910

如果您显示的数据有可能在您外出并返回视图时发生变化，我建议您使用

```
[self.yourTableViewObject reloadData]; 
```

这将调用所有委托方法（获取部分、单个单元格）并重新填充您的表格视图。

# php - php variable reset to 0

> ID：15993708
> 
> 赞同：-1
> 
> 时间：2013-04-13T22:37:21.207
> 
> 标签：php, variables

A php variable $a (which was set to a value earlier in the code) is being reset to a value of 0 and I don't want it to. At the end of the php code, I did an echo and $a was 0\. So I made a debugging array to catch the value at various points. I found where it's getting set to 0\. Here's the code:

```
$a = 1;
if($total> 0){  
  $a = ($a/$total);  
  $X["i"]=$a;    
}
$X["ii"]=$a;  

Output:
$x["i"]=1;
$x["ii"]=0; 
```

A few things: There are no functions at all (and obviously not where it's being set to 0), and $a is a global. It's a very large php file. I'm wondering if memory is the problem...? No idea. I'm not a nube to php, or to programming.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T22:45:13.523

您正在设置大写 X 并输出小写 x

（如果这只是一个错字，请显示更多代码。例如输出代码。）

# php - Upload gets to 5%, then resets to 0%

> ID：15993718
> 
> 赞同：0
> 
> 时间：2013-04-13T22:38:45.043
> 
> 标签：php, jquery, fine-uploader

I'm having some issues with fine-uploader. With smaller files (~20MB), everything is great. However, with larger files (100MB+), the files will upload to around 5%, then the progress bar will reset back to 0%.

Upload eventually fails with "Error when attempting to parse xhr response text (SyntaxError: Unexpected end of input)".

In my endpoint (upload.php), my very last line is "echo json_encode($result);". $result is an array, and here's the relevant PHP:

```
if (move_uploaded_file($file['tmp_name'], $target)){
    $result = array('success'=> true);
    $result['uploadName'] = $file['name'];
} else {
    $result = array('error'=> "Upload failed");
}
header("Content-Type: text/plain");
echo json_encode($result); 
```

Is this an issue with upload.php or is something funky happening with fine-uploader?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T02:12:52.097

这是您的服务器环境中的服务器端代码错误的症状。您的服务器肯定返回错误。这将在 javascript 控制台中报告。请看一看。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T23:13:37.507

原来这个问题是由 CloudFlare 引起的。

我为包含我上传内容的整个目录添加了一个自定义页面规则，但它似乎没有帮助。页面规则基本上禁用了该文件夹的所有 CloudFlare 内容，以及其中的所有内容（除非我不了解页面规则的功能）。

不过，在域上暂停 CloudFlare 似乎可以解决它。自从暂停 CloudFlare 以来，上传大文件一直有效。

一位 CloudFlare 员工[在这里提到了一些事情](http://www.webmasterworld.com/php/4297037.htm)。

# android - 如何为圆形图像按钮制作圆形背景选择器？

> ID：15993723
> 
> 赞同：0
> 
> 时间：2013-04-13T22:38:57.500
> 
> 标签：android, drawing

我正在尝试将圆形按钮的背景选择器作为按钮周围的环。类似于 AOS4.1 中用于按钮 Home/Back 等的平板电脑。所以为了实现它，我使用以下选择器：

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item 
        android:drawable="@android:color/transparent" 
        android:state_pressed="false" 
        android:state_selected="false"/>

    <item 
        android:state_pressed="true">
        <shape 
            android:shape="ring"
            android:innerRadius="0dp"
            android:thicknessRatio="1.9"
            android:useLevel="false" >
            <solid android:color="@color/btn_background" />
        </shape>
    </item>

</selector> 
```

它确实有效，但它绘制了一个实心环。实际上，我希望它比按钮本身大，就像按钮周围的环一样。有什么办法可以做到这一点，还是我必须为每个圆形图像按钮编写一个具有不同大小的单独 xml？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-14T05:09:19.067

你可以做一件事。在您的形状**`@android:color/transparent`**中用作`solid`颜色并使用`stroke`所需的边框颜色。

```
 <shape 
        android:shape="ring"
        android:innerRadius="0dp"
        android:thicknessRatio="1.9"
        android:useLevel="false" >
        <solid android:color="@android:color/transparent" />
        <stroke android:color="@color/btn_background" android:width="1dp"/>
    </shape> 
```

它将在按钮外创建一个循环边框​​。这是你想要的吗？

# c# - WPF DrawingContext 太慢了

> ID：15993732
> 
> 赞同：1
> 
> 时间：2013-04-13T22:40:13.847
> 
> 标签：c#, .net, wpf, rendering

我使用 WPF 和 DrawingContext + DrawingVisual 编写了音频可视化。问题是它很慢。所以我已经启动了我的分析器，结果如下： [http ://s14.directupload.net/images/130414/rnizoyw2.png](http://s14.directupload.net/images/130414/rnizoyw2.png)

我看不到任何可以提高性能的线条。那么您可能对如何提高性能有任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-13T22:56:15.573

[您可以直接写入WriteableBitmap](http://msdn.microsoft.com/en-us/library/system.windows.media.imaging.writeablebitmap%28v=vs.110%29.aspx)，而不是绘制到新的 DrawingVisual 然后将该 Visual 呈现到 RenderTargetBitmap 中。

使用 WriteableBitmap 作为 Image 控件的 Source。

从 WriteableBitmap 的备注部分：

> 使用 WriteableBitmap 类以每帧为基础更新和呈现位图。这对于生成算法内容（例如分形图像）和数据可视化（例如音乐可视化器）很有用。

您可能还想查看[WriteableBitmapEx](https://writeablebitmapex.codeplex.com/)库。

# ruby-on-rails - Rspec render_template 未按预期工作

> ID：15993737
> 
> 赞同：0
> 
> 时间：2013-04-13T22:40:58.710
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rspec

我有一个测试用户注册的规范

```
describe '#POST do_register' do
  context 'with valid parameters' do
    before { post :do_register, user: attributes_for(:new_user) }

    it 'assigns a persisted @user' do
      assigns(:user).should_not be_new_record
    end

    it 'redirects to login path' do
      response.should redirect_to(login_path)
    end

    it 'sets user profile as member' do
      assigns(:user).profile.should be_a(Member)
    end
  end

  context 'with invalid paramaters' do
    before { post :do_register, user: attributes_for(:new_user, username: nil) }

    it 'assigns a new @user' do
      assigns(:user).should be_new_record
    end 
```

> ```
>  it 'renders register form' do
>       response.should render_template('register')
>     end 
> ```

```
 end
end 
```

我期待得到一个错误，因为失败时我没有`register`在控制器中呈现模板`save`。

```
def do_register
  ...

  if @user.save
    redirect_to(login_path)
  end
end 
```

但是我根本没有收到任何错误，并且示例通过了。我错过了什么吗？

# ios - iOS登录模式

> ID：15993739
> 
> 赞同：1
> 
> 时间：2013-04-13T22:41:08.297
> 
> 标签：ios, core-data, login

我正在编写一个需要用户登录的 iOS 应用程序。登录需要向 Web 服务发出 JSON 请求，然后将用户详细信息存储在 Core Data 或任何最好的位置。

此外，我需要在主应用程序启动之前出现登录模式，我知道为此我将其称为`- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions`.

所以，我需要一个简单的登录名、用户名和密码字段，发出请求，然后将生成的 JSON 数据存储到某个地方，也许是核心数据？

我已经搜索了一个登录示例的高低，但它们都非常简陋或没有完全按照我的意愿行事。我正在考虑创建一个 xib 文件然后调用它，但我不确定这一切。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T23:02:38.013

只需`didFinishLaunchingWithOptions`将您的模态推`LoginViewController`送到导航堆栈即可。如果您使用的是故事板，您可以只创建`LoginViewController`根视图控制器，或者放置一个 segue，给它一个标识符，然后调用`[rootViewController performSegueWithIdentifier:@"YourSegueId" sender:self]`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T01:32:58.817

几天前我也在想同样的问题。
这是我的解决方案：
在`didFinishLaunchingWithOptions`，我调用一个方法检查您的数据库中是否有帐户和密码（核心数据？我只使用用户默认值）。
如果有，请尝试登录，如果登录失败，则显示模态视图。如果成功，请将您的 appdelegate.window.rootviewcontroller 设置为主视图控制器。
如果没有，则显示模态视图。

或者登录失败，blablabla ...

对不起我糟糕的英语。
这是我的代码：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    [[AFNetworkActivityIndicatorManager sharedManager] setEnabled:YES];

    UINavigationController *nav = [[UINavigationController alloc] init];

    self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
    // Override point for customization after application launch.
    self.window.backgroundColor = [UIColor whiteColor];
    self.window.rootViewController = nav;
    [self.window makeKeyAndVisible];
    [ZTCAPIClient registerUserInfo];
    return YES;
}

+ (void) registerUserInfo {
    NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];

    NSString *account = [defaults stringForKey:@"account"];
if(!account) {
    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
        // load default value
        [self performSelector:@selector(registerDefaultsFromSettingsBundle)];
        dispatch_async(dispatch_get_main_queue(), ^{
            ZTCUserSettingsViewController *userSettingsView = [[ZTCUserSettingsViewController alloc] init];
            UINavigationController *usersSettingsNav = [[UINavigationController alloc] initWithRootViewController:userSettingsView];
            [[[[[UIApplication sharedApplication] delegate] window] rootViewController] presentModalViewController:usersSettingsNav animated:NO];
            [ZTCNotice showSuccessNoticeInView:userSettingsView.view title:[NSString stringWithFormat:@"%@,%@",NSLocalizedString(@"login first time use title", nil),NSLocalizedString(@"login first time use message", nil)]];//TODO
        });
    });
} else {
    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
        if ([ZTCAPIClient loginWithAccount:[defaults stringForKey:@"account"] Password:[defaults stringForKey:@"password"] BaseURL:[defaults stringForKey:@"url"]]) {
            //DLog(@"Log in SUCCESS");
            dispatch_async(dispatch_get_main_queue(), ^{
                UITableViewController *viewController = [[ZTCTaskListViewController alloc] initWithStyle:UITableViewStylePlain];
                UINavigationController *nav = [[UINavigationController alloc] initWithRootViewController:viewController];
                [[[[UIApplication sharedApplication] delegate] window] setRootViewController:nav];
            });
        } else {
            //DLog(@"Log in FAIL");
            dispatch_async(dispatch_get_main_queue(), ^{
                ZTCUserSettingsViewController *userSettingsView = [[ZTCUserSettingsViewController alloc] init];
                UINavigationController *usersSettingsNav = [[UINavigationController alloc] initWithRootViewController:userSettingsView];
                [[[[[UIApplication sharedApplication] delegate] window] rootViewController] presentModalViewController:usersSettingsNav animated:NO];
                [ZTCNotice showErrorNoticeInView:userSettingsView.view title:NSLocalizedString(@"login fail title", nil) message:NSLocalizedString(@"login fail message", nil)];
            });
        }
    });
}
} 
```

# np-complete - 从最大独立集减少到支配集以证明支配集是NP完全的

> ID：15993743
> 
> 赞同：1
> 
> 时间：2013-04-13T22:41:18.410
> 
> 标签：np-complete, proof

我知道从顶点覆盖到支配集的减少。

但是，我正在查看是否可以将最大独立集问题直接简化为支配集问题，以证明后者是 NP 完全的。

有谁知道这是否已经完成？我在网上找不到任何东西。

我希望找到类似证明的东西：

如果有一个大小为 k 的支配集 -> 有一个大小为 k 的最大独立集。

和

如果存在大小为 k 的最大独立集 -> 则存在大小为 k 的支配集。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-15T07:29:53.587

是的，您可以从最大独立集问题直接减少到支配集问题 - 但不是那么直截了当，您需要以下列方式构造另一个图。然后我们可以证明，如果原始图有一个独立的大小集，`k`当且仅当新图有一个与 k 相关的某个大小的支配集。构造是多项式的。

给定一个图`G = (V, E)` ，我们可以构造另一个图`G' = (V', E')`，其中对于 中的每条边`e_k = (v_i, v_j)`，`E`我们添加一个顶点`v_{e_k}`和两条边`(v_i, v_{e_k})`和`(v_{e_k}, v_j)`。

我们可以证明`G`有一个独立的大小集`k`当且仅当`G'`有一个支配集的大小`|V|-k`。

(=>) 假设 I 是 的大小`k`无关集`G`，则`V-I`必须是 的大小`(|V|-k)`支配集`G'`。由于 in 中没有连接的顶点对`I`，因此 in 中的每个顶点都与 in`I`中的某个顶点相连`V-I`。此外，每个新添加的顶点也连接到 中的一些顶点`V-I`。

(<=) 假设`D`是一个与大小`(|V|-k)`无关的集合`G'`，那么我们可以安全地假设 in 的所有顶点`D`都在`V`（因为如果`D`包含一个添加的顶点，我们可以用它的一个相邻顶点来替换它，`V`并且仍然有一个支配集合大小相同）。

我们声称`V-D`是一个与大小`k`无关的集合，`G`并通过反证法证明：假设`V-D`不独立并且包含一对顶点`v_i`并且`v_j`边`e_k = (v_i, v_j)`在 中`E`。那么在`G'`所添加的顶点中`v_{e_k}`需要以`v_i`or为主`v_j`，即至少是`v_i`和`v_j`中的一个`D`。矛盾。因此`V-D`是一个与大小`k`无关的集合`G`。

结合这两个方向，你会得到你想要的。

# ios - 使 UIView 区域不可点击

> ID：15993744
> 
> 赞同：0
> 
> 时间：2013-04-13T22:41:20.680
> 
> 标签：ios, ipad

因此，我在 Ipad 上为我正在处理的一个小项目设置了 UIView。我将在该页面上显示图像或视图。我想知道是否可以在视图周围创建一个不可点击的不可见边框（比如 1"）？我正在考虑添加一个按钮并禁用它，但我认为这不会让图像完整显示屏幕。我已经设置了一个识别器，因为我想用三指滑动转到下一个图像。什么是最好的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T22:48:00.597

使用自定义`UIView`类并覆盖`hitTest:withEvent:`.

```
- UIView *)hitTest:(CGPoint)point withEvent:(UIEvent *)event {
    CGRect frame = CGRectInset(self.bounds, 25, 25);

    return CGRectContainsPoint(frame, point) ? self : nil;
} 
```

调整插图以满足您的需求。

# deployment - 部署到 root 以外的命名空间时，activeadmin 菜单链接失败？

> ID：15993750
> 
> 赞同：1
> 
> 时间：2013-04-13T22:42:34.683
> 
> 标签：deployment, menu, routes, activeadmin

对活跃的管理员来说有点新（4-5 个内部应用程序）。我发现它简单而灵活。

但是，当我将应用程序部署到 root 以外的上下文时，菜单会失败。

例如，给定一个域，“Rate”菜单会生成一个指向“/admin/rates”的链接。没有问题，一切都按预期工作。但是，如果我部署到上下文“/xyz”，菜单仍会生成“/admin/rates”链接，而不是预期的“/xyz/admin/rates”链接。

是否有我可能错过的配置步骤？

谢谢

编辑...

我正在部署扭矩箱

试着在一个范围内围观，让我更加困惑。即/xyz/xyz/admin/rates

```
scope :path => '/xyz' do
 devise_for :admin_users, ActiveAdmin::Devise.config
 ActiveAdmin.routes(self)
end 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-07-20T23:48:51.390

在您的项目目录中查找 app/admin/rates.rb

```
ActiveAdmin.register Rate do
    menu :url => "/app/admin/rates" 
end 
```

这将更改菜单项仅链接到的 URL。不影响导轨中的路由。

# css - 如何为我的 CSS 幻灯片放映横幅添加默认值？

> ID：15993755
> 
> 赞同：0
> 
> 时间：2013-04-13T22:43:20.970
> 
> 标签：css, image, slider, default

我使用了在网上找到的免费 CSS 幻灯片并对其进行了编辑，但我不知道如何添加默认图像。我创建了一个小提琴来显示我的代码：[[链接]](http://jsfiddle.net/tdU3Q/)

此外，在代码中，：

```
<img id="imageX" src="images/banners/X.png"> 
```

是否有图像显示。我会告诉你，但它在我的本地主机上运行。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T23:26:29.423

我猜你的意思是一个问题，是当滑块加载时`img`元素有`opacity:0; left:-400px; z-index:1;`并且你只设置

```
 #homebanner img:first-child {
     left: 0;
  } 
```

所以它一开始不会显示第一张图片，但你可以做这样的事情

```
 #homebanner img:first-child {
     left: 0;
     z-index: 9;
     opacity: 1;
  } 
```

（主要是这里的不透明度），立即显示它。

这样，图像也可以在幻灯片切换之间保持为“默认”/背景图像。

在这里，我还更新了您的小提琴，并添加了一些随机图像以进行说明：http: [//jsfiddle.net/tdU3Q/3/](http://jsfiddle.net/tdU3Q/3/)

# perl - Perl 库 每次登录到服务器后都会出现错误消息

> ID：15993762
> 
> 赞同：-1
> 
> 时间：2013-04-13T22:45:04.073
> 
> 标签：perl

我会尽量让我的问题清楚。

登录到服务器后，我收到以下消息：

```
 Last login: Sat Apr 13 02:52:11 2013 from this_and_that
 Can't locate local/lib.pm in @INC (@INC contains: /.../perl5/lib/perl5/x86_64-linux-thread-multi /.../perl5/lib/perl5 /usr/local/lib64/perl5 /usr/local/share/perl5 /usr/lib64/perl5/vendor_perl /usr/share/perl5/vendor_perl /usr/lib64/perl5 /usr/share/perl5 .).
 BEGIN failed--compilation aborted. 
```

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T23:21:39.337

检查您的 shell 启动文件（例如`~/.bashrc`）。似乎您有一个[引导 local::lib](http://search.cpan.org/~apeiron/local-lib-1.008009/lib/local/lib.pm#The_bootstrapping_technique)的命令，它会引发错误。

# sencha-touch - 如何在 Sencha Touch Bar Charts 中定位单个 Bar？

> ID：15993765
> 
> 赞同：0
> 
> 时间：2013-04-13T22:45:34.353
> 
> 标签：sencha-touch, sencha-architect

我在 Sencha Architect 中有一个图表，我希望能够单击单个 Bar 并更改它的值，例如 +1

如何定位图表中的特定条形？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T06:01:55.107

好的，事实证明您可以使用 Sencha Architect 中的样式配置来更改条形颜色，但您必须先删除颜色配置中的默认颜色，否则样式将被忽略。

颜色配置默认是一个数组，例如 ['red','blue'] 等，您可以使用 attributes.fill = colors[1] 选择颜色。

# ios - 尝试获取视频缩略图

> ID：15993766
> 
> 赞同：3
> 
> 时间：2013-04-13T22:45:35.180
> 
> 标签：ios, objective-c

我正在尝试从保存在 Documents/ 文件夹中的视频中获取视频缩略图，并将其显示在 UITableViewCell 内的 UIImageView 中。这是我获取缩略图的功能：

```
- (UIImage*) thumbnailImageForVideo:(NSURL *)sourceURL
{
    AVAsset *asset = [AVAsset assetWithURL:sourceURL];
    AVAssetImageGenerator *imageGenerator = [[AVAssetImageGenerator alloc]initWithAsset:asset];
    NSError *err = NULL;
    CMTime time = CMTimeMake(1, 1);
    CGImageRef imageRef = [imageGenerator copyCGImageAtTime:time actualTime:NULL error:&err];
    NSLog(@"err==%@, imageRef==%@", err, imageRef);
    UIImage *thumbnail = [[UIImage alloc] initWithCGImage:imageRef];
    CGImageRelease(imageRef); // CGImageRef won't be released by ARC
    return thumbnail;
} 
```

这是我使用它的地方：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    LibraryCell *libraryCell = [tableView dequeueReusableCellWithIdentifier:@"LibraryCell" forIndexPath:indexPath];

    NSString *videoPath = [NSString stringWithFormat:@"%@/%@", [NSHomeDirectory() stringByAppendingPathComponent:@"Documents"], [libraryFiles objectAtIndex:indexPath.item]];
    libraryCell.itemImage.image = [self thumbnailImageForVideo:[NSURL URLWithString:videoPath]];

    return libraryCell;
} 
```

该应用程序不会崩溃，但没有图像。这是我在控制台中看到的：

```
2013-04-13 23:44:46.828 GeekOut[14433:907] err==Error Domain=NSURLErrorDomain Code=-1 "unknown error" UserInfo=0x1f0b4610 {NSUnderlyingError=0x1f0b3220 "The operation couldn’t be completed. (OSStatus error -12935.)", NSLocalizedDescription=unknown error}, imageRef==(null)
2013-04-13 23:44:46.859 GeekOut[14433:907] err==Error Domain=NSURLErrorDomain Code=-1 "unknown error" UserInfo=0x1dd8c660 {NSUnderlyingError=0x1dd8c5c0 "The operation couldn’t be completed. (OSStatus error -12935.)", NSLocalizedDescription=unknown error}, imageRef==(null)
2013-04-13 23:44:46.893 GeekOut[14433:907] err==Error Domain=NSURLErrorDomain Code=-1 "unknown error" UserInfo=0x1f0bec80 {NSUnderlyingError=0x1f0be9b0 "The operation couldn’t be completed. (OSStatus error -12935.)", NSLocalizedDescription=unknown error}, imageRef==(null) 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-13T23:01:43.537

您的缩略图提取代码工作正常。问题是您`NSURL`在**tableView:cellForRowAtIndexPath:**中初始化的方式。

尝试改变这个：

```
[NSURL URLWithString:videoPath] 
```

对此：

```
[NSURL fileURLWithPath:videoPath] 
```

# javascript - 边框半径和 Java 脚本

> ID：15993768
> 
> 赞同：0
> 
> 时间：2013-04-13T22:46:05.397
> 
> 标签：javascript, css, dynamic

我有一个 JS 文件，`#nav`当它到达页面顶部时会生成一个固定元素（以创建一个浮动导航栏，无论滚动如何都会持续存在）。当不在页面顶部时，顶部`#nav`有圆角（边框半径左上角和右上角），当元素更改为“固定”时我想消失这是我的代码：

```
$(function() {
  // Stick #nav to the top of the window
  var nav = $('#nav');
  var navHomeY = nav.offset().top;
  var isFixed = false;
  var $w = $(window);
  $w.scroll(function() {
      var scrollTop = $w.scrollTop();
      var shouldBeFixed = scrollTop > navHomeY;
      if (shouldBeFixed && !isFixed) {
          nav.css({
              position: 'fixed',
              top: 0,
          });
          isFixed = true;
      }
      else if (!shouldBeFixed && isFixed)
      {
          nav.css({
              position: 'static'
          });
          isFixed = false;
      }
  });
}); 
```

这不起作用：

```
$(function() {
  // Stick #nav to the top of the window
  var nav = $('#nav');
  var navHomeY = nav.offset().top;
  var isFixed = false;
  var $w = $(window);
  $w.scroll(function() {
      var scrollTop = $w.scrollTop();
      var shouldBeFixed = scrollTop > navHomeY;
      if (shouldBeFixed && !isFixed) {
          nav.css({
              position: 'fixed',
              top: 0,
-webkit-border-top-left-radius: 0px,
-webkit-border-top-right-radius: 0px,
-moz-border-radius-topleft: 0px,
-moz-border-radius-topright: 0px,
border-top-left-radius: 0px,
border-top-right-radius: 0px
          });
          isFixed = true;
      }
      else if (!shouldBeFixed && isFixed)
      {
          nav.css({
              position: 'static'
          });
          isFixed = false;
      }
  });
}); 
```

如何从我的 JS 编辑 #nav 的边框半径值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T22:56:42.610

尽量让你的 CSS 与你的 JS 分开。我建议为元素的“固定”版本创建一个单独的类，其中包含所有额外的 CSS，然后根据需要删除和添加该类。

**CSS：**

```
#nav.fixed{
  position: fixed;
  top: 0;
  -webkit-border-top-left-radius: 0px;
  -webkit-border-top-right-radius: 0px;
  -moz-border-radius-topleft: 0px;
  -moz-border-radius-topright: 0px;
  border-top-left-radius: 0px;
  border-top-right-radius: 0px;
} 
```

**JS：**

```
$(function() {
  // Stick #nav to the top of the window
  var nav = $('#nav');
  var navHomeY = nav.offset().top;
  var isFixed = false;
  var $w = $(window);
  $w.scroll(function() {
      var scrollTop = $w.scrollTop();
      var shouldBeFixed = scrollTop > navHomeY;
      if (shouldBeFixed && !isFixed) {
          nav.addClass("fixed")
          isFixed = true;
      }
      else if (!shouldBeFixed && isFixed)
      {
          nav.removeClass("fixed")
          isFixed = false;
      }
  });
}); 
```

更整洁，不是吗？

# java - 如何将一段代码循环x次并取平均值

> ID：15993769
> 
> 赞同：0
> 
> 时间：2013-04-13T22:46:05.447
> 
> 标签：java

我正在寻找循环下面代码的主要部分，然后计算从循环中收集的结果的平均值

这是代码：

```
class PingPongVariousLengths {

    static public void main(String[] args) {

        MPI.Init(args);
        int myrank = MPI.COMM_WORLD.Rank();
        int tag = 99;
        int maxlen = 104857600; //200 megabytes     104857600 characters * 2 bytes per character = 209715200 bytes total, or 200 megabytes
        int minlen = 1; // 2 bytes
        char [] sendbuff = new char [maxlen];
        char [] recvbuff = new char [maxlen];
        long speedKbps;
        long speedMbps;

        if (myrank == 0) {
            for (int len = minlen; len <= maxlen; len *= 2) { //len=*2 doubles the ping size each time
                long startTime = System.nanoTime();                  
                 MPI.COMM_WORLD.Send(sendbuff, 0, len, MPI.CHAR, 1, tag);
                 MPI.COMM_WORLD.Recv(recvbuff, 0, len, MPI.CHAR, 1, tag);
                long endTime = System.nanoTime();
                long duration = endTime - startTime;
                long durationseconds = (duration * 10-9); // Converts nanoseconds to seconds
                System.out.println("Time for the ping to be sent and recived of " + (len*2) + " bytes is " + durationseconds + " seconds"); // multiples by 2 becuase 1 character is 2 bytes
                //double transferRate = ((len*2.0) / durationseconds ) ; //amount of data in bytes transferred in 1 second. Currently returning 0 for every result
                //System.out.println("transferRate: " + transferRate + " bytes per second");
                double transferRateMb = ((len*524288.0) / durationseconds ) ; //amount of data in megabytes transferred in 1 second. 
                System.out.println("transferRate (megabytes) : " + transferRateMb + " megabytes per second");
                }
        } else if (myrank == 1) {
            for (int len = minlen; len <= maxlen; len *= 2) {
                 MPI.COMM_WORLD.Recv(recvbuff, 0, len, MPI.CHAR, 0, tag);
                 MPI.COMM_WORLD.Send(recvbuff, 0, len, MPI.CHAR, 0, tag);
            }
        }

        MPI.Finalize();
    }
} 
```

我试图循环它说 10 或 20 次，代码来自

```
 for (int len = minlen; len <= maxlen; len *= 2) { //len=*2 doubles the ping size each time 
```

至

```
 long durationseconds = (duration * 10-9); // Converts nanoseconds to seconds 
```

我想跑 20 次，然后结果`duration`平均超过 10 或 20

我怎样才能最好和最有效地做到这一点

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T23:10:08.227

如果我理解正确，您需要每个长度增量的平均持续时间秒数。为了获得持续时间的平均值，您需要将循环长度移到平均循环之外。请参阅下面的代码片段。

```
long durationseconds;
int MAX_LOOPS = 20;

for (int len = minlen; len <= maxlen; len *= 2) {
        if (myrank == 0) {
                durationseconds = 0;
                for (int i = 0; i < MAX_LOOPS; i++) {
                        long startTime = System.nanoTime();           
                        MPI.COMM_WORLD.Send(sendbuff, 0, len, MPI.CHAR, 1, tag);
                        MPI.COMM_WORLD.Recv(recvbuff, 0, len, MPI.CHAR, 1, tag);
                        long endTime = System.nanoTime();
                        long duration = endTime - startTime;
                        durationseconds = durationseconds + (duration * 10-9);
                }
                durationseconds = durationseconds / MAX_LOOPS;
                System.out.println("Average time for the ping to be sent and recived of " + (len*2) + " bytes is " + durationseconds + " seconds");
                double transferRateMb = ((len*524288.0) / durationseconds );
                System.out.println("average transferRate (megabytes) : " + transferRateMb + " megabytes per second");
        } else if (myrank == 1) {
                MPI.COMM_WORLD.Recv(recvbuff, 0, len, MPI.CHAR, 0, tag);
                MPI.COMM_WORLD.Send(recvbuff, 0, len, MPI.CHAR, 0, tag);
        }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T22:51:21.117

```
long totalDuration = 0;
for (int i = 0; i<nTimes;i++){
... //Code N stuff here
totalDuration += duration;
}
long avgDuration = totalTime /nTimes; 
```

# javascript - 鼠标悬停图像随声音变化

> ID：15993770
> 
> 赞同：-5
> 
> 时间：2013-04-13T22:46:11.757
> 
> 标签：javascript, css

我在一个网站上工作，我有一张图片（实际上是一张带窗户的房子的图片），我想在鼠标悬停时在窗口中弹出一张脸（Goldilocks）以及一些声音。理想情况下，面部会在几帧内移动，而不仅仅是出现在鼠标悬停时。做这个的最好方式是什么。我对这个网页设计有点陌生，所以感谢您的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-13T23:00:33.897

如果没有你的任何代码，我只能推荐[jQuery Transit](http://ricostacruz.com/jquery.transit/)用于动画（你可以使用带有关键帧的纯[CSS3 动画，或者在悬停时使用带有](https://developer.mozilla.org/en-US/docs/CSS/Tutorials/Using_CSS_animations)[CSS3 过渡](https://developer.mozilla.org/en-US/docs/CSS/Tutorials/Using_CSS_transitions)的背景图像精灵，但在这里使用 jQuery 来同步事件可能更好）。第二个插件是[jSound](http://jquer.in/jquery-plugins-to-add-multimedia-to-your-website/jsound/)。

当然，您可以为此找到许多其他插件，您甚至可以编写自己的代码以[`<audio>`](https://developer.mozilla.org/en-US/docs/HTML/Element/audio)在悬停时播放来自 HTML5 标记的声音。

* * *

PS 欢迎来到网页设计兄弟会 :) 但是 Stackoverflow 不是一个论坛。您的问题被否决了，因为您没有尝试任何事情。使用谷歌，搜索，学习，尝试一些东西，编写一些代码。然后，如果您的代码不起作用，请在此处提问并粘贴您的代码。然后我们可以帮助您并修复您的代码。

# google-app-engine - 应用引擎 python 接收邮件 python

> ID：15993772
> 
> 赞同：0
> 
> 时间：2013-04-13T22:46:28.680
> 
> 标签：google-app-engine

我正在尝试使用 appengine 接收电子邮件，并且我正在尝试实现 app engine 文档中的教程代码。

一切似乎都运行良好，每次在我的实时应用程序和开发服务器中都获得 200 个代码，但我没有在日志中获得发件人或正文。

对不起，如果它的东西非常明显，但我完全卡住了

```
 import logging
import webapp2
from google.appengine.ext.webapp.mail_handlers import InboundMailHandler

class LogSenderHandler(InboundMailHandler):
def recieve(self, mail_message):
    logging.info("Recieved a message from: " + mail_message.sender)
    bodies = mail_message.bodies('text/plain')
    logging.info(bodies)

app = webapp2.WSGIApplication([LogSenderHandler.mapping()], debug=True)

- url: /_ah/mail/support@myappname.appspotmail.com
script: handle_incoming_email.app
login: admin 

inbound_services:
- mail

2013-04-13 14:12:10.556 /_ah/mail/support@myappname.appspotmail.com  200 670ms 0kb
0.1.0.20 - - [13/Apr/2013:14:12:10 -0700] "POST   /_ah/mail/support@myappname.appspotmail.com HTTP/1.1" 200 84 - - 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T22:49:40.437

似乎是因为您需要覆盖的功能是接收，而不是接收

# javascript - Javascript将图像存储在数组中的对象中，console.log()中是否存在，但是在记录对象时？

> ID：15993774
> 
> 赞同：1
> 
> 时间：2013-04-13T22:46:54.190
> 
> 标签：javascript, arrays, image, object

我有一个我无法理解的问题。

我有一个对象数组，数组中每个对象的属性是 id、source 和 cache。id 是标识符，source 是文件的来源，cache 是实际文件。

当我控制台记录整个数组时，我得到以下输出；

```
console.log(array);

[Object]
    0: Object
        cache: img
        id: "strawberry"
        source: "http://127.0.0.1/images/strawberry.png" 
```

它清楚地表明该数组有一个索引 0，它是一个对象。该对象有一个缓存属性，它是一个图像对象，一个 id 是草莓，一个源是图像的源。

我的问题是试图检索缓存图像对象。经过测试，我发现如果我控制台记录实际索引 0 而不是我得到的整个数组；

```
console.log(array[0]);

Object {id: "strawberry", source: "http://127.0.0.1/images/strawberry.png"} 
```

你可以看到缓存已经消失了吗？我不明白这个？

如果重要的话，我正在使用严格编码。

谁能解释为什么会这样？

**像这样设置缓存**

```
var Assets = function (assets) {

     this.assets = assets;
};

Assets.prototype.load = function () {

    // For each asset
    this.assets.forEach(function (asset, index) {
        // Create new image object
        var img = new Image();
        // Image load handler
        img.addEventListener("load", function () {
            // Add image to assets
            this.assets[index].cache = img;
        }.bind(this), false);
        // Set the image source
        img.src = this.assets[index].source;
    }, this);
};

var assets = new Assets([{id: "strawberry", source: "http://127.0.0.1/images/strawberry.png"}]);

assets.load();

console.log(assets.assets); // shows cache image obj

console.log(assets.assets[0]); // show no cache 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-13T23:58:32.917

嗯...**因为它还*没有***？

如果您执行以下操作：

```
setTimeout(function() {
    console.log(assets.assets[0]); // show cache
}, 1000); // adjust accordingly 
```

然后你会看到`cache`。;)

`this.assets[index].cache = img;`在加载图像之前不会执行该行，并且由于 JavaScript 的异步特性，您`console.log`可能会更早执行，从而为您提供*未定义*的结果。

我很确定你得到了：

```
[Object]
    0: Object
        cache: img
        id: "strawberry"
        source: "http://127.0.0.1/images/strawberry.png" 
```

单击控制台中的某个展开按钮 (>) 后。就在您执行此操作之前，图像实际上已经完成加载，因此您可以看到`cache`.

但是`assets.assets[0]`，对于.`Object {id: "strawberry", source: "http://127.0.0.1/images/strawberry.png"}``cache`

所以我相信实际发生的是：

1.  `console.log(assets.assets)`打印出来的`> [Object]`，`cache`实际上还没有，但你没有注意到这一点，因为它被隐藏/折叠了。
2.  `console.log(assets.assets[0])`打印出来的`Object {id: "strawberry", source: "http://127.0.0.1/images/strawberry.png"}`，`cache`也不在那里。
3.  图像已加载并附加到`cache`.
4.  您单击“>”，将`[Object]`打印出来的内容扩展为`console.log(assets.assets)`，然后看到`cache`那里，因为它现在已经在那里了。

# c++ - 将向量值放在链表中的节点上

> ID：15993777
> 
> 赞同：0
> 
> 时间：2013-04-13T22:47:00.107
> 
> 标签：c++, pointers, linked-list, nodes, graph-theory

在 main 函数中，我们有一个字符串值的向量列表。向量名称；

在我输入之后~~~ 然后我会有names[0] = ~, names[1] = ~

正确的？那么我如何将这些向量值放入我们拥有的节点中

```
class LinkedList 
{
  public: class Nodes {
  public:
      void ToNodeValue(const string& e) { elem = e; }
      Nodes(const string& e) { elem = e; }

  private:
        string element;
        Nodes* prev;
        Nodes* next;
 };

  private: 
    Nodes* header;
    Nodes* tail; 
}; 
```

我正在尝试将这些向量值列表放置到元素中，以便我可以形成一个包含节点的列表，其中每个节点都有自己的字符串元素值

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T22:54:32.543

任务的主要功能部分的一般算法是简单地使用 for 循环来访问向量中的每个值并在 LinkedList 对象上调用插入函数。如

```
LinkedList myList;
for(int x = 0; x < vec.size(); x++) {
  myList.insert(vec[x]);
} 
```

实际插入函数的作用取决于问题描述的要求。如果您只需要将其粘贴到最后，那么伪代码将类似于

```
make new node on heap with val from parameter
set tail->next to be this newNode
set newNode->prev to be tail
set newNode->next to be NULL
set tail to be newNode 
```

# websocket - WebSocket 连接和氚

> ID：15993778
> 
> 赞同：3
> 
> 时间：2013-04-13T22:47:03.550
> 
> 标签：websocket, moovweb, tritium

一个站点是否可以在使用 Tritium 的同时与您“过滤”请求的任何主机建立开放的套接字连接？假设我想克隆一个使用 WebSockets 为浏览器聊天客户端保持打开连接的站点。这些请求是直接在浏览器和远程主机之间发出的，还是通过我的 Moovweb 实例传递（我假设它允许我访问流中的数据）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T18:40:43.680

AFAIK，Moovweb 4.3 不支持 WebSocket。不过，即将发布的版本可能会支持它。

WebSockets[默认跨域工作，](https://stackoverflow.com/questions/4042691/web-sockets-make-ajax-cors-obsolete)因此很容易直接访问源 WebSockets 服务器。

例如，假设您使用以下行指定 Websocket 服务器：`var socket = new WebSocket("ws://echo.websocket.org");`。您不会**在Moovweb 的***config.json*文件中映射域“echo.websocket.org” 。相反，您使用同一行：`var socket = new WebSocket("ws://echo.websocket.org");`在您的 Moovweb 支持的网站上也是如此。

# ios - AsyncSocket 的读取行为不一致

> ID：15993780
> 
> 赞同：1
> 
> 时间：2013-04-13T22:47:11.103
> 
> 标签：ios, rubymotion, cocoaasyncsocket

我正在使用 GCDAsyncSocket 编写一个 RubyMotion 应用程序，并且在将数据读取到特定术语（在我的情况下为 CRLF）时遇到不一致的结果。它有时会读取多个 CRLF 序列，而不是总是向上读取直到并包括下一个 CRLF。这本身不一定是问题，我可以拆分字符串并解析它，但是它有时会在后续字符串的中途读取，因此似乎会发生一些数据丢失。这似乎只发生在快速接收数据时。这是一个输出示例。我发送了字符串“你好，这是一个测试字符串。” 从服务器到我的应用程序快速连续 100 次。正如您从下面的代码中看到的那样，我将字符串拆分为 \r\n，为该特定读取调用分配一个随机数并打印出结果数组的每个部分（0、1、2 等）。

ID 252 Part 0：你好，这是一个测试字符串。ID 252 第 1 部分：您好，这是一个测试字符串。ID 252 第 2 部分：您好，这是一个测试字符串。ID 252 第 3 部分：您好，这是一个测试字符串。ID 252 第 4 部分：您好，这是一个测试字符串。ID 252 第 5 部分：您好，这是一个测试字符串。ID 252 第 6 部分：您好，这是一个测试字符串。ID 252 第 7 部分：您好，这是一个测试字符串。ID 252 第 8 部分：您好，这是一个测试 st ID 780 第 0 部分：您好，这是一个测试字符串。ID 419 Part 0：你好，这是一个测试字符串。ID 128 Part 0：你好，这是一个测试字符串。ID 638 Part 0：你好，这是一个测试字符串。ID 950 Part 0：你好，这是一个测试字符串。ID 950 第 1 部分：字符串。ID 704 Part 0：你好，这是一个测试字符串。

正如您在 read 950 中看到的那样，肯定会发生一些损失。这是我的代码的相关位。

```
def connect()
    $term = AsyncSocket.CRLFData
    clear_keybindings("")
    @ts = AsyncSocket.alloc.initWithDelegate(self, delegateQueue:Dispatch::Queue.main)
    @ts.connectToHost('...', onPort:4001, error:nil)
end

def onSocket(sock, didConnectToHost:host, port:port)
    $connected = true
    send_message('os ios')
    read_line
end

def onSocket(sock, didReadData:data, withTag:tag)
    read_line
    line = NSString.stringWithUTF8String(data.bytes)
    if !line
        return
    end
    id = Random.rand(1000)
    line.split("\r\n").each_with_index do |l, i|
        puts "ID #{id} Part #{i}: #{l}"
        parse(l)
    end
end

def read_line
    @ts.readDataToData($term, withTimeout:-1, tag:0)
end 
```

当我写这篇文章时，我想知道使用 GCDAsyncSocket 是否可以解决这个问题，但如果我改变它：@ts = GCDAsyncSocket.alloc.initWithDelegate(self, delegateQueue:Dispatch::Queue.main) 那么它会连接，但是我的委托方法根本不起作用，似乎也没有发送数据。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-27T22:11:54.233

我会把你的`read_line`电话移到`didReadData:withTag:`委托方法的最后。如果您在短时间内收到大量数据，则您可能在委托方法有机会完成其当前数据的处理之前读取新数据。

# ios - UITableView (IBOutlet) 在初始数据加载后变为空

> ID：15993781
> 
> 赞同：1
> 
> 时间：2013-04-13T22:47:17.720
> 
> 标签：ios, uitableview, null, xcode4.6, reloaddata

这一直让我发疯 - 我有一个带有 @property picTable 的 ParentViewController 类（没有 xib），然后是带有 xib 的 ChildViewController（ParentViewController 的子类）和 File's Owner 的 picTable 部分链接起来。

我注意到了这个问题，因为我需要从 URLRequest 添加更多数据 - 我在 NSArray 中有数据，但调用 reloadData 什么也没做 - 断点显示 self.picTable 为空 - 但它肯定是链接的（通过断点）在视图生命周期的早期。

我尝试使用 NSNotificationCenter、调度队列和 [self performSelectorOnMainThread... 都无济于事 - 我的 refreshTableView 总是被调用，但断点显示表视图为空。

试过 -

@property (nonatomic, strong) IBOutlet UITableView *picTable;

和 -

@property（非原子，保留）IBOutlet UITableView *picTable;

两个类的链接：

家长： [https ://github.com/gileze33/Ticklr/blob/master/Ticklr/GWTPicPresentingViewController.h](https://github.com/gileze33/Ticklr/blob/master/Ticklr/GWTPicPresentingViewController.h) [https://github.com/gileze33/Ticklr/blob/master/Ticklr/GWTPicPresentingViewController.m](https://github.com/gileze33/Ticklr/blob/master/Ticklr/GWTPicPresentingViewController.m)

子类： [https ://github.com/gileze33/Ticklr/blob/master/Ticklr/GWTPicViewController.h](https://github.com/gileze33/Ticklr/blob/master/Ticklr/GWTPicViewController.h) [https://github.com/gileze33/Ticklr/blob/master/Ticklr/GWTPicViewController.m](https://github.com/gileze33/Ticklr/blob/master/Ticklr/GWTPicViewController.m)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T04:40:05.777

即使您从子类调用 [super initWithNibNamed...]，我仍然怀疑 nib 是否将 tableview 连接到超类。即使在超类中定义 tableView 属性对您的设计很重要，也请尝试将 tableView 属性向下移动到子类，然后查看它是否有效。

# c++ - 宏元编程恐怖

> ID：15993789
> 
> 赞同：0
> 
> 时间：2013-04-13T22:48:29.353
> 
> 标签：c++, macros, c-preprocessor, metaprogramming

我正在尝试做类似的事情：

```
custommacro x; 
```

这将扩展为：

```
declareSomething; int x; declareOtherthing; 
```

这甚至可能吗？

我已经用过一次`operator=`这样的行为来欺骗它，但它不能用声明来完成。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-28T17:52:22.130

只要您愿意接受两个添加，就可以省略括号：

1.  整个代码需要包装在一个块宏中
2.  在 echo 指令之后需要有一些东西

例如：

```
#define LPAREN (
#define echo ECHO_MACRO LPAREN
#define done )

#define ECHO_MACRO(X) std::cout << (X) << "\n"

#define DSL(X) X

...
DSL(
    echo "Look ma, no brains!" done;
)
... 
```

原因：

1.  没有括号就*无法*使类似函数的宏展开。这只是宏语言的基本要求；如果您想要其他东西，请调查不同的宏处理器
2.  因此，我们需要插入括号；反过来，我们需要在指令之后有*一些东西*`done`，比如宏，它将扩展为包含必要关闭括号的表单
3.  不幸的是，因为`echo ... done`表单看起来不像是对预处理器的宏调用，所以当预处理器进入它时，它没有被标记为展开，我们是否放入括号是无关紧要的。因此，仅使用`echo ... done`将在文本中转储 ECHO_MACRO 调用
4.  文本被重新扫描，标记为扩展，当它是类函数宏的参数时再次扩展，因此用块宏（这里是`DSL`）包装整个块将导致对 ECHO_MACRO 的调用在此重新扫描时被扩展通过（`DSL`对结果没有任何作用：它的存在只是为了强制重新扫描）
5.  我们需要隐藏简单宏后面`(`的扩展中的，否则宏体中不匹配的括号会混淆预处理器`echo``LPAREN`

如果您想为此类命令创建一个完整的域特定语言，您还可以`done`通过使核心命令更加笨拙来减少命令数量：

```
#define LPAREN (

#define begin NO_OP LPAREN 0
#define done );

#define echo ); ECHO_MACRO LPAREN
#define write ); WRITE_MACRO LPAREN
#define add ); ADD_MACRO LPAREN
#define sub ); SUB_MACRO LPAREN

#define NO_OP(X) 
#define ECHO_MACRO(X) std::cout << (X) << "\n"
#define WRITE_MACRO(X) std::cout << (X)
#define ADD_MACRO(D, L, R) (D) = (L) + (R)
#define SUB_MACRO(D, L, R) (D) = (L) - (R)

#define DSL(X) DSL_2 X
#define DSL_2(X) X

int main(void) {
int a, b;
DSL((
    begin
      add a, 42, 47
      sub b, 64, 50
      write "a is:  "
      echo a
      write "b is:  "
      echo b
    done
))
return 0;
} 
```

在这种形式中，每个命令都预先设计为关闭前面的命令，因此只有最后一个需要`done`; 您需要`begin`一行，以便有一个打开命令来关闭第一个实际操作，否则括号将不匹配。

在 C 中这样搞砸比在 C++ 中要容易得多，因为 C 的预处理器更强大（它支持`__VA_ARGS__`对于复杂的宏元编程非常重要的功能）。

哦，是的，还有一件事——

...请*不要*在实际代码中这样做。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-14T13:02:41.393

我了解您要做什么，但根本无法完成。宏只是文本替换，它不知道后面会发生什么，所以尝试做`custommacro x`将扩展到任何`custommacro`内容，一个空格，然后`x`，这在语义上不起作用。

此外，关于您的`echo`hack：在 C++ 中使用运算符实际上非常简单：

```
#include <iostream>

#define echo std::cout <<

int main()
{
    echo "Hello World!";
} 
```

但是您真的不应该编写这样的代码（即使用宏和伪回声 hack）。您应该编写符合语言语法和您正在尝试执行的操作的语义的代码。如果要写入标准输出，请使用`std::cout`. 此外，如果您想使用，请创建一个内部调用`echo`的函数，但不要破解该语言的功能来创建您自己的功能。`echo``std::cout`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-08-21T05:00:37.063

您可以使用 for 循环和 GnuC 语句表达式扩展。

```
#define MY_MACRO\
  FOR_MACRO(_uniq##__COUNTER__##name,{/*declareSomething*/ },{ /* declareOtherthing */ }) int

#define FOR_MACRO(NAME,FST_BLOCK,SND_BLOCK)\
  for(int NAME = ({FST_BLOCK ;0;}); NAME<1 ; NAME++,(SND_BLOCK)) 
```

它“实际上是卫生的”，尽管这意味着您在这些代码块中所做的任何事情都不会逃脱 for 循环范围。

# django - 模板中多对多关系的显示名称

> ID：15993791
> 
> 赞同：0
> 
> 时间：2013-04-13T22:48:41.817
> 
> 标签：django, django-models, django-templates, portable-executable

我尝试在模板中显示模型中的字段名称。这适用于除 ManyToManyField 之外的任何类型的字段。

我在我的 models.py 中使用这个函数来返回所有字段。

```
def get_all_fields(self):
    """Returns a list of all field names on the instance."""
    fields = []

    # only display fields with values and skip some fields entirely
        if f.editable and value and f.name not in ('id','lastname','firstname') :
            fields.append(
                {
                'label':f.verbose_name,
                'name':f.name,
                'value':value,
                })
    return fields 
```

在我的模板中，我使用这个循环来显示所有字段：

```
{% for f in modelname.get_all_fields %}
<td>{{f.label|capfirst}}</td><td>{{f.value|escape|urlize|linebreaks}}</td>
{% endfor %} 
```

如前所述，这适用于除 ManyToManyFields 之外的所有字段。例如，我的一个 M2M 关系如下所示：

```
family = models.ManyToManyField('family', related_name="family", null=True, blank=True) 
```

我会感谢每一个有助于解决这个问题的提示。

问候康拉德

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T23:27:33.300

尝试`verbose_name`为 ManytoManyfield 指定参数

```
family = models.ManyToManyField('family',verbose_name=u'trampampam', related_name="family", null=True, blank=True) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T23:32:23.383

您编写`{{f.value|escape|urlize|linebreaks}}`，它显示该字段的值。但是，M2M 关系的值是一组对象实例，您需要再次迭代该集合（如果这是您想要的结果）：

```
{% load m2m_filter %}

{% for f in modelname.get_all_fields %}
  <td>{{f.label|capfirst}}</td>
  <td>
    {% if f.value|is_m2m %}        
      {% for object in f.value.objects.all %}
        {{ object|escape|urlize|linebreaks }}
      {% endfor %}
    {% else %}
      {{f.value|escape|urlize|linebreaks}}
    {% endif %}
  </td>
{% endfor %} 
```

你还必须创建[过滤器](https://docs.djangoproject.com/en/dev/howto/custom-template-tags/#writing-custom-template-filters)

m2m_filter.py

```
from django import template
from django.db import models

register = template.Library()

def is_m2m(value):
    return type(value) == models.ManyToManyField *

register.filter('is_m2m', is_m2m) 
```

* 我猜，这是不同的类型；检查一下

# linux - “top”如何计算CPU使用率？

> ID：15993792
> 
> 赞同：2
> 
> 时间：2013-04-13T22:48:45.817
> 
> 标签：linux

我正在浏览 GNU/Linux 程序的源代码`top`。我试图了解它如何计算每个进程的 CPU 使用率，但我运气不佳。

有问题的源代码已在[GitHub 上](https://github.com/mmalecki/procps/)结束。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T23:02:52.160

与*procps*工具包中的所有其他内容一样，数据来自`/proc`虚拟文件系统，由操作系统和 Linux 内核管理。根本不涉及“计算”。

# php - 关于动态预加载的 Javascript 问题

> ID：15993793
> 
> 赞同：0
> 
> 时间：2013-04-13T22:48:56.167
> 
> 标签：php, javascript, preload

所以我使用一个中央“引擎”来运行 HTML5 游戏的内容。我可以将它放入我想要的任何框架中，它会处理所有绘图和设置画布等。为了使其尽可能用户友好，我使用 PHP 脚本来搜索所有特定于游戏的文件并添加它们。PHP 传递所有文件的 JSON 数组，然后通过 Javascript 将它们一一加载到游戏中。

听起来不错，并且现在已经在多个项目中运行良好，但突然间我发现某些文件需要以依赖于顺序的方式加载。我可以明确列出它们并加载它们（如引擎核心文件......），但这违背了动态加载它们的目的（用户友好）。

有什么方法可以定义先加载哪些？我已经看到了一个 jQuery 扩展，我想说它叫做 RequireJS，但老实说，它的文档有点让我头疼。我尝试实现它，但只是在错误之后遇到了错误。

有什么建议或有人尝试做类似的事情吗？

# javascript - Handlebars 模板 - 在 if 语句中呈现数据

> ID：15993797
> 
> 赞同：0
> 
> 时间：2013-04-13T22:49:27.520
> 
> 标签：javascript, handlebars.js, template-engine

对于车把（版本 1.0.0-rc.3）模板，我传递了两个变量，一个是 json，另一个是包含现场当前语言的字符串。

```
self.template = template({ data: self.model, lang:self.lang }); 
```

然后在我的模板文件中，我在 if 语句中显示 lang 变量时遇到了问题。所以我的模板结构如下：

```
 {{#each data}}    
     {{#if this.title}} 
          ...some html...
           <a class='links' href="{{../lang}}/work/{{this.id}}">View Project</a> 
          ...some html...
      {{/if}}
 {{/each}} 
```

我无法仅在 if 语句内部访问 lang 变量，而外部正在正确显示...请告知...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T23:07:17.727

我通过创建车把辅助函数找到了解决方案：

```
Handlebars.registerHelper( 'language'
                           , function() {
                                return self.lang;           
                             }); 
```

然后在模板中我可以`{{language}}`在需要的地方使用。

# ios6 - UIPanGestureRecognizer 和 BringSubviewToFront

> ID：15993799
> 
> 赞同：1
> 
> 时间：2013-04-13T22:49:54.130
> 
> 标签：ios6, uipangesturerecognizer

我有一个应用程序，用户点击一个按钮，该应用程序将实例化一个图像层（**UIImageView**）。我想这样做，以便用户可以移动选定的图像层，无论他们点击什么。在这里阅读了一些主题后，我了解到我可以使用**UIPanGestureRecognizer**来移动选定的图像层。

```
- (IBAction)buttonClicked:(id)sender {
    imageview = [[UIImageView alloc] initWithFrame:CGRectMake(100, 0, 300, 22)];
    UIPanGestureRecognizer *imageviewGesture = [[UIPanGestureRecognizer alloc] initWithTarget:self action:@selector(recognizePan:)];
    [imageviewGesture setMinimumNumberOfTouches:1];
    [imageviewGesture setMaximumNumberOfTouches:1];
    imageview.image = [UIImage imageNamed:@"pinimage.png"];
    [imageview addGestureRecognizer:imageviewGesture];
    [imageview setUserInteractionEnabled:YES];
    [self.view addSubview:imageview];
    NSUInteger currentag = [self UniqueTag]; // Assigning a unique integer
    imageview.tag = currentag;
}

- (void)recognizePan:(UIPanGestureRecognizer *)sender {
    [[[(UITapGestureRecognizer *)sender view] layer] removeAllAnimations];
    [self.view bringSubviewToFront:[(UIPanGestureRecognizer *)sender view]];
    CGPoint translatedPoint = [(UIPanGestureRecognizer *)sender translationInView:self.view];

    if([(UIPanGestureRecognizer *)sender state] == UIGestureRecognizerStateBegan) {     
        firstX = [[sender view] center].x;
        firstY = [[sender view] center].y;
    }

    translatedPoint = CGPointMake(firstX + translatedPoint.x,firstY + translatedPoint.y);
    [[sender view] setCenter:translatedPoint];
} 
```

现在，我无法弄清楚当有多个图像层时如何将点击层放在前面。[self.view bringSubviewToFront:[(UIPanGestureRecognizer *)sender view]] 似乎没有效果。那么如何修改我的代码，以便应用程序将点击层带到顶部呢？

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T01:16:29.653

一个很好的方法是创建 UIImageView 的 CustomImageView 子类。您将 UIPanGestureRecognizer 附加到 CustomImageView 的每个实例，并将该实例设置为它的目标。然后手势触发的动作方法是在视图本身实现的，这样就可以用 来引用视图`self`：

在`buttonClicked`

```
 MyImageView* imageview = [[MyImageView alloc] initWithFrame:CGRectMake(100, 0, 300, 22)];
    UIPanGestureRecognizer *imageviewGesture = 
    [[UIPanGestureRecognizer alloc] initWithTarget:imageview 
                                            action:@selector(recognizePan:)]; 
```

在`CustomImageView.m`

```
 - (void)recognizePan:(UIPanGestureRecognizer *)sender {
        [self.layer removeAllAnimations];
        [self.superview bringSubviewToFront:self];
        CGPoint translatedPoint = [sender translationInView:self];
        if([sender state] == UIGestureRecognizerStateBegan) {
            self.firstX = [self center].x;
            self.firstY = [self center].y;
        }
        translatedPoint = CGPointMake(self.firstX + translatedPoint.x,
                                      self.firstY + translatedPoint.y);
        [self setCenter:translatedPoint];
    } 
```

*更新*

不直接思考 - 你当然可以从 viewController 中执行此操作，就像你正在做的那样，通过访问`view`gestureRecongnizer 的属性。你的错误就在这里：

```
- (void)recognizePan:(UIPanGestureRecognizer *)sender {
     [[[(UITapGestureRecognizer *)sender view] layer] removeAllAnimations]; 
```

您正在将发件人类型从 更改`UIPanGestureRecognizer`为`UITapGestureRecognizer`。事实上，您不需要`sender`在方法体中进行任何类型转换。

# android - 如何更新 PagerAdapter 中选定的答案单选按钮？

> ID：15993800
> 
> 赞同：0
> 
> 时间：2013-04-13T22:50:09.360
> 
> 标签：android, android-viewpager, android-pageradapter

一旦选择了 3 个单选按钮之一，我就会尝试更新页面的视图，以便当我再次进入该视图时，我已经检查了该答案。我以滑动视图的形式正确获取所有数据，但是当我再次滑动回到同一个问题时，我选择的答案未显示。

**我的活动.java**

```
 MyQuizPagerAdapter adapter = new MyQuizPagerAdapter(questions,num_rows,quiz_subject,actionBar);
    ViewPager myPager = (ViewPager) findViewById(R.id.home_pannels_pager_quiz);
    myPager.setAdapter(adapter); 
```

**MyQuizAdapter.java**

```
public class MyQuizPagerAdapter extends PagerAdapter {

String[][] questions;
int num_rows;
String quiz_subject;
ActionBar actionBar;
int position1;

public MyQuizPagerAdapter(String[][] questions, int num_rows, String quiz_subject, ActionBar actionBar)
{
    this.questions=questions;
    this.num_rows=num_rows;
    this.quiz_subject=quiz_subject;
    this.actionBar=actionBar;
}
// State number of pages
@Override
public int getCount() {
    return num_rows;
}

// Set each screen's content
@Override
public Object instantiateItem(View container, int position) {
    Context context = container.getContext();
    LinearLayout layout = new LinearLayout(context);
    actionBar.setSubtitle(questions[position][5]);
    position1=position;
    TextView textItem2 = new TextView(context);
    textItem2.setTextSize(20);
    textItem2.setTypeface(null, Typeface.BOLD);
    textItem2.setText("Question: "+(position+1));
    textItem2.setPadding(20, 0, 0, 0);

    TextView textItem = new TextView(context);
    //textItem.setGravity(Gravity.CENTER);
    textItem.setTextSize(13);
    textItem.setTypeface(null, Typeface.BOLD);
    textItem.setPadding(20, 20, 20, 40);

    textItem1.setTextSize(15);
    textItem1.setPadding(20, 50, 20, 20);*/

    RadioButton button1 = new RadioButton(context);
    RadioButton button2 = new RadioButton(context);
    RadioButton button3 = new RadioButton(context);
    button1.setTextSize(12);
    button2.setTextSize(12);
    button3.setTextSize(12);
    button1.setPadding(45, 5, 5, 7);
    button2.setPadding(45, 5, 5, 7);
    button3.setPadding(45, 5, 5, 7);
    button1.setId(R.id.Option1);
    button2.setId(R.id.Option2);
    button3.setId(R.id.Option3);

    RadioGroup rg = new RadioGroup(context);

    switch(Integer.parseInt(questions[position][7]))
    {
        case 0:
            break;
        case 1:
            rg.check(R.id.Option1);
            break;
        case 2:
            rg.check(R.id.Option2);
            break;
        case 3:
            rg.check(R.id.Option3);
            break;
        default:
            break;
    }

    layout.setLayoutParams(new LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));
    layout.setOrientation(LinearLayout.VERTICAL);

    rg.setOnCheckedChangeListener(new RadioGroup.OnCheckedChangeListener() {

        @Override
        public void onCheckedChanged(RadioGroup group,
                int checkedId) {

            switch (checkedId) { //set the Model to hold the answer the user picked
            case R.id.Option1:
                questions[position1][7]="1";
                actionBar.setSubtitle("option1");
                break;
            case R.id.Option2:
                questions[position1][7]="2";
                actionBar.setSubtitle("option2");
                break;
            case R.id.Option3:
                questions[position1][7]="3";
                actionBar.setSubtitle("option3");
                break;
            default:
                questions[position1][7]="0"; // Something was wrong set to the default
                actionBar.setSubtitle("error");
                break;
            }
        }
    });

textItem.setText(questions[position][1]);
button1.setText("A: "+questions[position][2]);
button2.setText("B: "+questions[position][3]);
button3.setText("C: "+questions[position][4]);
//textItem1.setText(content);
rg.addView(button1);
rg.addView(button2);
rg.addView(button3);
layout.addView(textItem2);
layout.addView(textItem);
//layout.addView(textItem1);
layout.addView(rg);
((ViewPager) container).addView(layout, 0); // This is the line I added
return layout;
}

@Override
public void destroyItem(View arg0, int arg1, Object arg2) {
    ((ViewPager) arg0).removeView((View) arg2);
}

@Override
public boolean isViewFromObject(View arg0, Object arg1) {
    return arg0 == ((View) arg1);
}

@Override
public Parcelable saveState() {
    return null;
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-15T11:05:06.250

View Pager 回收（重新生成）视图（因此您没有得到选中哪个单选按钮的状态）

一种解决方案是再创建一个`arraylist`将保存状态并在`instantiateItem()`检查中将其`arraylist`更新为 View Pager 当前项目。

获得单击的按钮后，将该值存储到一个变量中。检查该`instantiateItem()`变量并更新单选按钮的 UI。

# html - 将两个图像与文本对齐

> ID：15993811
> 
> 赞同：1
> 
> 时间：2013-04-13T22:51:45.667
> 
> 标签：html, css

[我想将本网站http://paulcwebster.com](http://paulcwebster.com)顶部的两张图片 与它们旁边的文字对齐。

到目前为止，我能够将两个图像并排对齐，但我遇到了以下问题：

1) 文本在图像之间没有任何空格。

2) 对于不同浏览器上的图像，文本太短或太长。

3) 文字大小与图片位置不匹配

4）无法将文本“Recent Publications”向左移动（我已经尝试了 align="left" 并将其放入它自己的 div 中）

这是我的代码：

```
<div >
 <img src="gfx/FrontImage1.jpg" width="180" height="180" alt="Image1"  style="float:left">  
 <img src="gfx/FrontImage3.jpg" width="180" height="180" alt="Image2" style="float:left"> 

 <span ><p>Paul Christopher Webster is a freelance writer and documentary film director based in Toronto, Canada.  He has reported from 20 countries since 1992.</p>
Paul's work in film has appeared on the Arte, BBC, CBC, Deutsche Welle, Discovery, National Geographic, Slice, SWR and Vision Television networks. His work as a writer has been published in dozens of magazines, journals and newspapers across Canada, the U.S, and Europe. </p>
<p>He has won four national magazine awards for his writing, and Tier One Journalism Award from the Canadian Institutes of Health Research. His work on documentary films has garnered awards from the Canadian Association of Journalists, Hot Docs, the Canadian Academy of Film and Television, and PARISCIENCE, the international festival of scientific films.
<p>Paul&rsquo;s work focuses on themes in business, science, and politics. For samples of his work in these categories, please click on the links to articles below.
</span>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T23:04:40.050

首先，我建议重组您的 HTML 标记。`<div>`在要控制的每个元素周围放置一个或其他块级元素。像这样的东西：

```
<div class="container">
    <div class="photos">
      <img src="gfx/FrontImage1.jpg" width="180" height="180" alt="Image1">
      <img src="gfx/FrontImage3.jpg" width="180" height="180" alt="Image2">
    </div>
    <div class="text">
      Your text goes here...
    </div>
</div> 
```

然后，编写一些 CSS 来以您想要的方式控制这些元素：

```
.container {
    overflow:hidden; // this keeps the floated objects inside the container
    padding:5px;
    border:solid 1px black;
}

.container .photos {
    float:left;
    margin-right:10px; // this puts some padding to the right of the photos
} 
```

我在这里假设您知道如何包含样式表以将上述 CSS 应用到您的页面。这应该可以解决问题 1) 和 4)。确实没有任何方法可以确保文本的大小始终与图像的高度匹配，因为它可以流动和改变，具体取决于浏览器的宽度和查看器使用的字体大小，所以我看不到解决问题 2) 和 3) 的方法。

注意：我看到您正在使用一个`<span>`元素来包含您的`<p>`元素。这是无效标记，因为 a`<span>`是内联元素，而 a`<p>`是块级元素。内联元素不能包含块级元素。

# java - 使用java解析json

> ID：15993812
> 
> 赞同：0
> 
> 时间：2013-04-13T22:51:58.257
> 
> 标签：java, json

```
{
    "Items": [{
            "__type": "Section1:#com.test.example",
            "Info": {            
            }, {
            "__type": "Section2:#com.test.example2",
            "Allergy": [{

            }]

            }
      }]

} 
```

我如何解析上面的 JSON 对象，以便我得到 Info 项和 Allergy 项....

```
JSONObject documentRoot = new JSONObject(result);
JSONArray documentChild = documentRoot.getJSONArray("Items");
JSONObject child = null;
for (int i = 0; i < documentChild.length(); i++) {
    child = documentChild.getJSONObject(i);

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T23:03:34.923

这是有效的 JSON：在此处检查有效性：http: [//jsonlint.com/](http://jsonlint.com/)

```
{
    "Items": [
        {
            "__type": "Section1:#com.test.example",
            "Info": {}
        },
        {
            "__type": "Section2:#com.test.example2",
            "Allergy": [
                {}
            ]
        }
    ]
} 
```

尝试 ：

```
public static final String TYPE_KEY = "__type";
public static final String TYPE1_VAUE = "Section1:#com.test.example";
public static final String TYPE2_VAUE = "Section2:#com.test.example2";

public static final String INFO_KEY = "Info";
public static final String ALLERGY_KEY = "Allergy";

....

String infoString = null;
JSONArray allergyArray = null;

for (int i = 0; i < documentChild.length(); i++) {
    child = documentChild.getJSONObject(i);

    final String typeValue = child.getString(TYPE_KEY);

    if(TYPE1.equals(typeValue)) {
        infoString = child.getString(INFO_KEY);
    }else if(TYPE2.equals(typeValue)) {
        allergyArray = child.getJSONArray(ALLERGY_KEY);
    }
}

if(null != infoString) {
    // access the 'Info' value in 'infoString'
}

if(null != allergyArray) {
    // access the 'Allergy' array in 'allergyArray'
}

... 
```

希望这可以帮助！

# iphone - UIImageView 中具有 3 分辨率的背景

> ID：15993814
> 
> 赞同：0
> 
> 时间：2013-04-13T22:52:03.800
> 
> 标签：iphone, ios, objective-c, interface-builder

我的背景中有背景`UIImageView`，我用三种分辨率的图像`UIViewController`设置了这个背景：`Interface builder`

```
1) bg.png
2) bg@2x.png
3) bg-568@2x.png 
```

我注意到当我在 iPhone 5 上运行我的应用程序时，背景是 bg.png 而不是 bg-568@2x。知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T22:56:57.323

如该线程所述，后缀 -568h 仅适用于默认图像（启动画面）。

[iPhone 5 的新图像名称](https://stackoverflow.com/questions/12497776/new-image-name-for-iphone-5)

# ios - UIWebView 显示没有内容的黑屏

> ID：15993815
> 
> 赞同：3
> 
> 时间：2013-04-13T22:52:13.197
> 
> 标签：ios, objective-c, cocoa-touch, uiwebview, uikit

我从 IB 创建了一个 UIWebView 并将其子类化为我的需要。在我的应用程序中的某个地方，我正在使用以下代码：

```
_mainWebView = nil;
_mainWebView = [[MyWebView alloc] initWithFrame:CGRectMake(0,0,320,460)];
_mainWebView.delegate = self;
NSURL *url = [NSURL URLWithString:@"http://www.google.com"];
NSURLRequest *request = [NSURLRequest requestWithURL:url];
[_mainWebView loadRequest:request]; 
NSLog(@"WebView: %@", _mainWebView); //->> WebView: <MyWebView: 0x15403000; baseClass = UIWebView; frame = (0 0; 320 548); layer = <CALayer: 0x1544dac0>> 
```

这给了我一个没有内容的黑屏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T23:23:24.943

```
_mainWebView = [[MyWebView alloc] initWithFrame:CGRectMake(0,0,320,460)]; 
```

上面的代码行告诉您创建一个新的 MyWebView，所有从 IB 连接的连接都将在此处断开连接。你可以通过以下方式展示它：

```
[self.view addSubview:_mainWebView]; 
```

如果您从 IB 中绘制并连接，只需将 init 注释掉一个新的

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T23:06:34.067

这很可能是因为您将 _mainWebView 设置为 nil。这几乎意味着你“拔掉”你从 Interface Builder 连接的插座。因此，您在此代码中配置的 Web 视图根本没有连接到屏幕。有两个选项可供您选择：

1) 使用 Interface Builder，连接出口，并删除上面代码片段中的前两行代码。

2) 从 Interface Builder 中移除 web 视图，移除上面代码片段中的第一行代码，并`[self.view addSubview:_mainWebView];`在加载请求之前添加。

顺便说一句，我相信[UIWebView](http://developer.apple.com/library/ios/ipad/#documentation/uikit/reference/UIWebView_Class/Reference/Reference.html)不能被子类化，至少在 App Store 版本中是这样。在未来的 iOS 中，它可能会被破坏......

我希望这可以帮助你！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-08-11T10:38:50.490

我遇到了同样的问题，

我的问题是，我放置在情节提要上的 Web 视图跨越了视图控制器的边界。当我将它拉回视图控制器时，它工作正常。

# python - 无法使用 Pymongo 插入 MongoDB

> ID：15993818
> 
> 赞同：1
> 
> 时间：2013-04-13T22:52:35.743
> 
> 标签：python, mongodb

我正在尝试将数据插入 MongoDB 数据库。我正在使用以下最小工作示例：

```
import pymongo
conn = pymongo.Connection()
db = conn.xxx
db.xxx.insert({'foo': 'bar'}) 
```

执行代码时会生成数据库`xxx`，但没有插入任何内容。我可以从 MongoDB 命令行插入，但不能通过 Python。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T22:57:31.677

您缺少右括号。:)

另外，第二个 xxx 不是数据库。它是一个集合。

# c - 为什么第二个 scanf 在我的程序中不起作用？

> ID：15993828
> 
> 赞同：7
> 
> 时间：2013-04-13T22:54:32.793
> 
> 标签：c, scanf

scanf("%d %c",&size,&chara); 有效，但单独的用于字符输入的 scanf 不起作用。我在代码中显示这些。这是为什么？

```
void squareCustomFill(int size, char chara);

int main(void) {

int size,i,k;
char chara;

printf("Enter size of square: ");   //This works
scanf("%d %c",&size,&chara);

//printf("Enter fill character: ");      BUT WHY DOES NOT THIS WORK??
//scanf("%c",&chara);

squareCustomFill(size,chara);

return 0;

 }

void squareCustomFill(int size, char chara){

int i,k;

for (k=1;k<=size;k++){

    for(i=1;i<=size;i++)
        printf("%c",chara);
        printf("\n");

 }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-13T22:56:07.580

Scanf 没有消耗`\n`第一次 scanf 调用后留在缓冲区中的字符。

所以第二次 scanf 调用做到了。

您必须在再次阅读之前清除标准输入，或者只是摆脱换行符。

第二个电话应该是

```
scanf(" %c",&chara);
       ^ this space this will read whitespace charaters( what newline also is) until it finds a single char 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T23:06:41.010

是的，我相信阿明是正确的。scanf 将读取空格（空格键、换行符等）。当您输入值时，如果您单击空格键或在第一个 scanf 之后立即输入，第二个 scanf 将读取该值（空格、换行符等）。所以你用 scanf("%d %c",&size,&chara) 解决了这个问题，因为 %d 和 %c 之间有一个空格。如果您希望它们分开，只需按照 Armin 的建议进行操作：scanf("%c",&chara)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-24T05:35:19.323

在它们之间扔一个**getchar()**并吞下那个无关的换行符。

# php - 如何显示特定用户 ID 的所有数据？

> ID：15993830
> 
> 赞同：-1
> 
> 时间：2013-04-13T22:54:37.837
> 
> 标签：php, mysql

我`users_points`在 MySQL 中调用了表：

![](https://i.stack.imgur.com/myVUH.png)

我试图显示与用户相关的所有数据`id=2`

![](https://i.stack.imgur.com/HpsN0.png)

但我找不到最`SELECT`适合这份工作的人。

我试过了：

```
SELECT * FROM users where id=2 
```

但它只是给了我表中的第一行，而不是所有行。

任何人都可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-13T23:01:11.083

您的查询一切正常，如果您使用 PHP 输出信息使用周期，
您应该搜索它不输出所需信息的其他原因！
`while`

例如（如果您使用 PHP 输出数据）：

```
<?php 
    $query = "SELECT * FROM users where id=2";
    if($result = $mysqli->query($query)){
        while($row = $result->fetch_assoc()){
            echo '#'.$row['id'].' - '$row['name'].' - '.$row['points'].' - '.$row['date'].'<br />';
        }
    }
?> 
```

# jquery - 以 $(this) 作为元素的 jQuery 选择器

> ID：15993832
> 
> 赞同：0
> 
> 时间：2013-04-13T22:54:54.110
> 
> 标签：jquery, jquery-plugins, css-selectors

我在插件中找到了这种形式的选择器，谁能给我解释一下？

```
var container = $(this);
var myDiv = $('div', container); 
```

这个想法是只选择`div`元素，为什么它也有`container`变量？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T22:57:41.480

这是选择器的上下文，就像做一个`.find()`

例子：

```
$("#selector", context) = $(context).find("#selector") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T22:58:58.687

这个问题和答案似乎可以满足您对解释的要求。 [如何获取 $(this) 选择器的孩子？](https://stackoverflow.com/questions/306583/this-selector-and-children). 本质上：jQuery 构造函数接受第二个参数，该参数可用于覆盖选择的上下文。

# math - 如何在给定视图方向和光标位置变化的情况下平移 3d 网格

> ID：15993833
> 
> 赞同：1
> 
> 时间：2013-04-13T22:55:06.143
> 
> 标签：math, opengl, geometry, translation, user-interaction

我的问题类似于[透视投影 (OpenGL) 中的 3D 场景平移，](https://stackoverflow.com/questions/12097693/3d-scene-panning-in-perspective-projection-opengl)但我不知道如何计算移动网格的方向。

我有一个可以选择各种网格的程序。选择网格后，我希望它在单击拖动光标时进行平移。当光标向上移动时，我希望网格向上移动，以此类推为适当的方向。换句话说，我希望网格沿着垂直于观察方向的平面平移。

我在光标位置有 Delta (x,y) 的 Vector2，我有相机的 Vector3 viewDirection 和网格的中心。如何确定使用 Delta 和 viewDirection 在 3d 空间中转换网格的方式？我是否需要其他信息才能进行此计算（例如向上或眼睛）？

如果翻译的比例关闭也没关系，我现在只是想弄清楚方向。

编辑：出于某种原因，我对向上方向感到困惑。显然，它可以通过将相机旋转应用于指定的透视向上向量来计算。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T17:00:32.903

您将需要一个额外的向量 ，`upDirection`它是从您的相机“向上”指向的单位向量。您现在可以交叉乘积`viewDirection`并`upDirection`得到`rightDirection`，从您的相机指向“右”的向量。

您想将`y`增量映射到沿`upDirection`(或`-upDirection`) 的运动，并将`x`增量映射到沿 的运动`rightDirection`。这些向量在世界空间中。

您可能希望缩放平移速度以匹配鼠标速度。如果您使用透视投影，您需要根据模型相对于相机的深度来缩放平移速度（对象离相机越远，如果您希望它与鼠标匹配，则需要移动得越快.)

# google-apps-script - Google Apps 脚本：根据用户电子邮件显示单列

> ID：15993834
> 
> 赞同：0
> 
> 时间：2013-04-13T22:55:09.843
> 
> 标签：google-apps-script

我正在尝试使用 Google Spreadhseets 开发成绩簿，但我只想根据用户电子邮件显示个人成绩。是否有一个 Google Apps 脚本功能可以查看已登录用户的电子邮件，在电子表格中搜索它（它将位于列的顶部），然后将该列显示给用户？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T10:33:41.207

我认为最好的解决方案可能是创建一个仅在 html 表中显示相关列的小型 webapp Ui。根据您的编程技能，它可以很容易设置。我本可以提出一个示例，但是您提供的有关电子表格中数据类型的信息太少...用户的数据在单个列中，但我想还有某种标题或行标识符必须显示给了解显示的内容吗？

用户必须授权 webapp 才能让您在他们登录时识别他们。

* * *

**编辑：**这里是一个可能的解决方案的简单示例，您可以从它开始。

我假设邮件在第 1 行，A 列中的描述。

```
var ss = SpreadsheetApp.openByUrl('https://docs.google.com/spreadsheet/ccc?key=0AnqSFd3iikE3dGdQOXZpRmJnT0xjQklkdEZING5YREE#gid=0');
var sh1 = ss.getSheetByName('sheet1');
var logsheet = ss.getSheetByName('logsheet');
var data = sh1.getDataRange().getValues();
var user = Session.getEffectiveUser()

function doGet() {
       var app = UiApp.createApplication();
       if(!getcol(user)){
          var warn = app.createTextBox().setWidth('500').setValue("Your results are not available or you don't have permission to view these data");// if user is not in the list, warning + return
app.add(warn)
return app
          }
       var grid = app.createGrid(data.length, 2).setBorderWidth(1).setCellPadding(2);
       var text = app.createTextBox().setName('text').setId('text').setValue(user+'  | idx'+getcol(user) ).setWidth('300px');
       var btn = app.createButton('press here to confirm you have view these results');
       var handler = app.createServerHandler('log').addCallbackElement(grid);
       btn.addClickHandler(handler);
       var col = getcol(user)
       grid.setWidget(0,1,text).setText(0, 0, 'Results for');
       grid.setStyleAttribute('textAlign','center')
       for(n=1;n<data.length;++n){
         grid.setText(n, 0, data[n][0])
         grid.setText(n, 1, data[n][col])
         }
       app.add(grid).add(btn)
       return app
    }

function log(e){
      var text = e.parameter.text
      var app = UiApp.getActiveApplication();
    // add user name to the log sheet + timestamp + eventually send a mail etc...
    return app
    }

function getcol(mail){
  if(data[0].toString().indexOf(mail.toString())!=-1){
  for(zz=1;zz<data[0].length;++zz){
    if(data[0][zz] == mail){var colindex=zz;break}
  }
   return colindex
  }
  return false
} 
```

**EDIT2：** 要打印具有所需小数位数的数字，您可以使用最近实现的`printf`功能，如下所示：

```
grid.setText(n, 1, Utilities.formatString('%.2f',data[n][col]));// 2 decimals, no leading 0 
```

显示您想要使用的日期`formatDate()`

```
Utilities.formatDate(date, Session.getTimeZone(), "MM-dd") 
```

* * *

**编辑3：**

这是一个处理不同类型数据的版本：

```
var ss = SpreadsheetApp.openByUrl('https://docs.google.com/spreadsheet/ccc?key=0AnqSFd3iikE3dGdQOXZpRmJnT0xjQklkdEZING5YREE#gid=0');
var sh1 = ss.getSheetByName('sheet1');
var logsheet = ss.getSheetByName('logsheet');
var data = sh1.getDataRange().getValues();
var user = Session.getEffectiveUser()
Logger.log(user)

function doGet() {
       var app = UiApp.createApplication();
       if(!getcol(user)){
          var warn = app.createTextBox().setWidth('500').setValue("Your results are not available or you don't have permission to view these data");// if user is not in the list, warning + return
app.add(warn)
return app
          }
       var grid = app.createGrid(data.length, 2).setBorderWidth(1).setCellPadding(2).setStyleAttribute('background','#ffeeaa').setId('grid');
       var text = app.createTextBox().setName('text').setId('text').setValue(user+'  | idx'+getcol(user) ).setWidth('300px');
       var btn = app.createButton('press here to confirm you have view these results');
       var handler = app.createServerHandler('log').addCallbackElement(grid);
       btn.addClickHandler(handler);
       var col = getcol(user)
       grid.setWidget(0,1,text).setText(0, 0, 'Results for');
       grid.setStyleAttribute('textAlign','center')
       for(n=1;n<data.length;++n){
         grid.setText(n, 0, string(data[n][0]));
         grid.setText(n, 1, string(data[n][col]));
         }
       grid.setStyleAttributes(n-1, 0, {'fontWeight':'bold','background':'#ffff99'})
       grid.setStyleAttributes(n-1, 1, {'fontWeight':'bold','background':'#ffff99'})
       app.add(grid).add(btn)
       return app
    }

function log(e){
      var text = e.parameter.text
      var app = UiApp.getActiveApplication();
      app.getElementById('grid').setStyleAttribute('background','#bbffbb')
    // add user name to the log sheet + timestamp + eventually send a mail etc...
    return app
    }

function string(value){
Logger.log(typeof(value))
if (typeof(value)=='string'){return value};// if string then don't do anything
if (typeof(value)=='number'){return Utilities.formatString('%.1f / 20',value)};// if number ther format with 1 decimal
if (typeof(value)=='object'){return Utilities.formatDate(value, Session.getTimeZone(), "MM-dd")};//object >> date in this case, format month/day
return 'error'
}

function getcol(mail){
  if(data[0].toString().indexOf(mail.toString())!=-1){
  for(zz=1;zz<data[0].length;++zz){
    if(data[0][zz] == mail){var colindex=zz;break}
  }
   return colindex
  }
  return false
} 
```

# java - 计数器计数不正确

> ID：15993838
> 
> 赞同：0
> 
> 时间：2013-04-13T22:55:41.083
> 
> 标签：java, android

我有 8 对按钮（总共 16 个），其中一些术语来自 sqlite 数据库。我需要当用户连接 8 对（正确或错误，没关系）结束游戏时，最后会有一些弹出窗口。当我在我的代码中放置 counter<7 时，我需要连接 8 对 plus 才能再次单击某些按钮（单击 17 次）。如果我输入计数器<6，那么我会在 7 对和再单击一次（15 次单击）后弹出我的窗口。我不明白这个逻辑。所以这里是代码：

```
final OnClickListener clickListener = new OnClickListener() {

        private Button buttonClicked;

        public void onClick(View v) {
            if (counter < 7) {
                Button button = (Button) v;
                button.getBackground()
                      .setColorFilter(new LightingColorFilter(0xFFFFFFFF, 0x003333));

                if (buttonClicked == null) {
                    // first button is clicked
                    buttonClicked = button;

                    // only do stuff if buttons are in different layouts
                } else {
                    if (!button.getParent().equals(buttonClicked.getParent())) {
                        // second button is clicked

                        if (buttonClicked.getTag().equals(button.getTag())) {

                            // second button is clicked and same tag but different button

                            Toast.makeText(Spojnice.this, "Correct", Toast.LENGTH_SHORT).show();
                            button.getBackground()
                                  .setColorFilter(new LightingColorFilter(0xFFFFFFFF, 0x66FF33));
                            buttonClicked.getBackground().setColorFilter(
                                new LightingColorFilter(0xFFFFFFFF, 0x66FF33));
                            buttonClicked.setEnabled(false);
                            button.setEnabled(false);
                            buttonClicked = null;
                            score.setText("Poeni: " + brojPoenaSpojnice);
                            counter++;
                        } else {
                            counter++;
                            //reset LightingColorFilter first
                            button.setEnabled(false);
                            Toast.makeText(Spojnice.this, "Wrong", Toast.LENGTH_SHORT).show();
                            buttonClicked = null;

                        }

                    } else {
                        //same button clicked show message or un toggle?

                        buttonClicked = button;
                    }
                }
            } else {
                Intent i = new Intent(Spojnice.this, Popup_spojnice.class);
                startActivity(i);
                mHandler.postDelayed(mLaunchTask, 6500);
            }
        }

    }; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T04:45:45.330

由于您首先检查计数器，然后将其递增，因此在连接 7 对后，您的计数器将为 6（仍然 <7）。下次您增加计数器时，它将为 7，您的第一个条件将为假，但只会在下一轮再次检查。

要解决它，您应该在增加计数器之后而不是之前**检查**`if (counter < 7)`条件 ( ) 。

# python - for循环下的if语句

> ID：15993840
> 
> 赞同：-2
> 
> 时间：2013-04-13T22:56:01.253
> 
> 标签：python, loops, conditional

如何在for循环中使用两个if条件语句

```
a = [1,2,3,4,5]

for i in a:
    if a[0] == 1:
       a[0] = ("Good")
    elif a[3] == 4 
       a[3] == ("Is Good TOo") 
```

我想把这两个都打印出来，但循环会停在`if a[0]==1` 我怎么可能让它像 `a = ['Good',2,3,'Is Good TOo', 5]`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T23:00:32.687

你的最后一行有错字。修正是

```
a[3] = ("Is Good TOo") 
```

一般来说，==是比较运算符，=是赋值运算符

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T23:00:43.783

你的底线应该只有 1 = (1 用于设置变量，两个 if 用于比较两个变量)，你的 elif 需要一个 : 最后

```
elif a[3] == 4:
    a[3] = ("Is Good TOo") 
```

如果您像这样遍历索引值，这个循环实际上会更有意义：

```
a = [1,2,3,4,5]
for i in range(0, len(a)):
  if i == 0:
    a[i] = "Good"
  elif i == 3:
    a[i] = "Is Good TOo" 
```

否则，如果您一开始就在那里有一个字符串索引，则该函数将失败。根据索引值，上面的示例将始终有效，我认为这基本上是您的目标！

# python - 拆分字符串，反转然后在python中加入字符串

> ID：15993842
> 
> 赞同：0
> 
> 时间：2013-04-13T22:56:10.057
> 
> 标签：python, function, join, reverse, split

我想拆分一个字符串，将其反转并用 X 而不是函数中的空格将其连接回来。

例如。

'谁在看守望者 -> 到 -> SEHCTAWXOHWXSREHCTAWXEHT'

```
str = ("WHO WATCHES THE WATCHERS")
str = str.split(' ',4)
str.reverse()
print str

str = 'X'
seq = ("who", "watches", "the", "watchers")
print str.join(seq) 
```

但这只会让我：

**['WATCHERS'，'THE'，'WATCHES'，'WHO']**

**whoXwatchesXtheXwatchers**

当我想要**“SEHCTAWXOHWXSREHCTAWXEHT”时**

请用简单的功能代码回复。我是这方面的初学者。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-13T23:02:43.800

您的代码正在颠倒单词的顺序，而不是实际单词本身。尝试这个：

```
def reverse_and_join(s):
  return "X".join(s[::-1].split(" ")) 
```

此代码反转整个字符串，将其用空格分隔，然后将反转单词的反转列表与“X”连接起来。有关语法的解释，请参阅[此问题。](https://stackoverflow.com/questions/931092/reverse-a-string-in-python)`[::-1]`

# midi - 从 midstatus 获取 MIDI 通道

> ID：15993856
> 
> 赞同：0
> 
> 时间：2013-04-13T22:57:48.027
> 
> 标签：midi, coremidi

我知道这应该很容易，但是...我正在尝试从 midiStatus 消息中获取 MIDI 通道号。

我收到了 MIDI 信息：

```
MIDIPacket *packet = (MIDIPacket*)pktList->packet;

 for(int i = 0; i<pktList->numPackets; i++){  
      Byte midiStatus = packet->data[0];
      Byte midiCommand = midiStatus>>4; 

      if(midiCommand == 0x80){} ///note off
      if(midiCommand == 0x90){} ///note on
} 
```

我试过了

```
 Byte midiChannel = midiStatus - midiCommand 
```

但这似乎并没有给我正确的价值观。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-13T23:15:52.830

首先，并不是所有的 MIDI 信息都有通道。（例如，时钟消息和 sysex 消息没有。）带有频道的消息称为“语音”消息。

为了确定任意 MIDI 消息是否为语音消息，您需要检查第一个字节的前 4 位。然后，一旦你知道你有一条语音消息，通道就在第一个字节的低 4 位。

语音信息在`0x8n`和之间，频道`0xEn`在哪里。`n`

```
Byte midiStatus = packet->data[0];
Byte midiCommand = midiStatus & 0xF0;  // mask off all but top 4 bits

if (midiCommand >= 0x80 && midiCommand <= 0xE0) {
    // it's a voice message
    // find the channel by masking off all but the low 4 bits
    Byte midiChannel = midiStatus & 0x0F;

    // now you can look at the particular midiCommand and decide what to do
} 
```

另请注意，消息中的 MIDI 通道介于 0-15 之间，但通常向用户显示为介于 1-16 之间。在向用户显示频道之前，您必须加 1，如果您从用户那里获取值，则必须减 1。

# git - git 创建带差异的补丁

> ID：15993861
> 
> 赞同：48
> 
> 时间：2013-04-13T22:58:30.093
> 
> 标签：git, patch

我试着做

```
git diff 13.1_dev sale_edit > patch.diff 
```

然后我尝试`git apply patch.diff`在另一个分支中做，但我得到的补丁不适用。如何从可以与 git apply 一起使用的差异创建补丁文件？

收到的错误：

```
$ git apply --ignore-space-change --ignore-whitespace diff.diff 
diff.diff:9: trailing whitespace.

diff.diff:10: trailing whitespace.
    function set_change_sale_date() 
diff.diff:12: space before tab in indent.
      $this->sale_lib->set_change_sale_date($this->input->post('change_sale_date'));
diff.diff:14: trailing whitespace.

diff.diff:15: trailing whitespace.
    function set_change_sale_date_enable() 
warning: application/controllers/sales.php has type 100755, expected 100644
error: patch failed: application/controllers/sales.php:520
error: application/controllers/sales.php: patch does not apply
warning: application/language/english/sales_lang.php has type 100755, expected 100644
error: patch failed: application/language/english/sales_lang.php:134
error: application/language/english/sales_lang.php: patch does not apply
warning: application/libraries/Sale_lib.php has type 100755, expected 100644
error: patch failed: application/models/sale.php:170
error: application/models/sale.php: patch does not apply
warning: application/views/sales/register.php has type 100755, expected 100644
error: patch failed: application/views/sales/register.php:361
error: application/views/sales/register.php: patch does not apply 
```

我在 Mac 上试试这个

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-04-14T00:07:26.230

尝试一个：

```
git apply --ignore-space-change --ignore-whitespace patch.diff 
```

如“ [git:patch does not apply](https://stackoverflow.com/a/4832785/6309) ”中所述，这可能是由以下原因引起的：

*   本地文件系统和远程仓库之间的行尾不同。
    文件中的用户`core.eol`是`.gitattributes`一个很好的方法（请参阅“ [git force file encoding on commit](https://stackoverflow.com/a/14772232/6309) ”）
*   执行位（' `x`'）。
    这可能会导致您设置`git config core.filemode false`，然后是 a `git reset --hard HEAD`（确保您没有未提交的更改，否则它们会丢失）。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2015-03-07T12:45:04.427

您可以将补丁应用为 3 路合并：

```
git diff 13.1_dev sale_edit > patch.diff
git apply -3 patch.diff 
```

它应该会引发冲突，以便您可以手动解决。或者您可以使用单线，将补丁直接通过管道传递到 git-apply：

```
git diff 13.1_dev sale_edit | git apply -3 
```

要反转补丁：

```
git diff 13.1_dev sale_edit | git apply -3 -R 
```

（注意：这和上面的命令一样，没有创建补丁文件的两阶段过程）

```
git help apply

-3, --3way           
When the patch does not apply cleanly, fall back on 3-way merge if 
the patch records the identity of blobs it is supposed to apply to, 
and we have those blobs available locally, possibly leaving 
the conflict markers in the files in the working tree for the user 
to resolve... 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-07T09:07:26.583

在这里，您必须使用具有差异的分支进行尝试。

```
git diff 13.1_dev sale_edit > patch.diff yourBranch() 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-01-08T22:23:21.990

在 git 版本 1.9.1 中，当使用“git apply”应用使用“git diff”创建的补丁时，我看到了类似的抱怨。

似乎 1.9.1 git 在处理补丁文件中的空格和制表符混合时遇到了问题。

`warning: squelched 1 whitespace error warning: 6 lines add whitespace errors.`

@VonC 的回答没有帮助，我仍然收到同样的警告。

最简单的解决方案是简单地使用“**补丁**”命令，该命令成功地将“git diff”输出中捕获的所有更改应用到目标 git 目录。

`$ patch --version GNU patch 2.7.1`

# php - PHP - 为散列发送密码盐

> ID：15993865
> 
> 赞同：3
> 
> 时间：2013-04-13T22:59:35.697
> 
> 标签：php, send, salt

我的数据库为每个用户存储唯一的盐。

我正在为一个应用程序在 php 中创建一个登录脚本，其中每个用户都有自己独特的盐，这就是我计划实现登录的方式。

1.  用户输入详细信息并发送它们
2.  发送用户名并通过脚本检查它是否存在
3.  如果是，则返回该用户的盐，否则返回一般错误

**我需要脚本为该用户返回盐，否则当我的应用无法在没有盐的情况下散列密码并将其发回时，我的应用程序将如何验证提交的密码是否正确？**

现在这就是我不确定的。盐是否被加密是否重要，因为黑客可以看到它是什么并看到密码哈希，也许可以用它做点什么。我应该在发送之前加密盐吗？

也许我不理解/忽略以下回复中的某些内容。

需要的建议请。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T23:56:42.533

您的盐是散列还是保留为纯字符串都**没有关系- 重要的是，对密码进行加盐可以防止直接使用字典/彩虹表攻击来暴力破解密码。**另一个好处是每个用户都有不同的散列密码。

盐是在服务器端创建的随机生成的字符串，不涉及与浏览器之间的任何类型的传输。

在您的服务器上：

```
 // Password from form
  $pw = $_GET['password'];

  // Generate salt using unique values
  $salt = (rand(8).$registration_date.$username);

  // Password to be hashed
  $pwthb = ($pw.$salt); 
```

如果黑客获得了对您数据库的访问权，那么在大多数情况下，您的*游戏就结束了*，因为您需要存储初始随机 salt 以对其进行哈希比较。

一个简单的例子：

1.  用户在注册时在浏览器中输入初始密码
2.  在您的服务器上，密码与唯一的盐相结合，经过哈希处理并作为密码存储在数据库中
3.  盐存储在数据库中

*注意：散列可以使用 PHP 或 MySQL/DB 函数来完成*

当用户返回时：

1.  用户在浏览器中输入密码
2.  从数据库中获取盐并与输入的密码结合
3.  哈希密码+盐并与存储/哈希密码进行比较
4.  如果它们匹配：验证

在进一步阅读方面，可能值得查看以下内容：

*   [使用密码/明文加密盐值是直接散列的可行替代方案吗？](https://security.stackexchange.com/questions/16009/is-encrypting-a-salt-value-with-a-password-plaintext-a-viable-alternative-to-str)

*   [为哈希隐藏盐的必要性](https://stackoverflow.com/questions/213380/the-necessity-of-hiding-the-salt-for-a-hash)
*   [如何在分布式环境中存储盐](https://stackoverflow.com/questions/6141537/how-store-salt-in-distributed-environment)

# android - Android 开发应用程序

> ID：15993875
> 
> 赞同：-3
> 
> 时间：2013-04-13T23:01:37.243
> 
> 标签：android

是否有任何不仅仅是“Hello World！”的 Android 教程？还是“点击我！”？我用谷歌搜索了它，我发现的大多数教程都有一半以上是关于设置 SDK 等的，然后是关于如何显示 hello world 等的一些解释。我想在我可以之前继续学习更高级的教程开始创建我自己的测试应用程序。

我想开发一个应用程序（问答游戏）作为我的测试应用程序，其功能列表如下 -

*   显示 10 个带有多项选择答案的问题。问题集每周一更新。
*   用他们的时间保持最高分数的排行榜。

**请注意：**我不希望您为我编写代码。我刚刚列出了上面的应用程序功能列表，只是为了学习开发 Android 应用程序，因为 Hello World 教程还不够好。如果您知道任何涵盖任何部分相关或什至不相关的教程......那就太好了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T00:01:00.363

我建议去这些网站学习 android：

[http://thenewboston.org/list.php?cat=6](http://thenewboston.org/list.php?cat=6)

[http://www.vogella.com/android.html](http://www.vogella.com/android.html)

[http://developer.android.com/training/index.html](http://developer.android.com/training/index.html)

由于 android 主要是 java，你应该通过这些网站学习 java：

[http://thenewboston.org/list.php?cat=31](http://thenewboston.org/list.php?cat=31)

[http://www.javavideotutorials.org/](http://www.javavideotutorials.org/)

[http://www.javavideotutes.com/](http://www.javavideotutes.com/)

有关测验应用程序的详细信息，请访问以下站点：

**显示问题**

[http://android-helper.blogspot.ca/2011/07/simple-textview-source-code-main.html](http://android-helper.blogspot.ca/2011/07/simple-textview-source-code-main.html)

**获取用户输入**

[http://www.mkyong.com/android/android-radio-buttons-example/](http://www.mkyong.com/android/android-radio-buttons-example/)

[http://www.mkyong.com/android/android-checkbox-example/](http://www.mkyong.com/android/android-checkbox-example/)

**保存数据**

[http://developer.android.com/guide/topics/data/data-storage.html](http://developer.android.com/guide/topics/data/data-storage.html)

**从服务器获取问题**

[http://www.java-samples.com/showtutorial.php?tutorialid=1521](http://www.java-samples.com/showtutorial.php?tutorialid=1521)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T23:18:04.297

查看 Youtube 上的 thenewboston 频道。我已经完成了教程系列，到目前为止它很棒。这是链接：[https](https://www.youtube.com/course?list=EC2F07DBCDCC01493A) ://www.youtube.com/course?list=EC2F07DBCDCC01493A 。只需跳到更高级的教程视频。它们的标题基于它们所涵盖的内容，因此应该相当简单。祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-13T23:29:56.827

如果您知道在哪里看或者更确切地说要搜索什么关键字，那么有很多关于许多不同主题的优秀教程。

您需要多项选择的问题，除此之外别无其他，假设您有一个带有问题的屏幕和一些用于选项或复选框的单选按钮选项（如果有多个正确答案）。

所以现在我们有更细化的需求

1.  一个问题，让我们使用 TextView 来解决这个问题，任何 Hello World 教程都可以解决这个问题，而且您似乎已经找到了其中之一，那么让我们继续吧。

2.  单选按钮选择 - 谷歌“android单选按钮示例” - 第一个结果[是单选按钮示例](http://www.mkyong.com/android/android-radio-buttons-example/)

3.  复选框 - 谷歌“android 复选框示例” - 第一个结果[是复选框示例](http://www.mkyong.com/android/android-checkbox-example/)

我在这里想说的是，您需要更好地定义需求，然后搜索示例可能是比试图找到一个学习所有内容的地方更好的方法......

...话虽如此，Lars Vogel 的网站[vogella.com android 教程](http://www.vogella.com/android.html)是非常好的资源，上面的 2 个示例来自同一个站点，所以您可能想看看[mykong.com android 教程](http://www.mkyong.com/tutorials/android-tutorial/)

# io - Prolog 从格式化的文本文件中导入事实

> ID：15993878
> 
> 赞同：0
> 
> 时间：2013-04-13T23:02:00.080
> 
> 标签：io, prolog

我在文本文件 input.txt 中有以下输入

```
atom1,atom2,atom3
relation(atom1  ,[10,5,2])
relation(atom2  ,[3,10,2])
relation(atom3  ,[6,5,10]) 
```

第一行包括文件中关系谓词中使用的原子列表，剩余的每一行代表一个关系谓词，按第一行 list.relation(atom1, [x,y,z]) 的顺序排列。relation(atom1, [x,y,z]) 表示 atom1 的关系值为 10对于第一个原子，5 和第二个原子，2 和第三个原子我需要阅读这个文件并分别为每个原子添加表示关系值。例如，这些是将为 atom1 添加的关系值：

```
assert(relation(atom1, atom1,10)).
assert(relation(atom1, atom2, 5)).
assert(relation(atom1, atom3, 2)). 
```

我已经阅读了一些 prolog io 教程并看到了一些关于使用 DCG 的建议，但我是一个初学者 prolog 程序员，并且无法选择解决问题的方法。所以我在这里向经验丰富的 prolog 程序员寻求帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T08:14:55.233

由于您没有说明您使用的是什么 Prolog，所以这里有一个用 SWI-Prolog 编写的片段。我试图通过 SWI-Prolog 文档参考来表示*非ISO 内置函数。*

```
parse_input :-
    open('input.txt', read, S),
    parse_line(S, atoms(Atoms)),
    repeat,
    (  parse_line(S, a_struct(relation(A, L)))
    -> store(Atoms, A, L), fail
    ;  true ),
    close(S).

:- meta_predicate(parse_line(+, //)).

parse_line(S, Grammar) :-
    % see http://www.swi-prolog.org/pldoc/doc_for?object=read_line_to_codes/2
    read_line_to_codes(S, L),
    L \= end_of_file,
    phrase(Grammar, L).

% match any sequence
% note - clauses order is mandatory
star([]) --> [].
star([C|Cs]) --> [C], star(Cs).

% --- DCGs ---

% comma sep atoms
atoms(R) -->
    star(S),
    (   ",",
        {atom_codes(A, S), R = [A|As]},
        atoms(As)
    ;   {atom_codes(A, S), R = [A]}
    ).

% parse a struct X,
% but it's far easier to use a builtin :)
% see http://www.swi-prolog.org/pldoc/doc_for?object=atom_to_term/3
a_struct(X, Cs, []) :-
    atom_codes(A, Cs),
    atom_to_term(A, X, []).

% storage handler
:- dynamic(relation/3).

store(Atoms, A, L) :-
    nth1(I, L, W),
    nth1(I, Atoms, B),
    assertz(relation(A, B, W)). 
```

使用示例 input.txt，我得到

```
?- parse_input.
true .

?- listing(relation).
:- dynamic relation/3.

relation(atom1, atom1, 10).
relation(atom1, atom2, 5).
relation(atom1, atom3, 2).
relation(atom2, atom1, 3).
relation(atom2, atom2, 10).
relation(atom2, atom3, 2).
relation(atom3, atom1, 6).
relation(atom3, atom2, 5).
relation(atom3, atom3, 10). 
```

高温高压

# jquery - JQuery - 在表单中单击聚焦

> ID：15993880
> 
> 赞同：1
> 
> 时间：2013-04-13T23:02:23.833
> 
> 标签：jquery, forms, focus, selected

我正在为客户编写竞赛应用程序。

**描述：**
我在一页上有三张图片。用户必须选择一张图片，“选择”它并点击“我想参与”。之后，他将被重定向到一个表单。（简单的部分）。

**我的问题：**
我怎样才能实现，如果用户点击三张图片中的一张，图片将是“选择的一张”/有焦点/被选中。
如果已选择图片，则提交按钮应正常工作。
之后，我需要“提交”/发送选择的图片（通过 id 或 class 或 data 属性）到下一页并检查它是否是正确的图片。

我怎样才能做到这一点？通过“样式化”复选框还是通过 jQuery？
谢谢你的提示。

编辑：
这是我的意思，我认为它工作正常。有什么建议么？

**HTML：**

```
<img src="http://placekitten.com/50/50" id="first"><br/>
<img src="http://placekitten.com/50/50" id="second"><br/>
<img src="http://placekitten.com/50/50" id="third"><br/>
    <input type="hidden" name="result" value="" id="hiddenresult" />
    <button name="submit" id="submit">Submit</button> 
```

**JS：**

```
$('#first, #second, #third').click(function(){      
         $('#hiddenresult').attr('value', $(this).id);
        $(this).css('border','1px solid red');
     }); 
```

**小提琴：http:** [//jsfiddle.net/vmV75/1/](http://jsfiddle.net/vmV75/1/)

**我的“新”问题是：**
我怎样才能给选定的元素一个边框而不是全部。选择新 img 时，我需要设置旧边框 = none。我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T23:28:17.313

将图像设置为单选按钮，并使用`:checked`伪选择器在所选图像周围添加边框。

复选框和单选按钮样式指南：[http ://webdesign.tutsplus.com/tutorials/htmlcss-tutorials/quick-tip-easy-css3-checkboxes-and-radio-buttons/](http://webdesign.tutsplus.com/tutorials/htmlcss-tutorials/quick-tip-easy-css3-checkboxes-and-radio-buttons/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T03:15:51.397

一个简单的解决方案是：

```
$('#first, #second, #third').click(function(){      
         $('#hiddenresult').attr('value', $(this).id);
        $('#first, #second, #third').css('border','');
        $(this).css('border','1px solid red');
     }); 
```

更好的解决方案是在其上创建一个类和样式：

```
$('#first, #second, #third').click(function(){      
             $('#hiddenresult').attr('value', $(this).id);
            $('#first, #second, #third').removeClass('selected');
            $(this).addClass('selected');
         }); 
```

和CSS：

```
img.selected{
   border:1px solid red
} 
```

# sql - MAX 按 ID 分组

> ID：15993881
> 
> 赞同：0
> 
> 时间：2013-04-13T23:02:31.180
> 
> 标签：sql, vb.net

我正在尝试从 Excel 表中按 ID 选择 MAX(QTYSOLDTHISDAY)。但下面的代码不断选择许多具有 MAX 值的记录。我只需要选择一条记录。我试过按ID分组，它没有用。这是我的代码。谢谢

```
Dept(0) = "01"
    Dept(1) = "02"
    Dept(2) = "03"
    Dept(3) = "04"
    Dept(4) = "05"
Dim DeptNum As String
Using cn As New OleDbConnection With {.ConnectionString = String.Format(ConnectionNoHeader6, FileName6)}
        Dim dt7 As New DataTable
        cn.Open()
        For Each DeptNum In Dept
            Dim cmd1 As OleDbCommand = New OleDbCommand(
                <Text>
                SELECT 
                    ID,
                        ARTNAME,
                            NETAMOUNTTHISDAY,
                            QTYSOLDTHISDAY,
                             AVAILABLESTOCK

                FROM [<%= SheetName6 %>$]
 WHERE ID = <%= DeptNum %>  and QTYSOLDTHISDAY=(select max(QTYSOLDTHISDAY) from [<%= SheetName6 %>$] where ID =  <%= DeptNum %>  group by ID)
</Text>.Value,
                    cn
            )
            dt7.Load(cmd1.ExecuteReader)
            For Each row As DataRow In dt7.Rows
            Next
            DataGridView2.DataSource = dt7
        Next DeptNum
    End Using 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T00:24:19.713

由于 excel 是 Microsoft 产品，我认为这`Select top`是一个有效的声明。尝试将 a 添加`Top 1`到您的查询中。

```
SELECT  TOP 1
        ID,
        ARTNAME,
        NETAMOUNTTHISDAY,
        QTYSOLDTHISDAY,
        AVAILABLESTOCK

 FROM   [<%= SheetName6 %>$]
 WHERE  ID = <%= DeptNum %>  
         and QTYSOLDTHISDAY=(select max(QTYSOLDTHISDAY) 
                             from [<%= SheetName6 %>$] 
                             where ID =  <%= DeptNum %>  
                             group by ID) 
```

如果有多个记录具有相同的`QTYSOLDTHISDAY`，您如何决定返回哪一个？如果您需要做出这样的决定，`Order By`请在外部查询上使用 an 来获取您需要在结果中返回的记录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T00:35:09.557

我只花了半个小时在 Excel 上搜索 SQL 的语言参考，但没有成功 - 以*验证*您是否可以`TOP n`像使用 SQL Server 一样使用。由于其他人认为它有效，我将继续假设。

使用`TOP 1` 您*通常可以简化您的陈述*：

```
SELECT TOP 1
       ID, ARTNAME, NETAMOUNTTHISDAY, QTYSOLDTHISDAY, AVAILABLESTOCK
FROM   [<%= SheetName6 %>$]
WHERE  ID = <%= DeptNum %>  
ORDER  BY QTYSOLDTHISDAY DESC 
```

在单独的子查询中查找最大值是没有意义的`QTYSOLDTHISDAY`。只需按降序排列并选择第一行。这使您可以从共享最大值的行中任意选择`QTYSOLDTHISDAY`。

您可以添加更多列以`ORDER BY`添加一个或多个决胜局。例如，如果您有多行共享最大值`QTYSOLDTHISDAY`并且您想要其中最小`ID`的：

```
ORDER  BY QTYSOLDTHISDAY DESC, ID 
```

# windows - 检测关键事件

> ID：15993882
> 
> 赞同：0
> 
> 时间：2013-04-13T23:02:35.773
> 
> 标签：windows, assembly, fasm

我在尝试检测 x86 汇编语言中的关键事件时遇到了麻烦。当我运行我的程序时，我得到这个一般错误：

key.exe 遇到问题，需要关闭。对此造成的不便，我们表示歉意。

我的汇编程序 fasm 生成一个 .bin 文件、一个 .exe 文件和一个 .com 文件。如果我尝试运行 .com 文件，会弹出一个消息框，提示图像文件有效，但适用于当前机器以外的机器类型。

这是我的代码：

```
include 'include/win32ax.inc'
section '.data' data readable writeable

inchar     DB ?
numwritten DD ?
numread    DD ?
outhandle  DD ?
inhandle   DD ?
char DB ?

     section '.text' code readable executable
     start:

    ;set up the console
invoke  AllocConsole
invoke  GetStdHandle,STD_OUTPUT_HANDLE
mov [outhandle],eax
invoke  GetStdHandle,STD_INPUT_HANDLE
mov [inhandle],eax

    ;get key press
mov ah,1h
int 21h
mov [char],AL

    ;print out the key pressed
invoke  WriteConsole,[outhandle],char,15,numwritten,0
invoke  ReadConsole,[inhandle],inchar,1,numread,0
invoke  ExitProcess,0

    .end start 
```

我使用的是 x64 版本的 windows xp，但它与 32 位应用程序兼容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-15T06:23:51.947

如果您正在创建 Win32 程序，则不能使用 DOS API ( int 21h ) 来获取按键。

您应该使用[ReadConsoleInput](http://msdn.microsoft.com/en-us/library/ms684961%28v=vs.85%29.aspx)函数并检查键盘事件。

这是如何做到的：

```
include '%fasminc%/win32ax.inc'
section '.data' data readable writeable

struc KEY_EVENT_RECORD {
  .fKeyDown       dd  ?
  .Repeat         dw  ?
  .VirtKeyCode    dw  ?
  .VirtScanCode   dw  ?
  .res            dw  ?
  .char           dd  ?
  .ctrl           dd  ?
}

struc INPUT_RECORD {
  .type  dw ?
  .event KEY_EVENT_RECORD
}

KEY_EVENT = 1

inchar     DB ?
numwritten DD ?
numread    DD ?
outhandle  DD ?
inhandle   DD ?

input      INPUT_RECORD
count      dd ?

section '.text' code readable executable

start:

        ;set up the console
        invoke  AllocConsole
        invoke  GetStdHandle,STD_OUTPUT_HANDLE
        mov [outhandle],eax
        invoke  GetStdHandle,STD_INPUT_HANDLE
        mov [inhandle],eax

.loop:
        invoke  ReadConsoleInput, [inhandle], input, 1, count
        cmp     [count], 1
        jne     .loop
        cmp     [input.type], KEY_EVENT
        jne     .loop

            ;print out the key pressed
        invoke  WriteConsole,[outhandle],input.event.char,1,numwritten,0
        invoke  ReadConsole,[inhandle],inchar,1,numread,0
        invoke  ExitProcess,0

.end start 
```

# c++ - URL 通用格式

> ID：15993888
> 
> 赞同：0
> 
> 时间：2013-04-13T23:03:14.260
> 
> 标签：c++, url, format

我编写了一个允许将 URL 发布到 YouTube 上的 C++ 程序。它的工作原理是将 URL 作为输入，无论是您在程序中键入还是直接输入，然后它将替换每个“/”、“。” 在带有 '*' 的字符串中。然后将此修改后的字符串放在剪贴板上（这仅适用于 Windows 用户）。

当然，在我甚至可以调用程序可用之前，它必须返回：我需要知道什么时候在 URL 中使用了“.”、“/”。我看过这篇文章：[http](http://en.wikipedia.org/wiki/Uniform_Resource_Locator) ://en.wikipedia.org/wiki/Uniform_Resource_Locator ，并且知道“。” 在处理“主网站”时使用（在这个URL的情况下，“en.wikipedia.org”），然后使用'/'，但我去过其他网站，[http://msdn。 microsoft.com/en-us/library/windows/desktop/ms649048%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms649048%28v=vs.85%29.aspx)，这根本不是这种情况（它甚至将 '(', ')' 替换为 "%28" 、“%29”！）

我似乎还请求了一个 .aspx 文件，不管它是什么。此外，还有一个“。” 在该 URL 的括号内。我什至尝试查看有关 URL 的正则表达式（我还不太完全理解这些...）。有人可以告诉我（或链接到）有关在 URL 中使用“.”、“/”的规则吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T04:09:58.670

你能解释一下你为什么要做这个令人费解的事情吗？你想达到什么目的？一旦你回答了这个问题，你可能不需要知道你想的那么多。

与此同时，这里有一些信息。一个 URL 实际上由多个部分组成

```
http:     - the "scheme" or protocol used to access the resource. "HTTP", "HTTPS",
            "FTP", etc are all examples of a scheme. There are many others

//        - separates the protocol from the host (server) address

myserver.org - the host. The host name is looked up against a DNS (Dynamic Name Server)
            service and resolved to an IP address - the "phone number" of the machine
            which can serve up the resource (like "98.139.183.24" for www.yahoo.com)

www.myserver.org - the host with a prefix. Sometimes the same domain (`myserver.org`)
            connects multiple servers (or ports) and you can be sent straight to the
            right server with the prefix (mail., www., ftp., ... up to the
            administrators of the domain). Conventionally, a server that serves content
            intended for viewing with a browser has a `www.` prefix, but there's no rule
            that says this must be the case. 

:8080/    - sometimes, you see a colon followed by up to five digits after the domain.
            this indicates the PORT on the server where you are accessing data
            some servers allow certain specific services on just a particular port
            they might have a "public access" website on port 80, and another one on 8080
            the https:// protocol defaults to port 443, there are ports for telnet, ftp, 
            etc. Add these things only if you REALLY know what you are doing.

/the/pa.th/ this is the path relative to DOCUMENTROOT on the server where the
            resource is located. `.` characters are legal here, just as they are in
            directory structures. 

file.html
file.php
file.asp
etc       - usually the resource being fetched is a file. The file may have
            any of a great number of extensions; some of these indicate to the server that
            instead of sending the file straight to the requester,
            it has to execute a program or other instructions in this file,
            and send the result of that
            Examples of extensions that indicate "active" pages include
            (this is not nearly exhaustive - just "for instance"):
            .php = contains a php program
            .py  = contains a python program
            .js  = contains a javascript program
                   (usually called from inside an .htm or .html)
            .asp = "active server page" associated with a
                   Microsoft Internet Information Server 
```

?something=value&somethingElse=%23othervalue%23 传递给服务器的参数可以显示在 URL 中。这可以用来传递参数、表单中的条目等。任何字符都可以在这里传递——包括“.”、“&”、“/”……但你不能只在你的字符串中写这些字符...

有趣的来了。

URL 不能包含某些字符（实际上不少）。为了解决这个问题，存在一种称为“转义”角色的机制。通常，这意味着将字符替换为十六进制等效字符，并以`%`符号为前缀。因此，例如，您经常会看到表示为 %20 的空格字符。[你可以在这里](http://web.forret.com/tools/charmap.asp?show=ascii)找到一个方便的清单

有许多函数可用于将 URL 中的“非法”字符自动转换为“合法”值。

要确切了解什么是允许的，什么是不允许的，你真的需要回到原来的规范。参见例如

[http://www.ietf.org/rfc/rfc1738.txt](http://www.ietf.org/rfc/rfc1738.txt)

[http://www.ietf.org/rfc/rfc2396.txt](http://www.ietf.org/rfc/rfc2396.txt)

[http://www.ietf.org/rfc/rfc3986.txt](http://www.ietf.org/rfc/rfc3986.txt)

我按时间顺序列出它们——最后一个是最近的。

但我重复我的问题——你在这里真正想做什么，为什么？

# haskell - 也许和递归列表

> ID：15993890
> 
> 赞同：3
> 
> 时间：2013-04-13T23:03:44.967
> 
> 标签：haskell

我尝试`reverse`用`Maybe`. 我不知道如何`Just`使用递归返回模式匹配。例如，`ghci> myReverse [1,2,3]`需要返回`Just [3,2,1]`. 这是我的代码：

```
myReverse :: [a] -> Maybe [a]
myReverse [] = Nothing
myReverse [x] = Just [x]
myReverse (x:xs) = myReverse xs ++ [x] -- here's my problem. 
```

我认为那`myReverse (x:xs) = Just $ myReverse xs ++ [x]`行得通，但没有，我不知道该怎么做。我想知道的是如何做以及为什么。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-13T23:48:21.290

As `[a]` is a **Monoid** define by,

```
instance Monoid [a] where
        mempty  = []
        mappend = (++) 
```

Then `Maybe [a]` is also a **Monoid**,

```
instance Monoid a => Monoid (Maybe a) where
    mempty = Nothing
    Nothing `mappend` m = m
    m `mappend` Nothing = m
    Just m1 `mappend` Just m2 = Just (m1 `mappend` m2) 
```

Note the type constraint in the instance declaration which impose `a` to be a Monoid or else `Maybe a` won't.

We can then use mappend, `(<>)`, to chain our recursive call at the condition to transform the head of the list to a singleton.

```
import Data.Monoid ((<>))

myReverse :: [a] -> Maybe [a]
myReverse []     = Nothing
myReverse (x:xs) = myReverse xs <> Just [x] 
```

Last note, the previous fold solution can be improve too.

```
>>> let mrev = foldl' (\x y -> Just [y] <> x ) Nothing
>>> mrev []
Nothing
>>> mrev "hello"
Just "olleh" 
```

* * *

*Previous fold answer*

Knowing that reverse can be define using fold as follow,

```
>>> foldl' (flip (:)) [] [1..5]
[5,4,3,2,1] 
```

This can be rewritten as,

```
>>> foldl' (\x y -> y:x) [] [1..5]
[5,4,3,2,1] 
```

To adapt for Maybe type, we do the following transformation,

*   The seed `[]` become `(Just [])`
*   The anonymous function must now be apply inside Just, we use fmap to do it.

This lead us to,

```
>>> foldl' (\x y -> fmap (y:) x) (Just []) [1..5]
Just [5,4,3,2,1] 
```

Finally,

```
mreverse xs | null xs = Nothing 
            | foldl' (\x y -> fmap (y:) x) (Just []) xs 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-13T23:09:26.123

`myReverse`返回 a `Maybe [a]`，它不能直接附加到某个东西，因为它不是一个列表。IOW 的值`myReverse xs`将是`Nothing`, 或`Just <some list>`。您需要对结果进行模式匹配。

```
myReverse (x:xs) = 
    case myReverse xs of
         Just list -> ...
         Nothing   -> ... 
```

当然，您需要决定在每种情况下需要做什么，具体取决于您想要`myReverse`做什么。

另请记住，并非*每个*函数都需要递归，因此您可以在需要时调用常规`reverse`函数`myReverse`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-13T23:17:29.533

我想到了一些类似于 luqui 的东西，除了最后应用 Maybe ：

```
myReverse :: [a] -> Maybe [a]
myReverse ys
  | null (myReverse' ys) = Nothing
  | otherwise            = Just (myReverse' ys)
 where
   myReverse' []     = []
   myReverse' (x:xs) = myReverse' xs ++ [x] 
```

或者，如果你愿意，

```
myReverse ys | null (reverse ys) = Nothing
             | otherwise         = Just (reverse ys) 
```

# php - 是否可以从一个 PDO 函数返回行以及行数？

> ID：15993895
> 
> 赞同：-1
> 
> 时间：2013-04-13T23:04:23.513
> 
> 标签：php, pdo, count, prepared-statement

我想从一个准备好的 PDO 语句中获取返回的行数和实际行数，这可能吗？

我正在使用 PHP 5+ 和 Mysql。

例如：

```
global $dbh
$query = "SELECT title, date, title, description
        FROM posts
        WHERE title LIKE '%foo%'
        ORDER BY date
        DESC";

$stmt->prepare($query);
$stmt-execute();

$count = count($stmt->rowCount());
$searcharray = $stmt->fetchAll(PDO::FETCH_ASSOC);

return array($count, $searcharray); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T23:17:13.310

根据请求，回答表格。^^

将代码更改为：

```
global $dbh
$query = "SELECT title, date, title, description
        FROM posts
        WHERE title LIKE '%foo%'
        ORDER BY date
        DESC";

$stmt->prepare($query);
$stmt-execute();

$searcharray = $stmt->fetchAll(PDO::FETCH_ASSOC);
$count = count($searcharray);

return array($count, $searcharray); 
```

该[`PDOStatment::rowCount()`](http://php.net/manual/en/pdostatement.rowcount.php)函数返回更新/插入/删除语句的受影响行。相反，对`fetchAll`as 的结果进行计数，这将准确计算从 select 语句返回的行数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T05:48:41.667

当你有一个行数组时，你不需要计数。你可以随时得到它。
因此，只需返回一个数组，然后在需要时进行计数。

# jquery - 只有一半的 jQuery 动画在运行

> ID：15993900
> 
> 赞同：2
> 
> 时间：2013-04-13T23:04:54.950
> 
> 标签：jquery

这个 jQuery 动画中只有宽度变化在运行，为什么颜色变化动画也没有发生？

```
$('#code').animate({ 
  'background':'#dddddd', 
  'background':'rgb(221, 221, 221)', 
  'width':'16px', 
  'width':'1rem' 
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T23:09:06.260

您正在尝试为单独使用 jQuery 无法实现的背景颜色设置动画。要实现您在描述中尝试执行的操作，您需要包含[此处提供的彩色动画插件。](http://www.bitstorm.org/jquery/color-animation/)

或者您也可以使用提供相同功能的[Jquery UI 。](http://jqueryui.com/)

包含后，您的代码应该按预期工作。

请参阅包含颜色插件的这个[小提琴。](http://jsfiddle.net/SfWAS/)

```
$('#color').on('click',function(){
    $(this).animate({backgroundColor:'#400101', color:'#fff'}); 
}); 
```

# java - java.lang.StringIndexOutOfBoundsException

> ID：15993901
> 
> 赞同：-4
> 
> 时间：2013-04-13T23:05:32.893
> 
> 标签：java, file, parsing, substring

代码 ：

```
for(int i = 0; i < rate.length; i++){
                if(i == 0 | i == 4 | i == 8 | i == 12 | i == 18 | i == 22 | i == 26 | 
                        i == 30 | i == 34){
                    System.out.println(rate[i]);
                    String parsedRate = rate[i].substring(0, 5);
                    System.out.println(parsedRate);
                    double rt = Double.parseDouble(parsedRate);
                    if(rt > max){
                        max = rt;
                    }
                }
            } 
```

输出：

10.00% 10.00

线程“主”java.lang.StringIndexOutOfBoundsException 中的异常：字符串索引超出范围：parserTax.main(parserTax.java:48) 的 java.lang.String.substring(String.java:1907) 的 5

我得到了想要的 10.00 ......但它失败了。这是一个错误吗？我知道它必须与那个特殊字符'％'有关......我正在尝试解析文件以进行分析，有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T23:09:16.443

最有可能的错误是在这一行。 -

```
String parsedRate = rate[i].substring(0, 5); 
```

您正在尝试`rate[i]`从位置 0 到 5 获取子字符串。您是否检查过所有`rate`字符串至少有 6 个字符？请记住输出，似乎在第二次`if`条件为真（`i == 4`）时引发了异常，因此很可能`rate[4]`包含一个空字符串。

# javascript - 通过 JSON 数组的简单 jquery 循环？

> ID：15993910
> 
> 赞同：-2
> 
> 时间：2013-04-13T23:07:32.353
> 
> 标签：javascript, jquery

我有这个简单的 jquery 脚本来循环遍历 JSON 数组
，该脚本根本无法正常工作，并且从不提供输出。
我确定 JSON 数组是有效的，但我不知道为什么 Jquery 不解析它。

```
$(document).ready(function(){
    var cost = [{"gold":"100","iron":"80","wood":"120","food":"70"},{"gold":"80","iron":"60","wood":"90","food":"35"}];
    var costarr = $.parseJSON(cost);
    $.each(costarr, function(i, item) {
       alert(item.gold);
    }
}); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-13T23:08:41.200

你[不需要解析它](http://jsfiddle.net/fqhYA/)，它已经是一个数组。而你`each`缺少一个结束`)`

```
$.each(cost, function(i, item) {
  alert(item.gold);
}); //<-- lacking ")" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T23:17:34.343

您有语法错误。

```
$.each(costarr, function(i, item) {
   alert(item.gold);
} 
```

缺少结尾 ');'

这就是为什么您的小提琴中没有任何警报的原因。

# c++ - 链接到 .lib 会导致许多多重定义的符号

> ID：15993912
> 
> 赞同：1
> 
> 时间：2013-04-13T23:07:42.417
> 
> 标签：c++, visual-c++, build, linker, googletest

我下载了[Google Test](https://code.google.com/p/googletest/w/list)并在 MSVC 2010 下构建了它。然后我将它的目标 gtest.lib（或调试配置下的 gtestd.lib）与我的可执行文件相关联。

结果是一长串多重定义的符号。简而言之：

```
error LNK1169: one or more multiply defined symbols found
warning LNK4098: defaultlib 'MSVCRTD' conflicts with use of other libs; use /NODEFAULTLIB:library
warning LNK4098: defaultlib 'LIBCMTD' conflicts with use of other libs; use /NODEFAULTLIB:library
error LNK2005: _vprintf already defined in MSVCRTD.lib(MSVCR100D.dll)
error LNK2005: _printf already defined in MSVCRTD.lib(MSVCR100D.dll) 
```

这样的例子不胜枚举。大多数是 VC 运行时符号，但少数是 gtest 符号。我犯了什么错误？gtest[入门书](https://code.google.com/p/googletest/wiki/V1_5_Primer)指出：

> 要使用 Google Test 编写测试程序，您需要将 Google Test 编译成一个库并将您的测试与它链接起来。

但除此之外并没有真正详细说明。

# javascript - 使用 Moment.js 格式化日期

> ID：15993913
> 
> 赞同：338
> 
> 时间：2013-04-13T23:08:10.843
> 
> 标签：javascript, momentjs, date-parsing

我有一个这种格式的字符串：

```
var testDate = "Fri Apr 12 2013 19:08:55 GMT-0500 (CDT)" 
```

我想使用[Moment.js](https://momentjs.com/timezone/docs/)以这种格式获取它`mm/dd/yyyy : 04/12/2013`进行显示。

我试着用这个方法来做，

```
moment(testDate,'mm/dd/yyyy'); 
```

哪些错误和说`there is no such method called replace`？我是否以错误的方式处理这个问题？

* * *

### 编辑

我还应该提到我正在使用 Moment.js 的预打包版本，*为**Meteor.js*打包

 *```
Object [object Date] has no method 'replace' : The Exact error from the console 
```

堆栈跟踪：

```
 at makeDateFromStringAndFormat (http://127.0.0.1:3000/packages/moment/lib/moment/moment.js?b4e3ac4a3d0794023a4410e7941c3e179398b5b0:539:29)
    at moment (http://127.0.0.1:3000/packages/moment/lib/moment/moment.js?b4e3ac4a3d0794023a4410e7941c3e179398b5b0:652:24)
    at populateProfileForEdit (http://127.0.0.1:3000/client/views/home/administration/directory/profiles/profiles.js?acfff908a6a099f37312f62892a22b40f82e5e0f:147:25)
    at Object.Template.profile_personal.rendered (http://127.0.0.1:3000/client/views/home/administration/directory/profiles/profiles.js?acfff908a6a099f37312f62892a22b40f82e5e0f:130:13)
    at Spark.createLandmark.rendered (http://127.0.0.1:3000/packages/templating/deftemplate.js?b622653d121262e50a80be772bf5b1e55ab33881:126:42)
    at http://127.0.0.1:3000/packages/spark/spark.js?45c746f38023ceb80745f4b4280457e15f058bbc:384:32
    at Array.forEach (native)
    at Function._.each._.forEach (http://127.0.0.1:3000/packages/underscore/underscore.js?867d3653d53e9c7a171483edbcad9670e12288c7:79:11)
    at http://127.0.0.1:3000/packages/spark/spark.js?45c746f38023ceb80745f4b4280457e15f058bbc:382:7
    at _.extend.flush (http://127.0.0.1:3000/packages/deps/deps.js?9642a93ae1f8ffa8eb1c2475b198c764f183d693:231:11) 
```

* * *

## 回答 #1

> 赞同：737
> 
> 时间：2013-04-13T23:23:58.983

第二个参数`moment()`是[*解析*格式](http://momentjs.com/docs/#/parsing/string-format/)而不是*显示*格式。

为此，您需要以下[`.format()`方法](http://momentjs.com/docs/#/displaying/format/)：

```
moment(testDate).format('MM/DD/YYYY'); 
```

另请注意，案例确实很重要。对于月份、月份和年份，格式应为大写。

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2014-05-13T05:59:54.670

包括 moment.js 并使用下面的代码你可以格式化你的日期

```
var formatDate= 1399919400000;

var responseDate = moment(formatDate).format('DD/MM/YYYY'); 
```

我的输出是“13/05/2014”

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2019-08-12T12:35:50.820

```
moment().format();                                // "2019-08-12T17:52:17-05:00" (ISO 8601, no fractional seconds)
moment().format("dddd, MMMM Do YYYY, h:mm:ss a"); // "Monday, August 12th 2019, 5:52:00 pm"
moment().format("ddd, hA");                       // "Mon, 5PM" 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2020-12-18T14:56:50.630

## *你可能不再需要 Moment.js*

Moment 是一个很棒的时间处理库，但它被认为是一个**遗留**项目，团队建议使用其他[库](https://momentjs.com/docs/#/-project-status/recommendations/)。

[date-fns](https://date-fns.org/)是最好的轻量级库之一，它是模块化的，因此您可以选择所需的功能并减少包大小（[问题](https://github.com/moment/moment/issues/2373)和[声明](https://momentjs.com/docs/#/-project-status/recommendations/)）。

> 在现代应用程序中反对使用 Moment 的另一个常见论点是它的大小。Moment 不适用于现代“摇树”算法，因此它往往会增加 Web 应用程序包的大小。

```
import { format } from 'date-fns' // 21K (gzipped: 5.8K)
import moment from 'moment' // 292.3K (gzipped: 71.6K) 
```

格式化日期`date-fns`：

```
// moment.js
moment().format('MM/DD/YYYY');
// => "12/18/2020"

// date-fns
import { format } from 'date-fns'
format(new Date(), 'MM/dd/yyyy');
// => "12/18/2020" 
```

有关备忘单的更多信息，其中包含可用于替换 moment.js 的函数列表：[You-Dont-Need-Momentjs](https://github.com/you-dont-need/You-Dont-Need-Momentjs)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2019-04-15T04:07:55.210

对于确定输出日期，请使用`format`. 第二个时刻参数用于解析 - 但是如果您省略它，那么您`testDate`将导致弃用警告

> 弃用警告：提供的值不是可识别的 RFC2822 或 ISO 格式...

```
var testDate= "Fri Apr 12 2013 19:08:55 GMT-0500 (CDT)"

let s= moment(testDate).format('MM/DD/YYYY');

msg.innerText= s;
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js"></script>

<div id="msg"></div>
```

要省略此警告，您应该提供解析格式

```
var testDate= "Fri Apr 12 2013 19:08:55 GMT-0500 (CDT)"

let s= moment(testDate, 'ddd MMM D YYYY HH:mm:ss ZZ').format('MM/DD/YYYY');

console.log(s);
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js"></script>
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2021-03-14T12:05:47.517

```
var moment = require('moment');

let yourdate = '2021-01-02T07:57:45.121Z'; // for example

moment(yourdate).format('MM/DD/YYYY');

// output : 01-02-2021

moment(yourdate).format('DD-MMM-YYYY');

// output : 01-Jan-2021 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2021-06-23T08:15:11.503

您可以将“L”传递给`format`处理国际化的方法......

```
moment.locale('en-US');
moment().format("L");
> "06/23/2021"

moment.locale('fr');
moment().format("L");
> "23/06/2021" 
```

其他长日期格式（`fr`语言环境）：

```
LT : 'HH:mm',
LTS : 'HH:mm:ss',
L : 'DD/MM/YYYY',
LL : 'D MMMM YYYY',
LLL : 'D MMMM YYYY HH:mm',
LLLL : 'dddd D MMMM YYYY HH:mm' 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-06-28T18:45:32.710

这可能有助于一些人愿意或意外地一个接一个地寻找多种日期格式。请找到代码：我在当前日期使用 moment.js 格式函数（今天是 29-06-2020） var startDate = moment(new Date()).format('MM/DD/YY'); 结果：20 年 6 月 28 日

发生的事情是它只保留年份部分：20 作为“06/28/20”，如果我运行语句：new Date(startDate) 结果是“Mon Jun 28 1920 00:00:00 GMT+0530 (India标准时间）”，

然后，当我在“06/28/20”上使用另一种格式时： startDate = moment(startDate ).format('MM-DD-YYYY'); 结果：06-28-1920，在 google chrome 和 firefox 浏览器中，第二次尝试的正确日期为：06-28-2020。但是在 IE 中存在问题，据我了解，我们可以在给定日期应用一个日期格式，如果我们想要第二个日期格式，它应该应用于新日期而不是第一个日期格式结果。并且还观察到第一次应用 'MM-DD-YYYY' 和下一个 'MM-DD-YY' 在 IE 中工作。为了清楚地理解，请在链接中找到我的问题： [Date go wrong when using Momentjs date format in IE 11](https://stackoverflow.com/questions/62622534/date-went-wrong-when-using-momentjs-date-format-in-ie-11)*

# loops - 对 SASS 中的变量列表执行计算

> ID：15993917
> 
> 赞同：2
> 
> 时间：2013-04-13T23:08:25.550
> 
> 标签：loops, sass

是否可以对变量列表执行计算，以生成另一个变量列表。

例如说我想列出我想在我的 CSS 中使用的所有媒体查询......

```
$mediaQueries:
768,
1024
; 
```

然后像这样将所有这些的价值翻倍......

```
$newMediaQueries:

@each $mediaQuery in $mediaQueries {
  $mediaQuery * 2
}

; 
```

（我实际上想做的是为这个变量列表生成 em 版本，但我认为我会在这个例子中保持数学简单）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T23:21:32.710

是的：

```
$mediaQueries: 768, 1024;

$newMediaQueries: ();

@each $mediaQuery in $mediaQueries {
  $newMediaQueries: append($newMediaQueries, $mediaQuery * 2);
} 
```

诀窍是创建一个空列表，然后遍历旧值并将它们附加到新列表中。

默认情况下，它会输出一个类似的列表`1536 2048`，但您可以通过传递该选项来使用逗号：`$newMediaQueries: append($newMediaQueries, $mediaQuery * 2, comma);`

# boost - STL:type_traits 和 BOOST:type_traits 有什么区别？

> ID：15993919
> 
> 赞同：0
> 
> 时间：2013-04-13T23:08:31.070
> 
> 标签：boost, stl, typetraits

我看到 STL 在编译 type_traits 时需要一个特殊的指令。这是否意味着 STL::type_traits 具有编译时反射？

这是唯一的区别还是还有其他区别？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T10:44:03.987

标准库`type_traits`仅在 C++11 中可用，因此您必须在编译器中启用 c++11 支持，这就是`-std=c++0x`oiption 在您的情况下所做的。

`Boost.TypeTraits`库更便携，它也可以在 C++03 模式下工作，但有[一些限制](http://www.boost.org/doc/libs/1_53_0/libs/type_traits/doc/html/boost_typetraits/intrinsics.html)。当然，它在可用的情况下使用 c++11 支持。

# html - CSS - 绝对 DIV 内的链接不可点击 - 移动

> ID：15993920
> 
> 赞同：0
> 
> 时间：2013-04-13T23:08:31.830
> 
> 标签：html, css, mobile

我无法单击 div 中的链接 is `position:absolute`。它似乎不适用于移动 android，因为它在 Chrome 甚至 ie8 的桌面上运行良好。

一旦我删除它的风格。msg-inner 类仅适用于 jQuery，它具有 scrollTop 没有样式。我已经阅读了很多答案并在内部 div 上使用`z-index`或，但没有一个有效。`position:relative`我什至尝试`position:fixed`在 msg_container 上使用和同样的问题。内部 div 滚动，一切看起来都正确，但只是链接坏了，顺便说一句，偶尔有些会起作用，有些不起作用。我拿走了所有样式，只是在里面放了简单的链接，看看它是否是格式问题，仍然没有。

```
<div id="msg_container" class="absolute" style="overflow-y:auto;width:100%;height:75%">
    <div class="msg_inner">

.... stuff in here with links
</div><!--msg inner-->
    </div><!--msg_container--> 
```

CSS

```
.absolute {
position: absolute;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T23:12:52.413

你`#msg_container`不应该有绝对的立场，`.msg_inner`应该。尝试这个：

**HTML**

```
<div class="msg_container">
    <div class="msg_inner">
        .... stuff in here with links
    </div><!--msg inner-->
</div><!--msg_container--> 
```

**CSS**

```
.msg_container {
    position: relative;
    width: 400px;
    height: 400px;
}

.msg_inner {
    position: absolute;
    top: 0px;
    left: 0px;
} 
```

另请注意，我创建了`msg_container`一个类，而不是一个 ID。拥有多个同名 ID 被认为是不好的做法。虽然我当然不知道你的代码，但我假设你可能`msg_container`在一个页面上有多个 s ......所以我使用了一个类。

# drag-and-drop - JavaFX 在不同窗格之间移动节点

> ID：15993923
> 
> 赞同：4
> 
> 时间：2013-04-13T23:08:53.087
> 
> 标签：drag-and-drop, javafx

下图应该有助于尽可能清楚地说明这一点。

我有 3 个窗格 AB 和 C。B 和 C 是 A 的孩子，B 有它自己的孩子（白框）。通过拖放，我可以将 B 的孩子移动到 B 内的任何位置，并且能够再次将它们捡起，但是如果拖到 C 上，甚至是 A 的一小部分，它们可以被丢弃但不能再次被捡起。

我使用基本控件。要拖动，我使用 imgView.setOnMouseDragged。

那么如何从一个窗格 A 拖动到窗格 B 或 C 并且仍然允许再次拾取和拖动对象？

![例子](https://i.stack.imgur.com/qTmxg.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-11T14:01:06.800

我有同样的问题。这是我在 Oracle 论坛成员的帮助下实现它的方式：

[如何在选项卡窗格之间拖放选项卡节点](https://stackoverflow.com/questions/17530899/how-to-drag-and-drop-tab-nodes-between-tab-panes)

和这个：

[https://forums.oracle.com/thread/2558544](https://forums.oracle.com/thread/2558544)

# ember.js - 在没有路由器的视图上指定控制器和模型

> ID：15993924
> 
> 赞同：0
> 
> 时间：2013-04-13T23:08:57.380
> 
> 标签：ember.js

我有一个简单的应用程序，它使用 ember-data 从 RESTful Web 服务加载并使用指定模型的路由显示数据。

```
App.AreasRoute = Ember.Route.extend({
    model: function() {
        return App.Area.find();
    }
}); 
```

然后我可以使用 {{#each content}} 在车把模板中呈现数据

但我也想在页面上显示来自不同模型的第二个数据区域。我首先创建一个视图，然后使用正确呈现视图的 {{view App.AnotherView}} 将视图呈现为我的应用程序模板的一部分。

但是，此视图没有路线，因此我无处可告诉它从哪里获取数据。我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T23:19:54.423

加载附加内容的最佳位置是在`setupController`路线的钩子上。

例如，如果您将路线定义为

```
App.AreasRoute = Ember.Route.extend({
    model: function() {
        return App.Area.find();
    },
    setupController: function(controller) {
        controller.set('someArea', App.Area.find('area_id'));
    }
}); 
```

然后可以在您的模板中访问`Area`具有 id 的模型。`area_id``{{someArea}}`

# php - 下拉未选择 - 不要过滤 mysql php

> ID：15993925
> 
> 赞同：0
> 
> 时间：2013-04-13T23:09:04.643
> 
> 标签：php, mysql

我有一个文本框搜索和下拉菜单过滤的组合。如果没有选择任何内容（第一个选项），我怎么能做到这一点 mysql select 命令不选择它作为值并且不按该值过滤任何内容？

```
select * from table where A like '$A' AND B='$B' AND C='$C' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T23:37:20.567

```
$query="select * from table where 1";

if(isset($A)&&!empty($A))
$query.=" AND A='".$A."'";

if(isset($B)&&!empty($B))
$query.=" AND B='".$B."'";

if(isset($C)&&!empty($C))
$query.=" AND C='".$C."'";

mysql_query($query); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T23:13:05.170

简单的：

```
$b = isset($_POST['b']) ? mysql_real_escape_string($_POST['b']) : 'b'; 
```

如果选择了下拉列表并且不是默认值，则在查询中使用该值。如果不是，那么只需将查询设为`B=B`，这将始终为真。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-13T23:15:06.633

首先：提问时请多注意语法，因为我个人觉得您的问题有点模糊且难以理解。

但是，如果我正确理解了您的问题，那么您应该做什么，并且在我看来这是最干净和最易读的，就是检查您的 javascript 或 PHP 代码中是否选择了任何内容，并使用两个 select 语句而不是一个。

第一个只是一个简单的

```
SELECT * FROM table; 
```

第二个是过滤的选择语句。

# c - Anagrams - 在 C 中使用链接和探测进行散列

> ID：15993928
> 
> 赞同：3
> 
> 时间：2013-04-13T23:09:12.480
> 
> 标签：c, hash, anagram

我的标题被编辑了，所以我想确保每个人都知道这是作业。问题只是优化程序，散列是我的想法。

--

我正在优化一个 C 程序，该程序将作为彼此字谜的单词组合在一起，然后将它们打印出来。

目前该程序基本上是链表的链表。外部列表中的每个链接都是一组单词，它们是彼此的字谜。

该程序的配置文件显示，到目前为止，执行时间的最大部分是函数`wordLookup`。这是因为它必须搜索每个节点，并且从文件中读取可能的 100k 字，这可能需要很长时间。例如，这里是`gprof`读取 40k 字的输出：

```
Each sample counts as 0.01 seconds.
  %   cumulative   self              self     total
 time   seconds   seconds    calls  us/call  us/call  name
100.31      1.48     1.48    40000    37.12    37.12  wordLookup
  0.00      1.48     0.00    78235     0.00     0.00  newnode
  0.00      1.48     0.00    40000     0.00     0.00  sort_string
  0.00      1.48     0.00    38235     0.00     0.00  wordInsert
  0.00      1.48     0.00     1996     0.00     0.00  swap_words
  0.00      1.48     0.00     1765     0.00     0.00  wordAppend 
```

我想让这个更快的想法是将数据结构更改为一个哈希表，该哈希表在同一个插槽中链接彼此的所有字谜。

根据我的教授所说的和我在这里读到的东西，我正在为我的哈希函数考虑类似的东西。（注意：素数的分布使得最常用的字母是低数字，最少使用的是高数字。）

```
sort(string)

array alpha_primes = 5,71,37,29,2,53,59,19,11,83,79,31,43,13,7,67,97,23,17,3,41,73,47,89,61,101
hash(String) {
  hash = 1
  for (char in String) {
    hash *= alpha_primes[char-'a'];
  }
  return hash % tablesize
} 
```

**这个问题是否有一个哈希表大小可以适当地分配值，使得每组字谜在表中都有一个不同的索引？**

如果那是不可能的，那么我应该：

*   将单词列表链接在一起（列表列表）
*   使用探测（线性或二次）解决方案
*   对于这两种情况，比较起来有哪些优点/缺点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T00:27:12.833

没有办法保证哈希是唯一的。碰撞的概率可以通过生日问题来计算，最好的办法是最小化它。

2 个组散列到相同值的概率可以近似为 1-e^((-k(k-1))/2n)，其中 k 是您拥有的组的总数（与您的单词大致相同计数），n 是哈希的搜索空间（2^（哈希长度））。

我的字典大约有 100000 个单词，使得 32b 哈希非常好（2% 的冲突）。但是，这么大的哈希表将使用 4GB 的 RAM。使用更小的桌子意味着更多的碰撞。链接或探测不会在时间上产生巨大差异。

正如对您的问题的评论中所建议的那样，trie 最终将以较小的数据结构结束。

# ios - opengl es、ios 和三角风扇

> ID：15993930
> 
> 赞同：1
> 
> 时间：2013-04-13T23:09:22.460
> 
> 标签：ios, opengl-es, vertex-buffer, gl-triangle-strip

我目前正在使用带有以下代码的三角形渲染场景：

```
 glBindVertexArrayOES(_mVertexArrayObjectTriangles);
        glBindBuffer(GL_ARRAY_BUFFER, _mVertexPositionNormalTriangles);
        glDrawElements(GL_TRIANGLES, _mCRBuffer->GetIndexTriangleData()->size(), GL_UNSIGNED_INT, 0);
        glBindBuffer(GL_ARRAY_BUFFER, 0);
        glBindVertexArrayOES(0); 
```

_mVertexArrayObjectTriangles 是我的顶点数组对象，其中包含要通过三角形呈现的元素

_mVertexPositionNormalTriangles 是我的顶点和顶点法线数组

_mCRBuffer->GetIndexTriangleData() 是我在顶点数组中的索引数组。这是一个简单的整数数组，对每个三角形进行编码（a、b、c、a、b、d 将编码两个三角形 abc 和 abd）。

一切都很好，但我想使用三角形风扇而不是三角形来渲染我的图元。如何设置要使用类似的东西绘制的三角形风扇数组（即一个以上）

```
glDrawElements(GL_TRIANGLE_FAN, .... 
```

如何设置我的索引数组来索引一组三角形风扇以进行渲染（而不是三角形）。顶点本身不需要改变，只是使用三角形扇而不是三角形来渲染它们的索引。

我可以找到使用三角形条带的好例子（[这里](http://developer.apple.com/library/ios/#documentation/3DDrawing/Conceptual/OpenGLES_ProgrammingGuide/TechniquesforWorkingwithVertexData/TechniquesforWorkingwithVertexData.html "这里")），包括如何设置索引数组，但在三角形风扇上没有。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T01:48:56.167

从条带更改为风扇并非易事，因为需要相应地设置您的数据。您必须有一个中心顶点，所有其他三角形都从该顶点发出

![在此处输入图像描述](https://i.stack.imgur.com/5fc0I.png)

如果您选择这样做，您只需按照图中所示的方式对顶点进行排序，并确保您在具有公共顶点的顶点块中进行排序。

# c++ - 扩展内联汇编：输入和输出的相同变量

> ID：15993934
> 
> 赞同：4
> 
> 时间：2013-04-13T23:09:36.030
> 
> 标签：c++, gcc, assembly, inline-assembly

我决定开始学习一些内联汇编，但是我留下了一个简单的问题，我无法找到明确的答案。

以我在教程中找到的以下简单示例为例，该示例执行简单的加法：

```
int one,two,out;

one = 1;
two = 2;

__asm__ ( "add eax, ebx;" : "=a" (out) : "a" (one) , "b" (two) ); 
```

请注意，在使用 intel 语法一段时间后，为了我自己的理智，我将 GCC 配置为使用 intel 语法而不是 AT&T。

现在假设我想省略“out”变量，而只是将输出存储在“one”中（或者“两个”，对于所有重要的事情）。

我该怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-13T23:14:04.837

利用

```
 __asm__ __volatile__(" add %0, %2": "=r" (one): "0"(one), "r" (two) ) 
```

通过使用“=r”和“r”，您不必强制编译器使用特定的寄存器，这有助于寄存器分配。“0”表示“与（输出）参数 0 使用相同”。

Edit3：`two`参数是 in `%2`，而不是 in `%1`，这只是`one`（与 相同的寄存器`%0`）的第二个副本。`%`当应该使用单时，也固定双。

Edit2：我还添加`__volatile__`以确保编译器不会移动或省略汇编代码，如果编译器认为您的代码没有做任何有用的事情[通常因为它不产生编译器稍后使用的输出]，就会发生这种情况。保证`__volatile__`编译器不会移动或删除汇编代码。

Edit1：修复语法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-13T23:27:04.193

```
__asm__ ( "add eax, ebx;" 
            : "+a" (one) 
            : "b" (two) ); 
```

修饰符表示一个“`"+"`读/写”操作数（并且必须在输出约束中使用）。

# cocoa - 将 NSDate 转换为 NSString 会导致无法识别的选择器异常

> ID：15993935
> 
> 赞同：1
> 
> 时间：2013-04-13T23:09:39.317
> 
> 标签：cocoa, cocoa-touch, nsdate, nsdateformatter

我将`NSDate`a 作为字符串存储在 plist 中，并在启动时尝试将字符串从 plist 转换回 an`NSDate`以便稍后进行比较。

这就是我在 plist 中存储值的方式：

```
[InfoDic setValue:[NSDate date] forKey:@"LastDate"]; 
```

在日志中（当我将 转换`[NSDate date]`为正确的字符串时）它说：

```
2013-04-13 22:47:57 +0000 
```

这就是我尝试将 plist 值转换回的方式`NSDate`：

```
NSString *Checkdate= [InfoDic objectForKey:@"LastDate"];
NSDateFormatter *DateFormat=[[NSDateFormatter alloc]init];
[DateFormat setDateFormat:@"yyyy'-'MM'-'dd'T'HH':'mm':'ss'Z'"];
NSDate *theday=[DateFormat dateFromString:Checkdate]; 
```

这是我的 iPhone 4S 上的错误日志：

```
<Error>: -[__NSDate length]: unrecognized selector sent to instance 0x1d8715e0
<Error>: *** Terminating app due to uncaught exception 'NSInvalidArgumentException',
reason: '-[__NSDate length]: unrecognized selector sent to instance 0x1d8715e0'
    *** First throw call stack:
(0x31e5c2a3 0x39b7997f 0x31e5fe07 0x31e5e531 0x31db5f68 0x327c213d 0x327c208d 0x327c237b 0x23fe1 0x33c83595 0x33cc3d79 0x33cbfaed 0x33d011e9 0x2385d 0x33cc4ad9 0x33cc4663 0x33cbc84b 0x33c64c39 0x33c646cd 0x33c6411b 0x3597a5a3 0x3597a1d3 0x31e31173 0x31e31117 0x31e2ff99
0x31da2ebd 0x31da2d49 0x33cbb485 0x33cb8301 0x235a1 0x23528) 
```

请注意，当我在我的设备上安装应用程序时，它需要第一个日期并将其存储在 plist 中。当我关闭应用程序并重新运行它时，它会给我 SIGABRT。

我该怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-13T23:19:13.460

您没有将日期作为字符串存储在 plist 中，而是将其存储为日期。

该行：

```
[InfoDic setValue:[NSDate date] forKey:@"LastDate"]; 
```

存储实际`NSDate`对象。

您只需致电：

```
NSDate *theDay = InfoDic[@"LastDate"]; 
```

顺便说一句 - 这条线：

```
[InfoDic setValue:[NSDate date] forKey:@"LastDate"]; 
```

应该：

```
[InfoDic setObject:[NSDate date] forKey:@"LastDate"]; 
```

要不就：

```
InfoDic[@"LastDate"] = [NSDate date]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-13T23:19:05.517

你把事情复杂化了。是什么让你认为存储一个`NSDate`对象你会得到一个`NSString`？

做就是了

```
NSDate * checkDate = [InfoDic objectForKey:@"LastDate"]; 
```

另外，不要将`KVC`方法与`NSDictionary`方法混淆。

如果你不想面对糟糕的惊喜，你想使用`setObject:forKey:`而不是。`setValue:forKey`

# java - 使用 Java（无 javascript、无 java servlet 或任何其他语言）从数据库中检索 HTML 数据

> ID：15993939
> 
> 赞同：-2
> 
> 时间：2013-04-13T23:11:01.537
> 
> 标签：java, html, mysql, database, multithreading

如何在 Java 中创建一个多线程 Web 服务器，当请求从本地 Web 浏览器客户端传递时，该服务器能够从数据库表中检索学生的所有数据并以表格式显示在网页上。

我可以获取在 html 中显示数据的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T23:19:15.007

好吧，创建一个模型 Web 服务器是没有意义的。

如果您的任务目标是提供具有所需功能的 Web 应用程序，则安装[Tomcat](http://tomcat.apache.org/)，并结合使用[Spring MVC](http://static.springsource.org/spring/docs/3.2.x/spring-framework-reference/html/mvc.html)与[Hibernate](http://www.hibernate.org/)和[JSP](http://www.jsptut.com/)来构建网站。

使用带有[Maven插件的](http://maven.apache.org/)[Eclipse](http://www.eclipse.org/)可以极大地简化您的工作。

如果不合适，也可以这样做，但首先实现您自己的[Servlet Container](http://www.onjava.com/pub/a/onjava/2003/05/14/java_webserver.html)来代替*Tomcat*。

# r - R中的apply语句有问题

> ID：15993940
> 
> 赞同：2
> 
> 时间：2013-04-13T23:11:02.053
> 
> 标签：r, apply

我想使用 apply 语句对 R 中数据框的每一行做一些事情。

以下工作我用一堆参数和索引 i 调用函数“calc.Sphere.Metrics”。我将结果存储在每一行中。

```
for(i in 1: dim(position.matrix)[1]){
   results.obs[i,] <- calc.Sphere.Metrics(i, culled.mutation.data, position.matrix, protein.metrics, radius) 
 } 
```

我已经尝试了几个 apply，mapply 语句，但没有运气。这样做的正确方法是什么？

编辑：根据要求，这是 calc.Sphere.Metrics 的骨架

```
calc.Sphere.Metrics <- function(index, culled.mutation.data, position.matrix, protein.metrics, radius){
  results <- matrix(data = 0, nrow = 1, ncol = 8)
  colnames(results) <- c("Line.Length","Center", "Start","End","Positions","MutsCount","P.Value", "Within.Range")
  results <- as.data.frame(results)

 ....
 look up a bunch of stuff and fill in each column of results. All the data required is in the parameters passed in and the index.  
 .....
 return(results)
} 
```

Results 与 top 函数中的 results.obs 具有相同的列数。希望这可以帮助！

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-13T23:16:57.427

大概是这样的：

```
result.obs <- do.call(rbind, lapply(seq_len(dim(position_matrix)[1]),
    calc.Sphere.Metrics, culled.mutation.data, position.matrix, protein.metrics, radius)) 
```

# javascript - 如果为 false，则 local.Storage 重定向

> ID：15993949
> 
> 赞同：-1
> 
> 时间：2013-04-13T23:13:12.723
> 
> 标签：javascript, html, redirect, local-storage

我有一个需要像 cookie 一样进行验证的网站。但我想使用本地存储，因为它是一个移动概念。我知道该项目是通过测试设置的，但是当它不正确时，我无法让页面重定向。

```
<script language="javascript">
 if (localStorage.getItem('itemVerified') = 'True') {
window.location = "success.html";
}
else {
alert("You are not able to enter this site!");
window.location = "error.html";
}
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T08:47:37.720

可能有两个错误，第一个是您的比较字符串缺少 = 符号：

不正确：`if (localStorage.getItem('itemVerified') = 'True') {`

正确的：`if (localStorage.getItem('itemVerified') == 'True') {`

第二种情况是，如果您要检查从中加载文档的站点，您需要将操作添加到事件侦听器中，您可以执行以下操作。

```
 <script type="text/javascript">
     var verifyCookie = function(){

   if (localStorage.getItem('itemVerified') == 'True') {
    console.log("All right");
        window.location = "success.html";
   }
   else {
    alert("You are not able to enter this site!");
    window.location = "error.html";
   }
      };
     window.addEventListener ('DOMContentLoaded', verifyCookie, false);
    </script> 
```

问候。

# c - 使用动态成员创建全局结构

> ID：15993950
> 
> 赞同：1
> 
> 时间：2013-04-13T23:13:14.063
> 
> 标签：c, struct, global-variables, ipc

我有以下内容：

```
struct t{
    char arr[variable_len];
    int i;
};

int main(int argc, char *argv[]){
    // set size of arr to length of argv[1]
} 
```

有没有办法做到这一点？我最初只是想让 arr 成为指向数组的指针并单独分配数组，但这会产生大量问题，因为我想将此结构写入管道（将写入指针而不是实际数组）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T23:19:41.353

撇开缺少错误检查不谈，您可以执行以下操作...

```
struct t
{
    int i;
    int data_len;
    char arr[];
};

int main( int argc, char* argv[] )
{
    int data_len = atoi( argv[1] );
    struct t* var;

    var = malloc( sizeof( struct t ) + data_len );
    var->data_len = data_len;

    // open a pipe and do cool stuff to var

    fwrite( var, sizeof( struct t ) + var->data_len, 1, output_pipe );

    free( var );
} 
```

# ios - iPhone UDP 监听器

> ID：15993953
> 
> 赞同：1
> 
> 时间：2013-04-13T23:13:42.430
> 
> 标签：ios, objective-c, udp

我需要一些关于如何完成某事的建议。

我希望我的 iPhone 应用程序从我的服务器监听信息，然后我的服务器会将数据发送到所有监听设备。

几个问题：

1.  iDevice 是否需要使用其 IP 向服务器“注册”？因此，然后在服务器端，我将所有侦听设备 IP 存储在一个数组中，并向每个设备发送数据。
2.  它是否可以在没有初始消息的情况下简单地收听？
3.  UDP是解决这个问题的方法吗？显然我不想要一个 TCP 流，因为它是一个持续的连接。使用过多的数据。我的目标是使用尽可能少的数据从服务器接收一个小的时间戳。

任何建议，将不胜感激！

以利亚

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T23:18:47.647

如果您不想使用 Apple 推送通知，并且不想使用长轮询，我会研究类似[websockets](http://en.wikipedia.org/wiki/WebSocket)的东西。

[PHP 在Ratchet](http://socketo.me/)中有一个非常好的实现（我假设 PHP 是您的服务器端语言？）。

编辑：

稍微详细说明一下，WebSockets 将允许您立即从服务器直接传输到每个连接用户的应用程序，就像您要求的那样。

# android - 响铃时将音频路由到蓝牙 A2DP 设备 [Android]

> ID：15993964
> 
> 赞同：3
> 
> 时间：2013-04-13T23:15:53.040
> 
> 标签：android

我正在尝试确定如何在设备响铃时将非常短的音频流（通知）路由到已经与设备配对的蓝牙耳机。

当我随时播放任何音频时，它都会被路由到蓝牙设备，没问题。但是，如果我在接收到 RINGING 状态的 android.intent.action.PHONE_STATE 时尝试开始播放音频，则音频不会按预期路由。

我可以看到 AudioManager 的 setBluetoothA2dpOn 方法已被弃用，但我实际上尝试过但似乎没有效果。

我试过MediaRouter对象，但可以看到MediaRouter.getSelectedRoute(MediaRouter.ROUTE_TYPE_LIVE_AUDIO)在设备响铃时指向蓝牙设备的RouteInfo，AudioManager.isBluetoothA2dpOn为真。

那么，谁能告诉我为什么在响铃的那一刻音频路由是这样的？在这种情况下，有什么方法可以强制将音频路由到蓝牙设备？

**[更新]** 我今天又试了一次，我发现了可能是问题的原因。我创建了一个 BroadcaseReceiver 来检测 android.intent.action.PHONE_STATE 的变化。如果接收到意图并且状态当前正在响起，请检查 AudioManager 的模式，您会发现它是 MODE_NORMAL。但几秒钟后电话将开始真正响铃，并且模式将更改为 MODE_RINGTONE。尝试使用 setMode(AudioManager.MODE_NORMAL) 方法手动设置模式是无用的，即使将其设置为 MODE_NORMAL，状态仍保持为 MODE_RINGTONE。

现在，我认为问题的原因是在 MODE_RINGTONE 模式下，所有的流都被定向到手机扬声器，这里没有安卓系统提供改变模式的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T14:25:57.650

我已经尝试过使用 AudioTrack 而不是 MediaPlayer，但这没有什么区别。

然后我尝试了这样的 TextToSpeech 引擎：

在主要活动中，在创建时初始化：

```
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    textToSpeech=new TextToSpeech(this, this);
    textToSpeech.setLanguage(Locale.US);
    textToSpeech.addEarcon("[wwww]", "XXXXXXXXXXXXXXXXXXXXXXX", R.raw.a);
} 
```

在启动蓝牙实用程序类并将以下内容添加到 onScoAudioConnected 方法时，在广播接收器类中

```
textToSpeech.playEarcon("[wwww]", TextToSpeech.QUEUE_FLUSH, null); 
```

这也没有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T23:31:22.223

我认为媒体播放器会在电话响铃时释放蓝牙连接。您可以尝试获取蓝牙音频连接，看看媒体播放器现在是否通过您获得的连接播放。您可以在我的回答中使用我的课程[Using the Android RecognizerIntent with a bluetooth耳机](https://stackoverflow.com/questions/14991158/using-the-android-recognizerintent-with-a-bluetooth-headset/14993590#14993590)，看看它是否有效。课堂上的音频只有 Sco。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T20:07:49.650

如 StartBluetoothSco 方法的 JavaDoc 中所述：

> **请注意，电话应用程序始终优先使用 SCO 连接进行电话。如果在电话通话时调用此方法，它将被忽略。同样，如果在应用程序使用 SCO 连接时接收或发送呼叫，则应用程序的连接将丢失，并且不会在呼叫结束时自动返回。**`

我尝试启动 sco，然后在正常模式下播放音乐剪辑，它可以毫无问题地播放到蓝牙耳机，尽管我无法停止导致输入流播放到耳机的麦克风。然后我尝试在音乐仍在播放时从另一部手机拨打我的目标手机，我发现流已自动重定向到手机扬声器。振铃模式结束后，流并没有再次重定向到蓝牙耳机，我认为根据上面的 JavaDoc 中所述的行为是正常的。

我的猜测是，Android 会尽可能保护振铃和通话模式，以免应用程序产生任何不必要的干扰。换句话说，当处于振铃模式时，在接听电话之前不会向耳机播放任何声音，并且您甚至无法将 AudioManager 模式从振铃模式更改为另一种模式，您的模式设置器呼叫将被忽略。

# c++ - scanf - 程序等待另一个喜欢？

> ID：15993968
> 
> 赞同：5
> 
> 时间：2013-04-13T23:16:27.830
> 
> 标签：c++, printf, scanf

在下面的程序中，我希望在输入一个单词并按下回车键后，我应该会立即看到消息`printf`输出。但是，直到我输入其他一些随机单词才会发生。这是为什么？

```
#include <cstdio>
#include <cstdlib>

using namespace std;

char tictac[17];

int main() 
{
    scanf("%s\n", tictac);

    printf("%s\n", tictac);
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-13T23:20:22.480

**tl; dr**：当`scanf("%s\n", tictac);`您要求读取一个字符串时，忽略它之后的所有空白字符，然后读取一个新行。`Enter`问题在于，由于第一个空格忽略了所有空格，因此在第一个空格和第二个空格之间应该至少有一个非空格字符`Enter`（因此在接受第二个空格之前需要一些垃圾*非空格*输入`Enter`。）。

* * *

这是一个使用 \n 和 scanf 的示例。

```
char x, y;
scanf("%c", &x); 
scanf("%c", &y);
printf("%c %c", x,y); 
```

使用此代码，您将看到输入一个字符并按下`Enter`将直接转到`printf`语句。这是因为第二个 scanf 将回车（它本身是一个字符）读入 y。

```
scanf("\n%c", &y);  // This is recommended to do if you have a sequence of scanfs (but not on the first one). 
```

有了这个，杂散的回车将被忽略（或匹配）`\n`。并且正确的字符将被读到 y。

* * *

现在，当我们来到您的代码时

```
scanf("%s\n", tictac); 
```

`%s`告诉`scanf`阅读直到找到`blank character`( `space, tab or new line`)，然后**这里是捕获忽略所有空格，直到遇到非空格字符**。所以当你输入字符串时你`scanf`会忽略你按下的。**以及它后面的任何空白字符**（*尝试在第二行输入空格并按回车键。*）`Enter`

 ***这意味着这可以正常工作（与 char 版本不同）

```
scanf("%s", tictac);
scanf("%s", tictac2); 
```

* * *

实际上在[Windows上](http://support.microsoft.com/kb/67879)

> 因为“%s”导致库读取输入字符串直到找到一些空白，所以等效的格式说明符是“%[^\0x20\t\n]”，它指示库读取字符串直到遇到空格字符 (\0x20)、制表符 (\t) 或换行符 (\n)。

**但是，由于您已明确要求`scanf`匹配`\n`**

```
scanf("%s\n", tictac);
         ^^ 
```

**它将等到它得到另一个`\n`（在非空白字符之后），因为第一个被`%s`.**

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-13T23:18:20.713

`\n`从您的[*scanf*](http://www.cplusplus.com/reference/cstdio/scanf/)呼叫中删除。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-13T23:21:47.000

[这里](http://forum.codecall.net/topic/37537-how-to-use-scanf-in-c/)对 scanf 有很好的解释。在您的情况下，您应该从 scanf 函数中删除 \n 。***

# keyboard - 在 Android 中使用手势键盘自动输入文本

> ID：15993976
> 
> 赞同：2
> 
> 时间：2013-04-13T23:17:55.250
> 
> 标签：keyboard, gesture

我是 android 开发平台的新手，正在做一个项目来编写一些测试来比较一些不同的手势键盘植入（内置 android 4.2，滑动和快速键）。我在我的 IDE 中使用 ecipe，主要依靠模拟器进行测试。我在这里使用 4.2 手势键盘（[http://forum.xda-developers.com/showthread.php?t=1964663](http://forum.xda-developers.com/showthread.php?t=1964663)）。

我希望能够做什么（从 android 4.2 内置键盘开始）。

1.  传入一个字符串，例如“hello”，然后使用手势键盘输入该字符串。
2.  获取候选人视图框中显示的单词。
3.  将单词与预期单词进行比较，然后根据从 Candidates View 返回的单词是否符合我的预期返回通过/失败。
4.  将传入的 word 和返回的建议存储在日志文件中以供分析。理想情况下，我希望能够仅为此使用 API 而不是回复 UI，但我不确定这是否可能。

我正在寻找一些可能的解决方案。

使用 TouchUtils 类 ( [http://developer.android.com/reference/android/test/TouchUtils.html](http://developer.android.com/reference/android/test/TouchUtils.html) ) 在键之间绘制形状。但是，我不确定如何在设备上指定 x 和 y 坐标以映射到特定键。此外，我在此类中看不到任何可以让我绘制基于自定义形状的方法。

我也看到了 sendKeys(String keysSequence) 但这看起来就像它只是按下键并且不会练习手势键盘的东西。

所以我很好奇你们所有先进的 android 开发人员将如何处理/解决这个问题，以及是否已经有任何资源/API 可以提供帮助。

谢谢皮特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-25T05:24:38.883

你可以试试 MonkeyRunner 工具 [http://developer.android.com/tools/help/monkeyrunner_concepts.html](http://developer.android.com/tools/help/monkeyrunner_concepts.html)

或者您可以在以下两篇博文（第 1 部分和第 2 部分）中尝试“在 Android 上以编程方式注入事件”

[http://www.pocketmagic.net/2012/04/injecting-events-programatically-on-android/#.UckpTZwlubq](http://www.pocketmagic.net/2012/04/injecting-events-programatically-on-android/#.UckpTZwlubq)

[http://www.pocketmagic.net/2013/01/programmatically-injecting-events-on-android-part-2/#.UckpSZwlubp](http://www.pocketmagic.net/2013/01/programmatically-injecting-events-on-android-part-2/#.UckpSZwlubp)

# c# - 偏移定时器启动

> ID：15993978
> 
> 赞同：0
> 
> 时间：2013-04-13T23:18:05.323
> 
> 标签：c#

嗨，新来的网站，如果我的问题格式不正确，我深表歉意

如果我有两个事件需要每 2 秒交替一次（一个为 ON，另一个为 OFF），我该如何延迟其中一个计时器的启动 2 秒偏移量？

```
 static void Main(string[] args)
    {

        Timer aTimer = new Timer();
        Timer bTimer = new Timer();

        // Hook up the Elapsed event for the timer.
        aTimer.Elapsed += new ElapsedEventHandler(OnTimedEvent);
        bTimer.Elapsed += new ElapsedEventHandler(OnTimedEventb);

        // Set the Interval to 4 seconds 
        aTimer.Interval = 4000;
        aTimer.Enabled = true;
        bTimer.Interval = 4000;
        bTimer.Enabled = true;

        Console.WriteLine("Press the Enter key to exit the program.");
        Console.ReadLine();
    }
    // Specify what you want to happen when the Elapsed event is  
    // raised. 
    private static void OnTimedEvent(object source, ElapsedEventArgs e)
    {
        Console.WriteLine("The status is on {0}", e.SignalTime);
    }
    private static void OnTimedEventb(object source, ElapsedEventArgs b)
    {
        Console.WriteLine("The state is off {0}", b.SignalTime);
    } 
```

所以我基本上希望在程序启动时发生 ON 事件，然后在 2 秒后触发 OFF 事件，依此类推

使用 vs 2012 控制台应用程序，但我将在 Windows 窗体程序中使用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T23:47:42.080

例如，您可以创建一个名为 的类级别 bool`IsOn`并切换它。您只需要一个计时器来执行此操作，因为`true`这意味着它已开启，`false`也意味着它已关闭。

```
private static bool IsOn = true; //default to true (is on)
static void Main(string[] args)
{

    Timer aTimer = new Timer();

    // Hook up the Elapsed event for the timer.
    aTimer.Elapsed += new ElapsedEventHandler(OnTimedEvent);        

    // Set the Interval to 2 seconds 
    aTimer.Interval = 2000;
    aTimer.Enabled = true;    

    Console.WriteLine("Press the Enter key to exit the program.");
    Console.ReadLine();
}

// Specify what you want to happen when the Elapsed event is  
// raised. 
private static void OnTimedEvent(object source, ElapsedEventArgs e)
{
    IsOn = !IsOn;
    Console.WriteLine("The status is {0} {1}", IsOn.ToString(), e.SignalTime);
} 
```

# objective-c - UIButton setCenter 崩溃

> ID：15993986
> 
> 赞同：0
> 
> 时间：2013-04-13T23:18:58.983
> 
> 标签：objective-c, xcode

我有一系列正在创建的按钮。但是，当我调用 setCenter 时，代码会崩溃。

```
buttonsArray = [NSMutableArray new];
    for (int i = 0; i < 7; i++) {
        [buttonsArray addObject:[UIButton buttonWithType:UIButtonTypeCustom]];
        UIButton *tempButton = [buttonsArray objectAtIndex:i];
        [tempButton setFrameWidth:300.0 andHeight:50.0];
        [tempButton addBlackBorderWidth:1.0];
        [tempButton roundCornersBy:10.0];
        [tempButton setBackgroundColor:[UIColor blackColor]];
        [tempButton setColorToGradientFromColor:[UIColor grayColor] toColor:[UIColor blackColor]];
        [tempButton setButtonTextColorForNormalState:[UIColor whiteColor] highlightedState:[UIColor redColor]];
        [tempButton setCenter:CGPointMake([self screenUsableWidth] / 2.0, ([self screenUsableHeight] - 2.0 * MAIN_MENU_BUTTON_TO_SIDE_DISTANCE) * i / ([buttonsArray count] - 1) + MAIN_MENU_BUTTON_TO_SIDE_DISTANCE)]; //crash is here
    } 
```

错误是`*** Terminating app due to uncaught exception 'CALayerInvalidGeometry', reason: 'CALayer position contains NaN: [384 nan]'`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T23:25:54.703

坐标计算的一部分`y`是除以`([buttonsArray count] - 1)`。

在循环中的第一次，这等于 0。除以 0 通常被认为是一件坏事。

您需要更改该计算以避免被零除。也许将其更改为您的实际循环计数而不是当前数组计数。

# ruby-on-rails - 限制用户在博客中创建新文章会给出“未定义的方法‘is_admin?’ ruby on rails 应用程序中的 nil:NilClass"

> ID：15993993
> 
> 赞同：0
> 
> 时间：2013-04-13T23:19:43.537
> 
> 标签：ruby-on-rails, ruby, devise, admin

我正在用 ruby​​ on rails 实现博客应用程序，我想限制普通用户（只有管理员可以创建）创建新文章。为此，我将 befor_filter 放在了后面的articles_controller.rb 文件中。我已经在 UI 中隐藏了用户的创建按钮，但普通用户仍然可以通过在浏览器的地址栏中键入来创建新文章。通过使用下面的代码，普通用户无法进入新文章页面，但它给了我“未定义的方法 `is_admin?我在地址栏中输入。有关更多信息，我已经实现了用户身份验证设计。

```
class ArticlesController < ApplicationController
  before_filter :is_user_admin, only: [:new, :create]

  def is_user_admin
    unless  current_user.is_admin?
      :root 
      return false
    end
  end
end 

class ArticlesController < ApplicationController
  before_filter :is_user_admin, only: [:new, :create]

  def is_user_admin
    unless  current_user.is_admin?
      :root 
      return false
    end
  end

    def index
        @articles = Article.all(:order => "created_at DESC")
    end

    def show
      @article = Article.find(params[:id])
    end

    def new
      @article = Article.new
    end

    def create
      @article = Article.new(params[:article])
      @article.user_id = current_user.id
      @article.save
      redirect_to article_path(@article)
    end

    def destroy
      @article = Article.find(params[:id])
      @article.destroy
      redirect_to action:  'index'  
    end

    def edit
      @article = Article.find(params[:id])
    end

    def update
      @article = Article.find(params[:id])
      @article.update_attributes(params[:article])
      flash.notice = "Article '#{@article.title}' Updated!"
      redirect_to article_path(@article)
     end
end 
```

applicaiton_controller.rb

```
class ApplicationController < ActionController::Base
    protect_from_forgery
      def after_sign_in_path_for(user)
         if current_user.is_admin?
             dashboard_index_path
         else
             :root
         end
      end

end 
```

基本上，我想限制普通用户（管理员除外）从 UI（完成）或在地址栏中输入地址来创建、更新或删除文章。我不知道为什么我会得到这个，我能做些什么来避免这种情况。我是否应该在 application_controller.rb 文件中编写上述方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T23:24:14.443

你`current_user`的显然是零。

您应该放在`before_filter :authenticate_user!, :except => [:show, :index]`控制器的顶部以验证用户身份。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-13T23:42:16.370

您可能希望将用户重定向到登录，以便他们无法访问控制器中的操作（如果他们不是管理员）。因此，您可以执行以下操作：

```
def is_user_admin
  redirect_to(action: :index) unless current_user.try(:is_admin?)
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-14T00:10:58.180

在检查权限之前，请确保至少有一个用户。您可以将此代码添加到需要身份验证的每个控制器：

```
 before_filter :authenticate_user! 
```

这样做，您将始终拥有当前用户，因此将能够按照您在问题上指出的方式检查其权限。

# c++ - 为什么我的命令行参数处理会使我的程序崩溃？

> ID：15993994
> 
> 赞同：0
> 
> 时间：2013-04-13T23:19:44.687
> 
> 标签：c++, command-line-arguments, argv

为什么看起来如此简单的事情会导致我的程序崩溃？

我正在尝试获取一个值，`n`以使数组的大小`N`和对其执行各种操作，但这不是重点。无论如何，每次我尝试访问时它都会崩溃`argv[1]`。

```
int main(int argc, char * argv[])
{
  int n;
  n = atoi(argv[1]); //Crashes here!
  cout << "\nN: " << n << endl;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T23:48:36.063

Does argv[1] exist? To prevent your code from accessing memory it should not check how many arguments were passed.

```
if(argc >= 2)
  n = argv[1];
else
  std::cout << "Proper usage: .....\n"; 
```

This seems like a great time to learn how to use your debugger to view the contents of argv and argc.

# jquery - jquery ui tabs Uncaught TypeError: Object [object Object] has no method 'tabs'

> ID：15993997
> 
> 赞同：-1
> 
> 时间：2013-04-13T23:20:05.250
> 
> 标签：jquery, jquery-ui, jquery-tabs

我收到此错误：未捕获的类型错误：对象 [对象对象] 没有方法“选项卡”，也没有找到任何有用的链接。这是我的标记，任何人都可以帮我弄清楚为什么我会遇到这个问题吗？

```
<script src="~/Scripts/jquery-1.9.1.min.js"></script>
<script src="~/Scripts/jquery-ui-1.8.24.js"></script>
<script>
$(document).ready(function () {
  $("#tabs").tabs();
});
</script> 
```

标记是：

```
<div id="tabs" class="ui-tabs">
  <ul>
    <li>
      <a href="#tabs-1"></a>
    </li>
    <li>
      <a href="#tabs-2"></a>
    </li>
    <li>
      <a href="#tabs-3"></a>
    </li>
    <li>
      <a href="#tabs-4"></a>
    </li>
  </ul>
</div>
<div id="tabs-2"></div>
<div id="tabs-3"></div>
<div id="tabs-4"></div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-20T11:26:46.660

您最有可能在下面页面的其余部分调用另一个 jquery 库，这是一个旧版本，不包含选项卡功能。您需要删除该行，例如

```
<script src="Scripts/jquery-1.4.4.min.js" type="text/javascript"></script> 
```

这通常发生在 jsCarousel

如果问题依然存在，能否发下链接

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T23:21:44.363

它应该是：

```
$("#tabs").tabs(); 
```

您缺少`#`前面的指示元素`id="tabs"`

选项卡的设置如下所示。您似乎缺少所有选项卡内容并确保实际加载了 jquery ui 库（路径正确）：

```
<div id="tabs">
  <ul>
    <li><a href="#tabs-1">Nunc tincidunt</a></li>
    <li><a href="#tabs-2">Proin dolor</a></li>
    <li><a href="#tabs-3">Aenean lacinia</a></li>
  </ul>
  <div id="tabs-1">
    <p>Proin elit arcu, rutrum commodo, vehicula tempus, commodo a, risus. Curabitur nec arcu. Donec sollicitudin mi sit amet mauris. Nam elementum quam ullamcorper ante. Etiam aliquet massa et lorem. Mauris dapibus lacus auctor risus. Aenean tempor ullamcorper leo. Vivamus sed magna quis ligula eleifend adipiscing. Duis orci. Aliquam sodales tortor vitae ipsum. Aliquam nulla. Duis aliquam molestie erat. Ut et mauris vel pede varius sollicitudin. Sed ut dolor nec orci tincidunt interdum. Phasellus ipsum. Nunc tristique tempus lectus.</p>
  </div>
  <div id="tabs-2">
    <p>Morbi tincidunt, dui sit amet facilisis feugiat, odio metus gravida ante, ut pharetra massa metus id nunc. Duis scelerisque molestie turpis. Sed fringilla, massa eget luctus malesuada, metus eros molestie lectus, ut tempus eros massa ut dolor. Aenean aliquet fringilla sem. Suspendisse sed ligula in ligula suscipit aliquam. Praesent in eros vestibulum mi adipiscing adipiscing. Morbi facilisis. Curabitur ornare consequat nunc. Aenean vel metus. Ut posuere viverra nulla. Aliquam erat volutpat. Pellentesque convallis. Maecenas feugiat, tellus pellentesque pretium posuere, felis lorem euismod felis, eu ornare leo nisi vel felis. Mauris consectetur tortor et purus.</p>
  </div>
  <div id="tabs-3">
    <p>Mauris eleifend est et turpis. Duis id erat. Suspendisse potenti. Aliquam vulputate, pede vel vehicula accumsan, mi neque rutrum erat, eu congue orci lorem eget lorem. Vestibulum non ante. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Fusce sodales. Quisque eu urna vel enim commodo pellentesque. Praesent eu risus hendrerit ligula tempus pretium. Curabitur lorem enim, pretium nec, feugiat nec, luctus a, lacus.</p>
    <p>Duis cursus. Maecenas ligula eros, blandit nec, pharetra at, semper at, magna. Nullam ac lacus. Nulla facilisi. Praesent viverra justo vitae neque. Praesent blandit adipiscing velit. Suspendisse potenti. Donec mattis, pede vel pharetra blandit, magna ligula faucibus eros, id euismod lacus dolor eget odio. Nam scelerisque. Donec non libero sed nulla mattis commodo. Ut sagittis. Donec nisi lectus, feugiat porttitor, tempor ac, tempor vitae, pede. Aenean vehicula velit eu tellus interdum rutrum. Maecenas commodo. Pellentesque nec elit. Fusce in lacus. Vivamus a libero vitae lectus hendrerit hendrerit.</p>
  </div>
</div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-09T00:47:28.377

发生这种情况是因为您使用的是旧版本的 Jquery。使用最新版本再试一次。我遇到了同样的问题，但是当我使用 1.9.1 版本的 Jquery 时，它起作用了。