# StackOverflow 问答 14059000-14059999

# android - 显示从自定义适配器创建的视图的动画

> ID：14059005
> 
> 赞同：0
> 
> 时间：2012-12-27T17:56:15.123
> 
> 标签：android

我正在尝试显示`View`我从适配器创建的所有 s 的动画。当我向下滚动时，它会正确显示动画，但是当我向上滚动时，我会看到这些`View`s 重新创建并再次显示动画。然后，当我向下滚动时，它再次发生。

我的假设是`View`从适配器创建 a 的机制是将其加载`View`到内存中；只是`View`现在屏幕上的 s 组（但上方和下方的视图不会加载到内存中）。当我滚动到这些视图时，这些将再次加载，对吗？

有没有办法解决这个问题？

PS：对不起我的英语，希望你能理解我的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T19:10:33.367

> 我的假设是从适配器创建视图的机制是将视图加载到内存中；只是现在屏幕上的一组视图（但上面和下面的视图没有加载到内存中）

这有点正确：a`ListView`不会尝试可视化任何（至少部分）不可见的数据。它还“回收”视图，这意味着当前未用于向用户呈现数据并且与下一个数据项具有相同“类型”的任何视图都可以被重用。

因此，您不应依赖持久化数据或对特定视图的存在做出任何假设。相反，使用与视图分开的东西；例如，您正在可视化的数据集。

很多时候，您将提供一个 POJO 列表给 a`BaseAdapter`或`ArrayAdapter`. 您可以简单地向 POJO 添加一个布尔值，指示它是否应该动画，并在该特定项目的动画完成时更改它。或者，您可以在单独的集合中跟踪这些值（如果您处理的`Cursor`是数据源而不是 POJO，这可能是更直接的方法）。

# android - How I can get available timezones (android:settings)

> ID：14059007
> 
> 赞同：7
> 
> 时间：2012-12-27T17:56:19.040
> 
> 标签：android, timezone, settings

I want to get **TimeZones**, that I can see in settings: **Date and Time** -->

![Select time zone](../Images/55b95536f015bd791f9df87e1631ee7d.png)

Yes, I know, that in java/android can get all timezones by `TimeZone.getAvailableIDs()`, but I want get only timezones, that exists on

![settings screen](../Images/55b95536f015bd791f9df87e1631ee7d.png).

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2016-03-17T18:21:35.563

正如您所注意到的，可以`TimeZone`通过调用来获取设备上所有可用的 s的列表`TimeZone.getAvailableIDs()`，但是，这通常会返回一个包含 500`TimeZone`多个 s 的列表，其中 a`displayName`并不总是用户友好的（例如 a `GMT+05:00`）。

所以现在，如果你看一下 Android 的时区列表，它只包含大约 80 个元素，名称格式很好。通过查看源代码（直到 Kitkat），您可以看到它们实际上是从位于[`/res/xml/timezones.xml`](https://android.googlesource.com/platform/packages/apps/Settings/+/kitkat-release/res/xml/timezones.xml). 每行定义如下：

`<timezone id="America/New_York">Eastern Time</timezone>`

所以他们所做的是解析整个`timezones.xml`文件并将[(Olson)`id`和`text`List of Timezone`Map`](https://github.com/aosp-mirror/platform_packages_apps_settings/blob/master/src/com/android/settings/datetime/ZonePicker.java)。

```
public static SimpleAdapter constructTimezoneAdapter(Context context,
            boolean sortedByName, int layoutId) {
        final String[] from = new String[] {ZoneGetter.KEY_DISPLAYNAME, ZoneGetter.KEY_GMT};
        final int[] to = new int[] {android.R.id.text1, android.R.id.text2};

        final String sortKey = (sortedByName ? ZoneGetter.KEY_DISPLAYNAME : ZoneGetter.KEY_OFFSET);
        final MyComparator comparator = new MyComparator(sortKey);
        final List<Map<String, Object>> sortedList = ZoneGetter.getZonesList(context);
        Collections.sort(sortedList, comparator);
        final SimpleAdapter adapter = new SimpleAdapter(context,
                sortedList,
                layoutId,
                from,
                to);

        return adapter;
    } 
```

接下来，对于`Map`该列表中的每个时区，他们检索关联的`TimeZone`感谢`TimeZone.getTimeZone(String id)`并将关联的`offset`和添加`GMT`到它。

所以最后，它们真正显示的是一个时区列表，它们从文件中检索 ID `timezones.xml`：.

* * *

如果您每个时区有一个 id，则可以使用的方法是制作一个 Olson id 列表并显示它们的`displayName`. 如果你有更多，这可能行不通，因为一些 Olson id 与`displayName`其他 ID 相同，例如：`Europe/Amsterdam`并且`Europe/Brussels`都指`European Central Time`.

注意：这篇文章主要关注 Kit Kat，可能不适用于低/高版本。如果您想获得更多关于您自己的版本的信息，请参考：[此链接](https://android.googlesource.com/platform/packages/apps/Settings/+refs)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-27T18:57:43.300

```
String[]TZ = TimeZone.getAvailableIDs();
        ArrayList<String> TZ1 = new ArrayList<String>();
        for(int i = 0; i < TZ.length; i++) {
            if(!(TZ1.contains(TimeZone.getTimeZone(TZ[i]).getDisplayName()))) {
                TZ1.add(TimeZone.getTimeZone(TZ[i]).getDisplayName());
            }
        } 
```

> 我想这个对你有帮助

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-27T22:34:41.443

是的，我已经尝试选择一个偏移量 - 一个时区。但在这种情况下会出现另一个错误。我使用这个时区以编程方式将事件添加到谷歌日历（解析 ics 文件）。在某些时区我有问题。例如，我添加了时区 +6 GMT 的事件。

getAvailableIDs() 以这个偏移量返回某个第一个时区（我不完全记得，但时区是“.../Vostok”）。如果我尝试使用这个时区添加事件，那么我在 Google 日历 Android 应用程序中打开了这个添加的事件，然后看到，该时区设置不是正常的“美国/纽约”或“欧洲/莫斯科”，而只是“+ 6 GMT”。

所以我开始查看列表“标准”时区。现在我用了另一种方式。我在谷歌日历[源](https://android.googlesource.com/platform/packages/apps/Calendar.git)中搜索，发现他们没有在运行时使用一些 proc 获取时区，而只是在静态数组中设置了一些时区 ID。现在我也使用了这个列表。我不知道，这个列表是如何从 android 版本改变的。但在 4.x 和 2.x 上工作正常

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-27T18:03:38.783

一旦你调用了`TimeZone.getAvailableIDs();`，你就可以使用它[`TimeZone.getTimeZone(id)`](http://developer.android.com/reference/java/util/TimeZone.html#getTimeZone%28java.lang.String%29)来获取一个[`TimeZone`](http://developer.android.com/reference/java/util/TimeZone.html)对象。使用此对象，您可以获得名称（使用[`.getDisplayName()`](http://developer.android.com/reference/java/util/TimeZone.html#getDisplayName%28%29)）或偏移量（使用[`.getRawOffset()`](http://developer.android.com/reference/java/util/TimeZone.html#getRawOffset%28%29)，它返回毫秒偏移量）。

```
String[] timezones = TimeZone.getAvailableIDs();
for (String tzId : timezones) {
    TimeZone tz = TimeZone.getTimeZone(tzId);
    String name = tz.getDisplayName();
    int offset = tz.getRawOffset();
    // ...
} 
```

# javascript - Ember.js Bindings and Templates

> ID：14059009
> 
> 赞同：1
> 
> 时间：2012-12-27T17:56:26.667
> 
> 标签：javascript, ember.js

I'm testing the main features of Ember.js. According to the provided Guide, the following code, using simply Bindings and Auto-Updating templates should output `Hey there! This is My Ember.js Test Application!` but instead it outputs `Hey there! This is !`.

JS:

```
// Create the application.
var Application = Ember.Application.create();

// Define the application constants.
Application.Constants = Ember.Object.extend({
    name: 'My Ember.js Test Application'
});

// Create the application controller.
Application.ApplicationController = Ember.Controller.extend();

// Create the application view.
Application.ApplicationView = Ember.View.extend({
    templateName: 'application',
    nameBinding: 'Application.Constants.name'
});

// Create the router.
Application.Router = Ember.Router.extend({
    root: Ember.Route.extend({
        index: Ember.Route.extend({
            route: '/'
        })
    })
})

// Initialize the application.
Application.initialize(); 
```

HBS:

```
<script type="text/x-handlebars" data-template-name="application">
    <h1>Hey there! This is <b>{{name}}</b>!</h1>
</script> 
```

Is there something I am doing wrong?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T18:11:42.490

当您从模板中引用视图的属性时，您必须在其前面加上`view`关键字。

所以试试

```
<script type="text/x-handlebars" data-template-name="application">
  <h1>Hey there! This is <b>{{view.name}}</b>!</h1>
</script> 
```

它应该工作。

哦，我忘记了，绑定错误，你必须引用一个对象而不是一个类。尝试

```
Application.constants = Ember.Object.create({
  name: 'My Ember.js Test Application'
}); 
```

和

```
Application.ApplicationView = Ember.View.extend({
  templateName: 'application',
  nameBinding: 'Application.constants.name'
}); 
```

# android - Get the icon of the source app of an intent

> ID：14059010
> 
> 赞同：0
> 
> 时间：2012-12-27T17:56:26.717
> 
> 标签：android, android-intent, android-activity

in my app I would like to get the icon of the app which from the user triggered the intent. For example when sharing site url from google chrome I would like to get the chrome icon. I have found something here on stackoverflow and it seems like this will be little bit tricky. The problem is I am using an IntentService in the part of my app where I need the icon and I dont know how to manage `getCallingActivity` be working in this context. It also won't work if the intent wouldn't be called with `startActivityForResult`, I guess..

So please does anyone from you know about reliable solution how to get the icon?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T17:58:56.843

> For example when sharing site url from google chrome I would like to get the chrome icon

That is not possible, because you have no way to know what used the `Intent`.

# jquery - 从 jQuery 和 Chrome 访问本地文件系统？

> ID：14059014
> 
> 赞同：0
> 
> 时间：2012-12-27T17:56:34.750
> 
> 标签：jquery, html, file-io

我有一个由其他应用程序生成的 html 页面，并将文件系统上的一堆图像链接在一起。这个 html5 文件不是由网络服务器提供的，它只是本地的。

目前，它使用 ActiveXObject("Scripting.FileSystemObject") 允许我根据一些用户输入在文件系统上查找目录/文件，但当然它依赖于 IE。

jQuery 中是否有等价的东西可以让我拥有相同或相似的功能，但更独立于浏览器？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T18:04:08.150

我不认为这是可能的。本文解释了由于来自网站的潜在恶意使用，不允许 JavaScript 文件访问：[Local file access with javascript](https://stackoverflow.com/questions/371875/local-file-access-with-javascript)。JQuery 是建立在 JavaScript 之上的，所以应该也是如此。

# linux - 为什么 sort -u 将 U+2161 和 U+2162 视为同一个字符？

> ID：14059015
> 
> 赞同：7
> 
> 时间：2012-12-27T17:56:35.123
> 
> 标签：linux, sorting, unicode, gnu-coreutils

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T18:21:18.453

尝试设置`LC_COLLATE=C`；那能解决吗？这对我有用：

```
$ export LANG=en_US.UTF-8
$ export LANGUAGE=en_US:en
$ export LC_CTYPE="en_US.UTF-8"
$ export LC_NUMERIC=en_US.UTF-8
$ export LC_TIME=en_US.UTF-8
$ export LC_COLLATE="en_US.UTF-8"
$ export LC_MONETARY=en_US.UTF-8
$ export LC_MESSAGES="en_US.UTF-8"
$ export LC_PAPER=en_US.UTF-8
$ export LC_NAME=en_US.UTF-8
$ export LC_ADDRESS=en_US.UTF-8
$ export LC_TELEPHONE=en_US.UTF-8
$ export LC_MEASUREMENT=en_US.UTF-8
$ export LC_IDENTIFICATION=en_US.UTF-8
$ export LC_ALL=
$ sort -u foo.txt |wc -l         # <-- with your env variables
1
$ export LC_COLLATE=C
$ sort -u foo.txt |wc -l         # <-- with LC_COLLATE changed to C
2 
```

查看我的 /usr/share/i18n/locales/en_US 副本，我看到：

```
LC_COLLATE
% Copy the template from ISO/IEC 14651
copy "iso14651_t1"
END LC_COLLATE 
```

这大概是从哪里来的。不知道为什么它告诉这些要整理在一起。

# uiimageview - Add programmatically UIImageView adapted for 3.5 and 4 inch

> ID：14059020
> 
> 赞同：0
> 
> 时间：2012-12-27T17:57:06.333
> 
> 标签：uiimageview, uiimage, frame

![enter image description here](../Images/bff251006e191214d7df67c5c689d8a4.png)

I would like to add an UIImageView to this view. Can anyone help me please?

The problem is the compatibilities for 4/3.5 inch

I tryed this

```
UIImageView *imageView = [[UIImageView alloc] initWithFrame:CGRectMake(0, 0, 320, self.view.bounds.size.height)];
[imageView setImage:[UIImage imageNamed:@"test.png"]];
[self.view addSubview:imageView]; 
```

but the image comes out of the screen!

Thank you!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T18:01:33.087

控制器使用默认大小创建并在`viewDidLoad`. 根据您创建图像视图的位置，它可能会给您带来问题

添加此代码：

```
imageView.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight; 
```

还要确保您没有其他不想让图像越过的视图，例如底部工具栏

# jquery - collapse panel - how to open one but close others

> ID：14059025
> 
> 赞同：1
> 
> 时间：2012-12-27T17:57:25.537
> 
> 标签：jquery

I have this jquery code that adds a class of 'close' and slides in an element, but I want all others to close when one of them is opened. So if I click to open one of them, I want the others that are open to close, but I can't do it. HTML:

```
<div class="main">
<h2>Question 1?</h2>
  <div class="answer">
    <p>bla bla bla</p>
  </div>
  <h2>question 2</h2>
  <div class="answer">
    <p>bla bla bla</p>
  </div>
  <h2>Question 3?</h2>
  <div class="answer">
    <p>bla bla bla</p>
  </div>
</div> 
```

I have this jquery:

```
$(document).ready(function() {
 $('.answer').hide();
 $('.main h2').toggle(
    function() {
       $(this).next('.answer').slideDown();
       $(this).addClass('close');

    },
    function() {
       $(this).next('.answer').fadeOut();
       $(this).removeClass('close');
  }
    ); // end toggle
}); // end ready
</script> 
```

i tried adding this to the first function but on click it just slides down and then up.

```
$('.main .answer').not(this).slideUp(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T18:02:19.350

```
$(document).ready(function() {
    $('.answer').hide();
    $('.cat_info h2').on('click', function() {
        var state = $(this).next('.answer').is('.open');
        if (state) {
            $(this).next('.answer').removeClass('open').fadeOut();
        }else{
            $(this).next('.answer').addClass('open').slideDown()
                   .siblings('.answer').removeClass('open').slideUp();
        }
    });
});​ 
```

[**小提琴**](http://jsfiddle.net/adeneo/kahZw/1/)

仅供参考：[不推荐](http://api.jquery.com/category/deprecated/)`toggle()`使用这种方式

# java - java google app engine get entity by key

> ID：14059026
> 
> 赞同：0
> 
> 时间：2012-12-27T17:57:34.707
> 
> 标签：java, google-app-engine, entity, jdo

I have a problem using GAEJ and JDO for storing the data. This is what I'm working with:

class Usuari.java:

```
@PrimaryKey
@Persistent(valueStrategy = IdGeneratorStrategy.IDENTITY)
private Key key;

@Persistent
private String email;

@Persistent
private String rol=""; 
```

class DBUtils.java: I've tried with two ways of doing the delete operation:

```
// This method removes a record from the database using its unique Key
public static boolean eliminar(Key k) throws Exception {
    PersistenceManager pm = PMF.get().getPersistenceManager();
    String kind;
    Long id;
    kind = k.getKind();
    id = k.getId();
    try {
        if (k.getKind().equals("Usuari")) {
            Usuari u = (Usuari)pm.getObjectById(k);
            pm.deletePersistent(u);
            _log.log(Level.INFO, "Deleted an entity->kind: " + kind + " id: " + id);
        }

        return true;
    } catch (Exception e) {
        _log.log(Level.SEVERE, "Unable to delete an entity->kind: " + kind + " id: " + id);
        System.err.println(e.getMessage());
        throw e;
    }
    finally {
        pm.close();
    }
}

// This method removes a record from the database using its unique Key - too
public static void eliminar2(Key k) throws Exception {
    PersistenceManager pm = PMF.get().getPersistenceManager();
    javax.jdo.Transaction tx = pm.currentTransaction();
    try
    {
        tx.begin();
        if (k.getKind().equals("Usuari")) {
            Usuari u = (Usuari) pm.getObjectById(k);
            pm.deletePersistent(u);
        }
        tx.commit();
    }
    catch (Exception e)
    {
        if (tx.isActive())
        {
            tx.rollback();
        }
        throw e;
    }
} 
```

I'm able to create new instances of some class "Usuari" but I can't delete them. Everytime I call "eliminar" or "eliminar2" methods I get a "No such object" as result of trying to fetch it. I've checked manually and I see the object exists in my admin panel, with its ID and KIND, so I don't know what am I doing wrong.

Any help would be much appreciated.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T19:00:22.680

`PM.getObjectById``Key`根据 JDO 规范，不接受对象。它接受一个*身份*对象，与您获得的类型相同`pm.getObjectId(obj)`；建议您浏览一下 JDO 规范。毫无疑问，如果您检查了此方法返回的内容，您会发现它找不到具有该“身份”的对象，因为 Key 不是身份。你也可以做

```
pm.getObjectById(Usuari.class, key); 
```

这在 GAE 文档中显示得非常清楚。

仍然不明白为什么用户将@Persistent 放在每个字段上，几乎每种类型都是默认持久的；只会导致代码更不可读。

# php - How to randomly loop through first layer of nested associative array in PHP?

> ID：14059027
> 
> 赞同：0
> 
> 时间：2012-12-27T17:57:46.787
> 
> 标签：php, loops, random, associative-array

I have a nested assocative array which might look something like this:

```
$myarray = array(
  ['tiger'] => array(
    ['people'], ['apes'], ['birds']
  ),
  ['eagle'] => array(
    ['rodents'] => array(['mice'], ['squirrel'])
  ),
  ['shark'] => ['seals']
); 
```

How can I loop through the first layer (tiger, eagle, shark) in a random order and ensure that I cover them all in my loop? I was looking at the PHP function shuffle();, but I think that function messes up the whole array by shuffling all layers.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T18:03:40.303

您可以像这样对数组进行随机排序，它将保留键和值

```
<?php
$myarray = array(
  'tiger' => array(
    'people', 'apes', 'birds'
  ),
  'eagle' => array(
    'rodents' => array('mice', 'squirrel')
  ),
  'shark' => 'seals'
);

$shuffleKeys = array_keys($myarray);
shuffle($shuffleKeys);
$newArray = array();
foreach($shuffleKeys as $key) {
    $newArray[$key] = $myarray[$key];
}

print_r($newArray); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T18:06:32.693

您可以使用[`array_keys()`](http://php.net/manual/en/function.array-keys.php). [`shuffle()`](http://php.net/manual/en/function.shuffle.php)然后，您可以使用并遍历它来打乱生成的键数组。

例子：

```
$keys = array_keys($myarray);
shuffle($keys);
foreach ($keys as $key) {
  var_dump($myarray[$key]);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T18:05:17.617

根据我的测试，shuffle 只会随机化 1 层。自己试试：

```
<?php
$test = array(
        array(1,2,3,4,5),
        array('a','b','c','d','e'),
        array('one','two','three','four','five')
    );
shuffle($test);
var_dump($test);
?> 
```

# jquery - onclick="return confirm('')" working with $('.class').click(function () {});

> ID：14059030
> 
> 赞同：9
> 
> 时间：2012-12-27T17:58:00.057
> 
> 标签：jquery, onclick, confirm

I have this function that disables the input after user clicks:

```
$('.click-off').click(function () {
    var btn = this;
    setTimeout(function () { $(btn).attr('disabled', 'disabled'); }, 1);
    return true;
}); 
```

And I have this input with a javascript confirmation:

```
<input type="submit" class="click-off" onclick="return confirm('Are you sure?');" value="Delete"> 
```

Even if I click "cancel" in the confirmation box, the $('.click-off').click() event is called, and the button becomes disabled.

The $('.click-off').click() is used by a lot of inputs, so the confirmation can't be inside of it.

How can I check the confirm return in the $('.click-off').click event? Or even prevent the $('.click-off').click event to be called?

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-27T18:00:39.250

为什么你首先要把这些逻辑分开？以下是解决问题的两种方法：

将逻辑组合成一个方法：

```
$('.click-off').click(function () {
    // escape here if the confirm is false;
    if (!confirm('Are you sure?')) return false;
    var btn = this;
    setTimeout(function () { $(btn).attr('disabled', 'disabled'); }, 1);
    return true;
}); 
```

使用全局变量（或对象最好）：

```
var clickOffConfirmed = false;

<input type="submit" class="click-off" onclick="clickOffConfirmed = confirm('Are you sure?');" value="Delete" />

$('.click-off').click(function () {
    // escape here if the confirm is false;
    if (!clickOffConfirmed) return false;
    var btn = this;
    setTimeout(function () { $(btn).attr('disabled', 'disabled'); }, 1);
    return true;
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-27T18:02:15.357

尝试捕获确认框，然后禁用该按钮。

```
$('.click-off').click(function () {
  var r=confirm("Press a button");
  if (r==true)
  {
    $(this).attr('disabled', 'disabled');
  }
  else
  {

  }
}); 
```

也删除onclick

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-27T18:01:53.843

您应该避免使用 jquery 和 onclick 挂钩操作，主要是因为很快您将完全迷失在代码中。

因此，例如，您可以这样做：

```
$('.click-off').click(function () {

   var r=confirm("Are you sure?")
   if (r==true)
   {
       var btn = this;
       setTimeout(function () { $(btn).attr('disabled', 'disabled'); }, 1);
       return true;
   }
   else
   {
       //nothing to do here
   }

}); 
```

并删除 onclick 事件。因此，您将把所有东西都放在一个地方。

在您的示例中，您两次连接到 click 事件，尽管结果彼此不同，但它们都会被触发。

# xpages - Use datasource to get backend document

> ID：14059031
> 
> 赞同：0
> 
> 时间：2012-12-27T17:58:09.080
> 
> 标签：xpages, xpages-ssjs, xpages-extlib

I got a panel which bind to an open document as data source called `document1` in an extlib dialog box. On button save, I want to compare all the field values between back-end document and `document1`. However, all the field values from back-end document are seemed to be updated therefore their field values are the same in `document1`. The comparison is done before `docuemnt1.save()`.

From my understanding, `document1.getDocument()` should get the back-end document which all original/current data. `document1.getDocument(true)` should get all new data. I had try to `getDocumentByID` and found that all field values are updated in back-end document. I have no idea because `document1.save` not yet executed.

Why back-end document being updated with new data before save?

Is there any better way to get back-end document which all original/current data?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-02T11:00:13.800

如果您在*getDocument方法中使用参数**true*，则对数据源所做的所有更改都会临时写入数据源的数据存储区。

 *XPages 引擎“足够聪明”，可以实现*NotesDocument*对象的多个实例都引用同一个后端文档。它现在将从数据源的数据存储中返回缓存的数据。这就是为什么*所有*对象现在都将返回更新的值，而不是存储在后端文档中的值（使用多个数据源会得到相同的结果）。

要访问后端文档中的数据，您可以在所有文档按其 UNID 排序的视图上使用*@DbLookup 。*

```
@DbLookup("","AllByUNID", document1.getDocument( true ).getUniversalID(), "FIELD") 
```*

# apache-flex - Why should I use Flex instead of JQuery?

> ID：14059032
> 
> 赞同：-1
> 
> 时间：2012-12-27T17:58:09.947
> 
> 标签：apache-flex, jsp, web-applications, spring-mvc

I'm working in a webapp with Spring and I always used JSP and Jquery, In a recent conversation, some guy commented: You should use Flex instead. Would Flex be a good choice for a web app? What are the advantages of using it vs. just JSP and Jquery?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-27T21:32:51.943

我想你真的是想问；为什么我应该使用 Flex 而不是 JQuery。

JSP 是一种服务器端语言。Flex 或 JQuery 是客户端语言。Flex 不是 JSP 的替代品，正如 JQuery 不是 JSP 的替代品一样。

Flex 可用于创建 Flash 应用程序；可以通过几种不同的方式进行部署。

*   它可用于创建在 Adob​​e Flash Player 中运行的基于浏览器的应用程序。Flash Player 仅在桌面浏览器上受支持，并且没有可行的选项将 Flash Platform 应用程序部署到当前的移动浏览器。如果您对访问您的应用程序的机器有严格的控制，我只会推荐这个。
*   它可以与 Adob​​e AIR 一起使用，为 Windows 或 Mac 机器创建桌面应用程序。我个人认为，它的用例甚至比创建基于浏览器的应用程序还要小。
*   它可以与 Adob​​e AIR 一起使用，在 iOS、Android 和 Blackberry Playbook 上创建原生应用程序。如果您的任务是构建需要部署在多个移动操作系统上的本机应用程序；我认为 Adob​​e AIR 提供了一个有趣的选择。

如果您需要构建原生移动应用程序，并且您已经了解 JQuery，我建议您研究将 JQuery 应用程序构建为原生应用程序的选项。我知道有将 HTML 转换为原生应用程序的选项，但不能对它们发表评论。我认为没有必要改变你的技术，除非你遇到限制。要评估 Flex ；您必须定义这些限制是什么，然后决定 Flex 是否有助于解决这些限制。通常，“使用你所知道的”所节省的时间超过了切换技术带来的任何好处。

那就是说；Flex 提供了一些我在“HTML5/JavaScript”领域还没有看到的东西。它有一个健壮的 UI 框架，可以在所有平台目标上以相同的方式工作，一个单步调试器和一个内存分析器，仅举几例。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-27T18:00:05.833

这两种技术完全不同。JSP/jQuery 将为您提供一个 Web 应用程序。Flex 会给你一个 Flash 应用程序。

就个人而言，如果 JSP/jQuery 对你有用，那么你应该走那条路。如果您不需要 Flex 的功能，则没有理由要求用户安装插件。

# php - Doctrine 2 unable to find Proxy directory (CodeIgniter)

> ID：14059035
> 
> 赞同：1
> 
> 时间：2012-12-27T17:58:21.347
> 
> 标签：php, codeigniter, orm, doctrine, doctrine-orm

Following a Doctrine / CodeIgniter [tutorial](http://www.joelverhagen.com/blog/2011/05/setting-up-codeigniter-2-with-doctrine-2-the-right-way/)

Everything is good up until the very end when I try to insert data through my controller

```
 $user = new Entities\User;
    $user->setFirstName('Joel');

    $this->doctrine->em->persist($user); 
```

I get:

```
Fatal error: Uncaught exception 'Doctrine\ORM\Proxy\ProxyException' with message 'You must configure a proxy directory. See docs for details' in C:\wamp\www\ci\application\libraries\Doctrine\ORM\Proxy\ProxyException.php on line 33
( ! ) Doctrine\ORM\Proxy\ProxyException: You must configure a proxy directory. See docs for details in C:\wamp\www\ci\application\libraries\Doctrine\ORM\Proxy\ProxyException.php on line 33 
```

This might be due to a difference in the tutorial version of Doctrine vs. the current version [as noted here](http://www.joelverhagen.com/blog/2011/05/setting-up-codeigniter-2-with-doctrine-2-the-right-way/#comment-459214423), but the tutorial version is no longer supported by Doctrine and I'm not sure what to change.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T18:15:59.413

您是否通过在某处设置代理目录：

```
// set up proxy configuration
$config->setProxyDir(APPPATH.'models/Proxies');
$config->setProxyNamespace('Proxies'); 
```

您的代理目录设置有问题。检查代理目录是否定义正确以及该目录是否存在。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-09-07T19:11:01.933

看起来像权限问题：

为了修复，我做了

> sudo chown -R www-data:www-data 。

# synchronization - Synchronization of multiple streams with Gstreamer

> ID：14059036
> 
> 赞同：3
> 
> 时间：2012-12-27T17:58:34.910
> 
> 标签：synchronization, gstreamer

I want to learn more about synchronization of different streams with RTCP with Gstreamer. A video was divided into 4 parts vertically so that synchronization can be better observed at the receiver. Following are the codes used for sender and receiver.

**sender:**

```
gst-launch -v \
\
gstrtpbin name=rtpbin1 \
filesrc location=/home/chinthaka/Desktop/MageHeenaye101.avi ! decodebin ! x264enc ! rtph264pay ! rtpbin1.send_rtp_sink_0 \
rtpbin1.send_rtp_src_0 ! udpsink host=192.168.1.100 port=5011 \
rtpbin1.send_rtcp_src_0 ! udpsink host=192.168.1.100 port=5012 \
udpsrc port=5013 ! rtpbin1.recv_rtcp_sink_0 \
\
gstrtpbin name=rtpbin2 \
filesrc location=/home/chinthaka/Desktop/MageHeenaye102.avi ! decodebin ! x264enc ! rtph264pay ! rtpbin2.send_rtp_sink_0 \
rtpbin2.send_rtp_src_0 ! udpsink host=192.168.1.100 port=5021 \
rtpbin2.send_rtcp_src_0 ! udpsink host=192.168.1.100 port=5022 \
udpsrc port=5023 ! rtpbin2.recv_rtcp_sink_0 \
\
gstrtpbin name=rtpbin3 \
filesrc location=/home/chinthaka/Desktop/MageHeenaye103.avi ! decodebin ! x264enc ! rtph264pay ! rtpbin3.send_rtp_sink_0 \
rtpbin3.send_rtp_src_0 ! udpsink host=192.168.1.100 port=5031 \
rtpbin3.send_rtcp_src_0 ! udpsink host=192.168.1.100 port=5032 \
udpsrc port=5033 ! rtpbin3.recv_rtcp_sink_0 \
\
gstrtpbin name=rtpbin4 \
filesrc location=/home/chinthaka/Desktop/MageHeenaye104.avi ! decodebin ! x264enc ! rtph264pay ! rtpbin4.send_rtp_sink_0 \
rtpbin4.send_rtp_src_0 ! udpsink host=192.168.1.100 port=5041 \
rtpbin4.send_rtcp_src_0 ! udpsink host=192.168.1.100 port=5042 \
udpsrc port=5043 ! rtpbin4.recv_rtcp_sink_0 
```

**Receiver:**

```
gst-launch -v \
videomixer name=mix ! ffmpegcolorspace ! autovideosink sync=false async=false \
\
gstrtpbin name=rtpbin1 \
udpsrc port=5011 caps = "application/x-rtp, media=(string)video, clock-rate=(int)90000, encoding-name=(string)H264, sprop-parameter-sets=(string)\"Z01AFeygbCPNLgIgAAADAC7msoAB4sWywA\\=\\=\\,aOvssg\\=\\=\", payload=(int)96, ssrc=(uint)861153369, clock-base=(uint)4026289255, seqnum-base=(uint)30449" ! rtpbin1.recv_rtp_sink_0 rtpbin1\. ! rtph264depay ! queue ! ffdec_h264 ! videobox border-alpha=0 top=0 left=0 ! mix. \
udpsrc port=5012 ! rtpbin1.recv_rtcp_sink_0 \
rtpbin1.send_rtcp_src_0 ! udpsink port=5013 host=192.168.1.104 \
\
gstrtpbin name=rtpbin2 \
udpsrc port=5021 caps = "application/x-rtp, media=(string)video, clock-rate=(int)90000, encoding-name=(string)H264, sprop-parameter-sets=(string)\"Z01AFeygbCPNLgIgAAADAC7msoAB4sWywA\\=\\=\\,aOvssg\\=\\=\", payload=(int)96, ssrc=(uint)861153369, clock-base=(uint)4026289255, seqnum-base=(uint)30449" ! rtpbin2.recv_rtp_sink_0 rtpbin2\. ! rtph264depay ! queue ! ffdec_h264 ! videobox border-alpha=0 top=-120 left=0 ! mix. \
udpsrc port=5022 ! rtpbin2.recv_rtcp_sink_0 \
rtpbin2.send_rtcp_src_0 ! udpsink port=5023 host=192.168.1.104 \
\
gstrtpbin name=rtpbin3 \
udpsrc port=5031 caps = "application/x-rtp, media=(string)video, clock-rate=(int)90000, encoding-name=(string)H264, sprop-parameter-sets=(string)\"Z01AFeygbCPNLgIgAAADAC7msoAB4sWywA\\=\\=\\,aOvssg\\=\\=\", payload=(int)96, ssrc=(uint)861153369, clock-base=(uint)4026289255, seqnum-base=(uint)30449" ! rtpbin3.recv_rtp_sink_0 rtpbin3\. ! rtph264depay ! queue ! ffdec_h264 ! videobox border-alpha=0 top=-240 left=0 ! mix. \
udpsrc port=5032 ! rtpbin3.recv_rtcp_sink_0 \
rtpbin3.send_rtcp_src_0 ! udpsink port=5033 host=192.168.1.104 \
\
gstrtpbin name=rtpbin4 \
udpsrc port=5041 caps = "application/x-rtp, media=(string)video, clock-rate=(int)90000, encoding-name=(string)H264, sprop-parameter-sets=(string)\"Z01AFeygbCPNLgIgAAADAC7msoAB4sWywA\\=\\=\\,aOvssg\\=\\=\", payload=(int)96, ssrc=(uint)861153369, clock-base=(uint)4026289255, seqnum-base=(uint)30449" ! rtpbin4.recv_rtp_sink_0 rtpbin4\. ! rtph264depay ! queue ! ffdec_h264 ! videobox border-alpha=0 top=-360 left=0 ! mix. \
udpsrc port=5042 ! rtpbin4.recv_rtcp_sink_0 \
rtpbin4.send_rtcp_src_0 ! udpsink port=5043 host=192.168.1.104 
```

I can receive the 4 videos in the same video, but synchronization of each streams is not perfect.

*   I just used the same caps for all the receivers. Just found out that caps generated at each time is different at the sender. Is there a good way to send the caps generated to the receiver so that same caps can be used at the receiver?

*   Is there any best way to synchronize multiple streams using RTCP?

*   Here different ports are used for different RTP and RTCP sessions. Is it advisable or should I use only two ports, one for RTP and one for RTCP.

Please kindly advice. I am quite new to the Gstreamer and trying my best to get familiar with the synchronization.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-06-26T22:12:57.810

我强烈建议您改为在代码中开始执行此操作。启动线非常适合原型设计，但是当涉及到像同步这样的细粒度控制时，您应该改用代码。

GStreamers rtpbin 可以很好地处理 RTCP 同步。如果两个或多个流具有相同的 cname，它将计算（使用 RTCP）在发送方看到的这些流之间的相对时间戳差异，然后使用 gstrtpjitterbuffers ts-offset 在接收方上复制它。理论上，如果您的媒体在发送时是同步的，那么您也应该能够在接收器处同步渲染它。

# android - 使用 GraphView 库的 BarChartGraph 中的空白空间

> ID：14059037
> 
> 赞同：2
> 
> 时间：2012-12-27T17:58:40.650
> 
> 标签：android, android-layout, view, graph, charts

我目前正在尝试使用 GraphView 库（http://www.jjoe64.com/p/graphview-library.html）绘制图表。我目前使用的是版本 3。

我对 BarChartGraph 中的 Bar 有疑问。我推送了一个 33 个元素的数组，但 char 在整个图中较小，在图中仍然是一个未使用的空间。

我附上了一张图片。

这是 XML 代码：

```
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
 android:layout_width="fill_parent"
    android:layout_height="fill_parent">

     <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical">

    <TextView android:layout_width="wrap_content" 
        android:layout_height="wrap_content" 
        android:id="@+id/txtX" 
        android:text="X: 0" 
        android:textSize="15sp"></TextView>

    <TextView
        android:id="@+id/txtZ"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginTop="39dp"
        android:text="Z: 0"
        android:textSize="15sp" />
    [....]

    <EditText
        android:id="@+id/et1"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_marginTop="39dp"
        android:ems="10"
        android:inputType="textMultiLine"
        android:focusable="false">
    </EditText>

    <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="wrap_content"
        android:layout_height="250dp"
        android:id="@+id/graph1" />

</LinearLayout> 
```

这是主类中关于图形的代码：

```
 GraphViewData[] data;
    GraphView graphView;

     // Inizializzazioni utili per il grafico  
        data = new GraphViewData[(N/2)+1];  // N=64

        graphView = new BarGraphView(this, "example") {  //Prova a mettere primad di questo setHorizontalabe
            @Override
            protected String formatLabel(double value, boolean isValueX) {
                if (isValueX) {
                    return Double.toString(value);
                } else return super.formatLabel(value, isValueX); // let the y-value be normal-formatted
               }
            };

      LinearLayout layout = (LinearLayout) findViewById(R.id.graph1);   
      layout.addView(graphView);

        for (int i=0; i<(N/2)+1; i++)
           data[i] = new GraphViewData(i, new_sig[i]);

      graphView.setBackgroundColor(Color.BLACK);

      graphView.addSeries(new GraphViewSeries(data));

      graphView.invalidate();
      graphView.redrawAll(); 
```

[https://docs.google.com/open?id=0B5sm5aNTZkIiN1hrV1Q2MU9iYmM](https://docs.google.com/open?id=0B5sm5aNTZkIiN1hrV1Q2MU9iYmM)

我设置：

```
graphView.setViewPort(0, 33); 
```

但什么都没有改变！

我也尝试使用较小的 ViewPort，但结果是一样的，就像这篇新帖子中的图像一样。在这种情况下，视口为 20：

```
graphView.setViewPort(0, 20); 
```

[https://docs.google.com/open?id=0B5sm5aNTZkIiMFlSSFd1T1ViQ00](https://docs.google.com/open?id=0B5sm5aNTZkIiMFlSSFd1T1ViQ00)

但图中怎么显示，还是一片空白！

我还尝试在 XML 文件中更改维度标签。我将“wrap_content”换成“match_parent”，但没有结果。然后我将更改为 match_parent，也更改为部分视图 LinearLayout，然后更改为 ScrollView。

我还尝试创建一系列 8 个数据（data.length=8），但结果是一样的，在图的右侧保留了相同的空白区域。

谢谢大家！:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-19T07:44:34.867

也许您已经解决了这个问题，但它可以帮助其他人。我遇到过同样的问题。我在这里找到了解决方案。[BarGraphView · 第 14 期 · jjoe64/GraphView · GitHub](https://github.com/jjoe64/GraphView/issues/14)

您必须像这样修改库的源代码：

```
// BarGraphView.java
// float colwidth = (graphwidth - (2 * border)) / values.length;
float colwidth = graphwidth / values.length;

// GraphView.java
// horizontal labels + lines
int hors = horlabels.length;
for (int i = 0; i <= horlabels.length; i++) {
    paint.setColor(Color.DKGRAY);
    float x = ((graphwidth / hors) * i) + horstart;
    canvas.drawLine(x, height - border, x, border, paint);
    paint.setTextAlign(Align.CENTER);
    if (i < horlabels.length) {
        paint.setColor(Color.WHITE);
        canvas.drawText(horlabels[i], x + (graphwidth / hors) / 2,
                height - 4, paint);
    }
} 
```

它对我很有效。我希望它有所帮助。

# php - 使用 JS 从 PHP 表单中获取 NaN

> ID：14059043
> 
> 赞同：0
> 
> 时间：2012-12-27T17:58:58.683
> 
> 标签：php, javascript, html, nan

如果我尝试对我从表单中提取的两个变量进行任何数学运算，我会得到一个 NaN 值。如果我尝试解析它，它也会给我 NaN。IDK 如果它有帮助，但值是使用 PHP 从 URL 中提取的；例子：`.../serch.php?animal=all&color=any&sunSd=all&lifeSpn=all&limiterF=5&limiterT=20`

limiterF 和 limiterT 是我正在使用的变量。html:

```
<form id='serchForm' action="serch.php" method="GET">
...
            <fieldset>
            From: <input type='text' id = 'limiterFid' name='limiterF' value=<?php if (!empty($_GET['limiterF'])) {echo $limiterF;} else {echo 0;} ?> size="2" /><br />
            To: <input type='text' id = 'limiterTid' name='limiterT' value=<?php if (!empty($_GET['limiterT'])) {echo $limiterT;} else {echo 20;} ?>  size="2" />
            </fieldset>
        <input type="submit" id="submitNew" />
        <input type="submit" id="nextSerch" /> 
```

JS：

```
$(document).ready(function() {
    $("#serchForm input").click(function(e) {
        if(e.target.id == 'submitNew') {
            e.preventDefault();
            $('#limiterFid').attr("value", 0);
            $('#limiterTid').attr("value", 20);
            $("#serchForm").submit();
        } else if (e.target.id == 'nextSerch') {
            e.preventDefault();
            var limiterF = $('#limiterFid').value,
            limiterT = $('#limiterTid').value;
            limiterT = limiterF + limiterT;
            limiterF = parseInt(limiterF, 5);

            $('#limiterFid').attr("value", limiterF);
            $('#limiterTid').attr("value", limiterT);
            $("#serchForm").submit();
        } else {
            return;
        }
    });
}); 
```

这是单击 nextSerch 时将返回的内容：

```
.../serch.php?animal=all&color=any&sunSd=all&lifeSpn=all&limiterF=NaN&limiterT=NaN 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-27T18:02:34.790

`value`是 DOM 元素的属性，而不是 jQuery 对象。您可以使用其中一个`val()`或`value`在原始 DOM 元素上使用。

```
$('element').val()
// OR
$('element')[0].value 
```

此外，要设置您通常不使用的值`attr`，请使用`val`.

```
$('element').val('newValue') 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-27T18:04:17.367

使用[.val()](http://api.jquery.com/val/)方法，`value`当它试图调用 jQuery 对象的“值”属性时将返回 undefined：

```
$(document).ready(function() {
    $("#serchForm input").click(function(e) {
        if(e.target.id == 'submitNew') {
            e.preventDefault();
            $('#limiterFid').val(0);
            $('#limiterTid').val(20);
            $("#serchForm").submit();
        } else if (e.target.id == 'nextSerch') {
            e.preventDefault();
            var limiterF = $('#limiterFid').val(),
            limiterT = $('#limiterTid').val();
            limiterT = limiterF + limiterT;
            limiterF = parseInt(limiterF, 5);

            $('#limiterFid').val(limiterF);
            $('#limiterTid').val(limiterT);
            $("#serchForm").submit();
        } else {
            return;
        }
    });
}); 
```

# html - 在 HTML 有序列表中对齐数字

> ID：14059050
> 
> 赞同：13
> 
> 时间：2012-12-27T17:59:38.733
> 
> 标签：html, css, html-lists

我正在尝试创建一个背景颜色交替的有序编号列表。我需要数字出现在背景中，并排成一行。如果我取出`list-style-position:inside;`数字排列，但移到背景之外。

这是我的代码，下面有 jsfiddle 的链接。

```
<ol>
    <li>ha HA ha HA!</li>
    <li class="alt">ha HA ha HA!</li>
    <li>ha HA ha HA!</li>
    <li class="alt">ha HA ha HA!</li>
    <li>ha HA ha HA!</li>
    <li class="alt">ha HA ha HA!</li>
    <li>ha HA ha HA!</li>
    <li class="alt">ha HA ha HA!</li>
    <li>ha HA ha HA!</li>
    <li class="alt">ha HA ha HA!</li>
    <li>ha HA ha HA!</li>
    <li class="alt">ha HA ha HA!</li>
    <li>ha HA ha HA!</li>
    <li class="alt">ha HA ha HA!</li>
    <li>ha HA ha HA!</li>
</ol>    

ol
{
    list-style-type:decimal;
    list-style-position:inside;
    margin:1.5em;
}
.alt
{
    background-color:#ccc;
} 
```

[http://jsfiddle.net/kwgpf/](http://jsfiddle.net/kwgpf/)

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-03-25T06:57:15.633

你应该使用：

```
list-style: decimal inside none; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-27T18:13:36.863

这是我现在能想到的最好的。这有点hacky，但它可以在现代浏览器上完成工作。

```
ol {
  list-style-type:decimal;
  margin-left:50px;
}
.alt {
  background-color:#ccc;
  position:relative;
}
.alt::before {
  position:absolute;
  display: inline-block;
  content:"";
  background-color: rgba(0,0,0,.2);
  left: -30px;
  height: 100%;
  width: 30px;
}​ 
```

[在 JSFiddle 上查看](http://jsfiddle.net/yDtaW/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-27T18:59:32.540

如果您愿意采用固定宽度路线，您可以在 #10 以下的每个项目符号之前添加一个边距。

# node.js - Best Session Storage Middleware for Express + MongoDB

> ID：14059051
> 
> 赞同：31
> 
> 时间：2012-12-27T17:59:39.893
> 
> 标签：node.js, mongodb, session, express

I was looking for the best middleware for storing session data in MongoDB to use in a production application that uses express?

I've been looking around and found this:

1.  **session-mongoose** ([https://github.com/donpark/session-mongoose](https://github.com/donpark/session-mongoose)) According to author's comment this is not production-ready for following reasons:

    > *   insufficient testing
    > *   zero optimization
    > *   there are better options than MongoDB for session storage

2.  **connect-mongo** ([https://github.com/kcbanner/connect-mongo](https://github.com/kcbanner/connect-mongo))

3.  **express-session-mongo** ([https://github.com/davglass/express-session-mongo](https://github.com/davglass/express-session-mongo))

    > Based on these classes
    > 
    > *   Sencha Connect Memory Store
    > *   ciaranj's express-session-mongodb

4.  **connect-session-mongo** ([https://github.com/bartt/connect-session-mongo](https://github.com/bartt/connect-session-mongo))

I've been looking at their code, I was trying to find also a performance comparisson article. Do you guys have experience to suggest which is the best?

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-12-27T19:41:24.613

**connect-mongo** ( [https://github.com/kcbanner/connect-mongo](https://github.com/kcbanner/connect-mongo) ) 看起来比其他的更好。

**express-session-mongo**和**connect-session-mongo**非常旧，并且基于旧版本的`mongodb`驱动程序。

**session-mongoose**基于`mongoose`，比`mongodb`驱动程序慢。

我认为**connect-mongo**是最好的选择。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-11-13T04:59:25.997

* * *

**连接 mongodb 会话**

*   [https://www.npmjs.com/package/connect-mongodb-session](https://www.npmjs.com/package/connect-mongodb-session)
*   发表于 3 个月前
*   **connect-mongodb-session**：*用于连接和 Express 的 MongoDB 支持的会话存储。**旨在成为connect-mongo**等模块的维护良好且功能齐全的替代品*
***   谷歌现在也首先展示了这个。**

 *** * *

**连接-mongo**

*   [https://www.npmjs.com/package/connect-mongo](https://www.npmjs.com/package/connect-mongo)
*   发表于一年前

* * ***

# php - 在 mySQL 数据库中查询日期晚于当前日期的条目数

> ID：14059053
> 
> 赞同：-3
> 
> 时间：2012-12-27T17:59:52.977
> 
> 标签：php, mysql, sql, database

我开发了一个项目管理系统，用于跟踪与我的日常工作流程相关的各种项目。我想查询数据库以显示完成日期已过的项目数量（如果错过了项目截止日期）。有人可以给我一些关于如何查询数据库以将存储日期与当前日期进行比较并计算满足此参数的条目数的指导吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T18:04:27.020

```
SELECT COUNT(*) as 'count'
FROM my_table
WHERE my_datetime_column > NOW() 
```

虽然如果您正在寻找过期的东西，您可能想找到*过去*的日期，所以只需翻转比较运算符即可。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T18:04:07.630

基于[http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_now](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_now)

```
Select count(*) as myCount From myTable where CompletionDate > NOW(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T18:07:09.413

您正在查找的查询（假设您的截止日期字段是 DATETIME 类型）：

```
SELECT count(`id`) FROM `my_table` WHERE `deadline` < NOW(); 
```

如果你想玩弄 MYSQL 日期时间，你应该在这里阅读它：

[http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html)

# c# - 如果进程作为文件类型的默认关联程序启动，则 InvalidOperationException

> ID：14059060
> 
> 赞同：2
> 
> 时间：2012-12-27T18:00:18.650
> 
> 标签：c#, process, invalidoperationexception

情况：

1.  我依靠默认的关联处理程序为各种文件类型（图片、Word 文档等）生成进程。这意味着我只将特定文件名指定为 StartInfo.FileName，并且在该文件名之前没有实际的可执行文件。同时我指定 StartInfo.UseShellExecute = true。这样，与该文件类型相关的软件就会启动。
2.  我的目标是在该进程退出时得到通知。

```
Process process = new Process();
try
{
    process.StartInfo.UseShellExecute = true;
    process.StartInfo.FileName = pFullPath;
    process.StartInfo.CreateNoWindow = true;
    process.StartInfo.RedirectStandardError = true;
    bool notReused = process.Start();
}
catch (Win32Exception ex) 
```

变化：

*   Process 的静态 Start 方法确实返回了一个 Process，但我为我的场景返回了 null/空对象。所以这就是为什么我显式地实例化一个 Process 类，为其 StartInfo 属性设置参数，然后最后调用非静态 Start()，这样我就拥有了那个 Process 对象实例。
*   如果我说 StartInfo.UseShellExecute = false，我会得到一个异常，因为我没有指定可执行文件名。这似乎是调用具有文件类型的关联程序的方式。
*   非静态 Process.Start 有一个布尔返回值，它表示系统重用了一个 Process。我不想这样，但我不知道如何避免它。
*   我尝试设置 StartInfo 的 Redirect* 布尔值，但这会再次引发 InvalidOperationException，并且符合文档。

如果我有一个“好”的 Process 对象，我可以连接 Exited 处理程序并将 EnableRaisingEvents 设置为 true。我很惊讶，也很难过这样的 PITA。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T03:26:24.140

这是完全不可能的。
根本不保证启动文件会创建进程。

Raymond Chen 有[更多的细节](http://blogs.msdn.com/b/oldnewthing/archive/2006/05/05/590749.aspx)。

# c# - 无法在 WCF 中引用操作合同方法

> ID：14059070
> 
> 赞同：0
> 
> 时间：2012-12-27T18:01:06.720
> 
> 标签：c#, .net, wcf

我正在`Add 2 numbers`WCF 中创建一个基本服务。我在里面添加了以下内容`IService.cs`

```
[ServiceContract]
public interface ICalc{
  [OperationContract]
  int Add(int a, int b);
} 
```

现在，在`Service.cs`我添加的里面

```
public class Service: IService, ICalc {
    public int Add(int a, int b){
       return a+b;
    }
} 
```

现在我构建了这个服务并`service reference to it`在控制台应用程序中添加了一个

```
Program.cs 
```

它被称为

```
ICalService.Service c = new ICalService.Service();
int result = c.Add(10,20);        //Now on this line I cannot seem to get the Add(int a, int b) method 
```

我之前已经声明过。

```
ICalService 
```

是我在引用我的服务时给它起的名字。

为什么`Add(int a, int b)`方法不显示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T18:32:12.460

您是否为您的 IService 接口或 ICalc 接口创建了代理？从看起来你必须为 IService 接口创建一个代理。

在控制台应用程序中添加 Web 引用时，请确保您正在为 ICalcService 接口创建代理（添加引用）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T18:10:06.417

也许这只是您的问题中的一个错字或遗漏，但我没有看到 IService 实际定义的接口，它仅在您的“服务”类上实现。此外，有时只需浏览到您尝试引用的 .svc 页面会很有帮助，浏览器有时会显示比您尝试执行操作时收到的错误消息更好的消息。

编辑：我会确保您能够浏览 .svc 页面并生成 WSDL。如果您能够查看服务操作并获得生成的 wsdl，那么我相信您的服务已经启动并运行良好。我会接受其他人的建议，并确保您随后创建了正确的代理对象。

# php - 如何在 php 中获取按钮单击事件的动态表（包含表数据）值？

> ID：14059071
> 
> 赞同：0
> 
> 时间：2012-12-27T18:01:12.807
> 
> 标签：php, mysql

我正在编写一个 PHP 代码，当页面运行时，它将显示带有更新按钮选项的动态记录。现在的问题是它是动态生成的，那么当单击按钮时如何获取表记录的特定 COLUMN 值？ ![](../Images/8003b0e67c0e0ad9ca52a6efe0ec9937.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T18:26:37.193

**PHP创建表**

```
 echo "<table>";
    echo "<tr>";

    while( ($row = mysql_fetch_array($result)))
    {
        echo "<td>".$row['no']."</td>";
        echo "<td>".$row['notify']."</td>";
        echo "<td>".$row['date']."</td>";
        echo "<td>".$row['url']."</td>";
        echo "<td><input type='button' name='update' onClick='updateRecord(this)' id='update' value='".$row['id']."'></td>";
    }

    echo "</tr>";
    echo "</table>"; 
```

**JavaScript 更新记录**

```
function updateRecord(id)
{
    var recordId = id.value;
     ...Update record through ajax call...
     ...Update record through form submit...

} 
```

**通过ajax调用更新记录**

```
$.ajax({
        url: 'update.php',
        method: 'GET',
        data: 'userID=' + recordId,
        success: function(new_data){
             $(popID).html(new_data);
              $(popID).dialog();
              alert('Load was performed.');
        }
    }); 
```

# objective-c - iOS facebook SDK：登录已通过身份验证

> ID：14059075
> 
> 赞同：0
> 
> 时间：2012-12-27T18:01:33.703
> 
> 标签：objective-c, ios6, facebook-ios-sdk

我已经在我已经开发了几个月的应用程序中运行了 Facebook iOS SDK。在这一点上，我主要将 SDK 用于 SSO 目的。

自从我开始使用 iOS 6.0 以来，我一直看到“登录以使用带有 MY_APP 的 FB 帐户”模式阻止我当前视图的问题。
奇怪的是用户已经通过身份验证并且显然被授权使用我的应用程序。我可以获取用户的电子邮件地址等事实证明了这一点。

同样重要的是要注意，如果我单击“X”，它将关闭并且一切正常（用户已通过身份验证/授权）。如果我按照它告诉我的方式登录，它会显示“MY_APP 已被授权”模式，我无法单击“确定”按钮，但我可以单击“X”，再次让我回到我的视图，用户已通过身份验证和授权。

在这里你可以看到它：

![在此处输入图像描述](../Images/2664379bb76ebb99ab11aec4bcafdb13.png)

要进行身份验证，我在以下方法中调用`appdelegate`：

```
[appDelegate openSessionWithAllowLoginUI:YES]; 
```

以下是我的 appdelegate 中相关的 FB 方法：

```
// FACEBOOK STUFF
- (BOOL)openSessionWithAllowLoginUI:(BOOL)allowLoginUI {
    NSArray *permissions = [NSArray arrayWithObjects: @"email", nil];
    return [FBSession openActiveSessionWithReadPermissions:permissions
                                              allowLoginUI:allowLoginUI
                                         completionHandler:^(FBSession *session, FBSessionState status, NSError *error) {
                                             [self sessionStateChanged:session state:status error:error];
                                         }];    
}

- (void)sessionStateChanged:(FBSession *)session 
                      state:(FBSessionState)state
                      error:(NSError *)error {
    // FBSample logic
    // Any time the session is closed, we want to display the login controller (the user
    // cannot use the application unless they are logged in to Facebook). When the session
    // is opened successfully, hide the login controller and show the main UI.
    switch (state) {
        case FBSessionStateOpen: {
            FBCacheDescriptor *cacheDescriptor = [FBFriendPickerViewController cacheDescriptor];
            [cacheDescriptor prefetchAndCacheForSession:session];
            [self sendAuthenticationStatusChangedNotification];
        }
            break;
        case FBSessionStateClosed:
        case FBSessionStateClosedLoginFailed:
            // FBSample logic
            // Once the user has logged in, we want them to be looking at the root view.
            [FBSession.activeSession closeAndClearTokenInformation];
            //[self showLoginView];
            break;
        default:
            break;
    }
    if (error) {
        UIAlertView *alertView = [[UIAlertView alloc] initWithTitle:@"Error"
                                                            message:error.localizedDescription
                                                           delegate:nil
                                                  cancelButtonTitle:@"OK"
                                                  otherButtonTitles:nil];
        [alertView show];
    }    
}

- (BOOL)application:(UIApplication *)application 
            openURL:(NSURL *)url
  sourceApplication:(NSString *)sourceApplication 
         annotation:(id)annotation {
    // FBSample logic
    // We need to handle URLs by passing them to FBSession in order for SSO authentication
    // to work.
    return [FBSession.activeSession handleOpenURL:url];
} 
```

**编辑 1**

我注意到这发生在我的一部手机上，而另一部则没有。无法使用的手机安装了旧版本的 FB 应用程序。更新 FB 应用程序阻止了此问题的发生。我仍然对避免其他人遇到相同问题的修复感兴趣。

**编辑 2**

这个问题暂时消失了，但现在即使安装了新的 facebook 应用程序，问题又回来了。请帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T03:34:44.983

对我来说，这个问题实际上是一个愚蠢的问题。我在打电话

```
[appDelegate openSessionWithAllowLoginUI:YES]; 
```

两次由于连接了两次的按钮单击事件。只要它只被调用一次，问题就消失了！

# javascript - 从 Chrome 控制台使用 Tampermonkey API？

> ID：14059078
> 
> 赞同：5
> 
> 时间：2012-12-27T18:01:58.717
> 
> 标签：javascript, google-chrome, console, google-chrome-devtools, tampermonkey

有没有办法在 Chrome 的 JavaScript 控制台中 使用[Tampermonkey 的 API ？](http://forum.tampermonkey.net/viewtopic.php?f=16&t=74)

我想弄乱和之类的`GM_xmlhttpRequest()`功能`GM_listValues()`。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-27T18:40:24.273

1.  创建以下脚本：

    ```
    // ==UserScript==
    // @name       Exports some GM functions
    // @namespace  Whatever
    // @match      *
    // ==/UserScript==
    // WARNING: Any page can now use these methods! Be careful,
    // or change "@match *" to "@match https://example.com" and
    // visit https://example.com to test the API.
    unsafeWindow.GM_xmlhttpRequest = GM_xmlhttpRequest;
    unsafeWindow.GM_listValues = GM_listValues; 
    ```

2.  打开任何可以激活 Tampermonkey 的页面（例如[https://stackoverflow.com/](https://stackoverflow.com/)）。

3.  打开开发者工具 -> 控制台。
4.  完成后，您现在可以使用导出的方法做任何您想做的事情（从步骤 1 开始）。

![控制台截图](../Images/c2e31b57b9f0bb99a41421b0db4cdd29.png)

# asp.net - 从 sql 表中检索特定值

> ID：14059080
> 
> 赞同：1
> 
> 时间：2012-12-27T18:02:08.407
> 
> 标签：asp.net, vb.net

我将登录分为 2 个部分，一个用于管理员，一个用于用户，它们通过具有值 1 和 2 的 TypeID 字段进行区分

我想创建检查 TypeID 来决定响应重定向页面的功能

到目前为止我得到了这个

```
Public Shared Function CheckUser(ByVal usename As String) As Int32
    Const sql = "SELECT TypeID FROM Registration where usename = @UserName"
    Using con As New SqlConnection(ConfigurationManager.ConnectionStrings("RegconnectionString").ConnectionString)
        Using cmd = New SqlCommand(sql, con)
            cmd.Parameters.AddWithValue("@TypeID", usename)
            con.Open()
            Dim x As Integer = cmd.ExecuteScalar
            Return x
        End Using
    End Using
End Function 
```

此函数的输入将是来自 textUserName.text 的文本

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T18:15:53.710

如果我错了，请纠正我，但我认为您正在尝试设置 @UserName 参数 - 同时实际添加 @TypeID，这将是您的回报。

我认为第 5 行实际上应该是这样的：

```
cmd.Parameters.AddWithValue("@UserName", usename) 
```

希望对你有效。

# html - 如何调整 HTML5 画布上已关闭的路径的大小？

> ID：14059082
> 
> 赞同：0
> 
> 时间：2012-12-27T18:02:11.037
> 
> 标签：html, path, html5-canvas, dynamic-resizing, 2d-context-api

我在画布上渲染了一条二次曲线。我想通过 window.setInterval 对其进行动画处理，然后更改它的尺寸（注意不是简单地改变它的比例）。

如何在调用 context.closePath() 后保留对路径的可编辑引用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T15:32:36.337

我建议您在新`Path`对象中维护对路径的引用；这样您就可以动态修改 x、y、点等，然后在每个动画步骤中渲染它。

```
var testPath = new Path(100, 100, [[40, 40], [80, 80]]);
var canvas = document.getElementById('canvas');
var ctx = canvas.getContext('2d');

function Path(x, y, points)
{
    this.x = x;
    this.y = y;
    this.points = points;
}

function update()
{
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    ctx.strokeStyle = 'red';
    ctx.moveTo(testPath.points[0][0], testPath.points[0][1]);
    for (var i = 1; i < testPath.points.length; i++)
    {
        ctx.lineTo(testPath.points[i][0], testPath.points[i][1]);
    }
    ctx.stroke();
    testPath.points[1][1]++; // move down

    // loop
    requestAnimationFrame(update);
}

update();​ 
```

出于某种原因，JSFiddle 与 Paul Irish 的 requestAnimationFrame polyfill 不兼容，但它应该在本地工作。我肯定会推荐这个而不是 setInterval。

[http://jsfiddle.net/d2sSg/1/](http://jsfiddle.net/d2sSg/1/)

# c# - 在 ServiceStack 中使用 IRestClient 发出 HEAD 请求

> ID：14059085
> 
> 赞同：3
> 
> 时间：2012-12-27T18:02:14.820
> 
> 标签：c#, http, servicestack, httpverbs

上下文：我构建了一个处理“配置文件”对象的 REST 服务。每个配置文件都需要有一个唯一的名称。客户端出于验证目的需要执行的操作之一是检查以确保具有给定名称的配置文件不存在。

与其构建 RPC 样式的“ProfileExists”方法，我更愿意遵循 REST 设计原则并向具有给定名称的配置文件发出 HEAD 请求，然后根据配置文件是否已经存在返回适当的响应代码（ 200、404），不需要响应体。

按照较新的 ServiceStack API 的约定，我设置了一个方法来接受 Head 请求，并使用 Fiddler 成功测试了这两种情况：

```
public object Head(GetProfile request)
{
    ValidateRequest(request);

    HttpStatusCode responseCode;

    using (var scope = new UnitOfWorkScope())
    {
        responseCode = _profileService.ProfileExists(request.Name) ? HttpStatusCode.OK : HttpStatusCode.NotFound;

        scope.Commit();
    }

    return new HttpResult { StatusCode = responseCode };
} 
```

问题出在客户端。通过 ServiceStack 的 IRestClient 接口发出 HEAD 请求被证明是困难的。虽然有 Get、Post、Put 和 Delete 方法，但没有 Head 方法。从那里我假设我可以使用 CustomMethod 明确指定 HEAD 动词作为参数：

```
public bool ProfileExists(string profileName)
{
    try
    {
        var response = _restClient.CustomMethod<IHttpResult>(HttpMethods.Head, new GetProfile { Name = profileName });

        return response.StatusCode == HttpStatusCode.OK;
    }
    catch (WebServiceException ex)
    {
        if (ex.StatusCode == 404)
            return false;
    }

    // Return false for any other reason right now.
    return false;
} 
```

但是，在验证 HttpVerb 参数时，底层实现 ( [ServiceClientBase](https://github.com/ServiceStack/ServiceStack/blob/master/src/ServiceStack.Common/ServiceClient.Web/ServiceClientBase.cs) ) 会引发异常：

```
if (HttpMethods.AllVerbs.Contains(httpVerb.ToUpper()))
                throw new NotSupportedException("Unknown HTTP Method is not supported: " + httpVerb); 
```

集合[HttpMethods.AllVerbs](https://github.com/ServiceStack/ServiceStack/blob/master/src/ServiceStack.Common/Web/HttpMethods.cs)包含 RFC 2616 和更多的所有常用动词。除非此行为是错误，否则为任何已知 HTTP 动词引发异常表明作者对 CustomMethod 的意图不包括能够发出对已知 HTTP 动词的请求。

这引出了我的问题：如何在 ServiceStack 的客户端发出 HEAD 请求？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T01:54:24.260

这是一个错误：

```
if (HttpMethods.AllVerbs.Contains(httpVerb.ToUpper()))
    throw new NotSupportedException("Unknown HTTP Method is not supported: " + httpVerb); 
```

我刚刚[在这个提交中修复了](https://github.com/ServiceStack/ServiceStack/commit/03e1223e338d592e8c16a55b2781cf9cf6ae9a7f)。此修复程序将在本周末到期的下一个 ServiceStack 版本（v3.9.33+）中提供。

# jquery - 在 jquery 变量中添加单行换行符的正确方法

> ID：14059091
> 
> 赞同：0
> 
> 时间：2012-12-27T18:02:31.980
> 
> 标签：jquery

我想在 jquery 变量中包含一个换行符，但我的运算符出现语法错误：

```
var $answer = $("\n" + "<table class='answer'><tbody><tr><td>3\. Answer:</td></tr></tbody></table>" + "\n"); 
```

我能够在此表之前和之后包含一个换行符的正确方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-27T18:06:18.803

我建议您使用 css 作为样式，但这应该是您正在寻找的答案：

```
var $answer = $("<br /><table class='answer'><tbody><tr><td>3\. Answer:</td></tr></tbody></table><br />"); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-27T18:09:52.617

尝试：

```
var $answer = "<br/><table class='answer'><tbody><tr><td>3\. Answer:</td></tr></tbody</table><br />"; 
```

# python - 我想将 pandas DataFrame 中的两列相乘并将结果添加到新列中

> ID：14059094
> 
> 赞同：75
> 
> 时间：2012-12-27T18:02:41.717
> 
> 标签：python, python-2.7, pandas

我正在尝试将熊猫数据框（orders_df）中的两个现有列相乘 - 价格（股票收盘价）和数量（股票数量），并将计算添加到一个名为“价值”的新列中。出于某种原因，当我运行此代码时，“值”列下的所有行都是正数，而某些行应该是负数。在 DataFrame 的 Action 列下，有 7 行带有“Sell”字符串，7 行带有“Buy”字符串。

```
for i in orders_df.Action:
 if i  == 'Sell':
  orders_df['Value'] = orders_df.Prices*orders_df.Amount
 elif i == 'Buy':
  orders_df['Value'] = -orders_df.Prices*orders_df.Amount) 
```

请让我知道我做错了什么！

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2012-12-28T14:47:45.373

我认为一个优雅的解决方案是使用该[`where`](http://pandas.pydata.org/pandas-docs/stable/indexing.html#the-where-method-and-masking)方法（另见[`API docs`](http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.where.html)）：

```
In [37]: values = df.Prices * df.Amount

In [38]: df['Values'] = values.where(df.Action == 'Sell', other=-values)

In [39]: df
Out[39]: 
   Prices  Amount Action  Values
0       3      57   Sell     171
1      89      42   Sell    3738
2      45      70    Buy   -3150
3       6      43   Sell     258
4      60      47   Sell    2820
5      19      16    Buy    -304
6      56      89   Sell    4984
7       3      28    Buy     -84
8      56      69   Sell    3864
9      90      49    Buy   -4410 
```

此外，这应该是最快的解决方案。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2012-12-27T18:59:12.093

您可以使用 DataFrame[`apply`](http://pandas.pydata.org/pandas-docs/dev/generated/pandas.DataFrame.apply.html#pandas.DataFrame.apply)方法：

```
order_df['Value'] = order_df.apply(lambda row: (row['Prices']*row['Amount']
                                               if row['Action']=='Sell'
                                               else -row['Prices']*row['Amount']),
                                   axis=1) 
```

*使用这些方法通常比使用 for 循环更快。*

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2012-12-27T20:05:45.073

如果我们愿意牺牲海登解决方案的简洁性，也可以这样做：

```
In [22]: orders_df['C'] = orders_df.Action.apply(
               lambda x: (1 if x == 'Sell' else -1))

In [23]: orders_df   # New column C represents the sign of the transaction
Out[23]:
   Prices  Amount Action  C
0       3      57   Sell  1
1      89      42   Sell  1
2      45      70    Buy -1
3       6      43   Sell  1
4      60      47   Sell  1
5      19      16    Buy -1
6      56      89   Sell  1
7       3      28    Buy -1
8      56      69   Sell  1
9      90      49    Buy -1 
```

现在我们已经消除了对`if`语句的需要。使用`DataFrame.apply()`，我们也取消了`for`循环。正如 Hayden 所指出的，矢量化操作总是更快。

```
In [24]: orders_df['Value'] = orders_df.Prices * orders_df.Amount * orders_df.C

In [25]: orders_df   # The resulting dataframe
Out[25]:
   Prices  Amount Action  C  Value
0       3      57   Sell  1    171
1      89      42   Sell  1   3738
2      45      70    Buy -1  -3150
3       6      43   Sell  1    258
4      60      47   Sell  1   2820
5      19      16    Buy -1   -304
6      56      89   Sell  1   4984
7       3      28    Buy -1    -84
8      56      69   Sell  1   3864
9      90      49    Buy -1  -4410 
```

这个解决方案需要两行代码而不是一行，但更容易阅读。我怀疑计算成本也相似。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2017-05-25T14:18:35.017

由于这个问题再次出现，我认为一个很好的干净方法是使用[assign](https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.assign.html)。

该代码非常具有表现力和自我描述性：

```
df = df.assign(Value = lambda x: x.Prices * x.Amount * x.Action.replace({'Buy' : 1, 'Sell' : -1})) 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2019-03-06T16:49:07.797

为了使事情变得整洁，我采用了 Hayden 的解决方案，但从中制作了一个小功能。

```
def create_value(row):
    if row['Action'] == 'Sell':
        return row['Prices'] * row['Amount']
    else:
        return -row['Prices']*row['Amount'] 
```

这样当我们想将函数应用到我们的数据框时，我们可以做..

```
df['Value'] = df.apply(lambda row: create_value(row), axis=1) 
```

...并且任何修改只需要在小函数本身中进行。

简洁、易读、整洁！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-05-25T14:06:12.200

对我来说，这是最清晰和最直观的：

```
values = []
for action in ['Sell','Buy']:
    amounts = orders_df['Amounts'][orders_df['Action'==action]].values
    if action == 'Sell':
        prices = orders_df['Prices'][orders_df['Action'==action]].values
    else:
        prices = -1*orders_df['Prices'][orders_df['Action'==action]].values
    values += list(amounts*prices)  
orders_df['Values'] = values 
```

该`.values`方法返回一个`numpy array`允许您轻松地按元素相乘，然后您可以通过“添加”来累积生成一个列表。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-01-06T13:04:35.077

bmu 的好解决方案。我认为将值放在括号内而不是放在括号外更具可读性。

```
 df['Values'] = np.where(df.Action == 'Sell', 
                            df.Prices*df.Amount, 
                           -df.Prices*df.Amount) 
```

使用一些 pandas 的内置函数。

```
 df['Values'] = np.where(df.Action.eq('Sell'), 
                            df.Prices.mul(df.Amount), 
                           -df.Prices.mul(df.Amount)) 
```

# vim - 在VIM中每行的末尾添加填充的增量数

> ID：14059098
> 
> 赞同：3
> 
> 时间：2012-12-27T18:02:51.877
> 
> 标签：vim, vi

我有一个包含列表的文本文件：

```
dateformatfile.ext
dateformatfile.ext
dateformatfile.ext
... 
```

我需要在每个末尾添加一个填充数字，如下所示：

```
dateformatfile.ext 00001
dateformatfile.ext 00002
dateformatfile.ext 00003
... 
```

有很多，所以我需要一个命令来以某种方式做到这一点。

提前致谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-27T18:25:49.273

假设您想对文件中的每一行都执行此操作，您可以像这样使用行号：

```
:execute "% normal A \<C-R>=printf(\"%05d\", line(\".\"))\<CR>" 
```

在哪里

*   `execute(...)`将字符串作为命令运行
*   `% normal`在文件的每一行上运行一个普通命令
*   `A`附加到该行
*   `<C-R>=`插入命令的结果
*   `printf("%05d", ...)`将第二个参数格式化为五位数字
*   `line(".")`获取当前行号
*   `<CR>`完成`<C-R>=`插入

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-27T20:41:45.063

如果您的文本块位于文件的开头。这意味着您要附加“00001”的行是文件的第一行，试试这个命令，我只是检查以 结尾的行`ext`，如果需要，您可以将其更改为正确的正则表达式：

```
:%s/ext$/\="ext  ".printf("%05d", line("."))/g 
```

如果文本块不在文件的开头。您只需检查块的第一行（要附加 00001 的行）并获取行号，例如行号 5：

```
:let b=5|%s/ext$/\="ext  ".printf("%05d", line(".")-b+1)/g 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-28T08:55:01.957

这是我的看法。

将光标定位在要添加第一个数字的第一行。
`:let i=0`定义一个变量来保存计数。
`qm`开始将宏记录到寄存器**m**中。
`A <C-R>=printf("%05d", i)<CR><ESC>`添加一个空格和 printf 的输出。
`:let i+=1`增加下一个宏执行的计数。
`q`结束宏的录制。

`jVG`视觉选择我们要添加数字的文档的其余部分。
`:normal @m`执行宏将数字添加到选定的行。

我认为这种方法有一些优点：

*   不需要丑陋的逃避。
*   计数与行号无关。允许偏移量。
*   使用宏可以很容易地与*:global*命令结合使用。例如：

`:g/ext$/ normal @m`*在以ext*结尾的行上执行存储在寄存器**m**中的宏。

 ** * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-27T18:27:05.000

使用 awk 可以很容易地做到这一点。[NR 变量为您提供记录编号](http://www.thegeekstuff.com/2010/01/8-powerful-awk-built-in-variables-fs-ofs-rs-ors-nr-nf-filename-fnr/)，并且记录映射到行，除非重新定义 RS 变量。所以以下内容：

`awk -e '{ print $0 NR }' filename`应该做的伎俩。填充它们是留给读者的练习。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-27T18:37:24.490

我会使用宏来做到这一点（我喜欢宏：D）。

首先，让我们处理一下数字（稍后我们将填充它们）。在第一行的末尾手动添加数字 1。然后在第一行记录这个宏：

```
qq        - record the macro q
$         - go at the end of the line
F<space>  - go backward to the last space
"ay$      - copy till the end of the line in the buffer a
j$        - go at the end of the line below
"ap       - copy the buffer content
<ctrl+A>  - increment the number
q         - stop recording the macro 
```

**现在您可以使用1000@q**多次应用它（它将在文件末尾停止）。

这不是很漂亮，但它可以完成工作。

对于填充，我会使用另一个丑陋的技巧。首先，使用正则表达式匹配 3 位数字并在前面添加 0，然后对 2 位数字执行相同操作（这次添加两个 0）等等...

vim 宏非常难看，但是当我太累而无法编写 oneliner 时它们对我很有用（不过我应该学习 awk）。此外，它们可以帮助您记住一些晦涩但有用的 vim 快捷方式。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-05T23:34:32.663

如果您的环境中有 PERL，则可以在您的 VIM 会话中运行 PERL 单行程序。

```
:%! perl -pe " $count++ ; s/$/$count/" 
```

需要注意的是，您可能必须在 perl 脚本周围使用双引号。在我的 PC 上，如果我使用单引号，PERL 将运行。但是我不能用美元符号来处理变量。*

# delphi - 使用 poPropagateChanges 和 poFetchDetailsOnDemand 避免 ClientDataSets 中的内存损坏？

> ID：14059109
> 
> 赞同：3
> 
> 时间：2012-12-27T18:04:02.327
> 
> 标签：delphi, delphi-xe, tclientdataset

对于一个相当大的简化程序来显示问题，提前道歉......我的问题结束时的完整代码。

我有一个`TClientDataSet`广泛使用的程序，有时会导致错误消息，据我所知是正确的代码。我已将其简化为一个示例程序，该程序在`.\SQLEXPRESS`MSSQL 实例上运行，在`tempdb`数据库上，并用于`TClientDataSet`访问具有主从链接的三个表。数据库结构如下所示：

```
╔═══════════╗╔═══════════╗╔═══════════╗
║ 测试1 ║ ║ 测试2 ║ ║ 测试3 ║
╟────────────╢ ╟────────────╢ ╟────────────╢
║*身份证*        ║─┐║*身份证*        ║─┐║*身份证*        ║ *║ 数据域 ║ └──║ Test1 ║ └──║ Test2 ║
╚═══════════╝║数据域║║数据域║
                 ╚═══════════╝╚═══════════╝* 
```

 *在这个简化版本中，这三个`id`字段是简单的整数字段，但在我的真实代码中，它们是标识列。这没有直接关系，除了不变的“你为什么这样做？” 问题。

在将记录推入时`Test3`，在提供者的`BeforeUpdateRecord`事件中，我将其`Test2`值设置为相应记录的`id`字段。`Test2`这是必要的，因为当使用真实身份列并且新插入记录时，它不会自动发生。我也`NewValue`用于其他服务器计算的值。

在我调用`ApplyUpdates`成功后，我尝试获取下一个主记录的详细记录。这成功了，细节被加载，*但是*：细节记录被标记为`usModified`，即使数据集`ChangeCount`为零。换句话说，最后一个断言失败。

Delphi 2010 的行为相同，并带有 MIDAS 源代码，让我可以追踪以找出问题所在。简而言之，`OverWriteRecord`就是在推`NewValue`回数据库时使用。`OverWriteRecord`使用记录`iRecNoNext`作为临时缓冲区，并将其`attr`字段丢弃。FetchDetails 最终调用`InsertRecord`，它假定新的记录缓冲区`attr`仍然为 0。它不是 0，之后一切都出错了。

知道了这一点，我可以通过将 MIDAS 源更改为 always reset 来解决它`attr`。除了 Delphi XE Pro 不包括它们。所以，我的问题：

*   这个问题在 Delphi XE3 中修复了吗？
    *   如果是这样，它是否`midas.dll`可以自由再分配？
        *   如果是这样，我在哪里可以得到它？
*   如果没有，有没有办法在*不*改变 MIDAS 来源的情况下避免这个问题？

请注意，减少问题发生的频率（通过避免设置，`NewValue`除非非常必要）是不够的。

使用`poPropagateChanges`将`NewValue`s 移回原始 ClientDataSet 和使用`poFetchDetailsOnDemand`不一次性加载所有详细记录对于应用程序都是必不可少的。

*新观察*：`InsertRecord`（in `dsupd.cpp`）中的代码：

```
if (!bDisableLog) // Nov. -97
{
    piAttr[iRecNoNext-1] = dsRecNew;
} 
```

故意不清除属性。当从`ReadRows`(in `dsinmem2.cpp`) 调用它时，属性会在`InsertRecord`被调用之前设置，因此在这种情况下重置属性是错误的。无论如何，任何需要改变的东西都不应该改变。

完整代码：

**DBClientTest.dpr**：

```
program DBClientTest;

uses
  Forms,
  MainForm in 'MainForm.pas' {frmMain};

{$R *.res}

begin
  Application.Initialize;
  Application.CreateForm(TfrmMain, frmMain);
  Application.Run;
end. 
```

**MainForm.dfm**：

```
object frmMain: TfrmMain
  Left = 0
  Top = 0
  Caption = 'frmMain'
  ClientHeight = 297
  ClientWidth = 297
  Color = clBtnFace
  Font.Charset = DEFAULT_CHARSET
  Font.Color = clWindowText
  Font.Height = -11
  Font.Name = 'Tahoma'
  Font.Style = []
  OldCreateOrder = False
  OnCreate = FormCreate
  PixelsPerInch = 96
  TextHeight = 13
  object ADOConnection: TADOConnection
    Connected = True
    ConnectionString =
      'Provider=SQLNCLI10.1;Integrated Security=SSPI;Persist Security I' +
      'nfo=False;User ID="";Initial Catalog=tempdb;Data Source=.\SQLEXP' +
      'RESS;Initial File Name="";Server SPN=SSPI'
    LoginPrompt = False
    Provider = 'SQLNCLI10.1'
    Left = 32
    Top = 8
  end
  object DropTablesCommand: TADOCommand
    CommandText =
      'if object_id('#39'Test3'#39') is not null'#13#10#9'drop table Test3;'#13#10#13#10'if obje' +
      'ct_id('#39'Test2'#39') is not null'#13#10#9'drop table Test2;'#13#10#13#10'if object_id('#39 +
      'Test1'#39') is not null'#13#10#9'drop table Test1;'
    Connection = ADOConnection
    ExecuteOptions = [eoExecuteNoRecords]
    Parameters = <>
    Left = 32
    Top = 56
  end
  object CreateTablesCommand: TADOCommand
    CommandText =
      'create table Test1 ('#13#10#9'id int not null identity(1, 1) primary ke' +
      'y,'#13#10#9'datafield int not null );'#13#10#13#10'create table Test2 ('#13#10#9'id int ' +
      'not null identity(1, 1) primary key,'#13#10#9'Test1 int not null'#13#10#9#9'con' +
      'straint FK_Test2_Test1 foreign key references Test1 ( id ),'#13#10#9'da' +
      'tafield int not null );'#13#10#13#10'create table Test3 ('#13#10#9'id int not nul' +
      'l identity(1, 1) primary key,'#13#10#9'Test2 int not null'#13#10#9#9'constraint' +
      ' FK_Test3_Test2 foreign key references Test2 ( id ),'#13#10#9'datafield' +
      ' int not null );'
    Connection = ADOConnection
    ExecuteOptions = [eoExecuteNoRecords]
    Parameters = <>
    Left = 32
    Top = 104
  end
  object Test1ADO: TADODataSet
    Connection = ADOConnection
    CursorType = ctStatic
    CommandText = 'select id, datafield from Test1;'
    IndexFieldNames = 'id'
    Parameters = <>
    Left = 32
    Top = 152
    object Test1ADOid: TIntegerField
      FieldName = 'id'
      ProviderFlags = [pfInUpdate, pfInWhere, pfInKey]
    end
    object Test1ADOdatafield: TIntegerField
      FieldName = 'datafield'
    end
  end
  object Test2ADO: TADODataSet
    Connection = ADOConnection
    CursorType = ctStatic
    CommandText = 'select id, Test1, datafield from Test2 where Test1 = :id;'
    DataSource = Test1ADODS
    IndexFieldNames = 'Test1;id'
    MasterFields = 'id'
    Parameters = <
      item
        Name = 'id'
        Attributes = [paSigned]
        DataType = ftInteger
        Precision = 10
        Value = 1
      end>
    Left = 32
    Top = 200
    object Test2ADOid: TIntegerField
      FieldName = 'id'
      ProviderFlags = [pfInUpdate, pfInWhere, pfInKey]
    end
    object Test2ADOTest1: TIntegerField
      FieldName = 'Test1'
    end
    object Test2ADOdatafield: TIntegerField
      FieldName = 'datafield'
    end
  end
  object Test3ADO: TADODataSet
    Connection = ADOConnection
    CursorType = ctStatic
    CommandText = 'select id, Test2, datafield from Test3 where Test2 = :id;'
    DataSource = Test2ADODS
    IndexFieldNames = 'Test2;id'
    MasterFields = 'id'
    Parameters = <
      item
        Name = 'id'
        Attributes = [paSigned]
        DataType = ftInteger
        Precision = 10
        Value = 1
      end>
    Left = 32
    Top = 248
    object Test3ADOid: TIntegerField
      FieldName = 'id'
      ProviderFlags = [pfInUpdate, pfInWhere, pfInKey]
    end
    object Test3ADOTest2: TIntegerField
      FieldName = 'Test2'
    end
    object Test3ADOdatafield: TIntegerField
      FieldName = 'datafield'
    end
  end
  object Test1ADODS: TDataSource
    DataSet = Test1ADO
    Left = 104
    Top = 152
  end
  object Test2ADODS: TDataSource
    DataSet = Test2ADO
    Left = 104
    Top = 200
  end
  object DataSetProvider: TDataSetProvider
    DataSet = Test1ADO
    Options = [poFetchDetailsOnDemand, poPropogateChanges, poUseQuoteChar]
    BeforeUpdateRecord = DataSetProviderBeforeUpdateRecord
    Left = 184
    Top = 152
  end
  object Test1CDS: TClientDataSet
    Aggregates = <>
    FetchOnDemand = False
    Params = <>
    ProviderName = 'DataSetProvider'
    Left = 256
    Top = 152
    object Test1CDSid: TIntegerField
      FieldName = 'id'
      ProviderFlags = [pfInUpdate, pfInWhere, pfInKey]
    end
    object Test1CDSdatafield: TIntegerField
      FieldName = 'datafield'
    end
    object Test1CDSTest2ADO: TDataSetField
      FieldName = 'Test2ADO'
    end
  end
  object Test2CDS: TClientDataSet
    Aggregates = <>
    DataSetField = Test1CDSTest2ADO
    FetchOnDemand = False
    Params = <>
    Left = 256
    Top = 200
    object Test2CDSid: TIntegerField
      FieldName = 'id'
      ProviderFlags = [pfInUpdate, pfInWhere, pfInKey]
    end
    object Test2CDSTest1: TIntegerField
      FieldName = 'Test1'
    end
    object Test2CDSdatafield: TIntegerField
      FieldName = 'datafield'
    end
    object Test2CDSTest3ADO: TDataSetField
      FieldName = 'Test3ADO'
    end
  end
  object Test3CDS: TClientDataSet
    Aggregates = <>
    DataSetField = Test2CDSTest3ADO
    FetchOnDemand = False
    Params = <>
    Left = 256
    Top = 248
    object Test3CDSid: TIntegerField
      FieldName = 'id'
      ProviderFlags = [pfInUpdate, pfInWhere, pfInKey]
    end
    object Test3CDSTest2: TIntegerField
      FieldName = 'Test2'
    end
    object Test3CDSdatafield: TIntegerField
      FieldName = 'datafield'
    end
  end
end 
```

**MainForm.pas**：

```
unit MainForm;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, DB, ADODB, DBClient, Provider;

type
  TfrmMain = class(TForm)
    ADOConnection: TADOConnection;
    DropTablesCommand: TADOCommand;
    CreateTablesCommand: TADOCommand;
    Test1ADO: TADODataSet;
    Test1ADOid: TIntegerField;
    Test1ADOdatafield: TIntegerField;
    Test2ADO: TADODataSet;
    Test2ADOid: TIntegerField;
    Test2ADOTest1: TIntegerField;
    Test2ADOdatafield: TIntegerField;
    Test3ADO: TADODataSet;
    Test3ADOid: TIntegerField;
    Test3ADOTest2: TIntegerField;
    Test3ADOdatafield: TIntegerField;
    Test1ADODS: TDataSource;
    Test2ADODS: TDataSource;
    DataSetProvider: TDataSetProvider;
    Test1CDS: TClientDataSet;
    Test1CDSid: TIntegerField;
    Test1CDSdatafield: TIntegerField;
    Test1CDSTest2ADO: TDataSetField;
    Test2CDS: TClientDataSet;
    Test2CDSid: TIntegerField;
    Test2CDSTest1: TIntegerField;
    Test2CDSdatafield: TIntegerField;
    Test2CDSTest3ADO: TDataSetField;
    Test3CDS: TClientDataSet;
    Test3CDSid: TIntegerField;
    Test3CDSTest2: TIntegerField;
    Test3CDSdatafield: TIntegerField;
    procedure DataSetProviderBeforeUpdateRecord(Sender: TObject;
      SourceDS: TDataSet; DeltaDS: TCustomClientDataSet;
      UpdateKind: TUpdateKind; var Applied: Boolean);
    procedure FormCreate(Sender: TObject);
  end;

var
  frmMain: TfrmMain;

implementation

{$R *.dfm}

{ TfrmMain }

procedure TfrmMain.DataSetProviderBeforeUpdateRecord(Sender: TObject;
  SourceDS: TDataSet; DeltaDS: TCustomClientDataSet; UpdateKind: TUpdateKind;
  var Applied: Boolean);
begin
  if SourceDS = Test3ADO then
  begin
    with DeltaDS.FieldByName(Test3CDSTest2.FieldName) do
      NewValue := DeltaDS.DataSetField.DataSet.FieldByName(Test2CDSid.FieldName).Value;
  end;
end;

procedure TfrmMain.FormCreate(Sender: TObject);
begin
  DropTablesCommand.Execute;
  try
    CreateTablesCommand.Execute;

    Test1ADO.Open;
    Test2ADO.Open;
    Test3ADO.Open;

    Assert(Test1ADO.IsEmpty);
    Test1ADO.AppendRecord([ nil, 1 ]);

      Assert(Test2ADO.IsEmpty);
      Test2ADO.AppendRecord([ nil, Test1ADOid.Value, 2 ]);

        Assert(Test3ADO.IsEmpty);
        Test3ADO.AppendRecord([ nil, Test2ADOid.Value, 3 ]);

    Test1ADO.AppendRecord([ nil, 4 ]);

      Assert(Test2ADO.IsEmpty);
      Test2ADO.AppendRecord([ nil, Test1ADOid.Value, 5 ]);

        Assert(Test3ADO.IsEmpty);
        Test3ADO.AppendRecord([ nil, Test2ADOid.Value, 6 ]);

    Test3ADO.Close;
    Test2ADO.Close;
    Test1ADO.Close;

    Test1CDS.Open;

    Test1CDS.First;
    Assert(Test1CDSdatafield.Value = 1);

    Assert(Test2CDS.IsEmpty);
    Test1CDS.FetchDetails;
    Assert(Test2CDS.RecordCount = 1);

    Assert(Test3CDS.IsEmpty);
    Test2CDS.FetchDetails;
    Assert(Test3CDS.RecordCount = 1);

    Test3CDS.First;
    Assert(Test3CDSdatafield.Value = 3);
    Test3CDS.Edit;
    Test3CDSdatafield.Value := -3;
    Test3CDS.Post;

    Test1CDS.ApplyUpdates(0);

    Assert(Test3CDSdatafield.Value = -3);

    Test1CDS.Last;
    Assert(Test1CDSdatafield.Value = 4);

    Assert(Test2CDS.IsEmpty);
    Test1CDS.FetchDetails;
    Assert(Test2CDS.RecordCount = 1);
    Assert(Test2CDS.UpdateStatus = usUnmodified);

    Assert(Test3CDS.IsEmpty);
    Test2CDS.FetchDetails;
    Assert(Test3CDS.RecordCount = 1);
    Assert(Test3CDS.UpdateStatus = usUnmodified);
  finally
    DropTablesCommand.Execute;
  end;
end;

end. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T14:05:38.797

在广泛搜索 D2010 MIDAS 代码后，我确定对于我的应用程序中的用途，有以下三种可能性`InsertRecord`：

*   该属性已设置为 0
*   该属性未设置，也不会设置
*   该属性需要设置为`dsRecNew`

第四种可能性，属性已经设置为 0 以外的值，在我的应用程序中不会出现。因此，始终在该点设置属性对我来说不是问题。我赌了一把，说 XE 的 MIDAS DLL 仍然是这样。

我选择手动加载 MIDAS.DLL，并在内存中对其进行修补。基于 D2010 代码：

```
if (!bDisableLog) // Nov. -97
{
    piAttr[iRecNoNext-1] = dsRecNew;
} 
```

编译为

```
837B2400   cmp dword ptr [ebx+$24],$00
750B       jnz skip
8B4338     mov eax,[ebx+$38]
8B537C     mov edx,[ebx+$7c]
C64410FF04 mov byte ptr [edx+eax-$01],$04
           skip: 
```

知道它`bDisableLog`是 0 还是 1，我已将代码更改为

```
piAttr[iRecNoNext-1] = (bDisableLog - 1) & dsRecNew; 
```

可以编译为

```
8B4324     mov eax,[ebx+$24]
48         dec eax
83E004     and eax,$04
8B5338     mov edx,[ebx+$38]
8B737C     mov esi,[ebx+$7c]
884432FF   mov [edx+esi-$01],al 
```

这是完全相同的字节数。`esi`没有保存需要保留的值。

所以在我的代码中：

*   我打电话`LoadLibrary('midas.dll')`
*   我打电话`GetProcAddress(handle, 'DllGetClassObject')`
*   我发现上面的代码是`$24094`字节后`DllGetClassObject`
*   我验证读取 17 个字节会产生 17 个预期字节
*   我打电话`VirtualProtect`来确保内存是可写的（准确地说是写时复制）
*   我覆盖记忆
*   我`VirtualProtect`再次调用恢复内存保护
*   最后，我传递 to 的地址`DllGetClassObject`，`RegisterMidasLib`以防止`DBClient`尝试再次加载 MIDAS.DLL，甚至可能是不同的 MIDAS.DLL

是的，这很脆弱，会随着新版本的 MIDAS.DLL 中断。如果这是一个问题，我可以确保从应用程序目录加载 XE 的 MIDAS.DLL，绕过恰好安装在系统范围内的任何 MIDAS。如果/当我升级到较新版本的 Delphi 时，无论此错误是否已修复，我都会确保它是包含 MIDAS 源代码的版本，这样我就可以避免陷入此类问题。*

# html - 简单的边框颜色不适用于 IE7

> ID：14059110
> 
> 赞同：0
> 
> 时间：2012-12-27T18:04:06.023
> 
> 标签：html, css

```
#skiptrace {
  border-top: #FFFFFF; 
  border-left: #FFFFFF;
  border-right: #FFFFFF;
  border-bottom: #FFFFFF;
  width: 731px;
  height: 900px; 
} 
```

边框仍然出现在 IE 下面的我的 div 上。

我正在尝试融入

```
<!--[if IE]><style type="text/css">.pie, #skiptrace {behavior:url(PIE.htc);}</style><![endif]-->
<!--[if IE 7]><html class="ie7 oldie"> <![endif]--> 
```

从这个网站..这很不错 [http://css3pie.com/](http://css3pie.com/)

```
<div id="skiptrace">
  <iframe name="my_iframe" src="" id="skiptrace"></iframe>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T18:10:03.973

尝试以这种方式使用它：

```
<style type="text/css">
#skiptrace {
     border:1px solid #FFF;
     behavior:url(PIE.htc);
}
</style> 
```

**注意：** PIE.htc 是相对于**文档**而不是 CSS 文件。

# php - 浏览器刷新后尝试保留在 PHP 表单文本字段中输入的值时出错

> ID：14059118
> 
> 赞同：0
> 
> 时间：2012-12-27T18:04:44.560
> 
> 标签：php, forms, submit

我正在尝试运行一个小的 PHP 脚本。当我尝试运行这个 PHP 小行时出现错误： < **?PHP print $firstname ;** ?> 在 html 代码中。根据我的教程指南， value 元素中的这一行应该确保即使在刷新浏览器后我也保留输入到文本字段中的任何输入文本，但事实并非如此！出现以下错误消息：

> 注意：未定义变量：C:\wamp\www\pages\basicForm.php 中的姓氏在第 27 行调用堆栈#TimeMemoryFunctionLocation 10.0007366504{main}()..\basicForm.php:0 "NAME="surname">

为什么？

和代码：

```
<!DOCTYPE html>
<html>
<head>
    <title></title>
        <?PHP
        if (!empty($_POST)) {
            $firstname = $_POST['firstname'];
            $surname = $_POST['surname'];
            print($firstname);
            print($surname);
        }
        else {

        } print( 'welcomes');
    ?>
</head>
<body>
<Form name ="form1" Method ="POST" Action ="basicForm.php">
    <label>

    <INPUT TYPE = 'TEXT' Name ='firstname' VALUE="<?PHP print $firstname ; ?>">
    </label>

    <p>
        <label>
            <INPUT TYPE="TEXT" VALUE="<?PHP print($surname); ?>" NAME="surname">
        </label>

    <p>
        <Input Type = "Submit" Name = "Submit1" Value = "Login">
</FORM>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T18:08:05.393

您需要分配的初始值如下

```
$firstname = '';
$surname = ''; 
```

> 在将一个文件包含到另一个使用相同变量名的文件中的情况下，依赖未初始化变量的默认值是有问题的。开启 register_globals 也是一个主要的安全风险。在使用未初始化变量的情况下会发出 E_NOTICE 级别错误，但在将元素附加到未初始化数组的情况下则不会。isset() 语言结构可用于检测变量是否已经初始化。

详细阅读：[PHP：“注意：未定义的变量”、“注意：未定义的索引”和“注意：未定义的偏移量”](https://stackoverflow.com/questions/4261133/php-notice-undefined-variable-and-notice-undefined-index)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T18:09:35.177

`$surname`一开始没有设置：

```
<INPUT TYPE="TEXT" VALUE="<?PHP print($surname); 
```

`$_POST`如果不为空，它只会设置在顶部。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T18:11:10.040

如果`$_POST`变量为空，则`$surname`不会创建。有几种方法可以解决这个问题。

1、预定义你的变量：

```
$firstname = '';
$surname = '';
if (!empty($_POST)) {
    $firstname = $_POST['firstname'];
    $surname = $_POST['surname'];
}else {

} 
```

2、使用三元语法：

```
$firstname = isset($_POST['firstname']) ? $_POST['firstname'] : ''; 
$surname = isset($_POST['surname']) ? $_POST['surname'] : ''; 
```

两者都将确保您的变量在打印之前创建。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-27T18:16:44.167

> 根据我的教程指南， value 元素中的这一行应确保即使在刷新浏览器后我仍将输入的任何输入文本保留在文本字段中

看来你误解了你的教程。
在您实际向服务器发送内容之前，服务器端技术无济于事。
因此，您似乎只是在提交之前输入您的值并刷新您的页面。虽然有些浏览器可能会根据自己的意愿保留输入的值，但服务器端 PHP 与它无关。

Another story if you populate your form with values that's already on the server - such filled form will persists even refreshes.

# c - 使用动态 n 生成 1 到 n 之间的整数

> ID：14059120
> 
> 赞同：1
> 
> 时间：2012-12-27T18:04:59.637
> 
> 标签：c

我正在努力使用一种算法将 1 和动态变量 n 之间的数字打印到 int 中。

```
int n = // dynamic value
int i = 0;
int output[n];

for(i = 0; i < n; i++) {
    output[i] = i;
} 
```

但是，由于 n 是动态的，因此代码不会编译。

任何帮助将不胜感激 - 在此先感谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-27T18:06:54.267

您需要分配一个缓冲区或动态大小的数组，其中[`malloc`](http://linux.die.net/man/3/malloc)：

```
int n = // whatever
int i = 0;
int* output = NULL;

// Allocate the buffer
output = malloc(n * sizeof(int));
if (!output) {
    fprintf(stderr, "Failed to allocate.\n");
    exit(1);
}

// Do the work with the array
for(i = 0; i < n; i++) {
    output[i] = i;
}

// Finished with the array
free(output); 
```

`output`是指向您分配的缓冲区开头的指针，您可以将其视为`n` `ints`.

完成数组后，您需要使用[`free`](http://linux.die.net/man/3/free).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T18:07:47.107

这应该有效：

```
int n = // whatever
int i = 0;
int* output = (int*)malloc(sizeof(int)*n);

for(i = 0; i < n; i++) {
    output[i] = i;
} 
```

`free(output);`当你不再需要它时不要忘记。

编辑：做到了C。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T19:26:23.023

如果“n”在运行时发生变化，那么您可以像评论中建议的那样使用 malloc。然后检查是否需要更多空间，然后在需要时自动重新分配更多空间

# html - 用什么代替 div？

> ID：14059124
> 
> 赞同：-1
> 
> 时间：2012-12-27T18:05:23.990
> 
> 标签：html

在 WHATWG [HTML 规范](http://www.whatwg.org/specs/web-apps/current-work/multipage/grouping-content.html#the-div-element)中，关于 div 元素，我们必须努力不使用 div 元素。

它说：

> 强烈建议作者将 div 元素视为不得已的元素，因为当没有其他元素适合时。使用更合适的元素而不是 div 元素可以提高读者的可访问性和作者的可维护性。

那么我们应该使用什么来代替 div 呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-27T18:08:47.080

使用对文档结构*有意义的内容。*如果您正在撰写文章，请使用该`article`元素。在文档中定义段？考虑`section`标签。需要标记文档的标题？使用`header`元素。

```
<article>
    <header>
        <h1>Foo Title Here</h1>
    </header>
    <p>Article content can go here.</p>
    <p>Note how meaningful this document structure is.</p>
    <footer>
        <!-- Links, etc. -->
    </footer>
</article> 
```

想想看，每个文档都以具有语义意义的标签开始：我们用标签包装我们的 HTML 文档`<html>`。在里面，我们定义了 a`<head>`和 a `<body>`。在头部中，我们提供了一个`<title>`，也许是几个，并用or`<script>`链接了一些样式表。`<link>``<style>`

由于每个人都遵循这些规则，因此令人难以置信为什么他们会放弃这种一致性并倾向于使用模糊和半无意义的标签`<div>`来定义文档的关键部分。

对比由模糊和无意义的标签组成的文档：

```
<div>
    <div>
        <div>Foo Title Here</div>
    </div>
    <div>Article content can go here.</div>
    <div>Note how meaningful this document structure is.</div>
    <div>
        <!-- Links, etc. -->
    </div>
</div> 
```

很没有意义，对吧？始终为工作使用正确的工具。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-27T18:08:28.330

阅读参考规范的下一行，他们提供了一些示例：

> 例如，一篇博客文章可以使用 article 来标记，章节使用 section 来标记，页面的导航帮助使用 nav，以及一组表单控件使用 fieldset。

因此，如果可能，您应该使用比元素具有更多语义含义的`div`元素。

# c++ - 使用 C++ 中的模板元编程从函数类型中提取调用约定

> ID：14059127
> 
> 赞同：8
> 
> 时间：2012-12-27T18:06:04.110
> 
> 标签：c++, templates

这是一个相当长的镜头，因为我不确定这是否可能，但也许在模板元编程方面比我更有经验的人会启发我。

我正在使用模板编写一个自动 lua 函数绑定系统，使用部分专业化提取函数类型：

```
template<typename T, T FUNCTION> class Function_c;
template<typename R, R (*FUNCTION)()> class Function_c<R (*)(), FUNCTION>; //specialized version 
```

问题是，这并没有告诉我函数调用约定，所以（在 ​​VS2012 32 位中）它不会为 __stdcall 编译，并且会因 __fastcall 崩溃。我可以创建另一个专门的版本来处理特定的调用约定，例如：

```
template<typename R, R (__stdcall *FUNCTION)()> class Function_c<R (__stdcall *)(), FUNCTION>; 
```

但是排列的数量开始失控：2（全局和成员函数）乘以最大参数数量乘以调用约定数量。

所以我想知道是否有任何方法可以将调用约定作为模板参数（可能不是，因为它不是真正的类型）来减少复制粘贴的数量。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T18:16:21.643

当您处理此类参数时，您可以执行以下操作之一。

**添加一个额外的参数**

您的模板将如下所示：

`template < typename T, T function, typename CallType > class Function_c;`

您可以轻松地将实际调度隐藏在 中`CallType`，因此您只需要为每种类型的调用实现一个类。

**做一个包装**

我猜你的类已经是一个包装对象，但你可以轻松地更进一步。

您可以为每种调用类型创建一个包装器，然后可以将模板更改为：

`template < typename T, typename Functor > class Function_c;`

像这样实例化：`Function_c<int, WrapperStdCall<int (*)()> > x;`

# javascript - 使用 jquery 获取 html 元素

> ID：14059128
> 
> 赞同：-1
> 
> 时间：2012-12-27T18:06:06.020
> 
> 标签：javascript, jquery

如果我有以下 html 代码

```
<div id="tabs">
    <ul>
       <li><a href="#tab-One" class="tabLink">This is tab one</a></li>
       <li><a href="#tab-Two" class="tabLink">This is tab two</a></li>
    ...
    </ul>
</div> 
```

我怎么能将此字符串获取到某个 js 变量`One`或`Two`（这当然是动态数据）。这个字符串正好在`#tab-`和之间`class=`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T18:10:17.593

```
var text = $("#tabs .tabLink[href='#tab-" + someJsVar + "']").text(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T18:13:08.613

假设您想在点击时执行此操作，您可以执行以下操作

```
var activeTab = null;
$('#tabs .tabLink').click(function() {
    activeTab = $(this).attr('href').split('-')[1];
    window.alert(activeTab);
}); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-27T18:14:03.153

这将遍历所有 .tabLinks 并获取您正在寻找的值。

```
$('#tabs').find('.tabLink').each(function(i,el){
    alert($(el).attr('href').replace('#tab-',''))
});​ 
```

# regex - 使用替换变量搜索和替换正则表达式

> ID：14059129
> 
> 赞同：12
> 
> 时间：2012-12-27T18:06:16.590
> 
> 标签：regex

所以我的公司正在为他们的移动网站使用第三方，我们有一个控制台来更新一些代码并通过它们控制东西。其中之一是可以更新站点代码的搜索和替换功能。唯一的一点是，它使用了很多复杂的正则表达式代码，我似乎找不到关于复杂内容的好教程。所以这是他给我的例子，它抓住段落标签并将其放在链接中

**搜索**

```
(#d6d6d4.+?>.+?<p><a.+?>.+?)</a>(.+?)</td> 
```

**用。。。来代替**

```
$1$2</a></td> 
```

$1 和 $2 代表什么？我知道它可能与 .+? 之一有关。但我不确定是哪一个。如果有人知道请帮助我。我在下面添加了代码，正则表达式变量旁边有数字

```
(#d6d6d4.+?**[1]**>.+?**[2]**<p><a.+?**[3]**>.+?**[4]**)</a>(.+?**[5]**)</td> 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-12-27T18:31:32.567

$1 和 $2 代表正则表达式中捕获组中的文本。捕获组是括号内的内容。

```
 (        // start first capture group
 #d6d6d4  // match #d6d6d4
 .+?>     // any character, non-greedy, up to '>'
 .+?<p>   // any character, non-greedy, up to <p>
 <a.+?>   // an <a..> tag, consuming everything up to '>'
 .+?      // all characters from <a> to </a>
 )        // close the first capture group before the '</a>'
 </a>     // literal '</a>' 
 (        // start second capture group
 .+?      // match all, non-greedy up to '</td>'
 )        // close capture group before '</td>'
 </td>    // literal '</td>' 
```

所以如果你有这个字符串：`<td color=#d6d6d4 foo=bar>Hello, world<p><a href=http://foo.com>foo link</a>some more text</td>`

$1 匹配：`#d6d6d4 foo=bar>Hello, world<p><a href=http://foo.com>foo link` $2 匹配：`some more text`

所以字符串转换为： `<td color=#d6d6d4 foo=bar>Hello, world<p><a href=http://foo.com>foo linksome more text</a></td>`

这基本上意味着`</a>`标签在之后`some more text`（或者`</td>`如果你愿意的话就在之前）移动

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-27T18:11:04.383

$1 和 $2 变量是为（parens）内的模式捕获的匹配项，$1 是第一个 paren 组，$2 是第二个。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-27T18:10:31.493

我认为[http://rubular.com/](http://rubular.com/)是一个很好的正则表达式培训工具，因为它是交互式的，您可以针对不同的文本不断尝试不同的模式，并且您会立即看到结果。

它包括一个指向[http://www.ruby-doc.org/docs/ProgrammingRuby/html/language.html#UJ](http://www.ruby-doc.org/docs/ProgrammingRuby/html/language.html#UJ)的链接，这是一个很好的正则表达式基本指南。

还有[http://www.regular-expressions.info/](http://www.regular-expressions.info/)

[当http://regexlib.com](http://regexlib.com)上什至有一个包含 3,500 多个正则表达式库的站点时，为什么还要努力编写自己的

$ 变量用于存储“匹配的”：- $1 表示第一次匹配；第二个 2 美元，以此类推。

# lucene - Lucene.net 过滤器：它们是限制初始搜索空间还是仅从搜索结果中排除过滤后的文档？

> ID：14059137
> 
> 赞同：2
> 
> 时间：2012-12-27T18:06:51.147
> 
> 标签：lucene, lucene.net

我正在尝试确定 Lucene.net 过滤器是限制搜索空间还是仅根据过滤器返回的文档从搜索匹配中排除文档。也就是说，如果过滤器允许文档 A、B 和 C 而不是 D 和 E，并且用户的查询匹配 B、C 和 D，那么过滤器是否会阻止 D 被视为查询匹配，或者查询会阻止匹配项包括 B、C 和 D，然后在查询运行后仅将 D 排除在过滤器之外？我在这方面的任何地方都找不到确凿的信息。我最接近的是一年半前的这篇文章：http: [//java.dzone.com/news/fast-lucene-search-filters](http://java.dzone.com/news/fast-lucene-search-filters)建议在返回查询匹配后应用过滤器。请记住，我使用的是当前版本的 Lucene.net，而不是 Lucene for Java。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T04:36:59.797

在**当前的**Lucene.Net 中，过滤器在查询执行后应用。因此，过滤器排除的文档仍将根据查询条件进行评分，然后从结果集中删除。

这在 4.x 中发生了变化，有关更多信息，请参阅[Lucene-1536](https://issues.apache.org/jira/browse/LUCENE-1536)。

现在你可能会问，使用过滤器值得吗？答案是肯定的，如果您缓存过滤器以供重复使用。

# drupal-7 - 管理员批准后在 Drupal 7 用户注册邮件中发送密码

> ID：14059139
> 
> 赞同：0
> 
> 时间：2012-12-27T18:07:06.863
> 
> 标签：drupal-7

我正在 Drupal 7 中创建一个站点。我通过管理员批准使用用户注册。管理员批准后，我想在用户邮件中发送用户密码，但要发送用户名，并且只有“您的密码”静态文本。

任何人都可以帮助我。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T11:45:53.903

查看[这篇文章](http://drupal.org/node/1165126)，更准确地说是评论[#16](http://drupal.org/node/1165126#comment-5593768)：

```
/**
 * Implements hook_token_info().
 * */
function modulename_token_info() {
    $info['tokens']['user']['password'] = array(
    'name' => t('Password'),
    'description' => t('The password by the user'),
    );
return $info;
}

/**
 * Implements hook_tokens().
 * */
function modulename_tokens($type, $tokens, array $data = array(), array $options = array()) {
    $replacements = array();
    $url_options = array('absolute' => TRUE);
    if (isset($options['language'])) {
        $url_options['language'] = $options['language'];
    }
    if ($type == 'user' && !empty($data['user'])) {
        $account = $data['user'];
        foreach ($tokens as $name => $original) {
            switch ($name) {
                case 'password':
                    $replacements[$original] = $account->password;
                    break;
            }
        }
    }
    return $replacements;
} 
```

之后，`/admin/config/people/accounts`您将在您的帐户中找到新用户密码 [user:password] 的令牌

# python - 基于wsdl创建pythonsoap服务器

> ID：14059142
> 
> 赞同：36
> 
> 时间：2012-12-27T18:07:33.887
> 
> 标签：python, soap, wsdl

我有一个描述 Java 产品上的通信服务器客户端的 wsdl 文件。我正在实现一个基于 Python 的新服务器，它将实现相同的服务。

您是否知道基于 wsdl 创建 Python 服务器代码的任何方法，不需要我编写所有涉及的复杂类型？

另外，你推荐什么Api？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-04-11T18:04:54.490

> 这个问题没有得到足够的重视。
> 
> 当前接受的答案很好，但它的答案是“不”。真的没有合理维护和通用的解决方案吗？

不幸的是，我不认为否定答案是由于对问题缺乏关注。python 中确实不支持 WSDL。如果您想避免从头开始构建自己的肥皂信封的复杂性，我唯一可以建议您的是使用许多肥皂网络服务工具（例如soapui）构建一个示例信封，然后将其用作模板字符串（我知道，可怕）在你的 python 代码中

**更新**你可以使用[spyne](http://spyne.io/)。它是一个 python RPC 工具包，在其他协议中支持 SOAP。它将为您创建 WSDL，但如果您的目标是实现您已经拥有的 WSDL 描述的服务，那么您将不得不微调您的 spyne 服务（用 python 编写），直到生成的 WSDL 与原始的匹配

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-12-29T12:31:05.390

当谈到 SOAP 支持时，不幸的是 Python 不再是“包括电池”。客户端的支持是可以接受的，但在服务器端你基本上是靠你自己的。

对于初学者，您可能希望查看以下内容：

[http://wiki.python.org/moin/WebServices](http://wiki.python.org/moin/WebServices)

[http://pywebsvcs.sourceforge.net/](http://pywebsvcs.sourceforge.net/)

[http://doughellmann.com/2009/09/01/evaluate-tools-for-developing-with-soap-in-python.html](http://doughellmann.com/2009/09/01/evaluating-tools-for-developing-with-soap-in-python.html)

如果你真的想走这条路，[ZSI](http://sourceforge.net/projects/pywebsvcs/files/ZSI/)似乎是可以使用的工具，尽管我怀疑它是否可以与最新的 2.x Python 发行版一起使用。

使用 Python 2.6.6，我尝试使用 ZSI 2.0 从 WSDL 开始构建 Web 服务。`wsdl2py`使用and生成代码时收到一些“模块已被弃用”警告`wsdl2dispatch`，必须单独安装[PyXML](http://sourceforge.net/projects/pyxml/files/pyxml/)并破解我的[`sys.path`](http://docs.python.org/2/library/sys.html#sys.path)问题，以使其首先解析，否则我得到“模块 ext.reader 不存在”，然后最终得到一个令人失望的“ZSI：EvaluateException Got None for nillable(False), minOccurs(1) element”在基本的“Hello world！”上出现错误。具有必需元素的 WS。

切换到 ZSI 2.1_a1，它不再需要 PyXML 并`wsdl2py`完成所有工作（`wsdl2dispatch`2.0 所做的），但仍以“ZSI:EvaluateException Got None for nillable(False), minOccurs(1) element”错误告终。

体验不是很有趣，但足以让我对 Python 必须为 SOAP Web 服务提供什么形成意见……这并不多（这只是针对基本的 Web 服务，没有什么像[WS-*规格](http://en.wikipedia.org/wiki/List_of_web_service_specifications)）。YMMV！

**编辑：**我最近遇到了[这个 SO question](https://stackoverflow.com/questions/206154/whats-the-best-soap-client-library-for-python-and-where-is-the-documentation-f)，虽然它是面向客户端解决方案的，但它也提到了一些用于构建 SOAP 服务的库。

# c# - 面板上的透明图片框

> ID：14059143
> 
> 赞同：0
> 
> 时间：2012-12-27T18:07:36.087
> 
> 标签：c#, label, transparency, opacity, picturebox

我有一个问题，因为我希望将 PictureBox 放在绘制为钢琴五线谱的面板上。我遇到的问题是在使用`.Transparent`它时只是给了我控制颜色表格，这是不正确的，有一个带有线条的五线谱。我能做些什么？

编辑：

汉斯，如何编写代码才能使所有内容都成为面板？代码：汉斯，如何编写代码才能使所有内容都成为面板？

代码：

```
class MusicNote : PictureBox
    {
        public string path = "ImagesName\\";
        public string noteShape = "";
        public int time = 0;

        public MusicNote(int iTime, string iNoteShape, int x, int y) : base()
        {
            noteShape = iNoteShape;
            time = iTime;
            Enabled = true;
            Location = new Point(x, y);
            Size = new Size(35, 35);
            Image NoteBmp = Image.FromFile(path + noteShape + ".png");
            Image = NoteBmp;

        }

        protected override void OnPaint(PaintEventArgs pe)
        {
            base.OnPaint(pe);
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T11:25:27.373

唯一必须在主窗体中添加的操作是将 PictureBox 的控件与面板中的控件一起添加。

```
Staff.Controls.Add(this.MNote); 
```

# meteor - handlebars.js “each” 循环在另一个 “each” 循环内 3

> ID：14059157
> 
> 赞同：27
> 
> 时间：2012-12-27T18:09:17.160
> 
> 标签：meteor, handlebars.js

假设我想建立一个动态表。我如何在每个内部运行每个。如果表示当前项目的唯一变量是`this`.

```
 {{#each by_width}}
       {{#each by_height}}
          {{this}} // how do refer to this from the outer loop?
       {{/each}}
   {{/each}} 
```

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2012-12-27T19:11:28.943

您可以使用`../`来访问 Handlebars 模板中的父级：

```
{{#each by_width}}
    {{#each by_height}}
       w: {{../this}}
       h: {{this}}
    {{/each}}
{{/each}} 
```

这当然假设它`by_height`在的每个元素内`by_width`，如果它们都在顶层，那么你需要另一个`../`：

```
{{#each by_width}}
    {{#each ../by_height}}
       w: {{../this}}
       h: {{this}}
    {{/each}}
{{/each}} 
```

演示：http: [//jsfiddle.net/ambiguous/PNTXw/](http://jsfiddle.net/ambiguous/PNTXw/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-11T23:36:01.813

不写`{{../this}}`但是`{{..this}}`。

# php - Cakephp 2.2.4 在使用替代身份验证后不保存身份验证用户信息

> ID：14059158
> 
> 赞同：0
> 
> 时间：2012-12-27T18:09:22.323
> 
> 标签：php, cakephp, cakephp-2.0

我正在尝试为 facebook 用户创建身份验证。现在我检查我的数据库中是否存在 fb 用户 ID，如果存在，则进行身份验证，如果不存在，则数据挖掘用户的 facebook 信息并创建用户，然后进行身份验证。它工作成功，问题是，如果我使用类似`$this->Auth->user('id');`值返回 null 的东西。我很好奇我可能做错了什么。下面是我的代码

```
public function fb_authenticate($data) {
    $this->Auth->fields = array('username' => 'fbid', 'password' => 'fbpassword');
    $this->loadModel('User');
    $user_record = $this->User->find('first', array(
            'conditions' => array('fbid' => $data['user_id'])
    ));
    if(empty($user_record)) {
        $fbu = $this->Facebook->getUserInfo($data['user_id']);
        $user_record = array(
            'User'=>array(
                'username'=>$fbu->username,
                'fbid'=>$data['user_id'],
                'oauth_token'=>$data['oauth_token'],
                'access_token'=>$data['access_token'],
                'firstname'=>$fbu->first_name,
                'lastname'=>$fbu->last_name,
                'fbpassword'=>$this->Auth->password($data['user_id']),
                'role'=>'user'
        ));     
        $this->User->create();
        $this->User->save($user_record,null);
    }
    if (!$this->Auth->login($user_record)) {
       $this->Session->setFlash(__('Invalid username or password, try again'));
    }
} 
```

它验证并允许用户进入，但它不会将用户信息存储在 Auth 组件会话中。可能是什么问题呢 ？？

如果我调试`debug($this->Auth->user())`，我可以看到数据，但如果我单独拉一个字段`debug($this->Auth->user('id'));`，它会返回`null`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T21:15:14.167

改变`$this->Auth->login($user_record)`

到`$this->Auth->login($user_record['User'])`.

# sql-server - TSQL Round up decimal number

> ID：14059164
> 
> 赞同：4
> 
> 时间：2012-12-27T18:09:40.563
> 
> 标签：sql-server, tsql, rounding

I have this number 0.581183781439, I need to round the number 0.582

I was trying with

```
SELECT ROUND (0.581183781439, 3)
-------------------------------
0.581000000000 
```

Is it useful ROUND function for this?

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-27T19:12:14.527

```
DECLARE @Test TABLE (Col NUMERIC(38,12));

INSERT  @Test (Col)
SELECT 0.581183781439 
UNION ALL
SELECT 0.5815
UNION ALL
SELECT 0.581883781439
UNION ALL
SELECT -0.581883781439;

SELECT Col AS [Col],
    ROUND(Col, 3) AS StandardRounding_3decimals,
    ROUND(Col, 3, 1) AS Truncation_3decimals,
    FLOOR(Col*1000)/1000 AS RoundDown_3decimals,
    CEILING(Col*1000)/1000  AS RoundUp_3decimals 
FROM @Test; 
```

Results:

```
Col             StandardRounding_3decimals Truncation_3decimals RoundDown_3decimals RoundUp_3decimals
--------------- -------------------------- -------------------- ------------------- -----------------
0.581183781439  0.581000000000             0.581000000000       0.581000            0.582000
0.581500000000  0.582000000000             0.581000000000       0.581000            0.582000
0.581883781439  0.582000000000             0.581000000000       0.581000            0.582000
-0.581883781439 -0.582000000000            -0.581000000000      -0.582000           -0.581000 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-27T18:10:52.070

Maybe you need this?

```
SELECT ROUND(0.581183781439, 3,1) + .001 
```

but correct rounding is `0.581`.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-09-23T09:41:10.153

We can write a T-SQL function to round up for an arbitrary number of decimal places.

```
CREATE FUNCTION RoundUp (@value float, @places int) RETURNS float
AS
BEGIN
    RETURN SELECT CEILING(@value * POWER(10, @places)) / POWER(10, @places)
END
GO

SELECT Result = dbo.RoundUp(0.581183781439, 3) 
```

> ## Result
> 
> 0.582

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-04-05T00:03:34.660

Adding a half value and using normal round will get the correct result.

```
SELECT ROUND (0.581183781439 + .0005, 3) 
```

Bonus: Subtract the half value instead, and it will round down.

*EDIT*: Actually, this has the same flaw as an answer above when the value is zeros after the 3rd decimal.

# javascript - 向所有 Knockout 模型添加属性

> ID：14059167
> 
> 赞同：0
> 
> 时间：2012-12-27T18:09:53.507
> 
> 标签：javascript, knockout.js

我有几个淘汰模型，我在我的网站上使用。假设对于给定的模型，我有一个属性

```
function modelA {
    this.doSomething = function () { ... };
} 
```

现在我想在不同的模型中使用 doSomething() 函数。我想这样做，这样我就没有义务在每个需要它的模型中重写 doSomething() 。理想情况下，如果此功能在 ko.applyBindings(new modelX()) 被调用后立即可用，我希望它。

我知道我可以从原型继承函数，但这也会导致每个模型中的重复代码。有没有办法改变 knockout.js 以将此属性注入所有模型对象？

编辑：

如果有一种不同的方法可以实现我的预期目标，我将详细说明该预期目标。我们使用 knockout-validation.js，它允许我对已扩展验证规则的模型中的每个属性调用 isValid()。我想在每个模型上附加一个函数来检查模型中的其他属性，并在它们上调用 isValid() 。这样我就可以编写一个可以用于每个模型的通用验证函数，而无需显式地将其添加到模型中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T18:19:42.543

您可以将自定义[函数](http://knockoutjs.com/documentation/fn.html)添加到淘汰赛的核心数据类型。或者，您可以查看[扩展程序](http://knockoutjs.com/documentation/extenders.html)，并在扩展程序中将函数添加到可观察对象。但是请注意，这两种技术都在“可观察”级别解决横切关注点，而不是在 ViewModel 级别。

我很想知道`doSomething`在做什么。假设它必须访问 ViewModel 中的一些可观察对象，您应该能够重新构建问题，以便将行为附加到可观察对象。

# php - 使用 PDO MySQL 插入 2 个表

> ID：14059172
> 
> 赞同：3
> 
> 时间：2012-12-27T18:10:12.433
> 
> 标签：php, mysql, pdo

> **可能重复：**
> [MySQL 插入多个表？（数据库规范化？）](https://stackoverflow.com/questions/5178697/mysql-insert-into-multiple-tables-database-normalization)

我试图使用 PDO 将我的记录插入到 2 个表中，我有以下

```
try {
  // Connect and create the PDO object
 $conn = new PDO("mysql:host=$hostdb; dbname=$namedb", $userdb, $passdb);
$conn->exec("SET CHARACTER SET utf8");      // Sets encoding UTF-8
$conn->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);

 $sql = "INSERT INTO `directory` (`First_Name`,`Surname`,`Nicknames`) 
      VALUES (:firstname, :surname, :nicknames) ";

 $statement = $conn->prepare($sql);
 $statement->bindValue(":firstname", $firstname);
 $statement->bindValue(":surname", $surname);
 $statement->bindValue(":nicknames", $nicknames);

 $count = $statement->execute();

  $conn = null;        // Disconnect
}
catch(PDOException $e) {
  echo $e->getMessage();
} 
```

如果我使用（我认为是正确的）将我的数据插入到 1 个表中，但是我的页面没有呈现并且没有源代码输出？任何人都可以看看我在哪里出错了吗？

```
try {
  // Connect and create the PDO object
 $conn = new PDO("mysql:host=$hostdb; dbname=$namedb", $userdb, $passdb);
$conn->exec("SET CHARACTER SET utf8");      // Sets encoding UTF-8
$conn->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);

 $sql = "INSERT INTO `directory`, `nicknames`  (`First_Name`,`Surname`,`Nicknames`) 
      VALUES (:firstname, :surname, :nicknames) ";

 $statement = $conn->prepare($sql);
 $statement->bindValue(":firstname", $firstname);
 $statement->bindValue(":surname", $surname);
 $statement->bindValue(":nicknames", $nicknames);

 $count = $statement->execute();

  $conn = null;        // Disconnect
}
catch(PDOException $e) {
  echo $e->getMessage();
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-27T18:12:57.957

那不是有效的 SQL；你需要分开做。也许：

```
$sql = "
    INSERT INTO `directory`(`First_Name`,`Surname`,`Nicknames`) VALUES (:firstname, :surname, :nicknames);
    INSERT INTO `nicknames`(`First_Name`,`Surname`,`Nicknames`) VALUES (:firstname, :surname, :nicknames);
"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T18:13:31.700

据我所知，您不能使用一个 mySQL 查询插入 2 个表。相反，您应该使用两个不同的查询。

*附录* 在我职业生涯的后期查看这个答案，我有两个补充：

1.  您可能可以使用子查询进行两次插入，但您不应该这样做。您应该使用单独的查询和事务。交易很重要，更多的开发者应该使用它们。

2.  看看 OP 试图完成什么，这可能是一个最好在存储过程中完成的操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T18:14:03.087

问题出在 SQL 上，我认为它不是有效的语法。我认为在这种情况下您需要进行交易。

# c# - c# 将两个数组分层

> ID：14059177
> 
> 赞同：0
> 
> 时间：2012-12-27T18:10:39.027
> 
> 标签：c#, arrays, console, layer

我正在尝试创建一种“你击沉了我的战舰”游戏。到目前为止，我有两个阵列： 1\. 棋盘（Table）——要在上面玩的表面 2\. 船（Avion）——在这种情况下是一架飞机

我想要实现的是创建一个包含整个表面并将平原放在其中的第三个数组。

所以我有飞机：

```
0 0 1 0 0
1 1 1 1 1
0 0 1 0 0
0 0 1 0 0
0 1 1 1 0 
```

和表面：

```
 1 2 3 4 5 6 7 8 8 10
A 0 0 0 0 0 0 0 0 0 0
B 0 0 0 0 0 0 0 0 0 0
C 0 0 0 0 0 0 0 0 0 0
D 0 0 0 0 0 0 0 0 0 0
E 0 0 0 0 0 0 0 0 0 0
F 0 0 0 0 0 0 0 0 0 0
G 0 0 0 0 0 0 0 0 0 0
H 0 0 0 0 0 0 0 0 0 0
I 0 0 0 0 0 0 0 0 0 0
J 0 0 0 0 0 0 0 0 0 0 
```

我想要实现的是：

```
 1 2 3 4 5 6 7 8 8 10
A 0 0 1 0 0 0 0 0 0 0
B 1 1 1 1 1 0 0 0 0 0
C 0 0 1 0 0 0 0 0 0 0
D 0 0 1 0 0 0 0 0 0 0
E 0 1 1 1 0 0 0 0 0 0
F 0 0 0 0 0 0 0 0 0 0
G 0 0 0 0 0 0 0 0 0 0
H 0 0 0 0 0 0 0 0 0 0
I 0 0 0 0 0 0 0 0 0 0
J 0 0 0 0 0 0 0 0 0 0

int counterAvion = 0;
        int counterTable = 0;

        int[,] Table = new int[10, 10];
        int[,] Avion = new int[5, 5];
        int[,] Combined = new int[10, 10];

        // Table[][]
        //rowA
        Table[0, 0] = 0; Table[0, 1] = 0; Table[0, 2] = 0; Table[0, 3] = 0; Table[0, 4] = 0;
        Table[0, 5] = 0; Table[0, 6] = 0; Table[0, 7] = 0; Table[0, 8] = 0; Table[0, 9] = 0;
        //rowB
        Table[1, 0] = 0; Table[1, 1] = 0; Table[1, 2] = 0; Table[1, 3] = 0; Table[1, 4] = 0;
        Table[1, 5] = 0; Table[1, 6] = 0; Table[1, 7] = 0; Table[1, 8] = 0; Table[1, 9] = 0;
        //rowC
        Table[2, 0] = 0; Table[2, 1] = 0; Table[2, 2] = 0; Table[2, 3] = 0; Table[2, 4] = 0;
        Table[2, 5] = 0; Table[2, 6] = 0; Table[2, 7] = 0; Table[2, 8] = 0; Table[2, 9] = 0;
        //rowD
        Table[3, 0] = 0; Table[3, 1] = 0; Table[3, 2] = 0; Table[3, 3] = 0; Table[3, 4] = 0;
        Table[3, 5] = 0; Table[3, 6] = 0; Table[3, 7] = 0; Table[3, 8] = 0; Table[3, 9] = 0;
        //rowE
        Table[4, 0] = 0; Table[4, 1] = 0; Table[4, 2] = 0; Table[4, 3] = 0; Table[4, 4] = 0;
        Table[4, 5] = 0; Table[4, 6] = 0; Table[4, 7] = 0; Table[4, 8] = 0; Table[4, 9] = 0;
        //rowF
        Table[5, 0] = 0; Table[5, 1] = 0; Table[5, 2] = 0; Table[5, 3] = 0; Table[5, 4] = 0;
        Table[5, 5] = 0; Table[5, 6] = 0; Table[5, 7] = 0; Table[5, 8] = 0; Table[5, 9] = 0;
        //rowG
        Table[6, 0] = 0; Table[6, 1] = 0; Table[6, 2] = 0; Table[6, 3] = 0; Table[6, 4] = 0;
        Table[6, 5] = 0; Table[6, 6] = 0; Table[6, 7] = 0; Table[6, 8] = 0; Table[6, 9] = 0;
        //rowH
        Table[7, 0] = 0; Table[7, 1] = 0; Table[7, 2] = 0; Table[7, 3] = 0; Table[7, 4] = 0;
        Table[7, 5] = 0; Table[7, 6] = 0; Table[7, 7] = 0; Table[7, 8] = 0; Table[7, 9] = 0;
        //rowI
        Table[8, 0] = 0; Table[8, 1] = 0; Table[8, 2] = 0; Table[8, 3] = 0; Table[8, 4] = 0;
        Table[8, 5] = 0; Table[8, 6] = 0; Table[8, 7] = 0; Table[8, 8] = 0; Table[8, 9] = 0;
        //rowJ
        Table[9, 0] = 0; Table[9, 1] = 0; Table[9, 2] = 0; Table[9, 3] = 0; Table[9, 4] = 0;
        Table[9, 5] = 0; Table[9, 6] = 0; Table[9, 7] = 0; Table[9, 8] = 0; Table[9, 9] = 0;

        // Avion[][]
        //head
        Avion[0, 0] = 0; Avion[0, 1] = 0; Avion[0, 2] = 1; Avion[0, 3] = 0; Avion[0, 4] = 0;
        //wings
        Avion[1, 0] = 1; Avion[1, 1] = 1; Avion[1, 2] = 1; Avion[1, 3] = 1; Avion[1, 4] = 1;
        //mid_1
        Avion[2, 0] = 0; Avion[2, 1] = 0; Avion[2, 2] = 1; Avion[2, 3] = 0; Avion[2, 4] = 0;
        //mid_2
        Avion[3, 0] = 0; Avion[3, 1] = 0; Avion[3, 2] = 1; Avion[3, 3] = 0; Avion[3, 4] = 0;
        //tail
        Avion[4, 0] = 0; Avion[4, 1] = 1; Avion[4, 2] = 1; Avion[4, 3] = 1; Avion[4, 4] = 0;

        // Output Avion[][]
        Console.WriteLine("\nAirplane:\n");
        foreach (var item in Avion)
        {
            counterAvion++;
            Console.Write(item.ToString() + "  ");
            if (counterAvion == 5)
            {
                Console.WriteLine("\n");
                counterAvion = 0;
            }
        }

        // Output Table[][]
        Console.WriteLine("\nTable:\n");
        Console.WriteLine("  1  2  3  4  5  6  7  8  9  10\n");
        int counterColumn = 1;
        foreach (var item in Table)
        {
            counterTable++;
            //Console.WriteLine(counterColumn);
            switch (counterColumn)
            {
                case 1:
                    Console.Write("A ");
                    break;
                case 12:
                    Console.Write("B ");
                    break;
                case 23:
                    Console.Write("C ");
                    break;
                case 34:
                    Console.Write("D ");
                    break;
                case 45:
                    Console.Write("E ");
                    break;
                case 56:
                    Console.Write("F ");
                    break;
                case 67:
                    Console.Write("G ");
                    break;
                case 78:
                    Console.Write("H ");
                    break;
                case 89:
                    Console.Write("I ");
                    break;
                case 100:
                    Console.Write("J ");
                    break;
                default:
                    break;
            }

            Console.Write(item.ToString() + "  ");
            if (counterTable == 10)
            {
                Console.WriteLine("\n");
                counterTable = 0;
                counterColumn++;
            }
            counterColumn++;
        }
Console.ReadLine(); 
```

我是 C# 的新手，到目前为止我很喜欢它，但它.. 嗯.. 与我很久以前玩的 BorlandC 不同。

那么，关于如何实现这一目标的任何想法？

我也知道到目前为止我的代码有点混乱，因此对此的任何输入表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T18:21:37.763

复制这些值并不是特别难。如果要创建第三个数组，则可以在开始时创建第一个数组的直接副本，然后对其进行修改。

```
public void Combine(int[,] first, int[,] second, int rowStart, int colStart)
{
    //TODO validate parameters, ensure arrays are all large enough, etc.

    for (int i = 0; i < second.GetLength(0); i++)
    {
        for (int j = 0; j < second.GetLength(1); j++)
        {
            first[colStart + i, rowStart + j] |= second[i, j];
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T18:16:39.577

假设 Airplane 的尺寸永远不会大于表面，您可以遍历 Airplane 并为每个索引将表面设置为相同的值。

```
for(int i = 0; i < Airplane.length(0); i++){
    for(int j = 0; j < Airplane.length(1); j++){         
        surface[i,j] = Airplane[i,j] 
```

如果不是，您可以轻松计算出偏移量。

# magento - 下订单后获取部分金额

> ID：14059179
> 
> 赞同：2
> 
> 时间：2012-12-27T18:10:53.727
> 
> 标签：magento, magento-1.7, invoice

我在 Magento 管理员中创建了一个链接来为单个产品创建发票，但是在调用该函数`$order->prepareInvoice($qtys)`时，即使我只传递一个项目，它也会将所有产品添加到发票中。

我正在使用下面的代码。

```
$order = Mage::getModel('sales/order')->load($this->getRequest()->getParam('order_id'));

$count = $order->getTotalItemCount();

$qtys = Array
    (
        [370] => 1
    );

$invoice = $order->prepareInvoice($qtys);
if (!$invoice->getTotalQty()) {
    Mage::throwException(Mage::helper('core')->__('Cannot create an invoice without products.'));
}

$amount = $invoice->getGrandTotal();
$invoice->register()->pay();
$invoice->getOrder()->setIsInProcess(true);
$history = $invoice->getOrder()->addStatusHistoryComment('Partial amount of $'. $amount .' captured automatically.', false);
$history->setIsCustomerNotified(true);
$order->save();
Mage::getModel('core/resource_transaction')
            ->addObject($invoice)
            ->addObject($invoice->getOrder())
            ->save();
$invoice->save(); 
```

![在此处输入图像描述](../Images/9dcf5ce9f0176b92d8341c50654fa777.png)

有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-04T14:48:21.603

在 Mage_Sales_Model_Service_Order::prepareInvoice 中找到的逻辑，您最终调用以准备发票的方法，揭示了这里的作用。采用以下循环，内部 else-if 块是传入 qtys 数组时设置 qty 的位置：

```
foreach ($this->_order->getAllItems() as $orderItem) {
    if (!$this->_canInvoiceItem($orderItem, array())) {
        continue;
    }
    $item = $this->_convertor->itemToInvoiceItem($orderItem);
    if ($orderItem->isDummy()) {
        $qty = $orderItem->getQtyOrdered() ? $orderItem->getQtyOrdered() : 1;
    } else if (!empty($qtys)) {
        if (isset($qtys[$orderItem->getId()])) {
            $qty = (float) $qtys[$orderItem->getId()];
        }
    } else {
        $qty = $orderItem->getQtyToInvoice();
    }
    $totalQty += $qty;
    $item->setQty($qty);
    $invoice->addItem($item);
} 
```

该`$qtys`变量是您传递给 prepareInvoice 调用的数组。在您的情况下，您只传递了要添加到发票中的项目的索引。根据文档（和上面的循环），这*应该可以*工作，除了一个小问题：上面的循环没有将循环顶部的 $qty 的值重置为 0。从当通过预先存在的表单从管理员创建时处理发票初始化的核心代码，因为正在提交的表单将始终包含订单上每个项目的值，并且在只有 1 个项目开票的情况下，所有其他人将保持 0 数量值，从而解决无法重置 $qty 值的问题。

要解决您的问题，请尝试`$qtys`像这样设置您的变量（我假设 370 和 371 是两个订单项目实体 ID）：

```
$qtys = array(
    370 => 1,
    371 => 0,
); 
```

我可能建议的另一种选择是简单地让您的“创建发票”链接在表单中设置适当的值来为单个项目开具发票，然后直接提交表单。这样，您将依靠已知的工作核心控制器来完成繁重的工作。当然，这只有在您除了为单个项目开票之外没有做任何相当定制的事情时才有效。:)

# directx - 无法编译 nVidia HLSL 示例 - FXC 任务不支持 CommandLineTemplate

> ID：14059183
> 
> 赞同：0
> 
> 时间：2012-12-27T18:11:24.957
> 
> 标签：directx, gpu, nvidia, hlsl, directx-10

我正在尝试从 nVidia 网站编译一个示例来进行可靠的线框渲染：

[http://developer.download.nvidia.com/SDK/10/direct3d/samples.html](http://developer.download.nvidia.com/SDK/10/direct3d/samples.html)

![在此处输入图像描述](../Images/adf323ef458383c58bf74f2a8a927c17.png)

当我在 Visual Studio 2012 中打开 VC++ 项目并进行编译时，我收到以下错误消息：

> 错误 5 错误 MSB4064：“FXC”任务不支持“CommandLineTemplate”参数。验证该参数是否存在于任务中，并且它是一个可设置的公共实例属性。

![在此处输入图像描述](../Images/5028c1f96861fea97116e927e3d01371.png)

我是否缺少框架或 SDK？或者也许需要修改此示例以与 VS2012 一起使用？

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T21:47:29.287

您是否安装了最新的[DX SDK](http://www.microsoft.com/en-us/download/details.aspx?id=6812)？

此外，VS 是否有可能有一个自定义编译操作来运行您缺少的 FXC（着色器编译器）？

如果您可以通过 fxc 找到编译其着色器所需的参数，您可以通过命令提示符运行它，它位于 DX SDK 的 bin 文件夹中。

# php - Yii 制作一个无法保存的模型实例

> ID：14059189
> 
> 赞同：0
> 
> 时间：2012-12-27T18:11:52.113
> 
> 标签：php, yii, yii-cmodel

假设我有一张`Widget`桌子和与之配套的 Yii 模型类。

我希望能够实例化它（`$tempWidget = new Widget`）但以某种方式确保它不能保存到数据库中。我想只为用户使用模型来测试东西，模拟......

显然，我可以避免调用`$tempWidget->save()`，但我想要某种标志，以防止保存保存，以防代码的其他部分尝试这样做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T22:44:53.103

有几种方法可以实现您想要的。最简单的方法是修改 models`beforeSave()`方法，通过使用 method 取消设置所有属性来防止模型能够保存`CModel unsetAttributes`，例如：

```
public function beforeSave(){
    $this->attributes = $this->unsetAttributes();
} 
```

仅当您具有与此模型关联且具有必填字段（至少一个必填字段）的规则时，这才有效，否则这将在您的表中创建一个仅包含主键的条目（假设 PK 是自动递增的）。

# emacs - Hook 覆盖用户定义的 emacs 键绑定

> ID：14059192
> 
> 赞同：2
> 
> 时间：2012-12-27T18:12:00.843
> 
> 标签：emacs, hook

> **可能重复：**
> [全局覆盖 Emacs 中的键绑定](https://stackoverflow.com/questions/683425/globally-override-key-binding-in-emacs)

在我的`.emacs`文件中，我为 control-meta-h 添加了一个键绑定

```
(global-set-key (kbd "C-M-h") 'windmove-left) 
```

只要我不进入 c-mode 或 c++-mode，它就可以正常工作。两者都通过默认行为覆盖它，即`c-mark-function`. 我如何避免我的绑定被 c-mode/c++-mode 钩子覆盖？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T06:04:54.427

可以通过在单独的次要模式中定义键绑定来解决。有关详细信息，请参阅[Emacs 中的全局覆盖键绑定](https://stackoverflow.com/questions/683425/globally-override-key-binding-in-emacs)，其中 scottfrazer 提供了以下解决方案：

```
(defvar my-keys-minor-mode-map (make-keymap) "my-keys-minor-mode keymap.")
(define-key my-keys-minor-mode-map (kbd "C-M-h") 'windmove-left)

(define-minor-mode my-keys-minor-mode
  "A minor mode so that my key settings override annoying major modes."
   t " my-keys" 'my-keys-minor-mode-map)

(my-keys-minor-mode 1) 
```

# c# - Windows 8 后台任务

> ID：14059197
> 
> 赞同：1
> 
> 时间：2012-12-27T18:12:20.147
> 
> 标签：c#, windows-8, background-process

所以我似乎在 Windows 商店应用程序中触发后台任务时遇到了一些问题；我已经按照白皮书教程进行了操作，并查看了 Microsoft 的示例代码，并且我的代码的所有迭代似乎都失败了。Visual Studio 没有给我任何错误后台任务只是没有触发，任务的目的是在有互联网连接时每 70 分钟触发一次。

下面代码的范围是它在自己的名为 Tasks 的项目中，并且清单（不是针对此项目，而是解决方案中的主项目）已正确填充，以便在此类中找到后台任务

```
class BackroundBuilder
{
  public BackroundBuilder()
  {
    this.RegisterTimeTriggerBackgroundTask();
  }

  //this is the code that registers my backround task to run a trigger
  //was added for testing.
  private bool RegisterTimeTriggerBackgroundTask()
  {
    BackgroundTaskBuilder builder = new BackgroundTaskBuilder();
    builder.Name = "Background task test";
    builder.TaskEntryPoint = "PostPage.xmal";
    // Run every 70 minutes if the device has internet connectivity
    IBackgroundTrigger trigger = new TimeTrigger(70, false);
    builder.SetTrigger(trigger);
    IBackgroundCondition condition = new
        SystemCondition(SystemConditionType.InternetAvailable);

    //this is the trigger it's set to fire when internet becomes available            
    IBackgroundTrigger Itrigger = new
        SystemTrigger(SystemTriggerType.InternetAvailable,true);
    builder.SetTrigger(Itrigger);

    builder.AddCondition(condition);
    IBackgroundTaskRegistration task = builder.Register();

    return true;
  }

  public async void Run(IBackgroundTaskInstance taskInstance)
  {
    BackgroundTaskDeferral _deferral = taskInstance.GetDeferral();            

    //WindowsBlogReader.FeedDataSource updateAll = new WindowsBlogReader.FeedDataSource();
    //direct input for the test string is declared below but the updateAll declaration     
    // above is the one that will be used once the test works
    WindowsBlogReader.LiveTileTimeUpdate updateAll = new WindowsBlogReader.LiveTileTimeUpdae();

    //this is the test to see if the background task will fire
    //await was in front of the below statement but im injecting that String into a method
    //that is not setup for async the method being used once this works is an async 
    updateAll.update("Background task fired");
    //this update method adds a String too the list of Sting that's the live tile cycles though 
    _deferral.Complete();
  }     
} 
```

这是清单 xml 代码

```
<Extension Category="windows.backgroundTasks" EntryPoint="Tasks.BackroundBuilder">
  <BackgroundTasks>
    <Task Type="systemEvent" />
    <Task Type="timer" />
  </BackgroundTasks>
</Extension> 
```

任何帮助，将不胜感激。如果此代码信息不足，我可以提供更多信息。应用程序的其他部分没有（已知）问题，因为所有功能都在应用程序运行时工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T22:33:12.587

你需要让你的`BackroundBuilder`类实现[`IBackgroundTask`接口](http://msdn.microsoft.com/library/windows/apps/BR224794)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T22:50:22.337

这是一个错字： `builder.TaskEntryPoint = "PostPage.xmal";`应该是：`builder.TaskEntryPoint = "PostPage.xaml";`？如果 SLaks 的回答似乎无法解决问题，我会指出这一点。

我会将此作为评论输入，但我没有足够的代表来执行此操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-18T18:51:34.927

`TaskEntryPoint`应该是实现`IBackgroundTask`. 例如“BackgroundTasks.MyBackgroundTask”。
这也应该添加到您的清单文件中。打开Package.appxmanifest，进入Declarations 选项卡，添加Background Tasks 声明并用相同的名称填写“Entry point”字段（例如“BackgroundTasks.MyBackgroundTask”）。
此外，您的任务需要位于单独的 Windows 运行时组件项目中，并且该项目中的每个类都必须是`public`和`sealed`.

[这](http://www.jeffblankenburg.com/2012/11/12/31-days-of-windows-8-day-12-background-tasks)是一个快速教程。
可以在[这里](http://msdn.microsoft.com/en-us/library/windows/apps/hh977056.aspx)找到一个广泛的。

# ruby-on-rails-3 - Rails 3：如何制作一个路由助手，根据对象属性或方法生成不同的路由？

> ID：14059198
> 
> 赞同：1
> 
> 时间：2012-12-27T18:12:24.757
> 
> 标签：ruby-on-rails-3, routing, constraints, helper

我正在用 Ruby on Rails 3.1.3 制作一个应用程序。我有不同类型的用户（即管理员、操作员、广告商等），每个用户都有不同的主（或主页）页面。我想制作一个路由助手，通过使用类似`home_path`. 这主要用于在某些操作后重定向（我想根据用户类型重定向回各自的主页）。

我已经有一些可用的方法，例如`current_user`（返回当前登录的用户），`current_user.admin?`（如果当前登录的用户是管理员，则返回 true）`current_user.operator?`，等等。

现在我正在使用一个辅助方法来做到这一点，但这似乎不是一种非常 Rails 的方式来做到这一点。无论如何，代码如下：

```
def home_path(params = {})
    user = current_user
    case user
        when user.admin?
            params = {:controller => 'administrators', :action => 'index'}.merge(params)
        when user.advertiser?
            params = {:controller => 'advertisers', :action => 'show', :id => user.advertiser_id}.merge(params)
        when user.operator?
            params = {:controller => 'callcenter', :action => 'index'}.merge(params)
        else
            params = {:controller => 'posts', :action => 'home'}.merge(params)
    end
    url_for(params)
end 
```

我认为这应该通过受约束的路线来完成，但我仍然不明白如何依赖 , 等方法来`.admin?`完成`.operator?`。对此的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T19:08:01.657

使用辅助方法对此很好。不过，它可能应该最终出现在您的控制器中，而不是视图助手中，这使它可以访问`current_user`. 通过一些清理，你可以用你现在的想法得到一些不错的东西。

```
module DefaultHomeHelper
  DEFAULT_PARAMS = { controller: :posts, action: :home }.freeze
  ROLE_SPECIFIC_PARAMS = {
    admin: { controller: :administrators, action: :index },
    advertiser: { controller: :advertisers, action: :show },
    operator: { controller: :callcenter, :action: :index }
  }.freeze

  def home_path(params = {})
    url_for params.reverse_merge(ROLE_SPECIFIC_PARAMS[current_user.role] || DEFAULT_PARAMS)
  end
end 
```

我假设您可以更直接，并要求您的 User 对象只告诉您它的角色，而不是一个接一个地猜测。您几乎肯定需要调整代码以适应您对用户的调用。我还使用了较新的哈希语法，但如果您正在运行或适应 Ruby < 1.9，则需要更新。我也为动作和控制器名称使用了符号，因为我喜欢用符号而不是字符串来引用对象和方法（控制器和动作是对象和方法）。

你可以做一个简单`include DefaultHomeHelper`的`ApplicationController`来使用它。您还可以使用`helper_method :home_path`.

# php - 检查是否从正确的页面调用表单

> ID：14059199
> 
> 赞同：0
> 
> 时间：2012-12-27T18:12:28.423
> 
> 标签：php, forms

在 page1.php 上，我有一个通过 POST 将变量发送到 page2.php 的表单。但是，我只想处理从 page1.php 调用的表单。

我该如何检查？

亲切的问候！

编辑：这是一种安全措施。如果我是一名黑客并且我从页面源复制表单代码并运行它，我可以更改关键变量。

**EDIT2：**
好的，这是实际问题：
用户可以编辑他们帐户的信用。他们可以选择从 5EUR 到 50EUR 的值。
最终他们来到一个页面'deposit.php'，最终表单被发送到页面'payments.php'，然后将var发送到Paypal。

存款.php：

```
<form class="paypal" action="paypal/payments.php" method="post" id="paypal_form" target="_blank">    
<input type="hidden" name="cmd" value="_xclick" /> 
<input type="hidden" name="no_note" value="1" />
<input type="hidden" name="lc" value="BE" />
<input type="hidden" name="currency_code" value="EUR" />
<input type="hidden" name="bn" value="PP-BuyNowBF:btn_buynow_LG.gif:NonHostedGuest" />
<input type="hidden" name="item_number" value="50" / >
<input type="hidden" name="price" value="47.50" / >
<input type="submit" class="uibutton " value="Betaal met Paypal" style="width: 100%; font-size:120%;"> 
```

（顺便说一句，如果他们加 50 欧元，他们会得到折扣）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T18:28:35.360

嗯，首先你必须明白，没有你所说的**安全措施。**当然，**其他参与者提供的任何方法都无法保护您的“关键变量”**。他们实际上是在回答另一个问题，一个他们更熟悉的问题。

表格旨在由客户方填写。因此，您不能期望任何变量都不会受到影响。无论您采取什么措施，来自客户端的**所有内容都可能被欺骗。**

因此，任何“关键变量”都应该**保留在服务器上。**
虽然来自表单的所有数据都应被视为不安全并进行相应处理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T18:20:40.143

根据应用程序，您可以使用`$_SERVER['HTTP_REFERER']`并进行检查，但问题是并非所有浏览器都发送它，并且用户可以修改它。因此，如果这仅适用于您认识的少数人，那可能不会有问题。如果这是针对世界的，则不推荐。

我通常做的是在第 1 页设置会话，然后在第 2 页检查该会话。每次第 1 页加载时，您都需要重置会话。

**page1.php**

```
<?php
session_start();
$hash = $_SESSION['hash'] = md5(time().rand(0,100));
?>
<form action="page2.php" meethod="post">
    <input type="hidden" name="h" value="<?php echo $hash; ?>" />
    Your Name: <input type="text" name="name" />
</form> 
```

**page2.php**

```
<?php
session_start();
if($_SESSION['hash'] != $_POST['h']){
    header("Location: page1.php");
    exit;
}

// process data 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T18:21:02.553

我认为*亚当 D*的反应太弱了（任何人都可以使用萤火虫来改变）。您要防止的是用户跳过某些步骤或避免[XSRF](http://en.wikipedia.org/wiki/Cross-site_request_forgery)。

在那种情况下，我会说使用[会话](http://php.net/manual/en/features.sessions.php)。

*   创建会话
*   保存当前步骤
*   检索并验证当前步骤并根据该值暂停或继续

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-12-27T18:17:03.393

在您的表单中，包含一个隐藏字段，然后您会在 上进行检查`page2.php`。见下文：

```
<form action="post.php" method="POST">
  <input type="text" name="fname" id="fname" />
  <input type="hidden" name="cameFromPageOne" value="true" />
</form> 
```

然后，在顶部`page2.php`，检查是否设置了隐藏变量，如果没有，则重定向回`page1.php`

```
<?php

if(!isset($_POST['cameFromPageOne']) || $_POST['cameFromPageOne'] != 'true') {
  header('location: http://www.example.com/page1.php');
  exit();
} else {
    // ... code to process if they DID come from page1.php
}

?> 
```

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2012-12-27T18:22:40.037

没有理由让它过于复杂，PHP 中有一个全局变量，它告诉你当前脚本的请求地址：

```
echo $_SERVER["HTTP_REFERER"]; 
```

# r - 在逻辑回归中输入整个数据框作为自变量

> ID：14059200
> 
> 赞同：0
> 
> 时间：2012-12-27T18:12:29.540
> 
> 标签：r, dataframe, regression

> **可能重复：**
> [构建模型时需要许多变量的简短公式](https://stackoverflow.com/questions/5774813/short-formula-call-for-many-variables-when-building-a-model)

我有一个很大的数据框（112 个变量），我想对使用 R 进行逐步逻辑回归。我知道如何设置`glm`模型和`stepAIC`模型，但我不想输入所有标题来输入自变量。有没有一种快速的方法可以为`glm`模型提供一个完整的数据框作为自变量，以便它将每一列识别为要包含在模型中的 x 变量？我试过：

```
ft<-glm(MFDUdep~MFDUind, family=binomial) 
```

但它不起作用（错误的数据类型）。MFDUdep 和 MFDUind 都是数据帧，`MFDUind`包含 111 个“x”变量和`MFDUdep`一个“y”。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-27T18:21:07.750

您需要`.`公式符号中的特殊符号。此外，将响应和预测变量放在单个数据框中可能会更好。

尝试：

```
MFDU <- cbind(MFDUdep, MFDUind)
ft <- glm(y ~ ., data = MFDU, family = binomial) 
```

既然我已经给了你绳子，我有义务至少警告你可能会被吊死……

您采用的方法通常不是推荐的方法，除非模型的目的可能是预测。所选变量的回归系数可能有很大的偏差，因此如果您将其用于启发，请重新考虑您的方法。

您还需要大量观察才能在模型中允许 100 多个术语。

存在更好的替代方案；例如，请参阅**glmnet**包中的一种方法，该方法允许对一组系数进行脊、套索或两者（弹性网络）约束，这允许以少量额外偏差为代价来最小化模型误差。

# javascript - 为什么 Firebug 说 toFixed() 不是函数？

> ID：14059201
> 
> 赞同：109
> 
> 时间：2012-12-27T18:12:31.903
> 
> 标签：javascript

我正在使用 jQuery 1.7.2 和 jQuery UI 1.9.1。我在滑块中使用下面的代码。(http://jqueryui.com/slider/)

我有一个函数应该测试两个值，并根据两个值之间的差异重新格式化它们（到适当的小数位）。如果差值大于 10，我将解析出整数。如果差值大于 5，则应保留一位小数。其他一切，我将保留两位小数。

当我输入两个相差小于等于 10 的值时，我使用 toFixed() 函数。而且，在 Firebug 中，我看到一个错误：

```
TypeError: Low.toFixed is not a function
Low = Low.toFixed(2); 
```

有什么简单的我做错了吗？

这是我的代码：

```
var Low = $SliderValFrom.val(),
High = $SliderValTo.val();

// THE NUMBER IS VALID
if (isNaN(Low) == false && isNaN(High) == false) {
    Diff = High - Low;
if (Diff > 10) {
      Low = parseInt(Low);  
  High = parseInt(High);    
} else if (Diff > 5) {
       Low = Low.toFixed(1);
       High = High.toFixed(1);
} else {
       Low = Low.toFixed(2);
   High = High.toFixed(2);
}
} 
```

* * *

## 回答 #1

> 赞同：197
> 
> 时间：2012-12-27T18:13:53.500

`toFixed`不是非数值变量类型的方法。换句话说，`Low`并且`High`无法修复，因为当您在 Javascript 中获取某物的值时，它会自动设置为字符串类型。使用`parseFloat()`（或`parseInt()`使用基数，如果它是整数）将允许您将不同的变量类型转换为数字，这将使`toFixed()`函数能够工作。

```
var Low  = parseFloat($SliderValFrom.val()),
    High = parseFloat($SliderValTo.val()); 
```

* * *

## 回答 #2

> 赞同：103
> 
> 时间：2012-12-27T18:13:52.233

那是因为`Low`是一个字符串。

`.toFixed()`仅适用于数字。

* * *

尝试做：

```
Low = parseFloat(Low).toFixed(..); 
```

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2016-11-22T20:47:47.997

`Low`是一个字符串。

`.toFixed()`仅适用于数字。

克服此类问题的一种简单方法是使用[类型强制](https://medium.freecodecamp.org/js-type-coercion-explained-27ba3d9a2839)：

```
Low = (Low*1).toFixed(..); 
```

乘以 1 会强制代码将字符串转换为数字并且不会更改值。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2019-10-29T08:55:47.157

您需要转换为数字类型：

```
(+Low).toFixed(2) 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2021-06-01T19:56:26.937

`parseFloat()`将返回`NaN`空字符串，为什么不使用`Number()`函数呢？

其他类型的值可以使用该`Number()`函数转换为数字。

```
parseFloat('').toFixed(2) // "NaN"
Number('').toFixed(2) // "0.00" 
```

[https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-01-15T19:22:26.207

在函数中，用作

```
render: function (args) {
    if (args.value != 0)
        return (parseFloat(args.value).toFixed(2));

}, 
```

# visual-studio-2010 - 用于非 MFC 应用程序的 Visual Studio 2012 资源编辑器

> ID：14059211
> 
> 赞同：0
> 
> 时间：2012-12-27T18:13:21.887
> 
> 标签：visual-studio-2010, visual-studio, visual-c++, mfc, visual-studio-2012

Visual Studio 资源编辑器无疑包含一组有价值的工具，这些工具有助于为 MFC 应用程序创建 UI，尤其是各种对话框和图形元素。

我有理由继续使用非托管 C++，这意味着不使用 Windows 窗体。因此，我有了一个想法，如果可以在创建非 MFC 应用程序时**在非托管 C++ 中使用 VS2012 资源编辑器创建的资源。**

*   如何从我的非托管 C++ 代码中引用 GUI 元素？
*   我可以完全放弃 MFC 结构并使用我自己的 C++ 设计吗？
*   你知道任何涵盖这个的好教程吗？我在网上搜索并尝试了 YouTube，但我没有找到涵盖此问题的合适示例。

*我用：*

*   Visual Studio 2012 终极版
*   视窗 7 x64
*   非托管 C++

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T18:35:42.920

MFC 本质上是围绕 WinAPI 的包装器，因此可以在没有 MFC 的情况下完全使用此类资源文件。在设计/编译时：

1.  拖放资源以创建`.rc`文件
2.  包含生成的头文件 -`#include "resource.h"`

在运行时：

1.  在您的代码中，确保调用`InitCommonControlsEx`
2.  使用 WinAPI 调用（例如 、 等）加载`DialogBox`资源`CreateDialog`。

# java - 为什么我在 Windows 中将 \r\r\n 作为换行符而不是 \r\n 作为换行符

> ID：14059212
> 
> 赞同：1
> 
> 时间：2012-12-27T18:13:24.807
> 
> 标签：java, readfile

我有下面的 readfile() java 函数来读取 .htm 文件

```
private String readfile(String inputDoc) throws IOException {
    FileInputStream fis = null;
    InputStreamReader isr = null;
    String text = null;
    //open input stream to file
    fis = new FileInputStream(inputDoc);
    isr = new InputStreamReader(fis, "UTF-8");
    StringBuffer buffer = new StringBuffer();
    int c;
    while( (c = isr.read()) != -1 ) {
        buffer.append((char)c);
    }
    text = buffer.toString();
    isr.close();
    return text;
} 
```

这是输入文档的示例片段

```
<?xml version="1.0" encoding="utf-8"?><html>

<head> 
```

由于某种原因，从 readfile() 返回的文本字符串是`<?xml version="1.0" encoding="utf-8"?><html>\r\r\n<head>`

**但我希望它是** `<?xml version="1.0" encoding="utf-8"?><html>\r\n<head>`

正如[这里](http://en.wikipedia.org/wiki/Newline#Representations)概述的那样，windows 中的换行符 \r\n

我在 Windows 7 上的 IntelliJ Idea 中运行了上述函数。（IDEA 默认编码设置为 UTF-8）

有谁知道为什么我从换行的 readfile(String inputDoc) 函数中得到这个奇怪的结果

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-27T18:21:31.950

当您编写 时`\n`，它会扩展到`\r\n`Windows 上以实现可移植性。这样，无论您在什么操作系统上运行它，您都可以获得正确的结果，而无需额外的代码：`\r\n`在 Windows 上或仅`\n`在 Unix 上。看起来您正在以二进制模式读取输入（在文本模式下，反向发生相同的扩展：`\r\n`输入中的 any 变为 just `\n`，因此您再次不必担心操作系统），所以您会看到`\r`. 然后，当您编写 时`\n`，它会扩展为`\r\n`，留下两个`\r`s。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-27T18:17:44.667

你得到这个是因为它在输入文件中是这样的。尝试在十六进制编辑器中打开输入文件进行验证。

# raytracing - 光线追踪器的材料属性列表

> ID：14059226
> 
> 赞同：29
> 
> 时间：2012-12-27T18:14:18.160
> 
> 标签：raytracing

我为上个学期的一项作业写了一个 Ray Tracer，并希望继续努力。任务中有 5 种材质（用于对象），我们获得了它们的环境、漫反射、镜面反射和光泽值。我很难找到这些值的列表来在线创建新材料（还包括折射率的材料会很棒），并且想知道是否有人知道这方面的好资源。

这是迄今为止我发现的最好的，但它没有那么多材料，并且具有折射率的材料没有我上面提到的其他值：http: [//www.nicoptere.net/dump/材料.html](http://www.nicoptere.net/dump/materials.html)

我从来没有为 Ray Tracer 做过折射（计划学习它是为了好玩），欢迎任何一般性的建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-04-21T19:11:47.623

使用其他开源光线追踪器作为资源，例如[POV-Ray](http://www.povray.org/)。[`distribution/include`您可以在Path](https://github.com/POV-Ray/povray/tree/master/distribution/include)中找到材质的定义。

`metals.inc`来自（放在一起）的一个例子：

```
#declare P_Brass1    = color rgb <0.30, 0.20, 0.10>;

#declare F_MetalA  =
finish {
    ambient 0.35
    brilliance 2
    diffuse 0.3
    metallic
    specular 0.80
    roughness 1/20
    reflection 0.1
}

#declare T_Brass_1A = texture { pigment { P_Brass1 } finish { F_MetalA  } } 
```

# c# - 外键映射到实体框架中的复合键

> ID：14059231
> 
> 赞同：8
> 
> 时间：2012-12-27T18:14:33.107
> 
> 标签：c#, entity-framework, ef-code-first

尝试首先与实体框架代码建立以下关系。以下代码不起作用我尝试了很多变体......有人知道吗？

```
CONSTRAINT [FK_EVENT_Contact] FOREIGN KEY (Patient_ID,[Contact_ID]) REFERENCES
[PatientContact](Patient_ID,Person_ID)

public class PatientContact
{
    [Key, Column(Order = 0)]
    [DatabaseGenerated(DatabaseGeneratedOption.None)]
    public int Person_ID { get; set; }
    public virtual Person Person { get; set; }

    [Key, Column(Order = 1)]
    [DatabaseGenerated(DatabaseGeneratedOption.None)]
    public int Patient_ID { get; set; }
    public virtual Patient Patient { get; set; }
}

public class Event
{
    [Key]
    public int Event_ID { get; set; }

    [Required]
    public int EventType_ID {get;set;}
    public virtual EventType EventType { get; set; }

    [ForeignKey("Patient")]
    public int Patient_ID { get; set; }
    public virtual Patient Patient { get; set; }

    [ForeignKey("PatientContact")]
    public int Contact_ID { get; set; }
    public virtual PatientContact PatientContact { get; set; }

} 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-12-27T23:14:52.510

您在这里有 2 个选项。

使用您所拥有的属性，例如：

```
[ForeignKey("PatientContact"), Column(Order = 0)]
public int Person_ID{ get; set; }
[ForeignKey("PatientContact"), Column(Order = 1)]
public int Patient_ID{ get; set; }
public virtual PatientContact PatientContact { get; set; } 
```

使用模型构建器（fluent api）

```
modelBuilder.Entity<Event>()
    .HasRequired(p => p.PatientContact)
    .WithMany()
    .HasForeignKey(p => new {p.Person_ID, p.Patient_ID}); 
```

# .net - 如何使用 WinDbg 在实例上查找自定义属性

> ID：14059232
> 
> 赞同：3
> 
> 时间：2012-12-27T18:14:33.170
> 
> 标签：.net, clr, windbg, sos, sosex

使用 windbg，有没有办法查看在实例上定义的所有自定义属性？（在班级级别）
如果可能的话，我可以在自定义属性中看到字段值吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T20:26:24.567

实际上，您可以通过反射看到新发出的属性。您可以使用 IMetaDataEmit::DefineCustomAttribute 像您一样发出新属性，然后通过反射检查它们的存在。我使用该技术来分析我的单元测试并成功检查了我的属性是否已发出（在程序集和类型级别）。我猜微软修复了你提到的错误（如果有的话）。

# python - 连接字符串然后打印

> ID：14059237
> 
> 赞同：5
> 
> 时间：2012-12-27T18:15:00.577
> 
> 标签：python, string, string-concatenation

```
print ("Tag Value " + i.tags.get('Name')) 
```

给我：

```
 File "./boto_test.py", line 19, in main
    print ("Tag Value" + i.tags.get('Name'))
TypeError: cannot concatenate 'str' and 'NoneType' objects 
```

这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-27T18:35:01.703

或者只是将您`get`的任何内容转换`i.tags`为字符串：

```
print ("Tag Value " + str(i.tags.get('Name'))) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T18:17:09.347

`i.tags`不包含`'Name'`密钥。结果应该是`None`什么？只需将其作为第二个参数传递给`get`：

```
print ("Tag Value " + i.tags.get('Name', 'None')) 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2017-07-11T17:30:19.560

尝试通过`str()`函数将其转换为字符串数据类型。对同一行使用以下代码：

```
print ("Tag Value" + str(i.tags.get('Name'))) 
```

# symfony - 我应该如何为 Symfony 2 实现 runonce 脚本？

> ID：14059239
> 
> 赞同：0
> 
> 时间：2012-12-27T18:15:29.613
> 
> 标签：symfony, command-line-interface

我使用 Scrum 方法并在每个 sprint 的构建中部署功能。

有必要对存储的数据（我的意思是数据库和文件系统中的数据）执行不同的更改。我想将它实现为从控制台调用的 PHP 脚本。但它们应该只在部署期间执行一次。

有没有办法实现它`app/console`而不在注册的控制台命令列表中列出它？或者有没有其他方法来实现 runonce 脚本？

DoctrineMigrations 涵盖了我的部分需求，但是很难在 Model.xml 中实现复杂的更改。它不包括文件系统上文件的更改。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T22:36:11.613

我不认为 symfony 有这样的功能，此外，隐藏命令与保护命令不同。

相反，我会让脚本确定它是否已经运行（可能就像向文件添加版本号并在运行前检查该数字一样简单），如果它检测到它之前已经运行过，则停止。

# c# - 防止桌面应用程序上的多个相同用户登录

> ID：14059240
> 
> 赞同：3
> 
> 时间：2012-12-27T18:15:43.247
> 
> 标签：c#, mysql, vb.net, login, desktop-application

我正在开发一个多用户桌面应用程序。我需要想办法让每个用户名一次只允许一个用户登录。基本上，John 无法从 PC-A 登录应用程序，然后运行到 PC-B 并登录。我的想法是设置一个位标志，指示用户已登录，并且当从另一个位置进行尝试时，它会通知用户当前用户名已经登录。这将重复直到约翰PC-A 要么退出系统，要么手动注销。唯一的问题是如果应用程序崩溃，则不会调用注销方法。建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T18:19:33.367

如果您不能依赖优雅地退出应用程序或至少捕获所有异常并适当处理，我认为唯一的选择是使用会话方法。基本上，当每个用户登录时，都会建立一个新会话，并且该会话 id 将针对任何未来的调用进行验证。

通过这样做，您可以允许用户在尝试登录其他地方时终止现有/打开的会话。如果他们尝试从 PC B 登录并且已经从 PC A 登录 - 您只需将其放在提示符中，如果他们选择从 PC B 继续，PC A 上的会话将被停用。即使有人在 PC A 上积极使用该应用程序，他们发出的下一个服务调用也应在会话关闭时被拒绝。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T18:19:30.050

查看 MySQL 的[GET_LOCK()](http://dev.mysql.com/doc/refman/5.5/en/miscellaneous-functions.html#function_get-lock)和[RELEASE_LOCK()](http://dev.mysql.com/doc/refman/5.5/en/miscellaneous-functions.html#function_release-lock)函数。

# java - 当我不想覆盖文本文件时。- 爪哇

> ID：14059242
> 
> 赞同：-2
> 
> 时间：2012-12-27T18:15:50.230
> 
> 标签：java, text-files, filewriter

我正在处理一个当前每次都覆盖自身的日志文件。现在我想做的就是写在第一行并附加下面的列表以显示从最新到最旧的历史记录。问题是我不确定如何去做我正在查看代码但不知道我做错了什么。这是不确定我是否遗漏了什么的代码。

```
 String historylog = new Date().toString();

    BufferedWriter bw = null;

    String filepath = "C:\netbeans\Source code\test3";
    String filename = "PatchHistory.log";

    try
    {
        if (!(new File( filepath).exists()))
            (new File( filepath)).mkdirs();
        bw = new BufferedWriter( new FileWriter( filepath + File.separator
       + filename, true));

        bw.write( historylog + "\r\n");
        bw.newLine();
        bw.flush();
        bw.close();
        return true;
    }

    catch (IOException){

    return false;
    } 
```

任何帮助将不胜感激，不确定我在做什么错。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T18:20:43.567

如果我理解你的话，你想在日志文件的开头添加日志条目。

AFAIK，（如果您知道任何例外情况，请告诉我）所有文件系统都将数据添加到文件末尾。直接访问会覆盖文件的开头。

您最好的选择是将日志写入不同的文件，并在写入您想要的内容之后，然后写入原始日志文件的内容。完成后，关闭这两个文件并用新文件覆盖旧文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T18:18:43.633

**在您的代码中**

你错了，你没有`if`正确使用语句。

```
 if (!(new File( filepath).exists()))
        (new File( filepath)).mkdirs(); // file path not exist, then it will execute
    bw = new BufferedWriter( new FileWriter( filepath + File.separator + filename, true)); // this append file will always execute 
```

**解决方案**

```
if (!(f.exists())) {
//create new file
bw = new BufferedWriter(new FileWriter(filepath + File.separator + filename, false));
}
else{
//append in existing file
bw = new BufferedWriter(new FileWriter(filepath + File.separator + filename,true));
} 
```

# yii - Yii 框架中的缓存

> ID：14059248
> 
> 赞同：0
> 
> 时间：2012-12-27T18:16:09.893
> 
> 标签：yii

对于使用 api 缓存用于下拉列表的国家/地区列表，在 Yii 框架中哪种方式最好或者哪种缓存最好？我们什么时候可以在缓存中缓存这个国家列表？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-05T11:48:39.873

我将为您提供一些链接来帮助您，以及一个示例。首先，您应该查看 [http://www.yiiframework.com/doc/guide/1.1/en/caching.data](http://www.yiiframework.com/doc/guide/1.1/en/caching.data)以了解 yii 中的缓存。

我正在使用 APC 缓存，其中涉及安装 APC PHP 扩展，并配置您的 config/main.php 此处有一篇关于如何执行此操作的文章：[http ://www.yiiframework.com/wiki/312/getting-the -yii 最不适合的 apc/](http://www.yiiframework.com/wiki/312/getting-the-most-out-of-apc-for-yii/)

接下来，为了缓存国家/地区列表，您可以执行以下操作

```
$tableName  =  CountryName::model()->tableName();
$dependencySql ='select max('.$tableName.'.update_time)  from '.$tableName;

$dependency = new CDbCacheDependency($dependencySql);

$myModelSql= 'select name from '. $tablename;

$allCountries= CountryName::model()->cache(1000, $dependency)->findAllBySql($myModelSql); 
```

如果 $allCountries 在过去 1000 秒内没有更新，Yii 将从缓存中检索而不是访问数据库。

希望这可以帮助

# php - IMDB Api，仅检索标题和情节。

> ID：14059249
> 
> 赞同：1
> 
> 时间：2012-12-27T18:16:13.017
> 
> 标签：php, api, imdb

我找到了这个提供 IMDB API 的网站： [http ://www.omdbapi.com](http://www.omdbapi.com)

并且例如获得霍比特人，这很容易： [http ://www.omdbapi.com/?i=tt0903624](http://www.omdbapi.com/?i=tt0903624)

然后我得到所有这些信息：

```
{"Title":"The Hobbit: An Unexpected Journey","Year":"2012","Rated":"11","Released":"14 Dec 2012","Runtime":"2 h 46 min","Genre":"Adventure, Fantasy","Director":"Peter Jackson","Writer":"Fran Walsh, Philippa Boyens","Actors":"Martin Freeman, Ian McKellen, Richard Armitage, Andy Serkis","Plot":"A curious Hobbit, Bilbo Baggins, journeys to the Lonely Mountain with a vigorous group of Dwarves to reclaim a treasure stolen from them by the dragon Smaug.","Poster":"http://ia.media-imdb.com/images/M/MV5BMTkzMTUwMDAyMl5BMl5BanBnXkFtZTcwMDIwMTQ1OA@@._V1_SX300.jpg","imdbRating":"9.2","imdbVotes":"5,666","imdbID":"tt0903624","Response":"True"} 
```

问题是我只想要例如标题，年份和情节信息，我想知道我如何才能检索到这些信息。

我想使用 PHP。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-27T18:21:50.477

给你...简单地解码 json，然后提取你需要的数据。如果需要，您可以在之后将其重新编码为 json。

```
$data = file_get_contents('http://www.omdbapi.com/?i=tt0903624');
$data = json_decode($data, true);
$data = array('Title' => $data['Title'], 'Plot' => $data['Plot']);
$data = json_encode($data);
print($data); 
```

另一种方法（稍微更有效）是取消设置不需要的键，例如：

```
$data = file_get_contents('http://www.omdbapi.com/?i=tt0903624');
$data = json_decode($data, true);
$keys = array_keys($data);
foreach ($keys as $key) {
    if ($key != 'Title' && $key != 'Plot) {
        unset($data[$key]);
    }
}
$data = json_encode($data);
print($data); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-06-17T14:42:52.343

OMDBAPI.com 不再免费使用。正如你可以在他们的网站上看到的：

```
05/08/17 - Going Private! Please go read the post on the Patreon page about this major change. 
```

这意味着您必须成为捐赠者才能访问 API。我使用他们的 API 一年多了，现在它停止了。如果您需要执行大量查询，那么我认为成为 OMDBAPI 的赞助商是个好主意。但是我在我的小私人项目中使用了他们的 API。谷歌搜索了一下后，我发现了另一个 API。这是您可以使用的代码：

```
<?php
$imdbID = 'tt2866360';
$data = json_decode(file_get_contents('http://api.rest7.com/v1/movie_info.php?imdb=' . $imdbID));

if (@$data->success !== 1)
{
    die('Failed');
}
echo '<pre>';
print_r($data->movies[0]); 
```

我不隶属于这个网站。但我使用这个 API，所以如果有人有，我可以回答一两个问题。

# ios - iOS 论坛设置

> ID：14059256
> 
> 赞同：0
> 
> 时间：2012-12-27T18:16:56.130
> 
> 标签：ios, nsurlconnection

如果我想在我的应用程序中拥有一个用户论坛，这是一种设置方式吗？

用于 Web 服务 NSURLConnection 的后端 PHP 页面的 MySQL DB，用于从 Web 服务进行通信和接收

这将是相当简单的纯文本。

我敢肯定有无数种方法可以设置它，但这是我在想的溃败。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T18:24:34.133

您不会*在*您的应用程序中拥有用户论坛，而是*要从*您的应用程序访问用户论坛。因此，只要有一种从 iOS 连接到论坛的方法，您想在服务器上设置论坛的任何方式（包括您建议的方式）都可以正常工作。

当然，您可以使用`NSURLConnection`访问论坛，但该类仅管理实际连接。`UIWebView`您可能会发现在您的应用程序中将 a 用作迷你浏览器会更容易，只需将 Web 视图指向适当的 URL。

# android - 从另一个应用程序访问应用程序的网络历史记录

> ID：14059258
> 
> 赞同：0
> 
> 时间：2012-12-27T18:17:05.017
> 
> 标签：android, caching, web, history

我有一些我知道的应用程序可以访问网络并下拉一些页面以在某种类型的包装器中显示在应用程序中（在 Android 中工作）。我想知道是否有办法获取这些网页的列表，例如应用程序的“网络历史记录”。

如果我可以在代码中某处的列表中获得它，那将是很棒的，或者只是以某种方式查看它。我想在应用程序级别上，每个应用程序都会有所不同，但是如果有办法从另一个应用程序或某种类型的代码中获取它，那就太棒了！

总而言之，基本上我希望应用程序 A 知道应用程序 B（我不拥有的应用程序）之前获取并显示了哪些页面。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T18:42:10.867

> 基本上我希望应用程序 A 知道应用程序 B（我不拥有的应用程序）之前获取并显示了哪些页面

幸运的是，出于明显的隐私和安全原因，这不是直接可行的。

如果 App B 允许您为其配置代理服务器，那么您可以这样做，使用您管理的可以记录此信息的代理服务器。您甚至可以编写一个 HTTP 代理服务器来填补这个角色。

Root 的设备用户可以使用 Wireshark 和等效设备来监控所有网络流量。

# java - 使 obj 和 obj.clone() 成为 HashMap 中的相同键

> ID：14059260
> 
> 赞同：0
> 
> 时间：2012-12-27T18:17:13.930
> 
> 标签：java, hashmap, clone

考虑到——

```
public class Class_A {
    // members ...
    @Override
    protected Object clone() throws CloneNotSupportedException {
        ...
    }
} 
```

和

```
HashMap<Class_A, Integer> m_map = new HashMap<Class_A, Integer>(); 
Class_A a1 = new Class_A() ; 
Class_A a2 = (Class_A) a1.clone();
m_map.put(a1,6) ; 
```

`m_map.get(a2)`现在，为了也将返回`6`为，可以做些什么`m_map.get(a1)` 呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T18:22:51.950

a1.equals(a2) 必须为真并且 a1.hashCode() 必须等于 a2.hashCode()。

所以你必须重写equals和hashCode（从Object继承的方法认为两个不同的对象是不相等的，并且可能具有不同的hashCodes......）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T18:32:36.007

中的位置`Map`是通过使用对象的`hashCode`和`equals`方法找到的，因此正确的做法是在您的`Class_A`此类中覆盖这些方法，即`a1.equals(a2)`true 和`a1.hashCode() == a2.hashCode()`。

然而，这在我心中敲响了警钟。没有什么理由去克隆一个不可变对象，并且`Map`键应该是不可变的。有关可变键的风险，请参阅[此问题](https://stackoverflow.com/questions/6767365/updating-java-hashmap-key)。

# .net - .NET MVC Db 上下文模型扩展

> ID：14059261
> 
> 赞同：0
> 
> 时间：2012-12-27T18:17:23.150
> 
> 标签：.net, asp.net-mvc, entity-framework, asp.net-web-api

我想做的事情相当简单，尽管我不明白为什么会出现内部服务器错误。

我正在使用带有数据库优先方法的实体框架。我有一个对应于数据库表的模型客户端，也在 DbContext 中声明。

然后我想生成一个带有附加属性的客户端模型，所以我只是扩展了客户端模型。

```
Client
--id
--name
--lastName

ClientDetails: Client
--IEnumerable<addresses> 
```

然后我只是将对象投射到一个方法中

```
ClientDetails tempClient = (ClientDetails) repository.getClient(id); 
```

尽管 Intelisence 不报告错误，但在运行该函数时出现内部服务器错误。

我进行了一些更改，例如复制模型而不扩展它、手动转换或在另一个函数中使用父模型（这也会返回错误）

我得出的结论是，当父模型被另一个模型扩展时，使用该父模型或子模型的一切都会“失败”。是否有任何规则即使 Db.Context 模型也不能扩展以供外部使用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T18:30:49.527

Isn't the Client class partial?

An other option is to change the client class and add a property with the NotMapped attribute: [http://msdn.microsoft.com/en-us/data/jj591583](http://msdn.microsoft.com/en-us/data/jj591583)

It is not a good idea to change generated code, but you could make your own Client class.

Don't use inheritance just to extend an EF class with a property you only need in your code and not in your database. Here is information if you need inheritance in your data: [http://weblogs.asp.net/manavi/archive/2010/12/24/inheritance-mapping-strategies-with-entity-framework-code-first-ctp5-part-1-table-per-hierarchy-tph.aspx](http://weblogs.asp.net/manavi/archive/2010/12/24/inheritance-mapping-strategies-with-entity-framework-code-first-ctp5-part-1-table-per-hierarchy-tph.aspx)

If you don't want to change the client class, you could also wrap it in an other class.

# javascript - 尝试在不使用 gif 的情况下实现滑动进度条

> ID：14059265
> 
> 赞同：0
> 
> 时间：2012-12-27T18:17:38.847
> 
> 标签：javascript, html

我正在尝试实现一个滑动进度条。我希望进度逐渐增加。

我尝试：

HTML

```
<div id="progressKeeper">
<div id="progress"></div>
</div> 
```

CSS

```
#progressKeeper {
    width: 800px;
    height: 25px;
    border: 3px double #003366;
    margin: 0px 10px;
    padding: 3px;
} 
```

JavaScript

```
var el = $('#progress');
var steppedIncreaseAmount = ($('#progressKeeper').width()) / 100;
for (var i = 0; i < 100; i++) {
    el.width(el.width() + steppedIncreaseAmount+ 'px');
} 
```

看到这个[jsfiddle](http://jsfiddle.net/VbVBP/)

但它只是突然增加。我想要一个平滑的效果，就像一个淡入淡出。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T18:21:25.127

您需要在这些值的更新之间设置某种延迟。但是，因为您似乎使用的是 jQuery，所以您可以轻松地执行以下操作：

```
$(document).ready(function() {
    var el = $('#progress');
    el.animate({
        width: "100%"
    }, 1800);
});​ 
```

[http://jsfiddle.net/VbVBP/2/](http://jsfiddle.net/VbVBP/2/)

另一种方法，如果你真的想保持现在的设置，只需`setTimeout`在你的 for 循环中添加一个计数器，如下所示：

```
var el = $('#progress');
var steppedIncreaseAmount = ($('#progressKeeper').width()) / 100; 
for (var i = 0; i < 100; i++) {
    setTimeout(function(){
        el.width(el.width() + steppedIncreaseAmount+ 'px');
    }, 1+i*20);
}​ 
```

[http://jsfiddle.net/VbVBP/3/](http://jsfiddle.net/VbVBP/3/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-27T18:21:45.687

一个简单的 for 循环更新值的速度快于你的眼睛可以赶上......

您可以使用计时器功能，例如`setInterval`基本 JS 动画。这将像：

```
var increase = setInterval(function(){

    el.width(el.width() + steppedIncreaseAmount+ 'px');

}, 50); //50 is the interval in ms, i.e the function inside the interval gets called 20 times per second 
```

完成动画后（进度为 100%），您应该取消间隔：

```
clearInterval(increase); 
```

在 setInterval 上查看[工作小提琴](http://jsfiddle.net/VbVBP/1/)和[MDN 文档](https://developer.mozilla.org/en-US/docs/DOM/window.setInterval)

如果您想深入了解 JavaScript 动画领域，您可能还想了解[`requestAnimationFrame`](http://paulirish.com/2011/requestanimationframe-for-smart-animating/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-27T18:24:13.730

尝试使用动画：

```
el.animate({ width: "+=" + steppedIncreaseAmount }, 500); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-27T18:41:28.363

哦，不要为此使用javascript。你可以只用 CSS3 动画来做到这一点。

```
@-webkit-keyframes progress { 
    from { }
    to { width: 100% }
} 
```

和进度条：

```
-webkit-animation: progress 2s 1 forwards;
-moz-animation: progress 2s 1 forwards;
-ms-animation: progress 2s 1 forwards;
animation: progress 2s 1 forwards; 
```

工作示例：http: [//jsfiddle.net/VbVBP/4/](http://jsfiddle.net/VbVBP/4/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-27T18:55:51.547

我设置了一个演示，说明我能想出什么。[http://jsfiddle.net/VbVBP/5/](http://jsfiddle.net/VbVBP/5/) 我将更新时间设置为 300 毫秒，更新动画的速度也设置为 300，因此它不断动画。

您将使用操作完成的任何百分比，而不是使用随机值。

```
<div id="progressKeeper">
<div id="progress"></div>
</div>​

var randomPercentInt = 0;

function percentComplete(percent) {
    var el = $('#progress');
    el.animate({
        width: percent
    }, 300);
}

$(document).ready(function() {
    percentComplete('0%');
});

function randomPercent() {
    var randomNumber = Math.floor(Math.random() * 10);
    randomPercentInt += randomNumber;
    console.log(randomPercentInt);
    if(randomPercentInt>100)
    {
        randomPercentInt = 100;
        clearInterval(clearme);
    }
    percentString = randomPercentInt.toString() + '%';
    percentComplete(percentString);
}
clearme = setInterval(randomPercent, 300);​ 
```

# javascript - 在 jQuery 中加载后关闭子窗口

> ID：14059267
> 
> 赞同：2
> 
> 时间：2012-12-27T18:17:48.580
> 
> 标签：javascript, jquery, window

我正在尝试编写一个 JS/jQuery 脚本，该脚本从子窗口中的页面打开整个链接负载，然后在每个子窗口加载后关闭它。这是因为一旦加载了子页面，它就会触发下载，然后我需要关闭子页面。我尝试了很多方法，但似乎都没有奏效，也许有人可以帮助我？这是我尝试的一个例子：

```
var imgURL = "http://...etc";
var imgWindow = window.open(imgURL);
imgWindow.ready(function(){
    this.close();
}); 
```

非常感谢任何建议如何让它工作，有点卡住了！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T18:38:49.310

下面的代码将打开一个新窗口并在该窗口加载后关闭。

```
var imgURL = "http://yourdomain.com/imagePage.html";
var imgWindow = window.open(imgURL);
imgWindow.onload = function(){
    imgWindow.close();
}; 
```

这仅在子窗口来自同一个域时才有效。如果子窗口的 URL 不是同一个域，就什么都做不了。那将是一个 XSS 漏洞。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T18:39:12.713

上面代码的主要问题是对象没有`ready`方法`window`。

试试这个 ：

```
var imgURL = "http://google.com";
var imgWindow = window.open(imgURL);
imgWindow.addEventListener('load', imgWindow.close(), true); 
```

# eclipse - Eclipse GGTS IDE 编辑器中的 Unicode 支持（如何输入 unicode 数学符号）

> ID：14059269
> 
> 赞同：0
> 
> 时间：2012-12-27T18:18:02.667
> 
> 标签：eclipse, unicode, groovy

我想通过我用[groovy](http://groovy.codehaus.org)编码的 DSL来处理[花卉公式](http://www.academia.edu/1175371/Floral_formulae_updated_for_routine_inclusion_in_formal_taxonomic_descriptions)，所以我需要一些特殊的符号，例如[女性符号](http://www.fileformat.info/info/unicode/char/2640/index.htm)和[上标和下标](http://www.unicode.org/charts/PDF/U2070.pdf)。

感谢[我在这样的stackoverflow问题上找到了很好的答案，](https://stackoverflow.com/questions/602912/how-do-you-echo-a-4-digit-unicode-character-in-bash)现在我可以通过这种方式在VIM（MacVim）的源代码中插入特殊的unicode符号：

`CTRL`+ `V`. `U` `2` `6` `4` `0`.

但是，**我希望能够在 Eclipse IDE 中做同样的事情**（我正在尝试使用[Groovy/Grails Tool Suite](http://grails.org/products/ggts) Version: 3.1.0.RELEASE 来开发一个 grails 项目）

**问题**：如何通过知道编码（无需从其他来源剪切和粘贴）在 Eclipse 编辑器中插入 4 位 unicode 符号？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T19:57:29.817

似乎有几种方法可以在 Mac 上获取 unicode 字符。前几个似乎不是您想要的，但为了完整性而包含在内。

1) 确保选中系统偏好设置->键盘“在菜单栏中显示键盘和字符查看器”。然后您可以单击它（通常可以通过 option+cmd+T 访问，但不能在 eclipse 中访问）以获取 Character Viewer。然后，您可以双击所需的特殊字符，它应该插入光标处。

2) 在默认设置下，您应该可以单击 Option + 键来获取备用字符。使用#1 中的键盘查看器查看映射到什么。请注意，您可以同时使用 Shift 切换到更多映射。这只会让你得到一个 unicode 字符的子集。

3) 从[这里](https://superuser.com/questions/47420/insert-unicode-characters-via-the-keyboard)：在系统偏好设置->语言和文本下，转到输入源选项卡。选择 Unicode 十六进制输入源。您可能需要将切换输入源（在 System Prefs->Keyboard->Keyboard Shortcuts->Keyboard 下）分配给热键组合（默认可能与聚光灯冲突，因此更改为其他内容）。之后，您应该能够使用所述热键组合切换到 Unicode 输入源 - 在该模式下，您可以按住 Option 并输入一个十六进制的 4 位键码，这将导致字符被放置在光标处。

# java - java如何获取远程机器的mac地址

> ID：14059271
> 
> 赞同：4
> 
> 时间：2012-12-27T18:18:09.500
> 
> 标签：java, ip, mac-address

> **可能重复：**
> [查询 ARP 缓存以获取 MAC ID](https://stackoverflow.com/questions/1238963/query-arp-cache-to-get-mac-id)

我需要获取连接到我的家庭网络的所有远程机器的 mac 地址。我可以使用下面的代码读取我自己机器的mac地址，但我不知道如何获取我网络上其他机器的mac地址。或者有没有可能。

```
import java.net.InetAddress;
import java.net.NetworkInterface;
class Test {
public static void main(String[] args) throws Exception {
InetAddress address = InetAddress.getLocalHost();

NetworkInterface ni = NetworkInterface.getByInetAddress(address);
byte[] mac = ni.getHardwareAddress();

for (int i = 0; i < mac.length; i++) {
  System.out.format("%02X%s", mac[i], (i < mac.length - 1) ? "-" : "");
}
}
} 
```

输出（MyComputer 的 6byte mac 地址）
30-60-77-12-cd-99

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T02:46:31.647

> 如何获取远程机器的mac地址

你不能那样做——一般情况下不能。[MAC地址](http://en.wikipedia.org/wiki/MAC_address)只对同一物理网段的机器可用。[这些机器使用ARP](http://en.wikipedia.org/wiki/Address_Resolution_Protocol)协议直接相互通信，以将 IP 地址“转换”为物理 (MAC) 地址。

一旦跨过 IP 路由器或任何其他[第 3 层](http://en.wikipedia.org/wiki/OSI_reference_model#Layer_3%3a_network_layer)设备，通常会丢失任何 MAC 信息。

底线：您无法通过 Internet 获取远程节点的 MAC 地址 - 您甚至无法在任何中等规模的专用网络中做到这一点，例如大多数大中型公司所实施的。

# java - Java初学者：类和方法

> ID：14059274
> 
> 赞同：3
> 
> 时间：2012-12-27T18:18:23.673
> 
> 标签：java

我是菜鸟，Java 是我的第一门编程语言。我有这个我正在尝试解决的问题：

> 定义一个类来表示糖碗糖，其特征在于三个方面：总容量（以克为单位）、可用数量和勺子的数量（多少克糖占用与其相关联的勺子）。在此类中设置：
> 
> 1.  创建糖罐的构造方法。
> 2.  一种可以知道糖碗中糖含量的方法。
> 3.  一种可以知道一勺糖需要多少的方法。
> 4.  一种方法，给定一些勺子，移除相应数量的糖，返回这个值。
> 5.  一种加糖的方法。如果提供的值超过可用空间，糖碗应该是满的，剩余的量会被退回。在其他情况下，应该返回零。
> 
> 将课程设置`RunSugarBowl`为主要课程并玩耍。

```
public class SugarBowl {

    private int totalCapacity;
    private int availableSpace;
    private int spoonSize;
    private int occupiedSpace = totalCapacity-availableSpace;//is the same as amount of sugar in the bowl.

    SugarBowl (int totalCapacity){
        availableSpace=totalCapacity;
        spoonSize = totalCapacity/20;//arbitrary size
    }

    public int spoon(){
        return spoonSize;
    }

    public int occupied(){
        return occupiedSpace;
    }

    public void scoops (int numberOfScoops){
        int amountTaken = numberOfScoops * spoonSize;
        if (amountTaken<=occupiedSpace){
            occupiedSpace=occupiedSpace-amountTaken;
            System.out.println(amountTaken);}
        else{
            System.out.println("There's not that amount of sugar in the sugar bowl. Try less.");}       
    }
    public int addSugar (int addedAmount){
        if (addedAmount>availableSpace){
            int remainingAmount=addedAmount-availableSpace;
            availableSpace=0;
            occupiedSpace = totalCapacity-availableSpace;
            return remainingAmount;}
        else{
             availableSpace = availableSpace - addedAmount;
             occupiedSpace = totalCapacity-availableSpace;
                return 0;}
    }
} 
```

我**现在**的问题是我的`one.occupied`方法返回`0`而不是`200`在：

```
public class RunSugarBowl {
    public static void main(String[] args) {
        SugarBowl one = new SugarBowl(200);
        one.addSugar(300);
        System.out.println("Occupied size is : "+ one.occupied());
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T18:51:29.590

不幸的是，您的代码是错误的。你应该改变这个功能

```
 public void addSugar (int addedAmount){
    if (addedAmount>availableSpace){
        int remainingAmount=addedAmount-availableSpace;
        System.out.println("Sugar bowl completely full. You got left: "+ remainingAmount);}
    else{
        System.out.println("0");}
} 
```

和

```
public void addSugar (int addedAmount){
    if (addedAmount>availableSpace){           
        System.out.println("Sugar bowl completely full. You got left: "+ remainingAmount);}
    else{
        availableSpace = availableSpace - addedAmount; //this ensures available space changes after you add sugar
        occupiedSpace = totalCapacity-availableSpace; // you must also write this to change the ocuuppied space too
        System.out.println(availableSpace);
    }
} 
```

因为您构建了容量为 200 的糖罐，然后再添加 100。所以

```
if (addedAmount>availableSpace) 
```

100 > 200 返回 false，它直接进入 else 块，它只打印出 '0'。这是你犯的逻辑错误。但别担心我们都去过那里；）

实际上，这条线 `occupiedSpace = totalCapacity-availableSpace;` 是必不可少的， `availableSpace = availableSpace - addedAmount;` 因为您使用了**占用**空间作为属性。您在类开头编写的公式仅执行一次，当您调用构造函数时（最初您提取的两个值都是 0，因为它们是原始 int）并且**占用**空间保持为**0**，除非您使用其他函数调用更改它.

但是，如果您希望每次需要时都计算**占用**空间或**可用空间，则应删除其中一个，因此您只需要另一个和****totalCapacity**。每次可以通过从**totalCapacity**中减去一个来计算另一个。如果我是你，我会用

```
public int getOccupiedSpace(){
return totalCapacity-availableSpace;
} 
```

而不是使用（顺便说一句，这对您的情况有用）

```
private int occupiedSpace = totalCapacity-availableSpace; 
```

这是一样的

```
private int occupiedSpace = 0; 
```

或者

```
private int occupiedSpace ; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-27T19:49:30.057

首先，作为提示，添加方法标头很有用，这样您就知道您的方法要做什么。Aka，如果您查看您的规范，您的许多方法都要求您“知道多少......”所以这些方法应该返回一个数字，而不是立即打印出一些东西（我在开始编码时犯了同样的错误）。

您正在您的方法中打印出这些数字（这对调试很有用，但不是您的成品应该做什么）。您可以返回一个 int，然后在 RunSugarBowl 中打印出该整数（见下文）。

我已经为您提供了一个总体框架，并添加了一些可能对您有所帮助的评论。你一开始就做得很好。如果您有更多问题，请在评论中提问。

```
public class SugarBowl {
    private int totalCapacity;
    private int availableSpace;
    private int spoonSize;
    private int occupiedSpace;//starts at 0, because there's nothing in the bowl.

    /**
     * Constructor for the sugar bowl.
     * @param totalCapacity     The total capacity of the bowl.
     */
    public SugarBowl (int totalCapacity){
        this.totalCapacity = totalCapacity; //set the totalCapacity for the bowl
        availableSpace=totalCapacity;
        spoonSize = totalCapacity/20;//arbitrary size
        occupiedSpace = 0;
    }
    /**
     * Shows how much sugar can fit in a spoon.
     * @return  The size of the spoon
     */
    public int spoon(){
        return spoonSize;
    }
    /**
     * Returns amount of sugar in the bowl.
     * @return  The amount of occupied space
     */
    public int occupied(){
        return occupiedSpace;
    }
    /**
     * Removes the amount of sugar based on the
     * number of scoops passed into it.
     * @param numberOfScoops    The number of scoops
     * @return          The amount of sugar removed
     */
    public int scoops (int numberOfScoops){

        int possibleAmountTaken = numberOfScoops * spoonSize;
        int actualAmountTaken = 0;
        //Think about sugar, even if there is less sugar than the spoon size, 
        //can a spoon still remove that amount?
        //aka the only time 0 sugar should be taken is when there is 0 sugar in the bowl
        if (possibleAmountTaken<=occupiedSpace){
            actualAmountTaken = possibleAmountTaken;
        }
        else{
            //there may still be sugar, just not enough for every scoop, you still have to remove it
            //actualAmountTaken = ???
        }
        occupiedSpace = occupiedSpace - actualAmountTaken;
        //what about availableSpace?
        //availableSpace = ???
        return actualAmountTaken;       
    }
    /**
     * Adds the specified amount of sugar to the bowl.
     * 
     * @param addedAmount   The amount of sugar added to the bowl
     * @return  The overflow amount of sugar or 0 if there was no overflow
     */
    public int addSugar (int addedAmount){
        int overflow = 0;
        if (addedAmount>availableSpace){
            overflow = addedAmount-availableSpace;
            //your bowl is going to be full, what happens to occupiedSpace and availableSpace?
            //availableSpace = ???
            //occupiedSpace = ???
        }
        else{
            //overflow is already 0 so you don't have to do anything with it
            //update availableSpace and occupiedSpace
            //availableSpace = ???
            //occupiedSpace = ???
        }
        return overflow;
    }
} 
```

用你上面的主要例子：

```
public class RunSugarBowl {
    public static void main(String[] args) {
        SugarBowl one = new SugarBowl(200);
        System.out.println("Sugar overflow: " + Integer.toString(one.addSugar(300))); //once working correctly should print out 100 for the overflow
        System.out.println("Occupied size is : "+ one.occupied());
    }
} 
```

**更新**

您使用 this.totalCapacity 的原因是因为以下代码行：

```
public class SugarBowl {
    private int totalCapacity; //totalCapacity for this object; aka this.totalCapacity refers to this variable
    //..

    public SugarBowl (int totalCapacity){ // <-- totalCapacity passed in
        this.totalCapacity = totalCapacity; //this.totalCapacity is setting the totalCapacity for this instance of the object to the value passed in
        //.. 
```

请注意您的构造函数是如何在名为“totalCapacity”的变量中传递的，但该类也有自己的内部变量，称为totalCapacity。没有“this”关键字的可比代码如下：

```
public class SugarBowl {
    private int bowlTotalCapacity; //totalCapacity for this object
   //..

    public SugarBowl (int totalCapacity){ 
        bowlTotalCapacity = totalCapacity;
        //.. 
```

您只需确保在初始化之前使用过 totalCapacity 的任何位置后，将其更改为 bowlTotalCapacity。使用 this.totalCapacity 来引用此类中的 totalCapacity 要容易得多。在这里查看更多信息：[http](http://docs.oracle.com/javase/tutorial/java/javaOO/thiskey.html) ://docs.oracle.com/javase/tutorial/java/javaOO/thiskey.html 。

从技术上讲，您在最初构造对象后实际上并没有再次使用 totalCapacity，但是如果您想查看如果不包含此部分会发生的奇怪情况，请尝试了解以下代码中发生的情况：

```
public class ThisExample {
    private int wrongExample = 0;
    private int thisExample = 0;

    public ThisExample (int wrongExample, int thisExample){
        wrongExample = wrongExample;
        this.thisExample = thisExample; 
    }

    public int getThisExample(){
        return thisExample;
    }
    public int getWrongExample(){
        return wrongExample;
    }
} 
```

运行以下命令可以帮助您更好地理解：

```
public class ThisExampleMain {
    public static void main(String[] args) {
        ThisExample ts = new ThisExample(50, 50);
        //you want this to be 50 but it ends up being 0:
        System.out.println("Wrong: " + ts.getWrongExample());
        //this returns the correct answer:
        System.out.println("Right: " + ts.getThisExample());
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-27T20:17:17.407

规范要求的 addSugar 方法应该返回一个 int：addSugar 方法还应该同时更新 availableSpace 和占用空间。

在 main 中，您正在调用 one.occupied() 方法，但您没有对该值做任何事情，也许您想打印它以查看它。

以下是您的 addSugar 方法和主要方法。

```
public int addSugar (int addedAmount){
    if (addedAmount>availableSpace){
        int remainingAmount=addedAmount-availableSpace;
        return remainingAmount;
        }
    else
        {
            availableSpace = availableSpace - addedAmount;
            occupiedSpace = occupiedSpace + addedAmount;
        return 0;
        }
}

public class RunSugarBowl {
public static void main(String[] args) {
    SugarBowl one = new SugarBowl(200);
    System.out.println("The occupied Space is: " + one.occupied());
    System.out.println("The addSugar() method is returning " + one.addSugar(300));
    System.out.println("The occupied Space now is: " + one.occupied());
} 
```

}

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-27T18:38:52.220

您的 main 方法调用这些方法，但不使用从这些方法返回的值。你应该改变你的`main`方法如下。

```
public class RunSugarBowl {
    public static void main(String[] args) {
        SugarBowl one = new SugarBowl(200);
        System.out.println("Occupied size is : "+ one.occupied());
    }
} 
```

如下更改您的 addSugar() 方法。

```
 public void addSugar (int addedAmount){
        if (addedAmount>availableSpace){
            int remainingAmount=addedAmount-availableSpace;
            availableSpace=0;
//Update occupiedSpace here.

            System.out.println("Sugar bowl completely full. You got left: "+ remainingAmount);}
        else{
             availableSpace = availableSpace - addedAmount; //this ensures available space changes after you add sugar
                System.out.println("I added "+addedAmount + "to the bowl");
// Update occupiedSpace here.

    }
    } 
```

添加糖时，您不会更新您的占用空间字段。这就是它始终保持不变的原因。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-27T18:20:57.837

你应该更换

```
sugarBowl (int totalCapacity){
    availableSpace=totalCapacity;
    spoonSize = totalCapacity/20;//arbitrary size
} 
```

经过

```
public SugarBowl (int totalCapacity){
    availableSpace=totalCapacity;
    spoonSize = totalCapacity/20;//arbitrary size
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-27T18:23:51.213

您可以将该`main()`方法添加到您的`sugarBowl`类中。您不需要单独的类来运行它。

我会像这样修改你的主要内容：

```
public class RunSugarBowl {
    public static void main(String[] args) {
        sugarBowl one = new sugarBowl(200);
        one.occupied();
        one.addSugar(100);
        }
} 
```

或者您可以将您的类及其构造函数重命名为`SugarBowl`. 我推荐第二个，因为它符合 Sun Java 编码标准。

# c# - 实体框架仅填充域模型中的数据库字段

> ID：14059277
> 
> 赞同：0
> 
> 时间：2012-12-27T18:18:50.777
> 
> 标签：c#, sql, entity-framework, domain-model

我有一个域模型，它具有数据库中不存在的属性。例如 ...

```
public class DomainModel: IKeyedEntity
{
    //Id for the table
    public int DomainModelID { get; set; }

    //Foreign key value
    public int FooID { get; set; }

    //Text value
    public string Value { get; set; }

    //Generic reference to the id of the table
    public int Key { get { return this.DomainModelID; } }

    //No a column in the database
    public Guid ArchiveIdentifier
    {
        get { return Foo.ArchiveIdentifier; }
        set { Foo.ArchiveIdentifier = value }
    }

    //Navigation Property
    public virtual Foo Foo { get; set; }
} 
```

如您所见，这些属性`Key`不是`ArchiveIdentifier`DomainModels 表中的列。当我运行查询时，Entity Framework 将属性`ArchiveIdentifier`视为数据库中的列。这是获取所有 DomainModels 时生成的 SQL 的示例。

```
SELECT 
[Extent1].[DomainModelID] AS [DomainModelID], 
[Extent1].[FooID] AS [FooID], 
[Extent1].[Value] AS [Value],
[Extent1].[ArchiveIdentifier] AS [ArchiveIdentifier] 
FROM  [dbo].[DomainModels] AS [Extent1] 
```

Entity Framework 不会尝试填充该`Key`属性，因为它没有 set 方法，但它会将其视为`ArchiveIdentifier`表中的列。是否有任何注释或方法告诉实体框架`ArchiveIdentifier`不是列？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-27T18:20:31.190

使用[`NotMappedAttribute`](http://msdn.microsoft.com/en-us/library/system.componentmodel.dataannotations.schema.notmappedattribute.aspx)：

```
[NotMapped]
public Guid ArchiveIdentifier
{
    get { return Foo.ArchiveIdentifier; }
    set { Foo.ArchiveIdentifier = value; }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T18:23:17.697

在 ArchiveIdentifier 属性上使用 [NotMapped] 数据注释

# android - Android：ActionBar 在显示和隐藏时出现故障

> ID：14059282
> 
> 赞同：5
> 
> 时间：2012-12-27T18:19:27.720
> 
> 标签：android, android-actionbar, show-hide

我想在单击时显示/隐藏操作栏。

它确实显示和隐藏，但它不平滑......底部隐藏了一段时间，但背景不同，然后消失了。

我什至在一个简单的 hello world 应用程序中尝试过，结果是一样的。这是代码：

```
public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        TextView tv = (TextView) findViewById(R.id.shit);
        tv.setOnClickListener(new OnClickListener() {

            public void onClick(View v) {
                getActionBar().hide();

            }
        });
    } 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-03T17:07:15.103

使用覆盖模式而不是显示和隐藏操作栏。

从[操作栏文档](http://developer.android.com/guide/topics/ui/actionbar.html#Removing)：

> 请注意，隐藏和删除操作栏会导致您的活动重新布局，以考虑操作栏占用的空间。如果您的活动经常隐藏和显示操作栏（例如在 Android Gallery 应用程序中），您可能需要使用覆盖模式。覆盖模式将操作栏绘制在您的活动布局之上，而不是在其自己的屏幕区域中。这样，当操作栏隐藏和重新出现时，您的布局保持固定。要启用覆盖模式，请为您的活动创建一个主题并将 android:windowActionBarOverlay 设置为 true。有关详细信息，请参阅有关[设置操作栏样式的](http://developer.android.com/guide/topics/ui/actionbar.html#Style)部分。

# html - 字符溢出容器

> ID：14059288
> 
> 赞同：2
> 
> 时间：2012-12-27T18:19:38.827
> 
> 标签：html, css

![这就是问题](../Images/0a4b1af9c3f7a5f14dc1cccea8263cc2.png)

所以基本上这是我的问题，我有一个 div，它从`<textarea>`Stack Overflow 上的这里获取它的值，但是如果我把它变成大字符或小字符，这些字符不会换行——它们会超出`<div>`. 有没有一种简单而好的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-27T18:22:09.693

在您的元素上使用以下 CSS：

```
word-wrap: break-word; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-27T18:25:12.860

您可以使用`word-wrap`.

示例：http: [//jsfiddle.net/7vDbp/](http://jsfiddle.net/7vDbp/)

使用说明：[http ://caniuse.com/#search=word-wrap](http://caniuse.com/#search=word-wrap)

或者，您可以`<wbr/>`在所需的分词处将标签插入到您的标记中。

示例：http: [//jsfiddle.net/Wz8jp/](http://jsfiddle.net/Wz8jp/)

# java - 构建后如何在机器上本地查找 Java 项目/JAR 的位置？

> ID：14059289
> 
> 赞同：-1
> 
> 时间：2012-12-27T18:19:39.923
> 
> 标签：java, build, jar

在哪里可以找到我的 Java 项目在构建后放置 JAR 的目录？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T18:32:10.527

如果您碰巧使用的是 NetBeans，则需要“清理并构建”，然后可以从 yourProjectName/dist 文件夹中找到它。

# windows-phone-8 - 如何在 Windows Phone 8 中获取系统声音列表？

> ID：14059292
> 
> 赞同：3
> 
> 时间：2012-12-27T18:19:53.727
> 
> 标签：windows-phone-8

我正在为 Windows Phone 8 开发一个闹钟应用程序，我想让用户从可用的闹钟铃声中进行选择（就像内置的“闹钟”应用程序一样）。第三方应用程序可以使用这组声音吗？如果是这样，我该如何访问它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T08:21:12.233

内置警报声音列表目前未针对 3rd 方应用程序公开。如果这是您希望在未来版本中看到的内容，请使用您的用例在[wpdev uservoice](http://wpdev.uservoice.com)上打开新功能建议。

# asp.net - ASP.Net 相对重定向和资源路径

> ID：14059298
> 
> 赞同：1
> 
> 时间：2012-12-27T18:20:05.643
> 
> 标签：asp.net, url-rewriting, relative-path

我们正在努力将 ASP 站点转换为 ASP.Net，并且遇到了重定向和资源位置的问题。我们的问题来自我们设置的特殊性。我们的网站可以通过两种方式访问​​：

1.  直接通过 URL：[http](http://www.mysite.com) ://www.mysite.com - 在这种情况下一切正常
2.  通过具有如下 URL 的代理服务器：http: [//www.proxy.com/mysite_proxy/proxy/](http://www.proxy.com/mysite_proxy/proxy/)

在#2中，“mysite_proxy”是proxy.com上的一个映射，它将幕后的请求定向到www.mysite.com，“proxy”是一个虚拟子网站，它只是将请求重定向到www.mysite.com的根目录. 它本质上是为了给我们一种方便的方式来了解请求是否从代理访问站点。

我们在这个设置中遇到了两个问题：

1.  将 Response.Redirect 与“~”或纯相对路径 (Default.aspx) 一起使用会生成位置为“/proxy/rest_of_the_path.aspx”的 302 响应。这会导致浏览器请求[http://www.proxy.com/proxy/rest_of_the_path.aspx](http://www.proxy.com/proxy/rest_of_the_path.aspx)，它什么都不是，甚至没有访问我们的服务器，所以我们无法在事后重写。
2.  在我们的页面中为链接、图像、样式表等使用基于“~”的 URL 会创建相同类型的路径：“/proxy/path_to_resources.css”。我们可能可以通过对所有这些资源使用相对路径来解决其中的一些问题，尽管这将是很多工作，并且对于解决由框架和第 3 方组件生成的类似资源链接无济于事。

理想情况下，我想找到一个全局修复程序，使这些问题对网站上的开发人员透明。在这一点上，我有几个想法：

1.  摆脱代理，它并不是真正需要的，并且是出于管理而非技术原因。在技​​术上最容易完成，在现实世界中最难完成。
2.  将问题交给运行代理的小组，并说这是他们需要解决的问题。
3.  使用响应过滤器在原始 html 发送到客户端之前对其进行修改。我知道这可以修复我的资源链接，但我不确定标头（需要对其进行测试），并且必须解析每个响应以查找和重写 url，这会对性能造成影响。

所有这些解决方案在我心中都有很大的负面影响，我希望有人可能有另一个想法。那么有什么想法吗？

另外：已经有很多帖子处理了这个问题的反面：我有一个相对 URL，我怎么可能是绝对的，但我没有遇到任何适合另一个方向的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T18:28:20.947

作为修复，我会在 Global.asax:Session_Start 使用一个小的检测例程（因为我认为代理实际上并没有启动另一个应用程序实例），设置一个具有正确路径的会话变量，并使用它而不是'~'。

如果使用不同的应用程序实例，则使用 Application_Start 代替 Session_Start 并使用静态全局变量代替 Session 变量。

# d - 从 D 中的数组中删除所有出现的给定值

> ID：14059301
> 
> 赞同：5
> 
> 时间：2012-12-27T18:20:14.060
> 
> 标签：d

假设我有一个数组。我想删除数组中具有给定值的所有元素。有谁知道如何做到这一点？我试图删除的值可能不止一次出现，并且数组不一定是排序的。我宁愿就地过滤数组，而不是创建一个新数组。例如，`2`从数组中删除值`[1, 2, 3, 2, 4]`应该会产生结果`[1, 3, 4]`。

这是我能想到的最好的事情：

```
T[] without(T)(T[] stuff, T thingToExclude) {
    auto length = stuff.length;
    T[] result;
    foreach (thing; stuff) {
        if (thing != thingToExclude) {
            result ~= thing;
        }
    }
    return result;
}

stuff = stuff.without(thingToExclude);
writeln(stuff); 
```

这似乎不必要地复杂和低效。有没有更简单的方法？我查看了标准库中的[std.algorithm](http://dlang.org/phobos/std_algorithm.html)模块，希望能找到一些有用的东西，但看起来它会做我想要的一切都是有问题的。以下是我尝试过但不起作用的一些示例：

```
import std.stdio, std.algorithm, std.conv;

auto stuff = [1, 2, 3, 2, 4];
auto thingToExclude = 2;

/*  Works fine with a hard-coded constant but compiler throws an error when
    given a value unknowable by the compiler:
    variable thingToExclude cannot be read at compile time */
stuff = filter!("a != " ~ to!string(thingToExclude))(stuff);
writeln(stuff);

/*  Works fine if I pass the result directly to writeln but compiler throws
    an error if I try assigning it to a variable such as stuff:
    cannot implicitly convert expression (filter(stuff)) of type FilterResult!(__lambda2,int[]) to int[] */
stuff = filter!((a) { return a != thingToExclude; })(stuff);
writeln(stuff);

/*  Mysterious error from compiler:
    template to(A...) if (!isRawStaticArray!(A)) cannot be sliced with [] */
stuff = to!int[](filter!((a) { return a != thingToExclude; })(stuff));
writeln(stuff); 
```

那么，**如何在不知道它们出现的索引的情况下从数组中删除所有出现的值？**

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-27T18:27:20.697

std.algorithm.filter 非常接近您想要的：您的第二次尝试很好。

您需要将其分配给新变量或对其使用 array() 函数。

```
auto stuffWithoutThing = filter!((a) { return a != thingToExclude; })(stuff);
// use stuffWithoutThing 
```

或者

```
stuff = array(filter!((a) { return a != thingToExclude; })(stuff)); 
```

第一个不会创建新数组。它只是在过滤掉给定事物的情况下提供对事物的迭代。

第二个将为新数组分配内存以保存内容。您必须导入[std.array](http://dlang.org/phobos/std_array.html)模块才能使其工作。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-28T15:08:46.560

[在http://dlang.org/phobos/std_algorithm.html](http://dlang.org/phobos/std_algorithm.html)中查找函数删除。有两种策略 - 稳定和不稳定，具体取决于您是否希望剩余元素保持其相对位置。这两种策略都在原地运行并且具有 O(n) 复杂性。不稳定的版本执行较少的写入。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-27T20:10:19.600

如果要删除可以使用的值 remove

```
auto stuffWithoutThing = remove!((a) { return a == thingToExclude; })(stuff); 
```

这不会分配一个新的数组，而是在原地工作，注意`stuff`范围需要是可变的

# java - 重绘缓冲图像

> ID：14059302
> 
> 赞同：2
> 
> 时间：2012-12-27T18:20:16.603
> 
> 标签：java, image, swing, bufferedimage, repaint

我正在尝试使用 Java 进行小型图像处理。用户应该能够加载图像并通过单击按钮对图像进行一些简单的修改。加载和显示图像没有问题，但是当我尝试从中制作二进制图像时， repaint() 方法使我在屏幕上显示为黑色图像。我认为问题出在 repaint() 方法上。我已经使用了搜索功能和谷歌，但我仍然不知道我的代码有什么问题。这就是我到目前为止所拥有的：

```
public class ImageProcessing extends JFrame implements ActionListener {

    private  JPanel imagePanel;
    private  JPanel buttonPanel;
    private JButton binaryButton;
    private  JButton loadButton;    
    private BufferedImage image;    
    private final String WINDOW_TITLE = "Image Processing";

    public ImageProcessing() {
        createWindow();
    }

    private void createWindow() {
        this.setTitle(WINDOW_TITLE);
        this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);            
        this.setSize(500, 500);

        imagePanel = new ImagePanel();
        buttonPanel = new JPanel();
        this.add(imagePanel, BorderLayout.CENTER);

        loadButton = new JButton("Load image");
        loadButton.addActionListener(this);
        buttonPanel.add(loadButton);
        this.add(buttonPanel, BorderLayout.SOUTH);

        binaryButton = new JButton("binary");
        binaryButton.addActionListener(this);
        buttonPanel.add(binaryButton);

        this.setVisible(true);
    }

    @Override
    public void actionPerformed(ActionEvent e) {
       if(e.getSource() == this.loadButton) {
           String filePath = getImageFile();
        if (filePath != null) {
          try {
            image = ImageIO.read(new File(filePath));
           // imageBackup = image;
        } catch (IOException e1) {
            e1.printStackTrace();
        }
          this.repaint();
        }
       } else if (e.getSource() == this.binaryButton) {
           image = new BufferedImage(image.getWidth(), image.getHeight(), BufferedImage.TYPE_BYTE_BINARY);
           imagePanel = new ImagePanel();
           this.repaint();
       }
    }

    private String getImageFile() {
        JFileChooser chooser = new JFileChooser();
        int result = chooser.showOpenDialog(null);
        File file = null;
        if (result == JFileChooser.APPROVE_OPTION) {
          file = chooser.getSelectedFile();
          return file.getPath();
        } else
          return null;
    }       

    class ImagePanel extends JPanel {
       public void paint(Graphics g) {
          g.drawImage(image, 0, 0, this);
       }        
    }
} 
```

我希望你能帮助我并解释我做错了什么。提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T18:46:06.190

目前尚不清楚您要进行哪种图像处理。编码..

```
image = new BufferedImage(
    image.getWidth(), image.getHeight(), BufferedImage.TYPE_BYTE_BINARY); 
```

..仅仅用字节二进制类型创建一个新的（空白）图像。你没有把任何东西拉进去。这就是为什么它是黑色的。

要在其中绘制（例如尝试复制原始图像），您可以获得图形上下文：

```
Graphics2D g = image.createGraphics(); 
```

然后复制类似：

```
g.drawImage(otherImage, 0, 0, this); 
```

我不确定 Java 是否或如何将全深度 RGB 图像转换为`TYPE_BYTE_BINARY`. 你可能会得到一个例外。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T18:46:24.833

您正在替换图像面板而不是图像。此外，您没有在二进制图像上执行实际绘画。这是一个如何将原始图像转换为二进制文件的示例，它基于提供的代码：

```
else if (e.getSource() == this.binaryButton) {
    BufferedImage mask = new BufferedImage(image.getWidth(),
            image.getHeight(), BufferedImage.TYPE_BYTE_BINARY);
    Graphics g = mask.getGraphics();
    g.drawImage(image, 0, 0, this);
    g.dispose();
    image = mask;
    this.repaint();
} 
```

# android - 谷歌地图无法在 Android 4.0.1 上获取 GPS 位置

> ID：14059304
> 
> 赞同：0
> 
> 时间：2012-12-27T18:20:28.197
> 
> 标签：android, android-mapview

我的设备 gps 找到卫星但没有锁定。它不断尝试获取 GPS 信号，但大多数时候都失败了。我在其他 android 版本 4.1.1 上对其进行了测试，问题仍然存在。我只是尝试了许多重置谷歌位置服务和位置访问的组合，但没有任何解决方法。我进入地图，我根本无法获得 GPS 锁定。我注意到，获得 GPS 信号需要更长的时间，而且同性恋者丢失的信号更频繁 禁用“谷歌位置服务”也不起作用

在每个使用 GPS 的应用程序中，只显示空圆圈。有时（几秒钟后）点会出现并开始闪烁。但即使在三分钟后，我的手机仍在搜索 GPS 信号。

在官方谷歌地图应用程序上，它说搜索 GPS 信号并保持这样

我没有任何错误报告。它一直在寻找卫星，在某些时候只有一个圆圈，里面没有点。

## 用于获取 GPS 坐标的示例代码

```
 @Override
public void onCreate(Bundle savedInstanceState) {
      locationManager = (LocationManager)                               getSystemService(Context.LOCATION_SERVICE);
    Criteria c = new Criteria();
    c.setAccuracy(Criteria.ACCURACY_FINE);
    c.setBearingRequired(true);
    pro = locationManager.getBestProvider(c, true);
           locationManager.requestLocationUpdates(pro, 0, 0, this);
    Location loc = locationManager.getLastKnownLocation(pro);
    gpsManager = new GPSManager();
    if (loc != null) {
        showLocation(loc);
    } 

    @Override
protected void onPause() {

    locationManager.removeUpdates(this);

} 
```

有什么解决办法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T18:46:34.783

我最喜欢调试 GPS 问题的工具是 GPS 测试应用程序。它向您显示您的手机正在检测多少颗卫星，它们的信号有多强，修复的准确度等。这至少可以让您排除您是否处于卫星覆盖不良的区域。

我在市场上只有一个应用程序，但它是基于 GPS 的应用程序。这是我的一些代码，它们可以正常工作。请注意，这仅使用 GPS，它不会基于网络进行粗略定位。

```
public void initLocationManager()
{
    myGpsManager = (LocationManager)getSystemService(LOCATION_SERVICE);
    long time = 0;
    float dist =0;
    myGpsListener = new locationListener();
    myGpsManager.requestLocationUpdates("gps", time, dist, myGpsListener);
}

@Override
public void onPause()
{
    myGpsManager.removeUpdates(myGpsListener);
    super.onPause();
} 
```

# google-app-engine - 同时使用 2-legged OAuth 和 3-legged OAuth 的 Python GAE 应用程序

> ID：14059306
> 
> 赞同：2
> 
> 时间：2012-12-27T18:20:29.277
> 
> 标签：google-app-engine, python-2.7, oauth-2.0, google-apps, 2-legged

我正在编写 Python - Google App Engine 应用程序。这个应用程序必须做两件重要的事情：

*   写入用户的日历。
*   写入用户的个人资料（与 Google Apps 域中的用户合作）

第一次操作很简单。如果我理解 OAuth，这是经典的三足场景。最初开发 OAuth 的场景。登录的用户向客户端（我的应用程序）提供凭据，以代表他/她访问用户的数据（日历）。因此，这可以仅使用登录用户的凭据来完成。

第二次操作就没那么容易了。仅使用登录用户的凭据无法完成此操作。这是一个两足 OAuth 场景。因此，我需要委托 Google Apps 域管理员帐户使用 Google Profiles API（通过 google 数据库）访问用户的个人资料。到目前为止，我将管理员用户/密码硬编码到一个 json 文件中，然后我的应用程序会加载该文件。但这对我来说听起来有点*脏*。

最后，我的应用程序需要处理经典的 3-legged OAuth 场景（没问题，只需要登录用户的凭据）加上 2-legged OAuth 场景（需要管理员凭据）。

是否有任何官方或更优雅的方式来处理 Google App Engine 中的这两种情况，使用 Google Apps 域，硬编码管理员凭据？

提前谢谢了

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T18:45:47.873

AFAIK 无法使用 2-legged OAuth 授权对 Google Contacts Data API 的写入操作。

[Google 的文档指定了哪些 API 可以通过 2-legged OAuth 访问](http://support.google.com/a/bin/answer.py?hl=en&answer=162105)，但似乎 Google 的某个人忘记指定其中一些是只读的 :-S

有些人在[这里](http://pilif.github.com/2010/06/google-apps-provisioning-two-legged-oauth/)和[这里](https://stackoverflow.com/questions/3749841/2-legged-oauth-with-google-api-java-client)有同样的问题。

我期待谷歌的人来解决这个问题。在那之前，对管理员级别的凭据进行编码是我知道它有效的唯一选择。我一点也不喜欢它：它*很脏*但很*有效*。如果有人知道更优雅的禅级方式，请照亮我们！

# android - 单击主页按钮后返回第二个活动

> ID：14059308
> 
> 赞同：0
> 
> 时间：2012-12-27T18:20:34.533
> 
> 标签：android, android-intent, android-activity, android-lifecycle

我已经尝试了所有的启动模式，但它似乎不起作用：

假设 App A 有各种活动，J & K。J 是第一个（选择应用程序模式），它在主要事情发生的地方调用 K（调用它之后，J finish()es）。如果我单击 K 中的“主页”按钮，然后再次打开应用程序，它会打开一个带有活动 J 的 A 的新实例。

我希望它改为打开暂停的 K 活动。其他线程提到了一个 Android 错误——有没有办法修复它？设置启动模式不起作用：S

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T18:42:53.333

试试这个

```
@Override
protected void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
if ((getIntent().getFlags() & Intent.FLAG_ACTIVITY_BROUGHT_TO_FRONT) != 0) {
    // Activity was brought to front and not created,
    // Thus finishing this will get us to the last viewed activity
    finish();
    return;
}

// Regular activity creation code...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T09:11:28.190

你想要的是正常的 Android 行为。它不起作用的事实意味着您可能正在做一些奇怪的事情。不要试图通过使用 launchModes 来解决这个问题。请张贴清单的相关部分。但是，有一个像这样表现出来的错误。要查看此错误是否导致您的问题，请执行以下操作：强制关闭手机上的应用程序。现在从手机上的应用程序列表启动您的应用程序。从 ActivityJ 转到 ActivityK。按主页。再次打开应用程序。如果它现在可以工作，那么您只是看到了可怕的 Android 启动错误。

有关启动错误的更多详细信息，请参阅以下问题：

[http://code.google.com/p/android/issues/detail?id=2373](http://code.google.com/p/android/issues/detail?id=2373)

[http://code.google.com/p/android/issues/detail?id=26658](http://code.google.com/p/android/issues/detail?id=26658)

该错误存在于所有设备上，在所有版本的 Android 上（至少到 ICS，尚未在 JellyBean 上测试）。这一切都在模拟器中正常工作，因此您不能将模拟器行为用作真实设备行为的指示。

# javascript - JavaScript: var NumberTable 定义和编码

> ID：14059313
> 
> 赞同：0
> 
> 时间：2012-12-27T18:20:50.237
> 
> 标签：javascript, variables

我正在尝试为表单定义一个数字。我正在研究一下并将其混合在一起（这里是第一行）：

```
 var NumberTable

    [

        { valid: true, minNumber: 0, maxNumber: 4, factor: 0.0, label: 'Level 1' }

    ]; 
```

我只是想知道，“因素”是什么？我正在使用这些括号“[]”，这是否意味着我正在使用数组？

我之前使用了一个括号“{}”，有人告诉我这甚至不是 JavaScript。不知道该怎么回答这个问题，但我希望你能确认我是否正确（这实际上是在 JavaScript 中使用的）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T18:28:51.800

您没有将这些东西分配给实际变量，所以我假设您的意思是这个。

```
var NumberTable = [
  { valid: true, minNumber: 0, maxNumber: 4, factor: 0.0, label: 'Level 1' }
]; 
```

> 什么是“因素”？

不知道。它是对象的属性。您没有粘贴足够的代码来了解它是如何使用的。这没什么神奇或特别的。这个对象只是有一个名为的属性`factor`，其值为`0`。

> 我正在使用这些括号“[]”，这是否意味着我正在使用数组？

是的。您似乎正在将一个包含一个元素的数组分配给`NumberTable`.

> 我之前使用了一个括号“{}”，有人告诉我这甚至不是 JavaScript。不知道该怎么回答这个问题，但我希望你能确认我是否正确（这实际上是在 JavaScript 中使用的）。

`{}`用于 JavaScript 中的一些事情。在这种情况下，您正在创建一个 Object 文字。对象是键/值对的字典。您正在创建 this ，`[]`其中表示一个数组文字。因此，您最终会得到一个包含单个对象的数组。

# eclipse - 空的 Eclipse 运行配置文件

> ID：14059314
> 
> 赞同：1
> 
> 时间：2012-12-27T18:20:55.470
> 
> 标签：eclipse, debugging, xdebug

在尝试设置调试配置以在 Eclipse Java IDE for Web Developers Eclipse Juno 上调试我的 php 项目时。没有选择 index.php 的选项。这令人困惑，因为它甚至没有显示当前工作区中的任何文件。附加快照将进一步解释。 ![空调试配置选择文件](../Images/7971be047668d32e16c846609d8bf7b0.png) 这不是让我运行调试器，这里的任何线索都会有所帮助。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T17:28:01.517

正如 Atlanto 建议的那样，“看起来您没有任何 'PHP 项目'，因为此对话框将仅显示 php 项目。”

那是正确的答案，Eclipse 直接签出项目，它可能不会将它们作为 Php 项目签出。因此，请确保在从 Subversive 签出项目时选择第二个选项**Find/Checkout** as，然后使用向导将它们作为**新项目**签出，以便它们在 Php 透视图下签出，然后可以在调试配置下显示。

# ios - UIGridView 选定的背景颜色

> ID：14059318
> 
> 赞同：0
> 
> 时间：2012-12-27T18:21:02.720
> 
> 标签：ios, grid, cell

我将此代码用于gridview：

[https://github.com/tanin47/UIGridView](https://github.com/tanin47/UIGridView)

我想在推送时在表格单元格上获得背景颜色，直到推送其他单元格。该代码带有一个

```
didSelectRow 
```

void 但单元格已经在另一个 void 中制造，所以我不能简单地使用

```
cell.backgroundColor = [UIColor redColor] 
```

在没有选择行中。

有什么简单的想法可以做到这一点吗？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T18:48:02.100

从我所看到的 UIGridView 来看，它的功能非常不足，能够进行简单的显示，但对于我认为您可能想要的内容来说还不够。我给你的建议是看看[AQGridView](https://github.com/AlanQuatermain/AQGridView)。我已经在自己的程序中使用了这个包，并取得了巨大的成功。它提供了一个增加的工具集，包括查询网格中当前选定索引的方法。

您还可以尝试自己扩展 UIGridView 以跟踪所选索引和返回所选索引处单元格的方法。但无论你最终做什么，答案都是让你的 gridview 跟踪选择的内容，然后在你的视图控制器中保留对 gridview 的引用，以便你可以适当地使用这些信息。

# php - 标记无法解析为变量

> ID：14059320
> 
> 赞同：1
> 
> 时间：2012-12-27T18:21:06.763
> 
> 标签：php, android, android-intent, android-activity, textview

我有一个标签解析错误，我一直试图解决这个错误，但一切都是徒劳的，我想将数据从一个活动移动到另一个活动，但我收到了这个错误：

------>“标签无法解析为变量”

```
Button ok = (Button) findViewById(R.id.ok);
ok.setOnClickListener(new View.OnClickListener() {
    public void onClick (View view) {
        Intent newActivity = new Intent(view.getContext(), home.class);
        newActivity.putExtra("NAME", name);
        startActivity(newActivity);
        Log.d(TAG, name);
    }  
}); 
```

**更新代码：**

登录活动1.java

```
import java.util.ArrayList;
import org.apache.http.HttpResponse;
import org.apache.http.NameValuePair;
import org.apache.http.client.HttpClient;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.client.protocol.ClientContext;
import org.apache.http.cookie.CookieOrigin;
import org.apache.http.cookie.CookieSpec;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.message.BasicNameValuePair;
import org.apache.http.protocol.BasicHttpContext;
import org.apache.http.protocol.HttpContext;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;
import com.trekeyes.android.CustomHttpClient;

public class LoginActivity1 extends Activity { 

    Button btnLinkToRegistrScrn; 
    Button loginbtn1;
    Button cancelBtn;
    TextView error;
    EditText LgnTxt, LgnPsw; 
    public static DefaultHttpClient httpClient;
    public static String TAG="LoginActivity1";

    /** Called when the activity is first created. */ 
    @Override 
    public void onCreate(Bundle savedInstanceState) { 
        super.onCreate(savedInstanceState); 
     setContentView(R.layout.login); 
     LgnTxt = (EditText) findViewById(R.id.editTextLgnEmail);
     LgnPsw = (EditText) findViewById(R.id.editTextLgnPassword);
     error = (TextView)findViewById(R.id.login_error1);
     addListenerOnButton(); 

     // Link to Register Screen  
        btnLinkToRegistrScrn = (Button) findViewById(R.id.LinkToRegisterScreen);  
        btnLinkToRegistrScrn.setOnClickListener(new View.OnClickListener() {  
           @Override 
            public void onClick(View v) {  
               finish();
                Intent i = new Intent(v.getContext(), Activity.class);  
                startActivity(i); 
                }});

     // Link to Cancel Button 
        cancelBtn = (Button) findViewById(R.id.btnCancelLgn);  
        cancelBtn.setOnClickListener(new View.OnClickListener() {  
           @Override 
            public void onClick(View v) {  
               finish();
              //  Intent i = new Intent(v.getContext(), PageApp.class);  
              //  i.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP); 
              //  startActivity(i); 
                }  
       });
   } 
    public void addListenerOnButton() { 

             loginbtn1 = (Button) findViewById(R.id.btnLogin); 

            loginbtn1.setOnClickListener(new View.OnClickListener() { 

            @Override 
            public void onClick(View arg0) { 

                ///////// Database Handling

                // TODO Auto-generated method stub

               ArrayList<NameValuePair> postParameters = new ArrayList<NameValuePair>();
                   postParameters.add(new BasicNameValuePair("email", LgnTxt.getText().toString()));
                   postParameters.add(new BasicNameValuePair("password", LgnPsw.getText().toString()));

                   String response = null;
                   try {
                             response = CustomHttpClient.executeHttpPost("http://10.0.2.2/db/lgn.php", postParameters);  
                       String res=response.toString();
                   res= res.replaceAll("\\s+","");
                   if(res.equals("1"))
                   {
                       error.setText("Correct Email And Password");
                              Intent intent = new Intent(arg0.getContext(), boardAct.class); 
                              intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP); 
                                intent.putExtra("EMAIL", LgnTxt.getText().toString());
                                startActivity(intent);
                                Log.d(TAG,LgnTxt.getText().toString());
                                finish(); 
                   }

                   else
                   error.setText("Sorry!! Incorrect Email or Password");

                   } catch (Exception e) {

                   LgnTxt.setText(e.toString());
                   }           

      }

        }); 
    } 

 } 
```

boardAct.java

```
public class boardAct extends MapActivity {

    public static String TAG="boardAct";

        @Override
        public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            setContentView(R.layout.dashboard);
} 
```

设置.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginBottom="1dip"
            android:layout_marginTop="0dp"
            android:text="@string/accountSettings"
            android:textSize="25sp"
            android:layout_gravity="center"
            android:textStyle="bold" />
    <TextView
            android:id="@+id/txtlabellogSetting"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginBottom="1dip"
            android:layout_marginTop="6dp"
            android:state_enabled="false"
            android:textSize="15sp"
            android:text="@string/labelsettings"
            android:layout_gravity="center"
            android:textStyle="bold" />
    <TextView
            android:id="@+id/txtboxlogSetting"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginBottom="1dip"
            android:layout_marginTop="6dp"
            android:state_enabled="false"
            android:textSize="15sp"
            android:layout_gravity="center"
            android:textStyle="bold" />
</LinearLayout> 
```

设置.java

```
public class AccSettingsActivity extends Activity {
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.settings);
        addListenerOnButton();    
    }

    private void addListenerOnButton() {
        // TODO Auto-generated method stub

          ///////////// For TxtlogSetting  ////////////

            TextView logText = (TextView) findViewById(R.id.txtboxlogSetting); 
            String email = getIntent().getStringExtra("EMAIL"); 
            logText.setText("email");   
   } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T18:26:08.613

在 Activity 的 onCreate 之前将 TAG 声明为 Activity 级别字段为：

```
public class Your_Main_Activity extends Activity {
    public static String TAG="YOUR_ACTIVITY_NAME";
    Button ok;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        ok = (Button) findViewById(R.id.ok);
        ok.setOnClickListener(new View.OnClickListener() {
            public void onClick (View view) {
                Intent newActivity = new Intent(Your_Main_Activity.this, home.class);
                newActivity.putExtra("NAME", name.toString());
                startActivity(newActivity);
                Log.d(TAG, name.toString());
            }  
        });
        // your code here
    }
} 
```

如果您已经在其他活动中将其声明为静态，则将其访问为：

```
Log.d(Your_Other_Activity.TAG, name.toString()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T18:26:35.780

`TAG`应该在某处声明。因为都是大写，我怀疑这是一个

```
public static final String TAG = "MyActivity"; 
```

如果您打算使用该变量，请务必声明并实例化该变量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T18:26:47.663

```
public static final String TAG = "NAME"

Button ok = (Button) findViewById(R.id.ok);
ok.setOnClickListener(new View.OnClickListener() {
    public void onClick (View view) {
        Intent newActivity = new Intent(view.getContext(),home.class);
        newActivity.putExtra("NAME", name);
        startActivity(newActivity);
        Log.d(TAG,name);
    }
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-27T18:27:30.093

声明字符串 TAG = "activityName"; 在使用 TAG 变量之前，您可以删除此行，因为它与您的功能无关。现在要获取您通过意图传递给下一个活动的数据，您可以在下一个活动的 onCreate() 方法中执行此操作

```
String name = getIntent().getStringExtra("NAME", ""); 
```

# objective-c - 我在哪里对目标 c 类中的变量进行编程，以便它的所有方法都可以使用它？

> ID：14059324
> 
> 赞同：0
> 
> 时间：2012-12-27T18:21:11.433
> 
> 标签：objective-c, class, variables

我需要让我的 5 个方法使用一个公共变量，但我不知道在我的 .m 文件中的何处声明它。我知道这是基本的，但我很新，我忘了把它放在哪里。请帮我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T18:22:44.080

```
@implementation {
    // instance variables here  <---
    int foo
    float bar;
}

// methods here

@end 
```

# jquery - 从 .html() 集合变量中删除类。jQuery

> ID：14059326
> 
> 赞同：2
> 
> 时间：2012-12-27T18:21:18.110
> 
> 标签：jquery, removeclass

```
<div>
    <input type="text" placeholder="#" class="error">
    <input type="text" placeholder="#" class="error">
</div>  

var copylast = $('div').html(); 
```

我正在尝试复制 DIV 但从 copylast 变量中删除类错误（我需要将类保留在原始 div 中。）

我试过字符串替换`var copylast = copylast.replace('class="error"', '')`；但它只删除了第一个实例，而且看起来很俗气。如果可能的话，我宁愿使用`removeClass('error')`。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-27T18:23:59.180

如果您不想操作 DOM，可以使用[.clone() 。](http://api.jquery.com/clone/)

```
var copylast = $('div').clone().find('input').removeClass('error').end().html(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T18:23:18.600

试试这个：

```
copylast.find('input').removeClass('error'); 
```

编辑：：

这是应该的：

```
var copylast = $('div').clone().find('input').removeClass('error').end().html(); 
```

# java - 使用 android SDK 的 Eclipse 中的 Android 应用程序 NFC 错误

> ID：14059333
> 
> 赞同：0
> 
> 时间：2012-12-27T18:21:41.570
> 
> 标签：java, android, eclipse, sdk, nfc

我正在使用 android SDK 在 eclipse 中开发一个 android 应用程序，我不断收到这些我无法理解的错误（这是我的第一个 android 应用程序），这些错误可能源于我缺乏编码技能或 XML 中的设置文件，所以我不想用所有这些来淹没你，读者，但这里有，输出：

```
 12-27 13:01:07.872: E/AndroidRuntime(621):  at android.app.ActivityThread.access$600(ActivityThread.java:130)
12-27 13:01:07.872: E/AndroidRuntime(621):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1195)
12-27 13:01:07.872: E/AndroidRuntime(621):  at android.os.Handler.dispatchMessage(Handler.java:99)
12-27 13:01:07.872: E/AndroidRuntime(621):  at android.os.Looper.loop(Looper.java:137)
12-27 13:01:07.872: E/AndroidRuntime(621):  at android.app.ActivityThread.main(ActivityThread.java:4745)
12-27 13:01:07.872: E/AndroidRuntime(621):  at java.lang.reflect.Method.invokeNative(Native Method)
12-27 13:01:07.872: E/AndroidRuntime(621):  at java.lang.reflect.Method.invoke(Method.java:511)
12-27 13:01:07.872: E/AndroidRuntime(621):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
12-27 13:01:07.872: E/AndroidRuntime(621):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
12-27 13:01:07.872: E/AndroidRuntime(621):  at dalvik.system.NativeStart.main(Native Method)
12-27 13:01:07.872: E/AndroidRuntime(621): Caused by: android.view.InflateException: Binary XML file line #8: Error inflating class <unknown>
12-27 13:01:07.872: E/AndroidRuntime(621):  at android.view.LayoutInflater.createView(LayoutInflater.java:613)
12-27 13:01:07.872: E/AndroidRuntime(621):  at com.android.internal.policy.impl.PhoneLayoutInflater.onCreateView(PhoneLayoutInflater.java:56)
12-27 13:01:07.872: E/AndroidRuntime(621):  at android.view.LayoutInflater.onCreateView(LayoutInflater.java:660)
12-27 13:01:07.872: E/AndroidRuntime(621):  at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:685)
12-27 13:01:07.872: E/AndroidRuntime(621):  at android.view.LayoutInflater.rInflate(LayoutInflater.java:746)
12-27 13:01:07.872: E/AndroidRuntime(621):  at android.view.LayoutInflater.inflate(LayoutInflater.java:489)
12-27 13:01:07.872: E/AndroidRuntime(621):  at android.view.LayoutInflater.inflate(LayoutInflater.java:396)
12-27 13:01:07.872: E/AndroidRuntime(621):  at android.view.LayoutInflater.inflate(LayoutInflater.java:352)
12-27 13:01:07.872: E/AndroidRuntime(621):  at com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:256)
12-27 13:01:07.872: E/AndroidRuntime(621):  at android.app.Activity.setContentView(Activity.java:1867)
12-27 13:01:07.872: E/AndroidRuntime(621):  at com.chuggle.clink.MainActivity.onCreate(MainActivity.java:31)
12-27 13:01:07.872: E/AndroidRuntime(621):  at android.app.Activity.performCreate(Activity.java:5008)
12-27 13:01:07.872: E/AndroidRuntime(621):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1079)
12-27 13:01:07.872: E/AndroidRuntime(621):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2023)
12-27 13:01:07.872: E/AndroidRuntime(621):  ... 11 more
12-27 13:01:07.872: E/AndroidRuntime(621): Caused by: java.lang.reflect.InvocationTargetException
12-27 13:01:07.872: E/AndroidRuntime(621):  at java.lang.reflect.Constructor.constructNative(Native Method)
12-27 13:01:07.872: E/AndroidRuntime(621):  at java.lang.reflect.Constructor.newInstance(Constructor.java:417)
12-27 13:01:07.872: E/AndroidRuntime(621):  at android.view.LayoutInflater.createView(LayoutInflater.java:587)
12-27 13:01:07.872: E/AndroidRuntime(621):  ... 24 more
12-27 13:01:07.872: E/AndroidRuntime(621): Caused by: android.content.res.Resources$NotFoundException: Resource is not a Drawable (color or path): TypedValue{t=0x1/d=0x7f060000 a=-1 r=0x7f060000}
12-27 13:01:07.872: E/AndroidRuntime(621):  at android.content.res.Resources.loadDrawable(Resources.java:1892)
12-27 13:01:07.872: E/AndroidRuntime(621):  at android.content.res.TypedArray.getDrawable(TypedArray.java:601)
12-27 13:01:07.872: E/AndroidRuntime(621):  at android.view.View.<init>(View.java:3336)
12-27 13:01:07.872: E/AndroidRuntime(621):  at android.view.ViewGroup.<init>(ViewGroup.java:427)
12-27 13:01:07.872: E/AndroidRuntime(621):  at android.widget.LinearLayout.<init>(LinearLayout.java:176)
12-27 13:01:07.872: E/AndroidRuntime(621):  at android.widget.LinearLayout.<init>(LinearLayout.java:172)
12-27 13:01:07.872: E/AndroidRuntime(621):  ... 27 more
12-27 13:01:12.192: I/Process(621): Sending signal. PID: 621 SIG: 9 
```

XML:

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.chuggle.clink"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="14"
        android:targetSdkVersion="16" ></uses-sdk>

    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" android:permission="android.permission.NFC" android:enabled="true" android:debuggable="true">
        <activity
            android:name="com.chuggle.clink.MainActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>

</manifest> 
```

爪哇：

```
package com.chuggle.clink;
import java.util.Calendar;
import android.app.Activity;
import android.app.PendingIntent;
import android.content.Intent;
import android.content.IntentFilter;
import android.content.IntentFilter.MalformedMimeTypeException;
import android.nfc.FormatException;
import android.nfc.NdefMessage;
import android.nfc.NfcAdapter;
import android.nfc.tech.NfcF;
import android.os.Bundle;
import android.os.Parcelable;
import android.util.Log;
import android.view.Menu;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;
import android.widget.ToggleButton;

public class MainActivity extends Activity {
    NfcAdapter nfcAdapter;
    private PendingIntent pint;
    private IntentFilter[] mesfilt;
    private String[][] TList;
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        final EditText messageholder = (EditText) findViewById(R.id.ToSend);
        final Button TButton = (ToggleButton) findViewById(R.id.SendButton);
        nfcAdapter = NfcAdapter.getDefaultAdapter(this);
        if (nfcAdapter == null) return;
        pint = PendingIntent.getActivity(this, 0,
        new Intent(this, getClass()).addFlags(Intent.FLAG_ACTIVITY_SINGLE_TOP), 0);
        IntentFilter ndef = new IntentFilter(NfcAdapter.ACTION_TECH_DISCOVERED);
        try {
            ndef.addDataType("*/*");
        } catch (MalformedMimeTypeException e) {
            throw new RuntimeException("fail", e);
        }
        mesfilt = new IntentFilter[] {
                ndef,
        };
        TList = new String[][] { new String[] { NfcF.class.getName() } };
        if (nfcAdapter == null) return;
        TButton.setOnClickListener( new OnClickListener() {
            @Override
            public void onClick(View arg0) {
                // TODO Auto-generated method stub
                sendMessage(messageholder.getText().toString());
            }
        });
    }
    String resolveIntent(Intent intent) {
        NdefMessage[] msgs = null;
        if(intent.equals(NfcAdapter.ACTION_NDEF_DISCOVERED)){
            Parcelable[] rawMsgs = intent.getParcelableArrayExtra(NfcAdapter.EXTRA_NDEF_MESSAGES);
            if(rawMsgs!=null){
                msgs = new NdefMessage[rawMsgs.length];
                for(int i=0;i<rawMsgs.length;i++){
                    msgs[i] = (NdefMessage) rawMsgs[i];
                }
            }
        } 
        else {
        return("Recieving Error");
        }
        return msgs.toString();
    }
    public void sendMessage(String OrToSend){
        Calendar rightNow = Calendar.getInstance();
        OrToSend = OrToSend+" --"+rightNow.getTime().toString();
        byte[] textBytes = OrToSend.getBytes();
        NdefMessage MessageToSend = null;
        try {
            MessageToSend = new NdefMessage(textBytes);
        } catch (FormatException e) {
            e.printStackTrace();
            MessageUpdate("Message Error, Cannot Send");
        }
        nfcAdapter.setNdefPushMessage(MessageToSend, this);

    }
    @Override
    public void onResume() {
        super.onResume();
        nfcAdapter.enableForegroundDispatch(this, pint, mesfilt, TList);
    }

    @Override
    public void onNewIntent(Intent intent) {
        Log.i("Foreground dispatch", "Discovered tag with intent: " + intent);
        Log.i(intent.toString(), resolveIntent(intent));
    }
    @Override
    public void onPause() {
        super.onPause();
        nfcAdapter.disableForegroundDispatch(this);
    }
    public void MessageUpdate(String NewString){
        TextView M1 = (TextView)findViewById(R.id.M1);
        TextView M2 = (TextView)findViewById(R.id.M2);
        TextView M3 = (TextView)findViewById(R.id.M3);
        TextView M4 = (TextView)findViewById(R.id.M4);
        TextView M5 = (TextView)findViewById(R.id.M5);
        TextView M6 = (TextView)findViewById(R.id.M6);
        TextView M7 = (TextView)findViewById(R.id.M7);
        TextView M8 = (TextView)findViewById(R.id.M8);
        TextView M9 = (TextView)findViewById(R.id.M9);
        TextView M10 = (TextView)findViewById(R.id.M10);
        TextView M11 = (TextView)findViewById(R.id.M11);
        TextView M12 = (TextView)findViewById(R.id.M12);
        TextView M13 = (TextView)findViewById(R.id.M13);
        TextView M14 = (TextView)findViewById(R.id.M14);
        TextView M15 = (TextView)findViewById(R.id.M15);
        TextView M16 = (TextView)findViewById(R.id.M16);
        TextView M17 = (TextView)findViewById(R.id.M17);
        TextView M18 = (TextView)findViewById(R.id.M18);
        TextView M19 = (TextView)findViewById(R.id.M19);
        TextView M20 = (TextView)findViewById(R.id.M20);
        TextView M21 = (TextView)findViewById(R.id.M21);
        M21.setText(M20.getText());
        M20.setText(M19.getText());
        M19.setText(M18.getText());
        M18.setText(M17.getText());
        M17.setText(M16.getText());
        M16.setText(M15.getText());
        M15.setText(M14.getText());
        M14.setText(M13.getText());
        M13.setText(M12.getText());
        M12.setText(M11.getText());
        M11.setText(M10.getText());
        M10.setText(M9.getText());
        M9.setText(M8.getText());
        M8.setText(M7.getText());
        M7.setText(M6.getText());
        M6.setText(M5.getText());
        M4.setText(M3.getText());
        M2.setText(M1.getText());
        M1.setText(NewString);
    }
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

} 
```

对不起，这一切都很丑陋，我很确定我的代码大部分都是错误的，但这不是我关心的部分，请随时提供帮助，但我真正需要知道的是为什么这些错误是发生以及如何解决它们。对不起，这是一个巨大的职位。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T18:39:34.847

跟踪中的行

```
android.content.res.Resources$NotFoundException: Resource is not a Drawable (color or path): TypedValue{t=0x1/d=0x7f060000 a=-1 r=0x7f060000} 
```

建议您尝试在其中一个布局文件中指向未定义的资源（颜色/路径）。

# android - 将 MediaPlayer 保存在屏幕旋转上

> ID：14059335
> 
> 赞同：0
> 
> 时间：2012-12-27T18:21:42.960
> 
> 标签：android

我需要将 MediaPlayer 对象保存在 android 屏幕旋转上。

但我不知道可以执行这个动作。

有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T18:41:36.313

我建议编写一个扩展 MediaPlayer 的单例类，然后编写您想用于媒体播放暂停恢复等的方法。现在您可以在旋转之前为该单例类保存调用 pause()，当屏幕旋转时，然后 resume() 您的播放器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T01:17:48.913

好的不错！

感谢您的回答。

我用这段代码实现了我的课程。

公共类 MyMediaPlayer 扩展 MediaPlayer {

```
private static MediaPlayer mp;

private static MyMediaPlayer instance = null;

private MyMediaPlayer() {

}

public static MyMediaPlayer getInstance () {
    if (instance == null) {
        instance = new MyMediaPlayer();
    }
    if (mp == null) {
        mp = new MediaPlayer();
        mp.setAudioStreamType(AudioManager.STREAM_MUSIC);
        //mp.setOnPreparedListener(this);
        //mp.setOnErrorListener(this);
        try {
            mp.setDataSource("http://74.222.1.197:13588");
        } catch (Exception e) {
            // TODO: handle exception
        }
    }
    return instance;
}

public MediaPlayer getMediaPlayer() {
    return mp;
} 
```

}

# php - OOP Classes，如何在课堂上上课

> ID：14059339
> 
> 赞同：0
> 
> 时间：2012-12-27T18:22:03.420
> 
> 标签：php, class, object

我已经开始学习 OOP 并且我已经建立了一个名为 accountactions 的类，我想知道我是否写得很好。

该类在文件中：accountactions.class.php。

```
<?php

class accountactions(){

    public function register($login, $password, $email){

        //Zapisujemy dane wysłane formularzem
        $this->username = mysql_real_escape_string($login);
        $this->password = mysql_real_escape_string($password);
        $this->email = mysql_real_escape_string($email);

        //Hash password
        $this->password = md5(sha1($this->password));

        $db->simplequery("INSERT INTO radio_users(id, username, password, email) VALUES('', '$this->username', '$this->password', '$this->email')");

    }

}

?> 
```

register.php 文件：

```
<?php

    require_once("accountactions.class.php");

    $account = new accountactions();

    $account->register('samplelogin', 'samplepassword', 'sample@email');

?> 
```

我对这个片段有一些问题：

```
$db->simplequery("INSERT INTO radio_users(id, username, password, email) VALUES('', '$this->username', '$this->password', '$this->email')"); 
```

如何将我的数据库类加入我的帐户类？

我想保留一个模型，我可以在其中执行以下操作：

$account->register('$_POST['login']', '$_POST['password']', '$_POST['email']');

除非有更好的方法来做到这一点。

我是 OOP 的新手，所以任何提示和指南都值得赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T19:28:52.643

这段代码主要是好的，但也有一些我认为不好的地方。首先，我认为您应该遵循一些命名约定，因为 accountactions 是一个错误的类名。对于 OOP，我认为您应该使用驼峰式的一些变体（因此 accountActions 或 AccountActions - 我建议您使用后者）。然后，类名后面不应该有括号。我还建议您将每个大括号放在单独的行中，但这取决于您的个人喜好。然后，你的第一条评论是波兰语——我建议你总是用英文写所有评论、变量名等，因为每个人都会理解它。然后在 register 方法中，您将变量分配给类的属性，但您之前没有声明它们（或者至少您没有在代码中向我们展示它）。同样在插入查询中你' 重新尝试将 emtpy 字符串 '' 插入 id 字段（我假设它是唯一的、非空的无符号整数，带有 auto_increment - 如果是，则不应将其包含在查询中）。我会这样写你的代码：

```
class AccountActions
{
    protected $Username;
    protected $Password;
    protected $Email;
    protected $DB;

    public function __construct()
    {
        $this->DB = //instantiate your database driver of choice here, e.g. mysqli
    }

    public function register($Username, $Password, $Email)
    {
        //We escape the provided values and populate the object's properties with them
        $this->Username = mysql_real_escape_string($Login);
        $this->Password = mysql_real_escape_string($Password);
        $this->Email = mysql_real_escape_string($Email);
        //Hash password
        $this->Password = md5(sha1($this->Password));
        $Query = "INSERT INTO radio_users(username, password, email) 
                  VALUES('$this->Username', '$this->Password', '$this->Email')";
        $this->DB->simplequery($Query);    
    }
} 
```

> 如何将我的数据库类加入我的帐户类？

不确定你在这里的意思，但是如果你想访问你的类中的一些数据库驱动程序，你应该添加一个属性来存储数据库驱动程序并在构造函数中实例化它（或者你可能有一个静态属性来保存数据库驱动程序）。

也不确定你在标题问题中的意思 - 如果你想使用内部类（在另一个类中声明的类） - 它们在 PHP 中不可用。

我还鼓励你在学习了基本的 OOP 之后再学习一些 PHP 框架——Zend 框架是我的最爱。

# linux - 如何在bash中获取退出状态循环

> ID：14059342
> 
> 赞同：15
> 
> 时间：2012-12-27T18:22:18.367
> 
> 标签：linux, bash, shell

我知道如何使用 $? 检查先前执行的命令的状态，我们可以使用 exit 命令来获得该状态。但是对于 bash 中的循环总是返回状态 0 并且有什么方法可以用某种状态打破循环。

```
#!/bin/bash
while true
do
        if [ -f "/test" ] ; then
                break ### Here I would like to exit with some status
        fi

done
echo $?  ## Here I want to check the status. 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-12-27T18:37:34.057

循环的状态是执行的最后一个命令的状态。可以使用 break 跳出循环，但是如果 break 成功，则循环的状态为`0`. 但是，您可以使用子shell 并退出而不是中断。换句话说：

```
for i in foo bar; do echo $i; false; break; done; echo $?  # The loop succeeds
( for i in foo bar; do echo $i; false; exit; done ); echo $? # The loop fails 
```

您还可以将循环放在一个函数中并从中返回一个值。例如：

```
in() { local c="$1"; shift; for i; do test "$i" = "$c" && return 0; done; return 1; } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-27T18:37:34.007

像这样的东西？

```
while true; do
    case $RANDOM in *0) exit 27 ;; esac
done 
```

还是像这样？

```
rc=0
for file in *; do
    grep fnord "$file" || rc=$?
done
exit $rc 
```

真正的问题是在一次迭代失败时决定循环的退出代码是成功还是失败。在某些情况下，一种情况比另一种更有意义，而另一些情况则完全不明确。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-12-03T08:37:05.073

bash手册说：

```
while list-1; do list-2; done
until list-1; do list-2; done
  [..]The exit status of the while and until commands is the exit status
  of the last command executed in list-2, or zero if none was executed.[..] 
```

在循环*内*执行的最后一个命令是`break`. 退出值为`break`0（见：）`help break`。

这就是为什么您的程序一直以 0 退出的原因。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-12-03T09:04:53.220

我想你应该问的是：*我怎样才能等到文件或目录（`/test`）被另一个进程创建？*

到目前为止，您正在做的是全功率轮询。您的循环将分配多达 100% 的一个内核的处理能力。关键字是“投票”，按照计算机科学家的标准，这在道德上是*错误的。*

有两种补救措施：

1.  在循环中插入一个 sleep 语句；优点：非常简单；缺点：延迟将是 CPU 负载和响应能力之间的任意权衡。（“任意”在道德上也是错误的）。
2.  使用通知机制，如`inotify`（见：）`man inotify`；优点：没有 CPU 负载，响应速度快，没​​有延迟，代码中没有任意常量；缺点：`inotify`是一个内核 API——你需要一些代码来访问它：`inotify-tools`或者一些 C/Perl/Python 代码。看看[inotify 和 bash](https://stackoverflow.com/questions/7542430/inotify-and-bash)！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-01-17T19:04:14.367

bash 内置的 break 确实允许您完成您正在做的事情，只需使用负值和 $? 返回的状态中断即可。将是 1：

```
while true
do
    if [ -f "./test" ] ; then
            break -1
    fi
done
echo $?  ## You'll get 1 here.. 
```

请注意，这记录在内置 break 的帮助中：

```
help break 
```

> break: break [n] 退出 for、while 或 until 循环。
> 
> 退出 FOR、WHILE 或 UNTIL 循环。如果指定了 N，则中断 N 个封闭循环。
> 
> 退出状态：退出状态为 0，除非 N 不大于或等于 1。

您可以跳出 n 次循环或发送一个负值以进行非零返回，即 1

我同意@hagello 作为睡眠和改变循环的一种选择：

```
#!/bin/bash
timeout=120
waittime=0
sleepinterval=3
until [[ -f "./test" || ($waittime -eq $timeout) ]]
do
   $(sleep $sleepinterval)
   waittime=$((waittime + sleepinterval))
   echo "waittime is $waittime"
done

if [ $waittime -lt $sleepinterval ]; then
    echo "file already exists"
elif [ $waittime -lt $timeout ]; then
    echo "waited between $((waittime-3)) and $waittime seconds for this to finish..."
else
    echo "operation timed out..."
fi 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-06-01T15:53:47.280

我想提交一个更简单且我认为更优雅的替代解决方案：

```
(while true
 do
    if [ -f "test" ] ; then
        break
    fi  
 done

Of course of this is part of a script then you could user return 1 instead of exit 1
 exit 1
)
echo "Exit status is: $?" 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-05-01T18:24:48.900

Git 2.27（2020 年第二季度）很好地说明了循环中的退出状态，这里是在提前中止失败的测试（例如通过退出循环）的上下文中，即“返回 1”。

请参阅[Junio C Hamano ( ) 的](https://github.com/gitster)[提交 7cc112d](https://github.com/git/git/commit/7cc112dc95fd75ba230ad424de622c9d1c1a8b73)（2020 年 3 月 27 日[）](https://github.com/gitster)。^(（由)^([Junio C Hamano 合并 --](https://github.com/gitster)) ^([--](https://github.com/gitster))^在^([提交 b07c721](https://github.com/git/git/commit/b07c72100f88315d6abef235cee7428fca0886b5))^(中，2020 年 4 月 28 日）)[`gitster`](https://github.com/gitster)
^([`gitster`](https://github.com/gitster))

> ## [`t/README`](https://github.com/git/git/commit/7cc112dc95fd75ba230ad424de622c9d1c1a8b73): 建议如何在失败的情况下提前离开测试
> 
> ^(帮助者：杰夫·金)
> 
> 随着时间的推移，我们向我们的测试框架添加了支持，以使早期失败的测试变得容易，但它没有明确记录在`t/README`帮助开发人员编写新测试的过程中。

该[文档现在包括](https://github.com/git/git/blob/7cc112dc95fd75ba230ad424de622c9d1c1a8b73/t/README#L553-L585)：

> ## 循环时要小心
> 
> 您可能需要在一个循环中验证多项内容，但以下内容无法正常工作：
> 
> ```
> test_expect_success 'test three things' '
>     for i in one two three
>     do
>       test_something "$i"
>     done &&
>     test_something_else
> ' 
> ```
> 
> 因为**循环本身的状态就是`test_something`上一轮**`test_something`的退出状态，所以“for `one`”或“ ”失败时循环不会`two`失败。
> 这不是你想要的。
> 
> 相反，您可以在看到失败时立即跳出循环。
> 因为所有`test_expect_*`的代码片段都在一个函数内执行，所以“ `return 1`”可以用来在失败时立即使测试失败：
> 
> ```
> test_expect_success 'test three things' '
>     for i in one two three
>     do
>       test_something "$i" || return 1
>     done &&
>     test_something_else
> ' 
> ```
> 
> 请注意，我们仍然`&&`-chain 循环以传播早期命令的失败。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-07-10T04:04:22.563

使用人工退出代码

在打破循环之前设置一个变量，然后检查该变量作为循环的状态代码，如下所示：

```
while true; do 
  if [ -f "/test" ] ; then
     {broken=1 && break; };
  fi
done
echo $broken #check the status with [[ -n $broken ]] 
```

# aloha-editor - 如何在 Aloha 编辑器的工具栏中添加删除线按钮？

> ID：14059345
> 
> 赞同：0
> 
> 时间：2012-12-27T18:22:38.493
> 
> 标签：aloha-editor

我能够添加带下划线的“u”；但我无法添加删除线“del”。

```
<script type="text/javascript" src="https://cdn.aloha-editor.org/latest/lib/require.js"></script>
<script src="https://cdn.aloha-editor.org/latest/lib/aloha.js" data-aloha-plugins="common/characterpicker,common/format,common/link,common/list,common/paste,common/undo,extra/formatlesspaste"></script>
<link href="https://cdn.aloha-editor.org/latest/css/aloha.css" rel="stylesheet" type="text/css" />
<script type="text/javascript">

var Aloha = window.Aloha || ( window.Aloha = {} );

Aloha.settings = {
    plugins: {
        format: { config : [ "strong", "em" ,"u","del", "s", "p", "h1", "h2", "h3", "h4", "h5", "h6", "pre", "removeFormat"] }
    },
    sidebar: { disabled: true }
};

Aloha.ready( function() {
    Aloha.jQuery(".editable").aloha();
});
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T12:09:24.840

需要在加载/包含 aloha.js 文件之前完成配置 (Aloha.settings = ...)。

参考：[https ://getsatisfaction.com/aloha_editor/topics/strikethrough_button_missing_from_toolbar](https://getsatisfaction.com/aloha_editor/topics/strikethrough_button_missing_from_toolbar)

# c# - 使用 Web 表单中的 Xml 数据对 XML 进行 XSLT 转换

> ID：14059348
> 
> 赞同：0
> 
> 时间：2012-12-27T18:22:49.553
> 
> 标签：c#, asp.net, xml, xslt

网上有很多使用 XSLT 文件将 XML 文件转换为不同格式的示例，如下所示：

```
XslTransform myXslTransform = new XslTransform();
XsltSettings myXsltSettings = new XsltSettings();
myXsltSettings.EnableDocumentFunction = true;
myXslTransform.Load("transform.xsl");
myXslTransform.Transform("input.xml", "output.xml"); 
```

但是，这只是部分答案，我希望能够从 Web 表单中获取 XML 输入数据并将其用作输入 xml 数据而不是“.xml”文件，但还没有找到任何具体示例。使用 Visual Studio，我看到了接受 XmlReader 对象作为参数的 Load 方法，但我不知道如何使用表单和 TextBox 控件中的数据创建其中一个。如果有人可以提供一个使用表单数据而不是输入文件转换 XML 的示例，那将非常有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T18:55:46.077

请注意，`XslTransform`自 .NET 2.0 以来已过时，您应该`XslCompiledTransform`改用它。如果您想使用，请`XslSettings`确保将它们传递给`XslCompiledTransform`'`Load`方法（例如[http://msdn.microsoft.com/en-us/library/ms163425.aspx](http://msdn.microsoft.com/en-us/library/ms163425.aspx)），简单地创建它是没有意义的。

至于解析XML，你有一个字符串变量或属性（如`Text`a 的属性`TextBox`）你有很多选项，你可以使用 a `XmlReader`over a`StringReader`例如

```
XslCompiledTransform proc = new XslCompiledTransform();
proc.Load("sheet.xsl");

using (StringReader sr = new StringReader(TextBox1.Text))
{
  using (XmlReader xr = XmlReader.Create(sr))
  {
    proc.Transform(xr, null, Response.Output);
  }
} 
```

或者，您可以从字符串创建一个`XPathDocument`或`XmlDocument`或，并使用将 an作为第一个参数的方法的重载。`XDocument``Transform``IXPathNavigable`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T18:48:45.863

创建一个类并在从表单数据回发期间填充此类的一个实例并将其序列化（将其转换为 xml）

这是您的控制台示例

```
using System;
using System.Collections.Generic;

using System.Text;

using System.Xml.Serialization;

namespace Stackoverflow
{

    public class Program
    {

        static void Main(string[] args)
        {

          var p = new Person
            {
                FirstName = "Daniel",  /// in your case you get it from the form
                LastName = "Endeg"

            };

            var x = new XmlSerializer(p.GetType());
            x.Serialize(Console.Out, p);
            Console.WriteLine();
            Console.ReadLine();
        }
    }

    public class Person
    {
        public string FirstName { get; set; }

        public string LastName { get; set; }
    }
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-27T19:21:29.813

好的，在 Visual Studio 自动完成功能的帮助下，它列出了构造函数和方法的参数，我能够在 Xslt 转换操作中使用字符串作为输入和输出来完成上述问题的工作答案。耶。下面的示例答案假设您有三个包含 Xslt 文本数据和输入 Xml 文本数据和输出 Xml 数据的字符串：

```
string XsltText;
string InputXML;
string OutputXml;

// define the xslt from a string
TextReader myXsltText = new StringReader(XsltText);
XmlReader myXslt = new XmlTextReader(myXsltText);

// define the input xml from a string
TextReader myXmlText = new StringReader(InputXML);
XmlReader myInputXml = new XmlTextReader(myXmlText);

// define the output XmlWriter for the results of the transform
TextWriter myOutputXmlTextWriter = new StringWriter();
XmlWriter myOutputXml = new XmlTextWriter(myOutputXmlTextWriter);

XslCompiledTransform myXslTransform = new XslCompiledTransform();
XsltSettings myXsltSettings = new XsltSettings();
myXsltSettings.EnableDocumentFunction = true;
myXslTransform.Load(myXslt);
myXslTransform.Transform(myInputXml, myOutputXml);

// the result from the transform comes from the TextWriter object
OutputXml = myOutputXmlTextWriter.ToString();

// clean up writers
myOutputXml.Flush();
myOutputXmlTextWriter.Close();
myOutputXml.Close(); 
```

要使此代码与 Web 表单一起使用，您所要做的就是从表单元素（控件）的值（文本）中获取字符串，对于输入 XMl 和 Xslt，您可以使用 TextBox 控件，并显示结果您可以使用标签，所有这些都非常有用，如果有人有更好的答案，请随时告诉我。

# php - 如果表为空，则无法注册新用户

> ID：14059350
> 
> 赞同：0
> 
> 时间：2012-12-27T18:22:54.063
> 
> 标签：php, user-registration

```
$query = "SELECT username, email
              FROM members
              WHERE username = :username OR email = :email";
    $stmt = $sql->prepare($query);
    $stmt->execute(array(
        ':username' => $_POST['username'],
        ':email' => $email
    ));

    $existing = $stmt->fetchObject();

    if ($existing)
    {
        if ($existing->username == $_POST['username'])
        {
            $errors['username'] = "Username already in use !";
        }
        if ($existing->email == $email)
        {
            $errors['email'] = "Mail already in use !";
        }
    } 
```

这是 register.php 文件的一部分。不确定这部分是否对问题负责，但我想。
因此，`if table members is empty`提交了表单 - Firefox 大约半分钟显示它是 busy-gif，但没有注册新用户就结束了，也没有显示任何错误。只是继续冷冻。
然后我按`F5`- 出现一个批准重新发送信息的窗口 - 单击`Resend`- 新用户已注册。
`If the table`成员`is not empty`- 一切正常。
似乎 - 问题是因为上面的代码正忙于查找不存在的数据。
`If so`，如何告诉类似 - 如果表是空的 - 停止尝试 - 只需注册新用户。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T18:36:05.823

我很确定`$existing = $stmt->fetchObject();`会为您获取一个空对象，但不会隐式评估为`false`. 之后，您的代码中没有任何内容会触发，从而导致您的空白输出。

尝试`var_dump($existing)`查看您的代码实际运行的内容。

## 编辑

```
$existing = $stmt->fetchObject(); //this might be returning an empty object

if ($existing) { //empty objects evaluate to true
    if ($existing->username == $_POST['username']) {
        $errors['username'] = "Username already in use !";
    } else if ($existing->email == $email) {
        $errors['email'] = "Mail already in use !";
    } else {
        //this will trigger if something ELSE is wrong other than what you're explicitly checking for.
        $errors['other'] = "Something else is wrong.\n" . var_export($existing, TRUE);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T18:26:02.107

应该`$email`是`$_POST['email']`？什么是完整的代码 - 你这里没有右`if`括号。`$existing`在这种情况下，只有在为真时才会执行之后的所有内容。所以第一次，什么都不会显示。另外，最好使用数据库约束来确保没有像[MySQL 这样的重复项 - 在创建表时一起使用“PRIMARY KEY”、“UNIQUE KEY”和“KEY”的含义](https://stackoverflow.com/questions/10908561/mysql-meaning-of-primary-key-unique-key-and-key-when-used-together)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-27T18:31:09.393

应该注意的是，从安全的角度来看，向潜在的攻击者确认您的系统中存在用户名或电子邮件地址通常是一个坏主意。这大概会给他们一半的信息来对您的登录名执行字典攻击。

我会让表中的用户名和电子邮件字段具有唯一索引，然后直接插入。如果插入失败是因为其中一个唯一性约束不允许，只需给用户一条关于无法注册的通用消息。

这也会为您节省大量不必要的数据库查询。

# xml - 如何解决 HTTP 错误 404.8？

> ID：14059355
> 
> 赞同：21
> 
> 时间：2012-12-27T18:23:20.623
> 
> 标签：xml, flash, webserver

我们最近移动了服务器，现在曾经工作的闪存无法工作，因为它无法识别 xml 文件。这是详细的错误：

```
Server Error in Application

Internet Information Services 7.5 Error Summary HTTP Error 404.8 - Not Found The request filtering module is configured to deny a path in the URL that contains a hiddenSegment section. Detailed Error Information ModuleRequestFilteringModule NotificationBeginRequest HandlerStaticFile Error Code0x00000000 Requested URLhttp://obscured.xml Physical PathD:\home\obscured.xml Logon MethodNot yet determined Logon UserNot yet determined 
```

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-12-27T18:32:59.247

该问题是由 IIS 保护您请求的文件引起的。

默认情况下，IIS 设置一个过滤器来拒绝对具有特定名称（例如 等）的文件的请求`app_data`，`bin`以保护 Web 应用程序。这是通过 IIS 中的隐藏段控件完成的。您的应用似乎受此影响。

理想情况下，您应该更改您请求的文件的名称。

但是，如果您不能这样做，请参阅[此处的文章](http://www.iis.net/configreference/system.webserver/security/requestfiltering/hiddensegments)，了解如何删除它的步骤。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2018-01-03T21:30:34.807

在我的例子中，我有一个应用程序，它有一个称为 bin 的业务对象。你能猜到发生了什么吗？我的 BinController 的 url 是[http://localhost:6537/bin/index](http://localhost:6537/bin/index)

显然，RequestFiltering 有一个条目拒绝访问 bin 文件夹，因此该请求甚至在到达 MVC 路由引擎之前就被阻止了。

我只是将我的控制器重命名为 BinsController 并且[http://localhost:6537/bins/index](http://localhost:6537/bins/index) 工作得很好。

# python - 已安装的 Python 包的不同文件结构的后果是什么？

> ID：14059358
> 
> 赞同：1
> 
> 时间：2012-12-27T18:23:35.393
> 
> 标签：python, configuration, package

我的目录中安装的软件包`site-packages`以多种方式组织。有些有（1）形式

*   一个与包名完全一样的目录
*   一个 egg-info 文件（以包和版本命名）

而其他 (2) 有

*   一个与包名完全一样的目录
*   一个`egg-info` *目录*（以包和版本命名）

还有其他人（3）有

*   只是一个`egg`以包和版本命名的目录（以及`easy_install.pth`文件中的相应条目）。

是什么决定了这些方法中的哪一种？它是我用来安装的工具或方法（例如，来自源代码与来自二进制文件）的结果吗？这些方法中的每一种都可以由所有工具（例如`easy_install`vs. `pip`）维护还是彼此不兼容？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-27T21:01:01.793

不幸的是，Python 中很久没有出现正确的单向打包方式了。因此，如果您需要直接访问您的站点包目录（我假设您正在使用 virtualenv 或提供对守护进程的访问），您需要手动设置 PATH 变量。

您可以在The [Hitchiker's Guide to Packaging](http://guide.python-distribute.org/)中查看包装所需`easy_install`的所有信息`pip``distutils``mod_wsgi`

# xpages - SSJS 全局变量似乎不起作用

> ID：14059359
> 
> 赞同：1
> 
> 时间：2012-12-27T18:23:42.190
> 
> 标签：xpages, xpages-ssjs, xpages-extlib

我在 ssjs 库中声明并使用了一个全局变量，如下所示：

```
var backendDoc:NotesDocument = null;

function savedata () {
  print (backendDoc.getItemValueString("fieldname"));   // crash here  
} 
```

在将文档模式从读取更改为编辑后，我在编辑按钮中为其分配了一个文档对象：

backendDoc = document1.getDocument(); // 从名为 document1 的数据源获取后端文档

上述函数中的代码返回错误 NotesDocument.getItemValueString("string")) null。显然，backendDoc 为空。

任何想法如何在 ssjs 库中分配值和使用全局变量？提前致谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-28T02:04:23.890

您的代码有两个问题：

*   正如迈克尔指出的那样：您应该使用范围变量。脚本库中的全局变量实际上是应用程序全局变量（想想 applicationScope），如果内存紧张，可能随时被卸载（它们的行为取决于 XPages 版本）

*   您不能在此处使用 NotesObjects。在调用之间，支持 JS 对象的 C 对象被释放并且您的对象变得无效。

您可以将 NoteId 存储在范围变量中并每次检索 NotesDocument 或实际使用 JSON 结构来保留您感兴趣的值，并且仅在实际需要时读取/写入（加载/保存事件）。希望这可以帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T18:54:42.317

我认为您必须使用一个范围变量来存储文档的universalid。然后可以在任何脚本中使用它来初始化后端文档。

在 ssjs 中，您可以使用 put 方法和 get 方法设置作用域变量来读取变量。在会话范围内设置和读取范围变量的示例：

```
sessionScope.put(“myvar“,“myvalue“)
sessionScope.get(“myvar“) 
```

要了解有关范围变量的更多信息，请观看此 [http://notesin9.com/index.php/2009/11/07/episode-4-intro-to-scoped-variables/](http://notesin9.com/index.php/2009/11/07/episode-4-intro-to-scoped-variables/)

# symfony - 语言环境 app/Resource/view/base.html.php Symfony2

> ID：14059362
> 
> 赞同：0
> 
> 时间：2012-12-27T18:23:53.620
> 
> 标签：symfony, locale

如何翻译我的`base.html.php`布局？

```
<!-- app/Resources/views/base.html.php -->
<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Title</title>
    </head>
    <body>
        <?php echo $view['translator']->trans('Bye'); ?>
        <div id="content">
            <?php $view['slots']->output('body') ?>
        </div>
    </body>
</html> 
```

```
<!-- app/Resources/translations/messages.de.xliff -->
<?xml version="1.0"?>
<xliff version="1.2" xmlns="urn:oasis:names:tc:xliff:document:1.2">
    <file source-language="en" datatype="plaintext" original="file.ext">
        <body>
            <trans-unit id="1">
                <source>Bye</source>
                <target>Auf Wiedersehen.</target>
            </trans-unit>
        </body>
    </file>
</xliff> 
```

我的 bundle 也有`src/../Bundle/../translation/messages.de.xliff`。这工作正常。它以`id="1"`.

那么我怎样才能让翻译在 base.html.php 中工作呢？

是否可以在 html 中更改具有不同语言环境的图片？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T19:27:45.153

您可以将任何您想要的内容作为目标字符串，因此可以使用 url：

```
<?xml version="1.0"?>
<xliff version="1.2" xmlns="urn:oasis:names:tc:xliff:document:1.2">
    <file source-language="en" datatype="plaintext" original="file.ext">
        <body>
            <trans-unit id="1">
                <source>foo_image</source>
                <target>images/foo.de.png</target>
            </trans-unit>
        </body>
    </file>
</xliff> 
```

```
<img src="<?= $view['translator']->trans('foo_image') ?>"> 
```

# selenium - Python selenium 可以用来点击网页标签吗？

> ID：14059367
> 
> 赞同：0
> 
> 时间：2012-12-27T18:24:15.090
> 
> 标签：selenium, python-2.7, selenium-webdriver

我正在处理页面上太多的第三方应用程序`labels`用作链接或导航到另一个页面。那么python是否可以执行此类任务或读取页面选择列表值？

我正在使用 python 2.7 和硒。

**编辑**

有一个标签叫`configuration`见下面对应的代码：

```
<td class="tabtext-unsel"><nobr><a href="/aems/configuration/configurationlist.do" class="tabtext-unsel">Configuration</a></nobr></td>
                <td class="unselected_tab_mid"><img src="/simpletrade/default/images/background/spacer.gif" width="16" height="25"></td> 
```

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T19:58:13.263

是的，它可以。标签在 HTML 中实现为`<LABEL FOR="field_id">label text</LABEL>`，您可以在 Selenium 的 XPath 定位器中使用它。

* * *

（问题编辑后更新）

这不是 HTML 中的标签，但仍然可以使用 XPath 定位器。这甚至不是特别困难。两个`<TD>`元素都是同一个元素的子`<TR>`元素，所以这样的事情就可以完成：`//tr[td/a[.='Configuration']]/td/img`匹配`<IMG>`元素。但是，如果您只想找到链接，那就更容易了：`//tr/td/a[.='Configuration']`

# javascript - Enable checkbox if text field is not empty with inconsistent id

> ID：14059369
> 
> 赞同：0
> 
> 时间：2012-12-27T18:24:33.343
> 
> 标签：javascript, jsp, checkbox

Purpose is to have checkboxes disabled when the page loads, and remain greyed out until textbox is filled.

```
<input type="text" name="<%=commentID%>" />
<input type="checkbox" name="<%=SkipID%>" value="N" disabled/> 
```

I tried to do something like

```
<input type="text" name="<%=commentID%>" onkeyup="userTyped('<%=SkipID%>') />

function userTyped(commen){
    if(this.value.length > 0){
        document.getElementById(commen).disabled=false;
    }else{
        document.getElementById(commen).disabled=true;
    }
 } 
```

But it did not work. I am assuming because of the inconsistency of the name, but I have to have that.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T18:35:46.600

You haven't given id to your html elements and is trying to use `getElementById`, which will return `null`. Javascript engine will not be able to set **disabled** attribute of `null`. Try setting **id** attribute, for elements as given below.

Also in your userTyped function you are referencing `this`. `this` here is the `window` object and not the input element. You need to pass the reference to input element to make this work, like this `onkeyup="userTyped('<%=SkipID%>', this)"`

Please find a possible correction below:

```
<input type="text" name="<%=commentID%>" id="<%=commentID%>" onkeyup="userTyped('<%=SkipID%>', this)" />
<input type="checkbox" name="<%=SkipID%>" id="<%=SkipID%>" value="N" disabled/>

/** commen is the id
  * e is the input element
  **/
function userTyped(commen, e){
    if(e.value.length > 0){
        document.getElementById(commen).disabled=false;
    }else{
        document.getElementById(commen).disabled=true;
    }
 } 
```

jsFiddle here: [http://jsfiddle.net/deepumohanp/dGS9H/](http://jsfiddle.net/deepumohanp/dGS9H/)

# ios - Dropbox API 请求模式

> ID：14059375
> 
> 赞同：1
> 
> 时间：2012-12-27T18:25:10.597
> 
> 标签：ios, sync, dropbox

我在 iOS 上使用 Dropbox SDK，并在本地镜像远程目录。我了解基本的使用模式 - 提出请求，等待代表被调用结果。

当我有大量请求要执行时，我应该通过在进行下一次调用之前等待结果来序列化它们，还是一次发出所有请求然后等待它们每个进来？Dropbox SDK 是否智能地处理后一种情况（例如使用`NSOperationQueue`），还是我自己做这个更好？

如果我更好地处理自己排队的请求，当用户使用 wifi 与蜂窝连接时，我应该改变行为吗？

编辑：我见过[CHBgDropboxSync](https://github.com/chrishulbert/CHBgDropboxSync "CHBgDropboxSync")和其他现有的解决方案。我的应用程序需要比这些提供更多的同步控制，所以我需要自己动手。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T00:37:12.393

取决于您需要提出多少请求以及它们相互依赖的程度。使用 GCD 或`NSOperation`菊花链请求，您可以一次发出所有请求并将信号量保留在程序中，或者您可以让请求依赖其他人来完成。您正在创建一个异步状态机，其设计将取决于该状态机是动态的还是静态的。

# java - 在android中解析href内容的文本

> ID：14059378
> 
> 赞同：0
> 
> 时间：2012-12-27T18:25:18.460
> 
> 标签：java, android, html

我有以下文字

他的目的是确认您已成功更改您对 Buy.com 电子邮件订阅的偏好。请等待 5 到 7 个工作日让此更改完全生效。

如果您想再次更改您的偏好，请通过以下方式进行：

https://ssl.buy.com/AC/EmailPreferenceCenter.aspx?EmailAddr=xxx.com />

Buy.com 意识到您在网上购物有很多选择，感谢您的光临！如有任何其他问题或疑虑，请随时联系 Buy.com，我们很乐意为您提供帮助。

真挚地，

Rakuten Buy.com 客户支持

**我想将消息显示为**

他的目的是确认您已成功更改您对 Buy.com 电子邮件订阅的偏好。请等待 5 到 7 个工作日让此更改完全生效。

如果您想再次更改您的偏好，请通过以下方式进行：

https://ssl.buy.com/AC/EmailPreferenceCenter.aspx?EmailAddr=xxx.com

Buy.com 意识到您在网上购物有很多选择，感谢您的光临！如有任何其他问题或疑虑，请随时联系 Buy.com，我们很乐意为您提供帮助。

真挚地，

Rakuten Buy.com 客户支持

我尝试了以下方法：

text.setTextHtml.fromHtml(htmlText));

但这不会保留段落格式、换行符等样式。那么，当我的文本引用了 href 时，如何实现这种样式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T19:19:15.587

您应该使用 spans ：搜索“android spans”或查看以下链接

# php - 计算 CSV 列中相似值的数量

> ID：14059379
> 
> 赞同：2
> 
> 时间：2012-12-27T18:25:27.447
> 
> 标签：php, csv

我有几个 .csv 文件，我试图循环并读取特定列的值，并计算每个值出现的频率。例如，其中一个文件中的第三列，我们将其命名为`$col[2]`，如下所示：

```
HEADER
foo
bar
bar
bar
foo 
```

我可以计算次数`foo`并`bar`使用以下代码出现在文件中：

```
$file = ('Path/To/Random/File.txt');

$fh = fopen($file, 'rb');

$tag = array();
while($col = fgetcsv($fh)) {
    $tag[$col[2]]++;
}

print_r($tag);

Result:

5 
```

但是，此代码返回 中所有值的计数`col[2]`。如何指定我想要的数量`foo`和`bar`值，只拆分为哪个计数属于哪个值？例如，结果将如下所示：

```
echo $foo_count;
echo $bar_count;

Result:

2
3 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T18:30:32.210

我会做：

```
$file = ('Path/To/Random/File.txt');

$fh = fopen($file, 'rb');

$tag = array();
while($col = fgetcsv($fh)) {

if (isset($tag[$col[2]])) {
   $tag[$col[2]]++;
}
else {
   $tag[$col[2]] = 1;
} 
```

确保`$col[2]`实际包含您要测量/迭代的值

一旦你应该有一个像这样的数组，`print_r`用来检查

```
'foo' => 2,
'bar' => 3 
```

# php - 使用 ajax 更改会话变量

> ID：14059380
> 
> 赞同：1
> 
> 时间：2012-12-27T18:25:40.147
> 
> 标签：php, ajax, session

好的，所以我不太明白如何做到这一点，但这就是我想要做的。我需要更新在网站上多个地方使用的 SESSION。我使用 ajax 执行此操作，但是当我更改 SESSION 时，它在网站中与 ajax 调用之前保持相同。这是一个例子：

索引.php

```
<?php
session_start();
?>

<script>
function sessionUpdate()
{ 
//Do a get ajax call that send the 2 parameters to updateSession.php
}
</script>

<?php
$_SESSION['foo'] = "foo"; 
$_SESSION['bar'] = "bar"; 

echo"<div>";
echo"<p  onclick="sessionUpdate()>Update Session</p>";

echo"{$_SESSION['foo']} {$_SESSION['bar']}";
echo"</div>";
?> 
```

更新会话.php

```
<?php
session_start();

$_SESSION['foo'] = "new foo"; 
$_SESSION['bar'] = "new bar";
?> 
```

现在，整个站点都使用了会话，所以我不能只用 innerHTML=data.responseText; 替换示例 div 中来自 ajax 调用的信息；就在那个地方。无论如何，当我这样做时， foo 和 bar 会话的回声不会改变，它们只是静态变量，如果不重新加载页面就无法更改，还是有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T18:58:35.137

据我了解，您打开`index.php`并且示例 div 包含会话变量的默认值（在您的示例中为“foo bar”）。单击更新会话后，`innerHTML=data.responseText`您可以看到更新的会话值（根据示例为“new foo new bar”）。但是在您重新加载 index.php 后 - 它再次显示“foo bar”。根据您的代码，您不检查是否应该设置默认会话变量。尝试在你的 index.php 中替换

```
<?php
$_SESSION['foo'] = "foo"; 
$_SESSION['bar'] = "bar"; 

echo"<div>"; 
```

和

```
<?php
if(!isset($_SESSION['foo']))
   $_SESSION['foo'] = "foo"; 
if(!isset($_SESSION['bar']))
   $_SESSION['bar'] = "bar"; 

echo"<div>"; 
```

更新的代码将检查是否设置了会话变量（用户第一次打开 index.php）。一旦未设置 - 将分配默认值，但一旦完成，它将不会覆盖任何未来的更改（因此，在 ajax 调用 foo 和 bar 变量将被设置并且您的代码不会重写其值）

# c# - MVVM 设置 MenuItem 的 DataContext

> ID：14059381
> 
> 赞同：1
> 
> 时间：2012-12-27T18:25:41.513
> 
> 标签：c#, xaml, mvvm, datacontext, menuitem

我有一个 ListView，其中包含来自字符串列表的 ItemSource。现在我添加了一个上下文菜单，它应该只实现一些命令。但问题在于如何设置 DataContext。找到了一些解决方案，但没有一个对我有用。不知道我的错在哪里。

这是我的 XAML 代码，减少到重要区域。

```
 <ListView x:Name="lstBackups" ItemsSource="{Binding SelectedClient.Backups}">
        <ListView.ItemContainerStyle>
            <Style TargetType="ListBoxItem">
                <Setter Property="ContextMenu">
                    <Setter.Value>
                        <ContextMenu>
                            <MenuItem Header="Do Something"                                           DataContext="{Binding RelativeSource={RelativeSource AncestorType=ContextMenu}}"
                                      cinch:SingleEventCommand.RoutedEventName="MouseLeftButtonUp"
                                      cinch:SingleEventCommand.TheCommandToRun="{Binding Path=DataContext.OpenBackupInExplorerCommand, ElementName=UserControl}">
                            </MenuItem>
                        </ContextMenu>
                    </Setter.Value>
                </Setter>
            </Style>
        </ListView.ItemContainerStyle>
    </ListView> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T20:58:25.137

我确定您已经注意到 ContextMenu 与您的用户控件不是同一可视化树的一部分（我知道这很烦人）。所以你必须对你的绑定逻辑有点创意。

尝试将命令绑定更改为以下

```
cinch:SingleEventCommand.TheCommandToRun="{BindingPath=PlacementTarget.DataContext.OpenBackupInExplorerCommand, 
                                           RelativeSource={RelativeSource FindAncestor, 
                                                                          AncestorType={x:Type ContextMenu}}}" 
```

那应该尝试获取应该继承 UserControl 的 DataContext 的放置目标（在您的情况下为 ListView）的 DataContext

希望这会奏效。

# javascript - django后端的客户端vs服务器端vs混合模板

> ID：14059391
> 
> 赞同：2
> 
> 时间：2012-12-27T18:26:11.733
> 
> 标签：javascript, django, handlebars.js, mustache, client-side-templating

我想知道是否值得转换为更通用的模板引擎，例如 mustache 或 handlebars 而不是 Django 模板。我自己看到的选项是：

1.  使用 Django 模板（仅限服务器端）
2.  完全转换为 Mustache/Handlebars 等
3.  使用混合方法：Mustache/Handlebars 以及在适用的情况下使用 Django 模板（最丑的选项？）

尽管转换为像系统这样的 Mustache/Handlebars 为我在客户端和服务器端使用相同模板带来了灵活性，但我确实失去了 Django 模板系统提供的某些优势（例如模板继承）。

我知道有支持和反对客户端模板以及服务器端模板的激烈争论。一些人认为在繁忙的服务器上渲染 HTML 可能会使其变慢，而另一些人则认为在浏览器上从 JSON 渲染 HTML 可能会使客户端变慢。

我也知道为非 javascript 启用的设备使用服务器端 html 渲染的论点，但现在大多数设备都支持 javascript。

从 Django 模板系统转换为 Mustache/Handlebars 等是否有真实而明确的原因？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T07:28:23.860

你的问题并没有真正的具体答案。在我看来，Mustache 风格的客户端模板的优势远远超过了支持服务器端模板的优势。Mustache 风格的客户端模板可移植、可扩展、易于其他开发人员理解，并且适用于所有浏览器（甚至 IE6）。如果您计划让您的 Web 应用程序变得更大，那么当您的页面生成被卸载到用户浏览器而不是在服务器端处理时，您将会感谢您自己。

Django 提供的模板继承被高估了——你可以用 Mustache 模板和一点 JavaScript 来完成同样的事情。不要试图构建大型的包罗万象的模板。将您的模板构建为可重复使用的小型构建块，并使用 JavaScript 将它们拼凑在一起，形成构成您的 Web 应用程序的组件。

当然，当您在客户端上呈现所有内容时，SEO 会受到影响，但这可能对您的应用程序来说是一个问题，也可能不是问题。

# java - 尝试在希伯来语中获取价值时，Java .properties 文件乱码

> ID：14059392
> 
> 赞同：1
> 
> 时间：2012-12-27T18:26:19.300
> 
> 标签：java, encoding

我正在尝试从 .properties 文件中读取希伯来语值，但我得到了胡言乱语。我尝试了几种方法，包括更改文件的编码（Cp1255、ISO-8859-8、UTF-8），将 -file.encoding 添加到参数中，但没有任何帮助。

这个问题是在我们从 IAS（OC4J 容器）迁移到 Weblogic 期间提出的，我注意到 javascript 消息（从 .properties 文件中读取）显示为`???? ???`，这在 OC4J 上不会发生。但是，这仅适用于从 .properties 文件中读取的数据，其他一切都显示得很好。

我已经在谷歌上搜索了几天，但我无法提出解决方案。

编辑：我在家里试过的

```
ResourceBundle rb = ResourceBundle.getBundle("test");
System.out.println(rb.getString("test")); 
```

这就是 test.properties 的样子：

```
test שלום 
```

输出是：`ùìåí`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-27T18:47:02.133

由于您有一个 ResourceBundle 实例，因此您可以获得 ISO-8859-1 编码的字符串：

```
String strISO = rb.getString("test"); 
```

然后，您可以将其转换为 UTF-8 并使用以下命令打印：

```
System.out.println(new String(strISO.getBytes("ISO-8859-1"), "UTF-8")); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-27T18:44:36.107

ResourceBundle 的文件应该采用 ISO 8859-1 编码或 \uXXXX 格式，就像 Properties 一样。[在如何使用 ResourceBundle 在资源属性中使用 UTF-8](https://stackoverflow.com/questions/4659929/how-to-use-utf-8-in-resource-properties-with-resourcebundle)了解更多信息

# backbone.js - 主干.js 示例不会在页面加载时运行，但在调试器中调用时会运行

> ID：14059396
> 
> 赞同：1
> 
> 时间：2012-12-27T18:26:41.863
> 
> 标签：backbone.js, backbone-views, backbone.js-collections

我正在处理一个简单的backbone.js 示例。问题是在页面加载时它没有在页面上显示任何内容。但是，在 Chrome 调试器控制台中，如果我显式调用视图及其 render() 方法，则结果会以正确的 json 数据显示在屏幕上。

任何帮助都会非常非常感谢！

```
var Clients = Backbone.Collection.extend({

    model: Client,
    url: 'api/Contacts'

});

var clients = new Clients();

var UserItemView = Backbone.View.extend({
    tagName: 'li',
    template: _.template($('#contacts-template').html()),
    render: function() {
        this.$el.html(this.template(this.model.toJSON()));
        return this;
    }
});

var UserListView = Backbone.View.extend({
    el: $('#contacts'),

    render: function() {
        this.$el.empty();
        var self = this;

        _.each(this.collection.models, function(model) {
            self.renderItem(model);
        });
    },

    renderItem: function(item) {
        var itemView = new UserItemView({
            model: item
        });

        this.$el.append(itemView.render().el);
    }
}); 
```

下面是 index.html 页面的代码：

```
<ul id="contacts"></ul>

<script id="contacts-template" type="text/template">

    <%= FirstName %> <%= LastName %>

</script>

<script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.4.3/underscore-min.js"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/backbone.js/0.9.2/backbone-min.js"></script>
<script src="scripts/app/app.js"></script>
<script>

    $(document).ready(function () {

        alert('HI'); // I verified this alert works

        clients.fetch();

        var userListView = new UserListView({ collection: clients });

        userListView.render();

    });

</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T18:42:19.900

每个异步调用完成后都应该有一个回调，在这里您尝试在`clients`收集来自服务器的数据之前使用它。我会将代码更改为：

```
$(document).ready(function () {
    alert('HI'); // I verified this alert works
    clients.fetch(
        success: function() {
            var userListView = new UserListView({ collection: clients });
            userListView.render();
        },

        error: function() {
            alert('An error has occurred');
        },
    );
}); 
```

问候，

# asp.net-mvc - 使用 IoC，Singleton 可以注入具有瞬态生命周期的对象吗？

> ID：14059397
> 
> 赞同：6
> 
> 时间：2012-12-27T18:26:43.887
> 
> 标签：asp.net-mvc, dependency-injection, ioc-container

我们有一个 ASP.NET MVC 应用程序，它使用 IoC 将服务引用注入控制器并将存储库引用注入服务。

控制器必须具有瞬态生命周期，因为它们必须根据请求进行实例化。但是，如果每个请求都更新整个 IoC 堆栈，那么这会产生一些开销。我们有比我想要的更多的依赖关系，一种选择是拥有更多的控制器，每个控制器在堆栈中的依赖关系更少。但是，暂且不谈，我的问题是，如果作为单例注入的对象具有具有短暂生命周期的依赖项，那么这些依赖项是否会因为被单例所拥有而本质上被视为单例？

具体来说，如果我们有以下

RepositoryA（需要是瞬态的，因为当前设计在构造函数中注入了用户上下文） ServiceA（单例） ControllerA（瞬态）

像这样实例化：

```
public ServiceA(IRepositoryA repo) {}
public ControllerA(IServiceA service) {} 
```

RepositoryA 本质上会被实例化一次，因为 ServiceA 被实例化了一次吗？

我 99% 肯定答案是肯定的，但只是想确认我必须在这里进行的重构量。

此外，假设服务和存储库没有任何用户/请求特定的实例变量，作为一种设计方法，是否有任何理由不为它们使用单​​例生命周期？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-27T19:34:21.423

> 如果作为单例注入的对象具有具有瞬态生命周期的依赖项，那么这些依赖项是否会由于被单例拥有而本质上被视为单例？

这是正确的。由于此类组件保留其依赖项（通过将其引用存储在私有字段中），因此这些依赖项将与组件本身一样存在。换句话说，它们的生命周期被隐式提升为组件的生命周期（如果它们的生命周期更短）。

如果你有这个，你的 DI 配置肯定是错误的，迟早会出现这个错误。可能只在生产中，几乎从来没有在你的开发机器上：-S。

一般来说，容器管理的所有组件应该只依赖于生命周期等于或长于组件本身的抽象。

一些框架甚至有分析服务来检测这些类型的配置错误。尽管如此，在连接所有依赖项时应该非常小心。一般来说，尽可能将组件配置为瞬态是最安全的，因为瞬态组件允许包含任何生活方式的依赖项。拥有许多瞬态对象通常不会成为性能问题。每个 Web 请求构建一个相当大的对象图通常会足够快（否则尝试切换到[具有更高吞吐量的 DI 框架](http://www.palmmedia.de/Blog/2011/8/30/ioc-container-benchmark-performance-comparison)）。

# c++ - C++ Sizeof 给出了不可预测的结果

> ID：14059400
> 
> 赞同：4
> 
> 时间：2012-12-27T18:26:57.677
> 
> 标签：c++, debugging, visual-c++

> **可能重复：**
> [为什么“sizeof”给出错误的测量值？](https://stackoverflow.com/questions/7351654/why-does-sizeof-give-wrong-measurement)

我有一个名为 CBUFFER_PEROBJECT 的结构：

```
struct CBUFFER_PEROBJECT
{
    D3DXMATRIX Final;
    D3DXMATRIX Rotation;
}; 
```

在另一堂课中，我这样做：

```
...
bd.ByteWidth = sizeof(CBUFFER_PEROBJECT); 
... 
```

我发现 D3DXMATRIX 的大小是 64，所以 64+64 = 128（对吗？）。但是我的编译器在和我开玩笑（Visual C++），因为当我调试程序时，bd.ByteWidth 变成了 132，所以我去了即时窗口（Visual Studio），然后输入：

```
sizeof(D3DXMATRIX) + sizeof(D3DXMATRIX) 
```

结果是：

```
128 
```

但是 bd.ByteWidth 变成了 132，当我在“立即窗口”中输入以下内容时：

```
sizeof(CBUFFER_PEROBJECT) 
```

它给了我：

```
128 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-27T18:35:09.837

是的，您很困惑`D3DMATRIX`并且`D3DXMATRIX`（注意第二种类型中的额外 X）。第一个是 16 个浮点值的普通矩阵（正好是 64 个字节）。后者是一个类，它显然在结构的某处有 4 个字节的额外数据。也许是一个 vtable 或类似的东西。

如果您将代码编译为 C 而不是 C++，则大小将与提供后者结构的头文件相同`typedef D3DMATRIX D3DXMATRIX;`。

请参阅：[D3DXMATRIX](http://msdn.microsoft.com/en-gb/library/windows/desktop/bb172912%28v=vs.85%29.aspx)和[D3DMATRIX](http://msdn.microsoft.com/en-gb/library/windows/desktop/bb172573%28v=vs.85%29.aspx)

编辑：这有点像关于军队的老笑话“如果地图和现实不匹配，那么地图就是正确的”。在这种情况下，如果你不同意编译器，那你就错了。编译器在计算大小时总是正确的。理解为什么编译器得到这个数字，嗯，那是另一回事......通常通过将预期的偏移量与实际发生的情况进行比较来解决，并了解是什么（如果有的话）导致了“差距”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-27T18:37:43.090

您不能仅计算结构的成员大小来计算结构的大小，因为在结构中它还存储了一些额外的信息（程序员不可见）。这就是为什么你得到 132 而不是 128。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-27T18:44:51.617

有时，当编译器评估结构声明时，它们会在字段之间添加填充字节。这是因为某些类型在与长度是其长度的倍数的内存地址对齐时表现更好。

我什至会说你很可能不会在即时窗口中看到这种效果。

鉴于这些理由，这是一个重复的问题。您可以在这里得到更深入的答案：[为什么结构的 sizeof 不等于每个成员的 sizeof 之和？](https://stackoverflow.com/questions/119123/why-isnt-sizeof-for-a-struct-equal-to-the-sum-of-sizeof-of-each-member)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-27T19:45:32.973

在这种情况下，最好假设编译器是正确的。这很可能意味着`CBUFFER_PEROBJECT`您的项目中有两个不同的定义，但定义略有不同。编译器认为定义 A 的大小为 132，而调试器正在查看大小为 128 的定义 B。您可以通过`sizeof(CBUFFER_PEROBJECT)`在每个源文件中创建包含 的值的全局变量来测试这一点。然后，您可以在调试器中检查这些全局变量以查看它显示的内容。

当然，另一种可能性是您的内存被覆盖，而不是由您认为正在设置它的行设置。在这种情况下，像 Purify 或 valgrind 这样的东西可以帮助你找出内存问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-27T20:47:30.813

您可以使用隐藏的 Visual Studio 编译器开关切换到[/d1reportSingleClassLayoutSomeType](http://ntcoder.com/bab/2011/11/15/hidden-vc-compiler-switches-d1reportsingleclasslayoutsometype/)来告诉您编译器布局是什么。按照链接阅读如何使用开关。

我为您的示例代码尝试了它，但我没有“D3DXMATRIX”类型。我确实有“D3DMATRIX”，所以我尝试了一下，得到了：

```
1>  class CBUFFER_PEROBJECT size(128):
1>      +---
1>   0  | _D3DMATRIX Final
1>  64  | _D3DMATRIX Rotation
1>      +--- 
```

因此，如果您使用开关应该能够告诉您结构的确切布局。

# assembly - 如何知道什么是存根？

> ID：14059401
> 
> 赞同：2
> 
> 时间：2012-12-27T18:27:00.520
> 
> 标签：assembly, rmi, mips, corba, stub

当您编写程序时，存根总是意味着同样的事情吗？

> “存根为对象、方法或函数提供替换实现，以消除外部依赖关系。存根通常在单元和组件测试期间使用。如果您尝试编写单元测试并需要替换对数据库的简单调用，外部库（例如，文件 I/O）或其他系统 API，存根可能非常适合您的需求。”

我认为存根和骨架仅在 CORBA 中，但这里有一个存根，这是同一件事/概念吗？当“存根”一词出现在相当不同的编程模型中时（RMI 和 MIPS 组件是 2 个相当不同的），两者都有称为“存根”的概念/事物，我也知道 RMI / CORBA 有一种称为骨架的东西但也有可能有一个没有骨架的存根或什么？

例如，当 main 被转换为程序集时，它在这里被称为 stud，是否存在与该存根和骨架的连接，用于网络编程（如 CORBA），或者尽管两者都被称为存根，但它没有连接？

```
movia r8,stub # source
movia r9,0x800020 # destination
ldw r10,0(r8) # read
stw r10,0(r9) # write
ldw r10,4(r8) # read part 2
stw r10,4(r9) # write
ldw r10,8(r8) # read jump
stw r10,8(r9) # write
... # initialize others 
```

上面的代码是存根的例子吗？如果是这样，什么是骨架或不适用？

感谢您的信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T12:28:07.250

CORBA 和 RMI 存根是一个非常具体的对象，它在本地表示某个远程对象。该对象存在于服务器端，存根存在于客户端。存根实现相同的接口（具有相同的工作方法），将所有调用转发到远程对象，也接收返回的结果和异常。存根类通常是自动生成的。

存根通常具有不同的含义（仅完成一半的东西，通常仅足以使代码编译但不能正常运行）。

# vb.net - 动态编译，ReferencedAssemblies.添加另一个项目

> ID：14059406
> 
> 赞同：1
> 
> 时间：2012-12-27T18:27:22.067
> 
> 标签：vb.net, dynamic, reference, class-library, codedom

将不胜感激这里的任何指针。

*   我正在创建一个具有多个项目的解决方案。
*   该解决方案具有我创建的各种类库（libCore、libApplication、libUser）。
*   解决方案中的一个项目是 webApplication-A，它将动态编译一些 VB.Net 代码（来自用户的输入）。

**问题**：我无法弄清楚如何添加我的一个库的程序集以供动态代码使用，在本例中为 libUser.dll。

*   我已经添加了 libUser 作为对 webApplication-A 项目（正在编译代码）的引用。
*   我可以看到 libUser.dll 在项目的 Bin 目录中。

* * *

```
Dim voCompiler As New Microsoft.VisualBasic.VBCodeProvider
Dim voCompilerParams As New System.CodeDom.Compiler.CompilerParameters

voCompilerParams.ReferencedAssemblies.Add("mscorlib.dll")
voCompilerParams.ReferencedAssemblies.Add("libUser.dll") '<<=== Cannot load this assembly 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T18:30:31.413

You need to pass the full path to the assembly:

```
voCompilerParams.ReferencedAssemblies.Add(GetType(SomeType).Assembly.Location) 
```

# asp.net-mvc-3 - 无法让我的下拉列表显示在我的视图中

> ID：14059410
> 
> 赞同：1
> 
> 时间：2012-12-27T18:27:36.217
> 
> 标签：asp.net-mvc-3

我基本上试图在我的数据输入视图上显示一个下拉列表，并且下拉列表不断给我错误“表达式树可能不包含动态操作”。我已将“@Model MyModel”添加到视图顶部，但仍然无法克服此错误。有谁知道如何解决这个问题？我有一个看起来像这样的控制器

```
using MvcApplication1.Models;

namespace MvcApplication1.Controllers
{
    public class MyController : Controller
    {

        public ActionResult Index()
        {
            return View();
        }

        public ActionResult EnterInfo()
        {
            GetUT myGetUT = new GetUT();
            ViewBag.uts = GetOptions();
            return View(myGetUT);
        }

        [HttpPost]
        public ActionResult EnterInfo(GetUT myGetUT)
        {
            ViewBag.uts = GetOptions();
            return View(myGetUT);
        }

        private List<UT> GetOptions()
        {
            List<UT> uts = new List<UT>();
            uts.Add(new UT() { ID = 1, Name = "1st" });
            uts.Add(new UT() { ID = 2, Name = "2nd" });
            uts.Add(new UT() { ID = 3, Name = "3rd" });
            uts.Add(new UT() { ID = 4, Name = "4th" });

            return uts;
        }

    }
} 
```

和一个看起来像的视图

```
@Model MyModel

@{
    Layout = null;
}

<!DOCTYPE html>

<html>
<head>
    <title>EnterInfo</title>
</head>
<body>
    <div>

        @Html.DropDownListFor(x => x.UTID, new SelectList(ViewBag.uts, "ID", "Name", Model.UTID))
        Enter an Amount :-<input type="text" name="Amount" /><br />
        <input type="submit" value="Submit Info" />

    </div>
</body>
</html> 
```

感谢所有的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T19:48:08.360

好吧， ViewBag 是一种动态类型，所以我认为这就是它所抱怨的。尝试将`public List<UT> UTs { get; set; }`其作为属性`MyModel`并更改您的助手以使用模型中的 UTs 属性。像这样：

控制器：

```
public ActionResult EnterInfo()
{
    GetUT myGetUT = new GetUT();
    myGetUT.UTs = GetOptions();
    return View(myGetUT);
} 
```

看法：

```
@Html.DropDownListFor(x => x.UTID, 
    new SelectList(Model.UTs, "ID", "Name", Model.UTID))` 
```

编辑：如果不是很明显，您的视图应该输入为 GetUT 类型（因为这是您在 EnterInfo 操作中传递给 View() 函数的内容） - 我假设这就是您所说的意思`@Model MyModel`。如果没有，请将其更改为`@Model GetUT`并将属性放在`GetUT`类上。

# java - 无法解析与前缀“diffgr”关联的命名空间。在 castor 中

> ID：14059411
> 
> 赞同：1
> 
> 时间：2012-12-27T18:27:45.890
> 
> 标签：java, xml, web-services, spring, soap

我正在关注 xml

```
<root xmlns="urn:schemas-microsoft-com:xml-diffgram-v1">
<FromCity xmlns="" xmlns:diffgr="urn:schemas-microsoft-com:xml-diffgram-v1"
    diffgr:id="FromCity1" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata"
    msdata:rowOrder="0">
    <StateID>1073</StateID>
    <State>Ahmedabad</State>
</FromCity>
<FromCity xmlns="" xmlns:diffgr="urn:schemas-microsoft-com:xml-diffgram-v1"
    diffgr:id="FromCity2" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata"
    msdata:rowOrder="1">
    <StateID>1051</StateID>
    <State>Amritsar</State>
</FromCity>
<FromCity xmlns="" xmlns:diffgr="urn:schemas-microsoft-com:xml-diffgram-v1"
    diffgr:id="FromCity3" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata"
    msdata:rowOrder="2">
    <StateID>1024</StateID>
    <State>Bangalore</State>
</FromCity>
<FromCity xmlns="" xmlns:diffgr="urn:schemas-microsoft-com:xml-diffgram-v1"
    diffgr:id="FromCity4" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata"
    msdata:rowOrder="3">
    <StateID>1074</StateID>
    <State>Bhopal</State>
</FromCity>
<FromCity xmlns="" xmlns:diffgr="urn:schemas-microsoft-com:xml-diffgram-v1"
    diffgr:id="FromCity5" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata"
    msdata:rowOrder="4">
    <StateID>1034</StateID>
    <State>Chandigarh</State>
</FromCity>
<FromCity xmlns="" xmlns:diffgr="urn:schemas-microsoft-com:xml-diffgram-v1"
    diffgr:id="FromCity6" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata"
    msdata:rowOrder="5">
    <StateID>1025</StateID>
    <State>Chennai</State>
</FromCity>
<FromCity xmlns="" xmlns:diffgr="urn:schemas-microsoft-com:xml-diffgram-v1"
    diffgr:id="FromCity7" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata"
    msdata:rowOrder="6">
    <StateID>1075</StateID>
    <State>Dehradun</State>
</FromCity>
<FromCity xmlns="" xmlns:diffgr="urn:schemas-microsoft-com:xml-diffgram-v1"
    diffgr:id="FromCity8" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata"
    msdata:rowOrder="7">
    <StateID>1001</StateID>
    <State>Delhi / NCR</State>
</FromCity>
<FromCity xmlns="" xmlns:diffgr="urn:schemas-microsoft-com:xml-diffgram-v1"
    diffgr:id="FromCity9" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata"
    msdata:rowOrder="8">
    <StateID>1062</StateID>
    <State>Gwalior</State>
</FromCity>
<FromCity xmlns="" xmlns:diffgr="urn:schemas-microsoft-com:xml-diffgram-v1"
    diffgr:id="FromCity10" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata"
    msdata:rowOrder="9">
    <StateID>1011</StateID>
    <State>Hyderabad</State>
</FromCity>
<FromCity xmlns="" xmlns:diffgr="urn:schemas-microsoft-com:xml-diffgram-v1"
    diffgr:id="FromCity11" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata"
    msdata:rowOrder="10">
    <StateID>1035</StateID>
    <State>Jaipur</State>
</FromCity>
<FromCity xmlns="" xmlns:diffgr="urn:schemas-microsoft-com:xml-diffgram-v1"
    diffgr:id="FromCity12" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata"
    msdata:rowOrder="11">
    <StateID>1063</StateID>
    <State>Jhansi</State>
</FromCity>
<FromCity xmlns="" xmlns:diffgr="urn:schemas-microsoft-com:xml-diffgram-v1"
    diffgr:id="FromCity13" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata"
    msdata:rowOrder="12">
    <StateID>1036</StateID>
    <State>Jodhpur</State>
</FromCity>
<FromCity xmlns="" xmlns:diffgr="urn:schemas-microsoft-com:xml-diffgram-v1"
    diffgr:id="FromCity14" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata"
    msdata:rowOrder="13">
    <StateID>1064</StateID>
    <State>Khajuraho</State>
</FromCity>
<FromCity xmlns="" xmlns:diffgr="urn:schemas-microsoft-com:xml-diffgram-v1"
    diffgr:id="FromCity15" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata"
    msdata:rowOrder="14">
    <StateID>1026</StateID>
    <State>Kolkata</State>
</FromCity>
<FromCity xmlns="" xmlns:diffgr="urn:schemas-microsoft-com:xml-diffgram-v1"
    diffgr:id="FromCity16" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata"
    msdata:rowOrder="15">
    <StateID>1072</StateID>
    <State>Ludhiana</State>
</FromCity>
<FromCity xmlns="" xmlns:diffgr="urn:schemas-microsoft-com:xml-diffgram-v1"
    diffgr:id="FromCity17" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata"
    msdata:rowOrder="16">
    <StateID>1010</StateID>
    <State>Mumbai</State>
</FromCity>
<FromCity xmlns="" xmlns:diffgr="urn:schemas-microsoft-com:xml-diffgram-v1"
    diffgr:id="FromCity18" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata"
    msdata:rowOrder="17">
    <StateID>1065</StateID>
    <State>Orchha</State>
</FromCity>
<FromCity xmlns="" xmlns:diffgr="urn:schemas-microsoft-com:xml-diffgram-v1"
    diffgr:id="FromCity19" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata"
    msdata:rowOrder="18">
    <StateID>1016</StateID>
    <State>Pune</State>
</FromCity>
<FromCity xmlns="" xmlns:diffgr="urn:schemas-microsoft-com:xml-diffgram-v1"
    diffgr:id="FromCity20" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata"
    msdata:rowOrder="19">
    <StateID>1037</StateID>
    <State>Udaipur</State>
</FromCity>
</root> 
```

以下是我的映射

```
<class name="pkg.SourceCityWheelzResponse">
    <description xmlns="">Default mapping for class
        GhraPayOrderRequest
    </description>
    <map-to xml="root" ns-prefix="diffgr"
        ns-uri="urn:schemas-microsoft-com:xml-diffgram-v1" />
    <field name="fromCities" type="pkg.FromCity" collection="arraylist">
        <bind-xml name="root:FromCity" node="element"
            xmlns:root="urn:schemas-microsoft-com:xml-diffgram-v1" />
    </field>

</class>
<class name="pkg.FromCity">
    <description xmlns="">Default mapping for class
        GhraPayOrderRequest
    </description>
    <map-to xml="FromCity" ns-prefix="diffgr"
        ns-uri="urn:schemas-microsoft-com:xml-diffgram-v1" />

    <field name="stateId" type="java.lang.String">
        <bind-xml name="FromCity:StateID" node="element"
            xmlns:FromCity="urn:schemas-microsoft-com:xml-diffgram-v1" />
    </field>
    <field name="state" type="java.lang.String">
        <bind-xml name="FromCity:State" node="element"
            xmlns:FromCity="urn:schemas-microsoft-com:xml-diffgram-v1" />
    </field>
</class> 
```

但我收到以下错误

```
org.springframework.oxm.UnmarshallingFailureException: Castor unmarshalling exception; nested exception is org.exolab.castor.xml.MarshalException: The namespace associated with the prefix 'diffgr' could not be resolved.
    at org.springframework.oxm.castor.CastorMarshaller.convertCastorException(CastorMarshaller.java:675)
    at org.springframework.oxm.castor.CastorMarshaller.unmarshalDomNode(CastorMarshaller.java:554)
    at org.springframework.oxm.support.AbstractMarshaller.unmarshalDomSource(AbstractMarshaller.java:307)
    at org.springframework.oxm.support.AbstractMarshaller.unmarshal(AbstractMarshaller.java:125) 
```

请帮我解决这个问题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T19:31:17.230

您需要在根标签中指定命名空间架构：

```
<root xmlns:sql="urn:schemas-microsoft-com:xml-sql" sql:mapping-schema="DiffGramSchema.xml"> 
```

有关 XML 的示例，请参阅[DiffGram 示例](http://msdn.microsoft.com/en-us/library/aa257368%28v=sql.80%29.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T19:27:49.210

这个 XML 充其量是奇怪的......您是否尝试过将命名空间声明移动到根元素，如下所示：

```
<root xmlns="urn:schemas-microsoft-com:xml-diffgram-v1" xmlns:diffgr="urn:schemas-microsoft-com:xml-diffgram-v1" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata">
    <FromCity diffgr:id="FromCity1" msdata:rowOrder="0">
        <StateID>1073</StateID>
        <State>Ahmedabad</State>
    </FromCity>
</root> 
```

事实上，您甚至不需要额外的`diffgr`命名空间，因为它`URN`与默认命名空间之一相同。或者这是您的 XML 中的错误？

# r - plyr::ddply 错误消息：类中的错误（输出 [[var]]）<- 类（值）：尝试将属性设置为 NULL

> ID：14059418
> 
> 赞同：3
> 
> 时间：2012-12-27T18:28:38.267
> 
> 标签：r, plyr

这在不到一个月前就奏效了。有什么改变吗？（添加了简单的示例）：

adk47sample

```
PeakName Elevation
Marcy      5344
Marcy      5344
Marcy      5344
Marcy      5344
Marcy      5344
Marcy      5344
Marcy      5344
Algonquin      5114
Algonquin      5114
Algonquin      5114

> require(plyr)
Loading required package: plyr
> adk.need.fr.round.6 <- ddply(adk47sample, .(PeakName, Elevation),
+   summarize, needThese=if(length(PeakName) < 6) "needThis")

Error in class(output[[var]]) <- class(value) : 
  attempt to set an attribute on NULL 
```

对于这个简单的例子，我期望：

```
> adk.need.fr.round.6
      PeakName     Elevation needThese
1     Algonquin      5114     needThis 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T19:39:08.647

如果我给出@joran建议的结果（它给出了相同的错误），它适用于我的`plyr`版本 1.8 ：`else``character(0)``else NULL`

```
adk.need.fr.round.6 <- ddply(adk47sample, 
.(PeakName, Elevation),summarize, 
  needThese=if(length(PeakName) < 6) "needThis" else character(0)) 
```

# php - 在 PHP 中将货币名称解析为整数值

> ID：14059426
> 
> 赞同：1
> 
> 时间：2012-12-27T18:29:34.813
> 
> 标签：php, regex, string, parsing, currency

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T18:55:30.690

您可以尝试运行类似这样的正则表达式（未经测试）：

```
if(preg_match('/([$€])([\d\.]+)\s?([\w]+)[^\(]*\((\d+)\)/',$value,$matches)){
    switch($matches[1]){
        case '$':
            $currency = 'dollar';
            break;
        case '€':
            $currency = 'euro';
            break;
        // and more for more currencies
    }
    $number = $matches[2];
    switch($matches[3]){
        case 'billion':
            $number = intval($number*1000000000);
            break;
        case 'million':
            $number = intval($number*1000000);
            break;
        // and more for more multipliers
    }
    $year = $matches[4];
} 
```

请记住在正则表达式的第一对方括号中添加您需要支持的所有可能的货币符号`[$€]`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T18:56:14.177

未经测试，我相信有更优雅的方式来做事，但这应该有效：

```
<?php

echo parseCurrency('$6.041 billion USD (2006)');

function parseCurrency($input){
 if(strpos($input, 'USD') || strpos($input, '$')){
     $currency = 'USD';
     $floatVal = (float) get_string($input, '$', ' ');
 }
 elseif(strpos($input, '€')){
     $currency = 'EUR';
     $floatVal = (float) get_string($input, '€', ' ');
 }
 else{
     $currency = 'undefined';
     die();
 }

 if(strpos($input, 'billion'){
    $number = $floatVal * 1000000000;
 } 
 elseif(strpos($input, 'million'){
    $number = $floatVal * 1000000;
 }
 else{
    $number = 'undefined';
    die();
 }
 if (preg_match('/\\([12][0-9]{3}\\)/', $input, $years)){
    $year = $years[0];
 }
 else{
    $year = 'undefined';
    die();
 }
 return $number . ', ' . $currency . ', ' . $year;
}

//used to find million or billion
function get_string($string, $start, $end){
 $string = " ".$string;
 $pos = strpos($string,$start);
 if ($pos == 0) return "";
 $pos += strlen($start);
 $len = strpos($string,$end,$pos) - $pos;
 return substr($string,$pos,$len);
} 
```

# express - 在 Express.js 项目中使用 Yeoman/Brunch/Grunt

> ID：14059428
> 
> 赞同：3
> 
> 时间：2012-12-27T18:29:37.510
> 
> 标签：express, structure, gruntjs, yeoman, brunch

我想知道我应该如何构建我的 Express.js 项目的前端。

我之前没有用 Grunt 做过很多事情，但我知道它执行诸如编译之类的任务，然后保存结果。

目前，我的 Express.js 项目如下所示：

```
/app
    /models
    /controllers
    /views
/config
/public 
```

其中的任何文件`/public`都是静态的，并由 Node 应用程序提供。那么，我是在此处初始化 Yeoman/Brunt，还是应该将我的源代码存储在文档根目录之外，而只是将其编译为`/public`？如果是这样，您会在哪里推荐来源？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T22:31:00.363

如果您要初始化 brunch 项目，建议在`public`dir 之外执行它并将其编译到`public`dir。您可以将 brunch 与 express 集成：`brunch watch --server`非常简单地启动您的 express 服务器：[https ://github.com/brunch/brunch/issues/453](https://github.com/brunch/brunch/issues/453)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T22:14:02.730

Yeoman 团队已经建立了一个[专门的项目](https://github.com/yeoman/yeoman/tree/express-stack)，它以后端生成器的形式回答了这个问题。

# css - CSS：全尺寸背景图片

> ID：14059429
> 
> 赞同：17
> 
> 时间：2012-12-27T18:29:51.180
> 
> 标签：css

尝试使用以下方法获取全尺寸背景图像：

```
html {
    height: 100%;
    background:url('../img/bg.jpg') no-repeat center center fixed;
    background-size: cover;
} 
```

它显示具有正确宽度但高度被拉伸的背景图像。我尝试了各种选择，例如

```
html {
background:url('../img/bg.jpg') no-repeat center center fixed;
background-size: 100% auto;
-webkit-background-size: 100% auto;
-moz-background-size: 100% auto;
-o-background-size: 100% auto; 
```

}

去除`height: 100%`

但他们都没有工作。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-12-27T19:06:32.607

您的屏幕显然与您的图像形状不同。这并不少见，即使您的屏幕是相同的形状（纵横比），您也应该始终迎合这种情况，因为其他人的屏幕并不总是如此。为了解决这个问题，您只有以下三个选项之一：

*   您可以选择用图像完全覆盖屏幕，但不能扭曲图像。在这种情况下，您将需要处理图像边缘将被切断的事实。对于这种情况，请使用：`background-size: cover`
*   您可以选择确保整个图像可见且不失真。在这种情况下，您需要处理一些背景不会被您的图像覆盖的事实。处理这个问题的最好方法是给页面一个纯色背景，并设计你的图像淡入纯色（尽管这并不总是可能的）。对于这种情况，请使用：`background-size: contain`
*   您可以选择用背景覆盖整个屏幕，并对其进行扭曲以适应。对于这种情况，请使用：`background-size: 100% 100%`

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-27T18:39:26.533

尝试使用包含而不是封面，然后将其居中：

```
background-size: contain;
background-position: center; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-03-04T08:51:21.733

```
background: url(images/bg.jpg) no-repeat center center fixed; 
-webkit-background-size: cover;
-moz-background-size: cover;
-o-background-size: cover;
background-size: cover; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-27T19:14:42.270

更好的解决方案可能是使用轻量级 jQuery 插件来动态调整浏览器站点的背景大小。我真正喜欢的一个是 backstretch.js。它们的实现非常简单。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-06-21T01:53:22.027

我有同样的问题，我在上面使用这个 CSS`body`

```
background: url(image.jpg);
    background-color: rgba(0, 0, 0, 0);
    background-position-x: 0%;
    background-position-y: 0%;
    background-size: auto auto;
background-color: #0a769d;
height: 100%;
min-height: 100%;
max-height: 100%;
width: 100%;
background-size: 100% 100%;
background-position: center;
max-width: 100%;
min-width: 100%;
top: 0;
left: 0;
padding: 0;
margin: 0; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-27T19:19:04.703

您应该使用正文作为选择器而不是 html，这会导致您的标记出现问题。您的代码如下：

```
html {
    height: 100%;
    background:url('../img/bg.jpg') no-repeat center center fixed;
    background-size: cover;
} 
```

我会尝试类似的东西：

```
body {
    background:url('../img/bg.jpg') no-repeat 50% 0 fixed;
    margin: 0 auto;
} 
```

您不必指定图像的尺寸。

# ruby-on-rails - 我的创意工厂坏了（唯一的标题验证）

> ID：14059431
> 
> 赞同：1
> 
> 时间：2012-12-27T18:30:07.933
> 
> 标签：ruby-on-rails, rspec, factory-bot, faker

这是一个 FactoryGirl 工厂：

```
FactoryGirl.define do
  factory :idea do
    title Faker::Lorem.sentence
    note Faker::Lorem.sentences(2)
    status "available"
  end
end 
```

这是`idea`模型：

```
class Idea < ActiveRecord::Base
  attr_accessible :note, :status, :title
  validates :title,  presence: true, uniqueness: true, length: {minimum: 20}
  validates :status, presence: true, inclusion: {in: %w(pending available claimed overdue submitted aborted rejected)}
  belongs_to :user
end 
```

现在，当我输入我的 Rails 控制台`t1 = FactoryGirl.create(:idea)`时，没问题，我明白了。但是当我输入它时`t2 = FactoryGirl.create(:idea)`它崩溃了，说验证失败：`ActiveRecord::RecordInvalid: Validation failed: Title has already been taken`

事实上，我在 SQL 转储中看到 FactoryGirl 尝试使用相同的字符串两次：

```
1.9.3p327 :002 > t1 = FactoryGirl.create(:idea)
   (0.0ms)  begin transaction
  Idea Exists (1.8ms)  SELECT 1 AS one FROM "ideas" WHERE "ideas"."title" = 'Eligendi sint quod quia alias sed sit vitae repellendus.' LIMIT 1
  SQL (7.4ms)  INSERT INTO "ideas" ("created_at", "note", "status", "title", "updated_at", "user_id") VALUES (?, ?, ?, ?, ?, ?)  [["created_at", Thu, 27 Dec 2012 18:20:47 UTC +00:00], ["note", ["Aut placeat mollitia.", "Adipisci in est eos."]], ["status", "available"], ["title", "Eligendi sint quod quia alias sed sit vitae repellendus."], ["updated_at", Thu, 27 Dec 2012 18:20:47 UTC +00:00], ["user_id", nil]]
   (6.3ms)  commit transaction
 => #<Idea id: 1, title: "Eligendi sint quod quia alias sed sit vitae repelle...", note: ["Aut placeat mollitia.", "Adipisci in est eos."], status: "available", created_at: "2012-12-27 18:20:47", updated_at: "2012-12-27 18:20:47", user_id: nil> 
1.9.3p327 :003 > t2 = FactoryGirl.create(:idea)
   (0.1ms)  begin transaction
  Idea Exists (2.7ms)  SELECT 1 AS one FROM "ideas" WHERE "ideas"."title" = 'Eligendi sint quod quia alias sed sit vitae repellendus.' LIMIT 1
   (0.0ms)  rollback transaction
ActiveRecord::RecordInvalid: Validation failed: Title has already been taken 
```

`Faker::Lorem.sentence`但是当我在控制台中反复运行时，我不断得到随机的、不同的句子。

那么，为什么 Faker 和/或 FactoryGirl 决定使用完全相同的字符串，即使它应该是随机的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T18:37:00.223

您需要将对 Faker 的调用包装到一个块中。

```
FactoryGirl.define do
  factory :idea do
    title { Faker::Lorem.sentence }
    note { Faker::Lorem.sentences(2) }
    status "available"
  end
end 
```

如果不这样做，则对 sentence 方法的调用仅发生一次，并且返回值设置为标题/注释。所以没有`{}`它实际上与说：

```
title "some string" 
```

# php - 将对象传递给函数或迭代时如何让智能感知与 phpStorm 一起工作

> ID：14059432
> 
> 赞同：12
> 
> 时间：2012-12-27T18:30:08.527
> 
> 标签：php, function, intellisense, phpstorm, code-hinting

我有一个带有 getter 和 setter 的对象，但是当我将它传递给函数或迭代这些对象的数组时，我失去了对该对象的智能感知。

例如：

```
...
$personA = new Person(..);
$age = $personA->getAge();  // intellisense works.

$personArray = array($personA, $personB, .. );
foreach($personArray as $aPerson){
   $aPerson->getAge();   //  no intellisense here
}

doSomething($personA); 

function doSomething($person){
   $person->getAge()         //  no intellisense here
   ...
} 
```

我在这里想念什么？

我是否需要更改代码（转换.. 等），缺少 phpStorm 设置？也许这是不可能的？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-12-27T18:34:58.073

对于第一种`foreach`情况，它（还）不可能开箱即用，但是您通常可以暗示：

```
$personArray = array($personA, $personB, .. );
foreach ($personArray as $aPerson) {
   /* @var $aPerson Person */
   $aPerson->getAge();  // now with code-completition
} 
```

哪个正在对正在进行迭代的变量进行类型提示。或者，您也可以对数组变量进行类型提示：

```
/* @var $personArray Person[] */
$personArray = array($personA, $personB, .. );
foreach ($personArray as $aPerson) {
    $aPerson->getAge();  // now with code-completition
} 
```

对于第二种情况，您可以添加 PHP 类型提示（我推荐）：

```
function doSomething(Person $person) {
   $person->getAge() //  now with code-completition
   ...
} 
```

这也确保您只能传递该类型的值。另请参阅[*Type Hinting ^(Docs)*](http://php.net/language.oop5.typehinting)和[*Interfaces ^(Docs)*](http://php.net/language.oop5.interfaces)。

第二种情况的另一种解决方案是在函数的 docblock 中也记录参数：

```
/**
 * @param Person $person
 */
function doSomething($person) {
   $person->getAge() //  now with code-completition
   ...
} 
```

* * *

一些相关答案：

*   [有没有办法让 PhpStorm 的自动完成“更深入”？](https://stackoverflow.com/a/7619837/367456)
*   [PHPStorm 和魔术方法](https://stackoverflow.com/a/9666087/367456)
*   [如何让我的 PHP IDE 理解依赖注入容器？](https://stackoverflow.com/a/6395761/367456)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2015-04-24T11:19:47.660

虽然来自[@hakre](https://stackoverflow.com/users/367456/hakre)答案的 PPHDoc 块在 PHPStorm 中工作，但正确的形式是类型后跟变量名，如下所示

```
/** @var Person $aPerson */ 
```

然后

```
/** @var Person[] $personArray */ 
```

这些将在 PHPStorm 和 phpDocumentor 中工作。

来源：[http ://www.phpdoc.org/docs/latest/references/phpdoc/tags/var.html](http://www.phpdoc.org/docs/latest/references/phpdoc/tags/var.html)

# c++ - C++ Parallel std::vector Sorting With Expensive Copying

> ID：14059438
> 
> 赞同：5
> 
> 时间：2012-12-27T18:30:32.723
> 
> 标签：c++, algorithm, sorting, stl

Assume I have a `vector<int>` `intVec` and a `vector<vector<double> >` `matrix`. I want to sort `intVec` and reorder the first dimension of `matrix` correspondingly in C++. I realize this question has been asked several times before, but this case has a twist. A `vector<double>` is expensive to copy, so e.g. copying both `intVec` and `matrix` to a `vector<pair<int, vector<double> >`, sorting that and copying them back is even more inefficient than usual.

Short of rolling my own custom sorting algorithm, how can I sort `intVec` and reorder the first dimension of `matrix` in lockstep *without copying any element of `matrix` and invoking `vector`'s copy constructor*?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-27T19:20:30.697

> A`vector<double>`的复制成本很高，因此例如将 intVec 和 matrix 复制到 a `vector<pair<int, vector<double> >`，对其进行排序并将它们复制回来甚至比平时效率低下。

获得所需优化的最简单方法是将源的元素*交换*`vector<vector<double>>`到临时的`vector<pair<int, vector<double>>`，对其进行排序，然后将它们*交换*回原始向量中的新位置。

仍然会有比严格必要的更多的开销（例如构造和销毁空向量）。但是，从未复制任何向量，并且代码与您已有的代码非常相似。因此，如果您正确地认为问题是复制成本，那么问题就解决了。

在 C++11 中，您可以双向移动而不是交换。我怀疑使用空向量移动和交换之间存在很大的性能差异，但我不确定是否存在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T18:46:10.240

根据你两个之间的空间`>`，我猜你使用的是 pre-C++11 C++。在 C++11 中，`std::sort`似乎尽可能移动元素而不是复制。

您可以将自定义比较器传递给`std::sort`. 然而，即使你这样做，你也在做`pair<int, vector<double> >`'s 的 Theta(n log n) 副本。

我猜，基于没有实际尝试，你应该排序 a `pair<int, vector<double> *>`（或者`pair<int, int>`如果`int`足够大），使用第二个`int`作为索引）而不是获得适当的排列，然后使用`vector`'s`swap`成员函数应用排列以避免复制矢量内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-27T18:49:01.587

一个选项：创建一个`std::vector<std::pair<int,size_t>>`，其中第一个元素是 intVec 中的 int，第二个元素是该元素的原始索引。然后对该新向量进行排序。然后将您的矩阵和 intVec 打乱到由对的第二个元素指示的顺序（例如，一次通过，进行交换）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-27T20:40:50.170

我很确定——当你使用一些最新的编译器（比如 gcc 4.4 及更高版本）——没有真正被复制：现在 C++ 标准库容器中的对象（大部分）总是被移动。因此恕我直言，无需担心昂贵的副本。

看看下面的例子——它是在 Debian 下使用 gcc 4.4.6 编写的。如您所见，在“重新排序”阶段，没有调用复制构造函数，也没有调用“operator=(... & other)”。

```
#include <vector>
#include <iostream>
#include <iomanip>

class VeryExpensiveToCopy {
public:
   explicit VeryExpensiveToCopy(long i) : id(i) { ++cnt_normal_cstr; }

   // Just to be sure this is never used.
   VeryExpensiveToCopy & operator=(VeryExpensiveToCopy & other) = delete;
   VeryExpensiveToCopy(VeryExpensiveToCopy & other) = delete;

   VeryExpensiveToCopy(VeryExpensiveToCopy && other) : id(other.id) {
      ++cnt_move_cstr;
   }
   VeryExpensiveToCopy & operator=(VeryExpensiveToCopy && other) {
      id = other.id; ++cnt_op_as_move; return *this;
   }

   long get_id() const { return id; }

   static void print_stats(std::string const & lref) {
      std::cout << "[" << std::setw(20) << lref << "] Normal Cstr [" 
                << cnt_normal_cstr 
                << "] Move Cstr [" << cnt_move_cstr
                << "] operator=(&&) [" << cnt_op_as_move << "]" << std::endl;
   }

private:
   long id;

   static long cnt_normal_cstr;
   static long cnt_move_cstr;
   static long cnt_op_as_move;
};

// Counts the number of calls.
long VeryExpensiveToCopy::cnt_normal_cstr { 0 };
long VeryExpensiveToCopy::cnt_move_cstr { 0 };
long VeryExpensiveToCopy::cnt_op_as_move { 0 };

int main() {
   std::vector<VeryExpensiveToCopy> v;

   VeryExpensiveToCopy::print_stats("Start");
   for(auto i(0); i<100000; ++i) {
      v.emplace_back(i);
   }
   VeryExpensiveToCopy::print_stats("After initialization");
   for(auto i(0); i<100000-1; ++i) {
      v[i] = std::move(v[i+1]);
   }
   VeryExpensiveToCopy::print_stats("After moving");
   for(auto i(0); i<100000-1; ++i) {
      if(v[i].get_id() != i+1) { abort(); }
   }
   VeryExpensiveToCopy::print_stats("After check");

   return 0;
} 
```

输出：

```
[               Start] Normal Cstr [0] Move Cstr [0] operator=(&&) [0]
[After initialization] Normal Cstr [100000] Move Cstr [131071] operator=(&&) [0]
[        After moving] Normal Cstr [100000] Move Cstr [131071] operator=(&&) [99999]
[         After check] Normal Cstr [100000] Move Cstr [131071] operator=(&&) [99999] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-27T18:41:15.400

如果您不想复制`vector<double>`项目向量，则为项目创建一个指针或索引向量`vector<double>`。将其与主向量一起排序。

但是，您是否会获得性能提升尚不清楚，因此我建议您同时**测量**直接排序和智能排序，并进行比较。

* * *

例子：

```
#include    <algorithm>
#include    <vector>
#include    <iostream>
using namespace std;

struct Mat
{
    vector< vector< double > >  items;

    Mat( int const size )
        : items( size, vector< double >( size ) )
    {}
};

struct KeyAndData
{
    int                     key;
    vector< double > const* data;

    friend bool operator<( KeyAndData const& a, KeyAndData const& b )
    {
        return a.key < b.key;
    }
};

int main()
{
    int const       data[]  = {3, 1, 4, 1, 5};
    Mat             m( 5 );
    vector<int>     v( 5 );

    for( int i = 0;  i < 5;  ++i )
    {
        m.items[i][i] = v[i] = data[i];
    }

    vector< KeyAndData >        sorted( 5 );
    for( int i = 0;  i < 5;  ++i )
    {
        sorted[i].key = v[i];
        sorted[i].data = &m.items[i];
    }

    sort( sorted.begin(), sorted.end() );
    for( int i = 0;  i < 5;  ++i )
    {
        cout << sorted[i].key << ":  ";

        vector< double > const& r = *sorted[i].data;
        for( int x = 0;  x < 5;  ++x )
        {
            cout << r[x] << " ";
        }
        cout << endl;
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-27T19:15:30.990

显而易见的答案是将您的两个向量重组为一个向量`vector<pair<int, vector<double> >`（因为数据显然是紧密耦合的区域）。

如果这真的不是一个选项，那么创建另一个索引向量并对其进行排序，而不是 vec 和矩阵。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-27T19:28:49.763

由于[`std::vector::swap`](http://en.cppreference.com/w/cpp/container/vector/swap)在恒定时间内运行，您可以使用一种排序算法，该算法通过一系列交换（如快速排序）进行排序`intVec`，同时在 上执行相同的交换`matrix`：

```
#include <iostream>
#include <vector>
#include <algorithm>

// Sorts intVec in [low, high) while also performing identical swaps on matrix.
void iqsort(std::vector<int> &intVec, std::vector<std::vector<double>> &matrix,
            int low, int high) {
  if (low >= high) return;
  int pivot = intVec[low];
  int nLow = low + 1;
  int nHigh = high - 1;
  while (nLow <= nHigh) {
    if (intVec[nLow] <= pivot) {
      ++nLow;
    } else {
      std::swap(intVec[nLow], intVec[nHigh]);
      std::swap(matrix[nLow], matrix[nHigh]);
      --nHigh;
    }   
  }
  std::swap(intVec[low], intVec[nHigh]);
  std::swap(matrix[low], matrix[nHigh]);

  iqsort(intVec, matrix, low, nHigh);
  iqsort(intVec, matrix, nLow, high);
}

int main() {
  std::vector<int> intVec = {10, 1, 5}; 
  std::vector<std::vector<double>> matrix = {{33.0}, {11.0}, {44.0}};  
  iqsort(intVec, matrix, 0, intVec.size());
  // intVec is {1, 5, 10} and matrix is {{11.0}, {44.0}, {33.0}}
} 
```

# javascript - 我网站的 Pinterest 按钮 - 我真的也需要他们的 Javascript 吗？

> ID：14059442
> 
> 赞同：3
> 
> 时间：2012-12-27T18:30:55.050
> 
> 标签：javascript, pinterest

我正在将 Pinterest PinIt 按钮添加到我网上商店的产品中。这就是 Pinterest 希望我这样做的方式：

[http://business.pinterest.com/widget-builder/#do_pin_it_button](http://business.pinterest.com/widget-builder/#do_pin_it_button)

我已经成功地为页面上的所有产品实现了按钮，并且工作正常。关于他们要我添加的脚本，我真的需要吗？它是干什么用的？不包括它可以吗？我想知道，因为它似乎干扰了我正在做的一些 AJAX 提交（不知道为什么），并且按钮似乎在没有脚本的情况下工作正常。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-29T04:43:29.160

加载的 JavaScript`pinit.js`构建了五个不同的小部件，而不仅仅是 Pin It 按钮。如果它干扰 AJAX 提交，请在页面底部检查它是否只加载一次。（我是代码的作者，很想了解更多关于我们如何破坏您的页面的信息；有没有我可以查看的 URL？）

接受的答案使用的代码可能不起作用，因为第二个和第三个参数（媒体和描述）之间的与号已转换为 HTML 实体。

一旦 & 号被修复，接受答案中的代码将导致 Pin It 弹出窗口出现在主浏览器窗口中，这很丑陋，并且会将用户从您的页面中拉开，这确实不是您想要的。Pinterest 用户知道弹出窗口应该是什么样子，并且如果它是错误的，他们往往不会固定。

要复制 Pinterest 体验，您应该添加以下内联 JavaScript：

```
onclick="window.open(this.href, '_pinIt', 'status=no,resizable=yes,scrollbars=yes,personalbar=no,directories=no,location=no,toolbar=no,menubar=no,width=632,height=270,left=0,top=0');return false;" 
```

我强烈建议您不要手动删减您的网址；它们很脆，几乎肯定最终会破裂。如果您想要一些更具前瞻性的东西，您可以尝试使用 JavaScript 触发 Pinterest 小书签代码，就像我们的工具栏小书签一样。看起来像这样：

```
<a style="cursor:pointer;" onclick="var d=document;var e=d.createElement('script');e.setAttribute('type','text/javascript');e.setAttribute('charset','utf-8');e.setAttribute('src','//assets.pinterest.com/js/pinmarklet.js?r='+Math.random()*99999999);d.body.appendChild(e);"><img src="//assets.pinterest.com/images/pidgets/pin_it_button.png" /></a> 
```

重要提示：由于使用与方案无关的 URL，如果您通过将 HTML 拖到浏览器中进行测试`pinit.js`，它会尝试查找下面的内容。`file://`确保您在服务器上运行它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-27T18:37:44.677

不，我只有一个链接 - 工作正常。

```
<a href="http://pinterest.com/pin/create/button/?url=http%3A%2F%2Fwww.example.com%2Fproduct%3Fmodel%3DEQEA&amp;media=http%3A%2F%2Fwww.example.com%2Fimg_c%2F14ngton%2Fdesign%2F232.jpg&amp;description=Dack+Earth" class="pin-it-button" count-layout="horizontal" target="_blank">
    <img src="http://example.com/images/pin_icon.png" title="Pin It">
</a> 
```

如果您还希望计数器出现在每个按钮旁边，则只需要该脚本。

![在此处输入图像描述](../Images/922fce2a160113a69e93069a92a516d0.png)

# python - Python ngram 计算

> ID：14059444
> 
> 赞同：2
> 
> 时间：2012-12-27T18:31:06.250
> 
> 标签：python

使用 Python [ngram](http://packages.python.org/ngram/index.html)。我的代码如下所示：

```
from ngram import NGram
print(NGram.compare("coat","hat",N=1)) 
```

结果是0.4，计算如下（我认为！）：

```
(a-b)/a 
```

在哪里：

```
a = total number of distinct ngrams across the two strings
b = number of ngrams NOT shared by the two strings 
```

插入我的代码中的值，这等于：

```
(5-3)/5 = 2/5 = 0.4 
```

如果我将代码更改为：

```
from ngram import NGram
print(NGram.compare("coata","hata",N=1)) 
```

结果是 0.5，我不确定这个答案是如何从我上面写的公式得出的。

```
(6-3)/6 
```

这给出了 0.5，但是两个字符串中真的有 6 个不同的 ngram 吗？

任何人都可以对此有所了解吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T00:52:20.593

在“hata”、“coat”示例中，克看起来像这样：

```
{'a': {'hata': 2, 'coata': 2}, 
'h': {'hata': 1}, 
'c': {'coata': 1}, 
't': {'hata': 1, 'coata': 1}, 
'o': {'coata': 1}} 
```

因此，它使`'a'`.

因此 3 出 6。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T12:42:12.727

一个更复杂、更真实的例子——

```
from ngram import NGram

S1 = "bronchopneumonia"
S2 = "pneumonia"
N = 1

print(NGram.compare(S1,S2,N)) 
```

结果是 0.5625

公式：

```
(x-y)/x 
```

在哪里：

```
x = total number of distinct ngrams across the two strings
y = number of ngrams NOT shared by the two strings 
```

计算，显示 x 和 y 的运行总计：

```
 'b': {'bronchopneumonia': 1} x=1, y=1
 'r': {'bronchopneumonia': 1} x=2, y=2
 'o': {'bronchopneumonia': 3, 'pneumonia':1} x=5, y=4 
 'n': {'bronchopneumonia': 3, 'pneumonia':2} x=8, y=5 
 'c': {'bronchopneumonia': 1} x=9, y=6
 'h': {'bronchopneumonia': 1} x=10, y=7
 'p': {'bronchopneumonia': 1, 'pneumonia':1} x=11, y=7
 'e': {'bronchopneumonia': 1, 'pneumonia':1} x=12, y=7
 'u': {'bronchopneumonia': 1, 'pneumonia':1} x=13, y=7
 'm': {'bronchopneumonia': 1, 'pneumonia':1} x=14, y=7
 'i': {'bronchopneumonia': 1, 'pneumonia':1} x=15, y=7
 'a': {'bronchopneumonia': 1, 'pneumonia':1} x=16, y=7 
```

这给了我们：

```
(16-7)/16 = 9/16 = 0.5625 
```

当您遇到在两个字符串中多次出现的 ngram 时，就会出现复杂性。在此示例中，“o”和“n”都出现了多次。

```
'o' appears **3 times** in 'bronchopneumonia' and **1 time** in 'pneumonia'
x now moves to 5 (from 2) and y moves to 4 (from 2).
I think, x is incremented by 3 because it is the higher number???
And I think, y is incremented by 2 because 3-1=2??? 
```

同样对于'n'：

```
'n' appears **3 times** in 'bronchopneumonia' and **2 times** in 'pneumonia'
x now moves to 8 (from 5) and y moves to 5 (from 4).
I think, x is incremented by 3 because it is the higher number???
And I think, y is incremented by 1 because 3-2=1??? 
```

这是我对其工作原理的理解，我不是 Python 专家，所以我可能误解了源代码中的某些内容。

# visual-studio - 如何在 Visual Studio 中不选择一条线而将其缩进/缩进？

> ID：14059451
> 
> 赞同：1
> 
> 时间：2012-12-27T18:31:26.470
> 
> 标签：visual-studio

我的意思是光标是在文本前面，Tab 和 Shift-Tab 工作的地方，还是其他任何地方。MonoDevelop 使用 Ctrl+Alt+Home 或 Ctrl+Alt+End 来实现此功能，您可以在其 Edit->Format 菜单中轻松找到命令。

对于 Visual Studio，学习如何操作键盘比我用过的任何其他程序都难。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T18:46:39.647

Visual Studio 在键盘方面非常灵活，即使它不是超级友好。

![](../Images/5b422bbb2fbcb908ec7d7b24cab2c0ee.png)

1.  转到*工具-> 选项*
2.  `dent`在“*显示包含命令的*文本”框中键入
3.  寻找`Edit.DecreaseLineIndent`
4.  聚焦*按下快捷键*文本框
5.  输入您的首选键，例如：`Ctrl`+ `Alt`+`Home`
6.  检查当前使用这些密钥的位置。请注意，击键适用于许多范围。您可能想从*使用新快捷方式*下拉菜单中选择*文本编辑器*
**   如果要应用此快捷方式，请单击*分配**   做同样的事情`Edit.IncreaseLineIndent`*

 *一旦您以您喜欢的方式备份您的设置，这不是一个坏主意。*

# maven - 为代理配置 maven

> ID：14059452
> 
> 赞同：0
> 
> 时间：2012-12-27T18:31:32.013
> 
> 标签：maven, proxy, maven-plugin

我是 maven 构建工具的新手，但我无法为代理服务器配置 maven。

在`/usr/share/maven/settings.xml` 我添加了以下几行：

```
 <proxies>
  <proxy>
      <active>true</active>
      <protocol>http</protocol>
      <host>proxy.foo.bar.com (http://proxy.foo.bar.com/)</host>
      <port>911</port>
    </proxy>
    <proxy>
      <active>true</active>
      <protocol>https</protocol>
      <host>proxy.foo.bar.com (https://proxy.foo.bar.com/)</host>
      <port>911</port>
    </proxy>
 <proxy>
</proxies> 
```

但是当我做 mvn 包时。我得到错误：

```
Downloading: http://repo1.maven.org/maven2 (http://repo1.maven.org/maven2)/org/apache/maven/plugins/maven-resources-plugin/2.3/maven-resources-plugin-2.3.pom
[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 0.245s
[INFO] Finished at: Thu Dec 27 10:10:30 PST 2012
[INFO] Final Memory: 3M/87M
[INFO] ------------------------------------------------------------------------
[ERROR] Plugin org.apache.maven.plugins:maven-resources-plugin:2.3 or one of its dependencies could not be resolved: Failed to read artifact descriptor for org.apache.maven.plugins:maven-resources-plugin:jar:2.3: Could not transfer artifact org.apache.maven.plugins:maven-resources-plugin:pom:2.3 from/to Central (http://repo1.maven.org/maven2 (http://repo1.maven.org/maven2)): IllegalArgumentException: Illegal character in path at index 29: http://repo1.maven.org/maven2 (http://repo1.maven.org/maven2)/org/apache/maven/plugins/maven-resources-plugin/2.3/maven-resources-plugin-2.3.pom -> [Help 1]
[ERROR] 
[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR] 
[ERROR] For more information about the errors and possible solutions, please read the following articles:
[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/PluginResolutionException 
```

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T18:48:34.163

代理条目的主机不应包含括号。

它应该看起来像。

```
 <host>proxy.foo.bar.com</host> 
```

您可以在控制台输出的第一部分看到括号被添加到您的路径中。

```
Downloading: http://repo1.maven.org/maven2 (http://repo1.maven.org/maven2)/org/apache/maven/plugins/maven-resources-plugin/2.3/ 
```

它应该看起来像

```
Downloading: http://repo1.maven.org/maven2 http://repo1.maven.org/maven2/org/apache/maven/plugins/maven-resources-plugin/2.3/ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T18:57:30.570

您错误地配置了 Maven 中央存储库的路径，就像您错误地配置了代理的路径一样。这些条目应该看起来就像标准 url，并且不包含任何括号。

# entity-framework - 使用实体框架数据模型添加验证属性

> ID：14059455
> 
> 赞同：24
> 
> 时间：2012-12-27T18:31:51.977
> 
> 标签：entity-framework, asp.net-mvc-4

**2015 年 2 月前言**如果您仍在使用实体框架 EDMX，请帮自己一个忙，并使用实体框架代码优先结帐。不同之处在于您的表是从您的模型类创建的，而不是在 EDMX 中，您的模型类是使用您的表创建的。这是一个更简单的解决方案，而且这个问题中的问题甚至不存在！

[使用 MVC 5 开始使用 Entity Framework 6 Code First](http://www.asp.net/mvc/overview/getting-started/getting-started-with-ef-using-mvc/creating-an-entity-framework-data-model-for-an-asp-net-mvc-application)

我有一个现有的 SQL 数据库，并且我正在为模型使用 ADO.NET 实体数据模型。我正在尝试在我的 MVC 应用程序中构建一些 CRUD 功能。

在我找到的有关该主题的所有教程中，他们从头开始构建模型并将属性添加到模型类中。例如：

```
 [Required]
    [StringLength(10)]
    public string Name { get; set; } 
```

但是，模型类是自动生成的，所以我认为更改它们是一个坏主意（如果刷新数据库模型，无论如何都会被覆盖）。

我将如何添加验证属性？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-12-27T19:03:46.233

您可以创建一个与 EF 生成的类分开的部分类来存储元数据。

```
//Contact.cs - The original auto-generated file 
[System.ComponentModel.DataAnnotations.MetadataType(typeof(ContactMetadata))]
public partial class Contact
{
    public int ContactID { get; set; }
    public string ContactName { get; set; }
    public string ContactCell { get; set; }
}

//ContactMetadata.cs - New, seperate class

using System.ComponentModel;
using System.ComponentModel.DataAnnotations;
internal sealed class ContactMetadata
{
    [Required(ErrorMessage = "Name is required.")]
    [StringLength(5)]  
    public string ContactName;
} 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2014-04-25T10:46:30.667

Mason240 答案效果很好，我会尝试改进它：您可以创建一个新的 ContactDataAnnotations.cs 类：

```
//ContactDataAnnotations.cs - A new file 
using System.ComponentModel;
using System.ComponentModel.DataAnnotations;

[MetadataType(typeof(ContactMetadata))]
public partial class Contact
{
    // No field here
}

internal sealed class ContactMetadata
{
    [Required(ErrorMessage = "Name is required.")]
    [StringLength(5)]  
    public string ContactName {get; set; }
} 
```

这样，您可以通过 EF 重新生成您的 Contact 类，而无需触及 DataAnnotations - 顺便说一下，无需警告。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-04-01T01:25:09.903

这已经得到了正确的回答，但我还想补充一点，我总是发现嵌套元数据对我来说似乎更干净一些，恕我直言。

```
[MetadataType(typeof(ProductDescription.Metadata))]
public partial class ProductDescription
{
    sealed class Metadata
    {
        [Key]
        public long id { get; set; }
        [Display(Name = "Title")]
        public string title { get; set; }
        // ...
    }
} 
```

我还注意到将元数据保持为类私有的一个额外好处。该属性仅适用于正确的类，防止在复制该类时可能发生的错误（以创建类似的类）。如果您在重命名重复的类时忘记更改属性中的类名，则会出现该错误。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-04-22T13:08:53.557

我知道这已被标记为已回答，但我想清理一些东西。

@SteveCav 说：“这个成员被定义了不止一次”。我有同样的错误。花了几个小时试图弄清楚。

要最终纠正它，您必须在同一个程序集中创建一个单独的文件类（我认为这已经在这里提到过）。但我要强调的是，这个类应该嵌套在一个代表内部类的部分类中。

然后你用 Annotation 类装饰那个内部类。像这样：

```
//ContactMap.cs - Present in the same namespace as Contact.cs
[System.ComponentModel.DataAnnotations.MetadataType(typeof(ContactMap))]
partial class Contact // Present in the ContactMap class. This represent the Inner Class
{
}

//ContactMap.cs - This represent the outer class

using System.ComponentModel;
using System.ComponentModel.DataAnnotations;
public class ContactMetadata
{
    [Required(ErrorMessage = "Name is required.")]
    [StringLength(5)]  
    public string ContactName;
} 
```

希望这更清楚或更容易理解。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-10-05T08:36:21.833

这里建议的答案有一个变体，允许您在不同的程序集和命名空间中使用类。我实际上没有用 EF 测试过它，但我将它用于 Swagger 代码生成 API 模型类。

简而言之：从模型类继承并在继承的类上添加元数据。另一个好处是，使用 Swagger 代码生成，您可以直接使用 API 模型而无需映射，并且对于初始表单，您可以使用受保护的默认 ctor。

```
[MetadataType(typeof(LocalAssemblyModelMetadata))]
public class LocalAssemblyModel : IO.Swagger.Model.OtherAssemblyModel 
{
    public LocalAssemblyModel() : base ()     { }
}

public sealed class LocalAssemblyModelMetadata
{
    [Required(ErrorMessage = "BaseclassProperty is mandatory.")]
    public string BaseclassProperty { get; set; }
} 
```

# javascript - 包装文档或窗口对象以检查滚动值？

> ID：14059456
> 
> 赞同：2
> 
> 时间：2012-12-27T18:31:55.440
> 
> 标签：javascript, jquery, scroll, window, document

为了检查页面的滚动值，我使用`window`jQuery 包装对象，但是在滚动时，滚动事件的目标元素结果是`document`对象：

```
$(window).scroll(function(e) {
    alert('Scrolling ' + e.target);
}); 
```

包装以检查滚动值的正确对象是什么？
我知道它们之间的区别（一个窗口可以包含多个框架，因此可以包含许多文档），但是对于单个文档上下文，我看到滚动值是一致的：

```
alert($(window).scrollTop() === $(document).scrollTop()); 
```

**编辑：**

本机 JavaScript 也会发生这种情况：

```
window.onscroll = function(e) { alert('scrolled ' + e.target); };
```

元素绑定是`window`，但事件目标是`document`。

关于上面写的表达式，将对象的 scrollTop 值与`window`对象之一进行比较`document`：jQuery 文档说明`$(window).width()`返回视口的宽度，而`$(document).width()`返回 HTML DOM 元素的宽度；由于视口可能小于整个 HTML 元素的宽度，因此这两个值可能不同。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T18:59:42.360

暂时将 jQuery 放在一边，使用纯 JavaScript，您可以检查`window`当前垂直滚动位置的以下属性：

```
window.pageYOffset;
window.scrollY; 
```

[根据 MDN](https://developer.mozilla.org/en-US/docs/DOM/window.scrollY)，第二个不是跨浏览器。仍然根据这一点，在 IE<9 你必须检查`document.body.scrollTop`，因为没有属性`window`会给你当前的滚动位置。实际上，`document.body.scrollTop`这是我最常使用的，因为根据我的经验，它只适用于跨浏览器（此处需要引用和检查）。

jQuery 考虑了浏览器的差异，并从正确的对象中获取正确的属性，而不管您使用哪个选择器`.scrollTop()`（查看[源代码](https://github.com/jquery/jquery/blob/master/src/offset.js#l136-161)）。简而言之，`window`在`document`请求`.scrollTop()`. 它会寻找`window.pageYOffset`，如果找不到，它会返回`document.body.scrollTop`。

* * *

关于您对每个窗口的多个文档的评论的注释：从技术上讲，每个`window`对象只指向一个`document`，反之亦然。当您有多个框架时，每个框架都有单独的`window`和`document`元素。例如，如果您获得对单个 iframe 的引用，则可以从中获取它自己的`window`引用`document`：

```
// first iframe in main document
var ifr = document.getElementsByTagName('iframe')[0];
var ifrWindow = ifr.contentWindow;
var ifrDocument = ifrWindow.document; 
// The above is good for new and old browsers; 
// ifr.contentDocument is also available on modern browsers 
```

# jsp - 使用 Jersey-Guice-Shiro 堆栈时，Jetty 找不到 login.jsp

> ID：14059459
> 
> 赞同：3
> 
> 时间：2012-12-27T18:32:03.487
> 
> 标签：jsp, jersey, jetty, shiro, guice-servlet

（2013 年 1 月 2 日更新）我现在在[https://github.com/AndyWi/GuiceJerseyJettyShiroExample](https://github.com/AndyWi/GuiceJerseyJettyShiroExample)将所有代码和 pom.xml 添加到 github （更新结束）

我正在尝试使用 Shiro 将基于表单的身份验证添加到我的简单应用程序中。该应用程序使用 Guice 3.0、Jersey 1.16 和 Shiro 1.2.1，在嵌入式 Jetty 9.0.0.M4 上运行。

我的问题是（据我所知）Shiro 需要通过 Guice 提供 login.jsp，然后添加到 Shiro 的过滤器链中。但是，当我这样做时，Jetty 找不到 login.jsp。当我从 Guice 过滤器中排除 login.jsp 时，Jetty 可以找到该 jsp，但是 Shiro 无法使用它，因此身份验证不起作用。

因此，在我的引导代码中，我使用这一行将 login.jsp 添加到 Guice 过滤器：

```
webAppContext.addFilter(GuiceFilter.class, "/login.jsp", null); 
```

在我的 ShiroWebModule 中，我像这样添加 login.jsp：

```
addFilterChain("/login.jsp", AUTHC); 
```

我花了很长时间寻找答案，却没有任何暗示其他人也有同样的问题——这意味着我显然做错了一些非常简单的事情！但我无法弄清楚它是什么。如果有人能帮助我克服这个问题，我将不胜感激。

我已经将我的项目简化为一个小例子来演示这个问题。这一切应该做的就是接受 /api/uuid 的 rest url，将用户重定向到 login.jsp，接受任何用户名/密码组合进行身份验证，然后从 /api/uuid 服务返回一个新的 UUID；用户还应保持登录状态以备将来请求。这是完整的代码，希望它能帮助那里的人发现问题：

引导程序：

```
package eg.guicejerseyjettyshiro;

import org.eclipse.jetty.server.Server;
import org.eclipse.jetty.servlet.DefaultServlet;
import org.eclipse.jetty.webapp.WebAppContext;
import com.google.inject.servlet.GuiceFilter;
import eg.guicejerseyjettyshiro.modules.EgGuiceServletContextListener;

public class Bootstrap {

    public static void main(String[] args) throws Exception {
        Server server = new Server(8081);

        WebAppContext webAppContext = new WebAppContext();
        webAppContext.setContextPath("/");
        webAppContext.setResourceBase("src/main/webapp/");
        webAppContext.setParentLoaderPriority(true);

        webAppContext.addEventListener(new EgGuiceServletContextListener());

        webAppContext.addFilter(GuiceFilter.class, "/api/*", null);

        // **** Shiro needs login.jsp to go through the GuiceFilter,
        // but Jetty can't find the jsp when this happens. Commenting
        // out this line lets Jetty find the jsp, but Shiro can't see it:
        webAppContext.addFilter(GuiceFilter.class, "/login.jsp", null);

        webAppContext.addServlet(DefaultServlet.class, "/");

        server.setHandler(webAppContext);

        server.start();
        server.join();
    }

} 
```

例如GuiceServletContextListener：

```
package eg.guicejerseyjettyshiro.modules;

import javax.servlet.ServletContext;
import javax.servlet.ServletContextEvent;
import com.google.inject.Guice;
import com.google.inject.Injector;
import com.google.inject.servlet.GuiceServletContextListener;

public class EgGuiceServletContextListener extends GuiceServletContextListener {

    private ServletContext servletContext;

    @Override
    public void contextInitialized(ServletContextEvent servletContextEvent) {
        this.servletContext = servletContextEvent.getServletContext();
        super.contextInitialized(servletContextEvent);
    }

    @Override
    protected Injector getInjector() {
        return Guice.createInjector(
                new EgJerseyServletModule(),
                new EgShiroWebModule(this.servletContext));
    }

} 
```

例如JerseyServletModule：

```
package eg.guicejerseyjettyshiro.modules;

import org.apache.shiro.guice.web.GuiceShiroFilter;
import com.sun.jersey.guice.JerseyServletModule;
import com.sun.jersey.guice.spi.container.servlet.GuiceContainer;
import eg.guicejerseyjettyshiro.dao.UuidDao;
import eg.guicejerseyjettyshiro.services.UuidService;

public class EgJerseyServletModule extends JerseyServletModule {

    @Override
    protected void configureServlets() {
        bindings();
        filters();
    }

    private void bindings() {
        bind(UuidDao.class);
        bind(UuidService.class);
    }

    private void filters() {
        filter("/*").through(GuiceShiroFilter.class);
        filter("/*").through(GuiceContainer.class);
    }

} 
```

例如ShiroWebModule：

```
package eg.guicejerseyjettyshiro.modules;

import javax.servlet.ServletContext;
import org.apache.shiro.guice.web.ShiroWebModule;
import com.google.inject.name.Names;
import eg.guicejerseyjettyshiro.realms.EgAuthorizingRealm;

public class EgShiroWebModule extends ShiroWebModule {

    public EgShiroWebModule(ServletContext servletContext) {
        super(servletContext);
    }

    @Override
    protected void configureShiroWeb() {
        bindConstant().annotatedWith(Names.named("shiro.globalSessionTimeout")).to(30000L);

        bindRealm().to(EgAuthorizingRealm.class).asEagerSingleton();

        addFilterChain("/login.jsp", AUTHC);
        addFilterChain("/api/*", AUTHC);
    }

} 
```

例如授权领域：

```
package eg.guicejerseyjettyshiro.realms;

import org.apache.shiro.authc.AuthenticationException;
import org.apache.shiro.authc.AuthenticationInfo;
import org.apache.shiro.authc.AuthenticationToken;
import org.apache.shiro.authc.SimpleAuthenticationInfo;
import org.apache.shiro.authc.UsernamePasswordToken;
import org.apache.shiro.authz.AuthorizationInfo;
import org.apache.shiro.realm.AuthorizingRealm;
import org.apache.shiro.subject.PrincipalCollection;

public class EgAuthorizingRealm extends AuthorizingRealm {

    @Override
    protected AuthenticationInfo doGetAuthenticationInfo(AuthenticationToken token)
            throws AuthenticationException {
        UsernamePasswordToken upToken = (UsernamePasswordToken) token;
        System.out.println("In EgAuthorizingRealm.doGetAuthenticationInfo for: " + upToken.getUsername() + "/" + new String(upToken.getPassword()) + " - remember=" + upToken.isRememberMe());
        return new SimpleAuthenticationInfo(upToken.getUsername(), upToken.getPassword(), getName());
    }

    @Override
    protected AuthorizationInfo doGetAuthorizationInfo(PrincipalCollection pc) {
        System.out.println("In EgAuthorizingRealm.doGetAuthorizationInfo");
        // Doing nothing just now
        return null;
    }

} 
```

Uuid服务：

```
package eg.guicejerseyjettyshiro.services;

import javax.inject.Inject;
import javax.ws.rs.GET;
import javax.ws.rs.Path;
import javax.ws.rs.Produces;
import javax.ws.rs.core.MediaType;
import org.apache.shiro.SecurityUtils;
import org.apache.shiro.subject.Subject;
import eg.guicejerseyjettyshiro.dao.UuidDao;

@Path("/api/uuid")
@Produces({MediaType.APPLICATION_XML})
public class UuidService {

    private final UuidDao uuidDao;

    @Inject
    public UuidService(UuidDao uuidDao) {
        this.uuidDao = uuidDao;
    }

    @GET
    public String get() {
        Subject currentUser = SecurityUtils.getSubject();
        System.out.println("UuidService current user: " + currentUser.getPrincipal().toString());
        return "<uuid>" + this.uuidDao.generateUuid().toString() + "</uuid>";
    }

} 
```

UuidDao：

```
package eg.guicejerseyjettyshiro.dao;

import java.util.UUID;

public class UuidDao {

    public UUID generateUuid() {
        return UUID.randomUUID();
    }
} 
```

登录.jsp：

```
<%@ page language="java" contentType="text/html; charset=ISO-8859-1"
    pageEncoding="ISO-8859-1"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Please Login</title>
</head>
<body>

<form name="loginForm" action="" method="post">
<table align="left" border="0" cellspacing="0" cellpadding="3">
    <tr>
        <td>Username:</td>
        <td><input type="text" name="username" maxlength="30"></td>
    </tr>
    <tr>
        <td>Password:</td>
        <td><input type="password" name="password" maxlength="30"></td>
    </tr>
    <tr>
        <td colspan="2" align="left"><input type="checkbox" name="rememberMe"><font size="2">Remember Me</font></td>
    </tr>
    <tr>
        <td colspan="2" align="right"><input type="submit" name="submit" value="Login"></td>
    </tr>
</table> 
</form>

</body>
</html> 
```

好的，我想就是这样。我意识到这很长，所以非常感谢你读到这里。这一直让我发疯，所以你能给我的任何帮助将不胜感激！

谢谢，安迪。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-03T13:56:17.477

这要感谢 Shiro 用户论坛上的 Milan Baran 的回答。github repo 已经更新，这里有一个简短的总结，以防有人感兴趣：

在 Bootstrap 类中，我们只需要添加一个 GuiceFilter，用于 /*，根本不需要默认服务器。所以，这就变成了：

```
public static void main(String[] args) throws Exception {
    Server server = new Server(8081);

    WebAppContext webAppContext = new WebAppContext();
    webAppContext.setContextPath("/");
    webAppContext.setResourceBase("src/main/webapp/");
    webAppContext.setParentLoaderPriority(true);

    webAppContext.addEventListener(new EgGuiceServletContextListener());

    webAppContext.addFilter(GuiceFilter.class, "/*", null);

    server.setHandler(webAppContext);

    server.start();
    server.join();
} 
```

然后我们需要更新 jersey servlet 模块以绑定 DefaultServlet 和 GuiceContainer，并将通过 GuiceContainer 的过滤器更改为通过 /api 而不是 /*，如下所示：

```
public class EgJerseyServletModule extends JerseyServletModule {

@Override
protected void configureServlets() {
    bindings();
    filters();
}

private void bindings() {
    bind(UuidDao.class);
    bind(UuidService.class);
    bind(DefaultServlet.class).asEagerSingleton();
    bind(GuiceContainer.class).asEagerSingleton();
    serve("/*").with(DefaultServlet.class);
}

private void filters() {
    filter("/*").through(GuiceShiroFilter.class);
    filter("/api/*").through(GuiceContainer.class);
}

} 
```

感谢大家对此的帮助！安迪。

# javascript - 按班级交换 Div

> ID：14059464
> 
> 赞同：0
> 
> 时间：2012-12-27T18:32:15.173
> 
> 标签：javascript, jquery, html

我已经看到了很多与此类似的问题，但我无法找到解决这个特定问题的问题，或者我认为。

我有一个以这种格式构建的页面，它控制网页动态部分的浓度，我想要它做的是随机基于具有“switchme”类的 div。所以基本上我希望所有内容都可以交换，而不会改变“switchme”中的内容，只是它在页面中的位置。我尝试了许多 javascript 和 jquery 脚本，但最终它总是在内部 div 周围移动

```
<div class= "switchme_container">
<div class = "switchme">
<div>Content</div>
<div>Content</div>
<div>Content</div>
<div>Content</div>
</div>
<div class = "switchme">
<div>Content</div>
<div></div>
<div></div>
<div></div>
</div>
<div class = "switchme">
<div>Content</div>
<div>Content</div>
<div>Content</div>
<div>Content</div>
</div>
</div>

<script>
function shuffle(sj) {              
var replace = $('<div>');
var size = sj.size();

while (size >= 1) {
   var randomize = Math.floor(Math.random() * size);
   var tempdiv = sj.get(randomize);      
   replace.append(tempdiv);        
   sj = sj.not(tempdiv); 

}
$('#switchme_container').html(replace.html() );   
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T18:58:11.690

您可以将元素复制`switchme`到数组中，以更明显的方式将它们打乱，然后将它们推回`switchme_container`元素中：

```
var shuffle = function(o){ //v1.0
    for(var j, x, i = o.length; i; j = parseInt(Math.random() * i), x = o[--i], o[i] = o[j], o[j] = x);
    return o;
};
$(".switchme_container").append(shuffle($.makeArray($(".switchme")))); 
```

jsFiddle：http: [//jsfiddle.net/D2jxe/2/](http://jsfiddle.net/D2jxe/2/)

jQuery 会自动移动每个元素而不是复制它，除非您在插入之前显式克隆它。

从这里复制的随机播放函数：[如何随机播放数组？](https://stackoverflow.com/questions/6274339/how-can-i-shuffle-an-array-in-javascript)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T18:40:58.910

移动某物的一般公式非常简单：

```
 $newParent.append($thingToMove); 
```

（注意：如果你想放弃事件处理程序/数据，`$thingToMove`你可以先调用`.remove()`它。）

如果这对您不起作用，则您需要解决调试问题，但这通常应该有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T18:54:34.687

我已将随机事件附加到按钮单击中，答案嵌入在以下代码的注释中：

```
​$('#randomize').click(function(ev){
    ev.preventDefault();

    var $sc = $('.switchme_container'),
        contentHolder = [],
        randomIndex;

    // detach .switchme elements from page and add to contentHolder array
    $sc.find('.switchme').each(function(i, el){
        contentHolder.push($(this).detach());
    });

    while (contentHolder.length) {

        // pick a random index of the contentHolder array
        randomIndex = Math.floor(Math.random() * contentHolder.length);

        // append it to the container
        $sc.append(contentHolder[randomIndex]);

        // slice that element out of the contentHolder array
        contentHolder = contentHolder.slice(0, randomIndex)
            .concat(contentHolder.slice(randomIndex + 1, contentHolder.length));
    }
});​​​​​​ 
```

## [看演示](http://jsfiddle.net/TZ2PM/)

# c - 在 C 中分配内存混淆

> ID：14059465
> 
> 赞同：3
> 
> 时间：2012-12-27T18:32:25.580
> 
> 标签：c, memory, struct, malloc

我已经做了很多环顾四周，但仍然无法理解它，假设我有结构：

```
struct some_struct {
    int x;
    int y;
    char *some_string;
}; 
```

假设我们有上面的结构，你将如何为上面的结构分配一些内存？一个人可以简单地做：

```
struct some_struct *test_struct;
test_struct = malloc(sizeof(struct some_struct)); 
```

但这足够了吗？你不需要分配一些内存`some_string`吗？或者如果结构包含更多指针，您是否也不需要为它们分配内存？

**编辑**：还有一件事......假设我的结构`some_struct`中已经有数据，例如

```
struct some_struct *test_struct = malloc(sizeof(some_string);
test_struct->x = 2;
test_struct->y = 3;
test_struct->some_string = "sadlfkajsdflk"; 
```

以下代码足以释放分配的内存吗？

```
free(test_struct); 
```

还是我也必须进去释放 char* some_string ？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-27T18:35:10.687

调用`malloc(sizeof(struct some_struct));`为您的结构提供内存，其中包括两个整数字段和一个指针字段的空间。

然而，指针字段在指向内存中的有效位置之前不能使用。为此，您需要将其指向一个有效的内存位置，例如为其分配内存`malloc`或将其指向一个预先存在的有效内存位置：

例如：

```
test_struct->some_string = malloc(100); // Allocate 100 bytes for the string 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-27T18:37:25.550

运行这两行代码后：

```
struct some_struct *test_struct;
test_struct = malloc(sizeof(struct some_struct)); 
```

您已经完成了足够的工作，可以开始使用`test_struct`. 指针的值只是一个内存地址，因此`malloc`分配了足够的两个`int`s 和一个`char*`。如果你想指向`test_struct->some_string`一个已经存在的`char*`，你可以这样做：

```
test_struct->some_string = some_other_char_pointer; 
```

否则，您还需要为其分配内存：

```
test_struct->some_string = malloc(...); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-27T18:35:09.853

您可能需要也可能不需要为字符串分配一些内存，具体取决于上下文。但是您提供的代码分配了保存该结构所需的所有内存。

基本上，编写代码来做你需要做的任何事情。字符串是否需要内存取决于您要做什么。

仅使用您显示的代码，您分配的指针并不指向任何特定的东西，就像您分配的整数不包含任何特定值一样。字符串的地址分配，如果需要，当您将 的值设置`some_string`为有用的东西时，可能同时设置`x`和`y`为有用的东西。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-27T22:40:40.953

好的，这段代码没有做你想做的事：

```
struct some_struct *test_struct = malloc(sizeof(some_string);
test_struct->x = 2;
test_struct->y = 3;
test_struct->some_string = "sadlfkajsdflk"; 
```

在这种情况下，您`*test_struct`现在指向一个具有 typeof`some_sring`大小的“内存区”（我认为您的 some_string 是`char*`）。

`Malloc(X)`为您提供`X`程序（或进程）虚拟内存的空间。当你这样做时：

```
struct some_struct *test_struct; 
```

您有足够的空间来存储指向`some_struct`.

如果你这样做：

```
malloc(sizeof(struct some_struct)); 
```

您现在已经`struct some_struct`从虚拟内存中保留了空间。但是您想知道该内存在“哪里”。这就是为什么你将它分配给指针：

```
test_struct = malloc (sizeof(struct some_struct)); 
```

[编辑]我会这样写：“为了让你的编译器更快乐，你还应该在其中包含一个强制转换，告诉编译器 malloc 分配的空间将用于存储`struct some_struct`：”，然后给出一个例子。但事实上，事实并非如此。正如您在下面的评论中看到的那样，@chutsu 纠正了这一点，为了说服自己，请检查这个[问题](https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc)。“主要原因”是你冒着很大的风险去做这件事，根本没有任何好处。
其余代码现已更正：无演员表。

一种更简洁的方法是对结构进行类型定义。然后，您的代码将如下所示：

```
typedef struct some_struct {
    int x;
    int y;
    char *some_string;
}SomeStruct;

SomeStruct *test_struct;
test_struct = malloc(sizeof(SomeStruct)); 
```

关于字符串分配。你可以这样想：用 malloc（及其兄弟 calloc、realloc...）创建的所有东西都需要释放！发生这种情况是因为所有其他变量都是函数的局部变量，即使 main 也是一个函数，并且这些变量在函数终止时被清除。

因此，在分配结构之后，如果您想要为字符串分配空间，则必须为其分配空间。

```
test_struct->some_string = malloc((YOUR_STRING_SIZE+SPACE_FOR_THE_STRING_TERMINATOR)*sizeof(char)); 
```

与 - `SPACE_FOR_THE_STRING_TERMINATOR=1`，`\0`字符。

然后，如果要释放，则`test_struct`必须先释放字符串，然后再释放结构，以相反的顺序，您将丢失指向字符串的指针并且会泄漏。它看起来像这样：

```
free(test_struct->some_string);
free(test_struct); 
```

就是这样，你完成了。

希望这可以帮助。

# c# - C#执行控制台命令

> ID：14059466
> 
> 赞同：-2
> 
> 时间：2012-12-27T18:32:32.630
> 
> 标签：c#, console

好的，所以我希望我的 C# 程序执行以下两个控制台命令。

```
takeown /f "c:\windows\system32\Utilman.exe"  
icacls "c:\windows\system32\Utilman.exe" /grant administrators:F 
```

我的问题是 C# 无法处理路径中的其他 "s。（也尝试使用转义序列但没有运气）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-27T18:35:12.693

如果你的意思是你有`"`嵌入在命令行参数的问题，你只需要转义它们：

```
Process.Start("takeown", @"/f ""c:\windows\system32\Utilman.exe""");
Process.Start("icacls", 
              @"""c:\windows\system32\Utilman.exe"" /grant administrators:F"); 
```

我使用逐字字符串文字（以 开头的字符串`@`）来避免`\`像其他字符串文字一样必须在路径中转义。

# java - Tomcat 管理器身份验证

> ID：14059468
> 
> 赞同：-1
> 
> 时间：2012-12-27T18:32:46.183
> 
> 标签：java, tomcat

我有一个构建应用程序的构建服务器。然后我将在运行 Tomcat 的情况下将 WAR 文件部署到生产服务器。我想为此使用 Tomcat 的管理器功能。

问题：调用应用管理器时可以使用哪些类型的身份验证？由于某些原因，我无法使用登录名/密码。我想使用诸如私钥/公钥对之类的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T21:34:39.597

开箱即用，Tomcat 的管理器 webapp 可以配置为使用任何 Web 应用程序支持的任何身份验证机制：FORM、BASIC、DIGEST 或 CLIENT-CERT。

CLIENT-CERT 是上述选项中唯一一个不使用用户名/密码的选项，因此这似乎是您唯一的选择。显然，您需要为 Tomcat 配置 SSL（这应该不是问题，因为对您的管理器应用程序使用不安全的 HTTP 非常愚蠢），并且您需要在证书链上方配置一个包含证书的信任库您要颁发的客户证书。

如果你想要更精细的东西，你将不得不自己构建它。

# postgresql - Postgres - 在从视图返回结果集之前更改值

> ID：14059469
> 
> 赞同：0
> 
> 时间：2012-12-27T18:32:55.940
> 
> 标签：postgresql

我有一个 postgres 视图，它返回以“Y”或“N”为值的记录，我想在返回最终 SQL 结果之前将它们转换为“是”或“否”。例如：

```
 CREATE OR REPLACE VIEW transit_info AS 
 SELECT 
 ('Train Service:'::text || tblpoi_transit_info.train_service::text AS train_service, 
```

我想根据记录的值将 train_service 转换为“是”或“否”。有什么方法可以轻松做到这一点？我一直在试验 CASE 语句，但还没有真正掌握语法。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T18:36:49.617

```
SELECT 
    ('Train Service:'::text
    ||
    case tblpoi_transit_info.train_service::text
        when 'Y' then 'Yes' else 'No'
    end AS train_service, 
```

# objective-c - 当我按下键盘按钮时，SearchBar 不起作用

> ID：14059472
> 
> 赞同：1
> 
> 时间：2012-12-27T18:33:13.167
> 
> 标签：objective-c, ios

我正在尝试在我的项目中实现搜索栏。

我已经创建了 SearchBar 插座，设置了委托，但是当我按下任何键盘按钮时，该按钮的值不会出现在`UISearchBar`

谁能告诉我为什么？

```
 - (void)searchBarSearchButtonClicked:(UISearchBar *)aSearchBar {

     // When the search button is tapped, add the search term to recents and conduct the search.
     NSString *searchString = [aSearchBar text];
     NSLog(searchString);
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T18:54:12.193

也许你忘了实现这个方法：

```
- (BOOL)searchBarShouldBeginEditing:(UISearchBar *)searchBar
{
    return YES;
} 
```

通过返回 YES，您“说”您接受编辑。

**编辑**

你甚至不需要实现这个方法，默认情况下 UISearchBar 接受编辑。
不需要实现额外的方法。

可以肯定的是，我刚刚做了以下事情：

*   在xib文件中拖了一个搜索栏；
*   通过 xib 将委托绑定到我的视图控制器；
*   实现了 searchBarSearchButtonClicked: 并在其上放置了一个断点。

完美运行。确保您以正确的方式完成所有工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T17:31:45.987

我错过了 appDelegate ，***applicationDidFinishLauching下面的代码***

```
 self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
[self.window makeKeyAndVisible]; 
```

现在 SearchBar 工作正常！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T19:04:45.417

我忘记了这个方法

```
-(BOOL) searchBar:(UISearchBar *)searchBar shouldChangeTextInRange:(NSRange)range replacementText:(NSString *)text {
    return YES;
} 
```

# java - 在 ProgressBar 上绘制一个字符串，例如 JProgressBar？

> ID：14059474
> 
> 赞同：8
> 
> 时间：2012-12-27T18:33:29.007
> 
> 标签：java, string, progress-bar, javafx, jprogressbar

我最近开始使用 JavaFX，并开始制作自定义 Swing 组件的 FX 版本。其中之一是倒计时计时器，其中`JProgressBar`涉及 a。`setString(String)`我会使用它的方法将当前时间绘制到条上。不幸的是，JavaFX 的`ProgressBar`. 我看到的最接近我正在寻找的东西是：

![计时器](../Images/7b37c91c516cab3850bafe91ab83f562.png) （[来源](http://www.asgteach.com/blog/?p=219)）

我不知道这是否需要一个全新的自定义组件，或者只是一个像`java.awt.Graphics`.

任何帮助将非常感激。谢谢 ：）

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-12-27T21:10:27.307

这是一个示例（我认为）可以满足您的问题。

```
class ProgressIndicatorBar extends StackPane {
  final private ReadOnlyDoubleProperty workDone;
  final private double totalWork;

  final private ProgressBar bar  = new ProgressBar();
  final private Text        text = new Text();
  final private String      labelFormatSpecifier;

  final private static int DEFAULT_LABEL_PADDING = 5;

  ProgressIndicatorBar(final ReadOnlyDoubleProperty workDone, final double totalWork, final String labelFormatSpecifier) {
    this.workDone  = workDone;
    this.totalWork = totalWork;
    this.labelFormatSpecifier = labelFormatSpecifier;

    syncProgress();
    workDone.addListener(new ChangeListener<Number>() {
      @Override public void changed(ObservableValue<? extends Number> observableValue, Number number, Number number2) {
        syncProgress();
      }
    });

    bar.setMaxWidth(Double.MAX_VALUE); // allows the progress bar to expand to fill available horizontal space.

    getChildren().setAll(bar, text);
  }

  // synchronizes the progress indicated with the work done.
  private void syncProgress() {
    if (workDone == null || totalWork == 0) {
      text.setText("");
      bar.setProgress(ProgressBar.INDETERMINATE_PROGRESS);
    } else {
      text.setText(String.format(labelFormatSpecifier, Math.ceil(workDone.get())));
      bar.setProgress(workDone.get() / totalWork);
    }

    bar.setMinHeight(text.getBoundsInLocal().getHeight() + DEFAULT_LABEL_PADDING * 2);
    bar.setMinWidth (text.getBoundsInLocal().getWidth()  + DEFAULT_LABEL_PADDING * 2);
  }
} 
```

还提供[完整的可执行测试工具](https://gist.github.com/4391775)。

示例程序输出：

![标记进度条](../Images/baa9237b3ee1eccbd75dc9512fd9072b.png)

# ruby-on-rails-3.2 - 在 Rails 3.2 中，如何清除数据库中的所有数据？

> ID：14059475
> 
> 赞同：0
> 
> 时间：2012-12-27T18:33:32.230
> 
> 标签：ruby-on-rails-3.2

我不想删除我的数据库结构，但我想清空它，有没有一个简单的命令可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T05:04:48.740

我不完全确定这一点，但尝试在您的项目文件夹上运行 rake -T 并查看您有什么任务.. 您可以尝试 rake db:schema:load，如果这不起作用，请尝试使用您自己的 truncate 任务作为在[这个例子](https://stackoverflow.com/questions/7755389/rake-task-to-truncate-all-tables-in-rails-3)中说明

# javascript - 参数未传递给函数

> ID：14059478
> 
> 赞同：-1
> 
> 时间：2012-12-27T18:33:43.193
> 
> 标签：javascript, jquery

我试图简单地将变量从点击事件传递给外部函数。测试未定义时，我不断获取我的 console.log 字符串。

这是我的点击事件。

```
 $("#previous, #next").click(function() {
        if ((this).id == 'next') {
            slideID++
        } else {
            slideID--
        }
        clearInterval($('#slides').data('interval'));
        $("ul.pagination li").removeClass("current");

        portfolioSwitch(slideID);
    }); 
```

我用slideID 的参数调用portfolioSwitch 函数。我已经用我的控制台测试了 slideID 是否存在。它带着我想要的 id 返回。

在我的功能上，我有这个代码。

```
if (portfolioSwitch.slideID === undefined) {
        console.log('Its undefined!');
} 
```

它仍然未定义。所以我对函数的实际参数做了一个console.log。

```
console.log(portfolioSwitch.slideID); 
```

它仍然是未定义的。为什么不通过？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T18:45:41.227

而不是`console.log(portfolioSwitch.slideID);`使用`console.log(slideID);`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T19:28:47.040

可能是变量portfolioSwitch.slideID 是私有的吗？函数内部

投资组合开关（slideID）{ this.slideID = slideID; //?

}

//使用它来公开内部函数。

# java - 无法找到或加载主类 - 在异常情况下

> ID：14059479
> 
> 赞同：1
> 
> 时间：2012-12-27T18:34:07.780
> 
> 标签：java, compilation, runtime, java-compiler-api

好吧，我知道这是一个非常常见、非常简单的问题，但我的问题却很不寻常。（我无法在互联网上的其他地方找到解决方案的情况。）所以，我有一些源代码，我正在通过`JavaCompiler`. 然后我尝试使用 Runtime 执行编译后的代码。（也就是说，`Runtime.getRuntime().exec(String[])`。）但是，当我尝试执行所述代码时，我得到`Could not find or load main class.`了有问题的源代码遵循这个基本模型：

```
package compiledCode;
public class Compiled
{
    public Compiled(){}
    public static void main(String[] args)
    {
        System.out.println("Hello!! ;D");
    }
} 
```

甚至该代码也不会执行。我仍然得到同样的错误。在此先感谢您的帮助。:)

*编辑：我详细采取的步骤如下：

1.  我从名为 code 的 String 中的上述代码开始。然后我创建一个 File 对象（在本例中为 Compiled.java。）

2.  我使用我已经测试过的自定义方法，并确保它可以编译文件（并且可以选择从中获取 Class 对象，但由于特定原因，我不能这样做。）成.class 文件。（使用`JavaCompiler`API。）

3.  然后我用`Runtime.getRuntime.exec(new String[]{"java",[location of .class file]});`它来执行它。

正是在这一点上，我得到了一个错误。

根据要求，我正在使用的确切代码是这个..

```
ClassFileHelper.toClass(src, "C:/Users/Steven/Desktop/ /Eclipse/Workspace/RoccedGame/ServiceCoder", "ServiceCoder");
System.out.println("java "+src.getAbsolutePath().substring(0,src.getAbsolutePath().lastIndexOf(".java"))+".class");
final Process p = Runtime.getRuntime().exec(new String[]{"java",src.getAbsolutePath().substring(0,src.getAbsolutePath().lastIndexOf(".java"))+".class"}); 
```

第 3 行中的字符串操作有点混乱，但我已经三重检查以确保它有效 - 它确实有效。如果您想查看 . `toClass()`比特，去[这里](http://www.mediafire.com/?0suzfoe5niwh6ae)。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T19:26:35.553

您没有将正确的参数传递给`Runtime.exec()`.

您传递已编译类文件的实际位置。但是，您应该传递一个类名，如果您的类在一个包中，您还需要将包层次结构的根作为`-classpath`参数传递。

这在 JDK 文档中有所描述：http: [//docs.oracle.com/javase/6/docs/technotes/tools/windows/java.html](http://docs.oracle.com/javase/6/docs/technotes/tools/windows/java.html)

# design-patterns - 批量更新设计模式

> ID：14059480
> 
> 赞同：1
> 
> 时间：2012-12-27T18:34:09.877
> 
> 标签：design-patterns, batch-processing

在我们的应用程序中，我们有一些用例需要更新数据库表中的大量条目。我们有一个用于与数据库交互的 DataAccess 对象。

更新代码如下所示。

```
String updateQuery = "UPDATE tbl SET column1=? WHERE column2=?";
for(i=0;;i++){
    Map<Integer, Object> params=new HashMap<Integer, Object>();
    params.put(1,"val"+i);
    params.put(2,"val"+i);
    DataAccess.addBatchParams(updateQuery,params);
}
DataAccess.executeBatch(updateQuery); 
```

内部 DataAccess.addBatchParams(..)

```
public void addBatchParams(String query, Map<Integer,Object> params){
    ..  // preparedStatements contains all params passed till now.
    ..  
    if(preparedStatements.size() >= BATCH_SIZE){
        executeBatch(query);
        //flush preparedStatements as it has been written to db
    }
    ..  
    ..  
} 
```

我担心的是，每当新开发人员使用此功能时，他无法知道他必须在每次批量更新结束时调用 executeBatch() 方法才能将最后几个小于 BATCH_SIZE 的条目刷新到数据库中。有没有更好的方法来做到这一点？是否有任何设计模式或用于进行数据库批量更新的东西？

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T18:42:33.473

将这两种方法合并在一起，并将`addBatchParams`and`executeBatch`方法设为私有。

```
public void executeBatch(String query, 
    List<? extends Map<Integer,Object>> paramsList) {
    for (Map<Integer,Object> params : paramsList) {
        addBatchParams(query, params);  
    }
    executeBatch(query);
} 
```

# math - 如何计算任意范围内的中间值

> ID：14059482
> 
> 赞同：0
> 
> 时间：2012-12-27T18:34:24.633
> 
> 标签：math, graphics, actionscript

我必须在屏幕上分布 N 个方格，并且必须根据屏幕上显示的方格数对它们进行缩放。鉴于我在屏幕上有 100 个正方形，如果我在屏幕上有 900 个正方形，它们的缩放因子将为 4，它们的缩放因子将为 1.1

如何计算 101 到 899 之间的中间比例因子？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T20:22:05.900

我不知道您使用什么函数来计算平方数函数中的比例因子。但是，如果有一个函数可以告诉您对于给定数量的平方需要什么比例因子，您可以使用积分：

该因子的中间值是 101 和 899 的函数除以 (899-101) 的积分。如果您不熟悉数学，您可以计算所有比例因子并将其除以总和中的项数。

例如：对于 100 = 4 和 900 = 1.1，中间值为：(4+1.1)/2=2.55

# search - Umbraco 使用下拉菜单检查搜索

> ID：14059492
> 
> 赞同：0
> 
> 时间：2012-12-27T18:35:13.967
> 
> 标签：search, umbraco

我正在考虑使用检查进行搜索。但我正在尝试使用下拉列表而不是搜索框。有办法吗？我最终也会有 3 个下拉列表。但现在我只想让 1 工作。

我正在使用这个很棒的例子：http: [//joeriks.com/2011/03/15/ajax-enabled-search-in-umbraco-using-examine-and-razor/](http://joeriks.com/2011/03/15/ajax-enabled-search-in-umbraco-using-examine-and-razor/)

但我需要它与下拉列表一起使用。我有我的下拉列表生成，但获得搜索检查东西的价值有点棘手。我已经为此工作了几天，需要寻求帮助。

任何人都可以帮忙吗？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T14:20:44.410

当您说下拉列表时，它将用于什么？您是否有效地只拥有用户可以从中选择的预先确定的搜索查询，或者您是否正在尝试构建某种过滤解决方案？

如果是前一个选项，与您提供的示例的唯一区别是您需要从下拉列表中获取所选值，并将其作为 searchString 参数传递给 ExamineManager.Instance.SearchProviderCollection[searchProvider].Search 方法。

但是，如果是后者，在我看来，您似乎是在对节点集合进行动态过滤之后，在这种情况下，您不一定必须使用检查 - 您可以简单地将转发器绑定到集合，然后应用过滤到下拉列表的 SelectedIndexChanged 事件上的集合。（[此链接](https://stackoverflow.com/questions/6955710/using-razor-linq-where-to-find-umbraco-nodes-with-a-certain-date-value)可能会有所帮助）

# c# - WCF 发现在防火墙关闭的同一子网中的两台计算机之间不起作用

> ID：14059493
> 
> 赞同：6
> 
> 时间：2012-12-27T18:35:14.050
> 
> 标签：c#, wcf

这个简单的 WCF 发现示例在单台机器上工作，但是当客户端和服务器在同一子网中的不同机器上运行且没有防火墙时，它就不起作用了。我错过了什么？

```
using System;
using System.Linq;
using System.Net;
using System.Net.Sockets;
using System.ServiceModel;
using System.ServiceModel.Discovery;

namespace WCFDiscovery
{
   class Program
   {
      static void Main(string[] args)
      {
         try { if (args.Length > 0) StartClient(); else StartServer(); }
         catch (Exception ex) { Console.WriteLine(ex); }
         finally { Console.WriteLine("press enter to quit..."); Console.ReadLine(); }
      }

      private static void StartServer()
      {
         var ipAddress = Dns.GetHostAddresses(Dns.GetHostName()).First(ip => ip.AddressFamily == AddressFamily.InterNetwork);
         var address = new Uri(string.Format("net.tcp://{0}:3702", ipAddress));
         var host = new ServiceHost(typeof(Service), address);
         host.AddServiceEndpoint(typeof(IService), new NetTcpBinding(), address);
         host.Description.Behaviors.Add(new ServiceDiscoveryBehavior());
         host.AddServiceEndpoint(new UdpDiscoveryEndpoint());
         host.Open();
         Console.WriteLine("Started on {0}", address);
      }

      private static void StartClient()
      {
         var dc = new DiscoveryClient(new UdpDiscoveryEndpoint());
         Console.WriteLine("Searching for service...");
         var findResponse = dc.Find(new FindCriteria(typeof(IService)));
         var response = ChannelFactory<IService>.CreateChannel(new NetTcpBinding(), findResponse.Endpoints[0].Address).Add(1, 2);
         Console.WriteLine("Service response: {0}", response);
      }
   }

   [ServiceContract] interface IService { [OperationContract] int Add(int x, int y); }

   class Service : IService { public int Add(int x, int y) { return x + y; } }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T18:12:46.117

我已经在 2 台不同的机器（笔记本（Win7）和塔式 PC（Win8）、.NET FW 4.5、相同的 WiFi 网络）上运行了您的代码，并收到以下异常：

```
A remote side security requirement was not fulfilled during authentication. Try increasing the ProtectionLevel and/or ImpersonationLevel. 
```

这是由于未指定服务安全性，找到了端点。因此，其他答案中的人是对的-这是一个无法通过更正代码来解决的网络问题。我要补充一点，问题的另一个可能来源可能是网络交换机不允许 UDP 广播。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T18:37:02.983

需要明确的是，Windows防火墙是否也关闭了？

还要确保将服务器绑定到其他计算机用来与之通信的地址。

本地主机或 127.0.0.1 可能不会连接到其外部（到主机）可寻址 IP，这是多播发现数据包将到达的地址。

[关于关闭 Windows 防火墙的 MSDN 说明](http://msdn.microsoft.com/en-us/library/ms751530.aspx)

# susy-compass - Susy：语法错误：未定义的操作：“1/0.623em 乘以 1em”

> ID：14059496
> 
> 赞同：0
> 
> 时间：2012-12-27T18:35:24.620
> 
> 标签：susy-compass

尝试将 susy 与 middlemanapp 一起使用[并](http://middlemanapp.com/)在基本设置后出现以下错误

```
Syntax error: Undefined operation: "1/0.623em times 1em"
        on line 32 of .... /gems/compass-0.12.2/frameworks/compass/stylesheets/compass/typography/_vertical_rhythm.scss
        etc.
        etc. 
```

信息：

```
gem "middleman", "~>3.0.7"
gem "susy", "~> 1.0.5"

$ ruby -v ====> ruby 1.9.3p194 (2012-04-20 revision 35410) [x86_64-darwin11.4.0] 
```

_grid.scss

```
@import "susy";

$total-columns  : 12;
$column-width   : 60px;
$gutter-width   : 20px;
$grid-padding   : $gutter-width;

.container { @include container; } 
```

# iphone - 在 iOS 上从前置扬声器播放音乐？

> ID：14059500
> 
> 赞同：0
> 
> 时间：2012-12-27T18:35:54.823
> 
> 标签：iphone, ios, speaker

是否可以从 iPhone 的前置扬声器而不是后置扬声器播放音乐？我的意思是，用于经典电话的扬声器而不是后置扬声器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T18:39:46.560

我认为这在 iOS 向其开发人员公开的公共 API 中是不可能的。更重要的是您提出这种要求的原因。你为什么需要这个？

此外，前置扬声器的音量较小，但非常适合接听电话；可能不是为了玩音乐...

Apple 可能会花费大量资金和研究来确定正确的声学效果（可能还有其他因素）以将扬声器放置在它所在的位置。你为什么要修补它？

# adobe - 时间戳落后 2 小时

> ID：14059501
> 
> 赞同：1
> 
> 时间：2012-12-27T18:36:00.427
> 
> 标签：adobe, timestamp, flash-builder

我有一个`MySQL`通过`ColdFusion`服务器访问数据库的 Adob​​e Flash Builder 应用程序。在`MySQL`数据库中有一个用时间戳填充的表。

当我将`ColdFusion`连接到时间戳表的数据服务绑定到`DataGrid`我的应用程序中时，每当我添加一个新的时间戳时，它都会正确地将其保存到数据库中，但它晚了 2 小时。我检查了数据库服务器、`ColdFusion`服务器和运行 Adob​​e Flash Builder 的计算机上的时间和时区设置，它们对于我的时区 (Central -6) 都是正确的。有谁知道我怎样才能让这些时间戳以正确的时间保存？我已经尝试了所有可以谷歌搜索的与类似问题有关的东西，但到目前为止我一无所获。我将提供帮助诊断问题和找到解决方案所需的任何其他信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T14:07:22.800

为了获得正确的时间，我必须实现以下代码：

```
var timeStamp:Date = new Date();
var timezone:int = -4;
timeStamp.hours = timeStamp.hoursUTC + timezone; 
```

奇怪的。所有服务器和客户端都有正确的时间，并且它们都在同一个时区。哦，好吧，至少它有效。感谢大家的帮助！

# python - 第一个字符被删除（正则表达式）

> ID：14059506
> 
> 赞同：2
> 
> 时间：2012-12-27T18:36:15.720
> 
> 标签：python, regex, python-3.x

我有这个正则表达式： `(?<=[.!?])\s[A-Z]` 我在这个文本上运行它：

```
The engineering plant, weapon and electronic systems, galley, and multitudinous other
equipment required to transform the new hull into an operating and habitable warship are
installed and tested. The prospective commanding officer, ship's officers, the petty
officers, and seamen who will form the crew report for training and intensive
familiarization with their new ship. 
```

它产生：

```
he engineering plant, weapon and electronic systems, galley, and multitudinous other
equipment required to transform the new hull into an operating and habitable warship are
installed and tested.
he prospective commanding officer, ship's officers, the petty officers, and seamen who
will form the crew report for training and intensive familiarization with their new ship. 
```

如您所见，它删除了句子的第一个字母。这不是因为它们是大写的（我测试过）。

如何修复它，使其不会删除句子的第一个字母？

（我正在使用 Python 3）

我使用了 re.split() 然后我打印了数组，用换行符分隔每个值

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T18:43:24.643

您的正则表达式匹配空白字符和大写 ASCII 字母，但前提是它们前面有一个点、感叹号或问号。

当您使用它来拆分文本时，大写字母成为用于拆分的分隔符的一部分，因此被删除。

将正则表达式更改为

```
(?<=[.!?])\s(?=[A-Z]) 
```

并且这封信不会成为匹配的一部分。

但是，请注意两件事：

1.  这仅在新句子以 ASCII 字母开头时才有效。对于大多数英语句子，您可能会没事，但对于其他语言肯定不行。
2.  如果您的文本包含缩写，则可能会出现一些错误的拆分：`Mr. Smith`并将`Dr. Jones`被拆分为两部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T18:44:37.327

问题出在您的正则表达式上，奇怪的是，当您使用“非消耗性标记”（即，积极的后视）作为标点符号（`(?<=[.!?])`）时，您没有检测每个句子的第一个字母（`[A-Z]`）。

因此，您使用的正则表达式`split()`将*消耗*每个匹配项的第一个大写字母。您可能打算不使用它（即仅使用其间的空间），在这种情况下，您希望使用不使用文本的正向前瞻：

```
(?<=[.!?])\s(?=[A-Z]) 
```

Lookaheads 和 lookbehinds 通常是锚点，并且锚点**不消耗**输入中的任何文本。最常用的锚点当然是`^`和`$`。它们只匹配输入文本中的*位置*，这是您想要的。

向后查找将匹配该位置的*前面文本*必须匹配/不匹配给定正则表达式的位置，而前瞻将匹配该位置的*后续文本*必须匹配/不匹配给定正则表达式的位置。在匹配的空格之后，您想要的是后面是大写字母的位置，因此使用与大写字母 ( being ) 匹配的正前瞻 ( `(?=<re>)`，其中是正则表达式)。`<re>``<re>``[A-Z]`

# c - Qsort比较函数

> ID：14059510
> 
> 赞同：11
> 
> 时间：2012-12-27T18:36:55.240
> 
> 标签：c, multidimensional-array, sorting, qsort

我是 C 的初学者，我试图了解 qsort 函数所需的比较函数。

## 第一部分：语法

一个简单的建议用法是（我也包含了一些 main() 代码来打印结果）：

```
#include <stdio.h>
#include <stdlib.h>

int values[] = { 40, 10, 100, 90, 20, 25, 12, 13, 10, 40 };

int compare(const void *a, const void *b)
{
    const int *ia = (const int *)a; // casting pointer types 
    const int *ib = (const int *)b;
    return *ia  - *ib; 
}

int main()
{
    int n;
    for (n=0; n<10; n++)
    {
        printf("%d ",values[n]);
    }
    printf("\n");
    qsort(values, 10, sizeof(int), compare);
    for (n=0; n<10; n++)
    {
        printf("%d ",values[n]);
    }
    printf("\n");
    system("pause");
    return 0;
} 
```

我不明白为什么您需要比较功能中的所有额外内容，所以我将其简化为：

```
int compare (int *a, int *b)
    {
        return *a-*b; 
    } 
```

这仍然有效，并产生相同的结果。谁能向我解释我删除了什么，为什么它仍然有效？

## 第二部分：为什么是指针？

另外，我真的需要使用指针吗？为什么我不能像这样直接比较“a”和“b”（这不起作用）：

```
int compare (int a, int b)
        {
            return a-b; 
        } 
```

出于某种原因，使用多维数组，我能够摆脱不使用指针的情况，并且由于某种原因它起作用了！到底是怎么回事？（按每个子数组中的第 2 项对多维数组进行排序的示例代码）：

```
#include <stdio.h>
#include <stdlib.h>

int values[7][3] = { {40,55}, {10,52}, {100,8}, {90,90}, {20,91}, {25,24} };

int compare(int a[2], int b[2])
{
    return a[1] - b[1];
}

int main()
{
    int n;
    for (n=0; n<6; n++)
    {
        printf("%d,",values[n][0]);
        printf("%d ",values[n][1]);
    }
    printf("\n");
    qsort(values, 6, sizeof(int)*3, compare);
    for (n=0; n<6; n++)
    {
        printf("%d,",values[n][0]);
        printf("%d ",values[n][1]);
    }
    printf("\n");
    system("pause");
    return 0;
} 
```

我真的很高兴多维数组排序正在工作，因为这是我的**最终目标**，但我不知道我是如何设法让它工作的（除了愚蠢的运气和砍掉代码）所以我真的很喜欢一些解释为什么我提供的一些示例有效，而为什么有些无效！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-27T18:46:35.563

> 这仍然有效，并产生相同的结果。谁能向我解释我删除了什么，为什么它仍然有效？

您正在 C 中调用未定义的行为。请参阅 C99 6.3.2.3 Pointers/8：

> 指向一种类型的函数的指针可以转换为指向另一种类型的函数的指针，然后再返回；结果应与原始指针比较。如果转换后的指针用于调用类型与指向的类型不兼容的函数，则行为未定义。

在 C++ 中，这个程序是完全格式错误的：http: [//ideone.com/9zRYSj](http://ideone.com/9zRYSj)

它仍然“碰巧起作用”，因为该`compare`函数需要一对指针；并且在您的特定平台`sizeof(void*)`上与 相同`sizeof(int*)`，因此调用类型的函数指针`int(void *, void *)`实际上包含指向类型函数的`int(int *, int *)`指针*实际上*与在该特定时间点在您的特定平台上强制转换的指针类型相同。

> 另外，我真的需要使用指针吗？为什么我不能像这样直接比较“a”和“b”（这不起作用）：

因为`qsort`对任何两种类型都有一个通用的比较函数；不只是`int`。所以它不知道指针被取消引用的类型。

> 出于某种原因，使用多维数组，我能够摆脱不使用指针的情况，并且由于某种原因它起作用了！到底是怎么回事！

这是因为以下原型是相同的：

1.  `int foo(int *a, int *b);`
2.  `int foo(int a[], int b[])`

也就是说，数组在传递给函数时*会衰减为指针。*像您一样明确指定数组的长度：

```
int foo(int a[2], int b[2]) 
```

导致编译器生成`sizeof`和其他编译时间位将项目视为二元素数组；但是当它下降到机器级别时，该函数仍然接受一对指针。

在任何这些情况下，传递一个不接受一对`void *`s 的比较函数都会导致未定义的行为。“未定义行为”的一个有效结果是“它似乎起作用了”。另一个有效结果是“它在星期二工作”或“它格式化硬盘”。不要依赖这种行为。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-27T18:43:27.517

> 我不明白为什么您需要比较功能中的所有额外内容，所以我将其简化为

是否使用`const`限定符取决于您。您不应修改比较器中的值。但是有可能放弃`const`并打破你对编译器的承诺。

* * *

**[qsort](http://www.kernel.org/doc/man-pages/online/pages/man3/qsort.3.html)**需要一个函数指针，它接受两个`const void *`作为参数，这就是为比较器函数传递指针的原因：

```
 void qsort(void *base, size_t nmemb, size_t size,
                  int(*compare)(const void *, const void *)); 
```

所以传递`a`and`b`会导致将*值*解释为指针，这显然是错误的。

* * *

它无需为多维数组传递指针即可工作，因为当您传递数组时，它们会衰减为指针。因此，您拥有的以下比较器是可以的。

```
int compare (int a[2], int b[2])
{
    return a[1] - b[1];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-08T01:37:24.497

我想确认提出原始问题的 Dlinet 的意见。

C 编译器确实会接受所有形式的比较函数，即使没有 const，甚至使用 int * 代替 void *。但是，我的 C++ 编译器拒绝这些变化，只接受 const void * 形式。

C 编译器甚至接受 int 形式，根本不使用指针。我查了一下发现比较函数的int形式接收的是*指针*值，而不是数组的int。结果是数组没有排序，但保持相同的顺序。我认为这一切都是你所期望的。

因此，似乎您可以在函数定义中使用 int * 而不是 void *，然后不需要在函数内进行强制转换。

这是否是一种好的编程习惯尚无定论，有些程序员说是，有些人说不是。在我看来，无论编程是否良好，减少混乱将是支持使用 int * 而不是 void * 的一点。但是，C++ 编译器不允许您这样做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-27T18:42:11.227

答案很简单：从 qsort [http://pubs.opengroup.org/onlinepubs/009695399/functions/qsort.html](http://pubs.opengroup.org/onlinepubs/009695399/functions/qsort.html)的手册中 ，函数指针的原型是：

```
int comp(const void *a, const void *b) 
```

与此原型关联的 typedef 可以这样声明

```
typedef int (*comp_qsort_funct_t) ( const void *, const void * ) 
```

`comp_qsort_funct_t`函数指针的类型在哪里

qsort 的比较函数的原型是使用 const 变量，因为这是一个很好的实践/设计，因为数据不会被修改。

根据编译器/平台的不同，使用不同的原型可能会导致意外结果。或者只是编译失败，评论中提供的示例：http: [//ideone.com/9zRYSj](http://ideone.com/9zRYSj)

所以你不应该使用不同的原型。

# c# - 以编程方式将数据添加到类型化数据集

> ID：14059511
> 
> 赞同：2
> 
> 时间：2012-12-27T18:36:57.220
> 
> 标签：c#, asp.net, dataset, strongly-typed-dataset

为什么我得到“位置 0 没有行”异常：

```
DSGeneral dg = new DSGeneral();

// I create 1 table
DSGeneral.GeneralDataTable t = new DSGeneral.GeneralDataTable();
dg.Tables.Add(t);

// The 1st row
DSGeneral.GeneralRow r = t.NewGeneralRow();
r.Code = "code";
r.Value = "7";
t.Rows.Add(r);

// The 2nd row
DSGeneral.GeneralRow r2 = t.NewGeneralRow();
r2.Code = "exp";
r2.Value = "5";
t.Rows.Add(r2); 
```

它在这里抛出：

```
int numClave = Convert.ToInt16(dg.General[0].Value); 
```

此外，调试我可以看到我的类型化数据集`dg`有 2 个表，我想知道为什么。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-27T18:40:06.963

当您使用[强类型`DataSets`](http://msdn.microsoft.com/en-us/library/esbykkzb%28v=vs.110%29.aspx)时，您在设计器上声明表和数据适配器。`DataTables`then 已经是其中的一部分，`DataSets`因此您无需再次将它们添加到其中。

这就解释了为什么数据集包含两个表而不是一个表。由于同样的原因，你得到了例外。您已将行添加到手动创建的表中，而不是添加到声明式添加的表中。

但

```
 dg.General[0].Rows[0].Value 
```

`DataTable`访问仍然为空的自动生成的。

所以你只需要使用可用的表：

```
DSGeneral dg = new DSGeneral();
DSGeneral.GeneralRow r = dg.General.NewGeneralRow();
r.Code = "code";
r.Value = "7";
dg.General.AddGeneralRow(r); 
```

# php - 如何在 Yii $criteria 中使用 DATE_ADD？

> ID：14059514
> 
> 赞同：5
> 
> 时间：2012-12-27T18:37:06.573
> 
> 标签：php, yii

模型.php

```
// Declare $datetime_limit
public datetime_limit; 
```

控制器.php

```
// datetime_limit should be the actual datetime + 5 days
$criteria->select="DATE_ADD(NOW(), INTERVAL 5 DAY) AS datetime_limit"; 
```

错误信息：

```
Active record "Users" is trying to select an invalid column "DATE_ADD(NOW()". Note, the column must exist in the table or be an expression with alias. 
```

* * *

编辑1：

我想使用关系表（多对多）过滤带有条件的查找。所以`datetime_limit`不能有关系`events.datetime`。我怎样才能做到这一点？

```
$criteria->select=array("DATE_ADD(NOW(), INTERVAL 5 DAY) AS datetime_limit");
$criteria->with=array('events');
$criteria->having='datetime_limit!=`events`.`datetime`';
$models=Users::model()->findAll($criteria); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-27T19:15:41.253

这个异常被抛出[`CActiveFinder::getColumnSelect`](https://github.com/yiisoft/yii/blob/1.1.12/framework/db/ar/CActiveFinder.php#L885)。

When`CDbCriteria::$select`是一个字符串，它被视为逗号分隔的列的简单列表。您的表达式被解释为两个不同的列。`select`您可以通过自己设置数组来解决此问题- 在这种情况下，逗号拆分未完成¹：

```
$criteria = new CDbCriteria();
$criteria->select = array("DATE_ADD(NOW(), INTERVAL 5 DAY) AS datetime_limit");
$models = Users::model()->findAll($criteria); 
```

请注意，如果您编写的别名与公共模型属性或数据库字段不对应，它将被检索但会被忽略 - 由于某种原因，Yii 不会为此抛出异常。

* * *

¹但是，此函数仍会尝试`.`在表达式中查找 a 并将其后面的部分解释为列标识符 - 不要`.`在您的表达式中使用，您应该没问题。

# php - 如何使用相应的 $_POST 值填充预先存在的多维数组？

> ID：14059527
> 
> 赞同：0
> 
> 时间：2012-12-27T18:38:09.030
> 
> 标签：php, post, recursion, multidimensional-array, overwrite

`array_replace_recursive`如果不从第二个数组创建新值，我找不到一个函数。

基本上，出于建设性目的，我有这个带有空值的数组。然后我想从中复制`$_POST`具有相同键的数据。但我不希望复制外键的值。

```
$array = array(
  'one' => '',
  'two' => array(
    'this' => '',
    'that' => '',
  ),
  // ...
);

$_POST = array(
  'one' => 'a',
  'two' => array(
    'this' => 'b',
    'that' => 'c',
    'dontcopyme' => '...',
  ),
  'dontcopyme' => 'x',
  // ...
);

//$new_array = array_merge_recursive($array, $_POST);
//$new_array = array_replace_reursive($array, $_POST);
$new_array = array_dosomemagic($array, $_POST); 
```

在这个示范案例中我所追求的结果：

```
array(
  'one' => 'a'
  'two' => array(
    'this' => 'b'
    'that' => 'c'
  )
)

print_r($new_array); 
```

注意：多维数组

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-09-08T09:40:34.183

对不起，这不是一个性感的单行，但递归很难塞进一行。

我的方法包括一些重要`isset()`的检查，以确保数组元素在尝试访问它们之前存在。您不应该在我的函数中看到任何警告/通知。

代码：（[演示](http://sandbox.onlinephpfunctions.com/code/b73e8e93329afdb683f2854f6a18c06d92ca53c8)）

```
function recursivePopulate($defaults,$post){
    foreach($defaults as $key=>&$elem){  // make $elem modifiable by reference
        if(!is_array($elem) && isset($post[$key])){  // if not an array and matching element in $_POST
            $elem=$post[$key];  // store $post 
        }elseif(isset($post[$key])){  // only recurse subarray if exists in BOTH arrays
            $elem=recursivePopulate($elem,$post[$key]); // recurse using subarray
        }
    }
    return $defaults;
}

$defaults=[
    'one'=>'one',
    'two'=>[
        'this'=>'this',
        'that'=>'that',
            ['deep'=>'no match']
    ]
];

$_POST=[
  'one'=>'New One',
  'two'=>[
    'this'=>'New This',
    'that'=>'New That',
    'dontcopyme'=>'...'
  ],
  'dontcopyme' => 'X'
];

var_export(recursivePopulate($defaults,$_POST)); 
```

输出：

```
array (
  'one' => 'New One',
  'two' => 
  array (
    'this' => 'New This',
    'that' => 'New That',
    0 => 
    array (
      'deep' => 'no match',
    ),
  ),
) 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-27T18:40:38.097

你可能想要[array_intersect_key()](http://it1.php.net/manual/en/function.array-intersect-key.php)

```
<?php
$array1 = array('blue'  => 1, 'red'  => 2, 'green'  => 3, 'purple' => 4);
$array2 = array('green' => 5, 'blue' => 6, 'yellow' => 7, 'cyan'   => 8);

var_dump(array_intersect_key($array1, $array2));

array(2) {
  ["blue"]=>
  int(1)
  ["green"]=>
  int(3)
}
?> 
```

# magento - 重新索引后不显示 Magento 自定义选项

> ID：14059528
> 
> 赞同：0
> 
> 时间：2012-12-27T18:38:15.473
> 
> 标签：magento, magento-1.6

我有一个magento商店，其中“自定义选项”在重新索引后消失，我索引哪个缓存似乎并不重要，但是在索引开始或完成后，前端的“自定义选项”视图将消失。重新启用自定义选项的唯一方法是从后端重新保存选项。如果我将要求设置为“否”，它似乎适用于某些项目，但这不适用于其他问题。

商店正在运行版本 1.6.2.0，使用默认主题，错误日志中没有任何明显的显示

任何故障排除建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T12:30:27.167

试试这个 - 转到管理产品 - 选择您遇到问题的产品。在标签为“设计”的选项卡下，转到“显示产品选项”并将值更改为“产品信息列”

# python - 如何应用 ndimage.generic_filter()

> ID：14059529
> 
> 赞同：4
> 
> 时间：2012-12-27T18:38:27.603
> 
> 标签：python, scipy

我正在尝试学习 ndimage，但我不知道[generic_filter()](http://docs.scipy.org/doc/scipy/reference/generated/scipy.ndimage.filters.generic_filter.html)函数是如何工作的。文档提到用户功能将应用于用户定义的足迹，但不知何故我无法做到。这是示例：

```
>>> import numpy as np
>>> from scipy import ndimage
>>> im = np.ones((20, 20)) * np.arange(20)
>>> footprint = np.array([[0,0,1],
...                       [0,0,0],
...                       [1,0,0]])
... 
>>> def test(x):
...     return x * 0.5
... 
>>> res = ndimage.generic_filter(im, test, footprint=footprint)
Traceback (most recent call last):
  File "<Engine input>", line 1, in <module>
  File "C:\Python27\lib\site-packages\scipy\ndimage\filters.py", line 1142, in generic_filter
    cval, origins, extra_arguments, extra_keywords)
TypeError: only length-1 arrays can be converted to Python scalars 
```

我希望`x`传递给`test()`函数的值是每个数组样本的那些真实足迹相邻元素，所以在这个示例中，形状为 (2,) 的数组，但我得到了上述错误。

我究竟做错了什么？
如何告诉通用过滤器对指定的相邻点应用简单的值计算？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-27T19:18:24.123

传递给的函数`ndimage.generic_filter`必须将数组映射到标量。该数组将是一维的，并包含`im`已被`footprint`.

对于 中的每个位置`res`，函数返回的值是分配给该位置的值。这就是为什么函数自然需要返回一个标量的原因。

所以，例如，

```
def test(x):
    return (x*0.5).sum() 
```

会工作。

# bash - rsync 带有引用路径的多个目录

> ID：14059532
> 
> 赞同：1
> 
> 时间：2012-12-27T18:38:43.007
> 
> 标签：bash, quotes, rsync, filepath

我正在尝试在 bash 脚本内的一次调用中同步多个目录，并且在引用路径的语法方面遇到了麻烦。

这是我正在尝试的：

```
backuppath='/path/to/backup/folders/'
declare -a backupitems=('folder1' 'folder2')
backupitems=(${backupitems[@]/#/\"$backuppath})
backupitems=(${backupitems[@]/%/\"})
backup=${backupitems[@]}

rsync ${backup} /path/to/destination 
```

我收到一个 link_stat 错误，说没有这样的文件或目录`"/path/to/current/directory"/path/to/backup/folders/folder1""`，然后是 folder2 的相同错误。因此，它似乎正在生成我想要的引用路径，但 rsync 将路径解释为相对路径并添加到前面当前目录的路径。如果我这样做，rsync 可以正常工作

```
backuppath='path/to/backup/folders/folder1'
rsync "${backuppath}" /path/to/destination 
```

将引号放入 rsync 命令中，但我不能对一个变量中的多个文件夹执行此操作，因为它将多个目录视为一条长路径。我通过遍历文件夹并在每个文件夹上调用 rsync 使脚本使用第二种方法工作，但是由于脚本的其他部分处理文件夹的方式，这种方法稍微有点尴尬，所以我想获得第一种方法如果有一个快速修复工作。

**编辑：**

对于上面的顶级版本，任何目录名称中都没有空格，我看到以下命令使用`set -vx`： rsync '"/path/to/backup/folders/folder1"' '"/path/to/backup/folders/folder2 "' /路径/到/目的地

我收到以下错误消息：

```
rsync: link_stat "/path/to/current/directory/"/path/to/backup/folders/folder1"" failed: No such file or directory (2) 
```

如果我使用@kdubs 建议的版本，那么当路径中没有空格时一切正常。

当路径中有空格时，kdubs 版本会导致命令：

rsync /path/to/back up/folders/folder1 /path/to/back up/folders/folder2 /path/to/destination

和错误：

```
rsync: link_stat "/path/to/back" failed: No such file or directory (2)
rsync: link_stat "/path/to/back up/up/folder1" failed: No such file or directory (2) 
```

我的第一个版本需要额外的调整来处理空格，因为用 [@] 扩展数组并通过用 () 包围扩展来创建一个新数组会导致路径中的空格将路径分解为多个数组元素（参见 Tonin 的回答以下）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-28T06:51:16.153

在变量中嵌入引号没有任何用处。做这种事情的最好方法是在扩展变量时在变量周围加上双引号，并将数组扩展为`"${arrayname[@]}"`-- 这样 bash 会将数组的每个元素视为一个单独的单词，即使它们包含空格或其他外壳元字符。棘手的事情是在数组的每个元素前面加上 $backuppath，但你有正确的方法（除了在它周围加上引号，而不是在值中）：

```
backuppath='/path/with spaces/'
backupitems=('folder 1' 'folder 2')   # declare -a is optional
backupitempaths=("${backupitems[@]/#/$backuppath}")

rsync "${backupitempaths[@]}" /path/to/destination 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T20:52:25.620

脚本中的问题在于 bash 定义数组元素的方式。元素由空格分隔。因此，当您将修改后的数组元素重新分配回数组时，您实际上创建的元素比最初的要多。`echo ${#backupitems[@]}`您可以通过在数组声明和每个分配之后添加一个来看到这一点。

最后，当您将变量中的数组展平时`$backup`，bash 通过使 rsync 相信它具有相对路径，甚至使情况变得更糟。

为了解决这个问题，我将使用以下脚本来处理文件名中的空格（或路径中的任何位置）：

```
backuppath='/path/to/backup/folders/'
declare -a backupitems=('folder 1' 'folder 2')
PIFS=$IFS
# prevents creating new elements from the original array
IFS=''
backupitems=(${backupitems[@]/#/$backuppath})

rsync ${backupitems[@]} /path/to/destination
IFS=$PIFS 
```

该脚本重新声明了`IFS`在创建数组时更改有关记录分隔符的 bash 行为的变量。不过，与您的脚本略有不同，因为该`$backup`变量不能再使用，否则您将在实际使用之前将数组展平。让我们希望这不是一个要求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T19:37:48.810

摆脱那些引号：

```
backuppath='/path/to/backup/folders/'
declare -a backupitems=('folder1' 'folder2')
backupitems=(${backupitems[@]/#/$backuppath})
backup=${backupitems[@]}

rsync ${backup} /path/to/destination 
```

# mysql - 如何连接两个表，同时根据引用第三个表的条件排除数据？

> ID：14059534
> 
> 赞同：0
> 
> 时间：2012-12-27T18:38:47.567
> 
> 标签：mysql, sql

基本上，我有三个表：

*   **cdr**，其中包含字段`dst`(destination)、`billsec`(duration) 和`calldate`
*   **Intlrates**，其中包含`code`（国家代码）和`cost`（每分钟）。
*   和**areacode**，其中包含`areacode`、`state`和`city`。

目前我有一个声明，增加了调用每个代码的总成本，如下：

```
SELECT
  mapgtalkexten.Intlrates.`Code`,
  sum(mapgtalkexten.Intlrates.Cost * (cdr.billsec/60)) as totals
FROM
  cdr JOIN mapgtalkexten.Intlrates ON    
  ((`Code` = SUBSTRING(dst, 4, 3) or `Code` = SUBSTR(dst, 4, 2))
   and dst like "011%")
  --The above limits the join to only calls where the destination phone number
  --requires the exit code (011) and the country code is 2 or 3 digits    
  or (`Code` = SUBSTR(dst, 2, 3) and dst like "1%")
  --The above was written to also join countries where the NANP format was used
  --(i.e. +1787 for Puerto Rico.)    
WHERE
  cdr.calldate like "2012-11%"
  and billsec >0
GROUP BY
  mapgtalkexten.Intlrates.`Code` 
```

输出示例：

```
Code | totals
--------------
212  | 2.035
240  | 170.76
352  | 2.268
49   | 0.45 
```

现在，我的问题是：该`Intlrates`表在 NANP 和非 NANP 代码之间没有区别。这意味着在我的加入中，两者：

`011212`（摩洛哥）和`1212`（纽约）都被添加到总数中。第一个很好，第二个不应该增加总数。

为了避免这种情况，有没有办法将连接的第二个条件修改为以下内容：

```
`Code` = SUBSTR(dst, 2, 3) AND SUBSTR(dst, 2, 3) != areacode.areacode 
```

基本上使它只有在代码匹配并且代码不在国家区号表中时才会加入。

我认为有一种方法可以通过连接（或者可能存在）来做到这一点，但是在数据库方面我非常不适应，并且完全不知道我将如何去实现它。抱歉，如果您需要更多信息/这个问题是荒谬的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T18:49:38.500

使用通配符列选择器`*`时，您可以获得连接操作中使用的所有表的所有列。如果您指定哪些表，通配符`t1.*, t2.*`只允许您从这些表中获取列。

知道即使您连接（并过滤）了三个表，您也可以从两个表中选择信息。

```
SELECT        t1.*,
              t2.*
    FROM      table_1 AS t1
    LEFT JOIN table_2 AS t2
        ON    /*clauses*/
    LEFT JOIN table_3 AS t3
        ON    /*clauses*/
    WHERE    t3.column = value; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T18:47:34.723

您可以在 SELECT 末尾添加 HAVING 语句，如下所示

```
HAVING `Code` = SUBSTR(dst, 2, 3) AND SUBSTR(dst, 2, 3) != areacode.areacode 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-12-27T18:52:04.737

你会想要这样的东西：

```
 select results.*  
 from   
 (    
     --two table query here
 )results,third_table  
  where third_table.foo = results.bar
   --filter third table here 
```

这样做是生成前两个表的结果集，然后删除`third_table`满足条件的记录。

# zk - Zk 5.0.11 NullPointerException 在列表框中使用完成属性时

> ID：14059545
> 
> 赞同：1
> 
> 时间：2012-12-27T18:39:27.740
> 
> 标签：zk

当使用一个简单的实现示例时，在一个列表框中，我得到一个空指针异常，我无法摆脱它。 [http://zkfiddle.org/sample/38ipduo/44-Listbox-fulfill-attr-error](http://zkfiddle.org/sample/38ipduo/44-Listbox-fulfill-attr-error)

上面的小提琴提供了一个错误的工作示例。调试代码，可以看到下一行

```
org.zkoss.zk.ui.impl.UiEngineImpl$FulfillListener.<init>(UiEngineImpl.java:2058) 
```

被调用两次。第一次似乎一切正常，但第二次似乎有些数据没有填写，导致 NPE。有什么想法可以让小提琴正常工作吗？人提前谢谢。

例如

```
<listcell>
  <button id="btn" label="show" ></button>
      <div fulfill="btn.onClick">
      Hello world
      </div>
  <textbox value="@{person.name}" inplace="true" ></textbox>
</listcell> 
```

我正在尝试使用单个记录的列表，因为 zk 论坛中的一个初始答案表明几个 id="btn" 元素可能会导致冲突。小提琴正在使用 zk 5。我尝试使用 6.5 并得到了类似的错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T23:11:41.613

如果您在使用 6.5 时阅读了错误，您会看到 zk 尝试将其添加`div`
到`button`作为子项中，这是不可能的。
我不确定这是否是一个错误，您可以查看`fulfill`zk doc 的部分。
使用[事件监听](http://books.zkoss.org/wiki/ZK_Developer%27s_Reference/Event_Handling/Event_Listening)并`Component`在 java 端添加应该是最好的解决方法。

# apache - .htaccess 从动态页面 url 到静态

> ID：14059546
> 
> 赞同：1
> 
> 时间：2012-12-27T18:39:31.110
> 
> 标签：apache, .htaccess, mod-rewrite, apache2

我想创建 .htaccess 的动态规则来重定向页面：

```
http://www.mydomain.com/subdir/index.php?id=11&title=my-page-title 
```

到：

```
http://www.mydomain.com/11/my-page-title 
```

其中： - id 是整数 - 标题是字符串

我在堆栈溢出中发现了一个类似的示例，但只有一个`$_GET`值，而不是[.htaccess 动态到静态 URL](https://stackoverflow.com/questions/9402335/htaccess-dynamic-to-static-url)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-27T18:44:33.580

你的措辞实际上是错误的。您要做的是路由传入的请求，例如：

```
http://www.mydomain.com/11/my-page-title 
```

到脚本`/subdir/index.php`

```
RewriteEngine On
RewriteRule ^/?(.*)/(.*)$ /subdir/index.php?id=$1$title=$2 [L,QSA] 
```

请注意，这种特殊方法将重定向`*/*`格式服务器上的所有内容。如果您需要对静态文件进行例外处理或只希望某些模式重定向，您应该在您的问题中更加具体。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-27T18:41:28.200

在这里试试这个：

```
RewriteRule /([0-9]+)/([a-z-]+) subdir/index.php?id=$1&title=$2 
```

该规则将查找一个至少有 1 个数字和一个小写字符串的数字，该字符串可以包含减号，这可能是`a`或`-`也可能是。

# android - 如何在 AndroidPlot 中删除图表周围的所有空间？

> ID：14059553
> 
> 赞同：5
> 
> 时间：2012-12-27T18:40:14.877
> 
> 标签：android, androidplot

我有一个在应用程序中使用 androidPlot 的简约图表，并且一直在尝试删除无关的视觉元素。我已经完成了一切，除了我无法摆脱视图中图表本身周围的一些空白区域。这是打开标记后的样子，只是坐在 Activity 的根视图中：

![我的图表是什么样的](../Images/e4d2d09121a43fadf65155ffa0e47841.png)

如何消除图表内部边界和外部视图边界之间的黑色空间？这是我的代码：

```
 mDynamicPlot = (XYPlot) findViewById(R.id.dynamicPlot);
    mDynamicPlot.getGraphWidget().setDomainValueFormat(new DecimalFormat("0"));
    mDynamicPlot.addSeries(mCpuData, new LineAndPointFormatter(Color.rgb(51, 204, 255), null, Color.rgb(8, 153, 194)));
    mDynamicPlot.setDomainStepMode(XYStepMode.INCREMENT_BY_VAL);
    mDynamicPlot.setRangeBoundaries(0, 100, BoundaryMode.FIXED);
    mDynamicPlot.setDomainStepValue(10);
    mDynamicPlot.setRangeStepValue(5.0d);
    mDynamicPlot.setRangeValueFormat(new DecimalFormat("#"));

    mDynamicPlot.setTicksPerDomainLabel(Integer.MAX_VALUE);
    mDynamicPlot.getLayoutManager().remove(mDynamicPlot.getLegendWidget());
    mDynamicPlot.getLayoutManager().remove(mDynamicPlot.getRangeLabelWidget());
    mDynamicPlot.getLayoutManager().remove(mDynamicPlot.getDomainLabelWidget());
    mDynamicPlot.getLayoutManager().remove(mDynamicPlot.getTitleWidget());

    mDynamicPlot.getGraphWidget().setMarginTop(10);        

    mDynamicPlot.setBackgroundPaint(null);
    mDynamicPlot.getGraphWidget().setBackgroundPaint(null);
    mDynamicPlot.getGraphWidget().setGridBackgroundPaint(null);

    mDynamicPlot.getGraphWidget().setDomainLabelPaint(null);
    mDynamicPlot.getGraphWidget().setDomainOriginLabelPaint(null);

    mDynamicPlot.getGraphWidget().setGridLinePaint(null);
    mDynamicPlot.getGraphWidget().setDomainOriginLinePaint(null);
    mDynamicPlot.getGraphWidget().setRangeOriginLinePaint(null);

    mDynamicPlot.setDrawBorderEnabled(false); 
```

还有我的 XML。右边距是为了抵消我想摆脱的左边空间：

```
<com.androidplot.xy.XYPlot
    android:id="@+id/dynamicPlot"
    android:layout_width="fill_parent"
    android:layout_height="150dp"
    android:layout_marginTop="16dp"
    android:layout_marginRight="10dp"
    title="Dynamic Plot" /> 
```

我在 XML 中所做的一切似乎都不会影响内部边界，包括更改封闭布局的重力。我也试过这些，没有效果：

```
 mDynamicPlot.getRangeLabelWidget().setHeight(0);
    mDynamicPlot.getRangeLabelWidget().setPadding(0, 0, 0, 0);
    mDynamicPlot.getRangeLabelWidget().setMargins(0, 0, 0, 0);

    mDynamicPlot.getLegendWidget().setSize(new SizeMetrics(0, SizeLayoutType.ABSOLUTE, 0, SizeLayoutType.ABSOLUTE));
    mDynamicPlot.getRangeLabelWidget().setSize(new SizeMetrics(0, SizeLayoutType.ABSOLUTE, 0, SizeLayoutType.ABSOLUTE));
    mDynamicPlot.getDomainLabelWidget().setSize(new SizeMetrics(0, SizeLayoutType.ABSOLUTE, 0, SizeLayoutType.ABSOLUTE)); 
```

我需要做什么才能摆脱所有这些黑色空间？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-28T01:35:46.540

Plot 本身（在您的示例中为 mDynamicPlot）本质上是位于共享空间中的小部件集合。处理定位的实际类是 LayoutManager。

除了定位之外，还需要调整 Widget 的大小以填充整个 Plot。每个 Widget 都使用 SizeMetrics 的实例来跟踪自己的大小。您可以通过调用 setSize(SizeMetrics newInstance); 来修改任何 Widget 的大小。您感兴趣的“图表”区域对应于 XYGraphWidget。 

我没有亲自测试过，但我相信下面的代码应该可以满足您的要求：

// 获取 XYGraphWidget 的句柄：

```
Widget gw = mDynamicPlot.getGraphWidget();

// FILL mode with values of 0 means fill 100% of container:
SizeMetrics sm = new SizeMetrics(0,SizeLayoutType.FILL,
                                 0,SizeLayoutType.FILL));
gw.setSize(sm);

// get a handle to the layout manager:
LayoutManager lm = mDynamicPlot.getLayoutManager();

// position the upper left corner of gw in the upper left corner of the space 
// controlled by lm.
lm.position(gw, 0, XLayoutStyle.ABSOLUTE_FROM_LEFT,
            0, YLayoutStyle.ABSOLUTE_FROM_TOP); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-01-30T14:24:38.977

SizeMetrics 不再用于设置大小，而是使用与 SizeMetrics 相同的 Constructor 和相同的使用方式来使用 Size。新呼叫看起来像这样。

```
Widget gw = mPlot.getGraph();    
Size size = new Size(0,SizeMode.FILL,0,SizeMode.FILL);    
gw.setSize(size);
gw.position(0, HorizontalPositioning.ABSOLUTE_FROM_LEFT,0, VerticalPositioning.ABSOLUTE_FROM_TOP); 
```

# java - 二维数组列表错误

> ID：14059554
> 
> 赞同：1
> 
> 时间：2012-12-27T18:40:16.803
> 
> 标签：java, arraylist, compiler-errors, bluej

我已经成功创建了一个 2D Arraylist，但我仍然在将我的值存储到 Arraylist 中时遇到问题。我的错误消息如下，“找不到符号 - 方法 add(int,java.lang.String)。我知道这可能是一个简单的修复，但我在网上或教科书中的任何地方都找不到它。我也想知道如果有更简单的方法来创建二维数组列表。谢谢。

这里是我声明二维数组的地方：

`ArrayList <ArrayList<String>> account = new ArrayList<ArrayList<String>>()`;

这是我的代码：

```
public void newAccount()
{
    firstName = JOptionPane.showInputDialog("What's your first name?");
    nLastName = JOptionPane.showInputDialog("What's your last name?");
    nAddress = JOptionPane.showInputDialog("What's your current address?");
    nCity= JOptionPane.showInputDialog("What's your current city?");
    nState = JOptionPane.showInputDialog("What's your current State?");
    nZipCode = JOptionPane.showInputDialog("What's your current Zip Code?");
    account.add( accountNumber, firstName);
    account.add( accountNumber, nLastName);
    account.add( accountNumber, nAddress);
    account.add( accountNumber, nCity);
    account.add( accountNumber, nState);
    account.add(accountNumber, nZipCode); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T18:47:55.567

更好的方法是使用对象而不是字符串：

```
ArrayList <Account> account = new ArrayList<Account>(); 
```

这是 Account 类：

```
public class Account{
    public String firstName;
    public String nLastName;
    public String nAddress;
    public String nCity;
    public String nState;
    public String nZipCode; 
} 
```

并添加到列表中：

```
public void newAccount()
{
    Account a = new Account();

    a.firstName = JOptionPane.showInputDialog("What's your first name?");
    a.nLastName = JOptionPane.showInputDialog("What's your last name?");
    a.nAddress = JOptionPane.showInputDialog("What's your current address?");
    a.nCity= JOptionPane.showInputDialog("What's your current city?");
    a.nState = JOptionPane.showInputDialog("What's your current State?");
    a.nZipCode = JOptionPane.showInputDialog("What's your current Zip Code?");

    account.add(a);
} 
```

您可以更改可见性并将其与 setter/getter 一起使用。这只是为了向您解释示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T18:46:41.307

您应该首先创建一个`ArrayList<String>`并将您的字符串`ArrayList`添加到此。然后将其添加`ArrayList`到您的`account` `ArrayList`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T18:49:18.220

你不想要一个字符串的数组列表，你想要一个帐户信息的数组列表，如下所示：

```
 class AccountEntry{
    public String firstName;
    public String lastName;
    public int address, city, state, zipCode;
 }

 ArrayList<AccountEntry> accounts = new ArrayList<AccountEntry>();

 AccountEntry entry = new AccountEntry();
 entry.firstName = JOptionPane.showInputDialog("What's your first name?");
 //..and so on
 accounts.add( entry ); //add the account 
```

# java - Netty 对 JDK 1.6 的主机名验证支持

> ID：14059555
> 
> 赞同：1
> 
> 时间：2012-12-27T18:40:17.970
> 
> 标签：java, netty

使用 JDK 6 时，netty 是否有任何库可以进行主机名验证？默认的 sun jdk 信任管理器不支持主机名验证。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T19:39:56.660

Nettys SslHandler 只使用一个 SslEngine。所以没有特殊的处理内置。

# python - 为什么 python 不再等待 os.system 完成？

> ID：14059558
> 
> 赞同：12
> 
> 时间：2012-12-27T18:40:23.977
> 
> 标签：python, os.system

我有以下功能，几个月来一直很好用。我还没有更新我的 Python 版本（除非它发生在幕后？）。

```
def Blast(type, protein_sequence, start, end, genomic_sequence):
    result = []
    M = re.search('M', protein_sequence)
    if M:
        query = protein_sequence[M.start():]
        temp = open("temp.ORF", "w")
        print >>temp, '>blasting'
        print >>temp, query
        temp.close()
        cline = blastp(query="'temp.ORF'", db="DB.blast.txt",
                       evalue=0.01, outfmt=5, out=type + ".BLAST")
        os.system(str(cline))
        blast_out = open(type + ".BLAST")
        string = str(blast_out.read())
        DEF = re.search("<Hit_def>((E|L)\d)</Hit_def>", string) 
```

我收到`blast_out=open(type+".BLAST")`找不到指定文件的错误。该文件是作为调用调用的程序输出的一部分创建的`os.system`。这通常需要 30 秒左右才能完成。但是，当我尝试运行该程序时，它会立即给出我上面提到的错误。

我以为`os.system()`应该等待完成？
我应该以某种方式强迫等待吗？（我不想硬编码等待时间）。

编辑：我已经在 BLAST 程序的命令行版本中运行了 cline 输出。一切似乎都很好。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-27T18:47:12.313

`os.system`确实等待。但是它调用的程序可能有错误，所以文件没有被创建。在继续之前，您应该检查被调用程序的返回值。一般来说，程序正常结束时应该返回 0，出现错误时返回另一个值：

```
if os.system(str(cline)):
    raise RuntimeError('program {} failed!'.format(str(cline)))
blast_out=open(type+".BLAST") 
```

除了引发异常，您还可以从`Blast`函数返回，或者尝试以其他方式处理它。

**更新：**被调用的程序是否从命令行运行良好只会告诉您程序本身没有问题。出现问题时，程序是否`blast`返回有用的错误或消息？如果是这样，请考虑使用`subprocess.Popen()`而不是`os.system`，并捕获标准输出：

```
prog = subprocess.Popen(cline, stdout=subprocess.PIPE, stderr=subprocess.PIPE)
out, err = prog.communicate()
# Now you can use `prog.returncode`, and inspect the `out` and `err` 
# strings to check for things that went wrong. 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-27T19:01:32.003

您还可以用 subprocess.check_call 替换对 os.system 的调用，如果命令失败，这将引发异常：

```
import subprocess as subp
subp.check_call(str(cline), shell=True) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-09-25T15:06:33.877

这个答案有点晚了。但是，我遇到了同样的问题，并且 subprocess 似乎不起作用。我通过将命令写入 bash 文件并通过 python os.system 执行 bash 文件来解决它：

```
vi forPython.sh (write 'my command' into it)
chmod +x forPython.sh 
```

（在 Python 脚本中）

```
os.system("./forPython.sh") 
```

这使 python 等待您的进程完成。

# mfc - 如何在 CWnd 中显示 CImg 图像

> ID：14059560
> 
> 赞同：1
> 
> 时间：2012-12-27T18:40:27.937
> 
> 标签：mfc, cimg

CImg 库包含 CImgDisplay 以显示 CImg 图像。如何使用 CImg 加载图像并在 MFC 应用程序的 CWnd 派生类中显示？

# javascript - jquery ui 可选择丢失区域缩放动画

> ID：14059562
> 
> 赞同：0
> 
> 时间：2012-12-27T18:40:39.080
> 
> 标签：javascript, jquery, user-interface

在普通视图下使用选择时，网格会正常工作，100%，但是如果将大小更改为更小或缩放，则选择无法正常工作。另一方面，选项检查在任何视图中都能完美运行

例如[http://jsfiddle.net/mutesex/czxgg/2/](http://jsfiddle.net/mutesex/czxgg/2/)

```
$("#slider").slider({
  value: 1,
  min: 0.1,
  max: 2,
  step: 0.1,
  slide: function (event, ui) {
    $("#amount").html("" + parseInt((ui.value) * 100) + "%");
    $('#<%= GridView1.ClientID%>').animate({ zoom: ui.value }, 1);
      //selectable___();
  }
});

$("#amount").html("100%");

function selectable___() {
  $(document).ready(function () {
    $("#<%= GridView1.ClientID%>").selectable({
     filter: "td[free='yes']",

     stop: function () {
     var result = $("#select-result").empty();
     $(".ui-selected", this).each(function () {
       var dia__ = $(this).attr("infodia");
       if (!ExisteItem(dia__)) {
         result.append(" #" + dia__);
         diasSeleccion.push({ infodia: dia__ });
       }
     });
   },
   unselected: function (event, ui) { var e = $(ui.unselected); removeItem(e.attr("infodia")); },
   unselecting: function (event, ui) { var e = $(ui.unselecting); removeItem(e.attr("infodia")); }
   });  
  }); 
}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T22:25:54.273

不要使用缩放，可选择的小部件会忽略它。而是在滑块更改时设置高度和宽度。

从`!important`CSS 中的以下宽度和高度中删除

```
 .cell
    {
        ...
        width: 200px;
        ...
    }
    .cellcalday
    {
        ...
        height: 100px;
        ...
    }
    .cellcalfds
    {
        ...
        height: 100px;
        ...
    } 
```

像这样更改您的脚本

```
 $("#slider").slider({
            value: 1,
            min: 0.1,
            max: 2,
            step: 0.1,
            slide: function (event, ui) {

                $("#amount").html("" + parseInt((ui.value) * 100) + "%");
                //$('#ctl00_container_GridView1').animate({ zoom: ui.value }, 1);
                $("table#ctl00_container_GridView1 tr td.cell").css('width', Math.round(200 * ui.value));
                $("table#ctl00_container_GridView1 tr th.cell").css('width', Math.round(200 * ui.value));
                $("table#ctl00_container_GridView1 tr td.cellcalday").css('height', Math.round(100 * ui.value));
                $("table#ctl00_container_GridView1 tr td.cellcalfds").css('height', Math.round(100 * ui.value));

            }
        }); 
```

**jsFiddle在这里：http:** [//jsfiddle.net/Ten4u/](http://jsfiddle.net/Ten4u/)

# javascript - 完成后如何使这个倒数计时器自动重置？

> ID：14059563
> 
> 赞同：0
> 
> 时间：2012-12-27T18:40:55.030
> 
> 标签：javascript, html

我有这个倒数计时器脚本：

```
<script language="JavaScript" src="http://scripts.hashemian.com/js/countdown.js"></script>

function calcage(secs, num1, num2) {
  s = ((Math.floor(secs/num1))%num2).toString();
  if (LeadingZero && s.length < 2)
    s = "0" + s;
  return "<b>" + s + "</b>";
}

function CountBack(secs) {
  if (secs < 0) {
    document.getElementById("cntdwn").innerHTML = FinishMessage;
    return;
  }
  DisplayStr = DisplayFormat.replace(/%%D%%/g, calcage(secs,86400,100000));
  DisplayStr = DisplayStr.replace(/%%H%%/g, calcage(secs,3600,24));
  DisplayStr = DisplayStr.replace(/%%M%%/g, calcage(secs,60,60));
  DisplayStr = DisplayStr.replace(/%%S%%/g, calcage(secs,1,60));

  document.getElementById("cntdwn").innerHTML = DisplayStr;
  if (CountActive)
    setTimeout("CountBack(" + (secs+CountStepper) + ")", SetTimeOutPeriod);
}

function putspan(backcolor, forecolor) {
 document.write("<span id='cntdwn' style='background-color:" + backcolor + 
                "; color:" + forecolor + "'></span>");
}

if (typeof(BackColor)=="undefined")
  BackColor = "white";
if (typeof(ForeColor)=="undefined")
  ForeColor= "black";
if (typeof(TargetDate)=="undefined")
  TargetDate = "12/27/2012 1:36 PM";
if (typeof(DisplayFormat)=="undefined")
  DisplayFormat = "%%D%% Days, %%H%% Hours, %%M%% Minutes, %%S%% Seconds.";
if (typeof(CountActive)=="undefined")
  CountActive = true;
if (typeof(FinishMessage)=="undefined")
  FinishMessage = "";
if (typeof(CountStepper)!="number")
  CountStepper = -1;
if (typeof(LeadingZero)=="undefined")
  LeadingZero = true;

CountStepper = Math.ceil(CountStepper);
if (CountStepper == 0)
  CountActive = false;
var SetTimeOutPeriod = (Math.abs(CountStepper)-1)*1000 + 990;
putspan(BackColor, ForeColor);
var dthen = new Date(TargetDate);
var dnow = new Date();
if(CountStepper>0)
  ddiff = new Date(dnow-dthen);
else
  ddiff = new Date(dthen-dnow);
gsecs = Math.floor(ddiff.valueOf()/1000);
CountBack(gsecs); 
```

我想这样做，一旦计时器达到 0，它就会在原始日期的基础上增加 2 天并自行重置。

这是我想出的：

```
CountStepper = Math.ceil(CountStepper);
if (CountStepper == 0)
  CountActive = true;
var SetTimeOutPeriod = (Math.abs(targetdate)-1)*2000 + 990;
putspan(BackColor, ForeColor);
var dthen = new Date(TargetDate);
var dnow = new Date();
if(CountStepper>0)
CountBack(gsecs); 
```

但这似乎不起作用。有关如何解决此问题的任何帮助或提示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T18:46:40.713

有两种方法可以在 Javascript 中重复基于时间的事件。您正在尝试的第一种方法是进行超时，然后从第一个超时的回调中调用另一个超时（然后该超时从其回调中调用另一个超时，依此类推）。

这种基本方法完全有效（我想如果您进行一些调试，您可以让它为您工作），但还有另一种方法：setInterval。

setInterval 在每个超时期间一遍又一遍地运行相同的代码。如果你做了类似的事情：

```
window.setInterval((putspan, Math.abs(targetdate)-1)*2000 + 990) 
```

它也应该可以解决您的问题。

附带说明一下，出于多种原因，使用 eval-ed 代码（字符串中的 javascript）是一个糟糕的主意。我建议改用函数（就像我在示例中使用 putspan 所做的那样）。您可以使用 jQuery 的代理或 Underscore 的绑定来“修复”参数，如下所示：

```
var putspanWithColor = $.proxy(putspan, this, BackColor, ForeColor);
window.setInterval(putspanWithColor, Math.abs(targetdate)-1)*2000 + 990) 
```

# javascript - 在不使用标签的情况下设置正文加载

> ID：14059565
> 
> 赞同：3
> 
> 时间：2012-12-27T18:41:01.760
> 
> 标签：javascript, onload

我正在尝试在身体加载后触发的功能。我知道你可以从 body 标签中做到这一点，但如果可能的话，我更愿意从 JS 中做到这一点。

例如：`document.getElementsByTagName('body').onload = someFunc();`

这对我不起作用，但我认为它显示了我本质上想要做的事情。

**编辑：**

我已经尝试了答案，似乎问题在于它在加载它在正文标记中使用的元素之前调用了该函数，即使我将脚本标签放在正文中也是如此。这是它需要做的：

`var buttonElements = document.getElementsByClassName('button');`

如果我这样做：

`alert(buttonElements)`

它会弹出`0`，但是当我在控制台中创建一个变量时，它会成功地用元素填充它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-27T18:42:08.287

你所拥有的几乎可以工作，但是你必须在`<body>`标签的末尾导入你的 JavaScript，并且你必须索引第一个结果：

```
document.getElementsByTagName('body')[0].onload = someFunc; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-27T18:42:08.090

像这样：

```
window.onload = someFunc; 
```

但是，如果您的函数接受arguemnts，您将需要这样的匿名函数：

```
window.onload = function(){
    someFunc(arg1, arg2);
} 
```

顺便说一句，除了修复@Pointy 为您的代码提到的问题之外，您还可以执行以下操作：

```
document.body.onload = someFunc; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-27T18:42:37.653

不要使用引号...`"someFunc"()`如果您尝试运行它，它将不起作用。

```
window.onload = someFunc; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-27T18:45:43.583

如果你使用 jQuery：

```
$(document).ready(function () {
    callMyFunction();
}); 
```

# django - 无法创建超级用户 Django

> ID：14059573
> 
> 赞同：17
> 
> 时间：2012-12-27T18:41:27.543
> 
> 标签：django

我假设这是因为我的超级用户依赖于尚无现有数据的 UserProfile。我的模型看起来像

```
from django.db import models
from django.contrib.auth.models import User
from django.db.models.signals import post_save

class UserProfile(models.Model):
    user = models.OneToOneField(User) # required
    location = models.CharField(max_length=100)
    age = models.PositiveIntegerField(blank=True,null=True)
    contribution_points = models.PositiveIntegerField()
    #acheivements = models.ManyToMany()

def create_user_profile(sender,instance,created,**kwargs):
    if created:
        UserProfile.objects.create(user=instance)

post_save.connect(create_user_profile, sender=User) 
```

但是，我最终遇到以下错误：

```
django.db.utils.DatabaseError: (1146, "Table 'savory_db.login_userprofile' doesn't exist") 
```

尽管刚刚跑`syncdb`

我的模型是否有任何会导致此错误的矛盾字段。UserProfile 不应该应用于超级用户吗？我应该如何防止这种情况？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-12-27T19:48:58.053

2011 年 3 月 23 日凌晨 4:25，Malcolm Box 写道：

> 进一步调查：看起来这是一个 South/syncdb 交互。UserProfile 将由南迁移创建，但是当 auth post_install 运行以提示超级用户时，它当然没有运行。
> 
> 可悲的是 syncdb --migrate 也没有做正确的事情。
> 
> 目前，我只是使用 ./manage.py shell 手动创建一个超级用户，但欢迎任何关于如何更好地解决这个问题的想法。

不要在 syncdb 期间创建超级用户，您的用户配置文件表将不存在。您必须在管理员上有一个创建用户配置文件的创建信号，这看起来像是失败了

用于初始化数据库的过程是：

```
python manage.py syncdb --noinput
python manage.py migrate
python manage.py createsuperuser 
```

参考：[https ://groups.google.com/forum/?fromgroups=#!topic/django-users/sBXllxrIdMc](https://groups.google.com/forum/?fromgroups=#!topic/django-users/sBXllxrIdMc)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-16T15:59:40.697

我刚刚遇到了同样的问题——通过迁移创建的配置文件模型，以及在使用初始创建超级用户时中断的信号处理程序`syncdb`。

我的解决方案如下。

首先，处理表还不存在的情况。这有点难看，也许过于激烈（可能会掩盖其他错误）

```
@receiver(post_save, sender=User)
def create_profile(sender, instance, created, **kwargs):
    try:
        WheelProfile.objects.get_or_create(user=instance)
    except DatabaseError:
        logging.error("Failed to create profile for %s, perhaps migrations haven't run yet?" % instance)
        from django.db import connection
        connection._rollback() 
```

其次，在迁移完成时运行一个处理程序：

```
from south.signals import post_migrate

@receiver(post_migrate)
def create_profiles(app, **kwargs):
    if app == "wheelcms_axle":
        for u in User.objects.all():
            WheelProfile.objects.get_or_create(user=u) 
```

当然，这也将在进行未来迁移时运行，为没有配置文件的用户创建配置文件。对我来说，这不是问题。

# java - 我正在将图像文件从服务器端传输到客户端，在读取图像文件时我遇到了这个问题

> ID：14059574
> 
> 赞同：0
> 
> 时间：2012-12-27T18:41:29.447
> 
> 标签：java, android, image, android-emulator, network-programming

我正在使用以下代码从套接字读取图像文件。它从服务器读取所有字节，因为服务器和 android 机器上的文件大小相同。当我打开此文件时，它不会打开文件并生成错误，即文件已损坏或太大。

```
 public Bitmap fileReceived(InputStream is)
        throws FileNotFoundException, IOException {

        Bitmap bitmap = null;  
        String baseDir = Environment.getExternalStorageDirectory().getAbsolutePath();
        String fileName = "a.png";
        String imageInSD = baseDir + File.separator + fileName;
            System.out.println(imageInSD);
        if (is!= null) {
            FileOutputStream fos = null;
            BufferedOutputStream bos = null;
            try {

                fos = new FileOutputStream(imageInSD);
                bos = new BufferedOutputStream(fos);
                byte[] aByte = new byte[1024];
                int bytesRead;

                while ( true  ) {  
                    bytesRead = is.read(aByte);

                    bos.write(aByte, 0, bytesRead);
                if ( is.available()==0)
                    break;
                }  

                bos.flush();
                bos.close();
          //      is.reset();

        // here it give error i.e --- SkImageDecoder::Factory returned null
               bitmap = BitmapFactory.decodeFile(imageInSD);

            } catch (IOException ex) {
                // Do exception handling
                Log.i("IMSERVICE", "exception ");
            }
        }

        return bitmap;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T19:22:33.970

不要[`available()`](http://docs.oracle.com/javase/6/docs/api/java/io/InputStream.html#available%28%29)用于这个，它不会可靠地工作！

文档状态：

> [ available() ] 返回可读取字节数的**估计值**[...] 使用此方法的返回值来分配旨在保存此流中所有数据的缓冲区是不正确的。

这样做：

```
while ( (bytesRead = is.read(aByte)) > 0 ) {
    bos.write(aByte, 0, bytesRead);
} 
```

# php - 正则表达式，删除字符串的第一部分

> ID：14059577
> 
> 赞同：0
> 
> 时间：2012-12-27T18:41:44.050
> 
> 标签：php, regex

我有字符串`562865_numbersletterssymbols`

如果我想删除，如果存在；第一部分（562865_），我应该搜索什么？

我的猜测是`^[^?:(562865_)]+$`直到`?:`$`+$`

但我发现 (562865_) 搜索每个数字而不是整个字符串。

我怎样才能找到解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T18:53:22.357

我能想出的最简单的方法就是这个。它不仅适用于该名称，还适用于具有相同格式的任何其他名称。

```
<?php
$string = "562865_numbersletterssymbols";

echo preg_replace("/^\d+_/", "", $string); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T18:50:06.177

如果您想坚持使用正则表达式，请尝试`^[\d]+_(.+)$`

将`_`字符串分成两部分，您需要括号中的第二部分`(.+)`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T19:30:24.273

感谢raina77ow，最简单的方法永远是最好的选择。

```
$your_var = str_replace('562865_', '', $your_var) 
```

# javascript - 从 Javascript 中的 X509 结构中读取公钥

> ID：14059579
> 
> 赞同：2
> 
> 时间：2012-12-27T18:41:48.053
> 
> 标签：javascript, public-key, x509certificate2

您好，我有一个具有 X509 结构的编码公钥，我想从中提取模数和公共指数我正在使用以下 ASN.1 解码器[http://lapo.it/asn1js/](http://lapo.it/asn1js/)来读取密钥，但我可以在我得到的结果中看不到模数或公共指数。

这是我要阅读的关键。

```
30819e300d06092a864886f70d010101050003818c00308188028180599a96c54ef07f5288a061a56386376fd9e2e0a253cb035f2b0c65c85c99153a848a8247d9e28d8be1dbad5e754e8393e591cc53e5abec2f0a44b4844646cc283123fdd799c50dd5acd1277fd9afeb9c5a12a53b9edfff0ac53d6e94e5f1678c3bd0ccd8d08b18d4a42f845b79b8b19203e24e189801ca396f5732bfe628edeb0203010001 
```

这是我从解码器得到的结果。

```
SEQUENCE(2 elem)
SEQUENCE(2 elem)
OBJECT IDENTIFIER1.2.840.113549.1.1.1
NULL
BIT STRING(1 elem)
SEQUENCE(2 elem)
INTEGER(1023 bit)
INTEGER65537 
```

提前致谢。

```
//Example of what I am expecting to find.
    30 819f // SEQUENCE
      30 0d // SEQUENCE
        06 09 2a864886f70d010101 // OBJECT IDENTIFIER of RSA
        05 00 // NULL (parameter)
      03 818d // BIT STRING
        00 // using all following bits
        30 8189 // SEQUENCE
          02 8181 // (signed) INTEGER
            00 // padding (signed INTEGER) followed by the modulus
            95e15f182ec7b6e84786c0ee54e3bb72af0461e6fd859a3625f38dcd3fdec80d
            fcc51a44756ec7cd6c14b430d55670460c5143efadd1ade7380e890e9957d6e6
            b38f35412862cc955e04d1928f21c0d2f7bc48c3855276f0e7c1b45a558e3a01
            3b969cbfaebca42b748e64bff787f86ec5f0adcd94428c4ab8ca6d2b710d785b
          02 03 // (signed) INTEGER
            010001 // public exponent (4th number of Fermat) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T19:35:30.410

假设你像这样使用 asn1js，

```
var hex = Hex.decode("30819e300d06..."); // key truncated for this example

// decode key
var mykey = ASN1.decode(hex); 
```

您首先需要找到模数字节的开始位置以及模数长度

```
var modStart = mykey.sub[1].sub[0].sub[0].posContent();
var modLen = mykey.sub[1].sub[0].sub[0].length; 
```

现在循环流并填充一个`modbytes`数组

```
// read modulus bytes
var modbytes = [];

for(var x = 0; x < modLen; x++) {
    modbytes.push(mykey.stream.enc[x+modStart]);
}

// modbytes now contains array like [89, 154, 150, 197, 78...] 
```

由于指数是整数，因此可以像这样轻松读取

```
var exponent = mykey.sub[1].sub[0].sub[1].content();
// returns 65537 
```

您可以像这样将值转换为十六进制，

```
// in the case of the exponent its simple
exponent.toString(16); // returns "10001" 
```

至于模数，您需要遍历模数字节并连接它们的十六进制值

```
var modulusHex = "";
for(var x = 0; x < modbytes.length; x++) {
    var hexByte = modbytes[x].toString(16);

    // might need padding before appending
    modulusHex += (hexByte.length == 1) ? "0"+hexByte : hexByte;
}

// modulusHex now contains something like
// 599a96c54ef07f5288a061a5... 
```

# django - 在 clean() 期间不存在

> ID：14059581
> 
> 赞同：2
> 
> 时间：2012-12-27T18:42:07.063
> 
> 标签：django, django-models

我的 Django 应用程序中有以下模型：

```
class Property(models.Model):
    ...various attributes...

class Booking(models.Model):
    property = models.ForeignKey(
        Property
    )
    ...more attributes... 
```

我实现了检查 a 的各种约束的`clean()`方法。许多这些限制取决于关联和存在。出于这个原因，我在 clean() 方法中有以下内容：`Booking``Booking``Booking``Property``Booking`

```
if self.property is not None:
    ...Property related validations... 
```

在管理应用程序中输入一个新的预订并且只按保存按钮而不输入任何内容，这会生成一个`DoesNotExist exception`on `self.property is not None`。据我了解，缺少的关联应该由 Django 的单个字段验证来捕获。

当我注释掉上述`clean()`方法时，上述方法不会发生，并且当我提交空白预订表格时，缺失的关联会被正确标记为错误。

我显然错过了一些东西，但不知道是什么......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T23:32:50.823

发布为答案，因为它是答案：

> 您是否尝试过将条件更改为：
> 
> `if hasattr(self, 'property') and self.property is not None`

我不确定根本原因，因为我根据错误消息推断了解决方案。我想 Django ORM 可能会在保存时动态创建外键关联，所以即使它是必需的属性，它还没有被创建，因为 Booking 实例是新的并且尚未保存。

# php - 如何使用 PHP 启动 Windows GUI 程序？

> ID：14059588
> 
> 赞同：-1
> 
> 时间：2012-12-27T18:42:24.083
> 
> 标签：php, firefox, firefox-addon

> **可能重复：**
> [php 如何启动外部程序运行 - 系统和 exec 出现问题](https://stackoverflow.com/questions/1403203/php-how-do-i-start-an-external-program-running-having-trouble-with-system-and)

如何用php打开exe？
我有这个想法，努力了好几年，最终还是失败了。有人告诉我一个成功的方法来完成这项工作吗？

```
<?php 
    if(isset($_POST['file_path'])){
        /* ------- 
            using "notepad++.exe" to open "test.php" file.
            or run a bat file which calling "notepad++.exe" to open "test.php" file.
            how to seting php.ini or firefox or any setting to do this job. 
            it is only for conveniently developing web page in my PC ,not for web servers
        ------- */
    }
?>

<form action="test.php" method="post">
    <input type="text" name="file_path" value="test.php"/>
    <button type="submit">open with notepad++</button>
</form> 
```

这将创建类似：

![呈现的 HTML 屏幕截图](../Images/41302eaa0d5669e3e907fc956c1d572f.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-27T19:27:51.373

在运行网络服务器的计算机上启动程序：

```
<?php
exec('"C:\Program Files (x86)\Notepad++\notepad++.exe" "C:\foo.php"'); 
```

如果网络服务器不作为 Windows 服务运行，以上将适用于 vista/win7。例如，如果您运行 apache 并在您的计算机启动时自动启动，您可能将其安装为服务。您可以检查 apache 是否显示在 Windows 服务选项卡/thingy 中。

如果网络服务器作为服务运行，您需要考虑为该服务启用“允许桌面交互”选项。然而在其他方面：

使用 php 新的内置网络服务器（php 5.4+）进行简单测试。这里的关键是您从 shell 手动启动服务器，因此它作为您的用户而不是作为服务运行。

```
<?php
// C:\my\htdocs\script.php
exec('"C:\Program Files (x86)\Notepad++\notepad++.exe" "C:\foo.php"'); 
```

通过命令窗口启动网络服务器

```
C:\path\to\php.exe -S localhost:8000 -t C:\my\htdocs 
```

然后在你的浏览器中 `http://localhost:8000/script.php`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-27T18:51:44.460

我假设您希望客户端设备打开 Notepad++ 而不是远程服务器。如果是这种情况，您可以做的最好的事情是提供具有正确文件类型标题的文件，并希望客户端将 Notepad ++ 设置为默认应用程序来打开此类文件。

这样的事情应该这样做：

```
header('Content-type: text/plain');
header('Content-Disposition: attachment; filename="' . $file_name . '"'); // forces file download
header('Content-length: ' . filesize($file_path));
header('Cache-Control: must-revalidate, post-check=0, pre-check=0'); // make sure file is re-validated each time it is requested

$fh = fopen($file_path, 'r');
while(!feof($fh)) {
    $buffer = fread($fh, 2048);
    echo $buffer;
}
fclose($fh); 
```

文件名在哪里`$file_name`（不是完整路径），`$file_path`是文件的完整路径

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-27T20:18:49.580

我测试的最后成功的方法。
谢谢查尔斯，请参阅[php 如何启动外部程序运行 - 系统和执行出现问题](https://stackoverflow.com/questions/1403203/php-how-do-i-start-an-external-program-running-having-trouble-with-system-and/8170050#8170050)

*   开始-> 运行，键入“services.msc”以调出服务控制（其他方式到达那里，这是最简单的 IMO）
*   找到您的 Apache 服务（我的使用 WampServer 2.0 被称为“wampapache”）
*   打开服务属性（双击或右键->属性）
*   转到登录帐户并确保选中标题为“允许服务与桌面交互”的**复选框**
*   翻回General选项卡，停止服务，启动服务

然后：在php中

```
pclose(popen("start /B \"d:\\green soft\\notepad++5.8.4\\notepad++.exe\" \"d:\\PHPnow-1.5.6\\htdocs\\laji\\a.php\"", "r")); 
```

谢谢你所有的好人，多么大的帮助。我终于把我的想法变成了现实。新年快乐 ！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-27T18:47:45.557

从来没有理由这样做，但是您尝试过 passthru() 吗？

[http://php.net/manual/en/function.passthru.php](http://php.net/manual/en/function.passthru.php)

编辑：抱歉，OP乍一看真的不清楚..

我要做的是将文件解析为字符串或诸如此类的东西，然后强制浏览器将其视为下载.. php 是服务器端的，所以你不能只要求浏览器做一些事情..

```
$someText = 'some text here';

header('Content-type: text/plain');
header('Content-Disposition: attachment; filename="text.txt"');

echo $someText; 
```

# java - 在应用程序启动时在 Android 中加载（反序列化）_quickly_ 2MB 数据

> ID：14059594
> 
> 赞同：0
> 
> 时间：2012-12-27T18:43:07.060
> 
> 标签：java, android, performance, deserialization, protocol-buffers

我需要在我的 Android 应用程序启动时快速加载大约 2MB 的数据。我真的需要内存中的*所有*这些数据，所以像 SQLite 之类的东西不是替代品。

数据由大约 3000 个`int[][]`数组组成。数组维度平均约为 [7][7]。

我首先在我的桌面上实现了一些原型，并将其移植到了 android。在桌面上，我只是简单地使用了 Java 的（反）序列化。在我的台式计算机上，该数据的反序列化大约需要 90 毫秒。

然而，在 Android 2.2.1 上，在我的 HTC Magic 上，相同的过程大约需要 15 秒（！）。它太慢了，如果我不单独进行反序列化，我的应用程序将被杀死。总而言之，这是令人无法接受的缓慢。

我究竟做错了什么？我是不是该

*   *切换到协议缓冲区之*类的东西？这真的会加快几个数量级的反序列化过程吗？毕竟，我要反序列化的不是复杂的对象，只是`int[][]`数组？！
*   设计我自己的自定义二进制文件格式？我以前从未这样做过，也不知道从哪里开始
*   做别的事？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-27T19:11:08.987

为什么不绕过内置的反序列化，直接使用二进制 I/O？当速度是您的主要关注点时，不一定是易于编程，您无法击败它。

对于输出，伪代码如下所示：

```
write number of arrays
for each array
  write n,m array sizes
  for each element of array
    write array element 
```

对于输入，伪代码将是：

```
read number of arrays
for each array
  read n,m array sizes
  allocate the array
  for each element of array
    read array element 
```

当你读/写二进制数字时，你绕过了二进制和字符之间的所有转换。速度应仅受文件存储介质的数据传输速率限制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T17:56:56.233

正如 Mike Dunlavey 建议的那样，在尝试了几件事之后，直接二进制 I/O 似乎最快。我几乎一字不差地使用了他的草图版本。但是，为了完整起见，如果其他人想尝试，我会在这里发布我的完整代码；即使它非常基本并且没有任何健全性检查。这是为了读取这样的二进制流；写作绝对是类似的。

```
import java.io.*;

public static int[][][] readBinaryInt(String filename) throws IOException {
    DataInputStream in = new DataInputStream(
            new BufferedInputStream(new FileInputStream(filename)));
int dimOfData = in.readInt();
int[][][] patternijk = new int[dimofData][][];
for(int i=0;i<dimofData;i++) {
    int dimStrokes = in.readInt(); 
    int[][] patternjk = new int[dimStrokes][];      
    for(int j=0;j<dimStrokes;j++) {
        int dimPoints = in.readInt();
        int[] patternk = new int[dimPoints];
        for(int k=0;k<dimPoints;k++) {
                patternk[k] = in.readInt();
            }
            patternjk[j] = patternk;
    }
    patternijk[i] = patternjk;
    }
    in.close();
return patternijk;  
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T18:45:46.890

几个月前，我在一个项目中遇到了同样的问题。我认为您应该将文件拆分为各个部分，并且仅在用户选择之后才加载相关部分。希望它会有所帮助！

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-12-27T19:26:32.493

我不知道你的数据，但如果你优化你的循环，它会难以置信地影响反序列化时间。

如果你看下面的例子

> ```
> computeRecursively(30);
> 
> computeRecursivelyWithLoop(30); // 270 milisecond    
> 
> computeIteratively(30);        // 1 milisecond            
> 
> computeRecursivelyFasterUsingBigInteger(30); // about twice s fast as before version          
> 
> computeRecursivelyFasterUsingBigIntegerAllocations(50000);   // only 1.3 Second !!! 
> ```

```
public class Fibo {
    public static void main(String[] args) {
        // try the methods
    }

    public static long computeRecursively(int n) {

        if (n > 1) {
            System.out.println(computeRecursively(n - 2)
                    + computeRecursively(n - 1));
            return computeRecursively(n - 2) + computeRecursively(n - 1);
        }
        return n;
    }

    public static long computeRecursivelyWithLoop(int n) {
        if (n > 1) {
            long result = 1;
            do {
                result += computeRecursivelyWithLoop(n - 2);
                n--;
            } while (n > 1);
            System.out.println(result);
            return result;
        }
        return n;
    }

    public static long computeIteratively(int n) {
        if (n > 1) {
            long a = 0, b = 1;
            do {
                long tmp = b;
                b += a;
                a = tmp;
                System.out.println(a);
            } while (--n > 1);
            System.out.println(b);
            return b;
        }
        return n;
    }

    public static BigInteger computeRecursivelyFasterUsingBigInteger(int n) {
        if (n > 1) {
            int m = (n / 2) + (n & 1); // not obvious at first – wouldn’t it be
                                        // great to have a better comment here?
            BigInteger fM = computeRecursivelyFasterUsingBigInteger(m);
            BigInteger fM_1 = computeRecursivelyFasterUsingBigInteger(m - 1);
            if ((n & 1) == 1) {
                // F(m)^2 + F(m-1)^2
                System.out.println(fM.pow(2).add(fM_1.pow(2)));
                return fM.pow(2).add(fM_1.pow(2)); // three BigInteger objects
                                                    // created
            } else {
                // (2*F(m-1) + F(m)) * F(m)
                System.out.println( fM_1.shiftLeft(1).add(fM).multiply(fM));
                return fM_1.shiftLeft(1).add(fM).multiply(fM); // three
                                                                // BigInteger
                                                                // objects
                                                                // created
            }
        }
        return (n == 0) ? BigInteger.ZERO : BigInteger.ONE; // no BigInteger
                                                            // object created
    }

    public static long computeRecursivelyFasterUsingBigIntegerAllocations(int n) {
        long allocations = 0;
        if (n > 1) {
            int m = (n / 2) + (n & 1);
            allocations += computeRecursivelyFasterUsingBigIntegerAllocations(m);
            allocations += computeRecursivelyFasterUsingBigIntegerAllocations(m - 1);
            // 3 more BigInteger objects allocated
            allocations += 3;
            System.out.println(allocations);
        }
        return allocations; // approximate number of BigInteger objects
                            // allocated when
                            // computeRecursivelyFasterUsingBigInteger(n) is
                            // called
    }
} 
```

# php - 头部标签位于锁定区域

> ID：14059595
> 
> 赞同：0
> 
> 时间：2012-12-27T18:43:08.310
> 
> 标签：php, html, include, dreamweaver

```
 <!DOCTYPE html>
    <html>

        <head>

        <meta name="viewport" content="width=device-width">

        <title>Codey Buzz's</title>

        <link href="stylesheets/public.css" media="all" rel="stylesheet" type="text/css" />
        <!-- mobile -->
        <link href="../stylesheets/mobile.css" rel="stylesheet" type="text/css" media="only screen and (max-width:800px)">
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
        <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.9.1/jquery-ui.min.js"></script>
        <script type="text/javascript" src="javascripts/script.js"></script>
        <script src="javascripts/SpryMenuBar.js" type="text/javascript"></script>
        <script src="js/clearbox.js"></script>
    <link href="stylesheets/SpryMenuBarVertical.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript">
    var MenuBar1 = new Spry.Widget.MenuBar("MenuBar1", {imgRight:"SpryAssets/SpryMenuBarRightHover.gif"});
    </script>
    <script type="text/xml">
    <oa:widgets>
      <oa:widget wid="2648024" binding="#OAWidget" />
    </oa:widgets>
    </script>
<!-- TemplateBeginEditable name="head" -->
    <!-- TemplateEndEditable -->
        </head>

        <body>

            <header>
                <h1>Inspiring Message</h1>
            </header>
            <div id="content"> 
```

上面的 html 是我的`header.php`文件，我包含在我网站的每个页面上。

我包括这个

```
<?php include("includes/header.php"); ?> 
```

在每一页的顶部。

在 Dreamweaver CS6 中，我收到一个错误，提示我的头部标签位于锁定区域。我做了一些研究并遇到了涉及模板的东西，虽然我没有使用模板，但我是手写我的代码减去我试图添加的小部件。我如何解锁这个？我已经尝试在我的文件中注释掉我`header.php`的头部部分并在我的 index.php 页面上添加一个新的头部部分，但它仍然给我同样的错误。我不想将小部件插入新页面。我想“解锁头部标签”。我添加了 templatebegineditable 以希望修复它，尽管它在我尝试过的任何变体中都不起作用。在标题周围，在 head 标签结束之前等。Adobe 对解决此问题的支持非常愚蠢，每个人最终都手动插入内容并更改每个链接和脚本目录。

有人知道解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T19:11:34.677

默认情况下，您的模板应该在结束标记之前有一个可编辑区域。它看起来像这样：

```
<!-- TemplateBeginEditable name="head" -->
<!-- TemplateEndEditable --> 
```

Dreamweaver 应该能够找到该可编辑区域并自动在其中插入标签。

它在 Adob​​e 论坛中提到！

# python - 带有变量的 Python 正则表达式 findall

> ID：14059596
> 
> 赞同：3
> 
> 时间：2012-12-27T18:43:10.430
> 
> 标签：python, regex

我正在尝试将 re.findall 与后视和前瞻一起使用来提取数据。当我不使用 raw_input 变量时，正则表达式可以正常工作，但我需要用户能够输入各种不同的搜索词。

这是当前代码：

```
me = re.findall(r"(?<='(.+)'+variable+'(.+)')(.*?)(?='(.+)+variable+(.+)')", raw) 
```

如您所见，我试图在一个搜索词之间提取字符串。

但是，每次我使用这种格式时，都会出现固定宽度错误。有没有办法解决？

我也尝试了以下格式但没有成功。

```
variable = raw_input('Term? ')
'.*' + variable + '.*' 
```

和

```
'.*%s.*' % (variable, ) 
```

和

```
'.*{0}.*'.format(variable) 
```

和

```
 '.*{variable}.*'.format(variable=variable) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T18:52:52.037

通常实现lookbehind的方式（包括它的Python实现）有一个固有的限制，不幸的是你遇到了：lookbehinds不能是可变长度的。[此处](http://www.regular-expressions.info/lookaround.html)的“关于 Lookbehind 的重要说明”部分解释了原因。不过，我认为您应该能够在不向后看的情况下执行正则表达式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T20:03:18.660

我不确定这是否是你的意思，但它可能会让你开始。据我了解您的问题，您不需要前瞻或后视。这适用于 Python 2.x（不适用于 Python 3）：

```
>>> import re
>>> string_to_search = 'fish, hook, swallowed, reeled, boat, fish'
>>> entered_by_user = 'fish'
>>> search_regex = r"{0}(.+){0}".format(entered_by_user)
>>> match = re.search(search_regex, string_to_search)
>>> if match:
...     print "result:", match.group(1).strip(' ,')
...
result: hook, swallowed, reeled, boat 
```

如果您真的想要结果中的最后一个“鱼”，如上面的评论所示，那么只需`{0}`从`format()`字符串中删除第二个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-11-05T02:09:36.633

此解决方案应该有效：

```
me = re.findall(rf"(?<='(.+)'+{variable}+'(.+)')(.*?)(?='(.+)+{variable}+(.+)')", raw) 
```

您还可以根据需要添加许多不同的变量。在 {} 之间为正则表达式和所需变量添加**rf**

```
import re

text = "regex is the best"    
var1 = "is the"
var2 = "best"
yes = re.findall(rf"regex {var1} {var2}", text)

print(yes) 
```

['正则表达式是最好的']

# ruby - 在 Windows 上安装 gem 挂起，没有输出

> ID：14059601
> 
> 赞同：4
> 
> 时间：2012-12-27T18:43:42.970
> 
> 标签：ruby, rubygems

所以，我在我的机器（Windows）上安装了 Rails 安装程序。我只是尝试安装一个 gem（nokogiri），但无济于事。在 cmd 窗口中，运行`gem install nokogiri`只是挂起，没有提供任何状态，也没有任何反应。知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-08-04T18:28:50.287

要知道实际发生了什么，请尝试

```
gem install nokogiri -V 
```

# dart - 使用 DRT 测试 Web 应用程序

> ID：14059603
> 
> 赞同：1
> 
> 时间：2012-12-27T18:43:45.860
> 
> 标签：dart

我正在尝试使用 DRT 来运行验收测试。

因为这是一个验收测试，所以我需要更改位置以打开被测页面。但是，当然，在我完成之后，我的测试脚本就消失了。

我尝试使用 iFrame 作为解决方法，但 Dart 没有提供任何获取 iFrame 内容的方法。这意味着可以将被测页面加载到 iframe 中，但无法获取其 html。

我检查了 Dart 存储库中的所有 DRT 测试： [http ://code.google.com/p/dart/source/browse/#svn%2Fbranches%2Fbleeding_edge%2Fdart%2Ftests%2Fhtml](http://code.google.com/p/dart/source/browse/#svn%2Fbranches%2Fbleeding_edge%2Fdart%2Ftests%2Fhtml)

但似乎他们都没有改变位置。

是否可以使用 DRT 进行验收测试？有没有我没有想到的解决方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T18:16:48.477

我们还没有想出一个好的技巧（重定向或 iframe）来加载应用程序，并在其上运行测试代码。相反，您可以复制应用程序的入口点并在其中包含测试代码，然后直接在 DRT 中运行修改后的应用程序。

这是执行此操作的测试的 web-ui 代码库中的示例。此测试运行 TodoMVC 应用程序并与之交互：

[https://github.com/dart-lang/web-ui/blob/master/test/data/input/todomvc_listorder_test.html](https://github.com/dart-lang/web-ui/blob/master/test/data/input/todomvc_listorder_test.html)

我们所做的只是复制原始应用的 html，添加“testing.js”脚本标签，并将 dart 脚本标签替换为测试代码。也许可以创建一个脚本来自动化我们今天手动执行的操作，但我们还没有这样做。

# c# - 捕获对 NativeWindow 的点击

> ID：14059606
> 
> 赞同：0
> 
> 时间：2012-12-27T18:43:58.077
> 
> 标签：c#, .net, windows, winforms, .net-4.0

我有一个基于 NativeWindow 类的类，我希望能够在用户单击它内部时执行一些操作。这是我尝试过的：

*代码已删除*

但是它不起作用。由于某种原因，调试表明消息永远不是 0x0201，这应该是鼠标左键单击。它出什么问题了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T15:14:22.633

我不确定工具提示能否收到 WM_LBUTTONDOWN。您可以尝试使用[TTM_RELAYEVENT 消息](http://msdn.microsoft.com/en-us/library/windows/desktop/bb760403%28v=vs.85%29.aspx)，该消息用于将鼠标消息传递给工具提示控件进行处理，如下所示：

```
 protected override void WndProc(ref System.Windows.Forms.Message m)
    {
        const int TTM_RELAYEVENT = 0x407;
        if (m.Msg == TTM_RELAYEVENT)
        {
            Message relayed = (Message)Marshal.PtrToStructure(m.LParam, typeof(Message));
            if (related.Msg == WM_LBUTTONDOWN)
            {
                // Do something
            }
        }

        base.WndProc(ref m);
    } 
```

# c# - Json.net 仅序列化数组的一部分

> ID：14059612
> 
> 赞同：2
> 
> 时间：2012-12-27T18:44:28.233
> 
> 标签：c#, arrays, json, serialization

谁能告诉我如何在`tools[]`没有`Func`委托的情况下仅序列化和反序列化数组的一部分：

```
 public class Tool
    {
        public Tool()
        {
            lastUse = 1;
            running = false;
        }
        public Func<int> action;
        public bool running;
        public int lastUse;
    }
    public static Tool[] tools = new Tool[] { new Tool(), new Tool(), new Tool(),new Tool()}; 
```

提前感谢您的任何回复。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-27T18:51:55.113

您可以做的一件事是利用[DataContract](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.datacontractattribute.aspx)和[DataMember](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.datamemberattribute.aspx)属性仅序列化您想要的数据。

```
[DataContract]
public class Tool
{
    public Tool()
    {
        lastUse = 1;
        running = false;
    }

    public Func<int> action;

    [DataMember]
    public bool running;

    [DataMember]
    public int lastUse;
} 
```

没有属性的结果：

```
[{"action":null,"running":false,"lastUse":1},{"action":null,"running":false,"lastUse":1},{"action":null,"running":false,"lastUse":1},{"action":null,"running":false,"lastUse":1}] 
```

具有以下属性：

```
[{"running":false,"lastUse":1},{"running":false,"lastUse":1},{"running":false,"lastUse":1},{"running":false,"lastUse":1}] 
```

这适用于[Json.NET](http://json.net/)和[DataContractJsonSerialize](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.json.datacontractjsonserializer.aspx)。

我喜欢这种方法的地方在于它可以让您保持标准的 C# 属性命名约定，但仍然输出“大小写正确”的 JSON。

```
[DataMember(Name="last_use")]
public int LastUse { get; set; } 
```

将输出

```
{"last_use": 1} 
```

# html - 使用 Google Analytics 跟踪来自 html5 下载属性的下载

> ID：14059622
> 
> 赞同：0
> 
> 时间：2012-12-27T18:45:13.973
> 
> 标签：html, google-analytics, download

寻找一种在使用新的 HTML5 下载属性时跟踪 pdf 文件下载的方法。理想情况下，我希望能够在 Google Analytics 中做到这一点。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T08:52:44.560

HTML5 下载属性仅与文件名有关。[它保持正常链接，您可以按照文档](https://developers.google.com/analytics/devguides/collection/gajs/eventTrackerGuide)中的说明跟踪事件。

做类似的事情：

```
<a href="your_file_url.pdf" downloads="file_name" onClick="_gaq.push(['_trackEvent', 'download', 'pdf', 'file_name']);">Download the pdf</a> 
```

# sql - 从 SQL Server 锁定 oracle 表

> ID：14059625
> 
> 赞同：0
> 
> 时间：2012-12-27T18:45:41.400
> 
> 标签：sql, sql-server, oracle10g

我在 SQL Server 2008 R2 中定义了一个视图，该视图使用链接服务器“正在查看”Oracle 10g 中的一个表。

我需要这样做（使用 SqlServer 端存储过程）：

1.  从视图中获取分子。
2.  做一些影响 SQL Server 表的事情。
3.  更新视图中的分子。

这需要一点时间，但我想在我的所有进程中锁定 oracle 表，因为其他程序可能会使用该表。所以，我想做的是：

1.  锁定 oracle 表
2.  从视图中获取分子。
3.  做一些影响 SQL Server 表的事情。
4.  更新视图中的分子。
5.  释放锁

不知道如何执行第 1 步和第 4 步。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T18:56:04.283

我会在 oracle 中执行以下操作：

```
create materialized view foo_View  
as  
--select statement that has the data sql server is looking for 
```

然后在 Oracle 中执行一个调度程序任务，该任务会定期重建/刷新此视图。

SQL Server 不需要向 Oracle 指示任何内容，听起来应用程序正在流血到不应该出现的地方。Oracle 物化视图的好处是可以在 SQL Server 进程运行时查询它而不会导致 Oracle 关闭。

**来自评论**

> 我的进程在 SQL Server 上运行，但我需要锁定 Oracle 表。

这就是我建议使用物化视图的原因。您不会关心另一个进程是否修改了基础表，因为 SQL Server 能够访问的唯一数据是该快照（也称为物化视图）。因此，您不必担心任何可能破坏 SQL Server 进程的资源争用/中流更新。这里的关键是您只关心哪些数据存在`now`于`now`由物化视图可用的快照定义的位置。

# php - jQuery File Upload 生成奇怪的 $_FILES 数组

> ID：14059629
> 
> 赞同：3
> 
> 时间：2012-12-27T18:46:02.863
> 
> 标签：php, jquery, file-upload, blueimp

> **可能重复：**
> [具有多个字段时 $_FILES 数组的奇怪格式](https://stackoverflow.com/questions/4818275/weird-format-of-files-array-when-having-multiple-fields)

我正在使用[jQuery File Upload](https://github.com/blueimp/jQuery-File-Upload/wiki/Basic-plugin)将文件上传到我的服务器。

这是我的处理程序：

```
$('#fileupload').fileupload({
    url: 'api/combox_upload.php',
    dataType: 'json',
    done: function (e, data) {
        console.log(data);
        $.each(data.result.files, function (index, file) {
            console.log(file);
            $('<p/>').text(file.name[0]).appendTo($file_uploads);
        });
    }
}); 
```

运行此文件：

```
<?php
header('Content-type: application/json');
echo json_encode($_FILES); 
```

但`$_FILES`我得到的数组看起来像这样：

```
{"files":{"name":["Screenshot from 2012-12-10 11:41:35.png"],"type":["image\/png"],"tmp_name":["\/var\/tmp\/phpHfnnt2"],"error":[0],"size":[180546]}} 
```

即，`files`是一个对象而不是文件数组，并且每个属性（名称、类型等）都是一个数组而不是一个字符串。

我认为它们是“并行数组”，即如果上传了 2 个文件，则每个文件中有 2 个条目。

但这不是通常的 PHP`$_FILES`数组的外观。jQuery File Upload 搞砸了吗？有没有办法恢复正常结构？

他们的小例子，

```
 $.each(data.result.files, function (index, file) {
            $('<p/>').text(file.name).appendTo(document.body);
        }); 
```

建议它应该采用我期望的格式（`files`作为一个数组）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T19:03:36.463

根据[这个答案](https://stackoverflow.com/a/4818338/65387)，这似乎是预期的行为。

我们可以通过我写的这个小函数将它转换回预期的格式：

```
function array_zip_keys($map) {
    $result = array();
    foreach($map as $key=>$arr) {
        foreach(array_values($arr) as $i=>$el) {
            $result[$i][$key] = $el;
        }
    }
    return $result;
} 
```

用法：

```
$files = array_zip_keys($_FILES['files']); 
```

# iphone - ios App检查iPhone抖动然后拍照

> ID：14059632
> 
> 赞同：0
> 
> 时间：2012-12-27T18:46:11.010
> 
> 标签：iphone, objective-c, ios, camera

我正在编写一个 iPhone 相机应用程序。当用户要拍照时，我想检查一下iPhone是否在晃动，等待没有晃动的那一刻，然后再抓拍手机。

我该怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-27T18:50:08.143

Anit-shake 功能是一个相当复杂的功能。我认为它是一些强大的模糊检测/去除算法和 iPhone 上的陀螺仪的组合。

你可以从研究[如何](http://developer.apple.com/library/IOS/#documentation/EventHandling/Conceptual/EventHandlingiPhoneOS/MotionEvents/MotionEvents.html)用 iPhone 检测运动开始，看看你能得到什么样的结果。如果还不够，请开始研究[移位/模糊方向检测算法](http://www.guthspot.se/video/deshaker.htm)。这不是一个微不足道的问题，但如果有足够的时间，您可能会完成。希望有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T19:28:43.557

```
// Ensures the shake is strong enough on at least two axes before declaring it a shake.
// "Strong enough" means "greater than a client-supplied threshold" in G's.
static BOOL L0AccelerationIsShaking(UIAcceleration* last, UIAcceleration* current, double threshold) {
    double
        deltaX = fabs(last.x - current.x),
        deltaY = fabs(last.y - current.y),
        deltaZ = fabs(last.z - current.z);

    return
        (deltaX > threshold && deltaY > threshold) ||
        (deltaX > threshold && deltaZ > threshold) ||
        (deltaY > threshold && deltaZ > threshold);
}

@interface L0AppDelegate : NSObject <UIApplicationDelegate> {
    BOOL histeresisExcited;
    UIAcceleration* lastAcceleration;
}

@property(retain) UIAcceleration* lastAcceleration;

@end

@implementation L0AppDelegate

- (void)applicationDidFinishLaunching:(UIApplication *)application {
    [UIAccelerometer sharedAccelerometer].delegate = self;
}

- (void) accelerometer:(UIAccelerometer *)accelerometer didAccelerate:(UIAcceleration *)acceleration {

    if (self.lastAcceleration) {
        if (!histeresisExcited && L0AccelerationIsShaking(self.lastAcceleration, acceleration, 0.7)) {
            histeresisExcited = YES;

            /* SHAKE DETECTED. DO HERE WHAT YOU WANT. */

        } else if (histeresisExcited && !L0AccelerationIsShaking(self.lastAcceleration, acceleration, 0.2)) {
            histeresisExcited = NO;
        }
    }

    self.lastAcceleration = acceleration;
}

// and proper @synthesize and -dealloc boilerplate code

@end 
```

我在 Google 上搜索并在[如何检测有人摇晃 iPhone 时发现？](https://stackoverflow.com/questions/150446/how-do-i-detect-when-someone-shakes-an-iphone)

# r - 如何跳过循环中的错误

> ID：14059657
> 
> 赞同：27
> 
> 时间：2012-12-27T18:48:01.403
> 
> 标签：r, error-handling, try-catch

我想在循环中跳过一个错误（如果有的话）并继续下一次迭代。我想计算 2×2 矩阵的 100 个逆矩阵，其中元素从 {0,1,2} 中随机采样。可以有一个奇异矩阵（例如，

```
1 0
2 0 
```

这是我的代码

```
set.seed(1)
count <- 1
inverses <- vector(mode = "list", 100)
repeat {
    x <- matrix(sample(0:2, 4, replace = T), 2, 2)
    inverses[[count]] <- solve(x)
    count <- count + 1
    if (count > 100) break
} 
```

在第三次迭代中，矩阵是奇异的，代码停止运行并显示错误消息。在实践中，我想绕过这个错误并继续下一个循环。我知道我需要使用 a `try`or`tryCatch`函数，但我不知道如何使用它们。这里也有人问过类似的问题，但它们都非常复杂，答案远远超出了我的理解。如果有人可以专门针对这个问题给我一个完整的代码，我真的很感激。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-12-27T19:06:11.440

这会将`NULL`s 放入`inverses`奇异矩阵中：

```
inverses[[count]] <- tryCatch(solve(x), error=function(e) NULL) 
```

如果调用中的第一个表达式`tryCatch`引发错误，它将执行并返回提供给其`error`参数的函数的值。提供给`error`arg 的函数必须将错误本身作为参数（这里我称之为`e`），但您不必对它做任何事情。

然后，您可以`NULL`使用 删除条目`inverses[! is.null(inverses)]`。

或者，您可以使用较低级别的`try`. 选择真的是品味问题。

```
count <- 0
repeat {
    if (count == 100) break
    count <- count + 1
    x <- matrix(sample(0:2, 4, replace = T), 2, 2)
    x.inv <- try(solve(x), silent=TRUE)
    if ('try-error' %in% class(x.inv)) next
    else inverses[[count]] <- x.inv
} 
```

如果您的表达式产生错误，则`try`返回一个带有 class 的对象`try-error`。如果 .它会将消息打印到屏幕上`silent=FALSE`。在这种情况下，如果`x.inv`有 class `try-error`，我们调用`next`以停止当前迭代的执行并移动到下一个迭代，否则我们添加`x.inv`到`inverses`.

## 编辑：

您可以避免将`repeat`循环与`replicate`and一起使用`lapply`。

```
matrices <- replicate(100, matrix(sample(0:2, 4, replace=T), 2, 2), simplify=FALSE)
inverses <- lapply(matrices, function(mat) if (det(mat) != 0) solve(mat)) 
```

有趣的是， to 的第二个参数`replicate`被视为一个`expression`，这意味着它会为每个复制重新执行。这意味着您可以使用从同一表达式`replicate`生成`list`的任意数量的随机对象。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-12-27T19:31:54.143

而不是使用`tryCatch`，您可以简单地使用函数计算矩阵的行列式`det`。矩阵是奇异的当且仅当行列式为零。

因此，您可以测试行列式是否不同于零并仅在测试为正时计算逆：

```
set.seed(1)
count <- 1
inverses <- vector(mode = "list", 100)
repeat {
  x <- matrix(sample(0:2, 4, replace = T), 2, 2)
  # if (det(x)) inverses[[count]] <- solve(x)
  # a more robust replacement for the above line (see comment):
  if (is.finite(determinant(x)$modulus)) inverses[[count]] <- solve(x)
  count <- count + 1
  if (count > 100) break
} 
```

* * *

**更新**：

但是，可以避免生成奇异矩阵。2×2 矩阵`mat`的行列式定义为`mat[1] * mat[4] - mat[3] * mat[2]`。您可以使用这些知识对随机数进行抽样。只是不要对会产生奇异矩阵的数字进行采样。当然，这取决于之前采样的数字。

```
set.seed(1)
count <- 1
inverses <- vector(mode = "list", 100)

set <- 0:2 # the set of numbers to sample from

repeat {

  # sample the first value
  x <- sample(set, 1)
  # if the first value is zero, the second and third one are not allowed to be zero.
  new_set <- ifelse(x == 0, setdiff(set, 0), set)
  # sample the second and third value
  x <- c(x, sample(new_set, 2, replace = T))
  # calculate which 4th number would result in a singular matrix
  not_allowed <- abs(-x[3] * x[2] / x[1])
  # remove this number from the set
  new_set <- setdiff(0:2, not_allowed)
  # sample the fourth value and build the matrix
  x <- matrix(c(x, sample(new_set, 1)), 2, 2)

  inverses[[count]] <- solve(x)
  count <- count + 1
  if (count > 100) break
} 
```

这个过程保证了所有生成的矩阵都有一个逆矩阵。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-12-27T19:11:34.370

`try`只是一种说法`R`：“如果您在以下括号内犯了错误，请跳过它并继续。”

因此，如果您担心这`x <- matrix(sample(0:2, 4, replace = T), 2, 2)`可能会给您带来错误，那么您所要做的就是：

```
try(x <- matrix(sample(0:2, 4, replace = T), 2, 2)) 
```

**但是**，请记住，`x`如果您这样做，那将是未定义的，并且最终无法计算答案。当你开始时，这可能会导致问题`solve(x)`- 所以你可以在`x`之前定义`try`或只是“尝试”整个事情：

```
try(
      {
      x <- matrix(sample(0:2, 4, replace = T), 2, 2)
      inverses[[count]] <- solve(x)
      }
    ) 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-12-27T18:56:42.627

[try 的文档](http://stat.ethz.ch/R-manual/R-devel/library/base/html/try.html)很好地解释了您的问题。我建议你完全通过它。

`Edit:`文档示例看起来非常简单，与操作的问题非常相似。（还是）感谢你的建议。以下是文档页面中示例的答案：

```
# `idx` is used as a dummy variable here just to illustrate that
# all 100 entries are indeed calculated. You can remove it.
set.seed(1)
mat_inv <- function(idx) {
    print(idx)
    x <- matrix(sample(0:2, 4, replace = T), nrow = 2)
    solve(x)
}
inverses <- lapply(1:100, function(idx) try(mat_inv(idx), TRUE)) 
```

# asp.net - 在 Asp.Net 错误中使用的 WCF 端点配置

> ID：14059659
> 
> 赞同：0
> 
> 时间：2012-12-27T18:48:25.300
> 
> 标签：asp.net, wcf

我在 Asp.Net 应用程序中托管了一些 WCF 服务，这些服务用于通过 Ajax 返回数据。IIS (6.0) 打开了 Windows 身份验证并关闭了匿名访问。我在 web.config 的服务模型部分尝试了各种设置组合，但似乎无法获得正确的组合。我不断收到的错误是：

此服务的安全设置需要“匿名”身份验证，但托管此服务的 IIS 应用程序未启用它。

这是我的 web.config

```
<configuration>  <system.web>    <authentication mode="Windows"/>   </system.web>

  <location path="~/Services">
    <system.web>
      <authorization>
        <allow users="*"/>
      </authorization>
    </system.web>   </location>

  <system.serviceModel>    

    <serviceHostingEnvironment aspNetCompatibilityEnabled="true" multipleSiteBindingsEnabled="true"/>  

    <bindings>
      <webHttpBinding>
        <binding name="default">
          <security mode="TransportCredentialOnly">
            <transport clientCredentialType="Windows" proxyCredentialType="Windows"/>
          </security>
        </binding>
      </webHttpBinding>
    </bindings>
    <behaviors>
      <endpointBehaviors>
        <behavior name="AspNetAjaxBehavior">
          <enableWebScript />
          <webHttp />
        </behavior>
      </endpointBehaviors>
      <serviceBehaviors>
        <behavior name="defaultServiceBehavior">
          <serviceMetadata httpGetEnabled="true" />
          <serviceDebug includeExceptionDetailInFaults="true" />
        </behavior>
      </serviceBehaviors>      
    </behaviors>

    <services>  
      <service name="WFS.SIG.Client.USM.Web.Services.Desks">
        <endpoint address="" behaviorConfiguration="AspNetAjaxBehavior" binding="webHttpBinding" contract="WFS.SIG.Client.USM.Web.Services.Desks"/>
      </service>
    </services>  

  </system.serviceModel>

</configuration> 
```

澄清这个问题的任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T20:30:44.873

您在 web.config 中的安全设置仅为传输：

```
<security mode="TransportCredentialOnly"> 
```

这意味着它在传输过程中被加密，但请求是匿名的。因此，您必须在 IIS 中打开匿名身份验证。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T14:05:04.263

@Shiraz Bhaiji - 如果您查看 web.config，它使用“TransportCredentialOnly”作为模式。事实证明，如果您打开了 Windows 身份验证并禁用了匿名，您需要将 clientCredentialType 更改为“Ntlm”。

# javascript - 使用 next 选择特定 html 标记的多个子项

> ID：14059660
> 
> 赞同：1
> 
> 时间：2012-12-27T18:48:26.143
> 
> 标签：javascript, jquery

我正在使用 jquery 制作效果，其中一个悬停在侧栏上并显示导航栏，但导航本身具有一些效果属性，因此当单击一个时`dd`，它会显示 3 个孩子`dt`并隐藏其余的但目前它只显示第一个 dt 并隐藏其余部分......为什么 close 方法在这里不起作用是代码。

```
<html>
 <head>
<title></title>
<script src="Jquery.js">
</script>
  </head>
  <body>
<div class="nav">
    <dl>
        <dt>
            <dd>One</dd>
            <dd>Two</dd>
            <dd>Three</dd>
        </dt>
        <dt>
            <dd>Four</dd>
            <dd>Five</dd>
            <dd>Six</dd>
        </dt>
        <dt>
            <dd>Seven</dd>
            <dd>Eight</dd>
            <dd>Nine</dd>
        </dt>
    </dl>
</div>  
<div class="sideBar"></div>
<script type="text/javascript">
    var Sides={ 
   sideBar:$("div.sideBar"),
    nav:$("div.nav"),
    dd:$("div.nav dd"),
     dt:$("div.nav dt"),
     init:function  () {

    Sides.sideBar.on("mouseenter",this.show);
    },
    show:function  () {
    Sides.nav.close.call(nav);
    Sides.nav.fadeIn(2000).filter(":nth-child(n+8)").hide();
    Sides.dd.on("click",function  () {
        Sides.dd.next("dt").slideDown(500).siblings("dt").hide();
    })
  },
  close:function  () {
    Sides.nav.on("mouseleave",function  () {
        $(this).fadeOut(1400)
    })
    }
     }
       Sides.init();

  </script>

      </body>
      </html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T18:52:38.317

删除`})();`JavaScript 代码中的尾随。它会导致阻止您的代码运行的 JavaScript 错误。

# java - 向 JInternalFrame 添加一个新类

> ID：14059663
> 
> 赞同：0
> 
> 时间：2012-12-27T18:48:34.993
> 
> 标签：java, swing, class, jframe

这是我的第一个 Java 项目，所以很抱歉问我肯定是一个明显的答案。我一直在搜索谷歌和我能拿到的每一本 java 书，但有些我错过了......

我正在创建一个项目，其中包括第一类中的四个内部框架。我希望每个内部框架都从其他类中获取其内容（而不是对主类中的所有内容进行分组。代码看起来真的很草率，最终有几百行长。导航太多了。这应该是是担心还是我太乏味了？）。

无论如何，这是我的主类（称为 Main）的 GUI：

```
private static void createAndShowGUI() {
    frame = new JFrame("Perceptum");
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.setJMenuBar(createMenuBar());
    desk = new JDesktopPane();
    frame1 = new JInternalFrame("Notepad", true, true, true, true);
    frame1.setBounds(0, 0, 1088, 500);
    frame1.getContentPane().setLayout(new BorderLayout()); 
    frame1.setDefaultCloseOperation(HIDE_ON_CLOSE);
    frame1.setVisible(true);

    frame2 = new JInternalFrame("Research", true, true, true, true);
    frame2.setBounds(1089, 0, 265, 670);
    frame2.getContentPane().setLayout(new BorderLayout());
    frame2.setVisible(true);

    frame3 = new JInternalFrame("Share", true, true, true, true);
    frame3.setBounds(790, 500, 300, 170);
    frame3.getContentPane().setLayout(new BorderLayout());
    frame3.setVisible(true);

    frame4 = new JInternalFrame("References", true, true, true, true);
    frame4.setBounds(0, 500, 790, 170);
    frame4.setVisible(true);

    desk.add(frame1);
    desk.add(frame2);
    desk.add(frame3);
    desk.add(frame4);
    frame.add(desk);
    frame.setSize(1370, 730);
    frame.setVisible(true);
} 
```

我想将类`Notepad`、`References`、`Research`和`Share`放入帧 1-4。我试过使用：

```
Notepad notes = new Notepad();
frame1.getContentPane().add(notes); 
```

还：

```
frame1.setContentPane(notes) 
```

和类似的变化。这真的让我发疯了。谢谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T19:04:40.557

尝试将用于创建每个帧的代码分解为一个方法，然后返回该帧。这将代码分解为可读的部分。您可以每帧使用一个类，但除非帧中有很多独特的东西，否则这太过分了。

```
private JInternalFrame frame1 = null; 
```

...

```
private JInternalFrame getFrame1() {
    if (frame1 == null) {
        frame1 = new JInternalFrame("Notepad", true, true, true, true);
        frame1.setBounds(0, 0, 1088, 500);
        frame1.getContentPane().setLayout(new BorderLayout()); 

        // TODO: Add code to fill in the contents by calling getXxx()
        //  for each major contained component OR just creating all the
        //  minor bits that go inside.

        frame1.setDefaultCloseOperation(HIDE_ON_CLOSE);
        frame1.setVisible(true);
    }
    return frame1;
} 
```

然后在您在问题中显示的方法中使用此行：

```
desk.add(getFrame1()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T21:28:33.790

JFrame 是一个顶级组件。一个主窗口。您不能将主窗口添加到 JInternalFrame。这就是堆栈跟踪所说的：

> java.lang.IllegalArgumentException：向容器添加窗口

在容器中添加窗口是违法的。

记事本和其他类应该扩展 JPanel，而不是 JFrame。JPanel 是一个可以添加到 JInternalFrame 的组件。

经验教训：即使错误消息对您来说毫无意义，它也包含有价值的信息。如果您不发布它，我们不知道问题是什么。代码还包含有价值的信息。如果您不发布它，我们不知道它的作用。

# r - 将 webGL html 转换为 SVG

> ID：14059669
> 
> 赞同：4
> 
> 时间：2012-12-27T18:49:02.210
> 
> 标签：r, svg, latex, webgl, vector-graphics

我正在使用 R，以及 misc3d 和 rpanel 库，在 webGL 中创建 3d 图像。然后我需要通过 Latex 将图像嵌入到 PDF 中。

3d 图像渲染得很好，看起来很棒 - 但我想我需要将 webGL HTML 文件转换为 SVG 或其他*可以*嵌入到 Latex 中的矢量图形文件。

关于如何做到这一点的任何建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T19:17:30.340

也许我错了，但这种方式对我来说没有意义。

*   你有 3D 坐标
*   使用 webGL 将基于 3D 坐标的对象渲染为 2D 光栅化图像
*   那么你想从渲染图像中提取二维矢量坐标吗？

从 webGL 帧缓冲区，您可以获得光栅化数据（无矢量信息）。所以这就像将光栅化图像（如 png）转换为 SVG。由于没有办法（我知道）从光栅化图像中获取矢量信息，因此图像只会嵌入到 SVG 文件中的可能性很高。与光栅化图像相比，这不会是一个真正的好处。

也许您可以使用矢量信息（用于绘制 webGL 图像）直接绘制到 SVG 图像？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T19:31:09.307

# php - 如何在 php 中使用 cookie 进行问答验证

> ID：14059673
> 
> 赞同：-2
> 
> 时间：2012-12-27T18:49:24.023
> 
> 标签：php, html

我想创建一个有点像登录的脚本。在进入某个页面之前，他们必须正确回答一个问题。如果他们做对了，他们就会进入页面。例如“你妈妈叫什么名字？” 如果妈妈的名字是 Laurie，那么他们必须将其输入到文本框中并正确处理才能继续。

**更新**
我使用了奥利弗莫兰给我的脚本来完成这个。我添加了更多问题，因此目前每页只有一个问题。在回答完最后一个问题后，我将页面定位到他们登录的地方，因为我无法仅仅根据问题的答案弄清楚如何做到这一点。我很高兴将用户登录作为一个单独的功能。我已经获得了让他们登录的表单，而不是让未登录的用户访问这些页面。只要他们保持浏览器窗口打开，脚本就可以工作。

我使用了 Oliver Moran 提供的关于使用会话的链接，您可以在我的代码中看到我使用会话。但这并不能解决让他们保持登录状态的问题。

我现在想知道一旦用户登录后如何设置 cookie，以便他们可以离开浏览器窗口并返回并仍然登录。我已经在这个网站上搜索了答案，但找不到一个感觉。这是我的登录代码

```
<?php

session_start();

$username=$_POST['username'];
$password=$_POST['password'];

if ($username&&$password) {
$connect = mysql_connect("127.0.0.1","root","") or die('Couldn\'t Connect to Database');
mysql_select_db ("login") or die('Couldn\'t find database');
$query = mysql_query("SELECT * FROM members WHERE username='$username'");
$numrows = mysql_num_rows($query);
if ($numrows !=0) {
    while($rows = mysql_fetch_assoc($query)){
        $dbusername = $rows['username'];
        $dbpassword = $rows['password'];
    }
    if ($username==$dbusername&&$password==$dbpassword) {
        echo "Login Successful. <a href='home.php'>Click here for the members area</a>";
        $_SESSION['username'] = $dbusername;
    }
    else{
        echo "Incorrect Password";
    }
}
else{
    die("Incorrect Username and Password");
}
}
else{
die("Please enter something in the boxes");
}
?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T19:33:56.617

通常，服务器端语言用于此类事情。这是因为，如果您在 JavaScript 中进行密码检查，任何人都可以看到正确的密码（因为所有代码都可以通过查看页面的源代码获得）。

为了安全地执行此操作，您需要将答案提交到服务器并使用服务器端语言来检查答案。然后，服务器端脚本决定将什么响应返回给用户。

PHP 是一种非常流行的服务器端脚本语言。这是基础知识：

首先，我们需要一个`login.html`包含 HTML 表单的登录页面 ( )，如下所示：

```
<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1"/>
    <title>Login</title>
</head>

<body>

    <form action="script.php" method="post">
        <label>Enter your mom's name: <input type="text" name="mom" /></label>
        <input type="submit" value="Submit" />
    </form>

</body>

</html> 
```

这里的重要部分是表格。提交表单后，数据将发送到名为`script.php`.

该脚本如下所示：

```
<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1"/>
    <title>Check login</title>
</head>

<body>

    <?php

    $mom = $_REQUEST['mom'];
    $correct_answer = "Barbie";

    if (!isset($mom) || $mom != $correct_answer) {
        // nothing was submited or the name was incorrect
        echo '<p>That\'s the wrong answer. <a href="login.html">Try again.</a></p>';
    } else {
        echo '<p>Welcome! That\'s the right answer.</p>';
    }

    ?>

</body>

</html> 
```

这是一个相当简单的脚本。它检查为“妈妈”提交的内容。如果未提交任何内容或答案错误，则会显示“重试”消息。否则，将显示“欢迎”消息。

PHP 逻辑（以及正确答案）在 Web 浏览器中将不可见。只会从服务器发送“重试”或“欢迎”消息。

这是在服务器端使用 HTML 表单的基础知识。我建议你阅读使用 PHP。这是一种简单而有趣的语言（如果不雅，在我看来）。你可以在这里学习基础知识：

*   [http://www.w3schools.com/php/default.asp](http://www.w3schools.com/php/default.asp)

要测试您的代码，您将需要一个 Web 服务器。您可以从这里下载并安装一个带有 PHP 和 MySQL（数据库）的成熟 Web 服务器：

*   [http://www.wampserver.com/en/](http://www.wampserver.com/en/)

有了它，您可以在自己的机器上测试服务器端代码。为了测试上面的例子，把上面的代码复制到两个文件中，分别叫做`login.html`and `script.php`，放到`www`WAMP 的目录下。

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T20:25:20.363

这是我设法想出的。在页面顶部，在`<!DOCTYPE html>`

```
<?php
//Check for existance of cookie from right answer
  if(isset($_COOKIE['parents'])){
    header("Location:q1.html");//Move on to next question
  }
//Checks answer
  if(array_key_exists("dad", $_POST) && array_key_exists('mom', $_POST)){
    $dad = $_POST["dad"];
    $mom = $_POST["mom"];
    $dcorrect = array("Dad", "dad");
    $mcorrect = array("Mom", "mom");
    if(in_array($dad, $dcorrect) && in_array($mom, $mcorrect)){
        setcookie('parents', '1' ,time()+60*60*24);
        header("Location: index.html");
    }else{
        $wrong="<div class='error'>Wrong answer</div>";
    }
}
?> 
```

有了这个 HTML

```
<form action="index.html" method="post">
  <label>Enter your father's name:</label>
  <input required autocomplete="off" type="text" name="dad" placeholder="Bill">
  <label>Enter your mother's name:</label>
  <input required autocomplete="off" type="text" name="mom" placeholder="Billette">
  <input type="submit" value="Press me when you think you are right" />
  <?php echo $wrong; ?>

</form> 
```

# php - 从 3 个下拉菜单中获取数据并根据这 3 个参数从 db 中填充 4 个

> ID：14059674
> 
> 赞同：0
> 
> 时间：2012-12-27T18:49:36.207
> 
> 标签：php, javascript, ajax, joomla

我需要知道出了什么问题。PHP 不返回任何内容。我认为变量不会出现在 PHP 文件中。请帮助我找出问题所在。

```
<?php
defined('_JEXEC') or die;
$db = JFactory::getDbo();
$an=$_POST['an'];
$fac=$_POST['fac'];
$uni=$_POST['uni']; 

$result1 = mysql_query("SELECT * FROM drv_uni_$uni WHERE an='$an'");

while($row = mysql_fetch_array($result1)){
     $display_string = "<option value=\"".$row['materie']."\">". $row['materie'] ."</option>";
}
     echo $display_string;
?> 
```

Javascript

```
function  getValFromDb() {
    var valoare_selectata_uni = document.getElementById('category').value;
    var valoare_selectata_fac = document.getElementById('subcategory').value;
    var valoare_selectata_an = document.getElementById('an').value;
    var url = "modules/mod_data/tmpl/script.php";
    var params = 'uni=' + valoare_selectata_uni + 
                 '&fac=' + valoare_selectata_fac +
                 '&an=' + valoare_selectata_an;

    if (window.XMLHttpRequest) { 
        AJAX=new XMLHttpRequest(); 
    } else { 
        AJAX=new ActiveXObject("Microsoft.XMLHTTP"); 
    }

    if (AJAX) {
        AJAX.open("POST", url, false);
        AJAX.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
        AJAX.onreadystatechange = function() {
            if(AJAX.readyState == 4 && AJAX.status == 200) {
                var answer = AJAX.responseText;
                document.getElementById('materie').innerHTML = answer;
            }
        }; 
        AJAX.send(params);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T02:56:42.910

您可以使用以下几种方法调试代码。

1.  您可以`print_r($result1)`首先查看您的 SQL 是否返回您想要的结果。如果没有尝试处理查询。

2.  `$display_string = "<option value=\"".$row['materie']."\">". $row['materie'] ."</option>";`错了，你应该有一个像下面这样的。`$display_string .= "<option value=\"".$row['materie']."\">". $row['materie'] ."</option>";`. 你不见了`.=`

3.  `if had static variables and included on the main it shows good.`而不是`$_POST`使用 Joomla 检索 POST 数据的方式`JRequest::getVar('an');`。**[阅读更多](http://docs.joomla.org/Retrieving_and_Filtering_GET_and_POST_requests_with_JRequest%3a%3agetVar)**

让我知道我可能会帮助你的结果。

# salesforce - 在控制器级别进行错误检查，使字段成为必需

> ID：14059676
> 
> 赞同：0
> 
> 时间：2012-12-27T18:49:43.680
> 
> 标签：salesforce, apex-code, visualforce

我有一个包含很多字段的 VF 页面。要求是字段上的所有错误消息都需要在页面顶部一起列出，并且具有字段级别的错误消息。目前，我们有这样的东西：

```
<apex:inputField value = 'f1' />
<apex:inputField value = 'f2' /> 
```

当用户单击提交时，在控制器级别，我检查是否有任何一个字段为空白，如果是，我返回一个聚合错误。但我不知道如何渲染所需的红色条，因为这一切都发生在控制器级别

基本上，要求是

1.  对于必填字段有一个红色条
2.  如果字段未填写，则显示字段级别错误
3.  对于所有字段级错误，在页面顶部显示一条消息，说明用户需要输入这些值

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T14:27:28.867

您可以使用 (Required="true") 属性。该属性属于 apex:inputField 标签。这个属性会给你字段级错误。您不需要在控制器中进行编码。

对于所有字段级错误，您必须添加一个 VF 标签`<apex:pagemessages />`。此标签将一起显示所有错误消息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T01:13:19.717

如果您想更进一步并为业务逻辑添加错误而不仅仅是空字段，请查看 APEX 代码中的 addError() 功能。

[http://wiki.developerforce.com/page/An_Introduction_to_Exception_Handling](http://wiki.developerforce.com/page/An_Introduction_to_Exception_Handling)

# blogs - Shopify 显示如果 Blog.Handle 是 X 用于博客列表

> ID：14059683
> 
> 赞同：0
> 
> 时间：2012-12-27T18:50:13.400
> 
> 标签：blogs, shopify

我正在尝试编辑 blog.liquid 以便在特定的博客列表中，其上方有一个自定义图形。

与此类似的东西：

```
<div id="page-header">
    <h2 id="page-title">{{ blog.title }}</h2>
</div>
{% if blog.new-years-revolution %}
<p class="alignCenter">**[custom code here]**
</p>
{% endif %}

{% for article in blog.articles  %}

<h3 class="blog">
<a href="{{article.url}}">{{ article.title | escape }}</a></h3>

    {% if article.excerpt.size > 0 %}
        {{ article.excerpt }}
    {% else %}
        <p>{{ article.content | strip_html | truncate: 800 }}</p>
    {% endif %}

{% endfor %} 
```

基本上我不希望它出现在任何其他博客上，只是这个特定的。所以一个基本的 if 语句说“如果在这个博客上，显示这个”。我不确定是使用 blog.id 还是 blog.handle，并且取决于哪个，如何引用该特定句柄，以便该图像仅显示在该句柄上。

希望我解释得足够清楚。谷歌搜索了一段时间，还没有发现任何有用的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T20:14:15.663

那应该是：

```
{% if blog.handle == 'new-years-revolution' %}
<p class="alignCenter">**[custom code here]**</p>
{% endif %} 
```

# eclipse - Eclipse：Maven 搜索依赖项不起作用

> ID：14059685
> 
> 赞同：95
> 
> 时间：2012-12-27T18:50:20.047
> 
> 标签：eclipse, maven, maven-plugin, maven-dependency-plugin

我在一个新的 Workspace 中创建了一个新的简单 Maven 项目。

当我在 Eclipse 编辑器中打开`pom.xml`'视图并选择依赖项时，无论我在搜索字段中输入什么搜索条件，都没有搜索结果：`Dependencies``Add..`

例如，它立即给我`Results for 'spring' (0)`。

在我的另一个工作区中，对于我现有的项目，我没有这个问题。

有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：193
> 
> 时间：2012-12-28T02:33:36.857

Eclipse 工件搜索依赖于存储库的索引文件。您似乎没有下载索引文件。

转到**Window -> Prefrences -> Maven**并检查**"Download repository index updates on start"**。重新启动 Eclipse，然后查看进度视图。应下载索引文件。

完全下载后，神器搜索就可以使用了。

![Maven 设置](../Images/75613f6e2fb4c15ae17d147446eca0e1.png)

**更新** 您还需要在“maven 存储库视图”中重建 Maven 存储库索引。

在此视图中，打开“全局存储库”，右键单击“中央”，选中“启用完整索引”，然后单击同一菜单中的“重建索引”。

将下载一个 66M 的索引文件。

![Maven 存储库 -> 重建索引](../Images/534bdfe8ef9523b157bc03cfcdd4a38a.png)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2018-04-28T06:33:32.543

在你的 Eclipse 中，转到 Windows -> Preferences -> Maven [![首选项 Maven 截图](../Images/2ecf506277c0bd2ff6e870995ffa4970.png)](https://i.stack.imgur.com/RaPCH.png) 勾选“启动时下载存储库索引更新”选项。您可能需要重新启动 Eclipse。

还要转到 Windows -> 显示视图 -> 其他 -> Maven -> Maven 存储库 [![Maven 存储库视图截图](../Images/47230ffde90c8b84fcf7caba3c19bf27.png)](https://i.stack.imgur.com/5qwcH.png)

在 Maven 存储库面板上，展开全局存储库，然后右键单击中央存储库并选中**“启用完整索引”**选项，然后单击**“重建索引”**。

[![完整索引截图](../Images/c5d6eb17872bbb7dbb1fcece0a3198c1.png)](https://i.stack.imgur.com/DxYDq.png)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-27T18:55:00.223

如果您在公司代理中并且新项目未指向具有代理凭据的正确 settings.xml 文件，则可以获得此结果。

如果您使用 Maven 代理（例如 Nexus）并且代理的索引以某种方式混乱，您也可以得到这个。我不知道如何描述如何解决这个问题。玩弄它或打电话给设置 Maven 代理的人。

如果新工作区尚未从 Maven 中心或代理下载索引，您也可以获取此信息。（这是最好的，因为您只需等待一段时间，它就会自行解决。）

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2017-08-16T09:07:58.230

对我来说，这个问题的工作是：

*   删除 ~/.m2
*   在中央存储库的 Maven 存储库视图中启用“启用完整索引”
*   中央 Maven 存储库上的“重建索引”

eclipse重启后一切正常。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-08-14T15:37:37.433

maven add 依赖实际上来自 maven 索引。如果索引是最新的，则结果应该来自那里。

如果您转到 maven 存储库，然后选择全局存储库，您应该会看到一个中央 ... 选项卡，然后选择它，应该有一个文件夹列表，您应该能够从那里看到所有索引。如果没有，那么这意味着你没有得到完整的索引，那么你可以右键单击它并启用完整的索引。

最让我恼火的另一件事是，即使我做了所有事情，当我输入“spring”时它仍然没有显示任何内容。这实际上是我做错的地方。如果你只是输入一些额外的文本“springframework”，BOOM，结果就在那里。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-12-09T02:46:58.687

我也有同样的问题。上面建议的选项都不适合我。但是我发现，如果我说手动为 org.springframework.spring-core 版本 4.3.4.RELEASE 添加 groupid/artifact/version 并保存 pom.xml，依赖项会自动下载并且搜索适用于已经存在的 jar在存储库中。但是，如果我现在搜索不在当前依赖项中的 org.springframework.spring-context ，则此搜索仍然不起作用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-06-03T06:51:24.143

手动使用带有前缀 fc: 的[https://search.maven.org/](https://search.maven.org/)来搜索类名。Netbeans 和 Eclipse 似乎都太笨了，无法使用那个搜索界面，而且下载的存储库索引的千兆字节似乎不包含任何类信息。完全浪费磁盘空间。这些 IDE 项目最近维护得非常糟糕，我希望他们能将开发转移到 GitHub。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-02-16T14:31:43.947

需要提供 Group Id 和 Artifact Id 来下载您需要的 jar 文件。如果您想搜索它，只需使用 * ， * 这些字段。

# ms-access - 基于组合框值刷新 MS Access 表单/查询

> ID：14059687
> 
> 赞同：1
> 
> 时间：2012-12-27T18:50:30.433
> 
> 标签：ms-access, vba, criteria, ms-access-2010

很简单的解释。我有一个包含 10 个条目的表，5 个条目包含 2010 年，5 个条目包含 2011 年的列。

在我的查询中，我使用 Like *2010 过滤掉所有等于 2010 的条目并仅显示这些记录。

在我的表格上，我的组合框填充了每个独特的年份（来自不同的表）。所以我的组合框值是 2010 和 2011。

是否有可能，当我选择说 2011 时，我修剪正确的 4 个字符并用作我的 Like 条件来刷新和重新查询表单，所有这些都在 VBA 中完成？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T19:03:40.320

只要包含该控件的表单处于打开状态，您就可以在 Access 会话中运行的查询中引用该控件的值。

```
SELECT *
FROM YourTable
WHERE date_field_as_text Like "*" & Forms!YourForm!YourCombo; 
```

因此，也许您可​​以使用类似的查询作为表单的记录源，并`Me.Requery`在组合框的更新后事件中执行。

如果这还不够接近您想要的，请向我们提供有关所涉及字段的数据类型的更多信息。在您的问题中添加表格数据的简短示例也会有所帮助；请明确“日期”字段是文本还是日期/时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T19:07:57.853

是的，有可能。只需将您的内容添加到“YourComboName.After_Update”即可。查找在显示表单之前触发的表单事件。像 HansUp 建议的那样构建您的查询。

# c# - 通过 cookie 控制对页面的访问

> ID：14059688
> 
> 赞同：1
> 
> 时间：2012-12-27T18:50:40.233
> 
> 标签：c#, asp.net, cookies, asp.net-mvc-4

我想通过 cookie 控制对我的应用程序某些页面的访问。但我只想从一个地方协调这一点。我想在 Layout.cshtml IE 中进行检查，这样所有使用此布局的页面都会自动执行。这样好吗？

编辑：这个应用程序的安全性不是问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T18:53:43.980

你违反了 MVC 的核心原则之一——*永远不要把真正的逻辑放在视图*中。

相反，您应该创建一个 ActionFilter。

您还应该弄清楚如何保护 cookie；您可能应该使用 ASP.Net 现有的会员系统

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T18:53:35.690

不，这不好，因为任何人都可以轻松操纵 cookie。

为什么不想使用已经可用的常规身份验证和授权技术？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-27T18:55:05.373

使用 cookie 来控制对页面的访问听起来不是一个好主意。您将不得不创建一种方法来保护 cookie，这并不容易。没有它，您的身份验证将很容易被欺骗。

我建议您使用 MVC 4 的内置身份验证和授权机制，该机制已为此目的经过充分测试和构建。这是[一篇](http://blogs.msdn.com/b/rickandy/archive/2012/03/23/securing-your-asp-net-mvc-4-app-and-the-new-allowanonymous-attribute.aspx)帮助您入门的文章。

使用 MVC4 的`[Authorize]`和`[AllowAnonymous]`属性，在将站点的某些部分限制为授权用户时，您可以非常灵活。

我发布了一个更冗长的示例，使用上述属性作为[另一个 SO question 的答案](https://stackoverflow.com/questions/9727509/how-to-allow-anonymous-user-access-to-some-page-in-mvc/9727564#9727564)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-27T19:07:30.527

您应该在控制器/页面上使用[Authorize](http://msdn.microsoft.com/en-us/library/system.web.mvc.authorizeattribute%28v=vs.108%29.aspx)属性而不是 cookie，并将页面限制为某些角色并将用户分配给角色。

# php - 如何判断 MySQL 字段是否具有空字符串的默认值或没有默认值？

> ID：14059689
> 
> 赞同：0
> 
> 时间：2012-12-27T18:50:55.490
> 
> 标签：php, mysql

如果我们在 MySQL 中使用“DESCRIBE table”语法，它会返回有关表的信息，包括字段及其默认值。

[http://dev.mysql.com/doc/refman/5.0/en/describe.html](http://dev.mysql.com/doc/refman/5.0/en/describe.html)

但是，我们如何区分具有空字符串默认值的字段与根本没有默认值的字段之间的区别？

在这两种情况下，它都会为 DESCRIBE 表语句的输出中的“默认”列返回一个空值。

我需要能够使用 PHP 解析数据，以便轻松检测旧表格格式和新表格格式之间的差异。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T18:52:15.720

尝试以下操作：

```
Show create table tablename 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T18:53:57.427

如果您需要为应用程序提供可轻松查询的架构信息，我建议您使用 MySQL`INFORMATION_SCHEMA`数据库。该数据库提供可查询的元数据表，应该满足您的需求，您可能对该`COLUMNS`表感兴趣。您可能会像这样查询它：

```
SELECT * FROM COLUMNS WHERE `TABLE_NAME` = 'your_table' AND `TABLE_SCHEMA` = 'your_database' 
```

当然，您需要考虑限制与您的应用程序关联的数据库用户的访问权限，因为`INFORMATION_SCHEMA`如果有其他应用程序正在运行，您可能不希望他们看到全部内容（尽管该用户显然能够看到有关其他数据库的信息）表`COLUMNS`）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T19:21:53.833

如果默认值不存在，MySQL 似乎会将该值报告为“NULL”。这意味着如果该字段设置为“NOT NULL”，我们可以假设默认值 NULL 意味着默认值为空或设置为该字段类型的 MySQL 默认值。

# javascript - CSS 和 Javascript 媒体查询检测

> ID：14059692
> 
> 赞同：1
> 
> 时间：2012-12-27T18:51:19.170
> 
> 标签：javascript, jquery, css, media-queries

从[http://www.w3.org/TR/css3-mediaqueries/](http://www.w3.org/TR/css3-mediaqueries/)我们可以看到有多种方式来声明媒体查询，例如：

(1)`@media screen and (min-width: 400px) and (max-width: 700px) { … }`

(2)`@media handheld and (min-width: 20em), screen and (min-width: 20em) { … }`

(3)`@media screen and (device-aspect-ratio: 16/9) { … }`

(4)`@media screen and (device-width: 800px) { … }`

等等。

我想知道在javascript或浏览器中是否有任何方法可以找到某些媒体查询适用的宽度范围。

例如 (1) 将介于 400 和 700 之间，而 (4) 将恰好是 800

解析媒体查询字符串以确定此信息似乎很乏味。有没有更简单的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T20:22:15.633

试试这个 mediaquery 小书签：[http ://fhemberger.github.com/mediaquery-bookmarklet/](http://fhemberger.github.com/mediaquery-bookmarklet/)

# sqlite - 有没有办法使用 SELECT 作为 CASE WHEN 的表达式？

> ID：14059695
> 
> 赞同：0
> 
> 时间：2012-12-27T18:51:39.573
> 
> 标签：sqlite

我是 SQLite 的新手，我想问一下是否有办法使用 SELECT 作为 CASE WHEN 的表达式？

例如

```
CASE WHEN item_type = 'item' THEN 
    SELECT * FROM items ... END AS 'col_1', 
        WHEN item_type = 'subitem' THEN 
            SELECT * FROM subitems ... END AS 'col_2' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T08:52:02.860

是的你可以。您需要做的就是将您的子选择括在括号中。例如，这有效：

```
SELECT CASE WHEN 1 = 0 THEN (SELECT 1) ELSE (SELECT 0) END 
```

此外，子选择必须完全返回单个值（它不能返回超过 1 个值）。因此，如果您尝试这样做`SELECT * FROM subitems ...`，它将不起作用，除非表`subitems`中仅包含一列和单行。

# javascript - 在补偿 rowspan 和 colspan 时按行和列选择表格单元格

> ID：14059698
> 
> 赞同：5
> 
> 时间：2012-12-27T18:51:51.563
> 
> 标签：javascript, jquery

我希望能够按行和列索引选择表格单元格，同时补偿`rowspan`和`colspan`。例如，在下表中，

![示例表](../Images/bc2e95fd6fc90181686eb8a2d9b373d8.png)

我希望将（1,2）红色，（2,3）绿色和（3,3）蓝色着色，以产生：

![预期表](../Images/380274f045bed53ca6a2e6d3f51268b5.png)

[我尝试了“按行号和列号选择表格中的任意单元格”](https://stackoverflow.com/questions/5930892/selecting-an-arbitrary-cell-in-a-table-by-row-and-column-number)这个问题的答案，但这产生了：

![实际表](../Images/c7b438ff46a215ed3135d279dbe4bf63.png)

**[这是 jsFiddle：http://jsfiddle.net/acheong87/27HuN/](http://jsfiddle.net/acheong87/27HuN/)**

我明白发生了什么，我什至发现了另一个问题，[“Table cellIndex and rowIndex with colspan/rowspan”](https://stackoverflow.com/questions/13407348/table-cellindex-and-rowindex-with-colspan-rowspan)，答案是作为插件提供的，但似乎没有更简单的方法！毕竟，实际结果的着色似乎可以理解，但不直观，而*预期*结果的着色似乎更直观，更容易掌握。

**谁能想到一个聪明而简单的方法来实现这个？**

* * *

**更新**

[这是我（糟糕的）尝试的新 jsFiddle，](http://jsfiddle.net/acheong87/B4kV5/)以防它可能激发其他人的新想法。基本上，*如果*我们假设 row 和 col 标题没有跨越（当然，这不是一个有效的假设），那么我们可以使用偏移量来“定位”正确的单元格：

```
function getCell(table, r, c)
{
    var rowHead = $(table.rows[r].cells[0]);
    var colHead = $(table.rows[0].cells[c]);
    var y = rowHead.offset().top + rowHead.outerHeight(true)/2;
    var x = colHead.offset().left + colHead.outerWidth(true)/2;
    return $(document.elementFromPoint(x, y));
} 
```

虽然演示似乎有效，但存在许多问题：

1.  不能假设没有跨越行和列标题。
2.  如果行或列的中点不在视口之外，则不起作用；`elementFromPoint`似乎取决于视口。
3.  滚动、边距等起作用时不能可靠地工作；一般脆弱；宁愿不依赖坐标数学。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T21:26:59.117

这是一种不同的“预处理”方法：

```
var grid = (function(){

  var table = $("#table")[0], a=[], cell, i, j, k, l, y;

  for (i=0;i<table.rows.length;i++) a[i] = [];

  for (i=0;i<table.rows.length;i++) {
      y = 0;
      for (j=0;j<table.rows[i].cells.length;j++) {
          while (a[i][j + y]) y++;
          cell = $(table.rows[i].cells[j]);
          xspan = parseInt(cell.attr('rowspan') || 1);
          yspan = parseInt(cell.attr('colspan') || 1);
          for (k=0;k<xspan;k++) {
              for (l=0;l<yspan;l++) {
                  if(i + k < table.rows.length) a[i + k][j + y + l] = [i,j];
              }
          }
      }
  }

  return a;

})();

colorCell(1,2,'red');
colorCell(2,3,'green');
colorCell(3,3,'blue');

function colorCell(i,j,s){
    var a = grid[i][j];
    $(table.rows[a[0]].cells[a[1]]).css('background-color', s);
} 
```

[jsfiddle](http://jsfiddle.net/27HuN/26/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T19:06:26.203

您的设计是定制的，因此您的解决方案也必须是定制的。由于表格与预期结构的偏离程度，没有简单的通用方法来解决此问题。删除注释掉的`td`元素，您将看到脚本正在处理的真实形状。

与所有良好的优化一样，您应该预先做一些工作。当你准备它们时，使用类名或数据属性来标记哪个单元格，之后的工作将大大减少。从昂贵的计算和解决方法（例如建议的插件）中可以看出，预先不做任何工作最终会让您付出代价。

有关我的意思的示例，请参见此 jsfiddle：http: [//jsfiddle.net/27HuN/2/](http://jsfiddle.net/27HuN/2/)

万一发生什么事，这里是一个副本

*html*

```
<table id="table" border="1" cellpadding="10" style="text-align:center;">
<tbody>
    <tr class="0">
        <td class="0-0">(0,0)</td>
        <td class="0-1">(0,1)</td>
        <td class="0-2">(0,2)</td>
        <td class="0-3">(0,3)</td>
    </tr>
    <tr class="1">
        <td class="1-0">(1,0)</td>
        <td colspan="2" class="1-1 1-2">(1,1) (1,2)</td>
        <!--<td></td>-->
        <td rowspan="2" class="1-3 2-3">(1,3)<br/>(2,3)</td>
    </tr>
    <tr class="2">
        <td class="2-0">(2,0)</td>
        <td class="2-1">(2,1)</td>
        <td class="2-2">(2,2)</td>
        <!--<td></td>-->
    </tr>
    <tr class="3">
        <td class="3-0">(3,0)</td>
        <td class="3-1">(3,1)</td>
        <td class="3-2">(3,2)</td>
        <td class="3-3">(3,3)</td>
    </tr>
</tbody>
</table>​ 
```

*js*

```
$('.1-2').css('background-color', 'red');
$('.2-3').css('background-color', 'green');
$('.3-3').css('background-color', 'blue'); 
```

请注意，这是一个*简单*的示例，您可能希望使用不仅仅是数字的类名。也许`r0c0`，`r2c3`标记的类型，或者更详细的逻辑来表示这些位置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-27T20:10:40.847

我已经在 J​​SFiddle 中尝试过......虽然花了一些时间......

```
var table = $("#table")[0];

SetColumnColor(1, 2, 'red');
SetColumnColor(2, 3, 'green');
SetColumnColor(3, 3, 'blue');

function SetColumnColor(rowIndex, cellIndex, color){

    var actualRowIndex = GetActualRowIndex(table, rowIndex, cellIndex);
    var actualCellIndex = GetActualCellIndex(table.rows[actualRowIndex], cellIndex);
    $(table.rows[actualRowIndex].cells[actualCellIndex]).css('background-color', color);
}

function GetActualCellIndex(row, cellIndex) {
    var actualCellIndex = cellIndex;
    $(row.cells).each(function(index) {
        var colSpan = parseInt($(this).attr('colspan'));
        if(colSpan != NaN && colSpan > 0)
        {
            //alert(colSpan);
            actualCellIndex = actualCellIndex - colSpan + 1;
        }
    });

    return actualCellIndex;
}

function GetActualRowIndex(table, rowIndex, cellIndex) {
    var actualRowIndex = rowIndex;

    if(table.rows[rowIndex].cells[cellIndex] != null)
        return rowIndex;

    $(table.rows).each(function(index) {
        if(rowIndex <= index)
            return actualRowIndex;
        var realCellIndex = GetActualCellIndex(this, cellIndex);
        //alert("Row:" + index + "(" + realCellIndex + "," + cellIndex+ ")");
        var rowSpan = parseInt($(table.rows[index].cells[realCellIndex]).attr('rowspan'));
        if(rowSpan != NaN && rowSpan > 0)
        {
            //alert(rowSpan + "(" + index + "," + realCellIndex + ")");
            actualRowIndex = actualRowIndex - rowSpan + 1;
        }
    });

    return actualRowIndex;
} 
```

可[在此处获得工作演示](http://jsfiddle.net/27HuN/9/)

# eclipse - Eclipse Juno 图形错误？

> ID：14059704
> 
> 赞同：8
> 
> 时间：2012-12-27T18:52:19.470
> 
> 标签：eclipse

我一直在谷歌上寻找解决方案，但我什至不知道应该用哪些词来找到它......无论如何，我的问题是 Eclipse 在 Linux Mint 14 x64 中看起来像这样：

[http://i.stack.imgur.com/BBfyg.png](http://i.stack.imgur.com/BBfyg.png)

我使用的是从他们的网页下载的 Eclipse，而不是从存储库下载的。我尝试重置透视图，删除了 eclipse 和工作区文件夹，但它一直看起来像这样。有任何想法吗？

**编辑** 我终于设法摆脱它。看起来它与GTK有关。我在首选项中将外观更改为经典并解决了它。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-28T20:47:43.673

转到 Window > Preferences > General > Appearance 并将主题更改为 Classic 似乎可以解决问题。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-12T07:18:44.577

将 Eclipse 首选项从 GTK 更改为 Classic 对我不起作用。只有一些 Eclipse 组件的背景显示为灰色，这使得视觉损坏不太明显。

然而，它有助于将 Linux Mint 中的 GTK 主题从“Mint-X”更改为“Adwaita”，看起来也不错。所以这可能是一种解决方法。

更新：这是 Mint-X 主题中的一个小错误/问题/缺失功能，可以很容易地手动修复。见[http://dentrassi.de/2013/04/23/fixing-the-mint-x-theme-for-eclipseswt/](http://dentrassi.de/2013/04/23/fixing-the-mint-x-theme-for-eclipseswt/)

# mysql - 数据库主键必须是整数吗？

> ID：14059705
> 
> 赞同：14
> 
> 时间：2012-12-27T18:52:19.793
> 
> 标签：mysql, primary-key

我总是将 MySQL 数据库主键视为整数。是因为主键必须是整数，还是因为`auto_increment`在列上设置时易于使用？

我想知道以防万一我希望我的主键`varchar`在未来成为 a 。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-27T18:54:35.743

`varchar`只要确保每一个都是**独一无二的**，您就可以使用。然而，这并不理想（有关更多信息，请参阅下面的文章链接）。

您正在寻找的内容称为**自然键**，但具有自动增量并由 RDBMS 处理的主键称为**代理键**，这是首选方式。因此，您需要将其设置为**integer**。

学到更多：

*   [主键的代理键与自然键？](http://decipherinfosys.wordpress.com/2007/02/01/surrogate-keys-vs-natural-keys-for-primary-key/)
*   [为什么在数据库设计中我更喜欢代理键而不是自然键](http://weblogs.sqlteam.com/mladenp/archive/2009/10/06/Why-I-prefer-surrogate-keys-instead-of-natural-keys-in.aspx)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-12-27T19:15:45.970

### 为什么整数是好的主键

与字符串或复合键相比，使用整数进行索引通常更容易，因为它很适合将结果（概念上或实际上）视为数组。根据数据库实现的不同，整数的访问、排序或比较也可能更快，并且整数类型通常提供其他数据类型不具备的附加功能，例如自动递增。例如，您将如何自动增加复合键？

MySQL对主键[有这样的说法：](http://dev.mysql.com/doc/refman/5.6/en/optimizing-primary-keys.html)

> 表的主键表示您在最重要的查询中使用的列或列集。它有一个关联的索引，用于快速查询性能。查询性能受益于 NOT NULL 优化，因为它不能包含任何 NULL 值。

SQL 允许将任何非空的唯一列（或列集）用作主键。但是，如果您不关心自动递增，您通常可以将主键设为唯一且非空的[任何索引。](http://dev.mysql.com/doc/refman/5.6/en/optimization-indexes.html)

### 考虑您的应用程序的期望

虽然不是硬性要求，但一些框架针对整数主键进行了优化。例如，Ruby on Rails 默认使用自动递增的主键；如果你想使用不同的东西，你必须故意违背惯例。

这并不意味着应该或不应该使用整数作为主键。这只是意味着主键的选择部分由您的底层数据库系统和您希望对其运行的查询驱动，部分由您希望用于检索数据的应用程序驱动。在考虑候选键时，应考虑所有这些事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-27T18:54:15.680

主键是唯一的。int 很容易通过自动递增来满足该条件。如果将其设为 char，则必须创建一种方法来使其在添加数据时唯一。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-27T18:55:47.287

不，主键不必是整数；这很常见。例如，我们这里的用户 ID 可以有前导零，因此必须存储在 varchar 字段中。该字段用作我们 Employee 表中的主键。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-27T18:56:12.360

主键为 Integer，更容易管理，索引更有效。如您所知，虽然键是自动索引的，但索引存储为二叉树，最适合遍历整数。将键设置为 int 没有任何限制，您也可以将其声明为 varchar。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-12-27T19:16:11.880

基本上一个主键只需要满足两个条件：它必须是一个非空列并且它必须是唯一的。任何符合这两个条件的列类型都可以设置为主键。如果主键是多列，则两列都必须不为空。

虽然理论上您可以使用其他字段作为主键，但整数是最容易管理的，也是最快的可用索引。

# asp.net-mvc - Bootstrap Popover 不适用于 MVC3

> ID：14059707
> 
> 赞同：2
> 
> 时间：2012-12-27T18:52:33.820
> 
> 标签：asp.net-mvc, asp.net-mvc-3, css, twitter-bootstrap

我正在尝试使用`"popover"`MVC `"@Html.PasswordFor"`帮助器元素，但仅显示标题而不显示内容。代码是：

```
 @Html.PasswordFor(model => model.Password, new {rel = "popover", 
                   data_original_title = "Choose new password",  
                   data_content = "minimum 8 chars"}) 
```

它生成如下 HTML 代码：

```
<input rel="popover" data-original-title="Choose new password" 
       data-content="minimum 8 chars" id="Password" name="Password"
       type="password" 
/> 
```

**Javascript代码**：

```
$(document).ready(function () {
    $("#Password").popover({ trigger: 'hover' });   
}); 
```

该代码有效，但仅显示标题（“选择新密码”）而不显示内容（“最少 8 个字符”）

我尝试直接编写HTML代码，它工作正常，而且是相同的代码！！！但使用 Razor 语法不起作用。

谁能帮我？我添加了一个带有结果的图像

![结果](../Images/3ee3212b68517e0d529a5e2536445f60.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T10:37:26.963

问题是一个 CSS 类（“input-prepend”），我在该类的 DIV 中有一个“Input”控件。“bootstrap.css”中的那个类“定义了字体大小：0；” 所以我看不到文字，虽然标题可以正常看到。感谢 Jesse Webb 和 Miika L

# batch-file - 命令：for | 它不会接受我在 skip=%var% 选项中的变量

> ID：14059714
> 
> 赞同：3
> 
> 时间：2012-12-27T18:53:35.407
> 
> 标签：batch-file, cmd

好吧，我有点卡在我的代码的以下部分。该程序将计算文件 usernames_list.txt 中的行数。在每一行都有一个我要输入的文件夹的名称。我希望该程序进入我列表中的每个文件夹，创建一个名为 test_1 的文件，然后转到它的父文件夹。这应该重复，直到它到达列表的末尾。我做对了吗？：/由于某种原因，“跳过”选项不会接受我的变量。

```
 for /f %%C in ('Find /V /C "" ^< usernames_list.txt') do set lines=%%C
    set times=0
    set /A skip_value=%lines%-(%lines%-%times%)
    :redo
    FOR /F "skip=%skip_value%" %%b IN (usernames_list.txt) DO (
    cd %%b
    echo > test_1
    cd ..
    set /A times=%times%+1
    if /i {%times%}=={%lines%} (goto continue)
    goto redo
    )
    :continue
    pause 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-27T20:59:57.437

如目前所写，`set /A skip_value=%lines%-(%lines%-%times%)`将始终评估为 0，因为时间 = 0。

SKIP 值*必须*>= 1。设置 SKIP=0 会导致语法错误。

在我看来，您计算 skip_value 的逻辑是有缺陷的。但是，即使您修复了逻辑，您仍然需要担心 <= 0 的值。我通过仅当值 >= 1 时使用整个选项文本定义一个 SKIP 变量来处理这种情况。

```
set "skip="
if %skip_value% geq 1 set "skip=skip=%skip_value%"
for /f "%skip%" %%b in (usernames_list.txt) ... 
```

您可能需要额外的 FOR /F 选项。那不是问题。例如：

```
for /f "%skip% delims=" ... 
```

# ruby-on-rails - ruby rails 水族馆语法错误

> ID：14059715
> 
> 赞同：-1
> 
> 时间：2012-12-27T18:53:37.870
> 
> 标签：ruby-on-rails, ruby, syntax-error

我遇到了 Rails 应用程序的水族馆语法问题。它是我从我推送到的 github 存储库中克隆的一个应用程序，它运行良好。我是唯一一个推送更新的人

=========================

# 这是我尝试运行 rails 时遇到的错误

/Users/jcollyer/.rvm/gems/ruby-1.9.3-p327/gems/activesupport-3.0.10/lib/active_support/dependencies.rb:239:in `require': /Users/jcollyer/.rvm/gems/ruby-1.9.3-p327/gems/aquarium-0.3.0/lib/aquarium/aspects/exclusion_handler.rb:34: syntax error, unexpected ':', expecting keyword_then or ',' or ';' or '\n' (SyntaxError) when String: type_or_object.name.eql?(t) ^ /Users/jcollyer/.rvm/gems/ruby-1.9.3-p327/gems/aquarium-0.3.0/lib/aquarium/aspects/exclusion_handler.rb:35: syntax error, unexpected keyword_when, expecting keyword_end when Symbol: type_or_object.name.eql?(t.to_s) ^ /Users/jcollyer/.rvm/gems/ruby-1.9.3-p327/gems/aquarium-0.3.0/lib/aquarium/aspects/exclusion_handler.rb:36: syntax error, unexpected keyword_when, expecting keyword_end when Regexp: type_or_object.name =~ t ^ /Users/jcollyer/.rvm/gems/ruby-1.9.3-p327/gems/aquarium-0.3.0/lib/aquarium/aspects/exclusion_handler.rb:37: syntax error, unexpected keyword_else, expecting keyword_end else type_or_object == t ^ /Users/jcollyer/.rvm/gems/ruby-1.9.3-p327/gems/aquarium-0.3.0/lib/aquarium/aspects/exclusion_handler.rb:61: syntax error, unexpected keyword_end, expecting $end from /Users/jcollyer/.rvm/gems/ruby-1.9.3-p327/gems/activesupport-3.0.10/lib/active_support/dependencies.rb:239:in`block in require' 来自 /Users/jcollyer/.rvm/ gems/ruby-1.9.3-p327/gems/activesupport-3.0.10/lib/active_support/dependencies.rb:225:in `block in load_dependency' from /Users/jcollyer/.rvm/gems/ruby-1.9.3-p327/gems/activesupport-3.0.10/lib/active_support/dependencies.rb:593:in`new_constants_in' 来自 /Users/jcollyer/.rvm/gems/ruby-1.9.3-p327/ gems/activesupport-3.0.10/lib/active_support/dependencies.rb:225:in `load_dependency' from /Users/jcollyer/.rvm/gems/ruby-1.9.3-p327/gems/activesupport-3.0.10/lib/active_support/dependencies.rb:239:in`require' 来自 /Users/jcollyer/.rvm/gems/ruby-1.9.3-p327/gems/aquarium-0.3.0/lib/ aquarium/aspects/aspect.rb:5:in `<top (required)>' from /Users/jcollyer/.rvm/gems/ruby-1.9.3-p327/gems/activesupport-3.0.10/lib/active_support/dependencies.rb:239:in`require' 来自 /Users/jcollyer/.rvm/gems/ruby-1.9.3-p327/gems/activesupport-3.0.10/lib/active_support/dependencies.rb:239：在`block in require' from /Users/jcollyer/.rvm/gems/ruby-1.9.3-p327/gems/activesupport-3.0.10/lib/active_support/dependencies.rb:225:in`来自 /Users/jcollyer/.rvm/gems/ruby-1.9.3-p327/gems/activesupport-3.0.10/lib/active_support/dependencies.rb:593:in 的 load_dependency 块中`new_constants_in' from /Users/jcollyer/.rvm/gems/ruby-1.9.3-p327/gems/activesupport-3.0.10/lib/active_support/dependencies.rb:225:in`load_dependency' 来自 /Users/jcollyer/.rvm/gems/ruby-1.9.3-p327/gems/activesupport-3.0.10/lib/active_support/dependencies.rb:239:in `require' from /Users/jcollyer/.rvm/gems/ruby-1.9.3-p327/gems/aquarium-0.3.0/lib/aquarium/aspects.rb:2:in`'来自 /Users/jcollyer/.rvm/ gems/ruby-1.9.3-p327/gems/activesupport-3.0.10/lib/active_support/dependencies.rb:239:in `require' from /Users/jcollyer/.rvm/gems/ruby-1.9.3-p327/gems/activesupport-3.0.10/lib/active_support/dependencies.rb:239:in`block in require' 来自 /Users/jcollyer/.rvm/gems/ruby-1.9.3- p327/gems/activesupport-3.0.10/lib/active_support/dependencies.rb:225:in `block in load_dependency' from /Users/jcollyer/.rvm/gems/ruby-1.9.3-p327/gems/activesupport-3.0.10/lib/active_support/dependencies.rb:593:in`new_constants_in' 来自 /Users/jcollyer/.rvm/gems/ruby-1.9.3-p327/gems/activesupport-3.0.10/ lib/active_support/dependencies.rb:225:in `load_dependency' from /Users/jcollyer/.rvm/gems/ruby-1.9.3-p327/gems/activesupport-3.0.10/lib/active_support/dependencies.rb:239:in`require' 来自 /Users/jcollyer/.rvm/gems/ruby-1.9.3-p327/gems/aquarium-0.3.0/lib/aquarium.rb:5:in `<top (required)>' from /Users/jcollyer/.rvm/gems/ruby-1.9.3-p327@global/gems/bundler-1.2.1/lib/bundler/runtime.rb:68:in`require ' 来自 /Users/jcollyer/.rvm/gems/ruby-1.9.3-p327@global/gems/bundler-1.2.1/lib/bundler/runtime.rb:68:in`block (2 levels) in require' from /Users/jcollyer/.rvm/gems/ruby-1.9.3-p327@global/gems/bundler-1.2.1/lib/bundler/runtime.rb:66:in`来自 /Users/jcollyer/.rvm/gems/ruby-1.9.3-p327@global/gems/bundler-1.2.1/lib/bundler/runtime.rb:66:in `block in require' from /Users/jcollyer/.rvm/gems/ruby-1.9.3-p327@global/gems/bundler-1.2.1/lib/bundler/runtime.rb:55:in`each' 来自 /Users/jcollyer/ .rvm/gems/ruby-1.9.3-p327@global/gems/bundler-1.2.1/lib/bundler/runtime.rb:55:in `require' from /Users/jcollyer/.rvm/gems/ruby-1.9.3-p327@global/gems/bundler-1.2.1/lib/bundler.rb:128:in`require' 来自 /Users/jcollyer/Documents/projects/hughes/hughes_cms/ Funeral-Homes/config/application.rb:7:in `<top (required)>' from /Users/jcollyer/.rvm/gems/ruby-1.9.3-p327/gems/railties-3.0.10/lib/rails/commands.rb:28:in`require' 来自 /Users/jcollyer/.rvm/gems/ruby-1.9.3-p327/gems/railties-3.0.10/lib/rails/commands.rb： 28:in `block in <top (required)>' from /Users/jcollyer/.rvm/gems/ruby-1.9.3-p327/gems/railties-3.0.10/lib/rails/commands.rb:27:in`tap' 来自 /Users/jcollyer/.rvm/gems/ruby-1.9.3-p327/gems/railties-3.0.10/lib/rails/commands.rb:27:in `<top (required)>' from script/rails:6:in`require' 来自脚本/rails： 6：在`'

# 我的宝石文件

来源“http://rubygems.org”

*   宝石'导轨'，'3.0.10'
*   宝石'sqlite3'
*   宝石'mysql2'，'< 0.3'
*   宝石“设计”
*   gem '简单导航'
*   gem '回形针', '~> 2.4'
*   宝石'jquery-rails'，'> = 1.0.12'
*   宝石'galetahub-simple_captcha'，需要：“simple_captcha”
*   gem 'will_paginate', '~> 3.0'
*   宝石“水族馆”
*   宝石“元搜索”

组 :test, :development do - gem "rspec-rails", "~> 2.6" - gem "autotest" - gem 'factory_girl' end

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T18:58:55.283

指定水族宝石的版本

```
gem "aquarium", "~> 0.5.1" 
```

ruby 1.9.3 仅支持 0.5.1 版本

> V0.5.1（2012 年 5 月 1 日）：现在支持 Ruby 1.9.3 和 JRuby 1.6.7。

**来源** [http://aquarium.rubyforge.org/](http://aquarium.rubyforge.org/)

或者我应该说这个应用程序使用 ruby​​-1.8.7 而不是 ruby​​-1.9.3。因为 rails 3.0 可能与 ruby​​-1.9.3 不兼容

# android - Paypal 库中的 ArrayIndexOutOfBoundsException

> ID：14059722
> 
> 赞同：0
> 
> 时间：2012-12-27T18:54:00.343
> 
> 标签：android, paypal

我在`ArrayIndexOutOfBoundsException`结帐后得到一个取消的交易。我正在使用 SANDBOX 测试帐户。

我在这里提供堆栈跟踪中的块：

```
FATAL EXCEPTION: Thread-481
E/AndroidRuntime(15495): java.lang.ArrayIndexOutOfBoundsException: length=4; index=6
at com.paypal.android.MEP.PayPal.getPayType(Unknown Source)
at com.paypal.android.a.m.f(Unknown Source)
at com.paypal.android.a.b.y(Unknown Source)
at com.paypal.android.a.b.f(Unknown Source)
at com.paypal.android.a.k.run(Unknown Source) 
```

我的付款任务课程是 -

```
public class PaymentTask extends AsyncTask<Void, Void, Void>{

private Handler mHandler;
private Activity mActivity;

// The PayPal server to be used - can also be ENV_NONE and ENV_LIVE
private static final int server = PayPal.ENV_SANDBOX;

// The ID of your application that you received from PayPal
private static final String appID = "APP-80W284485P519543T";

public PaymentTask(Activity mActivity, Handler mHandler){
    super();
    this.mHandler = mHandler;
    this.mActivity = mActivity;
}

@Override
protected Void doInBackground(Void... params) {

    PayPal pp = PayPal.getInstance();
    // If the library is already initialized, then we don't need to initialize it again.
    if(pp == null) {
        pp = PayPal.initWithAppID(mActivity, appID, server);

        pp.setLanguage("en_US"); // Sets the language for the library.

        pp.setFeesPayer(PayPal.FEEPAYER_EACHRECEIVER); 
        // Set to true if the transaction will require shipping.
        pp.setShippingEnabled(true);
        pp.setDynamicAmountCalculationEnabled(false);
    }

    return null;
}

@Override
protected void onPostExecute(Void result) {
    mHandler.sendEmptyMessage(0);
    super.onPostExecute(result);
} 
```

}

单击签出按钮时正在执行的代码 -

```
 PayPalPayment newPayment = new PayPalPayment();
            newPayment.setSubtotal(new BigDecimal(Integer.parseInt("10"));
            newPayment.setCurrencyType("USD");
            newPayment.setRecipient("my.mail@gmail.com");
            newPayment.setPaymentType(PayPal.PAYMENT_SUBTYPE_DONATIONS);
            newPayment.setMerchantName("Support the initiative");
            // Sets the memo. This memo will be part of the notification sent by PayPal to the necessary parties.
            newPayment.setMemo("Thanks for contributing generously!");
            Intent paypalIntent = PayPal.getInstance().checkout(newPayment, getSherlockActivity());
            startActivityForResult(paypalIntent, request);
        }

        mCheckoutButton.updateButton(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T08:49:19.183

您正在使用`PayPal.PAYMENT_SUBTYPE_DONATIONS`支付子类型作为支付类型。您应该使用其中之一来定义付款类型：`PayPal.PAYMENT_TYPE_GOODS`、`PayPal.PAYMENT_TYPE_SERVICE`或。`PayPal.PAYMENT_TYPE_PERSONAL``PayPal.PAYMENT_TYPE_NONE`

如果要设置子类型，请像这样设置：

```
newPayment.setPaymentSubtype(PayPal.PAYMENT_SUBTYPE_DONATIONS); 
```

# php - 如何从字符串中获取所有数字并使用php创建总量

> ID：14059737
> 
> 赞同：0
> 
> 时间：2012-12-27T18:54:48.513
> 
> 标签：php, string, time, valueconverter

我想获取从我们的数据库输出的总小时数，但问题是这些值是字符串格式的

例如值：

```
9H:20M
3H:13M
3H:50M
6H:30M

TOTAL:22H:53M 
```

我想得到所有值的总和并在之后显示它，但我不知道如何将数字从字符串中分离出来，然后将其转换为时间格式，有什么方法可以让我达到我的结果寻找使用 php 脚本进行值和数据的转换和分离？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-27T19:01:55.910

这是一个非常基本的解决方案：

```
<?php

$times = array("9H:20M", "3H:13M", "3H:50M", "6H:30M",);

$total = 0;
foreach ($times as $time) {
  preg_match("#(\d+)H:(\d+)M#", $time, $matches);
  $total += 60 * $matches[1] + $mtaches[2];
}

echo $total; 
```

这将创建一个`$total`包含总分钟数的值。现在您可以转换回 H 和 M。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-27T19:14:16.000

您可以使用 strtotime 或较新的 DateTime 类，但是您当前的格式不兼容，因此您必须先进行一些修改。这是一个可能的解决方案：

```
<?php
$result = 0;
$times = array('9H:20M','3H:13M','3H:50M','6H:30M');
foreach($times as $time) {
    preg_match('/^(\d{1,2})H[:]([0-5][0-9])M$/',$time, $m);
    $timestamp = strtotime($m[1].':'.$m[2]);
    $result+=$timestamp;
}
echo date('H:i',$result);
?> 
```

我认为更好的方法是直接从数据库中获取总时间。

# php - 正则表达式匹配两个不同字符的第一次和最后一次出现之间的所有内容

> ID：14059747
> 
> 赞同：4
> 
> 时间：2012-12-27T18:55:56.777
> 
> 标签：php, regex

我有以下代码：

```
$str_val = "L(ine 1(
    L(ine 2)
    Line 3
    Line 4)";
$regex = '/\(([^\)]*?)\)/i';
preg_match($regex, $str_val, $matches_arr);
print_r($matches_arr); 
```

此代码匹配 first`(`和 first之间的所有内容`)`。

我正在寻找`$regex`可以匹配 first`(`和 last之间的所有内容的内容`)`。

我会很感激你的帮助。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T18:58:49.103

你可以使用这个： -

```
'/\((.*)\)/s' 
```

`/s`修饰符用于使*点元字符*匹配包括换行符在内的所有内容。而且，由于`.*`是一个贪婪的量词，它将匹配可能的最长字符串。所以，它会匹配到最后一个`)`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T18:58:45.050

试试这个正则表达式：

```
\([^\)]*\) 
```

第一场比赛是你需要的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T18:59:24.337

只是做一个贪婪的搜索

```
$regex = '/\(.*\)/s'; 
```

如果您真的想拥有*两者之间* `(...)`的一切，请使用这个

```
$regex = '/\((.*)\)/s';
preg_match($regex, $str_val, $matches_arr);
echo $matches_arr[1]; 
```

# css - Wordpress 中的图像对齐错误

> ID：14059749
> 
> 赞同：0
> 
> 时间：2012-12-27T18:56:10.477
> 
> 标签：css, image, wordpress

我正在为 Wordpress 开发一个主题。

像往常一样，主页（`index.php`或`home.php`）带有帖子摘要和`single.php`文件以显示某个帖子。

在主页上，图像对齐工作如下：

![主页对齐](../Images/6e19d8058892f42ad064c63998f54c33.png)

当我调整页面大小时...

![主页对齐 - 调整大小](../Images/df08eedad47229e5eecaca5ebdbb2931.png)

在里面`single.php`，它显示如下：

![单个帖子](../Images/7e20d784bb2678bb35cb925e678ad68f.png)

我正在使用这个样式表：

```
/* Images */

.alignright {
    float:right;
    margin: 0 0 10px 20px;
}
.alignleft {
    float:left;
    margin: 0 20px 10px 0;
}
.aligncenter {
    display: block;
    margin: 0 auto 1px auto;
    clear: both;
}

.wp-caption {
    border: 1px solid #ddd;
    text-align: center;
    background-color: #f3f3f3;
    padding-top: 4px;
}

.wp-caption img {
    margin: 0;
    padding: 0;
    border: 0 none;
}

.wp-caption p.wp-caption-text {
    font-size: 12px;
    font-style: italic;
    line-height: 20px;
    padding: 0 5px;
    margin: 5px 0;
} 
```

我该如何解决这些问题？最好的问候，六。

注：帖子正文代码为：

```
<article class="post-9 post type-post status-publish format-standard hentry category-uncategorized tag-ipsum tag-lorem tag-smashing tag-sticky" id="post-9">

    <!-- Display the Post's content in a div box. -->
    <div class="entry">
        <div id="attachment_10" class="wp-caption alignright" style="width: 253px"><a href="http://localhost/~vdenotaris/wordpress/?attachment_id=10" rel="attachment wp-att-10"><img class="size-medium wp-image-10" alt="Smashing Pumpkins" src="http://localhost/~vdenotaris/wordpress/wp-content/uploads/2012/12/SP-Poster-243x300.jpg" width="243" height="300" /></a><p class="wp-caption-text">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque et sapien metus. Nulla  a sollicitudin nunc.</p></div>
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque et sapien metus. Nulla a sollicitudin nunc. <ins datetime="2012-12-19T17:23:48+00:00">Donec diam sem, porta id facilisis sit amet</ins>, auctor et justo. Mauris sapien urna, imperdiet imperdiet pharetra in, tempus id augue. Sed vitae leo purus. Donec consectetur porta leo vitae luctus. Sed sed mollis nulla.</p>
        <p>Praesent venenatis gravida pellentesque. Pellentesque sit amet orci sem, vitae gravida massa. Maecenas suscipit volutpat felis. Proin placerat est at ipsum fermentum vulputate.</p>
        <p>In ac erat lacus, ac congue urna. Nunc egestas luctus orci, ut elementum neque gravida vel. Vivamus blandit nunc vitae mauris convallis ac euismod felis ultricies. Phasellus ac ligula lorem, in adipiscing velit. Aliquam auctor ultricies est, vitae condimentum tellus consequat eget.</p>
        <div id="attachment_34" class="wp-caption alignleft" style="width: 250px"><a href="http://localhost/~vdenotaris/wordpress/?attachment_id=34" rel="attachment wp-att-34"><img class="size-medium wp-image-34 " alt="Benuimaru" src="http://localhost/~vdenotaris/wordpress/wp-content/uploads/2012/12/Benimaru-Nikaido-240x300.jpg" width="240" height="300" /></a><p class="wp-caption-text">Benimaru Nikaido</p></div>
        <p>Nulla tempor, ante pulvinar vehicula faucibus, turpis mi pellentesque est, eget egestas lectus nulla vel nisl. Curabitur in turpis id eros ultrices gravida. Nam vel mauris in nibh blandit facilisis et ut dui. Donec in dignissim diam. Maecenas aliquam porttitor sapien, at tempus mauris tincidunt ut. Donec ut lectus id ante fermentum pretium. Curabitur auctor orci eu magna ultrices auctor. Etiam placerat, magna nec ultricies convallis, elit turpis mattis felis, ut dapibus lorem orci in enim. Fusce ipsum felis, commodo et posuere quis, commodo ut lacus. Pellentesque tristique augue varius arcu blandit mollis. Donec aliquam purus vitae augue vehicula placerat. Aenean libero nulla, rutrum in volutpat id, viverra id nunc.</p>
        <ul>
        <li>Quisque auctor consequat sagittis. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas.</li>
        <li>Nullam luctus placerat lorem ornare volutpat. Integer <code>euismod magna</code> a neque fringilla eget mollis orci tristique.</li>
        </ul>
        <pre>Etiam sagittis augue vitae nunc imperdiet ut vehicula diam condimentum. Etiam non massa libero. Nam eget mi felis, nec dapibus neque. Cras viverra eleifend cursus. Aliquam sagittis auctor accumsan. Vivamus tincidunt, metus a varius condimentum, nisl erat commodo libero, et faucibus urna dolor eget nisi. Cras mi lectus, dictum sed volutpat eu, laoreet non mi. Aliquam dolor odio, malesuada sed volutpat et, facilisis sit amet eros.</pre>
        <p>Aenean hendrerit feugiat leo, eget sollicitudin mauris pretium non. Suspendisse potenti. Quisque eget nunc magna. Proin lectus dolor, consequat et vulputate id, vehicula id velit. Cras at elit id turpis luctus pretium sed eu ante.<del> Nunc rutrum pulvinar dapibus. Mauris nisl mauris, porttitor in pulvinar nec, auctor ac felis.</del> Aliquam malesuada purus sed augue condimentum et lacinia turpis porttitor. Donec tempor aliquet ligula, elementum facilisis est congue eget.</p>
        <blockquote><p>Nullam dapibus aliquet sem, vel mollis elit sagittis vel. Etiam quis leo ante, ut ultricies orci.</p></blockquote>
        <p>Mauris eget ipsum orci, et euismod tortor. Integer gravida justo nisl, in dictum eros. Maecenas<strong> venenatis erat eu tortor consequat porttitor eu et lectus</strong>. Maecenas volutpat nibh quis nisl tempor quis faucibus enim rhoncus. Vestibulum placerat, dolor in faucibus lacinia, augue odio rhoncus justo, sed facilisis lectus nulla eget tortor. Donec vitae purus nulla. Quisque ut tellus quis turpis fermentum bibendum. <a title="Sample" href="http://sample">Mauris ullamcorper, massa in suscipit luctus, metus dui auctor est, et mattis dolor tortor quis elit.</a> Nulla felis massa, auctor vel adipiscing malesuada, tempor a velit. Sed tincidunt congue turpis eget pharetra.</p>
    </div>

</article> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T19:02:15.627

您可以通过向也具有 .alignright 的 .wp-caption 类添加 clear:left 来强制它，反之亦然。拥有您网站的 URL 将有助于您获得更具体的内容。

更新：您使用的是响应式布局，因此事情会根据浏览器而有所不同，但基本上看起来您对 single.php 上的第一个图像浮动的方式不满意，因此它将第二段削减为一个单词在第一行。但是，您对此无能为力，除非稍后将帖子写成 PITA。您的主页和 single.php 的显示略有不同，主页上的第一段比 single.php 长得多 - 大约 1-2 行 - 这就是为什么浮动到右侧的第一个图像表现不同的原因。至于无序列表，不幸的是，这是 WordPress 图像对齐的典型痛苦，一直看到它。处理它的最简单方法是尝试构建您的帖子，以使图像不会出现在列表旁边，或者，除非，

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T16:01:36.527

我发现的唯一解决方案如下：

```
article .entry ul {
    margin: 10px 0 10px 2px;
}

article .entry ul > li {
    margin: 5px 0;
    list-style-position: inside;
}

/* Images */

.alignright {
    display: inline;
    float: right;
    margin: 0 0 10px 20px;
}

.alignleft {
    display: inline;
    float: left;
    margin: 0 20px 10px 0;
}

.aligncenter {
    display: block;
    margin: 0 auto 1px auto;
    clear: both;
}

.wp-caption {
    border: 1px solid #ddd;
    text-align: center;
    background-color: #f3f3f3;
    padding-top: 4px;
}

.wp-caption img {
    margin: 0;
    padding: 0;
    border: 0 none;
}

.wp-caption p.wp-caption-text {
    font-size: 12px;
    font-style: italic;
    line-height: 20px;
    padding: 0 5px;
    margin: 5px 0;
} 
```

结果是：

![修复结果](../Images/d055cbff5296ec0b7b85586c85bc1f40.png)

这可能不是最好的技术，但结果可能被认为是可以接受的（我认为）。

# java - 在android中同步多个曲目

> ID：14059753
> 
> 赞同：0
> 
> 时间：2012-12-27T18:56:19.543
> 
> 标签：java, android

我投入了几天但没有得到正确的答案。

我正在开发一个应用程序，其中 12 个轨道应该并行执行，它们是，但我的问题是开始时间不一样。

实际上我的问题是要同步我的 12 首曲目。所有轨道一次开始，所有轨道之间不应存在毫秒差异。如果出现任何差异，则无法完美地完成轨道混合。

我的代码在按钮单击时播放所有曲目。

```
 mp1_track_a.start();
    mp1_track_b.start();        
    mp2_track_a.start();
    mp2_track_b.start();        
    mp3_track_a.start();
    mp3_track_b.start();
    mp4_track_a.start();
    mp4_track_b.start();
    mp5_track_a.start();
    mp5_track_b.start();
    mp6_track_a.start();
    mp6_track_b.start(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T19:03:40.007

使用具有一个内核的单个处理器（您必须考虑功耗较低的 android 设备），不可能像您要求的那样进行并行工作。即使很艰难，您也有多个线程，实际上它们将按顺序工作。

# asp.net - Gridview 行更新不起作用

> ID：14059754
> 
> 赞同：0
> 
> 时间：2012-12-27T18:56:36.263
> 
> 标签：asp.net, visual-studio-2010, gridview

我有一个更新行的简单任务，单击更新链接按钮，如

```
<asp:GridView ID="GridView1" runat="server" AutoGenerateColumns="false" OnRowEditing="GridView1_RowEditing"
            OnRowUpdating="GridView1_RowUpdating" DataKeyNames="ID">
            <Columns>
                <asp:TemplateField HeaderText="ID">
                    <ItemTemplate>
                        <asp:Label ID="Label3" runat="server" Text='<% #Eval("ID") %>'></asp:Label>
                    </ItemTemplate>
                </asp:TemplateField>
                <asp:TemplateField HeaderText="Mobile">
                    <ItemTemplate>
                        <asp:Label ID="Label2" runat="server" Text='<% #Eval("Mobile") %>'></asp:Label>
                    </ItemTemplate>
                </asp:TemplateField>
                <asp:TemplateField HeaderText="LName">
                    <EditItemTemplate>
                        <asp:TextBox ID="TextBox1" runat="server" Text='<% #Eval("LName") %>'></asp:TextBox>
                    </EditItemTemplate>
                    <ItemTemplate>
                        <asp:Label ID="Label1" runat="server" Text='<% #Eval("LName") %>'></asp:Label>
                    </ItemTemplate>
                </asp:TemplateField>
                <asp:TemplateField HeaderText="action">
                    <ItemTemplate>
                        <asp:LinkButton ID="LinkButton1" runat="server" CommandName="Edit">LinkButton</asp:LinkButton>
                    </ItemTemplate>
                    <EditItemTemplate>
                        <asp:LinkButton ID="LinkButton2" runat="server">Update</asp:LinkButton>
                    </EditItemTemplate>
                </asp:TemplateField>
            </Columns>
        </asp:GridView> 
```

在 CS 页面

```
protected void GridView1_RowUpdating(object sender, GridViewUpdateEventArgs e)
        {
            TextBox t1 = GridView1.Rows[e.RowIndex].FindControl("TextBox1") as TextBox;

            string s = t1.Text.ToString();
            Label3.Text = s;
} 
```

我尝试了几次，但我没有得到任何答案。我缺少什么可能的代码或代码中有任何错误。感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T18:59:14.037

您的 LinkBut​​ton 需要在 EditTemplate 中应用一个 CommandName：

```
<asp:LinkButton ID="LinkButton2" runat="server" CommandName="Update">Update</asp:LinkButton> 
```

# overriding - 在前端 Joomla 2.5 中显示菜单项“注释说明”

> ID：14059757
> 
> 赞同：0
> 
> 时间：2012-12-27T18:56:45.247
> 
> 标签：overriding, joomla2.5, menuitem

我正在使用 Joomla 2.5，每个菜单项都有一个“注释”字段，通常仅用作后端的描述，是否可以在我的网站前端显示该内容？最好是通过覆盖显示它...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T09:28:07.813

您可以使用菜单项 id 获取“注释”字段

```
$menuitemid = JRequest::getInt('Itemid');
$db     =& JFactory::getDBO();  
$query = "SELECT note FROM #__menu WHERE published = 1 and id = '".$menuitemid."' ";
$db->setQuery($query);
$note = $db->loadResult(); 
```

# deployment - 无法在使用 Fabric 的远程 Virtualenv 中使用 pip 安装软件包

> ID：14059758
> 
> 赞同：2
> 
> 时间：2012-12-27T18:56:49.613
> 
> 标签：deployment, virtualenv, fabric

我一直在使用fabric 来部署一个带有virtualenv 的应用程序。我上周使用的是 Fabric 1.4 并升级到了 1.5.1。我的脚本停止工作。

它无法安装要求。似乎它没有激活virtualenv。在我的代码中，我有：

```
with cd('%(path)s' % env):
        with prefix('source bin/activate'):
            run('pip install -U distribute') 
```

我收到权限被拒绝错误：`error: could not delete '/usr/local/lib/python2.7/dist-packages/pkg_resources.py': Permission denied`

正在执行的命令是：

```
Executed: /bin/bash -l -c "cd /var/www/myproject && source bin/activate && export PATH=\"\\$PATH:\\"/var/www/myproject\\" \" && pip install -U distribute" 
```

如果我 ssh 到远程机器并运行`cd /var/www/myproject && source bin/activate && pip install -U distribute`，它工作得很好。

为什么我的织物脚本不起作用？

提前致谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-31T15:48:13.377

Instead of the serial approach with..

```
source bin/activate
pip install -U distribute 
```

..directly use the pip executable of the virtualenv:

```
myenv/bin/pip install -U distribute 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-28T12:32:08.513

虽然不完全是一个解决方案，[但 fabtools](https://github.com/ronnix/fabtools)有许多与 virtualenvs 相关的功能，非常方便。他们（几乎）为您完成了所有艰苦的工作，并且可能值得用来检查它是否有其他问题。

```
# Cut (and modified) from the fabtools documentation
from fabric.api import *
from fabtools import require
import fabtools

@task
def setup():
    # Require a Python package
    with fabtools.python.virtualenv('/home/myuser/env'):
        require.python.package('pyramid') 
```

# javascript - 引用当前函数而不使用其名称/arguments.callee

> ID：14059759
> 
> 赞同：1
> 
> 时间：2012-12-27T18:56:51.630
> 
> 标签：javascript, closures

我已经做了相当多的研究，但还没有找到任何答案，这似乎是一个简单的问题：

我想将一个属性与一个函数相关联（用作此函数中的静态变量），如下所示：

```
function foo() {
    if (!foo.counter) {
        foo.counter = 1;
    }
    else {
        foo.counter++
    }
    // rest of the function code goes here...
} 
```

如果我稍后更改函数的名称，我不想在函数定义中更改对它的引用。那么，有没有办法引用当前正在执行的函数呢？（`arguments.callee`现在不推荐使用的除外）。一个像`thisFunction`?

如果没有，没有这样的东西的原因是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T19:08:56.777

我不知道 JavaScript 公开的标识符或关键字`thisFunction`（除了`arguments.callee`），但实现相同效果的一种方法是`foo`在闭包中命名函数，并`foo`从该闭包返回。这样，您始终可以使用`foo`内部名称`foo`来引用自身，而不管程序分配给什么变量：

```
var fn = (function() {
  function foo() {

     if (!foo.counter) {
        foo.counter = 1;
    }
    else {
        foo.counter++
    }
    // rest of the function code goes here...
  }

  return foo;
})(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T19:16:08.010

```
function foo() {
  if (typeof foo.counter=="undefined") {
    foo.counter = 1;
  }
  else {
    foo.counter++
  }
  return foo;
}

var x = new foo();
alert(x.counter);  //1
var y = new foo();
alert(x.counter); //2 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-28T04:54:08.137

如果您不需要在函数之外引用计数器，这将起作用。不是设置函数本身的变量，而是在函数外部定义一个变量，然后让函数修改它。每次调用时`makeFoo`，它都会创建一个新变量`x`并使用`x`. 每次调用返回的函数时，它仍然引用`x`由`makeFoo`. 此外，这完全封装了变量，确保返回函数之外几乎没有任何东西可以改变它（它肯定不会被返回函数之外的大多数东西改变，但是有足够的时髦的 javascript 反射我不能保证什么都不会改变它）。当然，在变量之间移动函数不会影响计数器（即`x=makeFoo();y=x;x=null;`）。

```
function makeFoo() {
  var x=0;
  return function () {
    x++;
    return x;
  }
}

//different counters
x=makeFoo();
y=makeFoo();
x();//returns 1
y();//returns 1
x();//returns 2
y();//returns 2

//same counter
x=makeFoo();
y=x;
x();//returns 1
y();//returns 2
x();//returns 3
y();//returns 4 
```

# r - 如何从回归分析中呈现拟合值和 CI

> ID：14059760
> 
> 赞同：0
> 
> 时间：2012-12-27T18:56:56.903
> 
> 标签：r, intervals

我在 R 中进行了回归分析并获得了拟合值及其置信区间。现在，我需要在报告中介绍它们。我想在同一个图中显示拟合值及其置信区间。有谁知道怎么做？或者，是否有人对以其他方式呈现拟合值和 CI 有更好的想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T18:12:11.890

您可能需要提供有关您的问题细节的更多信息，以便我们能够给出更全面的答案，但由于另一种查看置信区间的方法是错误栏，如何查看这个... [http://wiki .stdout.org/rcookbook/Graphs/Plotting%20means%20and%20error%20bars%20(ggplot2)/](http://wiki.stdout.org/rcookbook/Graphs/Plotting%20means%20and%20error%20bars%20(ggplot2)/)

或者

[http://docs.ggplot2.org/current/geom_errorbar.html](http://docs.ggplot2.org/current/geom_errorbar.html)

# ruby-on-rails - Rails has_one 不保存外键

> ID：14059766
> 
> 赞同：1
> 
> 时间：2012-12-27T18:57:35.203
> 
> 标签：ruby-on-rails, activerecord

我有以下表格

```
keyword
  keyword_id - PK
  description
  status_id - FK

keyword_status
  status_id - PK
  description 
```

尝试在 AR 中对它们进行建模，当尝试在我的测试中保存时，它不会将状态 ID 保存在关键字中。它们被映射为：

```
class Keyword < ActiveRecord::Base
  self.table_name = :keyword
  self.primary_key = :KEYWORD_ID  

  attr_writer :description
  attr_writer :keyword_status

  has_one :keyword_status, foreign_key: :STATUS_ID

end

class KeywordStatus < ActiveRecord::Base
  self.table_name = :keyword_status
  self.primary_key = :STATUS_ID
end 
```

以及它中断的代码（关键字状态由固定装置填充）

```
keyword = Keyword.new
keyword.description = "keyword#{n}"
keyword.keyword_status = KeywordStatus.first
keyword.save 
```

当`keyword.save`被调用时，我无法将 NULL 插入表关键字的“STATUS_ID”中

注意：我无法更改任何 DDL

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T19:01:34.080

你弄错方向了。它应该是关键字 belongs_to 状态。一般规则是具有外键列的模型属于另一个模型。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-27T19:57:10.130

正如 dstarh 所说，外键关联是倒退的。在您的模型中，您应该只需要：

```
class Keyword < ActiveRecord::Base
  has_one :keyword_status
end

class KeywordStatus < ActiveRecord::Base
  belongs_to :keyword, :foreign_key => "status_id"
end 
```

为协会工作。此外，`KeywordStatus`在创建关联对象之前使用固定装置设置对象有点奇怪，但如果这是您需要的行为，它将起作用。另外，为什么不直接使用外键`keyword_id`并让 Rails 为您处理呢？

如果要使用`keyword_id`而不是`status_id`用作外键，请更新：

表格将是这样的：

```
keyword
 id - PK
 description

keyword_status
 id - PK
 keyword_id - FK
 description 
```

还有你的模型：

```
class Keyword < ActiveRecord::Base
  has_one :keyword_status
end

class KeywordStatus < ActiveRecord::Base
  belongs_to :keyword
end 
```

希望这可以帮助！

更新 2：鉴于表不能更改关联必须有点倒退。我会推荐：

```
class Keyword < ActiveRecord::Base
  belongs_to :keyword_status
end

class KeywordStatus < ActiveRecord::Base
  has_many :keywords, :foreign_key => "status_id" 
end 
```

我使用了 a has many 作为关联，因为从上面所说的看来，一个关键字可以共享另一个关键字所具有的状态。这也意味着您必须执行以下操作：

```
KeywordStatus.first.keywords = KeywordStatus.first.keywords.push(keyword)
KeywordStatus.save 
```

代替：

```
keyword.keyword_status = KeywordStatus.first 
```

它的运行方向与您想要的相反。正如您所看到的，这可能会变得非常混乱，所以如果可能的话，我建议编写一个迁移来更改您的表（如果这是问题，可以对具有现有数据的表执行此操作）。我再次希望这会有所帮助！

# c# - 编辑 HTML 文件以 jQuery 样式操作 DOM

> ID：14059769
> 
> 赞同：3
> 
> 时间：2012-12-27T18:58:10.773
> 
> 标签：c#, java, javascript, jquery, html

我有一批 HTML 文件需要一些易于使用 jQuery 执行的版本（主要是选择一些节点并更改它们的属性）。

我实现这一点的方法是在 Google Chrome 中一一打开它们，在控制台中执行 jQuery 代码，然后将生成的 DOM 复制回我的 HTML 编辑器。

由于我目前正在做的事情需要很多时间，而且由于每个文件都需要相同的版本（即，相同的 jQuery/JS 代码适用于每个 HTML 文件），我正在考虑编写一个脚本/program 来做到这一点。

无论如何，我并不完全清楚我应该采取以下哪种（如果有的话）方法来完成这项任务。

1.  **使用一些文件系统/文件操作库（哪个？）使用 jQuery**编写 JavaScript脚本****

***   **使用一些基于 jQuery 的库（如[CsQuery](https://github.com/jamietre/CsQuery)）**编写 Java 或 C# 程序****

    ***   **为我的一些编辑器（Aptana、Notepad++、Eclipse 等）或支持类似 jQuery 的编辑命令的完全不同的编辑器（就像 notepad++ 正则表达式替换支持）**找到一个插件。**大批量时这会很慢，但至少它可以让我避免烦人的复制/粘贴到/从 Chrome。****** 

 ****其中一种方法是完成我需要的*正确方法吗？*（有没有*正确的方法*来做到这一点？）哪个应该更直接？

我认为#2 对我来说会更容易，因为我在 Java 和 C# 方面的经验比在 JavaScript 方面要多得多，但我认为这个想法可能有点像使用大锤来破解坚果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T19:12:15.390

您应该考虑使用[PhantomJs](http://phantomjs.org/)。它是一个可以从命令行执行的无头 WebKit。它接受一个[javascript 或coffeescript 文件](https://github.com/ariya/phantomjs/wiki/Examples)作为参数，可用于例如对网页执行某些操作。这是一个例子：

```
var page = require('webpage').create();
   page.open('http://m.bing.com', function(status) {
      var title = page.evaluate(function(s) {
         return document.querySelector(s).innerText;
      }, 'title');
      console.log(title);
      phantom.exit();
   }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T19:17:37.887

我不确定正确的方法，但听起来您对 C# 很熟悉，并且认为编写类库对于自动化来说开销最小。以下是一些潜在的解决方案：

1.  **脚本库（例如，C#.NET）** -如果您想使用 DOM 操作，您可以使用您提到的库或[ScriptSharp之类的库。](https://github.com/nikhilk/scriptsharp)如果 HTML 有适当的结束标记，您还可以使用 LINQ 轻松导航 HTML（或 CodePlex 上的 HTML Agility Pack 之类的东西）。我什至建议在 C# 中将 Mustache 与 HTML 文件模板一起使用。

2.  **JavaScript 库**- 如果您想继续使用纯 JavaScript，您可以使用 Node.js。您可以使用一些文件操作库。

3.  **无头浏览器**- 没有想过能够自动保存生成的 HTML，但您可以使用[jsTestDriver](http://code.google.com/p/js-test-driver/)或[Phantom.js 之类的东西](http://phantomjs.org/)

您也可以在编辑器中使用插件，但我会坚持使用 Java、C#、python 等库，您可以从现有应用程序中调用它们或将其安排为作业/服务。****

# spring - 多个 DispatcherServlets 相同的弹簧后端

> ID：14059771
> 
> 赞同：1
> 
> 时间：2012-12-27T18:58:11.157
> 
> 标签：spring, model-view-controller

我计划运行多个站点，所有站点都使用相同的 spring mvc 应用程序作为控制器/服务/dao 层。我认为我将尝试这样做的方式是设置 2 个 DispatcherServlet 映射到 web.xml 中的不同路径，然后我可以将站点的每个版本的不同配置放在 site1-servlet.xml 和 site2-servlet.xml .

经过一番尝试，我把它弄好并提供页面，最直接的问题是每个控制器方法都必须映射到 /site1 和 /site2。我不想将这些硬编码到控制器中，因为很快可能会有更多版本的站点。

第一个问题是我这样做是否正确？

其次，让请求映射到不同的 DispatcherServlet 的最佳方法是什么，希望基于主机：它们到达，就像 apache 中的 VirtualHost？

干杯! NFV

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T19:12:28.490

你在正确的轨道上。您可以做的一件事来帮助您处理请求映射是使用

```
<bean class="org.springframework.web.servlet.mvc.support.ControllerClassNameHandlerMapping"></bean> 
```

这样，您只需要使用 @RequestMapping 来注释方法，而不是使用路径。

URL最终会像

```
 http://mylocalhost:8080/site1/mycontroller/myMethod 
```

# shell - 在 ksh 中减去两个负数时出错：“赋值需要左值”

> ID：14059773
> 
> 赞同：0
> 
> 时间：2012-12-27T18:58:29.590
> 
> 标签：shell, unix, ksh

我正在尝试调试其他人的脚本：

代码行是：

```
y=$((${oldvalue[$x]}-${newvalue[$x]})) 
```

只要两边都是正数，y 就可以计算得很好。但是，我有一个生产情况，它们都是负面的，我得到的错误是：

```
DEBUG Old value = -4144290000
DEBUG New value = -4009685000
script.sh: line 123: -4144290000--4009685000: assignment requires lvalue 
```

即使是最简单的计算，我也不会使用`ksh`自己，但我处于生产支持的位置并且必须处理一大堆泥巴，我至少会使用 Perl/Python。谁能说出为什么会发生这个问题以及如何解决它？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T19:07:26.510

它需要在减号的两侧留出空间

```
y=$((${oldvalue[$x]} - ${newvalue[$x]})) 
```

# java - Java 位操作以删除（清零）不感兴趣的位

> ID：14059776
> 
> 赞同：-2
> 
> 时间：2012-12-27T18:58:45.220
> 
> 标签：java, bit-shift

例子

```
byte b = 127; 
```

（初始化为等于11111111）

现在我只关心位 1 和 0

我如何移位得到00000011

如果我是对的，我认为这被称为“屏蔽位”？

我尝试 b << 5 then b>> 5 将其他位归零，但这是错误的

我的目标

```
switch ((myByte >> 3) & 3)
{
    case 3:
        resevered = true;
        break;
    case 2:
        open = true;
        break;
    case 1:
        SingleOnly = true;
        break;
    case 0:
        daulMode = true;
        break;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-27T19:00:27.997

```
b & 0x03 
```

将为您提供一个包含前两位的字节，其余位为零填充。

这是有效的，因为 0x03 是`00000011`二进制的，并且

```
11111111 
```

和

```
00000011 
```

将前六位归零，只留下剩余的两位。

# javascript - 您可以在 Flash 实例之间传递 Camera 和 Microphone 对象吗？

> ID：14059780
> 
> 赞同：2
> 
> 时间：2012-12-27T18:58:59.853
> 
> 标签：javascript, flash, webcam, microphone

我正在开发一个 HTML5 应用程序，它需要与 Flash 交互以访问本地媒体（例如，网络摄像头和麦克风），并在远程浏览器之间传输音频视频。但在这个应用程序中，我需要将本地网络摄像头显示在屏幕的一部分上，并由远程网络摄像头显示中的各种 HTML 元素隔开。我很确定这意味着我需要运行多个 Flash 应用程序实例。但我认为您一次只能抓取一个网络摄像头实例，这意味着我需要能够在 Flash 实例之间共享这些网络摄像头和麦克风对象：一个显示本地网络摄像头，另一个与远程网络摄像头。有可能这样做吗？例如，

换句话说，我正在考虑有一个看起来像这样的 ActionScript 类（当然要简化很多）：

```
public class MediaController
{

    public function MediaController()
    {
        ExternalInterface.addCallback('getUserMedia', this.getUserMedia);
        ExternalInterface.addCallback('getCamera', this.getCamera);
        ExternalInterface.addCallback('setCamera', this.setCamera);
        ExternalInterface.addCallback('getMicrophone', this.getMicrophone);
        ExternalInterface.addCallback('setMicrophone', this.setMicrophone);
    }

    private var _mic:Microphone;
    private var _cam:Camera;

    public function getUserMedia()
    {
      _mic = Microphone.getMicrophone();
        _cam = Camera.getCamera();
    }

    public function getCamera():Camera
    {
        return this._cam;
    }

    public function setCamera(cam:Camera):void
    {
        this._cam = cam;
    }

    public function getMicrophone():Microphone
    {
        return this._mic;
    }

    public function setMicrophone(mic:Microphone):void
    {
        this._mic = mic;
    }
} 
```

我会像这样在 JavaScript 中检索它们：

```
var localUser = $('#localUser')[0];
localUser.getUserMedia();
var mic = localUser.getMicrophone();
var cam = localUser.getCamera(); 
```

然后将它们传递回实际与远程用户进行通信的实例，如下所示：

```
var remoteUser = $('#remoteUser')[0];
remoteUser.setMicrophone(mic);
remoteUser.setCamera(cam); 
```

这样做有什么已知的陷阱吗？有没有更好的方法来处理这个？（在你问之前，是的，在没有其他建议的情况下，我打算编写这个代码，我会让每个人都知道我发现了什么 - 只是想知道在我得到之前是否有任何已知的陷阱或替代方案开始了。:-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T19:11:57.373

您不能通过`Camera`和将对象传递`Microphone`给 Javascript `ExternalInterface`。当您使用`ExternalInterface`Javascript 进行通信时，您传递的任何数据都将被编组为 XML 格式。所以到那时，相机/麦克风不再是闪光灯`Camera`和`Microphone`物体。

您可能会发现在某些浏览器/操作系统中，尝试同时从两个单独的 SWF 访问同一个摄像头是可行的。但是，在其他情况下它失败了。我已经在两个完全不相关的网站访问相机时看到了这种行为。

[SWF 可以使用LocalConnection](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/net/LocalConnection.html)类相互通信，尽管我从未尝试过使用相机或麦克风进行类似的操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T21:30:25.577

对于它的价值，这是我最终采用的方法（或多或少），并且它有效。复杂，有点脆弱，但它有效：

```
// A typical 1:1 communication will involve four instances of the FlashMediaObject class:
// Instance1 (Initiator Sender): Displays local video, streams local video out to Instance4
// Instance2 (Initiator Receiver): Receives and displays video from Instance3
// Instance3 (Responder Sender): Displays local video, streams local video out to Instance2
// Instance4 (Responder Receiver): Receives and displays video from Instance1

// The workflow needs to go something like this:
// (1) Both: Room.onSessionAdded():     
//          SignalR makes both the JS clients for both the Initiator and the Responder aware of each other (i.e., their SessionId's).
// (2) Initiator: writeLocalMediaElement() -> fmo1.Connect():
//          Instance1 connects to Adobe's rtmfp service, gets its nearId, and passes it up to JS.
// (3) Responder: writeLocalMediaElement() -> fmo3.connect():
//          Instance3 connects to Adobe's rtmfp service, gets its peerId, and passes it up to JS.
// (4) Responder: prepareForCall() -> fmo4.connect():           
//          Instance4 connects to Adobe's rtmfp service, gets its peerId, and passes it up to JS.
// (5) Initiator: call() -> prepareForCall() -> fmo2.Connect():
//          Instance2 connects to Adbobe's rtmfp service, gets its nearId, and passes it up to JS.
// (6) Initiator: call() -> server.flashOffer():
//          The Initiator's JS controller contacts the Responder's JS (via SignalR), and passes it the two rtmfp ID's.
// (7) Responder: handleFlashOffer() -> fmo3.call():            
//          The Responder's JS controller passes the peerId for Instance2 (Initiator Receiver) to Instance3 (Responder Sender).
//          Instance3 begins publishing its video to Instance 2.
// (8) Responder: handleFlashOffer() -> fmo4.prepareForCall():
//          The Responder's JS controller passes the peerId for Instance1 (Initiator Sender) to Instance4 (Responder Receiver)
//          Instance4 prepares to receive a call from Instance1.
// (10) Responder: handleFlashOffer() -> server.flashAnswer():  
//          The Responder's JS controller contacts the Initiator's JS (via SignalR), and passes it the two peer ID's.
// (11) Initiator: handleFlashAnswer() -> fmo1.call():
//          The Initiator's JS controller passes the peerId for Instance4 (Responder Receiver) to Instance1 (Initiator Sender).
//          Instance1 connects to Instance4 and begins streaming video.
// (12) Initiator: handleFlashAnswer() -> fmo2.prepareForCall()
//          The Responder's JS controller passes the peerID for Instance3 (Responder Sender) to Instance2
//          Instance2 prepares to receive video from Instance3
// (9) Initiator: fmo2.onCall():
//          Instance2 begins playing video from Instance3.
// (13) Responder: fmo4.onCall():
//          Instance4 begins playing video from Instance1 
```

# hex - LESS mixin 用于颜色转换：HEX 到 BASE64

> ID：14059787
> 
> 赞同：0
> 
> 时间：2012-12-27T18:59:18.987
> 
> 标签：hex, base64, type-conversion, less, mixins

是否有一个LESS mixin 可以进行以下转换？

```
#371541 
```

到：

```
 data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/Pgo8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgdmlld0JveD0iMCAwIDEgMSIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSI+CiAgPGxpbmVhckdyYWRpZW50IGlkPSJncmFkLXVjZ2ctZ2VuZXJhdGVkIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeDE9IjAlIiB5MT0iMCUiIHgyPSIxMDAlIiB5Mj0iMCUiPgogICAgPHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iIzI5MTAzMyIgc3RvcC1vcGFjaXR5PSIxIi8+CiAgICA8c3RvcCBvZmZzZXQ9IjUwJSIgc3RvcC1jb2xvcj0iIzM3MTU0MSIgc3RvcC1vcGFjaXR5PSIxIi8+CiAgICA8c3RvcCBvZmZzZXQ9IjEwMCUiIHN0b3AtY29sb3I9IiMyOTEwMzMiIHN0b3Atb3BhY2l0eT0iMSIvPgogIDwvbGluZWFyR3JhZGllbnQ+CiAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEiIGhlaWdodD0iMSIgZmlsbD0idXJsKCNncmFkLXVjZ2ctZ2VuZXJhdGVkKSIgLz4KPC9zdmc+ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T20:36:03.340

## 简短回答：“不”（我不知道）

更长的答案是：

**首先**，为什么？直接颜色比将颜色变成由数据 uri 提供的图像要好得多。它的代码更少，我怀疑处理速度更快。

**其次**，如果你*必须拥有它*，那么你将......

*要么**（1）***需要自己做颜色转换mixin。您可以为您可能希望通过模式匹配转换的每种颜色手动执行此操作。就像是：

```
.convert64(#371541) {
   data:image/svg+xml;base64,...[your data string for 3711541]
}
.convert64(#371542) {
   data:image/svg+xml;base64,...[your data string for 3711542]
} 
```

您需要为可能要转换的每个十六进制颜色设置匹配项，并有一个预配置的数据字符串要输出。***当然，这毫无意义，除非您只谈论少数数字。***

*或者**（2）***，做[某种类型的javascript解决方案来编码](https://stackoverflow.com/questions/3709391/node-js-base64-encode-a-downloaded-image-for-use-in-data-uri)，[LESS可以处理](http://lesscss.org/#-javascript-evaluation)。

# youtube-api - YouTube 分析：按哪个时区汇总的日期维度？

> ID：14059790
> 
> 赞同：3
> 
> 时间：2012-12-27T18:59:37.930
> 
> 标签：youtube-api

对于 YouTube Analytics API，有一个“天”维度可用于按天细分指标。

我的问题是

*   使用什么时区将数据聚合到“日”存储桶中？用户的时区或某些固定时区，如 PST。
*   这些每日汇总是否正确处理了夏令时？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-28T17:36:43.090

YouTube 分析（和 API）对所有报告使用太平洋时区 (PDT/PST)，无论频道或运行报告的用户如何。

它确实像您期望的那样处理夏令时。

# javascript - Backbone.js 应用程序偶尔触发请求 - 即只有一个应该触发时没有请求或有多个请求

> ID：14059793
> 
> 赞同：0
> 
> 时间：2012-12-27T18:59:51.060
> 
> 标签：javascript, rest, backbone.js, requirejs, underscore.js

我对 Backbone.js 比较陌生，但我认为直到现在我已经掌握了它。我有一个基本的联系人管理应用程序，但是每当我单击提交按钮以创建新联系人时，它有时根本不会发送`POST`请求，但有时 Backbone.js 会发送两个或更多`POST`请求，而我只是打算发送一。当我尝试通过发送`DELETE`请求来删除联系人时，也会发生类似的情况。这是我的堆栈：

**前端：**
JQuery
Underscore
Backbone
Require

**后端：**
Node
Express
Mongodb 和 Mongoose

我认为这是一个主干/前端问题，因为在阅读使用 Chrome 开发人员工具网络菜单发送的请求时，我看到那里有多个请求。以下是我认为是我的应用程序中的相关代码。如果你想看到更多，只是请求。我对这个问题感到很困惑，只能希望外面有人没有。谢谢！

**editContact.js：（**查看）

```
define([
  'jquery',
  'underscore',
  'backbone',
  'text!templates/editcontact.html',
  'models/contact'
], function($, _, Backbone, editContactTemplate, Contact){

  $.fn.serializeObject = function () {
    var o = {};
    var a = this.serializeArray();
    $.each(a, function () {
      if (o[this.name] !== undefined) {
        if (!o[this.name].push) {
          o[this.name] = [o[this.name]];
        }
        o[this.name].push(this.value || '');
      } else {
        o[this.name] = this.value || '';
      }
    });
    return o;
  };

  var EditContactView = Backbone.View.extend({
    el: '.contactview',
    render: function (options) {
      var that = this;
      if (options.id) {
        that.contact = new Contact({id: options.id});
        that.contact.fetch({
          success: function (contact) {
            var template = _.template(editContactTemplate, {contact: contact});
            that.$el.html(template);
          }
        });
      } else {
        var template = _.template(editContactTemplate, {contact: null});
        this.$el.html(template);
      }
    },
    events: {
      'submit .edit-contact-form': 'saveContact',
      'click .delete': 'deleteContact'
    },
    saveContact: function (ev) {
      var contactDetails = $(ev.currentTarget).serializeObject();
      var contact = new Contact();
      contact.save(contactDetails, {
        success: function (contact) {
          Backbone.history.navigate('contacts/' + contact.id, {trigger: true});
        }
      });
      return false;
    },
    deleteContact: function (ev) {
      this.contact.destroy({
        success: function () {
          $('.contactview').html('');
          Backbone.history.navigate('', {trigger: true});
        }
      });
      return false;
      }
  });

  return EditContactView;

}); 
```

**editContactTemplate.html：（**模板）

```
<form class="edit-contact-form">
  <legend><%= contact ? 'Edit' : 'Create' %> Contact</legend>
  <label>First Name</label>
  <input type="text" name="firstname" value="<%= contact ? contact.get('firstname') : '' %>">
  <label>Last Name</label>
  <input type="text" name="lastname" value="<%= contact ? contact.get('lastname') : '' %>">
  <label>Email</label>
  <input type="text" name="email" value="<%= contact ? contact.get('email') : '' %>">
  <label>Phone Number</label>
  <input type="text" name="phonenumber" value="<%= contact ? contact.get('phonenumber') : '' %>">
  <hr>
  <button type="submit" class="btn"><%= contact ? 'Save' : 'Create' %></button>
  <% if (contact) { %>
    <input type="hidden" name="id" value="<%= contact.id %>">
    <button type="button" class="btn btn-danger delete">Delete</button>
  <% }; %>
</form> 
```

**Contact.js：（**模型）

```
define([
  'jquery',
  'underscore',
  'backbone'
], function($, _, Backbone){

  var ContactModel = Backbone.Model.extend({
    urlRoot: '/contacts'
  });

  return ContactModel;
}); 
```

**Router.js**（路由器）

```
define([
  'jquery',
  'underscore',
  'backbone',
  'views/allcontacts',
  'views/editcontact',
  'views/contact'
], function($, _, Backbone, AllContactsView, EditContactView, ContactView){
  var AppRouter = Backbone.Router.extend({
    routes: {
    '': 'contacts',
    'newcontact': 'editContact',
    'edit/:id': 'editContact',
    'contacts/:id': 'viewContact'
    }
  });

  var initialize = function () {
    var router = new AppRouter();

    router.on('route:contacts', function() {
      var allContactsView = new AllContactsView();
      allContactsView.render();
    });
    router.on('route:editContact', function(id) {
      var allContactsView = new AllContactsView();
      allContactsView.render();
      var editContactView = new EditContactView();
      editContactView.render({id: id});
    });
    router.on('route:viewContact', function(id) {
      var allContactsView = new AllContactsView();
      allContactsView.render();
      var contactView = new ContactView();
      contactView.render({id: id});
    });

    Backbone.history.start();
  };

  return {
    initialize: initialize
  };
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T19:24:35.830

你在哪里实例化 EditContactView？您是否有可能使用相同的“el”实例化多个视图（因为这可以解释多个视图）？至于缺少的请求，您是否有时会在没有模型的情况下实例化 EditContactView？

如果没有更多信息，很难准确猜测可能出了什么问题，但这里有一个简单的调试思路：在模型上定义一个“fetch”方法，`debugger;`向其中添加一行，然后调用 Backbone fetch ( `Backbone.Model.prototype.fetch.apply(this, arguments);`)。这样您就可以使用 Firebug/Chrome 开发工具/等。每次获取模型时暂停并检查事物。

# ruby-on-rails - 未初始化的常量 Spree::ThemeSupport - Spree 1.3

> ID：14059794
> 
> 赞同：1
> 
> 时间：2012-12-27T18:59:54.567
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2, spree

我正在使用 Spree 1.3.0，我已经安装了 spree_products_tags 用于向产品添加标签，

```
srikanth@srikanth-laptop:~/projects/mystore$ rake spree_products_tags:install:migrations
rake aborted!
uninitialized constant Spree::ThemeSupport
/home/srikanth/.rvm/gems/ruby-1.9.3-p327/bundler/gems/spree_products_tags-b90636c337ff/lib/spree_products_tags_hooks.rb:1:in `<top (required)>'
/home/srikanth/.rvm/gems/ruby-1.9.3-p327/gems/polyglot-0.3.3/lib/polyglot.rb:63:in `require'
/home/srikanth/.rvm/gems/ruby-1.9.3-p327/gems/polyglot-0.3.3/lib/polyglot.rb:63:in `require'
/home/srikanth/.rvm/gems/ruby-1.9.3-p327/bundler/gems/spree_products_tags-b90636c337ff/lib/spree_products_tags.rb:2:in `<top (required)>'
/home/srikanth/.rvm/gems/ruby-1.9.3-p327/gems/bundler-1.2.3/lib/bundler/runtime.rb:68:in `require'
/home/srikanth/.rvm/gems/ruby-1.9.3-p327/gems/bundler-1.2.3/lib/bundler/runtime.rb:68:in `block (2 levels) in require'
/home/srikanth/.rvm/gems/ruby-1.9.3-p327/gems/bundler-1.2.3/lib/bundler/runtime.rb:66:in `each'
/home/srikanth/.rvm/gems/ruby-1.9.3-p327/gems/bundler-1.2.3/lib/bundler/runtime.rb:66:in `block in require'
/home/srikanth/.rvm/gems/ruby-1.9.3-p327/gems/bundler-1.2.3/lib/bundler/runtime.rb:55:in `each'
/home/srikanth/.rvm/gems/ruby-1.9.3-p327/gems/bundler-1.2.3/lib/bundler/runtime.rb:55:in `require'
/home/srikanth/.rvm/gems/ruby-1.9.3-p327/gems/bundler-1.2.3/lib/bundler.rb:128:in `require'
/home/srikanth/projects/mystore/config/application.rb:7:in `<top (required)>'
/home/srikanth/projects/mystore/Rakefile:5:in `require'
/home/srikanth/projects/mystore/Rakefile:5:in `<top (required)>'
/home/srikanth/.rvm/gems/ruby-1.9.3-p327/bin/ruby_noexec_wrapper:14:in `eval'
/home/srikanth/.rvm/gems/ruby-1.9.3-p327/bin/ruby_noexec_wrapper:14:in `<main>'
(See full trace by running task with --trace) 
```

我检查了 spree_products_tags 的代码，

```
class SpreeProductsTagsHooks < Spree::ThemeSupport::HookListener
  insert_after :admin_configurations_menu do
    "<%= configurations_menu_item(I18n.t('product_tags'), admin_product_tags_path, I18n.t('product_tags_desc')) %>"
  end

  insert_after :admin_configurations_sidebar_menu do
    %(<li<%== ' class="active"' if controller.controller_name == 'product_tags' %>><%= link_to t('product_tags'), admin_product_tags_path %></li>)
  end

  insert_after :admin_product_form_right, "admin/products/tag_fields"

  insert_after :products_list_item, "products/tag"
end 
```

一个。如何摆脱`Spree::ThemeSupport`并执行上述操作？
湾。是否有任何其他替代方法可以为狂欢添加标签？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-02T23:57:24.193

一个。问题是他们实际上确实摆脱了 ThemeSupport （我认为在 1.1 或 1.2 中），您需要使用[Deface](https://github.com/spree/deface)，问题是您使用的 gem 还没有升级到那个，您需要替换它`SpreeProductsTagsHooks`并且使用污损

编辑，这是我不久前更改的一个，由于某种原因，我在底部留下了旧的 ThemeSupport 注释，这对这个[https://github.com/romul/spree_user_groups/blob/ec2a169d96acf6cbcf731d24d518134e55598d29/app/overrides/add_user_groups_to_configuration_menu非常有用.rb](https://github.com/romul/spree_user_groups/blob/ec2a169d96acf6cbcf731d24d518134e55598d29/app/overrides/add_user_groups_to_configuration_menu.rb)

# sql-server - 如何使用 LIKE 关键字在 Perl 脚本中执行“选择”语句？

> ID：14059795
> 
> 赞同：-1
> 
> 时间：2012-12-27T18:59:57.860
> 
> 标签：sql-server, perl

```
#!/usr/bin/perl

use DBI;
$a="test";

$DSN = q/dbi:ODBC:SQLSERVER/;
$uid = q/ivr/;
$pwd = q/ivr/;

$DRIVER = "Freetds";
$dbh = DBI->connect($DSN,$uid,$pwd) or die "Coudn't Connect SQL";

$sql_query1 = "select top(1) * from winast_sms_template where sms_tmp_service_id =1 and sms_tmp_name like '\%$a'";

$sql_address = $dbh->prepare($sql_query1);
$sql_address->execute();

while ((@city_address)=$sql_address->fetchrow_array())
       {
       $b = $city_address[2];
       print $b;
       } 
```

每当我执行程序时，我都没有得到正确的输出并且代码成功执行

请帮我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T19:46:11.523

尝试这个：

```
$sql_query1 = "select top(1) * from winast_sms_template where sms_tmp_service_id =1 and sms_tmp_name like ?";

$sql_address = $dbh->prepare($sql_query1);
$sql_address->execute('%' . $a); 
```

# html - 隐藏 css @ min-width: 480px

> ID：14059801
> 
> 赞同：0
> 
> 时间：2012-12-27T19:00:41.167
> 
> 标签：html, css, media-queries

在我的个人网站[Nineballstudio 上](http://www.nineballstudio.com)，我遇到了主要标题文本的问题`min-width: 480px`。我发现这是因为我用来为 this 设置淡入动画的 animate.css 效果。

有没有办法`display:none`在`span`不影响`span`其他宽度的情况下做到这一点？我还尝试了以下方法：

```
@media only screen and (min-width: 480px){
    span {
        display: none !important;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T19:04:46.473

查看[http://www.w3.org/TR/css3-mediaqueries/](http://www.w3.org/TR/css3-mediaqueries/)第 4.1 节

您可以指定特定范围的屏幕宽度以应用样式，例如：

```
@media screen and (min-width: 400px) and (max-width: 700px) { … } 
```

# javascript - 使用 javascript 将 ID 分配给对象（只有一个）

> ID：14059803
> 
> 赞同：0
> 
> 时间：2012-12-27T19:00:52.423
> 
> 标签：javascript, element, tagname

出于某种原因，下面的代码不起作用。我需要它为**一个**对象分配一个 ID。我在下面做错了什么？

```
 var frame = document.getElementsByTagName("iframe").setAttribute("id","iframe"); 
```

我安装了一个 jQuery 库，如果它应该有用的话。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T19:02:24.157

假设您的目标是找到的第一个 iframe：

```
var frame = document.getElementsByTagName("iframe")[0];
frame.setAttribute("id","iframe"); 
```

您需要`[0]`索引的原因是`getElementsByTagName`它将返回具有该标签名称的所有元素的集合，即使只有一个。

而且，正如 ThiefMaster 所说，您也可以使用`frame.id = "iframe";`代替`setAttribute`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T19:05:02.800

由于您使用的是 jQuery，因此您可以使这变得更简单：

```
$('iframe').attr('id', 'iframe'); // or:
$('iframe').prop('id', 'iframe'); 
```

这会影响页面上的**所有** `<iframe>`元素，因此您最好只有一个。重复的 ID 是一件严肃的事情。他们打破了东西，你真的需要避免他们。您可以链接`.first()`或使用`iframe:first`选择器来确保您只定位第一个元素。

* * *

这是无 jQuery 的解决方案，也只是第一个`<iframe>`：

```
var frame = document.getElementsByTagName("iframe")[0];
frame.id = 'iframe'; 
```

第 1 行：您实际上`iframe`想要`frame`.
第 2 行：ID 可作为*属性*使用，因此您可以`.id`使用`setAttribute`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T19:06:50.363

试试这个。

```
 <script>
var frame = document.getElementsByTagName("iframe")[0].id="iframe1";  
 alert(document.getElementById("iframe1").name);
 </script> 
```

# c# - 如何获取 HTTP Web 请求以返回完整源

> ID：14059804
> 
> 赞同：3
> 
> 时间：2012-12-27T19:00:56.847
> 
> 标签：c#, .net, httpwebrequest, httpwebresponse

我正在尝试检索网页的源代码，并且我正在使用 HTTPWebRequest 但仅返回以下内容：

```
<script type="text/javascript"> 
    window.location="index.php"; 
</script> 
```

我使用 fiddler 来比较 chrome 获取网页并将其与我的代码检索的内容进行比较。

左边是 Chrome，右边是 VS 代码

[http://i.stack.imgur.com/Hgk9w.png](http://i.stack.imgur.com/Hgk9w.png)

我注意到的是，内容长度没有 chrome 返回的那么大。我的代码内容长度通常在 70 位左右，而 chrome 通常会返回 87000 位。

我尝试过使用流和内存流。有人可以指出我正确的方向吗？

下面是我的功能：

```
public string GetAllCampaings()
{
    string campaigns = null;
    byte[] result;
    byte[] buffer = new byte[4096];

    HttpWebRequest httpWebRequest2 = (HttpWebRequest)WebRequest.Create("http://magiclampmarketing.com/sms/manage_groups.php");
    httpWebRequest2.Accept = "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8";
    httpWebRequest2.Method = "GET";
    httpWebRequest2.CookieContainer = cookieContainer;
    httpWebRequest2.KeepAlive = true;
    httpWebRequest2.UserAgent = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.97 Safari/537.11";
    httpWebRequest2.Referer = "http://magiclampmarketing.com/sms/main.php";
    httpWebRequest2.SendChunked = false;

    WebHeaderCollection myWebHeaderCollection = httpWebRequest2.Headers;
    myWebHeaderCollection.Add("Accept-Language", "en;q=0.8");
    myWebHeaderCollection.Add("Accept-Charset", "ISO-8859-1,utf-8;q=0.7,*;q=0.3");
    myWebHeaderCollection.Add("Accept-Encoding", "gzip,deflate,sdch");

    var sp = httpWebRequest2.ServicePoint;
    var prop = sp.GetType().GetProperty("HttpBehaviour", BindingFlags.Instance | BindingFlags.NonPublic);
    prop.SetValue(sp, (byte)0, null);

    using (WebResponse response = httpWebRequest2.GetResponse())
    {
        using (Stream responseStream = response.GetResponseStream())
        {
            using (MemoryStream memoryStream = new MemoryStream())
            {
                int count = 0;
                do
                {
                    count = responseStream.Read(buffer, 0, count);
                    memoryStream.Write(buffer, 0, count);

                } while (count != 0);

                result = memoryStream.ToArray();
            }
        }
    }

    return campaigns; 
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T19:13:04.730

看起来您正在使用的 chrome 浏览器已经登录到该站点并具有会话 cookie。但是，您的代码并未突出显示您如何传递会话 cookie。

从所看到的情况来看，您的程序的请求似乎正在返回一个将您重定向到登录页面的响应。

您要么必须澄清您对传递会话 cookie 的看法。或者接受你的程序正在做它应该做的事情。

# java - 在 Android 的 AlertDialog 中按下 OK 时返回 MainActivity

> ID：14059810
> 
> 赞同：3
> 
> 时间：2012-12-27T19:01:28.343
> 
> 标签：java, android, android-intent, android-alertdialog

我正在使用此警报对话框弹出一条消息，指出没有可用的活动互联网连接。

当用户单击确定时，我想回到 MainActivity，但我似乎无法做到这一点。

```
package com.xx.xx.xxhelper;

import android.app.AlertDialog;
import android.content.Context;
import android.content.DialogInterface;

public class AlertDialogManager {

public void showAlertDialog(Context context, String title, String message,
        Boolean status) {
    AlertDialog alertDialog = new AlertDialog.Builder(context).create();

    // Setting Dialog Title
    alertDialog.setTitle(title);

    // Setting Dialog Message
    alertDialog.setMessage(message);

    if(status != null)
        // Setting alert dialog icon
        alertDialog.setIcon((status) ? R.drawable.success : R.drawable.fail);

    // Setting OK Button
    alertDialog.setButton("OK", new DialogInterface.OnClickListener() {

        public void onClick(DialogInterface dialog, int which) {
    }

    });

    // Showing Alert Message
    alertDialog.show();
}
} 
```

我添加了

```
public void onClick(DialogInterface dialog, int which) {
Intent intent = new Intent(AlertDialogManager.this, HomeActivity.class);
intent.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP)    
startActivity(intent);
}
}); 
```

但我得到：

1.  构造函数 Intent(AlertDialogManager, Class) 未定义
2.  未为类型 new DialogInterface.OnClickListener(){} 定义方法 startActivity(Intent)

任何线索？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T19:04:47.747

使用如下内容传入`Activity`上下文（在`OK`单击警报对话框时启动活动）：

```
public void onClick(DialogInterface dialog, int which) {
    Intent intent = new Intent(context, HomeActivity.class);
    intent.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
        context.startActivity(intent);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T19:05:55.627

您应该使用传递的上下文：

```
 public void onClick(DialogInterface dialog, int which) {
      Intent intent = new Intent(context, HomeActivity.class);
      intent.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);    
      context.startActivity(intent);
    }
 }); 
```

# jquery - 全日历和时区

> ID：14059814
> 
> 赞同：4
> 
> 时间：2012-12-27T19:01:35.020
> 
> 标签：jquery, timezone, fullcalendar

我正在使用 Fullcalendar 1.5.3 和 JQuery 1.7.2 - 在我的本地时区，数据显示完美，但在其他时区，由于与时区本地时间的时差，我假设它间歇性地工作。

我从一个文件中获取一个 JSON 提要，日期作为 Ymd 存储在 MySQL 中。

我已经阅读了 ignoreTimezone 并在 fullcalendar.js 和页面上对日历对象的调用中将其设置为 false 和 true，但它没有任何区别。ignoreTimezone 的文档提到了在 ISO8601 日期上工作，而我的日期不是。

在下面的具体示例中，美国西海岸的一个客户看到圣诞节显示为 12 月 24 日 - 我已经从客户那里得到确认，他们使用了多个浏览器和机器，而且我遇到了多个客户的问题，所以听起来就像它没有本地化到一台客户端机器等一样。

这是代码：

```
<script>
$(document).ready(function() {
$('#calendar').fullCalendar({
    header: {
        left: 'prev,next today',
        center: 'title',
        right: 'month,agendaWeek,agendaDay'
    },
    ignoreTimezone: false,
    titleFormat: {
        month: 'MMMM yyyy',
        week: "MMM d[ yyyy]{ '&#8212;'[ MMM] d yyyy}",
        day: 'dddd, MMM d, yyyy'
    },
    columnFormat: {
        month: 'ddd',
        week: 'ddd d/M',
        day: 'dddd d/M'
    },
    timeFormat: { // for event elements
        '': 'H(:mm)t' // default
    },      
    eventSources: [
    'public_holidays_feed.php'
]
})
});
</script> 
```

我的 JSON 提要的片段显示：

```
[
{"id":"1","title":"New Year's Day (USA)","start":"2012-01-02","end":"2012-01-02","backgroundColor":"#000000","allDay":true},
{"id":"2","title":"New Year's Day (UK)","start":"2012-01-02","end":"2012-01-02","backgroundColor":"#000000","allDay":true},
{"id":"3","title":"Birthday of Martin Luther King, Jr. (USA)","start":"2012-01-16","end":"2012-01-16","backgroundColor":"#000000","allDay":true},
{"id":"4","title":"Washington's Birthday (USA)","start":"2012-02-20","end":"2012-02-20","backgroundColor":"#000000","allDay":true},
{"id":"5","title":"Good Friday (UK)","start":"2012-04-06","end":"2012-04-06","backgroundColor":"#000000","allDay":true}
] 
```

我怎样才能让上面忽略本地时区而只使用服务器时区，所以如果 MySQL 中的日期显示 2012-12-25 那么这就是每个人都应该看到的，无论他们在哪里？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-18T07:13:58.327

您好，我对这个问题有很多问题，请确保您的 json 提要已满：

IE：

```
[{"id":"190","allDay":false,"editable":true,"title":"Sam Shift","start":"2013-07-14 18:00:00","end":"2013-07-15 02:00:00"}] 
```

我知道在文档中“allDay”默认为 false，但如果不是全天，请标记它，当然还要标记开始时间和结束时间。

如果您的活动是全天的，请务必标记它。

希望它会奏效。

** 当然可以随意放置日期和时间，与时区无关，每个客户端都会在您发送的日期字符串中看到事件。

# jquery - 如何在选定的下方添加右侧？

> ID：14059816
> 
> 赞同：0
> 
> 时间：2012-12-27T19:01:52.080
> 
> 标签：jquery

我有一张桌子，想在我用鼠标单击的行下方添加一个加载的 ajax。但是我不知道如何获取索引，而是将其附加到末尾。

例如，单击“hol”，该行应插入“hol”行下方。

请看[--> 小提琴 <--](http://jsfiddle.net/houmie/33b3M/1/)

```
<table id="tab_open_deals" class="table table-condensed table-striped cb_table-hover">
  <thead>
    <tr>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody id="search_result">
    <tr>
      <td>Lunch Deal- Light</td>
      <td>39.90</td>
      <td>29 Dec 2012</td>
    </tr>
  <tr>
    <td>hol</td>
    <td>1499.00</td>
    <td>8 Jan 2013</td>
  </tr>
 </tbody>
</table>

$(document).ready(function() {
    $('#tab_open_deals tbody tr').off('click').on('click', function() {
        var row = $('<tr/>');
        $(row).load('/echo/html/', {
            html: '<td class="override" colspan="4"><table class="table-striped sub_table-hover"><thead><tr><th>Sub1</th><th>Sub2</th></tr></thead><tbody><tr><td>1</td><td>2</td></tr><tr><td>3</td><td>4</td></tr></tbody></table></td>'
        });

        $(this).parent().append(row);
    });
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T19:03:03.863

您不需要索引，只需获取对单击的引用`tr`（[`closest`](http://api.jquery.com/closest)对此有好处）并使用[`after`](http://api.jquery.com/after/)：

```
$('#tab_open_deals tbody tr').off('click').on('click', function() {
    var row = $('<tr/>');
    $(row).load('/echo/html/', {
        html: '<td class="override" colspan="4"><table class="table-striped sub_table-hover"><thead><tr><th>Sub1</th><th>Sub2</th></tr></thead><tbody><tr><td>1</td><td>2</td></tr><tr><td>3</td><td>4</td></tr></tbody></table></td>'
    });

    $(this).closest("tr").after(row);
}); 
```

但是您挂钩事件的方式不会挂钩您添加的任何新行。您可能会考虑[`delegate`](http://api.jquery.com/delegate)，这是用于进行*事件委托*（您也可以[`on`](http://api.jquery.com/on)在较新版本的 jQuery 中使用超重载函数进行事件委托）。

这是一个简化的示例：

```
$("#theTable tbody").delegate("tr", "click", function() {
  var row = $("<tr><td></td></tr>");

  row.find("td").text("New row at " + new Date());

  $(this).after(row);
}); 
```

[实例](http://jsbin.com/ukezew/1)| [来源](http://jsbin.com/ukezew/1/edit)

或者，如果您愿意`on`，请`delegate`更改

```
$("#theTable tbody").delegate("tr", "click", function() { 
```

到

```
$("#theTable tbody").on("click", "tr", function() { 
```

（请注意，参数的顺序发生了变化。）[Live Example](http://jsbin.com/ukezew/2) | [来源](http://jsbin.com/ukezew/2/edit)

* * *

旁注：

*   不过，您可能希望等到内容加载完毕，在[`load`](http://api.jquery.com/load)回调触发之前不要将其放入 DOM 中。

*   您将 HTML 片段发送*到*`load`服务器似乎很奇怪（如果它不是函数，那就是第二个参数的作用）。但是考虑到您要发送到的 URL 的名称，我假设它是正确的。:-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T19:04:10.953

在您的函数的上下文中`id`， 或 索引是无关紧要的；只需使用对当前单击的引用`tr`：

```
row.insertAfter($(this)); 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/33b3M/2/)。

顺便说一句，`row`它*已经*是一个 jQuery 对象（因为您使用：创建它`row = $('<tr />')`），所以您不需要在下一行将它包装在一个 jQuery 对象中`$(row).load(/*...*/)`，只需使用：`row.load(/*...*/)`。

参考：

*   [`insertAfter()`](http://api.jquery.com/insertAfter/).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T19:04:03.997

您正在寻找的是`after()`. 就像`append()`，但对于兄弟姐妹。

[http://api.jquery.com/after/](http://api.jquery.com/after/)

# c# - 添加到 LinkedList 后的 LinkedListNode 未设置下一个和上一个字段

> ID：14059818
> 
> 赞同：0
> 
> 时间：2012-12-27T19:01:57.480
> 
> 标签：c#

我是 C# 新手，正在尝试使用`LinkedList<T>`

```
class News {
    private int Id { get; set; }
    private string Name { get; set; }

    public News (int id, string name) {
        Id = id;
        Name = name;
    }

    public string getName() {
        return Name;
    }
}

class Program {
    static void Main(string[] args) {
        var newsList = new LinkedList<LinkedListNode<News>>();

        newsList.AddLast(new LinkedListNode<News>(new News(1,"News first")));
        newsList.AddLast(new LinkedListNode<News>(new News(2, "News second")));
        newsList.AddLast(new LinkedListNode<News>(new News(3, "News third")));
    }
} 
```

一旦上面的代码运行，我最终会`newsList`包含 3 个节点， where`node.Previous`和`node.Next`are both `null`。我究竟做错了什么？

==========================================我的实际代码====== ====================

```
public ActionResult NewsDetail(int id = 0)
        {

            var an = db.News
                .Select(n => new NewsView
                {
                    Id = n.Id,
                    Name = n.Name,
                    Description = n.Description,
                    IsTop = n.IsTop,
                    IsDraft = n.IsDraft,
                    Content = n.Content,
                    CaruselContentType = n.CaruselContentType,
                    CaruselFileContent = n.CaruselFileContent,
                    CaruselFileName = n.CaruselFileName,
                    CaruselFileSize = n.CaruselFileSize,

                    NewsPartViews = n.NewsParts
                    .Select(
                       np => new NewsPartView
                       {
                           Id = np.Id,
                           SortNumber = np.SortNumber,
                           IsDraft = np.IsDraft,
                           Content = np.Content,
                           NewsId = np.NewsId,
                           NewsPartImagesPosition = np.NewsPartImagesPosition,
                           ImagesCols = np.ImagesCols,
                           ImagesWidth = np.ImagesWidth,
                           ImagesHeight = np.ImagesHeight,
                           ImagesBorder = np.ImagesBorder,
                           ImagesClickEnlarge = np.ImagesClickEnlarge,
                           NewsPartImageViews = np.NewsPartImages
                           .Select(
                           npi => new NewsPartImageView
                           {
                               Id = npi.Id
                           }
                           )
                       }
                    )
                });

            var newslList = new LinkedList<NewsView>(an);

            return View(newslList.Find(newslList.First(view => view.Id == id)));
        } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-27T19:18:44.293

你不应该有一个`LinkedList<LinkedListNode<News>>`. 您应该使用`LinkedList<News>`. 将`LinkedList`隐式地将每个元素包装在它自己的`LinkedListNode`. 发生在你身上的是一堆`LinkedListNode<LinkedListNode<News>>`对象，外部节点的/`Next`都`Previous`设置得当，但你的内部节点都有/属性。`null``Next``Previous`

这是创建`LinkedList`.

```
var newsList = new LinkedList<News>();

newsList.AddLast(new News(1,"News first"));
newsList.AddLast(new News(2, "News second"));
newsList.AddLast(new News(3, "News third")); 
```

另请注意，这`LinkedList`通常不是最好的数据结构；它很少比另一种类型的集合更可取。可能你最好使用 a `List`, `Stack`, a `Queue`，这取决于你用它做什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T19:14:39.303

使用链表时，类型 T 不需要是所需类型的 LinkedListNode。您可以直接使用所需的类型。

```
 var newsList = new LinkedList<News>();

 newsList.AddLast(new LinkedListNode<News>(new News(1, "News first")));
 newsList.AddLast(new LinkedListNode<News>(new News(2, "News second")));
 newsList.AddLast(new LinkedListNode<News>(new News(3, "News third"))); 
```

这将以您想要的方式设置您的链接列表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-27T19:20:06.967

如果您尝试将所有三个项目添加到列表中，请使用它，

```
var newsItems = new News[]  {
           new News(1,"News first"), 
           new News(2, "News second"), 
           new News(3, "News third")};

var newsList = new LinkedList<News>(newsItems); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-27T19:12:11.237

在我看来，您的 LinkedListNode 对象每个只有一项；根据 MSDN 文档，

LinkedListNode.Previous 属性：对 LinkedList 中前一个节点的引用，如果当前节点是 LinkedList 的第一个元素 (First)，则为**null 。**

LinkedListNode.Next 属性：对 LinkedList 中下一个节点的引用，如果当前节点是 LinkedList 的最后一个元素 (Last)，则为**null 。**

如果只有一个元素，则它既是第一个元素也是最后一个元素 - 因此这两种方法都会得到 NULL 结果。

# drupal - Drupal - 节点删除按钮和节点到期日期

> ID：14059821
> 
> 赞同：1
> 
> 时间：2012-12-27T19:02:15.920
> 
> 标签：drupal, drupal-7, drupal-nodes

在 Drupal 7 中，当用户登录并查看他们自己的节点，或者管理员正在查看任何节点时，我希望出现 2 个按钮：

1.  删除节点
2.  更新节点

按下删除时，设置状态然后保存。当按下续订时，到期日期再延长 30 天。

任何关于如何开始的建议都非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T05:45:17.617

使用此[http://drupal.org/project/auto_expire](http://drupal.org/project/auto_expire)或[http://drupal.org/project/scheduler](http://drupal.org/project/scheduler)模块进行节点更新选项，希望对您有所帮助！！！。

# jquery-ui - 什么是 jQuery UI Autocomplete 在 AppEngine 上返回非本地结果的简单示例

> ID：14059823
> 
> 赞同：1
> 
> 时间：2012-12-27T19:02:23.050
> 
> 标签：jquery-ui, google-app-engine, autocomplete, jquery-ui-autocomplete

我正在尝试实现一个托管在 Google AppEngine (GAE) 上的 jQuery 自动完成搜索栏。我看到一些帖子表明如果我想使用远程源，我必须自己过滤结果。如果我将脚本中的列表存储为数组，如果过滤正确，那么我也尝试将从 GAE 返回的大型服务器端 JSON 数组转换为本地客户端数组，以避免需要手动过滤。两种尝试都没有奏效。

获得过滤的非本地结果的最简单方法是什么（对于 jQuery/.js 初学者）？

这是我尝试使用 jQueryui 文档中提供的正则表达式示例，以及在 SO 上发布的其他示例。如果我在搜索栏中输入“c”，我的下拉列表只会显示并返回字母 c。

GAE .py 代码：

```
class Search(webapp2.RequestHandler):
    def get(self):
        data = ["chickenpox", "chlamydia", "cholera" ]
        tags = json.dumps(data)
        self.response.out.write(tags) 
```

模板代码：

注意：`'/search'`指向返回 json 数据的 GAE 服务器处理程序。

```
<script>
var availableTags = '/search';

$(function() {                          
$( "#autocomplete" ).autocomplete({
    source: function( request, response ) {
            var matcher = new RegExp( "^" + $.ui.autocomplete.escapeRegex( request.term ), "i" );
            response( $.grep( availableTags, function( item ){
                return matcher.test( item );
            }) );
        },  
    minLength: 1,
     select: function( event, ui ) {
                $("#user_input").html('Selected: '+ ui.item.value);
                var entry = ui.item.value;
            }
        });
});
</script> 
```

下面是我尝试转换`availableTags`为本地数组，以便自动完成过滤结果本身。这种黑客/解决方法甚至可能吗？如果不是为什么不呢？

```
var availableTags = '/search';
var new_local_array = $.parseJSON(availableTags); 
```

我应该尝试哪种方法以及如何尝试？谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-27T19:46:28.997

在您的代码中，`availableTags`只包含一个字符串 ( `"/search"`)。您实际上并没有发出 AJAX 请求来取回数据。

如果您不想在服务器上进行过滤，我建议您发出 AJAX 请求来检索信息，然后使用该数据配置自动完成小部件：

```
$.getJSON('/search', function (data) {
    $("#autocomplete").autocomplete({
        source: data,
        minLength: 1,
        select: function (event, ui) { ... }
    });
}); 
```

基本上我们在这里所做的是向服务器询问可能匹配的数组。当我们得到那个数组时，我们用它初始化自动完成小部件。这将允许小部件为我们完成所有过滤。

# javascript - Bootstrap 预输入更新程序选项

> ID：14059824
> 
> 赞同：1
> 
> 时间：2012-12-27T19:02:31.420
> 
> 标签：javascript, twitter-bootstrap

我正在尝试使用 Twitter Bootstrap 的 typeahead javascript 的更新程序选项来检索同一行的多个值，然后在输入框的同一选定行上显示一列，在另一列上显示另一列。不幸的是，我似乎无法找出下面的代码如何无法更新具有 id 的输入框`ProductName`。

```
$('#ProductName').typeahead({
                source: function(query,process){
                    var query = {query:query};
                    return $.post('/products/ajax_search_product_by_name',query,function(data){
                        return process(data.options);
                    },"json");
                },
                minLength: 3,
                items: 50,
                updater: function(item){
                    lastIndex = item.lastIndexOf('-');
                    length = item.length;

                    var product_id;
                    var product_name;
                    product_id = item.substr(lastIndex + 1, length);
                    product_name = item.substr(0,lastIndex);
                    document.getElementById('ProductName').value = product_name;
                    console.log(product_name);
                } 
```

我在文档中读到该项目具有预先输入实例的范围：

```
The method used to return selected item. Accepts a single argument, the item and has the scope of the typeahead instance. 
```

所以我尝试`this`不使用 DOM 选择器，但它也不起作用。我也尝试了 jQuery 的方式，`$('#ProductName').val(product_name)`但没有运气。

我在这里错过了什么吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-04T16:06:49.950

你在这里遗漏了一些东西:) **updater**方法不应该将值设置到输入中，只是为了返回它。实际值设置是在调用**updater**方法后完成的。我相信，如果您以以下方式结束**更新程序**方法：

```
return product_name; 
```

它应该可以正常工作。

# svg - 如何在 SVG 中不缩放图像

> ID：14059826
> 
> 赞同：1
> 
> 时间：2012-12-27T19:02:51.423
> 
> 标签：svg

所以我在 SVG 中有一个图像，如下所示：

```
<image id="svgBackground" x="0px" y="0px" width="100%" height="100%" preserveAspectRatio="xMinYMin" xlink:href="backgrounds.png"/> 
```

我希望浏览器以原始大小显示图像。我怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-08-19T18:50:03.793

使用“px”单位指定图像的原始大小：`width="150px" height="100px"`或任何应有的大小。

如果您省略`width`和/或`height`完全省略，则默认为零并且不渲染图像。

# javascript - ExtJs MVC 在控制器中放置了一个按钮处理程序

> ID：14059834
> 
> 赞同：1
> 
> 时间：2012-12-27T19:03:20.790
> 
> 标签：javascript, extjs, extjs4, dom-events, extjs-mvc

ExtJs MVC 中是否有任何方法可以将按钮处理程序放入控制器中，如下所示：

```
this.control({
    'storage_settings button[action=submit_settings]': {
     handler: this.submit_settings_handler
  }) 
```

还是我必须使用其他东西，比如`click`事件？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-27T22:13:02.873

好吧，您的代码确实定义了要收听的按钮 ( `storage_settings button[action=submit_settings]`)，但没有定义要收听的事件（除非有一个名为 的事件`handler`，但没有）。

`handler`如果您不使用 MVC，您可以提供一个配置选项（因此处理程序将在视图代码中）。由于您使用的是 MVC，因此您应该收听该`click`事件。所以：

```
this.control({
    'storage_settings button[action=submit_settings]': {
         click: this.submit_settings_handler
}); 
```

这也应该有效：

```
this.control({
    'storage_settings button[action=submit_settings]': {
         click: function( aButton, aEvent, aOptions )
         {
         }
}); 
```

# php - 注意：未定义的索引：第 15 行 /home/timmycph/public_html/ItemDatabase/index.php 中的 p

> ID：14059835
> 
> 赞同：-2
> 
> 时间：2012-12-27T19:03:21.630
> 
> 标签：php

> **可能重复：**
> [PHP：“注意：未定义的变量”和“注意：未定义的索引”</a>](https://stackoverflow.com/questions/4261133/php-notice-undefined-variable-and-notice-undefined-index) [参考 - 这个错误在 PHP 中是什么意思？](https://stackoverflow.com/questions/12769982/reference-what-does-this-error-mean-in-php)

我正在创建一个项目数据库，但随后显示错误：

> 注意：未定义的索引：p in /home/timmycph/public_html/ItemDatabase/index.php on line 15 [http://timmycp.host.org/ItemDatabase/](http://timmycp.host.org/ItemDatabase/)

编码是：

```
 <html>
<head>
<body style="margin: 0 auto; text-align: center; padding: 50px; background: url(http://timmycp.co.cc/ItemDatabase/BG11.png) center top fixed no-repeat #1DABD8;">
<title>Club Penguin Item Database</title>
<link rel="stylesheet" href="style.css" type="text/css"/>
<center>
<body><center>
<table cellspacing="10">
<?php
$arr = json_decode(file_get_contents("http://media1.clubpenguin.com/play/en/web_service/game_configs/paper_items.json"),true);
$page = isset($_GET['p']) ? intval($_GET['p']) : 0;
$elementsPerPage = 10;
$elements = array_slice($arr, $page * $elementsPerPage, $elementsPerPage);
$totalpages = intval(count($arr)/$elementsPerPage);
if($_GET['p'] == ""){$_GET['p'] = '0';}
$whatpage = $_GET['p'];
if($whatpage > $totalpages){echo("<tr><td>Sorry this page does not exist. Please return to <a href='?p=0'>page 1</a>.</td></tr>"); exit;}
$link1 = $whatpage-1;
$link2 = $whatpage+1;
if($_GET['p'] == 0){$backbutton = "";} else {$backbutton = "<a href=?p=" . $link1 . ">Previous Page</a>";}
if($_GET['p'] == $totalpages){$nextbutton = "";} else {$nextbutton = "<a href=?p=" . $link2 . ">Next Page</a>";}
if($_GET['p'] == $totalpages or $_GET['p'] == 0){$middle = "";} else {$middle = " | ";}
$pagenav = $backbutton . $middle . $nextbutton;
echo('<tr><td colspan="7" align="center">'.$pagenav.'</td></tr>');
foreach($elements as $item)
{

$label = $item['label'];
$cost = $item['cost'];
$id = $item['paper_item_id'];
$member = $item['is_member'];
$type = $item ['type'];

if ($member == "1") {
$member = "Yes";
}else{
$member = "No";
}

if ($type == "1") {
$type = "Color";
}

if ($type == "7") {
$type = "Foot";
}

if ($type == "3") {
$type = "Face";
}

if ($type == "4") {
$type = "Neck";
}

if ($type == "5") {
$type = "Body";
}

if ($type == "6") {
$type = "Hand";
}

if ($type == "9") {
$type = "Background";
}

$str = '';
$str .= "<tr><td><embed src=\"http://www.timmycp.host.org/SWFViewer/items.swf?id=".$id."\"height='50' width='50' wmode='transparent'></td><td style='text-align: center !important;'><b>Name:</b> $label</td><td><b>Item ID:</b> $id</td><td><b>Members:</b> $member</td><td><b>Cost:</b> $cost coins</td><td><b>Type:</b> $type</td></tr>";

echo substr($str, 0, -5);
}
?></table></center></body></html> 
```

我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T19:07:07.880

将第 15 行的条件更改为

```
if ((isset($_GET['p'])) && $_GET['p'] == "") { 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T19:07:18.023

改变：

```
if($_GET['p'] == ""){$_GET['p'] = '0';} 
```

至

```
if(!isset($_GET['p']) || empty($_GET['p'])){
    $_GET['p'] = 0;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T19:05:28.060

`p`当数组中没有元素时会发生这种情况`$_GET`，因为尽管您费力地创建`$page`以涵盖这种情况，但无论如何您仍然继续使用`$_GET['p']`任何地方。

# ruby-on-rails - 在设计中执行“登录或注册”

> ID：14059837
> 
> 赞同：1
> 
> 时间：2012-12-27T19:03:30.033
> 
> 标签：ruby-on-rails, ruby, devise

如果数据库中不存在他输入的电子邮件，我想注册一个新用户。我有一个带有以下代码的自定义会话控制器：

```
resource = warden.authenticate!(:scope => resource_name, :recall => :failure)

scope = Devise::Mapping.find_scope!(resource_or_scope)
resource ||= resource_or_scope
sign_in(scope, resource) unless warden.user(scope) == resource 
```

如何指示 Devise 在“失败”方法中注册用户？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-28T00:19:54.970

我不断吸引用户尝试使用“注册”表单“登录”。它与设计选择有很大关系，但我真的很喜欢包罗万象的想法。

我只是找到了自己的解决方案。我不喜欢它，但它很简单（一旦我终于弄明白了）。我覆盖了[stackoverflow 上](https://stackoverflow.com/questions/3546289/override-devise-registrations-controller)`RegistrationsController`的详细信息。这是我在网站主页上的注册表，原因有几个，所以在那里做似乎很合适。

您需要创建`app/controllers/registrations_controller.rb`并将代码放在那里：

```
# app/controllers/registrations_controller.rb
class RegistrationsController < Devise::RegistrationsController
  def new
    super
  end

  def create
    # This is where the magic happens. We actually check the validity of the
    # username (an email in my case) and password manally.
    email = params[:user][:email]
    if user = User.find_by_email(email)
      if user.valid_password?(params[:user][:password])
        sign_in(user)
        redirect_to '/'
        return
      end
    end

    # Default devise stuff
    build_resource(sign_up_params)
    resource_saved = resource.save
    yield resource if block_given?
    if resource_saved
      if resource.active_for_authentication?
        set_flash_message :notice, :signed_up if is_flashing_format?
        sign_up(resource_name, resource)
        respond_with resource, location: after_sign_up_path_for(resource)
      else
        set_flash_message :notice, :"signed_up_but_#{resource.inactive_message}" if is_flashing_format?
        expire_data_after_sign_in!
        respond_with resource, location: after_inactive_sign_up_path_for(resource)
      end
    else
      clean_up_passwords resource
      @validatable = devise_mapping.validatable?
      if @validatable
        @minimum_password_length = resource_class.password_length.min
      end
      respond_with resource
    end
  end

  def update
    super
  end
end 
```

您**需要确保配置路由以使用此控制器**，如我在上面链接到的其他 SO 帖子中所述。

```
# app/config/routes.rb
devise_for :users, :controllers => {:registrations => "registrations"} 
```

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T19:37:38.290

[您可以使用 Devise](https://github.com/plataformatec/devise/wiki/How%20To%3a%20Email-only%20sign-up)遵循仅电子邮件注册方法。扩展它，您可以将失败方法发布到您已设置为仅处理电子邮件的注册控制器注册。

**更新：最简单的方法之一是覆盖响应，如此**[处](https://github.com/plataformatec/devise/wiki/How-To%3a-Redirect-to-a-specific-page-when-the-user-can-not-be-authenticated) 所示。除了你的情况，你可能想要这样的东西：

```
 def respond
   if http_auth?
     http_auth
   else
     user = User.create(..user information) #Create the user (register them)
     sign_in(user) # Sign in the user just created
     redirect  # Redirect to whatever page you want
   end
 end 
```

这样，您可以拥有一个电子邮件字段，并且当用户未通过身份验证（用户不存在，密码错误等）时，将创建用户。当然，对于您的情况，您可能希望在其中嵌套另一个`if`块以检查用户是否存在，这样您就不会仅仅因为密码错误等而尝试创建另一个用户。

希望这可以帮助！

# pentaho - 没有数据库的pentaho

> ID：14059843
> 
> 赞同：0
> 
> 时间：2012-12-27T19:03:46.413
> 
> 标签：pentaho

我正在寻找一种通过 applicationContext-spring-security-memory 对用户进行身份验证的 pentaho 方法。

我需要spring security只使用xml文件来进行身份验证而不是数据库。

我也在互联网上进行了研究，但找不到任何东西。

在一个简单的项目中，这样做并不复杂，但是pentaho的结构非常庞大，很多模块和xml相互连接。

任何链接或教程，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T09:57:17.863

我解决了。我在 wiki pentaho 中找到了答案：

[http://wiki.pentaho.com/display/ServerDoc2x/Changing+to+the+JDBC+Security+DAO](http://wiki.pentaho.com/display/ServerDoc2x/Changing+to+the+JDBC+Security+DAO)

虽然这是针对 jdbc 的，但我只需要对此进行调整：

```
<beans>
  <!-- some lines omitted -->
  <import resource="applicationContext-spring-security.xml" />
  <import resource="applicationContext-common-authorization.xml" />
  <import resource="applicationContext-pentaho-security-memory.xml" />
  <import resource="applicationContext-spring-security-memory.xml" />
</beans> 
```

# jquery - Jquery Validation + Globalization + 适用于所有数字字段，而不仅仅是所需的字段

> ID：14059848
> 
> 赞同：2
> 
> 时间：2012-12-27T19:04:25.920
> 
> 标签：jquery, jquery-validate, numbers, globalization

我正在尝试在 asp .net mvc3 中为印度构建一个应用程序。我使用 jQuery 全球化来验证印度格式的数字。

我的代码如下：

```
<script src="@Url.Content("~/Scripts/jquery.globalize/globalize.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.globalize/cultures/globalize.culture.hi-IN.js")" type="text/javascript"></script>
<script type="text/javascript">
    $.validator.methods.number = function (value, element) {
        return !isNaN(Globalize.parseFloat(value));
    }

    $(document).ready(function () {
        Globalize.culture('hi-IN');
    });
</script> 
```

这是基于以下SO问题：

[MVC 3 jQuery 验证/数字/十进制字段的全球化](https://stackoverflow.com/questions/5199835/mvc-3-jquery-validation-globalizing-of-number-decimal-field)

它完美地工作。但是，由于此代码，有 2 个新错误：

1) 我有两个输入字段 Area 和 SuperBuiltUpArea - Area 是必填字段，SuperBuiltUpArea 不是。jQuery 验证不允许我提交表单，因为它不接受 SuperBuiltUpArea 字段的 null(empty) 条目并抛出该字段应该是数字的错误。

***编辑：***此问题已通过将验证器语句替换为

```
this.optional(element) || !isNaN(Globalize.parseFloat(value)); 
```

2) 如果我在这些字段中输入字母，jQuery 验证不会启动。但是，它不允许我提交表格。但这非常令人困惑，因为表单没有显示错误但不会提交。

任何帮助将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-28T12:17:10.520

我总结了你在编辑评论中所说的话。

只需更换：

```
<script type="text/javascript">
    $.validator.methods.number = function (value, element) {
        return !isNaN(Globalize.parseFloat(value));
    }
</script> 
```

经过

```
<script type="text/javascript">
    $.validator.methods.number = function (value, element) {
        return this.optional(element) || !isNaN(Globalize.parseFloat(value));
    };
</script> 
```

# regex - 方法命名约定和 PMD

> ID：14059855
> 
> 赞同：1
> 
> 时间：2012-12-27T19:04:51.437
> 
> 标签：regex, rules, pmd, static-code-analysis

当我对我的代码运行 PMD 分析时，我收到以下消息：

```
Name `'END_METHOD'` must match pattern 

'^[a-z][a-zA-Z0-9]*$' 
```

`END_METHOD`是类型`private final`。它应该包括特殊字符吗？还是小写字符？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T19:06:54.747

该消息告诉您名称应以小写字符开头。

PMD 在这里强制执行的约定是，只有 static final 变量以所有大写字母命名，而方法的局部变量（无论是否为 final）使用[camel-case](http://en.wikipedia.org/wiki/CamelCase)。方法也使用驼峰式。

[ `a-z`] 表示一个小写字母字符。

`[a-zA-Z0-9]*`表示零个或多个字符，每个字符都可以是小写、大写或数字（没有特殊字符或下划线）。

正则表达式一起表示字符串应该以一个小写字符开头，后跟 0 个或多个字母数字字符。

# actionscript-3 - AS3：在 textField 中呈现纯文本

> ID：14059858
> 
> 赞同：0
> 
> 时间：2012-12-27T19:05:07.183
> 
> 标签：actionscript-3, apache-flex, actionscript, flex3, textfield

textField 的当前行为是将所有文本呈现为 HTML。有没有办法告诉系统这是纯文本，即使它看起来像 html？

在 AS2 中有一个`.html`属性，我可以将其设置为 false 以获得这种行为，它似乎已经消失了。

我很清楚我可以对输入进行 html 转义以获得所需的行为，但我正在寻找最干净/最简单的解决方案。（而且似乎我必须编写自己的 html-escape 函数......）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-27T19:20:22.067

AS3 文本字段有两个属性，`text`和`htmlText`. 该`text`属性可用于显示纯文本，即使它看起来像 html。这两个属性由 Flash 自动链接，因此编辑`text`将更新`htmlText`，反之亦然。

您应该能够使用该`text`属性来实现您的目标。不幸的是，如果您在文本字段中使用样式表，则这两个属性都将被视为 HTML。在这种情况下，您有两个选择。您可以使用简单的 TextFormat 对象在没有样式表的情况下执行样式设置，如果您的样式表不太复杂，这可能很简单。如果您确实需要使用样式表，您可以利用 AS3 的两个文本属性之间的链接来自动转义您的文本。

例如，如果你想更新一个名为`tf`，它使用样式表的文本字段，但你想要纯文本，你可以这样做：

```
var temp:TextField = new TextField();
temp.text = plainText;
tf.text = temp.htmlText; 
```

临时文本字段将自动生成转义 HTML，然后您可以在实际文本字段中使用它。

# linux - 如何开始使用 libsandbox

> ID：14059868
> 
> 赞同：2
> 
> 时间：2012-12-27T19:06:06.827
> 
> 标签：linux, sandbox

我正在尝试编写一个简单的判断程序来编译和执行用户提交的 c 文件。我在 stackoverflow 上找到 了[libsandbox](http://openjudge.net/~liuyu/Project/LibSandbox)和一个[问题](https://stackoverflow.com/questions/10861211/running-libsandbox)。

我已经安装了 python 模块，并且按照说明我正在尝试运行一个用 C 编写的 hello world 程序

```
➜  sandbox git:(V_0_3_x) ✗ ./hello                            
Hello World%                                                                   
➜  sandbox git:(V_0_3_x) ✗ python sample2.py hello   
result: RF
cpu: 2ms
mem: 288kB 
```

如您所见，当我在沙箱中运行程序时，我没有得到任何输出。如果有人能告诉我如何正确使用它，那就太好了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-14T23:45:51.483

示例代码`libsandbox`禁止对文件操作进行系统调用，例如`open()`, `stat()`, `close()`. 也就是说，您需要 (1)**静态****链接**hello world 程序以避免打开共享库 (ie ) 等文件，或者 (2) 编写允许相关系统调用的自定义沙箱策略。可以在[https://github.com/liuyu81/TR-OJA-201209A](https://github.com/liuyu81/TR-OJA-201209A)找到一些自定义沙盒策略的示例。**`libc.so`**

 **免责声明：我是`libsandbox`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-01-23T19:26:11.087

RF 结果代码很可能是由于文件操作的意外系统调用（即 SYS_open()、SYS_close()、SYS_stat()、...）。当（1）目标程序实际执行文件操作时，和（或）当（2）它被动态链接并需要在运行时加载 .so 库时，就会发生这种情况。由于你的目标程序不调用文件操作，所以属于后一种情况。

然后，要解决 RF 结果，要么，

静态链接目标程序，避免对共享库的依赖；或者，扩展包装脚本中的策略规则以处理相关的 SYSCALL / SYSRET 事件；

对于静态链接系统调用，我们使用 ex 0,1,2 3-sys_read 1-sys_exit 等的系统调用代码通过链接获取更多详细信息链接以获取系统调用列表的代码：[http://docs.cs.up。 ac.za/programming/asm/derick_tut/syscalls.html](http://docs.cs.up.ac.za/programming/asm/derick_tut/syscalls.html)

我改变这个：

```
x86_64=set([0,1,5,8,9,10,11,12,16,21,25,63,89,158,219,231]) 
```

为了这：

```
x86_64=set([0,1,2,3,4,5,8,9,10,11,12,16,21,25,63,89,158,219,231,]) 
```

在 sample2.py 中，它可以工作。

修改后的 sample2.py 可在我的 github 存储库链接中找到： [https ://github.com/palashmaran/libsandbox.git](https://github.com/palashmaran/libsandbox.git)**

# c++ - 在 Mac 上使用 C 或 C++ 进行 GUI 编程入门

> ID：14059878
> 
> 赞同：1
> 
> 时间：2012-12-27T19:06:45.203
> 
> 标签：c++, c, xcode, macos, user-interface

我在使用 xcode 的 mac 上使用 C 和 C++ 编程已经有一段时间了，但是，我不知道如何超越我一直在编写的简单文本输入/输出程序。我了解这些原则，但事实证明很难弄清楚这些原则。

我听说用于 C++ 的 qt 或 gtk+ 之类的库是最好的选择，但大多数书籍和教程都侧重于 Windows 或 linux 编程，并且没有一开始说明这些库是如何工作的。我想真正了解幕后发生的事情；我想了解 GUI 如何在尽可能低的级别上工作，即使在汇编和机器代码级别也是如此。有谁知道从哪里开始？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T19:35:04.563

如果您使用 OpenGL，您可以获得关于图形硬件如何工作的非常低级的知识，以便生成您想要的各种 UI 元素。当然，您必须自己完成所有这些工作。从设计各种 UI 项目，到创建像素缓冲区和纹理映射，再到使用帧缓冲区。这部分也是跨平台的。

您还可以自己处理用户交互和界面逻辑（轮询鼠标/键盘等）。编写更复杂的小部件可能需要一些时间，但至少您将自己完成所有工作，这将使您对 GUI 工具包的工作方式有相当多的了解。

GLUT 随大多数 Mac 一起提供，并为您提供入门的基本要素（您至少有一个窗口 :)）

[https://developer.apple.com/library/mac/#samplecode/glut/Introduction/Intro.html](https://developer.apple.com/library/mac/#samplecode/glut/Introduction/Intro.html)

GLUT 库支持以下功能：

1.  用于 OpenGL 渲染的多个窗口。
2.  回调驱动的事件处理。
3.  一个“空闲”例程和计时器。
4.  用于生成各种实体和线框对象的实用程序。
5.  支持位图和笔画字体。
6.  各种窗口管理功能。

[http://www.opengl.org/resources/libraries/glut/glut_downloads.php](http://www.opengl.org/resources/libraries/glut/glut_downloads.php)

# java - Android proguard，保持内部类

> ID：14059888
> 
> 赞同：68
> 
> 时间：2012-12-27T19:07:20.707
> 
> 标签：java, android, proguard

我的 android 程序有一个`class A`，它有两个`static inner class`. 发现它们`.dex`在应用 proguard 后被剥离。

```
public class A{

  ...
  static class B{
    ...
  }

  static class C{
    ...
  }
} 
```

我在 proguard.flags 中添加了以下几行，但似乎没有运气。

```
-keep class com.xxx.A
-keep class com.xxx.A$* 
```

有什么提示吗？

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2012-12-27T19:26:56.160

尝试添加`InnerClasses`到 keep 属性。例如：

```
-keepattributes Exceptions, InnerClasses, ... 
```

另外，尝试在“keep”调用中添加一个带有星号的主体，如下所示：

```
-keep class com.xxx.A$* {
    *;
} 
```

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2013-06-18T04:53:40.397

这是我必须为我的配置做的

```
-keep class com.xxx.A { *; }
-keep class com.xxx.A$B { *; }
-keep class com.xxx.A$C { *; } 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-06-23T02:07:11.217

这对我有用

```
-keepattributes InnerClasses
 -keep class com.yourpackage.YourClass**
 -keepclassmembers class com.yourpackage.YourClass** {
    *;
 } 
```

通配符可能有点矫枉过正，但我​​想确保我没有错过任何东西。主要的是你需要类的内部类属性和类的keepclassmembers。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2015-06-09T01:19:54.340

如果您不希望某个包中的所有内部类和成员都被混淆，您可以在 proguard-rules.pro 中添加行

```
 -keep class com.xxx.task.*$* {
        *;
    } 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-12-29T10:35:24.370

您的配置看起来正确。你应该仔细检查你没有拼错类名。如果拼写不正确，ProGuard 应该打印出关于它的注释。您还可以指定`-printseeds seeds.txt`, 并查看您的类是否列在结果文件中。如果它们被列出，则这些类也在处理后的代码中。

正如 Alexander Lucas 所提到的，您可能还希望保留这些类的字段和方法——这取决于您的要求。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-06-08T15:48:52.373

大多数最佳答案都可以完成这项工作，但他们使用通配符`(*;)`来添加所有不是准确答案的内容。下面的配置仅添加`fields`和`method`属性以保留内部类方法。

```
-keepattributes Exceptions,InnerClasses,Signature, ...

# preserve class and nested classes' fields and methods
-keep class com.abc.package.clazzes.** {
    <fields>;
    <methods>;
} 
```

# php - PHP：数组不保留值

> ID：14059894
> 
> 赞同：0
> 
> 时间：2012-12-27T19:07:57.077
> 
> 标签：php, arrays

这个片段的目标是循环一组描述资源的数组。然后循环一组字幕信息。如果它们匹配，则将该标题添加到该`resource_node`索引中。

第一个`echo print_r($resource);`具有“标题”索引键。

第二个`echo print_r($this->resource_nodes);`不显示标题键。

我不知道这个片段出了什么问题。

```
foreach ($this->resource_nodes as $resource) {
    foreach ($this->captions as $caption) {
        if ($resource['attachment id'] === $caption['id']) {
            $resource['caption'] = $caption['content'];
            echo print_r($resource);
        }
    }
}
echo print_r($this->resource_nodes); 
```

比较`echo`有效。所以我知道标题被分配给某个数组，并且除了循环执行后缺少标题之外，这些数组是相同的。

知道是什么原因造成的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T19:11:24.807

您的 $resource 变量是按值设置的，而不是按引用设置的。尝试：

```
foreach ($this->resource_nodes as &$resource) { 
```

注意'&'。

# javascript - 有开源的视觉反馈库吗？

> ID：14059897
> 
> 赞同：2
> 
> 时间：2012-12-27T19:08:03.233
> 
> 标签：javascript, html

> **可能重复：**
> [Javascript：让用户选择像 Firebug 这样的 HTML 元素？](https://stackoverflow.com/questions/2399797/javascript-let-user-select-an-html-element-like-firebug)

我想要一种简单的方法让人们发现我的网页上的错误，用鼠标标记元素并通过 POST 将其提交到另一个 URL。

要了解我的意思，请单击[http://usabilla.com/中的“帮助我们改进”](http://usabilla.com/)

# javascript - 如何制作一个按钮，使其只能拖动到一定程度？

> ID：14059900
> 
> 赞同：0
> 
> 时间：2012-12-27T19:08:09.277
> 
> 标签：javascript, asp.net, css

我想知道是否有可能做到这一点，当您将鼠标悬停在按钮上以将其向右或向左移动时，它仅移动了 200 像素。因此，一旦它移动了 200px，它就不能再移动 200px，但是一旦它移回原来的位置，它就可以再次移动 200px。

我有这个 javascript 代码

```
 <script type="text/javascript" language="javascript">
//<![CDATA[

// window.onload=function() {
//    document.getElementById("d2").onmouseover = slideIt("toRight");
//    document.getElementById("d3").onmouseover = slideIt("toLeft");
// };

function slideIt(actionReturn) {
    var slidingDiv = document.getElementById("d1");
    var stopPosition = 50;
    var startPosition = slidingDiv.offsetWidth+slidingDiv.offsetWidth;
    if (actionReturn ==  "toRight") {
        if (parseInt(slidingDiv.style.left) >= 0 )
        {
            slidingDiv.style.left = parseInt(slidingDiv.style.left) - 200 + "px";
            setTimeout(slideIt, 1);
        }
    }
    if (actionReturn ==  "toLeft") {
        if (parseInt(slidingDiv.style.left) < startPosition ) {
            slidingDiv.style.left = parseInt(slidingDiv.style.left) + 200 + "px";
            setTimeout(slideIt, 1);
        }
    }
}
//]]>
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T19:20:16.740

您需要定义三个标志（即三个变量）来跟踪运动；因此，您需要定义一个表示按钮位于其原始位置，一个表示按钮已向右移动，一个表示按钮已向左移动。这些变量将保存布尔值（真、假）。在每张幻灯片上，您都需要检查这些标志以指定是否会实际发生移位。

这是对您的代码的建议更新：

```
 <script type="text/javascript" language="javascript">

 var isInOriginalPosition = true;
 var isShiftedToRight = false;
 var isShiftedToLeft = false;

 function slideIt(actionReturn) {
    var slidingDiv = document.getElementById("d1");
    var stopPosition = 50;
    var startPosition = slidingDiv.offsetWidth+slidingDiv.offsetWidth;
    if (actionReturn ==  "toRight") {
        if (isShiftedToRight && !isInOriginalPosition)
        {
            return;
        }
        else if (isShiftedToLeft && !isInOriginalPosition)
        {
            slidingDiv.style.left = parseInt(slidingDiv.style.left) - 200 + "px";
            setTimeout(slideIt, 1);
            isShiftedToLeft = false;
            isInOriginalPosition = true;
        }
        else if (isInOriginalPosition)
        {
            slidingDiv.style.left = parseInt(slidingDiv.style.left) - 200 + "px";
            setTimeout(slideIt, 1);
            isShiftedToRight = true;
            isInOriginalPosition = false;
        }
    }
    if (actionReturn ==  "toLeft") {
        if (isShiftedToLeft && !isInOriginalPosition)
        {
            return;
        }
        else if (isShiftedToRight && !isInOriginalPosition)
        {
            slidingDiv.style.left = parseInt(slidingDiv.style.left) + 200 + "px";
            setTimeout(slideIt, 1);
            isShiftedToRight = false;
            isInOriginalPosition = true;
        }
        else if (isInOriginalPosition)
        {
            slidingDiv.style.left = parseInt(slidingDiv.style.left) + 200 + "px";
            setTimeout(slideIt, 1);
            isShiftedToLeft = true;
            isInOriginalPosition = false;
        }
    }
}
</script> 
```

# php - php mysql_fetch_array

> ID：14059901
> 
> 赞同：-5
> 
> 时间：2012-12-27T19:08:10.943
> 
> 标签：php, mysql

有人可以告诉我我在下面的代码中做错了什么吗？

另外，我想对结果进行分页。

```
$link = mysql_connect("localhost", "yvens47", "tij43gt") or die("unable to connect to database");
$data = mysql_select_db("phppractice", $link) or die("no such database");

$display = "SELECT * FROM phppractice(Name,Email,Phone)";

while($row = mysql_fetch_array($display)) {
    echo $row['name'];
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T19:15:08.633

您忘记运行不正确的查询

```
$sql = "SELECT Name,Email,Phone FROM phppractice";
$res = mysql_query($sql) or trigger_error(mysql_error());
while($row = mysql_fetch_array($res)) {
    echo $row['name'];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T19:11:45.043

查询本身无效。也许：

```
SELECT `Name`, `Email`, `Phone` from phppractice; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-27T19:12:41.140

好吧，一方面，您的 $display 语法是错误的。其次，您也永远不会执行该语句。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-27T19:13:16.700

这个查询没有意义：

```
SELECT * FROM phppractice(Name,Email,Phone) 
```

您是否只想选择名为姓名、电子邮件和电话的文件？如果是这样，请使用此

```
SELECT Name, Email, Phone FROM phppractice 
```

最重要的是，您永远不会实际调用`mysql_query()`. 所以qieru永远不会被处决。

另外，不要使用`mysql_*`函数。它们已被弃用（注意 PHP 手册文档中的大红色警告？）。我建议将`mysqli_*`函数作为一个简单的替代方案。

此外，您应该始终为您的数据库查询提供错误处理。如果您只是简单地记录或回显 MySQL 错误，并实际进行了查询尝试，您就会立即知道您的语法无效。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-27T19:12:32.133

**错误的**

```
SELECT * FROM phppractice(Name,Email,Phone) 
```

它应该是

```
SELECT Name,Email,Phone FROM phppractice 
```

# php - Symfony 2 中的大型数据集导入

> ID：14059903
> 
> 赞同：1
> 
> 时间：2012-12-27T19:08:34.710
> 
> 标签：php, symfony, propel

我正在开发一个基于 Symfony 2 的项目，需要使用 cron 任务定期从 .csv 文档中导入 150 万个产品。

导入当前如下所示：

```
 ...

    Propel::disableInstancePooling();

    $fp = fopen($file, 'r');
    while ( !feof($fp) ) {
        $line = fgets($fp, 2048);
        $data = str_getcsv($line, "\t");

        $product = new Product();
        $product->setId($data[0]);
        $product->setTitle($data[1]);
        ...
        $product->save();
    }

    ... 
```

然而，大约 5 分钟后，Apache 达到其 512MB 内存分配并抛出以下错误：

`Fatal error: Allowed memory size of 536870912 bytes exhausted (tried to allocate 78 bytes) in /var/www/vhosts/myapp.local/app/cache/dev/classes.php on line 9451`

我已经禁用了 Propel 的实例池（这在过去在其他框架中的 Propel 驱动的导入中一直有效）并且问题仍然存在，所以我想知道 Symfony 2 是否正在执行任何类型的缓存（基于抛出的错误）。

有没有人有任何在 Symfony 2 中执行大型导入的经验，可以为我指明正确的方向？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T19:30:36.650

哦，男孩，我 6 个月前在那里，给你一个小字：交易。

将 csv 切成小块，例如在 10000 行或多或少的包中，每个包执行 1 个事务，这样可以避免向 db 写入 150 万次并写入 150 次的开销。

希望能指导您找到一个好的解决方案，我无法将时间从 30 秒缩短，也许您应该考虑为这类 io/cpu 绑定任务使用离线任务处理器。

目前这个页面是我的圣经： http: [//propelorm.org/documentation/06-transactions.html](http://propelorm.org/documentation/06-transactions.html)

# 编辑

实际上，我认为这是该站点需要的某种导入操作，如果这是您“开发人员”需要做的一次性事情，我会选择 Xnoise 建议。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T19:37:30.473

实际上，这个导入应该直接在 mysql 级别进行（mysql 可以从 csv 文件中读取数据），除非它非常复杂。另一种方法是增量读取文件，生成一个 sql 文件，然后本地将其导入数据库。没有理由让 Web 应用程序直接处理如此大的导入，因为您将耗尽内存。

确保不要一次将整个 csv 加载到内存中。

额外的解决方案是在 php.ini 中给 php 更多的内存，并希望最好。php 不是批量处理大量数据的最佳语言。

# sql - 第一次尝试使用 ActiveRecord “where”，失败

> ID：14059911
> 
> 赞同：0
> 
> 时间：2012-12-27T19:09:13.737
> 
> 标签：sql, ruby-on-rails, activerecord

在我的应用程序中，`puts self.ideas.inspect`输出：

```
[#<Idea id: 1, title: "Ad et ut nesciunt ut.", 
note: ["Ratione et aut harum.", "Dicta nostrum sit officiis voluptates molestiae veritatis ut."], 
status: "claimed", 
created_at: "2012-12-27 19:03:11", updated_at: "2012-12-27 19:03:11", user_id: 1>, 
#<Idea id: 2, title: "Asperiores dolores modi et.", 
note: ["Reprehenderit harum consequuntur repellendus qui.", "Labore eum minus voluptas quidem aliquid est occaecati."], 
status: "claimed", 
created_at: "2012-12-27 19:03:11", updated_at: "2012-12-27 19:03:11", user_id: 1>, 
#<Idea id: 3, title: "Labore nam deserunt quibusdam.", 
note: ["Sequi saepe itaque.", "Numquam distinctio vel hic et qui."], 
status: "claimed", 
created_at: "2012-12-27 19:03:11", updated_at: "2012-12-27 19:03:11", user_id: 1>] 
```

然而在下一行，`claimed_count = self.ideas.where(status: "claimed").size`返回 0。我的查询语法显然是错误的，但我一直在仔细研究[本指南](http://guides.rubyonrails.org/active_record_querying.html#pure-string-conditions)，但我仍然无法弄清楚！

必须是非常基本的东西......有人吗？

**编辑：**我使用以下测试获得了这些想法：

```
it "can't claim an idea if he already has 3 ideas with claimed status" do
  james.claim(si_title0)
  james.claim(si_title1)
  james.claim(si_title2)
  james.claim(si_title3)
  james.ideas.size.should eq 3
end 
```

我很抱歉这个丑陋的测试......我打算在我通过后试图找出重构它的插值。上面的`inspect`转储来自循环的第三或第四次迭代。

**编辑2：**这就是`claim`：

```
 def claim(idea)
    puts self.ideas.inspect
    #claimed_count = self.ideas.where(status: "claimed").count
    claimed_count = self.ideas.count(conditions: "status='claimed'")
    puts "claimed_count is #{claimed_count.inspect}"
    if idea.status == "available" && claimed_count < 3
      self.ideas<<idea
      idea.status = "claimed"
    end
  end 
```

那么......它不会保存到数据库中吗？如果是这样，我应该如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T19:21:05.613

我怀疑这`claim()`没有将“声明”`idea`状态保存到数据库中。您需要更改此行为（如果这是您真正需要的），或者搜索`ideas`Enumerable 本身而不是通过`where`. 您可以`select`为此使用：

```
james.ideas.select{|idea| idea.status == "claimed"}.size 
```

您可以添加一个辅助方法来`Idea`简化查询：

```
class Idea < ActiveRecord::Base
  def claimed?
    status == "claimed"
  end
end

james.ideas.select(&:claimed?).size 
```

**更新**

您的代码不会按原样保存状态，因为`idea`更改属性后不会调用任何内容来保存对象`status`。您可以通过颠倒调用顺序来解决此问题：

```
if idea.status == "available" && claimed_count < 3
  idea.status = "claimed"
  self.ideas<<idea
end 
```

'shovel' 运算符将保存这个`<<`想法，因为您将它添加到持久对象的关联集合中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T19:19:07.570

您的数据在每次测试结束时被删除——一旦测试结束，插入的数据将被回滚；它不应该在测试之间持续存在！

你如何以及在哪里使用你的`where`，你的模型（特别是`ideas`关联）是什么样的？

# linux - 是否有列出所有 Unix 组名的命令？

> ID：14059916
> 
> 赞同：644
> 
> 时间：2012-12-27T19:09:32.353
> 
> 标签：linux

我知道有`/etc/group`列出所有用户组的文件。

我想知道是否有一个简单的命令可以列出所有用户组名称，尽管解析了世界可读`/etc/group`文件。我愿意创建一个列出 Linux 帐户组名的管理员网页。

* * *

## 回答 #1

> 赞同：912
> 
> 时间：2012-12-27T19:29:12.420

要列出所有已分配用户的本地组，请使用以下命令：

```
cut -d: -f1 /etc/group | sort 
```

有关更多信息-> [Unix 组](http://www.udel.edu/it/help/unix/unixgroups.html)、 [剪切命令](https://www.geeksforgeeks.org/cut-command-linux-examples/)、 [排序命令](https://www.geeksforgeeks.org/sort-command-linuxunix-examples/)

* * *

## 回答 #2

> 赞同：287
> 
> 时间：2014-02-24T20:22:25.003

如果您希望系统知道*所有组*，我建议使用`getent group`而不是解析`/etc/group`：

```
getent group 
```

原因是在联网系统上，组不仅可以从`/etc/group`文件中读取，还可以通过 LDAP 或黄页获得（已知组的列表来自本地组文件加上通过 LDAP 或 YP 接收的组）。

如果您只想要组名，您可以使用：

```
getent group | cut -d: -f1 
```

* * *

## 回答 #3

> 赞同：55
> 
> 时间：2015-04-13T22:04:48.420

在 Linux、macOS 和 Unix 上显示您所属的组，请使用：

```
id -Gn 
```

这相当于`groups`在 Unix 上已经过时的实用程序（根据[Unix 手册](https://www.unix.com/man-page/FreeBSD/1/groups/)）。

在 macOS 和 Unix 上，`id -p`建议使用该命令进行正常交互。

参数说明：

> `-G`, `--groups`- 打印所有组 ID
> 
> `-n`, `--name`- 打印名称而不是数字，对于`-ugG`
> 
> `-p`- 使输出可读。

# sqlite - SQLite - 删除 TEMP 表不会释放分配的内存

> ID：14059918
> 
> 赞同：2
> 
> 时间：2012-12-27T19:09:41.403
> 
> 标签：sqlite, temp-tables

我正在使用`PRAGMA temp_store=2`，所以所有临时表都是在内存中创建的。我有一个包含 1,000,000,000 条记录的临时表。我的测试应用程序使用的内存增长到大约 80 MB。如果我从该表中删除所有记录或删除表，那么我的应用程序仍然使用 80 MB 内存。为什么 sqlite 不释放内存？

问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T14:41:37.230

该表以前使用的内存仍然是数据库的一部分，以后插入该数据库的任何数据都将重用该内存。

要完全释放该内存，您必须关闭数据库连接（如果您想存储更多临时数据，请打开一个新连接）。

如果您希望数据库稍后重用数据，那么在此期间释放它将是无用的开销，除非您的机器内存极度匮乏。

# c# - 重新生成 Settings.settings

> ID：14059919
> 
> 赞同：11
> 
> 时间：2012-12-27T19:10:14.783
> 
> 标签：c#, visual-studio, visual-studio-2012

我正在重构一个项目，令我懊恼的是，该项目是用 Visual Studio 编写的。我来自 Linux 背景，发现 Visual Studio 是一个令人沮丧的菜单的地下墓穴。

我正在尝试将`Settings.settings`文件从一个解决方案移动到另一个解决方案。

从中复制所有文本`Settings.Designer.cs`已经产生了所需的编译时功能，但我似乎无法使用 gui 来更改属性。与我的源项目不同，该 gui 不显示任何属性。我还担心我的更改会随着 VS 的突发奇想而消失（当它重新生成此文件时）。

如何从现有配置文件中重新生成这些属性？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-12-27T19:19:44.107

您可以删除 .Designer.cs 文件，然后从项目中排除 .settings 文件并再次包含它。然后重新生成 .designer 文件。

在这两者之间，请确保单击“显示所有文件”按钮，否则您将看不到刚刚从项目中排除的文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-08-29T14:05:40.237

我只需要做类似的事情。

对我有用的是：

1.  使用“添加...”添加设置文件，将其命名为 Settings.settings
2.  将设置文件移动到属性目录。（只需抓住并移动它。）
3.  现在，由于这是一个空设置文件，请将旧设置文件（您要移动的设置文件）复制到同一区域，覆盖刚刚创建的设置文件。
4.  运行自定义工具以重新创建 Settings.Designer.cs

我的问题是我在尝试复制 Settings.settings 文件和 Settings.Designer.cs 时遇到了困难。那是不行的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-17T19:24:18.707

根据[this ASP.NET post](http://forums.asp.net/t/1310271.aspx?Settings%20Settings%20file%20)，您可以这样做

> 如果编辑settings.settings文件，而settings.designer.cs文件中的值没有改变，可以删除settings.designer.cs文件，然后右键settings.settings文件，选择“运行自定义工具” ”。这将重新生成 settings.designer.cs 文件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-11-30T21:13:45.883

This is an old question. Now seems like none of the above answers apply to VS 2019, and yet this problem continues to exist in some fashion. I deleted and excluded and re-added until I could no longer remember what I did. But in the end, it started working. Looking at what VS added to my csproj file, I think the key is that you need this:

```
<Compile Update="Properties\Settings.Designer.cs">
  <DesignTimeSharedInput>True</DesignTimeSharedInput>
  <AutoGen>True</AutoGen>
  <DependentUpon>Settings.settings</DependentUpon>
</Compile> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-12-07T11:32:52.860

您可以从其他项目导入设置。只需从解决方案资源管理器中复制 settings.settings，然后将其粘贴到另一个项目中。（同样你可以通过复制/粘贴使用导入）Visual Studio 将自动生成（app.config）的配置。

[第一个项目](https://i.stack.imgur.com/v7M3N.png)

第二个项目

[第二个项目](https://i.stack.imgur.com/g3P0n.png)

接下来，当您单击设计器时，Visual Studio 应该会通知您所有属性都将添加到您的 app.config 中（并使其在您的设计器中可见）

[通知](https://i.stack.imgur.com/UAjf0.png)

# php - PHP：“file_get_contents()”从内容验证 URL 返回 NULL

> ID：14059923
> 
> 赞同：5
> 
> 时间：2012-12-27T19:10:38.783
> 
> 标签：php, codeigniter, httpresponse, file-get-contents

我打赌它最终会变得很简单……但我可以用手来发现它。

**问题：**
当我尝试通过 获取特定本地 URL 的内容时`file_get_contents()`，它以空字符串 '' (length=0) 的形式返回。

**我试过的：**

```
 $url = 'http://localhost/bbq/index.php/company/get/id/2131/return/json';
    $results = file_get_contents($url);
    echo'<pre>Results:<br />',var_export($results),'</pre>'; 
```

直接访问`http://localhost/bbq/index.php/company/get/id/2131/return/json`时，一切都美妙地回响：`{"id":"2131","value":"Acme Anvil Corp."}`

为了检查自己，我尝试了它`$url = 'http://www.google.com'`，它*按预期工作，*所以我尝试了一个单独的本地 uri，`http://localhost/?phpinfo=1`它*也工作*得很好。

**问题：**
我错过了什么？？？

**[附加信息]**
`allow_url_fopen`开启

我*可能*刚刚发现*了什么*。
作为 CODEIGNITER 项目中的一项安全措施，控制器脚本的第一行包含：

```
 if ( !defined('BASEPATH')) exit('No direct script access allowed'); 
```

评论它并没有提供任何改进，但我认为它仍然值得一提。

此外，这里是 HTTP 响应标头的转储。也许有人可以看到那里的东西。这对我来说似乎很简单，但我真的不知道我应该寻找什么。

```
array (size=13)
  0 => string 'HTTP/1.1 200 OK' (length=15)
  1 => string 'Date: Thu, 27 Dec 2012 19:58:47 GMT' (length=35)
  2 => string 'Server: Apache/2.4.2 (Win64) PHP/5.4.3' (length=38)
  3 => string 'X-Powered-By: PHP/5.4.3' (length=23)
  4 => string 'Set-Cookie: csrf_cookie_name=4ae46f9a7e612ae22a080a4e88bd349c; expires=Thu, 27-Dec-2012 21:58:47 GMT; path=/' (length=108)
  5 => string 'Set-Cookie: PHPSESSID=ah70p0ldl5qptcauei1t8ihud3; path=/' (length=56)
  6 => string 'Expires: Thu, 19 Nov 1981 08:52:00 GMT' (length=38)
  7 => string 'Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0' (length=77)
  8 => string 'Pragma: no-cache' (length=16)
  9 => string 'Refresh: 0;url=http://localhost/bbq/index.php/index.php/user/login' (length=66)
  10 => string 'Content-Length: 0' (length=17)
  11 => string 'Connection: close' (length=17)
  12 => string 'Content-Type: text/html' (length=23) 
```

**[/附加信息]**

**顺便说一句，**我正在运行：

*   Win7 64 上的 WAMPSERVER
*   阿帕奇 2.4.2
*   PHP 5.4.3
*   代码点火器 2.1.2

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-27T19:54:43.847

现在开始调试：

```
# we want text output for debugging. Either this works or you need to look into
# source in your browser (or even better, debug with the `curl` commandline client.)
header('Content-Type: text/plain');

# For quick and dirty debugging - start to tell about if something is worth
# to warn or notice about. (do logging in production)
error_reporting(~0); ini_set('display_errors', 1);

$url = 'http://localhost/bbq/company/get/id/2131/return/json';
$results = file_get_contents($url);
var_dump($http_response_header, $results);

# hard exit, flush all (potential) buffers.
die(); 
```

由于`var_dump`. 您还可以在标题调用下方的开头添加一些标记输出，因此很明显该脚本已被调用并且它确实开始运行。

然而，更好的变体是使用步进调试器并创建带有断点的调试会话。我推荐 Xdebug。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-10-11T10:49:29.653

我可以看到这是一篇旧帖子，但我今天遇到了类似的问题，file_get_contents() 使用相对文件路径，返回一个空字符串。

我对所有文件都使用 UTF-8 编码，但我发现我忘记更改一个文件的编码（我无法通过 file_get_contents() 检索）。当我更改编码时，它“神奇地”起作用了。

Thre 问题是由 ANSI 编码文件中的非 ANSI 字符引起的（例如：á,é,ű,ő）。

希望这对某人有帮助！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-27T19:19:06.947

检查它是否在您的 php.ini 中启用

```
ini_get('allow_url_fopen') 
```

# javascript - Jquery - each() eq() click()

> ID：14059924
> 
> 赞同：0
> 
> 时间：2012-12-27T19:10:40.593
> 
> 标签：javascript, jquery, click, each, var

我想获取从 HTML5 接收到的两项数据，并在 click 函数和其中的函数中使用它们。

我遇到了问题，所以这是我到目前为止的代码：

```
var test = [];

// This is a div class .quiz_list_row the ids are counted as #1 #2 #3...
$(".quiz_list_row").each(function(index){
    // Gets the data necessary
    //  It comes from data-quizlist-id (HTML5)
    $quiz_list_id = $(this).eq(index).data("quizlistId");

    //  It comes from data-quizlevel-reached (HTML5)
    $quiz_level_reached = $(this).eq(index).data("quizlevelReached");

    test[index] = $quiz_list_id;

    // testing
    alert("quiz_list_id: " +$quiz_list_id);
    alert("level: "+$quiz_level_reached);

    // click functions
    $(this).click(function(){

        // bla bla
        // alert(test[index]) ???
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T19:16:13.843

你在滥用`.eq()`. 试试这个（我已经删除了对 的调用`.eq()`）：

```
var test = [];

    // This is a div class .quiz_list_row the ids (inside it) are counted as #1 #2 #3...
$(".quiz_list_row").each(function(index){

    // Gets the data necessary
               //  It comes from data-quizlist-id (HTML5)
    $quiz_list_id = $(this).data("quizlistId");
               //  It comes from data-quizlevel-reached (HTML5)
    $quiz_level_reached = $(this).data("quizlevelReached");

    test[index] = $quiz_list_id;

    // testing
    alert("quiz_list_id: " +$quiz_list_id);
    alert("level: "+$quiz_level_reached);

    // click functions
    $(this).click(function(){

          // bla bla
          // alert(test[index]) ???
    });
}); 
```

你可能只想要这个：

```
$(".quiz_list_row").click(function(){
    var $quiz_list_id = $(this).data("quizlistId");
    var $quiz_level_reached = $(this).data("quizlevelReached");

    alert("quiz_list_id: " +$quiz_list_id);
    alert("level: "+$quiz_level_reached);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T19:15:06.417

在点击事件周围使用闭包

```
 // testing
    alert("quiz_list_id: " + $quiz_list_id);
    alert("level: " + $quiz_level_reached);

    // click functions
    (function(num) {
        $(this).click(function() {

            alert(test[num]) ? ? ?
        });
    })(index);

});​ 
```

# mysql - MonthName() 函数在 Windows 8 中不起作用

> ID：14059925
> 
> 赞同：1
> 
> 时间：2012-12-27T19:10:47.070
> 
> 标签：mysql, asp-classic, vbscript

在此之前我使用窗口 7，我使用了函数 MonthName()

[http://www.w3schools.com/vbscript/func_monthname.asp](http://www.w3schools.com/vbscript/func_monthname.asp)

我使用 Windows 7 时的代码：

> response.write MonthName(12,True)

结果：

> 十二月

升级到 Windows 8 后，我使用了相同的功能，但得到了不同的输出，它没有将整数 12 转换为缩写的月份名称，而是在后面显示带有问号的整数。

我在使用 Windows 8 时的代码：

> response.write MonthName(12,True)

结果：

> 12？

即使我尝试显示非缩写月份名称，它也会显示 3 个问号：

> response.write MonthName(12,True)

输出：

> ？？？

有人可以帮忙吗？？

# javascript - 谷歌地图邮政编码绘制在错误的地方？

> ID：14059937
> 
> 赞同：1
> 
> 时间：2012-12-27T19:11:46.100
> 
> 标签：javascript, php, google-maps

我试图从我的表中提取数据并将其绘制在谷歌地图上。

我使用以下有效...

```
function addPostCode(zip) {
            geocoder.geocode( { 'address': zip}, function(results, status) {
            if (status == google.maps.GeocoderStatus.OK)
            {
                map.setCenter(results[0].geometry.location);
                var marker = new google.maps.Marker({
                map: map,
                position: results[0].geometry.location,
                name: zip
            });
            markers.push(marker);
            } else {
                alert("Geocode was not successful for the following reason: " + status);
            }
            });
        } 
```

仅当我的邮政编码为 LA14 时，它才会将其绘制为德国的一条名为 la14 的道路，而不是英国的 barrow in furness，有人知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T19:46:51.277

您正在传递模棱两可的信息。如果您通过“London”，试图获得“London, Canada”而不是更流行的“London, United Kingdom”，也会发生同样的事情。

**选项 1 - 如果您的所有邮政编码都在英国**：

您可以更改`{ 'address': zip}`为`{ 'address': zip + ', United Kingdom'}`. 这只是指定邮政编码在英国。逗号是可选的。

**选项 2 - 如果只有一些在英国**：

您可以向函数添加一个可选`country`参数，然后将“United Kingdom”传递给它以应对不明确的情况：

```
function addPostCode(zip, country) {

    var address;

    if (typeof(country) === 'undefined')  // no country passed
        address = zip;
    else
        address = zip + ', ' + country;

    geocoder.geocode({'address': address}, function(results, status) {
... 
```

即使您的价值观仅限于英国，我也会选择选项 2，以防万一您以后将其国际化。

# servicestack - Servicestack GetAsync OnSuccess 未触发

> ID：14059938
> 
> 赞同：2
> 
> 时间：2012-12-27T19:11:49.763
> 
> 标签：servicestack

我正在使用 ServiceStack 对 Web 服务 API 进行原型设计，并且在测试 GetAsync 时遇到了问题。具体来说，onSuccess 操作不会在我期望的时候被调用。

这是我的代码：

服务器：

```
[Route("/accounts/", "GET")
public class AccountRequest : IReturn<AccountResponse>
{
    public string EmailAddress {get; set;}
}

public class AccountResponse
{
    public Account Account {get; set;}
}

public class AccountService : Service
{
    public object Get(AccountRequest request)
    {
        return new AccountResponse{Account = new Account.....
    }
} 
```

非常基本，几乎与[ServiceStack.net上的 hello world 示例一样](http://www.servicestack.net/ServiceStack.Hello/)

和有问题的客户端 GetAsync 调用：

```
using(var client = new JsonServiceClient("some url")
{
    client.GetAsync(new AccountRequest{EmailAddress = "gibbons"},
            response => Console.WriteLine(response.Account.Something), //This never happens
            (response, ex) => {throw ex;}); // if it matters, neither does this

} 
```

然而，这完全符合预期......

```
using(var client = new JsonServiceClient("some url")
{
    var acc = client.Get(new AccountRequest{EmailAddress = "gibbons"});

    //acc is exactly as expected.
} 
```

有趣的是，一个接一个地测试异步和非异步也可以：

```
using(var client = new JsonServiceClient("some url")
{
     client.GetAsync(new AccountRequest{EmailAddress = "gibbons"},
                    response => Console.WriteLine(response.Account.Something), //Works
                    (response, ex) => {throw ex;});

    var acc = client.Get(new AccountRequest{EmailAddress = "gibbons"});

    //Again, acc is exactly as expected.
} 
```

在所有情况下，我都可以看到通过 Fiddler 通过 HTTP 传输的实际数据，所以我认为我缺少对异步 api 工作原理的一些基本了解。

欢迎任何帮助。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T02:45:30.457

阻塞同步 API 在响应完成之前不会返回，因为异步 API 是非阻塞的，因此执行会立即继续。只有在返回和处理响应时才会触发回调。

在[AsyncRestClientTests.cs](https://github.com/ServiceStack/ServiceStack/blob/master/tests/ServiceStack.WebHost.Endpoints.Tests/AsyncRestClientTests.cs)测试中，它会休眠 1 秒，`Thread.Sleep(1000)`然后断言及时返回了响应。

您要等待多长时间才能确定回调是否被触发？

# jquery - Internet Explorer 的 jquery ui 选项卡问题

> ID：14059948
> 
> 赞同：-1
> 
> 时间：2012-12-27T19:12:31.300
> 
> 标签：jquery, jquery-ui, internet-explorer

我在用着

jQuery - 1.4.4

jQuery 用户界面 - 1.8.17

在任何版本的 Internet Explorer 上，我都遇到了标签问题。

![在此处输入图像描述](../Images/7bc4127107c9e725c6d4d45f1e9774af.png)

如您所见，某些选项卡内容显示在选项卡 div 之外

这是我的代码：

```
<div id="tab_documents" class="ui-set-tabs" style="min-height: 150px">
    <ul class="tabNavigation">
        <li><a href="#tab_model"><?php $this->lang->cout("messages_sms_other")?></a></li>
        <li id='tab_dest_title' <?php  echo isset($enable_tabs) ? '' : 'class="ui-state-disabled"' ?>><a href="#tab_dest"><?php $this->lang->cout("attrs_destination")?></a></li>
        <li id='tab_params_title' <?php  echo isset($enable_tabs) ? '' : 'class="ui-state-disabled"' ?>><a href="#tab_params"><?php $this->lang->cout('documentemissions_params')?></a></li>
        <li id='tab_attach_title'  <?php  echo isset($enable_tabs) ? '' : 'class="ui-state-disabled"' ?>><a href="#tab_attach"><?php $this->lang->cout('attrs_attachments') ?></a></li>
    </ul>
    <div id='tab_model'> content </div>
<div id='tab_dest'> content </div>
<div id='tab_params'> content </div>
<div id='tab_attach'> content </div> 
```

所以当我点击第三个或第四个标签时，Internet Explorer 给了我这个：

SCRIPT5022：jQuery UI 选项卡：片段标识符不匹配。jquery-ui.min.1.8.17.js，第 181 行字符 6303

有什么帮助吗？提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T19:20:45.587

首先 div with`id="tab_documents"`没有关闭，也许这里有版本不匹配。`jQuery UI`您使用的版本`jQuery`不兼容。也许 1.8.17 of`jQuery UI`出现在 1.4.4 of 之后`jquery`。

尝试使用这两个库的最新版本。获取 1.8 + 的[jQuery](http://jquery.com/)和 1.9.2 的[jQuery UI](http://jqueryui.com/)

# php - PHP将行插入数据库

> ID：14059950
> 
> 赞同：-1
> 
> 时间：2012-12-27T19:12:39.943
> 
> 标签：php, mysql

我已经问过这个问题了，但问题没有回答就关闭了，所以我发布了新问题。我正在尝试在表 ps_psroduct 供应商的第二个表中添加缺少的值，一些值丢失了，我想添加来自 ps_product 的值。所以我想列出缺少的值并将它们插入到 ps_product_supplier 中，没有重复。ps_product 的一些值在 ps_product_supplier 中是相同的，但不是全部，所以我想过滤这些值并正确插入它们。所以某些值存在于 ps_product 但不存在于 ps_product_supplier 中，我想通过检查 id_product 并添加缺失来在表中插入缺失的行。我现在所拥有的是我打印了所有值，但我只需要缺失值，我可以将它们插入到 ps_product_supplier

怎么做？在输出中我得到：

```
USPJESNO ID 1 ne postoji u drugoj tablici i trenutno: 0
USPJESNO ID 2 ne postoji u drugoj tablici i trenutno: 1
USPJESNO ID 3 ne postoji u drugoj tablici i trenutno: 2
USPJESNO ID 4 ne postoji u drugoj tablici i trenutno: 3
USPJESNO ID 5 ne postoji u drugoj tablici i trenutno: 4
USPJESNO ID 6 ne postoji u drugoj tablici i trenutno: 5 
```

对于所有值，但我需要处理 ID 并仅打印缺失的内容并在 ps_product_supplier 中为它创建一行，其中的值来自 ps_product

```
$kveri = "SELECT id_product,id_supplier,supplier_reference, wholesale_price FROM ps_product";

    $ispis = mysql_query($kveri) or die(mysql_error());

               while ($row = mysql_fetch_array($ispis)){

               $trenutnired = $row['id_product'];
               $trenutnired1 = 0;
               $trenutnired2 = $row['id_supplier'];
               $trenutnired4 = $row['supplier_reference'];
               $trenutnired5 = $row['wholesale_price'];
               $trenutnired6 = 3;

                                                            //echo $trenutnired;

            //$drugatab = "SELECT * FROM ps_product_supplier WHERE id_product = '$trenutnired'";
            $drugatab = "SELECT id_product FROM ps_product_supplier WHERE id_product = '$trenutnired'";
            $rezultati = mysql_query($drugatab) or die(mysql_error());
                if(mysql_num_rows($rezultati)){
            // Successful query...

            echo "USPJESNO ID $trenutnired ne postoji u drugoj tablici i trenutno: $countUpdated<br />";
            //mysql_query("INSERT INTO ps_product_supplier (id_product_supplier, id_product, id_product_attribute, id_supplier, product_supplier_reference, product_supplier_price_te, id_currency)  VALUES ('', '$trenutnired', '$trenutnired1',  '$trenutnired2', '$trenutnired4', '$trenutnired5', '$trenutnired6')");
            $countUpdated++;
        } else {
            //$countUpdated++;
            echo "ID $trenutnired ne postoji u drugoj tablici i trenutno: $countUpdated<br />";
        }
        } 
```

此查询适用于一个 ID 以插入数据，但我需要所有缺少的内容：

```
INSERT INTO ps_product_supplier 
(id_product_supplier, id_product, id_product_attribute, id_supplier,
product_supplier_reference, product_supplier_price_te, id_currency)  
VALUES(NULL, 6216, 0, (SELECT id_supplier FROM ps_product WHERE id_product = 6216),
(SELECT supplier_reference FROM ps_product WHERE id_product = 6216), 
(SELECT wholesale_price FROM ps_product WHERE id_product = 6216), 3); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T19:20:49.637

*我认为您正在*尝试选择ps_products 中但*不在*ps_productsuppliers 中的产品。如果我是对的，那么这种方式可能是最容易理解的。

```
select id_product
from ps_products
where id_product not in (select id_product from ps_product_supplier; 
```

# jms - 无法通过 QueueBrowser 从 JMS 消息中提取属性

> ID：14059952
> 
> 赞同：1
> 
> 时间：2012-12-27T19:12:47.920
> 
> 标签：jms, websphere-6.1

详细说明一下，尽管 JMS 系统属性显示在新创建的 MQ 7 队列中，但我们没有在消息中看到 JMS 应用程序属性。重新创建错误以便理解的步骤

工作场景

1.  创建新的 JMS 消息
2.  使用 setStringProperty API 调用在此 JMS 消息中设置应用程序属性
3.  将消息丢弃到迁移队列 MQ 7（从 MQ 6 到 MQ 7 队列）
4.  进入 UI，通过 JMS QueueBrowser 浏览消息
5.  能够查看所有应用程序属性

不工作场景

1.  创建新的 JMS 消息
2.  使用 setStringProperty API 调用在此 JMS 消息中设置应用程序属性
3.  将消息丢弃到新创建的 MQ 7 队列
4.  进入 UI，通过 JMS QueueBrowser 浏览消息
5.  尽管我们可以看到 JMS 系统属性 (JMS_IBM*)，但无法看到所有应用程序属性

我们从新创建的队列中转储了消息。我们在消息转储中看到应用程序属性。但是当我们通过 api Enumeration messageEnum = queueBrowser.getEnumeration(); 提取消息时

枚举列表消息，它不会在新创建的队列的所有消息中显示应用程序属性。但是相同的 API 可以为迁移的队列提取具有应用程序属性的消息。

我们正在使用 websphere application server v 6.1 和 Websphere MQ 7.0.1.6。

你能解释一下我做错了什么吗？

# java - 在控制器中调用视图方法

> ID：14059954
> 
> 赞同：2
> 
> 时间：2012-12-27T19:12:48.667
> 
> 标签：java, javafx-2, fxml

我想在控制器中调用视图方法，但我不知道如何:) 我寻找类似的例子，但我没有找到它。我可以在这段代码中这样做吗？我是否必须重新建造它？我使用 javafx 和 fxml 技术（构建用户界面）。

我的视图文件（它有 gotoRegister() 和 gotoLogin() 方法（我想调用它们））

```
public class FXMLExampleMVC extends Application{

    protected Parent root;
    @Override
    public void start(Stage stage) throws Exception {
        gotoLogin();

        Scene scene = new Scene(root);

        stage.setScene(scene);
        stage.setTitle("JavaFX Welcome!");
        scene.getStylesheets().add(FXMLExampleMVC.class.getResource("cssforapp.css").toExternalForm());

        stage.show();
    }

    public void gotoRegister() throws IOException{
        root = FXMLLoader.load(getClass().getResource("RegisterFXML.fxml"));  
    }
    public void gotoLogin() throws IOException{
        root = FXMLLoader.load(getClass().getResource("Sample.fxml"));
    }

    public static void main(String[] args) {
      launch(args);  
    }
} 
```

我的控制器（这里我想调用 gotoRegister() 方法）

```
public class SampleController {

    public SampleModel model = new SampleModel();
    @FXML
    protected Text actiontarget;
    @FXML
    protected PasswordField passwordField;
    @FXML
    protected TextField loginField;

    @FXML protected void handleSubmitButtonAction(){
        if((loginField.getText().equals(model.returnLogin()))&&(passwordField.getText().equals(model.returnPass())) ){
            actiontarget.setText("You have access !");
        } else {
           actiontarget.setText("Wrong data !"); 
        }

    }
    @FXML protected void handleSubmitButtonRegister() throws IOException{
        // 
       //Here I want to invoke gotoRegister
      //
    }
} 
```

我的问题：我可以调用 gotoRegister 吗？或者，也许是其他方式来更改 fxml 文件（来自控制器）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-28T02:40:58.777

将此代码放入 FXMLExampleMVC.java

```
private static FXMLExampleMVC instance;
public FXMLExampleMVC() {
           instance = this;
}
// static method to get instance of view
public static FXMLExampleMVC getInstance() {
        return instance;
} 
```

现在你可以像这样在控制器中调用你的视图方法

```
 @FXML protected void handleSubmitButtonRegister() throws IOException{
        // 
       //Here I want to invoke gotoRegister
        FXMLExampleMVC.getInstance().gotoRegister();
    } 
```

# mysql - 如何为表中的新行创建外键？- mysql - CodeIgniter

> ID：14059962
> 
> 赞同：0
> 
> 时间：2012-12-27T19:13:53.863
> 
> 标签：mysql, codeigniter, foreign-keys

我无法理解外键。我收到一个数据库错误 1452，说无法添加/更新子行，我不知道这意味着什么。

我假设通过浏览您需要从另一个表中获取值的答案，但不确定这是否正确。

我正在尝试在表中插入一行，这会导致该错误。如何像使用 CI 插入的其他值一样指定外键的值？

请帮忙

这是我要插入的内容：

```
$salarystuff = array('salary' => $salary, 'from_date' => $salary_from_date, 'to_date' => $salary_to_date);
$this->db->insert('salaries', $salarystuff); 
```

表薪水具有以下列：emp_no、salary、to date 和 from date。我已经插入了除了上面看到的 id 之外的所有内容，但是需要另一个表中的 id。这是错误消息：

> 无法添加或更新子行：外键约束失败 ( `employees`. `salaries`, CONSTRAINT `salaries_ibfk_1`FOREIGN KEY ( `emp_no`) REFERENCES `employees`( `emp_no`) ON DELETE CASCADE)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T20:38:51.437

> 我收到一个数据库错误 1452，说无法添加/更新子行，我不知道这意味着什么。

这通常意味着您尝试向其中插入一行的表至少有一列包含对另一个表的外键引用。这意味着您为该列提供的任何值必须已经存在于该其他表中。（为不存在的员工存储薪水是没有意义的。）

> 无法添加或更新子行：外键约束失败（employees.salaries, CONSTRAINTsalary_ibfk_1 FOREIGN KEY (emp_no) REFERENCES employees (emp_no) ON DELETE CASCADE）

当您在“salaries”中插入一行时，您为“emp_no”提供的值必须已经存在于“employees”中。

所有可能的值都在“employees.emp_no”中。如何从所有可能的值中选择*正确的“emp_no”取决于应用程序。*

大多数时候，我们希望用户从员工编号和员工姓名的下拉列表中选择一个员工编号，然后填写新的薪水。用户是否填写“开始日期”和“截止日期”或是否自动完成取决于应用程序。在用户选择姓名并提供薪水后，在用户填写“起始日期”和“到日期”或通过代码计算后，您可以将这些值作为新行插入“薪水”。

无论如何，就数据库插入语句而言，您的 CI 代码应该像处理所有其他列一样处理“emp_no *”*。

# spring-mvc - Spring MVC - 请求的资源不可用

> ID：14059963
> 
> 赞同：0
> 
> 时间：2012-12-27T19:13:57.573
> 
> 标签：spring-mvc, configuration, model

当我输入

```
http://localhost:1111/Quizat/test 
```

在 URL 中，我没有加载 login.jsp，但我在控制台上打印了“测试正在运行”消息。

**我的控制器：**

```
 @RequestMapping("/test")  
        public ModelAndView test(Model model) throws Exception {
            System.out.println("test is running");
            return new ModelAndView("login");
        } 
```

**我的调度程序-servlet.xml**

```
<bean id="viewResolver"
class="org.springframework.web.servlet.view.InternalResourceViewResolver">
<property name="viewClass">
  <value>org.springframework.web.servlet.view.JstlView</value>
  </property>
<property name="prefix">
<value>/view/</value>
</property>    
<property name="suffix">
<value>.jsp</value>
</property>
</bean> 
```

我正在做一个“动态网络项目”。我在“WebContent/view/”中有我的 login.jsp。请帮我解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T20:12:43.913

你得到“测试正在运行”，因为你的代码是
`@RequestMapping("/test")`

添加以下代码 -

```
<property name="prefix"><value>/WEB-INF/views/</value></property> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T20:01:34.783

为 /login 定义获取映射。

# sql - 如何将多个语句合并为一个？

> ID：14059964
> 
> 赞同：0
> 
> 时间：2012-12-27T19:14:02.907
> 
> 标签：sql, sql-server, sql-server-2008-r2

好吧，这里是我想要完成的一小部分内容。我在 select 语句中有一个 case 语句。这是我所拥有的......：

```
CASE pu.Group_Value 
    WHEN 1 THEN 'A'
    WHEN 2 THEN 'B' 
    WHEN 3 then 'C' 
    WHEN 4 then 'D' 
    WHEN 5 then 'E' 
    WHEN 6 then 'F' 
    WHEN 7 then 'G' 
END AS Groups, 
```

我遇到的问题是这个 case 语句可以有多个返回。我需要做的是能够将这些合二为一。我最终有 7 行回来了，但只需要一行，该行列中的所有 7 个字母......

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T19:46:48.710

使用`FOR XML PATH`. 例如：

```
SELECT STUFF(
  (
    SELECT ','+ CASE pu.Group_Value
                  WHEN 1 THEN 'A'
                  ...
                END 
    FROM pu
    FOR XML PATH('')
  ),1,1,'') as Groups 
```

只要确保在 CASE 逻辑中没有为 NULL 留出任何空间，否则它将使整个字符串为 NULL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T19:17:15.013

您可能想要做的是 GROUP BY pu.Group_Value。

此返回的行数取决于 SQL 查询的其余部分，除了您上面包含的内容。如果您只想返回一行，则 SELECT TOP 1 ... 是您最快的选择，否则您将需要更具体地使用 WHERE 子句标准或使用 GROUP BY 进行评估，这可能会改变您在您的选择。

# python-2.7 - 是否可以在程序运行时实时更新列表列表？

> ID：14059965
> 
> 赞同：1
> 
> 时间：2012-12-27T19:14:08.417
> 
> 标签：python-2.7, real-time, raw-input, real-time-updates

我有一个 24/7 运行的代码。而且，我想知道是否有任何方法可以让我实时更改变量而不会引发任何错误？一直在使用 raw_input() 但这会“停止”程序，因为它是按顺序运行的。

我的想法是使用 while true 循环：

```
while true:
    ...
    ... 
```

对于前几个循环，它将使用默认捕获我已预先编程到系统中的所有值。在它运行时，我想“实时”更改一些常数项（作为控制项）。因此，在下一个循环及以后，它将使用新值而不是预编程版本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T19:31:03.680

您尝试执行的某些代码或详细信息会有所帮助。

但是一种方法是有两个进程，一个从`standard in`with读取的进程`raw_input()`，我们可以称之为**p1**；还有一个处理数据结构的，在这种情况下是列表，我们称之为**p2**。

这两个进程可以使用套接字或您想要的任何方式与消息传递进行通信。

然后确保避免在**p1中读取新数据但在****p2**中尚未更新的竞争条件。因此**p2**将继续使用过期数据。一种方法是使用锁。

# machine-learning - 对条件受限玻尔兹曼机使用对比散度

> ID：14059966
> 
> 赞同：3
> 
> 时间：2012-12-27T19:14:14.767
> 
> 标签：machine-learning, neural-network

我想使用受限玻尔兹曼机进行模式识别。我注意到它们实际上用于查找模式中的分布而不是模式识别。我查看了以下论文：[http](http://www.cs.toronto.edu/~hinton/absps/uai_crbms.pdf) ://www.cs.toronto.edu/~hinton/absps/uai_crbms.pdf ，它似乎使用了 RBM 的扩展，称为 ConditionalRBM。我想实现这一点。我已经使用 Contrastive Divergence 来实现 RBM，为了简单起见，我想坚持使用 CRBM。这篇论文的重点是用更准确的算法代替对比分歧。

根据我在论文中看到的，我现在需要创建三个权重矩阵（因为现在我还必须包含分类向量）（参见论文中的图 1），我不确定如何更新它们中的每一个（即如何创建将影响矩阵变化的向量。）

有人可以为我澄清这一点或建议使用我已经实现的简单 RBM 进行分类的算法吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T09:32:13.303

我发现以下文件澄清了这个问题：[http](http://uai.sis.pitt.edu/papers/11/p463-louradour.pdf) ://uai.sis.pitt.edu/papers/11/p463-louradour.pdf 。这里的海报也很有帮助，特别是对于实施：[http](http://www.dmi.usherb.ca/~larocheh/publications/drbm-mitacs-poster.pdf) ://www.dmi.usherb.ca/~larocheh/publications/drbm-mitacs-poster.pdf 。除了使用 3 个权重矩阵，使用 2 个就足够了，一个用于分类向量，一个用于实际模式。

激活概率的公式会改变，但想法是一样的。

# python - 有没有可以做“部分渲染”的python模板库？

> ID：14059969
> 
> 赞同：6
> 
> 时间：2012-12-27T19:14:29.083
> 
> 标签：python, template-engine

假设我有以下模板：

```
<!DOCTYPE html>    
<html>
    {{ var1 }}
    {% if var1 and var2 %}
        <span>some text</span>
    {% endif %}
    {{ var2 }}
</html> 
```

当我将它`var1=3`作为上下文渲染时，它会产生以下输出：

```
<!DOCTYPE html>    
<html>
    3
    {% if 3 and var2 %}
        <span>some text</span>
    {% endif %}
    {{ var2 }}
</html> 
```

`var2=5`当我再次使用上下文渲染第一次渲染的输出时，输出是这样的：

```
<!DOCTYPE html>    
<html>
    3
        <span>some text</span>
    5
</html> 
```

问题是大多数模板引擎会将上下文中缺少的变量评估为空字符串。所有这些都是在只有一个渲染的假设下构建的。

我知道 jinja2 可以用这种方法做到这一点：[jinja2 模板的多次渲染？](https://stackoverflow.com/questions/12994028/multiple-renders-of-jinja2-templates)

但它不适用于整个`if`语句，它仅适用于单个变量。

是否有任何流行的模板库具有像我描述的那样的渲染模式？马可？源氏？还有什么？也许一个非python模板引擎可以做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-27T21:26:42.753

### TL;博士

我所知道的任何模板语言中都不存在此功能。您的最佳选择是：

1.  [使用这个 SO question](https://stackoverflow.com/questions/7772001/how-to-escape-or-in-django-template)破解
2.  编写您自己的模板标签（见下文）

### 编写自己的模板标签

我认为您在这里有几个选择，其中一些是我从[这里](https://stackoverflow.com/questions/7772001/how-to-escape-or-in-django-template)得到的，尽管它们都不涉及模板系统的内置功能。基本上，这里的目标是让渲染输出包含要再次渲染的模板标签的内容。

在我看来，最简单的做法是使用[`templatetag`](https://docs.djangoproject.com/en/dev/ref/templates/builtins/#templatetag)模板标签或编写自己的模板标签来做类似的事情并负责转义。

如果您可靠地渲染`var1`第一个和`var2`第二个：

```
<!DOCTYPE html>    
<html>
    {{ var1 }}
    {% templatetag openblock %} if {{ var1 }} and var2 {% templatetag closeblock %}
        <span>some text</span>
    {% templatetag openblock %} endif {% templatetag closeblock %}
    {% templatetag openvariable %} var2 {% templatetag closevariable %}
</html> 
```

在第一次渲染时，你会得到：

```
<!DOCTYPE html>    
<html>
    {{ 3 }}
    {% if 3 and var2 %}
        <span>some text</span>
    {% endif %}
    {{ var2 }}
</html> 
```

在第二次渲染时，这将产生您想要的输出。

显然，不断编写多层`{% templatetag %}`将是一个巨大的痛苦，所以我建议编写你自己的递归模板标签，它会为你处理这个问题，可能有一个参数来指定你需要多少层嵌套，然后显然是输入本身的参数。这样做的好处是，如果你只需要一层嵌套，让模板标签简单地输出输入就可以了，

基本上，通过递归地输出这个自定义模板标签，您可以很容易地实现所需的嵌套层数。假设标签被实现为`{% t <layers of nesting> <input> %}`：

```
    初始模板：{% t 2 "{{ var2 }}" %}
    第一次渲染：{% t 1 "{{ var2 }}" %}
    第二次渲染：{{ var2 }}
    最终渲染：5

```

现在，对于一些更复杂的标签来说，这将更加困难，例如`{% if %}`，当然，特别是如果像在您的示例中一样，您在单个 if 语句中需要多层渲染。您可能最好在这里拆分您的 if 语句，以便您可以进行更清晰的渲染分离。下面的例子假设一个`{% t %}`标签的实现，它是一个`{% t %}`/`{% endt %}`组合：

**初始 HTML：**

```
{% if var1 %}
   {% t 1 %}
       {% if var2 %}
          <span>some text</span>
       {% endif %}
   {% endt %}
{% endif %} 
```

**第一次渲染：**

```
{# Note that the first if statement has been evaluated and is gone #}
{% if var2 %}
    <span>some text</span>
{% endif %} 
```

**最终渲染：**

```
<span>some text</span> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-08-05T02:39:12.513

*在这里复活一个老问题 - 我最近想这样做，发现原来的答案过于复杂。这是相同答案的更简单版本。TLDR；使用扩展名。*

做一个扩展来做到这一点是相当微不足道的。这是我用来部分呈现模板的扩展版本。我使用自定义标签`preserve`来`endpreserve`分隔一个我不想在第一遍中呈现的块。

此模板的渲染结果仅用于创建另一个模板，该模板可以在第二遍中渲染非渲染变量和此类。

用法。

```
text = ...
pass_1 = Template(text, extensions=[PreserveExtension])
result_1 = pass_1.render(...)
pass_2 = Template(pass_1)
final_render = pass_2.render(...) 
```

这是扩展名。

```
class PreserveExtension(Extension):

  """
  Extensions ignores jinja templates between tags.
  NOTE: Preserved template spacing is slightly modified.

  Example Input:

    this is plain text
    {%- preserve %}
    this is plain text
    {{ a }}
    {%- if b %}{{ b }}{% endif -%}
    {% for i in c -%}
      {{ i }}
    {%- endfor %}
    {%- endpreserve %}

  Example Output:

    this is plain text
    this is plain text
    {{ a }}{%- if b %} {{ b }} {% endif -%}
    {% for i in c -%}
      {{ i }}{%- endfor %}
  """

  tags = {"preserve"}

  def parse(self, parser: Parser):
    lineno = parser.stream.current.lineno

    parser.parse_expression()
    parser.stream.skip()

    body = []
    raw = []

    def flush():
      nonlocal raw
      nonlocal body
      node = nodes.TemplateData(''.join(raw))
      body.append(node)
      raw = []

    while True:
      t: Token = next(parser.stream)
      if t.lineno != lineno:
        flush()
        lineno = t.lineno
      test = t.test('name:endpreserve')
      if test:
        raw.pop(-1)
        break
      if raw and not raw[-1].endswith('\n'):
        raw.append(' ')
      raw.append(t.value)
    if raw:
      flush()
    return body 
```

# php - 替换执行函数

> ID：14059970
> 
> 赞同：0
> 
> 时间：2012-12-27T19:14:35.510
> 
> 标签：php, imagemagick

我正在使用 exec 函数使用 ImageMagick 在 PHP 中调整图像大小：

```
exec("转换 $userfile -thumbnail $width x $height $userfile");
```

但是服务器支持禁用了这个功能并说它不安全，我不能再使用它了

有没有其他方法可以使用 ImageMagick 而不是使用 exec 来调整图像？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T19:17:47.730

如果他们禁用`exec`了，他们可能会禁用所有其他打开进程的方式。也许你应该看看他们是否会安装[“imagick”PECL 扩展](http://pecl.php.net/package/imagick)。

那或者您可以将您的代码转换为使用内置的 GD 东西。缩略图很容易。

我个人建议为此使用完善的第三方库。 [例如， Imagine](https://github.com/avalanche123/Imagine)非常漂亮。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T19:18:42.060

是的，您可以直接从 PHP中使用[ImageMagick 函数。](http://php.net/manual/en/book.imagick.php)例如，[`Imagick::scaleImage`](http://php.net/manual/en/imagick.scaleimage.php)。

# java - Java包不存在外部jar

> ID：14059973
> 
> 赞同：4
> 
> 时间：2012-12-27T19:14:39.807
> 
> 标签：java, import, compilation, package, symbols

我在编译时遇到了一些错误。
**我的目录结构是**

```
main_directory/src/MyClass.java
main_directory/lib/{some external jars} 
```

**我的编译脚本**：

```
#!/bin/csh -b
setenv LIB_DIR $PWD/lib/
set CLASSPATH="${LIB_DIR}commons-logging-1.1.1.jar:${LIB_DIR}google-api-client-1.12.0-beta.jar:${LIB_DIR}google-api-client-android-1.12.0-beta.jar:${LIB_DIR}google-api-client-appengine-1.12.0-beta.jar:${LIB_DIR}google-api-client-java6-1.12.0-beta.jar:${LIB_DIR}google-api-services-analytics-v3-rev21-1.12.0-beta.jar:${LIB_DIR}google-http-client-1.12.0-beta.jar:${LIB_DIR}google-http-client-android-1.12.0-beta.jar:${LIB_DIR}google-http-client-appengine-1.12.0-beta.jar:${LIB_DIR}google-http-client-gson-1.12.0-beta.jar:${LIB_DIR}google-http-client-jackson-1.12.0-beta.jar:${LIB_DIR}google-http-client-jackson2-1.12.0-beta.jar:${LIB_DIR}google-oauth-client-1.12.0-beta.jar:${LIB_DIR}google-oauth-client-appengine-1.12.0-beta.jar:${LIB_DIR}google-oauth-client-java6-1.12.0-beta.jar:${LIB_DIR}google-oauth-client-jetty-1.12.0-beta.jar:${LIB_DIR}google-oauth-client-servlet-1.12.0-beta.jar:${LIB_DIR}gson-2.1.jar:${LIB_DIR}guava-jdk5-13.0.jar:${LIB_DIR}httpclient-4.0.3.jar:${LIB_DIR}httpcore-4.0.1.jar:${LIB_DIR}jackson-core-2.0.5.jar:${LIB_DIR}jackson-core-asl-1.9.9.jar:${LIB_DIR}jdo2-api-2.3-eb.jar:${LIB_DIR}jetty-6.1.26.jar:${LIB_DIR}jetty-util-6.1.26.jar:${LIB_DIR}jsr305-1.3.9.jar:${LIB_DIR}transaction-api-1.1.jar:${LIB_DIR}xpp3-1.1.4c.jar:${LIB_DIR}"

javac -d bin -sourcepath src -cp $CLASSPATH src/*.java 
```

**这里也是我的来源的一部分：**

```
import com.google.api.client.auth.oauth2.Credential;
import com.google.api.client.googleapis.auth.oauth2.GoogleCredential;
import com.google.api.client.http.HttpTransport;
import com.google.api.client.http.javanet.NetHttpTransport;
import com.google.api.client.json.JsonFactory;
import com.google.api.client.json.jackson2.JacksonFactory;
import com.google.api.services.analytics.Analytics;
import com.google.api.services.analytics.AnalyticsScopes;
import com.google.api.services.analytics.model.GaData;
import com.google.api.services.analytics.model.GaData.ColumnHeaders;
import com.google.common.io.Files;
import java.io.File;
import java.io.IOException;
import java.nio.charset.Charset;
import java.util.List;

public class MyClass{

  /** E-mail address of the service account. */
  private static final String SERVICE_ACCOUNT_EMAIL = "something@something.com";
  /** Global instance of the HTTP transport. */
  private static final HttpTransport HTTP_TRANSPORT = new NetHttpTransport();

 /** Global instance of the JSON factory. */
 private static final JsonFactory JSON_FACTORY = new JacksonFactory();

  private static final String TABLE_ID = "gt:93359";

    //private static Plus plus;

  public static void main(String[] args) {
    try {
      try {
        // check for valid setup
        if (SERVICE_ACCOUNT_EMAIL.startsWith("Enter ")) {
          System.err.println(SERVICE_ACCOUNT_EMAIL);
          System.exit(1);
        }

 ... 
```

我在 main_directory 中运行我的编译脚本。并得到这些错误：

```
 error: error reading /tank/fmeng/myfolder/googleanaly/lib/commons-logging-1.1.1.jar; error in opening zip file
 src/PlusServiceAccountSample.java:17: package com.google.api.client.auth.oauth2 does     not exist
 import com.google.api.client.auth.oauth2.Credential;
                                     ^
 src/PlusServiceAccountSample.java:18: package     com.google.api.client.googleapis.auth.oauth2 does not exist
 import com.google.api.client.googleapis.auth.oauth2.GoogleCredential;
                                                ^
 src/PlusServiceAccountSample.java:19: package com.google.api.client.http does not exist
 import com.google.api.client.http.HttpTransport;
                              ^
 src/PlusServiceAccountSample.java:20: package com.google.api.client.http.javanet does not exist
 import com.google.api.client.http.javanet.NetHttpTransport;
                                      ^
 src/PlusServiceAccountSample.java:21: package com.google.api.client.json does not exist
 import com.google.api.client.json.JsonFactory;
                              ^
 src/PlusServiceAccountSample.java:22: package com.google.api.client.json.jackson2 does not exist
     import com.google.api.client.json.jackson2.JacksonFactory;
                                           ^
      src/PlusServiceAccountSample.java:23: package com.google.api.services.analytics does not exist
      import com.google.api.services.analytics.Analytics;
                                         ^
     src/PlusServiceAccountSample.java:24: package com.google.api.services.analytics does not exist
     import com.google.api.services.analytics.AnalyticsScopes;
                                         ^
      src/PlusServiceAccountSample.java:25: package com.google.api.services.analytics.model does not exist
      import com.google.api.services.analytics.model.GaData;
                                               ^
      src/PlusServiceAccountSample.java:26: package com.google.api.services.analytics.model.GaData does not exist
      import com.google.api.services.analytics.model.GaData.ColumnHeaders;
                                                      ^
      src/PlusServiceAccountSample.java:27: package com.google.common.io does not exist
      import com.google.common.io.Files;
                            ^
      src/PlusServiceAccountSample.java:42: cannot find symbol
      symbol  : class HttpTransport
      location: class PlusServiceAccountSample
      private static final HttpTransport HTTP_TRANSPORT = new NetHttpTransport();
                       ^
      src/PlusServiceAccountSample.java:45: cannot find symbol
     symbol  : class JsonFactory
     location: class PlusServiceAccountSample
      private static final JsonFactory JSON_FACTORY = new JacksonFactory();
                       ^
     src/PlusServiceAccountSample.java:118: cannot find symbol
         symbol  : class Analytics
         location: class PlusServiceAccountSample
          private static GaData executeDataQuery(Analytics analytics, String tableId) throws      IOException {
                                              ^
         src/PlusServiceAccountSample.java:118: cannot find symbol
    symbol  : class GaData
    location: class PlusServiceAccountSample
       private static GaData executeDataQuery(Analytics analytics, String tableId) throws IOException {
                  ^
src/PlusServiceAccountSample.java:131: cannot find symbol
symbol  : class GaData
location: class PlusServiceAccountSample
   private static void printGaData(GaData results) {
                                   ^
src/PlusServiceAccountSample.java:42: cannot find symbol
symbol  : class NetHttpTransport
location: class PlusServiceAccountSample
  private static final HttpTransport HTTP_TRANSPORT = new NetHttpTransport();
                                                          ^
src/PlusServiceAccountSample.java:45: cannot find symbol
symbol  : class JacksonFactory
location: class PlusServiceAccountSample
  private static final JsonFactory JSON_FACTORY = new JacksonFactory();
                                                      ^
src/PlusServiceAccountSample.java:60: cannot find symbol
symbol  : variable Files
location: class PlusServiceAccountSample
        String p12Content = Files.readFirstLine(new File("key.p12"), Charset.defaultCharset());
                            ^
src/PlusServiceAccountSample.java:71: cannot find symbol
symbol  : class GoogleCredential
location: class PlusServiceAccountSample
        GoogleCredential credential = new GoogleCredential.Builder().setTransport(HTTP_TRANSPORT)
        ^
src/PlusServiceAccountSample.java:74: cannot find symbol
symbol  : variable AnalyticsScopes
location: class PlusServiceAccountSample
            .setServiceAccountScopes(AnalyticsScopes.ANALYTICS)
                                     ^
src/PlusServiceAccountSample.java:71: package GoogleCredential does not exist
        GoogleCredential credential = new GoogleCredential.Builder().setTransport(HTTP_TRANSPORT)
                                                          ^
src/PlusServiceAccountSample.java:84: cannot find symbol
symbol  : class Analytics
location: class PlusServiceAccountSample
            Analytics analytics = new Analytics.Builder(HTTP_TRANSPORT, JSON_FACTORY, credential)
            ^
src/PlusServiceAccountSample.java:84: package Analytics does not exist
            Analytics analytics = new Analytics.Builder(HTTP_TRANSPORT, JSON_FACTORY, credential)
                                               ^
src/PlusServiceAccountSample.java:89: cannot find symbol
symbol  : class GaData
location: class PlusServiceAccountSample
            GaData gaData = executeDataQuery(analytics, TABLE_ID);
            ^
src/PlusServiceAccountSample.java:140: cannot find symbol
symbol  : class ColumnHeaders
location: class PlusServiceAccountSample
      for (ColumnHeaders header : results.getColumnHeaders()) {
           ^
27 errors 
```

一些帮助将不胜感激。谢谢！

类路径回显：

```
/tank/fmeng/myfolder/googleanaly/lib/commons-logging-1.1.1.jar:/tank/fmeng/myfolder/googleanaly/lib/google-api-client-1.12.0-beta.jar:/tank/fmeng/myfolder/googleanaly/lib/google-api-client-android-1.12.0-beta.jar:/tank/fmeng/myfolder/googleanaly/lib/google-api-client-appengine-1.12.0-beta.jar:/tank/fmeng/myfolder/googleanaly/lib/google-api-client-java6-1.12.0-beta.jar:/tank/fmeng/myfolder/googleanaly/lib/google-api-services-analytics-v3-rev21-1.12.0-beta.jar:/tank/fmeng/myfolder/googleanaly/lib/google-http-client-1.12.0-beta.jar:/tank/fmeng/myfolder/googleanaly/lib/google-http-client-android-1.12.0-beta.jar:/tank/fmeng/myfolder/googleanaly/lib/google-http-client-appengine-1.12.0-beta.jar:/tank/fmeng/myfolder/googleanaly/lib/google-http-client-gson-1.12.0-beta.jar:/tank/fmeng/myfolder/googleanaly/lib/google-http-client-jackson-1.12.0-beta.jar:/tank/fmeng/myfolder/googleanaly/lib/google-http-client-jackson2-1.12.0-beta.jar:/tank/fmeng/myfolder/googleanaly/lib/google-oauth-client-1.12.0-beta.jar:/tank/fmeng/myfolder/googleanaly/lib/google-oauth-client-appengine-1.12.0-beta.jar:/tank/fmeng/myfolder/googleanaly/lib/google-oauth-client-java6-1.12.0-beta.jar:/tank/fmeng/myfolder/googleanaly/lib/google-oauth-client-jetty-1.12.0-beta.jar:/tank/fmeng/myfolder/googleanaly/lib/google-oauth-client-servlet-1.12.0-beta.jar:/tank/fmeng/myfolder/googleanaly/lib/gson-2.1.jar:/tank/fmeng/myfolder/googleanaly/lib/guava-jdk5-13.0.jar:/tank/fmeng/myfolder/googleanaly/lib/httpclient-4.0.3.jar:/tank/fmeng/myfolder/googleanaly/lib/httpcore-4.0.1.jar:/tank/fmeng/myfolder/googleanaly/lib/jackson-core-2.0.5.jar:/tank/fmeng/myfolder/googleanaly/lib/jackson-core-asl-1.9.9.jar:/tank/fmeng/myfolder/googleanaly/lib/jdo2-api-2.3-eb.jar:/tank/fmeng/myfolder/googleanaly/lib/jetty-6.1.26.jar:/tank/fmeng/myfolder/googleanaly/lib/jetty-util-6.1.26.jar:/tank/fmeng/myfolder/googleanaly/lib/jsr305-1.3.9.jar:/tank/fmeng/myfolder/googleanaly/lib/transaction-api-1.1.jar:/tank/fmeng/myfolder/googleanaly/lib/xpp3-1.1.4c.jar:/tank/fmeng/myfolder/googleanaly/lib/ 
```

# ruby-on-rails - :order by has_many 协会最新条目？如何？

> ID：14059975
> 
> 赞同：0
> 
> 时间：2012-12-27T19:14:46.467
> 
> 标签：ruby-on-rails, ruby, postgresql

在您需要找到解决方案之前，rails 非常有趣，而且需要三天时间，但没有运气！;-(

如何按每个条目的 has_many 关联中的**最新条目排序？**

解释：

我`Video`通过关联的模型`Score`（带有字段`ranking_score`）对模型进行排名。数据库是一个postgreSQL。因为我会经常为视频添加分数，所以我需要按每个视频的最新分数条目对视频进行排序。

```
Video.all(:include => :scores, :order => "scores.ranking_score DESC") 
```

...按预期工作，直到我为视频添加新的分数条目（我不更新，因为我会有关于排名的统计数据）。

我还尝试了所有品种（DESC 和 ASC），我重新排序了优先级，但没有运气：

```
Video.all(:include => :scores, :order => "scores.created_at DESC, scores.ranking_score") 
```

和

```
Video.all(:include => :scores, :order => "scores.ranking_score, scores.created_at") 
```

等等。

我在网上搜索，试图找出 postgreSQL 命令等等。但是，作为一个菜鸟（现在在轨道上呆了 6 周），我需要帮助，拜托。

这是我的代码：

视频型号：

```
class Video < ActiveRecord::Base
  .
  has_many :scores
  .
end 
```

评分模型：

```
class Score < ActiveRecord::Base
  attr_accessible :ranking_score, :video_id
  belongs_to :video, :foreign_key => :video_id

  def position
    self.class.count( :conditions => ['ranking_score >= ?', self.ranking_score]) 
  end
end 
```

视频控制器：

```
class VideosController < ApplicationController

  def index
    setup_videos
    @video ||= Video.new

    respond_to do |format|
      format.html # show.html.erb
      format.json { render json: @video }
    end
  end
    .
  private
  def setup_videos
    @videos = Video.all(:include => :scores, :order => "scores.ranking_score DESC")
    @user = current_user
  end   
end 
```

如您所见，为了验证排名，我包含了一个方法位置，因为我需要一个特定于用户的视图，其中仅列出用户视频，但显示了总体排名（不同的问题，因为这样它不适用于每个条目的多个条目视频）

_ranking.html.erb（呈现在“索引”中）---没有 HTML 标签：

```
<% @videos.each.with_index do |video, index| %>
  <%= index.+1 %>
  ranking <%= video.scores.last.ranking_score %>
  postition <%= video.scores.last.position %>
<% end %>
<% @user.videos.count %> 
```

感谢您的时间！约翰

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T20:34:50.843

我无法理解您的要求。但是 - 你有没有想过缓存每个视频记录的最高排名？

您可以在视频中添加另一列，`highest_ranking`该列在 Score after_save 操作或类似操作中更新（取决于分数更新频率）。

这将为您省去加入乐谱以订购视频的麻烦。

# mysql - 大于一切

> ID：14059979
> 
> 赞同：1
> 
> 时间：2012-12-27T19:14:58.107
> 
> 标签：mysql

在 Brackendale 分行查找所有贷款大于所有贷款的客户的姓名。

这个可以吗？

```
Use University;

SELECT customer_name, loan_number
FROM loan NATURAL JOIN customer
HAVING MAX(amount) > ALL (SELECT sum(loan.amount)
FROM loan 
WHERE branch_name = 'Brakendale'); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T19:40:25.873

`ALL`是一个不需要的关键字 - 它什么也不做，因为它是集合的默认关键字（另一个关键字是`ANY`）。

省略更直接`ALL`。但是你可能想要一个 group by 并删除`loan_number`，否则每一行都必须在它自己的组中。

这个查询对我来说似乎更有意义：

```
SELECT customer_name, MAX(amount)
FROM loan
NATURAL JOIN customer
GROUP BY customer_name
HAVING MAX(amount) > (
  SELECT sum(loan.amount)
  FROM loan 
  WHERE branch_name = 'Brakendale'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T20:25:56.103

您可能想要`MAX`而不是`SUM`相反：

```
SELECT customer_name, loan_number
FROM loan NATURAL JOIN customer
HAVING SUM(amount) > (SELECT max(loan.amount)
                      FROM loan 
                      WHERE branch_name = 'Brakendale'
                     ); 
```

这将是“所有总贷款大于布雷肯代尔最大贷款的客户”。您的查询更像是“所有贷款总额大于布雷肯代尔所有未偿贷款总和的客户”。

您甚至可能想要“所有未偿还贷款大于布雷肯代尔任何客户的客户”。这将是：

```
SELECT customer_name, loan_number
FROM loan NATURAL JOIN customer
HAVING SUM(amount) > (SELECT max(l.CustomerLoans)
                      from (select customerID, sum(l.amount) as CustomerLoans
                            FROM loan l
                            WHERE branch_name = 'Brakendale'
                            group by customerID
                           ) l
                     ); 
```

# windows-phone-7 - app.xaml 中行的 TargetType

> ID：14059984
> 
> 赞同：0
> 
> 时间：2012-12-27T19:15:13.377
> 
> 标签：windows-phone-7

我创建了一条线来显示网格底线，如果我将它放在`page.xaml`. 我需要在 Orientation 期间更改线条，所以我在`app.xaml`. 但是它有`Application_UnhandledException`错误。我在页面上使用了没有 sytle 的代码，它可以工作。有人会告诉我如何使它工作。提前致谢。

```
<Line   X1="0" X2="700" Y1="0" Y2="0" Grid.Row="0" Grid.ColumnSpan="3" Grid.Column="0"
         VerticalAlignment="Bottom" Stroke="Blue" StrokeThickness="5"/> 
```

以下是 app.xaml 上 line 的样式

```
 <Style x:Key="queuePortraitLine" TargetType="Line">
        <Setter Property="X1" Value="0"/>
        <Setter Property="X2" Value="700"/>
        <Setter Property="Y1" Value="0"/>
        <Setter Property="Y2" Value="0"/>
        <Setter Property="VerticalAlignment" Value="Bottom"/>
        <Setter Property="Stroke" Value="Blue"/>
        <Setter Property="StrokeThickness" Value="5"/>            
    </Style> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T19:25:04.787

我一次又一次地检查代码。最后我知道为什么我得到了错误，因为我使用了RelativeSource。我的页面中的样式应该是“StaticResource”。

# lucene - 如何提高单字符 PrefixQuery 的性能？

> ID：14059985
> 
> 赞同：2
> 
> 时间：2012-12-27T19:15:29.617
> 
> 标签：lucene, lucene.net

我有一个包含 150 万个文档的 RAMDirectory，我正在使用 PrefixQuery 搜索单个字段。当搜索文本长度为 3 个或更多字符时，搜索速度极快，不到 20 毫秒。但是当搜索文本的长度少于 3 个字符时，搜索可能需要整整 1 秒。

由于它是一项自动完成功能，并且用户以一个字符开头（并且结果确实是 1 个字符长度），因此我无法限制搜索文本的长度。

代码差不多：

```
var symbolCodeTopDocs = searcher.Search(new PrefixQuery(new Term("SymbolCode", searchText), 10); 
```

SymbolCode 是一个 NOT_ANALYZED 字段。Lucene.NET 版本是 3.0.3。

该示例已简化，我可能必须使用 BooleanQuery 在现实世界场景中应用额外的约束。

如何在这种特定情况下提高性能？这些单字符或双字符查询导致服务器停机。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T14:16:26.080

如果您还没有，请考虑从索引中删除停用词。

要了解停用词如何减慢 PrefixQuery 的速度，请考虑 PrefixQuery 的工作原理：它被重写为 BooleanQuery，其中包括索引中以 PrefixQuery 的术语开头的每个术语。例如`a*`变为`a OR and OR aardvark OR anchor OR ...`到目前为止，这还不错，即使有数千个术语，它也会表现得非常好。真正的消耗是当停用词喜欢`a`和`and`被包含时，因为它们可能会在索引中的每个文档中多次找到。这为搜索的收集/收集/评分部分创造了更多的工作，从而减慢了速度。

附带说明一下，纯粹从可用性的角度来看，我强烈建议*不要*在用户输入少于 2 或 3 个字符时运行自动完成搜索。我无法想象结果会是完全相关的。想象一下运行搜索`a*`- 无法判断哪些结果更相关。如果您必须向用户显示某些内容，请考虑使用评论中建议的 Jf Beaulac 之类的 n-gram 方法。

# php - php 中的 json_decode 和 utf8

> ID：14059991
> 
> 赞同：0
> 
> 时间：2012-12-27T19:15:44.047
> 
> 标签：php, json, utf-8

我在 php 中有一个大问题，那就是当我使用`json_encode`一些`utf8`字符串时，我在 json 数组中包含了一些字符串，然后将其插入到数据库中。从数据库中读取并使用后，`json_decode`我有一个字符串`"u062au0633u062a".`

使用`utf8_encode`或`decode`什么都不做，而且我的页面的编码是`utf-8`！我会感谢你的帮助。

提前致谢。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2015-01-09T16:03:06.110

[http://php.net/manual/pt_BR/function.addslashes.php](http://php.net/manual/pt_BR/function.addslashes.php)

前任：

```
$user->name = 'aaáá';
$user->email = 'emai@email.com';
mysql_query("INSERT INTO table (infojson) values (".**addslashes(json_encode($user))**."'')");** 
```