# StackOverflow 问答 13012000-13012999

# bash - shell 脚本：使用 awk，如果找到 string0，则写入 string1，否则写入 string2

> ID：13012000
> 
> 赞同：3
> 
> 时间：2012-10-22T12:59:03.217
> 
> 标签：bash, shell, awk

我有一系列目录

```
079/af3
100/af4
120/af3
  . 
  .
  . 
```

每个`???/af?`目录都包含一个很长的文件`results.stdout`。接近这个文件的结尾，可以找到字符串

```
 Normal termination: iterations complete! 
```

如果 af3 (resp. af4) 中的计算成功，则在文件中写入一条或多条错误消息。为了避免手动检查每个文件，我正在编写一个生成摘要文件的脚本：

```
 Massflow        af3      af4 
      079    Success  Failure
      100    Failure  Success
      120    Success  Success
        .      .       .
        .      .       . 
```

到目前为止，我已经能够烹饪以下内容：

```
#!/bin/bash

strlen="9" # want to keep the format flexible, instead than hardcode it
format0="%"$strlen"s %"$strlen"s %"$strlen"s\n"
# write the header of file summary
awk -v format="$format0" ' BEGIN { printf format, "Massflow", "af3", "af4"
                             } ' >> summary

for dir in ??? # loop on all the directories
do
    for j in 3 4 # loop on the two subdirs
    do
    result[$j]=$(tac $dir/af$j/results.stdout | awk '
    /TACOMA:- Normal termination: iterations complete!/ {success = 1; exit}
    END { if (success == 1)
              print "Success"
          else
              print "Failure"
        }')
    done
done
exit 
```

但是，我不知道如何编写摘要文件...我想将`result`数组传递给另一个 awk 程序，但 awk 不接受数组变量。有什么建议么？如果您认为我的编程风格、工具选择或两者都很糟糕，请随意更改方法甚至工具：)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-22T13:12:32.997

我只是`printf`循环时的结果：

```
printf 'Massflow        af3      af4\n'
for dir in $(find -maxdepth 1 -type d) # loop on all the directories
do
    printf '     %d  ' "$(printf '%s' "$dir" | sed -e 's/[^0-9]//g')"
    for j in 3 4 # loop on the two subdirs
    do
    result[$j]=$(tac $dir/af$j/tacoma.stdout | awk '
    /TACOMA:- Normal termination: iterations complete!/ {success = 1; exit}
    END { if (success == 1)
              print "Success"
          else
              print "Failure"
        }')
        printf '  %s' "$result[j]"
    done
    printf '\n'
done 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-22T13:22:31.070

首先，不要使用 tac，因为反转整个文件没有任何好处。只需将文件交给 awk。

您可以省略第二个 for 循环并保存两个结果并在之后打印它们：

```
for dir in ??? # loop on all the directories
do
    for j in 3 4; do
        af[$j]=$(awk '/TACOMA:- Normal termination: iterations complete!/ {success = 1; exit}
                   END { if (success == 1)
                             print "Success"
                         else
                             print "Failure"
                   }'  $dir/af$j/results.stdout)
     done

     awk -v format="$format0" "BEGIN { printf format, \"$dir\", \"${af[3]}\", \"${af[4]}\"; } " >> summary
done 
```

来自@EdMorton，`bash`只有没有`awk`：

```
for dir in ??? # loop on all the directories
do
    for j in 3 4; do
        if grep -q "TACOMA:- Normal termination: iterations complete!" "$dir/af$j/results.stdout"; then
            af[$j]="Success"
        else
            af[$j]="Failure"
        fi
     done

     printf "$format0" "$dir" "${af[3]}" "${af[4]}" >> summary
done 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-22T21:32:47.410

这是查看问题的另一种方法：使用`grep`而不是`awk`，并使用`column`来格式化输出。

```
isSuccess() {
    if tac "$1" | grep -q 'Normal termination: iterations complete'; then
        echo Success
    else
        echo Failure
    fi
}

{
    echo Massflow af3 af4
    for dir in ???; do
        echo "$dir" $(isSuccess "$dir/af3/results.stdout") $(isSuccess "$dir/af4/results.stdout")
    done
} | column -t 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-22T16:51:33.713

首先使用 find 或循环或任何您喜欢的方式构建输出文件列表，然后将整个列表传递给 awk，例如

```
for dirName in ???
do
   for subName in af3 af4
   do
      files="$files $dirName/$subName/results.stdout"
   done
done

awk '
FNR == 1 {
   split(FILENAME,dfA,"/")
   dirName = dfA[1]
   subName = dfA[2]
   dirNames[dirName]
   subNames[subName]
}

/Normal termination: iterations complete!/ {
   succ[dirName,subName]
}

END {
   printf "Massflow"
   for (subName in subNames) {
      printf "\t%s",subName
   }
   print ""

   for (dirName in dirNames) {
      printf "%s", dirName
      for (subName in subNames) {
         printf "\t%s", ( (dirName,subName) in succ ? "Success" : "Failure" )
      }
      print ""
   }
}
' $files 
```

请注意，我没有在末尾引用 $files ，因此它会为您的示例正确扩展。我刚刚编辑了我的答案，因为我看到目录结构是 dir/subdir/results.stdout 而不是我最初想到的 dir/file。

根据@DeltaIV 的回复评论版本

```
for dirName in ???
do
   for subName in af3 af4
   do
      files="$files $dirName/$subName/results.stdout"
   done
done

awk '
# FNR == 1 is true at the first line of each input file
FNR == 1 {

   split(FILENAME,dfA,"/")
   dirName = dfA[1]
   subName = dfA[2]

   # Use array dirNames as the set of all top level directory names
   # and array subNames as the set of all sub-directory names so later
   # we can loop through them all to produce output.
   dirNames[dirName]
   subNames[subName]
}

# Check if the current line of the current input file contains the
# success indication text.
/Normal termination: iterations complete!/ {

   # The success indication text was found in the current file so
   # updated array succ which is the set of all dirName/SubName
   # pairs that had the success indication in their results file.
   succ[dirName,subName]
}

# "END" is true after all input files have been processed.
END {

   # Print the header line consisting of Massflow followed by the
   # sub-directory names
   printf "Massflow"
   for (subName in subNames) {
      printf "\t%s",subName
   }
   print ""

   # Loop through the set of dirNames so you get one per row
   # and for each dirName process all sub-directory names
   for (dirName in dirNames) {
      printf "%s", dirName
      # Loop through the set of subNames and process each one
      # as a new tab-separated column of output
      for (subName in subNames) {
         # If the current dirName/subName combination is in the succ
         # set then print "Success", otherwise print "Failure".
         printf "\t%s", ( (dirName,subName) in succ ? "Success" : "Failure" )
      }
      # Move down to the next row of output.
      print ""
   }
}
' $files 
```

# php - 使用 jQuery 检查电子邮件地址是否已存在于数据库中并且 PHP.return false 不起作用？

> ID：13012001
> 
> 赞同：0
> 
> 时间：2012-10-22T12:59:06.043
> 
> 标签：php, javascript, jquery

> **可能重复：**
> [jquery ajax 返回：未定义](https://stackoverflow.com/questions/4580265/jquery-ajax-return-undefined)

我编写了以下代码来检查电子邮件是否已存在或不使用 jquery 和 jquery validate.jquery 用于电子邮件格式验证。我在**jquery 函数**中调用了 ****check-email.php** 文件。即使我的数据库中存在电子邮件地址，该操作也被调用并指向仪表板页面。实际上它不应该指向下一页，因为电子邮件已经存在。**我的**“return false;”** 在 jquery 函数中没有效果。即使它存在于 db 中，它也会转到下一页。我没有得到我错的地方？？？

这是我的代码

index.html:-

```
<form name="mysignupform" id="mysignupform" class="form-horizontal"  action="Dashboard" method="post">
  <div class="control-group">
    <label class="control-label" for="inputEmail" >Email</label>
    <div class="controls">
      <input type="text" name="email" id="inputEmail"  placeholder="Email" >
    </div>
  </div>
  <br/>
  <div class="control-group">

    <label class="control-label" for="inputPassword" >Password</label>

 <div class="controls">

 <input class="password" type="password" name="password" id="inputPassword" placeholder="Password">

    </div>

    </div>

    <div class="controls">
      <input type="hidden" id="body" name="body" value=""></input>
    </div>

  <div class="control-group">
    <div class="controls">

      <button type="submit" name="submit" id="signupsubmit"class="btn btn-inverse" onsubmit="return function(e)">Go to Dashboard</button>
    </div>
  </div>

</form> 
```

我的jQuery函数： -

```
<script>
         $(document).ready(function(){ //newly added 

           $('#signupsubmit').click(function() 

         {
             alert('in');

             var emailVal = $('#inputEmail').val(); // assuming this is a input text field

             alert(emailVal);
             $.post('check-email.php', {'email' : emailVal}, function(data) {

             if(data=='true') return false;
             else $('#mysignupform').submit();

          });

       });

    });
</script> 
```

我的支票-email.php:-

```
 $con = mysql_connect("localhost","root","");

   if (!$con)
  {
     die('Could not connect: ' . mysql_error());
  }
       mysql_select_db("mojiva", $con);

       $sql = "SELECT email FROM user_info WHERE email =".$_POST['email'];

       $select = mysql_query($sql,$con);

       $row = mysql_num_rows($select);

            if ($row > 0)  
          {
            echo 'true';  
          }
             else 
          {
             echo 'false';
          }

?> 
```

我在 $('#signupsubmit').click(function() 之后立即在 jquery 函数中尝试了 true false，此时此函数返回 true 有效。但是当 post 被调用时，它没有任何返回 false 的效果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T13:12:13.320

这可能是因为 return false 不是指表单而是指点击事件。

在表格上：

```
<form name="mysignupform" id="mysignupform" class="form-horizontal"  action="Dashboard" method="post" onsubmit="email_check($('#inputEmail').val())" > 
```

然后对于 JQuery：

```
<script>
         $(document).ready(function(){ //newly added 

          function check_email(emailVal){ 

         {
             alert('in');

             alert(emailVal);
             $.post('check-email.php', {'email' : emailVal}, function(data) {

             if(data=='true') return false;
             else return true;

          });

     }
    });
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T02:36:39.003

如果要停止表单提交，需要防止点击冒泡：

```
$('#signupsubmit').click(function(e) {
    e.preventDefault();
    // do your ajax here
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-22T13:25:00.600

尝试通过将“类型”从提交更改为按钮来更改此行。

```
<button type="button" name="submit" id="signupsubmit" class="btn btn-inverse" onsubmit="return function(e)">Go to Dashboard</button> 
```

# php - PHP/JavaScript OnMouseOver 链接不起作用

> ID：13012004
> 
> 赞同：2
> 
> 时间：2012-10-22T12:59:09.677
> 
> 标签：php, javascript, joomla, mouseover

我一直在研究一个脚本，以便在悬停时将图像更改为链接。

但是，无法单击该链接。光标确实变成了一个指针，我可以在浏览器的左下方看到链接，但是当我单击它时没有任何反应。

它似乎在 Firefox 中有效，而不是在任何其他浏览器中。鼠标右键-> 在新选项卡中打开，但是确实有效。

这是我的代码：

```
<script type="text/javascript"><!--
var guesta='<a href="<?php $menu = JSite::getMenu();$alias = $menu->getItem(115)->alias;echo $alias; ?>"><?php $menu = JSite::getMenu();$title = $menu->getItem(115)->title;echo $title; ?></a>';

function guest1(){
document.getElementById('guest1').innerHTML=guesta;
document.getElementById('guest1').style.background ='#01afae';
}
function guest1empty(){
document.getElementById('guest1').innerHTML='<img src="image.png" />';
document.getElementById('guest1').style.background ='#fdfdfd';
}
//-->
</script>
<style type="text/css">
.guest {
    width:70px;
    height:100px;
    background-color: #fdfdfd;
    color: #fdfdfd;
    text-align: center;
}
.guest a:link, .guest a:visited {
    color: #fdfdfd;
    text-decoration: none;
    line-height: 15px;
}
</style>
</head>

<body>
<div id="guest1" class="guest" onMouseOver="guest1()" onMouseOut="guest1empty()"><img src="image.png" /></div> 
```

链接中的 PHP 代码用于从 Joomla 检索菜单项别名和标题。

非常感谢您的帮助！

最好的问候，
杰罗姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T13:03:59.860

我建议实际使用 document.createElement("IMG") 和 document.createElement("A") 创建元素。这是知道元素将被正确创建的最可靠方法。然而，这对我来说似乎不是一个非常实用的方法。为什么您不只是将图像作为链接开始？为什么悬停状态来回改变它？最后，您是否尝试过回显 Joomla 返回值的内容以确保您甚至可以获取内容？框架可能*非常*复杂，因此很难弄清楚您到底在哪里遇到了错误。让我们知道！

# jquery - jQuery警报将焦点重置到不同的元素？

> ID：13012005
> 
> 赞同：0
> 
> 时间：2012-10-22T12:59:10.750
> 
> 标签：jquery, jquery-selectors

我有这个小提琴，当我按下制表符时，焦点应该设置在下一个元素上，但不是..这是代码..

```
<input type="text" style="font-size:12px;width:245px;" border-style="Solid" tabindex="3" id="txtCAddress" maxlength="100" name="txtCAddress" />
</br>

<input type="text" style="font-size:12px;width:245px;" border-style="Solid" tabindex="4" id="txtMobile" name="txtMobile"/>

</br>

<input type="text" style="font-size:12px;width:245px;" border-style="Solid" id="txtPriority" maxlength="300" name="txtPriority" tabindex="5" autocomplete="off" /> 
```

js是

```
$(document).ready(function(event) {
    $('#txtCAddress').keydown(function(e) {
        if ((e.which == 9)) {
            if ($('#txtCAddress').val() == '') {
                alert('me');
            }
        }
    });
}); 
```

当我`txtCAddress`用一些文本按 Tab 键时，没关系，焦点设置`txtMobile`为例外，但是当我在`txtCAddress`没有任何文本的情况下按 Tab 键时，警报很好，但焦点设置在`txtPriority`？

为什么重点不在`txtMobile`？

**编辑** js 小提琴

[http://jsfiddle.net/sXaMG/1/](http://jsfiddle.net/sXaMG/1/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T13:47:49.247

您不应该在 keydown 函数回调中使用 alert() 作为其覆盖事件默认行为，而是使用 console.log() 。由此看来，似乎工作得很好。

# c++ - 我是否被迫使用 .cgi 扩展名？

> ID：13012006
> 
> 赞同：0
> 
> 时间：2012-10-22T12:59:11.413
> 
> 标签：c++, cgi, cgi-bin

我将构建 CGI Web 应用程序并开始学习该技术。我想使用 C++。所以我启动了我的本地服务器并将一个简单的脚本放在我的`cgi-bin`文件夹中，使用（使用 Mac OS X）编译它`g++ test.cpp -o app`并尝试使用：`localhost/cgi-bin/app`. 它奏效了。

但是在网上阅读时，我不断看到将脚本编译（？）作为`.cgi`文件的示例。我是否被迫这样做？有什么不同？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T13:03:51.407

您不必指定 .cgi 扩展名。也就是说，请注意，此时选择使用 CGI 和 C++ 来开发交互式 Web 应用程序是非常不寻常的。在 90 年代的某个时候，人们几乎不再这样做了。并不是说永远没有理由这样做。但请注意。

# python - Python; 嵌套 '\t' 解析

> ID：13012007
> 
> 赞同：0
> 
> 时间：2012-10-22T12:59:11.720
> 
> 标签：python, parsing

所以我试图将原始字符串解析成一个列表（实际上很多）所以假设我有：

```
|[nothing detected] www.neopets.com/
        |status: (referer=http://www.google.com)saved 55189 bytes /fetch_d4cd213a56276ca726ddd437a1e75f1024ab7799
        |file: fetch_d4cd213a56276ca726ddd437a1e75f1024ab7799: 55189 bytes
        |file: decoding_367af53b4963986ecdeb9c09ce1a405b5b1ecd91: 68 bytes
        |[nothing detected] (script) images.neopets.com/js/common.js?v=6
            |status: (referer=http://www.google.com)saved 1523 bytes /fetch_8eeadcc08d4cb48c02dedf18648510b75190d1d7failure: [Errno 13] Permission denied: '/tmp/tmpsha1_8d7fb3ff1ef087c7ea2bf044dee294735a76ed4b.js'
            |file: fetch_8eeadcc08d4cb48c02dedf18648510b75190d1d7: 1523 bytes 
```

它遵循类似的模式，依此类推。假设选项卡的深度最多为 3。我正在尝试找到一种方法将其解析为每个子列表，因此在这种特殊情况下，它将是一个包含第一个“未检测到”的列表，然后是一个包含状态的列表，文件、文件和一个列表，其中包含下一个在其状态/文件结果中检测到的任何内容。（我知道我的措辞不是最好的，抱歉）。谢谢！

到目前为止，我已经尝试计算每一行中的 '\t'，并迭代整个事情，但我很困惑，因为我无法回到我的迭代中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T13:11:39.817

我认为你想要一个可以以各种方式遍历的数据结构——即一个知道包含它的列表的列表——这是我的尝试：

```
s = """|[nothing detected] www.neopets.com/
\t|status: (referer=http://www.google.com)saved 55189 bytes /fetch_d4cd213a56276ca726ddd437a1e75f1024ab7799
\t\t|file: fetch_d4cd213a56276ca726ddd437a1e75f1024ab7799: 55189 bytes
\t\t|file: decoding_367af53b4963986ecdeb9c09ce1a405b5b1ecd91: 68 bytes
\t\t|[nothing detected] (script) images.neopets.com/js/common.js?v=6
\t\t\t|status: (referer=http://www.google.com)saved 1523 bytes /fetch_8eeadcc08d4cb48c02dedf18648510b75190d1d7failure: [Errno 13] Permission denied: '/tmp/tmpsha1_8d7fb3ff1ef087c7ea2bf044dee294735a76ed4b.js'
\t\t|file: fetch_8eeadcc08d4cb48c02dedf18648510b75190d1d7: 1523 bytes""".splitlines()

class MyList(list):
    def __init__(self, parent):
        self.parent = parent
        list.__init__(self)

top = current = MyList(None)
ntab_old = 0
for line in s:
    ntab = line.count('\t') #may need to be more robust to get tabs only at beginning
    if(ntab_old > ntab):
        #go up ntab_old - ntab levels.
        for _ in range(ntab_old - ntab):
            current = current.parent
    elif(ntab_old < ntab):
        #increased indentation means we want a new list
        current.append(MyList(current))
        current = current[-1]
    current.append(line)
    ntab_old = ntab

print top 
```

# java - 在点、() 和 new 上出现错误

> ID：13012009
> 
> 赞同：0
> 
> 时间：2012-10-22T12:59:37.647
> 
> 标签：java, android, ant

我想编译一个 GCM 服务器的修改版本。

但是我遇到了我无法解释的错误。

```
/*
 * Copyright 2012 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not
 * use this file except in compliance with the License. You may obtain a copy of
 * the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package com.google.android.gcm.demo.server;

import com.google.android.gcm.server.Constants;
import com.google.android.gcm.server.Message;
import com.google.android.gcm.server.MulticastResult;
import com.google.android.gcm.server.Result;
import com.google.android.gcm.server.Sender;

import java.io.IOException;
import java.util.ArrayList;
import java.util.List;
import java.util.concurrent.Executor;
import java.util.concurrent.Executors;
import java.util.logging.Level;

import javax.servlet.ServletConfig;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

/**
 * Servlet that adds a new message to all registered devices.
 * <p>
 * This servlet is used just by the browser (i.e., not device).
 */
@SuppressWarnings("serial")
public class SendAllMessagesServlet extends BaseServlet {

  private static final int MULTICAST_SIZE = 1000;

  private Sender sender;

  private static final Executor threadPool = Executors.newFixedThreadPool(5);

  @Override
  public void init(ServletConfig config) throws ServletException {
    super.init(config);
    sender = newSender(config);
  }

  /**
   * Creates the {@link Sender} based on the servlet settings.
   */
  protected Sender newSender(ServletConfig config) {
    String key = (String) config.getServletContext()
        .getAttribute(ApiKeyInitializer.ATTRIBUTE_ACCESS_KEY);
    return new Sender(key);
  }

  /**
   * Processes the request to add a new message.
   */
  @Override
  protected void doPost(HttpServletRequest req, HttpServletResponse resp)
      throws IOException, ServletException {
    List<String> devices = Datastore.getDevices();
    String status;
    if (devices.isEmpty()) {
      status = "Message ignored as there is no device registered!";
    } else {
      // NOTE: check below is for demonstration purposes; a real application
      // could always send a multicast, even for just one recipient
      if (devices.size() == 1) {
        // send a single message using plain post
        String registrationId = devices.get(0);
        Message message = new Message.Builder();
//MY LANES
        message.setData("echo", req.getAttribute("message").toString());
        message.build();
//END
        Result result = sender.send(message, registrationId, 5);
        status = "Sent message to one device: " + result;
      } else {
        // send a multicast message using JSON
        // must split in chunks of 1000 devices (GCM limit)
        int total = devices.size();
        List<String> partialDevices = new ArrayList<String>(total);
        int counter = 0;
        int tasks = 0;
        for (String device : devices) {
          counter++;
          partialDevices.add(device);
          int partialSize = partialDevices.size();
          if (partialSize == MULTICAST_SIZE || counter == total) {

            msg = req.getAttribute("message");
            asyncSend(partialDevices);
            partialDevices.clear();
            tasks++;
          }
        }
        status = "Asynchronously sending " + tasks + " multicast messages to " +
            total + " devices";
      }
    }
    req.setAttribute(HomeServlet.ATTRIBUTE_STATUS, status.toString());
    getServletContext().getRequestDispatcher("/home").forward(req, resp);
  }

  public String msg = "";

  private void asyncSend(List<String> partialDevices) {
    // make a copy
    final List<String> devices = new ArrayList<String>(partialDevices);
    threadPool.execute(new Runnable() {

      public void run() {
        Message message = new Message.Builder();
//MY LANES
         message.setData("echo", msg);
         message.build();
//END
        MulticastResult multicastResult;
        try {
          multicastResult = sender.send(message, devices, 5);
        } catch (IOException e) {
          logger.log(Level.SEVERE, "Error posting messages", e);
          return;
        }
        List<Result> results = multicastResult.getResults();
        // analyze the results
        for (int i = 0; i < devices.size(); i++) {
          String regId = devices.get(i);
          Result result = results.get(i);
          String messageId = result.getMessageId();
          if (messageId != null) {
            logger.fine("Succesfully sent message to device: " + regId +
                "; messageId = " + messageId);
            String canonicalRegId = result.getCanonicalRegistrationId();
            if (canonicalRegId != null) {
              // same device has more than on registration id: update it
              logger.info("canonicalRegId " + canonicalRegId);
              Datastore.updateRegistration(regId, canonicalRegId);
            }
          } else {
            String error = result.getErrorCodeName();
            if (error.equals(Constants.ERROR_NOT_REGISTERED)) {
              // application has been removed from device - unregister it
              logger.info("Unregistered device: " + regId);
              Datastore.unregister(regId);
            } else {
              logger.severe("Error sending message to " + regId + ": " + error);
            }
          }
        }
      }});
  }

} 
```

编译器的响应在这里：

```
C:\Users\Sebastian Reuther\android-sdks\extras\google\gcm\samples\gcm-demo-serve
r>"C:\Users\Sebastian Reuther\android-sdks\extras\google\gcm\samples\apache-ant-
1.8.4\bin\ant" war
Buildfile: C:\Users\Sebastian Reuther\android-sdks\extras\google\gcm\samples\gcm
-demo-server\build.xml

init:

compile:
    [javac] Compiling 1 source file to C:\Users\Sebastian Reuther\android-sdks\e
xtras\google\gcm\samples\gcm-demo-server\build\classes
    [javac]
    [javac]           WARNING
    [javac]
    [javac] The -source switch defaults to 1.7 in JDK 1.7.
    [javac] If you specify -target 1.5 you now must also specify -source 1.5.
    [javac] Ant will implicitly add -source 1.5 for you.  Please change your bui
ld file.
    [javac] warning: java\io\IOException.class(java\io:IOException.class): major
 version 51 is newer than 50, the highest major version supported by this compil
er.
    [javac] It is recommended that the compiler be upgraded.
    [javac] warning: java\util\ArrayList.class(java\util:ArrayList.class): major
 version 51 is newer than 50, the highest major version supported by this compil
er.
    [javac] It is recommended that the compiler be upgraded.
    [javac] warning: java\util\List.class(java\util:List.class): major version 5
1 is newer than 50, the highest major version supported by this compiler.
    [javac] It is recommended that the compiler be upgraded.
    [javac] warning: java\util\concurrent\Executor.class(java\util\concurrent:Ex
ecutor.class): major version 51 is newer than 50, the highest major version supp
orted by this compiler.
    [javac] It is recommended that the compiler be upgraded.
    [javac] warning: java\util\concurrent\Executors.class(java\util\concurrent:E
xecutors.class): major version 51 is newer than 50, the highest major version su
pported by this compiler.
    [javac] It is recommended that the compiler be upgraded.
    [javac] warning: java\util\logging\Level.class(java\util\logging:Level.class
): major version 51 is newer than 50, the highest major version supported by thi
s compiler.
    [javac] It is recommended that the compiler be upgraded.
    [javac] warning: java\io\Serializable.class(java\io:Serializable.class): maj
or version 51 is newer than 50, the highest major version supported by this comp
iler.
    [javac] It is recommended that the compiler be upgraded.
    [javac] warning: java\lang\Object.class(java\lang:Object.class): major versi
on 51 is newer than 50, the highest major version supported by this compiler.
    [javac] It is recommended that the compiler be upgraded.
    [javac] warning: java\lang\SuppressWarnings.class(java\lang:SuppressWarnings
.class): major version 51 is newer than 50, the highest major version supported
by this compiler.
    [javac] It is recommended that the compiler be upgraded.
    [javac] warning: java\lang\String.class(java\lang:String.class): major versi
on 51 is newer than 50, the highest major version supported by this compiler.
    [javac] It is recommended that the compiler be upgraded.
    [javac] warning: java\lang\annotation\Target.class(java\lang\annotation:Targ
et.class): major version 51 is newer than 50, the highest major version supporte
d by this compiler.
    [javac] It is recommended that the compiler be upgraded.
    [javac] warning: java\lang\annotation\ElementType.class(java\lang\annotation
:ElementType.class): major version 51 is newer than 50, the highest major versio
n supported by this compiler.
    [javac] It is recommended that the compiler be upgraded.
    [javac] warning: java\lang\annotation\Retention.class(java\lang\annotation:R
etention.class): major version 51 is newer than 50, the highest major version su
pported by this compiler.
    [javac] It is recommended that the compiler be upgraded.
    [javac] warning: java\lang\annotation\RetentionPolicy.class(java\lang\annota
tion:RetentionPolicy.class): major version 51 is newer than 50, the highest majo
r version supported by this compiler.
    [javac] It is recommended that the compiler be upgraded.
    [javac] warning: java\lang\annotation\Annotation.class(java\lang\annotation:
Annotation.class): major version 51 is newer than 50, the highest major version
supported by this compiler.
    [javac] It is recommended that the compiler be upgraded.
    [javac] warning: java\lang\Override.class(java\lang:Override.class): major v
ersion 51 is newer than 50, the highest major version supported by this compiler
.
    [javac] It is recommended that the compiler be upgraded.
    [javac] warning: java\lang\Error.class(java\lang:Error.class): major version
 51 is newer than 50, the highest major version supported by this compiler.
    [javac] It is recommended that the compiler be upgraded.
    [javac] warning: java\lang\Exception.class(java\lang:Exception.class): major
 version 51 is newer than 50, the highest major version supported by this compil
er.
    [javac] It is recommended that the compiler be upgraded.
    [javac] warning: java\lang\Throwable.class(java\lang:Throwable.class): major
 version 51 is newer than 50, the highest major version supported by this compil
er.
    [javac] It is recommended that the compiler be upgraded.
    [javac] warning: java\lang\RuntimeException.class(java\lang:RuntimeException
.class): major version 51 is newer than 50, the highest major version supported
by this compiler.
    [javac] It is recommended that the compiler be upgraded.
    [javac] warning: java\util\concurrent\ExecutorService.class(java\util\concur
rent:ExecutorService.class): major version 51 is newer than 50, the highest majo
r version supported by this compiler.
    [javac] It is recommended that the compiler be upgraded.
    [javac] warning: java\util\Collection.class(java\util:Collection.class): maj
or version 51 is newer than 50, the highest major version supported by this comp
iler.
    [javac] It is recommended that the compiler be upgraded.
    [javac] warning: java\lang\Iterable.class(java\lang:Iterable.class): major v
ersion 51 is newer than 50, the highest major version supported by this compiler
.
    [javac] It is recommended that the compiler be upgraded.
    [javac] C:\Users\Sebastian Reuther\android-sdks\extras\google\gcm\samples\gc
m-demo-server\src\com\google\android\gcm\demo\server\SendAllMessagesServlet.java
:81: incompatible types
    [javac] found   : com.google.android.gcm.server.Message.Builder
    [javac] required: com.google.android.gcm.server.Message
    [javac]         Message message = new Message.Builder();
    [javac]                           ^
    [javac] C:\Users\Sebastian Reuther\android-sdks\extras\google\gcm\samples\gc
m-demo-server\src\com\google\android\gcm\demo\server\SendAllMessagesServlet.java
:82: cannot find symbol
    [javac] symbol  : method setData(java.lang.String,java.lang.String)
    [javac] location: class com.google.android.gcm.server.Message
    [javac]         message.setData("echo", req.getAttribute("message").toString
());
    [javac]                ^
    [javac] C:\Users\Sebastian Reuther\android-sdks\extras\google\gcm\samples\gc
m-demo-server\src\com\google\android\gcm\demo\server\SendAllMessagesServlet.java
:83: cannot find symbol
    [javac] symbol  : method build()
    [javac] location: class com.google.android.gcm.server.Message
    [javac]         message.build();
    [javac]                ^
    [javac] warning: java\lang\Comparable.class(java\lang:Comparable.class): maj
or version 51 is newer than 50, the highest major version supported by this comp
iler.
    [javac] It is recommended that the compiler be upgraded.
    [javac] warning: java\lang\CharSequence.class(java\lang:CharSequence.class):
 major version 51 is newer than 50, the highest major version supported by this
compiler.
    [javac] It is recommended that the compiler be upgraded.
    [javac] warning: java\util\AbstractList.class(java\util:AbstractList.class):
 major version 51 is newer than 50, the highest major version supported by this
compiler.
    [javac] It is recommended that the compiler be upgraded.
    [javac] warning: java\util\AbstractCollection.class(java\util:AbstractCollec
tion.class): major version 51 is newer than 50, the highest major version suppor
ted by this compiler.
    [javac] It is recommended that the compiler be upgraded.
    [javac] C:\Users\Sebastian Reuther\android-sdks\extras\google\gcm\samples\gc
m-demo-server\src\com\google\android\gcm\demo\server\SendAllMessagesServlet.java
:99: incompatible types
    [javac] found   : java.lang.Object
    [javac] required: java.lang.String
    [javac]             msg = req.getAttribute("message");
    [javac]                                   ^
    [javac] warning: java\lang\Runnable.class(java\lang:Runnable.class): major v
ersion 51 is newer than 50, the highest major version supported by this compiler
.
    [javac] It is recommended that the compiler be upgraded.
    [javac] C:\Users\Sebastian Reuther\android-sdks\extras\google\gcm\samples\gc
m-demo-server\src\com\google\android\gcm\demo\server\SendAllMessagesServlet.java
:121: incompatible types
    [javac] found   : com.google.android.gcm.server.Message.Builder
    [javac] required: com.google.android.gcm.server.Message
    [javac]         Message message = new Message.Builder();
    [javac]                           ^
    [javac] C:\Users\Sebastian Reuther\android-sdks\extras\google\gcm\samples\gc
m-demo-server\src\com\google\android\gcm\demo\server\SendAllMessagesServlet.java
:122: cannot find symbol
    [javac] symbol  : method setData(java.lang.String,java.lang.String)
    [javac] location: class com.google.android.gcm.server.Message
    [javac]          message.setData("echo", msg);
    [javac]                 ^
    [javac] C:\Users\Sebastian Reuther\android-sdks\extras\google\gcm\samples\gc
m-demo-server\src\com\google\android\gcm\demo\server\SendAllMessagesServlet.java
:123: cannot find symbol
    [javac] symbol  : method build()
    [javac] location: class com.google.android.gcm.server.Message
    [javac]          message.build();
    [javac]                 ^
    [javac] warning: java\util\logging\Logger.class(java\util\logging:Logger.cla
ss): major version 51 is newer than 50, the highest major version supported by t
his compiler.
    [javac] It is recommended that the compiler be upgraded.
    [javac] warning: java\util\logging\LogRecord.class(java\util\logging:LogReco
rd.class): major version 51 is newer than 50, the highest major version supporte
d by this compiler.
    [javac] It is recommended that the compiler be upgraded.
    [javac] 7 errors
    [javac] 30 warnings

BUILD FAILED
C:\Users\Sebastian Reuther\android-sdks\extras\google\gcm\samples\gcm-demo-serve
r\build.xml:52: Compile failed; see the compiler error output for details.

Total time: 0 seconds 
```

有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T13:03:44.233

似乎您使用的库 / JDK 与您的库编译的库之间存在版本冲突。

# android - 以编程方式禁用轨迹球

> ID：13012020
> 
> 赞同：0
> 
> 时间：2012-10-22T13:00:05.420
> 
> 标签：android, events, trackball

> **可能重复：**
> [在 Android 中禁用轨迹球点击](https://stackoverflow.com/questions/3423948/disable-trackball-click-in-android)

有没有办法以编程方式完全禁用轨迹球交互？我不需要我的应用程序来响应轨迹球事件。此刻我把

`public boolean dispatchTrackballEvent(final MotionEvent ev) { return true; }`

在我的活动中，但有时我仍然会收到这些事件。请帮忙！提前致谢。

# ios - 跟踪移动 Facebook 广告以创建用户群

> ID：13012025
> 
> 赞同：2
> 
> 时间：2012-10-22T13:00:17.573
> 
> 标签：ios, facebook

我正在开发与 Facebook SDK 集成的 iOS 应用程序。是否可以检查特定用户是否通过
[Facebook 移动广告](https://developers.facebook.com/docs/concepts/mobile-ads/)获得了刚刚连接到我的 Facebook 应用的用户？

这对于为每个广告创建一个同类群组非常有用。我知道[http://apsalar.com/](http://apsalar.com/)正在使用他们的 ApEngage 产品做到这一点。

# c++ - SOIL：使用 Xcode 在 C++ 和 OpenGL 中“无法打开文件”

> ID：13012026
> 
> 赞同：2
> 
> 时间：2012-10-22T13:00:17.350
> 
> 标签：c++, xcode, opengl, soil

我正在尝试使用 SOIL 加载纹理文件。我尝试从项目文件中加载图像，也尝试从文件系统中加载图像。当我尝试从项目中加载我的图像时，`SOIL_last_result()`出现错误：

> 无法打开文件

但应用程序无论如何都会运行。

当我在我的系统中输入图像的完整路径时，我得到（当我构建项目时）：

[![懒惰的](../Images/e8ccb15c61142fe4a4d1bcdb28316bfd.png)](https://i.stack.imgur.com/WyT7P.png)

我不知道那里出了什么问题。我读到它可能是代码中存在任何其他错误，这就是我在这一点上遇到问题的原因。

这是整个代码：

```
#include <stdlib.h>
#include <stdio.h>
#include <GLUT/glut.h>
#include "SOIL.h"

float boxX = 0.0f;
float boxY = 0.0f;

bool* keyStates = new bool[256];
bool* keySpecialStates = new bool[246];

int windowId = 0;

GLuint texture[1];

int LoadGLTextures()
{
    /* load an image file directly as a new OpenGL texture */
    texture[0] = SOIL_load_OGL_texture
    (
     //"Data/colonel_hapablap.jpg",
     "/Users/Thomas/Pictures/colonel_hapablap.jpg",
     SOIL_LOAD_AUTO,
     SOIL_CREATE_NEW_ID,
     SOIL_FLAG_INVERT_Y
    );

    if(texture[0] == 0)
    {
        printf( "SOIL loading error: '%s'\n", SOIL_last_result() );
        return false;
    }

    // Typical Texture Generation Using Data From The Bitmap
    glBindTexture(GL_TEXTURE_2D, texture[0]);
    glTexParameteri(GL_TEXTURE_2D,GL_TEXTURE_MIN_FILTER,GL_LINEAR);
    glTexParameteri(GL_TEXTURE_2D,GL_TEXTURE_MAG_FILTER,GL_LINEAR);

    return true;
}

// key is pressed
void keyPressed(unsigned char key, int x, int y)
{
    keyStates[key] = true;
}

// key is released
void keyUp(unsigned char key, int x, int y)
{
    keyStates[key] = false;
}

void keySpecialPressed(int key, int x, int y)
{
    keySpecialStates[key] = true;
}

void keySpecialUp(int key, int x, int y)
{
    keySpecialStates[key] = false;
}

void keyOperations(void)
{
    if(keySpecialStates[GLUT_KEY_LEFT])
    {
        boxX -= 0.1f;
    }

    if(keySpecialStates[GLUT_KEY_RIGHT])
    {
        boxX += 0.1f;
    }

    if(keySpecialStates[GLUT_KEY_UP])
    {
        boxY += 0.1f;
    }

    if(keySpecialStates[GLUT_KEY_DOWN])
    {
        boxY -= 0.1f;
    }

    if(keyStates['q'])
    {
        glutDestroyWindow(windowId);
        exit(0);
    }
}

void display(void)
{
    keyOperations();

    int windowWidth = glutGet(GLUT_WINDOW_WIDTH);
    int windowHeight = glutGet(GLUT_WINDOW_HEIGHT);

    if(boxX > windowWidth)
    {
        boxX -= windowWidth;
    }

    if(boxX < 0)
    {
        boxX = windowWidth;
    }

    if(boxY > windowHeight)
    {
        boxY -= windowHeight;
    }

    if(boxY < 0)
    {
        boxY = windowHeight;
    }

    glEnable(GL_TEXTURE_2D);
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

    glPushMatrix();
    glTranslatef(boxX, boxY, 0.0f);

    glBegin(GL_QUADS);

    LoadGLTextures();

    //glColor3f(0.0f, 1.0f, 0.0f);
    glVertex2f(0.0f,   128.0f);
    glVertex2f(128.0f, 128.0f);
    glVertex2f(128.0f, 256.0f);
    glVertex2f(0.0f,   256.0f);
    glEnd();

    glPopMatrix();

    glutSwapBuffers();
}

void reshape(int width, int height)
{
    glViewport(0, 0, width, height);

    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    gluOrtho2D(0, width, 0, height);
    glMatrixMode(GL_MODELVIEW);
}

void idle(void)
{
    glutPostRedisplay();
}

int main(int argc, char** argv)
{
    glutInit(&argc, argv);

    glutInitDisplayMode(GLUT_RGBA | GLUT_DOUBLE | GLUT_DEPTH);
    glutInitWindowSize(640, 480);

    windowId = glutCreateWindow("GLUT Program");

    //glutFullScreen();

    glutKeyboardFunc(keyPressed);
    glutKeyboardUpFunc(keyUp);
    glutSpecialFunc(keySpecialPressed);
    glutSpecialUpFunc(keySpecialUp);
    glutDisplayFunc(display);
    glutReshapeFunc(reshape);
    glutIdleFunc(idle);

    glutMainLoop();
    return EXIT_SUCCESS;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T00:07:33.947

好的，经过数小时的 Xcode 搜索和玩游戏，我终于明白了......

第一个问题是 Xcode 中项目导航器中的图像资源在构建后不会自动出现在您的应用程序路径中。因此，您必须在项目导航器中单击您的项目（它是项目导航器中所有文件的根目录）。然后选择您的目标，单击“构建阶段”选项卡。现在重要的是添加一个全新的构建阶段！单击“添加构建阶段”按钮并选择“添加复制文件”。您将获得一个新的“复制文件”元素。目的地应自动为“资源”。现在单击“+”并添加您要在应用程序中使用的所有图像文件。它们现在将在构建时复制到您的应用程序路径，或者如果您已设置，则复制到子路径。

第二个问题是 EXC_BAD_ACCESS ... LoadGLTextures() 函数只是在错误的地方...新代码（只是主函数改变了，所以我只是粘贴主函数）是：

```
int main(int argc, char** argv)
{
    glutInit(&argc, argv);

    glutInitDisplayMode(GLUT_RGBA | GLUT_DOUBLE | GLUT_DEPTH);
    glutInitWindowSize(640, 480);

    windowId = glutCreateWindow("GLUT Program");

    LoadGLTextures();

    //glutFullScreen();

    glutKeyboardFunc(keyPressed);
    glutKeyboardUpFunc(keyUp);
    glutSpecialFunc(keySpecialPressed);
    glutSpecialUpFunc(keySpecialUp);
    glutDisplayFunc(display);
    glutReshapeFunc(reshape);
    glutIdleFunc(idle);

    glutMainLoop();
    return EXIT_SUCCESS;
} 
```

# html - Google Pagespeed 和压缩建议 - 我该怎么做？

> ID：13012028
> 
> 赞同：1
> 
> 时间：2012-10-22T13:00:25.293
> 
> 标签：html, css, compression, pagespeed

> 启用压缩
> 
> 使用 gzip 或 deflate 压缩资源可以减少通过网络发送的字节数。

Google Pagespeed 为我提供了上述建议，以加快我的网站加载速度。我很想这样做，但我不确定如何去做。我是否在本地压缩文件然后上传这些文件？或者它是服务器端的东西？

如果是这样，我仍然可以轻松编辑文件吗？还是用压缩的行话？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T13:08:24.287

它是一种服务器端压缩。请在线阅读有关 gzip 压缩的更多信息，以便您正确理解。它使用您的服务器资源，因此并非在所有情况下都建议使用它。

这可以通过 .htaccess 轻松完成。您可以在此处阅读有关在 Apache 服务器上启用它的信息：[http ://www.techiepark.com/tutorials/how-to-enable-gzip-compression-in-apache-server-to-speed-up-website/](http://www.techiepark.com/tutorials/how-to-enable-gzip-compression-in-apache-server-to-speed-up-website/)

最好的方法是联系您的服务器管理员。他们还可以就您的服务器设置和站点资源使用提供很好的建议。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-22T13:07:57.047

您的文件不会发生任何变化，但如果您在服务器端启用压缩，您的服务器将在将其输出发送到客户端（通常是某些人的浏览器）之前对其进行压缩。这将降低服务器和客户端之间的流量，因此，您的网站速度将会提高。

更多信息在[这里](http://en.wikipedia.org/wiki/HTTP_compression)。

还应该考虑到 Web 服务器将花费额外的时间和 CPU 资源来压缩输出。虽然通常开销很小，但如果客户端数量足够大，它可能会成为潜在瓶颈的原因。

如果您使用的是 php，您可以[`ob_start()`](http://php.net/manual/en/function.ob-start.php)通过设置[`ob_gzhandler()`](http://php.net/manual/en/function.ob-gzhandler.php)回调函数来压缩输出：

```
<?php
    ob_start("ob_gzhandler");
?>
<html>
    <body>
        <p>This should be a compressed page.</p>
    </body>
</html> 
```

或者，您可以启用[`mod_deflate`](http://httpd.apache.org/docs/2.2/mod/mod_deflate.html)并让 Apache Web 服务器自行压缩输出。

# android - 和引擎精灵移动

> ID：13012029
> 
> 赞同：0
> 
> 时间：2012-10-22T13:00:29.907
> 
> 标签：android, sprite, andengine

我有移动精灵的问题。我将事件附加`onAreaTouch()`到几个精灵。在此事件中，还有两个事件。第一，`isActionMove()`第二`isActionUp()`。

当我拖动一个精灵时，如果它穿过另一个精灵，事件就会离开精灵并开始拖动另一个精灵。我怎样才能避免这种情况？

如果我快速向上拖动，`isActionUp()`则方法不起作用，但如果我缓慢向上拖动，`isActionUp()`则方法有效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-24T12:47:56.450

采用

```
mScene.setTouchAreaBindingOnActionDownEnabled(true); 
```

在从 onCreateScene() 方法返回场景对象之前。

# installation - 为什么 JRE 安装程序中没有压缩所有 jar 文件？

> ID：13012031
> 
> 赞同：8
> 
> 时间：2012-10-22T13:00:32.060
> 
> 标签：installation, compression, java

我使用 7zip 解压 jre-6u12-windows-i586-p.exe（Oracle JRE 安装程序）。解压后，我得到了一个 core.zip、一个 zipper.exe 和一些其他文件。

再次在爆炸 core.zip 上我发现了一些东西。core.zip 包含所有 jar 文件，就像安装后一样，除了 7 个 jar 文件。

```
charsets.jar
deploy.jar
javaws.jar
jsse.jar
localedata.jar
plugin.jar
rt.jar 
```

除了这些 jar 文件，还存在相应的包文件

```
charsets.pack
deploy.pack
javaws.pack
jsse.pack
localedata.pack
plugin.pack
rt.pack 
```

我认为这些是 pack200.exe 创建的文件，安装后在它们上运行 unpack200.exe 以创建相应的 jar 文件。

所以现在我有几个问题

1.  为什么只有这7个文件通过pack200.exe运行。我认为是因为它们比其他文件大。但是打包所有 jar 文件并在安装后解压它们不会花费太多精力。

2.  .pack 扩展名表明这些已打包但未压缩。同样，为什么 Oracle 也不做 gzip 呢？例如，使用 rt.jar 打包将大小从 45 MB 减小到 12 MB，而添加 gzip 也将其减小到 6 MB。

# sql - 同一 SQL Server 上的多个数据库 (MS SQL)

> ID：13012032
> 
> 赞同：0
> 
> 时间：2012-10-22T13:00:36.017
> 
> 标签：sql, sql-server-2005

我有一个 SQL Server，上面有大约 100 个数据库。大多数数据库都遵循相同的架构，例如，它们有一个名为 dbo.Files 的表。

我想编写一个查询，它将返回所有数据库中所有 dbo.Files 的 UNIONed 结果，但没有专门引用表本身（太多了！）。我已经设法创建了一些动态 SQL，但这似乎很笨拙，我需要开发它。

```
SELECT 'SELECT count(*) FROM ' + '[' + name + ']' + '.dbo.Files'    
FROM master..sysdatabases 
```

该查询还应该考虑到并非所有数据库都有一个 dbo.Files 表这一事实（并且可能会输出一行这么多的内容）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-22T13:11:49.613

变量对象名称需要使用动态 SQL，`sp_MSforeachdb`可以简化这一点：

```
sp_MSforeachdb 'USE [?]
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.tables WHERE TABLE_NAME = ''Files'' AND TABLE_TYPE = ''BASE TABLE'' AND TABLE_SCHEMA = ''dbo'')
    PRINT ''SELECT count(*) FROM [?].dbo.Files''
ELSE
    PRINT ''no table in ?''
' 
```

（`?`替换为每个数据库名称）

# java - 多对多关联（BeanList 延迟）

> ID：13012044
> 
> 赞同：5
> 
> 时间：2012-10-22T13:01:27.383
> 
> 标签：java, playframework, ebean

我有一个这样的多对多关联：

```
@Entity
public class User extends Model implements RoleHolder {
  @ManyToMany(cascade=CascadeType.ALL) 
  public List<Task> tasks;
} 
```

然后我这样做：

```
User u = Application.getLocalUser(session());
u.tasks.clear();
for (Task t : tasksToAdd)
  u.tasks.add(t);
u.saveManyToManyAssociations("tasks");
u.update() 
```

但是当我尝试在我的 Controller-Action 中读取 Collection 时，只有一个“BeanList deferred”-Message

```
User u = Application.getLocalUser(session());       
return ok(tasks.render(u.tasks)); 
```

谢谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T15:27:21.207

在实现 @ManyToMany 关联时，我收到了同样的信息。

我的问题是，在`save()`将实体 Y 添加到实体 X 中的 List<Y> 之后，我忘记了（即插入）实体 Y。

# outlook - 将 Outlook 连接到 Google 应用

> ID：13012047
> 
> 赞同：0
> 
> 时间：2012-10-22T13:01:37.203
> 
> 标签：outlook, sync, google-apps

我将 Outlook 2010 与我的 Google App 帐户一起使用，但是，我无法与我的联系人（在同一个 Google App 下）设置约会并邀请/查看他们的 aviliablily

我应该怎么做才能将 Outlook 2010 与 Google Apps 日历/联系人同步？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T20:49:42.903

听起来您可能刚刚将 Outlook 配置为通过 IMAP 或 POP 检查您的 Google Apps。此方法仅同步您的 Google Apps 电子邮件，而不同步日历或联系人。要同步邮件、日历和通讯录，您应该从以下位置安装 Google Apps Sync for Microsoft Outlook：

[https://tools.google.com/dlpage/gappssync](https://tools.google.com/dlpage/gappssync)

周杰伦

# cakephp-2.0 - cakephp 2.0 saveAll 与 getlastid()

> ID：13012055
> 
> 赞同：1
> 
> 时间：2012-10-22T13:01:59.297
> 
> 标签：cakephp-2.0

通过在 cakephp 2.0 中解决我的 saveAll 问题需要您的帮助。我有 3 个模型：数据表、数据表标题和数据表值。我需要保存所有数据表中最后插入的 ID。我只从 Datasheetsheading 中阅读...

**我的控制器：**

```
public function add_datasheet($id = null) {
    $this->set('datasheetsheadings', $this->datasheetsheading->find('all', array('limit' => 0 .','. 9)));
    $this->set('datasheetsheadings2', $this->datasheetsheading->find('all', array('limit' => 9 .','. 9)));
    $this->set('id', $id);
    if ($this->request->is('post')) {
        if ($this->datasheet->save($this->request->data)) {
            $this->datasheetsvalue->saveAll($this->request->data['datasheetsvalue']); 
            $this->Session->setFlash('Your Datasheet >> Lot: ' . $this->request->data['datasheetsvalue'][1]['value'] . ' << has been saved.');
            $this->redirect(array('action' => 'Datasheets/' . $this->request->data['datasheet']['id_tbl_articles']));
        } else {
            $this->Session->setFlash('Unable to add your datasheet.');
        }
    }
} 
```

**我的观点：**

```
<?php echo $this->Form->create('datasheet', array('action' => 'add_datasheet')); ?>
    <fieldset>
        <legend><?php echo __('Neues Datenblatt'); ?></legend>
        <?php
        $value_id = 0;
        echo $this->Form->input('datasheet.comment', array('label' => 'Kommentar')) . '<hr>';
        echo '<div style="width:300px;float:left;">';
        foreach ($datasheetsheadings as $datasheetsheading) :
            $value_id = $value_id +1;
            echo $this->Form->input('datasheet.id_tbl_articles', array('type' => 'hidden', 'value' => $id));
            echo $this->Form->input('datasheetsvalue.' . $value_id . '.id_tbl_articles', array('type' => 'hidden', 'value' => $id));
            echo $this->Form->input('datasheetsvalue.' . $value_id . '.id_tbl_datasheets', array('type' => 'hidden'));
            echo $this->Form->input('datasheetsvalue.' . $value_id . '.id_tbl_datasheetsheadings', array('type' => 'hidden', 'value' => $datasheetsheading['datasheetsheading']['id']));
            echo __('<div style="width:140px;color:#FFF;float:left;">' . $datasheetsheading['datasheetsheading']['heading'] . '</div><div style="width:160px;color:#FFF;float:left;text-align:right;">');
            echo $this->Form->input('datasheetsvalue.' . $value_id . '.print', array('type' => 'checkbox', 'label' => 'Im Datenblatt anzeigen', 'style' => 'color:#FFF;'));
            echo '</div><div style="clear:left;"></div><div style="margin-top:-30px;">';
            echo $this->Form->input('datasheetsvalue.' . $value_id . '.value', array('label' => ''));
            echo '</div>';
        endforeach;
        echo '</div>';
        echo '<div style="width:170px;float:left;"></div>';
        echo '<div style="width:300px;float:left;">';
        foreach ($datasheetsheadings2 as $datasheetsheading2) :
            $value_id = $value_id +1;
            echo $this->Form->input('datasheet.id_tbl_articles', array('type' => 'hidden', 'value' => $id));
            echo $this->Form->input('datasheetsvalue.' . $value_id . '.id_tbl_articles', array('type' => 'hidden', 'value' => $id));
            echo $this->Form->input('datasheetsvalue.' . $value_id . '.id_tbl_datasheets', array('type' => 'hidden'));
            echo $this->Form->input('datasheetsvalue.' . $value_id . '.id_tbl_datasheetsheadings', array('type' => 'hidden', 'value' => $datasheetsheading2['datasheetsheading']['id']));
            echo __('<div style="width:140px;color:#FFF;float:left;">' . $datasheetsheading2['datasheetsheading']['heading'] . '</div><div style="width:160px;color:#FFF;float:left;text-align:right;">');
            echo $this->Form->input('datasheetsvalue.' . $value_id . '.print', array('type' => 'checkbox', 'label' => 'Im Datenblatt anzeigen', 'style' => 'color:#FFF;'));
            echo '</div><div style="clear:left;"></div><div style="margin-top:-30px;">';
            echo $this->Form->input('datasheetsvalue.' . $value_id . '.value', array('label' => ''));
            echo '</div>';
        endforeach;
        echo '</div>';
        echo '<div style="clear:left;"></div>';
        echo $this->Form->end(__('Sichern'));
    ?>
    </fieldset> 
```

通过保存数据表，它存储在数据表表中：`id(auto_increment)`, `id_tbl_articles`, `comment`, `created`, `modified`. 这完美！在数据表值表中，
我得到值：`id(auto_increment)`、`id_tbl_datasheetsheadings`、和。只有在我得到。我用, ,等做了很多尝试。将值设置为。什么都没用！！！当我更改为时，我得到正确的值，但只有一个。所以我需要这个功能。 谷歌是你的朋友，发现我不能用. 我可以用什么来解决我的问题？ `id_tbl_articles``values``print``id_tbl_datasheets``NULL``$hasOne``$hasMany``$belongsTo``id_tbl_datasheets``$this->datasheet->getlastid()``saveAll``save``saveAll`
`getLastId()``saveAll`

每个人都感谢您的回答！安迪。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-24T17:23:08.150

我得到了答案！

```
public function add_datasheet($id = null) {
    $this->set('datasheetsheadings', $this->datasheetsheading->find('all', array('limit' => 0 .','. 9)));
    $this->set('datasheetsheadings2', $this->datasheetsheading->find('all', array('limit' => 9 .','. 9)));
    $this->set('id', $id);
    if ($this->request->is('post')) {
        if ($this->datasheet->save($this->request->data)) {
            $last_id = $this->datasheet->id;
            $val_id = 0;
            foreach ($this->request->data['datasheetsvalue'] as $data_val_id) {
                $val_id = $val_id + 1;
                $this->request->data['datasheetsvalue'][$val_id]['id_tbl_datasheets'] = $last_id;
            }
            $this->datasheetsvalue->saveMany($this->request->data['datasheetsvalue']);
            $this->Session->setFlash('Your Datasheet >> Lot: ' . $this->request->data['datasheetsvalue'][1]['value'] . ' << has been saved.');
            $this->redirect(array('action' => 'Datasheets/' . $this->request->data['datasheet']['id_tbl_articles']));
        } else {
            $this->Session->setFlash('Unable to add your datasheet.');
        }
    }
} 
```

我现在将使用 saveMany。之前，我使用我的 var $val_id 进行 foreach 并设置 datas[]。现在它完美无缺。
不管怎么说，还是要谢谢你！

# c# - DataServiceCollection：撤消删除现有项目

> ID：13012056
> 
> 赞同：0
> 
> 时间：2012-10-22T13:01:59.397
> 
> 标签：c#, wcf-data-services, change-tracking

我正在查看 WCF 数据服务，特别是在`DataServiceCollection`.

让我们考虑一个应用程序中的 undo 场景，它管理博客和博客条目（每个博客都有许多博客条目）。我正在测试两种撤消操作：

*   添加了新的博客条目（撤消操作是删除条目）；
*   现有的博客条目被删除（撤消操作是添加条目）。

这是代码示例：

```
var context = new BloggingContext(new Uri("http://localhost/WCFDataServicesDemo/"));
var blogs = new DataServiceCollection<Blog>(context.Blogs.Expand(b => b.Entries), TrackingMode.AutoChangeTracking);
var blog = blogs.Where(b => b.Id == 1).Single();

// new entry
var newEntry = new BlogEntry
{
    // some blog entry's properties
};

// add new entry
blog.Entries.Add(newEntry);
// undo add
blog.Entries.Remove(newEntry);

// existing entry
var existingEntry = blog.Entries[0];

// remove existing entry
blog.Entries.Remove(existingEntry);
// undo remove
blog.Entries.Add(existingEntry);

context.SaveChanges(); 
```

第一个撤消操作（添加新条目，然后在撤消时将其删除）工作正常。
第二个撤消操作（删除现有条目，然后在撤消时添加它）不对称地工作。

这一行：

```
blog.Entries.Remove(existingEntry); 
```

将相应的实体标记为`Deleted`上下文的更改跟踪器，这是正确的。但是这一行：

```
blog.Entries.Add(existingEntry); 
```

对更改跟踪器不做任何事情（`existingEntry`保持`Deleted`状态），但是，当然，将项目添加到集合中。

因此，当`SaveChanges`被调用时，该条目将从数据库中删除，但它仍保留在客户端的集合中。

我试图通过在`DataServiceCollection`构造函数中设置回调来手动处理此撤消，但在这里我得到了相同的不对称行为 -`collectionChangedCallback`当我尝试添加标记为`Deleted`.

我究竟做错了什么？
如何“恢复”已删除的项目？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T15:11:15.983

您可能可以使用 Detach 撤消更改。看到这篇文章：[http ://social.msdn.microsoft.com/Forums/en-US/adodotnetdataservices/thread/a944a15f-4a2f-424a-8222-584aad5eaf73](http://social.msdn.microsoft.com/Forums/en-US/adodotnetdataservices/thread/a944a15f-4a2f-424a-8222-584aad5eaf73)

# javascript - 我们如何为 3 个函数重用 jQuery ajax 方法？

> ID：13012057
> 
> 赞同：0
> 
> 时间：2012-10-22T13:02:05.743
> 
> 标签：javascript, jquery, ajax, tag-it

我正在使用 $jquery ajax 方法来填充数据并在 3 个字段中显示，我对 3 个不同的文本框使用相同的 ajax 方法，To，CC，Bcc，我想使用 1 ajax 方法来填充数据，这里是 tagSource：一个函数调用ajax方法

```
jQuery(document).ready(function () {
            jQuery("#totags").tagit({
                allowSpaces: true,
                tagSource: function (request, response) {
                    $.ajax({
                        type: "POST",
                        url: "Blog.aspx/GetName",
                        data: "{'match': '" + request.term + "'}",
                        dataType: "json",
                        contentType: "application/json",
                        success: function (data) {
                            console.log(data);
                            if (data.d != null) {
                                response($.map(data.d, function (item) {
                                    return {
                                        label: item.Name,
                                        value: item.id,
                                    };
                                }));
                            }
                        }
                    });
                },
            });
            jQuery("#cctags").tagit({
                allowSpaces: true,
                tagSource: function (request, response) {
                    $.ajax({
                        type: "POST",
                        url: "Blog.aspx/GetName",
                        data: "{'match': '" + request.term + "'}",
                        dataType: "json",
                        contentType: "application/json",
                        success: function (data) {
                            console.log(data);
                            if (data.d != null) {
                                response($.map(data.d, function (item) {
                                    return {
                                        label: item.Name,
                                        value: item.id,
                                    };
                                }));
                            }
                        }
                    });
                },
            });
            jQuery("#bcctags").tagit({
                allowSpaces: true,
                tagSource: function (request, response) {
                    $.ajax({
                        type: "POST",
                        url: "Blog.aspx/GetName",
                        data: "{'match': '" + request.term + "'}",
                        dataType: "json",
                        contentType: "application/json",
                        success: function (data) {
                            console.log(data);
                            if (data.d != null) {
                                response($.map(data.d, function (item) {
                                    return {
                                        label: item.Name,
                                        value: item.id,
                                    };
                                }));
                            }
                        }
                    });
                },
            });
        }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-22T13:05:19.897

您可以使用 jQuery 链接选择器：

```
jQuery(document).ready(function () {
    jQuery("#totags, #cctags, #bcctags").tagit({
        // ..
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-22T13:08:51.923

在一般情况下将其分配给 var：

```
var ajaxcall=function(request, response) {
    $.ajax({
        type: "POST",
        url: "Blog.aspx/GetName",
        data: "{'match': '" + request.term + "'}",
        dataType: "json",
        contentType: "application/json",
        success: function(data) {
            console.log(data);
            if (data.d != null) {
                response($.map(data.d, function(item) {
                    return {
                        label: item.Name,
                        value: item.id,
                    };
                }));
            }
        }
    });
};​

       jQuery("#totags").tagit({
            allowSpaces: true,
            tagSource: ajaxcall
        });
        jQuery("#cctags").tagit({
            allowSpaces: true,
            tagSource: ajaxcall
        });
        jQuery("#bcctags").tagit({
            allowSpaces: true,
            tagSource: ajaxcall
        }); 
```

在特定情况下，使用 Florent 回答的链。

# javascript - Backbone.js 路由器未检测到 url 更改

> ID：13012060
> 
> 赞同：3
> 
> 时间：2012-10-22T13:02:16.370
> 
> 标签：javascript, backbone.js, socket.io, handlebars.js

查看此[示例](http://coenraets.org/blog/2011/12/backbone-js-wine-cellar-tutorial-part-1-getting-started/)，路由器似乎应该检测导致与其路由匹配的 URL 更改的链接。但是，单击我的 Handlebars 模板生成的链接只会更改 URL，不会触发路由器中的警报。出于某种奇怪的原因，该路由在刷新时触发，尽管 URL 丢失了哈希值。

我不确定为什么路由器没有接收到我的 URL 更改。如果它们确实有效，我更喜欢使用链接而不是 Router.navigate。该路由确实适用于默认路由。

下面的主干.js 代码在 $(document).ready 上运行，来自 html 头中的脚本。

### 项目车把模板

```
{{#with lobby}}
<li id="lobby-{{id}}">
    <div class="lobby_info">{{name}} - {{owner}} - {{player_count}}/18</div> <a href="#lobby/{{id}}">Join</a>
 </li>
 {{/with}} 
```

### 项目主干视图

```
var LobbyView = Backbone.View.extend({
    events: {
        "click .lobby_info": "expand_toggle",
    },

    expand_toggle: function(evt) {
        alert('Expand toggle');
    },

    render: function() {
        var template = Handlebars.compile($("#lobby_template").html());

        this.$el.html(template(this.model.toJSON()));

        return this;
    }
}); 
```

### 项目集合视图

```
var LobbiesView = Backbone.View.extend({
    events: {
        "submit #create_lobby_form": "create_lobby",
    },

    create_lobby: function(evt) {
        evt.preventDefault()

        var val = $('#lobby_name').val();

        socket.emit('create', val);

        $("#lobby_name").val("");
    },

    initialize: function() {
        var me = this;

        socket.on('create', function(lobby) {
            var lobby_item = new LobbyView({
                model: new LobbyModel({
                    lobby: lobby
                })
            });

            // render it to the DOM
            el = lobby_item.render().el;
            me.$("#lobbies").append(el);
       });

    },

    render: function() {
        var me = this;

        var template = Handlebars.compile($("#lobbies_template").html());

        $(this.el).html(template());

        return this;
    },
}); 
```

### 路由器

```
var Router = Backbone.Router.extend({
    // Match urls with methods
    routes: {
        "": "index",
        "lobby/:lobby_id": "lobby",
        "player/:player_id": "player"
    },

    index: function() {
        // connect to the websocket
        socket = io.connect();
        socket.emit('subscribe');
        var view = new LobbiesView({
            el: $("#container"),
        });

        view.render();
    },

    // View a lobby
    lobby: function(lobby_id) {
        alert('Viewing lobby' + lobby_id);
    },

    // View a player
    player: function(player_id) {
    },
});

// start backbone routing
var app = new Router();
Backbone.history.start({ pushState: true }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T05:48:47.170

你的问题是`{ pushState: true }`。删除它，您的路由器将工作（在控制台中测试）。如果`pushState`设置为 true，则需要设置不带散列的路由。

这是我正在测试的代码：

```
var Router = Backbone.Router.extend({
    routes: {
        "": "index",
        "lobby/:lobby_id": "lobby",
        "player/:player_id": "player",
        "*actions": "test"
    },

    test: function() { 
        console.log('test', arguments) 
    },

    index: function() {
        console.log('index', arguments);
    },

    player: function() {
        console.log('player', arguments);
    },

    lobby: function(lobby_id) {
        console.log('lobby', arguments);
    }
});

// start backbone routing
var app = new Router();
Backbone.history.start(); 
```

# android - ANDROID：奇怪的 getMaximumRange() 函数结果

> ID：13012063
> 
> 赞同：1
> 
> 时间：2012-10-22T13:02:24.497
> 
> 标签：android, android-sensors

当我使用函数**getMaximumRange()**来获取加速度计的最大值时，我得到了一个非常大的数字：**10320**。我设法得到的最大值是 ≈ 19.59。你能告诉我这个**10320**是什么号码吗？这肯定不是加速度计的最大值。

**我只在HTC EVO 3D**上得到这个值。在**HTC Wildfire**上，它是正确的最大值。

# java - 外部化命名空间 JAXB 生成的 package-info.java

> ID：13012070
> 
> 赞同：2
> 
> 时间：2012-10-22T13:02:47.703
> 
> 标签：java, jaxb

如何将 package-info.java 中的命名空间值外部化

```
@javax.xml.bind.annotation.XmlSchema(namespace = "http://loclahost:9093/Request", elementFormDefault = javax.xml.bind.annotation.XmlNsForm.QUALIFIED) 
```

在上面的代码中应该如何外部化“http://loclahost:9093/Request”。

任何帮助是极大的赞赏

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-22T14:05:54.193

注释上指定的命名空间`@XmlSchema`并不意味着与 XML 模式的物理位置相关。它用于限定元素，使您的`address`元素不同于其他组织使用的`address`元素。这类似于 Java 中的包名。与包名一样，人们通常为此使用域名。我想不出一个很好的理由让命名空间看起来像： `http://loclahost:9093/Request`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-22T13:59:49.880

注释属性值必须是编译时常量，所以你能做的最好的就是`public static final String NAMESPACE = "http://example.com"`在另一个类中声明 a 然后`namespace = MyClass.NAMESPACE`在注释中说。但是您仍然必须`package-info.java`在`MyClass`更改时重新编译。

# jquery - 使用 Jquery 重置选择框

> ID：13012075
> 
> 赞同：7
> 
> 时间：2012-10-22T13:03:10.597
> 
> 标签：jquery, html, select

我在使用 jQuery 重置选择框的值时遇到了困难。我的代码如下：

HTML：

```
<form id="myform">
  <select name="myselect" id="myselect" value=""> 
    <option value="">Default</option>
    <option value="1">Option 1</option>
    <option value="2" selected>Option 2</option>
    <option value="3">Option 3</option>
  </select>  
  <input type="submit" value="Go">
  <input type="reset" class="reset" value="Reset form">  
</form> 
```

Javascript：

```
​$("#myform .reset").click(function() {
    $('#myselect').attr('value','');
    alert($('#myselect').attr('value'));
});​ 
```

如您所见，选择了选项 2，但我想将选择框重置为“默认”。我尝试了各种方法，包括 attr->selectedIndex，但都具有相同的效果，它会短暂更改为默认值（如果您在“警报框”弹出时查看表单可以看出，但只要警报框被关闭，或者警告线被移除，它会跳回到当前选择的选项 2。

我认为这可能是一个 jQuery 错误，我尝试了许多不同的版本，从 1.6 到 edge，都具有相同的效果。

为方便起见，我添加了一个 jsfiddle：http: [//jsfiddle.net/ux2f2/1/](http://jsfiddle.net/ux2f2/1/)

希望我已经包含了所有内容，因为这是我的第一篇文章，但我是一个长期阅读者:) 喜欢这个网站！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-22T13:16:35.970

您不需要任何 javascript 来重置这个简单的表单。只需使用在 (X)HTML 中选择的属性

```
<form id="myform">
  <select name="myselect" id="myselect" value=""> 
    <option selected="selected">Default</option>
    <option value="1">Option 1</option>
    <option value="2" selected>Option 2</option>
    <option value="3">Option 3</option>
  </select>  
  <input type="submit" value="Go">
  <input type="reset" class="reset" value="Reset form">  
</form> 
```

如果你真的想使用 jQuery，我们可以这样做：

```
$("#myform .reset").click(function() {
    $('#myselect').prop('selectedIndex', -1);
}); 
```

值“-1”，表示“重置”

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-22T13:18:51.927

正如 Kolink 所解释的，“reset”类型的输入是问题的原因，因为它将整个表单重置为默认值。

最快的解决方案是改变

```
<input type="reset" class="reset" value="Reset form"> 
```

到

```
<input type="button" class="reset" value="Reset form"> 
```

或者只是让一个可点击的锚点或 div 成为重置的触发器而不是输入

这样您就无需对 jQuery 进行任何更改

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-22T13:07:49.537

主要问题是重置按钮在您单击它并看到警报后重置表单。您需要取消默认事件。但是，您也可以尝试 vanilla JS：

```
// add id="reset" to the reset button's HTML, then...
document.getElementById('reset').onclick = function() {
    mysel = document.getElementById('myselect');
    mysel.selectedIndex = 0;
    alert(mysel.value);
    return false;
} 
```

[更新小提琴](http://jsfiddle.net/ux2f2/2/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-22T13:08:09.670

你应该使用类似的东西：

```
$("select#myselect").val('').attr('selected', true); 
```

上述工作小提琴：http: [//jsfiddle.net/gsN9d/](http://jsfiddle.net/gsN9d/)

作为替代（“prop”的新语法）使用：

```
$("select#myselect").val('').prop('selected', true); 
```

# jquery - jquery在页面加载时弹出框并在超时后自动关闭

> ID：13012079
> 
> 赞同：-1
> 
> 时间：2012-10-22T13:03:20.660
> 
> 标签：jquery, popup, social-networking

嗨，我想要一个弹出窗口并禁用所有页面（弹出窗口所在的页面）并显示 facebook fanpage 按钮或社交分享按钮，并使其强制喜欢/分享给每个访问者，否则他需要等待 15-20 秒查看主页

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T13:10:50.267

您需要执行以下操作。看看我做了什么并实施它。setInterval 将每 15 秒运行一次，但间隔中的待办事项列表用 if 语句包装，因此它只会应用一次。

```
<html>
<head>
<script src='path/to/jquery.js'></script>
<style>
#popup {
 add you styling
}
</style>
</head>

<body>

<div id='popup'>popup content</div>

<script>
$(document).ready(function(){
$('#popup').fadeIn();

var repeatPopUp = 0;

setInterval(function(){

if(repeatPopUp < 1){
$('#popup').hide();

repeatPopUp++;
}

}, 15000);

});
</script>
</body>
</html> 
```

# jquery - jQuery ~ 可拖动功能在附加对象中不起作用

> ID：13012092
> 
> 赞同：1
> 
> 时间：2012-10-22T13:03:46.377
> 
> 标签：jquery

当我单击并附加一个新的 div 调用 block2 时，可拖动的拖动和停止不起作用？

怎么解决？？

演示：http: [//jsfiddle.net/hbGkN/1/](http://jsfiddle.net/hbGkN/1/)

HTML

```
<div id="btn"><input name="click" type="button" value="Click" /></div>
<div class="block1" style=" width:100px; height:100px; background:orange;">I am Block1</div> 
```

JS

```
$('#btn').click(function(){
    var $newDiv=$('<div class="block2" style=" width:100px; height:100px; background:green;">I am Block2</div>');
    $( "#btn").parent().append($newDiv);

});

$('.block1').draggable({

            drag: function() {
                $('.block1').text('Drag Now!');
            },
            stop: function() {
                $('.block1').text('Stop Now!');
            }

        });

$('.block2').draggable({

            drag: function() {
                $('.block2').text('Drag Now!');
            },
            stop: function() {
                $('.block2').text('Stop Now!');
            }

        }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-22T13:11:10.410

你应该试试这个，因为 'block2' 类 div 不存在于 dom 中，所以代码将无法向其添加可拖动对象。因此，在将“block2”添加到 DOM 之后，您应该在其上调用可拖动对象。然后它会在你的方面起作用。

```
$('#btn').click(function(){
    var $newDiv=$('<div class="block2" style=" width:100px; height:100px; background:green;">I am Block2</div>');
    $( "#btn").parent().append($newDiv);

    $('.block2').draggable({
         drag: function() {
             $('.block2').text('Drag Now!');
         },
         stop: function() {
             $('.block2').text('Stop Now!');
         }
    });

}); 
```

检查这个**[演示](http://jsfiddle.net/hbGkN/4/)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-08-03T16:03:58.447

更简洁的解决方案是**在追加完成后调用可拖动的函数**。

```
$('#btn').click(function(){
    var newDiv = $('<div class="block2" >Block2</div>');
    $(newDiv).appendTo($(this).parent());

    $('.block2').draggable();
}); 
```

这样你就可以在它上线后应用所有的拖动和停止功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-22T13:54:16.397

问题是附加的 DOM 元素在添加时不是“活动的”，因此从未`draggable`应用过方法。这段代码很好地达到了目的。

```
function drag(e) {
    $(e.target).text('Drag Now!');
}
function stop(e) {
    $(e.target).text('Stop Now!');
}

$('#btn').click(function(){
    var newDiv = $('<div class="block2" style=" width:100px; height:100px; background:green;">I am Block2</div>');
    $(newDiv).appendTo($(this).parent()).draggable({drag: drag, stop: stop});
});

$('.block1').draggable({drag: drag, stop: stop}); 
```

由于您的`drag`和`drop`方法是相同的，因此重用它们更有意义。

# .net - DataSet.ReadXml - 不同嵌套级别的重复元素名称

> ID：13012095
> 
> 赞同：1
> 
> 时间：2012-10-22T13:03:51.997
> 
> 标签：.net, xml, dataset

我们的代码使用 DataSet::ReadXml 方法将我们的 XML 文件转换为 DataSet。当不同嵌套级别的元素具有相同名称时，似乎存在问题。

例如：

```
<?xml version="1.0" encoding="UTF-8"?>
<Something>
    <MyValue>100</MyValue>
</Something> 
```

这将产生以下数据表：

![在此处输入图像描述](../Images/4fb326c4868f617a68cf375a9fcd2e94.png)

但是，如果 XML 是这样的：

```
<?xml version="1.0" encoding="UTF-8"?>
<Something>
    <Something>100</MyValue>
</Something> 
```

然后这将产生以下数据表：

![在此处输入图像描述](../Images/78d3d2b5d2a8bec40082d9dd1d15247f.png)

不幸的是，我们不生成 XML 文件，因此如果不对 XML 文件执行预处理步骤，就无法更改此格式。是否有任何替代选项可以从不显示此问题的 XML 文件创建数据集？

# javascript - superfish.js 相同的方法重复

> ID：13012098
> 
> 赞同：0
> 
> 时间：2012-10-22T13:03:55.363
> 
> 标签：javascript, jquery, html, superfish

我尝试修改 superfish.js - 基于 JQuery 的超级鱼菜单。我有这个功能，工作很棒

```
 showSuperfishUl : function(){
            var o = sf.op,
            sh = sf.c.shadowClass+'-off',
            $ul = this.addClass(o.hoverClass)
            .find('>ul:hidden').css('visibility','visible');
            sf.IE7fix.call($ul);
            o.onBeforeShow.call($ul);

            $ul.animate(o.animation,o.speed,function(){ sf.IE7fix.call($ul);  
            o.onShow.call($ul); });
            return this;
    } 
```

但是如果添加重复

```
showSuperfishUl1 : function(){
    var o = sf.op,
    sh = sf.c.shadowClass+'-off',
    $ul = this.addClass(o.hoverClass)
    .find('>div:hidden').css('visibility','visible');
    sf.IE7fix.call($ul);
    o.onBeforeShow.call($ul);

    $ul.animate(o.animation,o.speed,function(){ sf.IE7fix.call($ul); 
    o.onShow.call($ul); });
    return this;
} 
```

功能被破坏了我应该如何组合这些功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T22:05:15.040

你需要让它双向工作，

```
 showSuperfishUl : function(){
        var o = sf.op,
        sh = sf.c.shadowClass+'-off',
        $ul = his.addClass(o.hoverClass).find('>*:hidden').css('visibility','visible');
        sf.IE7fix.call($ul);
        o.onBeforeShow.call($ul);

        $ul.animate(o.animation,o.speed,function(){ 
           sf.IE7fix.call($ul);
           o.onShow.call($ul); 
        });
        return this;
  } 
```

但是超级鱼被设计为使用`<ul>`s和`<li>`s。t 可能不起作用。

# c# - 实体框架 5 代码首先将 newsequentialid() 作为 PK

> ID：13012099
> 
> 赞同：7
> 
> 时间：2012-10-22T13:03:56.023
> 
> 标签：c#, entity-framework, newsequentialid

如何`newsequentialid()`在 PK 列中用作默认值？

我有这个注释：

```
[Key, DatabaseGenerated(DatabaseGeneratedOption.Identity)] 
```

但这会生成随机的 guid，我希望有顺序的 guid。

我可以手动将数据库设置`newsequentialid()`为默认值，但没有更好的选择吗？还是 EF 团队忘记了这个选项？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-22T14:56:48.003

如果您正在使用迁移，您应该能够简单地修改基于代码的迁移以使用`newsequentialid()`as `DefaultValueSql`。

```
public override void Up() {
    CreateTable(
        "SomeTable",
         c => new {
            Id = c.Guid(nullable: false, defaultValueSql: "newsequentialid()"),
         })
         .PrimaryKey(t => t.Id)
    );
} 
```

如果您不使用迁移，请检查此[问题](https://stackoverflow.com/questions/6098972/guid-comb-strategy-in-ef4-1-codefirst)。

# php - 在php页面上强制本地浏览器缓存

> ID：13012108
> 
> 赞同：0
> 
> 时间：2012-10-22T13:04:16.390
> 
> 标签：php, javascript, jquery, html, apache

我正在使用以下代码强制页面“缓存”。这似乎在某些浏览器/设备中运行良好，但并非全部。是否需要添加一些内容以确保在指定的持续时间内缓存页面？基本上我有一个 LI 元素的静态列表，总共大约 500k，除非你在移动设备上，否则这不是问题。

```
$seconds_to_cache = 3600;
$ts = gmdate("D, d M Y H:i:s", time() + $seconds_to_cache) . " GMT";
header("Expires: $ts");
header("Pragma: cache");
header("Cache-Control: max-age=$seconds_to_cache"); 
```

# ruby - 从类对象获取类位置

> ID：13012109
> 
> 赞同：53
> 
> 时间：2012-10-22T13:04:19.267
> 
> 标签：ruby

我有一堆代码要看，现在是调试时间。因为我从来都不是 Ruby 调试器的粉丝，所以我正在寻找一种通过代码并阅读它的方法。

我想要做的是获取定义加载类的文件的位置：

```
Foo::Bar.create(:param) # how can I know file location in runtime? 
```

对于更小、组织更好的项目，我只会搜索，`class Bar`但在这里这是不可能的，因为有很多名为 的类`Bar`，而且更糟糕的是，其中一些在同一个命名空间下。我知道，等待发生的麻烦。

注意：我使用的是 Ruby 1.8.7。

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-10-22T14:00:49.843

对于Ruby 1.9，有一个名为`Methods`source_location[的](http://www.ruby-doc.org/core-1.9.3/Method.html#method-i-source_location)方法：`Procs`

> 返回包含此方法的 Ruby 源文件名和行号，如果此方法未在 Ruby（即本机）中定义，则返回 nil

因此，您可以请求该方法：

```
m = Foo::Bar.method(:create) 
```

然后询问`source_location`该方法的：

```
m.source_location 
```

这将返回一个包含文件名和行号的数组。例如对于`ActiveRecord::Base#validates`这个返回：

```
ActiveRecord::Base.method(:validates).source_location
# => ["/Users/laas/.rvm/gems/ruby-1.9.2-p0@arveaurik/gems/activemodel-3.2.2/lib/active_model/validations/validates.rb", 81] 
```

对于类和模块，Ruby 不提供内置支持，但是有一个优秀的 Gist 可以在`source_location`没有指定方法的情况下返回给定方法的文件或类的第一个文件：

*   [红宝石 where_is 模块](https://gist.github.com/1236979)

**编辑：**对于 Ruby 1.8.7，有一个可以向后移植的 gem `source_location`：

*   [ruby18_source_location](https://github.com/ConradIrwin/ruby18_source_location)

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2016-12-20T09:10:51.490

仅供参考，在 Rails 的控制台或 Rails 应用程序的调试会话中，您可以找到定义该特定类的文件的磁盘位置。像

```
> show-source Job 
```

这会给你

```
From: /home/john/projects/iisifix/app/models/job.rb @ line 13:
Class name: Job
Number of monkeypatches: 6\. Use the `-a` option to display all available monkeypatches
Number of lines: 66

class Job < ApplicationRecord
  belongs_to :quote_request
  belongs_to :garage 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-22T14:09:43.820

这是一个简单的示例，展示了我如何在代码中跟踪位置。如果我需要知道模块中的位置：

```
class Foo
  attr_reader :initialize_loc
  def initialize
    @initialize_loc = [__FILE__, __LINE__]
    # do more stuff...
  end
end 
```

如果我需要知道发生了什么事情：

```
require_relative 't1'

foo = Foo.new
# do lots of stuff until you want to know where something was initialized.
puts 'foo initialized at %s:%s' % foo.initialize_loc 
```

当我运行代码时，我得到：

```
FooBar:Desktop foobar ruby t2.rb 
foo initilized at /Users/foobar/Desktop/t1.rb:4 
```

如果我不想弄乱模块的源代码，并且希望调试器在我需要它时跳入，我会让调试器这样做：

```
require_relative 't1'
require 'ruby-debug'

debugger
foo = Foo.new
# do lots of stuff until you want to know where something was initilized.
puts 'foo initilized at %s:%s' % foo.initialize_loc 
```

执行将停止，我将在紧随其后的行进入调试器`debugger`：

```
[0, 9] in t2.rb
  1  require_relative 't1'
  2  require 'ruby-debug'
  3  
  4  debugger
=> 5  foo = Foo.new
  6  # do lots of stuff until you want to know where something was initilized.
  7  puts 'foo initilized at %s:%s' % foo.initialize_loc
  8  
t2.rb:5
foo = Foo.new
(rdb:1) 
```

一个简单的`s`将“步入”我进入下一行代码，这将在`initialize`块中`Foo`：

```
(rdb:1) s
[-1, 8] in /Users/foobar/Desktop/t1.rb
  1  class Foo
  2    attr_reader :initialize_loc
  3    def initialize
=> 4      @initialize_loc = [__FILE__, __LINE__]
  5      # do more stuff...
  6    end
  7  end
  8  
/Users/foobar/Desktop/t1.rb:4
@initialize_loc = [__FILE__, __LINE__]
(rdb:1) 
```

除此之外，使用诸如`grep -rn target_to_find path_to_search`递归搜索目录并列出与目标匹配的行的文件名和行号之类的工具将大大有助于找到您要查找的内容。

或者，`:vim /target_to_find/ path_to_search`从 Vim 内部使用将返回您要查找的文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-22T13:28:20.580

坏消息！我猜在运行时没有办法知道在 Ruby 1.8.7 中创建或定义了一个类的文件。

如果项目有一些像rails这样的结构，你就能猜到。

但在 Ruby 中，可以为同一个类定义多个文件的方法 类甚至可以在运行时定义（元编程）。

这意味着定义类的地方可能不止一个。您要查找的内容可以分布在多个文件中。

我想您将不得不搜索 Bar 的所有定义并查看它们是否在模块 Foo 中，或者首先查找所有 Foo 定义并检查其中的内容。如果代码是一团糟，我看不出一个简单的方法，你将不得不按照 spaguetti 形式指向 poi。一个好的编辑器和多个文件搜索可能会有所帮助，但您需要通读代码。

**编辑：**毕竟是一些好消息。在 Ruby 1.9 中有`source_location`并且看起来有 1.8.7 的反向移植。但是，如果定义是在运行时由 eval 进行的，那么我不确定它是否会起作用。我认为最简单的解决方案是像 Rubymine 这样的优秀编辑器，它通常可以告诉你代码是在哪里定义的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-22T14:00:55.760

坦率地说，鉴于您描述的代码组织，我认为 ruby​​-debug 是发现调用站点目的地的简单途径：只需设置断点并介入。如果您真的对调试器过敏，您可以检测调用站点与[`Kernel#set_trace_func`](http://ruby-doc.org/core-1.8.7/Kernel.html#method-i-set_trace_func).

```
$max_trace = 10
set_trace_func proc { |event, file, line, id, binding, classname|
  printf "%8s %s:%-2d %10s %8s\n", event, file, line, id, classname
  $max_trace -= 1 
  set_trace_func(nil) unless $max_trace > 0
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-05-01T19:47:07.947

更改对象的超类时出现此错误，修复方法是停止并启动 spring。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2022-02-24T15:57:56.320

要找到一个**函数**`.source_location`：

```
> ActiveModel.method(:as_json).source_location
["/usr/local/bundle/gems/activesupport-6.1.4.4/lib/active_support/core_ext/object/json.rb", 54] 
```

要查找**模块**或**类** `Object.const_source_location`：

```
Object.const_source_location('ActiveModel')
["/usr/local/bundle/gems/activemodel-6.1.4.4/lib/active_model/gem_version.rb", 3] 
```

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2019-02-22T13:54:13.527

```
Klass.method(Klass.methods.first).source_location 
```

使用`source_location`方法，我可以搜索类中定义的第一个方法。我想这不是万无一失的，因为元编程和其他黑客。

# python - 使用 python 和 mongodb 进行异步日志记录

> ID：13012111
> 
> 赞同：5
> 
> 时间：2012-10-22T13:04:25.480
> 
> 标签：python, mongodb, logging, asynchronous

我需要记录我的 Web 应用程序的特定活动（基于 Python - 使用 Postgres 的 SQL alchemy）并且我不想在我的 Postgres 数据库中转储日志信息（为什么用大部分垃圾填充它？）或使用日志文件（很难搜索）。

理想情况下，我想将所有内容都放在另一个数据库中，并以异步方式执行此操作。由于日志记录是异步的，我无需担心写入操作失败并破坏完成所有重要业务的代码。此外，如果我错过了一些日志记录事件，这可能没什么大不了的。

Mongo 似乎是一个很好的解决方案，因为它非常适合编写操作并且易于设置。

问题是我还没有找到任何满足我需求的 python 工具，特别是异步需求。

有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-15T21:14:11.327

Using the **log collector daemon** like [Fluentd](http://fluentd.org/) / [Scribe](http://github.com/facebook/scribe/) / [Flume](http://flume.apache.org/), could be an another solution.

![fluentd plus mongodb](../Images/daa6a180c648daf7e5d939e7aa22f350.png)

These daemon is launched at every application nodes, and takes the logs from app processes. They buffer the logs and **asynchronously** writes out the data to other systems like MongoDB / PostgreSQL / etc. The write is done by **batches**, so it's a lot more efficient than writing directly from apps.

Here's two links of how to use Fluentd from Python, and how to put the data into MongoDB.

*   [Fluentd: Data Import from Python Applications](http://docs.fluentd.org/articles/python)
*   [Fluentd: Store Apache Logs into MongoDB](http://docs.fluentd.org/articles/apache-to-mongodb)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T08:34:19.197

异步登录到 mongodb 可以通过在 log4j 中添加 AsyncAppender 来实现，它将引用一个真正的 appender。

有关基本理解，请遵循此[http://wiki.python.org/jython/Log4jExample](http://wiki.python.org/jython/Log4jExample)

`log4mongo`将数据推送到 mongo.Python 驱动程序可在[http://log4mongo.org/display/PUB/Log4mongo+for+Python获得](http://log4mongo.org/display/PUB/Log4mongo+for+Python)

添加 AsyncAppender 将使日志记录异步方式

仅供参考，相当于log4j文件

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE log4j:configuration SYSTEM "log4j.dtd">
<log4j:configuration xmlns:log4j="http://jakarta.apache.org/log4j/">
<appender name="MongoDB" class="org.log4mongo.MongoDbAppender" >
    <param name="hostname" value="127.0.0.1" />
    <param name="port" value="27017" />
    <param name="databaseName" value="LogDB"/>
    <param name="collectionName" value="Log" />
</appender>
<appender name="ASYNC" class="org.apache.log4j.AsyncAppender">
    <param name="BufferSize" value="50000"/>
    <appender-ref ref="MongoDB"/>
</appender>
<root>
    <level value="all"/>
    <appender-ref ref="ASYNC"/>
</root> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-02-05T08:14:20.093

我正在使用pip 提供的[log4mongo](https://pypi.python.org/pypi/log4mongo/)：

```
pip install log4mongo 
```

它允许使用默认的**日志记录**系统。示例（从文档中提取）：

```
import logging
from log4mongo.handlers import MongoHandler

logger = logging.getLogger('test')
logger.addHandler(MongoHandler(host='localhost'))

logger.warning('test') 
```

# c - 代理服务器中的 select()

> ID：13012112
> 
> 赞同：-2
> 
> 时间：2012-10-22T13:04:34.957
> 
> 标签：c, tcp, proxy, client-server, select-function

我正在用 c 构建一个代理服务器，我正在尝试理解该`select()`功能。我已经完成了代码，以便从客户端建立连接，然后提取网址，以便可以建立另一个连接以连接到实际的 Web 服务器。然后该页面被代理接收并传回给客户端。

我知道这`select()`将允许它处理多个客户端请求，但我不明白它如何帮助（或者更确切地说如何实现）与 Web 服务器的第二个连接。据我了解，我将不再需要一个 while 循环来继续从 Web 服务器接收数据并将其传递回客户端。

我是否需要为 Web 服务器连接设置第二个文件描述符？如果我正在处理两个或多个客户端请求，我如何确保它们与 Web 服务器的正确连接链接在一起？无论如何，我会很感激任何帮助。我已经完成了网络教程和其他一些在线教程，但几天后我仍然没有完全理解这一点。

```
void error(const char *msg)
{
    perror(msg);
    exit(1);
}

void *get_in_addr(struct sockaddr *sa)
{
    if (sa->sa_family == AF_INET)
        return &(((struct sockaddr_in*)sa)->sin_addr);

    return &(((struct sockaddr_in6*)sa)->sin6_addr);
}

string getHostString(const char *buf);

int main(int argc, char *argv[])
{   
    int sockfd, newsockfd, portno;
    int fdmax; //maximum file descriptor number
    socklen_t clilen;
    char buffer[256];
    struct sockaddr_storage remoteaddr; //client address
    char clientIP[INET6_ADDRSTRLEN];

    //fd_set readfds, writefds, exceptfds;
    fd_set masterfds, readfds;
    struct timeval timeout;
    int rc;

    /*Set time limit. */
    timeout.tv_sec = 3;
    timeout.tv_usec = 0;

    /*Create a descriptor set containing the sockets */
    FD_ZERO(&readfds);
    FD_ZERO(&masterfds);
    /*FD_ZERO(&writefds);
    FD_ZERO(&exceptfds);
    FD_SET(newsockfd, &readfds);

    rc = select(sizeof(readfds)*8, &readfds, NULL, NULL, &timeout);
    if (rc==-1){
        perror("select failed");
        return -1;
    }*/

    struct sockaddr_in serv_addr, cli_addr;
    int n;
    if (argc < 2) {
        fprintf(stderr,"ERROR, no port provided\n");
        exit(1);
    }

    sockfd = socket(AF_INET, SOCK_STREAM, 0);
    if (sockfd < 0) 
       error("ERROR opening socket");

    bzero((char *) &serv_addr, sizeof(serv_addr));
    portno = atoi(argv[1]);
    serv_addr.sin_family = AF_INET;
    serv_addr.sin_addr.s_addr = INADDR_ANY;
    serv_addr.sin_port = htons(portno);

    if (bind(sockfd, (struct sockaddr *) &serv_addr, sizeof(serv_addr)) < 0) 
             error("ERROR on binding");

    if((listen(sockfd,5)) == -1 )
        error("Server-listen() error!!!");
    printf("Server-listen() is OK...\n");

    FD_SET(sockfd, &masterfds);

    //keep track of the biggest file descriptor so far
    fdmax = sockfd; //so far it's this one

    for(;;){

        readfds = masterfds;

        if(select(fdmax+1, &readfds, NULL, NULL, NULL) == -1){
            error("Server-select() error !");
        }
        printf("Server-select() is OK...\n");

        for(int i = 0; i <= fdmax; i++){
            printf("i: %d sockfd %d\n", i, sockfd);
            if(FD_ISSET(i, &readfds)){
                if(i == sockfd){ //sockfd is the listener
                    //following handles new connections
                    clilen = sizeof(cli_addr);
                    if((newsockfd = accept(sockfd,(struct sockaddr *) &cli_addr, &clilen)) == -1)
                        error("Server-accept() error!!!");
                    else{
                        printf("Server-accept() is OK...\n");
                        FD_SET(newsockfd, &masterfds); //add to master set
                        if(newsockfd > fdmax) 
                            fdmax = newsockfd;
                        printf("selectserver: New connection from %s on  "
                                "socket %d\n",
                                inet_ntop(remoteaddr.ss_family,
                                    get_in_addr((struct sockaddr*)&cli_addr),
                                    clientIP, INET6_ADDRSTRLEN),
                                newsockfd);
                    }
                }
                else{
                    //handle data from a client
                    //Here is where the FIRST read occurs
                    bzero(buffer,256);
                    //n = read(newsockfd,buffer,255);
                    n = read(i,buffer,255);
                    if (n < 0) error("ERROR reading from socket");
                    printf("Here is the message: \n\n%s\n\n",buffer);

                    //string hoststring(buffer);
                    string hoststring(getHostString(buffer));

                    int html_port = 80;
                    int html_socket;

                    printf("Prior to struct addrinfo\n");

                    struct addrinfo hints, *res;

                    memset(&hints, 0, sizeof hints);
                    hints.ai_family = AF_UNSPEC;
                    hints.ai_socktype = SOCK_STREAM;
                    hints.ai_flags = AI_PASSIVE;

                    printf("Prior to getaddrinfo()\n");

                    char *address = new char[hoststring.size() +1];
                    address[hoststring.size()] = 0;
                    memcpy(address, hoststring.c_str(), hoststring.size());

                    //getaddrinfo(token, (char *)html_port, &hints, &res);
                    getaddrinfo(address, "80", &hints, &res);

                    printf("We are past getaddrinfo()\n");

                    //if (html_socket = socket(PF_INET, SOCK_STREAM, 0) < 0){
                    if ((html_socket = socket(res->ai_family, res->ai_socktype, res->ai_protocol)) < 0){
                        printf("socket connection error\n");
                    }

                    printf("We are past socket()\n");

                    //char* address;
                    //address = new char[256];
                    //strncpy(address, "www.cs.ucr.edu", sizeof("www.cs.ucr.edu"));

                    printf("address: %s\n", address);    
                    struct hostent * host;
                    if ((host = gethostbyname(address)) == NULL){
                        printf("Problem with gethostbyname()\n");
                    }

                    printf("We are past gethostbyname() and about to connect.\n");

                    if ( connect(html_socket, res->ai_addr, res->ai_addrlen) < 0)
                        printf("Unsuccessful completion of connect()");

                    int bytes_sent, bytes_recvd;
                    char recv_buff[1024];
                    bytes_sent = send(html_socket, buffer, 256, 0);
                    cout << "bytes_sent: " << bytes_sent << endl;

                    //do{
                        bytes_recvd = recv(html_socket, recv_buff, 1024, 0);
                        cout << "bytes_rcvd: " << bytes_recvd << endl;
                        cout << recv_buff << endl;

                        //FD_ZERO(&readfds);
                        //FD_SET(newsockfd, &writefds);

                        //n = write(newsockfd,"I got your message\n",20);
                        //n = write(newsockfd,recv_buff,bytes_recvd);
                        n = write(i,recv_buff,bytes_recvd);
                        if (n < 0) error("ERROR writing to socket");
                        bzero(recv_buff, 1024);
                    //}while(bytes_recvd !=0);
                }
            }
        }

    }

    close(newsockfd);
    close(sockfd);
    return 0; 
}

string getHostString(const char *buf){
    string hoststring(buf); 
    hoststring = hoststring.substr(11);

    cout << "hoststring: " << hoststring << endl;
    int slashpos;
    slashpos = hoststring.find("/");
    int suffixendpos = hoststring.find("H") - slashpos;
    string suffix = hoststring.substr(slashpos, suffixendpos);
    hoststring = hoststring.substr(0, slashpos);

    cout << "hoststring: " << hoststring << endl;
    cout << "suffix: " << suffix << endl;

    return hoststring;

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T16:40:28.643

我知道您正在尝试编写一个单进程服务器来处理循环中的多个连接，并使用`select()`它来确定套接字描述符何时有要读取的数据。然而，有时另一种方法实际上更容易且更具可扩展性。

您是否考虑过使用`multi-process`服务器，在每个套接字连接建立后，您会`fork()`使用一个新进程来处理请求？这消除了担心如何`select()`工作以及将请求映射到正确的套接字描述符的需要。

请参阅[此处的处理多个连接](http://www.tutorialspoint.com/unix_sockets/socket_server_example.htm)作为一个合理的示例。

除了使用之外，`fork()`您还可以将线程与 POSIX`pthreads`库一起使用，这可能会提高您的效率。这是[一个很好的使用 pthreads 的多线程 tcp/ip 服务器示例。](http://kturley.com/simple-multi-threaded-web-server-written-in-c-using-pthreads/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-22T13:09:56.220

您是否阅读了[select(2)](http://www.kernel.org/doc/man-pages/online/pages/man2/select.2.html)和[select_tut(2)](http://www.kernel.org/doc/man-pages/online/pages/man2/select_tut.2.html)手册页？

[您是否阅读了高级 Linux 编程](http://advancedlinuxprogramming.com/)或[高级 Unix 编程等](http://basepath.com/aup/)相关章节？

实际上，由于[c10k](http://www.kegel.com/c10k.html)问题和最大文件描述符限制为 256（或 1024），即`__FD_SETSIZE`），`select`系统调用已过时，您应该改用[poll(2)](http://www.kernel.org/doc/man-pages/online/pages/man2/poll.2.html)系统调用。

您应该在调用之前设置循环`readfds`内部，使用显式和（类型可能是数组，因此您不能整体分配它。）。系统调用可以修改它。`for``select``FD_ZERO``FD_SET``fd_set``select`

不要忘记`gcc -Wall -g`使用调试器进行编译。您还可以研究现有免费软件 HTTP 客户端库或代理的源代码。

# c# - 异步客户端套接字：如何将附加数据传递给服务器？

> ID：13012116
> 
> 赞同：0
> 
> 时间：2012-10-22T13:04:48.003
> 
> 标签：c#, sockets, asynchronous

我正在研究使用异步客户端-服务器套接字的 MSDN 示例代码。我了解当建立新的客户端连接时这是怎么回事。

但是如果客户端已经连接，并且想要将一些新数据传递给服务器（或其他客户端），该怎么办？

这是我到目前为止所拥有的：

```
public partial class Form1 : Form
{
    AsynchronousClient ac;
    public Form1()
    {
        InitializeComponent();            
    }

    private void buttonLogin_Click(object sender, EventArgs e)
    {
        buttonLogin.Enabled = false;
        new Thread(new ThreadStart(CreatingConnection)).Start();
    }

    private void CreatingConnection()
    {
        ac = new AsynchronousClient();
        ac.SendingMessage += (msg) => AC_SendingMassage(msg);
        ac.StartClient();
    }

    private void AC_SendingMassage(string message)
    {
        listBox1.Invoke((MethodInvoker)delegate { listBox1.Items.Add(message); });
    }

    private void buttonData_Click(object sender, EventArgs e)
    {
        string message = textBox1.Text;
        //TODO:
        //how to send data from here (including whats in textBox)??
    }
} 
```

这是来自 msdn 示例的代码（2 个类）（仅适用于客户端）：

```
public class StateObject
{
    public Socket workSocket = null;
    public const int BufferSize = 256;
    public byte[] buffer = new byte[BufferSize];
    public StringBuilder sb = new StringBuilder();
}

public class AsynchronousClient
{
    public event Action<string> SendingMessage;
    // The port number for the remote device.
    private const int port = 11000;

    // ManualResetEvent instances signal completion.
    private static ManualResetEvent connectDone = new ManualResetEvent(false);
    private static ManualResetEvent sendDone = new ManualResetEvent(false);
    private static ManualResetEvent receiveDone = new ManualResetEvent(false);

    // The response from the remote device.
    private string response;

    public void StartClient()
    {
        // Connect to a remote device.
        try
        {
            // Establish the remote endpoint for the socket.
            string ip = "192.168.1.101";
            IPAddress ipAddress = IPAddress.Parse(ip);
            IPEndPoint remoteEP = new IPEndPoint(ipAddress, port);

            // Create a TCP/IP socket.
            Socket client = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);

            // Connect to the remote endpoint.
            client.BeginConnect(remoteEP, new AsyncCallback(ConnectCallback), client);
            connectDone.WaitOne();

            // Send test data to the remote device.
            Send(client, "This is a test<EOF>");
            sendDone.WaitOne();

            // Receive the response from the remote device.
            Receive(client);
            receiveDone.WaitOne();

            // Write the response to the console.
            SendingMessage(string.Format("Response received : {0}", response));

            // Release the socket.
            client.Shutdown(SocketShutdown.Both);
            client.Close();
        }
        catch (Exception e)
        {
            SendingMessage(e.Message);
        }
    }

    private void ConnectCallback(IAsyncResult ar)
    {
        try
        {
            // Retrieve the socket from the state object.
            Socket client = (Socket)ar.AsyncState;

            // Complete the connection.
            client.EndConnect(ar);

            //Console.WriteLine("Socket connected to {0}", client.RemoteEndPoint.ToString());
            SendingMessage(string.Format("Socket connected to {0}", client.RemoteEndPoint.ToString()));

            // Signal that the connection has been made.
            connectDone.Set();
        }
        catch (Exception e)
        {
            //Console.WriteLine(e.ToString());
            SendingMessage(e.Message);
        }
    }

    private void Receive(Socket client)
    {
        try
        {
            // Create the state object.
            StateObject state = new StateObject();
            state.workSocket = client;

            // Begin receiving the data from the remote device.
            client.BeginReceive(state.buffer, 0, StateObject.BufferSize, 0, new AsyncCallback(ReceiveCallback), state);
        }
        catch (Exception e)
        {
            SendingMessage(e.Message);
        }
    }

    private void ReceiveCallback(IAsyncResult ar)
    {
        try
        {
            // Retrieve the state object and the client socket from the asynchronous state object.
            StateObject state = (StateObject)ar.AsyncState;
            Socket client = state.workSocket;

            // Read data from the remote device.
            int bytesRead = client.EndReceive(ar);

            if (bytesRead > 0)
            {
                // There might be more data, so store the data received so far.
                state.sb.Append(Encoding.ASCII.GetString(state.buffer, 0, bytesRead));

                // Get the rest of the data.
                client.BeginReceive(state.buffer, 0, StateObject.BufferSize, 0, new AsyncCallback(ReceiveCallback), state);
            }
            else
            {
                // All the data has arrived; put it in response.
                if (state.sb.Length > 1)
                {
                    response = state.sb.ToString();
                }
                // Signal that all bytes have been received.
                receiveDone.Set();
            }
        }
        catch (Exception e)
        {
            SendingMessage(e.Message);
        }
    }

    public void Send(Socket client, string data)
    {
        // Convert the string data to byte data using ASCII encoding.
        byte[] byteData = Encoding.ASCII.GetBytes(data);

        // Begin sending the data to the remote device.
        client.BeginSend(byteData, 0, byteData.Length, 0, new AsyncCallback(SendCallback), client);
    }

    private void SendCallback(IAsyncResult ar)
    {
        try
        {
            // Retrieve the socket from the state object.
            Socket client = (Socket)ar.AsyncState;

            // Complete sending the data to the remote device.
            int bytesSent = client.EndSend(ar);
            //Console.WriteLine("Sent {0} bytes to server.", bytesSent);
            SendingMessage(string.Format("Sent {0} bytes to server.", bytesSent));
            // Signal that all bytes have been sent.
            sendDone.Set();
        }
        catch (Exception e)
        {
            SendingMessage(e.Message);
        }
    }
} 
```

-- 上面有一个 buttonData 的点击事件，我想用它来将数据传递给服务器。我想知道在已经连接时调用哪种方法来传递新数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T15:15:02.833

您将使用该`Send`方法发送数据。但是，此示例代码看起来实际上只是为了向您展示其中一些异步方法是如何工作的。该`StartClient`方法会关闭所有内容，这可能不是您想要做的。您可能需要编写自己的代码来执行此操作。

# c# - “您要打开还是保存”不显示

> ID：13012119
> 
> 赞同：1
> 
> 时间：2012-10-22T13:05:19.230
> 
> 标签：c#, excel, razor, asp.net-mvc-4

我的代码：

```
 [AcceptVerbs(HttpVerbs.Get)]
    public ActionResult Export()
    {
        DataTable table = ListToDataTable();

        var rows = table.AsEnumerable().AsQueryable() as IEnumerable<DataRow>;
        var output = CreateXlsStream(rows);
        return File(output, "application/vnd.ms-excel", "Export.xls");
    } 
```

“您要打开还是保存”未显示。我想在执行此“返回文件（输出，“应用程序/vnd.ms-excel”，“导出.xls”）后默认显示“您要打开还是保存”；线。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T13:35:20.780

这应该工作：

```
Response.AppendHeader("Content-Disposition", "inline; filename=Export.xls");
return File(... 
```

# matlab - Vim：每次都在同一个外部程序中运行代码

> ID：13012128
> 
> 赞同：2
> 
> 时间：2012-10-22T13:05:39.597
> 
> 标签：matlab, vim

我知道我可以使用外部程序在 vim 中运行我的代码，但我希望该程序每次都能保持运行并接收我的代码 - 而不是每次都重新运行外部程序。

例如：我在 vim 中编辑我的 Matlab 文件，我想运行它。但是，我希望 matlab 实例位于后台，并且 vim 将在我需要时使用相同的实例来继续运行我的文件，而不是每次都打开一个新的 matlab。

那可能吗？谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-22T13:33:31.863

当您可以配置外部程序（或者可能在其周围添加包装器）以在文件被修改时自动重新运行文件时（在 Vim 中通过保存它，或从其他任何地方），实际上没有什么可以从 Vim 触发（除了可能初始程序启动）。这是理想的情况。

在所有其他情况下，您需要从 Vim 到外部程序的通知机制。这是否可能以及如何执行取决于外部程序，但通常这很困难。有一些插件可以在保存时在浏览器中重新加载 HTML 页面，但恐怕没有通用的解决方案。那么最好重新考虑你的整个方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-22T21:08:43.383

我主要对matlab也有这个问题。我所做的是一个映射： - 将编辑的文件名（或其中的一部分）复制到临时剪贴板 - 使用 wmcrtl 切换到 matlab 然后我进入 matlab，所以我只需键入“Ctrl-V”和脚本运行。然后可以自动返回 vim。在此处查看示例： [Vim and matlab GUI - Emulate matlab Run (<F5>) with Vim](https://stackoverflow.com/questions/10250367/vim-and-matlab-gui-emulate-matlab-run-f5-with-vim)

# java - 运行 servlet 应用程序时出现空白屏幕

> ID：13012131
> 
> 赞同：0
> 
> 时间：2012-10-22T13:05:53.237
> 
> 标签：java, jakarta-ee, web-applications

我刚刚开始研究 servlet，我是新手。我开发了一个带有调用 servlet 的提交按钮的 html 页面。这里是它的 html 代码。

```
<html>
<head>
<title>A simple revision of servlets</title>
</head>
<body>
<form method="POST" action="Idiot">
    <input type="SUBMIT">
</form>
</body>
</html> 
```

部署描述符如下命名为 web.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns="http://java.sun.com/xml/ns/javaee"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
version="2.5">
<servlet>
<servlet-name>TangoCharlie</servlet-name>
<servlet-class>com.example.web.Revise</servlet-class>
</servlet>
<servlet-mapping>
<servlet-name>TangoCharlie</servlet-name>
<url-pattern>/Idiot</url-pattern>
</servlet-mapping>
</web-app> 
```

servlet的代码如下，命名为:Revise.java

```
package com.example.web;

import javax.servlet.*;
import javax.servlet.http.*;
import java.io.*;

public class Revise extends HttpServlet
{
public void doPost(HttpServletRequest request,HttpServletResponse response) throws IOException,ServletException
{
    response.setContentType("text/html");
    PrintWriter out=response.getWriter();
    //out.println("<html><body><h3>Hello</h3></body></html>");
    out.println("Hello");
}
} 
```

我在tomcat服务器的webapps中维护了以下目录。webapps->修订版->page.html

```
webapps->Revision->WEB-INF->web.xml

webapps->Revision->WEB-INF->classes->com->example->web->Revise.class 
```

当我在 Mozilla Firefox 中运行 page.html 并单击提交时，我得到一个空白页。当我在 Chrome 中运行 page.html 时，我收到以下消息：

```
Server error
The website encountered an error while retrieving http://localhost:8080/Revision/Idiot.It may be down for maintenance or configured incorrectly.
Here are some suggestions:
Reload this webpage later.
HTTP Error 500 (Internal Server Error): An unexpected condition was encountered while the server was attempting to fulfill the request. 
```

我哪里错了？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T13:18:56.443

`http://localhost:8080/Revisio/Idiot`

看错字和**不是****_**`Revision` **`Revisio`**

 *** * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-22T13:31:38.527

正如@Metalhead 所建议的，我只需要重新启动tomcat。

错字“Revisio”是我在复制和粘贴过程中的错误，因为 chrome 上的页面在右侧展开，我错过了“修订”中的那个字符“n”。对此我深表歉意。**

# html - CSS：我无法在背景图像中居中正文内容

> ID：13012132
> 
> 赞同：1
> 
> 时间：2012-10-22T13:05:53.550
> 
> 标签：html, css, background, css-float

我尝试为网站的主体添加背景，我想显示完整的背景，并将网站的内容居中放置在其中。

我使用了以下 CSS，但无法居中：

```
body {
  margin: auto;
  background: url(../images/bggeneral.jpg) top center repeat;
  background-position: center;
  font-size: 100%;
  line-height: 1.0625em;
  color: #515151;
  width: 100%;
} 
```

背景图片： http: [//www.comicar.ma/assets/images/bggeneral.jpg](http://www.comicar.ma/assets/images/bggeneral.jpg)

我需要裁剪图像或类似的东西吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-22T13:11:15.067

`repeat`如果您不想重复身体图像，您可以删除。并且`margin:0 auto`应该给容器div。

**HTML**

```
<div class="wrapper">
Content
</div>​ 
```

**CSS**

```
body {background: url(http://www.comicar.ma/assets/images/bggeneral.jpg) top center no-repeat; font-size: 100%; line-height: 1.0625em; color: #515151; width: 100%; }
.wrapper{width:700px; margin:0 auto} 
```

[**现场演示**](http://jsfiddle.net/GZ3zx/)

# python - 按属性 ip 对类实例列表进行排序

> ID：13012136
> 
> 赞同：1
> 
> 时间：2012-10-22T13:06:08.210
> 
> 标签：python, list, sorting, ip

我有点失落。我想对一个列表进行排序，其格式为：

```
[instance_of_myClass, instance_of_myClass, instance_of_myClass...] 
```

`init``myClass`看起来像这样：

```
def __init__(self):
   self.ip = ""
   self.hostname = ""
   self.further_informtion 
```

我希望它按它的 IP 地址排序，我发现它是

```
sorted(list_of_ips, key=lambda ip: long(''.join(["%02X" % long(i) for i in ip.split('.')]), 16)) 
```

从[如何在 Python 中对存储在字典中的 IP 地址进行排序？](https://stackoverflow.com/questions/6545023/how-to-sort-ip-addresses-stored-in-dictionary-in-python)

不过我在转移它时遇到了麻烦。有人可以帮我弄这个吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T13:16:28.140

根据文档：

***key 指定一个参数的函数，用于从每个列表元素中提取比较键。默认值为无。***

因此，您作为键提供的上述 lambda 函数的实际参数是您的“myClass”的实例，因此为了按 ip 对您的类实例进行排序，您应该这样编写：

```
key=lambda my_instace: long(''.join(["%02X" % long(i) for i in my_instance.ip.split('.')]), 16)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-22T13:18:40.177

```
[instance_of_myClass, instance_of_myClass, instance_of_myClass...].sort(lambda a, b: cmp(a.ip, b.ip)) 
```

# bundle - Microsoft.AspNet.Web.Optimization 未创建 Javascript 包

> ID：13012137
> 
> 赞同：2
> 
> 时间：2012-10-22T13:06:08.420
> 
> 标签：bundle, minify, bundling-and-minification, web-optimization

我正在按照以下链接的指导在 VS2010 网络表单网站中创建一个 javascript 包。

[http://igorzelmanovich.blogspot.co.uk/2012/09/using-aspnet-bundling-and-minification.html](http://igorzelmanovich.blogspot.co.uk/2012/09/using-aspnet-bundling-and-minification.html)

我的 global.asax 中有这个：

```
void Application_Start(object sender, EventArgs e) 
{
    // Code that runs on application startup

    System.Web.Optimization.BundleTable.Bundles.Add(new System.Web.Optimization.ScriptBundle("~/bundles/js").Include("~/scripts/jquery.bxSlider.js"));

} 
```

这在我的站点管理员中（注意我还没有将我的主要 jquery 源移动到包中）

```
 <script type="text/javascript" language="javascript" src="scripts/jquery-1.8.2.min.js"></script>

<%: System.Web.Optimization.Scripts.Render("~/bundles/js")  %> 
```

我已经从 Nuget 安装了 Microsoft.AspNet.Web.Optimization 包，它获得了所有二进制文件，并且网站构建成功。我尝试将 web.config 调试值设置为 true 和 false，但 bundles/js 文件夹不会使用包含 jquery.bxSlider.js 的包生成，我手动创建了 bundles/js 文件夹但仍然没有运气。

调试时 Application_Start 确实被调用，只是不生成任何东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T14:35:07.283

你得到这样的东西吗？

![在此处输入图像描述](../Images/d34262ad235d414f0acaf36be0265c3b.png)

还是空的？例如：`<script src="/bundle/js"></script>`

# actionscript-3 - 三位数字格式器

> ID：13012140
> 
> 赞同：0
> 
> 时间：2012-10-22T13:06:15.193
> 
> 标签：actionscript-3, apache-flex

我想以 3 位数字 (001-999) 显示数字。我不知道如何格式化这个数字。我可以轻松地格式化十进制数字，但不能这样做。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-22T13:17:32.443

这很容易...将您的转换`Number`为 a `String`，检查其长度，如果小于`3`，则在前面加上零。

例子：

```
var num:Number = 1;
var numStr:String = num.toString();

while(numStr.length < 3)
{
    numStr = '0' + numStr;
}

trace(numStr); // outputs 001 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-23T11:15:51.007

您可以使用[NumberUtils.format](http://templelibrary.googlecode.com/svn/trunk/modules/utils/doc/temple/utils/types/NumberUtils.html#format%28%29)或[StringUtils.padLeft使用](http://templelibrary.googlecode.com/svn/trunk/modules/utils/doc/temple/utils/types/StringUtils.html#padLeft%28%29)[Temple Library](http://templelibrary.googlecode.com/)来格式化数字。utils 位于[utils 模块](http://templelibrary.googlecode.com/svn/trunk/modules/utils/readme.html)内。

**使用`StringUtils.padLeft`**

```
var myValue:int = 3;
trace(StringUtils.padLeft(String(myValue), 3, '0'));
// outputs 003 
```

**使用`NumberUtils.format`**

```
var myValue:int = 3;
trace(NumberUtils.format(myValue, ',', '.', 0, 3));
// outputs 003 
```

# drupal-7 - 无法使用 drupal 7 简单新闻模块发送时事通讯

> ID：13012144
> 
> 赞同：3
> 
> 时间：2012-10-22T13:06:26.307
> 
> 标签：drupal-7

我已经安装了 Drupal 7 simple-news 模块及其依赖模块。我已完成[参考中的所有步骤](http://eureka.ykyuen.info/2012/04/03/drupal-7-create-newsletter-by-simplenews-1/)

但是在第 11 点，我找不到两个单选按钮，相反，我只找到了一个禁用的复选框，其中包含“此时事通讯待定”之类的文字

![在此处输入图像描述](../Images/7861ec03d7e8fe74d6312065b09212e9.png)

我在这里缺少什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-05-28T04:37:17.410

测试会立即进行，但是当您想要发送订阅者时，它将取决于 Drupal 的 Cron。您可以在配置菜单中更改此设置。默认情况下，Cron 每 3 小时运行一次，并在此之后发送您的时事通讯......您可以手动运行它

# javascript - 使用 onmouseover、onmouseout 进行操作

> ID：13012146
> 
> 赞同：0
> 
> 时间：2012-10-22T13:06:43.187
> 
> 标签：javascript, jquery

我有 div 标签（id=div_1），这个标签有几个相邻元素，在这个标签上的 moseout 之后，鼠标已经在其他元素上，对吗？我想在`div_1`标签上的 onmouseout 上，警报 id 元素，现在是鼠标悬停，如何做到这一点？

```
<div id="div_1" style="width: 100px; height: 100px; background-color: #090"></div>
<div id="div_2" style="width: 100px; height: 100px; background-color: #900"></div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-22T13:11:18.083

**更新**

在评论中，你说

> 我需要 id 其他元素，现在鼠标悬停在上面

那是一个不同的问题。为此，您需要知道鼠标已离开`div`，**并**知道它已输入其他内容。我可能会为此使用`mouseleave`and的组合`mouseover`，如下所示：

```
$("#div_1").mouseleave(function() {
    // We're leaving the div, set up to capture mouseover
    $("....selector for a container of these elements...").one("mouseover", function(e) {
        // Get the ID of the bottommost element
        console.log(e.target.id);

        // Or alternately, in case it doesn't have one
        var elementWithID = $(e.target).closest('[id]');
        if (elementWithID[0]) {
            console.log(elementWithID[0].id);
        }
    });
}); 
```

但我会非常非常努力地想出一种不同的方式来满足基本需求。

* * *

原答案：

简短版本：

```
$("#div_1").mouseout(function() {
    alert(this.id); // But I'd avoid alert if I were you, perhaps console.log?
}); 
```

但是请继续阅读...

长版：

当您使用 jQuery 设置事件处理程序时，调用该处理程序时，`this`是对您挂钩事件的 DOM 元素的引用，当然`id`也是属性的反射`id`属性。

但是请记住`mouseout` *气泡*`mouseout`，因此只要鼠标离开您（其任何后代）中的元素`div`，即使它没有离开`div`本身，您也会收到该事件。如果您只想知道它何时离开`div`但不离开其任何后代元素，请`mouseleave`改用（最初仅限 IE，但 jQuery 提供跨浏览器）。

如果您想将其概括为所有具有 class 的 div `foo`：

```
$("div.foo").mouseout(function() { // Or, of course, mouseleav
    console.log(this.id);
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-22T13:12:36.217

这是你想要的吗？

**HTML**

```
<div id="container">
    <div id="1">1</div>
    <div id="2">2</div>
</div> 
```

**JavaScript**

```
$('#container > div').mouseover( function() {
    alert ($(this).attr('id'));
});​ 
```

**演示**

[http://jsfiddle.net/CFtP5/](http://jsfiddle.net/CFtP5/)

**编辑**

当不使用父元素来选择子元素时。只需使用*通配符*，如下所示：

**JavaScript**

```
$("[id^=div]").mouseover (function() {
    alert ($(this).attr('id'));
});​ 
```

**HTML**

```
<div id="div_1">1</div>
<div id="div_2">2</div>
<div id="div_3">3</div> 
```

**演示**

[http://jsfiddle.net/VPm8M/](http://jsfiddle.net/VPm8M/)

# scala - 在scala中使用异常是一种不好的做法吗？

> ID：13012149
> 
> 赞同：23
> 
> 时间：2012-10-22T13:06:56.550
> 
> 标签：scala, exception, error-handling, functional-programming

我已经多次看到使用 Option（用于简单值）或 Either[List[Error], T] 处理错误的 scala 代码。

这为这样的代码提供了空间

```
def createApplicationToken(accessToken: AccessToken): Either[List[Error], ApplicationToken] = {

// go to social info provider and fetch information
retrieveProviderInfo(accessToken).fold(
  errors  => Left(errors),
  info    => {
    // try to find user using the info from the provider
    // if it's not there, create user
    User.findOrCreateFromProviderInfo(info).fold(
      errors  => Left(errors),
      user    => {
        // try to create a fresh token and save it to the user
        user.refreshApplicationToken.fold(
          errors  => Left(errors),
          user    => Right(user.token)
        )
      }
    )
  }
) 
```

这会产生不太好的代码嵌套，迫使您处理每一步的失败，还迫使您让所有函数返回一个 Either[...]

所以我想知道是否

*   在scala（或一般的函数式编程）中不鼓励使用异常

*   使用它们有任何缺点（关于不变性或代码并发性）

*   异常与原则或函数式编程有某种冲突

*   您可以想出一种更好的方法来编写给定的示例

--

一旦使用 return 语句发现错误，可以通过退出函数来避免嵌套，但在 scala 中也不鼓励使用 return...

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-10-22T13:40:33.013

以下版本使用的正确投影是一个单子这一事实`Either`，并且与您的代码完全相同：

```
def createApplicationToken(accessToken: AccessToken) = for {
   info <- retrieveProviderInfo(accessToken).right
   user <- User.findOrCreateFromProviderInfo(info).right
   refr <- user.refreshApplicationToken.right
} yield refr.token 
```

并且在展示`Either`.

更一般地说，规则与 Java 中的规则相同：对异常情况使用异常。当你以这种方式工作时，你可能会发现你对*异常*的定义有点改变——例如，无效的用户输入并不是真正的异常，超时的网络请求并不是真正的异常，等等。

## `Either`从 Scala 2.12 开始偏右

您现在可以省略`.right`，因此从 Scala 2.12 开始，以下代码是等效的：

```
def createApplicationToken(accessToken: AccessToken) = for {
   info <- retrieveProviderInfo(accessToken)
   user <- User.findOrCreateFromProviderInfo(info)
   refr <- user.refreshApplicationToken
} yield refr.token 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-22T14:05:38.240

正如 om-nom-nom 所说，我问了一个类似的问题： [Throwing exceptions in Scala, what is the "official rule"](https://stackoverflow.com/questions/12886285/throwing-exceptions-in-scala-what-is-the-official-rule)

但这不是我问的唯一一个你可能感兴趣的问题，因为我曾经使用大量样板代码和大量缩进级别进行编码，因为模式匹配等......

* * *

*   您可以查看以下链接： [使用 Either 处理故障 -> 堆栈跟踪在哪里？](https://stackoverflow.com/questions/12449950/handling-failures-with-either-where-is-the-stacktrace)

*   也与错误处理有关，您可能会感兴趣： [Scala 中的方法参数验证，用于理解和单子](https://stackoverflow.com/questions/12307965/method-parameters-validation-in-scala-with-for-comprehension-and-monads) ，其中 Travis Brown 给出了更详细的答案，关于使用应用函子和 Scalaz 进行快速失败（第一个错误阻止过程）或收集一组操作的所有错误 相同的问题：[当返回类型为 Option[Error] 时处理快速失败的失败](https://stackoverflow.com/questions/13015438/handling-fail-fast-failures-when-the-return-type-is-optionerror)

*   您也可以查看使用按名称参数执行操作序列的此链接。它可能是在理解中使用正确投影的一个很好的选择，但是您不能创建中间结果:( [在 Scala 中使用一系列名称参数进行验证？](https://stackoverflow.com/questions/12993587/validation-with-a-sequence-of-by-name-parameters-in-scala) 我不知道它是否可以与您的代码一起使用示例，但在这种情况下我不这么认为（假设您的 refreshApplicationToken 没有副作用并返回新创建的不可变用户实例，而不是改变令牌变量）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-22T15:07:09.653

答案在理想和实用之间有所不同。理想情况下，避免使用异常。实际上，没有它们你就活不下去。

Scala 似乎偏爱单行代码，并且沿着这些线路 v2.10 具有新的 monad *Try*：

```
import scala.util.Try

def percentCompleted( total:Int, done:Int ): Int = Try (done * 100 / total) getOrElse 100

percentCompleted( 0, 10 )    // Catches divide-by-zero and returns 100% instead 
```

# apache - htaccess 重定向子 dmoain 和文件夹文件

> ID：13012154
> 
> 赞同：0
> 
> 时间：2012-10-22T13:07:15.783
> 
> 标签：apache, .htaccess

所以我们有一个开发站点，例如：test.domain.com/dev/filename.html 并且它已被 Google 索引，所以我需要将它们重定向到 www.newdomain.com/filename.html 但不仅仅是文件，还有文件夹/文件之类的。

test.domain.com/dev/example/filename.html

或 www.newdomain.com/example/example/filename.html

到

www.newdomain.com/filename.html

请注意，测试域上的 /dev/ 文件夹不能在重定向上推送？

有人对此有任何想法吗？

我试过了：

```
RewriteEngine On
RewriteBase /
RewriteCond %{HTTP_HOST} !test.domain.co.uk/dev/$ [NC]
RewriteRule ^(.*)$ http://www.newdomain.com/$1 [L,R=301] 
```

经过一些测试，这重定向到[http://www.newdomain.com/dev/page.html](http://www.newdomain.com/dev/page.html)，我需要删除 /dev/ .....

和一些其他的选择，同时四处寻找，但还没有满足要求。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T13:13:33.350

你还需要 RewriteCond 所以试试：

```
RewriteEngine on
RewriteCond %{HTTP_HOST} ^test.domain.com [NC]
RewriteRule ^(.*)$ http://www.newdomain.com/$1 [R=301,L] 
```

# iphone - 如何在iphone动画期间获取图像视图的当前位置

> ID：13012157
> 
> 赞同：0
> 
> 时间：2012-10-22T13:07:16.893
> 
> 标签：iphone

> **可能重复：**
> [如何在动画时获取 UIView 帧的原点和大小](https://stackoverflow.com/questions/4422500/how-to-get-uiview-frame-origin-and-size-while-animation)

```
 -(void)anothertarget1
{

    UIImage *uranus=[UIImage imageNamed:@"red-ball1.png"];

    imagev=[[UIImageView alloc]initWithFrame:CGRectMake(5, 10, 100, 100)];
    imagev.alpha=0.6;
    imagev.image=uranus;

    [self.view addSubview:imagev];

    CGPoint goal = CGPointMake(self.view.center.x+70,self.view.center.y+24);

    CGPoint center=imagev.center;
    NSLog(@"center=%f",center);

    UIViewAnimationOptions opt = UIViewAnimationOptionAllowUserInteraction;
    [UIView animateWithDuration:20 delay:0 options:opt animations:^{
        //forimageview1;
        imagev.center = goal;

    } completion:^(BOOL f) {
        imagev.hidden=YES;

    }];

} 
```

我想制作一个`UIImageview`在动画期间获取当前位置的对象，请帮助我

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T13:16:32.810

尝试使用更新显示速率的 CADisplayLink。

# python - 如何在 __init__ 上创建 __len__ 函数？

> ID：13012159
> 
> 赞同：1
> 
> 时间：2012-10-22T13:07:22.393
> 
> 标签：python, object, python-3.x, python-2.7

如何删除`__size`此对象中的属性？

```
class Object():
    def __init__(self, size):
        self.__size = size

    def __len__(self):
        return self.__size 
```

init 函数如何创建 len 函数？Lambda 函数 ?

PS：在我的真实案例中，我在这个 len 函数中要做一些计算，但是在实例化之后结果总是相同的（例如元组）。将此结果保存在没有任何隐藏属性的函数中可能会很棒。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-22T13:10:58.380

我不推荐这个，但你可以使用一个简单的 lambda 函数

```
class Object():
    def __init__(self, size):
        self.__len__ = lambda: size

>>> len(Object(3))
3 
```

我不推荐这样做的原因归结为 Python 之禅：显式优于隐式。简单胜于复杂。

如果您使用的是实例变量，那么它是显式的，您有更好的错误堆栈跟踪，您可以在`__len__`函数中使用 doctest，并且在阅读和更新代码时更容易理解代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-22T13:35:31.563

由于不可能让`__len__`实例属性通过 使用`len()`，因此您必须在类中定义它。但是由于没有其他限制，您可以定义一个实例属性`__len__`，这样您的命名空间就不会受到污染。

```
class MyObject(object):
    def __init__(self, size):
        self.__len__ = lambda: size
    def __len__(self):
        return self.__len__() 
```

这看起来令人困惑（因此可能会受到反对），但它确实有效。

它之所以有效`__len__()`，是因为作为`def`-ed 函数的类属性调用了实例属性`__len__()`，它是来自 的 lambda `__init__()`。

在展示了可能的情况之后，我不推荐它，因为它可能会非常令人困惑。

您的原始解决方案要好得多。

# android - 如何查询像android的QSB这样的SearchProviders？

> ID：13012163
> 
> 赞同：1
> 
> 时间：2012-10-22T13:07:34.100
> 
> 标签：android, android-contentprovider, android-searchmanager

我正在尝试查询所有可用的搜索提供程序，类似于快速搜索框的方式，以获取搜索建议列表。我忽略了那些我没有阅读权限的人。现在，一切都适用于立即返回结果的提供者。

但是，对于那些离开并从网络上获得结果的人，我无法获得任何结果。其中之一的示例是 IMDB 应用程序。我经常得到一个返回 null 的游标，其他时候我得到一些不正确的缓存结果。

任何人都知道如何最好地做到这一点？

在下面的示例中（在线程中运行），我只需等待一段时间以确保所有网络内容都已完成。我在 ChangeObserver 和 MyDataObserver 中等待回调，但我什么也没得到。我也尝试过使用 LoaderManager，但没有区别。我查看了 Android 快速搜索框的来源，但找不到任何线索。

```
SearchManager searchManager = (SearchManager)ProgDialog.this.getContext().getApplicationContext().getSystemService(Context.SEARCH_SERVICE);
List<SearchableInfo> searchables = searchManager.getSearchablesInGlobalSearch();

for(SearchableInfo si : searchables)
{
    if(si.getSuggestPackage() == null) continue;

    String query = title;
    Uri.Builder uriBuilder = new Uri.Builder();
    uriBuilder.authority(si.getSuggestAuthority());
    uriBuilder.scheme(ContentResolver.SCHEME_CONTENT);
    if(si.getSuggestPath() != null)
    {
        uriBuilder.appendEncodedPath(si.getSuggestPath());
    }
    uriBuilder.appendPath(SearchManager.SUGGEST_URI_PATH_QUERY);

    // get the query selection, may be null
    String selection = si.getSuggestSelection();

    // inject query, either as selection args or inline
    String[] selArgs = null;
    if (selection != null) {    // use selection if provided
        selArgs = new String[] { query };
    } else {                    // no selection, use REST pattern
        uriBuilder.appendPath(query);
    }

    Uri uri = uriBuilder.build();

    if(!canRead(uri))
    {
        continue;
    }
    c = context.getApplicationContext().getContentResolver().query(uri, null,
             selection, selArgs, null);
    if(c != null)
    {

       c.registerContentObserver(new ChangeObserver(c));
       c.registerDataSetObserver(new MyDataSetObserver(si.getSuggestPackage(), c));
       c.setNotificationUri(context.getContentResolver(), uri);
       Thread.sleep(8000); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T16:50:10.467

我稍微修改了你的代码，现在它可以工作了（对我来说）。请记住设置访问数据的权限（联系人、书签等）。

```
 if (searchableInfo.getSuggestPackage() == null)
            continue;

        Uri.Builder uriBuilder = new Uri.Builder();
        uriBuilder.authority(searchableInfo.getSuggestAuthority());
        uriBuilder.scheme(ContentResolver.SCHEME_CONTENT);

        String path = searchableInfo.getSuggestPath();
        if (path != null)
            uriBuilder.appendEncodedPath(path);
        else
            uriBuilder.appendPath(SearchManager.SUGGEST_URI_PATH_QUERY);

        // get the query selection, may be null
        String selection = searchableInfo.getSuggestSelection();

        // inject query, either as selection args or inline
        String[] selArgs = null;
        if (selection != null)
            // use selection if provided
            selArgs = new String[] { query };
        else
            // no selection, use REST pattern
            uriBuilder.appendPath(query);

        Uri uri = uriBuilder.build(); 
```

# mysql - ActiveRecord 执行原始 sql

> ID：13012165
> 
> 赞同：0
> 
> 时间：2012-10-22T13:07:37.097
> 
> 标签：mysql, ruby-on-rails, activerecord

我尝试创建具有中间结果的表格，专门用于报告。我正在做的是：

```
 ActiveRecord::Base.connection.execute(sql_query) 
```

sql_query 是：

```
SET SQL_SAFE_UPDATES=0;

      DROP TABLE IF EXISTS _by_people_daily;

      CREATE TEMPORARY TABLE _by_people_daily
      AS
      SELECT #{date_int} AS date_int,
             memberships.user_id AS user_id,
             ci.community_id,
             ci.content_id,
             contents.composite_type AS content_type,

             COUNT(views.id) AS views,
             COUNT(comments.id) AS comments,
             COUNT(shares.id) AS shares,
             COUNT(likes.id) AS likes,
             COUNT(uploads.id) AS uploads
      FROM community_items AS ci
        JOIN memberships ON memberships.community_id = ci.community_id
        JOIN contents ON ci.content_id = contents.id
        JOIN (SELECT '#{day_begin}' as start_date, '#{day_end}' as end_date) AS dates
        LEFT JOIN contents AS uploads
               ON uploads.id = ci.content_id
              AND uploads.user_id = memberships.user_id
              AND uploads.created_at BETWEEN dates.start_date AND dates.end_date
        LEFT JOIN comments
               ON comments.content_id = ci.content_id
              AND comments.user_id = memberships.user_id
              AND comments.created_at BETWEEN dates.start_date AND dates.end_date
        LEFT JOIN shares
               ON shares.content_id = ci.content_id
              AND shares.user_id = memberships.user_id
              AND shares.created_at BETWEEN dates.start_date AND dates.end_date
        LEFT JOIN likes
               ON likes.content_id = ci.content_id
              AND likes.user_id = memberships.user_id
              AND likes.created_at BETWEEN dates.start_date AND dates.end_date
        LEFT JOIN views
               ON views.viewable_id = ci.content_id
              AND views.viewable_type = 'Content'
              AND views.user_id = memberships.user_id
              AND views.created_at BETWEEN dates.start_date AND dates.end_date
      WHERE COALESCE(views.id, comments.id, shares.id, likes.id, uploads.id ) IS NOT NULL
        #{ " AND users.company_id = #{@company.id} " if @company }
      GROUP BY memberships.user_id, ci.community_id, ci.content_id, contents.composite_type ;

      DELETE FROM intermediate_by_people WHERE date_int = #{date_int} ;

      INSERT INTO intermediate_by_people
            (date_int, user_id, community_id, content_id, content_type, views, comments, shares, uploads, likes)
      SELECT date_int, user_id, community_id, content_id, content_type, views, comments, shares, uploads, likes
      FROM _by_people_daily ; 
```

我每次都会出错

```
ActiveRecord::StatementInvalid: Mysql2::Error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DROP TABLE IF EXISTS _by_people_daily; 
```

但是当我将查询传递给 mysql 客户端时，它工作正常。

我做错了什么以及如何使用 ActiveRecord 执行几个 sql 语句

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-22T13:32:57.853

ActiveRecord 的 MySQL 连接默认只能执行一条语句。要执行多个语句，`CLIENT_MULTI_STATEMENTS`(65536) 需要在创建连接时作为选项传递。代码可能如下所示：

```
ConnectionAdapters::MysqlAdapter.new(mysql, logger, [host, username, password, database, port, socket, 65536], config) 
```

You can find `ConnectionAdapters::MysqlAdapter.new` in your mysql gem, and override that method in `config/initializers`. [Here](http://spectator.in/2011/03/12/rails2-mysql2-and-stored-procedures/) is a detailed guide.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-22T13:09:32.243

您是否尝试转义查询？

```
DROP TABLE IF EXISTS `_by_people_daily` 
```

以下划线开头的表格在我看来很可疑。

**更新：**

看看我通过谷歌找到了什么：[http ://www.seanr.ca/tech/?p=75](http://www.seanr.ca/tech/?p=75)

# java - Android Activity 在后台 - 记录 GPS

> ID：13012172
> 
> 赞同：0
> 
> 时间：2012-10-22T13:08:04.227
> 
> 标签：java, android, android-activity, gps

我正在开发具有记录 GPS 位置的 Activity 的应用程序。它注册 LocationListener 更新并将记录的 Location 存储到 SQLite 数据库。我的问题是当用户隐藏我的应用程序或运行另一个应用程序时，我的应用程序和录制活动进入后台并可能被系统杀死。因此，不存储 GPS 数据。我希望即使应用程序进入后台，我的应用程序和记录活动仍会记录 GPS 位置。如何做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-22T13:13:48.153

[服务](http://developer.android.com/reference/android/app/Service.html)最适合您打算做的事情。

确保您启动服务`STICKY`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-22T13:11:36.093

使用 Android 的其他组件，`BroadcastReceiver`或者`Service`可以在没有任何 GUI 的情况下在后台运行的组件。

```
public class UploadData extends BroadcastReceiver
{
    private static LocationManager locationManager = null;
    private static LocationListener locationListener = null;

        @Override
    public void onReceive(Context context, Intent intent)
    {
          // Create and AlarmManager that will periodically fetch the GPS
    }
} 
```

在服务的情况下，

```
public class myservice extends Service 
{
    LocationManager locationManager = null;
    LocationListener loclistener = null;

        // Bind it, Its important
    public IBinder onBind(Intent intent) 
    {
        return null;
    }
    @Override
    public void onCreate() 
    {
            // Use AlarmManager to fetch the GPS periodically.
    }
} 
```

# php - PhpStorm、UML 图和 xmi 文件

> ID：13012174
> 
> 赞同：5
> 
> 时间：2012-10-22T13:08:21.433
> 
> 标签：php, uml, phpstorm, xmi

我有一个巨大的 PHP 项目，其中有很多类、接口、抽象层……我需要查看 UML 类图。我想知道 PhpStorm 是否可以生成一个？

我发现可以查看单个类的“图表”：右键单击文件资源管理器->图表->显示图表。然后我可以一个一个地手动添加类。

但这并不是我想要的。添加所有课程将需要永恒。我不需要交互式图表。我只需要查看我的项目的全貌。

另外，我尝试使用 PEAR 中的 PHP_UML。我已经使用它生成了 xmi 文件。但是有几个工具说它是无效的（Sparx Enterprise Architect、ArgoUML 和 Visual Paradigm）。并且似乎 PhpStorm 无法打开 xmi 文件（它以纯文本文件形式打开）。

所以，我的问题是：

1.  是否可以在 PhpStorm 中构建整个项目的 UML 图？

2.  是否可以让 PhpStorm “正确”打开 xmi 文件？

3.  有没有其他工具可以向我展示基于 xmi 的 ULM。

看起来像我找不到解决方案的非常微不足道的问题。

提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-23T00:50:38.373

1.  尝试使用工具窗口中项目根目录上的**Diagrams上下文菜单。**`Project View`
2.  不。
3.  不是我的领域，但[Visual Paradigm](http://www.visual-paradigm.com/)可能会有所帮助。不知道为什么它不适合你。他们还提供与 IntelliJ IDEA 的集成，因此您可以联系他们并询问他们是否有适用于 PhpStorm 的插件。

# django - 如何从视图中检索语言设置？

> ID：13012183
> 
> 赞同：0
> 
> 时间：2012-10-22T13:08:50.727
> 
> 标签：django, django-views, django-multilingual

我想用三种不同的语言建立一个非常小的站点。

基本上我想使用一个**视图**，根据所选语言将不同的数据发送回**相同的模板**（无论如何，所有数据都在一个表中）。

我刚刚通读了提供了很好概述的[国际化](https://docs.djangoproject.com/en/dev/topics/i18n/translation/#internationalization-in-python-code)文档，但我仍然不知道如何根据所选语言呈现正确的内容。似乎我可以使用[requestcontext](https://docs.djangoproject.com/en/1.2/ref/templates/api/#subclassing-context-requestcontext)类提取这些信息，但究竟如何呢？还是我把事情复杂化了？有人可以提供一个很好的例子吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-22T13:40:08.237

这应该可以解决问题

```
from django.utils import translation
language= translation.get_language_from_request(request)
translation.activate(language) 
```

也许[这个答案](https://stackoverflow.com/questions/12852805/issues-with-multiple-languages/12853503#12853503)也可以帮助你。

# android - Eclipse + Phonegap + Sencha touch ==> 调用本地运行的网络服务器

> ID：13012186
> 
> 赞同：0
> 
> 时间：2012-10-22T13:09:21.040
> 
> 标签：android, ajax, eclipse, cordova, sencha-touch

我已经在我的 Windows 电脑上安装了 xampp 和 mysql。我使用 sencha touch 1.x。我有一个在本地运行的网站。它位于“htdocs/website”下。它运行完美;-)

我开发了一个移动应用程序（它在“htdocs/mobile”下）。我首先使用谷歌浏览器测试了该应用程序。在应用程序中有一些对本地网络服务器的 ajax 调用（例如用户登录）。这完美地工作。我可以发送请求并收到响应。

我使用“Ext.util.JSONP.request”来调用 web 服务。

现在我安装了 eclipse、phonegap 和 ADT，在 eclipse 中创建了一个新的 android 项目。我启动本地网络服务器并在 Eclipse 中将我的应用程序作为 android 应用程序运行。

我没有错误。Android 模拟器启动并打开应用程序。但是当我打电话给我的网络服务器时，什么也没有发生。

怎么了？

谢谢

* * *

这是我对服务器的请求代码：

```
console.log("In checkLogin of logincontroller");

    Ext.util.JSONP.request({
        url: 'http://mywebsite:80/mobile/login.php',
        params: options.data,
        callbackKey: "callback",
        scope: this, 
        callback: function(response) {
            console.log("success");
            if (response.success == "true")
            {
                //save login locally on phone
                this.index(options);
            }
            else {
                Ext.Msg.alert(response.errors.reason, '');
                console.log("failure");
            }
        }
    }); 
```

单击手机上的登录按钮时，我看到消息“在登录控制器的检查登录中”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T13:37:38.723

您应该尝试使用 IP 地址 10.0.2.2 来访问您的本地 Web 服务器。问题是 127.0.0.1（或 localhost）代表您的模拟设备，而 10.0.2.2 代表主机环回接口（即使您切换开发机器也将始终有效）。

[在developer.android.com](http://developer.android.com/tools/devices/emulator.html#networkaddresses)上阅读有关特殊网络地址的更多信息

# php - sendmail 可以处理大量外发电子邮件吗？

> ID：13012191
> 
> 赞同：0
> 
> 时间：2012-10-22T13:09:48.710
> 
> 标签：php, email, sendmail

> **可能重复：**
> [PHP 群发电子邮件](https://stackoverflow.com/questions/3640127/php-mass-emailing)

sendmail 是否设计用于处理大量外发电子邮件？如果不是，有哪些 Linux 的开源免费邮件服务器通常用于大批量交付？

我正在寻找可以每天发送 200k 时事通讯并拥有 PHP 库的东西。

P/S：我的网站现在在专用服务器上。目前我正在使用 cronjobs 每 15 分钟发送 5k 份时事通讯。这个实现很快就会达到极限。

现在我想将邮件服务器拆分为另一个专用服务器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T13:40:14.290

您要发送的时事通讯的数量需要做几件事：

1.  服务器 - 如果您使用共享主机，大多数公司都不允许您发送这么多的新闻通讯。您可能需要获得具有大量资源的 VPS 或专用服务器。我建议你至少有两个。另请记住，您的电子邮件服务器将一直发送电子邮件，这将产生 cpu/ram 使用率。因此，最好仅将这些服务器用于发送新闻通讯。
2.  DKIM 密钥（由于您每天要发送大量电子邮件，您的域可能会进入垃圾邮件过滤器）
3.  SPF 记录 - 需要通过大多数垃圾邮件过滤器。

当我不得不这样做时，我有一个带有 4GB 内存的四核英特尔服务器。每日发送的时事通讯数量约为 35k。该服务器专门针对发送电子邮件进行了优化。邮件服务器是 james 邮件服务器，我延迟了邮件发送 - 我有一个守护进程每分钟收集大约 15-25 封电子邮件。这样服务器负载不会太高，我能够绕过大多数垃圾邮件过滤器。首先，我使用的是 sendmail，但我开始在发送一些电子邮件时遇到问题——它们是在发送后一两天收到的，或者根本没有收到。我找不到问题所在，所以我改用 James Mail Server，它处理得很好。

在我看来，您应该将注意力更多地集中在您将获得的服务器上。您将需要大量的 CPU、内存和网络才能每天发送约 20 万份时事通讯。至于电子邮件服务器 - 您需要尝试一下，看看哪一个最适合您。另外，如果您有稳定的托管基础​​设施，您可以轻松更改邮件服务器。

另请记住，您可能需要多台服务器才能及时发送这些新闻通讯。如果您想在 24 小时内发送 200k 封电子邮件，这意味着您需要每小时发送约 8333 封电子邮件。这是很多CPU负载。您可能希望拆分作业并拥有两个、三个或一个僵尸网络服务器来快速处理任务。

我希望这有帮助。

PS 查看作为[评论](https://stackoverflow.com/questions/3640127/php-mass-emailing)添加的@hakre 帖子。您还应该考虑使用[MailChimp](http://www.mailchimp.com/)和其他提供此类服务的替代公司的服务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-22T14:46:15.613

我最近转而使用 ElasticEmail (http://www.elasticemail.com)，因为我发现它们的 API 对于某些应用程序非常有用，而且它们的价格具有竞争力。我有很好的交付能力（一旦我设置了 SPF 记录）和他们的可靠性，到目前为止已经使用了大约 4-5 个月。如果您想将其保留在内部......您需要一个专用（至少是 VPS）服务器而不是共享托管计划。与您的托管服务提供商交谈，了解他们的限制。我希望这有帮助。

# php - 类型转换函数参数

> ID：13012195
> 
> 赞同：9
> 
> 时间：2012-10-22T13:09:59.530
> 
> 标签：php, function, casting

在输入函数之前，我想检查参数匹配的类型。

```
function ((int) $integer, (string) $string ) { /*...*/ } 
```

相对于

```
function ( $int, $string ) {
    $string = (string) $string;
    $int = (int) $int;
} 
```

有没有办法做到这一点？我也推测将其作为对象

```
function ( Integer $int ) { /*...*/ } 
```

通过这样做，我可以发送 a`functionName ( new Integer ( $int ));`但我希望没有添加的语法。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2018-07-13T10:05:19.297

从 PHP 7 开始，您现在可以在类型提示时使用标量类型（int、float、string 和 bool）。

```
function (int $int) { /*...*/ }
function (float $float) { /*...*/ }
function (string $string) { /*...*/ }
function (bool $bool) { /*...*/ } 
```

至于 OP 的问题，PHP 仅支持对象、接口和类型的类型提示`array`，但现在可以按照本机提出的问题来做。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-22T13:15:03.540

你当然可以对复杂类型（数组、接口和对象）使用所谓的[类型提示](http://php.net/manual/en/language.oop5.typehinting.php)——但不能使用原语（令我有点惊讶的是，还有特征）：

> 类型提示不能用于标量类型，例如 int 或 string。特征也是不允许的。

虽然有[很多建议](https://wiki.php.net/rfc/typechecking)将标量类型提示添加到 PHP（甚至还有一个非正式的[补丁](http://ilia.ws/archives/217-Scalar-Type-Hints-are-Here!.html)），但这并不容易。我建议查看[这篇文章](http://nikic.github.com/2012/03/06/Scalar-type-hinting-is-harder-than-you-think.html)，因为它很好地总结了不同方法的潜在缺陷。

PS BTW，看起来 PHP 5.5[可能会使用](http://nikic.github.com/2012/07/10/What-PHP-5-5-might-look-like.html#scalar_typehinting)“检查和转换”类型提示。不是说我很惊讶...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-22T13:13:20.063

对于**标量**，您可以使用 php **is_int()** .. **is_string()**函数进行检查。

对于数组和对象，您可以在函数调用中使用[类型提示。](http://php.net/manual/en/language.oop5.typehinting.php)

有传言说在下一个版本的 php 中还会有对标量的类型提示支持。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-22T13:14:04.903

在 php 5.5 的函数参数中会有标量类型转换的类型提示，但目前只有类，`array`&`callable`仅可用（从 php 5.4 开始）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-22T13:14:46.697

[http://php.net/manual/en/language.oop5.typehinting.php](http://php.net/manual/en/language.oop5.typehinting.php)

您不能为 INT 和 STRING 设置此类检查。

# validation - 如何验证是否输入了多个输入字段中的至少一个？

> ID：13012197
> 
> 赞同：4
> 
> 时间：2012-10-22T13:10:01.867
> 
> 标签：validation, jsf

我有一个包含 3 个字段的表单，并提交按钮。单击按钮时，如果在 3 个字段中未输入任何内容，则抛出验证消息。如果输入了 3 个字段中的任何一个，则处理数据并使用数据表在同一页面中显示结果。我可以为一个字段抛出验证消息，但不能为 2 个或更多字段抛出验证消息。这是我的代码。同样，如果我需要传递一个 long 值，并验证我该怎么做，因为 long 值不能被验证为`isEmpty()`or `isNull()`。

这是我的代码，我想将它与多个字段一起使用，并且对具有长值的字段进行验证。

```
<h:inputText id="userName" value="#{user.userName}" required="true"
    requiredMessage="Please enter username" />

<h:inputText id="empId" value="#{user.empId}" required="true"
    requiredMessage="Please enter Employee Id" />

<h:inputText id="acctNm" value="#{user.acctNm}" required="true" 
    requiredMessage="Please enter Employee Id" /> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-22T14:10:01.487

只需让`required`每个字段的属性检查其他字段的提交值是否存在。提交的值在参数映射中可用`#{param}`客户端 ID 作为键。

这是一个启动示例：

```
<h:form id="form">
    <h:inputText id="field1" ... required="#{empty param['form:field2'] and empty param['form:field3']}" />
    <h:inputText id="field2" ... required="#{empty param['form:field1'] and empty param['form:field3']}" />
    <h:inputText id="field3" ... required="#{empty param['form:field1'] and empty param['form:field2']}" />
</h:form> 
```

随着字段数量的增加，它只会变得更加丑陋。

或者，您可以使用[OmniFaces](http://omnifaces.org) [`<o:validateOneOrMore>`](http://showcase.omnifaces.org/validators/validateOneOrMore)：

```
<h:form id="form">
    <h:inputText id="field1" ... />
    <h:inputText id="field2" ... />
    <h:inputText id="field3" ... />

    <o:validateOneOrMore id="oneOrMore" components="field1 field2 field3" />
    <h:message for="oneOrMore" />
</h:form> 
```

请注意，在操作方法中执行验证是糟糕的设计。您应该为此使用标准 JSF 验证工具，例如`requiered`、和/或。`validator``<f:validator>``<f:validateXxx>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-22T09:26:12.713

至少对于 iceFaces 而言，另一种跨多个字段进行验证的方法，尤其是当验证比“必需”更复杂时，是在支持 bean 中使用应用程序级验证。

@see[支持 Beans 中的自定义验证器](http://www.icesoft.org/wiki/display/ICE/Validators#Validators-application)

*   将验证器属性添加到您的 rcomponent 并将其指向支持 bean 中的验证方法
*   在支持 bean 中，您现在可以访问所有表单字段并进行交叉验证

问候

抢

# machine-learning - 何时增加隐藏层和隐藏层中的特征数量如果训练本身的误差很高？

> ID：13012199
> 
> 赞同：1
> 
> 时间：2012-10-22T13:10:14.730
> 
> 标签：machine-learning, neural-network

我正在使用神经网络进行分类任务（1 个隐藏层和 10 个特征）。

结果不太好。我的训练数据集本身的错误率很高。

我现在该怎么办 ？

1.  我需要增加隐藏层中的节点数吗？会有什么影响？

2.  我是否需要增加隐藏层的输入特征数量？会有什么影响？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-22T15:01:26.990

鉴于您网络的当前配置并且不了解数据集的更多信息，我建议添加第二个隐藏层，其中只有几个节点（可能是 4 个）。这将允许生成的决策表面类型有更多的可变性（例如，单个类的多个不同的集群）。

即使您正在进行二进制分类，我也会将输出分成两个节点（一个为真，一个为假），并将最大值作为分类结果。我通常会看到这种方式更好的收敛，并且解释错误更直观。

# sql - 如何在没有 pk 的存储过程中循环遍历临时表

> ID：13012200
> 
> 赞同：5
> 
> 时间：2012-10-22T13:10:17.120
> 
> 标签：sql, sql-server, tsql, stored-procedures

**问题：**

我需要遍历一个表中的记录，提取员工编号并将此员工编号与另一个表进行比较，以查看他们是否仍然是活跃员工。如果他们不再是活跃的员工，我需要将此行中的数据传递到另一个存储过程中。

**研究：**

我已经用谷歌搜索了很多，并意识到我不应该为此使用游标。但是，我确实找到了以下示例：

1.  [http://ask.sqlservercentral.com/questions/7969/loop-through-records-in-a-temporary-table.html](http://ask.sqlservercentral.com/questions/7969/loop-through-records-in-a-temporary-table.html)
2.  [http://eedle.com/2010/11/11/looping-through-records-in-sql-server-stored-procedure/](http://eedle.com/2010/11/11/looping-through-records-in-sql-server-stored-procedure/)

但是，似乎他们使用 pk 来遍历记录。在我的场景中，多个记录的员工编号可以相同

**问题：**

1.  是否有可能在没有游标的情况下实现我正在尝试的目标？
2.  如果可能的话，我将如何获取具有非唯一列的每一行？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-22T13:24:11.270

由于您没有向我们提供您的情况的完整描述，我们无法给出完整的答案，但是，一般来说，您希望在 SQL 等基于集合的语言中避免***循环****，而不是游标本身*（问题与光标是他们*需要*循环）。

在您的评论中，您提供了更多信息，因为您希望“*循环遍历第一个表，与第二个表进行比较，当比较失败时，我从第一个表中删除记录。本质上，我正在从第一个表中删除记录不再在公司工作的员工。* ”

以下是在 SQL 中执行此操作的方法：

```
DELETE  From FirstTable
WHERE   FirstTable.EmployeeID NOT IN
    (
        SELECT  SecondTable.EmployeeID 
        FROM    SecondTable
        WHERE   SecondTable.Flag = 'Y'
    ) 
```

不需要循环...

* * *

如果问题是您想使用预先存在的存储过程进行删除，那么有几种可能性：

首先，您可以提取存储过程的内容并针对这些前面的 WHERE 条件重新编写它们。我知道这是代码重复，它违反了某些人的 DRY 直觉，但是，我知道 SQL*不是*面向对象的开发环境，有时代码重复必须发生。

第二个选项是重构存储过程，以便它可以接受 TableParameter 为其 EmployeeId 删除。不过这很复杂，我们需要查看该存储过程来为您提供建议。

第三个选项是使用字符串聚合来构建动态 SQL 来为每个要删除的 EmployeeID 调用存储过程，如下所示：

```
DECLARE @sql As NVarchar(MAX);  
SET     @sql = N'';

SELECT  @sql = @sql + ' 
    EXEC YourProc ''' + CAST(EmployeeID As NVARCHAR(MAX)) + '''; '
FROM    FirstTable
WHERE   FirstTable.EmployeeID IN
    (
        SELECT  SecondTable.EmployeeID 
        FROM    SecondTable
        WHERE   SecondTable.Flag = 'Y'
    )

EXEC(@sql); 
```

这避免了循环和 Cusror 问题，尽管许多人也不喜欢它。我自己更喜欢这个解决方案，主要是因为它的普遍性。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-22T13:24:53.340

如果您当前的员工表中没有匹配的行，这将从您的员工数据表中删除所有记录。

我建议您将其替换为`DELETE FROM`，`SELECT * FROM`然后当您愿意删除结果时将其更改回`DELETE`

```
DELETE FROM
    EmployeeDataTable
WHERE
    NOT EXISTS
    (SELECT 
        NULL
    FROM
        CurrentEmployees
    WHERE
        EmployeeDataTable.EmployeeID = CurrentEmployees.EmployeeID
    ) 
```

编辑：刚刚看到您对 Active 标志的评论，这意味着可以将查询更改为

```
DELETE FROM
    EmployeeDataTable
WHERE
    EXISTS
    (SELECT 
        NULL
    FROM
        CurrentEmployees
    WHERE
        EmployeeDataTable.EmployeeID = CurrentEmployees.EmployeeID
        CurrentEmployees.IsActive <> 'Y'
    ) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-22T13:37:12.417

我会通过循环游标来做到这一点。您还可以向光标添加唯一 ID，以便您知道当前所在的行。

```
DECLARE @id uniqueidentifier 
DECLARE @empName   VARCHAR(50)

SELECT newId() AS Id, *
    INTO #mytemp
    FROM MyEmployees
    ORDER BY EmpName

while EXISTS(SELECT TOP 1 1 FROM #mytemp)
BEGIN
    --Get row from cursor to process
    SELECT TOP 1 @id = Id, @empName = EmpName FROM #mytemp  

    --Do you processing here. Call other stored proc.

    --Remove processed row from cursor.
    DELETE FROM #mytemp WHERE Id = @id  
END
DROP TABLE #mytemp 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-22T13:47:33.763

您是否考虑过使用该`MERGE`声明：[http ://technet.microsoft.com/en-us/library/bb510625.aspx](http://technet.microsoft.com/en-us/library/bb510625.aspx)

您有以下条款：

1.  当两个表之间的数据确实匹配时
2.  当数据存在于源中，但不存在于目标中时
3.  当数据存在于目标中，但不存在于源中时

然后，您可以根据匹配类型插入、更新或删除记录。您还可以将匹配中的操作输出到临时表以进行其他自定义操作。

例如，您可以这样做：

```
MERGE INTO Table1
USING Table2 ON Table1.EmployeeID = Table2.EmployeeID
WHEN MATCHED 
    THEN UPDATE SET Table1.SomeField = Table2.SomeOtherField
WHEN NOT MATCHED BY SOURCE
    THEN DELETE
WHEN NOT MATCHED BY TARGET
    THEN Insert (Name, Status) VALUES (EmployeeName, 'Active') 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-22T13:25:33.673

1.  如果您从要在光标内调用的存储过程中获取内容并在当前存储过程中实现该逻辑，那么这是可能的。此时，您应该能够使用基于集合的逻辑。您调用的存储过程非常复杂吗？
2.  向临时表添加标识列怎么样？

有时，出于各种原因，游标是正确的解决方案。

# r - 使用 biomart 查找转录起始位点

> ID：13012210
> 
> 赞同：3
> 
> 时间：2012-10-22T13:11:07.227
> 
> 标签：r, bioconductor

我`biomaRt`在 R 中使用来查询 ensembl 的`hsapiens`人类基因数据库。我正在使用该函数`getBM`来获取所有基因的名称、起始位置和终止位置，但我找不到用于检索 TSS（转录起始位点）的正确属性。可能是因为它被认为与 相同`seqType= c("3utr", "5utr")`？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-22T15:51:36.860

可以使用在数据框中检索可查询属性的完整列表`listAttributes`。然后只需在其中搜索您想要的属性即可。

```
mart <- useDataset("hsapiens_gene_ensembl", useMart("ensembl"))
att <- listAttributes(mart)
grep("transcript", att$name, value=TRUE) 
```

会给你一个相当长的清单，像这样开始

```
 [1] "ensembl_transcript_id"                                        
 [2] "transcript_start"                                             
 [3] "transcript_end"                                               
 [4] "external_transcript_id"                                       
 [5] "transcript_db_name"                                           
 [6] "transcript_count"                                             
 [7] "transcript_biotype"                                           
 [8] "transcript_status"                                            
 [9] "clone_based_ensembl_transcript_name"                          
[10] "clone_based_vega_transcript_name" 
```

然后您可以继续使用这些名称进行查询

```
getBM(attributes=c("transcript_start", "transcript_end"),
      filters="hgnc_symbol", values="foxp2", mart=mart) 
```

你得到

```
 transcript_start transcript_end
1         113726382      114330960
2         113726494      114271639
3         113726615      114330155
4         113728221      114066565
5         113728221      114271650
6         114054329      114330218
7         114055052      114139783
8         114055052      114333827
9         114055110      114330155
10        114055113      114330200
11        114055275      114269037
12        114055374      114285885
13        114055378      114330012
14        114066555      114294198
15        114066557      114271754
16        114066557      114282629
17        114066570      114294198
18        114055052      114333823
19        114268613      114329981
20        113726615      114310038 
```

如果您希望*所有基因的**所有*转录本都删除`filter`和`values`参数，但请注意您将获得大量数据。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-02-22T02:00:33.970

现在有一个可以下载的转录起始站点的特定属性：`transcription_start_site`.

```
library("biomaRt")
ensembl = useMart("ensembl", dataset = "hsapiens_gene_ensembl")
attributes = listAttributes(ensembl, page = "structure")
attributes[grep("transcript", attributes$description, ignore.case = TRUE), ]
#                         name                                description
# 178    ensembl_transcript_id                      Ensembl Transcript ID
# 183         transcript_start                      Transcript Start (bp)
# 184           transcript_end                        Transcript End (bp)
# 185 transcription_start_site             Transcription Start Site (TSS)
# 186        transcript_length Transcript length (including UTRs and CDS)
# 195         transcript_count                           Transcript count
# 201                     rank                    Exon Rank in Transcript 
```

例如，这里是基因 BTC 的结果。请注意，因为它位于反向链 ( `strand == -1`) 上，所以 的值`transcription_start_site`与 的值相同`transcript_end`。基本上，下载`transcription_start_site`是一种捷径，因此您不必根据基因所在的链来确定转录本的哪一端是 TSS。

```
tss <- getBM(attributes = c("transcription_start_site", "chromosome_name",
                            "transcript_start", "transcript_end",
                            "strand",  "ensembl_gene_id",
                            "ensembl_transcript_id", "external_gene_name"),
             filters = "external_gene_name", values = "BTC",
             mart = ensembl)
tss
# transcription_start_site chromosome_name transcript_start transcript_end strand
# 1                 75635873     HG706_PATCH         75612096       75635873     -1
# 2                 75660403     HG706_PATCH         75610476       75660403     -1
# 3                 75719896               4         75669969       75719896     -1
# 4                 75695366               4         75671589       75695366     -1
# ensembl_gene_id ensembl_transcript_id external_gene_name
# 1 ENSG00000261530       ENST00000567516                BTC
# 2 ENSG00000261530       ENST00000566356                BTC
# 3 ENSG00000174808       ENST00000395743                BTC
# 4 ENSG00000174808       ENST00000512743                BTC 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-21T19:25:42.670

我相信“transcript_start”和“transcript_end”是翻译开始和停止站点，但不一定是TSS（转录起始站点）。

查看“start_position”和“end_position”属性，这些似乎是 TSS（+ 链的 start_position 和 - 链的 end_position），因为它们始终是 + 链的不同转录本和- 链的最大数量的 transcript_end 选项。

# javascript - AngularJS 高级缓存技术

> ID：13012216
> 
> 赞同：2
> 
> 时间：2012-10-22T13:11:19.743
> 
> 标签：javascript, caching, angularjs

我已经阅读了有关 $cacheFactory 的内容，当涉及到 $http 时，它会通过 url 缓存所有内容。现在，我有一些更复杂的需求：

1.  有一些项目的列表（用户、文章等）。该列表从服务器中提取并缓存到缓存中。

2.  当应用程序请求单个项目时，它会进入缓存并：

    2.1。如果具有提供的密钥的项目存在，它将从缓存中提取

    2.2\. 如果缓存列表中不存在该项目，它会转到服务器，当从服务器获得响应时，将该项目放入缓存列表，以便下次从缓存中拉出

3.  当项目被保存到数据库时，它会获得一些密钥（自动编号或 guid）并且当服务器解析响应时：

    3.1。如果项目已存在于缓存中，则项目将与服务器数据合并/扩展

    3.2\. 如果缓存中不存在项目，则只需将其添加到列表中

4.  应用程序应该检查（每 10 秒）列表中是否有一些新的/更新的/删除的项目（由其他用户创建）并刷新它（对当前用户工作没有重大影响）

现在，1-3 很容易，4 应该手动启动或放入一些计时器。

额外的复杂性是当您有无限数量的查询组合时如何处理搜索。

我知道如何开发所有这些，但我想知道是否已经有针对 AngularJs 或通常用于 javascript 和 ajax 调用的经过验证的解决方案。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-22T18:06:51.010

可能需要创建自己的服务来做到这一点。

类似的东西（伪代码，因为我没有服务器来支持这些）......

```
app.factory('andrejsSuperAwesomeService', ['$cacheFactory', '$http', function($cacheFactory, $http) {

   //get your cache ready.
   var userCache = $cacheFactory('users');

   // start an interval to check for data.
   // TODO: add a public function to turn this on and off.
   setInterval(function(){
       //check for changes to the data.
       $http.get('/Get/New/User/Changes')
            .success(function(changes) {
                 if(!changes) return;
                 //we'll assume we get some collection of changes back,
                 // with some change type and the user data.
                 for(var i = 0; i < changes.length; i++) {
                      var change = changes[i];
                      switch(change.changeType) {
                          case 'delete':
                             // okay just remove the deleted ones.
                             userCache.remove(change.user.id);
                             break;
                          case 'addUpdate':
                             // if it's added or updated, let's just 
                             // remove and re-add it, because we can't know what
                             // we already have or don't have.
                             userCache.remove(change.user.id);
                             userCache.put(chnage.user.id, change.user);
                             break;
                      }
                 }
            });
   }, 10000); // every 10 secs
   return {
      users: {
           //a function to get a user. 
           get: function(userId, callback) {
               var user = userCache.get(userId);

               if(!user) {
                     //the user is not in the cache so let's get it.
                     $http.get('/Uri/To/Get/A/User?userId=' + userId)
                        .success(function(data) {
                           //great, put it in the cache and callback.
                           userCache.put(userId, data);
                           if(callback) callback(data);
                        });
               } else {
                     //we already have the user, callback.
                     if(callback) callback(data);
               }
           }
      }
   };
}); 
```

然后在您的控制器中，您将注入您的服务并像这样使用它：

```
andrejsSuperAwesomeService.users.get(12345, function(user) {
       //do something with user here.
       alert(user.name + ' is a naughty user!');
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-27T20:26:30.477

据我所知，还没有人做过这个，所以我自己做了，遵循 $http 和 Restangular 的标准使用。如果你想添加它，绝对是 fork 和 pull request。

[https://github.com/learnist/angular-cache-proxy](https://github.com/learnist/angular-cache-proxy)

# vb6 - Visual Basic 6 中的一个语句中的多个变量赋值

> ID：13012230
> 
> 赞同：2
> 
> 时间：2012-10-22T13:12:15.393
> 
> 标签：vb6, variable-assignment

使用遗留代码时，我遇到了一些奇怪的变量赋值，我不确定它们是否是合法的 VB6 语法，但我找不到支持这种感觉的文档。

```
Dim ComStart, ComEnd, CR As Boolean
ComStart = ComEnd = CR = False 
```

我的怀疑是

a) 原始声明应为

`Dim ComStart as Boolean, ComEnd as Boolean, CR as Boolean`

b）现在实施的声明不会分配任何东西给`ComStart`.

非常感谢任何答案或文档

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-22T14:44:05.697

您找到的代码在技术上是*合法*的VB6，因为它可以编译和运行。但很有可能原作者认为代码会做一些不同的事情！有两个误解。

*   `ComStart`和是变体，`ComEnd`而`CR`不是布尔值。
*   在 VB6`=`中是相等运算符，而不是 C 中的赋值运算符。
    *   `CR = False`不改变 的值`CR`。`CR`它比较to的当前值`False`，并评估为`True`if `CR`is equal to `False`。假设它评估为`False`
    *   现在你有了表达式`ComEnd = False`。同样，这不会改变 的值`ComEnd`。它将它与 进行比较`False`，并评估为`True`好像`ComEnd`等于`False`。这次假设它评估为`True`。
    *   现在你有了*赋值语句* `ComStart = True`。这将值设置`ComStart`为`True`

所以你的原始代码

```
Dim ComStart, ComEnd, CR As Boolean
ComStart = ComEnd = CR = False 
```

创建两个变体`ComStart`和`ComEnd`一个 Boolean `CR`，然后

*   `CR`保持其默认值，`False`
*   `ComEnd`保持[默认值](https://stackoverflow.com/questions/4284216/what-is-the-default-value-for-an-unset-variant-in-vb6)，`Empty`
*   `ComStart`设置为`False`因为`Empty = (Empty = False)`is `False`。

简单的！...我希望遗留代码的其余部分更少，好吧，*偶然*。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-22T14:43:53.583

所以代码应该是，正如你猜到的：

```
Dim ComStart as Boolean, ComEnd as Boolean, CR as Boolean 
```

对于经验很少或没有经验的 VB6 开发人员或使用 VB6 代码的 .NET 开发人员来说，这是一个常见的错误 :)。它可以工作，因为 VB6 将假定分配的值并自动转换它，但它也可能导致难以调试的讨厌的错误。

# xcode - xcode 上是否有复制此主题的主题？

> ID：13012232
> 
> 赞同：2
> 
> 时间：2012-10-22T13:12:22.917
> 
> 标签：xcode

我偶然发现了一张带有我喜欢的配色方案的屏幕截图。有没有人有类似的xcode？![在此处输入图像描述](../Images/84bfd90802d778629bb93d4c9639caee.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-22T13:18:32.037

[看起来像是来自 adobe](http://blogs.adobe.com/typblography/2012/09/source-code-pro.html)的 Announceing Source Code Pro Blog 帖子中的配色方案

在评论的某处，用户 Woz 说配色方案看起来像[Solarized](http://ethanschoonover.com/solarized)。最后在那个站点上有一个指向solarized 的[Xcode 4 work in progress](https://github.com/brianmichel/solarized/tree/master/apple-xcode4-solarized)分支的链接。

我还没试过。

# regex - 如何从它应该匹配的字符串列表中自动生成优化的正则表达式

> ID：13012235
> 
> 赞同：1
> 
> 时间：2012-10-22T13:12:30.230
> 
> 标签：regex

最近我正在寻找一个正则表达式，它可以检测连接到我的 web 应用程序的用户代理是一个爬虫。

有许多爬虫，如 google、yahoo、bing、facebook 和许多其他爬虫，它们在 User-Agent 标头中宣传自己。所以基本上我认为可以编译一个正则表达式来尝试匹配给定字符串中的任何这些子字符串。它可以与 google|yahoo|bing|facebook 之类的正则表达式进行简单匹配，但如果给定字符串的列表足够大并且其中许多具有相似的前缀或后缀，则可能编译出更有效的正则表达式。（为了这个确切的目的，internetz 上漂浮着人类编译器正则表达式）。

那么，是否有一种工具或算法可以在这种情况下使用，给定一个单词列表，返回一个正则表达式，以确定输入字符串中是否有任何单词匹配？

PS 我想起了这一点，因为今天在 ycombinator [http://regex.inginf.units.it/](http://regex.inginf.units.it/)上发布了非常相似的内容，这是使用遗传算法的求解器。似乎在一般情况下，它可能是 NP 难题，但如果它适用于 20-30 个单词的简单列表，它仍然很有用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T13:26:51.907

fgrep 中使用的[Aho-Corasick 字符串匹配算法](http://en.wikipedia.org/wiki/Aho%E2%80%93Corasick_string_matching_algorithm) 几乎完全做到了这一点，尽管它构建了一个内部数据结构来进行匹配而不是生成一个正则表达式。在链接到那里的维基百科页面上有 C、Python 等的实现，因此您可以将其包含在您的爬虫中。您将编译一次数据结构，并使用编译后的版本来测试每个用户代理。

# javascript - Javascript 命名空间中的全局变量

> ID：13012238
> 
> 赞同：1
> 
> 时间：2012-10-22T13:12:41.660
> 
> 标签：javascript

我是 Javascript 命名空间的新手，我有 2 个按钮`Add`& `Remove`，下面有以下脚本。

```
<script>
    var nRow=1;
    function Add() {
        nRow++;
        alert(nRow);
    }
    function Remove() {
        nRow--;
        alert(nRow);
    }
</script> 
```

我正在尝试将此脚本放在命名空间中并调用`onClick`按钮的功能。请告诉我如何将其放入命名空间并调用函数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-22T13:17:49.387

Javascript 没有命名空间或类。它有对象和原型。话虽如此，我相信这应该是您所要求的：

```
<script>
    window.myNameSpace = {
        nRow: 1,
        add: function () {
           this.nRow++;
           alert(this.nRow);
        },
        remove: function() {
            this.nRow++;
            alert(this.nRow);
        }
    };
    document.getElementById("MyAddButtonId").addEventListener("click", myNameSpace.add, false);
    document.getElementById("MyRemoveButtonId").addEventListener("click", myNameSpace.remove, false);
</script> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-22T13:15:11.180

从技术上讲，JavaScript 不支持命名空间。您可以将其放置在对象中，如下所示：

```
var Increment = {
    nRow : 1,

    Add : function() {  
        this.nRow++;
        alert(this.nRow);
    },

    Remove : function() {  
        this.nRow--;
        alert(this.nRow);
    }    
} 
```

然后您可以通过`Increment.Add()`和访问这些功能`Increment.Remove()`。

# php - 如何在 PHP 中将 hmacsha1 键设置为十六进制？

> ID：13012239
> 
> 赞同：4
> 
> 时间：2012-10-22T13:12:41.947
> 
> 标签：php, hmacsha1

我能够使用以下代码成功获取 HMAC SHA1 签名密钥：

```
echo hash_hmac('sha1','office:fred','AA381AC5E4298C23B3B3333333333333333333'); 
```

产生：

```
5e50e6458b0cdc7ee534967d113a9deffe6740d0 
```

但是，我正在与之合作的地方却期待这个：

```
46abe81345b1da2f1a330bba3d6254e110cd9ad8 
```

我尝试了一个[在线工具](http://caligatio.github.com/jsSHA/)，看来两者之间的区别在于与我一起工作的人期望使用 HEX 类型的签名密钥。

为了输出 HEX 类型，我需要添加一些东西到我的 PHP 中吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-22T13:28:26.353

在将十六进制字符串传递给 hash_hmac 之前，您需要将其转换为二进制数据：

```
var_dump(hash_hmac("sha1", "office:fred", pack("H*", "AA381AC5E4298C23B3B3333333333333333333"))); 
```

`46abe81345b1da2f1a330bba3d6254e110cd9ad8`按预期输出。

# drupal - Drupal 7 - 暴露过滤器 - 全文搜索

> ID：13012241
> 
> 赞同：2
> 
> 时间：2012-10-22T13:13:02.803
> 
> 标签：drupal, full-text-search, drupal-views

我正在使用带有 Views 3 的 Drupal 7。我为文本字段创建了一个公开的过滤器。在 Operator 下拉列表中的公开过滤器选项中，我选择了`Contains`，因此查询如下所示：

`SELECT ... WHERE some_field LIKE...`

是否可以简单地将其（插件/模块/某些选项/等）更改为 mysql 全文搜索？

任何提示将不胜感激:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T14:39:59.907

好的，我已经解决了：）

`views_query_alter`在我看来，在挂钩中，我像这样切换条件：

```
unset($query->where[1]['conditions'][0]);
$query->add_where_expression('AND', MATCH(field_data_field_searchable.field_searchable_value) AGAINST ('{$searchable_value}' IN BOOLEAN MODE)"); 
```

# c++ - 这种发送中断信号的尝试有什么问题？

> ID：13012242
> 
> 赞同：0
> 
> 时间：2012-10-22T13:13:04.333
> 
> 标签：c++, boost, serial-port, boost-asio, flow-control

这个看似简单的任务让我很头疼：向我的设备发送中断信号，就像*wxTerm*（或任何类似的终端应用程序）一样。

根据我的测试和设备规范，该信号必须为 125 毫秒长。

它应该会导致特定的响应，但我得到的是比预期更长的响应，并且传输的日期是错误的。

例如：

它应该回应什么`08 00 81 00 00 01 07 00`

它的反应`08 01 0A 0C 10 40 40 07 00 7F`

真正让我感到困惑的是，在我使用 wxTerm 查看我可用的 COM 端口（没有连接或发送任何东西）之后，我的代码开始工作！我可以发送尽可能多的休息时间，从那时起我就会得到回复。我必须重置我的电脑才能重试。

这到底是怎么回事？！

这是我通过中断信号重置的代码：

```
 minicom_client(boost::asio::io_service& io_service, unsigned int baud, const string& device)
            : active_(true),
              io_service_(io_service),
              serialPort(io_service, device)
    {
        if (!serialPort.is_open())
        {
                cerr << "Failed to open serial port\n";
                return;
        }           
        boost::asio::serial_port_base::flow_control FLOW( boost::asio::serial_port_base::flow_control::hardware );
        boost::asio::serial_port_base::baud_rate baud_option(baud);
        serialPort.set_option(FLOW);
        serialPort.set_option(baud_option);
        read_start();
        std::cout << SetCommBreak(serialPort.native_handle()) << std::endl;     
        std::cout << GetLastError() << std::endl;
        boost::posix_time::ptime mst1 = boost::posix_time::microsec_clock::local_time();
        boost::this_thread::sleep(boost::posix_time::millisec(125));
        boost::posix_time::ptime mst2 = boost::posix_time::microsec_clock::local_time();    
        std::cout << ClearCommBreak(serialPort.native_handle()) << std::endl;       
        std::cout << GetLastError() << std::endl;           
        boost::posix_time::time_duration msdiff = mst2 - mst1;
        std::cout << msdiff.total_milliseconds() << std::endl;
    } 
```

*编辑：*

只需要查看 wxTerm com-ports 的组合框选择 - 无需建立活动连接即可​​使我的代码正常工作。

我猜，当 wxTerm 为串行端口组合框创建列表时，缺少某种初始化。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T10:58:00.483

在更深入地研究了这一点后，我发现我必须`character_size`正确设置才能使其正常工作。

但是我并没有真正忘记这一点，直到现在才没有必要。当我的设备已经处于重置后状态时，他们会根据我的请求发送数据 - 所以一切都很好，我只需要指定`baud_rate`.

因为*没有主动流控制*是经常使用的默认设置，所以我想，这可能是一些错误。但是，实际上只需要设置`character_size`. 然后用预期的答案响应中断信号。

这是最小的设置：

```
minicom_client(boost::asio::io_service& io_service, unsigned int baud, const string& device)
        : active_(true),
          io_service_(io_service),
          serialPort(io_service, device)
{
    if (!serialPort.is_open())
    {
            cerr << "Failed to open serial port\n";
            return;
    }           
    boost::asio::serial_port_base::character_size CSIZE( 8 );
    boost::asio::serial_port_base::baud_rate baud_option(baud);
    serialPort.set_option( CSIZE );
    serialPort.set_option(baud_option);
    read_start();
    std::cout << SetCommBreak(serialPort.native_handle()) << std::endl;     
    std::cout << GetLastError() << std::endl;
    boost::posix_time::ptime mst1 = boost::posix_time::microsec_clock::local_time();
    boost::this_thread::sleep(boost::posix_time::millisec(125));
    boost::posix_time::ptime mst2 = boost::posix_time::microsec_clock::local_time();    
    std::cout << ClearCommBreak(serialPort.native_handle()) << std::endl;       
    std::cout << GetLastError() << std::endl;           
    boost::posix_time::time_duration msdiff = mst2 - mst1;
    std::cout << msdiff.total_milliseconds() << std::endl;
} 
```

但是，可以肯定的是，我现在正在设置所有串行端口参数。

在此处找到的示例文件[Boost Asio serial_port -](https://stackoverflow.com/questions/267752/boost-asio-serial-port-need-help-with-io)在途中需要 io 帮助。

# ios - 可以在块操作（AFNetwork）中向数组中的对象添加属性吗？

> ID：13012243
> 
> 赞同：0
> 
> 时间：2012-10-22T13:13:08.227
> 
> 标签：ios, nsarray, add, afnetworking

我正在从不同的来源发出多个请求，因此我想在下面创建的 NSArray resultsTwitter 中添加一个属性，例如：'"newsSource" = twitter'（JSON 格式）。原因是我希望能够唯一地处理每个“newsitem”。

我是块新手，但我认为这可能是“即时”执行此操作的一种非常简单的方法？ *如果在块操作中不可能，关于操作完成后如何做的任何建议？*

```
 // Fetch data from Twitter (json complient)
NSURLRequest *request = [NSURLRequest requestWithURL:urlTwitter];
AFJSONRequestOperation *operation;
operation = [AFJSONRequestOperation JSONRequestOperationWithRequest:request
                                                            success:^(NSURLRequest *req, NSHTTPURLResponse *responce, id jsonObject) {
                                                                NSLog(@"Responce: %@",jsonObject);
                                                                self.resultsTwitter = [jsonObject objectForKey:@"results"];
                                                                [self.tableView reloadData];    
                                                            }
                                                            failure:^(NSURLRequest *req, NSHTTPURLResponse *responce, NSError *error, id jsonObject) {
                                                                NSLog(@"Recieved an HTTP %d", responce.statusCode);
                                                                NSLog(@"The error was: %@",error);
                                                            }];

[operation start]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T14:26:57.100

我可能没有正确理解您的问题，但只要`resultsTwitter`是 a `NSMutableArray`，您就可以在最初填充对象后添加一个对象（在您的情况下是一个`NSDictionary`带有单个 KVP 的对象）。

就像是：

```
[resultsTwitter addObject:[NSDictionary dictionaryWithObjectsAndKeys:
                            @"twitter", @"newsSource",
                            nil]]; 
```

实例化可以在块内访问的变量的示例：

```
__block NSString *newssource = @"";

NSURLRequest *request = [NSURLRequest requestWithURL:urlTwitter];
AFJSONRequestOperation *operation;
operation = [AFJSONRequestOperation JSONRequestOperationWithRequest:request
                                                            success:^(NSURLRequest *req, NSHTTPURLResponse *responce, id jsonObject) {
                                                                NSLog(@"Responce: %@",jsonObject);
                                                                self.resultsTwitter = [jsonObject objectForKey:@"results"];
                                                                [self.tableView reloadData];
                                                                newssource = @"twitter";

                                                            }
                                                            failure:^(NSURLRequest *req, NSHTTPURLResponse *responce, NSError *error, id jsonObject) {
                                                                NSLog(@"Recieved an HTTP %d", responce.statusCode);
                                                                NSLog(@"The error was: %@",error);
                                                            }];

[operation start]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T06:58:49.303

创建一个模型类来封装所有新闻项目的行为。

此模式用于 AFNetworking 示例应用程序，每个 App.net 帖子对应一个模型对象，该模型对象是从 JSON 初始化的。我强烈建议不要使用可变字典而不是模型对象作为表示项目的方法。

# jquery - 如何根据其在jquery中的子选择器元素位置设置scrollTop值

> ID：13012254
> 
> 赞同：3
> 
> 时间：2012-10-22T13:13:48.450
> 
> 标签：jquery, css

我有带有滚动条的无序列表 html 标签。基于子选择器，我需要在 jquery 中设置 Scorll Top 值。如果下面的 div 标签不在那里工作正常。如果有 div 标签，那么我无法设置 exate 滚动顶部值。我需要在顶部显示**测试 62 。**但输出是**Test 82**。

```
<div style="height: 180px;"></div>
<ul id="ulScrollTopTest" style="height: 40px; overflow: auto;">
    <li data-id="1">Test 1</li>
    <li data-id="2">Test 2</li>
    <li data-id="3">Test 3</li>
    <li data-id="4">Test 4</li>
    <li data-id="60">Test 60</li>
    <li data-id="61">Test 61</li>
    <li data-id="62">Test 62</li>
    <li data-id="63">Test 63</li>
    <li data-id="81">Test 81</li>
    <li data-id="82">Test 82</li>
    <li data-id="83">Test 83</li>
    <li data-id="84">Test 84</li>
</ul>​ 
```

```
$(document).ready(function () {
    var scrollTopValue = 56;
    scrollTopValue = $('#ulScrollTopTest').find('[data-id="62"]').position().top;
    $('#ulScrollTopTest').scrollTop(scrollTopValue );
});​ 
```

[关联](http://jsfiddle.net/nanoquantumtech/YkpEd/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-22T13:17:35.727

你应该`ul`相对定位你的元素：

```
<ul id="ulScrollTopTest" style="height: 40px; overflow: auto; position: relative"> 
```

[http://jsfiddle.net/dK95e/](http://jsfiddle.net/dK95e/)

# c# - 无法将 keyValuePair 直接添加到 Dictionary

> ID：13012260
> 
> 赞同：40
> 
> 时间：2012-10-22T13:14:14.487
> 
> 标签：c#, dictionary, key-value, generic-collections

我想将 a 添加`KeyValuePair<T,U>`到 a 中`Dictionary<T, U>`，但我不能。我必须分别传递key和value，这意味着Add方法必须创建一个新的KeyValuePair对象来插入，效率不高。我不敢相信`Add(KeyValuePair<T, U>)`Add 方法没有重载。任何人都可以提出这种明显疏忽的可能原因吗？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-10-22T13:19:30.753

您可以使用`IDictionary<TKey,TValue>`提供`Add(KeyValuePair<TKey,TValue>)`方法的接口：

```
IDictionary<int, string> dictionary = new Dictionary<int, string>();
dictionary.Add(new KeyValuePair<int,string>(0,"0"));
dictionary.Add(new KeyValuePair<int,string>(1,"1")); 
```

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2012-10-22T13:24:21.220

备份一分钟......在继续监督之前，您应该确定创建新的 KeyValuePair 是否真的如此低效。

首先，Dictionary 类不是在内部实现为一组键/值对，而是作为一组数组。除此之外，让我们假设它只是一组 KeyValuePairs 并查看效率。

首先要注意的是[KeyValuePair](http://msdn.microsoft.com/en-us/library/5tbh8a42.aspx)是一个结构体。真正的含义是它必须从堆栈复制到堆才能作为方法参数传递。当 KeyValuePair 添加到字典中时，必须再次复制它以确保值类型语义。

为了将 Key 和 Value 作为参数传递，每个参数可以是值类型，也可以是引用类型。如果它们是值类型，则性能将与 KeyValuePair 路由非常相似。如果它们是引用类型，这实际上可以是一个更快的实现，因为只需要传递地址并且几乎不需要进行复制。在最好的情况和最坏的情况下，由于 KeyValuePair 结构本身的开销增加，此选项比 KeyValuePair 选项略好。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2012-10-22T13:19:59.150

有这样一种方法——`ICollection<KeyValuePair<K, T>>.Add`但由于它是*显式*实现的，因此您需要将字典对象转换为该接口才能访问它。

```
((ICollection<KeyValuePair<KeyType, ValueType>>)myDict).Add(myPair); 
```

看

*   的文档页面上的**显式接口实现**列表[`Dictionary<K, T>`](http://msdn.microsoft.com/en-us/library/xfhwa508.aspx)（您需要向下滚动）。
*   [显式成员实现](http://msdn.microsoft.com/en-us/library/ms173157.aspx)

此方法的[页面](http://msdn.microsoft.com/en-us/library/cc673027.aspx)包含一个示例。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-11-05T11:09:42.247

如果有人真的想这样做，这里有一个扩展

```
 public static void Add<T, U>(this IDictionary<T, U> dic, KeyValuePair<T, U> KVP)
    {
        dic.Add(KVP.Key, KVP.Value);
    } 
```

*但如果没有真正需要这样做，我建议不要这样做*

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-06-29T21:23:26.273

除非我弄错了，.NET 4.5 和 4.6 添加了将 KeyValuePair 添加到字典的功能。（如果我错了，请通知我，我会删除这个答案。）

[https://msdn.microsoft.com/en-us/library/cc673027%28v=vs.110%29.aspx](https://msdn.microsoft.com/en-us/library/cc673027%28v=vs.110%29.aspx)

从上面的链接中，相关的信息是这个代码示例：

```
public static void Main() 
{
    // Create a new dictionary of strings, with string keys, and 
    // access it through the generic ICollection interface. The 
    // generic ICollection interface views the dictionary as a 
    // collection of KeyValuePair objects with the same type 
    // arguments as the dictionary. 
    //
    ICollection<KeyValuePair<String, String>> openWith =
        new Dictionary<String, String>();

    // Add some elements to the dictionary. When elements are  
    // added through the ICollection<T> interface, the keys 
    // and values must be wrapped in KeyValuePair objects. 
    //
    openWith.Add(new KeyValuePair<String,String>("txt", "notepad.exe"));
    openWith.Add(new KeyValuePair<String,String>("bmp", "paint.exe"));
    openWith.Add(new KeyValuePair<String,String>("dib", "paint.exe"));
    openWith.Add(new KeyValuePair<String,String>("rtf", "wordpad.exe"));

    ...
} 
```

可以看出，创建并调用了 Dictionary 类型的新对象`openWith`。`openWith`然后使用该`.Add`方法创建并添加一个新的 KVP 对象。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-10-22T13:26:11.517

仅仅因为 Dictionary 类的枚举器返回一个 KeyValuePair，并不意味着它在内部是如何实现的。

如果您确实需要通过 KVP，请使用 IDictionary，因为您已经以该格式获得了它们。否则使用赋值或仅使用 Add 方法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-06-30T02:09:52.613

将它作为扩展添加到您的项目中会有什么问题？

```
namespace System.Collection.Generic
{
    public static class DictionaryExtensions
    {
        public static void AddKeyValuePair<K,V>(this IDictionary<K, V> me, KeyValuePair<K, V> other)
        {
            me.Add(other.Key, other.Value);
        }
    }
} 
```

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2012-10-22T13:22:40.677

我不是 100% 确定，但我认为 Dictionary 的内部实现是一个哈希表，这意味着键被转换为哈希以执行快速查找。

如果您想了解有关哈希表的更多信息，请阅读此处

[http://en.wikipedia.org/wiki/Hash_table](http://en.wikipedia.org/wiki/Hash_table)

# javascript - 使用 D3JS 在 div 中的 img 和 p

> ID：13012262
> 
> 赞同：2
> 
> 时间：2012-10-22T13:14:18.367
> 
> 标签：javascript, d3.js

我想要一个包含图像和图像标题的 div。我设法使用以下代码获取图像，但无法在 div 中组合图像和文本。

```
function update(sel) {
        console.log('update')
        console.log(sel)
        update_images(d3.select("#fotoos"), sel);
}

function update_images(ul, data) {
  var image = ul.selectAll("img").data(data);
  image.exit().remove();
  image.enter().append("img");
  image.attr("class", "foto");
  image.attr("src", function(d) {
      var u = '{{ =URL('download') }}'
      return u.concat("/", d.file) })
} 
```

我怎样才能得到以下内容？

```
<div>
   <p ...
   <img ...
</div> 
```

谢谢你，理查德

注意：{{ }} 代码确实来自 Web2Py

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T16:49:25.893

[您可以在http://jsfiddle.net/zceg2/1/](http://jsfiddle.net/zceg2/1/)看到一个工作示例。

您需要首先创建容器元素（`div`在本例中为），然后使用该选择来附加您的文本和图像。

```
var data = [{id: 1, text: 'sample text 1', imgsrc: 'http://placehold.it/100x100'},
            {id: 2, text: 'sample text 2', imgsrc: 'http://placehold.it/100x100'},
            {id: 3, text: 'sample text 3', imgsrc: 'http://placehold.it/100x100'},
            {id: 4, text: 'sample text 4', imgsrc: 'http://placehold.it/100x100'}];

var gallery = d3.select('body').append('div');

var container = gallery.selectAll('.container')
    .data(data, function(d) { return d.id; });

container.enter().append('div')
    .attr('class', 'container')

container.exit().remove();

container.selectAll('.text')
    .data(function(d) { return [d]; })
    .enter().append('p')
    .attr('class', 'text')
    .text(function(d) { return d.text; });

container.selectAll('.picture')
    .data(function(d) { return [d]; })
    .enter().append('img')
    .attr('class', 'picture')
    .attr('src', function(d) { return d.imgsrc; }); 
```

# linux - ps中列的含义

> ID：13012265
> 
> 赞同：4
> 
> 时间：2012-10-22T13:14:28.787
> 
> 标签：linux, bash, ps

在 Linux bash 中，四列是什么意思`ps`？

例如

```
PID   TTY         TIME CMD
15286 pts/498 00:00:00 bash
30887 pts/498 00:00:00 ps 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-22T13:17:57.513

从`man`页面：

> 它显示进程 ID (pid=PID)、与进程关联的终端 (tname=TTY)、[dd-]hh:mm:ss 格式 (time=TIME) 的累积 CPU 时间和可执行文件名称 (ucmd =CMD)。

# ios - 无法使用 Push Sharp 发送 iOS MDM 推送通知

> ID：13012266
> 
> 赞同：1
> 
> 时间：2012-10-22T13:14:28.677
> 
> 标签：ios, apple-push-notifications, mdm, xamarin, apns-sharp

我正在尝试使用生产 APN 服务器将 MDM 推送通知发送到 iPad。但是，Push Sharp 说通知失败是因为标识符等于 1。PushSharp 代码库中的以下代码说明了它是如何得出这个结论的......

```
//We now expect apple to close the connection on us anyway, so let's try and close things
// up here as well to get a head start
//Hopefully this way we have less messages written to the stream that we have to requeue

try { stream.Close(); stream.Dispose(); }
catch { }

//Get the enhanced format response
// byte 0 is always '1', byte 1 is the status, bytes 2,3,4,5 are the identifier of the notification

var identifier = IPAddress.NetworkToHostOrder(BitConverter.ToInt32(readBuffer, 2));

int failedNotificationIndex = -1;
SentNotification failedNotification = null;

//Try and find the failed notification in our sent list
for (int i = 0; i < sentNotifications.Count; i++)
{
    var n = sentNotifications[i];

    if (n.Identifier.Equals(identifier))
    {
        failedNotificationIndex = i;
        failedNotification = n;
        break;
    }
} 
```

基本上，在将有效负载写入流之后，它会尝试关闭连接，在此期间它期望来自 APN 服务的响应，我认为它称为通知标识符。

我已将设备插入 iPhone 设备配置实用程序，但控制台中没有出现任何内容，因此我假设它从未收到此通知。

我的问题是...

1.  它期望的这个标识符是什么？
2.  有什么我做错了吗？

设备运行iOS 6。payload的结构如下...

```
{"aps":{},"mdm":"80369651-5802-40A2-A0AE-FCCF02F99589"} 
```

返回的6个字节的byte[]中的值如下`8,8,0,0,0,1`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T17:58:27.803

1.  不知道，我从来没有研究过 PushSharp 如何处理 APNS 内部的细节。

2.  您不应该在通知负载中发送 "aps":{} 部分，所以这可能是 APNS 无法通知的原因。

我成功地使用带有以下代码的 PushSharp 1.0.17 进行 MDM 通知，因此它通常可以正常工作。

```
var pushService = new PushService();
// attach event listeners

// override the production/development auto-detection as it doesn't
// work for MDM certificates
var cert = null; // load your push client certificate
var channel = new ApplePushChannelSettings(true, cert, true);
pushService.StartApplePushService(channel);

// create and send the notification
var notification = NotificationFactory
    .Apple()
    .ForDeviceToken("your-device-token-received-from-checkin")
    .WithExpiry(DateTime.UtcNow.AddDays(1))
    .WithCustomItem("mdm", "your-push-magic-received-in-checkin");
pushService.QueueNotification(notification); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-02-22T01:52:34.460

对于 PushSharp v3.0+，您应该能够直接包含在 ApnsNotification 的有效负载中。

```
public void SendIosMdm(string deviceToken, string pushMagic)
    {
        _apnsBroker.QueueNotification(new ApnsNotification
        {
            DeviceToken = deviceToken,
            Payload = JObject.FromObject(new {
                mdm = pushMagic
            })
        });
    } 
```

# html - Dreamweaver 单击

> ID：13012267
> 
> 赞同：0
> 
> 时间：2012-10-22T13:14:30.057
> 
> 标签：html, dreamweaver

大家好，下面是我在 Dreamweaver cs 6 中的 html 中的代码，我的按钮只是从 index_home.html（女巫是登录名）转到 index_main.html 页面，这背后没有逻辑我只需要 onclick/href=工作，但由于某种原因我的没有！使用dreamweaver cs 6、html 5。

我不是 html 的新手，只是 dreamweaver：这是代码！

```
 <div id="Buttons">
<br/>
  <form method="post" name="buttons" id="buttons">
    <button name="Login" id="Login" href="index_main.html">LogIn</button>
    <button name="Register" id="Register" >Register</button>
  </form>
</div> 
```

只是其中有这么长的href的登录，在我得到这些基本的东西之前不想继续下去:)任何想法都会受到赞赏

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-22T13:18:05.267

按钮上不能有 href。

任何一个：

*   把它变成一个`a`带有href的标签
*   执行 onclick 以重定向
*   使按钮成为提交按钮`type="submit"`，并将表单设置为`action`您要发送到的页面。

# ld - 如何链接 2 个目标文件以形成二进制文件

> ID：13012269
> 
> 赞同：0
> 
> 时间：2012-10-22T13:14:39.510
> 
> 标签：ld

我尝试使用 ld 将 2 个 .o 文件与此链接在一起，

> ld -T link.ld -o kernel.bin kernel.o ks.o

但它会产生一个错误说

> ld: 无法打开链接器脚本文件 link.ld: 没有这样的文件或目录

我的命令有什么问题还是我必须创建路径或其他东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T07:19:35.507

您需要创建“链接器脚本” `link.ld`。Google 文档的“链接器脚本”。

# grails - Grails - 在刷新 grails 错误之前保存瞬态实例？

> ID：13012272
> 
> 赞同：6
> 
> 时间：2012-10-22T13:14:48.777
> 
> 标签：grails, grails-orm, save, domain-model

我目前正在开发 Grails 应用程序，并且正在使用 Spring Security 和 UI 插件。我已经创建了用户类和我拥有的另一个区域类之间的关系，如下所示：

用户等级：

```
class User {

    transient springSecurityService

    String username
    String email
    String password
    boolean enabled
    boolean accountExpired
    boolean accountLocked
    boolean passwordExpired

    static belongsTo = [area:Areas]

        .......
} 
```

区域等级：

```
class Areas {

    String name

    static hasMany = [users:User]

} 
```

从类中可以看出，一个用户可以链接到一个区域，但一个区域可能有很多用户。这一切都很好，当我引导应用程序时，所有数据都会正确添加。但是，当我尝试使用表单创建新用户时出现以下错误：

```
object references an unsaved transient instance - save the transient instance before flushing: com.website.Area 
```

下面是我用来保存信息的控制器代码：

```
def save = {    
        def user = lookupUserClass().newInstance(params)

        if (params.password) {
            String salt = saltSource instanceof NullSaltSource ? null : params.username
            user.password = springSecurityUiService.encodePassword(params.password, salt)
        }

        if (!user.save(flush: true)) {
            render view: 'create', model: [user: user, authorityList: sortedRoles()]
            return
        }

        addRoles(user)
        flash.message = "${message(code: 'default.created.message', args: [message(code: 'user.label', default: 'User'), user.id])}"
        redirect action: edit, id: user.id
    } 
```

以下是 GSP 的示例：

```
<table>
        <tbody>

            <s2ui:textFieldRow name='username' labelCode='user.username.label' bean="${user}"
                            labelCodeDefault='Username' value="${user?.username}"/>

            <s2ui:passwordFieldRow name='password' labelCode='user.password.label' bean="${user}"
                                labelCodeDefault='Password' value="${user?.password}"/>

            <s2ui:textFieldRow name='email' labelCode='user.email.label' bean="${user}"
                                labelCodeDefault='E-Mail' value="${user?.email}"/>

            <s2ui:textFieldRow readonly='yes' name='area.name' labelCode='user.area.label' bean="${user}"
                                labelCodeDefault='Department' value="${area.name}"/>

            <s2ui:checkboxRow name='enabled' labelCode='user.enabled.label' bean="${user}"
                           labelCodeDefault='Enabled' value="${user?.enabled}"/>

            <s2ui:checkboxRow name='accountExpired' labelCode='user.accountExpired.label' bean="${user}"
                           labelCodeDefault='Account Expired' value="${user?.accountExpired}"/>

            <s2ui:checkboxRow name='accountLocked' labelCode='user.accountLocked.label' bean="${user}"
                           labelCodeDefault='Account Locked' value="${user?.accountLocked}"/>

            <s2ui:checkboxRow name='passwordExpired' labelCode='user.passwordExpired.label' bean="${user}"
                           labelCodeDefault='Password Expired' value="${user?.passwordExpired}"/>
        </tbody>
        </table> 
```

我已经对此进行了研究，我相信这是我试图保存 GORM 对象的方式，我可能应该在尝试保存用户之前保存父（区域）。但是，在创建用户之前该区域将始终存在，因此我不需要再次创建该区域，我该如何处理？我也尝试了“withTransaction”功能但收效甚微

如果可能的话，我真的很感激这方面的一些帮助。

谢谢

编辑 ......

我已在 Controller 中将此问题跟踪到此行：

```
RegistrationCode registrationCode = springSecurityUiService.register(user, command.password, salt) 
```

这对我来说，这个函数正在为用户对象调用一个保存函数，但是在关系到位的情况下，它需要首先保存区域。有谁知道 SpringSecurityUi 可以帮助我解决这个问题？

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-23T09:34:36.730

您看到的错误消息

```
object references an unsaved transient instance - save the transient instance before flushing: com.website.Area 
```

...当您尝试从子（即用户）实体保存不存在的父（即区域）实体时发生。正如您所指出的， **RegistrationController.register**方法中可能会发生错误，如果那是您保存新用户的地方。

```
RegistrationCode registrationCode = springSecurityUiService.register(user, command.password, salt) 
```

您只需要在**注册调用之前使用逻辑更新****RegistrationCode.register**方法以将区域分配给用户（假设区域已经存在）- 下面是一个简单的示例。

 **```
class RegistrationController ..
 ..
def area = Area.findByName(command.areaName) 
def user = lookupUserClass().newInstance(email: command.email, username: command.username,
                accountLocked: true, enabled: true, area: area)
RegistrationCode registrationCode = springSecurityUiService.register(user, command.password, salt) 
```

几点注意事项：

*   您正在从 gsp 视图传回“area.name”，因此您需要更新/覆盖 RegisterCommand 以包含**区域**名称
*   您使用**区域**“名称”作为标识符安全吗？在您的类定义中，您没有约束来指示“名称”将是唯一的。也许从您的视图中传回**区域**id 更安全
*   理想情况下，您应该使用自定义属性编辑器处理**区域**查找 - 这是一个示例：[Grails 命令对象数据绑定](https://stackoverflow.com/questions/5677623/grails-command-object-data-binding)

无论如何，希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-08T10:46:44.680

```
class Areas {
    String name
    static belongsTo = [User] 
    static hasMany = [users:User]
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T09:09:02.083

尝试将双向依赖转向另一端

```
class Areas {

    String name
    static belongsTo = [User] 
    static hasMany = [users:User]
} 
```

不要忘记从用户中删除 belongsTo**

# netbeans - 如何在 Netbeans 中使用 mingw 设置 opencv2.4.0？

> ID：13012274
> 
> 赞同：1
> 
> 时间：2012-10-22T13:14:53.763
> 
> 标签：netbeans, opencv, installation, mingw

如何在 Netbeans 中使用 mingw 设置 opencv2.4.0？我想在 windows xp x86 机器上进行设置？

[更新：我按照此链接SO 链接](https://stackoverflow.com/questions/10860352/getting-started-with-opencv-2-4-and-mingw-on-windows-7/10860353#comment17523493_10860353)中的设置进行了设置。我的程序编译正确，但在执行时，它崩溃了。

我也在这个[链接中发布了相同的内容-MyPost](https://stackoverflow.com/questions/13005304/opencv2-4-0-with-mingw-in-windows-get-crashed)

> ***用户路径变量：*** C:\ctags;C:\cscope;C:\MinGW\bin;C:\OpenCV2.4.0\build\x86\mingw\bin;
> 
> ***系统路径变量：*** ./bin;%SystemRoot%\system32;%SystemRoot%;%SystemRoot%\system32\wbem;C:\Program Files\Intel\WiFi\bin;C:\Program Files\TortoiseSVN\bin;C: \WINDOWS\system32\gs\gs7.05\bin;C:\cscope;C:\ctags;C:\Program Files\Vim\vim73;C:\Program Files\QuickTime\QTSystem\;C:\Program Files\ Java\jre6\bin;C:\Program Files\Windows Imaging\;C:\MinGW\msys\1.0\bin;C:\OpenCV2.4.0\build\x86\mingw\bin;C:\MinGW\bin;

**更新：**

我尝试在 Windows 7 中编译和添加 TBB 路径。即使在添加 PATH 之后，我也遇到了同样的问题，错误的快照如下：

![Windows 7 中的错误图像](../Images/4da551455e3d17fb15a890218ed9f3e7.png)

我在 Windows XP 中尝试了相同的操作，但没有收到上述错误，但应用程序像以前一样崩溃。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T10:06:56.277

你做了这个了吗？

```
Since version 2.1, OpenCV use the TBB library to support parallel processing.

If you use MinGW as a compile suite you should compile TBB yourself 
```

[http://opencv.willowgarage.com/wiki/TBB](http://opencv.willowgarage.com/wiki/TBB)

[http://opencv.willowgarage.com/wiki/MinGW](http://opencv.willowgarage.com/wiki/MinGW)

编译完成后，需要将其路径添加到系统路径中。

仅供参考，OpenCV 2.4.2 为 MingW 提供了编译的 TBB dll。

# regex - 从data.frame中选择以R中的特定字符串结尾的行

> ID：13012275
> 
> 赞同：12
> 
> 时间：2012-10-22T13:15:01.523
> 
> 标签：regex, string, r, character, dataframe

我正在使用 R，并且我有一个包含近 2,000 个条目的 data.frame，如下所示：

```
> head(PVs,15)
     LogFreq   Word PhonCV  FreqDev
1593     140    was    CVC 5.480774
482      139    had    CVC 5.438114
1681     138    zou   CVVC 5.395454
1662     137    zei    CVV 5.352794
1619     136   werd   CVCC 5.310134
1592     135  waren CVV-CV 5.267474
620      134    kon    CVC 5.224814
646      133   kwam   CCVC 5.182154
483      132 hadden CVC-CV 5.139494
436      131   ging    CVC 5.096834
734      130  moest  CVVCC 5.054174
1171     129  stond  CCVCC 5.011514
1654     128    zag    CVC 4.968854
1620     127 werden CVC-CV 4.926194
1683     126 zouden CVV-CV 4.883534 
```

我想要做的是创建一个等于 PVs 的新 data.frame，除了所有条目都具有作为“Word”列的成员的字符串不以“te”或“de”结尾删除。即所有不以“de”或“te”结尾的单词都应该从data.frame中删除。

我知道如何使用逻辑运算符从 data.frames 中选择性地删除条目，但是当您设置数字标准时，它们会起作用。我认为要做到这一点，我需要使用正则表达式，但遗憾的是 R 是我“知道”的唯一编程语言，所以我远不知道在这里使用什么类型的代码。

我感谢您的帮助。提前致谢。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-10-22T13:24:19.207

**方法一**

您可以使用`grepl`适当的正则表达式。考虑以下：

```
x <- c("blank","wade","waste","rubbish","dedekind","bated")
grepl("^.+(de|te)$",x)
[1] FALSE  TRUE  TRUE FALSE FALSE FALSE 
```

正则表达式`^`用任意次数 () 表示 begin () `.+`，然后找到 de 或 te ()，然后找到`(de|te)`end ( `$`)。

因此，对于您的 data.frame 尝试，

```
subset(PVs,grepl("^.+(de|te)$",Word)) 
```

**方法二**

要避免使用 regexp 方法，您可以改用`substr`方法。

```
# substr the last two characters and test
substr(x,nchar(x)-1,nchar(x)) %in% c("de","te")
[1] FALSE  TRUE  TRUE FALSE FALSE FALSE 
```

所以试试：

```
subset(PVs,substr(Word,nchar(Word)-1,nchar(Word)) %in% c("de","te")) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-22T15:32:00.057

我稍微修改了数据，以便有以 te 或 de 结尾的单词。

```
> PV
     LogFreq   Word PhonCV  FreqDev
1593     140 blahte    CVC 5.480774
482      139    had    CVC 5.438114
1681     138 aaaade   CVVC 5.395454
1662     137    zei    CVV 5.352794
1619     136   werd   CVCC 5.310134
1592     135  waren CVV-CV 5.267474
620      134    kon    CVC 5.224814
646      133 kwamde   CCVC 5.182154
483      132 hadden CVC-CV 5.139494
436      131   ging    CVC 5.096834
734      130 moeste  CVVCC 5.054174
1171     129  stond  CCVCC 5.011514
1654     128  zagde    CVC 4.968854
1620     127 werden CVC-CV 4.926194
1683     126 zouden CVV-CV 4.883534

# Add a column to PV that you can visually check the regular expression matches.
PV$Match <- grepl(pattern = "(de|te)$", PV$Word)

# Subset PV data frame to show only TRUE matches
PV <- PV[PV$Match == FALSE, ] 
```

结果如下所示

```
 LogFreq   Word PhonCV  FreqDev Match
482      139    had    CVC 5.438114 FALSE
1662     137    zei    CVV 5.352794 FALSE
1619     136   werd   CVCC 5.310134 FALSE
1592     135  waren CVV-CV 5.267474 FALSE
620      134    kon    CVC 5.224814 FALSE
483      132 hadden CVC-CV 5.139494 FALSE
436      131   ging    CVC 5.096834 FALSE
1171     129  stond  CCVCC 5.011514 FALSE
1620     127 werden CVC-CV 4.926194 FALSE
1683     126 zouden CVV-CV 4.883534 FALSE 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-22T13:35:46.280

使用 grep

```
grep -xvE '.{17}(de|te).*' file.txt 
```

# wordpress - Wordpress 在循环中显示分类术语

> ID：13012279
> 
> 赞同：1
> 
> 时间：2012-10-22T13:15:06.423
> 
> 标签：wordpress, taxonomy

我的目标很简单，但在任何地方都找不到解决方案：当有人点击我为自定义帖子创建的分类术语之一时，它会按预期将它们带到 taxonomy.php。在这个 taxonomy.php 页面上，我想在一个列表中显示所有分类术语，并动态地将一个名为 ACTIVE 的类分配给用户选择的术语。我知道我可以为每个术语创建像 taxonomy-slug.php 这样的页面，但我更喜欢动态的东西。

因此，当有人点击 MOVIES 分类中的 THRILLER 术语时，我希望将 THRILLER 与 CSS class = "active" 一起列出

目前术语显示在页面上，但当前术语从未分配过类（我的代码中的第一种情况）。有人可以告诉我代码有什么问题吗？

提前谢谢

```
<?php
    $termqueried =  $wp_query->queried_object;
    $taxo = $termqueried->name;
    $terms = get_terms('MOVIES'); 
    foreach ($terms as $term) {
    if ($taxo=$terms->name) {
    echo '<li class="active">'.$term->name.'</li>';
    }
    else { echo '<li>'.$term->name.'</li>'; }
    }
    ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T14:03:33.277

您是否根本不会因为使用“术语”和“术语”的相似词而感到困惑。如下所示：

```
if ($taxo=$terms->name) { 
```

必须：

```
if ($taxo=$term->name) { 
```

希望这就是它。

# java - 使用 SimpleAdapter 排序

> ID：13012282
> 
> 赞同：0
> 
> 时间：2012-10-22T13:15:19.340
> 
> 标签：java, android, eclipse

我想`Listview`根据我的应用程序中的一些值对我进行排序，但我不知道如何编码。我研究并发现人们正在使用比较器和集合来对数组列表进行排序。基本上，我想按一些状态进行排序，例如接受或拒绝。该值存储在`TAG_ACCEPT_REJECT`并显示在 中`R.id.applicantStatus`。

**下面是我的代码：**

```
adapter = new SimpleAdapter(
                ApplicantJobStatusActivity.this,
                applicantsList,
                R.layout.list_applicant_status,
                new String[] { TAG_UID, TAG_NAME,
                               TAG_ACCEPT_REJECT,
                               TAG_ACCEPT_REJECT_DATETIME },
                new int[] { R.id.applicantUid,
                            R.id.applicantName,
                            R.id.applicantStatus,
                            R.id.accept_reject_datetime });
setListAdapter(adapter); 
```

我想知道如何以及在何处使用比较器和集合放置排序代码以重新排列我的`ListView`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-22T13:18:48.993

您应该在将列表`applicantsList`传递给适配器之前对其进行排序。然后，您可以使用该`Collections.sort`方法。像这样的东西：

```
Collections.sort(applicantsList, new Comparator<T extends Map<String, ?>> {
  public int compare(T map1, T map2) {
    if (!map1.has(TAG_ACCEPT_REJECT)) return -1;
    if (!map2.has(TAG_ACCEPT_REJECT)) return 1;

    // Assumes the objects you store in the map are comparables
    return map1.get(TAG_ACCEPT_REJECT).compareTo(map2.get(TAG_ACCEPT_REJECT));
  }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-22T13:25:03.410

**-**在将 分配给`Arrays.sort()` **之前**使用。`Array``Adapter`

**-**或者你可以使用`Collections.sort(Collection c)`接口`Comparable`，

**-**或`Collections.sort(Collection c, Comparator cp)`使用`Comparator Interface, with Colletions like` ArrayList`before assigning it to the`适配器`。

**/////////////////////编辑部分//////////////////// ///**

请参阅下面的链接，其中包含**使用各种技术对 Array、ArrayList 等进行排序的所有示例。**

[http://www.mkyong.com/java/java-object-sorting-example-comparable-and-comparator/](http://www.mkyong.com/java/java-object-sorting-example-comparable-and-comparator/)

# java - 从 Eclipse 更新 HSQLDB 表

> ID：13012283
> 
> 赞同：2
> 
> 时间：2012-10-22T13:15:19.287
> 
> 标签：java, sql, eclipse, hsqldb

我目前正在使用 Java 访问一个 .sql 文件（称为 Patient.sql）。在程序运行时运行查询和更新表可以正常工作，但不会在磁盘上进行更改。

因此，例如，我有一个 30 个节点的数据库，其中包含一些字段，包括 caseID（主键）和医院。我想用 caseID = Case29 更改节点的医院。为此，我使用以下代码：

```
 // Prepare a statement to update a record
        String sql = "UPDATE patient SET Hospital='CX' WHERE caseID = 'Case29'";

        // Execute the insert statement
        stmt.executeUpdate(sql); 
```

我已经检查过了，发现它有效（使用快速 System.out.println()）。但是，当我完成程序并打开 Patient.sql 时，我的更改尚未注册。如何保存所做的更改？

干杯

编辑：我正在使用 HSQLDB

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-31T13:01:20.590

如果您使用的是 HSQLDB，则更改将存储在 .log 文件中，直到调用 SHUTDOWN。在 SHUTDOWN 之后，所有更改都将移至 .script 文件。

此处对 HSQLDB 文件的一种描述：

[http://hsqldb.org/doc/guide/ch01.html](http://hsqldb.org/doc/guide/ch01.html)

在您的情况下，我怀疑没有调用 SHUTDOWN。

# android - 从左到右显示 ImageView 的动画

> ID：13012284
> 
> 赞同：2
> 
> 时间：2012-10-22T13:15:31.867
> 
> 标签：android

> **可能重复：**
> [动画 ImageView 宽度而不缩放](https://stackoverflow.com/questions/13860780/animate-imageview-width-without-scaling)

我要做的是创建一个动画，其中 ImageView 从左到右显示（剪辑动画？）。图像不应缩放。

我尝试更改 scaleType，然后将 ScaleAnimation 直接应用于该 ImageView：

布局：

```
<ImageView
    android:id="@+id/graphImage"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_alignParentTop="true"
    android:scaleType="centerCrop"
    android:background="@android:color/transparent"
    android:contentDescription="@string/stroom_grafiek"
    /> 
```

爪哇：

```
scale = new ScaleAnimation((float)0,
        (float)1, (float)1, (float)1,
        Animation.RELATIVE_TO_SELF, (float)0,
        Animation.RELATIVE_TO_SELF, (float)1);
scale.setDuration(1000);

graphImage.startAnimation(scale); 
```

我还尝试将 ImageView 放在一个RelativeLayout 中，然后将动画应用到RelativeLayout：

布局：

```
<RelativeLayout 
    android:id="@+id/graphImageInnerWrap"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="@android:color/transparent"
    android:layout_alignParentLeft="true"
    android:layout_alignParentTop="true"
    android:clipChildren="true"
    >
    <ImageView
        android:id="@+id/graphImage"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:scaleType="matrix"
        android:background="@android:color/transparent"
        android:contentDescription="@string/stroom_grafiek"
        />
</RelativeLayout> 
```

爪哇：

```
scale = new ScaleAnimation((float)0,
        (float)1, (float)1, (float)1,
        Animation.RELATIVE_TO_SELF, (float)0,
        Animation.RELATIVE_TO_SELF, (float)1);
scale.setDuration(1000);

graphImageInnerWrap.startAnimation(scale); 
```

在这两种情况下，ImageView 仍在缩放。我希望有人能指出我正确的方向。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-22T13:20:50.757

尝试将动画翻译为

```
Animation animation1=new TranslateAnimation(0.0f, 200.0f, 0.0f, 0.0f);
animation1.setDuration(5000);
imageview.startAnimation(animation1); 
```

`TranslateAnimation(fromX, toX, fromY, toY)`你可以像我在上面的代码中那样设置你的坐标

# c - 堆排序中的数组索引

> ID：13012291
> 
> 赞同：8
> 
> 时间：2012-10-22T13:15:51.347
> 
> 标签：c, heapsort

在阅读 Jon Bentley 的“Programming Pearls”第 2 版的第 14 章时，我了解到堆使用从一开始的数组，而 C 中最简单的方法是声明 x[n+1] 并浪费元素 x[0]（第148)。

在第 157 页，Jon 列出了完整的堆排序伪代码：

```
for i = [2, n]
    siftup(i)
for (i = n; i >= 2; i--)
    swap(1, i)
    siftdown(i - 1) 
```

[这](http://www.personal.kent.edu/~rmuhamma/Algorithms/MyAlgorithms/Sorting/heapSort.htm)是 C 中的一个实现。但是，数组索引从 0 开始，而不是 1。

```
void heapSort(int numbers[], int array_size)
{
  int i, temp;

  // Qiang: shouldn't the stop-condition be i >= 1?
  for (i = (array_size / 2)-1; i >= 0; i--)
    siftDown(numbers, i, array_size);

  for (i = array_size-1; i >= 1; i--)
  {
    // Qiang: shouldn't the swap be done with numbmers[1], instead of numbers[0]?
    temp = numbers[0];
    numbers[0] = numbers[i];
    numbers[i] = temp;
    siftDown(numbers, 0, i-1);
  }
}

void siftDown(int numbers[], int root, int bottom)
{
  int done, maxChild, temp;

  done = 0;
  while ((root*2 <= bottom) && (!done))
  {
    if (root*2 == bottom)
      maxChild = root * 2;
    else if (numbers[root * 2] > numbers[root * 2 + 1])
      maxChild = root * 2;
    else
      maxChild = root * 2 + 1;

    if (numbers[root] < numbers[maxChild])
    {
      temp = numbers[root];
      numbers[root] = numbers[maxChild];
      numbers[maxChild] = temp;
      root = maxChild;
    }
    else
      done = 1;
  }
} 
```

我担心的是，如果数组从索引 0 开始，那么以下属性将不成立（如 Jon 书中第 148 页所写）：

```
leftchild(i) = 2*i
rightchild(i) = 2*i+1
parent(i) = i/2 
```

在我看来，这里的属性仅在 i 以 1 开头时才成立。

让我印象深刻的是，实现中的分析部分[使用](http://www.personal.kent.edu/~rmuhamma/Algorithms/MyAlgorithms/Sorting/heapSort.htm)了索引1开始的数组，而实现部分使用了索引0开始的数组并且没有浪费第一个元素。

我在这里错过了什么吗？

**编辑** 在 interjay 的帮助下，我意识到了原始实现中包含的错误，可以使用 {66,4,23,4,78,6,44,11,22,1,99} 的测试输入数组来显示。

对原`siftDown()`函数稍作改动，调整父索引与其子索引的关系：

```
void siftDown(int numbers[], int root, int bottom)
{
  int done, maxChild, temp;

  done = 0;
  while ((root*2 + 1 <= bottom) && (!done))
  {
    if (root*2 + 1 == bottom ||
        numbers[root * 2 + 1] > numbers[root * 2 + 2])
      maxChild = root * 2 + 1;
    else
      maxChild = root * 2 + 2;

    if (numbers[root] < numbers[maxChild])
    {
      temp = numbers[root];
      numbers[root] = numbers[maxChild];
      numbers[maxChild] = temp;
      root = maxChild;
    }
    else
      done = 1;
  }
} 
```

学分去 interjay，:-)

后记：看起来相同的错误没有出现在[wikibooks](http://en.wikibooks.org/wiki/Algorithm_Implementation/Sorting/Heapsort)和[algorithmist](http://www.algorithmist.com/index.php/Heap_sort.c)的实现中。万岁！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-22T13:25:16.867

堆元素可以从索引 0 或索引 1 开始存储，使用哪个决定取决于您。

如果根元素位于索引 1 处，则父索引和子索引之间的数学关系很简单，如您在上面所示，因此许多书籍选择以这种方式教授它。

如果根在索引 0 处，你会得到这些关系：

```
leftchild(i) = 2*i+1
rightchild(i) = 2*i+2
parent(i) = (i-1) / 2 
```

只要你保持一致，你选择哪一个并不重要。

您显示的 C 代码对我来说似乎不正确。它从数组索引 0 开始，但使用适合从索引 1 开始的父/子关系。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-22T13:45:48.410

堆排序的可重用实现希望从 0 的根索引开始，以便用户可以使用普通（基于 0）的数组。您不想要求用户分配一个额外的成员并在索引 1 处开始数组，以便他们可以使用您的 heapsort 函数。您确实需要使用@interjay 显示的修改后的父/子计算。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-20T15:30:00.917

回复小老帖子，觉得我的小贡献可能会对未来的访客有所帮助。

如果我错过了任何场景，请专家验证并纠正我的逻辑。

考虑了**强旭**链接和**基于**零的索引逻辑。这是 C# 代码，并使用以下输入进行了测试。

//------------------------------------------------ -------------------------------------------------- ---------------------------------------------

// 输入数组：

```
int[] ErrCaseArry = new int[] { 66, 4, 23, 4, 78, 6, 44, 11, 22, 1, 99}; 
int[] GenCaseArry = new int[] { 30, 20, 40, 10, 90, 160, 140, 100, 80, 70 };

int[] NearlySortedArry  = new int[] { 1, 2, 3, 4, 6, 5 };
int[] FewSortedArry1 = new int[] { 3, 2, 1, 4, 5, 6 }; 
int[] FewSortedArry2 = new int[] { 6, 2, 3, 1, 5, 4 };

int[] ReversedArry1  = new int[] { 6, 5, 4, 3, 2, 1 }; 
int[] FewDuplsArry2  = new int[] { 1, 3, 1, 2, 1, 3 }; 
int[] MoreDuplsArry3 = new int[] { 1, 1, 2, 2, 1, 2 }; 
```

//------------------------------------------------ -------------------------------------------------- ---------------------------------------------

```
public void HeapSort(int[] listToSort)
{
    int LastChildIndex = listToSort.Length -1;
    int parentElementIndex = ((LastChildIndex - 1)/ 2);

    //1\. Use this loop to Construct Heap Array (Max/Min) by using Heapify function on every node.
    while (parentElementIndex >= 0)                                        //  (N - 1) / 2  to 0
    {
        Heapify(listToSort, parentElementIndex, LastChildIndex);           //  (N - 1) / 2  & Lenght - 1

        parentElementIndex--;
    }

    //-----------------------------------------------------------------------------------------------------------------------------------------------

    AppendArrayToResultString("Max Heap\t", listToSort);

    //2\. Heap sort algorithm takes largest element off the heap and places it at the end of an array.
    //   This phase continue until all the elements are placed in the array that are in sorted order.
    int sortedElementIndex = listToSort.Length - 1;

    //-----------------------------------------------------------------------------------------------------------------------------------------------

    // In this loop get Largest Element to Zero'th postion and move to end. and reduce the loop count from Heapify Array. So that elements gets sorted from right.

    while (sortedElementIndex >= 0)                                       //  (N - 1) to 1
    {
        // Swap the elements (root(maximum value)) of the heap with the last element of the heap
        Swap(ref listToSort[0], ref listToSort[sortedElementIndex]);

        // sortedElementIndex-- : Decrease the size of the heap by one so that the previous max value will stay in its proper placement
        sortedElementIndex--;

        if (sortedElementIndex == -1) break;

        // Since largest elemented from 0 to last, Re Heapify and get the remaining largest element and place it in 0 position.
        Heapify(listToSort, 0, (sortedElementIndex));                 //  0 to (N - 1) 
    }

    //-----------------------------------------------------------------------------------------------------------------------------------------------
}

//Heapify() function maintain the heap property (Max Heap or Min Heap). Can be recursive or can use iteration loop like while/for.
void Heapify(int[] listToSort, int parentIndext, int lastChildIndext)
{
    //bool doneFlag = false;

    int largestElementIndex = 0;
    int leftChildIndex = parentIndext * 2 + 1;
    int rightChildIndex = parentIndext * 2 + 2;

    while (leftChildIndex <= lastChildIndext) //&& !doneFlag)
    {
        // If leftChild is larger than rightChild or it is the last child and there is no rightChild for this parent. 
        // Then consider leftChild as largestElement else consider rightChild as largestElement.
        if (leftChildIndex == lastChildIndext || listToSort[leftChildIndex] > listToSort[rightChildIndex]) 
        {
            largestElementIndex = leftChildIndex;
        }
        else
        {
            largestElementIndex = rightChildIndex;
        }

        //-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
        // If largestElement is larger than parent then swap them and make parent as largestElement to continue the loop.

        if (listToSort[parentIndext] < listToSort[largestElementIndex])
        {
            // Make largestElement as parent. And continue finding if childs (left and right) are bigger than element in largestIndex position.
            Swap(ref listToSort[parentIndext], ref listToSort[largestElementIndex]);

            // Repeat to continue sifting down the child now
            parentIndext = largestElementIndex;
            leftChildIndex = ((parentIndext * 2) + 1);
            rightChildIndex = ((parentIndext * 2) + 2);
        }
        else
        {
            //doneFlag = true; 
            break;  // Trying to avoid extra flag condition check. Or return.
        }
    }
}

//-----------------------------------------------------------------------------------------------------------------------------------------------

void Swap(ref int num1, ref int num2)
{
    int temp = num1;

    num1 = num2;
    num2 = temp;
} 
```

# xml - p 错误：架构 url

> ID：13012300
> 
> 赞同：0
> 
> 时间：2012-10-22T13:16:35.120
> 
> 标签：xml, spring

我在我的 applicationContext 上看到属性，如下所示：

```
<bean id="dataSource"
      class="org.springframework.jdbc.datasource.DriverManagerDataSource"
      p:driverClassName="${jdbc.driverClassName}"
      p:url="${jdbc.url}"
      p:username="${jdbc.username}"
      p:password="${jdbc.password}" /> 
```

但是我在 p 的架构参考中遇到了这个错误：

```
Error: File not found in the specified address : http://www.springframework.org/schema/p 
```

网址有变化吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-10-01T07:25:33.183

您需要从您提到相应 bean 定义的 xml 文件中删除内容“xmlns : [http://www.springframework.org/schema/p ”。](http://www.springframework.org/schema/p)[由于 web 上的“ http://www.springframework.org/schema/p](http://www.springframework.org/schema/p) ”中没有“p”文件夹，因此会生成此错误，P 文件夹中的 Xsd 已被 Spring 社区删除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T09:06:06.573

您的 XML 验证器尝试获取该文件并失败。后者并不奇怪，因为它不是文件名或 URL，而只是名称空间的名称。然而，前者是不正确的，因为它不是文件名或 URL，而只是名称空间的名称，XML 验证器甚至不应该尝试获取它。

我怀疑您没有正确定义名称空间，但无法从这样的片段中分辨出来。

# c++ - char**x 和 char*x[] 有什么区别

> ID：13012304
> 
> 赞同：-1
> 
> 时间：2012-10-22T13:16:49.130
> 
> 标签：c++

> **可能重复：**
> [在 C 中，数组是指针还是用作指针？](https://stackoverflow.com/questions/4607128/in-c-are-arrays-pointers-or-used-as-pointers)

在 C++ 中，默认的 main 函数可以有 char* argv[] 之类的参数。它与 char** 和 char* argv[100] 有什么区别？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-22T13:19:06.833

函数参数没有区别。在其他情况下，第一个声明一个指针，第二个声明一个数组。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-22T13:20:06.530

`char**`是指向 a 的指针的指针`char`。

第二个`char *argv[100]`是指向 char 的指针数组。

但是，当您将数组传递给函数时，它们会**衰减**为指针。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-22T13:30:34.933

`char** argv`：要引发与 char* argv[100] 相同的行为，您必须动态分配空间来存储 char 指针。例如：`(*argv) = new char[100];`

双指针是 C++ 独有的一种非常灵活的数据类型，它可以赋予疯狂的速度和疯狂的错误。通常，如果您知道数组的大小，最好避免动态内存分配。

# php - 使用 php 获取 javascript 输出

> ID：13012306
> 
> 赞同：-6
> 
> 时间：2012-10-22T13:17:04.810
> 
> 标签：php, javascript

例如我在 js.php 中有这段代码

```
<script type="text/javascript">
document.write(Math.random());
</script> 
```

这会输出随机数，例如：`0.123123123123`

现在，我有 fetch.php 我试过这段代码：

```
<?
 echo file_get_contents("js.php");
?> 
```

这给出了输出：

```
<script type="text/javascript">
document.write(Math.random());
</script> 
```

但是，我希望输出为`0.123123123123`-- 这是由 javascript 生成的输出。我不想要源代码，而是该代码的输出。如何使用 PHP 做到这一点？

注意：随机数只是一个样本。我还有其他事情要做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-22T13:21:11.660

JS 是一种不同的编程语言，它需要由支持 JS 的解析器来解释。您不能只使用 PHP 获取 HTML 文档并期望 JS 运行，PHP 将看到的只是文本。

解决这个问题的两种一般方法是：

1.  通过 HTTP 将 HTML 文档传递给浏览器。在浏览器中运行 JS。通过 HTTP 传回数据。（例如通过 XMLHttpRequest，或在填充隐藏输入后使用 JS 提交表单（也使用 JS））。
2.  将 JS 传递给在服务器上运行的 JS 解析器。例如使用[PHP 的 v8js](http://php.net/manual/en/book.v8js.php)。

这些方法中的任何一种都需要修改 JS；它目前旨在向 HTML 文档添加内容。如果您使用的是浏览器，那么您必须添加更多的 JS 来提取它。如果您使用的是 v8，那么您必须要么重写 JS，要么模拟`document`对象。

您还可以采用介于两者之间的方法并以编程方式控制服务器上的浏览器（例如使用[Selenium](http://seleniumhq.org/)）。这样，您将指示浏览器获取文档，然后您可以使用 PHP API 从中读取 DOM。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-22T13:20:43.567

您需要使用 AJAX 来实现这一点。使用 jQuery 更容易做到这一点：http: [//api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

但您也可以使用常规 JavaScript： http: [//linuxgazette.net/123/smith.html](http://linuxgazette.net/123/smith.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-22T13:22:18.260

缺少使用 ajax 调用，你不能。您正在尝试结合客户端和服务器端脚本。如果不使用 ajax 调用，他们就无法进行通信。php 脚本将首先运行，因为它的服务器端。因此，当 PHP 运行时，还没有生成 JavaScript 随机数。页面必须加载，JavaScript 必须生成随机数，然后必须对服务器进行 ajax 调用。然后您的 PHP 脚本可以使用该数字。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-10-22T13:24:55.883

尝试使用：

[`jQuery.getScript()`](http://api.jquery.com/jQuery.getScript/)

`success`您可以在回调上执行函数。

# xml - SoapUI 设置 cookie 会话

> ID：13012312
> 
> 赞同：1
> 
> 时间：2012-10-22T13:17:20.003
> 
> 标签：xml, wsdl, soapui

我正在使用 SoapUI 来测试我的 Soap 请求和响应。问题是我得到了 2 个 WSDL url，所以我必须创建两个单独的项目，而第二个项目依赖于第一个项目的 cookie。那么如何在 SoapUI 中设置持久 cookie 会话呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-24T05:34:16.527

您只能在单个项目中包含 WSDL....您需要右键单击您的项目并添加 WSDL 并添加第二个 WSDL ..它将为您生成新界面。您可以使用这两个 wsdl仅在单个项目中。

# java - Java - 匿名对象占用多少空间？

> ID：13012314
> 
> 赞同：4
> 
> 时间：2012-10-22T13:17:32.427
> 
> 标签：java, heap-memory, anonymous-class

假设以下场景：

```
void thisIsCalledManyTimes(){
    // ....
    someObject.executeIfNecessary( new Runnable(){
         void run(){ //do sth here}
    });
} 
```

匿名对象会占用多少空间？我知道每个对象匿名 obj`run`在其方法查找表中都有一个指向相同实现的指针。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-22T13:23:22.017

[Runnable](http://www.docjar.com/html/api/java/lang/Runnable.java.html)的源代码没有指定任何字段，因此匿名类不会占用比 an 更多的空间`Object`，但有两个不同之处。内部类具有对外部类实例的隐式引用，因此您需要将其考虑在内。它还将获取`final`从外部类引用的变量的副本。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-22T13:21:57.040

匿名类占用的空间与非匿名类几乎相同。所有对象都保留对它们作为实例的类的引用。

匿名类的唯一不同之处在于它将包含对

*   外部类实例
*   使用的任何最终变量的副本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-22T13:22:03.787

的所有实例`run`确实将共享指向方法查找表的相同“指针”。但是，对象的精确大小取决于它的内容`run`和`...`上面的内容。编译器生成的匿名类提供了存储方法引用的变量的空间，以及存储对封闭类对象的`run`引用的空间。`this`

例如，

```
private String name;

void thisIsCalledManyTimes(){
    final int value1 = 123;
    final double value2 = 456.789.
    someObject.executeIfNecessary( new Runnable(){
         void run(){
             System.out.println(name);   // Referenced through the enclosing "this"
             System.out.println(value1); // Variable will be inserted by the compiler
             System.out.println(value2); // Variable will be inserted by the compiler
         }
    });
} 
```

在对象中保留空间来存储`value1`,`value2`和`this`; 匿名对象的每个实例都将获得这些变量的副本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-22T13:24:54.747

使用分析器检查您的班级实例的大小。它相当小，因为没有属性 - 它与 java.lang.Object 的实例一样大。这取决于 JVM 版本。

如果您需要提高效率，请执行以下操作：

```
void thisIsCalledManyTimes(){
// ....
   if (someObject.isItNecessary()) {
     someObject.execute( new Runnable(){
         void run(){ //do sth here}
     });
   } 
```

}

但是，我不会像这个那样太在意这个。

# jquery - 生成的选择确实会在更改时发出警报

> ID：13012324
> 
> 赞同：0
> 
> 时间：2012-10-22T13:18:10.960
> 
> 标签：jquery, select, alert, option, onchange

我有一个生成的选择字段，其中包含 2 个这样的选项

```
<div class="PlentyFormContainer">
    <div class="PlentyFormContainer ArticleAttrTd_0 PlentyWebAttributeTitle">Rollen/Gleiter</div>
    <div class="PlentyFormContainer ArticleAttrTd_1 PlentyWebAttributeSelect">
        <select onchange="  this.blur();
                            switchImage(this.value ,'378_0', '378', aAttribute_Image_Values_378);
                            priceChangeOnMarkup(this.value, '2', '0', 'price_dynamic_0_378', aAttribute_Markup_Values_378, aCurrent_Markups_378, oldPrice_378);
                            "
                class="ArticleAttrSelect PlentyAttributeSelect_1" id="attr_row_0_378_2"
                name="ArticleAttribute[0][378][53]"><option value="" class="PlentyAttributeOption">-- bitte wählen --</option><option  value="1364" class="PlentyAttributeOption PlentyAttributeOption_1364">Rolle weich gebremst für harte Böden&nbsp;&nbsp;</option><option  value="1363" class="PlentyAttributeOption PlentyAttributeOption_1363">Rolle hart gebremst für Teppichboden&nbsp;&nbsp;</option>
                </select>
    </div>
</div> 
```

这整个 div-select 东西是由这些元素生成的：

```
<div class="plentyAttributeSelectWrapper">
   <div class="plentyAttributeSelectWrapperTitle"><span>Rollen/Gleiter</span>
   </div>
   <div class="plentyAttributeSelectWrapperContent plentyAttributeSelectHasDropdown"> 
      <div>
         <div class="plentyAttributeSelectedValue">
           <span class="plentyAttributeSelectedValueName">Rolle weich gebremst für harte Böden</span>
           <span class="plentyAttributeSelectedValueMarkup plentyAttributeSelectValueMarkup"></span><span class="plentyAttributeSelectedArrow">
           <span></span></span>
           <span class="clear"></span>
         </div>
        <div class="plentyAttributeSelectListWrapper">
         <ul>
          <li>
            <div class="plentyAttributeSelectValue">
               <a><span class="plentyAttributeSelectValueName">Rolle hart gebremst für Teppichboden</span>
              <span class="plentyAttributeSelectValueMarkup"></span></a>
           </div>
         </li>
         <li>
            <div class="plentyAttributeSelectValue">
               <a><span class="plentyAttributeSelectValueName">Rolle weich gebremst für harte Böden</span>
              <span class="plentyAttributeSelectValueMarkup"></span></a>
            </div>
         </li>
       </ul>
   </div>
 </div>
 </div>
</div> 
```

如果我尝试在更改选项时强制发出警报，则没有反应。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T13:30:30.860

您生成的代码很好。

它显示警报，如下所示：http: [//jsfiddle.net/ww5Rr/](http://jsfiddle.net/ww5Rr/)

```
<select onchange="this.blur(); alert('hi! \nAlert is working...');" > 
```

也许您调用的函数（未在此处发布）内部有问题，导致您的警报无法显示。

尝试在 blur() 调用之后发出警报。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-22T13:44:09.607

我尝试用 jquery 抓取选择：

```
$('div.PlentyFormContainer select').change(function() {
    alert($(this).find('option:selected').text());
}); 
```

# xpath - xquery parameter query

> ID：13012325
> 
> 赞同：1
> 
> 时间：2012-10-22T13:18:14.930
> 
> 标签：xpath, xquery, exist-db

I'm trying to query an exist-db with xquery by taking parameters from the URL and building up seach parameters

```
xquery version "1.0";
declare namespace request="http://exist-db.org/xquery/request";
declare namespace xs="http://www.w3.org/2001/XMLSchema";
declare option exist:serialize "method=xml media-type=text/xml omit-xml-declaration=no indent=yes";

let $param1:= request:get-parameter("param1",'0')

let $person :=
    if($param1 = '0') 
    then "'*'"
    else concat('contributions/person/@val="',$param1,'"')

return

<xml>
{
    for $x in subsequence(//foo/bar[$person],1,3)
    return $x
}
</xml> 
```

The code above shows that I get the parameter from the url $param1.

variable $person checks to see if there was a parameter and based on that creates a query parameter. This variable works fine, from testing it prints out either '*' for no param or

```
contributions/person/@val='hello, world' 
```

When I run the query it prints out as if the value is '*'. In the for $x part, can I pass a variable like that? I've tried putting concat($person,'') with the same results. Hardcoding the full path gives me the results I'm looking for, but I'm looking to create something more dynamic.

To note: there is only one variable, $person, but there will be others once I get it to work

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T15:17:37.423

I think ideally you would avoid dynamic string evaluation. In this example, some pretty simple reorganization would solve the problem without it:

```
<xml>
{
  for $x in subsequence(//foo/bar[
    if ($param1 = '0')
    then *
    else (contributions/person/@val = $param1)
  ],1,3)
  return $x
}
</xml> 
```

However, you can use `eval()`, but keep in mind there are security risks:

```
<xml>
{
  for $x in subsequence(eval(
    concat('//foo/bar[',$person,']')
  ),1,3)
  return $x
}
</xml> 
```

# jsf - Error Parsing /page.xhtml: Error Traced[line: 42] 实体“nbsp”被引用，但未声明

> ID：13012327
> 
> 赞同：96
> 
> 时间：2012-10-22T13:18:17.897
> 
> 标签：jsf, jsf-2, facelets, html-entities

我想在我的 JSF 页面中使用不间断的空格。我知道，在纯 HTML 中，我可以使用`&nbsp;`它，而且效果很好。但是，当我将它们`&nbsp;`放在 Facelets 页面中时，会出现如下错误：

> 错误解析 /page.xhtml：错误跟踪 [行：42] 实体“nbsp”被引用，但未声明。

这是如何引起的，我该如何解决？

* * *

## 回答 #1

> 赞同：191
> 
> 时间：2012-10-22T13:27:44.453

Facelets 是一种基于 XML 的视图技术。XML 只有[五个预定义实体](http://en.wikipedia.org/wiki/List_of_XML_and_HTML_character_entity_references#Predefined_entities_in_XML)。`&nbsp;`不在其中。它仅在纯 HTML 或旧版 JSP 中使用时才有效（注意：它在 JSPX 中不起作用，因为它也是基于 XML 的！）。

要解决此问题，您需要自己在包含该实体的 XHTML 文件的 doctype 中声明该`&nbsp;`实体，

```
<!DOCTYPE html [
    <!ENTITY nbsp "&#160;"> 
]> 
```

或者，更好的是，使用（十六进制）十进制表示法：

```
&#xA0; or &#160; 
```

`&nbsp;`在一般的 IDE 中，执行“在所有文件中查找和替换”并替换每次出现的by应该是微不足道的`&#xA0;`。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-10-22T13:30:06.197

尝试使用`&amp;#160;`. 有关实体的更多信息，您可以参考以下 url [HTML ISO-8859-1 Reference](http://www.w3schools.com/tags/ref_entities.asp)

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2016-04-29T15:27:46.647

对我来说，以下 doctype 启用`&nbsp;`：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2013-02-13T18:07:09.803

1.  `<![CDATA[&nbsp;]]>`应该可以正常工作。但是，这在属性值内*不起作用。*

2.  或者，只要`&amp;`是 XML 中的预定义实体，您就可以尝试`&amp;nbsp;` 使用基于 XML 的 JSP 为我工作。这也应该在属性中起作用。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2015-02-25T13:49:14.263

添加

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
```

到文件顶部

# blackberry - 如何在 Blackberry Ripple Emulator 中测试文件读取

> ID：13012330
> 
> 赞同：0
> 
> 时间：2012-10-22T13:18:19.473
> 
> 标签：blackberry, blackberry-webworks

我正在尝试构建一个需要使用 WebWorks 在黑莓上读取 .epub 文件的应用程序。但是，使用 Ripple Emulator，我可以访问 blackberry.io.dir 中的目录结构，但我想让一个文件可供读取，以便测试文件的加载。

我假设像 file:///SDCard 这样的文件夹不是物理文件夹，但无论如何我可以将文件从本地机器复制到这个文件夹，这样我就可以开始测试了。

我尝试使用 local:/// 但这没有返回任何内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T18:21:07.770

这取决于您使用的是什么操作系统，但这个答案是关于 Mac OS：[PERSISTENT 文件系统存储在哪里使用 chrome？](https://stackoverflow.com/questions/11676584/where-does-persistent-file-system-storage-store-with-chrome)

# ios - 使用遮罩更改 UIImage 的颜色并将该图像替换为彩色图像

> ID：13012331
> 
> 赞同：0
> 
> 时间：2012-10-22T13:18:22.507
> 
> 标签：ios, uiimage, cgcolor

在一个类中，我有一个由五个 UIImages 组成的数组，例如 tiangle.png 和 circle.png。

在当前课程中，我有一个颜色列表。单击 UIImage 并单击一种颜色后，可以更改当前 UIImage 的颜色。这将通过屏蔽图像、设置其颜色并用所选颜色的新 UIImage 替换旧 UIImage 来实现。

但是方法有问题，应该改变颜色：

```
- (void) changeColor: (UITapGestureRecognizer*) gestureRecognizer{

    UIGraphicsBeginImageContext(test.newView.image.size);
    CGContextRef context = UIGraphicsGetCurrentContext();

    CGPoint loc = [gestureRecognizer locationInView:self.view];
    CGContextSetFillColorWithColor(context, [[self colorOfPoint:loc]CGColor]);
    CGContextTranslateCTM(context, 0, test.newView.image.size.height);
    CGContextScaleCTM(context, 1.0, -1.0);
    CGRect rect = CGRectMake(test.newView.frame.origin.x,test.newView.frame.origin.x,   test.newView.image.size.width,test.newView.image.size.height);
    CGContextSetBlendMode(context, kCGBlendModeColorBurn);

    CGContextClipToMask(context, rect, test.newView.image.CGImage);
    CGContextAddRect(context, rect);
    CGContextDrawPath(context, kCGPathFill);

    CGImageRef imgRef = CGBitmapContextCreateImage(context);
    UIImage* img = [UIImage imageWithCGImage:imgRef];
    CGImageRelease(imgRef);
    CGContextRelease(context);
    UIGraphicsEndImageContext();
    test.newView.image = img;

} 
```

唯一发生的事情是单击的 UIImage 将变得不透明。
在这种情况下，持有 UIImage 的 imageview 不会被删除。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T02:25:24.273

我不确定在 UIGraphics 图像上下文中使用 CGBitmapContextCreateImage() 调用获取 imageRef 是否合适。我见过的每个例子都使用

```
 UIImage* image = UIGraphicsGetImageFromCurrentImageContext(); 
```

在关闭图像上下文之前抓取图像。你可以试试。

# spring - 弹簧持久性xml

> ID：13012333
> 
> 赞同：1
> 
> 时间：2012-10-22T13:18:28.083
> 
> 标签：spring, hibernate

有什么区别：

persistenc.xml 可以使用 hibernate 属性或 Javax.persistence 属性进行配置。

您将使用哪种方案。

我尝试使用 javax.persistence 但我的 spring 应用程序无法工作.. 将其更改为休眠状态并开始工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T14:16:25.780

javax.persistence 是标准。Hibernate 是一个实现。如果您完全确定您的 DB 层将始终由 Hibernate 处理，请继续使用 Hibernate 进行配置。如果没有，请使用 javax.persistence，以便将来更改数据库层。

# html - 在 Meteor 中重新渲染时，HTML Select 会丢失选择

> ID：13012343
> 
> 赞同：0
> 
> 时间：2012-10-22T13:18:56.147
> 
> 标签：html, select, rendering, meteor

我在一个页面上有几个 HTML 元素。每当页面上下文无效并重新渲染时，元素都会重新渲染，而没有所选选项的视觉提示。

如果我使用 $('.select1 option:selected') 检查选择，则返回所选选项。但是，它不会呈现为选中状态。如果是下拉菜单，则显示第一个元素。如果它是多行选择，则第一个 (firefox) 或最后一个 (chrome) 元素将显示为灰色的选择行。

如果我再次单击所选元素，它将显示为已选中。

有人知道怎么修这个东西吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-22T14:16:12.113

我在这里实现了解决方案：[Meteor form state not being saved](https://stackoverflow.com/questions/11092704/meteor-form-state-not-being-saved)

单击时将所选值存储在会话变量中：

```
Template.packageViewer.events({
    'change .tagselect': function(){
        Session.set('tag', $('.tagselect :selected').html());}
    ,
    'change .groupselect': function(){
       Session.set('group', $('.groupselect :selected').html());}
    ,
    'change .packageselect': function(){
        Session.set('package', $('.packageselect :selected').val());}
}); 
```

然后在post-render函数中设置select选择的值：

```
Template.packageViewer.rendered = function(){
    $('.groupselect').val(Session.get('group'));
    $('.tagselect').val(Session.get('tag'));
} 
```

哈克，但有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-22T13:24:21.733

也许你可以使用 $('.select1').trigger("change"); 功能。

# actionscript-3 - 我把代码放在哪里？

> ID：13012344
> 
> 赞同：-5
> 
> 时间：2012-10-22T13:19:02.677
> 
> 标签：actionscript-3, button, event-handling, flash-cs6

我正在研究 Flash，简单地说，我不知道在哪里放置代码。

我习惯了 Visual IDE，我可以将对象从工具箱拖到工作区/画布上，然后查看此对象事件处理程序的列表并将代码放在特定事件处理程序下。

Flash 似乎不是这样工作的。工具箱中没有**Button**对象，这意味着您需要使用矩形工具绘制一个矩形，然后使用**Convert to Symbol**将其转换为一个按钮。现在我有一个按钮，我想将标签的文本更改为“Hello World”。

我将我假设的标签（大**T**）拖到我的画布上并枚举属性以尝试找到标签的名称/ID，但我找不到。

所以两个问题：

*   在 Flash CS6 中，如何访问按钮的单击事件？
*   在 Flash CS6 中，如何识别标签（或任何其他对象）以访问对象属性？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T13:25:01.453

*   在 Flash CS6 中，如何访问按钮的单击事件？

与您的任何代码一样，这可以在`Actions`窗格或文本编辑器中完成。就像是：

```
yourButton.addEventListener(MouseEvent.CLICK, clicked);

function clicked(e:MouseEvent):void {
//code
} 
```

*   在 Flash CS6 中，如何识别标签（或任何其他对象）以访问对象属性？

该对象需要另存为符号，然后您可以为该符号的实例命名。然后只需通过引用其名称来修改它。找不到文本框的“属性”的原因是它不是符号。选择文本字段，然后按 F8（或转到修改 -> 转换为符号），然后您将能够将其视为符号。

我认为在你掌握基础知识之前，在谷歌上搜索一两个教程会对你有很大帮助，因为它与 Visual Studio 有点不同。这是一个专门关于[textfields](http://www.republicofcode.com/tutorials/flash/as3text/)的。

# windows - 通过批处理文件设置默认 JRE 版本

> ID：13012345
> 
> 赞同：3
> 
> 时间：2012-10-22T13:19:06.047
> 
> 标签：windows, batch-file, registry, java

我的 Windows 7 工作站上都​​安装了 JRE 6 和 JRE 7。我想将默认 Java 设置为 JRE 6。

我已经尝试将 JAVA_HOME 变量设置为 C:\Program Files (x86)\Java\JRE6\bin 并且我也尝试过弄乱注册表......这些都不适合我

我不想卸载，也不想使用 GUI 控制面板 Java 控制台禁用 JRE 7。

我需要自动化一种将 JRE 1.6 设置为默认 java 的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T13:21:27.323

您应该在路径中设置 /bin/java（MSWindows 中的 java.exe）并首先放入。[步骤 16、17 和 18](http://www.strongkey.org/resources/documentation/installation/howto-install-jdk1.5.0-windows.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-22T13:22:10.150

`JAVA_HOME`应该指向 java 的根文件夹，例如`C:\Program Files (x86)\Java\JRE6`. 请试试。

# ios - 如何将已添加的 SecIdentityRef 更新到 iOS 应用的钥匙串？

> ID：13012347
> 
> 赞同：3
> 
> 时间：2012-10-22T13:19:12.443
> 
> 标签：ios, keychain

我的应用程序文件夹中有一个 PKCS12 文件，其中包含一个证书和一个私钥。由于 Apple 的文档（https://developer.apple.com/library/ios/#documentation/Security/Conceptual/CertKeyTrustProgGuide/iPhone_Tasks/iPhone_Tasks. html#//apple_ref/doc/uid/TP40001358-CH208-DontLinkElementID_10)

我现在要做的是将此身份存储到钥匙串中，以便以后使用。我在 iOS Keychain 上阅读了很多不同的东西，我很难弄清楚它是如何工作的。

Apple 的代码似乎使用 persistent_ref 来检索存储在 Keychain 中的身份。但我真的不明白这是什么......它是像内存引用这样的简单引用吗？如果是这种情况，当设备重新启动时会发生什么？

无法找到更多关于此的信息，我尝试通过使用 kSecAttr 属性来做不同的事情。当前代码可以很好地将 Identity 添加到 keychain ：

```
NSMutableDictionary * dictionary = [[[NSMutableDictionary alloc] init] autorelease];  

[dictionary setObject:@"LABEL" forKey:kSecAttrLabel];

[dictionary setObject:(id)newIdentity forKey:(id)kSecValueRef];

OSStatus status = SecItemAdd((CFDictionaryRef)dictionary, NULL); 
```

但是，如果我再次尝试添加它，我会收到 -25299 错误，这是“很好”，因为它已经存在。我尝试通过这样的更新来处理它：

```
NSMutableDictionary *searchDictionary = [[[NSMutableDictionary alloc] init] autorelease];
[searchDictionary setObject:@"LABEL" forKey:kSecAttrLabel];
[searchDictionary setObject:(id)kSecMatchLimitOne forKey:(id)kSecMatchLimit];
[searchDictionary setObject:(id)kCFBooleanTrue forKey:(id)kSecReturnRef];

NSMutableDictionary *updateDictionary = [[NSMutableDictionary alloc] init];
[updateDictionary setObject:(id)newIdentity forKey:(id)kSecValueRef];

OSStatus status = SecItemUpdate((CFDictionaryRef)searchDictionary,(CFDictionaryRef)updateDictionary); 
```

使用此代码，我显然会收到 -50 状态错误，因为我的参数无效......哪一个？为什么 ？我该怎么做才能正确更新我的钥匙串？

编辑：正如建议的那样，我尝试在添加现有元素之前删除它，但我遇到了相同的状态代码（-50）。下面是我试过的代码：

```
NSMutableDictionary *searchDictionary = [self setupSearchDirectoryForIdentifier:identifier];
OSStatus status = SecItemDelete((CFDictionaryRef)searchDictionary);
NSAssert(status == noErr, @"Problem deleting current keychain item." ); 
```

setupSearchDirectoryForIdentifier 只需使用我的项目标签创建一个 NSDictionnary：

```
- (NSMutableDictionary *)setupSearchDirectoryForIdentifier:(NSString *)identifier {

    // Setup dictionary to access keychain.
    NSMutableDictionary *searchDictionary = [[[NSMutableDictionary alloc] init] autorelease];  

    [searchDictionary setObject:identifier forKey:kSecAttrLabel];

    return searchDictionary; 
} 
```

谢谢

PS：我正在 Xcode 4.2 / iPad 5.1.1 上开发

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-01-30T15:14:08.063

即使这是一篇旧文章，因为我最近在使用钥匙串中的身份（用于 SSL 客户端身份验证）时遇到了类似的问题，我提供了自己的经验（使用 XCode 5.0.1）作为对此的支持似乎仍然很混乱。

**SecItemAdd**确实必须与很少的键一起使用。kSecValueRef（带有身份）当然是强制性的，并且是可选的 kSecAttrLabel。使用其他几个密钥（例如 kSecClass）会导致静默失败，即没有报告错误但没有添加标识。这非常令人困惑。

我也没有成功使用具有这种身份的**SecItemUpdate 。**我所有的尝试都导致了 -50 错误。

为了能够更新现有身份，我使用 SecItemDelete 删除了现有身份，然后使用**SecItemAdd添加了它。**再次令人困惑的是，尽管对 SecItemDelete 的调用返回了 -25300 错误（errSecItemNotFound），但它可以被忽略，因为身份确实被删除了，因为之后可以添加它（使用 SecItemAdd）而不会出现错误。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-24T00:18:57.680

`SecIdentityRef`s、`SecKeyRef`s 和类似的`Sec...Ref`值是钥匙串项的临时表示。当应用程序退出或它们的保留计数达到零时，它们变得无效。它们不能直接保存在持久存储中。

另一方面，持久引用是`CFDataRef`您以后可以用来检索特定钥匙串项的一部分。您可以将其存储在文件中、in`NSUserDefaults`中或您喜欢的任何其他位置。应用程序退出或设备重启时不会失效。（但是，当钥匙串本身被删除（即设备恢复时）、它所引用的项目被删除或项目的一个标识属性被修改时，持久引用可能会变得无效。）

Apple 的示例代码使用`SecItemAdd`的第二个参数来检索对它添加到钥匙串中的项目的持久引用。然后大概存储在`NSUserDefaults`. 给定持久引用，应用程序可以稍后`SecItemCopyMatching`将其转换为`SecIdentityRef`它可以使用的引用。

请注意，如果您不想使用持久引用，则不必使用；如果您愿意，您还可以选择根据标签或任何其他识别属性来检索钥匙串项目。

`SecItemUpdate`可能会失败，因为 a`SecIdentityRef`不是真正的钥匙串项目。它只是当公钥及其关联的私钥都在钥匙串上时构造的伪项。因此，更新它没有多大意义——它不拥有任何属性。它的所有属性都继承自其关联`SecCertificateRef`的（证书）和`SecKeyRef`（私钥）。更新这些项目而不是身份应该可以工作。（但更容易正确地创建项目：您可以通过将任何属性及其值添加到`SecItemAdd`的第一个参数来初始化任何属性。）或者，您可以尝试`SecItemDelete`在将其重新添加到钥匙串之前简单地删除身份 ( )。

# regex - 替换不在双引号中的单词

> ID：13012351
> 
> 赞同：0
> 
> 时间：2012-10-22T13:19:32.500
> 
> 标签：regex, sed

```
$cat file0
"basic/strong/bold"
" /""?basic""/strong/bold"
"^/))basic"
basic 
```

我想要 unix sed 命令，以便只更改不在引号中的基本命令。[将基本更改为环]

预期输出：

```
$cat file0
"basic/strong/bold"
" /""?basic""/strong/bold"
"^/))basic"
ring 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T13:26:05.963

```
$> sed -r 's/^([^\"]*)(basic)([^\"]*)$/\1ring\3/' file0
"basic/strong/bold"
" /""?basic""/strong/bold"
"^/))basic"
ring 
```

如果您想就地编辑文件，请使用`--in-place`选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-22T17:19:56.620

如果我们不允许转义引号，`basic`则不在其中`"`的任何引号前面都有偶数个`"`. 所以这应该可以解决问题：

```
sed -r 's/^([^"]*("[^"]*){2}*)basic/\1ring/' file 
```

正如 ДМИТРИЙ МАЛИКОВ 所提到的，添加该`--in-place`选项将立即编辑文件，而不是返回新内容。

这是如何运作的？

我们将正则表达式锚定到每行的开头`"`。然后我们允许任意数量的非`"`字符（带有`[^"]*`）。然后我们开始一个`"[^"]*` 由一个`"`和任意多个非`"`字符组成的新子模式。我们重复偶数次（用`{2}*`）。然后我们匹配`basic`。`basic`因为我们在替换之前匹配了所有这些东西。这就是为什么这部分被包裹在另一对括号中，从而捕获该行并将其写回替换中，`\1`后跟`ring`.

一个警告：如果您`basic`在一行中有多次出现，这只会替换最后一个没有用双引号引起来的，因为正则表达式匹配不能重叠。一个解决方案将是一个lookbehind，但因为这将是一个可变长度的lookbehind，它仅受.NET regex 引擎支持。因此，如果您的实际输入是这种情况，请多次运行该命令，直到所有匹配项都被替换。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-22T19:07:18.750

这可能对您有用（GNU sed）：

```
sed -r 's/^/\n/;ta;:a;s/\n$//;t;s/\n("[^"]*")/\1\n/;ta;s/\nbasic/ring\n/;ta;s/\n([^"]*)/\1\n/;ta' file 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-26T03:54:14.873

不是 sed 解决方案，但它会替换不在引号中的单词

假设字符串中没有转义引号，即`"This is a trap \" hehe"`awk 或许可以解决这个问题

```
awk -F\" 'BEGIN {OFS=FS} 
          { 
            for(i=1; i<=NF; i++){
              if(i%2)
                gsub(/basic/,"ring",$i)
            }
            print
          }' inputFile 
```

基本上不在引号中的单词在奇数字段中，并且在这些字段中将单词“basic”替换为“ring”。

This can be written as a one-liner, but for clarity's sake I've written it in multiple lines.

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2012-10-22T13:26:15.250

如果 basic 位于行首：

```
sed -e 's/^basic/ring/' file0 
```

# c++ - FSCTL_GET_RETRIEVAL_POINTERS 对小文件失败

> ID：13012357
> 
> 赞同：1
> 
> 时间：2012-10-22T13:20:07.013
> 
> 标签：c++, windows, file, offset, sector

我正在使用 FSCTL_GET_RETRIEVAL_POINTERS 来获取文件的物理偏移量（扇区）。我面临的问题是我无法获取大小为 1 kb 或更小的文件扇区。我知道大小为 1 kb 或更少的文件记录存储在 MFT 本身中。有人可以帮我获取此类文件的扇区吗？任何形式的帮助将不胜感激，如果有人可以为我提供相同的示例代码会更好。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T01:51:50.927

您需要解析文件 $MFT 以检索物理位置，该位置存储在属性 0x80 中。可以用winhex打开原盘，查看这些小文件的文件记录。

# sql-server - SSIS事务管理MSSQL

> ID：13012358
> 
> 赞同：5
> 
> 时间：2012-10-22T13:20:15.433
> 
> 标签：sql-server, transactions, ssis

如果复制失败，我需要将数据从数据库“源”复制到数据库“目标”，我需要回滚“目标”。这两个连接在连接管理器中定义为 OLE DB。

这是我目前的尝试，但不起作用。我尝试使用内置的事务管理器（将任务事务设置为**required**），但这只会导致无法连接到“目的地”。

目的地已设置“RetainSameConnection”= true，而“源”则为 false，没有特殊原因。

我还设置了“MaxConcurrentExecutables”= 1 以阻止 SSIS 作为第一件事执行我的回滚。

序列中的每个任务都设置为“Isolation level”=ReadUncommitted 和“transactionOption”=supported。

“失败脚本”是一个总是失败的脚本，以便我测试事务是否正常工作。

![在此处输入图像描述](../Images/1284cade552f0d8978dda80fcca09738.png)

任务“begin tran”的代码是“BEGIN TRANSACTION”，连接设置为“destination”

任务“rollback tran”的代码是“rollback transaction”，连接设置为“destination”

回滚失败，“回滚事务请求没有对应的‘BEGIN TRANSACTION’”

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-22T16:56:24.737

您在这里混合了两个概念。在 SSIS 中有两种实现事务的方法。第一个是 SSIS 事务。在这里，你的包应该设置为`TransactionOption = Supported`，你的容器应该设置为`TransactionOption = Required`（这将开始一个事务），然后你的两个数据流任务需要设置为`TransactionOption = Supported`，这将使它们都加入打开的事务。但是，请不要认为此选项**需要分布式事务协调**器，并且没有办法解决这个问题。

实现事务的第二种方法是使用 SQL Native Transactions。在这里，您将有一个启动事务的执行 SQL 任务，然后是数据流任务，然后是另一个提交事务的执行 SQL（当然还有另一个回滚）。这里的问题是，我刚刚提到的所有任务都需要**使用相同的连接管理器，并且`retainsameconnection = True`在该连接管理器上，**否则它将无法工作，因为 SSIS 和 SQl Server 仍然将其视为分布式事务，即使尽管它们不在同一台服务器上，但您必须使用 BEGIN DISTRIBUTED 事务，这又需要分布式事务协调器。我还记得分布式本机 SQL 事务在 SSIS 中无法正常工作。

简短的回答是，您无法实现您在 SSIS 中尝试对事务执行的操作。另一种方法是使用补偿块。`SELECT MAX(ID)`在这里，如果插入失败，您将有一个执行 SQL 任务，它根据最适合您的要求的时间或 a 删除刚刚插入的数据。

# javascript - 是否可以知道 AngularJS 指令中元素的旧值？

> ID：13012360
> 
> 赞同：5
> 
> 时间：2012-10-22T13:20:19.143
> 
> 标签：javascript, angularjs

动态更改时是否可以知道元素**旧值**和**新值**？

例如，我有一个值为 190 的按钮

```
<button name="btn1" directiveX>190</button> 
```

而这个按钮会被socket.io动态改变。当它改变时，我需要比较这些值，如果新值高于旧值。

谢谢你！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-22T14:35:10.817

如果你`$watch`的值在你的范围内，它会给你旧值和新值。所以你在指令中的链接函数看起来像这样

```
link: function(scope, element, attrs) {
         scope.$watch("foo", function(newVal, oldVal) {
           //logic based on oldVal
         }
      } 
```

然后在你的 HTML

```
<button name="btn1" directiveX>{{foo}}</button> 
```

见[http://docs.angularjs.org/api/ng.$ro​​otScope.Scope](http://docs.angularjs.org/api/ng.%24rootScope.Scope)

# c# - Windows Phone 列表框在平移时闪烁

> ID：13012363
> 
> 赞同：3
> 
> 时间：2012-10-22T13:20:50.657
> 
> 标签：c#, windows, windows-phone-7, listbox

我在平移全景应用程序时遇到了一些闪烁问题，列表框开始闪烁，您可以在此视频中看到：[http ://www.screenr.com/Aiy8](http://www.screenr.com/Aiy8)

XAML 代码：

```
<phone:PhoneApplicationPage 
    x:Class="PanoramaApp5.MainPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:phone="clr-namespace:Microsoft.Phone.Controls;assembly=Microsoft.Phone"
    xmlns:shell="clr-namespace:Microsoft.Phone.Shell;assembly=Microsoft.Phone"
    xmlns:controls="clr-namespace:Microsoft.Phone.Controls;assembly=Microsoft.Phone.Controls"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d" d:DesignWidth="480" d:DesignHeight="768" 
    d:DataContext="{d:DesignData SampleData/MainViewModelSampleData.xaml}"
    FontFamily="{StaticResource PhoneFontFamilyNormal}"
    FontSize="{StaticResource PhoneFontSizeNormal}"
    Foreground="{StaticResource PhoneForegroundBrush}"
    SupportedOrientations="Portrait"  Orientation="Portrait"
    shell:SystemTray.IsVisible="True" shell:SystemTray.BackgroundColor="Transparent"
shell:SystemTray.Opacity="0">

    <!--LayoutRoot is the root grid where all page content is placed-->
    <Grid x:Name="LayoutRoot" Background="Transparent">

        <!--Panorama control-->
        <controls:Panorama FontSize="20" Foreground="White" Loaded="Panorama_Loaded" Title="Envato Stats" Background="{x:Null}">
            <controls:Panorama.TitleTemplate>  
                <DataTemplate>
                    <Image Source="/PanoramaApp5;component/Images/logo.png"  Margin="14,105,0,10" HorizontalAlignment="Left" Name="logo" Stretch="Fill" VerticalAlignment="Top" Width="700" Height="70"/>
                    <!--<TextBlock Text="{Binding Content, RelativeSource={RelativeSource TemplatedParent}}" FontSize="100" Margin="10,50,0,0" />-->
                </DataTemplate>

            </controls:Panorama.TitleTemplate>
<controls:PanoramaItem Header="recent sales" Margin="0,-20,0,0">
                <!--Double line list with image placeholder and text wrapping-->
                <ListBox Margin="0,0,-12,0" ItemsSource="{Binding Items}" Width="435" Height="Auto">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,17">
                                <StackPanel Width="auto" MaxWidth="440">
                                    <TextBlock Text="{Binding LineOne}" TextWrapping="Wrap"  Style="{StaticResource PhoneTextLargeStyle}" />
                                    <TextBlock Text="{Binding LineTwo}" TextWrapping="Wrap" Margin="12,1,12,0" Style="{StaticResource PhoneTextSubtleStyle}" />
                                    <TextBlock Text="{Binding LineThree}" TextWrapping="Wrap" Margin="12,1,12,0" Style="{StaticResource PhoneTextSubtleStyle}" />
                                </StackPanel>
                            </StackPanel>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
            </controls:PanoramaItem>
</controls:Panorama>

    </Grid>

</phone:PhoneApplicationPage> 
```

这是用于绑定的 C# 代码

```
public void LoadRecent(object sender, DownloadStringCompletedEventArgs e)
        {
            try // In case the user is blocked by the API
            {
                XDocument document = XDocument.Parse(e.Result);

                // Get the XML nodes
                IEnumerable<XElement> item =
                        from el in document.Descendants("item")
                        select el;
                IEnumerable<XElement> amount =
                        from el in document.Descendants("amount")
                        select el;
                IEnumerable<XElement> rate =
                        from el in document.Descendants("rate")
                        select el;
                IEnumerable<XElement> soldAt =
                        from el in document.Descendants("sold-at")
                        select el;

                int i = 0;

                foreach (XElement el in document.Descendants("amount"))
                {
                    DateTime mydate = DateTime.ParseExact(soldAt.ElementAt<XElement>(i).Value, "ddd MMM dd HH:mm:ss zzz yyyy", System.Globalization.CultureInfo.InvariantCulture);

                    this.Items.Add(new ItemViewModel() { LineOne = item.ElementAt<XElement>(i).Value, LineTwo = "Amount: $" + amount.ElementAt<XElement>(i).Value + string.Format(" at the rate {0:P0}", float.Parse(rate.ElementAt<XElement>(i).Value)), LineThree = soldAt.ElementAt<XElement>(i).Value });
                    i++;
                }
            }
            catch { }
            this.IsDataLoaded = true;
        } 
```

**更新**：似乎如果应用程序栏模式设置为“最小化”闪烁问题消失，如果我将其设置为“默认”模式闪烁再次开始，任何人都有任何线索为什么会这样？如果有可能修复它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T16:31:04.073

解决方案：似乎不透明度是有罪的，而不是使它变得坚实，我将不透明度设置为 0.99 并且没有任何问题。

# java - 集成测试 :: OAuth 2.0 登录 (Facebook)

> ID：13012364
> 
> 赞同：0
> 
> 时间：2012-10-22T13:20:57.683
> 
> 标签：java, oauth-2.0, integration-testing, facebook-oauth

为了编写一组集成（end-2-end）测试，我需要使用 Facebook OAuth 2.0 模拟用户登录。通过模拟请求/响应流，一切正常，但是我想知道是否有任何（简单）方法可以在“真实”世界中验证用户。

现在我正在考虑在 Facebook 上创建测试用户，然后使用 Apache HTTPClient 以使用登录名/密码对 Facebook 中的用户进行身份验证，然后保存 cookie 并在被要求这样做时模拟“单击”“允许”按钮。然而这是一种有点复杂和“硬”的方式，所以我正在寻找一些可用的库，或者可能是 Facebook 提供了一些带有假数据的“测试”令牌？

请指教。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T19:01:40.737

With help of [Resty](http://beders.github.com/Resty/Resty/Overview.html) it is possible to solve the task and create test users (**Scala**):

```
val authToken = resty.text("https://graph.facebook.com/oauth/access_token?client_id=your_app_id" +
  "&client_secret=your_app_secret&grant_type=client_credentials")

val jsonResource: JSONResource = resty.json(
  "https://graph.facebook.com/your_app_id/accounts/test-users?installed=true&name=Abra+Kadabra&" +
    "locale=en_US&permissions=read_stream&method=post&access_token=" + URLEncoder.encode(accessToken.toString.split("=")(1)))

val token = URLEncoder.encode(jsonResource.get("access_token").asInstanceOf[String])

val userId = jsonResource.get("id").asInstanceOf[String] 
```

# ip - 我如何知道要向哪个 RIR 服务器查询 IP 地址？

> ID：13012370
> 
> 赞同：2
> 
> 时间：2012-10-22T13:21:29.597
> 
> 标签：ip, registrar

我如何知道哪些 IP 范围被分配给 5 个区域互联网注册机构（例如 ARIN 和 RIPE），从而知道要查询哪些 whois。

如果我将其设为静态，我需要多久更新一次列表？或者现在所有 IPv4 范围都消失了..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-22T13:44:13.657

[这](http://www.iana.org/assignments/ipv4-address-space/ipv4-address-space.txt)是针对 IPv4 的，[这](http://www.iana.org/assignments/ipv6-unicast-address-assignments/ipv6-unicast-address-assignments.txt)是针对 IPv6 的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-06-15T08:57:52.227

以前的答案似乎并不完全正确。IANA 为 RIPE NCC 列出 62/8，但例如对于 62.68.234.234 whois.ripe.net 将响应：

> IPv4 地址块不受 RIPE NCC 管理

我想可靠的方法是加载分配列表并检查这些（如建议的[here](http://blog.erben.sk/2014/01/28/generating-country-ip-ranges-lists/)）。

*   [ftp://ftp.arin.net/pub/stats/arin/delegated-arin-extended-latest](ftp://ftp.arin.net/pub/stats/arin/delegated-arin-extended-latest)
*   [ftp://ftp.ripe.net/ripe/stats/delegated-ripencc-latest](ftp://ftp.ripe.net/ripe/stats/delegated-ripencc-latest)
*   [ftp://ftp.afrinic.net/pub/stats/afrinic/delegated-afrinic-latest](ftp://ftp.afrinic.net/pub/stats/afrinic/delegated-afrinic-latest)
*   [ftp://ftp.apnic.net/pub/stats/apnic/delegated-apnic-latest](ftp://ftp.apnic.net/pub/stats/apnic/delegated-apnic-latest)
*   [ftp://ftp.lacnic.net/pub/stats/lacnic/delegated-lacnic-latest](ftp://ftp.lacnic.net/pub/stats/lacnic/delegated-lacnic-latest)

# java - ANTLR java测试文件无法创建树语法对象

> ID：13012371
> 
> 赞同：1
> 
> 时间：2012-10-22T13:21:46.423
> 
> 标签：java, parsing, antlr, dsl, antlrworks

我正在使用针对 java 的 ANTLR 3.x 创建一个解析器。我编写了解析器语法（用于创建抽象语法树，AST）和树语法（用于在 AST 上执行操作）。最后，为了测试这两个语法文件，我用 Java 编写了一个测试文件。

看看下面的代码，

**协议语法**

```
grammar protocol;
options {
      language = Java;
  output = AST;
}

tokens{ //imaginary tokens
PROT;
INITIALP;
PROC;
TRANSITIONS;
}
@header {
import twoprocess.Configuration;
package com.javadude.antlr3.x.tutorial;
}

@lexer::header {
  package com.javadude.antlr3.x.tutorial;
}
/*
parser rules, in lowercase letters
*/
program
    : declaration+
    ;
declaration
    :protocol
    |initialprocess
    |process
    |transitions
    ;

protocol
    :'protocol' ID ';' -> ^(PROT ID)
    ;
initialprocess
    :'pin' '=' INT ';' -> ^(INITIALP INT)
    ;
process
    :'p' '=' INT ';' -> ^(PROC INT)
    ;
transitions
    :'transitions' '=' INT ('(' INT ',' INT ')') + ';' -> ^(TRANSITIONS INT INT INT*)
    ;

/*
lexer rules (tokens), in upper case letters
*/
ID  
    : (('a'..'z' | 'A'..'Z'|'_')('a'..'z' | 'A'..'Z'|'0'..'9'|'_'))*;
INT 
    : ('0'..'9')+;
WHITESPACE
    : ('\t' | ' ' | '\r' | '\n' | '\u000C')+ {$channel = HIDDEN;}; 
```

**协议行者**

```
grammar protocolWalker;

options {
  language = Java;
  //Error, eclipse can't access tokenVocab named protocol
  tokenVocab = protocol;    //import tokens from protocol.g i.e, from protocol.tokens file
  ASTLabelType = CommonTree;
  }

@header {
import twoprocess.Configuration;
package com.javadude.antlr3.x.tutorial;
}

program
    : declaration+
    ;

declaration
    :protocol
    |initialprocess
    |process
    |transitions
    ;

protocol
    :^(PROT ID)
    {System.out.println("create protocol " +$ID.text);}
    ;

initialprocess
    :^(INITIALP INT)
    {System.out.println("");}
    ;

process
    :^(PROC INT)
    {System.out.println("");}
    ;

transitions
    :^(TRANSITIONS INT INT INT*)
    {System.out.println("");}
    ; 
```

**协议测试.java**

```
package com.javadude.antlr3.x.tutorial;  
import org.antlr.runtime.*;  
import org.antlr.runtime.tree.*;  
import org.antlr.runtime.tree.CommonTree;  
import org.antlr.runtime.tree.CommonTreeNodeStream;  
public class Protocoltest { 

/**
 * @param args
 */
public static void main(String[] args) throws Exception {
    //create input stream from standard input
    ANTLRInputStream input = new ANTLRInputStream(System.in);
    //create a lexer attached to that input stream
    protocolLexer lexer = new protocolLexer(input);
    //create a stream of tokens pulled from the lexer
    CommonTokenStream tokens = new CommonTokenStream(lexer);

    //create a pareser attached to teh token stream
    protocolParser parser = new protocolParser(tokens);
    //invoke the program rule in get return value
    protocolParser.program_return r =parser.program();
    CommonTree t = (CommonTree)r.getTree();
    //output the extracted tree to the console
    System.out.println(t.toStringTree());

    //walk resulting tree; create treenode stream first
    CommonTreeNodeStream nodes = new CommonTreeNodeStream(t);
    //AST nodes have payloads that point into token stream
    nodes.setTokenStream(tokens);

    //create a tree walker attached to the nodes stream  
            //Error, can't create TreeGrammar object called walker
    protocolWalker walker = new protocolWalker(nodes);

    //invoke the start symbol, rule program
    walker.program();
    }
} 
```

问题：

1.  在protocolWalker 中，我无法访问令牌（protocol.tokens）

    ```
    //Error, eclipse can't access tokenVocab named protocol  
        tokenVocab = protocol; //import tokens from protocol.g i.e, from protocol.tokens file 
    ```

2.  在protocolWalker中，我可以在动作列表中创建名为Configuration的java类对象吗？

    ```
    protocol
        :^(PROT ID)
           {System.out.println("create protocol " +$ID.text);
            Configuration conf = new Configuration();
           }
        ; 
    ```

3.  在 Protocoltest.java

    ```
    //create a tree walker attached to the nodes stream    
    //Error, can't create TreeGrammar object called walker  
        protocolWalker walker = new protocolWalker(nodes); 
    ```

    无法创建 protocolWalker 的对象。我在示例和教程中看到创建了这样的对象。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T21:27:51.060

> 在protocolWalker中，我无法访问令牌（protocol.tokens）......

它似乎可以`protocol.tokens`正常访问：更改`tokenVocab`为其他内容会产生一个现在不会产生的错误。protocolWalker.g 的问题在于它被定义为令牌解析器 ( `grammar protocolWalker`)，但它被用作树解析器。将语法定义为`tree grammar protocolWalker`消除了我看到的关于未定义标记的错误。

> 在protocolWalker 中，我可以在动作列表中创建名为Configuration 的java 类的对象吗？

是的你可以。正常的 Java 编程注意事项适用于导入类等，但它对你来说就像`System.out.println`.

> 在 Protocoltest.java ... 无法创建 protocolWalker 的对象。

protocolWalker.g（就像现在一样）生成一个名为`protocolWalkerParser`. 当您将其更改为树语法时，它将生成一个名为的树解析器`protocolWalker`。

非常感谢您发布整个语法。这使得回答这个问题变得更加容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T12:30:27.843

谢谢你的回复，这是一个愚蠢的错误。令牌问题和创建protocolWalker 对象现在已解决，但无论何时，无论是protocol.g 还是protocolWalker.g，我都必须在protocolParser.java 和protocolWalker.java 中再次（每次）写入包名。我之前在词法分析器文件中遇到了同样的问题，但是下面的声明克服了这个问题。

```
@header {
package com.javadude.antlr3.x.tutorial;
} 
```

但我不知道如何克服这个问题？

此外，我使用 SWING 在 Java 中开发了一个 GUI，其中我有一个 textarea。在该文本区域中，用户将编写输入，就像我的语法用户将编写的一样，

```
protocol test;
pin = 5;
p = 3;
transitions = 2(5,0) (5,1); 
```

如何在 Java Swing GUI 中处理此输入并在那里生成输出？

此外，如果我将 protocolWalker.g 的以下部分提供给

```
protocol
    :^(PROT ID)
    {
     System.out.println("create protocol " +$ID.text);
     Configuration conf = new Configuration();
     conf.showConfiguration();
    }
    ;

initialprocess
    :^(INITIALP INT)
    {System.out.println("create initial process (with state) ");}
    ;

process
    :^(PROC INT)
    {System.out.println("create processes ");}
    ; 
```

并使用以下输入运行测试文件，

```
protocol test;
pin = 5;
p = 3;
transitions = 2(5,0) (5,1); 
```

我得到以下输出

```
(PROT test) (INITIALP 5) (PROC 3) (TRANSITIONS 2 5 0 5 1)
create protocol test 
```

为什么protocolWalker.g 中的第二个和第三个println 没有显示在输出中？

有什么想法/帮助吗？

再一次感谢你。

# django - Django memcache 性能监控

> ID：13012382
> 
> 赞同：1
> 
> 时间：2012-10-22T13:22:14.933
> 
> 标签：django, memcached

我在我的 django 站点中使用 memcache 来缓存数据库读取和 API 数据。我有一个为 memcache 运行的专用服务器。现在我想测量使用 memcache 的性能（缓存中的命中和未命中）。我正在使用 django 1.3 和 python 2.4。关于如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-22T13:25:45.240

[Django 调试工具栏](https://github.com/django-debug-toolbar/django-debug-toolbar)有[一个插件](https://github.com/ross/memcache-debug-panel)，可以为您提供缓存统计信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-12-26T18:21:16.120

在这里吹响我自己的号角，但这个 django 模块是为显示内存缓存状态和执行基本管理功能而设计的。它可以在没有性能损失的情况下用于生产。

[https://github.com/ianare/django-memcache-admin](https://github.com/ianare/django-memcache-admin)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-22T13:48:42.950

```
echo stats | nc cache_server_address 11211 
```

# objective-c - NSTextField：当用户点击文本字段外时结束编辑

> ID：13012385
> 
> 赞同：4
> 
> 时间：2012-10-22T13:22:22.413
> 
> 标签：objective-c, cocoa, nstextfield

我有一个`NSTextField`根据用户操作设置可编辑的设置。当用户单击窗口内文本字段之外的任何位置时，我想结束编辑。

看起来很简单，但我无法让它工作。我实现了`controlTextDidEndEditing`and `textDidEndEditing`，但没有运气，尤其是当我单击不接受第一响应者状态的用户界面元素时。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2018-12-12T15:16:07.347

每个 NSEvent 都是通过 NSWindow 的`sendEvent:`方法传递的。

您可以创建自定义 NSWindow 并覆盖该`sendEvent:`方法。如果有鼠标按下事件，由 NSNotificationCenter 广播：

```
- (void)sendEvent:(NSEvent *)event {
    [super sendEvent:event];
    if (event.type == NSLeftMouseDown) {
        [[NSNotificationCenter defaultCenter] postNotificationName:kCustomWindowMouseDown object:self userInfo:@{@"event": event}];
    }
} 
```

在引用 NSTextField 的 ViewController 中，观察此通知：

```
 [[NSNotificationCenter defaultCenter] addObserver:self
                                             selector:@selector(customWindowMouseDown:)
                                                 name:kCustomWindowMouseDown
                                               object:self.view.window]; 
```

如果鼠标按下事件的位置在文本字段之外，则结束编辑：

```
- (void)customWindowMouseDown:(id)sender {
    NSNotification *notification = (NSNotification *) sender;

    NSEvent *event = notification.userInfo[@"event"];
    NSPoint locationInWindow = event.locationInWindow;

    if ([self.view.window.firstResponder isKindOfClass:NSTextView.class]) {
        NSTextView *firstResponder = (NSTextView *) self.view.window.firstResponder;

        //we only care about the text field referenced by current ViewController
        if (firstResponder.delegate == (id <NSTextViewDelegate>) self.textField) {

            NSRect rect = [self.textField convertRect:self.textField.bounds toView:nil];

            //end editing if click out side
            if (!NSPointInRect(locationInWindow, rect)) {
                [self.view.window makeFirstResponder:nil];
            }

        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T04:57:01.597

您可以为 NSView 编写一个子类并编写以下方法并将 nib 文件的 NSWindow 中的 NSView 的类更改为该子类。

```
 - (void)mouseDown:(NSEvent *)event 
    {
         [text setEditable:NO];
         NSLog(@"mouseDown");
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T05:17:07.180

可能有点脏，但您可以在“文本字段外部”区域创建一个大的透明按钮。编辑开始时显示，编辑结束时隐藏。如果用户点击此按钮，您将停止编辑（并隐藏按钮）。

当我需要一个快速的解决方案时，为我解决了这个问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-09-12T18:34:56.923

当您无法对包含视图的窗口进行子类化时，我会改进 vignesh kumar 的答案。

对于所有处理 mouseDown 的子视图/控件，包括超级视图本身，实现：

```
- (void)mouseDown:(NSEvent *)event
{
    [[self window] makeFirstResponder:self];

    [super mouseDown:event];
} 
```

对于某些控件，例如按钮，您可以更改为

```
- (void)mouseDown:(NSEvent *)event
{
    [[self window] makeFirstResponder:[self superview]];

    [super mouseDown:event];
} 
```

否则可能会出现对焦环

# javascript - 如何将 JSON 数据放入 html / javascript 网格表中

> ID：13012390
> 
> 赞同：6
> 
> 时间：2012-10-22T13:22:29.057
> 
> 标签：javascript, jquery, html, json

我有以下 JSON 格式的数据：

```
 [
{
    "ID": "00:50:c2:63:10:1a",
    "start": "1349773838277760",
    "end": "1349773838277770",
    "startArea": "areaStart",
    "endArea": "areaEnd",
    "duration": "10"
},
{
    "ID": "00:50:c2:63:10:1a",
    "start": "1349773838277760",
    "end": "1349773838277780",
    "startArea": "areaStart",
    "endArea": "areaEnd",
    "duration": "20"
},
{
    "ID": "00:50:c2:63:10:1a",
    "start": "1349773838277760",
    "end": "1349773838277780",
    "startArea": "areaStart",
    "endArea": "areaEnd",
    "duration": "20"
}] 
```

如何在 html 数据表中很好地显示这些数据？

有可以帮助我的 jQuery 插件吗？

我的基本方法是这样的：

[http://jsfiddle.net/LKkSJ/](http://jsfiddle.net/LKkSJ/)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-16T17:53:25.480

看一下：

[http://www.1stwebdesigner.com/css/top-jquery-chart-libraries-interactive-charts/](http://www.1stwebdesigner.com/css/top-jquery-chart-libraries-interactive-charts/)

[http://codecanyon.net/item/graphup-jquery-plugin/108025?ref=1stwebdesigner](http://codecanyon.net/item/graphup-jquery-plugin/108025?ref=1stwebdesigner)

这些是非常适合这类表格的解决方案

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-22T13:25:04.697

我会推荐 dataTables，你可以输入一个 javascript 数组。[点击这里](http://datatables.net/release-datatables/examples/data_sources/js_array.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-22T13:27:01.580

[DataTables](http://www.datatables.net/examples/data_sources/ajax.html)可以从 JSON 创建表。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-10-22T13:26:29.953

您可以将[jqGrid](http://www.trirand.com/blog/)用于 jQuery。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-10-30T07:31:19.163

如果 DataTables 对您来说太重（70 KB），您可以使用各种模板库：

*   [小胡子](http://mustache.github.com)，
*   [车把](http://handlebarsjs.com)，
*   [远端](http://code.google.com/p/distal)

只需将表格行转换为模板，然后在 HTML 表格中重复该模板。

# node.js - 如何扩展 Node.js WebSocket Redis 服务器？

> ID：13012394
> 
> 赞同：9
> 
> 时间：2012-10-22T13:22:33.107
> 
> 标签：node.js, websocket, redis, scalability, load-balancing

我正在为[Acani编写一个聊天服务器，我对](http://www.acani.com)[使用负载均衡器可扩展性扩展](https://stackoverflow.com/questions/8627295/websockets-with-load-balancer-scalability)[node.js](https://stackoverflow.com/questions/4710420/scaling-node-js)和websockets有一些疑问。

1.  负载均衡 Node.js 究竟意味着什么？这是否意味着将运行我的服务器应用程序的*n 个*独立版本，每个版本都在单独的服务器上？

2.  为了允许一个客户端向所有其他客户端广播消息，我`webSocketConnections`在服务器上存储了一组所有打开的消息。但是，如果我有*n 个*独立版本的服务器应用程序正在运行，每个版本都在单独的服务器上，那么我会有*n 个*不同的集合`webSocketConnections`吗？

3.  如果 1 和 2 的答案是肯定的，那么我如何存储一个通用集`webSocketConnections`（跨所有服务器）？我认为我可以做到这一点的一种方法是使用 Redis Pub/Sub 并让每个`webSocketConnection`订阅者都订阅 Redis 上的频道。

4.  但是，那么，单台 Redis 服务器会不会成为瓶颈呢？然后我将如何扩展 Redis？扩展 Redis 意味着什么？这是否意味着我在不同的服务器上运行了*m*个独立版本的 Redis？这甚至可能吗？

5.  我听说 Redis 无法扩展。为什么会有人这么说。这意味着什么？如果这是真的，对于发布/订阅和/或存储所有广播消息的列表是否有更好的解决方案？

注意：如果您的答案是 Acani 永远不必扩展，即使地球上所有 70 亿人（并且正在增长）中的每一个人每秒都向地球上的其他所有人广播一条消息，那么请给出一个有效的解释。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-22T14:46:12.663

好吧，您的问题的答案很少：

1.  负载均衡 Node.js 的含义正是您所想的，除了您真的不需要单独的服务器，您可以在同一台机器上运行多个节点服务器的进程。

2.  您的节点服务器的每个服务器/进程都会有自己的连接，websockets（例如 Socket.IO）的默认存储是 MemoryStore，这意味着所有连接都将存储在机器内存中，需要使用 RedisStore为了使用 redis 作为连接存储。

3.  Redis PUB/SUB 是完成这项任务的好方法

4.  您在这里所说的是正确的，redis 目前无法扩展，并且运行大量连接到 redis 的进程/连接可能会使 redis 成为瓶颈。

5.  Redis 无法扩展，这是正确的，但根据这个演示文稿，您可以看到集群开发是 redis 的重中之重，redis 确实有一个集群，但它还不稳定：（取自[http://redis. io/下载](http://redis.io/download)）

> **Redis 集群在哪里？**
> 
> Redis 开发目前专注于 Redis 2.6，它将为您带来对 Lua 脚本的支持和许多其他改进。这是我们当前的优先事项，但是不稳定的分支已经包含了 Redis Cluster 的大部分基础部分。在 2.6 版本发布之后，我们将集中精力将当前的 Redis Cluster alpha 转变为 beta 产品，用户可以开始认真测试。很难做出预测，因为只有当我们认为 Redis Cluster 稳定且对我们的客户有用时，我们才会发布稳定版，但我们希望在 2012 年夏天有一个合理的测试版，并在发布之前发布第一个稳定版2012 年底。

在此处查看演示文稿：[http ://redis.io/presentation/Redis_Cluster.pdf](http://redis.io/presentation/Redis_Cluster.pdf)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-29T12:26:49.007

2) 使用 Redis 可能无法存储连接：Redis 可以以字符串格式存储数据，如果连接对象具有循环引用（即 Engine.IO），您将无法序列化它们

3）为每个客户端创建一个新的 Redis 客户端可能不是一个好方法，所以如果可以的话，请避免这个陷阱

考虑使用 ZMQ 节点库让进程通过 TCP（或 IPC，如果它们像 master-worker 一样集群）相互通信

# jquery - JSON字符串化与jQuery中的变量

> ID：13012395
> 
> 赞同：0
> 
> 时间：2012-10-22T13:22:34.293
> 
> 标签：jquery, json, stringify

我正在尝试发布一些 JSON，我需要在其中包含输入字段中的一些值。我有两个带有用户名和密码 ID 的输入字段。

```
data = JSON.stringify({
  "jsonrpc": "2.0",
  "method": "POST",
  "params": {
    "params": {"username": $('#username').val(), "password":  $('#password').val()}
  }
}); 
```

当我对值进行硬编码时，我可以很好地发送它，问题是它不会从输入字段发送值。我究竟做错了什么？

我是这样发送的：

```
$.ajax({
  url:url,
  type:"POST",
  crossDomain: true,
  dataType: "json",
  data : data,
  headers: {
    'content-type': "application/json; charset=utf-8"
  },
  success: function(data){
        $("#result").append('<p>Token: ' + data.result.token + '</p>');
        $("#result").append('<p>Name: ' + data.result.Customer.Name.value + '</p>');
        $("#result").append('<p>ID: ' + data.result.Customer.ID + '</p>');
  },
  error: function(data, status, xhr) {
alert("Error");
  }

}); 
```

我尝试简化事情，所以我`div`在单击按钮时将值添加到 a 中。这工作得很好：

```
$("#login").click(function() {
  $('#test').append($('#username').val());
}); 
```

**回答：**正如大卫在评论中提到的，这是因为我在函数之外声明了数据变量。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T14:12:49.907

在原始问题中添加了答案。特别感谢 David Hedlund 帮助我朝着正确的方向前进。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-22T13:25:05.810

改变：

```
"params": {
 "params": {"username": $('#username').val(), "password":  $('#password').val()}
} 
```

在

```
"params": {"username": $('#username').val(), "password":  $('#password').val()} 
```

你在同一时间声明了两次参数

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-22T13:31:35.857

也许你可以使用 dataType: "string"

# matlab - 是否可以在没有分布式计算引擎的情况下访问 MATLAB 中的 MPI 功能

> ID：13012402
> 
> 赞同：1
> 
> 时间：2012-10-22T13:23:06.637
> 
> 标签：matlab, parallel-processing, mpi

我可以访问运行 Torque 的集群，但不能选择安装 MATLAB 分布式计算引擎。我想知道是否可以在 MATLAB 中使用 MPI 命令而无需分布式数组等额外功能。如果您没有分布式计算引擎，是否可以将 MATLAB lab* 命令与 mpirun 命令结合使用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-22T16:35:41.400

如果您的 MPI 实现是 Open MPI，您可以使用 Poor Man's Parallel Toolbox (tm)，它允许您在许多节点上并行运行许多 MATLAB 实例，并让它们中的每一个执行不同的操作，例如运行不同的脚本。成功的关键在于 Open MPI 会在环境变量中导出当前进程的等级，`OMPI_COMM_WORLD_RANK`并且可以使用一个简单的 shell 脚本来环绕执行。这是一个示例：

```
#!/bin/bash

file_num=script$(printf "%03d" $(($OMPI_COMM_WORLD_RANK + 1))).m
matlab < $file_num 
```

可以将其启动为：

```
mpiexec -np 24 ./script.sh 
```

这将启动 24 个 MATLAB 副本，每个副本都接收来自不同脚本的输入。第一个将从 获取命令`script001.m`，第二个从获取命令`script002.m`，依此类推。

当然，您总是可以用 C 或 C++ 甚至 Fortran 编写并行代码，并在那里使用 MPI。然后将代码编译成一个共享库，可从 MATLAB 加载和调用。

# backbone.js - iOS 中通过 Backbone.js 实现的 JS-Native 桥接

> ID：13012403
> 
> 赞同：0
> 
> 时间：2012-10-22T13:23:06.837
> 
> 标签：backbone.js, uiwebview

我知道如何通过纯 JS 代码（无外部框架）在 iOS 中创建一个 JS-Native 桥，但我想知道当我使用 Backbone.js 时有什么变化吗？如果是，那么任何人都可以解释一下。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T18:05:33.130

你可以使用这些方面的东西：

```
yourBackboneObject.on('all', function(eventName) {
  var args = Array.prototype.slice.call(arguments);
  args.shift();
  NativeBridge.call(eventName, args);
}); 
```

在对象中：

```
this.trigger('someiOSfunction', someArg, someOtherArg); 
```

# sql - Sybase 唯一索引和主键

> ID：13012408
> 
> 赞同：1
> 
> 时间：2012-10-22T13:23:22.577
> 
> 标签：sql, sql-server, indexing, primary-key, sybase

是否可以在已经具有唯一非聚集索引的表中添加主键？

我有一个表 cargo_car，我需要将 cd_cargo_car 定义为 PK。

我试过这个：

```
ALTER TABLE dbo.cargo_car ADD PRIMARY KEY (cd_cargo_car) 
```

但我收到了错误：

```
Error (1921) An index with the same columns inthe same order alredy exists onthe table 
```

该表有很多依赖项，当我尝试删除收到的索引时：

```
Error (3712) Cannot drop index 'cargo_car.XPKcargo_car' because it still has referential integrity constraints. 
```

这是创建脚本：

```
CREATE TABLE dbo.cargo_car
    (
    cd_cargo_car      SMALLINT NOT NULL,
    nm_cargo_car      VARCHAR (40) NOT NULL,
    cd_refini_car     CHAR (4) NOT NULL,
    cd_reffin_car     CHAR (4) NOT NULL,
    cd_jornada1_car   CHAR (2) NOT NULL,
    cd_jornada2_car   CHAR (2) NOT NULL

    )
GO

CREATE UNIQUE NONCLUSTERED INDEX XPKcargo_car
    ON dbo.cargo_car  (cd_cargo_car)
GO 
```

关于如何做到这一点的建议？

Tks

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T14:17:49.050

> 您将不得不删除其他表上的所有外键约束，删除该索引，创建主键（我猜您希望它被聚集？），然后重新创建外键约束。– 民主党

为了允许结束这个问题，我将该评论转换为答案。这是正确的，类似于我想写的......

# qt - QDockWidget::title (需要更改字体和大小)

> ID：13012410
> 
> 赞同：5
> 
> 时间：2012-10-22T13:23:29.300
> 
> 标签：qt, qtstylesheets

我在我的 QT 应用程序中为 QDockWidgets 设置了以下样式表。除了字体之外，样式中提到的所有东西都可以正常工作。为什么未检测到“字体”以及如何更改 QDockWidget 标题的字体和大小？

```
QDockWidget::title
{
    font: 18pt "Roboto Lt";
    background: lightgray;
    padding-left: 10px; 
    padding-top: 4px;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-01T11:09:59.230

字体应该应用于 QDockWidget 本身，而不是子控件 ::title

```
QDockWidget { font-family: "Roboto Lt"; font-size: 18pt; } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-22T22:49:20.110

观看 Qt 参考中的字体部分：http: [//doc.qt.digia.com/qt/stylesheet-reference.html](http://doc.qt.digia.com/qt/stylesheet-reference.html)

也许你应该尝试：

```
QDockWidget::title
{
   font-family: "Roboto Lt";
   font-size: 18pt;
   background: lightgray;
   padding-left: 10px; 
   padding-top: 4px;
} 
```

# ruby - 如何在黄瓜步骤定义之外使用 rspec-expectations

> ID：13012412
> 
> 赞同：1
> 
> 时间：2012-10-22T13:23:33.233
> 
> 标签：ruby, rspec, cucumber, watir, watir-webdriver

我正在使用 watir-cucumber 进行测试自动化。我单独编写了以下方法`.rb`，此方法不在步骤定义中。

```
 def has_logged_in?
   $browser.text.should include("t788")
 end 
```

当我从步骤定义中调用此方法时，会出现此错误，

```
 wrong argument type String (expected Module) (TypeError) 
```

相同的代码在步骤定义中工作正常。我四处搜索，发现该`include`方法用于包含模块，但那是`ruby-include`方法并且`should include`属于`rspec\expectations`. 那么我如何`should include`在上面的步骤定义之外调用方法。我在 linux 上使用 watir-cucumber

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-23T13:23:27.593

您想要的`include`方法在[`RSpec::Matchers`](http://rubydoc.info/gems/rspec-expectations/RSpec/Matchers#include-instance_method)模块中。

如果你的`has_logged_in?`方法在一个类中（不是 main 的一部分），你可以在你的类中包含 RSpec::Matchers 模块。这将使您可以访问该`include`方法。

所以你的班级看起来像：

```
class YourClass
    include RSpec::Matchers

    def has_logged_in?
        $browser.text.should include("t788")
    end
end 
```

注意：我以前不必这样做，但通过快速检查，只要 RSpec::Matchers 包含在类中而不是主类中，它就可以工作。在 main 中包含它似乎没有做任何事情（即 include 继续调用标准的 include 模块方法）。我没有探索这样做是否有任何负面影响。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-22T21:42:10.967

在您的 gem 文件中：

```
gem 'rspec', "1.3.2", :require => "spec/expectations" 
```

或者在 RSpec 1.XX 的 env.rb 中：

```
require 'spec/expectations' 
```

或者在 RSpec 2.X 的 env.rb 中：

```
require 'rspec/expectations' 
```

# javascript - 在 JavaScript 应用程序中管理上下文

> ID：13012413
> 
> 赞同：0
> 
> 时间：2012-10-22T13:23:34.730
> 
> 标签：javascript, design-patterns, mobile, dojo

我正在使用 Dojo Toolkit 开发一个移动应用程序。为了让您了解我的问题，请考虑以下应用程序流程：

移动应用程序的启动视图是一个条目列表，这些条目表示由应用程序监控的数据库实例。用户必须选择一个列表条目才能访问显示与所选数据库实例相关的所有监控数据的视图。该应用程序有许多视图，所有视图都显示了一些监控数据。我的问题是我不知道如何让所有视图都知道，选择哪个数据库来从服务器检索适当的数据。

对于这个问题，什么是一个很好的解决方案，可以很好地与 MVC 模式配合使用？有没有可以应用的设计模式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T13:33:10.513

如果您希望一次管理单个数据库实例并且它有效地表示应用程序中的资源，那么您可以将其添加到 URL（在哈希片段中），然后使用 Dojo 路由器在一个地方配置对象可以通过视图检索（使用某种形式的注册表或直接从 URL 取决于您在做什么）。听起来好像任何需要注意的设计模式都是在需要时为您的数据库连接创建一致的接口（适配器），但实际的连接跟踪应该能够简单地通过您作为控制器查看的内容来处理。

# asp.net-mvc - 我可以在 Web 应用程序中获取工作进程的进程 ID 吗？

> ID：13012414
> 
> 赞同：11
> 
> 时间：2012-10-22T13:23:42.610
> 
> 标签：asp.net-mvc, asp.net-mvc-4, application-pool, worker-process

我有一个在具有多个工作进程的应用程序池中运行的应用程序。

我需要访问控制器中的进程 ID 以检查我在更改应用程序池以使用多个工作进程后遇到的一些问题。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-10-26T14:12:43.167

这将获取进程 ID

```
System.Diagnostics.Process.GetCurrentProcess().Id 
```

# google-app-engine - 是否可以使用 appstats 仅跟踪慢速请求？

> ID：13012418
> 
> 赞同：3
> 
> 时间：2012-10-22T13:23:53.793
> 
> 标签：google-app-engine

我们的应用程序每秒处理几十个请求，其中一小部分需要比其他应用程序更多的时间来处理。我们有兴趣“分析”那些缓慢的请求，但是 appstats 似乎只保留处理请求的小窗口，因此我们感兴趣的请求会很快消失。是否可以以某种方式配置 appstats 以记录仅花费超过指定阈值的请求的日志？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T19:03:55.990

有关 Appstats 的配置选项的详细列表，请参见 GAE SDK 中的[示例 Appstats 配置示例](http://code.google.com/p/googleappengine/source/browse/trunk/python/google/appengine/ext/appstats/sample_appengine_config.py)。根据这个文件，目前似乎无法根据请求的执行时间来捕获请求。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-24T13:21:28.243

不幸的是，没有内置的机制。

您可以通过猴子[修补 end_recording 方法](http://code.google.com/p/googleappengine/source/browse/trunk/python/google/appengine/ext/appstats/recording.py#1426)或 Recorder.save 方法自己添加它。

# javascript - 如何使用自动高度获取标签的实际高度

> ID：13012421
> 
> 赞同：3
> 
> 时间：2012-10-22T13:24:10.500
> 
> 标签：javascript, label, titanium, uilabel, titanium-mobile

我知道这个问题以前以各种形式出现过，但没有一个解决方案适合我……我正在使用 Titanium API 2.1.3，并为 iPhone 构建。

我使用了很多常见的JS，所以我有这个：

```
exports.Header = function(title){
var l = Ti.UI.createLabel({
    text: title,
    height: 'auto',
    textAlign: 'left',
    color: '#989898',
    font: {fontSize: exports.defaultFontSize+10, fontFamily: exports.defaultFont, fontWeight: 'bold'}
});
return l;
}; 
```

我这样称呼标签：

```
var qLabel = gui.Header(question);
qLabel.top = 5;
qLabel.left = 10;
qLabel.right = 10;
qLabel.color = "#3B3B3B";
qLabel.font = {fontSize: gui.defaultFontSize+4, fontWeight: 'bold'}; 
```

到目前为止，我已经尝试了各种方法来获取标签的高度，例如：

```
qLabel.toImage().height // this returns auto
qLabel.getRect().height // this returns 0 
```

与 getSize().height （这也返回 0）或 getHeight() （返回 auto）相同。我尝试先将它添加到父视图，然后读取高度，但什么也没有……我做的最后一件事是：

```
var qqv = Ti.UI.createView({ width: 'auto', height: 'auto' });

qqv.add(qLabel);
qLabel.show();

Ti.API.info(qLabel.rect.height);
Ti.API.info(qLabel.size.height);
Ti.API.info(qqv.rect.height);
Ti.API.info(qqv.size.height); 
```

它们都返回 0。

在这一点上我变得非常绝望，我不知道这个问题是否是因为我正在使用的 API 版本或其他......任何帮助表示赞赏。

**编辑：** 经过反复试验，我发现

```
qLabel.toImage().height; 
```

返回*一些*数字，但是，它似乎不是正确的高度。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-25T07:29:51.453

您可以使用[postlayout 事件](http://docs.appcelerator.com/titanium/2.1/index.html#!/api/Titanium.UI.View-event-postlayout)

这是获取标签高度的示例代码

```
label.addEventListener('postlayout', function(e) {
    var label_height = e.source.rect.height;
    alert(label_height);
}); 
```

希望有帮助。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-11-14T14:56:06.247

我遇到了同样的问题，我不想在每个元素上都使用 postlayout 事件。相反，我使用了[size](http://docs.appcelerator.com/platform/latest/#!/api/Titanium.UI.Label-property-size)属性，它是只读的，包含元素的实际大小。我将其与来自 postlayout 事件的事件数据进行了比较，它们给出了完全相同的值。

因此，如果您想获取元素的高度，我建议您使用`$.label1.size.height`而不是一直添加事件侦听器。这对于您的应用程序的性能也会更好，因为 postlayout 事件将被触发很多。

# excel - Excel VBA 事件

> ID：13012426
> 
> 赞同：0
> 
> 时间：2012-10-22T13:24:24.730
> 
> 标签：excel, vba

我对 Excel VBA 有点陌生。我目前设计了 VBA 代码来生成一个 Vlookup，它根据另一张表中的参考数据填充我的数据表中的列（比如 Y 列）中的数据，以及同一张表的另一列（X 列）中的填充值。这是我在 Workbook_Open 事件中执行的。

但是，当特定行中 X 列的值发生更改时，我还需要能够更新 Y 列的值。此外，如果添加了额外的行，我也需要能够为此提供 Y 值。但是，我似乎找不到合适的事件，除非在工作表级别选择更改事件，当您更改您选择的单元格时会触发该事件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T13:32:54.903

尝试工作表更改事件...为了确保在 X 列中发生了某些事情，您将编写如下内容：

```
Private Sub Worksheet_Change(ByVal Target As Range)
 If Not Intersect(Target, Range("X:X")) Is Nothing Then
   MsgBox ("Hi")
 End If
End Sub 
```

希望这可以帮助

# jquery - Collective.Uploadify 在提交上传后返回错误 500

> ID：13012442
> 
> 赞同：1
> 
> 时间：2012-10-22T13:25:06.077
> 
> 标签：jquery, plone, uploadify

在从 Plone 4.1.1 安装升级和迁移到 Plone 4.2.1 后，collective.uploadify egg 不再起作用。从用户的角度来看，用户可以像以前一样浏览一个或多个文件，并且文件似乎要上传（通过进度条的推进来证明），但是所有上传都以“HTTP Error 500”终止。

collective.uploadify-1.0 和collective.uploadify-1.1 都重现了这种行为。

**客户端实例日志中显示以下错误：**

```
------
2012-10-22T19:50:34 INFO collective.uploadify uploading file: filename=myfile.pdf, content_type=application/pdf
------
2012-10-22-T19:50:34 ERROR Zope.SiteErrorLog 1350953434.830.935215558164 http://www.example.com/site/@@upload_file
Traceback (innermost last):
  Module ZPublisher.Publish, line 126, in publish
  Module ZPublisher.mapply, line 77, in mapply
  Module ZPublisher.Publish, line 46, in call_object
  Module collective.uploadify.browser.upload, line 130, in __call__
TypeError: __call__() takes exactly 7 argument (4 given) 
```

**客户端 Z2 日志中显示以下错误：**

```
192.168.1.1 - Anonymous [22/Oct/2012:19:59:04 - 0500] "POST /https://localhost/VirtualHostBase/https/www.example.com:443/VirtualHostRoot/mount/site/@upload_file HTTP/1.1" 500 4013 "https://www.example.com/mount/site/@@upload" "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.4 (KHTML, like Gecko) Chrome/22.0.1229.94 Safari/537.4" 
```

Plone 在私有 IP 空间中的 RedHat Enterprise Linux 5.5 上运行，在第二个 RedHat Enterprise Linux 5.5 之后，使用 Apache 配置了指向 RewriteRule 的 Proxy Balancer 指令。Plone Site 为每个不同的站点使用 ZODB 挂载点。

该功能在原始安装中有效，该安装已被保留。但是，此 egg 不再适用于迁移的站点或全新安装。

真诚感谢任何有关如何解决或获取其他故障排除详细信息的建议！

# c - 连接的 udp 多播需要在发送方绑定

> ID：13012443
> 
> 赞同：0
> 
> 时间：2012-10-22T13:25:10.820
> 
> 标签：c, linux, network-programming

我有一个模棱两可的问题，我在两个用户之间有一个多播组，其中一个是发送者，另一个是接收者我在每一方都做了这些场景：

接收者：

1.  创建一个 udp 套接字。
2.  绑定到多播组地址
3.  连接到发送方（connect(sender ip)）
4.  加入多播组
5.  来自多播组的recv。

发件人：

1.  创建一个 udp 套接字。
2.  发送到多播组。

在上面的这种情况下，当发送方发送数据接收方无法接收但如果我们通过 tcpdump 检查接收方端，则从多播组接收到数据。但如果接收方没有连接到发送方，则会收到数据。

但是实际上，如果我们让发送者在发送到多播组之前绑定到多播地址，并且接收者也连接到发送方，如上述场景数据将被成功接收！！！！当我们在发送方添加绑定时有什么解释？？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-22T14:25:06.727

您可能希望[`connect(2)`](http://www.kernel.org/doc/man-pages/online/pages/man2/connect.2.html)将发送方的套接字连接到多播组以加快发送速度，但不要[`connect(2)`](http://www.kernel.org/doc/man-pages/online/pages/man2/connect.2.html)接收方，因为它将其限制为单播（是的，这有点令人困惑，但这就是它的工作原理）。只是[`bind(2)`](http://www.kernel.org/doc/man-pages/online/pages/man2/bind.2.html)组/端口的接收者，然后[`setsockopt(2)`](http://www.kernel.org/doc/man-pages/online/pages/man2/setsockopt.2.html)加入[`IP_ADD_MEMBERSHIP`](http://www.kernel.org/doc/man-pages/online/pages/man7/ip.7.html)组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T06:28:26.363

没有“连接的 UDP 多播”之类的东西。它已连接或多播。完全删除 connect() 步骤。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-05T20:47:45.723

在接收方，bind() 和 connect() 调用都做同样的事情：它们将给定的 Internet 套接字地址与给定的无连接套接字相关联。对于`bind()`调用——其中 Internet 套接字地址是多播组的地址——这意味着套接字将只接收目标地址是多播组的 UDP 数据包。对于`connect()`调用 - 其中 Internet 套接字地址是发送者的地址 - 这意味着套接字将只接收目标地址是发送者的 UDP 数据包，这不是您想要的。

`connect()`调用覆盖调用，`bind()`导致没有接收到数据包。

将`bind()`呼叫替换*为对多播组*`connect()`的呼叫，您应该仍会收到 UDP 数据包 - 或仅保留呼叫。这是你的电话。*`bind()`*

# mongodb - 如何使用 MongoDB 或其他文档数据库保存视频文件，可选择添加到现有二进制文件和并行读/写

> ID：13012444
> 
> 赞同：4
> 
> 时间：2012-10-22T13:25:11.283
> 
> 标签：mongodb, video, document, database, nosql

我正在使用视频服务器，我想使用数据库来保存视频文件。由于我只需要存储带有元数据的简单视频文件，因此我尝试在 Java 中使用 MongoDB，通过其[GridFS](http://www.mongodb.org/display/DOCS/GridFS)机制来存储视频文件及其元数据。

但是，我需要两个主要功能，而我无法使用 MongoDB 来管理：

1.  我希望能够添加到以前保存的视频中，因为保存视频可能会分块执行。我不想删除到目前为止的二进制文件，只需在项目末尾附加字节即可。
2.  我希望能够在写入视频项目时读取它。“线程 A”将更新视频项目，添加越来越多的字节，而“线程 B”将从项目中读取，一旦写入/刷新，就会接收“线程 A”写入的所有字节。

我尝试编写简单的代码来做到这一点，但它失败了。似乎 MongoDB 不允许对二进制文件进行多线程访问（即使一个线程正在执行所有写入操作），我也找不到添加到二进制文件的方法 - Java GridFS API 仅提供来自已经现有的 GridFSDBFile，我无法让 OutputStream 写入它。

*   这是否可以通过 MongoDB 实现，如果可以，如何实现？
*   如果没有，您是否知道任何其他可能允许这样做的数据库（最好不要太复杂，例如完整的关系数据库）？
*   我最好使用MongoDB只保留视频文件的元数据，并手动处理文件系统中的二进制数据的读写，这样我就可以自己实现上述要求了吗？

谢谢，

铝

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-22T16:00:30.640

我使用 mongo gridfs 来存储我们使用 Mongo 构建的消息传递系统的媒体文件，这样我就可以分享我们遇到的问题。

因此，在我针对您的用例场景进行讨论之前，我建议不要使用 GridFS，而实际上使用 Amazon S3 之类的东西（具有出色的用于分段上传的 rest apis）并将元数据存储在 Mongo 中。这是我们在首次使用 GridFS 实施后在项目中确定的方法。并不是说 GridFS 不好，只是不太适合分块/附加和重写小部分文件。有关更多信息，这里简要介绍了 GridFS 的优点和缺点：

[http://www.mongodb.org/display/DOCS/When+to+use+GridFS](http://www.mongodb.org/display/DOCS/When+to+use+GridFS)

现在，如果您一心想要使用 GridFS，您需要了解驱动程序和读/写并发的工作原理。

在 mongo (2.2) 中，每个模式/数据库都有一个编写器线程。因此，这意味着当您编写代码时，您基本上无法让另一个线程执行操作。在现实生活中，这是非常快的，因为在写入块（256k）时锁会产生，因此您的阅读器线程可以获取一些信息。请查看此并发视频/演示文稿以获取更多详细信息：

[http://www.10gen.com/presentations/concurrency-internals-mongodb-2-2](http://www.10gen.com/presentations/concurrency-internals-mongodb-2-2)

因此，如果您基本上看我的两个链接，我们可以说问题 2 得到了回答。您还应该了解一点关于 Mongo 如何编写大型数据集以及页面错误如何为读取器线程提供获取信息的方式。

现在让我们解决您的第一个问题。Mongo 驱动程序不提供将数据附加到 GridFS 的方法。它意味着是一个触发/忘记原子类型的操作。但是，如果您了解数据如何以块的形式存储以及如何计算校验和，那么您可以使用 fs.files 和 fs.chunks 方法手动执行此操作，如此海报所述：

[将数据附加到现有的 gridfs 文件](https://stackoverflow.com/questions/6280186/append-data-to-existing-gridfs-file)

因此，通过这些您可以看到可以做您想做的事情，但我的一般建议是使用专为此类交互设计的服务（例如 Amazon S3），而不是尝试做额外的工作来使 Mongo 适合您的需求。当然，您也可以直接访问文件系统，这将是穷人的选择，但您会失去使用 GridFS 或 S3 获得的冗余、分片、复制等。

希望有帮助。

-普拉西斯

# javascript - jquery样式不适用于动态创建

> ID：13012447
> 
> 赞同：1
> 
> 时间：2012-10-22T13:25:19.643
> 
> 标签：javascript, listview, jquery-mobile

我在 jquery mobile 中创建了可折叠的列表视图。它是动态的。如果我在 html 代码中创建了可折叠，它显示得很好。我动态尝试的同一个，然后不应用样式。

Html页面中的代码：

```
<div data-role="collapsible">
                    <h2>Bucks County<br>BU</h2>
                    <ul data-role="listview">
                        <li><a href="index.html">Location </a></li>
                    </ul>
            </div> 
```

jQuery中的代码：

```
$("#lsititems").append('<div data-role="collapsible">'+
                    '<h2>'+data[0].SiteName+'<br>'+data[0].SiteCode+'</h2>'+
                    '<ul data-role="listview">'+
                    '<li>'+'<a href="index.html">'+'Location'+'</a>'+'</li>'+
                    '</ul>'+
                    '</div>') 
```

我也试过这个：

```
$("#lsititems").append("<div data-role='collapsible'>"+
                                "<h2>"+data[1].SiteName+"<br>"+data[1].SiteCode +"</h2>"+
                                "<ul data-role='listview'>"+
                                "<li>"+"<a href='index.html'>"+"Location"+"</a>"+"</li>"+
                                "</ul>"+
                                "</div>") 
```

输出/输出：

![在此处输入图像描述](../Images/0cbf71025b8d8f851bb6b8fd42d0f8cc.png)

从上面的代码中，第一个是从 Html 创建的，第二个和第三个是在 jquery 中动态创建的。我的代码有什么问题..请帮助我..提前谢谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T13:33:45.663

在 jQuery mobile 中，当您动态添加内容时，您需要初始化内容，或者如果您正在添加内容（例如向列表视图添加项目），则需要刷新内容。

如果您有多个项目需要初始化，您只需触发`create event`页面上的 即可[初始化](http://jquerymobile.com/demos/1.2.0/docs/forms/docs-forms.html)所有项目。通常最好在`pageshow`事件中这样做。

例如

```
$("#mypage").on('pageshow', function () {
   $(this).trigger("create");
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-22T13:33:55.290

对于动态添加的内容，您需要调用`.collapsible()`方法：

```
$('div[data-role=collapsible]').collapsible(); 
```

# asp.net-mvc - 如何使用 linq 过滤 MVC4 中的图像数据

> ID：13012449
> 
> 赞同：0
> 
> 时间：2012-10-22T13:25:25.640
> 
> 标签：asp.net-mvc, c#-4.0, asp.net-mvc-2, razor

如何从数据库中显示 MVC4 中的图像。

第 1 步：在我的代码中，检索数据并放入数组类中。

```
public class ImageTable
{
    public string ImageId { get; set; }
    public string CategoryId { get; set; }
    public byte[] Image { get; set; }
}

public class DataAcceess
{
    public ImageTable[] GetImages()
    {
        ImageTable[] Images = null;
        SqlConnection Conn = new SqlConnection("Data Source=;Initial Catalog=;UserID=;Password=;");

        Conn.Open();
        //SqlCommand Cmd = new SqlCommand("Select [Product ID],ImageView1 From Cpecial_Image_tbl", Conn);

        SqlCommand Cmd = new SqlCommand("Select b.[Category ID],a.[Product ID], a.[ImageView1] from Cpecial_Image_tbl as a  inner join [Cpecial_Product_tbl] as b ON a.[Product ID]=b.[Product ID]", Conn);

        SqlDataReader Reader = Cmd.ExecuteReader();
        DataTable dt = new DataTable();
        dt.Load(Reader);
        Images = new ImageTable[dt.Rows.Count];
        int i = 0;
        foreach (DataRow Dr in dt.Rows)
        {
            Images[i] = new ImageTable()
            {
                ImageId = (string)Dr["Product ID"],
                CategoryId = (string)Dr["Category ID"],
                Image = (byte[])Dr["ImageView1"]
            };
            i = i + 1;
        }

        Conn.Close();
        return Images;
    } 
```

第2步：在控制器中检索图像值分配，它在字节数组中并像这样返回到视图。

```
 public ActionResult Index(string id)
        {

            // var image = db.Categories.First(m => m.CategoryID == id).Picture;

            DataAcceess objContext = new DataAcceess();

            //byte[] Image = (from a in Images select a.Image.ToArray());

            byte[] a;

            foreach (var item in objContext.GetImages())
            {
                a = item.Image;
                return File(a, "Image/jpg");
            }

               return View();
        } 
```

第 3 步：我像这样在视图中添加了标签，这将只显示一张图像。

我想显示所有图像，并
像在购物车中一样处理与过滤器相关的图像（升序排序，使用 catagoryId 降序）。

谁能给我解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T13:41:34.747

您必须分别检索每个图像。return 语句结束你所在的函数。

就个人而言，我会将图像保存在文件系统上，并将它们的路径保存在带`ImageUrl`注释的模型属性中。

*   然后您可以只制作一个 DisplayFor，因为图像将是您的模型的属性。
*   如果您将图像保存在数据库中。数据库将变得又大又慢。

# ios - iOS 社交框架和加密

> ID：13012451
> 
> 赞同：0
> 
> 时间：2012-10-22T13:25:29.457
> 
> 标签：ios, encryption, frameworks, social

我想知道你们中是否有人可以回答这个疑问。

我正在编写一个应用程序，您可以在其中输入一些文本。我想添加通过社交框架在 Facebook 和 Twitter 上发帖的功能。所以没有登录等等，只有 SLComposerViewController 对象。

因为在Social框架内部，据我了解，有API来处理帐户和请求，我认为Social框架包含一些加密......

那么，如果我在我的应用程序中包含社交框架，我是否需要出口合规批准？

我注意到我的应用程序只共享一个键入的文本，而不是帐户操作。

感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T13:32:43.043

你不应该 100% 相信任何回答这个问题的人，除非他们是律师。但...

不，您不必获得出口合规性。

如果您需要进一步确认，我建议您咨询律师或咨询 Apple。

# rest - 在 REST api 中表示超类型的最佳方式是什么？

> ID：13012457
> 
> 赞同：0
> 
> 时间：2012-10-22T13:25:47.943
> 
> 标签：rest, hateoas

让我们考虑一下我们有一个用于动物园的 api，`../api/zoos`它可以一直访问给定动物园中的个体动物，例如`../api/zoos/123/elephants/234`，每种动物类型都有明确定义的 api。
    现在，如果我们想查询超类型（抽象类 Animal where ），为此类元查询`class Elephant extends Animal`公开此类 api 是个好主意吗？`../api/zoos/123/animals?type="mammal"&legs=4`
    让我对这种方法三思而后行的是，虽然超类型 api 对于跨具体类型的元查询实际上很有用，但这本质上是一个只读查询，同样从可扩展性的角度来看，在超类型 Animal 和具体类型之间Elephant 可以有许多其他类型，如 Mammal、FourLegged 等，可以单独查询，然后需要调用是否需要在这些上公开只读 api，或者我们在动物查询中有类型参数就可以了。请建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T16:49:35.137

您对每种动物都有单独的 ID 吗？
我的意思是，是否有大象 ID=4 和老虎 ID=4？

如果没有，我会将其结构为`/zoos/123/animals/234`

然后，您可以`/zoos/123/animals?species=elephant`列出所有大象，并返回一组 ID 可能看起来有些随机的链接：`{ /zoos/123/animals/5, /zoos/123/animals/19, /zoos/123/animals/34, /zoos/123/animals/35, /zoos/123/animals/72 }`

如果您**确实有**跨物种的 ID 冲突，那么我建议创建一个动物 ID 到物种 ID 的新资源映射：

```
+----------------------------+
|animal_id|species|species_id|
+----------------------------+
|       1 |  duck |        1 |  => the first duck is /animals/1
|       2 |  frog |        1 |  => the first frog is /animals/2
+----------------------------+ 
```

然后你仍然可以使用 URL 结构`/zoos/123/animals/234`。您无需将青蛙称为`/frogs/1`页面，例如`/animals?order=anura&page=1&limit=10`直接为您提供指向 /animals/2 的链接

总之，**ID 属于您的超类**

# python - 德摩根定律是 Pythonic 吗？

> ID：13012459
> 
> 赞同：23
> 
> 时间：2012-10-22T13:25:53.360
> 
> 标签：python, pep8, demorgans-law

以下哪个 if 语句更符合 Python 风格？

```
if not a and not b:
    do_something 
```

或者

```
if not ( a or b ):
    do something 
```

它不是谓词逻辑，所以我应该使用 Python 关键词，因为它更具可读性，对吧？

在后来的解决方案中比其他解决方案更优化？（我不相信。）

有这方面的 PEP-8 指南吗？

两种方法的字节码（如果重要）：

```
In [43]: def func1():
    if not a and not b:
        return
   ....:     
   ....:     

In [46]: def func2():
    if not(a or b):
        return
   ....:     
   ....:     

In [49]: dis.dis(func1)
  2           0 LOAD_GLOBAL              0 (a)
              3 UNARY_NOT           
              4 JUMP_IF_FALSE           13 (to 20)
              7 POP_TOP             
              8 LOAD_GLOBAL              1 (b)
             11 UNARY_NOT           
             12 JUMP_IF_FALSE            5 (to 20)
             15 POP_TOP             

  3          16 LOAD_CONST               0 (None)
             19 RETURN_VALUE        
        >>   20 POP_TOP             
             21 LOAD_CONST               0 (None)
             24 RETURN_VALUE        

In [50]: dis.dis(func2)
  2           0 LOAD_GLOBAL              0 (a)
              3 JUMP_IF_TRUE             4 (to 10)
              6 POP_TOP             
              7 LOAD_GLOBAL              1 (b)
        >>   10 JUMP_IF_TRUE             5 (to 18)
             13 POP_TOP             

  3          14 LOAD_CONST               0 (None)
             17 RETURN_VALUE        
        >>   18 POP_TOP             
             19 LOAD_CONST               0 (None)
             22 RETURN_VALUE 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-22T13:51:54.563

我认为您的两个示例都具有同样的可读性，但是如果我想在可读性上“将船推出”，我会选择：

```
not any((a, b)) 
```

*因为对我来说这读起来更像英语，因此是最 Pythonic 的。*

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-10-22T13:28:14.323

我会说哪个更容易阅读，这取决于 a 和 b 是什么。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-22T13:29:53.060

使用哪个？对于您正在尝试做的事情，哪个更具可读性。

至于哪个效率更高，第一个确实做了额外的`not`工作，因此在技术上效率较低，但在正常情况下您不会注意到。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-22T13:28:47.210

它们是等价的，一个是否比另一个快取决于具体情况（a 和 b 的值）。

因此，只需选择您认为最易读和/或可理解的版本。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-22T14:19:12.257

我个人喜欢 Eiffel 方法，放入 pythonic 形式

如果 a 然后 b：做某事

如果 a 和 b：做某事

如果 a 为假，则第一种方法与第二种方法不同。在第一种情况下它不会评估 b，在第二种情况下它会。

或等价物是“或其他”

[http://en.wikipedia.org/wiki/Short-circuit_evaluation](http://en.wikipedia.org/wiki/Short-circuit_evaluation)

和/或渴望。

然后/或将评估短路

语法的好处是它读起来很好，并且没有引入新的关键字。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-18T03:50:51.983

对于一段 Pythonic 的代码，它必须本身（可读）和在其周围环境中（一致）都令读者感到愉悦。如果没有这段代码的上下文，很难给出好的意见。

但是，另一方面......如果我在我看来是 Pythonic，我需要与我的环境一致地操作，这似乎没有考虑到上下文（例如 OP）。

最上面的一个。

# php - 过滤Json对象属性添加css样式

> ID：13012463
> 
> 赞同：0
> 
> 时间：2012-10-22T13:26:07.963
> 
> 标签：php, javascript, json, backbone.js, underscore.js

感谢您帮助学习如何做到这一点，假设我有一个类似于这个的代码。

**骨干脚本：**

```
$(function(){
  var Band = Backbone.Model.extend();
    var BandList = Backbone.Collection.extend({
    model: Band,
    url: 'feed1.json'
  });

  var BandsView = Backbone.View.extend({
    template: _.template($('#bandlist_template').html()),
    render: function(eventName) {
      _.each(this.model.models, function(band){
        var lTemplate = this.template(band.toJSON());

        $(this.el).append(lTemplate);
      }, this);
      return this;
    }
  });

  var lBands = new BandList;

  var AppView = Backbone.View.extend({
    el: "body",

    render: function(){
      var lBandsView = new BandsView({model:lBands});
      var lHtml = lBandsView.render().el;
      $('#bands').html(lHtml);
    },

    initialize: function(){
      var lOptions = {};
      lOptions.success = this.render;
      lBands.fetch(lOptions);
    }
  });

  var App = new AppView;
}); 
```

**下划线js模板：**

```
<script type="text/template" id="bandlist_template">
  <?php echo "hello"; ?><li><%= band_name %> - <%= section %></li>
</script> 
```

**HTML：**

```
<ul id="bands">
</ul> 
```

**杰森：**

```
[
  {
    "id": "149",
    "band_name": "Armthorpe Elmfield",
    "section": "Fourth"
  },
  {
    "id": "127",
    "band_name": "Barnsley Chronicle",
    "section": "Second"
  },
  {
    "id": "155",
    "band_name": "Barnsley Metropolitan Band",
    "section": "Fourth"
  }
] 
```

好的。假设我想`css`根据`json` `section`属性更改样式（只需要放 div 和样式只有 json`section`属性`'Fourth'`）。那么如何过滤该属性并将其推送到另一个主干 js 中填充`div`在同一`ul`.

**就像这个：**

```
<ul id="bands">
</li>Armthorpe Elmfield - <div class="styled">Fourth</div><li>
</li>Barnsley Chronicle - Second<li>
</li>Barnsley Metropolitan Band - <div class="styled">Fourth</div><li>
</ul> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T14:53:20.167

您拥有所需的一切，只需使用模板：

```
<script type="text/template" id="bandlist_template">
    <?php echo "hello"; ?>
    <li><%= band_name %> - 
        <% if section is 'Fourth': %>
            <div class="styled">Fourth</div>
        <% else: %>
            <%= section %>
        <% end %>
    </li>
</script> 
```

当然，它可以做得更好，但只是为了证明这一点`if`和其他控制结构在您的模板中工作没有问题。（在示例中，我在 if 中使用`eco`语法，如果需要，只需将其修复为使用普通 javascript）。

# jquery - 数据表 fnRender

> ID：13012468
> 
> 赞同：0
> 
> 时间：2012-10-22T13:26:23.657
> 
> 标签：jquery, datatable

我对 dataTable fnRender 有疑问。我用它来将我的单元格值从值更改为带值的输入。

我的部分代码：

```
{ "sTitle": "Cena netto",
              "fnRender": function(obj) {
         var sReturn = obj.aData[ obj.iDataColumn ];   
         sReturn = "<input type='text' id='Tcena_nettoZ_"+obj.aData[0]+"' class='cena_n'  name='Tcena_nettoZ_"+obj.aData[0]+"' value = '"+sReturn+"'/>";

         return sReturn;
         } 
```

现在，当我更改此值时，如何更改此行中其他单元格的值？我将类添加到此输入，但代码：

```
$('.cena_n').change(function(){alert('a');}); 
```

不行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T13:41:49.343

您`alert('a');`不工作的原因是因为该元素在文档准备就绪时不存在....您需要使用委托事件。

尝试：

```
$('#your-table-id').on('change', '.cena_n', function() { alert('a'); }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-22T14:14:41.933

如果我正确理解您的问题，[`change`](http://api.jquery.com/change/)则不是您要使用的功能。

要修改`input`标签的值，您应该使用[`val()`](http://api.jquery.com/val/)：

```
$('cena_n').val( 'newValue' ); 
```

# c# - 实体框架中的分组和计数

> ID：13012472
> 
> 赞同：4
> 
> 时间：2012-10-22T13:26:41.673
> 
> 标签：c#, entity-framework, linq-to-entities, count

我有一个包含日志的表，我每天计算的日志如下：

```
// Count logs by day
IList<DataModel> models = _context.Logs
  .Where(x => x.Created >= dateMinimum && x.Created <= dateMaximum)
  .GroupBy(x => new { Year = x.Created.Year, Month = x.Created.Month, Day = x.Created.Day })
  .Select(x => new { Year = x.Key.Year, Month = x.Key.Month, Day = x.Key.Day, Count = x.Count() })
  .AsEnumerable()
  .Select(x => new DataModel { Date = new DateTime(x.Year, x.Month, x.Day), LogsCount = x.Count })
  .ToList();

// Fill empty days with dates which contains all days in range
models.AddRange(dates.Where(x => !models.Any(y => y.Date == x.Date)).Select(x => new DataModel { Date = x, LogsCount = 0 })); 
```

如果我想独立于类型按天计算所有日志，这是可行的。

但我想按天计算日志并输入（错误、警告、信息……）。

我试图将 x.Type 添加到组中，但最后我只得到 3 个项目。

目前我的数据模型如下：

```
public class DataModel
{
    public DateTime Date { get; set; }
    public Int32 LogsCount { get; set; }
} 
```

但也许它应该是这样的：

```
public class DataModel
{
    public DateTime Date { get; set; }
    public KeyValuePair<String, Int32> LogsCount { get; set; }
} 
```

其中 LogsCount 有一个包含类型的字符串和包含计数的 Int32。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-12-20T03:43:06.270

可能要考虑使用[实体函数](http://msdn.microsoft.com/en-us/library/system.data.objects.entityfunctions.aspx)按日期分组。

例子：

```
var results = query.GroupBy(r => new
{
    SentDate = System.Data.Objects.EntityFunctions.TruncateTime(r.Launch.EmailDeliveredDate),
    EventSubTypeID = r.EmailEventSubtypeID
})
.Select(x => new
{
    x.Key.SentDate,
    x.Key.EventSubTypeID,
    NumResults = x.Count()
})
.ToList(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-22T14:53:52.770

你尝试过这样的事情吗？

```
IList<DataModel> models = Logs
  .Where(x => x.Created >= dateMinimum && x.Created <= dateMaximum)
  .GroupBy(x => new { Year = x.Created.Year, Month = x.Created.Month, Day = x.Created.Day, Type = x.Type })
  .Select(x => new { Year = x.Key.Year, Month = x.Key.Month, Day = x.Key.Day, Count = x.Count(), Type = x.Key.Type })
  .AsEnumerable()
  .Select(x => new DataModel { Date = new DateTime(x.Year, x.Month, x.Day), LogsCount = x.Count, Type = x.Type })
  .ToList()

public class DataModel
{
    public DateTime Date { get; set; }
    public Int32 LogsCount { get; set; }
    public string Type { get; set; }
} 
```

# java - 是否可以模拟私有静态最终字符串文字？

> ID：13012477
> 
> 赞同：0
> 
> 时间：2012-10-22T13:26:54.623
> 
> 标签：java, oracle, unit-testing, mocking, hsqldb

我对上述问题的猜测是这是不可能的，但我需要确认。所以问题是私有静态最终字符串中有一个Oracle特定的SELECT（使用ROWNUM和FOR UPDATE SKIP LOCKED关键字）。

```
private static final String REC_QUERY_SELECT = "SELECT * FROM ... WHERE ROWNUM <=1 for update skip locked"; 
```

我想用 HSQL 对它进行单元测试，但 HSQL 不知道这些 Oracle 关键字。我想修改 REC_QUERY_SELECT 变量（将 SELECT 修改为更简单的变量），但我不能，因为它是 final 和 String 文字。有没有办法修改它？（我不能更改代码库，我只需要编写单元测试）。我也试过这段代码：

```
field.setAccessible(true);
Field modifiersField = Field.class.getDeclaredField("modifiers");
modifiersField.setAccessible(true);
modifiersField.setInt(field, field.getModifiers() & ~Modifier.FINAL);
field.set(null, newValue); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T13:32:23.347

作为*编译时常量*（参见 JLS），字符串将在编译时复制到调用站点，因此在运行时更改值可能无济于事。

通常，您应该在测试中像在生产中一样对待针对不同数据库的处理。相同的旧质量软件工程，通常不涉及反射。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-22T13:32:35.640

使用[ASM](http://asm.ow2.org/)，您可以就地修改目标类的字节码，并在运行时使用修改后的类。

# java - Windows 上的 Java WatchService 在复制内容之前通知文件夹创建

> ID：13012487
> 
> 赞同：1
> 
> 时间：2012-10-22T13:27:34.530
> 
> 标签：java, windows, java-7, watchservice

我正在尝试使用 Java 7 和 WatchService 来监视何时将文件夹添加到文件夹中（通过从不同位置复制），然后我想对新创建的文件夹中的文件进行操作。

在 OSX 上，它按我的预期工作，在复制文件夹及其内容之前，我不会收到新文件夹创建的通知。但是在 Windows 上，我在文件夹的内容被复制之前收到了关于文件夹创建的关键事件，所以当我尝试处理文件夹中的文件时，那里不存在，通常只有第一个文件在那里。

我目前的解决方法是在收到文件夹通知后，我睡了 10 秒钟以等待其中的文件被复制，但这不是很令人满意，因为文件夹的大小可能会有很大差异，所以我睡眠时间不够长或时间太长大多数时候。

为什么 OSX 和 Windows 之间存在差异，如何解决我在 Windows 上的问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T18:09:06.217

WatchService 旨在某种程度上依赖于平台。从[Java 7 API 文档](http://docs.oracle.com/javase/7/docs/api/java/nio/file/WatchService.html)：

```
 The implementation that observes events from the file system is 
    intended to map directly on to the native file event notification 
    facility where available, or to use a primitive mechanism, such as 
    polling, when a native facility is not available. Consequently, many 
    of the details on how events are detected, their timeliness, and 
    whether their ordering is preserved are highly implementation specific. 
```

考虑以下两种情况。

*   比休眠时间更长的单个复制操作。
*   多个复制操作到同一个文件夹。

如果您响应文件夹内容的创建而不是文件夹本身，那么您将涵盖这两种情况。您还可以消除睡眠中固有的竞争条件。

# javascript - chrome 22 和过期 cookie 错误（由 jQuery.cookie 设置）

> ID：13012490
> 
> 赞同：0
> 
> 时间：2012-10-22T13:28:00.957
> 
> 标签：javascript, jquery, google-chrome, cookies

仅在 Google Chrome 22（最新稳定版 22.0.1229.94 m）上，当我关闭浏览器时，我的 cookie 总是过期，即使它设置为 2022 年也是如此。我使用 jQuery 插件在 Javascript 中设置 cookie： [https ://github.com/carhartl/jquery-cookie](https://github.com/carhartl/jquery-cookie)

我这样做：

```
$.cookie("mycookie", "value", { expires: 365*10, path: 'xxx.pl' }); 
```

例如在 Firefox 上一切正常。

问题是..为什么它在 Chrome 上不起作用？这是一个错误还是我做错了什么。

# c# - 查询包含多个字符串的 PrincipalSearcher

> ID：13012497
> 
> 赞同：2
> 
> 时间：2012-10-22T13:28:29.693
> 
> 标签：c#, usergroups, principalcontext, principalsearcher

我希望能够查询活动目录，给出包含某些单词的所有组的列表，例如用户或管理员下面是我到目前为止所得到的

```
PrincipalContext ctx = new PrincipalContext(ContextType.Domain);
GroupPrincipal qbeGroup = new GroupPrincipal(ctx);
qbeGroup.DisplayName = "Administrators";
qbeGroup.DisplayName = "Users";
PrincipalSearcher srch = new PrincipalSearcher(qbeGroup);
return srch.FindAll().Select(g => g.Name).ToArray(); 
```

此代码似乎甚至没有过滤掉不是管理员或用户的组名称。但无论如何我想不通的是如何查询组名是否包含？而不是如果组名等于以及如何对多个字符串执行此操作。

我可以使用 DirectoryEntry 做同样的事情，所以我把它放在这里供参考

```
var groups = new List<string>();
var path = string.Format("LDAP://CN=Users,DC=company,DC=com");
var computerEntry = new DirectoryEntry(path);

if (computerEntry != null)
   {
       using (computerEntry)
       {
            var userNames =
            from DirectoryEntry childEntry
            in computerEntry.Children
            where childEntry.SchemaClassName == "Group"
            select childEntry.Name;
            foreach (var name in userNames)
            {
                 if (name.Contains("Administrators") || name.Contains("Users"))
            {
             groups.Add(name);
       }
   }
}
}
return groups.ToArray(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T14:28:05.840

我通过使用 foreach 循环来做到这一点但是以下代码仍然没有回答我关于如何为 Principalsearcher 执行此操作的问题

```
var groups = new List<string>();
PrincipalContext ctx = new PrincipalContext(ContextType.Domain);
GroupPrincipal qbeGroup = new GroupPrincipal(ctx);
PrincipalSearcher srch = new PrincipalSearcher(qbeGroup);
    foreach (var group in srch.FindAll())
    {
       if (group.Name.Contains("Administrators") || group.Name.Contains("Users"))
       {
             groups.Add(group.Name);
       }
    }
return groups.ToArray(); 
```

# .net-4.5 - .net 4.5 异步语法

> ID：13012504
> 
> 赞同：3
> 
> 时间：2012-10-22T13:29:00.127
> 
> 标签：.net-4.5, async-await

我写了下面的代码，

```
Task.Factory.StartNew<int>(async () =>
        {
            await Task.Delay(1000);
            return 42;
        }); 
```

但是 read 行出现在“async”关键字下，并且由于某些语法错误而无法编译代码，有人可以告诉我该怎么做吗？

多谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-22T14:33:26.600

您可能想要使用`Task.Run`，它具有更自然的`async`lambda 语法：

```
var task = Task.Run(async () =>
{
  await Task.Delay(1000);
  return 42;
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-22T14:19:58.147

您必须返回 a `Task<T>`，如下所示：

```
Task.Factory.StartNew<Task<int>>(async () =>
{
    await Task.Delay(1000);
    return 42;
}); 
```

关键字需要`async`返回,`Task`或。阅读有关它的更多信息：[异步（C# 参考）](http://msdn.microsoft.com/en-us/library/hh156513.aspx)。`Task<T>``void`

# jquery - 网站预加载

> ID：13012505
> 
> 赞同：1
> 
> 时间：2012-10-22T13:29:00.033
> 
> 标签：jquery, image, preloader

这是我的网站：http: [//justxp.plutohost.net/jonydesigns/index.php](http://justxp.plutohost.net/jonydesigns/index.php)

当您将鼠标悬停在菜单图像上时，您会看到它们会跳动，因为悬停图像尚未更改或加载器尚未更改。

和整体图像。

我想制作一个在加载页面时显示 loading.gif 图标的预加载器，一旦加载，只需显示页面或淡出到页面。

是否有任何预加载器教程？我用谷歌搜索了网站预加载器，我发现的只是一些自定义 css 预加载栏和用于指定图像的预加载器。

我需要整个网站的预加载器。

有人知道我在哪里可以找到吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T13:32:38.900

要预加载图像，只需将其放入您的初始化中（您不必等待 document.ready 运行它）：

```
var img1 = new Image();
img1.src = "http://www.colorcombos.com/images/colors/hex-codes/003366.png";
var img2 = new Image();
img2.src = "http://www.colorcombos.com/images/colors/hex-codes/FF9900.png" 
```

或 ( jQuery : )

```
$.preloadImages = function()
{
  for(var i = 0; i<arguments.length; i++)
  {
    jQuery("<img />", {style:'display:none'}).attr("src", arguments[i]);
  }
} 
```

用法 ：

```
$.preloadImages("img2_thumb.jpg", "img1_thumb.jpg",    "img3_thumb.jpg"); 
```

*当然-图像应该是悬停图像。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-22T13:34:42.597

对于热门横幅，您需要预加载图片： [http ://rah1x.tumblr.com/post/323​​90880686/pre-load-images](http://rah1x.tumblr.com/post/32390880686/pre-load-images)

对于站点的其余部分，您希望在加载图像时加载图像，这里有一些可以帮助您入门的内容。这适用于单个图像，但是，您可以使用 jquery 简单地将其作为图像加载事件： [http： //rah1x.tumblr.com/post/32450670309/show-loading-while-image-src-changes](http://rah1x.tumblr.com/post/32450670309/show-loading-while-image-src-changes)

# javascript - dojox.mobile.ListItem - 通过点击/触摸传递参数

> ID：13012507
> 
> 赞同：0
> 
> 时间：2012-10-22T13:29:07.287
> 
> 标签：javascript, list, mobile, dojo

我有这个代码：

```
<ul data-dojo-type="dojox.mobile.RoundRectList">

  <li data-dojo-type="dojox.mobile.ListItem" data-dojo-props='moveTo:"places_aroud_me_view",callback: set_placeTypeAroundMe_calback("park"),transition:"slide"'>Park</li>

  <li data-dojo-type="dojox.mobile.ListItem" data-dojo-props='moveTo:"places_aroud_me_view",callback: set_placeTypeAroundMe_calback("art"),transition:"slide"'>Art</li>

</ul> 
```

如您所见，使用了calback，它指的是带有参数的特定函数。基本上它不起作用，因为代码总是启动所有回调中的所有函数（控制台日志将一个接一个地显示所有调用）。

如果我这样做：

```
<li data-dojo-type="dojox.mobile.ListItem" data-dojo-props='moveTo:"places_aroud_me_view",callback: set_placeTypeAroundMe_calback,transition:"slide"'>Park</li> 
```

回调工作得很好。一键 -> 一个回调。

那么....如何将参数传递给calback中的js函数？我想要做的是设置一个全局 js 变量值，所以在下一个 dojo 移动视图中（点击后）我可以访问这个变量（并将它用于某些事情，在此处检查位置类型）。

如果无法以这种方式传递参数，那么也许有人知道将变量从一个 dojo 移动视图传递到另一个视图的其他方法（最好使用列表）？

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T19:45:27.140

您可以看一下 Dojo Mobile Showcase 的一个示例： [http://demos.dojotoolkit.org/demos/mobileCharting/demo.html](http://demos.dojotoolkit.org/demos/mobileCharting/demo.html) 资源被压缩了一点，所以它们不会给您清晰的画面。无论如何...看起来与您的设置非常相似。具有多个 li-s 的列表视图和一个目标视图。

您可以以编程方式创建 listitem 元素（在创建时附加事件），或者稍后通过向它们添加 id 属性（或使用 dojo 的查询功能）简单地获取它们。

```
function something(item){
     require(["dojo/dom-attr"], function(domAttr){
          var data = domAttr.get(item,"customattribute");//use your data
          //work with destination view
     });
}

require(["dojo/dom","dojo/on"], function(dom,on){ 
    var item = dom.byId("listitem1");
    on(item,"click", something(item));
}); 
```

这只是一个一般的想法，您可以使用 dojo/query 扩展它以一次获取所有列表项，并使用包含您的数据的自定义属性扩展列表项。例如

```
<li customattribute="data" data-dojo-type="dojox.mobile.ListItem" ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T08:45:36.810

这里是：

```
<li id="park" class="places_around_me_list" data-dojo-type="dojox.mobile.ListItem" data-dojo-props='moveTo:"places_aroud_me_view",transition:"slide"'>Park</li>

<li id="art" class="places_around_me_list" data-dojo-type="dojox.mobile.ListItem" data-dojo-props='moveTo:"places_aroud_me_view",transition:"slide"'>Art</li>

require(["dojo/dom", "dojo/query", "dojo/on", "dojo/dom-attr", "dojo/domReady"], function(dom, dquery, on, domAttr){
    node = dquery(".places_around_me_list");
    on(node, "touchstart", function(e){
        id = domAttr.get(this, "id");
        //console.log("Clicked id:" + id);
        set_placeTypeAroundMe_reference(id);
    });     
}); 
```

请注意，在桌面上您需要将事件附加到“单击”，而在移动设备上，此解决方案将与我在下面提到的“回调”具有相同的效果（总是最后运行......）。同样在移动设备上，比如警报会阻止 dojo 移动设备“moveTo”的工作......所以基本上解决方案并不完美。有什么选择吗？

编辑：好的，这里有一个代码也可以在点击移动设备上工作。它似乎完全稳定：

```
require(["dojo/dom", "dojo/query", "dojo/on", "dojo/dom-attr", "dojo/domReady"], function(dom, dquery, on, domAttr){
    node = dquery(".places_around_me_list");
    dquery(".places_around_me_list").forEach(function(item){
        on(item, "click", function(e){
        id = domAttr.get(item, "id");
        set_placeTypeAroundMe_reference(id);
        });
    });     
}); 
```

EDIT2：有时在dojo mobile中，您可能会遇到此错误->在您将手指从触摸屏上移开之前，您可能会启动完全不需要的操作或响应（例如，在您移开手指之前将一个列表替换为新列表）。这应该有助于：

```
on(item, touch.release, function(e){...} 
```

# r - 如何使用 R 基于外部列表从 data.frame 中删除行？

> ID：13012509
> 
> 赞同：32
> 
> 时间：2012-10-22T13:29:14.993
> 
> 标签：r, dataframe

这可能是一个简单的问题，但我仍然需要一些帮助来使用 R。

我有一个data.frame（main_data），可以说..

```
NAMES   AGE     LOC
Jyo     23      Hyd
Abid    27      Kar
Ras     24      Pun
Poo     25      Goa
Sus     28      Kar 
```

我希望根据名称列表删除几行。所以假设我有另一个表格列表，如下所示：

```
NAMES_list
Jyo
Ras
Poo 
```

所以根据这个列表，如果任何名称与我上面的“main_data”表匹配，那么我想删除包含它们的整行，所以结果应该如下

```
NAMES   AGE     LOC
Abid    27      Kar
Sus     28      Kar 
```

谁能帮助我如何使用 R 实现这一目标？提前致谢.. ：）

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-10-22T13:35:57.770

使用`%in%`：

```
main_data2 <- main_data[ ! main_data$NAMES %in% NAMES_list, ] 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-10-22T14:13:37.720

如果碰巧你实际上有 a [`data.table`](http://datatable.r-forge.r-project.org/)（而不是 a `data.frame`），而你`data.table`有 a `key`，你可以使用 not join 成语

```
library(data.table)
dat <- as.data.table(read.table(text="
NAMES   AGE     LOC
Jyo     23      Hyd
Abid    27      Kar
Ras     24      Pun
Poo     25      Goa
Sus     28      Kar", 
stringsAsFactors=FALSE, header=TRUE))

setkey(dat, NAMES)

to.remove <- c("Jyo","Ras","Poo")
dat[-dat[to.remove, which=TRUE]]
#   NAMES AGE LOC
#1:  Abid  27 Kar
#2:   Sus  28 Kar 
```

当然，其他[两个](https://stackoverflow.com/a/13012659/967840) [答案](https://stackoverflow.com/a/13012618/967840)也适用于 a `data.table`，但这应该更有效。

* * *

**编辑**

从 data.table 版本 1.8.3 开始，“！” 前缀可用于“不加入”（参见[NEWS](https://r-forge.r-project.org/scm/viewvc.php/pkg/NEWS?view=markup&revision=713&root=datatable)）。

```
dat[!to.remove]
   NAMES AGE LOC
1:  Abid  27 Kar
2:   Sus  28 Kar 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-10-22T13:38:50.547

复制您的数据：

```
dat <- read.table(text="
NAMES   AGE     LOC
Jyo     23      Hyd
Abid    27      Kar
Ras     24      Pun
Poo     25      Goa
Sus     28      Kar", 
stringsAsFactors=FALSE, header=TRUE)

remove <- c("Jyo", "Ras", "Poo") 
```

简单子集：

```
dat[!dat$NAMES %in% remove, ]
  NAMES AGE LOC
2  Abid  27 Kar
5   Sus  28 Kar 
```

* * *

它是这样工作的：使用`!`否定的组合并`%in%`返回一个逻辑向量，该向量指示要保留的行：

```
!dat$NAMES %in% remove
[1] FALSE  TRUE FALSE FALSE  TRUE 
```

我记得我第一次看到这个结构时感到很惊讶。为什么它会`!dat$NAMES`返回任何有用的东西？好吧，当然洞察力是`%in%`首先评估中缀运算符，因此 the`!`只是一个逻辑 NOT 运算符。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-23T05:03:28.833

`match`如果您的 main_data$NAMES 中有唯一值，您也可以使用

```
NAMES_list <- c("Jyo","Ras","Poo")
main_data <- main_data[-match(NAMES_list,main_data$NAMES),]
main_data
  NAMES AGE LOC
2  Abid  27 Kar
5   Sus  28 Kar 
```

它将删除与您的 NAMES_list 与 main_data$NAMES 完全匹配的行。

# java - 如何在hadoop中运行jar文件？

> ID：13012511
> 
> 赞同：12
> 
> 时间：2012-10-22T13:29:19.910
> 
> 标签：java, jar, hadoop

我使用以下语句使用[此博客中的 java 文件创建了一个 jar 文件](http://java.dzone.com/articles/hadoop-basics-creating)

`javac -classpath /usr/local/hadoop/hadoop-core-1.0.3.jar -d /home/hduser/dir Dictionary.java`

`/usr/lib/jvm/jdk1.7.0_07/bin/jar cf Dictionary.jar /home/hduser/dir`

现在我尝试通过点击和试用各种命令在 hadoop 中运行这个 jar

1`hduser@ubuntu:~$ /usr/local/hadoop/bin/hadoop jar Dictionary.jar`

输出：

```
Warning: $HADOOP_HOME is deprecated.

RunJar jarFile [mainClass] args... 
```

2.`hduser@ubuntu:~$ /usr/local/hadoop/bin/hadoop jar Dictionary.jar Dictionary`

输出：

```
Warning: $HADOOP_HOME is deprecated.

Exception in thread "main" java.lang.ClassNotFoundException: Dictionary
at java.net.URLClassLoader$1.run(URLClassLoader.java:366)
at java.net.URLClassLoader$1.run(URLClassLoader.java:355)
at java.security.AccessController.doPrivileged(Native Method)
at java.net.URLClassLoader.findClass(URLClassLoader.java:354)
at java.lang.ClassLoader.loadClass(ClassLoader.java:423)
at java.lang.ClassLoader.loadClass(ClassLoader.java:356)
at java.lang.Class.forName0(Native Method)
at java.lang.Class.forName(Class.java:264)
at org.apache.hadoop.util.RunJar.main(RunJar.java:149) 
```

如何在 hadoop 中运行 jar？根据我的程序的需要，我有正确的 DFS 位置。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-10-23T10:32:31.377

我能够重现您的问题。问题是您在哪里创建 jar。

基本上，您要打包到 jar 中的目录会使 jar 文件在定位主类文件时感到困惑。相反，如果您尝试这样做：

```
/usr/lib/jvm/jdk1.7.0_07/bin/jar cf Dictionary.jar /home/hduser/dir/Dictionary.class 
```

即专门将class文件打包到jar中，然后运行：

```
/usr/local/hadoop/bin/hadoop jar Dictionary.jar Dictionary 
```

只要您的类中有一个名为 Dictionary 的主要功能，它就可以正常工作。

问题是当您将完整目录打包到 jar 中时，jar 还需要了解目录结构以定位类文件。为此，我们需要有一个定义良好的包层次结构来定义类位置。因此，当您打包`/home/hduser/dir/`到 jar 中时，jar 不知道位于该目录结构深处的类文件的位置。为此，您需要`.java`根据目录结构将包名称添加到文件中，例如`home.hduser.dir`，并在运行`hadoop jar`命令时指定具有包结构的类名称，例如`home.hduser.dir.Dictionary`。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-08-10T11:41:46.057

使用以下命令从**CLI**运行 hadoop jar 文件。

```
hadoop jar <jarFileName> <mainClassname> <AnyCommandLineArguements> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-08-11T09:11:46.947

我也遇到了同样的问题，控制台没有显示太多信息，只是

RunJar jarFile [mainClass] 参数...

请检查 jar 中的包文件夹位置，作为一种简单的方法，请尝试以 com.company 开头的包...

“com”文件夹应该是jar解包时的第一级文件夹

# tridion - 图像在演示端没有 得到解决

> ID：13012512
> 
> 赞同：5
> 
> 时间：2012-10-22T13:29:22.170
> 
> 标签：tridion, tridion-2011

我们有一个文件名为“ **Tim%20Butler%20Trading.jpg** ”的图像。此图像在主组件的“图像”字段中作为组件链接链接。在 C# DLL 中，我们读取此“图像”字段并形成图像标记，如下所示：

```
"<img " + style + " src=\"" + imageID + "\" />" 
```

其中 style 是属性名称（如果有），imageID 是多媒体组件的 tcm id。

输出字符串由组件中的图像、标题和其他一些字段值形成。此输出被推送到包中以在 dwt 中访问它。传递给 dwt 的输出字符串的 contentType 是“HTML”。

我们正在使用 DefaultFinishActions 发布图像。此图像作为**Tim%20Butler%20Trading34-13565.jpg**部署在演示服务器上，但在演示端未得到解决。

在页面源图像标签形成如下：

```
<img src="/images/Tim%2520Butler%2520Trading34-13565.jpg"  class="img" /> 
```

我们认为 DWT在发布图像时将图像文件名中的 % 转换为**%** **25**。

有人可以让我知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-22T13:41:56.037

问题出在`%`符号上。当模板看到`%`符号时，它会将其编码为`%25`.

您需要做的就是停止自己编码。如果您的模板将输出`Tim Butler Trading.jpg`，dreamweaver 模板会将空格编码为`%20`并且everyhting 应该可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T11:05:19.727

将图像上传到 Tridion 时，请确保文件名不包含 % 字符。

> Tim%20Butler%20Trading34-13565.jpg

应该

> Tim Butler Trading34-13565.jpg

当您从本地系统将其上传到 Tridion 时。

这是基于您在发布期间没有将 TCMID 添加到文件名的假设（34-13565 部分具有与 TCMURI 相同的数据和几乎相同的格式......）。

# c - 进行矩阵乘法时C中的分段错误

> ID：13012513
> 
> 赞同：1
> 
> 时间：2012-10-22T13:29:35.247
> 
> 标签：c, segmentation-fault, matrix-multiplication, gsl

我使用 gsl 随机生成器生成 2 个大矩阵，并使用 gsl cblas 将它们相乘，但是当 cblas 操作开始时我总是遇到分段错误。当我无法解决这个问题时，我就编写下面的代码，使用非常基本的思想进行矩阵乘法，我仍然得到分段错误，但是当矩阵真的很小时，两者都可以正常工作，我'我对此感到非常困惑。

```
#include <stdlib.h>
#include <stdio.h>
#include <math.h>
#include <time.h>
#define PI 3.1415926

void GenerateKey(int m, int n, int l, int q, float alpha)
{
    // initialization
    int i;
    int j;
    int k;

    float *A;
    float *S;
    float *E;
    float *B;

    float sigma = (alpha * q ) / sqrt(2 * PI);
    A=(float*)malloc(sizeof(float)*(m*n));
    S=(float*)malloc(sizeof(float)*(n*l));
    B=(float*)malloc(sizeof(float)*(m*l));
    E=(float*)malloc(sizeof(float)*(m*l));

    // init A
    for(i = 0; i < m*n; i++)
    {
        A[i]=0;
    }
    printf("\n");

    // init S
    for(i = 0; i < n*l; i++)
    {
        S[i]=0;
    }

    printf("\n");

    // init E
    for(i = 0; i < m*l; i++)
    {
        E[i]=0;
    }

    printf("\n");
    float po;
    for(i = 0; i < m; i++)
    {
        for(j=0; j<l; j++)
        {      
            po=0;
            for(k=0; k<n; k++)
            {
                po +=A[i*m+k]*S[k*n+j];
            }
            po += E[i*m +j];
            B[i*m+j]=((int)po) % q;
        }
    }

    printf("Game over");

    printf("\n");
    free(A);
    free(B);
    free(S);
    free(E);
}

int main()
{
    GenerateKey(2680,191,64,72973,0.000551);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-22T13:35:33.437

当你在做的时候`i*m+j`，不应该是这样`i*l+j`吗？同样的`i*m+k`应该是`i*l+k`和`k*n+j`应该是`k*l+j`

原因是，例如`E = (float*)malloc(sizeof(float)*(m*l))`，所以你有`m`行和`l`列（反之亦然），所以如果你正在迭代`m`维度，你需要将`m`迭代器（`i`在这种情况下）乘以矩阵在该维度中的步幅，这是`l`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-22T13:30:57.897

您不检查`malloc()`返回值，所以我的猜测是一个或多个分配失败并且您正在取消引用`NULL`. 另一种可能性当然是索引错误，因此您访问越界。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-22T13:37:29.460

您错误地计算了所有矩阵的元素索引。

当您有一个`MxN`分配为一维数组的矩阵时，元素的索引`(i,j)`为`i*N+j`. 相反，您将其计算为`i*M+j`.

# android - 画布操作与元素操作

> ID：13012514
> 
> 赞同：5
> 
> 时间：2012-10-22T13:29:44.853
> 
> 标签：android, performance, graphics, android-canvas, scenegraph

我正在开发一个小型库作为某些应用程序的基础。当我即将创建一个场景图（2D）时，我想知道从性能、可维护性、易用性等角度来看，以下哪种方法看起来更有前途。

1.  我可以给每个可绘制元素一个矩阵，我可以在其中执行平移、旋转等操作。
2.  我可以在画布上而不是元素上做所有事情。

第一个解决方案有一个缺点：对于像圆这样的原始元素，我无法在绘图调用中传递矩阵，我必须像这样访问矩阵中的翻译值：

```
private float get(int index) {
    final float[] values = new float[9];
    getValues(values);
    return values[index];
}

public float getX() {
    return get(Matrix.MTRANS_X);
}

public float getY() {
    return get(Matrix.MTRANS_Y);
} 
```

因此，在每次绘制调用中，我为每个 getter 调用创建一个浮点数组（一个用于 getX()，一个用于 getY()）。假设我在屏幕上有很多元素，这可能会导致内存和性能影响。

第二种方法有“消极”思维的缺点。如果我想在点 100/100 绘制一个元素，我必须将画布转换为 -100/-100，就像在 0/0 上绘制一样。如果我在那之后恢复画布，结果将是元素被绘制在想要的 100/100 上。我不确定这种消极的想法是否会对代码的可维护性和理解度造成严重影响（甚至从未开始考虑通过简单地忘记否定某些东西来引入错误......）。

有人有提示应该首选哪种方式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-24T18:11:17.510

似乎确实必须将两种解决方案结合起来。

我对第二种方法的假设是完全错误的。如果我将一个元素转换为 100/100，则原点将更改为 100/100。当然，这同样适用于画布。消极的想法对我来说完全是胡说八道。

合并后的结果如下：

1.  每个将被绘制的元素都有自己的矩阵，其中包含旋转、平移和缩放。
2.  画布将通过 保存`save()`，使用提供的方法`concat(Matrix matrix)`可以应用元素的矩阵。绘图将完成，画布将恢复`restore()`。
3.  每个作为其他可绘制元素的父元素的可绘制元素将循环遍历子元素并以相同的方式保存、连接和恢复。

这使得 2D 场景图的实现无需任何大的实现工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T19:59:59.660

出于性能原因，使用内部矩阵方法可能更快，因为它允许库自动进行硬件加速，如果您正在这样做的话。再说一次，我不完全确定它是否会被硬件加速。

＃2是有趣的方式。从长远来看，它肯定会给你更多的力量和灵活性。此外，您也许可以将两者结合起来。

还有#3：当你说drawable元素时，如果你使用Android Drawables，你可以创建一个自定义的Drawable类。

我认为没有完美的方法可以做到这一点

# cuda - c opengl：我可以在gpu中计算法线吗？(CUDA)

> ID：13012518
> 
> 赞同：1
> 
> 时间：2012-10-22T13:29:58.193
> 
> 标签：cuda, gpu, indices, normals

我正在尝试访问内核内的最后一个和下一个索引坐标。

例如：int idx = blockIdx.x * blockDim.x + threadIdx.x；

那么 pos[idx].x, pos[idx].y, pos[idx].z 将给出一个点的当前坐标。但无法访问其他两个。我正在尝试使用 CUDA 计算 GPU 级别中不断变化的三角形的法线。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T15:10:09.320

你仍然可以做 idx+1, idx+2，GPU 可以访问所有的共享内存

为了获得最佳效率，您必须小心地将作业划分为块/线程等，以便附近点的内存位于同一核心上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-15T23:25:21.760

在 GPU 上计算法线的难易程度取决于网格拓扑。

**使用三角形列表拓扑**计算网格的法线很容易：每个三角形使用一个 GPU 线程。这会导致高度规则的读取和写入，并且适用于 CUDA 中任何有效的块和线程配置。不幸的是，三角形列表拓扑不是很有用（对于初学者来说，除非采用一些额外的处理，否则它将是平面阴影）。

计算具有**三角形条形拓扑**（常用）的网格的法线要困难得多。问题是顶点用于多个三角形，因此您必须通过组合多个三角形法线来为每个顶点法线累积一个 [加权] 平均值。**每个三角形**使用一个 GPU 线程意味着多个垂直规范将“同时”受到多个 GPU 线程的影响。或者，**每个顶点使用一个 GPU 线程**意味着需要引用该顶点的三角形列表，然后需要读取三角形（附加顶点对），以便可以计算顶点范数......这很困难，但并非不可能。

最后，如果您的模型使用索引顶点，这将施加额外的 [半随机] 查找，这可能会导致问题。这个问题可以通过空间分区来解决。

# android - 如何创建类似布局的菜单栏？

> ID：13012522
> 
> 赞同：1
> 
> 时间：2012-10-22T13:30:11.437
> 
> 标签：android, layout, menu, menubar

在我的一项活动中，我想要一个类似“菜单栏”的东西，在纵向模式下位于屏幕底部，在横向模式下位于屏幕右侧。

菜单栏是永久可见的，并且将容纳具有相同高度但可能具有不同宽度的图像按钮。根据“菜单栏”中“按钮”的数量选择适当的填充，以便正确使用可用的高度或宽度。基本上它应该是这样的：

![肖像](../Images/9152b35da953f00cf656c6f7498f3a7f.png) ![景观](../Images/f9cbf461c469df5fc13ca73df2c08a88.png)

[正如这里](https://stackoverflow.com/questions/10855148/how-to-create-bottom-menu-like-gmail-android)所建议的，我已经考虑过使用“拆分操作栏” 。但在这种情况下，我只有在纵向模式下才有想要的效果。

目前我考虑实现一个自定义的gridview布局来获得这个效果，或者修改在[这里](https://stackoverflow.com/questions/2873568/android-dashboard-pattern)找到的仪表板模式。

也许你们中的一些人已经实现了“菜单栏式布局”之类的东西，可以为我指明正确的方向。

**编辑**

我稍微修改了上面提到的仪表板模式代码，这只是概念的第一个证明，但似乎符合我的意图：

```
public class Nx1Layout extends ViewGroup {

private static final String TAG = "Nx1Layout";
private int mMaxChildWidth = 0;
private int mMaxChildHeight = 0;
private int mScreenOrientation = Configuration.ORIENTATION_PORTRAIT;

public Nx1Layout(Context context) {
    super(context, null);
}

public Nx1Layout(Context context, AttributeSet attrs) {
    super(context, attrs, 0);
}

public Nx1Layout(Context context, AttributeSet attrs, int defStyle) {
    super(context, attrs, defStyle);
}

public void setScreenOrientation(int screenOrientation) {
    mScreenOrientation = screenOrientation;
}

@Override
protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
    mMaxChildWidth = 0;
    mMaxChildHeight = 0;

    // Measure once to find the maximum child size.
    int childWidthMeasureSpec = MeasureSpec.makeMeasureSpec(MeasureSpec.getSize(widthMeasureSpec), MeasureSpec.AT_MOST);
    int childHeightMeasureSpec = MeasureSpec.makeMeasureSpec(MeasureSpec.getSize(heightMeasureSpec), MeasureSpec.AT_MOST);
    final int count = getChildCount();
    for (int i = 0; i < count; i++) {
        final View child = getChildAt(i);
        if (child.getVisibility() == GONE) {
            continue;
        }

        child.measure(childWidthMeasureSpec, childHeightMeasureSpec);

        mMaxChildWidth = Math.max(mMaxChildWidth, child.getMeasuredWidth());
        mMaxChildHeight = Math.max(mMaxChildHeight, child.getMeasuredHeight());
    }

    // Measure again for each child to be exactly the same size.
    childWidthMeasureSpec = MeasureSpec.makeMeasureSpec(mMaxChildWidth, MeasureSpec.EXACTLY);
    childHeightMeasureSpec = MeasureSpec.makeMeasureSpec(mMaxChildHeight, MeasureSpec.EXACTLY);
    for (int i = 0; i < count; i++) {
        final View child = getChildAt(i);
        if (child.getVisibility() == GONE) {
            continue;
        }

        child.measure(childWidthMeasureSpec, childHeightMeasureSpec);
    }
    setMeasuredDimension(resolveSize(mMaxChildWidth, widthMeasureSpec),resolveSize(mMaxChildHeight, heightMeasureSpec));
}

@Override
protected void onLayout(boolean changed, int l, int t, int r, int b) {
    int width = r - l;
    int height = b - t;

    final int count = getChildCount();

    // Calculate the number of visible children.
    int visibleCount = 0;
    for (int i = 0; i < count; i++) {
        final View child = getChildAt(i);
        if (child.getVisibility() == GONE) {
            continue;
        }
        ++visibleCount;
    }

    if (visibleCount == 0) {
        return;
    }

    // Horizontal and vertical space between items
    int hSpace = 0;
    int vSpace = 0;

    int cols, rows;

    if(mScreenOrientation == Configuration.ORIENTATION_PORTRAIT) {
        cols = visibleCount;
        rows = 1;
    } else {
        cols = 1;
        rows = visibleCount;
    }

    hSpace = ((width - mMaxChildWidth * cols) / (cols + 1));
    vSpace = ((height - mMaxChildHeight * rows) / (rows + 1));

    // Lay out children based on calculated best-fit number of rows and cols.
    // If we chose a layout that has negative horizontal or vertical space, force it to zero.
    hSpace = Math.max(0, hSpace);
    vSpace = Math.max(0, vSpace);

    // Re-use width/height variables to be child width/height.
    width = (width - hSpace * (cols + 1)) / cols;
    height = (height - vSpace * (rows + 1)) / rows;

    int left, top;
    int col, row;
    int visibleIndex = 0;
    for (int i = 0; i < count; i++) {
        final View child = getChildAt(i);
        if (child.getVisibility() == GONE) {
            continue;
        }

        row = visibleIndex / cols;
        col = visibleIndex % cols;

        left = hSpace * (col + 1) + width * col;
        top = vSpace * (row + 1) + height * row;

        child.layout(left, top, (hSpace == 0 && col == cols - 1) ? r : (left + width), (vSpace == 0 && row == rows - 1) ? b : (top + height));
        ++visibleIndex;
    }
}
} 
```

这是一些测试它的活动代码：

```
public class TestActivity extends SherlockFragmentActivity {

 @Override
 public void onCreate(Bundle savedInstanceState) {
     // setup ui
     super.onCreate(savedInstanceState);
     setContentView(R.layout.ui_test);

     Nx1Layout layout = (Nx1Layout)findViewById(R.id.layout1);
     layout.setScreenOrientation(getScreenOrientation());
 }

 public int getScreenOrientation()
 {
     Display getOrient = getWindowManager().getDefaultDisplay();
     int orientation = Configuration.ORIENTATION_UNDEFINED;
     if(getOrient.getWidth() == getOrient.getHeight()){
         orientation = Configuration.ORIENTATION_SQUARE;
     } else{ 
         if(getOrient.getWidth() < getOrient.getHeight()){
             orientation = Configuration.ORIENTATION_PORTRAIT;
         }else { 
              orientation = Configuration.ORIENTATION_LANDSCAPE;
         }
     }
     return orientation;
 }} 
```

这是纵向模式的布局文件：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >
   <com.yourpackagename.Nx1Layout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="70dp"
    android:id="@+id/layout1">

                <ImageView
                    android:id="@+id/image1"
                    android:layout_width="70dp"
                    android:layout_height="70dp"
                    android:contentDescription="some description"
                    android:scaleType="centerInside"
                    android:padding="2dp"
                    android:src="@drawable/test_draw" />

                <ImageView
                    android:id="@+id/image2"
                    android:layout_width="70dp"
                    android:layout_height="70dp"
                    android:contentDescription="some description"
                    android:scaleType="centerInside"
                    android:padding="2dp"
                    android:src="@drawable/test_draw" />

                <ImageView
                    android:id="@+id/image3"
                    android:layout_width="70dp"
                    android:layout_height="70dp"
                    android:contentDescription="some description"
                    android:scaleType="centerInside"
                    android:padding="2dp"
                    android:src="@drawable/test_draw" />

    </com.yourpackagename.Nx1Layout>
</LinearLayout> 
```

这里是横向模式的布局文件：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >
   <com.yourpackagename.Nx1Layout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="70dp"
    android:layout_height="match_parent"
    android:id="@+id/layout1">

                <ImageView
                    android:id="@+id/image1"
                    android:layout_width="70dp"
                    android:layout_height="70dp"
                    android:contentDescription="some description"
                    android:scaleType="centerInside"
                    android:padding="2dp"
                    android:src="@drawable/test_draw" />

                <ImageView
                    android:id="@+id/image2"
                    android:layout_width="70dp"
                    android:layout_height="70dp"
                    android:contentDescription="some description"
                    android:scaleType="centerInside"
                    android:padding="2dp"
                    android:src="@drawable/test_draw_narrow" />

                <ImageView
                    android:id="@+id/image3"
                    android:layout_width="70dp"
                    android:layout_height="70dp"
                    android:contentDescription="some description"
                    android:scaleType="centerInside"
                    android:padding="2dp"
                    android:src="@drawable/test_draw" />
    </com.yourpackagename.Nx1Layout>
</LinearLayout> 
```

最后但并非最不重要的一些我使用的drawable：

![测试抽签](../Images/b4d0f09995e6ce05122c5bb883a7a0ed.png)

随意评论这个解决方案......

# windows-phone-7 - 在 windows phone 7 上自定义列表框中的特定项目

> ID：13012523
> 
> 赞同：1
> 
> 时间：2012-10-22T13:30:20.953
> 
> 标签：windows-phone-7, xaml, listbox

我正在使用具有自定义 ItemTemplate 样式的列表框。它基本上为列表框中的每个项目附加一个按钮。我想在没有按钮的情况下显示列表框中的最后一项。我怎样才能完成它？

.xaml 文件代码如下。

```
 <!-- ListBox to display recordings -->
        <ListBox Name="myListBox" Grid.Row="0"                     
                 HorizontalAlignment="Left" Width="470"
                 ScrollViewer.VerticalScrollBarVisibility="Visible"  
                 ScrollViewer.ManipulationMode="System"
                 SelectionChanged="OnMemosListBoxSelectionChanged">
            <ListBox.ItemTemplate>

                <DataTemplate>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>

                        <Grid.RowDefinitions>
                            <RowDefinition Height="*" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>

                        <Button Grid.Column="0"
                                Grid.Row="0"
                                Grid.RowSpan="3"
                                Padding="0"
                                HorizontalAlignment="Left"
                                VerticalAlignment="top"
                                Height="80"
                                Width="80"
                                Tag="{Binding BindsDirectlyToSource=True}"
                                Click="OnDeleteButtonClick">                                    
                            <Button.Content>
                                <Image Source="/images/delete.png" Margin="0" Width="50" Height="50" />
                            </Button.Content>
                        </Button>

                        <TextBlock Grid.Column="1" 
                                   FontSize="{StaticResource PhoneFontSizeMediumLarge}"
                                   Grid.Row="0"
                                   Text="{Binding fileName}"
                                   VerticalAlignment="Center"/>

                        <StackPanel Grid.Column="1" Margin="0,0,0,17"
                                    Grid.Row="1" Height="50" 
                                    Orientation="Horizontal"
                                    VerticalAlignment="Top">

                            <TextBlock FontSize="{StaticResource PhoneFontSizeNormal}" Text="Recorded on " />
                            <TextBlock FontSize="{StaticResource PhoneFontSizeNormal}" Text="{Binding crDate}" />
                            <TextBlock Text="   Duration " />
                            <TextBlock FontSize="{StaticResource PhoneFontSizeNormal}"  Text="{Binding duration}" />
                        </StackPanel>
                    </Grid>
                </DataTemplate>
            </ListBox.ItemTemplate>                
        </ListBox> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T14:38:39.847

为所有项目添加一个属性，例如 ShowButton，将集合中的最后一个项目设置为 false（所有其他项目为 true），然后在 DataTemplate 中仅在属性为 true 时显示按钮

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T01:37:50.627

我不知道为什么列表的最后一项不需要那个按钮，但我建议你，你可以使用 longlistselector 的 ListFooterTemplate。

使页脚项目独立。

# maven - Maven 建模符号

> ID：13012528
> 
> 赞同：1
> 
> 时间：2012-10-22T13:30:55.620
> 
> 标签：maven, modeling, diagramming

是否有一个普遍接受的符号来表示 Maven 项目的依赖关系、继承和模块聚合？

我没有花很多时间去看，但没有什么东西立刻跳出来。

我已经看到了 Sonatype 的完整参考中使用的符号[（例如图 3.5。企业多模块与继承）](http://www.sonatype.com/books/mvnref-book/reference/pom-relationships-sect-pom-best-practice.html#fig-multi-module)，但更喜欢不依赖颜色来传达语义的东西。

我一直在使用类似 UML 的语法，它显示了一个项目“聚合”（菱形符号）在它的`<modules>`部分中列出的项目、父子关系的 UML 继承和带有箭头的虚线以显示依赖关系。

那里有更好的想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T18:06:55.300

对于依赖关系图，约定是使用`dependency:tree`

IE

```
[user:maven-test]$ mvn dependency:tree
[INFO] Scanning for projects...
[INFO]                                                                         
[INFO] ------------------------------------------------------------------------
[INFO] Building maven-test 1.0
[INFO] ------------------------------------------------------------------------
[INFO] 
[INFO] --- maven-dependency-plugin:2.1:tree (default-cli) @ maven-test ---
[INFO] maven-test:maven-test:jar:1.0
[INFO] +- junit:junit:jar:3.8.1:test
[INFO] +- com.sun.jersey:jersey-json:jar:1.9.1:compile
[INFO] |  +- org.codehaus.jettison:jettison:jar:1.1:compile
[INFO] |  |  \- stax:stax-api:jar:1.0.1:compile
[INFO] |  +- com.sun.xml.bind:jaxb-impl:jar:2.2.3-1:compile
[INFO] |  |  \- javax.xml.bind:jaxb-api:jar:2.2.2:compile
[INFO] |  |     +- javax.xml.stream:stax-api:jar:1.0-2:compile
[INFO] |  |     \- javax.activation:activation:jar:1.1:compile
[INFO] |  +- org.codehaus.jackson:jackson-core-asl:jar:1.8.3:compile
[INFO] |  +- org.codehaus.jackson:jackson-mapper-asl:jar:1.8.3:compile
[INFO] |  +- org.codehaus.jackson:jackson-jaxrs:jar:1.8.3:compile
[INFO] |  +- org.codehaus.jackson:jackson-xc:jar:1.8.3:compile
[INFO] |  \- com.sun.jersey:jersey-core:jar:1.9.1:compile
[INFO] +- com.sun.jersey:jersey-server:jar:1.14:compile
[INFO] |  \- asm:asm:jar:3.1:compile
[INFO] \- com.sun.jersey:jersey-client:jar:1.14:compile
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------ 
```

事实证明，这个插件[可以输出到可视化图表](http://www.summa-tech.com/blog/2011/04/12/a-visual-maven-dependency-tree-view/)。

请参阅：[Maven 依赖插件 - 输出类型](http://maven.apache.org/plugins/maven-dependency-plugin/tree-mojo.html#outputType)。

如果您使用的是 IntelliJ IDEA，[它还有一个内置的 Maven 依赖关系图](http://blogs.jetbrains.com/idea/2010/05/maven-dependencies-diagram/)。

# java - 是否有任何 API 可用于拨打电话？

> ID：13012530
> 
> 赞同：0
> 
> 时间：2012-10-22T13:31:00.990
> 
> 标签：java, android, web-applications

我需要为 android 手机创建一个应用程序，以便在有/没有用户交互的情况下拨打电话。我从 net 和 Stack Overflow（[如何在不使用意图的情况下拨打电话](https://stackoverflow.com/questions/13010135/how-to-make-a-call-without-using-intent)）中了解到这是无法完成的。

但现在，我想知道是否有一些 API 可用于开发网站，我将从 Android 手机启动，然后 Web 服务将进行调用。

我没有网络开发背景。所以，我想确认这可能吗？即这是否有可能我提供网站电话号码并且它拨打电话并且账单转到提供的号码（就像从他/她的电话拨打电话并且账单转到他/她的号码一样。但现在我不想要Android的应用程序进行调用。我想要我自己的Web应用程序或一些Java应用程序进行调用），我不想使用其他服务提供商。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-22T13:36:02.693

如果您的服务将成为您应用程序的一部分，那么您将使其变得比需要的复杂得多。由于您有一个从 RESTful Web 服务获取数据的简单用例，因此您应该研究 ResultReceiver 和 IntentService。

当您想要执行某些操作时，此 Service + ResultReceiver 模式通过使用 startService() 启动或绑定到服务来工作。您可以指定要执行的操作，并通过 Intent 中的 extras 传入您的 ResultReceiver（活动）。

在服务中，您实现 onHandleIntent 以执行 Intent 中指定的操作。操作完成后，您使用传入的 ResultReceiver 将消息发送回 Activity，此时将调用 onReceiveResult。

例如，您想从 Web 服务中提取一些数据。

**-**您创建意图并调用 startService。

**-** 服务中的操作开始，它向活动发送一条消息，说明它已开始

**-**活动处理消息并显示进度。

**-**服务完成操作并将一些数据发送回您的活动。

**-**您的活动处理数据并放入列表视图

**-**该服务会向您发送一条消息，说它已完成，它会杀死自己。

**-**活动收到完成消息并隐藏进度对话框。

**例如：**

**活动：**

```
public class HomeActivity extends Activity implements MyResultReceiver.Receiver {

    public MyResultReceiver mReceiver;

    public void onCreate(Bundle savedInstanceState) {
        mReceiver = new MyResultReceiver(new Handler());
        mReceiver.setReceiver(this);
        ...
        final Intent intent = new Intent(Intent.ACTION_SYNC, null, this, QueryService.class);
        intent.putExtra("receiver", mReceiver);
        intent.putExtra("command", "query");
        startService(intent);
    }

    public void onPause() {
        mReceiver.setReceiver(null); // clear receiver so no leaks.
    }

    public void onReceiveResult(int resultCode, Bundle resultData) {
        switch (resultCode) {
        case RUNNING:
            //show progress
            break;
        case FINISHED:
            List results = resultData.getParcelableList("results");
            // do something interesting
            // hide progress
            break;
        case ERROR:
            // handle the error;
            break;
    }
} 
```

**服务：**

```
public class QueryService extends IntentService {
    protected void onHandleIntent(Intent intent) {
        final ResultReceiver receiver = intent.getParcelableExtra("receiver");
        String command = intent.getStringExtra("command");
        Bundle b = new Bundle();
        if(command.equals("query") {
            receiver.send(STATUS_RUNNING, Bundle.EMPTY);
            try {
                // get some data or something           
                b.putParcelableArrayList("results", results);
                receiver.send(STATUS_FINISHED, b)
            } catch(Exception e) {
                b.putString(Intent.EXTRA_TEXT, e.toString());
                receiver.send(STATUS_ERROR, b);
            }    
        }
        this.stopSelf();
    }
} 
```

**结果接收者：**

```
public MyResultReceiver extends ResultReceiver {
    private Receiver mReceiver;

    public MyResultReceiver(Handler handler) {
        super(handler);
    }

    public void setReceiver(Receiver receiver) {
        mReceiver = receiver;
    }

    public interface Receiver {
        public void onReceiveResult(int resultCode, Bundle resultData);
    }

    @Override
    protected void onReceiveResult(int resultCode, Bundle resultData) {
        if (mReceiver != null) {
            mReceiver.onReceiveResult(resultCode, resultData);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T06:12:31.877

试试[http://phono.com/](http://phono.com/)。它提供了各种电话 API。

# c# - 验证是否安装了 Visual C++ 2008 SP1 Redistributable Package 而无需在 Windows 注册表中搜索？

> ID：13012538
> 
> 赞同：2
> 
> 时间：2012-10-22T13:31:24.887
> 
> 标签：c#, .net, windows

有没有办法知道 Visual C++ 2008 和 2010 SP1 Redistributable Package 是否安装在使用 C# 的机器上。

非常感谢，克里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T15:41:57.260

您可以查看注册表。（要查看的注册表项） [http://blogs.msdn.com/b/astebner/archive/2010/05/05/10008146.aspx](http://blogs.msdn.com/b/astebner/archive/2010/05/05/10008146.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-11-30T18:25:28.903

似乎在 vcredist 2010 SP1 安装期间，不再创建 Soreceri 帖子中的密钥（至少在我运行 Windows 10 x64 的测试 PC 上）。我能够在以下位置找到钥匙：

[HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Microsoft\VisualStudio\10.0\VC\VCRedist\x86]

如果安装了“Installed=1”REG_DWORD，它将出现。

希望这对某人有所帮助，我在任何地方都找不到。

# objective-c - UIButton 设置特定边的边框

> ID：13012541
> 
> 赞同：0
> 
> 时间：2012-10-22T13:31:29.173
> 
> 标签：objective-c, cocoa-touch

有没有办法将 UIButton 的边框宽度设置为不同的值，类似于 CSS like `border-width: 0 1px 0 0`or `border-right-width: 1px`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T14:29:20.823

没有标准`UIButton`，没有。您必须使用自定义按钮并创建与您想要的设计相匹配的图像。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-22T14:31:47.273

不，不可能使用 API

# cakephp - CAKEPHP 将元素添加到主页需要不正确的 URL

> ID：13012543
> 
> 赞同：0
> 
> 时间：2012-10-22T13:31:31.130
> 
> 标签：cakephp

我有一个 POST 模型和一个 COMMENT 模型。在我的 Comments 元素中，我正在从 URL 检索 POST_ID，这工作正常。

现在我在主页上调用 POST 和 COMMENT 元素，但是当我添加评论时，它不会从 URL 中获取 id，因为 URL 现在是 /home 而不是 /post/view/id。

我该如何解决这个问题？

这就是我从 URL 中检索 ID 的方式

```
$id = $this->request['pass'][0];
echo $this->form->input('note_id', array('type'=>'hidden', 'value'=>$id)); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T12:11:33.483

当您显示帖子和评论时，您可能有类似的数组`$posts['Post']`，`$comments['Comment']`因此对于获取 post_id，您可能可以使用`$posts['Post']['id']`

你可以设置的id

```
echo $this->form->input('note_id', array('type'=>'hidden', 'value'=>$posts['Post']['id'])); 
```

# c# - 如何在 Linq 中执行嵌套查询

> ID：13012545
> 
> 赞同：0
> 
> 时间：2012-10-22T13:31:35.540
> 
> 标签：c#, sql, linq, entity-framework, linq-to-sql

我在 C# 中有一个这种格式的 LINQ 类：

```
class Vehicle
{
  int _VehicleID
  int _ModelID

  EntetySet<Cars> _AllCars
  EntetySet<Bus> _AllBus
  EntetyRef<Driver> _Person
} 
```

**汽车表**

```
CarsID | Manufacturer | Type
1000   | Honda        | Diesel
1001   | Mitsubishi   | Petrol
1002   | Maruti       | Diesel 
```

**总线表**

```
BusID | Manufacturer | Type
2000  | Volvo        | Diesel
2001  | TATA         | Petrol
2002  | layland      | Petrol 
```

从 UI 中，我将获取车辆 ID 作为参数。基于此，所有的汽车、巴士及其关联的表都将被复制到一个变量中。那是：

```
Vehicle v1 = new Vehicle();
v1 = dc.vehicle.where(v => v.vehicleID == param.vehicleID).findfirst(); 
```

我`v1`拥有满足上述条件的所有表格及其内容。

现在，我想根据桌面汽车和公共汽车中存在的表格内容进行更多过滤；即基于车辆汽油或柴油的类型。

如果我想在一行中使用查询语句复制所有汽油车和公共汽车，请告诉我方法。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-22T14:19:31.183

**根据评论编辑**

你问题的逻辑不知何故被我忽略了，因为我在车辆上采取了合乎逻辑的人类方法。每当我看到这个时，`Vehicle class`我都会立即将汽车和公共汽车视为交通工具。这更多地表明命名选择不当。但不再以我为判断。

我知道您想要一辆车的 ID，并且您希望结果仅包含乘坐汽油的汽车和公共汽车，例如汽油，在一条线上。如果它被翻译成 SQL，我不知道树在选择中可以走多远，但如果它在内存中，那么你可以在子选择中走很长的路。

您可以使用“模型”类来实现这一点，也可以使用匿名类型，但我将举一个“模型”类的示例：

例子：

```
public class VehicleModel
{
    public int VehicleID { get; set; }
    public int ModelID { get; set; }
    public List<Cars> Cars { get; set; }
    public List<Bus> Buses { get; set; }
}

var vehicleID = 1; // just for the example of course.
var fuelType = "Petrol";
var vehicle = (from v in dc.vehicle 
               where v._VehicleID == vehicleID
               select new VehicleModel
               {
                   VehicleID = v._VehicleID,
                   ModelID = v._ModelID,
                   Cars = v._AllCars.Where(car => car.Type == fuelType).ToList(),
                   Buses = v._AllBus.Where(bus => bus.Type == fuelType).ToList()
               }).SingleOrDefault();
               // use FirstOrDefault() when _VehicleID is NOT unique to get TOP 1 
```

不要在 Entity 本身中修改 EntitySets，始终使用模型来处理这些事情，因为如果你这样做并在 EntityContainer 上调用 save changes ，各种事情都可能出错。

如果您想了解匿名类型，请查看此处：http: [//msdn.microsoft.com/en-us/library/bb397696 (v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/bb397696(v=vs.100).aspx)

还可以在这里查看 Linq 示例： [http ://code.msdn.microsoft.com/101-LINQ-Samples-3fb9811b](http://code.msdn.microsoft.com/101-LINQ-Samples-3fb9811b)

- 编辑前

你是这个意思吗：

```
var query = dc.vehicle.Where(v => 
                             v._AllCars.Any(c => c.Manufacturer == "Honda") ||
                             v._AllBuss.Any(b => b.Manufacturer == "Volvo")); 
```

这将为您提供所有车辆是本田或公共汽车是沃尔沃的车辆。这将是：

1000 | 本田 | 柴油机
2000 | 沃尔沃 | 柴油机

结果是一个 IEnumerable，包含所有或不包含满足条件的项目。

如果你只想要第一次命中，你可以这样做：

```
//if it must exist, otherwise this throws an exception
var firstVehicle = query.First();
//if it may exist, otherwise null
var firstVehicle = query.FirstOrDefault(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-22T14:17:07.227

看来你想要这样的东西：

```
var v1 = dc.vehicle.Where(v => v.vehicleID == param.vehicleID
                            && v.Cars.All(c => c.Type == "Petrol")
                            && v.Buses.All(c => c.Type == "Petrol")).First(); 
```

)

获得所有汽车和公共汽车都有汽油的“车辆”。（请注意，我使用“Cars”而不是非常规名称“_AllCars”等）。

**编辑**

或者：

```
var v1 = dc.vehicle.Where(v => v.vehicleID == param.vehicleID)
    .Select(v => new {
                        Id = v.vehicleID,
                        Cars = v.Cars.Where(c => c.Type == "Petrol"),
                        Buses = v.Buses.Where(c => c.Type == "Petrol")
                     }).First(); 
```

获取带有过滤集合的匿名类型。

# java - HashMap，有问题

> ID：13012547
> 
> 赞同：0
> 
> 时间：2012-10-22T13:31:41.843
> 
> 标签：java, hashmap

我有一个HashMap：

```
public static HashMap<Long, KeepAliveTimer> kaTimer; 
```

它存储一个 MACAddress 和一个 Timer。

我创建了 HashMap：

```
 if(kaTimer == null) {
        //init the Hash
        kaTimer = new HashMap<Long, keepAliveTimer>();
        KeepAliveTimer keepAliveTimer = new KeepAliveTimer(macaddress, ipaddress); 
        kaTimer.put(macaddress, keepAliveTimer);
    } else {
                    //The Hash exists
        if(kaTimer.containsKey(macaddress)) {
            //The MAC exists into the map
            System.out.println(kaTimer.size());
            Collection col = kaTimer.values();
            for (Object obj : col) {
                      System.out.println(obj);
            }

            System.out.println(String.valueOf(macddress));

            KeepAliveTimer keepAliveTimer = kaTimer.get(macaddress);
            keepAliveTimer.update();
        } else {
            //The MAC doesn't exist in the Hash
            KeepAliveTimer keepAliveTimer = new KeepAliveTimer(macddress, ipaddress); 
            kaTimer.put(macaddress, keepAliveTimer);
        }

    } 
```

KeepAlive定时器：

```
public KeepAliveTimer(long mac, String ipAddress){
    this.macaddress = mac;
    this.ip = ipAddress;

    timer = new Timer();

    TimerTask timerTask = new TimerTask() {

        @Override
        public void run() {
            timerFinished();

        }
    };
    log.info(String.valueOf(macaddress) + " con la ip " + ip);
    timer.schedule(timerTask, 3*60*1000);
}

public void update() {

    TimerTask timerTask = new TimerTask() {

        @Override
        public void run() {
            timerFinished();

        }
    };
    log.info(String.valueOf(macaddress) + " con la ip " + ip);
    timer.cancel();
    timer.purge();
    timer = new Timer();
    timer.schedule(timerTask, 3*60*1000);
}

public void timerFinished() {

    KeepAlive keep = new KeepAlive(macddress, ip);
    keep.removeFromHash();
     //Actions
} 
```

创建 KeepAliveTimer 元素后一切正常，我创建了 2 个 KeepAliveTimer 元素：

```
 KeepAliveTimer keepAliveTimer = new KeepAliveTimer(macddress, ipaddress); 
 kaTimer.put(macaddress, keepAliveTimer); 
```

当所有这些都被创建后，我必须使用 KeepAliveTimer 元素，因此，我从哈希中提取它们：

```
 KeepAliveTimer keepAliveTimer = kaTimer.get(macaddress);
 keepAliveTimer.update(); 
```

每个元素都是用一个 mac 和一个 ip 创建的，但是在提取最后一个创建的 ip 时总是使用

我添加了以下几行：

```
System.out.println(kaTimer.size());
Collection col = kaTimer.values();
for (Object obj : col) {
    System.out.println(obj);
}

System.out.println(String.valueOf(macddress)); 
```

我得到：

```
//First element
//In the HashMap
spb.KeepAliveTimer@105bd58
spb.KeepAliveTimer@edf3f6
//MAC
26954208388119
//KeepAliveTimer I get
spb.KeepAliveTimer@edf3f6
//MAC + IP
INFO: 26954208388119 con la ip 178.139.7.27

//Second element
//In the HasMaP
spb.KeepAliveTimer@105bd58
spb.KeepAliveTimer@edf3f6
//MAC
26954208388118
//Timer I get
spb.KeepAliveTimer@105bd58
//MAC+IP
INFO:  26954208388118 con la ip 178.139.7.27 
```

# c# - C# 是否为未使用的模板参数生成具体实现？

> ID：13012548
> 
> 赞同：2
> 
> 时间：2012-10-22T13:31:44.343
> 
> 标签：c#, generics, inheritance, static

如果我有

```
abstract class Base<TSub>
{
    protected static List<TSub> MyStaticList;
}

class DerivedA : Base<DerivedA>
{
}

class DerivedB : Base<DerivedB>
{

} 
```

我得到两个独立的 MyStaticList 变量，每个基类一个。如果相反，基地看起来像这样

```
class Base<TSub>
{
    protected static List<string> MyStaticList;
} 
```

即，没有使用模板参数，我是否保证仍然获得两个独立的 MyStaticList 变量？

`availableValues()`（对于自定义的类 Enum 类层次结构的方法，我需要这个。）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-22T13:36:04.270

具有不同类型参数的泛型类的两个实例化将产生两个独立的类，每个类都有自己的一组静态变量。所以答案是肯定的，静态变量`Base<ClassA>.MyStaticList`和`Base<ClassB>.MyStaticList`将是独立的。

如果您想要相反的行为（即所有泛型类共享相同的静态变量）将变量声明移动到非泛型类中，并使其成为泛型的基类，如下所示：

```
public class BaseOfGeneric {
    protected static List<string> MyStaticList;
}
abstract class Base<TSub> : BaseOfGeneric 
{
    ...
} 
```

现在所有实例都`Base<T>`将共享相同的`MyStaticList`，而不管它们的类型参数如何。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-22T13:35:40.053

[http://blogs.msdn.com/b/gusperez/archive/2005/08/09/449363.aspx](http://blogs.msdn.com/b/gusperez/archive/2005/08/09/449363.aspx)

> 泛型类声明中的静态变量在同一封闭构造类型（第 26.5.2 节）的所有实例之间共享，但在不同封闭构造类型的实例之间不共享。无论静态变量的类型是否涉及任何类型参数，这些规则都适用。

**编辑**[在 C# 中的通用列表和静态变量行为](https://stackoverflow.com/questions/4327332/generic-list-and-static-variable-behaviour-in-c-sharp) 之前提出了一个非常相似的问题

您必须使用完全静态的构造才能在泛型类中使用。也许像...

```
protected static List<TSub> MyStaticList = BaseUtil.MyStaticList 
```

# python-2.7 - 来自 python 文档中关于 try except

> ID：13012554
> 
> 赞同：3
> 
> 时间：2012-10-22T13:32:23.713
> 
> 标签：python-2.7

我在这里阅读[python 教程](http://docs.python.org/tutorial/errors.html#handling-exceptions)，但有一件事我不太明白。从文档：

```
for arg in sys.argv[1:]:
    try:
        f = open(arg, 'r')
    except IOError:
        print 'cannot open', arg
    else:
        print arg, 'has', len(f.readlines()), 'lines'
        f.close() 
```

从文档中的解释：

*使用 else 子句比在 try 子句中添加额外的代码要好，因为它可以避免意外捕获不是由 try ... except 语句保护的代码引发的异常。*

我的问题是它如何防止意外捕获此 try 块中未引发的异常。我不明白他们的意思。谁能举个例子？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-22T13:34:23.873

您可以尝试的一种可能的替代方法是：

```
for arg in sys.argv[1:]:
    try:
        f = open(arg, 'r')
        print arg, 'has', len(f.readlines()), 'lines'
        f.close()
    except IOError:
        print 'cannot open', arg 
```

`f.readlines()`如果在此期间或期间发生异常，`f.close()`它将被`except`块捕获，您将收到错误消息`'cannot open'`。

# excel-2007 - ssas上的透视报告excel 2007

> ID：13012566
> 
> 赞同：1
> 
> 时间：2012-10-22T13:33:03.170
> 
> 标签：excel-2007, pivot-table, ssas-2008

我对此很陌生。我在 ssas 上构建了一个数据透视报告（excel 2007）。它有数据、行、列。列有层次结构，如日月。现在我想将此报告发送给客户，以便他可以自己查看并根据需要扩展层次结构。但他只能看到我保存报告的内容。例如，我将其保存为月份层次结构，他只能看到每月的数字，而不能将层次结构扩展到一天。我应该怎么办？客户无权访问 ssas 数据源。

谢谢 N.Z

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T09:41:38.757

数据透视报告需要某种数据源。

无论是 Excel 工作表的单元格值还是与 SSAS 多维数据集的连接，都可以，但为了进行钻取操作，必须使用数据源。

有多种解决方法：

1.  将您希望用户查看的所有聚合数据导出到一个新的电子表格，并基于该工作表制作一个简单的数据透视表。
2.  在 SSAS 中设置一个角色，并为您的用户授予您希望他对数据拥有的特定权限。这需要一些 MDX 知识，但简单的东西是自动配置的。然后，您可以让您的用户访问 Excel 中的数据源。
3.  设置作为 BI 一部分的 sharepoint 安装（这有点矫枉过正），并使用 PerformancePoint Services 为您的用户提供报告仪表板。

我真的不认为没有数据（数据源）就可以浏览数据！！！我很高兴被证明是错误的。

# android - 如何在 android 应用程序中为课程/活动添加书签并将其发送到书签页面？

> ID：13012568
> 
> 赞同：1
> 
> 时间：2012-10-22T13:33:08.483
> 
> 标签：android

我正在尝试制作一个仅包含文本的应用程序。每个页面（xml）都是不同的。现在我想为用户制作一个书签页面来为他/她的收藏夹添加书签。我成功制作了一个通过主屏幕上的按钮激活的书签页面，每个文本页面上都有一个书签按钮，但我不知道如何发送或显示书签上的书签页面/文本页。

谁能帮帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-07T09:29:55.650

您没有指定是否使用 Web 服务或 db 为页面添加了书签。无论如何，我会在数据库中告诉。在 DB 概念中，您将获得一个像这样的书签页面

**仅用于前：**

```
 public Cursor getAllContacts() {
 return database.query("country", new String[] {"_id", "name"}, null, null, null, null, "name");
} 
```

# c# - 如何处理阻塞同步外部 DLL 方法

> ID：13012570
> 
> 赞同：2
> 
> 时间：2012-10-22T13:33:10.453
> 
> 标签：c#, .net, com, parallel-processing, appdomain

最近我使用了一个外部 dll 库，对此我没有任何影响。在某些特殊情况下，这个第三方dll的一个方法是阻塞的，永不返回。

我试图通过在新的 AppDomain 中执行此方法来解决此问题。自定义超时后，我想卸载 AppDomain 并杀死所有这些废话；）

不幸的是，它不起作用 - 正如有人所期望的那样。

一段时间后，它会抛出 CannotUnloadAppDomainException，因为阻塞方法不允许优雅地中止线程。

我依赖于使用这个库，而且似乎不会很快有更新。

所以我可以解决这个问题，即使它不是最佳实践？任何不好的黑客表示赞赏:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-22T14:36:27.087

AppDomain 通常不能解决该问题，最好丢弃程序的状态。真正的问题是你的线程被卡住了。在这种情况下，调用 Thread.Abort() 不太可能起作用，它也会卡住。一个线程只有在它处于“可提醒等待状态”时才能被中止，阻塞在 CLR 同步对象上。或执行托管代码。在 CLR 知道如何安全清理的状态下。大多数第 3 方代码在执行非托管代码时都会像这样崩溃，无法以安全的方式清理它。这种情况的一个决定性提示是 AppDomain.Unload 未能完成工作，它只能在可以中止正在执行域中的代码的线程时卸载 AppDomain。

唯一好的选择是在单独的进程中运行该代码。你可以用 Process.Kill() 杀死它。Windows 进行清理。您将使用 .NET 互操作机制与该代码对话。像命名管道、套接字、远程处理或 WCF。加上编写可以检测超时的代码的相当大的麻烦会杀死进程，启动它并恢复内部状态，因为您现在使用该第 3 方代码的未初始化实例重新启动。

不要忘记真正的修复。创建一个重现问题的小型重现项目。当它挂起时，创建进程的小型转储。将两者都发送到第 3 方支持小组。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-22T14:19:12.433

读完[这篇](http://msdn.microsoft.com/en-us/library/74169f59.aspx)文章后（向下滚动到阻塞问题），我认为您唯一的解决方案是在不同的*进程*中运行该方法- 这可能涉及相当多的重构和/或加载的“主机”项目（例如控制台应用程序）有问题的方法，并且在使用`Process`该类启动新进程时易于调用（例如从命令行读取 args）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-22T13:45:36.607

您始终可以使用后台工作人员，无需创建新的应用程序域。这将确保您完全控制线程的执行。

但是，没有办法确保您可以优雅地中止线程。由于 dll 是非托管的，因此可能会导致内存泄漏。但是，产生一个新线程将确保您的应用程序在 Dll 没有响应时不会崩溃。

# java - 寻找比数组列表更好的解决方案

> ID：13012571
> 
> 赞同：0
> 
> 时间：2012-10-22T13:33:16.180
> 
> 标签：java, servlets, dao

目前我有一个有效的应用程序，但我想要一些建议，因为我觉得必须有一个更好的解决方案。我正在构建的网站上的一项功能是在用户搜索视频时向他们显示视频。搜索将通过单击链接完成，例如`"View All Dreamweaver Tutorials"`搜索中的每个页面最多有 12 个视频，如果搜索查询更多，则可以单击链接转到其他页面。同样，一切正常，但我不喜欢我的逻辑，想听听是否有人对非常常见的任务有更好的解决方案。

这是用户单击链接时我可能会发送的参数示例...

```
search?tag=Dreamweaver&sub=CSS&page=1 
```

哪里`tag`是主类，`sub`是子类，`page`是他们想看的当前页面。如果用户给出的页面超出范围，他们会被引导到一个特殊的屏幕。所以如果 servlet 看到

```
search?tag=Dreamweaver&sub=CSS&page=1000 
```

它会重定向用户！

现在，这是我的一些 servlet，它抓取这些发送的参数......

```
category = request.getParameter("tag");
subCategory = request.getParameter("sub");
page = Integer.parseInt(request.getParameter("page"));

ArrayList<Integer> startStop = Page.getPageStartStop(page);
int start = startStop.get(0);
int stop = startStop.get(1);

videoList = SearchDAO.getSearchResults(category, subCategory, start, stop); 
```

这是我不喜欢我的逻辑的地方。如您所见，我首先获取参数。还算正常。但随后我调用 Page 类中的一个方法并将页码参数发送给它。所以对于这个例子，我将发送数字 1。然后该方法的目的是通过 if 语句找出数据库应该查询的起点和终点。所以这个方法看起来像这样。

```
public static ArrayList<Integer> getPageStartStop(int page)
{
    ArrayList<Integer> startStop = new ArrayList<Integer>();

    if (page == 1)
    {
        startStop.add(0);
        startStop.add(12);
        return startStop;
    }
    else if (page == 2)
    {
        startStop.add(11);
        startStop.add(23);
        return startStop;
    }
        ......
} 
```

因此，对于发送第 1 页的示例，该方法返回 0 表示开始，12 表示停止并将这些值发送到我的 DAO，以便查询知道从哪里开始和在哪里停止。下面是我的 DAO 的片段，最后两个问号成为我的开始和停止。

```
preparedStatement = connection.prepareStatement("SELECT * FROM videos WHERE category = ? AND subCategory = ? LIMIT ?,?"); 
```

所以问题是 Page 类需要大量的 if 语句来预测页面并返回它们的结果。其他人能想出更好的方法来做到这一点。也许是一个常见的算法？很多网站都使用了这个功能，所以我知道必须有一种更简洁的方法来解决这个问题。老实说，这只是跳入我脑海的第一件事。非常感谢您的阅读！评论和答案将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T13:43:15.067

也许你可以做这样的事情

```
private static int ITEMS_PER_PAGE = 10;

public static List<Integer> getPageStartStop(int page) {
    int start = ITEMS_PER_PAGE * (page-1); // will return 0 for page 1, 10 for page 2, etc...
    int stop = (ITEMS_PER_PAGE * page) + 1; // will return 11 for page 1, 21 for page 2, etc...

    return Arrays.asList(new Integer[] { start, stop });
} 
```

实际上，这称为分页。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-22T13:46:35.047

无需在数组中硬编码您的页面开始停止索引。想想当您决定在页面上显示更多元素时会发生什么。

Use `firstResult`and `maxResults`where `firstResult`is your page number and `maxResults`is the maximum number of items on a single page。然后你可以做`firstResult * maxResults`。

例如参见[http://examples.javacodegeeks.com/enterprise-java/hibernate/pagination-in-hibernate-with-criteria-api](http://examples.javacodegeeks.com/enterprise-java/hibernate/pagination-in-hibernate-with-criteria-api)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-22T13:47:08.920

```
public static ArrayList<Integer> getPageStartStop(int page)
{
    ArrayList<Integer> startStop = new ArrayList<Integer>();
    int NoOfItems = 12;
    if (page > 0 && page < 1000)
    {
        startStop.add(page*NoOfItems - NoOfItems);//will return 0 for page 1
        startStop.add(page*NoOfItems);//will return 12 for page 1
        return startStop;
    }else{
            //your logic if page number exceeds than your set limit or it is less than 1
    }

} 
```

# iphone - 如何实现禁用的应用程序设置？

> ID：13012573
> 
> 赞同：1
> 
> 时间：2012-10-22T13:33:26.293
> 
> 标签：iphone, ios, xcode, settings

如何实现禁用的应用程序设置？我在[Nike Running](https://itunes.apple.com/in/app/nike+-running/id387771637?mt=8)应用程序中看到了这个功能。我搜索了很多有关此功能的信息，但找不到可能的解决方案。在苹果网站和互联网上没有找到教程或参考资料。 ![禁用的应用程序设置](../Images/e2240f0b5e4d134387effe8901d31fb8.png)

![启用的应用程序设置](../Images/83617a3c4c9e3ae75f80f28060c5b7d8.png)

有任何想法吗 ？提前谢谢各位...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-22T13:45:32.237

你不能那样做。Apple 对 iOS 中包含的内容进行了一些特殊设置，例如`Nike +iPod`设置。

您只能使用`Settings.bundle`设置应用程序读取的内容，然后允许用户更改某些设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-22T14:31:05.557

如果您在 App 中实现了设置，则可以执行此操作。A`Static Cell TableViewController`是你所需要的。`NSUserDefaults`只需使用（存储这些设置的标准位置）跟踪设置并`View`自己实施。我个人喜欢应用程序内部的设置，而不是作为操作系统设置的一部分来实现。

# c# - 如果鼠标失去对对象的关注，为什么 MouseMove 事件不起作用？

> ID：13012576
> 
> 赞同：1
> 
> 时间：2012-10-22T13:33:33.003
> 
> 标签：c#, wpf, event-handling, mouse

我的程序中基本上有一个简单的问题，我只是想确保一切正常。它应该在单击鼠标按钮时添加`MouseEventHandler`，然后随着鼠标移动圆圈，直到事件处理程序被删除。我将代码简化为最基本的：

XAML：

```
<Window x:Class="WpfApplication1.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MainWindow" Height="350" Width="525">
    <Grid Name="grid1" Background="White" MouseLeftButtonUp="grid_MouseUp">
        <Ellipse Height="50" HorizontalAlignment="Left" Margin="12,12,0,0" Name="ellipse1" Stroke="{x:Null}" VerticalAlignment="Top" Width="50" Fill="Black" MouseLeftButtonDown="ellipse1_MouseDown" />
    </Grid>
</Window> 
```

C＃：

```
public partial class MainWindow : Window
{
    public MainWindow()
    {
        InitializeComponent();
    }

    private static Point _oldPoint = new Point(), _newPoint = new Point();

    private void ellipse1_MouseDown(object sender, MouseButtonEventArgs e)
    {
        _oldPoint = e.GetPosition(grid1);
        grid1.MouseMove += new MouseEventHandler(grid_MouseMove);
    }

    private void grid_MouseUp(object sender, MouseButtonEventArgs e)
    {
        grid1.MouseMove -= new MouseEventHandler(grid_MouseMove);
    }

    private void grid_MouseMove(object sender, MouseEventArgs e)
    {
        _newPoint = e.GetPosition(grid1);
        ellipse1.Margin = new Thickness(ellipse1.Margin.Left - _oldPoint.X + _newPoint.X, ellipse1.Margin.Top - _oldPoint.Y + _newPoint.Y, 0, 0);
        _oldPoint = _newPoint;
    }
} 
```

现在总的来说，这段代码工作得很好，我认为它非常简洁，因为它在实际按下按钮之前不会检查鼠标的移动。但是，我的问题如下：

我不得不将`MouseMove`事件添加到网格而不是圆圈，因为一旦鼠标指针失去圆圈的焦点（通过移动鼠标太快），它就不会再触发 MouseMove 事件了。但究竟为什么会这样呢？在事件开始时，鼠标肯定在圆圈上方，然后它移动了。是的，它离开了圆圈，但那不应该仍然触发事件吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-22T14:35:52.447

您可以[捕获鼠标](http://msdn.microsoft.com/en-us/library/ms591452.aspx)并处理椭圆中的所有事件。

```
<Grid Name="grid1" Background="White">
    <Ellipse Height="50" HorizontalAlignment="Left" Margin="12,12,0,0" Name="ellipse1" Stroke="{x:Null}" VerticalAlignment="Top" Width="50" Fill="Black"
             MouseLeftButtonDown="ellipse1_MouseDown" MouseLeftButtonUp="ellipse1_MouseUp" />
</Grid> 
```

后面有这段代码

```
private void ellipse1_MouseDown(object sender, MouseButtonEventArgs e)
{
    Mouse.Capture(ellipse1);
    _oldPoint = e.GetPosition(grid1);
    ellipse1.MouseMove += new MouseEventHandler(ellipse1_MouseMove);
}

private void ellipse1_MouseUp(object sender, MouseButtonEventArgs e)
{
    Mouse.Capture(null);
    ellipse1.MouseMove -= new MouseEventHandler(ellipse1_MouseMove);
} 
```

我已将 grid_MouseMove 移动并重命名为 ellipse1_MouseMove。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-22T13:57:49.437

除了彼得所说的之外，如果您使用该`Grid.MouseDown`事件并检查它是否 `oldPoint`在`Ellipse`其中然后处理该`MouseMove`事件，则不会看到这种奇怪的行为。

我还建议探索`drag`事件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-22T13:52:04.997

只要鼠标悬停在该特定控件上，控件就只会获取鼠标事件。

如果移动到新控件，则鼠标将从旧控件中脱钩并挂在新控件上。

有一些方法可以创建一个附加到整个过程的全局钩子，但我想这不是我们要讨论的。

# java - 多线程环境中的对象深度锁定

> ID：13012578
> 
> 赞同：5
> 
> 时间：2012-10-22T13:33:48.003
> 
> 标签：java, multithreading, concurrency

我的项目中有以下**A**类和**B**类的类结构：

```
class A {
    private String id;
    private List<B> bs = new ArrayList<B>();

    A(String id){
        this.id = id;
    }

    public List<B> getBs(){
        return bs;
    }

    public void setBs(List<B> bs){
        this.bs=bs;
    }

    public void addBs(List<B> bs){
        this.bs.addAll(bs);
    }

    public void addB(B b){
        this.bs.add(b);
    }
}

class B {
    private String id;
    private List<String> tags;

    B(String id){
        this.id = id;
    }

    public List<String> getTags(){
        return tags;
    }

    public void setTags(List<String> tags){
        this.tags = tags;
    }

    public void addTags(List<String> tags){
        this.tags.addAll(tags);
    }

    public void addTag(String tag){
        this.tags.add(tag);
    }
} 
```

我们还有一个缓存类：

```
class CacheService {
    private static final ConcurrentHashMap<String, Object> CACHE = new ConcurrentHashMap<String, Object>();

    public static Object get(String id){
        return CACHE.get(id);
    }

    public static void put(String id, Object obj){
        return CACHE.put(id, obj);
    }
} 
```

现在，A 类和 B 类的对象是使用唯一 ID 创建的，并通过 <id, object> 组合放入此缓存中。例如：

```
A a1 = new A("10");
CacheService.put("10", a1);

A a2 = new A("11");
CacheService.put("11", a2);

B b1 = new B("1");
CacheService.put("1", b1);

B b2 = new B("2");
CacheService.put("2", b2);

B b3 = new B("3");
CacheService.put("3", b3);

B b4 = new B("4");
CacheService.put("4", b4); 
```

此外，我将 B 类对象放在`List<B>`内部对象`a1`和`a2`. **需要注意的是，唯一的 B 对象只在任何 A 对象中放置一次**：

```
a1.add(b1);
a1.add(b2);

a2.add(b3);
a2.add(b4); 
```

这样，我们可以在 CACHE 中为 A 类和 B 类拥有多个对象。

**场景：**现在多个线程访问此 CACHE，但其中一些最终会根据用户指定的 ID 获取 A 类对象和其他 B 类对象。这些线程实际上想要**读取**或**更新**这些对象的信息。

**问题：**我的要求是，当一个线程访问了 A 类的对象（例如`a1`）来更新它时，没有其他线程应该能够**读取**或**更新** `a1`以及添加到的所有 B 类对象（`b1`在`b2`这种情况下）`List<B>`内部对象，`a1`直到我完成所有更新`a1`。请告诉我如何在这种情况下获得锁？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-22T14:03:00.347

要进行深度复制，我建议您[`Lock`](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/locks/Lock.html)在 A 和 B 的每个实例中都有 a ，并让它们都使用`lock()`和`unlock()`方法实现一些接口，其中类`A`将获取自己的锁，以及`B's`. 然后，在使用之前锁定对象，并在完成后解锁。

**编辑：**所以你的行动方案是：

1.  创建一个接口，让我们`Lockable`用两种方法调用它：`lock()`和`unlock()`
2.  让 A 和 B 都实现该接口。因此，您的缓存现在将使用`Lockable`而不是`Object`
3.  向 A 和 B 添加一个私有字段

    private final Lock lock = new [ReentrantLock](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/locks/ReentrantLock.html) ();

4.  现在`Lockable`在 B 中的实现将只是在锁上调用相同的方法
5.  在 A 中，`lock()`将获取本地锁实例，并迭代 b 的列表并调用它们的`lock()`方法。相同的`unlock()`
6.  现在，每次从缓存中获取对象时，在对它进行任何操作之前，都会调用`lock()`该对象，然后`unlock()`在完成时调用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-22T13:49:33.807

关键字将`synchronized`帮助您解决此问题。您可以将整个方法声明为`synchronized`，也可以拥有`synchronized()`块，这些块锁定在您定义的特定键对象上。当`synchronized()`进入一个块时，在退出该块之前，另一个线程不能访问使用相同密钥对象锁定的其他块。

[在此处](http://docs.oracle.com/javase/tutorial/essential/concurrency/syncmeth.html)查看有关同步的 Java 教程。

对于您的示例，您可以执行以下任一操作：

```
public synchronized void addB(B b) {
    this.bs.add(b);
} 
```

或者

...在您的类中声明一个锁定对象...

```
private final Object LOCK = new Object(); 
```

...并使用它一个`synchronized()`块：

```
public void addB(B b) {
    synchronized(LOCK) {
        this.bs.add(b);
    }
} 
```

使用第二个优于第一个的优点是您可以完全、明确地控制哪些代码部分被锁定（而不仅仅是整个方法调用）。在处理并发时，您希望尽可能少地同步以提高效率，因此使用它您可以仅在最低限度上执行同步。

另外，我敢肯定有人会指出您不需要显式声明另一个锁对象，因为您可以使用`this`关键字在当前对象上进行同步。但是，[这个其他 StackOverflow 问题和答案](https://stackoverflow.com/questions/442564/avoid-synchronizedthis-in-java)总结了我不建议这样做的原因。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-22T14:09:52.200

**EDIT2：**我打算在编辑问题后完成我的答案，但我刚刚找到了[java.util.concurrent.locks.ReentrantReadWriteLock](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/locks/ReentrantReadWriteLock.html)类，*我认为*它完全符合用户 sohanlal 的需求。

这个类提供了一对锁，一个用于读取操作，可以由多个元素同时拥有，并且本身不是阻塞的。第二个（写入部分）在获取时避免任何读取或写入操作。

那么解决方案如下：

1.  给容器类A加锁。这个类是读写锁的真正拥有者。
2.  将锁属性添加到 B 类。该类不拥有锁，但仅引用它以对其进行读锁定。
3.  将新的 B 对象添加到 A 容器时，为 B 对象提供对容器上 ReentrantReadWriteLock 的引用。从 A 中提取 B 对象时，取消引用从容器“继承”的锁。
4.  在 A 类中，对修改 B 对象集合的每个操作（添加、删除...）进行写锁定。可选（如果 B 元素的底层集合未同步），不修改集合但访问它的读锁定操作。
5.  在 B 类中，对每个操作进行读锁定。

代码。这还没有经过测试，但会给出一个应该如何实现的想法：

```
class A {
    private String id;
    private List<B> bs = new ArrayList<B>();
    private ReentrantReadWriteLock lk = new ReentrantReadWriteLock();

    A(String id){
        this.id = id;
    }

    public List<B> getBs(){
        lk.readLock().lock(); // acquire the read lock, since this operation does not affect A contents
        return bs;
        lk.readLock().unlock();
    }

    public void setBs(List<B> bs){
        lk.writeLock().lock(); // acquire the write lock, which automatically avoids further reading/writing operations
        this.bs=bs;
        for( B elem : bs )
        {
            // internal B elements need a reference to the reading part of the lock
            elem.setLock(lk.readLock()); 
        }
        lk.writeLock().unlock();
    }

    public void addBs(List<B> bs){
        [...] // similar approach that in setBs
    }

    public void addB(B b){
        [...] // similar approach that in setBs
    }

    public void deleteB( B elem ) // Or whatever notation you want
    {            
        lk.writeLock().lock(); // acquire the write lock
        B internalElem = bs.get(bs.indexOf(elem));             
        if( internalElem != null )
        {
            bs.remove(internalElem);
            bs.unsetLock();
        }
        lk.writeLock().unlock();
    }
}

class B {
    private String id;
    private List<String> tags;
    private Lock lk;

    B(String id){
        this.id = id;
        lk = null;
    }

    public void setLock(Lock l){ lk = l; } // put additional controls if you want
    public void unsetLock()
    { 
        lk = null; 
    }

    private void lockInternal()
    {
        if(lk!=null){ lk.lock(); }
    }

    private void unlockInternal()
    {
        if(lk!=null){ lk.unlock(); }
    }

    public List<String> getTags(){
        List<String> ref = null;            
        lockInternal();
            [...] //internal operations
        unlockInternal();
        return ref;
    }

    public void setTags(List<String> tags){
        [...] // similar approach that in getTags
    }

    public void addTags(List<String> tags){
        [...] // similar approach that in getTags
    }

    public void addTag(String tag){
        [...] // similar approach that in getTags
    }
} 
```

**原始答案：**

Jeff 的回答是一个很好的起点，因为它似乎解决了触摸 A 型对象并修改其组成的问题。但是，我们仍然有一个与 A 上包含的 B 类对象有关的问题。假设我们有一个 A 类对象，其中包含几个 B 类元素：

```
A a1 = new A("10");
B b1 = new B("myB1");
B b2 = new B("myB2");
B b3 = new B("myB3");
a1.add(b1);
a1.add(b2);
a1.add(b3); 
```

问题是，如果你正在操作`a1`，你想锁定任何操作`b1`，`b2`并且`b3`。你怎么能确定呢？

我看到的唯一解决方案是 A 容器内的所有 B 元素共享一些公共 Lock 变量。在调用 over 的写相关操作时`a1`，它获取锁，避免了对 B 元素的 ANY 操作。请注意，对 B 元素的任何操作都不需要实际获取锁……只是为了检查它是否已被 A 型容器获取。

很多缺点/考虑：

*   性能：对 B 对象的每个操作都将涉及检查锁（这可能非常昂贵）
*   操作限制：如果一个 B 对象可以添加到多个 A 类容器中，这将变得更加复杂
*   实现复杂度：当你在里面插入一个 B 对象时`a1`，你必须为 B 提供共享锁。提取时，必须解除对锁的引用。如果容器 A 被删除会怎样？你必须照顾这种事情。

**编辑**：我忘了提到这个机制，在编写 A 型容器时，不会“停止”或考虑对包含的 B 型元素的持续操作。

# php - 使用 base64 编码的字符串 URL

> ID：13012579
> 
> 赞同：5
> 
> 时间：2012-10-22T13:33:52.903
> 
> 标签：php, zend-framework, url, base64

> **可能重复：**
> [在 URL 中传递 base64 编码的字符串](https://stackoverflow.com/questions/1374753/passing-base64-encoded-strings-in-url)

我正在创建一个将发送给用户的 url。用户然后单击该 URL，该 URL 告诉我用户是谁。

因此，我使用 base64 编码添加到此链接的所有数据。但是，当用户单击该链接时，他会被重定向到 404 页面，因为编码的 url 中包含“/”并且 zend 框架路由器没有找到任何路由。

有什么办法可以抑制'/'？我试过[`htmlentities`](http://php.net/htmlentities)了，但没有用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-22T14:43:31.997

我强烈推荐[Joe Riggs 的 Create URL Safe Encrypted String](http://joe-riggs.com/blog/2009/08/php-create-url-safe-encrypted-string/)。

提供的代码是程序化的，但转换为 OO 非常简单。我用它来做你正在做的事情，其中​​一些信息（通常是用户的电子邮件和 id 的哈希）被编码/加密，以便用户单击以激活他们的帐户。

您要查看的函数是`url_base64_decode`and `url_base64_encode`，其中某些字符被重写为 url 安全（例如，将其删除`/`并替换为`~`）。

[编辑]

这是基于上述代码的我班级的键盘：http: [//codepad.org/lzevA4k1](http://codepad.org/lzevA4k1)

用法：

```
$cryptUtil = new RPK_Crypt();
$string = 'Unencrypted string';
$eString = $cryptUtil->encrypt($string);
$dString = $cryptUtil->decrypt($eString);
var_dump($dString == $string); //true 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-22T14:19:56.167

我认为您需要对chars`+`和. 尝试在您的 Base64 编码参数上使用。`/``=`[`urlencode()`](http://php.net/manual/en/function.urlencode.php)

PS：顺便说一下，这些将是变化：`+`=> `%2B`，`/`=>`%2F`和`=`=>`%25`

# android - 删除日历条目

> ID：13012581
> 
> 赞同：0
> 
> 时间：2012-10-22T13:33:55.027
> 
> 标签：android, android-intent

我想删除所有日历条目。我正在使用此查询来获取日历条目

```
Uri uri = Uri.parse("content://com.android.calendar/events");
cursor =  context.getContentResolver().query(uri, null, null,null, null); 
```

但是游标每次都返回null。我也检查过 `Uri uri = Uri.parse("content://calendar/events");` 但结果是一样的。

请帮忙。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T14:02:56.817

问题是作为 URI 一部分的日历授权。在 API 级别 14 之前它不是标准化的。如果您的目标是 8 级及更高级别`com.android.calendar`，Google 的代码建议您这样做，但手机制造商可能会使用其他权限。在 API 8 之前，权限是公正的`calendar`（如上一个答案中使用的）。

还要记住授予写入用户日历的权​​限。

当您删除事件时，请记住同时删除它们的扩展属性、提醒和警报。以下是他们的路径：

```
private static final String calendarPath = "calendars";
private static final String eventsPath = "events";
private static final String remindersPath = "reminders";
private static final String calAlertsPath = "calendar_alerts";
private static final String eventsExtPropPath = "extendedproperties"; 
```

对于 API 级别 14，这是标准化的，您可以从以下位置获取 URI `CalendarContract`：

```
 CalendarContract.Calendars.CONTENT_URI;
    CalendarContract.Events.CONTENT_URI;
    CalendarContract.Reminders.CONTENT_URI;
    CalendarContract.CalendarAlerts.CONTENT_URI;
    CalendarContract.ExtendedProperties.CONTENT_URI; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-22T13:44:26.527

//试试这个请求`android:minSdkVersion="7"`

```
public void deleteAllCalendar(){
        Log.i(TAG, "In deleteAllCalendar()");
        String strUriEvents = "content://calendar/events";
        Uri uri_calendar = Uri.parse(strUriEvents);
        String str_column_name = "_id";
        String[] projection = {str_column_name};
        int columnIndex = 0;
        String str_id = "";
        Vector<String> vector_id = new Vector<String>();
        int delRow = 0;
        String where = "";
        try {
            Cursor cursor = cr.query(uri_calendar, projection, null, null, null);
            if(cursor.moveToFirst()){
                do{
                    columnIndex = cursor.getColumnIndex(str_column_name);
                    str_id = cursor.getString(columnIndex);
                    vector_id.add(str_id);
                }while(cursor.moveToNext());
            }
            cursor.close();
            for(int i=0; i<vector_id.size(); i++){
                str_id = vector_id.get(i);
                where = str_column_name+"="+str_id;
                delRow = cr.delete(uri_calendar, where, null);
                Log.i(TAG, "deleteAllCalendar(),delRow:"+delRow);
            }
        } catch (Exception e) {
            // TODO Auto-generated catch block
            Log.e(TAG, "deleteAllCalendar(),Exception");
            e.printStackTrace();
        }
        Log.i(TAG, "Out deleteAllCalendar()");
    } 
```

# multithreading - 如何在wp7的子线程中绘制许多多边形和多段线

> ID：13012583
> 
> 赞同：0
> 
> 时间：2012-10-22T13:34:02.087
> 
> 标签：multithreading, silverlight, windows-phone-7, draw

我正在开发一个 Windows Phone 应用程序，它需要在运行时绘制大量的多边形和折线。

我搜索了 google 和 stackoverflow 发现`Dispatcher.BeginInovoke()`不能满足我的需求。因为我必须在我的非 UI 线程中创建`DependencyObject`诸如`Polygon`and之类的 s。`Polyline`你能帮助我吗？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T01:24:05.050

如果您在非 ui 线程中创建 ui 元素。

您必须使用 dispather 使您的 ui 线程执行 ui 操作，否则它将引发异常。

例如 ：

```
 ThreadHelper.RunInNewThread(() =>
            {

                Dispatcher.BeginInvoke(() => 

                         //something you want ui thread do
                    );

            }, 10); 
```

# java - JPA：如何将原生查询结果集转换为 POJO 类集合

> ID：13012584
> 
> 赞同：216
> 
> 时间：2012-10-22T13:34:05.400
> 
> 标签：java, jpa

我在我的项目中使用 JPA。

我遇到了一个查询，其中我需要对五个表进行连接操作。所以我创建了一个返回五个字段的本机查询。

现在我想将结果对象转换为包含相同五个字符串的 java POJO 类。

JPA 中有没有办法直接将该结果转换为 POJO 对象列表？

我来到以下解决方案..

```
@NamedNativeQueries({  
    @NamedNativeQuery(  
        name = "nativeSQL",  
        query = "SELECT * FROM Actors",  
        resultClass = db.Actor.class),  
    @NamedNativeQuery(  
        name = "nativeSQL2",  
        query = "SELECT COUNT(*) FROM Actors",  
        resultClass = XXXXX) // <--------------- problem  
}) 
```

现在在 resultClass 中，我们是否需要提供一个实际 JPA 实体的类？或者我们可以将它转换为任何包含相同列名的 JAVA POJO 类？

* * *

## 回答 #1

> 赞同：237
> 
> 时间：2014-01-31T18:08:36.263

我找到了几个解决方案。

**使用映射实体 (JPA 2.0)**

使用 JPA 2.0 无法将本机查询映射到 POJO，只能使用实体来完成。

例如：

```
Query query = em.createNativeQuery("SELECT name,age FROM jedi_table", Jedi.class);
@SuppressWarnings("unchecked")
List<Jedi> items = (List<Jedi>) query.getResultList(); 
```

但在这种情况下，`Jedi`, 必须是映射的实体类。

在这里避免未经检查的警告的另一种方法是使用命名的本机查询。因此，如果我们在实体中声明本机查询

```
@NamedNativeQuery(
 name="jedisQry", 
 query = "SELECT name,age FROM jedis_table", 
 resultClass = Jedi.class) 
```

然后，我们可以简单地做：

```
TypedQuery<Jedi> query = em.createNamedQuery("jedisQry", Jedi.class);
List<Jedi> items = query.getResultList(); 
```

这更安全，但我们仍然被限制使用映射实体。

**手动映射**

我尝试了一下（在 JPA 2.1 到来之前）的一个解决方案是使用一点反射对 POJO 构造函数进行映射。

```
public static <T> T map(Class<T> type, Object[] tuple){
   List<Class<?>> tupleTypes = new ArrayList<>();
   for(Object field : tuple){
      tupleTypes.add(field.getClass());
   }
   try {
      Constructor<T> ctor = type.getConstructor(tupleTypes.toArray(new Class<?>[tuple.length]));
      return ctor.newInstance(tuple);
   } catch (Exception e) {
      throw new RuntimeException(e);
   }
} 
```

此方法基本上采用元组数组（由本机查询返回）并通过查找具有相同数量的字段和相同类型的构造函数将其映射到提供的 POJO 类。

然后我们可以使用方便的方法，例如：

```
public static <T> List<T> map(Class<T> type, List<Object[]> records){
   List<T> result = new LinkedList<>();
   for(Object[] record : records){
      result.add(map(type, record));
   }
   return result;
}

public static <T> List<T> getResultList(Query query, Class<T> type){
  @SuppressWarnings("unchecked")
  List<Object[]> records = query.getResultList();
  return map(type, records);
} 
```

我们可以简单地使用这种技术，如下所示：

```
Query query = em.createNativeQuery("SELECT name,age FROM jedis_table");
List<Jedi> jedis = getResultList(query, Jedi.class); 
```

**带有@SqlResultSetMapping 的 JPA 2.1**

随着 JPA 2.1 的到来，我们可以使用 @SqlResultSetMapping 注解来解决这个问题。

我们需要在实体的某处声明一个结果集映射：

```
@SqlResultSetMapping(name="JediResult", classes = {
    @ConstructorResult(targetClass = Jedi.class, 
    columns = {@ColumnResult(name="name"), @ColumnResult(name="age")})
}) 
```

然后我们简单地做：

```
Query query = em.createNativeQuery("SELECT name,age FROM jedis_table", "JediResult");
@SuppressWarnings("unchecked")
List<Jedi> samples = query.getResultList(); 
```

当然，在这种情况下`Jedi`不必是映射实体。它可以是一个普通的 POJO。

**使用 XML 映射**

我是那些发现`@SqlResultSetMapping`在我的实体中添加所有这些非常具有侵入性的人之一，我特别不喜欢实体中命名查询的定义，所以或者我在`META-INF/orm.xml`文件中执行所有这些操作：

```
<named-native-query name="GetAllJedi" result-set-mapping="JediMapping">
    <query>SELECT name,age FROM jedi_table</query>
</named-native-query>

<sql-result-set-mapping name="JediMapping">
        <constructor-result target-class="org.answer.model.Jedi">
            <column name="name" class="java.lang.String"/>
            <column name="age" class="java.lang.Integer"/>
        </constructor-result>
    </sql-result-set-mapping> 
```

这些就是我所知道的所有解决方案。如果我们可以使用 JPA 2.1，最后两个是理想的方式。

* * *

## 回答 #2

> 赞同：115
> 
> 时间：2012-10-22T14:16:00.527

JPA 提供了一个[`SqlResultSetMapping`](http://docs.oracle.com/javaee/5/api/javax/persistence/SqlResultSetMapping.html)允许您将本机查询的任何返回映射到实体的方法~~或自定义类~~.

**EDIT** JPA 1.0 不允许映射到非实体类。仅在 JPA 2.1 中添加了[ConstructorResult](http://docs.oracle.com/javaee/7/api/javax/persistence/ConstructorResult.html)以将返回值映射到 java 类。

此外，对于 OP 的计数问题，使用单个定义结果集映射就足够了[`ColumnResult`](http://docs.oracle.com/javaee/7/api/javax/persistence/ColumnResult.html)

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2016-09-19T12:08:42.720

是的，使用 JPA 2.1 很容易。你有非常有用的注释。他们简化了你的生活。

首先声明您的本机查询，然后声明您的结果集映射（它定义了数据库返回的数据到您的 POJO 的映射）。编写您的 POJO 类以供参考（为简洁起见，此处不包括在内）。最后但同样重要的是：在 DAO（例如）中创建一个方法来调用查询。这在 dropwizard (1.0.0) 应用程序中对我有用。

首先在实体类中声明一个原生查询：

```
@NamedNativeQuery (
name = "domain.io.MyClass.myQuery",
query = "Select a.colA, a.colB from Table a",
resultSetMapping = "mappinMyNativeQuery")   // must be the same name as in the SqlResultSetMapping declaration 
```

您可以在下面添加结果集映射声明：

```
@SqlResultSetMapping(
name = "mapppinNativeQuery",  // same as resultSetMapping above in NativeQuery
   classes = {
      @ConstructorResult( 
          targetClass = domain.io.MyMapping.class,
          columns = {
               @ColumnResult( name = "colA", type = Long.class),  
               @ColumnResult( name = "colB", type = String.class)
          }
      )
   } 
) 
```

稍后在 DAO 中，您可以将查询称为

```
public List<domain.io.MyMapping> findAll() {
        return (namedQuery("domain.io.MyClass.myQuery").list());
    } 
```

而已。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2017-04-24T10:12:54.563

如果您使用`Spring-jpa`，这是对答案和此问题的补充。如有不足请指正。`Object[]`根据我的实际需求，我主要使用了三种方法来实现“将结果映射到pojo”：

1.  JPA 内置方法就足够了。
2.  JPA 内置方法是不够的，但是`sql`用它定制一个`Entity`就足够了。
3.  前 2 个失败，我必须使用`nativeQuery`. 以下是示例。pojo预期：

    ```
    public class Antistealingdto {

        private String secretKey;

        private Integer successRate;

        // GETTERs AND SETTERs

        public Antistealingdto(String secretKey, Integer successRate) {
            this.secretKey = secretKey;
            this.successRate = successRate;
        }
    } 
    ```

**方法一**：将pojo改成接口：

```
public interface Antistealingdto {
    String getSecretKey();
    Integer getSuccessRate();
} 
```

和存储库：

```
interface AntiStealingRepository extends CrudRepository<Antistealing, Long> {
    Antistealingdto findById(Long id);
} 
```

**方法2**：存储库：

```
@Query("select new AntistealingDTO(secretKey, successRate) from Antistealing where ....")
Antistealing whatevernamehere(conditions); 
```

注意：POJO 构造函数的参数顺序在 POJO 定义和 sql 中必须一致。

**方法 3**：使用`@SqlResultSetMapping`and `@NamedNativeQuery`in`Entity`作为 Edwin Dalorzo 的答案中的示例。

前两种方法将调用许多中间处理程序，例如自定义转换器。例如，`AntiStealing`定义一个`secretKey`，在它被持久化之前，插入一个转换器来加密它。这将导致前 2 个方法返回转换后的返回`secretKey`值，这不是我想要的。虽然方法 3 将克服转换器，并且返回`secretKey`将与存储的相同（加密的）。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2018-03-26T10:24:43.680

可以执行展开过程以将结果分配给非实体（即 Beans/POJO）。程序如下。

```
List<JobDTO> dtoList = entityManager.createNativeQuery(sql)
        .setParameter("userId", userId)
        .unwrap(org.hibernate.Query.class).setResultTransformer(Transformers.aliasToBean(JobDTO.class)).list(); 
```

该用法用于 JPA-Hibernate 实现。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2019-04-03T05:17:26.787

最简单的方法是使用 so**投影**。它可以将查询结果直接映射到接口，比使用SqlResultSetMapping更容易实现。

一个例子如下所示：

```
@Repository
public interface PeopleRepository extends JpaRepository<People, Long> {

    @Query(value = "SELECT p.name AS name, COUNT(dp.people_id) AS count " +
        "FROM people p INNER JOIN dream_people dp " +
        "ON p.id = dp.people_id " +
        "WHERE p.user_id = :userId " +
        "GROUP BY dp.people_id " +
        "ORDER BY p.name", nativeQuery = true)
    List<PeopleDTO> findByPeopleAndCountByUserId(@Param("userId") Long userId);

    @Query(value = "SELECT p.name AS name, COUNT(dp.people_id) AS count " +
        "FROM people p INNER JOIN dream_people dp " +
        "ON p.id = dp.people_id " +
        "WHERE p.user_id = :userId " +
        "GROUP BY dp.people_id " +
        "ORDER BY p.name", nativeQuery = true)
    Page<PeopleDTO> findByPeopleAndCountByUserId(@Param("userId") Long userId, Pageable pageable);

}

// Interface to which result is projected
public interface PeopleDTO {

    String getName();

    Long getCount();

} 
```

投影接口中的字段必须与该实体中的字段匹配。否则字段映射可能会中断。

此外，如果您使用`SELECT table.column`表示法，请始终定义与实体名称匹配的别名，如示例所示。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2019-04-09T12:45:00.563

在休眠中，您可以使用此代码轻松映射您的本机查询。

```
private List < Map < String, Object >> getNativeQueryResultInMap() {
String mapQueryStr = "SELECT * FROM AB_SERVICE three ";
Query query = em.createNativeQuery(mapQueryStr);
NativeQueryImpl nativeQuery = (NativeQueryImpl) query;
nativeQuery.setResultTransformer(AliasToEntityMapResultTransformer.INSTANCE);
List < Map < String, Object >> result = query.getResultList();
for (Map map: result) {
    System.out.println("after request  ::: " + map);
}
return result;} 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2015-05-07T20:53:27.980

首先声明以下注解：

```
@Target(ElementType.TYPE)
@Retention(RetentionPolicy.RUNTIME)
public @interface NativeQueryResultEntity {
}

@Target(ElementType.FIELD)
@Retention(RetentionPolicy.RUNTIME)
public @interface NativeQueryResultColumn {
    int index();
} 
```

然后注释您的 POJO，如下所示：

```
@NativeQueryResultEntity
public class ClassX {
    @NativeQueryResultColumn(index=0)
    private String a;

    @NativeQueryResultColumn(index=1)
    private String b;
} 
```

然后编写注解处理器：

```
public class NativeQueryResultsMapper {

    private static Logger log = LoggerFactory.getLogger(NativeQueryResultsMapper.class);

    public static <T> List<T> map(List<Object[]> objectArrayList, Class<T> genericType) {
        List<T> ret = new ArrayList<T>();
        List<Field> mappingFields = getNativeQueryResultColumnAnnotatedFields(genericType);
        try {
            for (Object[] objectArr : objectArrayList) {
                T t = genericType.newInstance();
                for (int i = 0; i < objectArr.length; i++) {
                    BeanUtils.setProperty(t, mappingFields.get(i).getName(), objectArr[i]);
                }
                ret.add(t);
            }
        } catch (InstantiationException ie) {
            log.debug("Cannot instantiate: ", ie);
            ret.clear();
        } catch (IllegalAccessException iae) {
            log.debug("Illegal access: ", iae);
            ret.clear();
        } catch (InvocationTargetException ite) {
            log.debug("Cannot invoke method: ", ite);
            ret.clear();
        }
        return ret;
    }

    // Get ordered list of fields
    private static <T> List<Field> getNativeQueryResultColumnAnnotatedFields(Class<T> genericType) {
        Field[] fields = genericType.getDeclaredFields();
        List<Field> orderedFields = Arrays.asList(new Field[fields.length]);
        for (int i = 0; i < fields.length; i++) {
            if (fields[i].isAnnotationPresent(NativeQueryResultColumn.class)) {
                NativeQueryResultColumn nqrc = fields[i].getAnnotation(NativeQueryResultColumn.class);
                orderedFields.set(nqrc.index(), fields[i]);
            }
        }
        return orderedFields;
    }
} 
```

使用上述框架如下：

```
String sql = "select a,b from x order by a";
Query q = entityManager.createNativeQuery(sql);

List<ClassX> results = NativeQueryResultsMapper.map(q.getResultList(), ClassX.class); 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2019-03-04T13:12:11.810

使用休眠：

```
@Transactional(readOnly=true)
public void accessUser() {
EntityManager em = repo.getEntityManager();
    org.hibernate.Session session = em.unwrap(org.hibernate.Session.class);
    org.hibernate.SQLQuery q = (org.hibernate.SQLQuery) session.createSQLQuery("SELECT u.username, u.name, u.email, 'blabla' as passe, login_type as loginType FROM users u").addScalar("username", StringType.INSTANCE).addScalar("name", StringType.INSTANCE).addScalar("email", StringType.INSTANCE).addScalar("passe", StringType.INSTANCE).addScalar("loginType", IntegerType.INSTANCE)
        .setResultTransformer(Transformers.aliasToBean(User2DTO.class));

    List<User2DTO> userList = q.list();
} 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2019-03-05T15:05:12.280

使用 ResultSet 的旧样式

```
@Transactional(readOnly=true)
public void accessUser() {
    EntityManager em = this.getEntityManager();
    org.hibernate.Session session = em.unwrap(org.hibernate.Session.class);
    session.doWork(new Work() {
        @Override
        public void execute(Connection con) throws SQLException {
            try (PreparedStatement stmt = con.prepareStatement(
                    "SELECT u.username, u.name, u.email, 'blabla' as passe, login_type as loginType FROM users u")) {
                ResultSet rs = stmt.executeQuery();
                ResultSetMetaData rsmd = rs.getMetaData();
                for (int i = 1; i <= rsmd.getColumnCount(); i++) {
                    System.out.print(rsmd.getColumnName(i) + " (" + rsmd.getColumnTypeName(i) + ") / ");
                }
                System.out.println("");
                while (rs.next()) {
                    System.out.println("Found username " + rs.getString("USERNAME") + " name " + rs.getString("NAME") + " email " + rs.getString("EMAIL") + " passe " + rs.getString("PASSE") + " email " + rs.getInt("LOGIN_TYPE"));
                }
            }
        }
    });
} 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2019-07-08T13:38:41.203

我们已使用以下方式解决了该问题：

```
 //Add actual table name here in Query
    final String sqlQuery = "Select a.* from ACTORS a"
    // add your entity manager here 
    Query query = entityManager.createNativeQuery(sqlQuery,Actors.class);
    //List contains the mapped entity data.
    List<Actors> list = (List<Actors>) query.getResultList(); 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2017-11-11T05:18:07.873

由于其他人已经提到了所有可能的解决方案，我正在分享我的解决方法。

在我的情况下`Postgres 9.4`，在工作时`Jackson`，

```
//Convert it to named native query.
List<String> list = em.createNativeQuery("select cast(array_to_json(array_agg(row_to_json(a))) as text) from myschema.actors a")
                   .getResultList();

List<ActorProxy> map = new ObjectMapper().readValue(list.get(0), new TypeReference<List<ActorProxy>>() {}); 
```

我相信你可以为其他数据库找到相同的。

仅供参考，[JPA 2.0 本机查询结果作为地图](https://stackoverflow.com/questions/7595328/jpa-2-0-native-query-results-as-map/46190527#46190527)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2018-12-18T10:49:31.750

不确定这是否适合这里，但我有类似的问题，并为我找到了以下简单的解决方案/示例：

```
private EntityManager entityManager;
...
    final String sql = " SELECT * FROM STORE "; // select from the table STORE
    final Query sqlQuery = entityManager.createNativeQuery(sql, Store.class);

    @SuppressWarnings("unchecked")
    List<Store> results = (List<Store>) sqlQuery.getResultList(); 
```

在我的情况下，我不得不在其他地方使用 Strings 中定义的 SQL 部分，所以我不能只使用 NamedNativeQuery。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-12-22T06:27:02.367

请参阅下面的示例，了解使用 POJO 作为伪实体从本机查询中检索结果，而不使用复杂的 SqlResultSetMapping。POJO 中只需要两个注释，一个裸露的@Enity 和一个虚拟的@Id。@Id 可以在您选择的任何字段上使用，@Id 字段可以有重复的键但不能有空值。

由于@Enity 不映射到任何物理表，所以这个POJO 被称为伪实体。

环境：eclipselink 2.5.0-RC1、jpa-2.1.0、mysql-connector-java-5.1.14

[你可以在这里](https://github.com/jonathanluo/jpa)下载完整的 Maven 项目

本机查询基于 mysql 示例员工数据库 [http://dev.mysql.com/doc/employee/en/employees-installation.html](http://dev.mysql.com/doc/employee/en/employees-installation.html)

持久性.xml

```
<?xml version="1.0" encoding="UTF-8"?><persistence xmlns="http://xmlns.jcp.org/xml/ns/persistence" 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" version="2.1" 
    xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/persistence http://xmlns.jcp.org/xml/ns/persistence/persistence_2_1.xsd">
<persistence-unit name="jpa-mysql" transaction-type="RESOURCE_LOCAL">
    <class>org.moonwave.jpa.model.pojo.Employee</class>
    <properties>
        <property name="javax.persistence.jdbc.url" value="jdbc:mysql://localhost:3306/employees" />
        <property name="javax.persistence.jdbc.user" value="user" />
        <property name="javax.persistence.jdbc.password" value="***" />
        <property name="javax.persistence.jdbc.driver" value="com.mysql.jdbc.Driver" />
    </properties>
</persistence-unit> 
```

雇员.java

```
package org.moonwave.jpa.model.pojo;

@Entity
public class Employee {

@Id
protected Long empNo;

protected String firstName;
protected String lastName;
protected String title;

public Long getEmpNo() {
    return empNo;
}
public void setEmpNo(Long empNo) {
    this.empNo = empNo;
}
public String getFirstName() {
    return firstName;
}
public void setFirstName(String firstName) {
    this.firstName = firstName;
}
public String getLastName() {
    return lastName;
}
public void setLastName(String lastName) {
    this.lastName = lastName;
}   
public String getTitle() {
    return title;
}
public void setTitle(String title) {
    this.title = title;
}
public String toString() {
    StringBuilder sb = new StringBuilder();
    sb.append("empNo: ").append(empNo);
    sb.append(", firstName: ").append(firstName);
    sb.append(", lastName: ").append(lastName);
    sb.append(", title: ").append(title);
    return sb.toString();
}
} 
```

EmployeeNativeQuery.java

```
public class EmployeeNativeQuery {
private EntityManager em;
private EntityManagerFactory emf;

public void setUp() throws Exception {
    emf=Persistence.createEntityManagerFactory("jpa-mysql");
    em=emf.createEntityManager();
}
public void tearDown()throws Exception {
    em.close();
    emf.close();
}

@SuppressWarnings("unchecked")
public void query() {
    Query query = em.createNativeQuery("select e.emp_no as empNo, e.first_name as firstName, e.last_name as lastName," + 
            "t.title from employees e join titles t on e.emp_no = t.emp_no", Employee.class);
    query.setMaxResults(30);
    List<Employee> list = (List<Employee>) query.getResultList();
    int i = 0;
    for (Object emp : list) {
        System.out.println(++i + ": " + emp.toString());
    }
}

public static void main( String[] args ) {
    EmployeeNativeQuery test = new EmployeeNativeQuery();
    try {
        test.setUp();
        test.query();
        test.tearDown();
    } catch (Exception e) {
        System.out.println(e);
    }
}
} 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-09-17T15:40:00.813

我尝试了上面答案中提到的很多事情。SQLmapper 对放置它的位置非常困惑。只有非托管 POJO 是个问题。我尝试了各种方法，其中一种简单的方法就是照常工作。我正在使用hibernate-jpa-2.1。

```
List<TestInfo> testInfoList = factory.createNativeQuery(QueryConstants.RUNNING_TEST_INFO_QUERY)
                    .getResultList(); 
```

唯一需要注意的是 POJO 具有与查询相同的成员变量名称（全部小写）。显然，我什至不需要像我们在 JPQL 中使用 TypedQueries 那样告诉目标类和查询。

**测试信息类**

```
@Setter
@Getter
@NoArgsConstructor
@ToString
public class TestInfo {

    private String emailid;
    private Long testcount;

    public TestInfo(String emailId, Long testCount) {
        super();
        this.emailid = emailId;
        this.testcount = testCount;
    }

} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-02-08T20:03:42.403

如果查询不是太复杂，你可以做这样的事情。在我的情况下，我需要使用 H2 FT_Search 结果查询来进行另一个查询。

```
var ftSearchQuery = "SELECT * FROM FT_SEARCH(\'something\', 0, 0)";
List<Object[]> results = query.getResultList();
List<Model> models = new ArrayList<>();
for (Object[] result : results) {
    var newQuery = "SELECT * FROM " + (String) result[0];
    models.addAll(entityManager.createNativeQuery(newQuery, Model.class).getResultList());
  } 
```

可能有更清洁的方法可以做到这一点。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2020-11-29T06:17:52.357

在这种情况下，使用像实体（又名不可变实体）这样的“数据库视图”非常容易。

### 正常实体

```
@Entity
@Table(name = "people")
data class Person(
  @Id
  val id: Long = -1,
  val firstName: String = "",
  val lastName: String? = null
) 
```

### 查看类似实体

```
@Entity
@Immutable
@Subselect("""
select
    p.id,
    concat(p.first_name, ' ', p.last_name) as full_name
from people p
""")
data class PersonMin(
  @Id
  val id: Long,
  val fullName: String,
) 
```

在任何存储库中，我们都可以创建查询函数/方法，就像：

```
@Query(value = "select p from PersonMin p")
fun findPeopleMinimum(pageable: Pageable): Page<PersonMin> 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2019-03-04T13:17:19.803

使用休眠：

```
@Transactional(readOnly=true)
public void accessUser() {
    EntityManager em = repo.getEntityManager();
    org.hibernate.Session session = em.unwrap(org.hibernate.Session.class);
    org.hibernate.SQLQuery q = (org.hibernate.SQLQuery) session.createSQLQuery("SELECT u.username, u.name, u.email, 'blabla' as passe, login_type as loginType FROM users u")
        .addScalar("username", StringType.INSTANCE).addScalar("name", StringType.INSTANCE)
        .addScalar("email", StringType.INSTANCE).addScalar("passe", StringType.INSTANCE)
        .addScalar("loginType", IntegerType.INSTANCE)
        .setResultTransformer(Transformers.aliasToBean(User2DTO.class));

    List<User2DTO> userList = q.list();
} 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2016-02-29T11:38:05.630

如果您使用的是 Spring，则可以使用`org.springframework.jdbc.core.RowMapper`

这是一个例子：

```
public List query(String objectType, String namedQuery)
{
  String rowMapper = objectType + "RowMapper";
  // then by reflection you can instantiate and use. The RowMapper classes need to follow the naming specific convention to follow such implementation.
} 
```

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2016-09-21T07:14:46.550

将 SQL 查询转换为 POJO 类集合的简单方法，

```
Query query = getCurrentSession().createSQLQuery(sqlQuery).addEntity(Actors.class);
List<Actors> list = (List<Actors>) query.list();
return list; 
```

* * *

## 回答 #21

> 赞同：-2
> 
> 时间：2012-10-22T14:00:39.893

使用`DTO Design Pattern`. 它被用于`EJB 2.0`. 实体是容器管理的。`DTO Design Pattern`用来解决这个问题。但是，它现在可能会在应用程序单独开发时`Server Side`使用`Client Side`。`DTO`当`Server side`不想通过`Entity`注释传递/返回时使用`Client Side`.

DTO 示例：

个人实体.java

```
@Entity
public class PersonEntity {
    @Id
    private String id;
    private String address;

    public PersonEntity(){

    }
    public PersonEntity(String id, String address) {
        this.id = id;
        this.address = address;
    }
    //getter and setter

} 
```

PersonDTO.java

```
public class PersonDTO {
    private String id;
    private String address;

    public PersonDTO() {
    }
    public PersonDTO(String id, String address) {
        this.id = id;
        this.address = address;
    }

    //getter and setter 
} 
```

DTOBuilder.java

```
public class DTOBuilder() {
    public static PersonDTO buildPersonDTO(PersonEntity person) {
        return new PersonDTO(person.getId(). person.getAddress());
    }
} 
```

EntityBuilder.java <-- 它是需要的

```
public class EntityBuilder() {
    public static PersonEntity buildPersonEntity(PersonDTO person) {
        return new PersonEntity(person.getId(). person.getAddress());
    }
} 
```

# c# - 如何过滤数据表？

> ID：13012585
> 
> 赞同：83
> 
> 时间：2012-10-22T13:34:10.000
> 
> 标签：c#, asp.net, filter, datatable, dataset

我使用带有用户信息的 DataTable，我想在这个 DataTable 中搜索用户或用户列表。我试了一下，但它不起作用:(

这是我的 C# 代码：

```
 public DataTable GetEntriesBySearch(string username,string location,DataTable table)
        {
            list = null;
            list = table;

            string expression;
            string sortOrder;

            expression = "Nachname = 'test'";
            sortOrder = "nachname DESC";

            DataRow[] rows =  list.Select(expression, sortOrder);

            list = null; // for testing
            list = new DataTable(); // for testing

            foreach (DataRow row in rows)
            {
                list.ImportRow(row);
            }

            return list; 
        } 
```

* * *

## 回答 #1

> 赞同：127
> 
> 时间：2012-10-22T13:39:34.073

您可以使用数据视图。

```
DataView dv = new DataView(yourDatatable);
dv.RowFilter = "query"; // query example = "id = 10" 
```

[http://www.csharp-examples.net/dataview-rowfilter/](http://www.csharp-examples.net/dataview-rowfilter/)

* * *

## 回答 #2

> 赞同：117
> 
> 时间：2012-10-22T13:38:58.867

如果您至少使用 .NET 3.5，我建议您改用`Linq-To-DataTable`它，因为它更具可读性和功能：

```
DataTable tblFiltered = table.AsEnumerable()
          .Where(row => row.Field<String>("Nachname") == username
                   &&   row.Field<String>("Ort") == location)
          .OrderByDescending(row => row.Field<String>("Nachname"))
          .CopyToDataTable(); 
```

上面的代码只是一个示例，实际上您还有[更多可用的方法](http://msdn.microsoft.com/en-us/library/system.linq.enumerable_methods.aspx)。

请记住`using System.Linq;`为扩展方法添加对dll`AsEnumerable`的引用（ [How](https://stackoverflow.com/questions/30006757/how-to-add-a-reference-to-system-data-datasetextensions-to-a-web-site-ascx-cs-fi)）。`System.Data.DataSetExtensions`

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2014-03-13T10:53:57.813

用它：

```
.CopyToDataTable() 
```

例子：

```
string _sqlWhere = "Nachname = 'test'";
string _sqlOrder = "Nachname DESC";

DataTable _newDataTable = yurDateTable.Select(_sqlWhere, _sqlOrder).CopyToDataTable(); 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2018-05-03T23:30:06.810

有时您实际上想要返回 a`DataTable`而非 a `DataView`。所以`DataView`在我的情况下 a 并不好，我想很少有人会想要它。这是我以前做的

```
myDataTable.select("myquery").CopyToDataTable() 
```

这将过滤`myDataTable`哪个是 DataTable 并返回一个新的`DataTable`

希望有人会发现这很有用

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2015-03-21T03:37:49.943

对于在 VB.NET 中工作的任何人（以防万一）

```
Dim dv As DataView = yourDatatable.DefaultView

dv.RowFilter ="query" ' ex: "parentid = 0" 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2012-10-22T13:38:32.620

最好使用 DataView 来完成此任务。

您可以在这篇文章中找到使用它的示例：[如何在数据视图中过滤数据](https://stackoverflow.com/questions/10009675/how-to-filter-data-in-dataview)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-01-30T12:01:41.260

嗨，我们可以使用 ToLower 方法，有时它不是过滤器。

```
EmployeeId = Session["EmployeeID"].ToString();
var rows = dtCrewList.AsEnumerable().Where
   (row => row.Field<string>("EmployeeId").ToLower()== EmployeeId.ToLower());

   if (rows.Any())
   {
        tblFiltered = rows.CopyToDataTable<DataRow>();
   } 
```

# objective-c - iOS6 - 可靠地获取提醒和日历事件更新

> ID：13012586
> 
> 赞同：1
> 
> 时间：2012-10-22T13:34:11.047
> 
> 标签：objective-c, ios, cocoa-touch, calendar, reminders

`Reminders.app`我的应用程序正在从和事件数据中获取提醒数据`Calendar.app`。

我的应用程序的数据需要与 Reminder.app 和 Calendar.app 同步，我该如何实现？

目前，我正在保存从属性中获取的日历事件的 ID `- eventIdentifier`（`EKEvent`我也在保存事件标题）。[文档](http://developer.apple.com/library/ios/documentation/EventKit/Reference/EKEventClassRef/Reference/Reference.html#//apple_ref/occ/instp/EKEvent/eventIdentifier)指出，如果事件的日历发生变化，此 ID 很可能会发生变化。那么如果用户更改事件的日历，我将如何处理？

我是否应该在用户的日历中搜索活动标题，如果找到，然后更新此活动的 ID？这似乎是我唯一的选择。

处理提醒似乎不[存在](http://developer.apple.com/library/ios/#documentation/EventKit/Reference/EKReminderClassRef/Reference/Reference.html#//apple_ref/occ/cl/EKReminder)提醒的 ID 属性。虽然`EKReminder`继承自`EKCalendarItem`which 有两个 ID 属性[calendarItemIdentifier](http://developer.apple.com/library/ios/documentation/EventKit/Reference/EKCalendarItemClassRef/Reference/Reference.html#//apple_ref/occ/instp/EKCalendarItem/calendarItemIdentifier)和[calendarItemExternalIdentifier](http://developer.apple.com/library/ios/documentation/EventKit/Reference/EKCalendarItemClassRef/Reference/Reference.html#//apple_ref/occ/instp/EKCalendarItem/calendarItemExternalIdentifier)这里我不确定使用哪一个。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T09:24:01.803

我最终将`calendarItemIdentifier`as ID 用于提醒事件。如果 EKEventStore 中不再存在该 ID，我将使用事件的标题和其他数据在 EKEventStore 中查找事件以尝试找到匹配项。这绝对不是万无一失的，但它是你手中的东西。

# c# - 从 Dispatcher 上调用的异步操作返回值

> ID：13012587
> 
> 赞同：2
> 
> 时间：2012-10-22T13:34:13.927
> 
> 标签：c#, wpf, asynchronous, task-parallel-library, dispatcher

我正在开发一个 WPF XBAP 应用程序，它使用 BrowserInteropHelper 通过 JavaScript 向用户提供 API。在以新的 async-await 方式重写托管部分后，需要等待异步操作完成，而不使调用方法 async Task 本身。我有 ：

```
public string SyncMethod(object parameter)
{
    var sender = CurrentPage as MainView; // interop
    var result = string.Empty;
    if (sender != null)
    sender.Dispatcher.Invoke(DispatcherPriority.Normal,
                                 new Action(async () =>
                                                {
                                                    try
                                                    {
                                                        result = await sender.AsyncMethod(parameter.ToString());
                                                    }
                                                    catch (Exception exception)
                                                    {
                                                        result = exception.Message;
                                                    }
                                                }));
    return result;        
} 
```

此方法返回 string.Empty 因为这发生在执行之后。我尝试将此操作分配给 DispatcherOperation 并执行 while(dispatcherOperation.Status != Completed) { Wait(); }，但即使在执行之后，该值仍然是空的。dispatcherOperation.Task.Wait() 或 dispatcherOperation.Task.ContinueWith() 也没有帮助。
***编辑***
也试过

```
var op = sender.Dispatcher.BeginInvoke(...);
op.Completed += (s, e) => { var t = result; }; 
```

但是 t 也是空的，因为赋值发生在等待异步方法之前。
***编辑***
长话短说，SyncMethod JavaScript 互操作处理程序帮助程序包装器，它运行的所有操作都必须在 Dispatcher 上。AsyncMethod 是 async Task< T > 并且在从应用程序内部（即在某个按钮处理程序内部）执行和等待时可以完美运行。它有很多与 UI 相关的逻辑（显示状态进度条、更改光标等）。
***编辑***
AsyncMethod ：

```
public async Task<string> AsyncMethod(string input)
{
    UIHelpers.SetBusyState(); // overriding mouse cursor via Application.Current.Dispatcher
    ProgressText = string.Empty; // viewmodel property reflected in ui
    var tasksInputData = ParseInput(input);    
    var tasksList = new List<Task>();
    foreach (var taskInputDataObject in tasksInputData)
    {
        var currentTask = Task.Factory.StartNew(() =>
        {            
            using (var a = new AutoBusyHandler("Running operation" + taskInputData.OperationName))
            { // setting busy property true/false via Application.Current.Dispatcher
                var databaseOperationResult = DAL.SomeLongRunningMethod(taskInputDataObject);
                ProgressText += databaseOperationResult;
            }
        });
        tasksList.Add(insertCurrentRecordTask);
    }    
    var allTasksFinished = Task.Factory.ContinueWhenAll(tasksList.ToArray(), (list) =>
    {        
        return ProgressText;
    });
    return await allTasksFinished;    
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-22T15:00:01.963

> 在以新的 async-await 方式重写托管部分后，需要等待异步操作完成，而不使调用方法 async Task 本身。

这是您可以尝试做的最困难的事情之一。

> AsyncMethod 是 async Task< T > 并且在从应用程序内部（即在某个按钮处理程序内部）执行和等待时可以完美运行。它有很多依赖于 UI 的逻辑

而这种情况几乎是不可能的。

* * *

问题是您需要阻止`SyncMethod`在 UI 线程上运行的线程，同时允许`AsyncMethod`调度到 UI 消息队列。

您可以采取以下几种方法：

1.  阻止`Task`使用`Wait`or `Result`。您可以通过使用in来避免[我的博客中描述的死锁问题](http://nitoprograms.blogspot.com/2012/07/dont-block-on-async-code.html)。这意味着必须重构以**将**依赖于 UI 的逻辑替换为其他非阻塞回调。`ConfigureAwait(false)``AsyncMethod``AsyncMethod`**`IProgress<T>`**
***   安装嵌套消息循环。这应该可行，但您必须考虑所有重入的后果。**

 **就个人而言，我认为（1）更干净。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-22T13:52:24.913

做这个：

```
var are = new AutoResetEvent(true);
sender.Dispatcher.Invoke(DispatcherPriority.Normal,                                      
        new Action(async () =>
        {
           try { ... } catch { ... } finally { are.Set(); }
        }));

are.WaitOne();
return result; 
```

are.WaitOne() 将告诉 AutoResetEvent 等待，直到它发出信号，这将在调度程序操作到达调用 are.Set() 的 finally 块时发生。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2018-11-12T14:47:28.417

这为我解决了。

[为调用者添加任务延迟完成](https://social.msdn.microsoft.com/Forums/sqlserver/en-US/ccb5a935-0912-40c4-8b68-db08c9d94474/c-wpf-multithreading-cannot-return-the-actual-value-from-dispatcherbegininvoke-in-vs2013?forum=wpf)。

```
public string SyncMethod(object parameter)  
{
    var sender = CurrentPage as MainView; // interop
    var result = string.Empty;

    if (sender != null)
    {
        await sender.Dispatcher.Invoke(DispatcherPriority.Normal,
            new Func<Task>(async () =>
            {
                try
                {
                    result = await sender.AsyncMethod(parameter.ToString());
                }
                catch (Exception exception)
                {
                    result = exception.Message;
                }
            }));
    }

    await Task.Delay(200); // <-- Here
    return result;        
} 
```**

# qt - QMl ListView 元素到 C++

> ID：13012589
> 
> 赞同：0
> 
> 时间：2012-10-22T13:34:32.837
> 
> 标签：qt, listview, checkbox, qml, qlistwidget

如何在 QML ListView 中选择一些元素并将所选 ListItemText 的列表发送到 C++ 中的 QListWidget？

我使用“联系人模型”作为 ListView 的模型。该组件有一个 ListItem。ListItem 有一个 Image（联系人头像）、一个 ListItemText（联系人姓名）和一个 CheckBox。MouseArea 填充 ListItem。在单击 ListItem 时，我可以选中或取消选中 CheckBox。

另外，我还有一个问题。在检查了几个元素之后，如果 ListView 有移动（即，当我向上或向下滚动时），那么所有被选中的元素都会自动取消选中。

编辑：

**主窗口.cpp**

```
void MainWindow::createList()
{
QContactManager *contactManager = new QContactManager("symbian");    
QList<QContactLocalId> contactIds = contactManager->contactIds();
QContact currContact;
QStandardItemModel *model = new QStandardItemModel();
QImage m_thumbnail;

foreach (const QContactLocalId& id, contactIds)
{
    currContact = contactManager->contact(id);
    if(currContact.type() == QContactType::TypeContact)
    {
        QContactThumbnail avatar(currContact.detail(QContactThumbnail::DefinitionName));
        m_thumbnail = avatar.thumbnail();

        QStandardItem *items = new QStandardItem();
        //items->setData(currContact.displayLabel(), Qt::DisplayRole);
        //items->setData(QPixmap::fromImage(m_thumbnail), Qt::DecorationRole);
        items->setText(currContact.displayLabel());

        if(m_thumbnail.isNull())
        {
            items->setIcon(contactIcon);
        }
        else
        {
            items->setIcon(QPixmap::fromImage(m_thumbnail));
        }
        model->appendRow(items);
    }
}
}

void MainWindow::viewQml()
{
        QDeclarativeView *qmlView = new QDeclarativeView;
        qmlView->setSource(QUrl("qrc:/contacts.qml"));
        qmlView->rootContext()->setContextProperty("stdModel", model);
        qmlView->show();
} 
```

**联系人.qml**

```
ListView {
id: listView
anchors.top: statusBar.bottom
anchors.right: parent.right
anchors.left: parent.left
anchors.bottom: toolBar.top
clip: true
model: stdModel
//delegate: contactListDelegate
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T20:49:56.923

首先，请提供一些代码，以便我们更好地了解您想要实现的目标以及您已经尝试过的目标。

关于您的第二个问题，当您向上和向下滚动时，所选元素未被选中，因为正如文档所述：

> “代表会根据需要进行实例化，并且可能随时被销毁。状态永远不应该存储在代表中。”

因此，当您的委托被滚动出视图时，它可能会被销毁，而当它返回视图时，它会以未选中的默认状态创建。

如果您想在代理滚动出视图时保留它，您可以查看缓存代理。您可以通过增加 QML 列表视图的 cacheBuffer 大小来缓存代理滚动出视图。**但是，请注意，如果列表中有很多项目，则增加 cacheBuffer 不是一个好主意。您将耗尽内存。一个更好的主意是使用 C++ 实现您的列表视图和列表视图模型。**如果您不明白我的意思，请查看[QAbstractListModel 类](http://doc.qt.digia.com/4.7/qabstractlistmodel.html)。

# php - 跨浏览器兼容性标签

> ID：13012591
> 
> 赞同：0
> 
> 时间：2012-10-22T13:34:39.767
> 
> 标签：php, html, compatibility

我在使用此页面时遇到问题 [请参阅下面的代码]，以及它的跨浏览器兼容性。它适用于 Safari 和 Chrome，但不适用于 IE 和 Firefox。我想知道这是否与输入标签有关。

该页面可在[http://www.arcomis.com/order/basket](http://www.arcomis.com/order/basket)查看。不起作用的功能是刷新/更新份数、删除按钮以及“使用 Google 购买”按钮。（要查看这些功能，您可能需要在购物篮中添加一些内容，最好使用此页面完成：[http](http://www.arcomis.com/catalogue/view/id/4852) ://www.arcomis.com/catalogue/view/id/4852 ；单击 RHS 上的订单）。

如果有更好的方法让我显示代码，请告诉我，如果您需要登录详细信息，请告诉我！谢谢，我对这一切有点新手。

**使用 exttest 和密码登录：testing**

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
    <html xmlns="http://www.w3.org/1999/xhtml"> 
    <head>  
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
      <meta property="og:image" content="http://www.arcomis.com/img/logo_top.gif"/> 
      <title>Arcomis : Your Basket</title>

      <link href="/css/main.css" media="screen,projection,print" rel="stylesheet" type="text/css" />
      <link href="/css/print.css" media="print" rel="stylesheet" type="text/css" />  

  </head> 
  <body class="tundra">
    <div id="headBar">
        <div id="top_container">

            <div id="navigation_top">
                <div id="login">
                    <img src="/img/user.gif" width="13" height="27"> 
                    <span id="user_name">sarahgupta</span>
                    <a href="/account">manage account</a> 
                    <a href="/login/logout">logout</a>

                </div>
                <img src="/img/tabs/u_home.gif" width="93px" height="27px" class="nav_icon_u_hidden"/>
                <img src="/img/tabs/u_commissioning.gif" width="153px" height="27px" class="nav_icon_u_hidden"/>
                <a href="/publishing"><img src="/img/tabs/u_publishing.gif" width="104px" height="27px" class="nav_icon_u"/></a>
                <img src="/img/tabs/u_news.gif" width="93px" height="27px" class="nav_icon_u_hidden"/>
                <img src="/img/tabs/u_about.gif" width="93px" height="27px" class="nav_icon_u_hidden"/>         
            </div>
            <div id="top_rightcol"><a href="/"><img src="/img/logo_top.gif" width="128px" height="94px"/></a></div>
        </div>
    </div>
    <div id="mid_container">
        <div id="navigation">
            <a href="/ "><img src="/img/tabs/d_home.gif" width="91px" height="33px" class="nav_icon_d"/></a>
            <a href="/commissioning"><img src="/img/tabs/d_commissioning.gif" width="151px" height="33px" class="nav_icon_d"/></a>
            <a href="/publishing"><img src="/img/tabs/d_publishing.gif" width="102px" height="33px" class="nav_icon_d_hidden"/></a>
            <a href="/news"><img src="/img/tabs/d_news.gif" width="91px" height="33px" class="nav_icon_d"/></a>
            <a href="/about"><img src="/img/tabs/d_about.gif" width="91px" height="33px" class="nav_icon_d"/></a>           
        </div>
        <div id="mid_rightcol"><a href="/"><img src="/img/logo_bottom.gif" width="130px" height="35px"/></a></div>
    </div>  
    <div id="main_container">
        <div id="wrapper">
            <div id="content">
                <h2>Your basket items</h2>

                The following items are in your basket.<br/><br/>

                <form action=" /order/basket" method="POST">
                    <table class="dataTable">
                        <thead>
                            <tr>
                                <td width="55%">Item</td> <td width="10%">Type</td><td width="10%" align="center">Price/copy</td><td width="10%">Copies</td><td width="15%">Price</td><td width="10%">Remove</td>
                            </tr>
                        </thead>

                        <tbody>
                            <tr class="alt2" valign="middle">
                                <td>
                                    The Arcomis Flute Album
                                </td>
                                <td align="center">
                                    Download

                                </td>
                                <td align="center">
                                    &pound;2.79
                                </td>
                                <td align="center">
                                    <input type="text" name="copies_0" value="3" style="width:20px;font-size:8pt;border:0;"/><input type="image" src="/img/buttons/update.gif" alt="update number of copies/licenses" title="update number of copies/licenses" name="update" value="0"/>

                                </td>
                                <td  align="right">
                                    &pound;8.37
                                </td>
                                <td align="center"><input type="image" src="/img/buttons/remove.gif" alt="remove item from basket" title="remove item from basket" name="remove" value="0"/>

                                </td>
                            </tr>
                            <tr class="alt1" valign="middle">
                                <td>
                                    Ghost Dances   
                                </td>
                                <td align="center">
                                    Download

                                </td>
                                <td align="center">
                                    &pound;4.00
                                </td>
                                <td align="center">
                                    <input type="text" name="copies_1" value="1" style="width:20px;font-size:8pt;border:0;"/><input type="image" src="/img/buttons/update.gif" alt="update number of copies/licenses" title="update number of copies/licenses" name="update" value="1"/>

                                </td>
                                <td  align="right">
                                    &pound;4.00
                                </td>
                                <td align="center"><input type="image" src="/img/buttons/remove.gif" alt="remove item from basket" title="remove item from basket" name="remove" value="1"/>

                                </td>
                            </tr>
                        </tbody>
                        <tr class="postage">
                            <td colspan="2" style="background:#ffffff"></td>
                            <td colspan="2"><a href="/order/delivery">Postage</a></td>
                            <td  align="right">&pound;0.00</td>
                            <td style="background:#ffffff"></td>
                        </tr>
                        <tr class="total">
                            <td colspan="2" style="background:#ffffff"></td>
                            <td colspan="2">TOTAL</td>
                            <td align="right">&pound;12.37</td>
                            <td style="background:#ffffff"></td>
                        </tr>
                    </table>
                    <br/>
                    <br/>
                    If this completes your order please proceed to the payments area which is operated by Google Checkout on behalf of Arcomis.
                    <br/>
                    <br/>       
                    <a href="/catalogue" class="option" style="background: url(/img/icons/explore.gif) left center no-repeat">Return to catalogue</a>
                    <input type="image" src="https://checkout.google.com/buttons/checkout.gif?merchant_id=759193895597719&w=168&h=44&style=white&variant=text&loc=en_GB" alt="checkout" name="checkout" value="checkout"/>
                </form>

                <br/>
                <br/>
                <b>N.B.</b> We have recently become aware that a web browser upgrade has been causing problems with the purchasing and downloading of scores from the Arcomis catalogue. If a problem occurs please <a href="mailto:info@arcomis.com">contact us</a> directly to resolve the issue.                 
            </div>
            <div id="main_rightcol">

            </div>
            <div id="cleardiv"></div>
        </div>

        <div id="footer1">
            <a href="/">Home</a> 
            <a href="/commissioning">Commissioning</a>  
            <a href="/publishing">Publishing</a> 
            <a href="/news">News</a> 
            <a href="/about">About us</a>
            <a href="/about/terms">Terms of Use</a>
        </div>
        <div id="footer2"><p>Arcomis Ltd - Company Number: 6436170 - Registered Address: CBTC, Senghenydd Road, Cardiff, CF24 4AY</p></div>
        <script type="text/javascript">
        var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." :
            "http://www.");
        document.write(unescape("%3Cscript src='" + gaJsHost +
            "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
        </script>
        <script type="text/javascript">
        try {
            var pageTracker = _gat._getTracker("UA-8254016-1");
            pageTracker._trackPageview();
        } catch(err) {}</script>                        
    </div>

</body>
</html> 
```

PHP 是：

```
<? $this->headTitle('Your Basket') ?>
<h2>Your basket items</h2>

The following items are in your basket.<br/>
<br/>

<?php if($this->basket->isEmpty()){?> Your basket is empty. <?php } else {?>

<form action=" <?= $this->url(array('controller' => 'order','action' => 'basket'))?>" method="POST">
    <table class="dataTable">
        <thead>
            <tr>
                <td width="55%">Item</td>
                <td width="10%">Type</td>
                <td width="10%" align="center">Price/copy</td>
                <td width="10%">Copies</td>
                <td width="15%">Price</td>
                <td width="10%">Remove</td>
            </tr>
        </thead>

        <tbody>
            <?php
            $counter = 0; foreach($this->basket->items as $key => $item)
            {
                $counter++;
                $rowClass = ( $counter % 2 == 0 ) ? ('alt1') : ('alt2'); ?>
                <tr class="<?=$rowClass ?>" valign="middle">
                    <td>
                        <?=$item->pieceTitle?>
                    </td>
                    <td align="center">
                        <? if($item->isPrinted){?> Printed <?} else {?> Download <?}?>
                    </td>
                    <td align="center"> &pound;<?=number_format($item->piecePrice,2)?>
                    </td>
                    <td align="center">
                        <input type="text" name="copies_<?=$key//$item->pieceID?>" value="<?=$item->copies?>" style="width:20px;font-size:8pt;border:0;"/>
                        <input type="image" src="<?

                        =$this->getBase()?>/img/buttons/update.gif" alt="update number of copies/licenses" title="update number of copies/licenses" name="update" value="<?=$key//$item->pieceID?>"/>
                    </td>
                    <td  align="right"> &pound;<?=number_format($item->getTotalPieceCost(),2)?>
                    </td>
                    <td align="center">
                        <input type="image" src="<?=$this->getBase()?>/img/buttons/remove.gif" alt="remove item from basket" title="remove item from basket" name="remove" 

                        value="<?=$key//$item->pieceID?>"/>
                    </td>
                </tr>
                <?php
            }  ?>
        </tbody>
        <tr class="postage">
            <td colspan="2" style="background:#ffffff">
            </td>
            <td colspan="2">
                <a href="<?= $this->url(array('controller' => 'order','action' => 'delivery'))?>">Postage</a>
            </td>
            <td  align="right">&pound;<?=number_format($this->basket->getTotalPPCost(),2)?>
            </td>
            <td style="background:#ffffff">
            </td>
        </tr>
        <tr class="total">
            <td colspan="2" style="background:#ffffff">
            </td>
            <td colspan="2">TOTAL</td>
            <td align="right">&pound;<?=number_format($this->basket->getTotalCost(),2)?>
            </td>
            <td style="background:#ffffff">
            </td>
        </tr>
    </table>
    <br/>
    <br/> If this completes your order please proceed to the payments area which is operated by Google Checkout on behalf of Arcomis. <br/>
    <br/>
    <a href="<?= $this->url(array('controller' => 'catalogue'),null, true)?>" class="option" style="background: url(<?=$this->getBase()?>/img/icons/explore.gif) left center no-repeat">Return to catalogue</a>
    <input type="image" src="https://checkout.google.com/buttons/checkout.gif?merchant_id=759193895597719&w=168&h=44&style=white&variant=text&loc=en_GB" alt="checkout" name="checkout" value="checkout"/>
</form>

<?php
}  ?>
<br/>
<br/>
<b>N.B.</b> We have recently become aware that a web browser upgrade has been causing problems with the purchasing and downloading of scores from the Arcomis catalogue. If a problem 

occurs please <a href="mailto:info@arcomis.com">contact us</a> directly to resolve the issue. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T20:19:59.973

在 Firefox、Chrome 和 IE 中尝试该页面。在 Fiddler2 等 HTTP 检查器工具中观察并比较 POST 请求。

Chrome 发送`remove=0`并`update=0`单击删除/更新按钮时，但 Firefox 没有。您的处理代码可能正在寻找`$_POST['remove']`or `$_POST['update']`。

有关可能的解决方案，请参阅[HTML Input (type=image) not working on Firefox 4](https://stackoverflow.com/questions/6402380/html-input-type-image-not-working-on-firefox-4)。

# c - 使用指针而不是索引进行排序

> ID：13012594
> 
> 赞同：2
> 
> 时间：2012-10-22T13:34:51.987
> 
> 标签：c, arrays, sorting

我正在尝试使用指针而不是索引对指针数组进行排序，但我不完全确定如何执行此操作。我一直在谷歌搜索，但没有找到任何相关的东西。

我已经使用索引进行了排序，但我也想通过使用指针来完成。目前该功能如下所示：

```
void sort(int *pointer, int size){
    int i, j, temp;
    for(i = 0; i < size; i++){
        for(j = i + 1; j < size; j++){
            if(pointer[j] < pointer[i]){
                temp = pointer[j];
                pointer[j] = pointer[i];
                pointer[i] = temp;
            }
        }
    }
} 
```

如您所见，正在使用数组索引，我将如何仅使用指针来执行此操作？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-22T13:37:07.083

这会很烦人。您需要使用在 C 中的事实，`a[i] == *(a + i)`因此：

```
if(pointer[j] < pointer[j]) 
```

会成为

```
if(*(pointer + j) < *(pointer + j)) 
```

等等。真的没有什么区别，只是索引代码更容易阅读。:)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-22T13:48:59.713

您可以使用指针替换索引：

```
void sort(int *pointer, int size){
    int *i, *j, temp;
    for(i = pointer; i < pointer + size; i++){
        for(j = i + 1; j < pointer + size; j++){
            if(*j < *i){
                temp = *j;
                *j = *i;
                *i = temp;
            }
        }
    }
} 
```

理论上，这应该比每次需要访问元素时添加索引要快。在实践中，大多数编译器都会优化您的原始循环，以便以这种方式使用指针。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-22T13:43:41.980

方括号 ( `[]`) 实际上只是一个“添加和引用”运算符。因此，要转换您的代码，请将其替换`something[x]`为`*(something+x)`

```
void sort(int *pointer, int size){
  int i, j, temp;
  for(i = 0; i < size; i++){
     for(j = i + 1; j < size; j++){
         if(*(pointer+j) < *(pointer+i)){
             temp = *(pointer+j);
             *(pointer+j) = *(pointer+i);
             *(pointer+i) = temp;
         }
     }
  } 
} 
```

# php - 对处理类之间的变量感到困惑

> ID：13012595
> 
> 赞同：-2
> 
> 时间：2012-10-22T13:34:52.547
> 
> 标签：php, class, variables

我有这样的课：

```
class sqlClass    {
  var $myvar = "test value 1"
  public function test01() {
    global $myvar;
    //some operations here
    $myvar = "test value 2"
    return true;
  }
} 
```

在其他文件中，我有这个 PHP 脚本：

```
include_once('functions.php'); // where my class is
$data = new sqlClass();
if ($data->test01()) {
  echo $data->myvar;
} else { echo "No value"; } 
```

那么在这个例子`test01()`中总是正确的，所以我保证会`$myvar`发生变化，但是，当我`$myvar`在类中执行应该改变它的值的函数之后打印时，它会打印旧值“测试值 1”而不是“测试值 2”。那么，我错过了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-22T13:38:39.657

好的，首先你不应该使用`var`关键字。那就是你不应该使用的 php4，除非你正在维护一个遗留应用程序。相反，您使用[可见性关键字之一 - `public`、`protected`或`private`](http://php.net/manual/en/language.oop5.visibility.php)。

其次，您不应该`global`在没有需要的类中使用。要访问您使用的类成员，`$this->memberName`如果您需要访问类外部的变量，您应该将它们作为参数传递给您的方法或构造函数。

所以考虑到这就是你的代码应该是什么样子：

```
class sqlClass    {
  public $myvar = "test value 1";

  public function test01() {

    //some operations here
    $this->myvar = "test value 2"

    return true;
  }
} 
```

[话虽如此，我会阅读php5 手册中](http://www.php.net/manual/en/oop5.intro.php)关于 OOP 的整个部分

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-22T13:38:12.667

要更改对象的实例变量，请使用`$this->`：

```
class sqlClass {

    public $myvar = "test value 1"

    public function test01() {
      $this->myvar = "test value 2"
      return true;
    }

} 
```

这将改变变量`$data->myvar`。你正在做什么意味着它正在改变你输出`global`的全局变量. 它与对象无关。`myvar``echo $myvar``$data`

# sql - 表索引会影响 SQL 连接查询的执行时间吗？

> ID：13012596
> 
> 赞同：2
> 
> 时间：2012-10-22T13:34:54.127
> 
> 标签：sql, join, sql-server-2008-r2

我有一个存储过程，其中包括 4-5 个表连接操作，SP 我在两个不同的数据库上执行（所有表定义都相同），然后在 DB-1 中，SP 需要 20-25 秒，在 DB-2 SP 中需要 1 秒在我重建 DB-1 索引之后执行，然后 DB-1 的 SP 与以前相比可以快速工作。

那么连接和表索引之间有什么关系吗？如果是，那么如何解决此类问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-22T13:55:50.250

我理解您询问使用索引是否会影响连接性能的问题。答案是响亮的“是”。

通常，连接到只需要几行的表将使用索引（如果存在）。

连接到需要大部分表的表将导致“全表扫描”（Oracle 术语），其中 DBMS 将使用此作为索引构造连接键的哈希，以随后探测正确的值以加入时使用。

请参阅[http://en.wikipedia.org/wiki/Join_%28SQL%29#Implementation](http://en.wikipedia.org/wiki/Join_%28SQL%29#Implementation)以及它引用的关于连接算法的文章，以获得对这些的良好概述。

# customization - MediaWiki 中的项目符号列表呈现是否可以通过单个项目符号点的添加/插入功能进行更改？

> ID：13012597
> 
> 赞同：2
> 
> 时间：2012-10-22T13:34:54.343
> 
> 标签：customization, mediawiki, bulletedlist

我对 MediaWiki 完全陌生，所以我担心我的问题可能看起来很古怪！

我正在尝试创建一个社区可编辑站点，其中每个主题页面将仅包含重要点（作为可扩展点）而不是文章/段落。一些点可能有额外的信息，如解释、示例、图片等（可能是嵌套的项目符号？），只有在展开点时才能将其视为选项卡。

举个简单的例子，标题为 Lion 的页面没有任何信息框或段落，看起来像这样：

```
狮子
 ____________________________________________________________________

  + 狮子是食肉动物
  + 狮子是高度社交的动物
  - 成年雄狮通常有鬃毛
                     _______
                    | |
         ___________| 为什么 |_________
        | 东西| | 图片 |
        |___________| |_________|___________
        | 鬃毛使狮子看起来更大而且|
        | 保护他的脖子、喉咙和头部。|
        |_________________________________________|

  +狮子在协调的群体中狩猎

```

（无法插入图片，因为我是新用户）

整个页面将像往常一样可编辑，但由于该页面仅包含点和子点，我希望为各个点添加/编辑/插入/删除按钮。单击添加/插入/编辑按钮时，将在模式窗口中打开一个表单，该窗口将允许用户添加/编辑该点以及可选的额外信息。

所以我认为我需要对解析/渲染以及编辑相关更改的代码进行更改。此外，如果嵌套项目符号不能用于选项卡，那么也许我需要引入一些新的格式规则。

我的问题是，MediaWiki 适合这个要求吗？
是否可以通过简单的代码更改来实现所有这些/一些，而不会弄乱核心？
如果是的话，你能给我一些关于如何做的指示吗？
如果不能，你能建议一些替代方案吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-27T10:49:28.667

关于可编辑点和子点的创建：您可以使用标题来满足您的需求。
要点将是标题（= 要点 1 = ），子点将是子标题（ == 子点 2 == ）。
这样，您将在每个点和子点的右侧都有一个编辑链接，以仅编辑您想要的点。
如果你想折叠/扩展你的观点，我建议你看看这个文档：[Collapsible elements](http://www.mediawiki.org/wiki/Manual%3aCollapsible_elements)。还有一个带有[实时示例](http://test.wikipedia.org/wiki/User%3aKrinkle/CollapsingTestpageMw)的页面。
最后，如果您想创建自己的标签（例如创建标签），请查看此文档：[标签扩展](http://www.mediawiki.org/wiki/Manual%3aTag_extensions)。

# php - 打破 PHP 中的嵌套循环

> ID：13012598
> 
> 赞同：-1
> 
> 时间：2012-10-22T13:35:09.970
> 
> 标签：php, for-loop, while-loop, break, nested-loops

我有一个嵌套循环，即

```
while()
{
    for()
    {

    }
} 
```

在我的页面中，我试图打破 for 循环并进入 while 循环而不退出它。我试过了`break;`，这些都没用。这是代码：`break 1;``goto xxx;`

```
while( $results = pg_fetch_assoc( $result ) )
{

    $url = $results['url'];
    for( $i = 0; $i < ($recordnum - 1); $i++ )
    {

        $urlpopup = $foldername . "/" . $namecomingform[$i];

        if( $url == $urlpopup )
        {

            $isthererecord = 'yes';

            goto getoutoffor;
        }
        else
        {

            $isthererecord = 'no';
        }
    }//end of for
    getoutoffor:

    if( $isthererecord == 'no' )
    {

        $sql = "UPDATE pictures SET erased='1' WHERE url='" . $url . "'";

        $run = pg_query( $sqlconnection, $sql );
    }
} //end of while 
```

似乎它只检查数据库中的一条记录。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-22T13:51:03.737

您可能关心这部分：

```
$url = $results['url'];
for( $i = 0; $i < ($recordnum - 1); $i++ )
{

    $urlpopup = $foldername . "/" . $namecomingform[$i];

    if( $url == $urlpopup )
    {

        $isthererecord = 'yes';

        goto getoutoffor;
    }
    else
    {

        $isthererecord = 'no';
    }
}//end of for
getoutoffor: 
```

阅读。您在这里循环只是为了测试末尾的数字`$url`是否介于`0`和之间`$recordnum - 1`。而是从字符串中提取前缀和数字。比较前缀，如果匹配，检查数字是否在该范围内。

这样做还可以进一步了解您在代码中遇到的逻辑问题。从您问题的措辞看来，您在这里找错了地方，所以我希望我的回答对您有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-25T04:01:50.823

我知道我来晚了，但我遇到了类似的问题。适用于您的情况，我要做的是将代码更改为以下内容：

```
$LoopBreak = 'no';
while( $results = pg_fetch_assoc( $result ) )
{
if ($LoopBreak == 'yes') {
break;//Insert break statement here
}

else {    //This is First else

$url = $results['url'];
for( $i = 0; $i < ($recordnum - 1); $i++ )
{
    $urlpopup = $foldername . "/" . $namecomingform[$i];

    if( $url == $urlpopup )
    {
        $isthererecord = 'yes';
        $LoopBreak = 'yes'; //Variable added in place of break here
    }
    else
    {
        $isthererecord = 'no';
    }
}//end of for

if( $isthererecord == 'no' )
{
    $sql = "UPDATE pictures SET erased='1' WHERE url='" . $url . "'";
    $run = pg_query( $sqlconnection, $sql );
}

}//End First else
} //end of while 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-22T13:52:01.717

不是处理这个问题的最好方法，但你可以在你的 FOR 循环中添加一个额外的条件，（**&& $isthererecord != 'yes'**）并在进入循环之前初始化**$isthererecord**变量，所以你修改的代码最终会像以下：

```
$isthererecord = '';
while ( $results = pg_fetch_assoc( $result ) ) {
    $url = $sorgusonucu['url'];
    for ( $i = 0; $i < ( $recordnum - 1 ) && $isthererecord != 'yes'; $i++ ) {
        $urlpopup = $foldername . "/" . $namecomingform[ $i ];

        if ( $url == $urlpopup ) {
            $isthererecord = 'yes';
            continue;
        }
        else {
            $isthererecord = 'no';
        }
    }

    if ( $isthererecord == 'no' ) {
        $sql = "UPDATE pictures SET erased = '1' WHERE url = '" . $url . "'";
        $run = pg_query( $sqlconnection, $sql );
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-20T07:28:04.780

在 for 循环中永远不需要 else

```
while ( $results = pg_fetch_assoc( $result ) ) {
    $url = $sorgusonucu['url'];
    for ( $i = 0; $i < ( $recordnum - 1 ) && $isthererecord != 'yes'; $i++ ) {
        $urlpopup = $foldername . "/" . $namecomingform[ $i ];

        if ( $url === $urlpopup ) {
            $sql = "UPDATE pictures SET erased = '1' WHERE url = '" . $url . "';";
            $run = pg_query( $sqlconnection, $sql );
            break;
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-22T13:50:26.333

正如其他人所说，`break;`是你应该使用的。如果您的代码不能与 break; 一起使用，那么很可能是其他问题，例如 if 语句检查或 for 循环中的条件从未被满足（这意味着 for 循环甚至永远不会启动） . 你真的应该更多地调试你的代码。**但不要使用`goto`**. 利用`break;`

假设所有变量都是正确的，下面的代码应该真的可以工作：

```
while( $results = pg_fetch_assoc( $result ) )
{
    $url = $results['url'];
    for( $i = 0; $i < ($recordnum - 1); $i++ )
    {
        $urlpopup = $foldername . "/" . $namecomingform[$i];

        if( $url == $urlpopup )
        {
            $isthererecord = 'yes';
            break;
        }
        else
        {
            $isthererecord = 'no';
        }
    }//end of for

    if( $isthererecord == 'no' )
    {
        $sql = "UPDATE pictures SET erased='1' WHERE url='" . $url . "'";
        $run = pg_query( $sqlconnection, $sql );
    }
} //end of while 
```

# wordpress - wp_editor 中的 TinyMCE 编辑器正在删除我的 html 标签

> ID：13012606
> 
> 赞同：2
> 
> 时间：2012-10-22T13:35:34.940
> 
> 标签：wordpress, editor, tinymce, html

如何将 wp_editor 中的 tinyMCE 编辑器设置为不修改/替换初始内容的 html 标签？

我正在加载带有 < b > 标签的 html 内容（我知道它们已被弃用，但我需要它们）并且 tinyMCE 编辑器正在替换它们。

我尝试了几件事，但没有成功。我有点沮丧。我需要帮助。

我需要的是编辑器不会更改加载的 html 内容。

对不起，我的英语不好！这不是我的母语。

提前致谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T13:43:04.827

看起来 tinymce 剥离了一些 html 标签，tinymce 无法识别为“有效”。您将需要设置您的 tinymce 配置以保留这些 html 元素（使它们有效）。

为此，有以下 tinymce 设置：

*   [valid_elements](http://www.tinymce.com/wiki.php/Configuration%3avalid_children)（定义哪些 html 元素是有效的 + 有效属性）
*   [valid_children](http://www.tinymce.com/wiki.php/Configuration%3avalid_elements)（定义父元素和子元素的哪些组合是有效的）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-21T10:50:07.780

只需将属性更改为

```
 valid_children : "+a[div|h1|h2|h3|h4|h5|h6|p|#text]", (defines which html elements are valid + valid attributes)
    valid_elements : '*[*]', (defines which combinations of parent and child elements are valid) 
```

# sharepoint-2010 - 将 Sharepoint 日历与 Google 日历同步

> ID：13012607
> 
> 赞同：1
> 
> 时间：2012-10-22T13:35:35.917
> 
> 标签：sharepoint-2010

如何将 SharePoint 2010 日历与谷歌日历同步，除了 Outlook 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T13:47:21.177

正如这篇文章中提到的，[Sharepoint Calendar 与 Google Calendar 同步](https://stackoverflow.com/questions/7382897/sharepoint-calendar-sync-with-google-calendar) 。Sharepoint 不提供内置功能，可让您与 Google 日历同步。

# wso2 - AS 5.0.0 中的租户问题

> ID：13012608
> 
> 赞同：0
> 
> 时间：2012-10-22T13:35:37.450
> 
> 标签：wso2, multi-tenant, wso2carbon

如果我登录到tenant1 并尝试使用tenant2 的服务，我会看到此错误。

```
[2012-10-20 22:39:29,050] @tenant2 [1] [Application Server]ERROR {org.wso2.carbon.base.CarbonContextHolderBase} -  Trying to set the domain from tenant1 to tenant2
java.lang.IllegalStateException: Trying to set the domain from tenant1 to tenant2
        at org.wso2.carbon.base.CarbonContextHolderBase.setTenantDomain(CarbonContextHolderBase.java:264)
        at org.wso2.carbon.utils.multitenancy.CarbonContextHolder.setTenantDomain(CarbonContextHolder.java:633)
        at org.wso2.carbon.core.multitenancy.SuperTenantCarbonContext.setTenantDomain(SuperTenantCarbonContext.java:228)
        at org.wso2.carbon.core.multitenancy.MultitenantMessageReceiver.doSOAP(MultitenantMessageReceiver.java:212)
        at org.wso2.carbon.core.multitenancy.MultitenantMessageReceiver.processRequest(MultitenantMessageReceiver.java:181)
        at org.wso2.carbon.core.multitenancy.MultitenantMessageReceiver.receive(MultitenantMessageReceiver.java:77)
        at org.apache.axis2.engine.AxisEngine.receive(AxisEngine.java:181)
        at org.apache.axis2.transport.http.HTTPTransportUtils.processHTTPPostRequest(HTTPTransportUtils.java:172)
        at org.apache.axis2.transport.http.AxisServlet.doPost(AxisServlet.java:146)
        at org.wso2.carbon.core.transports.CarbonServlet.doPost(CarbonServlet.java:231)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:641)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
        at org.eclipse.equinox.http.helper.FilterServletAdaptor$FilterChainImpl.doFilter(FilterServletAdaptor.java:56)
        at org.wso2.carbon.mashup.jsservices.custom.ui.CustomUIServletFilter.doFilter(CustomUIServletFilter.java:233)
        at org.eclipse.equinox.http.helper.FilterServletAdaptor.service(FilterServletAdaptor.java:37)
        at org.eclipse.equinox.http.servlet.internal.ServletRegistration.handleRequest(ServletRegistration.java:90)
        at org.eclipse.equinox.http.servlet.internal.ProxyServlet.processAlias(ProxyServlet.java:111)
        at org.eclipse.equinox.http.servlet.internal.ProxyServlet.service(ProxyServlet.java:67)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
        at org.wso2.carbon.tomcat.ext.servlet.DelegationServlet.service(DelegationServlet.java:58)
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
        at org.wso2.carbon.tomcat.ext.filter.CharacterSetFilter.doFilter(CharacterSetFilter.java:61)
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:225)
        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123)
        at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)
        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)
        at org.wso2.carbon.tomcat.ext.valves.CompositeValve.invoke(CompositeValve.java:179)
        at org.wso2.carbon.tomcat.ext.valves.CarbonStuckThreadDetectionValve.invoke(CarbonStuckThreadDetectionValve.java:156)
        at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:927)
        at org.wso2.carbon.tomcat.ext.valves.CarbonContextCreatorValve.invoke(CarbonContextCreatorValve.java:49)
        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
        at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1001)
        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:579)
        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1653)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
        at java.lang.Thread.run(Thread.java:722)

[2012-10-20 22:39:29,058] @tenant2 [1] [Application Server]ERROR {org.wso2.carbon.base.CarbonContextHolderBase} -  Trying to set the domain from 2
 to 1
java.lang.IllegalStateException: Trying to set the domain from 2 to 1
        at org.wso2.carbon.base.CarbonContextHolderBase.setTenantId(CarbonContextHolderBase.java:214)
        at org.wso2.carbon.utils.multitenancy.CarbonContextHolder.setTenantId(CarbonContextHolder.java:595)
        at org.wso2.carbon.core.multitenancy.SuperTenantCarbonContext.setTenantId(SuperTenantCarbonContext.java:193)
        at org.wso2.carbon.core.multitenancy.SuperTenantCarbonContext.setTenantId(SuperTenantCarbonContext.java:182)
        at org.wso2.carbon.core.multitenancy.SuperTenantCarbonContext.resolveTenantId(SuperTenantCarbonContext.java:296)
        at org.wso2.carbon.core.multitenancy.SuperTenantCarbonContext.setTenantDomain(SuperTenantCarbonContext.java:232)
        at org.wso2.carbon.core.multitenancy.MultitenantMessageReceiver.doSOAP(MultitenantMessageReceiver.java:212)
        at org.wso2.carbon.core.multitenancy.MultitenantMessageReceiver.processRequest(MultitenantMessageReceiver.java:181)
        at org.wso2.carbon.core.multitenancy.MultitenantMessageReceiver.receive(MultitenantMessageReceiver.java:77)
        at org.apache.axis2.engine.AxisEngine.receive(AxisEngine.java:181)
        at org.apache.axis2.transport.http.HTTPTransportUtils.processHTTPPostRequest(HTTPTransportUtils.java:172)
        at org.apache.axis2.transport.http.AxisServlet.doPost(AxisServlet.java:146)
        at org.wso2.carbon.core.transports.CarbonServlet.doPost(CarbonServlet.java:231)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:641)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
        at org.eclipse.equinox.http.helper.FilterServletAdaptor$FilterChainImpl.doFilter(FilterServletAdaptor.java:56)
        at org.wso2.carbon.mashup.jsservices.custom.ui.CustomUIServletFilter.doFilter(CustomUIServletFilter.java:233)
        at org.eclipse.equinox.http.helper.FilterServletAdaptor.service(FilterServletAdaptor.java:37)
        at org.eclipse.equinox.http.servlet.internal.ServletRegistration.handleRequest(ServletRegistration.java:90)
        at org.eclipse.equinox.http.servlet.internal.ProxyServlet.processAlias(ProxyServlet.java:111)
        at org.eclipse.equinox.http.servlet.internal.ProxyServlet.service(ProxyServlet.java:67)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
        at org.wso2.carbon.tomcat.ext.servlet.DelegationServlet.service(DelegationServlet.java:58)
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
        at org.wso2.carbon.tomcat.ext.filter.CharacterSetFilter.doFilter(CharacterSetFilter.java:61)
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:225)
        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123)
        at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)
        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)
        at org.wso2.carbon.tomcat.ext.valves.CompositeValve.invoke(CompositeValve.java:179)
        at org.wso2.carbon.tomcat.ext.valves.CarbonStuckThreadDetectionValve.invoke(CarbonStuckThreadDetectionValve.java:156)
        at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:927)
        at org.wso2.carbon.tomcat.ext.valves.CarbonContextCreatorValve.invoke(CarbonContextCreatorValve.java:49)
        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
        at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1001)
        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:579)
        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1653)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
        at java.lang.Thread.run(Thread.java:722) 
```

与多租户相关的另一个问题是，我可以看到超级租户在特定租户中发送和接收的消息。这不是安全问题？？并非所有租户都会发生这种情况，这似乎是一个随机错误，或者只是我调用的第一个服务租户。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-24T11:14:21.270

这是一个小错误，已解决。仅当您将 TryIt 与有效的浏览器会话一起使用时，才会发生这种情况。

该修复程序将在下一个次要版本中提供。

# javascript - 记录我网站上的所有点击和互动

> ID：13012611
> 
> 赞同：0
> 
> 时间：2012-10-22T13:35:40.830
> 
> 标签：javascript, python, html, web

我想记录用户在我的网络软件上的所有点击和交互。有了这些数据，我想分析和跟踪用户行为（以提高可用性）。

是否有必要实现此功能或记录用户在后台点击的脚本/代码是否已经存在？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T13:37:30.860

[http://www.google.com/analytics/](http://www.google.com/analytics/)

考虑分析？据我所知，您需要的一切都满足吗？

# asp.net-mvc - 网页_UsersInRoles 缺失

> ID：13012612
> 
> 赞同：6
> 
> 时间：2012-10-22T13:35:41.733
> 
> 标签：asp.net-mvc, simplemembership

我将 ASP.NET MVC 4 与 SimpleMemmbership 一起使用。

当我构建我的应用程序时，会自动构建以下表格

网页_会员

网页_OAuthMembership

网页_角色

我可以成功注册用户。

但是，**webpages_UsersInRoles**表似乎丢失了。

有谁知道为什么这张桌子不见了？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-28T15:28:31.243

[本文](http://blog.spontaneouspublicity.com/including-asp-net-simple-membership-tables-as-part-of-your-entity-framework-model)可能会帮助您解决问题。

**更新：**

上面的文章让我们朝着正确的方向前进。我们的解决方案是在初始化期间使用的 UserProfile.cs 类中添加“webpages_UsersInRoles”的定义（我们首先编写代码）。

```
 [Table("UserProfile")]
public  class UserProfile
{
    [Key]
    [DatabaseGenerated(DatabaseGeneratedOption.Identity)]
    public int UserId { get; set; }
    public string UserName { get; set; }
    public string FirstName { get; set; }
    public string LastName { get; set; }
    [DataType(DataType.EmailAddress)]
    public string EmailAddress { get; set; }
    public bool IsEnabled { get; set; }
}

[Table("webpages_Membership")]
public class Membership
{
    public Membership()
    {
        //Roles = new List<Role>();
        OAuthMemberships = new List<OAuthMembership>();
        UsersInRoles = new List<UsersInRole>();
    }

    [Key, DatabaseGenerated(DatabaseGeneratedOption.None)]
    public int UserId { get; set; }
    public DateTime? CreateDate { get; set; }
    [StringLength(128)]
    public string ConfirmationToken { get; set; }
    public bool? IsConfirmed { get; set; }
    public DateTime? LastPasswordFailureDate { get; set; }
    public int PasswordFailuresSinceLastSuccess { get; set; }
    [Required, StringLength(128)]
    public string Password { get; set; }
    public DateTime? PasswordChangedDate { get; set; }
    [Required, StringLength(128)]
    public string PasswordSalt { get; set; }
    [StringLength(128)]
    public string PasswordVerificationToken { get; set; }
    public DateTime? PasswordVerificationTokenExpirationDate { get; set; }
    //public ICollection<Role> Roles { get; set; }

    [ForeignKey("UserId")]
    public ICollection<OAuthMembership> OAuthMemberships { get; set; }

    [ForeignKey("UserId")]
    public ICollection<UsersInRole> UsersInRoles { get; set; }
}

[Table("webpages_OAuthMembership")]
public class OAuthMembership
{
    [Key, Column(Order = 0), StringLength(30)]
    public string Provider { get; set; }

    [Key, Column(Order = 1), StringLength(100)]
    public string ProviderUserId { get; set; }

    public int UserId { get; set; }

    [Column("UserId"), InverseProperty("OAuthMemberships")]
    public Membership User { get; set; }
}

[Table("webpages_UsersInRoles")]
public class UsersInRole
{
    [Key, Column(Order = 0)]
    public int RoleId { get; set; }

    [Key, Column(Order = 1)]
    public int UserId { get; set; }

    [Column("RoleId"), InverseProperty("UsersInRoles")]
    public Role Roles { get; set; }

    [Column("UserId"), InverseProperty("UsersInRoles")]
    public Membership Members { get; set; }

}

[Table("webpages_Roles")]
public class Role
{
    public Role()
    {
        UsersInRoles = new List<UsersInRole>();
    }

    [Key]
    public int RoleId { get; set; }
    [StringLength(256)]
    public string RoleName { get; set; }

    //public ICollection<Membership> Members { get; set; }

    [ForeignKey("RoleId")]
    public ICollection<UsersInRole> UsersInRoles { get; set; }
} 
```

然后在继承 dbContext 的类上，我们添加了 public DbSet UsersInRoles { get; 放; }。

```
 public class IntranetEntities : DbContext
{

    public DbSet<UserProfile> UserProfiles { get; set; }
    public DbSet<Membership> Memberships { get; set; }
    public DbSet<Role> Roles { get; set; }
    public DbSet<UsersInRole> UsersInRoles { get; set; }

    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        modelBuilder.Conventions.Remove<PluralizingTableNameConvention>();
    }

    public override int SaveChanges()
    {

        try
        {
            return base.SaveChanges();
        }
        catch (DbEntityValidationException dbEx)
        {
            foreach (var validationErrors in dbEx.EntityValidationErrors)
            {
                foreach (var validationError in validationErrors.ValidationErrors)
                {
                    Trace.TraceInformation("Property: {0} Error: {1}", validationError.PropertyName, validationError.ErrorMessage);
                }
            }
        }
        return 0;

    }
} 
```

然后我们继续构建我们的项目并使用我们执行的 VS 包管理器控制台（因为我们正在进行代码优先开发）

> 更新数据库-详细

![网页_UsersInRoles](../Images/ee68ebb6a44fd19c8c2fa96432f9a993.png)

然后模型被更新到我们的期望。我已经提供了所有必需的代码，希望它能在未来的时间和悲伤中拯救某人。

# jquery - hot to 仅从当前拖动 td 开始选择

> ID：13012617
> 
> 赞同：0
> 
> 时间：2012-10-22T13:35:55.570
> 
> 标签：jquery

```
 $(document).live('mouseup', function () { flag = false; });
            $(".csstablelisttd").live('mousedown', function (e)
            {

                $(".csstdselected").removeClass("csstdselected").addClass('csstdgreen');
                //This line gets the index of the first clicked row.
                lastRow = $(this).closest("tr")[0].rowIndex;
                var rowIndex = $(this).closest("tr").index();
                var colIndex = $(e.target).closest('td').index();
                $(".csstdhighlight").removeClass("csstdhighlight");

                //$('td:nth-child(' + colIndex + ')').addClass('csstdhighlight');

                //$(this).children(":gt(" + colIndex + ")").addClass("csstdhighlight");
                $(this).children(":not(:first)").addClass("csstdhighlight");
                e.preventDefault();
                flag = true;
                return false;
            });
            document.onmousemove = function () { return false; };
            $(".csstablelisttd").live('mouseenter', function (e)
            {
                // Compares with the last and next row index.
                currentRow = $(this).closest("tr")[0].rowIndex;
                if (lastRow == currentRow || lastRow == currentRow - 1 || lastRow == currentRow + 1)
                {
                    lastRow = $(this).closest("tr")[0].rowIndex;
                } else
                    return;

                if (flag)
                {

$(this).children(":not(:first)").addClass("csstdhighlight");
                        e.preventDefault();
                        if ($(".csstdhighlight").length >= 6)
                        {
                            //alert("Time slot not more than 45 minutes.");
                            flag = false;
                        }
                    }
                }); 
```

在我的表格中看到我有 8 列和 48 行我要做的用户只能开始拖动一列但超过 1 行

[演示](http://jsfiddle.net/jquYB/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T13:40:52.557

使用第 n 个子选择器：

```
$('td:nth-child(' + (colIndex + 1) + ')').addClass('foo'); 
```

[这](http://jsfiddle.net/jquYB/2/)是对您的 jsFiddle 的修改。

# c# - 在右键菜单中添加项目

> ID：13012619
> 
> 赞同：1
> 
> 时间：2012-10-22T13:36:00.390
> 
> 标签：c#, .net, windows-shell, windows-explorer

在 Windows 资源管理器中，如何在右键菜单中添加项目？

我想创建“移动到路径”项目。例如：

我从 Windows 资源管理器中选择**任何**文件/文件夹，然后从右键单击菜单中单击“移动到 D:\Backup\”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-22T13:37:35.027

请参阅[MSDN 文档](http://msdn.microsoft.com/en-us/library/windows/desktop/cc144175%28v=vs.85%29.aspx)。
您需要在 HKCR 中创建一个注册表结构。*分机*。

# python - pydot：是否可以绘制两个具有相同字符串的不同节点？

> ID：13012621
> 
> 赞同：11
> 
> 时间：2012-10-22T13:36:02.500
> 
> 标签：python, decision-tree, pydot

我正在使用 pydot 在 python 中绘制图形。我想代表一个决策树，比如（a1，a2，a3 是属性，两个类是 0 和 1：

```
 a1>3
      /    \
  a2>10    a3>-7
   /  \     /  \
  1    0   1    0 
```

然而，使用 pydot，只创建了两片叶子，树看起来像这样（附有 png）：

```
 a1>3
      /    \
  a2>10    a3>-7
      |  X  |
      1     0 
```

现在，在这个简单的情况下，逻辑很好，但在较大的树中，属于不同分支的内部节点是统一的。

我正在使用的简单代码是：

```
import pydot
graph = pydot.Dot(graph_type='graph')
edge = pydot.Edge("a_1>3", "a_2>10")
graph.add_edge(edge)
edge = pydot.Edge("a_1>3", "a_3>-7")
graph.add_edge(edge)
edge = pydot.Edge("a_2>10", "1")
graph.add_edge(edge)
edge = pydot.Edge("a_2>10", "0")
graph.add_edge(edge)
edge = pydot.Edge("a_3>-7", "1")
graph.add_edge(edge)
edge = pydot.Edge("a_3>-7", "0")
graph.add_edge(edge)
graph.write_png('simpleTree.png') 
```

我还尝试创建不同的节点对象而不是创建边并将其添加到图中，但似乎 pydot 检查节点池中是否有同名的节点，而不是创建新的节点。

有任何想法吗？谢谢！

![上面代码创建的图像](../Images/1e9c80967c0f92b263da152613b5b9ae.png)

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-10-22T13:55:34.320

您的节点总是需要一个唯一的名称，否则您不能唯一地命名它们以在它们之间附加边。但是，您可以给每个节点一个标签，这是渲染时显示的内容。

因此，您需要添加具有唯一 ID 的节点：

```
graph = pydot.Dot(graph_type='graph')
graph.add_node(pydot.Node('literal_0_0', label='0'))
graph.add_node(pydot.Node('literal_0_1', label='0'))
graph.add_node(pydot.Node('literal_1_0', label='1'))
graph.add_node(pydot.Node('literal_1_1', label='1')) 
```

然后添加连接这些节点的图边：

```
edge = pydot.Edge("a_2>10", "literal_0_0")
graph.add_edge(edge)
edge = pydot.Edge("a_2>10", "literal_1_0")
graph.add_edge(edge)
edge = pydot.Edge("a_3>-7", "literal_0_1")
graph.add_edge(edge)
edge = pydot.Edge("a_3>-7", "literal_1_1")
graph.add_edge(edge) 
```

连同您定义的其余边，这使得：

![具有正确边的图](../Images/1467c5a7eaab5e5beff6993034ac5c33.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-09-10T02:13:46.257

The "canonical" answer is to use the [`uuid`](https://docs.python.org/2/library/uuid.html) module from the standard library, as `networkx` [does here](https://github.com/networkx/networkx/blob/a822b491c6b53a2819915a8c620e97a36ba6c060/networkx/utils/misc.py#L99).

This is better than using [`id`](https://docs.python.org/2/library/functions.html#id) to create node names for `pydot` that correspond to the nodes in your original graph, because if (in theory) a node object gets deleted while you are building your `pydot` graph, then that `id` won't necessarily be unique. In contrast, the `UUID` objects created are unique, persistent and independent of the lifespan of the original nodes.

However for this to happen, something very weird must be going on while you create the `pydot` graph, which is rather unlikely. The advantage of using `id` is that you don't need to build and pass around a mapping from original nodes to `UUID` objects (so that you construct consistently the edges after adding the nodes).

One interesting case are nested graphs: two different graphs may contain the same hashable object in `networkx` (say `a`), then `id` cannot be used any more directly on the node. But in that case, `id` can still be used, by combining the (node, graph) pair as: `str(id(node)) + str(id(graph))`.

# css - 按钮与输入对齐

> ID：13012623
> 
> 赞同：0
> 
> 时间：2012-10-22T13:36:08.567
> 
> 标签：css, twitter-bootstrap

这是我的代码：

```
<div class="input-append">

                        <input name="username" maxlength="100" placeholder="Enter your username..." type="text" class="input-large" id="id_username" />

                        <input name="password" maxlength="100" placeholder="Enter your password..." type="password" class="input-large" id="id_password" />

<button class="btn btn-mini">Envoyer</button>
     </div> 
```

这是结果：

![这是结果：](../Images/9179ecb87be3dd7b22f2ec7a2df39ce7.png)

请问如何将按钮与字段对齐？

问候比西尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T13:44:43.160

您可以手动将高度设置为相同的值

```
.input-large,
.btn-mini {
   height: 60px;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-22T13:48:14.103

如果我正确地遵循您的问题，您将需要在 CSS 中为它们中的每一个设置一个“高度”属性，以使它们具有相同的高度对齐。

我不是 CSS 大师，但这里有一个应该可以工作的例子：

```
<style>
.equal_height input, .equal_height button { height: 40px; }
</style>

<div class="input-append equal_height">
     <input name="username" maxlength="100" placeholder="Enter your username..." type="text" class="input-large" id="id_username" />
     <input name="password" maxlength="100" placeholder="Enter your password..." type="password" class="input-large" id="id_password" />
      <button class="btn btn-mini">Envoyer</button>
</div> 
```

# android - 如何允许用户在 android 的 web 视图上发布他们的消息

> ID：13012625
> 
> 赞同：0
> 
> 时间：2012-10-22T13:36:08.940
> 
> 标签：android, twitter-bootstrap, twitter, twitter-oauth

我可以简单地在 android 中发布推文，但我想在 WebView 的帮助下发布推文，您能否请我在其中 WebView 将在主要活动上重新定向，用户可以编辑消息并推文。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-22T13:39:58.177

试试这个代码

```
public class TwitterScreen extends Activity {

    private Twitter twitter;
    private ProgressDialog dialog;
    private WebView webView;
    private String twitterUrl;
    String twittMessage;

    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
        requestWindowFeature(Window.FEATURE_NO_TITLE);
        setContentView(R.layout.twitter_xml);

        twittMessage = "This Is Android";
        twitterUrl = twitterConnection();
        webView = (WebView) findViewById(R.id.webview);
        webView.getSettings().setJavaScriptEnabled(true);
        webView.getSettings().setLoadWithOverviewMode(true);
        webView.getSettings().setUseWideViewPort(true);

        try {
            webView.loadUrl(twitterUrl);
            webView.setWebViewClient(new ContactUsWebViewClient());

        } catch (Exception e) {
            e.printStackTrace();
        }

        sendTweetByApp(twittMessage);

    }

    public String twitterConnection() {

        twitter = new TwitterFactory().getInstance();
        twitter.setOAuthConsumer(TwitterConstants.CONSUMER_KEY,
                TwitterConstants.CONSUMER_SECRET);
        RequestToken requestToken = null;
        try {
            requestToken = twitter.getOAuthRequestToken();
        } catch (TwitterException e) {
            e.printStackTrace();
        }

        String url = requestToken.getAuthorizationURL();

        System.out.println("twitter Url load" + url);
        System.out.println("UserName");
        dialog = ProgressDialog.show(TwitterScreen.this, "", "Loading...",
                true, true);
        Thread threadHandler = new Thread() {
            @Override
            public void run() {
                // TODO Auto-generated method stub
                try {
                    Thread.sleep(3000);
                    dialog.dismiss();
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
            }
        };
        threadHandler.start();

        return url;
    }

    private class ContactUsWebViewClient extends WebViewClient {
        public boolean shouldOverrideUrlLoading(WebView view, String url) {
            view.loadUrl(url);
            return true;
        }
    }

    public void sendTweetByApp(String message) {
        Intent i = new Intent(Intent.ACTION_VIEW);
        i.setData(Uri.parse("http://twitter.com/?status=" + Uri.encode(message)));
        startActivity(i);

    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-22T13:40:30.220

[您可以使用这个 Java 库在您自己的 WebView http://twitter4j.org/en/index.html](http://twitter4j.org/en/index.html)的帮助下实现 Twitter OAuth

# android - 获取 ViewSwitcher 以匹配父级，以便内容可以居中

> ID：13012627
> 
> 赞同：3
> 
> 时间：2012-10-22T13:36:23.807
> 
> 标签：android, android-layout, viewswitcher

我正在尝试制作一个布局，`ViewSwitcher`其中显示的第一个视图是屏幕中心的旋转进度指示器，然后切换到线性布局，一旦加载，就会添加内容。

问题是我希望旋转指示器位于中心，因此我将所有内容设置为`match_parent`使其可以在屏幕上居中。但是，这不起作用，它给了我警告：

> 这个 ViewSwitcher 应该使用 android:layout_height="wrap_content"

然后显示布局，就好像它被设置为一样`wrap_content`。如何解决此问题，以使旋转指示器显示在屏幕中央？

谢谢。

我的代码：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="#FFF"
    android:orientation="vertical" >

    <ScrollView
        android:id="@+id/svXorBox"
        android:layout_width="match_parent"
        android:layout_height="match_parent" >

        <ViewSwitcher
            android:id="@+id/vsCollection"
            android:layout_width="match_parent"
            android:layout_height="match_parent" >

            <LinearLayout
                android:id="@+id/llBusy"
                android:layout_width="match_parent"
                android:layout_height="match_parent"
                android:gravity="center" >

                <ProgressBar
                    android:id="@+id/progressBar1"
                    style="?android:attr/progressBarStyleLarge"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content" />
            </LinearLayout>

            <LinearLayout
                android:id="@+id/llCollection"
                android:layout_width="match_parent"
                android:layout_height="match_parent" >
            </LinearLayout>
        </ViewSwitcher>
    </ScrollView>

</LinearLayout> 
```

# .net - 在任务中捕获异常

> ID：13012629
> 
> 赞同：4
> 
> 时间：2012-10-22T13:36:32.687
> 
> 标签：.net, wpf, task-parallel-library

我几年前实现的基本 ViewModel 提供了这种扩展方法来运行任务，同时保持 UI 响应*：

```
protected void Work(Action job)
{
    IsBusy = true;
    var stackTrace = new StackTrace();
    var task = Task.Factory.StartNew(job)
        .ContinueWith(failedTask => HandleException(failedTask, stackTrace), 
                      TaskContinuationOptions.OnlyOnFaulted)
        .ContinueWith(_ => { IsBusy = false; });
}

void HandleException(Task task, StackTrace stackTrace)
{
    Dispatcher.BeginInvoke(
        () => { throw new Exception(task.Exception.InnerException.ToString() + 
                                    stackTrace); });
} 
```

`IsBusy`是从 UI 观察到的用于显示进度条的属性。

背后的想法`HandleExceptions`是观察它们，然后将它们扔到 UI 线程中，被方法`try/catch`中的块捕获`Main()`并记录，然后向用户显示友好的消息并安全地关闭应用程序。传递了 stackTrace，因此日志包含调用者信息。

然而，我最近开始收到关于应用程序崩溃的报告，没有记录，也没有友好的消息，使用这个 Windows 对话框：

![碰撞](../Images/57c14ff88046d8441bd7280de79cc2f3.png)

查看 Windows 事件日志，我们得到了这个 EventData：

> 应用程序：xxxxApplication.Loader.exe
> 
> 框架版本：v4.0.30319
> 
> 说明：进程因未处理的异常而终止。
> 
> 异常信息：System.AggregateException
> 
> 堆栈：在 System.Threading.Tasks.TaskExceptionHolder.Finalize()

我做错了`ContinueWith()`什么吗？

任务异常是否有可能以某种方式未被观察到？

* * *

[*：我知道`BackgroundWorker`。这在当时似乎是一个更好的主意，或者有额外的好处。]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-27T10:04:37.017

我建议您处理[AppDomain.CurrentDomain.UnhandledException](http://msdn.microsoft.com/en-us/library/system.appdomain.unhandledexception.aspx) 以显示您的“友好消息”，或者（如果这不是您的解决方案）您至少可以在此事件中记录错误，然后查看堆栈跟踪是什么来确定在哪里发生此“未处理”任务异常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-30T13:25:33.610

我的猜测是你在这里有一个竞争条件。来自[Task.Exception](http://msdn.microsoft.com/en-us/library/system.threading.tasks.task.exception.aspx)参考：

> 引发未处理异常的任务存储生成的异常，并在调用 Wait 或访问 Exception 属性时将其传播到 AggregateException 中。在任务实例被垃圾收集时未观察到的任何异常都将在终结器线程上传播。有关更多信息和示例，请参阅异常处理（任务并行库）。

底线，如果您的任务在传入的委托`Dispatcher.BeginInvoke`被调用之前被收集，则将在主线程中引发异常。快速修复：

```
void HandleException(Task task, StackTrace stackTrace)
{
    // "observe" the exception
    var ex = task.Exception;
    Dispatcher.BeginInvoke(
        () => { throw new Exception(ex.InnerException.ToString() + 
                                    stackTrace); });
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-22T13:51:36.527

我不太确定，但是您将通过`failedTask`变量获得原始异常。如果任务失败[，它提供](http://msdn.microsoft.com/en-us/library/system.threading.tasks.task.exception.aspx)非空值。`AggregateException`

该异常又具有一个[Handle 方法](http://msdn.microsoft.com/en-us/library/system.aggregateexception.handle.aspx)，您可以提供一个委托，您可以在其中处理 AggregateException 中包含的每个异常，并说明您是否认为该异常已处理。

换句话说，如果您想在 Dispatcher 线程上重新抛出实际异常，我认为您应该确保在离开任务链之前将原始异常标记为已*处理。*

# jquery - jQuery Masonry 不会在某些调用上重新加载？

> ID：13012632
> 
> 赞同：0
> 
> 时间：2012-10-22T13:36:53.237
> 
> 标签：jquery, wordpress, jquery-plugins, jquery-masonry

masonry 插件似乎没有在某些调用上重新加载，它可能只是代码中缺少的东西，但我似乎无法弄清楚问题是什么。这是我的代码：

```
jQuery(document).ready(function(){

jQuery(".pics-hidden").hide();

jQuery('#menu1').click(function() {
      var menu = $(this).attr('menuref');
      jQuery(".pics").fadeOut(0).filter("[imageref='" + menu + "']").fadeIn(0);
      jQuery('#projectimages').masonry('reload');
});

jQuery('#menu2').click(function() {
      var menu = $(this).attr('menuref');
      jQuery(".pics").fadeOut(0).filter("[imageref='" + menu + "']").fadeIn(0);
      jQuery('#projectimages').masonry('reload');
});

jQuery('.pics').click(function() {
      jQuery('#div'+jQuery(this).attr('rarget')).addClass('pics').removeClass('#div'+jQuery(this).attr('rarget')).delay(600).fadeIn(400);
      jQuery('#projectimages').masonry('reload');
       });

jQuery('.close').click(function() {
      jQuery('#div'+jQuery(this).attr('larget')).removeClass('pics').addClass('.pics-hidden').removeClass('#div'+jQuery(this).attr('larget')).fadeOut(200);
      jQuery('#projectimages').masonry('reload'); 
      return false;      
});
}); 
```

底部 2 个调用工作正常并成功重新加载，但由于某种原因，顶部 2 个调用（包括过滤器）似乎没有重新加载砌体插件。
根本想不通。

# ruby-on-rails-3 - 如何保持 MVC 并在 Rails 中进行动态局部调用？

> ID：13012635
> 
> 赞同：0
> 
> 时间：2012-10-22T13:37:05.623
> 
> 标签：ruby-on-rails-3, model-view-controller, view, model, partials

我想知道在模型中执行以下操作是否正确：

```
get_partial
    #logic...
      return "_partial_name1"
    #more logic
      return  "_partial_name2"
    #more logic
      return  "_partial_name3"
    else
      "_partial_name4"
    end
end 
```

在视图中：

```
<%= render @product.get_partial %> 
```

模型中没有 erb 代码，只有逻辑选择它应该显示的部分。我对其进行了测试并且它可以工作，但我想知道从 MVC 的角度来看它是否正确。如果不是，这个逻辑应该放在哪里？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-22T14:15:12.347

你的模型永远不应该关心渲染什么视图。

如果您在决定做什么时需要逻辑，请使用视图助手。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-22T13:48:56.450

在视图中，我认为您可以将 if..else 逻辑放在那里。无论哪种方式，您都不希望将此逻辑放入模型中。也许你的意思是控制器，但我认为把它放在视图中是最好的方法

```
<% if (condition) %>
    <%= render 'partial1' %>
<% else %>
    <%= render 'partial2' %>
<% end %> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-22T14:22:05.210

好的，看来最好的做法是使用助手。我去做。

# iphone - UISegmentedControl：ValueChanged 处理程序上的 EXC_BAD_ACCESS

> ID：13012643
> 
> 赞同：1
> 
> 时间：2012-10-22T13:37:38.290
> 
> 标签：iphone, ios, uisegmentedcontrol

我想在我的应用程序 UISegmentedControl 中使用，在 windows 中制作类似于 TabBar 组件的东西。我使用 ValueChanged 处理程序：

```
- (IBAction)tabBarChange:(id)sender{
    int pageId = tabBar.selectedSegmentIndex;
    // [self switchPage:pageId];
} 
```

`switchPage`现在是空函数，没有写任何代码。

但是，当点击 SegmentedControl 时，会出现 EXC_BAD_ACCESS 异常。

我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T13:43:39.290

tabBar 真的在那个函数中定义了吗？不应该是：

```
int pageId = sender.selectedSegmentIndex; 
```

蒂姆

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-22T14:20:04.253

所以，我知道这个方法崩溃了：

```
- (IBAction)tabBarChange:(id)sender {
    [self switchPage:sender.selectedSegmentIndex];
} 
```

如果您尝试在不传递任何参数的情况下创建一些测试函数，它会起作用吗，例如：

```
- (IBAction)tabBarChange:(id)sender {
    [self testFunction];
}

- (void) testFunction {
    NSLog(@"test");
} 
```

# java - Eclipse 上的 Glassfish。收集要安装的项目时出错

> ID：13012647
> 
> 赞同：0
> 
> 时间：2012-10-22T13:37:55.070
> 
> 标签：java, eclipse, jakarta-ee, glassfish

我遵循本教程 (http://serendipstick.blogspot.com/2011/01/setup-eclipse-jee6-primefaces-and.html)，但无法安装 Glassfish。情况如下：

我在这里：“现在让我们启动 eclipse 并安装一些插件......”和“3）通过服务器选项卡集成 Glassfish，添加新服务器，下载其他服务器适配器，Oracle Glassfish 服务器工具。” 一切正常，直到我按下“完成”。有一个错误：

```
 An error occurred while collecting items to be installed
session context was:(profile=epp.package.jee, phase=org.eclipse.equinox.internal.p2.engine.phases.Collect, operand=, action=).

Problems downloading artifact: 
org.eclipse.update.feature,oracle.eclipse.tools.juno.glassfish,2.0.1.201201241920.
MD5 hash is not as expected. Expected: 8df101dee12517a86fe92bf6644cd44f and found fbef299b507f02fcab8887c108e82434. 
```

你能告诉我发生了什么事吗？如何安装 Oracle Glassfish 服务器工具？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T13:42:42.510

我今天遇到了确切的问题。我尝试通过 Eclipse Juno IDE 中的“新建服务器向导”安装 GlassFish 服务器适配器。在下载/安装过程中，我收到了与您相同的错误消息。

通过转到帮助 -> 安装新软件...并输入此站点位置解决了问题：http: [//download.java.net/glassfish/eclipse/juno](http://download.java.net/glassfish/eclipse/juno)。请务必选中*Oracle GlassFish Server Tools*选项。

# c# - 在 RDLC 报告中处理数组和聚合

> ID：13012652
> 
> 赞同：5
> 
> 时间：2012-10-22T13:38:28.947
> 
> 标签：c#, visual-studio-2012, reportviewer, rdlc

我正在尝试使用 VS2012 中的 RDLC 创建报告。
我从我的对象创建了一个数据集，其中包含要在报告中显示的所有数据。但是，此对象具有一些属性，它们是数组，而其他属性是自定义对象（聚合）。

```
public class myObject2Report {

private Double [] myResults;
private FakeDataObject fake;

//...
} 
```

问题是我不能将数组索引单独添加到报表中的表中，也不能从我的 FakeDataObject 中添加子字段。我在报告设计视图中尝试过，但没有成功，现在我正在寻找一些信息来创建一个表达式来做到这一点：

```
=Fields!myResults[0].Value
=Fields!myResults[1].Value
//... 
```

或者

```
=Fields!FakeDataObject.subField1.Value
=Fields!FakeDataObject.subField2.Value
//... 
```

对此主题的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-06-24T07:33:58.503

您可以使用以下语法访问数组（注意：VS 在编辑器中显示红线，但它仍然有效）：

```
=Fields!myResults.Value(0)
=Fields!myResults.Value(1) 
```

嵌套对象似乎不受支持，请[在此处](https://stackoverflow.com/questions/8895030/binding-object-data-source-with-nested-list-objects-in-rdlc)和[此处查看这些问题（表示它应该在 VS2010 SP1 中工作，在 VS2013 中对我不起作用）](https://stackoverflow.com/questions/2551969/child-objects-in-rdlc-studio-2010rc)。解决方案是将物体压平。

# google-chrome-extension - 开发 chrome 扩展来测试网站以检查浏览器兼容性？

> ID：13012653
> 
> 赞同：0
> 
> 时间：2012-10-22T13:38:29.897
> 
> 标签：google-chrome-extension

我想开发一个可以模拟所有浏览器（IE 6-9 firefox，safari）的 chrome 扩展，所以当我开发一个网站时，我可以切换视图以查看我的网站在不同浏览器中的外观。

我是扩展开发的新手。我已经开发了可以进行基本操作的扩展。比如获取页面 URL 重新加载页面。在页面等中插入样式。但是如何做浏览器模拟器？

任何想法或建议都会有帮助。

**编辑：** Waat 开发一些类似于 [https://chrome.google.com/webstore/detail/ie-tab-classic/miedgcmlgpmdagojnnbemlkgidepfjfi的东西](https://chrome.google.com/webstore/detail/ie-tab-classic/miedgcmlgpmdagojnnbemlkgidepfjfi)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-22T14:01:24.310

不幸的是，由于扩展是 Chrome 本身的一部分，它们不能用于模拟其他浏览器的引擎。

您可以做的最好的事情是开发一个扩展，该扩展将自动集成并轮询一些支持针对不同浏览器品牌和版本进行测试的外部服务，例如：

*   [browsershots.org](http://browsershots.org)；
*   [Adobe的浏览器实验室](https://browserlab.adobe.com/)；

虽然编写一个封装 IE COM 组件的 NPAPI 插件是可行的（尽管工作量很大，并且可能会面临一些细微差别）并通过扩展来使用它，但 FireFox 或 Opera 没有类似的方法。顺便说一句，如果您的意思是不仅需要渲染（可以通过屏幕截图完美检查），还需要与用户进行动态交互，那么任务就更加困难了。同样，在这种情况下，您只能通过运行目标浏览器的自定义外部服务来执行此操作，这些目标浏览器由您的扩展程序远程控制。这是可行的，但显然比简单的扩展需要更多的工作。事实上，您需要先开发特定的服务。

# objective-c - Objective Zip 不适用于 iOS5.1 设备，无法正确解压

> ID：13012661
> 
> 赞同：0
> 
> 时间：2012-10-22T13:39:04.023
> 
> 标签：objective-c, ios, ios5

我在项目中使用目标 zip 解压缩文件并将其存储到文档目录。它适用于 iOS 5.0 及以下版本。使用 5.1 模拟器工作正常。但是在 5.1 设备上工作时，只有少数文件被解压缩。文件夹中没有其他内容。下面是用于解压和存储的代码。

```
for (NSString *file in fileArray) {

        // Get the file info/name, prepare the target name/path
        ZipReadStream *readStream = [unzipFile readCurrentFileInZip];
        FileInZipInfo *fileInfo = [unzipFile getCurrentFileInZipInfo];
        fileNameString = [NSString stringWithFormat:@"%@",[fileInfo name]];

        NSLog(@"fileNameString %@",fileNameString);

        NSString *DirName = [targetFolder stringByAppendingPathComponent:moduleName];
        NSLog(@"targetFolder %@",targetFolder);
        NSLog(@"DirName %@",DirName);

        NSLog(@"fileNameString %@",fileNameString);

        if (![fileManager fileExistsAtPath:DirName isDirectory:nil]) {
            [fileManager createDirectoryAtPath:DirName attributes:nil];
            NSLog(@"created directory %@", DirName);
        }

        NSLog(@"fileNameString %@",fileNameString);

        NSString *unzipFilePath = [DirName stringByAppendingPathComponent:fileNameString];

        NSLog(@"unzipFilePath-- %@",unzipFilePath);

        // Create a file handle for writing the unzipped file contents
        if (![fileManager fileExistsAtPath:unzipFilePath]) {

            NSString *dir = unzipFilePath;//[unzipFilePath stringByDeletingLastPathComponent];
            if ([[fileNameString pathExtension] isEqualToString:@""]) {
                [fileManager createDirectoryAtPath:dir attributes:nil];
                NSLog(@"created directory %@", dir);
            }
            [fileManager createFileAtPath:unzipFilePath contents:nil attributes:nil];
        }

        fileHandle = [NSFileHandle fileHandleForWritingAtPath:unzipFilePath];
        // Read-then-write buffered loop to conserve memory
        do {
            // Reset buffer length
            [unzipBuffer setLength:BUFFER_SIZE];
            // Expand next chunk of bytes
            int bytesRead = [readStream readDataWithBuffer:unzipBuffer];
            if (bytesRead > 0) {
                // Write what we have read
                [unzipBuffer setLength:bytesRead];
                [fileHandle writeData:unzipBuffer];
            } else
                break;
        } while (YES);

        [readStream finishedReading];

        // NOTE: Disable iCloud backup for unzipped file if applicable here!
        /*...*/

        //[fileHandle writeData:unZipped];

        [fileHandle closeFile];

        [unzipFile goToNextFileInZip];
    }

    [unzipFile close]; // Be sure to also manage your memory manually if not using ARC!

    // Also delete the zip file here to conserve disk space if applicable!
    [recievedData release];

    NSLog(@"Delete -- %@", documentsDirectory);
    [fileManager removeItemAtPath:documentsDirectory error:nil];

    return YES;

} 
```

请帮忙 ！！！

提前致谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-22T14:27:36.623

使用以下方法使用 Objective-zip 解压缩 zip 文件。这在 iOS 4.3 到 6.0（可能更早和更晚）下都可以正常工作。'filename' 参数是 zip 文件的完整路径。

```
- (BOOL)unzipPath:(NSString *)filename toDirectory:(NSString *)directory error:(NSError **)error {
    if (error) {
        *error = nil;
    }

    ZipFile *unzipFile = [[ZipFile alloc] initWithFileName:filename mode:ZipFileModeUnzip];
    int cnt = [unzipFile numFilesInZip];
    [unzipFile goToFirstFileInZip];
    for (int i = 0; i < cnt; i++) {
        FileInZipInfo *info = [unzipFile getCurrentFileInZipInfo];
        NSString *name = info.name;
        if (![name hasSuffix:@"/"]) {
            NSString *filePath = [directory stringByAppendingPathComponent:name];
            NSString *basePath = [filePath stringByDeletingLastPathComponent];
            if (![[NSFileManager defaultManager] createDirectoryAtPath:basePath withIntermediateDirectories:YES attributes:nil error:error]) {
                [unzipFile close];

                return NO;
            }

            [[NSData data] writeToFile:filePath options:0 error:nil];

            NSFileHandle *handle = [NSFileHandle fileHandleForWritingAtPath:filePath];
            ZipReadStream *read = [unzipFile readCurrentFileInZip];
            NSUInteger count;
            NSMutableData *data = [NSMutableData dataWithLength:2048];
            while ((count = [read readDataWithBuffer:data])) {
                data.length = count;
                [handle writeData:data];
                data.length = 2048;
            }
            [read finishedReading];
            [handle closeFile];
        }

        [unzipFile goToNextFileInZip];
    }

    [unzipFile close];

    return YES;
} 
```

# session - 自定义设计会话控制器无法按预期工作

> ID：13012663
> 
> 赞同：0
> 
> 时间：2012-10-22T13:39:07.223
> 
> 标签：session, devise, controller, ruby-on-rails-3.2, customization

我按照官方说明定制了一些 Devise 的控制器：

*   config/routes.rb 已修改为：

    devise_for :admin_utilisateurs, :controllers => {:registrations => 'admin_utilisateurs/registrations', :sessions => 'admin_utilisateurs/sessions'}

*   视图已生成并从 app/view/devise/ 移动到 /app/view/admin_utilisateurs/

    我还为 admin_utilisateurs 定制了模型和迁移，以便拥有一个“活动”列。以便管理员可以手动停用该帐户。

**基本上，我想要的是，如果用户的 admin_utilisateur.active 属性为假，则用户不应该能够登录。**

这导致我进行以下修改：

```
class AdminUtilisateurs::SessionsController < Devise::SessionsController

  # Surcharge of 'create' method in Devise::SessionsController
  # Example ressource : http://www.communityguides.eu/articles/10
  def create

    @admin_utilisateur = AdminUtilisateur.find_by_email(params[:email])

    if @admin_utilisateur.present? && @admin_utilisateur.active
      super

    else
      flash.now[:alert] = t('devise.failure.desactive')
      render :new and return

    end
  end
end 
```

发生的事情是 Rails 使用了正确的自定义“创建”方法 app/controllers/admin_utilisateurs/sessions_controller.rb

如果管理员没有“激活”用户（admin_utilisateur.active = false），那么我收到了正确的 FLASH 消息，但是 RAILS 对其进行了身份验证！所以用户仍然可以访问所有资源，即使是那些由“before_filter :authenticate_admin_utilisateur!”保护的资源。指令在他们各自的控制器。

看起来 Rails si 仍然以某种方式进行身份验证，尽管“创建”方法没有编码这样做。

欢迎任何帮助！非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T16:08:59.680

好的，我看到的唯一解释是关于设计控制器顶部的这个**prepend_before_filter调用：**

```
prepend_before_filter :allow_params_authentication!, :only => :create 
```

RDoc 说：*告诉守望者该特定页面允许参数身份验证。*

我也不明白守望者是如何工作的。

反正 ！

我用 wiki 给出的不同解决方案解决了我的问题：[Require admin to activate account before sign_in](https://github.com/plataformatec/devise/wiki/How-To%3a-Require-admin-to-activate-account-before-sign_in)

所以我回滚了我的迁移。我修改了 ii 以使 :desactive 列变为 :approved。我迁移。我用以下内容修改了我的模型 app/models/admin_utilisateur.rb：

```
def active_for_authentication? 
  super && approved? 
end 

def inactive_message 
  approved?  ? super : :not_approved 
end 
```

我将所需的密钥添加到我的 config/locales/fr.yml

而且效果很好！！！为什么让它变得简单总是那么困难，而让它变得困难则容易;-)

# javascript - 如果变量包含

> ID：13012666
> 
> 赞同：50
> 
> 时间：2012-10-22T13:39:29.923
> 
> 标签：javascript, variables, if-statement

> **可能重复：**
> [JavaScript：字符串包含](https://stackoverflow.com/questions/1789945/javascript-string-contains)

我有一个邮政编码变量，并且想在更改/输入邮政编码时使用 JS 将位置添加到不同的变量中。因此，例如，如果输入 ST6，我希望输入 Stoke North。

我不知何故需要做一个 if 语句来运行，例如

```
if(code contains ST1)
{
    location = stoke central;
}
else if(code contains ST2)
{
    location = stoke north;
} 
```

ETC...

我该怎么办？它不是检查“代码”是否等于一个值，但如果它包含一个值，我认为这是我的问题。

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2012-10-22T13:41:23.197

你可能想要`indexOf`

```
if (code.indexOf("ST1") >= 0) { ... }
else if (code.indexOf("ST2") >= 0) { ... } 
```

它检查是否`contains`在`string`变量中的任何位置`code`。这需要`code`是一个字符串。如果您希望此解决方案不区分大小写，则必须使用`String.toLowerCase()`or将大小写更改为相同`String.toUpperCase()`。

您还可以使用`switch`如下语句

```
switch (true) {
    case (code.indexOf('ST1') >= 0):
        document.write('code contains "ST1"');
        break;
    case (code.indexOf('ST2') >= 0):
        document.write('code contains "ST2"');        
        break;        
    case (code.indexOf('ST3') >= 0):
        document.write('code contains "ST3"');
        break;        
    }​ 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-10-22T13:40:40.033

您可以使用正则表达式：

```
if (/ST1/i.test(code)) 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-10-22T13:43:36.583

检查一个字符串是否包含另一个字符串的最快方法是使用[`indexOf`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/indexOf)：

```
if (code.indexOf('ST1') !== -1) {
    // string code has "ST1" in it
} else {
    // string code does not have "ST1" in it
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-10-22T13:45:16.410

`if (code.indexOf("ST1")>=0) { location = "stoke central"; }`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-22T14:18:11.073

如果您有很多这些要检查，您可能想要存储映射列表并循环遍历它，而不是使用一堆 if/else 语句。就像是：

```
var CODE_TO_LOCATION = {
  'ST1': 'stoke central',
  'ST2': 'stoke north',
  // ...
};

function getLocation(text) {
  for (var code in CODE_TO_LOCATION) {
    if (text.indexOf(code) != -1) {
      return CODE_TO_LOCATION[code];
    }
  }
  return null;
} 
```

通过这种方式，您可以轻松添加更多代码/位置映射。如果你想处理多个位置，你可以在函数中建立一个位置数组，而不是只返回你找到的第一个位置。

# eclipse - Eclipse 无法启动已签出的项目

> ID：13012678
> 
> 赞同：1
> 
> 时间：2012-10-22T13:40:14.937
> 
> 标签：eclipse, svn, launch

我正在使用 Eclipse Juno 4.2，我通过 Subversive 签出了一个项目，但我无法运行该项目。我尝试使用不同的连接器 SVNKit 和 JavaHL 并将 Java 构建路径设置为工作目录，但仍然无法启动程序。

我也尝试通过 Subclipse 结帐，但没有结果。

# powershell - 从 ps1 脚本访问 ADUser.extensionAttribute

> ID：13012683
> 
> 赞同：4
> 
> 时间：2012-10-22T13:40:33.053
> 
> 标签：powershell, active-directory

我正在尝试修改我在网上找到的 ps1 脚本。它应该检查距离密码过期还有多少天，并将通知电子邮件发送到地址，存储在 Active Directory 帐户属性 - extensionAttribute1 中。无法使用本机电子邮件属性，因为某些帐户没有电子邮件（无法使用 MSA 的系统帐户），通常我必须通知用户并将副本发送给自己以记住这一点。原因：部分用户通过VPN（win XP）在域网络中工作，在登录时无法收到Windows系统消息的通知。有一个代码：

```
Import-Module ActiveDirectory

#System globalization
$ci = New-Object System.Globalization.CultureInfo("en-US")

#SMTP server name
$smtpServer = "mail.domain.local"

#Creating a Mail object
$msg = new-object Net.Mail.MailMessage

#Creating SMTP server object
$smtp = new-object Net.Mail.SmtpClient($smtpServer)

#E-mail structure
Function EmailStructure($to,$expiryDate,$upn)
{
$msg.IsBodyHtml = $true
$msg.From = "notification@domain.com"
$msg.To.Add($to)
$msg.Subject = "Password expiration notice"
$msg.Body = "<html><body><font face='Arial'>This is an automatically generated message from Exchange service.<br><br><b>Please note that the password for your account $upn will expire on $expiryDate.</b><br><br>Please change your password immediately or at least before this date as you will be unable to access the service without contacting your administrator.</font></body></html>"
}

#Set the target OU that will be searched for user accounts
$OU = "OU=Domain,DC=domain,DC=local"

$ADAccounts = Get-ADUser -LDAPFilter "(objectClass=user)" -searchbase $OU -properties PasswordExpired, PasswordNeverExpires, PasswordLastSet, Mail, Enabled | Where-object {$_.Enabled -eq $true -and $_.PasswordNeverExpires -eq $false}

Foreach ($ADAccount in $ADAccounts)
{
$accountFGPP = Get-ADUserResultantPasswordPolicy $ADAccount

                if ($accountFGPP -ne $null) {
                   $maxPasswordAgeTimeSpan = $accountFGPP.MaxPasswordAge
                } else {
                   $maxPasswordAgeTimeSpan = (Get-ADDefaultDomainPasswordPolicy).MaxPasswordAge
                }

#Fill in the user variables
$samAccountName = $ADAccount.samAccountName
<--  $userEmailAddress = $ADAccount.extensionAttribute1 -->
$userPrincipalName = $ADAccount.UserPrincipalName

if ($ADAccount.PasswordExpired) {
Write-host "The password for account $samAccountName has expired!"
} else {
$ExpiryDate = $ADAccount.PasswordLastSet + $maxPasswordAgeTimeSpan
Write-host "The password for account $samAccountName expires on: $ExpiryDate"

$TodaysDate = Get-Date
$DaysToExpire = $ExpiryDate - $TodaysDate
#Write-Host $DaysToExpire.Days
if ($DaysToExpire.Days -lt 7) {
$expiryDate = $expiryDate.ToString("d",$ci)

#Generate e-mail structure and send message

if ($userEmailAddress) {
EmailStructure $userEmailAddress $expiryDate $userPrincipalName
$smtp.Send($msg)
}
Write-Host "NOTIFICATION - $samAccountName :: e-mail was sent to $userEmailAddress"
  }

 }
} 
```

但命令行不返回“extensionAttribute1”。我已经用箭头标记了它。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-22T13:47:18.700

您需要将 extensionAttribute1 包含在 -Properties 参数中（$ADAccounts 分配）。

```
$ADAccounts = Get-ADUser ... -Properties  extensionAttribute1,PasswordExpired... 
```

# signal-processing - 这个 fft 的频率分辨率是多少？在哪种情况下我们在 FFT 之前使用窗口化？

> ID：13012684
> 
> 赞同：1
> 
> 时间：2012-10-22T13:40:38.803
> 
> 标签：signal-processing, fftw

我正在使用 fftw 对具有大约 10+-0.05Hz 的采样率（每次获得新样本时都会发生变化）的信号进行 FFT。我的输入信号有 200 个样本。我得到了 100 个复数的输出。现在要获得我的 fft 的分辨率并获得与 evry bin 对应的频率，我使用这个：

```
sampFreq = (float)numFrames*1000000/diffT;
a=sampFreq/numFrames;           //freq resolution of each fft bin
b=a/2;
freq = a*index + b;            // where index is the index of output bin 
```

numFrames 是我对 fft (200) 的初始输入大小，而不是输出大小。我做对了还是错过了2倍？我还需要在这种情况下使用 Windowing（如以 ~10Hz 和 200 帧采样）

另请注意，我不是零填充我的信号，因为 fftw 文档说样本可以是较小素数的倍数，不一定只有 2，所以我猜有 200 个作品。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-22T15:32:36.513

是的，您需要在 FFT 之前使用窗口函数，否则您将遭受频谱泄漏（您的频谱将被涂抹）。

您的频谱分辨率仅为 Fs / N = 10 / 200 = 0.05 Hz，因此您的 100 点频谱表示从 0 Hz（直流）到 5.0 Hz（奈奎斯特）的频率，每个“bin”的宽度为 0.05 Hz。

请注意，采样率中的抖动会对生成的频谱产生某种不可预测的影响——至少它会有些不准确，并且分辨率可能会受到影响。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-22T16:50:41.350

由于主瓣更宽/更宽，加窗会降低频率分辨率，但由于每个 DFT/FFT bin 滤波器的阻带衰减要低得多，因此会降低干扰和噪声的影响。哪种效果更差取决于被分析信号中的信噪比和/或干扰类型。窗口更有可能在更高的预期噪声或干扰水平下有用。

通过使用高质量的插值内核，远高于本底噪声的孤立频谱峰值的频率分辨率可以比 1 DFT/FFT 二进制宽度精细得多。分离两个单独峰的分辨率，最小分离间隙为 3 dB，大约为 2 到 3.5 DFT/FFT bin 宽度，具体取决于所使用的窗口。没有窗口（例如矩形窗口）可以提供分辨零噪声中 2 个紧密间隔的光谱峰的最佳分辨率。

# exception - 在 Zend 表单中显示异常错误消息 - Zend Framework 2

> ID：13012687
> 
> 赞同：3
> 
> 时间：2012-10-22T13:40:44.470
> 
> 标签：exception, zend-form, zend-framework2

我想以 zend 形式显示一个由异常引发的简单异常消息。我检查数据库中是否存在重复记录，如果退出，那么我想抛出一个错误，说明数据库中已经存在具有该名称的记录。我想在 add.phtml 文件中显示在记录名称文本字段之后。

这就是我想要做的事情：

在我的控制器中：

```
public function addAction()
{
    try {
        $records->validateDuplicateRecords($recordTitle);

        if ($form->isValid()) {
            //doing all the stuff like saving data to database
        }
    } catch (\Exception $e) {
         echo $e->getMessage(); //Not sure with this part
    }
} 
```

还有我正在检查重复记录的类：

记录.php

```
public function validateDuplicateRecords($recordTitle)
{
    //fetching all titles from database

   //comparing with $recordTitle using foreach and if
   //all these here in the loop works, I am giving the skeleton of my code
    foreach($records as $record)
    {
        if($record == $recordTitle) {
            throw new \Exception("Record with title '$recordTitle' already exists");
        }
        return true;
    }   
} 
```

所以这基本上就是我在做的事情，我知道这个 try and catch 如何与纯 php 的东西一起工作，但我不知道如何在 Zend Framework 2 和 zend 表单中使用异常。如果有人对此有解决方案，如果可以共享，我会很高兴。

PS我遵循专辑模块，所以基本上我的结构与官方模块或多或少相似

**编辑**： add.phtml 已添加

添加.phtml

```
<?php
$title = "Add New Record Title";
$this->headTitle($title);
?>
<h2><?php echo $this->escapeHtml($title); ?></h2>

<?php
$form = $this->form;
$form->setAttribute("action", $this->url("addRecordTitle", array('controller' => "album", 'action' => "add")));
$form->prepare();

echo $this->form()->openTag($form);
echo $this->formRow($form->get('recordTitle'));
echo $this->formInput($form->get('submit')); 
echo $this->form()->closeTag($form); 
?> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-22T13:53:48.047

鉴于您的示例，一种方法就是这样。但是，我建议您阅读内置验证器[Db\RecordExists 和 Db\RecordNoExists](http://framework.zend.com/manual/2.0/en/modules/zend.validator.set.html#db-recordexists-and-db-norecordexists)，因为它们可能已经做了您想做的事情。

```
public function addAction() 
{
     $form = $this->getForm(); //theoretical

     try {
         $records->validateDuplicateRecords($recordTitle);
     } catch (\Exception $e) {
         $form->setMessages(array(
             'recordTitle' => array($e->getMessage())
         ));
         return new ViewModel(array(
             'form' => $form
         ));
     }

     if ($form->isValid()) { 
         //usual stuff
     }
} 
```

使用此代码，您可以将错误消息附加到您的`title`-FormElement 上，请务必将名称编辑为您的标题元素的名称。

# php - 在 CodeIgniter 中查看“视图”之前如何验证用户身份验证？

> ID：13012688
> 
> 赞同：0
> 
> 时间：2012-10-22T13:40:49.317
> 
> 标签：php, codeigniter, authentication

所以我有一个指向相应视图的“仪表板”控制器。只需转至 即可随时访问此文件`http://domain.com/dashboard`。但是，如果用户已经登录，我只希望访问此 URL。如果没有，它们将被重定向回主页。

所以两部分问题：

1.  如果用户没有先登录，我如何防止他们访问“仪表板”（否则应重定向到主页）...**编辑：此问题已得到修复并且代码更新如下**

2.  在注册控制器上，`thank()`我如何自动登录用户并将他们带到破折号？

这是我的“仪表板”控制器。**编辑：**现在可以正常工作了。上面的第二（2）个问题仍然存在。

```
<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');

class Dashboard extends CI_Controller{

function __construct(){
    parent::__construct();
    $this -> load -> model('user_model');
}

public function index()
public function index()
{
    $session = $this->session->userdata('logged_in');

    if ($session == 1) 
    {
        $data['title'] = 'Dashboard';
        $this -> load -> view('shared/header_view', $data);
        $this -> load -> view('dash', $data);
        $this -> load -> view('shared/footer_view', $data);
    }
    else {
        redirect('register');
    }
}
} 
```

这是我的注册控制器，用于登录、注销和注册用户：

```
<?php if (!defined('BASEPATH')) exit('No direct script access allowed');

class Register extends CI_Controller {

public function __construct() 
{
    parent::__construct();
    $this -> load -> model('user_model');
}

public function index() 
{
    if (($this -> session -> userdata('user_name') != "")) {
        $this -> welcome();
    } 
    else
    {
        $data['title'] = 'Home';
        $this -> load -> view('shared/header_view', $data);
        $this -> load -> view("registration_view.php", $data);
        $this -> load -> view('shared/footer_view', $data);
    }
}

public function welcome() 
{
     redirect('/dashboard/', 'refresh');
}

public function login() 
{
    $email = $this -> input -> post('email');
    $password = md5($this -> input -> post('pass'));

    $result = $this -> user_model -> login($email, $password);
    if ($result)
        $this -> welcome();
    else
        $this -> index();
}

public function thank() 
{
    $data['title'] = 'You are now registered!';
    $this -> load -> view('shared/header_view', $data);
    $this -> load -> view('thank_view.php', $data);
    $this -> load -> view('shared/footer_view', $data);
}

public function registration() 
{
    $this -> load -> library('form_validation');
    // field name, error message, validation rules
    $this -> form_validation -> set_rules('user_name', 'User Name', 'trim|required|min_length[4]|xss_clean');
    $this -> form_validation -> set_rules('email_address', 'Your Email', 'trim|required|valid_email');
    $this -> form_validation -> set_rules('password', 'Password', 'trim|required|min_length[4]|max_length[32]');
    $this -> form_validation -> set_rules('con_password', 'Password Confirmation', 'trim|required|matches[password]');

    if ($this -> form_validation -> run() == FALSE) 
    {
        $this -> index();
    } 
    else 
    {
        $this -> user_model -> add_user();
        $this -> thank();
    }
}

public function logout() 
{
    $newdata = array('user_id' => '', 'user_name' => '', 'user_email' => '', 'logged_in' => FALSE, );
    $this -> session -> unset_userdata($newdata);
    $this -> session -> sess_destroy();
    redirect('/', 'refresh');
} 
```

}

编辑：按要求，这是 user_model：

```
<?php if (!defined('BASEPATH')) exit('No direct script access allowed');

class User_model extends CI_Model {

public function __construct() {
    parent::__construct();
}

function login($email, $password) 
{
    $this -> db -> where("email", $email);
    $this -> db -> where("password", $password);

    $query = $this -> db -> get("user");
    if ($query -> num_rows() > 0) 
    {
        foreach ($query->result() as $rows) 
        {
            //add all data to session
            $newdata = array(
                'user_id' => $rows -> id,
                'user_name' => $rows -> username,
                'user_email' => $rows -> email,
                'logged_in' => TRUE,
            );
        }
        $this -> session -> set_userdata($newdata);
        return true;
    }
    return false;
}

public function add_user() 
{
    $data = array(
        'username' => $this -> input -> post('user_name'),
        'email' => $this -> input -> post('email_address'),
        'password' => md5($this -> input -> post('password')),
    );
    $this -> db -> insert('user', $data);
} 
```

}

Codeigniter 新手。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T13:51:35.117

仪表板控制器上的这条规则看起来有点奇怪：

```
if ($session == 0) 
```

用户名真的是0吗？？或者您是否在此会话中存储布尔值。您可能也应该发布您的 user_model，以便我们可以看到您在那里做什么。

您应该尝试登录用户并设置会话，如下所示：

```
$qry = $this->db->query("Select * from users where username = '$username' AND password = '$password'");
if( $qry->num_results > 0 )
{
    $this->session->set_userdata(array('logged_in' => true);
    redirect('dashboard');
} 
```

当用户尝试访问仪表板时，只需执行如下检查：

```
if( !$this->session->userdate('logged_in') )
{
     redirect(base_url());
} 
```

所以当没有会话logged_in或会话为假时=>重定向。

注册用户时也可以这样做。用户注册成功并添加到数据库后，只需像在登录功能上一样创建会话并重定向到仪表板。

# android - 安卓服务开始时间

> ID：13012693
> 
> 赞同：2
> 
> 时间：2012-10-22T13:41:05.537
> 
> 标签：android, service, bind

我在实现应该是一个简单的服务示例时遇到问题。按照 Android 开发者计划，我设法绑定到服务。该服务完美运行。

我要实施的是服务的开始日期。我在

```
public class MyService extends Service {

    private Date _firstActivation= new Date();
    ....
    ....
    public Date GetFirstActivation() {
    return _firstActivation;
}
} 
```

在绑定到服务的主要活动中，我在 OnStart 方法期间有一个基本实现

```
 // Check if the Service is running and if it's running let's bind to the service through ServiceConnectionClass
    if (((MyApplication)getApplication())._serviceIsRunning)
    {
        Intent intent = new Intent(this, MyService.class);
        bindService(intent, mConnection, 0);
        _startingTime_TV.setText(_df.format(_myService.GetFirstActivation()));
    }
    else {
        _startingTime_TV.setText("Service Not Started");
    } 
```

其中 _myService 是 MyService，mConnection 是 ServiceConnection...

现在我期望的是，一旦服务第一次启动，每次我停止活动（同时取消绑定）并在 textview 上重新启动活动（同时绑定）我可以看到总是相同的起始时间。

每次我重新开始活动时，时间都会发生变化......

有人有线索吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-22T14:15:46.753

的生命周期`Service`是确定的： - 如果通过 启动`bindService`，`Service`则在解除绑定时停止 - 如果通过 启动`startService`，则通过`stopService`或者如果 Android OS需要它则停止

所以首先：总是通过启动你的服务`startService`，然后绑定到它。在你的绑定中，你可以这样做：`_startingTime_TV.setText(_df.format(_myService.GetFirstActivation()));` 因为在`bindService(intent, mConnection, 0);`你还没有被绑定之后。您必须等待回调：（`onServiceConnected`函数`ServiceConnection`）

# putty - PUTTY 在哪里存储其会话？

> ID：13012700
> 
> 赞同：23
> 
> 时间：2012-10-22T13:41:36.997
> 
> 标签：putty

看起来像在注册表中的某个地方。

试图启动不同的 exec 文件 - 会话是相同的。

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-10-22T13:44:06.303

HKEY_CURRENT_USER\Software\SimonTatham\PuTTY\Sessions

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-10-22T13:43:31.280

SshHostKeys 或会话中的 HKEY_CURRENT_USER\Software\SimonTatham\PuTTY

# java - Android SDK 从 HTTP get 获取图像

> ID：13012702
> 
> 赞同：2
> 
> 时间：2012-10-22T13:41:40.563
> 
> 标签：java, android, http, imageview, http-get

我在下载和放入从 ULR 下载的 ImageView 图像时遇到问题，通常使用起来很容易

```
imgView.setImageDrawable(grabImageFromUrl(url)); 
```

但就我而言，我需要使用我编写的 HttpClient 来检查证书。我想我必须使用 HTTPGEt，在接收响应 Json 字符串之前我已经使用过它，但我就是找不到抓取图片的方法。

有没有人有这种操作的经验？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-22T14:11:05.693

实际上我已经找到了解决我的问题的方法，如果有人遇到类似问题，我会在这里发布：

```
Bitmap bmp =null;
        DefaultHttpClient client = new MyHttpClient(ShowNotification.this);
        HttpGet get = new HttpGet(url);
        HttpResponse getResponse = null;
        try {
            getResponse = client.execute(get);
        } catch (ClientProtocolException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
        String entityContents="";
        HttpEntity responseEntity = getResponse.getEntity();
        BufferedHttpEntity httpEntity = null;
        try {
            httpEntity = new BufferedHttpEntity(responseEntity);
        } catch (IOException e1) {
            // TODO Auto-generated catch block
            e1.printStackTrace();
        }
        InputStream imageStream = null;
        try {
            imageStream = httpEntity.getContent();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
        bmp = BitmapFactory.decodeStream(imageStream);

        ImageView imgView =(ImageView)findViewById(R.id.imgView);
        imgView.setImageBitmap(bmp); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-22T13:48:37.707

您只需要将图像 URL 传递给您的方法：grabImageFromUrl(url)。可能有什么问题。你能告诉我们它的内容吗？

这个简单的教程可以帮助您解决问题 [http://www.vogella.com/articles/AndroidNetworking/article.html](http://www.vogella.com/articles/AndroidNetworking/article.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-22T13:51:52.763

我向你推荐这个优秀的小型图书馆项目：

[Android-Universal-Image-Loader](https://github.com/nostra13/Android-Universal-Image-Loader)

它允许异步加载。

# vb.net - 从 .NET 中的字符串获取 Type 对象

> ID：13012706
> 
> 赞同：0
> 
> 时间：2012-10-22T13:41:49.540
> 
> 标签：vb.net

我有一个带有控制定义的 xml

```
 <?xml version="1.0" encoding="utf-8"?>
  <Controls>
   <TabControl>
     <Properties>
      <Dock>5</Dock>
     </Properties>
     <TabPage>
      <TextBox>
       <Properties>
        <Text>Id:</Text>
        <Location>106,12</Location>
        <Size>113,20</Size>
        <BorderStyle>2</BorderStyle>
       </Properties>
      </TextBox>
      <MyControl>
       <Properties>
        <Visible>True</Visible>
        <Location>106,33</Location>
        <Size>113,20</Size>
        <Enabled>True</Enabled>
        <BorderStyle>2</BorderStyle>
        <Text>Action:</Text>
        <TabIndex>0</TabIndex>
       </Properties>
      </MyControl>
     <Properties>
      <Text>Details</Text>
     </Properties>
    </TabPage>
   </TabControl>
  </Controls> 
```

好的。如您所见，我在此示例中有一个 tabControl 和一个 TabPage。TabPage 有一个TextBox 和一个MyControl。

我能够读取 xml 并添加除 MyControl 之外的所有控件。原因是我找不到类型。说明：为了运行 xml 并添加控件，我想找到它是什么类型。所以我使用这行代码：

```
 Dim oType As Type = FindType("System.Windows.Forms." & elem.Name.ToString) 
```

FindType 是我在这里找到的一个函数：[Best way to get a Type object from a string in .NET](https://stackoverflow.com/questions/608332/best-way-to-get-a-type-object-from-a-string-in-net)

不幸的是，我无法弄清楚要在这个函数中添加什么来找到 MyControl。MyControl 只是添加到我的解决方案中的自定义控件。

我知道我可以在 FindType 函数中使用 if

```
 if base is Nothing then
      if name.Contains("MyControl")Then
            base = GetType(MyControl)
        End If
    End If
      If base IsNot Nothing Then Return base 
```

我的问题是我有 3 个自定义控件，也许将来我会添加更多。有什么方法可以通用吗？

另一个问题是在 FindType 函数中我必须使用“System.Windows.Forms”。为名。我发现没有它，函数不会返回任何东西。我认为这是因为我在构建表单时调用了该函数，所以还没有加载所有内容？

谢谢你的时间

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-22T13:48:47.210

`System.Windows.Forms`是一个**命名空间**。它用于对属于一起的类进行*分组。*例如，与 Windows 窗体相关的所有内容都包含在`System.Windows.Forms`命名空间中。您的类在您的项目命名空间中，这就是为什么在以 . 为前缀时找不到它们的原因`System.Windows.Forms`。

要了解有关命名空间的更多信息，请查看这篇[旧但仍然有效的 MSDN 文章](http://msdn.microsoft.com/en-us/library/ms973231.aspx)。

现在，让我们回到你的问题。一个简单的解决方案是*首先*查看`System.Windows.Forms`命名空间，*然后*查看您自己的命名空间：

```
Function FindTypeEx(typeName As String) As Type
    Dim type = FindType("System.Windows.Forms." & typeName)
    If type Is Nothing Then
        type = FindType(typeName)   ' Without the prefix
    End If
    Return type
End Function 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-22T13:47:48.333

如果`FindType("System.Windows.Forms." & elem.Name.ToString)`没有找到任何东西，请尝试`FindType(elem.Name.ToString)`

如果您只传递名称，则看起来您链接的问题中的 FindType 代码应该找到它，因为它会查看正在执行的程序集中的所有类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-22T13:45:03.043

那是因为没有`System.Windows.Forms.MyControl`课。
您需要为每个类确定正确的命名空间。

# java - OOP：如果在父类中定义，每个子类是否都有自己的静态变量？

> ID：13012707
> 
> 赞同：2
> 
> 时间：2012-10-22T13:41:51.720
> 
> 标签：java, oop

例子

```
abstract class A
{
  protected static Queue<String> q = new ArrayList<String>();

  abstract void myAbstractMethod();

  public doConcreteThings()
  {
     //busy code utilizing a 'q'
     q.add("something");
     myAbstractMethod();
     //busy code
  }

}

class B extends A
{

  public void myAbstractMethdo()
  {
     //creates concrete implementation using 'q'
  }
}

class C extends A
{

  public void myAbstractMethdo()
  {
     //creates concrete implementation using 'q'
  }
} 
```

*   每个扩展类都会有自己的静态队列吗？
*   如果没有，我如何确保在父类中定义静态变量的通用功能，但每个类都有自己的静态变量（因此是静态队列）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-22T13:46:07.907

不，所有班级将共享一个队列。一种方法是在每个子类中都有一个单独的静态队列，并添加另一个`getQueue()`返回此队列的受保护方法。这样每个子类都可以有自己的队列。

请注意，这`getQueue()`将是一个非静态方法，但返回一个静态变量引用。这使您可以在子类中实现它，而它的行为就像静态方法一样“有效”（它不需要访问`this`）。

```
abstract class A
{
  protected abstract Queue<String> getQueue();
  public abstract void myAbstractMethod();

  public doConcreteThings()
  {
     //busy code utilizing a 'q'
     getQueue().add("something");
     myAbstractMethod();
     //busy code
  }
}

class B extends A
{
  private static Queue<String> q = new ArrayList<String>();
  protected Queue<String> getQueue() { return q; }

  public void myAbstractMethod()
  {
     //creates concrete implementation using 'q'
  }
}

class C extends A
{
  private static Queue<String> q = new ArrayList<String>();
  protected Queue<String> getQueue() { return q; }

  public void myAbstractMethod()
  {
     //creates concrete implementation using 'q'
  }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-22T13:44:07.203

> 每个扩展类都会有自己的静态队列吗？

*   不，静态变量绑定到您定义它的特定类。如果您想为每个子类使用不同的静态变量，则需要显式定义它们。

> 如何确保在父类中定义静态变量的通用功能但每个类都有自己的静态变量

*   这是不可能的，正如第一种情况所述的原因。不同的类不共享静态变量。同一类的不同实例共享它们。

但是，您可以使用名称访问类中`static`定义的变量。`Parent``Child class``Parent Class`

**解决方法**： -

您可以`getters & setters (non-static)`在您`queue`的每一个中为您定义`subclasses`，也可以`static queue`为它们中的每一个定义不同的。现在，每次调用子类的方法时（通过多态性），它只会返回`static queue`该类中定义的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-22T14:05:40.373

*   每个扩展类都会有自己的静态队列吗？不，他们可以访问 A 中的同一个队列 q。所以 B 和 C 都可以访问 q，但 q 的唯一实例在 A 中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-22T13:45:11.383

不，静态变量属于您定义它们的实体，即使它们是抽象类或接口。

我真的很想挑战你为什么想要你提出的设计，但如果你真的想让每个子类都有自己的（静态）队列，你可以这样做：

```
abstract class A
{
  abstract Queue getQueue();

  abstract void myAbstractMethod();

  public doConcreteThings()
  {
     //busy code utilizing a 'q'
     getQueue().add("something");
     myAbstractMethod();
     //busy code
  }    
}

class B extends A
{
protected static Queue<String> q = new ArrayList<String>();

  public void myAbstractMethdo()
  {
     //creates concrete implementation using 'q'
  }
  public Queue getQueue() {
    return queue;
  } 
}

class C extends A
{
protected static Queue<String> q = new LinkedListList<String>();

  public void myAbstractMethdo()
  {
     //creates concrete implementation using 'q'
  }

public Queue getQueue() {
    return queue;
 } 
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-22T13:47:51.117

在继承方面，静态变量与对象变量不同。例如：您有一个带有静态变量和对象变量的超类。当您扩展该类时，您可以覆盖对象变量，它对于该类是唯一的，但是对于静态变量来说这是不同的。静态变量在所有扩展超类的类中都是相同的。

# asp.net - Azure 云服务的自定义域

> ID：13012710
> 
> 赞同：2
> 
> 时间：2012-10-22T13:41:54.800
> 
> 标签：asp.net, azure

我在 Azure 上有我的示例网站

[http://1f1e8bdb96d34b769ee79b2d23d2b167.cloudapp.net/](http://1f1e8bdb96d34b769ee79b2d23d2b167.cloudapp.net/)

我想将它映射到我的客户域。

www.api.tplex.com

我怎样才能用子域做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-22T13:45:29.467

看到这个： http: [//www.windowsazure.com/en-us/develop/net/common-tasks/custom-dns/](http://www.windowsazure.com/en-us/develop/net/common-tasks/custom-dns/)

确保您实际设置了 CNAME 记录，它会检查它是否指向站点 URL。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-22T14:30:20.300

根据 URL 中的 GUID，这看起来像是一个临时站点，刚刚部署了一个新的构建。您必须为主云服务应用程序设置 DNS (http://your-app-name.cloudapp.net)，对吗？在您注册域名的注册商网站上创建 CNAME 记录，并将其指向此[http://your-app-name.cloudapp.net](http://your-app-name.cloudapp.net) URL。

此外，如果您还没有意识到这一点，请使用[VIP 交换](http://msdn.microsoft.com/en-us/library/windowsazure/ee517253.aspx)技术将构建从阶段部署到生产，即从[http://some-guid.cloudapp.net/](http://some-guid.cloudapp.net/)到[http://your-app-name。 cloudapp.net/](http://your-app-name.cloudapp.net/)

# android - 如何在android中解析像丹麦语这样的特殊字符？

> ID：13012712
> 
> 赞同：1
> 
> 时间：2012-10-22T13:42:01.193
> 
> 标签：android, json, special-characters

嗨，我正在做一个 json 解析，如果使用丹麦字符（æøåÆØÅ*），我想发布一些数据，数据 s 没有上传到服务器。我需要知道如何将这些数据发布到服务器以及如何获取向我的应用程序发布了特殊字符。请帮助谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T06:00:21.803

最后我整理了答案使用UTF-8编码和解码来解决这个问题

将值传递给服务器时对其进行编码，并在我们需要将其从服务器显示到我们的应用程序时对其进行解码

URLENCODING-将值传递给服务器

```
String value="å";//This is a special character
try {
        value=URLEncoder.encode(value, "UTF8");
        System.out.println("value------"+value);
    } catch (UnsupportedEncodingException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } 
```

输出将是**价值------%C3%A5**

我们可以将此值传递给服务器。

现在我们已经将值传递给服务器，如果我们需要在应用程序的某些地方显示它，我们需要从服务器解码值，我们将得到这样的结果数据

```
String value="%C3%A5";
    try {
        value=URLDecoder.decode(value, "UTF8");
        System.out.println("value------"+value);
    } catch (UnsupportedEncodingException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } 
```

输出将是**价值------å**

这就是我们通过解析将丹麦语或任何其他特殊字符传递给服务器的方式

# android - 如何检查我的 ListView 的 EmptyView 是否显示在 Android 中？

> ID：13012716
> 
> 赞同：1
> 
> 时间：2012-10-22T13:42:20.143
> 
> 标签：android, listview, listadapter

我正在使用 ListView，如果列表为空，我将显示 EmptyView。如何检查此视图是否显示为布尔变量？

这是我的 ListView 的代码：

```
deviceList = (ListView) findViewById(R.id.DeviceList);
ListAdapter listenAdapter = new ArrayAdapter(this,
                android.R.layout.simple_list_item_2, deviceArray);

//add a view which is shown if the ListView is empty
deviceList.setEmptyView( findViewById( R.id.empty_list_view ) );
deviceList.setAdapter(listenAdapter); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T17:31:27.827

您可以使用“特殊”android id 在 xml 中执行此操作。如果您在布局 xml 文件中使用此代码，则空文本会在需要时自动显示：

```
<ListView android:layout_height="wrap_content" android:layout_width="match_parent"    android:id="@id/android:list"/>
<TextView android:layout_height="wrap_content" android:layout_width="match_parent"   android:text="@string/no_tasks" android:id="@id/android:empty"
android:gravity="center_vertical|center_horizontal"/> 
```

具有 android:empty id 的 textview 仅在 android:list 组件为空时显示。

我希望这会有所帮助。

# android - 如何知道 ImageView 上设置了哪个图像？

> ID：13012719
> 
> 赞同：2
> 
> 时间：2012-10-22T13:42:35.853
> 
> 标签：android, android-imageview

我有一个 ImageView 可以有两个图像中的任何一个（比如图像 1 和图像 2，存储在 drawable 中）。如果 ImageView 包含 image1，我希望单击该 ImageView 以禁用，并且如果正在显示图像 2，则单击图像应更改为 image1 并在 ImageView 上禁用单击。
我无法找到知道 ImageView 上当前显示的图像的方法。

这是我的代码

```
ImageView select = (ImageView) view.findViewById(R.id.select); 
select.setOnClickListener(new OnClickListener() { 
public void onClick(View v) { 
// TODO Auto-generated method stub 
} 
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-22T13:47:34.713

我认为最干净的方法是将这种状态与 UI 分开跟踪，并让 UI 反映您感兴趣的状态。即，如果它是启用/禁用表示，请跟踪是否启用在具有适当 setter 方法的布尔值中，并让该方法更新 UI。这也可能是[StateListDrawable](http://developer.android.com/reference/android/graphics/drawable/StateListDrawable.html)的一个很好的应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-10T14:13:42.737

这是按钮：

```
final Button whichLane = (Button) reportDialog.findViewById(R.id.which_side_icon);
        // if button is clicked, close the custom dialog
        whichLane.setOnClickListener(new OnClickListener() {
            @Override
            public void onClick(View v) {
                if (whichLane.getBackground().getConstantState().equals(getResources().getDrawable(R.drawable.other_side).getConstantState()) ) {
                    Toast.makeText(HomeActivity.this, "text", 10).show();
                }
            }
        }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-22T14:02:36.290

也许您可以考虑创建自己的 View 来扩展[CompoundButton](http://developer.android.com/reference/android/widget/CompoundButton.html)。检查状态将是图像，而未检查状态将是另一个。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-06-23T05:12:52.860

将 id 设置为像这样的图像视图 select.setId(imageArray[i])[以供参考查看此链接](https://stackoverflow.com/questions/24325071/how-to-identified-which-image-is-clicked-in-imageview/24325201#24325201) 并在其中执行您想要的 onclick 操作。

```
public static int[] imageArray = {
         R.drawable.image1,
         R.drawable.image2

         };
Bitmap bmp= BitmapFactory.decodeResource(getResources(),imageArray[i]);
    select.setImageBitmap(bmp);
    select.setId(imageArray[i]);
    select.setOnClickListener(new OnClickListener() {
     @Override
    public void onClick(View v) {
         if(v.getId()==R.drawable.image1){
                   //here you set image2 to select 
             } 
         else{
                  //here you set image1 to select
         }
    } } ); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-08-06T08:01:29.327

我遇到了同样的问题，我可以告诉你我做了什么。我发现这是最简单的

```
public class MainActivity extends AppCompatActivity {
ImageView iv;
Button btn;
int i = 0;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setContentView(R.layout.activity_main);
    iv = findViewById(R.id.imageView);
    btn = findViewById(R.id.btn);
    btn.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View view) {
            if(i==0)
            {
                iv.setImageResource(R.drawable.baloon); //baloon -> first image
                i=1;
            }
            else
            {
                i = 0;
                iv.setImageResource(R.drawable.sky); //sky -> second image
            }
        }
    });
} 
```

}

注意：- 在 xml 中，我使用天空作为图像视图的初始图像，这很重要，否则我们的图像在第一次单击时不会改变。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-03-08T04:55:16.940

您可以使用`tag`in imageview 并相应地检查图像。然后，当您更改图像时，再次设置`tag`图像视图。一个例子 ：-

在这里，我展示了 8 张图片的示例。我首先设置`p1`了从布局文件命名的图像并将图像视图标签设置为`1`. 然后当用户点击图像时，我会检查`imageview`标签名称。并相应地更改图像。

```
 imageView.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View view) {
            String tagId = imageView.getTag().toString();
            switch (tagId) {
                case "1":
                    imageView.setImageDrawable(getResources().getDrawable(R.drawable.p2));
                    imageView.setTag("2");
                    break;
                case "2":
                    imageView.setImageDrawable(getResources().getDrawable(R.drawable.p3));
                    imageView.setTag("3");
                    break;
                case "3":
                    imageView.setImageDrawable(getResources().getDrawable(R.drawable.p4));
                    imageView.setTag("4");
                    break;
                case "4":
                    imageView.setImageDrawable(getResources().getDrawable(R.drawable.p5));
                    imageView.setTag("5");
                    break;
                case "5":
                    imageView.setImageDrawable(getResources().getDrawable(R.drawable.p6));
                    imageView.setTag("6");
                    break;
                case "6":
                    imageView.setImageDrawable(getResources().getDrawable(R.drawable.p7));
                    imageView.setTag("7");
                    break;
                case "7":
                    imageView.setImageDrawable(getResources().getDrawable(R.drawable.p8));
                    imageView.setTag("8");
                    break;

            }

        }
    }); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-07-08T09:41:59.100

`Integer` 当您更改图像时，您可以使用并更改它的值。
例如使用一个

```
public Integer num; 
```

当您在视图上设置 image1 时，将 num 的值更改为 1。并在`onClickListener`方法中检查 num 是否为 1。IE

```
if (num == 1) 
```

更改为图像 2 否则更改为图像 1

# javascript - 是否可以完全禁用 contenteditable div 上的模糊事件？

> ID：13012722
> 
> 赞同：1
> 
> 时间：2012-10-22T13:42:49.540
> 
> 标签：javascript, jquery

我需要完全防止内容可编辑的 div 失去焦点。

我在`blur`处理程序中尝试了以下所有方法：

```
event.preventDefault();
event.stopPropagation();
return false; 
```

我发现的唯一解决方案是使用 setTimeout 并重新聚焦元素，如下所示：

```
$(element).on('blur', function(){
     var el = $(this);

     setTimeout(function(){
         el.focus();
     },5);
}); 
```

尽管这使元素保持焦点，但插入符号当然会移动到开头，而不是保持其当前的选择状态/位置。

在我开始编写代码以将插入符号位置/选择存储在模糊上并将其重新定位在焦点上之前，我希望其他人已经找到了一种完全防止模糊事件的方法。

提前致谢。

# python - 在 Python 中访问多个文件中的一个变量？

> ID：13012723
> 
> 赞同：0
> 
> 时间：2012-10-22T13:42:51.567
> 
> 标签：python, python-2.4

我有一个包含许多`.py`文件的包。

我想要：

1.  有一个调试标志，我可以在每个文件中访问它。（实际上写在一个文件里，读到其他所有文件里）
2.  每个文件都有一个版本号，每个文件都有一个版本号。但我想创建一个函数来获取所有文件的所有版本号。

在这些情况下如何定义变量？我该如何使用`import`？

编辑：我使用一个空的**__ *init* __** .py 文件和：

# 在包/classes.py 中：

调试 = 假

# 在包/db.py 中：

从 package.classes 导入 *

打印调试

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-22T13:45:21.957

`FLAG`假设您的文件中有一个名为的变量`files/variables.py`。

如果`files`文件夹里面有一个空`__init__.py`文件，你只需要做

```
from files.variables import * 
```

您可以在导入的每个文件中访问它。

以您的示例为例：

文件夹结构：

```
\program\ 
         \package\
                  __init__.py
                  classes.py
                  db.py 
```

在 db.py 中

```
from .classes import *
print debug 
```

应该管用

关于版本控制，如果您想手动进行，我认为您必须这样做，但是手动维护版本很麻烦。

# actionscript-3 - Flash 11.4 中的全屏交互模式

> ID：13012727
> 
> 赞同：1
> 
> 时间：2012-10-22T13:43:10.157
> 
> 标签：actionscript-3, flash

我正在尝试使用 Flash Player 11.4 在嵌入在 HTML 中的 Flash 应用程序中使用全屏交互模式，这样我就可以全屏访问键盘事件。它工作正常，但我确实有一个问题：即使在关闭“允许”对话框之后，每当我触摸屏幕的任何边框时，叠加层都会再次弹出，并在那里停留几秒钟，这很烦人，尤其是因为我（可能？）没有可靠的方法来判断它正在发生并且它覆盖了游戏 UI 的一部分。

有没有办法抑制这种行为？我什至在任何文档中都找不到它！

# jquery-ui - 如何在父容器中使所有 div 可拖动

> ID：13012730
> 
> 赞同：5
> 
> 时间：2012-10-22T13:43:19.737
> 
> 标签：jquery-ui, draggable, jquery

有一个`div`id `parentDiv`，并且有一些 div 与divl`block1`中的类`parentDiv`

像

```
<div id="btn"><input name="click" type="button" value="Click" class='button" /></div>

<div id="parentDiv">
    <div class="block1" style=" width:100px; height:100px; background:orange;">I am Block1</div>
    <div class="block1" style=" width:100px; height:100px; background:orange;">I am Block1</div>
</div> 
```

并且在 JQuery 中，带有 class 的 div`block1`是可拖动的。

```
$(function(){
    $('.block1').draggable({
        drag: function() {
           $('.block1').text('Drag Now!');
        },
        stop: function() {
           $('.block1').text('Stop Now!');
        }
    });
}); 
```

这些 div 作为方面工作，但问题是，如果通过单击 btn 输入将任何新的 div`block1`添加到`parentDiv`

```
$('#btn').on('click', 'input.button', function(){
    var $newDiv=$('<div class="block1" style=" width:100px; height:100px; background:green;">I am Block1</div>');
}); 
```

那是不可拖动的。

是的，它不起作用，因为它不在 DOM 中。

我们可以在div 上为它的 children定义一个`click`事件，如果我们在这个 div 中添加带有类按钮的新输入，所有的都将作为方面工作。`#btn``input.button``#btn`

所以我的问题是，有没有办法让所有 div 都可以在父容器中拖动`parentDiv`，就像我们可以用`#btn`div 一样？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-05-21T12:35:20.803

您可以使用带有事件的[jQuery on 方法](http://api.jquery.com/on/)`mouseover`来绑定未初始化的可拖动子项：

```
$(".parentDiv").on("mouseover", ".block1", function() {

    // Use the UI pseudo-selector to check that
    // it is not already draggable
    if(!$(this).is(":ui-draggable"))
        $(this).draggable({
            /* Options */
        });
}); 
```

为方便起见，包装在一个扩展 jQuery 的函数中：

```
$.fn.extend({

    /**
     * Children of the element with the given selector
     * will automatically be made draggable
     * @param {String} selector
     *  The selector of the child / descendant elements
     *  to automatically be made draggable
     * @param {Object} opts
     *  The options that would normally be passed to the
     *  draggable method
     * @returns
     *  The jQuery array for chaining
     */
    draggableChildren: function(selector, opts) {

        // On using event delegation to automatically
        // handle new child events
        $(this).on("mouseover", selector, function() {

           // Check that draggable not already initialized
           if(!$(this).is(":ui-draggable"))

               // Initialize draggable
               $(this).draggable(opts);
        });

        // Return this for chaining
        return this;
    }
}); 
```

您可以按如下方式使用它：

```
$(".parentDiv").draggableChildren(".block1", {
    drag: function() {
        $(this).text('Drag Now!');
    },
    stop: function() {
        $(this).text('Stop Now!');
    }
}); 
```

[**这是一个展示它的小提琴**](http://jsfiddle.net/X9TnW/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-22T13:49:06.833

您需要使用 jquery 的“实时”功能在未来元素上添加事件和功能。

此代码是从另一篇文章中借来的（http://stackoverflow.com/questions/1805210/jquery-drag-and-drop-using-live-events）

```
(function ($) {
   $.fn.liveDraggable = function (opts) {
      this.live("mouseover", function() {
         if (!$(this).data("init")) {
            $(this).data("init", true).draggable(opts);
         }
      });
      return $();
   };
}(jQuery)); 
```

现在而不是像这样称呼它：

```
$(selector).draggable({opts}); 
```

...只需使用：

```
$(selector).liveDraggable({opts}) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-22T13:45:15.670

您需要将`containment`属性设置为 parent 以限制该区域。

```
$("#yourItem" ).draggable({ containment: "parent" }); 
```

要为新的动态项目启用可拖动，您可以做的是，将绑定可拖动功能的代码移动到方法并在将新项目添加到 DOM 后调用该方法

```
 function BindDraggable()
 {
    $('.block1').draggable({
        drag: function() {
           $('.block1').text('Drag Now!');
        },
        stop: function() {
           $('.block1').text('Stop Now!');
        },
        containment: 'parent'
    });
 } 
```

现在在准备好文档时调用它，并在添加新内容后不久

```
$(function(){
  BindDraggable();

  $('#btn').on('click', 'input#button', function(){
    var $newDiv=$('<div class="block1" style=" width:100px; height:100px; background:green;">I am Block1</div>');
    //to do :attach the new item to the DOM

    BindDraggable();
}); 
```

});

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-10-04T07:25:58.813

```
$('#maindiv div").draggable({container:"#maindiv",scroll:false}) 
```

现在你可以做任何你想做的事

# c# - Type.IsGenericTypeDefinition 和 Type.ContainsGenericParameters 之间的区别

> ID：13012733
> 
> 赞同：22
> 
> 时间：2012-10-22T13:43:26.537
> 
> 标签：c#, .net, generics, reflection

该`System.Type`类型包含属性[IsGenericTypeDefinition](http://msdn.microsoft.com/en-us/library/system.type.isgenerictypedefinition.aspx)和[ContainsGenericParameters](http://msdn.microsoft.com/en-us/library/system.type.containsgenericparameters.aspx)。阅读 MSDN 文档后，我得出结论，这两个属性的存在是为了检查一个类型是开放的还是封闭的泛型类型。

但是，我看不出两者之间有什么区别，以及何时要使用其中一个。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-10-22T13:46:45.740

`Type.ContainsGenericParameters`是*递归*的：

```
var genericList = typeof(List<>);
var listOfSomeUnknownTypeOfList = genericList.MakeGenericType(genericList);
listOfSomeUnknownTypeOfList.IsGenericTypeDefinition;  // => false
listOfSomeUnknownTypeOfList.ContainsGenericParameters; // => true 
```

这里发生的情况是，它`listOfSomeUnknownTypeOfList`本身不是泛型类型定义，因为它的类型参数已知是`List<T>`某个 T 的 a。但是，由于`listOfSomeUnknownTypeOfList`不完全知道的类型（因为它的类型参数是类型定义）`ContainsGenericParameters`是`true`。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-22T13:46:05.757

`ContainsGenericParameters`是 的递归版本`IsGenericTypeDefinition`。

`typeof(List<Func<>>).IsGenericTypeDefinition`是假的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-22T13:48:32.333

下面有一个表格[`IsGenericType`](http://msdn.microsoft.com/en-us/library/system.type.isgenerictype.aspx)试图突出一些差异：

> 该`IsGenericTypeDefinition`属性是真实的。
> 
> 定义一个泛型类型。通过在表示泛型类型定义的对象上调用`MakeGenericType`方法`Type`并指定类型参数数组来创建构造类型。

或者：

> 该`ContainsGenericParameters`属性是真实的。
> 
> 示例是具有未分配类型参数的泛型类型、嵌套在泛型类型定义或开放构造类型中的类型，或者具有`ContainsGenericParameters`属性为 true 的类型参数的泛型类型。

所以它们并不完全相同。

# c# - 使用 JQuery 获取列表框中的所有列表项？

> ID：13012741
> 
> 赞同：1
> 
> 时间：2012-10-22T13:43:50.953
> 
> 标签：c#, jquery, asp.net

我想使用 jquery 获取列表框中存在的所有列表项，选择与否都没有关系。

这是我的客户端脚本：

```
<asp:ListBox ID="lstSelected" runat="server" SelectionMode="Multiple" Rows="10">
    <asp:ListItem Value="Employee_OID">EID</asp:ListItem>
    <asp:ListItem Value="EmpID">Emp ID</asp:ListItem>
    <asp:ListItem Value="Employee_Name">Name</asp:ListItem>
</asp:ListBox> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-22T13:53:53.253

通过向 ListBox 添加静态 ID (ClientIDMode="Static") 生成，您可以直接在 jQuery 中使用 ID 属性值（跳过 ClientID 使用）：

```
<asp:ListBox ID="lstSelected" runat="server" SelectionMode="Multiple" Rows="10" ClientIDMode="Static">
    <asp:ListItem Value="Employee_OID">EID</asp:ListItem>
    <asp:ListItem Value="EmpID">Emp ID</asp:ListItem>
    <asp:ListItem Value="Employee_Name">Name</asp:ListItem>
</asp:ListBox> 
```

**jQuery 获取所有选项：**

```
$('#lstSelected option') 
```

**jQuery 获取所有选定的选项：**

```
$('#lstSelected option:selected') 
```

在此处查看有关 ClientIDMode 的更多信息：http: [//msdn.microsoft.com/en-us/library/system.web.ui.control.clientidmode.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.control.clientidmode.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-22T13:45:21.147

要获取元素客户端，您将需要使用以下`ClientID`属性`ListBox`：

**所有选项**

```
$("#<%=lstSelected.ClientID %> option"); 
```

**所有选定的选项**

```
$("#<%=lstSelected.ClientID %> option:selected"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-12-22T23:39:17.487

我无法评论 Neurotix 的声誉原因。虽然这对我有用，但我只需要在“这个”周围加上 $() 就可以了。

```
$('#lstSelected option').each(function(){

if($(this).val() == anyvalue)

//your code here

}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-22T13:46:31.867

我想这应该可以解决问题：

```
$('#lstSelected option').each(function(){

if(this.val() == anyvalue)

//your code here

}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-22T13:46:51.193

```
$("#<%= lstSelected.ClientID %>").find("option"); 
```

# iphone - 单击导航 UIBarButtonItem 时收到 EXC_BAD_ACCESS 信号？

> ID：13012742
> 
> 赞同：1
> 
> 时间：2012-10-22T13:44:02.347
> 
> 标签：iphone, ios, ipad

我有一个应用程序，我正在尝试为聊天应用程序实现 LibPusher API。

该 API 已启用 arc，我已将其包含在我的 nonarc 项目中。
除了一些警告外，它工作正常。

现在我的问题是我在导航栏中添加了一个按钮，如下所示：

```
UIButton *btnNext1 =[[UIButton alloc] init];
    [btnNext1 setBackgroundImage:[UIImage imageNamed:@"back_btn.png"] forState:UIControlStateNormal];

    btnNext1.frame = CGRectMake(100, 100,60, 31);
    UIBarButtonItem *btnNext =[[UIBarButtonItem alloc] initWithCustomView:btnNext1];
    [btnNext1 addTarget:self action:@selector(backButtonClicked) forControlEvents:UIControlEventTouchUpInside];
    self.navigationItem.leftBarButtonItem = btnNext;
    [btnNext1 release]; 
```

它工作正常，在行动中我正在这样做：

```
PusherPresenceEventsViewController *rootView = ( PusherPresenceEventsViewController*)[self.navigationController.viewControllers objectAtIndex:1];
rootView.newmessage =@"";
[self.navigationController popToViewController:rootView animated:YES];
[rootView release]; 
```

前两次也可以正常工作。
但是，第三次出现错误的访问错误。
我不明白我哪里出错了，有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-22T14:00:33.540

```
UIButton *btnNext1 =    [UIButton buttonWithType:UIButtonTypeCustom] 
```

并且不要释放它。同时释放 Rootview，因为你没有分配它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-22T15:24:27.453

正如 iProgrammer 正确识别的那样，问题在于您正在发布您不拥有的东西（根据[基本内存管理规则](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/MemoryMgmt/Articles/mmRules.html)`alloc`，您只能“拥有”通过以、`new`、`copy`和开头的方法创建的那些东西`mutableCopy`）。删除`[rootView release]`，您的问题应该会消失。

顺便说一句，我建议通过静态分析器运行您的代码（在“产品”菜单上选择“分析”，或按`shift`+ `command`+ `B`）。您应该有分析器生成的*零*警告。这个额外`release`是分析器可能会引起您注意的问题的一个示例。静态分析器非常擅长发现各种可能困扰非 ARC 代码的基本内存管理问题。

# jquery - jQuery隐藏/显示类不改变未来添加元素的css

> ID：13012746
> 
> 赞同：0
> 
> 时间：2012-10-22T13:44:12.333
> 
> 标签：jquery, css, show-hide

如何使用 jQuery 更改 css 以使其对未来的元素也生效？我有一个问题，我正在使用 $().show() 来切换某些元素的显示，但随后我添加了具有相同类的新元素，并且它们保持隐藏状态。

```
<style type="text/css">
  .visibleState { display: none; }
</style>
<script>
  $('.visibleState').show();
  $('#appendHere').html('<div id="second" class="visibleState">* Second is NOT? visible</div>');
</script> 
```

这可能已经被问到了，但我找不到它。我尝试以不同的方式使用 live() ，但这似乎不起作用。这样做的正确方法是什么？

示例：http: [//jsfiddle.net/amorris/wykhv/](http://jsfiddle.net/amorris/wykhv/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-22T13:47:37.360

这不是`live`工作方式。`$('.visibleState').show();`将找到`visibleState`该类的所有（当前存在的）元素，并显示它们。它不会改变`visibleState`样式本身的 CSS 规则。

您可以通过点击 手动访问这些规则`document.styleSheets`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-22T13:51:35.933

最简单的方法可能是拥有一个包含父级，您可以从中添加和删除一个类。例如：

```
.shown .child{
    display: block;
}

.hidden .child{
    display:none;
} 
```

```
<div id="parent" class="hidden">
    <div class="child"></div>
</div> 
```

```
$("#parent").removeClass("hidden").addClass("shown")
    .append("<div class='child'>this will now be shown</div>"); 
```

可以使用任意数量的不同 CSS 规则来代替仅显示和隐藏。

工作示例：http: [//jsfiddle.net/xJ2Gh/](http://jsfiddle.net/xJ2Gh/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-22T14:02:27.133

您可以在调用 show 事件时定义一些标志并更改其值：

```
var fired = false;
$('.visibleState').show(function(){
    fired = true;
}); 
```

之后，当您确定 show 事件已完成时，您可以根据此标志状态设置新创建元素的可见性：

```
$('#appendHere').html('<div id="second" class= "visibleState"' + (fired ? " style=\"display: block\"" : "") + ') >* Second is visible</div>'); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-22T13:47:36.027

我尽量避免使用 .show() 和 .hide() 除非在极其简单的情况下。相反，使用具有默认行为和其他所需行为的类。所以你有你的 .visibleState 类和 .visibleState.show { display:block; }

```
<style type="text/css">
  .visibleState { display: none; /* default hidden */ }
  .visibleState.show { display: block; }
</style>
<script>
  $('.visibleState').addClass('show');
  $('#appendHere').html('<div id="second" class="visibleState show">Second is NOW visible</div>');
</script> 
```

尽管我会将您的“visibleState”类更改为语义上更适用的东西，例如“defaultState”。

您现在执行的方式将不起作用，因为 .show() 的函数调用尚未应用于您的 #second 元素。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-22T13:49:57.370

看这个：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">

<html>
<head>
<title></title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="imagetoolbar" content="false">
<meta http-equiv="imagetoolbar" content="no">
<style type="text/css">
.classname {
 color: red;
 font-size: 14px;
}
</style>
<script type="text/javascript">
window.onload = function() {
    document.getElementById("button").onclick = function() {
        var ss = document.styleSheets;

        for (var i=0; i<ss.length; i++) {
            var rules = ss[i].cssRules || ss[i].rules;

            for (var j=0; j<rules.length; j++) {
                if (rules[j].selectorText === ".classname") {
                    rules[j].style.color = "green";
                }
            }
        }
    };
}
</script>
</head>
<body>

<h1 class="classname">Some red text</h1>

<button id="button">Make text green</button>

</body>
</html> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-22T13:48:22.327

只需更改js，因此它是内联的。

```
 $('#appendHere').html('<div id="second" class="visibleState" style="display: block;">* Second is NOT? visible</div>'); 
```

内联样式会覆盖头部或样式表中的样式。

无论如何，这就是全部`show()`。显示和隐藏为显示属性添加和删除内联样式。也许还有可见性属性，有人吗？

# iphone - 在界面构建器中使用约束

> ID：13012748
> 
> 赞同：6
> 
> 时间：2012-10-22T13:44:20.530
> 
> 标签：iphone, interface-builder

所以，我无法理解界面构建器中的约束。

我自己无法添加它们 - 界面构建器似乎认为它最了解。

我也不能把它们拿走（我可以转换为“用户”约束，然后删除，但界面生成器只会再次用相同的约束替换它）。

我认为约束应该可以帮助您更改布局和各种类型 - 即为 iPhone 5 和更早版本构建视图。此外，从纵向模式移动到横向模式。

我似乎根本无法让它工作。如果我添加一个视图并将其放在超级视图的顶部下方，那么它将设置一个`Top space to:`约束。这将是一个像素值，这意味着当我在较短的 iPhone 4 上查看时（或者如果手机变成横向），这些元素不会自动向上移动。

例如，我正在尝试创建一个自定义键盘视图 - 类似于您在收银机上看到的。我创建了一个自定义 UIView 子类，现在我将一个 UIView 放入界面构建器中。我已经设置了高度和宽度，并将其定位在视图的底部（它“点击”到位）。界面生成器如何添加一个`Top space to`将其置于该高度的约束（iphone 5）。因此，如果我在 iPhone 4 上查看它，它不会向上移动（正如我所料，因为我将它“卡入”到屏幕底部的位置）而是切断了底部。

这不是我想要的，但是（如上所述）不幸的是，我无法删除约束。

我能做些什么？我知道我可以只创建两个 nib 文件（适用于 iPhone 5 和其他 iphone），但是当我想要在我转动手机风景时自动让步时怎么办？

谢谢你的帮助

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-18T20:43:11.953

如果这样做会留下**足够的约束来*完全*确定任何界面小部件的大小和位置，**则不能在 Interface Builder 中删除约束。

*   一种解决方案：**添加更多约束**，直到大小和位置*超定*。然后，您将能够删除多余的约束之一。例如，你举了这个例子：

    > 我已经设置了高度和宽度，并将其定位在视图的底部（它“点击”到位）。界面生成器如何将顶部空间添加到将其置于该高度的约束（iphone 5）。因此，如果我在 iPhone 4 上查看它，它不会向上移动（正如我所料，因为我将它“卡入”到屏幕底部的位置）而是切断了底部。

    选择视图并选择 Editor > Pin > Bottom Space to Superview。现在你有比你需要的更多的约束：高度、宽度、确定水平位置的东西（你忘了提到）、超级视图顶部的引脚和超级视图底部的引脚。因此，您*现在*可以删除顶部的图钉。

*   另一种解决方案：**删除代码中不需要的约束**。约束是一个普通的接口对象，因此您可以为它创建一个出口并在您的代码运行时将其移除。但是，如果您这样做的方式是使大小或位置未确定，您将得到不可预知的结果（“模糊布局”），所以要小心。

*   还有一个解决方案：**降低 IB 中不需要的约束的优先级**。Interface Builder 将确保所有值都是绝对确定的。但也许你知道，例如，superview 会改变大小，因此 Interface Builder 创建的一些约束将是不可取的。您不能删除它们，但可以降低它们的优先级。因此，在您的示例中，您最终可能会得到一个引脚到顶部和一个引脚到底部，但是您可以将引脚的优先级降低到顶部。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T21:44:35.910

对我来说不明显的是，如果它更值得麻烦的话，你可以在每个 nib 文件的基础上关闭这个新功能。

选择 nib 文件并选择文件检查器（视图->实用程序->显示文件检查器）并取消选择“使用自动布局”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-05T17:33:07.880

如果您在不同的屏幕尺寸上遇到此问题，它在 iPhone 5 屏幕上构建良好但在 iPhone 4 屏幕上构建良好，反之亦然，一种解决方案是关闭违规视图的“自动调整子视图”选项，然后单击窗口右下角的按钮显示您的故事板/笔尖，它可以更改屏幕尺寸并确保两种屏幕尺寸的一切看起来都很好。当我用代码构建所有东西并避免像这样的 IB 怪事时，这只是让我高兴的另一件事。

# sql - 选择在自加入关系中没有孩子的父母

> ID：13012761
> 
> 赞同：1
> 
> 时间：2012-10-22T13:45:12.957
> 
> 标签：sql, ms-access, self-join

我有一个简单的类别名称表，它使用 category_parent = id 与自身相关。我需要选择没有孩子的记录。

从其他答案中，我拼凑出这个声明：

```
SELECT cat.category_name AS 'Child Name', cat.id AS 'Child ID',
cat.category_parent AS 'Childs Parent', cat_par.category_name AS 'Parent Name', 
cat_par.id AS 'Parent ID'
FROM category AS cat
LEFT JOIN category AS cat_par ON cat.category_parent = cat_par.id
WHERE cat_par.id IS NULL; 
```

这将成功选择没有 PARENT 的记录。我尝试将最后一个子句更改为，`WHERE cat.category_parent IS NULL`但结果为空。

我还根据另一个答案尝试了这种说法：

```
SELECT cat.category_name AS 'Child Name', cat.id AS 'Child ID', 
cat.category_parent AS 'Childs Parent' cat_par.category_name AS 'Parent Name', 
cat_par.id AS 'Parent ID'
FROM category AS cat
WHERE NOT EXISTS 
(SELECT id FROM category AS cat_par WHERE cat.category_parent = cat_par.id); 
```

返回错误`No value given for one or more required parameters.`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-22T13:51:14.430

```
Select p.id, p.category_name
From category As p
Where Not Exists (
  Select 'x' 
  From Category c 
  Where c.category_parent = p.id
) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-22T13:50:56.637

我想我足够理解这种关系。这个怎么样？

```
SELECT cat.*
FROM category cat
WHERE cat.id not in (
   SELECT distinct category_parent FROM category
); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-22T14:29:39.443

如果您只需要没有子项的记录的 id 和类别名称，这也可以：

```
SELECT
  category.id,
  category.category_name
FROM
  category LEFT JOIN category AS category_1
    ON category.id = category_1.category_parent
WHERE
  category_1.category_parent IS NULL 
```

我认为这个查询看起来不错。但是如果你还需要父母的名字，你可以使用这个：

```
SELECT
  category.id,
  category.category_name,
  category_1.category_name
FROM
  (category LEFT JOIN category AS category_2
    ON category.id = category_2.category_parent)
  LEFT JOIN category AS category_1
    ON category.category_parent = category_1.ID
WHERE
  category_2.category_parent Is Null; 
```

是的，它变得有点复杂：这只是一个很好的 sql 练习，但我更喜欢使用 Exists 版本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-22T13:56:30.280

第二个查询的问题是您试图将其包含`cat_par.category_name`在结果集中，即使它不在您的`FROM`子句中。您不能从 EXISTS 子查询中的表返回列。

您想要以下内容：

```
SELECT 
    cat.category_name AS 'Child Name', 
    cat.id AS 'Child ID', 
    cat.category_parent AS 'Childs Parent',
    cat_par.category_name AS 'Parent Name',
    cat_par.id AS 'Parent ID'
FROM 
    category AS cat
    LEFT JOIN category AS cat_par ON cat.category_parent = cat_par.id
WHERE 
    NOT EXISTS 
    (SELECT 
        NULL 
    FROM 
        category AS cat_childless 
    WHERE cat.id = cat_childless.category_parent); 
```

# html - 插入 doctype html 内容时不会显示

> ID：13012762
> 
> 赞同：0
> 
> 时间：2012-10-22T13:45:14.620
> 
> 标签：html, xhtml, dtd

我在 Internet Explorer 中显示我的 html/css 文档时遇到问题，它在 firefox 和 chrome 中运行良好，所以我猜这是因为我没有插入任何 doctype，当我插入 xhtml 或 html 的 doctype 时不工作，它只会显示我的标题部分，我应该为 doctype 包括什么？

我试过这个：

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
        <html xmlns="http://www.w3.org/1999/xhtml">
     <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
```

它不工作。这是我工作的代码：

```
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="pragma" content="no-cache">
<meta http-equiv="cache-control" content="no-cache">
<meta http-equiv="expires" content="0">
<title>bazar</title>
<style type="text/css">

#container {
width: 770px;
margin: 0 auto
}
#main
{
width:100%;
height:100%;
up:0;
bottom:0;
margin:0;
}
#header
{
position:fixed;
background:url(header_slice.png);
repeat x;
width:100%;
height:63px;
top:0;
left:0;
right:0;
}
#logo
{
position:fixed;
background:url(logo.png);
width:192;
height:59;
float:right;
left:900;
}
#mymenu
{
position:fixed;
background:url(menu.png);
width:302;
height:19;
top:30;
left:122.5;
overflow:auto;
}
#mytext
{
position:fixed;
background:url(textbox.png);
width:257;
height:20;
top:30;
left:460;
}
#nav{
position:absolute;
background:url(navigation_slice.jpg);
repeat x;
width:100%;
height:148;
top:63;
z-index:1000;
left:0;
right:0;
}
#mycontainer
{
position:absolute;
background:white;
repeat x;
repeat y;
width:100%;
height:1281;
top:210;
left:0;
right:0;
}
#menu2
{
position:absolute;
background:url(navbar.png);
repeat x;
width:952;
height:67;
top:40;
left:125;
}
#home
{
position:absolute;
background:url(home.png);
width:52;
height:36;
top:30;
left:0;
}
#pencil{
position:absolute;
background:url(pencil.png);
width:39;
height:42;
top:7;
right:23;
}
#archive{
position:absolute;
background:url(archive.png);
width:38;
height:37;
top:7;
right:110;
}
#sep1{
position:absolute;
repeat y;
width:2;
height:67;
top:0;
right:78;
}
#sep2{
position:absolute;
repeat y;
width:2;
height:67;
top:0;
right:173;
}
#sep3{
position:absolute;
repeat y;
width:2;
height:67;
top:0;
right:284;
}
#sep4{
position:absolute;
repeat y;
width:2;
height:67;
top:0;
right:388;
}
#sep4{
position:absolute;
repeat y;
width:2;
height:67;
top:0;
right:459;
}
#sep4{
position:absolute;
repeat y;
width:2;
height:67;
top:0;
right:386;
}
#sep5{
position:absolute;
repeat y;
width:2;
height:67;
top:0;
right:459;
}
#sep6{
position:absolute;
repeat y;
width:2;
height:67;
top:0;
right:526;
}
#sep7{
position:absolute;
repeat y;
width:2;
height:67;
top:0;
right:596;
}
#sep8{
position:absolute;
repeat y;
width:2;
height:67;
top:0;
right:670;
}
.sep{
background:url(sep.png);
}
#seminar
{
position:absolute;
background:url(seminar.png);
right:204;
width:45;
height:33;
top:7;
}
#learn
{
position:absolute;
background:url(learning.png);
right:312;
width:44;
height:36;
top:7;
}
#art{
position:absolute;
background:url(art.png);
width:45;
height:40;
top:5;
right:400;
}
#engineer{
position:absolute;
background:url(engineer.png);
width:54;
height:36;
top:7;
right:470;
}
#publish{
position:absolute;
background:url(publish.png);
width:49;
height:38;
top:7;
right:539;
}
#new{
position:absolute;
background:url(new.png);
width:36;
height:31;
top:7;
right:610;
}
#contact
{
position:absolute;
background:url(contact.png);
width:178;
height:58;
top:17;
right:610;
left:125;
}
#rect1
{
width:716;
height:308;
top:-35;
left:125;
}
#rect2
{
width:226;
height:308;
top:-35;
left:850;
}
.rect
{
position:absolute;
background:url(rect.png);
repeat x;
repeat y;
}
#special
{position:absolute;
background:url(special.png);
width:696;
height:255;
top:-30;
left:132;
z-index:1000;
}
#chasb
{
position:absolute;
background:url(chasb.png);
width:56;
height:62;
top:50;
right:300;
z-index:1000;
}

#takhte
{
position:absolute;
background:url(takhte.png);
width:51;
height:58;
top:170;
right:300;
z-index:1000;
}
#sabad1{
position:absolute;
width:80;
height:17;
top:210;
right:370;
z-index:1000;
}
#sabad2{
position:absolute;
width:80;
height:17;
top:90;
right:370;
z-index:1000;
}
.sabad
{
background:url(sabad.png);
}

#left
{
position:absolute;
background:url(slideleft.png);
top:280;
left:125;
width:20;
height:69;
z-index:2000;
}
#right
{
position:absolute;
background:url(slideright.png);
top:280;
left:822;
width:17;
height:69;
z-index:2000;
}
#slide
{
position:absolute;
top:280;
left:125;
width:716;
height:69;
z-index:1500;
}
#staff
{
position:absolute;
background:url(staff.png);
width:228;
height:70;
top:280;
z-index:1000;
left:850;
}
#mybox
{
position:absolute;
background-color: white;
top:0;
left:865;
width:200;
height:260;
z-index:900;
}
#product
{
position:absolute;
background:url(products.png);
width:200;
height:76;
top:-30;
left:865;
z-index:1000;
}
</style>
</head>
<body>
<div id='main'>
<div id='header'>
<div id='logo'></div>
<div id='mymenu'></div>
<div id='mytext'></div>
<div id='nav'>
<div id='menu2'>
        <div id='home'></div><div id="pencil"></div>
        <div id="sep1" class="sep"></div><div id="archive"></div>
        <div id="sep2" class="sep"></div><div id="seminar"></div>
        <div id="sep3" class="sep"></div><div id="learn"></div>
        <div id="sep4" class="sep"></div><div id="art"></div>
        <div id="sep5" class="sep"></div><div id="engineer"></div>
        <div id="sep6" class="sep"></div><div id="publish"></div>
        <div id="sep7" class="sep"></div><div id="new"></div><div id="sep8" class="sep"></div>
</div>
<div id='contact'></div>
</div>

</div>

<div id='mycontainer'>

<div id='rect1' class='rect'></div>
<div id='rect2' class='rect'></div>
<div id='special'></div>
<div id='chasb'></div><div id='takhte'></div><div id='sabad1' class="sabad"></div><div id='sabad2' class="sabad"></div>
<div id='mybox'></div>
<div id='product'></div>
<div id='staff'></div>
<div id='slide' class="rect"></div>
<div id='left'></div><div id='right'></div>
</div>

</div>

</body>
</html> 
```

正如我所说的包含 doctype 它只会显示标题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T15:59:34.620

页面有大量 CSS 错误。当您没有 doctype 时，页面会在[Quirks Mode 下](http://www.cs.tut.fi/~jkorpela/quirks-mode.html)处理，这意味着浏览器会模拟旧的、损坏的 IE 版本。添加一个文档类型打破了这一点。例如，任何没有单位的长度表达式，除了 0，都会被忽略。

您需要决定是否希望修复（或重写）代码以符合 HTML 和 CSS 规范或使用 Quirks 模式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-22T15:13:29.017

唯一应该使用的 DOCTYPE 是`<!DOCTYPE html>`.

我怀疑是缺少单位。我猜 IE 没有使用`px`这里的默认值。

`width`, `height`,`left`并且`top`应该都有单位，尝试`px`在每个单位上添加一个。`z-index`当然不需要那个。

# javascript - 使用 JQuery .on() 函数添加单击事件会为列表中的每个项目触发

> ID：13012763
> 
> 赞同：1
> 
> 时间：2012-10-22T13:45:14.597
> 
> 标签：javascript, jquery, javascript-events, event-handling, onclick

所以，我有一个按钮，当单击该按钮时，它会动态地将新行插入表中。我希望能够从该表中删除行，所以我尝试使用 jquery 的 .on() 函数将点击处理程序附加到每行末尾的 span 元素......它工作正常，除了当我单击跨度以删除单个项目时，会为表中的所有项目调用单击事件......并且它们都被删除了。我如何连接它，以便它只调用我单击处理程序的行？这是我的代码：

这是js

```
$("#milestonesList").on('click', 'span[id*="tempmilestone"]', function (e) {
        $(this).each(function () {
            $('span[id*="tempmilestone"]').each(function () {
                alert("ON: " + $(this).attr("idx"));
                _milestones = _milestones.slice(parseInt($(this).attr("idx"), 10));
                buildMilestoneOutput(milestonesList);
            });
        });
    }); 
```

现在无论我点击哪一行，都会触发每一行的点击事件。我究竟做错了什么？谢谢！！

我已经尝试了很多方法，没有 .each() 函数，它仍然会为表中的每一行触发。也许如果我显示其余代码会有所帮助：

这是最后调用的 buildMilestoneOutput 函数：

```
function buildMilestoneOutput(container) {
    container.innerHTML = "";
    alert("Length: " + _milestones.length);
    var s = "<table id='testscroll' style='width: 690px; padding: 10px;'><tr><td style='font-weight: bold;'>Title</td><td style='font-weight: bold;'>Description</td><td style='font-weight: bold;'>DueDate</td></tr>"
    for (var i = 0; i < _milestones.length; i++) {
        s += "<tr><td style='width: 300px; padding-bottom: 10px;'>" + _milestones[i].Title + "</td><td style='width: 350px; padding-bottom: 10px;'>" + _milestones[i].Description + "</td><td style='width: 30px; padding-bottom: 10px;'>" + _milestones[i].Name + "</td><td><span idx='" + i + "' style='margin-left: 5px; cursor: pointer;'  id='tempmilestone'>remove</span></td></tr>";
    }
    s += "</table>";
    container.innerHTML = s;
} 
```

当用户单击“添加里程碑”按钮时，会调用此原始文件：

```
$("#lbAddMilestone").click(function () {

        milestonesList.innerHTML = "";
        var newMilestone = new GoalMilestone();
        newMilestone.Title = "New Milestone";
        _milestones.push(newMilestone);
        buildMilestoneOutput(milestonesList);
        wireupMilestoneDeletes();

        return false;
    }); 
```

这是wireupMilestoneDeletes：

```
function wireupMilestoneDeletes() {

    $("#milestonesList").on('click', 'span[id*="tempmilestone"]', function (e) {
        alert("ON: " + $(this).attr("idx"));
        _milestones = _milestones.slice(parseInt($(this).attr("idx"), 10));
        buildMilestoneOutput(milestonesList);
    });
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-22T14:00:35.793

您不需要每个循环，更不用说两个了。您将 click 事件绑定到`<span>`具有`id`包含`"tempmilestone"`和运行处理程序的任何 s，以单击*特定* `<span>`的单击。因此，这应该足够了：

```
$("#milestonesList").on('click', 'span[id*="tempmilestone"]', function (e) {
    alert("ON: " + $(this).attr("idx"));
    _milestones = _milestones.slice(parseInt($(this).attr("idx"), 10));
    buildMilestoneOutput(milestonesList);
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-22T15:38:53.890

好的……所以我想通了。我将wireupMilestonesDelete() 函数移到AddButton 点击​​事件之外，到$(document).ready 函数的正下方，它现在可以工作了。在每次插入新行之后，我都在为每一行添加一个新的单击事件。很高兴一切都结束了！:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-22T13:56:55.583

您正在使用 double each 循环，这在这里没有意义。至少，不是我理解的东西......

试试这个：

```
$("#milestonesList").on('click', 'span[id*="tempmilestone"]', function(e) {
    $(this).each(function() {       
            alert("ON: " + $(this).attr("idx"));
               //(.......)    
    });
});​ 
```

[jsfiddle](http://jsfiddle.net/TJwXU/1/)

# join - Doctrine 2.1 : Join 部分内的嵌套查询

> ID：13012769
> 
> 赞同：3
> 
> 时间：2012-10-22T13:45:22.540
> 
> 标签：join, symfony, doctrine-orm, left-join, nested-queries

我在构建 Doctrine 查询（在 Symfony 项目中）时遇到了很多麻烦，我刚刚完成它并且它可以工作，但我想获得你的建议，我不确定我的解决方案是最好的.

为了简单起见，我有 3 个 SQL 表：**Workshop**、**News**和**Comment**。他们中的最后两个与 Workshop 处于多对一关系。

我的目标是在一个页面上显示一个 Workshop 实体以及相关的 News 和 Comment 实体。为了使事情复杂一点，我只需要显示最后 5 个 News 和 Comment 实体。当然，这应该只在一个查询中完成（作为故障排除，我一直使用延迟加载）。

我设法进行了这个本机查询：

```
SELECT *
FROM Workshop w
LEFT JOIN (
    SELECT * FROM News ORDER BY id DESC LIMIT 0, 5
) n ON w.id = n.workshop_id
LEFT JOIN (
    SELECT * FROM Comment ORDER BY id DESC LIMIT 0, 5
) c ON w.id = c.workshop_id
WHERE w.id = 1 -- Random ID as an exemple 
```

在此之后，我想将其转换为 DQL，但这种语言不支持 FROM 和 JOIN 部分内的嵌套查询。

我最后的选择是使用本机查询......过了一会儿，我已经能够在我的 Workshop 存储库中获得这个结果：

```
<?php

public function getWorkshopWithAllContent()
{
    $rsm = new ResultSetMappingBuilder($this->_em);

    $rsm->addRootEntityFromClassMetadata('FON\WorkshopBundle\Entity\Workshop', 'w', array(
        'id' => 'wId'
    ));

    $rsm->addJoinedEntityFromClassMetadata('FON\WorkshopBundle\Entity\News', 'n', 'w', 'news', array(
        'id' => 'nId',
        'title' => 'nTitle',
        'content' => 'nContent',
        'pubDatetime' => 'nPubDatetime',
        'validated' => 'nValidated',
        'workshop_id' => 'nWorkshop_id'
    ));

    $rsm->addJoinedEntityFromClassMetadata('FON\WorkshopBundle\Entity\Comment', 'c', 'w', 'comments', array(
        'id' => 'cId',
        'title' => 'cTitle',
        'content' => 'cContent',
        'pubDatetime' => 'cPubDatetime',
        'validated' => 'cValidated',
        'workshop_id' => 'cWorkshop_id'
    ));

    $query = $this->_em->createNativeQuery(
        'SELECT '.
            'w.id wId, w.town, w.description, w.zipcode, w.address, '.
            'n.id nId, n.title nTitle, n.content nContent, n.pubDatetime nPubDatetime, n.validated nValidated, n.workshop_id nWorkshop_id, '.
            'c.id cId, c.title cTitle, c.content cContent, c.pubDatetime cPubDatetime, c.validated cValidated, c.workshop_id cWorkshop_id '.
        'FROM Workshop w '.
        'LEFT JOIN ( '.
        '    SELECT * FROM News ORDER BY id DESC LIMIT 0, 5 '.
        ') n ON w.id = n.workshop_id '.
        'LEFT JOIN ( '.
        '    SELECT * FROM Comment ORDER BY id DESC LIMIT 0, 5 '.
        ') c ON w.id = c.workshop_id '.
        'WHERE w.id = 1 ',
        $rsm
    );

    return $query->getOneOrNullResult();
} 
```

那么，为什么要重新定义几乎所有的列呢？因为如果我不这样做，就像这样：

```
<?php

public function getWorkshopWithAllContent()
{
    $rsm = new ResultSetMappingBuilder($this->_em);

    $rsm->addRootEntityFromClassMetadata('FON\WorkshopBundle\Entity\Workshop', 'w');

    $rsm->addJoinedEntityFromClassMetadata('FON\WorkshopBundle\Entity\News', 'n', 'w', 'news');

    $rsm->addJoinedEntityFromClassMetadata('FON\WorkshopBundle\Entity\Comment', 'c', 'w', 'comments');

    $query = $this->_em->createNativeQuery(
        'SELECT * '.
        'FROM Workshop w '.
        'LEFT JOIN ( '.
        '    SELECT * FROM News ORDER BY id DESC LIMIT 0, 5 '.
        ') n ON w.id = n.workshop_id '.
        'LEFT JOIN ( '.
        '    SELECT * FROM Comment ORDER BY id DESC LIMIT 0, 5 '.
        ') c ON w.id = c.workshop_id '.
        'WHERE w.id = 1 ',
        $rsm
    );

    return $query->getOneOrNullResult();
} 
```

我收到此错误：

```
The column 'id' conflicts with another column in the mapper. 
```

就是这样！我现在的问题是：有更好的解决方案吗？我的真的很长，我很惊讶 Doctrine 没有想到一个解决方案。

解决此问题的永久方法是重命名表的所有列，但我想知道在此之前是否有更简单的解决方案。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T05:39:46.563

Doctrine 的连接接口是自然的，但它在后台处理了相当多的事情，所以简单地尝试扩展 sql 有时会绊倒你。您没有显示实体结构，所以我猜车间看起来像：

YAML（我的偏好）：

```
Workshop:
  type: entity
  << other fields >>
  manyToOne:
    news:
      targetEntity: News
    comment:
      targetEntity: Comment 
```

或等效的注释（必须包括，因为大多数 stackoverflow 文章似乎都在注释中）：

```
class Workshop {
//... << other fields >>
/**
 * @ManyToOne(targetEntity="News")
 * @JoinColumn(name="news_id", referencedColumnName="id")
 */
private $comment;
/**
 * @ManyToOne(targetEntity="Comment")
 * @JoinColumn(name="comment_id", referencedColumnName="id")
 */
private $comment;
//...
} 
```

尝试：

```
public function getWorkshopWithAllContent($id){

    $qb= $this->_em->createQueryBuilder('w');
    $qb->leftJoin('w.news', 'n')
       ->leftJoin('w.comment', 'c')
       ->andWhere($qb->expr()->eq('w.id',$id));

    return $qb->getQuery()->getResult();

} 
```

Dotcrine 处理匹配您在 sql 中明确指定的 id。查看[http://docs.doctrine-project.org/en/2.0.x/reference/query-builder.html](http://docs.doctrine-project.org/en/2.0.x/reference/query-builder.html)了解更多优化查询的方法。

# css - 文本溢出省略号：避免分词

> ID：13012777
> 
> 赞同：16
> 
> 时间：2012-10-22T13:45:42.850
> 
> 标签：css

在我的网页中，我有一个固定宽度的 div 并使用以下 css：

```
width: 200px; 
overflow: hidden;
text-overflow: ellipsis;
white-space: nowrap; 
```

省略号是有效的，问题是它削减了最后一个单词，我希望它把省略号 (...) 放在一个完整单词的最后。

例如，如果我有文本：“stackoverflow 是最好的”，并且如果它需要在接近尾声时被剪切，我希望它显示“stackoverflow 是...”而不是“stackoverflow 是... "

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-22T16:03:20.403

恐怕这是不可能的。曾经有`text-overflow: ellipsis-word`，它可以做到这一点，但它没有在浏览器中实现，并且从 CSS3 草案中删除。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-11-18T02:48:15.370

当然有可能。（如果你愿意稍微改变你的标记。）

[https://jsfiddle.net/warphLcr/](https://jsfiddle.net/warphLcr/)

```
<style>
  .foo {
    /* Make it easy to see where the cutoff point is */
    border: 2px solid #999;

    padding-right: 18px; /* Always have room for an ellipsis */
    width: 120px;
    height: 1.1em; /* Only allow one line of text */
    overflow: hidden; /* Hide all the text below that line */
    background-color: #fff; /* Background color is required */
  }
  .foo > span {
    display: inline-block; /* These have to be inline block to wrap correctly */
    position: relative; /* Give the ellipsis an anchor point so it's positioned after the word */
    background-color: #fff; /* Cover the ellipsis of the previous word with the same background color */
    white-space: pre; /* Make sure the only point where wrapping is allowed is after a whole word */
  }
  .foo > span:after {
    position: absolute; /* Take the ellipsis out of the flow, so the next item will cover it */
    content: "…"; /* Each span has an ellipsis */
  }
  .foo > span:last-child:after {
    content: ""; /* Except for the last one */
  }
</style>

<div class="foo">
  <!-- These *must not* have white space between them, or it will collapse to a space before the next word, and the ellipsis will become visible -->
  <span>stackoverflow</span><span> is</span><span> the</span><span> best</span>
</div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-15T12:07:56.217

有一个 jQuery 插件可以做到这一点，称为[**dotdotdot**](http://dotdotdot.frebsite.nl/)。

它也适用于多行文本，并在文本重排时做出响应，例如屏幕大小发生变化。它还包括路径名的智能截断，例如`http://example.com/some/long/.../path.html`

* * *

请注意在宽度更改或以插件可能未预料到的方式变得不可用的情况下，基于宽度的计时问题的可能性，例如文本最初隐藏或更改字体（例如在某些浏览器上加载 Web 字体） . 可能需要重新申请或在此类更改后被申请。

但在 99% 的情况下，该插件看起来既快速又健壮。

# objective-c - Objective-c - 检测从 UIWebView 下载的文件

> ID：13012781
> 
> 赞同：0
> 
> 时间：2012-10-22T13:45:55.540
> 
> 标签：objective-c, url, uiwebview, download

在 safari 中，您可能会注意到有时文件可能会在 safari 中打开，有时可能会自动将相同类型的文件下载到计算机。我怎样才能从 UIWebView 中实现类似的功能。我不想单独检查文件类型然后下载，因为它可能是一个我不知道或忘记添加扩展名的文件，然后有时它应该在 UIWebView 本身中打开。我只是不知道如何检查该文件是否应该自动下载。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T13:59:07.550

尝试将 url 文件类型与 UIWebView 可以处理的文件类型列表进行比较。对于该列表，您可以参考技术[问答 QA1630](http://developer.apple.com/library/ios/#qa/qa1630/_index.html)

# jqgrid - jqGrid 插件没有在 URL 中设置页码

> ID：13012783
> 
> 赞同：0
> 
> 时间：2012-10-22T13:45:59.517
> 
> 标签：jqgrid

我有 jqGrid 插件的问题。如果我在例如第二页，并且我想更改任何列的排序方向，服务器将作为 URL 参数`page=1`（但应该是`page=2`）有什么问题？

```
<table id="list" class="scroll " cellpadding="0" cellspacing="0"></table>
<div id="pager" class="scroll" style="text-align:center;"></div> 
```

```
$(function () {

    $("#list").jqGrid({
        url: '/Control/UsersGridData/',
        datatype: 'json',
        mtype: 'GET',
        colNames: ['Name', 'User ID', 'Is Active', 'Last Action',  'Country'],
        colModel: [
  { name: 'Name', index: 'Name', width: 120, align: 'center', sortable: true, search: true },
  { name: 'UserID', index: 'UserID', width: 120, align: 'center', sortable: true, search: true },
  { name: 'IsActive', index: 'IsActive', width: 50, align: 'center', sortable: true, search: true },
  { name: 'LastAction', index: 'LastAction', width: 90, align: 'center', sortable: true, search: true },
  { name: 'Country', index: 'Country', width: 40, align: 'center', sortable: true, search: true }],
        pager: jQuery('#pager'),
        rowNum: 20,
        rowList: [5, 10, 20, 50],
        sortname: 'Name',
        sortorder: "desc",
        viewrecords: true,
        imgpath: '/scripts/themes/coffee/images',
        width: '800'
    });
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-22T14:43:45.470

页码将被显式更改（请参阅列标题上[单击](https://github.com/tonytomov/jqGrid/blob/v4.4.1/js/grid.base.js#L2347-2360)事件处理程序内部使用的代码[行](https://github.com/tonytomov/jqGrid/blob/v4.4.1/js/grid.base.js#L2013)[sortData](https://github.com/tonytomov/jqGrid/blob/v4.4.1/js/grid.base.js#L2003)函数）。

例如，您可以更改`onSortCol`事件处理程序内部的值。`<input>`您可以直接从pager的对应字段中获取当前页面的值： `$(pagerIdSelector).find("input.ui-pg-input").val()`where `var pagerIdSelector = $(this).jqGrid("getGridParam", "pager")`。

在我看来，将值重置`pager`为 1 是正确的行为。让我们有一些 20 页的网格，数据按“asc”顺序按第一列排序。如果显示第二页并且用户单击第一列。在这种情况下，排序顺序应反转为“desc”。在这种情况下，当前页面的页码大约为 18（仅当所有页面都充满行时才为 18）。如果用户单击任何其他列并且网格应按*另一列*排序，则当前页面上显示的行可以具有按新标准排序的 20 页中的*任何位置。*因为 jqGrid`page`在每次网格排序时将值重置为 1。

**更新**：您的代码的一些附加说明对您的主要问题并不重要：

*   jqGrid在初始化期间替换`pager: jQuery('#pager')`为。`pager: '#pager'`因此，没有必要通过 id 对元素进行不必要的搜索。最好始终使用 id-selector 语法作为`pager`选项。
*   `imgpath`选项 id[已弃用](http://www.trirand.com/jqgridwiki/doku.php?id=wiki:upgrade_from_3.4.x_to_3.5#options)，jqGrid 将忽略它。所以你应该删除它。
*   以同样的方式，您将 jqGrid 所需的减少 HTML 片段称为`<table id="list"></table><div id="pager"></div>`. 所有其他属性都已弃用，jqGrid 不会使用。
*   这些属性`sortable: true, search: true`是默认的（请参阅[文档](http://www.trirand.com/jqgridwiki/doku.php?id=wiki:colmodel_options)），应该删除它。以同样的方式，如果您使用与您可以删除属性定义`index`相同的值。如果您想在大多数列中使用，如果您要更改属性的默认值，则可以减少和简化代码。使用jqGrid 选项后（有关详细信息，请参阅[此处](https://stackoverflow.com/a/6047856/315935)），您可以在所有列中删除。在所有更改之后，所有项目的定义将像.`name``index``align: 'center'``align``cmTemplate: {align: 'center'}``align: 'center'``colModel``{ name: 'Name', width: 120 }`

# javascript - Knockoutjs 视图定位器？

> ID：13012788
> 
> 赞同：1
> 
> 时间：2012-10-22T13:46:07.970
> 
> 标签：javascript, mvvm, knockout.js

我想知道是否有任何方法可以在我的 html 中定义一个区域（div 标签？），模板根据它绑定到的对象而变化？

假设我们会有一个

*   ShellView / ShellViewModel
*   列表视图/列表视图模型
*   EditOneView / EditOneViewModel

ShellViewModel 有一个变量，它可以是 ListViewModel 或 EditOneViewModel，根据该变量，将使用 ListView 或 EditOneView。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-22T13:53:30.847

是的。您可以将一个函数传递给模板绑定中的 name 属性，该属性将选择要使用的函数：

```
<div data-bind='template: { name: whichTemplate }'></div>

var ShellViewModel = {
    //....

    whichTemplate: function(object) {
        // test which class you are using and return the name of the appropriate template
    }
} 
```

# php - Eclipse PDT - 找到不存在的类？

> ID：13012789
> 
> 赞同：1
> 
> 时间：2012-10-22T13:46:10.967
> 
> 标签：php, eclipse, class, eclipse-pdt

我必须从我们的框架中删除一个大型功能，因此删除所有基于它的类和函数。正如我现在所做的那样，我想检查我是否遗漏了一些代码点，其中删除的类和函数仍然被调用或使用。

有没有办法找到调用不存在的类或函数的代码点？我已经`grep`打消了念头，只是想看看我是否错过了什么。

在此先感谢，西蒙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T14:10:07.363

简短的回答：没有。

长答案：运行您的测试套件，看看它是否通过。如果是这样，这表明所有被测功能仍然有效。如果它坏了，你可能已经删除了太多的类定义。

在运行测试时启用错误日志记录，这样您就不会丢失任何可能导致 Phpunit 停机的致命错误。

# javascript - 从默认值访问静态属性

> ID：13012790
> 
> 赞同：2
> 
> 时间：2012-10-22T13:46:11.833
> 
> 标签：javascript, backbone.js

我有以下模型：

```
 var User = Backbone.Model.extend({
            defaults: {
                status:     this.constructor.status.OFFLINE,
            },
        },
        {
            status:   {
                OFFLINE: 0,
                ONLINE:  1,
                BUSY:    2,
                AWAY:    3,
            },
        }
    ); 
```

我也试过：

```
status:     User.status.OFFLINE 
```

但我不断收到此错误：

```
TypeError: 'undefined' is not an object (evaluating 'this.constructor.status.OFFLINE') 
```

或这个：

```
TypeError: 'undefined' is not an object (evaluating 'User.status') 
```

有什么帮助吗？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-22T14:26:58.327

您正在尝试引用在创建用户模型时未定义的静态属性。

将您的默认值定义为函数

```
var User = Backbone.Model.extend({
    defaults: function() {
        return {status: User.status.OFFLINE}
    }
}, {
    status:   {
        OFFLINE: 0,
        ONLINE:  1,
        BUSY:    2,
        AWAY:    3
    }
}); 
```

[http://jsfiddle.net/nikoshr/6XuC8/](http://jsfiddle.net/nikoshr/6XuC8/)

或首先定义您的静态属性，然后扩展 User.prototype 以添加您的默认值：

```
var User = Backbone.Model.extend({}, {
    status:   {
        OFFLINE: 0,
        ONLINE:  1,
        BUSY:    2,
        AWAY:    3
    }
});

_.extend(User.prototype, {
    defaults: {
        status: User.status.OFFLINE
    }
});

var u = new User();
console.log(u.get('status')); 
```

[http://jsfiddle.net/nikoshr/6XuC8/2/](http://jsfiddle.net/nikoshr/6XuC8/2/)

# javascript - 意大利面条 JavaScript 代码展开

> ID：13012791
> 
> 赞同：1
> 
> 时间：2012-10-22T13:46:16.173
> 
> 标签：javascript, coding-style

我写了这样的东西：

```
window.onload = function() {
    var a = new A();
    a.init();
};

A = function() {
    this.b = {};
};
A.prototype = {
    init : function() {
        document.writeln("init");
        this.b = new B();
        this.b.doCallback(this.init2);
    },

    init2 : function() {
        document.writeln("init2");
        this.b.say();
    }
};

B = function(){};
B.prototype = {
    doCallback: function(callback){
        callback();
    },

    say: function(){
        document.writeln("I'm B");
    }
}; 
```

对我来说，输出应该是这样的：

```
init
init2
I'm B 
```

但是，它看起来像这样：

```
init
init2 
```

Chrome 说方法“说”是未定义的。有人可以解释我为什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-22T13:52:02.720

这是因为在您的代码`this`中不代表 B 的实例。

> 与其他语言相比，函数的 this 关键字在 JavaScript 中的行为略有不同。严格模式和非严格模式也有一些区别。一般情况下，当前作用域绑定到 this 的对象是由当前函数的调用方式决定的，不能在执行时通过赋值来设置，每次调用函数时都可以不同。ES5 引入了 bind 方法来修复函数的 this，不管它是如何被调用的。

[https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/this](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/this)

因此，当您调用`callback`which is `init2`、`this.b`is`null`并且没有任何`say`方法时。

如果您使用的是 jQuery，您可以使用方法代理[http://api.jquery.com/jQuery.proxy/](http://api.jquery.com/jQuery.proxy/)

```
this.b.doCallback(jQuery.proxy(this.init2,this)); 
```

# excel - Excel - 带有条件的查找值

> ID：13012793
> 
> 赞同：0
> 
> 时间：2012-10-22T13:46:25.477
> 
> 标签：excel, excel-2007

我一直在尝试执行以下操作：

*   `Sheet1`，查找值`A3`在`Data`
*   `Data`, 检查找到的值是否有`1`in 列`M`
    *   是：粘贴列`K`中的`Data`列值`B3``Sheet1`
    *   否：继续搜索工作表，`0`如果没有找到则显示

这是我目前所拥有的，它找到了正确的 K 值，但我需要输入 shift+ctrl+enter 来获取值...

```
=INDEX('TLN Data'!$B$1:$Z$15000; MATCH(1;(A3='TLN Data'!$B$1:$B$15000)*(1='TLN Data'!$M$1:$M$15000);0); 10) 
```

非常感谢所有帮助！

--

表 1

![在此处输入图像描述](../Images/fddbd8d3a9ca54f3ec4272d4e659aa3b.png)

TLN 数据

![在此处输入图像描述](../Images/547eb3dca3227b6a24312701bb6e0554.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T14:25:08.797

您可以添加一个INDEX函数以获得不需要CSE的版本，即

`=INDEX('TLN Data'!$B$1:$Z$15000; MATCH(1;INDEX((A3='TLN Data'!$B$1:$B$15000)*(1='TLN Data'!$M$1:$M$15000);0);0);10)`

在某些情况下，这比 SUMPRODUCT 更可取，例如，返回值是文本，或者如果您有多个匹配项并且您只想要第一个。

您也可以像这样使用 LOOKUP：

`=LOOKUP(2;1/(A3='TLN Data'!$B$1:$B$15000)/(1='TLN Data'!$M$1:$M$15000);'TLN Data'!$K$1:$K$15000)`

如果有多个匹配项返回**最后一个，则使用该版本**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-22T13:59:38.273

尝试使用`SUMPRODUCT`（您不需要作为数组输入）：

```
=SUMPRODUCT(
    --('TLN Data'!$B$1:$B$15000=A3), 
    --('TLN Data'!$M$1:$M$15000=1),
    'TLN Data'!$K1:$K$15000) 
```

`MATCH`这使用与您上面的公式类似的逻辑：

1.  `1`返回一个's 和's的数组`0`，其中`1`表示列中的值`B`等于的行`A3`（`--`将数组转换为`1`'s 和`0`'s - 否则它包含`TRUE`/ `FALSE`）
2.  将该数组乘以另一个`1`'s 和`0`'s 数组，这次用 a`1`指示行，其中 column`M`包含数字`1`
3.  最后，将该数组乘以所有 column `K`。这会产生一堆`0`'s 的数组，然后是一个（或多个，取决于您的设置）值，这些值表示`K`满足您的条件的列中的值。

**编辑：**由于这涉及文本，`INDEX`@barryhoudini 提供的公式（与您的原始公式略有不同）可以解决问题。

# algorithm - 如何从单个集合中枚举组合的组合

> ID：13012801
> 
> 赞同：2
> 
> 时间：2012-10-22T13:47:13.330
> 
> 标签：algorithm, math, recursion, combinations, combinatorics

我意识到有很多关于组合学和枚举的问题，但我四处搜索并没有找到任何与我所追求的东西特别相关的东西。如果我错过了什么，请指出它，问题可以结束。

因此，假设我们有一组 N 个元素，并且我们有 x 个正整数 k1,...,kx，其中 Sum(k1,...,kx) <= N。我想列举我可以选择的所有方式（没有替换）给定大小的 x 个子集，来自原始 N 集合。

我希望我的措辞正确。如果我没有，一个简单的例子。
N = 4，x = 2，k1 = 2，k2 = 1。

我们应该列举

*   {1, 2} {3}
*   {1, 2} {4}
*   {1, 3} {2}
*   {1, 3} {4}
*   {1, 4} {2}
*   {1, 4} {3}
*   {2, 3} {1}
*   {2, 3} {4}
*   {2, 4} {1}
*   {2, 4} {3}
*   {3, 4} {1}
*   {3, 4} {2}

在一般情况下，我认为总数是：

C(N, k1) * C(N - k1, k2) * ... * C(N - Sum(k1,...,kn-1), kn)。

我最初的猜测是，这可以很容易地使用堆栈来完成。在每个堆栈级别 i 子集 ki 将使用标准组合枚举生成，或者从每个级别的源集中删除那些已选择的元素，或者仅从原始集中枚举并跳过之前已包含元素的情况.

我的问题，有没有更快/更优雅的解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-22T16:21:40.390

您的问题正是枚举多集排列的问题。（假设你的 k [i]是有序的）。

首先，请注意这个问题与 Σk = N 的问题完全等价，因为如果 Σk < N，我们可以简单地添加 k [x+1]，其值为 N - Σk。

现在，将原始集合 S 的元素按任意固定顺序放置，并生成由 k [1] 1、k [2] 2、k [3] 3、... k [x] x 组成的多重集的每个排列。这个多重集具有与 S 相同的大小 (N)，因为 k [i]加起来为 N。我们通过将 S 中的每个元素分配给其索引是多重集排列中的对应值的子集来创建 S 的分区.

例如，S = {apple、banana、chirimoya、date} (N = 4)。我们取 k [1] = 2 和 k [2] = 1 并加上 k [3] = 1 使总和为 4。（我们将忽略分配给子集 3 的元素）。现在我们枚举多重集的排列`1 1 2 3`（它有两个 1、一个 2 和一个 3，对应于 k）：

```
1 1 2 3    1 2 3 1    2 1 1 3    3 1 1 2
1 1 3 2    1 3 1 2    2 1 3 1    3 1 2 1
1 2 1 3    1 3 1 1    2 3 1 1    3 2 1 1 
```

我们将它们转换回 S 的分区。例如，取`1 3 1 2`：

```
apple     1 -> subset 1
banana    3 -> unused
chirimoya 1 -> subset 1
date      2 -> subset 2 
```

所以我们有`{{apple, chirimoya}, {date}}`

用于查找集合排列的[标准算法](http://en.cppreference.com/w/cpp/algorithm/next_permutation#Possible_implementation)在多集合上也同样适用，尽管如果多集合有很多重复项，它就不是最优的。

# android - 如何在android中动态选中/取消选中listview中的复选框？

> ID：13012805
> 
> 赞同：1
> 
> 时间：2012-10-22T13:47:30.957
> 
> 标签：android

这是我用来从数据库动态加载数据的代码，但我没有得到如何动态检查或取消选中复选框？这是我正在使用的代码。

```
String[] from = new String[]{"ToDisplay","MblNo", "_id"};

        // and an array of the fields we want to bind those fields to (in this case just tvViewRow)
        int[] to = new int[]{R.id.tvViewRow};

        // Now create a simple cursor adapter and set it to display
        SimpleCursorAdapter cursor = new SimpleCursorAdapter(this, R.layout.white_row, coloursCursor, from, to);

        setListAdapter(cursor);
        Cursor curs = DisplayWhiteAddress();
        curs.moveToFirst();
        int i=0;
        while(!curs.isAfterLast()){
            String s=""+curs.getString(2);

            myArrayList.add(i, s);
            s=""+curs.getString(0);

            myNumberList.add(i, s);
            ListIndices.add(i,Integer.parseInt(""+curs.getString(0)));

            curs.moveToNext();
            i++;
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T14:25:04.850

您可以使用以下方法：

```
cb.setChecked(true);
cb.setChecked(false); 
```

检查/取消检查检查。如果您可以向我们解释您的复选框在哪里...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-22T13:54:06.320

我在您的代码中没有看到任何复选框。但是当在您的代码中您知道是否应该检查您的复选框时，然后使用复选框对象的“setSelected(Boolean)”方法来设置它。

在这里检查：http: [//developer.android.com/reference/android/widget/TextView.html#setSelected%28boolean%29](http://developer.android.com/reference/android/widget/TextView.html#setSelected%28boolean%29)

# java - 具有多个键和多行的java集合

> ID：13012811
> 
> 赞同：-3
> 
> 时间：2012-10-22T13:47:39.120
> 
> 标签：java, collections

请在集合中提出一个想法以获得这样的数组：

```
{ 
    {id=>1, name=>"aa"},
    {id=>2, name=>"bb"},
    {id=>3, name=>"cc"}
} 
```

如果我遍历数组，我第一次给 id 意味着它应该给 1，第二次 2 应该来。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-22T13:55:46.403

你可以使用`ArrayList`一个数字索引的字符串集合

```
ArrayList<String> list = new ArrayList<String>();
list.add("a");
list.add("b");
list.add("c");

for (int i = 0; i < list.length; i++) {
    // i = 0, 1, 2
    // string = a, b, c
    String string = list.get(index);
}

for (String string : list) {
    // string = a, b, c
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-22T13:52:34.360

`public class obj{ String id; String name;}`

然后有一些像 `List<obj>, or ArrayList<obj>` `Map<obj,String> mp=new HashMap<obj, String>();`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-22T13:52:03.440

我认为您想使用[Java的 Map](http://docs.oracle.com/javase/6/docs/api/java/util/Map.html)。它基于键/值对。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-22T14:15:44.633

如果您以相同的方式插入数据，您可以使用它`LinkedHashMap`来获得预期的结果。如果这不是您想要的情况，请遵循其他建议。

# javascript - 在 setTimeout 之后执行一系列函数调用 - JavaScript

> ID：13012815
> 
> 赞同：0
> 
> 时间：2012-10-22T13:47:46.197
> 
> 标签：javascript

我有以下代码：

```
 var gradient = new Gradient( element, [0, 0.99] );
    setTimeout( function(){
        gradient.push( [0, 0.99] );
    }, 3000);

    setTimeout( function(){
        gradient.pop();
    }, 3000);

    setTimeout( function(){
        gradient.shift();
    }, 3000);

    setTimeout( function(){
        gradient.map( function( stop ){
                return Math.min( 1, stop + 0.392 );
            });
    }, 3000);

    setTimeout( function(){
        gradient.unshift( 0 );
        gradient.pop();
    }, 3000);

    gradient.clear(); 
```

我有一个径向渐变，在每次函数调用后都会发生变化（对渐变进行不同的操作）。为了最终演示每个函数调用所做的更改，我设置了一系列 setTimeout() 以便用户可以看到发生的更改。我期待在每个函数调用之后执行相应的操作，但是当我在浏览器上测试时，只执行最后一次调用（`gradient.clear()`）。我不确定之前的`setTimeout`调用是否正在执行，或者它被跳过直到最后一次调用。任何的想法 ？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-22T13:54:51.283

您不能`setTimeout`与`pause`. [MDN](https://developer.mozilla.org/en-US/docs/DOM/window.setTimeout)`setTimeout`文档定义为

> 在指定延迟后调用函数或执行代码片段。

没有提到暂停程序的执行。

```
setTimeout(f, 3000);
setTimeout(g, 3000);

h(); 
```

此代码*首先*执行 function ，`h`然后在三秒后执行（不同时，weather or come first 可能因实现而异。）`f``g``g``f`

您正在寻找的是事件链 -`setTimeout`从`setTimeout`函数内部调用。

你想要的可以用一个效果队列来实现

```
var q = []

function run() {
    var item = q.shift();
    item.func();
    if (q.length > 0) {
        setTimeout(run, item.pause);
    }
}

q.push({ func: f1, pause: 1000 });
q.push({ func: f2, pause: 1000 });

run()​; 
```

这里函数`f1`将执行，`f2`之后将执行一秒钟。

# windows-8 - 两个 Metro Apps 能否在 WinRT 中共享数据

> ID：13012821
> 
> 赞同：1
> 
> 时间：2012-10-22T13:47:58.400
> 
> 标签：windows-8, windows-runtime, winrt-xaml

WinRT 中是否有可供多个安装的应用程序访问的公共存储位置。? 场景如下： 1\. 我将有两个 Metro 应用程序，分别是 App1 和 App2 2\. 当 App1 启动时，我将一些文本数据写入存储 3\. 一段时间后，时间可能是一天，App2 启动 4\. 当 App2 启动时，我需要读取上面步骤 2 中存储的数据

基本上我想在 WinRT 中的两个应用程序中共享数据

问候， SRS

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T14:05:48.037

如果您谈论的是[应用程序数据](http://msdn.microsoft.com/en-us/library/windows/apps/hh464917.aspx)，那么不会——因为 Windows 8 应用程序执行的沙盒模型。您当然可以向文件系统写入数据和从文件系统读取数据，但这需要用户使用[文件选择器合约](http://msdn.microsoft.com/en-us/library/windows/apps/hh465174.aspx)明确同意。

您的应用程序也可以将数据存储在外部、云端或本地，并调用服务来读取/写入数据。[共享合约](http://msdn.microsoft.com/en-us/library/windows/apps/Hh758314.aspx)和[协议激活](http://msdn.microsoft.com/en-us/library/windows/apps/hh452686.aspx)是协作应用程序的另一种选择。最后，[原始推送通知](http://msdn.microsoft.com/en-us/library/windows/apps/Hh761488.aspx)可能在这里工作。

# python - pycurl CONNECT_TIME 在 Windows 上

> ID：13012823
> 
> 赞同：0
> 
> 时间：2012-10-22T13:48:02.847
> 
> 标签：python, networking, pycurl

我正在使用带有 pycurl 的 Windows，在返回 CONNECT_TIME 时出现计时问题，其中计时不准确。

使用pycurl时，有没有办法让windows中的connect_time更加准确。

目前我正在使用以下内容。

```
stats['connection_time'] = self.getinfo(CONNECT_TIME) 
```

如果我在代码周围使用 time.clock() 方法，那么这将不会返回连接时间，而是返回总时间，这是一个威慑指标。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T15:20:48.160

完全忘记了这个问题，但我想我会为其他人回答。看起来 pycurl 遇到的粒度问题类似于在 Windows 上使用 time.time 时遇到的粒度问题。

相反，我不得不编辑我的代码并手动计算完成任务所需的时间。

# c# - 使用 XElement 创建带前缀的 XML 元素

> ID：13012826
> 
> 赞同：1
> 
> 时间：2012-10-22T13:48:08.067
> 
> 标签：c#, xelement, prefix

我有一个使用包含多个 WPF 自定义组件的画布的应用程序。我想将这些组件导出到一个 XAML 文件中，以便另一个应用程序可以获取它，但是为了做到这一点，我需要为导出的组件添加前缀限定符。例如，如果我要导出一个 FrequencyButtonA 组件，我需要输出类似

```
<PanelControls:FrequencyButtonA Frequency="113.123" Width="250"/> 
```

我尝试了以下方法，但由于使用了“：”字符，我遇到了异常：

```
return new XElement("PanelControls:" + "FrequencyButtonA"); 
```

有任何想法吗？我在 SO 中发现了一些其他问题，这些问题似乎与我遇到的问题相似（例如，[这个链接](https://stackoverflow.com/questions/1338517/how-can-i-write-xml-with-a-namespace-and-prefix-with-xelement?lq=1)），但不是完全相同的场景。

提前致谢！

编辑 - 更多背景信息：这是我需要生成的完整输出的示例：

```
<Border x:Name="CommsPanelBorder"
    Style="{DynamicResource BorderTemplate}"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:PanelControls="clr-namespace:CommsPanelControlsLib.View;assembly=CommsPanelControlsLib"
    VerticalAlignment="Top">
        <PanelControls:FrequencyButtonB Frequency="113.123" Width="250"/>
        <PanelControls:FrequencyButtonA Frequency="102.3" Width="150"/> 
```

我忘了在我原来的帖子中提到根节点（边框）是在方法中创建的。然后，该方法遍历放置在画布中的所有元素，并在所述元素上调用一个方法，该方法返回一个 XElement，稍后将其添加到根节点。因此，我需要让 XElements 能够自己创建。该方法的代码如下：

```
XNamespace aw = "http://schemas.microsoft.com/winfx/2006/xaml/presentation";
        XNamespace ns = "PanelControls";
        var root = new XElement(aw + "Border",
            new XAttribute("Style", "{DynamicResource BorderTemplate}"),
            new XAttribute("Name", "CommsPanelBorder"),
            new XAttribute(XNamespace.Xmlns + "x", "http://schemas.microsoft.com/winfx/2006/xaml"),
            new XAttribute(XNamespace.Xmlns + "PanelControls", "clr-namespace:CommsPanelControlsLib.View;assembly=CommsPanelControlsLib"),
            new XAttribute("VerticalAlignment", "Top")
        );

        IEnumerable<CommsPanelControl> commsPanelControls = editCanvas.Children.OfType<CommsPanelControl>();

        foreach (var commsPanelControl in commsPanelControls)
        {
            XElement xElement = commsPanelControl.AddXElement(root, ns);
            root.Add(xElement);
        } 
```

编辑 2\. 添加了一些代码，以便 Reinder 可以看到我当前的方法：

```
XNamespace aw = "http://schemas.microsoft.com/winfx/2006/xaml/presentation";
        XNamespace ns = "PanelControls";
        var root = new XElement(aw + "Border",
            new XAttribute("Style", "{DynamicResource BorderTemplate}"),
            new XAttribute("Name", "CommsPanelBorder"),
            new XAttribute(XNamespace.Xmlns + "x", "http://schemas.microsoft.com/winfx/2006/xaml"),
            new XAttribute(XNamespace.Xmlns + "PanelControls", "clr-namespace:CommsPanelControlsLib.View;assembly=CommsPanelControlsLib"),
            new XAttribute("VerticalAlignment", "Top")
        );

        XElement xElement = new XElement(ns + "FrequencyButtonA",
            new XAttribute("Frequency", "113.123"),
            new XAttribute("Width", "250"));
        root.Add(xElement); 
```

编辑 3\. 作为参考，这是我的问题的可能解决方案。感谢莱纳您的意见！

```
XNamespace aw = "http://schemas.microsoft.com/winfx/2006/xaml/presentation";
        XNamespace ns = "clr-namespace:CommsPanelControlsLib.View;assembly=CommsPanelControlsLib";
        var root = new XElement(aw + "Border",
            new XAttribute("Style", "{DynamicResource BorderTemplate}"),
            new XAttribute("Name", "CommsPanelBorder"),
            new XAttribute(XNamespace.Xmlns + "x", "http://schemas.microsoft.com/winfx/2006/xaml"),
            new XAttribute(XNamespace.Xmlns + "PanelControls", "clr-namespace:CommsPanelControlsLib.View;assembly=CommsPanelControlsLib"),
            new XAttribute("VerticalAlignment", "Top")
        );

        XElement xElement = new XElement(ns + "FrequencyButtonA",
            new XAttribute("Frequency", "113.123"),
            new XAttribute("Width", "250"));
        root.Add(xElement); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-22T14:19:25.103

只有当您声明与其相关的命名空间时，前缀 like`PanelControls`才有意义。

您需要在节点本身或例如在根中指定它。

```
// create the root element, with the 'PanelControls' namespace
XNamespace nSpace = "PanelControls";
XElement element = new XElement("root",
          new XAttribute(XNamespace.Xmlns + "PanelControls", nSpace));

element.Add(addXElement("FrequencyButtonA", nSpace ));

...

private static XElement addXElement(string n, XNamespace ns)
{
    return new XElement(ns + n,
        new XAttribute("Frequency", 113.123),
        new XAttribute("Width", 250));
} 
```

方法 'addXElement()' 将在命名空间 ns 中创建新的 XElement，因此您最终会得到：

```
<?xml version="1.0"?>
<root xmlns:PanelControls="PanelControls">
    <PanelControls:FrequencyButtonA Width="250" Frequency="113.123"/>
</root> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-22T14:21:51.180

```
using System;
using System.Xml.Linq;

class Program
{
    static void Main(string[] args)
    {

        XNamespace @namespace = "PanelControls";
        XElement element = new XElement("root",
            new XAttribute(XNamespace.Xmlns + "PanelControls", @namespace),
            new XElement(@namespace + "FrequencyButtonA",
                new XAttribute("Frequency", 113.123),
                new XAttribute("Width", 250)));
        Console.WriteLine(element);
    }
} 
```

# java - 获取 vimeo api 的签名

> ID：13012828
> 
> 赞同：1
> 
> 时间：2012-10-22T13:48:11.890
> 
> 标签：java, android, eclipse, vimeo

这是我获取 oauth 令牌并为 vimeo 授权我的应用程序的代码。这工作正常：

```
WebView webview = new WebView(this);
        webview.getSettings().setJavaScriptEnabled(true);  
        webview.setVisibility(View.VISIBLE);
        setContentView(webview);

        Log.i(TAG, "Retrieving request token from Vimeo servers");

        try {

            final OAuthHmacSigner signer = new OAuthHmacSigner();
            signer.clientSharedSecret = Constants.CONSUMER_SECRET_VIMEO;

            OAuthGetTemporaryToken temporaryToken = new OAuthGetTemporaryToken(Constants.REQUEST_URL_VIMEO);
            temporaryToken.transport = new ApacheHttpTransport();
            temporaryToken.signer = signer;
            temporaryToken.consumerKey = Constants.CONSUMER_KEY_VIMEO;
            temporaryToken.callback = Constants.OAUTH_CALLBACK_URL;
            OAuthCredentialsResponse tempCredentials = temporaryToken.execute();
            signer.tokenSharedSecret = tempCredentials.tokenSecret;

            OAuthAuthorizeTemporaryTokenUrl authorizeUrl = new OAuthAuthorizeTemporaryTokenUrl(Constants.AUTHORIZE_URL_VIMEO);
            authorizeUrl.temporaryToken = tempCredentials.token;
            String authorizationUrl = authorizeUrl.build();
            Log.d("urlop", authorizationUrl);

            /* WebViewClient must be set BEFORE calling loadUrl! */  
            webview.setWebViewClient(new WebViewClient() {  

                @Override  
                public void onPageStarted(WebView view, String url,Bitmap bitmap)  {  
                    System.out.println("onPageStarted : " + url);
                }
                @Override  
                public void onPageFinished(WebView view, String url) 
                {  
                    Log.d("url", url);
                    if (url.startsWith(Constants.OAUTH_CALLBACK_URL)) {
                        try {

                            if (url.indexOf("oauth_token=")!=-1) {

                                String requestToken  = extractParamFromUrl(url,"oauth_token");
                                String verifier= extractParamFromUrl(url,"oauth_verifier");

                                signer.clientSharedSecret = Constants.CONSUMER_SECRET;

                                OAuthGetAccessToken accessToken = new OAuthGetAccessToken(Constants.ACCESS_URL);
                                accessToken.transport = new ApacheHttpTransport();
                                Log.d("abc", "");
                                accessToken.temporaryToken = requestToken;
                                Log.d("abc", accessToken.temporaryToken);
                                accessToken.signer = signer;

                                accessToken.consumerKey = Constants.CONSUMER_KEY;
                                accessToken.verifier = verifier;
                                Log.d("abc", accessToken.verifier);

                                OAuthCredentialsResponse credentials = accessToken.execute();

                                signer.tokenSharedSecret = credentials.tokenSecret;
                                Log.d("abc", signer.tokenSharedSecret);
                                CredentialStore credentialStore = new SharedPreferencesCredentialStore(prefs);
                                credentialStore.write(new String[] {credentials.token,credentials.tokenSecret});
                                view.setVisibility(View.INVISIBLE);
                                performApiCall();
                               // startActivity(new Intent(OAuthAccessTokenActivityVimeo.this,Vimeo.class));
                            } 
                            else if (url.indexOf("error=")!=-1) 
                            {
                                view.setVisibility(View.INVISIBLE);
                                new SharedPreferencesCredentialStore(prefs).clearCredentials();
                                startActivity(new Intent(OAuthAccessTokenActivityVimeo.this,MainMenu.class));
                            }

                        } catch (IOException e) {
                            e.printStackTrace();
                        }

                    }
                    System.out.println("onPageFinished : " + url);

                }
                private String extractParamFromUrl(String url,String paramName) 
                {
                    String queryString = url.substring(url.indexOf("?", 0)+1,url.length());
                    QueryStringParser queryStringParser = new QueryStringParser(queryString);
                    return queryStringParser.getQueryParamValue(paramName);
                }  

            });  

            webview.loadUrl(authorizationUrl);  
        } catch (Exception ex) {
            ex.printStackTrace();
        }
    } 
```

但是，`performApiCall()`我需要这样做：

```
String url = String.format("http://vimeo.com/api/rest/v2&format=json&full_response=1&method=vimeo.videos.search&oauth_consumer_key=%s&oauth_nonce=fb86e833df995307290763917343ae19&oauth_signature_method=HMAC-SHA1&oauth_timestamp=1350908218&oauth_version=1.0&per_page=20&query=umar&sort=newest&summary_response=1",
                                            Constants.CONSUMER_KEY

                                            ); 
```

我怎样才能得到`oauth_nonce`，`oauth_timestamp`和`oauth_signature`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T11:05:24.730

1.  Re `oauth_timestamp`: AFAIK，您**自己将时间戳设置**为当前时间戳。如果您遇到问题（vimeo 希望时间戳在它认为是当前时间戳之前或之后的差异不会超过几秒钟，请参见[此处的 vimeo 论坛线程](http://vimeo.com/forums/topic:22100)），请尝试调整您使用的系统时间（例如，服务器时间）。

2.  Re `oauth_nonce`: nonce 值是一个“随机字符串，**由客户端唯一生成，**以允许服务器验证以前从未发出过请求”（[OAuth 1.0 协议](https://www.rfc-editor.org/rfc/rfc5849#section-3.3)）。

3.  Re `oath_signature`:**客户端生成自己的签名**。来自[OAuth 1.0 协议](https://www.rfc-editor.org/rfc/rfc5849#page-18)：

> 客户端通过“oauth_signature_method”参数声明使用哪种签名方法。然后它生成一个签名（或等效值的字符串）并将其包含在“oauth_signature”参数中。服务器验证为每种方法指定的签名。

**简而言之：您不会从某个地方“获取”这些值，而是必须创建它们。**

我真的很想再次向您[推荐 OAuth 1.0 协议](https://www.rfc-editor.org/rfc/rfc5849)，它相当容易阅读，并且应该可以为您可能遇到的大多数查询排序:)。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T09:40:51.690

来自[http://developer.vimeo.com/apis/advanced](http://developer.vimeo.com/apis/advanced)

> 如果您对 OAuth 完全不熟悉，我们建议您在继续之前阅读 [hueniverse 的 OAuth 1.0 指南](http://hueniverse.com/oauth/guide/)。OAuth 很复杂，他很好地解释了这个过程。 [Twitter的指南](https://dev.twitter.com/docs/auth/oauth)也很不错。

另请观看以下资源（可能对您有所帮助）

*   [http://developer.vimeo.com/apis/advanced#official-libraries](http://developer.vimeo.com/apis/advanced#official-libraries)
*   [http://developer.vimeo.com/apis/advanced](http://developer.vimeo.com/apis/advanced)
*   [http://vimeoapi.tumblr.com/](http://vimeoapi.tumblr.com/)
*   [http://speckyboy.com/2012/10/31/coding-a-vimeo-api-instant-search-app-with-jquery/](http://speckyboy.com/2012/10/31/coding-a-vimeo-api-instant-search-app-with-jquery/)

# python - 通过 Tornado / Python 重启和恢复 ZigBee 传感器的启动配置

> ID：13012829
> 
> 赞同：0
> 
> 时间：2012-10-22T13:48:12.117
> 
> 标签：python, tornado, zigbee

我有个问题。我有一个项目，一个家庭自动化（家庭自动化）系统，我必须通过接口向一些传感器、温度传感器、功率传感器、接触传感器等发送一些命令。

我已经完成了可以将开/关/切换命令发送到 ZigBee 传感器的部分。我已遵循[本手册](http://cache.freescale.com/files/rf_if/doc/ref_manual/BSBBZTCRM.pdf)，此命令在第 196 页进行了描述。

我在我的项目中有这部分 python 来设置正确的数据包发送到传感器：

```
if command not in ['ON', 'OFF', 'TOGGLE']:
        raise tornado.web.HTTPError(404, "Unknown command: " + str(command))

    op_group = "70"
    op_code = "50"
    # *9999999999999999;70;50;;100260EB008060008000000D8#
    #                   70 50  100231AC00000000000008060008000101A9
    packet_meta = "*%s;%s;%s;%s;02%s%s600080000%s#"  # D8 i s the CRC who compute that?
    pkt_len = hextransform(16, 2)

    # Hexify the network ID
    netid = hextransform(int(nid), 16)
    # Hexify the sensor ID
    # TODO: - split sensor_id in ZTC sensor_id and endpoint!
    #       - ZTC sens ID is 2 bytes 
    #       - ZTC endpoint is 1 byte
#        sens_id = hextransform(int(sid) >> 8, 4)
#        end_point = hextransform(int(sid) & 0x0000FF, 2)

#        print("\nsens_id: '" + sens_id + "'\n")
#        print("\nendpoint: '" + end_point + "'\n")

    # TODO: - split sensor_id in ZTC sensor_id and clusterid!
    #       - ZTC sens ID is 2 bytes 
    #       - ZTC clusterid is 2 bytes
    sens_id = hextransform(int(sid) >> 16, 4)#elisa
    sens_id_little = invert2bytes(sens_id,0)
    cluster_id = hextransform(int(sid) & 0x00FFFF, 4)#elisa
    end_point = "08" #elisa

    if command == 'ON':
        cmd_data = "01"
    elif command == 'OFF':
        cmd_data = "00"
    elif command == 'TOGGLE':
        cmd_data = "02"

    packet = packet_meta % (netid, op_group, op_code, pkt_len, sens_id, end_point, cmd_data)
    packet = packet.upper()
    print("\t\t " + packet + "\n")

    ################ ELISA #########################################
    cmd_meta = "02%s000000000000080600080000%s" #elisa
    mycommand = cmd_meta % (sens_id_little, cmd_data) #elisa
    len_mycommand = len(mycommand)/2
    op_group_hex=0x70
    op_code_hex=0x50
    mynet_type ="ztc"

    cmdjson = packet2json(op_group_hex,op_code_hex, mycommand)
    #
    #
    #TODO : -write command into db  
    ts = datetime.datetime.now().isoformat()
    self.lock_tables("write", ['confcommands'])
self.db.execute("INSERT INTO confcommands (network_id, ntype, timestamp, command) \
                              VALUES (%s,%s,%s,%s)", nid, mynet_type, ts, cmdjson)
    self.unlock_tables(); 
```

现在，按照手册，我将添加重新启动命令以重新启动传感器。然后还要添加恢复启动配置命令。

所以我不知道这些命令在手册中的哪里。其中有几个。然后，我看不到命令​​重新启动或恢复启动配置的明确值。如果对于开/关/切换有三个值（00、01、02），在这种情况下，手册没有说明分配给 cmd_data 变量以创建正确的数据包以发送到传感器的值是什么。

我希望你能帮助我，因为我不知道在哪里搜索这个了。非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T14:06:33.430

我不知道 ZigBee 技术，但根据您的文档，您可以尝试发送调用的 APS 消息`APSME-RESET.Request`和`APSME-REST.Confirm`用于平台重置或`NLME-Reset.Request`网络`NLME-Reset.Confirm`管理器重置

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T16:48:33.560

看起来此代码正在使用 ZigBee OnOff 集群 (0x0006)，因为这些命令与您的代码正在执行的操作相匹配。由于 ZigBee 是 little endian，因此`0600`代码中的序列之一是集群 ID。

基本集群 (0x0000) 支持单个命令 0x00，它将设备重置为出厂默认设置。请小心使用此命令，因为它可能会导致设备离开网络并返回其默认网络设置。

我不知道可用于重启/重启设备的 ZCL（ZigBee 集群库）集群和命令。ZigBee 传感器旨在运行多年而无需重新启动。

要了解有关 ZCL 集群和命令的更多信息，您可以从[ZigBee 联盟下载](http://www.zigbee.org/)[ZigBee 集群库](http://www.zigbee.org/Products/ZigBeeClusterLibraryDownload.aspx)。

为什么您的设备需要重新启动传感器？

# objective-c - 当我想使用 SOAP 使用 Web 服务时发生错误

> ID：13012830
> 
> 赞同：0
> 
> 时间：2012-10-22T13:48:12.867
> 
> 标签：objective-c, xcode, web-services, soap, ios4

我创建了一个 Web 服务（`SampleService.asmx`）并在其中放入了一个返回字符串的方法（`GetAllUserInfo2`）。我对其进行了测试`Visual Studio`并正常工作。

我使用下面的消息来消费它，我检查日志文件但发生错误

```
//Message
NSString *soapMessage=@"<?xml version=\"1.0\" encoding=\"utf-8\"?>\n"
     "<soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\">\n"
     "<soap:Body>\n"
     "<GetCategory xmlns=\"http://jahanmir.ir/\" />\n"
     "</soap:Body>\n"
     "</soap:Envelope>";

    NSURL *tmpURl=[NSURL URLWithString:[NSString stringWithFormat:@"http://www.jahanmir.ir/SampleService.asmx"]];
    NSMutableURLRequest *theRequest=[NSMutableURLRequest requestWithURL:tmpURl];
    [theRequest addValue:@"text/xml; charset=utf-8" forHTTPHeaderField:@"Content-Type"];
    //[theRequest addValue:@"http://jahanmir.ir/GetAllUserInfo2" forHTTPHeaderField:@"SOAPAction"];
    [theRequest addValue:@"http://jahanmir.ir/SampleService.asmx?op=GetAllUserInfo2" forHTTPHeaderField:@"SOAPAction"];
    NSString *msgLength=[NSString stringWithFormat:@"%i",[soapMessage length]];
    [theRequest addValue:msgLength forHTTPHeaderField:@"Content-Length"];
    [theRequest setHTTPMethod:@"POST"];
    [theRequest setHTTPBody:[soapMessage dataUsingEncoding:NSUTF8StringEncoding]];
    NSURLConnection *con=[[NSURLConnection alloc] initWithRequest:theRequest delegate:self];
    if(con)
        webData=[[NSMutableData data] retain];//webData is `NSMutableData` 
```

* * *

```
//Log
2012-10-22 17:39:50.533 WebServices[522:f803] data: <?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"><soap:Body><soap:Fault><faultcode>soap:Client</faultcode><faultstring>Server did not recognize the value of HTTP Header SOAPAction: http://jahanmir.ir/SampleService.asmx?op=GetAllUserInfo2.</faultstring><detail /></soap:Fault></soap:Body></soap:Envelope> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T14:01:55.603

看起来你的问题在这一行`[theRequest addValue:@"http://jahanmir.ir/GetAllUserInfo2" forHTTPHeaderField:@"SOAPAction"];`

您正在向根而不是 asmx 文件发出服务请求。这未经测试，但我认为你会想要为`http://jahanmir.ir/SampleService.asmx?op=GetAllUserInfo2`

# html - 在 Opera 中，输入被黑色包围

> ID：13012831
> 
> 赞同：2
> 
> 时间：2012-10-22T13:48:13.917
> 
> 标签：html, input, border, opera

浏览器：Opera 12

在浏览器 Opera 中，如果该块包含至少一个 2 输入，其中之一是 type = "submit"，则按下普通输入字段 - type = "submit" 的输​​入参数将分配一个黑色边框。

![在此处输入图像描述](../Images/29d721221c2530222bca2f3959dc5ef6.png)

type = "submit" 的输​​入代码：

```
<input type="submit" id="SearchBlock_BtnSearch" value="Search" class="mc-button mc-button-orange"/> 
```

款式：

```
.mc-button {
background: -o-linear-gradient(to bottom, #EEEEEE, #D3D3D3) transparent;
border-bottom: 1px solid #919191;
border-left: 0px solid #919191;
border-radius: 10px;
border-right: 0px solid #919191;
border-top: 0px solid #919191;
clear: none;
color: #676767;
cursor: pointer;
float: left;
font-family: "Myriad Pro", "Arial", "Helvetica", sans-serif;
font-size: 12px;
height: 26px;
letter-spacing: 0.01px;
line-height: 26px;
min-width: 10px;
overflow: visible;
padding: 0px 24px !important;
position: relative;
text-align: center;
text-decoration: none;
text-shadow: 0px 1px #F3F3F3;
text-transform: uppercase;
}

.mc-button-orange { 
background: -o-linear-gradient(to bottom, #EEEEEE, #D3D3D3) transparent;
border-bottom: 1px solid #919191;
color: #676767;
position: relative;
text-shadow: 0px 1px #F3F3F3;
} 
```

请告诉我，如何解决这个问题？

展望未来，按钮有一个边框，因此，如果我们应用边框：无 - 消失，黑色轮廓和按钮的边框

PS 由谷歌翻译

**升级版：**

如果在 CSS 开头指定问题就消失了：

```
noindex:-o-prefocus, input[type="submit"] {
    border: none;
}

noindex:-o-prefocus, input[type="submit"]:hover {
    border: none;
} 
```

但是，此解决方案完全去除了边界，这是不可取的

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T13:59:09.857

尝试添加：

```
* {
border: 0px;
} 
```

在 css 文件的开头。这可以防止浏览器放置他的默认边框

# android - 水平 ProgressBar 的粗细

> ID：13012833
> 
> 赞同：3
> 
> 时间：2012-10-22T13:48:16.697
> 
> 标签：android, android-view, android-progressbar

我想实现一个厚的水平进度条，但是我无法让它变厚。我试过`android:minHeight="300dp"`了，但这没有帮助。酒吧仍然很薄。

这是我的 XML 的摘录：

```
 <RelativeLayout
        android:id="@+id/server_top_left"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:layout_gravity="left"
        android:layout_weight="1" >

        <Button
            android:id="@+id/config"
            android:layout_width="150dp"
            android:layout_height="80dp"
            android:layout_marginLeft="5dp"
            android:layout_marginTop="5dp"
            android:background="@android:color/white"
            android:text=" Config "
            android:textSize="18sp" />

        <Button
            android:id="@+id/control"
            android:layout_width="150dp"
            android:layout_height="80dp"
            android:layout_marginLeft="5dp"
            android:layout_marginTop="5dp"
            android:layout_toRightOf="@+id/config"
            android:background="@android:color/white"
            android:text=" Control "
            android:textSize="18sp" />

        <ProgressBar
            android:id="@+id/progressBar1"
            style="?android:attr/progressBarStyleHorizontal"
            android:layout_width="300dp"
            android:layout_height="wrap_content"
            android:layout_below="@+id/control"
            android:layout_centerHorizontal="true"
            android:layout_marginTop="50dp"
            android:minHeight="300dp"
            android:progress="79" />

        <ProgressBar
            android:id="@+id/progressBar2"
            style="?android:attr/progressBarStyleHorizontal"
            android:layout_width="300dp"
            android:layout_height="300dp"
            android:layout_below="@+id/progressBar1"
            android:layout_centerHorizontal="true"
            android:layout_marginTop="50dp"
            android:minHeight="300dp"
            android:progress="50" />
    </RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-22T15:08:07.117

制作您的自定义进度条样式。您可以通过更改 radius 属性来修改 progress_horizo​​ntal.xml，也可以通过更改 drawables 来修改 progress_horizo​​ntal_holo.xml。

# ruby-on-rails - 读取 csv 文件的最佳 gem 文件

> ID：13012835
> 
> 赞同：-3
> 
> 时间：2012-10-22T13:48:19.167
> 
> 标签：ruby-on-rails

在我的应用程序中，我需要读取一个 csv 文件并填写 jqGrid 中的行。

哪个 gem 最适合读取 csv 文件？

我找到了 csv-mapper 和 fastcsv。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T13:52:47.587

我一直使用fastcsv，它开始工作非常简单，不需要太多代码就可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-22T14:17:41.883

除非你有一些你没有提到的不寻常的要求，Ruby 的内置[CSV 类](http://ruby-doc.org/stdlib-1.9.2/libdoc/csv/rdoc/CSV.html)应该可以完成这项工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-22T14:21:14.247

答案取决于您使用的 Ruby 版本。我对 Ruby 1.8 上的 fastcsv 非常满意。现在在 Ruby 1.9 上，fastcsv 已被纳入标准库，因此无需拉出 gem，只需`require "CSV"`.

# .net - 将本地化字符串写入本地化文件

> ID：13012838
> 
> 赞同：0
> 
> 时间：2012-10-22T13:48:31.477
> 
> 标签：.net, vb.net, string, file-io, localization

我有以下代码：

```
Dim fecha As DateTime = DateTime.Now
Using w As StreamWriter = File.AppendText(fichero.Text)
    w.WriteLine(fecha.ToString("dd/MM/yyyy") + vbTab + tiempo.Text + vbTab + comentario.Text)
    w.Close()
End Using 
```

从 .NET 4 中的 Windows 窗体调用它，其中*tiempo*和*comentario*是您获取字符串的两个文本框。我遇到的问题是，如果我写一个带有撇号的本地化短语，它们在文本文件中显示为“Ã³”“Ã©”或“Ã-”，而不是“ó”“é”和“í”。

知道如何设置函数以正确编写本地化短语吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T14:46:48.620

`File.AppendText`您可以创建一个新的`StreamWriter`并指定您喜欢的任何编码，而不是使用。例如 1252 表示拉丁语（西欧语言）。第二个参数指定文本应附加到文件中。

```
Using writer = New StreamWriter(fichero.Text, True, Encoding.GetEncoding(1252))
    writer.WriteLine(fecha.ToString("dd/MM/yyyy") + vbTab + tiempo.Text + vbTab + comentario.Text)
End Using 
```

还处置作者将调用`Close`（无需显式调用它）

# http - 当出于特定原因不允许 DELETE 操作时返回哪个 HTTP 状态代码

> ID：13012842
> 
> 赞同：26
> 
> 时间：2012-10-22T13:48:39.320
> 
> 标签：http, asp.net-web-api, http-status-codes, http-delete

假设我有一个`/api/shipments/100`支持 HTTP DELETE 方法的资源（例如：）。从 URI 本身可以理解，如果对该 URI 发出 DELETE 请求，则该资源将被删除。

在我目前的场景中，DELETE 请求只有在满足特定条件时才能成功执行，如下所示：

*   如果货件状态未设置为 InTransit 或 Delivered。

如果有针对该 URI 的 DELETE 请求并且不满足上述条件，那么在这种情况下返回哪个 HTTP 状态代码更合适？我已经考虑过以下内容，但无法确定哪一个更具语义：

*   405 方法不允许
*   403 禁止
*   409 冲突

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-10-22T13:53:20.473

我会选择**`409: Conflict`**，因为您拥有的是对资源状态的违反。

**`405: Method Not Allowed`**也可以。如果您想使用 a `405`，您必须发送一个`Allow`标头来指示支持的方法，并且支持的方法会因资源的状态而异。在我看来，此响应代码非常适合只读资源、无法删除的资源等，但[Darrel](https://stackoverflow.com/users/6819/darrel-miller)对这篇文章的评论是有效的。规范不明确：

> Request-URI 所标识的资源不允许使用 Request-Line 中指定的方法。响应必须包含一个 Allow 标头，其中包含所请求资源的有效方法列表。

无论哪种情况，您都应该在响应正文中提供信息，以便客户端了解错误的来源。

* * *

关于提到的其他两种方法：

`403: Forbidden`当您没有适当的权限来修改资源时应该使用，即如果您必须是管理员才能删除该资源而您不是。

`412: Precondition Failed`主要用于条件请求，其中先决条件在请求标头中明确指定。例如，您可以有条件 PUT 请求，这些请求仅应在`If-Match`标头有效时执行。如果您未在请求标头中指定任何内容，我仍然会选择 409 而不是 412。这是 412 的规范：

> 在服务器上测试时，一个或多个请求标头字段中给出的前提条件评估为假。此响应代码允许客户端对当前资源元信息（标头字段数据）设置先决条件，从而防止将请求的方法应用于预期之外的资源。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-22T13:55:06.710

我会使用 412: Precondition Failed。

请参阅此以获取 HTTP 状态代码

[网页状态码](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html)

# c# - 来自类方法的可能解析错误

> ID：13012844
> 
> 赞同：0
> 
> 时间：2012-10-22T13:48:43.833
> 
> 标签：c#, parsing

因此，我试图从类方法将账单总成本的十进制值返回到文本框中。

这个类方法如图：

```
public decimal calcCost(decimal totalCost, bool specialistRepair, decimal labourHours,      decimal standardRate, decimal partSaleCost)
    {

        foreach (Job j in m_jobs)
        {
            if (specialistRepair == true)
            {
                totalCost = totalCost + 45;
            }

            totalCost = totalCost + partSaleCost + (labourHours * standardRate);
        }

        return totalCost;
    } 
```

我遇到的问题是它说'不能隐式地将类型'十进制转换为'字符串'。

我尝试在“=”符号之后解析整行，但这是不可能的。

```
txtTotal.Text = //Here// Program.AuspexDo.calcCost(0, checkSpecialist, jobHours, standardRate, partSaleCost); 
```

main 的代码如下所示：

```
 bool checkSpecialist = true;
        if (chkSpecialistRepairs.Checked == true)
        {
            checkSpecialist = true;

        }

        decimal jobHours = decimal.Parse(txtHours.Text); 
        decimal standardRate = Program.AuspexDo.StandardRate;
        decimal partSaleCost = 5; //to be configured

        txtTotal.Text = Program.AuspexDo.calcCost(0, checkSpecialist, jobHours, standardRate, partSaleCost); 
```

如果有人可以提供帮助，将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-22T13:50:51.087

将其更改为

```
txtTotal.Text = Program.AuspexDo.calcCost(0, checkSpecialist, jobHours, standardRate, partSaleCost).ToString(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-22T13:55:12.050

`calcCost`返回 a`decimal`并且您试图将返回值分配给`txtTotal.Text`，它的类型是`string`。

正如错误所说，两者之间没有转换 - 您需要将返回值转换为`string`第一个 - 这样做的方法是调用`ToString()`返回值：

```
txtTotal.Text = Program.AuspexDo.calcCost(0, 
                                          checkSpecialist, 
                                          jobHours, 
                                          standardRate, 
                                          partSaleCost)
                                          .ToString(); 
```

查看[自定义](http://msdn.microsoft.com/en-us/library/0c899ak8.aspx)和[标准](http://msdn.microsoft.com/en-us/library/dwhawy9k.aspx)数字格式字符串，以及有关[复合格式字符串](http://msdn.microsoft.com/en-us/library/txafckwd.aspx)的信息，因为您可能希望输出为特定格式。

# unit-testing - 单元测试断言的目的不是简单的真值测试

> ID：13012850
> 
> 赞同：2
> 
> 时间：2012-10-22T13:48:59.180
> 
> 标签：unit-testing

除了 xUnit 提供的基本断言之外，我无法理解其他断言可以提供什么`Assert.True`。在我们的单元测试中使用其他类型的断言有什么好处？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-22T13:54:49.547

在 JUnit 中，我更喜欢使用 Hamcrest (assertThat) 进行所有匹配。我觉得它给出了更具可读性的断言。有大量可用的匹配器，错误消息的信息量更大。

例如，假设您有一个`List<String>`. 其中`assertTrue`可能是：

```
assertTrue(myList.size() == 3); 
```

这个 if 的错误信息`expected true, got false`。与 Hamcrest 相比，

```
assertThat(myList, IsCollectionWithSize.hasSize(3)); 
```

或使用静态导入

```
 assertThat(myList, hasSize(3));
 assertThat(myList, containsInOrder("first", "second")); 
```

错误信息是`expected collection with size 3, got list["blah", "blah" ...]`

还有额外的匹配器，例如`containsString`, `IsIterableContainingInOrder`, `IsIterableContainingInAnyOrder`, 等等等等。

[汉克雷斯特](http://hamcrest.org/JavaHamcrest/javadoc/1.3/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-22T13:52:37.363

主要是为了可读性。例如：

```
StringAssert.StartsWith('abc', s); 
```

可能比以下更具可读性：

```
Assert.True(s.StartsWith('abc')) 
```

一些断言虽然做了其他有用的事情，例如`Assert.Fail();`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-22T13:55:31.283

我想它提供了一些可读性。Assert.IsNotNull(obj) 比 Assert.True(obj != null) 更容易看

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-22T18:21:51.393

for readability. tests should be the documentation of your code.

whenever possible i use [fest assert](https://github.com/alexruiz/fest-assert-2.x/wiki/Using-fest-assertions) with plain old assertXXX without any expressions. if not possible (or requires to much work with predicates) i use [hamcrest](http://code.google.com/p/hamcrest/wiki/Tutorial). using complex expressions with assertXXX is the last resort for me

# eclipse - 在哪里可以找到 hadoop 1.0.4 的 eclipse 插件

> ID：13012852
> 
> 赞同：2
> 
> 时间：2012-10-22T13:49:22.503
> 
> 标签：eclipse, hadoop-plugins

最近在研究Hadoop，想用eclipse用Hadoop做一些MapReduce程序。

环境是：

Hadoop 1.0.4；

日食 4.2.1；

但我在 Hadoop 1.0.4 中找不到 eclipse 插件。

谁能告诉我eclipse插件在哪里？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-23T12:07:58.773

我不知道为什么，但由于某种原因，他们已从 Hadoop 安装文件夹中删除了该插件。相反，您可以在“HADOOP_HOME//src/contrib/eclipse-plugin”目录中找到带有 build.xml 文件的 Eclipse 插件源代码。尝试从那里拉出来并构建。

# android - ListView 中的 TextField 可聚焦性

> ID：13012856
> 
> 赞同：3
> 
> 时间：2012-10-22T13:49:32.537
> 
> 标签：android, xml

我是 android 新手，想要制作一个自定义适配器，这样每一行都会保存一个图像并在它旁边放置一些信息。我还想放置一个 textField。我这样做了，但我不能使用它们，这意味着它们看起来应该是这样，但是当我触摸它时，它永远不会打开软键盘。我的猜测是它没有得到请求的焦点。有什么想法吗？我会发布我写了这么多的 xml 必须是我的字段我失踪了。非常感谢您抽出宝贵的时间。

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="?android:attr/listPreferredItemHeight"
    android:padding="6dip"
    android:descendantFocusability="blocksDescendants" >

<ImageView
    android:id="@+id/icon"
    android:layout_width="wrap_content"
    android:layout_height="fill_parent"
    android:layout_marginRight="6dip"
    android:src="@drawable/std" />

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical">

<LinearLayout
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_marginTop="@dimen/padding_small"
    android:orientation="horizontal" >

    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Name" />

    <TextView
        android:id="@+id/textView2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginLeft="45dp"
        android:text="TextView"
        android:textSize="10dp" />

</LinearLayout>

<LinearLayout
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_marginTop="@dimen/padding_small"
    android:orientation="horizontal" >

    <TextView
        android:id="@+id/textView3"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Grade" />

<EditText
    android:id="@+id/txtPassword"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:inputType="textPassword" >

</EditText>

</LinearLayout>

<LinearLayout
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_marginTop="@dimen/padding_small"
    android:orientation="horizontal" >

    <TextView
        android:id="@+id/textView5"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Comment" />

    <TextView
        android:id="@+id/textView6"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginLeft="25dp"
        android:textSize="10dp" />

</LinearLayout>

        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_marginTop="@dimen/padding_small"
            android:orientation="horizontal" >

    <TextView
        android:id="@+id/textView7"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Present" />

    <CheckBox
        android:id="@+id/checkBox1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginLeft="20dp" />

</LinearLayout> 
```

这就是我的 getView 方法

```
 public View getView(final int position, View convertView, ViewGroup parent) {

    convertView=null;

    ViewHolder holder;

    if (convertView == null) {

        convertView = mInflater.inflate(com.example.myapp.R.layout.rw, null);           

        TextView tt = (TextView) convertView.findViewById(mIds[1]);
        TextView bt = (TextView) convertView.findViewById(mIds[0]);
        TextView btt = (TextView) convertView.findViewById(mIds[2]);
        EditText bttt = (EditText) convertView.findViewById(mIds[3]);
        TextView a = (TextView) convertView.findViewById(mIds[4]);
        TextView av= (TextView) convertView.findViewById(mIds[5]);
        TextView avt= (TextView) convertView.findViewById(mIds[6]);
        CheckBox check = (CheckBox) convertView.findViewById(mIds[7]);

        if (tt != null) {
              tt.setText(mContent.get(position));
              tt.setTextColor(Color.RED);
       }
        if(bt != null){
              bt.setText("Name: ");
              bt.setTextColor(Color.BLUE);
        }
        if(btt != null){
              btt.setText("Grade:");
              btt.setTextColor(Color.BLUE);
        }
        if(a != null){
          a.setText("Comments:"); 
          a.setTextColor(Color.BLUE);
      }
      if(av != null){
          av.setText("..."); 
          av.setTextColor(Color.RED);
      }
      if(avt != null){
          avt.setText("Present:"); 
          avt.setTextColor(Color.BLUE);
      }

      holder = new ViewHolder(tt);

          ((CheckBox)convertView.findViewById(mIds[7])).setOnCheckedChangeListener(new
              onCheckedChangeListener() { 

            public void onCheckedChanged(CompoundButton buttonView, 
                                                    boolean isChecked) { 
              // TODO Auto-generated method stub 
              if (buttonView.isChecked()) { 
                  checkModel.get(position).status=true;
              } 

            }
           });

    }else {

    holder = (ViewHolder) convertView.getTag();

     }   

       ((CheckBox)convertView.findViewById(mIds[7])).setChecked(checkModel.get(position).status);
     ((EditText) convertView.findViewById(mIds[3])).setText("lalla");

         return convertView;
     } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T14:16:24.037

我认为，android 将点击视为点击`ListView`而不是您的`TextView`. 尝试为您的组件调整这些设置，而不是`EditText`

```
android:focusable="false"
android:focusableInTouchMode="false" 
```

或尝试

```
android:focusable="true"
android:focusableInTouchMode="true" 
```

为您的`EditText`.

以及为什么你有这么多LinearLayouts，尝试用[RelativeLayout替换它](http://developer.android.com/reference/android/widget/RelativeLayout.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-22T13:56:07.130

要在 textview 旁边保存图像，请在代码中执行以下操作`onCreate()`：

```
 phoneno.setCompoundDrawablesWithIntrinsicBounds(null, null, getResources().getDrawable(android.R.drawable.sym_action_call), null); 
```

# sql - 忽略编译错误 - 用正文创建过程，不管

> ID：13012862
> 
> 赞同：1
> 
> 时间：2012-10-22T13:49:46.220
> 
> 标签：sql, sql-server-2008-r2, linked-server

有没有办法强制 SQL Server 2008R2 创建一个包含链接服务器查询的存储过程，其中链接服务器不存在，或者存在但没有数据源。

我完全知道这听起来多么愚蠢，但将所有数据库对象（包括 SP）部署到所有服务器上的所有数据库是公司的政策。但是在这种情况下，我无法在所有服务器上创建链接服务器。

返回的错误是

> 消息 7314，级别 16，状态 1，过程 TestLinkedSever，第 23 行链接服务器“LinkedServer”的 OLE DB 提供程序“SQLNCLI10”不包含表“数据库”。“dbo”。“表”。该表不存在或当前用户对该表没有权限。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T13:53:22.173

我建议使存储过程基于动态 SQL，并将服务器名称存储在表中。我参与了一些项目，我们必须修复链接服务器名称，因为公司标准强制在升级时更改名称。这不好玩。

# c# - 复制图像并将其保存到其他目录

> ID：13012864
> 
> 赞同：5
> 
> 时间：2012-10-22T13:49:51.437
> 
> 标签：c#, winforms

我是 C# 的初学者。在我的项目中，如果我尝试使用以下代码保存图像副本，则会出现错误“GDI+ 中发生一般错误”。. 我已经浏览了这个[链接](https://stackoverflow.com/q/1053052/1577396)，但我不知道他在说什么。

我尝试了以下代码：

```
 Bitmap bmpLarge = new Bitmap(ofdFlagsLarge.FileName);
 bmpLarge.Save(@"\..\..\" + strLargePath);               /* ERROR */ 
```

有人可以帮我将图像从本地 PC 目录本身保存到同一台机器上的其他目录..

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-10-22T13:53:06.270

你只是想复制一个文件？

为什么不使用：

```
System.IO.File.Copy("source", "destination"); 
```

[http://msdn.microsoft.com/en-us/library/c6cfw35a.aspx](http://msdn.microsoft.com/en-us/library/c6cfw35a.aspx)

# macos - CMSEncodeContent 因 errSecNoSuchKeychain 失败 (-25294)

> ID：13012866
> 
> 赞同：0
> 
> 时间：2012-10-22T13:50:04.213
> 
> 标签：macos, cryptography

我有一个适用于 OSX 安全框架的程序。我以两种模式启动我的程序。

在第一种模式下，程序调用几个安全框架函数：

1.  调用 SecPCS12Import 函数并成功导入带有私钥的证书并创建身份参考。

    ```
     CFStringRef passwordRef = CFStringCreateWithCString(0, password.c_str(), kCFStringEncodingUTF8);
        const void *keys[] = { kSecImportExportPassphrase, kSecReturnRef };
        const void *values[] = { passwordRef, kCFBooleanTrue };
        CFDictionaryRef optionsDictionary = CFDictionaryCreate(0, keys, values, 2, 0, 0);
        CFDataRef inPKCS12Data = CFDataCreate(0, (const UInt8*)data.data(), data.size());
        CFArrayRef items = 0;
        OSStatus status = SecPKCS12Import(inPKCS12Data, optionsDictionary, &items);
        CFRelease(passwordRef);
        CFRelease(optionsDictionary);
        CFRelease(inPKCS12Data);

        throwIfError(errSecSuccess != status);

        CFDictionaryRef myIdentityAndTrust = (CFDictionaryRef)CFArrayGetValueAtIndex(items, 0);
        SecIdentityRef identity = (SecIdentityRef)CFDictionaryGetValue(myIdentityAndTrust, kSecImportItemIdentity);
        KeyInfo info(alias, OSStoreImplementation::getCertificate(identity));
        IKey::Ptr result = new OSKey(info, new OSKeyImplementation(identity, false));
        CFRelease(items);
        return result; 
    ```

2.  使用上一步中的身份引用调用 CMSEncodeContent 并成功签署消息。

    ```
     CFDataRef content = 0;
        CMSSignedAttributes signedAttributes = kCMSAttrSmimeCapabilities | kCMSAttrSmimeMSEncryptionKeyPrefs;
        throwIfError(errSecSuccess == CMSEncodeContent(_identity, 0, 0, FALSE, signedAttributes, message.data(), message.size(), &content));
        char* buf = (char*)CFDataGetBytePtr(content);
        const ByteArray result(buf, buf + CFDataGetLength(content));
        CFRelease(content);
        return result; 
    ```

在所有程序结束之后。

在第二种模式下，程序会创建另一个调用列表：

1.  从程序的第一次启动开始，使用与私钥对应的 DER 格式的证书调用 SecCertificateCreateWithData 并成功创建证书引用。
2.  使用上一步中获得的证书 ref 调用 SecIdentityCreateWithCertificate 并成功创建身份 ref。

    ```
     CFDataRef content = CFCreateData(0, info.certificate.getData().data(), info.certificate.getData().size());
        SecCertificateRef cert = SecCertificateCreateWithData(0, content);
        CFRelease(content);
        SecIdentityRef identity = 0;
        OSStatus status = SecIdentityCreateWithCertificate(0, cert, &identity);
        CFRelease(cert);

        throwIfError(errSecSuccess != status);

        KeyPtr result = new OSKey(info, new OSKeyImplementation(identity, true));
        CFReleases(identity);
        return result; 
    ```

3.  使用上一步中的标识 ref 调用 CMSEncodeContent 并且无法使用 errSecNoSuchKeychain (-25294) 签署消息。源代码与程序的第一种模式完全相同。

如何修复此错误以及为什么每次以第二种模式启动程序时都会发生此错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T08:32:58.577

我以第二种模式重写我的代码。我在 SecItemCopyMatching 上更改了 SecIdentityCreateWithCertificate。

```
 CFDataRef content = CFCreateData(0, info.certificate.getData().data(), info.certificate.getData().size());
        SecCertificateRef cert = SecCertificateCreateWithData(0, content);
        CFRelease(content);
        const void* data[] = { cert };
        CFArrayRef secItemOrArray = CFArrayCreate(0, data, 1, 0);
        const void *keys[] = { kSecClass, kSecReturnRef, kSecMatchItemList };
        const void *values[] = { kSecClassIdentity, kCFBooleanTrue, secItemOrArray };
        CFDictionaryRef attributes = CFDictionaryCreate(0, keys, values, 3, 0, 0);
        SecIdentityRef identity = 0;
        OSStatus status = SecItemCopyMatching(attributes, (CFTypeRef*)&identity));
        CFRelease(attributes);
        throwIfError(errSecSuccess != status);
        KeyPtr result = new OSKey(info, new OSKeyImplementation(identity, true));
        CFReleases(identity);
        return result; 
```

新版本正常工作。所以我找到了满足我需要的解决方案，但我仍然不明白为什么我以前的代码不起作用。

# c# - 以前是否发现过 C# 中 async / await 的这种用法？

> ID：13012867
> 
> 赞同：5
> 
> 时间：2012-10-22T13:50:04.983
> 
> 标签：c#, asynchronous, visual-studio-2012, monads, async-await

在 stackoverflow 上关于 async / await 的上一个问题之后，在我看来，await 比市场营销建议的更强大和更通用。它似乎是一种构建计算表达式的通用方法，就像在 F# 中一样。因此，经过一番挣扎，我想出了一些成功执行的代码，如下所示。

```
 using FluentAssertions;
    using System.Collections.Generic;

    namespace EnumerableViaAwait.Specs
    {
        [global::Microsoft.VisualStudio.TestTools.UnitTesting.TestClass]
        public class MyTestClass
        {
            public IEnumerable<int> Numbers()
            {
                return EnumeratorMonad.Build<int>(async Yield =>
                {
                    await Yield(11);
                    await Yield(22);
                    await Yield(33);
                });
            }

            [Microsoft.VisualStudio.TestTools.UnitTesting.TestMethod]
            public void TestEnum()
            {
                var v = Numbers();
                var e = v.GetEnumerator();

                int[] expected = { 11, 22, 33 };

                Numbers().Should().ContainInOrder(expected);

            }

        }
    } 
```

现在仔细注意这里发生了什么。我**不是**在构建一个反应性的 observable。我正在构建一个 IEnumerable。它严格来说是一个拉动系统。我可以很高兴地写了。

```
 foreach item in Numbers(){
            Console.WriteLine(item);
    } 
```

它会打印出来

```
 11
    22
    33 
```

这很有趣，因为系统不是严格异步的，但我滥用了 await 框架和“等待任何东西”的能力，如此处所述。[http://blogs.msdn.com/b/pfxteam/archive/2011/01/13/10115642.aspx 。](http://blogs.msdn.com/b/pfxteam/archive/2011/01/13/10115642.aspx.The) *问题*是。

1.  这种对 await / async 的滥用能走多远？
2.  这种模式是否与 F# 计算表达式一样强大
3.  传统的 IEnumerator / Yield 模式是否只是精确评估此模式的语法糖

实现该模式的代码如下

```
 using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Runtime.CompilerServices;
    using System.Text;
    using System.Threading.Tasks;

    namespace EnumerableViaAwait
    {

        public class EnumeratorMonad<T> : IEnumerable<T>, IEnumerator<T>
        {
            public class Yield
            {
                private EnumeratorMonad<T> _Monad;

                public Yield(EnumeratorMonad<T> monad)
                {
                    _Monad = monad;
                }

                public YieldAwaiter GetAwaiter()
                {
                    return new YieldAwaiter(_Monad);
                }
            }

            public class YieldAwaiter : INotifyCompletion
            {
                EnumeratorMonad<T> _Monad;

                public YieldAwaiter(EnumeratorMonad<T> monad)
                {
                    _Monad = monad;
                }

                public bool IsCompleted
                {
                    get { return _Monad.IsCompleted(); }
                }

                public void GetResult()
                { }

                public void OnCompleted(Action continuation)
                {
                    _Monad.Next = continuation; 
                }

            }

            private bool Completed { get; set; }

            public EnumeratorMonad()
            {
                Completed = false;
            }

            public bool IsCompleted()
            {
                return Completed;
            }

            public void Build(Func<Func<T, Yield>, Task> action)
            {
                Func<T, Yield> yielder = (T value) => { 
                    _Current = value;
                    return new Yield(this);
                };
                Next = async () => { 
                    await action(yielder);
                    Completed = true;
                };
            }

            private T _Current;
            public T Current
            {
                get { return _Current; }
            }

            public void Dispose()
            {
            }

            object System.Collections.IEnumerator.Current
            {
                get { return _Current; }
            }

            Action Next;
            public bool MoveNext()
            {
                if (!Completed )
                {
                    Next();
                }
                return !Completed;
            }

            public void Reset()
            {
                throw new NotImplementedException();
            }

            IEnumerator<T> IEnumerable<T>.GetEnumerator()
            {
                return this;
            }

            System.Collections.IEnumerator System.Collections.IEnumerable.GetEnumerator()
            {
                return this;
            }
        }

        public class EnumeratorMonad{
            public static EnumeratorMonad<T> Build<T>(Func<Func<T, EnumeratorMonad<T>.Yield>, Task> action)
            {
                var monad = new EnumeratorMonad<T>();
                monad.Build(action);
                return monad;
            }
        } 
```

}

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-22T13:56:48.710

`yield return`和`await`/`async`只是协程的不同特殊形式。你已经证明你可以（基本上）`yield return`使用`await`/来实现`async`，我不会惊讶地发现它可能反过来。我确信它们以非常相似的方式实现。

当然，在实践中，我不会使用`await`/`async`进行迭代，因为`yield return`它更简单、更清晰。

所以，

1.  您可以随心所欲地接受这种“滥用”。
2.  对 F# 不够熟悉，无法回答。
3.  不，但是 IIRC 的功能以或多或少相同的方式实现。

# .net - 无法打开 ADODB 连接

> ID：13012868
> 
> 赞同：0
> 
> 时间：2012-10-22T13:50:06.827
> 
> 标签：.net, vb.net, adodb

我正在尝试使用以下功能打开连接：

```
Public cn1 As New ADODB.Connection
    'Sub to open connection to database 
    Public Function OpenConnection(ByVal strOpenConnectionString As String, _
                                   Optional ByVal lngOpenConnectionTimeout As Long = 3600) As Long
        With cn1
            .CursorLocation = ADODB.CursorLocationEnum.adUseClient
            .Mode = ADODB.ConnectModeEnum.adModeUnknown
            .ConnectionTimeout = lngOpenConnectionTimeout
            .CommandTimeout = lngOpenConnectionTimeout
            .ConnectionString = strOpenConnectionString
        End With
        Try
            cn1.Open()
        Catch ex As Exception
            MsgBox(ex.ToString())
        End Try

        OpenConnection = cn1.State
    End Function 
```

我正在为我的连接使用 Windows 身份验证，我的连接字符串是：

```
"Integrated Security=SSPI;Initial Catalog=Test;Data Source=PEDRAM-PC\PEDRAM" 
```

当我使用 sql 连接时，我可以轻松连接，但我需要使用 ado db 对象进行连接，因为它是我的公司代码。我得到以下异常： ![在此处输入图像描述](../Images/28a951841c41929617edf372801948e3.png)

谁能告诉我我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-22T14:23:19.597

您将需要为 ADODB 使用不同的连接字符串。尝试这个

```
Provider=SQLOLEDB;Initial Catalog=Test;Data Source=PEDRAM-PC\PEDRAM;Trusted_connection=yes; 
```

# jquery - 代码在线工作正常，但在本地文件上失败

> ID：13012869
> 
> 赞同：0
> 
> 时间：2012-10-22T13:50:15.990
> 
> 标签：jquery

请看这段代码：[CODE](http://jsfiddle.net/Orina/bQZTq/)

此代码在 jsfiddle.net 中工作，但不适用于本地的本地 js 代码，此代码显示和隐藏更多更少的文本

```
<script type="text/javascript" src="jquery-1.8.2.min.js"></script>
<script type="text/javascript">
$(document).ready(function () {
      var maxheight=118;
      var showText = "More";
      var hideText = "Less";

      $('.textContainer_Truncate').each(function () {
        var text = $(this);
        if (text.height() > maxheight){
            text.css({ 'overflow': 'hidden','height': maxheight + 'px' });

            var link = $('<a href="#">' + showText + '</a>');
            var linkDiv = $('<div></div>');
            linkDiv.append(link);
            $(this).after(linkDiv);

            link.click(function (event) {
              event.preventDefault();
              if (text.height() > maxheight) {
                  $(this).html(showText);
                  text.css('height', maxheight + 'px');
              } else {
                  $(this).html(hideText);
                  text.css('height', 'auto');
              }
            });
        }       
      });
   });​
</script> 
```

.htm 代码：

```
<div class="textContainer_Truncate">
      <p>content<br>
        hello<br>
        hello<br>
        hello<br>
          hello<br>
          hello<br>
          hello<br>
          hello<br>
          hello<br>
          hello<br>
          hello<br>
          hello<br>
          hello<br>
          hello<br>
          hello<br>
          hello<br>
          hello<br>
        </p>
    </div> 
```

文件夹内容：index.htm 和 jquery-1.8.2.min.js 如何在本地使用此代码？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-22T14:00:39.110

我试图复制你所做的，发现它工作正常，没有错误。

考虑下载这个解决方案（一个文件夹包含一个 index.html 页面以及 jquery 1.8.2.js 文件）。也许你做了一些额外的 [测试项目](http://www.mediafire.com/?8un6v06qzvr09rn)

更新：我在复制你的代码时注意到了一些东西，你的代码中有一个额外的问号，看下图

![在此处输入图像描述](../Images/b51e4f332c6cbbfc1e049b74528b3eb4.png)

# java - 在Java中将ASCII码转换为char

> ID：13012871
> 
> 赞同：15
> 
> 时间：2012-10-22T13:50:23.797
> 
> 标签：java

下面是我的代码，它打印出 J=74、A =65 和 M=77。作为向下移动字母表的结果，我如何让它只打印字符 K、B、N？

```
BufferedReader buff = new BufferedReader(new InputStreamReader(System.in));
String string = JOptionPane.showInputDialog( " Please Enter Code " );

for (int i = 0; i < string.length (); ++i) {
    char c = string.charAt(i);
    int j = (int)c;
}

System.out.println("ASCII OF "+c +" = " + j + "."); 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-10-22T13:54:50.360

简单地投射`int`到`char`

```
System.out.println((char) 65);        // A
System.out.println((char) ('A' + 1)); // B
System.out.println((int) 'A');        // 65 
```

*请注意，这是对幼稚*问题（或至少是口语不好）的原始尝试。代码段的最后一行已经包含了您需要的所有内容。也许你只是错过了`char`在 Java 中实际上是一个整数类型，所以你可以使用`char`带操作符的字面量，`+`比如`%`

```
System.out.println((char) ('Z' + 5));
System.out.println((char) ('Z' / 2));
System.out.println((char) ('Z' % 31)); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-10-22T14:29:27.207

我想你已经给出了问题本身的答案。您应该将整数转换为 char 如下

```
 int j=77;
    char c=(char)j;
    System.out.println(c); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-22T13:55:58.580

你的意思是？

```
for (int i = 0; i < string.length (); ++i) {
    char c = string.charAt(i);
    c++; // next character.
    System.out.print(c);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-01-13T10:59:17.593

ASCII 字符开头可以为零，因为必须正确完成从字符串到整数的转换。工作解决方案如下所示。

```
 String s= "01001000";
    int AsciiCode = Integer.valueOf(s, 2);
    char c= (char) AsciiCode;
    System.out.println(c); 
```

# firefox - 带有 ActiveX 的 FireFox

> ID：13012873
> 
> 赞同：0
> 
> 时间：2012-10-22T13:50:26.013
> 
> 标签：firefox, activex, browser-plugin

[我在这里](http://code.google.com/p/ff-activex-host/)看到了一个用于 FireFox 的 ActiveX 插件

我正在尝试在 FireFox 中使用 Bematech 打印机，使用以下`<OBJECT>`标签，它在 Internet Explorer 中运行良好

`<object id="BemaPrinter1" height="14" width="14" classid="clsid:310DBDAC-85FF-4008-82A8-E22A09F9460B" VIEWASTEXT></OBJECT>`

在 FireFox 中不打印也不显示任何消息。

有人能帮我吗 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T06:33:51.320

该插件有一些文档，请随意阅读。实际上，在第一页上它说（在安全性下）：

> 该插件具有一些与安全相关的功能，通过在 Firefox 中提供 ActiveX 控件来限制它可能给用户带来的风险。首先，它使用了一种特殊的 MIME 类型，这样它就不会被不是专门为它设计的网站触发。此外，它还支持众所周知的 CLSID 和 PROGID 列表，因此可以将其限制为与特定控件和接口一起使用。最后，它可以被“站点锁定”以确保它只被预定的域列表使用。

第一个条件意味着您需要标签`TYPE="application/x-itst-activex"`上的属性。`<object>`其他两个安全功能是可选的，尽管我认为它们非常值得推荐——它们必须通过[更改插件的源代码并重新编译](http://code.google.com/p/ff-activex-host/wiki/Documentation#Preparing_the_Plugin_for_Distribution)来启用。因此，只要您使用的是原版构建，添加正确的`type`属性就足够了。

# iphone - 我可以在 iPhone 4 上使用 GCD

> ID：13012876
> 
> 赞同：1
> 
> 时间：2012-10-22T13:50:30.257
> 
> 标签：iphone, ios, cocoa-touch, grand-central-dispatch, background-process

我有一些代码在 iPhone 4 上测试时运行缓慢。我正在考虑研究 Grand Central Despatch 并为某些任务使用后台线程。但是，我知道 iPhone 4 是单核设备。这是否意味着在此设备上使用后台线程没有任何好处？

我在 Apple 的文档中找不到太多关于这方面不同设备功能的信息，而且我对后台处理很陌生。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-22T13:55:42.747

是的，只要它运行 iOS 4 或更高版本。GCD 是一个很好的设计，因为它可以在单核机器上同样出色地使用，一直到 16 核 Mac Pro。事实上，Apple 在推出 GCD 时就强调了这一点。如果你的代码写得很好，它应该在单核 iPhone 和多核 iOS 设备上同样有效。从理论上讲，您应该看到多核设备的性能优于单核设备。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-22T14:11:37.243

这一切都取决于您的代码实际上在做什么。如果您的代码的目标是只计算一件事而不停止，那么在一个核心 cpu 上使用多线程在性能方面没有任何好处。但是，如果您的某些任务正在等待网络数据、等待磁盘操作、睡眠等，那么您的其他线程可能正在使用该时间来做一些有用的事情，即使在一个核心 cpu 上也是如此。通常，如果您正在与 UI 交互，那么建议您在后台执行耗时的任务，这样您就不会阻塞用户界面，从而为最终用户提供更好的体验。

# jruby - Jruby-将RubyString转换为Java Char

> ID：13012877
> 
> 赞同：2
> 
> 时间：2012-10-22T13:50:47.057
> 
> 标签：jruby

下面是我用来从 RubyString 转换为 Java Char 的代码。你能否建议我在 Jruby 中使用更好的方法（自动处理这些类型错误或 jruby 中的一些代码进行转换）

```
ruby_string="Raj"

java.lang.String.new(col_value)
col_value=str_obj.charAt(0) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-25T22:43:31.530

首先，JRuby 的行为略有不同，具体取决于您是在 1.8 模式还是 1.9 模式下运行它。对于 JRuby 1.7.0 及更高版本，1.9 是默认值；与其他人一样，1.8 是默认值。要更改默认值，请在命令行上传递`--1.8`或传递`--1.9`给。`jruby`

在 1.8 模式下，对字符串的某些操作，例如在单个索引处获取字符，返回数字 ( `Fixnum`s)，而在 1.9 模式下，它们总是返回字符串。`Fixnum`JRuby在 0 到 65535之间的 Ruby 和 Java 之间自动转换`char`，因此您可以将 1.8 模式的“字符”值直接传递给接受字符的 Java 方法；例如

```
str = 'foo'
java_obj.methodThatTakesAChar(str[0]) 
```

在 1.9 模式下，由于`str[0]`是单字符的字符串，所以必须将其字符转换为数字。您可以使用`ord`实例方法执行此操作：

```
str = 'foo'
java_obj.methodThatTakesAChar(str[0].ord) 
```

我希望这会有所帮助。

# php - TIFF 文件和图像转换 (PHP/HTML)

> ID：13012880
> 
> 赞同：0
> 
> 时间：2012-10-22T13:50:49.337
> 
> 标签：php, image, image-processing

我对图像类型知之甚少，尤其是涉及到名为 .tif 的扩展名时。

我当前的客户通过 SOAP/CURL 连接到法院数据库，以 .tif 文件的形式从法院获取案件结果。现在，他正在使用第三方应用程序将每个 .tif 文件手动转换为 .jpeg 并将它们上传到他的服务器。但是，他遇到了存储问题，因为文档有时可能超过 100 页，因此有 100 个不同的 .tif 文件。

他还告诉我，与他的 JPEG 类型相比，数据库发送的 .tif 文件非常小，因此如果他能找到在网站上显示 .tif 文件的方法，他愿意直接上传它们。

基本上，我们有两个任务：

1.  找到一种在网站中显示 .tif 图像文件并避免 .jpeg 转换的方法，或者；
2.  找到一种方法将 .tif 文件转换为尽可能小尺寸的流行图像类型（如 gif、png、jpg）（用户仍然应该能够阅读所写的文本。）以便我们可以使用 html img 标签显示它们。

任何建议将不胜感激。我正在寻找长期解决方案，而不是挽救局面。

附言。除了 .tif 文件，Court db 不发送任何其他内容。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-22T14:03:09.547

如果您最终得到比 TIFF 文件更大的 jpeg 文件，这可能意味着 TIFF 文件是 CCIT Fax4 图像（通常由扫描仪软件生成的双层图像）并且您的 JPEG 文件最终为 RGB（24 位）图像。以网络为目标时，您可以做的最好的事情是将它们转换为 GIF 或调色板 PNG 文件。我不会使用 JPEG 压缩，因为它会在黑白文本图像上生成太多伪影。

# c# - OleDbCommand.ExecuteNonQuery() 不会在 ms access 数据库中保存更改

> ID：13012881
> 
> 赞同：1
> 
> 时间：2012-10-22T13:50:49.767
> 
> 标签：c#, .net

我有`.mdb`数据库，代码如下：

```
using (OleDbConnection connection = new OleDbConnection(myConnectionString))
{
    using (OleDbCommand cmd = connection.CreateCommand())
    {
        cmd.CommandText = "UPDATE myTab SET col2 = @val1 WHERE col1 = @val2";
        cmd.Parameters.AddWithValue("@val1", 0);
        cmd.Parameters.AddWithValue("@val2", -1);
        cmd.Connection.Open();
        cmd.ExecuteNonQuery();
        cmd.Connection.Close();
     }
} 
```

我从 db 获取数据，在我的 gui 程序中更改它，然后将其保存在 db 中。更改保存，但不在 db 中（我不知道在哪里），所以当我运行程序时，更改数据，关闭程序，然后再次运行 - 更改仍然存在，但是当我打开 db（不在程序中）时，没有任何更改保存，然后再次运行 - 所有更改都消失了。
PS：当我提交更改，然后多次运行程序时，所有更改也消失了，之后（3-4次运行）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-22T15:35:13.860

当我们`.mdb`在VS中添加项目根目录时，改变结构时，VS默认删除`.mdb`调试文件夹中的文件并替换新文件；现在您可以更改此默认值：

1-右键单击`.mdb`文件并选择选项

2-设置`Copy To Output Directory`为`Do Not Copy`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-22T13:55:49.733

您的更新语句的 WHERE 子句很可能没有找到任何要更新的记录。

[http://weblogs.asp.net/stevewellens/archive/2009/10/16/why-sql-updates-fail-three-reasons.aspx](http://weblogs.asp.net/stevewellens/archive/2009/10/16/why-sql-updates-fail-three-reasons.aspx)

# android - AsyncTask没有在android中取消

> ID：13012883
> 
> 赞同：1
> 
> 时间：2012-10-22T13:50:50.593
> 
> 标签：android

我的主要活动中有一个异步任务，当我按下按钮时它会运行。现在由于某种原因，如果请求时间过长（由于服务器不可用），我什至无法使用后退按钮关闭活动。有谁知道为什么会这样？从这个[Android AsyncTask blocks back key dispatch Event](https://stackoverflow.com/questions/6023350/android-asynctask-blocks-back-key-dispatch-event)我了解到后退按钮应该自动终止我的活动并完成异步任务。但这似乎并没有发生。我可以退出活动的唯一方法是按下我的安卓手机上的主页按钮，这当然只是简单地保存状态，所以一旦我再次打开活动，异步任务仍然会继续执行。

```
class mytask extends AsyncTask<Void,Void,String>
        {
            HttpResponse response;

            @Override
            protected void onPreExecute()
            {
                // TODO Auto-generated method stub
                super.onPreExecute();
            }

            @Override
            protected String doInBackground(Void... arg0) 
            {
                // TODO Auto-generated method stub
                Log.d("In","IN");

                    HttpClient httpclient = new DefaultHttpClient();
                HttpPost httppost = new HttpPost("someurl");

                try 
                {
                    // Add your data
                    List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>();

                    nameValuePairs.add(new BasicNameValuePair("name", "somename"));
                    httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
                response = httpclient.execute(httppost);
               p=inputStreamToString(response.getEntity().getContent()).toString();        
                     return p;

                } 
                catch (ClientProtocolException e) 
                {
                    // TODO Auto-generated catch block
                } 
                catch (IOException e)
                {
                    // TODO Auto-generated catch block
                }

                return null;
            }
            protected void onPostExecute(String result) 
            {
                // TODO Auto-generated method stub
                super.onPostExecute(result);

            }

        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T13:54:22.947

请执行下列操作：

您的 asynctask 类对象，例如：

```
 mytask.cancel(true) 
```

单击后退按钮

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-22T13:56:04.307

您已覆盖异步任务的 onCancelled() 方法并在后按时调用 yourAsync.cancel(true) 。如果你在 doInBackground() 中使用了一些 for 循环，那么你应该检查 isCancelled() 的另一件事。

# shell - 脚本外壳中的变量扩展

> ID：13012885
> 
> 赞同：-1
> 
> 时间：2012-10-22T13:50:53.863
> 
> 标签：shell, ssh

我的代码是：

```
nb_lignes=`wc -l $1 | cut -d " " -f1`
for i in $(seq $(($nb_lignes - 1)) )
do
machine=`head $1 -n $i | tail -1`
machine1=`head $1 -n $nb_lignes | tail -1`
ssh root@$machine -x " scp /home/file.txt root@$machine1:/home && rm -r /home/file.txt"
done 
```

$machine1 是作为变量还是字符串？如果是字符串，我该如何更改它——通过添加引号？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-22T13:55:30.100

`$machine`将扩大到`head $1 -n $i | tail -1`结果，`$machine1`将扩大到`head $1 -n $nb_lignes | tail -1`结果。

你可以自己想办法。

顺便说一句，`ssh root@`……</p>

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-22T14:06:18.177

`$machine1`将被扩展以给出变量的值`machine1`，因为您使用的是双引号`"`。如果您使用了单引号`'`，那么它就不会被扩展。

一种可能的混淆是当您在其他文本中嵌入变量时。在这种情况下，你很好，因为尾随字符是`:`( `root@$machine1:/home`)，它不是 Bash 变量名称中的有效字符。有些 shell (csh) 不喜欢这样，如果您不确定，那么您可以使用 分隔变量名`{ }`，例如：

```
root@${machine1}:/home 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-24T23:49:13.050

## 重写的答案

不管`ssh root`那里有什么滥用......（我更喜欢`curl`为此目的使用，但你必须自己写*`collectFiles.php`*;）

好的，这样做的目的是将主机列表的**最后**一行作为`destination`，从列表的其余部分发送文件到哪里。你可以：

### Posix外壳优先：

[在dash](/questions/tagged/dash "显示标记为“破折号”的问题")和[busybox](/questions/tagged/busybox "show questions tagged 'busybox'")下测试

```
tac $1  | (
    srcFile=/home/file.txt i=1
    read destHost
    while read collectHost ;do
        destFile=`printf "root@%s:/home/fileHost_%-12s_%03d.txt" \
            $destHost $collectHost $i`
        i=$((i+1))
        echo ssh $collectHost -x "curl -H 'Filename: $destFile' \
            --data-binary '@$srcFile http:/$destHost/collectFiles.php && \
                rm $srcFile"
        done
) 
```

（`echo`将被丢弃）

### [现在重击](/questions/tagged/bash "显示标记为“bash”的问题")：

操作变量提供了一种构建命令的好方法，有一个完整的可用示例

```
#!/bin/bash

mapfile flist <$1

dstCmdFmt="curl -H 'Filename: %s' --data-binary '@%s' http://%s/%s && rm %s"
dstRcvPhp=collectfiles.php
srcFile=/home/file.txt

for ((i=0;i<${#flist[@]}-1;i++));do
    printf -v destFile "fileHost_%-12s_%03d.txt" ${flist[i]} $[1+i]
    printf -v cmd "$dstCmdFmt" \
        ${destFile// /_} $srcFile ${flist[@]:${#flist[@]}-1} $dstRcvPhp $srcFile
    echo ssh ${flist[i]} -x "$cmd"
done 
```

尝试使用文件：

```
cat <<eof > testfile
machineA
OtherMachine
AnotherHost
DestinationHost
eof

./script.sh testfile
ssh machineA -x curl -H 'Filename: fileHost_machineA_____001.txt' --data-binary '@/home/file.txt' http://DestinationHost/collectfiles.php && rm /home/file.txt
ssh OtherMachine -x curl -H 'Filename: fileHost_OtherMachine_002.txt' --data-binary '@/home/file.txt' http://DestinationHost/collectfiles.php && rm /home/file.txt
ssh AnotherHost -x curl -H 'Filename: fileHost_AnotherHost__003.txt' --data-binary '@/home/file.txt' http://DestinationHost/collectfiles.php && rm /home/file.txt 
```

### 旧答案

代替...

```
nb_lignes=`wc -l <$1`
machine1=`sed -ne ${nb_lignes}p <$1`
for i in `seq $(($nb_lignes - 1))` ;do
    machine=`sed -ne ${i}p <$1`
    ssh  root@$machine -x " scp /home/file.txt root@$machine1:/home && rm -r /home/file.txt"
  done 
```

但...

如果从每个`machine`，您确实发送不同`file.txt`（但名称相同）到同一目标目录中的相同唯一`machine`文件，您每次都将覆盖先前发送的文件。

# java - 如何知道远程服务器是否与远程控制 Java 代码断开连接

> ID：13012892
> 
> 赞同：0
> 
> 时间：2012-10-22T13:51:25.413
> 
> 标签：java, android, swing, remote-desktop, remote-server

我有这段代码，如果它与服务器窗口断开连接，我需要在标签中显示“断开连接”。我的问题是我不知道如何检测我是否断开连接。即使没有连接或另一端没有触发器，我也想检测连接状态。

```
//  Copyright 2012
//  Android Remote Desktop Server Ver. 1.0

import javax.swing.*;
import java.awt.*;
import java.awt.event.*;
import java.net.*;
import java.util.Random;

public class ServerWindow implements ActionListener{

    private RemoteDataServer server;

    private Thread sThread; //server thread

    private static final int WINDOW_HEIGHT = 200;
    private static final int WINDOW_WIDTH = 350;

    private String ipAddress;

    private JFrame window = new JFrame("Remote Control for Android");

    private JLabel addressLabel = new JLabel("");
    private JLabel portLabel = new JLabel("Android Remote Control Port: ");
    private JTextArea[] buffers = new JTextArea[3];
    private JTextField portTxt = new JTextField(5);
    private JLabel serverMessages = new JLabel("Not Connected");

    private JButton connectButton = new JButton("Start Server");
    private JButton disconnectButton = new JButton("Stop Server");

    public boolean connected = false;

    public ServerWindow(){
        server = new RemoteDataServer();

        window.setSize(WINDOW_WIDTH, WINDOW_HEIGHT);
        window.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        connectButton.addActionListener(this);
        disconnectButton.addActionListener(this);

        Container c = window.getContentPane();
        c.setLayout(new FlowLayout());

        try{
            InetAddress ip = InetAddress.getLocalHost();
            ipAddress = ip.getHostAddress();
            addressLabel.setText("Android Remote Control Server IP Address: "+ipAddress);
        }
        catch(Exception e){addressLabel.setText("IP Address Could Not be Resolved");}

        int x;
        for(x = 0; x < 3; x++){
            buffers[x] = new JTextArea("", 1, 30);
            buffers[x].setEditable(false);
            buffers[x].setBackground(window.getBackground());
        }

        portTxt.setEditable(false);
        Random portRandom = new Random();
        for (int i = 0; i < 10; i++) {

          int port = portRandom.nextInt(4998) + 1;
          int portNum = 5000+port;
          String portString = Integer.toString(portNum);
          portTxt.setText(portString);
          }

        c.add(addressLabel);
        c.add(buffers[0]);
        c.add(portLabel);
        //portTxt.setText("5444");
        c.add(portTxt);
        c.add(buffers[1]);
        c.add(connectButton);
        c.add(disconnectButton);
        c.add(buffers[2]);
        c.add(serverMessages);

        window.setLocationRelativeTo(null);
        window.setVisible(true);
        window.setResizable(false);

    }

    public void actionPerformed(ActionEvent e){
        Object src = e.getSource();

        if(src instanceof JButton){
            if((JButton)src == connectButton){
                int port = Integer.parseInt(portTxt.getText());
                runServer(port);
            }

            else if((JButton)src == disconnectButton){
                closeServer();
            }
        }
    }

    public void runServer(int port){
        if(port <= 9999){
            server.setPort(port);
            sThread = new Thread(server);
            sThread.start();
        }
        else{
            serverMessages.setText("The port Number must be less than 10000");
        }
    }

    public void closeServer(){
        serverMessages.setText("Disconnected");
        server.shutdown();
        connectButton.setEnabled(true);
    }

    public static void main(String[] args){
        new ServerWindow();
    }

    public class RemoteDataServer implements Runnable{
        int PORT;
        private DatagramSocket server;
        private byte[] buf;
        private DatagramPacket dgp;

        private String message;
        private AutoBot bot;

        public RemoteDataServer(int port){
            PORT = port;
            buf = new byte[1000];
            dgp = new DatagramPacket(buf, buf.length);
            bot = new AutoBot();
            serverMessages.setText("Not Connected");
        }

        public RemoteDataServer(){
            buf = new byte[1000];
            dgp = new DatagramPacket(buf, buf.length);
            bot = new AutoBot();
            serverMessages.setText("Not Connected");
        }

        public String getIpAddress(){
            String returnStr;
            try{
                    InetAddress ip = InetAddress.getLocalHost();
                    returnStr = ip.getCanonicalHostName();
            }
            catch(Exception e){ returnStr = new String("Could Not be Resolve Ip Address");}
            return returnStr;
        }

        public void setPort(int port){
            PORT = port;
        }

        public void shutdown(){
            try{server.close();
                serverMessages.setText("Disconnected");}
            catch(Exception e){}
        }
        public void run(){
            //boolean connected = false;
            try {InetAddress ip = InetAddress.getLocalHost(); 
                serverMessages.setText("Waiting for connection on " + ip.getCanonicalHostName());

                server = new DatagramSocket(PORT, ip);

                connected = true;
                connectButton.setEnabled(false);
            }
            catch(BindException e){ serverMessages.setText("Port "+PORT+" is already in use. Use a different Port"); }
            catch(Exception e){serverMessages.setText("Unable to connect");}

            while(connected){
                //Runtime.getRuntime().exit(0);
                // get message from sender
                try{ server.receive(dgp);

                    // translate and use the message to automate the desktop
                    message = new String(dgp.getData(), 0, dgp.getLength());
                    if (message.equals("Connectivity")){
                        //send response to confirm connectivity
                        serverMessages.setText("Trying to Connect");
                        server.send(dgp); //echo the message back
                    }else if(message.equals("Connected")){
                        server.send(dgp); //echo the message back
                    }else if(message.equals("Close")){
                        serverMessages.setText("Controller has Disconnected. Trying to reconnect."); //echo the message back
                    }else{
                        serverMessages.setText("Android Phone Connected to ARD Server");
                        bot.handleMessage(message);
                        server.receive(dgp);

                    }
                }catch(Exception e){
                    serverMessages.setText("Disconnected");
                    connected = false;}
            }

        }

    }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T15:41:11.973

Since you use UDP there is no "real" connection between the 2 peers, you may need to perform some kind of periodic keep-alive requests from the client. If no response is received for that keep alive it means you are disconnected.

# xslt - Mapforce：合并 Perforce 版本控制中的更改

> ID：13012894
> 
> 赞同：2
> 
> 时间：2012-10-22T13:51:34.337
> 
> 标签：xslt, version-control, perforce

在我的项目中，我使用 mapforce 来创建 XSLT 转换。问题是即使在微小的更改（不同的变量名称、不同的对象序列等）之后，mapforce 也会生成不同的输出。如果我在项目分支 1.2 中实现某些功能，而其他开发人员在分支 1.3 中添加了另一个功能，我们都提交分别对分支 1.2 和 1.3 进行更改，无法将更改（我使用 Perforce 进行版本控制）集成到版本 1.3，它必须重新实现。无论如何我可以克服这个吗？也许是 mapforce 中的版本控制插件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-13T20:01:50.103

恐怕这只是代码生成器的限制。大多数只是在它们进行时分配新的标签（或数字），因此根据添加的代码的位置，在那之后生成的*所有内容都将被更改。*

为了解决这个问题，MapForce 代码生成器必须保存生成代码时使用的元数据，并在下次生成代码时重新使用它。生成器必须将新项目与刚刚移动的项目区分开来，并重新使用所有现有项目。根据当前的实施方式，执行此操作*可能需要对他们的软件进行重大更改。*

请求/建议这样的功能并没有什么坏处，拥有它可以帮助 Altova 将 Mapforce 定位为更多的生产就绪解决方案，能够支持客户工作的版本控制。

# gwt - 在 gwt 中滚动基本分页

> ID：13012900
> 
> 赞同：0
> 
> 时间：2012-10-22T13:51:52.083
> 
> 标签：gwt

```
For scroll base paging in gwt,i am using the scroll panel and its scroll event.
On scroll event, i have given the async call to fetch record from database. 
```

问题：-1）如何限制向上滚动的滚动事件？2）如果用户向下滚动，获取数据并显示。可能用户刚刚再次向上滚动，现在他通常向下滚动以查看先前加载的数据？请帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T14:42:54.233

ScrollPanel 有一个名为`getVerticalScrollPosition`. 您可以检查它是否靠近面板底部，然后获取结果。

滚动的方向可能并不那么重要，但是您可以通过跟踪最后滚动位置并将其与新滚动位置进行比较来自己计算滚动速度。

# sql - SQL 选择然后删除

> ID：13012902
> 
> 赞同：4
> 
> 时间：2012-10-22T13:51:53.813
> 
> 标签：sql, sql-server, sql-server-2008

我需要从我的数据库表中清除一些旧数据。下面显示了两个表**app_status**和**app_personal_details**。

![在此处输入图像描述](../Images/7b2ae79e7d90bd9bcbc0400f0ddb44cc.png)

我有以下查询从**app_status**表中选择从今天起 12 个月内创建的所有记录（应用程序）

```
select status_id  
from dbo.app_status  
where submission_date <= dateadd(month, -12, getdate()) order by 1 
```

然后，我想从**app_personal_details**表中删除上面检索到的 status_id 列表中存在 application_id 的所有记录。

我希望这是有道理的。我想知道从两个表中删除数据的快速方法。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-22T13:53:37.660

```
delete from app_personal_details
where application_id in (
    select status_id   
    from dbo.app_status   
    where submission_date <= dateadd(month, -12, getdate())
) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-22T13:53:51.243

您可以使用子选择。

```
DELETE FROM app_personal_details
WHERE application_id IN
(
    SELECT status_id  
    FROM dbo.app_status  
    WHERE submission_date <= DATEADD(month, -12, GETDATE())
) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-22T14:08:59.327

执行此操作并在两个表上进行一致删除的一种方法如下：

```
Select status_id  
Into #to_delete
From dbo.app_status  
Where submission_date <= dateadd(month, -12, getdate())

Create Unique Clustered Index PK_X On #to_delete (status_id)

Delete 
  app_personal_details
From
  app_personal_details apd Inner Join
  #to_delete d On apd.application_id = d.status_id

Delete 
  app_status
From 
  app_status a Inner Join
  #to_delete d On a.status_id = d.status_id 
```

您可以使用输出子句在较少的语句中执行此操作，或者如果您在两个表之间有删除级联。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-23T09:29:03.633

如果表很大，你宁愿分批删除，这样你的事务日志就不会成倍增长，sql server 会处理得更快。

您可以通过 DELETE TOP (N) ... 或删除特定日期范围来限制要删除的行。

# ruby-on-rails - RoR 多态关联堆栈级别太深错误

> ID：13012904
> 
> 赞同：0
> 
> 时间：2012-10-22T13:51:55.240
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我有看起来像的多态关联

```
class Certificate < ActiveRecord::Base
  attr_accessible :certification_id, :certified_id, :certified_type
  belongs_to :certification
  belongs_to :certified, :polymorphic => true
end

class Certification < ActiveRecord::Base
  attr_accessible :name, :slug
  belongs_to :association
end

class Association < ActiveRecord::Base
  has_many :certifications
  attr_readonly :name, :id
  attr_protected :name
end 
```

假设`User`模型

```
class User < ActiveRecord::Base
  has_many :certificates, :as => :certified
end 
```

我正在尝试`association`从多态关联中访问对象

`u = User.first`

`u.certificates`返回的实例数组`Certificate`

`u.certificates.first.certification`返回实例`Certification`

但

`u.certificates.first.certification.association`返回`stack level too deep`错误并在第二次运行时控制台/服务器崩溃`illegal hardware instruction`显示消息

我确实意识到这个表达式很难成为代码美的女王，但它应该有效，不是吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-22T14:20:59.747

首先，我认为 Association 可能是一个不幸的模型名称选择。

ActiveRecord::Base 已经有一个名为 Association 的实例方法，您刚刚通过设置与名为 Association 的模型的关联来覆盖您的认证模型。我还没有机会确切地追踪这将要做什么，但我猜一种称为“关联”的方法可能在反思和操作模型的关联方面非常重要，并且覆盖它会产生令人兴奋的结果。

我还建议考虑到上一段读起来有多尴尬，无论如何，Association 可能不是 Rails 模型的最佳名称！

尝试重命名该模型及其关联，看看它是否能解决您的问题。

# c# - 没有绑定的样式触发器？

> ID：13012913
> 
> 赞同：1
> 
> 时间：2012-10-22T13:52:10.457
> 
> 标签：c#, wpf, xaml

我在不使用 .itemssource 的情况下使用 foreach 语句以编程方式填充我的列表视图`Strings`，然后我创建了这个样式触发器（这似乎是正确的）

```
<ListView.Resources>
            <Style TargetType="ListViewItem">
                <Setter Property="IsSelected" Value="True" />
                <Style.Triggers>
                    <Trigger Property="IsSelected" Value="True">
                        <Setter Property="Background" Value="Green"/>
                    </Trigger>
                </Style.Triggers>
            </Style>
</ListView.Resources> 
```

然后我运行该项目并单击一个列表视图项......背景是蓝色......

我只是想知道样式触发器是否需要使用数据绑定……或者我的触发器是否错误……或者是否有人有任何想法……？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T14:30:13.063

触发器工作正常，但问题是 ListViewItem 的控件模板实际上并没有使用 Background 属性的值作为控件的背景颜色。

相反，它使用 SystemColors.HighlightBrush 属性的值，默认情况下为蓝色（因此它看起来总是像 Windows 中的选择一样）。

该属性有一个与之关联的资源键，因此您可以使用相同的键定义一个新的 Brush，然后 ListView 将使用该键。现在也可以摆脱 Trigger 了。

```
<ListView.Resources>
    <SolidColorBrush x:Key="{x:Static SystemColors.HighlightBrushKey}" Color="Green" />
</ListView.Resources> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-22T14:30:54.000

你的问题和绑定无关，Trigger也是可以的，只是会失效。

所选 ListViewItem 的背景颜色由 ListViewItem 的 ControlTemplate 中的 VisualStateManager 设置，如[MSDN 示例](http://msdn.microsoft.com/en-us/library/ms788747.aspx)中所示：

```
<Style TargetType="ListViewItem">
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="ListBoxItem">
                <Border x:Name="Border" Background="Transparent" ...>
                    <VisualStateManager.VisualStateGroups>
                        ...
                        <VisualStateGroup x:Name="SelectionStates">
                            <VisualState x:Name="Unselected" />
                            <VisualState x:Name="Selected">
                                <Storyboard>
                                    <ColorAnimationUsingKeyFrames
                                        Storyboard.TargetName="Border"
                                        Storyboard.TargetProperty="(Panel.Background).(SolidColorBrush.Color)">
                                        <EasingColorKeyFrame KeyTime="0"
                                            Value="{StaticResource SelectedBackgroundColor}" />
                                    </ColorAnimationUsingKeyFrames>
                                </Storyboard>
                            </VisualState>
                            ...
                        </VisualStateGroup>
                    </VisualStateManager.VisualStateGroups>
                </Border>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

不管你设置item的背景是什么值，它都会被设置为`{StaticResource SelectedBackgroundColor}`item状态为 时的值`Selected`。但是，您可以将以下行添加到 ListViewItem 样式中以覆盖 SelectedBackgroundColor 资源的值：

```
<Style TargetType="ListViewItem">
    <Style.Resources>
        <SolidColorBrush x:Key="{x:Static SystemColors.HighlightBrushKey}" Color="Green" />
    </Style.Resources>
    ...
</Style> 
```

# performance - 我怎样才能让这段代码更省时？

> ID：13012914
> 
> 赞同：0
> 
> 时间：2012-10-22T13:52:14.617
> 
> 标签：performance, matlab, time, for-loop

这是 Profiler 报告的一部分，显示了这些行是如何消耗时间的。可以改进吗？

```
 434 %clean up empty cells in subPoly
         228  435 if ~isempty(subPoly) 
         169  436     subPoly(cellfun(@isempty,subPoly)) = []; 
              437 
              438     %remove determined subpoly points from the hull polygon
         169  439     removeIndex = zeros(size(extendedPoly,1),1); 
         169  440     for i=1:length(subPoly) 
         376  441         for j=1:size(subPoly{i}(:,1)) 
       20515  442             for k=1:size(extendedPoly,1) 
6.12 5644644  443                 if extendedPoly(k,:)==subPoly{i}(j,:) 
       30647  444                     removeIndex(k,1)=1; 
       30647  445                 end 
1.08 5644644  446             end 
0.02   20515  447         end 
         376  448     end 
         169  449     extendedPoly = extendedPoly(~removeIndex(:,1),:);  
         169  450 end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-22T15:30:26.080

由于Matlab倾向于认为命令行上的所有内容都是双精度数组，并且假设您的数组和单元格数组的内容是数字，您可以替换

```
 if extendedPoly(k,:)==subPoly{i}(j,:) 
             removeIndex(k,1)=1; 
         end 
```

与等价的

```
removeIndex(k,1) = extendedPoly(k,:)==subPoly{i}(j,:) 
```

这可能会节省几纳秒，但如果节省更多，我会有点惊讶。

我怀疑如果我更聪明或更勤奋，我可能会用一个单一的赋值来替换你的整个循环嵌套

```
removeIndex = extendedPoly==subPoly 
```

这里的技巧是确保表达式中的所有数组都具有相同的维度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-22T18:03:46.877

您可能正在接近当前嵌套策略的性能限制。“慢”行每次执行只需要 1 微秒。

通常在这样的集合匹配情况下，最好对两个集合进行排序，然后同时对两个集合执行一个循环。（谷歌“插入排序”了解更多信息，另请参阅此相关问题/答案[优化 MATLAB 中的时间戳过滤器 - 使用非常大的数据集](https://stackoverflow.com/q/12381377/931379)）

如何最好地将其应用于您的情况并不是很明显。如果您发布一个可执行示例，我们可以更仔细地研究一下。

在不查看可执行代码的情况下，将向量的 subPoly 单元格扩展为单个排序的数字数组（称为类似的东西）可能是有意义的`sortedElementsToremove`。然后像这样获取排序顺序`extendedPoly`：`[~, ixsSortExpended] = sort(extendedPoly);`.

现在您可以使用带有两个索引的单个循环来执行屏蔽。像这样的东西（代码未经测试）：

```
ixExtended = 1;  %Index though sort order
for ixSub = 1:length(sortedElementsToremove);
    %Use while to update second index
    while ...
            (extendedPoly(ixsSortExpended(ixExtended))  < sortedElementsToremove(ixSub) ) && ...
            ixExtended < length(ixsSortExpended)
        ixExtended = ixExtended + 1;
    end
    if (sortedElementsToremove(ixSub) == extendedPoly(ixsSortExpended(ixExtended)))
        removeIndex(ixsSortExpended(ixExtended)) = true;
    end
end 
```

# joomla - joomla如何修改用户密码？

> ID：13012915
> 
> 赞同：2
> 
> 时间：2012-10-22T13:52:19.000
> 
> 标签：joomla, joomla2.5

我正在为 joomla 编写自定义注册/授权模块，我想知道如何使用默认的 joomla 方法更改用户密码？目前我有：

```
private function UpdateUser(){
    $user = JFactory::getUser($this->user_data['username']);
    $user->set('password', $this->user_data['password']);
    $user->set('password2', $this->user_data['password']);
    // $user->bind();
    $user->save();
} 
```

但密码没有更新。

PS `$this->user_data`包括关于用户的其他工作人员，但我只需要更新密码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-22T15:55:41.930

解决了。

```
private function UpdateUser($username, $password){

    $user = JFactory::getUser($this->GetIdByUserName($username));
    $password = array('password' => $password, 'password2' => $password);
    if(!$user->bind($password)){
        die('Could not bind data. Error: '.$user->getError());
    }
    if(!$user->save()){
        die('Could not save user. Error: '.$user->getError());
    }
}

private function GetIdByUserName($username){
    $query = $this->db->getQuery(true);

    $query->select('id');
    $query->from('#__users');
    $query->where('username=' . $this->db->Quote($username));

    $this->db->setQuery($query);
    if(isset($this->db->loadObject()->id) && !empty($this->db->loadObject()->id))
        return $this->db->loadObject()->id;
    else
        die('No id');
} 
```

# matlab - 关于在 MATLAB 中使用 quad

> ID：13012918
> 
> 赞同：5
> 
> 时间：2012-10-22T13:52:28.603
> 
> 标签：matlab, integration, integrate

我遇到了一个奇怪的`quad`功能问题。我`quad`用来计算简单积分，它工作了10到20次，然后Matlab发出以下错误：

```
Error using quad (line 75)
The integrand function must return an output vector of the same length as the input vector. 
yteor(k) = quad(@(q)(exp(-(q).^2).*q.^2/(k.^2+1)), 0, 1); 
```

这里 q 和 k 是标量。我不知道出了什么问题以及为什么它在几个小时前起作用。

**编辑**

这是我的代码

```
for k=1:100,
    xteor(k)=step*k;
    yteor(k)=quad(@(q)(exp(-(q).^2).*q.^2/((step.*k+1).^2)),0,1);
end plot(xteor,yteor,'r'); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T15:22:34.133

以下片段适用于 Octave（Matlab GNU 克隆）

```
step = 1;
xteor = zeros(100,1);
yteor = zeros(100,1);

for k=1:100,
  xteor(k)=step*k;
  yteor(k)=quad(@(q)(exp(-(q).^2).*q.^2/((step.*k+1).^2)),0,1);
end
plot(xteor,yteor,'r');
pause 
```

我的假设是您的错误是代码中较早发生的其他事情的结果（可能与`step`不是标量有关？）。而不是关注出现错误的这条线。尝试在错误出现之前搜索您所做的更改。

# hadoop - HDFS 中的大块大小！未使用的空间如何计算？

> ID：13012924
> 
> 赞同：25
> 
> 时间：2012-10-22T13:52:47.290
> 
> 标签：hadoop, mapreduce, hdfs

众所周知，HDFS 中的块大小与传统文件系统中的块大小相比非常大（64M 或 128M）。这样做是为了减少寻道时间与传输时间相比的百分比（传输速率的改进比磁盘寻道时间的改进要大得多，因此，设计文件系统的目标始终是减少与要传输的数据量相比的查找次数）。但这带来了内部碎片的另一个缺点（这就是为什么传统的文件系统块大小不那么大，并且只有几个 KB 的数量级 - 通常是 4K 或 8K）。

我正在阅读这本书 - Hadoop，权威指南，发现这写在某处，一个小于 HDFS 块大小的文件不占用整个块，也不占整个块的空间，但不明白怎么做？有人可以对此有所了解。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-01-01T08:58:33.843

HDFS 中的块划分只是在逻辑上建立在底层文件系统（例如 ext3/fat）的物理块之上。文件系统在物理上没有分成块（比如 64MB 或 128MB 或任何可能的块大小）。这只是将元数据存储在 NameNode 中的一种抽象。由于 NameNode 必须将整个元数据加载到内存中，因此元数据条目的数量是有限的，因此需要大块大小。

因此，存储在 HDFS 上的三个 8MB 文件在逻辑上占用 3 个块（NameNode 中的 3 个元数据条目），但在底层文件系统中物理占用 8*3=24MB 空间。

大块大小是为了在考虑到NameNode内存限制的同时，兼顾存储空间的合理使用。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-10-22T15:16:36.693

根据 Hadoop - 权威指南

> 与单个磁盘的文件系统不同，HDFS 中小于单个块的文件不会占用整个块的底层存储空间。当不合格时，本书中的术语“块”指的是 HDFS 中的块。

HDFS 中的每个块都作为文件存储在底层 OS 文件系统（ext3、ext4 等）上的数据节点中，相应的详细信息存储在名称节点中。假设文件大小为 200MB，块大小为 64MB。在这种情况下，文件将有 4 个块，对应于 64MB、64MB、64MB 和 8MB 大小的数据节点中的 4 个文件（假设复制为 1）。

`ls -ltr`数据节点上的一个将显示块详细信息

> -rw-rw-r-- 1 次培训培训 10 月 21 日 15:27 blk_-7636754311343966967_1002.meta
> -rw-rw-r-- 1 次培训培训 10 月 21 日 15:27 blk_-7636754311343966967
> -rw-rw-r-- 1 个培训培训 99 Oct 21 15:29 blk_-2464541116551769838_1003.meta
> -rw-rw-r-- 1 个培训培训 11403 Oct 21 15:29 blk_-2464541116551769838
> -rw-rw-r-- 1 个培训培训 99 Oct 21 15: 29 blk_-2951058074740783562_1004.meta
> -rw-rw-r-- 1次培训培训11544 Oct 21 15:29 blk_-2951058074740783562

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-11-05T12:47:47.430

在普通文件系统中，如果我们创建一个空白文件，那么它也保持 4k 大小，因为它存储在块上。在 HDFS 中不会发生，对于 1GB 文件，仅使用 1GB 内存，而不是 4GB。要更清楚。

在操作系统中：文件大小 1KB，块大小：4KB，使用的内存：4KB，浪费：3 KB。在 HDFS 中：文件大小 1GB，块大小：4GB，使用的内存：1GB，浪费：0GB，剩余的 3 GB 可供其他块免费使用。

*不要认真对待数字，它们是为了说明问题而编造出来的数字。

如果您有 2 个不同的 1GB 文件，那么每个文件将有 2 个 1 GB 的块。在文件系统中，如果您存储 2 个每个 1 KB 的文件，那么您将拥有 2 个 4 KB + 4 KB = 8 KB 的不同文件，其中 6 KB 浪费。

所以这使得 HDFS 比文件系统好得多。但具有讽刺意味的是，HDFS 使用本地文件系统，最终会遇到同样的问题。

# android - 如何退出布局并保持方法运行？

> ID：13012925
> 
> 赞同：0
> 
> 时间：2012-10-22T13:52:52.337
> 
> 标签：android, android-layout, methods, android-activity, exit

我有 Act1 和 Act2。在 Act1 上有一个按钮，用于打开设置新布局的 Act2。如何退出布局但保持方法运行？我的问题不是如何编程并行性，我的问题是如何避免在按下后退按钮时关闭整个活动（我已经使用 onPressedButton() 来识别它何时被按下）但我不知道如何获得摆脱布局，只保持 Act2 的方法运行。Finish() 将杀死一切。谢谢你。

编辑：我没有示例代码，因为我现在拥有的是两个独立的活动，我还没有设法链接。

我有一个程序可以在主屏幕上滚动图像，您可以用手指单击它们，正常方式。我正在尝试使用读取脑电波并且能够识别何时执行眨眼的耳机来实现与程序交互的新方式。所以我正在尝试调整该程序，以便残疾人只能通过眨眼来使用它。因此，我需要运行常规程序和一个不断从耳机读取消息的并行进程。要求眨眼和触摸功能同时工作，即无论您打开或关闭耳机，触摸功能都保持可用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-22T13:56:10.727

您可以实现您的方法以作为服务运行，它将独立于活动。

# arrays - 我找不到一种方法来实际定义一个数组，推送一些值并将它们作为 VBA 中的字符串输出？（新数组，推送，加入）

> ID：13012927
> 
> 赞同：2
> 
> 时间：2012-10-22T13:52:58.647
> 
> 标签：arrays, vba, join

我发现了如何创建一个数组，但我不能轻易推送项目。我必须保持索引到下一个位置，并且每次推送一个项目时递增；

我还发现该集合具有很好的 .Add 方法，其行为与推送方法完全相同。但我如何加入他们？全局 Join 方法不适用于 Collections。

我在这里缺少什么？任何人都可以帮助我定义一个数组，在没有索引的情况下轻松推送项目，然后将它们输出到以“，”分隔的字符串？

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-22T14:32:31.237

你不能直接这样做。VBA 中的数组通常需要在使用前进行索引和标注。

您可以在分配变量之前使用动态数组并调整大小：

```
Dim arr() As String
ReDim arr(0)

arr(UBound(arr)) = "Some String"
ReDim Preserve arr(UBound(arr) + 1)
arr(UBound(arr)) = "Some Other String"
ReDim Preserve arr(UBound(arr) + 1)
arr(UBound(arr)) = "Some 3rd String"

MsgBox Join(arr, ",") 
```

保留关键字维护数组中的值，而不是覆盖它们。但是，通常不建议使用上述方法，因为 Preserve 成本高，并且只允许您调整数组的最后一个维度的大小。

集合是不同的，在 VBA 环境中速度较慢且通常不太灵活（您没有说哪个环境，但我假设 Excel）

```
Dim coll As Collection
Dim itm As Variant
Dim tempS As String

Set coll = New Collection
coll.Add "Some String"
coll.Add "Some Other String"
coll.Add "Some 3rd String"

For Each itm In coll
    tempS = tempS & itm & ","
Next itm

MsgBox Left(tempS, Len(tempS) - 1) 
```

您需要遍历它们来构建一个数组。

根据您的需要，还有许多其他选择

**内置方法**

对于字符串，请查看拆分：

```
Const stri As String = "Some String, Some Other String, Some 3rd String"
Dim arr() As String

arr = Split(stri, ",")

MsgBox Join(arr, ",") 
```

**使用外部对象**

脚本字典

```
Dim dic As Object

Set dic = CreateObject("scripting.Dictionary")
dic.Add "1", "Some String"
dic.Add "2", "Some Other String"
dic.Add "3", "Some 3rd String"

Debug.Print Join(dic.items, ",") 
```

.Net 数组列表

```
Dim al As Object

Set al = CreateObject("System.Collections.Arraylist")
al.Add "Some String"
al.Add "Some Other String"
al.Add "Some 3rd String"

MsgBox Join(al.ToArray(), ",") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-22T14:16:13.937

您可以使用 Collection 对象，然后使用 For...Each 语句循环遍历它：

```
Dim colItems As New Collection
Dim strOutput As String

'Add Items to Collection
colItems.Add "Item 1"
colItems.Add "Item 2"
colItems.Add "Item 3"

'Loop through the collection and place items in strOutput
For Each Item in colItems
    If strOutput <> "" Then strOutput = strOutput & ","
    strOutput = strOutput & Item
Next

Msgbox strOutput 
```

消息框将读取`Item 1,Item 2,Item3`。

这行代码：

```
If strOutput <> "" Then strOutput = strOutput & "," 
```

是在每个项目之后添加一个逗号，除了第一次通过循环（在添加任何项目之前）。

# javascript - 与jquery mobile一起使用时的d3js条形图问题

> ID：13012932
> 
> 赞同：1
> 
> 时间：2012-10-22T13:53:10.090
> 
> 标签：javascript, jquery, html, jquery-mobile, d3.js

我有一个奇怪的问题。我使用 d3js 创建了一个在原始 html 文件中运行良好的条形图。然后我将后者嵌入到一个 jquery 移动小应用程序中。问题是我的条形图发疯了。首先，它不再动画，其次，我所有的条都具有相同的高度，尽管后者是根据绑定到条的数据值分配的。

如果我把它放在一个只有 d3js 的单独的 html 文件中，我的代码可以完美运行。这是我的代码：

# CSS

```
 #report{
                overflow: hidden;   
            }

            div.d3bar {
                display: inline-block;
                width: 20px;
                height: 75px;   /* We'll override this later */
                background-color: teal;
                margin: 2px;
            } 
```

# JS

```
 function init(){
                document.addEventListener("deviceready", onDeviceReady, false);

                $(document).ready(function(){

                    $("a").click(function (e) {
                        e.stopImmediatePropagation();
                        e.preventDefault();

                        $.mobile.changePage($($(this).attr("href")), { transition: "slide"});
                    });
                });
            } 
```

# HTML

```
 <!DOCTYPE HTML>
            <html>
            <head>
                <meta charset="utf-8" />
                <meta name="viewport" content="width=device-width, initial-scale=1">

                <link rel="stylesheet" href="css/XXXX.min.css">
                <link rel="stylesheet" href="css/jquery.mobile.structure-1.2.0.min.css">
                <link rel="stylesheet" href="css/app.css">

                <script type="text/javascript" charset="utf-8" src="js/cordova-2.1.0.js"></script>
                <script type="text/javascript" charset="utf-8" src="js/jquery-1.8.2.min.js"></script>
                <script type="text/javascript" charset="utf-8" src="js/jquery.mobile-1.2.0.min.js"></script>
                <script type="text/javascript" charset="utf-8" src="js/app.js"></script>

                <script type="text/javascript" charset="utf-8" src="js/d3.v2.min.js"></script>

                <title>Lotterie Nationale Loterij</title>
            </head>
                <body onload="init();">  

                    <!-- Start of first page: #one -->
                    <div data-role="page" id="home" data-theme="a">

                        <div data-role="header"><h1>XXXXX Header</h1></div>

                        <div data-role="content" >  
                            <p><a id="btn_dashboard" href="#page_dashboard" data-role="button">Dashboard</a></p>
                            <p><a id="btn_pos360" href="#page_pos360" data-role="button">POS 360°</a></p>   
                            <p><a id="btn_My_Activities" href="#page_My_Activities" data-role="button">My Activities</a></p>        
                            <p><a id="btn_about" href="#page_about" data-role="button" data-rel="dialog" data-transition="pop">About</a></p>
                        </div><!-- /content -->

                        <div data-role="footer" data-theme="a">
                            <h4>Computer Sciences Corporation</h4>
                        </div><!-- /footer -->
                    </div><!-- /page one -->

                    <div data-role="page" id="page_dashboard" data-theme="a">

                        <div data-role="header"><a href="#home" data-icon="Home">Home</a> <h1>Your Dashboard</h1></div>

                        <div data-role="content" id="report">   
                            <script type="text/javascript">
                                $("#page_dashboard").live("pageshow",
                                        function (event) {
                                            $("#report").empty();
                                            var dataset = [ 25, 7, 5, 26, 11, 8, 25, 14, 23, 19,
                                                            14, 11, 22, 29, 11, 13, 12, 17, 18, 10,
                                                            24, 18, 25, 9, 3 ];

                                                    d3.select("#report").selectAll("p")
                                                                        .data(dataset)
                                                                        .enter()
                                                                        .append("div")
                                                                        .transition()
                                                                        .ease("linear")
                                                                        .attr("class", "d3bar")
                                                                        .duration(400)
                                                                        .style("height", function(d){
                                                                                return 10*d;
                                                                            })
                                                                        .text(function(d){return d;});;

                                                    $("#report").trigger("create");
                                        }
                                    );
                            </script>
                            Some statistics here and there
                        </div><!-- /content -->

                    </div>

                    <div data-role="page" id="page_pos360" data-theme="a">

                        <div data-role="header"><a href="#home" data-icon="Home">Home</a> <h1>Point Of Sales 360°</h1></div>

                        <div data-role="content" >  
                            Some pos charts here and there
                        </div><!-- /content -->

                    </div>

                    <div data-role="page" id="page_My_Activities" data-theme="a">

                        <div data-role="header"><a href="#home" data-icon="Home">Home</a> <h1>My Activities</h1></div>

                        <div data-role="content" >  
                            Some activities
                        </div><!-- /content -->

                    </div>

                    <div data-role="page" id="page_about" data-theme="a">

                        <div data-role="header"><a href="#home" data-icon="Home">Home</a> <h1>About XXXX Prototype</h1></div>

                        <div data-role="content" >  
                            Prototype for XXXXX -- 
                            Computer Sciences Corporation
                        </div><!-- /content -->

                        <!--<div data-role="footer" data-theme="a">
                            <h4>The End</h4>
                        </div> /footer -->
                    </div><!-- /page one -->

                </body>
            </html> 
```

有人看到问题了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T13:58:32.417

尝试将其放在 a 中`div`并将`data-enhance="false"`属性添加到 div。这告诉 jQuery Mobile[不要增强](http://jquerymobile.com/demos/1.2.0/docs/forms/forms-all-native.html)容器内的任何标记。您还需要设置`$.mobile.ignoreContentEnabled`为`true.`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-24T07:36:46.570

解决如下：

```
 <script type="text/javascript">
                            $("#page_dashboard").live("pageshow",
                                    function (event) {
                                        $("#report").empty();
                                        var dataset = [ 25, 7, 5, 26, 11, 8, 25, 14, 23, 19,
                                                        14, 11, 22, 29, 11, 13, 12, 17, 18, 10,
                                                        24, 18, 25, 9, 3 ];

                                                d3.select("#report").selectAll("p")
                                                                    .data(dataset)
                                                                    .enter()
                                                                    .append("div")
                                                                    .transition()
                                                                    .ease("linear")
                                                                    .attr("class", "d3bar")
                                                                    .duration(400)
                                                                    .style("height", function(d){
                                                                            return 10*d + "px";
                                                                        })
                                                                    .text(function(d){return d;});

                                                $("#report").trigger("create");
                                    }
                                );
                        </script> 
```

# cmake - 如何将编译标志传递给 cmake 初始编译器测试？

> ID：13012937
> 
> 赞同：9
> 
> 时间：2012-10-22T13:53:29.657
> 
> 标签：cmake, cross-compiling, msp430

我正在尝试使用 CMake 构建一个将[MSPGCC 交叉编译器](http://sourceforge.net/apps/mediawiki/mspgcc/index.php?title=MSPGCC_Wiki)用于 MSP430 微控制器的项目。要使用它成功编译任何简单程序，我们需要传递一个指示目标处理器的编译标志，否则它会像这样失败：

```
$ msp430-gcc -o test test.c
In file included from test.c:1:0:
/usr/local/lib/gcc/msp430/4.6.3/../../../../msp430/include/msp430.h:813:2: warning: #warning Unable to identify and include MCU header, use -mmcu=MCU [-Wcpp]
/usr/local/lib/gcc/msp430/4.6.3/../../../../msp430/bin/ld: cannot open linker script file memory.x: No such file or directory
collect2: ld returned 1 exit status 
```

`-mmcu`因此，如果我使用开关指示处理器，它工作正常。问题是，虽然我已经在我的**CMakeLists.txt**文件中指定了这个：

```
cmake_minimum_required (VERSION 2.6)

project (test-project C)

set (SOURCES
  test.c
  )

add_executable (test-project ${SOURCES})
set (CPU_FLAG "-mmcu=msp430f148")

set (CMAKE_C_FLAGS ${CPU_FLAG})
set (CMAKE_EXE_LINKER_FLAGS ${CPU_FLAG}) 
```

CMake 抱怨编译器未能通过测试来编译一个简单的程序，我敢打赌这是因为它可能**没有使用**开关`-mmcu`（请注意有关无法打开链接器脚本文件 memory.x 的消息）：

```
$ cd ~/git/test-project
$ mkdir build
$ cd build
$ cmake -DCMAKE_TOOLCHAIN_FILE=../msp430.cmake ..
-- The C compiler identification is GNU 4.6.3
-- Check for working C compiler: /usr/local/bin/msp430-gcc
-- Check for working C compiler: /usr/local/bin/msp430-gcc -- broken
CMake Error at /usr/share/cmake-2.8/Modules/CMakeTestCCompiler.cmake:52 (MESSAGE):
  The C compiler "/usr/local/bin/msp430-gcc" is not able to compile a simple
  test program.

  It fails with the following output:

   Change Dir: /home/claudio/git/test-project/build/CMakeFiles/CMakeTmp

  Run Build Command:/usr/bin/gmake "cmTryCompileExec2889462763/fast"

  /usr/bin/gmake -f CMakeFiles/cmTryCompileExec2889462763.dir/build.make
  CMakeFiles/cmTryCompileExec2889462763.dir/build

  gmake[1]: Entering directory
  `/home/claudio/git/test-project/build/CMakeFiles/CMakeTmp'

  /usr/bin/cmake -E cmake_progress_report
  /home/claudio/git/test-project/build/CMakeFiles/CMakeTmp/CMakeFiles 1

  Building C object
  CMakeFiles/cmTryCompileExec2889462763.dir/testCCompiler.c.o

  /usr/local/bin/msp430-gcc -o
  CMakeFiles/cmTryCompileExec2889462763.dir/testCCompiler.c.o -c
  /home/claudio/git/test-project/build/CMakeFiles/CMakeTmp/testCCompiler.c

  Linking C executable cmTryCompileExec2889462763

  /usr/bin/cmake -E cmake_link_script
  CMakeFiles/cmTryCompileExec2889462763.dir/link.txt --verbose=1

  /usr/local/bin/msp430-gcc
  CMakeFiles/cmTryCompileExec2889462763.dir/testCCompiler.c.o -o
  cmTryCompileExec2889462763 -rdynamic

  /usr/local/lib/gcc/msp430/4.6.3/../../../../msp430/bin/ld: cannot open
  linker script file memory.x: No such file or directory

  collect2: ld returned 1 exit status

  gmake[1]: Leaving directory
  `/home/claudio/git/test-project/build/CMakeFiles/CMakeTmp'

  gmake[1]: *** [cmTryCompileExec2889462763] Error 1

  gmake: *** [cmTryCompileExec2889462763/fast] Error 2

  CMake will not be able to correctly generate this project.
Call Stack (most recent call first):
  CMakeLists.txt:3 (project)

-- Configuring incomplete, errors occurred! 
```

仅作记录，我的工具链文件如下，我的 PATH 变量允许它在以下位置找到编译器二进制文件`/usr/local/bin`：

```
# the name of the target operating system
#SET(CMAKE_SYSTEM_NAME Linux)

# which C and C++ compiler to use
SET(CMAKE_C_COMPILER   msp430-gcc)
SET(CMAKE_CXX_COMPILER msp430-g++) 

# here is the target environment located
SET(CMAKE_FIND_ROOT_PATH  /usr/local/msp430) 

# adjust the default behaviour of the FIND_XXX() commands:
# search headers and libraries in the target environment, search 
# programs in the host environment
set(CMAKE_FIND_ROOT_PATH_MODE_PROGRAM NEVER)
set(CMAKE_FIND_ROOT_PATH_MODE_LIBRARY ONLY)
set(CMAKE_FIND_ROOT_PATH_MODE_INCLUDE ONLY) 
```

说了这么多，谁能告诉我如何检查 CMake 使用哪些编译标志来进行编译器测试，以及我们如何传递自定义标志（例如`-mmcu`，例如）使其不会失败？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-30T20:40:50.367

根据文档：

[http://www.cmake.org/Wiki/CMake_Cross_Compiling#The_toolchain_file](http://www.cmake.org/Wiki/CMake_Cross_Compiling#The_toolchain_file)

你应该使用 CMakeForceCompiler 的东西

```
INCLUDE(CMakeForceCompiler)

# this one is important
SET(CMAKE_SYSTEM_NAME eCos)

# specify the cross compiler
CMAKE_FORCE_C_COMPILER(arm-elf-gcc GNU)
CMAKE_FORCE_CXX_COMPILER(arm-elf-g++ GNU)

# where is the target environment 
SET(CMAKE_FIND_ROOT_PATH  /home/alex/src/ecos/install )

# search for programs in the build host directories
SET(CMAKE_FIND_ROOT_PATH_MODE_PROGRAM NEVER)
# for libraries and headers in the target directories
SET(CMAKE_FIND_ROOT_PATH_MODE_LIBRARY ONLY)
SET(CMAKE_FIND_ROOT_PATH_MODE_INCLUDE ONLY) 
```

（从文档中复制和粘贴）

在这里也可以很好地用于我的 MSP430

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2022-02-02T01:34:18.920

**这里的另一个答案已经过时了。**

`CMAKE_<KIND>_FLAGS(_<CONFIG>)_INIT`工具链文件应在适当的变量中包含所需的标志，如下所示：

```
set(CMAKE_C_FLAGS_INIT "-mmcu=msp430f148")
set(CMAKE_CXX_FLAGS_INIT "-mmcu=msp430f148")
set(CMAKE_EXE_LINKER_FLAGS_INIT "-mmcu=msp430f148") 
```

CMake 的编译器检测例程将在编译测试可执行文件时使用这些标志。完整列表可在[CMake 变量文档](https://cmake.org/cmake/help/latest/manual/cmake-variables.7.html)中找到，但完整列表（在撰写本文时）为：

*   `CMAKE_<LANG>_FLAGS_<CONFIG>_INIT`
*   `CMAKE_<LANG>_FLAGS_INIT`
*   `CMAKE_EXE_LINKER_FLAGS_<CONFIG>_INIT`
*   `CMAKE_EXE_LINKER_FLAGS_INIT`
*   `CMAKE_MODULE_LINKER_FLAGS_<CONFIG>_INIT`
*   `CMAKE_MODULE_LINKER_FLAGS_INIT`
*   `CMAKE_SHARED_LINKER_FLAGS_<CONFIG>_INIT`
*   `CMAKE_SHARED_LINKER_FLAGS_INIT`
*   `CMAKE_STATIC_LINKER_FLAGS_<CONFIG>_INIT`
*   `CMAKE_STATIC_LINKER_FLAGS_INIT`

任何 ALL CAPS 配置名称在哪里`<CONFIG>`，包括但不限于`DEBUG`、`RELWITHDEBINFO`、`MINSIZEREL`和`RELEASE`. 非`<CONFIG>`变体适用于*所有*配置并由变体*增强*`<CONFIG>`。

并且，目前包括、、、、、、、和`<LANG>`的任何语言在哪里？当前列表可在[文档](https://cmake.org/cmake/help/latest/command/enable_language.html)中找到。`enable_language()``CXX``C``CUDA``OBJC``OBJCXX``Fortran``HIP``ISPC``ASM`[`enable_language`](https://cmake.org/cmake/help/latest/command/enable_language.html)

# jquery - 在 cytoscape.js 中使用两个图形面板

> ID：13012939
> 
> 赞同：4
> 
> 时间：2012-10-22T13:53:32.877
> 
> 标签：jquery, jquery-selectors, cytoscape-web, cytoscape.js

我需要在 Cytoscape.js 的同一页面中显示两个图形面板。每个面板都包含一个响应来自另一个面板的事件的网络。这在 cytoscape web 的 Flash 版本中曾经很简单。

我声明了两个可视化对象：

```
var vis1 = new org.cytoscapeweb.Visualization(div_id1, options);
var vis2 = new org.cytoscapeweb.Visualization(div_id2, options); 
```

，它们在声明样式和对象侦听器之后我正在绘制它们：

```
vis1.draw({ network: networ_json1 , visualStyle: visual_style1});
vis2.draw({ network: networ_json2 , visualStyle: visual_style2}); 
```

侦听器很容易实现，因为您可以同时访问这两个对象：

```
vis1.addListener("select", "nodes", function(evt) {
    for (var i in evt.target){
        node_ids = evt.target[i].data.conN;
        var  data1 = { selected: "1"};
        if(node_ids.length >= 1){
             vis2.updateData("nodes", node_ids, data1)
             vis2.select("nodes",node_ids);
        }
    }
}); 
```

现在我想将它升级到 Cytoscape.js，但我坚持在同一页面上显示两个面板。1）让我知道我哪里出错了，2）请给我一个关于下一步如何进行的提示。如果在面板 1 中选择节点，则在面板 2 中选择节点的一个小示例会很棒！

这是test.html：

```
<html>
    <head>
        <title>Cytoscape.js double panel test</title>
        <script src="js/jquery.js"></script>
        <script src="js/cytoscape.min.js"></script>
        <script src="js/simple.js"></script>
        <script></script>
    </head>
    <body>
    <div id="cy1" style="height:600px;width:800px;border:1px solid #777;"></div>
    <div id="cy2" style="height:600px;width:800px;border:1px solid #777;"></div>
    </body>
</html> 
```

这里是 simple.js。只有面板二会显示一个网络，而不是两者。

```
$(function(){
    var nodes1 = [];
    for (var i = 0; i < 5; i++) {
        nodes1.push({
            data:{
                id: "n" + i
            },
            group: 'nodes1'
        });
    }

    var edges1 = [];
    edges1.push({ data: { id: 'e1', source: 'n1', target: 'n2' }, group: 'edges1' })
    edges1.push({ data: { id: 'e2', source: 'n1', target: 'n3' }, group: 'edges1' })
    edges1.push({ data: { id: 'e3', source: 'n1', target: 'n4' }, group: 'edges1' })
    edges1.push({ data: { id: 'e4', source: 'n2', target: 'n0' }, group: 'edges1' })
    edges1.push({ data: { id: 'e5', source: 'n3', target: 'n2' }, group: 'edges1' })

    $("#cy1").cytoscape({
        elements: {
            nodes: nodes1,
            edges: edges1
        }
    });

    var nodes2 = [];
    for (var i = 0; i < 5; i++) {
        nodes2.push({
            data:{
                id: "n" + i
            },
            group: 'nodes2'
        });
    }

    var edges2 = [];
    edges2.push({ data: { id: 'e1', source: 'n1', target: 'n2' }, group: 'edges2' })
    edges2.push({ data: { id: 'e2', source: 'n1', target: 'n3' }, group: 'edges2' })
    edges2.push({ data: { id: 'e3', source: 'n1', target: 'n4' }, group: 'edges2' })
    edges2.push({ data: { id: 'e4', source: 'n2', target: 'n0' }, group: 'edges2' })
    edges2.push({ data: { id: 'e5', source: 'n3', target: 'n2' }, group: 'edges2' })

    $("#cy2").cytoscape({
        elements: {
            nodes: nodes2,
            edges: edges2
        }   
    });

}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-01T22:13:00.587

目前，这还没有完全实现。您可以通过以下方式跟踪其进度：[https](https://github.com/cytoscape/cytoscape.js) ://github.com/cytoscape/cytoscape.js 。

如果您有特定/紧急需求，请告诉我，我可以优先处理它。

编辑：在 cytoscape.js 中拥有多个图形面板是活跃的紧急功能之一。预计在 3.5 天内完成。该持续时间可以根据需要减少。

# c - C语言中的非上下文无关语言的例子？

> ID：13012940
> 
> 赞同：1
> 
> 时间：2012-10-22T13:53:34.103
> 
> 标签：c, programming-languages, grammar, context-free-grammar, context-sensitive-grammar

C 语言中的非上下文无关语言的例子有哪些？C语言中如何存在以下非CFL？

> a) L1 = {wcw|w 是 {a,b}*}
> 
> b) L2 = {a^nb^mc^nd^m| n,m >=1}

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-23T07:15:35.017

这个问题措辞笨拙，所以我在字里行间阅读，在这里。尽管如此，这是一个常见的家庭作业/学习问题。

通常呈现的 C 语法中的各种歧义 [1] 不会使该*语言*成为非上下文无关的。（实际上，它们甚至不会使语法成为非上下文无关的。）一般规则“如果它看起来像一个声明，那么它就是一个声明，而不管其他可能的解析”可能可以编码为一个非常复杂的上下文无关语法（虽然这不是 100% 明显的，因为 CFG 不会在交集或差异下关闭），但是使用更简单的 CFG 解析然后根据声明规则消除歧义会更容易。

现在，关于 C（和大多数编程语言）的重要一点是，该语言的语法比用于解释目的的 BNF 复杂得多。例如，如果使用未定义的变量，则 C 程序的格式不正确。这是一个语法错误，但 CFG 解析器没有检测到它。由于语言的复杂语法，定义这些情况所需的语法产生非常复杂，但它们归结为要求 id 在有效程序中出现两次。因此`L1 = {wcw|w is {a,b}+}`（这里`w`是标识符，`c`拼写太复杂了）。在实践中，检查这个要求通常是用符号表来完成的，形式语言规则虽然精确，但不是用逻辑形式写成的。自从`L1`不是上下文无关的语言，形式主义不可能是上下文无关的，但是上下文相关的语法可以识别`L1`，所以这不是完全不可能的。（例如，参见[Algol 68。](http://en.wikipedia.org/wiki/Van_Wijngaarden_grammar)）

符号表还用于决定是否将特定`identifier`内容简化为`typedef-name`[2]。这是解决语法中的许多歧义所必需的。（它还进一步限制了语言中的字符串集，因为在某些情况下，`identifier`必须将 an 解析为 a`typedef-name`才能使程序有效。）

对于另一种类型的上下文敏感，函数调用需要在参数*数量*上匹配函数声明；这类需求由`L2 = {a^n b^m c^n d^m| n,m >=1}`where建模`a`，`c`代表某个功能的定义和使用，`b`以及`d`代表不同功能的定义和使用。（再次，以高度简化的形式。）

这第二个要求可能不太清楚是句法要求。其他语言（例如 Python）允许使用任意数量的参数调用函数，并将参数/参数计数匹配检测为仅在运行时检测到的语义错误。然而，在 C 的情况下，不匹配显然是语法错误。

简而言之，构成 C 语言的语法有效字符串集是 C 语言定义中呈现的 CFG 识别的字符串集的真子集；有效解析集是 CFG 生成的推导集的真子集，并且语言本身是 (a) 明确的，并且 (b) 不是上下文无关的。

注 1：其中大多数并不是真正的歧义，因为它们取决于如何`identifier`解析给定的（typedef 名称、函数标识符、声明的变量……）。

注2：不是`identifier`必须解决的情况，`typedef-name`如果它恰好是一个；这只发生在可以减少的地方。即使在相同的范围内，对类型和变量使用相同的标识符也不是语法错误。（这不是一个好主意，但它是有效的。）以下示例改编自标准第 6.7.8 节中的示例，显示`t`了字段名称和 typedef 的用法：

```
typedef signed int t;
struct tag {
    unsigned t:4;  // field named 't' of type unsigned int
    const t:5;     // unnamed field of type 't' (signed int)
}; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-22T14:10:39.517

这些东西在 C 中不是上下文无关的：

```
foo * bar; // foo multiplied by bar or declaration of bar pointing to foo?
foo(*bar); // foo called with *bar as param or declaration of bar pointing to foo?
foo bar[2] // is bar an array of foo or a pointer to foo?
foo (bar baz) // is foo a function or a pointer to a function? 
```

# git - git：查找 4-5 个月前已删除分支的最后提交哈希

> ID：13012950
> 
> 赞同：0
> 
> 时间：2012-10-22T13:54:05.347
> 
> 标签：git

4-5 个月前，我删除了一个远程/本地分支（名为“dev0001”）。现在，我需要访问该分支。因此，**我需要**在已删除的分支中找到最新的提交哈希，以便我可以恢复它。

您知道如何找到已删除分支的最新提交哈希，然后将其签出到我的本地计算机吗？

我在 Stackoverflow 上发现了很多关于记录分支的问题和答案，但不知道如何找到 4-5 个月前已删除分支的最新提交哈希。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T14:18:54.070

如果您可以[查看该分支的**reflog**](http://www.kernel.org/pub/software/scm/git/docs/git-reflog.html)，它将列出提交 - 您可以尝试：

```
git reflog show dev0001 
```

或者，您可以在 reflog 中搜索`HEAD`：

```
git reflog 
```

... 提及`dev0001`.

但是，由于 reflog 条目的默认过期时间是 90 天，这可能不会产生任何结果。

您确定任何远程跟踪分支`dev0001`也已被删除吗？要检查这一点，我会尝试：

```
git branch -a | grep dev0001 
```

...在每个可能在某个时候获取该分支的存储库中。人们通常会留下远程跟踪分支，即使它们已在最初从中获取它的服务器上被删除。

# squid - Squid 限制某些域每分钟的请求数

> ID：13012953
> 
> 赞同：0
> 
> 时间：2012-10-22T13:54:06.960
> 
> 标签：squid

有没有办法限制我的 squid 用户访问例如 Facebook 每小时不止一次？我知道如何拒绝域，但如果可能，我想将此请求大小限制为 1/给定时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T01:34:12.427

不能直接用 Squid 做到这一点。您可以尝试编写外部 acl 帮助程序。

# c# - 如何重载返回类型

> ID：13012956
> 
> 赞同：3
> 
> 时间：2012-10-22T13:54:15.593
> 
> 标签：c#, .net

> **可能重复：**
> [真的不可能使用返回类型重载吗？](https://stackoverflow.com/questions/1481137/really-impossible-to-use-return-type-overloading)

有没有办法采用相同的方法并重载其返回类型？就像我在下面的代码中所做的那样。我试过这个，但它说两者之间存在歧义。

```
//supporting methods
private AutoResetEvent ReturnData = new AutoResetEvent(false);
public void PostMessage(string msg)
{ this.Message = msg; this.ReturnData.Set(); }
private string Message;
//a return value overload
public string GetMessage()
{
    this.ReturnData.WaitOne();
    return this.Message;
}
public byte[] GetMessage(){
    this.ReturnData.WaitOne();
    return encoder.GetBytes(Message);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-22T13:56:01.990

您不能通过 C# 中的返回类型重载。

当需要在 .NET 框架中完成类似的操作时，他们通常会更改方法名称以包含返回类型的名称。

**例子：[`BinaryReader`](http://msdn.microsoft.com/en-us/library/hf6bat53.aspx)**

```
double ReadDouble() { ... }
int ReadInt32() { ... } 
```

**例子：[`SQLDataReader`](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqldatareader.aspx)**

```
double GetDouble(int i) { ... }
int GetInt32(int i) { ... }
etc... 
```

在您的情况下，您可以例如使用`GetMessageString`and `GetMessageBytes`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-22T13:56:16.590

[这是C# 语言规范](http://msdn.microsoft.com/en-us/vcsharp/aa336809.aspx)第 1.6.6 节的摘录：

> “方法的签名在声明该方法的类中必须是唯一的。方法的签名由方法的名称、类型参数的个数及其参数的个数、修饰符和类型组成。方法的签名不包括返回类型。”

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-22T13:56:50.163

重载解决方案适用于方法签名。

方法签名由方法名称和参数类型和编号组成，但不包括返回类型。

这意味着您不能仅通过返回类型重载方法。

在这种情况下，更好的设计是根据返回类型来命名方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-22T13:58:49.257

不，您不能，签名不依赖于返回类型，因此解决方案可能是：

```
public string GetMessageString()
{
    this.ReturnData.WaitOne();
    return this.Message;
}
public byte[] GetMessageBytes(){
    this.ReturnData.WaitOne();
    return encoder.GetBytes(Message);
} 
```

或者您可以使用泛型类型解决问题：

```
public T GetMessage<T>()
{
    this.ReturnData.WaitOne();
    if(typeof(T) == typeof(string))
       return this.Message;
    else if(typeof(T) == typeof(byte[]))
       return encoder.GetBytes(Message);

    return default(T);
} 
```

# java - java jdbc insert 在oracle db中触发触发器

> ID：13012960
> 
> 赞同：0
> 
> 时间：2012-10-22T13:54:32.647
> 
> 标签：java, oracle, jdbc

假设

*   我使用 Java Jdbc 在表中插入
*   插入触发触发器

java等待触发器完成执行还是继续执行？

（使用甲骨文 11g）

如果它继续没有等待，我有办法等待触发器执行结束吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T14:05:00.973

`INSERT`在所有需要触发的触发器都触发并运行完成之前，该语句不完整。无论您使用哪种前端语言来发出`INSERT`语句，都`INSERT`必须始终等待触发器完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-22T14:11:35.543

即使 a`INSERT`调用`N NUMBER OF TRIGGER`，首先所有的`TRIGGERS`将完成执行，而`INSERT`将等待，然后它会回到`INSERT`

这也是合乎逻辑的，如果我在插入数据库之前触发了一些触发器，那么我希望它们在插入之前完成。

在 INSERT 语句响应之前，JAVA 不会移动到下一条语句，并且在它完成执行之前不会响应，并且在所有被触发的触发器都完成之前它不会完成执行。

# webview - 在 Windows 8 中将事件绑定到 mvvm 模型

> ID：13012967
> 
> 赞同：2
> 
> 时间：2012-10-22T13:55:02.437
> 
> 标签：webview, windows-8, mvvm-light

我想在 WebView 中绑定事件，但出现异常：

> `Windows.UI.Xaml.Markup.XamlParseException`VK.exe 中出现“ ”类型的异常，但未在用户代码中处理
> 
> WinRT 信息: 无法将“ ”类型的实例添加到“ ”`Win8nl.Behaviors.EventToCommandBehavior`类型的集合中`System.Collections.ObjectModel.ObservableCollection<WinRtBehaviors.Behavior>`

您可能知道，Windows SDK**没有 System.Interaction.dll**。我试图在网络上（为 Windows RT 编译）或 Blend 文件夹中找到它，但找不到。

比我发现**[Win8nl](http://nuget.org/packages/Win8nl)**使用行为允许我在视图模型中连接控件和 RelayCommands 的事件。

他们帮助我绑定加载的事件以供查看：这是代码：

```
...
xmlns:WinRtBehaviors="using:WinRtBehaviors"
xmlns:Win8nl_Behavior="using:Win8nl.Behaviors"
DataContext="{Binding Login, Source={StaticResource Locator}}">

<WebView x:Name="webView" 
    Grid.Row="1"                 
    Grid.Column="1"
    HorizontalAlignment="Left"
    VerticalAlignment="Top" 
    ScrollViewer.VerticalScrollBarVisibility="Hidden"
    ScrollViewer.HorizontalScrollBarVisibility="Hidden"
    Height="420" Width="530">
    <WinRtBehaviors:Interaction.Behaviors>
        <Win8nl_Behavior:EventToCommandBehavior Event="LoadCompleted"       
                                            Command="WebViewLoadedCommand" />
        </WinRtBehaviors:Interaction.Behaviors>
    </WebView> 
```

视图模型：

```
public LoginViewModel(IDataService dataService)
{
    WebViewLoadedCommand = new RelayCommand(() => {
    var msg = new MessageDialog("Web View Loaded");

    msg.ShowAsync();
    });
}

public RelayCommand WebViewLoadedCommand { get; private set; } 
```

我也想获得 NavigatedEventsArgs 参数，就像我为 WP7 和 System.Interaction 所做的那样：

```
 <i:Interaction.Triggers>
     <i:EventTrigger EventName="Navigated">
         <mvvm:EventToCommand Command="{Binding NavigatedCommand, Mode=OneWay}" PassEventArgsToCommand="True" />
      </i:EventTrigger>
 </i:Interaction.Triggers> 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T09:27:24.107

你想要[WinRt 触发器](http://winrttriggers.codeplex.com/)。

这个开源项目为 WinRT 实现了 Interaction.Triggers

# javascript - ajax调用上的浏览器后退按钮

> ID：13012969
> 
> 赞同：3
> 
> 时间：2012-10-22T13:55:10.173
> 
> 标签：javascript, cross-browser

当我登录到我的应用程序时，应用程序的 url 是`localhost/#`.

然后我在我的应用程序中进行了搜索，它与 ajax 调用一起使用，在我得到结果后，url 仍然保持不变。

因此，当我单击浏览器的后退按钮时，我的应用程序将返回到我的应用程序的登录页面。所以我只需要限制页面不去登录页面。

我正在尝试这样做：

```
window.onload = function () {
    if (typeof history.pushState === "function") {
        history.pushState("jibberish", null, null);
        window.history.go(1);
        window.onpopstate = function () {
            history.pushState('newjibberish', null, null);
            window.history.go(-1);
            // Handle the back (or forward) buttons here
            // Will NOT handle refresh, use onbeforeunload for this.
        };
    }
    else {
        var ignoreHashChange = true;
        window.onhashchange = function () {
            if (!ignoreHashChange) {
                ignoreHashChange = true;
                window.location.hash = Math.random();
                // Detect and redirect change here
                // Works in older FF and IE9
                // * it does mess with your hash symbol (anchor?) pound sign
                // delimiter on the end of the URL
            }
            else {
                ignoreHashChange = false;   
            }
        };
    } 
```

但是，当我单击主页中的后退按钮时，后退按钮将被禁用，而我需要获取我之前执行的搜索结果。

# c# - 如何使用 VS2010 中的 GUI 调整 DataGridView 中列的大小？

> ID：13012972
> 
> 赞同：1
> 
> 时间：2012-10-22T13:55:13.380
> 
> 标签：c#, visual-studio-2010, datagridview

当我在 Windows 窗体上有一个 DataGridView 时，有没有办法使用我的鼠标简单地将一列拖动到适当的宽度，而不是通过编程或手动输入大小来进行？

[编辑] 这个问题是指列宽的设计时编辑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T14:29:20.610

不，根本不支持这一点。

很可能是因为它被认为是不必要的。
调整数字（宽度和填充重量）会更有效率。

# javascript - jQuery attr 似乎没有返回字符串？

> ID：13012975
> 
> 赞同：5
> 
> 时间：2012-10-22T13:55:16.543
> 
> 标签：javascript, jquery

我有以下代码：

JS：

```
var test2 = ['RMrpi5Z8doc','JIPbUaqyYx0','MbjXYg0YRmw'];

    $('tr').live('click', function(event){
      $($(this).attr('class').split(' ')).each(function() { 
        if (!((this == 'even') || (this == 'odd'))) {
            alert(jQuery.inArray(this, test2));
            if (this == 'RMrpi5Z8doc') {
              alert(this);
            }
        }   
      });
    }); 
```

HTML：

```
 <table>
   <tr class="odd RMrpi5Z8doc">
     <td>Kite</td>
     <td>Just Like Vinyl</td>
     <td>Audiotree</td>
   </tr>
  </table> 
```

inArray 不匹配并返回 -1。匹配文字字符串的 if 语句确实匹配。如果我用 inArray 中的文字替换，那也匹配。

我看过一篇文章说 jQuery attr 不再返回字符串，但是查看 jQuery 站点上的 attr 文档似乎说它确实如此。

也许我应该以完全不同的方式解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-22T13:56:52.637

你用错了`each`。你的意思是[`jQuery.each`](http://api.jquery.com/jQuery.each/)，通用迭代器：

```
$.each($(this).attr('class').split(' '), function ...); 
```

不是[`each`](http://api.jquery.com/each/)，jQuery 实例上的实例函数：

```
$($(this).attr('class').split(' ')).each(function ...); // Wrong 
```

特别是，正在发生的是上面的这一部分：

```
$($(this).attr('class').split(' ')) 
```

...调用`$()`数组，它不会做你想做的事。:-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-22T14:42:04.400

我已经使用以下方法重构了它：

```
$(document).on('click', 'tr', function(){
  alert(jQuery.inArray($(this).attr('id'), test2));
} 
```

这似乎有效。我已将类名移至 id 字段，因为我没有将这些标识符用于任何样式表，它们确实是 id。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-22T14:33:03.410

这确实是类型不匹配。如果您切换到`if (this === 'RMrpi5Z8doc') {`，第二个警报将不再触发。使用`this.toString()`将解决此问题，如下所示：

```
$.each($(this).attr('class').split(' '), function() { 
    //...etc. 
```

顺便说一句，这是一种不寻常的做法。通常，您将使用以下方法测试一个类`hasClass`：

```
$('tr').on('click', function() {
    if ($(this).hasClass('odd')) {
        //... 
```

此外，正如 raina77ow 所指出的，还有`:even`和`:odd`伪类：

```
$('tr').on('click', function() {
    if ($(this).is(':odd')) {
        //... 
```

这样，您可以完全省去您的`odd`和`even`课程。

# mysql - 使用 AS 和子查询的慢 MySQL 查询

> ID：13012989
> 
> 赞同：2
> 
> 时间：2012-10-22T13:55:47.817
> 
> 标签：mysql, database, performance, optimization, subquery

我对这个运行 10 多秒的慢查询有疑问：

```
SELECT DISTINCT siteid,
                storyid,
                added,
                title,
                subscore1,
                subscore2,
                subscore3,
                ( 1 * subscore1 + 0.8 * subscore2 + 0.1 * subscore3 ) AS score
FROM   articles
WHERE  added > '2011-10-23 09:10:19'
       AND ( articles.feedid IN (SELECT userfeeds.siteid
                                 FROM   userfeeds
                                 WHERE  userfeeds.userid = '1234')
              OR ( articles.title REGEXP '[[:<:]]keyword1[[:>:]]' = 1
                    OR articles.title REGEXP '[[:<:]]keyword2[[:>:]]' = 1 ) )
ORDER  BY score DESC
LIMIT  0, 25 
```

这会根据用户添加到其帐户的站点输出故事列表。排名由分数决定，分数由子分数列组成。

该查询使用文件排序并使用 PRIMARY 和 feedid 上的索引。解释的结果：

```
1   PRIMARY articles    
range   
PRIMARY,added,storyid   
PRIMARY  729263 rows    
Using where; Using filesort

2   DEPENDENT SUBQUERY  
userfeeds   
index_subquery  storyid,userid,siteid_storyid   
siteid  func    
1 row   
Using where 
```

有什么改进这个查询的建议吗？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T13:59:02.797

我会将计算逻辑移动到客户端，并且只从数据库中加载字段。这使您的查询和计算本身更快。在 SQL 代码中做这样的事情不是一种好的风格。而且正则表达式也很慢，也许像“LIKE”这样的另一种搜索模式更快。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-22T14:20:42.660

查看您的`EXPLAIN`，您的查询似乎没有使用任何索引（因此文件排序）。这是由计算列 ( `score`) 上的排序引起的。

另一个障碍是表的大小（729263 行）。您不想创建太宽的索引，因为它会占用更多空间并影响 CUD 操作的性能。我们想要做的是定位正在选择的列，但是，在这种情况下我们不能，因为它是一个计算列。您可以尝试创建`VIEW`或删除排序或在应用程序层执行此操作。

# c# - 存储 Excel/Word 文档 Windows Azure Blob 存储文件损坏

> ID：13012990
> 
> 赞同：3
> 
> 时间：2012-10-22T13:55:47.810
> 
> 标签：c#, asp.net-mvc, azure-storage

我们已经开始使用 Azure blob storage api 在我们的网站上存储上传的 blob，图像工作正常，但是当我们上传 word/excel 文档并返回 Url 并尝试从该 url 下载文件并打开它时，我们得到一个Excel 或 Word 中的错误提示：

“Excel 无法打开文件“somefile.xlsx”，因为格式或文件扩展名无效。验证文件没有损坏并且文件扩展名与文件格式匹配“。

我知道我一定遗漏了一些明显的东西，但不确定是什么，下面是我们正在使用的代码：

```
 CloudBlobContainer container = GetCloudBlobContainer();

  Guid guid = Guid.NewGuid();
  string storeFilename = String.Concat(mediaType.ToString(), "/", guid, "_", filename);

  var blob = container.GetBlobReference(storeFilename);
  blob.Properties.ContentType = contentType;
  blob.UploadFromStream(stream);

  return blob.Uri.AbsolutePath; 
```

我们返回 URL 并将其存储在已上传的文件中，并将其用作下载文件的链接。

文件下载正常，与上传的大小完全相同，但无法打开。

任何帮助将不胜感激，因为它必须是如此明显的东西，但我害怕它躲避我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T01:25:48.183

您使用什么代码将文档保存到 Azure？

上传和下载时 ContentType 的值是多少？

您是否对上传流进行了 UTF8 编码？

看看[这个上传示例](http://blogs.msdn.com/b/davidlem/archive/2009/07/20/save-your-word-docs-to-windows-azure-blobs.aspx)，它在上传之前设置了 ContentType 和 UTF8 编码。

# android - 在android中将二维字符串数组转换为ArrayList

> ID：13012993
> 
> 赞同：4
> 
> 时间：2012-10-22T13:55:54.517
> 
> 标签：android, arrays, multidimensional-array, arraylist

怎么转换**`2d string array`**成**`ArrayList`**？？我有一个二维字符串数组，如何将其转换为数组列表？？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-22T13:58:43.717

如果您想要完整的元素列表，请执行此操作。大概有一个简单的方法

```
 ArrayList<String> list = new ArrayList<String>();
   for (int i=0; i < array_limit ; i++)
       for (int j=0 ; j < array_limit; j++)
              list.add(your_array[i][j]); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-22T14:05:02.923

```
public static ArrayList<String> rowsToString(String[][] data) {
    ArrayList<String> list = new ArrayList<String>();

    for(int i = 0; i < data.length; i++) {
        String row = Arrays.toString(data[i]);
        list.add( row.substring(1, row.length()-1) );
    }

    return list;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-22T14:12:10.160

取决于你到底想要什么。尝试：

```
for(int i=0;i<a.length;i++){

        newList.add(new ArrayList<String>());
        for(int j=0;j<a.length;j++){
        newList.get(i).add(a[i][j]);
        }

    } 
```

然后，您可以通过以下方式访问元素：

```
newList.get(1).get(2); 
```