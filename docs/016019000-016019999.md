# StackOverflow 问答 16019000-16019999

# groovy - Groovy 'Peeking' 使用迭代器？

> ID：16019000
> 
> 赞同：7
> 
> 时间：2013-04-15T15:25:13.237
> 
> 标签：groovy, iterator, closures, peek

我在循环中有各种场景，我会在迭代处理项目时“偷看”或“跳过”。

一种情况是我正在枚举文件的行，并且在行的末尾有一个“继续”字符，表示将下一行与当前行结合起来。如果我只是简单地循环并不太难，我可以阅读下一行，然后碰撞我的计数器/索引。

使用我的迭代器执行此操作的模式并不明显。我实际上想在不退出关闭的情况下使用下一行。但我什至不确定这是否可能。这种使用闭包的迭代模式是否有任何好的设计模式，所以我不必求助于不那么常规的循环？它可能是一种迭代器的形式，带有一些用于推送/弹出项目进行处理的堆栈？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T16:00:20.883

我会制作一个负责合并行的迭代器。对于续行示例，迭代器可以在其构造函数中从文件中读取行，然后`next`从行中读取其方法，在找到续行字符时提前读取，以便在下一步之前解析续行字符在管线中。因此，您需要的任何状态机都将包含在迭代器中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T17:47:12.743

前一段时间我不得不实现类似的东西。我有一个大文件，每行都有管道分隔的数据，数据可以在下一行继续，但我只能知道我是否“偷看”了下一行。我最终使用 ArrayList 作为堆栈并结合了 peek 方法：

```
def list = [1, 2, 3, 4, 5, 6, 7]

list.metaClass.peek = { delegate[-1] }

assert list.pop() == 7
assert list.pop() == 6
assert list.peek() == 5
assert list.peek() == 5
assert list.pop() == 5
assert list.pop() == 4
assert list.peek() == 3 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T18:10:21.220

有趣的问题。

这里的关键问题是您需要通过迭代携带一些状态。

一种方法是使用外部变量（这里我使用的是字符串数组而`List#each`不是文件 and `File#eachLine`，但它们应该是类似的）：

```
def lines = [
  "Single line.",
  "Long \\",
  "line \\",
  "continuation.",
  "Single line."
]

def processLine(line) { println "Processing \"$line\""}

def continuation = ''
lines.each { line ->
  line = continuation + line
  if (line.endsWith('\\')) {
    continuation = line.take(line.size() - 1)
  }
  else {
    processLine(line)
    continuation = ''
  }
} 
```

另一种方法是使用专门设计用于通过交互携带状态的迭代器，例如[`Collection#inject`](http://groovy.codehaus.org/groovy-jdk/java/util/Collection.html#inject%28groovy.lang.Closure%29)：

```
lines = lines.inject([]) { list, line ->
  if (list && list[-1].endsWith('\\'))
    list[-1] = list[-1][0..-2] + line
  else 
    list << line
  list
}

lines.each { processLine(it) } 
```

在这种情况下，我们首先加入连续的行，然后处理它们。

在这两种情况下，输出都是：

```
Processing "Single line."
Processing "Long line continuation."
Processing "Single line." 
```

# escaping - 在sybase中转义双引号

> ID：16019007
> 
> 赞同：0
> 
> 时间：2013-04-15T15:25:32.450
> 
> 标签：escaping, sybase, sap-ase

我正在数据库上运行查询以检索 CSV（带引号）格式的记录：

`"Data","More data","some "funny" data with quotes","more"`.

现在，当它被解析时，这个位有一个明显的问题：

`...,"some "funny" data with quotes",...`

有没有办法在sybase中“转义”这些引号来节省我的后期处理？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-20T08:39:54.913

如果您只想在文字字符串中选择双引号，请使用单引号作为字符串的分隔符。

试试 select '"' 你会看到

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-31T21:56:34.970

--执行完这句话后：SET QUOTED_IDENTIFIER ON

--你将能够执行：select count(*) from "/table/name" go

# c - 不使用 sizeof 查找数组的大小

> ID：16019009
> 
> 赞同：17
> 
> 时间：2013-04-15T15:25:33.403
> 
> 标签：c, arrays, sizeof

我正在寻找一种无需使用即可在 C 中查找数组大小的方法`sizeof`，我找到了以下代码：

```
int main ()
{
    int arr[100];
    printf ("%d\n", (&arr)[1] - arr);
    return 0;
} 
```

谁能向我解释一下它是如何工作的？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-04-15T15:27:50.917

`&arr``int`是一个指向 100 s数组的指针。

`[1]`意思是“添加指向的东西的大小”，它是一个 100 s`int`的数组。

所以 和 之间的差`(&arr)[1]`是`arr`100`int`秒。

（请注意，此技巧仅适用于`sizeof`本来可以工作的地方。）

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-04-15T15:34:57.920

`&arr`给你一个指向数组的指针。`(&arr)[1]`相当于`*(&arr + 1)`。`&arr + 1`给你一个指向后面的 100 个整数数组的指针`arr`。取消引用它`*`会为您提供随后的数组。由于该数组用于加法表达式 ( `-`)，因此它衰减到指向其第一个元素的指针。同样的情况也发生`arr`在表达式中。所以你减去指针，一个指向不存在的元素`arr`，另一个指向`arr`. 这给你100。

但它不起作用。`%d`用于`int`. 指针差异返回你`ptrdiff_t`而不是`int`。您需要`%td`使用`ptrdiff_t`. 如果你`printf()`对传递给它的参数类型撒谎，你会得到当之无愧的未定义行为。

**编辑**：`(&arr)[1]` *可能会*导致未定义的行为。这并不完全清楚。如果有兴趣，请参阅下面的评论。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-02-09T19:04:03.697

通常（根据 Visual Studio），对于一个数组**`&arr`，`arr`**它返回我们函数的起始基地址。

**`(&arr)[0]`只不过是`&arr`或`arr`**

例如：它将返回一些地址：`1638116`

现在，`(&arr)[1]`意味着我们开始从反弹中访问数组意味着下一个数组或当前数组大小的下一个段（提前 100 个）。

例如：它将返回一些地址：`1638216`

现在，减去`(&arr)[1] - (&arr)[0]=100`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-03-11T11:02:55.690

`&variable`给出变量的位置（称它为`P`）
`&variable + 1`给出变量旁边位置的地址。（称它为`N`）

`(char*)N-(char*)P``N`给出和之间有多少个字符`P`。由于每个字符都是 1 字节大小，所以上面的结果给出了字节数`P`和`N`. （等于数组的大小，以字节为单位）。

同样， `(char*) (a+1)-(char*)a;`给出数组中每个元素的大小（以字节为单位）。

所以数组中的元素个数=`(size of array in bytes)/(size of each element in the array in bytes)`

```
#include<stdio.h>

int main()
{
    int a[100];
    int b = ((char*)(&a+1)-(char*)(&a));
    int c = (char*) (a+1)-(char*)a;
    b = b/c;
    printf("The size of array should be %d",b);
    return 0;

} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-06-29T19:52:10.207

int arry[6]={1,2,3,4,5,6} //让数组元素为 6，所以... size in byte = (char*)(arry+6)-(char *)( arry)=24;

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2015-10-04T08:17:57.020

```
int main ()
{
  int arr[100];
  printf ("%d\n", ((char*)(&arr+1) - (char*)(&arr))/((char*) (arr+1) -(char*) (arr)));
  return 0;
} 
```

# android - 如何使用 Robotium 测试两个活动

> ID：16019011
> 
> 赞同：6
> 
> 时间：2013-04-15T15:25:46.270
> 
> 标签：android, automated-tests, robotium

我正在使用[Robotium](https://code.google.com/p/robotium/)测试我的 Android 应用程序，但遇到了一个间歇性问题。我的应用程序以允许用户登录的 SigninActivity 开始，然后他被定向到第二个活动，该活动具有在向 Web 服务器发出请求后填充的列表。

第一个问题是：由于我的所有活动只有在用户登录后才能访问，所以我需要从登录屏幕开始对每个活动进行测试。所以我正在做的是每个活动测试类，我从它继承

```
ActivityInstrumentationTestCase2<SigninActivity> 
```

在 setUp 方法中，我正在登录用户。这是正确的方法吗？

第二个问题：我想测试在向 Web 服务器发出请求后填充的第二个活动中的列表数据。如上所述，在我的设置方法中，我登录了用户，然后使用

```
solo.waitForActivity(SecondActivity.class, BIG_TIMEOUT)
solo.waitForView(ListView.class) 
```

保证第二个活动和列表存在。问题是，即使有这个验证，我也经常得到

```
junit.framework.AssertionFailedError: Can not click on line number 2 as there are only 0 lines available 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-07-18T22:25:14.213

通过使用以下方法，我能够在我的应用程序中测试多个活动：

1.  开始第一个活动
2.  在活动中做某事（例如，单击一个开始新活动的按钮）
3.  等待第二个活动。
4.  在第二个活动中做某事（例如，输入一些输入文本，然后单击另一个按钮）
5.  等等

示例代码： public void testDisplayBlackBox() {

```
 //Click on add ident button
    solo.clickOnButton("Tap to get another number");
    if (solo.waitForActivity(IdentityTemplateActivity.class)) {
        // select ident type
        solo.clickOnImageButton(0);

        // add name/label and create ident
        if (solo.waitForActivity(NumberDetailActivity.class)) {
            solo.enterText(0, "Robotium");
            solo.enterText(1, "test 1");    
            solo.clickOnImageButton(6);
        }
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T21:07:40.967

首先，在 setUp 方法中编写逻辑代码不是一个好主意。我建议您使用这样一个事实，即测试用例按字母顺序运行 - 使用登录创建一个测试方法，然后您在其余的应用程序中登录（如果该案例首先运行），所以您不需要必须在每个测试方法之前登录。

关于你的第二个问题，solo.waitForView(ListView.class) 等待指定的时间（我不记得什么是默认值），但你没有断言它。你应该使用：

```
assertTrue(solo.waitForView(ListView.class)); 
```

但是，ListView 似乎有问题。确保屏幕上只有一个列表视图，否则您必须使用它的索引：

```
solo.clickInList(int line, int index) 
```

# r - R中的似然最大化

> ID：16019012
> 
> 赞同：2
> 
> 时间：2013-04-15T14:49:43.797
> 
> 标签：r, optimization

在 R 中，我编写了一个包含两个递归计算的对数似然函数。对数似然函数正常工作（它给出了已知参数值的答案），但是当我尝试使用 最大化它时`optim()`，它需要太多时间。如何优化代码？提前感谢您的想法。

这是具有使用 copula 函数的依赖结构的马尔可夫状态切换模型的对数似然函数。

![对数似然函数](https://i.stack.imgur.com/5DnNr.png)

`g`在 for 循环中命名：

![g 在代码中](https://i.stack.imgur.com/fRE02.png)

`p`在 for 循环中命名：

![p 在代码中](https://i.stack.imgur.com/kDzBZ.png)

`f`在代码中命名：

![f 在代码中](https://i.stack.imgur.com/IvrL6.png)

一些数据：

```
u <- cbind(rt(100,10),rt(100,13)) 
```

`f`功能：

```
f=function(u,p,e1,e2){
     s=diag(2);s[1,2]=p
     ff=dcopula.gauss(cbind(pt(u[,1],e1),pt(u[,2],e2)),Sigma=s)*dt(u[,1],e1)*dt(u[,2],e2)
     return(ff)
  } 
```

对数似然函数：

```
loglik=function(x){
  p11<-x[1];p12<-x[2];p21<-x[3];p22<-x[4];p31<-x[5];p32<-x[6];r<-x[7];a1<-x[8];a2<-x[9];s<-x[10];b1<-x[11];b2<-x[12];t<-x[13];c1<-x[14];c2<-x[15]
  p1=c(numeric(nrow(u)));p2=c(numeric(nrow(u)));p3=c(numeric(nrow(u)))
  g=c(numeric(nrow(u)))
  p1_0=.3
  p2_0=.3
  g[1]<-(p1_0*f(u,r,a1,a2)[1])+(p2_0*f(u,s,b1,b2)[1])+((1-(p1_0+p2_0))*f(u,t,c1,c2)[1])
  p1[1]<-((p1_0*p11*f(u,r,a1,a2)[1])+(p2_0*p21*f(u,r,a1,a2)[1])+((1-(p1_0+p2_0))*p31*f(u,r,a1,a2)[1]))/g[1]
  p2[1]<-((p1_0*p12*f(u,s,b1,b2)[1])+(p2_0*p22*f(u,s,b1,b2)[1])+((1-(p1_0+p2_0))*p32*f(u,s,b1,b2)[1]))/g[1]
  p3[1]<-((p1_0*(1-(p11+p12))*f(u,t,c1,c2)[1])+(p2_0*(1-(p21+p22))*f(u,t,c1,c2)[1])+((1-(p1_0+p2_0))*(1-(p31+p32))*f(u,t,c1,c2)[1]))/g[1]
  for(i in 2:nrow(u)){
    g[i]<-(p1[i-1]*p11*f(u,r,a1,a2)[i])+(p1[i-1]*p12*f(u,s,b1,b2)[i])+(p1[i-1]*(1-(p11+p12))*f(u,t,c1,c2)[i])+
      (p2[i-1]*p21*f(u,r,a1,a2)[i])+(p2[i-1]*p22*f(u,s,b1,b2)[i])+(p2[i-1]*(1-(p21+p22))*f(u,t,c1,c2)[i])+
      (p3[i-1]*p31*f(u,r,a1,a2)[i])+(p3[i-1]*p32*f(u,s,b1,b2)[i])+(p3[i-1]*(1-(p31+p32))*f(u,t,c1,c2)[i])
    p1[i]<-((p1[i-1]*p11*f(u,r,a1,a2)[i])+(p1[i-1]*p12*f(u,s,b1,b2)[i])+(p1[i-1]*(1-(p11+p12))*f(u,t,c1,c2)[i]))/g[i]
    p2[i]<-((p2[i-1]*p21*f(u,r,a1,a2)[i])+(p2[i-1]*p22*f(u,s,b1,b2)[i])+(p2[i-1]*(1-(p21+p22))*f(u,t,c1,c2)[i]))/g[i]
    p3[i]<-((p3[i-1]*p31*f(u,r,a1,a2)[i])+(p3[i-1]*p32*f(u,s,b1,b2)[i])+(p3[i-1]*(1-(p31+p32))*f(u,t,c1,c2)[i]))/g[i]
  }
  return(-sum(log(g)))
} 
```

优化：

```
library(QRM)
library(copula)
start=list(0,1,0,0,0,0,1,9,7,-1,10,13,1,6,4)
##
optim(start,loglik,lower=c(rep(0,6),-1,1,1,-1,1,1,-1,1,1),
  upper=c(rep(1,6),1,Inf,Inf,1,Inf,Inf,1,Inf,Inf),
  method="L-BFGS-B") -> fit 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T15:10:54.913

这看起来像是 Stack-Overflow 的问题。

我脑海中浮现的一件事是：

1.  定义一个包含这些值的向量`f(.,.,.,.)`，以避免`k*nrow(u)`对同一函数进行评估并简单地调用这些感兴趣的条目。

2.  看起来循环可以用矩阵和/或向量产品代替。但是，如果没有进一步的信息，就不清楚代码在做什么，并且需要很长时间才能从代码中提取这些信息。

# java - 解释数组java中的数据

> ID：16019020
> 
> 赞同：1
> 
> 时间：2013-04-15T15:26:02.137
> 
> 标签：java, arraylist, java.util.scanner

我有一个任务要求我获取一个大型数据集，将其存储在一个数组中，然后创建以各种方式解释数据的方法。我得到的文件数据格式如下：

0 138
0 139
0 140
0 141
0 142
0 799
4 1
4 10
4 12
4 18
等...（非常大）这个数据应该代表一个人的社交网络，数字代表个人。每一行都包含一个左边的人，他“信任”了右边的人。我应该解释这些数据，以便我可以找到一个特定的人信任的所有人，有多少人信任一个特定的人，以及如何找到最信任的人。但是，我完全不知道如何编写这些方法，所以我想知道你们是否可以帮助我。这是我到目前为止的代码：

```
public class SocialNetwork {

static Scanner scanner = new Scanner(System.in);
static void findTrusted()
{
    System.out.println("Please input person number you would like to find Trustees for");
    trustee = (scanner.next());
}

public static void main(String[] args){
    File inData = new File("dataset.txt");
    ArrayList<Integer> links = new ArrayList<Integer>();
    try
    {   
        Scanner in = new Scanner(inData);
        in.nextLine();
        in.nextLine();
        in.nextLine();
        in.nextLine();
        while (in.hasNext())
        {
            int trustee = in.nextInt();
            int trusted = in.nextInt();
            links.add(trustee);
            links.add(trusted);

        }
        in.close();
    }

    catch (FileNotFoundException e){
        e.printStackTrace();
    }
}   
} 
```

如您所见，我的 findTrustee 方法几乎没有。我只是不知道从哪里开始。我想出了一些伪代码来尝试剖析需要做的事情：

1.  提示用户输入哪个人（整数）找到他/她的受托人
2.  搜索输入的人（整数）的arraylist链接
3.  在以请求的人开头的行的右侧打印所有人员（整数）

但是，我只是不知道该怎么做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T15:50:30.427

该结构`links`并不能真正帮助您。它没有“从”和“到”的概念。您将 Persons 存储为数字，但不存储两个人之间的任何关系。您确实在研究图论，如果可以的话，您应该查看图论的参考作品和 Java 库。

那么，什么是信任链接？它是一个有两个人的对象，受托人和受托人。为此创建一个类：

```
public class Trust {
    private final int trustee;
    private final int trusted;
    public Trust(final int trustee, final int trusted) {
        this.trustee = trustee;
        this.trusted = trusted;
    }
    // Getters, equals, hashCode, toString, formatted output for humans.
} 
```

让您的班级`SocialNetwork`能够创建这些。顺便说一句，在您的 main 方法中创建一个 SocialNetwork 实例，并停止对其他所有内容使用静态。

```
public Trust createTrust(Scanner scanner) {
    int trustee = scanner.nextInt();
    int trusted = scanner.nextInt();
    return new Trust(trustee, trusted);
} 
```

您可能需要添加异常处理和文件结束处理。

制作`links`一个`Trust`对象列表，然后根据需要编写扫描该列表的方法。

```
/**
    Return a list of all the people who trustee trusts.
    @param trustee A person in the system.
    @return a list of the people trustee trusts.
 */
public List<Integer> trusting(int trustee) {
    final List<Integer> trusted = new ArrayList<>();
    for (Trust link: links) {
        // Add something from link to trusted if it should.
        // This looks like homework; I'm not doing everything for you.
    }
    return trusted;
} 
```

根据需要编写其他方法。然后，想想这些数据结构对这个问题是否有效。可以`Map`更好吗？`MultiMap`来自其他图书馆？某种开源图论库？也许您应该改用数据库。也许你应该有一个`Person`类而不是只使用整数；这样你就可以用他们的名字给人们贴上标签。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T16:00:32.293

我认为有很多方法可以实现这一点（不管性能如何）。例如，您可以使用 HashMap、数组数组（或列表列表，如果您真的喜欢列表...）

我可能会举一个使用列表的例子，因为你似乎在使用它......（虽然我认为这有点奇怪）

比如说，你有一个列表，里面有左边的人。

```
ArrayList<ArrayList> leftList = new ArrayList<ArrayList>(); 
```

对于leftList，循环遍历它直到达到最大值。左列（现在您可能会看到为什么数组/HashMap 更好......）通过执行以下操作：

```
leftList.add(new ArrayList()); 
```

在每个循环中。

那么你现在要做的就是读取文件并将受托者列表插入到与信任者对应的rightList中。例如，我有 1 3、1 4 和 2 3；您的实现将实现以下目标：

```
leftList.get(1).add(3) / leftList.get(1).add(4) / leftList.get(2).add(3) 
```

取决于您正在阅读哪一行。

有了这个设置，我想你可以很容易地解决这三个问题？否则，只需在这里寻找更多建议。但请确保您先考虑清楚！

希望我的回答能给你一些想法。

# asp.net - [SqlException (0x80131904): 用户 'IIS APPPOOL\DefaultAppPool' 登录失败。]

> ID：16019022
> 
> 赞同：1
> 
> 时间：2013-04-15T15:26:05.737
> 
> 标签：asp.net, iis, asp.net-mvc-4, iis-7, connection

将站点部署到 Windows 7，工作正常。现在我对 Windows 2008 R2 (SP1) 执行相同操作，但无法登录。在 Windows 7 下，在 SQL Server 2012 中，我添加了用户 IIS APPPOOL/DefaultAppPool 并将其设为 db_owner。同样的技巧在 Windows 2008 R2（带有 IIS7 和 SQL Server 2012）下不起作用。可能有什么问题？提前感谢您的帮助！

# linux - 在 64 位架构上编译库：与 `l' 后缀一起使用的寄存器 `%rax' 不正确

> ID：16019023
> 
> 赞同：2
> 
> 时间：2013-04-15T15:26:11.610
> 
> 标签：linux, gcc, assembly, x86-64

我必须在 64 位架构上编译一个库，无论如何我都会收到那个错误。受错误影响的代码行在汇编程序中，这是一个示例（它们都非常相似）：

```
//=== get the index to write ===///
__asm__ __volatile__ ("lock; xaddl %0,%1"
            : "=r" (indexToWrite), "=m" (   indexTable[entityId] )
            : "0" (1), "m" ( indexTable[entityId] )); 
```

你能帮我吗？

我在 linux 64bit (ubuntu) 下，我正在使用 gcc。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-16T04:09:36.883

使用`k`操作数修饰符选择 32 位子寄存器：`xaddl %k0,%1`.

语法：`xaddl %k0,%k1`也是无害的，因为`%1`无论如何都是 mem addr 。8、16、32 和 64 位的操作数修饰符分别是`b`, `w`, 。`k``q`

* * *

输入列表中的第二个`"m"`对我来说似乎很可疑。我可能错了，但我认为应该是：

`"1" (indexTable[entityId])`

我`xadd`不认为这很重要，但从技术上讲，`%3`否则这将是争论。就个人而言，我会选择：

```
: "=r" (indexToWrite), "+m" (indexTable[entityId]) : "0" (1) 
```

是的，`"+m"`是完全合法的。它已经存在很长时间了，直到最近才作为gcc*文档中的一个错误被纠正！*

# amazon-web-services - DynamoDB 的 PutItem 是多个区域安全的吗？

> ID：16019028
> 
> 赞同：0
> 
> 时间：2013-04-15T15:26:23.363
> 
> 标签：amazon-web-services, amazon-dynamodb

根据链接 [1]

```
 Amazon DynamoDB has built-in fault tolerance, automatically and synchronously
 replicating your data across three Availability Zones in a Region for high 
 availability and to help protect your data against individual machine, or even
 facility failures. 
```

那么我是否可以假设，在我获得成功写入的结果时，它已经被复制到三个可用区？

[1] [http://aws.amazon.com/dynamodb/](http://aws.amazon.com/dynamodb/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T16:17:32.337

我认为这取决于您如何阅读：

来自[http://aws.amazon.com/dynamodb/faqs/](http://aws.amazon.com/dynamodb/faqs/)

问：Amazon DynamoDB 的一致性模型是什么？从 Amazon DynamoDB 读取数据时，用户可以指定他们希望读取是最终一致还是强一致：

*最终一致性读取*（默认）——**最终一致性选项可最大限度地提高您的读取吞吐量。但是，最终一致的读取可能不会反映最近完成的写入的结果。**所有数据副本的一致性通常在一秒钟内达到。在短时间内重复读取应该返回更新的数据。

*强一致性读取*— 除了最终一致性之外，**Amazon DynamoDB 还为您提供灵活性和控制权，以在您的应用程序或应用程序元素需要时请求强一致性读取。强一致性读取返回的结果反映了在读取之前收到成功响应的所有写入。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T17:40:01.077

`PutItem`是的，如果成功，您可以依靠那里的数据。

> 跨三个可用区自动同步复制您的数据

关键字是*synchronously*，意思是同时。在它接受您的数据的同时，它正在写入所有三个可用区。如果`PutItem`在完成这些写入之前返回，DynamoDB 将不会获得所宣传的一致性和持久性保证。

# mysql - 如何减小 MediaWiki“文本”表的大小

> ID：16019031
> 
> 赞同：3
> 
> 时间：2013-04-15T15:26:35.190
> 
> 标签：mysql, mediawiki

我管理着一个小型的 MediaWiki wiki，它最近受到了很多垃圾邮件的影响。我已经删除了所有垃圾邮件帐户和页面，感谢[如何从 MediaWiki wiki 中永久删除页面？](https://stackoverflow.com/questions/15870930/how-to-permanently-delete-a-page-from-a-mediawiki-wiki/)，我已经能够清除 wiki 数据库中的“存档”表，这样它就不会充满我删除的所有垃圾邮件页面。

不过，相对于 wiki 的实际大小，该数据库仍然很大。“text”表以 2.7GB 运行，“searchindex”表有 302.9MB。减少这些表格（尤其是“文本”表格）大小的最佳方法是什么？如果有必要，我愿意接受导出 wiki 的所有面向公众的部分并将它们导入全新安装的想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-11-03T21:57:16.857

跑吧[`php maintenance/deleteArchivedRevisions.php --delete`](https://www.mediawiki.org/wiki/Special:MyLanguage/Manual:DeleteArchivedRevisions.php)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T15:54:15.020

我通过优化违规表解决了这个问题（至少实际上是这样）。这将其大小减少到 200 到 300 MB 之间。考虑到 wiki 中存在的数据量，这似乎仍然很大，但至少它是可管理的。

# ruby-on-rails - Rails Solr：如何通过模型 id 排除结果

> ID：16019034
> 
> 赞同：0
> 
> 时间：2013-04-15T15:26:46.150
> 
> 标签：ruby-on-rails, solr

我正在尝试使用 Solr 排除具有特定 ID 的结果。我所做的是在可搜索的“整数 id”中定义，然后在 Model.search 中使用“没有”我做“没有：id，id”

这是我的代码示例：

```
 searchable do
    text(:title, boost: 2.0) { t.title }
    text(:intro) { t.intro }
    text(:detail) { t.detail }

    text(:subjects) { tags.select{ |t| t.name[0,1] == "@" }.map{ |t| t.name }.join( ' ' ) }
    text(:context) { tags.select{ |t| t.name[0,1] == "#" }.map{ |t| t.name }.join( ' ' ) }
    text(:genres) { tags.select{ |t| t.name[0,1] == "_" }.map{ |t| t.name }.join( ' ' ) }

    string :status
    integer :id
    boolean(:has_times) { (dates.reject { |d| d.times.blank? }).any? }
    time(:start_date, multiple: true) { dates.map{ |d| d.start_date } }
    time(:end_date, multiple: true) { (dates.map { |d| d.end_date }).compact }

    boolean :featured
    boolean :top
  end

def Event::tags_search query, event_id = nil, page=1, per_page=3
    search = Event.search(include: [:texts, :dates => :times]) do
      fulltext query do
        minimum_match 1
        boost_fields subjects: 4.0
        boost_fields context: 2.0
        boost_fields genres: 1.5
      end

      without :id, event_id

      # visibility constraints
      with :status, 'published'
      with :has_times, true

      # Combine restrictions (start_date OR ( end_date && !end_date.nil? ) )
      any_of do
        with(:start_date).greater_than_or_equal_to Time.now.to_s :db
        all_of do
          without :end_date, nil
          with(:end_date).greater_than_or_equal_to Time.now.to_s :db
        end
      end

      paginate page: page, per_page: per_page
    end
    search.results
  end 
```

有办法使这项工作吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T16:09:49.813

奇怪，`without`应该可以...与数组一起使用：

```
search = Post.search do
  ...
  without(:id, [post_id])
  paginate page: page, per_page: per_page
end 
```

# ads - AdSense 和 Ad Exchange 的区别

> ID：16019037
> 
> 赞同：1
> 
> 时间：2013-04-15T15:26:51.987
> 
> 标签：ads

AdSense 和 Ad Exchange 有什么区别？据我所知，Ad Exchange 就像一张广告商网络。我可以使用我的 AdSense 帐户显示来自 Ad Exchange 平台的广告吗？

干杯。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T15:41:45.323

简而言之，Google Adsense 是为编辑服务的，因为 Google Ad Exchange 是为广告商服务的。

Google Adsense 是由 Google 提供的一个供网络编辑器使用的包含广告的平台。编辑仅因包含此内容而获得一些收入。

Google 在这些广告上显示的内容来自 Google AdWords，这是另一个建立规则以制作符合条件的广告的平台。

Google Ad Exchange 是一个动态市场，面向希望在整个网络上发布广告的广告商。他们根据 Google AdWords 规则制作广告，他们为影响力付费，因此他们的广告通过 Google Adsense 网络自动推广。

因此，如果您是网站上的 Google AdSense 广告编辑，请回答您的最后一个问题；您已经在展示 Google Ad Exchange 广告。

# map - 使用 incanter $map 一些说明

> ID：16019039
> 
> 赞同：1
> 
> 时间：2013-04-15T15:26:59.027
> 
> 标签：map, clojure, incanter

假设一个包含 k 列整数的 incanter 数据集 freqs。我想通过将每列值除以固定值（例如 20）将 2 列转换为 0 到 1 之间的值。我可以使用 1 列的 $map 函数来执行此操作： ($map (fn [x] ( / x 20)) :fq1 频率)。$map 上的 incanter 文档似乎建议可以使用列向量：“...将给定函数映射到给定列键的值 ...”。但是，我这样做的尝试 ($map (fn [x] (/ x 20)) [:fq1 :fq2] freqs ) 给出了“错误数量的 args”区域。我理解这个错误。希望有人可以肯定地说，列键向量的使用是否可以与 $map 一起使用；如果是的话，一个例子将是一个很大的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T16:31:29.313

[$map](http://liebke.github.io/incanter/core-api.html#incanter.core/%24map)的 incanter 文档显示您可以将列向量传递给 $map，因此您的代码变为：

```
($map (fn [f1 f2] (do-something-with f1 f2) [:fq1 :fq2] freqs) 
```

注意：当您映射 2 列时，该函数应采用 2 个参数，而且参数数量错误不是因为您调用 $map 的方式，而是您传递的函数只采用一个参数。

# c# - 没有在后面的代码中获取控制 ID

> ID：16019044
> 
> 赞同：0
> 
> 时间：2013-04-15T15:27:14.317
> 
> 标签：c#, visual-studio-2010, webforms

我有一个使用母版页创建的基本 Web 表单（Default.aspx），奇怪的是我无法访问后面代码中的控件 ID。

```
<ul id="topicsList" runat="server">
                                <asp:Label ID="labUserName" runat="server"/>
                            </ul>

IDomainObjectRepository rep;
protected void Page_Load(object sender, EventArgs e)
{
    rep = new DomainObjectRepository();
    rep.GetDomainObjectsByType("Visuals Product Label");
    /*labUserName not picked up by intellisense*/

} 
```

关于为什么会出现这种情况的任何指示

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T15:33:34.397

问题可能是由于您的代码前面没有被后面的代码引用，反之亦然。确保你有以下内容（仔细检查 CodeBehind 和 code-behind 类结合起来）：

```
public class _Default : Page
{
   // Your load event
}

<%@ Page Title="" Language="C#" AutoEventWireup="true" CodeBehind="Default.aspx.cs" Inherits="_Default" %> 
```

# php - 如何使用 php 将外部 javascript 返回的值写入文件？

> ID：16019045
> 
> 赞同：0
> 
> 时间：2013-04-15T15:27:16.693
> 
> 标签：php, javascript, file

我有一个带有按钮的表，onClick 调用外部 javascript 文件，该文件计算一些值并将它们返回到表中。然后我需要在不离开当前页面的情况下使用 PHP 将该值写回文件。有没有办法做到这一点？我想过尝试 onChange，但我不确定如何使用 php 来实现它，因为它通常是一个 javascript 调用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T16:30:51.133

这听起来像是您可以使用[AJAX](https://en.wikipedia.org/wiki/Ajax_%28programming%29)解决的问题。基本上，您将在后台与您的服务器通信，将数据发送给它以便它可以处理它。您在后台发送一个单独的请求，而无需重新加载页面。

请注意客户端（运行 JavaScript 的地方）和服务器（PHP 生成客户端运行的页面的地方）之间的区别。

如果您想使用[jQuery](http://jquery.com/)，该库[有一些不错的功能](http://api.jquery.com/jQuery.ajax/)，可以更轻松地实现跨浏览器 AJAX 请求。但是，我建议首先研究该主题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T15:30:27.370

PHP 在您的服务器上执行，即使是外部的 javascript 文件也在客户端计算机上运行。

您不能在客户端机器上使用 PHP！您必须使用 javascript 来调用存储在您的服务器中的 php 脚本，该脚本可以执行您需要的操作。

你在好的轨道上，你需要在你的 javascript 中使用 AJAX 调用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T15:31:15.433

1.  不要使用`onclick`，搜索不显眼的 javascript；

2.  您将使用 jQuery，因此您可以使用它的[`ajax`处理程序](http://api.jquery.com/jQuery.ajax/)；

3.  在开始编写代码之前，请先阅读有关整个主题的好书。

# css - 目标选择器不起作用

> ID：16019047
> 
> 赞同：2
> 
> 时间：2013-04-15T15:27:25.223
> 
> 标签：css, angularjs

我不知道问题是否与 Angular 有关，或者我犯了一个错误。
我有一个`<article id="about">`, 链接`<a href="#about">`，我正在尝试使用

```
:target{
    border: solid 1px red;
} 
```

当我单击链接时，文章应该有一个红色边框，不是吗？当我单击链接时，URL off course 更改`/company`为`/company#about`但没有任何反应，我还使用 JQuery 在控制台中进行了检查，`$(':target')`它返回`null`.
我认为这可能与 Angular 相关，其中路由机制会干扰某些默认行为。我正在使用`$locationProvider.html5Mode(true)`Angular 1.1.4 和 Chrome26。
**编辑：**最后在[这里](http://jsfiddle.net/VCAVf/)得到了一个不工作的例子，它工作直到我注入 $location in `app.run()`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T16:00:59.757

只是猜测，但是：

我认为点击事件可能会返回“false”。也就是说，一些代码运行，默认的链接点击行为被覆盖。

尝试在一个空选项卡中输入页面 url，最后带有哈希。如果你的 :target css 在这种情况下工作，你就会知道这是一个 javascript 的东西。

也许框架添加了一个类或其他标识符，您可以轻松地设置它们的样式？或者，如果您检查 DOM，对它的引用存储在某个对象中，您可以使用 jQuery 对其进行样式设置？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-21T23:46:02.927

这是由于浏览器错误：[https ://bugs.webkit.org/show_bug.cgi?id=83490](https://bugs.webkit.org/show_bug.cgi?id=83490)

[另请参阅http://css-tricks.com/on-target/](http://css-tricks.com/on-target/)的最后一部分

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-03-20T18:43:17.483

如果您将 target="_self" 放在 a 标签中，只要启用 HTML5 模式，它将解决角度路由的问题。

# jquery - jQuery：hide() 和 show() 的问题

> ID：16019050
> 
> 赞同：1
> 
> 时间：2013-04-15T15:27:45.667
> 
> 标签：jquery, function

我使用 jQuery 开发了一个函数，它隐藏和显示图像，让 a`<div>`中的一些内容显示出来。问题是，即使我成功地隐藏了图像，然后更改了与按钮关联的类以便能够调用该`show()`函数，图像也不会重新出现。这是我到目前为止编写的代码（不起作用）：

```
$('.viewVideo').click(function(){
    var wood = $(this).attr('id');
    var current = '.' + wood + 'Image';
    console.log(current);
    $(current).hide();
    $('.viewVideo').removeClass('viewVideo').addClass('viewPhoto');
});

$('.viewPhoto').click(function(){
    var wood = $(this).attr('id');
    var current = '.' + wood + 'Image';
    $(current).show();
    console.log(current);
    $(current).show();
    $('.viewPhoto').removeClass('viewPhoto').addClass('viewVideo');
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T15:33:02.380

您将需要使用该`on()`事件，而不是尝试将`click()`事件绑定到您的`.viewPhoto`类。

> .on() 方法将事件处理程序附加到 jQuery 对象中当前选定的元素集。

将您的代码更改为；

```
$(document).on('click', '.viewPhoto', function(){
    var wood = $(this).attr('id');
    var current = '.' + wood + 'Image';
    $(current).show();
    console.log(current);
    $(current).show();
    $('.viewPhoto').removeClass('viewPhoto').addClass('viewVideo');
}); 
```

这是因为当您尝试将 click 事件绑定到`.viewPhoto`它时，它不存在，因为它是动态添加/创建的。但是，您可以将它绑定到您的文档，**甚至更好地绑定到 DOM 层次结构中的第一个非动态元素**。

所以它会是`$([your-first-non-dynamic-element]).on(....)`

我会花一些时间在这里[http://api.jquery.com/on/](http://api.jquery.com/on/)`on()`阅读更多关于该事件的信息

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T15:32:02.327

您希望将`on`触发器与动态变化的元素一起使用（在本例中是您的类）。

```
$('.parent_element').on('change','.viewPhoto', function(){
    // do something
}); 
```

在此处阅读有关此内容的更多信息：http: [//api.jquery.com/on/](http://api.jquery.com/on/) 它为我节省了很多头痛！

# android - Eclipse 内容辅助缺少 Android API 工具建议

> ID：16019051
> 
> 赞同：1
> 
> 时间：2013-04-15T15:27:46.127
> 
> 标签：android, eclipse, adt, code-assist

我更新了我的 Eclipse 以获得具有最新 Android ADT 的更新版本。我决定通过对谷歌提供的整个软件包进行“简单”安装来更新它。软件包版本是 adt-bundle-mac-x86_64-20130219。现在，我仍然有 java 的代码辅助，但没有 Android API。我花了很长时间搜索谷歌和 Stackoverflow，但都没有解决问题。当我转到菜单 ADT> Preference> JAVA> Editor> Content Assist> Advanced 时，我看到选项中缺少“API Tools Proposals”选项。我相信这就是为什么我对常规的 JAVA 东西有代码辅助，但对 Android API 却没有。我尝试创建一个新工作区并将项目导入其中。我确保 Android 库在编译路径中。

我尝试了在“eclipse.ini”文件中添加“-clean”的技巧。我没有多年的 Android 编程经验，所以 Anbdroid API 的代码辅助对我来说非常重要。任何想法如何把它带回来？

# ruby - 登录Redis（Puts应该去redis）

> ID：16019053
> 
> 赞同：0
> 
> 时间：2013-04-15T15:27:52.613
> 
> 标签：ruby, logging, resque

我想要一个功能来记录我的所有“放置”以同时进入 redis 到 STDOUT。

```
class Job
  def self.perform
    puts "Abc"
  end
end 
```

然后我期待redis中有一个键值对。如果作业 ID 为 1

```
 Resque.redis.get("log_1")  #=> "Abc" 
```

我需要这个是因为，以便另一台远程机器可以读取此日志。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T21:56:14.103

> 我需要这个是因为，以便另一台远程机器可以读取此日志。

您应该尝试使用“真正的”日志记录解决方案，例如 Graylog2。

另外，不要`puts`用于记录，使用 Resque.logger：[https ://github.com/resque/resque/blob/1-x-stable/lib/resque.rb#L473-L475](https://github.com/resque/resque/blob/1-x-stable/lib/resque.rb#L473-L475)

# java - 从模拟器内部正确安装 Android 应用程序

> ID：16019055
> 
> 赞同：0
> 
> 时间：2013-04-15T15:28:11.860
> 
> 标签：java, android, sdk, android-emulator

我最近下载了 Android SDK（Linux，64 位版本），并创建了一个新的 AVD。然后我从命令行启动了模拟器，看着我的设备开始活跃起来。然后我创建了一个 Gmail 帐户，并尝试从我的模拟器中安装一个随机（WebMD）免费应用程序：

![在此处输入图像描述](https://i.stack.imgur.com/kEnON.png)

此弹出窗口阻止我安装该应用程序。我没有看到它所说的“白色购物袋”图标。关于我必须做些什么才能让应用程序正确安装的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T15:35:09.260

我相信弹出窗口表明您应该使用 Play 商店应用程序，而不是尝试从浏览器下载。Play 商店应用启动图标是带有蓝绿色箭头的购物。

# c# - Starcounter - 何时在 JSON 绑定中使用完整路径命名空间

> ID：16019057
> 
> 赞同：0
> 
> 时间：2013-04-15T15:28:13.947
> 
> 标签：c#, .net, json, database, starcounter

在下面的示例中，我收到一条警告，提示找不到 Item 类。Batch 类很好，即使它位于同一个命名空间中。

批处理是否因为它附加在后面的代码中（QueueModel：Json）而起作用？

这是设计使然还是应该更加一致？

```
{
   $:{DataType:"Batch"},
   BatchID:123456778,
   Name:"BatchName",
   Items: [
     {
       Message:"Hello my friend!"
     }
   ],
   $Items:{DataType:"MyCompany.Concepts.Item"}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T15:40:23.733

如果数据库类与派生类位于相同的命名空间中`Json`，那么您只需指定类名。如果类（部分类）后面有代码，则无需`DataType`在 json-by-example 文件中指定属性。

所以它需要在 .json 文件或类后面的（可选）代码中提供。

### 人-viewmodel.json：

```
{
   "FirstName":"Albert",
   "LastName":"Einstein",
   "Phonenumbers": [
      {
         "Type":"mobile"
         "Number":"1234"
      }
   ],
   "$Phonenumbers":{"DataType":"MyDatabaseNamespace.Phonenumber"}
} 
```

### 人-viewmodel.json.cs：

```
public class PersonViewModel : Json<Person> {
} 
```

因此，如果您只使用 json-by-example 文件（没有后面的代码），则需要提供绑定的数据库类型：

### 人消息.json：

```
{
   "$":{"DataType":"MyDatabaseNamespace.Person"},
   "FirstName":"Albert",
   "LastName":"Einstein",
   "Phonenumbers": [
      {
         "Type":"mobile"
         "Number":"1234"
      }
   ],
   "$Phonenumbers":{"DataType":"MyDatabaseNamespace.Phonenumber"}
} 
```

# facebook - facebook4j 从我的 facebook 帖子中检索不同的图像大小

> ID：16019059
> 
> 赞同：0
> 
> 时间：2013-04-15T15:28:17.567
> 
> 标签：facebook, facebook-java-api

我正在使用 facebook4j 加载主页帖子`facebook.getHome()`，我正在获取个人资料图片和帖子图片，如下所示：

```
facebook4j.User fromUser = facebook.getUser(fbHomePost.getFrom().getId(), 
new Reading().fields("picture"));
if (fromUser.getPicture() != null)                      
  facebookUserPostDto.setProfileImage(fromUser.getPicture().getURL().toURI().toString());
if (fbHomePost.getPicture() != null)
  facebookUserPostDto.setImageLocation(fbHomePost.getPicture().toURI().toString()); 
```

一切运行良好，但我从 URL 获得的图像很小且分辨率低。知道如何使用 facebook4j API 从 facebook 获取“大”图像吗？facebook 可以提供不同的图片尺寸[API 参考 › Graph API › 图片](https://developers.facebook.com/docs/reference/api/using-pictures/)

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T09:13:40.237

好的，我从 facebook4j 谷歌小组收到了关于如何 [从我的 facebook 帖子中检索不同图像大小的回复](https://groups.google.com/forum/?hl=en&fromgroups=#!topic/facebook4j/XwOijtguSGs)

萨米哈弗什

[布雷特](http://www.brate.com)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-06T00:36:30.543

好的，首先您必须将**user_photos**添加到您的范围并确保您使用的是有效的访问令牌而**不是 Graph API Explorer 令牌**

```
OAuthService service = new ServiceBuilder()
                                      .provider(FacebookApi.class)
                                      .apiKey(apiKey)
                                      .apiSecret(apiSecret)
                                      .callback("xxxx")
                                      .scope("publish_actions,user_photos ")
                                      .build(); 
```

然后试试这个：（经过测试）

```
for(Post p : feed){
        System.out.println("********************");
        String type = p.getType();
        System.out.println("type :"+type);
        String idPicVid = p.getObjectId();
        if(type.matches("photo")){
           System.out.println("idPicVid "+idPicVid);
                try{
                    Photo pic = facebook.getPhoto(idPicVid);
                    System.out.println(pic.toString());
                    System.out.println("source "+pic.getSource());
                    System.out.println("picture "+pic.getPicture());
                }catch (Exception e) {
                    e.printStackTrace();
                }
        }
} 
```

# r - read.csv.ffdf 使用 ff 和 ffbase 包卡在 R 中

> ID：16019063
> 
> 赞同：0
> 
> 时间：2013-04-15T15:28:34.173
> 
> 标签：r

我从 ff 或 ffbase 包中运行 read.csv.ffdf。但它被以下消息卡住了

```
read.table.ffdf 1..1000 (1000)  csv-read=0.15sec ffdf-write=1.24sec
read.table.ffdf 1001..63015 (62015)  csv-read=9.89sec ffdf-write=8.84sec
read.table.ffdf 63016..125030 (62015)  csv-read=8.18sec ffdf-write=6.74sec
read.table.ffdf 125031..187045 (62015)  csv-read=8.15sec ffdf-write=6.72sec
read.table.ffdf 187046..249060 (62015)  csv-read=8.19sec ffdf-write=6.72sec
read.table.ffdf 249061..311075 (62015)  csv-read=8.05sec ffdf-write=7.13sec
read.table.ffdf 311076..373090 (62015)  csv-read=8.26sec ffdf-write=6.73sec
read.table.ffdf 373091..435105 (62015)  csv-read=8.26sec ffdf-write=6.8sec 
```

这些文件包含大约 800000 行，但为什么它会停在这里，从那时起我不能运行任何东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T16:20:16.267

您是否使用 read.csv.ffdf 的 transFUN 参数？如果是，请确保您从 transFUN 返回的行数与进入 transFUN 的 data.frame 的行数相同。

说明：当块返回的记录少于 next.rows 参数时，read.csv.ffdf 的导入停止，因此如果您在 transFUN 中进行子集化，它将停止。transFUN 用于添加派生字段或清理数据，而不是子集。

# sql - 更新表的多行，在特定列中具有特定值等于从其他两个表计算的值

> ID：16019064
> 
> 赞同：1
> 
> 时间：2013-04-15T15:28:37.537
> 
> 标签：sql, sql-server, tsql, sql-server-2005, sql-update

我有三张桌子。我想更新具有列的**TableC行**`Price=0`

**表 A**

```
StoreId rate
1       100   
2       200 
```

**表B**

```
ProductId StoreId
11           1
22           2
30           1
40           1
67           2 
```

**表C**

```
ProductID Quantity Price
11           20     0
22           30     6000
30           100    0 
40           200    0
67           370    0 
```

我想通过将 Quantity （从 Table C 获得）乘以由 TableB 链接的 Rate （从 TableA 获得）来更新 Price=0 的 TableC 行

现在，如果我必须更新 TableC 的单行，我的困惑是下面的方法将起作用

```
declare @rate int,declare @qty int

select @rate =rate , @qty=quantity
from tableA a
inner join tableB b
   on a.storeId=b.storeId
inner join tableC c
   on b.productId=c,productId
--where c.productId=somevalue --one row returned
-- where c.Price=0  -- returns multiple row -- update wont work 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T15:31:32.280

`TableC`您可以通过加入`TableB`并`TableC`在其上直接更新。

```
UPDATE  c
SET     c.Price = c.Quantity * a.Rate
FROM    TableC c
        INNER JOIN TableB b
            ON c.ProductID = b.ProductID
        INNER JOIN TableA a
            ON b.StoreID = a.StoreID
WHERE   c.Price = 0 
```

*   [SQLFiddle 演示](http://www.sqlfiddle.com/#!3/4ec91/1)

# python - 使用芹菜时控制rabbitMQ中的队列大小

> ID：16019065
> 
> 赞同：1
> 
> 时间：2013-04-15T15:28:38.300
> 
> 标签：python, rabbitmq, celery

我可以通过以下方式查看 celery 中的保留任务队列：

```
from celery.task.control import inspect
len(inspect().reserved().values()[0]) 
```

但是，即使我向 celery 发送了 600 个作业，这个队列似乎也很小（大约 8-10 个）。

在 shell 中，我可以看到有 520 个工作等待进入 celery 中的工人保留队列

```
>> sudo rabbitmqctl list_queues
Listing queues ...
ae20060e09ee49e3bf534141bb0ef921    1
63f1c530ce114f00b9d0ab595eb65c55    1
382e86abce8449e48b0b168fbcf4aebc    1
celeryev.68becb00-9f8f-4252-ab3a-2cd5c12890f6   0
celery  520
0988376d422a4e338bf2d32037c996fc    1
c401d93d38944caa967a147540c4a738    1
d1a78e47d28941749f65282652d973ff    1
ip-10-196-155-73.celery.pidbox  0
84b4d109f44c4e8ba5b549399cc53b30    1
5780425d-d2c7-3036-8be1-4298a51250ff.reply.celery.pidbox    0
8d0c1cd14ebb4fa2b25b565d409580dd    1
a44f22cf759c4e7dbb6fccd673ce1b62    1
77c17e95689740b68d9ca84b3065a2ce    1 
```

但是，我希望能够从 python 中知道队列当前（520）和最大容量。

或者，一旦我填满队列，rabbitMQ 会阻塞吗？如果是这样，我如何找出最大容量，以及如何更改它？

另外，我怎么知道队列中还有多少任务？

# python - Python 多处理性能

> ID：16019066
> 
> 赞同：11
> 
> 时间：2013-04-15T15:28:39.473
> 
> 标签：python, performance, multiprocessing

这应该是我的第三个也是最后一个问题，关于我尝试提高我使用 python 进行的一些统计分析的性能。我的代码有 2 个版本（单核与多处理），我希望通过使用多核来获得性能，因为我希望我的代码可以解压缩/解压缩很多二进制字符串，遗憾的是我注意到性能实际上是通过使用多个核心。

我想知道是否有人对我观察到的情况有可能的解释（**向下滚动到 4 月 16 日更新以获取更多信息**）？

程序的关键部分是函数 numpy_array （+ 多处理中的解码），下面的代码片段（可通过 pastebin 访问的完整代码，进一步如下）：

```
def numpy_array(data, peaks):
    rt_counter=0
    for x in peaks:
        if rt_counter %(len(peaks)/20) == 0:
            update_progress()
        peak_counter=0
        data_buff=base64.b64decode(x)
        buff_size=len(data_buff)/4
        unpack_format=">%dL" % buff_size
        index=0
        for y in struct.unpack(unpack_format,data_buff):
            buff1=struct.pack("I",y)
            buff2=struct.unpack("f",buff1)[0]
            if (index % 2 == 0):
                data[rt_counter][1][peak_counter][0]=float(buff2)
            else:
                data[rt_counter][1][peak_counter][1]=float(buff2)
                peak_counter+=1
            index+=1
        rt_counter+=1 
```

多处理版本通过一组函数执行此操作，我将在下面显示关键 2：

```
def tonumpyarray(mp_arr):
    return np.frombuffer(mp_arr.get_obj())

def numpy_array(shared_arr,peaks):
    processors=mp.cpu_count()
    with contextlib.closing(mp.Pool(processes=processors,
                                    initializer=pool_init,
                                    initargs=(shared_arr, ))) as pool:
        chunk_size=int(len(peaks)/processors)
        map_parameters=[]
        for i in range(processors):
            counter = i*chunk_size
            chunk=peaks[i*chunk_size:(i+1)*chunk_size]
            map_parameters.append((chunk, counter))
        pool.map(decode,map_parameters)

def decode ((chunk, counter)):
    data=tonumpyarray(shared_arr).view(
        [('f0','<f4'), ('f1','<f4',(250000,2))])
    for x in chunk:
        peak_counter=0
        data_buff=base64.b64decode(x)
        buff_size=len(data_buff)/4
        unpack_format=">%dL" % buff_size
        index=0
        for y in struct.unpack(unpack_format,data_buff):
            buff1=struct.pack("I",y)
            buff2=struct.unpack("f",buff1)[0]
            #with shared_arr.get_lock():
            if (index % 2 == 0):
                data[counter][1][peak_counter][0]=float(buff2)
            else:
                data[counter][1][peak_counter][1]=float(buff2)
                peak_counter+=1
            index+=1
        counter+=1 
```

可以通过这些 pastebin 链接访问完整的程序代码

[Pastebin 单核版本](http://pastebin.com/tSqc7Ntj)

[用于多处理版本的 Pastebin](http://pastebin.com/FWD2SMWm)

我使用包含 239 个时间点和每个时间点约 180k 测量对的文件观察到的性能对于单核约为 2.5m，对于多处理约为 3.5。

**PS**：前两个问题（我第一次尝试并行化）：

1.  [Python 多处理](https://stackoverflow.com/q/15966157/1093485)
2.  [让我的 NumPy 数组跨进程共享](https://stackoverflow.com/q/15976937/1093485)

**——4月16日——**

我一直在使用 cProfile 库对我的程序进行分析（`cProfile.run('main()')` 在 中`__main__`，这表明有一个步骤会减慢一切：

```
ncalls  tottime  percall  cumtime  percall filename:lineno(function)
23   85.859    3.733   85.859    3.733 {method 'acquire' of 'thread.lock' objects} 
```

我在这里不明白的是`thread.lock`对象用于`threading`（据我了解）但不应该用于多处理，因为每个核心都应该运行一个线程（除了拥有自己的锁定机制），那么这是怎么发生的为什么一次通话需要 3.7 秒？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T01:41:58.170

共享数据是由于同步而导致速度下降的已知情况。

您可以在进程之间拆分数据，或者给每个进程一个独立的副本吗？然后，您的流程将不需要同步任何内容，直到所有计算完成为止。

然后我会让主进程将所有工作处理器的输出连接到一个连贯的集合中。

这种方法可能需要额外的 RAM，但现在 RAM 很便宜。

如果你问，我也对每个线程锁获取 3700 毫秒感到困惑。OTOH 分析可能会误认为这样的特殊调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-01T03:58:17.603

至于您问题的最后一部分，Python 文档基本上说 multiprocessing.lock 是 threading.lock 的克隆。Acquire 对锁的调用可能需要很长时间，因为如果锁已经被获取，它将阻塞直到锁被释放。当多个进程竞争访问相同的数据时，这可能会成为一个问题，就像在您的代码中一样。因为我无法查看您的 pastebin，我只能猜测到底发生了什么，但很可能，您的进程正在长时间获取锁，这会阻止其他进程运行，即使有很多空闲 CPU 时间。这不应该受到 GIL 的影响，因为它应该只限制多线程应用程序，而不是多处理应用程序。所以，如何解决这个问题？我的猜测是，您有某种锁来保护您的共享数组，该数组在进程执行需要相对较长时间的密集计算时保持锁定，因此禁止访问其他进程，这些进程随后会阻塞其 lock.acquire()来电。假设您有足够的 RAM，我强烈支持建议在每个进程的地址空间中存储数组的多个副本的答案。但是，请注意，通过 map 传递大型数据结构可能会导致意想不到的瓶颈，因为它需要挑选和去酸洗。我强烈支持建议在每个进程的地址空间中存储数组的多个副本的答案。但是，请注意，通过 map 传递大型数据结构可能会导致意想不到的瓶颈，因为它需要挑选和去酸洗。我强烈支持建议在每个进程的地址空间中存储数组的多个副本的答案。但是，请注意，通过 map 传递大型数据结构可能会导致意想不到的瓶颈，因为它需要挑选和去酸洗。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-15T13:16:58.410

您的 Pastebin 是空的。

问题是多处理使用 fork 如果它可用（而不是产生一个新的 python 进程）。分叉的进程共享相同的环境（例如文件描述符）。可能其中有一些锁。

这是一些令人沮丧的事情：[多处理或os.fork，os.exec？](https://stackoverflow.com/questions/14701901/multiprocessing-or-os-fork-os-exec)

# c# - 数据列表控件不绑定

> ID：16019067
> 
> 赞同：0
> 
> 时间：2013-04-15T15:28:41.403
> 
> 标签：c#, asp.net, sql-server-2008-r2

我必须根据`datalist control`以 find frined 形式插入的值绑定。这是我的代码：

```
protected void search_Click(object sender, EventArgs e)
    {
SqlConnection cn = new SqlConnection(@"Data Source=.\SQLEXPRESS;AttachDbFilename=C:\Users\Mahi\Documents\Visual Studio 2010\Projects\fc 6-4\fc\App_Data\fc.mdf;Integrated Security=True;User Instance=True");

        cn.Open();

        string str = "select unm='" + funm_txt.Text  + "' , university='" + DDLuni.SelectedItem + "', city='"+ DDLcity .SelectedItem +"' , yjoin='" + DDLyjoin.SelectedValue + "' ,yleave= '" + DDLycom.SelectedValue + "', ybatch='" + DDLbtch.SelectedValue + "' from profile";

        SqlCommand cmd = new SqlCommand(str, cn);
        cmd.ExecuteNonQuery();
        SqlDataAdapter da = new SqlDataAdapter(str, cn);
        DataTable dt = new DataTable();

        DataList1 .DataSource =dt;
        DataList1.DataBind();
        cn.Close();

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T16:02:05.933

我注意到的几件事：

-首先，您非常高兴`vulnerable to sql-injection attacks`，因为您将用户输入的值直接传递到数据库中。你可以`avoid this by using a parameterised query`。

-其次，您需要过滤`WHERE`子句中的记录。目前，您正在将用户键入/选择的值分配到选择查询中。

- 你需要使用`SelectedValue`下拉列表而不是`SelectedItem`

- 你也可以使用`using()`积木到`SqlConnection and DataAdapter Disposed`最后。

试试这个（请根据需要替换 col1、col2 并完成分配所有参数的查询）：

```
DataTable dt = new DataTable();
using (SqlConnection cnn = new SqlConnection("your_conn_string"))
{
   string str = "Select Col1, Col2,... From profile " +
                "Where unm = @unm and university= @uni and " +
                "..." +
                "ybatch = @ybatch";

   SqlCommand cmd = new SqlCommand(str, cnn);
   cmd.Parameters.AddWithValue("@unm",funm_txt.Text);
   cmd.Parameters.AddWithValue("@uni",DDLuni.SelectedValue);
   ...
   cmd.Parameters.AddWithValue("@ybatch",DDLbtch.SelectedValue);

   using (SqlDataAdapter adapter = new SqlDataAdapter())
   {
     adapter.SelectCommand = cmd;

     cnn.Open();
     adapter.Fill(dt);
   }
}

DataList1.DataSource =dt;
DataList1.DataBind(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T15:32:48.157

试试这个，

```
 cn.Open();

    string str = "select unm='" + funm_txt.Text  + "' , university='" + DDLuni.SelectedItem + "', city='"+ DDLcity .SelectedItem +"' , yjoin='" + DDLyjoin.SelectedValue + "' ,yleave= '" + DDLycom.SelectedValue + "', ybatch='" + DDLbtch.SelectedValue + "' from profile";

    SqlDataAdapter da = new SqlDataAdapter(str, cn);
    DataTable dt = new DataTable();
    da.fill(dt);
    DataList1 .DataSource =dt;
    DataList1.DataBind();
    cn.Close(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T15:34:45.493

添加以下代码：

你`SqlDataAdapter`和`SqlCommand`没有交流。

你还没有填写`Datatable`结果。

```
da.SelectCommand = cmd;
da.fill(dt); 
```

# javascript - 调用cordova.exec时JqueryMobile动画不循环

> ID：16019073
> 
> 赞同：1
> 
> 时间：2013-04-15T15:28:59.290
> 
> 标签：javascript, jquery, cordova, jquery-mobile

所以我有一个按钮，当单击它时或多或少地像这样调用cordova：

```
$(document).delegate("#update", "tap", A);

function A() {
  $.mobile.loading('show', {
        text: "Please Wait...",
        textVisible: true,
        theme: "a"
    });
setTimeout(function () {B();}, 100);
}

function B () {
cordova.exec(function(success) {  
        $.mobile.loading('hide');
    }, 
    function(error) {
        $.mobile.loading('hide');
    }, 
    "MyPlugin",
    "MyAction",    [""]);
} 
```

当我单击该按钮时，它会加载 jQueryMobile 动画，但是当调用 cordova 时，动画会停止循环并给人一种应用程序崩溃的感觉。我在任何地方都看到它说对插件的调用是异步的，但它看起来不像那样。

谢谢你的帮助。

# c# - 如何在 DateTime 类型的属性中将空白设置为默认值？

> ID：16019074
> 
> 赞同：-1
> 
> 时间：2013-04-15T15:29:00.340
> 
> 标签：c#

我创建了一个 DateTime 类型的属性。当我在 InvokePropertyChanged() 事件的标签中设置此属性值时，它显示默认值 (1/1/0001 12:00:00)。如果属性没有有效日期，如何设置空白文本？

```
public event PropertyChangedEventHandler PropertyChanged;
private DateTime? _dDateTime = null;

public DateTime PostedDateTime
{
    get
    {
        return _dDateTime.HasValue ? _dDateTime.Value : DateTime.Now;
    }
    set
    {
        _dDateTime = value;
        InvokePropertyChanged(new PropertyChangedEventArgs("PostedDateTime"));
    }
}

public void InvokePropertyChanged(PropertyChangedEventArgs e)
{
    PropertyChangedEventHandler handler = PropertyChanged;
    if (handler != null)
    {
        handler(this, e);
        Refresh();
    }

    if (e.PropertyName.Equals("PostedDateTime"))
      lblDateTimeDt.Text = PostedDateTime.ToString();// setting datetime in label

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T15:42:05.207

您可以在 assgin 之前测试该值

```
public void InvokePropertyChanged(PropertyChangedEventArgs e)
{
    PropertyChangedEventHandler handler = PropertyChanged;
    if (handler != null)
    {
       handler(this, e);
       Refresh();
    }

    if (e.PropertyName.Equals("PostedDateTime"))
    lblDateTimeDt.Text = PostedDateTime == DateTime.MinValue ? "" : PostedDateTime.ToString(); 
```

}

# macos - Mac OS X 安全删除证书 -c 的示例 ?

> ID：16019076
> 
> 赞同：5
> 
> 时间：2013-04-15T15:29:06.530
> 
> 标签：macos, security, certificate

**简短版：请提供一个例子`security delete-certificate -c <name>`**......（我试过了`security delete-certificate -c "Foo Certification Authority"`，我试过通配符。）

长版：

我正在尝试做的事情：替换或覆盖现有证书。

有人可以提供一个使用`security`获取证书“名称”然后使用`security delete-certificate -c <name>`删除它的示例吗？我已经尝试了一些东西，`<name>`但还没有能够给它提供与我要删除的证书相匹配的东西。

或者，如果我使用`security add-trusted-cert -d -r trustRoot -k <keychain> <certificate>`它会简单地覆盖任何现有的同名证书吗？如果是这种情况，那么我想我不需要知道如何按名称删除旧的。

（我更喜欢处理名称而不是 SHA，因为它使事情更易于阅读）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-15T15:48:23.207

这个答案几乎是来自堆栈苹果网站的逐字记录：

*在尝试任何事情之前备份钥匙串。

列出根证书：

```
sudo security dump-keychain /System/Library/Keychains/SystemRootCertificates.keychain 
```

在转储中查找要删除的证书的名称或 SHA-1 哈希值：

```
Usage: delete-certificate [-c name] [-Z hash] [-t] [keychain...]

-c  Specify certificate to delete by its common name
-Z  Specify certificate to delete by its SHA-1 hash value
-t  Also delete user trust settings for this certificate The certificate to be deleted 

must be uniquely specified either by a string found in its common name, or by its SHA-1 hash. If no keychains are specified to search, the default search list is used. 
```

例如，您可以使用以下命令删除此中文根证书：

```
sudo security delete-certificate -Z 8BAF4C9B1DF02A92F7DA128EB91BACF498604B6F /System/Library/Keychains/SystemRootCertificates.keychain 
```

我认为 -Z 哈希方法可能更安全，并且建议这样做。您关于覆盖证书的问题很复杂，因为根据证书的不同，通常不是一个命令可以处理所有情况。[苹果网站上有一个帖子，其中包含](https://discussions.apple.com/thread/2619056?start=0&tstart=0)使用（和不使用）安全性和钥匙串的不同方式的截屏视频。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-17T20:40:38.670

这是我用来根据证书的公用名清除旧用户证书的方法。

在我的特殊情况下，我的 Mac 用户绑定到 Active Directory，并且他们安装了“用户证书”。

证书的公用名是用户名，而不是用户的“用户名”。

在我的环境中，用户名是 first.last。

因此，首先，我获取用户 login.keychain 的路径并去掉周围的引号，然后将其通过管道传输到一个名为“$Keychain_Name”的字符串变量中。

然后，我的脚本通过查找当前登录的用户、搜索“名称：”字段并使用 awk 获取所需的信息（First Last）来检索证书的通用名称。这将通过管道传输到字符串“$Common_Name”中。

然后我使用带有两个字符串变量的安全删除证书，瞧，证书被删除了！

下面的脚本...

```
#!/bin/sh

# CLEAR SCREEN
clear

echo "######################################################################"
echo "# Certificate Removal Script"
echo "# Written by Caine Hörr"
echo "# Written on Wednesday, July 17, 2013"
echo "# Last updated by Caine Hörr"
echo "# Last updated on Wednesday, July 17, 2013"
echo "######################################################################"
echo

echo
echo "Gathering Keychain Info"
Keychain_Name=$(security list-keychains | grep $(echo $USER) | tr -d '"')

echo
echo "Gathering Certificate Common Name Info"
Common_Name=$(finger $(echo $USER) | grep "Name:" | awk '{ print $4, $5 }')

echo
echo "Deleting Certificate $Common_Name from $Keychain_Name"
security delete-certificate -c "$Common_Name" $Keychain_Name

echo
echo "Process Complete"
exit 
```

希望这能给你一些思考！

# javascript - JavaScript 如何对 == 进行类型转换？

> ID：16019079
> 
> 赞同：1
> 
> 时间：2013-04-15T15:29:29.033
> 
> 标签：javascript, type-conversion, equality

在下面的代码中，**a != b**与`==`. 我最初的想法是 JavaScript 会对 parseFloat 使用与`==`. 任何人都可以解释实际发生的事情，因为我对此有点困惑。**b = 129**解析时，因此看起来 parseFloat 将解析到第一个非数字字符。

```
var a = '129t3.98';
var b;

b = parseFloat(a); 
```

[这是示例脚本小提琴。](http://jsfiddle.net/8dF2Q/)

我想用这个组合一个非常简单的`isNumeric()`函数，但我想先理解它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T15:33:57.333

正如您所注意到的，该`parseFloat`函数将解析到满足数字文字语法的第一个字符。[从规格](http://es5.github.com/#x15.1.2.3)：

> 令*numberString为**trimmedString*的最长前缀，它可能是*trimmedString*本身，满足*StrDecimalLiteral*的语法。

但是，[抽象相等比较算法](http://es5.github.com/#x11.9.3)（就是这样`==`做的）不遵循相同的规则：

> 如果 Type( *x* ) 是 String 并且 Type( *y* ) 是 Number ，则返回比较结果 ToNumber( *x* ) == *y*

这是内部[`ToNumber`](http://es5.github.com/#x9.3.1)操作必须说的：

> 如果语法不能将 String 解释为*StringNumericLiteral*的扩展，则 ToNumber 的结果为 NaN。

因此，当您尝试将您的字符串与解析它产生的数字进行比较时，您实际上是在比较数字`NaN`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T15:37:49.147

当您给出 a=b 时，b 的值将变为 a，无需任何转换。

当您将值分配为 a=parseFloat(b) 时，如果 b 是字符串类型，那么 a 将是 int 类型。

但如果 a= b 被赋值，那么 a & b 都是相同的类型。

```
if,2->int, '2' -> string 
2=='2'   (true)
2 === '2' (false) 
```

通过观察上述转换，您可以相应地处理您的代码。

# c# - 如果第二个 using 语句异常，Sql Connection 能否保持打开状态

> ID：16019083
> 
> 赞同：1
> 
> 时间：2013-04-15T15:29:43.430
> 
> 标签：c#, sqlconnection

鉴于以下情况：

```
try
{
    using (var connection = new SqlConnection(_connectionString))
    {
        connection.Open();

        using (SqlCommand queryCommand = new SqlCommand(QueryString, connection))
        {
            queryCommand.ExecuteScalar();
        }
    }
}
catch (Exception ex)
{
 //logging occurs
} 
```

如果`.ExecuteScalar()`方法抛出异常，连接会保持打开状态吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T15:30:50.733

不，因为您正在使用[`using`-statement](http://msdn.microsoft.com/en-us/library/yh598w02%28v=vs.110%29.aspx)确保即使在出现异常的情况下也能处理连接。如果您希望连接保持打开状态，则必须使用`Try/Catch`：

```
using (var connection = new SqlConnection(_connectionString))
{
    connection.Open();

    using (SqlCommand queryCommand = new SqlCommand(QueryString, connection))
    {
        try
        {
            queryCommand.ExecuteScalar();
        } catch (Exception ex)
        { 
            // log this exception or do something else useful 
        }
        // now do something else with the command/connection
    }
} 
```

# ms-word - Office 2013 JavaScript API for Word - 内容控制问题

> ID：16019085
> 
> 赞同：0
> 
> 时间：2013-04-15T15:29:56.457
> 
> 标签：ms-word, office-js, word-addins, word-2013, word-contentcontrol

是否可以将内容控件插入 Word 文档，然后获取内容控件的某种句柄或上下文，然后将 HTML 插入其中？

本质上，我尝试使用 Office JavaScript API 创建的场景是根据用户的请求插入富文本内容控件，然后使用 HTML 填充它。

我可以使用[http://social.msdn.microsoft.com/Forums/en-US/appsforoffice/thread/8c4809c7-743c-4388-aef0-bc6a6855c882](http://social.msdn.microsoft.com/Forums/en-US/appsforoffice/thread/8c4809c7-743c-4388-aef0-bc6a6855c882)中建议的方法从 JavaScript API 插入内容控件。它需要 ooxml 的 coercionType。但是，我希望使用 ooxml 填充的内容是基于 HTML 的。因此，当我尝试使用以下 ooxml 插入内容控件时：

```
...Boiler ooxml to create content control...

<w:r><w:t><h1>Test header</h1><h2>Test subheader</h2><p>Test paragraph text</p></w:t></w:r> 
```

插入尝试失败。我假设这是因为在将其插入到带有 ooxml 的 coercionType 的文档中时，您不能混合使用 ooxml 和 html。

由于这种 ooxml 方法是您可以插入内容控件的唯一方法，那么如何使用 HTML 文本设置内容控件？我查看了[http://msdn.microsoft.com/en-us/library/fp142295.aspx](http://msdn.microsoft.com/en-us/library/fp142295.aspx)上的 Document 对象帮助内容，但我不确定我仍然可以这样做，或者是否可行。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-10T12:57:03.160

虽然我没有用 JS 尝试过这个 - 但它应该是可能的。

尝试添加一个 altChunk 元素，它可以包含其他打开的 xml 或 html。我已经成功使用了几次。

关于这个问题的一些链接：http: [//blogs.msdn.com/b/brian_jones/archive/2008/12/08/the-easy-way-to-assemble-multiple-word-documents.aspx](http://blogs.msdn.com/b/brian_jones/archive/2008/12/08/the-easy-way-to-assemble-multiple-word-documents.aspx) [http:// blogs.msdn.com/b/ericwhite/archive/2008/10/27/how-to-use-altchunk-for-document-assembly.aspx](http://blogs.msdn.com/b/ericwhite/archive/2008/10/27/how-to-use-altchunk-for-document-assembly.aspx)

但是，您应该尝试使用“strict”-xml - 否则上述内容可能无法实现。

我刚刚找到[了这个例子](http://msdn.microsoft.com/de-de/magazine/jj991976.aspx)（对不起，它是德语，但在某个地方也应该有一个英文版本）。其中 coercionType 是这样使用的：

```
 Office.context.document.setSelectedDataAsync(
      booksToRead,
      { coercionType: Office.CoercionType.Html },
      function (result) {
    // Access the results, if necessary.
    }); 
```

这也可以解决问题。

# android - android和.net应用程序之间的蓝牙通信

> ID：16019089
> 
> 赞同：2
> 
> 时间：2013-04-15T15:30:06.727
> 
> 标签：android, .net, bluetooth

任何人都可以通过**BLUETOOTH**提供 android app 和 .net web app 之间连接和通信的示例工作代码。我搜索并找到了很多代码示例。我也看过**安卓蓝牙聊天**的例子，但没有一个能解决我的问题。我在与 android 和 .net Web 应用程序的连接方面遇到问题。请帮助我解决我的问题。如果有人解释了工作代码或工作示例，那应该会更好。

***登录活动.java***

```
package com.example.vivaexam;
import java.io.IOException;

import java.util.List;

import org.apache.http.HttpResponse;
import org.apache.http.NameValuePair;
import org.apache.http.client.HttpClient;
import org.apache.http.client.entity.UrlEncodedFormEntity;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.impl.client.DefaultHttpClient;

import org.apache.http.protocol.HTTP;
import org.apache.http.util.EntityUtils;
import android.R.string;
import android.annotation.SuppressLint;
import android.app.ActionBar;
import android.app.Activity;
import android.app.ProgressDialog;

import android.bluetooth.*;
import android.content.Context;
import android.content.Intent;
import android.os.AsyncTask;
import android.os.Bundle;
import android.os.Handler;
import android.os.Message;

import android.util.Log;
import android.view.KeyEvent;
import android.view.Menu;
import android.view.MenuInflater;
import android.view.MenuItem;
import android.view.View;
import android.view.Window;
import android.view.View.OnClickListener;
import android.view.inputmethod.EditorInfo;
import android.widget.ArrayAdapter;
import android.widget.Button;
import android.widget.EditText;
import android.widget.ListView;
import android.widget.TextView;
import android.widget.Toast;

@SuppressLint("NewApi")
public class LoginActivity extends Activity {

// Debugging
private static final String TAG = "BluetoothChat";
private static final boolean D = true;

// Message types sent from the BluetoothChatService Handler
public static final int MESSAGE_STATE_CHANGE = 1;
public static final int MESSAGE_READ = 2;
public static final int MESSAGE_WRITE = 3;
public static final int MESSAGE_DEVICE_NAME = 4;
public static final int MESSAGE_TOAST = 5;

// Key names received from the BluetoothChatService Handler
public static final String DEVICE_NAME = "device_name";
public static final String TOAST = "toast";

// Intent request codes
private static final int REQUEST_CONNECT_DEVICE = 1;
private static final int REQUEST_ENABLE_BT = 2;

// Layout Views
private TextView mTitle;
private ListView mConversationView;
private EditText mOutEditText;
private Button mSendButton;

// Name of the connected device
private String mConnectedDeviceName = null;
// Array adapter for the conversation thread
private ArrayAdapter<String> mConversationArrayAdapter;
// String buffer for outgoing messages
private StringBuffer mOutStringBuffer;
// Local Bluetooth adapter
private BluetoothAdapter mBluetoothAdapter = null;
// Member object for the chat services
private BluetoothChatService mChatService = null;

//final Button button1 = (Button) findViewById(R.id.btnLogin);

EditText usertext;
EditText pwdtext;
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    if(D) Log.e(TAG, "+++ ON CREATE +++");

    // Set up the window layout
    setContentView(R.layout.activity_login);
    setTitle("Login to your account");

    // Get local Bluetooth adapter
    //myBTadapter = BluetoothAdapter.getDefaultAdapter();
    mBluetoothAdapter = BluetoothAdapter.getDefaultAdapter();

    // If the adapter is null, then Bluetooth is not supported
    if(mBluetoothAdapter == null) {
        Toast.makeText(this, "Bluetooth is not available", Toast.LENGTH_LONG).show();
        finish();
        return;
    }

    //addListenerOnButton();
    usertext = (EditText) findViewById(R.id.username);
    pwdtext= (EditText) findViewById(R.id.pwd_edttxt);

}

public void onStart() {
    super.onStart();
    if(D) Log.e(TAG, "++ ON START ++");

    // If BT is not on, request that it be enabled.
    // setupChat() will then be called during onActivityResult
    if (!mBluetoothAdapter.isEnabled()) {
        Intent enableIntent = new Intent(BluetoothAdapter.ACTION_REQUEST_ENABLE);
        startActivityForResult(enableIntent, REQUEST_ENABLE_BT);
    // Otherwise, setup the chat session
    } else {
        if (mChatService == null) setupViva();
    }
}

@Override
public synchronized void onResume() {
    super.onResume();
    if(D) Log.e(TAG, "+ ON RESUME +");

    // Performing this check in onResume() covers the case in which BT was
    // not enabled during onStart(), so we were paused to enable it...
    // onResume() will be called when ACTION_REQUEST_ENABLE activity returns.
   /* if (mChatService != null) {
        // Only if the state is STATE_NONE, do we know that we haven't started already
        if (mChatService.getState() == BluetoothChatService.STATE_NONE) {
          // Start the Bluetooth chat services
          mChatService.start();
        }
    }*/
}

private void setupViva() {
    Log.d(TAG, "setupChat()");

    // Initialize the array adapter for the conversation thread
    //mConversationArrayAdapter = new ArrayAdapter<String>(this, R.layout.message);
    //mConversationView = (ListView) findViewById(R.id.in);
    //mConversationView.setAdapter(mConversationArrayAdapter);

    // Initialize the compose field with a listener for the return key
    mOutEditText = (EditText) findViewById(R.id.username);
    mOutEditText.setOnEditorActionListener(mWriteListener);

    // Initialize the send button with a listener that for click events
    mSendButton = (Button) findViewById(R.id.btnLogin);
    mSendButton.setOnClickListener(new OnClickListener() {
        public void onClick(View v) {
            // Send a message using content of the edit text widget
            TextView view = (TextView) findViewById(R.id.username);
            String message = view.getText().toString();
            sendMessage(message);
        }
    });

    // Initialize the BluetoothChatService to perform bluetooth connections
    mChatService = new BluetoothChatService(this, mHandler);

    // Initialize the buffer for outgoing messages
    mOutStringBuffer = new StringBuffer("");
}

@Override
public synchronized void onPause() {
    super.onPause();
    if(D) Log.e(TAG, "- ON PAUSE -");
}

@Override
public void onStop() {
    super.onStop();
    if(D) Log.e(TAG, "-- ON STOP --");
}

@Override
public void onDestroy() {
    super.onDestroy();
    // Stop the Bluetooth chat services
    if (mChatService != null) mChatService.stop();
    if(D) Log.e(TAG, "--- ON DESTROY ---");
}

private void ensureDiscoverable() {
    if(D) Log.d(TAG, "ensure discoverable");
    if (mBluetoothAdapter.getScanMode() !=
        BluetoothAdapter.SCAN_MODE_CONNECTABLE_DISCOVERABLE) {
        Intent discoverableIntent = new Intent(BluetoothAdapter.ACTION_REQUEST_DISCOVERABLE);
        discoverableIntent.putExtra(BluetoothAdapter.EXTRA_DISCOVERABLE_DURATION, 300);
        startActivity(discoverableIntent);
    }
}

// The action listener for the EditText widget, to listen for the return key
private TextView.OnEditorActionListener mWriteListener =
    new TextView.OnEditorActionListener() {
    public boolean onEditorAction(TextView view, int actionId, KeyEvent event) {
        // If the action is a key-up event on the return key, send the message
        if (actionId == EditorInfo.IME_NULL && event.getAction() == KeyEvent.ACTION_UP) {
            String message = view.getText().toString();
            sendMessage(message);
        }
        if(D) Log.i(TAG, "END onEditorAction");
        return true;
    }
};

// The Handler that gets information back from the BluetoothChatService
private final Handler mHandler = new Handler() {
    @Override
    public void handleMessage(Message msg) {
        switch (msg.what) {
        case MESSAGE_STATE_CHANGE:
            if(D) Log.i(TAG, "MESSAGE_STATE_CHANGE: " + msg.arg1);
            switch (msg.arg1) {
            case BluetoothChatService.STATE_CONNECTED:
                mTitle.setText(R.string.title_connected_to);
                mTitle.append(mConnectedDeviceName);
                mConversationArrayAdapter.clear();
                break;
            case BluetoothChatService.STATE_CONNECTING:
                //mTitle.setText(R.string.title_connecting);
                break;
            case BluetoothChatService.STATE_LISTEN:
            case BluetoothChatService.STATE_NONE:
                //mTitle.setText(R.string.title_not_connected);
                break;
            }
            break;
        case MESSAGE_WRITE:
            byte[] writeBuf = (byte[]) msg.obj;
            // construct a string from the buffer
            String writeMessage = new String(writeBuf);
            mConversationArrayAdapter.add("Me:  " + writeMessage);
            break;
        case MESSAGE_READ:
            byte[] readBuf = (byte[]) msg.obj;
            // construct a string from the valid bytes in the buffer
            String readMessage = new String(readBuf, 0, msg.arg1);
            mConversationArrayAdapter.add(mConnectedDeviceName+":  " + readMessage);
            break;
        case MESSAGE_DEVICE_NAME:
            // save the connected device's name
            mConnectedDeviceName = msg.getData().getString(DEVICE_NAME);
            Toast.makeText(getApplicationContext(), "Connected to "
                           + mConnectedDeviceName, Toast.LENGTH_SHORT).show();
            break;
        case MESSAGE_TOAST:
            Toast.makeText(getApplicationContext(), msg.getData().getString(TOAST),
                           Toast.LENGTH_SHORT).show();
            break;
        }
    }
};

public void onActivityResult(int requestCode, int resultCode, Intent data) {
    if(D) Log.d(TAG, "onActivityResult " + resultCode);
    switch (requestCode) {
    case REQUEST_CONNECT_DEVICE:
        // When DeviceListActivity returns with a device to connect
        if (resultCode == Activity.RESULT_OK) {
            // Get the device MAC address
            String address = data.getExtras()
                                 .getString(DeviceListActivity.EXTRA_DEVICE_ADDRESS);

            // Get the BLuetoothDevice object
            BluetoothDevice device = mBluetoothAdapter.getRemoteDevice(address);
            if(D) Log.d(TAG, "==== " + device);
            // Attempt to connect to the device
            mChatService.connect(device);
        }
        break;
    case REQUEST_ENABLE_BT:
        // When the request to enable Bluetooth returns
        if (resultCode == Activity.RESULT_OK) {
            // Bluetooth is now enabled, so set up a chat session
            setupViva();
        } else {
            // User did not enable Bluetooth or an error occured
            Log.d(TAG, "BT not enabled");
            Toast.makeText(this, R.string.bt_not_enabled_leaving, Toast.LENGTH_SHORT).show();
            finish();
        }
    }
}

/**
 * Sends a message.
 * @param message  A string of text to send.
 */
private void sendMessage(String message) {
    // Check that we're actually connected before trying anything
    if (mChatService.getState() != BluetoothChatService.STATE_CONNECTED) {
        Toast.makeText(this, R.string.not_connected, Toast.LENGTH_SHORT).show();
        return;
    }

    // Check that there's actually something to send
    if (message.length() > 0) {
        // Get the message bytes and tell the BluetoothChatService to write
        byte[] send = message.getBytes();
        mChatService.write(send);

        // Reset out string buffer to zero and clear the edit text field
        mOutStringBuffer.setLength(0);
        mOutEditText.setText(mOutStringBuffer);
    }
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    MenuInflater inflater = getMenuInflater();
    inflater.inflate(R.menu.option_menu, menu);
    return true;
}

@Override
public boolean onOptionsItemSelected(MenuItem item) {
    switch (item.getItemId()) {
    case R.id.secure_connect_scan:
        // Launch the DeviceListActivity to see devices and do scan
        Intent serverIntent = new Intent(this, DeviceListActivity.class);
        startActivityForResult(serverIntent, REQUEST_CONNECT_DEVICE);
        return true;
    case R.id.discoverable:
        // Ensure this device is discoverable by others
        ensureDiscoverable();
        return true;
    }
    return false;
} 
```

}

**service.java** 包 com.example.vivaexam；

```
import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;
import java.util.UUID;

import android.bluetooth.BluetoothAdapter;
import android.bluetooth.BluetoothDevice;
import android.bluetooth.BluetoothServerSocket;
import android.bluetooth.BluetoothSocket;
import android.content.Context;
import android.os.Bundle;
import android.os.Handler;
import android.os.Message;
import android.util.Log;

public class BluetoothChatService {
// Debugging
private static final String TAG = "BluetoothChatService";
private static final boolean D = true;

// Name for the SDP record when creating server socket
private static final String NAME = "BluetoothChat";

// Unique UUID for this application
//private static final UUID MY_UUID = UUID.fromString("fa87c0d0-afac-11de-8a39-0800200c9a66");
private static final UUID MY_UUID = UUID.fromString("00001101-0000-1000-8000-00805F9B34FB");

// Member fields
private final BluetoothAdapter mAdapter;
private final Handler mHandler;
private AcceptThread mAcceptThread;
private ConnectThread mConnectThread;
private ConnectedThread mConnectedThread;
private int mState;

// Constants that indicate the current connection state
public static final int STATE_NONE = 0;       // we're doing nothing
public static final int STATE_LISTEN = 1;     // now listening for incoming connections
public static final int STATE_CONNECTING = 2; // now initiating an outgoing connection
public static final int STATE_CONNECTED = 3;  // now connected to a remote device

/**
 * Constructor. Prepares a new BluetoothChat session.
 * @param context  The UI Activity Context
 * @param handler  A Handler to send messages back to the UI Activity
 */
public BluetoothChatService(Context context, Handler handler) {
    mAdapter = BluetoothAdapter.getDefaultAdapter();
    mState = STATE_NONE;
    mHandler = handler;
}

/**
 * Set the current state of the chat connection
 * @param state  An integer defining the current connection state
 */
private synchronized void setState(int state) {
    if (D) Log.d(TAG, "setState() " + mState + " -> " + state);
    mState = state;

    // Give the new state to the Handler so the UI Activity can update
    mHandler.obtainMessage(LoginActivity.MESSAGE_STATE_CHANGE, state, -1).sendToTarget();
}

/**
 * Return the current connection state. */
public synchronized int getState() {
    return mState;
}

/**
 * Start the chat service. Specifically start AcceptThread to begin a
 * session in listening (server) mode. Called by the Activity onResume() */
public synchronized void start() {
    if (D) Log.d(TAG, "start");

    // Cancel any thread attempting to make a connection
    if (mConnectThread != null) {mConnectThread.cancel(); mConnectThread = null;}

    // Cancel any thread currently running a connection
    if (mConnectedThread != null) {mConnectedThread.cancel(); mConnectedThread = null;}

    // Start the thread to listen on a BluetoothServerSocket
    if (mAcceptThread == null) {
        mAcceptThread = new AcceptThread();
        mAcceptThread.start();
    }
    setState(STATE_LISTEN);
}

/**
 * Start the ConnectThread to initiate a connection to a remote device.
 * @param device  The BluetoothDevice to connect
 */
public synchronized void connect(BluetoothDevice device) {
    if (D) Log.d(TAG, "connect to: " + device);

    // Cancel any thread attempting to make a connection
    if (mState == STATE_CONNECTING) {
        if (mConnectThread != null) {mConnectThread.cancel(); mConnectThread = null;}
    }

    // Cancel any thread currently running a connection
    if (mConnectedThread != null) {mConnectedThread.cancel(); mConnectedThread = null;}

    // Start the thread to connect with the given device
    mConnectThread = new ConnectThread(device);
    mConnectThread.start();
    setState(STATE_CONNECTING);
}

/**
 * Start the ConnectedThread to begin managing a Bluetooth connection
 * @param socket  The BluetoothSocket on which the connection was made
 * @param device  The BluetoothDevice that has been connected
 */
public synchronized void connected(BluetoothSocket socket, BluetoothDevice device) {
    if (D) Log.d(TAG, "connected");

    // Cancel the thread that completed the connection
    if (mConnectThread != null) {mConnectThread.cancel(); mConnectThread = null;}

    // Cancel any thread currently running a connection
    if (mConnectedThread != null) {mConnectedThread.cancel(); mConnectedThread = null;}

    // Cancel the accept thread because we only want to connect to one device
    if (mAcceptThread != null) {mAcceptThread.cancel(); mAcceptThread = null;}

    // Start the thread to manage the connection and perform transmissions
    mConnectedThread = new ConnectedThread(socket);
    mConnectedThread.start();

    // Send the name of the connected device back to the UI Activity
    Message msg = mHandler.obtainMessage(LoginActivity.MESSAGE_DEVICE_NAME);
    Bundle bundle = new Bundle();
    bundle.putString(LoginActivity.DEVICE_NAME, device.getName());
    msg.setData(bundle);
    mHandler.sendMessage(msg);

    setState(STATE_CONNECTED);
}

/**
 * Stop all threads
 */
public synchronized void stop() {
    if (D) Log.d(TAG, "stop");
    if (mConnectThread != null) {mConnectThread.cancel(); mConnectThread = null;}
    if (mConnectedThread != null) {mConnectedThread.cancel(); mConnectedThread = null;}
    if (mAcceptThread != null) {mAcceptThread.cancel(); mAcceptThread = null;}
    setState(STATE_NONE);
}

/**
 * Write to the ConnectedThread in an unsynchronized manner
 * @param out The bytes to write
 * @see ConnectedThread#write(byte[])
 */
public void write(byte[] out) {
    // Create temporary object
    ConnectedThread r;
    // Synchronize a copy of the ConnectedThread
    synchronized (this) {
        if (mState != STATE_CONNECTED) return;
        r = mConnectedThread;
    }
    // Perform the write unsynchronized
    r.write(out);
}

/**
 * Indicate that the connection attempt failed and notify the UI Activity.
 */
private void connectionFailed() {
    setState(STATE_LISTEN);

    // Send a failure message back to the Activity
    Message msg = mHandler.obtainMessage(LoginActivity.MESSAGE_TOAST);
    Bundle bundle = new Bundle();
    bundle.putString(LoginActivity.TOAST, "Unable to connect device");
    msg.setData(bundle);
    mHandler.sendMessage(msg);
}

/**
 * Indicate that the connection was lost and notify the UI Activity.
 */
private void connectionLost() {
    setState(STATE_LISTEN);

    // Send a failure message back to the Activity
    Message msg = mHandler.obtainMessage(LoginActivity.MESSAGE_TOAST);
    Bundle bundle = new Bundle();
    bundle.putString(LoginActivity.TOAST, "Device connection was lost");
    msg.setData(bundle);
    mHandler.sendMessage(msg);
}

/**
 * This thread runs while listening for incoming connections. It behaves
 * like a server-side client. It runs until a connection is accepted
 * (or until cancelled).
 */
private class AcceptThread extends Thread {
    // The local server socket
    private final BluetoothServerSocket mmServerSocket;

    public AcceptThread() {
        BluetoothServerSocket tmp = null;

        // Create a new listening server socket
        try {
            tmp = mAdapter.listenUsingRfcommWithServiceRecord(NAME, MY_UUID);
        } catch (IOException e) {
            Log.e(TAG, "listen() failed", e);
        }
        mmServerSocket = tmp;
    }

    public void run() {
        if (D) Log.d(TAG, "BEGIN mAcceptThread" + this);
        setName("AcceptThread");
        BluetoothSocket socket = null;

        // Listen to the server socket if we're not connected
        while (mState != STATE_CONNECTED) {
            try {
                // This is a blocking call and will only return on a
                // successful connection or an exception
                socket = mmServerSocket.accept();
            } catch (IOException e) {
                Log.e(TAG, "accept() failed", e);
                break;
            }

            // If a connection was accepted
            if (socket != null) {
                synchronized (BluetoothChatService.this) {
                    switch (mState) {
                    case STATE_LISTEN:
                    case STATE_CONNECTING:
                        // Situation normal. Start the connected thread.
                        connected(socket, socket.getRemoteDevice());
                        break;
                    case STATE_NONE:
                    case STATE_CONNECTED:
                        // Either not ready or already connected. Terminate new socket.
                        try {
                            socket.close();
                        } catch (IOException e) {
                            Log.e(TAG, "Could not close unwanted socket", e);
                        }
                        break;
                    }
                }
            }
        }
        if (D) Log.i(TAG, "END mAcceptThread");
    }

    public void cancel() {
        if (D) Log.d(TAG, "cancel " + this);
        try {
            mmServerSocket.close();
        } catch (IOException e) {
            Log.e(TAG, "close() of server failed", e);
        }
    }
}

/**
 * This thread runs while attempting to make an outgoing connection
 * with a device. It runs straight through; the connection either
 * succeeds or fails.
 */
private class ConnectThread extends Thread {
    private final BluetoothSocket mmSocket;
    private final BluetoothDevice mmDevice;

    public ConnectThread(BluetoothDevice device) {
        mmDevice = device;
        BluetoothSocket tmp = null;

        // Get a BluetoothSocket for a connection with the
        // given BluetoothDevice
        try {
            tmp = device.createRfcommSocketToServiceRecord(MY_UUID);
        } catch (IOException e) {
            Log.e(TAG, "create() failed", e);
        }
        mmSocket = tmp;
    }

    public void run() {
        Log.i(TAG, "BEGIN mConnectThread");
        setName("ConnectThread");

        // Always cancel discovery because it will slow down a connection
        mAdapter.cancelDiscovery();

        // Make a connection to the BluetoothSocket
        try {
            // This is a blocking call and will only return on a
            // successful connection or an exception
            mmSocket.connect();
        } catch (IOException e) {
            connectionFailed();
            // Close the socket
            try {
                mmSocket.close();
            } catch (IOException e2) {
                Log.e(TAG, "unable to close() socket during connection failure", e2);
            }
            // Start the service over to restart listening mode
            BluetoothChatService.this.start();
            return;
        }

        // Reset the ConnectThread because we're done
        synchronized (BluetoothChatService.this) {
            mConnectThread = null;
        }

        // Start the connected thread
        connected(mmSocket, mmDevice);
    }

    public void cancel() {
        try {
            mmSocket.close();
        } catch (IOException e) {
            Log.e(TAG, "close() of connect socket failed", e);
        }
    }
}

/**
 * This thread runs during a connection with a remote device.
 * It handles all incoming and outgoing transmissions.
 */
private class ConnectedThread extends Thread {
    private final BluetoothSocket mmSocket;
    private final InputStream mmInStream;
    private final OutputStream mmOutStream;

    public ConnectedThread(BluetoothSocket socket) {
        Log.d(TAG, "create ConnectedThread");
        mmSocket = socket;
        InputStream tmpIn = null;
        OutputStream tmpOut = null;

        // Get the BluetoothSocket input and output streams
        try {
            tmpIn = socket.getInputStream();
            tmpOut = socket.getOutputStream();
        } catch (IOException e) {
            Log.e(TAG, "temp sockets not created", e);
        }

        mmInStream = tmpIn;
        mmOutStream = tmpOut;
    }

    public void run() {
        Log.i(TAG, "BEGIN mConnectedThread");
        byte[] buffer = new byte[1024];
        int bytes;

        // Keep listening to the InputStream while connected
        while (true) {
            try {
                // Read from the InputStream
                bytes = mmInStream.read(buffer);

                // Send the obtained bytes to the UI Activity
                mHandler.obtainMessage(LoginActivity.MESSAGE_READ, bytes, -1, buffer)
                        .sendToTarget();
            } catch (IOException e) {
                Log.e(TAG, "disconnected", e);
                connectionLost();
                break;
            }
        }
    }

    /**
     * Write to the connected OutStream.
     * @param buffer  The bytes to write
     */
    public void write(byte[] buffer) {
        try {
            mmOutStream.write(buffer);

            // Share the sent message back to the UI Activity
            mHandler.obtainMessage(LoginActivity.MESSAGE_WRITE, -1, -1, buffer)
                    .sendToTarget();
        } catch (IOException e) {
            Log.e(TAG, "Exception during write", e);
        }
    }

    public void cancel() {
        try {
            mmSocket.close();
        } catch (IOException e) {
            Log.e(TAG, "close() of connect socket failed", e);
        }
    }
} 
```

}

`

# java - Java 铸造一个列表 to its interface I have: class Hammer Implements Part { public String getName() { return name; } public int getId() { return id; } ... } class Wrench implements Part { public String ge 问问题 问问题 2013-04-15T15:30:16.503 6197 次 This question shows research effort; it is useful and clear 5 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. I have: class Hammer Implements Part { public String getName() { return name; } public int getId() { return id; } ... } class Wrench implements Part { public String getName() { return name; } public int getId() { return id; } ... } interface Part { String getName(); int getId(); } I am using a prebuilt database manager written for Android SQLite that returns a list of Objects based on what I am retrieving: dataManager().getWrenchDao().getAll(); // returns List<Wrench> I cannot change how this function operates. Now I am getting both lists like: List<Wrench> wrenches = dataManager().getWrenchDao().getAll(); List<Hammer> hammers = dataManager().getHammerDao().getAll(); However, I want to populate spinners with this data (Spinners are the drop down lists in android). loadSpinner(Spinner s, List<Part> data) { ... data.ElementAt(i).getName(); data.ElementAt(i).getId(); ... } loadSpinner(wrenchSpinner, wrenches); But it gives me a casting error that you cannot change Wrench to Part. Why doesn't Java let me do this? Wrenches have all methods that Parts do so why cant I cast it into something it implements and use it? Error: The method loadSpinner(Spinner, List<Part>) in the type NewActivity is not applicable for the arguments (Spinner, List<Wrench>) You have to replace the second parameter of loadSpinner to: loadSpinner(Spinner s, List<? extends Part> data) See also: When do Java generics require <? extends T> instead of <T> and is there any downside of switching? javagenericsinheritanceinterfacecasting 4 1 回答 1 This answer is useful 14 您必须将第二个参数替换loadSpinner为： loadSpinner(Spinner s, List<? extends Part> data) 另请参阅：Java 泛型何时需要 <? 扩展 T> 而不是 <T> 并且切换有什么缺点吗？ 于 2013-04-15T15:37:12.757 回答 Related 1 android - 使用百分比呢？ 2 c# - 将值保存到视图状态并从中读取 1 objective-c - 在 didReceiveLocalNotification 中设置根视图控制器：导致黑色窗口 2 android - 活动恢复时在 Spinner 中显示提示 1 itext - 使 PdfField 可见 1 php - 在我的 CMS php 中将类名分组在一起 5 c++ - 如何在 C++ 中进行深度复制 1 c# - CommandBar 上指定位置的菜单项 3 ruby-on-rails - 根据元素的大小将数组中的项目放入 div 类中 0 java - Android外部文件不一致出现 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：16019094
> 
> 赞同：5
> 
> 时间：
> 
> 标签：java, generics, inheritance, interface, casting

I have:

```
class Hammer Implements Part {
    public String getName() { return name; }
    public int getId() { return id; }
    ...
}

class Wrench implements Part {
    public String getName() { return name; }
    public int getId() { return id; }
    ...
}

interface Part {
    String getName();
    int getId();
} 
```

I am using a prebuilt database manager written for Android SQLite that returns a list of Objects based on what I am retrieving:

```
dataManager().getWrenchDao().getAll(); // returns List<Wrench> 
```

I cannot change how this function operates.

Now I am getting both lists like:

```
List<Wrench> wrenches = dataManager().getWrenchDao().getAll();
List<Hammer> hammers = dataManager().getHammerDao().getAll(); 
```

However, I want to populate spinners with this data (Spinners are the drop down lists in android).

```
loadSpinner(Spinner s, List<Part> data) {
    ...
    data.ElementAt(i).getName();
    data.ElementAt(i).getId();
    ...
}

loadSpinner(wrenchSpinner, wrenches); 
```

But it gives me a casting error that you cannot change Wrench to Part. Why doesn't Java let me do this? Wrenches have all methods that Parts do so why cant I cast it into something it implements and use it?

Error:

```
The method loadSpinner(Spinner, List<Part>) in the type NewActivity is not applicable for the arguments (Spinner, List<Wrench>) 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-15T15:37:12.757

您必须将第二个参数替换`loadSpinner`为：

```
loadSpinner(Spinner s, List<? extends Part> data) 
```

另请参阅：[Java 泛型何时需要 <? 扩展 T> 而不是 <T> 并且切换有什么缺点吗？](https://stackoverflow.com/questions/897935/when-do-java-generics-require-extends-t-instead-of-t-and-is-there-any-down)

# apache-flex - How do I create s:Path.data, polygon coords?

> ID：16019100
> 
> 赞同：0
> 
> 时间：2013-04-15T15:30:40.623
> 
> 标签：apache-flex, mxml, flex-spark, fxg

I have a PNG image, the image features a shape surrounded by a transparent area:

![sample image](https://i.stack.imgur.com/GNYTi.png)

I want to recreate this image as a path in flex mxml, something like this:

```
<s:Path data="M 0 0 L 0 100 L 100 100 L 100 0 L 0 0" /> 
```

How can I export the path data so that I can use this shape in Flex, is there a program that will do this for me?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T15:38:23.383

[Illustrator will export an FXG](http://help.adobe.com/en_US/illustrator/cs/using/WS3f28b00cc50711d9814a4f8133b3babd90-8000.html), as will [Photoshop](http://helpx.adobe.com/x-productkb/multi/photoshop-fxg-extensions-required-photoshop.html).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T11:06:33.357

My problem was that my original image was a flat file, not a path. This meant that following *@www.Flextras.com's* answer didn't work for me, the result was an FXG with an image embedded.

The process I used is as follows, I used Adobe Fireworks for this:

**1) Magic wand selection**

Select the body of the image with magic wand.

![Magic Wand Selection](https://i.stack.imgur.com/Ei23J.gif)

**2) Convert to path**

Right click -> Modify Marquee -> Convert to Path

![Convert To Path](https://i.stack.imgur.com/GAMvd.gif)

**3) Export as FXG**

File -> Export

![Export As FXG](https://i.stack.imgur.com/2fPxB.png)

**4) Done**

Open the FXG in notepad and extract the path data.

![Done](https://i.stack.imgur.com/Zi4kJ.png)

# message-queue - 消息队列系统如何工作？

> ID：16019101
> 
> 赞同：8
> 
> 时间：2013-04-15T15:30:44.287
> 
> 标签：message-queue, distributed-system

我在课堂上学习过消息队列系统，但我仍然不明白这些消息队列系统是如何在实时场景中工作的？是否有任何教程可以帮助我获得完整的图片？有人可以解释一下这些系统是如何工作的吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-15T15:52:07.510

一个例子：我的线程或进程可以向您的消息队列发送一条消息，并且在发送它之后，我的代码继续执行其他操作。您的代码在处理它时，会从消息队列中读取下一条消息，然后决定如何处理该消息。消息队列避免了需要在两个线程或进程之间共享临界区或互斥锁。底层消息队列层本身负责确保消息进入队列而没有影响队列完整性的竞争条件。

消息队列可用于单向和双向异步消息传递。对于单向使用，我的线程可以使用它来让您的线程评估我线程中的关键事件，而无需从您的线程确认。对于双向使用，在我的线程向您的线程发送消息后，您的线程可能需要通过我的消息队列将数据发送回我的线程。

消息队列层使用较低级别的同步方案来确保队列中没有两个写入者可以同时写入。它确保对队列的所有写入都是原子的。它还确保队列的读取器无法从队列中读取部分写入的消息。

大多数消息队列 API 还支持根据您指定的过滤器从队列中读取消息。例如，假设您认为来自时间关键线程的消息比其他消息更重要。您可以在每次检查队列中的消息时，首先检查来自关键线程的消息，然后首先处理这些消息。然后，您的线程将继续正常处理其余消息，前提是不再找到来自关键线程的消息。

[UNIX消息队列AC教程](http://www.cs.cf.ac.uk/Dave/C/node25.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-04-16T20:04:20.880

这是一个复杂的话题，但简单地说：

> 消息队列是实现分布式系统的*最佳方式之一，如果不是最好的话。*

现在你可能会问，什么是*分布式系统*？它是一个跨越多台机器、客户端或节点的集成系统，它们以无中断的方式并行执行其任务。分布式系统应该足够健壮，以便在一个或多个节点发生故障、停止工作、滞后或因维护而停机时继续运行。

那你可能会问，什么是*消息队列*？它是一种面向消息的中间件，可以通过使用**异步消息**通过网络进行节点间通信来开发分布式系统。

最后你可能会问，这一切有什么用？这有利于实现具有大量称为**节点**的移动部件的应用程序，这些部件需要实时监控和实时反应能力。总而言之，它们提供：并行性（节点可以真正并行运行）、紧密集成（所有节点以相同的顺序看到相同的消息）、解耦（节点可以独立发展）、故障转移/冗余（当一个节点发生故障时，另一个节点可以正在运行并建立状态以立即接管），可扩展性/负载平衡（只需添加更多节点），弹性（节点可以在活动高峰期滞后而不影响整个系统）和弹性（节点可以失败/停止工作而不采取整个系统停机）。

查看[这篇](http://www.coralblocks.com/index.php/2015/04/state-of-the-art-distributed-systems-with-coralmq/)详细讨论消息队列基础结构的文章。

# single-page-application - 在 Durandal 应用程序中使用多个根

> ID：16019104
> 
> 赞同：0
> 
> 时间：2013-04-15T15:30:48.570
> 
> 标签：single-page-application, durandal

**问题：**

我的应用程序没有启动；它只是进入一个无限循环。

**代码：**

我的应用程序开始：

```
app.start().then(function() {
            //Replace 'viewmodels' in the moduleId with 'views' to locate the view.
            //Look for partial views in a 'views' folder in the root.
            viewLocator.useConvention();

            //configure routing
            router.useConvention();

            router.mapNav('home');
            router.mapNav('intro');
            router.mapNav('error');
            router.mapRoute('set/:id', 'viewmodels/set', 'Set');
            router.mapRoute('folder/:id', 'viewmodels/folder', 'Folder');
            router.mapRoute('api', 'viewmodels/api', 'API Reference');

            app.adaptToDevice();

            app.setRoot('viewmodels/intro');
            //logger.logError('No route found', route, 'main', true);
            /*
            router.handleInvalidRoute = function (route, params) {
                //debugger;
                //router.navigateTo('#/error');
            };
            */
        }); 
```

我将根设置为 intro，其中包含一个具有登录功能的简单视图模型：

```
define(['durandal/app', 'durandal/plugins/router', 'services/dataservice'], function (app, router, dataservice) {
var introViewModel = function () {

    var self = this;
    self.router = router;

    self.logIn = function () {
        app.setRoot('viewmodels/shell');
    };

    self.activate = function () {
        return router.activate('intro');
    }; 
```

这里的目标是在用户登录时重新设置应用程序的根目录。知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-27T14:46:11.943

根据 Rob 在 Google Groups 页面上的回答，以下是一些对我有用的细节，可能对其他人有所帮助：

*   在 main.js app.start().then(): 将 root 设置为您的登录页面。

*   登录后，配置您的路由器并为其添加路由。（*必须*在路由器激活之前添加路由。）这是一个仅检索用户在登录过程中可以访问的路由的机会。

*   最后，将 app root 设置为 shell，然后使用您指定的默认路由激活路由器。目前，我修改了路由器中的激活功能，以获取一个附加的起始url参数——这样，如果需要，我可以绕过默认页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-10T13:04:39.810

根据您的回答，第一部分（setroot 登录），我这样做了，但登录页面没有加载，也没有显示错误。

在主要我只是简单地把 app.setRoot('viewmodels/login', 'entrance');

在登录时，我只有一个激活功能：

```
function activate() {
    return true;
} 
```

这是对的吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T16:13:01.263

Per Rob over on the Google Groups, I just plucked the router from my intro page and ran it in my shell.js, activating the router only once. This seems to tighten things up a bit and the app is working now:

[https://groups.google.com/forum/#!topic/durandaljs/RdGpwIm1oOU](https://groups.google.com/forum/#!topic/durandaljs/RdGpwIm1oOU)

# mysql - 具有关系 innoDB 的递归 MySQL 查询

> ID：16019105
> 
> 赞同：2
> 
> 时间：2013-04-15T15:30:50.400
> 
> 标签：mysql, database, recursion, innodb

我有一个表结构，如（简化）：

内容

```
 - id_content
 - my_string1
 - ... 
```

content_has_content

```
 - id_content
  - id_subcontent 
```

topic_has_content

```
 - id_topic
  - id_content 
```

任何主题都可以有多个“内容”，任何“内容”都可以有多个“子内容”（内容的实例）。对于给定的 id_topic，我想从链接的内容、子内容、子内容的子内容等中接收所有 my_string1 的列表。

我知道“WITH”不适用于 mysql，但找不到一个好的递归替代方案。

谢谢丹尼尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T15:49:38.307

MySQL 中没有递归，而且你得到的结果也是平坦的（没有结构）。最好的方法仍然是 PHP、Java 或您使用的任何编程语言中的 while 循环。

查询可能如下所示：

```
SELECT C.*, CHC.ID_SUBCONTENT
FROM CONTENT C
LEFT OUTER JOIN CONTENT_HAS_CONTENT CHC ON CHC.ID_CONTENT = C.ID_CONTENT
WHERE C.ID = ?
... // you get the idea 
```

在 PHP 中，您可以使用下一个 sub_content_id 重复查询，直到`ID_SUBCONTENT is null`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T19:42:30.560

## 解决方案

**PosgreSQL、Oracle、MS-SQL……**必须`WITH RECURSIVE`处理这样的数据结构。它在内部使用一个while循环来获取`parent ids`当前行的所有内容（我们需要孩子在这里）

这也可以实现`MySQL`，您可以创建`stored procedure`并重现相同的行为

**假定/使用 DDL**

`content_has_content`条目为

```
content_1
  content_2
    content_3
      content_4 
```

我通过`id_content`as 2 并获得输出为

```
 content_2
    content_3
      content_4 
```

以上皆为后代`content_2`

触发`call content_details(2);`以获取传递的所有子行`id_content`

**SQL**

```
###### Stored Routine
DELIMITER //  
drop procedure IF EXISTS `content_details`;
CREATE DEFINER=`root`@`localhost` PROCEDURE `content_details`(`_idcontent` INT)
    LANGUAGE SQL
    DETERMINISTIC
    CONTAINS SQL
    SQL SECURITY DEFINER
    COMMENT ''
BEGIN
DECLARE  temp_content_ids varchar(200);
DECLARE idcontent, idcontent2 integer;

SET temp_content_ids= _idcontent;
SET idcontent       = _idcontent;
SET idcontent2      = _idcontent;

WHILE idcontent2 IS NOT NULL DO 
    SET idcontent = NULL;
    SELECT id_subcontent, CONCAT(id_subcontent,',',temp_content_ids) INTO idcontent, temp_content_ids FROM content_has_content WHERE id_content = idcontent2;
    SET idcontent2 = idcontent;
END WHILE;  

SELECT my_string1 FROM content WHERE FIND_IN_SET( id, temp_content_ids );
END// 
```

我基本上做的是运行 a`while loop`直到我有最后一个`child_id`，将它们存储`ids`在 a`comma separated string format`然后触发查询以获取我刚刚创建`id`的所有行`var`

**注意：**您的表中可能有无效值，例如行有 a `id_subcontent`，它指向它自己的`id_content`，这可能导致过程中永无止境`loop`，为避免这种情况，您可以使用计数器并限制嵌套说大约 50（或根据您的要求的任何值），`raise a exception`如果超过该限制

***一些数据可以玩..***

```
###### DLL Statements
CREATE TABLE content
( id_content int,
my_string1 varchar(200));

CREATE TABLE content_has_content
( id_content int,
  id_subcontent  int);

CREATE TABLE  topic_has_content
( id_topic int,
 id_content int);

INSERT INTO content VALUES (1, 'content_1'), (2, 'content_2'), (3, 'content_3'), (4, 'content_4');
INSERT INTO content_has_content VALUES (1, 2), (2, 3), (3, 4);
INSERT INTO topic_has_content VALUES (1, 1); 
```

希望这可以帮助..

# .net - 如何在 GeckoFX 中处理文件下载？

> ID：16019107
> 
> 赞同：3
> 
> 时间：2013-04-15T15:30:57.357
> 
> 标签：.net, vb.net, geckofx

我正在使用最新的 GeckoFX 18 (hindlemail's fork) 并努力实现这个简单的方法：处理文件下载。

我想知道 GeckoWebBrowser 中是否有文件下载。没有文件下载事件，更糟糕的是：单击导致文件下载的链接不会触发 /any/ 事件。它只是什么都不做。没有下载对话框，没有保存文件对话框，没有 url，什么都没有。

有没有办法可以处理文件下载？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T14:15:17.860

通过使用hindlemail 的geckofx 分支，您将不得不处理LauncherDialog.Download 事件。此事件有几个参数，如 url、文件名等。

```
LauncherDialog.Download += LauncherDialog_Download;
////
void LauncherDialog_Download(object sender, LauncherDialogEvent e)
{
    string filename = e.Filename; //do something with filename
    string url = e.Url; //use webclient to download file from this url
} 
```

即使这样，您也无法从 Dropbox 或 facebook 等安全网站下载文件，但它会下载一些东西，总比没有好。我对 xul 不太了解，所以我也很难下载文件。

我也试过这个：

```
void LauncherDialog_Download(object sender, LauncherDialogEvent e)
{
    WebBrowser ie = new WebBrowser();
    ie.Navigate(e.Url);
} 
```

如果可以通过这种方式下载文件，它将显示 Internet Explorer 下载文件对话框。可能是请求标头或其他原因。我还使用 Fiddler 找出 Firefox 发送到服务器的标头，但我发现没有任何用处。

# jquery - 如何将 System.Data.DataTable 传递给 JQuery 文件

> ID：16019108
> 
> 赞同：2
> 
> 时间：2013-04-15T15:31:03.747
> 
> 标签：jquery, asp.net, datatable

我在 PageLoad 中有一个 DataTable，我需要将它传递给一个 JQuery 文件以生成 BingMap 内容

```
 protected override void OnLoad(EventArgs e)
 {
    DataTable dt = dtLocations;
 } 
```

我的 JQuery 文件包含在`.ascx`页面中

```
<script type="text/javascript" src="/script/BingMap/BingMapJS.js" ></script> 
```

需要将此“dt”发送到 JQuery 文件

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T15:37:48.573

```
string json = JsonConvert.SerializeObject(table); 
```

[http://james.newtonking.com/projects/json/help/index.html?topic=html/T_Newtonsoft_Json_JsonConvert.htm](http://james.newtonking.com/projects/json/help/index.html?topic=html/T_Newtonsoft_Json_JsonConvert.htm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T15:37:36.727

大多数 jQuery 库都接受 Json 作为数据格式进行处理，您可以按照[这种](https://stackoverflow.com/questions/546121/datatable-to-json-using-jquery)方法将您的`DataTable`结果转换为 Json，然后将其传递给 Bing JS 库进行处理。

# jquery - 更改下拉菜单的值和文本

> ID：16019113
> 
> 赞同：2
> 
> 时间：2013-04-15T15:31:18.983
> 
> 标签：jquery, html

我想根据我拥有的值通过 jquery 更改下拉选项。并根据该值显示文本有
html:-

```
<select id="OfferType">
 <option value="Unspecified" selected="selected">Unspecified</option>
 <option value="FreeOffer">Free Offer</option>
 <option value="LowOffer">Low Offer</option>
 <option value="AddOffer">Add Offer</option>
 <option value="PercentageOffer">Percentage Offer</option>
 <option value="GroupOffer">Group Offer</option>
</select> 
```

在jQuery中

```
if (('filterby' in urlParams) && (urlParams['filterby'] == 'LowOffer')) {
    $("#OfferType").val("LowOffer");
    $('#OfferType option[value=LowOffer]').text('Low Offer');
     submitAjaxOffersSearch();
  } 
```

数据根据**val("LowOffer")**排序，但在下拉文本中不是 Show **text("LowOffer");**

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-15T18:28:02.773

```
$('#OfferType').val('LowOffer'); //sets the value
alert($('#OfferType option:selected').text()); //gets the text 
```

选择器 '#OfferType option:selected' 获取 id 为 OfferType (#OfferType) 的元素以及选择它们的选项 (option:selected)

[jQuery val()](http://www.google.co.uk/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&ved=0CDUQFjAA&url=http://api.jquery.com/val/&ei=KkZsUcyFJ4WV0AWljIGoDQ&usg=AFQjCNH-GtfNf_4YLXDtVLm7PPh0POeseA&sig2=4tMhpoaHD4w02rBXSt7HQw)

[jQuery 文本（）](http://www.google.co.uk/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&ved=0CDYQFjAA&url=http://api.jquery.com/text/&ei=AkZsUb3zKKKj0QWJsoDQDQ&usg=AFQjCNH_op1krIyMiANGFM-1-_RiNyug6w&sig2=dS4V_xy7Vci5hYwY79Vi2w)

# java - Java Json 程序没有显示任何输出

> ID：16019117
> 
> 赞同：1
> 
> 时间：2013-04-15T15:31:32.747
> 
> 标签：java, json

我想要做的是，当我导航到：

> http://api.rottentomatoes.com/api/public/v1.0/movies.json?apikey=[your_api_key]&q=Toy+Story+3&page_limit=1

它返回一个 JSON 响应。我想把它转换成 Java 对象。我正在使用杰克逊图书馆。这是我的数据类：

```
import org.codehaus.jackson.annotate.JsonIgnoreProperties;

@JsonIgnoreProperties(ignoreUnknown=true)
public class  Aman
{

public static class Title
{
    private String title;

    public String getTitle(){ return title; }

    public String setTitle(String s){ return title = s; }
}

private int id;
private int year;
private int total;

public void SetId(int i){ id = i; }

public void SetYear(int y){ year = y; }

public void SetTotal(int t){ total =t; }

public int GetId()
{
    return id;
}

public int GetYear()
{
    return year;
}

public int GetTotal()
{
    return total;
}
@Override
public String toString()
{
    return "Movies[total=" +total + "id=" + id + "year=" + year + "]";
}
} 
```

和我的映射器类：

```
import java.io.File;
import java.io.IOException;
import org.codehaus.jackson.JsonGenerationException;
import org.codehaus.jackson.map.JsonMappingException;
import org.codehaus.jackson.map.ObjectMapper;
import java.net.*;

public class Movie
{
     public static void main(String[] args) throws MalformedURLException, URISyntaxException, IOException {
 Aman a = new Aman();
 ObjectMapper mapper = new ObjectMapper();
 try
 {
 URL RT = new URL("http://api.rottentomatoes.com/api/public/v1.0/movies.json?apikey=gzscv4f8zqse75w94mmp37zz&q=Toy+Story+3&page_limit=1").toURI().toURL();
 a = mapper.readValue(RT, Aman.class);
    }catch(MalformedURLException u)
    {
        u.printStackTrace();
    }catch(URISyntaxException s)
    {
        s.printStackTrace();
    }catch(IOException i)
    {
        i.printStackTrace();
    }

}
} 
```

它显示我没有任何输出。难道我做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-15T16:05:07.507

您混合了基本的 Java 编程和 JSON 映射错误。首先，请记住在定义 Java 类时遵循[小写命名约定。](http://en.wikipedia.org/wiki/CamelCase)这不仅是最佳实践，更重要的是，如果您不遵循此模式（包括杰克逊） ，一些工具和库***将无法工作。***

至于您的 JSON 映射错误，在将 JSON 映射到 Java 对象时要记住的最重要的事情是 JSON 数据实际上是一个映射。它将键与值相关联，其中值可以是基元、对象或数组（集合）。因此，给定一个 JSON 结构，您必须查看每个键值的结构，然后决定该值是否应该在 Java 中表示为*原语*、*对象*或其中任何一个的*数组*。没有捷径可走，你将通过经验学习。这是一个例子：

```
{
    "total": 1,                          // maps to primitive, integer
    "movies": [                          // '[' marks the beginning of an array/collection
        {                                // '{' marks the beginning of an object
            "id": "770672122",           // maps to primitive, string
            "title": "Toy Story 3",
            "year": 2010,
            "mpaa_rating": "G",
            "runtime": 103,
            "release_dates": {          // each array object also contains another object
                "theater": "2010-06-18",
                "dvd": "2010-11-02"
            }
        }
    ]
} 
```

在映射上面的示例 JSON 时，您需要定义一个与最外层匹配的根对象`{`。让我们将此根对象称为 a `MovieResponse`。

```
public class MovieResponse {
} 
```

现在，遍历 JSON 数据，我们开始将所有 JSON 属性映射到 Java 属性：

```
@JsonIgnoreProperties(ignoreUnknown = true)
public class MovieResponse {
    private Integer total;        // map from '"total": 1'
    private List<Movie> movies;   // map from '"movies": [', remember, its a collection
} 
```

简单吧？但是当然，我们还需要为`Movie`类定义一个结构。再一次，走 JSON：

```
@JsonIgnoreProperties(ignoreUnknown = true)
public class Movie {
    private String id;            // map from '"id": "770672122"'
    private String title;         // map from '"title": "Toy Story 3"'
    private Integer year;
    @JsonProperty("mpaa_rating")
    private String mpaaRating;
    private Integer runtime;
    @JsonProperty("release_dates")
    private Release released;     // another object mapping!
} 
```

最后，映射表示发布日期的最内层对象：

```
public class Release {
    private String theater;
    private String dvd;
} 
```

就是这样，很直接。注意`@JsonProperty`在`Movie`类中的使用。它允许您将 JSON 中的属性映射到 Java 中具有不同名称的属性。另请注意，为简洁起见，上述每个类都省略了构造函数/设置器/获取器。`MovieResponse`在您的真实代码中，您将添加它们。最后，您将使用以下代码将示例 JSON 映射到 Java类：

```
MovieResponse response = new ObjectMapper().readValue(json, MovieResponse.class); 
```

# wpf - WPF 控件的附加属性

> ID：16019118
> 
> 赞同：1
> 
> 时间：2013-04-15T15:31:37.830
> 
> 标签：wpf, dependency-properties, attached-properties, system.reflection, snoop

我仍在致力于 WPF 应用程序的自动化测试。我需要按名称访问属性来实现这一点。

目前我想知道 WPF 控件的附加属性。我试图遍历 Button 对象的所有属性，认为我也可以找到附加属性。但我找不到他们。

因此，我使用 Snoop 进行了检查，它列出了许多属性，例如“KeyboardNavigation.AcceptsReturn”和“ToolTipManager.ToolTipKey”，它们应该附加属性 AFAIK。

我使用以下代码创建按钮“对象”的（附加）属性名称列表：

```
 Type^ type = object->GetType();
   while (type)
   {
      array<FieldInfo^>^ fi = type->GetFields(BindingFlags::DeclaredOnly | BindingFlags::Static | BindingFlags::Public);
      for (int i=0; i<fi->Length; i++)
      {
         DependencyProperty^ dp = dynamic_cast<DependencyProperty^>(fi[i]->GetValue(object));
         if (dp)
         {
            DependencyPropertyDescriptor^ dpd = DependencyPropertyDescriptor::FromProperty(dp, type);
            if (dpd->IsAttached)
            {
               propertyNames->Add(fi[i]->Name);
            }
         }
      }

      type = type->BaseType;
   } 
```

但是 IsAttached 始终为 false，并且生成的 lsit 为空。如果没有“IsAttached”检查，我会得到一个很好的属性列表，但没有任何预期的附加属性。

不反映以这种方式列出附加属性吗？

* * *

我想我现在更好地理解了附加属性的用法。但是我实际上无法解决我的问题。提到的本地枚举器仅获取在本地对象上设置的属性，而不是对象可用的*所有*属性。

请让我解释一下我的意图：我仅从附加属性的*名称*开始...我首先需要检查该附加属性是否存在（这可能意味着它是否已注册，对吗？）。然后我想获取附加属性的值，它可能是我的对象的本地设置值（如果设置了一个）或默认值。

目前我不知道如何检查附加属性是否存在。是否有一些功能提供*所有*可用附加属性的列表？我可以使用它来验证给定的属性名称并获取相应的属性对象。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T15:59:09.230

> 附加属性在几个方面不同于正常的依赖属性。最值得注意的是它们没有包装在 CLR 属性（即标准 .NET 属性）中。

查看[http://joshsmithonwpf.wordpress.com/2007/06/22/overview-of-attached-properties-in-wpf/](http://joshsmithonwpf.wordpress.com/2007/06/22/overview-of-attached-properties-in-wpf/)了解更多详情。

您可能想尝试使用 GetLocalValueEnumerator 来迭代您的属性[http://msdn.microsoft.com/en-us/library/system.windows.dependencyobject.getlocalvalueenumerator.aspx](http://msdn.microsoft.com/en-us/library/system.windows.dependencyobject.getlocalvalueenumerator.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T11:48:02.857

对不起，工作一直让我很忙。你可以这样做：

假设 xaml：

```
<Grid>
    <Grid.RowDefinitions>
        <RowDefinition/>
        <RowDefinition/>
    </Grid.RowDefinitions>
    <Grid.ColumnDefinitions>
        <ColumnDefinition/>
        <ColumnDefinition/>
    </Grid.ColumnDefinitions>

    <Button x:Name="btn" Grid.Column="1"/>

</Grid> 
```

以下代码应该为您提供一些选项：

```
 //do this if you can:
    btn.GetValue(Grid.ColumnProperty);

    //Otherwise,
    //gets all the dependency properties in the app domain
    Type depType = typeof(DependencyProperty) ;
    FieldInfo info = depType.GetField("PropertyFromName", BindingFlags.NonPublic | BindingFlags.Static);
    Hashtable AllDependencyProperties = info.GetValue(null) as Hashtable;

    //Index the hashtable of all dependency properties using a FromNameKey type            
    Type FromNameKeyType = depType.Assembly.GetType("System.Windows.DependencyProperty+FromNameKey");            
    ConstructorInfo ctor = FromNameKeyType.GetConstructor(new Type[] { typeof(String), typeof(Type) });
    var NameKey = ctor.Invoke(new object[] { "Column", typeof(Grid) });

    //index the hashtable to get the Dependency property
    DependencyProperty dp = AllDependencyProperties[NameKey] as DependencyProperty;

    //use the dp to get the value
    btn.GetValue(dp);

    //Or, without indexing a list of all dependency properties
    //get a dependency property by name
    System.Reflection.MethodInfo FromNameMethod = depType.GetMethod("FromName",System.Reflection.BindingFlags.Static | System.Reflection.BindingFlags.NonPublic );
    var ret = FromNameMethod.Invoke(null, new object[] { "Column", typeof(Grid) });

    //use it to get a value from an object
    btn.GetValue((ret as DependencyProperty)); 
```

警告：这是使用私有成员和类，MS 很可能在未来的某个版本中进行更改。

# xml - 使用批处理脚本替换 XML 中的双反斜杠

> ID：16019123
> 
> 赞同：2
> 
> 时间：2013-04-15T15:31:45.400
> 
> 标签：xml, batch-file

我有一个包含以下内容的 xml 文件：

`<setParameter value="\\deveserver\d$\Websites\anime" name="IIS Web Application Name"/>`

我想编写一个批处理脚本来搜索这个`\\deveserver\d$\Websites\anime`字符串（它保存在一个名为 的变量中`CurrentFolder`）并将其替换为输入的任何输入。

我将输入的路径保存在变量中，`DestinationFolder`

```
SET DestinationFldr=
SET /p DestinationFldr=Enter Destination path: 
```

我检查的任何替换和文本帖子似乎都不起作用。我认为它无法识别双反斜杠。请帮忙。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T16:15:34.573

```
@ECHO off
SETLOCAL
SET "currentfolder=\\deveserver\d$\Websites\anime"
SET "DestinationFldr=some\variety\of\input"
(
FOR /f "delims=" %%i IN ('type aninput.xml^|findstr /n /r "$" ') DO (
 SET line=%%i
  SETLOCAL ENABLEDELAYEDEXPANSION
  SET line=!line:*:=!
  IF DEFINED line (ECHO(!line:%currentfolder%=%destinationfldr%!) ELSE (ECHO()
  endlocal
)
)>anoutput.xml

FC aninput.xml anoutput.xml 
```

`currentfolder`按指定设置并设置为`destfldr`一些字符串以模拟输入，

*   将每一行读入`%%i`并用前导编号`number :`- 包括空行
*   将值分配给`line`
*   启动一个 setlocal 延迟扩展帧
*   删除`line`最多并包括第一个冒号的部分（即插入的行号`findstr`
*   如果`line`仍被定义，`echo`则将其替换为字符串；否则`echo`为空行
*   关闭 setlocal 框架

FC inputfile outputfile 显示更改

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T16:03:10.937

如果你有`<setParameter value="\\deveserver\d$\Websites\anime" name="IIS Web Application Name"/>`你`file.xml`可以使用这个代码：

```
@echo off&setlocal
set "CurrentFolder=\\deveserver\d$\Websites\anime"

for /f "delims=" %%i in (file.xml) do set "html=%%i"
SET DestinationFldr=
SET /p "DestinationFldr=Enter Destination path: "
setlocal enabledelayedexpansion
set "html=!html:%CurrentFolder%=%DestinationFldr%!"
echo html: !html! 
```

测试和输出：

```
Enter Destination path: \\myserver\&&\othersites\adele
html: <setParameter value="\\myserver\&&\othersites\adele" name="IIS Web Application Name"/> 
```

# svn - How to Replace a Trunk with a Branch using TortoiseSVN?

> ID：16019124
> 
> 赞同：12
> 
> 时间：2013-04-15T15:31:48.670
> 
> 标签：svn, version-control, tortoisesvn

Is it possible to replace the trunk with a branch using TortoiseSVN?

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-15T15:37:12.593

Move the current trunk to some other place (/branch/oldtrunk), then move /branch/mybranch to /trunk, then move /branch/oldtrunk to /branch

With the command line client, this can be done with:

```
svn mv http://path/to/repo/trunk http://path/to/repo/branch/oldtrunk
svn mv http://path/to/repo/branch/mybranch http://path/to/repo/trunk
svn mv http://path/to/repo/branch/oldtrunk http://path/to/repo/branch/mybranch 
```

Good luck!

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T08:03:40.910

From Tortoise svn, You can go to trunk, right click and select Copy to.

then, it will ask the url. So, you can put your branch url there.

# java - java.lang.NoSuchMethodError: at.project.entity.booking.Booking.getOrCreateDayDetail

> ID：16019125
> 
> 赞同：0
> 
> 时间：2013-04-15T15:31:54.983
> 
> 标签：java, maven, deployment, glassfish

我们有一个带有后端和前端的 Maven 项目。后端包含用于查询数据库和 EJB 的业务对象（实体管理器）。前端是用户界面。我们在 frontend-pom 中有一个来自后端的 jar 依赖项，所以当部署 war 文件时，它里面有 backend.jar。

一切正常，我可以查看 UI，但我无法在后端调用自周五以来所做的更改。例如我添加了一个方法

```
public BookingDayDetail getOrCreateDayDetail(Date eventDate, String startTime, String endTime) 
```

当我想在前端调用它时，它会抛出

```
[#|2013-04-15T15:09:51.845+0000|SEVERE|glassfish3.1.2|com.vaadin.server.DefaultErrorHandler|_ThreadID=105;_ThreadName=Thread-2;|java.lang.NoSuchMethodError: at.project.entity.booking.Booking.getOrCreateDayDetail(Ljava/util/Date;Ljava/lang/String;Ljava/lang/String;)Lat/project/entity/booking/BookingDayDetail;
    at at.project.application.booking.BookingStartPanel.buildModel(BookingStartPanel.java:258)
    at at.project.application.booking.BookingStartPanel.commit(BookingStartPanel.java:763)
    at at.project.application.booking.BookingWindow$1.beforeViewChange(BookingWindow.java:118)
    at com.vaadin.navigator.Navigator.fireBeforeViewChange(Navigator.java:592)
    at com.vaadin.navigator.Navigator.navigateTo(Navigator.java:550)
    at com.vaadin.navigator.Navigator.navigateTo(Navigator.java:523)
    at at.project.application.booking.BookingWindow$BookingMenuCommand.menuSelected(BookingWindow.java:232)
    at com.vaadin.ui.MenuBar.changeVariables(MenuBar.java:178)
    at com.vaadin.server.AbstractCommunicationManager.changeVariables(AbstractCommunicationManager.java:1889)
    at com.vaadin.server.AbstractCommunicationManager.handleBurst(AbstractCommunicationManager.java:1693)
    at com.vaadin.server.AbstractCommunicationManager.handleVariables(AbstractCommunicationManager.java:1566)
    at com.vaadin.server.AbstractCommunicationManager.handleUidlRequest(AbstractCommunicationManager.java:582)
    at com.vaadin.server.VaadinPortlet.handleRequest(VaadinPortlet.java:483)
    at com.vaadin.server.VaadinPortlet.serveResource(VaadinPortlet.java:648)
    at com.liferay.portlet.FilterChainImpl.doFilter(FilterChainImpl.java:118)
    at com.liferay.portal.kernel.portlet.PortletFilterUtil.doFilter(PortletFilterUtil.java:71)
    at com.liferay.portal.kernel.servlet.PortletServlet.service(PortletServlet.java:111)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:770)
    at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1550)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:343)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:217)
    at com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilterChain.doFilter(InvokerFilterChain.java:72)
    at com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilter.doFilter(InvokerFilter.java:73)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:256)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:217)
    at org.apache.catalina.core.ApplicationDispatcher.doInvoke(ApplicationDispatcher.java:807)
    at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:671)
    at org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:505)
    at org.apache.catalina.core.ApplicationDispatcher.doDispatch(ApplicationDispatcher.java:476)
    at org.apache.catalina.core.ApplicationDispatcher.dispatch(ApplicationDispatcher.java:355)
    at org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:305)
    at com.liferay.portlet.InvokerPortletImpl.invoke(InvokerPortletImpl.java:531)
    at com.liferay.portlet.InvokerPortletImpl.invokeResource(InvokerPortletImpl.java:626)
    at com.liferay.portlet.InvokerPortletImpl.serveResource(InvokerPortletImpl.java:436)
    at com.liferay.portal.action.LayoutAction.processPortletRequest(LayoutAction.java:1075)
    at com.liferay.portal.action.LayoutAction.processLayout(LayoutAction.java:719)
    at com.liferay.portal.action.LayoutAction.execute(LayoutAction.java:249)
    at org.apache.struts.action.RequestProcessor.processActionPerform(RequestProcessor.java:431)
    at org.apache.struts.action.RequestProcessor.process(RequestProcessor.java:236)
    at com.liferay.portal.struts.PortalRequestProcessor.process(PortalRequestProcessor.java:176)
    at org.apache.struts.action.ActionServlet.process(ActionServlet.java:1196)
    at org.apache.struts.action.ActionServlet.doPost(ActionServlet.java:432)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:688)
    at com.liferay.portal.servlet.MainServlet.callParentService(MainServlet.java:560)
    at com.liferay.portal.servlet.MainServlet.service(MainServlet.java:537)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:770)
    at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1550)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:343)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:217)
    at com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilterChain.doFilter(InvokerFilterChain.java:72)
    at com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilterChain.doFilter(InvokerFilterChain.java:116)
    at com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilterChain.doFilter(InvokerFilterChain.java:116)
    at com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilterChain.doFilter(InvokerFilterChain.java:116)
    at com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilterChain.doFilter(InvokerFilterChain.java:116)
    at com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilterChain.doFilter(InvokerFilterChain.java:116)
    at com.liferay.portal.kernel.servlet.BaseFilter.processFilter(BaseFilter.java:163)
    at com.liferay.portal.servlet.filters.secure.SecureFilter.processFilter(SecureFilter.java:294)
    at com.liferay.portal.kernel.servlet.BaseFilter.doFilter(BaseFilter.java:57)
    at com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilterChain.processDoFilter(InvokerFilterChain.java:206)
    at com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilterChain.doFilter(InvokerFilterChain.java:108)
    at com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilter.doFilter(InvokerFilter.java:73)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:256)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:217)
    at org.apache.catalina.core.ApplicationDispatcher.doInvoke(ApplicationDispatcher.java:807)
    at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:671)
    at org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:505)
    at org.apache.catalina.core.ApplicationDispatcher.doDispatch(ApplicationDispatcher.java:476)
    at org.apache.catalina.core.ApplicationDispatcher.dispatch(ApplicationDispatcher.java:355)
    at org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:305)
    at com.liferay.portal.servlet.FriendlyURLServlet.service(FriendlyURLServlet.java:138)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:770)
    at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1550)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:343)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:217)
    at com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilterChain.doFilter(InvokerFilterChain.java:72)
    at com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilterChain.doFilter(InvokerFilterChain.java:116)
    at com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilterChain.doFilter(InvokerFilterChain.java:116)
    at com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilterChain.doFilter(InvokerFilterChain.java:116)
    at com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilterChain.doFilter(InvokerFilterChain.java:116)
    at com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilterChain.doFilter(InvokerFilterChain.java:116)
    at com.liferay.portal.kernel.servlet.BaseFilter.processFilter(BaseFilter.java:163)
    at com.liferay.portal.servlet.filters.secure.SecureFilter.processFilter(SecureFilter.java:294)
    at com.liferay.portal.kernel.servlet.BaseFilter.doFilter(BaseFilter.java:57)
    at com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilterChain.processDoFilter(InvokerFilterChain.java:206)
    at com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilterChain.doFilter(InvokerFilterChain.java:108)
    at com.liferay.portal.kernel.servlet.BaseFilter.processFilter(BaseFilter.java:163)
    at com.liferay.portal.servlet.filters.i18n.I18nFilter.processFilter(I18nFilter.java:241)
    at com.liferay.portal.kernel.servlet.BaseFilter.doFilter(BaseFilter.java:57)
    at com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilterChain.processDoFilter(InvokerFilterChain.java:206)
    at com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilterChain.doFilter(InvokerFilterChain.java:108)
    at com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilterChain.doFilter(InvokerFilterChain.java:116)
    at com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilterChain.doFilter(InvokerFilterChain.java:116)
    at com.liferay.portal.kernel.servlet.BaseFilter.processFilter(BaseFilter.java:163)
    at com.liferay.portal.servlet.filters.etag.ETagFilter.processFilter(ETagFilter.java:56)
    at com.liferay.portal.kernel.servlet.BaseFilter.doFilter(BaseFilter.java:57)
    at com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilterChain.processDoFilter(InvokerFilterChain.java:206)
    at com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilterChain.doFilter(InvokerFilterChain.java:108)
    at com.liferay.portal.kernel.servlet.BaseFilter.processFilter(BaseFilter.java:163)
    at com.liferay.portal.servlet.filters.autologin.AutoLoginFilter.processFilter(AutoLoginFilter.java:246)
    at com.liferay.portal.kernel.servlet.BaseFilter.doFilter(BaseFilter.java:57)
    at com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilterChain.processDoFilter(InvokerFilterChain.java:206)
    at com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilterChain.doFilter(InvokerFilterChain.java:108)
    at com.liferay.portal.kernel.servlet.BaseFilter.processFilter(BaseFilter.java:163)
    at com.liferay.portal.servlet.filters.sso.ntlm.NtlmPostFilter.processFilter(NtlmPostFilter.java:83)
    at com.liferay.portal.kernel.servlet.BaseFilter.doFilter(BaseFilter.java:57)
    at com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilterChain.processDoFilter(InvokerFilterChain.java:206)
    at com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilterChain.doFilter(InvokerFilterChain.java:108)
    at com.liferay.portal.kernel.servlet.BaseFilter.processFilter(BaseFilter.java:163)
    at com.liferay.portal.sharepoint.SharepointFilter.processFilter(SharepointFilter.java:80)
    at com.liferay.portal.kernel.servlet.BaseFilter.doFilter(BaseFilter.java:57)
    at com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilterChain.processDoFilter(InvokerFilterChain.java:206)
    at com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilterChain.doFilter(InvokerFilterChain.java:108)
    at com.liferay.portal.kernel.servlet.BaseFilter.processFilter(BaseFilter.java:163)
    at com.liferay.portal.servlet.filters.virtualhost.VirtualHostFilter.processFilter(VirtualHostFilter.java:216)
    at com.liferay.portal.kernel.servlet.BaseFilter.doFilter(BaseFilter.java:57)
    at com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilterChain.processDoFilter(InvokerFilterChain.java:206)
    at com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilterChain.doFilter(InvokerFilterChain.java:108)
    at com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilterChain.processDirectCallFilter(InvokerFilterChain.java:187)
    at com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilterChain.doFilter(InvokerFilterChain.java:95)
    at com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilterChain.doFilter(InvokerFilterChain.java:116)
    at com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilterChain.doFilter(InvokerFilterChain.java:116)
    at com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilterChain.doFilter(InvokerFilterChain.java:116)
    at com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilterChain.doFilter(InvokerFilterChain.java:116)
    at org.tuckey.web.filters.urlrewrite.UrlRewriteFilter.doFilter(UrlRewriteFilter.java:738)
    at com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilterChain.processDoFilter(InvokerFilterChain.java:206)
    at com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilterChain.doFilter(InvokerFilterChain.java:108)
    at com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilterChain.processDirectCallFilter(InvokerFilterChain.java:167)
    at com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilterChain.doFilter(InvokerFilterChain.java:95)
    at com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilterChain.doFilter(InvokerFilterChain.java:116)
    at com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilterChain.processDirectCallFilter(InvokerFilterChain.java:167)
    at com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilterChain.doFilter(InvokerFilterChain.java:95)
    at com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilterChain.doFilter(InvokerFilterChain.java:116)
    at com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilterChain.processDirectCallFilter(InvokerFilterChain.java:187)
    at com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilterChain.doFilter(InvokerFilterChain.java:95)
    at com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilter.doFilter(InvokerFilter.java:73)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:256)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:217)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:279)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)
    at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:655)
    at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:595)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:161)
    at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:331)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:231)
    at com.sun.enterprise.v3.services.impl.ContainerMapper$AdapterCallable.call(ContainerMapper.java:317)
    at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:195)
    at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:849)
    at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:746)
    at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1045)
    at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:228)
    at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
    at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
    at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
    at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
    at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
    at java.lang.Thread.run(Thread.java:722)} 
```

我们是一个具有相同设置的小团队，所以它必须与我的配置有关。我还重新安装了应用程序服务器（glassfish）——真的不知道我还能做什么。我的工作区也只包含项目的这个设置，没有其他旧版本。你有什么想法？

我会很感激:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T15:40:41.637

尝试

```
mvn clean install 
```

此外，删除您的 IDE 创建的构建文件夹。例如构建、bin、目标。根据您的构建脚本，可能还需要从 ${user.home}/.m2/repository 中删除旧应用程序

# php - PHP DateTime 异常和错误处理

> ID：16019126
> 
> 赞同：17
> 
> 时间：2013-04-15T15:31:56.570
> 
> 标签：php, datetime

创建 DateTime 对象时如何防止 PHP 崩溃？

```
$in = new DateTime($in);
$out = new DateTime($out); 
```

`$in`两者`$out`都来自一种形式，因此它们可以是任何东西。我强制用户使用日历并使用 javascript 将其阻止为日期。如果用户可以绕过这个检查呢？

如果`$in = "anything else other than a date"`PHP 会崩溃并阻塞整个页面的渲染。

`return(0)`如果 PHP 无法解析日期，我该如何防止这种情况发生？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-04-15T15:35:42.700

查看 上的文档`DateTime()`，这里有一个小片段：

```
<?php
try {
    $date = new DateTime('2000-01-01');
} catch (Exception $e) {
    echo $e->getMessage();
    exit(1);
}

echo $date->format('Y-m-d');
?> 
```

[PHP 手册 DateTime::__construct()](http://php.net/manual/en/datetime.construct.php)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-15T15:35:16.027

[`strtotime()`](http://php.net/manual/en/function.strtotime.php)如果格式错误，将返回 false，因此这*应该*会捕获错误的格式。

```
if (strtotime($in) === false)
{
     // bad format
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-04-15T15:35:36.983

异常处理呢？

```
try {
    $in = new DateTime($in);
} catch (Exception $e) {
    echo $e->getMessage();
    return(0);
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-04-15T15:35:37.497

如果无法解析日期/时间字符串，构造函数将抛出异常`DateTime` [。](http://www.php.net/manual/en/datetime.construct.php)你可以抓住它。看看下面的代码片段：

```
try   {
    $dt = new DateTime('10th - 12th June 2013'); // bad date string
} catch (Exception $e) {
    var_dump($e->getMessage());
} 
```

# java - WebService 在 WebLogic 10.3 中不“可见”

> ID：16019132
> 
> 赞同：5
> 
> 时间：2013-04-15T15:32:17.270
> 
> 标签：java, web-services, spring, web.xml, weblogic-10.x

我目前正试图让我的应用程序提供网络服务。该应用程序使用 spring 并在 Weblogic 10.3 实例下运行。

我按照“合同优先”的方法构建了 Web 服务。所以我基本上拥有的是一个生成的 WS-Interface，我对该接口的实现，一个定义 servlet-bindings 的 web.xml 和一个定义端点的 sun-jaxws.xml。（或多或少类似于：[http](http://www.mkyong.com/webservices/jax-ws/deploy-jax-ws-web-services-on-tomcat/) ://www.mkyong.com/webservices/jax-ws/deploy-jax-ws-web-services-on-tomcat/ ）。

现在，在将我的应用程序部署到 weblogic 之后，实际上一切正常。我可以在浏览器中输入 WebService 的 URL，我看到 WSDL，我可以调用它的方法。如果这不是一个小的装饰事实：当我单击部署时，在 WL 的部署概述中，它向我显示了一个 WebServices 列表......它是空的。所以我的网络服务没有在那里列出。

那么，谁能告诉我，我必须做些什么才能让网络服务出现在那里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-05-26T22:59:30.463

尽管拥有 JAX-WS 的 Web 服务描述符并不是真正必要的，但 Weblogic 有时无法识别 Web 服务（无法找到原因）

以下是我为使其正常工作所做的工作。在 web.xml 中添加 WebService 实现类作为 Servlet

```
<?xml version='1.0' encoding='UTF-8'?>
<web-app xmlns="http://java.sun.com/xml/ns/j2ee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" version="2.4" id="WebApp_ID">
  <display-name>MyWebService</display-name>
  <servlet>
    <servlet-name>serviceServlet</servlet-name>
    <servlet-class>com.aneesh.WebServiceImpl</servlet-class>
    <load-on-startup>0</load-on-startup>
  </servlet>
  <servlet-mapping>
    <servlet-name>serviceServlet</servlet-name>
    <url-pattern>/Service</url-pattern>
  </servlet-mapping>
</web-app> 
```

并添加 web 服务描述符 (webservices.xml)

```
<?xml version='1.0' encoding='UTF-8'?>
<webservices xmlns="http://java.sun.com/xml/ns/j2ee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" version="1.1">
  <webservice-description>
    <webservice-description-name>MyWebService</webservice-description-name>
    <port-component>
      <port-component-name>MyWebServiceSoapPort</port-component-name>
      <wsdl-port xmlns:an="http://www.aneesh.com/service">an:MyWebServiceSoapPort</wsdl-port>
      <service-endpoint-interface>com.aneesh.WebService</service-endpoint-interface>
      <service-impl-bean>
        <servlet-link>serviceServlet</servlet-link>
      </service-impl-bean>
    </port-component>
  </webservice-description>
</webservices> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T16:01:49.183

> 根据创建 Web 服务的开发人员的不同，部署描述符（例如`webservices.xml`和`weblogic-webservices.xml`）被添加到应用程序中。描述符用于配置、覆盖默认设置和添加元数据。对于 Web 服务，这可以是端点、端口配置、Web 服务与 EJB 组件的链接等等。部署后，Web 服务的 WSDL 位置会列在 WebLogic 控制台中，并且可以在运行时检索 WSDL。

[*从战壕 2 | 将 OSB 和 SOA 套件修补到 PS5*](http://blog.vennster.nl/2013/02/from-trenches-2-patching-osb-and-soa.html)

也可以看看：

*   [WebLogic Web 服务部署描述符元素参考](http://docs.oracle.com/cd/E23943_01/web.1111/e13750/dd.htm)
*   [为 Oracle WebLogic Server 开发基于 Spring 的应用程序](http://docs.oracle.com/cd/E12839_01/web.1111/e14453/appdev.htm)

# javascript - 在不刷新页面的情况下设置 cookie

> ID：16019135
> 
> 赞同：7
> 
> 时间：2013-04-15T15:32:31.440
> 
> 标签：javascript, asp.net-mvc, cookies

当用户第一次访问特定页面时，我正在显示 jQuery 覆盖

他们在叠加层中有一个单选按钮，他们可以单击以表示他们不想再次看到通知

我想设置一个用户不想再次看到覆盖的cookie

是否可以在不刷新页面的情况下设置 cookie？

我打算对服务器进行 ajax 回调，然后在响应标头中设置 cookie，但我猜他们不会在 Ajax 请求/响应中设置？

纯粹从 javascript 设置 cookie 是否安全/可以？或者这是一个坏主意？

还有其他选择吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T15:50:27.300

AJAX 调用没有理由不能设置 cookie。它基本上只是一个 HTTP 请求。

[AJAX 请求像任何其他 HTTP 请求一样获取和设置 Cookie](http://www.bennadel.com/blog/1995-AJAX-Requests-Get-And-Set-Cookies-Like-Any-Other-HTTP-Request.htm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T15:37:27.103

您可以使用[jQuery Cookie 插件](https://github.com/carhartl/jquery-cookie)。

一些例子：

```
function setCookieFilters() {
    var $filtersContent = $(".dynamic-filters");
    if ($filtersContent.length > 0) {
        if ($filtersContent.css("display") == "none") {
            $.cookie("isUsingFilters", "true", { expires: 7 });
        }
        else {
            $.cookie("isUsingFilters", "false", { expires: 7 });
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T15:42:04.083

您也可以在普通的旧 javascript 中获取/设置 cookie： [创建和存储 Cookie](http://www.w3schools.com/js/js_cookies.asp "创建和存储 Cookie")

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-05-04T19:30:38.927

使用这个：这将重新加载页面。

```
setcookie($data,$item_data, time()+ (3600));
echo "<script>location.href='index.php'</script>; 
```

# ios - NSManagedObjectContext 的 Save 方法性能

> ID：16019146
> 
> 赞同：0
> 
> 时间：2013-04-15T15:33:14.627
> 
> 标签：ios, performance, core-data, save, nsmanagedobjectcontext

我正在优化我的第一个 iOS 应用程序，然后才进入商店，并注意那些看似花费大量时间的方法。我有一个相当简单的主从应用程序，其中来自 Core Data SQLite 的实体显示在 a 中`UITableView`，然后点击一个会显示一个详细视图，用户可以在其中将其标记为收藏（`BOOL`在该对象中设置一个标志为`YES`。他们点击了他们最喜欢的按钮，我打电话`[NSManagedObjectContext save]`以确保他们的更改立即得到反映，并且在计划外终止的情况下，等等。

在我的 iPhone 4S 上进行测试时，此`save`操作目前大约需要 205 毫秒。数据库中有大约 4,500 个条目，每个条目都有一些字符串和一些布尔值（包装在`NSNumber`s 中）。

第一个问题：**进行此更改是否需要 200 毫秒？**我只设置一个布尔值，然后保存上下文，但我以前从未使用过 Core Data，所以我不知道这是否正常。

第二个问题：**我正在使用的代码如下 - 我在代码中做错了什么以使方法需要这么长时间才能执行吗？**

```
- (IBAction) makeFavorite: (id) sender
{
    [self.delegate detailViewControllerDidMakeFavorite];
    [_selectedLine setIsLiked: [NSNumber numberWithBool: YES]];
    [_selectedLine setIsDisliked: [NSNumber numberWithBool: NO]];
    NSError *error;
    if (![[[CDManager sharedManager] managedObjectContext] save:&error]) NSLog(@"Saving changes failed: %@, %@", error, [error userInfo]);
} 
```

也许我什么都不担心（我仍然是一个相对较新的程序员），但更广泛地说，200 毫秒足以让我至少尝试解决这个问题，对吧？:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T19:04:58.040

Consider `UIManagedDocument`. It automatically handles saving in a background context. I especially recommend it if you are on iOS 6\. If you are not passing object IDs around, or merging with other contexts, then you should be able to use it fairly easily and reliably.

Your simple use case seems tailor made for it.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T16:43:50.660

> > 1) 是否应该保存一次布尔值更改需要 200 毫秒？

是的，可能需要这么长时间。您正在执行 IO 操作并根据[文档](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CoreData/Articles/cdPersistentStores.html)：

> > When Core Data saves a SQLite store, SQLite updates just part of the store file. Loss of that partial update would be catastrophic, so you may want to ensure that the file is written correctly before your application continues. Unfortunately, doing so means that in some situations saving even a small set of changes to an SQLite store can take considerably longer than saving to, say, an XML store.

-

> > 2) am I doing something wrong in the code to make the method take this long to execute?

No. you are making the save to the store (under the assumption you have no parent context).

-

> > 3) Are 200ms enough for me to at least try to address this issue?

Yes. 200ms are a noticeable time for a human, and will be felt. you could try and perform the save in the background, but this is unsafe according to the [documentation](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CoreData/Articles/cdConcurrency.html#//apple_ref/doc/uid/TP40003385-SW7). or, move it to the end of the entire object editing.

My advise would be to read and see if you could make some compromises in your context architecture (your CoreData stack structure).
From my experience, saving in the background is not that bad.

# python - 在线程中运行的类中的 Python 新数据

> ID：16019148
> 
> 赞同：0
> 
> 时间：2013-04-15T15:33:21.303
> 
> 标签：python

所以我试图理解线程 - 并认为我从这样的事情开始：

一个类或它的一部分在线程中运行 - 并不时为其提供新数据以供使用，这里只是打印。

然而，它似乎并没有真正更新数据......实际上 - 它似乎在线程开始后卡住并且没有做任何其他事情？

这是我尝试过的：

```
class Test:
    def __init__(self, num):
        self.num = num

    def printnum(self):
        print("Num is: " + str(self.num))

    def printloop(self):
        while True:
            print(self.num)
            time.sleep(1)

    def setnum(self, num):
        self.num = num

test = Test(123)
test.printnum() 
time.sleep(2)

test.setnum(123456)
test.printnum() 
time.sleep(2)

threading.Thread(target=test.printloop()).start()

time.sleep(5)
test.setnum(31245)
test.printnum() 

time.sleep(5)
test1.setcount(532556663)
test.printnum() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T15:37:11.660

在您的`threading.Thread`构造函数中，您正在*调用*该`printloop`方法。您需要在不调用它的情况下传递它，因此请删除括号：

```
threading.Thread(target=test.printloop()).start()
                                      ~~ <-- remove these 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T15:42:25.770

我认为您需要将其更改为：

```
Threading.Thread(printloop).start() 
```

即将它从 printloop() 更改为 printloop。这会将函数作为对象传递给 Thread 执行。目前您正在评估 printloop() 并且 Thread() 方法期望 printloop() 为其返回一个新函数！

此外，当您将数据传递到新线程时，您可能会遇到重大困难 - 您可能需要锁定以确保消息不会丢失/损坏。查看本教程以了解如何执行此操作（同步线程）：

[http://www.tutorialspoint.com/python/python_multithreading.htm](http://www.tutorialspoint.com/python/python_multithreading.htm)

# jquery - 想要替换父 div 范围内的文本

> ID：16019149
> 
> 赞同：5
> 
> 时间：2013-04-15T15:33:21.867
> 
> 标签：jquery

我有我的html结构

```
 <div>
   <div class="comments-title-wr clearFix">
    <span id="commentsSize" class="comments-title">Some Text</span>
    </div>

    <div id="testId">

    </div>

 </div> 
```

我可以检索`testId`并使用它来替换`<span>`标签内的文本。

我尝试使用

```
 $('#testId').parent().closest('.comments-title').text().replace('something else'); 
```

但它不工作

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T15:35:00.010

你可能想要

```
$('#testId').parent().find('.comments-title').text('something else'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-15T15:35:24.417

试试这个，

**[现场演示](http://jsfiddle.net/PdXTd/)**

```
$('#testId').prev('.comments-title-wr.clearFix').find('.comments-title').text('something else'); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-15T15:40:08.580

```
$('#testId').prev().find('span').text('HI'); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-15T15:36:26.490

```
$('#testId').prev().children('span').text('something else'); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-15T15:36:34.143

您可以使用`siblings`. [http://api.jquery.com/siblings/](http://api.jquery.com/siblings/)

`.comments-title-wr`并且`#testId`是兄弟姐妹。不知何故错过了那个内部跨度，答案更新了。

```
$('#testId').siblings('.comments-title-wr').find('.comments-title').text('something else'); 
```

# c# - Linq 按语句分组

> ID：16019151
> 
> 赞同：0
> 
> 时间：2013-04-15T15:33:31.063
> 
> 标签：c#, linq

我尝试执行动态 linq 分组查询。第二个 linq 语句应该生成与第一个 linq 语句相同的结果。
谁能告诉我为什么第二个 linq 语句不起作用？

```
DataTable dt = new DataTable();
dt.Columns.Add("ID");
dt.Columns.Add("Name");
dt.Columns.Add("ProductName");

dt.Rows.Add("1", "aa", "TypeA");
dt.Rows.Add("2", "bb", "TypeA");
dt.Rows.Add("3", "cc", "TypeB"); 
```

第一个linq：

```
var lotSum = dt.AsEnumerable()
               .GroupBy(x => new 
                             { id = x.Field<string>("id")
                               , product = x.Field<string>("ProductName"), 
                             }
                       ).ToList(); 
```

第二个 Linq **// 不能工作？？**

```
var gcol = new string[] { "ID", "ProductName" };
var gtype = dt.Rows[0].GetType();
var lotSum2 = dt.AsEnumerable()
                .GroupBy(g => string.Join(",",  
            gcol.Select(c => gtype.GetProperty(c).GetValue(g, null)))).ToList(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T15:38:11.087

ID 和 ProductName 不是[DataRow](http://msdn.microsoft.com/en-us/library/system.data.datarow.aspx)的属性，它们是列的名称。您可以使用索引器访问它们... gcol.Select(c=>g[c])，假设 g 是 DataRow。

# orbeon - orbeon-form：日食项目

> ID：16019152
> 
> 赞同：0
> 
> 时间：2013-04-15T15:33:33.613
> 
> 标签：orbeon

只是尝试使用在 eclipse 中加载的 Orbeon API：

在重新配置构建路径并定义所有未更新的 jars 依赖项之后，我终于被这个未正确加载的 scala 类所困扰？

请问有什么帮助吗？

```
[scalac] /Developer/wksp_juno/orbeon-forms/src/main/java/org/orbeon/oxf/xforms/XFormsContainingDocument.java:62: error: not found: type XBLContainer
   [scalac] public class XFormsContainingDocument extends XBLContainer implements XFormsDocumentLifecycle, Cacheable, XFormsObject {
   [scalac]                                               ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/java/org/orbeon/oxf/resources/ResourceNotFoundException.java:21: error: not found: type OXFException
   [scalac] public class ResourceNotFoundException extends OXFException {
   [scalac]                                                ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/scala/org/orbeon/oxf/common/PEVersion.scala:57: error: fruitless type test: a value of type Throwable cannot also be a org.orbeon.oxf.resources.ResourceNotFoundException
   [scalac]                         case e: ResourceNotFoundException ?
   [scalac]                                 ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/java/org/orbeon/oxf/pipeline/api/ExternalContext.java:164: error: not found: type WebAppContext
   [scalac]     WebAppContext getWebAppContext();
   [scalac]     ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/java/org/orbeon/oxf/processor/ProcessorImpl.java:108: error: not found: type PropertySet
   [scalac]     protected PropertySet getPropertySet() {
   [scalac]               ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/scala/org/orbeon/oxf/controller/PageFlowControllerProcessor.scala:224: error: type mismatch;
   [scalac]  found   : Any
   [scalac]  required: String
   [scalac]                     Seq(PageOrServiceElement(None, submissionPath, Pattern.compile(submissionPath), None, submissionModel, None, configRoot, SubmissionPublicMethods, isPage = true))
   [scalac]                                                    ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/scala/org/orbeon/oxf/controller/PageFlowControllerProcessor.scala:275: error: could not find implicit value for parameter propertySet: org.orbeon.oxf.properties.PropertySet
   [scalac]                 case page: PageOrServiceElement ? PageOrServiceRoute(page, compile)
   [scalac]                                                                     ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/scala/org/orbeon/oxf/controller/PageFlowControllerProcessor.scala:91: error: fruitless type test: a value of type Throwable cannot also be a org.orbeon.oxf.resources.ResourceNotFoundException
   [scalac]                 case e: ResourceNotFoundException ? e.resource
   [scalac]                         ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/scala/org/orbeon/oxf/controller/PageFlowControllerProcessor.scala:171: error: fruitless type test: a value of type Throwable cannot also be a org.orbeon.oxf.resources.ResourceNotFoundException
   [scalac]                         case e: ResourceNotFoundException                        ? if (route.isPage) runNotFoundRoute(Some(t)) else sendNotFound(Some(t))
   [scalac]                                 ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/scala/org/orbeon/oxf/xforms/action/XFormsAPI.scala:219: error: value models is not a member of org.orbeon.oxf.xforms.XFormsContainingDocument
   [scalac]         containingDocument.models find (_.getId == modelId)
   [scalac]                            ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/java/org/orbeon/oxf/xforms/XFormsContainingDocument.java:591: error: not found: type RequestStats
   [scalac]     public RequestStats getRequestStats() {
   [scalac]            ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/scala/org/orbeon/oxf/xforms/model/DataModel.scala:181: error: value getInstanceForNode is not a member of org.orbeon.oxf.xforms.XFormsContainingDocument
   [scalac]         Option(containingDocument.getInstanceForNode(nodeInfo)) map (_.getEffectiveId)
   [scalac]                                   ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/scala/org/orbeon/oxf/xforms/model/DataModel.scala:190: error: value getInstanceForNode is not a member of org.orbeon.oxf.xforms.XFormsContainingDocument
   [scalac]         Option(containingDocument.getInstanceForNode(nodeInfo)) match {
   [scalac]                                   ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/scala/org/orbeon/oxf/xforms/model/DataModel.scala:193: error: value markModified is not a member of Any
   [scalac]                 modifiedInstance.markModified()
   [scalac]                                  ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/scala/org/orbeon/oxf/xforms/model/DataModel.scala:194: error: value model is not a member of Any
   [scalac]                 modifiedInstance.model.markValueChange(nodeInfo, isCalculate)
   [scalac]                                  ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/scala/org/orbeon/oxf/xforms/model/DataModel.scala:197: error: type mismatch;
   [scalac]  found   : Any
   [scalac]  required: org.orbeon.oxf.xforms.event.XFormsEventTarget
   [scalac]                 Dispatch.dispatchEvent(new XXFormsValueChangedEvent(modifiedInstance, nodeInfo, oldValue, newValue))
   [scalac]                                                                     ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/java/org/orbeon/oxf/xforms/XFormsModel.java:58: error: not found: type XFormsEventObserver
   [scalac] public class XFormsModel extends XFormsModelBase implements XFormsEventObserver, XFormsObjectResolver {
   [scalac]                                                             ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/java/org/orbeon/oxf/xforms/XFormsModel.java:210: error: not found: type Model
   [scalac]     public Model getStaticModel() {
   [scalac]            ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/scala/org/orbeon/oxf/fb/ControlOps.scala:581: error: constructor cannot be instantiated to expected type;
   [scalac]  found   : (T1, T2)
   [scalac]  required: Nothing
   [scalac]             controlId ? findControlIdByName(getFormDoc, controlName)
   [scalac]             ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/java/org/orbeon/oxf/xforms/XFormsModel.java:206: error: not found: type XBLContainer
   [scalac]     public XBLContainer container() {
   [scalac]            ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/java/org/orbeon/oxf/xforms/ControlTree.java:258: error: not found: type XFormsContainerControl
   [scalac]     public XFormsContainerControl getRoot() {
   [scalac]            ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/scala/org/orbeon/oxf/pipeline/InitUtils.scala:92: error: fruitless type test: a value of type Throwable cannot also be a org.orbeon.oxf.resources.ResourceNotFoundException
   [scalac]                     case e: ResourceNotFoundException ?
   [scalac]                             ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/java/org/orbeon/oxf/portlet/Portlet2ExternalContext.java:73: error: not found: type WebAppContext
   [scalac]     Portlet2ExternalContext(PipelineContext pipelineContext, WebAppContext webAppContext, PortletRequest portletRequest, boolean amendRequest) {
   [scalac]                                                              ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/scala/org/orbeon/oxf/processor/EmailProcessor.scala:74: error: could not find implicit value for parameter propertySet: org.orbeon.oxf.properties.PropertySet
   [scalac]             valueFromElementOrProperty(messageElement, SMTPHost) getOrElse
   [scalac]                                       ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/scala/org/orbeon/oxf/processor/EmailProcessor.scala:104: error: could not find implicit value for parameter propertySet: org.orbeon.oxf.properties.PropertySet
   [scalac]                 valueFromElementOrProperty(messageElement, Encryption) match {
   [scalac]                                           ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/scala/org/orbeon/oxf/processor/EmailProcessor.scala:134: error: could not find implicit value for parameter propertySet: org.orbeon.oxf.properties.PropertySet
   [scalac]             valueFromElementOrProperty(messageElement, SMTPPort) orElse defaultPort foreach updatePort
   [scalac]                                       ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/java/org/orbeon/oxf/servlet/ServletExternalContext.java:697: error: not found: type WebAppContext
   [scalac]     public ServletExternalContext(PipelineContext pipelineContext, WebAppContext webAppContext, HttpServletRequest request, HttpServletResponse response) {
   [scalac]                                                                    ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/scala/org/orbeon/oxf/xforms/xbl/XBLContainer.scala:76: error: fruitless type test: a value of type org.orbeon.oxf.xforms.xbl.XBLContainer cannot also be a org.orbeon.oxf.xforms.XFormsContainingDocument
   [scalac]     val containingDocument = ancestorsIterator collectFirst { case cd: XFormsContainingDocument ? cd } get
   [scalac]                                                                        ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/scala/org/orbeon/oxf/xforms/BindingContext.scala:166: error: value getInstanceForNode is not a member of org.orbeon.oxf.xforms.XFormsContainingDocument
   [scalac]             { case node: NodeInfo ? model.containingDocument.getInstanceForNode(node) } orNull
   [scalac]                                                              ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/scala/org/orbeon/oxf/xforms/XFormsInstance.scala:155: error: type mismatch;
   [scalac]  found   : org.orbeon.oxf.xforms.XFormsModel
   [scalac]  required: org.orbeon.oxf.xforms.event.XFormsEventObserver
   [scalac]     def parentEventObserver: XFormsEventObserver = model
   [scalac]                                                    ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/java/org/orbeon/oxf/xforms/ControlTree.java:280: error: not found: type XFormsControl
   [scalac]     public Map<String, XFormsControl> getRepeatControls() {
   [scalac]                        ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/scala/org/orbeon/oxf/xforms/XFormsInstance.scala:223: error: value getEffectiveId is not a member of type parameter B
   [scalac]                 newRepeatControl ? Option(controls.getObjectByEffectiveId(repeatControl.getEffectiveId).asInstanceOf[XFormsRepeatControl])
   [scalac]                                                                                         ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/java/org/orbeon/oxf/xforms/XFormsModel.java:65: error: not found: type Model
   [scalac]     public final Model staticModel;
   [scalac]                  ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/java/org/orbeon/oxf/xforms/analysis/XFormsExtractorContentHandler.java:138: error: not found: type AnnotatedTemplate
   [scalac]             AnnotatedTemplate templateUnderConstruction,
   [scalac]             ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/scala/org/orbeon/oxf/xforms/action/actions/XFormsSetindexAction.scala:62: error: value synchronizeAndRefresh is not a member of org.orbeon.oxf.xforms.XFormsContainingDocument
   [scalac]             interpreter.containingDocument.synchronizeAndRefresh()
   [scalac]                                            ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/java/org/orbeon/oxf/xforms/action/XFormsActionInterpreter.java:405: error: not found: type XFormsObject
   [scalac]     public XFormsObject resolveObject(Element actionElement, String targetStaticOrAbsoluteId) {
   [scalac]            ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/java/org/orbeon/oxf/xforms/XFormsControls.java:430: error: not found: type XFormsControl
   [scalac]     public XFormsControl getFocusedControl() {
   [scalac]            ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/java/org/orbeon/oxf/xforms/XFormsControls.java:434: error: not found: type XFormsControl
   [scalac]     public void setFocusedControl(XFormsControl focusedControl) {
   [scalac]                                   ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/java/org/orbeon/oxf/xforms/ControlTree.java:270: error: not found: type XFormsControl
   [scalac]     public XFormsControl getControl(String effectiveId) {
   [scalac]            ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/scala/org/orbeon/oxf/xforms/control/Focus.scala:120: error: value isFocusable is not a member of Any
   [scalac]                     case Some(newReference) if ! newReference.isFocusable ?
   [scalac]                                                               ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/scala/org/orbeon/oxf/xforms/control/Focus.scala:124: error: value ne is not a member of Any
   [scalac]                     case Some(newReference) if newReference ne focusedBefore ?
   [scalac]                                                             ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/scala/org/orbeon/oxf/xforms/control/Focus.scala:129: error: type mismatch;
   [scalac]  found   : Any
   [scalac]  required: org.orbeon.oxf.xforms.control.XFormsControl
   [scalac]                         onFocus(newReference)
   [scalac]                                 ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/scala/org/orbeon/oxf/xforms/action/XFormsAPI.scala:99: error: value >= is not a member of Nothing
   [scalac]                 { case newIndex if newIndex >= 0 ? newIndex }
   [scalac]                                             ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/java/org/orbeon/oxf/xforms/action/XFormsActionInterpreter.java:80: error: not found: type XBLContainer
   [scalac]     public XBLContainer container() {
   [scalac]            ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/java/org/orbeon/oxf/xforms/submission/XFormsModelSubmission.java:65: error: not found: type XFormsEventTarget
   [scalac] public class XFormsModelSubmission extends XFormsModelSubmissionBase implements XFormsEventTarget, XFormsEventObserver {
   [scalac]                                                                                 ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/java/org/orbeon/oxf/xforms/submission/XFormsModelSubmission.java:65: error: not found: type XFormsEventObserver
   [scalac] public class XFormsModelSubmission extends XFormsModelSubmissionBase implements XFormsEventTarget, XFormsEventObserver {
   [scalac]                                                                                                    ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/scala/org/orbeon/oxf/xforms/action/XFormsAPI.scala:269: error: type mismatch;
   [scalac]  found   : org.orbeon.oxf.xforms.submission.XFormsModelSubmission
   [scalac]  required: org.orbeon.oxf.xforms.event.XFormsEventTarget
   [scalac]         try Dispatch.dispatchEvent(new XFormsSubmitEvent(submission, properties))
   [scalac]                                                          ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/java/org/orbeon/oxf/xforms/control/controls/XFormsCaseControl.java:23: error: not found: type XFormsNoSingleNodeContainerControl
   [scalac] public class XFormsCaseControl extends XFormsNoSingleNodeContainerControl {
   [scalac]                                        ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/java/org/orbeon/oxf/xforms/control/controls/XXFormsDialogControl.java:31: error: not found: type XFormsNoSingleNodeContainerControl
   [scalac] public class XXFormsDialogControl extends XFormsNoSingleNodeContainerControl {
   [scalac]                                           ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/scala/org/orbeon/oxf/xforms/action/actions/XXFormsShowAction.scala:51: error: type mismatch;
   [scalac]  found   : org.orbeon.oxf.xforms.control.controls.XXFormsDialogControl
   [scalac]  required: org.orbeon.oxf.xforms.event.XFormsEventTarget
   [scalac]         val newEvent = new XXFormsDialogOpenEvent(properties, targetDialog, neighborEffectiveId.orNull, constrainToViewport)
   [scalac]                                                               ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/scala/org/orbeon/oxf/xforms/action/XFormsAction.scala:96: error: value synchronizeAndRefresh is not a member of org.orbeon.oxf.xforms.XFormsContainingDocument
   [scalac]             context.containingDocument.synchronizeAndRefresh()
   [scalac]                                        ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/java/org/orbeon/oxf/xforms/action/XFormsActionInterpreter.java:445: error: not found: type Scope
   [scalac]     public Scope getActionScope(Element actionElement) {
   [scalac]            ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/java/org/orbeon/oxf/xforms/XFormsContextStack.java:267: error: not found: type Scope
   [scalac]                             Element bindingElement, NamespaceMapping bindingElementNamespaceMapping, String sourceEffectiveId, Scope scope, boolean handleNonFatal) {
   [scalac]                                                                                                                                ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/java/org/orbeon/oxf/xforms/XFormsContextStack.java:244: error: not found: type Scope
   [scalac]     public void pushBinding(Element bindingElement, String sourceEffectiveId, Scope scope, boolean handleNonFatal) {
   [scalac]                                                                               ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/java/org/orbeon/oxf/xforms/XFormsContextStack.java:240: error: not found: type Scope
   [scalac]     public void pushBinding(Element bindingElement, String sourceEffectiveId, Scope scope) {
   [scalac]                                                                               ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/java/org/orbeon/oxf/xforms/XFormsContextStack.java:122: error: not found: value XFormsFunction
   [scalac]     public XFormsFunction.Context getFunctionContext(String sourceEffectiveId) {
   [scalac]            ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/java/org/orbeon/oxf/xforms/action/actions/XFormsLoadAction.java:30: error: not found: type XFormsAction
   [scalac] public class XFormsLoadAction extends XFormsAction {
   [scalac]                                       ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/java/org/orbeon/oxf/xforms/action/actions/XFormsResetAction.java:26: error: not found: type XFormsAction
   [scalac] public class XFormsResetAction extends XFormsAction {
   [scalac]                                        ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/java/org/orbeon/oxf/xforms/action/actions/XFormsMessageAction.java:32: error: not found: type XFormsAction
   [scalac] public class XFormsMessageAction extends XFormsAction {
   [scalac]                                          ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/java/org/orbeon/oxf/xforms/action/actions/XFormsInsertAction.java:42: error: not found: type XFormsAction
   [scalac] public class XFormsInsertAction extends XFormsAction {
   [scalac]                                         ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/java/org/orbeon/oxf/xforms/action/actions/XFormsDeleteAction.java:36: error: not found: type XFormsAction
   [scalac] public class XFormsDeleteAction extends XFormsAction {
   [scalac]                                         ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/java/org/orbeon/oxf/xforms/action/actions/XXFormsHideAction.java:25: error: not found: type XFormsAction
   [scalac] public class XXFormsHideAction extends XFormsAction {
   [scalac]                                        ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/java/org/orbeon/oxf/xforms/action/actions/XXFormsInvalidateInstanceAction.java:27: error: not found: type XFormsAction
   [scalac] public class XXFormsInvalidateInstanceAction extends XFormsAction {
   [scalac]                                                      ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/java/org/orbeon/oxf/xforms/action/actions/XXFormsInvalidateInstancesAction.java:25: error: not found: type XFormsAction
   [scalac] public class XXFormsInvalidateInstancesAction extends XFormsAction {
   [scalac]                                                       ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/java/org/orbeon/oxf/xforms/action/actions/XXFormsJoinSubmissions.java:21: error: not found: type XFormsAction
   [scalac] public class XXFormsJoinSubmissions extends XFormsAction {
   [scalac]                                             ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/scala/org/orbeon/oxf/xforms/action/actions/RRRActions.scala:30: error: type mismatch;
   [scalac]  found   : org.orbeon.oxf.xforms.XFormsModel
   [scalac]  required: org.orbeon.oxf.xforms.event.XFormsEventTarget
   [scalac]     def createEvent(model: XFormsModel, applyDefaults: Boolean) = new XFormsRebuildEvent(model)
   [scalac]                                                                                          ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/scala/org/orbeon/oxf/xforms/action/actions/RRRActions.scala:39: error: overloaded method constructor XFormsRecalculateEvent with alternatives:
   [scalac]   (target: org.orbeon.oxf.xforms.event.XFormsEventTarget,applyDefaults: Boolean)org.orbeon.oxf.xforms.event.events.XFormsRecalculateEvent <and>
   [scalac]   (target: org.orbeon.oxf.xforms.event.XFormsEventTarget,properties: org.orbeon.oxf.xforms.event.XFormsEvent.PropertyGetter)org.orbeon.oxf.xforms.event.events.XFormsRecalculateEvent
   [scalac]  cannot be applied to (org.orbeon.oxf.xforms.XFormsModel, Boolean)
   [scalac]     def createEvent(model: XFormsModel, applyDefaults: Boolean) = new XFormsRecalculateEvent(model, applyDefaults)
   [scalac]                                                                   ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/scala/org/orbeon/oxf/xforms/action/actions/RRRActions.scala:44: error: type mismatch;
   [scalac]  found   : org.orbeon.oxf.xforms.XFormsModel
   [scalac]  required: org.orbeon.oxf.xforms.event.XFormsEventTarget
   [scalac]     def createEvent(model: XFormsModel, applyDefaults: Boolean) = new XFormsRevalidateEvent(model)
   [scalac]                                                                                             ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/java/org/orbeon/oxf/xforms/XFormsContextStack.java:71: error: not found: type XBLContainer
   [scalac]     public final XBLContainer container;
   [scalac]                  ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/java/org/orbeon/oxf/xforms/XFormsContextStack.java:201: error: not found: type VariableAnalysisTrait
   [scalac]     public BindingContext.VariableInfo scopeVariable(VariableAnalysisTrait staticVariable, String sourceEffectiveId, boolean handleNonFatal) {
   [scalac]                                                      ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/java/org/orbeon/oxf/xforms/action/XFormsActionInterpreter.java:105: error: not found: type ElementAnalysis
   [scalac]     public void runAction(ElementAnalysis actionAnalysis) {
   [scalac]                           ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/scala/org/orbeon/oxf/xforms/action/actions/XFormsActionAction.scala:64: error: value execute is not a member of Object
   [scalac]             XFormsActions.getScriptAction.execute(actionContext)
   [scalac]                                           ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/scala/org/orbeon/oxf/xforms/action/actions/XFormsRefreshAction.scala:45: error: type mismatch;
   [scalac]  found   : org.orbeon.oxf.xforms.XFormsModel
   [scalac]  required: org.orbeon.oxf.xforms.event.XFormsEventTarget
   [scalac]         Dispatch.dispatchEvent(new XFormsRefreshEvent(model))
   [scalac]                                                       ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/scala/org/orbeon/oxf/xforms/action/actions/XFormsToggleAction.scala:31: error: fruitless type test: a value of type org.orbeon.oxf.xforms.control.XFormsControl cannot also be a org.orbeon.oxf.xforms.control.controls.XFormsCaseControl
   [scalac]             case Some(caseControl: XFormsCaseControl) ?
   [scalac]                                    ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/scala/org/orbeon/oxf/xforms/action/actions/XFormsToggleAction.scala:49: error: value synchronizeAndRefresh is not a member of org.orbeon.oxf.xforms.XFormsContainingDocument
   [scalac]             XFormsAPI.containingDocument.synchronizeAndRefresh()
   [scalac]                                          ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/scala/org/orbeon/oxf/xforms/action/actions/XFormsToggleAction.scala:51: error: value parent is not a member of org.orbeon.oxf.xforms.control.controls.XFormsCaseControl
   [scalac]         if (caseControl.parent.isRelevant && ! caseControl.isSelected) {
   [scalac]                         ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/java/org/orbeon/oxf/xforms/XFormsContainingDocument.java:1054: error: not found: type ScriptInterpreter
   [scalac]     public ScriptInterpreter getScriptInterpreter() {
   [scalac]            ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/java/org/orbeon/oxf/xforms/XFormsContainingDocument.java:787: error: not found: type XFormsEvent
   [scalac]     public void addScriptToRun(org.orbeon.oxf.xforms.Script script, XFormsEvent event, XFormsEventObserver eventObserver) {
   [scalac]                                                                     ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/java/org/orbeon/oxf/xforms/XFormsContainingDocument.java:787: error: not found: type XFormsEventObserver
   [scalac]     public void addScriptToRun(org.orbeon.oxf.xforms.Script script, XFormsEvent event, XFormsEventObserver eventObserver) {
   [scalac]                                                                                        ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/java/org/orbeon/oxf/xforms/action/XFormsActionInterpreter.java:55: error: not found: type XFormsEvent
   [scalac]     public final XFormsEvent event;
   [scalac]                  ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/java/org/orbeon/oxf/xforms/action/XFormsActionInterpreter.java:56: error: not found: type XFormsEventObserver
   [scalac]     public final XFormsEventObserver eventObserver;
   [scalac]                  ^
   [scalac] /Developer/wksp_juno/orbeon-forms/src/main/scala/org/orbeon/oxf/xforms/action/actions/XXFormsShowAction.scala:32: error: fruitless type test: a value of type org.orbeon.oxf.xforms.control.XFormsControl cannot also be a org.orbeon.oxf.xforms.control.controls.XXFormsDialogControl 
```

.... .... [scalac] ^ [scalac] 发现 231 个错误

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T17:19:46.273

看起来您的 Eclipse 可能未设置为编译 Scala 代码。也许最简单的方法是使用[Scala IDE](http://scala-ide.org/)。Scala IDE 人员创建了一个[关于 Scala IDE 安装的视频](http://scala-ide.org/download/current.html)，您可能会觉得它很有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-11T21:43:03.063

今天，我能够在 Eclipse 中设置 Orbeon 项目，并且能够在服务器上运行它并允许我调试代码。

我创建 wiki 是为了帮助其他开发人员设置相同的东西，并尝试通过调试来理解项目。

请参考以下步骤来设置项目：

1.  从以下链接下载 eclipse Scala-IDE：http: [//scala-ide.org/](http://scala-ide.org/)

2.  解压缩存档并将其保存在文件系统中。

3.  打开 eclipse -> 文件菜单 -> 单击导入 -> 从 Git 中选择项目 -> 下一步。

4.  Entet URI 为 git@github.com:orbeon/orbeon-forms.git，并选择 CE 4.5 Branch，然后选择下一步。

5.  选择新建项目向导，然后单击完成。

6.  现在项目选择向导，选择新的 Scala 项目。命名为 Orbeon-Forms。

7.  如果您在项目中看不到代码，则右键单击项目 -> 导入 -> 来自文件系统的现有项目 -> 选择克隆 Orbeon 项目的位置。-> 单击完成。

8.  现在，在项目中创建资源本地文件夹，并将资源打包文件夹的内容复制到资源本地。

9.  现在在项目中创建递归文件夹作为此路径：/build/orbeon-war/WEB-INF/classes。

10.  现在，右键单击项目-> 选择属性-> 选择构建路径。

11.现在，将默认输出文件夹设置为*Orbeon-Forms/build/orbeon-war/WEB-INF/classes*。

1.  删除所有源文件夹，并添加 src/main/java、src/main/scala、src/main/resource、src/main/resource-packaged、src/main/resource-local。

2.  现在转到库选项卡，然后删除所有罐子。（**注意：**不要删除 JRE 和 Scala 库。）

3.  现在添加 lib 文件夹中的所有 jar。并单击应用。

4.  现在单击资源，文本文件编码。单击其他，并将其更改为“UTF-8”。

5.  现在关闭属性窗口。

6.  现在你可能会得到一些 mongodb 和 GridFS 的 jar 的交叉编译错误。从您的构建路径中删除这些 jar。

7.  现在，您将在问题窗口中的几个文件中遇到错误。

8.  现在，我已经删除了 MongoDBPersistence.scala 文件。对于其他文件，我评论了代码。

9.  现在打开 LoggerFactory.scala 文件，并注释以下行：_String log4jConfigURL = Properties.instance().getPropertySet().getStringOrURIAsString(LOG4J_DOM_CONFIG_PROPERTY, false);_

并在注释行之后复制粘贴以下行： *String log4jConfigURL = "oxf:/default-log4j.xml";*

**注意：**如果您不进行上述更改，您将在启动服务器时出错。

1.  现在，清理您的项目并构建它。eClipse 应该编译所有的 scala 和 java 文件，在下面生成类文件

Orbeon-Forms/build/orbeon-war/WEB-INF/classes。

1.  现在，右键单击 build.xml -> 属性 -> 运行/调试设置 -> 单击新建 -> 选择 Ant Build。

2.  名为编辑配置的新窗口将打开。

3.  单击属性选项卡 -> 取消选中“使用 Ant 运行时首选项中指定的全局属性”。

4.  单击添加属性。命名为skip.compilation，值为true。单击确定，然后关闭配置。（**注意：**现在 Ant 不会编译 Scala 和 Java 文件。）

5.  现在，从 Eclipse 运行 orbeon-war ant target。构建完成后，您应该能够看到构建成功。

6.  我使用 Apache Tomcat 作为服务器。转到 Tomcat 目录的 conf 目录下的 server.xml。

7.  在下面添加以下上下文：

**注意：** docBase 的值将根据您在文件系统中的项目位置而改变。

1.  现在打开命令提示符，然后转到您的 /bin。

2.  运行，catalina jpda 启动。

3.  它显示服务器已启动。

4.  在浏览器中打开 localhost:8080/orbeon。您将看到 Orbeon 主页。

5.  现在，转到 eclipse -> 运行菜单 -> 调试配置 -> 选择远程 Java 应用程序 -> 点击“+”号。

6.  现在输入主机作为 localhost 和端口作为 8000。这将允许远程调试。

# python - Python 分割 mp3 频道

> ID：16019155
> 
> 赞同：0
> 
> 时间：2013-04-15T15:33:36.737
> 
> 标签：python, mp3

我想在 Python 中分离一个 mp3 文件的通道并将其保存在另外两个文件中。有谁知道这方面的图书馆。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-04T09:40:21.370

我假设你想无损地分割频道，而不是解码 MP3 并重新编码 - 否则你根本不会提到 MP3，并且很容易找到很多工具，比如**Audacity**来做到这一点。

MP3 帧有 4 种通道模式 - 这意味着 4 种类型的 MP3 文件：简单立体声、联合立体声、双通道、单声道。联合立体声文件无法无损分割。单声道文件不需要拆分。其余：立体声和双声道，占所有 MP3 文件的不到 0.1%，技术上可以分成 2 个文件，每个文件为一个声道，不会丢失。然而，互联网上没有任何工具可以做到这一点 - 没有任何命令行工具或任何 GUI 工具，因为很少有人需要该功能。

也没有适合您的 python 库。大多数库在解码后将 MP3 文件抽象为您可以操作的通用音频。pymad 是唯一一个特定于 MP3 文件的文件，它可以判断文件是否使用 4 种通道模式中的任何一种，但不提供在不解码的情况下提取通道。如果您编写一个新工具，您将不得不处理原始 MP3 文件或为其生成一个库。

并且为它编写工具或库并不容易。它是一个具有 2 个通道的流，而不是在帧级别上交错的两个流。您不能简单地处理 MP3 帧、丢弃一些帧、保留其他帧并设法以这种方式提取频道。这是专业人士的任务，也许最好发生在解码器项目（如*lame*或*libmad*）中，而不是文件操作项目（如*mp3info*或 python *eyeD3*）中。换句话说，这个特性很可能是用 C 编写的，而不是 python。

* * *

实施说明：

因此，构建这样一个工具的任务非常适合计算机科学 C 编程语言课程项目： 1\. 花费大量时间；2.它需要从C编程课程中学到的每一项技能；3\. 容易出错；4\. 很可能是建立在其他项目的工作之上，适应现有工作的教训；5\. 是一项前所未有的艰巨努力，因此非常有回报 6\. 也许可以用 300 行困难的代码来完成，而不是臃肿的简单 Visual Basic 代码，因此是谦虚和质量的好选择；7\. 最后：没有人急于等待有效的实施。

所有条件都非常适合 C 编程课程项目。

实施说明 2：

一些比特率只能在单声道模式（80kbps）下实现，而一些比特率只能在立体声模式下实现（例如320kpbs）。幸运的是，这在此任务中不会出现问题，因为所有双 mp3 比特率都可以映射到合适的单声道 mp3 比特率 - 但反之则不然！

# actionscript-3 - 如何在停止之前再次重复电影剪辑

> ID：16019156
> 
> 赞同：0
> 
> 时间：2013-04-15T15:33:39.033
> 
> 标签：actionscript-3, animation, movieclip

我知道以前有人问过这个问题，但是作为菜鸟，我不明白答案，所以我希望有人可以为我解释更多。

我有一个使用动画补间动画的箭头，当单击一个按钮时，我想要一个无穷无尽的箭头流跟随路径，如果你可以在动画补间上放置多个对象，这将很容易，但你不能？任何人都可以提供代码 id 来帮助实现这一点。

有没有办法在完成之前再次重复电影剪辑以产生这种效果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T20:53:59.080

您是否有任何代码或您想要完成的示例？

您可以使用同一影片剪辑的多个实例...因此（为了解释起见）您可以为箭头设置一次动画，确保它是自己的影片剪辑，将其放在舞台上，然后测试您的影片...它将一遍又一遍地循环。您可以将尽可能多的这部电影实例拖到舞台上，它们都会一遍又一遍地播放，直到被告知停止。

如果您需要所有箭头作为一个影片剪辑，作为一个可寻址对象，您只需选择所有已定位的箭头，并将它们转换为一个影片剪辑（右键单击，转换为符号）

当然，所有这一切都可以通过代码精确控制，但需要更多地了解您正在尝试做什么。希望这有所帮助...

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-15T15:55:28.380

函数 play() 将永远循环播放您的电影，除非您在某处有 stop() 函数。

```
yourMovie.play(); 
```

如果您想随时“重复”/“重置”影片剪辑，请使用 gotoAndPlay() ：

```
yourMovie.gotoAndPlay(1); 
```

如果您想验证您是否处于剪辑的末尾，请使用属性 currentFrame 和 totalFrames ：

```
if (yourMovie.currentFrame == yourMovie.totalFrames)
{
  // ex. if you want to stop
  yourMovie.stop();
} 
```

参考：[http ://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/MovieClip.html](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/MovieClip.html)

希望有所帮助。更具体，如果它不能回答你的问题。

# c# - 多维数组初始化器性能缓慢

> ID：16019160
> 
> 赞同：14
> 
> 时间：2013-04-15T15:33:45.180
> 
> 标签：c#, arrays, performance, .net-4.0, multidimensional-array

我有一些奇怪的性能结果，我无法完全解释。这条线好像

```
d = new double[4, 4]{{1, 0, 0, 0},
                     {0, 1, 0, 0},
                     {0, 0, 1, 0},
                     {0, 0, 0, 1},}; 
```

比这个慢 4 倍

```
d = new double[4, 4];
d[0, 0] = 1; d[0, 1] = 0; d[0, 2] = 0; d[0, 3] = 0; 
d[1, 0] = 0; d[1, 1] = 1; d[1, 2] = 0; d[1, 3] = 0;
d[2, 0] = 0; d[2, 1] = 0; d[2, 2] = 1; d[2, 3] = 0;
d[3, 0] = 0; d[3, 1] = 0; d[3, 2] = 0; d[3, 3] = 1; 
```

（这甚至没有考虑到在这个例子中我可以省略所有这些`= 0`任务）

我知道由于边界检查，在 c# 中循环多维数组可能会很慢。但是这里没有循环，不需要边界检查，整个数组初始化行可以在编译时解析。

然而，第二个代码块必须首先将数组初始化为零，然后单独覆盖每个值。
那么这里的问题是什么？

如果性能是一个问题，那么初始化这个数组的最佳方法是什么？

* * *

我使用以下代码来衡量性能：

```
using System;
using System.Diagnostics;
class Program
{
    public static double[,] d; // global static variable to prevent the JIT optimizing it away

    static void Main(string[] args)
    {
        Stopwatch watch;
        int numIter = 10000000; // repeat all tests this often

        double[,] d2 = new double[4, 4]{{1, 0, 0, 0},
                                        {0, 1, 0, 0},
                                        {0, 0, 1, 0},
                                        {0, 0, 0, 1},};

        // ================================================================
        // use arrayInitializer: slowest
        watch = Stopwatch.StartNew();
        for (int i = 0; i < numIter; i++)
        {
            d = new double[4, 4]{{1, 0, 0, 0},
                                {0, 1, 0, 0},
                                {0, 0, 1, 0},
                                {0, 0, 0, 1},};
        }
        Console.WriteLine("ArrayInitializer: \t{0:0.##########}ms", watch.ElapsedMilliseconds * 1.0 / numIter);

        // ================================================================
        // use Array.Copy: faster
        watch = Stopwatch.StartNew();
        for (int i = 0; i < numIter; i++)
        {
            d = new double[4, 4];
            Array.Copy(d2, d, d2.Length);
        }
        Console.WriteLine("new + Array.Copy: \t{0:0.##########}ms", watch.ElapsedMilliseconds * 1.0 / numIter);

        // ================================================================
        // direct assignment: fastest
        watch = Stopwatch.StartNew();
        for (int i = 0; i < numIter; i++)
        {
            d = new double[4, 4];
            d[0, 0] = 1; d[0, 1] = 0; d[0, 2] = 0; d[0, 3] = 0; 
            d[1, 0] = 0; d[1, 1] = 1; d[1, 2] = 0; d[1, 3] = 0;
            d[2, 0] = 0; d[2, 1] = 0; d[2, 2] = 1; d[2, 3] = 0;
            d[3, 0] = 0; d[3, 1] = 0; d[3, 2] = 0; d[3, 3] = 1;
        }
        Console.WriteLine("direct assignment: \t{0:0.##########}ms", watch.ElapsedMilliseconds * 1.0 / numIter);
    }
} 
```

* * *

结果：

```
ArrayInitializer:       0,0007917ms
new + Array.Copy:       0,0002739ms
direct assignment:      0,0002281ms 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T15:00:44.400

这是数组初始化器的很好解释以及为什么您会看到如此不同的结果：[http ://bartdesmet.net/blogs/bart/archive/2008/08/21/how-c-array-initializers-work.aspx](http://bartdesmet.net/blogs/bart/archive/2008/08/21/how-c-array-initializers-work.aspx)

基本上 - 数组初始化器涉及创建自定义结构，而直接分配每个项目只是在堆栈中直接分配，尽管它更快。

# mysql - 获取最大时间低于定义的分组帖子

> ID：16019161
> 
> 赞同：2
> 
> 时间：2013-04-15T15:33:50.863
> 
> 标签：mysql

我正在开发一个需要能够根据评论找出帖子的新闻提要，虽然这本身很简单，但我无法弄清楚如何只获取最新评论比特定评论更早的“帖子”时间。

为了演示，这里是我的数据的一个过于简化的版本：

```
+----+---------+------------+
| id |  Module |    Time    |
+----+---------+------------+
|  1 | Forum   | 1343739050 |
|  2 | Gallery | 1343739150 |
|  3 | Gallery | 1343739250 |
|  4 | Forum   | 1343739350 |
+----+---------+------------+ 
```

要获得五个最近评论的模块，我只需使用

```
SELECT module, max(time) FROM `comments` GROUP BY module ORDER BY max(time) DESC LIMIT 0, 5 
```

这将返回

```
+---------+------------+
|  Module |  max(Time) |
+---------+------------+
| Forum   | 1343739350 |
| Gallery | 1343739250 |
+---------+------------+ 
```

正是我想要的。当我只想获取最新评论早于特定时间的模块时，就会出现问题。例如，早于 1343739350（id 为 4 的评论的时间），但我只是简单地添加一个 where 子句，它仍然会返回 Forum，因为它有一个与之匹配的评论。

我做了一个疯狂的猜测并尝试了

```
SELECT module, max(time) FROM `comments` GROUP BY module WHERE max(time) < 1343739350 ORDER BY max(time) DESC LIMIT 0, 5 
```

然而，结果证明这是我的一厢情愿。

所以问题是，我如何编写一个可以做到这一点的 mysql 命令？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T15:38:44.273

在处理聚合列时，需要使用`HAVING`子句而不是`WHERE`子句，

```
SELECT module, max(time) 
FROM `comments` 
GROUP BY module 
HAVING max(time) < 1343739350 
ORDER BY max(time) DESC 
LIMIT 0, 5 
```

# c# - 从 HEX 字符串读取和显示 Unicode（由旧版 Microsoft COM 应用程序编写）

> ID：16019164
> 
> 赞同：0
> 
> 时间：2013-04-15T15:33:55.260
> 
> 标签：c#, com

我有一个遗留的 C++ COM 应用程序，它像这样编写 BSTR（Windows 上的 UTF-16）。

> 比如说，☻（黑色笑脸，即 ALT + Numpad 2）在 HEX 中是这样写的 -`060000003B260D000A00`由应用程序编写。请注意，第一个 4 个字节是为[BSTR 长度保留的](http://www.devx.com/tips/Tip/14587)

现在，如何`C#`从这个 HEX 字符串中显示黑色笑脸？在 VS 调试器中，`'\u263B'`显示笑脸，但这里的字符串是`3B26`. 这只是一种数据的示例。该应用程序可以转储任何数据（如大型 XSL、文本等 - 全部转换为 HEX 格式）。想法是在 C# 中正确解释 HEX。

[这个链接](https://stackoverflow.com/a/15914001/763026)讲了类似的东西，但不是很确定。任何指针？

![在此处输入图像描述](https://i.stack.imgur.com/385gI.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T23:29:30.560

用于从 BSTR[`Marshal.PtrToStringBSTR`](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshal.ptrtostringbstr.aspx)获取托管实例。`String`

请注意，`IntPtr`参数应该是指向字符串字符本身开头的指针，而不是编码字符串长度的 4 个字节的开头。

# android - 摘要：使用相机意图拍照并以正确的方向显示照片（希望适用于所有设备）

> ID：16019165
> 
> 赞同：26
> 
> 时间：2013-04-15T15:33:55.760
> 
> 标签：android, android-intent, camera, orientation

这似乎是世界上最简单的事情：使用默认的相机活动在您的 Android 应用程序中拍照。然而，在 StackOverflow 和网络上的几篇文章中涵盖了许多陷阱，例如，Null Intent 被传回，图片的方向不正确或 OutOfMemoryErrors。

我正在寻找一种解决方案，让我能够

1.  通过相机意图启动相机活动，
2.  检索照片的 Uri，以及
3.  检索照片的正确方向。

此外，我想尽可能避免设备配置（制造商、型号、操作系统版本）特定的实现。所以我想知道：实现这一目标的最佳方法是什么？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-04-30T08:10:22.170

**更新：2014 年 1 月 2 日：** 我非常努力地避免根据设备制造商实施不同的策略。不幸的是，我没有绕过它。经过数百篇帖子并与几位开发人员交谈，没有人找到适用于所有设备的解决方案，而无需实现设备制造商特定的代码。

在我在 StackOverflow 上发布我的解决方案后，一些开发人员要求我在 github 上发布我的代码。所以现在是：[**github上的AndroidCameraUtil**](https://github.com/ralfgehrer/AndroidCameraUtil)

该代码已在 Android API-Level >= 8 的各种设备上成功测试。有关完整列表，请参阅 github 上的自述文件。

[CameraIntentHelperActivity](https://github.com/ralfgehrer/AndroidCameraUtil/blob/master/src/de/ecotastic/android/camerautil/lib/CameraIntentHelperActivity.java)提供了主要功能，下面也会更详细地介绍。

**调用默认相机活动：**

*   *对于三星和索尼设备*：我使用 startActivityForResult 的方法调用来调用相机活动。我只设置了常量 CAPTURE_IMAGE_ACTIVITY_REQUEST_CODE。我没有设置任何其他意图附加功能。
*   *对于所有其他设备*：我像以前一样使用对 startActivityForResult 的方法调用来调用相机活动。但是，这一次，我另外设置了额外的 MediaStore.EXTRA_OUTPUT 意图并提供了一个 URI，我希望将图像存储在其中。

在这两种情况下，我都记得相机活动开始的时间。

* * *

**关于相机活动结果：**

1.  *Mediastore：*首先，我尝试读取从 MediaStore 捕获的照片。在 MediaStore 内容上使用 mangedQuery，我检索正在拍摄的最新图像，以及它的方向属性和它的时间戳。如果我找到一张图像并且在调用相机意图之前没有拍摄，那么它就是我正在寻找的图像。否则，我会忽略结果并尝试以下方法之一。
2.  *Intent extra：*其次，我尝试从返回意图的 intent.getData() 中获取图像 Uri。如果这也不成功，我继续第 3 步。
3.  *默认照片 Uri*：如果上述所有步骤都不起作用，我使用传递给相机活动的图像 Uri。

此时，我检索了传递给 UploadPhotoActivity 的照片 Uri 及其方向。

* * *

**图像处理**

请仔细看看我的 BitmapHelper 课程。它基于[该教程](http://tutorials-android.blogspot.co.il/2011/11/outofmemory-exception-when-decoding.html)中详细描述的代码。

此外，如果需要，shrinkBitmap 方法还会根据之前提取的方向信息旋转图像。

* * *

我希望这对你们中的一些人有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-19T07:57:43.203

我已经使用 Sony Xperia Go、Samsung Galaxy SII、Samsung Galaxy SIII mini 和 Samsung Galaxy Y 测试了此代码，它适用于所有设备！

但是在 LG E400 (2.3.6) 上它不起作用，您在图库中获得了两张图片。所以我在 void startCameraIntent() 中添加了manufacturer.contains("lge") 并解决了这个问题。

```
if(!(manufacturer.contains("samsung")) && !(manufacturer.contains("sony")) && !(manufacturer.contains("lge"))) {
    String filename = System.currentTimeMillis() + ".jpg";
    ContentValues values = new ContentValues();
    values.put(MediaStore.Images.Media.TITLE, filename);
    cameraPicUri = getContentResolver().insert(MediaStore.Images.Media.EXTERNAL_CONTENT_URI, values);
    intent.putExtra(MediaStore.EXTRA_OUTPUT, cameraPicUri);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-23T16:06:23.217

在带有 CM 10.1 的 Galaxy S3 上，我在 BitmapHelper 中得到一个空指针异常：

> bm = BitmapFactory.decodeFileDescriptor(fileDescriptor.getFileDescriptor(), null, options);

随后我的 UploadPhotoActivity 在以下位置失败：

> ```
>  try {
>         photo = BitmapHelper.readBitmap(this, cameraPicUri);
>         if (photo != null) {
>             photo = BitmapHelper.shrinkBitmap(photo, 600, rotateXDegrees);
>             thumbnail = BitmapHelper.shrinkBitmap(photo, 100);
>             ImageView imageView = (ImageView) findViewById(R.id.sustainable_action_photo);
>             imageView.setImageBitmap(photo);                
>         } else {
>             Log.e(TAG,"IMAGE ERROR 1");
>         }
>     } catch (Exception e) {
>             Log.e(TAG,"IMAGE ERROR 2");
>         e.printStackTrace();
>     } 
> ```

在第二个日志（图像错误 2）。几次尝试后，我的相机坏了，出现“无法连接到相机”错误。

在nexus 7上进行了测试，效果很好。

编辑：缩小到这个：

> fileDescriptor = context.getContentResolver().openAssetFileDescriptor(selectedImage, "r");

尽管 selectedImage 包含以下内容：

> file:///storage/emulated/0/DCIM/Camera/IMG_20131023_183343.jpg

fileDescriptor 返回 FileNotFoundException。我检查了文件系统，图像没有保存在这个位置。TakePhotoActivity 中的 cameraPicUri 指向一个不存在的图像。我目前正在检查哪里出了问题。

Edit2：我发现了错误：由于设备是三星设备，并告诉应用它是三星设备，因此应用了您的三星特定修复程序。不过，Cyanogenmod 不需要这些修复，最终代码会中断。一旦你删除

> (manufacturer.contains("samsung")) &&

有用。由于这是一个自定义 ROM，因此您当然无法为此计划。我正在尝试找出一种方法来检测设备是否正在运行 cyanogenmod，然后将其包含在您的代码中。

感谢您的相机修复！

Edit3：~~我通过将您的代码更改为，将它修复为在 Galaxy S3 上的 Cyanogenmod 上运行：~~ 嗯，现在它有时可以工作，有时不能。奇怪的。

> if (getPackageManager().hasSystemFeature("com.cyanogenmod.android") || (!(manufacturer.contains("samsung")) && !(manufacturer.contains("sony")) && !(manufacturer.contains(" lge"))))

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-02-05T14:28:12.547

我在使用 Sony Xperia Z5 时遇到了一些问题。

我添加了这个，它变得好多了。

```
if (buildType.contains("sony")&& buildDevice.contains("e5823")) {
                setPreDefinedCameraUri = true;} 
```

但是在 22 次中有 4 次重新启动了相机，并且一次重新启动了两次。由于每次测试，我都重新启动了应用程序。有什么办法可以解决这个问题还是我接受这个结果？

问题是，如果相机重新启动，我可以按两次后退按钮并繁荣，图像在我的 Imageview 中并保存

# git - git 无数次提交，但它不是

> ID：16019170
> 
> 赞同：0
> 
> 时间：2013-04-15T15:33:59.987
> 
> 标签：git, push

有人能告诉我为什么 git 反复告诉我我领先于荒谬的提交数量（实际上我不是），以及为什么我需要推动以使 git 意识到这一点？

```
> git status
# On branch dev
# Your branch is ahead of 'origin/dev' by 230 commits.

>git push origin dev
Everything up-to-date 
```

没什么大不了的，但在推动时总是会有点肾上腺素激增。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T15:47:37.047

当我收到`# Your branch is ahead of 'origin/dev' by x commits.`消息时，`git fetch`通常会为我修复它。

# java - 仅选择符合条件的 JPA Collection 成员

> ID：16019173
> 
> 赞同：0
> 
> 时间：2013-04-15T15:34:18.667
> 
> 标签：java, hibernate, jpa-2.0, jpql

我正在尝试为其 CReference 实体集合中的**所有子项都满足条件的实体 A 选择条目。**我目前的查询只需要至少一个成员满足条件。

# 当前查询

此查询当前选择类型 A 的所有对象，其中至少一个项目在其 c_references 类中

```
SELECT a FROM A a INNER JOIN FETCH a.c_references c_refs INNER JOIN FETCH c_refs.c_reference c_ref WHERE (c_ref.flag_one=TRUE AND c_ref.flag_two=TRUE)
```

# 课程

## A级

```
 @Entity
public class A{

```
@Id
private UUID a_uuid;

@OneToMany(fetch = FetchType.EAGER)
@JoinColumn(name = "owning_a_uuid")
private List<CReference> c_references; 
```

} 
```

## 类 C 参考

```
 @Entity
// This class keeps references to all of the A objects that have referenced a C object
public class CReference{

```
@Id
@GeneratedValue(strategy = GenerationType.IDENTITY)
private long c_reference_id;

@OneToOne
private A a_referencing_c;

@OneToOne
private C c_reference; 
```

} 
```

## C类

```
 @Entity
@Cacheable
public class C{

```
@Id
private UUID c_uuid;

private Boolean flag_one = false;

private Boolean flag_two = false; 
```

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T19:16:22.470

尝试这个：

```
SELECT a FROM A a 
WHERE NOT EXISTS(    
    SELECT c_refs
    FROM CReference c_refs
        INNER JOIN c.c_reference c_ref    
    WHERE
        c_refs.a_referencing_c = a
        AND (c_ref.flag_one = FALSE OR c_ref.flag_two = FALSE)
) 
```

# asp.net - EntityDataSource 执行两次查询

> ID：16019178
> 
> 赞同：0
> 
> 时间：2013-04-15T15:34:47.387
> 
> 标签：asp.net, entitydatasource

我有一个将数据从 EntityDataSource 绑定到分页的 ASP.NET ListView 的页面。该查询实际上是一个相当复杂的查询，我不知道 EDS 确实是要走的路，但它是继承的代码，我希望无需完全重新设计页面即可解决此问题。

问题是当页面被回发时，带有过滤器参数，查询在没有过滤器的情况下执行一次，然后再次使用过滤器。问题是未过滤的结果集是 17+ 百万条记录并且请求超时。

所以我的问题是...

1.  为什么查询执行两次？*我认为它可能与 ListView 上的 DataPager 有关，但是当我从页面中删除它时，它并没有改变任何东西。*

* * *

**更新：2013/04/16**

谢谢@bUKaneer 和@lthibodeaux。我认为将请求信息添加到 OP 会很有帮助。

按照建议，我注释掉了 Pager 控件和列表视图。删除后，对数据库的所有请求都停止了。我只添加了 ListView 并且查询再次执行了两次。

没有为 EDS 本身分配额外的事件处理程序。

```
<asp:EntityDataSource ID="edsSerialNumbers" runat="server" ContextTypeName="DBName.Entities" EnableFlattening="False" 
                      EntitySetName="DIST_TABLE" Include="PRODUCT, DISTRIBUTION, DISTRIBUTION.COMPANY_SITE" 
                      EnableUpdate ="true" EnableViewState="true"
                      OrderBy="it.DISTRIBUTION.DIST_NAME, it.PRODUCT.SERIAL_NUMBER"></asp:EntityDataSource> 
```

DataPager 实际上嵌入在一个单独的 UserControl 中，该 UserControl 包含在 ListView 之外，并且包含两次......

```
<div class="dataTablePager">
    <kqp:TablePager ID="pgrTop" runat="server" PagedControlID="lvSerialNumbers"/>
</div>

 <asp:ListView ID="lvSerialNumbers" runat="server" DataKeyNames="ID" OnDataBound="lvSerialNumbers_DataBound" OnItemEditing ="lvSerialNumbers_ItemEditing" onitemdatabound="lvSerialNumbers_ItemDataBound" EnableViewState="true">
            ...

</asp:ListView>

<div class="dataTablePager">
    <kqp:TablePager ID="pgrBot" runat="server" PagedControlID="lvSerialNumbers"/>
</div> 
```

代码中唯一触及 EDS 的地方是 PreRender 阶段……

```
protected void Page_PreRender(object sender, EventArgs e)
{
    if (!kqpFilters.IsFiltered && !IsPostBack)
    {
        lvSerialNumbers.DataSourceID = null;            
    }
    else
    {
        lvSerialNumbers.DataSourceID = "edsSerialNumbers";
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T13:41:36.023

在将 ListView 的数据源分配给 EDS 的位置之外的所有内容都注释掉之后，我无法解决这个问题。

我将通过删除 EDS 并将其替换为对存储过程的调用来解决它。非常令人沮丧，因为这个问题存在于大约 10-15 个屏幕上，并且没有其他选择，我将不得不从头开始重新编写每个屏幕。

# oracle - 执行 30 多个 oracle sql 查询的批处理脚本

> ID：16019179
> 
> 赞同：1
> 
> 时间：2013-04-15T15:34:54.217
> 
> 标签：oracle, batch-file

我们有 30 多个 Oracle 查询文件，其中包含存储过程和 SQL 查询。

我试图通过创建一个批处理脚本来自动化该过程，该脚本调用包含文件名的文本文件“driverssql.txt”。下面是批处理脚本：

```
@echo off
setlocal enabledelayedexpansion
 >output.txt
 ( for /f %%a in (driversql.txt) do (
    sqlplus uname/pwd@"(DESCRIPTION=(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=XXXXXX) (PORT=1521)))(CONNECT_DATA=(SID=XXXXX)))"  "%%a"
 )) 
```

上面的脚本执行得很好，但问题是每次脚本循环时，它都会创建一个连接，这是一种浪费，而不是处理这个问题的最佳方法。

当我将连接置于循环之外时，连接成功，但之后 SQLPlus 窗口处于挂起状态并且不执行查询。请提出一个更好的方法来实现这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T16:44:43.347

```
@ECHO OFF
SETLOCAL
SET "list="
FOR /f %%i IN (driversql.txt) DO (
  CALL SET list=%%list%% "%%i"
)

ECHO sqlplus uname/pwd@"(DESCRIPTION=(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=XXXXXX) (PORT=1521)))(CONNECT_DATA=(SID=XXXXX)))"%list% 
```

我相信我们需要知道的是如何`SQLPLUS`运作。

上面的代码所做的是将所有文件名累积到一个列表中，用空格分隔并引用。它可能会起作用 - 一切都取决于您将如何级联操作 sql1.sql 然后 sql2.sql ...使用一个`SQLPLUS`命令

* * *

那么，如果能够控制哪些 [set of] SQL 文件被执行，以及以什么顺序执行呢？

**我假设您可以简单地将 .SQL 文件连接成一个**如果不是这种情况，那么现在停止阅读......

```
@ECHO OFF
SETLOCAL
:tloop
SET tempfile=%RANDOM%
IF EXIST "%temp%\%tempfile%*" GOTO tloop 
COPY NUL "%temp%\%tempfile%.1" >nul
FOR /f %%s IN (sqlsched.txt) DO (
 FOR /f "tokens=1,2" %%i IN (%%s) DO (
  FINDSTR /i /b /e /c:"%%i" "%temp%\%tempfile%.1" >nul
  IF ERRORLEVEL 1 (SET "excludeme=") ELSE (SET excludeme=Y)
  IF /i "%%j"=="again" (SET "excludeme=")
  IF NOT DEFINED excludeme (>>"%temp%\%tempfile%.1" ECHO %%i)
 )
)

TYPE "%temp%\%tempfile%.1"
(
FOR /f "delims=" %%i IN ('type "%temp%\%tempfile%.1"') DO type %%i
)>humungous.sql

DEL "%temp%\%tempfile%.1" 
```

假设我们有一个文件 SQLSCHED.TXT，内容

```
daily1.txt
special.txt
daily2.txt
weekly1.txt 
```

例如 daily2.txt 包含

```
D0S9.sql
D2S1.sql
D0S0.sql
D2S1.sql
D0S9.sql again 
```

然后这批将首先读取`sqlsched.txt`然后处理每个文件`daily1.txt`, `special.txt`, `daily2.txt`,`weekly1.txt`依次生成一个临时文件。

然后逐行读取临时文件将生成`humungous.sql`包含提到的每个 sql 文件的所有内容。你所要做的就是`sqlplus`使用`humungous.sql`

我已经包含了一些技巧 - 如果您在`humungous.sql`构建时重复其中一个 SQL 文件名，那么该过程只包含一次，因此在`daily2.txt`列表中，第二个`D2S1.sql`将被跳过。但是，由于该标志`D0S9.sql`，将第二次运行。`again`

如果需要，这可以扩展 - 例如，如果您在变量中有当前的日期名称，那么您可以添加该行

```
 IF /i NOT "%%j"=="%dayname%" (SET "excludeme=Y") 
```

和线

```
dWdX.sql Wed 
```

确保`WdX.sql`只能在星期三运行

# neo4j - Neo4j HA 企业主/从控制

> ID：16019180
> 
> 赞同：1
> 
> 时间：2013-04-15T15:34:56.417
> 
> 标签：neo4j, high-availability

在 HA 中启动 Enterprise Neo4j 时，第一台服务器作为主服务器启动。我有一个要求，我想控制谁是集群中的主人，这在 Neo4j 中真的可能吗？如果我将所有从属设置为“ha.slave_coordinator_update_mode=none”会发生什么。这是否允许我拥有一个主控，如果它发生故障，其他实例将不会成为主控，当该实例恢复时将再次成为主控。或者，如果我没有使用那个设置，主人倒下，一个奴隶接管，当原来的主人回来时，它会只是充当奴隶还是会再次成为主人？是否有一些配置可以控制它，文档并没有很清楚地涵盖这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T06:48:21.080

奥洛克，

您可以使用 ha.slave_only 来确保实例永远不会成为主实例。见[http://docs.neo4j.org/chunked/stable/ha-configuration.html](http://docs.neo4j.org/chunked/stable/ha-configuration.html)

这有效地允许您添加任意数量的读取从属服务器，但请注意，如果您只有一个可以成为主服务器的实例，您将失去高可用性。即有几个实例master-ready，用ha.slave_only=false 设置，以及一堆读slave。

问候，

拉斯

# xcode - 每个应用程序都需要证书吗？

> ID：16019182
> 
> 赞同：3
> 
> 时间：2013-04-15T15:34:58.540
> 
> 标签：xcode, app-store, app-store-connect

我已经阅读了很多，但我找不到具体的直接答案。

每个应用程序都必须有其用于开发和分发的配置。配置正在使用我已经拥有的证书。

*   我是否需要为每个新应用程序创建一个新证书（开发/分发），并将配置连接到该特定证书？
*   我是否需要为开发/分发创建证书并将它们连接到供应开发/分发？

我在这里读过它，但我不清楚：[iOS 开发人员库：创建您的签名证书](https://developer.apple.com/library/ios/#documentation/IDEs/Conceptual/AppDistributionGuide/CodeSigningYourApps/CodeSigningYourApps.html#//apple_ref/doc/uid/TP40012582-CH23-SW1)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T15:45:05.237

作为开发人员，您创建一个*开发*证书。您可以创建*许多*使用此证书的开发配置文件（每个应用程序一个开发配置文件）。

同样的原则适用于分发证书（单个证书，多个配置文件），但是每个 iOS 开发帐户（而不是每个开发人员）只有一个分发证书。

# c# - 循环遍历字符串数组并转换为整数

> ID：16019183
> 
> 赞同：2
> 
> 时间：2013-04-15T15:34:58.867
> 
> 标签：c#

我有一个字符串数组，其中大部分是“真”或“假”值，有些不是，要保持原样。我希望循环遍历数组并将任何“真”或“假”更改为 1' 或零我已经开始了它，但在语法上苦苦挣扎

```
string[] data = args.Trim().Split(',');

// Loop over strings
foreach (string s in data)
{
    if(s == "true")
    {
        Convert.ToInt32(s)=1;????
    }
    else if(s == "false")
    {
        ??????
    }
} 
```

请有人提供一些指导

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T15:42:26.537

也许与 Linq：

```
string[] data = args.Split(new[] { ',' }, StringSplitOptions.RemoveEmptyEntries)
    .Select(s => StringComparer.OrdinalIgnoreCase.Equals("true", s.Trim()) ? "1"
               : StringComparer.OrdinalIgnoreCase.Equals("false", s.Trim()) ? "0" : s)
    .ToArray(); 
```

添加`StringComparer.OrdinalIgnoreCase`以显示如何在需要时忽略大小写。

[**这是**](http://ideone.com/Ifz8BE)一个带有注释示例字符串的演示。

```
this,1,is,not,0 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-15T15:38:55.950

写一个这样的函数。然后，您可以将“转换后的数据”复制到一个新数据`List`中，并将其作为`array`. 或其他形式返回。

```
public string[] GetData()
{
   string[] data = args.Trim().Split(',');
    List<string> returnData = new List<string>();
        // Loop over strings
    foreach (string s in data)
    {
        if(s == "true"){
           returnData.Add("1");
        }
        else if(s == "false"){
            returnData.Add("0");
        }
        else
            returnData.Add(s);
    }

    return returnData.ToArray();
 } 
```

假设你想要一个你没有指定`array`的类型。`string`

其他选项，因为不清楚你要对这两种类型的数据做什么，是在你取出它们时解析值，或者将它们分成两个列表。

```
string[] rawDatas = GetData();
foreach(string rawData in rawDatas)
{
    short iRawData;
    if (Int16.TryParse(rawData, out iRawData))
    {
        if (iRawData == 1 || iRawData == 0)
        {
          //Add a bit
          iRawData;
        }
        else
        {
          // add a string
          rawData;
        }
    }
    else
    {
       //add a string
       rawData;
    }
} 
```

**或者**

```
public void GetData(out List<string> strings, out List<Int16> shorts)
{
   string[] data = args.Trim().Split(',');
   strings= new List<string>();
   shorts = new List<Int16>();
        // Loop over strings
    foreach (string s in data)
    {
        if(s == "true"){
           shorts.Add(1);
        }
        else if(s == "false"){
            shorts.Add(0);
        }
        else
            returnData.Add(s);
    }
 } 
```

**或** 添加到对象数组，尽管这需要在另一边进行回滚，这是低效的（请参阅[装箱和拆箱](http://msdn.microsoft.com/en-gb/library/yz2be5wk.aspx)）

```
public object[] GetData()
{
   string[] data = args.Trim().Split(',');
    List<object> returnData = new List<object>();
        // Loop over strings
    foreach (string s in data)
    {
        if(s == "true"){
           returnData.Add(1);
        }
        else if(s == "false"){
            returnData.Add(0);
        }
        else
            returnData.Add(s);
    }

    return returnData.ToArray();
 } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-15T15:37:33.430

如果你只想做 0 和 1 比

```
 string[] data = args.Trim().Split(',');
   int[] a = new int[data.length];
        // Loop over strings
   int count=0;
    foreach (string s in data)
    {
        if(s == "true"){
           int a[count] = 1;
        }
        else if(s == "false"){
          int a[count]=0;
        }
        else
        {
          a[count] = Convert.ToInt32(s);
         }
      count++;
    } 
```

或使用 linq

```
var intlst = data.
  Select(input => input == "true" ? 1 : 
     (input == "false" ? 0 : Convert.ToInt32(input))); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-15T15:55:20.380

您可以通过简单的 for 循环来做到这一点：

```
 List<string> newArgs = new List<string>();
        for (int i = 0; i <= args.Length - 1; i++)
        {
            newArgs.Add(args[i] == "true" ? "1"
                : args[i] == "false" ? "0"
                : args[i]);
        } 
```

或者通过使用 linq ，它将在内部使用扩展对象来遍历集合。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-15T15:37:23.490

尝试这个：

```
var result = data.Select(input => input == "true" ? 1 : (input == "false")? 0 : -1); 
```

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2013-04-15T15:48:24.200

好吧，我可以看到您遇到的问题是在不创建新数组的情况下自己保存变量。当您键入该行时

```
string[] data = args.Trim().Split(','); 
```

您声明该数组中的变量是字符串类型。如果您希望将它们转换为整数，则需要创建一个新的整数数组或未定义类型。我认为您正在使用 C#，我相信数组中多种类型的代码是

```
object[] 
```

在这种情况下，你会做类似的事情

```
object[] data = args.Trim().Split(',');
foreach(string s in data){
    if(s == "true"){
        s = 1;
        Convert.ToInt32(s);
    }
    else if(s == "false"){
        s = 0;
        Convert.ToInt32(s);
    }
} 
```

# java - 在分布式 Java 程序中创建数据库

> ID：16019185
> 
> 赞同：0
> 
> 时间：2013-04-15T15:35:00.700
> 
> 标签：java, database, derby, software-distribution

我无法理解如何分发使用数据库的 Java 程序。假设我将 Derby 用作 RDBMS，并且我想将任务和日历条目存储在数据库中。我希望程序的每个用户都有一个本地数据库。

但我不明白内存数据库应该如何工作。我是否应该编写一个脚本，以便在我的程序第一次启动时创建一个数据库和空表？还是在程序安装期间已经创建了它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T20:44:38.990

如果您的程序想要将用户的任务和日历条目存储在数据库中，您可能不想使用内存数据库，因为内存数据库会在您的程序退出时消失。

相反，您想使用一个普通的持久 Derby 数据库，它将用户的数据存储在文件系统文件夹中的文件中。

您确实必须创建数据库并发出 CREATE TABLE 等语句以在该数据库中创建表。您可以将其作为单独的脚本提供，或者您可以让您的程序自己发出这些语句。

但是，表格不会自动创建；您必须以一种或另一种方式发出 CREATE TABLE 语句。

# java - URLConnection inputStream 没有被完全读取

> ID：16019186
> 
> 赞同：2
> 
> 时间：2013-04-15T15:35:05.583
> 
> 标签：java, response, urlconnection

我编写了以下代码来从服务器下载一些文件，但问题是这段代码没有读取完整的响应（inputStream）。文件大小为 7.5 MB，而我每次获得 5.5 MB，当然 adobe reader 抱怨文件已损坏。这是代码

```
import java.net.URLConnection;
public class Downloader {
URL url;
public Downloader(){
    try {

        url = new URL("https://d396qusza40orc.cloudfront.net/algs4partI/slides%2F13StacksAndQueues.pdf");
        FileOutputStream outStream;
        ObjectOutputStream oStream;
        try {
            URLConnection con = url.openConnection();
            InputStream inStream = con.getInputStream();
            outStream = new FileOutputStream("data.pdf");
            oStream = new ObjectOutputStream(outStream);
            int bytesRead;
            int totalBytesRead = 0;
            byte[] buffer = new byte[100000];
            while((bytesRead = inStream.read(buffer)) > 0){

                //outStream.write(buffer, 0 , bytesRead);
                oStream.write(buffer, 0, bytesRead);
                buffer = new byte[100000];
                totalBytesRead += bytesRead;
            }
            System.out.println("Total Bytes read are = " + totalBytesRead);
            oStream.close();
            outStream.close();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    } catch (MalformedURLException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

}
public static void main(String[] args){
    Downloader d = new Downloader();
} 
```

}

有什么想法我在这里做错了吗？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T15:42:25.943

`InputStream`您从 URL 连接获得的数据并不能保证所有字节都立即到达。它们是通过网络传输的，因此您的阅读速度可能高于您的网络。方法`read()`返回当前执行该方法时已读取的字节数。如果它返回 0，则该信息可能目前不可用，但稍后将可用。

方法`read()`返回 -1 以指示流结束。底线：将`> 0`您的`if`声明更改为`>= 0`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T15:49:56.080

`ObjectOutputStream`当您不序列化 java 对象时，您不想使用。

取消注释该行

```
//outStream.write(buffer, 0 , bytesRead); 
```

并删除

```
oStream.write(buffer, 0, bytesRead); 
```

所以：

```
while((bytesRead = inStream.read(buffer)) > 0){

    outStream.write(buffer, 0 , bytesRead);           
    buffer = new byte[100000]; // this line is useless
    totalBytesRead += bytesRead;
} 
```

`ObjectOutputStream`彻底摆脱。您的文件长度为 5.25 MB（5,511,685 字节），而不是 7.5 MB。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T15:51:23.053

问题是您正在使用 ObjectOutputStream。这以 Java 对象序列化格式对输出进行编码，这不是 PDF 阅读器所期望/需要的。

使用平原`FileOutputStream`，它应该工作。

# r - 为什么使用 xts/zoo 在 R 中没有 apply.hourly？

> ID：16019187
> 
> 赞同：7
> 
> 时间：2013-04-15T15:35:07.530
> 
> 标签：r, time-series, xts, zoo

我想按小时平均值聚合数据。日常很简单：

```
apply.daily(X2,mean) 
```

为什么没有每小时的功能？我试过了

```
hr.means <- aggregate(X2, format(X2["timestamp"],"%Y-%m-%d %H")) 
```

trim 参数总是出错。有没有类似apply.daily的更简单的功能？如果我想汇总 5 分钟的平均值怎么办。数据是每分钟的值：

```
"timestamp", value 
"2012-04-09 05:03:00",2
"2012-04-09 05:04:00",4
"2012-04-09 05:05:00",5
"2012-04-09 05:06:00",0
"2012-04-09 05:07:00",0
"2012-04-09 05:08:00",3
"2012-04-09 05:09:00",0
"2012-04-09 05:10:00",1 
```

我正在使用 xts 和动物园。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-04-15T16:02:17.820

尝试

```
period.apply(X2, endpoints(X2, "hours"), mean) 
```

`apply.daily`只是上面的一个包装器：

```
> apply.daily
function (x, FUN, ...)
{
    ep <- endpoints(x, "days")
    period.apply(x, ep, FUN, ...)
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-07-07T14:35:21.733

```
hr.means <- aggregate(X2, format(time(X2),"%y-%m-%d %H"), mean) 
```

这应该可以正常工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-08-07T02:24:58.600

回答第 2 部分：

> 如果我想汇总 5 分钟的平均值怎么办？

正如@eddit 在上面的评论中已经提到的：

```
df <- read.table(header=TRUE, sep=",", stringsAsFactors=FALSE, text="
timestamp, value 
2012-04-09 05:03:00,2
2012-04-09 05:04:00,4
2012-04-09 05:05:00,5
2012-04-09 05:06:00,0
2012-04-09 05:07:00,0
2012-04-09 05:08:00,3
2012-04-09 05:09:00,0
2012-04-09 05:10:00,1")
X2 <- xts(df$value, as.POSIXct(df$timestamp))

X2.5min <- period.apply(X2, endpoints(X2, "minutes", 5), mean) 
```

> 我得到：05:04:00 - 4；05:09:00 - 5,... 但也许可以将第一个值设置为 05:00:00 并继续 05:05:00 可能会更容易，如果我稍后合并文件以具有相同的开始和时间步长。

的确：

```
> X2.5min
                    [,1]
2012-04-09 05:04:00  3.0
2012-04-09 05:09:00  1.6
2012-04-09 05:10:00  1.0 
```

[Cross Validated](https://stats.stackexchange.com/a/19003/84350)的Darren Cook遇到了同样的问题并写了函数`align.time.down`：

```
align.time.down=function(x,n){index(x)=index(x)-n;align.time(x,n)} 
```

这可以用来调整时间：

```
X2.5mindown <- align.time.down(X2.5min, 5 * 60)
X2.5mindown
                    [,1]
2012-04-09 05:00:00  3.0
2012-04-09 05:05:00  1.6
2012-04-09 05:10:00  1.0 
```

# internet-explorer - IE 不接受字体作为初始使用重要

> ID：16019193
> 
> 赞同：18
> 
> 时间：2013-04-15T15:35:28.250
> 
> 标签：internet-explorer, css

在 chrome 中，可以使用`font: initial !important;`. 但是在 IE(9) 中，它没有获得初始值。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-04-15T15:44:01.643

任何版本的 IE[`initial`](http://www.w3.org/TR/css3-cascade/#initial)都不[支持](http://msdn.microsoft.com/en-us/library/hh781508%28v=vs.85%29.aspx#keywords)CSS3关键字。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2014-10-27T16:41:33.777

@Adrift 完全正确的是 IE 目前（IE11）不支持`initial`. 但是要回答“我该如何解决这个问题？”这个问题......

```
font-style: normal;
font-variant: normal;
font-weight: normal;
font-stretch: normal;
font-size: medium;
line-height: normal;
font-family: serif; /* depends on user agent */ 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-04-24T01:13:02.263

我刚刚遇到了这个关于线高和最小高度的错误。

在 IE 上，将“initial”替换为“auto”或“inherit”。例如：

```
/*IE*/
line-height: inherit !important;
/* Rest of the world */
line-height: initial !important;

/*IE*/
min-height: auto !important; 
/* Rest of the world */
min-height: initial !important; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-07-24T19:53:35.250

不幸的是，微软不接受`font-size: initial`.

文档中指定的实际“初始”值是`font-size: medium`.

微软文档：[https ://msdn.microsoft.com/en-us/library/ms530759(v=vs.85).aspx](https://msdn.microsoft.com/en-us/library/ms530759(v=vs.85).aspx)

Mozilla 文档：[https ://developer.mozilla.org/en-US/docs/Web/CSS/font-size](https://developer.mozilla.org/en-US/docs/Web/CSS/font-size)

# iphone - 使用命令行在 iOS 模拟器上启动应用程序

> ID：16019200
> 
> 赞同：3
> 
> 时间：2013-04-15T15:35:43.487
> 
> 标签：iphone, ios, macos, terminal, ios-simulator

早上好，

我正在尝试在`iOS Simulator`with 命令行上启动一个应用程序，所以我将此命令放在终端中：

```
open `xcode-select --print-path`/Platforms/iPhoneSimulator.platform/Developer/Applications/iPhone\ Simulator.app 
```

使用此命令启动模拟器。我的问题是如何从终端启动应用程序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T18:08:44.703

我已经使用`WaxSim`（在 rog 的评论中引用）并且效果很好。你可以在[https://github.com/square/WaxSim](https://github.com/square/WaxSim)找到它。值得一提的是，两年来没有任何提交，并且有许多开放的拉取请求。

最近我开始使用`ios-sim`它可以在[https://github.com/phonegap/ios-sim](https://github.com/phonegap/ios-sim)找到。它看起来（当前）是活跃的并且似乎有更多的功能。到目前为止，我还没有遇到任何问题（尽管我还没有*在愤怒中*使用它）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-03-04T05:20:06.240

我没有足够的代表把它写成评论。

`ios-sim`Facebook 和许多其他公司使用它来运行自动化测试并通过命令行将内容启动到 iOS 模拟器中。

您可以从 git repo 下载它，只需在 XCode 中打开它并构建它。可执行文件将在 Build>products 文件夹中生成。（对于 XCode 6 ~/Library/Developer/Xcode/DerivedData/ios-sim-xxxxxx.../Build/Products/） [https://github.com/phonegap/ios-sim](https://github.com/phonegap/ios-sim)

这是在 iOS6 模拟器中运行 .app 的命令：

```
ios-sim launch ./MyApp.app --devicetypeid "com.apple.CoreSimulator.SimDeviceType.iPhone-6" 
```

# android - 如何中断 android MediaPlayer.prepareAsync()？

> ID：16019201
> 
> 赞同：3
> 
> 时间：2013-04-15T15:35:44.623
> 
> 标签：android, android-mediaplayer, prepare

我使用 Android MediaPlayer 进行流式音频播放。但有时记录准备阶段需要的时间太长。所以我想让用户能够中断准备并开始另一个。我怎样才能做到这一点？

提前致谢。

迈克尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-24T12:53:40.423

[从有效和无效状态](http://developer.android.com/reference/android/media/MediaPlayer.html#Valid_and_Invalid_States)列表中可以看出，Preparing 状态从未被提及，不在无效状态中，更重要的是，不在有效状态中。虽然这有点令人困惑，但您最好忽略无效状态列表，如果当前状态未列为有效状态，则不要调用方法。

因此，您调用的唯一有效方法是在任何状态下都有效的方法。因此，在不使用两个交替 MediaPlayer 的情况下实现目标的唯一方法是 release() MediaPlayer 并创建一个新的。

# c# - 将应用程序 Lotus Notes 迁移到 C#

> ID：16019202
> 
> 赞同：-2
> 
> 时间：2013-04-15T15:35:46.670
> 
> 标签：c#, database, migration, mask, lotus

大家好，提前谢谢你们，

我目前正在为客户开发一个新项目，目标很简单，但我需要一个想法。

客户端有多个数据库lotus（面向应用程序），它将在客户端服务器平台C#中进行转换。NET 与 SQL Server 数据库。

他不再希望拥有 Lotus Notes 的许可证，这对他的公司来说是无利可图的。

有一些工具可以在 sharepoint 上迁移数据库，但这里的目的是不同的，因为处理是手动的。

你能告诉我做的步骤吗？:)

我有 3 年的 Lotus Notes 经验。

我认为使用用户和组会话表类型管理员、播放器、修改器等创建 ACL 规则......

掩码将是网站的模板。

但是在创建数据库时，我认为将数据提取到 CSV 文件并将其导入到数据库中。

我不知道他们是否应该放置文档的唯一标识符或单个数字。

如果有人已经手动迁移了一些数据库 lotus 并且有一点时间来解释他是如何做到的。

感谢大家抽出宝贵的时间阅读，大家都很好接受建议。

我总共要迁移 60 个应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T10:18:55.223

你最好有一个很好的概念来做这件事。

首先，您需要有通用/可配置代码来将文档内容导出为可以放入 SQL 数据库的任何格式。这对于摘要数据（Text-、Date-、Name-、Number- 项目）来说不是什么大问题，但对于 Richtextitems（格式化文本、附件、嵌入图像等）来说会很复杂。

最好的建议是购买可以为您进行这种导出的产品，因为除非您是一位非常有经验的 LotusScript 程序员，否则您不会从 Lotus Notes 中获得“好的”Richtext 数据。

下一步将是分析功能并将其重写为 C#- 应用程序。我希望，这些应用程序都是相似的，并且不使用复杂的业务逻辑。否则你仍然会在今年年底编写代码（直到那时才完成）。

更好地估计完成所有这些工作最多需要 100 天...

# php - 从浏览器加载执行 curl 图像下载

> ID：16019204
> 
> 赞同：0
> 
> 时间：2013-04-15T15:35:57.470
> 
> 标签：php, apache, permissions

我有一个 php curl 脚本，它从指定的 url 下载图像。

[使用 curl PHP 从 url 保存图像](https://stackoverflow.com/questions/6476212/save-image-from-url-with-curl-php)

```
function grabImage($url,  $saveto){
    $ch = curl_init ($url);
    curl_setopt($ch, CURLOPT_HEADER, 0);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
    curl_setopt($ch, CURLOPT_BINARYTRANSFER,1);
    $raw=curl_exec($ch);
    curl_close ($ch);
    if(file_exists($saveto)){
        unlink($saveto);
    }
    $fp = fopen($saveto,'x');
    fwrite($fp, $raw);
    fclose($fp);
}

grabImage("www.example.com/image/2.png", "/var/www/site/images/image_2.png") 
```

当有人访问我的网站时，会从我的服务器下载图像，但是如果图像不可用，它将使用 curl 从我的供应商服务器下载它，我宁愿直接从我的服务器下载所有图像，因为我不想放任何图像我的供应商服务器压力很大。

该脚本在 ssh 中运行时运行良好，例如`/usr/bin/php /var/www/site/image_s.php`，但在浏览器中加载时它不会下载图像。例如`www.example.com/image_s.php`

我需要做些什么来确保浏览器负载足以下载图像？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T16:35:45.273

我在网上做了一些搜索，结果发现您需要更改文件夹权限，默认情况下公众无法写入文件夹。

在linux中，您可以通过执行以下操作来更改权限

`chmod 666 /var/www/site/folder_name`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T15:38:28.793

看起来像 Web 服务器权限错误，当您在控制台上运行它时，您正在以您登录的用户身份运行。这与提供网站内容的用户不同（可能是“没人”）

# java - 更改 AppData 路径（系统属性）

> ID：16019205
> 
> 赞同：2
> 
> 时间：2013-04-15T15:35:59.267
> 
> 标签：java, appdata

我正在开发 Minecraft 游戏的启动器，我想做的是为游戏设置 APPDATA（Windows）位置。该值并没有真正改变，但它针对执行代码的程序进行了修改。例如，在 Mac OS X 或 Linux 系统上通过更改“home”文件夹位置很容易实现这一点，`System.setProperty("user.home", dir);`但是如何使用 Windows 上的 APPDATA 文件夹实现这一点？

可以使用这样的批处理脚本修改此位置；`APPDATA=%CD%\minecraft`.

程序/启动器是使用 swing 编程的，不是基于控制台的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-29T12:31:37.593

你可以试试这个

```
Runtime.getRuntime().exec("cmd /c SET APPDATA=%CD%\minecraft"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-02T02:13:13.677

您可以为您生成的任何子进程更改 APPDATA。使用 ProcessBuilder。虽然很困难，但可以为当前进程更改它（使用 JNI）。请参阅此相关问题：[Is it possible to set an environment variable at runtime from Java?](https://stackoverflow.com/questions/580085/is-it-possible-to-set-an-environment-variable-at-runtime-from-java)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-07-04T03:53:34.300

1.  APPDATA 是一个windows环境变量
2.  过去的搜索答案：“java set environment variable”：

    [如何在 Java 中添加环境变量？](https://stackoverflow.com/questions/14399194/how-to-add-an-environment-variable-in-java)
    [Java 中的 ProcessBuilder 环境变量](https://stackoverflow.com/questions/11198678/processbuilder-environment-variable-in-java)
    [如何从 Java 设置环境变量？](https://stackoverflow.com/questions/318239/how-do-i-set-environment-variables-from-java)
    [是否可以在运行时从 Java 设置环境变量？](https://stackoverflow.com/questions/580085/is-it-possible-to-set-an-environment-variable-at-runtime-from-java)

3.  尝试通过蛮力本机命令执行来更改当前进程的环境变量***`Runtime.getRuntime().exec("...")`将不起作用***，因为它在单独的进程中执行命令 - 环境更改仅适用于该进程。此外，System.getEnv() 使用缓存结果，因此当前的 java 程序很可能看不到更改。

4.  更具体地说：

    *   您的**启动器**是一个摇摆应用程序
    *   你的**游戏**是一个摇摆应用程序，带有一个框架来运行游戏
    *   我*假设*这是两个**独立**的应用程序，您的启动器应用程序启动了一个运行游戏应用程序 **的新进程。**

    *   如果这是真的：

        *   创建一个`ProcessBuilder`实例来启动游戏进程：

            ```
            String javaHome = System.getProperty("java.home");
            String javaBin = javaHome +
                    File.separator + "bin" +
                   File.separator + "java";
            String classpath = System.getProperty("java.class.path");

            ProcessBuilder builder = new ProcessBuilder(
                    javaBin, "-cp", classpath, "com.example.MinecraftGame"); 
            ```

        *   为游戏设置环境变量：

            ```
            Map<String, String> env = pb.environment();
            env.put("APPDATA", "%CD%\minecraft"); 
            ```

        *   运行游戏：

            ```
            Process process = builder.start();
            process.waitFor();
            return process.exitValue(); 
            ```

    *   如果这不是真的：

        *   也许应该是，因为 java 可以控制它产生的新进程的环境变量。
        *   如果您必须将两个应用程序合二为一并在启动器应用程序中运行游戏，那么您需要在启动器应用程序启动*之前*为启动器应用程序设置环境。使用命令行或批处理脚本来启动启动器。

# c# - 为什么 Visual Studio 和 Resharper 无法识别这种死代码？

> ID：16019210
> 
> 赞同：2
> 
> 时间：2013-04-15T15:36:26.173
> 
> 标签：c#, visual-studio, resharper

在我本周第一次编译的路上发生了一件有趣的事情。我遇到了这行代码：

```
if (SetFetchTab)
    tabMain.SelectedIndex = 1; 
```

...并决定，好吧，我将把它变成一个 const 以使其更具可读性，并在我使用大括号时将其括在大括号中，以防以后需要在此条件中添加其他代码：

```
const int FETCH_TAB = 0;
const int CONNECTION_TAB = 1;
. . .
if (SetFetchTab)
{
    tabMain.SelectedIndex = CONNECTION_TAB;
} 
```

但是后来好奇心占了上风，我决定找出 SetFetchTab 在哪里被赋值......它不是 - 除了在声明它的地方隐式分配 false/0 ：

```
public static bool SetFetchTab; 
```

有一次，另一种形式有条件地将 SetFetchTab 设置为 0 或 1，但该代码现在已被注释掉。所以，上面的条件永远不会为真，SelectedIndex 永远不会被分配 CONNECTION_TAB/1。那么，为什么这个块没有灰化，说明它是死代码呢？

顺便说一句，FETCH_TAB*被*灰色化/识别为死声明，因为 tabMain.SelectedIndex 从未分配为 0，因此我无处使用它。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-15T15:43:09.110

由于 SetFetchTab 是一个公共字段，而不是变量，因此可以通过外部代码直接从未知库或通过反射更改它。

如果它是方法中的变量，那么任何外部代码都无法更改它，因此 Resharper 可以断定代码已死。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-15T15:40:36.973

好吧，`public static bool SetFetchTab;`由于声明，变量被分配给它的默认值，所以这等于写成

`public static bool SetFetchTab = default(bool);`

它被使用

```
if (SetFetchTab)
{
    tabMain.SelectedIndex = CONNECTION_TAB;
} 
```

根据提供的代码，所以这里没有任何问题。

价值永远不会改变的事实，我认为没有人能够确定相关的成功百分比，至少我不知道。考虑到也可以使用反射`SetFetchTab`从*任何地方*（它是 a ）更改值。`public static`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-04-15T15:48:31.403

R# 玩得很安全。它并不假设作为应用程序一部分的所有程序集都在您的解决方案中。由于它是公共的，另一个程序集（可能是动态加载的程序集）可以将公共字段设置回零。如果你要移除它，你会破坏那个假设的组件。如果您确定它仅在内部使用，请将其设置为内部或私有，并且 R# 应该检测到它未使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-15T15:55:54.230

啊，我发现 Resharper 又比我聪明了（这就是我付大钱的原因）。我找到了这段代码：

```
if (!saveThisUser_Validate(ref txtSiteNbr, 0)) return false;
if (!saveThisUser_Validate(ref txtIP, 1)) return false;

private bool saveThisUser_Validate(ref TextBox tb, int index)
{
    if (tb.Text != "")
        return true;
    MessageBox.Show("Not all required fields have been filled in", CCR.GetFormTitle("", "", ""));
    tb.Focus();
    tabMain.SelectedIndex = index;
    return false;
} 
```

...并将其更改为：

```
if (!saveThisUser_Validate(ref txtSiteNbr, FETCH_TAB)) return false;
if (!saveThisUser_Validate(ref txtIP, CONNECTION_TAB)) return false; 
```

# javascript - 全选/取消全选不适用于单条记录

> ID：16019223
> 
> 赞同：1
> 
> 时间：2013-04-15T15:37:13.037
> 
> 标签：javascript, html, jsp

我有一个javascipt如下：

```
if(document.forms[0].Check_All.value=="Select All"){
    for (i = 0; i < chk.length; i++){
            chk[i].checked = true ;
            document.forms[0].Check_All.value="DeSelect All";

        }
    }else{
        for (i = 0; i < chk.length; i++){
        chk[i].checked = false ;
        document.forms[0].Check_All.value="Select All";
        }
    } 
```

它用于选择和取消选择复选框。当 chk.length=2 及以上时它工作正常。但是，当我只有 1 条记录时，chk.length 是未定义的，它不会工作。猜猜为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T15:44:48.127

发生这种情况是因为当只有具有指定名称的表单元素时，您可以直接访问该元素，而对于更多具有相同名称的元素，您将获得一个集合。

你可以在像这样的简单情况下解决这个问题，比如

```
if(chk.length == undefined) {
  chk = new Array(chk);
} 
```

如果它之前不是一个集合，那么之后`chk`将是一个数组——它的行为*类似于*一个集合，至少在您可以访问它的长度属性并使用数字索引访问它的（一个）元素的方式上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T15:46:28.260

您可以使用 JQuery 函数来检查所有复选框

```
$("input :checkbox").each(function(){
    $(this).prop('checked', true);
}); 
```

# git - Git远程作为本地

> ID：16019226
> 
> 赞同：1
> 
> 时间：2013-04-15T15:37:24.210
> 
> 标签：git, git-gui

我的虚拟主机在他们的基于 Linux（我相信是 Debian）的虚拟主机服务器上安装了 Git 作为“客户端”，而不是作为“服务器”。

有没有办法通过我的 Windows 7 台式计算机使用 GitGUI 连接到我的 Web 主机的 Git 安装？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T16:32:43.180

“客户端”和“服务器” Git 安装之间*几乎*没有区别：Git 只提供了一个能够自行为 Git 存储库提供服务的程序 - `git-daemon`. 由于它不提供身份验证，因此它通常只安装在为可公开访问的存储库提供服务的机器上（使用免费为所有人提供的只读`git://`协议）。

对 Git 存储库的所有“常规”写访问都由其他软件*介导*——通常是`HTTP[S]`服务器（用于`http://`协议）或`SSH`服务器（用于`ssh://`协议）。该软件执行必要的身份验证和授权，然后调用低级 Git 程序来执行客户端/服务器数据交换。

因此，您应该首先决定如何访问您的存储库。

在您的情况下，我会选择 SSH：因为您的网络主机（据说）是一个基于 Linux 的 VPS，它很可能已经启动并运行了 SSH 服务器，并且您应该已经获得了一个帐户（如果没有，有是时候问了）。

故事的其余部分在[这里](http://nathanj.github.com/gitguide/index.html)解释（有漂亮的图片）。对您来说唯一的区别是，由于您不会使用 github，因此您必须手动将您的公共 SSH 密钥传输到您的 VPS 主机。

有关在服务器上托管 Git 的更多信息，通常[可在 The Book 中找到](http://git-scm.com/book/en/Git-on-the-Server)（[这](http://git-scm.com/2010/03/04/smart-http.html)`HTTP[S]`是关于Git 中改进支持的后期附录）。

**在 Git 中使用 SSH 的**更新。****

 **事实上，托管一个通过 SSH 访问的 Git 存储库可能既简单又复杂，具体取决于您的设置——简单的解决方案或具有虚拟化 Git 用户和访问权限管理等的高配置服务器。

使用 SSH，Git 以这种方式工作：

1.  客户端与运行在托管目标 Git 存储库的机器上的 SSH 服务器进程执行 SSH 连接。通常这是使用所谓的 pubkey 身份验证来完成的。
2.  建立连接后，客户端告诉对方生成一个特殊的 Git 进程，然后与本地 Git 进程对话，SSH 执行它们的交换——经过身份验证和加密。

为了让我们走得更远，还有另外两个必须掌握的位：

*   虽然 SSH 支持多种“服务”（例如，SFTP — 一种安全版本的 FTP，并制作普通 TCP 隧道），但它最常见的用例是远程启动进程，最常见的情况是它是一个 shell（即为什么它毕竟被命名为 SSH——一个安全的外壳）。

    当这样一个远程进程启动时，它使用登录用户的凭据。因此，当*您*登录 SSH 服务器时（“手动”或 Git 为您执行此操作）会在远程服务器上启动一个 shell，它使用您身份验证的*远程*用户的凭据工作。

*   在尝试访问远程存储库之前，Git 客户端会解析该存储库的 URL。血淋淋的细节在[`git-fetch`手册](https://www.kernel.org/pub/software/scm/git/docs/git-fetch.html#URLS)中，但简单的事情是像这样的 URL

    ```
    ssh://user@server/path/to/the/repo.git 
    ```

    被分解为协议部分、用户、服务器和存储库的路径，即

    ```
    /path/to/the/repo.git 
    ```

    此存储库路径是服务器上的物理路径。所以是的，就这么简单：你不必调整某种配置文件来告诉 Git 存储库在哪里，相反，你只需在你的 URL 中指定它。

    存储库路径处理的一个有点高级的转折是可以使用特殊的快捷方式来引用远程用户的主目录。这是使用路径完成的

    ```
    /~/devel/repo.git 
    ```

    这使得 Git 在远程用户的主目录下查找名为“devel”的目录，然后在其中查找“repo.git”目录。如果您不想留出一个特殊的目录来保存 Git 存储库，这种方法很有用。这种方法也非常适合单人项目。

    在典型的基于 Linux 的操作系统上，用户的主目录位于`/home`层次结构下，因此用户`johndoe`将其`/home/johndoe`作为主目录。通过 SSH 以交互方式登录后，您可以通过以下方式验证您的主目录是什么

    ```
    cd
    pwd 
    ```

    （第一个命令将当前目录更改为主目录，第二个命令打印当前目录）。

因此，对于最简单的情况，您可以这样做：

1.  通过 SSH 登录服务器。

2.  在某处创建服务器端存储库：

    ```
    cd /var/tmp
    mkdir test.git
    cd test.git
    git init --bare 
    ```

3.  登出。

4.  将此远程添加到您的本地存储库：

    ```
    git remote add test ssh://user@server/var/tmp/test.git 
    ```

5.  使用此遥控器：

    ```
    git push test master 
    ```

要验证 Git 在服务器上工作正常，只需尝试类似

```
ssh user@server "git --version" 
```

或者

```
plink user@server "git --version" 
```

如果您使用的是 PuTTY 而不是 Git for Windows 随附的 OpenSSH 客户端。**

# jsp - 从 JSP 网页生成 Hello World Exe 文件的最短方法是什么？

> ID：16019231
> 
> 赞同：0
> 
> 时间：2013-04-15T15:37:47.123
> 
> 标签：jsp, netbeans, compilation, ejb

**设想 ：**

当有人进入我的网站**www.domain.com/mypage.jsp**时，他会找到一个输入文本框来输入他的名字，以及一个下载按钮。当用户输入他的名字并点击下载按钮时，他将被重定向到一个链接，在该链接中他可以下载在 windows 下运行的可执行文件，当单击 exe 时，用户将看到一条 hello world 消息。

* * *

问题：我应该用哪种编程语言编写“Hello World Executable”，这样我可以轻松地对其源代码进行一些修改并从 JSP 网页编译它。

如果您分享有关如何从 JSP 网页编译小型 Hello World exe、我需要导入哪些库以及从 JSP 网页更容易编译哪种语言的任何示例，我们将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T16:31:18.953

也许其中最困难的部分是找到一种具有现有交叉编译器平台的编程语言，该平台将在您的服务器运行的任何操作系统上编译 .exe 文件。如果您的服务器运行 Windows，这并不难。这里的问题是我们不确定您正在运行哪个操作系统。不用猜测，似乎以 VB 的形式存在解决方案（但不幸的是）。您的服务器永远不必修改源代码。您的代码可能类似于：

```
Module mainModule
    Sub Main()
        Console.WriteLine("Hello " & Name & ". Press enter to exit.")
        Console.ReadLine()
    End Sub
End Module 
```

为了编译它，服务器可以调用 Microsoft VB 编译器或 Mono VB 编译器作为 shell 命令，使用`/define:`开关来定义 Name。确保在将名称放入命令之前对其进行清理！确保它不包含任何命令行可能会不受欢迎地解释的字符，例如管道字符、换行符和引号。

单声道命令：`vbnc filename.vb /define:Name=\"Fred\" /out:Fred.exe`

微软命令：`vbc filename.vb /define:Name=\"Fred\" /out:Fred.exe`

如果您的服务器碰巧运行 Windows，那么您可以调用 Microsoft C++ 编译器来实现与 C 代码相同的效果。这也好不了多少。也许，如果取得了一些成功，您可能能够`cl.exe`从 Windows 环境复制到 Linux（或其他非 Windows）环境，并使用 WINE 运行它。如果是这样的话，我更喜欢那个选项。您的源代码可能如下所示：

```
#include <stdio.h>
int main(void) {
    puts("Hello " NAME ". Press enter to exit");
    getchar();
} 
```

...并且该命令看起来像：`wine cl.exe filename.c /DNAME="Fred" /out:Fred.exe`，具有防止恶意用户劫持您的系统所必需的相同预防措施。

# asp.net-mvc - 如何在 ASP.NET MVC2 中使用 <% %>？

> ID：16019234
> 
> 赞同：0
> 
> 时间：2013-04-15T15:37:52.817
> 
> 标签：asp.net-mvc, image, asp.net-mvc-2

我是 ASP.NET MVC2 的新用户，我的第一个项目使用 HTML 5。当我在图像标记中使用 <% %> 时，例如：***`<link href="<%: HttpContext.Current %>"Content/css/style.css" type="text/css" rel="stylesheet" media="screen" />`***，如您所见， HttpContext.Current 中的 HttpContext 未突出显示。如果我在新行中使用 <%: HttpContext.Current %> （不在任何标签中），它就可以工作。你知道这是什么吗？我该怎么办？

<%= %>、<%: %>、<% %> 有什么不同？如何在 MVC2 中获取绝对图像路径？感谢收看！

# c# - Gridview 按钮 单击 - 填充用户控件，然后打开一个 Jquery 对话框

> ID：16019235
> 
> 赞同：0
> 
> 时间：2013-04-15T15:37:59.700
> 
> 标签：c#, asp.net, jquery-ui, gridview, modal-dialog

我有一个用户的网格视图。

我*想要*发生的事情：

当有人想要编辑用户的详细信息时，他们单击相关的 gridview 按钮，然后会打开一个 Jquery 模式对话框，其中预先填充了用户信息。

剧本：

```
$(document).ready(function () {
                //setup new User dialog
                $('#divEditUser').dialog({
                    autoOpen: false,
                    draggable: true,
                    width: 650,
                    modal: true,
                    title: "Edit User",
                    open: function (type, data) {
                        $(this).parent().appendTo("form");
                    }
                }); 
```

网格视图：

```
<asp:TemplateField ItemStyle-HorizontalAlign="Center">
    <ItemTemplate>
        <asp:Button ID="btnEdit" CommandArgument='<%# Eval("UserID") %>' CommandName="EditUser" Text="Edit User" runat="server" UseSubmitBehavior="false"/>
    </ItemTemplate>
</asp:TemplateField> 
```

自定义用户控件：

```
<div id="divEditUser" title="Edit user">
    <asp:HiddenField ID="hiddenUserID" runat="server" />
    <cac:UserDetails runat="server" ID="UserDetails" />
    <asp:Button id="btnSaveChanges" Text="Save Changes" runat="server" />
</div> 
```

背后的代码：

```
protected void gridUsers_RowCommand(object sender, GridViewCommandEventArgs e)
    {
       if (e.CommandName == "EditUser")
        {
            Button btn = (Button)e.CommandSource;               // the button
            GridViewRow myRow = (GridViewRow)btn.Parent.Parent;  // the row
            GridView myGrid = (GridView)sender; // the gridview
            string ID = myGrid.DataKeys[myRow.RowIndex].Value.ToString();

            UserDetails.PopulateUser(Convert.ToInt16(ID));

            THIS IS WHERE I WANT TO OPEN THE DIALOG 
        }
    } 
```

我的问题是对话框在回发时出现并消失，或者它不会显示，或者它将显示在弹出窗口（未填充）上并再次显示在表单上（填充）

我试过了`ScriptManager.RegisterStartupScript`

我也尝试了几种`OnClientClick`方法。我试过更新面板，没有更新面板

但一次又一次，没有运气。

有没有人真正做到了这一点？...你会分享代码吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-20T22:15:16.327

在您的 jquery 对话框函数中使用 return false 语句

# jquery - 在固定宽度 DIV 中使用拖放表滚动

> ID：16019236
> 
> 赞同：2
> 
> 时间：2013-04-15T15:38:00.593
> 
> 标签：jquery, html, drag-and-drop

我有一个我无法解决的问题。

基本上我在 DIV 中有一个拖放表。该表宽 5000 像素，位于 div 内。保存表格的 div 为 1000px 宽，溢出设置为滚动。

```
 <div id="drag" style="width:1000px; overflow:scroll;">
     <table id="table1" style="width: 5000px; border-style: solid; border-width: 1px;">
       ...content
     </table>
 </div> 
```

当我从表格中拖动一个元素并到达 div 的末尾（@1000px）并且我需要移动以访问视图之外的部分时，它对我不起作用。（图片[http://i.imgur.com/7Gqaxr0.png](http://i.imgur.com/7Gqaxr0.png)）

当我删除包含 div 上的 1000px 宽度时，它可以工作，让我拖动并继续滚动。所以下面的代码有效。但是 Div 将是 5000 px 宽（与表格相同）我希望 Div 只有 1000px 宽并且在 div 内发生的滚动不会跨越“页面”。

```
<div id="drag" style="overflow:scroll;">
         <table id="table1" style="width: 5000px; border-style: solid; border-width: 1px;">
           ...content
         </table>
     </div> 
```

有人可以帮忙吗？

供参考。我正在使用 REDIPS Drag Drop JQuery Plugin for Tables。 [http://www.redips.net/javascript/drag-and-drop-table-content/](http://www.redips.net/javascript/drag-and-drop-table-content/)

谢谢

# delphi - 带有打开 Aero 玻璃的 Windows 版本的 Delphi 2010 按钮将文本变为白色

> ID：16019241
> 
> 赞同：4
> 
> 时间：2013-04-15T15:38:22.650
> 
> 标签：delphi, delphi-2010, aero-glass

前几天，我开始在Delphi中玩不同的视觉效果，在使用Aero Glass效果时遇到了一个问题（我安装了Delphi 2010）：当我将按钮放在玻璃上时，这个按钮的一部分（或一些其他元素）燃烧并变得透明。我不知道为什么，但我试图在其他计算机上做同样的例子。这个错误重复了。

有错误的屏幕截图；第二个按钮的标题是透明的： ![在此处输入图像描述](https://i.stack.imgur.com/l9vmp.png)

我的示例程序：

```
program Project1;

uses
  Forms,
  Unit1 in 'Unit1.pas' {Form1};

{$R *.res}

begin
  Application.Initialize;
  Application.MainFormOnTaskbar := True;
  Application.CreateForm(TForm1, Form1);
  Application.Run;
end. 
```

* * *

```
unit Unit1;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, StdCtrls;

type
  TForm1 = class(TForm)
    Button1: TButton;
    Button2: TButton;
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  Form1: TForm1;

implementation

{$R *.dfm}

end.
object Form1: TForm1
  Left = 0
  Top = 0
  Caption = 'Form1'
  ClientHeight = 202
  ClientWidth = 331
  Color = clBtnFace
  Font.Charset = DEFAULT_CHARSET
  Font.Color = clWindowText
  Font.Height = -11
  Font.Name = 'Tahoma'
  Font.Style = []
  GlassFrame.Enabled = True
  GlassFrame.Bottom = 50
  OldCreateOrder = False
  PixelsPerInch = 96
  TextHeight = 13
  object Button1: TButton
    Left = 64
    Top = 153
    Width = 175
    Height = 41
    Caption = 'Button1'
    Font.Charset = DEFAULT_CHARSET
    Font.Color = clMenuHighlight
    Font.Height = -11
    Font.Name = 'Tahoma'
    Font.Style = []
    ParentFont = False
    TabOrder = 0
  end
  object Button2: TButton
    Left = 64
    Top = 73
    Width = 175
    Height = 41
    Caption = 'Button1'
    Font.Charset = DEFAULT_CHARSET
    Font.Color = clMenuHighlight
    Font.Height = -11
    Font.Name = 'Tahoma'
    Font.Style = []
    ParentFont = False
    TabOrder = 1
  end
end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-15T22:06:20.963

这是 Delphi 2010 支持“玻璃”（使用 DWM 的航空合成）中的一个已知错误，我相信它已在 Delphi XE 中修复，我选择使用的解决方法是使用我自己的自定义 TButton 类。

当我在 2010 年看到它时，我向 Embarcadero 报告了这个错误，和其他人一样，我似乎找不到 QC#（错误报告 #），但建议的双缓冲解决方法对我来说是不可接受的。 `TBitBtn`我相信没有出现这个问题，这是我最简单的解决方法，尽管它还有其他问题。

Delphi 2010 中有很多玻璃问题。一般建议；升级德尔福。

# mysql - MySQL：我应该为这些查询设置哪些索引？

> ID：16019245
> 
> 赞同：1
> 
> 时间：2013-04-15T15:38:33.623
> 
> 标签：mysql, sql

我很难弄清楚需要索引什么才能使我的查询尽可能高效。使用的表有数十亿行，所以没有索引它是无用的。

我知道当我搜索`WHERE ... AND`这些列应该一起索引的东西时，但我不明白索引如何应用于更复杂的情况，比如`COUNT`和`ORDER BY`。

请有人告诉我以下查询需要哪些索引：

查询一：

```
SELECT word1,word2,COUNT(id) AS aaa
  FROM mytable
  WHERE (word1>0 AND word2=429907) OR (word1=429907 AND word2>0)
  GROUP BY word1,word2
  ORDER BY aaa DESC LIMIT 20; 
```

查询 2：

```
CREATE TEMPORARY TABLE temptbl (
  pibn INT UNSIGNED NOT NULL, page SMALLINT UNSIGNED NOT NULL)
  ENGINE=MEMORY;
INSERT INTO temptbl (
  SELECT DISTINCT pibn,page FROM mytable
  WHERE word1=429907 AND word2=0);
ALTER TABLE temptbl ADD PRIMARY KEY (pibn,page);
SELECT word1,word2,COUNT(id) AS aaa
  FROM mytable a
  INNER JOIN temptbl b
  ON a.pibn=b.pibn AND a.page=b.page
  GROUP BY word1,word2 ORDER BY aaa DESC LIMIT 10;
DROP TABLE temptbl; 
```

查询 3：

```
SELECT pibn,COUNT(*) AS aaa
  FROM mytable
  WHERE word1=429907 AND word2=12322
  GROUP BY pibn ORDER BY aaa DESC LIMIT 25 
```

目前的指标是：

```
id
pibn,page
word1,word2,origyear,cat 
```

就目前而言（使用当前索引）查询 1 需要 13 秒，查询 2 需要 35 秒，查询 3 需要 0.1 秒（这听起来很快，但我认为它没有得到尽可能多的优化。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T15:58:47.593

[您应该在此处查看](http://dev.mysql.com/doc/refman/5.0/en/mysql-indexes.html)MySQL 中如何使用索引。

您的第一个查询不使用索引，因为它`where`在两列的子句中都有不等式。为了提高效率，您需要重写查询并可能添加另一个索引。此外，如果`id`从不为 NULL，我认为您最好使用`count(*)`. 这将允许查询仅通过查询扫描完成。

重写后的查询如下所示：

```
select  word1, word2, count(*)
from ((select word1, word2
       from mytable
       where word1>0 AND word2=429907
      ) union all
      (((select word1, word2
       from mytable
       where word2>0 AND word1=429907
      )
     ) t
 group by word1, word2 
```

`mytable(word2, word1)`出于性能原因，此查询需要索引。

如果您先在子查询中进行聚合，然后再在外部级别进行聚合，这可能会更快。

您的第二个查询可能会因`count(id)`. 它可能正在使用`group by`. 然后它需要`id`从数据页中获取。要么添加一个类似的索引，`mytable(word1, word2, id)`要么只是将代码更改为`count(*)`.

第三个查询将受益于`mytable(word1, word2, pibn)`.

# jquery - Joomla 上的 jQuery 和 Ajax

> ID：16019248
> 
> 赞同：0
> 
> 时间：2013-04-15T15:38:38.133
> 
> 标签：jquery, ajax, joomla

这是我正在谈论的网站：http: [//imok.ro/demo/drtudor/index.php/our-practice/osteopathic-manual-medicine](http://imok.ro/demo/drtudor/index.php/our-practice/osteopathic-manual-medicine)

它在 Joomla 2.5 上运行，但使用 Ajax（一个插件）加载。这个插件有一个“滚动到顶部”选项，但它与我添加的 jQuery 脚本冲突（用于自定义滚动）。

除了 jQuery 库之外，还加载了用于背景动画的“jquery.backgroundpos.js”，以及用于自定义滚动条的“jquery.mcustomscrollbar.concat.min.js”。

所以我决定自己做一个代码，它有两部分。我的问题是，他们不能一起工作......单独一切都很好。

```
(function(jQuery){
jQuery.noConflict();
    jQuery(window).load(function(){
        jQuery("#rt-mainbody").mCustomScrollbar({
            autoHideScrollbar:true,
            theme:"light-thin"  
        });
    });
})(jQuery);     

jQuery(document).ready(function() {
    jQuery('a').click(function(){
        jQuery('#rt-mainbody').animate({scrollTop:0}, 'slow');
            return false;
        });
}); 
```

我在这里想念什么？

**编辑：**

我还不是 Web 编程专家，也无法调试 mscustomscrollbar.js。我认为由于 Ajax 调用，我无法通过 Firebug 进行调试。（**有没有我不知道的解决方案？）**文件中的代码有 1000 行长，不知道要查找什么...

我继续寻找解决方案，发现这个插件还有很多其他功能，比如 ScrollTo 函数，或者`.mCustomScrollbar("update")`. 这并没有解决问题，所以我认为应该在重新加载页面后调用这个（“更新”）函数。在 Ajax 插件 index.php 中有一行在每个事件之后向上滚动页面。我在这里添加了“更新”功能，但由于某种原因它不起作用......**这是用 Ajax 编写的，因此它与 jQuery 不兼容吗？**

```
if($this->params->get('scrlUp', 1) == 1){
        //for nice scroll ;)
        JHTML::_('behavior.framework', true);
        $cnfg_data .= "\nFLAX.Html.onall('response', function(){new Fx.Scroll(
            document.getElementById('rt-mainbody')).toTop().mCustomScrollbar('update');    
        });";
    } 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T07:31:31.853

第一个函数被立即调用，当 jQuery 可能还不可用时，我不确定挂钩到就绪和加载是否有意义，像这样调试它可能更容易：

```
jQuery(function($) {
    $("#rt-mainbody").mCustomScrollbar({
        autoHideScrollbar:true,
        theme:"light-thin"  
    });
    $('a').click(function(){
        $('#rt-mainbody').animate({scrollTop:0}, 'slow');
            return false;
        });
}); 
```

然后在你的 mCustomScrollbar 里面做一些 debug.log 看看它卡在哪里

# pdf - 在 Linux 上搜索 Pdf 库（转换为图像并将多页合并为一个 pdf）

> ID：16019253
> 
> 赞同：0
> 
> 时间：2013-04-15T15:38:44.703
> 
> 标签：pdf

我正在用 PHP 编码。我正在搜索一个 PDF 库，它**可以在 Linux 上最快地将 pdf 转换为图像**并将**多页合并为一个 pdf**

我尝试了imagick，但这很慢。

任何人都可以为我建议吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T15:21:28.723

这个答案 100% 来自对[https://superuser.com/questions/185880/how-to-convert-a-pdf-document-to-png](https://superuser.com/questions/185880/how-to-convert-a-pdf-document-to-png)的答案和[PDF 文档中的快照图像](https://stackoverflow.com/questions/955238/snapshot-image-from-pdf-document)，因此感谢这些作者。

为了加快速度，首先使用[pdftk](http://www.pdflabs.com/tools/pdftk-the-pdf-toolkit/)仅提取您需要的页面：

```
pdftk file.pdf cat 2 output page2_only.pdf 
```

然后你可以使用[Poppler中的任何一个](http://poppler.freedesktop.org/)

```
pdftoppm -png myfile.pdf > myfile.png 
```

或坚持使用[Imagemagick](http://www.imagemagick.org)

```
convert -geometry 1600x1600 -density 200x200 -quality 100 page2_only.pdf page_snapshot.jpg 
```

# php - MySql While 循环分配变量

> ID：16019254
> 
> 赞同：2
> 
> 时间：2013-04-15T15:38:49.510
> 
> 标签：php, while-loop, variable-assignment

我正在尝试创建一个显示 mysql 查询输出的表。但是，如果查询一行的结果等于默认值，`null` `00:00:00`那么我想改为显示`''`. 不幸的是，无论出于何种原因，我的代码都会将所有条目更改为查询中`''`是否存在任何条目`00:00:00`。我预计问题是在循环期间没有重新定义变量，但我不完全确定。我很感激任何帮助。PHP脚本如下：

```
$table = "<ul data-role='listview' data-theme='b' id='myTabDiv'>";
 while($row = mysqli_fetch_assoc($res)){ 
  $actdep = $row['actdep'];

  if($row['actdep'] = '00:00:00'){
       $actdep = '';
  }

 $table .=  "<li><table style='table-layout: fixed; width: 100%'><tr><td>" . $actdep . "</td></tr></table></li>";

 };
$table .= "</ul>";
echo $table; 
```

如果您注释掉第 6 行 ( `$actdep = '';`)，那么所有值都会显示，否则它们都不显示。表中只有一个值的时间为`00:00:00`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T15:41:06.320

这是因为您`=`在测试中使用了该符号`if`。您应该使用`==`比较（注意两个*等号*。）而不是比较值，而是将值分配给变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T15:41:35.423

你的`if`陈述有误；而不是使用相等比较运算符，您设置值，它也不会返回布尔值。

试试这个，而不是：

```
if($row['actdep'] == '00:00:00'){ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-15T15:41:48.503

您应该使用`==`or`===`进行比较（后者也比较类型，而不仅仅是对值的解释）：

```
if($row['actdep'] == '00:00:00'){
  $actdep = '';
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-15T15:41:55.220

将其更改为

```
if($row['actdep'] == '00:00:00'){ 
     $actdep = '';
} 
```

1 等于分配 2 等于比较

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-15T15:44:15.963

我宁愿将`html`代码放在php之外

```
<ul data-role='listview' data-theme='b' id='myTabDiv'>
<?php
 while($row = mysqli_fetch_assoc($res)){ 
  $actdep = $row['actdep'];

  if($row['actdep'] == '00:00:00'){
?>
  <li><table style='table-layout: fixed; width: 100%'><tr><td>&nbsp;</td></tr></table></li>
<?php
 } else {
 ?> 
 <li><table style='table-layout: fixed; width: 100%'><tr><td><?php echo $actdep; ?></td></tr></table></li>
<?php }
 }
 ?>
</ul> 
```

我还更正了一个错误，`equal symbol`
一个用于**声明**变量，
两个用于**等于**，
三个用于**不同**，（您也可以`!=`用于不同的比较）
，因此您可以使用 double 来比较`==`。

# c# - 是否有替代方法可以完成 Assert 所做的事情并在测试失败时完全执行而不使用 Try Catch？

> ID：16019259
> 
> 赞同：0
> 
> 时间：2013-04-15T15:39:21.923
> 
> 标签：c#, xpath, selenium, nunit, selenium-webdriver

我正在为 UI 编写测试，并且正在使用断言语句来检查断言失败时是否存在带有消息字符串的元素。我希望测试继续检查其他元素，即使它找不到元素。我还希望在测试结束时显示断言失败时的有用消息。

```
Assert.IsTrue(IsElementPresent(By.XPath("//a/img[@src='/Img1.png']")), "Img1 not present");
Assert.IsTrue(IsElementPresent(By.XPath("//a/img[@src='/Img2.png']")), "Img2 not present");
Assert.IsTrue(IsElementPresent(By.XPath("//a/img[@src='/Img3.png']")), "Img3 not present"); 
```

是否有替代使用断言语句或在尝试捕获中使用断言语句以继续测试？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T15:44:16.267

您可以保留错误消息，然后在最后检查。下面是可怕的代码，你想整理一下，但它让你知道你能做什么。

```
[Test]
public void All_images_are_present()
{
    string message = string.Empty;

    message = AssertImage("Img1");
    message += AssertImage("Img2");
    message += AssertImage("Img3");
    ... etc ...

    Assert.That(message, Is.Empty, message);
}

private static string AssertImage(string imageName)
{
    string imagePath = string.Format(@"//a/img[@src='/{0}.png']", imageName);

    if (IsElementPresent(By.XPath("//a/img[@src='/Img1.png']")))
        return string.Empty;

    return string.Format("{0} not present;");    
} 
```

但是，最好进行三个不同的测试并检查每个图像中的每个图像。理想情况下，测试应分别检查一项功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-21T10:34:28.357

解决方案的最佳方法是使用参数化测试。在 NUnit 中，您可以使用`[TestCase]`属性来实现。

以下示例被重写为参数化测试：

```
[TestCase("//a/img[@src='/Img1.png']")]
[TestCase("//a/img[@src='/Img2.png']")]
[TestCase("//a/img[@src='/Img3.png']")]
public void ElementIsPresent(string xpath)
{
    Assert.IsTrue(IsElementPresent(By.XPath(xpath)));
} 
```

现在，您可以区分两种类型的红色测试：期望不同的测试（这里：如果返回 false 而不是 true）和抛出异常的方式。

您的方法还有另一个问题。正如 Andy Nichols 所提到的，您在一项测试中测试了多个逻辑断言。单元测试的每个测试不应超过一个逻辑断言。按照上面的参数化测试保证你在一个测试中测试一个逻辑断言。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T21:23:35.780

在编程中，我们称之为“ [if 语句](http://en.wikipedia.org/wiki/If_statement#If.E2.80.93then.28.E2.80.93else.29)”。 `Assert.IfTrue(condition, message)`只是以下的简写形式：

```
if (condition) then
    print message
    abort_execution
end-if 
```

# vb.net - 内部交换 smtp 服务器上带有 system.net.mail 的大量邮件超时

> ID：16019264
> 
> 赞同：2
> 
> 时间：2013-04-15T15:39:39.580
> 
> 标签：vb.net, system.net.mail

我正在制定一个计划，每周向我们公司的每位销售员工发送提醒/更新。每周大约 120 个，自动化，在很短的时间内。这是一个内部程序，仅供内部收件人使用，我不担心垃圾邮件或不需要的消息，并且取消订阅不是一种选择。每条消息都根据每个销售人员的客户列表进行个性化，并包含每周“待办事项”项目，以便他们致电客户。

我在内部运行 Exhange 2007，并为我的开发环境和运行这些自动化项目的服务器提供了一个开放的内部 SMTP 连接器。该程序在一两家商店运行良好，但是当我为每家商店运行它时，在发送了 110 条消息后，我会在某个地方超时。

我没有尝试将邮件排队或将它们保存在块中，因为我遍历销售人员列表，并进行每个相应的查找和消息构建，我正在尝试使用以下子发送消息。

```
Sub doMail(ByRef MessageBody As String, ByVal nameString As String, ByVal sendTo As ArrayList, Optional ByVal markurgent As Boolean = False, _
                 Optional ByVal sendCC As ArrayList = Nothing, Optional ByVal sendBcc As ArrayList = Nothing)
    Try
        ' Setup Mail Message
        Dim oClient As SmtpClient = New SmtpClient(ConfigurationManager.AppSettings("mail_server").ToString())
        oClient.Timeout = 20000
        'oClient.Port = 50747
        Dim objMessage As New MailMessage()
        objMessage.From = New System.Net.Mail.MailAddress(ConfigurationManager.AppSettings("mail_from_address").ToString, ConfigurationManager.AppSettings("mail_from_name").ToString)
        objMessage.Subject = String.Format("Weekly Hitlist Report ~ {0}", nameString)

        If (ConfigurationManager.AppSettings("debugMode").ToString() = 1) Then
            Dim debugSB As StringBuilder = New StringBuilder

            For Each s As String In sendTo
                debugSB.AppendLine(String.Format("To: {0}<br>", s))
            Next
            For Each s As String In sendCC
                debugSB.AppendLine(String.Format("cc: {0}<br>", s))
            Next
            For Each s As String In sendBcc
                debugSB.AppendLine(String.Format("bcc: {0}<br>", s))
            Next
            MessageBody = String.Format("Debug Mode is Active. <br> {0} <br><hr noshade>{1}", debugSB.ToString, MessageBody)
            objMessage.To.Add(ConfigurationManager.AppSettings("mail_to_address").ToString)
        Else
            For Each receiver As String In sendTo
                Try
                    objMessage.To.Add(receiver.Trim())
                Catch ex As Exception
                    ' do nothing
                End Try
            Next
            For Each receiver As String In sendCC.ToArray
                Try
                    objMessage.CC.Add(receiver.Trim())
                Catch ex As Exception
                    ' do nothing
                End Try
            Next
            For Each receiver As String In sendBcc
                Try
                    objMessage.Bcc.Add(receiver.Trim())
                Catch ex As Exception
                    ' do nothing
                End Try
            Next
        End If

        objMessage.Body = MessageBody
        objMessage.Priority = IIf(markurgent, MailPriority.High, MailPriority.Normal)
        objMessage.IsBodyHtml = True
        oClient.Send(objMessage)
        oClient = Nothing
        Console.WriteLine(String.Format("{1} - message sent - {0} ", nameString, Now()))
    Catch ex As Exception
        Console.WriteLine(ex.Message)
        Console.WriteLine("****************")
        Console.WriteLine(ex.StackTrace)
    End Try
End Sub 
```

我试图将客户端超时时间增加到 20 秒，并且我明确地尝试在每条消息之后通过将其设置为空来关闭与邮件服务器的客户端连接。

一切看起来都可以进行到最后，我已经从下面的输出片段中删除了我们的销售人员姓名。现在一切都来找我了，因为我在调试模式下运行它，我们还没有尝试对整个公司进行实时运行，所以我不知道是否是这样，因为一切都将交给一个收件人。

在我收到错误（连接超时）并且系统恢复后，我会收到在异常之后并且仅在程序终止之后发送的任何消息。在 .NET 的早期版本中，我知道程序必须退出或线程必须在发送消息之前结束，但是我要进行的其他程序在 .NET 4 中通常不再有这个。

输出包括错误；第一部分已被剪断

```
 ...
 4/15/2013 9:46:36 AM - message sent - 
 4/15/2013 9:46:41 AM - message sent - 
 4/15/2013 9:46:46 AM - message sent - 
 4/15/2013 9:46:51 AM - message sent - Store 14 Unassigned
 4/15/2013 9:46:56 AM - message sent - 
 4/15/2013 9:47:01 AM - message sent - 
 4/15/2013 9:47:06 AM - message sent - 
 4/15/2013 9:47:11 AM - message sent - 
 4/15/2013 9:47:16 AM - message sent - 
 4/15/2013 9:47:21 AM - message sent - 
 4/15/2013 9:47:26 AM - message sent - 
 4/15/2013 9:47:31 AM - message sent - 
 4/15/2013 9:47:36 AM - message sent - 
 4/15/2013 9:47:41 AM - message sent - 
 Service not available, closing transmission channel. The server response was: 4.4.1 Connection timed out
 ****************
    at System.Net.Mail.MailCommand.CheckResponse(SmtpStatusCode statusCode, String response)
    at System.Net.Mail.MailCommand.Send(SmtpConnection conn, Byte[] command, String from)
    at System.Net.Mail.SmtpTransport.SendMail(MailAddress sender, MailAddressCollection recipients, String deliveryNotify, SmtpFailedRecipientException& exception)
    at System.Net.Mail.SmtpClient.Send(MailMessage message)
    at HitListRunner_Main.Module1.doMail(String& MessageBody, String nameString, ArrayList sendTo, Boolean markurgent, ArrayList sendCC, ArrayList sendBcc) in C:\Users\markl\Documents\Visual Studio 2010\Projects\HitListRunner\HitListRunner-Main\Module1.vb:line 391
 4/15/2013 9:47:46 AM - message sent - Store 20 Unassigned
 4/15/2013 9:47:51 AM - message sent - Store 98 Unassigned
 4/15/2013 9:47:58 AM - message sent - !! - UNDETERMINED LIST - !!
 ending - enter to exit 
```

我还尝试为每个单独的商店和较小的子集发送。我只在一次为整个公司竞选时才收到此错误。

我在 Exchange 中没有看到任何禁止此操作的内容，也没有看到高消息队列等待。关于发送消息的不同方法或其他尝试的任何建议？（我宁愿不使用第 3 方 dll 或外部组件）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-08-04T12:06:44.927

我经历过这个问题的痛苦。经过 2 年的研究，我无法确定我的 .net 应用程序问题的确切原因。有许多问题和实施选项将有助于最大限度地减少此异常的影响。我们现在处于这个问题不会以明显的方式影响最终用户的地步。

1.  您需要确保在 *.config 中设置了一些 SMTP 配置变量，以帮助调整应用程序以适应您的环境。SMTP 客户端超时、重试尝试、重试之间的时间等。我们发现尝试之间大约有 20 秒，在完全停止工作之前大约有 5 次尝试。
2.  您将需要实现一个日志记录机制来记录它们发生的时间和频率，因此您可以设置上面的变量。我一直在寻找来自机器和服务器事件日志的电子邮件量、一天中的时间、服务包安装、病毒检查器或防火墙干扰，以尝试找出原因。
3.  实施非[Blockingcollection](http://msdn.microsoft.com/en-us/library/dd267312%28v=vs.110%29.aspx)来管理所有电子邮件的发送，因为如果您通过代码发送大量电子邮件，您将遇到 SMTP 4.4.1 超时错误。这是一个[生产者消费者](http://en.wikipedia.org/wiki/Producer%E2%80%93consumer_problem)模式，我发现这是一个相对容易实现的实现，并且在这个问题上非常成功。*队列允许您确保最终*将发送电子邮件。如果你想要一个完整的故障保护，你也可以将该队列持久化到磁盘。我们永远不需要回到那段代码。
4.  在没有第三方工具的情况下，伪造或模拟 .net SMTP 实现来对该问题的代码进行单元测试并不容易。我没有走这条路，因为归根结底有太多我无法控制的部分。基本上我只是假设它总是会失败，并且我放置了很多后备选项来等待问题自行解决。

我们尝试过的事情似乎对 4.4.1 超时异常的频率没有影响。

1.  限制电子邮件发送到交换的速率。
2.  更改他们发送的时间（又名下班时间）
3.  将电子邮件分批成小块，然后通过垃圾收集从内存中清除所有 .net 组件。

希望有帮助。

代码片段

```
''' <summary>
''' Provide a mechanism to throttle the subsequent attempts to send emails.
''' </summary>
''' <param name="emailAddress"></param>
''' <param name="attemptNumber"></param>
''' <remarks>Need to implement a more dynamic function as attempts persist, pause for longer for a number of attempt, then add the email to a failed queue.</remarks>
Private Shared Sub RestBeforeSendingAgain(ByVal emailAddress As String, ByVal attemptNumber As Integer)

    If attemptNumber > 1 Then

        '   Wait 30 seconds in between every attempt, or the value configured in the config file.
        Dim retryIntervalInSeconds As Integer = 30
        If Not String.IsNullOrEmpty(System.Configuration.ConfigurationManager.AppSettings.Item("SMTPFailureReTryIntervalInSeconds")) Then
            Integer.TryParse(System.Configuration.ConfigurationManager.AppSettings.Item("SMTPFailureReTryIntervalInSeconds"), retryIntervalInSeconds)
        End If
        logger.Warn("Problem emailing {0}. Waiting {1} seconds to help clear technical issues.", emailAddress, retryIntervalInSeconds.ToString)
        System.Threading.Thread.Sleep(System.TimeSpan.FromSeconds(retryIntervalInSeconds))

    End If
End Sub

    ''' <summary>
''' Attempt to send an email message and record any issues with that mailmessage to the application log.
''' Allows the process to know the success or failure of that approach.
''' </summary>
''' <param name="mailClient"></param>
''' <param name="mailMessage"></param>
''' <param name="attemptNumber"></param>
''' <returns>The success or failure of the SMTP server to send the message without causing an error.</returns>
''' <remarks></remarks>
Private Shared Function AttemptToSendEmail(ByRef mailClient As System.Net.Mail.SmtpClient, ByRef mailMessage As MailMessage, ByVal attemptNumber As Integer) As Boolean
    Dim result As Boolean = False
    Try
        logger.Trace("Started: AttemptToSendEmail", attemptNumber)

        RestBeforeSendingAgain(mailMessage.To.ToString, attemptNumber)
        mailClient.Send(mailMessage)
        result = True

    Catch smtpEx As SmtpException
        result = False
        logger.ErrorException(String.Format("{3}{1}{0}{1}{2}", ExceptionFormater.FormatException(smtpEx), Environment.NewLine, ExceptionFormater.FormatStack(smtpEx), "AttemptToSendEmail failed with Smtp exception."), smtpEx)

    Catch ex As Exception
        result = False
        logger.ErrorException(String.Format("{3}{1}{0}{1}{2}", ExceptionFormater.FormatException(ex), Environment.NewLine, ExceptionFormater.FormatStack(ex), "AttemptToSendEmail failed with generic exception."), ex)

    Finally

        If result Then
            logger.Trace("Succeeded: To email {0} on attempt {1}.", mailMessage.To.ToString, attemptNumber)
        Else
            logger.Warn("Failed: To email {0} on attempt {1}.", mailMessage.To.ToString, attemptNumber)
        End If

    End Try

    Return result

End Function

'   Configure the timeout in milliseconds from the App.Config file.
'   200 seconds = 200,000 miliseconds
MySmtpClient.Timeout = CInt(TimeSpan.FromSeconds(SmtpClientTimeoutSeconds).TotalMilliseconds) 
```

# jquery - 如何使用 jquery 遍历一组具有数据属性值的元素？

> ID：16019265
> 
> 赞同：1
> 
> 时间：2013-04-15T15:39:40.430
> 
> 标签：jquery

如何使用 jquery 遍历一组具有数据属性值的元素？我试过这个... alert(variableName); // 有效

```
 $("SectionATable tr [data-testlog='"+variableName+"']").each(function()
    {
                alert("sectionA log");
    }); 
```

萤火虫中没有错误显示....

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T15:41:23.547

你有一些小的语法错误，试试这个：

```
$("#SectionATable tr [data-testlog="+variableName+"]").each(function(){
    alert("sectionA log");
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T15:41:48.763

属性等于选择器 [name="value"]

这里是选择 [http://api.jquery.com/category/selectors/](http://api.jquery.com/category/selectors/)

# c++ - 为什么 Dispatches 连续开始需要不同的时间？

> ID：16019266
> 
> 赞同：0
> 
> 时间：2013-04-15T15:39:43.607
> 
> 标签：c++, compute-shader, directcompute

我有这个程序：

```
 for (int i = 0; i < STEPS; ++i)
        {
            context->CSSetShader(computeShader, NULL, 0);

            ID3D11UnorderedAccessView *aUAViews[1] = {bufferOut_UAV};
            context->CSSetUnorderedAccessViews(0, 1, aUAViews, NULL);

            context->Dispatch(32, 32, 1);
            in[i] = t.GetTime();

            if (i == STEPS / 2)
            {
context->End(pEventQuery);
while( context->GetData( pEventQuery, NULL, 0, 0 ) == S_FALSE ) {}
            }
        }

        double out = t.GetTime();

context->End(pEventQuery);
while( context->GetData( pEventQuery, NULL, 0, 0 ) == S_FALSE ) {} 
```

第一次迭代仅持续 26 毫秒，而第二次 46 毫秒？

以防万一着色器：

```
RWStructuredBuffer<float> Output : register(u0);

[numthreads(GROUP_SIZE_X, GROUP_SIZE_Y, 1)]
void arrayTest(uint3 DTid : SV_DispatchThreadID)
{
    float i = DTid.x * 32 + DTid.y;
    Output[i] = 0;
    for (int k = 0; k < 100; ++k)
    {
        Output[i] += sqrt(i + k);
    }
} 
```

但我不认为每次开始都需要不同的时间。

**有趣**的是，如果我注释掉 ''if (i == STEPS / 2)'' 行，两半花费几乎相同的时间。

编辑：据我目前所见，这是因为兑现

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T15:45:49.580

最有可能的候选者（在我看来）是操作系统中线程之间的上下文切换。需要较长时间的操作更有可能在中间的某个时间被操作系统暂停。

在任何特定时刻，您的程序并不是唯一发生的事情，有时操作系统会让您暂停，而其他事情会占用一些处理时间。

# gcc - 从 .c 和 .s 文件 gcc 创建 .exe

> ID：16019269
> 
> 赞同：1
> 
> 时间：2013-04-15T15:39:46.737
> 
> 标签：gcc

我有一个用 C 语言编写的 .c 文件，它调用一个在 .s 文件中用汇编语言编写的函数。

如何从这两个创建可执行文件？我知道我必须使用标志 -o，但由于某种原因，它没有按我的预期工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T15:41:50.067

只需在命令行上指定所有文件。Gcc 通过查看文件扩展名知道如何处理它们。

```
gcc file1.c file2.s -o foo 
```

应该可以解决问题，除非您忘记向我们提供有关要链接哪些其他库的更多信息。

# php - 会话变量在 readfile php 方法中不起作用

> ID：16019271
> 
> 赞同：3
> 
> 时间：2013-04-15T15:39:51.617
> 
> 标签：php, session-variables, readfile

我有如下的php代码。该变量`$_SESSION['url']`具有值并按原样打印。如果我调用会话变量，它就不起作用。

```
session_start();
header('Content-type: application/pdf');
readfile($_SESSION['url']); 
```

但它的工作，如果我们写如下。

```
session_start();
$_SESSION['url']= 'http://samplepdf.com/sample.pdf';
header('Content-type: application/pdf');
readfile($_SESSION['url']); 
```

如果有人遇到过这种情况，如何解决？提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T17:31:58.457

在`$_SESSION`脚本的持续时间内，它（几乎）像任何其他变量一样可变。因此，如果您将其写在脚本的一行上，您可以稍后再阅读。无论会话在您的环境中是否有效。

因此，您的第二个示例有效也就不足为奇了。它没有显示任何可以帮助解释您的问题的内容。

相反，您应该向我们展示您为使会话正常工作所做的尝试。您在哪里以及如何实际设置`url`会话变量？

# visual-studio-2010 - 新文件的 Visual Studio 扩展点

> ID：16019272
> 
> 赞同：0
> 
> 时间：2013-04-15T15:40:02.673
> 
> 标签：visual-studio-2010, visual-studio, visual-studio-2012, visual-studio-addins, visual-studio-extensions

我需要在 Visual Studio 2012 中为 aspx\ascx 文件替换默认命名约定。有什么办法可以做到吗？

作为一种可能的解决方案，我认为我可以制作将订阅一些 Visual Studio 2010\2012 扩展点的扩展，以将旧的命名约定替换为新的命名约定。但是有没有办法拦截文件创建？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T10:15:18.967

创建一个新的`Project Template`可能会有所帮助。

[http://msdn.microsoft.com/en-in/library/s365byhx(v=vs.100).aspx](http://msdn.microsoft.com/en-in/library/s365byhx(v=vs.100).aspx)

# web-services - 如何从 bpel 布尔变量中获取返回值？

> ID：16019274
> 
> 赞同：1
> 
> 时间：2013-04-15T15:40:05.617
> 
> 标签：web-services, bpel

我是 BPEL 的新手。我正在调用 Web 服务来填充 BPEL 变量：

```
<bpel:variable name="hasASkillOutput" messageType="ns2:personHasSkillResponse"></bpel:variable>
....
<bpel:invoke name="call_personHasASkill"  partnerLink="SkillPossessionService"  operation="personHasSkill"  portType="ns2:SkillPossessionServicePortType"
                inputVariable="hasASkillInput" outputVariable="hasASkillOutput"></bpel:invoke> 
```

我调用的服务返回一个布尔值。如何将该值作为条件表达式的一部分访问？

```
 <bpel:if name="DoesPersonHaveTheSkill">
                <bpel:condition><hasASkillOutput is true></bpel:condition>
        </bpel:if> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T19:23:11.867

messageType 的结构`personHasSkillResponse`在由您的 partnerLink 链接的 WSDL 中定义`SkillPossessionService`。您必须在那里查找该结构，然后您可以在您的中使用普通的 XPath 1.0 表达式`condition`并引用该变量`hasASkillOutput`。

例如，如果您的消息类型定义如下所示：

```
<message name="personHasSkillResponse">
    <part name="skillResponse" element="xsd:boolean"/>
</message> 
```

您的情况必须如下所示：

```
 <bpel:if name="DoesPersonHaveTheSkill">
            <bpel:condition>$hasASkillOutput.skillResponse</bpel:condition>
    </bpel:if> 
```

# python-2.7 - DF 中两列之间首次更改（和差异）的滚动记录

> ID：16019275
> 
> 赞同：0
> 
> 时间：2013-04-15T15:40:05.877
> 
> 标签：python-2.7, pandas, time-series

我的数据存储在熊猫数据框中。

规则：

_存储出现在 col1 或 col2 中的第一个值。（这里是 df["col2"][0]）。

_ 增加行数，如果下一个数字连续出现在同一列，则忽略。

_ 值第一次出现在备用列中时取差值...

_ 仅在第一次更改列时为两列保留值的滚动记录。

```
 Psedo-code e.g. based on sample data (plse see below): 

                df["new"][0]=df["col2"][0]-df["col1"][4]

                  Store df["col1"][4]

                df["new"][1]=df["col2"][9]-df["col1"][4]

                   Store df["col1"][9]

                df["new"][2]=df["col2"][9]-df["col1"][11]

                       etc
                       etc
                       etc
                        .
                        .
                        .

index    col1     col2

0                   46.84
1                   46.84
2                   46.84
3                   46.84
4       44.9501 
5       44.9731 
6       45.0229 
7       45.048  
8       45.0753 
9                 45.0753
10                45.0753
11     46.84
12     45.0229
13     44.9501
14     46.75
15     46.75
16     44.9731
17                 44.9501
18                 45.0229
19                 45.0229
20                 46.75 
```

框架中有数千行。非常感谢您对最佳方式的想法。

这是我的脚本的链接：

[https://www.dropbox.com/s/5od59ejprwzu6ii/algo1.py](https://www.dropbox.com/s/5od59ejprwzu6ii/algo1.py)

* * *

编辑： user1827356 在下面的评论部分中的建议。

* * *

```
 df['mapnl']= np.where(df['group']%2 == 0, df['result'], -df['result']) – 
```

我尝试了以下行来解决此问题，以尝试否定所有其他值：

```
df['mapnl'] = df.apply(lambda row: row['result'] if row['group']%2 == 0 else -row['result'], axis=1) 
```

它给出的结果与 user1827356 的建议相同。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T19:23:23.190

这可能会有所帮助

```
df['col'] = np.where(df.col1.isnull(), 'col2', 'col1')

df['group'] = (df.col != df.col.shift(1)).astype('int').cumsum()

df['value'] = np.where(df.col1.isnull(), df['col2'], df['col1'])

df['first'] = df.value.groupby(df.group).transform(lambda s: s.iget(0))

df
       col1     col2   col  group    value    first
0       NaN  46.8400  col2      1  46.8400  46.8400
1       NaN  46.8400  col2      1  46.8400  46.8400
2       NaN  46.8400  col2      1  46.8400  46.8400
3       NaN  46.8400  col2      1  46.8400  46.8400
4   44.9501      NaN  col1      2  44.9501  44.9501
5   44.9731      NaN  col1      2  44.9731  44.9501
6   45.0229      NaN  col1      2  45.0229  44.9501
7   45.0480      NaN  col1      2  45.0480  44.9501
8   45.0753      NaN  col1      2  45.0753  44.9501
9       NaN  45.0753  col2      3  45.0753  45.0753
10      NaN  45.0753  col2      3  45.0753  45.0753

df['first'].diff(1).groupby(df.group).first()
group
1           NaN
2       -1.8899
3        0.1252 
```

# sharepoint-2010 - 从 Sharepoint 组中获取所有用户 - 排除隐藏的系统帐户

> ID：16019280
> 
> 赞同：1
> 
> 时间：2013-04-15T15:40:15.997
> 
> 标签：sharepoint-2010

我想获取 Sharepoint 组中的所有用户，因为它们出现在屏幕上（标准的 Sharepoint 屏幕，您可以在其中查看该组的用户列表）。

但是，当我使用组的用户属性时，它正在检索一个名为“系统帐户”的附加用户，这似乎是站点管理员。

有没有办法让所有用户排除这个用户。另外，奇怪的是这个 SPUser 的 IsSiteAdmin 属性是假的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-07-30T14:32:59.097

如果您以 SystemAccount（应用程序池身份或场帐户）身份登录，则会自动将其添加为该组的成员。

请勿在以系统帐户登录时创建群组，以避免此类情况。

要从网站集中的所有组中删除系统帐户，请查看 [此帖子](https://naimmurati.wordpress.com/2014/07/30/remove-system-account-from-a-sharepoint-group-with-powershell/)。

# ruby - 如何在邮件 gem 中使用 body erb 模板？

> ID：16019282
> 
> 赞同：2
> 
> 时间：2013-04-15T15:40:31.787
> 
> 标签：ruby, email, pony

我想在邮件 erb 模板中用作正文。当我在 Pony gem 上设置它时它可以工作。

```
post 'test_mailer' do
  Mail.deliver do
    to ['test1@me.com', 'test2@me.com']
    from 'you@you.com'
    subject 'testing'
    body erb(:test_mailer) # this isn't working
  end
end

private

fields = [1, 2] # some array 
```

**ERB 文件**

```
<% fields.each do |f| %>
  <%= f %>
<% end %> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-15T19:24:10.057

假设您使用 Pony 的原始 Sinatra 路线如下所示：

```
post 'test_mailer' do
  Pony.mail :to => ['test1@me.com', 'test2@me.com'],
            :from => 'you@you.com',
            :subject => 'testing',
            :body => erb(:test_mailer)
end 
```

可以看到这里的 email 属性是由一个 Hash 指定的。当切换到使用 Mail gem 时，它的属性由在特定上下文中调用的块定义，以便这些特殊方法可用。

我认为这个问题可能与`erb`在块内调用有关。您可以尝试以下几件事：

尝试以可以传递到块中的方式生成 ERB：

```
post 'test_mailer' do
  email_body = erb :test_mailer, locals: {fields: fields}
  Mail.deliver do
    to ['test1@me.com', 'test2@me.com']
    from 'you@you.com'
    subject 'testing'
    body email_body
  end
end 
```

或者全局调用 ERB 而不是使用 sinatra 助手：

```
post 'test_mailer' do
  context = binding
  Mail.deliver do
    to ['test1@me.com', 'test2@me.com']
    from 'you@you.com'
    subject 'testing'
    body ERB.new(File.read('views/test_mailer.erb')).result(context)
  end
end 
```

# android - Android猴子测试选择特定活动

> ID：16019290
> 
> 赞同：7
> 
> 时间：2013-04-15T15:40:52.187
> 
> 标签：android, android-activity, monkey-testing

我正在使用[Android 猴子测试](http://developer.android.com/tools/help/monkey.html)来测试我的 android 应用程序，它适用于我的应用程序，并且非常酷。但我想具体测试一个应用程序活动，我该怎么做？

今天我正在测试所有应用程序：

```
$ adb shell monkey -p my.package -c android.intent.category.HOME -c android.intent.category.DEFAULT -v 500 -s "a random number" 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-15T19:35:32.823

使用[Android 猴子测试](http://developer.android.com/tools/help/monkey.html)我无法测试特定活动，但使用[Android 猴子运行](http://developer.android.com/tools/help/monkeyrunner_concepts.html)器我可以执行 python 脚本来模拟猴子测试，所以我做了一个 python 脚本打开我的活动并初始化猴子测试:)

```
#! /usr/bin/env monkeyrunner

from com.android.monkeyrunner import MonkeyRunner, MonkeyDevice
from random import randint

print "get device"
device = MonkeyRunner.waitForConnection()
package = 'my.packaget'
activity = 'my.package.activity'
runComponent = package + '/' + activity
device.startActivity(component=runComponent)

#use commands like device.touch and device.drag to simulate a navigation and open my activity

#with your activity opened start your monkey test
print "start monkey test"
for i in range(1, 1000):
    #here i go emulate only simple touchs, but i can emulate swiper keyevents and more... :D
    device.touch(randint(0, 1000), randint(0, 800), 'DOWN_AND_UP')

print "end monkey test" 
```

保存 teste.py 并运行

```
$ monkeyrunner teste.py 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-05-22T17:14:20.180

这对我有用。`category`在清单中添加：

```
<activity android:name="MonkeyActivity">
    <intent-filter>
        <action android:name="android.intent.action.MAIN" />
        <category android:name="android.intent.category.MONKEY" />
    </intent-filter>
</activity> 
```

将在哪里`MonkeyActivity`执行用于测试和从 shell 的初始化设置：

```
adb shell monkey -p my.package -c android.intent.category.MONKEY -v 500 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-15T15:57:59.403

从文档：

> -c 如果您以这种方式指定一个或多个类别，Monkey 将只允许系统访问以指定类别之一列出的活动。如果您不指定任何类别，Monkey 将选择以 Intent.CATEGORY_LAUNCHER 或 Intent.CATEGORY_MONKEY 类别列出的活动。要指定多个类别，请多次使用 -c 选项 — 每个类别一个 -c 选项。

因此，您从命令中删除了 DEFAULT 和 LAUNCHER 类别，将 MONKEY 添加到要在清单中测试的活动中，命令现在很简单：

```
$ adb shell monkey -p my.package -c -v 500 -s "a random number" 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-08-19T18:17:30.023

对我来说刚刚工作过：

```
-c android.intent.category.LAUNCHER 
```

根据我的清单标准类别条目：

```
<activity
                android:name="pl.com.infinitysoftware.carassistant.app.CarAssistantMainActivity"
                android:label="@string/app_name"
                android:launchMode="singleTask"
                android:configChanges="orientation|screenSize">
                <intent-filter>
                    <action android:name="android.intent.action.MAIN" />
                    <category android:name="android.intent.category.LAUNCHER" />
                </intent-filter>
</activity> 
```

# couchdb - Couchdb 复制：使用哪种协议？

> ID：16019294
> 
> 赞同：2
> 
> 时间：2013-04-15T15:41:06.720
> 
> 标签：couchdb, replication, network-protocols

我使用[couchdb](http://couchdb.apache.org/)已经有一段时间了。我喜欢这样，但我一直在使用独立配置。

现在我正在尝试建立一个由 coucdbs 的“联盟”组成的严肃系统。（即一个集群）。我知道最适合使用的工具是[coudhb-lounge](http://tilgovi.github.io/couchdb-lounge/)，但现在我必须了解这种架构是否可持续。特别是在数据量方面。

我试图从以下来源获取尽可能多的信息[使用 CouchDB 进行复制的一种方式](https://stackoverflow.com/questions/6152158/one-way-replication-with-couchdb)， [CouchDB 复制协议是什么？它像Git吗？](https://stackoverflow.com/questions/4766391/what-is-the-couchdb-replication-protocol-is-it-like-git), [CouchDB Replication Protocol](http://www.dataprotocols.org/en/latest/couchdb_replication.html)，但我仍然觉得我需要一些支持。

所以，作为第一组问题，我试图理解：

1.  我在这篇文章中搜索了一下，从[这篇](http://www.dataprotocols.org/en/latest/couchdb_replication.html)[文章](https://stackoverflow.com/questions/4766391/what-is-the-couchdb-replication-protocol-is-it-like-git)中我了解到它可以通过 HTTP 工作。对海量数据真的有效吗？
2.  是否可以每天复制 10Gb 的数据而不会遇到任何严重的负载问题？
3.  如果速度很慢，更改 couchdb 复制协议需要多少 erlang 编程？我是否必须认真破解代码或 couchdb 设想也使用不同的协议？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-06T01:26:07.397

没有“同步协议”，同步使用的是常规 API。这里对算法有一个松散的描述，以及对性能的一些评论：

[https://github.com/couchbaselabs/TouchDB-iOS/wiki/Replication-Algorithm](https://github.com/couchbaselabs/TouchDB-iOS/wiki/Replication-Algorithm)

至于您的情况，如果您需要大型复制设置，还可以考虑 CouchBase。CouchBase 是由设计 CouchDb 的同一个人设计的，第二次设计时，他们将重点放在复制性能 iirc 上。

# python - python反斜杠正则表达式的乐趣

> ID：16019295
> 
> 赞同：1
> 
> 时间：2013-04-15T15:41:07.100
> 
> 标签：python, regex

```
unc = r'\\foo\bar'
string1 = r'\\foo\bar'
string2 = r'\\\\foo\\bar'

if unc == string1:
    print "I wish to make a complaint"

if re.match(string1, unc):
    print "Ello miss"

if re.match(string2, unc):
    print "Sorry I have a cold" 
```

输出是：

```
I wish to make a complaint
Sorry I have a cold 
```

似乎 re.match 操作重新转义了文字字符串，因此“Ello miss”永远不会发生。

谁能解释为什么我必须在首先将字符串设置为文字时重新转义反斜杠？

我想在配置文件中保留一个 UNC 路径列表，并且我不想在其中转义字符串。虽然比较器工作，但有一个可用的正则表达式选项会很有用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T15:44:34.170

字符是正则表达式中的`\`特殊字符，必须转义才能按字面意思理解。因此，要匹配 string `\\foo\bar`，您需要 regex `\\\\foo\\bar`，正如您所发现的那样。您可以使用该函数`re.escape`为您创建这样的正则表达式，以包含在更大的表达式中。

```
>>> re.escape(r'\\foo\bar')
'\\\\\\\\foo\\\\bar'           # ouch 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-15T15:44:27.920

在正则表达式模式中，反斜杠也有意义*，*需要显式转义。

因此，`\\`意味着：匹配一个文字`\`字符。

如果要将文字文本传递给`re.match()`，则需要首先使用 first 转义任何可能的元字符[`re.escape()`](http://docs.python.org/2/library/re.html#re.escape)。

# typo3 - 德语中的powermail错误消息

> ID：16019296
> 
> 赞同：0
> 
> 时间：2013-04-15T15:41:12.533
> 
> 标签：typo3, typoscript

嗨，我遇到了 Powermail 的问题。

我希望错误消息是德语的。我读到我必须在打字稿中配置配置：

我试过这个：

```
locale_all = de_CH.utf8
index_enable = 1
 sys_language_uid = 0
 language = de 
```

但什么也没发生。

任何人都可以帮助我如何正确配置它，它可以用德语工作。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T15:43:30.737

我认为你的语言环境是错误的。

它一定要是

```
de_CH.UTF-8 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T09:06:24.300

看起来你有一个错误的 locale_all 设置。

如果您使用的是 Linux 服务器，请键入

> 语言环境

在您的控制台中。在输出中搜索名为 LANG 的变量，例如

> LANG=de_CH.UTF-8

这是您必须在 TYPO3 中用作 locale_all 的内容（没有“LANG =”）。

# debugging - 来自类路径的 GroovyShell 调试脚本

> ID：16019297
> 
> 赞同：0
> 
> 时间：2013-04-15T15:41:15.710
> 
> 标签：debugging, groovy, scripting, classloader, groovyshell

当通过 GroovyShell 调用时，[这确实对我调试 Groovy 脚本有很大帮助。](https://stackoverflow.com/questions/4833213/debugging-scripts-loaded-with-groovyshell-in-eclipse)但是，这仍然只适用于通过完全限定的文件名（例如 file:///home/user/x/src/main/groovy/package/File.groovy）加载脚本时。

当我使用

```
URL url = Thread.currentThread().getContextClassLoader().getResource("src/main/groovy/package/File.groovy");
shell.parse(new File(url.toURI)); 
```

它失败了（预先设置了启用调试的编译器配置）。

因此，我的脚本驻留在类路径中并分配了包。它们同时执行（通过 File 直接和通过 File+Classloader 资源） - 但 IDE 调试仅在将其称为文件资源时才有效（相对！所以带有“错误”的 src/main/groovy/ 前缀。

仅供参考 - 脚本稍后应包含在 JAR 文件中，整个应用程序将作为 WAR 执行。

关于我可以尝试什么的任何提示？

谢谢和最好的问候，蒂莫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T11:45:16.910

因此，无论我尝试什么（在文件、URL 和 URI 之间 - 使用和不使用直接类加载器）至少在一种情况下都失败了：

*   WAR 运行时（在依赖 JAR 中时）
*   从 Maven 启动的单元测试
*   从 IDE 启动的单元测试

现在，我管理所有三种情况的唯一方法是直接使用 GroovyCodeSource：

```
CompilerConfiguration cc = CompilerConfiguration.DEFAULT   
cc.setDebug(true)    
def shell = new GroovyShell(
    Thread.currentThread().getContextClassLoader(), 
    binding, 
    cc
)

scriptUrl = Thread.currentThread().getContextClassLoader().getResource(it);   
GroovyCodeSource gcs = new GroovyCodeSource(scriptUrl);

Script s = shell.parse(gcs);
s.run(); 
```

# java - 是否可以从 Java 中的另一个文件导入一组导入语句？

> ID：16019303
> 
> 赞同：-1
> 
> 时间：2013-04-15T15:41:36.353
> 
> 标签：java, include

我不相信 Java 中存在这个特性，并且可能是有充分理由的，但偶尔我喜欢`import static`多个类中的很多方法，甚至`import static <package>.<Class>.*`是多种类（主要用于静态上下文，如 C）。Java 显然没有任何`include`特性，我可以`include imports`，所以我想知道是否有任何 IDE 插件（Eclipse 或 IntelliJ）或其他工具来支持这种特性？

也就是说：在Java中是否可以从另一个文件中导入一组import语句？

旁注：我很清楚这种类型的编码是违反 Java 风格的，并且可能会误导其他人阅读我的代码，但这主要是针对爱好项目的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T15:51:55.197

你是对的：这是 IDE 的责任。在 Eclipse 中按 Ctrl-Shift-O 以优化导入或在键入时按 ctrl+空格。

Eclipse 也具有静态导入功能。转到首选项并输入“收藏夹”。添加您经常用来导入静态成员的类。现在导入优化也适用于静态导入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T16:00:20.410

如果您要导入一堆相同的东西——无论是类还是静态方法，您还应该考虑是否缺少一些外观 API。

即使是业余项目，您也可能需要编写一些实用程序 API、抽象或基类。然后，您导入单个实用程序类，而不是该实用程序的所有实现细节。

让我给你举个例子。假设您发现自己正在阅读一些文本文件并使用正则表达式从每一行中提取一些内容。您可以轻松编写一个类似迭代器的 API，其构造函数采用文件名和正则表达式。

# javascript - 联系表格 PhoneGap API + Javascript + HTML5

> ID：16019306
> 
> 赞同：0
> 
> 时间：2013-04-15T15:41:45.057
> 
> 标签：javascript, html, cordova

我正在尝试使用 PhoneGap API 以及用于表单布局的 javascript 和 HTML5 创建一个联系表单。通过联系表格，我的意思是我希望能够添加新联系人并搜索现有联系人。到目前为止，我遵循了 Adob​​e 网站上的教程/视频来执行此操作。

一些注意事项： * 我必须使用 PhoneGap 1.9.0 * 它必须在 Android 2.3.3 Level 10 上运行 * 我不是一个过于自信的程序员

我的代码是：

JS

```
 $( document ).bind( 'deviceready', function() {

    $('#btnCreate').bind('touchstart', function() {
        var contact = navigator.contacts.create();
        var name = null;

        contact.displayName =
        $( 'txtFirst' ).attr('value') + ' ' +       $( 'txtLast' ).attr('value');

        contact.nickname =
        $( 'txtFirst' ).attr('value') + ' ' +       $( 'txtLast' ).attr('value');

        name = new ContactName();
         name.givenName = $( 'txtFirst' ).attr('value');
         name.familyName = $( 'txtFirst' ).attr('value');
         contact.name = name;

         contact.emails = [
         new ContactField ( 'home', $( '#txtEmail' ).attr('value'), true )];

         contact.phoneNumbers = [
         new ContactField ( 'mobile', $( '#txtMobile' ).attr('value'), true )];

         contact.save(function() {

             $('#txtFirst').attr('value', '');
             $('#txtLast').attr('value', '');

         $('#txtEmail').attr('value', '');

         $('#txtMobile').attr('value', '');
         }, function() {
             console.log( 'Error' );
         } );
    } );

    $( '#btnFind' ).bind( 'touchstart', function() {

        var fields = ['*'];
        var options = {
            filter: $( '#txtLast' ).attr( 'value' ), multiple:true };

            navigator.contacts.find( fields, function(contacts) {
                $( '#txtFirst').attr('value', contacts[0].name.givenName );
                $( '#txtLast').attr('value', contacts[0].name.familyName );
                $( '#txtEmail').attr('value', contacts[0].emails[0].value );
                $( '#txtMobile').attr('value', contacts[0].phoneNumber[0].value );
            }, function(error) {
                console.log('Error');
            },
            options );
    });

}); 
```

HTML5

```
 <div data-role="content">
      <div id="contactContainer" >

<form id="lblFirst" > First Name: </form>
<input id="txtFirst" placeholder="First Name"/>

<form id="lblLast"> Last Name: </form>
<input id="txtLast" placeholder="Last Name"/>

<form id="lblEmail"> Email: </form>
<input id="txtEmail" placeholder="Email"/>

<form id="lblMobile"> Phone : </form>
<input id="txtMobile" placeholder="Phone"/>

<button id="btnCreate" data-corners="false">Create Contact </button>
<button id="btnFind" data-corners="false"> Find Contact </button>
       </div>
    </div> 
```

谢谢你的时间

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-31T14:59:04.477

您可能需要检查[ContactPicker](https://github.com/hazemhagrass/ContactPicker)插件以使用本机 ui 创建和搜索联系人，您所要做的就是自己添加文件并更新配置文件，而无需使用 phonegap cli。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-31T12:08:31.870

您必须使用 Phonegap/Cordova 中的[Contact 插件](http://docs.phonegap.com/en/edge/cordova_contacts_contacts.md.html#Contacts)。也许[这个视频教程](http://www.youtube.com/watch?v=10vQTzfL9s8)可以帮助你，因为它向你展示了如何使用 HTML5 和 PhoneGap 在用户的移动设备上创建联系人。

# java - 使用带有图像的 SQLite db 时如何支持多种屏幕尺寸？

> ID：16019308
> 
> 赞同：0
> 
> 时间：2013-04-15T15:41:47.543
> 
> 标签：java, android, sqlite

我知道我可以使用来自 ldpi、mdpi 和 hdpi 可绘制对象的不同 dpi 图像，但我使用的是填充有图像的 sqlite 数据库。那么如何使用不同的dpi来支持多种屏幕尺寸呢？我应该使用 3 个具有不同 dpi 的表吗？如果是，如何触发这些表在不同的屏幕上使用？

# java - 在 Eclipse 上创建两个 Android 项目

> ID：16019317
> 
> 赞同：0
> 
> 时间：2013-04-15T15:42:08.900
> 
> 标签：java, android, eclipse, project

使用 Eclipse（在 Android 上开发）我想创建第二个项目，它与第一个项目相同，但有些类不同。

确切地说，我正在创建一个 Android 应用程序，我想提供免费版本和高级版本。实际上，项目的代码是相同的，但改变了一些类。

问题是我不想支持两个项目。如果我修改一个类，那么我必须在另一个项目上修改相同的更改。这是非常多余的。

此外，项目被推送到远程 GIT 存储库。

最后一点，Andriod 应用程序是使用他的根包来识别的，例如：com.example.myapp

所以，我需要两个不同的根包（所以我需要创建新文件夹），例如 com.example.myappfree 和 com.example.myapppremium

在 Eclipse 中创建两个共享包和类的 java 项目，但更改两到三个类的最佳解决方案是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T15:44:32.513

创建一个通用代码项目并从其他两个项目中引用该项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T15:48:31.010

这并不是应该的那么简单，但您可能希望在 Eclipse 中使用 Android 项目的库功能：

[http://developer.android.com/tools/projects/projects-eclipse.html#SettingUpLibraryProject](http://developer.android.com/tools/projects/projects-eclipse.html#SettingUpLibraryProject)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-15T15:49:21.323

将您希望在其他 andorid 项目中引用的项目作为库项目。你在你的android项目中引用库项目

使您的项目成为图书馆项目。右击项目。转到属性选择android。选择是库。单击应用并单击确定

![在此处输入图像描述](https://i.stack.imgur.com/v36hh.png) 她是链接中的一个示例，我在其中发布了如何引用 actionbarsherlock 的快照，它是 Android 项目中的一个库项目。

[导入 actionbarsherlock 时无法解析 import .R](https://stackoverflow.com/questions/16003396/import-r-cannot-be-resolved-when-i-import-actionbarsherlock/16003930#16003930)。

指向开发者网站的链接

[http://developer.android.com/tools/projects/projects-eclipse.html#ReferenceLibraryProject](http://developer.android.com/tools/projects/projects-eclipse.html#ReferencingLibraryProject)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-15T15:56:15.267

您可以使用图书馆项目来做到这一点。基本上，您将采用您的主项目，该项目将采用所有代码并将其转换为库。创建两个新项目，免费版和付费版。

[在此处阅读](http://developer.android.com/tools/projects/projects-eclipse.html)如何设置库项目。

您必须确保免费和付费项目具有不同的包名称，并且在您的库项目中，您阅读包名称并验证您运行的是免费版本还是付费版本。

[在这里](https://github.com/gameower/LearningNumbersProject)你可以看到我发布的一个工作示例。整个资源都在图书馆项目上，其他的只使用不同的资源。

查看[PackageSelector 类](https://github.com/gameower/LearningNumbersProject/blob/master/LearningNumbersFull/src/learning/numbers/pro/PackageSelector.java)。它展示了如何检测正在运行的版本，然后相应地更改应用程序很简单。

```
public class PackageSelector extends Application {

public int getVersion() {       
    if (getPackageName().toLowerCase().contains("pro")) 
     return LanguagePickActivity.FULL;
    else if (getPackageName().toLowerCase().contains("macedonian")) 
     return LanguagePickActivity.MACEDONIAN;
    else if (getPackageName().toLowerCase().contains("german")) 
         return LanguagePickActivity.GERMAN;        
    else // if (getPackageName().toLowerCase().contains("spanish")) 
     return LanguagePickActivity.SPANISH;
}
} 
```

关于你的活动：

```
public void getVersion()  {
    Country =  ((PackageSelector)getApplication()).getVersion(); 
 } 
```

当您有与单个版本相关的内容时：

```
 if (Country == LanguagePickActivity.FULL ) { 
            //Do something only the paid version has
        finish();
    }
    else {
     //Do something on the free version
     finish();
 } 
```

# android - 如果我使用 Galaxy Nexus，为什么从 value-mdpi 中获取价值

> ID：16019318
> 
> 赞同：6
> 
> 时间：2013-04-15T15:42:13.037
> 
> 标签：android

我已经在和文件夹中`dimens.xml`定义了。我期望设备（即）的值取自，但实际上它取自。为什么呢？谢谢你。`values``values-mdpi``Galaxy Nexus``xhdpi``values``values-mdpi`

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-15T16:04:40.457

您必须为`values-xhdpi`.
`values`是默认文件夹，但如果您指定带有限定符的文件夹（此处，`values-mdpi`），系统将使用带有限定符的最佳专用文件夹（此处`values-mdpi`）

如果添加`values-hdpi`文件夹，它将用于`values-mdpi`xhdpi 的屏幕。

如果您添加一个`values-xhdpi`文件夹，它将在 xhdpi 的屏幕上使用前两个文件夹。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-15T15:52:04.477

检查[http://developer.android.com/guide/topics/resources/providing-resources.html#BestMatch](http://developer.android.com/guide/topics/resources/providing-resources.html#BestMatch)

您会看到，像素密度限定符并未从 Android 解析资源查找位置的方式中删除。

# c# - 为什么枚举会这样？

> ID：16019320
> 
> 赞同：1
> 
> 时间：2013-04-15T15:42:24.670
> 
> 标签：c#, .net, enums

今天在摆弄 Enums 时，我从 C# 编译器中遇到了一些稍微奇怪的行为。

```
enum FunWithEnum
{
    One = 1,
    Two,
    Three,
    Four = 1,
    Five = 2,
    Six
} 
```

结果：

*   FunWithEnum.One = 一
*   FunWithEnum.Two = 两个
*   FunWithEnum.Three = 三
*   FunWithEnum.Four = 一
*   FunWithEnum.Five = 二
*   FunWithEnum.Six = 三

有人可以向我解释为什么这些值是它们编译后的值吗？

我最初的猜测与使用枚举时能够拥有别名有关。但我不知道这是否有意义。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-15T15:56:29.007

根据[文档](http://msdn.microsoft.com/en-gb/library/sbbt4032%28v=vs.80%29.aspx)

`the value of each successive enumerator is increased by 1.`

以这个为基础

```
One = 1,
Two,  // = 2
Three,  // = 3
Four = 1,
Five = 2,
Six //== 3 
```

还有[另一个问题的答案](https://stackoverflow.com/a/4592564/265419)

未定义多个枚举具有相同值时 ToString 将返回的内容

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-15T15:45:50.103

我在提供的代码中看到的值*从未*由编译器分配，它是由编码器编写的。所以

*   *或者这是一个导致混乱的错误（让不同的枚举成员具有相同*的关联编号并没有多大意义）
*   或者它是处理一些旧/遗留系统的代码，开发人员必须引入一些新值（出于开发商品或其他 1000 个原因），但仍与系统本身保持向后兼容。因此，这是一种扩展一些无法触及的非常旧代码的功能的解决方法。

# objective-c - 由于未捕获的异常“NSInternalInconsistencyException”Xcode而终止应用程序

> ID：16019325
> 
> 赞同：0
> 
> 时间：2013-04-15T15:42:31.113
> 
> 标签：objective-c, xcode, nib, naming, uncaught-exception

我最近重命名了我所有的 xcode 文件名和项目名称，它曾经被称为 HelloThere，我已将其更改为 BoatTracker，并相应地重命名了 .h、.m 和 xib 文件。我在 xcode 中使用了 refractor-rename 功能来做到这一点。我现在收到我认为与名称相关的错误。我已经尝试过注释发布声明并重置模拟器和我的 Iphone。我收到的错误是。

模拟器：所有输出

```
2013-04-15 16:34:29.672 BoatTracker[22010:c07] *** Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: 'Could not load NIB in bundle: 'NSBundle </Users/Mitch/Library/Application Support/iPhone Simulator/6.1/Applications/02CD3764-5212-42F8-A456-408E487C628D/BoatTracker.app> (loaded)' with name 'HelloThereViewController'' 
```

*** 首先抛出调用堆栈：

```
(0x18a9012 0x1269e7e 0x18a8deb 0x70bef9 0x5d07e7 0x5d0dc8 0x5d0ff8 0x5d1232 0x1ddf 0x4ed1af 0x4ed7a1 0x4ee94b 0x4ffcb5 0x500beb 0x4f2698 0x1ce9df9 0x1ce9ad0 0x181ebf5 0x181e962 0x184fbb6 0x184ef44 0x184ee1b 0x4ee17a 0x4efffc 0x1d5d 0x1c95)
libc++abi.dylib: terminate called throwing an exception
(lldb) 
```

见模拟器图片： ![在此处输入图像描述](https://i.stack.imgur.com/66fsl.png)

IPhone：

```
2013-04-15 16:37:02.925 BoatTracker[153:907] *** Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: 'Could not load NIB in bundle: 'NSBundle </var/mobile/Applications/C2023052-697F-40BD-A3FA-A0D5772C6DC0/BoatTracker.app> (loaded)' with name 'HelloThereViewController'' 
```

*** 首先抛出调用堆栈：

```
(0x345c32a3 0x3c26897f 0x345c31c5 0x36568571 0x36567b9b 0x3646003d 0x363ea46d 0x31459 0x3642bb1d 0x3642b6a3 0x3642384b 0x363cbc39 0x363cb6cd 0x363cb11b 0x380ce5a3 0x34598683 0x34597ee9 0x34596cb7 0x34509ebd 0x34509d49 0x36422485 0x3641f301 0x313ad 0x3c69fb20)
libc++abi.dylib: terminate called throwing an exception
(lldb) 
```

看iphone图片： ![在此处输入图像描述](https://i.stack.imgur.com/m9veL.png)

如果您需要任何代码示例来帮助找到问题，请询问。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T15:56:42.687

看起来您的 XIB（或情节提要）仍然有对`HelloThereViewController`​​ . 在 Xcode 中更新它可能最安全，但您也可以通过在文本编辑器中打开 XIB 文件来进行搜索和替换。

# sql - INNER JOIN 和 DISTINCT 的 SQL 到实体语法

> ID：16019326
> 
> 赞同：2
> 
> 时间：2013-04-15T15:42:39.663
> 
> 标签：sql, asp.net-mvc, frameworks, entity

我对 Entity Framework 有点陌生，需要一些关于语法的建议。我的目标是从一个表中检索一个不同的过滤设备列表，并将它们与另一个表中的 ID 匹配。

这是完成 JOIN 的 RAW SQL。

```
SELECT DISTINCT DowntimeReasons.Equipment, Equipment.ID
FROM DowntimeReasons INNER JOIN 设备
ON DowntimeReasons.Equipment = Equipment.Equipment
WHERE DowntimeReasons.Emergency = 1
```

我已经能够使用以下代码将 SQL 中的不同设备列表重新创建为实体。

```
 var distinctEquipmentList = db.DowntimeReasons
                .Where(x => x.Emergency == true)
                .Distinct()
                .Select(x => x.Equipment)
                .ToList(); 
```

但是如何将此列表加入到我需要的其他表中的 ID 中？我愿意查询语法或方法语法。哎呀，当我独自学习时，我愿意接受任何帮助！谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T21:10:20.340

在不查看您的实体的外观的情况下，这是一个镜头。

你可以尝试这样的事情：

```
var query = (from dr in db.DowntimeReasons
            join e in db.Equipments on dr.Equipment equals e.Equipment
            where e.Emergency
            select e.Equipment).Distinct().ToList(); 
```

如果这不起作用，请发布您的实体。

希望这可以帮助。

# mysql - Rails 异常 Mysql::Error: query: not connected: SHOW FULL FIELDS FROM `publications`

> ID：16019332
> 
> 赞同：2
> 
> 时间：2013-04-15T15:42:59.610
> 
> 标签：mysql, ruby-on-rails, ruby

我有带有`Publications`关于出版物数据的表的 mysql 数据库。并使用`mysql`gem 来访问这些数据。我的 Ruby 版本 1.9.3。操作系统：Windows 7

我也有一个获取这些数据的模型

```
 class Publication < ActiveRecord::Base
  end 
```

应用程序启动正常，但是当我想做最简单的查询时，`Publication.find(id)`我得到了异常`Mysql::Error: query: not connected: SHOW FULL FIELDS FROM`发布

如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T21:29:08.943

我自己找到了答案。在`database.yml`文件中需要进行以下更改：

更改`adapter:mysql`为`adapter:mysql2`

# mysql - 通过组合两个现有的（插入两个外键）创建新表

> ID：16019336
> 
> 赞同：0
> 
> 时间：2013-04-15T15:43:10.150
> 
> 标签：mysql, insert, foreign-keys, sql-update

我创建了一个包含两个外键的表。我想用两个相关表中的默认值填充表。它们看起来像这样：

```
+---------------+
| Table A       |
+---------------+
| id            |
| other info... |
+---------------+

+---------------+
| Table B       |
+---------------+
| id            |
| level         |
| other info... |
+---------------+ 
```

我希望填充新表，以便每个 A 与每个 B 都有关系。如何使用 MySQL UPDATE 语句来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T15:47:59.243

```
insert into AB select a.id, b.id from A join B; 
```

# debugging - Visual Studio - 如何将调试器附加到重新启动的应用程序？

> ID：16019339
> 
> 赞同：5
> 
> 时间：2013-04-15T15:43:25.150
> 
> 标签：debugging, winapi, visual-c++, visual-studio-debugging

我有一个在 VS2010 中开发的 C++ 应用程序。此应用程序能够在需要时自行重新启动（某些更改需要重新启动）。现在有一些错误仅在重新启动后新实例开始时的某些情况下发生。问题是我不知道它是什么，因为新实例没有附加调试器（VS 调试模式以初始实例关闭结束）。知道如何自动将调试器附加到新实例吗？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-16T06:37:01.627

在感染了一些恶意软件后，我“发现”了这是如何完成的，这些恶意软件使用相同的技术来包装对反病毒产品的所有调用，以将它们重定向到它自己的可执行文件！

总结[这里描述的步骤](http://msdn.microsoft.com/en-us/library/a329t4ed%28v=vs.100%29.aspx)，它只涉及一些注册表编辑。FWIW，类似的工具`DebugDiag`也用于使用此方法来捕获应用程序启动并激活调试器：

设置应用程序以自动启动调试器

1.  启动注册表编辑器 (regedit)。

2.  在注册表编辑器中，打开该`HKEY_LOCAL_MACHINE`文件夹。

3.  导航到`HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\image file execution options`。

4.  在**Image File Execution Options**文件夹中，找到要调试的应用程序的名称，例如*myapp.exe*。如果找不到要调试的应用程序：

    一个。右键单击**Image File Execution Options**文件夹，然后在快捷菜单上单击**New Key**。
    湾。右键单击新键，然后在快捷菜单上单击**重命名**。
    C。将键名编辑为您的应用程序的名称；*myapp.exe*，在这个例子中。

5.  右键单击*myapp.exe*文件夹，然后在快捷菜单上单击**New String Value**。

6.  右键单击新字符串值，然后在快捷菜单上单击**重命名**。

7.  将名称更改为`debugger`.

8.  右键单击新字符串值，然后在快捷菜单上单击**修改**。

    出现“**编辑字符串**”对话框。

9.  在**数值数据**框中，键入**vsjitdebugger.exe**。

10.  单击**确定**。

11.  从**注册表**菜单中，单击**退出**。

12.  包含**vsjitdebugger.exe**的目录必须在您的系统路径中。有关完整说明，请参阅上面的链接。

现在，使用*任何*方法来启动您的应用程序。Visual Studio 将启动并在调试器中加载应用程序。

# sql - 存储过程在手动运行时工作，而不是从 sql server 代理运行

> ID：16019340
> 
> 赞同：2
> 
> 时间：2013-04-15T15:43:27.417
> 
> 标签：sql, sql-server, sql-server-2008, tsql

我有一个使用 SSMS 中的执行命令运行良好的存储过程，但是将相同的命令放在作业中会产生以下错误。

> 第 9 行，字符 9，输入意外结束

该代码采用 UTF-8 编码的很长的 XML 字符串并将其放入单个`nvarchar(max)`单元格中。然后将此字符串放入不同表中的 XML 单元格中，允许我使用节点函数查询 XML 代码的各个部分。`nvarchar`由于编码差异，我无法将数据直接放入单元格中。

**我无法在这里复制字符串，因为它非常长。**

我只是在寻找关于哪里可能出错的想法。

到目前为止，这是我所知道的：

1.  *该过程在手动*执行时运行没有问题

**   我检查了权限问题，这似乎不是问题。代理在我自己的帐户下运行，我是数据库的系统管理员

    *   我将程序拆分为单独的部分，以准确定位问题发生的位置。手动执行时，单独的过程再次运行良好，但通过 SQL Server 代理运行时出现错误。

    *   当查询通过 SQL Server 代理单独运行时，它会给出稍微不同的错误。这让我相信这是一个编码问题。但是，我从网页获取 XML，但无法更改网页上的编码。* 

 *> 第 1 行，字符 38，无法切换编码

我知道这是一个很长的尝试，因为您无法复制该问题，但是如果有人可以就从哪里开始寻找答案给出一个想法，我们将不胜感激。

编辑1：非常感谢您的帮助。我不得不从这个问题上抽出一点时间来理清头绪。这周回来。

好的，我想我终于找到了问题的根源。这是我用来从网站获取数据的代码。它正在截断从网站上提取的数据。在 SSMS 中执行时它运行完美。它在通过批处理文件运行时将数据截断为 2048 个字符，并在使用 SS 作业运行时将数据截断为 512 个字符。

这些值不能是随机的。一定有某个地方，但我找不到它。有任何想法吗？

这是代码：

```
DECLARE 

@url nvarchar(max),
@win integer,
@hr integer ,
@Date date,
@SearchDate nvarchar(50)

Delete from XMLParsing.dbo.TextData

Set @Date = GETDATE()

set @SearchDate = CAST(@Date as nvarchar(50))

set @SearchDate = REPLACE(@SearchDate,'-','')

Select @url = 'http://semorep.sem-o.com/DataCollection/DataSets.asmx/queryDatasetXML?DatasetName=SET_CAL&User=primplims@gmail.com&Password=testsemo&FromDate=20130103&ToDate=20130111&P1=Energy&P2=Statements&P3=Initial&P4=&P5='

EXEC @hr=sp_OACreate 'WinHttp.WinHttpRequest.5.1',@win OUT 
IF @hr <> 0 EXEC sp_OAGetErrorInfo @win 

EXEC @hr=sp_OAMethod @win, 'Open',NULL,'GET',@url,'false'
IF @hr <> 0 EXEC sp_OAGetErrorInfo @win 

EXEC @hr=sp_OAMethod @win,'Send'
IF @hr <> 0 EXEC sp_OAGetErrorInfo @win 

INSERT XMLParsing.dbo.TextData(SEMO_Data)
EXEC @hr=sp_OAGetProperty @win,'ResponseText'
IF @hr <> 0 EXEC sp_OAGetErrorInfo @win

EXEC @hr=sp_OADestroy @win 
IF @hr <> 0 EXEC sp_OAGetErrorInfo @win 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-01-06T13:25:43.180

指定

```
SET TEXTSIZE 200000 
```

在 SQL 代理作业步骤中。SQL 代理的默认`TEXTSIZE`值为`512`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-09T14:38:21.287

只是一个更新。这不能正常工作的原因是从站点获取的 XML 被截断了。我从来没有完全弄清楚为什么会发生这种情况，但我使用***wget for windows***而不是 WinHttp.WinHttpRequest.5.1，它从站点获取所有数据并将其直接传递到我可以从中解析数据的网页。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-11T11:24:10.330

就放 `SET TEXTSIZE (with a great value)`

其余的由 SQL 代理完成。*

# asp.net-mvc - System.InvalidOperationException：找不到 EntityType Foo.Bar 的映射和元数 据信息

> ID：16019341
> 
> 赞同：1
> 
> 时间：2013-04-15T15:43:30.127
> 
> 标签：asp.net-mvc, entity-framework, asp.net-mvc-4, entity-framework-4, entity-framework-5

我无计可施，试图解决这个问题。

我有一个使用 4 个实体框架模型的非常大的 MVC 项目。这些模型被编译成一个单独的程序集/类库类型项目。

直到几天前，一切正常。我请了两天假，有人调整了模型，他被称为重病。

当我今天回来时，我注意到该应用程序无法启动。它向您显示黄屏死机，并显示以下异常消息：

```
System.InvalidOperationException: Mapping and metadata information could 
not be found for EntityType 'MyNamespace.MyClassName' 
```

我查看了几篇文章（[http://blogs.infosupport.com/mapping-and-metadata-information-could-not-be-found-for-entitytype-schema-klant/，http://matheusandcode.wordpress](http://blogs.infosupport.com/mapping-and-metadata-information-could-not-be-found-for-entitytype-schema-klant/) [。 com/2011/11/13/mapping-and-metadata-information-could-not-be-found-for-entitytype/](http://matheusandcode.wordpress.com/2011/11/13/mapping-and-metadata-information-could-not-be-found-for-entitytype/)）以及来自这里的问题和答案，他们都建议我交叉检查拼写错误或缺少属性POCO 和模型生成的实体。

我有大约 400 多个实体。但是，我在创建实体集时检查了它引发异常的实体，并且绝对没有拼写不匹配。我已经花了 5 个多小时来检查这个，我很累也很沮丧。

关于此错误的可能原因，任何人都有其他线索吗？

我已经使用 Table Mappings 窗口、模型浏览器甚至 SQL Server Management Studio 清理、重建、检查拼写错误、缺少属性、交叉检查概念模型和存储模型之间的奇偶校验，我已经打印出来并标记了纸上的每个属性都与 POCO 中的属性相对，我已经冲洗并重复了几次，但错误不会消失。

我正在使用 Visual Studio 2010、EF 5、MVC 4 和实体框架 POCO 生成器包。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T10:02:01.617

For the benefit of the weary wayfarer.

In our case, we spotted the error to the following cause:

A developer had added an extra EDMX that did not use the EF POCO generator. In fact, the new model had no tables either. It just used a stored procedure.

He removed it and the error went away. We'll probably call the stored proc using vanilla ADO.NET instead of adding a new Entity Framework model for it.

# xcode - performSelector:@selector 错误

> ID：16019343
> 
> 赞同：0
> 
> 时间：2013-04-15T15:43:39.760
> 
> 标签：xcode, delegates, controller, selector

我试图让这个 xcode 项目工作，但是当它达到这个方法时：

```
- (void)xmlReaderDidFinishedParsingDocument{
    [[[UIApplication sharedApplication] delegate] performSelector:@selector(setControllersBanner)];
} 
```

显示以下错误：

```
*** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[RadioStationAppDelegate setControllersBanner]: unrecognized selector sent to instance 0x5e66940' 
```

有人可以告诉我为什么会抛出此错误消息，在此先感谢！

# c# - 如何在 wpf 中暂停和重新启动 AxShockwaveFlash 控件

> ID：16019344
> 
> 赞同：0
> 
> 时间：2013-04-15T15:43:41.003
> 
> 标签：c#, wpf, flash, axshockwaveflash

我在 Windows 窗体用户控件中有一个 AxShockwaveFlash 控件。这是在 WindowsFormsHost 内的我的 wpf 用户控件上。

```
<WindowsFormsHost>
    <fC:FlashControl x:Name="flashControl"/>
</WindowsFormsHost> 
```

要开始我打电话的电影：

```
axShockwaveFlash.Movie = "C:\flashMovie.flv" 
```

但是在 FlashControl 内部的 AxShockwaveFlash 控件上调用方法，例如：

`axShockwaveFlash.Play(); axShockwaveFlash.Stop(); axShockwaveFlash.StopPlay(); axShockwaveFlash.FrameNum = 0;`

不要做任何事。

# jquery - 从 gridview 创建 XML

> ID：16019346
> 
> 赞同：0
> 
> 时间：2013-04-15T15:43:43.120
> 
> 标签：jquery, xml, gridview

我想问是否有一种方法可以通过使用 jQuery 循环遍历 gridview 来创建 XML 类型结构。

我有以下网格视图：

```
Year   Price   Model User
2013   1000    Car   Joe
2013   2000    Car   Josh
2014   1000    Car   Chris
2014   2000    Car   Tresa 
```

我希望“XML”类型结构如下所示：

```
 <Car>
 <2013>1000</2013>
 <User>Joe</User>
 <2013>2000</2013>
 <User>Josh</User>
 <2014>1000</2014>
 <User>Chris</User>
 <2014>2000</2014>
 <User>Tresa</User>
 </Car> 
```

# wix - 在升级版本中重用属性值

> ID：16019350
> 
> 赞同：1
> 
> 时间：2013-04-15T15:43:55.103
> 
> 标签：wix, wix3.6

Wix：有没有办法在使用 Wix 的升级版本中重用以前安装的版本属性值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T15:58:33.847

是的，您需要将它们保存在注册表中。这称为[记住属性模式](http://robmensching.com/blog/posts/2010/5/2/the-wix-toolsets-remember-property-pattern)

# c++ - 使用堆栈的数独无限循环

> ID：16019351
> 
> 赞同：1
> 
> 时间：2013-04-15T15:44:00.257
> 
> 标签：c++, sudoku

我是新手，五年多没有编写 C++ 代码了。我有一个关于数独求解器的课程。它（在大多数情况下）有效，除非它回溯（当它无法找到放入框中的单个可能值时）它要么一直回溯到开头，要么无法退出循环。帮助？代码如下

```
Address::Address(int row, int col) //This class is for the addresses of each block of of the 9x9 grid
{
    this->row=row;
    this->col=col;
}//finds the locations of each block

Puzzle::Puzzle(const char grid[][9])
{
}

void Puzzle::solve(char grid[][9])
{
stack <Address> locations; //creates stack of locations
for(int row=0; row<9;row++)
{
    for (int col=0; col<9; col++)
    {
        if (grid[row][col]=='*') //checks for an empty block
        {
            Possibles possibles(grid,Address(row,col)); //creates an array of possible values for that specific block
            int possvalue = possibles.GetNextPossible(0); //gets the next possible value from the array of possible values
            while(possvalue == -1) //checks if there's no possible values for the block 
            {
                if(locations.empty())
                {
                    cout << "Puzzle Unsolvable" << endl;
                    return;
                }
                cout<<"PossValue before: "<< possvalue <<endl;
                Address previouslocation = locations.top(); //stores the previous location from the stack
                Possibles previouspossible(grid,previouslocation); //creates a new array of new possibles
                previouspossible.array[grid[previouslocation.row][previouslocation.col]-'0'] = false;
                grid[previouslocation.row][previouslocation.col] = '*'; //changes the previous location back to empty
                possvalue = previouspossible.GetNextPossible(grid[previouslocation.row][previouslocation.col]-'0'); //gets the new possible value from new possibles
                locations.pop();

                cout<<"PossValue after: "<< possvalue<<endl;
                cout<<"row: "<< row<<endl;
                cout<<"col: "<< col<<endl;
                cout<<"previouslocation.row: "<< previouslocation.row<<endl;
                cout<<"previouslocation.col: "<< previouslocation.col<<endl;
                cout<<"previousvalue" << grid[previouslocation.row][previouslocation.col] << endl;
                cout<<"grid[previouslocation.row][previouslocation.col]: "<< grid[previouslocation.row][previouslocation.col]<<endl;
                cout << locations.size() << endl;
                cout<<endl;

                row = previouslocation.row; //changes the row where we're trying to solve
                col = previouslocation.col; //changes the column where we're trying to solve
            }

            grid[row][col] = (char) ( ((int)'0') + possvalue); //puts the "good" value on the grid
            locations.push (Address(row,col)); // pushes the location of the box into the stack
            /*for(int i = 0; i< 9; i++)
            {
                for(int j = 0; j< 9; j++)
                    cout << grid[i][j];

                    cout << endl;
            }*/ // for row
            cout << endl;
        }
    }
}

}//solves sudoku

Possibles::Possibles(char grid[][9], Address currentAddress) //makes an array for each block for the number of possibles
{
for (int i=0; i<10; i++)
{
        array[i] = true; //setting a boolean array of size 9 to true
}

for (int row=0; row<9;row++)
{
array[grid[row][currentAddress.col]-'0'] = false; //checks for repeated values on the row 
}
for(int col=0; col<9; col++)
{
    array[grid[currentAddress.row][col]-'0'] = false; //checks for repeated values on the column
}
for(int row=currentAddress.row-(currentAddress.row%3); row < (currentAddress.row-(currentAddress.row%3))+3 ; row++) 
{
    for(int col=currentAddress.col-(currentAddress.col%3); col < (currentAddress.col-(currentAddress.col%3))+3 ; col++)
    {
        array[grid[row][col]-'0'] = false; //checks for repeated values in the box
    }
}

}//this function returns an array of "possibles" which is a boolean array for every value from 1-9\. This determines whether the value is a possibility for that block.

int Possibles::GetNextPossible(int nextpossible) //determines the next "possible" array
{
for(int i=nextpossible+1; i<10; i++)
{
    if (array[i] == true)
        {
            return i; //if the boolean array returns true, then return the value of that boolean array.
        }
}
return -1; // if there is no "true" in the boolean array, then returns "NULL"
} 
```

感谢您的帮助，伙计们！任何输入表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T16:10:41.983

我真的不知道你的代码，但如果你要回溯（你必须解决数独），你真的应该使用递归。没有它，你必须模拟它；最重要的是，您将无法使用`for`循环，因为有时您必须递减。

`char [81]`另一点：如果您将数独板表示为简单的线性数组或类似的东西，我认为您会发现它更简单（特别是如果您不使用递归） 。如果这样做，您将拥有一个当前位置索引，您可以对其进行递减和递增，而无需担心行和列。

所以，递归：

```
void
Puzzle::solve( int currentPosition = 0 )
{
    if ( currentPosition >= 81 ) {
        solved = true;
    } else if ( board[ currentPosition ] != empty ) {
        solve( currentPosition + 1 );
    } else {
        for ( int newValue = 1; ! solved && newValue <= 9; ++ newValue ) {
            if ( isLegal( currentPosition, newValue ) ) {
                set( currentPosition, newValue );
                solve( currentPosition + 1 );
                if ( ! solved ) {
                    unset( currentPosition );
                }
            }
        }
    }
} 
```

这假设板本身是 Puzzle 的成员，并且 Puzzle 还包含一个标志，告诉您何时找到解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T01:20:33.680

谢谢大家的帮助！我已经弄清楚我的问题是什么。我的台词只是重新排列错了。

```
 Address previouslocation = locations.top(); //stores the previous location from the stack
 Possibles previouspossible(grid,previouslocation); //creates a new array of new possibles
 previouspossible.array[grid[previouslocation.row][previouslocation.col]-'0'] = false;
 grid[previouslocation.row][previouslocation.col] = '*'; //changes the previous location back to empty
 possvalue = previouspossible.GetNextPossible(grid[previouslocation.row[previouslocation.col]-'0'); //gets the new possible value from new possibles 
```

应该是：

```
Address previouslocation = locations.top(); //stores the previous location from the stack
Possibles previouspossible(grid,previouslocation); //creates a new array of new possibles
possvalue = previouspossible.GetNextPossible(grid[previouslocation.row][previouslocation.col]-'0'); //gets the new possible value from new possibles. the '0' is to convert char to int
grid[previouslocation.row][previouslocation.col] = '*'; //changes the previous location back to empty 
```

哈哈。再次感谢所有帮助的家伙。

# php - 再次将存储在mysql中的字符串转换为php：eval()

> ID：16019353
> 
> 赞同：0
> 
> 时间：2013-04-15T15:44:12.623
> 
> 标签：php, mysql, json, eval

我有个问题。在我的 MySQL 数据库中，我有一列存储 PHP 对象的输出（作为字符串）：

```
Array
(
    [item_id] => 849
    [title] =>
         Array
         (
             [0] => hello
             [1] => bye bye
         )
    ...... 
```

如果我对此运行 eval ，它当然不会工作。有没有一种功能或已知的技术可以将它恢复到一个 php 对象中，或者我必须将它作为 json 存储在 mysql 中（这将是一个巨大的痛苦）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T15:51:40.117

这是您需要使用序列化/反序列化或 json 字符串的方法：

[http://php.net/manual/en/language.oop5.serialization.php](http://php.net/manual/en/language.oop5.serialization.php)

# spring - 在 Maven 项目中包含 jar

> ID：16019363
> 
> 赞同：0
> 
> 时间：2013-04-15T15:44:37.927
> 
> 标签：spring, maven, pom.xml

我正在开发一个 maven 项目，该项目包含一个父 pom，其中包含所有子项目的公共依赖项。我遇到的问题是包含 hibernate-jpa-2.0-api jar 。当我对编译项目进行战争并将其部署到 tomcat 时，我检查了 lib 除了这个之外的所有其他依赖项，因此我得到错误。

这是父pom的依赖项：

```
<dependency>
            <groupId>commons-collections</groupId>
            <artifactId>commons-collections</artifactId>
            <version>${commons-collections.version}</version>
        </dependency>
        <dependency>
            <groupId>commons-lang</groupId>
            <artifactId>commons-lang</artifactId>
            <version>${commons-lang.version}</version>
        </dependency>
        <!-- Spring -->
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-context</artifactId>
            <version>${org.springframework-version}</version>
            <exclusions>
                <!-- Exclude Commons Logging in favor of SLF4j -->
                <exclusion>
                    <groupId>commons-logging</groupId>
                    <artifactId>commons-logging</artifactId>
                </exclusion>
            </exclusions>
        </dependency>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-web</artifactId>
            <version>${org.springframework-version}</version>
        </dependency>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-webmvc</artifactId>
            <version>${org.springframework-version}</version>
        </dependency>
        <!--<dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-web</artifactId>
            <version>${org.springframework-version}</version>
        </dependency>-->
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-jdbc</artifactId>
            <version>${org.springframework-version}</version>
        </dependency>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-tx</artifactId>
            <version>${org.springframework-version}</version>
        </dependency>
        <dependency>
            <groupId>org.springframework.security</groupId>
            <artifactId>spring-security-web</artifactId>
            <version>${org.springframework.security-version}</version>
        </dependency>
        <dependency>
            <groupId>org.springframework.security</groupId>
            <artifactId>spring-security-taglibs</artifactId>
            <version>${org.springframework.security-version}</version>
        </dependency>
        <dependency>
            <groupId>org.springframework.security</groupId>
            <artifactId>spring-security-config</artifactId>
            <version>${org.springframework.security-version}</version>
        </dependency>
        <dependency>
            <groupId>org.springframework.social</groupId>
            <artifactId>spring-social-core</artifactId>
            <version>${org.springframework.social-version}</version>
        </dependency>
        <dependency>
            <groupId>org.springframework.social</groupId>
            <artifactId>spring-social-facebook</artifactId>
            <version>${org.springframework.social.facebook-version}</version>
        </dependency>
        <dependency>
            <groupId>org.springframework.social</groupId>
            <artifactId>spring-social-facebook-web</artifactId>
            <version>${org.springframework.social.facebook-version}</version>
        </dependency>
        <dependency>
            <groupId>org.springframework.social</groupId>
            <artifactId>spring-social-twitter</artifactId>
            <version>${org.springframework.social.twitter-version}</version>
        </dependency>
        <dependency>
            <groupId>org.springframework.social</groupId>
            <artifactId>spring-social-linkedin</artifactId>
            <version>${org.springframework.social.linkedin-version}</version>
        </dependency>
        <dependency>
            <groupId>org.springframework.social</groupId>
            <artifactId>spring-social-web</artifactId>
            <version>${org.springframework.social-version}</version>
        </dependency>
        <dependency>
            <groupId>org.springframework.mobile</groupId>
            <artifactId>spring-mobile-device</artifactId>
            <version>${org.springframework.mobile-version}</version>
        </dependency>
        <dependency>
            <groupId>org.apache.httpcomponents</groupId>
            <artifactId>httpclient</artifactId>
            <version>4.2.3</version>
            <exclusions>

                <exclusion>
                    <groupId>commons-logging</groupId>
                    <artifactId>commons-logging</artifactId>
                </exclusion>
            </exclusions>           
        </dependency>
        <!-- <dependency> <groupId>org.antlr</groupId> <artifactId>stringtemplate</artifactId> 
            <version>${org.antlr.stringtemplate-version}</version> </dependency> -->

        <!-- JSR 303 with Hibernate Validator -->
        <dependency>
            <groupId>javax.validation</groupId>
            <artifactId>validation-api</artifactId>
            <version>${javax-validation}</version>
        </dependency>
        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-validator</artifactId>
            <version>${hibernate-validator.version}</version>
        </dependency>
        <!-- Data Access ORM JPA and Hibernate -->
        <dependency>
            <groupId>org.hibernate.javax.persistence</groupId>
            <artifactId>hibernate-jpa-2.0-api</artifactId>
            <version>${hibernate-jpa-2-0-api.version}</version>
            <scope>provided</scope>

        </dependency>
        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-core</artifactId>
            <version>${hibernate-core.version}</version>
            <!--<scope>provided</scope>-->
        </dependency>

        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-entitymanager</artifactId>
            <version>${hibernate-entitymanager.version}</version>
            <!--<scope>provided</scope>-->
        </dependency>

        <!-- Logging -->
        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>slf4j-api</artifactId>
            <version>${org.slf4j-version}</version>
        </dependency>
        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>jcl-over-slf4j</artifactId>
            <version>${org.slf4j-version}</version>
            <scope>runtime</scope>
        </dependency>
        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>slf4j-log4j12</artifactId>
            <version>${org.slf4j-version}</version>
            <scope>runtime</scope>
        </dependency>
        <dependency>
            <groupId>log4j</groupId>
            <artifactId>log4j</artifactId>
            <version>${log4j-version}</version>
            <scope>runtime</scope>
        </dependency>

        <dependency>
            <groupId>com.h2database</groupId>
            <artifactId>h2</artifactId>
            <version>1.3.159</version>
        </dependency>

        <!-- CGLIB, only required and used for @Configuration usage -->
        <dependency>
            <groupId>cglib</groupId>
            <artifactId>cglib-nodep</artifactId>
            <version>${cglib-version}</version>
        </dependency>

        <dependency>
            <groupId>commons-digester</groupId>
            <artifactId>commons-digester</artifactId>
            <version>${commons-digester}</version>
        </dependency>
        <dependency>
            <groupId>commons-beanutils</groupId>
            <artifactId>commons-beanutils</artifactId>
            <version>${commons-beanutils}</version>
        </dependency>

        <!-- @Inject -->
        <dependency>
            <groupId>javax.inject</groupId>
            <artifactId>javax.inject</artifactId>
            <version>1</version>
        </dependency> 
```

我也尝试将这个休眠依赖项放在子 pom 中，但仍然是同样的问题。这是孩子的pom：

```
<dependency>
            <groupId>com.gzl</groupId>
            <artifactId>gzl-entity</artifactId>
            <version>${project.parent.version}</version>
        </dependency>
        <dependency>
            <groupId>junit</groupId>
            <artifactId>junit</artifactId>
            <version>4.7</version>
            <scope>test</scope>
        </dependency>
        <!-- mysql connector -->
        <dependency>
            <groupId>mysql</groupId>
            <artifactId>mysql-connector-java</artifactId>
            <version>${mysql-connector-java.version}</version>
            <!-- <scope>${jars.scope}</scope> -->
        </dependency>
        <!-- hibernate -->
        <!--<dependency>
            <groupId>org.hibernate.javax.persistence</groupId>
            <artifactId>hibernate-jpa-2.0-api</artifactId>
            <version>${hibernate-jpa.version}</version>

        </dependency>
        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-validator</artifactId>
            <version>${hibernate-validator.version}</version>
        </dependency>
        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-entitymanager</artifactId>
            <version>${hibernate-core.version}</version>
        </dependency>
        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-core</artifactId>
            <version>${hibernate-core.version}</version>
        </dependency>
        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-c3p0</artifactId>
            <version>${hibernate-core.version}</version>
        </dependency>-->
        <!-- spring -->
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-core</artifactId>
            <version>${org.springframework-version}</version>
        </dependency>

        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-aop</artifactId>
            <version>${org.springframework-version}</version>
        </dependency>

        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-aspects</artifactId>
            <version>${org.springframework-version}</version>
        </dependency>

        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-beans</artifactId>
            <version>${org.springframework-version}</version>
        </dependency>

        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-expression</artifactId>
            <version>${org.springframework-version}</version>
        </dependency>

        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-context</artifactId>
            <version>${org.springframework-version}</version>
        </dependency>

        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-context-support</artifactId>
            <version>${org.springframework-version}</version>
        </dependency>

        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-jdbc</artifactId>
            <version>${org.springframework-version}</version>
        </dependency>

        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-orm</artifactId>
            <version>${org.springframework-version}</version>
        </dependency>

        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-tx</artifactId>
            <version>${org.springframework-version}</version>
        </dependency>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-webmvc</artifactId>
            <version>${org.springframework-version}</version>
        </dependency>
        <dependency>
            <groupId>org.springframework.data</groupId>
            <artifactId>spring-data-jpa</artifactId>
            <version>${spring-data-jpa.version}</version>
        </dependency>

        <dependency>
            <groupId>javax.inject</groupId>
            <artifactId>javax.inject</artifactId>
            <version>${javax.inject.version}</version>
        </dependency>
        <!-- commons -->

        <dependency>
            <groupId>commons-collections</groupId>
            <artifactId>commons-collections</artifactId>
            <version>${commons-collections.version}</version>
        </dependency>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-test</artifactId>
            <version>${org.springframework-version}</version>
            <scope>test</scope>
        </dependency>
        <!-- testng -->
        <dependency>
            <groupId>org.testng</groupId>
            <artifactId>testng</artifactId>
            <version>${testng.version}</version>
            <scope>test</scope>
        </dependency>
        <!-- S3 -->
        <dependency>
            <groupId>net.java.dev.jets3t</groupId>
            <artifactId>jets3t</artifactId>
            <!-- The next release of jets3t should have support for HttpComponents 
                4.1 and HttpClient 3.1 will be removed from the classpath -->
            <version>${jets3t.version}</version>
            <exclusions>
                <!-- Exclude Commons Logging in favor of SLF4j -->
                <exclusion>
                    <groupId>commons-logging</groupId>
                    <artifactId>commons-logging</artifactId>
                </exclusion>
            </exclusions>
        </dependency>
        <dependency>
            <groupId>org.springframework.data</groupId>
            <artifactId>spring-data-redis</artifactId>
            <version>${spring-data-redis.version}</version>
        </dependency> 
```

任何人都可以帮助导致这个问题的原因吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T15:46:52.293

在子 pom.xml 中，依赖项被注释掉了。

在父 pom hibernate-jpa-2.0-api jar 中提供了依赖项，这意味着它不会包含在由此产生的战争中。尝试将它包含在具有编译依赖项的子模块中。

# ruby-on-rails - 用于查找关联大学电子邮件地址的宝石

> ID：16019367
> 
> 赞同：2
> 
> 时间：2013-04-15T15:44:52.103
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, email, gem

我认为这不存在，但我认为在恢复使用这些数据查找一些 CSV 表之前我应该​​问一下。我收到来自用户的大学电子邮件，我想查找与电子邮件后缀相关联的大学名称。例如，`jason@uga.edu`应该关联到`University of Georgia`. 是否有一些 Rails gem 可以帮助我解决我的困境，还是我必须用这些数据创建一些数据库或散列？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-15T16:03:15.437

您可能可以通过以下方式破解一些东西：[https](https://github.com/weppos/whois) ://github.com/weppos/whois 。

```
require 'whois'

r = Whois.whois("uga.edu")
r.registrant_contact.organization # => "University of Georgia" 
```

如果您有大量流量，请考虑使用缓存机制来存储 WHOIS 信息，这样您就不必为每个请求询问 WHOIS 服务器。

# ios - NSOperationQueue 未运行所有操作

> ID：16019369
> 
> 赞同：1
> 
> 时间：2013-04-15T15:44:59.093
> 
> 标签：ios, nsoperation, nsoperationqueue

我正在使用 NSOperationQueue 执行并发下载并插入核心数据。

以下是代码，我正在使用

```
if(nil==queue)
{
    queue=[[NSOperationQueue alloc]init];
   [queue setMaxConcurrentOperationCount:5];
}
for (FileDetailsEntity *entity in array)
{
    InoFileDownloader *fileDownloader=[[InoFileDownloader alloc]initWithFileDetailsEntity:entity andDelegate:self];
    [queue addOperation:fileDownloader];
}

//InoFiledownloader.m file

- (void)mergeChanges:(NSNotification *)notification
 {
    appDelegate=(InoAppDelegate*)[[UIApplication sharedApplication]delegate];
    NSManagedObjectContext *mainContext = [appDelegate managedObjectContext];

// Merge changes into the main context on the main thread
[mainContext performSelectorOnMainThread:@selector(mergeChangesFromContextDidSaveNotification:)
                              withObject:notification
                           waitUntilDone:YES];
}

-(void)start
 {
    @autoreleasepool {

    [self willChangeValueForKey:@"isExecuting"];
    self.isExecuting = YES;
    [self didChangeValueForKey:@"isExecuting"];

    appDelegate=(InoAppDelegate*)[[UIApplication sharedApplication]delegate];

    NSManagedObjectContext *ctx = [[NSManagedObjectContext alloc] init];
    [ctx setUndoManager:nil];
    [ctx setPersistentStoreCoordinator: [appDelegate persistentStoreCoordinator]];

    // Register context with the notification center
    NSNotificationCenter *nc = [NSNotificationCenter defaultCenter];
    [nc addObserver:self
           selector:@selector(mergeChanges:)
               name:NSManagedObjectContextDidSaveNotification
             object:ctx];

    NSDictionary *taskID=[[NSDictionary alloc]initWithObjectsAndKeys:fileDetaislsEntity.fileId,@"fileId",nil];

    NSArray *arry=[[NSArray alloc]initWithObjects:taskID, nil];

    NSMutableDictionary *jsonRequest=[NSMutableDictionary new];

    [jsonRequest setValue:arry forKey:@"fileId"];

    jsonWriter = [[SBJsonWriter alloc] init];

    if(self.isCancelled)
        return;

    NSString *jsonString = [jsonWriter stringWithObject:jsonRequest];

    NSData *postData = [jsonString dataUsingEncoding:NSASCIIStringEncoding allowLossyConversion:YES];
    NSString *postLength = [NSString stringWithFormat:@"%d", [postData length]];

    if(self.isCancelled)
        return;

    NSURL *url = [NSURL URLWithString:@"http://192.168.4.247:8080/InnoApps/mobjobs/post/imageDownload"];

    NSMutableURLRequest *request = [[NSMutableURLRequest alloc] init];
    [request setURL:url];
    [request setHTTPMethod:@"POST"];
    [request setValue:postLength forHTTPHeaderField:@"Content-Length"];
    [request setValue:@"application/json" forHTTPHeaderField:@"Content-Type"];

    if(self.isCancelled)
        return;

    [request setHTTPBody:postData];
    NSHTTPURLResponse* response;
    NSError* error = nil;

    //  NSLog(@"File started to download for the file id %@",entity.fileId);

    if(self.isCancelled)
        return;

    //Capturing server response
    NSLog(@"started to download for file id--%@",fileDetaislsEntity.fileId);
    NSData* result = [NSURLConnection sendSynchronousRequest:request  returningResponse:&response error:&error];
    NSLog(@"finished downloading data for file id--%@",fileDetaislsEntity.fileId);
    // if(request)
    //     NSLog(@"File downloaded for the file id %@",entity.fileId);

    if(self.isCancelled)
        return;

    SBJSON *jsonParser=[SBJSON new];

    NSString *jsonStr=[[NSString alloc]initWithData:result encoding:NSUTF8StringEncoding];

    // if(response.statusCode!=0)
    NSDictionary *resultDic;

    if([response statusCode]!=0)
    {
        resultDic= [jsonParser objectWithString:jsonStr];
    }
    else
    {
        resultDic=nil;
    }

    //  NSLog(@"resultDic---%@",resultDic);

    NSMutableDictionary *imageDetails= [[resultDic objectForKey:@"image"] objectAtIndex:0];
    NSString *imageStr=[imageDetails objectForKey:@"imageBlob"];

    NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
    NSEntityDescription *entity = [NSEntityDescription
                                   entityForName:@"FileDetailsEntity" inManagedObjectContext:ctx];

    [fetchRequest setEntity:entity];
    NSPredicate *predicate = [NSPredicate predicateWithFormat:@"taskId = %@ AND fileId=%@",fileDetaislsEntity.taskId,fileDetaislsEntity.fileId];

    [fetchRequest setPredicate:predicate];

    NSError *errorTmp=nil;
    NSArray *fileDetailsArray= [ctx executeFetchRequest:fetchRequest error:&error];

    if(errorTmp)
        NSLog(@"error in fetching filedetails array----%@",[errorTmp localizedDescription]);
    for(FileDetailsEntity *entity in fileDetailsArray)
    {
        [entity setFileData:[imageStr dataUsingEncoding:NSUTF8StringEncoding]];
    }

    if(self.isCancelled)
        return;

    NSError *errorForDataSaving;

    if(![ctx save:&errorForDataSaving])
        NSLog(@"failed to save data after downloading image ---%@",[error localizedDescription]);

    NSLog(@"data saved in db for file id--%@",fileDetaislsEntity.fileId);

    if(self.isCancelled)
        return;

    [self willChangeValueForKey:@"isFinished"];
    [self willChangeValueForKey:@"isExecuting"];
    isExecuting = NO;
    isFinished = YES;
    [self didChangeValueForKey:@"isExecuting"];
    [self didChangeValueForKey:@"isFinished"];

    [(NSObject*)self.delegate performSelectorOnMainThread:@selector(didFinishDownloadingFileWithFileId:) withObject:fileDetaislsEntity.fileId waitUntilDone:NO];

}

}

 -(BOOL)isConcurrent { return YES; }

 -(BOOL)isExecuting { return isExecuting; }

 -(BOOL)isFinished { return isFinished; }

 -(BOOL)isCancelled { return cancelled; } 
```

只有在此之后它最多运行 15 或 20 次操作，队列没有运行。谁能告诉我。出了什么问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T15:58:57.197

您应该在添加操作之前暂停队列，并在您完成添加操作池之后恢复队列...

试试这个：

```
if(nil==queue)
{
    queue=[[NSOperationQueue alloc]init];
   [queue setMaxConcurrentOperationCount:5];
}

[queue setSuspended:YES];

for (FileDetailsEntity *entity in array)
{
    InoFileDownloader *fileDownloader=[[InoFileDownloader alloc]initWithFileDetailsEntity:entity andDelegate:self];
    [queue addOperation:fileDownloader];
}

[queue setSuspended:NO]; 
```

同样在合并更改方法中将标志 waitUntillDone 更改为 FALSE，如下所示：

```
[mainContext performSelectorOnMainThread:@selector(mergeChangesFromContextDidSaveNotification:)
                          withObject:notification
                       waitUntilDone:FALSE]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T16:07:01.190

问题很可能是您正在使用`NSURLConnection sendSynchronousRequest`. 这几乎总是一个坏主意，因为它会阻塞，这意味着它可以使您的代码完全停止（这听起来就像正在发生的事情）。

人们通常使用`NSURLConnection sendSynchronousRequest`，因为他们害怕或不知道如何正确使用 NSURLConnection，即异步。但正确使用并不难，值得一试。

# ios - IMAP 和 Gmail 标签

> ID：16019382
> 
> 赞同：0
> 
> 时间：2013-04-15T15:45:25.127
> 
> 标签：ios, objective-c, cocoa, imap, gmail-imap

我试图弄清楚如何将 GMail 标签添加到我的应用程序中。我正在使用不支持它的 Mailcore，所以我想自己添加它们。我研究了一下，发现了这个：

```
a010 FETCH 1:4 (X-GM-LABELS)
* 1 FETCH (X-GM-LABELS (\Inbox \Sent Important "Muy Importante"))
* 2 FETCH (X-GM-LABELS (foo))
* 3 FETCH (X-GM-LABELS ())
* 4 FETCH (X-GM-LABELS (\Drafts))
a010 OK FETCH (Success) 
```

[https://developers.google.com/google-apps/gmail/imap_extensions#x-gm-labels](https://developers.google.com/google-apps/gmail/imap_extensions#x-gm-labels)

这是什么语言？那是一个API吗？我如何访问它？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T16:04:48.977

它是 IMAP 协议，在此处定义：[http](http://www.ietf.org/rfc/rfc1730.txt) ://www.ietf.org/rfc/rfc1730.txt 。您可以通过 telnet（通常是 tcp 端口 443）连接到 IMAP 服务器并运行该 fetch 命令。

这是一个如何使用 telnet 连接到 IMAP 服务器并手动运行命令（例如 FETCH）的示例。

[http://networking.ringofsaturn.com/Protocols/imap.php](http://networking.ringofsaturn.com/Protocols/imap.php)

# php - 二 功能一起工作还是合二为一？

> ID：16019386
> 
> 赞同：0
> 
> 时间：2013-04-15T15:45:38.887
> 
> 标签：php, javascript, html, css, soundmanager2

我有两`<ul>`节课。一个是`<ul class"list_songs">`另一个是`<ul class"playlist">`

目前的设置是这样的，而且效果不好。它会列出歌曲并播放它们，但它不会播放下一首，因为每个链接就像它自己的岛屿。知道如何将两者结合起来吗？

```
<div class="blk_main">
    <div class="tag_main">
        <h2>Music Results</h2></p>
    </div>
<div>
    <ul class="list_song">
    {section name=mp3 loop=$mp3_search}
</div>      
        <div>
        <ul class="playlist">       

                  <li> <a class="sm2_link" href="{$mp3_search[mp3].mp3_url}">{$mp3_search[mp3].song_title|strip_tags}</a></li>
                  </ul>

 </div>
 <div id="control-template">
  <!-- control markup inserted dynamically after each link -->
  <div class="controls">
   <div class="statusbar">
    <div class="loading"></div>
     <div class="position"></div>
   </div>
  </div>
  <div class="timing">
   <div id="sm2_timing" class="timing-data">
    <span class="sm2_position">%s1</span> / <span class="sm2_total">%s2</span></div>
  </div>
  <div class="peak">
   <div class="peak-box"><span class="l"></span><span class="r"></span>
   </div>
  </div>
 </div>

 <div id="spectrum-container" class="spectrum-container">
  <div class="spectrum-box">
   <div class="spectrum"></div>
  </div>
 </div> 
```

问题是第一类将歌曲结果和其他格式列出到声音管理器中。我怎样才能将两者结合起来，以便它们一起工作以创建一个真正的播放列表，然后播放下一个功能就可以工作了。

声音管理器设置在我的标题中，我有

```
<!-- Page player core CSS -->
<link rel="stylesheet" type="text/css" href="soundmanager2/page-player.css" />
<!-- soundManager.useFlashBlock: related CSS -->
<link rel="stylesheet" type="text/css" href="soundmanager2/flashblock.css" />

<!-- soundManager API -->
<script src="soundmanager2/soundmanager2.js"></script>

<script>

/* --------

  Config override: This demo uses shiny flash 9 stuff, overwriting Flash 8-based defaults
  Alternate PP_CONFIG object must be defined before soundManager.onready()/onload() fire.
  Alternately, edit the config in page-player.js to simply use the values below by default

-------- */

// demo only, but you can use these settings too..
soundManager.setup({
  flashVersion: 9,
  preferFlash: true, // for visualization effects
  useHighPerformance: true, // keep flash on screen, boost performance
  wmode: 'transparent', // transparent SWF, if possible
  url: 'soundmanager2/'
});

// custom page player configuration

var PP_CONFIG = {
  autoStart: false,      // begin playing first sound when page loads
  playNext: true,        // stop after one sound, or play through list until end
  useThrottling: false,  // try to rate-limit potentially-expensive calls (eg. dragging position around)</span>
  usePeakData: true,     // [Flash 9 only] whether or not to show peak data (left/right channel values) - nor noticable on CPU
  useWaveformData: false,// [Flash 9 only] show raw waveform data - WARNING: LIKELY VERY CPU-HEAVY
  useEQData: false,      // [Flash 9 only] show EQ (frequency spectrum) data
  useFavIcon: false     // try to apply peakData to address bar (Firefox + Opera) - performance note: appears to make Firefox 3 do some temporary, heavy disk access/swapping/garbage collection at first(?) - may be too heavy on CPU
}

</script>

<!-- Page player main script -->
<script src="soundmanager2/page-player.js"></script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T15:50:13.863

我不太了解您要实现的目标，但是在以下链接中，您会找到使用嵌套 ul 标签的一个很好的示例：

[http://www.ezineasp.net/post/HTML-nested-lists-ol-and-ul-tags.aspx](http://www.ezineasp.net/post/HTML-nested-lists-ol-and-ul-tags.aspx)

# arrays - 将数组从一个 Bash 脚本传递到另一个

> ID：16019389
> 
> 赞同：9
> 
> 时间：2013-04-15T15:45:45.543
> 
> 标签：arrays, bash, shell, parameter-passing

我是编写 Shell 脚本的新手，遇到了一些困难。

**我想要达到的目标**

我有一个字符串数组`scriptOne.sh`，我想传递给`scriptTwo.sh`

**到目前为止我做了什么**

我可以从第一个 using 内部执行第二个脚本，`./scriptTwo.sh`并且我已经将字符串变量从一个传递到另一个 using `./scriptTwo.sh $variableOne`。

问题是当我尝试传递一个数组变量时它没有被传递。我已经设法让它通过数组的第一个条目，`./scriptTwo.sh "${array[@]}"`但这只是其中一个条目，我需要所有这些条目。

**在此先感谢您的帮助**

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-15T15:51:51.993

您传递数组的方式是正确的

```
./scriptTwo.sh "${array[@]}" 
```

问题可能在于您接收它的方式。中`scriptTwo.sh`，使用

```
array=("$@") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-05-26T07:56:22.703

我认为如果您使用声明命令，我们可以直接从 sriptOne.sh 读取数组内容。

我在 scriptOne.sh 中声明了一个名为 wes_batch_array 的关联数组，我想将它传递给 scriptTwo.sh，所以我将以下命令放在 scriptTwo.sh 中：

```
declare -A wes_batch_array=$(awk -F '=' '{if ($1 ~ /^declare -A wes_batch_array/) {for (i=2;i<NF;i++) {printf $i"=";} printf $NF"\n";}}' < scriptOne.sh) 
```

我已经测试了这个命令，它工作正常。

如果不使用 declare 命令。您可以将数组的内容回显到另一个中间临时文件，并使用上面的 awk 命令来获取 bash 数组的内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-02-23T20:51:32.840

我解决这个问题的方法是遍历 script1.sh 中的数组，然后使用 for 循环将数组元素传递给 script2.sh。在我的情况下，我将许多具有不同数量元素的数组传递给不同服务器上的同一个 script2.sh。

例如：

脚本1.sh：

```
records="111111111 222222222 333333333"
myRecordsArray=($records)

for (( i=0 ; i < $(#myRecordsArray[@]} ; i++ )); do

./script2.sh ${myRecordsArray[i]}

done 
```

脚本2.sh：

```
main () {
<some code here>
}

myRecord=$1
main $myRecord 
```

# c# - 通过绑定源将文本框绑定到对象属性不刷新

> ID：16019392
> 
> 赞同：0
> 
> 时间：2013-04-15T15:45:52.687
> 
> 标签：c#, object, binding, textbox, bindingsource

这里的目标是使用 BindingSource + Object 作为 DataSource 和 TextBox 来显示对象的属性值。

我面临的问题是 TextBox 没有反映底层对象的属性值变化。

正如中国人所说的一张图片等于一千字，所以下面的演示代码演示了我面临的问题。

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;
using System.Runtime.CompilerServices;

namespace TextBoxDataSourceBindingDemo
{

    public partial class Form1 : Form
    {
        private BindingSource dsSource;
        private BindingDemoClass bDemoClass;
        public Form1()
        {
            InitializeComponent();
            bDemoClass = new BindingDemoClass();
            dsSource = new BindingSource();

            bDemoClass.BindingName = "DemoBinding";
            this.textBox1.DataBindings.Add(new Binding("Text", dsSource, "BindingName",true,DataSourceUpdateMode.OnPropertyChanged));
        }

        private void btnAssignDataSource_Click(object sender, EventArgs e)
        {
           //Setting the datasource is not enough to 
           //update the related textbox
           //refresh must be explicity called ?
           dsSource.DataSource = bDemoClass;
           dsSource.ResetBindings(true);
        }

        private void btnChangePropertyValue_Click(object sender, EventArgs e)
        {
            //Here after setting the property value
            //the textbox should be update with the new value; correct ?
            bDemoClass.BindingName = "DemoBinding2";
        }
    }
    //Demo class used as datasource  
    public class BindingDemoClass : INotifyPropertyChanged
    {
        private string _BindingName = String.Empty;

        public string BindingName
        {
            get { return _BindingName; }
            set
            {
                if (!String.Equals(_BindingName, value))
                {
                    _BindingName = value;
                    NotifyPropertyChanged();
                }
            }
        }

        private void NotifyPropertyChanged([CallerMemberName] String propertyName = "")
        {
            if (PropertyChanged != null)
            {
                PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
            }
        }

        #region INotifyPropertyChanged Members

        public event PropertyChangedEventHandler PropertyChanged;

        #endregion
    }
} 
```

因此，当单击 btnAssignDataSource 按钮时，文本框会更新。我希望当绑定属性更改（btnChangePropertyValue）时，更改将反映到文本框。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T16:05:17.337

你试过这个 this.textBox1.DataBindings.Add("Text", dsSource, "BindingName");

# c# - 刷新时处理数据表对象中未使用的行

> ID：16019395
> 
> 赞同：1
> 
> 时间：2013-04-15T15:45:54.527
> 
> 标签：c#, winforms, datagridview, datatable, refresh

这是一个具体的问题，但似乎应该很简单，我正在以错误的方式思考它。

我有一个 Winform 中的 DataGridView，它绑定到一个数据表。我不断地将数据加载到此数据表中以显示（刷新）。我这样做如下（简化）：

```
public void FillTable( DataTable table, List<MyObject> parameters)
        {
            var lastParent = string.Empty;
            var index = 0;
            table.BeginLoadData( );
            foreach ( var parameter in parameters )
            {
                if ( parameter.ParentName != lastParent )
                {
                    lastParent = parameter.ParentName;
                    index = 0;
                }
                LoadRow( table, parameter, index++);
            }
            table.EndLoadData( );
        }

protected virtual void LoadRow( DataTable table, MyObject objectname, int index)
        {
            indexMap[objectname] = index;     
            table.LoadDataRow( new object[] { stuff }, LoadOption.OverwriteChanges );
        }

public void RefreshParameters( Dictionary<MyObject, string> incomingParameters )
        {
            foreach ( var value in incomingParameters.Keys )
            {
                LoadRow( MyDataTable, value, incomingParameters[value], indexMap[value], true );
            }
        } 
```

这一切都很好。当我初始化我的数据表时，我将它的 PrimaryKey 设置为我表的前两列。这和 indexMap 使得当我加载已经存在的行时，它会覆盖旧行，当我加载不存在的行时，它会添加它。太棒了。

我的问题是，一旦我完成了我的字典，我想删除没有刷新的行（旧值），并确保我的 DataGridView 停止显示这些。我找不到这样做的好方法。有没有人对跟踪旧值、加载数据、然后从数据表和相应的 DataGridView 中删除旧值的方法有任何建议？我已经尝试过我认为应该可以工作的东西，但是 DataGridView 继续显示旧行，即使 DataTable 不再有它们。

# emacs - 关闭nrepl的正确方法是什么？

> ID：16019400
> 
> 赞同：5
> 
> 时间：2013-04-15T15:46:02.860
> 
> 标签：emacs, clojure, nrepl

您如何在 emacs 中优雅地关闭 nrepl？

swank-clojure 以逗号关闭，然后`sayoonara`，这不适用于 nrepl。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-15T16:31:55.147

`M-x nrepl-quit`为我工作。不知道repl本身是否有快捷方式。

# ruby - 无聊的 OSX Ruby 安装

> ID：16019401
> 
> 赞同：1
> 
> 时间：2013-04-15T15:46:05.207
> 
> 标签：ruby, rvm, osx-mountain-lion, homebrew

我不完全确定它何时发生，但现在尝试在我的 OSX Mountain Lion 机器上运行自制软件会产生一个奇怪的错误：

`/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/rubygems/custom_require.rb:31:in `gem_original_require': no such file to load -- checksums (LoadError)`

这是在尝试使用以下命令安装 RVM 失败后发现的：

`\curl -L https://get.rvm.io | bash -s stable --ruby`

```
 % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                               Dload  Upload   Total   Spent    Left  Speed
100   184  100   184    0     0    136      0  0:00:01  0:00:01 --:--:--   155
100 13145  100 13145    0     0   6879      0  0:00:01  0:00:01 --:--:--  6879
Please read and follow further instructions.
Press ENTER to continue.
Downloading RVM from wayneeseguin branch stable
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   124  100   124    0     0    433      0 --:--:-- --:--:-- --:--:--   551
100 3263k  100 3263k    0     0  1245k      0  0:00:02  0:00:02 --:--:-- 1467k

Installing RVM to /Users/mike/.rvm/
    Adding rvm PATH line to /Users/mike/.bashrc /Users/mike/.zshrc.
    Adding rvm loading line to /Users/mike/.bash_profile /Users/mike/.zprofile.

  * WARNING: You have RUBYOPT set in your current environment.
    This may cause rubies to not work as you expect them to as it is not supported
    by all of them If errors show up, please try unsetting RUBYOPT first.

# RVM:  Shell scripts enabling management of multiple ruby environments.
# RTFM: https://rvm.io/
# HELP: http://webchat.freenode.net/?channels=rvm (#rvm on irc.freenode.net)
# Cheatsheet: http://cheat.errtheblog.com/s/rvm
# Screencast: http://screencasts.org/episodes/how-to-use-rvm

# In case of any issues run 'rvm requirements' or read 'rvm notes'

Installation of RVM in /Users/mike/.rvm/ is almost complete:

  * To start using RVM you need to run `source /Users/mike/.rvm/scripts/rvm`
    in all your open shell windows, in rare cases you need to reopen all shell windows.

# Mike Greiling,
#
#   Thank you for using RVM!
#   I sincerely hope that RVM helps to make your life easier and
#   more enjoyable!!!
#
# ~Wayne

rvm 1.19.5 (stable) by Wayne E. Seguin <wayneeseguin@gmail.com>, Michal Papis <mpapis@gmail.com> [https://rvm.io/]

Searching for binary rubies, this might take some time.
No binary rubies available for: osx/10.8/x86_64/ruby-2.0.0-p0.
Continuing with compilation. Please read 'rvm mount' to get more information on binary rubies.
Installing requirements for osx, might require sudo password.
Skipping `brew update` make sure your formulas are up to date.
RVM autolibs is now configured with mode '2' => 'check and stop if missing',
please run `rvm autolibs enable` to let RVM do its job or run and read `rvm autolibs [help]`
or visit https://rvm.io/rvm/autolibs for more information.
Missing required packages: automake, libtool, pkg-config, libyaml, readline, libxml2, libxslt, libksba, openssl, sqlite.
RVM autolibs is now configured with mode '2' => 'check and stop if missing',
please run `rvm autolibs enable` to let RVM do its job or run and read `rvm autolibs [help]`
or visit https://rvm.io/rvm/autolibs for more information.
There were package installation errors, make sure to read the log.
Check Homebrew requirements https://github.com/mxcl/homebrew/wiki/Installation 
```

我不确定是否是因为安装 RVM 失败而导致我的默认 ruby​​ 安装失败，或者 homebrew 本身是否以某种方式损坏，但如果可能的话，我想让 homebrew 和 osx 的本机 ruby​​ 安装再次工作。

它可能归结为终端 PATH 设置或其他东西，但我是新手，不知道从哪里开始。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T16:26:45.400

我似乎已经解决了这个问题。问题似乎与自制软件本身有关。

我运行了以下命令来修复它：

```
$ cd /usr/local
$ git fetch origin
$ git reset --hard origin/master 
```

一旦完成`brew update`了它应该的工作，我重新运行`\curl -L https://get.rvm.io | bash -s stable --ruby`以正确安装 rvm。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T04:16:51.433

您需要阅读输出：

> RVM autolibs 现在配置为模式 '2' => 'check and stop if missing'，请运行`rvm autolibs enable`让 RVM 完成它的工作或运行并阅读`rvm autolibs [help]`

如果您按照[rvm 站点安装说明](https://rvm.io/rvm/install)中的说明进行操作，它会起作用：

```
\curl -#L https://get.rvm.io | bash -s stable --autolibs=3 --ruby 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T15:53:34.590

尝试：

```
rvm get head && rvm reload 
```

更新您的 rvm 安装

# internet-explorer - IE9 中的 jQuery Mobile onclick 分配

> ID：16019402
> 
> 赞同：1
> 
> 时间：2013-04-15T15:46:07.757
> 
> 标签：internet-explorer, jquery-mobile, click

我注意到 IE9 中的 onclick 事件分配存在一个特殊问题 - 在打开开发人员工具面板之前它们不起作用。打开后，即使在开发工具面板关闭后，cliks 也会继续工作。这里有一个已知问题吗？动态绑定到 click 事件是否有帮助，例如在 pageshow 事件中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T02:34:36.153

为了其他运行到该线程的人的利益 - 事实上，如果 IE 开发人员窗格未打开，响应单击的 JavaScript 函数会发出 console.log() ，则 IE 会阻塞。任何其他浏览器都不会发生这种情况。使用 IE 一个无辜的 console.log，您的整个企业就会陷入停顿。

我从遥远的过去就模糊地意识到控制台问题，但是 - 就像任何理智的开发人员一样 - 鉴于我不使用 IE 进行调试（并且希望我可以肢解它，然后烧掉残骸并假装它不存在）我已经忘记了这。

# c# - 使用 DataTable 将数据库数据从服务器传递到客户端

> ID：16019407
> 
> 赞同：0
> 
> 时间：2013-04-15T15:46:16.923
> 
> 标签：c#, json, serialization, gridview

我有以下服务器代码：

**方法.cs**

```
public DataTable GetAllCreditCards()
        {
            string connStr = ConfigurationManager.ConnectionStrings["BankDB"].ConnectionString;
            SqlConnection conn = new SqlConnection(connStr);
            SqlDataAdapter adapter = new SqlDataAdapter();
            DataTable data_table = new DataTable();
            conn.Open();

            SqlCommand cmd = new SqlCommand("GetAllAccountDetails", conn);
            cmd.CommandType = CommandType.StoredProcedure;
            adapter.SelectCommand = cmd;
            adapter.Fill(data_table);
            conn.Close();
            return data_table;
        } 
```

**处理程序.ashx**

```
if (function.Equals("GetAllCreditCards"))
            {
                DataTable text = m.GetAllCreditCards();

                System.Web.Script.Serialization.JavaScriptSerializer oSerializer = new System.Web.Script.Serialization.JavaScriptSerializer();
                string json = oSerializer.Serialize(text);

                context.Response.Write(json);
            } 
```

我有以下客户端代码：

**主页.aspx**

```
if (TextBox_Function.Text.Equals("GetAllCreditCards"))
            {
                HttpWebRequest request = (HttpWebRequest)WebRequest.Create("http://localhost:4000/Handler.ashx?function=" + TextBox_Function.Text);
                HttpWebResponse response = (HttpWebResponse)request.GetResponse();
                String answer = returnResponse(response);

                System.Web.Script.Serialization.JavaScriptSerializer oSerializer = new System.Web.Script.Serialization.JavaScriptSerializer();
                DataTable data_table = oSerializer.Deserialize<DataTable>(answer);

                Session["data_table"] = data_table;
                Response.Redirect("Results_Reader.aspx");
            } 
```

**Results_Reader.aspx**

```
protected void Page_Load(object sender, EventArgs e)
{
    DataTable data_table = (DataTable)Session["data_table"];
    GridView_DataTable.DataSource = data_table;
    GridView_DataTable.DataBind();
} 
```

我要做的是从服务器获取数据库数据，将其放入数据表中，将数据表发送到客户端并将该数据表绑定到网格视图。

当我尝试运行客户端并在变量函数中输入“GetAllCreditCards”时，服务器项目出现以下错误：

```
A circular reference was detected while serializing an object of type 'System.Reflection.RuntimeModule'. 
```

我究竟做错了什么？我只想传递数据库数据并将其绑定到客户端的网格视图，仅此而已。

**编辑**

JavaScriptSerializer 似乎无法序列化数据表。那么如何将记录从服务器发送到客户端并将它们绑定到网格视图？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T15:55:04.527

我的猜测是您正在执行的 javascript 序列化存在问题，如果这有帮助，请查看此处[序列化“SubSonic.Schema .DatabaseColumn”类型的对象时检测到循环引用。](https://stackoverflow.com/questions/1153385/a-circular-reference-was-detected-while-serializing-an-object-of-type-subsonic)

# r - 在 R 中使用 mapply 时将 t.test 的输出保存到数据帧

> ID：16019410
> 
> 赞同：4
> 
> 时间：2013-04-15T15:46:22.687
> 
> 标签：r, statistics

我有两个这样的数据框

```
a    b    c
1    2    3
2    3    3
1    2    3 
```

具有相同的列名。我在用着

```
mapply(t.test, df1, df2) 
```

输出 t.text 比较两个数据帧之间的 a、b 和 c 类型列的结果。这产生（实际结果）：

```
 LHM                                      
statistic   -11.5671                                 
parameter   90.46322                                 
p.value     1.575918e-19                             
conf.int    Numeric,2                                
estimate    Numeric,2                                
null.value  0                                        
alternative "two.sided"                              
method      "Welch Two Sample t-test"                
data.name   "dots[[1L]][[23L]] and dots[[2L]][[23L]]"
        RaM                                      
statistic   -18.66368                                
parameter   172.2032                                 
p.value     3.200675e-43                             
conf.int    Numeric,2                                
estimate    Numeric,2                                
null.value  0                                        
alternative "two.sided"                              
method      "Welch Two Sample t-test"                
data.name   "dots[[1L]][[24L]] and dots[[2L]][[24L]]" 
```

等等等等（我在每个数据框中有大约 180 列数据）。我需要将列的名称及其相应的 p 值存储在矩阵中。在另一列中存储哪个数据框包含更高的值也很有帮助。帮助？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-15T15:48:44.327

尝试这个：

```
mapply(function(x, y) t.test(x,y)$p.value, df1, df2)
# on my sample(/dummy) data.frames
#           a           b           c 
# 0.009963864 0.009963864 0.020204103 
```

* * *

`stack`如果您想要这样的 2 列格式，您可以将其包装起来`data.frame`：

```
stack(mapply(function(x, y) t.test(x,y)$p.value, df1, df2))
#        values ind
# 1 0.009963864   a
# 2 0.009963864   b
# 3 0.020204103   c 
```

# xpath - 获取没有孩子的父母的特定文本值

> ID：16019411
> 
> 赞同：0
> 
> 时间：2013-04-15T15:46:24.590
> 
> 标签：xpath

我正在尝试使用 Xpath 来获取父级的文本，`anchor`而不是从`span`下面的示例中获取文本：

```
<a id="readingListBtn" class="btn btn-transparent" title="Reading List" href="javascript:void(0);">
<span class="icon icon_headerBookmark">Header Bookmark</span>
0
</a> 
```

我使用的 Xpath ( `//a[@id = 'readingListBtn']`) 返回`"Header Bookmark0"`，但我只是对这`"0"`部分感兴趣。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T16:15:53.320

只需获取直接文本子项：

```
//a[@id = 'readingListBtn']/text() 
```

# jquery - joomla中的bootstrap typeahead不接受源数组

> ID：16019412
> 
> 赞同：0
> 
> 时间：2013-04-15T15:46:26.497
> 
> 标签：jquery, joomla1.5, bootstrap-typeahead

我在 Joomla 1.5 中使用 Bootstrap v2.3.1 typeahead 的问题 - 只有当我在输入标签内使用 data-source='["..."]' 方法时它才能正常工作，但不会接受远程 php 生成的 mysql json 编码的查询。

这是我的代码，从教程中复制：

```
<input type="text" id="search" data-provide="typeahead"/>
<script>    
$(function(){
    $("#appendedInputButton").typeahead({
        source: function(query, process) {
            $.ajax({
                url: 'http://www.mydomain.com/source.php',
                type: 'POST',
                data: {q: query},
                dataType: 'JSON',
                async: true,
                success: function(data) {
                    process(data);
                }
            })
        }
    })
})
</script> 
```

这是输出 json 编码数组的简化 source.php：

```
//joomla required stuff   
define( '_JEXEC', 1 );
define('JPATH_BASE', dirname(__FILE__) );
define( 'DS', DIRECTORY_SEPARATOR );
require_once ( JPATH_BASE .DS.'includes'.DS.'defines.php' );
require_once ( JPATH_BASE .DS.'includes'.DS.'framework.php' );
$mainframe =& JFactory::getApplication('site');
$mainframe->initialise();
$db = &JFactory::getDBO();

$array = array();
$array[] = "item1";
$array[] = "item2";
$array[] = "item3";
//this is just for testing

echo json_encode($array); 
```

我在按钮单击后使用简单的 jQuery ajax 加载测试了输出，它打印出数组，但我无法让它与 typeahead 一起使用。另外 - 如果我像这样提供数组，typeahead 甚至都不起作用：

```
var colors = ["red", "blue", "green", "yellow", "brown", "black"];
$('#search').typeahead({source: colors}); 
```

感谢您提供任何帮助 - 我不知道这是 Joomla 问题、我的代码还是其他问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-21T14:40:36.963

对于任何考虑这一点的人 - 我无法在我的 joomla 1.5 站点中使引导预输入工作，而是使用 typeahead.js，它工作正常 >[链接](https://github.com/twitter/typeahead.js)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-10-03T14:38:13.280

可能有点晚了，但是：实际上，它运行良好（Joomla！3.9.4，Bootstrap 3），您必须实例化 Joomla`JResponseJson`类才能获得 json 编码的数据。

所以，而不是 this `echo json_encode($array);`，你应该这样写：

```
 $data = new JResponseJson($array);
 echo $data; 
```

代码在[这里](https://github.com/pr-olga/joomla-basic-component/blob/master/site/views/helloworld/view.json.php)

工作的 Hello-Wolrd-Component 在[这里](https://github.com/pr-olga/joomla-basic-component)：

# c++ - 在 C++ 中内联私有方法

> ID：16019414
> 
> 赞同：3
> 
> 时间：2013-04-15T15:46:30.500
> 
> 标签：c++, inline

在我看到的每个示例中，该关键字`inline`都用于头文件中的公共类方法（或函数）。

**在实现文件中内联私有**类方法有什么特别之处吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-15T15:50:00.440

私有函数是内联的并没有什么特别之处，任何在类声明中定义的函数都成为隐式内联的。

# jquery - 将点击位置作为容器的中心

> ID：16019426
> 
> 赞同：0
> 
> 时间：2013-04-15T15:47:00.850
> 
> 标签：jquery, html

我实现了这段代码：[DEMO](http://jsfiddle.net/buCLX/)

我希望在单击父 div 时，所有子元素的宽度和高度都增长，并且单击的位置站在父 div 的中心。这就像缩放操作。

这是我的代码：

```
 $(".forzoom").click(function (e) {
        var frame = $(this);
        var offset = $(this).offset(); 
        frame.find("div").each(function () {

            var currentItemWidth = $(this).width();
            var currentItemHeight = $(this).height();
            $(this).animate({ 'width': currentItemWidth * 2, 'height': currentItemHeight * 4 }, 400, function () {

                frame.scrollTop((e.clientY - offset.top)*4);

            });

        });
    }); 
```

# .htaccess - 无法访问我 Magento 文件夹中的 Magmi 子文件夹

> ID：16019437
> 
> 赞同：2
> 
> 时间：2013-04-15T15:47:43.953
> 
> 标签：.htaccess, magento, redirect, magmi

我使用 Magmi 导入/导出产品，但是当我访问我的 Magmi 子文件夹 (www.mysite.com/magmi/web/magmi.php) 时总是将我重定向到我的主页。如果我重命名 - 删除 - 移动 - 关闭 magento 主文件夹 .htaccess 文件，我可以访问我的 Magmi 子文件夹。有人可以帮助我如何在不打开主 .htaccess 文件的情况下访问 Magmi 子文件夹吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-15T16:14:56.193

在 Magento 的 .htaccess 中`RewriteBase`添加以下规则：

```
RewriteRule ^magmi/ - [L,NC] 
```

`/magmi/`这将跳过 Magento 对URI的重写处理。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-06-07T10:50:25.370

将此添加到 magmi 文件夹中的 .htaccess 文件中：

`ErrorDocument 401 "Unauthorized Access"`

这样，浏览器将要求输入用户/密码，而不是 404。（见[https://serverfault.com/questions/55323/disable-mod-rewrite-for-subdirectory](https://serverfault.com/questions/55323/disable-mod-rewrite-for-subdirectory)）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-06-16T20:22:28.847

就我而言，magmi 文件夹的权限错误。尝试在 magmi 文件夹和子文件夹上设置 755 权限

# c# - 如何在 C#（或 C++）和 JAVA 之间进行通信

> ID：16019439
> 
> 赞同：1
> 
> 时间：2013-04-15T15:47:56.263
> 
> 标签：c#, java, jakarta-ee, rfid

我正在开发一个基于 RFID 的项目，我们应该通过我们的应用程序与 Gates（RFID 标签阅读器称为 GATE）进行通信（我们正在使用 java 2 ee 来执行此操作）。问题是盖茨只提供 c# 和 c++ SDK。您在 c++ / C# 和 java 之间进行通信的解决方案是什么？有没有所谓的转换器可以缓解疼痛？如果您需要更多信息，这是盖茨制造商网站：http: [//www.marktrace.com/en/default.html](http://www.marktrace.com/en/default.html)

谢谢你们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T15:51:51.863

除了使用其他答案提到的 JNI 之外，我还在为拼贴编写一个类似的程序，我们只是编写了一个与库通信的 C# 客户端，然后通过在 C# 中编写一个与主要 java 应用程序通信的简单 TCP 服务器来弥合与 java 的差距至。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-15T15:49:24.310

您正在搜索允许您与其他库进行通信的[Java 本机接口。](http://en.wikipedia.org/wiki/Java_Native_Interface)

您可以从外部 DLL 调用方法，也可以从 C++ 代码中调用 Java 方法。

您也可以使用[jni4net](http://jni4net.sourceforge.net/)连接到 .NET 库。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-15T15:50:21.753

JNI - Java Native Interface - 您可以使用它从 Java 调用 C++ 代码。 [http://docs.oracle.com/javase/6/docs/technotes/guides/jni/](http://docs.oracle.com/javase/6/docs/technotes/guides/jni/)

这是一个[教程](http://thebreakfastpost.com/2012/01/21/wrapping-a-c-library-with-jni-introduction/)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-15T15:51:33.243

[Java 本机接口](http://en.wikipedia.org/wiki/Java_Native_Interface)是您所需要的。还有一些替代方案和特定的库

# java - 如何在 JSP 中解析/读取这个 XML 文件

> ID：16019445
> 
> 赞同：-2
> 
> 时间：2013-04-15T15:48:26.930
> 
> 标签：java, xml, jsp, xml-parsing

我有以下 XML 文件，我正在尝试使用[http://www.easywayserver.com/blog/java-read-xml-file/](http://www.easywayserver.com/blog/java-read-xml-file/)上的教程从 JSP 中读取这些文件：

**XML 文件 1：**

```
<root>

  <data v="1.0">

    <cellimage counter="0" cash_filename="C:\Temp\_TempFolder\39d437f08cc302876a70a0f91b137991_h.jpg" width="94" height="141" />

    <cellimage counter="1" cash_filename="C:\Temp\_TempFolder\39d437f08cc302876a70a0f91b137991_h.jpg" width="94" height="141" />

  </data>

</root> 
```

**XML 文件 2**

```
<people>
  <person>
    <name>Joe</name>
    <age>30</age>
  </person>
  <person>
    <name>Rob</name>
    <age>29</age>
  </person>
</people> 
```

上面的 XML 文件 1 在下一行引发错误，但第二个 XML 文件工作正常。有人可以告诉我如何使 XML 文件 1 工作吗？

```
 String dateTagValue=dateElements.getChildNodes().item(0).getNodeValue(); 
```

错误堆栈跟踪：

```
Caused by: org.apache.jasper.JasperException: An exception occurred processing JSP page /html/archivedetails/view.jsp at line 33

30:     for (int i = 0; i < nl.getLength(); i++) {
31:         NodeList nameNlc = doc.getElementsByTagName("counter");
32:         Element nameElements = (Element) nameNlc.item(i);
33:         String nameTagValue = nameElements.getChildNodes().item(0).getNodeValue();
34: 
35:         out.println("name :" + nameTagValue + "<br>");
36:     }

Stacktrace:
    at org.apache.jasper.servlet.JspServletWrapper.handleJspException(JspServletWrapper.java:568)
    at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:470)
    at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:390)
    at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:334)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilterChain.doFilter(InvokerFilterChain.java:72)
    at com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilterChain.doFilter(InvokerFilterChain.java:116)
    at com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilter.doFilter(InvokerFilter.java:73)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:684)
    at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:593)
    at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:530)
    at com.liferay.portlet.PortletRequestDispatcherImpl.dispatch(PortletRequestDispatcherImpl.java:323)
    at com.liferay.portlet.PortletRequestDispatcherImpl.include(PortletRequestDispatcherImpl.java:105)
    ... 167 more
Caused by: java.lang.NullPointerException
    at org.apache.jsp.html.archivedetails.view_jsp._jspService(view_jsp.java:152)
    at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
    at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:432)
    ... 182 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T16:53:19.583

例外是在

```
String nameTagValue = nameElements.getChildNodes().item(0).getNodeValue(); 
```

所以要么`nameElements`为空，要么没有子节点（`getChildNodes()`返回空）。

该代码非常可疑，因为您正在循环`nl`，但随后使用索引访问`nameNlc`可能具有或可能不具有相同数量元素的元素。此外，您正在寻找名为 的元素`<counter>`，它们均未出现在任一示例中。

错误消息与您所显示的内容之间存在严重脱节，我怀疑您需要仔细查看您在做什么。可能还有其他不一致之处。

我意识到这是一个边缘的答案（作为评论可能会更好），但评论太长了，鉴于您的帖子中的不一致，可能是您所希望的最好的。

# c# - 更改密码 ASP.NET

> ID：16019448
> 
> 赞同：-2
> 
> 时间：2013-04-15T15:48:37.927
> 
> 标签：c#, asp.net-mvc-3

我在 ASP.NET MVC3 中的应用程序中工作，我尝试让用户可以更改他的密码，但我不知道为什么我的代码不起作用。这里我附上代码。

型号类：

```
public class CambioContraseña
{
    [Required]
    [DataType(DataType.Password)]
    [Display(Name = "Contraseña actual")]
    public string ContraseñaVieja { get; set; }

    [Required]
    [StringLength(100, ErrorMessage = "La contraseña debe tener un minimo de 6 caracteres.", MinimumLength = 6)]
    [DataType(DataType.Password)]
    [Display(Name = "Contraseña nueva")]
    public string ContraseñaNueva { get; set; }

    [Required]
    [DataType(DataType.Password)]
    [Display(Name = "Confirma nueva contraseña")]
    [Compare("ContraseñaNueva", ErrorMessage = "La nueva contraseña y la contraseña de confirmación no coinciden.")]
    public string ConfirmarContraseñaNueva { get; set; }
} 
```

控制器类：

```
[Authorize]
    public ActionResult CambiarContraseña()
    {
        return View();
    }

    //
    // POST: /Account/ChangePassword

    [Authorize]
    [HttpPost]
    public ActionResult CambiarContraseña(CambioContraseña model)
    {
        if (ModelState.IsValid)
        {
            LogOn logon = new LogOn();
            Registro registro = new Registro();
            // ChangePassword will throw an exception rather
            // than return false in certain failure scenarios.
            bool cambioContraseñaCorrecto;
            try
            {
                //MembershipUser usuarioActual = Membership.GetUser(User.Identity.Name, true /* userIsOnline */);
                //cambioContraseñaCorrecto = usuarioActual.ChangePassword(model.ContraseñaVieja, model.ContraseñaNueva);
                cambioContraseñaCorrecto = logon.ExisteUsuario(registro.idUsuario);
                SqlConnection connection = new SqlConnection(
System.Configuration.ConfigurationManager.ConnectionStrings["cs"].ConnectionString);
                connection.Open();
                SqlCommand command = new SqlCommand("update Usuario set contraseña='" + model.ContraseñaNueva + "' where idUsuario='" + registro.idUsuario + "'", connection);
                object comandoRetorno = command.ExecuteScalar();
                connection.Close();

            }
            catch (Exception)
            {
                cambioContraseñaCorrecto = false;
            }
            if (cambioContraseñaCorrecto)
            {
                return RedirectToAction("CambioContraseñaCorrecto");
            }
            else
            {
                ModelState.AddModelError("", "La actual contraseña es inválida o la nueva contraseña es incorrecta.");
            }
        }
        // If we got this far, something failed, redisplay form
        return View(model);
    } 
```

查看课程：

```
@model FutbookPFC.Models.CambioContraseña

@{
ViewBag.Title = "Futbook / Configuración";
Layout = "~/Views/Shared/_LayoutGenerico.cshtml";
}

<h2>CambiarContraseña</h2>

<script src="@Url.Content("~/Scripts/jquery.validate.min.js")"   type="text/javascript">    </script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>

@using (Html.BeginForm()) {
@Html.ValidationSummary(true, "Cambio de contraseña incorrecto. Por favor, corrige los errores e intentelo de nuevo.")
<div>
    <fieldset>
        <legend>Contraseña</legend>

        <div class="editor-label">
            @Html.LabelFor(m => m.ContraseñaVieja)
        </div>
        <div class="editor-field">
            @Html.PasswordFor(m => m.ContraseñaVieja)
            @Html.ValidationMessageFor(m => m.ContraseñaVieja)
        </div>

        <div class="editor-label">
            @Html.LabelFor(m => m.ContraseñaNueva)
        </div>
        <div class="editor-field">
            @Html.PasswordFor(m => m.ContraseñaNueva)
            @Html.ValidationMessageFor(m => m.ContraseñaNueva)
        </div>

        <div class="editor-label">
            @Html.LabelFor(m => m.ConfirmarContraseñaNueva)
        </div>
        <div class="editor-field">
            @Html.PasswordFor(m => m.ConfirmarContraseñaNueva)
            @Html.ValidationMessageFor(m => m.ConfirmarContraseñaNueva)
        </div>

        <p>
            <input type="submit" value="Cambiar Contraseña" />
        </p>
    </fieldset>
</div> 
```

}

有什么办法解决吗？谢谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T06:53:20.697

我的猜测是您在 update where 语句中使用具有国际字符的名称。因此，如果用户名保存为 varchar（您没有 N'），它将找不到任何内容，这意味着它不会更新任何内容。

提示：
`Update T_Whatever WHERE Username =`'abcñxyz'`.` 而不是
`Update T_Whatever WHERE Username =`N'abcñxyz'`.`

PS：
我可以使用 SQL 注入来创建自己的用户。
尝试用户名或密码：d'Alambert。

此外，您应该使用 IDbConnection 和 IDbCommand 而不是 SqlConnection 和 SqlCommand，因为否则，一旦更改数据库，您就不必更改 SQL。

并尝试将 A 类用于您的数据库访问功能。

此外，使用存储过程而不是对 SQL 字符串进行硬编码。
这样您就可以修复 SQL 错误（例如提高其性能），而无需在将应用程序部署到生产环境后重新编译它。

此外，您使用 registro.idUsuario，而无需将类初始化为默认值以外的其他值。

# qooxdoo - qooxdoo : 如何禁用 qx.ui.window.Window 的调整大小？

> ID：16019454
> 
> 赞同：1
> 
> 时间：2013-04-15T15:48:58.840
> 
> 标签：qooxdoo

我有一个扩展类`qx.ui.window.Window`。

我设法通过以下代码将其显示在屏幕上：

```
this.__panel = new my_project.MyPanel();
this.__panel.center();
// then I open it through a button click ( codes irrelevant, omitted ) 
```

在 的构造函数中`MyPanel()`，我有以下内容：

```
this.base(arguments, "My Panel");
this.setShowMaximize(false);
this.setShowMinimize(false);
this.setWidth(800);
this.setHeight(480);
var layout = new qx.ui.layout.Grid(0,0);
this.setLayout(layout);
this.setContentPadding(0); 
```

我错过了什么使它不可调整大小？我是否忽略了 API 文档？

参考：[qx.ui.window.Window](http://demo.qooxdoo.org/current/apiviewer/#qx.ui.window.Window)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T04:26:15.497

要设置`qx.ui.window.Window`不可调整大小（禁用调整大小），请在构造函数中添加以下行：

```
this.setResizable(false, false, false, false); 
```

*注意：我使用的是qooxdoo v2.1.1*

# c# - 使用 LargeIcon 视图时 ListView OwnerDraw 伪影

> ID：16019455
> 
> 赞同：0
> 
> 时间：2013-04-15T15:48:59.427
> 
> 标签：c#, winforms, listview, ownerdrawn

我在 C# WinForms 项目中有一个`OwnerDraw`设置为 true 的 ListView。我正在填充 LargeIcon 和 List 视图，以及`LargeImageList`and`SmallImageList`属性（两者都只有一个图像，因为所有项目都显示相同的图标）。

列表视图绘制没有问题：

![视图模式下的 ListView](https://i.stack.imgur.com/pxKoQ.png)

LargeIcon 视图最初正确显示：

![大图标模式下的 ListView，未选择任何内容](https://i.stack.imgur.com/wDYWR.png)

但在所选项目更改时留下背景工件（单击或使用箭头键无关紧要）：

![在此处输入图像描述](https://i.stack.imgur.com/UjmQK.png)

此外，如图所示，如果太长，文本会被截断，但这是次要问题。

这是我的 DrawItem 事件（`ORANGE`并且`WHIE`是在其他地方声明的颜色常量值）：

```
private void ListView_DrawItem( object sender, DrawListViewItemEventArgs e ) {
    ListView list = sender as ListView;

    if( e.Item.Selected ) {
        e.Graphics.FillRectangle( new SolidBrush( ORANGE ), e.Bounds );
    } else {
        e.Graphics.FillRectangle( new SolidBrush( WHITE ), new Rectangle( e.Bounds.Location, e.Bounds.Size ) );
    }

    e.Graphics.TextRenderingHint = System.Drawing.Text.TextRenderingHint.ClearTypeGridFit;

    if( list.View == View.List ) {
        e.Graphics.DrawImage( list.SmallImageList.Images[0], new Point( e.Bounds.Left + 4, e.Bounds.Top ) );
        e.Graphics.DrawString( e.Item.Text, new Font( "SegoeUI", 10, FontStyle.Regular ), new SolidBrush( Color.Black ), new PointF( e.Bounds.Left + 22, e.Bounds.Top + 1 ) );
    } else if( list.View == View.LargeIcon ) {
        e.Graphics.DrawImage( list.LargeImageList.Images[0], new Point( e.Bounds.Left + ( ( e.Bounds.Width - 32 ) / 2 ), e.Bounds.Top ) );
        e.Graphics.DrawString( e.Item.Text, new Font( "SegoeUI", 10, FontStyle.Regular ), new SolidBrush( Color.Black ), new RectangleF( new PointF( e.Bounds.Left, e.Bounds.Top + 34 ), new SizeF( e.Bounds.Width, e.Bounds.Height - 34 ) ), new StringFormat { Alignment = StringAlignment.Center } );
    }
} 
```

其中很多都是反复试验，包括几何计算和使用`TextRenderingHint`，我这样做是为了使字体平滑，但我不确定我使用的是正确的值。

几年前我最后一次做了一个所有者绘制的 ListView，但我想我现在已经生锈了，我这辈子都无法让它工作。任何指针将不胜感激。

# xcode - UITableView 单元格重复问题

> ID：16019457
> 
> 赞同：0
> 
> 时间：2013-04-15T15:49:10.153
> 
> 标签：xcode, uitableview, xcode4

我完全知道这里有很多关于这个问题的案例，尽管我很困惑并且无法自己解决这个问题。我只想在我的 4 中总共显示 4 个单元格`myTableView2` `UITableView`，但我发现我的单元格无疑因为这条线而被重复使用

```
UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier]; 
```

我知道如果我删除该`if(!cell)`行，我可能会禁用`UITableView`创建新单元格，但这不起作用，因为它要求创建单元格。有什么想法吗？我在下面发布了我的代码。

```
 -(UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
 {
  static NSString *CellIdentifier = @"Cell";
  UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

 if (!cell)
 {
    NSLog(@"CREATING NEW CELL");
    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    cell.contentView.autoresizesSubviews = YES;
    cell.contentView.clipsToBounds = YES;
 }
 if (tableView == self.myTableView)
 {
  if ([[array objectAtIndex:indexPath.row] isKindOfClass:[NSNumber class]])
  {        
    cell.textLabel.text = [[array objectAtIndex:indexPath.row] stringValue];
    cell.textLabel.textColor = [UIColor whiteColor];
    cell.textLabel.textAlignment = NSTextAlignmentCenter;
  }
  else
  {        
    cell.textLabel.text = [array objectAtIndex:indexPath.row];
    cell.textLabel.textColor = [UIColor whiteColor];
    cell.textLabel.textAlignment = NSTextAlignmentCenter;
  }
 }
 if (tableView == self.myTableView2)
 {
    self.myTableView2.opaque = NO;
    self.myTableView2.backgroundColor =  [UIColor colorWithRed:(0.0/255.0) green:(0.0/255.0) blue:(102.0/255.0) alpha:1.0];
    self.myTableView2.backgroundView  = nil;

    if ([[array2 objectAtIndex:indexPath.row] isKindOfClass:[NSNumber class]])
    {
        cell.textLabel.text = [[array2 objectAtIndex:indexPath.row] stringValue];
        cell.textLabel.textColor = [UIColor whiteColor];
        cell.textLabel.lineBreakMode = NSLineBreakByWordWrapping;
        cell.textLabel.textAlignment = NSTextAlignmentCenter;
        cell.textLabel.numberOfLines = 0;
        [cell.textLabel sizeToFit];
        cell.textLabel.font = [self fontForCell];
    }
    else
    {
        cell.textLabel.text = [array2 objectAtIndex:indexPath.row];
        cell.textLabel.textColor = [UIColor whiteColor];
        cell.textLabel.lineBreakMode = NSLineBreakByWordWrapping;
        cell.textLabel.textAlignment = NSTextAlignmentCenter;
        cell.textLabel.numberOfLines = 0;
        [cell.textLabel sizeToFit];
        cell.textLabel.font = [self fontForCell];
    }
 }
 return cell;
} 
```

其他相关数据：

```
-(NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
 if (tableView==self.myTableView)
 {
    return [array count];
 }
 else if(tableView==self.myTableView2)
 {
    return [array2 count];
 }
}

-(NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
 if (tableView==self.myTableView)
 {
    return [array count];
 }
 else if(tableView==self.myTableView2)
 {
    return [array2 count];
 }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T19:48:58.090

解决了！

问题 #1：`NSDictionary`“for”循环是不必要的，并且会导致多个条目。我删除了循环。

问题 2：`numberOfSectionsInTableView`和`numberOfRowsInSection`. 编辑版本如下。经验教训：`numberOfSectionsInTableView`如果您只想显示数组的一个实例，则需要反映 1。值 2 将导致显示两个实例，依此类推。

```
-(NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
 if (tableView==self.myTableView)
 {
    return [array count];
 }
 else if(tableView==self.myTableView2)
 {
    return 1;
 }
}

-(NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
 if (tableView==self.myTableView)
 {
    return 5;
 }
 else if(tableView==self.myTableView2)
 {
    return [array2 count];
 }
} 
```

# ajax - 使用 UNIX cURL 抓取 Ajax Wicket 信息的困难

> ID：16019458
> 
> 赞同：2
> 
> 时间：2013-04-15T15:49:17.340
> 
> 标签：ajax, curl, web-scraping, wicket, scrape

我被指示使用编写抓取某些网站的 UNIX shell 脚本。我们使用**fiddler**来跟踪 HTTP 请求，然后我们相应地编写**cURL**。在大多数情况下，抓取大多数网站似乎相当简单，但是我遇到了难以捕获某些信息的情况。

我需要笼统地说我**无法**提供我实际查看的网站地址，但是我可以发布一些请求和响应以提供**上下文**。

情况如下：

该网站以搜索屏幕开始。您输入搜索查询，网站会返回结果列表。

我需要从结果页面中选择第一个结果。

我需要从第一个结果中捕获页面上的所有内容**。**

***到目前为止，一切都运行良好*** 这是问题所在：

返回的页面具有 wickets 的超**链接**。当这些链接被按下时，页面内会弹出一个窗口——它实际上并不是一个像由 javascript 创建的弹出窗口那样的窗口，它更类似于你在 Facebook 上“撰写消息”或“戳”某人时看到的内容（我是唯一一个仍然这样做的人吗？）。

我需要捕获该弹出窗口的内容。给定页面上通常有**多个检票口链接。**使用循环处理应该很容易，但我需要首先找出正确的方法来卷曲这些检票口。

这是我目前用来尝试刮取检票口的 cURL。

（我明确定义了引用 URL、Accept 和 Wicket-Ajax 布尔值，因为这些是我在跟踪站点时在标头中发送的项目）。链接是如下所示的 URL：

[http://www.someDomainName.com/searches/?x=as56f1sa65df1&random=0.121345151](http://www.someDomainName.com/searches/?x=as56f1sa65df1&random=0.121345151)

（我相信随机填充了一些javascript，不确定是否需要甚至可以重新创建。我目前正在发送我在一个特定场合收到的随机之一。）。

/bin/curl -v3 -b COOKIE -c COOKIE -H "接受：文本/xml" -H "引用者：$URL$x" -H "Wicket-Ajax: true" -sLf "$link"

这是我得到的回复：

```
<ajax-response><redirect><![CDATA[home.page;jsessionid=6F45DF769D527B98DD1C7FFF3A0DF089]]></redirect>
</ajax-response> 
```

我期望返回一个包含实际内容的 XML 文档。对此问题的任何见解将不胜感激。如果您需要更多信息，请告诉我。

谢谢，保罗

# sql - SQL Server 是 yyyy-dd-mm 格式，应用程序发送 yyyy-mm-dd

> ID：16019460
> 
> 赞同：1
> 
> 时间：2013-04-15T15:49:19.243
> 
> 标签：sql, sql-server, configuration, date-format

当应用程序尝试使用此查询 (yyyy/mm/dd) 插入数据时：

```
INSERT INTO Inv_Dueno_Equipo (Cod_Usuario, Fecha_Inicio, Fecha_Termino, Codigo_Equipo)
VALUES (1, '2012/01/26', '2012/01/31', 1); 
```

我收到一个错误

> 从数据类型 varchar 到 datetime 的转换产生了超出范围的值。

但是如果我将查询更改为 ( `yyyy/dd/mm`)

```
INSERT INTO Inv_Dueno_Equipo (Cod_Usuario, Fecha_Inicio, Fecha_Termino, Codigo_Equipo)
VALUES (1, '2012/26/01', '2012/31/01', 1); 
```

数据被插入。我该如何解决这个问题，我需要更改配置以使`yyyy/mm/dd`格式正常工作？

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-15T15:51:12.363

SQL Server 不`DateTime`以任何字符串格式存储 a - 它存储为 8 字节数值。

各种设置（语言、日期格式）仅影响`DateTime`SQL Server Management Studio 中向您显示的方式 - 或者当您尝试将字符串转换为`DateTime`.

SQL Server 支持多种格式 - 请参阅[有关 CAST 和 CONVERT 的 MSDN 联机丛书](http://msdn.microsoft.com/en-us/library/ms187928.aspx)。这些格式中的大多数**取决于**您拥有的设置 - 因此，这些设置有时可能有效 - 有时无效。

解决此问题的方法是使用 SQL Server 支持的（稍作调整的）**ISO-8601 日期格式**- 这种格式**始终**有效- 无论您的 SQL Server 语言和日期格式设置如何。

SQL Server 支持的[ISO-8601 格式](http://msdn.microsoft.com/en-us/library/ms180878.aspx)有两种形式：

*   `YYYYMMDD`仅适用于日期（无时间部分）；注意这里：**没有破折号！**，这很重要！`YYYY-MM-DD`不独立于 SQL Server 中的日期格式设置，并且**不会****在**所有情况下工作！

 **或者：

*   `YYYY-MM-DDTHH:MM:SS`对于日期和时间 - 请注意：这种格式*有*破折号（但*可以*省略），并且`T`在您的`DATETIME`.

这对 SQL Server 2000 和更新版本有效。

如果您使用 SQL Server 2008 或更新版本以及`DATE`数据类型（仅`DATE`-**不是** `DATETIME`！），那么您确实也可以使用该`YYYY-MM-DD`格式，并且该格式也适用于您的 SQL Server 中的任何设置。

不要问我为什么整个话题如此棘手和令人困惑——事情就是这样。但是使用该`YYYYMMDD`格式，您应该适用于任何版本的 SQL Server 以及 SQL Server 中的任何语言和日期格式设置。

因此，对于您的具体情况，请尝试使用：

```
INSERT INTO Inv_Dueno_Equipo (Cod_Usuario,Fecha_Inicio,Fecha_Termino,Codigo_Equipo)
VALUES (1, '20120126', '20120131', 1); 
```

你应该没问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T15:52:36.300

转换函数

```
INSERT INTO Inv_Dueno_Equipo (Cod_Usuario,Fecha_Inicio,Fecha_Termino,Codigo_Equipo) VALUES (1,convert('2012/01/26',103),convert('2012/01/31',103),1); 
```

请参阅[http://www.w3schools.com/sql/func_convert.asp](http://www.w3schools.com/sql/func_convert.asp) 链接并根据需要使用样式参数。**

# r - 在 R 3.0.0 for Windows 中使用 {diagram} 的流程图

> ID：16019464
> 
> 赞同：5
> 
> 时间：2013-04-15T15:49:22.960
> 
> 标签：r, error-handling, diagramming

我正在尝试使用图表包（v 1.6）在 R 中重新制作流程图。我能够使用这个确切的脚本（我从图表文档中的示例修改）制作图表，但是一旦我将 R 更新到 3.0.0，坐标函数就会给我一个错误。这是一个例子：

```
library(graphics)
library(diagram)

par(mar = c(1, 1, 1, 1))
openplotmat()
elpos<-coordinates(c(1,1,2,4))

Error in (function (classes, fdef, mtable)  : unable to find an inherited method for function ‘coordinates’ for signature ‘"numeric"’ 
```

我对 R 和代码等还是很陌生，所以当我运行 traceback() 时，我真的不明白它在告诉我什么：

```
3: stop(gettextf("unable to find an inherited method for function %s for signature %s", 
   sQuote(fdef@generic), sQuote(cnames)), domain = NA)
2: (function (classes, fdef, mtable) 
  {
   methods <- .findInheritedMethods(classes, fdef, mtable)
   if (length(methods) == 1L) 
       return(methods[[1L]])
   else if (length(methods) == 0L) {
       cnames <- paste0("\"", sapply(classes, as.character), 
           "\"", collapse = ", ")
       stop(gettextf("unable to find an inherited method for function %s for signature %s", 
           sQuote(fdef@generic), sQuote(cnames)), domain = NA)
   }
   else stop("Internal error in finding inherited methods; didn't return a unique method", 
       domain = NA)
  })(list("numeric"), function (obj, ...) 
  standardGeneric("coordinates"), <environment>)
1: coordinates(c(1, 1, 2, 4)) 
```

大多数情况下，我不知道为什么坐标（）在更新后不起作用。任何对此的见解，以及可能的回溯翻译都将是一个巨大的帮助。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-04-04T18:53:35.077

我不能像问题一样回答这个问题。最初，我无法重现您的错误：

```
library(diagram)
openplotmat()
(elpos1 <- diagram::coordinates(c(1,1,2,4)))
#       [,1]  [,2]
# [1,] 0.500 0.875
# [2,] 0.500 0.625
# ... 
```

## 查找同名函数

然而，寻找一个`coordinates`函数的其他实例揭示了一些东西：

```
help.search('coordinates', fields='name')
# Help files with name matching 'coordinates' using fuzzy matching:
# 
# diagram::coordinates                  coordinates of elements on a plot
# sp::coordinates-methods               retrieve (or set) spatial coordinates
# sp::coordinates                       sets spatial coordinates to create spatial data, or retrieves spatial
#                                       coordinates
# sp::coordnames                        retrieve or assign coordinate names for classes in sp 
```

此输出搜索所有已安装（不一定已加载）的包。由此看来，`sp`也有一个。在您的用例中使用其版本会产生错误。

## 包加载顺序（或屏蔽函数）

加载包的顺序很重要，因为后来加载的函数中的函数会屏蔽之前加载的包中的同名函数。具体来说：

```
# ensure we have neither package loaded
detach(package:diagram, unload=TRUE) # ignore errors if not loaded
detach(package:sp, unload=TRUE)      # ignore errors if not loaded
library(diagram)
library(sp)
# Attaching package: 'sp'
# 
# The following object is masked from 'package:diagram':
# 
#     coordinates 
```

此消息告诉您，一个简单的调用`coordinates()`将使用 from 版本`sp`而不是 from版本`diagram`。（对于下面的每个代码块，我使用`detach()`上述方法来确保包及其名称空间都不存在。）

`sp`在按顺序加载库后，使用该版本会产生与您相同的错误： `diagram`, `sp`:

```
library(diagram)
library(sp)
# Attaching package: 'sp'
# 
# The following object is masked from 'package:diagram':
# 
#     coordinates
(elpos <- coordinates(c(1,1,2,4)))
# Error in (function (classes, fdef, mtable)  : 
# unable to find an inherited method for function 'coordinates' for signature '"numeric"' 
```

`traceback()`与您提供的相同。

颠倒装载顺序有效：

```
library(sp)
library(diagram)
# Attaching package: 'diagram'
# 
# The following object is masked from 'package:sp':
# 
#     coordinates
(elpos <- coordinates(c(1,1,2,4)))
#       [,1]  [,2]
# [1,] 0.500 0.875
# [2,] 0.500 0.625
# ... 
```

请注意，警告现在告诉您`sp::coordinates()`现在已被屏蔽。

## 当有疑问时，要明确

如果对调用哪个版本有任何疑问，我们总是可以强制使用我们打算使用的版本：

```
(elpos <- diagram::coordinates(c(1,1,2,4)))
#       [,1]  [,2]
# [1,] 0.500 0.875
# [2,] 0.500 0.625
# ... 
```

我觉得有点偏离发布这个*答案*，因为我正在解决你的*问题*，而不一定是陈述的*问题*。如果您仍需要寻找`traceback()`. 但是，在这项工作中，我找不到，但是当期望一个*向量指定每行中的元素数，或具有元素位置的 2 列矩阵或 'NULL'*`.findInheritedMethods()`时，这是有意义的，而期望*从类派生的对象“空间”*（这绝对不是一个简单的向量）。`diagram::coordinates`*`sp::coordinates`*

# c# - JSon.Net序列化收益率返回结果

> ID：16019465
> 
> 赞同：0
> 
> 时间：2013-04-15T15:49:23.437
> 
> 标签：c#, json, json.net, ienumerable, yield-return

我正在尝试使用 json 和 JSon.Net 库将一些数据返回到 Web 服务。我的一个函数是一个迭代器方法，它使用 yield return 列出数据。当我尝试序列化这个返回值时，我得到一个无效的操作异常

我正在使用 `string jsonEncoded = JsonConvert.SerializeObject(ret, Formatting.Indented);`序列化返回值。

异常的完整堆栈跟踪是：

```
System.InvalidOperationException: This operation is only valid on generic types.
   at System.RuntimeType.GetGenericTypeDefinition()
   at Newtonsoft.Json.Serialization.JsonArrayContract..ctor(Type underlyingType) in c:\Temp\Json\Working\Newtonsoft.Json\Src\Newtonsoft.Json\Serialization\JsonArrayContract.cs:line 148
   at Newtonsoft.Json.Serialization.DefaultContractResolver.CreateArrayContract(Type objectType) in c:\Temp\Json\Working\Newtonsoft.Json\Src\Newtonsoft.Json\Serialization\DefaultContractResolver.cs:line 686
   at Newtonsoft.Json.Serialization.DefaultContractResolver.CreateContract(Type objectType) in c:\Temp\Json\Working\Newtonsoft.Json\Src\Newtonsoft.Json\Serialization\DefaultContractResolver.cs:line 800
   at Newtonsoft.Json.Serialization.DefaultContractResolver.ResolveContract(Type type) in c:\Temp\Json\Working\Newtonsoft.Json\Src\Newtonsoft.Json\Serialization\DefaultContractResolver.cs:line 232
   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.GetContractSafe(Object value) in c:\Temp\Json\Working\Newtonsoft.Json\Src\Newtonsoft.Json\Serialization\JsonSerializerInternalWriter.cs:line 83
   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType) in c:\Temp\Json\Working\Newtonsoft.Json\Src\Newtonsoft.Json\Serialization\JsonSerializerInternalWriter.cs:line 67
   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType) in c:\Temp\Json\Working\Newtonsoft.Json\Src\Newtonsoft.Json\JsonSerializer.cs:line 753
   at Newtonsoft.Json.JsonSerializer.Serialize(JsonWriter jsonWriter, Object value, Type objectType) in c:\Temp\Json\Working\Newtonsoft.Json\Src\Newtonsoft.Json\JsonSerializer.cs:line 668
   at Newtonsoft.Json.JsonConvert.SerializeObject(Object value, Type type, Formatting formatting, JsonSerializerSettings settings) in c:\Temp\Json\Working\Newtonsoft.Json\Src\Newtonsoft.Json\JsonConvert.cs:line 921
   at Newtonsoft.Json.JsonConvert.SerializeObject(Object value, Formatting formatting, JsonSerializerSettings settings) in c:\Temp\Json\Working\Newtonsoft.Json\Src\Newtonsoft.Json\JsonConvert.cs:line 893
   at Newtonsoft.Json.JsonConvert.SerializeObject(Object value, Formatting formatting) in c:\Temp\Json\Working\Newtonsoft.Json\Src\Newtonsoft.Json\JsonConvert.cs:line 837
   at AladdinWeb.Handlers.AladdinHandler.ProcessRequest(HttpContext context) in C:\Users\mehrlich\Projects\AladdinWeb\AladdinWeb\Server\Handlers\AladdinHandler.cs:line 85 [ 15/04/2013 11:24:24.68135 ] 
```

迭代器方法的签名是：

```
public IEnumerable<dynamic> FunctionName() { ... } 
```

到目前为止，我有一个临时解决方案，即检查对该函数的调用并调用`ToList`返回值。这序列化很好，但它是一种丑陋的解决方案，因为我需要有一个特殊情况（以及我可能添加的任何其他迭代器方法）。我的猜测是，这与未枚举的 IEnumerable 有关。

我可以让 Json.Net 序列化我的迭代器函数的结果，还是我总是需要这样的特殊情况？让我知道是否需要更多信息或源代码，我会发布。

更多信息：我正在使用 .Net 框架 4.0 版，我正在使用 Json.Net 5.0r2 版

## 迭代器方法的精简源代码

```
public IEnumerable<dynamic> FunctionName()
{
    var methodList = typeof(Targets).GetMethods();

    foreach (var m in methodList)
    {
        dynamic info = new ExpandoObject();

        info.Name = m.Name;

        info.Parameters = from param in m.GetParameters()
                                  select param.Name;

        yield return info;
    }
} 
```

## 方法调用源码

```
...
object ret = null;
if (q == "FunctionName")
{
    ret = FunctionName();  // This causes an exception to be thrown later
    // ret = FunctionName().ToList(); // This does NOT throw an exception later
}
else
{
    ret = DoOtherStuff(q, request);
}

// Serialize the result to JSON 
// This line throws the exception
string jsonEncoded = JsonConvert.SerializeObject(ret, Formatting.Indented);
... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T14:07:17.870

这个问题是 JSon.Net 5.0r2 版本的一个错误，更新到 5.0r3 将解决这个问题，事实上这是 5.0r3 版本的唯一原因。

# cocos3d - Cocos3d：OpenGL 错误 0x0506 在 -[EAGLView swapBuffers] 和空白场景

> ID：16019467
> 
> 赞同：1
> 
> 时间：2013-04-15T15:49:28.197
> 
> 标签：cocos3d

在我的 cocos3d 应用程序中，我有一个 UIViewController 作为 rootview 控制器，当使用单击一个选项时，我会从那里再次启动 Cocos3d 场景。

下面是我从这个视图控制器启动场景的代码。问题是，如果我打开 uiviewcontroller，然后通过单击一个选项两次以上移动到场景，那么我会收到错误消息，如“OpenGL 错误 0x0506 in -[EAGLView swapBuffers] [ ***GL ERROR*** ] Unknown GL error (1286), before绘图 HomeOwners3DScene 未命名：1691。要进一步调查，请在项目构建设置中设置预处理器宏 GL_ERROR_TRACING_ENABLED=1。”

**[这个问题在我查看场景时不是第一次出现，它显示正确。但是，如果我返回并单击返回以显示场景超过两次或更多，那么它似乎是空白场景，xcode 中出现以下错误]**

下面的代码从我的视图控制器移动到更多场景：

```
 -(void) launchMainScene :(UIViewController *) uiViewCrtller
{
[uiViewCrtller.view removeFromSuperview];

// This must be the first thing we do and must be done before establishing view controller.
if( ! [CCDirector setDirectorType: kCCDirectorTypeDisplayLink] )
[CCDirector setDirectorType: kCCDirectorTypeDefault];

// Default texture format for PNG/BMP/TIFF/JPEG/GIF images.
// It can be RGBA8888, RGBA4444, RGB5_A1, RGB565\. You can change anytime.
CCTexture2D.defaultAlphaPixelFormat = kCCTexture2DPixelFormat_RGBA8888;

// Create the view controller for the 3D view.
viewController = [CC3DeviceCameraOverlayUIViewController new];
//viewController.supportedInterfaceOrientations = UIInterfaceOrientationLandscapeRight | UIInterfaceOrientationMaskLandscapeLeft;

// Create the CCDirector, set the frame rate, and attach the view.
CCDirector *director = CCDirector.sharedDirector;
//director.runLoopCommon = YES;  // Improves display link integration with UIKit
[director setDeviceOrientation:kCCDeviceOrientationPortrait];
director.animationInterval = (1.0f / kAnimationFrameRate);
director.displayFPS = YES;
director.openGLView = viewController.view;

// Enables High Res mode on Retina Displays and maintains low res on all other devices
// This must be done after the GL view is assigned to the director!
[director enableRetinaDisplay: YES];

[director setDepthTest:NO];

// Create the window, make the controller (and its view) the root of the window, and present the window

[window addSubview: viewController.view];

CCDirector.sharedDirector.displayFPS = NO;

[CCTexture2D setDefaultAlphaPixelFormat:kCCTexture2DPixelFormat_RGBA8888];

// Set to YES for Augmented Reality 3D overlay on device camera.
// This must be done after the window is made visible!
viewController.isOverlayingDeviceCamera = NO;

// Create the customized CC3Layer that supports 3D rendering and schedule it for automatic updates.
CC3Layer* cc3Layer = [HomeOwners3DLayer node];
[cc3Layer scheduleUpdate];

// Create the customized 3D scene and attach it to the layer.
// Could also just create this inside the customer layer.
cc3Layer.cc3Scene = [HomeOwners3DScene scene];

// Assign to a generic variable so we can uncomment options below to play with the capabilities
CC3ControllableLayer* mainLayer = cc3Layer;

CCScene *scene = [CCScene node];
[scene addChild: mainLayer];
[[CCDirector sharedDirector] runWithScene: scene];

} 
```

当我启动场景并返回视图控制器并多次启动场景并在场景中显示空白屏幕时，Xcode 控制台中抛出以下错误： *** *[当我查看场景时，此问题不是第一次出现，它显示正确。但是，如果我返回并单击返回以显示场景两次或更多次，那么它似乎是空白场景，xcode 中出现以下错误]* *** OpenGL 错误 0x0506 in -[EAGLView swapBuffers] [ ***GL ERROR*** ] 未知 GL 错误（ 1286)，在绘制 HomeOwners3DScene Unnamed:1691 之前。要进一步调查，请在项目构建设置中设置预处理器宏 GL_ERROR_TRACING_ENABLED=1。

请帮助解决我的问题。

谢谢你。

# iphone - 基于定义宏的 Xcode llvm 链接静态库

> ID：16019471
> 
> 赞同：3
> 
> 时间：2013-04-15T15:49:40.220
> 
> 标签：iphone, ios, linker, llvm

我正在构建一个 iOS 应用程序，我希望能够在带有模拟连接的演示模式下启动我的应用程序。我使用静态库进行模拟。但是我不希望在我的应用商店发布版本中链接这个库。我正在寻找解决这个问题的方法。

我能想象的最好的解决方案是，如果我可以像这样定义一个编译器宏：

```
#define TEST_ENVIRONMENT 1 
```

如果此宏为 1，则库将被链接。但我不知道如何为此设置链接。有没有类似的东西可以工作？

我知道我可以在 Xcode 中创建一个新配置并为此配置手动添加库的 -l 选项，但这意味着很容易发生编辑构建设置并忘记编辑测试配置的情况，反之亦然.

最好的问候，迈克尔

# javascript - javascript中多个旅行动画的逻辑

> ID：16019475
> 
> 赞同：0
> 
> 时间：2013-04-15T15:49:46.203
> 
> 标签：javascript, animation, logic

我有一个错误的图像。我想让该图像的 5 个副本从屏幕一侧飞入并在屏幕周围反弹并从侧面反弹。我希望他们都有不同的起始位置和不同的方向。

所以我做了一些全局变量

```
var flyVar;

var flySpeed = 5;
var widthMax = 0;
var heightMax = 0;
var xPosition = 0;
var yPosition = 0;
var xDirection = "";
var yDirection = "";
var bugFly;

var count = 1;
var bug = "bug"; 
```

我有一个名为的函数`setBugs()`，用于根据用户屏幕的大小设置 widthMax 和 heightMax 的值。

我有一个 bugStartingPlace 函数来设置每个 bug 的初始起始位置。我不会发布整个函数，但它对“bug1”到“bug5”的作用相同，给它们不同的值。

```
function bugStartingPlace(bugName) {
//Accepts string as argument and sets the starting position and starting direction of each bug. 
    if (bugName == "bug1") {
        xPosition = 0;
        yPosition = 100;
        xDirection = "right";
        yDirection = "up";
    }
} 
```

我有一个名为 flyBug() 的函数，它执行动画并设置图像的位置。它由一堆这样的语句组成。我知道它有效，因为我可以使它与 1 个错误一起工作。问题在于有 5 个错误。

```
function flyBug() { 
     if (xDirection == "right" && xPosition > (widthMax - document.getElementById("bugImage").width - flySpeed))
         xDirection = "left";
<!--More flow control statements are here-->

document.getElementById("bug1").style.left = xPosition + "px";
document.getElementById("bug1").style.top = yPosition + "px";
<!-- More statements are here that set the position of the image -->

} 
```

所以，我需要一些方法来让动画与 body onload() 事件一起进行。一个问题是 setInterval 不允许包含参数的函数。所以我不能在body onload事件中放置多个语句，将“bug1”作为参数传递给这个函数，“bug2”作为参数传递给这个函数等等。这就是我制作全局计数变量的原因。这样，每当我需要更改错误的名称时，我都会更改 count 的名称，然后执行

```
bug = bug + count; 
```

但这增加了很多复杂性。我需要 bugStartingPlace() 函数的错误名称，所以我需要在使用该函数之前更改 count 的值并更改 bug 的值。一旦我使用了 bugStartingPlace() 函数，它就会改变全局变量的值。然后我需要在再次更改 bug 的值之前使用 flyBug()。

我想问题之一是我使用全局变量来表示方向和位置，即使我有多个错误。它适用于一个错误，但不适用于多个错误。

谁能给我关于这个程序的逻辑应该如何工作的提示？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T15:56:17.867

setInterval 允许像 setTimeout 一样在函数 BUT 中使用参数：

```
setInterval(funcName(param1,param2...), 100); 
```

不会工作。你会得到它像这样工作：

```
var func = function () { funcName(param1,param2..); }

setInterval(func, 100); 
```

要理解 javascript 的那一部分，请通读 dougles crockfords 对函数的解释，他讲得非常清楚和深刻。[链接到他的视频](http://www.youtube.com/watch?v=ya4UHuXNygM)

**编辑：**对不起，我理解你的问题是错误的......

它为什么不起作用的问题是，就像你想通了全局变量一样。你可以把 bug 变成一个对象。然后他的动作将是方法，其中可以包含一个函数等。如果你然后初始化一个新的错误（你可以这样做一千次），所有的变量都留在对象中，而不会相互冲突。这是提供代码可靠性的一种安全方式。

您可以使用嵌套函数非常简单地做到这一点。

另一种方法是将错误 vie 参数的名称发送到例如 fly 函数。并且该函数中唯一的工作是给它的参数。

# javascript - 按日期然后位置排序

> ID：16019476
> 
> 赞同：0
> 
> 时间：2013-04-15T15:49:53.390
> 
> 标签：javascript, function, datetime

我有一个函数用于按 Date 对事件进行排序：

```
function SortByDateAsc() {

    return function (a,b) {

        var aDate = new Date(new Date(a['Month'] +" "+ a['Day']+ " "+ a['Year']));
        var bDate = new Date(new Date(b['Month'] +" "+ b['Day']+ " "+ b['Year']));

        return (aDate < bDate) ? -1 : (aDate > bDate) ? 1 : 0;

    }
} 
```

如果我想按日期然后按位置排序，例如我有两个相同日期的结果，但它们位于两个不同的位置。如何添加要按字母顺序排序的位置？

所以我的最终结果应该是日期加上按字母顺序排列的位置？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T15:55:07.857

在返回之前添加类似的位置检查`0`。此外，还有一种更简单的方法来创建日期。

```
function SortByDateAsc() {
  return function (a,b) {
    // the month-1 is because Date months are 0-indexed, which
    // might not be necessary if your months are already 0-indexes
    var aDate = new Date(a.Year, a.Month-1, a.Day).getTime();
    var bDate = new Date(b.Year, b.Month-1, b.Day).getTime();

    return (aDate < bDate) ? -1 : (aDate > bDate) ? 1 : someLocationComparator(a,b);
  }
} 
```

好好阅读[文档](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date)[。`Date`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T15:56:02.540

返回值会告诉系统你想要什么顺序。

如果要对两个相同日期的事件进行排序，请不要在排序函数上返回 0：

```
function SortByDateAsc() {
    return function (a,b) {

        var aDate = new Date(new Date(a['Month'] +" "+ a['Day']+ " "+ a['Year']));
        var bDate = new Date(new Date(b['Month'] +" "+ b['Day']+ " "+ b['Year']));

        var diff = aDate - bDate;
        if (diff !== 0)
            return diff;

        return (a.location < b.location) ? -1 : (a.location > b.location) ? 1 : 0;
    }
} 
```

# c++ - 将 const char* 转换为 char* 崩溃

> ID：16019478
> 
> 赞同：2
> 
> 时间：2013-04-15T15:49:57.440
> 
> 标签：c++, casting, string-literals

当我试图投射`const char*`到`char*`它崩溃时：

```
int myfunc(const char*);
const char * str = "test";
myfunc( (char*)str ) // crash 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-15T15:52:00.527

你正在做的是未定义的行为。

不允许更改 指向的内存`str`。如果你需要一个你可以改变的，用这种方式声明它：

```
char str[] = "test"; 
```

这将为您创建字符串文字的可变副本`"test"`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-15T15:52:10.087

**更新**

试图修改*字符串文字*是[未定义的行为](http://en.wikipedia.org/wiki/Undefined_behavior)。如果我们查看[草案 C++ 标准](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/n3485.pdf)部分`2.14.5` *字符串文字*第*12*段说：

> 是否所有字符串文字都是不同的（即，存储在不重叠的对象中）是实现定义的。尝试修改字符串文字的效果是未定义的。

崩溃是*未定义行为*的许多可能结果之一，也可能有一个程序似乎可以正常工作。

或者，您可以创建一个*自动*数组，如下所示：

```
char str[] = "test" ; 
```

它将具有*字符串文字*的副本，然后您可以对其进行修改。

**原来的**

如果`myfunc`正在修改字符串文字，那么您有未定义的行为，这很容易导致您的程序崩溃。

# c# - Windows 窗体：窗体未本地化

> ID：16019493
> 
> 赞同：2
> 
> 时间：2013-04-15T15:50:32.700
> 
> 标签：c#, winforms, localization

我们已经成功地本地化了我们的 windows-forms 应用程序。一种形式拒绝使用本地化的资源并且总是与嵌入的资源一起显示。我检查了以下几点：

*   表单 Localizable 属性为 true
*   在运行时 UI 文化设置正确
*   卫星组件在正确的位置
*   使用 SysInternals 流程资源管理器，我验证了该流程使用卫星程序集
*   我用 IL-Spy 打开了卫星程序集并检查它是否包含翻译的资源
*   在调试器中，我进入了 Microsoft 的 ComponentResourceManager.ApplyResources 方法以获得一个按钮。它找到了 text 属性，但是随着代码的优化，我看不到真正有趣的东西。

所有其他形式（不同的程序集）都以正确的语言出现，只有这个……我希望有人有一个有用的想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-15T14:35:26.327

只是偶然发现了同样的问题，但可以解决它。

我刚刚将本地化的 resx 文件导入到项目中。所以 *.de.resx 是项目的一部分，但本地化资源并未应用于所有表单。

参考[http://msdn.microsoft.com/library/y99d1cd3%28v=vs.110%29.aspx](http://msdn.microsoft.com/library/y99d1cd3%28v=vs.110%29.aspx)，本地化的资源文件应出现在表单下方（作为子项）。

所以我的解决方案是： - 浏览所有表格，将语言从默认更改为德语并返回默认。- 结果，*.de.resx 文件被列为表单的子项 - 然后用本地化文件覆盖刚刚创建的 *.de.resx 文件

然后它适用于所有形式。不过，我不知道为什么它以前适用于 4 种形式中的 3 种形式。

向 Windows 窗体应用程序添加新语言的推荐方法是什么？我真的需要点击所有形式的应用程序来为新语言创建空的 resx 文件吗？当然，我可以手动编辑项目文件...

# jax-ws - 使用自定义 POJO 作为参数并从单独项目返回值的 JAX-WS Web 服务

> ID：16019494
> 
> 赞同：0
> 
> 时间：2013-04-15T15:50:34.363
> 
> 标签：jax-ws

我正在尝试实现一个使用 POJO 作为返回值和参数的 Web 服务。每当我这样做时，我都会收到以下异常...

```
Exception while deploying the app [EnterpriseLoggingPoCEAR] : Invalid ejb jar [EnterpriseLoggingPoC.jar]: it contains zero ejb. 
```

我应该用什么来注释我的 POJO 吗？POJO 包含在构建路径中...我知道在.net 中您必须用...注释您的类`[DataContract]`...我是否必须为 JAX-WS pojo 做同样的事情？

我没有提到的一件事是 POJO 位于一个包中，并且是一个不属于 Web 服务项目的项目。一旦我将包移动到我的项目中，错误就清除了，我能够在本地部署项目。现在我想我将我的项目添加到另一个 Web 服务项目的构建路径中。但它仍然会抛出该异常。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T21:07:18.227

eclipse 可以帮助项目之间的引用以重用类和库。例如，如果您有一个包含 Web 模块和 EJB 模块的 EAR 项目，您可以在它们之间共享域类（例如带有`@Entity`注释）或接口（带有`@Remote`o`@Local`注释）。

如果您检查 EnterpriseLoggingPoCEAR 的项目属性，您可能会看到类似以下内容：

![在此处输入图像描述](https://i.stack.imgur.com/r5bKF.png)

在图像中，ExampleModel 项目是一个*典型的*Java 项目。这个项目有一个额外的方面：**实用模块**。当您使用EAR 属性中的**Add...按钮时，会自动添加此构面。**

![在此处输入图像描述](https://i.stack.imgur.com/ZKf7B.png)

您提到的错误是因为您添加了一个*没有*任何*EJB*的 EJB 模块。

![在此处输入图像描述](https://i.stack.imgur.com/e8BSD.png)

此外，您可以在 EAR 的 lib 文件夹中添加一个 jar，而不是引用另一个项目。

![在此处输入图像描述](https://i.stack.imgur.com/BlvQB.png)

顺便说一句，如果您引用项目，这也是自动完成的。

# arrays - 从 MXN 矩阵生成 2^N-1 个矩阵

> ID：16019495
> 
> 赞同：0
> 
> 时间：2013-04-15T15:50:42.143
> 
> 标签：arrays, matlab, vector, matrix

我需要生成 a 的所有可能组合`10X5 matrix`。我需要的是 all `10X1 matrix`,`10X2 matrix`等`10X3 matrix`。什么是最有效的方法。我可以使用多个循环，但这会效率低下。例如：我有一个矩阵：

```
col1 col2 col3 col4 
```

我想：

```
col1 and col2 and col3 and col4 
```

然后：

`col1 col2 and col1 col3 and col1 col4`

依此类推以返回所有 2^5-1**列组合**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T16:00:02.593

您可以`nchoosek`循环使用：

```
for k = 1:ceil(5/2) %only need to go half way up otherwise start repeating
  index{k} = nchoosek(1:5, k);
end 
```

然后使用索引通过选择列来获取子矩阵

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-15T16:08:02.643

我不会为你解决它，但这里有一些有用的功能。您必须澄清您的输入到底是什么。

```
>> nchoosek([1:4],3)

ans =

     1     2     3
     1     2     4
     1     3     4
     2     3     4

>> combntns([1:3],2)

ans =

     1     2
     1     3
     2     3

>> perms([1:3])

ans =

     3     2     1
     3     1     2
     2     3     1
     2     1     3
     1     2     3
     1     3     2 
```

# spring - spring框架参考文档3.2.2中@Inject有错误吗？

> ID：16019500
> 
> 赞同：5
> 
> 时间：2013-04-15T15:50:55.083
> 
> 标签：spring

该文档包含以下段落。

“与@Autowired 一样，可以在类级别、字段级别、方法级别和构造函数参数级别使用@Inject。”

如果我没记错的话，我知道@Inject 注解可以用于字段级别、方法级别和构造函数参数级别，不能用于类级别。

注入注解源代码：

```
@Target({ METHOD, CONSTRUCTOR, FIELD })
@Retention(RUNTIME)
@Documented
public @interface Inject {} 
```

这是真的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-22T10:47:08.003

对我来说，它们几乎是等价的，`@Inject`是自 Java EE 6 以来引入的[CDI](http://docs.oracle.com/javaee/6/tutorial/doc/giwhb.html)`@Autowired`的一部分和 Spring 框架的一部分。

该`@Autowired`界面看起来与@Inject 具有相同的目标：

```
@Target(value={CONSTRUCTOR,FIELD,METHOD})
@Retention(value=RUNTIME)
@Documented
public @interface Autowired 
```

我认为这是[Spring 文档](http://docs.spring.io/spring/docs/3.2.x/spring-framework-reference/html/beans.html#beans-standard-annotations)第 5.11.1 章中的一个小错误，因为我从未`@Autowired`在类级别上看到任何注释。

[此链接](http://docs.spring.io/spring/docs/3.2.5.RELEASE/spring-framework-reference/html/beans.html#beans-standard-annotations-limitations)显示了每种方法的差异和限制。

# java - JPanel 不会在 gui 上显示数据

> ID：16019501
> 
> 赞同：0
> 
> 时间：2013-04-15T15:50:58.020
> 
> 标签：java, swing, jtable, abstracttablemodel

嗨，我正在做一个项目，我需要使用 JTable。我对 AbstractTableModel 进行了子分类，然后将数据放入表中。这工作正常。我创建了一个传入我的 AbstractTableModel 的新 JTable 对象。接下来，我将其设为 AutoScrollPane。当我将 AutoScrollPane 添加到 GUI 时，表格会显示但没有任何数据。我将提供我认为必要的简短代码片段，因为我的代码现在有点混乱。

```
//JPanel tableToShow = new JPanel();
    TablePane table = new TablePane(gp.txt);
    table.addData();
    JTable scrollTable = new JTable(table); 
    scrollTable.setPreferredScrollableViewportSize(new Dimension(500, 70));
    scrollTable.setFillsViewportHeight(true);
    JScrollPane scrollPane = new JScrollPane(scrollTable);
    //tableToShow.add(scrollPane);
    //text.setFont(new Font("Courier", Font.BOLD, 20));
    //text.setPreferredSize(new Dimension(1200,150));

    setLayout(new BorderLayout(10,10));
    add(jplRadio, BorderLayout.WEST);
    add(plotPanel, BorderLayout.EAST);
    add(label, BorderLayout.NORTH);
    add(scrollPane, BorderLayout.SOUTH); 
```

和

```
import java.util.ArrayList;

import javax.swing.table.AbstractTableModel;

public class TablePane extends AbstractTableModel {

public String[] ColumnNames = {"Date", "Level", "Duration", "Weight"};
public String[][] data = null;
private TextImporter txt = null;

public TablePane(TextImporter txt) {
    this.txt = txt;
}

public void addData() {
    ArrayList<?> currentList = null;
    data = new String[4][txt.getSession().size()];
    for(int i = 0; i < ColumnNames.length; i++) {
        if(i == 0) {
            currentList = txt.getSession();
        } else if(i == 1) {
            currentList = txt.getAmplitude();
        } else if(i==2) {
            currentList = txt.getDuration();
        } else if(i==3) {
            currentList = txt.getLegPressure();
        }
        for(int j = 0; j < txt.getSession().size(); j++) {
            data[i][j] = (String) currentList.get(j);
        }
    }
    //System.out.print(data);

}

//  public void displayTable() {
//      
//  }

@Override
public int getColumnCount() {
    // TODO Auto-generated method stub
    return ColumnNames.length;
}

@Override
public int getRowCount() {
    // TODO Auto-generated method stub
    return 0;
}

@Override
public Object getValueAt(int arg0, int arg1) {
    // TODO Auto-generated method stub
    return null;
}

} 
```

如果需要，我可以提供更多代码

# osgi - ClassLoader 仅在特定线程中查找资源

> ID：16019502
> 
> 赞同：3
> 
> 时间：2013-04-15T15:51:10.960
> 
> 标签：osgi, classloader, executorservice, jbehave, rft

我正在努力解决 ClassLoader 试图解析资源的情况，该资源仅在某些条件下有效。

用例如下： 我使用 IBM Rational Functional Tester 和 JBehave 进行自动化验收测试。JBehave 将测试指定为纯文本故事文件。这些故事文件可以引用其他故事文件，即所谓的“Given Stories”。JBehave 使用[ExecutorService](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ExecutorService.html)执行可能是多线程的故事。虽然 JBehave 加载文本文件（使用 ClassLoader.getResourceAsStream）没有问题，但它无法在从 ExecutorService 启动的线程中找到相同的文件。

实际中的 ClassLoader 是[ContextFinder](http://grepcode.com/file/repository.grepcode.com/java/eclipse.org/3.7/org.eclipse/osgi/3.7.0/org/eclipse/core/runtime/internal/adaptor/ContextFinder.java)。在调试应用程序并暂停两个线程时，最初启动 JBehave 的“主线程”和从执行器服务启动以运行故事文件的“故事线程”，我可以识别类加载器的实例是相同的。还有父母的例子等等。

但是打电话给

```
Thread.currentThread().getContextClassLoader().getResource("HelloWorld.story") 
```

在主线程中完美运行，故事线程失败并返回 null。

从 ContextFinder 的源代码来看，除了为堆栈上的类收集所有 ClassLoader 之外，它似乎没有做任何其他事情。所以我尝试了这个：

```
SomeClass.class.getClass().getClassLoader().getResource("HelloWorld.story") 
```

......结果相同。

这对我来说太奇怪了。任何用于调试或解释为什么显示此行为的指针都值得赞赏！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T18:51:48.307

线程上下文类加载器 (TCCL) 在 OSGi 中基本上是未定义的。你应该避免使用它。

作为标准 OSGi 的扩展，Equinox 确实提供了一个称为 ContextFinder 的东西，它执行堆栈检查以尝试在调用堆栈中找到最顶层的 OSGi 捆绑类加载器。但是，您几乎无法控制，而且结果可能出乎您的意料。当然，由于这是 Equinox 特定的扩展，任何依赖 ContextFinder 正常工作的代码都将在所有其他 OSGi 框架上失败。

因此，与其浪费时间尝试调试它，不如根本不使用 TCCL。如果要加载相对于特定类的资源，请从文字类对象中执行，例如：

```
MyClass.class.getResource("HelloWorld.story"); 
```

**更新**：

我在你原来的问题中注意到了这一点：`SomeClass.class.getClass()`. 其结果将是其`java.lang.Class`自身的类对象。调用`getClassLoader()`它*总是*会返回 JVM 引导类加载器......可能不是你想要的！

# javascript - 用于 javascript 日志记录的 Qunit 测试用例

> ID：16019505
> 
> 赞同：0
> 
> 时间：2013-04-15T15:51:16.663
> 
> 标签：javascript, qunit

我正在处理 javascript 客户端日志记录。我在 JavaScript 中有一个名为 WriteLog 的函数，它基本上向指定的服务器 URL 发布一条消息，并向 console.log、console.error 和 console.warn（如果可用）写入一条消息/异常。

我正在寻找参考如何为 WriteLog 函数编写 qunit 测试用例

任何建议

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T15:54:12.880

您应该使用存根或间谍函数并观察它是否已使用正确的参数调用。

签[出 Sinon.js](http://sinonjs.org/)（以及[特定于 Sinon.js 和 QUnit](http://sinonjs.org/qunit/)）

# ios - 向 UINavigationController 添加自定义视图

> ID：16019507
> 
> 赞同：8
> 
> 时间：2013-04-15T15:51:20.863
> 
> 标签：ios, uinavigationcontroller

我有一个`UINavigationController`，当一个事件被触发时，我需要一个自定义`UIView`出现在下面`NavigationBar`，但不阻碍当前`ViewController`。我还需要在`UIView`弹出/推送控制器时保持持久性。

```
 -----------------
|   Status Bar    |
 -----------------
|     Nav Bar     |
 -----------------
|   Custom View   |
 -----------------
|                 |
| View Controller |
|                 |
 ----------------- 
```

我目前正在`CustomView (UIView)`设置框架，例如：

```
- (id)initWithNavigationController:(UINavigationController *)navController {
    self.navController = navController;
    return [self init];
}

- (id)init
{
    CGRect viewFrame = self.navController.view.frame;

    return [self initWithFrame:CGRectMake(viewFrame.origin.x,
                                      self.navController.navigationBar.frame.origin.y + self.navController.navigationBar.frame.size.height,
                                      viewFrame.size.width,
                                      40.0)];
} 
```

这是解决这个问题的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T20:17:12.660

```
- (id)initWithNavigationController:(UINavigationController *)navController {
    CGRect viewFrame = navController.view.frame;

    if (self = [super initWithFrame:CGRectMake(viewFrame.origin.x,
                                      navController.navigationBar.frame.origin.y + navController.navigationBar.frame.size.height,
                                      viewFrame.size.width,
                                      40.0)]){
       self.navController = navController;
      }
    return self;
   } 
```

然后

```
CustomView* _myCustomView = [[CustomView alloc] initWithNavigationController:navigationController];
[navigationcontroller.view addSubview:_myCustomView]; 
```

# sql - 使用动态文件名复制

> ID：16019508
> 
> 赞同：13
> 
> 时间：2013-04-15T15:51:22.477
> 
> 标签：sql, postgresql, plpgsql, dynamic-sql, postgresql-copy

我正在尝试编写一个函数来将 csv 数据加载到表中。我希望输入参数是文件的路径。

```
CREATE OR REPLACE FUNCTION public.loaddata(filepathname varchar)
  RETURNS void AS
$BODY$
BEGIN
COPY climatedata(
    climatestationid, 
    date,
    prcp,
    prcpqflag,
    prcpmflag,
    prcpsflag,
    tmax,
    tmaxqflag,
    tmaxmflag,
    tmaxsflag,
    tmin,
    tminqflag,
    tminmflag,
    tminsflag)
  FROM $1
  WITH csv header;
END;
$BODY$
  LANGUAGE plpgsql VOLATILE
  COST 100;
ALTER FUNCTION public.filltmaxa(character varying)
  OWNER TO postgres; 
```

当我尝试创建此功能时，我得到

> $1 处的语法错误

它出什么问题了？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-04-15T18:04:11.523

您需要**动态 SQL**：

```
CREATE OR REPLACE FUNCTION loaddata(filepathname text)
  RETURNS void AS
$func$
BEGIN
   EXECUTE format ('
   COPY climatedata(
         climatestationid
       , date
         ... -- more columns 
       , tminsflag)
   FROM %L (FORMAT CSV, HEADER)'  -- current syntax
           -- WITH CSV HEADER'    -- tolerated legacy syntax
   , $1);  -- pass function parameter filepathname to format() 
END
$func$ LANGUAGE plpgsql; 
```

[`format()`](https://www.postgresql.org/docs/current/functions-string.html#FUNCTIONS-STRING-OTHER)需要 PostgreSQL 9.1+。
传递文件名而不需要额外的（转义）单引号：

```
SELECT loaddata('/absolute/path/to/my/file.csv') 
```

`format()`with`%L`安全地转义文件名。如果没有它，将容易受到**SQL 注入**的影响。

* * *

*另外*，你有一个函数名不匹配：

```
CREATE OR REPLACE FUNCTION public.**loaddata**(filepathname varchar)
...
ALTER FUNCTION public.**filltmaxa**(character varying)
```

# perl - Open3仅输出到std错误而不是异步

> ID：16019510
> 
> 赞同：2
> 
> 时间：2013-04-15T15:51:23.470
> 
> 标签：perl

我对 perl 编程比较陌生，我试图弄清楚 open3 是如何工作的。这是代码。

```
#!/usr/bin/perl 
use strict;
use warnings;
use IPC::Open3;

my $dir = "/home/vman/Documents/Dev/perl_scripts/Provenance/temp";

my $fileHandle;
my $bashPid;

print "Starting main program\n";

my $pid = fork();

if($pid)#Parent process2
{
    print("Start transfer.\n");
    $bashPid = $pid;

    #Attaching an strace to the executed command which happens in the child process
    open3(\*WRITE, \*READ,\*ERROR,"strace", "-f", "-F", "-e", "trace=open,execve","-p", $bashPid, "-s", "2097152","-q");

    while(<READ>)
    {
        print("Here1\n");
        print("$_");
    }

    while(<ERROR>)
    {
        print("$_");
    }

    print("Finish transfer.\n");
}
elsif($pid == 0)
{
    if (scalar(@ARGV == 0))
    {
        exit
    }

    my $args = join(' ', @ARGV);
    exec($args);
}
else
{
    die("Could not fork.");
}

close(READ);
close(WRITE);
close(ERROR);

waitpid($bashPid, 0);

print "End of main program\n"; 
```

我想在 bash 进程上运行 strace，然后在输出时捕获所有输出。然后我将获取该输出并对其进行解析，以查看哪个进程正在更改哪些文件，并将这些更改保存在 mysql 数据库中。现在我要做的就是将一个 strace 附加到现有的 bash 进程上，并在正在运行的 bash 终端中打印该 strace 的输出，以确保它异步读取输出。

问题之一是我通过 ERROR 文件句柄获取输出。我对为什么会发生这种情况有点困惑。我是否对 open3 使用了正确的顺序，如果出现错误，为什么正确的输出甚至会输出到 stderr？

我遇到的第二个问题是我只有在 exec 结束时才得到输出，这不好，因为它需要在 exec 运行时完成。我认为 open3 是异步运行的。

根据建议，这就是我所做的，并且效果很好。

```
#!/usr/bin/perl 
use strict;
use warnings;
use IPC::Run3;

my $bashPid;

print "Starting main program\n";
my $pid = fork(); 

if($pid)#Parent process
{
    print("Start transfer.\n");
    $bashPid = $pid;

    #Attaching an strace to the executed command which happens in the child process
    my $command = "strace -fFe trace=open,execve -p $bashPid -s 2097152 -q";

    run3($command, \*STDIN, \*STDOUT, \*STDERR);

    if ($?)
    {
        die "something went horribly wrong";
    }

    while(<STDERR>)
    {
        print($_);
    }

    print("Finish transfer.\n");
}
elsif($pid == 0)#cild process
{
    if (scalar(@ARGV == 0))
    {
        exit
    }

    my $args = join(' ', @ARGV);
    exec($args);
}
else
{
    die("Could not fork.");
}

close(STDIN);
close(STDOUT);
close(STDERR);

waitpid($bashPid, 0);

print "End of main program\n"; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T16:00:25.887

> 问题之一是我通过 ERROR 文件句柄获取输出

正确的。`strace`写入 STDERR。

> 我遇到的第二个问题是我只有在 exec 结束时才得到输出，这不好，因为它需要在 exec 运行时完成。我认为 open3 是异步运行的。

那是因为您只有在孩子结束时关闭其 STDOUT 后才开始从孩子的 STDERR 读取。

事实上，你很幸运，你还没有陷入僵局。通过像您当前一样一次读取一个，当`strace`输出足以填满管道时，您将陷入僵局。

您需要从孩子的 STDOUT 和 STDERR 中读取它。您可以在`select`轮询非阻塞句柄或线程的帮助下执行此操作。这些选项都不像放弃`open3`并使用为您处理此问题的更高级别的模块那么简单。更简单的[IPC::Run3](http://search.cpan.org/perldoc?IPC%3a%3aRun3)和功能齐全的[IPC::Run](http://search.cpan.org/perldoc?IPC%3a%3aRun)是不错的选择。

# iphone - iOS - 如何使用通用视图根据属性绘制不同的视图？

> ID：16019513
> 
> 赞同：1
> 
> 时间：2013-04-15T15:51:31.743
> 
> 标签：iphone, ios, ipad, uiview, subclass

我有 2 个名为“AA”和“AB”的视图（在不久的将来我会有更多：“AC”、“AD”等）。现在在我的 viewControllers 中，我需要导入我所有的 UIView 子类并测试一些东西，以便知道我需要创建哪个子视图并将其添加到视图层次结构中。

我的想法是创建一个名为“A”的视图，它将确定它需要绘制哪些子视图并将其“更改”为私有的，可以是“AA”或“AB”。但我不知道该怎么做。

当然，我可以测试需要测试的内容，然后将新视图添加为子视图，但想法是只有一个视图而不是视图中的视图。

感谢您的回答

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T16:02:21.653

您可以使用[*状态设计模式*](http://en.wikipedia.org/wiki/State_pattern)的变体来实现对象需要在运行时配置其活动的系统。您可以创建一个单独的视图，而不是在视图中创建视图，该视图保留一个知道如何在视图中绘制的事物列表，而这些事物本身不是`UIView`对象。

这是一个例子：

```
@interface ViewDraw
-(void)drawInView; // the UIView caller can pass parameters here
@end
@interface ViewDrawA : ViewDraw
-(void)drawInView;
@end
@interface ViewDrawB : ViewDraw
-(void)drawInView;
@end
@interface ViewDrawC : ViewDraw
-(void)drawInView;
@end 
```

现在您的`ViewA`类可以保留一个对象，使用它需要绘制的视图绘制对象对其进行配置，然后调用它们进行绘制`NSArray`。`ViewDraw`重新配置对象列表`ViewDraw`将具有`ViewA`在运行时更改其行为的效果。

# python - 镜像但尺寸错误

> ID：16019515
> 
> 赞同：1
> 
> 时间：2013-04-15T15:51:34.350
> 
> 标签：python, image-processing, resize

我正在尝试输入图像（image1）并将其水平翻转，然后保存到文件（image2）。这有效，但不是我想要的方式

目前这段代码给了我一个翻转的图像，但它只显示了图像的右下角四分之一，所以它的大小是错误的。我在某处覆盖了什么吗？我只想让代码水平翻转图像并显示翻转的整个图片。我哪里做错了？

我**不能**只使用镜像函数或反向函数，我需要编写一个算法

**我得到正确的窗口大小，但图像大小不正确**

```
 def Flip(image1, image2):
    img = graphics.Image(graphics.Point(0, 0), image1)
    X, Y = img.getWidth(), img.getHeight()
    for y in range(Y):
        for x in range(X):
            r, g, b = img.getPixel(x,y)
            color = graphics.color_rgb(r, g, b)
            img.setPixel(X-x, y, color)
    win = graphics.GraphWin(img, img.getWidth(), img.getHeight())
    img.draw(win)
    img.save(image2) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T16:04:53.820

我认为您的问题出在这一行：

```
win = graphics.GraphWin(img, img.getWidth(), img.getHeight()) 
```

GraphWin 构造函数的第一个参数应该是标题，但您却给它一个 Image 对象。这让我相信，您提供的宽度和高度可能会被忽略。GraphWin 的默认宽度和高度为 200 x 200，因此根据图像的大小，这可能是仅绘制部分图像的原因。

尝试这样的事情：

```
win = graphics.GraphWin("Flipping an Image", img.getWidth(), img.getHeight()) 
```

另一个问题是您的图像锚点错误。根据文档，锚点是渲染图像中心的位置（因此在 0,0 处，您只能看到图片的右下象限）。如果您不知道创建时图像的大小，这是一个可能的解决方案：

```
img = graphics.Image(graphics.Point(0, 0), image1)
img.move(img.getWidth() / 2, img.getHeight() / 2) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-15T16:26:58.617

您正在编辑源图像。最好创建一个图像副本并设置这些像素：

创建一个新图像进行编辑：

```
img_new = img 
```

将像素值分配给：

```
img_new.setPixel(X-x, y, color) 
```

而是画出来：

```
win = graphics.GraphWin(img_new, img_new.getWidth(), img_new.getHeight())
img_new.draw(win)
img_new.save(image2) 
```

这还将检查您的范围是否正确。如果不是，您将在最终图像中看到翻转和未翻转的部分，显示哪些部分超出了您的范围。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T15:59:47.110

如果您不反对使用外部库，我会推荐[Python Imaging Library](http://www.pythonware.com/products/pil/)。特别是，该`ImageOps`模块有一个`mirror`功能应该完全符合您的要求。

# python - 无法为 Python 安装包“请求”

> ID：16019523
> 
> 赞同：2
> 
> 时间：2013-04-15T15:51:57.393
> 
> 标签：python, django, ubuntu, pip, python-requests

我尝试使用以下命令在我的 Ubuntu 10.04 服务器上安装 python 的请求包：

```
$ pip install requests 
```

但我不断得到回报：

> 下载/解包请求无法获取 URL [http://pypi.python.org/simple/requests](http://pypi.python.org/simple/requests)：在查找请求的下载链接时将跳过 URL (...url...) 无法获取 URL (...url ...)：在查找请求的下载链接时将跳过 URL (...url...) 无法获取索引基本 URL (...url...) 无法找到需求请求，也无法获取索引 URL (.. .url...) 在 ./pip-log.txt 中存储完整的日志

请原谅我在上面使用“(...url...)”，因为 StackOverflow 不允许我发布超过 2 个链接。

这是 pip-log.txt 中的回溯：

```
Traceback (most recent call last):
File "/usr/lib/python2.6/dist-packages/pip.py", line 252, in main
    self.run(options, args)
File "/usr/lib/python2.6/dist-packages/pip.py", line 08, in run
    requirement_set.install_files(finder, force_root_egg_info=self.bundle)
File "/usr/lib/python2.6/dist-packages/pip.py", line 1750, in install_files
    url = finder.find_requirement(req_to_install, upgrade=self.upgrade)
File "/usr/lib/python2.6/dist-packages/pip.py", line 996, in find_requirement
    url_name = self._find_url_name(Link(self.index_urls[0]), url_name, req)
File "/usr/lib/python2.6/dist-packages/pip.py", line 1073, in _find_url_name
    raise DistributionNotFound('Cannot find requirement %s, nor fetch index URL %s' % (req, index_url))
DistributionNotFound: Cannot find requirement requests, nor fetch index URL (...url...) 
```

我知道 pip 工作正常，因为我已经通过它安装了许多其他软件包。我也尝试过使用 easy_install 和从源代码安装，但两者都有相同的问题。我是 Python/Django 的相对新手，任何人都可以帮我指出正确的方向吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-15T16:10:48.583

你可以试试：

1.  使用像这里解释的镜像[当 PyPI 出现故障时该怎么办](http://jacobian.org/writing/when-pypi-goes-down/)

    ```
    pip install --use-mirrors $PACKAGE 
    ```

2.  正如@sigmavirus24 推荐的那样，第二个选项将使用`Base URL of Python Package Index`

    ```
    pip install -i https://crate.io requests 
    ```

3.  直接从 git 安装包源

    ```
    pip install -e git+https://github.com/kennethreitz/requests#egg=requests 
    ```

尝试 1 - 当我的互联网连接不佳或 pip 关闭时，有时我会遇到同样的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T20:24:38.290

要回答我自己的问题...

*事实证明，这与软件包的安装方式*没有任何关系，尽管错误消息似乎在说什么。问题是我从我的其他终端窗口之一运行我的开发服务器并且从未将其关闭......（ `$ python manage.py runserver [::]:8000` ）。奇怪的是，错误输出没有提及任何相关内容。

# java - 将远程服务绑定到线程

> ID：16019530
> 
> 赞同：0
> 
> 时间：2013-04-15T15:52:16.713
> 
> 标签：java, android, service

我可以将远程服务绑定到我在另一个远程服务中创建的线程吗？

当我尝试使用 Eclipse 时显示错误`bindService(Intent, ServiceConnection, int)`：

```
The method bindService(Intent, AcquisitionThread.GPSServiceConnection, int) is undefined for the type AcquisitionThread 
```

这是我的课，如果你需要的话：

```
public class AcquisitionThread extends Thread {
private static final int VALUES_FROM_THREAD = 1;
private static final int SLEEP_ACQUISITION = 50;
private BluetoothDevice _dev = null;
private BluetoothSocket _sock = null;
private String rawData = null;
private String myText;
private int currentPosition;
private boolean moveLeft;
private AtomicBoolean isMonitoringThread = new AtomicBoolean();
private AtomicBoolean stopMonitoringThread = new AtomicBoolean();

private InputStream inBluetooth;
private OutputStream outBluetooth;
private IMyGPSService GPSService;
private GPSServiceConnection conn = null;

Message messageToMainService = new Message();
Bundle messageData = new Bundle();
Timer timer;

// reference to mainHandler from the mainThread
private Handler mainServiceHandler;

private Handler myThreadHandler = new Handler() {
    public void handleMessage(Message msg) {
        if (msg.what == 0) {
            isMonitoringThread.set(true);
            stopMonitoringThread.set(false);
        }
        if (msg.what == 1) {
            isMonitoringThread.set(false);
            stopMonitoringThread.set(true);
        }
    }
};

//constructor
public AcquisitionThread(Handler serviceHandler,InputStream inBt, OutputStream outBt) {
    // initialize instance vars
    this.mainServiceHandler = serviceHandler;
    this.inBluetooth = inBt;
    this.outBluetooth = outBt;
    isMonitoringThread.set(false);
    stopMonitoringThread.set(false);
}

@Override
public void run() {
    super.run();
    bindGPSService();
    double rpmCalcule = -1;
    double consoCalcule = -1;
    double consoInstantCalcule = -1;
    long totalTime = 0;
    float moyTime;
    int nbIteration = 50;
    try {
        // Thread loop
        while (!stopMonitoringThread.get()) {
            // prepare a message with the updated text              
            if (isMonitoringThread.get()) {
                // // Faire un traitement
                // Thread.sleep(100);
                long startTime = SystemClock.elapsedRealtime();
                write("00f0041"); // Requête au PGN 61444, pour RPM
                try {
                    readResult(inBluetooth);
                    rpmCalcule = calcRpm(rawData);
                    Log.d("rpmCalcule", String.valueOf(rpmCalcule));
                } catch (IOException e) {
                    e.printStackTrace();
                }

                write("00fef21"); // Requête au PGN 65266 pour consommation Fuel
                try {
                    readResult(inBluetooth);
                    consoCalcule = calcConso(rawData);
                } catch (IOException e) {
                    e.printStackTrace();
                }

                long ellapseTime = SystemClock.elapsedRealtime() - startTime + SLEEP_ACQUISITION;
                Log.d("TimeEllapsed", String.valueOf(ellapseTime));

                // send message to mainThread

                messageToMainService.what = VALUES_FROM_THREAD;

                messageData.putDouble("consoValue", consoCalcule);
                messageData.putDouble("rpmValue", rpmCalcule);

                messageData.putLong("timerBoucle", ellapseTime);
                messageToMainService.setData(messageData);
                Log.d("messageData", String.valueOf(messageData));
                mainServiceHandler.dispatchMessage(messageToMainService);

                // update currentPosition value for moving text 
                // ternary if form used
                //                  if (moveLeft)
                //                      currentPosition = (currentPosition == myText
                //                              .length()) ? 0
                //                              : currentPosition + 1;
                //                  else
                //                      currentPosition = (currentPosition == 0) ? myText
                //                              .length()
                //                              : currentPosition - 1;
                //
                //                  sleep(100);
                Thread.sleep(SLEEP_ACQUISITION);
            } else {
                Log.d("Thread while if", "else");
                Thread.sleep(500);
            }
        }
    } catch (Exception e) {
        // Logging exception
        Log.e("TestingAreaLOG", "Erreur, acquisition impossible (clé non connectée?)");
    }
}

// getter for local Handler
public Handler getHandler() {
    return myThreadHandler;
}

// updates the text based on the currentPosition
private String updateText(String text) {
    return text.substring(currentPosition) + text.substring(0, currentPosition);
}

public void write(String cmd) {

    cmd += "\r";
    try {
        outBluetooth.write(cmd.getBytes());
        outBluetooth.flush();
         try {
            Thread.sleep(50);
        } catch (InterruptedException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    } catch (IOException e) {
        e.printStackTrace();
        // } catch (InterruptedException e) {
        // e.printStackTrace();
    }
}

protected void readResult(InputStream in) throws IOException {

    // Log.d("LECTURE",in.toString());
    byte b = 0;
    StringBuilder res = new StringBuilder();
    timer = new Timer(true);
    // read until '>' arrives
    while ((char) (b = (byte) in.read()) != '>')
        if ((char) b != ' ')
            res.append((char) b);
    // timer.get

    rawData = res.toString().trim();
    // Log.d("RAWDATA",rawData);
}

private double calcRpm(String frame) {
    double rpmFloat = -1;
    String rpm1 = frame.substring(6, 8); // On récupère les digits 7 et 8, qui forment le byte 4
    String rpm2 = frame.substring(8, 10); // On récupère les bytes 9 et 10, qui forment le byte 5
    String rpm = rpm2 + rpm1;
    if (isHex(rpm) == true) {
        BigInteger bi = new BigInteger(rpm, 16);
        rpmFloat = bi.doubleValue() / 8;
    }
    return rpmFloat;
}

private double calcConso(String frame) {
    double consoFloat = -1;
    String conso1 = frame.substring(0, 2); // On récupère les digits 1 et 2, qui forment le byte 1
    String conso2 = frame.substring(2, 4); // On récupère les bytes 3 et 4, qui forment le byte 2
    String conso = conso1 + conso2;
    Log.d("CONSO_BYTES", conso);
    if (isHex(conso) == true) {
        BigInteger bi = new BigInteger(conso, 16);
        consoFloat = bi.doubleValue() / 20;
    }
    return consoFloat;
}

private double calcConsoInstant(String frame) {
    double consoInstantFloat = -1;
    String conso1 = frame.substring(4, 6); // On récupère les digits 5 et 6, qui forment le byte 3
    String conso2 = frame.substring(6, 8); // On récupère les bytes 7 et 8, qui forment le byte 4
    String conso = conso1 + conso2;
    Log.d("CONSO_INSTANT_BYTES", conso);
    if (isHex(conso) == true) {
        BigInteger bi = new BigInteger(conso, 16);
        consoInstantFloat = bi.doubleValue() / 512;
    }
    return consoInstantFloat;
}

private static boolean isHex(String s) {
    return s.matches("[0-9a-fA-F]+");
}

class GPSServiceConnection implements ServiceConnection {
    public void onServiceConnected(ComponentName className,
            IBinder boundService) {
        GPSService = IMyGPSService.Stub.asInterface((IBinder) boundService);
        Log.d(getClass().getSimpleName(), "onServiceConnected()");
    }

    public void onServiceDisconnected(ComponentName className) {
        GPSService = null;
        Log.d(getClass().getSimpleName(), "onServiceDisconnected");
    }
};

private void bindGPSService() {
    if (conn == null) {
        conn = new GPSServiceConnection();
        Intent i = new Intent();
        i.setClassName("com.collabera.labs.sai", "com.collabera.labs.sai.GPSService");
        bindService(i, conn, Context.BIND_AUTO_CREATE);
        Log.d(getClass().getSimpleName(), "bindService()");
    } else {
        Log.d("ONBIND", "conn non null");
    }
}

private void releaseGPSService() {
    if (conn != null) {
        unbindService(conn);
        conn = null;
        Log.d(getClass().getSimpleName(), "releaseService()");
    }
}

} 
```

我收到错误`bindService` `and unbindService`

我还添加了此文本，因为 StackOverFlow 发现与“详细信息”相比，代码过多。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T16:14:57.520

在您的课程`AcquisitionThread`中，您没有定义/声明两种方法

```
bindService(i, conn, Context.BIND_AUTO_CREATE); 
```

和

```
 unbindService(conn); 
```

但你仍然在打电话`GPSServiceConnection#bindGPSService()`，`GPSServiceConnection#releaseGPSService()`方法

编辑：解决方案是在`AcquisitionThread`或中声明这些方法`GPSServiceConnection`

（您可以利用 Eclipse 功能，CTRL+1 快速提示您源代码中的错误）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T09:54:25.053

似乎您无法将远程服务绑定到线程，但这没关系。

事实上，在我的例子中，我可以将我的远程服务 GPS 绑定到远程服务蓝牙，它创建了 AcquisitionThreah。

绑定这 2 个服务使线程可以访问我在 GPS 远程服务中需要的方法。

如果您需要更明确的解释，请问我，如果没有人阅读，我不想写所有内容；-)

# php - 如何启动 PHP 程序？

> ID：16019533
> 
> 赞同：0
> 
> 时间：2013-04-15T15:52:35.817
> 
> 标签：php, html

因此，我正在编写一个查询 MySQL 数据库的网站，并以表格形式返回其中的内容。这是我第一次使用 PHP（我已经阅读了教程，但找不到解释这部分的教程），当我启动使用 php 的查询时，它只会打开另一个仅显示 php 代码的浏览器窗口。不知道为什么这样做，所以想也许你们可以提供帮助。

这是我的 HTML：

```
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Insert URL</title>
    <style type = "text/css">
        label { width: 5em; float: left; }
    </style>
</head>
<body>
    <form method = "post" action = "db_query.php">
        <div><label>URL: </label>
            <input type="text" name="URL"><br></div>
        <div><label>Description: </label>
            <input type="text" name="Description"></div>
        <p><input type = "submit" value = "Query"></p>
    </form>
</body> 
```

这是PHP：

```
<html>
<head>
  <meta charset = "utf-8">
  <title>Search Results</title>
<style type = "text/css">
     body  { font-family: sans-serif;
             background-color: lightyellow; } 
     table { background-color: lightblue; 
             border-collapse: collapse; 
             border: 1px solid gray; }
     td    { padding: 5px; }
     tr:nth-child(odd) {
             background-color: white; }
  </style>
 </head>
 <body>
  <?php

        $db_connect = mysql_connect("192.168.0.1", "db", "password");
        $db_query = "SELECT * FROM urltable";

        if (!$db_connect)
        {
            die("Could not connect to database");
        }
        else
        {
            print("Connected to the Database!");
        }

     ?><!-- end PHP script -->

     <table>
     <caption>Results of "SELECT <?php print( "$db_query" ) ?> 
        FROM URLS"</caption>
     <?php
        // fetch each record in result set
        while ( $row = mysql_fetch_row( $result ) )
        {
           // build table to display results
           print( "<tr>" );

           foreach ( $row as $value ) 
              print( "<td>$value</td>" );

           print( "</tr>" );
        } // end while
     ?><!-- end PHP script -->
  </table> 
```

忽略 HTML 代码中的两个输入框，它们现在只是占位符。无论如何，当我点击查询按钮时，它只会打开一个新的浏览器，显示 php 代码而不是实际的查询。我不确定我做错了什么？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T15:55:04.257

要执行 PHP，您*需要*一个像 Apache 这样的 Web 服务器来为您处理请求。

您可以查看[XAMPP](http://www.apachefriends.org/en/xampp.html)（Windows、Mac 和 Linux）、[MAMP](http://www.mamp.info/en/index.html)（仅限 Mac）或[WAMP](http://www.wampserver.com/en/)（仅限 Windows）来运行本地 Web 服务器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T16:10:58.950

最简单的方法是安装 WAMP（在 Windows 上）或 MAMP（在 MAC 上）或 LAMP（在 Linux 上）。
之后将你的脚本放在 C:\wamp\www （在 Windows 上），确保 WAMP 服务器已启动（时钟附近的右侧按钮角应该有一个绿色图标），打开网络浏览器并输入：`http://localhost/nameofyourscript.php`
你可以还使用您的自定义名称（例如 myproject）在 C:\wamp\www 中创建文件夹，并将您的脚本放在该文件夹中。在网络浏览器上启动脚本：`http://localhost/myproject/nameofyourscript.php`

# regex - 如何仅在单个班级中单击链接

> ID：16019534
> 
> 赞同：4
> 
> 时间：2013-04-15T15:52:35.807
> 
> 标签：regex, watir, watir-webdriver

我的元素可以处于两种状态之一`class="icon"`或`class="icon active"`.

我认为这`$browser.element(:class => /^icon$/).click`会单击第一个不活动的按钮，但它只会单击找到的第一个按钮，而不管它是否还包含“活动”。

正则表达式错了吗？或者更好的是，有没有一种非正则表达式的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T16:39:45.407

As mentioned in the comments, the regex you used should work in watir-webdriver. However if you need a solution that will work in both watir-classic and watir-webdriver, you will need to use `find`.

```
b.elements.find{ |e| e.class_name == 'icon'}.click 
```

This will only matches elements where the 'class' attribute is exactly 'icon'.

It is slower and less readable, but allows you to bypass watir-classic's method for matching classes. As seen below, watir-classic will check that the regex matches any of the element's classes.

```
def match_class? element, what
  classes = element.class_name.split(/\s+/)
  classes.any? {|clazz| what.matches(clazz)}
end 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-15T16:27:16.243

这是理论上的，我很抱歉没有时间构建一个假页面并测试它是否有效

```
browser.element(:class => /icon(?!active)$/).click 
```

这在理论上是有效的（正则表达式）匹配一条类似`icon`但不匹配的行`icon active`，但可能有一些隐藏在类名匹配方式上的魔法，这可能会导致它返回错误的行。

如果这不起作用，请告诉我，我会建议一种替代方法，虽然不太优雅，但应该可以工作。

作为参考，我使用了[Rubular](http://rubular.com/)在线正则表达式测试器以及这个 SO answer[正则表达式来匹配不包含单词的行？](https://stackoverflow.com/questions/406230/regular-expression-to-match-string-not-containing-a-word)对此有所了解。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-15T16:47:08.983

如果无法使用正则表达式，另一种选择是获取匹配项目的集合，然后更仔细地检查它们，当您找到一个有效的项目时单击并在此时放弃该集合。

```
browswer.elements(:class => "icon").each do |possible|
  unless possible.attribute_value("class").include? "active"
    possible.click
    break
  end
end 
```

我并不总是 的忠实粉丝`unless`，但在这种情况下，它会产生可读的代码，所以我使用了它

为了进行故障排除，让我们看看该集合中元素的类信息显示的内容

```
browswer.elements(:class => "icon").each do |possible|
  puts possible.attribute_value("class")
end 
```

# c++ - 将浮点数转换为不同的基数

> ID：16019535
> 
> 赞同：3
> 
> 时间：2013-04-15T15:52:35.993
> 
> 标签：c++, floating-point

我有一个自定义代码，用于将浮点数从基数 10 转换为在标准输入中读取的另一个基数。通过将浮点数除以基数并将数字倒写来实现在浮点数的浮点之前转换为数字的另一个基数。浮点数之后的数字的转换是通过将它们乘以基数来实现的，并将浮点数之前的数字顺序写入这个临时结果中。

问题是我是这样一个事实的受害者，例如以 10 为底的 0.8 之类的浮点数在二进制中没有有限表示（因此它们被写为 7.9999 ...）。因此，对于 input`2.8`或任何大于 2 且以 .8 结尾的输入，( `2.8`, `3.8`, `4.8`) 即使我离开以 10 为底，我也会得到输出：(2.79999..., 3.79999..., 4.79999.. .)。

问题是：我该如何解决这个问题，为什么我不会在 0.8 或 1.8 上遇到同样的错误？

这是代码：

```
#include <iostream>

using namespace std;

void printInt(int *a,int k,int base)
{
    if (base<10){
        for (int i=k-1;i>=0;i--)
            cout << a[i];
    }else{
        for (int i=k-1;i>=0;i--)
        {
            if (a[i]<10)
                cout<<a[i];
            else if (a[i]==10)
                cout<<"A";
            else if (a[i]==11)
                cout<<"B";
            else if (a[i]==12)
                cout<<"C";
            else if (a[i]==13)
                cout<<"D";
            else if (a[i]==14)
                cout<<"E";
            else cout<<"F";

        }
    }
}

void printRem(int *a,int k,int base)
{
    if (base<10)
    {
        for(int i=0;i<k;i++){
            cout<<a[i];
        }
    }else{
        for(int i=0;i<k;i++)
        {
            if (a[i]<10)
                cout<<a[i];
            else if (a[i]==10)
                cout<<"A";
            else if (a[i]==11)
                cout<<"B";
            else if (a[i]==12)
                cout<<"C";
            else if (a[i]==13)
                cout<<"D";
            else if (a[i]==14)
                cout<<"E";
            else cout<<"F";

        }
    }
}

int main ()
{
    double n;
    int base;

    cin>>n;
    cin>>base;

    int *whole,*rem,numWhole,numRem;

    whole=NULL;
    numWhole=0;
    rem=NULL;
    numRem=0;

    double floatPart= n - (int)n;
    int intPart=(int)n;

    while (intPart!=0)
    {
        int *temp=new int[numWhole+1];

        int remainder;

        remainder=intPart%base;

        intPart=intPart/base;

        if (whole!=NULL)
            for (int i=0;i<numWhole;i++)
                temp[i]=whole[i];

        delete [] whole;
        temp[numWhole] = remainder;

        whole=temp;
        numWhole++;
    }

    while (floatPart!=0)
    {
        int *temp=new int[numRem+1];

        double nov;
        nov=floatPart*base;

        if (rem!=NULL)
            for (int i=0;i<numRem;i++)
                temp[i]=rem[i];

        temp[numRem]=(int)nov;

        numRem+=1;
        delete [] rem;
        rem=temp;

        floatPart=nov-int(nov);

        if (numRem==10)
            break;
    }

    printInt(whole,numWhole,base);
    if (rem!=NULL) cout<<".";
    printRem(rem,numRem,base);
    cout<<endl;

    cin >> n;

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T16:03:58.113

> 为什么0.8或1.8不会出现同样的错误？

在这些情况下，当您存储*到*`double`. 您所观察到的只是舍入有时会给您想要的答案。

> 我该如何解决？

您很可能`double`是[IEEE-754](http://en.wikipedia.org/wiki/Double-precision_floating-point_format)，它的准确度约为 16 位数。

如果您满足于较少的精度位数，您可以将您的以 10 为底的结果四舍五入。

当您得到任何结果时，例如`2.7999999`，将其四舍五入到更少的数字。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T16:01:12.693

一旦将值存储为浮点类型，就会丢失原始值。在这种情况下，某些数字（例如`0.8`通过变大而失去原始值，而其他数字（例如`2.8`通过变小而失去原始值）。

在任何情况下，正常的解决方案是不使用浮点数（使用定点或字符串表示），或者在显示期间舍入到小数点后的位数。

# javascript - 加载多个视频而不播放

> ID：16019539
> 
> 赞同：1
> 
> 时间：2013-04-15T15:52:40.323
> 
> 标签：javascript, youtube, youtube-api, youtube-javascript-api

我正在构建一个视频播放器，每个场景都是从多个角度拍摄的。所有视频都托管在 YouTube 上。我想让用户能够在播放过程中无缝切换角度。

为了促进这一点，我需要一种从 YouTube 加载视频而不播放它们的方法。这样，我可以在播放一个角度时在背景中加载备用角度。当用户切换角度时，新的角度应至少部分加载并准备好立即播放。

不幸的是，我找不到不播放视频的方法。

该[`loadVideoById`](https://developers.google.com/youtube/js_api_reference#loadVideoById)方法会在加载视频的请求返回后立即自动播放视频，这样就不起作用了。

这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T21:29:35.613

没有办法提示视频并强制它进行预缓冲。

您可以加载（而不是提示）视频，然后立即暂停它，它可能会或可能不会预先缓冲，但这取决于许多因素，并且超出了您作为使用 API 的人的控制范围。

# ios - UIWebview 登录到经过身份验证的站点，然后需要再次登录

> ID：16019540
> 
> 赞同：0
> 
> 时间：2013-04-15T15:52:52.637
> 
> 标签：ios, authentication, uiwebview, nsurlconnection

我无法实现这一点。

有一个 UIwebview 包含一个需要登录的站点。我首先创建了一个登录模式页面供用户登录，这部分已经完成。

我使用了这里的代码：[如何在 UIWebView 中显示身份验证挑战？](https://stackoverflow.com/questions/1769888/how-to-display-the-authentication-challenge-in-uiwebview)

现在，一旦用户登录，他/她就坐在安全的移动站点内。但是手机网站有一些链接需要重新登录。

现在我正在以一种骇人听闻的方式做这件事，方法是：

```
- (BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType; 
```

我检查`request.url`是否等于`"https://www.#$%^&.com"`，如果是，那么我会`set _authed = NO`，然后基本上再次执行登录过程。

它工作正常，但如果有 100 多个链接需要再次登录，我将不得不在我的 if 语句中添加 100 多个 url，以便捕获它。

我希望有人可以帮助我找出更好的方法来实现这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T18:12:34.150

您可以在网页中编写 javascript 函数并从那里调用登录方法。您只需要从模式页面传递用户名和密码。`webViewDidFinishLoad`在下面执行javascript

```
[webView stringByEvaluatingJavaScriptFromString:[NSString stringWithFormat:@"DoLogin('%@','%@','%@');",username,password,redirectURL]; 
```

# php - 警告：preg_match() [function.preg-match]：分隔符不能是字母数字或反斜杠

> ID：16019541
> 
> 赞同：1
> 
> 时间：2013-04-15T15:52:53.450
> 
> 标签：php, preg-match

我在我的网站上收到此错误，但我不知道为什么：

> 警告：preg_match() [function.preg-match]：分隔符不能是字母数字或反斜杠

错误在这个函数中：

```
if (isset($_REQUEST['page']) AND preg_match("\.\.", $_REQUEST['page'])) {
Header("Location: index.php");
die(); 
```

}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T15:54:15.237

您必须将正则表达式括在[分隔符](http://www.php.net/manual/en/regexp.reference.delimiters.php)中：

```
if (isset($_REQUEST['page']) AND preg_match("/\.\./", $_REQUEST['page'])) {
     Header("Location: index.php");
     die();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T15:56:09.060

在为正则表达式操作（例如 preg_match）提供模式时，PHP 有一个有趣的要求，即[模式需要](http://uk1.php.net/manual/en/regexp.reference.delimiters.php)在字符串的开头和结尾有一个字符分隔符。这可以是任何字符，但不应在模式中使用。例如，您可以使用井号作为分隔符：

```
if (isset($_REQUEST['page']) AND preg_match("#\.\.#", $_REQUEST['page'])) { 
```

# ruby-on-rails - 使用 rpec 和 capybara 测试唯一性 - 当错误看起来正确时不通过？

> ID：16019543
> 
> 赞同：1
> 
> 时间：2013-04-15T15:52:58.793
> 
> 标签：ruby-on-rails, ruby, rspec, capybara

我有一个分类模型，其中包含以下内容：

```
# Mass assignable fields
attr_accessible :name, :classification, :is_shown

# Add validation
validates :name,           :presence => true, :uniqueness => true
validates :classification, :presence => true 
```

使用 rspec + capybara，我想测试唯一性验证器。

```
Taxonomy.create(:name => 'foo', :classification => 'activity').save!(:validate => false)
it { should validate_uniqueness_of(:name).scoped_to(:classification) } 
```

此测试失败并出现以下错误：

```
Failure/Error: it { should validate_uniqueness_of(:name).scoped_to(:classification) }
Expected errors to include "has already been taken" when name is set to "foo", got errors: ["name has already been taken (\"foo\")", "classification is not included in the list (:activitz)"] (with different value of classification)
 # ./spec/models/taxonomy_spec.rb:14:in `block (3 levels) in <top (required)>' 
```

在我看来，测试应该通过了。我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T18:27:52.553

这不是 Capybara 问题，因为这是处理模型规范。我假设您正在使用[shoulda matchers gem](https://github.com/thoughtbot/shoulda-matchers)来使用这些特殊的`ActiveRecord`验证匹配器。

给定一个像你的例子这样的模型：

```
class Taxonomy < ActiveRecord::Base
  validates :name,           :presence => true, :uniqueness => true
  validates :classification, :presence => true
end 
```

您将拥有以下规格：

```
describe Taxonomy do
  it { should validate_presence_of(:name) }
  it { should validate_uniqueness_of(:name) }
  it { should validate_presence_of(:classification) }
end 
```

但是，如果您真的希望将 name 字段的唯一性限定为分类：

```
class Taxonomy < ActiveRecord::Base
  validates :name,           :presence => true, :uniqueness => { :scope => :classification }
  validates :classification, :presence => true
end 
```

...以及以下规格：

```
describe Taxonomy do
  it { should validate_presence_of(:name) }
  it { should validate_uniqueness_of(:name).scoped_to(:classification) }
  it { should validate_presence_of(:classification) }
end 
```

# java - 数组的不同计数

> ID：16019545
> 
> 赞同：0
> 
> 时间：2013-04-15T15:53:02.640
> 
> 标签：java, arrays, count, counter

如果我有 2 个并行阵列。一种是short[]，另一种是String[]。short 有一系列标记。短 [95, 96, 95, 99, 100]。字符串有学生的名字 [Mark, Steve, Emma, Rachael, Justin] 他们已经被声明并且是对应的。我知道如何按字母顺序和标记排序。问题要求我打印出学生获得成绩的时间的“*”。用户没有输入任何输入。例如：这将是输出。

```
100 = * (As only 1 person got a 100)
99 = *
96 = *
95 = ** 
```

我必须在没有任何用户输入的情况下获得该输出。我有点想我知道该怎么做，但我很迷茫。我什至不知道如何开始。我所知道的是必须使用一个计数器，但这只有在用户输入标记时才有效。我不知道如何在没有任何输入的情况下做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T16:01:29.243

使用一个数组，使得第 100 个索引对应于 100 级，第 99 个索引对应于 99 级，等等。这样，如果有人得到一个等级`g`，你可以增加数组的第 g 个元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T16:00:16.753

假设 - 没有学生 = 没有

你的2个数组是

```
String [] students; 
```

和

```
short [] marks. 
```

创建第三个数组

```
int [] count = new int[101];

int i = 0;

for(i = 0; i < no; ++i)
    ++count[marks[i]]; 
```

count 数组将不包含每个标记出现的次数，即 count[50] 将不包含获得 50 的学生。

您可以将其打印为

```
for(int i = 0; i < no; ++i)
    System.out.println(i + " = " + count[i]); 
```

# c# - 使用 .net async 将对象放入 Amazon S3

> ID：16019546
> 
> 赞同：6
> 
> 时间：2013-04-15T15:53:05.173
> 
> 标签：c#, amazon-s3, async-await

我想使用以下方法将 AWS S3 异步方法转换为任务：

```
using (var client = AWSClientFactory.CreateAmazonS3Client(accessKey, secretKey))
{
    var request = new PutObjectRequest();
    // ... set request properties ...

    await Task.Factory.FromAsync<PutObjectRequest, PutObjectResponse>(
        client.BeginPutObject,
        client.EndPutObject,
        request,
        null
    );
} 
```

但是，我得到以下异常：

```
System.ArgumentException: The IAsyncResult object was not returned from the corresponding asynchronous method on this class.
Parameter name: asyncResult
   at System.Net.HttpWebRequest.EndGetResponse(IAsyncResult asyncResult)
   at Amazon.S3.AmazonS3Client.getResponseCallback[T](IAsyncResult result)
   at Amazon.S3.AmazonS3Client.endOperation[T](IAsyncResult result)
   at Amazon.S3.AmazonS3Client.EndPutObject(IAsyncResult asyncResult)
   at System.Threading.Tasks.TaskFactory`1.FromAsyncCoreLogic(IAsyncResult iar, Func`2 endFunction, Action`1 endAction, Task`1 promise, Boolean requiresSynchronization) 
```

我的电话是`FromAsync`不正确的还是这里出了什么问题？

附言

*   .NET 框架 4.5
*   AWSSDK 版本 1.5.17.0

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-05-08T09:58:06.240

我遇到了同样的问题。您的 FromAsync 调用是正确的。在没有 FromAsync 包装器的情况下直接调用 BeginPutObject/EndPutObject 时存在同样的问题。

同步方法 AmazonS3Client.PutObject() 具有以下主体：

```
IAsyncResult asyncResult;
asyncResult = invokePutObject(request, null, null, true);
return EndPutObject(asyncResult); 
```

而 AmazonS3Client.BeginPutObject 说：

```
return invokePutObject(request, callback, state, false); 
```

注意invokePutObject 的最后一个布尔参数。此参数称为“同步”。如果您使用 synchronized=true 调用它，它会起作用（通过同步执行操作）。如果您使用 synchronized=false 调用它，在并发负载下，您会收到您发布的异常。

这显然是 AWS 开发工具包中的一个错误，需要进一步调查。[AWS 论坛上的这篇文章](https://forums.aws.amazon.com/thread.jspa?messageID=422180)看起来很相似，但可能不是同一个问题；我对那里的上游回复不满意，因为并发同步上传确实有效。

**ETA**：需要 .Net 4.5 的新 AWS SDK 版本 2.0（在撰写本文时为测试版）具有本机 FooAsync 方法（插入 Begin/EndFoo）。它基于新的 System.Net.HttpClient 库而不是旧的 HttpWebRequest。它几乎可以肯定没有这个错误，但我自己还没有测试过。

# asp.net - 滑动 FormsAuthenticationTicket 超时，将 Session/Cookie experiation 绑定到 FormsAuthenticationTicket

> ID：16019547
> 
> 赞同：0
> 
> 时间：2013-04-15T15:53:11.793
> 
> 标签：asp.net, session, cookies, iis-7, formsauthenticationticket

我们将表单身份验证用作 SSO 站点。然后该站点会生成一个域级别的 cookie，该 cookie 将允许访问子域站点。

问题在于，如果我们的一个子域站点的空闲时间为 1 小时，我们需要杀死该 cookie，但是 FormsAuthenticationTicket 必须保持打开的时间比 cookie 更长。

因此，如果用户被踢出站点 A，他们仍将通过 SSOsite 进行身份验证。这意味着他们仍然可以访问 SSO 站点内的任何链接，只需打开一个新选项卡，浏览器就会让他们通过。有没有办法在会话中滑动 FormsAuthenticationTicket？

谢谢！

# java - 排除一个特定单元测试的 Maven 依赖项

> ID：16019550
> 
> 赞同：3
> 
> 时间：2013-04-15T15:53:21.227
> 
> 标签：java, unit-testing, maven, junit

我想删除单元测试的依赖项。[我在这个答案中](https://stackoverflow.com/questions/12053316/exclude-maven-dependency-for-tests)找到了如何做到这一点。

但我只想删除一个特定测试的依赖项，而不是我的所有测试。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T15:57:07.967

不是通过使用一个 Surefire 执行。

您将必须定义 Surefire 插件的两种执行方式：一种包含用于大多数测试的完整 Classpath，另一种包含用于需要它的单个测试的专用 Classpath。

遵循 Surefire 插件的文档：[http ://maven.apache.org/surefire/maven-surefire-plugin/examples/inclusion-exclusion.html](http://maven.apache.org/surefire/maven-surefire-plugin/examples/inclusion-exclusion.html)

您必须创建两个执行，并将它们都绑定到`test`阶段。使用以下示例作为骨架（您必须调整`include`和`exclude`模式，以及排除的 Classpath 工件）：

```
<plugins>
    <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-surefire-plugin</artifactId>
        <executions>
            <execution>
                <id>full-cp</id>
                <phase>test</phase>
                <goals>
                    <goal>test</goal>
                </goals>
                <configuration>
                    <includes>
                        <include>**/Test*.java</include>
                    </includes>
                    <excludes>
                        <exclude>MyFancyTest.java</exclude>
                    </excludes>
                </configuration>
            </execution>
            <execution>
                <id>special-cp</id>
                <phase>test</phase>
                <goals>
                    <goal>test</goal>
                </goals>
                <configuration>
                    <includes>
                        <include>MyFancyTest.java</include>
                    </includes>
                    <classpathDependencyExcludes>
                        <classpathDependencyExcludes>excluded-artifact</classpathDependencyExcludes>
                    </classpathDependencyExcludes>
                </configuration>
            </execution>
        </executions>
    </plugin>
</plugins> 
```

# c++ - 如何使用 Eclipse CDT 在当前项目中使用外部 .h 和 .o 文件

> ID：16019552
> 
> 赞同：2
> 
> 时间：2013-04-15T15:53:23.653
> 
> 标签：c++, eclipse, linker

我得到了三个文件来测试我的项目：`Test1.cpp` `SignalMasker.h`以及`SignalMasker.o`何时`Test1.cpp`包含我项目中的`SignalMasker.h`文件和文件。将两者都放在源文件夹中会返回未定义的引用，例如：

```
error: undefined reference to 'SignalMasker::~SignalMasker()' 
```

我尝试使用项目首选项并将 .o 文件添加到其中。下`GCC C++ Linker-> Miscellaneous -> other objects`。选择文件时，它插入了一条新记录：

```
"${workspace_loc:/${ProjName}/source/SignalMasker.o}" 
```

构建它似乎并没有解决问题，所以我添加到`Linker flags`标志`-l`并得到：

```
Invoking: GCC C++ Linker
g++ -l -o "uthreads"  ./source/Scheduler.o ./source/SchedulerStarter.o ./source/Test1.o ./source/Thread.o ./source/main.o ./source/uthreads.o  /home/tom/workspace/uthreads/source/SignalMasker.o 
g++: error: uthreads: No such file or directory
make: *** [uthreads] Error 1 
```

所以我回到`other objects`并将自动生成的变量替换为：

```
./source/SignalMasker.o 
```

建筑给了我：

```
make: *** No rule to make target `source/SignalMasker.o', needed by `uthreads'.  Stop. 
```

这些都是我在 SO 中找到的所有解决方案，似乎没有一个有效，包括制作一个库并尝试包含它。请帮忙。

**编辑**：`uthreads`也是项目的名称。

# android - Android 在应用程序中捕获布局

> ID：16019556
> 
> 赞同：0
> 
> 时间：2013-04-15T15:53:33.420
> 
> 标签：android, xml, canvas, bitmap

我正在尝试捕获我的应用程序屏幕，而不仅仅是线性布局。

atm 我正在使用它，我认为它应该可以工作，但 IDK y 它不是。它不仅捕获了我想要的线性布局，还捕获了手机的所有屏幕

```
 final LinearLayout ll = (LinearLayout) findViewById(R.id.Linear);
            View v1 = ll.getRootView();
            v1.setDrawingCacheEnabled(true);
            Bitmap bm = v1.getDrawingCache(); 
```

我的xml的一部分：

```
<LinearLayout
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal"
    android:id="@+id/Linear" >

    <RelativeLayout
        android:layout_width="wrap_content"
        android:layout_height="match_parent" >

                 <ImageView
                     android:layout_width="60dp"
                     android:layout_height="60dp" />

    </RelativeLayout>

<TextView
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="0"
    android:textAppearance="?android:attr/textAppearanceLarge"
    android:textSize="10dp" />

<ImageView
    android:layout_width="15dp"
    android:layout_height="18dp"
    android:layout_marginRight="10dp"
    android:src="@drawable/ll" />

<ImageView
    android:layout_width="15dp"
    android:layout_height="20dp"
    android:src="@drawable/lle" />

</LinearLayout> 
```

atm 它应该捕获仅包含 3 个图像视图和 2 个文本视图的线性布局，但它会捕获所有 xml 或屏幕。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T16:09:01.710

您的问题是您要求根视图，即“所有 xml”。相反，您应该只使用您的`LinearLayout`：

```
 final LinearLayout ll = (LinearLayout) findViewById(R.id.Linear);
        ll.setDrawingCacheEnabled(true);
        Bitmap bm = ll.getDrawingCache(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-07T11:42:39.340

通过使用它，我们可以捕获布局并保存到 sd 卡。 `ok.setOnClickListener(new View.OnClickListener() { @Override public void onClick(View view) { l1.setDrawingCacheEnabled(true); img_bitmap = Bitmap.createBitmap(l1.getDrawingCache()); l1.setDrawingCacheEnabled(false); } }); }`

# azure - Azure 上的 Active Directory 域控制器 - 反向设置

> ID：16019560
> 
> 赞同：0
> 
> 时间：2013-04-15T15:54:01.823
> 
> 标签：azure

我正在寻找为我们公司设置广告。我们开发了一个基于云的应用程序，该应用程序需要强大的权限能力，AD 可以轻松处理。该应用程序基于在 AWS 上运行的 Heroku。我真的需要 AD 来管理登录和组织层次结构。

我想使用基于云的服务作为主域控制器，并在未来设置本地服务器以提供本地身份验证来管理文件/打印和计算机服务。这是我们应用程序的身份验证需求的次要需求。

有谁知道这种架构是否可行？也就是说，Azure 中的 AD 的 DC 稍后会将服务复制到其他本地服务器？这似乎与 Azure 中的大多数设置相反。我可以使用 Azure 以外的其他云服务。似乎他们拥有最多的云 AD 设置文档。

任何想法或帮助将不胜感激。

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T00:32:03.093

虽然我不会让 Cloud 成为我的主要 DC，但这里有一些指南可能会对您有所帮助：

*   [在 Windows Azure 虚拟机上部署 Windows Server Active Directory 的指南](http://msdn.microsoft.com/en-us/library/windowsazure/jj156090.aspx)
*   [在 Windows Azure 中安装新的 Active Directory 林](http://www.windowsazure.com/en-us/manage/services/networking/active-directory-forest/)

为了充分验证您的方案，您认为如何将 Heroku 计算机加入您的域控制器？因为加入运行您的应用程序的服务器将使您完全了解您想要实现的目标。

如果您只想提供从应用程序到主 DC 的 LDAP 访问，并且您的应用程序不是域的一部分，那么在 Azure 中安装 AD是**没有意义的。**

如果您打算只查询 AD 的组织结构，我强烈建议您查看[Windows Azure Active Directory](http://www.windowsazure.com/en-us/home/features/identity/)及其[Graph API](http://msdn.microsoft.com/en-us/library/windowsazure/hh974476.aspx)。这就是您所需要的，如果您**不会将**任何计算机加入域，因为 Windows Azure Active Directory**不是**域控制器。

**更新**

请用更好的描述更新您的问题`simply to allow our Heroku based app to pull in the directory structure and login information to allow our users to authenticate to it.`- 恐怕我无法真正理解这里的应用程序架构和用户登录流程。

# c++ - 将 AES 加密的十六进制字符串转换回 C++ 中的字符串

> ID：16019562
> 
> 赞同：2
> 
> 时间：2013-04-15T15:54:04.343
> 
> 标签：c++, c, character, aes, printf

在 C++ 中，我有一个 AES 加密的 char*，在将其作为 URL 参数发送之前，我将其转换为它的 HEX 表示，[就像在这个问题中所做的那样](https://stackoverflow.com/questions/1501803/convert-aes-encrypted-string-to-hex-in-c)。现在，我想做相反的事情，即再次将此类十六进制转换回 char*。但是我在这里感到困惑-将 sprintf 与 %x 或 %s 一起使用会导致完全不同的值。我怎么能再次转换回来？谢谢...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T17:08:57.587

你可以`sscanf()`这样使用：

```
#define LEN  16 /* 128/8 */

void aes_to_char(char *aes, char *res)
{
  int i;
  for (i = 0; i < LEN; i++) {
    sscanf(aes, "%2hhx", &res[i]);
    aes += 2;
  }
} 
```

`"%2hhx"`表示“一个 2 个字符的十六进制值，要存储在`char *`.

# windows-store-apps - 以编程方式构建 Windows 应用商店应用

> ID：16019563
> 
> 赞同：1
> 
> 时间：2013-04-15T15:54:05.667
> 
> 标签：windows-store-apps, signing

我们需要为平板电脑创建多个 Windows 8 应用程序。有一个通用的解决方案，新闻应用是通过将不同的资源传递给相同的代码来创建的。对于移动来说，这简直是小菜一碟——使用 Microsoft.Build.Evaluation.Project 类来获取 xap 文件。

但是对于 Surface，从代码构建不会直接给出 appx 输出，而使用 MSBuild 构建会给出 appx 作为输出。

我尝试了几种方法来避免从 C#（通过创建命令进程）调用 MSBuild，例如创建一个 zip 文件 - myapp.appx - 然后使用[此 c++ 代码](http://msdn.microsoft.com/en-us/library/windows/desktop/jj835834%28v=vs.85%29.aspx)对其进行签名。由于外部参考，它没有锻炼，我放弃了。

然后我尝试通过在 C# 中创建命令进程来使用 SignTool.exe。那也失败了。

所以，我想知道是否有任何方法可以在没有 MSBuild 的情况下直接从 C# 构建 appx。

我试图避免 MSBuild 的原因是从 Microsoft.Build.Evaluation.Project.Build() 提供的构建过程中获取状态。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T23:20:55.597

首先尝试向您的项目添加 pfx 密钥，然后再次尝试通过 Microsoft.Build.Evaluation.Project.Build() 进行构建。我阅读的内容需要 pfx：请参阅 Candy 的答案：

[用于创建 .appx 包的 MSBuild 目标](http://social.msdn.microsoft.com/Forums/en-US/toolsforwinapps/thread/165fa571-bdad-4624-9c4b-d1701ea25f56/)

因此，诀窍是首先使用 SignTool 获取 pfx 并使用该 pfx 更新项目，但首先查看上述方法是否有效。

# php - 在 MVC 框架中通过 url 传递多个参数

> ID：16019568
> 
> 赞同：-2
> 
> 时间：2013-04-15T15:54:31.567
> 
> 标签：php, url-routing

我试图在一个看起来像这样的 url 中传递多个参数......

```
http://somedomain.com/lessons/lessondetails/5/3 
```

...到控制器中看起来像这样的函数...

```
class LessonsController extends Controller

{
public function lessonDetails($studentId, $editRow=NULL)
{
    try {
        $studentData = new StudentsModel();
        $student = $studentData->getStudentById((int)$studentId);
        $lessons = $studentData->getLessonsByStudentId((int)$studentId);

        if ($lessons)
        {
            $this->_view->set('lessons', $lessons);

        } 
        else
        {
            $this->_view->set('noLessons', 'There are no lessons currently scheduled.');
        }
        $this->_view->set('title', $student['first_name']);
        $this->_view->set('student', $student);

        return $this->_view->output();

    } catch (Exception $e) {
        echo "Application error: " . $e->getMessage();
    }
}
} 
```

但似乎只有第一个参数成功通过。不知道在这里复制和粘贴什么，但这里是 bootstrap.php ......

```
$controller = "students";
$action = "index";
$query = null;

if (isset($_GET['load']))
{
    $params = array();
    $params = explode("/", $_GET['load']);

    $controller = ucwords($params[0]);

    if (isset($params[1]) && !empty($params[1]))
    {
            $action = $params[1];
    }

    if (isset($params[2]) && !empty($params[2]))
    {
            $query = $params[2];
    }
}

$modelName = $controller;
$controller .= 'Controller';
$load = new $controller($modelName, $action);

if (method_exists($load, $action))
{
    $load->{$action}($query);
}
else
{
    die('Invalid method. Please check the URL.');
} 
```

提前致谢！

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-15T16:03:38.923

从您的动作控制器调用`$this->getRequest()->getParams()`并检查两个参数是否都存在。

如果否，则问题出在您的路由上。

如果是，则问题在于将参​​数传递给您的控制器方法`lessonDetails`。

还有，`lessondetailsAction`不见了。（如果您访问您发布的网址，这将是调用的方法）

# css - CSS Wordwrap 无法按预期工作

> ID：16019570
> 
> 赞同：0
> 
> 时间：2013-04-15T15:54:34.237
> 
> 标签：css, html

根据我之前的[线程](https://stackoverflow.com/questions/16017893/why-are-my-divs-overlapping)，我正在尝试使用并理解使用溢出元素水平对齐两个 div 的推荐方法。

使用我的短文本，两个 div 正确对齐，但是当我添加单独的文本时，它会落在图像下方。谁能解释为什么会发生这种情况以及我该如何解决？

我的**[JSFIDDLE](http://jsfiddle.net/thetoolsmith/JVhQB/2/)**

HTML：

```
<div class="container" style="overflow: hidden; width: 100%">
<div class="left">
    <img src="http://localhost/new/img/sampleimg.png" class="wall-thumb-small" />
</div>
<div class="right">
    <div style="word-wrap: break-word;">Some long text here Some long text here Some long text here Some long text here Some long text here </div>
</div>
</div> 
```

CSS：

```
div.container {
border: 1px solid #000000;
overflow: hidden;
width: 100%;
}

div.left {
padding:5px;
float: left;
}

div.right { 
float: left;
}

.thumb-small{
width:35px;
height:35px;
border: 1px solid #B6BCBF;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T16:02:20.873

删除长文本上的浮动规则（**[jsFiddle 示例](http://jsfiddle.net/j08691/JVhQB/6/)**）。当 en 元素在另一个浮动元素之后浮动时，它不能垂直出现在它之前。

```
<div>
    <div style="word-wrap: break-word;">Some long text here Some long text here Some long text here Some long text here Some long text here </div>
</div> 
```

长版本见[W3](http://www.w3.org/TR/CSS2/visuren.html#floats)：

> 浮动框的外部顶部不得高于源文档中早期元素生成的任何块或浮动框的外部顶部。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T16:01:51.277

浮动扩展以尝试包含其内容。它们通常扩展到包含区域的宽度，无论它们如何定位。这就是为什么当文本很长时它会换行。

对于您正在做的事情，我相信您希望图像位于某些文本的左侧。这是通过使用 clearfix CSS 设置外部区域来完成的（始终包含所有浮动）：

```
.container {
  overflow: hidden;
  min-width: 1px;
}
/* IE7+ */
*+html .container {
  min-height: 1%;
} 
```

然后，仅将您的图像浮动到左侧。不要浮动您的内容。根据需要在图像周围添加边距。所以像：

```
.left {
  float: left;
  margin: 0 10px 10px 0; /* 10px on right and bottom */
} 
```

然后 div 中的内容将像您期望的那样运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T16:04:55.943

删除`float:left;`规则，它将起作用。但是，您可能希望在 ie 6+ 中进行改进和测试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-15T16:02:30.597

您必须设置 max-width 属性以限制您的文本表单占用尽可能多的空间，并获得最大空间，使其进入下一行。

[http://jsfiddle.net/a6BbD/1/](http://jsfiddle.net/a6BbD/1/)

```
<div class="container" style="overflow: hidden; width: 100%">
    <div class="left">
        <img src="http://localhost/new/img/sampleimg.png" class="thumb-small" />
    </div>
    <div class="right">
    <div style="word-wrap: break-word;max-width:400px">Some long text here Some long text here   Some long text here Some long text here Some long text here </div>
    </div>
</div>

<br>

<div class="container" style="overflow: hidden; width: 100%">
    <div class="left">
        <img src="http://localhost/new/img/sampleimg.png" class="thumb-small" />
    </div>
    <div class="right">
    <div style="word-wrap: break-word;">Some short text here</div>
    </div>
</div> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-15T16:33:54.943

该建议说您应该始终在浮动元素上设置宽度。下面的链接有很好的材料来理解花车..

```
 http://coding.smashingmagazine.com/2007/05/01/css-float-theory-things-you-should-know/ 
```

# c# - 将 varchar 转换为 nvarchar

> ID：16019571
> 
> 赞同：0
> 
> 时间：2013-04-15T15:54:34.387
> 
> 标签：c#, asp.net, sql-server-2000

我公司使用 sql server 2000 存储数据。有一个表，其中有一列名为 'Vattu' 。问题是：此列声明为 varchar 数据类型，但它同时保存了 unicode 和 anscii 值！

因此，每次我在 web 上显示此列数据时，它都会显示不可读的字符。有没有办法使用 c# 将数据转换为 unicode 值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T16:00:01.473

一个快速的谷歌搜索会给你答案。无论如何，您使用 System.Text.Encoding 将 ascii 编码为 un​​icode。检查[Encoding.Convert 方法中的示例代码](http://msdn.microsoft.com/en-GB/library/system.text.encoding.convert%28v=vs.71%29.aspx)

从长远来看，将列数据类型转换为 NVarchar 也会更好。这样做可以节省由于 c# 级别的转换而将使用的 CPU 处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T16:34:16.763

您需要将列的数据类型更改为`nvarchar`以存储 Unicode 数据。

您已经尝试存储在列中的 Unicode 数据已经消失了 - 您无法神奇地取回它，除非您的应用程序记录了数据或者您正在运行所有命令的跟踪并且仍然可以访问这些数据。

# python - 从多个 URL 中抓取链接

> ID：16019573
> 
> 赞同：0
> 
> 时间：2013-04-15T15:54:40.987
> 
> 标签：python, url, scraperwiki

我正在使用 ScraperWiki 从 london-gazette.co.uk 站点中提取链接。我将如何编辑代码，以便可以在底部粘贴多个单独的搜索 URL，这些 URL 都被整理到同一个数据存储中？

目前我可以粘贴新的 URL，点击运行，新数据会添加到旧数据的后面，但我想知道是否有一种方法可以加快速度并让刮板在几个网址一次？我将更改 URL 的“通知代码”部分：`issues/2013-01-15;2013-01-15/all=NoticeCode%3a2441/start=1`

抱歉 - Stack Overflow 的新手，我的编码知识几乎不存在，但代码在这里：[https ://scraperwiki.com/scrapers/links_1/edit/](https://scraperwiki.com/scrapers/links_1/edit/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T11:45:32.200

您链接到的刮板似乎是空的，但我查看了 Rebecca Ratcliffe 的原始刮板。如果您的相同，您只需将您的 URL 放入一个列表并使用 for 循环遍历它们：

```
urls = ['/issues/2013-01-15;2013-01-15/all=NoticeCode%3a2441/start=1', 
'/issues /2013-01-15;2013-01-15/all=NoticeCode%3a2453/start=1',
'/issues/2013-01-15;2013-01-15/all=NoticeCode%3a2462/start=1', 
'/issues/2012-02-10;2013-02-20/all=NoticeCode%3a2441/start=1']

base_url = 'http://www.london-gazette.co.uk'
for u in urls:
    starting_url = urlparse.urljoin(base_url, u)
    scrape_and_look_for_next_link(starting_url) 
```

看看我复制并相应调整的[这个刮板](https://scraperwiki.com/scrapers/aoa6_2/)。

# css - svg 不在 ie9 中使用 css 调整大小

> ID：16019574
> 
> 赞同：4
> 
> 时间：2013-04-15T15:54:41.350
> 
> 标签：css, html, internet-explorer, svg

好的，这里是：

这是我的网页：http: [//ingenious.jit.su/themes](http://ingenious.jit.su/themes)

如果您在 Firefox 中查看它，您会注意到六个白色面板中每个面板的右上角都有一个红色小图标 (svg)。如果您查看该图像，您会注意到它的原始大小是 640 x 480。它很小，因为有一个 css 规则会更改引用 svg 的 img 标签的大小。

这是错误：IE9 没有根据 css 规则调整图标的大小。它只是剪掉它的左上角。如果您使用 IE9 开发人员工具调整 css 规则，您就会明白我的意思。

我挖掘了很多并确认我一直在遵循大多数 svg 最佳实践，比如包括不只是 100% 的宽度和高度值，包括视口等等，但没有运气。IE9 仍然通过裁剪而不是缩放来响应 css 规则。

任何帮助都会摇滚！

**更新**已修复！我很笨，我的视口不见了。凌晨 3 点不再编码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T16:02:46.670

你链接了svg吗？例子

`<svg xmlns="http://www.w3.org/2000/svg" version="1.1"> enter svg here </svg>`

我在使用 ie9 时遇到了很多 svg 问题：）

如果这有帮助，我在查看页面时收到此错误

SCRIPT438：对象不支持属性或方法“addEventListener”
followbar.js，第 3 行字符 3

这是我在评论中谈论的两个点的一个更好的例子

`<img class="theme-icon" id="/recruitment-and-retention" src="../images/recruitment-and-retention.svg"/>`

# sql - 重命名作为保留字的列

> ID：16019576
> 
> 赞同：-1
> 
> 时间：2013-04-15T15:54:42.863
> 
> 标签：sql, oracle, rename, reserved-words

我在 Oracle 中有一个名为 CONTACT_DATA 的表，它有一个名为 NUMBER 的列。我想将此字段重命名为 PHONE_NUMBER 但是，以下内容不起作用，因为 NUMBER 是 Oracle 中的保留字：

```
ALTER TABLE CONTACT_DATA RENAME COLUMN NUMBER TO PHONE_NUMBER; 
```

我查看了这些论坛，发现了如何按保留字列进行选择和排序。但是，在这种情况下，我更愿意重命名该列。此外，我想保留现有数据，因此删除表并重新创建它不是一种选择。我正在使用 Oracle 版本 11.2 有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T16:00:26.177

你有没有尝试过：

```
ALTER TABLE CONTACT_DATA RENAME COLUMN "NUMBER" TO PHONE_NUMBER; 
```

为此，Oracle 使用双引号作为转义字符。

# c - 关于使用 ac 程序将 csv 文件转换为特定格式

> ID：16019581
> 
> 赞同：0
> 
> 时间：2013-04-15T15:55:04.710
> 
> 标签：c, libsvm

我正在尝试使用 libsvm 网站上提供的 convert.c 将 csv 文件转换为 libsvm 数据格式。但是我从不使用 C 并且该网站没有提供有关如何使用该程序的任何信息。我可以从这里得到任何提示吗？以下是代码。非常感谢。

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

char buf[10000000];
float feature[100000];

int main(int argc, char **argv)
 {
FILE *fp;

if(argc!=2) { fprintf(stderr,"Usage %s filename\n",argv[0]); }
if((fp=fopen(argv[1],"r"))==NULL)
{
    fprintf(stderr,"Can't open input file %s\n",argv[1]);
}
while(fscanf(fp,"%[^\n]\n",buf)==1)
{
    int i=0,j;
    char *p=strtok(buf,",");

    feature[i++]=atof(p);

    while((p=strtok(NULL,",")))
        feature[i++]=atof(p);

    //      --i;
    /*
    if ((int) feature[i]==1)
        printf("-1 ");
    else
        printf("+1 ");
    */
    //      printf("%f ", feature[1]);
    printf("%d ", (int) feature[0]);
    for(j=1;j<i;j++)
        printf(" %d:%f",j,feature[j]);
    printf("\n");
}
return 0;
  } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T15:57:54.790

您可以在此处找到有关如何使用它的信息：

```
if(argc!=2) { fprintf(stderr,"Usage %s filename\n",argv[0]); }
if((fp=fopen(argv[1],"r"))==NULL)
{
   fprintf(stderr,"Can't open input file %s\n",argv[1]);
} 
```

因此，您需要提供 2 个参数，一个是`program name`，即`argv[0]`，`argv[1]`是您的输入文件名。

我想你应该这样做：（首先，将代码编译成一个 exe 文件）然后从命令行，进入 exe 文件目录，输入：

```
programname filename 
```

为了使用他们的代码。While`programname`是转换程序的名称。

我的猜测是该代码将读取您的 csv 文件并提取可用于 SVM 分类的数据集的所有特征。

# java - 不支持的 major.minor 版本 51.0（无法加载类 org.postgresql.Driver）

> ID：16019586
> 
> 赞同：23
> 
> 时间：2013-04-15T15:55:22.773
> 
> 标签：java, heroku

使用 maven 创建了一个 Web 应用程序并将其部署在 heroku 上。一切正常，但是当我调用使用 postgresql-9.2-1002.jdbc4 驱动程序的操作时，我得到：

```
java.lang.UnsupportedClassVersionError: org/postgresql/Driver : Unsupported major.minor version 51.0 (unable to load class org.postgresql.Driver) 
```

我知道问题是我在我的开发环境中使用 jdk 7 并且较低版本在 heroku 上运行（至少我是这样认为的）。我的第一个问题是，为什么其他操作不会给出这个错误，只有使用 postqresql 驱动程序的操作会给出这个问题，而应用程序的其余部分工作得很好？我做的另一件事是下载 jdk 6，然后将其添加到我的项目构建路径中，然后将 eclipse 编译器合规性配置为 1.6，但即便如此我也遇到了同样的问题。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-12-18T12:41:58.780

对于 java 6 使用：

```
postgresql-9.2-1004-jdbc4.jar 
postgresql-9.3-1100-jdbc4.jar 
```

对于 java 7 使用：

```
postgresql-9.2-1004-jdbc41.jar 
postgresql-9.3-1100-jdbc41.jar 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-04-15T16:01:41.697

解决方案是使用为 JDK 6 编译的数据库驱动程序的副本。

似乎您的应用程序代码没有遇到问题，因为您的构建更改有效。（特别是对合规级别的更改。我认为将 JDK 添加到（常规）构建路径不会有任何区别。）

但是，当然，这对数据库驱动程序没有任何影响......因为您没有编译它。

* * *

但是，根据[下载页面](http://jdbc.postgresql.org/download.html)，postgresql-9.2-1002.jdbc4 应该与 Java 6 和 7 兼容。所以也许你已经从其他地方获得了 JAR ......或者通过使用 Java 从源代码编译7 目标。

**更新**- 我可以确认下载站点上的 JAR 有一个驱动程序类，其字节码版本是 50.0 而不是 51.0。我建议您从那里下载并使用新副本。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-04-30T12:42:01.987

如果您使用的是 maven，则中央存储库上的[9.2-1002-jdbc4 版本](http://repo1.maven.org/maven2/org/postgresql/postgresql/9.2-1002-jdbc4/)已使用 1.7 目标编译。使用以前的版本，直到它被修复。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-10-03T12:05:55.213

似乎已经使用最新的构建 ID 1003 解决了这个问题：

```
<dependency>
    <groupId>org.postgresql</groupId>
    <artifactId>postgresql</artifactId>
    <version>9.2-1003-jdbc4</version>
</dependency> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-07-23T09:56:28.013

最好的方法是安装你的应用程序编译的更高版本的java，并假设如果我有使用Jre 1.6编译的应用程序，那么我需要1.6或更高版本的Jre 1.6，你有一件事是

或者

只需编译您的 Class 文件，我的意思是您的 application.java 文件，默认 Jre 您可以使用 java 和 Just Run 在同一文件上运行。

或第三个选项。

下载该 JRE 并将该 JRE 版本安装在您的计算机中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-02-20T12:20:02.223

我遇到了这个问题，也遇到了加载 JDBC 驱动程序的 ClassNotFoundException 问题。解决方案是从[http://jdbc.postgresql.org/download.html#jdbcselection](http://jdbc.postgresql.org/download.html#jdbcselection)获取正确版本的 postgres jar 。如果您使用的是 Maven，请相应地添加依赖项的版本。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-08-15T18:22:08.340

将与 Java 6 不兼容的 Postgres 驱动程序换成对 Java 7 友好的替代版本（如大多数其他答案所推荐的）的替代方法是让 Heroku 使用 Java 7 编译和运行您的应用程序。如您所说，如果您使用 JDK 7 进行开发，这可能有助于避免其他不兼容问题。

为此，请按照Heroku Devcenter 上的[这些说明进行操作。](https://devcenter.heroku.com/articles/add-java-version-to-an-existing-maven-app "Heroku Devcenter - 更新现有 Java 应用程序以使用 Java 7")这是一个摘要：

1.  `system.properties`在您的应用程序的基本目录中创建一个名为的文件。
2.  将属性添加`java.runtime.version=1.7`到文件中，即：

    ```
    java.runtime.version=1.7 
    ```

3.  提交`system.properties`文件并推送到 Heroku。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-10-07T01:29:53.303

有同样的问题

在这个页面上 - [http://jdbc.postgresql.org/download.html](http://jdbc.postgresql.org/download.html)

部分 - 当前版本

有关 jvm 版本和 postgres jdbc 驱动程序的详细信息帮助我弄清楚了。

# linq - LINQ to Entities 无法识别方法“System.String get_Item(System.String)”方法

> ID：16019592
> 
> 赞同：11
> 
> 时间：2013-04-15T15:55:39.120
> 
> 标签：linq, iqueryable, entities

我已经查看了这里的各种解决方案，但似乎没有一个对我有用，可能是因为我对这一切都太陌生了，并且在黑暗中摸索了一下。在下面的代码中，对象“约会”包含一些基本的 LDAP 信息。从此类对象的列表中，我希望能够根据员工 ID 获得一条记录。我希望这里的代码足以说明。FTR，我尝试了各种公式，包括尝试使用 from 和 select。所有失败，并出现上面标题中给出的错误。

```
IQueryable<appointment> query = null;

foreach(var record in results)
{
    BoiseStateLdapDataObject record1 = record;
    query = db.appointments.Where(x => x.student_id == record1.Values["employeeid"]);
}

if (query != null)
{
    var selectedRecord = query.SingleOrDefault();
} 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-04-15T15:58:50.313

尝试将员工 ID 移出查询：

```
IQueryable<appointment> query = null;

foreach(var record in results)
{
    var employeeId = record.Values["employeeid"];
    query = db.appointments.Where(x => x.student_id == employeeId);
}

if (query != null)
{
    var selectedRecord = query.SingleOrDefault();
} 
```

# c++ - 没有默认构造函数会导致没有移动构造函数吗？

> ID：16019601
> 
> 赞同：5
> 
> 时间：2013-04-15T15:56:10.937
> 
> 标签：c++, c++11, move-semantics

如果一个类没有默认构造函数，因为它应该始终初始化它的内部变量，那么它不应该有移动构造函数吗？

```
class Example final {
public:
  explicit Example(const std::string& string) : string_(
    string.empty() ? throw std::invalid_argument("string is empty") : string) {}
  Example(const Example& other) : string_(other.string_) {}
private:
  Example() = delete;
  Example(Example&& other) = delete;
  Example& operator=(const Example& rhs) = delete;
  Example& operator=(Example&& rhs) = delete;
  const std::string string_;
}; 
```

此类始终期望内部字符串由非空字符串设置，并且内部字符串在`Example`对象之间复制。我是否正确，移动构造函数在此处不适用，因为如果移动示例，则必须通过`std::move`调用将字符串留空？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-15T16:05:59.293

> 如果一个类没有默认构造函数，因为它应该始终初始化它的内部变量，那么它不应该有移动构造函数吗？

**不，我不会这么说**。

从一个`Example`对象移动并留下一个空字符串的事实在这里应该不是问题，因为通常客户端不应该对移动对象的状态做出任何假设，除了它是合法的事实。

这意味着，客户端只能调用对其`Example`输入状态没有先决条件的函数。请注意，通常的*几乎所有*成员函数`Example`都会对对象的状态有先决条件（即`string_`必须是非空字符串），但并非*全部*都是。

例如，`Example`不应该介意的析构函数是否`string_`为空 - 为什么即使在这种情况下也不允许它完成它的工作？赋值运算符是另一个常见的例子——为什么不允许给`string_`? 赋值一个新的字符串。

在这种观点下，留下一个`Example`空字符串的对象是可以的，因为客户可以对一个移动的对象做的所有事情基本上要么重新分配它，要么销毁它——对于这些用例，是否`string_`为空并不重要.

因此，**拥有一个移动构造函数和一个移动赋值运算符确实是有意义的**。

# jmeter - 多个线程组相互影响

> ID：16019606
> 
> 赞同：0
> 
> 时间：2013-04-15T15:56:24.227
> 
> 标签：jmeter

我创建了一个包含多个要同时执行的线程组的测试计划。

一组 (A) 涉及标记一个包含 1000 张图像的文件夹，因此需要大约 10 秒来响应。另一组（B）真的很快。

我发现 B 组似乎“坚持”并等待线程 A 完成。现在我所做的所有阅读都说线程组应该是完全独立的，但在我的测试计划中似乎并非如此。

我有一个在组之间共享的 HTTP 默认管理器、cookie 管理器和用户定义的变量（但已尝试将它们添加到单独的线程组中）。

有人知道为什么会这样吗？

脚本在这里： [https](https://www.dropbox.com/sh/fhdof4ynjt73s2p/mkrphWcfHK) ://www.dropbox.com/sh/fhdof4ynjt73s2p/mkrphWcfHK （可能不会运行或坚持，因为它使用内部 URL）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T20:07:37.283

这个问题不在 JMeter 中，而是锁定的应用程序。

查看您的测试，您似乎使用一个用户进行负载测试，这清楚地解释了您的问题并使您的测试不切实际，因为您有大约 20 个用户使用相同的用户/密码登录。

# javascript - 用于生成声音的缓冲音频

> ID：16019609
> 
> 赞同：0
> 
> 时间：2013-04-15T15:56:31.253
> 
> 标签：javascript, html5-audio, web-audio-api

我有一个振荡器来生成键盘的频率。当我输出到扬声器时，一切正常，但除了输出到扬声器之外，我还想缓冲它，以便我可以将其转换为 base 64 并稍后再次使用。我见过的唯一示例使用 xhr，我不需要它，因为显然我希望能够将一个节点添加到模块化路由中以获取输入，将其存储在数组中，然后输出到硬件。

像这样的东西：

```
var osc = ctx.createOscillator();
osc.type = 3;
osc.frequency.value = freq;
osc.connect(buffer);
buffer.connect(ctx.destination); 
```

这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T03:44:58.087

你检查过 RecorderJs 吗？ [https://github.com/mattdiamond/Recorderjs](https://github.com/mattdiamond/Recorderjs)。我认为它可以满足您的需求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T17:41:44.017

您是否考虑过使用 ScriptProcessorNode？

请参阅：[http ://www.w3.org/TR/webaudio/#ScriptProcessorNode](http://www.w3.org/TR/webaudio/#ScriptProcessorNode)

您可以将 eventListener 附加到此节点，允许您在音频样本通过时捕获它们。然后，您可以保存这些缓冲区并根据需要操作它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T18:01:35.997

我已经通过使用 Matt 的 Recorder.js [https://github.com/mattdiamond/Recorderjs](https://github.com/mattdiamond/Recorderjs)解决了我的问题，并将其连接到作为从多个振荡器到 ctx.destination 的中介的 GainNode。我将使用 localStorage，但这里是一个使用数组的示例（这不包括振荡器设置）。

```
var recorder;
recorder = new Recorder(gainNode, { workerPath: "../recorderWorker.js"});
recorder.record();

var recordedSound = [];
function recordSound()  {
    recorder.exportWAV(function(blob) {
        recordedSound.push(blob);
    });
}

function play(i)  {
    var audio = new Audio(window.URL.createObjectURL(recordedSound[i]));
    audio.play();
} 
```

# sql - 比较 SQL 列中的两个日期

> ID：16019610
> 
> 赞同：1
> 
> 时间：2013-04-15T15:56:33.993
> 
> 标签：sql, sql-server-2005

我在让它工作时遇到了一些问题。我有一张表，里面有这些数据。

```
|     DateStarted       |     Field9     |     Field2     |      ID      |    Field6   |
----------------------------------------------------------------------------------------
|  2013-04-15 09:23:00  |      TEST1     |      TEST2     |      1       |     2000    |
|  2013-04-08 09:23:00  |      TEST1     |      TEST2     |      2       |      180    |
|  2013-04-15 09:23:00  |      TEST2     |      TEST3     |      3       |     1000    |
|  2013-04-04 09:23:00  |      TEST2     |      TEST3     |      7       |       80    |
|  2013-04-03 09:23:00  |      TEST2     |      TEST4     |      5       |       70    | 
```

我的最终目标是返回 Field9 值的最后两个日期，以便我可以为 Field9 的每个唯一实例减去 Field6 的值。下面是一个返回的例子。

```
|     DateStarted       |     Field1     |     Field2     |      ID      |    SUB      |
----------------------------------------------------------------------------------------
|  2013-04-15 09:23:00  |      TEST1     |      TEST2     |      1       |     1820    |
|  2013-04-15 09:23:00  |      TEST2     |      TEST3     |      3       |      920    | 
```

因此，对于第二行，它取两个最大的日期，然后取 field6 的值并减去它们，只返回一行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T15:58:30.163

`Field1`您可以使用分区窗口函数获取每个唯一值的最新行。

```
;WITH x AS
(
  SELECT DateStarted, Field9, Field2, ID, Field6,
   rn = ROW_NUMBER() OVER (PARTITION BY Field9 ORDER BY DateStarted DESC)
  FROM dbo.your_table_name
),
y AS 
(
  SELECT x.*, [SUB] = x.Field6 - COALESCE(y.Field6, 0)
  FROM x LEFT OUTER JOIN x AS y
  ON x.Field9 = y.Field9
  AND x.rn = 1 AND y.rn = 2
)
SELECT DateStarted, Field1 = Field9, Field2, ID, [SUB]
  FROM y
  WHERE rn = 1
  ORDER BY Field1; 
```

[SQL小提琴演示](http://sqlfiddle.com/#!3/f219b/5)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T16:06:04.383

获得差异的一种方法是识别两行，然后将它们聚合在一起：

```
select MAX(case when seqnum = 1 then DateStarted end), Field1,
       max(case when seqnum = 1 then Field2 end) as Field2
       MAX(case when seqnum = 1 then id end) as Id,
       MAX(case when seqnum = 1 then field3 end) - MAX(case when seqnum = 2 then field 3 end) as sub
from (SELECT DateStarted, Field1, Field2, ID, Field3,
             ROW_NUMBER() OVER (PARTITION BY Field1 ORDER BY DateStarted DESC) as seqnum
      FROM t
     ) t
group by Field1 
```

这使用条件聚合来获得差异。

# connection - org.apache.http.conn.ConnectionPoolTimeoutException：等待池连接超时

> ID：16019612
> 
> 赞同：3
> 
> 时间：2013-04-15T15:56:39.977
> 
> 标签：connection, timeout, threadpool

我在java中使用多线程同时扫描不同的URL。如果请求时间总和超过 100,000，则存在错误。我已经关闭了我应该关闭的。这是我的 servlet 中的代码

```
private String proyGetHttp(String url) throws ParseException, IOException,
            InterruptedException {

        String content = "";
        getMethod = new HttpGet(url);
        HttpResponse response = null;
        HttpEntity httpEntity = null;
        boolean success = false;
        while (!success) {
            System.out.println("url：" + url + "，connect...");
            try {
                response = client.execute(getMethod);
                httpEntity = response.getEntity();
                StringBuffer sb = new StringBuffer();
                if (httpEntity != null) {
                    BufferedReader in = null;
                    InputStream instream = httpEntity.getContent();
                    try {
                        in = new BufferedReader(new InputStreamReader(instream));
                        String lineContent = "";
                        while(lineContent != null){
                            sb.append(lineContent);
                            lineContent = in.readLine();
                        }

                    } catch (Exception ex)
                        getMethod.abort();
                        throw ex;
                    } finally {
                        // Closing the input stream will trigger connection release
                        try { instream.close(); in.close();} catch (Exception ignore) {}
                    }
                }
                content = sb.toString();
                success = true;
                System.out.println("connect successfully...");
            } catch (Exception e) {
                e.printStackTrace();
                getMethod.abort();
                System.out.println("connect fail, please waitting...");
                Thread.sleep(sleepTime);
            }finally{
                getMethod.releaseConnection();
            }
        }
        return content;
    } 
```

这里的代码创建默认客户端

```
 PoolingClientConnectionManager cm = new PoolingClientConnectionManager();
        cm.setMaxTotal(100);
        DefaultHttpClient client = null;
        client = new DefaultHttpClient(cm);
        client.getParams().setParameter("http.protocol.cookie-policy", CookiePolicy.BROWSER_COMPATIBILITY);
        client.getParams().setParameter(HttpConnectionParams.CONNECTION_TIMEOUT, 5000); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2014-04-02T20:21:27.147

我有同样的问题，我找到了解决方法。此超时是由于连接泄漏。就我而言，我使用的是 httpDelete 方法而不是使用响应。相反，我正在检查响应的状态。

解决方法是，需要使用响应实体。为了确保系统资源的正确释放，必须关闭与实体关联的内容流。

所以我使用`EntityUtils.consumeQuietly(response.getEntity());`了它来确保实体内容被完全消耗并且内容流（如果存在）被关闭。

# python - 读取基于 Web 的 XML 文件并在 Python 中解析它

> ID：16019620
> 
> 赞同：0
> 
> 时间：2013-04-15T15:57:10.347
> 
> 标签：python, google-app-engine, xml-parsing

我对 Python 和 GAE 非常陌生，但我正在尝试从 eventful.com api（以 XML 格式）下载 XML 文件，对其进行解析，然后我会将这些信息存储在 Google Cloud SQL 上的数据库中。

到目前为止，我的代码如下，我在查看了各种在线教程后设法编写了这些代码，但是我不断收到很多错误，并且代码对我根本不起作用。如果有人对我哪里出错有任何指示，请告诉我，凯伦。

我尝试调用多事的 xml 文件并对其进行解析：

```
import webapp2
from google.appengine.ext.webapp import template
import os
import datetime
from google.appengine.ext import db
from google.appengine.api import urlfetch
import urllib #import python library which does http requests
from xml.dom import parseString #imports xml parser called minidom

class XMLParser(webapp2.RequestHandler):
    def get(self):
        base_url = fetch('http://api.eventful.com/rest/events/search?app_key=zGtDX6cwQ=dublin&?q=music')
        #downloads data from xml file
        response = urllib.urlopen(base_url)
        #converts data to string:
        data = response.read()
        #closes file
        response.close()
        #parses xml downloaded
        dom = parseString(data)
        #retrieves the first xml tag that the parser finds with name tag
        xmlTag = dom.getElementsByTagName('title')[0].toxml()
        #strip off the tag to just reveal event name
        xmlData = xmlTag.replace('<title>', '').replace('</title>', '')
        #print out the xml tag and data in this format:
        print xmlTag
        #just print the data
        print xmlData 
```

当我尝试运行此代码时收到以下错误，但是在 Google App Engine 用户 GAE 启动器中 -

```
2013-04-15 16:52:05 Running command: "['C:\\Python27\\python.exe', 'C:\\Program Files     (x86)\\Google\\google_appengine\\dev_appserver.py', '--skip_sdk_update_check=yes', '--port=8080', '--admin_port=8002', u'C:\\Users\\Karen\\Desktop\\Development\\own_tada']"
INFO     2013-04-15 16:52:17,944 devappserver2.py:498] Skipping SDK update check.
WARNING  2013-04-15 16:52:18,005 api_server.py:328] Could not initialize images API;     you are likely missing the Python "PIL" module.
INFO     2013-04-15 16:52:18,065 api_server.py:152] Starting API server at:      http://localhost:54619
INFO     2013-04-15 16:52:18,085 dispatcher.py:150] Starting server "default" running     at: http://localhost:8080
INFO     2013-04-15 16:52:18,095 admin_server.py:117] Starting admin server at: http://localhost:8002
ERROR    2013-04-15 15:52:35,767 wsgi.py:219] 
Traceback (most recent call last):
  File "C:\Program Files (x86)\Google\google_appengine\google\appengine\runtime\wsgi.py", line 196, in Handle
    handler = _config_handle.add_wsgi_middleware(self._LoadHandler())
  File "C:\Program Files (x86)\Google\google_appengine\google\appengine\runtime\wsgi.py", line 255, in _LoadHandler
    handler = __import__(path[0])
  File "C:\Users\Karen\Desktop\Development\own_tada\own.py", line 8, in <module>
    from xml.dom import parseString #imports xml parser called minidom
ImportError: cannot import name parseString
INFO     2013-04-15 16:52:35,822 server.py:561] default: "GET / HTTP/1.1" 500 -
ERROR    2013-04-15 15:52:37,586 wsgi.py:219] 
Traceback (most recent call last):
  File "C:\Program Files (x86)\Google\google_appengine\google\appengine\runtime\wsgi.py", line 196, in Handle
    handler = _config_handle.add_wsgi_middleware(self._LoadHandler())
  File "C:\Program Files (x86)\Google\google_appengine\google\appengine\runtime\wsgi.py", line 255, in _LoadHandler
    handler = __import__(path[0])
  File "C:\Users\Karen\Desktop\Development\own_tada\own.py", line 8, in <module>
    from xml.dom import parseString #imports xml parser called minidom
 ImportError: cannot import name parseString
INFO     2013-04-15 16:52:37,617 server.py:561] default: "GET /favicon.ico HTTP/1.1" 500 - 
```

我用于上述代码的一个此类教程来自以下 URL：[http ://www.travisglines.com/web-coding/python-xml-parser-tutorial](http://www.travisglines.com/web-coding/python-xml-parser-tutorial)

编辑：

感谢下面 Josh 提供的帮助，当我使用我的代码启动我的代码时，我现在没有收到任何错误，但是我只看到一个空白屏幕并希望它打印出解析的信息（或到目前为止的进度）。我知道这似乎是一个非常愚蠢的问题，但我真的是一个初学者，所以我很抱歉！固定代码（减去错误）是：

```
import webapp2
from google.appengine.ext.webapp import template
import os
import datetime
from google.appengine.ext import db
from google.appengine.api import urlfetch
import urllib #import python library which does http requests
import xml.dom.minidom as mdom #imports xml parser called minidom

class XMLParser(webapp2.RequestHandler):
    def get(self):
    base_url = 'http://api.eventful.com/rest/events/search?app_key=zGtDX6cwQjCRdkf6&l=dublin&?q=music'
    #downloads data from xml file
    response = urllib.urlopen(base_url)
    #converts data to string:
    data = response.read()
    #closes file
    response.close()
    #parses xml downloaded
    dom = mdom.parseString(data)
    #retrieves the first xml tag that the parser finds with name tag
    xmlTag = dom.getElementsByTagName('title')[0].toxml()
    #strip off the tag to just reveal event name
    xmlData = xmlTag.replace('<title>', '').replace('</title>', '')
    #print out the xml tag and data in this format:
    print xmlTag
    #just print the data
    print xmlData

app = webapp2.WSGIApplication([('/', XMLParser), 
                          ],
                          debug=True) 
```

任何关于下一步做什么的指导将不胜感激，或者任何你能发现的我的 python 代码有问题，谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T12:41:56.470

Appengine 支持[lxml ，](http://lxml.de/parsing.html)[包含](https://developers.google.com/appengine/docs/python/python25/diff27#Supported_Third-Party_Libraries)它并用它解析您的文档非常简单。

在您的 app.yaml 文件中

```
libraries:
    - name: lxml
    - version: latest 
```

然后`import lxml`按照[解析](http://lxml.de/parsing.html)说明进行操作

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T16:15:06.620

这应该可以解决您的导入问题

```
import xml.dom.minidom as mdom 
```

并解析原始数据：

```
dom = mdom.parseString(data) 
```

至于数据操作，您将要查看从 parseString 返回的子节点和数据元素。

如：

```
for element in dom.getElementsByTagName('title')[0].childnodes:
    print element.data 
```

解析结构后查看结构。

# javascript - 使用 javascript/jquery 用 html 填充 div

> ID：16019621
> 
> 赞同：20
> 
> 时间：2013-04-15T15:57:18.557
> 
> 标签：javascript, jquery, html

这是我的问题：

我有一个 div：

```
<div id="legend"></div> 
```

我想在某些条件下用其他代码填充它：

```
<p>Showing results....
    Key:
    <img src="/....">&lt;=1
    &nbsp;<img src="/...">&lt;=2
    &nbsp;<img src="/...">&lt;=3
    &nbsp;<img src="/...">&lt;=4
    &nbsp;<img src="/...">&lt;=5

<p> 
```

如您所见，这是一个图例，我认为主要问题是我有双引号，使用例如此处的解决方案无法轻松包含双引号： [Fill div with text](https://stackoverflow.com/questions/10756448/fill-div-with-text)

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-04-15T16:02:14.620

据我了解，您正在尝试执行以下操作：

```
$("#legend").text("Your HTML here"); 
```

要插入 HTML，您应该使用，但是像这样使用[Vanilla JS](http://vanilla-js.com/)`.html()`会更有效率：

```
document.getElementById('legend').innerHTML = "Your HTML here"; 
```

现在，您还提到双引号存在问题。好吧，有两种可能的解决方案。

1：在字符串周围使用单引号：`'<img src="/..." />'`
2：转义引号：`"<img src=\"/...\" />"`

还有一件事：如果这些换行符实际上在要插入的 HTML 中，那么 JavaScript 中就不能有多行字符串。您在这里也有两个选择：

1：转义换行符：

```
"<p>\
    Hello, world!\
</p>" 
```

2：连接：

```
"<p>\n"
    +"Hello, world!\n"
+"</p>" 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-15T15:58:42.343

根据您的条件（我们不知道）将您的 html 代码组装在一个变量中，然后用于[`html()`](http://api.jquery.com/html/)将其设置为元素。

```
var yourHtml = "your html";
$("#legend").html("yourHtml"); 
```

至于处理引号，您可以在变量中使用单引号，例如：

```
var yourHtml = '<img src="/yourimgr.png">'; 
```

或者您可以转义双引号：

```
var yourHtml = "<img src=\"/yourimgr.png\">"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T16:03:52.147

1.  将您的段落 html 存储在某个字符串中 `var str= <p>write your complete code here</p>`
2.  `$('#legend').html(yourconditionSatisfies?str:'')`

# python - 如何根据字符串索引对 Python 中的列表列表进行聚类？需要洞察力

> ID：16019624
> 
> 赞同：-1
> 
> 时间：2013-04-15T15:57:30.683
> 
> 标签：python, regex, string, list, python-2.7

我有一个以这种方式列出的列表。

```
[['Introduction', '0 11 0 1 0'],
['Floating', '0 11 33 1 0'],
['point', '0 11 33 1 1'],
['numbers', '0 11 33 1 2'],
['IEEE', '0 11 58 1 0'],
['Standard', '0 11 58 1 1'], 
['754', '0 11 58 1 2']] 
```

我想根据其字符串索引对列表中的单词进行聚类/分组。分组基于字符串索引的前 3 个数字。解决这个问题的最佳方法是什么。我正在考虑使用正则表达式。这个分组有直接简单的方法吗？

**预期输出：**

```
Introduction 0 11 0
Floating point numbers 0 11 33
IEEE Standard 754  0 11 58 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-15T16:13:58.573

也许使用`itertools.groupby`？

```
from itertools import groupby
def key(item):
    return [int(x) for x in item[1].split()[:3]]

master_lst = [['Introduction', '0 11 0 1 0'],
              ['Floating', '0 11 33 1 0'],
              ['point', '0 11 33 1 1'],
              ['numbers', '0 11 33 1 2'],
              ['IEEE', '0 11 58 1 0'],
              ['Standard', '0 11 58 1 1'], 
              ['754', '0 11 58 1 2']]

for k,v in groupby(master_lst,key=key):
    print ' '.join(x[0] for x in v) +' ' + ' '.join(str(x) for x in k) 
```

结果是：

```
Introduction 0 11 0
Floating point numbers 0 11 33
IEEE Standard 754 0 11 58 
```

# .htaccess - 如何通过'RewriteCond'简化.htaccess Rewriterule？

> ID：16019625
> 
> 赞同：0
> 
> 时间：2013-04-15T15:57:32.183
> 
> 标签：.htaccess, mod-rewrite

我的 .htaccess 看起来像这样：

```
 #01
RewriteRule ^([a-z]+)/yule/*$ index.php?city=$1&category=2

RewriteRule ^([a-z]+)/yule/today/*$ index.php?city=$1&category=2&today=true
RewriteRule ^([a-z]+)/yule/today/(price|rebate|bought)_(desc|asc)/ index.php?city=$1&category=2&today=true&order=$2&ordertype=$3
RewriteRule ^([a-z]+)/yule/(price|rebate|bought)_(desc|asc)/ index.php?city=$1&category=2&order=$2&ordertype=$3

RewriteRule ^([a-z]+)/yule_([0-9]+)-([0-9]+)?/*$ index.php?city=$1&category=2&price_sta=$2&price_end=$3
RewriteRule ^([a-z]+)/yule_([0-9]+)-([0-9]+)?/today/*$ index.php?city=$1&category=2&price_sta=$2&price_end=$3&today=true
RewriteRule ^([a-z]+)/yule_([0-9]+)-([0-9]+)?/today/(price|rebate|bought)_(desc|asc)/ index.php?city=$1&category=2&price_sta=$2&price_end=$3&today=true&order=$4&ordertype=$5
RewriteRule ^([a-z]+)/yule_([0-9]+)-([0-9]+)?/(price|rebate|bought)_(desc|asc)/ index.php?city=$1&category=2&price_sta=$2&price_end=$3&order=$4&ordertype=$5

#02
RewriteRule ^([a-z]+)/travel/*$ index.php?city=$1&category=3

RewriteRule ^([a-z]+)/travel/today/*$ index.php?city=$1&category=3&today=true
RewriteRule ^([a-z]+)/travel/today/(price|rebate|bought)_(desc|asc)/ index.php?city=$1&category=3&today=true&order=$2&ordertype=$3
RewriteRule ^([a-z]+)/travel/(price|rebate|bought)_(desc|asc)/ index.php?city=$1&category=3&order=$2&ordertype=$3

RewriteRule ^([a-z]+)/travel_([0-9]+)-([0-9]+)?/*$ index.php?city=$1&category=3&price_sta=$2&price_end=$3
RewriteRule ^([a-z]+)/travel_([0-9]+)-([0-9]+)?/today/*$ index.php?city=$1&category=3&price_sta=$2&price_end=$3&today=true
RewriteRule ^([a-z]+)/travel_([0-9]+)-([0-9]+)?/today/(price|rebate|bought)_(desc|asc)/ index.php?city=$1&category=3&price_sta=$2&price_end=$3&today=true&order=$4&ordertype=$5
RewriteRule ^([a-z]+)/travel_([0-9]+)-([0-9]+)?/(price|rebate|bought)_(desc|asc)/ index.php?city=$1&category=3&price_sta=$2&price_end=$3&order=$4&ordertype=$5

#03
RewriteRule ^([a-z]+)/service/*$ index.php?city=$1&category=4

RewriteRule ^([a-z]+)/service/today/*$ index.php?city=$1&category=4&today=true
RewriteRule ^([a-z]+)/service/today/(price|rebate|bought)_(desc|asc)/ index.php?city=$1&category=4&today=true&order=$2&ordertype=$3
RewriteRule ^([a-z]+)/service/(price|rebate|bought)_(desc|asc)/ index.php?city=$1&category=4&order=$2&ordertype=$3

RewriteRule ^([a-z]+)/service_([0-9]+)-([0-9]+)?/*$ index.php?city=$1&category=4&price_sta=$2&price_end=$3
RewriteRule ^([a-z]+)/service_([0-9]+)-([0-9]+)?/today/*$ index.php?city=$1&category=4&price_sta=$2&price_end=$3&today=true
RewriteRule ^([a-z]+)/service_([0-9]+)-([0-9]+)?/today/(price|rebate|bought)_(desc|asc)/ index.php?city=$1&category=4&price_sta=$2&price_end=$3&today=true&order=$4&ordertype=$5
RewriteRule ^([a-z]+)/service_([0-9]+)-([0-9]+)?/(price|rebate|bought)_(desc|asc)/ index.php?city=$1&category=4&price_sta=$2&price_end=$3&order=$4&ordertype=$5

#04
RewriteRule ^([a-z]+)/gou/*$ index.php?city=$1&category=5

RewriteRule ^([a-z]+)/gou/today/*$ index.php?city=$1&category=5&today=true
RewriteRule ^([a-z]+)/gou/today/(price|rebate|bought)_(desc|asc)/ index.php?city=$1&category=5&today=true&order=$2&ordertype=$3
RewriteRule ^([a-z]+)/gou/(price|rebate|bought)_(desc|asc)/ index.php?city=$1&category=5&order=$2&ordertype=$3

RewriteRule ^([a-z]+)/gou_([0-9]+)-([0-9]+)?/*$ index.php?city=$1&category=5&price_sta=$2&price_end=$3
RewriteRule ^([a-z]+)/gou_([0-9]+)-([0-9]+)?/today/*$ index.php?city=$1&category=5&price_sta=$2&price_end=$3&today=true
RewriteRule ^([a-z]+)/gou_([0-9]+)-([0-9]+)?/today/(price|rebate|bought)_(desc|asc)/ index.php?city=$1&category=5&price_sta=$2&price_end=$3&today=true&order=$4&ordertype=$5
RewriteRule ^([a-z]+)/gou_([0-9]+)-([0-9]+)?/(price|rebate|bought)_(desc|asc)/ index.php?city=$1&category=5&price_sta=$2&price_end=$3&order=$4&ordertype=$5

#05
RewriteRule ^([a-z]+)/qita/*$ index.php?city=$1&category=6

RewriteRule ^([a-z]+)/qita/today/*$ index.php?city=$1&category=6&today=true
RewriteRule ^([a-z]+)/qita/today/(price|rebate|bought)_(desc|asc)/ index.php?city=$1&category=6&today=true&order=$2&ordertype=$3
RewriteRule ^([a-z]+)/qita/(price|rebate|bought)_(desc|asc)/ index.php?city=$1&category=6&order=$2&ordertype=$3

RewriteRule ^([a-z]+)/qita_([0-9]+)-([0-9]+)?/*$ index.php?city=$1&category=6&price_sta=$2&price_end=$3
RewriteRule ^([a-z]+)/qita_([0-9]+)-([0-9]+)?/today/*$ index.php?city=$1&category=6&price_sta=$2&price_end=$3&today=true
RewriteRule ^([a-z]+)/qita_([0-9]+)-([0-9]+)?/today/(price|rebate|bought)_(desc|asc)/ index.php?city=$1&category=6&price_sta=$2&price_end=$3&today=true&order=$4&ordertype=$5
RewriteRule ^([a-z]+)/qita_([0-9]+)-([0-9]+)?/(price|rebate|bought)_(desc|asc)/ index.php?city=$1&category=6&price_sta=$2&price_end=$3&order=$4&ordertype=$5

#06
#07
#08
... ... 
```

我有很多分类，比如：'yule','travel','service','gou','qita',~~~~很多分类~~~~~~这些分类对应id是这样的：'meishi ' -> category=1 'yule' ->category=2 '旅行' ->category=3 '服务'->category=4 'gou' ->category=5 'qita' ->category=6 ~~~~ ~~~ 如何使用 'RewriteCond' 简化这些类别？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T05:53:24.147

查看有关重写映射的文档：[http ://httpd.apache.org/docs/current/rewrite/rewritemap.html](http://httpd.apache.org/docs/current/rewrite/rewritemap.html)

您的目标是通过文本文件将人类可读的类别标签映射到类别编号。

例如，如果您要输入`/travel`您的 URL，映射器将查询文本文件并返回`3`类别

所以，`([a-z]+)/([a-z]+)`会变成`index.php?city=$1&category=${examplemap:$1|/404.php}`. 例如，`mycity/travel`将成为`index.php?city=mycity&category=3`查找/映射之后。

然后，使用您的重写规则，您不需要为每个类别重复所有这些规则。

如果您对文档有困难，请告诉我，我会尽力为您整理一些内容。

# javascript - 在 jquery 中为 json 数组生成 html 的标准方法

> ID：16019626
> 
> 赞同：1
> 
> 时间：2013-04-15T15:57:53.303
> 
> 标签：javascript, jquery, asp.net, html, css

我正在尝试为 json 返回的用户数组生成 html。我想按照以下方式进行操作，但我觉得这不是非常有效的方式来完成这项工作。请查看以下代码并告诉我是否应该使用一些模板代码或者这种情况有什么标准？

```
 success: function(e){
       console.log(e);
       console.log(e.d[0].UserName);

       var position2= $("#searchtextbox").position();
       $('<div/>',
        {
          id:'generatedsearchdiv', 
          css:{
              position:'absolute',
              left:position2.left, 
              top:position2.top+20
              }

         }).appendTo('#searchArea');

       for (var i=0; i<=e.d.length; i++)
       {
       $('<div/>', 
            {

            html:"<span>"+e.d[i].UserName+"<span>"
            }).appendTo('#generatedsearchdiv');

       }

       } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T16:18:10.500

您可以为此使用 Jquery 模板。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T16:21:10.613

这种方法对于 HTML 的一小部分是“好的”，比如`<span>{data}</span>`. 但是，如果您有更多的东西，那么使用模板解决方案确实是最好的可维护性。查看[此答案](https://stackoverflow.com/questions/449780/recommended-javascript-html-template-library-for-jquery)以获取选项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T18:14:51.230

我还没有被当前的模板解决方案所吸引。如果你不是，如果你把这段代码内联，你可以获得一个快速的字符串格式化程序：

```
String.prototype.format = function() {
    var pattern = /\{\d+\}/g;
    var args = arguments;
    return this.replace(pattern, function(capture) {return args[capture.match(/\d+/)]; });
} 
```

您可以像这样定义格式化字符串：

```
var formatHTML = '<span>{0}</span>'; 
```

然后像这样使用它：

```
$('#generatedsearchdiv').append(formatHTML.format(e.d[i].UserName)); 
```

# jquery - DOM 选择有效，jquery 无效

> ID：16019629
> 
> 赞同：1
> 
> 时间：2013-04-15T15:57:56.000
> 
> 标签：jquery

我正在为我们的网站编写一个新功能，并想开始使用 jquery 来使我们的 javascript 现代化。我在选择表格中的元素时遇到了一些问题。我的问题是我们这样做的传统方式有效，但 jquery 方式似乎不起作用。我意识到每个人都会立即要求 HTML，但提取它需要一些时间才能删除许多不相关的垃圾。目前我只是想知道我是否搞砸了语法。从语法上讲，这是正确的吗？我正在使用 jquery 1.9.1。

```
// no messages :-(
$('censusGrid').find('select').each(function () { alert($(this)); });

// messages :-)
var elements = document.getElementById('censusGrid').getElementsByTagName('select');
for (var i = 0; i < elements.length; i++) {
    alert(elements[i]);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T15:59:09.373

几乎，它似乎`censusGrid`是一个ID，所以它应该是：

```
$('#censusGrid').find('select').each(function () { alert($(this)); }); 
```

基本上你错过了`#`表明你的选择器是一个ID，没有它，它会表明标签的名称......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T15:59:18.280

您的 jQuery 选择器不正确。如果要按 ID 查找内容，请使用 css # 选择器，如果要按类名查找内容，请使用 css 。选择器。您的 jQuery 选择器应如下所示：

```
$('#censusGrid').find('select')... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T15:59:32.687

你忘记了`#`在你的 jquery 中：

```
$('#censusGrid').etc... 
```

`#`告诉 jquery 这是一个 ID：

```
$('#selector') - finds <td id="selector">
$('selector') - finds <selector>
$('.selector') - finds <td class="selector"> 
```

# ruby-on-rails - Rails，如何在正确的时区获取日期时间的小时数？

> ID：16019631
> 
> 赞同：0
> 
> 时间：2013-04-15T15:57:59.590
> 
> 标签：ruby-on-rails, ruby, date, timezone

我有一个报价模型。当我从命令行访问它时，它以以下格式显示：

```
1.9.3p392 :058 > o = Offer.last
 => #<Offer id: 15, title: "Testing", valid_from: "2013-04-12 09:00:00", valid_until: "2013-04-12 14:00:00", created_at: "2013-04-12 18:31:54", updated_at: "2013-04-12 18:31:54"> 
```

在此输出中，`valid_from`并`valid_until`按照我的预期进行格式化。但是，当我直接访问它们时，我会得到一些不同的东西：

```
1.9.3p392 :059 > o.valid_from
   => Fri, 12 Apr 2013 05:00:00 EDT -04:00 
```

问题来自我内部的这个功能`app/models/offer_model.rb`：

```
 def start_hour
    self.valid_from.strftime('%l').to_i unless self.valid_from.nil?
  end 
```

当我使用上面的模型运行此命令时，输出为`5`. 我希望它会`9`在这种情况下返回。在这种情况下，如何`start_hour`返回为时区调整的小时？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T16:05:21.837

您在 config/application.rb 中使用的是什么时区？Rails 将打印日期调整为此文件中设置的时区。

# math - 如何降低向量的维数

> ID：16019633
> 
> 赞同：2
> 
> 时间：2013-04-15T15:58:05.597
> 
> 标签：math, vector, machine-learning, vectorization, dimension-reduction

我有一组向量。我正在研究将n维向量减少为一元值（1-d）的方法，比如说

```
(x1,x2,....,xn) ------> y 
```

这个单一的值需要是向量的特征值。每个唯一的向量产生一个唯一的输出值。以下哪种方法是合适的：

1- 向量的范数 - 平方和的平方根，用于测量距原点的欧几里得距离

2- 计算 F 的散列，使用一些散列技术避免冲突

3- 使用线性回归计算，y = w1*x1 + w2*x2 + ... + wn*xn - 如果输入值对输出没有很好的依赖性，则不太可能是好的

4- 特征提取技术，如 PCA，根据输入向量集为 x1、x2、..xn 中的每一个分配权重

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T03:55:13.800

从方法中不清楚您需要此转换具有哪些属性，因此我猜测您不需要转换来保留除唯一性和可能可逆性之外的任何属性。

您建议的任何技术通常都不能避免冲突：

1.  范数 - 指向相反方向的两个向量具有相同的范数。

2.  散列 - 如果输入不是先验已知的 - 散列函数通常意味着有一个有限的图像，并且你有无限数量的可能向量 - 不好。

3.  很容易找到对任何线性回归结果给出相同结果的向量（考虑一下）。

4.  PCA 是一种特定类型的线性变换 - 因此与线性回归具有相同的问题。

所以 - 如果你只是在寻找唯一性，你可以“字符串化”你的向量。一种方法是将它们写为文本字符串，不同的坐标由特殊字符（例如下划线）分隔。然后将此字符串的二进制值作为您的表示。

如果空间很重要并且您需要更有效的表示，您可以考虑更有效的位编码：集合 0,1,...,9,'.',' *' 中的每个字符都可以用 4 位表示 -十六进制数字（将“.”映射到 A，将“* ”映射到 B）。现在将此字符串编码为十六进制数，节省一半的空间。

# c++ - 为什么 WinHttpSendRequest 的 lpOptional 参数不是 const？

> ID：16019635
> 
> 赞同：4
> 
> 时间：2013-04-15T15:58:11.700
> 
> 标签：c++, c, winapi, winhttp

[为什么WinHttpSendRequest](http://msdn.microsoft.com/en-us/library/windows/desktop/aa384110.aspx)`lpOptional`函数的参数不是 const有什么原因吗？假设参数指向的数据不会被函数修改（并将指向只读内存的指针传递给该函数）是否安全？`lpOptional``WinHttpSendRequest`

# c# - 在实体框架中未与数据库中的字段映射的字段之间创建内部联接

> ID：16019636
> 
> 赞同：1
> 
> 时间：2013-04-15T15:58:12.083
> 
> 标签：c#, linq, c#-4.0, entity-framework-4, entity-framework-4.1

如何在字段 DecodePersonnelID 和 PersonnelID 字段之间创建关系

```
public partial class MyUser
{
public int UsersID { get; set; }
public string PersonnelID { get; set; }
[NotMapped]
public int DecodePersonnelID
{
    get { return DecodeMD5PersonnelID(PersonnelID); }
    set { PersonnelID = EncodeMD5(value.ToString() ); }
}
public string UsersName { get; set; }
}
public partial class Personnel
{
public int PersonnelID { get; set; }
public string FirstNameFa { get; set; }
public string LastNameFa { get; set; }
public bool Gender { get; set; }
}

RAYANContext db=new RAYANContext();
        var query = (from m in db.MyUsers
                     join p in db.Personnels on m.DecodePersonnelID equals p.PersonnelID
                     select new
                     {
                         m.UsersName,
                         p.FirstNameEn
                     }).ToList(); 
```

错误：LINQ to Entities 不支持指定的类型成员“DecodePersonnelID”。仅支持初始化程序、实体成员和实体导航属性。

# javascript - D3：在 d3 中查找地理多边形的面积

> ID：16019637
> 
> 赞同：7
> 
> 时间：2013-04-15T15:58:13.600
> 
> 标签：javascript, d3.js, visualization, data-visualization, geojson

我有一张使用 geoJSON 文件来绘制国家/地区的地图。然后我想画一个以每个国家为中心的圆圈。但是对于有多个边界区域的国家（美国有大陆、夏威夷、阿拉斯加），我想要最大边界区域上的圆圈。我试图通过比较不同边界区域的面积来做到这一点，但由于我无法理解的原因它不起作用。

这是 geoJSON 中的一个示例，显示了澳大利亚如何拥有多个边界区域：

```
{"type":"Feature","properties":{"name":"Australia"},"geometry":{"type":"MultiPolygon","coordinates":[[[[145.397978,-40.792549],[146.364121,-41.137695],[146.908584,-41.000546],[147.689259,-40.808258],[148.289068,-40.875438],[148.359865,-42.062445],[148.017301,-42.407024],[147.914052,-43.211522],[147.564564,-42.937689],[146.870343,-43.634597],[146.663327,-43.580854],[146.048378,-43.549745],[145.43193,-42.693776],[145.29509,-42.03361],[144.718071,-41.162552],[144.743755,-40.703975],[145.397978,-40.792549]]],[[[143.561811,-13.763656],[143.922099,-14.548311],[144.563714,-14.171176],[144.894908,-14.594458],[145.374724,-14.984976],[145.271991,-15.428205],[145.48526,-16.285672],[145.637033,-16.784918],[145.888904,-16.906926],[146.160309,-17.761655],[146.063674,-18.280073],[146.387478,-18.958274],[147.471082,-19.480723],[148.177602,-19.955939],[148.848414,-20.39121],[148.717465,-20.633469],[149.28942,-21.260511],[149.678337,-22.342512],[150.077382,-22.122784],[150.482939,-22.556142],[150.727265,-22.402405],[150.899554,-23.462237],[151.609175,-24.076256],[152.07354,-24.457887],[152.855197,-25.267501],[153.136162,-26.071173],[153.161949,-26.641319],[153.092909,-27.2603],[153.569469,-28.110067],[153.512108,-28.995077],[153.339095,-29.458202],[153.069241,-30.35024],[153.089602,-30.923642],[152.891578,-31.640446],[152.450002,-32.550003],[151.709117,-33.041342],[151.343972,-33.816023],[151.010555,-34.31036],[150.714139,-35.17346],[150.32822,-35.671879],[150.075212,-36.420206],[149.946124,-37.109052],[149.997284,-37.425261],[149.423882,-37.772681],[148.304622,-37.809061],[147.381733,-38.219217],[146.922123,-38.606532],[146.317922,-39.035757],[145.489652,-38.593768],[144.876976,-38.417448],[145.032212,-37.896188],[144.485682,-38.085324],[143.609974,-38.809465],[142.745427,-38.538268],[142.17833,-38.380034],[141.606582,-38.308514],[140.638579,-38.019333],[139.992158,-37.402936],[139.806588,-36.643603],[139.574148,-36.138362],[139.082808,-35.732754],[138.120748,-35.612296],[138.449462,-35.127261],[138.207564,-34.384723],[137.71917,-35.076825],[136.829406,-35.260535],[137.352371,-34.707339],[137.503886,-34.130268],[137.890116,-33.640479],[137.810328,-32.900007],[136.996837,-33.752771],[136.372069,-34.094766],[135.989043,-34.890118],[135.208213,-34.47867],[135.239218,-33.947953],[134.613417,-33.222778],[134.085904,-32.848072],[134.273903,-32.617234],[132.990777,-32.011224],[132.288081,-31.982647],[131.326331,-31.495803],[129.535794,-31.590423],[128.240938,-31.948489],[127.102867,-32.282267],[126.148714,-32.215966],[125.088623,-32.728751],[124.221648,-32.959487],[124.028947,-33.483847],[123.659667,-33.890179],[122.811036,-33.914467],[122.183064,-34.003402],[121.299191,-33.821036],[120.580268,-33.930177],[119.893695,-33.976065],[119.298899,-34.509366],[119.007341,-34.464149],[118.505718,-34.746819],[118.024972,-35.064733],[117.295507,-35.025459],[116.625109,-35.025097],[115.564347,-34.386428],[115.026809,-34.196517],[115.048616,-33.623425],[115.545123,-33.487258],[115.714674,-33.259572],[115.679379,-32.900369],[115.801645,-32.205062],[115.689611,-31.612437],[115.160909,-30.601594],[114.997043,-30.030725],[115.040038,-29.461095],[114.641974,-28.810231],[114.616498,-28.516399],[114.173579,-28.118077],[114.048884,-27.334765],[113.477498,-26.543134],[113.338953,-26.116545],[113.778358,-26.549025],[113.440962,-25.621278],[113.936901,-25.911235],[114.232852,-26.298446],[114.216161,-25.786281],[113.721255,-24.998939],[113.625344,-24.683971],[113.393523,-24.384764],[113.502044,-23.80635],[113.706993,-23.560215],[113.843418,-23.059987],[113.736552,-22.475475],[114.149756,-21.755881],[114.225307,-22.517488],[114.647762,-21.82952],[115.460167,-21.495173],[115.947373,-21.068688],[116.711615,-20.701682],[117.166316,-20.623599],[117.441545,-20.746899],[118.229559,-20.374208],[118.836085,-20.263311],[118.987807,-20.044203],[119.252494,-19.952942],[119.805225,-19.976506],[120.85622,-19.683708],[121.399856,-19.239756],[121.655138,-18.705318],[122.241665,-18.197649],[122.286624,-17.798603],[122.312772,-17.254967],[123.012574,-16.4052],[123.433789,-17.268558],[123.859345,-17.069035],[123.503242,-16.596506],[123.817073,-16.111316],[124.258287,-16.327944],[124.379726,-15.56706],[124.926153,-15.0751],[125.167275,-14.680396],[125.670087,-14.51007],[125.685796,-14.230656],[126.125149,-14.347341],[126.142823,-14.095987],[126.582589,-13.952791],[127.065867,-13.817968],[127.804633,-14.276906],[128.35969,-14.86917],[128.985543,-14.875991],[129.621473,-14.969784],[129.4096,-14.42067],[129.888641,-13.618703],[130.339466,-13.357376],[130.183506,-13.10752],[130.617795,-12.536392],[131.223495,-12.183649],[131.735091,-12.302453],[132.575298,-12.114041],[132.557212,-11.603012],[131.824698,-11.273782],[132.357224,-11.128519],[133.019561,-11.376411],[133.550846,-11.786515],[134.393068,-12.042365],[134.678632,-11.941183],[135.298491,-12.248606],[135.882693,-11.962267],[136.258381,-12.049342],[136.492475,-11.857209],[136.95162,-12.351959],[136.685125,-12.887223],[136.305407,-13.29123],[135.961758,-13.324509],[136.077617,-13.724278],[135.783836,-14.223989],[135.428664,-14.715432],[135.500184,-14.997741],[136.295175,-15.550265],[137.06536,-15.870762],[137.580471,-16.215082],[138.303217,-16.807604],[138.585164,-16.806622],[139.108543,-17.062679],[139.260575,-17.371601],[140.215245,-17.710805],[140.875463,-17.369069],[141.07111,-16.832047],[141.274095,-16.38887],[141.398222,-15.840532],[141.702183,-15.044921],[141.56338,-14.561333],[141.63552,-14.270395],[141.519869,-13.698078],[141.65092,-12.944688],[141.842691,-12.741548],[141.68699,-12.407614],[141.928629,-11.877466],[142.118488,-11.328042],[142.143706,-11.042737],[142.51526,-10.668186],[142.79731,-11.157355],[142.866763,-11.784707],[143.115947,-11.90563],[143.158632,-12.325656],[143.522124,-12.834358],[143.597158,-13.400422],[143.561811,-13.763656]]]]},"id":"AUS"}, 
```

这是我尝试比较不同边界区域的代码。在该`if`声明中，我试图弄清楚该国家是否有多个边界区域（这似乎可行），然后在该`for`区块中，选择最大的一个。

问题：我得到的“面积”值都是 0，并且`coords`总是从第一个边界区域中选择，而不是最大的。

```
function calculateCountryCenter(country) {

    var coords;

    //Check if the country has more than one bounding region.
    if (country.geometry.coordinates.length > 1) {

        coords = country.geometry.coordinates[0][0];

        var regionArea = path.area(country.geometry.coordinates[0]);

        for (var i=0; i<country.geometry.coordinates.length; i++) {
            if (path.area(country.geometry.coordinates[i]) > regionArea) {

                coords = country.geometry.coordinates[i][0];
            }
        }     

    } else {    
        coords = country.geometry.coordinates[0];
    }

    var averageCoords = [0,0];
    coords.forEach(function(coord) {
        averageCoords[0] += coord[0]
        averageCoords[1] += coord[1]
    });

    averageCoords[0] = averageCoords[0] / coords.length
    averageCoords[1] = averageCoords[1] / coords.length
    return averageCoords;

} 
```

这是路径的定义。

```
 var path = d3.geo.path().projection(projection) 
```

任何指导将不胜感激。非常感谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-07-30T16:12:36.157

[您可以使用Shoelace 算法](http://en.wikipedia.org/wiki/Shoelace_formula)计算任意多边形的面积。

```
function polygonArea(points) {
  var sum = 0.0;
  var length = points.length;
  if (length < 3) {
    return sum;
  }
  points.forEach(function(d1, i1) {
    i2 = (i1 + 1) % length;
    d2 = points[i2];
    sum += (d2[1] * d1[0]) - (d1[1] * d2[0]);
  });
  return sum / 2;
}

polygonArea([[0,0], [4,0], [4,3]]);  // 6 
```

请注意，逆时针多边形将具有正面积，而顺时针多边形将具有负面积。自相交多边形通常同时具有顺时针和逆时针区域，因此它们的面积将抵消。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-16T15:14:30.880

只是因为还没有人添加完全实施的答案，所以我决定回答我自己的问题。下面的代码采用原始问题中指定的 geoJSON，并返回具有多个边界区域的国家/地区的最大边界区域的坐标。对于只有一个边界区域的国家，它返回一个边界区域的坐标。（我不得不稍微修改一下代码，使它成为一个独立的方法，但我很确定它没有错误。）

```
function getLargestBoundingRegion(country) {

var largestRegionCoords;
var path = d3.geo.path()

//Check if the country has more than one bounding region.
if (country.geometry.coordinates.length > 1) {

    var regionToReturn = {        
        "type": "Feature",
        "geometry": {
            "type": "Polygon", 
            "coordinates": country.geometry.coordinates[0]},            
        };

    for (var i=1; i<country.geometry.coordinates.length; i++) {

        var testRegion = {        
                    "type": "Feature",
                "geometry": {
                    "type": "Polygon", 
                    "coordinates": country.geometry.coordinates[i]},            
            };

        if (path.area(testRegion) > path.area(regionToReturn)) {
            regionToReturn = testRegion;    
            largestRegionCoords = country.geometry.coordinates[i][0];    
            }
        }

    } else {    
        largestRegionCoords = country.geometry.coordinates[0];
    }

return largestRegionCoords; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-16T15:12:21.400

该`path.area`函数需要一个功能，并且不能仅使用坐标列表。使其工作的最简单方法可能是复制原始对象，删除所有您不感兴趣的坐标并将其传递给`path.area`. 代码看起来像

```
for (var i=0; i<country.geometry.coordinates.length; i++) {
    var copy = JSON.parse(JSON.stringify(country));
    copy.geometry.coordinates = [copy.geometry.coordinates[i]];
    path.area(copy);
    ...
} 
```

# javascript - 将代码拆分为不同的 Javascript 文件

> ID：16019639
> 
> 赞同：0
> 
> 时间：2013-04-15T15:58:15.190
> 
> 标签：javascript, html5-canvas

我正在开发一个基于 Javascript/HTML5 画布的游戏，到目前为止，我的 JS 代码已经超过 1200 行。我正在使用很多对象和很多不同的功能，所以我想到了一个问题。

是否有任何可能的方法在单独的 JS 文件和主文件中有单独的对象，我会在他们自己的 JS 文件中引用这些单独的对象？我只想保持我的代码简单，因为它开始看起来有点乱。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T19:56:26.030

就像 akluth 所说，您可以使用外部库来“加载”您的外部 Javascript 文件。

如果您不想使用其中任何一个，那么这是 gool'ol 风格的 JS 方式：您包含所有外部文件，如下所示：

```
<script type="text/javascript" src="external/file.js"></script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T16:00:16.140

您可以为此使用[requireJS](http://requirejs.org/) - 它允许您将代码分离到[AMD 模块](http://requirejs.org/docs/whyamd.html)中，这些模块可以在您的项目中轻松使用。

要在您的生产环境中优化和缩小代码，您可以使用[r.js，这是一个 requireJS 优化器](http://requirejs.org/docs/optimization.html)，它允许您将所有模块合并到一个缩小和 uglified 文件中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T16:33:34.810

简单的答案是肯定的。您可以按照 Jarrod 的建议将每个对象及其属性和方法放在其自己的文件中加载每个文件。

```
<script type="text/javascript" src="external/main.js"></script>
<script type="text/javascript" src="external/obj1.js"></script>
<script type="text/javascript" src="external/obj2.js"></script> 
```

其中“外部”是与您的 HTML 文件位于同一文件夹中的目录。

# asp.net - 我的菜单项来自哪里？

> ID：16019640
> 
> 赞同：1
> 
> 时间：2013-04-15T15:58:17.450
> 
> 标签：asp.net, vb.net

我在没有任何文件的情况下接管了这个网站（耶！）。也许这将有助于其他人了解 SiteMap 功能。我知道 SiteMenu 是如何构建的，但想与我在 SO 的朋友确认一下。

我有一个 Main.Master ，它需要一个 SiteMenuHorizo​​ntal 用户控件。

```
<%@ Register Src="uc2Menu.ascx" TagPrefix="uc2" TagName="smHorizontal" %>
...
<uc2:smHorizontal id="uc2Menu" runat="server" /> 
```

用户控件非常简单：

```
<%@ Control Language="vb" AutoEventWireup="false" CodeBehind="uc2Menu.ascx.vb" Inherits="uc2Menu" %>
<asp:Menu id="siteMenu" runat="server" DataSourceID="menuSiteMapDataSource" Orientation="Horizontal" />

<asp:SiteMapDataSource ID="menuSiteMapDataSource" runat="server" ShowStartingNode="false" /> 
```

控件的代码隐藏没有帮助：

```
Public Partial Class uc2Menu
Inherits System.Web.UI.UserControl

Protected Sub siteMenu_MenuItemDataBound(ByVal sender As System.Object, ByVal e As System.Web.UI.WebControls.MenuEventArgs) Handles siteMenu.MenuItemDataBound
    e.Item.Target = CType(e.Item.DataItem, SiteMapNode)("Target")
End Sub
End Class 
```

Web.Config 确实指定了一个站点地图：

```
<siteMap enabled="true" defaultProvider="objSiteMap">
    <providers>
        <clear/>
        <add name="objSiteMap" type="LOC.DLL.objSiteMap" securityTrimmingEnabled="true" expirationInterval="1"/>
    </providers>
</siteMap> 
```

LOC.DLL.objSiteMap 继承 SiteMapProvider 并具有重载/覆盖等。这些方法从数据库中获取表并构建 SiteMapNode 或 SiteMapNodeCollection。

我的困惑是：这个类如何填充我的网页？没有对 SiteMap 的可见调用。

我的假设是：当站点（或页面）被构建（或编译？）时，我的用户控件调用它的数据源 Global.System.Web.UI.WebControls.SiteMapDataSource。不知何故，该控件引用 Web.Config 以获取对 LOC.DLL.objSiteMap 的引用，并运行 Override/Overload 方法来检索 SiteMapNode(/Collection)，并将其返回给我的控件？

我有一种感觉，我已经把它记下来了，但想要得到确认和/或澄清，并希望在未来帮助其他通过动态站点菜单接管项目的人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T16:11:50.003

您的分析非常正确。

我认为您缺少的主要联系是 web.config 值`defaultProvider="objSiteMap"`是导致`SiteMapDataSource`您的 UserControl 连接到 web.config 中的“objSiteMap”提供程序的原因。

由于它被设置为“默认提供程序”，因此您项目中的任何 SiteMap 都将使用该`LOC.DLL.objSiteMap`提供程序填充（除非您专门覆盖代码中的默认值）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T16:26:29.897

> 这个类如何填充我的网页？没有对 SiteMap 的可见调用。

SiteMapProvider 基于[ASP.Net 的 Provider 模型](http://msdn.microsoft.com/en-us/library/aa479030.aspx)，类似于 Membership 和 Role 提供者。

> 我的假设是：当网站（或页面）被构建（或编译？）时，我的用户控件调用它的数据源 Global.System.Web.UI.WebControls。站点地图数据源。不知何故，该控件引用 Web.Config 以获取对 LOC.DLL.objSiteMap 的引用，并运行 Override/Overload 方法来检索 SiteMapNode(/Collection)，并将其返回给我的控件？

是的，你的假设是正确的。

您的用户控件调用默认站点地图提供程序`objSiteMap`，并且站点地图是在每个页面请求上动态创建的。

**仅供参考：**由于您已设置`objSiteMap`为默认提供程序，因此您无需执行任何操作。但是，如果您需要默认提供程序以外的提供程序，则需要显式设置提供程序名称。

```
<asp:SiteMapDataSource ID="SiteMapDataSource1" runat="server" 
 SiteMapProvider="AnotherProvider" /> 
```

# iphone - Unicode 字符问题

> ID：16019644
> 
> 赞同：1
> 
> 时间：2013-04-15T15:58:35.253
> 
> 标签：iphone, ios, unicode, ios6

我有一个 unicode 字符₮，它在标签和 UITextView 中显示得很好，但是当我将它显示为 UITableView 单元格的文本时，它显示为问号。

我在这里遗漏了什么，或者不同的 iOS 控件支持不同的字符集？在后端，字符来自 NSString 并且标签仅显示所选 UITableView 单元格的文本：

```
self.MyLabel.text = cell.textLabel.text; 
```

请参阅下面的屏幕截图以供参考。

![在此处输入图像描述](https://i.stack.imgur.com/l5C9R.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T15:52:39.490

原来是字体问题。与其他 UI 控件相比，我为表格单元格使用了不同的字体。

rmaddy 上面的评论帮助我解决了这个问题。

# javascript - 数字格式的高图（单位）

> ID：16019645
> 
> 赞同：3
> 
> 时间：2013-04-15T15:58:39.187
> 
> 标签：javascript, highcharts

我正在使用[Highcharts](http://www.highcharts.com/)生成折线图。

我有一个问题`numberFormat`：

```
var test = 15975000;
numberFormat(test, 0,',','.'); 
```

结果是：`15.975.000`

但我想转变`1000`为`1k`，`100000`到`100k`，`1000000`到`1m`喜欢这个。我该如何处理这个问题？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-16T08:04:42.347

numberFormat 在 Highcharts 对象中可用。

```
Highcharts.numberFormat(test, 0,',','.'); 
```

示例[http://jsfiddle.net/DaBYc/1/](http://jsfiddle.net/DaBYc/1/)

```
yAxis: {
        labels: {
            formatter: function () {
                return Highcharts.numberFormat(this.value,0);
            }
        }
    }, 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-15T16:17:23.193

编写您自己的[格式化程序](http://api.highcharts.com/highcharts#yAxis.labels.formatter)（参见此[示例](http://jsfiddle.net/gh/get/jquery/1.7.2/highslide-software/highcharts.com/tree/master/samples/highcharts/xaxis/labels-formatter-linked/)）。

```
formatter: function() {
  result = this.value;
  if (this.value > 1000000) { result = Math.floor(this.value / 1000000) + "M" }
  else if (this.value > 1000) { result = Math.floor(this.value / 1000) + "k" }
  return result;
} 
```

另请参阅：[如何格式化类似于 Stack Overflow 信誉格式的数字](https://stackoverflow.com/questions/3177855/how-to-format-numbers-similar-to-stack-overflow-reputation-format)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-07-13T18:33:50.983

你只需要这样做：

```
 labels: {
                formatter: function() {
                     return abbrNum(this.value,2); // Need to call the function for each value shown by the chart
                }
            }, 
```

* * *

这是用于转换要插入到 javascript 上的数据的函数：

```
 function abbrNum(number, decPlaces) {
    // 2 decimal places => 100, 3 => 1000, etc
    decPlaces = Math.pow(10,decPlaces);

    // Enumerate number abbreviations
    var abbrev = [ "k", "m", "b", "t" ];

    // Go through the array backwards, so we do the largest first
    for (var i=abbrev.length-1; i>=0; i--) {

        // Convert array index to "1000", "1000000", etc
        var size = Math.pow(10,(i+1)*3);

        // If the number is bigger or equal do the abbreviation
        if(size <= number) {
             // Here, we multiply by decPlaces, round, and then divide by decPlaces.
             // This gives us nice rounding to a particular decimal place.
             number = Math.round(number*decPlaces/size)/decPlaces;

             // Handle special case where we round up to the next abbreviation
             if((number == 1000) && (i < abbrev.length - 1)) {
                 number = 1;
                 i++;
             }

             // Add the letter for the abbreviation
             number += abbrev[i];

             // We are done... stop
             break;
        }
    }

    return number;
} 
```

希望这有效=)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-06-09T11:52:58.557

如果您想格式化 Highstock 图表：

```
 tooltip: {
        pointFormatter: function() {
          var result = this.y;
        let header = '<table>';
        let body = '<tr><td style = "color: ' + this.series.color + ';padding:0">'
          + this.series.name + ': </td><td style = "padding:0"><b>';
        if (result > 1000000) {
          result = Math.floor(result / 1000000) + "M"
        }
        else if (result > 1000) {
          result = Math.floor(result / 1000) + "k"
        }
        return header + body + result + '</b></td></tr></table>';
        }
    }, 
```

我很难找到一种在不妨碍数据分组功能或日期的情况下添加百万和数千的方法。

# php - 动态 AJAX - 将响应加载到另一个请求中

> ID：16019647
> 
> 赞同：0
> 
> 时间：2013-04-15T15:58:45.903
> 
> 标签：php, jquery, ajax, dynamic

在一个非常定制的电子商务网站上工作。这些页面是通过 ajax 加载的，我已将另一个 AJAX 请求附加到`$.ajaxSuccess()`. 此请求用于从我的 PHP 脚本中获取响应（然后将响应加载到商店列表中）。

```
$(document).ajaxSuccess(function() {
    var thisHash = location.hash,
        hashArr = thisHash.split("/"),
        folder = hashArr[1],
        file = hashArr[2];

    retrieveMarkup(folder,file);  
}) 
```

然后`retrieveMarkup()`向我的 PHP 脚本发出 get 请求，然后将响应加载到`$("#store")`.

```
function retrieveMarkup(mainCat, subCat) {
    if (!subCat || subCat == "all"){

        var urlOb = $.param({ "cat": mainCat});
    }
    else {
        urlOb = $.param({ "cat": mainCat, "subcat" : subCat});
    }

    $.ajax({
        url: backendBase+"markup&"+urlOb,
        global: false,
        dataType: "text",
        cache: true,
        success: function(d,s,x) {

           writeRes(x.responseText);
        }
    })

} 
```

我将`global`函数中的设置`retrieveMarkup()`为false，这样就没有无限循环。

这是我遇到问题的地方：

第一次加载网站时，一切都按预期工作。我导航到`Beverages -> All`. 该脚本按预期工作，并将响应加载到存储中。然后点击后`Snacks -> All`，脚本仍然有效。但是，在尝试导航回`Beverages -> All`脚本后，不会将响应插入到商店项目中。但我可以导航回来，`Snacks -> All`脚本按预期工作。

注意：您必须先加载`Beverages -> All`它才能工作。

这有点难以解释，所以这里是网站的链接[http://grantcr.com/kmm/site/#!/home](http://grantcr.com/kmm/site/#!/home)

这是我在这个网站上的第一篇文章。所以请对我放轻松:)

# c++ - 从任务栏中隐藏控制台 C++ 程序

> ID：16019650
> 
> 赞同：7
> 
> 时间：2013-04-15T15:58:53.623
> 
> 标签：c++, windows, taskbar

我有一个调用另一个控制台应用程序的小型**控制台游戏。**像**Winamp**的许多窗口（*主要*和*播放列表*）。问题是当我调用两个例如控制台窗口时，在**任务栏中**打开的程序太多了，我不需要单独打开窗口，我只希望**主**窗口留在任务栏中，当我点击它时，*它*及其**所有子应用程序都会**弹出。

PS我很熟悉`ShowWindow ( GetConsoleWindow(), SW_HIDE );`，但它也隐藏了窗口，我希望它只从任务栏中隐藏。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-16T18:51:42.830

感谢上尉 Obvlious 和一些研究，以下代码：

```
ITaskbarList *pTaskList = NULL;
HRESULT initRet = CoInitialize(NULL);
HRESULT createRet = CoCreateInstance( CLSID_TaskbarList,
                                      NULL,
                                      CLSCTX_INPROC_SERVER,
                                      IID_ITaskbarList,
                                      (LPVOID*)&pTaskList );

if(createRet == S_OK)
{

    pTaskList->DeleteTab(GetConsoleWindow());

    pTaskList->Release();
}

CoUninitialize(); 
```

包含`ShObjIdl.h`的作品很棒！

注意：您应该将**S_OK**作为**initRet**和**createRet**中的值！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-15T20:14:15.487

我知道在控制台窗口上完成此操作的唯一方法是使用 shell 接口[ITaskbarList](http://msdn.microsoft.com/en-us/library/windows/desktop/bb774652%28v=vs.85%29.aspx)。

```
hr = CoCreateInstance(
    CLSID_TaskbarList,
    NULL,
    CLSCTX_INPROC_SERVER,
    IID_ITaskbarList,
    reinterpret_cast<void**>(&taskbar));
if(!FAILED(hr))
{
    // Remove the icon from the task bar
    taskbar->DeleteTab(GetConsoleWindow());
    // Release it
    taskbar->Release();
} 
```

# c++ - string.append() 上的 Valgrind 内存泄漏？

> ID：16019651
> 
> 赞同：1
> 
> 时间：2013-04-15T15:58:56.890
> 
> 标签：c++, memory-leaks, valgrind

那是我第一次用 C++ 编程并使用 Valgrind 查找内存泄漏等。我遇到了我无法理解的错误。任何人都可以帮助我吗？

我应该说不同的线程可能正在调用这个函数！

**我启动 Valgrind 的命令是：**

```
 valgrind -v --leak-check=full --show-reachable=yes --trace-children=yes --tool=memcheck --suppressions=../valgrind.supp ./my_app 
```

**这些是错误：**

```
==14404==    at 0x4C25F98: memcpy (mc_replace_strmem.c:497)
==14404==    by 0x57252F5: std::string::append(char const*, unsigned long) (in /usr/lib/libstdc++.so.6.0.13)
==14404==    by 0x430F26: DriverManager::GetPathById(char const*) (driver_manager.cpp:138)
==14404==    by 0x43064A: DriverManager::UnloadDriver(Driver*) (driver_manager.cpp:31)
==14404==    by 0x430DC6: DriverManager::UnloadDrivers() (driver_manager.cpp:115)
==14404==    by 0x4279AA: Application::~Application() (application.cpp:134)
==14404==    by 0x607A611: __run_exit_handlers (exit.c:78)
==14404==    by 0x607A664: exit (exit.c:100)
==14404==    by 0x6062C93: (below main) (libc-start.c:260)
==14404==  Address 0x6a20f6b is 27 bytes inside a block of size 29 free'd
==14404==    at 0x4C23E0F: operator delete(void*) (vg_replace_malloc.c:387)
==14404==    by 0x5724EE8: std::basic_string<char, std::char_traits<char>, std::allocator<char> >::~basic_string() (in /usr/lib/libstdc++.so.6.0.13)
==14404==    by 0x607A611: __run_exit_handlers (exit.c:78)
==14404==    by 0x607A664: exit (exit.c:100)
==14404==    by 0x6062C93: (below main) (libc-start.c:260)
==14404==
==14404==
==14404== 1 errors in context 5 of 6:
==14404== Invalid read of size 1
==14404==    at 0x4C25812: __GI_strlen (mc_replace_strmem.c:284)
==14404==    by 0x572538B: std::string::append(char const*) (in /usr/lib/libstdc++.so.6.0.13)
==14404==    by 0x430F26: DriverManager::GetPathById(char const*) (driver_manager.cpp:138)
==14404==    by 0x43064A: DriverManager::UnloadDriver(Driver*) (driver_manager.cpp:31)
==14404==    by 0x430DC6: DriverManager::UnloadDrivers() (driver_manager.cpp:115)
==14404==    by 0x4279AA: Application::~Application() (application.cpp:134)
==14404==    by 0x607A611: __run_exit_handlers (exit.c:78)
==14404==    by 0x607A664: exit (exit.c:100)
==14404==    by 0x6062C93: (below main) (libc-start.c:260)
==14404==  Address 0x6a20f68 is 24 bytes inside a block of size 29 free'd
==14404==    at 0x4C23E0F: operator delete(void*) (vg_replace_malloc.c:387)
==14404==    by 0x5724EE8: std::basic_string<char, std::char_traits<char>, std::allocator<char> >::~basic_string() (in /usr/lib/libstdc++.so.6.0.13)
==14404==    by 0x607A611: __run_exit_handlers (exit.c:78)
==14404==    by 0x607A664: exit (exit.c:100)
==14404==    by 0x6062C93: (below main) (libc-start.c:260)
==14404==
==14404==
==14404== 4 errors in context 6 of 6:
==14404== Invalid read of size 1
==14404==    at 0x4C25824: __GI_strlen (mc_replace_strmem.c:284)
==14404==    by 0x572538B: std::string::append(char const*) (in /usr/lib/libstdc++.so.6.0.13)
==14404==    by 0x430F26: DriverManager::GetPathById(char const*) (driver_manager.cpp:138)
==14404==    by 0x43064A: DriverManager::UnloadDriver(Driver*) (driver_manager.cpp:31)
==14404==    by 0x430DC6: DriverManager::UnloadDrivers() (driver_manager.cpp:115)
==14404==    by 0x4279AA: Application::~Application() (application.cpp:134)
==14404==    by 0x607A611: __run_exit_handlers (exit.c:78)
==14404==    by 0x607A664: exit (exit.c:100)
==14404==    by 0x6062C93: (below main) (libc-start.c:260)
==14404==  Address 0x6a20f69 is 25 bytes inside a block of size 29 free'd
==14404==    at 0x4C23E0F: operator delete(void*) (vg_replace_malloc.c:387)
==14404==    by 0x5724EE8: std::basic_string<char, std::char_traits<char>, std::allocator<char> >::~basic_string() (in /usr/lib/libstdc++.so.6.0.13)
==14404==    by 0x607A611: __run_exit_handlers (exit.c:78)
==14404==    by 0x607A664: exit (exit.c:100)
==14404==    by 0x6062C93: (below main) (libc-start.c:260) 
```

**这就是 GetDriverPathById() 函数：**

```
string DriverManager::GetPathById(const char* id) {
    string path;

    path.assign(driverPath);
    path.append(id);
    path.append(".so");

    return path;
} 
```

这就是我调用这个函数的方式：

```
GetPathById( obj->GetDriverId()->c_str() ); 
```

Obj 是共享对象的实例化类。GetDriverId() 给了我一个字符串*：

```
const string Driver::id = "test"; 
```

驱动路径是：

```
string DriverManager::driverPath; 
```

# java - 从 JAVA 调用 R 以获取卡方统计量和 p 值

> ID：16019654
> 
> 赞同：3
> 
> 时间：2013-04-15T15:58:57.863
> 
> 标签：java, r, statistics, chi-squared

我在 JAVA 中有两个 4*4 矩阵，其中一个矩阵保存观察到的计数，另一个保存预期计数。

我需要一种自动方法来计算这两个矩阵之间的卡方统计量的 p 值；但是，据我所知，JAVA 没有这样的功能。

我可以通过将两个矩阵作为 .csv 文件格式读入 R 来计算卡方及其 p 值，然后使用 chisq.test 函数，如下所示：

```
obs<-read.csv("obs.csv")
exp<-read.csv("exp.csv")
chisq.test(obs,exp) 
```

其中 .csv 文件的格式如下：

```
A, C, G, T
A, 197.136, 124.32, 63.492, 59.052
C, 124.32, 78.4, 40.04, 37.24
G, 63.492, 40.04, 20.449, 19.019
T, 59.052, 37.24, 19.019, 17.689 
```

给定这些命令，R 将给出以下格式的输出：

```
X-squared = 20.6236, df = 9, p-value = 0.01443 
```

其中包括我正在寻找的 p 值。

有谁知道自动化以下过程的有效方法：

1) 将我的矩阵从 JAVA 输出到 .csv 文件 2) 将 .csv 文件上传到 R 3) 将 .csv 文件上的 chisq.test 调用到 R 4) 将输出的 p 值返回到 JAVA？

谢谢你的帮助....

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-15T16:32:41.183

有（至少）两种方法可以解决这个问题。

* * *

## 命令行和脚本

您可以使用`Rscript.exe`. 例如，在您的脚本中，您将拥有：

```
# Parse arguments.
# ...
# ...

chisq.test(obs, exp) 
```

与其在 Java 中创建 CSV 并让 R 读取它们，不如将它们直接传递给 R。我认为不需要创建 CSV 并以这种方式传递数据，除非你的矩阵非常大。您可以传递的命令行参数的大小有限制（我认为因操作系统而异）。

您可以将参数传递到 Rscripts 并使用`commandArgs()`函数或各种包（例如[optparse](http://cran.r-project.org/web/packages/optparse/index.html)或[getopt](http://cran.r-project.org/web/packages/getopt/index.html)）解析它们。有关更多信息，请参阅[此线程](https://stackoverflow.com/questions/2151212/how-can-i-read-command-line-parameters-from-an-r-script)。

在 Java 中有几种从命令行调用和读取的方法。我对此知之甚少，无法给你建议，但谷歌搜索会给你一个结果。从命令行调用脚本是这样完成的：

```
Rscript my_script.R 
```

* * *

## 日本研究所

JRI 让您可以直接从 Java 与 R 对话。这是一个示例，说明如何将双精度数组传递给 R 并让 R 对其求和（现在是 Java）：

```
// Start R session.
Rengine re = new Rengine (new String [] {"--vanilla"}, false, null);

// Check if the session is working.
if (!re.waitForR()) {
    return;
}

re.assign("x", new double[] {1.5, 2.5, 3.5});
REXP result = re.eval("(sum(x))");
System.out.println(result.asDouble());
re.end(); 
```

这里的功能`assign()`与在 R 中执行此操作相同：

```
x <- c(1.5, 2.5, 3.5) 
```

您应该能够弄清楚如何扩展它以使用矩阵。

* * *

我认为JRI一开始是相当困难的。因此，如果您想快速完成此操作，命令行选项可能是最好的。我想说的是，一旦你设置了 JRI 方法，它就不会那么混乱了。而且，如果您遇到在 R 和 Java 之间来回频繁的情况，那肯定比调用多个脚本要好。

1.  [链接到 JRI](http://www.rforge.net/JRI/)。
2.  [推荐 Eclipse 插件来设置 JRI](http://www.studytrails.com/RJava-Eclipse-Plugin/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-15T16:02:00.633

检查此页面[JRI](http://www.rforge.net/JRI/)

描述形成他们的网站：

> JRI 是一个 Java/R 接口，它允许在 Java 应用程序中作为单线程运行 R。基本上，它将 R 动态库加载到 Java 中，并为 R 功能提供 Java API。它支持对 R 函数的简单调用和完整运行的 REPL。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-14T11:02:52.450

RCaller 2.2 可以做你想做的事。假设在您的问题中给出了频率矩阵。可以使用以下代码计算并返回结果 p.value 和 df 变量：

```
double[][] data = new double[][]{
        {197.136, 124.32, 63.492, 59.052},
        {124.32, 78.4, 40.04, 37.24},
        {63.492, 40.04, 20.449, 19.019},
        {59.052, 37.24, 19.019, 17.689}
        };
    RCaller caller = new RCaller();
    Globals.detect_current_rscript();
    caller.setRscriptExecutable(Globals.Rscript_current);
    RCode code = new RCode();

    code.addDoubleMatrix("mydata", data);
    code.addRCode("result <- chisq.test(mydata)");
    code.addRCode("mylist <- list(pval = result$p.value, df=result$parameter)");

    caller.setRCode(code);
    caller.runAndReturnResult("mylist");

    double pvalue = caller.getParser().getAsDoubleArray("pval")[0];
    double df = caller.getParser().getAsDoubleArray("df")[0];
    System.out.println("Pvalue is : "+pvalue);
    System.out.println("Df is : "+df); 
```

输出是：

```
Pvalue is : 1.0
Df is : 9.0 
```

[你可以在这里](http://stdioe.blogspot.com.tr/search/label/rcaller)获得技术细节

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-12-24T01:17:28.483

Rserve 是另一种将数据从 Java 获取到 R 并返回的方法。它是一个将 R 脚本作为字符串输入的服务器。您可以使用 Java 中的一些字符串解析和转换将矩阵转换为可以输入到 R 中的字符串。

```
import org.rosuda.REngine.REXP;
import org.rosuda.REngine.Rserve.RConnection;

public class RtestScript {

private String emailTestScript = "open <- c('O', 'O', 'N', 'N', 'O', 'O', 'N', 'N', 'N', 'O', " +
        " 'O', 'N', 'N', 'O', 'O', 'N', 'N', 'N', 'O');" +
        "testgroup <- c('A', 'A', 'A','A','A','A','A','A','A','A', 'B'," +
        "'B', 'B', 'B', 'B', 'B', 'B', 'B', 'B');" +
        "emailTest <- data.frame(open, testgroup);" +
        "emailTable<- table(emailTest$open, emailTest$testgroup);" +
        "emailResults<- prop.test(emailTable, correct=FALSE);" +
        "print(emailResults$p.value);";

public void executeRscript() {
    try {
        //Make sure to type in library(Rserve); Rserve() in Rstudio before running this
        RConnection testConnection = new RConnection();

        REXP testExpression = testConnection.eval(emailTestScript);
        System.out.println("P value: " + testExpression.asString());
    } catch(Exception e) {
        e.printStackTrace();
    }
}
} 
```

这是有关 Rserve 的更多信息。顺便说一句，这也是 Tableau 与 R 以及它们的 R 连接进行通信的方式。

[https://cran.r-project.org/web/packages/Rserve/index.html](https://cran.r-project.org/web/packages/Rserve/index.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-06-06T07:46:17.660

我建议简单地使用一个为您进行 ChiSquare 测试的 Java 库。有足够的：

*   阿帕奇公共数学：[http ://commons.apache.org/proper/commons-math/](http://commons.apache.org/proper/commons-math/)
*   JSC： http: [//www.jsc.nildram.co.uk/](http://www.jsc.nildram.co.uk/)
*   JDistlib：http: [//jdistlib.sourceforge.net/](http://jdistlib.sourceforge.net/)

这不是一个完整的列表，而是我在 5 分钟的搜索中找到的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-06-06T06:41:50.690

1) 将我的矩阵从 JAVA 输出到 .csv 文件中

使用任何 CSV 库，我会推荐[http://opencsv.sourceforge.net/](http://opencsv.sourceforge.net/)

2) 将 .csv 文件上传到 R 3) 将 .csv 文件上的 chisq.test 调用到 R

2 & 3 几乎一样，你最好创建参数化脚本以在 R 中运行。

```
obs<-read.csv(args[1])
exp<-read.csv(args[2])
chisq.test(obs,exp) 
```

所以你可以运行

```
RScript your_script.r path_to_csv1 path_to_csv2, 
```

并为 csv 文件使用唯一名称，例如：

```
UUID.randomUUID().toString().replace("-","") 
```

然后你使用

```
Runtime.getRuntime().exec(command, environments, dataDir); 
```

4) 将输出的 p 值返回到 JAVA？如果您使用 getRuntime().exec() 调用 R，则只能读取 R 的输出。

我还建议查看[Apache 的 Statistics Lib](http://commons.apache.org/proper/commons-math/apidocs/org/apache/commons/math3/stat/inference/ChiSquareTest.html) & [How to calculate PValue from ChiSquare](http://vvlasov.blogspot.ru/2013/06/how-to-calculate-pvalue-from-chisquare.html)。也许你可以完全没有 R :)

# python - 带有版本控制的 HDF5 文件 (h5py) - 每次保存时都会更改哈希值

> ID：16019656
> 
> 赞同：7
> 
> 时间：2013-04-15T15:59:06.140
> 
> 标签：python, hdf5, h5py

我正在使用 h5py 将来自数值工作的中间数据存储在 HDF5 文件中。我的项目处于版本控制之下，但这不适用于 HDF5 文件，因为每次重新运行生成 HDF5 文件的脚本时，即使其中的数据没有，二进制文件也会更改。

这是一个小例子来说明这一点：

```
In [1]: import h5py, numpy as np

In [2]: A = np.arange(5)

In [3]: f = h5py.File('test.h5', 'w'); f['A'] = A; f.close()

In [4]: !md5sum test.h5
7d27c258d94ed5d06736f6d2ba7c9433  test.h5

In [5]: f = h5py.File('test.h5', 'w'); f['A'] = A; f.close()

In [6]: !md5sum test.h5
c1db5806f1393f2095c88dbb7efeb7d3  test.h5

In [7]: # the file has changed but still contains the same data! 
```

我查看了 HDF5 文件格式文档和 h5py 文档，但没有找到任何对我有帮助的东西。我的问题是：

1.  即使我保存相同的数据，为什么文件会更改？

2.  我怎样才能停止它的变化，所以版本控制只会在实际数字内容发生变化时看到文件的新版本？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-23T12:59:43.070

HDF5 文件同时使用抽象数据模型和抽象存储模型。这意味着文件在磁盘上的存储方式可能（并且通常是）完全不同于它在程序中的表示方式。可以以不止一种方式存储完全相同的数据，而这对您的程序来说并不明显。

[HDF5 文件格式存储规范](http://www.hdfgroup.org/HDF5/doc/H5.format.html#V2ObjectHeaderPrefix)允许在数据对象标头中使用多个时间戳。这些不作为属性存储，因此通常不能被高级 API 访问。可以使用低级 HDF5 API 关闭写入这些时间戳，但不清楚相关功能是否在 h5py 中。[这个 github 问题](https://github.com/h5py/h5py/issues/225)似乎正是您想要的，但不幸的是它仍然是开放的。

# jquery - 如何使用 JsAction 从 json 数据中获取价值？

> ID：16019661
> 
> 赞同：1
> 
> 时间：2013-04-15T15:59:19.530
> 
> 标签：jquery, asp.net-mvc, razor, asp.net-mvc-4

如何使用 JsAction 获取 Json 值？如何获得名字？我想显示 Json 值的任何值。

控制器：

```
 [JsAction()]
        [HttpGet]
        public JsonResult GetStudent(int a)
        {

            Student st =   new Student() { firstName = "yusuf", lastName = "karatoprak", SumHere = 5 };
            return Json(st, JsonRequestBehavior.AllowGet);
        } 
```

看法：

```
 $(document).ready(function () {
        JsActions.Home.MyTestMethod(1, 2).then(function (data) { alert(data); });
        JsActions.Home.MyTestMethod2(4, 5).then(function (data) { alert(data); });
        JsActions.Home.Yusuf(67, 9).then(function (data) { alert(data.toString()); });
        var ret = JsActions.Home.GetStudent(6);

        alert(ret.firstName);

        console.log(ret.firstName);

    }) 
```

但我无法访问名字。我看到一些代码形式的codeplex：

![在此处输入图像描述](https://i.stack.imgur.com/Z0cRQ.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T16:21:17.403

```
 $(document).ready(function () {
        //JsActions.Home.MyTestMethod(1, 2).then(function (data) { alert(data); });
        //JsActions.Home.MyTestMethod2(4, 5).then(function (data) { alert(data); });
        //JsActions.Home.Yusuf(67, 9).then(function (data) { alert(data.toString()); });
// old var ret = JsActions.Home.GetStudent(6)
// new one
        var ret = JsActions.Home.GetStudent(6).responseText;

        alert(ret.firstName);

        console.log(ret.firstName);

    }) 
```

注意：您的控制器只是谈到 GetStudent 方法，所以我评论了其他方法调用。

# c# - 参考未在空行设置错误

> ID：16019668
> 
> 赞同：0
> 
> 时间：2013-04-15T15:59:35.220
> 
> 标签：c#, arrays, split, streamreader

当我从文件中读取并且文件有一个空行时，我收到此错误，我希望循环在空行处停止，但我收到此错误，我该怎么做？

```
string[] delim = new string[] { "," };
bool eof=false;
int k=0;
do
{
   string[] linie =  sr.ReadLine().Split(delim, StringSplitOptions.None);

   if (String.IsNullOrWhiteSpace(linie[0]))
      eof = true;
   else
   {
      A[k] = double.Parse(linie[0]);
      l[k] = Convert.ToInt32(linie[1]);
      c[k] = Convert.ToInt32(linie[2]);
   }
   k++;
 }
 while (!eof); 
```

错误在这里：`string[] linie = sr.ReadLine().Split(delim, StringSplitOptions.None);`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T16:01:52.900

将您的语句分成多行：

```
String line = sr.ReadLine();
if (!String.IsNullOrEmpty(line))
{
    string[] linie = line.Split(delim, StringSplitOptions.None);
    //The rest of your code
} 
```

正如 Jeff 指出的那样，如果你有 > .Net4 那么你可以使用`IsNullOrWhiteSpace`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T16:03:01.170

当您到达文件末尾时，`sr.ReadLine()`返回`null`. 因此，当您尝试拆分时`null`，您会得到一个`NullReferenceException`.

在进行拆分之前，您应该检查 null。

另一种组织你的方法可能是：

```
string line;
while ((line = sr.ReadLine()) != null)
{
} 
```

# jakarta-ee - 如何在 Glassfish 的 EAR 中更快地测试 WAR 代码？

> ID：16019669
> 
> 赞同：1
> 
> 时间：2013-04-15T15:59:40.503
> 
> 标签：jakarta-ee, maven, glassfish, war, ear

我们拥有一个作为 EAR 部署给客户的企业应用程序。在这个客户端中，有一个 web-app 模块，我们的 web 开发者希望在没有完整 EAR 重新部署的情况下对其进行测试，这（作为记录）意味着以下步骤

1.  将 webapp 打包成一场战争
2.  将战争包装在耳边
3.  在 Glassfish 中完全安装 ear（使用所有 EJB、Web 服务，......重新部署）

这些步骤由 maven 驱动，并且由于各种测试，通常需要大约 200 万。这是一个很长的延迟。但是，我们如何为 Web 开发减少它呢？JRebel 已尝试过，但结果喜忧参半：大多数情况下它都可以正常工作，但在某些（我没有调查过）情况下，它也可能会阻止开发人员。

我曾考虑过允许将战争与 EAR 分开安装，但我想这可能会引入更大的开发工作。

是否可以通过将 webapp 文件夹链接到 Glassfish hotdeploy one 来允许自动重新部署代码？

**编辑 1**显然，我的 WAR Web 组件确实依赖于 EJB 和 EAR 的一些库。在这种情况下，如何快速部署/自动部署该 WAR ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T09:21:25.043

为什么每次都要用maven重新打包war和ear？您使用 eclipse 的动态 Web 项目吗？（其实我不知道它是否符合你的要求，你可能已经很了解了，但没有足够的声誉来询问细节）。

**使用 maven 生成一个草稿 WEBAPP**

mvn archetype:generate -DgroupId=org.yourgroup -DartifactId=MavenTestWebapp -DarchetypeArtifactId=maven-archetype-webapp

```
MavenTestWebapp
 |
 \--- JavaSources
 |     \MyClass.java
 |
 \--- War
 |    | ---(pom.xml)
 |    \ --- src
 |          \ --- main
 |                \ --- webapp
 |                      | --- META-INF
 |                      \ --- WEB-INF
 |
 \(pom.xml) 
```

War 目录是项目的一个模块。我添加了一个 JavaSources 目录以使其清晰。我还在 War 目录中添加了一个 pom.xml，以便处理来自父项目的依赖库。以下是 War 目录中 pom 的示例：

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <parent>
        <groupId>org.yourgroup</groupId>
        <artifactId>MavenTestWebapp</artifactId>
        <version>1.0-SNAPSHOT</version>
        <relativePath>../pom.xml</relativePath>
    </parent>

    <groupId>${project.parent.groupId}</groupId>
    <artifactId>${project.parent.artifactId}-war</artifactId>
    <name>${project.parent.artifactId}-war</name>
    <packaging>war</packaging>
    <version>1.0-SNAPSHOT</version>
    <url>http://maven.apache.org</url>
    <build>
        <finalName>MavenTestWebapp-war</finalName>
        <plugins>
            <plugin>
                <artifactId>maven-war-plugin</artifactId>
                <version>2.1.1</version>
                <executions>
                    <execution>
                        <phase>compile</phase>
                        <goals>
                            <goal>inplace</goal>
                        </goals>
                    </execution>
                </executions>
                <configuration>
                    <archiveClasses>true</archiveClasses>
                    <warSourceDirectory>${basedir}/src/main/webapp/</warSourceDirectory>
                    <dependentWarExcludes>
                        WEB-INF/classes/,META-INF/**,WEB-INF/web.xml,**/*.jar,pom.xml
                    </dependentWarExcludes>
                    <warSourceExcludes>/src/main/webapp/,target/,WEB-INF/classes/**/*.*</warSourceExcludes>
                    <webResources>
                        <resource>
                          <!-- this is relative to the pom.xml directory -->
                          <directory>${basedir}</directory>
                          <!-- the list has a default value of ** -->
                          <includes>
                            <include>pom.xml</include>
                          </includes>
                        </resource>
                    </webResources>
                </configuration>
            </plugin>
        </plugins>
    </build>
</project> 
```

为了收集依赖库，请执行*mvn compile*命令。然后在webapp/WEB-INF目录下创建lib目录。

```
MavenTestWebapp
 |
 \--- JavaSources
 |     \MyClass.java
 |
 \--- War
 |    | ---(pom.xml)
 |    \ --- src
 |          \ --- main
 |                \ --- webapp
 |                      | --- META-INF
 |                      \ --- WEB-INF
 |                            \ --- libs
 |                                  | --- dependency-lib1.jar
 |                                  \ --- dependency-lib2.jar
 |
 \(pom.xml) 
```

这是我们最后一次必须使用 maven，直到我们在真正打包之前运行 junit 测试和其他功能。但是现在，我们应该只需要编译和部署用于测试的 java 类（对吗？）。Eclipse 的动态 Web 项目将允许在 glassfish 上快速重新部署 java 类。

**创建一个动态的 WEB 项目**

在工作区中创建一个新的动态 Web 项目。在 Web 模块配置步骤，将*JavaSources*设置为该项目的 Java 源目录。将*webapp*设置为内容目录。

这个 webapp 包含你的 web 开发人员必须处理、编译和部署的所有类。它还包含一个带有库和编译类的完整战争模块。

**创建一个耳朵**

在工作区中创建一个新的企业应用程序项目。将 webapp 添加为该项目的模块。

**在 glassfish 上部署 EAR**

在服务器视图中，右键单击 glassfish 服务器并添加新创建的包含 MavenTestWebapp Web 模块的 EAR。每次修改 java 类时，将此 EAR 发布到您的服务器。您可以允许自动发布，但这通常很烦人。

**谢谢**

如果有更好的解决方案，如果它可以改进或者它不适合您的项目，请告诉我们。我没有那么多经验，但我以前一直在使用这种配置，它可能适用于快速重新部署您的 java 源。谢谢，@+

# html - 水平 CSS 对齐

> ID：16019672
> 
> 赞同：1
> 
> 时间：2013-04-15T15:59:46.280
> 
> 标签：html, css

有人可以解释我如何将按钮保持在红色区域的中心，无论按钮的宽度如何？

这是我的**演示**：http: [//jsfiddle.net/v3X2k/](http://jsfiddle.net/v3X2k/)

这是我的代码：

```
<div style="width:660px;height:40px;display;block;background:red">

    <div id="wrapper3" style="margin:0 auto;width:160px">

        <button>Test</button>
        <button>Test 2</button>

    </div>

</div>

<hr />

<div style="width:660px;height:40px;display;block;background:red">

    <div id="wrapper3" style="margin:0 auto;width:160px">

        <button>Test Test Test Test Test Test</button>
        <button>Test 2</button>

    </div>

</div> 
```

您可以在第二个示例中看到，第二个按钮位于下方，而实际上我希望它们保持内联，就像上面的那样。

我很高兴放弃该`width:160px`声明，但只需将这些按钮集中对齐即可。

有任何想法吗？

非常感谢 ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T16:03:00.043

您不必使用具有固定宽度和边距自动的包装 div ...只需`text-align: center;`在容器 div 上使用

[**演示**](http://jsfiddle.net/v3X2k/2/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T16:03:32.750

```
text-align: center; 
```

按钮是内联元素，所以这将起作用。

[jsFiddle](http://jsfiddle.net/v3X2k/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T08:57:54.903

有些人称之为不好的做法，我想你必须小心，但你可以使用：
`<center></center>`

（躲在角落里）不要因为我的建议而否决我。

# gwt - GWT 中的环境依赖属性

> ID：16019674
> 
> 赞同：0
> 
> 时间：2013-04-15T15:59:47.250
> 
> 标签：gwt, configuration, production-environment, staging, test-environments

我们有一个 GWT 应用程序，它必须链接另一个应用程序。

此链接在我的应用程序的所有阶段（本地、测试、登台、生产）中都是不同的。有哪些选项可以配置 GWT 应用程序？

目前我们正在为每个环境使用属性文件。这个解决方案的问题是，我们必须为所有环境创建不同的包。这很糟糕，我们想构建一个可部署到所有环境的单个包。

但是我们如何告诉应用程序使用哪个配置呢？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-16T03:38:13.530

**如果你是指环王的粉丝——**

```
One Build to rule them all, One Build to find then,
One Build to work on all and in the environment bind them
In the Land of Testing where the Shadows lie. 
```

## 我们工作区的解决方案

1.  所有环境特定的属性文件都被推送到模板文件夹（log4j_prod.properties、log4j_stage.properties、hibernate.properties 等）
2.  Prod 属性文件是默认文件并推送到 WEB-INF/classes
3.  QA 团队使用任何其他环境的模板文件修改属性文件。

如果以其他方式完成，我也会很好奇:)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-15T18:01:00.017

如果您想知道应用程序在哪种模式下运行的天气，[GWT 类](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/core/client/GWT.html)中有一些静态方法 。

[是客户端（）](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/core/client/GWT.html#isClient%28%29)

> 在正常 GWT 环境中运行时返回 true，无论是开发模式还是生产模式。如果此代码在普通 JVM 中运行，则返回 false。这可能在服务器上运行共享代码时或在 GWTTestCase 测试的引导序列期间发生。

[isProdMode()](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/core/client/GWT.html#isProdMode%28%29)

> 在生产模式下运行时返回 true。在开发模式下运行或在普通 JVM 中运行时返回 false。

[脚本（）](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/core/client/GWT.html#isScript%28%29)

> 确定正在运行的程序是脚本还是字节码。

ETC....

根据 tha 标志，您可以配置属性的文件夹名称

# .net - 如何使用不同的用户凭据打开 Bloomberg 会话

> ID：16019677
> 
> 赞同：2
> 
> 时间：2013-04-15T15:59:56.270
> 
> 标签：.net, bloomberg

如何在不使用 Windows 用户的“受信任的连接”的情况下打开会话？我们有一个可以由多个用户访问的终端。为了防止用户使用 Bloomberg 界面，您需要在 Bloomberg 中输入您自己的用户名和密码。

如果我使用下面 API 中的源...会话将在这台机器上失败。如果我从一台具有与彭博登录匹配的 Windows 身份验证的机器上运行它，它就可以工作。

```
Dim serverHost As String = "localhost"
Dim serverPort As Integer = 8194
' set sesson options
d_sessionOptions = New SessionOptions()
d_sessionOptions.ServerHost = serverHost
d_sessionOptions.ServerPort = serverPort 
```

对于用户名和密码等用户凭据，我需要做什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-10-06T19:20:07.047

简短的回答是……你不能。

包括使用桌面 API 的彭博终端许可仅限于一台机器，即安装和运行彭博终端的机器。（实际上，API 依赖于终端之外的一些程序来运行，但是用户最近登录到终端并且没有在其他地方登录。）

如果您需要访问其他办公桌上的 Bloomberg API，则必须为每个办公桌获得 Bloomberg Terminal 许可证。

# xml - 试图在 xsl 中读取 xml 元素值

> ID：16019678
> 
> 赞同：2
> 
> 时间：2013-04-15T15:59:59.623
> 
> 标签：xml, xslt, xslt-1.0

我是[XSL](http://www.w3.org/Style/XSL/)的新手。我正在尝试使用 XSL 文件读取 XML 元素的值。我的 XML 文件是这样的：

```
<PersonList>
  <Person>
    <Name>person1</Name>
    <Age>21</Age>
  </Person>
  <Person>
    <Name>person2</Name>
    <Age>21</Age>
  </Person>
</PersonList> 
```

我的 XSL 文件如下：

```
<xsl:stylesheet version="1.0" xmlns=...>
  <xsl:output method="xml" indent="yes" encoding="utf-8" omit-xml declaration="no" />
  <xsl template match="/">
    <PersonList>
      <xsl:for-each select="PersonList/Person">
        <Person>
          <xsl:for-each select="*">
            <xsl:variable name="elementName">
              <xsl:value-of select="name(.)" />
            </xsl:variable>
            <xsl:variable name="elementValue">
              ???
            </xsl:variable>
          </xsl:for-each>
        </Person>
      </xsl:for-each>
    </PersonList> 
  </xsl:template>
</xsl:stylesheet> 
```

我应该如何替换`???`以获取存储在`elementName`变量中的元素的值。我分别尝试了以下三行：

```
<xsl:value-of select="value(.)" /> 
<xsl:value-of select="value($elementName)" />
<xsl:value-of select="$elementName" /> 
```

但没有运气。请帮忙！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T18:34:34.337

您`??????????????????`可以是`<xsl:value-of select="."/>`（即上下文元素的字符串值。）它与`$elementName`.

你可以像这样更简洁地做到这一点：

```
<xsl:for-each select="*">
  <xsl:variable name="elementName" select="name()"/>
  <xsl:variable name="elementValue" select="string(.)"/>
</xsl:for-each> 
```

但是你的模板真的很奇怪。您正在收集这些变量，但您没有对它们做任何事情——它们不会出现在输出中。你想得到什么输出？

使用`for-each`通常是代码气味。在几乎所有情况下，您最好使用多个模板：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:output method="xml" indent="yes" encoding="utf-8" omit-xml-declaration="no" />

<xsl:template match="@*|node()">
    <xsl:copy>
        <xsl:apply-templates select="@*|node()"/>
    </xsl:copy>
</xsl:template>

<xsl:template match="Person/*">
    <xsl:variable name="elementName" select="name()"/>
    <xsl:variable name="elementValue" select="string(.)"/>
</xsl:template>

</xsl:stylesheet> 
```

这种复制几乎所有内容并只更改一点点 xml 的模式非常常见且非常强大，您应该[学习如何使用它](http://xmlplease.com/xsltidentity)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T18:31:06.147

好吧，如果您真的想获取名称保存在变量中的元素的值，那么在您的情况下，您可以这样做

```
<xsl:variable name="elementValue">
    <xsl:value-of select="../*[name()=$elementName]" />
</xsl:variable> 
```

但是，这是非常复杂的事情。您处于**xsl:for-each**循环中，遍历**Person**的子元素。因此，因为您已经定位在您想要其值的元素上，您可以这样做而忘记**elementName**变量。

```
<xsl:variable name="elementValue">
    <xsl:value-of select="."/>
</xsl:variable> 
```

实际上，您可以将循环简化为

```
<xsl:for-each select="PersonList/Person">
   <Person>
      <xsl:for-each select="*">
         <xsl:value-of select="." />
      </xsl:for-each>
   </Person>
</xsl:for-each> 
```

# javascript - 现在不推荐使用 Jquery 的 .unload 来取消设置提交按钮文本的正确方法

> ID：16019686
> 
> 赞同：2
> 
> 时间：2013-04-15T16:00:18.260
> 
> 标签：javascript, jquery, html

设置 - 通过 html 提交按钮使用许多标准作为 POST 的大型搜索，在服务器发送第一个字节/结果页面开始加载之前可能需要几秒钟。

[http://api.jquery.com/unload/](http://api.jquery.com/unload/)现在已弃用（从 1.8 版开始），我正在寻找正确的方法来执行以下操作...

当有人点击搜索按钮时，我通过将按钮文本设置为“正在搜索...”来给用户一些反馈，然后允许提交继续（返回 true）：

```
 $('#dosearch').click(function() { 
        $(this).html('<i class="icon-spinner icon-spin"></i> Searching...');
        return true; 
    }); 
```

在卸载期间，我目前正在这样做：

```
 $(window).unload(function() {
        $('#dosearch').html('<i class="icon-search"></i> Search');
    }); 
```

我尝试绑定到 beforeunload，但是一旦提交发生（坏）就会触发，而不是在浏览器开始呈现新页面时触发（好）。

**问题是如果他们单击搜索，然后单击浏览器上的“返回”按钮。** 如果他们这样做，那么 Searching... 文本仍会显示。

做我在这里尝试的正确/正确方法是什么？

注意：（使用 I 标签的原因是我使用了很棒的字体）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T17:15:11.327

绑定一个空的事件处理程序来卸载似乎工作，但它是一种黑客。

```
 $('#dosearch').click(function() { 
        $(this).html('<i class="icon-spinner icon-spin"></i> Searching...');
        return true; 
    });

    $(window).on("load", function(){ 
        $('#dosearch').html('<i class="icon-search"></i> Search'); 
    });

    $(window).on("unload", function(){ 
        // Leave this blank handler here or onload won't fire on IE or FF when you click back button 
    }); 
```

请参阅[此问题](https://stackoverflow.com/questions/158319/cross-browser-onload-event-and-the-back-button)以获取解释。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T16:07:53.390

如果用户回到历史，这意味着它是否将页面呈现为新页面？因此，无论何时加载页面，您都可以将值重置为您想要的值。

那可能是什么？

# ios - objc POST 文件和字符串参数

> ID：16019693
> 
> 赞同：0
> 
> 时间：2013-04-15T16:00:34.363
> 
> 标签：ios, objective-c, http-post

我正在尝试使用 objc 从我的 iPad 应用程序将文件和一些字符串参数发布到我的服务器上的 .ashx 页面。

我找到了很多关于如何使用 objc 发布文件的教程，而且我已经有了发布字符串的代码。但是我不知道如何将两者结合起来，所以我可以在一个 POST 中发送多个值？

谁能帮我举一两个例子？我试图避免使用 3rd 方框架，所以使用 NSURLRequest 的东西会是首选。

谢谢，

麦克风

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T16:17:48.877

您需要使用带有边界字符串等的多部分提交。这里有一些帮助代码：[https](https://github.com/Goles/SimpleHttpRequest) ://github.com/Goles/SimpleHttpRequest来自这个问题的答案：[Sending multipart POST from iOS and reading parameters in PHP $_POST?](https://stackoverflow.com/questions/7738704/sending-multipart-post-from-ios-and-reading-parameters-in-php-post)

# javascript - 带鼠标的 Javascript 步骤事件

> ID：16019694
> 
> 赞同：2
> 
> 时间：2013-04-15T16:00:38.647
> 
> 标签：javascript, jquery, canvas

我是画布的新手，我想知道如何在能够引用鼠标位置的同时获得“步进”事件（例如每半秒执行一次），例如，如果我想每 0.5 次在鼠标位置绘制一些东西第二个独立于鼠标移动。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T16:18:16.710

将新的 HTML5 功能`requestAnimationFrame`与画布一起使用，而不是`setInterval`为了`setTimeout`获得更好的性能。`requestAnimationFrame`例如确保当用户切换到另一个选项卡时，动画会暂停 = 节省 CPU。要支持所有浏览器使用 shim 层，请参见示例：

```
//shim layer
window.requestAnimFrame =
window.requestAnimationFrame       ||
window.webkitRequestAnimationFrame ||
window.mozRequestAnimationFrame    ||
window.oRequestAnimationFrame      ||
window.msRequestAnimationFrame     ||
function(callback) {
    window.setTimeout(callback, 1000 / 60);
};

function animate() {   
       requestAnimFrame( animate );        
       draw();   
    }

function draw()    
    {        
      // handle time interval here
      // actual code here
    } 
```

有关更多信息，请参阅（包括如何处理时间间隔的提示）：

*   [window.requestAnimationFrame mozzila](https://developer.mozilla.org/en-US/docs/DOM/window.requestAnimationFrame)
*   [adobe 烹饪书籍](http://cookbooks.adobe.com/post_HTML5_requestAnimationFrame_simple_example-19747.html)
*   [HTML5 摇滚](http://www.html5rocks.com/en/tutorials/canvas/performance/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T16:03:36.190

您可能想使用`setInterval(yourFunction, delay)`.
'yourFunction' 很好......你的功能和'延迟'是以毫秒为单位的间隔时间。

在您的情况下，这看起来像：

```
//alway's define stuff before you use it
function drawSomething(){ 
    //your code here
}

window.setInterval(drawSomething, 500); //this is your 0.5 sec stepped interval 
```

参见（例如）[MDN](https://developer.mozilla.org/en-US/docs/DOM/window.setInterval)

祝你好运！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-15T16:15:44.887

您将不得不将`mousemove`事件全局绑定到文档正文并将鼠标位置保存到可公开访问的变量中（如`window.mouseX`and `window.mouseY`）。然后在 内`setInterval(function () { ... }, 500);`，您可以检索 和 的`window.mouseX`值`window.mouseY`。

据我所知，除了不断地全局跟踪鼠标的移动之外别无他法，因为 setInterval 不会为您创建带有鼠标数据的事件。

这是别人的例子： [https ://stackoverflow.com/a/4704204/1381550](https://stackoverflow.com/a/4704204/1381550)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-15T16:04:03.207

您可以使用每 0.5 秒检查一次鼠标位置[`setInterval`](https://developer.mozilla.org/en-US/docs/DOM/window.setInterval)

```
setInterval(step, 500);

function step() {
  // do your stuff here
} 
```

该函数`step`将每 0.5 秒执行一次。

# android - 相机拍摄后立即在条形码扫描仪中显示条形码值？

> ID：16019695
> 
> 赞同：0
> 
> 时间：2013-04-15T16:00:42.147
> 
> 标签：android, android-intent, barcode, zxing, barcode-scanner

我试图在扫描后立即显示扫描的条形码值，条形码扫描仪应用程序显示的位置，这样它可能会显示：

```
Found Plain Text - "Insert Barcodevalue here". 
```

是否可以通过意图设置来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T18:14:23.843

这是不可能的，但是，我可以为下一个版本进行此更改，以便它始终显示内容。

# c++ - 改变全局变量

> ID：16019701
> 
> 赞同：0
> 
> 时间：2013-04-15T16:01:05.207
> 
> 标签：c++, global-variables

我在 C++ 中遇到了全局变量的问题。我有一个名为`iDraw()`. 我计划在这里编写两段代码，它们将由一个`global variable`命名的`flag`. 在 main 函数中，如果我设置`flag`为 1 然后调用`iDraw`，则将执行一部分代码；如果我将 flag 设置为 2 然后调用它，那么将执行代码的另一部分。但它没有按预期工作。似乎当我在主函数中更改标志的值时，它不起作用。它仍然保留我最初在程序顶部声明的值。克服它的解决方案是什么？我使用了一个名为`global.h`我声明所有全局变量的头文件。

```
extern int flag=0, animflag=1;
/* 
    function iDraw() is called again and again by the system.
*/
void iDraw()
{
    //place your drawing codes here 
    if(flag==1){
        iClear();
        iSetcolor(0,0,128);
        iShowBMP(0,0, "Images\\intro.bmp");
    }
    if(flag==2){
        //other codes here
    }
}
int main()
{
iInitialize(900, 500, "demooo");
animflag=0;
flag=1; // seems like this line has no impact
iDraw();
return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T17:27:53.640

> 我使用了一个名为 global.h 的头文件，我在其中声明了所有全局变量。

如果您的程序包含多个包含此 global.h 的 .cpp 文件，则存在问题。因为每个 .cpp 文件都有自己的`flag`变量副本，并且更改其中一个不会更改另一个副本。

您必须在 .cpp 文件之一中定义全局变量。在 global.h 中，您可以提供`extern`声明。

```
//*.cpp
int flag = 0;

//global.h
extern int flag; 
```

# javascript - 浏览器窗口关闭检测

> ID：16019703
> 
> 赞同：1
> 
> 时间：2013-04-15T16:01:15.807
> 
> 标签：javascript, jquery

这是让我发疯的事情。

我正在尝试检测用户是否关闭或导航离开页面，以便对事件进行 ajax 响应。我已经尝试了几乎所有可能的方法来调用它，但没有运气。我唯一能想到的是，有问题的激活窗口是使用：`window.open()`方法触发的。这会导致任何问题吗？到目前为止我所拥有的：

```
window.onbeforeunload = function() {
   //ajax stuff here
}; 
```

但是，我注意到页面完全加载后这不起作用。该事件在页面加载期间的前几毫秒内触发（如果我打开窗口并尝试立即关闭它），之后将无法工作。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T16:03:32.360

这也支持旧版本的 IE 和 Firefox。

```
window.onbeforeunload = function (e) {
  var message = "Your confirmation message goes here.",
  e = e || window.event;
  // For IE and Firefox
  if (e) {
    e.returnValue = message;
  }

  // For Safari
  return message;
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T16:09:00.180

我曾经遇到过这个问题，发现只有通过设置`async : false`ajax 才能对我有用，如下所示：

```
jQuery(window).bind('beforeunload', function () {
    jQuery.ajax({
        url: 'your.url',
        async: false,
        data: yourdata
        timeout: 2000 // or whatever timeout in milliseconds you want
        success: function(data){
            // Do whatever you want
        }
    });
}); 
```

正如 Ian 在评论中提到的那样，最好设置一个超时时间，以防止在请求需要一段时间的情况下关闭窗口的时间过长。请记住，它不适用于所有浏览器...

# php - 使用 if_num_rows 的 PHP MySQLi 身份验证与数据库信息不匹配

> ID：16019708
> 
> 赞同：1
> 
> 时间：2013-04-15T16:01:28.513
> 
> 标签：php, authentication, mysqli

我是 PHP / MySql 编程的新手。我买了一本书来帮助学习这门语言，到目前为止我做得很好，除非我尝试创建一个身份验证系统。

我希望能够使用 MD5 加密将记录与数据库匹配，如果找到，则发送到网站。如果用户名和密码不正确，请再次将它们发送到登录页面。

在某一时刻，它只会匹配第一条记录。现在它不会匹配任何东西。我可以准确输入数据库中的内容，结果仍然为 0 或返回登录页面。

此外，我想为用户名和 auth_level 设置一个会话变量，以便我可以在整个网站/应用程序中调用它。

如果有帮助，我将在 Mac 上使用 XAMPP。

授权脚本：

```
if ((!isset($_POST['username'])) || (!isset($_POST['password']))) {
    header('Location: login.html');
    exit;
}

$mysqli = mysqli_connect('localhost', 'username', 'password', 'testDB')
      or die(mysql_error($mysqli));

$username = mysqli_real_escape_string($mysqli, $_POST['username']);
$password = mysqli_real_escape_string($mysqli, $_POST['password']);
$auth_sql ="SELECT username , auth_level FROM auth_users WHERE

username ='".$username."' AND password =MD5('".$password."')";

$auth_sql_res = mysqli_query($mysqli, $auth_sql) or die(mysqli_error($mysqli));

if (mysqli_num_rows($auth_sql_res) == 1) {
    $_SESSION['username'] = $username;
    header('Location: homebeta.php');
} else {
    header("Location:index.php");
    exit;
} 
```

PHP v5.3.1

感谢所有花时间查看、分析和/或帮助的人。我真的很感谢你的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T16:10:53.007

`exit`您在第一次致电后忘记了`header`：

```
header('Location: homebeta.php');
exit; 
```

你在检查 PHP 错误吗？阅读[如何在 PHP 中获取有用的错误消息？](https://stackoverflow.com/q/845021/1409082)了解更多。

我认为您的脚本可能会在开始时输出一些内容，从而阻止发送标头或会话信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T16:49:44.713

尝试这个：

```
if ((!isset($_POST['username'])) || (!isset($_POST['password']))) {
    header('Location: http://www.replacethis.com/login.html');
} else {
    $mysqli = mysqli_connect('localhost', 'username', 'password', 'testDB')
        or die(mysql_error($mysqli));

    $username = mysqli_real_escape_string($mysqli, $_POST['username']);
    $password = mysqli_real_escape_string($mysqli, $_POST['password']);

    $auth_sql = "SELECT `username`, `auth_level`
        FROM `auth_users`
        WHERE `username` = '$username' AND `password` = MD5('$password')";

    $auth_sql_res = mysqli_query($mysqli, $auth_sql)
        or die(mysqli_error($mysqli));

    if (mysqli_num_rows($auth_sql_res) > 0) {
        $_SESSION['username'] = $username;
        header('Location: http://www.replacethis.com/homebeta.php');
    } else {
        header("Location: http://www.replacethis.com/index.php");
        exit;
    }
} 
```

1.  `Else`声明补充说。
2.  你的反引号`SQL query`（只是为了安全起见）
3.  中的绝对 URL `header location`。

并尝试`MD5 hashing`从您的查询中删除并复制 n 将用户名和密码粘贴到您的`HTML-form`然后登录。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-01T17:19:46.853

好吧，您可能没有收到错误消息，因为您使用的是 mysql_error 而不是 mysqli，就像其他所有东西一样，特别是在连接时，有 mysqli_connect_error()。

此外，根据[手册](http://php.net/manual/en/mysqli.connect-error.php/ "手册")，括号内对于 mysqli_connect_error 应该是无效的：

```
$mysqli = mysqli_connect('localhost', 'username', 'password', 'testDB')
  or die(mysqli_connect_error()); 
```

# javascript - Backbone View 属性返回未定义

> ID：16019711
> 
> 赞同：0
> 
> 时间：2013-04-15T16:01:34.933
> 
> 标签：javascript, backbone.js

这是我的看法：

```
define(
    [
        "jquery"
    ,   "underscore"    
    ,   "backbone"
    ,   "eventView"
    ]
,   function($, _, Backbone, EventView) {
        "use strict";

        var TimelineView = Backbone.View.extend({
            tagName: 'div'
        ,   className: 'column'

        ,   _EventViews: {} // Cache event views for reuse

        ,   initialize: function() {
                this.collection.bind('add', this.add);
                this.collection.bind('reset', this.add);
            }

        ,   render: function() {
                return this;
            }

            // Listen for additions to collection and draw views
        ,   add: function(model) {
                var eventView = new EventView({
                    model: model
                });

                // Cache the event
                console.log(this._EventViews);
                this._EventViews[model.get('id')] = eventView;

                // Draw event
                eventView.render(); 
            }
        });

        return TimelineView
    }
); 
```

如您所见，我将`_EventViews`属性设置为包含一个空对象。但是，当我调用该`add()`函数`console.log(this._EventViews)`时返回 undefined 并且以下语句失败。

谁能告诉我这是为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T16:17:04.093

问题是，在`add`，`this`不是您的 TimelineView。有关 javascript 上下文的说明，请参阅本文：[https ://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/this](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/this)

您可以通过几种不同的方式解决此问题。这种情况下最简单的就是使用`bind`or的第三个参数`on`（这两个是一样的）。

```
initialize: function() {
            this.collection.on('add', this.add, this);
            this.collection.on('reset', this.add, this);
        } 
```

或`listenTo`改为使用。

```
initialize: function() {
            this.listenTo(this.collection, 'add', this.add);
            this.listenTo(this.collection, 'reset', this.add);
        } 
```

此外，您的`_EventViews`缓存将由`TimelineView`. 如果这不是您想要的，请`initialize`改为创建它。

```
initialize: function() {
            this._EventViews = {};
            this.listenTo(this.collection, 'add', this.add);
            this.listenTo(this.collection, 'reset', this.add);
        } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T16:12:47.947

这个对我有用：

```
<script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
<script src="http://underscorejs.org/underscore-min.js"></script>
<script src="http://backbonejs.org/backbone.js"></script>
<script>

var TimelineView = Backbone.View.extend({
    tagName: 'div'
,   className: 'column'

,   _EventViews: {} // Cache event views for reuse

,   initialize: function() {
        //this.collection.bind('add', this.add);
        //this.collection.bind('reset', this.add);
    }

,   render: function() {
        return this;
    }

    // Listen for additions to collection and draw views
,   add: function(model) {
        var eventView = ({
            model: model
        });

        // Cache the event
        console.log(this._EventViews); // Prints: Object {}
        this._EventViews[model.get('id')] = eventView;

        // Draw event
        eventView.render();
    }
});

var a = new TimelineView();
a.add();

</script> 
```

我认为问题在于该`.add()`方法是从集合`add`事件中调用的。当您添加一个侦听器（在主干中完成该`.bind()`功能）时，您必须`bind`（按本机含义）该功能：

```
_.bindAll(this, 'add'); 
```

或者

```
this.add = this.add.bind(this); 
```

在将函数添加为侦听器之前，您必须这样做：

```
initialize: function() {
    _.bindAll(this, 'add');
    this.collection.bind('add', this.add);
    this.collection.bind('reset', this.add);
} 
```

# html - Html 电子邮件单元格填充帮助

> ID：16019712
> 
> 赞同：0
> 
> 时间：2013-04-15T16:01:39.343
> 
> 标签：html, html-table, html-email, campaign-monitor

需要帮助为此电子邮件的主体文本添加填充，以便文本看起来不会太紧到边界。

这可能是一个简单的解决方案，但我无法确定将单元格填充属性添加到哪个表。

现场版-> [http://garyrevell.co.uk/mercy2013/2013-temp/alt-april-mailer/index-purple-final.html](http://garyrevell.co.uk/mercy2013/2013-temp/alt-april-mailer/index-purple-final.html)

代码的 Pastebin -> [http://pastebin.com/PAbYgqXN](http://pastebin.com/PAbYgqXN)

帮助将是非常合适的。

 `* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T21:56:34.237

始终在内容所在的表格单元格中添加填充。例如：

```
<td style="padding:30px;">
<singleline>your content</singleline>
</td> 
```

看起来您的内容却位于 div 中的表格之外。您应该丢失 div 并将所有内容放入 td 部分。此外，在父 td 内的文本旁边没有表格，而是为每个表格单元格（如果堆叠它们，请使用表格行）。`

# javascript - 表单不验证 - javascript

> ID：16019719
> 
> 赞同：1
> 
> 时间：2013-04-15T16:01:51.820
> 
> 标签：javascript, html, forms, validation

有点带有表单验证的菜鸟。我试图让这个表格在必填字段上进行验证，但有些不对劲。这是我正在使用的：

html:

```
<form action="../visit/thankyou.html" method="post" id="vsurvey">
    <input type="hidden" name="id" value="503" />
    <fieldset>
        <legend>Group and Coordinator Information</legend>
        <label><span>Group Leader Name<span style="color:#cc2d30">*</span></span>
            <input type="text" name="question_8149" />
        </label>
        <label><span>Email<span style="color:#cc2d30">*</span></span>
            <input type="text" name="question_8155" />
        </label>
        <label><span>Phone<span style="color:#cc2d30">*</span></span>
            <input type="text" name="question_8156" />
        </label>
        <label><span>School/Organization<span style="color:#cc2d30">*</span></span>
            <input type="text" name="question_8159" />
        </label>
        <label><span>Program</span>
            <input type="text" name="question_8180" />
        </label>
        <label><span>Grade(s)</span>
            <input type="text" name="question_8181" />
        </label>
        <label><span>Number of Participants<span style="color:#cc2d30">*</span></span>
            <input type="text" name="question_8182" />
        </label>
    </fieldset>
    <fieldset>
        <label><span>Preferred Date<span style="color:#cc2d30">*</span></span>
            <input class="date" type="text" id="question_8185" name="question_8185" />
        </label>
        <label><span>Second Preference Date<span style="color:#cc2d30">*</span></span>
            <input class="date" type="text" id="question_8186" name="question_8186" />
        </label>
        <label><span>Third Preference Date<span style="color:#cc2d30">*</span></span>
            <input class="date" type="text" id="question_8187" name="question_8187" />
        </label>
        <label>Special Accommodations
            <input type="text" name="question_8174" />
        </label>
    </fieldset>
    <label>What is the purpose or desired outcome of this visit?
        <textarea name="question_13026"></textarea>
    </label>
    <label>How did you learn about our Group Visit Program?
        <textarea name="question_8176"></textarea>
    </label>
    <label>Comments
        <textarea name="question_8184"></textarea>
    </label>
    <input type="submit" id="sbutton" value="Submit Request" />
</form> 
```

js：

```
function validateForm() {
    var x = document.forms["vsurvey"]["question_8149"].value;
    if (x == null || x == "") {
        alert("Please fill in the Group Leader's name.");
        return false;
    }

    var x = document.forms["vsurvey"]["question_8155"].value;
    if (x == null || x == "") {
        alert("Please fill in the email field.");
        return false;
    }

    var x = document.forms["vsurvey"]["question_8156"].value;
    if (x == null || x == "") {
        alert("Please fill in the phone field.");
        return false;
    }

    var x = document.forms["vsurvey"]["question_8159"].value;
    if (x == null || x == "") {
        alert("Please fill in the School/Organization field.");
        return false;
    }

    var x = document.forms["vsurvey"]["question_8182"].value;
    if (x == null || x == "") {
        alert("Please indicate the number or participants.");
        return false;
    }

    var x = document.forms["vsurvey"]["question_8185"].value;
    if (x == null || x == "") {
        alert("Please enter your preferred date.");
        return false;
    }

    var x = document.forms["vsurvey"]["question_8186"].value;
    if (x == null || x == "") {
        alert("Please enter your second date preference.");
        return false;
    }

    var x = document.forms["vsurvey"]["question_8187"].value;
    if (x == null || x == "") {
        alert("Please enter your third date preference.");
        return false;
    }
} 
```

[http://jsfiddle.net/blackessej/9a6BJ/1/](http://jsfiddle.net/blackessej/9a6BJ/1/)

目前，表单无论如何都会提交信息，但如果未提交所有必填字段，则不会将用户发送到感谢页面。如果提交了所有必填字段，则会调用感谢页面。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T16:06:59.377

您没有调用 validatorForm。您的输入按钮需要如下

```
<input type="submit" id="sbutton" value="Submit Request" onclick="return validateForm()" /> 
```

或使用表单的 onsubmit 事件

```
<form action="../visit/thankyou.html" method="post" id="vsurvey" onsubmit="return validateForm()"> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-15T16:06:40.047

您需要创建一个 onSubmit 事件来调用 validateForm：

```
document.getElementById('vsurvey').onsubmit = validateForm; 
```

# c# - 将 JSON 对象反序列化为 C# 列表

> ID：16019729
> 
> 赞同：8
> 
> 时间：2013-04-15T16:02:14.773
> 
> 标签：c#, json, list, json.net, deserialization

我正在尝试使用[Bill Reiss 的教程](http://www.billreiss.com/making-json-web-requests-easier-with-async-and-await/)在 C# 中反序列化给定的 JSON 文件。对于非列表中的 XML 数据，此方法效果很好，但我想反序列化具有以下结构的 JSON 文件：

```
public class Data
{
    public string Att1 { get; set; }
    public string Att2 { get; set; }
    public string Att3 { get; set; }
    public string Att4 { get; set; }
}

public class RootObject
{

public List<Data> Listname { get; set; }
} 
```

我的问题是使用 JSON.Net 的能力来创建/将数据放入列表，然后在 XAML 页面上显示列表。到目前为止我的想法（这是行不通的）：

```
var resp = await client.DoRequestJsonAsync<DATACLASS>("URL");
string t = resp.ToString();
var _result = Newtonsoft.Json.JsonConvert.DeserializeObject<List<DATACLASS>>(t);
XAMLELEMENT.ItemsSource = _result; 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-04-15T16:19:34.467

所以我认为你可能试图反序列化为错误的类型。如果您将其序列化为 RootObject 并尝试反序列化为 List 它将失败。

请参阅此示例代码

```
public void TestMethod1()
    {
        var items = new List<Item>
                        {
                            new Item { Att1 = "ABC", Att2 = "123" }, 
                            new Item { Att1 = "EFG", Att2 = "456" }, 
                            new Item { Att1 = "HIJ", Att2 = "789" }
                        };
        var root = new Root() { Items = items };
        var itemsSerialized = JsonConvert.SerializeObject(items);
        var rootSerialized = JsonConvert.SerializeObject(root);

        //This works
        var deserializedItemsFromItems = JsonConvert.DeserializeObject<List<Item>>(itemsSerialized); 

        //This works
        var deserializedRootFromRoot = JsonConvert.DeserializeObject<Root>(rootSerialized); 

        //This will fail.  YOu serialized it as root and tried to deserialize as List<Item>
        var deserializedItemsFromRoot = JsonConvert.DeserializeObject<List<Item>>(rootSerialized);

        //This will fail also for the same reason 
        var deserializedRootFromItems = JsonConvert.DeserializeObject<Root>(itemsSerialized);
    }

class Root
{
    public IEnumerable<Item> Items { get; set; } 
}

class Item
{
    public string Att1 { get; set; }
    public string Att2 { get; set; }
} 
```

编辑：添加了完整的代码。

# ruby - File.delete 上的 Ruby (Errno::EACCES) - 以前的解决方案不起作用

> ID：16019739
> 
> 赞同：0
> 
> 时间：2013-04-15T16:02:55.130
> 
> 标签：ruby, chmod, delete-file

我遇到的问题与此问题的发帖人完全相同： [Ruby (Errno::EACCES) on File.delete](https://stackoverflow.com/questions/6537403/ruby-errnoeacces-on-file-delete)。与他不同的是，为他提供的解决方案中的更改对我不起作用。

这是我的代码，它是一种压缩算法，我想删除原始文件：

```
uncompressed_file = File.new(Rails.root + filepath)
compressed_file = File.new(Rails.root + "#{filepath[0..filepath.size - 1]}.gz", "w+b")
file_writer = Zlib::GzipWriter.new(compressed_file)

buf = ""
File.open(uncompressed_file, "rb") do | uncompressed |
  while uncompressed.read(4096, buf)
    file_writer << buf
  end
  file_writer.close
end    

begin      
  files_changed_by_chmod = File.chmod(0777, uncompressed_file)
rescue
  puts "Something happened"
end    
puts "Number of files changed by CHMOD : " + files_changed_by_chmod.to_s
File.delete(uncompressed_file)
File.rename(Rails.root + "#{filepath[0..filepath.size - 1]}.gz", Rails.root + filepath) 
```

您会注意到那里有一对夫妇`puts`来确认 chmod 发生了什么。输出是这样的：

`Number of files changed by CHMOD : 1`

而且没有`Something happened`。因此运行 chmod 不会产生错误，并且 chmod 确实修改了一个文件（大概是`uncompressed_file`.）但是，我仍然在删除行上收到 Errno::EACCESS 错误。

为什么我不能删除文件？！它把我逼到了墙角。我正在运行 Windows 8 和 ruby​​ 1.9.3。

**编辑：**下面的第一个答案解决了无法删除文件的问题；但是，它使我的代码尝试执行的工作无效（即，当我的文件通过解决方案中提供的压缩算法然后我的其他算法运行时，文件返回损坏）。是的，我也曾尝试在我的通货膨胀方法中模仿这里的编码风格，但这并没有帮助。以下是对我的文件执行加密、解密和解压缩的其余代码：

```
def inflate_attachment(filepath)
    compressed_file = File.new(Rails.root + filepath)

    File.open(compressed_file, "rb") do | compressed |
      File.open(Rails.root + "#{filepath[0..filepath.size - 7]}_FULL.enc", 'w+b') do | decompressed |
        gz = Zlib::GzipReader.new(compressed)
        result = gz.read
        decompressed.write(result)
        gz.close
      end
    end
  end

def encrypt_attachment(filepath, cipher)
    unencrypted_file = File.new(Rails.root + filepath)     
    encrypted_file = File.new(Rails.root + "#{filepath[0..filepath.size - 1]}.enc", "w")

    buf = ""
    File.open(encrypted_file, "wb") do |outf|
      File.open(unencrypted_file, "rb") do |inf|
        while inf.read(4096, buf)
          outf << cipher.update(buf)
        end
        outf << cipher.final
      end
    end
  end

def decrypt_attachment(filepath, key, iv)
    cipher = OpenSSL::Cipher.new(ENCRYPTION_TYPE)
    cipher.decrypt
    cipher.key = key
    cipher.iv = iv

    encrypted_file = File.new(Rails.root + filepath)  
    decrypted_file = File.new(Rails.root + "#{filepath[0..filepath.size - 5]}.dec", "w")

    buf = ""
    File.open(decrypted_file, "wb") do |outf|
      File.open(encrypted_file, "rb") do |inf|
        while inf.read(4096, buf)
          outf << cipher.update(buf)
        end
        outf << cipher.final
      end
    end
  end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T16:54:49.063

我认为这可能与您没有正确关闭文件有关。我冒昧地重写了你的代码，没有 chmod 的东西（我认为没有必要）

```
filename = <your sourcefilename goes here>
filename_gz = filename + ".gz"

filepath = Rails.root + filename
filepath_gz = Rails.root + filename_gz

# gzip the file
buffer = ""
File.open(filepath) do |file|
  Zlib::GzipWriter.open(filepath_gz) do |gz|
    while file.read(4096, buffer)
      gz << buffer
    end
  end
end

# moves the filepath_gz to filepath (overwriting the original file in the process!)
FileUtils.mv(filepath_gz, filepath) 
```

如您所见，我使用了 File.open(path) 并传递了一个块。这具有在块退出时自动关闭文件的效果。我还更改了删除/重命名代码，以简单地将 gzip 文件移动到原始路径，这具有相同的效果。

但是，我强烈建议您保留原始文件的备份。

# java - 嵌套事务模板

> ID：16019740
> 
> 赞同：4
> 
> 时间：2013-04-15T16:02:55.890
> 
> 标签：java, spring, jdbctemplate, spring-jdbc, spring-transactions

我有两种方法可以执行以下操作：

```
void withdraw(int amount) {
    transactionTemplate.execute(new TransactionCallback() {
        @Override
        public Object doInTransaction() { ... }
    }
}

void deposit(int amount) {
    transactionTemplate.execute(new TransactionCallback() {
        @Override
        public Object doInTransaction() { ... }
    }
} 
```

现在我想定义在同一个事务中同时执行的第三种方法：

```
void transferTo(Account other, int amount) {
    transactionTemplate.execute(new TransactionCallback() {
        @Override
        public Object doInTransaction() {
            withdraw(amount);
            other.deposit(amount);
            return null;
        }
    }
} 
```

事务传播设置为 REQUIRED（默认）。

用例很明显，如果独立调用，我希望withdraw() 和 deposit() 在它们自己的事务中运行。但是，如果我调用 transfer()，我希望所有语句都在同一个事务中运行。

但是，当我运行 transfer() 时，出现以下异常：

```
Caused by: java.lang.IllegalStateException: Already value [org.springframework.jdbc.datasource.ConnectionHolder@e4b2ed] for key [org.apache.tomcat.dbcp.dbcp.BasicDataSource@26cc37d2] bound to thread [http-bio-8084-exec-13]
    at org.springframework.transaction.support.TransactionSynchronizationManager.bindResource(TransactionSynchronizationManager.java:189)
    at org.springframework.jdbc.datasource.DataSourceTransactionManager.doBegin(DataSourceTransactionManager.java:234) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T17:08:58.857

好吧，我发现了问题...并不是真正解决我的问题，而是解释了为什么我会收到错误。

我使用的事务管理器是 **org.springframework.ldap.transaction.compensating.manager.ContextSourceAndDataSourceTransactionManager**因为我还需要执行一些 LDAP 相关的操作。

唯一的问题是**ContextSourceAndDataSourceTransactionManager**不支持嵌套事务。

因此嵌套的 transactionTemplate 调用将失败......不方便。

编辑：进一步调查表明**ContextSourceTransactionManager**也不支持嵌套事务。

# php - 如何使用 AJAX 和 php 更新表单选项

> ID：16019756
> 
> 赞同：0
> 
> 时间：2013-04-15T16:03:46.070
> 
> 标签：php, ajax, forms, multidimensional-array

所以我有一个像这样的二维数组：

```
$types = array(
    'type1' => array('AA', 'AB', 'AC'),
    'type2' => array('BA', 'BB', 'BC')
); 
```

我想创建两个表单选择：1 具有类型选择（'type1'、'type2' 等），第二个是值选择（'AA'、'AB' 等），除了我想要值选择以根据第一个选择自动更改选项。

我正在使用 PHP，这些值严格来自数组（而不是来自数据库）。

有人可以帮助我使用动态填充第二个表单选择所需的 AJAX 和其他代码吗？

* * *

为了向您展示我尝试过的内容，这是我到目前为止编写的代码：

**输入单元格：**

```
$settingCell = $this->Widget->input('sigtypes', array('id' => 'type', 'label' => '', 'options' => array_keys($model::$signalTypeOptions)));
$settingCell .= $this->Widget->input('sigtypevalues', array('label' => '', 'options' => $options)); 
```

**Javascript**

```
$this->Js->get('#type')->event('change',
    $this->Js->request(
            array('controller'=>'utilities','action'=>'updateInput'),
            array('update' => '$("#options")', 'dataExpression' => true, 'data' => '{value: $this.value}'))); 
```

**实用程序控制器：**

```
public function updateInput($value = 0)
{
    $signalTypeOptions = $model::$signalTypeOptions;

    $this->set('options', $signalTypeOptions);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T17:39:05.120

这是适用于我的情况的解决方案。我使用 cakePHP、javascript、JSON 和 AJAX。

```
<?php
$ajaxRequest = $this->Js
    ->request(
           array('controller' => 'Features', 'action' => 'edit'), 
           array('method' => 'get', 'success' => 'changeSelection()') );

$this->Js->buffer( $this->Js->get('#typeSelect')->event('change', $ajaxRequest));
?>

<script>
function changeSelection()
{
var value = $('#typeSelect').val(); // get the value selected in the first dropdown
var div = document.getElementById('sigType'); //div id is sigType
div.innerHTML = '';

    if(value >= 1 && value <= 3) // specifics for my situation, not important
    { 
        //get the array from php, convert to JSON and echo it for use in javascript
        var signalTypeOptions = <?php echo json_encode(array_values($signalTypeOptions) ); ?>;
        var selection = document.createElement('select'); // create the second dropdown

        div.appendChild(selection); // add the second dropdown to the division
        var i = 0;
        // loop through the array to fill the dropdown
        for(optionText in signalTypeOptions[value]) 
        {
            var option = document.createElement('option');
            option.innerHTML = optionText;
            option.value = i;
            i++;
            selection.appendChild(option); // add the option to the dropdown
        }
    }
}
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T18:32:49.163

这是我的答案——它使用 jQuery、AJAX 和 PHP。

请访问[此处](http://danielabbey.co.uk/so/16019756/)查看工作示例。

我希望这是有帮助的：

```
<!DOCTYPE html>
<html>
    <head>
        <script src='http://code.jquery.com/jquery-latest.min.js' type='text/javascript'></script>
        <script type="text/javascript">
            $(document).ready
            (
                function()
                {
                    $('#select1').change
                    (
                        function()
                        {
                            value = $('#select1').val();
                            $.ajax  ({
                                        type: 'GET',
                                        url: 'ajax.php?type='+value,
                                        data: value,
                                        success: function(result)
                                        {
                                            $('#select2').html(result);
                                        }
                                    });
                        }
                    );
                }
            );
        </script>
    </head>
    <body>
        <form id="form1" name="form1">
        <select id="select1" name="select1">
            <option value="">Please select a type..</option>
            <?php
                include('ajax.php');
                foreach($types as $type => $values)
                {
                    echo "<option value=\"$type\">$type</option>";
                }
            ?>
        </select>
        <select id="select2" name="select2" />
    </form>
    </body>
</html> 
```

然后将以下内容另存为`ajax.php`：

```
<?php
    $types = array(
        'type1' => array('AA', 'AB', 'AC'),
        'type2' => array('BA', 'BB', 'BC')
    );
    if(isset($_GET['type']))
    {
        $type = $_GET['type'];
        if(array_key_exists($type, $types))
        {
            foreach($types[$type] as $arrayValue)
            {
                echo "<option>$arrayValue</option>";
            }
        }
    }
?> 
```

# divide - 年租金除以平方英尺显示，带两位小数。（即 1,000.38）

> ID：16019762
> 
> 赞同：-1
> 
> 时间：2013-04-15T16:04:12.283
> 
> 标签：divide, dollar-sign

我试图让年租金显示为两位小数和租金/平方米。英尺也有两位小数。我已经添加了脚本以使这两个字段自动显示美元金额和逗号。

任何帮助，将不胜感激！

```
 <body>

<table border="1" width="620" style="width: 620px; height: 58px">
  <tr>
    <td width="82" align="center" height="16"><font face="Arial" size="2">Sq.
      Ft.</font></td>
    <td width="90" align="center" height="16"><font face="Arial" size="2">Annual
      Rent</font></td>
    <td align="center" height="16" style="width: 104px"><font face="Arial" size="2">&nbsp;
      Rent/Sq. Ft.</font></td>
  </tr>
  <tr>
    <td width="82" align="center"><font face="Arial" size="2">
    <input type="text" name="SF_Tenant1" id="sqft1" OnKeyUp="calcRentSQFTOne()"
  size="10" value="Sq. Ft.:" tabindex="602" class="style4"></font></td>
    <td width="90" align="center"><font face="Arial" size="2"><input type="text"   
   name="AnnualRent_Tenant1" id="annualrent1"  OnKeyUp="calcRentSQFTOne()" size="11" 
    value="Annual Rent:" tabindex="604"></font></td>
    <td align="center" style="width: 104px;"><font face="Arial" size="2">
<input type="text" name="RentSF_Tenant1" id="rentsqft1"  
 readonly="readonly"     size="11"      value="Rent/Sq. Ft.:"      tabindex="605"></font></td>
  </tr>
  </table>
 &nbsp;
  <input type="submit" 
  value="Save" name="Save" tabindex="999" style="font-family:     Arial;            
  font-size: 10pt; width: 65px; height: 29px;"></font></p>
    <script type="text/javascript">
    //calculation script
    function calcRentSQFTOne(){
    SquareFeet1 = document.getElementById("sqft1").value;
    AnnualRent1 = document.getElementById("annualrent1").value;

    document.getElementById("rentsqft1").value =  
                    (AnnualRent1 * 1) 
                                          / (SquareFeet1 * 1);

 }
 //Dollar format
 function formatNumber(number, digits, decimalPlaces, withCommas)
 {
    number       = number.toString();
var simpleNumber = '';

// Strips out the dollar sign and commas.
for (var i = 0; i < number.length; ++i)
{
    if ("0123456789.".indexOf(number.charAt(i)) >= 0)
        simpleNumber += number.charAt(i);
}

number = parseFloat(simpleNumber);

if (isNaN(number))      number     = 0;
if (withCommas == null) withCommas = false;
if (digits     == 0)    digits     = 1;

var integerPart = (decimalPlaces > 0 ? Math.floor(number) : Math.round(number));
var string      = "";

for (var i = 0; i < digits || integerPart > 0; ++i)
{
    // Insert a comma every three digits.
    if (withCommas && string.match(/^\d\d\d/))
        string = "," + string;

    string      = (integerPart % 10) + string;
    integerPart = Math.floor(integerPart / 10);
}

if (decimalPlaces > 0)
{
    number -= Math.floor(number);
    number *= Math.pow(10, decimalPlaces);

    string += "." + formatNumber(number, decimalPlaces, 0);
 }

 return string;
 }

 </script>

 </body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T16:14:05.930

可能有更好的解决方案。四舍五入到两位小数的 hacky 解决方案：

```
return Math.round(input*100)/100; 
```

即，如果要将 10.678 舍入为两位数，则首先乘以 100：得到 1067.8，然后调用 Math.round 得到 1068，然后除以 100 得到 10.68，这是所需的答案。

# java - 如何使宝石在 Jruby 小程序中正常工作？

> ID：16019763
> 
> 赞同：1
> 
> 时间：2013-04-15T16:04:20.470
> 
> 标签：java, applet, jruby, signer

我已经尝试解决这个问题 3 天了，但我根本找不到解决方案。

所以，我已经下载了 Jruby-complete-1.7.3 jar。之后，我尝试使用基本方法安装 gem 'nokogiri'：

```
java -jar jruby-complete-1.7.3 -S gem install nokogiri 
```

此外，我有一个单独的 jar，它是使用 Gem-In-A-Jar 方法创建的。请注意，这个额外的 jar 只是尝试解决以下问题的结果。

在这两种情况下，当我通过 irb 对其进行测试时，它都会显示以下内容：

```
require 'nokogiri'
=> true 
```

现在，当我尝试在我的 Web 应用程序的小程序中使用 jruby jar 时，问题就出现了。具体来说，如果我不尝试访问任何 gem 文件（在这种情况下特别是 nokogiri），我会提到我可以加载 jar 本身并从我的小程序与其交互。但是，要做到这一点，我需要在 jar 上签名。

如果 jar 未签名，则它无法工作，因为我的 Ruby 实例无法创建。签名后，它工作正常。

问题是，一旦对 jar 进行签名，我就会尝试调用之前执行的相同命令，但会出现以下错误：

```
require 'nokogiri'

LoadError: load error: nokogiri/nokogiri -- java.lang.RuntimeException: 
(LoadError) class "nokogiri.EncodingHandler$INVOKDER$s$1$0$get"'s signer
information does not match signer information of other classes in the same
package. 
```

我一直在寻找有关此错误的原因和可能的解决方案，但我无法弄清楚为什么 gem 本身会导致它。在使用 Gem-In-A-Jar 方法时，我确实使用了相同的密钥来签署 gem_jar。

更新：原来我错了。每个安装的 gem 在 lib 目录中都有自己的 jar 文件。这些 jar 需要使用相同的密钥进行签名。完成后，上述问题得到解决。但是，下面的那个仍然存在。

此外，当我尝试在我的网络应用程序中运行它时，我收到以下消息：

```
classpath:/META-INF/jruby.home/lib/ruby/shared/rubygems.rb:396 warning: 
can't canonicalize loaded names due to security restrictions; disabling 
```

我认为这是发生上述错误时抛出的异常，但我不能肯定地说。

我真诚地感谢任何人可以告诉我我做错了什么，或提供有关如何解决它的建议。如果我对问题的表述有误或没有提供足够的信息，请告诉我。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T11:16:58.080

一种解决方案是使用 SDK 工具从每个 Jar 中剥离签名并重新对它们进行数字签名。

# performance - MS Access 2010：使用参数时查询显着减慢

> ID：16019767
> 
> 赞同：3
> 
> 时间：2013-04-15T16:04:30.957
> 
> 标签：performance, ms-access, parameters

我希望以前没有在这里问过这个问题（我确实在这里搜索过，并在谷歌上搜索过答案，但找不到答案）

问题是：我正在使用 MS Access 2010 从链接表中选择记录（表中有数百万条记录）。如果我直接指定条件（例如日期）（例如 date=#1/1/2013#），查询会立即返回。如果我使用参数（添加日期/时间类型的参数并在提示时提供 2013 年 1 月 1 日的值（或某些不同格式的日期），或引用表单中的控件），则查询需要几分钟才能加载。

如果您对可能导致此问题的原因有任何想法，请告诉我。问这样的问题并可能浪费别人的时间，我确实感到难过...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T19:43:35.400

这是一个潜在的答案，我自己不知道，做了一点挖掘。

*如果性能很重要，则可能需要更喜欢动态 SQL，即使由于查询的优化方式而适用于参数查询也是如此。通常，Access 会在保存时为新查询创建计划。**当查询包含参数时，Access 无法知道该参数可能包含什么值，因此必须做出“正确的猜测”**。根据稍后提供的实际值，它可能没问题**或很差，从而导致性能欠佳。**相反，动态 SQL 回避了这一点，因为“参数”被硬编码到临时字符串中，因此使用该值编译新计划，从而保证最佳执行计划。由于在运行时编译新计划非常快，因此动态 SQL 可能会胜过参数查询。*

**来源**： [http ://www.utteraccess.com/wiki/index.php/Parameter_Query#Performance](http://www.utteraccess.com/wiki/index.php/Parameter_Query#Performance)

另外，如果我不得不**猜测**，在您的参数查询中，Access 正在从 Oracle 请求整个表，**然后**使用您的 where 子句进行过滤，但是当指定 WHERE 子句时，它实际上只是加载这些记录并可能使用索引.

至于解决方案，我会在 VBA 中构建您的查询字符串，然后执行它。它使您可以进行注射，但是您可以处理。所以：

不要在 Access 中使用**保存的参数查询对象**，而是尝试执行类似的操作。

```
 dim qr as string
 qr = "SELECT * FROM myTable WHERE myDate = #" & me.dateControl & "#;" 
```

~~'CurrentDb.execute qr, dbFailOnError~~

```
 Docmd.RunSQL qr 
```

或者，正如您回答的那样， `currentdb.openrecordset(qr)` 这将迫使引擎在运行时制定执行计划，而不是保存可能不是最佳的计划。让我知道这是否适合你，我很想看看。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-30T00:56:50.920

当然，上面关于在 Access (JET/ACE) 中使用参数的参考仅适用于访问后端，而不适用于 SQL server 或 oracle 等 ODBC 后端。由于您指出您在此处使用 Oracle，然后创建视图或使用传递查询将并且应该解决此性能问题。但是，不希望将 Access/JET 参数与来自某些基于服务器的系统的数据一起使用——您最好只发送服务器 SQL 字符串，但更好的是使用传递查询。如果结果集需要编辑，那么 PT 查询是只读的，您必须创建一个视图并链接到该视图。

# bash - printf 打印空行

> ID：16019773
> 
> 赞同：-1
> 
> 时间：2013-04-15T16:04:49.520
> 
> 标签：bash

我有一个 bash 脚本，它给我在写入文件时出现问题。

做这个问题真的很简单，这或多或少是脚本中给我带来麻烦的部分：

```
for bin in 0.0_0.10 0.10_0.235
    do
        for i in `seq 0 100`;
        do
            t_start=4403.26853
            printf "%f\n" $tstart >> $bin.txt
        done
    done 
```

结果是包含 100 个空行的文本文件。

如果我更改`%f`为或在任何更改`%s`处加上引号。`$tstart`

我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T16:11:56.243

查看变量名称。t_start 和 tstart：

> t_start=4403.26853
> 
> printf "%f\n" $tstart >> $bin.txt

# android - android-希伯来语中的 sql

> ID：16019774
> 
> 赞同：1
> 
> 时间：2013-04-15T16:04:52.053
> 
> 标签：android, sql, hebrew

我定义了一个sql表：

```
 ...

        customersDB2.execSQL("INSERT INTO " + TABLE_NAME + " Values ( 86, 'This ', 'זה ');");
        customersDB2.execSQL("INSERT INTO " + TABLE_NAME + " Values ( 87, 'most ', 'ביותר ');");
        customersDB2.execSQL("INSERT INTO " + TABLE_NAME + " Values ( 88, 'use ', 'uu ');");

.....

    }
    catch (SQLiteException se ) {
        Log.e(getClass().getSimpleName(), "Could not create records");
    }
} 
```

我在“onCreate”上初始化它：

```
public void onCreate(Bundle savedInstanceState) {
    try {
        customersDB2 =  this.openOrCreateDatabase(  DB_NAME, MODE_PRIVATE, null);

        customersDB2.execSQL("CREATE TABLE " +
                TABLE_NAME +
                " (Block INT," +
                " Name VARCHAR, Street VARCHAR);");
        mFillDbsTable();}
    catch (SQLiteException se ) {
        Log.e(getClass().getSimpleName(), "create/Open the database problem");

    } 
```

我的问题是 c.moveToFirst() 总是返回 false。当我将希伯来语更改为英语时，此问题已解决。我可以修吗？

```
 Cursor c = customersDB2.rawQuery("SELECT *  FROM "    +
            TABLE_NAME +" where Block == 88", null);

    if (c != null ) { // this return true

        if  (c.moveToFirst()) {  //this return false
            do {
                 Toast.makeText(this,"null1",Toast.LENGTH_SHORT).show();
                 name = c.getString(c.getColumnIndex("Name"));
                 street = c.getString(c.getColumnIndex("Street"));

                 results.add(name + ", " + street );
            }while (c.moveToNext());
        }
    } 
```

日志是空的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T19:55:07.390

在运行 oncreate 之后。使用“sqlite manager”或其他工具检查表，以查看表是否实际包含您期望获得的行

# css - 如何使用其他默认样式在样式表中为 IE 编写 CSS

> ID：16019775
> 
> 赞同：2
> 
> 时间：2013-04-15T16:04:53.913
> 
> 标签：css, internet-explorer, responsive-design

我正在使用响应式网站。我已经使用媒体查询来对此负责。基本上，我没有使用任何固定宽度。我使用百分比作为每个 div 的宽度。

这样网站就可以根据浏览器的大小按比例缩放。对于较旧的ie，使用宽度百分比可能会导致问题。由于 ie 9 之前的 ie 不支持媒体查询，所以，我想为那些 ie 构建不可扩展的版本。因为我只提供了很少的代码来实现可伸缩性，所以如果我在我的主样式表中使用默认 CSS 下/在任何地方编写 CSS 代码可以吗？

喜欢在`style.css`：

```
#info {
   width: 13.672%;
   /*if ie9 and lower
   width: 175px;*/
   height: 830px;
   /*if ie9 and lower
   margin-right: 40px;*/
   margin-right: 3.125%;
   float: left;
}

img {
  margin: 0px;
  padding: 0px;
  border: 0px;
  max-width: 100%;
  /*if ie9 and lower
   max-width: inherit*/
  height: auto;
  /*if ie9 and lower
   height: inherit*/
} 
```

我想写那种格式。但是，我不知道正确的格式。请告诉我正确的格式。

再问你一个问题。由于那些版本的 ie 不支持媒体查询，所以元标记

```
<meta name="viewport" content="width=device-width, maximum-scale=1.0, minimum-scale=1.0, initial-scale=1.0" />
<link href="KT2012.css" rel="stylesheet" type="text/css" />
<link href="kt_large.css" rel="stylesheet" type="text/css" />
<link rel="stylesheet" type="text/css" media="only screen and (min-width:50px) and (max-width:500px)" href="kt_small.css" />
<link rel="stylesheet" type="text/css" media="only screen and (min-width:501px) and (max-width:800px)" href="kt_tablet.css" />
<link rel="stylesheet" type="text/css" media="only screen and (min-width:801px) and (max-width:1024px)" href="kt_medium.css" /> 
```

，不要为那些旧版本制造任何问题，不是吗`tablet.css`？`mobile.css`我的意思是我只想在我的主样式表（`KT2012.css`）中编写 IE 特殊 css。我应该在每个样式表（例如 at 等）上编写每个 IE 特殊 css`mobile.css`吗`tablet.css`？如果该设计的基于 css 文件不支持较旧的 ie，那么，如果我为 ie 制作不可扩展的版本，我不会对基于设备/视口的样式表做任何事情，不是吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-15T16:10:30.577

我推荐 HTML5 样板所采用的方法，[由 Paul Irish 在这里概述](http://misteroneill.com/journal/improved-internet-explorer-targeting-through-body-classes/)。基本上，像这样设置您的文档：

```
<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]--> 
```

您现在有适当的类来准确地仅针对某些版本的 IE。您的 CSS 将如下所示：

```
.element { margin-bottom: 20px; }
.lt-ie9 .element { margin-bottom: 10px; } 
```

然后，您可以避免 CSS hack，并且可以将所有内容保存在一个样式表中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T16:14:14.250

一种方法是使用[Conditional Comments](http://www.quirksmode.org/css/condcom.html)。

IE <= 9（是唯一支持它们的浏览器供应商），您可以使用它专门针对任何版本的 IE。例如

```
<!--[if IE 9]>
Special instructions for IE 9 here, for example load a specific CSS file to override rules only for IE 9
<![endif]--> 
```

不过， IE 10 已经[放弃了](http://msdn.microsoft.com/en-gb/library/ms537512%28v=vs.85%29.aspx)对它们的支持。

最近，[HTML5 样板](http://html5boilerplate.com/)引入了一种基于类的方法来避免多个样式表（即 HTTP 调用）问题和条件注释倾向于创建的碎片化 CSS 规则。

# ios - objc_setAssociatedObject 和 objc_getAssociatedObject 的任何陷阱？

> ID：16019782
> 
> 赞同：6
> 
> 时间：2013-04-15T16:05:05.637
> 
> 标签：ios, objective-c, objective-c-runtime

我正在研究向所有`UIView`实例添加属性（在本例中为整数）的方法，无论它们是否是子类。在一个类别中使用`objc_setAssociatedObject()`和`objc_getAssociatedObject()`是苹果认可的适当方式吗？

我听说这会构成“运行时黑客攻击”，并可能导致难以追踪和调试的问题。有没有其他人见过这种类型的问题？有没有更好的方法来为所有`UIView`实例添加一个整数属性而不进行子类化？

**更新：**我不能只使用`tag`，因为这需要在已经`tag`用于其他事情的代码库中使用。相信我，如果我能用`tag`这个，我会的！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-15T16:13:47.187

每当您想在类上伪造 ivar 时，关联对象就会派上用场。它们非常通用，因为您可以将任何对象与该类相关联。

也就是说，您应该明智地使用它，并且只用于子类化感觉很麻烦的小事情。

但是，如果您唯一的要求是向所有`UIView`实例添加一个整数，`tag`那么就是要走的路。它已经存在并可供您使用，因此无需在运行时修补`UIView`.

如果你想用比整数更多的东西来标记你`UIView`的东西，比如通用对象，你可以定义一个如下所示的类别。

## UIView+标记.h

```
@interface UIView (Tagging)
@property (nonatomic, strong) id customTag;
@end 
```

## UIView+标签.m

```
#import <objc/runtime.h>

@implementation UIView (Tagging)
@dynamic customTag;

- (id)customTag {
    return objc_getAssociatedObject(self, @selector(customTag));
}

- (void)setCustomTag:(id)aCustomTag {
    objc_setAssociatedObject(self, @selector(customTag), aCustomTag, OBJC_ASSOCIATION_RETAIN_NONATOMIC);
}

@end 
```

Erica Sadun 最近在这篇[博](http://www.tuaw.com/2013/04/10/devjuice-better-objective-c-associated-objects/)文中提出了使用属性选择器作为键的技巧。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-04-15T16:07:54.237

使用`tag`. 这就是它的目的。

# c# - 如何按上次在 asp.net-webpages 中修改的日期顺序对 .GetFiles() 中的字符串数组进行排序？

> ID：16019791
> 
> 赞同：2
> 
> 时间：2013-04-15T16:05:33.523
> 
> 标签：c#, xml, linq, sorting, asp.net-webpages

我在这里看到了一个非常接近的例子：

[按日期排序文件](https://stackoverflow.com/questions/5049202/sorting-files-by-date)

但我是 LINQ 的新手，无法让它工作（不确定我是否理解 DirectoryInfo 或 FileInfo 类）。

**以下是必要的代码片段：**

（分配数组时）：

```
string[] files = Directory.GetFiles(Server.MapPath("~/User_Saves/" + WebSecurity.CurrentUserName), "*.xml");

for(int i = 0; i < files.Length; i++)
{
    files[i] = files[i].Substring(files[i].LastIndexOf("\\") + 1);
    files[i] = files[i].Substring(0, files[i].Length - 4);
} 
```

（最后一部分，即“for 循环”，只是简单地从字符串中删除文件的路径和唯一预期的文件扩展名，即“.xml”，只留下干净的文件名）。

（写入数组时）：

[回答这个问题可能不需要这个片段，但以防万一]

```
@foreach(string file in files)
{
    <p>
        <button title="Permanently delete the requisition named, &quot;@file&quot" type="button" id="@file" class="fileDelBtn">DEL</button>&nbsp;<span style="color: #000;">~</span>&nbsp;<span id="@file" class="listFile">@file</span>
    </p>
    hasSavedFiles = true;
} 
```

**我尝试过的事情：**

```
string [] files = new DirectoryInfo(Server.MapPath("~/User_Saves/" + WebSecurity.CurrentUserName)).GetFiles().OrderBy(files => files.LastWriteTime).ToArray; 
```

由于此错误而失败：CS0136：无法在此范围内声明名为“文件”的局部变量，因为它会给“文件”赋予不同的含义，“文件”已在“父或当前”范围中用于表示其他内容

一方面，我一生都无法理解 lambda 运算符，即使看过这里：http: [//msdn.microsoft.com/en-us/library/bb311046.aspx](http://msdn.microsoft.com/en-us/library/bb311046.aspx) （仅对此进行澄清，将是非常感谢，但无论如何都不是主要问题）。

其次，使用这个例子，我知道 DirectoryInfo() 没有带 2 个参数的重载，所以我可能会失去“获取”只有“*.xml”文件的能力，我想保留这些文件，但可能不是绝对的必要的。

与往常一样，非常感谢任何帮助，如果任何进一步的信息对您有帮助，请不要犹豫。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-15T16:09:54.930

```
var filesInOrder = new DirectoryInfo(path).GetFiles()
                        .OrderByDescending(f => f.LastWriteTime)
                        .Select(f => f.Name)
                        .ToList(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T16:33:14.993

如果您不想立即枚举文件，则可以这样做。

```
public static IEnumerable<string> GetXmlFilesByLastWriteTime(string path)
{
    var directoryInfo = new DirectoryInfo(path);
    if(!directoryInfo.Exists) return Enumerable.Empty<string>();

    var query = 
        from file in directoryInfo.GetFiles()
        where file.Extension.ToLower() == ".xml"
        orderby file.LastWriteTime
        select file.Name;

    return query;
} 
```

用法：

```
var files = GetXmlFilesByLastWriteTime(path).ToList(); 
```

# javascript - 弹跳子菜单jQuery

> ID：16019792
> 
> 赞同：4
> 
> 时间：2013-04-15T16:05:36.670
> 
> 标签：javascript, jquery, html

我正在做一个菜单，每个项目都有它的子菜单。这是标记：

```
<ul id="menu">
    <li>
        <a href="javascript:void(0)" onclick="show_submenu(this)">TITLE 1</a>
        <ul class="submenu">
            <li>
                <a href="javascript:void(0)">sub1</a>
            </li>
            <li>
                <a href="javascript:void(0)">sub2</a>
            </li>
        </ul>
    </li>
    <li>
        <a href="javascript:void(0)">TITLE 2</a>
        <ul class="submenu">
            <li>
                <a href="javascript:void(0)">sub1</a>
            </li>
            <li>
                <a href="javascript:void(0)">sub2</a>
            </li>
        </ul>
    </li>
    <li>
        <a href="javascript:void(0)">TITLE 3</a>
    </li>
    <li>
        <a href="javascript:void(0)">TITLE 4</a>
    </li>
</ul> 
```

css

```
.submenu{display:none} 
```

脚本

```
function show_submenu(that) {
    $('ul.submenu').slideUp();
    $(that).next('ul.submenu:first').slideDown();
} 
```

我遇到的问题是，如果我点击一个项目，它会向下滑动它的子菜单，**但是如果我再次点击它，它会再次向上滑动和向下滑动它的子菜单，****它已经打开了**......有点奇怪的效果对于用户...任何想法如何解决它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T16:12:01.557

您需要检查现有的子菜单是否已经可见。如果是，您不想再次将其滑下。

```
var $submenu = $(that).next('ul.submenu:first'),
    viz = $submenu.is(":visible");
    $('ul.submenu').slideUp();
if (!viz) {
    $(that).next('ul.submenu:first').slideDown();
} 
```

[http://jsfiddle.net/ExplosionPIlls/zep6H/](http://jsfiddle.net/ExplosionPIlls/zep6H/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T16:09:07.727

在 jquery 中使用切换

```
$('#foo').toggle(showOrHide); 
```

[http://api.jquery.com/toggle/](http://api.jquery.com/toggle/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T16:12:36.360

它正在做你编码它要做的事情。相反，使用[`.slideToggle()`](http://api.jquery.com/slideToggle/);

```
function show_submenu(that){
    $(that).next('ul.submenu:first').slideToggle();
} 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/RpBmj/)**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-15T16:15:39.467

这应该有帮助

```
function show_submenu(that){
if(!$(that).next('ul.submenu:first').is(":visible")){
        $('ul.submenu').slideUp();
        $(that).next('ul.submenu:first').slideDown();
}
    } 
```

# ruby-on-rails - 如何获取 Formtastic 提示的输入值？

> ID：16019793
> 
> 赞同：0
> 
> 时间：2013-04-15T16:05:45.680
> 
> 标签：ruby-on-rails, formtastic

我有一个 Formtastic 表单，如果有的话，我希望它在提示中显示一个链接。

```
f.input :link, hint: 'link here' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T16:05:45.680

我发现解决这个问题的解决方案是使用`f.object`然后调用`link`它的属性，如下所示：

```
 form do |f|
    f.inputs do
      f.input :link, hint: link_to(f.object.link, f.object.link)
    end
    f.actions do
      f.action :submit
    end
  end 
```

# android - android iIllegal 参数异常服务未在 unbind 上注册

> ID：16019795
> 
> 赞同：1
> 
> 时间：2013-04-15T16:05:46.077
> 
> 标签：android, android-service

好的，我已经查看了很多问题，但无法找到解决方案...

不断收到“java.lang.IllegalArgumentException：服务未注册：”

**请注意，没有调用 ServiceConnection 的“onServiceConnected”方法....**

这就是我所拥有的（忽略所有Log.e ..我真的不知道有什么其他方法可以找出哪些函数在没有调试的情况下被调用）：

如何在清单中声明服务：

```
<service android:name="com.example.servicestry.MyService" android:enabled="true"/> 
```

我的活动

```
public class MainActivity extends Activity {
    MyService mBoundService=null;

    public ServiceConnection mConnection;
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        mConnection=new ServiceConnection(){

            @Override
            public void onServiceConnected(ComponentName name, IBinder service) {
                // TODO Auto-generated method stub 
                Log.e("onserviceconnected","");
                mBoundService = ((MyService.LocalBinder)service).getService();

                Toast.makeText(getApplicationContext(), "local service connected",Toast.LENGTH_SHORT).show();
            }

            @Override
            public void onServiceDisconnected(ComponentName name) {
                // TODO Auto-generated method stub
                Log.e("onservicedisconnected","");
                mBoundService=null; 
                Toast.makeText(getApplicationContext(), "local service disconnected",Toast.LENGTH_SHORT).show();

            }

        };

        this.doBindService();

        Timer timer=new Timer();
        timer.schedule(new RemindTask(), 3000);

    } 

    public void doUnbindService(){
        Log.e("doUnbindService","");
        unbindService(mConnection);
    }
    public void doBindService(){

        boolean b=bindService(new Intent(this,MyService.class),mConnection, Context.BIND_AUTO_CREATE);
        if(b){
            Toast.makeText(this, "binding service", Toast.LENGTH_SHORT).show();
        }
        else{
            Toast.makeText(this, "binding service FAILED", Toast.LENGTH_SHORT).show();
        }

        this.doUnbindService();

    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

    public class RemindTask extends TimerTask{

        @Override
        public void run() {
            // TODO Auto-generated method stub
            //Toast.makeText(getApplicationContext(), "this is runner", Toast.LENGTH_SHORT).show();
            Log.e("runner run","r");
            doUnbindService();

        }

    }
} 
```

我的服务等级

包 com.example.servicestry;

```
public class MyService extends Service{
    LocalBinder mBinder= new LocalBinder();;
    @Override
    public void onCreate(){
        super.onCreate();

        Log.e("binder create","ASDF");

    } 

    @Override
    public int onStartCommand(Intent i,int flag, int startId){
        Log.e("on start command","D");
        return super.onStartCommand(i, flag, startId);
    }

    @Override
    public void onDestroy(){
        super.onDestroy();
        Log.e("DEST","");
    }

    @Override
    public IBinder onBind(Intent intent) {

        // TODO Auto-generated method stub
        Log.e("onbind","ASDF");

        return mBinder;

    }

    public class LocalBinder extends Binder {
        MyService getService() {

            return MyService.this;
        }
    }

} 
```

# objective-c - 我的 XIB 中的两个 UITableViewCells for iPad/iPhone

> ID：16019807
> 
> 赞同：2
> 
> 时间：2013-04-15T16:06:32.453
> 
> 标签：objective-c, xcode, uitableview, xib

我正在尝试使用两种不同格式的 UITableViewCells，具体取决于它是 iPad 还是 iPhone。两个单元格显示相同的信息，但 iPad 单元格的高度是一半，宽度是两倍。因此，信息显示在一行与两行上。

在我的`cellforRowatIndexPath`,

我把代码：

```
HistoryCell *cell;
if (self.isiPad) {
    cell = [self.tableView dequeueReusableCellWithIdentifier:@"historyiPadCellType" forIndexPath:indexPath];

}
else{
    cell = [self.tableView dequeueReusableCellWithIdentifier:@"historyCellType" forIndexPath:indexPath];

} 
```

但是，如果我在同一个 XIB 中有 2 个 UItableViewCell，它似乎会给我一个错误： `invalid nib registered for identifier (historyCellType) - nib must contain exactly one top level object which must be a UITableViewCell instance'`

有没有什么办法解决这一问题？

谢谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-15T17:03:37.510

为 iPad 和 iPhone 使用不同单元的最佳方法是使用 2 个 nib： **HistoryCell~iphone.xib**和**HistoryCell~ipad.xib**

你必须注册你的笔尖：

```
[self.tableView registerNib:[UINib nibWithNibName:@"HistoryCell" bundle:nil] forCellReuseIdentifier:@"historyCellType"]; 
```

系统会根据当前设备自动加载 xib。

# java - Inc/dec mongotemplate，原子地

> ID：16019808
> 
> 赞同：2
> 
> 时间：2013-04-15T16:06:39.607
> 
> 标签：java, mongodb

我正在尝试使用 原子地更新我的文档的一个值`findAndModify`，根据我的阅读，它在同一个文档中是原子的。根据我的单元测试，这些值没有被修改。

我在 Java 中使用 mongoTemplate，我的代码看起来像

```
 public OfferConfiguration IncreaseStock(OfferConfiguration offerConfiguration) {
        Query query = new Query(Criteria.where("_id").is(offerConfiguration.getId()));
        Update update = new Update().inc("stock", 1);
        return mongoTemplate.findAndModify(query, update, OfferConfiguration.class);
    }

    public OfferConfiguration findAndDecreaseStock(String offerId ) {
        Query query = new Query(Criteria.where("_id").is(offerId).and("stock").gt(0));
        Update update = new Update().inc("stock", -1);
        return mongoTemplate.findAndModify(query, update, OfferConfiguration.class);
    } 
```

Stock 的类型为 Long，当我在查找中使用条件时，我可以看到：

```
 Query query = new Query(Criteria.where("_id").is(offerId).and("stock").gt(0));
  return mongoTemplate.findOne(query, OfferConfiguration.class); 
```

它仅返回库存大于 0 的值。

知道我的代码有什么问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-28T00:19:46.460

[FindAndModify](http://docs.mongodb.org/manual/reference/command/findAndModify/)默认更新后会返回原始文档。

如果您想取回修改后的文档，您必须将可选的*新*选项传递给它。看来您已经发现这样做的方法是添加`returnNew(true)`命令`findAndModify`。

# c# - PartialView 使用 LINQ 传递自定义列表

> ID：16019810
> 
> 赞同：2
> 
> 时间：2013-04-15T16:06:41.213
> 
> 标签：c#, linq, entity-framework, asp.net-mvc-4

我有 2 个使用 EF w/MVC4 的数据库。我已经通过 SO 进行了搜索。我需要将警报列表返回到部分视图。但是，警报应该由具有特定标识符的特定用户名过滤。视图是强类型的，我想保持这种状态。

我有 LINQ 查询返回到一个列表，它是与特定 ID 关联的用户名列表。您可以在第二个 case 语句中看到需要查找两个表的位置。我想在没有 viewmodel 类的情况下执行此操作。

这是代码：

```
 public PartialViewResult DashboardAlerts()
    {
        Database.SetInitializer<AlertsContext>(null);
        AlertsContext db = new AlertsContext();

        Database.SetInitializer<MemberUsersContext>(null);
        MemberUsersContext mdb = new MemberUsersContext();

        var members = new List<MemberUsers>(mdb.MemberUsers);
        var alerts = new List<Alerts>(db.Alerts);

        var query = from x in alerts
                    join y in members
                    on x.username equals y.username
                    where y.clubID == (int)Session["ClubID"]
                    select new { username = y.username};

        var list = query.ToList();

        switch (Session["RoleName"].ToString())
        {
            case "GMC Admin": return PartialView(db.Alerts.ToList());
            case "Club Admin": return //return db.Alerts.ToList() that has only usernames from query.ToList();
            default: return PartialView(db.Alerts.Where(x => x.username == User.Identity.Name).ToList());
        }
    } 
```

底线：我想仅使用查询列表的用户名属性中的值交叉引用 db.Alerts。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T08:09:17.767

根据您的问题，您希望将警报范围缩小到您在查询中有用户名的警报。看起来您已经完成了，只是不要选择用户名，而是选择警报

```
var query = from x in alerts
                join y in members
                on x.username equals y.username
                where y.clubID == (int)Session["ClubID"]
                select x; 
```

这将返回警报而不是用户名列表。

# google-app-engine - 如何接收带有 unicode 主题的入站消息？

> ID：16019811
> 
> 赞同：1
> 
> 时间：2013-04-15T16:06:42.423
> 
> 标签：google-app-engine, email, python-2.5

当我收到带有 Unicode 主题的消息时，我收到以下错误：

```
'ascii' codec can't decode byte 0xd0 in position 0: ordinal not in range(128)
Traceback (most recent call last):
  File "/base/python_runtime/python_lib/versions/1/google/appengine/ext/webapp/_webapp25.py", line 716, in __call__
    handler.post(*groups)
  File "/base/python_runtime/python_lib/versions/1/google/appengine/ext/webapp/mail_handlers.py", line 69, in post
    self.receive(mail.InboundEmailMessage(self.request.body))
  File "/base/python_runtime/python_lib/versions/1/google/appengine/api/mail.py", line 742, in __init__
    self.update_from_mime_message(mime_message)
  File "/base/python_runtime/python_lib/versions/1/google/appengine/api/mail.py", line 1304, in update_from_mime_message
    super(InboundEmailMessage, self).update_from_mime_message(mime_message)
  File "/base/python_runtime/python_lib/versions/1/google/appengine/api/mail.py", line 1213, in update_from_mime_message
    super(EmailMessage, self).update_from_mime_message(mime_message)
  File "/base/python_runtime/python_lib/versions/1/google/appengine/api/mail.py", line 1093, in update_from_mime_message
    subject = _decode_and_join_header(mime_message['subject'], separator=u'')
  File "/base/python_runtime/python_lib/versions/1/google/appengine/api/mail.py", line 558, in _decode_and_join_header
    for s, c in email.header.decode_header(header))
  File "/base/python_runtime/python_lib/versions/1/google/appengine/api/mail.py", line 558, in <genexpr>
    for s, c in email.header.decode_header(header))
UnicodeDecodeError: 'ascii' codec can't decode byte 0xd0 in position 0: ordinal not in range(128) 
```

开发环境也会出现同样的问题。有什么办法可以解决吗？

我在电子邮件标题中看到以下内容：

```
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: 7bit 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-21T07:59:59.720

我不得不手动解析电子邮件，因为我还没有找到解决此问题的方法 - [http://code.google.com/p/googleappengine/issues/detail?id=8989](http://code.google.com/p/googleappengine/issues/detail?id=8989)

请参阅[https://stackoverflow.com/a/16129023/604388](https://stackoverflow.com/a/16129023/604388)了解我是如何做到的。

# c# - 为什么正则表达式匹配会引发异常？

> ID：16019812
> 
> 赞同：1
> 
> 时间：2013-04-15T16:06:52.423
> 
> 标签：c#, regex

我已经在项目中使用了这个正则表达式，但它似乎不能正常工作 - 它以前在其他应用程序中工作过。

它告诉我`parsing "((^[^_]{1}\S{1,40})\_(\S{5,6})\_(\S{1,4})\_(\S{1,4})\_(\S{4,6}))(\.{1}\S{1,5})$" - Unrecognized escape sequence \_.`

我将文件中的正则表达式作为常量：

```
public static string MatchDocument = @"((^[^_]{1}\S{1,40})\_(\S{5,6})\_(\S{1,4})\_(\S{1,4})\_(\S{4,6}))(\.{1}\S{1,5})$"; 
```

我没有使用正则表达式的经验，但我认为在字符串前面加上`@`可以解决任何反斜杠问题......为什么这不起作用？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-15T16:08:44.727

它的意思正是它所说的。

`\_`不是正则表达式转义序列（在正则表达式的 .NET 风格中）。

如果你想要一个下划线，只需使用`_`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T16:08:56.587

您的字符串包含多个`\_`. 这不是有效的正则表达式转义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T16:12:10.623

下划线是文字字符，不需要转义。

# java - 使用 Hibernate 4 的 Integrator 模式和 Spring 的依赖注入

> ID：16019820
> 
> 赞同：8
> 
> 时间：2013-04-15T16:07:48.257
> 
> 标签：java, spring, hibernate, spring-mvc, inversion-of-control

我习惯于使用 Spring 来进行依赖注入，如下所示：

```
<context:component-scan base-package="org.emmerich.myapp" /> 
```

然后`Autowired`像这样注释我的依赖类：

```
public class DependentClass {

    @Autowired
    private Dependency dependency;

} 
```

然而，随着 Hibernate 4.0 的变化，我们现在被建议使用新的`Integrator`接口来进行服务发现。这包括为触发器添加事件侦听器，例如`postUpdate`等`postDelete`。

不幸的是，这不能很好地与通过注释依赖项进行的依赖项注入配合使用。我有以下设置：

我定义的集成器将我的侦听器添加到`ServiceFactory`. 这在文件中被引用`META-INF/services/org.hibernate.integrator.spi.Integrator`。

```
public class MyIntegrator implements Integrator {

    private MyListener listener;

    public MyIntegrator() {
        listener = new MyListener();
    }

    @Override
    public void integrate(Configuration configuration,
                          SessionFactoryImplementor sessionFactory,
                          SessionFactoryServiceRegistry serviceRegistry) {
    final EventListenerRegistry eventRegistry =
        serviceRegistry.getService(EventListenerRegistry.class);

    eventRegistry.prependListeners(EventType.POST_COMMIT_INSERT, listener);

} 
```

我还定义了 class `MyListener`，它看起来像您的典型事件侦听器。

```
@Component
public class MyListener implements PostInsertEventListener {

    @Autowired
    private Dependent dependent;

    public void onPostInsert(PostInsertEvent event) {
         // dependent == null
    }

} 
```

不幸的是，如评论所示，这不起作用。我想这是因为我在`MyListener`内部实例化`MyIntegrator`，它不会拾取组件并且不会自动装配组件。但是，如果我尝试这个：

```
@Component
public class MyIntegrator {

     @Autowired
     private MyListener listener;

     ...
} 
```

然后侦听器不会自动装配。

首先，使用 Spring 必须做的事情感觉不对`new MyListener()`。我希望能够将其定义为自动装配的依赖项，并让 Spring 为我创建一个单例。我的问题是这样的：

在新的 Integrator 接口中使用依赖注入的最佳方法是什么？Integrator 用于构建 SessionFactory，因此当他们被要求集成自己时，我想没有可用的应用程序上下文。因此，我在 Integrator 中需要的任何 bean 都需要以“老式”方式创建，并且不会收到它们的自动装配。

我对 Spring 的世界很陌生，你会说这是我应该期待看到的吗？我知道当我在 SessionFactory 中时，我处于应用程序的不同范围内，但是有没有办法获得对 bean 的引用并启用自动装配，即使我是通过创建它的`new`？

我想出的解决方案使用了`ApplicationContextAware`. 这意味着只要上下文可用，就会`MyListener`收到`ApplicationContext`对 bean 的引用，并且我在方法调用而不是 bean 构造时从上下文中引用 bean。创建一个 bean`new`并没有限制这一点，所以 Spring 仍然给我应用程序上下文：

```
@Component
public class MyListener implements PostInsertEventListener, ApplicationContextAware {

    private static ApplicationContext context;

    public void onPostInsert(PostInsertEvent event) {
         // getDependent() == correct!
    }

    public void setApplicationContext(ApplicationContext context) throws BeanException {
        this.context = context;
    }

    public Dependent getDependent() {
        return context.getBean(Dependent.class);
    }

} 
```

有没有更好的办法？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-16T19:17:02.877

如评论中所述，我采用了另一种集成 Spring 管理的 HibernateEventListeners 的方式。这是代码：

Spring 管理的 Hibernate 事件监听器的标识符接口：

```
public interface HibernateEventListener { } 
```

HibernateIntegrator：

```
@Service
public class HibernateSpringIntegrator {

    private static final Logger log = LoggerFactory.getLogger(HibernateSpringIntegrator.class);

    @Autowired
    private HibernateEntityManagerFactory entityManagerFactory;

    @Autowired
    private HibernateSpringIntegratorRegistry hibernateSpringIntegratorRegistry;

    @PostConstruct
    public void registerListeners() {
        log.debug("Registering Spring managed HibernateEventListeners");

        EventListenerRegistry listenerRegistry = ((SessionFactoryImpl) entityManagerFactory
                .getSessionFactory()).getServiceRegistry().getService(
                EventListenerRegistry.class);
        List<HibernateEventListener> eventListeners = hibernateSpringIntegratorRegistry
                .getHibernateEventListeners();
        for (HibernateEventListener hel : eventListeners) {
            log.debug("Registering: {}", hel.getClass());
            if (PreInsertEventListener.class.isAssignableFrom(hel.getClass())) {
                listenerRegistry.appendListeners(EventType.PRE_INSERT,
                        (PreInsertEventListener) hel);
            }
            if (PreUpdateEventListener.class.isAssignableFrom(hel.getClass())) {
                listenerRegistry.appendListeners(EventType.PRE_UPDATE,
                        (PreUpdateEventListener) hel);
            }
            if (PreDeleteEventListener.class.isAssignableFrom(hel.getClass())) {
                listenerRegistry.appendListeners(EventType.PRE_DELETE,
                        (PreDeleteEventListener) hel);
            }
            if (PostInsertEventListener.class.isAssignableFrom(hel.getClass())) {
                listenerRegistry.appendListeners(EventType.POST_INSERT,
                        (PostInsertEventListener) hel);
            }
            if (PostUpdateEventListener.class.isAssignableFrom(hel.getClass())) {
                listenerRegistry.appendListeners(EventType.POST_UPDATE,
                        (PostUpdateEventListener) hel);
            }
            if (PostDeleteEventListener.class.isAssignableFrom(hel.getClass())) {
                listenerRegistry.appendListeners(EventType.POST_DELETE,
                        (PostDeleteEventListener) hel);
            }
            // Currently we do not need other types of eventListeners. Else this method needs to be extended.
        }
    }
} 
```

“注册表”：

```
@Component
public class HibernateSpringIntegratorRegistry {

    @Autowired(required = false)
    private List<HibernateEventListener> hibernateEventListeners;

    public List<HibernateEventListener> getHibernateEventListeners() {
        if (hibernateEventListeners == null) {
            return Collections.emptyList();
        }
        return hibernateEventListeners;
    }
} 
```

这是一个示例实现：

```
@Component
public class MailGenerationEventListener implements HibernateEventListener, 
    PostDeleteEventListener, PostInsertEventListener, PostUpdateEventListener {

    @Override
    public void onPostDelete(PostDeleteEvent event) {
        Class<?> entityClass = event.getEntity().getClass();
        ...
    }

    @Override
    public void onPostInsert(PostInsertEvent event) {
        Class<?> entityClass = event.getEntity().getClass();
        ...
    }

    @Override
    public void onPostUpdate(PostUpdateEvent event) {
        Class<?> entityClass = event.getEntity().getClass();
        ...
    }
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-03-17T17:42:26.493

在从 hibernate 3.6 升级到 4.2 期间，我们需要通过执行以下配置来拥有一个使用 spring-managed beans 的自定义验证器：

```
<!-- Make our validators use DI if necessary -->
<bean id="validator" class="org.springframework.validation.beanvalidation.LocalValidatorFactoryBean"/>

<bean id="sessionFactory" class="org.springframework.orm.hibernate4.LocalSessionFactoryBean">
    <!-- other props -->
    <property name="hibernateProperties">
            <map>
                <entry key="javax.persistence.validation.factory" value-ref="validator" />
            </map>
    </property>
</bean> 
```

# c++ - 使用文本调整 QToolButton 的大小

> ID：16019822
> 
> 赞同：1
> 
> 时间：2013-04-15T16:07:51.533
> 
> 标签：c++, qt, button, user-interface, interface

我有一个`QToolButton`使用`toolButton->setText(....)`. 但是，在呈现按钮时，文本会被截断。我尝试使用增加按钮的宽度，`resize()`但是`setFixedSize`文本居中并且仍然被截断。任何想法如何使按钮跟随文本的宽度？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T20:40:35.320

您可以使用`QFontMetrics`来计算显示整个文本所需的最小尺寸。该`boundingRect`方法返回一个`QRect`与您的文本大小相对应的值。您可以指定像`Qt::AlignHCenter`.

[http://qt-project.org/doc/qt-5.0/qtgui/qfontmetrics.html#boundingRect-4](http://qt-project.org/doc/qt-5.0/qtgui/qfontmetrics.html#boundingRect-4)

您可以子类`QToolButton`化并重新实现该`setText()`方法以在调用时包含`resize()`对大小的调用或管理大小 `setText()`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-03-14T16:22:18.257

尝试使用正确的值设置相同`minimumSize(w,h)`的`maximumSize(w,h)`值，例如：在设计中，在按钮的属性窗口中：

> 几何图形中的宽度和高度 - 80x88，最小值和最大值必须相同。

就我而言，它对我有用。并注意按钮的图标大小，如果是的话。

# jquery - 从动画按钮取消绑定/重新绑定 .on()/.off() 鼠标事件

> ID：16019825
> 
> 赞同：0
> 
> 时间：2013-04-15T16:07:57.047
> 
> 标签：jquery, button, mouseevent, slideshow

这个问题在某种程度上与我之前发布的另一个问题有关。我提出一个新问题的原因是因为我改变了一些事情，从那时起就无法处理一个小问题。

所以，我有这个简单的水平幻灯片。我有一个左右按钮来控制它（除了直接点击幻灯片的能力）。基本上，我希望我的按钮在幻灯片到达左/右端时自行停用，并在它们再次被连接时重新激活。我试过 .off() 但它只是永久停用。当我想要它重新打开时 - .on() - 它不起作用。

HTML 标记：

```
<div id="rocksMenu_btnLeft"></div>
<div id="rocksMenu_btnRight"></div>

      <div id="centerArea">
         <div id="menuContainer">
            <div id="menuItem_1" class="menuItem">
               <div class="content">Contents1</div>
            </div>
            <div id="menuItem_2" class="menuItem">
               <div class="content">Contents2</div>
            </div>
            <div id="menuItem_3" class="menuItem">
               <div class="content">Contents3</div>
            </div>
            <div id="menuItem_4" class="menuItem">
               <div class="content">Contents4</div>
            </div>
         </div>
      </div> 
```

完整的代码在这里 - [Fiddle](http://jsfiddle.net/p6Uxd/)（干净的版本 - 我删除了我的按钮禁用代码尝试，因为它变得混乱）。我已经搜索过这个问题，但无法得到明确的答案。

谢谢。

佩德罗

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T16:13:07.747

You don't have to deactivate the event, just do a check and if the end is reached, don't do the animation action.

```
$('#rocksMenu_btnRight').on('click', function() {
    if (menuItem_place === menuItem_limit) return;
    // animation code
} 
```

For `btnLeft` just change the condition `if (menuItem_place === 0) return;`.

# mysql - 根据特定的 meta_key 和 meta_value 过滤 postmeta

> ID：16019828
> 
> 赞同：1
> 
> 时间：2013-04-15T16:08:10.597
> 
> 标签：mysql, wordpress

我有以下 SQL 语句来计算基于 3 个 Wordpress 表的几个字段。我需要的是只包含 meta_key='odd' 和 meta_value >= '1.5' 的结果。我在 WHERE 语句中进行了尝试，但它不起作用，因为此查询中的大多数结果显示为 Null。

任何帮助深表感谢！

```
SELECT (display_name) AS 'user',
    SUM(Case When meta_key = 'status' Then meta_value = 'won' else Null End) AS 'Won',
    SUM(Case When meta_key = 'status' Then meta_value = 'lost' else Null End) AS 'Lost',
    COUNT(Case When meta_key = 'odd' Then meta_value else Null End) AS 'Total',
    ROUND (AVG(Case When meta_key = 'odd' Then meta_value else Null End), 2) AS 'Avg odd',
    ROUND (AVG(Case When meta_key = 'bet' Then meta_value else Null End), 2) AS 'Avg bet',
    ROUND (SUM(Case When meta_key = 'balance' Then meta_value else Null End), 2) AS 'Balance'
FROM wp_postmeta pm
INNER JOIN wp_posts p ON pm.post_id = p.ID 
INNER JOIN wp_users u ON p.post_author = u.ID
WHERE Month(post_date) = MONTH(CURRENT_DATE) AND p.post_status='publish' AND pm.meta_key='odd' AND pm.met.value >='1.5'
GROUP BY (display_name)
ORDER BY Balance DESC 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T16:19:56.933

您需要将其移至`having`子句：

```
SELECT (display_name) AS 'user',
    SUM(Case When meta_key = 'status' Then meta_value = 'won' else Null End) AS 'Won',
    SUM(Case When meta_key = 'status' Then meta_value = 'lost' else Null End) AS 'Lost',
    COUNT(Case When meta_key = 'odd' Then meta_value else Null End) AS 'Total',
    ROUND (AVG(Case When meta_key = 'odd' Then meta_value else Null End), 2) AS 'Avg odd',
    ROUND (AVG(Case When meta_key = 'bet' Then meta_value else Null End), 2) AS 'Avg bet',
    ROUND (SUM(Case When meta_key = 'balance' Then meta_value else Null End), 2) AS 'Balance'
FROM wp_postmeta pm
INNER JOIN wp_posts p ON pm.post_id = p.ID 
INNER JOIN wp_users u ON p.post_author = u.ID
WHERE Month(post_date) = MONTH(CURRENT_DATE) AND p.post_status='publish' 
GROUP BY (display_name)
having SUM(case when pm.meta_key='odd' AND pm.meta_value >='1.5' then 1 else 0 end) > 0
ORDER BY Balance DESC 
```

这确定每个 . 是否存在这样的行`display_name`。

# node.js - 快速身份验证重定向导致无限循环

> ID：16019830
> 
> 赞同：5
> 
> 时间：2013-04-15T16:08:14.073
> 
> 标签：node.js, authentication, express, infinite-loop, passport.js

我正在尝试使用 express 在 node.js 服务器上设置护照本地身份验证。看起来它应该非常直截了当。但我被卡住了。

这两个片段可以很好地协同工作：

```
app.get('/', ensureAuthenticated, function(req, res){
    res.redirect('/index.html', { user: req.user });
});

app.post('/login', 
    passport.authenticate('local', { failureRedirect: '/login.html', failureFlash: true, successFlash: "Success!" }),
    function(req, res) {
    res.redirect('/');
}); 
```

问题是没有什么能阻止我在地址栏中输入“www.myurl.com/index.html”并直接放到我的页面上。

如果我使用这样的任何代码：

```
app.get('/index.html', ensureAuthenticated, function(req, res){
    res.redirect('/index.html', { user: req.user });
}); 
```

似乎我陷入了一个循环......如果它可以检查我的身份验证并在我的路上发送我，而不是永远检查每个重定向，那就太好了。避免这种情况的方法是什么？

我注意到文档似乎使用 .render，而不是重定向。但这似乎要求我使用 .ejs，我不希望这样做。这是必须的吗？

**++供参考++**

```
 function ensureAuthenticated(req, res, next) {
    if (req.isAuthenticated()) { return next(); }
    res.redirect('/login.html')
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T17:01:30.087

所以我猜你让`express.static()`处理请求`index.html`and `login.html`？在这种情况下，您可以创建一个`index.html`首先检查身份验证的路由，然后采取相应措施：

```
app.get('/index.html', ensureAuthenticated, function(req, res, next) {
  // if this block is reached, it means the user was authenticated;
  // pass the request along to the static middleware.
  next();
}); 
```

确保在添加到中间件堆栈*之前*`express.static`声明了上述路由，否则它将被绕过（快速中间件/路由按声明顺序调用，第一个匹配请求的将处理它）。

**编辑：**我一直忘记这是可能的，而且更清洁：

```
app.use('/index.html', ensureAuthenticated); 
```

（而不是`app.get`上面的）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-15T16:31:42.173

为什么你在每条路线上都使用重定向？你需要做的就是

```
app.get('/',ensureAuthenticated,function(req,res){

// your route logic goes here

}); 
```

ensureAutheticated 将检查您的代码是否经过身份验证。不需要每次通过登录路由都重定向它。

[res.render](http://expressjs.com/api.html#res.redirect)和[res.redirect()](http://expressjs.com/api.html#res.render)是用于不同目的的不同事物。

重定向重定向到 res.render() 呈现视图的路径。视图可以是consolidate.js[支持](http://jsdoc.info/visionmedia/consolidate.js/)的任何文件，如果您使用最新版本的 express，则必须使用该文件。

因此，从您的路由中删除所有这些重定向，无限循环应该停止。您只需要通过 ensureAuthenticated 以确保请求已通过身份验证。

# java - 反序列化时忽略属性

> ID：16019834
> 
> 赞同：47
> 
> 时间：2013-04-15T16:08:22.457
> 
> 标签：java, json, jackson

我有一个简单的接口，带有属性的 getter 和 setter。

```
public interface HasMoney { 

      Money getMoney();

      void setMoney(Money money);

 } 
```

我有另一个类 UserAccount 实现了这个接口。

```
public class UserAccount implements HasMoney {

       private Money money;

       @Override
       Money getMoney() // fill in the blanks

       @Override
       void setMoney(Money money) // fill in the blanks

} 
```

我的问题是我想序列化money 属性，但在反序列化时忽略它，即不接受来自用户的该属性的任何值。我已经在 setter 上尝试了 @JsonIgnore ，在 getter 上尝试了 @JsonIgnore(false) ，它确实忽略了它，但它在序列化它的同时也这样做了。

我在 setter 上尝试了@JsonIgnore，在 getter 上尝试了@JsonProperty，只是为了明确告诉 Jackson 我们打算跟踪这个属性，当金钱属性发送到服务器并且 Jackson 试图反序列化它并抛出 MalformedJsonException 时，这似乎会使应用程序崩溃：无法构造 Money 类型的对象。

最奇怪的是，将@JsonIgnore 放在setter 上，将@JsonProperty 放在setter 上适用于大多数情况下属性是原始的情况。

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2016-09-16T05:55:23.963

版本 2.6.0+ 允许在类级别使用 @JsonIgnoreProperties 完成此操作。

```
@JsonIgnoreProperties(value={ "money" }, allowGetters=true) 
```

看看这个已关闭的问题： [https ://github.com/FasterXML/jackson-databind/issues/95](https://github.com/FasterXML/jackson-databind/issues/95)

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2013-04-15T23:12:26.970

好的，所以@JsonIgnore 的行为从 1.9 开始发生了根本性的变化（更糟糕的是 imo）。无需详细说明为什么您的属性在反序列化期间没有被忽略，请尝试以下代码来修复它：

```
public class UserAccount implements HasMoney {
    @JsonIgnore
    private BigDecimal money;

    // Other variable declarations, constructors

    @Override
    @JsonProperty
    public BigDecimal getMoney() {
        return money;
    }

    @JsonIgnore
    @Override
    public void setMoney(final BigDecimal money) {
        this.money = money;
    }

    // Other getters/setters
} 
```

注意现场使用`@JsonIgnore`- 它是工作解决方案所必需的。

*注意：根据您的环境和用例，您可能需要对 ObjectMapper 实例进行额外配置，例如*USE_GETTERS_AS_SETTERS、AUTO_DETECT_GETTERS、AUTO_DETECT_SETTERS*等*。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2018-11-03T11:04:59.273

如果您不拥有或无法通过添加注释来更改类，您将在您的实现中`@JsonIgnore`使用从*2.5版开始的 mixin 来获得预期的结果。*

```
public abstract class HasMoneyMixin {
    @JsonIgnore
    public abstract Money getMoney();
} 
```

配置映射器以使用 mixin，

```
ObjectMapper mapper = new ObjectMapper();
mapper.addMixIn(HasMoney.class, HasMoneyMixin.class);
// avoid failing if all properties are empty
mapper.configure(SerializationFeature.FAIL_ON_EMPTY_BEANS, false); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2020-10-06T06:57:08.343

使用 Jackson 2.10，您可以实现如下所示的只读字段：

## 一个真实的领域

```
public class UserAccount implements HasMoney {

   @JsonProperty(access = JsonProperty.Access.READ_ONLY)
   private Money money;

   // getter and setter

} 
```

## 虚拟场

```
@JsonIgnoreProperties(ignoreUnknown = true) // to ignore ALL unknown properties
// OR
@JsonIgnoreProperties(value = {"money"}, allowGetters = true) // to ignore only 'money' input
public class UserAccount implements HasMoney {

   @JsonProperty
   public Money getMoney() {
       // some calculation
   }

} 
```

该值将被序列化，但在反序列化期间被忽略。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2020-12-16T18:36:23.160

显然我的解决方案迟到了，但肯定会对其他人有所帮助。

**Prehistory**：在我的项目中，有一个类将 JSON 字符串直接读取到实体中。JSON 包含一个不是类变量的属性。因为

```
objectMapper.enable(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES); 
```

在反序列化期间不会创建实体的实例（在我们的项目中需要这种情况下的异常）。

**解决方案**：

```
objectMapper.addHandler(new DeserializationProblemHandler() {
    @Override
    public boolean handleUnknownProperty(DeserializationContext ctxt, JsonParser p, JsonDeserializer<?> deserializer, Object beanOrClass, String propertyName) throws IOException {
       if( (propertyName.equals("propertyToBeIgnored") && beanOrClass.getClass().equals(ClassOfTheProperty.class)) {
           p.skipChildren();
           return true;
       } else {
           return false;
       }
    }
}); 
```

# iphone - 在 Xcode 中创建两个 iOS 应用程序

> ID：16019835
> 
> 赞同：10
> 
> 时间：2013-04-15T16:08:23.720
> 
> 标签：iphone, ios, xcode, projects

使用 Xcode（在 iOS 上开发）我想创建第二个项目，它与第一个项目相同，但有些类不同。

确切地说，我正在创建一个 iPhone 应用程序，我想提供免费版本和高级版本。实际上，项目的代码是相同的，但改变了一些类。

问题是我不想支持两个项目。如果我修改一个类，那么我必须在另一个项目上修改相同的更改。这是非常多余的。

此外，项目被推送到远程 GIT 存储库。

最后一点，iOS 应用程序是使用与项目关联的 ID 来识别的。

那么，我需要两个不同的项目吗？

在 Xcode 中创建两个 iOS App 项目共享类但更改两到三个类的最佳解决方案是什么？

谢谢

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-04-15T16:12:09.990

> I want to offer a free version and a premium version.

In this case, you do not need to create two apps in two projects: all you need is a second *target* for your premium version. Here is a [link that explains how to create and manage multiple targets in Xcode](http://blog.just2us.com/2009/07/tutorial-creating-multiple-targets-for-xcode-iphone-projects/).

The process boils down to adding a target to the project, defining a separate properties plist for it, optionally setting up a preprocessor symbol for conditional compile, and using that symbol to `#ifdef` portions of your classes not needed in the free version.

Another common approach to managing free vs. premium offering is to provide a single version for free, and let users upgrade it to premium through an in-app purchase.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-15T16:13:20.200

You just have to create two targets. So you'll only modify a single code base, perfect!

[This tutorial](http://blog.just2us.com/2009/07/tutorial-creating-multiple-targets-for-xcode-iphone-projects/) will walk you through (and even uses lite/paid versions as it's example).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-12-29T12:18:12.637

1.  付费版本的重复目标并将其命名为免费版本

2.  在付费目标中定义宏名称`PaidApp=1`，然后将这行代码放在 applicationDidfinishLaunching 的开头。

    ```
    #ifdef PaidApp
    [[NSUserDefaults standardUserDefaults] setInteger:1 forKey:@"adDisabled"];
    #endif 
    ```

3.  当免费应用程序运行目标时，如果有人购买付费应用程序功能，则将@“adDisabled”的值设置为1（默认情况下@“adDisabled”的值为0）

# javascript - 当我添加另一个功能时，网页 Javascript 停止工作

> ID：16019837
> 
> 赞同：1
> 
> 时间：2013-04-15T16:08:30.307
> 
> 标签：javascript, html, ajax

我正在为一项任务编写一个简单的网页，如果输入的 ID 号在外部 XML 文档中匹配，我需要制作一个自动填充的表单。一切正常，直到我开始添加另一个函数以在提交时执行，该函数将添加或修改记录（通过 AJAX 调用）。

但是，在添加了这个新功能后，另一个停止了工作。如果我将其注释掉，则原始功能将再次起作用。

我找不到这个新功能的任何问题（即所有括号都在正确的位置等）。为什么会毁了一切？

这是我的代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
    <head> 
        <script type="text/javaScript">
            function checkID(val){
                if (val.value.length != 6) //Since student ID's are six digits
                    return;
                //inID = val.value;
                //if (inID.length < 6) return;

                xhr = new XMLHttpRequest();
                xhr.open('GET', 'processor.php?studentID=' + document.forms[0].elements[0].value);
                xhr.onreadystatechange = function() {
                    /**
                    if (xhr.readystate != 4 || xhr.status != 200){
                        document.getElementById("status").innerHTML = "<p> Not Done Yet</p>";
                    }
                    **/
                    if (xhr.readyState === 4 && xhr.status === 200){
                        document.getElementById("status").innerHTML = "";
                        parse(xhr.responseXML); 
                    }
                }
                xhr.send();
                document.getElementById("status").innerHTML = "<p> Not Done Yet</p>";
            }
            function parse(xml){
                if (xml == null) alert("Null!");
                var student = xml.getElementsByTagName('student');
                    if (student.length == 0) alert("No Student's Found with that ID");
                var content = student.item('0');
                    var name = content.getElementsByTagName('fullname');
                    name = name.item(0).childNodes[0].nodeValue;
                    document.forms[0].elements[1].value = name;

                    var phone = content.getElementsByTagName('phone');
                    phone = phone.item(0).childNodes[0].nodeValue;
                    document.forms[0].elements[2].value = phone;

                    var email = content.getElementsByTagName('email');
                    email = email.item(0).childNodes[0].nodeValue;
                    document.forms[0].elements[3].value = email;

            }
            function addOrModify(curr){
                xhr = new XHRHttpRequest();
                xhr.open('GET', 'addOrModify.php?studentID=' + document.forms[0].elements[0].value);
                xhr.onreadystatechange = function(){
                    if (xhr.readyState == 4 && xhr.status == 200){
                        if (xhr.responseText == "added")
                            document.getElementByID('status').innerHTML = "Added";
                }
                xhr.send();
            }

        </script>
        <style type="text/css">
            #container {
                margin: 0 auto;
                padding: 30px;
                text-align: center;
            }
            .centerp {
                font-size: 150%;
                text-align: center;
            }
            table {
                align: center;
            }
        </style>
        <title>Student Profile</title>
    </head>

    <body>
        <p class="centerp"> Student Profiles </p>
        <div id="container">
            <form method="GET" action="">
                <table align="center">
                    <label>
                        <tr>
                            <td>Student ID</td> 
                            <td><input type="text" name="studentID" onblur="checkID(this)"> </input></label></td>
                        </tr>
                    </label>
                    <label>
                        <tr>
                            <td>Name</td> 
                            <td><input type="text" name="name" id="name"> </input></label></td>
                        </tr>
                    </label>
                    <label>
                        <tr>
                            <td>Phone</td> 
                            <td><input type="text" name="phone"> </input></label></td>
                        </tr>
                    </label>
                    <label>
                        <tr>
                            <td>Email</td> 
                            <td><input type="text" name="email"> </input></label></td>
                        </tr>
                    </label>
                        <tr>
                            <td> <input type="submit" onclick="addOrModify()"> </input></td></tr> </td>
                        </tr>
                        <tr>
                            <td> <div id="status">
                                </div> </td>
                        </tr>
                </table>
            </form>
        </div>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T16:16:29.430

你说所有的括号都在正确的位置，但它们不是。

你没有关闭

```
if (xhr.readyState == 4 && xhr.status == 200){ 
```

在你的最后一个功能

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T16:20:15.170

[通过在此处](http://jsfiddle.net/3QNHf/)的 jsfiddle 中运行代码， 您可以在调试器中看到您缺少 }

在控制台中，函数主体后会出现 Error = SyntaxError: missing }。

因此，通过查看您的代码，您最后只是缺少一个 }，请参阅[http://jsfiddle.net/3QNHf/1/](http://jsfiddle.net/3QNHf/1/)

我还整理了您的一些 if 语句，它是更好的做法，并且更易于调试使用

`if(statement){ do somthing}`

而不是

```
if(statement)do something 
```

完整代码

```
function checkID(val){
      if (val.value.length != 6){ //Since student ID's are six digits
          return;}
                //inID = val.value;
                //if (inID.length < 6) return;

                xhr = new XMLHttpRequest();
                xhr.open('GET', 'processor.php?studentID=' + document.forms[0].elements[0].value);
                xhr.onreadystatechange = function() {
                    /**
                    if (xhr.readystate != 4 || xhr.status != 200){
                        document.getElementById("status").innerHTML = "<p> Not Done Yet</p>";
                    }
                    **/
                    if (xhr.readyState === 4 && xhr.status === 200){
                        document.getElementById("status").innerHTML = "";
                        parse(xhr.responseXML); 
                    }
                }
                xhr.send();
                document.getElementById("status").innerHTML = "<p> Not Done Yet</p>";
            }
            function parse(xml){
                if (xml == null){ alert("Null!")};
                var student = xml.getElementsByTagName('student');
                if (student.length == 0){ alert("No Student's Found with that ID")};
                var content = student.item('0');
                    var name = content.getElementsByTagName('fullname');
                    name = name.item(0).childNodes[0].nodeValue;
                    document.forms[0].elements[1].value = name;

                    var phone = content.getElementsByTagName('phone');
                    phone = phone.item(0).childNodes[0].nodeValue;
                    document.forms[0].elements[2].value = phone;

                    var email = content.getElementsByTagName('email');
                    email = email.item(0).childNodes[0].nodeValue;
                    document.forms[0].elements[3].value = email;

            }
            function addOrModify(curr){
                xhr = new XHRHttpRequest();
                xhr.open('GET', 'addOrModify.php?studentID=' + document.forms[0].elements[0].value);
                xhr.onreadystatechange = function(){
                    if (xhr.readyState == 4 && xhr.status == 200){
                        if (xhr.responseText == "added")
                            document.getElementByID('status').innerHTML = "Added";
                }
                xhr.send();
            }
            } 
```

# c# - 反正有没有通过 wpf 中的视图模型来探测命令？

> ID：16019838
> 
> 赞同：0
> 
> 时间：2013-04-15T16:08:34.620
> 
> 标签：c#, wpf, xaml, mvvm, icommand

这个问题很简单，但我无法准确掌握如何去做。

我决定使用 WPF，但我不想以经典的方式实现一些 MVVM 模式。

在我的项目中，我决定使用 INPC 创建我的模型，并将它们用作我的 XAML 的提要，就好像它们也是 View-Model 一样。所以而不是：
**View(<-Binding->)View-Model(<- INPC->)型号**

我设计的是：
**View(<-Binding->)Model。**

当然，约束是模型必须实现 INPC，但是与实践中的经典 MVVM 相比 - 模型也需要实现 INPC - 所以我发现我的这完全可以作为 DRY 原则指导的高效快捷方式。

我也想支持命令，我喜欢命令的概念，并且我了解在使用视图模型时如何实现命令。但是正如我所描述的，我决定跳过视图模型。

因此，如果我将命令编写如下：

```
public class MyCommand : ICommand
{
    public event EventHandler CanExecuteChanged;

    public void Execute(object parameter)
    {
    //do somthing
    }

    public bool CanExecute(object parameter)
    {
        return true;
    }
} 
```

我的 XAML 看起来像这样：

```
<UserControl x:Class=... blah blah...
 xmlns:Model="clr-namespace:MyProject.BusinessLogic.Person"
 xmlns:Commands="clr-namespace:MyProject.Commands">

<TextBox Text="{Binding FirstName}" />
<Button Command="What do I put here?" />

<UserControl> 
```

那么，我应该在按钮命令中添加什么以允许它调用 MyCommand（不在模型中）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T18:05:36.367

您确实需要一个视图模型，这就是您的表示逻辑应该去的地方，包括指挥。

您的模型显然不能对`ICommand`etc. 有任何引用，因为它位于`System.Windows.Input`命名空间中，因此您需要一种将模型与视图桥接的类型，即视图模型。

如果您不希望完全遵循该模式并希望避免将所有视图模型调用委托给模型，则可以将模型公开为视图模型上的属性。

另一个考虑因素是，如果您正在使用 MVVM，那么您[真的应该使用 MVVM 框架](http://www.lhotka.net/weblog/UsingTheMVVMPatternRequiresAFramework.aspx)。他们将提供一种替代指挥的方式，指挥有局限性。

例如，如果您希望重新设计您的 UI，以便`Button`在未启用时隐藏 a，那么您无法通过命令轻松实现此目的。

诸如[Caliburn.Micro](http://caliburnmicro.codeplex.com/)之类的 MVVM 框架提供了[Actions](http://caliburnmicro.codeplex.com/wikipage?title=All%20About%20Actions&referringTitle=Documentation)，它提供了许多优于命令的好处。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T19:50:47.107

您可能想阅读以下内容：[http ://wpfglue.wordpress.com/2012/05/07/commanding-binding-controls-to-methods/](http://wpfglue.wordpress.com/2012/05/07/commanding-binding-controls-to-methods/)

这个想法是拥有可重用的组件，允许创建调用模型中的方法的 CommandBinding，并且可以在 XAML 中进行配置。因此，“管道”将由这些组件完成，而模型将仅实现与业务相关的方法。

这可以概括为我称之为 ViewModelKit 的东西，即一组可以在 XAML 中组装为资源并涵盖 ViewModel 的常见工作的组件。

# javascript - 我的模态 div 没有关闭

> ID：16019840
> 
> 赞同：0
> 
> 时间：2013-04-15T16:08:38.347
> 
> 标签：javascript, html, css, modal-dialog

![在此处输入图像描述](https://i.stack.imgur.com/yVlU2.jpg)

所以，这就是我将向用户显示库存的地方。我从互联网上获得了一些 CSS 代码，并根据需要对其进行了修改。虽然它打开了，但它并没有关闭。

以下是使其工作的代码片段：

### HTML

```
<div id="openModal" class="modalDialog">
            <div>
                <a href="#close" title="Close" class="close">X</a>
            </div>
        </div>
</div> 
```

### CSS

```
.modalDialog{
            position: fixed;
            font-family: sans;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            background: rgba(0,0,0,0.5);
            z-index: 99999;
            opacity: 0;
            -webkit-transition: opacity 400ms ease-in;
            -moz-transition: opacity 400ms ease-in;
            transition: opacity 400ms ease-in;
            pointer-events: none;
        }       
        .modalDialog:target{
            opacity: 1;
            pointer-events: visible;
        }
        .modalDialog > div {
            width: 400px;
            height: 400px;
            position: relative;
            margin: 10% auto;
            padding: 5px 20px 13px 20px;
            border-radius: 10px;
            background: #fff;
            background: -moz-linear-gradient(#fff, #999);
            background: -webkit-linear-gradient(#fff, #999);
            background: -o-linear-gradient(#fff, #999);
        }
        .close {
            background: #606061;
            color: #FFFFFF;
            line-height: 25px;
            position: absolute;
            right: -12px;
            text-align: center;
            top: -10px;
            width: 24px;
            text-decoration: none;
            font-weight: bold;
            -webkit-border-radius: 12px;
            -moz-border-radius: 12px;
            border-radius: 12px;
            -moz-box-shadow: 1px 1px 3px #000;
            -webkit-box-shadow: 1px 1px 3px #000;
            box-shadow: 1px 1px 3px #000;
        }
        .close:hover { background: #00d9ff; } 
```

### JavaScript

```
switch(where){
                case "north":
                    if(startingPos>=3){
                        startingPos -= 3;
                        status.innerHTML = messages[startingPos];
                        img.setAttribute("src",images[startingPos]);
                    }else{
                        status.innerHTML = blockedPathMsg[startingPos];
                    }
                    break;
                case "east":
                    if(startingPos%3!=2){
                        startingPos += 1;
                        status.innerHTML = messages[startingPos];
                        img.setAttribute("src",images[startingPos]);
                    }else{
                        status.innerHTML = blockedPathMsg[startingPos];
                    }
                    break;
                case "west":
                    if(startingPos%3!=0){
                        startingPos -= 1;
                        status.innerHTML = messages[startingPos];
                        img.setAttribute("src",images[startingPos]);
                    }else{
                        status.innerHTML = blockedPathMsg[startingPos];
                    }
                    break;
                case "south":
                    if(startingPos<6){
                        startingPos += 3;
                        status.innerHTML = messages[startingPos];
                        img.setAttribute("src",images[startingPos]);
                    }else{
                        status.innerHTML = blockedPathMsg[startingPos];
                    }
                    break;
                case "inventory":
                    var openModal = document.querySelector("#openModal");
                    openModal.style.opacity="1";
                    break;
                default:
                    status.innerHTML = "I do not know that";
            } 
```

**出了什么问题？为什么它不起作用？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T16:13:40.267

单击关闭按钮时，您必须执行一些操作：

```
window.onload = function () {
    var close_btns = document.querySelectorAll("#openModal a.close");
    for (var i = 0; i < close_btns.length; i++) {
        close_btns[i].onclick = function () {
            document.getElementById("openModal").style.display = "none";
        };
    }
}; 
```

使用`querySelectorAll`over可能有点矫枉过正`querySelector`，但我​​不想假设总是只有 1 个`.close`元素。

并且绝对可以改进/扩展以查找`.close`元素内的所有元素`.modalDialog`，并在单击时隐藏它们的`.modalDialog`容器。我觉得没有必要展示，因为没有提供足够的信息。

当然，我会使用`addEventListener`/`attachEvent`而不是设置`onclick`属性。

参考：

*   [https://developer.mozilla.org/en-US/docs/DOM/Document.querySelectorAll](https://developer.mozilla.org/en-US/docs/DOM/Document.querySelectorAll)
*   [https://developer.mozilla.org/en-US/docs/DOM/EventTarget.addEventListener](https://developer.mozilla.org/en-US/docs/DOM/EventTarget.addEventListener)

如果这些模态是动态添加的（或者`.close`元素是动态添加的），您要么需要在添加后立即绑定它们的事件，要么使用事件委托。您应该确定最接近的包含稳定元素，并使用它（`container`在下文中）。

```
window.onload = function () {
    var container = document.getElementById("container");
    container.onclick = function (e) {
        e = e || window.event;
        var target = e.target || e.srcElement;
        if (~(" " + target.className + " ").indexOf(" close ")) {
            // Your code to hide the parent modal
        }
    };
}; 
```

一种无需硬编码即可获得最近的父模态容器的`id`方法是：

```
var target = e.target || e.srcElement;
var pNode = target.parentNode;
while (pNode) {
    if (~(" " + target.parentNode.className + " ").indexOf(" modalDialog ")) {
        pNode.style.display = "none";
        break;
    }
    pNode = pNode.parentNode;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T16:17:38.503

它在哪里关闭JS中的窗口？我看到在“库存”的情况下不透明度设置为 1，但在任何地方都没有看到它被设置回 0。也许您缺少 js 代码的那部分，例如关闭按钮的单击事件。在 jQuery 中，它会是这样的：

```
$("#close").live("click").closest("#openModal").css("opacity", "0") 
```

# c# - 链接描述被截断

> ID：16019847
> 
> 赞同：3
> 
> 时间：2013-04-15T16:09:02.410
> 
> 标签：c#, facebook, facebook-graph-api, facebook-c#-sdk

我正在尝试发布带有标题和描述的 URL。但是，在发布到时间线后，仅显示描述的第一部分（前 3 行，没有“...”或其他显示描述的指示符被截断）。

是否有可用作链接描述的最大字符数？它是什么？但是，我尝试过多次发布；有时它比其他时候显示更多的字符。我还看到我的朋友分享的链接包含更多的文本行作为描述（Facebook 为其链接共享分配的框的高度是我的两倍）。

我认为是因为图片尺寸。但是，我尝试了几个维度，但没有任何区别。

这是我使用的代码：

```
FacebookShareLink = String.Format("https://www.facebook.com/dialog/feed?app_id={0}&link={1}&picture={2}&name={3}&caption={4}&redirect_uri={5}&description={6}"
                    , FacebookApiSecret
                    , HttpUtility.UrlEncode(landingUrl)
                    , HttpUtility.UrlEncode("__ THIS IS THE PICTURE URL __")
                    , HttpUtility.UrlEncode("__ THIS IS THE NAME __")
                    , HttpUtility.UrlEncode("__ THIS IS THE CAPTION __")
                    , "__ REDIRECT URL __"
                    , HttpUtility.UrlEncode("__ THIS IS THE DESCRIPTION __")
                    );

            Response.Redirect(FacebookShareLink); 
```

如果有显示更长描述的技巧，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-29T14:49:15.983

您正在构建一个具有最大长度的 URL（确切值不同，但根据经验，我们可以说它大约是 2k 个字符。）有关更多信息，请参阅[此问题](https://stackoverflow.com/q/417142/1552016)。

因此，根据您描述的问题，我怀疑那些被截断的描述会导致 URL 的整个长度超过`Response.Redirect()`.

作为一种解决方法，您可以使用 HTTP POST 而不是 GET（`Response.Redirect()`确实如此），有关如何执行此操作的详细信息，请参阅[此答案](https://stackoverflow.com/a/4015346/1552016)。

# perl - perl中如何添加时、分、秒

> ID：16019848
> 
> 赞同：2
> 
> 时间：2013-04-15T16:09:05.163
> 
> 标签：perl, sum

我正在尝试以格式添加小时、分钟和秒

```
HH:MM:SS 
```

小时和秒似乎添加正确，但我正在努力格式化分钟。我所做的是将小时/分钟/秒转换为秒，将它们相加并重新转换。这是我的代码。

```
 use strict;
 use warnings;

 my @total_sum = qw(10:07:03 01:01:01 02:02:02);

 my ($sum, $hrs, $mins, $sec);

         for my $t (@total_sum) {

                my ($h, $m, $s) = split /:/, $t;

                my $hm = $h*3600;
                my $tm = $m*60;

                $sum = $sum + $hm + $tm + $s;
         }

         $sec = sprintf ("%02d", $sec = $sum%60);
         $mins = int($sum/60);
         $hrs = int($sum/3600);

         print "$hrs:$mins:$sec\n"; 
```

我得到的是：

```
 13:790:06   instead of 
         13:10:06 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-15T16:17:52.367

通常最好使用 DateTime 或 Date::Manip 之类的模块来执行此类算术，但我想您想学习如何执行此操作（**编辑**：在最基本的级别上）。

确保在循环之前将 sum 初始化为 0。在除法之前，您需要先对分钟进行取模：

```
$sec = sprintf ("%02d", $sum%60);
$mins = sprintf("%02d", ($sum%3600)/60);
$hrs = int($sum/3600); 
```

**编辑：**一旦你进入时区和夏令时，事情就会变得非常复杂。以这篇文章为例：[为什么减去这两次（在 1927 年）会产生奇怪的结果？](https://stackoverflow.com/questions/6841333/why-is-subtracting-these-two-times-in-1927-giving-a-strange-result/6841479#6841479)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-15T16:18:00.660

```
 $sec = sprintf ("%02d", $sec = $sum%60);
     $mins = int($sum/60);
     $hrs = int($sum/3600); 
```

分钟计算为总和除以 60。13 小时加上 10 分钟等于 790 分钟。为什么不像使用 $sec 那样使用 $mins 做一些类似的事情呢？（取模数）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-10-20T13:50:17.280

只需[`gmtime()`](http://perldoc.perl.org/functions/gmtime.html)在几秒钟内使用输入并将其转换为您感兴趣的可读格式。

[`gmtime()`](http://perldoc.perl.org/functions/gmtime.html) ==> 返回值针对标准格林威治时区进行本地化。

**示例代码**

```
my ($sec,$min,$hour,$mday,$mon,$year,$wday,$yday,$isdst) = gmtime($sum);

print "$hour:$min:$sec\n";; 
```

如果在您的情况下**$hour > 23**，那么请使用**$yday**变量。 **$yday**是一年中的某一天，范围为 0..364（或闰年为 0..365）。

为了转换成 $hour 乘以 24，==> **$hour = ($yday * 24) + $hour;**

如果您的差异小于 364 天（或闰年为 0..365），它将起作用，但您仍然可以通过在方程中添加变量**($year-70)**使其起作用，但这会使方程更复杂，因为闰年，希望现在清楚如何使用它......

# php - 更新语句数据不进入数据库

> ID：16019854
> 
> 赞同：-2
> 
> 时间：2013-04-15T16:09:15.050
> 
> 标签：php, sql-update

```
//setting veriables
$imagestring = $_FILES["file"]["name"];
$myuser = $_POST['myusername'];

//mysql set up error handle
mysql_connect("$host", "$username", "$password")or die("cannot connect");
mysql_select_db("$db_name")or die("cannot select DB");

$chkuserid = mysql_query("select UserID from users where Username = '".$myuser."'"); 
$row = mysql_fetch_array($chkuserid); 
$finall = $row['UserID']; 
  // putting data into database
var_dump($finall);
$sql="UPDATE users SET avatarstring='k00138899.atspace.eu/photoalbum/upload/".$imagestring."' WHERE UserID='".$finall."'"; 
```

我想我尝试了用户表中的所有内容，我有头像字符串，如果上传成功，它将存储图像的路径

userid - int(25)
$finall - string
avatarstring - TEXT
文件被上传，但是图像地址的条目应该和这个操作一起进入 avatarstring 列。

上传图片的代码有效，如果上传成功，此代码将放置在 if 语句中，此代码与图片上传成功的消息一起显示

```
 else
      {
      move_uploaded_file($_FILES["file"]["tmp_name"],
      "avatar/" . $_FILES["file"]["name"]);
      echo "Stored in: " . "avatar/" . $_FILES["file"]["name"];

        // if upload successful add entry into DB
$host="fdb4.atspace.com:3306"; // Host name
$username="1259829_photo"; // Mysql username
$password="j8"; // Mysql password
$db_name="1259829_photo"; // Database name
$tbl_name="users"; // Table name

//setting veriables
$imagestring = $_FILES["file"]["name"];
$myuser = $_POST['myusername'];

//mysql set up error handle
mysql_connect("$host", "$username", "$password")or die("cannot connect");
mysql_select_db("$db_name")or die("cannot select DB");

$chkuserid = mysql_query("select UserID from users where Username = '".$myuser."'"); 
$row = mysql_fetch_array($chkuserid); 
$finall = $row['UserID']; 
  // putting data into database
var_dump($finall);
var_dump($myuser);

$sql="UPDATE users SET avatarstring='k00138899.atspace.eu/photoalbum/upload/".$imagestring."' WHERE Username='".$myuser."'";

      }
    }
  }
else
  {
  echo "Invalid file";
  }
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T16:17:13.447

呵呵，你根本就是不叫到`mysql_query( $sql);`最后……

否则它看起来很好。将鼠标悬停在您应该考虑使用`mysqli_`or`PDO`代替 deprecated`mysql_`并确保您的代码不易受到 SQL 注入攻击。

# wpf - 如何使用 DataTemplates 解决工具栏错误？

> ID：16019855
> 
> 赞同：3
> 
> 时间：2013-04-15T16:09:21.890
> 
> 标签：wpf, .net-4.0, datatemplate, toolbar

（Wpf，.Net4）

嘿，当我使用带有 DataType（并且没有键）的数据模板时，它仅适用于构造函数。（我必须那样使用它，因为我有两种不同的类型）。问题是，它可以在 .net 3.5 上运行，现在我需要升级到 .net 4。（我玩过项目的属性，发现它可以在 3.5 上运行）这是整个代码（除了默认的 App .xaml）：

MainWindow.xaml：

```
<Window x:Class="WpfApplication1.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:WpfApplication1" x:Name="me"
        Title="MainWindow" Height="350" Width="525">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="100" />
            <RowDefinition />
        </Grid.RowDefinitions>
        <ToolBar ItemsSource="{Binding ElementName=me, Path=Items}">
            <ToolBar.Resources>
                <DataTemplate  DataType="{x:Type local:Class1}">
                    <TextBlock Text="{Binding Title}" />
                </DataTemplate>
            </ToolBar.Resources>
        </ToolBar>

        <StackPanel Grid.Row="1">
            <Button Content="1"  Click="Button_Click"/>
        </StackPanel>
    </Grid>
</Window> 
```

主窗口.cs：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Navigation;
using System.Windows.Shapes;
using System.Collections.ObjectModel;

namespace WpfApplication1
{
    public partial class MainWindow : Window
    {
        public MainWindow()
        {
            Items = new ObservableCollection<Class1>();
            Items.Add(new Class1() { Title = "1" });

            InitializeComponent();
        }

        public ObservableCollection<Class1> Items { get; set; }

        private void Button_Click(object sender, RoutedEventArgs e)
        {
            Items.Add(new Class1() { Title = (Items.Count + 1).ToString() });
        }
    }

    public class Class1
    {
        public string Title { get; set; }
    }
} 
```

按钮动态添加项目，我们可以看到第一个显示它的标题，并且动态添加的项目没有应用模板。我能做些什么？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T08:39:14.533

显然渲染后不再`Toolbar`使用默认`Class1`模板。根据要求，有几种解决方案可以在这里工作。

**1)**`DataTemplate`在 App.xaml 中定义：

```
<Application.Resources>
    <ResourceDictionary>
        <ResourceDictionary.MergedDictionaries>
            <ResourceDictionary>
                <DataTemplate DataType="{x:Type TestWPF:Class1}">
                    <TextBlock Text="{Binding Title}" />
                </DataTemplate>
            </ResourceDictionary>
        </ResourceDictionary.MergedDictionaries>
    </ResourceDictionary>
</Application.Resources> 
```

假设您那里还有一些其他资源字典。如果没有，`DataTemplate`可以直接放入`Application.Resources`没有所有字典的东西。

**2）**当一个对象没有默认模板时，它只是使用它的`ToString`方法来直观地表示自己。所以你`Class1`（和其他人）可以覆盖`ToString`：

```
public class Class1
{
    public string Title { get; set; }

    public override string ToString()
    {
       return Title;
    }
} 
```

**3)** ItemControls 的标准 WPF 方法 - 有`ItemTemplate`：

```
 <ToolBar ItemsSource="{Binding ElementName=me, Path=Items}">
     <ToolBar.ItemTemplate>
         <DataTemplate>
             <TextBlock Text="{Binding Title}" />
         </DataTemplate>
     </ToolBar.ItemTemplate>
 </ToolBar> 
```

但是您说有几种类型应该具有模板，因此要使其正常工作，您[必须](http://msdn.microsoft.com/en-us/library/system.windows.controls.datatemplateselector.aspx)为`ToolBar`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-27T12:43:33.380

此问题有第四个解决方法 - 您需要使用另一个集合来形成新的工具栏内容，然后将此集合的值分配给 Items

# emacs - 禁用，或设置为始终否：“选项已更改 - 保存它们？（y 或 n）”

> ID：16019859
> 
> 赞同：2
> 
> 时间：2013-04-15T16:09:35.173
> 
> 标签：emacs, emacs24, aquamacs

请问，如何在退出时禁用此提示：“选项已更改 - 保存它们？（y 或 n）”

或者，我希望这个特定问题的答案始终为“否”，无需进一步的键盘输入即可退出。

我的 Aquamacs 2.4 的 init.el 文件正在对选项进行更改，我不想通过对问题说“是”来创建自定义项。

谢谢。

这是来自customizations.el 的代码，如果我在退出时用“是”回答提示，则会生成该代码。

```
(custom-set-variables
 '(aquamacs-additional-fontsets nil t)
 '(aquamacs-customization-version-id 215 t)
 '(aquamacs-tool-bar-user-customization nil t)
 '(default-frame-alist (quote ((background-mode . light) (border-color . "black") (mouse-color . "black") (background-color . "white") (foreground-color . "black") (menu-bar-lines . 1) (cursor-type . box) (vertical-scroll-bars . right) (internal-border-width . 0) (left-fringe . 1) (right-fringe) (fringe) (cursor-color . "red") (tool-bar-lines . 0))))
 '(global-flyspell-mode t)
 '(global-hl-line-mode t)
 '(global-linum-mode t)
 '(global-show-newlines-mode t)
 '(ns-tool-bar-display-mode (quote both) t)
 '(ns-tool-bar-size-mode (quote regular) t)
 '(size-indication-mode t)
 '(visual-line-mode nil t))

(custom-set-faces
 '(emacs-lisp-mode-default ((t (:inherit autoface-default :height 180 :family "Courier"))) t)
 '(latex-mode-default ((t (:inherit default height 180 :family "Courier"))))
 '(plain-tex-mode-default ((t (:inherit default :height 180 :family "Courier"))) t)
 '(text-mode-default ((t (:inherit autoface-default :stipple nil :strike-through nil :underline nil :slant normal :weight normal :height 180 :width normal :family "Courier"))))
 '(whitespace ((((class color) (background light)) (:background "white" :foreground "red" :weight ultra-bold :width ultra-expanded))))
 '(whitespace-space ((((class color) (background light)) (:foreground "red"))))) 
```

* * *

这是退出时可见的调试消息：

```
Debugger entered--Lisp error: (quit)
  old-y-or-n-p("Options have changed - save them? ")
  (if (and long (not aquamacs-quick-yes-or-no-prompt)) (old-yes-or-no-p text) (old-y-or-n-p text))
  (let ((text ...)) (if (and long ...) (old-yes-or-no-p text) (old-y-or-n-p text)))
  (progn (and (fboundp ...) smart-frame-positioning-mode (smart-move-minibuffer-inside-screen f)) (let (...) (if ... ... ...)))
  (if (or (and last-nonmenu-event ...) (not use-dialog-box) (not window-system)) (progn (and ... smart-frame-positioning-mode ...) (let ... ...)) (let (...) (if ... ...) ret))
  (let ((f ...)) (make-frame-visible f) (raise-frame f) (if (or ... ... ...) (progn ... ...) (let ... ... ret)))
  aquamacs-ask-for-confirmation("Options have changed - save them? \nYour customizations will be lost if you don't save them." nil "Save" "Don't Save")
  (progn (aquamacs-ask-for-confirmation "Options have changed - save them? \nYour customizations will be lost if you don't save them." nil "Save" "Don't Save"))
  (if (eq aquamacs-save-options-on-quit (quote ask)) (progn (aquamacs-ask-for-confirmation "Options have changed - save them? \nYour customizations will be lost if you don't save them." nil "Save" "Don't Save")) aquamacs-save-options-on-quit)
  (and (or aquamacs-faces-changed (filter-list changed ...)) (if (eq aquamacs-save-options-on-quit ...) (progn ...) aquamacs-save-options-on-quit))
  (if (and (or aquamacs-faces-changed ...) (if ... ... aquamacs-save-options-on-quit)) (aquamacs-menu-bar-options-save))
  (let* ((changed ...)) (if (and ... ...) (aquamacs-menu-bar-options-save)))
  (condition-case nil (let* (...) (if ... ...)) (error nil))
  aquamacs-ask-to-save-options()
  run-hook-with-args-until-failure(aquamacs-ask-to-save-options)
  (and (or (not ...) (let ... ... ...)) (run-hook-with-args-until-failure (quote kill-emacs-query-functions)) (or (null confirm-kill-emacs) (funcall confirm-kill-emacs "Really exit Aquamacs? ")) (kill-emacs))
  (progn (setq timer-idle-list) (save-some-buffers arg t) (and (or ... ...) (run-hook-with-args-until-failure ...) (or ... ...) (kill-emacs)))
  (unwind-protect (progn (setq timer-idle-list) (save-some-buffers arg t) (and ... ... ... ...)) (setq timer-idle-list saved-timer-idle-list))
  (let ((saved-timer-idle-list timer-idle-list)) (unwind-protect (progn ... ... ...) (setq timer-idle-list saved-timer-idle-list)))
  aquamacs-save-buffers-kill-emacs(nil)
  call-interactively(aquamacs-save-buffers-kill-emacs nil nil) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T05:03:55.937

好吧，需要注意的是我没有 Aquamacs，我可以在堆栈跟踪中看到似乎是答案。

看一下：
`C-h``v` `aquamacs-save-options-on-quit` `RET`

# windows - Windows中的扩展名较少的文件

> ID：16019860
> 
> 赞同：6
> 
> 时间：2013-04-15T16:09:38.910
> 
> 标签：windows, notepad

如何在 Windows 中使用记事本创建无扩展名的文件？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-04-15T16:15:08.027

我的 ESP 告诉我您正在尝试使用记事本创建它。

IE

记事本 myheader

记事本会创建一个名为 myheader.txt 的文件

你可以做

记事本我的标题。

（注意 myheader 之后的点）。这将创建一个没有扩展名的文件。

# jboss - 在 JBoss 7.1.1 中，如何让我的 WAR 依赖于我的 EAR

> ID：16019867
> 
> 赞同：0
> 
> 时间：2013-04-15T16:10:01.390
> 
> 标签：jboss, dependencies

我正在将我的 4.2.2 JBoss 应用程序迁移到 7.1.1。我的大部分工作都在工作，但是当我的 WAR 文件在它用于数据库访问的 EAR 文件之前加载时，我偶尔会遇到错误。

我目前正在通过将 WAR 放在部署目录的子目录中来延迟 WAR 的加载，但这似乎是一个混乱。

我尝试将 EAR 文件作为模块放入，他们通过放置在战争中的 jboss-deployment-structure.xml 文件使 WAR 依赖它。这似乎加载得很好，但是数据库访问没有被推动。

我尝试将耳朵添加到 WAR 清单中的依赖项标记中，但也不起作用。

有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T19:20:15.430

是的。利用`<initialize-in-order>true</initialize-in-order>`

在 application.xml 中：

```
<?xml version="1.0" encoding="UTF-8"?>
<application xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  version="6" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/application_6.xsd">

  <application-name>sampleapp</application-name>
  <initialize-in-order>true</initialize-in-order>
  <module>
    <ejb>some-ejb.jar</ejb>
  </module>
  <module>
    <web>
      <web-uri>some-web-app.war</web-uri>
      <context-root>test</context-root>
    </web>
  </module>
</application> 
```

然后您在 application.xml 中指定的订单将被兑现。

也[可以通过 maven ear 插件获得](http://maven.apache.org/plugins/maven-ear-plugin/generate-application-xml-mojo.html#initializeInOrder)。

# android - Android：是否可以以编程方式删除系统管理的通知？

> ID：16019868
> 
> 赞同：3
> 
> 时间：2013-04-15T16:10:03.053
> 
> 标签：android, android-notifications

我制作了一个配置 vpn 配置文件并连接到它的应用程序。当我连接时，我只想显示我的通知，但 android 提供了它自己的通知，该通知会在 VPN 连接的生命周期内显示。

无论如何要“删除”该通知，或者至少从屏幕顶部删除相应的图标？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-15T16:11:12.727

This is not possible on Android, sorry.

You cannot control notifications outside of your own app, regardless of whether they belong to another third party app or the system. Only your own notifications may be updated or dismissed by you.

# c# - 在页面加载时绑定 RadCombobox

> ID：16019869
> 
> 赞同：0
> 
> 时间：2013-04-15T16:10:18.710
> 
> 标签：c#, asp.net, telerik-combobox

我有一个在常规 ASP.NET 上的网页，我`ComboBox`在我的`GridView`. 我想在我的`ComboBox`. 如何编写代码以将 asp.net 中的`RadComboBox`at`PageLoad`事件与动态绑定？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T16:43:16.000

有多种方法可以将数据绑定到 RadCombobox。

以下是示例 -

[XML 字符串绑定](http://demos.telerik.com/aspnet-ajax/combobox/examples/populatingwithdata/xmlstringbinding/defaultcs.aspx)

[声明性数据源](http://demos.telerik.com/aspnet-ajax/combobox/examples/functionality/declarativedatasources/defaultcs.aspx)

[实体数据源](http://demos.telerik.com/aspnet-ajax/combobox/examples/populatingwithdata/entitydatasource/defaultcs.aspx)

[Linq 数据源](http://demos.telerik.com/aspnet-ajax/combobox/examples/populatingwithdata/linqdatasource/defaultcs.aspx)

# java - 数组中的数字添加到特定数字java

> ID：16019870
> 
> 赞同：-1
> 
> 时间：2013-04-15T16:10:24.227
> 
> 标签：java

检查数组中的任何数字是否等于特定数字的最有效方法是什么，例如：（5,3,3,9,4）的数组我想知道数组中的任何这些数字是否可以添加到 10 这将在我添加 (3,3,4) 时发生

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T17:58:37.183

我将不得不花费比现在更多的时间来提出一个非常好的解决方案，但我建议重新考虑你的策略。正如@DeepakBala 提到的，您正在描述一个 NP 完全问题。

使这一点不同的一件事是总和 (Q) 可以明显大于数组中的数字。此外，由于它们被限制在 3 到 150 之间，所以当您有 2000 个数字时，您将有很多重复。充分利用这一点 - 在使用数字之前先数好数字，您只需要担心 149 种数字。

为了让您思考为什么这很重要，请考虑将 100 万个数字按 1-100 排序。只需创建一个数组，然后计算您看到每个数字的次数。然后通过打印出每个数字适当的次数来重新创建列表。这是 O(n) 而不是正常的 O(n log(n))。

与其使用多达 2000 个数字的数组，不如考虑 150 个数组，它会告诉您每种尺寸有多少可用以及您正在使用的每种尺寸有多少。

试着把所有的大数相加，直到你得到 Q 的 150 以内，然后看看你是否有任何完美地弥补了差异。如果失败了，您将不得不弄清楚如何从那里开始。

# ruby-on-rails - Mongoid::Document 子类的 form_for 签名

> ID：16019872
> 
> 赞同：2
> 
> 时间：2013-04-15T16:10:27.930
> 
> 标签：ruby-on-rails, ruby-on-rails-3, mongoid, form-for

我有一个 Mongoid 文档：

```
class Index
  include Mongoid::Document

end 
```

“索引”的两个子类为：

```
class PercentileRankIndex < Index

end 

class SocialStockIndex < Index

end 
```

我想创建一个 form_for 说“PercentileRankIndex”，这是我现有的代码签名：

```
<%= form_for ([@index, @question]) do |f| %> 
```

去路线： `'percentile_rank_index_questions_path'`因为@index是PercentileRankIndex的实例。

但是，存在的正确路线是：`'index_questions'`

当使用适当的 _type 属性创建 Index 实例时，我的 form_for 签名应该如何？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T17:41:27.707

我使用 form_tag 来解决这种情况：

```
<%= form_tag index_questions_path(:index_id => @index.id) do  %>

  <%= label_tag :name, "Name:" %>
  <%= text_field_tag :name %>

  <%= label_tag :weight, "Weight" %>
  <%= text_field_tag :weight %>

  <div class="actions">
    <%= submit_tag "Save", :method => :post, :class => "btn btn-primary" %>
    <%= link_to 'Back',  index_questions_path, :class => "btn btn-primary" %>
  </div>
<% end %> 
```

这可能不是最干净的方法，但仍然有效。也希望看到有人提出更好的想法。

# javascript - How to reason about an early return with a variable defined after

> ID：16019883
> 
> 赞同：4
> 
> 时间：2013-04-15T16:11:03.493
> 
> 标签：javascript

I was looking through the code of a JS library and saw this pattern:

```
function module() {
    function func() {
        //...
        definedAfter();
        //...
    }
    return func;
    var x = "....";
    function definedAfter() {
        //...
        console.log(x); //outputs undefined
        //...
    }
} 
```

Google's Closure compiler flags the variable `x` as unused code, which seems reasonable, but the interesting part is that the variable is declared but with a value of `undefined` (due to hoisting).

Is this a bug in the library? Or is there some subtle behavior that is being exploited here? Maybe some type of optimization? Do different browsers act differently with regard to this example?

EDIT: I'm curious about the intent (bug or otherwise) of the original code, since it seems like `x` would always be `undefined`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T16:34:41.800

我想你理解提升，但这里是对该函数在技术上的样子的解释：

```
function module() {
    function func() {
        //...
        definedAfter();
        //...
    }
    function definedAfter() {
        //...
        console.log(x); //outputs undefined
        //...
    }
    var x;
    return func;
    x = "....";
} 
```

（我不确定被吊起的东西的实际最终顺序，但我认为这并不重要）

所以最后`x = "....";`一行永远不会被执行，但`x`仍会被声明（as `undefined`），并且可以被内部函数范围访问。

所以我不得不说图书馆有一个“错误”，因为设置`x`为“....”的行永远不会到达并且什么都不做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T16:35:03.117

根据 Benn Flynn 的评论，解析器在实际执行之前预扫描和/或编译代码。因此，它会检测块中任何行的变量范围，无论是否执行。

在浏览器的控制台中运行它：

```
var f = function() {
  // we haven't defined a local x yet, so we're tempted to think
  // that this line is mucking with window.x
  x = 1;
  console.log(x, window.x);
  return;

  // and we're tempted to think this line is never seen, because it
  // occurs after the return. but, it ensures that x is local, not global.
  var x = 2;
};
f(); 
```

在您的控制台中，您会看到如下内容：

```
1 undefined 
```

之后，`window.x`就不存在了。由于我们的声明，它没有在任何地方被提及——声明的赋值部分是否必要，我不确定。不应该。但是，如果不存在分配，我知道某些版本的 IE 会忽略声明，我不会感到惊讶。

将其与此进行比较：

```
var f = function() {
  x = 1;
  console.log(x, window.x);
  return;
  x = 2;  // this line truly does nothing.
};
f(); 
```

我们在控制台中看到了这一点：

```
1 1 
```

之后，`windows.x`是`1`。

值得注意的是，它`definedAfter()`可以正常工作，因为它不是以变量赋值形式编写的：

```
// this puts definedAfter in scope, but it's undefined unless this line is
// actually executed
var definedAfter = function() { /* whatever */ } 
```

相反，它是以“函数声明”形式编写的，不会被“执行”。

```
function definedAfter() { /* whatever */ } 
```

相反，编译器在编译期间看到它并说：“哦，这个函数是作用域的一部分。” 这种差异使您能够在变量赋值语法中精确控制您的函数何时可用。并且在函数声明形式中，能够在任何地方定义函数而无需担心执行顺序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T16:38:42.663

No, it's not a bug in the library. Yet, it's not the most elegant code.

There are two things you need to know to understand it better

1) The meaning of hoisting 2) the difference between Function expressions and Function declarations is subtle and yes different browsers act differently.

(for the latter see: [http://kangax.github.io/nfe](http://kangax.github.io/nfe))

cheers

# java - JavaFX Drag and Drop causes crash outside the Java Virtual Machine

> ID：16019885
> 
> 赞同：0
> 
> 时间：2013-04-15T16:11:06.137
> 
> 标签：java, drag-and-drop, jvm, javafx, native-code

Hi I have a small problem with JavaFXs DragandDrop(DnD)

The DnD is executed correctly, which means the file is created and moved to the right posiotion. Even if I use an existing file (then i don't create a new file), the file is correctly moved with content.

Here are the line of Code:

```
 void setupGestureSource(final Text source) {
    source.setOnDragDetected(new EventHandler<MouseEvent>() {
        @Override
        public void handle(MouseEvent event) {
            Vector<File> vec = new Vector<File>();
            Dragboard db = source.startDragAndDrop(TransferMode.ANY);
            File tmpFile = new File("test.txt");
            try {
                tmpFile.createNewFile();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            vec.add(tmpFile);
            ClipboardContent content = new ClipboardContent();
            content.putFiles(vec);
            db.setContent(content);
            event.consume();
        }
    });
} 
```

But after the event.consume() my JVM crashes and the program ends with the error:

```
java.lang.NullPointerException
at com.sun.javafx.tk.quantum.QuantumToolkit$14.actionPerformed(QuantumToolkit.java:1154)
at com.sun.glass.ui.Clipboard.actionPerformed(Clipboard.java:139)
at com.sun.glass.ui.win.WinDnDClipboard.push(Native Method)
at com.sun.glass.ui.win.WinSystemClipboard.pushToSystem(WinSystemClipboard.java:213)
at com.sun.glass.ui.SystemClipboard.flush(SystemClipboard.java:28)
at com.sun.glass.ui.ClipboardAssistance.flush(ClipboardAssistance.java:34)
at com.sun.javafx.tk.quantum.QuantumClipboard.flush(QuantumClipboard.java:197)
at com.sun.javafx.tk.quantum.QuantumToolkit.startDrag(QuantumToolkit.java:1195)
at javafx.scene.Scene$DnDGesture.dragDetectedProcessed(Scene.java:2652)
at javafx.scene.Scene$DnDGesture.process(Scene.java:2713)
at javafx.scene.Scene$DnDGesture.access$8700(Scene.java:2607)
at javafx.scene.Scene$MouseHandler.process(Scene.java:3344)
at javafx.scene.Scene$MouseHandler.process(Scene.java:3168)
at javafx.scene.Scene$MouseHandler.access$1900(Scene.java:3123)
at javafx.scene.Scene.impl_processMouseEvent(Scene.java:1563)
at javafx.scene.Scene$ScenePeerListener.mouseEvent(Scene.java:2265)
at com.sun.javafx.tk.quantum.GlassViewEventHandler$MouseEventNotification.run(GlassViewEventHandler.java:250)
at com.sun.javafx.tk.quantum.GlassViewEventHandler$MouseEventNotification.run(GlassViewEventHandler.java:173)
at java.security.AccessController.doPrivileged(Native Method)#
# A fatal error has been detected by the Java Runtime Environment:
#
#  EXCEPTION_UNCAUGHT_CXX_EXCEPTION (0xe06d7363) at pc=0x74efc41f, pid=6592, tid=6596
#
# JRE version: 7.0_17-b02
# Java VM: Java HotSpot(TM) Client VM (23.7-b01 mixed mode, sharing windows-x86 )
# Problematic frame:
# C  [KERNELBASE.dll+0xc41f]
    at 

com.sun.javafx.tk.quantum.GlassViewEventHandler.handleMouseEvent(GlassViewEventHandler.java:292)
at com.sun.glass.ui.View.handleMouseEvent(View.java:528)
at com.sun.glass.ui.View.notifyMouse(View.java:922)
at com.sun.glass.ui.win.WinApplication._runLoop(Native Method)
at com.sun.glass.ui.win.WinApplication.access$100(WinApplication.java:29)
at com.sun.glass.ui.win.WinApplication$3$1.run(WinApplication.java:73)
at java.lang.Thread.run(Thread.java:722)
Exception in thread "JavaFX Application Thread" Error: 80de0001 in checkJavaException(env) RaiseException+0x58
#
# Failed to write core dump. Minidumps are not enabled by default on client versions of Windows
#
# An error report file with more information is saved as:
# C:\Users\Apfelmaennchen\workspace\asd\hs_err_pid6592.log
#
# If you would like to submit a bug report, please visit:
#   http://bugreport.sun.com/bugreport/crash.jsp
# The crash happened outside the Java Virtual Machine in native code.
# See problematic frame for where to report the bug.
# 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T06:16:43.690

我试过你的代码，但对我来说它有效。
也许您（或您的 vm）对此文件夹没有写权限。

也许使用

```
List<File> list = new ArrayList<>(); 
```

代替

```
Vector<File> vec = new Vector<File>(); 
```

您能否发布一个完整的代码示例，以便我可以试试这个？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T14:02:30.590

这是完整的代码示例，仅供参考，我使用的是 jdk2.17 和 windows7，问题出现在 3 个不同的（windows）机器上

```
public class Main extends Application {

    @Override
    public void start(Stage primaryStage) {
        primaryStage.setTitle("Test App");
        Group rootGroup = new Group();
        Scene scene = new Scene(rootGroup);
        Text text = new Text(100,100,"Drag For new file");
        rootGroup.getChildren().add(text);
        setupGestureSource(text);
        primaryStage.setScene(scene);
        primaryStage.show();
    }

    void setupGestureSource(final Text source) {
        source.setOnDragDetected(new EventHandler<MouseEvent>() {
            @Override
            public void handle(MouseEvent event) {
                List<File> vec = new ArrayList<File>();
                Dragboard db = source.startDragAndDrop(TransferMode.ANY);
                File tmpFile = new File("test.txt");
                try {
                    tmpFile.createNewFile();
                } catch (IOException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }
                vec.add(tmpFile);
                ClipboardContent content = new ClipboardContent();
                content.putFiles(vec);
                db.setContent(content);
                event.consume();
            }
        });
    }

    public static void main(String[] args) {
        launch(args);
    }
} 
```

# arrays - 包含具有多个参数的 Twig

> ID：16019887
> 
> 赞同：18
> 
> 时间：2013-04-15T16:11:19.057
> 
> 标签：arrays, parameters, include, twig

### 有没有办法包含一个具有多个参数的 Twig 模板？

我试过这个，但没有奏效：

以下 Twig 由我的 Symfony 控制器渲染：

```
{% for object in objects %}
        {% if object.type == "simple" %}
               {% include 'BBLWebBundle:content:simple.html.twig' 
                with [{'picture': object.picture}, {'link': object.link}, {'name': object.name}, {'info': object.info}] %}

        {% elseif object.type == "mp3" %}
                {% include 'BBLWebBundle:content:mp3.html.twig'
                with [{'picture': object.picture}, {'link': object.link}, {'name': object.name}, {'info': object.info}] %}

        {% elseif object.type == "video" %}
                {% include 'BBLWebBundle:content:video.html.twig' 
                with [{'picture': object.picture}, {'link': object.link}, {'name': object.name}, {'info': object.info}] %}
        {% endif %}
{% endfor %} 
```

控制器还传递一些参数（这只是一些 Dummy-Data）：

```
 $objects['ob1']['type'] = "simple";
    $objects['ob1']['picture'] = "this is a picture";
    $objects['ob1']['link'] = "#";
    $objects['ob1']['info'] = "Oh wooow some Info";
    $objects['ob1']['name'] = "Potato";
    return $this->render('BBLWebBundle:Base:content.html.twig',
            array('objects' => $objects, 'title' => "Im very cool Title")); 
```

这是一个应包含的 Twig 模板：

```
<div>{{ picture }}</div> 
<div><a href="{{ link }}"> <h3>{{ name }}</h3></a><br />{{ info }}<br /></div> 
```

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2013-04-15T16:13:26.670

这比你想象的要容易：

```
{% include 'BBLWebBundle:content:simple.html.twig' 
     with {'picture': object.picture, 'link': object.link, 'name': object.name, 'info': object.info} %} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-02-14T13:40:29.100

现在是四年后，现在您可以包含模板列表

所以你可以改变上面的代码

```
{% for object in objects %}
    {% if object.type == "simple" %}
        {% include 'BBLWebBundle:content:simple.html.twig' 
            with [{'picture': object.picture}, {'link': object.link}, {'name': object.name}, {'info': object.info}] %}

    {% elseif object.type == "mp3" %}
        {% include 'BBLWebBundle:content:mp3.html.twig'
            with [{'picture': object.picture}, {'link': object.link}, {'name': object.name}, {'info': object.info}] %}

    {% elseif object.type == "video" %}
        {% include 'BBLWebBundle:content:video.html.twig' 
            with [{'picture': object.picture}, {'link': object.link}, {'name': object.name}, {'info': object.info}] %}
    {% endif %}
{% endfor %} 
```

到几乎一个班轮做同样简单的事情：

```
{% for object in objects %}
    {% include 'BBLWebBundle:content:' ~ object.type ~ '.html.twig' 
            with [{'picture': object.picture}, {'link': object.link}, {'name': object.name}, {'info': object.info}] %}
{% endfor %} 
```

现在假设您没有模板，`object.type`您只需将“默认”模板的路径添加到列表中，例如：

```
{% for object in objects %}
    {% include
        [
            'BBLWebBundle:content:' ~ object.type ~ '.html.twig',
            'BBLWebBundle:content:default.html.twig'
        ]    with [{'picture': object.picture}, {'link': object.link}, {'name': object.name}, {'info': object.info}] %}
{% endfor %} 
```

所以像这样如果`object.type.html.twig`找不到它只会使用`defualt.html.twig`. 它将使用从列表中找到的第一个。[更多信息可以在这里找到](http://twig.sensiolabs.org/doc/2.x/tags/include.html)

# lisp - LISP dynamic functions?

> ID：16019891
> 
> 赞同：1
> 
> 时间：2013-04-15T16:11:32.603
> 
> 标签：lisp, common-lisp

I'm trying to teach myself some LISP and while I understand most of it, I have trouble grasping the eval function. I know that it does it for us already and that it's not good to use (so I hear), but how would I make a function that just adds?

So far I was attempting/thinking

```
(setf input-prompt "Enter addition epression: ")
(setf output-prompt "The value is: ")

(defun prompt-for-input (msg)
  (format t msg))

(defun sum (expression)
  (format t "Summing ~d and ~d.~%" x y)
  (+ x y))

(defun add ()
  (prompt-for-input input-prompt)
  (let ((expression (read)))
       ((sum (expression)))
  (add))) 
```

Not really sure where to go on this, any help is appreciated.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T16:28:38.680

```
(setf input-prompt "Enter addition expression: ")
(setf output-prompt "The value is: ")

(defun prompt-for-input (msg)
  (format t msg)
  (finish-output))

(defun sum (expression)
  (let ((x (second expression))
        (y (third expression)))
    (format t "~%Summing ~d and ~d.~%" x y)
    (+ x y)))

(defun add ()
  (prompt-for-input input-prompt)
  (sum (read))) 
```

运行：

```
CL-USER > (add)
Enter addition expression: (+ 1 2)
Summing 1 and 2.
3 
```

# android - Android：九个补丁集中在一台设备上，但在另一台设备上稍微向右移动

> ID：16019892
> 
> 赞同：1
> 
> 时间：2013-04-15T16:11:40.457
> 
> 标签：android, nine-patch

我有一个九个补丁图像放在全屏视图的背景上：

![在此处输入图像描述](https://i.stack.imgur.com/z0T47.png)![在此处输入图像描述](https://i.stack.imgur.com/fa0j8.png)

它在 800x480 和 1280x720 屏幕上看起来和我想要的一样：它在左右两侧有一些相等的透明空间。但在全高清屏幕上，左侧的空白空间是右侧空间的两倍。但是我两边只有一个黑色像素，所以净空应该是相等的。

然后我像这样修改了我的图像：

![原来的](https://i.stack.imgur.com/RnBdZ.png)![缩放一](https://i.stack.imgur.com/FdbQ5.png)

现在它看起来以全高清屏幕为中心，但在 800x480 上向右移动。我怎样才能让它看起来以所有设备为中心？

现在第一个图像在全高清设备上看起来像这样（这是视图的底部）：

![在此处输入图像描述](https://i.stack.imgur.com/5qQXe.png)

第二个：

![在此处输入图像描述](https://i.stack.imgur.com/2QKbb.png)

他们在 800x480 设备上看起来反之亦然。

布局很简单：

```
 ImageView ib = new ImageView(this);
    ib.setLayoutParams(new LayoutParams(LayoutParams.MATCH_PARENT, LayoutParams.MATCH_PARENT));
    ib.setBackgroundResource(R.drawable.scroll_both_ver);
    setContentView(ib); 
```

更新：解决方案是在每个 drawable-* 文件夹中提供一个副本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T16:51:40.343

您的 9 补丁顶部中心黑色区域没有很好地居中，右侧的空间比左侧的空间大。不确定这如何解释您的问题，但尝试调整它

# git - 以编程方式使用 git rebase -i

> ID：16019900
> 
> 赞同：4
> 
> 时间：2013-04-15T16:12:05.107
> 
> 标签：git, rebase

我写了一个节点模块，它使用 git 不时进行一堆提交。考虑到如果将提交分组为一个提交会更好，我想使用“git rebase -i”将它们压缩成一个。

但是压缩只能在交互模式下进行，这意味着我需要手动编辑在调用“git rebase -i”时弹出的编辑器中的行。我想知道是否可以以编程方式执行此过程？因此，例如，当用户调用“保存”函数时，我的模块会进行一堆提交，然后自动将它们压缩在一起。

**更新**

为了更准确地说明我在做什么，当调用“保存”函数时，它会传递一堆提交以“发布”。然后我的模块将挑选这些提交并将它们放入“发布”分支。这是一个单一的“发布”操作，但它会在“发布”分支上生成一堆提交。我想做的是压缩发布时的提交，所以当我执行“git log”时，我看到的只是“发布版本 1”、“发布版本 2”等，而不是每个发布操作 5 或 10 个提交。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T21:08:07.087

在看到您对问题的更新后，以下两个选项之一可能会起作用，具体取决于您的使用情况：

* * *

第一种（也是更简单的）情况是您未发布的工作始终是一个提交序列，并且已发布的工作位于同一个分支上，但稍微落后一点：

*   你有一个`unpublished`分支和一个`published`分支。后者包含在前者中（即后面的一些提交）。
*   保存操作意味着`abcdef`来自的哈希`unpublished`现在应该是`published`.
*   它执行`git checkout published && git merge --ff-only abcdef`。
*   这会导致`published`快进到该提交。

* * *

第二个是可以发布的提交不一定是线性序列。这变得有点复杂，就像您重新排序提交一样，您可能必须解决出现的冲突。我会通过以下方式解决这个问题：

*   再次假设有`unpublished`和`published`分支。
*   保存操作包含来自`unpublished`.
*   `publish-2013-04-15-001`它应该像从当前分支一样创建一个新的临时分支`published`（新分支的名称在很大程度上无关紧要，只要它是唯一的/新的）。
*   对应保存的每个哈希执行`git cherry-pick <hash>`。（如果有多个提交，这就是你可能会遇到冲突的地方，可能需要以某种方式解决它们。）
*   完成后，检查`published`分支。
*   执行`git merge --squash -m 'Publish version <n>' publish-2013-04-15-001`。
*   （可选）删除临时分支。

由于第二个选项引入了更多复杂性，因此您可能需要考虑其他选项以更轻松地调试已发布的进程：

*   我应该保留临时分支以进行跟踪/记录吗？
*   单个提交是否可以在合并的分支上分开（省略`--squash`）？
*   如果是这样，您可以通过强制合并提交 ( `--no-ff`) 来识别保存。

**编辑**：这是一个使用`--no-ff`. 每个版本`$N`执行以下操作：

```
git checkout -b publish-$N published
# cherry-pick commits
git checkout published && git merge --no-ff publish-$N -m "Publish version $N" 
```

![示例 tig 图](https://i.stack.imgur.com/sbVqQ.png)

# listview - Cross-slide with nested scrollviewers in WinRT Xaml

> ID：16019901
> 
> 赞同：1
> 
> 时间：2013-04-15T16:12:06.433
> 
> 标签：listview, winrt-xaml, scrollviewer

I am building an application which requires a horizontal list of vertical lists

Simplified XAML layout:

```
<ScrollViewer>
    <ItemsControl ItemsSource="{Binding Lists}">
        <ItemsControl.ItemsPanel>
            <ItemsPanelTemplate>
                <StackPanel Orientation="Horizontal"/>
            </ItemsPanelTemplate>
        </ItemsControl.ItemsPanel>
        <ItemsControl.ItemTemplate>
            <DataTemplate>
                <ListView ItemsSource="{Binding Items}"/>
            </DataTemplate>
        </ItemsControl.ItemTemplate>
    </ItemsControl>
</ScrollViewer> 
```

I am having trouble getting the touch interactions right. Currently horizontal swipes move the entire list horizontally, and vertical move individual lists' items vertically. However it is possible to move *both* lists with a diagonal swipe, and it's not possible to scroll multiple vertical lists at a time (it is without the outer scrollviewer).

Is there a way to make all horizontal swipes apply only to the outer scrollviewer, and all vertical swipes only to an inner listview?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T21:03:57.823

如果您在两个 ScrollViewers 上设置[`IsHorizontalRailEnabled`](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.controls.scrollviewer.ishorizontalrailenabled.aspx)/属性，您可能会得到想要的效果。[`IsVerticalRailEnabled`](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.controls.scrollviewer.isverticalrailenabled.aspx)

您还可以`ScrollViewer.IsHorizontalRailEnabled`在 a`GridView`或`ScrollViewer.IsVerticalRailEnabled`a上设置类似的内容，`ListView`而无需提取模板来访问它们的`ScrollViewers`.

# adt - 如何在 Ada 中找到僵尸？

> ID：16019902
> 
> 赞同：0
> 
> 时间：2013-04-15T16:12:09.047
> 
> 标签：adt, ada, zombie-process

我试图使用 System.Adress_image 列出程序中分配对象的所有地址。

但是我只能打印我拥有的变量的地址。例如，我有一个堆栈，我可以打印所有堆栈元素的地址。然后我删除指向堆栈节点之一的指针，以便该对象不再在堆栈中。

删除的节点不会自动进行垃圾收集（Ada 2005），所以我想知道该节点的地址。为什么不是程序中所有分配对象的地址？

我怎样才能完成这项任务？

系统包： http: [//www.adaic.org/resources/add_content/standards/05aarm/html/AA-13-7.html](http://www.adaic.org/resources/add_content/standards/05aarm/html/AA-13-7.html)

僵尸被称为“死物但仍然活着”。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-15T16:37:28.803

两种可能性：

将分配的对象实现为受控类型，并将它们的地址记录为 Initialize、Adjust、Finalize 例程的一部分。

为它们实施自定义[存储池](http://www.adaic.org/resources/add_content/standards/05aarm/html/AA-13-11.html)，使用自定义分配和解除分配例程来收集您需要的信息。

或者，找到一种方法来使用 Ada.Containers 库来实现您的存储类型，让 IT 担心清理僵尸......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T07:30:09.380

如果您希望走出 Ada 并寻找内存泄漏，我会推荐[valgrind](http://valgrind.org/)它将在您的程序中找到内存泄漏和其他 gremlins。

# r - 如何将列表与 R 中另一个列表的元素结合起来？

> ID：16019906
> 
> 赞同：0
> 
> 时间：2013-04-15T16:12:17.710
> 
> 标签：r

我知道有一个简单的功能，但我无法在任何地方找到它。我有：

```
a <- list(a=1,b=2)
b <- list(c=3,d=4)
c <- list(e=5,f=6) 
```

我想要一个包含 4 个元素的列表，列表 a、列表 b 和列表 c 的组件：

```
list(list(a=1, b=2), list(c=3, d=4), e = 5, f = 6) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T16:40:07.490

You can just use the `c` operator:

```
c(list(a,b), c) 
```

# c# - Retrieve table name from SQL Create statement in C#

> ID：16019907
> 
> 赞同：0
> 
> 时间：2013-04-15T16:12:30.360
> 
> 标签：c#, sql, sql-server-2008

Say I have code that executes a sql create table statement from outside my code, like so:

```
SqlConnection connection = new SqlConnection(aConnectionString);
connection.Open();
string createTable = System.IO.File.ReadAllText("CreateTable.sql");
SqlCommand command = new SqlCommand(createTable, connection);
command.ExecuteNonQuery(); 
```

Is it possible to determine the name of the newly created table WITHOUT parsing it directly from the sql statement string?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T08:04:30.930

这不是我认为的最佳解决方案……但是您可以使用此查询在数据库中创建/更改最后一个表。

```
select name,type,type_desc, create_date, modify_date from sys.objects
where  convert(varchar,modify_date,101)  =  convert(varchar,getdate(),101) AND type = 'U'
order by modify_date desc 
```

# matlab - 在 Matlab 中将两个表的 2 列合并到第三个表

> ID：16019914
> 
> 赞同：0
> 
> 时间：2013-04-15T16:12:48.737
> 
> 标签：matlab

例如，我有两张桌子

```
1 120
2 100
3 400
4 600 
```

和

```
1  150
2  300
3  700
4  350 
```

我想用这些值创建第三个表

```
120   150
100   300
400   700
600   350 
```

知道我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T16:14:41.960

```
table3 = [table1(:,2) table2(:,2)]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-15T16:14:47.987

如果你有：

```
a = [1 120
     2 100
     3 400
     4 600]; 
```

和

```
b = [1  150
     2  300
     3  700
     4  350]; 
```

然后

```
c = [a(:,2) b(:,2)]; 
```

# ios - 在 facebook 中获取用户电子邮件和位置

> ID：16019918
> 
> 赞同：0
> 
> 时间：2013-04-15T16:13:01.940
> 
> 标签：ios, xcode, facebook

我被困在中间。我无法使用以下代码检索用户电子邮件和位置。有人可以帮我解决这个问题吗？

```
[[FBRequest requestForMe] startWithCompletionHandler:
 ^(FBRequestConnection *connection, NSDictionary<FBGraphUser> *user, NSError *error) {
     if (!error) {
         NSLog(@"%@",user);
     }
 }]; 
```

基本上我正在使用 Facebook 3.2 SDK 并遵循 Scrumptious 示例。我不知道如何从中检索用户 emailID 和位置？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T11:50:46.633

我对 FBLOGINVIEW 类有点无知。有一个调用的属性，您可以通过该属性从[FBLoginView](https://developers.facebook.com/docs/reference/ios/3.0/class/FBLoginView/)`readPermission`设置所有必需的读取权限。

# javascript - extjs 在加载时对窗口组件执行一些操作

> ID：16019922
> 
> 赞同：0
> 
> 时间：2013-04-15T16:13:13.253
> 
> 标签：javascript, extjs

当此窗口弹出时，我试图禁用窗口上的按钮，但是无论我尝试应用什么处理程序，都不会弹出窗口，只是向我吐出“未定义”的员工。例如我试过：

```
window.onload = Ext.getCmp('buttonId').disable(); 
```

它在控制台中返回给我：

```
Uncaught TypeError: Cannot call method 'disable' of undefined 
```

提前谢谢大家！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T17:47:12.910

您可能没有`id`设置按钮...

为什么不直接禁用按钮？

```
Ext.create('Ext.Button', {
    text: 'Disabled button',
    disabled:true
}); 
```

如果你`id`在那里，它可以工作：

```
Ext.create('Ext.Button', {
    text: 'Dynamically disabled Button',
    id:'dynamicBtn',
    renderTo: Ext.getBody(),
    handler: function() {
        alert('You clicked the button!');
    }
});

Ext.application({
    name: 'MyApp',
    launch: function () {
        Ext.getCmp('dynamicBtn').disable();
    },
}); 
```

[http://jsfiddle.net/4fPSf/](http://jsfiddle.net/4fPSf/)

# properties - 有时无法连接到远程 DB2 数据库

> ID：16019923
> 
> 赞同：1
> 
> 时间：2013-04-15T16:13:16.247
> 
> 标签：properties, db2, host, required

我在尝试连接到远程 DB2 数据库时遇到了一些问题。奇怪的是，有时可以，但有时不行，即我不能总是重现这种行为。

错误如下：

```
Caused by: com.ibm.db2.jcc.am.SqlNonTransientConnectionException: [jcc][t4][10380][11951][3.64.114] Required property "<DB_NAME>" is unknown host. ERRORCODE=-4222, SQLSTATE=08001 
```

其中 DB_NAME 是我的主机名。始终可以使用 ping 和 nslookup 解析地址。正如我所说，这只会不时发生。有谁知道这个问题？也许对时间桶策略中的活动连接数或 X 连接数有一些配置限制？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T08:51:47.307

可能是网络问题阻止了应用程序（Java）和数据库服务器之间的连接，因此无法解决数据库服务器。

请检查网络以查找错误。

# database - 数据仓库中的时间点快照

> ID：16019925
> 
> 赞同：4
> 
> 时间：2013-04-15T16:13:24.660
> 
> 标签：database, database-design, data-warehouse, etl

我正在尝试在确切的时间点重新创建客户的状态。例如，每个客户都有许多可以随时更改的属性（例如，风险评分、最新账单、客户满意度）。

每次客户提交信用申请时，我都希望在提交时查看所有这些特征的价值。随后，我想使用这些值来开发预测模型。

我的第一个想法是创建一个具有有效和到期日期/时间戳的 Type-2 缓慢变化维度，并使用半开连接 time_effective <= date_of_application < time_expired。

然而，这些属性中的大多数都是行为维度，需要使用事实表中的历史数据进行复杂的计算。此外，计算值也不能使用范围（0-500 美元、500-750 美元等）进行分组。跟踪每个维度的所有这些属性会导致它爆炸。注意：有些值每天都在变化，有些值在任意时间点变化。

我理想的数据提取如下：

*   信用申请ID#
*   提交时间
*   提交时属性 1 的值
*   属性 2 的值...
*   属性 N 的值

除了信用申请之外，还有其他事实表，我想在其中找到在该事件发生时有效的特征。

处理此问题的建议是什么？我看到了几种方法：

1.  允许维度爆炸
2.  创建具有一个或多个属性的单独表，并分别查询具有我感兴趣的属性的特定表
3.  在信用申请事实表中附加一列，其中包含我感兴趣的所有属性的“快照”。

Kimball 的 ETL Toolkit book (pp 190-192) 和他的 Data Warehouse Toolkit book (187-191) 中讨论了其中一些问题。在第 154-157 页，有一个关于“快速变化的怪物维度”的讨论，这似乎非常相关。不过，我在执行这些建议时遇到了麻烦。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T11:54:36.110

我将创建单独的应用程序事实表，其中包含相关表和相关记录的键。假设您有以下维度和事实表：

*   (D) 申请
*   (D) 申请人（或客户）
*   (四)产品
*   (D) 时间
*   (D)monthly_scoring_fact（每月行为评分）
*   (F)monthly_satisfaction_fact（每月满意度调查）
*   (F) 满意度评估事实（ad hoc满意度评估）

然后您可以创建以下事实表Application Fact：

*   application_key - 指向应用维度
*   申请人键 - 指向申请人维度
*   product_key - 指向产品维度
*   time_key - 指向时间维度
*   monthly_scoring_fact_key - 指向每月评分的最后结果
*   monthly_satisfaction_fact_key - 指向最后的满意度数据
*   满意度评估事实密钥 - 指向最后的临时评估数据

使用这种方法，您可以获得时间一致的数据并将应用程序维度保持在 SCD0（仅更正）。

# ruby-on-rails - 为 Rails 对象创建临时属性并传递给 View

> ID：16019932
> 
> 赞同：2
> 
> 时间：2013-04-15T16:13:44.393
> 
> 标签：ruby-on-rails, activerecord

我有一个考试模型，它有一个数据库属性`score`。现在，我想要另一个名为 的属性`rating`，它将这个分数转换为评分（A、B、C、D、F）。我不想为 再创建一列`rating`，所以我使用了虚拟属性，如下所示：

```
 class Exam < ActiveRecord::Base
     attr_accessor :rating
     after_initialize :set_rating
     after_find :set_rating

     private
     def set_rating
        self.rating = case score
          when 0..49 then "F"
          when 50..79 then "B"
          else "A" 
     end
 end 
```

在我可以调用的意义上，这很有效

```
e = Exam.find_by_student("John")
e.rating 
```

但是，该对象`e`没有附加属性等级。因此，如果我将对象传递`e`给 Rails 视图，我将无法获得`e.rating`评级是一个属性的位置。

我怎样才能实现我想要的，即 after_find 可用的无数据库属性？

谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-15T16:16:34.947

放弃所有这些，只需定义一个名为`rating`.

```
class Exam < ActiveRecord::Base

  # ...

  def rating
    case score
      when 0..49 then "F"
      when 50..79 then "B"
      else "A" 
    end
  end

end 
```

如果您需要在 JSON 响应中包含此“属性”，您可以将`:methods`参数传递[`as_json`](http://apidock.com/rails/ActiveModel/Serializers/JSON/as_json)给以显式包含它：

```
render json: @exam.as_json(members: :rating) 
```

# c# - C# 匹配带有可选参数的子字符串

> ID：16019933
> 
> 赞同：0
> 
> 时间：2013-04-15T16:13:45.990
> 
> 标签：c#, regex, collections, match

我想匹配这个：

```
01+WhATEver 02+0.1 03+12.1\r\n 
```

或这个

```
01+WhATEver 02+0.1\r\n 
```

在我以任何顺序解析的字符串中出现这样

```
01+WhATEver 02+0.1 03+12.1\r\n01+WhATEver 02+0.1 03+12.1\r\n01+WhATEver 02+0.1 03+12.1\r\n 
```

01-02 是必需的，03 是可选参数。索引看起来像“01+”，后面可以跟这样的减号。

```
01+WhATEver 02+-0.1\r\n 
```

我能够解析强制索引和变量，但不包括可选索引和变量...因为如果丢失它将不匹配。

```
01\\+\\s*(?<1>[.0-9A-Za-z]*)\\s*02\\+\\s*(?<2>[.0-9]*)\\s*03\\+\\s*(?<3>[.0-9]*)\\s* 
```

我需要的是一个正则表达式，它将与包含许多此类子字符串的字符串中的 01-02 索引或 01-03 匹配。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T16:23:19.293

你不能让那个组是可选的吗？像这样：

```
"01\\+\\s*(?<1>[.0-9A-Za-z]*)\\s*02\\+\\s*(?<2>[.0-9]*)(\\s*03\\+\\s*(?<3>[.0-9]*)\\s*)?"
                                                       ^                              ^^ 
```

（我在添加到正则表达式中的字符下划线。）

# excel-2010 - 宏将列数据复制到另一个工作表中，直到源工作表中的最后一行数据

> ID：16019939
> 
> 赞同：0
> 
> 时间：2013-04-15T16:14:01.927
> 
> 标签：excel-2010

我正在尝试将数据从源工作表复制到另一个工作表，直到最后一行数据。如何将宏限制到最后一行数据。下面是为获取数据而创建的宏。

' Sub ABringData() ' ' BringData 宏 ' ' Sub ABringData()

```
Columns("G:G").Select
Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
Range("G1").Select
ActiveCell.FormulaR1C1 = "=Data!RC[-4]"
Range("G2").Select
Columns("G:G").EntireColumn.AutoFit
Range("G1").Select
Selection.AutoFill Destination:=Range("G:G")
Range("G:G").Select
Columns("G:G").EntireColumn.AutoFit
Columns("G:G").Select
With Selection.Font
    .Color = -16776961
    .TintAndShade = 0
End With
Columns("AA:AA").Select
Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
Range("AA1").Select
ActiveWindow.SmallScroll ToRight:=1
ActiveCell.FormulaR1C1 = "=Data!RC[-20]"
Range("AA1").Select
Selection.AutoFill Destination:=Range("AA:AA")
Range("AA:AA").Select
With Selection
    .HorizontalAlignment = xlLeft
    .VerticalAlignment = xlBottom
    .WrapText = False
    .Orientation = 0
    .AddIndent = False
    .IndentLevel = 0
    .ShrinkToFit = False
    .ReadingOrder = xlContext
    .MergeCells = False
End With
With Selection.Font
    .Color = -16776961
    .TintAndShade = 0
End With
ActiveWindow.SmallScroll ToRight:=-12
Columns("G:G").Select
With Selection
    .HorizontalAlignment = xlLeft
    .VerticalAlignment = xlBottom
    .WrapText = False
    .Orientation = 0
    .AddIndent = False
    .IndentLevel = 0
    .ShrinkToFit = False
    .ReadingOrder = xlContext
    .MergeCells = False
End With
Range("G4").Select 
```

结束子

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T09:16:27.743

```
Sub ABringData()

'************* Add this ***************
Dim intLastRow As Integer
Dim strRange As String

intLastRow = Cells.Find("*", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row
'************** End Add ****************

Columns("G:G").Select
Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
Range("G1").Select
ActiveCell.FormulaR1C1 = "=Data!RC[-4]"
Range("G2").Select
Columns("G:G").EntireColumn.AutoFit
Range("G1").Select

'************* Add this ***************
strRange = "G1:G" & intLastRow
Selection.AutoFill Destination:=Range(strRange)
 '************** End Add ****************

Range("G:G").Select
Columns("G:G").EntireColumn.AutoFit
Columns("G:G").Select

With Selection.Font
.Color = -16776961
.TintAndShade = 0
End With

Columns("AA:AA").Select
Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
Range("AA1").Select
ActiveWindow.SmallScroll ToRight:=1
ActiveCell.FormulaR1C1 = "=Data!RC[-20]"
Range("AA1").Select

'************* Add this ***************
strRange = "AA1:AA" & intLastRow
Selection.AutoFill Destination:=Range(strRange)
'************** End Add ****************

Range("AA:AA").Select

With Selection
.HorizontalAlignment = xlLeft
.VerticalAlignment = xlBottom
.WrapText = False
.Orientation = 0
.AddIndent = False
.IndentLevel = 0
.ShrinkToFit = False
.ReadingOrder = xlContext
.MergeCells = False
End With

With Selection.Font
.Color = -16776961
.TintAndShade = 0
End With

ActiveWindow.SmallScroll ToRight:=-12
Columns("G:G").Select

With Selection
.HorizontalAlignment = xlLeft
.VerticalAlignment = xlBottom
.WrapText = False
.Orientation = 0
.AddIndent = False
.IndentLevel = 0
.ShrinkToFit = False
.ReadingOrder = xlContext
.MergeCells = False
End With

Range("G4").Select

End Sub 
```

# mvvm - Kendo UI：更新一列数据以更改另一列中的值

> ID：16019940
> 
> 赞同：2
> 
> 时间：2013-04-15T16:14:04.617
> 
> 标签：mvvm, kendo-ui, kendo-grid

**场景** 我有一个产品详细信息网格，在编辑时会打开一个包含该记录详细信息的弹出窗口。除数量字段外，所有字段都是只读的。因此，当我增加或减少数量时，价格列应根据值反映。因此，如果 1 的数量为 10，那么当我将数量增加到 2 时，它应该反映为 20。

**问题** 1）我已经研究过编辑器方法，我必须在数量列上使用相同的方法对吗？？

2）如何获取价格列的值并更新其值？有没有像编辑器这样的内置方法？我该怎么走？？

以下是我准备的 JS fiddle。[http://jsbin.com/ugeref/3/edit](http://jsbin.com/ugeref/3/edit)

谢谢！！

- 哈迪克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T21:01:57.490

将您定义`DataSource`为：

```
var dataSource = new kendo.data.DataSource({
    data  : data,
    schema: {
        model: {
            id    : "Id",
            fields: {
                productName: { editable: false},
                quantity   : { editable: true, type : "number" },
                price      : { editable: false, type : "number" },
                total      : { editable: false, type : "number" }
            }
        }
    }
}); 
```

您应该在其中添加一个`total`字段`quantity`times `price`。 **注意**：此外，我已经定义了不同字段的类型，让 KendoUI 知道它们是数字并生成正确的小部件。

然后，定义`grid`为：

```
$("#grid").kendoGrid({
    dataSource: dataSource,
    pageable  : true,
    height    : 400,
    toolbar   : ["create"],
    columns   : [
        { field: "productName", title: "Product Name" },
        { field: "quantity", title: "Quantity", format: "{0:c}"},
        { field: "total", title: "Total", template: "#= quantity * price #", width: "150px" },
        { command: ["edit", "destroy"], title: "&nbsp;" }
    ],
    editable  : "popup"
}); 
```

我在其中添加了一个`Total`使用模板的列，该模板是`quantity * price`.

每次更新`quantity`，`total`都会得到`updated`。

看到你在[这里修改的代码](http://jsbin.com/ugeref/5)

# vba - 查找形状的类型

> ID：16019942
> 
> 赞同：0
> 
> 时间：2013-04-15T16:14:06.483
> 
> 标签：vba, powerpoint, shapes

我想在 PowerPoint 演示文稿中展示我拥有的所有形状类型。我尝试使用这些代码：

```
Private Sub CommandButton1_Click()

Dim it As String
Dim i As Integer
Dim Ctr As Integer
'''''''''''''''''
'Read-only  Long
'''''''''''''''''
For Each slid In ActivePresentation.Slides
    For Each s In slid.Shapes
    'No need to select the object in order to use it
    With s

    'But it is easier to watch when the object is selected
    'This next line is for demonstration purposes only.
    'It is not necessary
    s.Select

    Select Case .Type

        'Type 1
        Case msoAutoShape
            it = "an AutoShape. Type : " & .Type

        'Type 2
        Case msoCallout
            it = "a Callout. Type : " & .Type

        'Type 3
        Case msoChart
            it = "a Chart. Type : " & .Type

        'Type 4
        Case msoComment
            it = "a Comment. Type : " & .Type

        'Type 5
        Case msoFreeform
            it = "a Freeform. Type : " & .Type

        'Type 6
        Case msoGroup
            it = "a Group. Type : " & .Type

        ' If it's a group them iterate thru
        ' the items and list them

            it = it & vbCrLf & "Comprised of..."
            For Ctr = 1 To .GroupItems.Count
                it = it & vbCrLf & _
                    .GroupItems(Ctr).Name & _
                    ". Type:" & .GroupItems(Ctr).Type
            Next Ctr

        'Type 7
        Case msoEmbeddedOLEObject
            it = "an Embedded OLE Object. Type : " & .Type

        'Type 8
        Case msoFormControl
            it = "a Form Control. Type : " & .Type

        'Type 9
        Case msoLine
            it = "a Line. Type : " & .Type

        'Type 10
        Case msoLinkedOLEObject
            it = "a Linked OLE Object. Type : " & .Type
            With .LinkFormat
                it = it & vbCrLf & "My Source: " & _
                    .SourceFullName
            End With

        'Type 11
        Case msoLinkedPicture
            it = "a Linked Picture. Type : " & .Type
            With .LinkFormat
                it = it & vbCrLf & "My Source: " & _
                    .SourceFullName
            End With

        'Type 12
        Case msoOLEControlObject
            it = "an OLE Control Object. Type : " & .Type

        'Type 13
        Case msoPicture
            it = "a embedded picture. Type : " & .Type

        'Type 14
        Case msoPlaceholder
            it = "a text placeholder (title or regular text--" & _
                 "not a standard textbox) object." & _
                 "Type : " & .Type

        'Type 15
        Case msoTextEffect
            it = "a WordArt (Text Effect). Type : " & .Type

        'Type 16
        Case msoMedia
            it = "a Media object .. sound, etc. Type : " & .Type
            With .LinkFormat
                it = it & vbCrLf & " My Source: " & _
                .SourceFullName
            End With

        'Type 17
        Case msoTextBox
            it = "a Text Box."

        'Type 18 = msoScriptAnchor, not defined in PPT pre-2000 so we use the numeric value
        'Case msoScriptAnchor
        Case 18
            it = " a ScriptAnchor. Type : " & .Type

        'Type 19 = msoTable, not defined in PPT pre-2000 so we use the numeric value
        'Case msoTable
        Case 19
            it = " a Table. Type : " & .Type

        'Type 19 = msoCanvas, not defined in PPT pre-2000 so we use the numeric value
        'Case msoCanvas
        Case 20
            it = " a Canvas. Type : " & .Type

        'Type 21 = msoDiagram, not defined in PPT pre-2000 so we use the numeric value
        'Case msoDiagram
        Case 22
            it = " a Diagram. Type : " & .Type

        'Type 22 = msoInk, not defined in PPT pre-2000 so we use the numeric value
        'Case msoInk
        Case 22
            it = " an Ink shape. Type : " & .Type

        'Type 23 = msoInkComment, not defined in PPT pre-2000 so we use the numeric value
        'Case msoInkComment
        Case 23
            it = " an InkComment. Type : " & .Type

        'Type -2
        Case msoShapeTypeMixed
            it = "a Mixed object (whatever that might be)." & _
                 "Type : " & .Type

        'Just in case
        Case Else
            it = "a mystery!? An undocumented object type?" & _
                    " Haven't found one of these yet!"
    End Select

    MsgBox ("I'm " & it)
    End With
Next
Next
End Sub 
```

我从这个代码中获取了代码并进行了一些修改，但没有人适合我：

```
 Sub Object_Types_on_This_Slide()
'Refers to each object on the current page and returns the Shapes.Type
'Can be very useful when searching through all objects on a page
Dim it As String
Dim i As Integer
Dim Ctr As Integer
'''''''''''''''''
'Read-only  Long
'''''''''''''''''
For i = 1 To ActiveWindow.Selection.SlideRange.Shapes.Count
    'No need to select the object in order to use it
    With ActiveWindow.Selection.SlideRange.Shapes(i)

    'But it is easier to watch when the object is selected
    'This next line is for demonstration purposes only.
    'It is not necessary
    ActiveWindow.Selection.SlideRange.Shapes(i).Select

    Select Case .Type

        'Type 1
        Case msoAutoShape
            it = "an AutoShape. Type : " & .Type

        'Type 2
        Case msoCallout
            it = "a Callout. Type : " & .Type

        'Type 3
        Case msoChart
            it = "a Chart. Type : " & .Type

        'Type 4
        Case msoComment
            it = "a Comment. Type : " & .Type

        'Type 5
        Case msoFreeform
            it = "a Freeform. Type : " & .Type

        'Type 6
        Case msoGroup
            it = "a Group. Type : " & .Type

        ' If it's a group them iterate thru
        ' the items and list them

            it = it & vbCrLf & "Comprised of..."
            For Ctr = 1 To .GroupItems.Count
                it = it & vbCrLf & _
                    .GroupItems(Ctr).Name & _
                    ". Type:" & .GroupItems(Ctr).Type
            Next Ctr

        'Type 7
        Case msoEmbeddedOLEObject
            it = "an Embedded OLE Object. Type : " & .Type

        'Type 8
        Case msoFormControl
            it = "a Form Control. Type : " & .Type

        'Type 9
        Case msoLine
            it = "a Line. Type : " & .Type

        'Type 10
        Case msoLinkedOLEObject
            it = "a Linked OLE Object. Type : " & .Type
            With .LinkFormat
                it = it & vbCrLf & "My Source: " & _
                    .SourceFullName
            End With

        'Type 11
        Case msoLinkedPicture
            it = "a Linked Picture. Type : " & .Type
            With .LinkFormat
                it = it & vbCrLf & "My Source: " & _
                    .SourceFullName
            End With

        'Type 12
        Case msoOLEControlObject
            it = "an OLE Control Object. Type : " & .Type

        'Type 13
        Case msoPicture
            it = "a embedded picture. Type : " & .Type

        'Type 14
        Case msoPlaceholder
            it = "a text placeholder (title or regular text--" & _
                 "not a standard textbox) object." & _
                 "Type : " & .Type

        'Type 15
        Case msoTextEffect
            it = "a WordArt (Text Effect). Type : " & .Type

        'Type 16
        Case msoMedia
            it = "a Media object .. sound, etc. Type : " & .Type
            With .LinkFormat
                it = it & vbCrLf & " My Source: " & _
                .SourceFullName
            End With

        'Type 17
        Case msoTextBox
            it = "a Text Box."

        'Type 18 = msoScriptAnchor, not defined in PPT pre-2000 so we use the numeric value
        'Case msoScriptAnchor
        Case 18
            it = " a ScriptAnchor. Type : " & .Type

        'Type 19 = msoTable, not defined in PPT pre-2000 so we use the numeric value
        'Case msoTable
        Case 19
            it = " a Table. Type : " & .Type

        'Type 19 = msoCanvas, not defined in PPT pre-2000 so we use the numeric value
        'Case msoCanvas
        Case 20
            it = " a Canvas. Type : " & .Type

        'Type 21 = msoDiagram, not defined in PPT pre-2000 so we use the numeric value
        'Case msoDiagram
        Case 22
            it = " a Diagram. Type : " & .Type

        'Type 22 = msoInk, not defined in PPT pre-2000 so we use the numeric value
        'Case msoInk
        Case 22
            it = " an Ink shape. Type : " & .Type

        'Type 23 = msoInkComment, not defined in PPT pre-2000 so we use the numeric value
        'Case msoInkComment
        Case 23
            it = " an InkComment. Type : " & .Type

        'Type -2
        Case msoShapeTypeMixed
            it = "a Mixed object (whatever that might be)." & _
                 "Type : " & .Type

        'Just in case
        Case Else
            it = "a mystery!? An undocumented object type?" & _
                    " Haven't found one of these yet!"
    End Select

    MsgBox ("I'm " & it)
    End With
Next i
End Sub 
```

为什么它不工作？难道我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T12:56:48.023

我找到了一种在幻灯片运行时制作它的方法。这是代码：

```
 Private Sub CommandButton2_Click()
Dim sNum As Integer
Dim stri As String
Dim i, j As Integer
Dim right As Boolean
Dim value As MsoShapeType
Dim it As String
right = True
k = 0
j = 0
it = "Cannot convert the file due to the following problems:" & vbNewLine & vbNewLine

'ActivePresentation.Slides(1).Hyperlinks(1).SubAddress
For Each sld In ActivePresentation.Slides

    For i = 1 To sld.Shapes.Count

            'Type 1
            If sld.Shapes(i).Type = msoAutoShape Then
                it = it & "AutoShape" & vbNewLine

                right = False
            End If

            'Type 2
            If sld.Shapes(i).Type = msoCallout Then
                it = it & "Callout." & vbNewLine

                right = False
            End If

            'Type 3
            If sld.Shapes(i).Type = msoChart Then
                it = it + "Chart." & vbNewLine

                right = False
            End If

            'Type 4
            If sld.Shapes(i).Type = msoComment Then
                'it = it + "a Comment. Type : " & .Type
            End If

            'Type 5
            If sld.Shapes(i).Type = msoFreeform Then
                it = it + "Freeform." & vbNewLine

                right = False
            End If

            'Type 6
            If sld.Shapes(i).Type = msoGroup Then
                it = it + "Group." & vbNewLine

            ' If it's a group them iterate thru
            ' the items and list them

                it = it & vbCrLf & "Comprised of..."
                'For Ctr = 1 To .GroupItems.Count
                '    it = it & vbCrLf & _
                 '       .GroupItems(Ctr).Name & _
                '        ". Type:" & .GroupItems(Ctr).Type & vbNewLine
                'Next Ctr

                right = False
            End If

            'Type 7
            If sld.Shapes(i).Type = msoEmbeddedOLEObject Then
                it = it + "Embedded OLE Object" & vbNewLine

                right = False
            End If

            'Type 8
            If sld.Shapes(i).Type = msoFormControl Then
                it = it + "Form Control" & vbNewLine

                right = False
            End If

            'Type 9
            If sld.Shapes(i).Type = msoLine Then
                'it = it + "a Line. Type : " & .Type
            End If

            'Type 10
            If sld.Shapes(i).Type = msoLinkedOLEObject Then
                'it = it + "a Linked OLE Object. Type : " & .Type
                'With .LinkFormat
                '    it = it & vbCrLf & "My Source: " & _
                '        .SourceFullName
                'End With
            End If

            'Type 11
            If sld.Shapes(i).Type = msoLinkedPicture Then
                it = it + "Linked Picture" & vbNewLine
                'With .LinkFormat
                '    it = it + it & vbCrLf & "My Source: " & _
                '        .SourceFullName
                'End With

                right = False
            End If

            'Type 12
            If sld.Shapes(i).Type = msoOLEControlObject Then
                it = it & "OLE Control Object" & vbNewLine

                right = False
            End If

            'Type 13
            If sld.Shapes(i).Type = msoPicture Then
                it = it & "Embedded picture" & vbNewLine

                right = False
            End If

            'Type 14
            If sld.Shapes(i).Type = msoPlaceholder Then
                'it = it & "text placeholder (title or regular text--" & _
                 '    "not a standard textbox) object." & _
                 '    "Type : " & .Type

                  '   right = False
            End If

            'Type 15
            If sld.Shapes(i).Type = msoTextEffect Then
                'it = it + "WordArt (Text Effect). Type : " & .Type
            End If

            'Type 16
            If sld.Shapes(i).Type = msoMedia Then
                it = it & "Media object .. sound, etc" & vbNewLine
                'With .LinkFormat
                  '  it = it & vbCrLf & " My Source: " & _
                  '  .SourceFullName
                'End With

                right = False
            End If

            'Type 17
            If sld.Shapes(i).Type = msoTextBox Then
                'it = "a Text Box."
            End If

            'Type 18 = msoScriptAnchor, not defined in PPT pre-2000 so we use the numeric value
            'Case msoScriptAnchor
            If sld.Shapes(i).Type = 18 Then
                it = it & "ScriptAnchor" & vbNewLine

                right = False
            End If

            'Type 19 = msoTable, not defined in PPT pre-2000 so we use the numeric value
            'Case msoTable
            If sld.Shapes(i).Type = 19 Then
                'it = " a Table. Type : " & .Type
            End If

            'Type 19 = msoCanvas, not defined in PPT pre-2000 so we use the numeric value
            'Case msoCanvas
            If sld.Shapes(i).Type = 20 Then
                it = "Canvas" & vbNewLine

                right = False
            End If

            'Type 21 = msoDiagram, not defined in PPT pre-2000 so we use the numeric value
            'Case msoDiagram
            If sld.Shapes(i).Type = 21 Then
                it = it + "Diagram" & vbNewLine

                right = False
            End If

            'Type 22 = msoInk, not defined in PPT pre-2000 so we use the numeric value
            'Case msoInk
            If sld.Shapes(i).Type = 22 Then
                it = it + "Ink shape" & vbNewLine

                right = False
            End If

            'Type 23 = msoInkComment, not defined in PPT pre-2000 so we use the numeric value
            'Case msoInkComment
            If sld.Shapes(i).Type = 23 Then
                it = it + "InkComment" & vbNewLine

                right = False
            End If

            'Type -2
            If sld.Shapes(i).Type = msoShapeTypeMixed Then
                it = "Mixed object (whatever that might be)" & nvNewLine

                right = False
            End If

            'Just in case
            'Case Else
             '   it = "mystery!? An undocumented object type?" & _
              '          " Haven't found one of these yet!" & nvNewLine
              '
              '  right = False

        'End Select

        'MsgBox ("I'm " & it)
        'End With
    Next i
    Next
    Dim slidNum As Integer
    slidNum = 1
    For Each slid In ActivePresentation.Slides
        If slid.TimeLine.MainSequence.Count >= 1 Then
            it = it & "Number of animations in slide " & slidNum & ": " & Str(slid.TimeLine.MainSequence.Count) & vbNewLine
            right = False
        End If
        slidNum = slidNum + 1
    Next

If right = True Then
    For Each slid In ActivePresentation.Slides
         For i = 1 To slid.Hyperlinks.Count
            If slid.Hyperlinks(i).SubAddress = "" Then
                MsgBox "Address: " + slid.Hyperlinks(i).Address
            'MsgBox "Here there is a hyperlink: " + slid.Hyperlinks(i).Type
            Else

                MsgBox "Subaddress: " + slid.Hyperlinks(i).SubAddress
                stri = Mid(slid.Hyperlinks(i).SubAddress, 5, 1)
                sNum = CInt(stri) - 1
                MsgBox "The link must go to Story Number: " + Str(sNum)
            End If
        Next i
    Next
    ActivePresentation.SaveAs "c:\dink_presentation2", ppSaveAsPNG, msoTrue
Else
   MsgBox (it & vbNewLine & "Please fix this errors to before continue")
End If 
```

希望它对某人有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T12:54:50.517

如果您希望您的子程序为每张演示文稿工作，那么您需要放回您删除的外部循环。

您需要删除 3 行，而您需要放置几行：

```
'For i = 1 To ActiveWindow.Selection.SlideRange.Shapes.Count 'remove
    'With ActiveWindow.Selection.SlideRange.Shapes(i)        'remove
    'ActiveWindow.Selection.SlideRange.Shapes(i).Select      'remove

Dim sld As Slide
For Each sld In ActivePresentation.Slides
    sld.Select
    For i = 1 To sld.Shapes.Count

    With sld.Shapes(i)
        .Select
...
...
...
Next i
Next '<-- add this too 
```

希望我没有错过任何东西:)

# twitter-bootstrap - 引导下拉菜单不起作用？

> ID：16019943
> 
> 赞同：1
> 
> 时间：2013-04-15T16:14:11.100
> 
> 标签：twitter-bootstrap, drop-down-menu

我有一个小问题，引导下拉功能将不再起作用。这是我的代码：

```
 // HEAD

<script type="text/javascript" src="<?php echo osc_current_web_theme_js_url('jquery.js') ; ?>"></script>
<script type="text/javascript" src="<?php echo osc_current_web_theme_js_url('jquery-ui.js') ; ?>"></script>
<script type="text/javascript" src="<?php echo osc_current_web_theme_js_url('jquery-latest.js') ; ?>"></script>
<script type="text/javascript" src="<?php echo osc_current_web_theme_js_url('jquery.tablesorter.js') ; ?>"></script>
<script type="text/javascript" src="<?php echo osc_current_web_theme_js_url('jquery.uniform.js') ; ?>"></script>
<script tyle="text/javascript" src="<?php echo osc_current_web_theme_js_url('bootstrap.min.js') ; ?>"></script>
<script tyle="text/javascript" src="<?php echo osc_current_web_theme_js_url('bootstrap-dropdown.js') ; ?>"></script>

// DROPDOWN BUTTON

<a class="btn btn-danger dropdown-toggle" data-toggle="dropdown" href="#">
    <i class="icon-minus-sign"></i> Anmeld annonce
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu">
    <li><a id="item_spam" href="<?php echo osc_item_link_spam() ; ?>" rel="nofollow"><?php _e('spam', 'modern') ; ?></a></li>
                            <li><a id="item_bad_category" href="<?php echo osc_item_link_bad_category() ; ?>" rel="nofollow"><?php _e('misplaceret', 'modern') ; ?></a></li>
                            <li><a id="item_repeated" href="<?php echo osc_item_link_repeated() ; ?>" rel="nofollow"><?php _e('kopiret', 'modern') ; ?></a></li>
                            <li><a id="item_expired" href="<?php echo osc_item_link_expired() ; ?>" rel="nofollow"><?php _e('udgået', 'modern') ; ?></a></li>
                            <li><a id="item_offensive" href="<?php echo osc_item_link_offensive() ; ?>" rel="nofollow"><?php _e('stødende', 'modern') ; ?></a></li>

  </ul> 
```

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T13:20:15.733

试试这个，不要忘记添加 bootrap css ans js。

```
<div class="container">    
   <div class="dropdown">
      <a class="btn btn-danger dropdown-toggle" id="dLabel" data-toggle="dropdown" data-target="#">
        <i class="icon-minus-sign"></i> Anmeld annonce
        <span class="caret"></span>
      </a>
      <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
        <li><a id="item_spam" href="<?php echo osc_item_link_spam() ; ?>" rel="nofollow">Your php</a></li>
        <li><a id="item_bad_category" href="<?php echo osc_item_link_bad_category() ; ?>" rel="nofollow">Yt-stats.com</a></li>
        <li><a id="item_repeated" href="<?php echo osc_item_link_repeated() ; ?>" rel="nofollow">Be cool</a></li>
        <li><a id="item_expired" href="<?php echo osc_item_link_expired() ; ?>" rel="nofollow">and</a></li>
        <li><a id="item_offensive" href="<?php echo osc_item_link_offensive() ; ?>" rel="nofollow">Enjoy</a></li>

      </ul>
    </div>
</div> 
```

祝你好运 ;）

# r - R中的分类树

> ID：16019946
> 
> 赞同：0
> 
> 时间：2013-04-15T16:14:16.367
> 
> 标签：r, tree, classification, rpart, cart-analysis

我对 R 完全陌生，我正在尝试利用分类树对一些数据进行分类。让我困惑的是要使用什么库。我应该使用 rpart 还是树？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-15T16:38:02.830

Use the `rpart` package. The `tree` package is included mainly for compatibility with older scripts.

# javascript - Extjs 组合框未更新

> ID：16019951
> 
> 赞同：1
> 
> 时间：2013-04-15T16:14:34.430
> 
> 标签：javascript, extjs, extjs4

我在 ExtJS 4.2 中有一个组合框，我最初用一个有 0 个项目的商店创建它。后来我计算了一堆东西并更新组合框，在与组合框关联的商店上使用 loadRawData。不知何故，商店更新了，我已经通过代码确认，但组合框没有看到任何更新。

这是创建 extjs 内容的代码和相关 jsfiddle 的链接：

```
Ext.define('ItemTemplateModel', {
    extend: 'Ext.data.Model',
    fields: [
        { name: 'id', type: 'int' },
        { name: 'imageUri', type: 'string' },
        { name: 'name', type: 'string' }
    ]
});

var itemTemplateStore = Ext.create('Ext.data.Store', {
    model: 'ItemTemplateModel',
    autoLoad: false,
    proxy: {
        type: 'memory',
        reader: {
            type: 'json',
            root: 'entries'
        }
    }
});

var comboBox = Ext.create('Ext.form.field.ComboBox', {
    store: itemTemplateStore,
    fieldLabel: 'Item Template',
    name: 'template',
    displayField: 'name',
    valueField: 'id',
    editable: false,
    typeAhead: false,
    triggerAction: 'all'
}); 
```

[http://jsfiddle.net/qqHYp/](http://jsfiddle.net/qqHYp/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T17:16:25.723

您使用内存代理 - 需要添加

```
queryMode: 'local', 
```

在组合配置中：http: [//jsfiddle.net/qqHYp/4/](http://jsfiddle.net/qqHYp/4/)

# java - 如何检测是否安装了 JAI-ImageIo 的本机库

> ID：16019952
> 
> 赞同：7
> 
> 时间：2013-04-15T16:14:35.023
> 
> 标签：java, jai

有没有一种简单的方法来检测是否安装了 JAI 的本机二进制文件？

JAI（Java 高级成像）可以在有或没有本机二进制文件的情况下以多种模式运行，这使其处理图像速度更快，还增加了对其他格式的支持。但是，由于原生库无法使用 Maven 安装，如何检测它们是否已安装在系统中？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-15T16:14:35.023

记录解决方案，因为很难找到。OpenGeo (GeoTools) 工具包提供了一个帮助实用程序，用于检查是否通过它的 ImageUtilities 安装了库。

总之：

*   检查以下课程`com.sun.medialib.mlib.Image`
*   检查它是否没有通过属性禁用：`com.sun.media.jai.disableMediaLib`
*   实例化`com.sun.medialib.mlib.Image`并执行`isAvailable()`

代码可通过 LGPL [ [http://svn.osgeo.org/geotools/trunk/modules/library/coverage/src/main/java/org/geotools/resources/image/ImageUtilities.java](http://svn.osgeo.org/geotools/trunk/modules/library/coverage/src/main/java/org/geotools/resources/image/ImageUtilities.java) ]

# sql-server - 选择 union all order by

> ID：16019954
> 
> 赞同：1
> 
> 时间：2013-04-15T16:14:36.943
> 
> 标签：sql-server, union-all

```
SELECT TOP 1
        hol_id ,
        CONVERT(VARCHAR(12), hol_date, 112)
FROM    holiday
WHERE   hol_id = 5
UNION ALL
SELECT  hol_id ,
        CONVERT(VARCHAR(12), hol_date, 112)
FROM    holiday
WHERE   hol_id <> 5
ORDER BY CONVERT(VARCHAR(12), hol_date, 112) DESC 
```

我懂了

```
1   20131218
5   20131018
6   20130818
3   20130405
4   20130311
2   20121129 
```

我想看看

```
5   20131018
1   20131218
6   20130818
3   20130405
4   20130311
2   20121129 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T16:22:05.143

您应该按实际日期（`hol_date`）而不是按转换后的 varchar 值排序。

假设`hol_id` *从* `Key column`表开始（不确定为什么在这里使用 TOP 1），请尝试以下查询`ORDER BY CASE`：

```
SELECT  hol_id ,
        CONVERT(VARCHAR(12), hol_date, 112)
FROM    holiday
ORDER BY CASE WHEN hol_id = 5 
              THEN DATEADD(year,100,getdate()) --Assuming 100 years as max
              ELSE hol_date 
         END DESC 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T16:35:19.580

我将计算一个新值以将特定记录移到顶部，如下所示：

```
order by
      case when hol_id = 5 then 0 else 1 end -- Sort hol_id 5 at the top
    , hol_date desc -- Sort the rest according to date 
```

# objective-c - Objc ivar 声明位置

> ID：16019959
> 
> 赞同：0
> 
> 时间：2013-04-15T16:14:52.223
> 
> 标签：objective-c

有什么区别：

```
@interface MyClass 
{ 
    NSString *string; 
} 
```

和...

```
NSString *string; 
@interface MyClass 
{ 
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T16:17:12.467

这些声明中只有一个声明了 ivar：第一个声明创建了一个实例变量`string`，而第二个声明创建了一个全局变量`string`。第一个声明中的 ivar 只能用于实例方法，不能用于类方法。第二个声明中的全局变量可以在类方法和实例方法中使用，但所有实例方法将共享相同的`string`变量值。

# c - 计算一个字母在字符串中出现的次数 -> 汇编

> ID：16019960
> 
> 赞同：1
> 
> 时间：2013-04-15T16:14:55.783
> 
> 标签：c, assembly

想象一下，我有一个 C 语言程序，它给了我一个字符串。例如，“stackoverflow 岩石”。

现在我想在 Assembly 中创建一个函数，该函数将计算例如字母“o”在我的字符串中出现的次数。

该函数将在 C 程序中调用。

我正在考虑用 C 语言创建一个程序，让我做到这一点，然后通过标志 -s 将其转换为汇编。

[编辑]好的，我这样做了：

```
#include<stdio.h>

int FindChar(char *ptr, char toFind);

int FindChar(char *ptr, char toFind){

    int num;

    for (int i=1; ptr[i]=0; i++)
        if (ptr[i] = toFind){
            num++;
        }

    return(num);
}

int main ( ) {

    char str[]=”stackoverflow rocks”; 
    char tf=”o”; 
    printf(“It appears %d times \n”, FindChar(str,tf));
} 
```

我的功能有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T16:48:51.750

我认为您的备用双引号字符导致错误，加上您的初始化`char tf`应该使用单引号，而不是双引号，因为它是一个字符而不是字符串。

正如[harold](https://stackoverflow.com/users/555045/harold)之前指出的那样，`=`需要是 a `==`，因此它可以正常用作比较。

您也不需要额外的`i`变量，您只需推进指针即可。既然您无论如何都想要汇编代码，它应该使它更短一些，并且在技术上也更有效。

此代码修复了错误，并且在功能上也应该是正确的：

```
#include<stdio.h>

int FindChar(char *ptr, char toFind);

int FindChar(char *ptr, char toFind){
  int num = 0;
  for ( ; *ptr != '\0'; ++ptr)
    {
      if (*ptr == toFind){
        ++num;
      }
    }
  return(num);
}

int main ( ) {
  char str[]="stackoverflow rocks";
  char tf='o';
  printf("It appears %d times \n", FindChar(str,tf));
} 
```

# node.js - 使用 Nodejs 向 Mongodb 中插入大量条目

> ID：16019965
> 
> 赞同：0
> 
> 时间：2013-04-15T16:15:12.777
> 
> 标签：node.js, mongodb, express, mongoose, database

所以我有一个包含“pins”的文件，我需要输入到 mongodb 中。它们包含在一个名为的文件中`pins.txt`，数据以新行分隔：

```
A4DS24SD2
DF234SDF2
HFFGHFG45
JDRSDFG35
... 
```

我需要导入大约 70,000 个引脚。

每个引脚还具有默认`used`状态`false`

因此，为了导入如此大量的引脚，我使用 nodejs/mongoose （我的应用程序内置）将其煮熟

```
 fs.readFile './data/pins-test.txt', 'utf8', (err,data)->
    if err
      console.log err
    codes = data.split('\n')
    codes.forEach (code)->
      pin = new Pin()
      pin.pinid = code
      pin.save() 
```

在测试几百个引脚时效果很好，但是当我尝试 70,000 个文件并给出错误时，我的机器内存不足：

`FATAL ERROR: CALL_AND_RETRY_2 Allocation failed - process out of memory`

所以，我的问题是，导入这么多数据的最佳方法是什么？我应该一次使用 async.js 来做这些吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T16:36:05.040

问题`fs.readFile`是在触发回调之前加载了整个文件。

您可以使用[BufferedReader](https://github.com/Gagle/Node-BufferedReader)逐行执行此操作

像这样的东西应该可以工作（注意......未经测试！）

```
reader = require "buffered-reader"
DataReader = reader.DataReader 
```

...

```
 new DataReader("./data/pins1.txt", { encoding: "utf8" })
    .on "error", (error)->
        console.log ("error: " + error);
    .on "line", (line)->
        console.log(i,line)
        i++
        pin = new Pin()
        pin.pinid = line
        pin.save()
    .on "end", ()->
        console.log ("EOF")
    .read() 
```

# perl - 与从节点共享主节点的互联网连接。

> ID：16019966
> 
> 赞同：0
> 
> 时间：2013-04-15T16:15:14.327
> 
> 标签：perl, cluster-computing

我正在处理集群的一个节点，我必须安装几个 perl 模块。我会通过 cpan 做到这一点，但我不能这样做，因为我无法从该节点访问互联网。但是，我可以完全访问可以连接的主节点。如何使用主节点的连接在从节点上使用cpan。还有其他解决方案吗？我将衷心感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T16:31:07.017

我强烈推荐这个模块：[CPAN::Mini](http://search.cpan.org/~rjbs/CPAN-Mini-1.111013/lib/CPAN/Mini.pm)。

该模块可以方便地在本地创建**CPAN 镜像**。然后，使用如下 URL 将 CPAN 中的镜像 URL 配置到本地目录：

```
file:///my/local/cpan/mirror 
```

# arrays - 如何读入十进制数组 C#

> ID：16019971
> 
> 赞同：-1
> 
> 时间：2013-04-15T16:15:24.213
> 
> 标签：arrays, decimal

我目前正在为 UNI 做作业，并且对如何将我的文本文件的内容转换为十进制/双数组感到非常困惑。

它自己问这个问题-“一个计算机程序需要从一个数据文件中读取12个分数（十进制数），将它们存储在一个数组中，并计算中间10个分数的平均值。即最高和最低的这 12 个分数不包括在平均计算中。”

我已经尽力而为，但结果很短，我不知道如何解决此错误“无法将字符串 [] 隐式转换为十进制 []”我相信这是因为我正在使用 File.ReadAllLines，我认为是仅适用于字符串。

```
using System.IO;

namespace ConsoleApplication9
{
    class Program
    {
        static void Main(string[] args)
        {
            Decimal[] Score = File.ReadAllLines("Scores.txt");
            Decimal max = Score.Max();
            Decimal min = Score.Min();
            Console.WriteLine(max + min);
            Decimal sum = Score.Sum();
            for (int index = 0; index < Score.Length; index++)
            {
                Console.WriteLine(Score[index]);
            }
            Console.ReadKey();      

            }
    }
} 
```

希望你能帮忙。PS 文本文件中只有数字。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T16:25:57.700

它就像货币，你需要先兑换/转换它。

```
var allString = File.ReadAllLines("Scores.txt");
var arrString = allString.Split('\n');

for (int index = 0; index < arrString.Length; index++)
    Score[index] = Decimal.Parse(arrString[index]); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T16:33:30.010

读取您的文件将返回字符串值。你需要投射它们。我建议将转换后的值存储在列表中，使用列表的 ToArray() 方法获取最大值和最小值，使用 Count 属性获取中间值：

```
String[] ScoreString = File.ReadAllLines("Scores.txt");
List<Decimal> ScoreList = new List<Decimal>();
Decimal mySum = 0;
foreach(string s in ScoreString)
{    ScoreList.Add(Convert.ToDecimal(s));
    mySum +=  Convert.ToDecimal(s);
}
decimal result = (mySum - ScoreList.ToArray().Max() - ScoreList.ToArray().Min())/(ScoreList.Count-2);
Console.Write(result); 
```

# php - 获取应该发布的表单中选择项目的未定义索引

> ID：16019976
> 
> 赞同：0
> 
> 时间：2013-04-15T16:15:44.500
> 
> 标签：php, html, forms, select

我的 $_POST['state'] 出现未定义的索引错误无法弄清楚为什么，在表单中设置为选择这里是代码。我不明白我是否需要以不同的方式设置选择，或者它只是不会发布变量？

```
<html>

<?php

include("db.php");
if ((($_POST['email'])) and (($_POST['password'])) and (($_POST['name'])) and  (($_POST['password2'])) and (($_POST['name'])) and (($_POST['address'])) and (($_POST['city'])) and (($_POST['state'])))
{
    echo"<h1>variables are set</h1>";
    $con=mysql_connect("localhost", "useradmin", "FNEpsTa6qvmRjBBf", "userdata") or die("failed to connect");
    if ($con->connect_error) 
    {
        die('Connect Error (' . $con->connect_errno . ') '. $con->connect_error);
    }
    //Prevent SQL injections
    $name = mysql_real_escape_string($_POST['name']);
    $email = mysql_real_escape_string($_POST['email']);
    $address = mysql_real_escape_string($_POST['address']);
    $city = mysql_real_escape_string($_POST['city']);
    $state=mysql_real_escape_string($_POST['state']);
    $password = mysql_real_escape_string($_POST['password']);
    $password2 = mysql_real_escape_string($_POST['password2']);

    //Get MD5 hash of password
    $password = md5($_POST['password']);
    $query="SELECT email FROM users WHERE email = '".$email."'";
    $query2="INSERT INTO users (name, email, address, city, state, password) VALUES ('$name', '$email', '$address', '$city', '$state', '$password');";
    //Check to see if email exists
    $sql = mysql_query($con, $query2);

    $rows=(mysql_num_rows($sql));
    if($rows>0)
    {
        die ("email taken.");
    }
    if($password<>$password2)
    {
        die ("passwords do not match");
    }

    $sql = mysql_query($con, $query2);
    if($sql){
        header('location:welcome.php');
    }
}
?>

<html>
<center>

<form action="register.php" method="POST">
        <table>
        <tr><td>Name: </td><td><input name="name" type="text" /></td></tr>
        <tr><td>Email:</td><td> <input name="email" type="text" /></td></tr>
        <tr><td>Address: </td><td><input name="address" type="text" /></td></tr>
        <tr><td>City: </td><td><input name="city" type="text" /></td></tr>
        <tr><td>State: </td><td><select name="state"> 
            <option value="" selected="state">Select a State</option> 
            <option value="AL">Alabama</option> 
            <option value="AK">Alaska</option> 
            <option value="AZ">Arizona</option> 
            <option value="AR">Arkansas</option> 
            <option value="CA">California</option> 
            <option value="CO">Colorado</option> 
            <option value="CT">Connecticut</option> 
            <option value="DE">Delaware</option> 
            <option value="DC">District Of Columbia</option> 
            <option value="FL">Florida</option> 
            <option value="GA">Georgia</option> 
            <option value="HI">Hawaii</option> 
            <option value="ID">Idaho</option> 
            <option value="IL">Illinois</option> 
            <option value="IN">Indiana</option> 
            <option value="IA">Iowa</option> 
            <option value="KS">Kansas</option> 
            <option value="KY">Kentucky</option> 
            <option value="LA">Louisiana</option> 
            <option value="ME">Maine</option> 
            <option value="MD">Maryland</option> 
            <option value="MA">Massachusetts</option> 
            <option value="MI">Michigan</option> 
            <option value="MN">Minnesota</option> 
            <option value="MS">Mississippi</option> 
            <option value="MO">Missouri</option> 
            <option value="MT">Montana</option> 
            <option value="NE">Nebraska</option> 
            <option value="NV">Nevada</option> 
            <option value="NH">New Hampshire</option> 
            <option value="NJ">New Jersey</option> 
            <option value="NM">New Mexico</option> 
            <option value="NY">New York</option> 
            <option value="NC">North Carolina</option> 
            <option value="ND">North Dakota</option> 
            <option value="OH">Ohio</option> 
            <option value="OK">Oklahoma</option> 
            <option value="OR">Oregon</option> 
            <option value="PA">Pennsylvania</option> 
            <option value="RI">Rhode Island</option> 
            <option value="SC">South Carolina</option> 
            <option value="SD">South Dakota</option> 
            <option value="TN">Tennessee</option> 
            <option value="TX">Texas</option> 
            <option value="UT">Utah</option> 
            <option value="VT">Vermont</option> 
            <option value="VA">Virginia</option> 
            <option value="WA">Washington</option> 
            <option value="WV">West Virginia</option> 
            <option value="WI">Wisconsin</option> 
            <option value="WY">Wyoming</option>
        </select></td></tr>
        <tr><td>Password: </td><td><input type="password" name="password" /></td></tr>
        <tr><td>Confirm Password: </td><td><input type="password" name="password2" /></td></tr>
        <tr><td><input type="submit" value="Submit" /></td></tr>
    </table>
</form></center>

</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T16:21:20.637

这是因为您在`$_POST`没有检查密钥是否存在的情况下访问数组。您必须在访问之前检查密钥是否存在：

```
if (isset($_POST['state'])) {
    $state = $_POST['state'];
} 
```

如果您不检查它是否已设置，那么如果未提交表单，您将收到错误：

```
$state = $_POST['state']; // Error 
```

# .htaccess - 如何排除特定文件的重写并将所有其他请求重写到同一文件？

> ID：16019983
> 
> 赞同：0
> 
> 时间：2013-04-15T16:16:02.967
> 
> 标签：.htaccess, mod-rewrite

下面是我的要求，

[来自http://subdomain.example.com](http://subdomain.example.com)的任何请求都应该重写以执行[http://subdomain.example.com/script.php](http://subdomain.example.com/script.php)

但是任何请求都直接来自[http://subdomain.example.com/script.php](http://subdomain.example.com/script.php)不应该在其他任何地方重定向/重写。

我怎样才能在不结束重写循环的情况下做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T00:22:54.500

> any request that comes to `http://subdomain.example.com` should rewrite to execute `http://subdomain.example.com/script.php`.
> 
> But any request comes directly to `http://subdomain.example.com/script.php` should not be redirected/rewrite anywhere else.

If I understood right, you may try this in one .htaccess file at `subdomain.example.com` root directory:

```
Options +FollowSymlinks -MultiViews
RewriteEngine On
RewriteBase /
RewriteRule ^$    /script.php         [L,NC] 
```

Not only the requests to `script.php` will be excluded from the rule and passed through, but any other request with something in the URI-path as it has to be empty for the rule to be used.

# c - Lua中是否有等效的scanf函数？

> ID：16019986
> 
> 赞同：3
> 
> 时间：2013-04-15T16:16:06.077
> 
> 标签：c, lua, scanf

正如标题所说：

Lua中是否有等效的scanf函数？

我的意思是，我想要这样的语法：

```
word_typed = lua_scanf() 
```

一旦我写了一个字符串（假设“123 是完美数”），我就有了字符串“123 是完美数”。

提前谢谢了

PS 如果需要，您可以提供 LUA C API 解决方案！:P

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-15T17:39:31.433

以下脚本（使用 Lua 5.1.4 测试，*应该在 5.2 中工作*）执行您在评论中描述的对 Shmil-The-Cat 的回答：

```
print("Please enter your name:")
name = io.read()
print("You entered '" .. name .. "'") 
```

该`io.read`函数有一个默认参数`"*l"`，表示从打开的文件中读取下一行，跳过行尾。默认情况下打开的文件是，`stdin`但您可以使用该`io.open`文件更改它。

有关该`io`库的更多详细信息，请参阅在线 Lua 参考手册的第 6.8 节，该手册可在[http://www.lua.org/manual/5.2/manual.html#6.8](http://www.lua.org/manual/5.2/manual.html#6.8)找到。您可能还想阅读*Lua 编程*(PIL) 的 I/O 章节，该章节可在[http://www.lua.org/pil/21.html](http://www.lua.org/pil/21.html)找到。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T16:21:30.390

`match` [http://lua-users.org/wiki/StringLibraryTutorial](http://lua-users.org/wiki/StringLibraryTutorial)在我看来接近 C scanf

# html - 如何在不使用伪元素的情况下将 OL 的数字与其内容分开着色？

> ID：16019989
> 
> 赞同：1
> 
> 时间：2013-04-15T16:16:11.700
> 
> 标签：html, css, html-lists, pseudo-element

**我已经看过了[是否有一种简单的方法可以更改列表中项目符号的颜色？](https://stackoverflow.com/questions/76564/is-there-an-easy-way-to-change-the-color-of-a-bullet-in-a-list). 这个问题的答案对我没有帮助，因为我无法控制 HTML 结构。这适用于 CSS 库，而不是特定的网页或站点。**

假设我有以下代码：

```
<style>
* {
    background-color: white;
    color: black;
}
#too {
    background-color: black;
    color: white;
}
</style>
<ol>
    <li id="won">Item 1</li>
    <li id="too">Item 2</li>
    <li id="tre">Item 3</li>
</ol> 
```

第二个列表元素应该通过反转背景色和前景色来突出显示，但在这样做时，在这种情况下，项目的编号也会发生变化。

**有什么办法可以在保持第 2 项的数字为初始颜色的同时做到这一点？**我见过使用`::before`伪元素和`content`CSS 属性的解决方案，但这些*不适*用于元素的 HTML5`value`属性。`li`

无论你给出什么答案，它都应该是当前 CSS3 的语义。这是因为最终实现将使用`:target`高亮目标元素，因此 HTML 结构无法保证。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-16T14:06:59.367

如[链接问题的已接受答案中所述](https://stackoverflow.com/questions/76564/is-there-an-easy-way-to-change-the-color-of-a-bullet-in-a-list/76626#76626)：

> 项目符号从文本中获取颜色。

从技术上讲，这是因为列表标记（[CSS2.1](http://www.w3.org/TR/CSS21/generate.html#lists)给出的术语表示项目符号或数字）生成自己的匿名框，它是主列表项框的子项。如果适用，此标记框将始终从主框继承样式。

没有办法只针对列表标记框，或者阻止它从主框继承样式，使用 CSS2.1。

* * *

然而，有趣的是，它在[CSS2.0](http://www.w3.org/TR/2008/REC-CSS2-20080411/generate.html#q11)中旨在允许`::before`和`::after`伪元素`display: marker`，本质上允许您独立于包含它们的元素的主框来设置它们的样式（`list-style`在此过程中覆盖）。不幸的是，这个特性在 CSS2.1 中被删除了，而且我没有任何可用的资源来解释它为什么被删除。

今天，在 CSS2.1 中，虽然您仍然可以将计数器样式应用于`::before`and `::after`，但您不能让它们像真正的列表标记一样。在这两个规范中，您也无法从标记内更改标记的值。

也就是说，虽然`display: marker`CSS2.1 中不再存在，但样式列表标记的概念正在新的[Lists and Counters 模块](http://www.w3.org/TR/css3-lists)中重新审视，引入了一个`::marker`专门针对列表标记设计的伪元素，允许您做一些事情像这样：

```
*, ::marker {
    background-color: white;
    color: black;
}

#too {
    background-color: black;
    color: white;
} 
```

当然，这在任何地方都行不通，因为它只是一个建议。希望有一天这会改变，但知道它正在被考虑总是很好的。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-15T16:29:31.073

试试下面的方法，它会帮助你

**CSS：**

```
<style>
* {
    background-color: white;
    color: black;
}
#too span{
    background-color: black;
    color: white;
}
</style> 
```

**HTML：**

```
<ol>
    <li id="won"><span>Item 1</span></li>
    <li id="too"><span>Item 2</span></li>
    <li id="tre"><span>Item 3</span></li>
</ol> 
```

**输出：**

![在此处输入图像描述](https://i.stack.imgur.com/Ew8O0.png)

# android - 在 setOnCLickListener(... 方法中处理数据库

> ID：16019990
> 
> 赞同：0
> 
> 时间：2013-04-15T16:16:12.837
> 
> 标签：android, database, eclipse

在我的项目中，我想为我的数据库放置一个重置按钮（只有一个条目，我需要更新 4 种不同的信息以跟踪用户在测验中的进度）

问题是我需要在这个监听器中启动 initDB() 方法：

```
public class MainActivity extends Activity implements View.OnClickListener {
private Button reset = null;

@Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        Button reset = (Button)findViewById(R.id.raz);

        DBGestion dbGestion = new DBGestion(this);
.
.
.
        reset.setOnClickListener(new OnClickListener() {
        @Override
        public void onClick(View v){

            dbGestion.open();
            dbGestion.initDB("Alex"); 
            dbGestion.close();
        }

    }); 
```

它说我不能在以不同方法定义的类中引用非最终变量（dbGestion）。但它不适用于 dbGestion 作为最终变量..

任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T16:44:02.020

您有几个选项可以使用：

1.  MainActivity 中的字段变量
2.  最终变量`onCreate()`
3.  匿名 OnClickListener 中的字段变量
4.  内部的局部变量`onClick()`

例如：

```
public class MainActivity extends Activity {
    // (1) DBGestion dbGestion;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        ...
        // (1a) dbGestion = new DBGestion(this); // Instantiate field variable
        // (2) final DBGestion dbGestion = new DBGestion(this);
        reset.setOnClickListener(new OnClickListener() {
            // (3) DBGestion dbGestion = new DBGestion(MainActivity.this);
            @Override
            public void onClick(View v){
                // (4) DBGestion dbGestion = new DBGestion(MainActivity.this); or new DBGestion(v.getContext());
                dbGestion.open();
                dbGestion.initDB("Alex"); 
                dbGestion.close();
            }
        }); 
```

（有更多的选择，但他们开始变得古怪。）这些方法都没有本质上是对还是错，它们都有自己的优点和缺点。选择取决于您是否`dbGestion`在其他任何地方使用以及您的个人喜好。

# php - 条件下拉菜单

> ID：16019993
> 
> 赞同：-1
> 
> 时间：2013-04-15T16:16:23.597
> 
> 标签：php, javascript, forms, cascadingdropdown

我想创建一个表单，其中选项根据选择而变化。

例如，如果他们从第一个下拉菜单中选择*“雪佛兰” ，那么下一个选项将只显示雪佛兰​​的型号。*然后基于该选择，该型号的发动机尺寸是唯一可用的选项。如何使用 JavaScript 和 PHP 做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T16:50:33.763

## 任何宽度的下拉/弹出菜单，带有点击操作并居中

他是一个可以完成您正在寻找的东西的jsfiddle：

单击度假村或信息，您将看到其他弹出窗口。

jsfiddle.net/supplement/UYBDm/

将 jsfiddle 复制并粘贴到浏览器中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T17:48:38.627

在您的 HTML 中，一定要包含 jQuery。我假设您将使用以下更详细的版本：

```
<label>Make</label>
<select id="makes">
</select>
<br/>
<label>Model</label>
<select id="models">
</select> 
```

对于 JavaScript，这是一种方法。您显然希望根据您的要求以及您选择如何表达您的品牌/型号数据来大幅改进它。

```
$(document).ready(function(){
    // If this list is to come from a database
    // or some other dynamic source, use PHP to
    // populate it here.
    // Feel free to format this some other way.
    // Just change the jQuery parts accordingly.
    var cars = [{"make": "Chevrolet", "models": ["Camaro", "Impala", "Volt"]}, {"make": "Honda", "models": ["Accord", "Civic", "CRV"]}];

    for (var i=0; i < cars.length; i++){
      var make = cars[i].make;        
      // Make this different if needed
      var makeval = make;
      $("#makes").append(new Option(makeval, make));
    }

    var buildModels = function(){
        // Clear current list
        $("#models option").remove();

        var selectedMake = $("#makes :selected").val();
        for (var i=0; i < cars.length; i++){
            if(selectedMake == cars[i].make){
                var models = cars[i].models;
                for (var j=0; j < models.length; j++){
                      var model = models[j];        
                      var modelval = model;
                      $("#models").append(new Option(modelval, model));
                }
                break;
            }
        }
    };

    $("#makes option").find(':first').attr('selected','selected');
    buildModels();

    $("#makes").change(function(){
        buildModels();
    });
}); 
```

# c# - 从 DLL (C#) 访问另一个项目中的类型

> ID：16019995
> 
> 赞同：0
> 
> 时间：2013-04-15T16:16:28.763
> 
> 标签：c#

我希望将 DLL 加载到另一个项目中（Assembly.Load*() 等，在运行时）。如果有办法将主程序集中的类型（即类）包含到 DLL 中，那么我可以在方法调用中传递它们（嗯，对象），这对我来说会简单得多。

在 C++ 中，我可以只包含声明，但是（据我所知）在 C# 中没有办法做到这一点。我可能最终不得不将整个主程序“引用”到 DLL 中，但似乎必须有更好的方法。

（基本上 DLL 是运行时模块，需要来自主程序的信息来进行处理。但是主程序集也需要访问模块需要访问的相当多的东西。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T16:29:40.470

看起来您有应用程序设计问题，导致循环引用 - 您的 dll 需要来自应用程序的类，而应用程序需要来自 dll 的类。

您应该尝试重构您的项目以避免这种情况。具体来说，DLL 中的代码不应直接访问主应用程序。

您可以在共享 DLL 中定义接口

```
interface IFoo{
   int GetBar();
} 
```

然后在你的 Dll 代码中使用它作为参数

```
void DoSomeStuff(IFoo foo); 
```

并在您的应用程序中创建一个实际的实现：

```
class Foo:IFoo{...} 
```

这样，您就可以从 DLL 在主应用程序中执行某些操作，而无需从 DLL 引用应用程序。

# java - 我应该如何命名课程？此名称是否太长或不必要地长？

> ID：16019997
> 
> 赞同：4
> 
> 时间：2013-04-15T16:16:31.980
> 
> 标签：java, class, naming-conventions

我有以下顶级包：“com.gmail.email.aviersproject”。在这个顶级包中，我有一个包含我的主要方法的类和一个包“.summonerdata”。

我的问题是我应该为“summonerdata”包中的类命名。该课程将通过屏幕抓取网站来获取召唤者数据。

由于它所在的包是“summonerdata”，因此类名“SummonerDataScreenScraper”是否不必要地长？也许只是“ScreenScraper”或“Scraper”或“SdScraper”或“DataScraper”？

有人告诉我，重要的是类名具有描述性，同时尽可能短。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-15T16:22:38.830

JDK本身就有很多例子。例如，`ConcurrentHashMap`is 在`java.util.concurrent`包中，但他们认为在类的名称中使用 concurrent 也更清楚，以将其与其他 HashMap 区分开来。

我会使用长名称，除非您在整个项目中只有一个`Scraper`，它恰好是 SummonerDataScreenScraper，但这变得无关紧要，因为别无选择。在这种情况下，一个简短的名称可能就足够清楚了。