# StackOverflow 问答 14078000-14078999

# list - Haskell 选择列表中的元素

> ID：14078000
> 
> 赞同：-1
> 
> 时间：2012-12-29T01:49:15.920
> 
> 标签：list, haskell, types

我对这样的功能有疑问：

数据城市 = 城市 {汽车 :: 字符串，重量 :: Int，颜色 :: 字符串}

-我有一个“城市”列表，我的函数必须列出一个元组，每个元组是（汽车，“权重之和”），因此，如果汽车相等，则权重必须是添加，制作这样的东西：

```
main> [(Porche,180),(Ferrari,400),(Opel,340)] 
```

汽车不能在输出列表中重复，因为必须添加它们的重量。

我正在考虑做一些事情，比如列出所有汽车类型的列表，然后过滤重量并添加它们，制作一个列表，但我无法让它发挥作用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T06:07:48.960

我将指导您解决问题。了解如何得出解决方案比了解解决方案本身更好。

```
import Data.List
data City = City {car :: String, weight :: Int, color :: String} deriving (Show) 
```

如果与相等`color`无关，则可以将其转换为元组。你可以用它来做到这一点。`City``City``map`

```
city2tup :: [City] -> [(String,Int)]
city2tup = map (\(City c w _) -> (c,w)) 
```

现在看看 function`sort`和`groupBy`from `Data.List`。对第一个元素进行排序然后分组将在列表中收集相似的汽车。所以你会有一个列表列表。现在您只需要折叠每个子列表并添加相应的权重。

```
collect :: [City] -> [(String,Int)]
collect = map (foldl1 collectWeight) . groupBy ((==) `on` fst) . sort . city2tup 
```

您仍然需要定义是什么`collectWeight`，但这应该很容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-12-14T23:07:07.270

就性能而言，也许最好使用该`Data.HashMap.Lazy`软件包来完成这项工作。因此，您可以按以下方式进行；

```
import qualified Data.HashMap.Lazy as M

data City = City {car :: String, weight :: Int, color :: String}

ccw :: [City] -> [(String, Int)]
ccw []     = []
ccw (x:xs) = M.toList $ foldr addWeight (M.singleton (car x) (weight x)) xs
             where
             addWeight :: City -> M.HashMap String Int ->  M.HashMap String Int
             addWeight c r = case M.lookup (car c) r of
                             Nothing -> M.insert (car c) (weight c) r
                             Just x  -> M.adjust (+ weight c) (car c) r

λ> ccw [City "Porsche" 180 "Black", City "Ferrari" 400 "Red", City "Opel" 340 "White", City "Porsche" 210 "Yellow"]
[("Opel",340),("Ferrari",400),("Porsche",390)] 
```

# objective-c - Cocoa：当 HUD 面板关闭时关闭应用程序

> ID：14078006
> 
> 赞同：1
> 
> 时间：2012-12-29T01:51:19.177
> 
> 标签：objective-c, cocoa, nspanel

当用户单击面板关闭按钮时，我需要关闭整个应用程序，我尝试过：

```
- (BOOL)applicationShouldTerminateAfterLastWindowClosed:(NSApplication *)theApplication {
    return YES;
} 
```

但它也会从文件选择器面板关闭应用程序。

先感谢您。L.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T03:40:38.890

应用程序无法关闭，只能退出。只能关闭窗口，不能关闭应用程序。

如果您想在仅关闭特定窗口时退出应用程序，请成为该窗口的代表并通过[告诉应用程序终止来](http://developer.apple.com/library/mac/documentation/Cocoa/Reference/ApplicationKit/Classes/NSApplication_Class/Reference/Reference.html#//apple_ref/occ/instm/NSApplication/terminate%3a)[响应`windowWillClose:`消息](http://developer.apple.com/library/mac/documentation/Cocoa/Reference/NSWindowDelegate_Protocol/Reference/Reference.html#//apple_ref/occ/intfm/NSWindowDelegate/windowWillClose%3a)。

# javascript - jQuery变量赋值混淆

> ID：14078007
> 
> 赞同：0
> 
> 时间：2012-12-29T01:51:34.800
> 
> 标签：javascript, jquery

我刚刚遇到了一个让我有点困惑的[jQuery代码示例。](http://en.wikipedia.org/wiki/JQuery)

```
var $tasks = $('#task_list'), i; 
```

这用于从[DOM中获取](http://en.wikipedia.org/wiki/Document_Object_Model)**ul 元素**并将其存储在变量中。`$tasks`

但为什么**`i`**最后呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-29T01:52:38.937

这与以下内容完全相同：

```
var $tasks = $('#task_list');
var i; 
```

这只是在语句之​​间使用逗号的不同语法`var`。

您可以在此处阅读有关该`var`声明的更多信息并查看更高级的示例：[https ://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/var](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/var)

# prolog - 避免 Prolog 中的无限循环

> ID：14078009
> 
> 赞同：0
> 
> 时间：2012-12-29T01:52:23.053
> 
> 标签：prolog, infinite-loop

我在知识库中有以下事实：

```
line(a,b). -- denotes the line determined by point a and b
line(c,d). -- denotes the line determined by point c and d
lineEqual(line(a,b),line(c,d)) -- denotes the length of two lines are equal 
```

我想要另一个可以交换 lineEqual/2 的两个参数的规则：

```
lineEqual(line(C, D), line(A, B)):-
    lineEqual(line(A,B),line(C,D)). 
```

不幸的是，该规则将在 Prolog 中创建一个无限循环。还有什么想法吗？

感谢更新。不知道我是否理解你的最后一条规则：

```
transitiveSymmetricRelPath(L1, L2, IntermediateNodes) :- symmetricRel(L1, L3),
                 \+member(L3, IntermediateNodes),
                 transitiveSymmetricRelPath(L1, L2, [L3 | IntermediateNodes]). 
```

我可以想象每次它试图剥离头节点时，如果它恰好与 L1 和 L3 链接，对吗？所以如果我们最终得到一个空列表，那么我们可以使用这个规则：

```
transitiveSymmetricRel(L1, L2) :- transitiveSymmetricRelPath(L1, L2, []). 
```

但我没有真正得到的是你从哪里得到一个transitiveSymmetricRelPath/3的中间节点的非空列表开始。我实际上已经用给定的事实 rel(a,b) 尝试了你的代码。相对（a，c）。它不返回transitiveSymmetricRel(b,c)，也不返回transitiveSymmetricRel(c,b)。你能看看吗？

非常感谢！

编辑：我已经通过修改你的规则来让它工作，比如：

```
transitiveSymmetricRelPath(L2, L3, IntermediateNodes) :- symmetricRel(L1, L3),
     \+member(L3, IntermediateNodes),
     transitiveSymmetricRelPath(L1, L2, [L3 | IntermediateNodes]). 
```

无论如何感谢您的建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T02:26:52.413

您应该避免在一个名称下引入类似数据的语句（如第一个示例中的`line`和`lineEqual`）和代码（如第二个示例中的）。`lineEqual`相反，请将您的数据库事实使用不同的名称。然后，您可以例如定义：

```
areLinesEqual(L1, L2) :- linesEqual(L1, L2).
areLinesEqual(L1, L2) :- linesEqual(L2, L1). 
```

一般来说，如果你有一个关系`rel`并且你想建立一个对称传递闭包，你应该一次引入一个概念。例如：

```
symmetricRel(L1, L2) :- rel(L1, L2).
symmetricRel(L1, L2) :- rel(L2, L1).

transitiveSymmetricRel(L1, L2) :-
    transitiveSymmetricRelPath(L1, L2, []).

transitiveSymmetricRelPath(L1, L2, _) :-
    symmetricRel(L1, L2).

transitiveSymmetricRelPath(L1, L2, IntermediateNodes) :-
    symmetricRel(L1, L3),
    \+ member(L3, IntermediateNodes),
    transitiveSymmetricRelPath(L1, L2, [L3 | IntermediateNodes]). 
```

（注意，这里我们基本上必须在无向图中找到一条路径，并且必须注意避免循环）。在您的情况下，也可能需要考虑`line(A, B)`和`line(B, A)`相同。为此，您应该再次引入另一个级别的间接：

```
% to check two lines for identity
same(line(A, B), line(A, B)).
same(line(A, B), line(B, A)).

linesEqual2(L1, L2) :-
    same(L1, LI1),
    same(L2, LI2),
    (linesEqual(LI1, LI2); linesEqual(LI2, LI1)). 
```

…并在对称关系的定义中使用`linesEqual2`而不是。`linesEqual`

现在最困难的部分是命名方案，这样您就不会混淆所有这些谓词......</p>

你也可以用另一种方式来做。鉴于您寻求对称关系的传递闭包，它基本上是将所有节点（此处：线）的集合划分为可分离的子集。这种洞察力将帮助您编写比上述更有效的代码……但这已经超出了这个问题的范围。

# objective-c - 如何将 Class 对象转换为符合协议

> ID：14078012
> 
> 赞同：4
> 
> 时间：2012-12-29T01:52:48.027
> 
> 标签：objective-c, ios

我正在尝试将 Class 对象强制转换为某个协议，该协议定义了该类实现的类方法 (+)。

[如本问题所述，](https://stackoverflow.com/questions/617616/cast-an-instance-of-a-class-to-a-protocol-in-objective-c)我知道如何使用 (id<protocol>) 执行此操作，但我似乎无法为 Class 对象找出正确的方法。

基本情况如下。

我有一个协议：

```
@protocol Protocol <NSObject>
+ (id)classMethod:(id)arg;
@end 
```

然后我有一个接受 Class 对象的函数，它知道有时基于另一个参数符合协议（这显然非常简化）：

```
- (id)someMethodWithClass:(Class)cls andUseArg:(BOOL)arg
{
    id instance;
    if (arg != nil) {
        instance = [(Class<Protocol>)cls classMethod:arg];
    }
} 
```

现在我没有收到任何警告，这对我来说是正确的。（在任何情况下我都不会看到任何错误，因为我可以保证如果 arg != nil 则该类符合。）

但是，我没有在 Xcode 中获得自动完成功能，这让我想知道这是否是正确的方法。有什么想法吗？（请注意，我对实例是 id<Protocol> 不感兴趣。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T07:07:31.100

如果您想确定是否`cls`符合特定协议（并假设这`classMethod:`是该协议的必需类方法），您可以简单地：

```
- (id)someMethodWithClass:(Class)cls andUseArg:(BOOL)arg
{
    id instance;
    if ([cls conformsToProtocol:@protocol(Protocol)]) {
        instance = [cls classMethod:arg];
    }

    return instance;
} 
```

或者，只需查看它是否响应特定的类方法选择器：

```
- (id)someMethodWithClass:(Class)cls andUseArg:(BOOL)arg
{
    id instance;
    if ([cls respondsToSelector:@selector(classMethod:)]) {
        instance = [cls classMethod:arg];
    }

    return instance;
} 
```

# android - Phonegap：从 Android 媒体商店访问现有播放列表？

> ID：14078013
> 
> 赞同：2
> 
> 时间：2012-12-29T01:52:50.433
> 
> 标签：android, cordova, mediastore, playlists

有人知道我将如何从 phonegap 中访问 android MediaStore.Audio.Playlists 区域吗？这有可能吗？我希望将一个简单的媒体播放器添加到我现有的应用程序中。

我已经搜索了 phonegap 媒体文档 - 并且有一个媒体播放器在 phonegap 资产区域内播放音频文件，但我找不到从设备中检索现有播放列表的方法。

干杯

# python - 如何将发送函数应用（）到套接字对象？

> ID：14078018
> 
> 赞同：0
> 
> 时间：2012-12-29T01:53:40.687
> 
> 标签：python, sockets

编辑：我正在使用不推荐使用`apply()`的泡菜漏洞进行安全竞赛。`apply`似乎是您可以使用 pickle 指令字符串调用方法的方式。但是，我很乐意学习更好的方法。

我正在尝试使用在 a 上调​​用`apply()`该`send()`方法`socket._socketobject`，但我收到一条奇怪的错误消息。

```
In [130]: client
Out[130]: <socket._socketobject at 0x108d0bfa0>

In [131]: apply(socket._socketobject.send, (client, "stuff"))
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-131-3f9b1f1de824> in <module>()
----> 1 apply(socket._socketobject.send, (client, "stuff"))

TypeError: 'member_descriptor' object is not callable 
```

有趣的是，`send()`它是函数类型，让我称之为：

```
In [128]: client.send
Out[128]: <function send>

In [129]: client.send("stuff")
Out[129]: 5 
```

这就是我最初获得名为 client 的套接字对象的方式：

```
In [107]: import signal

In [108]: sock = socket.socket()

In [109]: sock.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)

In [110]: sock.bind(('0.0.0.0', 1025))

In [111]: sock.listen(10)

In [112]: signal.signal(signal.SIGCHLD, signal.SIG_IGN)
Out[112]: 0
In [113]: client, addr = sock.accept() 
```

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T02:48:12.750

> 有趣的是， send() 是函数类型

不正确。`send` *从它的方法返回*一个函数`__get__()`，因为它是一个[描述符](http://docs.python.org/2/howto/descriptor.html)。如果您想调用实际的函数，您将需要自己与描述符协议交互。

```
>>> dir(socket._socketobject.send)
['__class__', '__delattr__', '__delete__', '__doc__', '__format__', '__get__', '__getattribute__', '__hash__', '__init__', '__name__', '__new__', '__objclass__', '__reduce__', '__reduce_ex__', '__repr__', '__set__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__']
>>> type(socket._socketobject.send)
<type 'member_descriptor'> 
```

# express - Express 中的触控笔中间件不起作用？

> ID：14078019
> 
> 赞同：3
> 
> 时间：2012-12-29T01:54:03.143
> 
> 标签：express, stylus

在`app.coffee`我有

```
stylus = require("stylus")

...
app.use stylus.middleware
    debug: true
    src: __dirname + "/stylus"
    dest: __dirname + "/public/css"
    compile: (src) -> 
        console.log(stylus(src))
        return stylus(src) 
```

我将样式包括在以下内容中`layout.jade`：

```
link(rel="stylesheet", href="/css/styles.css") 
```

但是在 Chrome 网络选项卡中，我看到为 styles.css 取消了，这是为什么？

当我将浏览器直接指向时`/css/styles.css`，我得到

> `Cannot GET /css/styles.css`

怎么了？我该如何解决？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-29T05:57:58.417

您是否`static`在中间件堆栈中的触控笔中间件之后正确配置和工作并定位中间件？stylus 中间件只是要读取`.styl`文件并写入相应的`.css`文件，但它希望`static`中间件找到`.css`文件并提供它。

另请注意，您的`src`和`dest`文件层次结构应直接对应。我的意思是，如果您列出一个目录（`ls -R`或类似目录）的递归内容，甚至计算所有中间目录，那么唯一的区别应该是`src`包含`.styl`文件并`dest`包含完全对应的`.css`文件。例如，不要将`/css`前缀附加到一个而不是另一个。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-08-07T09:52:36.117

最近我遇到了同样的问题，只要@PeterLyons 的回答是正确的，我发现在目录名称后添加**额外的斜杠**`css`似乎也可以解决问题。

（不含咖啡）

```
var stylus = require('stylus');

app.configure(function() {
    app.use(stylus.middleware({
        src: __dirname + '/stylus',
        dest: __dirname + '/public/css/' // <-- additional slash after "css"
    }));
    app.use(express.static(__dirname + '/public'));
}); 
```

不确定这是否是与手写笔版本相关的问题，并且以前不存在/不存在，但它仍然让我很困惑。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-22T18:26:41.340

这让我发疯了几个小时，所以我想我会分享:)

我从 /public 提供我的外部文件

所以我的样式表在 /public/styles 中。我所要做的就是将我的 .styl 文件放在项目根目录中名为 /styles 的文件夹中。

```
modules.app.use(modules.stylus.middleware({
    debug: true,
    src: __dirname + '/',
    dest: __dirname + '/public/',
    compile: compile
})); 
```

我绕过了古怪的路径要求，因为我总是会在 /styles 中询问样式

**GET /styles/website.css**从项目的**根 /**目录服务**/styles/website.styl**

 *** * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-09-10T21:58:37.133

这对我有用

```
app.use(express.static('public'));

//stylus
function compile(str, path) {
return stylus(str)
.set('filename', path)
}

app.use(stylus.middleware(
{ src:'/public/css'
 , compile: compile
}
)); 
```

将你的 file.styl 放在 public.css 中，它也会在那里编译！问题一定是 src 目录，似乎你指向模块/手写笔，在任何地方我都不是专家，但这种方式有效**

# angularjs - AngularJS - 有没有一种简单的方法可以在“兄弟”范围内设置变量？

> ID：14078024
> 
> 赞同：4
> 
> 时间：2012-12-29T01:54:56.520
> 
> 标签：angularjs

我有这个问题，我试图点击一个 div 隐藏所有其他相同“种类”的 div。基本上我必须从子范围设置所有其他“兄弟”范围的变量。

为了说明这一点，我创建了以下内容：

**HTML**

```
<div ng-app="myApp">
    <div ng-controller="MyCtrl">
        <div ng-repeat="model in models" ng-controller="MyChildCtrl">
            <a ng-click="toggleVisibility()">toggle {{ model.name }} {{ visibility }}</a>
            <div ng-show="visibility">
                {{ model.name }}
            </div>
        </div>
    </div>
</div>​ 
```

**JavaScript**

```
 var myApp = angular.module('myApp',[]);

    function MyCtrl($scope) {
        console.debug('scope');
        $scope.models = [
            { name: 'Felipe', age: 30 },
            { name: 'Fernanda', age: 28 },
            { name: 'Anderson', age: 18 }
        ];
    }

    function MyChildCtrl($scope) {
        $scope.visibility = false;
        $scope.toggleVisibility = function() {
            $scope.visibility = !$scope.visibility; 
        }
    } 
```

JSFiddle：http: [//jsfiddle.net/fcoury/sxAxh/4/](http://jsfiddle.net/fcoury/sxAxh/4/)

我希望，每次我显示其中一个 div 时，所有其他 div 都会关闭，除了单击的那个。

有任何想法吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-29T11:55:37.097

@kolrie 虽然您的方法有效，但我会建议一种不需要对模型进行任何更改的不同解决方案。基本思想是保留对选定项目的引用并通过将当前项目（内部`ng-repeat`）与选定项目进行比较来计算生存能力。

使用此解决方案，切换功能将变为：

```
$scope.toggleVisibility = function(model) {
    $scope.selected = model;
}; 
```

计算可见性很简单：

```
$scope.isVisible = function(model) {
    return $scope.selected === model;
}; 
```

最后将标记的相关部分修改如下：

```
<div ng-controller="MyCtrl">
    <div ng-repeat="model in models">
        <a ng-click="toggleVisibility(model)">toggle {{ model.name }} {{ isVisible(model) }}</a>
        <div ng-show="isVisible(model)">
            {{ model.name }}
        </div>
    </div>
</div> 
```

这是一个完整的 jsFiddle：http: [//jsfiddle.net/XfsPp/](http://jsfiddle.net/XfsPp/)

在这个解决方案中，您可以保持模型不受影响（如果您想轻松地将其持久化，这很重要）并让 AngularJS 完成所有繁重的工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T01:59:26.327

好的，我已经为模型添加了一个可见属性，并且我设法完成了这项工作：

```
var myApp = angular.module('myApp',[]);

function MyCtrl($scope) {
    console.debug('scope');
    $scope.models = [
        { name: 'Felipe', age: 30, visible: false },
        { name: 'Fernanda', age: 28, visible: false },
        { name: 'Anderson', age: 18, visible: false }
    ];
}

function MyChildCtrl($scope) {
    $scope.toggleVisibility = function() {
        angular.forEach($scope.models, function(model) {
            model.visible = false;
        });
        $scope.model.visible = true;
    }
} 
```

住在这里：http: [//jsfiddle.net/fcoury/sxAxh/5/](http://jsfiddle.net/fcoury/sxAxh/5/)

这是最有效的方法吗？如果我在通过 AJAX 获取模型数据后将此可见属性注入到模型数据中，您认为这是一个好习惯吗？

# jquery - 如果我有一个具有不同 css 样式的页面，并且我想将它加载到 iframe 内具有它自己的 css 样式的页面上

> ID：14078025
> 
> 赞同：-1
> 
> 时间：2012-12-29T01:55:16.613
> 
> 标签：jquery, css

通过jquery加载后是否可以更改该iframe中的css？

这就是我得到的：

```
<script type='text/javascript'>
        $(document).ready(function(){
            $("div#skiptrace div.global-header").css('display', 'none');
            });
    </script>
   <div id="skiptrace"><iframe name="my_iframe" src="" id="skiptrace"></iframe></div>
</div> 
```

我正在尝试将 div.global-header 更改为 display:none.. 我还有其他几个 div，我不想通过简单地用 css 隐藏来加载它们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T02:26:17.580

您有重复的 ID，这假设您的 iFrame ID 是 skiptrace。

```
<script language="javascript">
$(document).ready( function() {
    $("#skiptrace").load( function() {
        $(this).contents().find("div.global-header").css('display', 'none');
    });
});
</script>

<div id="skiptraceContainer">
    <iframe name="my_iframe" src="" id="skiptrace"></iframe>
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T02:04:30.313

您应该能够使用 IFrame 的 content().find(selector)。首先，您需要在 div 和 iframe 上修复您的 id，假设 iframe 的 id 是 iskiptrace。

```
<div id="skiptrace">
    <iframe name="my_iframe" src="" id="iskiptrace"></iframe>
</div>
<script type="text/javascript">
    function loadPage(url)
    {
        $("#iskiptrace").attr('src', url);
        $("#iskiptrace").load( function()
        {
            $("#iskiptrace").content().find(".hidable").css('display', 'none');
        });
    }

    loadPage("iframeIndex.html");
</script> 
```

# c++ - 记录虚假课程

> ID：14078027
> 
> 赞同：1
> 
> 时间：2012-12-29T01:55:39.877
> 
> 标签：c++, lua, doxygen

我有一个函数将我所有需要的 C++ 函数暴露给 Lua，有各种表代表我的“脚本 API”的不同方面，我想做的是使用 doxygen 使用公开这些脚本的 C++ 代码进行脚本引用职能。

我试图在函数的主体中创建“假”类，它成功地使用我给它的名称创建了一个新条目，例如，如果我创建一个名为“Math”的表，它上面有几个函数，如何我是否也会在这个“假”类中创建“假”成员函数，我试图简单地传入 \fn 定义函数，但是它没有显示出来，因为它们实际上不是要添加描述的真实成员。我如何在 doxygen 中创建这种效果，而不需要手动纠正每个类的逐字定义，而是将注释块视为具有真实成员的真实类？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T21:47:14.700

听起来您正试图像记录 C++ 一样记录 Lua 代码。也许这是可能的，但它可能比它的价值更麻烦。

如果您尝试使用 doxygen 记录 Lua 代码，也许您可​​以尝试[doxygen-lua](https://github.com/alecchen/doxygen-lua)。

如果您的 Lua API 很小，您可以手动编写一个页面，并将 \ref 用于相关的 C++ 代码。（有点hacky，但我以前做过。）

您还可以考虑为您的 Lua API 使用其他文档生成器，例如[LuaDoc或 lua-users wiki](http://keplerproject.github.com/luadoc/) [DocumentingLuaCode](http://lua-users.org/wiki/DocumentingLuaCode)上列出的任何其他内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T03:50:16.717

我最终写了一个假的 .doxy 文件，它的类型名类似于 lua 值，显然 doxygen 会记录任何类型来扔给它。

# nsurlconnection - 从 Bakcground 线程调用 SendAsynchronousRequest

> ID：14078028
> 
> 赞同：1
> 
> 时间：2012-12-29T01:55:42.513
> 
> 标签：nsurlconnection

我正在从旧的 API initWithRequest 切换到新的 iOS 5 API sendAsynchronousRequest。对于旧的，文档说发送异步请求的线程也应该负责处理 http 响应。为了遵循这个规则，我必须使用主线程来发送异步请求。现在有了新的 API，我可以从我想要的任何线程发送异步 http 请求吗？

# bash - 用 bash 期望设置 .htpasswd

> ID：14078030
> 
> 赞同：3
> 
> 时间：2012-12-29T01:56:06.580
> 
> 标签：bash, expect, .htpasswd

我正在尝试自动在 .htpasswd 中为 Apache 设置用户密码，但这个脚本似乎并没有真正设置密码。我错过了什么？谢谢！

```
#!/bin/bash

PASSWORD=`tr -dc a-z0-9_ < /dev/urandom | head -c 10`

cat << EOF | /usr/bin/expect
spawn /usr/bin/htpasswd -c /var/.htpasswd testuser
expect "assword:"
send "$PASSWORD\r"
expect "assword:"
send "$PASSWORD\r"
EOF

echo -e "\nPassword set to: $PASSWORD\n" 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T02:53:28.837

`-b`您可以使用该标志在命令行上指定密码。

```
#!/bin/bash

PASSWORD=`tr -dc a-z0-9_ < /dev/urandom | head -c 10`
htpasswd -cb /var/.htpasswd testuser $PASSWORD
echo Password set to: $PASSWORD

# output:
# Adding password for user testuser
# Password set to: gzu00n4lp8 
```

为澄清起见，这是一个使用的版本`expect`：

```
#!/bin/bash

PASSWORD=`tr -dc a-z0-9_ < /dev/urandom | head -c 10`

expect << EOF
spawn htpasswd -c /var/.htpasswd testuser          
expect { 
    "New password:" { send "$PASSWORD\r"; exp_continue }
    "Re-type new password:" { send "$PASSWORD\r"; exp_continue }    
}                      
EOF  

echo Password set to: $PASSWORD 
```

# c++ - 为什么这个模板代码不起作用？

> ID：14078031
> 
> 赞同：4
> 
> 时间：2012-12-29T01:56:11.033
> 
> 标签：c++, templates

他们告诉我使用模板来查找总和。为什么这不起作用？谢谢。

```
template <typename A, typename B, typename C>
auto add(A a, B b, C c = a + b) -> decltype(c) {
    return c;
} 
```

我以为 C++11 说你可以在声明参数后使用它们。为什么这不起作用呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T02:00:17.707

您不能使用参数作为默认值。此外，模板类型推导不起作用。

就这样写吧：

```
template <typename A, typename B>
auto add(A a, B b) -> decltype(a + b) {
    return a + b;
} 
```

并希望 C++ 尽快获得返回类型推导。

# php - PHP将序列化数组从表单传递到同一页面

> ID：14078032
> 
> 赞同：1
> 
> 时间：2012-12-29T01:56:27.803
> 
> 标签：php

我有以下脚本来更新包含六行文本的文本文件，每行都有一个日期和内容。我试图允许用户通过 HTML 表单编辑文本，并且表单将该信息传递回自身以修改文本文件。那部分还没有，但我稍后会处理它。

我的问题是在发布后取消序列化数组。任何帮助将不胜感激。

```
<?php

$fp = fopen(dirname(__FILE__).'/scroller/db.txt','r+');
if (!$fp) {echo 'ERROR: Unable to open file.'; exit;}

if (isset($_REQUEST['serializedArray'])) {
    $serialized = $_REQUEST['serializedArray'];
    $unserialized = unserialize(stripslashes($serialized));
    print_r($unserialized);
    // Future code to modify db.txt file and save it.
}

$index = 0;
echo '<form action="'.$_SERVER['PHP_SELF'].'" method="POST"><table>';
while (!feof($fp)) {
    $index++;
    $line = fgets($fp, 256); //Length of data per line to grab in db.txt file.
    $field[$index] = explode ('|', $line); // Column 0 = Date, 1 = Content.
    echo '
        <tr>
            <td><input type="text" name="date" size="20" value="'.$field[$index][0].'"></td><td><input type="text" name="content" size="20" value="'.$field[$index][1].'"></td>
        </tr>';
    $fp++;
}
echo '</table>';
$serializedArray = serialize($field);
fclose($fp);
echo "<input type='hidden' name='serializedArray' value='".$serializedArray."'>";
echo '<input type="submit" value="Submit"></form>';
?> 
```

使用带有会话的表单会更容易吗？

# jquery - jQuery函数循环改变背景图像崩溃firefox

> ID：14078042
> 
> 赞同：1
> 
> 时间：2012-12-29T01:58:01.430
> 
> 标签：jquery, jquery-animate

我想要一个背景图像淡入淡出。

我有两个相互重叠的 div，背景设置为图像。

在我的 jQuery 中，我以一个 div 为目标，然后将不透明度设为零，显示另一个。然后我做相反的事情。但是，这是可行的，但现在由于某种原因，这个无限循环使 Firefox 崩溃。

我该怎么做才能让它不崩溃？

```
 $(document).ready(function() {
                function change (){
                  $('#back1').animate({opacity:0}, {duration:3000});
                  $('#back1').delay(1000);
                  $('#back1').animate({opacity:1},  {duration:3000});
                  $('#back1').delay(1000);
                  change();

                }

                change();

            }); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T02:06:19.863

问题是您`change()`在动画完成之前调用，因此您正在创建竞争条件。动画是异步的。动画有一个可以使用的完整回调。

试试这个：

```
function change (){
     $('#back1').animate({opacity:0}, {duration:3000}) 
                .delay(1000)
                .animate({opacity:1},  {duration:3000}, function(){
                      /* use complete callback of final animation to start sequeunce again*/
                      change();
                 });                  

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-24T04:39:19.960

您必须使用函数的回调

# android - 总是对 SQLite 主键使用“最低可能值”？

> ID：14078043
> 
> 赞同：0
> 
> 时间：2012-12-29T01:58:02.123
> 
> 标签：android, sqlite

我有一个表 PERSON_TABLE，它有 P_ID、P_NAME、P_AGE

P_ID 是主键和自动增量..

我有一个活动，用户将手动将数据放入每一列。如果成功，它将有一个主键，从 1 开始，然后是 2 ，然后是 3 等等。

但该应用程序也有其删除功能。如果我删除第 2 行，然后我再次插入 1 行，它将具有主键 4，我希望下一个插入的数据将使用第一个可用的主键，即 2。我该如何实现？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T02:31:19.693

您确实应该重新检查此要求-很少需要。

由于总会出现序列中存在间隙的情况（除非您在删除时重新排序，这*将*是性能杀手），您的应用程序将不得不处理它。

而且，由于您的应用程序处理它，它也可以一直处理它。

我想不出人工主键需要连续的真正原因。除了使用主键作为真实数据的编写不佳的查询（他们可能不应该使用人工键）之外，排序中的差距不会影响性能。

所以我的建议是从不需要连续键的假设*开始（而**不是*从需要它们的想法开始），然后想出一个你认为它们是的原因。我想你会发现很难想出一个不能以更好的方式满足的理由。

# javascript - 在流星中更新用户电子邮件地址的最佳方法是什么？

> ID：14078050
> 
> 赞同：2
> 
> 时间：2012-12-29T01:58:42.187
> 
> 标签：javascript, meteor

因此，内置的[流星](http://meteor.com)身份验证系统将用户电子邮件存储在用户名下，如下所示：

```
emails: [ { address: d@s.com, verified: true} ] 
```

是否有一种“流星”方式来设置主电子邮件并更新电子邮件地址（或添加/删除电子邮件）？

在我看来，如果它们像这样存储起来会简单得多：

```
emails: { 'd@s.com': { verified: true } } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T02:04:07.583

您建议的对象格式没有意义，因为那我该如何请求该对象？通常我会说`obj.emails[i].address`，现在我不得不说……什么？`for (var key in obj.emails) { var email = obj.emails[key]; }`? 那要复杂得多。

要更新电子邮件地址，您应该更改用户记录中的电子邮件地址，将其标记为未验证，并使用[Account.sendVerificationEmail](http://docs.meteor.com/#accounts_sendverificationemail)启动验证过程。

# python - 在 SQLAlchemy 中创建混合属性的自定义元类

> ID：14078052
> 
> 赞同：2
> 
> 时间：2012-12-29T01:58:54.393
> 
> 标签：python, sqlalchemy, metaclass

我想在 SQLAlchemy 之上创建一个自定义接口，以便透明地支持一些预定义的混合属性。

具体来说，我想创建一个类`SpecialColumn`和一个元类，以便当用户添加`SpecialColumn`为类的属性时，我的自定义元类用两个 SQLAlchemy 替换该属性`Column`并添加一个混合属性，该属性将这两个列获取和设置为一个元组。到目前为止，这是我的方法：

首先，我定义了我的特殊列类型：

```
class SpecialColumn(object):
     pass 
```

然后，我定义了一个继承自 DeclarativeMeta 的元类，它扫描类中的实例`SpecialColumn`并用两个`Column`s 和一个混合属性（定义为闭包）替换它们：

```
class MyDeclarativeMeta(DeclarativeMeta):

     def __new__(cls, name, bases, attrs):
          for name, col in attrs.items():
              if isinstance(col, SpecialColumn):
                  # Replacing the column
                  del attrs[name]
                  col1_name = '_{0}_1'.format(name)
                  col2_name = '_{0}_2'.format(name)
                  attrs[col1_name] = Column(...)
                  attrs[col2_name] = Column(...)
                  # Adding the hybrid property
                  def getter(self):
                      return (getattr(self, col1_name), getattr(self, col2_name))
                  attrs[name] = hybrid_property(getter) 
```

最后我`declarative_base`用它构造了一个实例，并让用户用新的基础定义类：

```
MyBase = declarative_base(metaclass=MyDeclarativeMeta)

class MyClass(MyBase):
    col1 = SpecialColumn()
    col2 = Column(...) 
```

现在我的问题是：首先，我的方法正确吗？其次，如何使用元类添加setter？这样做是否正确：

```
def setter(self, (v1, v2)):
    setattr(self, col1_name, v1)
    setattr(self, col2_name, v2) 
```

然后干脆`attrs[name].setter(setter)`呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-31T00:14:25.360

没有必要为 SQLAlchemy 映射类使用元类，因为我们提供了大量[事件](http://docs.sqlalchemy.org/en/rel_0_8/orm/events.html)来在创建和/或映射类时向类添加特性。 [mapper_configured](http://docs.sqlalchemy.org/en/rel_0_8/orm/events.html#sqlalchemy.orm.events.MapperEvents.mapper_configured)在这里可能很好，如果您使用的是 0.8，则可以`MyBase`直接申请：

```
@event.listens_for(MyBase, 'mapper_configured')
def get_special_columns(mapper, cls):
    for attrname in dir(cls):
        val = getattr(cls, attrname)
        if isinstance(val, SpecialColumn):
             name1, name2 = "_%s_1" % attrname, "_%s_2" % attrname
             setattr(cls, name1, Column(...))
             setattr(cls, name2, Column(...))

             @hybrid_property
             def myhybrid(self):
                 return getattr(self, name1), getattr(self, name2)

             @myhybrid.setter
             def myhybrid(self, value):
                 setattr(self, name1, value[0])
                 setattr(self, name2, value[1])

             setattr(cls, attrname, myhybrid) 
```

请注意， setattr() 是最好的方法，简单明了。

# google-app-engine - GAE webapp2 session：创建和检查会话的正确过程

> ID：14078054
> 
> 赞同：15
> 
> 时间：2012-12-29T01:59:25.087
> 
> 标签：google-app-engine, session, webapp2

我试图实现 GAE 的 webapp2 会话，但是关于它的文档似乎很少。根据[http://webapp-improved.appspot.com/api/webapp2_extras/sessions.html](http://webapp-improved.appspot.com/api/webapp2_extras/sessions.html)，我的步骤如下：

1.配置并添加配置到主应用程序：

```
config = {}
config['webapp2_extras.sessions'] = {
    'secret_key': 'my_secret_key',
}
app = webapp2.WSGIApplication([...], config=config) 
```

2.在登录处理程序中创建会话

```
# Delete existent session
  --> not mention in the tutorial
# member is found    
self.session_store = sessions.get_store(request=handler.request)
self.session['account'] = member.account 
```

3.检查我的程序中不同位置是否存在会话

```
if self.session['account']:
    # Session exists 
```

4.用户注销时删除会话

```
--> not mentioned in the tutorial 
```

我的问题：

1.  我在会话创建过程中收到错误消息“...对象没有属性'会话'”（步骤 2）

2.  如何删除第 2 步和第 4 步中的会话？

3.  整个会话管理过程是否正确？

谢谢。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-29T15:17:19.723

这是处理程序的示例以及如何使用 webapp2 额外会话

带有 BaseHandler 和 MainHandler 的 main.py

```
import webapp2
from webapp2_extras import sessions

class BaseHandler(webapp2.RequestHandler):              # taken from the webapp2 extrta session example
    def dispatch(self):                                 # override dispatch
        # Get a session store for this request.
        self.session_store = sessions.get_store(request=self.request)

        try:
            # Dispatch the request.
            webapp2.RequestHandler.dispatch(self)       # dispatch the main handler
        finally:
            # Save all sessions.
            self.session_store.save_sessions(self.response)

    @webapp2.cached_property
    def session(self):
        # Returns a session using the default cookie key.
        return self.session_store.get_session()

class YourMainHandler(BaseHandler):

    def get(self):

        ....
        self.session['foo'] = 'bar'

    def post(self):

        foo = self.session.get('foo') 
```

如果你有一个单独的 login.py ：

```
.... other imports
import main

class Login(main.BaseHandler):

    def get(self):

        ....
        self.session['foo'] = 'bar'

    def post(self):

        foo = self.session.get('foo') 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-04T05:54:23.170

这可能不是问题的直接答案，但这是我使用 gaesessions 而不是 GAE 的 webapp2 会话找到的解决方案，我想与大家分享。开始了：

1.  通过单击“下载 ZIP”按钮从[https://github.com/dound/gae-sessions](https://github.com/dound/gae-sessions)下载 gaesessions 。下载的文件是“gae-sessions-master.zip”。

2.  解压缩文件（将创建一个目录“gae-sessions-master”），并将目录“gaessions”复制到应用程序的根目录（即“app.yaml”所在的位置）

3.  在根目录中创建一个名为“appengine_config.py”的文件，内容如下（从[https://github.com/dound/gae-sessions/tree/master/demo](https://github.com/dound/gae-sessions/tree/master/demo)复制）：

    ```
    from gaesessions import SessionMiddleware

    # Original comments deleted ... 
    # Create a random string for COOKIE_KDY and the string has to
    # be permanent. "os.urandom(64)" function may be used but do
    # not use it *dynamically*.
    # For me, I just randomly generate a string of length 64
    # and paste it here, such as the following:

    COOKIE_KEY = 'ppb52adekdhD25dqpbKu39dDKsd.....'

    def webapp_add_wsgi_middleware(app):
        from google.appengine.ext.appstats import recording
        app = SessionMiddleware(app, cookie_key=COOKIE_KEY)
        app = recording.appstats_wsgi_middleware(app)
        return app 
    ```

4.  当用户登录时创建会话（变量*account*是用户的账户）：

    ```
    from gaesessions import get_current_session
    session = get_current_session()
    if session.is_active():
        session.terminate()
    # start a session for the user (old one was terminated)
    session['account'] = account 
    ```

5.  检查用户的会话是否存在，如果存在，返回用户的账号：

    ```
    from gaesessions import get_current_session
    def checkSession():
        session = get_current_session()
        if session.is_active():
            return session['account']
        return False 
    ```

6.  用户注销时删除会话：

    ```
    def logout():
        session = get_current_session()
        if session.is_active():
            session.terminate() 
    ```

7.  最后，您可以创建一个 cron 作业来定期清理过期的会话：

cron.yaml：

```
- description: daily session cleanup
  url: /clean_up_sessions
  schedule: every day 3:00
  timezone: ... (Your time zone) 
```

功能：

```
from gaesessions import delete_expired_sessions
class clean_up_sessions(webapp2.RequestHandler):
    def get(self):
        while not delete_expired_sessions():
            pass 
```

希望这可以帮助。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-08-26T20:34:09.843

在您的`RequestHandler`覆盖`dispatch`中：从 webapp2_extras 导入会话

```
def dispatch(self):

    self.session_store = sessions.get_store(request=self.request)

    try:
        webapp2.RequestHandler.dispatch(self)
    finally:
        self.session_store.save_sessions(self.response) 
```

并`webapp2.cached_property`调用`session`：

```
@webapp2.cached_property
def session(self):
    return self.session_store.get_session(backend="<whatever you want here>") 
```

当您想访问会话值时，您可以`self.session[<key>]`

当用户登录时，您可以调用：

```
 self.auth.get_user_by_password(auth_id, password, remember=True,
                                           save_session=True) 
```

这将负责摆脱旧会话并为您创建新会话，或者：

```
self.auth.set_session(self.auth.store.user_to_dict(self.user), remember=True) 
```

至于注销，您只需要调用：

```
self.auth.unset_session() 
```

# objective-c - 在 UIWebView (IOS 5) 中更改用户代理

> ID：14078055
> 
> 赞同：4
> 
> 时间：2012-12-29T01:59:25.787
> 
> 标签：objective-c, ios5, uiwebview, user-agent

到目前为止我所做的：我使用下面的代码来更改项目中 UIWebView 中的 User-Agent。

```
NSDictionary *userAgentReplacement = [[NSDictionary alloc]           initWithObjectsAndKeys:userAgent, @"UserAgent",nil];
[[NSUserDefaults standardUserDefaults] registerDefaults:userAgentReplacement]; 
```

问题：我的代码可以正常工作，但是当我再次调用该函数以将 UserAgent 更改为其他内容时，UIWebView 不会更新。为了成功更新 UserAgent，我需要删除/释放 UIWebView 并再次分配/显示它，但这会导致 UIWebView 丢失所有历史记录。有什么方法可以更新 UserAgent 而无需创建新的 UIWebView 使其生效？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-21T16:38:33.093

当您使用 NSUserDefaults 时，我假设您将它们设置为

```
application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions 
```

我以前使用的替代方法是

```
NSMutableURLRequest*request=[NSMutableURLRequest requestWithURL:[NSURL URLWithString:yourURL]];
[request setValue:userAgent forHTTPHeaderField:@"User-Agent"];
[webView loadRequest:request]; 
```

您还可以使用 UIWebView Delegate 使用 NSString 变量捕获 webview 的最后加载状态

```
-(void)webViewDidFinishLoad:(UIWebView *)webView{
    currentConfig=[webView stringByEvaluatingJavaScriptFromString:@"document.body.innerHTML];
} 
```

然后使用重新加载webView

```
[webView loadHTMLString:currentConfig baseURL:yourURL]; 
```

# css - 修复重叠的 CSS

> ID：14078058
> 
> 赞同：0
> 
> 时间：2012-12-29T01:59:30.983
> 
> 标签：css, mvc-mini-profiler

我开始在我的站点中使用[Miniprofiler](http://miniprofiler.com/)，但在其弹出窗口中遇到了渲染问题。问题是我网站的 CSS “过于全球化”，例如：

```
thead th:last-child {
    background: url("img/rb.gif") no-repeat scroll right 0 transparent !important;
    height: 42px;
} 
```

这与 MiniProfiler 的样式冲突，它的弹出窗口看起来像地狱（特别是它的表格不需要背景图像等）。我试图缩小我的 CSS 范围，但该网站很大并且带来了更多问题（我不是设计师）。但是，我可以修改 MiniProfiler 的源代码/样式并重新构建它。我需要的是具有`profiler-results`类的容器中的元素忽略所有“全局”样式。我最好的选择是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T02:11:04.587

也许你可以试试 CSS Scoped，它是一个 HTML5 特性。您可以尝试使用此功能找到解决方法，因为您说您的网站如此之大。并且只想对您网站上的特定部门应用 css 规则。

[作用域 CSS](http://css-tricks.com/saving-the-day-with-scoped-css/)

# ios - 从 Tap Gesture 中抓取特定的 Collection View 单元格

> ID：14078060
> 
> 赞同：1
> 
> 时间：2012-12-29T01:59:45.210
> 
> 标签：ios, uicollectionview, uitapgesturerecognizer

我有一个 UICollectionView 显示图像缩略图。网格中的每个图像视图都有一个点击手势。我的问题是，我怎样才能抓住被窃听的确切单元格？例如“点击索引#43”。

**补充评论**

*   点击手势是通过程序创建的，没有使用故事板。
*   我在这个项目中启用了 ARC 和 Story Board。

这是我最接近的：

**UICollectionViewController**

```
-(UICollectionViewCell *)collectionView:(UICollectionView *)collectionView
                 cellForItemAtIndexPath:(NSIndexPath *)indexPath
{
    int row = [indexPath row];

    CollectionViewCell *Cell = [collectionView
        dequeueReusableCellWithReuseIdentifier:@"Cell"
                                  forIndexPath:indexPath];
    // Enable tap gesture on each ImageView
    [Cell.ImageView setUserInteractionEnabled:YES];
    UITapGestureRecognizer *tapGesture = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(handleTapGesture)];
    [tapGesture setNumberOfTouchesRequired:1];
    [tapGesture setNumberOfTapsRequired:1];
    [tapGesture setDelegate:self];
    [Cell.ImageView addGestureRecognizer:tapGesture];

    Cell.ImageView.tag = row; // This tags correctly
}

- (void)tapShowImage // Also, for some reason, 
                     // - (void)handleTapGesture:(UITapGestureRecognizer *)sender
                     // doesn't work. I get an invalid selector error.
{
    NSLog(@"%i", Cell.ImageView.tag);
    // Doesn't work because I can't call Cell.ImageView.tag here.
    // Might be because I"m using SDWebImage to load the image
    // into the ImageView above but not sure.
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T04:29:34.957

您无需为每个单元格添加点击识别器。您可以在 collectionView:didSelectItemAtIndexPath: 方法中获取被点击单元格的 indexPath。

# c# - 自动化解决方案中的多个项目

> ID：14078061
> 
> 赞同：1
> 
> 时间：2012-12-29T02:00:02.637
> 
> 标签：c#, visual-studio-2010

我有一个包含 3 个不同项目 A、B 和 C 的解决方案。现在我必须按照 C、B 和 A 的顺序在调试模式下运行项目。无论如何我可以自动化运行过程。目前我必须在调试模式下运行 C，然后是 B，然后是 A。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T02:14:52.767

好的，你可以这样做`right-click your solution > Properties > Common Properties > StartUp Project`

在这里可以设置“多个启动项目” ![在此处输入图像描述](../Images/d881fe7cc7643206d68db70691d30241.png)

# c# - 像实时新闻提要ajax刷新一样实现facebook？

> ID：14078062
> 
> 赞同：1
> 
> 时间：2012-12-29T02:00:10.687
> 
> 标签：c#, javascript, jquery, ajax, facebook

第一个版本，我每 1 秒查询一次数据库以获取新数据。这可行，但这很糟糕，数据库被查询太多次。

如何像 facebook newsfeed 一样有效地在页面上实现实时 ajax 刷新内容？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T02:16:28.190

“实时”最好使用 Web 套接字或类似技术实现，其中服务器可以在新内容可用时将数据发布到客户端，而不是来自客户端的持续轮询。

如果您需要进行 ajax 轮询，请使用较慢的时间间隔并确保将请求缓存在服务器上，这样如果没有可用的新数据，您就不会进行任何查询。您还可以从客户端发送令牌（f.ex 时间戳），以便服务器可以检查令牌是否“新鲜”，或者您是否需要在返回响应之前查询新数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T02:12:19.660

为什么不只使用 RSS 样式的提要？您可以每分钟左右轮询一次数据库以生成提要，或者您可以将其绑定，以便您可以从输入过程直接附加到提要？

[http://www.rssboard.org/rss-specification](http://www.rssboard.org/rss-specification)

一旦您构建了提要（并且可以选择在您的登录系统后面保护），您就可以使用 jFeed 访问它。

[http://plugins.jquery.com/project/jFeed](http://plugins.jquery.com/project/jFeed)

# erlang - 从命令行通过basho rebar运行Erlang应用程序时如何设置Erlang节点名称

> ID：14078065
> 
> 赞同：8
> 
> 时间：2012-12-29T02:00:31.380
> 
> 标签：erlang, rebar

我已经使用 basho rebar 编译了我的 Erlang 应用程序，它制作了一个独立的 escript 可执行文件。我从命令行运行它，例如： ./myapp myconfig.config

我的问题是如何确定运行我的应用程序的 Erlang 节点名称。当在我的应用程序中运行“node()”命令时，它默认返回“nonode@nohost”，但我想将我的名字指定给该节点（例如 mynode@domain.com），所以当我运行“node()”时在我的应用程序中，我喜欢看到“mynode@domain.com”而不是“nonode@nohost”

我知道“erlang -name 'mynode@domain.com'”，但请考虑我从命令行运行应用程序。我认为 Erlang VM 在应用程序生命周期内会自动运行和终止。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-12-29T07:30:08.287

最好的方法当然是通过“-sname node”或“-name node@host”在命令行中设置nodename。但也可以改用“net_kernel”模块。它在[http://www.erlang.org/doc/man/net_kernel.html中有描述](http://www.erlang.org/doc/man/net_kernel.html)

```
$ erl
Erlang R15B01 (erts-5.9.1) [source] [64-bit] [smp:2:2] [async-threads:0] [hipe] [kernel-poll:false]

Eshell V5.9.1  (abort with ^G)
1> node().
nonode@nohost
2> net_kernel:start([rumata, shortnames]).
{ok,<0.34.0>}
(rumata@rumata-osx)3> node().
'rumata@rumata-osx'
(rumata@rumata-osx)4> net_kernel:stop().
ok
5> node().
nonode@nohost
6> net_kernel:start(['rumata@myhost', longnames]). 
{ok,<0.44.0>}
(rumata@myhost)7> node().
rumata@myhost 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T22:45:51.487

您可以使用神奇的“模拟器参数”行（如[escript 文档](http://www.erlang.org/doc/man/escript.html)中所述）。例如：

```
#!/usr/bin/env escript
%%! -sname ohai

main(_Args) ->
    io:format("I am: ~p~n", [node()]). 
```

-prefixed`%%!`行被视为`erl`在命令行上传递给它，允许您从那里指定节点名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T07:48:17.787

我查看了一个使用钢筋（氮）分发的应用程序。它们使用参数 -args_file 在配置文件中传递大部分 vm 参数：

```
erts-5.9\bin\werl -pa %PA% -boot releases/2.1.0/nitrogen -embedded -config etc/app.generated.config  -args_file etc/vm.args 
```

并且在 vm.args 中只需使用参数 -name 来定义节点名称：

```
-name nitrogen@127.0.0.1 
```

# javascript - Jquery在输入中禁用自动完成

> ID：14078067
> 
> 赞同：27
> 
> 时间：2012-12-29T02:01:23.460
> 
> 标签：javascript, jquery, autocomplete

我有这个代码：

的HTML：

```
<input id="register_username" type="text">
<input id="register_password" type="text">
<input id="register_repeatpassword" type="text">
<input id="register_email" type="text"> 
```

jQuery：

```
$(document).ready(function(){
    $('#register_username').attr('autocomplete','off');
    $('#register_password').attr('autocomplete','off');
    $('#register_repeatpassword').attr('autocomplete','off');
    $('#register_email').attr('autocomplete','off');
    }); 
```

我想禁用某些浏览器提供的自动完成功能，并让用户输入整个字段，但代码不起作用，下拉菜单仍然出现，用户仍然可以选择之前输入的内容。我也尝试过用户`autocomplete="off"`，但什么也没发生。我在这里做错了什么？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-12-29T02:02:51.870

只需添加：

```
autocomplete="off" 
```

作为`INPUT`元素的属性，f.ex：

```
<input autocomplete="off" id="register_username" type="text" name="username"> 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2014-03-07T17:45:34.243

**jQuery**版本：

```
$("#register_username").attr("autocomplete", "off"); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-12-29T07:58:03.860

检查这个[小提琴](http://jsfiddle.net/jtFec/)

```
 document.getElementById("register_username").autocomplete="off" 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2019-04-25T18:33:45.200

万一有人来这里寻找如何关闭他们的 jquery 自动完成功能：

```
$("#elementId").autocomplete({
  disabled: true
  }); 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-12-29T02:11:51.790

虽然我同意，`autocomplete="off"`应该得到广泛支持并且是最终解决方案，但它不起作用可能是[HTML5 规范关于 autocomplete 属性](http://www.w3.org/TR/2011/WD-html5-20110525/common-input-element-attributes.html#the-autocomplete-attribute)的结果：

> 自动完成机制必须由用户代理实现，就像用户修改了元素的值一样，并且**必须在元素可变的时候完成**（例如，在元素刚刚插入文档之后，或者当用户代理停止解析）。

对我来说，这意味着它应该是元素的“原始”属性，并且不能在渲染后添加。而且由于大多数浏览器都在实现新的规范¹，因此如果他们在可能根据上述规范更正实现之前就允许使用 javascript 的话。

如果您还没有，请尝试将属性直接添加到控件中，而不是依赖 jQuery 在 [大概] 文档准备好的情况下这样做。

¹ *由于 HTML5 不是标准，因此我在这里使用规范很随意，但许多浏览器正在实现一些更具体的功能。由于`autocomplete`自 IE5 以来一直存在，它可能是您可以考虑安全实现的其中之一。*

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2018-04-04T04:59:05.567

现在有一天，您需要将“off”更改为另一个随机字符串，例如“nope”：

**查询：**

```
$("#register_username").attr("autocomplete", "nope"); 
```

**HTML：**

```
<input id="register_username" type="text" autocomplete="nope"> 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-04-27T12:24:40.360

```
<form id='myForm'>
    <input id="register_username" type="text">
    <input id="register_password" type="text">
    <input id="register_repeatpassword" type="text">
    <input id="register_email" type="text">
</form>
$(document).ready(function(){
    $('#myForm').on( 'focus', ':input', function(){
        $(this).attr( 'autocomplete', 'off' );
    });
}); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-10-15T21:28:31.647

对于仍在为这个问题苦苦挣扎的人来说，这种解决方案的组合是唯一对我有用的东西。基于此脚本： [https ://github.com/terrylinooo/jquery.disableAutoFill](https://github.com/terrylinooo/jquery.disableAutoFill)

```
<form id="myForm">...</form> 
```

将这些放在页面的页脚中：

```
 <script src="https://cdn.jsdelivr.net/npm/disableautofill/src/jquery.disableAutoFill.min.js"></script> 

<script>
        $(document).ready(function () {
            $("input").attr("autocomplete", "new-password");
            $('#myForm').disableAutoFill();
        });
    </script> 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2019-04-23T16:01:47.777

工作时间为 2019 年 4 月 23 日。

如果您想在页面上的所有内容上禁用 Chrome 的自动填充功能，特别是如果您不使用表单而是使用序列化的 jquery 选择器来提交数据。

在运行时执行此操作对我来说效果最好，而且 Chrome 无论如何都会在运行时自动填充，因此这是对抗 Chrome 行为的合理解决方案。

只需在代码底部添加此内容，Chrome 就不会尝试强制自动填充内容：

```
<script>
    $(document).ready(function () {
        $("input").attr("autocomplete", "new-password");
    });
</script> 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-02-16T21:34:16.913

使用 jQuery，我在布局页面中执行此操作，或者在网站的每个页面上显示一些 HTML。

```
$(document).ready(function () {

        //when the page is done loading, disable autocomplete on all inputs[text]
        $('input[type="text"]').attr('autocomplete', 'off');

        //do the same when a bootstrap modal dialog is opened
        $(window).on('shown.bs.modal', function () {
            $('input[type="text"]').attr('autocomplete', 'off');
        });
}); 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2020-09-21T07:17:50.497

如果有人来这里寻找如何在他们页面的每个表单上关闭他们的 jquery 自动完成功能：

`$('form *').prop('autocomplete', 'off');`

# actionscript-3 - 如何在 Starling 中获取纹理的像素值？

> ID：14078071
> 
> 赞同：1
> 
> 时间：2012-12-29T02:01:38.613
> 
> 标签：actionscript-3, haxe, starling-framework

为了测试我在 AS3 中使用传统显示层次结构编写的一些图像加载代码，我会确保像素颜色是正确的值。

现在我已经开始将该代码移植到 Starling，我注意到`Texture`s 没有简单的方法来获取像素值。这是不幸的，因为这意味着我不得不折腾很多好的测试。

有什么可能的方法可以做到这一点吗？就像，我可以`Texture`以`BitmapData`某种方式转换 a 吗？或者你们对如何测试以确保我已正确加载图像有任何其他建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T02:49:05.217

事实上，这在有限的情况下是可能的（但我需要的那些！）。以下代码是 Haxe，但希望任何来自 AS3 背景的人都能够以最小的难度翻译它。

```
public function getPixel(x:Int, y:Int, sprite: Starling.display.Sprite) : UInt {
    var sw: Int = stage.stageWidth;
    var sh: Int = stage.stageHeight;

    var support:RenderSupport = new RenderSupport();
    RenderSupport.clear(flash.Lib.current.stage.color, 1.0);
    support.setOrthographicProjection(0, 0, sw, sh);
    Fathom.starling.stage.render(support, 1.0);
    support.finishQuadBatch();

    var result:BitmapData = new BitmapData(sw, sh, true);
    Starling.context.drawToBitmapData(result);

    return result.getPixel(Std.int(sprite.x) + x, Std.int(sprite.y) + y);
} 
```

这段代码所做的是将在 3D 上下文中显示的每个对象渲染到`result`BitmapData。然后，我们在精灵所在的位置从该 BitmapData 中获取一个像素。

这并不完美——它不考虑旋转、缩放等。它也不考虑是否`sprite`没有最高深度。但是它对测试很有帮助，如果您需要截取应用程序/游戏的当前状态，它也可能会派上用场。

# python - 使用 Google 日历了解活动的日期？

> ID：14078072
> 
> 赞同：1
> 
> 时间：2012-12-29T02:01:49.907
> 
> 标签：python, google-api, google-calendar-api

谷歌日历有什么方法可以简单地为我提供事件发生的星期几的名称？例如，如果我检索一个日期范围内的事件列表，如下所示：

```
events = service.events().list(calendarId='primary', timeMin='2012-12-24T00:00:00Z',
 timeMax='2012-12-30T23:59:59Z').execute() 
```

有没有办法在该列表中查找特定事件并找出它在哪一天？现在我正在使用一个尴尬的技巧，涉及 Google Calendar API 中的“date”和“dateTime”以及 Python 的 calendar 模块：

```
for calendar_list_entry in events['items']:
    try:
        year, month, day = calendar_list_entry['start']['date'].split('-')
        dayNum = calendar.weekday(int(year), int(month), int(day))
        print dayNum
        dayName = createDayName(dayNum)
        dayDict[dayName].append(calendar_list_entry['summary'])
        print dayDict[dayName]
    except:
        print calendar_list_entry['start']['dateTime'][:10].split('-')
        year, month, day = calendar_list_entry['start']['dateTime'][:10].split('-')
        dayNum = calendar.weekday(int(year), int(month), int(day))
        print dayNum
        dayName = createDayName(dayNum)
        dayDict[dayName].append(calendar_list_entry['summary'])
        print dayDict[dayName] 
```

createDayName 函数很简单：

```
def createDayName(dayNum):
    '''
    Takes as input a number generated from calendar.weekday and outputs the weekday name
    that is associated with that number.
    '''
    dayNameList = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday']
    return dayNameList[dayNum] 
```

当然有一个不那么麻烦的方法来做到这一点？对于跨越多天的事件，我也遇到了严重的问题，即周四至周六。我意识到我可以做一些荒谬的数学来划分日子，但必须有更好的方法来完成如此简单的操作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T02:15:24.647

据我所知，没有直接的方法可以在日历 API 中获取事件的日期。如果结果的日期格式与参数 ( `2012-12-24T00:00:00Z`) 中的格式一致，则可以将字符串格式与`datetime`模块结合使用。这里，`%A`是字符串格式化参数，它返回日期时间对象的星期几，该日期时间对象是通过`strptime`在我们的字符串上运行而定义的，具有相应的格式：

```
In [1]: from datetime import datetime

In [2]: s = '2012-12-24T00:00:00Z'

In [3]: d = datetime.strptime(s, '%Y-%m-%dT%H:%M:%SZ')

In [4]: '{0:%A}'.format(d)
Out[4]: 'Monday' 
```

作为一个函数：

```
In [8]: def createDayName(s):
   ...:     d = datetime.strptime(s, '%Y-%m-%dT%H:%M:%SZ')
   ...:     return '{0:%A}'.format(d)
   ...: 

In [9]: createDayName('2012-12-24T00:00:00Z')
Out[9]: 'Monday'

In [10]: createDayName('2012-12-30T23:59:59Z')
Out[10]: 'Sunday' 
```

在此基础上，如果您需要处理多日事件，您可以尝试这样的事情，其中​​主要部分涉及`timedelta`并迭代两个事件之间的天数（请注意，这有点随意，但希望能提供一个有用的例子）：

```
from datetime import datetime, timedelta

# This structure will allow us to append to our dictionary without
# there needing to be a key first (comes in handy)
from collections import defaultdict

def days_in_range(start, end, daysDict):
    # Convert your start/end dates
    start_d = datetime.strptime(start, '%Y-%m-%dT%H:%M:%SZ')
    end_d = datetime.strptime(end, '%Y-%m-%dT%H:%M:%SZ')

    # Now iterate over the days between those two dates, adding
    # an arbitrary value to the 'day' key of our dict
    for i in range((end_d - start_d).days + 1):
        day_name = '{0:%A}'.format(start_d + timedelta(days=i))
        daysDict[day_name].append(i)
    return daysDict

# Create your dictionary that will have a list as the default value
daysDict = defaultdict(list)

start = '2012-12-24T00:00:00Z'
end = '2012-12-30T23:59:59Z'

# I would probably reevaluate this part, but the reason for
# passing the dictionary itself to the function is so that
# it can better fit into situations where you have multiple events
# (although a class structure may be well-suited for this, but
# that may be overcomplicating things a bit :) )
daysDict = days_in_range(start, end, daysDict)

for day, value in daysDict.iteritems():
  print day, value 
```

这将打印以下内容（由于字典本质上是无序的，因此对您来说可能会有所不同）：

```
Monday [0]
Tuesday [1]
Friday [4]
Wednesday [2]
Thursday [3]
Sunday [6]
Saturday [5] 
```

# hook - 在 Liferay 中为用户注册创建额外的验证步骤

> ID：14078073
> 
> 赞同：0
> 
> 时间：2012-12-29T02:01:50.173
> 
> 标签：hook, liferay, registration, liferay-6, user-registration

我正在尝试在 Liferay 的用户注册过程中添加一些验证步骤，但似乎找不到合适的位置。

据我所知，在创建新用户时没有可以添加自己的代码的事件（与我们有“login.events.post”事件的登录过程相反）。

有没有办法做到这一点？

**更新：**我们试图避免重做liferay 已经做的事情，即使创建一个新的用户注册portlet 很有意义。

我刚刚发现了这个`"servlet.service.events.pre"`事件，并认为可以在`CreateAccountAction`类上创建一个钩子来添加我自己的验证，但是我从 liferay 关于这个主题的文档中没有得到太多。任何想法/建议/链接将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T06:33:20.037

我试图在下面提出一个非常简单的方法。

您不必创建`hook`覆盖现有 Liferay 的用户注册表单。您可以使用您最喜欢的视图技术和您自己的自定义字段创建您自己的自定义用户注册表单（我的意思是，与 Liferay 的用户注册字段相比，字段数量更少）。此表单上的所有验证都将由您的代码完成，错误消息将仅由您的代码引发。只有当所有的验证都通过时，你才能调用 Liferay 的[addUser](http://docs.liferay.com/portal/6.0/javadocs/com/liferay/portal/service/UserServiceUtil.html#addUser%28long,%20boolean,%20java.lang.String,%20java.lang.String,%20boolean,%20java.lang.String,%20java.lang.String,%20long,%20java.lang.String,%20java.util.Locale,%20java.lang.String,%20java.lang.String,%20java.lang.String,%20int,%20int,%20boolean,%20int,%20int,%20int,%20java.lang.String,%20long%5B%5D,%20long%5B%5D,%20long%5B%5D,%20long%5B%5D,%20boolean,%20java.util.List,%20java.util.List,%20java.util.List,%20java.util.List,%20java.util.List,%20com.liferay.portal.service.ServiceContext%29)方法。

我只是想在下面提供一个例子。根据您的要求修改代码。

```
if(allValidationsPassThrough)
{
 long[] organizationIds = { 111L }; //Just an example. Check the Organisation ID you are using
long[] groupIds = { 222L };
long[] roleIds = { 333L };
long[] userGroupIds = (long[])null;
String screenName = yourBean.getUser(); //Just an example

UserLocalServiceUtil.addUser(//Pass the parameters to this method );
} 
```

**注意**：此方法需要许多参数。在用户注册表单中，如果您没有捕获生日（例如，），则将值作为`null`或您自己的生日传递:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T19:40:35.587

最终创建了一个钩子`create_account.jsp`并使用 ajax 对新用户的信息进行了一些验证（连同服务器端验证）。然后创建另一个挂钩 `login.jsp`（在 liferay 完成创建新用户帐户后立即执行）。

加载时`login.jsp`，liferay 会评估是否在登陆此页面之前添加了用户：

```
<c:if test='<%= SessionMessages.contains(request, "user_added") %>'> 
```

就在那里，我们为新创建的用户添加了第二轮我们自己的验证。

# asp.net-mvc-4 - ASP.NET Web.ApI 添加我不明白的东西

> ID：14078076
> 
> 赞同：1
> 
> 时间：2012-12-29T02:02:14.817
> 
> 标签：asp.net-mvc-4, asp.net-web-api

出于某种原因，我简单的 .getJSON 方法正在向我的 json 添加一些我没有得到的额外内容。我想我已经做了一个非常简单的实现。下面是 JSON 和我的 JavaScript。

这都是 k__BackingField。谁在帮我解决这个问题？

```
 [{"<CodeCampYearId>k__BackingField":7,"<Attendeesid>k__BackingField":1124,"<SessionLevel_id>k__BackingField":2,"<SponsorId>k__Ba    

$(document).ready(function () {
        // Send an AJAX request
        $.getJSON("api/session/GetAll",
        function (data) {
            // On success, 'data' contains a list of products.
            $.each(data, function (key, val) {

                //debugger;

                // Format the text to display.
                //var str = val.Name + ': $' + val.Price;
                var str = 'abcd';

                // Add a list item for the product.
                $('<li/>', { text: str })
                .appendTo($('#products'));
            });
        });
    }); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-29T09:10:26.123

您的课程可能`[Serializable]`会导致字段被序列化。您可以：

*   移除`[Serializable]`属性
*   或者要求`JSON`格式化程序忽略`[Serializable]`这一行的语义：

    ```
    (DefaultContractResolver)config.Formatters.JsonFormatter.
    SerializerSettings.ContractResolver).IgnoreSerializableAttribute = true; 
    ```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-29T16:24:18.300

就我而言，事实证明我需要添加`[DataContract]`到类和每个属性`[DataMember]`中。

优素福上面的评论提醒我这是一个序列化问题，所以谢谢。然而，该建议无法解决。

我正在使用的项目可能有一个较旧的项目`NewtonSoft serializer`，这可能会导致问题。我现在仍然拥有我的`[serializable]`属性，只要我在每个属性上包含`[DataContract]`and ，它就可以正常工作。`[DataMember]`

# java - 用JPA注解@Lob是什么类型的数据记录？

> ID：14078078
> 
> 赞同：2
> 
> 时间：2012-12-29T02:02:23.930
> 
> 标签：java, hibernate, jpa, lob

我有一个问题，当我在银行内录制PDF文件时，我最好保存为文件或字节[]？

```
@Lob @Basic(fetch=FetchType.EAGER)
@Column(name="arqdocumento")
private File arquivo; 
```

或者

```
@Lob
@Basic(fetch=FetchType.EAGER)
@Column(name="arqdocumento")
private byte[] arquivo; 
```

以及如何从数据库中获取此文件并在浏览器中显示？

我想知道为什么我这样做：

```
public File getDocumentoBinary(int iDdocumento){
   Query consulta = getSesseion().createSQLQuery("SELECT arqdocumento FROM documento WHERE iddocumento = :id");
   consulta.setInteger("id", iDdocumento);
   return  (File) consulta.uniqueResult();     } 
```

但显示此错误：

原因：org.hibernate.MappingException：没有 JDBC 类型的方言映射：-4

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T11:57:40.110

```
@Lob
@Basic(fetch=FetchType.EAGER)  
@Column(name="arqdocumento")  
private byte[] arquivo; 
```

是在数据库中存储大量数据的正确方法。您的错误表明您必须在 persistence.xml 文件中包含方言。因此，请确认您输入了正确的方言属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T03:00:32.483

使用字节数组、InputStream 或 SQL blob 类型。您不能将 blob 列映射到文件。

# .net - 修改默认 Windows 窗体对象

> ID：14078083
> 
> 赞同：0
> 
> 时间：2012-12-29T02:03:05.150
> 
> 标签：.net, winforms, progress-bar

我正在尝试编写一个组件来替换 Windows 中现有的进度条。他们是否有某种方法可以为所有应用程序修改它？我想为其添加一些功能，而不希望每个人都将我修改后的控件添加到他们的应用程序中。

是他们这样做的某种方式，最好是使用.NET。从我的角度来看，这听起来不太可能，但我仍然想知道一般情况下是否可能。我知道它必须修改一些深层的东西才能改变它。

现在，我在这里并没有过于雄心勃勃，只是默认的 Windows 进度条控件。并非所有独特的进度条组合都在那里。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T03:55:37.533

如果您的意思是在您的 OWN .NET 应用程序中修改控制，请访问：http: [//msdn.microsoft.com/en-us/library/6hws6h2t.aspx](http://msdn.microsoft.com/en-us/library/6hws6h2t.aspx)

如果您的意思是修改 Windows 本身，它就会变得棘手。但它已经完成了：

![看这里](../Images/22599a2f2b7d48d406ba0c0aeee33031.png)

[http://www.uxstyle.com/](http://www.uxstyle.com/)

使用主题选项。

# java - 使用 log4j2 实现记录器

> ID：14078087
> 
> 赞同：1
> 
> 时间：2012-12-29T02:03:41.997
> 
> 标签：java, jakarta-ee, logging, log4j

关于使用 log4j2 实现记录器，我有几个问题要问。

1.  `log4j2`还处于`beta`发布阶段吗？如果是这样，知道最终版本何时发布吗？

2.  我注意到从迁移`log4j1.2`到`log4j2`. 所以我关心的一个特殊变化是以下

    `Logger.getLogger must be modified to LogManager.getLogger`.

    因此，如果这是一个更改，那么我必须更改静态实例，例如

    `private static Logger logger = Logger.getLogger( MyClass.class )`至

    `private static Logger logger = LogManager.getLogger( MyClass.class )`正确的？

3.有没有办法编写一个自定义类`Logger.getLogger()`在每个类中调用和调用这个自定义方法进行实例化？

-山姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T14:46:55.647

1）据我所知，log4j的未来发展被放弃了。

下一个项目是**slf4j**，它是一个抽象记录器，具有默认实现 logback。

2）我不知道是否需要这个改变，因为我现在使用slf4j。

3) 为什么这样做.. 记录器对象创建只有 1 行。但有可能是的。

```
class MyLoggerFactory {
    public static Logger getLogger (Class clazz){
        return Logger.getLogger(clazz);
    }
} 
```

并调用 with`MyLoggerFactory.getLogger(this.class);`或类似的东西。我现在没有IDE。

# java - 如何在 JLabel 上“绘图”？

> ID：14078092
> 
> 赞同：0
> 
> 时间：2012-12-29T02:04:48.147
> 
> 标签：java, swing

我将做一个简单的程序，有 4 个问题，每个问题有两个选择。

我想在 JFrame 的一侧添加四个圆圈，如果用户通过单击正确的选项回答正确，第一个圆圈将是绿色，然后如果他/她在第二个问题上回答错误，第二个圆圈将是黄色，依此类推.

如何在 JLabel 中添加这些圆圈？？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T03:34:40.507

嗯...我确实建议在问此类问题之前开始学习 Swing 和 Graphics2D :)

无论如何，作为一个开始提示，我可以建议一点......

要绘制[JLabel](http://docs.oracle.com/javase/6/docs/api/javax/swing/JLabel.html)或其他摆动组件，您可以使用`paintComponent(Graphics g)`方法。请在开始之前仔细阅读文档和教程；

[这是一个简短的示例，展示了如何利用 JPanel](http://docs.oracle.com/javase/tutorial/uiswing/examples/painting/SwingPaintDemo2Project/src/painting/SwingPaintDemo2.java)，因此您可以将其作为您第一步的基础

**编辑 ：**

好的，所以你有类似的代码

```
 import java.awt.Color; 
    import java.awt.Graphics; 
    import javax.swing.JPanel; 

    public class ShapePanel extends JPanel 
    { 

    public void paintComponent (Graphics g)
    { 
    super.paintComponent(g); 
    g.setColor(Color.green); 
    g.drawOval(0,0, 20, 20); 
    g.setColor(Color.yelow); 
    g.fillOval(0, 0, 15, 15); 
} 

    } 
```

...并且您想从另一个对象中更改颜色。对于此任务，您可以创建某种可观察对象，如下所示

**>未测试**

```
 /**
     * @author user592704
     */

    class ShapePanel extends JPanel
    {

    private Color[] colors;
    private Vector<MyCircleColorActionListener> myCircleColorActionListeners=new Vector<MyCircleColorActionListener>();

    public static final int OVAL_COLOR=0;
    public static final int FILL_OVAL_COLOR=1;

        @Override
    public void paintComponent (Graphics g)
    {
        this.myPaint(g);
    }

        private void myPaint(Graphics g)
        {
            super.paintComponent(g);
            g.setColor(this.getColor()[ShapePanel.OVAL_COLOR]);
            g.drawOval(0,0, 20, 20);
            g.setColor(this.getColor()[ShapePanel.FILL_OVAL_COLOR]);
            g.fillOval(0, 0, 15, 15);
        }

        private Color[] getColor() {
            return colors;
        }

        private void setColor(Color[] colors) {
            this.colors = colors;
            this.repaint();
            this.invokeObserver();
        }

        private void invokeObserver()
        {
            for(MyCircleColorActionListener myCircleColorActionListener:this.myCircleColorActionListeners)
            {
               myCircleColorActionListener.onColorChanged();
            }
        }
        public void addMyCircleColorActionListener(MyCircleColorActionListener myCircleColorActionListener){this.myCircleColorActionListeners.add(myCircleColorActionListener);}

        private JPanel getPanel(){return this;}
    }

    public interface MyCircleColorActionListener
    {
      void onColorChanged();
    }

    /**
     * Some another object
     */
    class MyAnotherClass extends JPanel implements MyCircleColorActionListener
    {
        private ShapePanel shapePanel=new ShapePanel();
        private JButton testButton=new JButton("set red");

        MyAnotherClass()
        {
            this.setLayout(new FlowLayout());

            testButton.addMouseListener(new MouseAdapter(){

                @Override
                public void mouseClicked(MouseEvent e) {

                    Color [] colors=new Color[2];
                    colors[ShapePanel.OVAL_COLOR]=Color.green;
                    colors[ShapePanel.FILL_OVAL_COLOR]=Color.red;
                    getShapePanel().setColor(colors);
                }
            });

            this.add(testButton);
            this.shapePanel.addMyCircleColorActionListener(this);
        }

        private ShapePanel getShapePanel(){return this.shapePanel;}

        public void onColorChanged() {
            System.out.println("Color was changed");
        }

    } 
```

我还没有测试过它，虽然我想这个概念必须很清楚。

但在您尝试将其集成到您的代码之前，我建议您仔细阅读[如何在 Swing 组件中使用动作侦听](http://docs.oracle.com/javase/tutorial/uiswing/events/actionlistener.html)器以及如何使用[像观察者这样的模式](http://www.java2s.com/Code/Java/Design-Pattern/ObserverPatternExampleinJava.htm)......

如果您有其他问题，请发表评论

* * *

报告是否有帮助

# c++ - 如何在 DirectX 中标准化模型大小？

> ID：14078093
> 
> 赞同：1
> 
> 时间：2012-12-29T02:05:22.043
> 
> 标签：c++, 3d, directx, normalization, wavefront

我在 DirectX 中创建了一个简单的“引擎”，它可以从 .obj 文件加载和渲染模型。对于我创建的对象，它可以正常工作，例如，坐标在 -1.0 到 1.0 范围内的简单立方体。然而，加载一个使用不同单位并且坐标在 -2k 到 2k 范围内的模型会导致一个巨大的东西，它甚至不完全适合深度缓冲区，所以我看到一个巨大的腿或类似的效果。

我记得在某处读过它，但最近我经历了很多 DX 的东西，我不记得它在哪里或是什么。所以我的问题是，假设我希望能够加载使用不同单位的不同模型，那么确保它们都具有相似尺寸并很好地适合屏幕的最佳方法是什么？

我可以尝试在加载对象时转换值，但也许还有更多使用转换矩阵或着色器的 DirectX 方式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T03:19:56.890

最简单的方法是找出模型在哪个组件上包含最大范围，并使用该值统一缩放模型。要找到最大范围，请计算模型边界框（除非波前 obj. 文件已经提供它，但也许您还是想验证它），并使用框尺寸作为比较范围。这会将所有导入的模型缩小到单位范围。

例如，如果您有一个模型的边界框覆盖 374 * 820 * 512 个单位，那么最大的一个是 820 的 Y 轴，因此您只需将其缩小 820（将所有组件除以 820）。这可以通过统一缩放矩阵方便地实现`D3DXMatrixScaling`，如果我没记错的话，可以使用 初始化。假设边界框由 2 个向量（最大和最小顶点）给出，计算这些向量的差，然后选择最大值，并将其逆作为矩阵的缩放因子。

```
D3DMatrix mScale;
D3DVector mx, mn;
obj->getBoundingBox(&mn,&mx);
float scale = 1.0 / max(mx.x - mn.x, max(mx.y - mn.y, mx.z -mn.z));
D3DXMatrixScaling( &mScale, scale, scale,scale); 
```

剩下要做的就是在渲染管道中插入矩阵。

关于边界框的计算，应该在模型的所有顶点上进行一个简单的循环，保持最小和最大分量（彼此独立）。

```
D3DVector mn, mx;
mn.x = mn.y = mn.z = MAX_FLOAT;
mx.x = mx.y = mx.z = - MAX_FLOAT;
for (int i = 0; i < numVertices ; i++) {
   mn.x = min(mn.x, vertex[i].x);
   mn.y = min(mn.y, vertex[i].y);
   mn.z = min(mn.z, vertex[i].z);
  // same for mx using max
} 
```

当然，如果您的视图覆盖的区域比单位框大（但显然这是您正在使用的），您可能需要使用一些缩放因子。

# ruby-on-rails-3 - 在 Rails 中设定的天数后“做某事”

> ID：14078100
> 
> 赞同：1
> 
> 时间：2012-12-29T02:07:36.463
> 
> 标签：ruby-on-rails-3

说 7 天过去了，有没有办法“做某事”？我有一个`books`模型，想每 7 天创作一本新书。这甚至可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T02:10:09.577

是的，有一个很棒的工具叫做[Clockwork](http://adam.heroku.com/past/2010/6/30/replace_cron_with_clockwork/)就是为了这个目的。对于您的示例，您将编写如下内容：

```
every 7.days, 'create_book' 
```

（给定一个对应的 create_book 方法）

这是它的回购：[https ://github.com/tomykaira/clockwork](https://github.com/tomykaira/clockwork)

# image - 从 wordpress 中的所有图像中删除链接，无需触摸 functions.php

> ID：14078108
> 
> 赞同：1
> 
> 时间：2012-12-29T02:09:52.063
> 
> 标签：image, wordpress

我想从帖子中的所有图片中删除链接，因为我现在的标题中有链接。我知道如何一张一张地做，但我有数百张图片，所以这不是一个理想的选择。

我知道您可以将一些代码添加到您的 functions.php 页面，但我的主题不会让我触摸该文件。如果我这样做，它会关闭该网站。

还有其他文件我可以编辑吗？我查看了 media.php，但不知道该怎么做。

如果您需要，我的网站是[BitsyBride.com](http://BitsyBride.com)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T02:13:06.087

您的所有链接和图像都存储在数据库中，您可以使用[诸如此类](http://wordpress.org/extend/plugins/search-and-replace/)的扩展程序在 WordPress 管理面板中进行大规模搜索和替换

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T02:17:56.493

另一种 [hacky] 方法是，您可以使用在每个页面上加载的 Javascript，找到包含图像的所有链接并删除链接，并保留图像。

# ios - 为什么我的详细视图没有反映我的选择？

> ID：14078116
> 
> 赞同：0
> 
> 时间：2012-12-29T02:11:33.390
> 
> 标签：ios, xcode, ios6

我正在学习 iOS 开发并阅读 Apple 的教程（即“您的第二个 iOS 应用程序”）并构建一个 Bird Watching 应用程序。长话短说，这是一个鸟类列表，您在表格视图中选择鸟类，它会转到一个新视图，显示有关鸟类的更多详细信息。

一切似乎都正常，但是在 segueing 之后新视图没有被填充。它是空的。

我认为它可能在我的`prepareForSegue:`方法中，但是当我将 NSLog 放在那里进行测试时，它确实被解雇了。

这是`prepareForSegue:`方法：

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {
    if ([segue.identifier isEqualToString:@"DetailViewSegue"]) {
        CSBirdDetailViewController *detailViewController = segue.destinationViewController;
        CSBirdSighting *selectedBirdSighting = [self.dataController objectInListAtIndex:[self.tableView indexPathForSelectedRow].row];

        detailViewController.birdSighting = selectedBirdSighting;
        detailViewController.birdNameLabel.text = @"Stinker";
        NSLog(@"HEY THERE!");
    }
} 
```

这是整个 Xcode 项目（相当小）以获取更多信息：[http ://cl.ly/37041I2K0N24](http://cl.ly/37041I2K0N24)

我只是无法弄清楚为什么它不会显示。使用上面的方法，我从模型（主视图/源视图控制器使用的单独类）中设置destinationViewController（详细视图）的数据。我设置的数据本质上是一个 BirdSighting 对象，然后该类将读取该对象。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T02:26:06.553

尝试放置

```
[self configureView]; 
```

在您的 CSBirdDetailViewController viewDidLoad 方法而不是 prepareForSeque: 方法中

prepareForSegue: 方法太早了，无法配置视图。

视图是在第一次访问视图时创建的（延迟加载）。首次启动 CSBirdDetailViewController 时不会创建它。

# python - 如何在 Python 中使用 subprocess.check_output()？

> ID：14078117
> 
> 赞同：96
> 
> 时间：2012-12-29T02:11:40.317
> 
> 标签：python, python-3.x, python-2.x

我找到了关于 subprocess.check_output() 的文档，但是我找不到带参数的文档，而且文档不是很深入。我正在使用 Python 3（但正在尝试通过 Python 3 运行 Python 2 文件）

我正在尝试运行此命令： `python py2.py -i test.txt`

-i 是 argparse 的位置参数，test.txt 是 -i 是什么，py2.py 是要运行的文件

我尝试了很多（非工作）变体，包括： `py2output = subprocess.check_output([str('python py2.py '),'-i', 'test.txt'])`

`py2output = subprocess.check_output([str('python'),'py2.py','-i', test.txt'])`

* * *

## 回答 #1

> 赞同：95
> 
> 时间：2012-12-29T02:45:57.200

正确的答案（使用 Python 2.7 及更高版本，因为`check_output()` [是 then 引入](https://docs.python.org/2.7/library/subprocess.html#subprocess.check_output)的）是：

```
py2output = subprocess.check_output(['python','py2.py','-i', 'test.txt']) 
```

为了演示，这是我的两个程序：

py2.py：

```
import sys
print sys.argv 
```

py3.py：

```
import subprocess
py2output = subprocess.check_output(['python', 'py2.py', '-i', 'test.txt'])
print('py2 said:', py2output) 
```

运行它：

```
$ python3 py3.py
py2 said: b"['py2.py', '-i', 'test.txt']\n" 
```

以下是您的每个版本的问题：

```
py2output = subprocess.check_output([str('python py2.py '),'-i', 'test.txt']) 
```

首先，`str('python py2.py')`与您`'python py2.py'`正在接受 a`str`并调用`str`将其转换为`str`. 这使得代码更难阅读，更长，甚至更慢，而没有增加任何好处。

更严重的是，`python py2.py`不能是单个参数，除非您实际上是在尝试运行一个名为`/usr/bin/python\ py2.py`. 你不是；例如，您正在尝试`/usr/bin/python`使用第一个参数运行`py2.py`。因此，您需要使它们在列表中成为单独的元素。

您的第二个版本解决了这个问题，但是您缺少`'`之前的`test.txt'`. 这应该给你一个`SyntaxError`，大概的说法`EOL while scanning string literal`。

同时，我不确定您是如何找到文档的，但找不到任何带有参数的示例。第一个例子是：

```
>>> subprocess.check_output(["echo", "Hello World!"])
b'Hello World!\n' 
```

这会调用`"echo"`带有附加参数的命令，`"Hello World!"`.

还：

> -i 是 argparse 的位置参数，test.txt 就是 -i

我很确定*不是*`-i`位置参数，而是可选参数。否则，句子的后半部分毫无意义。

 ** * *

## 回答 #2

> 赞同：31
> 
> 时间：2019-04-19T08:23:59.257

**从 Python 3.5 开始，** [建议使用](https://docs.python.org/3/library/subprocess.html#using-the-subprocess-module)[`subprocess.run`](https://docs.python.org/3/library/subprocess.html#subprocess.run)，而不是：[`subprocess.check_output`](https://docs.python.org/3/library/subprocess.html#older-high-level-api)

```
>>> subprocess.run(['cat','/tmp/text.txt'], check=True, stdout=subprocess.PIPE).stdout
b'First line\nSecond line\n' 
```

**从 Python 3.7**开始，您可以使用`capture_output=true`参数来捕获 stdout 和 stderr，而不是上面的：

```
>>> subprocess.run(['cat','/tmp/text.txt'], check=True, capture_output=True).stdout
b'First line\nSecond line\n' 
```

此外，您可能希望使用`universal_newlines=True`Python 3.7 之后的等价物`text=True`来处理文本而不是二进制文件：

```
>>> stdout = subprocess.run(['cat', '/tmp/text.txt'], check=True, capture_output=True, text=True).stdout
>>> print(stdout)
First line
Second line 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2015-10-30T06:17:14.043

添加到@abarnert 提到的那个

更好的方法是捕获异常

```
import subprocess
try:
    py2output = subprocess.check_output(['python', 'py2.py', '-i', 'test.txt'],stderr= subprocess.STDOUT)  
    #print('py2 said:', py2output)
    print "here"
except subprocess.CalledProcessError as e:
    print "Calledprocerr" 
```

这个**stderr=** subprocess.STDOUT 是为了确保你不会在 stderr 中得到 filenotfound 错误-通常不能在 filenotfoundexception 中捕获，否则你最终会得到

```
python: can't open file 'py2.py': [Errno 2] No such file or directory 
```

事实上，更好的解决方案可能是检查文件/脚本是否存在，然后运行文件/脚本*

# mysql - 多租户数据库模式：处理租户需要共享数据的情况

> ID：14078118
> 
> 赞同：1
> 
> 时间：2012-12-29T02:11:45.070
> 
> 标签：mysql, database, schema, multi-tenant

我正在尝试为将由多个租户使用的新 Web 应用程序创建模式。我过去做过多租户设计，每个租户使用一个模式，但在这个新应用程序中，租户将需要能够广泛共享对数据的访问。

这是我使用伪应用程序的场景：

*   A 公司注册“Project Tracker”以跟踪他们的软件项目
*   B 公司也签约跟踪他们的软件项目
*   A 公司在 Project Tracker 中创建了一个包含大量工作项的新项目
*   然后，A 公司将其中一些工作项分配给 B 公司中将实际执行工作的用户（例如使用承包商方案）

而且我还需要支持另一个皱纹：

*   新软件项目的客户也需要能够登录并查看项目状态，即使他们在技术上不是租户

我意识到我可以使用单独的模式和联合用户来做到这一点，但如果可能的话，我试图让体验比这更简单。由于它是一个网络应用程序，我想使用电子邮件地址作为联合点，以便公司 A 可以将工作项分配给 joe@companyb.com，并且当乔使用该电子邮件地址登录时，他能够看到工作项并且可以在完成时将其标记为已完成。

所以我目前的想法是使用基于行的多租户方法和基于对象的安全性。每个对象都有一组与之关联的角色（例如管理员、读者、作家），并且这些角色将与用户相关联。然后，我将使用这些来验证每个对象的权限，而不是使用类似`tenant_id`.

这意味着如果有人向他们提供访问权限，任何人都可以潜在地访问系统中的任何对象。成为租户实际上只是让您成为权限层次结构的根部的管理员（在示例中，这是允许您创建项目实体的公司实体的管理员）。这意味着这不再是真正的多租户架构......

有没有更好的方法来处理这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-28T17:19:06.223

您可以使用用户 - 角色 - 租户类型的映射以及相应表中的租户 ID 列。因此，当 joe@companyb.com 尝试访问 companyA 记录时，您可以检查在 companyA 中是否存在 joe@companyb.com 的角色，该角色提供对 companyA 数据的访问权限。从长远来看，这种方式更加安全可靠。

# android - Android 相当于 Apple 的 b2b 程序吗？

> ID：14078121
> 
> 赞同：23
> 
> 时间：2012-12-29T02:11:54.087
> 
> 标签：android, b2b

以下是提出这个问题的其他几种方式：Android 与 Apple 的 vpp（批量购买计划）的等价物是什么？Google Play 相当于 Apple 的 vpp（批量购买计划）是什么？

现在我正在使用 Apple 的 b2b 程序分发应用程序，该程序允许我限制谁可以下载应用程序。我为用户提供了一个唯一的 URL，他们可以从该 URL 下载我的应用程序的一份副本。

我想使用 Google Play 做同样的事情。

我想使用 Google Play 分发而不是从我的网站下载，因为我不想让用户为更改他们的设置以允许从未知来源下载而烦恼。

Google 有一个叫做“私人频道”的东西[http://support.google.com/a/bin/answer.py?hl=en&answer=2494992](http://support.google.com/a/bin/answer.py?hl=en&answer=2494992)。从阅读文档来看，该程序似乎是针对控制其用户电子邮件地址的公司。

我需要将下载代码分发给拥有我无法控制的现有帐户的用户。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-05-03T20:52:09.227

我需要针对新应用重新审视这个问题：我与 Google 进行了交谈：使用 Beta 程序执行此操作并不违反他们的规则。也就是说：我可以列出将在 Beta 版程序中访问该应用程序的所有电子邮件地址，创建一个链接，如果有人拥有该链接，他们可以下载该应用程序，或者创建一个该组中的任何人都可以访问的 google 组应用程序。

对于我的用例，我将使用 google 组，以便其他人可以管理该组的成员。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-26T09:23:18.423

您是否使用了 b2b 渠道来满足您的需求？我也有同样的问题。Private Channel 看起来是为内部分发而不是 b2b 设计的。

对于 b2b 来说，有什么可以阻止开发人员将 apk 出售给组织并一起错过 Google Play 吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-25T19:28:34.183

您可以使用 Google 的播放私人频道将 android 应用程序部署到企业

有关部署私有 android 应用程序的分步指南和更多详细信息在[这里](http://www.techrepublic.com/blog/google-in-the-enterprise/deploy-private-android-apps-on-google-play/1898/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-26T16:51:51.167

由于 Android 没有类似 Apple 的限制，您就不能将品牌应用程序与您的应用程序一起发布到 Android 市场吗？

# constructor - ImageElement 的构造函数

> ID：14078122
> 
> 赞同：1
> 
> 时间：2012-12-29T02:11:55.203
> 
> 标签：constructor, dart

我是 Dart 的新人。当我创建一个新的图像元素时，我使用：

```
ImageElement elem = new ImageElement("src",10,10); //comlier error, extra-argument.
ImageElement elem = new ImageElement(src:"src",width:10,height:10); //OK. 
```

谁能解释一下为什么我们必须使用第二种语法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T03:01:29.877

他们转而使用命名参数来提高可读性。看第一行，你不知道哪个是宽度，哪个是高度。第二个更具可读性。要了解有关更改的更多信息，请参阅[https://groups.google.com/a/dartlang.org/forum/?fromgroups=#!topic/misc/GW2n-l1XPh0](https://groups.google.com/a/dartlang.org/forum/?fromgroups=#!topic/misc/GW2n-l1XPh0)。如果您不同意更改，请参阅[http://code.google.com/p/dart/issues/detail?id=6496](http://code.google.com/p/dart/issues/detail?id=6496)。

# php - 找不到phpsh

> ID：14078126
> 
> 赞同：1
> 
> 时间：2012-12-29T02:12:41.530
> 
> 标签：php, macos, phpsh

升级到山狮后，我遇到了 phpsh 问题

我用 php-osx 安装了 php5.4，并让它和 mysql 一起玩得很好。

因此，当我按照说明安装 phpsh 并获得`phpsh not found`ZSH shell 时，这没有任何意义吗？我在升级之前运行它。

还是`php -a`什么都不做，只是挂了？

我对python一无所知，但是当我运行python时，我得到了这个：

```
/usr/local/bin/python
/usr/bin/python
/usr/local/bin/python 
```

我知道这很拗口，但有人可以帮忙吗？

干杯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T14:41:36.087

我通过添加 sudo chown -R "whoami" /usr/local 来修复它

# c# - 如何使用文件夹读取事件日志？

> ID：14078127
> 
> 赞同：4
> 
> 时间：2012-12-29T02:13:04.827
> 
> 标签：c#, windows-8, system.diagnostics

我想以编程方式获取出现在 eventvwr 文件夹中的事件日志。这个适用于 Windows 8 应用程序：Microsoft-Windows-AppHost/Admin。我以管理员身份运行。

这不起作用：

```
System.Diagnostics.EventLog.SourceExists("Microsoft-Windows-AppHost/Admin"); 
```

这也不起作用：

```
EventLogQuery queryMicrosoftWindowsAppHost = new EventLogQuery("Microsoft-Windows-AppHost/Admin", PathType.LogName);
_eventsMicrosoftWindowsAppHost = new List<EventRecordWrittenEventArgs>();
_eventLogWatcherMicrosoftWindowsAppHost = new EventLogWatcher(queryMicrosoftWindowsAppHost);
_eventLogWatcherMicrosoftWindowsAppHost.EventRecordWritten += (object sender, EventRecordWrittenEventArgs e) =>
{
    _eventsMicrosoftWindowsAppHost.Add(e);
};
_eventLogWatcherMicrosoftWindowsAppHost.Enabled = true; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T17:34:38.343

您可以使用以下代码阅读事件日志：

```
EventLogReader reader = new EventLogReader("Microsoft-Windows-AppHost/Admin");
var evt = reader.ReadEvent();
while (evt!= null)
{
    // Write the message to the console
    Console.WriteLine(evt.FormatDescription());
    evt = reader.ReadEvent();
} 
```

如果你想附加你的处理程序，你的代码很接近，但你可以简单地将字符串传递给观察者，而不是使用查询对象：

```
var watcher = new EventLogWatcher("Microsoft-Windows-AppHost/Admin");
watcher.EventRecordWritten += (object s, EventRecordWrittenEventArgs e1) =>
    {
        Console.WriteLine(e1.EventRecord.FormatDescription());
    };
watcher.Enabled = true; 
```

# multithreading - Qt：QObject 移动到不同线程后，信号/插槽不起作用

> ID：14078132
> 
> 赞同：1
> 
> 时间：2012-12-29T02:14:58.100
> 
> 标签：multithreading, qt, signals-slots, qthread, qt5

我正在使用 Qt5，我通过 moveToThread() 将 QObject 工作线程传递给 QThread 的实例来实现线程。我的实现看起来像这样..

**工人.h**

```
class worker : public QObject
{
    Q_OBJECT
public:
    explicit worker(QObject *parent = 0);
    bool IsWorkRunning();
    void MoveObjectToThread();

signal:
    void SignalToObj_mainThreadGUI();

public slots:
    void do_Work();
    void StopWork();
    void StartWork();

private:
    void Sleep();
    QThread *workerthread;    
    volatile bool running,stopped;
}; 
```

**工人.cpp**

```
 worker::worker(QObject *parent) :
    QObject(parent),stopped(false),running(false)
{
}

void worker::do_Work()
{
    running = true;
    while(!stopped)
    {
       if(running)
       {
        emit SignalToObj_mainThreadGUI();
        workerthread->msleep(20);
       }
    }
}

void worker::StopWork()
{
    running = false;
}

void worker::StartWork()
{
    running = true;
}

bool worker::IsWorkRunning()
{
    return running;
}

void MoveObjectToThread()
{
  workerthread = new QThread;
  QObject::connect(workerthread,SIGNAL(started()),this,SLOT(do_Work()));

  this->moveToThread(workerthread);

  workerthread->start();
} 
```

**主窗口.h**

```
namespace Ui {
class MainWindow;
}

class MainWindow : public QMainWindow
{
    Q_OBJECT

public:
    explicit MainWindow(QWidget *parent = 0);
    ~MainWindow();

signals:
    void Startwork_mainwindow();
    void Stopwork_mainwindow();

public slots:

private slots:
    void on_pushButton_push_to_start_clicked();

    void on_pushButton_push_to_stop_clicked();

private:

    Ui::MainWindow *ui;
    worker myWorker;
    bool work_started;

}; 
```

**主窗口.cpp**

```
MainWindow::MainWindow(QWidget *parent) :
    QMainWindow(parent),work_started(false),
    ui(new Ui::MainWindow)
{
    ui->setupUi(this);

    QObject::connect(this,SIGNAL(Startwork_mainwindow()),&myWorker,SLOT(StartWork()));
    QObject::connect(this,SIGNAL(Stopwork_mainwindow()),&myWorker,SLOT(StopWork()));
}

MainWindow::~MainWindow()
{
    delete ui;
}

void MainWindow::on_pushButton_push_to_start_clicked()
{
    if(!work_started)
    {
      myWorker.MoveObjectToThread();
      work_started = true;
    }

    if(!myWorker.IsWorkRunning())
       emit this->Startwork_mainwindow();
}

void MainWindow::on_pushButton_push_to_stop_clicked()
{
  if(myWorker.IsWorkRunning())
       emit this->Stopwork_mainwindow();
} 
```

不知道为什么以下两个信号/插槽对似乎不起作用

```
QObject::connect(this,SIGNAL(Startwork_mainwindow()),&myWorker,SLOT(StartWork()));
QObject::connect(this,SIGNAL(Stopwork_mainwindow()),&myWorker,SLOT(StopWork())); 
```

因此，一旦`do_Work()`插槽被`started()`QThread 对象的信号触发，我就无法启动或停止线程。仅供参考，我的这篇文章是我之前在[这里描述](https://stackoverflow.com/questions/14051276/how-to-implement-frequent-start-stop-of-a-thread-qthread)的文章的延续。任何见解都会有所帮助......谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T04:09:17.823

在您的`MainWindow`类定义中，尝试更改`worker myWorker`为`worker * myWorker`. 另外，我会按照其他人的建议将线程移到`worker`课堂之外。构造`MainWindow`函数变成这样：

```
MainWindow::MainWindow(QWidget *parent)
  : QMainWindow(parent)
  , work_started(false)
  , ui(new Ui::MainWindow)
  , myWorker( new worker() )
{
  // NOTE:  myWorker is created without a parent on purpose.
  // Qt won't change the thread affinity of an obj with a parent

  ui->setupUi(this);

  connect( this, SIGNAL(Startwork_mainwindow()), myWorker, SLOT(StartWork()) );
  connect( this, SIGNAL(Stopwork_mainwindow()), myWorker, SLOT(StopWork()) );

  QThread * thread = new QThread();
  // delete the worker obj whenever this obj is destroyed
  connect( this, SIGNAL(destroyed()), myWorker, SLOT(deleteLater()) );
  // stop the thread whenever the worker is destroyed
  connect( myWorker, SIGNAL(destroyed()), thread, SLOT(quit()) );
  // clean up the thread
  connect( thread, SIGNAL(finished()), thread, SLOT(deleteLater()) );
  myWorker->moveToThread( thread );
  thread->start();
} 
```

当然，您不再需要该`worker::MoveObjectToThread()`方法。此外，`worker::IsWorkRunning()`从`MainWindow`. 这个具体的例子你可能不会遇到任何麻烦，但是当事情变得更复杂时，它肯定会让你感到痛苦。相反，添加一个信号或类似的东西，并在课堂上`workFinished()`聆听它。`MainWindow`

信号将`Startwork_mainwindow()`开始工作。由于您没有在对 的调用中提供连接类型`connect`，因此 Qt 将`QueuedConnection`在您更改线程关联 ( `moveToThread`) 时使用。基本上，`myWorker`是在一个有自己的事件循环的线程中。`Qt::QueuedConnection`使用将事件发布到该事件循环来调用插槽，然后该事件循环将插槽方法排队。只要事件循环到达它，它就会运行。

# modx - 致命错误：调用成员函数 getSource()

> ID：14078133
> 
> 赞同：0
> 
> 时间：2012-12-29T02:15:05.597
> 
> 标签：modx, modx-revolution

我刚刚建立了一个新的 MODX 站点，并安装了 MIGX。我创建了五台电视和包含 MIGX 电视，并且能够在相关模板上创建项目。

但是，当我在前端查看它们时，出现此错误：

```
Fatal error: Call to a member function getSource() on a non-object in /home/test/public_html/core/cache/includes/elements/modsnippet/1.include.cache.php on line 122 
```

这是模板上的代码：

```
[[!getImageList?
  &tvname='projectMIGX'
  &tpl='tplProjectList']] 
```

这是 tplProjectList 代码：

```
<div class="projectListItemImage">[[+projectImage]]</div>
<div class="projectListItemTitle">[[+projectTitle]]</div>
<div class="projectListItemLocation">[[+projectLocation]]</div>
<div class="projectListItemDescription">[[+projectDescription]]</div>
<div class="projectListItemStats">[[+projectFundedPercent]]% Funded | $[[+projectFundedAmount]] Pledged</div> 
```

我最初的想法是这是由我网站上的 MODX/MIGX 配置问题引起的，但我不知道是什么。

任何想法为什么会发生这种情况？我可以提供任何其他相关信息吗？

谢谢，克里斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T09:09:14.640

好的，显然你必须使用 TILDE```字符。我以为他们是单引号，我真傻。

无论如何，在将它们更改为波浪号后，代码就可以工作了。希望这对以后的某些人有所帮助！

# java - 为什么使用Handler时可能会发生内存泄漏

> ID：14078136
> 
> 赞同：1
> 
> 时间：2012-12-29T02:15:39.453
> 
> 标签：java, android, memory-leaks, android-handler

如果我们使用非静态 Handler 会有一个警告：'handler 应该是静态的，否则容易出现内存泄漏。

我已阅读以下链接，并且知道它们的含义。

[https://stackoverflow.com/a/7909437/619424](https://stackoverflow.com/a/7909437/619424)
[https://stackoverflow.com/a/11336822/619424](https://stackoverflow.com/a/11336822/619424)

但是在阅读了[Handler.java](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.1.1_r1/android/os/Handler.java/)、[Message.java](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.1.1_r1/android/os/Message.java/)和[Looper.java](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.1.1_r1/android/os/Looper.java/)的来源之后，我很困惑......

在[Looper.loop()](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.1.1_r1/android/os/Looper.java#Looper.loop%28%29)方法中，我们可以看到以下语句：

```
msg.target.dispatchMessage(msg);

...

msg.recycle(); 
```

该变量`msg`包含一个名为`target`对应的引用`Handler`。当 Message 被`Looper`,`msg`调度到`Handler`( `target`reference) 时，msg 被回收。

[Message.recycle()](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.1.1_r1/android/os/Message.java#Message.recycle%28%29)方法调用[Message.clearForRecycle()](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.1.1_r1/android/os/Message.java#Message.clearForRecycle%28%29)方法，我们看到：

```
...

target = null;

... 
```

`target`设置为`null`，这意味着，`Message`不包含对 的引用`Handler`。非静态`Handler`将被 GC，`Activity`和`View`s 都将被 GC。

所以我的问题是，为什么会发生内存泄漏？

# android - Android MediaPlayer 没有播放声音，但没有抛出任何错误

> ID：14078137
> 
> 赞同：0
> 
> 时间：2012-12-29T02:15:43.937
> 
> 标签：android, media-player, android-mediaplayer

我已经查看了这个问题变体的所有建议答案，但没有一个有帮助。我的应用程序应该教摩尔斯电码。唯一不工作的部分是 Player.java 文件，它应该采用莫尔斯“字母”对象，读取其代码，并播放一系列音调（以 .mp3 格式存储在 res.raw 文件夹中）。这段代码的相关位是 playSound(int pfile, Context pcontext) 函数。这里是：

```
package com.ewg.morseCode;
import java.io.IOException;

import com.ewg.morseCode.morse_alphabet.letter;

import android.app.Activity;
import android.content.Context;
import android.media.MediaPlayer;

public class Player extends Activity{
public static boolean finished = false;
public static class player{
    public int dit;
    public int dah;
    public player(){
        this.dit = R.raw.morse_dit;
        this.dah = R.raw.morse_dah;
    }
    //////PERTINENT BIT//////
    private void playSound(int pfile, Context pcontext){

        final int file = pfile;
        final Context context = pcontext;
        MediaPlayer mp =MediaPlayer.create(context, file);
        mp.start();
        while(mp.isPlaying()){

        }
        mp.reset();
        mp.release();
        mp = null;
    }
    //////END PERTINENT BIT//////
    public void pause(int dur){
        finished = false;
        CountDownTimer timer1 = new CountDownTimer(dur, dur){
            public void onTick(long blah){

            }
            public void onFinish(){
                finished = true;
            }
    }.start();
    while(finished = false){

    }
    }
    public void play(letter x, Context context) throws Exception{

        Exception e = new Exception();
        for(int i = 0; i< x.code.length-1; i++){
            switch(x.code[i]){
            case 0:
                playSound(dit, context);
                pause(49);
                break;
            case 1:
                playSound(dah, context);
                pause(49);
                break;
            default:
                throw(e);
            }
        }
    }
}
} 
```

对不起，任何糟糕的编码，我仍然只是一个脚本小子。

*编辑这是调用播放器类的代码，@Geobits*

```
 player player = new player();
    letter Letter = morse_alphabet.hardLetters.get(0);//Letter has a String name property of "b" and a int[] code property of {1, 0, 0, 0}
    try {
    player.play(Letter, context);//context =main_activity.this
    } catch (Exception e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T04:33:46.863

首先，我会支持您应该使用 OnCompletionListener 来释放您的播放器或至少在您的活动 onPause 中执行此操作的所有建议。

有一次我的程序启动了几个播放器并且没有发布（泄露），所以当我再次尝试运行时它无法创建新播放器。我不确定它是否对你来说是一样的，但是手机**重启**解决了我的问题，我的代码没有任何变化（我试图杀死我的应用程序和其他服务，但它没有帮助）。

重要的旁注：

*   您不需要提前创建异常对象，因为这很浪费内存。抛出异常时只需创建异常对象。

例如

```
 throw(new Exception("Unsupported command")); // Also you should provide a descriptive message 
```

您的代码中还有一个错误

```
 while(finished = false) // it should be == 
```

或者更好，你应该使用

```
 while(!finished) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T02:26:11.387

尝试像这样更改您的 playSound 功能，不要忘记打开音量

```
private void playSound(int pfile, Context pcontext){

    final int file = pfile;
    final Context context = pcontext;
    MediaPlayer mp = MediaPlayer.create(context, file);
    mp.start();
    mp.setOnCompletionListener(new OnCompletionListener() {

        public void onCompletion(MediaPlayer mp) {
            // TODO Auto-generated method stub
            mp.release();
        }

    });
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T02:26:31.590

您可能应该使用 an`OnCompletionListener`而不是空的 while 循环。它可能无法解决您的问题，但肯定不会受到伤害，并且是更正确的方法。

```
//////PERTINENT BIT//////
private void playSound(int pfile, Context pcontext)
{

    final int file = pfile;
    final Context context = pcontext;
    MediaPlayer mp =MediaPlayer.create(context, file);
    mp.start();
    mp.setOnCompletionListener(this);
}

public void onCompletion(MediaPlayer mp)
{
    mp.release();
}

//////END PERTINENT BIT////// 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-10-05T13:02:38.133

一个糟糕的解决方案，......但有用的解决方案

```
MediaPlayer mp = MediaPlayer.create(context, file);
//write these after
mp.start();
mp.pause(); 
```

# jquery - 如何使子导航消失而其他子导航在悬停时显示

> ID：14078140
> 
> 赞同：0
> 
> 时间：2012-12-29T02:16:36.993
> 
> 标签：jquery, css, menu

我设置了这个主导航：

```
<ul class="menu12">
<li><a href="/">Home</a></li>
<li><a href="/">About</a>
    <ul>
        <li><a href="/">History</a></li>
        <li><a href="/">Team</a></li>
        <li><a href="/">Offices</a></li>
    </ul>
</li>
<li><a href="/">Services</a>
    <ul>
        <li><a href="/">Web Design</a></li>
        <li><a href="/">Internet</a></li>
        <li><a href="/">testing &gt;</a>
            <ul>
                <li><a href="/">test 1</a></li>
                <li class="selected"><a href="/">test 2</a></li>
                <li><a href="/">test 3</a></li>
                <li><a href="/">testing &gt;</a>
                    <ul>
                        <li><a href="/">test 1</a></li>
                        <li><a href="/">test 2</a></li>
                        <li><a href="/">test 3</a></li>
                        <li><a href="/">test 4</a></li>
                        <li><a href="/">test 5</a></li>
                    </ul>
                </li>
                <li><a href="/">test 4</a></li>
                <li><a href="/">test 5</a></li>
            </ul>
        </li>
        <li><a href="/">Hosting</a></li>
        <li><a href="/">Domain Names</a></li>
        <li><a href="/">Broadband</a></li>
    </ul>
</li>
<li><a href="/">Contact Us</a>
    <ul>
        <li><a href="/">U K</a></li>
        <li><a href="/">France</a></li>
        <li><a href="/">USA</a></li>
        <li><a href="/">Australia</a></li>
    </ul>
</li>
 </ul> 
```

[http://jsfiddle.net/williamdickson/GK8eS/](http://jsfiddle.net/williamdickson/GK8eS/)

因此，该示例是项目“测试 2”的登录页面。当您将鼠标悬停在“关于”或“联系我们”等任何其他主要项目时，它们的子项目会覆盖在当前项目之上。

我想要的是，当您将鼠标悬停在其他“未选择”类项目上时，它们的子项目会显示出来，而当前的“选定”项目将消失。就像它在这里的工作方式一样：http: [//jsfiddle.net/williamdickson/2n4hR/](http://jsfiddle.net/williamdickson/2n4hR/)

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T02:47:20.910

因为您已经在使用 jQuery，所以您需要做的就是删除`.selected` .hover() 事件中出现的任何 。将您的 jquery 代码更改为第一个小提琴：

```
$(document).ready(function() {
    $('li').hover(function() {
        $('li').removeClass('selected');
        $(this).parent('li').addClass('selected');
    });
    $('li.selected').parents('li').addClass("selected");
});
​ 
```

请注意，尽管这可以满足您的要求，但是一旦您将鼠标悬停在某物上，它将移除当前所选页面的初始红色高光。我建议使用不同的类来更改文本颜色。

# c# - 运行测试并在最后添加 char 或删除的成本？

> ID：14078144
> 
> 赞同：0
> 
> 时间：2012-12-29T02:17:28.677
> 
> 标签：c#, arrays, string

从数据表之类的东西连接字符串时，最快/最少的资源成本移动是什么？例如：

```
 for (int i = 0; i < darray.Length; i++)
            {
                str_orderbycity += darray[i]["Sort_Order"].ToString() + ",";
                if (i < (darray.Length - 1))
                {
                    str_orderbycity += ",";
                }
            } 
```

或等到最后，然后在字符串上运行 remove 方法：

```
 str_orderbycity = str_orderbycity.Remove(str_orderbycity.Length - 1, 1); 
```

我只是好奇...

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T02:25:24.473

一个`StringBuilder`对象，确定吗？

例如

```
 StringBuilder sb = new StringBuilder();
        for (int i = 0; i < darray.Length; i++)
        {
            sb.Append(darray[i]["Sort_Order"].ToString());
            sb.Append(",");
        }

        if (darray.Length > 0)
            sb.Remove(sb.Length - 1, 1); 
```

它的唯一功能是构建字符串。请参见[StringBuilder](http://msdn.microsoft.com/en-us/library/system.text.stringbuilder%28v=vs.110%29.aspx)

而且，我相信，最好在循环后测试一次，然后删除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T04:47:08.550

当您使用连接时，例如

```
str_orderbycity += ","; 
```

[创建一个新字符串（如果字符串实习生池中](http://brainspeex.wordpress.com/2011/10/30/string-pooling-in-net-c/)尚不存在）。

[StringBuffer](http://msdn.microsoft.com/en-us/library/system.text.stringbuilder.aspx)通过只使用维护来避免那些中间字符串`char array`。

`StringBuffer`有它的成本/开销，所以它并不总是比`String`串联有效。

从[字符串生成器性能考虑 - MSDN](http://msdn.microsoft.com/en-us/library/system.text.stringbuilder.aspx)

> String 或 StringBuilder 对象的串联操作的性能取决于内存分配的频率。
> String 连接操作总是分配内存，而 StringBuilder 连接操作仅在 StringBuilder 对象缓冲区太小而无法容纳新数据时才分配内存。
> 如果要连接固定数量的 String 对象，请使用 String 类。在这种情况下，编译器甚至可以将单独的串联操作组合成一个操作。
> 如果要连接任意数量的字符串，请使用 StringBuilder 对象；例如，如果您使用循环连接随机数量的用户输入字符串。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T05:48:17.483

使用字符串。加入：

string myStr = string.Join(",", myArray.Select(n => n.ToString()).ToArray())

搜索将数组转换为 csv 以获取更多信息。

# mysql - 使用 SQL 在 Spree 中通过多选方面进行搜索

> ID：14078146
> 
> 赞同：0
> 
> 时间：2012-12-29T02:18:10.503
> 
> 标签：mysql, search, e-commerce, spree, facet

我想使用构面按属性过滤产品，或者换句话说，一次跨多个属性选择多个值。

我决定手动构建查询，但是下面的 SQL 产生的结果比我预期的要少。如何更改它以包含所有产品？

```
SELECT COUNT(DISTINCT "spree_products"."id") FROM "spree_products" 
  LEFT OUTER JOIN "spree_product_properties" ON "spree_product_properties"."product_id" = "spree_products"."id" 
  WHERE 
    ("spree_product_properties"."value" in ('lacoste', 'fred perry') AND "spree_product_properties"."property_id" = 161337574) 
    AND 
    ("spree_product_properties"."value" in ('socks', 'shirts') AND "spree_product_properties"."property_id" = 905834903) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-08-05T02:11:57.800

在为分析项目使用 spree 框架时，我使用[Looker](http://www.looker.com)中现有的 LookML 模板。这样我就不用编写手动查询，并且 Looker 知道它生成查询的架构。

[我的 spree 模板](https://github.com/segahm/templates)涵盖了基本的 spree 安装。

如果您计划将 Spree 与其他 3rd 方工具集成，那么您只需要扩展模型。

# haskell - 模板元编程的 Haskell 变体

> ID：14078151
> 
> 赞同：4
> 
> 时间：2012-12-29T02:20:00.793
> 
> 标签：haskell, template-haskell

我是 Haskell 的新手。鉴于 Haskell 的整个前提是函数将始终返回相同的值，我希望有一些方法可以在编译时计算常量的斐波那契值，就像我可以在 C++ 中使用模板元编程一样，但我可以不知道怎么做。有办法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-29T08:44:34.227

编辑：Daniel Fischer 指出，您可以将普通表达式提升到 Template Haskell 并在编译时评估结果，但要受到输出类型的某些约束，方法是使用普通函数`fib`然后拼接

```
$(let x = fib 1000 in [|x|]) 
```

原始答案如下。

正如评论中所指出的，Template Haskell 是解决这个问题的方法。对于像斐波那契这样的归纳函数，它相当简单。您编写类似于标准定义的代码，但返回一个 ExpQ 值。由于拼接限制，您需要使用 2 个模块。

```
{-# LANGUAGE TemplateHaskell #-} 
module TH where

import Language.Haskell.TH

fibTH :: Int -> ExpQ
fibTH 0 = [| 0 |]
fibTH 1 = [| 1 |]
fibTH n = [| $(fibTH (n-1)) + $(fibTH (n-2)) |] 
```

和

```
{-# LANGUAGE TemplateHaskell #-}
module Main where

import TH

y :: Int
y = $(fibTH 10)

main = print y 
```

要确认工作是在编译时执行的，我们可以编译`-ddump-simpl`以查看内核，这可以确认。

```
Main.y :: GHC.Types.Int
[GblId,
 Caf=NoCafRefs,
 Str=DmdType m,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Arity=0, Value=True,
         ConLike=True, WorkFree=False, Expandable=True,
         Guidance=IF_ARGS [] 10 20}]
Main.y = GHC.Types.I# 55 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-29T02:39:57.460

Don Stewart有一篇[很棒的文章](http://donsbot.wordpress.com/2010/03/01/evolving-faster-haskell-programs-now-with-llvm/)，他在其中展示了使用带有正确选择标志的 LLVM 后端将在编译时预先计算某些函数并用常量替换它们。

# iphone - 在 UIButton 中显示图像的一部分

> ID：14078152
> 
> 赞同：0
> 
> 时间：2012-12-29T02:20:10.517
> 
> 标签：iphone, objective-c, image, uibutton

> **可能重复：**
> [使用部分图像文件创建 UIImageView](https://stackoverflow.com/questions/1049102/create-uiimageview-with-portion-of-image-file)

我已经设置了一系列大约 30px x 30px 的按钮。我有一个大小为 300 像素 x 300 像素的图像。

当我将图像设置为图像或背景图像时，图像会自动调整大小以适合按钮。我真正想做的是显示图像的 30 x 30 部分。

我已经尝试了几种方法来做到这一点，但它们似乎没有结果。我尝试过骑 -(void)layoutSubviews 但这会导致图像大于按钮本身并导致其他奇怪的行为。

我也尝试过修改图像视图属性，但这也不起作用。

最后，我尝试使用 imageEdgeInsets 但这又具有类似的覆盖 layoutSubviews 的行为。

我想这样做，因为我有许多按钮可以构成全图，但这些按钮会移动。另一种方法是将图像拆分为绘画样式包，但从长远来看，这将导致额外的工作，并且更愿意以编程方式执行此操作。任何有关如何进行的指导将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T02:51:39.120

发布问题后，我进一步调查并遇到以下问题。

这方面的某些方面与位于[create UIImageView with part of image file的问题非常相似](https://stackoverflow.com/questions/1049102/create-uiimageview-with-portion-of-image-file)

```
 UIImage* img = [UIImage imageNamed:currentImage];
    CGRect imgFrame = CGRectMake(x, y, 30, 30);
    CGImageRef imageRef = CGImageCreateWithImageInRect([img CGImage], imgFrame);
    UIImage* subImage = [UIImage imageWithCGImage: imageRef];
    [imageButton setBackgroundImage:subImage forState:UIControlStateNormal]; 
```

一旦完成， subImage 可以简单地添加为 uibutton 的图像，例如：-

```
 [imageButton setBackgroundImage:subImage forState:UIControlStateNormal]; 
```

# javascript - JavaScript 中的作用域链和 [[Scope]]

> ID：14078153
> 
> 赞同：1
> 
> 时间：2012-12-29T02:20:43.857
> 
> 标签：javascript

```
var currentScope = 0;
(function(){
    var currentScope = 1, one= 'scope1';
    alert(currentScope);
  (function(){
    var currentScope = 2, two= 'scope2';
    alert(currentScope);
    alert(one + two);
  })();
})(); 
```

现在，当我在 jsbin 中执行此代码时，我会收到警报`1 then 2`，然后`scope 1 and scope 2`. 但我开始知道在 中`ExecutionContext`，它实际上会首先调用内部函数，然后查找`outer variable`then 等等。

1.  谁能告诉我`ExecutionContext Object`在我的功能环境中会是什么样子。
2.  如果我错了，请纠正我，在浏览器中它会首先显示 currentScope 1，然后是 CurrentScope 2。但实际上在解释器的幕后，反之亦然。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T02:48:52.083

您案例中的代码以正确的顺序提醒值。我相信您对将函数声明提升到堆栈顶部感到困惑，因此甚至在它们实际出现在代码中之前就可以调用它们。但是在您的情况下，它们是匿名的立即执行函数表达式，而不是函数声明。函数表达式在原地求值（像任何其他函数代码一样解释），而不是事先提升或使其可用 - 因此将按照它们在代码中出现的顺序执行。

我希望下面的例子能进一步阐明它。

```
foo(); // foo is callable since its declaration was hoisted
function foo() { // this declaration is "hoisted" to the top of the execution
   ...
}

foo(); // this will cause error
var foo = function() { .. }; // function expression, no hoisting

var x = 5;
(function() { // function expression, no hoisting
    // will alert 5, since it was interpreted in-place
    // and executed after the "var x = 5" statement
    alert(x); 
})(); 
```

以下页面将清楚地说明：

*   [http://davidshariff.com/blog/what-is-the-execution-context-in-javascript/](http://davidshariff.com/blog/what-is-the-execution-context-in-javascript/)
*   [JavaScript 中的“执行上下文”到底是什么？](https://stackoverflow.com/questions/9384758/what-is-the-execution-context-in-javascript-exactly)
*   [http://javascriptweblog.wordpress.com/2010/07/06/function-declarations-vs-function-expressions/](http://javascriptweblog.wordpress.com/2010/07/06/function-declarations-vs-function-expressions/)

# java - Android openGL ES 2 浮点与像素

> ID：14078158
> 
> 赞同：0
> 
> 时间：2012-12-29T02:22:28.390
> 
> 标签：java, android, opengl-es

我正在尝试使用 openGL 进行 2D 渲染。我有一个基本功能，将正方形从屏幕的一端移动到另一端，并在它们离开屏幕后重新定位它们。

我的问题是我不知道如何以浮点值准确表示屏幕。现在，-1.8f 是我屏幕的左侧。我假设这仅适用于我自己的设备。我对么？

我怎么能准确地找到让我们说，屏幕的左下角？

# java - 是否有相当于 JAVA pack() 的 WIN32 API？

> ID：14078161
> 
> 赞同：1
> 
> 时间：2012-12-29T02:22:51.323
> 
> 标签：java, windows, api, winapi, resize

我的 Windows 应用程序需要根据可变数量/大小的子对象自动调整大小。不允许最终用户调整窗口大小。我已经知道如何移动/调整窗口大小。我只需要压缩父窗口以适应子对象的最佳方法。

我可以通过多种方式计算新的大小，但如果 WIN32 API 已经有一个类似 java 的库，我就不必重新发明轮子了。谁能指出我正确的方向或确认该功能不存在？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T02:37:53.683

抱歉，Win32 API 没有这样的东西。如果您想要这样的东西，您将非常需要在 API 本身之上的某种库（或者，当然，您可以自己编写）。

# twitter - 将 pic.twitter.com....地址链接更改为网站小部件推文中的缩略图

> ID：14078162
> 
> 赞同：1
> 
> 时间：2012-12-29T02:22:52.040
> 
> 标签：twitter, thumbnails, default

将 pic.twitter.com 地址链接更改为 iframe 小部件中推文内的缩略图，即

即，带有图像（在我的网站 twitter 小部件中）发布的推文被读取为文本地址。因此，不知情的观众会跳过发布的推文中的图像。（如果他们碰巧点击了推特地址代码，它会重定向到一个新的标签/完整页面。因此，使用缩略图属性重定向也更有意义）。
因此，为了更好地通知观众，并提供更好的推文接收，我的请求是将 pic.twitter.com 地址链接转换为我网站小部件上推文中的缩略图（目标图像）。什么 html 和 java 脚本会强制缩略图进入默认位置而不是单纯的代码地址？？？谢谢，弗朗西斯

完整的 twitter 小部件代码如下： new TWTR.Widget({ version: 2, type: 'faves', rpp: 100, interval: 30000, title: 'Francis Michael Palazzolo', subject: '@turnLEDintoLEAD', width: 280，高度：350，主题：{外壳：{背景：'#faf7fa'，颜色：'#325f33'}，推文：{背景：'#faf7fa'，颜色：'#000000'，链接：'#325f33' } }, features: { scrollbar: true, loop: false, live: true, behavior: 'all' } }).render().setUser('turnLEDintoLEAD').start();Tweet to @turnLEDintoLEAD !function(d ,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs); }}(文档,"脚本","twitter-wjs");>

# android - 按下和释放时更改 ImageButton 的图像

> ID：14078164
> 
> 赞同：1
> 
> 时间：2012-12-29T02:23:32.507
> 
> 标签：android, xamarin.android

在 Mono For Android 中，我有一个 ImageButton，我想在用户按住按钮时更改其图像。当用户释放按钮图像时，应更改为之前的图像。我正在尝试使用下面的代码，但没有任何反应：

```
 private void _goForward_KeyPress(object sender, View.KeyEventArgs e)
    {
        if(e.Event.Action == KeyEventActions.Down)
        {
            _goForward.SetImageResource(Resource.Drawable.arrowUpGreen);
             //Then do some stuff
        }
        else
        {
            _goForward.SetImageResource(Resource.Drawable.arrowUpRed);
            //Then do some stuff
        }
    } 
```

我不确定我是否在正确的事件中这样做。在这种情况下通常应该使用什么事件？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T03:07:39.107

**试试这个：**

**为此使用选择器**

**说出它的名字：background_drawable.xml**

```
<selector
    xmlns:android="http://schemas.android.com/apk/res/android">     
    <item       
        android:drawable="@drawable/YOUR_IMAGE_WHEN_PRESSED"
        android:state_pressed="true" />
    <item
        android:drawable="@drawable/YOUR_IMAGE_WHEN_FOCUSED"
        android:state_focused="true" />
    <item
        android:drawable="@drawable/YOUR_IMAGE_WHEN_NOT_ENABLED"
        android:state_enabled="false" 
        />
    <item
        android:drawable="@drawable/DEFAULT_IMAGE_WHICH_YOU_WANT_ALWAYS" />
</selector> 
```

**在你的 main.xml 文件中**

```
<ImageButton 
            android:background="@drawable/background_drawable"/> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T15:00:19.780

您需要将方法附加到按钮的[`KeyPress`](http://androidapi.xamarin.com/?link=E%3aAndroid.Views.View.KeyPress)事件才能被调用，因为连接不会自动发生：

```
_goForward.KeyPress += _goForward_KeyPress; 
```

**编辑**

糟糕，我第一次应该更仔细地阅读这个问题。由于您试图在触摸按钮时进行挂钩，因此您需要该[`Touch`](http://androidapi.xamarin.com/?link=E%3aAndroid.Views.View.Touch)事件：

```
_goForward.Touch += _goForward_Touch; 
```

和

```
private void _goForward_Touch(object sender, View.TouchEventArgs touchEventArgs)
{
    if (touchEventArgs.Event.Action == MotionEventActions.Down)
    {
        Toast.MakeText(this, "down", ToastLength.Short).Show();
    }
    else
    {
        Toast.MakeText(this, "up", ToastLength.Short).Show();
    }
} 
```

# ip-address - 查找路由器的非默认IP地址？

> ID：14078166
> 
> 赞同：0
> 
> 时间：2012-12-29T02:23:50.697
> 
> 标签：ip-address, router, ipconfig

我正在尝试登录有线电视公司设置的路由器。我有一个新路由器，我正在尝试对其应用相同的设置，因为它与我们的服务器有特定的设置。

路由器的 IP 地址似乎已更改，因为我无法使用标准的 192.168.xx

ipconfig 给出地址 169.254.233.38 和默认网关 0.0.0.0 Apr -a 给出 169.254.233.38 和 169.254.255.255

我要做的就是登录路由器而不进行重置。有什么建议么？

不是说它应该重要，但它是一个贝尔金。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T02:48:56.480

您根本没有连接到路由器的 DHCP 服务。以 169.254 开头的地址由客户端在无法获得分配的地址时自行分配。所以没有办法配置路由器，因为没有路由到它。

这是有线连接吗？您插入的端口是否每端都有绿色状态灯？尝试在路由器上使用不同的有线端口，或使用不同的电缆。

如果是无线连接，而您实际上是在使用 Wi-Fi 进行连接，则可能是路由器有问题。尝试循环电源。

如果这些都不起作用，请在搜索引擎中查找您的特定路由器型号，然后找到手册。将有将其重置为出厂默认状态的说明，之后您应该能够连接并配置它。

# c++ - 为什么我不能转换为 B*？

> ID：14078167
> 
> 赞同：3
> 
> 时间：2012-12-29T02:24:03.940
> 
> 标签：c++

我正在尝试使用运算符转换为 B* ，但它不起作用。为什么？谢谢。

```
struct B;

struct A {
    A() = default;

    operator (B *)() {
        return new B();
    }
};

struct B { B() = default; };

int main() {

    A a;

    B *b = a;

} 
```

我得到错误：`cannot convert 'A' to 'B*' in initialization`

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-29T02:25:41.633

您的代码有几处问题。首先，括号`B*`是错误的，只是这样做：

```
operator B*() {...} 
```

它可能应该是一个`const`成员函数。

此外，您正在尝试在定义`B`之前创建类型的新实例。`B`你不能用*不完整的类型*来做到这一点，只需定义`B`before `A`。

删除这些错误后，您的代码将按预期工作。

# wordpress - 致命错误：在非对象上调用成员函数 query()（wordpress 3..5）

> ID：14078170
> 
> 赞同：0
> 
> 时间：2012-12-29T02:24:10.790
> 
> 标签：wordpress, function, php

致命错误：在第 47 行的 /home/dbc/public_html/CEHPLearning/wp-content/themes/cehpLearning/page-password-reset.php 中的非对象上调用成员函数 query()

```
 <div class="content-page">

    <article id="post-<?php the_ID(); ?>" <?php post_class(); ?>>

        <div class="the-post-container">

            <?php if (!get_meta('hide_title')) : ?>
            <header class="entry-header">
                <!-- Title / Page Headline -->
                <h1 class="entry-title" title="<?php echo the_title_attribute('echo=0'); ?>"><?php the_title(); ?></h1>
            </header>
            <?php endif; ?>

            <!-- Page Text and Main Content -->
            <div class="entry-content clearfix">

                <?php
                $error = '';
                $success = '';
                $user_id = get_current_user_id();

                if(isset($_POST['task']) && $_POST['task'] == 'reset') {

                $password = $_POST['pwd1'];
                $con_password = $_POST['pwd2'];

                if($password == "" || $con_password == "") { 
                $error = 'Password field is required.'; 
                } else if($password <> $con_password){
                $error = 'Password does not match.';
                } else {
                    $qry = $wpdb->query("UPDATE $wpdb->users SET user_pass = '".md5($password)."' WHERE ID=$user_id "); 
                    if($qry) { 
                        $success= 'Password updated successfully, it will take effect in your next login.'; 
                    }
                }
                }
                ?>
                <?php the_content(); ?>
                <div class="pwChangeBox">
                    <form name="frmreset" id="frmreset" action="" method="post">
                        <h3>Don't like your password?<br/>
                        <span>Try a new one.</span></h3><br/>
                        <div class="msgBox"> <?php if($error != "") : echo '<p class="errormsg">'.$error.'</p>'; endif; if($success != "") : echo '<p class="successmsg">'.$success.'</p>'; endif; ?> </div>
                        <label>Password</label><br/>
                        <input type="password" value="<?php echo (isset($_POST['pwd1']) ? $_POST['pwd1'] : ''); ?>" name="pwd1" id="pwd2" /><br/> 
                        <br/>   
                        <label>Password Again</label><br/>
                        <input type="password" value="<?php echo (isset($_POST['pwd2']) ? $_POST['pwd2'] : ''); ?>"" name="pwd2" id="pwd2" /><br/>
                        <br/>
                        <button type="submit" class="alignleft" >SUBMIT</button>
                        <input type="hidden" name="task" value="reset" />
                    </form>
                </div>

            </div>

    </article>

</div> 
```

有问题的行是....

```
$qry = $wpdb->query("UPDATE $wpdb->users SET user_pass = '".md5($password)."' WHERE ID=$user_id "); 
```

有人可以帮忙吗？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T02:30:03.227

您需要先调用全局 $wpdb 实例。所以在你做查询之前添加：

```
global $wpdb; 
```

# mysql - 在数据库列中将常量引用数据存储为单个字符而不是整数有什么问题吗？

> ID：14078174
> 
> 赞同：2
> 
> 时间：2012-12-29T02:25:54.753
> 
> 标签：mysql, ruby-on-rails, database-design

我目前正在构建一个 Rails 应用程序，并且我正在努力确保我现在不会在数据库设计 (MySQL) 中犯任何大错误，这将困扰我。

目前，我在各种表中有一堆字段，这些字段引用了简单的常量数据。例如，我的一张表被调用`rates`，它的字段是 `id`,`amount`和`unit`，单位是每小时/天/周/月。

这些值不会改变，而不是使用参考表，我只是使用一个`CHAR`来表示这些值，所以 hour 是`'h'`， day 是`'d'`， week 是`'w'`等等。我认为这将使数据库更加人性化，并限制 ID 以某种方式更改以及所有数据因此而损坏的可能性。

这似乎是一种合理的方法，还是我错过了一些潜在的陷阱？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T02:46:57.243

如果你真的想这样做，我建议使用一个[`ENUM`](http://dev.mysql.com/doc/refman/5.6/en/enum.html)专栏：

```
CREATE TABLE rates (
  id INTEGER NOT NULL AUTO_INCREMENT PRIMARY KEY,
  amount INTEGER NOT NULL,
  unit ENUM( 'hour', 'day', 'week', 'month' ) NOT NULL
); 
```

这比使用单字符缩写更具可读性，同时效率也不低。在严格的 SQL 模式下，它还确保插入无效值的尝试将被报告为错误。

（然而，eggyal 建议使用`SMALLINT`列并以小时为单位测量持续时间也值得考虑。）

附言。我对 Rails 不是很熟悉，但至少我在谷歌搜索[“mysql rails enum”时](http://www.google.com/search?q=mysql+rails+enum)[得到的第一个结果是](http://www.seejohncode.com/2011/02/18/enums-with-rails/)：

> “Rails 方面最好的部分是，您无需更改代码中的*任何内容*即可将 varchar 换成 ENUM。”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T03:16:10.500

如果由我决定，我会使用包含键/值对的查找表，其中值是您想要的任何值。像这样的东西：

```
CREATE TABLE `lookup_rate_type` 
(
 `id` TINYINT UNSIGNED NOT NULL AUTO_INCREMENT, 
 `name` VARCHAR(20) NOT NULL, 
 PRIMARY KEY (`id`), UNIQUE KEY (`name`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8; 
```

然后，在您需要参考汇率的任何表格中，只需使用与您感兴趣的汇率相关的 id，让我们添加几行：

```
INSERT INTO `lookup_rate_type` SET name = 'second'; # id = 1
INSERT INTO `lookup_rate_type` SET name = 'minute'; # id = 2
INSERT INTO `lookup_rate_type` SET name = 'hour'; # id = 3 
```

现在，如果您有一张需要参考费率的表格，您可以这样做：

```
INSERT INTO `some_table` SET rate = 27, rate_type_id = 3; # 27 / hour
INSERT INTO `some_table` SET rate = 3600, rate_type_id = 2; # 3600 / minute 
```

这种方法的好处是，如果您决定只使用第一个字母来识别 rate_type，您只需更新`lookup_rate_type`表：

```
UPDATE `lookup_rate_type` SET name = 's' WHERE ID = 1 LIMIT 1; 
```

即使您更改了名称值（在您理解的上下文中，第二个变为 s），存储与该值的关系的任何表都将保持不变。

使用此解决方案，您可以根据需要向查找表添加任意数量的行，而不必运行更改语句来添加枚举，如果处理大型表，这可能会很痛苦。

此解决方案的唯一缺点是您可能需要使用类常量来允许您的应用程序代码访问 int 值，以便您可以根据您的业务逻辑执行 CRUD 操作，例如：

```
class LookupRateType
{
    const SECOND = 1;
    const MINUTE = 2;
}

// Calling code example
$sql = sprintf('INSERT INTO some_table SET rate = %d, rate_type_id = %d', 27, LookupRateType::MINUTE); 
```

此外，如果您愿意，在处理一小部分常量时，您可以完全放弃查找表而只处理类常量。这里的缺点是您在查找特定数据时必须知道 id，而不是使用查询：

```
# If you use class constants only, you can do this
SELECT * FROM some_table WHERE rate_type_id = (SELECT id FROM lookup_rate_type WHERE name = 'hour');

# But if you can lookup the context with the code you can simply input the id
SELECT * FROM some_table WHERE rate_type_id = 3; 
```

这些是我在处理大量不同应用程序时遇到的场景，并且发现查找表和/或类常量是最佳解决方案。

# css - Web 表单样式：使用 HTML 元素“表单”还是“数据”？

> ID：14078175
> 
> 赞同：0
> 
> 时间：2012-12-29T02:26:03.387
> 
> 标签：css, html, forms

## 如何最好地在 HTML5 中构建数据输入屏幕？

*   请记住，我想使用无表 CSS

*   我已经收集*了一些*数据（归档 1、2、3）并想收集字段 4 和 5

*   我正在查看表单、列表或数据元素——所有这些似乎都可以完成这项工作

**第 1 步**- 展示`{field1,field2,field3}`已经收集到的数据。
仅供参考 - 使用以下 PHP 脚本将数据带到页面并且它可以工作 - 这里没有问题。

```
while ($row = $sth->fetch(PDO::FETCH_ASSOC)) {
    echo $row['field1'],'<br>';
    echo $row['field2'],'<br>';
    echo $row['field3'],'<br>';
} 
```

**第 2 步**- 显示新数据的输入字段
我想显示的输入字段`{field4,field5}`。

# 问题：

我必须使用 HTML 元素“表单”还是应该/可以使用“数据”或“列表”HTML 元素？

```
<label for="form_id">Test Form</label>
<input type="text" name="field4" value="" />
<label for="form_id">Test Form</label>
<input type="text" name="field5" value="" /> 
```

这是数据输入屏幕的可视化表示。

```
|----------------|
|Filed1: Data1   |
|Filed2: Data2   |
|Filed3: Data3   |
|----------------|   
|Field4: (Empty) |
|Field5: (Empty) |
|----------------| 
```

# ruby-on-rails - 如何在 Rails 3.2 中创建和编辑嵌套对象？

> ID：14078176
> 
> 赞同：0
> 
> 时间：2012-12-29T02:26:04.910
> 
> 标签：ruby-on-rails, ruby-on-rails-3

所以我有两个模型，报告和收据。每份报告都有许多收据。我使用脚手架来生成我所有的视图和东西，但我改变了一些东西，以便当用户创建新报告或编辑报告时，他们可以在表单中创建和编辑收据。

我的模型设置：

```
class Report < ActiveRecord::Base

    has_many :receipts, :dependent => :destroy
  accepts_nested_attributes_for :receipts, :allow_destroy => true

    attr_protected :id

end
class Receipt < ActiveRecord::Base
    belongs_to :report

    attr_protected :id

    validates_presence_of :vendor, :date, :description, :amount, :acctCode
end 
```

我已设置表单以创建新收据：

```
 <%= form_for @report do |f| %>
     ....
       <%= f.fields_for :receipts, Receipt.new do |receipt| %>
       ...
       <% end %>
    <% end %> 
```

但是每次我去保存报告时，都会出现路由错误：

```
No route matches {:action=>"edit", :controller=>"receipts", :report_id=>#<Receipt id: nil, date: nil, vendor: "", description: "", amount: nil, companyCard: false, lobbyingExpense: false, acctCode: "", created_at: nil, updated_at: nil, report_id: 2>} 
```

我的路线设置为：

```
resources :reports do
    resources :receipts
end 
```

我的收据控制器有

```
 # GET /receipts/new
  def new
    @receipt = Receipt.new

    respond_to do |format|
      format.html # new.html.erb
    end
  end

  # GET /receipts/1/edit
  def edit
    @receipt = Receipt.find(params[:id])
  end

  # POST /receipts
  def create
    @receipt = Receipt.new(params[:receipt])

    respond_to do |format|
      if @receipt.save
        format.html { redirect_to @receipt.Report, notice: 'Receipt was successfully created.' }
      else
        format.html { render action: "new" }
      end
    end
  end 
```

我有一段时间没碰过铁轨了，所以我不知道我做错了什么。但是在我的旧应用程序 (3.1) 中，当我添加图像来表示博客文章时，我什至没有图像控制器，除了通过 ajax 删除它们。我在这里有一个收据控制器的唯一原因是因为我使用脚手架来生成视图等。

编辑 - 我还应该指出，如果我转到新的收据视图，我会在表单标签上收到一个错误：

```
<%= form_for(@receipt) do |receipt| %>

undefined method `receipts_path' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T14:37:17.727

如果您正在使用`accepts_nested_attributes_for`，则不需要额外的控制器来管理记录。当然，如果您需要特定页面，例如收据的“显示视图”，则需要该控制器。

为了得到`accepts_nested_attributes_for`你需要：

1.  报告表格
2.  `fields_for :receipts`以那种形式使用

这样，您可以编辑给定报告的所有已创建收据。如果您还想创建新收据，您可以使用以下命令添加空白收据：`@report.receipts.build`。您可以将此调用添加到您的`new`和`edit`操作中。

请注意，您在报表的表单中编辑收据。这意味着，您应该点击`ReportsController`而不是`ReceiptsController`.

如果事情在这里不起作用，请提供一些调试建议：

*   执行 rake routes 以查看是否所有内容都已正确定义。
*   检查生成的 HTML 来自`form_for(@report)`. 尤其是表单标签的 'action=""' 属性是相关的。它应该指向“/reports/X”

编辑：我创建了一个包含所有相关文件的 Gist 以使嵌套表单工作：[https ://gist.github.com/4420280](https://gist.github.com/4420280)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T19:26:00.690

为嵌套资源表单结帐茧宝石。这个 gem 使处理嵌套资源的工作变得更加容易。[https://github.com/nathanvda/cocoon](https://github.com/nathanvda/cocoon)

# php - OPENSSL file_get_contents()：无法启用加密

> ID：14078182
> 
> 赞同：53
> 
> 时间：2012-12-29T02:26:33.963
> 
> 标签：php, apache, openssl

我正在建立一个个人股票平台（未分发）。我想要的一个组件是此页面上的 EPS 图：

[https://eresearch.fidelity.com/eresearch/evaluate/fundamentals/earnings.jhtml?stockspage=earnings&symbols=AAPL&showPriceLine=yes](https://eresearch.fidelity.com/eresearch/evaluate/fundamentals/earnings.jhtml?stockspage=earnings&symbols=AAPL&showPriceLine=yes)

如您所见，该页面是`https`，因此经过几天的努力，我启用`openssl`了它，现在它似乎适用于所有`https`页面，例如 facebook 和 twitter 的主页，但它仍然不适用于我需要的页面。

```
file_get_contents('https://facebook.com'); /* works */
file_get_contents('https://twittercom'); /* works */
file_get_contents('https://eresearch.fidelity.com/eresearch/evaluate/fundamentals/earnings.jhtml?stockspage=earnings&symbols=AAPL&showPriceLine=yes'); 
```

我收到警告：

```
Warning: file_get_contents(): SSL: crypto enabling timeout in C:\xampp\htdocs\index.php on line 3
Warning: file_get_contents(): Failed to enable crypto in C:\xampp\htdocs\index.php on line 3
Warning: file_get_contents(https://eresearch.fidelity.com/eresearch/evaluate/fundamentals/earnings.jhtml?stockspage=earnings&symbols=AAPL&showPriceLine=yes): failed to open stream: operation failed in C:\xampp\htdocs\index.php on line 3
Fatal error: Maximum execution time of 30 seconds exceeded in C:\xampp\htdocs\index.php on line 3 
```

我能看到的唯一区别是保真度页面在 https 标签附近有一个三角形。

![保真 https 标签](../Images/3b1695d7c8bfda1f7778e8c38e9afab5.png)

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2012-12-29T02:56:57.123

好的，我找到了解决方案。问题是该站点使用 SSLv3。而且我知道openssl模块存在一些问题。前段时间我对 SSL 版本有同样的问题。

```
<?php
function getSSLPage($url) {
    $ch = curl_init();
    curl_setopt($ch, CURLOPT_HEADER, false);
    curl_setopt($ch, CURLOPT_URL, $url);
    curl_setopt($ch, CURLOPT_SSLVERSION,3); 
    $result = curl_exec($ch);
    curl_close($ch);
    return $result;
}

var_dump(getSSLPage("https://eresearch.fidelity.com/eresearch/evaluate/analystsOpinionsReport.jhtml?symbols=api"));
?> 
```

当您使用 curl 将 SSL 版本设置为 v3 时，它就可以工作了。

**编辑：**

Windows 下的另一个问题是您无权访问证书。所以直接把根证书放到curl。

[http://curl.haxx.se/docs/caextract.html](http://curl.haxx.se/docs/caextract.html)

在这里您可以下载根证书。

```
curl_setopt($ch, CURLOPT_CAINFO, __DIR__ . "/certs/cacert.pem");
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, true); 
```

然后你可以使用该`CURLOPT_SSL_VERIFYPEER`选项，`true`否则你会得到一个错误。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2017-01-23T13:23:18.553

有同样的问题 - 它在 ca 证书中的某个地方，所以我使用了用于 curl 的 ca 包，并且它有效。你可以在这里下载 curl ca 包： [https ://curl.haxx.se/docs/caextract.html](https://curl.haxx.se/docs/caextract.html)

有关加密和安全问题，请参阅这篇有用的文章：
[https ://www.venditan.com/labs/2014/06/26/ssl-and-php-streams-part-1-you-are-doing-it-wrongtm/ 432](https://www.venditan.com/labs/2014/06/26/ssl-and-php-streams-part-1-you-are-doing-it-wrongtm/432)

这是示例：

```
 $url = 'https://www.example.com/api/list';
    $cn_match = 'www.example.com';

    $data = array (     
        'apikey' => '[example api key here]',               
        'limit' => intval($limit),
        'offset' => intval($offset)
        );

    // use key 'http' even if you send the request to https://...
    $options = array(
        'http' => array(
            'header'  => "Content-type: application/x-www-form-urlencoded\r\n",
            'method'  => 'POST',                
            'content' => http_build_query($data)                
            )
        , 'ssl' => array(
            'verify_peer' => true,
            'cafile' => [path to file] . "cacert.pem",
            'ciphers' => 'HIGH:TLSv1.2:TLSv1.1:TLSv1.0:!SSLv3:!SSLv2',
            'CN_match' => $cn_match,
            'disable_compression' => true,
            )
        );

    $context  = stream_context_create($options);
    $response = file_get_contents($url, false, $context); 
```

希望有帮助

# java - OpenGL第一人称相机位置问题

> ID：14078189
> 
> 赞同：2
> 
> 时间：2012-12-29T02:28:52.337
> 
> 标签：java, opengl, lwjgl

我最近完成的 opengl 程序中有一个“相机”。但是，我注意到每当我旋转然后再次移动时，x、y 和 z 角度都会发生变化。例如，当我按下“w”键时，我沿着“z”轴向前移动。如果我然后将相机旋转 90 度，当我按下“W”键时，我实际上会向右移动，看似沿着“x”轴。为什么会发生这种情况是有道理的，我只是想知道为什么会发生这种情况。这是旋转功能：

```
private void camera() {
    glRotatef(xrot, 1.0f, 0.0f, 0.0f);
    glRotatef(yrot, 0.0f, 1.0f, 0.0f);
} 
```

键盘功能：

```
if (Keyboard.isKeyDown(Keyboard.KEY_D)) {
        xpos -= 0.035 * delta;
    }

    if (Keyboard.isKeyDown(Keyboard.KEY_A)) {
        xpos += 0.035 * delta;
    }

    if (Keyboard.isKeyDown(Keyboard.KEY_W)) {
        zpos += 0.03f * delta;
    }

    if (Keyboard.isKeyDown(Keyboard.KEY_S)) {
        zpos -= 0.035 * delta;
    }
if (Keyboard.isKeyDown(Keyboard.KEY_UP)) {
        xrot += 0.035;
        if (xrot > 360) {
            xrot -= 360;
        }
    }

    if (Keyboard.isKeyDown(Keyboard.KEY_DOWN)) {
        xrot -= 0.035;
        if (xrot > 360) {
            xrot += 360;
        }
    }

    if (Keyboard.isKeyDown(Keyboard.KEY_RIGHT)) {
        yrot += 0.035;
        if (xrot > 360) {
            xrot -= 360;
        }
    }

    if (Keyboard.isKeyDown(Keyboard.KEY_LEFT)) {
        yrot -= 0.035;
        if (xrot > 360) {
            xrot += 360;
        }

    } 
```

还有我的翻译功能：

```
 glTranslated(xpos, ypos, zpos - 30); 
```

关于如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T06:24:26.153

您可能希望参考相机指向的位置移动。这意味着在适用时将增量添加到 x、y 和 z 位置。

幸运的是，当您从欧拉角（xrot、yrot）计算相机 viewMatrix 时，旋转矩阵正好包含要添加的值：

```
 [rx ux fx - ]
 [ry uy fy - ] = viewMatrix
 [rz uz fz - ]
 [ - -  -  - ] 
```

忽略标有'-'的元素，向右/向左移动时应加/减“右”列向量 = (rx,ry,rz)，向上移动时应加/减“上”向量 = (ux,uy,uz)前/后移动时的 /down 和前矢量 (fx,fy,fz)。

如果高度保持不变，则忽略 ry,uy,fy 分量，但准备对剩余的两个分量进行归一化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T10:02:04.297

也许看看基于旧 gluLookAt 的相机，那么您将更好地控制相机位置和它指向的位置。

这里有一些链接：

*   [http://www.songho.ca/opengl/gl_transform.html](http://www.songho.ca/opengl/gl_transform.html)
*   [http://www.lighthouse3d.com/tutorials/glut-tutorial/keyboard-example-moving-around-the-world/](http://www.lighthouse3d.com/tutorials/glut-tutorial/keyboard-example-moving-around-the-world/)
*   [http://www.codeproject.com/Articles/84698/OpenGL-Camera](http://www.codeproject.com/Articles/84698/OpenGL-Camera)

# objective-c - iPhone SDK：如何从字符串中提取此数字

> ID：14078190
> 
> 赞同：0
> 
> 时间：2012-12-29T02:28:54.057
> 
> 标签：objective-c, foundation

我有一个应用程序的脚本，我被困在一种提取特定数字的方法上例如：

```
\n@JulianJear\nApplication Development 4 iPhone and iPad.\n5\n 
```

我无法想出一种方法来删除“5”而不从该字符串中获取“4”。我曾想过使用扫描仪，但每个用户的这段文本中的字符数量会有所不同。那么，还有什么其他方法可以提取这个数字呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T02:37:59.763

如果被解析的文本始终具有以下格式

```
<Handle>
<Title>
<Number> 
```

IE

```
\n<Name>\n<Title>\n<Number>\n 
```

您可以使用 an`NSScanner`来解析字符串：

```
#import <Foundation/Foundation.h>

int main(int argc, char *argv[]) {
    @autoreleasepool 
    {
        NSString *string = @"\n@JulianJear\nApplication Development 4 iPhone and iPad.\n5\n";

        NSScanner *scanner = [[NSScanner alloc] initWithString:string];
        NSCharacterSet *newlineCharacterSet = [NSCharacterSet characterSetWithCharactersInString:@"\n"];

        NSString *handle = nil;
        NSString *title = nil;
        NSString *number = nil;

        [scanner scanUpToCharactersFromSet:newlineCharacterSet intoString:&handle];
        [scanner scanUpToCharactersFromSet:newlineCharacterSet intoString:&title];
        [scanner scanUpToCharactersFromSet:newlineCharacterSet intoString:&number];

        NSLog(@"\nhandle=%@\ntitle=%@\nnumber=%d", handle, title, [number intValue]);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T02:35:27.500

您可以在 上拆分字符串`\n`，并查找表示数字的字符串：

```
NSArray *tokens = [str componentsSeparatedByCharactersInSet:
      [NSCharacterSet characterSetWithCharactersInString:@"\n"]]; 
```

遍历`tokens`数组中的字符串，并取第一个表示数字的字符串。

# php - 使用PHP删除与特定字符串匹配的数组中的所有元素

> ID：14078197
> 
> 赞同：14
> 
> 时间：2012-12-29T02:30:29.630
> 
> 标签：php, arrays

我希望这真的很简单，我错过了一些明显的东西！

我正在尝试删除与某个字符串匹配的数组中的所有元素。这是一个基本的一维数组。

```
array("Value1", "Value2", "Value3", "Remove", "Remove"); 
```

我想结束

```
array("Value1", "Value2", "Value3"); 
```

为什么不`array_filter($array, "Remove");`工作？

谢谢。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-12-29T02:36:00.703

你可以在[`array_diff`](http://php.net/array_diff)这里使用，如果它是一个固定的字符串：

```
$array = array_diff($array, array("Remove")); 
```

对于更复杂的匹配，我[`preg_grep`](http://php.net/preg_grep)显然会使用：

```
$array = preg_grep("/^Remove$/i", $array, PREG_GREP_INVERT);
// matches upper and lowercase for example 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-29T02:34:07.047

您需要使用回调。

```
array_filter($array, function($e){
   return stripos("Remove", $e)===false
}); 
```

要正确理解上述代码，请参阅此注释代码。

```
array_filter($array, function($e){
    if(stripos("Remove", $e)===false) // "Remove" is not found
        return true; // true to keep it.
    else
        return false; // false to filter it. 
}); 
```

# ruby-on-rails - 保存模型时如何保存rails子模型连接表更改？

> ID：14078198
> 
> 赞同：1
> 
> 时间：2012-12-29T02:30:31.633
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2, associations, autosave, jointable

我不知道如何在我的应用程序中自动保存连接表记录。我正在构建一个应用程序来让用户制作一本书。他们创建页面并上传图片库，然后将图片连接到页面。每本书都有一个封面，其中有一个封面图片。

我的目标只是能够设置书的封面图像文件名，并在保存书时保存子模型更改。（我已经缩小了示例范围，因此我们不处理实际附加的图像 - 这不是问题）。

```
class Book < ActiveRecord::Base
  has_many :pages, :dependent=>:destroy, :autosave=>true
  has_many :images, :dependent=>:destroy, :autosave=>true
  attr_accessible :title, :pages_attributes

  # we want to be able to set the cover page image filename for a book
  attr_accessor :cover_image_file_name

  before_validation do 
    # a book always has a cover page as page 0
    cover_page = pages.find_or_initialize_by_page_number(0)
    if @cover_image_file_name
      page_image = cover_page.page_images.find_or_initialize_by_image_type('cover')
      page_image.image = images.find_or_initialize_by_image_file_name(@cover_image_file_name)
    end
  end
end

class Image < ActiveRecord::Base
  belongs_to :book
  has_many :page_images,:dependent=>:destroy
  attr_accessible :image_file_name
end
class Page < ActiveRecord::Base
  belongs_to :book
  has_many :page_images, :dependent=>:destroy, :autosave=>true
  attr_accessible :page_number, :page_images_attributes
end
class PageImage < ActiveRecord::Base
  belongs_to :page
  belongs_to :image
  attr_accessible :image_type, :image
end 
```

现在，当我执行以下代码来创建一本书并设置（或重置）其封面图像时，不会保存将新创建的图像连接到封面的 page_image 对象：

```
book = Book.new({ title: "Book Title" })
book.save!  # this correctly saves the book and its cover page

book.cover_image_file_name = 'my_cover_page.png'
book.save!  # the image gets created and saved, but not the page_image 
```

我错过了什么？我认为它可能与[https://github.com/rails/rails/pull/3610](https://github.com/rails/rails/pull/3610)有关，但我使用的是 rails 3.2.9。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T02:56:50.950

当您尝试将**图像**分配给*belongs_to :image* 的**page_image**时，不会保存最后一个。因为此时图像（作为父对象）没有保存。

所以你只需要在 page_image 和 book 一起保存之前保存它。

```
class Book < ActiveRecord::Base
  has_many :pages, :dependent=>:destroy, :autosave=>true
  has_many :images, :dependent=>:destroy, :autosave=>true
  attr_accessible :title, :pages_attributes

  # we want to be able to set the cover page image filename for a book
  attr_accessor :cover_image_file_name

  before_validation do 
    # a book always has a cover page as page 0
    cover_page = pages.find_or_initialize_by_page_number(0)
    if @cover_image_file_name
      image = images.find_or_initialize_by_image_file_name(@cover_image_file_name).save
      page_image = cover_page.page_images.find_or_initialize_by_image_type('cover')
      page_image.image = image
    end
  end
end 
```

担心的是您的代码运行 *before_validation* 并在此阶段保存任何内容是错误的方式。图书尚未保存，但您已保存其内容...

你必须重写你的回调。让它变得聪明。

# java - 将 Web 应用程序部署到 Apache Tomcat 的最简单方法

> ID：14078203
> 
> 赞同：1
> 
> 时间：2012-12-29T02:31:59.770
> 
> 标签：java, tomcat, servlets

我正在尝试将我的第一个 servlet 部署到我的服务器。当然，网上有很多教程。但是大部分都非常详细和复杂，我只需要在这台服务器上部署几个简单的 servlet。

我发现了我认为最短的部署方法：[在 Tomcat Startup 上部署](http://tomcat.apache.org/tomcat-7.0-doc/deployer-howto.html#Deployment_on_Tomcat_startup)。我将我的 .WAR 文件 ( `FirstProject.war`) 移动到`$CATALINA_BASE/webapps`文件夹中，但是在尝试访问它时 ( `ServerIP/FirstProject`) 我得到“*请求的资源不可用*”。错误。

我在部署过程中忘记了什么吗？

我知道`deployOnStartup`必须设置为`true`，但我没有对服务器的主机进行任何更改，因此当前主机是`localhost`. 我没有更改它的设置，所以`deployOnStartup`应该是`true`（据说这`true`是默认设置）。

我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T04:14:46.243

您正在使用最简单的方法，但我不知道您缺少什么。在这里，我建议运行您的服务器并通过 localhost:8080 访问，然后单击管理应用程序，然后输入用户名和密码，然后您可以部署您的战争。如果您有任何查询 post 命令。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T07:29:37.877

即使我曾经在 Jboss 和 Apache 上部署我的第一个 Web 应用程序时也遇到过这个问题。

即使您的代码在内容文件中使用的所有 servlet 映射和路径都可以正常工作...有时它们会在实时环境中回退..所以我们必须知道正确的部署文件夹结构，因此我们必须更改我们的代码中的路径

我的结论是检查下面的代码行

```
 Examples, assuming root is http://foo.com/site/

Absolute path, no matter where we are on the site

/foo.html

will refer to http://foo.com/site/foo.html

Relative path, assuming the containing link is located in http://foo.com/site/part1/bar.html

../part2/quux.html

will refer to http://foo.com/site/part2/quux.html

or

part2/blue.html

will refer to http://foo.com/site/part1/part2/blue.html 
```

# python - 用于会话管理的 Python 模块

> ID：14078207
> 
> 赞同：5
> 
> 时间：2012-12-29T02:32:22.103
> 
> 标签：python, python-module, session-management

是否有任何等效的会话管理模块，例如 Perl 的 CGI::Session 或 Apache::Session ？（我知道大多数 python web 框架都有自己的实现，但我正在寻找一个可以与任何 python 应用程序一起使用的独立模块。）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-29T02:51:45.473

我认为您可以使用 Beaker's，这是一个流行的图书馆。[文件](http://beaker.readthedocs.org/en/latest/#using)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-29T02:48:41.830

[Werkzeug](http://werkzeug.pocoo.org/)是一个 WSGI 库，在某种程度上相当于 Python 世界中 Perl 的 CGI 模块（几乎没有人在 Python 中使用 CGI），它具有基本的会话和签名 cookie 支持。

Werkzeug 为[Flask](http://flask.pocoo.org/)提供支持，这是一个极简主义的 Web 框架，我经常将它用于快速和肮脏的东西。

# objective-c - NSDecimalNumber RestKit 精度错误

> ID：14078208
> 
> 赞同：2
> 
> 时间：2012-12-29T02:32:43.443
> 
> 标签：objective-c, restkit, nsdecimalnumber

RestKit v 0.10.2 非常奇怪的 NSDecimalNumber 精度错误（或者可能是我没有看到的操作员错误）

类定义：

```
....
@property (nonatomic, assign) NSInteger menuItemId;
@property (nonatomic, strong) NSString *menuItemTitle;
@property (nonatomic, strong) NSString *menuItemDescription;
@property (nonatomic, strong) NSDecimalNumber *menuItemPrice;
.... 
```

JSON文本：

```
{"MenuItemId":5,
 "MenuItemTitle":"Grilled Jumbo Shrimp Penne Pasta",
 "MenuItemDescription":"spinach, mushrooms, garlic, sour cream, sun-dried tomatoes",
 "MenuItemBasePrice":9.9500} 
```

对象映射不起眼：

```
 [objectMapping mapKeyPath:@"MenuItemId" toAttribute:@"menuItemId"];
 [objectMapping mapKeyPath:@"MenuItemTitle" toAttribute:@"menuItemTitle"];
 [objectMapping mapKeyPath:@"MenuItemDescription" toAttribute:@"menuItemDescription"];
 [objectMapping mapKeyPath:@"MenuItemBasePrice" toAttribute:@"menuItemPrice"]; 
```

然而反序列化导致 menuItemPrice 值 = 9.9499999999

似乎错误/问题可以追溯到方法中 RKObjectMappingOperation 中的这些行

```
- (id)transformValue:(id)value atKeyPath:(NSString *)keyPath toType:(Class)destinationType

....
} else if ([sourceType isSubclassOfClass:[NSNumber class]] && [destinationType isSubclassOfClass:[NSDecimalNumber class]]) {
    // Number -> Decimal Number
    return [NSDecimalNumber decimalNumberWithDecimal:[value decimalValue]];
} .... 
```

“值”是 NSCFNumber 类型，我似乎在从 NSCFNumber 到 NSDecimalNumber 的值映射中失去了精度。

这对我来说很重要，因为我正在处理价格和货币。

我在这里遗漏了明显的东西吗？没有看到如何/为什么会发生这种情况以及如何处理它。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-19T07:29:35.327

这似乎是Restkit[的一个已知问题](https://github.com/RestKit/RestKit/issues/1405)，并且仍然保留在 0.20

正如@blakewatters 的评论，服务器应该在字符串中返回浮点数，客户端仍然为对应字段声明 NSDecimalNumber，Restkit 将更正确地转换。

# php - 用户名册，加入表但丢失数据

> ID：14078215
> 
> 赞同：0
> 
> 时间：2012-12-29T02:35:41.640
> 
> 标签：php, mysql, laravel

我需要一些查询帮助（使用 Laravel 框架）。我正在建立一个用户名册，其中包含一些包含用户评级的列。基本上，它选择所有具有首字母的活动用户并加入用户评级表以选择各个用户的评级。这`where_in`是仅选择特定评级。我的问题在名册上，它只选择一个评级，而不是所有评级（如果用户有多个评级）。我也尝试过不使用`group_by`，但是根据他们拥有的评级数量，用户在表格上重复（例如：如果用户有 2 个评级，他们的行在名册上显示两次）。

询问：

```
$users = DB::table('users')
    ->where('users.initials', '!=', '')
    ->left_join('user_ratings', 'user_ratings.uid', '=', 'users.uid')
    ->where_in('users_ratings.rid', array(6,17,21,20))
    ->group_by('users.uid')
    ->order_by('users.name')
    ->get(); 
```

表：

```
 Users
  =======
  uid    name 
  1      John
  2      Jeff
  3      Cathy

  Ratings
  ======
  rid   uid
  1     1
  2     1
  2     2
  3     1
  4     3 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T13:56:52.923

问题是当您执行 left_join 时，您将获得的结果是多行。因此，如果没有 group_by 子句，它将以行而不是列的形式返回您想要的所有结果，并且使用 group_by 它只会返回第一个评级（这是预期的行为）。

我建议你只使用 Eloquent ORM 并设置模型及其关系（它更容易和更清晰）。我猜 user_rating 是一个多对多的数据透视表？在这种情况下，您将有两个模型 User 和 Rating，它们的关系将是 has_many_and_belongs_to。此外，laravel 中的命名约定具有按字母顺序排列的数据透视表，因此将其称为“rating_user”。在这里查看如何建立关系： http: [//laravel.com/docs/database/eloquent#relationships](http://laravel.com/docs/database/eloquent#relationships)

一旦建立了模型及其关系，我要做的是

`$users = User::where('initials', '!=', '')->order_by('name')->get();`

然后，

```
foreach($users as $user) {
    echo "Ratings for " .$user->name . ": ";
    $ratings = $user->ratings()->pivot()->where_in('rid', array(6,17,21,20))->get();
    foreach($ratings as $rating) {
        however you want to display the ratings here...
    }
} 
```

这可能不是最有效的方法，但鉴于我的假设是正确的，它应该可以完成工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T02:41:21.177

快速浏览一下[文档](http://laravel.com/docs/database/fluent)就会发现，Fluent Query Builder 只能做 MySQL 可以做的事情，而 MySQL 不能将数组返回给客户端。

看看[这个问题](https://stackoverflow.com/questions/14063558/mysql-select-ids-grouped-by-distinct-column-select-all-ids-for-each-unique-do)，看看你的替代方案。

如果你想让 Laravel[为你获取评分，你需要构建一个模型](http://laravel.com/docs/database/eloquent#one-to-many)。

# c# - 多线程，每个线程顺序运行以制作具有唯一文件名的多个 tiff 图像

> ID：14078216
> 
> 赞同：0
> 
> 时间：2012-12-29T02:35:51.153
> 
> 标签：c#

我目前正在处理应用程序从文件夹中获取文件并到达每个图像以获取条形码的项目。当它读取条形码时，它会将所有非条形码文件推送到数组中，并且该文件数组将与目的地中具有唯一名称的多页单 tiff 图像合并。我所做的一切和它的工作，但我想使用线程让它快速。我有这样的功能 -

1.  读取图像文件直到达到条形码。
2.  在目标文件夹中创建一个唯一的名称
3.  制作多页单tiff图像
4.  将其保存在目标文件夹中。

阅读条形码我使用简单的条形码阅读器，我得到图像有条形码或没有条形码。我在 foreach 循环中处理数组。一些代码在这里

```
 foreach (string path in filenames_1)

            {

                    Image bmp = Bitmap.FromFile(path);
                    Bitmap bn = (Bitmap)bmp;
                    readimage(bn);

                    if (s == 1) //If it is Bookmarked Content Found Then s=1 else its s=0
                    {
                        if (z == 0) // i used z coz in my process first file in directory is barcode image so first time have to skip it so i set z=1 at begining and second time it become 0 and process continues
                        {
                            j = 3; continue;
                            MakeUnique("c:\\sachin.tiff");
                            ConvertToMultiPageTiff(fileNames, fnamem);
                            fileNames.Clear();

                        }
                        fileNames.Add(path);
                        j = 1;
                        if (z == 0)
                        {
                            j = 3;

                        }
                        else
                        {

                        }

                    }
                    else
                    {

                        if (j == 1) // j==1 means its regular tiff file wher i make them add to string array
                        {
                            fileNames.Add(path); // string array with files to be made multiple tiff image become single mulipage tiff image
                            j = 1;
                            z = 0;
                        }

                        if (j == 3)
                        {
                            z = 1;
                            j = 1;
                            fileNames.Add(path);
                            MakeUnique("c:\\sachin.tiff");
                            ConvertToMultiPageTiff(fileNames, fnamem); // this function converts all the added files in filearray of single tiff image to multiple page single tiff image
                            fileNames.Clear();

                        }

                        else
                        {

                        }

                    }
                }

        }

        MakeUnique("c:\\sachin.tiff");
        ConvertToMultiPageTiff(fileNames, fnamem);
        fileNames.Clear();
     } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T03:48:51.517

试试这个逻辑

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Reflection;
using System.Net;
using System.Collections;
using System.Threading;
namespace ConsoleApplication4
{

    static class Program
    {
        private static ManualResetEvent wh;
        private static int total;
        private static int done;
        private static void Main()
        {

            string[] myfiles = new string[] {"file1", "file2"};
            wh = new ManualResetEvent(false);
            total = myfiles.Length;
            foreach (string myfile in myfiles)
            {
                ThreadPool.QueueUserWorkItem(ProcessImageFile, myfile);
            }
            wh.WaitOne(Timeout.Infinite);

            //wohoo all files are process now, at faster rate;

        }

        private static void ProcessImageFile(object state)
        {
            string file = state as string;

            // process the file here

            Interlocked.Increment(ref done);

            if (done == total)
            {
                wh.Set();
            }

        }
    }

} 
```

# java - Android：VM 因背景可绘制而崩溃

> ID：14078222
> 
> 赞同：0
> 
> 时间：2012-12-29T02:37:35.503
> 
> 标签：java, android

我制作了一个为应用程序分配背景的样式，并将样式添加到`mainfest.xml`.

我在应用程序的背景可绘制对象中制作了两张图片**。**当我在手机上测试我的应用程序并**旋转**手机几次时，应用程序因应用程序背景可绘制对象溢出而崩溃。`drawable-land``drawable-port`

 **那么我该如何控制呢？有没有人可以告诉我如何解决它？提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T08:36:20.390

如果 logcat 中显示的异常/错误是 outOfMemory（类似于“java.lang.OutofMemoryError：位图大小超出 VM 预算。”），您需要以更有效的方式处理图像，因为它占用了太多内存要使用的设备/模拟器。

我建议根据设备的密度降低质量，并阅读[android位图处理技巧](http://developer.android.com/training/displaying-bitmaps/index.html)**

# xml - 使用 Google 图片索引验证站点地图

> ID：14078228
> 
> 赞同：1
> 
> 时间：2012-12-29T02:38:29.453
> 
> 标签：xml, xsd, sitemap

我正在尝试 使用此验证工具验证此站点地图： [http ://animal.org.il/post.xml：http:](http://animal.org.il/post.xml) [//www.xmlcheck.com/checkurl.php](http://www.xmlcheck.com/checkurl.php)

我在所有图像上都收到此错误：图像标签：错误 1845：元素“{http://www.google.com/schemas/sitemap-image/1.1}image”：没有匹配的全局元素声明可用，但需要通过严格的通配符。

这是我的站点地图的当前源代码片段，其中显示了其中一些 image:image 标签：

```
<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="http://animal.org.il/wp-content/plugins/bwp-google-xml-sitemaps/xsl/bwp-sitemap.xsl"?>
<urlset xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://www.sitemaps.org/schemas/sitemap/0.9" xmlns:image="http://www.google.com/schemas/sitemap-image/1.1">

<url>
    <loc>http://animal.org.il/to-be-goose/</loc>
    <lastmod>2012-07-24T09:57:18+00:00</lastmod>
    <changefreq>monthly</changefreq>
    <priority>0.4</priority>
    <image:image>
      <image:loc>http://animal.org.il/wp-content/gallery/goose/goose-nature.jpg</image:loc>
      <image:title>אווז בטבע</image:title>
      <image:caption>אווז בטבע עף על פני מאות קילומטרים מדי שנה, אך בתעשיית הבשר והנוצות הוא לא יזכה לפרוש כנף לעולם.</image:caption>
    </image:image>
    <image:image>
      <image:loc>http://animal.org.il/wp-content/gallery/goose/goose-feathers.jpg</image:loc>
      <image:title>תעשיית הנוצות</image:title>
      <image:caption>אווז ממשש במקורו את העור החשוף לאחר מריטת נוצותיו. מתוך תחקיר על תעשיית ה&lt;a href="http://anonymous.org.il/cat40.html" target="_blank"&gt;נוצות&lt;/a&gt; של הטלוויזיה השוודית (Kalla Fatka, TV4)</image:caption>
    </image:image>
    <image:image>
      <image:loc>http://animal.org.il/wp-content/gallery/goose/goose-foie-gras.jpg</image:loc>
      <image:title>כך מייצרים כבד אווז</image:title>
      <image:caption>על מנת לייצר &lt;a href="http://anonymous.org.il/cat14.html" target="_blank"&gt;כבד אווז&lt;/a&gt;, מפטמים את האווז באמצעות החדרת צינור מתכת לגרונו.</image:caption>
    </image:image>
  </url> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-30T18:42:59.000

默认情况下，您使用的验证服务似乎使用[http://www.sitemaps.org/schemas/sitemap/0.9/sitemap.xsd](http://www.sitemaps.org/schemas/sitemap/0.9/sitemap.xsd)上的站点地图架构来验证站点地图文档。该架构具有与您的`image:image`元素匹配的通配符，但这些元素在[http://www.google.com/schemas/sitemap-image/1.1/sitemap-image.xsd](http://www.google.com/schemas/sitemap-image/1.1/sitemap-image.xsd)的单独架构文档中声明，而不是在架构中正在使用。正如错误消息所说，所讨论的通配符是“严格”通配符，这意味着它匹配的元素必须在模式中声明。

可能有一种方法可以告诉验证器查阅图像名称空间的模式文档，但我看不到任何明显的方法。您可以向站点地图文档添加一个`xsi:schemaLocation`属性，因此您的根元素如下所示：

```
<urlset xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
  xmlns="http://www.sitemaps.org/schemas/sitemap/0.9" 
  xmlns:image="http://www.google.com/schemas/sitemap-image/1.1"
  xsi:schemaLocation="
    http://www.sitemaps.org/schemas/sitemap/0.9
    http://www.sitemaps.org/schemas/sitemap/0.9/sitemap.xsd
    http://www.google.com/schemas/sitemap-image/1.1
    http://www.google.com/schemas/sitemap-image/1.1/sitemap-image.xsd" > 
```

这通常不是告诉模式验证器在哪里找到模式的最佳方法，但它通常有效。但是，在这种情况下不是。

另一方面，对于您上传的文档，您使用的验证服务还允许您上传架构文档。如果您为站点地图和站点地图图像命名空间（如下所示）创建一个仅导入您想要的两个架构文档的架构文档，并将其与站点地图一起上传，则图像元素的错误就会消失。如果您是从 Web 验证站点地图，而不是通过上传它，则可能有另一种方法可以让验证器使用正确的模式；您必须查找文档或向服务的运营商索取信息。

```
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema">

  <xs:import namespace="http://www.sitemaps.org/schemas/sitemap/0.9"
             schemaLocation="http://www.sitemaps.org/schemas/sitemap/0.9/sitemap.xsd"/>
  <xs:import namespace="http://www.google.com/schemas/sitemap-image/1.1"
             schemaLocation="http://www.google.com/schemas/sitemap-image/1.1/sitemap-image.xsd"/>

</xs:schema> 
```

取而代之的是，您有抱怨该`image:caption`元素的错误，该元素应该在，而不是在之后`image:title`。修复后，您的站点地图将被识别为有效。

# html - 平滑的画布素描而不清除（重绘）

> ID：14078230
> 
> 赞同：1
> 
> 时间：2012-12-29T02:38:37.233
> 
> 标签：html, canvas, html5-canvas, smoothing

我正在尝试找到一种方法来平滑草图点以获得更清晰的结果。我找到了这个例子，结果看起来还不错

我找到了一些使用三次曲线来平滑边缘的方法，但所有这些方法都需要从头开始重新绘制线条，因为它们使用多个点。

我最初的想法是在有足够的点来计算贝塞尔曲线时“绘制”线的最后“部分”（在取点后只需 2 帧），以克服每次“重绘”的需要。

任何有关此的想法/解决方法将不胜感激。

谢谢！

# python - Python搁置错误-声明NoneType，但对象*存在*

> ID：14078231
> 
> 赞同：2
> 
> 时间：2012-12-29T02:38:59.733
> 
> 标签：python, shelve, nonetype

我刚刚遇到了一个完全奇怪的错误。我将选择的东西保存到一个文件中。其中之一是一个名为 Tracker 的类的版本，这个副本称为 tracker。

```
 file = shelve.open(worldname, 'n')

        file['Terramap'] = terramap
        file['Satmap'] = satmap
        file['Gasmap'] = gasmap
        file['Planetset'] = planetset
        file['World'] = minimap
        file['Picture'] = picturemap                                    
        file['Worlddata'] = worlddata
        file['Dimension'] = dimension
        print "check", len(tracker.families)
        file['Tracker'] = tracker
        file['Schedule'] = schedule
        file['Time'] = time
        file.close() 
```

如果我让它在文件之前从跟踪器打印一些东西，纯粹是为了测试该跟踪器仍然存在，它确实可以检测到跟踪器。但随后单行，它出现了：

```
 File "C:\Users\Mark\Desktop\Ultima Ratio Regum\URR0-2-1.py", line 17522, in world_menu
    file['Tracker'] = tracker
  File "C:\Python27\lib\shelve.py", line 132, in __setitem__
    p.dump(value)
TypeError: expected string or Unicode object, NoneType found 
```

我只是……难住了。这以前从未发生过，我不明白这是怎么回事！任何人都可以对此有所了解吗？我今天所做的只是向跟踪器添加一些东西，但跟踪器只真正存储字符串列表，最多几千个，但仅此而已。但是，如果我让它在保存开始之前创建一个新的跟踪器，它保存得很好。

编辑：

运行 pickle.dumps(tracker) 显示：

```
 File "C:\Users\Mark\Desktop\Ultima Ratio Regum\29-12-test.py", line 17515, in world_menu
    pickle.dumps(tracker)
  File "C:\Python27\lib\pickle.py", line 1374, in dumps
    Pickler(file, protocol).dump(obj)
  File "C:\Python27\lib\pickle.py", line 224, in dump
    self.save(obj)
  File "C:\Python27\lib\pickle.py", line 286, in save
    f(self, obj) # Call unbound method with explicit self
  File "C:\Python27\lib\pickle.py", line 725, in save_inst
    save(stuff)
  File "C:\Python27\lib\pickle.py", line 286, in save
    f(self, obj) # Call unbound method with explicit self
  File "C:\Python27\lib\pickle.py", line 649, in save_dict
    self._batch_setitems(obj.iteritems())
  File "C:\Python27\lib\pickle.py", line 663, in _batch_setitems
    save(v)
  File "C:\Python27\lib\pickle.py", line 286, in save
    f(self, obj) # Call unbound method with explicit self
  File "C:\Python27\lib\pickle.py", line 600, in save_list
    self._batch_appends(iter(obj))
  File "C:\Python27\lib\pickle.py", line 615, in _batch_appends
    save(x)
  File "C:\Python27\lib\pickle.py", line 286, in save
    f(self, obj) # Call unbound method with explicit self
  File "C:\Python27\lib\pickle.py", line 725, in save_inst
    save(stuff)
  File "C:\Python27\lib\pickle.py", line 286, in save
    f(self, obj) # Call unbound method with explicit self
  File "C:\Python27\lib\pickle.py", line 649, in save_dict
    self._batch_setitems(obj.iteritems())
  File "C:\Python27\lib\pickle.py", line 663, in _batch_setitems
    save(v)
  File "C:\Python27\lib\pickle.py", line 286, in save
    f(self, obj) # Call unbound method with explicit self
  File "C:\Python27\lib\pickle.py", line 748, in save_global
    (obj, module, name))
PicklingError: Can't pickle <built-in method capitalize of str object at 0x0A1341C0>: it's not found as __main__.capitalize 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T02:49:55.727

该异常来自 的内部`cPickle.Pickler.dump`，但由于它位于已编译的 C 模块中，因此它没有出现在回溯中。要了解错误是什么，请尝试手动触发相同的事情，但使用纯 Python`pickle`模块而不是编译的 C`cPickle`模块：

```
import pickle
pickle.dumps(tracker) 
```

这应该揭示错误在哪里。我的第一个猜测是您的实现`__reduce_ex__`or`__reduce__`不返回值。

# java - 用户访问系统时如何使动作默认运行

> ID：14078233
> 
> 赞同：0
> 
> 时间：2012-12-29T02:39:39.787
> 
> 标签：java, tomcat, struts2, action

我想在用户访问我的网站时默认运行一个动作。

这是一个用和开发的经典`Java EE`项目。我知道如何在 web.xml 中执行此操作：`Struts2``Tomcat`

```
<welcome-file-list>
    <welcome-file>index.jsp</welcome-file>
</welcome-file-list> 
```

但是，我想通过 Struts2 的动作来做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T03:03:48.857

试试这个代码，看看它是否有效。

```
 <action name="index" class="myaction">
     <result>/index.jsp</result>
 </action> 
```

你也可以试试这个。

```
<welcome-file-list>
    <welcome-file>/myfolder/index.action</welcome-file>
</welcome-file-list> 
```

另一种方法是在您的索引 jsp 中是您做这样的事情

```
<% response.sendRedirect("home.do"); %> 
```

但我不认为这是一个合适的方法

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T21:22:05.320

另一种选择是使用`default-action-ref`标签来指示在发出不映射到任何操作的请求时要调用的默认操作。

```
<default-action-ref name="home"/>

<action name="home" class="myaction">
  <result>/WEB-INF/jsp/home.jsp</result>
</action> 
```

# jquery - 不能在一个页面加载中两次提交相同的表单（通过 jQuery 和 AJAX）

> ID：14078236
> 
> 赞同：0
> 
> 时间：2012-12-29T02:40:07.583
> 
> 标签：jquery, ajax, forms, input, submit

我正在为我的服务器管理应用程序编写一个模拟终端网页。基本上，使用 jquery、ajax 和 php 的 shell_exec()，我正在模拟一个终端。

终端的输入行基本上只是一个`input`包裹在表单中的元素。有一个 jquery 处理程序在提交表单时触发 ajax 请求（按下回车键）。

当我第一次提交它时一切正常（当我发送第一个命令时）。但是，一旦我尝试发送第二个，页面一直滚动到顶部并且表单没有提交。

这是jQuery：

```
$("#terminal-form").unbind('submit').submit(function() {
            var current_dir = $("#path").text();
            var command = $("#terminal-input").val();
            $.ajax({
                url: "terminal.php",
                type: "post",
                data: { current_dir: current_dir, command: command },
                dataType: 'json',
                success: function(data) {
                    $("#terminal table").remove();
                    $("#terminal").append("root@gallactica:" + current_dir + " $ " + command + "<br>");
                    if (data['output'] != '') {
                        $("#terminal").append(data['output'] + "<br>");
                    }
                    $("#terminal").append("<table class='terminal-content'><tr><td nowrap='nowrap' style='overflow:auto;whitespace:nowrap'>root@gallactica:" + data['wd'] + "$<td style='width:99%'><form style='margin:0px;padding:0px' id='terminal-form'><input id='terminal-input' type='text'></input></form></td></tr></table>");
                    $("#terminal-input").focus();
                }
            })
            return false;
        }) 
```

处理程序基本上只是删除旧`success`表单并以纯文本形式插入结果，基本上给人一种它都是交互式的错觉。

这是 PHP 后端：

```
<?php

$current_dir = $_POST['current_dir']; // get current directory
$command = $_POST['command']; // get the command to run
chdir($current_dir); // change into the right directory

if (substr($command, 0, 2) == "cd") {
    chdir(substr($command, 3));
    $output = "";
} else {
    $output = shell_exec($command); // get the command's output
}

$wd = shell_exec('pwd'); // get the current working directory
$result = array('wd' => $wd, 'output' => $output); // create array
$result = json_encode($result); // convert to json for jquery
echo $result; 
```

问题是当我去提交第二个命令时。我什至认为表单提交不正确。我做了一些谷歌搜索，发现您需要取消绑定处理程序，我正在这样做，但它仍然无法正常工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T02:47:39.680

一旦你替换了一个元素，你就会失去它的事件处理程序，即使你用完全相同的 html 替换。您看到的是默认浏览器方法提交的表单，这导致页面重新加载

为了解决这个问题，您可以委托提交处理程序，以便将来加载的表单也可以使用

```
$(document).on('submit', "#terminal-form",function() {
   /* handler code*/
}) 
```

这会将处理程序绑定到`document`始终存在的处理程序，并且仅针对您的特定表单的 ID。不会干扰页面中的任何其他表单提交处理程序

# php - 在 pastebin URL 上调用 file() 失败，但在本地文件或 google.com 上它可以工作

> ID：14078237
> 
> 赞同：0
> 
> 时间：2012-12-29T02:40:31.900
> 
> 标签：php, fopen, remote-server, pastebin

我正在编写一些依赖于碰巧托管在pastebin 上的远程文件的PHP 代码。我正在使用的服务器启用了所有必要的功能，因为使用`FILE_URL`set 运行它会`http://google.com`返回预期的结果。我还通过`php.ini`额外的措施进行了验证。

一切都**应该**工作，但事实并非如此。调用`file()`这样形成的 URL `http://pastebin.com/raw.php?i=<paste id here>`，会返回 500 服务器错误。对本地或 google.com 上托管的完全相同的文件执行相同操作会返回合理的结果。

我已经验证了 URL 设置为正确的值，并验证了远程页面是我认为的位置。我不知所措。

```
ini_set("allow_url_fopen", true);
// Prefer remote (up-to-date) file, fallback to local file
if( ini_get("allow_url_fopen") ){
    $file = file( FILE_URL );
}
if(!isset( $file ) || !$file ) {
    $file = file( LOCAL_FILE_PATH );
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T02:58:13.577

我无法对此进行测试，但您应该使用 curl，尝试以下操作：

```
<?php
$url = "http://pastebin.com/2ZdFcEKh";
$ch = curl_init($url);
curl_setopt($ch, CURLOPT_USERAGENT, $_SERVER['HTTP_USER_AGENT']);
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true);
curl_exec($ch); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T03:04:28.543

Pastebin 似乎使用了一种保护系统，该系统会自动阻止发出“类似机器人”的请求的 IP 地址。

在您的示例中，您将收到 500 服务器错误，因为该`file()`命令永远不会完成（因为他们的保护系统永远不会关闭连接）并且您的呼叫中没有超时设施。该脚本可能被认为是“类机器人”，因为`file()`它不会通过典型浏览器会通过的所有标准 HTTP 标头。

为了解决这个问题，我建议研究[cURL](http://php.net/manual/en/book.curl.php)并可能考虑[将浏览器用户代理设置](http://davidwalsh.name/set-user-agent-php-curl-spoof)为授予对脚本的访问权限的起点。我还应该提到，调查这是否被视为违反 Pastebin 用户协议符合您的利益。[虽然我在他们的常见问题解答](http://pastebin.com/faq)（截至 2012 年 12 月 29 日）中看不到任何关于使用脚本的参考，但他们安装了针对脚本的保护是有原因的。

# ios - UICollectionView 与 iCarousel（连续循环、捕捉等）

> ID：14078238
> 
> 赞同：1
> 
> 时间：2012-12-29T02:40:44.793
> 
> 标签：ios, uicollectionview, icarousel

我需要制作一个内容连续循环的集合视图。因此，例如，如果单元格项目具有整数 1 到 10，那么当您点击 10 时，列表中的下一个项目是 1，因此没有停止点。

如果不进行子类化和进行一些自定义偏移操作，我看不到一个简单的方法。这让我觉得 iCarousel 可能是一个更好的解决方案。

我还需要将单元格对齐到中心，进行某种选择，并操纵该单元格的外观，iCarousel 似乎处理得很好。

我唯一的问题是，似乎使用 UICollectionView 是一种更好的方法，而且我已经阅读了一些关于 iCarousel 是一种糟糕方法的（似乎是不经意的）评论。

有没有办法用 UICollectionView 来做这些事情，或者 iCarousel 是解决这些问题的好组件/方法吗？

干杯!

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T03:27:42.407

我假设您可以像使用表格视图一样执行此操作。您为 numberOfItemsInSection 返回一个非常大的数字，然后在 cellForItemAtIndexPath: 中使用模运算符将该数字转换为 0 到 9 之间的数字：

```
cell.label.text = [self.theData objectAtIndex:indexPath.row % 10]; 
```

我不太确定如何执行“将单元格对齐到中心”的操作，但在 WWDC 2012 会议 219 - Advanced Collection Views and Building Custom Layouts 中有一个示例。

# c++ - 无法让 boost/asio 运行

> ID：14078239
> 
> 赞同：1
> 
> 时间：2012-12-29T02:40:48.353
> 
> 标签：c++, serial-port, boost-asio

我正在尝试使用 boost/asio 与串行端口通信。这是我的代码。

调用函数头文件包含以下内容：

```
 QserialPort *SerialPort; 
```

调用函数：

```
 std::string port = "com1";
    SerialPort = new QserialPort(port); 
```

类头文件包含以下代码：

```
 /* 
    * File:   QserialPort.h
    *
    * Created on December 13, 2012, 9:01 PM
    */

    #ifndef QSERIALPORT_H
    #define QSERIALPORT_H

    #include "global_variables.h"
    #include <windows.h>
    #include <winbase.h>
    #include <winsock2.h>
    #include <boost/system/error_code.hpp>
    #include <boost/system/system_error.hpp>
    #include <boost/asio.hpp>
    #include <boost/asio/serial_port.hpp>
    #include <QString>

    #define rcvBufSize 512
    #define xmtBufSize 512

    class QserialPort {
    public:
        QserialPort(std::string comPort);
        virtual ~QserialPort();
    private:
        // variables
        int m_a;
        double m_b;
        const char* m_c;
        boost::asio::io_service m_io;
        boost::asio::serial_port m_serialPort;
        char m_rcvMsg[rcvBufSize];
        char m_xmtMsg[xmtBufSize];

        // functions

    };

    #endif   /* QSERIALPORT_H */ 
```

类源代码有这个构造函数：

```
 QserialPort::QserialPort(std::string comPort) :
    m_io(),
    m_serialPort(m_io, comPort)
    {
        QString msg;
        char buf[100];
        sprintf(buf, "Serial port is on %s", comPort);
        msg.append(buf);
        QMessageBox::information(NULL, "debug", msg);
    } 
```

该程序编译正常，但是当我尝试运行它时，我在弹出窗口中收到此错误：

```
This application has requested the Runtime to teminate it in an unusual way.
Please contact the application's support team for more information. 
```

这是 netbeans 的运行输出选项卡中的内容：

```
terminate called after throwing an instance of 
'boost::exception_detail::clone_impl<boost::exception_detail::error_info_injector
<boost::system::system_error> >'
  what():  open: The system cannot find the file specified
Unable to open SCSI controller 0:[\] , error code: 0x5
Unable to open SCSI controller 1:[\] , error code: 0x5

RUN FAILED (exit value 3, total time: 15s) 
```

这些是我正在关注的示例：

*   [http://www.ce.unipr.it/people/medici/boost_asio_serial_port.html](http://www.ce.unipr.it/people/medici/boost_asio_serial_port.html)
*   [http://boost.2283326.n4.nabble.com/Simple-serial-port-demonstration-with-boost-asio-asynchronous-IO-td2582657.html](http://boost.2283326.n4.nabble.com/Simple-serial-port-demonstration-with-boost-asio-asynchronous-I-O-td2582657.html)
*   [http://www.webalice.it/fede.tft/serial_port/serial_port.html](http://www.webalice.it/fede.tft/serial_port/serial_port.html)

我的系统：

```
Windows Vista Home Premium Service Pack 2
Netbeans 7.2.1
QtSDK 1.2.1
Boost 1.52.0 
```

我需要做什么才能让它运行。

# profiling - 使用 JConsole 分析 Camel 路线

> ID：14078241
> 
> 赞同：2
> 
> 时间：2012-12-29T02:40:50.743
> 
> 标签：profiling, apache-camel, jmx, jconsole

我有一个包含许多骆驼路线的应用程序；我需要使用 JConsole 对它们进行分析。我注意到在启动 JConsole 并选择运行这些 Camel 路由的本地 JVM 时；域名 org.apache.camel 下的各种 MBean 显示有关端点、处理器、路由等的信息。注意：我没有设置链接[Camel JMX上给出的任何说明](http://camel.apache.org/camel-jmx.html#CamelJMX-HowtousetheJMXNotificationListenertolistenthecamelevents?)

我想知道这些指令在后一种情况下的信息显示会有什么不同？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T22:55:11.047

> 默认情况下，JMX 检测代理在 Camel 中启用，这意味着 Camel 运行时创建 MBean 管理对象并将其注册到 VM 中的 MBeanServer 实例。这使 Camel 用户可以立即深入了解 Camel 路线如何执行到单个处理器的级别。
> 
> 受支持的管理对象类型是端点、路由、服务和处理器。除了性能计数器属性之外，其中一些管理对象还公开生命周期操作。

您引用的另一个链接描述了如何以编程方式为 JMX 事件创建侦听器......

# javascript - Array 返回错误的实例

> ID：14078242
> 
> 赞同：1
> 
> 时间：2012-12-29T02:40:53.340
> 
> 标签：javascript

我有一个简单的检查来查看一组特定的键是否是一个数组，如果不是创建它，但由于某种原因 if 语句返回错误，这就是我想要做的：

```
//test data
var i = 0;
var map = new Array(); 
var Data[i]['x'] = 6;
var Data[i]['y'] = 7;

if(!map[Data[i]['x']] instanceof Array){
   map[Data[i]['x']] = new Array();
}

if(!map[Data[i]['x']][Data[i]['y']] instanceof Array){ //error on this line
   map[Data[i]['x']][Data[i]['y']] = new Array();
} 
```

错误是：

`Uncaught TypeError: Cannot read property '6' of undefined`

此错误发生在第二个 IF 语句上。我在这里犯了什么错误？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T02:49:55.467

在第一个`if`声明中：

```
if(!map[Data[i]['x']] instanceof Array) 
```

被解析为：

```
if((!map[Data[i]['x']]) instanceof Array) 
```

在那一点上，`map[6]`未定义，所以`!map[6]`是`true`，并且`true`不是的实例`Array`。所以它不会将其设置为`new Array()`.

将其更改为：

```
if (!(map[Data[i]['x']] instanceof Array)) 
```

# iphone - Facebook sdk 3.0 与 iOS 5 和 Xcode 4.2

> ID：14078245
> 
> 赞同：4
> 
> 时间：2012-12-29T02:41:42.110
> 
> 标签：iphone, ios, xcode, facebook

我制作 iOS 应用程序已经有一段时间了，对此我很满意。我没有做的是在我的任何应用程序中添加 Facebook 连接。

我今天要寻找的是如何将 Facebook SDK 3.0 与运行 Xcode 4.2 的 iOS 5.0 集成的教程。在我的研究中，我发现 3.0 与 Xcode 4.2 兼容。我还没有准备好迁移到 iOS 6.0 和 Xcode 4.5。

所以我的问题是那里有任何教程可以逐步指导我如何将 Facebook skd 3.0 与在 Xcode 4.2 上运行的 iOS 5 集成？

我一直在寻找这些规范的教程；我找到的只是 iOS 6 和 Facebook SDK 3.1 的教程和说明。

到目前为止我能做的是

*   从此链接下载 Facebook SDK 3.0 [http://developers.facebook.com/ios/downloads/](http://developers.facebook.com/ios/downloads/)
*   我在 Facebook 开发者帐户上注册并创建了一个示例项目 AppID
*   我尝试使用 Facebook sdk 编译一个全新的 Xcode 项目，但这就是我开始遇到问题的地方。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T02:55:33.037

本教程展示了如何集成 Facebook SDK 3.0 来上传法规和发布图片到用户墙。希望这会有所帮助：http: [//xcodenoobies.blogspot.com/2012/09/how-to-upload-photo-and-update-status.html](http://xcodenoobies.blogspot.com/2012/09/how-to-upload-photo-and-update-status.html)

您可以通过单个 fql 请求检索您（或用户）的 Facebook 朋友的生日。

您可以在此处阅读有关 fql 的信息：http: [//developers.facebook.com/docs/reference/fql/](http://developers.facebook.com/docs/reference/fql/)

但这里有一些代码供参考（此代码在定义为 FBSessionDelegate 和 FBRequestDelegate 的类中）

```
- (void)request:(FBRequest *)request didLoad:(id)result {
    // result is a NSDictionary of your friends and their birthdays!
}

- (void)fbDidLogin {
    //some best practice boiler plate code for storing important stuff from fb
    NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
    [defaults setObject:[facebook accessToken] forKey:@"FBAccessTokenKey"];
    [defaults setObject:[facebook expirationDate] forKey:@"FBExpirationDateKey"];
    [defaults synchronize];

    //now load all my friend's birthdays
    NSMutableDictionary * params = 
                         [NSMutableDictionary dictionaryWithObjectsAndKeys:
                         @"select birthday, name, uid, pic_square from user where uid in (select uid2 from friend where uid1=me()) order by name", 
                         @"query",
                         nil];

    [self.facebook requestWithMethodName: @"fql.query" andParams: params andHttpMethod: @"POST" andDelegate: self];
}

- (void) loginWithFacebook {
    self.facebook = [[[Facebook alloc] initWithAppId:@"<your app id here>" andDelegate:self] autorelease];
    //IMPORTANT - you need to ask for permission for friend's birthdays
    [facebook authorize:[NSArray arrayWithObject:@"friends_birthday"]];
} 
```

# ios - iOS中交互式2D编程方式的最佳实践

> ID：14078246
> 
> 赞同：0
> 
> 时间：2012-12-29T02:42:04.123
> 
> 标签：ios, canvas, diagram, quartz-2d, draw2d

我想创建一个图表应用程序，我可以创建一些形状。每个形状都可以在画布中移动。实施它的最佳方法是什么？现在我知道只有两种方式：

1.  仅使用 UIView，在此 UIView 中绘制所有形状。当触摸事件到达时，重绘所有内容。
2.  为每个Shape创建一个UIView，每个UIView可以独立响应UIEvent

有没有其他好办法？第一个太复杂了。第二个似乎表现不佳？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T19:24:08.317

两者都行，但各有利弊。具体来说：

1.  **Single`UIView`**：这种方法需要您`CALayer`为每个形状创建一个，然后在移动形状时进行自己的点击测试和手指拖动。如果您有许多形状（确保使用索引查找来进行命中测试而不是 O(N) 搜索），这种方法将执行得更好，因为`CALayer`s 是轻量级的。
    *   不要采取`UIView`通过单次调用在其当前位置绘制形状的方法`drawRect:`。这将表现*得非常糟糕*，尤其是当您在拖动过程中移动形状时，并且正如您所指出的那样，实现起来非常复杂
2.  **`UIView`每个形状一个**：这种方法很容易编程，因为您不必进行命中测试并将触摸发送到被触摸的形状。如果您有几个形状（根据我的经验，<30），这种方法将表现良好。如果您有大量形状，您就会开始看到帧速率问题。

# c++ - 我们可以说没有别名，指针和引用是完全一样的吗

> ID：14078251
> 
> 赞同：0
> 
> 时间：2012-12-29T02:43:05.730
> 
> 标签：c++, pointers, reference

> **可能重复：**
> [C++ 中的指针变量和引用变量有什么区别？](https://stackoverflow.com/questions/57483/what-are-the-differences-between-pointer-variable-and-reference-variable-in-c)

性能方面和功能方面？

这意味着，如果您想在函数调用期间修改某个指针指向的某些数据的内容，传递指针参数的工作方式与传递引用参数完全相同？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T02:46:09.537

在性能方面，引用的性能略好于指针。这与某些情况下需要的指针调整有关，例如当*多重继承*到位时。当转换后的指针为*null*时，必须反转调整（或根本不进行）以使指针保持为*null*。引用不能为*空*的事实意味着不需要额外的检查。

在功能方面，指针可以为*空*，而引用不能，指针可以重新分配，而引用不能。除了访问它们的基本不同语法。

所以基本上不，它们不完全相同。

# php - 隐藏输入更改值时播放音频

> ID：14078255
> 
> 赞同：-1
> 
> 时间：2012-12-29T02:44:22.460
> 
> 标签：php, jquery, ajax

当隐藏的输入字段更改值时，我需要播放音频文件。这个隐藏的输入是`<table>`由 Ajax 刷新以更新值的。

我需要做的是，（例如）当值变为是时`Clap.wav`需要播放，否则，当值变为否时`boo.wav`必须播放。

任何人都可以给我一个示例代码或一个想法？感谢那些愿意提供帮助的人。

这是我的一些代码

这是隐藏的输入域代码。它位于表上，id 为`connExcel`on Platinum.php

```
<input type="hidden" name="indVal" id="indVal" value=" <?php echo $objWorksheet->getCellByColumnAndRow(5, 5)->getOldCalculatedValue();  ?> "> 
```

这是我的一些 Ajax 代码

```
xmlHttp.onreadystatechange=function(){ 
    if(xmlHttp.readyState==4){ 
    document.getElementById('connExcel').innerHTML=xmlHttp.responseText;
        setTimeout('AutoRefresh()',100); // JavaScript function calls AutoRefresh() every 3 seconds
    }
}
xmlHttp.open("GET","<?php if( isset( $isAdmin ) &&  $isAdmin == TRUE ){ echo  '../../library/tosloader.php?page='. $pageID; } else {  echo  ../library/tosloader.php?page='. $pageID; }  ?>",true); 
```

'tosloader.php' 只包括用于刷新表格的 Platinum.php。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T02:57:39.673

***[jsBin 演示](http://jsbin.com/eqigiy/2/edit)***

HTML：

```
<input id="inp" type="text" value="NO" /> 
```

JS：

```
function checkInputValue(){

    var files = { "YES": "Clap.wav", "NO": "boo.wav" };
    var sound = new Audio( files[ $('#inp').val() ] );
    sound.play();

}

checkInputValue(); // USE WHEREVER YOU LIKE 
```

**或者你可以这样做：**

命名您的文件：`yes.wav`和`no.wav`

```
function checkInputValue( snd ){
    var sound = new Audio( snd+'.wav');
    sound.play();     
}

var AJAXval = ("YES").toLowerCase() ; // the returned value to lowercase
checkInputValue( AJAXval ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T03:00:58.793

听起来您正在从 DOM 中完全添加和删除元素，因此您需要观看该`DOMNodeInserted`事件。幸运的是，我们可以绑定到它。我们假设隐藏的输入有一个`hiddenInput`. 然后我们需要获取我们的源元素，恰当地命名`<source id="yesAudio"..../>`，`<source id="noAudio".../>`我们将使用 jquery 的`.get()`方法，然后使用 HTML5 音频 api`.play();`来调用它们。

```
$(document).on('DOMNodeInserted', function(e){
    if(e.srcElement.className == 'hiddenInput'){
        if(e.srcElement.value == 'yes'){
            $('#yesAudio').get().play();    
        }else{
            $('#noAudio').get().play();
        }
    }        
});​​​​​ 
```

我想这就是你想要的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T02:54:40.907

在设置隐藏输入值的代码中执行此操作

```
$('#myHiddenID').val(myValue).trigger('change'); 
```

然后像这样使用更改事件

```
$('#myHiddenID').change(function(){
     var OnOff = $(this).val();
     if (OnOff == "ON") { // play clap}
     if (OnOff == "OFF) { //play boo}
}) 
```

# mysql - MySql 5 & LINQ to Entities EF 4 在跨网络查询时导致“对象必须实现 IConvertible”

> ID：14078265
> 
> 赞同：2
> 
> 时间：2012-12-29T02:47:38.897
> 
> 标签：mysql, asp.net-mvc-3, entity-framework-4, linq-to-entities, connector-net

在 2 个不同的 MySql 安装上使用相同的 MVC 3 和 C# 代码以及相同 MySql 5.5 数据库的副本时。一个工作完美，而另一个失败并出现“对象必须实现 IConvertible”错误。当我对本地 PC 的 MySql 安装运行查询时，查询始终运行良好，但是当我尝试从本地 PC 的 Visual Studio 2010 查询到我的 Internet 服务提供商的 MySql 安装的同一数据库的副本时，我收到错误“对象必须实施 IConvertible”。我在代码中唯一更改的是 web.config 中的 ConnectionString 的服务器名称，否则代码和数据库完全相同。注意：对 ISP 的 MySql 安装的所有其他查询都可以正常工作，只有这个特定的查询不起作用。

在尝试解决此问题几天后，我确信错误消息“对象必须实现 IConvertible”与实际发生的事情无关，而且我还认为我的 ISP 上的 MySql 配置可能以某种方式导致这个问题的原因如下：

1.  如果这确实是代码中的“对象必须实现 IConvertible”问题，那么无论我安装哪个数据库，该问题都会持续存在于代码中。

2.  我已经完全从本地 PC 的工作副本中删除并在 ISP 处重新创建了数据库，但仍然收到完全相同的错误。

3.  最有趣的是，该查询有 3 个嵌套的 IEnumerable 列表，它们的设置方式与 IEnumerables 相同，如果我在查询中注释掉这些嵌套列表中的任何 1 个，则查询会针对 ISP 的数据库成功运行。哪个嵌套列表被注释掉并不重要，只要有 2 个或更少的嵌套列表，然后对 ISP 的数据库的查询就可以工作。这就是让我得出结论，MySql 在 ISP 的配置可能会以某种方式限制我的查询，因为在查询本地 PC 的 MySql 安装时我没有这个问题。错误消息似乎并不适用于实际发生的事情。同样，对 ISP 的 MySql 安装的所有其他查询都可以正常工作，但是它们都不包含超过 2 个嵌套的 IEnumerable 列表，其中这个特定查询包含 3 个？

**查询错误“对象必须实现 IConvertible”**

```
 Server Error in '/' Application.
    ________________________________________
    Object must implement IConvertible. 
    Description: An unhandled exception occurred during the execution of the current web request.             Please review the stack trace for more information about the error and where it originated in the code. 

    Exception Details: System.InvalidCastException: Object must implement IConvertible.

    Source Error: 

    Line 392:
    Line 393:
    Line 394:            var query =
    Line 395:                  (from p in db.products
    Line 396:                   where p.ClientId == clientId

    Source File: C:\Users\JR\Documents\Visual Studio 2010\Projects\Subversion\ReservarMVC\ReservarMVC\Models\ProductRepository.cs    Line: 394 

    Stack Trace: 

    [InvalidCastException: Object must implement IConvertible.]
    System.Convert.ChangeType(Object value, Type conversionType, IFormatProvider provider) +9528453
    MySql.Data.Entity.EFMySqlDataReader.ChangeType(Object sourceValue, Type targetType) +566
    MySql.Data.Entity.EFMySqlDataReader.GetValue(Int32 ordinal) +231
    System.Data.Common.Internal.Materialization.ErrorHandlingValueReader`1.GetValue(DbDataReader reader, Int32 ordinal) +215
    System.Data.Common.Internal.Materialization.Shaper.GetColumnValueWithErrorHandling(Int32 ordinal) +46
    lambda_method(Closure , Shaper ) +180
    System.Data.Common.Internal.Materialization.Coordinator`1.ReadNextElement(Shaper shaper) +170
    System.Data.Common.Internal.Materialization.RowNestedResultEnumerator.MoveNext() +235
    System.Data.Common.Internal.Materialization.ObjectQueryNestedEnumerator.TryReadToNextElement() +49
    System.Data.Common.Internal.Materialization.ObjectQueryNestedEnumerator.ReadElement() +29
    System.Data.Common.Internal.Materialization.ObjectQueryNestedEnumerator.MoveNext() +68
    System.Collections.Generic.List`1..ctor(IEnumerable`1 collection) +327
    System.Linq.Enumerable.ToList(IEnumerable`1 source) +58
    ReservarMVC.Models.ProductRepository.GetProductList(Nullable`1 dateStart, Nullable`1    dateEnd,         Nullable`1 personQuantityId, Nullable`1 roomQuantityId) in C:\Users\JR\Documents     \Visual      Studio 2010\Projects\Subversion\ReservarMVC\ReservarMVC\Models\ProductRepository.cs:394
    ReservarMVC.Models.ProductRepository.GetProductListSearch(Nullable`1 dateStart, Nullable`1 dateEnd, Nullable`1 personQuantityId, Nullable`1 roomQuantityId) in C:\Users\JR\Documents\Visual Studio 2010\Projects\Subversion\ReservarMVC\ReservarMVC\Models\ProductRepository.cs:605
    ReservarMVC.Controllers.PortalController.MyExcurcion(ProductListSearchVM viewModel) in C:\Users\JR\Documents\Visual Studio 2010\Projects\Subversion\ReservarMVC\ReservarMVC\Controllers\PortalController.cs:63
     lambda_method(Closure , ControllerBase , Object[] ) +162
     System.Web.Mvc.ActionMethodDispatcher.Execute(ControllerBase controller, Object[] parameters) +17
     System.Web.Mvc.ReflectedActionDescriptor.Execute(ControllerContext controllerContext, IDictionary`2 parameters) +208
      System.Web.Mvc.ControllerActionInvoker.InvokeActionMethod(ControllerContext controllerContext, ActionDescriptor actionDescriptor, IDictionary`2 parameters) +27
      System.Web.Mvc.<>c__DisplayClass15.<InvokeActionMethodWithFilters>b__12() +55
      System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodFilter(IActionFilter filter, ActionExecutingContext preContext, Func`1 continuation) +263
      System.Web.Mvc.<>c__DisplayClass17.<InvokeActionMethodWithFilters>b__14() +19
      System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodWithFilters(ControllerContext controllerContext, IList`1 filters, ActionDescriptor actionDescriptor, IDictionary`2 parameters) +191
      System.Web.Mvc.ControllerActionInvoker.InvokeAction(ControllerContext controllerContext, String actionName) +343
      System.Web.Mvc.Controller.ExecuteCore() +116
      System.Web.Mvc.ControllerBase.Execute(RequestContext requestContext) +97
      System.Web.Mvc.ControllerBase.System.Web.Mvc.IController.Execute(RequestContext requestContext) +10
      System.Web.Mvc.<>c__DisplayClassb.<BeginProcessRequest>b__5() +37
      System.Web.Mvc.Async.<>c__DisplayClass1.<MakeVoidDelegate>b__0() +21
      System.Web.Mvc.Async.<>c__DisplayClass8`1.<BeginSynchronous>b__7(IAsyncResult _) +12
      System.Web.Mvc.Async.WrappedAsyncResult`1.End() +62
      System.Web.Mvc.<>c__DisplayClasse.<EndProcessRequest>b__d() +50
      System.Web.Mvc.SecurityUtil.<GetCallInAppTrustThunk>b__0(Action f) +7
      System.Web.Mvc.SecurityUtil.ProcessInApplicationTrust(Action action) +22
      System.Web.Mvc.MvcHandler.EndProcessRequest(IAsyncResult asyncResult) +60
      System.Web.Mvc.MvcHandler.System.Web.IHttpAsyncHandler.EndProcessRequest(IAsyncResult result) +9
      System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +8967601
      System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +184

      ________________________________________
      Version Information: Microsoft .NET Framework Version:4.0.30319; ASP.NET Version:4.0.30319.261 
```

**LINQ 到实体查询：**

```
 public IEnumerable<ProductListVM> GetProductList(DateTime? dateStart, DateTime? dateEnd, int? personQuantityId, int? roomQuantityId)
    {
        var query =
              (from p in db.products
               where p.ClientId == clientId
               where p.ProductTypeId == 5 
               where personQuantityId <= p.Capacity
               where roomQuantityId <= p.Quantity
               select new ProductListVM
               {
                   ProductId = p.ProductId,
                   ClientId = p.ClientId,
                   Name = p.Name_en,
                   Title = p.Title_en,
                   Description = p.Description_en,
                   Quantity = p.Quantity,
                   Capacity = p.Capacity,
                   newbookings = from b in db.bookings 
                                 where b.ProductId == p.ProductId
                                 from res in db.reservations
                                 where b.ReseravationId == res.ReservationId
                                 where b.BookingDateTime >= dateStart && b.BookingDateTime <= dateEnd && res.ReservationStateId != 3 
                                 select new BookingVM
                                 {
                                     ProductId = b.ProductId,
                                     BookingId = b.BookingId,
                                     ClientId = b.ClientId,
                                     ReservationId = b.ReseravationId,
                                     BookingDateTime = b.BookingDateTime
                                 },                  
                   newratecategories = from prc in db.productratecategories
                                       where prc.ProductId == p.ProductId
                                       from rc in db.ratecategories
                                       where prc.RateCategoryId == rc.RateCategoryId
                                       where (dateStart >= rc.DateStart && dateEnd <= rc.DateEnd) || (dateStart >= rc.DateStart || dateEnd <= rc.DateEnd)                                           
                                       select new MegaRateCategoryVM
                                       {
                                           RateCategoryId = rc.RateCategoryId,                                               
                                           DateStart = rc.DateStart,
                                           DateEnd = rc.DateEnd                                      
                                       },
                   newproductimages = (from pi in db.productimages
                                       where pi.ProductId == p.ProductId
                                       from ig in db.imagegalleries
                                       where pi.ImageGalleryId == ig.ImageGalleryId
                                       select new MegaProductImageVM
                                       {
                                           ig_Description = ig.ig_Description,
                                           ImageGalleryId = pi.ImageGalleryId
                                       }).OrderByDescending(i => i.ImageGalleryId)
               }).ToList();

        return query;
    } 
```

**产品列表视图型号：**

```
 namespace Project.ViewModels
    {
        [Serializable]
        public class ProductListVM : BaseViewModel
        {        
            public int ProductId { get; set; }        
            public int? ClientId { get; set; }
            public int? ProductTypeId { get; set; }
            public int? ProductStateId { get; set; }
            public String Name { get; set; }        
            public String Title { get; set; }
            public String Description { get; set; }
            public int? Quantity { get; set; }
            public int? Capacity { get; set; }        

            //PRODUCTIMAGE table fields
            public IEnumerable<MegaProductImageVM> newproductimages { get; set; }

            //RATECATEGORY table fields
            public IEnumerable<MegaRateCategoryVM> newratecategories { get; set; }

            //BOOKING table fields
            public IEnumerable<BookingVM> newbookings { get; set; }       

        }

    } 
```

什么可能导致这种行为？这可能是由 MySql 5.5 的数据库配置上的查询阈值设置或网络设置引起的吗？我没有更改任何一个 MySql 5.5 安装的任何默认值。我只是使用标准的 MySql Connector/Net 6.5.4 以及 Microsoft 的标准 MVC 3、C#、Entity Framework 4、LINQ-to-Entities 代码来访问数据库。

非常感谢您对此的任何帮助。谢谢， Atlas361

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-11T22:55:25.450

要解决此问题，请在连接字符串中添加“尊重二进制标志 = false”，例如：

```
connectionString="metadata=res://*/Something.csdl|res://*/Something.ssdl|
res://*/Something.msl;provider=MySql.Data.MySqlClient;
provider connection string=&quot;server=my-server;User Id=some-user;
Persist Security Info=True;database=some-database;respect binary flags=false&quot;" 
```

这是某些版本的 MySQL 5.0 和 5.1的[已知问题](http://dev.mysql.com/doc/refman/5.0/en/connector-net-programming-binary-issues.html)

> 在某些情况下，MySQL 会返回关于一列或多列的不正确元数据...如果您的应用程序所需的更改太大，将“尊重二进制标志=false”添加到您的连接字符串会导致连接器使用先前的行为：任何标记为字符串的列，无论二进制标志如何，都将作为字符串返回。只有特别标记为 BLOB 的列才会作为 BLOB 返回。

希望这对未来的旅行者有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T03:19:43.047

我向 ISP 发布了我的 MVC 应用程序，以便消除通过 Internet 查询引起的任何潜在问题，但我仍然遇到同样的错误“对象必须实现 IConvertible”。在 Arvixe.com 完全无能的支持人员进一步排除故障后我发现他们拥有数据库的 MySql 的实际版本是 2008 年发布的 5.1.54，而不是 2010 年底发布的 MySql 5.5。根据 MySql 文档，MySql Connector/Net 6.5.4 和 Microsoft 的 Entity Framework 4 是兼容的，但我发现这不是真的。在与 Arvixe.com 争吵后将我放在 MySql 5.5 服务器上，问题就消失了。所以最后这是版本兼容性问题。

希望答案有帮助！阿特拉斯361

# php - 如何接收表单提交php中的值

> ID：14078273
> 
> 赞同：0
> 
> 时间：2012-12-29T02:48:59.200
> 
> 标签：php

```
<select name="gender" id="Gender">
<option selected="selected" value="woman">女士</option>
<option value="man">先生</option>
</select> 
```

上面的代码在表单中，当提交表单到test.php时。如何获得选中的值？女士或先生。

我知道这可以得到。

```
if($_POST['gender']=='woman'){
$_POST['gender']="女士";
}else{
$_POST['gender']="先生";
} 
```

有没有办法获取文本。谢谢你

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T02:50:41.090

使用选项文本作为选项值。像这样，

```
<option selected="selected" value="女士">女士</option>
<option value="先生">先生</option> 
```

但请记住，任何人都可以改变性别并成为其他人。

```
<option value="transexual">transexual</option> 
```

为了防止这种情况更好，您还可以在服务器端代码中维护一个白名单。

```
$gender == isset($_POST['gender'])?  $_POST['gender']: "";
if(!in_array(array("女士", "先生"), $gender)){
    $gender = "先生"; // set the default gender.
} 
```

# javascript - jQuery UI 滑块在 DIV 下方被选中

> ID：14078274
> 
> 赞同：2
> 
> 时间：2012-12-29T02:49:00.493
> 
> 标签：javascript, jquery, user-interface, slider

我可以单击下方（不是上方）的任何元素，它会根据鼠标 X 轴发生变化。这似乎是 jQuery UI 的规范，至少可以这么说。

[http://jsfiddle.net/devcurry_com/JSmWM/](http://jsfiddle.net/devcurry_com/JSmWM/)

```
 $('#musicVolume').slider({
             range: "min",
             min: 0,
             max: 100,

             change: function (event, ui) {
                 alert('Stopped at ' + ui.value);
             }
    }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T03:04:49.153

您不能`div`像在 HTML 中那样自关闭 s，因此解析器会简单地忽略`/`in`<div />`保持`div`打开状态，直到它强制关闭 the`div`之前的`</body>`（或最近`</div>`或最近的正确关闭的 that 父级`div`）。

因此，在`<div />`被捕获并成为滑块小部件的一部分并在单击时激活它之后的所有内容，包括`p`显示所选值的元素。

注意：您也不能自行关闭`p`元素 - 您可以做的是隐藏 HTML 中可选的结束标记。但是，该功能对于您的用例来说并不是很理想。
其他注意事项：`<p />`是有效的标记，`/`语法糖和`p`元素不需要结束标记，但如果[*短语内容*](http://dev.w3.org/html5/spec-LC/content-models.html#phrasing-content-0)跟随它，它不会`p`像您期望的那样生成空元素。如果你想要一个空的，用 a 正确关闭它[](http://dev.w3.org/html5/spec-LC/content-models.html#phrasing-content-0)*`</p>``p`。*

 *正确关闭您`div`的 s 和`p`s 将解决问题。[**小提琴**](http://jsfiddle.net/JSmWM/758/)*

# java - 我看不到框架内的组件

> ID：14078277
> 
> 赞同：0
> 
> 时间：2012-12-29T02:50:10.273
> 
> 标签：java, multithreading, swing, user-interface

嗨，我正在编写一个警报应用程序。我有一个贪睡课程，当警报响起时会被调用。在使用 JMF 之前它可以正常工作。但是在使用 JMF 之后，我只看到我的贪睡 UI 的外框。

我尝试为该课程启动一个新线程，但得到了相同的结果。我在这里粘贴我认为问题所在的类的代码。

请帮我解决问题。

* *IsTime 类。它检查是否到了发出警报的时间。**

```
 package alarm;  
 import java.util.Calendar;  
 import java.util.GregorianCalendar;  

 public class IsTime {  
int hrs;  
int min;  
int sec;  
GregorianCalendar clk=new GregorianCalendar();  
Calendar gtl= Calendar.getInstance();  
    mp3 mix=new mp3();  
public void makeReady(int h,int m,int s,String ampm){  
    Calendar c1=Calendar.getInstance();  
    c1.set(Calendar.HOUR_OF_DAY,h);  
    c1.set(Calendar.MINUTE, m);  
    c1.set(Calendar.SECOND,s);  
    if("PM".equals(ampm)){  
        c1.set(Calendar.AM_PM, Calendar.PM);  
        if(Calendar.getInstance().get(Calendar.AM_PM)==Calendar.PM){  
            System.out.println("now is pm");  
            if(c1.after(Calendar.getInstance())){  
                check(c1);  
            }  
            c1.set(Calendar.DAY_OF_YEAR,c1.get(Calendar.DAY_OF_YEAR)+1);  
            check(c1);  
        }  
    }  
    if(Calendar.getInstance().get(Calendar.AM_PM)==Calendar.AM){  
            System.out.println("now is am");  
            if(c1.after(Calendar.getInstance())){  
                check(c1);  
            }  
            c1.set(Calendar.DAY_OF_YEAR,c1.get(Calendar.DAY_OF_YEAR)+1);  
            check(c1);  
        }  
    if(Calendar.getInstance().get(Calendar.AM_PM)==Calendar.PM){  
        c1.set(Calendar.DAY_OF_YEAR,c1.get(Calendar.DAY_OF_YEAR)+1);  
        check(c1);  
    }  
}  
public void check(Calendar ch){  
        System.out.println("got to check");  
        System.out.println(Calendar.getInstance().get(Calendar.HOUR_OF_DAY));  
        System.out.println(ch.get(Calendar.HOUR_OF_DAY));  
        while(!(Calendar.getInstance().after(ch))){  
        }  
    Snooze snz=new Snooze();  
            snz.start();  
            mix.start();  
    }  
public void makeReady(int mis){  
        Calendar sz=Calendar.getInstance();  
        sz.set(Calendar.SECOND, 0);  
        sz.set(Calendar.MINUTE, Calendar.getInstance().get(Calendar.MINUTE)+mis);  
        check(sz);  
    }  
    } 
```

**播放歌曲的媒体类 **

```
 package alarm;  
import java.awt.Button;  
import java.awt.event.ActionEvent;  
import java.awt.event.ActionListener;  
import javax.media.*;  
import java.io.*;  
import java.net.URL;  
import javax.swing.JFileChooser;  
import javax.swing.JFrame;  

class mp3 extends Thread  
{  
private URL url;  
private MediaLocator mediaLocator;  
private Player playMP3;  
static String mp3;  
static String mp4;  
public mp3()  
{  
try{  
    System.out.println(System.getProperty("os.name"));  
    System.out.println("before"+mp3);  
    if(System.getProperty("os.name").equals("Linux")){  
        mp4="file://".concat(mp3);  
    }  
    else{  
    mp4="file:///".concat(mp3);  
    }  
    System.out.println(mp4);  
   this.url = new URL(mp4);  
   }catch(java.net.MalformedURLException e)  
      {System.out.println(e.getMessage());}  
}  
public void run()  
{  
try{  
    System.out.println(url);  
   mediaLocator = new MediaLocator(url);       
   playMP3 = Manager.createPlayer(mediaLocator);  
    }catch(java.io.IOException e)  
      {System.out.println(e.getMessage());  
    }catch(javax.media.NoPlayerException e)  
      {System.out.println(e.getMessage());}  
playMP3.addControllerListener(new ControllerListener()  
  {  
  public void controllerUpdate(ControllerEvent e)  
     {  
     if (e instanceof EndOfMediaEvent)  
         {  
         playMP3.stop();  
         playMP3.close();  
         }  
     }  
  }  
 );  
 playMP3.realize();  
 playMP3.start();  
 }   
} 
```

**真正问题所在的打盹班**

```
 package alarm;  
import java.awt.event.ActionEvent;  
import java.awt.event.ActionListener;  
import javax.swing.JButton;  
import javax.swing.JComboBox;  
import javax.swing.JFrame;  
import javax.swing.JLabel;  
public class Snooze extends Thread implements ActionListener{  
    JFrame sozef=new JFrame("Snooze");  
    JLabel tl=new JLabel("After");  
    JLabel ml=new JLabel("mins");  
    JComboBox tiec=new JComboBox();  
    JButton soo=new JButton("Snooze");  
    JButton stp=new JButton("Stop");  
        mp3 mi=new mp3();  
        Snooze sz;  
        public void run(){  
            sozef.setSize(500,700);  
        sozef.setLayout(null);  
        tl.setBounds(50,50,50,50);  
        tiec.setBounds(50,90,50,30);  
        ml.setBounds(120,90,50,50);  
        soo.setBounds(50,130,90,30);  
        stp.setBounds(50, 170, 90, 30);  
        JcAdd(tiec);  
        sozef.add(tl);  
        sozef.add(tiec);  
        sozef.add(ml);  
        sozef.add(soo);  
        sozef.add(stp);  
        soo.addActionListener(this);  
        sozef.setVisible(true);  
        sozef.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);  
        }  
    void JcAdd(JComboBox jc){  
        for(int i=0;i<=10;i++)  
            jc.addItem(Integer.toString(i));  
    }  
    public void actionPerformed(ActionEvent arg0) {  
        if(arg0.getSource()==soo){  
        int ma=Integer.parseInt(tiec.getSelectedItem().toString());  
        mi.stop();  
        IsTime sz=new IsTime();  
        sz.makeReady(ma);  
        }  
        mi.stop();  
    }  
}  ![this is the frame I see when the snooze is being called][1] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T05:16:45.760

这不是实现延迟的正确方法：

```
while(!(Calendar.getInstance().after(ch))){  
} 
```

事实上，它会导致严重的问题。

尝试计算目标日期和当前时间之间的毫秒数，并将该值传递给`Thread.sleep`. 您的电脑机箱爱好者会感谢您的。很可能是您的繁忙循环正在使 AWT 事件线程挨饿，从而阻止您的框架显示。

# android - 从触发 onclick 的视图中获取信息？

> ID：14078278
> 
> 赞同：0
> 
> 时间：2012-12-29T02:50:21.277
> 
> 标签：android, textview, gettext, settext

我对 Java 和 android 完全陌生。我结束了一个教程，我正在构建一个简单的计算器来学习绳索。

我基本上有这样的看法：

```
<button android:onClick="addText" android:text="2" /> 
```

函数 addText 是这样的：

```
public void addText(View view) { // Add view's text
    TextView calc = (TextView) findViewById(R.id.edit_text);
    t.setText( calc.getText() + ????? );
} 
```

onclick 它应该将单击按钮中的文本添加到 TextView。如果单击 1，则`calc.getText() + "1"`单击 2 it 即可`does calc.getText() + "2"`。我不知道如何获取点击视图的文本。我试过这个： `t.setText( calc.getText() + this.getText() );`这不起作用。这是怎么做到的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T02:54:28.417

你可以这样做：

```
public void addText(View view) { // Add view's text
  Button button = (Button) view; //casts the View into the Button class
  TextView calc = (TextView) findViewById(R.id.edit_text);
  t.setText(calc.getText().toString() + button.getText().toString());
} 
```

由于我们知道它[`Button`](http://developer.android.com/reference/android/widget/Button.html)是 的子类[`View`](http://developer.android.com/reference/android/view/View.html)，并且该`getText()`方法适用于按钮，因此我们可以创建一个新变量并将`View`参数`Button`通过[类转换转换](http://docs.oracle.com/javase/tutorial/java/IandI/subclasses.html)为。从那里我们可以使用所有`Button`的方法并继续执行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T13:59:33.940

另一种方法是将 TAG 对象设置为您的视图

```
Button mButtonCalcOne = (Button) findViewById(R.id.Button1);
mButtonCalcOne.setTag(1);

OnClickListener mButtonListener = new OnClickListener()
{
    @Override
    public void onClick( View v )
    {
        int lButtonValue = (Integer) v.getTag();   //DO STH WITH IT ; )
    };
}
mButtonCalcOne.setOnClickListener( mButtonListener ); 
```

# ruby-on-rails - 为什么 current_user 不能按预期工作？

> ID：14078279
> 
> 赞同：0
> 
> 时间：2012-12-29T02:50:26.163
> 
> 标签：ruby-on-rails, devise

使用 devise 进行身份验证，`undefined method 'size' for nil:NilClass`是从以下视图代码中提出的：

```
<% @relationships.each do |relationship| %>
  <div><%= relationship.box.size  %></div>
<% end %> 
```

仅当我在控制器中将@relationships 定义为

```
@relationships = current_user.relationships 
```

但不是当我将其定义为

```
@relationships = User.find(current_user.id).relationships 
```

这两个定义不应该相同吗？

我有以下关联：

```
class Relationship < ActiveRecord::Base

  belongs_to :user
  belongs_to :box

end

class User < ActiveRecord::Base

  has_many: :relationships
  has_many: :boxes, through: :relationships

end

class Box < ActiveRecord::Base

  has_many: :relationships
  has_many: :users, through: :relationships

end 
```

我希望我提供了正确的信息；这是我第一次无法找到堆栈溢出的答案。提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T16:58:50.163

我在同一操作中通过 current_user (current_user.relationships.new) 创建了另一个对象：

```
@relationship = current_user.relationships.new
@relationships = current_user.reload.relationships #reload required 
```

在对第一个分配进行以下更改后，可以删除 reload 调用：

```
@relationship = Relationship.new
@relationships = current_user.relationships 
```

特别感谢 @AmitKumarGupta 帮助新手！

# iphone - 比较两个图像是否相同（iOS）

> ID：14078283
> 
> 赞同：5
> 
> 时间：2012-12-29T02:50:45.037
> 
> 标签：iphone, objective-c, ios

> **可能重复：**
> [如何在 iPhone 上将一张图像与另一张图像进行比较以查看它们是否在一定百分比上相似？](https://stackoverflow.com/questions/6488732/how-does-one-compare-one-image-to-another-to-see-if-they-are-similar-by-a-certai)

我找到了这段代码，并试图更好地理解它：

```
UIImage *img1 = // Some photo;
UIImage *img2 = // Some photo;

NSData *imgdata1 = UIImagePNGRepresentation(img1);

NSData *imgdata2 = UIImagePNGRepresentation(img2);

if ([imgdata1 isEqualToData:imgdata2]) {
    NSLog(@"Same Image");
} 
```

这会确认图像 1 与图像 2 完全相同吗？这种方法是最佳实践，还是有更好的方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T08:08:38.307

您的代码正在逐位比较这两个图像，所以是的，这是一个 100% 的比较。

如果您需要更快的东西，您可以从每个生成一个哈希`UIImage`并比较两个哈希，如此[处](https://stackoverflow.com/a/1685319/846273)所述。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T03:13:25.923

看看这个链接，它谈到了对图像进行采样以查看相似度百分比：[如何在 iPhone 上将一张图像与另一张图像进行比较以查看它们是否在一定百分比上相似？](https://stackoverflow.com/questions/6488732/how-does-one-compare-one-image-to-another-to-see-if-they-are-similar-by-a-certai)

# apache - 间歇性错误 500（并发请求？）

> ID：14078284
> 
> 赞同：1
> 
> 时间：2012-12-29T02:50:55.643
> 
> 标签：apache, mod-rewrite, fastcgi, mod-fcgid

我有一个带有经典 apache-nginx 的 Web 服务器，用于处理繁重的静态流量。在 apache 网络服务器中，我使用 mod_rewrite 来清理丑陋的 url，并通过 mod_fcgid 处理 php。一切正常，但我偶尔会在**某些**请求上出现间歇性错误 500。

**注意：**错误 500 未登录 error.log（不是 PHP 错误），我认为这是配置问题（mod_fcgi？mod_rewrite？apache maxclients？）。

我查看日志，发现错误 500 出现在准时请求附近，重复相同的 URL（巧合？）。一些带有 200/500 错误的示例：

```
88.27.x.x [28/Dec/2012:18:57:12 "GET /permalink/title-clean-url-1 200
88.27.x.x [28/Dec/2012:18:57:12 "GET /permalink/title-clean-url-1 500

88.1.x.x [28/Dec/2012:16:12:32 "GET /permalink/title-clean-url-2 200
88.1.x.x [28/Dec/2012:16:12:34 "GET /permalink/title-clean-url-2 200
88.1.x.x [28/Dec/2012:16:12:37 "GET /permalink/title-clean-url-2 500

200.5.x.x [28/Dec/2012:11:41:00 "GET /permalink/title-clean-url-3 200
200.5.x.x [28/Dec/2012:11:41:00 "GET /permalink/title-clean-url-3 500

83.46.x.x [28/Dec/2012:10:55:00 "GET /permalink/title-clean-url-4 500
83.46.x.x [28/Dec/2012:10:55:00 "GET /permalink/title-clean-url-4 200

200.38.x.x [29/Dec/2012:01:55:24 "GET /permalink/title-clean-url-3 500
69.171.x.x [29/Dec/2012:01:55:25 "GET /permalink/title-clean-url-3 200

178.33.x.x [29/Dec/2012:04:48:12 "GET /permalink/title-clean-url-5 500
178.33.x.x [29/Dec/2012:04:48:12 "GET /permalink/title-clean-url-5 200

201.151.x.x [29/Dec/2012:12:05:31 "GET /permalink/title-clean-url-3 500
79.144.x.x [29/Dec/2012:12:05:34 "GET /permalink/title-clean-url-3 200

83.46.x.x [29/Dec/2012:11:11:13 "GET /permalink/title-clean-url-3 200
83.46.x.x [29/Dec/2012:11:11:13 "GET /permalink/title-clean-url-3 500
83.46.x.x [29/Dec/2012:11:11:34 "GET /permalink/title-clean-url-3 200
83.46.x.x [29/Dec/2012:11:11:34 "GET /permalink/title-clean-url-3 200 
```

**编辑：**我认为，网络服务器的高流量可能会推翻 apache。我在第 28 天每分钟为计数请求创建脚本（格式：*HOUR:MINUTE，请求计数在这一分钟*）。错误出现在 11:41、12:05、16:21 和 18:57，并且在这分钟没有出现高流量（其他时刻有更多的请求）。任何人都可以检查此分析吗？：

[http://pastie.org/5593294](http://pastie.org/5593294)

有谁知道我可以在哪里继续调查？

**EDIT2：**我看到 Apache 500 错误是从 nginx 重定向的，出现 499 错误（nginx 客户端关闭连接）。我能解决这个吗？

很感谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T14:21:48.503

平行问题：

我看到从相同的 IP 和相同的引用者多次（在很短的时间内）请求相同的 URL。浏览器多次调用服务器（请求）？

# .htaccess - .htaccess 301 将许多页面重定向到一个，不包括已知页面

> ID：14078286
> 
> 赞同：1
> 
> 时间：2012-12-29T02:51:17.473
> 
> 标签：.htaccess

我已经在网上闲逛了一段时间，还没有找到我的具体解决方案。任何帮助是极大的赞赏。我的旧网站可以很好地重定向到新网站上的常用页面（联系人、主页、关于等）。然而，有很多来自各个站点的旧反向链接继续链接到旧站点，它们现在抛出 404 错误。我宁愿旧链接只是转到主页。最终，我希望能够为大量未知页面/链接创建重定向，而不会影响到上述通常页面的良好 301 重定向。例子：

oldsite.com/contact 重定向到 newsite.com/contact（工作得很好）

oldsite.com/somerandomlink.html（结果为 404，并且有许多这样的链接 - 客户有几个旧网站，并且反向链接从各地出现）

是否可以通过 .htaccess 文件告诉所有随机链接改为转到 newsite.com 而不会破坏现有的 301 重定向？一个简单的 .htaccess 示例会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T02:55:57.070

尝试这个

```
RewriteEngine On
RewriteBase /
RewriteCond %{HTTP_HOST} !newdomain.com$ [NC]
RewriteRule ^(.*)$ http://newdomain.com/$1 [L,R=301] 
```

# mysql - Heroku MySQL 自动增量

> ID：14078288
> 
> 赞同：13
> 
> 时间：2012-12-29T02:51:35.353
> 
> 标签：mysql, heroku

我正在将 ClearDB 用于 mysql 数据库。我有一个带有自动递增主键的表。问题是它不是增加1，而是增加10。请问我该如何解决这个问题？

此外，当我在本地主机上测试数据库时，增量工作正常。

编辑：我也尝试使用命令：'SET @@auto_increment_increment=1'，但它没有用。我不确定我是否做得对。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-29T03:27:41.083

[http://www.cleardb.com/developers/help/faq#general_16](http://www.cleardb.com/developers/help/faq#general_16)

自动增量键在实例之间进行分区以防止冲突。

# java - 在java中，如何替换ArrayList中的重复数字？

> ID：14078292
> 
> 赞同：-1
> 
> 时间：2012-12-29T02:51:46.427
> 
> 标签：java, arraylist

> **可能重复：**
> [如何从 ArrayList 中删除重复的元素？](https://stackoverflow.com/questions/203984/how-do-i-remove-repeated-elements-from-arraylist)

我想替换我存储在 ArrayList 中的重复数字（如果有）。我获得了随机变量的数字。这是课程。

```
import java.util.*;

public class RandomNumbers {
// instance variables
private ArrayList<Integer> randomNumberList = new ArrayList<Integer>(); 
private Random randomNums = new Random();

public RandomNumbers(){
    // generating and adding random numbers to the list
    for (int i=0; i<MemoryGame.totalAnswers; i++)
        randomNumberList.add(randomNums.nextInt(32));

    System.out.println("Numbers in the list: " + randomNumberList);
    System.out.println("");
}

public ArrayList<Integer> getRandomNumbers(){
    return randomNumberList;
}
} 
```

我的课本告诉我如何添加、删除和检索一个号码，但没有告诉我如何替换一个重复的号码。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T02:55:08.707

如果您不限于`ArrayList`，请改用 a `HashSet<Integer>`（或者更好的是[LinkedHashSet](http://docs.oracle.com/javase/6/docs/api/java/util/LinkedHashSet.html)）。`HashSet<Integer>`将保证您在集合中没有重复的值，`LinkedHashSet<Integer>`将执行相同的操作并保留项目的排序。

如果你坚持有一个`ArrayList`，那么这样做：

```
public RandomNumbers(){
    HashSet<Integer> set = new HashSet<Integer>();

    // generating and adding random numbers to the list
    //for (int i=0; i<MemoryGame.totalAnswers; i++)
    while (set.size()<MemoryGame.totalAnswers)
        set.add(randomNums.nextInt(32));

    randomNumberList.addAll(set);  // dump the set in your ArrayList

    System.out.println("Numbers in the list: " + randomNumberList);
    System.out.println("");
} 
```

此外，如果，那么您可以使用[随机列表](http://docs.oracle.com/javase/6/docs/api/java/util/Collections.html#shuffle(java.util.List))`MemoryGame.totalAnswers == 32`来加快此过程：

```
public RandomNumbers(){
    // generating and adding random numbers to the list
    for (int i=0; i<MemoryGame.totalAnswers; i++)
        randomNumberList.add(i);

    Collections.shuffle(randomNumberList);

    System.out.println("Numbers in the list: " + randomNumberList);
    System.out.println("");
} 
```

****更新****

由于`MemoryGame.totalAnswers == 8`，忘记最后一个片段。如果有人碰巧需要它，我会把它留在那里。您可以按照[pst](https://stackoverflow.com/questions/14078292/in-java-how-to-replace-a-duplicate-number-in-an-arraylist/14078312#comment19465721_14078292)的建议`Set`完全跳过 a 的使用：

```
public RandomNumbers(){
    // generating and adding random numbers to the list
    for (int i=0; i<32; i++)
        randomNumberList.add(i);

    Collections.shuffle(randomNumberList);

    // keep only the first ones we need
    randomNumberList.removeRange(MemoryGame.totalAnswers + 1, 32);

    System.out.println("Numbers in the list: " + randomNumberList);
    System.out.println("");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T02:58:04.607

要替换某个位置的元素，请使用以下[`set()`](http://docs.oracle.com/javase/7/docs/api/java/util/List.html#set%28int,%20E%29)方法：

```
randomNumberList.set(index, element); 
```

当然，首先找出*哪些*元素重复的逻辑取决于您；如果重复数字对您的问题没有意义，最好使用[`Set`](http://docs.oracle.com/javase/7/docs/api/java/util/Set.html)数据结构（例如：[HashSet](http://docs.oracle.com/javase/7/docs/api/java/util/HashSet.html)或[LinkedHashSet](http://docs.oracle.com/javase/7/docs/api/java/util/LinkedHashSet.html)如果在迭代时保留插入顺序对您很重要）并继续向集合中添加随机元素，直到它有所需的大小。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T03:13:41.043

如果最终目标是不同数字的随机列表，并且可能数字的范围不比所需结果的数量大多少，请考虑[洗牌](http://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle)而不是替换重复的数字。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-29T05:18:12.383

如果你想要的只是你最后的评论

> 从 0 到 31 的 8 个随机、不重复的数字

您不需要任何实例变量、随机数生成代码或实例方法。
您只需要这样：

```
public static List<Integer> getRandomNumbers() {
    List<Integer> list = new ArrayList<Integer>();
    for (int i = 0; i < 32; i++)
        list.add(i);
    Collections.shuffle(list);
    return list.subList(0, 8);
} 
```

# visual-c++ - 为什么我在 Visual C++ 2010 Express 中收到过时消息

> ID：14078296
> 
> 赞同：0
> 
> 时间：2012-12-29T02:52:31.227
> 
> 标签：visual-c++

所以我开始写一本名为“通过游戏编程开始 c++，第三版，作者 Michael Dawson”的书，而我试图运行的第一个程序没有工作。我什至尝试只使用源代码。这里是： // Game Over // 第一个 C++ 程序

```
#include <iostream>

int main()
{
    std::cout << "Game Over!" << std::endl;
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T02:57:40.373

![在此处输入图像描述](../Images/4eb79c5abc5874bffdd9cfc7026e5556.png)

如果这是您所看到的，只需选中底部的复选框并点击“是”。这将防止它弹出。这不是您的代码中的错误。

否则，您需要发布您收到的错误消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T07:54:22.943

根据我为 VC++ 下的默认预编译头文件所做的各种评论，并让窗口保持打开状态，直到按下回车键，使用以下命令：

```
#include "stdafx.h" 
#include <iostream>

int main()
{
    std::cout << "Game Over!" << std::endl;
    cin.ignore();
    return 0;
} 
```

# php - 将搜索查询链接到新页面？

> ID：14078298
> 
> 赞同：-1
> 
> 时间：2012-12-29T02:53:24.787
> 
> 标签：php, mysql, search

> **可能重复：**
> [警告：mysql_fetch_* 期望参数 1 是资源，布尔给定错误](https://stackoverflow.com/questions/11674312/warning-mysql-fetch-expects-parameter-1-to-be-resource-boolean-given-error)

我有两个问题。我正在使用这个搜索查询脚本从我的数据库中提取结果，它设置为根据位置、性别等搜索用户。

下拉框中的结果列表为了节省空间，我将显示的结果数量限制为五个。

我创建了一个链接，上面写着查看更多结果，因为我要做的是使用户能够单击此链接并被带到一个新页面，其中列出了其原始搜索条件的所有结果。这可以做到吗，我已经尝试了很多方法，但没有任何运气。

我也试图排除 5 个配置文件；99999, 99998, 99997, 99996, 99995, 99994, 99993 通过将此行添加到查询中：

AND ptb_profiles.user_id != '99999'

但是当我这样做时，整个查询会产生错误：

```
Warning: mysql_fetch_array() expects parameter 1 to be resource, boolean given in /Applications/XAMPP/xamppfiles/htdocs/PTB1/includes/mod_sidebar/search.php on line 31 
```

请有人告诉我如何做到这一点。谢谢你。

```
<form method="get" action="">
<input type="text" name="query" class="searchbox" placeholder="Search Name/Location" style="width:120px;"/>
<input type="image" src="../PTB1/assets/img/icons/search.png" height="19" width="20" class="searchbutton" name="submit" value="Start Search" />
</form>

<?php
//PHP CODE STARTS HERE

if(isset($_GET['submit'])){

// Change the fields below as per the requirements
$db_host="localhost";
$db_username="root";
$db_password="";
$db_name="database";
$db_tb_atr_name="display_name";

//Now we are going to write a script that will do search task
// leave the below fields as it is except while loop, which will display results on screen

mysql_connect("$db_host","$db_username","$db_password");
mysql_select_db("$db_name");

$query=mysql_real_escape_string($_GET['query']);

$query_for_result=mysql_query("SELECT *
                        FROM ptb_stats
                        WHERE display_name like '%".$query."%' OR location LIKE '%".$query."%' OR gender LIKE '%".$query."%' OR nationality LIKE '%".$query."%' OR age LIKE '%".$query."%' OR postcode LIKE '%".$query."%' LIMIT 5");
echo "<div class=\"search-results\">";
while($data_fetch=mysql_fetch_array($query_for_result))
{

    echo "<div class=\"text\"><a href=\"profile.php?id={$data_fetch['user_id']}\" class=\"search\">";
    echo "<div class=\"spacing\"><img width=35px height= 30px src=\"data/photos/{$data_fetch['user_id']}/_default.jpg\" class=\"boxgridsearch\"/> "; 
     echo substr($data_fetch[$db_tb_atr_name], 0,160);
    echo "</a></div></div>";

}
echo "<div class=\"morebutton-search\"><a href=\"echo '%".$query."%'\">+ view more results</a></div>";

mysql_close();
}

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T04:11:19.880

这应该是您的 mysql 语句的错误。您正在从中选择数据，`ptb_stats`但您正在检查一个值`ptb_profiles`

假设`user_id`这两个表都是主要的，如果然后使用`ptb_stats.user_id`而不是`ptb_profiles.user_id`做以下更改，

```
$query_for_result=mysql_query("SELECT *
                        FROM ptb_stats
                        WHERE (display_name like '%".$query."%' OR location LIKE '%".$query."%' OR gender LIKE '%".$query."%' OR nationality LIKE '%".$query."%' OR age LIKE '%".$query."%' OR postcode LIKE '%".$query."%') AND ptb_stats.user_id!='99999' LIMIT 5"); 
```

确保使用**括号**作为我的代码，因为您需要检查两种不同的条件

*   为您的查询找到匹配的数据
*   检查这些数据并排除配置文件 ID

如果你不使用上面的括号，你的代码会给你一个错误

希望这对您有所帮助。

# php - 我的 php 代码中的 SQL 注入

> ID：14078303
> 
> 赞同：0
> 
> 时间：2012-12-29T02:54:25.103
> 
> 标签：php, mysql, security, sql-injection

> **可能重复：**
> [如何防止 PHP 中的 SQL 注入？](https://stackoverflow.com/questions/60174/how-to-prevent-sql-injection-in-php)

我想知道我的代码是否有像 SQLI 这样的 hack

```
function insertRow($table,$fields,$values)
    {
        if(count($fields) != count($values))
        {
            echo "fields and values must be the same count";
            return null;
        }
        $query = "INSERT INTO ".$table." SET ";
        foreach($fields as $key => $field)
        {
            $query = $query. "" . $field . " = '" . htmlspecialchars($values[$key], ENT_QUOTES) . "', ";
        }
        $query = substr($query,0,-2);

        if (!mysql_query($query, $this->con))
        {
            echo "Error : " . mysql_error($this->con)."<br />";
            return false;
        }
        return true;
    } 
```

我使用 htmlspecialchars，我想知道它是否可以

编辑 ：

```
$fields = array("a","b","c");
$values = array($_POST["a"],$_POST["b"],$_POST["c"]);
$a = $dbc->insertRow("tbl_synagoge",$fields,$values); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T03:00:34.137

而不是`htmlspecialchars()`使用`mysql_real_escape_string()`.

这将使您的代码更加安全。

但是，您可能希望停用所有 mysql_* 函数，因为它们已被弃用。您可以从这里开始：[MySQLi](http://us3.php.net/mysqli)

# jquery - 使用 JQM 1.2.0 将 FieldSet 居中

> ID：14078311
> 
> 赞同：0
> 
> 时间：2012-12-29T02:54:57.327
> 
> 标签：jquery, jquery-mobile

我正在使用 JQM 创建一个移动应用程序，并尝试将分组在具有 data-role="fieldcontain" 的字段集中的单选按钮居中。我发现如果我使用 JQM 1.2.0，单选按钮不会居中，而是堆叠在一起（见图）。切换回 JQM 1.0.0 解决了这个问题，并且按钮完全居中（见图）。有关如何纠正此问题的建议？提前致谢。

```
 <div data-role="header">
    </div>

    <div data-role="content">
       <div id="fieldcontain-wrapper" style="display:table;margin:0 auto;">
            <div data-role="fieldcontain">
                <fieldset data-role="controlgroup" data-type="horizontal" data-mini="true">
                        <input type="radio" name="radio-choice-b" id="radio-choice-c" value="on" checked="checked" />
                        <label for="radio-choice-c">&nbsp;&nbsp;Home&nbsp;&nbsp;</label>
                        <input type="radio" name="radio-choice-b" id="radio-choice-d" value="off" />
                        <label for="radio-choice-d">&nbsp;&nbsp;Away&nbsp;&nbsp;</label>
                </fieldset>
            </div>
       </div>
    </div> 
```

![JQM 1.2.0](../Images/c8dfce89c92619f28804089f3c753b7f.png) ![JQM 1.0](../Images/f310aaa3b5b29aa82b69a329027e95d3.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T09:39:45.870

这是由您的包装器 div 引起的一个奇怪的 jQM 错误。这个 css 将修复它：

```
.ui-controlgroup-controls {
    width: 100% !important;
} 
```

出于某种原因，在达到相同的最小宽度后，ui-controlgroup-controls 的宽度变为 78%。真的很奇怪。

这是一个示例，删除一个 css 块以查看其行为的缺失。 [http://jsfiddle.net/Gajotres/vHy9U/](http://jsfiddle.net/Gajotres/vHy9U/)

# c# - 动态设置 TextBox 文本

> ID：14078330
> 
> 赞同：6
> 
> 时间：2012-12-29T02:58:42.953
> 
> 标签：c#, wpf, xaml, textbox

我有多个 XAML `TextBox`es，每个 XAML es 操作数组中的相应值，当`TextBox`更改中的值时，使用`C#`动态检查`TextBox`调用该方法的方法。

```
 <TextBox x:Name="_0_0" TextChanged="_x_y_TextChanged"/>
    <TextBox x:Name="_0_1" TextChanged="_x_y_TextChanged"/>
    <TextBox x:Name="_0_2" TextChanged="_x_y_TextChanged"/>
    // And so on..... 
```

每个都在数组中操作一个对应的值，当值`TextBox`改变时，使用 C# 方法动态检查哪个`TextBox`调用了该方法。

```
 private void _x_y_TextChanged(object sender, TextChangedEventArgs e)
    {
        TextBox current = (TextBox)sender;
        string currentname = current.Name;
        string rowstring = currentname.Substring(1, 1);

        string columnstring = currentname.Substring(3, 1);

        int row = Convert.ToInt32(rowstring);
        int column = Convert.ToInt32(columnstring);

        // I've then detected the name of the textbox which has called it... 
```

因此，此信息可用于将来自 a 的信息动态存储`TextBox`在相应的数组索引中 - 或者您想要使用它做的任何事情......

然而，我的问题是：

如何创建一个使用数组中的索引位置的方法来调用相关`TextBox`并更新其文本？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-29T03:52:58.547

用于`FindName(string)`按名称查找文本框，如下所示（其中`container`是包含所有文本框的控件）：

```
private void UpdateTextBox(int row, int column, string text)
{
    TextBox textBox = container.FindName("_" + row + "_" + column) as TextBox;
    if(textbox != null)
    {
        textbox.Text = text;
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-29T09:18:51.510

你可能有两种方法：

如果你有很多数据要管理，或者如果你无法预测数组的长度，最好绑定到一个集合而不是手动将数据插入和取出数组。如果您创建从 ObservableCollection 派生的类而不是使用数组，则数据 <> ui 关系非常简单。

如果您真的需要手动执行此操作，也许最好将索引粘贴到文本框的“标签”字段中。您可以 (a) 在您的 xaml 中清楚地看到它，(b) 轻松解析它并且 (c) 如果您在此处使用公式的变体：

[按类型查找 WPF 窗口中的所有控件](https://stackoverflow.com/questions/974598/find-all-controls-in-wpf-window-by-type)

您可以遍历窗口中的文本框并通过查看其标签索引找到正确的文本框：

```
 foreach (TextBox t in FindVisualChildren<TextBox>(this))
    {
        if ((int) t.Tag)  == my_index )
        {
            t.Text = "my_text_goes_here";
         }
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T10:34:42.277

我会朝着我在这个问题上给出的答案的方向前进： [form anchor/dock](https://stackoverflow.com/questions/14077216/form-anchor-dock) 简而言之，我将创建一个包含实际值的类，然后创建一个包含信息类的集合。

然后我不会在 TextBoxes 上使用事件“TextChanged”，而是“嗅探”用于保存文本的依赖属性的更改。这可以在依赖属性中轻松完成。

最后，我会使用 ItemsControl 或 ItemsPresenter 来显示控件。控件的数量将跟随集合中的项目数量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-29T05:35:28.423

我建议使用 MVVM 模式、数据模板和 ItemsControl 来有效地处理这个问题。

# xml - 为 json 和 xml 为 restful 端点设置 Spring MVC

> ID：14078331
> 
> 赞同：2
> 
> 时间：2012-12-29T02:58:47.213
> 
> 标签：xml, json, spring, rest, spring-mvc

所以我让json工作，有人可以以json形式发布一个对象，我的控制器方法将它映射到实际的java对象。我的弹簧配置 xml 看起来像：

```
 <bean id="jsonMessageConverter" class="org.springframework.http.converter.json.MappingJacksonHttpMessageConverter"/>
    <bean class="org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter">
        <property name="messageConverters">
            <util:list id="beanList">
                <ref bean="jsonMessageConverter"/>
            </util:list>
        </property>
    </bean> 
```

一个有效的测试控制器方法如下：

```
 @ResponseBody
    @RequestMapping(value = "/create", method = RequestMethod.POST)
    public String create(@RequestBody User user, HttpServletRequest request, HttpServletResponse response) {

        return user.getName();
    } 
```

现在，如果我也想要完全相同的方法来处理 xml，这可能吗？我使用哪个消息转换器？

顺便说一句，如果我想保留某些私有属性，我该怎么做才能同时适用于 json 和 xml？

例如说我有一个密码属性，我不希望任何人能够发布这些信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T14:39:24.340

我正在使用 Spring 3.1，这就是我正在做的事情。在 dispatcher-servelet.xml

```
 <bean id="jacksonObjectMapper" class="com.parth.web.CustomJacksonMapper"/>
    <bean id="xstreamMarshaller" class="org.springframework.oxm.xstream.XStreamMarshaller">
        <property name="aliases">
        <props>
            <prop key="event">com.parth.model.Event</prop>
        </props>
        </property>
        <property name="annotatedClasses">
        <list>
            <value>com.parth.model.Event</value>
        </list>
    </property>
    </bean>

    <oxm:jaxb2-marshaller id="jaxb2Marshaller">
        <oxm:class-to-be-bound name="com.parth.model.Event"/>
    </oxm:jaxb2-marshaller>

    <mvc:annotation-driven>
        <mvc:message-converters register-defaults="false">
            <bean class="org.springframework.http.converter.xml.MarshallingHttpMessageConverter" p:marshaller-ref="xstreamMarshaller" p:unmarshaller-ref="xstreamMarshaller"/>
            <bean class="org.springframework.http.converter.json.MappingJacksonHttpMessageConverter" p:objectMapper-ref="jacksonObjectMapper" />
        </mvc:message-converters>
    </mvc:annotation-driven> 
```

在控制器中，

```
@RequestMapping(value="/",method= RequestMethod.GET)
    @ResponseBody
    public List<Event> getAllEvents(@RequestParam("userId")  String userId, HttpServletResponse response){
        return  eventService.getAll(userId);
    } 
```

现在，当您从客户端发出 HTTP 请求时，请确保您`Accept`使用`appliction/json or application/xml`.

至于省略字段，您可以使用注释`@JsonIgnore`（对于 Jackson）和/或`@XStreamOmitField`（对于 XStream）。

确保你的类路径中有 Jackson 和 XStream jar。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T15:00:46.387

您可以通过 RequestMapping 注解的 consumes 属性告诉一个方法它将使用什么类型。

来自 Spring 文档的 IE：

```
@RequestMapping(value = "/pets", method = RequestMethod.POST, consumes="application/json") 
```

注意：这是一个逗号分隔的列表，因此您也可以拥有 application/xml。

同样重要的是要注意，这只会接受那些内容类型，这会给你一点安全，但可能会导致意想不到的结果。我的意思是，如果您发送`/pets`text/plain，则不会调用该方法。

要进行正确的绑定，请检查通过`HttpServletRequest`和 unmarshal 发送的内容类型，具体取决于您正在处理的类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T16:03:20.180

只要您考虑各自的要求，您就可以在[org.springframework.http.converter.xml](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/http/converter/xml/package-summary.html)包中选择任何实现。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-10T21:22:31.527

（即使它很旧，也可以回答这个问题，以防有人在网站搜索中遇到这个问题） - 您可以使用 ContentNegotiationViewResolver [http://static.springsource.org/spring/docs/3.2.x/spring-framework-reference/html/ mvc.html#mvc-multiple-representations](http://static.springsource.org/spring/docs/3.2.x/spring-framework-reference/html/mvc.html#mvc-multiple-representations)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-08-26T21:45:09.567

我正在使用这个来处理两者：

```
@RequestMapping(value = "/{id}", 
method = RequestMethod.GET,
headers ={"Accept=application/json,application/xml"},
produces={"application/json", "application/xml"}) 
```

# ruby - Raspberry Pi 安装 SiriProxy：安装 Eventmachine 1.0.0 Ruby Gem 时出错

> ID：14078332
> 
> 赞同：2
> 
> 时间：2012-12-29T02:58:50.733
> 
> 标签：ruby, gem, raspberry-pi

我是 Raspberry Pi 和 Linux 的新手，想安装 SiriProxy。

我按照本指南中的步骤操作：[http ://www.idownloadblog.com/2011/12/09/how-to-install-siri-proxy-tutorial-video/](http://www.idownloadblog.com/2011/12/09/how-to-install-siri-proxy-tutorial-video/)

完成所有步骤后，我遇到了一个错误，指出它在当前机器上找不到 eventmachine。

当我以 root 用户身份运行 gem install eventmachine -v 1.0.0 时，它返回：

```
 root@raspberrypi:/var/lib/gems/1.9.1/gems# gem install eventmachine
    Building native extensions.  This could take a while...
    ERROR:  Error installing eventmachine:
    ERROR: Failed to build gem native extension.

    /usr/bin/ruby1.9.1 extconf.rb
    /usr/lib/ruby/1.9.1/rubygems/custom_require.rb:36:in `require': cannot load such file -- mkmf (LoadError)
    from /usr/lib/ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
    from extconf.rb:2:in `<main>'

    Gem files will remain installed in /var/lib/gems/1.9.1/gems/eventmachine-1.0.0 for inspection.
    Results logged to /var/lib/gems/1.9.1/gems/eventmachine-1.0.0/ext/gem_make.out 
```

如果有人有任何建议，我将不胜感激，正如我所说我是新手，所以对复杂术语的解释会有所帮助。:)

编辑：好的，我已经能够通过在 /root/SiriProxy/bin/ 目录中运行“bundle”来解决这个错误。这恰好安装了 SiriProxy 所需的所有 gem。运行“ruby siriproxy server”返回：

```
root@raspberrypi:~/SiriProxy/bin# ruby siriproxy server
Starting SiriProxy on port 443..
SiriProxy up and running. 
```

虽然从 iPhone 发送语音包时（5，未越狱，没有 VPN，在同一个 WIFI 网络上）我收到了这个错误：

```
Create server for iPhone connection
/var/lib/gems/1.9.1/gems/eventmachine-1.0.0/lib/em/connection.rb:411:in `block in start_tls': Could not find /root/.siriproxy/server.passless.key for start_tls         (EventMachine::FileNotFoundException)
    from /var/lib/gems/1.9.1/gems/eventmachine-1.0.0/lib/em/connection.rb:409:in `each'
    from /var/lib/gems/1.9.1/gems/eventmachine-1.0.0/lib/em/connection.rb:409:in `start_tls'
    from /root/SiriProxy/lib/siriproxy/connection/iphone.rb:15:in `post_init'
    from /var/lib/gems/1.9.1/gems/eventmachine-1.0.0/lib/em/connection.rb:58:in `block in new'
    from /var/lib/gems/1.9.1/gems/eventmachine-1.0.0/lib/em/connection.rb:49:in `instance_eval'
    from /var/lib/gems/1.9.1/gems/eventmachine-1.0.0/lib/em/connection.rb:49:in `new'
    from /var/lib/gems/1.9.1/gems/eventmachine-1.0.0/lib/eventmachine.rb:1462:in `event_callback'
    from /var/lib/gems/1.9.1/gems/eventmachine-1.0.0/lib/eventmachine.rb:187:in `run_machine'
    from /var/lib/gems/1.9.1/gems/eventmachine-1.0.0/lib/eventmachine.rb:187:in `run'
    from /root/SiriProxy/lib/siriproxy.rb:16:in `initialize'
    from /root/SiriProxy/lib/siriproxy/command_line.rb:96:in `new'
    from /root/SiriProxy/lib/siriproxy/command_line.rb:96:in `start_server'
    from /root/SiriProxy/lib/siriproxy/command_line.rb:85:in `run_server'
    from /root/SiriProxy/lib/siriproxy/command_line.rb:37:in `initialize'
    from siriproxy:6:in `new'
    from siriproxy:6:in `<main>' 
```

检查有问题的目录（/root/.siriproxy/）后，我只找到了配置文件：

```
root@raspberrypi:~/SiriProxy/bin# cd /root/.siriproxy/
root@raspberrypi:~/.siriproxy# ls
config.yml
root@raspberrypi:~/.siriproxy# cd /home/pi/.siriproxy/
root@raspberrypi:/home/pi/.siriproxy# ls
config.yml 
```

在文件系统中搜索该文件未返回任何结果：

```
root@raspberrypi:/home/pi/.siriproxy# find / -name server.passless.key
root@raspberrypi:/home/pi/.siriproxy# 
```

有人知道我在哪里可以找到这些文件/解决这个错误吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T03:34:35.450

不知道你是怎么走到现在的，但我刚刚完成了让 SiriProxy 从头开始​​在 RPi 上运行，没有太多麻烦。我遇到的唯一问题是已知的 CFPropertyList 崩溃，有一个已知的修复方法。我从头开始记录了所有步骤，包括 CFPropertyList 修复的帖子。

[https://github.com/plamoni/SiriProxy/wiki/Installation-How-Tos](https://github.com/plamoni/SiriProxy/wiki/Installation-How-Tos)

如果是我，我会从一个新的 RPi SDC 映像开始。在您尝试在嵌入式设备上之前，首先尝试让 SiriProxy 在 VM 上运行也可能会有所帮助。

猫王

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T06:14:49.307

我们会通过它，但这里有一些事情可以消除可能的贡献者。

**确保连接以太网并**
在启动时保持连接 - 如果在启动期间未连接以太网，RPi 将不会配置以太网。
- 如果在引导期间未连接或在引导后断开连接，则默认 RPi 接口文件不包含使以太网重新启动的行。 `auto eth0`

**一旦你知道它应该使用什么地址，尝试使用 ping 命令从 RPi 获得响应** `ping xxx.xxx.xxx.xxx`

**将 /etc/network/interfaces 文件改回使用 DHCP**
- 注释掉静态地址行
- 取消注释掉 DHCP 行，看起来像这样

```
auto eth0
iface eth0 inet dhcp 
```

**重启 RPi**

**重新启动后，确定您的路由器分配的 IP 地址**
- 类型
`ifconfig`
- 示例

```
eth0     Link encap:Ethernet  HWaddr 00:11:22:33:44:55   
             inet addr:192.168.69.97  Bcast:192.168.69.255  Mask:255.255.255.0 
             UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1 
             RX packets:7015 errors:0 dropped:0 overruns:0 frame:0 
             TX packets:4236 errors:0 dropped:0 overruns:0 carrier:0 
             collisions:0 txqueuelen:1000  
             RX bytes:861497 (841.3 KiB)  TX bytes:849687 (829.7 KiB) 
```

**在 /etc/dnsmasq.conf 默认文件中添加一行。**
- 例子 `address=/guzzoni.apple.com/192.168.69.97`

**重新启动 DNSMASQ**
- 类型 `sh /etc/init.d/dnsmasq restart`

**确保 /root/.siriproxy/ca.pem 文件在您的 iOS 设备上**

**关闭 iOS 设备上的蜂窝数据连接，然后将其关闭**

**切换飞行模式，关闭至少 5 秒**

**在您的 iOS 设备上，告诉它忘记您的 Wifi 连接**

**重新连接到您的 Wifi SSID**

**连接后，点击 wifi 连接的详细信息页面，仅将 DNS 地址更改为指向上面确定的 RPI 的地址**
- 更改后，点击返回按钮，然后再次点击详细信息以查看 DNS 设置是否保留。
- 您想切换飞行模式并再次确认 DNS 设置被保留一次。

**有时需要几次尝试才能让手机第一次连接到 SiriProxy**
- 几乎就像 iPhone 在实际尝试 wifi 连接之前必须先通过蜂窝连接超时。
- 如果第一次尝试没有立即开始连接，请等待几秒钟，退出 Siri 界面并重新启动 Siri。
- 我认为 ios 6.0.2 带来的问题比它解决的要多，因为它以前没有这么麻烦。

**如果此时您可以正常工作，您将需要尝试将 /etc/network/interfaces 文件配置为使用静态 IP 地址**
- 注释掉 DHCP 行
- 示例（确保列对齐并排序相同)

```
auto eth0 
iface eth0 inet static 
       address 192.168.69.97 
       netmask 255.255.255.0 
       broadcast 192.168.69.255 
       network 192.168.69.0 
       gateway 192.168.69.1 
```

**如果这不起作用，那么您的 ISP（U-Verse）可能不喜欢您使用静态 IP 地址。**

**如果您的路由器由 ATT 提供，则 dd-wrt ​​透明 DNS 重定向不是一个选项**

# javascript - Javascript onblur/onfocus

> ID：14078337
> 
> 赞同：0
> 
> 时间：2012-12-29T03:00:46.680
> 
> 标签：javascript

我在这两个事件上遇到了一些问题，它们工作正常，但是我遇到了一个问题：我在 div 中有一个 div。当内部 div 成为焦点时，我希望将一组样式按钮附加到外部 div。但是，当我尝试单击按钮时，它会使内部 div 失去焦点并使按钮消失。我希望它们在失去焦点时消失，但我不想在按下按钮时失去焦点。抱歉，如果这有点令人困惑，这里有一些代码和它的 jsfiddle：

```
function addButtons() {
  var node = document.createElement('div');
  var obj = document.getElementById('container');
  node.setAttribute('id', 'buttons');
  node.innerHTML = '<input type="button" value="B" onClick="document.execCommand(\'bold\',false)" />';
  obj.appendChild(node); 
}

function removeButtons(id) {
  var obj = document.getElementById('container');
  obj.removeChild(obj.childNodes[3]);
} 
```

[http://jsfiddle.net/bnjGE/2/](http://jsfiddle.net/bnjGE/2/)

如果我删除 removeButtons() 函数，它工作正常，但会创建多个按钮。

我可以试着把事情弄清楚，问一下。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T03:26:20.757

您可以在按钮 f.ex 上添加`return false;`有关事件的声明：`mousedown`

```
node.getElementsByTagName('input')[0].onmousedown = function(e) {
    return false;
}; 
```

[http://jsfiddle.net/bnjGE/8/](http://jsfiddle.net/bnjGE/8/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T03:28:15.077

```
document.onclick = function(e){
    console.log(e.target);
    if(e.target.id != 'buttons' && e.target.parentNode.id != 'buttons' && e.target.id != 'textarea'){
        removeButtons();
    }
}​ 
```

[http://jsfiddle.net/bnjGE/7/](http://jsfiddle.net/bnjGE/7/) 也许这是一个解决方案，但并不完美。

# google-maps - 如何在谷歌地图距离矩阵 API 中请求航点？

> ID：14078340
> 
> 赞同：2
> 
> 时间：2012-12-29T03:01:03.777
> 
> 标签：google-maps, google-maps-api-3

我想使用谷歌地图[距离矩阵 API](https://developers.google.com/maps/documentation/distancematrix/)，但我也想在其中包含航点。

距离矩阵仅采用 2 个输入，因为它采用起点列表和目的地点列表。我想包括起点、终点和最终终点。所以它应该显示 A -> B -> C 的距离矩阵

我怎样才能将其合并？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-05-02T16:05:58.107

使用**A**和**B**作为原点。

使用**B**和**C**作为目的地。

您的回复应包含**A->B**、**A->C**、**B->B**、**B->C**距离。

提取和求和**A->B**和**B->C**以通过单个 API 调用接收您的目标距离。

# chef-infra - 配方如何获得服务器标签的完整列表？

> ID：14078344
> 
> 赞同：3
> 
> 时间：2012-12-29T03:02:43.520
> 
> 标签：chef-infra, chef-recipe, rightscale

配方如何获得服务器标签的完整列表？

或者

配方如何检查某个标签是否已设置/存在？

顺便说一句：标记？对我不起作用

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-29T12:20:47.627

`node.tags`您可以通过或获取配方中节点的所有标签`node[:tags]`。因此，要检查是否存在某个标签，您需要：

```
node[:tags].include? 'mytag' 
```

要获取所有节点上所有标签的完整列表，您必须使用搜索。

```
search( :node, '*:*' ).collect(:tags).flatten.uniq 
```

但`tagged? 'mytag'`应该实际工作。显示您的代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-03-24T19:11:12.303

使用 Chef 标签需要牢记以下几点：

1.  **您不能在属性文件中使用它们**。如果可以的话，那就太棒了，但它就是行不通。如果您尝试，您将看到以下内容：错误：未定义的节点属性或方法“已标记？” 在节点上'。
2.  这可能会在更高版本的 Chef 中得到修复，但有时如果节点根本没有标记，则在检查标记时会出错。

除了这两件事，我在食谱中经常使用它们，而且效果很好。

```
if tagged?('legacy')
  do legacy things
end 
```

或者

```
return if tagged?('ignore') 
```

从你的食谱中，这些类型的用途应该没问题。

# java - Scala api 和 java 兼容性，需要重新映射吗？

> ID：14078348
> 
> 赞同：3
> 
> 时间：2012-12-29T03:03:20.087
> 
> 标签：java, scala

假设我有一个 scala 库，它公开了采用 scala 特定类型的 api 方法（比如一个在 java 中不可用的集合）。

这是否意味着您必须更改公开的参数，或者将集合更改为与 java 兼容的类型，然后对其进行迭代并初始化 scala 特定的集合？

基本上我得到的是，在设计将在java中使用的scala api时，你必须使用兼容的类型，或者如果你必须迭代java集合并将其映射到scala one，你必须支付性能/内存损失，对吗？

基本上是这样的选择吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T05:07:32.763

来自[http://www.scala-lang.org/faq/4](http://www.scala-lang.org/faq/4)

> Scala 与 Java 兼容是什么意思？
> 
> 标准的 Scala 后端是 Java VM。Scala 类是 Java 类，反之亦然。您可以从另一种语言的方法中调用任何一种语言的方法。您可以在 Scala 中扩展 Java 类，反之亦然。主要限制是一些 Scala 特性在 Java 中没有等价物，例如特征。

另外，要回答您的问题，请访问[如何在 Java 代码中使用 scala.collection.immutable.List](https://stackoverflow.com/questions/6578615/how-to-use-scala-collection-immutable-list-in-a-java-code)

# python - 使用 jira-python 进行基本身份验证

> ID：14078351
> 
> 赞同：9
> 
> 时间：2012-12-29T03:03:58.403
> 
> 标签：python, jira

我是 Python 新手，是 jira-python 库的新手，也是网络编程的新手，尽管我在应用程序和集成编程以及数据库查询方面确实有相当多的经验（尽管已经有一段时间了）。

使用 Python 2.7 和请求 1.0.3

我正在尝试使用这个库 - [http://jira-python.readthedocs.org/en/latest/](http://jira-python.readthedocs.org/en/latest/)使用 Python 查询 Jira 5.1。我使用未经身份验证的查询成功连接，尽管我必须对 in 中的一行进行更改`client.py`，更改

我变了

```
self._session = requests.session(verify=verify, hooks={'args': self._add_content_type}) 
```

至

```
self._session = requests.session() 
```

我不知道我到底在做什么，但在更改之前我得到了一个错误，在更改之后我得到了一个成功的项目名称列表。

然后我尝试了基本身份验证，这样我就可以利用我的 Jira 权限并进行报告。最初也失败了。我做了同样的改变

```
def _create_http_basic_session 
```

在`client.py`，但现在我又遇到了另一个错误。所以问题没有解决。现在我得到一个不同的错误：

```
HTTP Status 415 - Unsupported Media Type
type Status report
message Unsupported Media Type

description The server refused this request because the request entity is in
a format not` `supported by the requested resource for the requested method 
(Unsupported Media Type). 
```

所以我决定只使用 requests 模块做一个超级简单的测试，我相信 jira-python 模块正在使用它，这段代码似乎让我登录了。我得到了很好的回应：

```
import requests

r = requests.get(the_url, auth=(my username , password))
print r.text 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-12-31T18:46:22.793

以下是我在 Python 脚本中使用带有身份验证的[jira模块的方法：](https://github.com/pycontribs/jira)

```
from jira.client import JIRA
import logging

# Defines a function for connecting to Jira
def connect_jira(log, jira_server, jira_user, jira_password):
    '''
    Connect to JIRA. Return None on error
    '''
    try:
        log.info("Connecting to JIRA: %s" % jira_server)
        jira_options = {'server': jira_server}
        jira = JIRA(options=jira_options, basic_auth=(jira_user, jira_password))
                                        # ^--- Note the tuple
        return jira
    except Exception,e:
        log.error("Failed to connect to JIRA: %s" % e)
        return None

# create logger
log = logging.getLogger(__name__)

# NOTE: You put your login details in the function call connect_jira(..) below!

# create a connection object, jc
jc = connect_jira(log, "https://myjira.mydom.com", "myusername", "mypassword")

# print names of all projects
projects = jc.projects()
for v in projects:
       print v 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2017-02-21T06:44:52.337

下面的 Python 脚本连接到 Jira 并进行基本身份验证并列出所有项目。

```
from jira.client import JIRA
options = {'server': 'Jira-URL'}
jira = JIRA(options, basic_auth=('username', 'password'))
projects = jira.projects()
for v in projects:
   print v 
```

它会打印您的 Jira 实例中所有可用项目的列表。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-08-10T15:15:56.663

**问题：**

> 自 2019 年 6 月起，在 Jira 或 Confluence Cloud 中使用具有基本或基于 cookie 身份验证的 REST 端点的 Atlassian Cloud 用户将需要更新其应用程序或集成流程以使用 API 令牌、OAuth 或 Atlassian Connect。

> 2019 年 6 月 5 日之后，尝试使用 Atlassian 帐户密码通过基本身份验证进行身份验证将返回无效凭据错误。

*参考：[弃用使用 Jira 和 Confluence API 的密码进行基本身份验证](https://confluence.atlassian.com/cloud/deprecation-of-basic-authentication-with-passwords-for-jira-and-confluence-apis-972355348.html)*

**上述问题的解决方法：**

您可以使用 API 令牌对 Atlassian 云产品的脚本或其他进程进行身份验证。您从 Atlassian 帐户生成令牌，然后将其复制并粘贴到脚本中。

如果您使用两步验证进行身份验证，您的脚本将需要使用 REST API 令牌进行身份验证。

**从您的 Atlassian 帐户创建 API 令牌的步骤：**

1.  登录[https://id.atlassian.com/manage/api-tokens](https://id.atlassian.com/manage/api-tokens)
2.  单击创建 API 令牌。
3.  在出现的对话框中，为您的令牌输入一个容易记住且简洁的标签，然后单击创建。
4.  单击复制到剪贴板，然后将令牌粘贴到您的脚本中。

**参考：[API 令牌](https://confluence.atlassian.com/cloud/api-tokens-938839638.html)**

**Python 3.8 代码参考**

```
from jira.client import JIRA
jira_client = JIRA(options={'server': JIRA_URL}, basic_auth=(JIRA_USERNAME, JIRA_TOKEN))
issue = jira_client.issue('PLAT-8742')
print(issue.fields.summary) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-02-04T09:13:45.927

不要更改库，而是将您的凭据放入 ~/.netrc 文件中。

如果你把它们放在那里，你还可以使用 curl 或 wget 测试你的调用。

我不再确定与 Jira 5.x 的兼容性，目前仅测试了 7.x 和 6.4。如果您设置一个实例进行测试，我也可以修改集成测试以针对它运行。

我的幸运猜测是你用那个改变打破了它。

# python - python - 如何根据从文件中读取的字符串动态创建具有名称的函数？

> ID：14078357
> 
> 赞同：4
> 
> 时间：2012-12-29T03:04:48.823
> 
> 标签：python, dynamic-function

假设我有一个包含字符串“unpredictable_words”的文件。我想读入这个字符串，然后定义一个函数，如下所示：

```
def test_unpredictable_words(self):
    do_important_stuff() 
```

然后我想将此函数注入到类定义中，以便可以在此类的任何实例上调用此函数。

我怎样才能做到这一点？

我看了看这个答案 - [https://stackoverflow.com/a/8160676/1701170](https://stackoverflow.com/a/8160676/1701170) - 但我不认为它完全符合我的要求，或者至少我不明白发生了什么。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T03:08:04.987

```
Python 2.7.3 (default, Sep 26 2012, 21:51:14) 
>>> def injected(self):
...     print 'injected'
... 
>>> class A(object):
...     pass
... 
>>> A.injected = injected
>>> a = A()
>>> a.injected()
injected
>>> def func2(self):
...     print 'func2'
... 
>>> setattr(A, 'injected2', func2)
>>> a.injected2()
func2
>>> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-29T03:55:04.667

您无需在一个真实名称下定义一个函数。函数是一流的实体，您可以传递它们并分配给变量。在顶层，您可以使用与`globals()`另一个函数`locals()`一起绑定名称：

```
>>> def foo(x):
...   return x + 1
... 
>>> name = 'unpredictable_words'
>>> 
>>> globals()['test_' + name] = foo
>>> 
>>> test_unpredictable_words(1)
2
>>> 
>>> def some_function():
...   locals()['test_' + name] = foo
...   return test_unpredictable_words(1)
... 
>>> some_function()
2
>>> 
```

有时您仍然希望函数知道它的名称，以便在堆栈跟踪中很好地显示。现在`test_unpredictable_words`显示为`foo`错误消息。这不容易解决，因为该名称已存储在`foo.func_code.co_name`其中且无法更改。

# html - CSS Sprites 得到太多的精灵，或者根本没有

> ID：14078359
> 
> 赞同：0
> 
> 时间：2012-12-29T03:06:41.667
> 
> 标签：html, css, sprite

编辑：尝试将高度更改为 27px，因为 kennypu 说这是一个问题，还没有运气。

我有一个图标精灵，我正在尝试获取其中的一部分，因此我可以将它们用于导航。但是，它似乎获得了太多的精灵，或者根本没有进入导航栏，我阅读了很多文章，观看了很多视频，阅读了很多 SO 问题，但似乎无法修复它。

JSfiddle 链接是：http: [//jsfiddle.net/m5kbX/](http://jsfiddle.net/m5kbX/)

精灵的链接是：[https ://www.dropbox.com/s/t4fowiw1zda3qcq/icons.png](https://www.dropbox.com/s/t4fowiw1zda3qcq/icons.png)

html也是：

```
<div id="header-right">
            <ul id="navigation">
                <li>
                    <div class="nav-button">
                        <div id="schools">
                        </div>
                    </div>
                    <div class="nav-text">
                        Schools
                    </div>
                </li>
                <li>
                    <div class="nav-button">
                        <div id="professors">
                        </div>
                    </div>
                    <div class="nav-text">
                        Professors
                    </div>
                </li>
                <li>
                    <div class="nav-button">
                        <div class="Programs">
                        </div>
                    </div>
                    <div class="nav-text">
                        Programs
                    </div>
                </li>
                <li>
                    <div class="nav-button">
                        <div class="account">
                        </div>
                    </div>
                    <div class="nav-text">
                        My Account
                    </div>
                </li>
            </ul>
        </div> 
```

CSS是：

```
#header-right{
    float: right;
    width: 381px;
    height: 64px;
    background-image:url('http://localhost/gradebyme/gradebyme/public/img/midtile2.png');
    background-repeat:repeat-x;
}

#navigation{
    position: relative;
    background: url('http://localhost/gradebyme/gradebyme/public/img/icontest.png') no-repeat;
    margin: 0;
    padding: 0;
    list-style: none;
}

#navigation li{
    width: 88px;
    height: 64px;
    display: inline-block;
    text-align: center;
}

.nav-button{
    width: 88px;
    height: 40px;
}

.nav-text{
    width: 88px;
    height: 24px;
    color:white;
}

#schools{
    float: left;
    width: 37px;
    height: 26.75px;
    background-position: 0 0;
}

#professors{
    float: left;
    width: 37px;
    height: 26.75px;
    background-position: 0 -27px;
}

#programs{
    float: left;
    width: 37px;
    height: 26.75px;
    background-color: green;
    background-position: 0 -55px;
}

#account{
    float: left;
    width: 37px;
    height: 26.75px;
    background-color: purple;
    background-position: 0 -83px;
} 
```

精灵的第一个点是显示前 2 个半图标，并溢出容器，而其余的则什么也不显示。请帮助并尽可能多地给我关于 css sprites 和 css 的建议！学习是最好的方法！不只是修理你知道吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T03:54:44.730

你还没有给他们背景。

```
 #schools{
        float: left;
        width: 37px;
        height: 26.75px;
        background-position: 0 0;
background: ????
    }

    #professors{
        float: left;
        width: 37px;
        height: 26.75px;
        background-position: 0 -27px;
background: ????
    }

    #programs{
        float: left;
        width: 37px;
        height: 26.75px;
        background-color: green;
        background-position: 0 -55px;
background: ????
    }

    #account{
        float: left;
        width: 37px;
        height: 26.75px;
        background-color: purple;
        background-position: 0 -83px;
background: ????
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T04:15:53.020

好的，这有很多问题，从糟糕的 css 选择器（大小写很重要，id 和类不同！）到背景图像没有应用于正确的元素......

我已经将它调试为我认为它应该从原始代码中工作：[更新的 Fiddle](http://jsfiddle.net/m5kbX/6/)，要让小提琴工作，下载海报提供的精灵并使用本地服务器放入计算机上的“localhost/img”目录运行，如 WAMP。

HTML：

```
<div id="header-right">
    <ul id="navigation">
        <li id="schools" class="nav-text">
            <div class="nav-button">
            </div>
            Schools
        </li>
        <li id="professors" class="nav-text">
            <div class="nav-button">
            </div>
            Professors
        </li>
        <li id="programs" class="nav-text">
            <div class="nav-button">
            </div>
            Programs
        </li>
        <li id="account" class="nav-text">
            <div class="nav-button">
            </div>
            My Account
        </li>
    </ul>
</div>​ 
```

CSS：

```
#header-right{
    float: right;
    width: 381px;
    height: 64px;
    background-image:url('http://localhost/img/midtile2.png');
    background-repeat:repeat-x;
    background-color: grey;
    border: 1px solid;
}

#navigation{
    position: relative;
    margin: 0;
    padding: 0;
    list-style: none;
}

#navigation li{
    display: inline-block;    
    float: left;
    text-align: center;    
    width: 88px;
    height: 64px;
}

#navigation li .nav-button{    
    background-image: url('http://localhost/img/icons.png');
    background-repeat: no-repeat;    
    width: 37px;
    height: 27px;
    margin: 0 auto 13px;

}
.nav-text{
    color: white;
}

#schools .nav-button{
    background-position: 0 0;
}

#schools .nav-button:hover{
    background-position: -37px 0;
}

#schools .nav-button:active{
    background-position: -74px 0;
}

#professors .nav-button{
    background-position: 0 -27px;
}

#professors .nav-button:hover{
    background-position: -37px -27px;
}

#professors .nav-button:active{
    background-position: -74px -27px;
}

#programs .nav-button{
    background-position: 0 -55px;
}

#programs .nav-button:hover{
    background-position: -37px -55px;
}

#programs .nav-button:active{
    background-position: -74px -55px;
}

#account .nav-button{
    background-color: black;
    background-position: 0 -83px;
}

#account .nav-button:hover{
    background-position: -37px -83px;
}

#account .nav-button:active{
    background-color: #1ca4de;
    background-position: -74px -83px;
} 
```

# java - 如何使用 Jsoup 从标签元素中检索字符串？

> ID：14078363
> 
> 赞同：0
> 
> 时间：2012-12-29T03:07:39.803
> 
> 标签：java, android, regex, string, replace

我使用 Jsoup 从网络获取元素：

```
Elements addresses = doc.select("address > div"); 
```

结果是这样的：

```
<address>
    <div>
    7135 S Kingery Hwy<br>Willowbrook, IL 60527
</div>
<div class="phone">
        (630) 288-6635
</div>
</address> 
```

我很难从标签中检索地址。我使用 text() 方法：

```
for (Element address : addresses) {
    Log.i("addresses", address.text() );
} 
```

结果是：

```
7135 S Kingery Hwy Willowbrook, IL 60527
(630) 288-6635 
```

如何过滤它以仅检索地址并将 br 标记替换为换行符？预期结果：

```
7135 S Kingery Hwy 
Willowbrook, IL 60527 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T04:20:20.523

你可以试试这个

```
 Elements addresses = doc.select("address > :not(div[class=phone])");
    for (Element address : addresses) {
        for (Node node : address.childNodes()) {
            if (node.nodeName().equals("br")) {
                continue;
            }
            String text = node.toString().trim();
            System.out.println(text);
        }
    } 
```

# jquery - 使用 Jquery 从 div 中删除文本

> ID：14078368
> 
> 赞同：0
> 
> 时间：2012-12-29T03:08:44.103
> 
> 标签：jquery, css, html, replace

我正在使用以下 jQuery 代码从特定 div 中删除文本“(2012)”。

```
var el = $("#myDiv");  
//replace(/word to remove/ig, "");  
el.html(el.html().replace(/(2012)/ig, "")); 
```

这在删除 2012 时效果很好，但括号 () 仍然存在。我如何告诉 jquery`()`不是代码，而是我希望删除的文本？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T03:12:00.857

试试这个：`.replace("(2012)","")`

这么简单的事情不需要正则表达式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T03:17:45.743

只需使用反斜杠转义括号

```
var el = $("#myDiv");  
//replace(/word to remove/ig, "");  
el.html(el.html().replace(/\(2012\)/ig, "")); 
```

这是它的一个[例子](http://jsfiddle.net/Mnz93/)。

此外，您可以像这样简化它：

```
var el = $("#myDiv");
el.replaceWith(""); 
```

[jsFiddle 示例](http://jsfiddle.net/eENMM/)

**编辑 3**：

感谢 Ryan 指出 i 不是必需的。同样经过进一步考虑，我意识到您可能在 div 中包含更多内容，而不仅仅是日期，在这种情况下，以下代码应该最适合您：

```
var el = $("#myDiv");
el.html(el.html().replace(/\(2012\)/, "")); 
```

[jsFiddle 示例](http://jsfiddle.net/vMg2Z/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T03:12:10.730

转义括号：

```
var str = "hello(2012)";
console.log(str.replace(/(\(2012\))/,''));​​​​​​ 
```

# com - SAP RFC CALL FROM OLE 对象

> ID：14078369
> 
> 赞同：1
> 
> 时间：2012-12-29T03:09:30.143
> 
> 标签：com, ole, saprfc

我正在制作一个 Sap 接口我正在使用 COM / OLE 对象我不了解 SAP，但与我一起工作的人有一点经验。

他说导入答案有很多信息，我应该从我的代码中获取它，但是当我检查导入参数时，我只是得到一个结构，rfc 答案中没有表格

他说，当从 SAP GUI 运行 RFC 时，它返回一个表，但是当我从 COM /OLE 调用它时，没有

进口结构有信息吗？rfc 应该返回一个包含信息的表吗？RFC 答案中是否缺少某些内容？

我希望有人可以向我解释 RFC 是如何工作的，因为我认为 rfc 需要其他东西才能工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T14:44:28.980

代表 RFC 函数（让我们称之为`rfcFuncObject`）的 OLE 对象有一个成员`tables`。例如：

```
Object rfcFuncObject = functionCtrl.Add("RFC_CUSTOMER_GET")
Object rfcTable = theFunc.tables

Object customerItem = rfcTable.Item("CUSTOMER_T") 
```

[请参阅help.sap.com 上](http://help.sap.com/saphelp_470/helpdata/en/40/b297fcc32711d194ac00a0c94260a5/content.htm)的完整示例

# matlab - 如何防止在matlab中关闭输入对话框？

> ID：14078374
> 
> 赞同：2
> 
> 时间：2012-12-29T03:10:39.217
> 
> 标签：matlab

如何避免用户直接关闭输入对话框而不输入任何值？对于“菜单”功能，我们可以使用 while options==0 来形成循环，用于未选择的选项，但是输入对话框呢？

prompt = {'输入增益：'，'输入范围：'};

dlg_title = '输入值';

num_lines = 1;

def = {'20','256'}; ％默认

答案 = inputdlg（提示，dlg_title，num_lines，def）；

%%%获取输入的两个值%%%%

%A = getfield(answer,{1}); %第一个输入字段

A = str2double(answer{1});

%B = getfield(answer,{2}); %第二个输入字段

B = str2double(answer{2});

假设我有一个如图所示的输入对话框，我如何用循环完整地建模它

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T04:00:46.540

您无法阻止它被关闭，但您可以使用 while 循环重新打开它，直到用户输入有用的值。

```
done = false;
while ~done
    a=inputdlg('enter a number')
    num = str2double(a{1}); %# will turn empty and strings into NaN
    if isnumeric(num)
       done = true;
    else
       %# keep running while loop
       %# you can pop up an errordlg box here to tell the user what was wrong.
       %# It would be nice if you were to set the inputs that passed the test
       %# as defaults for the next call of inputdlg. Nothing sucks as much 
       %# as having to completely re-fill a form because of a small typo
    end
end 
```

# java - 一旦 HTMLUnit 忽略 form.setActionAttribute 和 fom.setAttribute 就向正确的 URL 发送请求

> ID：14078375
> 
> 赞同：0
> 
> 时间：2012-12-29T03:10:47.203
> 
> 标签：java, forms, httpwebrequest, html-parsing, htmlunit

我正在尝试使用提交表单，`HTMLUnit`但似乎一旦 http 帖子进入同一页面，表单的 action 属性就会被忽略。我在这个 URL 上得到了表格：

[http://www.tjse.jus.br/tjnet/consultas/internet/consnomeparte.wsp](http://www.tjse.jus.br/tjnet/consultas/internet/consnomeparte.wsp)

而在这个URL的源码中我们可以发现action属性设置为这个URL：

[http://www.tjse.jus.br/tjnet/consultas/internet/respconsnomeparte.wsp](http://www.tjse.jus.br/tjnet/consultas/internet/respconsnomeparte.wsp)

但`HTMLUnit`总是发布到第一个 URL。

我正在使用 fiddler 通过真实的 Web 浏览器分析请求，并通过`HTMLUnit`比较两者`HTTP POST`很容易看出`HTMLUnit`正在发布到同一个站点，即提到的第一个 URL。

我需要`HTMLUnit POST`第二个 URL。

如果有人可以帮助我，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T02:22:50.157

问题解决了。

而不是使用：

```
HtmlPage page2 = button.click(); 
```

我用了：

```
button.click().getWebResponse().getContentAsString(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-18T13:08:16.313

我会使用与以下类似的东西。

```
// Enter your username in feild
searchForm.getInputByName("Username").setValueAttribute(schoolID);

//Submit the form and get the result page       
HtmlPage pageResult = (HtmlPage) searchForm.getInputByValue("Search").click();

//Page results in raw html source code  
String html = pageResult.asXml();

    /*
    * filter source code if needed to collect desired data
    */

//login via another server url
page = (HtmlPage) webClient.getPage("https://"+url);
HtmlForm LoginForm = page.getFormByName("Form1");

// login to web portal
LoginForm.getInputByName("txtUserName").setValueAttribute(username);
LoginForm.getInputByName("txtPassword").setValueAttribute(password);

//Submit the form and get the result page
HtmlPage pageResult = (HtmlPage) LoginForm.getInputByName("btnLogin").click(); 
```

注意：此 htmlUnit 代码符合 htmlunit 2.15 API

# node.js - 与 node.js 相关的问题

> ID：14078378
> 
> 赞同：6
> 
> 时间：2012-12-29T03:11:36.940
> 
> 标签：node.js

我对 node.js 比较陌生。我有一个与之相关的问题。据我了解，node.js 使用事件驱动范式，因此它只产生一个线程并异步处理所有内容（事件驱动方式）。这有助于它消耗更少的资源并处理大量同时连接。

但是，我有一个与此相关的问题，因为它只有一个线程，即使是一个未处理的异常也可能使一切崩溃，不是吗。不像 apache 这样的 node.js 网络服务器可以使用多个进程来处理多个连接，即使一个进程崩溃也没关系。

所以，我有点担心 node.js 是否适合。我只是一个初学者。所以任何见解都会有所帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T07:06:37.247

让我们用一个类比来解释这个相对较新的技术：一个唱机和十个用户：

**PHP** 多线程：10个唱机，每个唱机一个手臂+针，每个用户一个唱机。每个用户从他们自己的电唱机上播放几个音符。未处理的异常，或嘶嘶声 = 电唱机继续播放，直到用户抬起手臂/进程关闭。没有人能听到它，因为他们有自己的唱机。他们戴着耳机。

**NodeJS：**单线程

一台唱机，有 10 根手臂+针，每个用户一个，他们都共享那台唱机。每个用户同时访问一些快速的笔记，一个过程，不记录。它是异步的，每个人都得到一段音乐。一个未处理的异常 = 一个用户的嘶嘶声，只有那些访问相同的几个音符，或者抛出异常的相同进程也会听到嘶嘶声。但仅此而已。其他人仍然会听到甜美的音乐。他们仍然有自己的耳机。

*K. 不要再做不好的类比了。*

**这是您假设问题的解决方案**：在 Node.js 中，您可以将侦听器附加到“uncaughtException”事件。因此，如果有问题的进程会或可能在极少数情况下关闭服务器，则可以终止它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T21:01:29.827

我使用 Cluster 来解决单线程可靠性问题。[Cluster](http://nodejs.org/api/cluster.html)是内置库之一，您可以将其配置为启动一个或 (n) 个工作程序实例。通常，您为服务器中的每个 CPU 内核启动一个实例。主进程监视来自工作进程的事件（我不确定进程是否 100% 正确）并且可以捕获终止、记录它们，然后重新启动工作进程。理想情况下，您还希望拥有多个区域性 Web 服务器和一个负载均衡器，可以监控您的 Web 服务器，检测它们何时过载或无响应，并采取适当的措施，例如启动新实例和杀死死的实例

使用集群的典型代码如下所示（基于集群文档中的示例）：

```
var cluster = require('cluster');
var http = require('http');
var numCPUs = require('os').cpus().length;

if (cluster.isMaster) {
    // Fork workers.
    for (var i = 0; i < numCPUs; i++) {
        cluster.fork();
    }
    cluster.on('exit', function(worker, code, signal) {
        console.log('worker ' + worker.process.pid + ' died');
        // restart this instance
        cluster.fork();
    });
} else {
    // create an error handler for uncaught exceptions so we can log them
    process.on('uncaughtException', function(err) {
        var date = new Date ();
        var message = date.toString () + ":UNCAUGHT EXCEPTION\n" + err.stack + "\n";
        console.log (message);
        process.exit(1); // we will get restarted by the cluster process
    });
    // Workers can share any TCP connection
    // In this case its a HTTP server
    http.createServer(function(req, res) {
        res.writeHead(200);
        res.end("hello world\n");
    }).listen(8000);
} 
```

# c++ - 模板方法特化链接错误

> ID：14078381
> 
> 赞同：11
> 
> 时间：2012-12-29T03:12:09.513
> 
> 标签：c++, templates, c++03

考虑以下头文件和源文件：

```
// main.cpp
#include "myClass.h"

int main()
{
  MyClass m;
  m.foo<double>();
  m.foo<float>();
} 
```

* * *

```
// myClass.h
#pragma once

#include <iostream>

using namespace std;

class MyClass
{
public:

  template <typename T>
  void foo()
  {
    cout << "Template function<T> called" << endl;
  }

  template <>
  void foo<int>()
  {
    cout << "Template function<int> called" << endl;
  }

  template <>
  void foo<float>();

}; 
```

* * *

```
// myClass.cpp
#include "myClass.h"

template <>
void MyClass::foo<float>()
{
  cout << "Template function<float> called" << endl;
} 
```

`foo<float>`我得到一个关于专业化的链接错误。如果我将专业化的定义放在头文件中，那么一切都会按预期工作。

我认为原因可能是该方法没有显式实例化（尽管完全专业化`template class`不需要显式实例化来正确链接）。如果我尝试显式实例化该方法，则会收到此错误：

> 错误 C3416：“MyClass::foo”：可能未显式实例化显式特化

**所以问题是：**

*   有没有办法在`cpp`文件中定义专业化并正确链接？
*   如果不是，为什么不呢？我可以显式地实例化非专门化的模板方法。为什么完全专业化不一样？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-29T07:02:17.937

尽管 WhozCraig 的答案（现已删除）提供了解决您问题的正确代码，但这里有一些直接回答您的问题，包括对您的代码的评论：

1.  `foo<int>()`并且`foo<float>()`是成员模板的显式特化。那些不能出现在它们所属的类的定义中。该标准说：

    > (§14.7.3/3) [...] 类或类模板的定义应在类或类模板的成员模板的显式特化声明之前。[...]

    所以你必须把它们放在类定义之后。

2.  在头文件中完全定义的情况下`foo<int>`，这意味着您必须将单词放在`inline`定义之前；否则，如果头文件包含在多个翻译单元中，链接器就会遇到麻烦。

3.  的特化`foo<float>()`定义在一个单独的文件中，该文件稍后链接到`main.cpp`. 这是可能的，但它要求在头文件中给出它的声明（你已经这样做了，但你必须在类定义之外这样做）：

    ```
     template <>
      void MyClass::foo<float>(); 
    ```

    这是必需的，因为标准中的另一个声明：

    > (§14.7.3/6) 如果模板、成员模板或类模板的成员是显式特化的，则应在第一次使用该特化之前声明该特化，这将导致发生隐式实例化，在每个发生此类使用的翻译单元；不需要诊断。[...]

4.  由于所有特化都是*显式*的（即完全特化，用你的话来说），不需要显式实例化，但它们是可能的（第 14.7.2 节）。您可以将它们放在 .cpp 文件的末尾，语法为：

    ```
    template void MyClass::foo<float>();
    template void MyClass::foo<int>(); 
    ```

    同样，这仅对*没有*自己显式特化的类型真正有用。

因此，头文件和实现文件的正确代码如下所示：

.h 文件：

```
class MyClass
{
public:
  template <typename T> void foo()
  { cout << "Template function<T> called" << endl; }
};

template <> inline void MyClass::foo<int>()
{ cout << "Template function<int> called" << endl; }

template <> void MyClass::foo<float>(); 
```

.cpp：

```
#include "myClass.h"

template <> void MyClass::foo<float>()
{ cout << "Template function<float> called" << endl; }

/* This is unnecessary for float, but may be useful for
   types that do not have their own explicit specializations: */
template void MyClass::foo<float>(); 
```

# git - 将 Apache 与存储库同步

> ID：14078383
> 
> 赞同：0
> 
> 时间：2012-12-29T03:12:16.657
> 
> 标签：git, apache, svn, sync

我将开始一个新项目，我将拥有一个具有两个域（一个用于测试，另一个用于稳定）的 Apache。

我可能会使用 Git，所以假设我使用 Git 作为版本控制。我想将测试子域与存储库同步——这意味着，当有人提交到最终的 Git 服务器时，测试子域将运行最新的提交。

实现这一目标的正确方法是什么？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T03:15:32.143

如果你使用 Github，那么：

[https://help.github.com/articles/post-receive-hooks](https://help.github.com/articles/post-receive-hooks)

你的服务器上需要一个脚本，它可以在收到通知时执行 git pull。

这里有更多： [http ://www.bram.us/2012/05/06/automatic-website-publishing-with-git-github-style/](http://www.bram.us/2012/05/06/automatic-website-publishing-with-git-github-style/)

还有更多： [git/github和web服务器部署配置](https://stackoverflow.com/questions/4236161/git-github-and-web-server-deployment-configuration)

# java - 在 html5 中嵌入 Java 小程序

> ID：14078390
> 
> 赞同：2
> 
> 时间：2012-12-29T03:13:59.213
> 
> 标签：java, html, swing, applet, invocationtargetexception

我正在尝试将我刚刚制作的 Java 小程序嵌入到符合 HTML 5 的页面中。我正在使用以下标签嵌入 .jar 文件：

```
<object type="application/x-java-applet" height="300" width="550">
      <param name="code" value="MainClassName" />
      <param name="archive" value="MyJarFileName.jar" />
      Applet failed to run.  No Java plug-in was found.
</object> 
```

Java 小程序将尝试运行但停止：

```
java.lang.reflect.InvocationTargetException 
```

我无法找到导致此错误的原因。我的 .jar 文件将自行运行良好。主类 extends `JApplet`，其中包含一个框架，其中包含一个 JPanel。

是什么导致了这个错误？

# iphone - 如何检测圆形视图内的触摸

> ID：14078392
> 
> 赞同：3
> 
> 时间：2012-12-29T03:14:17.737
> 
> 标签：iphone, objective-c, ios

![在此处输入图像描述](../Images/8651f0f4099183fc36003c47196c83c5.png)

我有一个圆形的 UIView。我必须只检测紫色圆圈内的触摸。必须忽略圆圈外的所有触摸，例如黑色方块和白色背景。

设置半径和检测触摸没有任何用处，因为当多个视图使用不同的控制器相互叠加时，将很难管理。

有什么办法吗，我可以做到这一点。请你能给我一些建议吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-29T03:31:02.227

创建一个自定义子类`UIView`，说`CircularView`并覆盖该`pointInside:withEvent:`方法以忽略位于圆外的点。这个子类的一个对象将是自包含的，你可以按照你想要的任何方式来安排它。

要确定圆形区域是否包含点，可以使用 Core Graphics 函数`CGPathContainsPoint`或`containsPoint:`. `UIBezierPath`这将要求您*记住*代表圆圈的`CGPathRef`或`UIBezierPath`对象。在此示例中，我假设您已使用创建了一个循环路径，`UIBezierPath`并将其存储为`CircularView`类的属性。

```
@interface CircularView : UIView

// initialize this when appropriate
@propery (nonatomic, strong) UIBezierPath *circularPath;

@end

@implementation CircularView

- (BOOL)pointInside:(CGPoint)point withEvent:(UIEvent *)event {
    return [circularPath containsPoint:point];
}

@end 
```

就是这样。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-29T04:46:34.913

如果您有圆的半径，您可以轻松地应用条件来触摸。检查**触摸点**和**圆心**之间的距离，并检查距离是否小于圆的半径，然后进行触摸，否则忽略它。

您可以使用以下方法计算距离：

```
-(float)distanceWithCenter:(CGPoint)current with:(CGPoint)SCCenter
{
    CGFloat dx=current.x-SCCenter.x;
    CGFloat dy=current.y-SCCenter.y;

    return sqrt(dx*dx + dy*dy);
}

- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event
{
 CGFloat radius=5;
 CGPoint centerOfCircle=CGPointMake(140,200);
 UITouch *touch=[touches anyObject];
 CGPoint touchPoint=[touch locationInView:self.view];

 CGFloat distance=[self distanceWithCenter:centerOfCircle with:touchPoint];

 if (distance<=radius) {
  //perform your tast.
 }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-07T21:43:39.453

为你的圈子创建一个 UIView 的子类，然后像这样覆盖 PointInside：

```
- (BOOL)pointInside:(CGPoint)point withEvent:(UIEvent *)event
{
    if (![super pointInside:point withEvent:event])
    {
        return NO;
    }
    BOOL isInside = (pow((point.x-self.frame.size.width/2), 2) + pow((point.y - self.frame.size.height/2), 2) < pow((self.frame.size.width/2), 2)) ? YES:NO;
    return isInside;
} 
```

您可以放弃“isInside”变量，但这种方式更容易测试。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-12-29T03:17:36.527

您可以简单地制作一个按钮并将其设置为自定义大小并使其成为圆形，并且任何时候用户触摸它，它都可以将 1 添加到触摸次数的整数或浮点数上。就那么简单。

# c - 大小为 8 和其他内容的无效读取

> ID：14078393
> 
> 赞同：-1
> 
> 时间：2012-12-29T03:14:19.417
> 
> 标签：c, memory-management, valgrind

我是 C 的新手，我似乎在实现链表时遇到了很多问题。List 有效，无效的是内存管理。我不是最擅长的，但我似乎做错了一些事情。

我从 valgrind 收到大小为 8 的无效读取。确切的错误如下：

```
==2155== Invalid read of size 8
==2155==    at 0x401271: DestroyLinkedList (in /home/btm7984/hw3/TestList)
==2155==    by 0x400EFE: main (TestList.c:92)
==2155==  Address 0x8788218 is 8 bytes inside a block of size 24 free'd
==2155==    at 0x4C2A82E: free (in /usr/lib/valgrind/vgpreload_memcheck-amd64-lin ux.so)
==2155==    by 0x401202: RemoveFromBackOfLinkedList (in /home/btm7984/hw3/TestLis t)
==2155==    by 0x400EB3: main (TestList.c:87)
==2155==
==2155== Invalid read of size 8
==2155==    at 0x401242: DestroyLinkedList (in /home/btm7984/hw3/TestList)
==2155==    by 0x400EFE: main (TestList.c:92)
==2155==  Address 0x8788218 is 8 bytes inside a block of size 24 free'd
==2155==    at 0x4C2A82E: free (in /usr/lib/valgrind/vgpreload_memcheck-amd64-lin ux.so)
==2155==    by 0x401202: RemoveFromBackOfLinkedList (in /home/btm7984/hw3/TestLis t)
==2155==    by 0x400EB3: main (TestList.c:87)
==2155==
==2155== Invalid read of size 8
==2155==    at 0x40124E: DestroyLinkedList (in /home/btm7984/hw3/TestList)
==2155==    by 0x400EFE: main (TestList.c:92)
==2155==  Address 0x8788210 is 0 bytes inside a block of size 24 free'd
==2155==    at 0x4C2A82E: free (in /usr/lib/valgrind/vgpreload_memcheck-amd64-lin ux.so)
==2155==    by 0x401202: RemoveFromBackOfLinkedList (in /home/btm7984/hw3/TestLis t)
==2155==    by 0x400EB3: main (TestList.c:87)
==2155==
==2155== Invalid free() / delete / delete[] / realloc()
==2155==    at 0x4C2A82E: free (in /usr/lib/valgrind/vgpreload_memcheck-amd64-lin ux.so)
==2155==    by 0x401258: DestroyLinkedList (in /home/btm7984/hw3/TestList)
==2155==    by 0x400EFE: main (TestList.c:92)
==2155==  Address 0x8788160 is 0 bytes inside a block of size 104 free'd
==2155==    at 0x4C2A82E: free (in /usr/lib/valgrind/vgpreload_memcheck-amd64-lin ux.so)
==2155==    by 0x400EE0: main (TestList.c:89)
==2155==
==2155== Invalid free() / delete / delete[] / realloc()
==2155==    at 0x4C2A82E: free (in /usr/lib/valgrind/vgpreload_memcheck-amd64-lin ux.so)
==2155==    by 0x401264: DestroyLinkedList (in /home/btm7984/hw3/TestList)
==2155==    by 0x400EFE: main (TestList.c:92)
==2155==  Address 0x8788210 is 0 bytes inside a block of size 24 free'd
==2155==    at 0x4C2A82E: free (in /usr/lib/valgrind/vgpreload_memcheck-amd64-lin ux.so)
==2155==    by 0x401202: RemoveFromBackOfLinkedList (in /home/btm7984/hw3/TestLis t)
==2155==    by 0x400EB3: main (TestList.c:87)
==2155==
==2155== Invalid free() / delete / delete[] / realloc()
==2155==    at 0x4C2A82E: free (in /usr/lib/valgrind/vgpreload_memcheck-amd64-lin ux.so)
==2155==    by 0x400F1C: main (TestList.c:94)
==2155==  Address 0x8787dd0 is 0 bytes inside a block of size 24 free'd
==2155==    at 0x4C2A82E: free (in /usr/lib/valgrind/vgpreload_memcheck-amd64-lin ux.so)
==2155==    by 0x401264: DestroyLinkedList (in /home/btm7984/hw3/TestList)
==2155==    by 0x400EFE: main (TestList.c:92)
==2155==
==2155== Invalid free() / delete / delete[] / realloc()
==2155==    at 0x4C2A82E: free (in /usr/lib/valgrind/vgpreload_memcheck-amd64-lin ux.so)
==2155==    by 0x400F2B: main (TestList.c:95)
==2155==  Address 0x8787dd0 is 0 bytes inside a block of size 24 free'd
==2155==    at 0x4C2A82E: free (in /usr/lib/valgrind/vgpreload_memcheck-amd64-lin ux.so)
==2155==    by 0x401264: DestroyLinkedList (in /home/btm7984/hw3/TestList)
==2155==    by 0x400EFE: main (TestList.c:92)
==2155==
==2155==
==2155== HEAP SUMMARY:
==2155==     in use at exit: 24 bytes in 1 blocks
==2155==   total heap usage: 413,183 allocs, 413,188 frees, 26,444,136 bytes allo cated
==2155==
==2155== LEAK SUMMARY:
==2155==    definitely lost: 24 bytes in 1 blocks
==2155==    indirectly lost: 0 bytes in 0 blocks
==2155==      possibly lost: 0 bytes in 0 blocks
==2155==    still reachable: 0 bytes in 0 blocks
==2155==         suppressed: 0 bytes in 0 blocks
==2155== Rerun with --leak-check=full to see details of leaked memory
==2155==
==2155== For counts of detected and suppressed errors, rerun with: -v
==2155== ERROR SUMMARY: 13 errors from 7 contexts (suppressed: 2 from 2) 
```

这来自以下代码：

```
 FILE *fp;
   char tmpString[100];
   LinkedLists *ListPtr = malloc(sizeof(LinkedLists));
   ElementStructs *DataPtr;
   LinkedListNodes* curr = malloc(sizeof(LinkedListNodes));
   int counter = 0;
   int Done = 0;
   if (argc ==2){
   InitLinkedList(ListPtr);
   fp = fopen(argv[1], "r");
   if (!fp){
     fprintf(stderr,"%s Cannot open file %s\n", argv[0], argv[1]);
     exit(1);
   }
   do{
     fscanf(fp,"%s",tmpString);
     if (!feof(fp)) {
       DataPtr = malloc(sizeof(ElementStructs));
       strcpy(DataPtr->str,tmpString);
       DataPtr->index=counter;
       AddToBackOfLinkedList(ListPtr, DataPtr);
       counter++;
       Done = 1;
     } else {
       Done = 0;
     }
   }while (Done);

   printf("The first 6 elements of the LinkedList:\n");
   curr = ListPtr->FrontPtr;
   printf("Element %d is %s\n",curr->ElementPtr->index,curr->ElementPtr->str);
   curr = curr->Next;
   printf("Element %d is %s\n",curr->ElementPtr->index,curr->ElementPtr->str);
   curr = curr->Next;
   printf("Element %d is %s\n",curr->ElementPtr->index,curr->ElementPtr->str);
   curr = curr->Next;
   printf("Element %d is %s\n",curr->ElementPtr->index,curr->ElementPtr->str);
   curr = curr->Next;
   printf("Element %d is %s\n",curr->ElementPtr->index,curr->ElementPtr->str);
   curr = curr->Next;
   printf("Element %d is %s\n\n",curr->ElementPtr->index,curr->ElementPtr->str);

   fclose(fp);
   DestroyLinkedList(ListPtr);
   free(ListPtr);
   free(curr);
   free(curr);
   exit(0);
   return 0;
   } else {
     fprintf(stderr,"Usage: %s <inputfile>", argv[0]);
     return 2;
   } 
```

在一个单独的模块中，我定义了其中一些函数，值得注意的是，DestroyLinkedLists：

```
void DestroyLinkedList(LinkedLists *ListPtr){
   LinkedListNodes* temp = ListPtr->FrontPtr;
   LinkedListNodes* nextTemp = ListPtr->FrontPtr;
   for (;temp->Next!=NULL;){
     nextTemp = temp->Next;
     free (temp->ElementPtr);
     free (temp);
     temp = nextTemp;
   }ListPtr->NumElements=0;
   ListPtr->FrontPtr=NULL;
   ListPtr->BackPtr=NULL;
} 
```

任何帮助找出这些内存错误将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T04:26:51.887

我发现你的代码有两个问题...

**问题1：销毁函数应该是这样的，**

```
void DestroyLinkedList(LinkedLists *ListPtr)
{
        while(ListPtr->FrontPtr != NULL)
        {
                LinkedListNodes *removedNode = ListPtr->FrontPtr;
                ListPtr->FrontPtr = ListPtr->FrontPtr->Next;

                /* Deallocate element in node */
                free(removedNode->ElementPtr);

                /* Deallocate node */
                free(removedNode);
        }
        free(ListPtr);
} 
```

中调用销毁函数后的代码`main`，

```
...
fclose(fp);
DestroyLinkedList(ListPtr);
//free(ListPtr); //remove these 3 lines
//free(curr);
//free(curr);
... 
```

**问题2：你为什么`malloc` `curr`，你用它来遍历目的，**

```
ElementStructs *DataPtr;
//LinkedListNodes* curr = malloc(sizeof(LinkedListNodes)); //remove malloc this line and add following line,
LinkedListNodes* curr;
int counter = 0; 
```

你能粘贴`ElementStructs`..的结构吗？

像链接会有所帮助:)

[C 链表中的内存泄漏](https://stackoverflow.com/questions/14069536/memory-leaks-in-c-linked-list/14069797#14069797)

# winforms - 数据适配器“填充”不反映最近添加

> ID：14078395
> 
> 赞同：0
> 
> 时间：2012-12-29T03:14:51.277
> 
> 标签：winforms, sql-server-ce

使用 SQL CE 构建 C# WinForms 应用程序。我使用“已连接”SQL CE 语句“添加”记录，但有一个视图（使用 BindingSource 和 DataAdapter）显示所有客户端记录。此视图不包括最近的更改。

例如，我添加了两条客户端记录，当我转到使用数据适配器的视图时，这两条最近的记录不会出现。如果我重新启动应用程序，它们就在那里。

我怎样才能让它们立即反映在数据库中？

使用 SQL CE，数据库 - 一个 *.SDF 文件 - 是 VS 解决方案的一部分，与表单等源位于同一目录中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T05:59:27.957

解决。我发现这个问题的答案是这个线程。 [http://social.msdn.microsoft.com/forums/en-US/winformsdatacontrols/thread/fefef2d3-7674-40f5-87db-729bfea9b14f](http://social.msdn.microsoft.com/forums/en-US/winformsdatacontrols/thread/fefef2d3-7674-40f5-87db-729bfea9b14f)

必须在调用 Fill 方法之前设置连接字符串。

# c# - PaintEvent 内存泄漏

> ID：14078399
> 
> 赞同：2
> 
> 时间：2012-12-29T03:15:33.517
> 
> 标签：c#, winforms, memory, paint, memory-leaks

我目前正在使用表单上的绘画事件将图像绘制到屏幕上。（想想背景图像）和该图像顶部的一些矩形。

```
 private void MainWindow_Paint(object sender, PaintEventArgs e)
 {
    e.Graphics.Clear(Color.CornflowerBlue);
    e.Graphics.DrawImage(Image.FromFile(m_Directory + @"\Images\" + BackgroundText), m_Screen);
    e.Graphics.FillRectangle(BGBrush, new Rectangle(X, Y, Width, Height));
    e.Graphics.DrawString(Text, Settings.TextFont, Other.Settings.TextBrush, new Rectangle(X, Y + 2, Width, Height));
 } 
```

该页面经常被重新绘制（几乎在每个鼠标移动事件中）并且导致使用大量内存。达到 1,500,000k 之前它会停止绘制到表单并在图片上显示带有红十字的白色背景以表示绘制失败。

我对它是如何跑得如此糟糕感到有点不知所措。我是绘画活动的新手，所以任何帮助都将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T05:25:07.957

`Image`是`IDisposable`，因此您应该在“使用”块中执行 DrawImage 调用，以确保处理图像。

但最重要的是，我会重新考虑在 Paint 事件中执行繁重的 IO 操作。可能提前加载图像，让 Paint 事件只担心绘图。您当前正在加载相同的图像数百次。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T05:02:56.313

我认为如果你的 UI 线程一直在使用，终结器将被阻塞。这些对象可能会被垃圾回收，但可处置的对象将被添加到终结器队列中。终结器在 UI 线程中运行，因此如果您的 UI 线程很忙，则不会调用 dispose。图形对象通常包装一个非托管对象，并且该对象需要使用 dispose() 进行清理。

完成绘画后，我会手动处理所有与图形相关的对象。

# c - 从 Fortran 运行时出现 METIS 段错误

> ID：14078401
> 
> 赞同：2
> 
> 时间：2012-12-29T03:15:50.130
> 
> 标签：c, fortran, fortran90, metis

我正在尝试使用[METIS](http://glaros.dtc.umn.edu/gkhome/views/metis)库进行网格划分，作为我为有限元计算编写的 Fortran 程序的一部分。METIS 是用 C 语言编写的，但它应该可以在 Fortran 90 上正常工作。但我不断遇到段错误。

一个潜在的问题是我给出了一些空指针的参数。其他一些人在从 fortran 调用 C 函数以识别空指针对象时遇到了麻烦。这是在[这里](http://glaros.dtc.umn.edu/gkhome/node/852)解决的，我认为这不是我遇到的问题。

我认为问题在于让 METIS 更改起始数组索引；在 C 中它是 0，在 Fortran 中它是 1。有一个数组传递给每个函数，如果你想要 Fortran 约定`options`，它应该有一个`METIS_OPTION_NUMBERING`你可以更改的字段。`1`不这样做会导致 C 程序尝试访问索引 0，从而给您 seg 错误。

edunlop1[在这里](http://compgroups.net/comp.lang.fortran/how-to-call-a-metis-subroutine-from-my-fort/597185)的帖子建议我只是创建一个数组`options`，并且与 METIS 达成的一些约定确定该数组的哪个元素应该设置为 1，以便对所有内容重新编号。但这取决于您使用的例程，数组长度也会发生变化。

无论如何，这是我的代码：

```
integer :: ndomains,ncommon,objval
integer :: options(0:40)
integer, dimension(:), allocatable :: eptr,eind
integer, pointer :: vwgt(:)=>null(), vsize(:)=>null(), opts(:)=>null()
real(kind=8), pointer :: tpwgts(:)=>null()

! Read in the mesh data
call getarg(1,meshname)
call readmesh(meshname)
allocate(color(ne),domain(nn))
allocate(eind(3*ne),eptr(ne+1))
do n=1,ne
    eptr(n) = 1+3*(n-1)
    do i=1,3
        eind( eptr(n)+i-1 ) = elem(i,n)
    enddo
enddo

! Try and call METIS
ncommon = 2
ndomains = 2
options = 0
options(0) = 1
options(8) = 1
call METIS_PartMeshDual(ne,nn,eptr,eind,vwgt,vsize, &
    & ncommon,ndomains,tpwgts,options,objval,color,domain) 
```

METIS 中用于更改编号的相关代码位于文件 libmetis/meshpart.c 中：

```
/* renumber the mesh */
if (options && options[METIS_OPTION_NUMBERING] == 1) {
  ChangeMesh2CNumbering(*ne, eptr, eind);
  renumber = 1;
} 
```

有什么想法吗？如果有帮助，我可以发布 Valgrind 输出。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T02:14:05.403

这可能没有什么，但也许问题第二段中的链接帖子仍然是相关的。

Fortran 中的 POINTER 和 C 中的指针不是完全相同的概念，**尤其是当 Fortran 指针指向数组时**。在 Fortran 中实现指向数组的指针需要存储超出 C 指针（只是数据的地址）中存储的附加信息（数组边界或等效信息）。

（从技术上讲，除非 METIS_PartMeshDual 的相关虚拟参数定义具有可选或指针属性（如果它是被调用的 C 函数并且语言标准为 <= F2008，则不可能），那么在 Fortran 调用中对分离指针的引用是非法。再次 - 实现取决于会发生什么 - 我可以想象它会在哪里工作和在哪里不会工作的实施选项。）

请注意，在您链接到空指针声明的帖子中，作为解决方案的一部分从数组更改为标量（列表中的第一个回复 - 检查帖子的时间）。在作为问题的一部分发布的示例代码中，“null”事物的声明仍然显示数组。我怀疑声明中的更改会更改调用 C api 的“设置”和/或解离指针对于您的编译器的外观。

这些天来，当从 Fortran 调用 C API 时，我更喜欢（在可能的情况下）使用 Fortran 2003 的 C 互操作性特性（BIND(C) 和朋友）为 C API 编写接口块。这更加健壮，并且避免了这种依赖于平台的问题。它确实需要一次性的前期工作以及支持 F2003 的这一方面的 Fortran 编译器。为他们的 Fortran 用户提供这样的接口块而麻烦的库供应商从我那里得到了一个很大的选择和很多好意的想法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T07:58:30.240

Fortran 数组大小比 C 更灵活。您可以将 Fortran 数组设为 0 索引，或任何您想要的起始索引。

```
real, dimension (0:N-1) :: array
real, dimension (:), allocatable :: group
allocate (group (0:N-1)) 
```

如果对起始索引的某种分歧是问题所在，那么这可能会有所帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-02T03:25:32.223

采用：

```
vwgt=>null() 
```

代替

```
vwgt(:)=>null() 
```

对于所有空值（即，vwgt、vsize、opts、tpwgts 等）。问题是 vwgt(:) 并没有真正定义，而不仅仅是 vwgt 或 vwgt(1)。如果仍然有问题，请使用调试器检查所有值。

我是第 2 段中提到的线程中的 OP。不幸的是，最终解决方案位于回复的顶部（请参阅时间戳）。希望有帮助。

# php - PHP中的递增/递减运算符优先级

> ID：14078415
> 
> 赞同：2
> 
> 时间：2012-12-29T03:20:15.217
> 
> 标签：php, operator-precedence

有人可以帮我理解这段代码，因为它似乎不遵循 PHP 中递增/递减运算符的优先级和关联性原则：（这是来自 PHP 手动递增/递减运算符页面中的评论 - [http：/ /php.net/manual/en/language.operators.increment.php](http://php.net/manual/en/language.operators.increment.php) )

第一个例子 -

```
$a = [ 0, 1, 2 ];
$i = 0;
$a[$i++] = $i;

var_dump( $a ); 
```

/* 这里是输出：

```
array (size=3)
  0 => int 1
  1 => int 1
  2 => int 2 
```

这是我对正在发生的事情的解释：

```
1\. Array index gets calculated, so $a[$i++] is $a[0]
2\. Then rval gets calculated (which after $i++ in the step above) is now 1
3\. The value of the expression gets calculated which is  1. 
```

到目前为止，一切都很好。*/

第二个例子 -

```
$a = [ 0, 1, 2 ];
$i = 0;
$a[$i] = $i++;

var_dump( $a ); 
```

/* 这里是输出：

```
array (size=3)
  0 => int 0
  1 => int 0
  2 => int 2 
```

这是我对正在发生的事情的解释：

```
1\. The array index gets calculated which should be 0 ($a[0]), but ACTUALLY it is 1 ($a[1])
2\. The rval gets calculated , which is $i++ , so the value now is 0.
3\. The expression value gets calculated , which should be 1 after $i++ in the step above,   but ACTUALLY it is 0. 
```

所以从根本上说，我无法理解上面第二个示例中的步骤 1 和 3。*/

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T03:29:05.490

来自与您的代码相同的评论：

> 赋值索引表达式和值表达式都在任何实际赋值发生之前进行评估，这意味着无论您将帖子 incr/decr 放在哪里，您都可能不会得到您想要的结果。

在行上，LHS 上`$a[$i++] = $i;`的索引表达式和RHS 上的值表达式都在赋值发生之前被评估。`$i++``$i`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T03:31:05.013

这与递增的优先级没有太大关系，因为它与赋值运算符的优先级有很大关系。将首先评估任何赋值表达式的左侧。

在上面的第一种情况下，这将选择`a[0]`作为要分配的位置，递增`$i`，然后执行 的分配`$i`，即 now `1`。

# android - GridView pointToPosition 带间距

> ID：14078416
> 
> 赞同：4
> 
> 时间：2012-12-29T03:20:25.990
> 
> 标签：android, layout, gridview

我的应用程序使用 gridview 来显示一些项目，我希望在该 gridview 中进行一些拖放。基本上用户可以选择一个项目并将其移动到不同的位置。这并不难实现，但我偶然发现了一个小问题。当该点*位于*两个网格单元之间时`pointToPosition`返回。这是可以理解的，但并没有真正的帮助——在我的情况下，我向用户展示了当他拖动东西时的顺序预览，当他拖动间距时，我突然不知道我应该显示什么.`INVALID_POSITION`

 *一种解决方案是实际删除间距。但我仍然想要瓷砖之间的一些视觉间距。

有可能我错过了一些计算最接近给定位置的瓷砖的方法。

让gridview在元素之间具有“仅视觉”间距的最佳方式是什么？

我当前（临时？最终？）的解决方案是根本不使用背景并将它们直接绘制到 gridview 背景中。不过，这似乎不是一个好主意。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T22:02:33.273

这就是我最后要使用的：spacing = 0 和 layer-list drawable 包含带有圆角的 shapedrawable。另一个这样的可绘制对象用作网格视图的选择器：

padded_border_normal.xml：

```
<item android:left="3dp"
      android:right="3dp"
      android:top="3dp"
      android:bottom="3dp">

    <shape android:shape="rectangle">
        <solid android:color="@android:color/transparent" />
        <stroke android:color="#8033b5e5" android:width="@dimen/border_width"/>
        <corners android:radius="7dp"/>
        <size android:height="60dp" android:width="60dp" />
    </shape>
</item> 
```

padded_border_pressed.xml：

```
<item android:left="3dp"
      android:right="3dp"
      android:top="3dp"
      android:bottom="3dp">

    <shape android:shape="rectangle">
        <solid android:color="#6033b5e5" />
        <stroke android:color="#8033b5e5" android:width="@dimen/border_width"/>
        <corners android:radius="7dp"/>
        <size android:height="60dp" android:width="60dp" />
    </shape>
</item> 
```

`grid.setSelector(R.drawable.padded_border_pressed);`创建网格和`result.setBackgroundResource(R.drawable.padded_border_normal);`创建网格列表视图时

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-18T17:59:01.830

我想你已经得到了答案。从 中删除任何间距`GridView`并在每个`ImageView`s 中设置填充以保持您想要的外观，但实际上在单元格之间没有任何间距。您说您必须覆盖`onMeasure()`，我不确定您为什么必须按照上面所说的那样做。只需将`ImageView`宽度设置为与`GridView`单元格相同，然后设置`height=width`，您可能希望将 的缩放设置`ImageView`为`centerInside`。*

# c++ - 为什么 getch() 需要按下一个键才能继续执行其余代码？

> ID：14078417
> 
> 赞同：1
> 
> 时间：2012-12-29T03:20:36.400
> 
> 标签：c++, windows

我有一个功能可以在按下某些键时执行其他功能。如果按下's'，它将射击玩家。如果按下“h”，只会伤害玩家。问题在于选择 = getch(); 以下：

```
void* command(void* data)
{
    choice = getch(); //This is where the problem begins...
    cout << "Command Prompt\n\n"; //I must click enter twice to view this output. why is this???
    while (health > 0)
    {
        if (choice == 's')
        {
            playershot();
        }

        if (choice == 'h')
        {
            playerharm();
        }
    }
} 
```

执行此操作时，出于某种原因，控制台会等待我按两次 ENTER，然后才会输出 <<“命令提示符”；。只有在 2 个 ENTER 之后，我才会看到“命令提示符”输出。为什么 getch() 等待我输入我的字母和 2 个 ENTER ？无论我在哪里使用 getch() 这个函数，它都可以正常工作并且通常不需要我按 Enter 键。这段代码有什么问题，让我按两次 ENTER 最终进入“命令提示符”？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T03:29:54.980

`getch`从输入缓冲区中读取一个字符。根据您配置输入缓冲的方式，您可能不会立即在缓冲区中输入字符——它们可能会保留在驱动程序或其他地方，直到发生其他事件（例如点击“输入”）。

如何配置输入处理取决于您的系统/操作系统。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T05:46:35.300

你应该_getch。根据 MSDN，不推荐使用 getch，应该使用 _getch：

> 从 Visual C++ 2005 开始不推荐使用此 POSIX 函数。请改用符合 ISO C++ 标准的 _getch。

这是_getch的[链接](http://msdn.microsoft.com/en-us/library/078sfkak%28v=VS.100%29.aspx)

# image-processing - DCT 对 -128 到 +127 之间的像素值进行操作

> ID：14078418
> 
> 赞同：5
> 
> 时间：2012-12-29T03:20:47.740
> 
> 标签：image-processing, signal-processing

为什么 DCT（离散余弦变换）要在 JPEG 压缩中的像素值 -128 到 127 之间进行操作？

为什么在对图像应用 DCT 之前对像素值进行水平偏移（减去 128）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T03:44:01.390

你读[维基百科](http://en.wikipedia.org/wiki/JPEG#Discrete_cosine_transform)吗？

使用归一化的二维 II 型离散余弦变换 (DCT) 将每个分量 (Y, Cb, Cr) 的每个 8×8 块转换为频域表示。

在计算 8×8 块的 DCT 之前，它的值从正范围转移到以零为中心的范围。对于 8 位图像，原始块中的每个条目都在 [0, 255] 范围内。从每个条目中减去范围的中点（在本例中为值 128）以生成以零为中心的数据范围，因此修改后的范围为 [-128, 127]。

此步骤降低了随后 DCT 处理阶段的动态范围要求。（除了 DCT 阶段动态范围的差异之外，这一步在数学上相当于在执行变换后从 DC 系数中减去 1024——这可能是在某些架构上执行操作的更好方法，因为它只涉及执行一次减法而不是其中的 64 个）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-12T16:31:01.390

这是我所理解的。假设没有完成电平偏移，那么如果我们在这个矩阵上取 DCT，DC 值（比如**X**）将是一个更大的数字，因为所有像素值都是正的。当对图像像素值进行水平偏移时，一些像素值将是负的，一些会是正的。稍后当我们对结果矩阵进行 DCT 时，DC 值（比如**Y**）现在不会像以前那样是一个更大的数字，即**Y < X**。**因此，存储此数据Y**所需的位数将少于**X**所需的位数。

因此需要电平偏移，并且 DCT 旨在在像素值 -128 到 127 之间进行操作

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-11-07T09:26:14.563

在应用 DCT 之前，像素的 RGB（红、绿、蓝）值在 0-255 范围内。为了使值以 0 为中心（因为很容易找到值的余弦），我们将其减去 128。

访问[http://www.whydomath.org/node/wavlets/basicjpg.html](http://www.whydomath.org/node/wavlets/basicjpg.html)以供参考。

或者你可以这样理解。[0,255] 有 256 个值。256/2 = 128。以 0 为中心，范围变为 [-127,127]。

# android - TextWatcher 类还是接口？

> ID：14078420
> 
> 赞同：0
> 
> 时间：2012-12-29T03:21:40.677
> 
> 标签：android

在书籍和互联网中，例如这里的[Android 处理 ListView 中的许多 EditText 字段](https://stackoverflow.com/questions/8115800/android-handling-many-edittext-fields-in-a-listview)，TextWatcher 是类，但在 android devoloper 上它是接口[http://developer.android.com/reference/android/text/TextWatcher.html](http://developer.android.com/reference/android/text/TextWatcher.html)。而Eclipse说，它是接口。谁是对的？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T05:25:43.203

TextWatcher 是一个接口。在您给出的示例中，它用作接口，MyTextWatcher 类**实现**了 TextWatcher 接口。如果 TextWatcher 是一个类，则需要使用**extends**。

界面：

```
private class MyTextWatcher implements TextWatcher { 
```

班级：

```
private class ThisWontWork extends TextWatcher { 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-11-22T14:39:18.320

TextWatcher 是接口...在 android.text.TextWatcher

```
public interface TextWatcher implements NoCopySpan 
```

# ruby-on-rails - Rails，控制器中条件查询之间的简单数字

> ID：14078422
> 
> 赞同：1
> 
> 时间：2012-12-29T03:22:44.450
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我猜相当容易，但不知何故，文档缺少这个（也许是它的简单性）。

我想显示表中的值介于最小值和最大值之间。

我的代码是：

```
def something
  @foo = Foo.where( :number => ((params[:min])..(params[:max])) )
  respond_to do |format|
    ...
  end
end 
```

难道我做错了什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-29T03:36:32.670

您是否检查过您的参数是数字而不是字符串？

```
@foo = Foo.where(number: (params[:min].to_i)..(params[:max].to_i)) 
```

Rails 确实接受范围

```
# select all where number between 1 and 10
Foo.where number: 1..10

# between 1 and 9
Foo.where number: 1...10 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T03:28:39.903

想想你将如何使用 SQL 来做同样的事情。以下应该工作：

`Foo.where("number>?", params[:min]).where("number<?",params[:max])`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T03:54:24.180

你所拥有的应该可以工作，但在这些情况下，我喜欢对进入数据库的内容添加一些控制。通常，我会这样写

```
def something
  # Make sure something gets set and is an integer
  min = (params[:min] || 0).to_i
  max = (params[:max] || 10).to_i

  # Do some basic range checking so that the query doesn't return every row in the database
  min = 0 if min < 0
  max = 100 if max > 100

  @foo = Foo.where( :number => (min..max) )
  respond_to do |format|
    ...
  end
end 
```

实际上，我刚刚添加的额外代码应该放在 Foo 对象上的一个方法中以获取数据，因为这会使控制器与应该是模型代码的代码混淆。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-01-11T06:31:39.467

find_by_all 方法：

```
Foo.find_all_by_number(params[:min]..params[:max]) 
```

或使用一些 SQL

```
Foo.where('id in (?)', params[:min]..params[:max]) 
```

# php - 在 vBulletin 中使用 curl 登录网站

> ID：14078426
> 
> 赞同：2
> 
> 时间：2012-12-29T03:23:29.727
> 
> 标签：php, curl, login, vbulletin

我一直在尝试按照此链接上的说明登录到站点[（www.siamchart/forum） 。](http://www.siamchart/forum)[使用 PHP cURL 登录到远程站点](https://stackoverflow.com/questions/3008817/login-to-remote-site-with-php-curl)。我无法通过登录。运行以下脚本后，它会将我重定向到相同的登录页面（www.siamchart/forum），但没有成功登录。

我的代码如下..

```
$username="ABC"; 
$password="12345"; 
$url="www.siamchart.com/forum/login.php?do=login"; 
$cookie="siamchart_cookie.txt"; 

$postdata = "vb_login_username=".$username."&vb_login_password=".$password; 

$ch = curl_init(); 
curl_setopt ($ch, CURLOPT_URL, $url); 
curl_setopt ($ch, CURLOPT_SSL_VERIFYPEER, FALSE); 
curl_setopt ($ch, CURLOPT_USERAGENT, "Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.6) Gecko/20070725 Firefox/2.0.0.6"); 
curl_setopt ($ch, CURLOPT_TIMEOUT, 60); 
curl_setopt ($ch, CURLOPT_FOLLOWLOCATION, 1); 
curl_setopt ($ch, CURLOPT_RETURNTRANSFER, 1); 
curl_setopt ($ch, CURLOPT_COOKIEJAR, $cookie); 
curl_setopt ($ch, CURLOPT_REFERER, $url); 

curl_setopt ($ch, CURLOPT_POSTFIELDS, $postdata); 
curl_setopt ($ch, CURLOPT_POST, 1); 
$result = curl_exec ($ch); 

echo $result;  
curl_close($ch); 
```

# 编辑

该论坛正在使用vBulletin。这是登录页面中的脚本

```
<script type="text/javascript" src="clientscript/vbulletin_md5.js?v=4111"></script>
   <form id="navbar_loginform" action="login.php?do=login" method="post" onsubmit="md5hash(vb_login_password, vb_login_md5password, vb_login_md5password_utf, 0)">
   <fieldset id="logindetails" class="logindetails">
   <div>
     <div>
     <input type="text" class="textbox default-value" name="vb_login_username" id="navbar_username" size="10" accesskey="u" tabindex="101" value="User Name" />
     <input type="password" class="textbox" tabindex="102" name="vb_login_password" id="navbar_password" size="10" />
     <input type="text" class="textbox default-value" tabindex="102" name="vb_login_password_hint" id="navbar_password_hint" size="10" value="Password" style="display:none;" />
     <input type="submit" class="loginbutton" tabindex="104" value="Log in" title="Enter your username and password in the boxes provided to login, or click the 'register' button to create a profile for yourself." accesskey="s" />
     </div>
   </div>
   </fieldset>
   .
   .
</script> 
```

我做错什么了吗？非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T03:25:22.317

该网站正在重定向您，但您已禁用重定向。改变它：

```
curl_setopt ($ch, CURLOPT_FOLLOWLOCATION, 1); 
                                          ^-- 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-17T05:22:37.000

我现在正在处理同样的问题。您不要发送密码的 md5 哈希，在 VB 中它是在发送登录帖子之前即时生成的。防止更改打开的密码信息。

这里也是帖子变量的确切列表：

```
action="login.php?do=login" 
"vb_login_username" 
"vb_login_password" 
"s" value="" />
"securitytoken" value="guest" />
"do" value="login" />
"vb_login_md5password" />
"vb_login_md5password_utf" /> 
```

就像它的形式一样，我现在正在尝试登录。

# amazon - 如何使用 Amazon API 轻松恢复购买？

> ID：14078428
> 
> 赞同：3
> 
> 时间：2012-12-29T03:24:41.913
> 
> 标签：amazon, in-app-purchase

我正在尝试像 iOS 一样恢复购买，但我不知道如何使用 Amazon API 轻松恢复 IAP 授权购买。

如果我向 发送另一个带有 SKU 的请求`PurchasingManager`，它会返回 a `PurchaseResponse`，但`PurchaseResponse`如果 SKU 已经购买，则不会返回有效的收据。它是空的。

似乎我需要那个 SKU 来进行任何类型的处理。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T08:52:14.040

找到了如何做到这一点。

原来需要一个不同的函数调用而不是`initiatePurchaseRequest`调用。

```
PurchasingManager.initiatePurchaseUpdatesRequest(Offset offset) 
```

此调用获取用户进行的所有购买，然后将它们返回到 PurchasingObserver 以由以下人员处理：

```
PurchasingObserver.onPurchaseUpdatesResponse(PurchaseUpdatesResponse purchaseUpdatesResponse) 
```

# java - 在不刷新页面的情况下对 Strut2 操作进行 ajax 调用

> ID：14078429
> 
> 赞同：3
> 
> 时间：2012-12-29T03:25:05.923
> 
> 标签：java, jquery, ajax, struts2, glassfish

我正在使用 Strut2 运行 Glassfish Web 服务器，我想从操作类中提取 json 数据以获取页面而无需刷新页面。我的意思是，当用户更改设置时，我想自动显示更新的数据而不刷新页面。

对 Strut2 操作类进行 Ajax 调用似乎是我的解决方案，但我的所有 Google 搜索结果都是针对需要刷新页面的情况。

动作类：

```
...
@Override
public String execute() throws Exception {
    result = "\"{\"age\":100,\"name\":\"dude\"}"; 

    return SUCCESS;
}
... 
```

strut.xml：

```
<package name="default" namespace="/" extends="json-default">
    <action name="getData" class="action.getData" method="execute">
        <result type="json" />
    </action>
</package> 
```

阿贾克斯调用：

```
jQuery.ajax(
{
    type: 'POST', 
    url: '/proj/getData', 
    data: {id: $('#id').val()},
    dataType: 'json',
    contentType: 'application/json; charset=utf-8',
    success: function(data){         
        alert(data.result);
    },
    error: function(XMLHttpRequest, textStatus, errorThrown){
        alert('Error ' + textStatus);
        alert(errorThrown);
        alert(XMLHttpRequest.responseText);
    }
}); 
```

上面的代码在动作类中正确调用了正确的函数，但有两个问题。

1.  我不确定如何在服务器端的 ajax 调用的数据部分中提取 id 数据集
2.  返回时我在服务器端收到以下错误。

    ```
    WARNING: StandardWrapperValve[default]: PWC1406: Servlet.service() for servlet default threw exception
      java.lang.NoClassDefFoundError: org/apache/commons/lang3/StringUtils
      at org.apache.struts2.json.SerializationParams.<init>(SerializationParams.java:57)
      at org.apache.struts2.json.JSONResult.writeToResponse(JSONResult.java:207)
      at org.apache.struts2.json.JSONResult.execute(JSONResult.java:171) 
    ```

我对 strut2 很陌生，我知道我用 ajax 和 struts 做过类似的事情，但我似乎无法弄清楚这一点，所以如果你能提供帮助，我将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T03:37:20.723

您需要将`apache common lang`包添加到您的类路径或 WEB-INF/Lib。你可以在这里 [http://commons.apache.org/lang/](http://commons.apache.org/lang/)获取它， 或者如果你使用的是 maven，可以将它添加为 maven 依赖项。

第二件事是您可以将 id 作为参数访问 url

`String id= request.getParameter("id");`要获取请求对象，Action 类必须实现 servletrequestaware 。

```
public class BaseAction extends ActionSupport implements ServletRequestAware {

protected HttpServletRequest request = null;

@Override
public void setServletRequest(HttpServletRequest request) {
    this.request = request;
}

@Override
public String execute() throws Exception {
   String id= request.getParameter("id");
   result = "\"{\"age\":100,\"name\":\"dude\"}"; 

   return SUCCESS;
}

} 
```

您也可以将 id 参数作为 GET 请求传递。

```
jQuery.ajax(
        {
            type: 'GET', 
            url: '/proj/getData?id='+$('#id').val(), 
            //data: {id: $('#id').val()},
            dataType: 'json',
            contentType: 'application/json; charset=utf-8',
            success: function(data){         
                alert(data.result);

             },
             error: function(XMLHttpRequest, textStatus, errorThrown){
                 alert('Error ' + textStatus);
                 alert(errorThrown);
                 alert(XMLHttpRequest.responseText);
             }
        }); 
```

# yii - Yii - 计数和关系

> ID：14078430
> 
> 赞同：0
> 
> 时间：2012-12-29T03:25:13.530
> 
> 标签：yii, relational-database

我目前有一个表格设置用于用户对文章的意见（1 或 0）。

```
CREATE TABLE IF NOT EXISTS `opinion_article` 
(
`id`                INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
`uid`               INT UNSIGNED NOT NULL, /* user with an opinion on the article */
`aid`               INT UNSIGNED NOT NULL, /* article ID */
`opinion`           BOOL NOT NULL, /* opinion on the article, 1 = good, 0 = bad */
FOREIGN KEY (`uid`) REFERENCES `user`(`id`) ON UPDATE CASCADE ON DELETE RESTRICT,
FOREIGN KEY (`aid`) REFERENCES `article`(`id`) ON DELETE CASCADE ON UPDATE CASCADE,
UNIQUE (`uid`, `aid`)
) ENGINE=InnoDB; 
```

我想获得一个用户的“文章分数”，这就是有多少其他用户将他们的文章投票为好。诀窍是用户可以拥有许多文章。有没有办法在不为用户返回所有文章的所有意见的情况下执行此操作，然后使用 for 循环检查意见==1？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T03:35:05.867

在您的文章模型中，添加以下关系：

```
'score'=>array(self::STAT, 'OpinionArticle', 'aid', 'condition'=>'opinion=1') 
```

然后`$Article->score`应该为您返回该号码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T02:30:39.860

随着威廉留下的答案，我来到了这个很好的解决方案。基本上我只是在我的“opinion_article”表中为作者的 ID 添加了一个额外的字段。

```
CREATE TABLE IF NOT EXISTS `opinion_article` 
(
`id`                INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
`uid`               INT UNSIGNED NOT NULL,
`aid`               INT UNSIGNED NOT NULL, /* article ID */
`author_id`         INT UNSIGNED NOT NULL, /* the author of the article's ID */
`opinion`           BOOL NOT NULL, /* opinion on the article, 1 = good, 0 = bad */
FOREIGN KEY (`uid`) REFERENCES `user`(`id`) ON UPDATE CASCADE ON DELETE RESTRICT,
FOREIGN KEY (`aid`) REFERENCES `article`(`id`) ON DELETE CASCADE ON UPDATE CASCADE,
FOREIGN KEY (`author_id`) REFERENCES `user`(`id`) ON UPDATE CASCADE ON DELETE CASCADE,
UNIQUE (`uid`, `aid`)
) ENGINE=InnoDB; 
```

然后，在我的用户模型中，我添加了这一行：

```
 'articleScore'=>array(self::STAT, 'OpinionArticle', 'author_id', 'condition'=>'opinion=1'), 
```

然后我可以通过调用 $user->articleScore 来获得文章分数

# linux - 包括 cpufreq.h 但在 linux c++ 中显示链接器错误

> ID：14078432
> 
> 赞同：0
> 
> 时间：2012-12-29T03:25:27.277
> 
> 标签：linux, g++, linker-errors, undefined-reference

我的问题是我在 linux g++ 中得到一个未定义的引用错误

`cpufreq.h`在`usr/include`目录中，我包括`#include <cpufreq.h>`. 这有声明`cpufreq_get_freq_kernel()`

但是当我调用时`cpufreq_get_freq_kernel()`，它会出现链接器错误：

```
undefined reference to `cpufreq_get_freq_kernel' 
```

我正在使用 netbeans 来编译程序。

有什么解决办法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T20:01:34.497

包括标题通常是不够的，您还需要链接到库，这可能通过添加 `-lcpufreq`到您的链接器命令来完成。

# java - 我有一个非常简单的猜数字游戏，它几乎完成了，但我遇到了一些问题

> ID：14078440
> 
> 赞同：-3
> 
> 时间：2012-12-29T03:27:45.687
> 
> 标签：java, swing, user-interface, timer, progress-bar

我想知道是否有人可以查看我的代码，该代码正在运行，因此您可以复制并测试它。我的问题是当底部栏倒计时到结束时，它应该结束游戏，然后从头开始。但我认为我遗漏了一些代码，或者我的代码没有正确编写来做我想做的事情。任何人都可以查看它并查看我哪里出错了？

这是带有所有 GUI 和 main() 的游戏屏幕：

```
import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Dimension;
import java.awt.FlowLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JTextArea;
import javax.swing.JTextField;
import javax.swing.Timer;

public class GameScreen {

    public static void main(String[] args) throws InterruptedException {
        final ProgressBar progressBar = new ProgressBar() {
            @Override
            public Dimension getPreferredSize() {
                return new Dimension(0, 30);
            }
        };
        final JFrame game = new JFrame();
        final JButton playButton, guessButton;
        final JPanel topPanel, gamePanel, rangePanel, guessPanel;
        final JTextArea gameStatus;
        final GuessingGame gameNumbers;
        final JLabel rangeLabel = new JLabel("Range: ");
        final JTextField playerName = new JTextField("", 20);
        final JTextField guessInput = new JTextField("", 20);

        gameStatus = new JTextArea(10, 20);
        JScrollPane scroll = new JScrollPane(gameStatus);
        gameNumbers = new GuessingGame();

        playButton = new JButton("Play");
        guessButton = new JButton("Guess");
topPanel = new JPanel();
        topPanel.setBackground(Color.yellow);
        topPanel.add(new JLabel("Player: "));
        topPanel.add(playerName);
        topPanel.add(playButton);

        rangePanel = new JPanel(new FlowLayout(FlowLayout.CENTER));
        rangePanel.add(rangeLabel, BorderLayout.CENTER);

        guessPanel = new JPanel();
        guessPanel.add(new JLabel("Guess: "));
        guessPanel.add(guessInput);
        guessPanel.add(guessButton);

        gamePanel = new JPanel(new BorderLayout());
        gamePanel.add(rangePanel, BorderLayout.NORTH);
        gamePanel.add(guessPanel);

        game.setTitle("Guessing Game");
        game.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        game.add(topPanel, BorderLayout.NORTH);
        game.add(scroll, BorderLayout.EAST);
        game.add(gamePanel, BorderLayout.CENTER);
        game.add(progressBar, BorderLayout.SOUTH);

        gameStatus.setFocusable(false);
        guessButton.setEnabled(false);
        guessInput.setEnabled(false);
        final Timer gameTimer = new Timer(1000, new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent ae) {
                if (progressBar.getRunStatus() == false){
                    System.out.println("YAY");
                    guessButton.setEnabled(false);
                    guessInput.setEnabled(false);
                    playButton.setEnabled(true);
                    playerName.setEnabled(true);
                }
            }
        });
        playButton.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent e) {
                if (playerName.getText().equals("")) {
                    JOptionPane.showMessageDialog(gamePanel, "Invalid Player Name");
                } else {
                    progressBar.repaint();
                    progressBar.StartTimer();
                    progressBar.setBackground(Color.gray);
                    gameNumbers.play();
                    gameStatus.append("Game Started!\n");
                    rangeLabel.setText(gameNumbers.toString());
                    guessButton.setEnabled(true);
                    guessInput.setEnabled(true);
                    playButton.setEnabled(false);
                    playerName.setEnabled(false);
                    gameTimer.start();
}
            }
        });
        guessButton.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent e) {
                int playerGuess = Integer.parseInt(guessInput.getText());
                if (gameNumbers.isGuessCorrect(playerGuess)) {
                    gameStatus.append("Game Over!\n");
                    guessButton.setEnabled(false);
                    guessInput.setEnabled(false);
                    playButton.setEnabled(true);
                    playerName.setEnabled(true);
                    JOptionPane.showMessageDialog(gamePanel, "" + playerName.getText() + " wins!");
                }
                if (gameNumbers.isGuessAlmostCorrect(playerGuess)) {
                    gameStatus.append("very close!\n");
                    guessInput.requestFocus();
                }
                if (gameNumbers.isGuessLarger(playerGuess)) {
                    gameStatus.append("try something smaller...\n");
                    guessInput.requestFocus();
                }
                if (gameNumbers.isGuessSmaller(playerGuess)) {
                    gameStatus.append("try something larger...\n");
                    guessInput.requestFocus();
                }
            }
        });

        game.pack();
        game.setVisible(true); 
    }
;
} 
```

这是我的进度条类：

```
import java.awt.Color;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.Rectangle;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.util.ArrayList;
import javax.swing.JPanel;
import javax.swing.Timer;

class ProgressBar extends JPanel {

    public int minValue, maxValue;
    private int currentValue;
    public boolean running;
    private ArrayList<Rectangle> rects = new ArrayList<>();
    private int removeValue = 0;

    public ProgressBar() {
        setMaxValue();
        minValue = 0;
        this.running = true;
        currentValue = maxValue;
        this.setBackground(Color.green);
    }

    public void StartTimer() {
        setMaxValue();
        Timer progressBarCountDownTimer = new Timer(1000, new ActionListener() {
            int count = getMaxValue();
            @Override
            public void actionPerformed(ActionEvent ae) {

                if (getValue() == 0) {
                    setRunStatus(false);
                    ((Timer) ae.getSource()).stop();
                    System.out.println("YAY");
                    ;

                } else {
                    count--;
                    System.out.println(getValue());
                    setValue(count);
                }
                setValue(count);
            }
        });
        progressBarCountDownTimer.start();
    }
@Override
    protected void paintComponent(Graphics g) {
        super.paintComponent(g);
        Graphics2D g2d = (Graphics2D) g;

        rects.clear();
        int rectWidths = getWidth() / getMaxValue();
        int startingX = 0;

        for (int i = 0; i < (getMaxValue() - removeValue); i++) {
            rects.add(new Rectangle(startingX, 0, rectWidths, getHeight()));
            startingX += rectWidths;
        }

        for (Rectangle r : rects) {
            g2d.setColor(Color.green);
            g2d.fillRect(r.x, r.y, r.width, r.height);
        }
    }

    public int getValue() {
        return currentValue;
    }

    public void setRunStatus(boolean running) {
        this.running = running;
    }

    public boolean getRunStatus() {
        if (this.running == true) {
            return true;
        } else {
            return false;
        }
    }

    public void setValue(int value) {
        int rem = value - currentValue;
        removeValue -= rem;
        currentValue = value;
        repaint();
    }

    public int getMaxValue() {
        return maxValue;
    }

    public void setMaxValue() {
        maxValue = RandomValues.integer(5, 20);
    }
} 
```

这是我的猜谜游戏类（）：

```
public class GuessingGame {

    int minRange, maxRange, secretNumber;
    RandomValues randomValue;

    public GuessingGame() {
        randomValue = new RandomValues();
    }

    public int getMinRange() {
        return minRange;
    }

    public int getMaxRange() {
        return maxRange;
    }

    public void setMinRange() {
        this.minRange = randomValue.integer(1, 10);
    }

    public void setMaxRange() {
        this.maxRange = randomValue.integer(80, 100);
    }

    public int getSecretNumber() {
        return secretNumber;
    }

    public void setSecretNumber() {
         this.secretNumber = randomValue.integer(minRange, maxRange);
    }   

    public void play() {
        setMinRange();
        setMaxRange();
        setSecretNumber();
    }

    public boolean isGuessCorrect(int guess) {
        if (guess == this.secretNumber) {
            return true;
        } else {
            return false;
        }
    }

    public boolean isGuessAlmostCorrect(int guess) {
        if (guess >= this.secretNumber - 5 & guess <= this.secretNumber + 5 & guess != this.secretNumber) {
            return true;
        } else {
            return false;
        }
    }

    public boolean isGuessSmaller(int guess) {
        if (guess < this.secretNumber) {
            return true;
        } else {
            return false;
        }
    }

    public boolean isGuessLarger(int guess) {
        if (guess > this.secretNumber) {
            return true;
        } else {
            return false;
        }
    }

    @Override
    public String toString() {
        return String.format("Range: %d to %d answer: %d", getMinRange(), getMaxRange(), getSecretNumber());
    }
} 
```

最后，这只是我获取随机数的简单 RandomValues 类：

```
import java.util.Random;

public class RandomValues {

    public static int integer(int min, int max) {
        Random randomNum = new Random();
        int randomValue = randomNum.nextInt(max - min + 1) + min;
        return randomValue;
    }
} 
```

很抱歉，如果这有点太长了，但是如果您复制并粘贴它，它确实可以工作并加载它只是倒数计时器部分似乎不想按我想要的方式工作.. . 如果有人可以帮助我，我会永远爱他们 :)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T03:56:08.203

在你的`gameTimer`时候`progressBar.getRunStatus() == false`，你需要停止计时器......`((Timer)ae.getSource()).stop();`

现在……老实说，我不会打扰。

我会使用类似`ChangeListener`or的东西`PropetyListener`来提供`ProgressBar`其他类可以注册的回调机制。这意味着反馈变得更加被动，而不是您当前正在经历的这种主动“ping”过程。

基本上，这意味着您将为其他对象提供一种方法，以便在进度条的状态更改时注册感兴趣的通知，并且他们会根据需要对此做出反应。

你`ProgressBar#paintComponent`是......坦率地说......奇怪......

尝试改为绘制一个代表可用宽度百分比的矩形......

```
protected void paintComponent(Graphics g) {
    super.paintComponent(g);
    Graphics2D g2d = (Graphics2D) g;

    int x = 0;
    int y = 0;
    int width = Math.round(getWidth() * (((float)getValue() / (float)getMaxValue())));
    g2d.setColor(Color.GREEN);
    g2d.fillRect(x, y, width, getHeight());

//            rects.clear();
//            int rectWidths = getWidth() / getMaxValue();
//            int startingX = 0;
//
//            for (int i = 0; i < (getMaxValue() - removeValue); i++) {
//                rects.add(new Rectangle(startingX, 0, rectWidths, getHeight()));
//                startingX += rectWidths;
//            }
//
//            for (Rectangle r : rects) {
//                g2d.setColor(Color.green);
//                g2d.fillRect(r.x, r.y, r.width, r.height);
//            }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T04:05:20.077

我认为问题之一是您没有正确停止计时器，而是无意中继续运行。

例如，`ProgressBar`您总是在每次调用`StartTimer`. `((Timer) ae.getSource()).stop();`如果返回 0 ，您尝试通过调用来停止它。`getValue()`我认为它不起作用，因为您有竞争条件并且该值实际上可能变为负数。所以永远不会触发停止。

我建议将 存储`progressBarCountDownTimer`为类的属性，并确保在启动新计时器之前正确停止它。恕我直言，这更强大。

# emacs - 在 emacs org-mode 批量导出中加载包含文件

> ID：14078443
> 
> 赞同：4
> 
> 时间：2012-12-29T03:28:36.097
> 
> 标签：emacs, org-mode

我有一个将几个 org 文件导出到乳胶的 shell 脚本；示例命令如下所示：

```
emacs --batch \
--visit=file.org --funcall org-export-as-latex-batch 
```

的前几行`file.org`是

```
#+TITLE: Titlename
#+INCLUDE: ./preamble.org 
```

`preamble.org`有以下几行：

```
#+AUTHOR:
#+LATEX_HEADER: \usepackage{fullpage}
#+LATEX_HEADER: \usepackage{parskip} 
```

由于某种原因，`preamble.org`当我以批处理模式执行时未加载。当我打开缓冲区并执行时它加载正常`M-x org-export-as-latex`。任何想法我需要做些什么才能`preamble.org`在批处理模式下加载？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-01T02:13:42.330

这条线

```
#+INCLUDE: ./preamble.org 
```

在这两种情况下都不适合我：手动和批处理模式。我用

```
#+SETUPFILE: ./preamble.org 
```

相反，它也可以在批处理模式下工作。

# c++ - C++ numeric_limits 常量和函数

> ID：14078445
> 
> 赞同：2
> 
> 时间：2012-12-29T03:28:52.020
> 
> 标签：c++, std

> **可能重复：**
> [为什么 std::numeric_limits<T>::max() 是一个函数？](https://stackoverflow.com/questions/2766272/why-is-stdnumeric-limitstmax-a-function)

为什么`numeric_limits<T>::has_infinity`是 const 值而`numeric_limits<T>::infinity`不是？为什么要做`numeric_limits<T>::infinity`一个函数？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T03:30:50.163

因为诸如`float`,`double`或`UDT` *静态常*量值之类的东西不能在类中初始化，需要外部定义。简而言之，它们需要一个*内存位置*，而*静态 const 整*数值不需要（只要不采用对它们的指针/引用）。

在**C++11**中，应该声明这些函数`constexpr`，这克服了您可能从它们是函数而不是常量这一事实中看到的任何缺点。

# php - 使用 getJSON 从表单提交中填充选择选项

> ID：14078447
> 
> 赞同：0
> 
> 时间：2012-12-29T03:29:06.620
> 
> 标签：php, jquery, html, json

我在 html 页面上有两个表单，并希望使用第一个表单提交通过 php/mysql 查询从数据库中进行选择，并使用 JSON 进行编码以填充我的第二个表单上的选择选项，而无需离开页面。第一种形式和 php 正在发送数组，但第二种形式没有被填充。不知道我错过了什么，任何帮助表示赞赏。请参阅下面的 html、php 和查询...

HTML

```
<form method="post" action="find.php" id="find" >
    <div class="input-box">
        <label>Last Name</label>
        <input type="text" name="lname"/>
    </div>
    <div class="input-box">
        <label>Phone</label>
        <input type="text" name="phone" />
    </div>
    <div class="submit">
        <input type="submit" value="Select" />
    </div>
</form>
<div><h1>Checkin</h1></div>
<form method="post" action="checkin.php" id="contact-us">
<div id="contact-us-message"></div>
    <input type="hidden" name="date" id="date" />
    <select id="clients" name="clients">
    </select>
    <div class="submit">
        <input type="submit" value="Submit"  />
    </div>
</form> 
```

PHP

```
$lastname = $_POST['lname'] ;
        $number = $_POST['phone'] ;
        $q = "select Site_ID, FirstName, LastName, Email, Phone, Message,     ParentName from ClientInfo where LastName = '$lastname' and Phone = '$number'";
        $sql = mysql_query($q);
        $data = array();
        while($row = mysql_fetch_array($sql, true)){
            $data[] = $row; 
        };
        echo json_encode($data); 
```

脚本

```
<script type="text/javascript">
$("#find").submit(function(){
  $.getJSON('checkin.php',function(data){
    var items = '';
    $.each(data,function(name,value) {
        items += "<option type='text' value='"+value.Site_ID+"'>"+value.FirstName+" "+value.LastName+" </option>" ;
    });
    $("#clients").append(items);  
  });
});
</script> 
```

* * *

编辑

好的，我修复了 id 问题，现在在提交时转到 php 页面并回显正确的数组。但它不应该离开 html 页面。有人知道为什么吗？

大批

```
[{"Site_ID":"10000007","FirstName":"Drew","LastName"...}] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T03:43:43.087

您的脚本仅适用于带有 的元素`id="test"`，而该元素在您的 HTML 中不存在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T03:50:52.703

根据我的说法，尝试尝试`Divide and Conquer`规则，我的意思是划分代码的每一部分并尝试找出，每个部分都正常工作（独立代码）。

`php`关于您的代码的第一件事

```
$lastname = $_POST['lname'] ;  // change to some value
$number = $_POST['phone'] ; // change to some value
$q = "select Site_ID, FirstName, LastName, Email, Phone, Message,ParentName from ClientInfo where LastName = '".$lastname."' and Phone = '".$number."'";
$sql = mysql_query($q);
$data = array();
while($row = mysql_fetch_array($sql, true)){
$data[] = $row; 
};
echo json_encode($data); 
```

首先，做正确`concatenation`的查询。然后检查您当前的`php`代码是否正确`encode`形成`json`？

如果您验证了上面的代码，则转到您的`javascript`代码并检查与代码相关的所有变量`html`。正如你在这里看到的

```
$("#test").submit(function(){ 
```

您提到`test`了 id，但在您的`html`代码中，它不存在。

# java - 用 try-with-resources 包围 Scanner

> ID：14078451
> 
> 赞同：2
> 
> 时间：2012-12-29T03:29:36.230
> 
> 标签：java, file, netbeans, input

我创建了一个算法来读取文件并检查用户输入的多个问题。我正在使用 Netbeans，它建议尝试使用资源。我不确定的是文件的关闭。当我第一次创建我的算法时，我把 file.close() 放在了错误的位置，因为它之前有一个“return”语句而无法访问：

```
while (inputFile.hasNext()) {
        String word = inputFile.nextLine();
        for (int i = 0; i < sentance.length; i++) {
            for (int j = 0; j < punc.length; j++) {
                if (sentance[i].equalsIgnoreCase(word + punc[j])) {

                    return "I am a newborn. Not even a year old yet.";
                }
            }
        }
    }
    inputFile.close(); // Problem 
```

所以我用这个修复了它：

```
 File file = new File("src/res/AgeQs.dat");
    Scanner inputFile = new Scanner(file);
    while (inputFile.hasNext()) {
        String word = inputFile.nextLine();
        for (int i = 0; i < sentance.length; i++) {
            for (int j = 0; j < punc.length; j++) {
                if (sentance[i].equalsIgnoreCase(word + punc[j])) {
                    inputFile.close(); // Problem fixed
                    return "I am a newborn. Not even a year old yet.";
                }
            }
        }  
    } 
```

问题是，当我以错误的方式设置它时，Netbeans 建议这样做：

```
 File file = new File("src/res/AgeQs.dat");
    try (Scanner inputFile = new Scanner(file)) {
        while (inputFile.hasNext()) {
            String word = inputFile.nextLine();
            for (int i = 0; i < sentance.length; i++) {
                for (int j = 0; j < punc.length; j++) {
                    if (sentance[i].equalsIgnoreCase(word + punc[j])) {

                        return "I am a newborn. Not even a year old yet.";
                    }
                }
            }  
        }
    } 
```

Netbeans 是在更正我的代码，还是只是删除文件的关闭？这是做这件事的更好方法吗？除非我确切地知道发生了什么，否则我不喜欢使用代码。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-29T04:04:38.963

try-with-resources 保证 AutoCloseable 资源（如 Scanner）将始终关闭。关闭是由 javac 约隐式添加的。作为

```
Scanner inputFile = new Scanner(file);
try {
    while (inputFile.hasNext()) {
        ....
    }
} finally {
    inputFile.close();
} 
```

顺便说一句，您的代码中存在 Netbeans 未能注意到的问题。Scanner 的方法不会抛出 IOException 而是抑制它。使用 Scanner.ioException 检查读取文件时是否发生异常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T04:02:00.237

> Netbeans 是在更正我的代码，还是只是删除文件的关闭？

它正在更正您的代码。try-with-resource 在隐式 finally 子句中关闭了在资源部分中声明/创建的资源。（所有资源都必须实现`Closeable`接口...）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T03:51:30.317

阅读[本文](http://docs.oracle.com/javase/tutorial/essential/exceptions/tryResourceClose.html)，重新阅读 Java 7 的 try-with-resource 块。

> try-with-resources 语句确保每个资源在语句结束时关闭。

Java 6 不支持 try-with-resources；您必须显式关闭 IO 流。

# java - 在任何 Windows 操作系统中以 UTF-8 格式读取文件

> ID：14078454
> 
> 赞同：0
> 
> 时间：2012-12-29T03:30:13.150
> 
> 标签：java, swing, utf-8, character-encoding

我正在将一个字符串写入一个包含 Ԉ 和 ف 等字符的文件。

我想将编码指定为 UTF-8，因此我被迫将其转换为字节，而不是使用`OutputStreamWriter`或写入为字符`.getBytes("UTF-8")`。

我能够保存和读取文件（并`sysout`在 Eclipse 控制台中执行）。当然，如果我在 Eclipse 中将文件编码属性设置为 UTF-8，我确实会看到我的字符，如 Ԉ 和 ف。

现在我的问题是，如果我将这些字符传递到我的 Swing 应用程序中的文本字段，而不是将这些字符打印到我的控制台，它是否仍能正确显示字符？如果我将我的 Swing 应用程序分发给欧洲的另一个人（不同的 Windows 字符集映射），它是否也能正确显示字符？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T03:41:49.290

你应该没事。AFAIK，用于在 Swing API 中显示文本的 Java API 对本机操作系统默认字符编码/映射不敏感。

# xcode4 - 如何更改 Xcode 4.5 中的默认代码缩进？

> ID：14078455
> 
> 赞同：19
> 
> 时间：2012-12-29T03:30:29.137
> 
> 标签：xcode4, indentation

当我创建一个新的视图控制器时，它的默认代码缩进样式看起来像

```
- (void)viewDidLoad
{
    [super viewDidLoad];
  // Do any additional setup after loading the view.
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
} 
```

我可以更改任何设置，以便默认代码缩进如下所示

```
- (void)viewDidLoad
{
  [super viewDidLoad];
  // Do any additional setup after loading the view.
}

- (void)didReceiveMemoryWarning
{
  [super didReceiveMemoryWarning];
  // Dispose of any resources that can be recreated.
} 
```

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-12-29T03:47:18.200

从菜单栏中选择 Xcode > Preferences…（默认快捷键：command-comma）。然后单击“文本编辑”部分。然后选择“缩进”选项卡。将“缩进宽度”设置为 2。

[![Xcode 首选项](../Images/fb37022ab4d6f22a837bdf9910179fa6.png)](https://i.stack.imgur.com/V1OKB.png)

您可以通过在项目导航器中选择项目，然后在文件检查器的“文本设置”部分中设置“缩进”值来更改一个项目的缩进宽度：

[![在此处输入图像描述](../Images/2e2a19d2071a67787c0e69c543d30d28.png)](https://i.stack.imgur.com/cDoY6.png)

您可以要求 Xcode 使用新的缩进宽度重新格式化现有代码，方法是选择代码并从菜单栏中选择 Editor > Structure > Re-Indent（默认快捷键：control-i）。

# android - Android：如何使用屏幕尺寸缩放布局

> ID：14078460
> 
> 赞同：4
> 
> 时间：2012-12-29T03:31:49.723
> 
> 标签：android, android-layout, android-xml

考虑这个布局（从[这里](http://www.androidradar.net/?p=126)拉）：

![在此处输入图像描述](../Images/02a85597284cc492218811f633498b0a.png)

我想了解使这种布局随屏幕尺寸缩放的原理。对于正方形，自定义 onMeasure 函数可以很好地工作：

```
@Override
protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
    super.onMeasure(widthMeasureSpec, widthMeasureSpec);
} 
```

下面的自定义 Togglebuttons 和 Imagebuttons 的宽度和高度应缩放以填充屏幕的其余部分，减去 layout_margins，并且其中的文本和图像应缩放以填充按钮，减去填充。外边距也应该缩放。

我的第一个想法是使用相对布局来定位按钮，并使用 layout_margin/padding 属性来创建边距。但是，相对布局和 layout_margin/padding 需要固定的像素值，因此它们不可扩展。

然后我想到了使用带有 layout_weights 的嵌套线性布局来定位按钮，并使用占位符视图来创建边距。尽管这些技术是可扩展的，但它们不适用于按钮，因为按钮具有许多需要固定像素值的属性（文本大小、图像大小、角半径等）。例如，此限制意味着以下 xml：

```
<ToggleButton 
    android:layout_weight="1"
    style="@style/myButton"
    [...] />
<View 
    android:layout_weight="1"/>
<ImageButton 
    android:layout_weight="1"
    style="@style/myButton"
    [...] /> 
```

不一定会使两个按钮以及它们之间的空间都具有相同的宽度。这完全取决于按钮的文本大小、图像大小等。

我已经看了一下[这个问题](https://stackoverflow.com/questions/8916363/how-to-make-buttons-automatically-scale-down-when-screen-size-decrease)，但我觉得对于这样一个简单的问题应该有一个更简单的解决方案，不需要求助于太多的非 XML。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-11-12T09:41:52.433

如果您使用“dp”构建您的视图，它基本上与 eack 屏幕尺寸的尺寸相同。
在大多数情况下，您会希望您的视图会根据屏幕大小调整自身大小。
当然，在大多数情况下，您需要为平板电脑构建单独的布局。
但是，除此之外，我还建议您执行以下步骤：

1.[将此](https://github.com/intuit/sdp)库添加到您的项目中。

2\. 现在在您的布局中，您可以编写如下视图：

```
<TextView
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="I'm scalable!" 
    android:textSize="@dimen/_12sdp"/> 
```

在此示例中，您的 TextView 将在每个屏幕尺寸上进行缩放。

3\. 预览所有屏幕尺寸以查看结果。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-29T04:54:58.857

这在很大程度上取决于您要创建的自定义`View`和类的数量。`ViewGroup`我能想到的具有最少数量的自定义类的实现将是这样的（与您所描述的非常相似）：

*   为最大的正方形定制`FrameLayout`，具有自定义`onMeasure()`实现以将高度与可用宽度匹配（您已经提到过这个）。
*   嵌套`LinearLayout`实例使用权重使所有网格按钮的大小相同。

这种方法的最大缺点是效率。您将需要大约 36 个`LinearLayout`实例来在较大的 9x9 网格内创建小的 9x9 网格……这是纯布局开销的 36 个视图。

* * *

至于文本大小，我可以想到几种方法来处理这个问题。一种是使用`Paint.measureTextBounds()`（您可以获取`Paint`任何对象进行`TextView`测量）来确定在测量后每个按钮中的文本需要多大的尺寸。不幸的是，这将是一个迭代过程，因为`Paint`根据当前设置测量给定文本，因此您需要：

1.  设置文字大小
2.  测量范围
3.  检查高度
4.  重复直到尺寸刚好合适

好消息是您只需执行一次并将其应用于所有网格按钮，但您需要等到网格按钮被测量。

这里的另一种选择是在类似的内容中显示图像而不是文本`ImageView`，这可以为您缩放内容到它的大小。您可以使用我编写的[TextDrawable](https://github.com/devunwired/textdrawable)之类的东西将文本内容设置为可缩放而不会损失质量的图像。

* * *

现在回到布局。`ViewGroup`您可以通过创建一个自定义来测量和布置网格来获得大量的效率（这个名称`GridLayout`已经被使用......它并不能完全满足这个目的，所以我们称之为`BlockLayout`）。创建自定义`BlockLayout`将允许您测量每个块的大小，并在一个网格中布置 9 个子视图，使用单个父项而不是 4 个`LinearLayout`实例。这基本上和你测量整个正方形的方法一样，只是平分。

然后，您可以仅使用 10 个布局开销实例来构建整个布局……如果您可以将整个事物编码为单个`ViewGroup`.

基本上，您可以编写越多的代码来扁平化视图层次结构，您的应用程序将整体运行得越好。

高温高压

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-01T17:06:48.010

为了补充 Devnuwired 的答案，您可以编写类似于此的方法将他的`TextDrawable`文本添加到`ImageButton`：

```
private void addText(String text, ImageButton button, int colour) {
    TextDrawable d = new TextDrawable(this);
    d.setText(text);
    d.setTextColor(colour);
    d.setTextAlign(Layout.Alignment.ALIGN_CENTER);
    button.setImageDrawable(d);
} 
```

或交替

```
private void addText(String text, int buttonID, int colour) {
    TextDrawable d = new TextDrawable(this);
    d.setText(text);
    d.setTextColor(colour);
    d.setTextAlign(Layout.Alignment.ALIGN_CENTER);
    ((ImageButton) findViewById(buttonID)).setImageDrawable(d);
} 
```

# php - cakephp 只需要返回 html 但返回文字文本

> ID：14078462
> 
> 赞同：0
> 
> 时间：2012-12-29T03:31:58.053
> 
> 标签：php, jquery, ajax, cakephp

我正在尝试使用 jquery UI 进行自动完成。它的工作原理是当用户在搜索框中输入信息时，会进行 ajax 调用。然后服务器返回 json 结构的 html。这是我的代码。我是根据我在网上找到的教程得到的

# 服务器端代码

```
public function user_lookup() {
    if($this->request->is('ajax')) {
        $this->autoRender=false;
        $users=$this->User->find('all',array('conditions'=>array('User.username LIKE'=>'%'.$_GET['term'].'%')));
        $i=0;
        foreach($users as $user){
            $response[$i]['value']=$user['User']['username'];
            $response[$i]['label']="<img class='avatar' width='24' height='24' src=''/>
                                    <span class='username'>".$user['User']['username']."</span>";
            $i++;
        }
        echo json_encode($response);            
    }
} 
```

# jQuery代码

```
$(document).ready(function() {
    // Caching the movieName textbox:
    var username = $('#SearchUsername');
    // Defining a placeholder text:
    username.defaultText('Search for people');
    // Using jQuery UI's autocomplete widget:
    username.autocomplete({
        minLength    : 1,
        source        : URLSITESUFFIX+'/users/user_lookup'
    });
});
// A custom jQuery method for placeholder text:
$.fn.defaultText = function(value){
    var element = this.eq(0);
    element.data('defaultText',value);

    element.focus(function(){
        if(element.val() == value){
            element.val('').removeClass('defaultText');
        }
    }).blur(function(){
        if(element.val() == '' || element.val() == value){
            element.addClass('defaultText').val(value);
        }
    }); 
    return element.blur();
}; 
```

# 和 html

```
 <?php echo $this->Form->create('ProjectsUser'); ?>
        <?php echo $this->Form->input('Search.username'); ?>
    <?php echo $this->Form->end();?> 
```

但结果返回文字文本而不是呈现 html。我添加了一个截屏视频 [http://screencast.com/t/OhgPHpTWVe](http://screencast.com/t/OhgPHpTWVe)

调试值 [http://screencast.com/t/YVXWug2Bynze](http://screencast.com/t/YVXWug2Bynze)

# recursion - 错误：语句函数是递归的

> ID：14078464
> 
> 赞同：3
> 
> 时间：2012-12-29T03:32:55.567
> 
> 标签：recursion, module, fortran, fortran90, subroutine

这是试图解决一个 3*3 的线性方程并打印出结果，但它在注释行中遇到了问题：

我在程序之外定义了模块 LinearSolution，我应该在里面定义它吗？有什么不同？

为什么它说该语句是递归的，你知道，当我将这些语句用作普通子程序而不是模块子程序时，它们被验证为没问题。

```
module LinearSolution
    type LAE
        integer::N
        double precision,dimension(:,:),allocatable::A
        double precision,dimension(  :),allocatable::B
    contains
        procedure,nopass::RowReduction
    end type LAE
contains
    subroutine RowReduction
        double precision::C
        do k=1,N
            do i=k+1,N
                if(A(k,k)/=0) then
                    C=A(i,k)/A(k,k)
                    B(i)=B(i)-B(k)*C       !error: Statement Function is recursive
                    do j=k+1,N
                        A(i,j)=A(i,j)-A(k,j)*C   !error: Statement Function is recursive
                    end do
                end if
            end do
        end do

        do k=N,1,-1
            do i=k-1,1,-1
                if(A(k,k)/=0) then
                    C=A(i,k)/A(k,k)
                    B(i)=B(i)-B(k)*C  !error: Statement Function is recursive
                end if
            end do
        end do

        do k=1,N
            if(A(k,k)/=0) then
                B(k)=B(k)/A(k,k)  !error: Statement Function is recursive
            end if
        end do
    end subroutine RowReduction
end module LinearSolution

program TestLAE
    use LinearSolution  !fatal error: cant open module file LinearSolution.mod for reading
    type(LAE)::LAE1
    LAE1%N=3
    allocate(LAE1%B(1:N))
    allocate(LAE1%A(1:N,1:N))
    LAE1%B=(/1,1,1/)
    LAE1%A=(/2,0,0,0,2,0,0,0,2/)
    call LAE1%RowReduction
    print*, LAE1%B(1),LAE1%B(2),LAE1%B(3)
end program 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T04:12:24.447

通常情况下，`implicit none`是你的朋友。

让我们一次处理一个错误：

```
B(i)=B(i)-B(k)*C       !error: Statement Function is recursive 
```

`B`编译器在这种情况下无法识别；这里没有声明变量`B`（*），所以它可以做的最好的就是假设它是一个实值[语句函数](http://www.obliquity.com/computer/fortran/function.html)，将 B 定义为 I 的函数。语句函数节省空间，但内联定义函数的方式令人困惑，但在其他不能递归的东西；在这里，您将`B(i)`根据`B(i)`明显失败的方式进行定义。

（*） 但！你哭。 `B`是我类型中的一个数组字段`LAE`！是的，但我们不在 LAE 的上下文中；事实上，在这个函数的上下文中`LAE`，甚至没有使用 B 值的类型变量。这是因为程序已定义`nopass`；你需要有一个变量，它是被操作的对象，它是类的`LAE`，这样我们就可以访问这些字段。看起来像这样：

```
 type LAE
        !...
    contains
        procedure::RowReduction
    end type LAE

contains
    subroutine RowReduction(self)
        class(LAE), intent(InOut) :: self
        double precision::C
        integer :: i, j, k
        do k= 1, self%N
            do i= k+1, self%N
                if( self%A(k,k) /= 0 ) then
        !.... 
```

请注意，我们必须将 self 定义为 of`class(LAE)`而不是 type；class 是类型的超集，在处理可扩展对象时需要它，这些可扩展对象包括具有（重新）可分配组件的对象。还要注意，我们添加了隐式 none，它会立即告诉您`B`没有定义，因此指定了整数索引 i、j 和 k。

一旦`N`、`A`和`B`被正确引用为 的字段`self`，那么程序的其余大部分都是正确的。请注意，您必须对`reshape`数组`LAE1%A`：

```
LAE1%A=reshape((/2,0,0,0,2,0,0,0,2/), (/N, N/)) 
```

但除此之外，一切似乎都很好。

```
module LinearSolution
implicit none

    type LAE
        integer::N
        double precision,dimension(:,:),allocatable::A
        double precision,dimension(  :),allocatable::B
    contains
        procedure::RowReduction
    end type LAE

contains
    subroutine RowReduction(self)
        class(LAE), intent(InOut) :: self
        double precision::C
        integer :: i, j, k
        do k= 1, self%N
            do i= k+1, self%N
                if( self%A(k,k) /= 0 ) then
                    C = self%A(i,k) / self%A(k,k)
                    self%B(i) = self%B(i)- self%B(k)*C
                    do j=k+1, self%N
                         self%A(i,j) = self%A(i,j) - self%A(k,j)*C
                    end do
                end if
            end do
        end do

        do k = self%N,1,-1
            do i=k-1,1,-1
                if( self%A(k,k)/=0) then
                    C= self%A(i,k)/ self%A(k,k)
                    self%B(i)= self%B(i)- self%B(k)*C
                end if
            end do
        end do

        do k=1, self%N
            if( self%A(k,k)/=0 ) then
                self%B(k) = self%B(k) / self%A(k,k)
            end if
        end do
    end subroutine RowReduction
end module LinearSolution

program TestLAE
    use LinearSolution
    implicit none

    integer, parameter :: N = 3
    type(LAE)::LAE1
    LAE1%N=N
    allocate(LAE1%B(1:N))
    allocate(LAE1%A(1:N,1:N))
    LAE1%B=(/1,1,1/)
    LAE1%A=reshape((/2,0,0,0,2,0,0,0,2/), (/N, N/))
    call LAE1%RowReduction
    print*, LAE1%B(1),LAE1%B(2),LAE1%B(3)
end program 
```

运行给出：

```
$ gfortran -o lae lae.f90 -Wall -std=f2003
$ ./lae
  0.50000000000000000       0.50000000000000000       0.50000000000000000 
```

# javascript - 让 div 滚动直到它到达页面顶部？

> ID：14078470
> 
> 赞同：0
> 
> 时间：2012-12-29T03:33:59.617
> 
> 标签：javascript, jquery, css, wordpress

我正在尝试在 wordpress 中使用以下示例 - 我需要一个包含广告的 div 以开始，例如，在页面下方 300 像素，然后向上滚动页面直到它到达顶部，然后如果用户继续滚动则停留在那里向下。该示例应说明这一点：

[http://jsfiddle.net/jPxEY/](http://jsfiddle.net/jPxEY/)

在这里，它在一个应该可以工作的 html 文件中，一切似乎都在那里，但它不起作用：[http ://www.altesc.net/exmp.html](http://www.altesc.net/exmp.html)

事实上，如果您在“类似问题”框中查看并向下滚动，这正是我所追求的。

我很确定我已经正确地完成了所有操作，但是 javascript 似乎不起作用。如果我从 jquery 复制所有内容并将其直接添加到标题中，而不是在单独的 js 文件中，它可以工作，只有当我像这样调用 jquery 时：

```
<script src="http://code.jquery.com/jquery-1.7.1.js" type="text/javascript"> 
```

它无法启动。

关于什么是错的任何想法？

添加了我的标题以提供帮助：

```
<script type='text/javascript' src='http://www.altesc.net/wp-includes/js/jquery/jquery.js?ver=1.8.3'></script>

<script type="text/javascript">
//<![CDATA[
$(window).load(function(){

$(document).scroll(function() {

var useFixedSidebar = $(document).scrollTop() > 330;
$('.adscrollleft').toggleClass('fixedSidebar', useFixedSidebar);

});

});//]]> 
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T04:21:43.183

删除这个：`$(window).load(function(){`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T04:21:50.023

正如我在问题下的评论中所说，您的 jQuery 包含文件*在最底部*有一个对 的调用`jQuery.noConflict();`，它释放了`$`对`jQuery()`.

因此，解决此问题的最直接方法是：

```
jQuery(window).load(function(){
    jQuery(document).scroll(function() {
        var useFixedSidebar = jQuery(document).scrollTop() > 330;
        jQuery('.adscrollleft').toggleClass('fixedSidebar', useFixedSidebar);
    });
}); 
```

现在你的代码可以工作了。这是可在我的计算机上运行的文件的 Pastebin（请注意，如果您的屏幕非常大，则不应将浏览器保持最大化）：

[http://pastebin.com/GCvaCF7c](http://pastebin.com/GCvaCF7c)

不过，有些人真的很喜欢`$`速记，所以你经常看到这个：

```
//                   >>> The $ below <<<
jQuery(window).load(function($){
    $(document).scroll(function() {
        var useFixedSidebar = $(document).scrollTop() > 330;
        $('.adscrollleft').toggleClass('fixedSidebar', useFixedSidebar);
    });
}); 
```

jQuery 允许您在范围内使用它。现在，只需习惯于`jQUery()`在全球范围内的任何时间使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T03:41:58.530

这里有几个问题：

*   首先，使用 jQuery 的本地副本。

    尽管在线副本会一直保持不变，但最好您拥有自己的副本。换个角度想一想：如果 jQuery 网站宕机了怎么办？你正在“窃取”的脚本也会失败，并使依赖于被窃取的 jQuery 的脚本失败。

*   首先加载库

    脚本是按顺序加载和解析的，一个接一个（除非使用了一些异步的东西，比如属性或依赖加载器）`defer`。`async`如果您的代码段依赖于 jQuery 并且在 jQuery*之前*加载，那么它将失败。首先加载库脚本，然后是依赖它的脚本。

    快速了解我的意思：

    ```
    <script src="jQuery.js"></script>
    <script src="yourScriptThatDependsOnJQuery.js"></script>
    <script>
        //scripts that depend on jQuery
    </script> 
    ```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-29T03:53:28.393

您可以尝试做一些事情来使其正常工作。

1.  确保您的脚本被拉入页面，一种检查方法是使用 Chrome 调试器中的“源”选项卡并在 html 头部分中搜索其他文件

2.  确保在包含 jQuery 之后包含了依赖脚本，因为它肯定依赖于它。

3.  检查是否正确包含 jQuery，并且只包含一次。

4.  注意 jQuery 冲突。还有一些其他库覆盖了 $，因此您的代码无法正常工作，因为 $ 不再是 jQuery 的别名。您可以使用它`jQuery.noConflict()`来避免与页面上使用相同变量 $ 的其他库发生冲突。

# codeigniter - 加水印后的codeigniter裁剪

> ID：14078476
> 
> 赞同：1
> 
> 时间：2012-12-29T03:35:20.050
> 
> 标签：codeigniter

我在这里遇到了一点麻烦，我想上传我的图像，并对图像进行裁剪和水印。这是我的控制器代码

```
//cropping image
$img['maintain_ratio'] = FALSE;
$img['create_thumb'] = TRUE;
$img['width'] = $thumb_size;
$img['height'] = $thumb_size;            
$this->image_lib->initialize($img);
$this->image_lib->crop();
$this->image_lib->clear();
$img['source_image'] = $source ;

//watermark image
$img['new_image']    = $destination_thumb ;
$img['wm_overlay_path'] = './images/resource/watermark.png';
$img['wm_type'] = 'overlay';
$img['wm_vrt_alignment'] = 'midle';
$img['wm_hor_alignment'] = 'center';
$this->image_lib->initialize($img);
$this->image_lib->watermark();            
$this->image_lib->clear() ; 
```

所有代码都很好，没有发现错误，代码只是创建水印而不裁剪，但是当我在裁剪代码上面反转水印代码时，结果只是裁剪图像。

那么我必须做些什么才能一次上传带有裁剪和水印的图像？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T15:01:30.663

你能试试这个：

```
$img['source_image'] = $source ;

$img['maintain_ratio'] = FALSE;
$img['create_thumb'] = TRUE;
$img['width'] = $thumb_size;
$img['height'] = $thumb_size;            
$this->image_lib->initialize($img);
$this->image_lib->crop();
$this->image_lib->clear();

//watermark image
$img['new_image']    = $destination_thumb ;
$img['wm_overlay_path'] = './images/resource/watermark.png';
$img['wm_type'] = 'overlay';
$img['wm_vrt_alignment'] = 'midle';
$img['wm_hor_alignment'] = 'center';
$this->image_lib->initialize($img);
$this->image_lib->watermark();            
$this->image_lib->clear() ; 
```

# python - 将变量与列表匹配并打印列表值

> ID：14078478
> 
> 赞同：0
> 
> 时间：2012-12-29T03:35:33.410
> 
> 标签：python

我在下面的代码上需要一些帮助，我有示例输入和预期输出，目前它没有打印任何东西..请提供您的输入，

基本上我的代码正在解析 num_ids.txt 中的值并检查每个值是否大于提供的 base_num 值以及该值是否不在“num_ignore”列表中，然后（在满足前两个条件后）它尝试匹配 numrefs列出并打印 numrefs 中的匹配值...

```
EXPECTEDOUTPUT:-
nums/39/205739/2

import os
import subprocess
def p4 (base_num):
    numrefs = ['nums/89/202089/4', 'nums/39/205739/2', 'nums/94/203455/6']
    num_ignore = [150362, 147117]
    '''
        num_ids.txt
        202089
        205739
        147117
        203455
    '''
    with open('./num_ids.txt', 'rb') as f:
        # Iterate over the file itself
        for line in f:
            num = int(line)
            if num > base_num and num not in num_ignore and line in numrefs:
                print numrefs
def main():
    base_num=203456
    p4(base_num)

    if __name__ == '__main__':
        main() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T04:03:39.897

您可以将`numrefs`列表转换为`numrefs_index`使用理解的字典。这样您就可以使用`in`运算符并更快地访问参考资料。

```
def p4(base_num):
    numrefs = ['nums/89/202089/4', 'nums/39/205739/2', 'nums/94/203455/6']
    num_ignore = [150362, 147117]
    numrefs_index = dict((int(x.split('/')[2]), x) for x in numrefs)
    for line in file("num_ids.txt"):
        num = int(line)
        if num > base_num and num not in num_ignore and num in numrefs_index:
            print numrefs_index[num]

if __name__ == "__main__":
    p4(203456)

# prints:
# nums/39/205739/2 
```

该`numrefs_index`行构建了这个字典：

```
{202089: 'nums/89/202089/4',
 203455: 'nums/94/203455/6',
 205739: 'nums/39/205739/2'} 
```

# node.js - Socketstream 未加载客户端库

> ID：14078479
> 
> 赞同：0
> 
> 时间：2012-12-29T03:35:36.933
> 
> 标签：node.js, socketstream

我刚刚开始使用socketstream。我试图创建一个 hello world 应用程序：

```
var http = require('http'),
ss = require('socketstream');

ss.client.define('main', {
    view: 'app.html',
    css: ['libs'],
    code: ['app','libs'],
    tmpl: '*'});

ss.http.route('/',function(req, res) {
        res.serveClient('main');
    });

var server = http.Server(ss.http.middleware);
server.listen(3000);

ss.start(server); 
```

它似乎加载正常，但我放在 client/code/libs 中的任何库似乎都没有被推送到浏览器。

例如，我将 underscore.js 放在 client/code/libs 中，并在 client/views 中有一个非常简单的 html 文件，我得到的只是：

```
<html>
<head></head>
<body>
    bwahahahahahaha
</body>
</html> 
```

为什么不加载/注入客户端库？

>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-13T22:53:17.923

这里的问题是确保您的 html 页面的 head 部分包含 <socketstream/> 标记。

# jquery - 无法在简单的 jquery 插件中调用函数

> ID：14078481
> 
> 赞同：2
> 
> 时间：2012-12-29T03:35:52.217
> 
> 标签：jquery, plugins

我试图在一个简单的 jquery 插件中调用一个函数。我看到 init 方法将宽度增加了 30 但 add50 方法抛出了错误`Uncaught TypeError: Object [object Object] has no method 'add50'`。不确定是什么导致此错误发生。

jsfiddle：http: [//jsfiddle.net/nsshrinivasan/KnDMq/6/](http://jsfiddle.net/nsshrinivasan/KnDMq/6/)

```
;(function ( $, window, document, undefined ) {

    // Create the defaults once
    var pluginName = 'Extender',
        defaults = {
            propertyName: "value"
        };

    // The actual plugin constructor
    function Plugin( element, options ) {
        this.element = element;
        this.options = $.extend( {}, defaults, options) ;
        this._defaults = defaults;
        this._name = pluginName;
        this.init(this.element);
    }

    Plugin.prototype = {
        init : function (element) {
           // console.log($(this.element).width());
           $(element).width($(element).width() + 30);
        },
        add50 : function(element){
           $(element).width($(element).width() + 50);
        }

     };

    $.fn[pluginName] = function ( options ) {
        return this.each(function () {
            if (!$.data(this, 'plugin_' + pluginName)) {
                $.data(this, 'plugin_' + pluginName,
                new Plugin( this, options ));
            }
        });
    }

})( jQuery, window, document );

$('#metal').Extender().add50(); 
```

HTML：

```
<div id='metal'></div> 
```

CSS：

```
#metal{
    width: 50px;
    height: 10px;
    background:red;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T05:12:51.090

尝试添加如下内容：

```
function Plugin( element, options ) {
    this.element = element;
    this.options = $.extend( {}, defaults, options) ;
    this._defaults = defaults;
    this._name = pluginName;
    if (this[options]){
        this[options](this.element);
    } else {
        this.init(this.element);
    }
} 
```

然后，您可以像这样：将您的所有插件`$('#metal').Extender('add50');`作为选项传入您的方法。 [jsFiddle 更新](http://jsfiddle.net/psyon001/KnDMq/7/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T05:25:44.713

我更新了你的小提琴：[小提琴](http://jsfiddle.net/KnDMq/8/)

```
;(function ( $, window, document, undefined ) {

    // Create the defaults once
    var pluginName = 'Extender',
        defaults = {
            propertyName: "value"
        };

    // The actual plugin constructor
    function Plugin( element, options ) {
        this.element = element;
        this.options = $.extend( {}, defaults, options) ;
        this._defaults = defaults;
        this._name = pluginName;
        this.init();
    }

    Plugin.prototype = {
        init : function () {
           // console.log($(this.element).width());
           $(this.element).width($(this.element).width() + 30);
        },
        add50 : function(){
           $(this.element).width($(this.element).width() + 50);
        }

     };

    $.fn[pluginName] = function ( options ) {
        return $.data(this, 'plugin_' + pluginName, new Plugin( this, options ));
    }

})( jQuery, window, document );

$('#metal').Extender().add50(); 
```

# jquery - 选择列表上的 jQuery 验证问题

> ID：14078482
> 
> 赞同：2
> 
> 时间：2012-12-29T03:35:56.873
> 
> 标签：jquery, jquery-validate

我已经看到了大量关于如何在选择列表上使用 jQuery Validation 的示例——我正在尝试实现一个，但它对我不起作用。一般来说，我对插件真的很陌生，我对自己做错了什么感到完全困惑。

预期的行为是它不应该验证用户是否将选择菜单保留为“默认”。他们必须做出选择。

我首先连接新的验证器方法。

# Javascript

```
(function($) {
    $.validator.addMethod('mustbe', function(value, element, params) {
        var testValue = params['propertyvalue'];
        var condition = params['condition'];
        if ((condition == '0') && (value != testValue)) return true;
        if ((condition == '1') && (value == testValue)) return true;
        return false;
    });
})(jQuery);

$(document).ready(function() {
    $("#form1").validate();

    $('#form1').submit(function() {
        alert($('#form1').valid());
    });
});​ 
```

然后我将元数据添加到实际的 HTML 中。

# HTML

```
<form id="form1" action="">
<select id="select_list" data-val="true"
        data-val-mustbe="You must select a value"
        data-val-mustbe-condition="0"
        data-val-mustbe-propertyvalue="default"
        data-val-required="You must select a value" >
        <option value="default">Choose...</option>
        <option value="1">1</option>
        <option value="2">2</option>
</select>
<input type="submit" id="submit" value="Submit" />
</form>​ 
```

它只是拒绝验证。这里也是一个小提琴的链接：

# [jsFiddle](http://jsfiddle.net/ciel/bvzrT/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T12:44:26.750

你应该告诉你正在使用 ASP.NET MVC。这无济于事，但人们会停止询问自定义属性名称。

我重新设计了您的代码以使用 value default 和您的 data-val 属性。这是一个代码示例：

```
$(document).ready(function() {    
    $.validator.addMethod("valueNotEquals", function(value, element, arg){
        return arg != value;
    }, "");

    $("#form1").validate({
        rules: {
            select_list : {valueNotEquals: $('#select_list').attr('data-val-mustbe-propertyvalue')},  
        },
        messages: {  
            select_list : { valueNotEquals: $('#select_list').attr('data-val-required') }
        },        
        submitHandler: function(form) {
            alert($('#form1').valid());
            form.submit();
        }
    });
}); 
```

**编辑 ：**

这是一个 jsFiddle 示例：http: [//jsfiddle.net/Gajotres/ekPpS/](http://jsfiddle.net/Gajotres/ekPpS/)

这是一个没有 ASP.NET MVC 属性的版本：

```
<form id="form1" action="">
    <select id="select_list" name="select_list">
            <option value="default">Choose...</option>
            <option value="1">1</option>
            <option value="2">2</option>
    </select>
    <input type="submit" id="submit" value="Submit" />
</form>

$(document).ready(function() {    
    $.validator.addMethod("valueNotEquals", function(value, element, arg){
        return arg != value;
    }, "");

    $("#form1").validate({
        rules: {
            select_list : {valueNotEquals: "default"},  
        },
        messages: {  
            select_list : { valueNotEquals: "You must select a value" }
        },        
        submitHandler: function(form) {
            alert($('#form1').valid());
            form.submit();
        }
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T04:18:33.783

简单的方法是`value=''`在默认选项中使用，并指定`select`是必需的：

```
<select id="select_list" class="required"> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T04:47:52.373

因此，Barmar 的回答部分正确，但没有得到很好的解释。

我为让[这个更新的小提琴](http://jsfiddle.net/bvzrT/25/)工作所做的更改：

将**name="select_list"**添加到 select 元素本身以提供 jquery.validate 它想要查找的内容

修改了 javascript 验证调用：

```
$("#form1").validate({
  rules: {
    select_list: {
      required: true,
      number: true
    }
  },
 submitHandler: function(form) {
   alert($('#form1').valid());
   form.submit();
 }
}); 
```

# asp.net-mvc - Web API IE9 JSON 数据“你想打开还是保存这个文件”

> ID：14078484
> 
> 赞同：5
> 
> 时间：2012-12-29T03:36:02.500
> 
> 标签：asp.net-mvc, asp.net-mvc-4

首先，请理解我并不是要在 IE9 中查看 JSON。我一直在使用 Fiddler。我有一个名为 Fine Uploader 的第三方上传器，它在成功上传 Ajax 文件时需要 JSON 响应消息。

现在我知道 IE9 没有 MIME 来显示 JSON，但我不想显示 JSON。我只是在 ajax 上传一些文件并且 IE9 尝试打开我的 ajax 响应后返回一个 JSON 响应。

由于我打算将我的所有 Web API 响应格式化为 JSON，我是否必须为每个 api 调用添加自定义文本/html 响应内容类型以使我的应用程序与 IE9 兼容？非常荒谬的东西，我无法克服浪费在处理 IE 兼容性问题上的时间。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-09T19:45:05.030

尽管 Ray 的回答有效，但这会改变所有 Json 响应的响应内容类型。理想情况下，我们不应该影响运行良好的浏览器的响应类型。

有关解决此问题的简单方法（尤其是在 MVC 中），请参阅[我对这个问题的回答](https://stackoverflow.com/questions/6114360/stupid-ie-prompts-to-open-or-save-json-result-which-comes-from-server#15910942)。

简而言之，以下代码可以解决问题，如果适用，可以将其包装到基本控制器/辅助方法中：

```
if (!Request.AcceptTypes.Contains("application/json"))
    return base.Json(data, "text/plain");
else
    return base.Json(data); 
```

我希望这对其他人有帮助！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-12-05T19:21:07.090

在 WebAPI 中，您可以在 Global.asax 中触发的配置中设置全局响应。这样，您的所有浏览器都将您的 WebAPI 响应视为真正的 JSON。

```
public static class WebApiConfig
{
    public static void Register(HttpConfiguration config)
    {
        // stuff...

        config.Formatters.Add(new JsonMediaTypeFormatter());
        config.Formatters.JsonFormatter.SupportedMediaTypes
            .Add(new MediaTypeHeaderValue("application/json"));

        // Most important... +++++++++++++
        config.Formatters.JsonFormatter.SupportedMediaTypes
            .Add(new MediaTypeHeaderValue("text/html"));
        // -------------------------------

        config.EnsureInitialized();
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-04T01:58:23.093

问题是您响应的内容类型：它必须是“text/plain”，而不是“application/json”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-29T10:58:44.347

您希望人们使用 IE9 使用您的 API 吗？通常，使用浏览器的人无论如何都无法读取 JSON。我建议你使用 Fiddler2 之类的东西来测试你的 API。

IE9 提示您下载文件的原因是因为它没有 MIME 处理程序来显示它。浏览器设计为仅显示某些 mime 类型，如 text/html、text/xml、image/png、image/jpeg 等。您通常需要一个特殊的插件来显示自定义类型，如 application/pdf。JSON，其 application/json mime 类型也不例外。

如果它真的让你很烦恼，请阅读[这个](http://banachowski.com/deprogramming/2011/04/viewing-json-in-ie9/)和[这个](http://www.west-wind.com/weblog/posts/2011/Apr/01/Displaying-JSON-in-your-Browser)。

# javascript - 在没有 exclude_matches/globs 的情况下排除 Chrome 扩展中的域或提高 Javascript CSS 性能？

> ID：14078487
> 
> 赞同：3
> 
> 时间：2012-12-29T03:36:17.023
> 
> 标签：javascript, css, google-chrome, google-chrome-extension

我一直在尝试构建一个 Chrome 扩展程序，但不幸的是，当它最终让它工作时，我意识到我必须让它只在某些 URL 上处于活动状态，这很好，因为 Chrome 两者`exclude_matches`兼而有之`exclude_globs`。然而，当将这两个选项与 CSS 结合使用时，Chrome 中存在一个错误——它不起作用。

我想知道是否有人知道我可以仅在某些域上注入我的 CSS 的任何其他方式（我想从几个域中排除而不是允许很多域）？我知道我可以使用 Javascript 将其写入现有 CSS 的末尾，但不幸的是，这让我在 CSS 显示的内容上出现了第二次延迟（这也很明显）。

如果有人能提出一些替代方案，我将不胜感激。也许有一些方法可以通过 Javascript 使用 CSS 文件，这不会影响性能（请注意，在 Javascript 中不需要域排除，因为它`exclude_matches`适用于 JS 文件）。任何和所有的想法都是有帮助的，可惜谷歌没有修复一个已经存在一年多的错误！

**编辑：**因为我认为我会得到一两个关于程序注入的回复，所以我不清楚这是如何工作的，因此作为一个例子，我们将使用这些链接（后者是我不想实现的链接） CSS on）以防有人想发布示例。

```
http://example.com/
http://example.com/random/
http://example.com/random/example/ 
```

哦，我知道谷歌的例子是使用一个按钮来启动 CSS，但我宁愿让它在页面加载时启动。再次感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T04:35:29.563

在解决[**此错误**](https://code.google.com/p/chromium/issues/detail?id=100106)之前，要么列出清单中[所有](https://developer.chrome.com/extensions/content_scripts.html#registration)[匹配的 URL](https://developer.chrome.com/extensions/match_patterns.html)，要么使用[insertCSS](https://developer.chrome.com/extensions/tabs.html#method-insertCSS) API 作为解决方法。

### 代码示例 #1

每当单击浏览器操作图标时，此示例都会将 css 注入当前选项卡，确保`default_popup`清单中没有 a ，否则不会触发[**onClicked 事件。**](https://developer.chrome.com/extensions/browserAction.html#event-onClicked)

```
//This even fires when ever a browser action is clicked
chrome.browserAction.onClicked.addListener(function (tab) {
    // This injects content.css into the current tab
    chrome.tabs.insertCSS(null, {
        file: {
            file: "content.css"
        },
        "all_frames": true //for all frames
    });
}); 
```

### 代码示例 #2

利用任何[选项卡 API](https://developer.chrome.com/extensions/tabs.html)过滤一组匹配的页面以注入 CSS

*   [tabs.onCreated.addListener](https://developer.chrome.com/extensions/tabs.html#event-onCreated)（用于在 a 时注入 CSS `tab is created`）
*   [tabs.onUpdated.addListener](https://developer.chrome.com/extensions/tabs.html#event-onUpdated)（用于在 a 时注入 CSS `tab is completely loaded`）
*   [tabs.query](https://developer.chrome.com/extensions/tabs.html#method-query)（用于将 CSS 注入`existing tabs`）

选择任何 API 并注入 CSS

```
//Use an API to filter pages for a matching List
chrome.tabs.(SOME API HERE).addListener(function (RELATED DEFINITION) {
    //Inject CSS for a tab
    chrome.tabs.insertCSS(tabId, {
        file: {
            file: "content.css"
        }, //Any file to inject
        "all_frames": true //Inject to all Frames
    });
}); 
```

有关更多信息，请参阅[此](https://stackoverflow.com/questions/13792552/exclude-globs-not-working-in-chrome-extension/)。

## 参考

*   [选项卡 API](https://developer.chrome.com/extensions/tabs.html)
*   [清单文件](https://developer.chrome.com/extensions/manifest.html)
*   [内容脚本](https://developer.chrome.com/extensions/content_scripts.html)

# java - Java - 读取国际字符

> ID：14078490
> 
> 赞同：0
> 
> 时间：2012-12-29T03:36:47.837
> 
> 标签：java, internationalization

如果我保存一个像日语这样的国际字符，它需要超过 1 个字节来表示，在 UTF-8 中我会在读回数据时丢失数据吗？

我的意思是，如果我使用 UTF-8，我会使用 2 个字节来保存一个字符。当我读取字节时，我可能会在读取第二个字节之前读取第一个字节，在这种情况下它会显示一个完全不同的字符或乱码？

有没有办法保存这些国际字符并在不使用任何编码和解码的情况下读取它们？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T03:42:54.147

UTF-8 正是您所需要的。阅读[http://en.wikipedia.org/wiki/UTF-8](http://en.wikipedia.org/wiki/UTF-8)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T03:46:26.000

> 如果我保存一个像日语这样的国际字符，它需要超过 1 个字节来表示，在 UTF-8 中我会在读回数据时丢失数据吗？

不会。如果您正确写入/读取文件，您将不会丢失数据。

正确写入/读取文本的简单方法是使用`Writer`和`Reader`API，或者在构造写入器/读取器实例时显式指定编码（例如使用 InputStreamReader / OutputStreamWriter），或者使用 FileReader / FileWriter 并依赖默认平台编码。Java 实现根据显式或隐式选择的编码方案为您处理 char <--> 字节编码和解码。

> 我的意思是，如果我使用 UTF-8，我会使用 2 个字节来保存一个字符。

实际上，一个、两个或三个字节取决于 Java`char`值。

> 当我读取字节时，我可能会在读取第二个字节之前读取第一个字节，在这种情况下它会显示一个完全不同的字符或乱码？

如果您没有正确解码 UTF-8（即根据规范），您可能会得到各种垃圾。但是无论如何，您都不应该尝试手动对其进行解码。使用 Reader 和 Writer API，Java 将为您处理所有这些事情。

> 有没有办法保存这些国际字符并在不使用任何编码和解码的情况下读取它们？

这没有意义。每当您将 Java 中的字符写入文件时，您都在*隐式*编码它们……即使编码是身份转换（例如 UTF-16）

# python - gevent 阻止 redis 的套接字请求

> ID：14078493
> 
> 赞同：5
> 
> 时间：2012-12-29T03:37:59.667
> 
> 标签：python, redis, gevent

目标：产生一些greenlet worker处理从redis弹出的数据（从redis弹出然后放入队列）

运行环境：ubuntu 12.04 Python 版本：2.7 GEVENT 版本：1.0 RC2 REDIS 版本：2.6.5 REDIS-PY 版本：2.7.1

```
from gevent import monkey; monkey.patch_all()
import gevent
from gevent.pool import Group
from gevent.queue import JoinableQueue
import redis

tasks = JoinableQueue()
task_group = Group()

def crawler():
    while True:
        if not tasks.empty():
            print tasks.get()
            gevent.sleep()

task_group.spawn(crawler)
redis_client = redis.Redis()
data = redis_client.lpop('test') #<----------Block here
tasks.put(data) 
```

尝试从 redis 中弹出数据，但它被阻塞了......并且没有引发异常......只需冻结并删除 spawn 方法，它会起作用..我对发生的事情感到困惑，请帮助！谢谢你！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-29T10:37:26.677

gevent 提供**协作**的轻量级进程（不是线程）。结果是当你在某处有一个无限循环并且调度程序永远不会重新进入时，程序将阻止占用 100% 的 CPU 内核。

在您的示例中，问题在于您定义爬虫循环的方式。显然，当任务为空时，您有一个无限循环。并且因为 gevent.sleep 调用（将执行必要的 yield 操作）仅在任务不为空时调用，这意味着调度程序永远不会重新进入。

它似乎阻止了 lpop 命令，因为连接被 Redis 客户端延迟。事件顺序如下：

*   任务组产生；但还没有安排greenlet
*   redis_client 已构建，但由于实际连接延迟，它尚未生成 I/O
*   lpop 被调用；这次真的需要连接，因为 Redis 客户端必须等待连接和对 lpop 的回复；因此它让给调度程序
*   调度程序激活爬虫工作者
*   无限循环，因为任务队列仍然是空的

如果将 gevent.sleep() 放在循环本身中（在 if 之后），它会更好地工作，但它仍然是实现 dequeuer 的低效方式。这样的事情会好得多：

```
def crawler():
    while True:
        x = tasks.get()
        try:
            print "Crawler: ",x
        finally:
            tasks.task_done() 
```

get() 调用阻塞了worker，因此它会在队列为空时避免worker 和调度程序之间的乒乓游戏。

# javascript - 适用于许多浏览器的简单标签导航？

> ID：14078494
> 
> 赞同：0
> 
> 时间：2012-12-29T03:38:07.167
> 
> 标签：javascript, jquery, html, css, tabs

我正在寻找一种在我的网页上设置标签的方法。

不幸的是，他们中的许多人要么使用 Javascript、JQuery 或高级 CSS，这些 CSS 在旧浏览器上可能不存在（或在较新的浏览器上启用）

单击一段文本并显示一些文本，或者单击另一段文本并显示不同的文本数据是一件简单的事情。

这样的事情可能吗，还是我必须使用高级 HTML5/CSS 或 Javascript/JQuery 来完成这样的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T03:40:30.537

你检查过 Twitter Bootstrap 吗？他们有一个简单易用的标签：http: [//twitter.github.com/bootstrap/javascript.html#tabs](http://twitter.github.com/bootstrap/javascript.html#tabs)

它涉及一些 Javascript，但我认为使用它非常简单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T22:34:16.543

使用了一些 JQuery，因为他们说没关系。

# php - 如何在图像上传中显示错误消息

> ID：14078496
> 
> 赞同：1
> 
> 时间：2012-12-29T03:38:34.333
> 
> 标签：php, html

如何向用户显示“文件大小大于指定”和“请仅上传图片”消息？我尝试使用以下代码

`if ($_FILES["file"]["size"] > 2097152) { // if file is larger than we want to allow echo "ERROR: Your file was larger than 2MB in file size.";`

但这没有用。

```
<form action="" method="post"
enctype="multipart/form-data">
<label for="file">Filename:</label>
<input type="file" name="file" ><br>
<input type="submit" name="submit" value="Submit">
</form>

</body>
</html> 
```

下面是我的 php 代码。它通过`else { echo "Invalid file"; }`在最后添加来工作，但我想向用户显示个别错误...txs

```
<?php
$allowedExts = array("jpg", "jpeg", "gif", "png");
$extension = end(explode(".", $_FILES["file"]["name"]));
if ((($_FILES["file"]["type"] == "image/gif")
|| ($_FILES["file"]["type"] == "image/jpeg")
|| ($_FILES["file"]["type"] == "image/png")
|| ($_FILES["file"]["type"] == "image/pjpeg"))
&& ($_FILES["file"]["size"] < 2097152)
&& in_array($extension, $allowedExts))
{

if ($_FILES["file"]["error"] > 0)
{
echo "Return Code: " . $_FILES["file"]["error"] . "<br>";
}
else
{
echo "Upload: " . $_FILES["file"]["name"] . "<br>";
echo "Type: " . $_FILES["file"]["type"] . "<br>";
echo "Size: " . ($_FILES["file"]["size"] / 1024) . " kB<br>";
echo "Temp file: " . $_FILES["file"]["tmp_name"] . "<br>";

if ($_FILES["file"]["size"] > 2097152) { // if file is larger than we want to allow
echo "ERROR: Your file was larger than 2MB in file size.";
}
if (file_exists("upload/" . $_FILES["file"]["name"]))
{
echo $_FILES["file"]["name"] . " already exists. ";
}
else
{
move_uploaded_file($_FILES["file"]["tmp_name"],
"upload/" . $_FILES["file"]["name"]);
echo "your photo has been uploaded successfully!";
}
}
}
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T04:20:06.710

```
&& ($_FILES["file"]["size"] < 2097152)
&& in_array($extension, $allowedExts)) 
```

在那里您正在检查文件大小是否**小于**允许的最大值。因此，如果更多 if() 语句将返回 FALSE 并且其余代码将不会运行。在 if() 块内部就是这种情况，然后您可以执行以下操作：

```
if ($_FILES["file"]["size"] > 2097152) 
```

您检查它是否**更多**，但是您*已经*使用第一个 if() 验证了大小，因此文件太大不会触发错误，因为它已经使第一个 if()*失败*

因此，要修复它，您将删除此行，以便您可以单独输出错误：

```
 && ($_FILES["file"]["size"] < 2097152) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T06:50:22.570

我不确定你是否想为文件上传进行客户端验证，但如果你想这样做，有一个不错的 jQuery 插件。

[http://adamsanderson.github.com/jQuery-File-Validator/](http://adamsanderson.github.com/jQuery-File-Validator/)

这会很有帮助。您可以自定义代码以验证文件的大小和类型中的一个或两个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T05:33:28.403

我认为优先级应该像

1.  检查文件是否有错误
2.  检查文件是否为图像
3.  检查文件大小是否小于 2MB
4.  检查文件是否已存在

所以我更喜欢跟随

```
<?php
if ($_FILES["file"]["error"] > 0) {//Checking file has error or not
    echo "Return Code: " . $_FILES["file"]["error"] . "<br>";
} else {
    echo "Upload: " . $_FILES["file"]["name"] . "<br>";
    echo "Type: " . $_FILES["file"]["type"] . "<br>";
    echo "Size: " . ($_FILES["file"]["size"] / 1024) . " kB<br>";
    echo "Temp file: " . $_FILES["file"]["tmp_name"] . "<br>";

    if (($_FILES["file"]["type"] == "image/gif") || ($_FILES["file"]["type"] == "image/jpeg") || ($_FILES["file"]["type"] == "image/png") || ($_FILES["file"]["type"] == "image/pjpeg")) { //Checking file is an image or not

        if ($_FILES["file"]["size"] < 2097152) { //checking file size is less than 2MB or not
            if (file_exists("upload/" . $_FILES["file"]["name"])) { //Checking file already exists or not

                echo $_FILES["file"]["name"] . " already exists. ";
            } else {
                move_uploaded_file($_FILES["file"]["tmp_name"], "upload/" . $_FILES["file"]["name"]);
                echo "Your photo has been uploaded successfully!";
            }
        } else {
            echo "ERROR: Your file was larger than 2MB in file size.";
        }
    } else {
        echo "Please upload only Image.";
    }
}
?> 
```

# .net - 谁能告诉我是什么导致这个堆栈溢出？

> ID：14078503
> 
> 赞同：1
> 
> 时间：2012-12-29T03:40:44.313
> 
> 标签：.net, regex, vb.net, winforms

我正在尝试查找单词并使用正则表达式替换它们。我不断收到堆栈溢出异常，我猜是由于递归循环。所以我尝试从第一个代码块中删除 for 循环，并提出第二个代码块，但仍然是同样的问题。

我试图在忽略大小写的情况下查找某些字符串，并自动将它们替换为相同字符串的正确大小写。所以一个例子是有人输入“vB”它会自动用“vb”替换它。我知道我的问题是由于参加 textchanged 事件，所以如果有人能引导我朝着正确的方向前进，我将非常感激。

```
Private Sub tb_textchanged(ByVal sender As System.Object, ByVal e As    TextChangedEventArgs)

    Dim pattern As String = "\<vb\>"
    Dim input As String = txt.Text
    For Each m As Match In Regex.Matches(input, pattern, RegexOptions.IgnoreCase)
        Dim caretpos As FastColoredTextBoxNS.Place = New Place(txt.Selection.Start.iChar, txt.Selection.Start.iLine)
        Dim replacement As String = "<vb>"
        Dim rgx As New Regex(pattern)
        Dim result As String = rgx.Replace(input, replacement, RegexOptions.IgnoreCase)
        txt.Text = result
        txt.Selection.Start = New Place(caretpos.iChar, caretpos.iLine)
    Next

End Sub 
```

替换 For 循环后。

```
Private Sub tb_textchanged(ByVal sender As System.Object, ByVal e As TextChangedEventArgs)

    Dim pattern As String = "\<vb\>"
    Dim input As String = txt.Text
    Dim matches As MatchCollection = Regex.Matches(input, pattern, RegexOptions.IgnoreCase)
    If matches.Count > 0 Then
        Dim caretpos As FastColoredTextBoxNS.Place = New Place(txt.Selection.Start.iChar, txt.Selection.Start.iLine)
        Dim replacement As String = "<vb>"
        Dim rgx As New Regex(pattern)
        Dim result As String = rgx.Replace(input, replacement, RegexOptions.IgnoreCase)
        txt.Text = result
        txt.Selection.Start = New Place(caretpos.iChar, caretpos.iLine)
    End If

End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T03:44:46.410

您的问题是，当有人更改文本时，它会进行替换。替换会更改文本。然后再次调用您的事件处理程序。等等等等。你会得到无限递归，直到你用完堆栈空间，导致堆栈溢出。

为了解决这个问题，在方法调用之间保留一个布尔值。如果为真，请尽早退出事件处理程序。否则，将其设置为 true，当您离开事件处理程序时，将其设置为 false。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T03:55:56.213

```
Private isRecursive As Boolean
Private Sub tb_textchanged(ByVal sender As System.Object, ByVal e As TextChangedEventArgs)

    If (isRecursive) Then
        Return
    End If
    isRecursive = True

    Dim pattern As String = "\<vb\>"
    Dim input As String = txt.Text
    Dim matches As MatchCollection = Regex.Matches(input, pattern, RegexOptions.IgnoreCase)
    If matches.Count > 0 Then
        Dim caretpos As FastColoredTextBoxNS.Place = New Place(txt.Selection.Start.iChar, txt.Selection.Start.iLine)
        Dim replacement As String = "<vb>"
        Dim rgx As New Regex(pattern)
        Dim result As String = rgx.Replace(input, replacement, RegexOptions.IgnoreCase)
        txt.Text = result
        txt.Selection.Start = New Place(caretpos.iChar, caretpos.iLine)
    End If

    isRecursive = False
End Sub 
```

# r - 删除重复的 2 列排列

> ID：14078507
> 
> 赞同：5
> 
> 时间：2012-12-29T03:42:26.613
> 
> 标签：r, duplicates, dataframe

我找不到这个问题的好标题，所以请随时编辑它。

我有这个data.frame

```
 section time to from
1       a    9  1    2
2       a    9  2    1
3       a   12  2    3
4       a   12  2    4
5       a   12  3    2
6       a   12  3    4
7       a   12  4    2
8       a   12  4    3 
```

我想删除具有相同`to`且`from`同时的重复行，而不计算 2 列的排列：例如 (1,2) 和 (2,1) 是重复的。

所以最终输出将是：

```
 section time to from
1       a    9  1    2
3       a   12  2    3
4       a   12  2    4
6       a   12  3    4 
```

我有一个解决方案，通过构建一个新的列键，例如

```
 key <- paste(min(to,from),max(to,from)) 
```

并使用 删除重复的密钥`duplicated`，但我认为这是肮脏的解决方案。

这是我的数据的输入

```
structure(list(section = structure(c(1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L), .Label = "a", class = "factor"), time = c(9L, 9L, 12L, 
12L, 12L, 12L, 12L, 12L), to = c(1L, 2L, 2L, 2L, 3L, 3L, 4L, 
4L), from = c(2L, 1L, 3L, 4L, 2L, 4L, 2L, 3L)), .Names = c("section", 
"time", "to", "from"), row.names = c(NA, -8L), class = "data.frame") 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T04:04:06.010

```
mn <- pmin(s$to, s$from)
mx <- pmax(s$to, s$from)
int <- as.numeric(interaction(mn, mx))
s[match(unique(int), int),]
  section time to from
1       a    9  1    2
3       a   12  2    3
4       a   12  2    4
6       a   12  3    4 
```

这个想法归功于这个问题： 从数据框中[删除连续重复](https://stackoverflow.com/questions/14056153/remove-consecutive-duplicates-from-dataframe)，特别是@MatthewPlourde的回答。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-29T04:12:25.853

您可以尝试`sort`在`apply`函数内使用来对组合进行排序。

```
mydf[!duplicated(t(apply(mydf[3:4], 1, sort))), ]
#   section time to from
# 1       a    9  1    2
# 3       a   12  2    3
# 4       a   12  2    4
# 6       a   12  3    4 
```

# java - 在java中实现映射器的最佳方法是什么？

> ID：14078509
> 
> 赞同：2
> 
> 时间：2012-12-29T03:43:10.573
> 
> 标签：java, design-patterns

我有三个请求对象，分别称为 Request1To、Request2To、Request3To。我希望有一个方法可以接受这些 TO 中的任何一个并返回一个响应对象。我目前已经这样实施

```
class Mapper{
     public ResponseTo mapRequest1(Request1To){

      }

     public ResponseTo mapRequest2(Request2To){

      }

    public ResponseTo mapRequest3(Request3To){

      }

} 
```

有没有更好的方法来做到这一点，而不是为每个请求对象创建一个单独的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T03:57:13.353

看看[Dozer](http://dozer.sourceforge.net/)和[modelmapper](http://modelmapper.org/)。它们都是将一个对象映射到另一个对象的出色工具。我知道 Dozer 与 Spring 集成。在 Dozer 中，您的代码将如下所示：

```
Mapper mapper = new DozerBeanMapper();
ResponseTo response = mapper.map(request, ResponseTo.class); 
```

它非常强大且非常易于使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T03:49:10.807

不知道更多这些对象是什么样的......只需制作一个它们都实现的 Request 接口。然后 mapRequest 方法将采用接口而不是具体类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T03:51:02.500

```
public interface CustomRequest {

 public ResponseTo convertResponseTo();

}

public class Request1To implements CustomRequest{

    public ResponseTo convertResponseTo(){

     // do the logic and return response

    }

 }

  public class Mapper {

   public ResponseTo mapRequest(CustomRequest request){

      return request.convertResponseTo();

  }
} 
```

# mysql - 创建表时mysql错误

> ID：14078510
> 
> 赞同：0
> 
> 时间：2012-12-29T03:43:19.000
> 
> 标签：mysql, sql, create-table

我是 mysql 新手，请帮助我执行此表。

```
CREATE TABLE `jjsaar`.`dd_chq` (
  `reg_id` INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
  `receipt_no` INTEGER UNSIGNED NOT NULL,
  `name` VARCHAR NOT NULL,
  `add` VARCHAR NOT NULL,
  `phone_no` VARCHAR NOT NULL,
  `purpose` VARCHAR NOT NULL,
  `pay_method` VARCHAR NOT NULL,
  `amount` INTEGER UNSIGNED NOT NULL,
  `dd_chq_no` VARCHAR NOT NULL,
  `bank_details` VARCHAR NOT NULL,
  `timestamp` TIMESTAMP NOT NULL,
  PRIMARY KEY (`reg_id`)
)
ENGINE = InnoDB; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T03:44:48.870

我猜你有这个错误信息

> 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 4 行的 'NOT NULL, `add`VARCHAR NOT NULL, `phone_no`VARCHAR(25) NOT NULL, ' 附近使用正确的语法：

您应该指定`VARCHAR`值的长度，例如

```
`name` VARCHAR(25) NOT NULL, 
```

你的工作`CREATE TABLE`声明

```
CREATE TABLE `jjsaar`.`dd_chq` 
(
  `reg_id` INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
  `receipt_no` INTEGER UNSIGNED NOT NULL,
  `name` VARCHAR(25) NOT NULL,
  `add` VARCHAR(25) NOT NULL,
  `phone_no` VARCHAR(25) NOT NULL,
  `purpose` VARCHAR(25) NOT NULL,
  `pay_method` VARCHAR(25) NOT NULL,
  `amount` INTEGER UNSIGNED NOT NULL,
  `dd_chq_no` VARCHAR(25) NOT NULL,
  `bank_details` VARCHAR(25) NOT NULL,
  `timestamp` TIMESTAMP NOT NULL,
  PRIMARY KEY (`reg_id`)
)
ENGINE = InnoDB; 
```

*   [SQLFiddle 演示链接](http://sqlfiddle.com/#!2/9ac0f)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T03:47:39.397

您必须指定`varchar`长度。例如：

```
CREATE TABLE `jjsaar`.`dd_chq` (
  `reg_id` INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
  `receipt_no` INTEGER UNSIGNED NOT NULL,
  `name` VARCHAR(50) NOT NULL,
  `add` VARCHAR(50) NOT NULL,
  `phone_no` VARCHAR(50) NOT NULL,
  `purpose` VARCHAR(50) NOT NULL,
  `pay_method` VARCHAR(50) NOT NULL,
  `amount` INTEGER UNSIGNED NOT NULL,
  `dd_chq_no` VARCHAR(50) NOT NULL,
  `bank_details` VARCHAR(50) NOT NULL,
  `timestamp` TIMESTAMP NOT NULL,
  PRIMARY KEY (`reg_id`)
)
ENGINE = InnoDB; 
```

# java - "Unparseable date" using SimpleDateFormatter with API code example

> ID：14078523
> 
> 赞同：1
> 
> 时间：2012-12-29T03:48:02.207
> 
> 标签：java, android, parsing, date, simpledateformat

I am trying to parse dates, for example `"Sat, 29 Dec 2012 04:07:09 +0100"` I am using SimpleDateFormatter with format set as

```
new SimpleDateFormat("EEE, d MMM yyyy HH:mm:ss Z", Locale.getDefault()); 
```

Unfortunately I am getting

```
12-29 04:44:29.890: E/MainActivity(3995): Unparseable date: "Sat, 29 Dec 2012 04:07:09 +0100" (at offset 0)
12-29 04:44:29.890: E/MainActivity(3995): java.text.ParseException: Unparseable date: "Sat, 29 Dec 2012 04:07:09 +0100" (at offset 0) 
```

Which I absolutely dont get as that parameter regular expression is copy and pasted directly from documentation [http://docs.oracle.com/javase/6/docs/api/java/text/SimpleDateFormat.html](http://docs.oracle.com/javase/6/docs/api/java/text/SimpleDateFormat.html) under Examples

Thanks!

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-29T03:54:44.913

Whatever the locale returned by `Locale.getDefault()` is doesn't support dates formatted that way.

Changing it to `Locale.US` for example, will work.

# json - 在 Go 中将组合对象转换为 json

> ID：14078527
> 
> 赞同：2
> 
> 时间：2012-12-29T03:49:04.533
> 
> 标签：json, types, go, subclass

我是 Go 新手，不确定如何解决这个问题。在 OOP 术语中，我有一个 Animal 基类和两个 Cat 和 Dog 子类。我想为 Animal 指定一个适用于所有动物的 ToJson 方法。

我的问题是，当我调用 dog.ToJson() 时，我只得到 dog 的 Dog 属性，而没有得到 Animal 的属性。

如何使 ToJson 按预期工作（即[使用递归](http://golang.org/pkg/encoding/json/#Marshal "递归")）？

编辑：更改代码以反映 lbonn 回答的建议，我无法按照我的意愿工作。edit2：代码更改后的一致性问题

```
package main

import (
    "encoding/json"
    "fmt"
)

type Animal struct {
    Name string
}

type Cat struct {
    CatProperty int64
    Animal
}

type Dog struct {
    DogProperty int64
    Animal
}

func ToJson(i interface{}) []byte {
        data,err := json.Marshal(i)
    if err != nil {
        panic("???")
    }
    return data
}

func main() {
    dog := Dog{}
    dog.Name = "rex"
    dog.DogProperty = 2
    fmt.Println(string(ToJson(dog)))
    // Prints {"DogProperty":2}
    // I want it to print {"Name":"rex","DogProperty":2}
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T05:45:59.403

匿名字段的 Json 编码已从 go 1 中删除。希望它将回到 go 1.1 中。有关更多详细信息，请参阅 [https://groups.google.com/forum/?fromgroups=#!topic/golang-nuts/jYMHbEv44r4](https://groups.google.com/forum/?fromgroups=#!topic/golang-nuts/jYMHbEv44r4)。

因此，您现在可以使用标准库（使用 go 1）获得的最佳效果是[http://play.golang.org/p/LncNFeN8ys](http://play.golang.org/p/LncNFeN8ys)

在 go 1.1 发布之前，您始终可以使用 skelterjohn 的补丁[https://github.com/skelterjohn/json/来支持匿名字段。](https://github.com/skelterjohn/json/)

或使用提示，从已修复此问题的源安装。见[https://codereview.appspot.com/6460044](https://codereview.appspot.com/6460044)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T04:10:18.387

此处，该`ToJson`方法适用于 的匿名字段`Animal`。`Dog`该调用`d.ToJson`只是`d.Animal.ToJson`. [GoLang 教程：结构中的匿名字段](http://golangtutorials.blogspot.jp/2011/06/anonymous-fields-in-structs-like-object.html)

在这里，我将编写一个函数而不是一个方法（一个简单的包装器`Marshal`）：

```
func ToJson(i interface{}) []byte {
    data,err := json.Marshal(i)
    if err != nil {
        panic("???")
    }
    return data
} 
```

这不是特定于动物或狗，但实际上并不需要。

更一般地说，go 中没有真正的继承概念。该语言中使用的对象范式与主流 OOP 完全不同，例如 Java 或 C++。[Go FAQ](http://golang.org/doc/go_faq.html#types)提供了一些很好的说明。

# c++ - 删除多个列表指向的数据？

> ID：14078530
> 
> 赞同：4
> 
> 时间：2012-12-29T03:50:11.523
> 
> 标签：c++, pointers, memory-management, stdlist

我有一个可能会出现在多个列表中的对象。

例如

```
std::list<object*> lista = new std::list<object*>();
std::list<object*> listb = new std::list<object*>();

object* obj = new object();
lista->push_front(obj);
listb->push_front(obj); 
```

潜在地，有许多对象将以相同的方式出现在两个列表中。我意识到智能指针会很容易做到，但称我为受虐狂——我更愿意弄清楚如何在没有它的情况下做到这一点。

目前，我正在尝试这种技术：

```
td::list<object*>::iterator iter;
for(iter = lista->begin(); iter != lista->end(); iter++) {
    delete (*iter);
    *iter = 0;
}

std::list<object*>::iterator iterB;
for(iterB = listb->begin(); iterB != listb->end(); iterB++) {
    if(*iterB != 0) {
        delete (*iterB);
        *iter = 0;
    }
}

delete lista;
delete listb; 
```

但它`delete lista;`在运行时中断了我的等价物。希望那里的指针更聪明的人可以帮助我。提前致谢！

PS 我正在运行 Windows 7/MinGW。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T04:15:36.087

一个主要问题是您（显然，您没有提供完整的代码）`delete`一个对象两次：一次是在遍历列表 A 时，一次是在遍历列表 B 时。

解决方案主要有以下三种：

*   使用引用计数智能指针，例如`std::shared_ptr`.
    受到推崇的。您不想使用智能指针的声明似乎是出于无知而不是某些愚蠢的经理的要求。

*   将节点也保留在主列表中：
    `delete`仅当您知道它仍在其中的唯一列表时，节点才是主列表。

*   自己实现引用计数：
    最简单的方法是再次使用现有的库解决方案，例如`boost::intrusive_ptr`，但您所要做的就是精心维护每个节点中的引用计数。`delete`当引用计数下降到 0 时。

第四种可能性是使用垃圾收集器，例如 Boehm 收集器，但代码需要结构化以支持它。或者至少这是我的印象。而且可能很难获得帮助，因为很少有 C++ 程序员使用这种方法（这表明它并非完全没有问题）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T04:10:35.003

使用`shared_ptr`或拥有一个主列表`unique_ptr`。

如果做不到这一点，请拥有一个拥有指针的主列表，并在清除后从中删除，但不要删除所有其他列表。

否则，不要直接从列表中直接删除。相反`insert`，您想要的指针进入 a `std::set`，并在删除之前将它们从其他列表中删除（迭代并在集合中查找），或者累积您想要处理的所有指针，然后从集合中批量删除它们。

这是按段落的粗略顺序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T03:54:41.570

不知道为什么你真的不想使用 shared_ptr。好吧适合自己。你创建一个本地 shared_ptr 怎么样？如果没有，则将两个列表都加载到一个主列表中。清除两个子列表，并删除主列表中的每个元素以及清除主列表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-29T05:11:29.513

在行

```
if(*iterB != 0) { 
```

*iterB 永远不会为0。所以你是双重删除。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-29T05:38:36.460

将计数器字段添加到您的`object`. 默认初始化为 0。添加到列表时添加 +1。-1 从列表中删除。如果`counter==0`，删除`object`.

这不是线程安全的`shared_ptr`，但出于同样的原因，它可以更快。

# sdl - #include"SDL/SDL.h" 和 #include"SDL.h" 之间的区别

> ID：14078532
> 
> 赞同：1
> 
> 时间：2012-12-29T03:50:45.683
> 
> 标签：sdl

我正在使用 Ubuntu 12.04.1 。我使用的编译器是 gcc，我的 IDE 是 CodeBlocks。我正在使用 C/C++ 下的 SDL。当我包含**"SDL/SDL.h"**时，程序被编译并显示输出。但包括**“SDL.h”**会出错：

> 致命错误：SDL.h：没有这样的文件或目录
> |=== 构建完成：1 个错误，0 个警告 ===|

**/usr/include**中还有 2 个**SDL.h**文件- 一个是**/usr/include/SDL/SDL.h** 另一个是**/usr/include/SDL.h**

 ******两个头文件有什么区别，为什么只有一个路径有效？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T14:36:10.363

#include 指向文件夹“MinGW\include”。有些人将他们的整个 SDL 文件夹移动到那里，因此 SDL.h 位于“SDL\SDL.h”中。其他人只是将他们的 SDL.h 移动到他们的包含文件夹，这意味着他们只需要使用“SDL.h”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T03:57:46.260

我不确定您为什么有 2 个 SDL.h 副本或那是什么，但这有帮助吗？['"SDL.h" 没有找到这样的文件或目录' 编译时](https://stackoverflow.com/questions/10488775/sdl-h-no-such-file-or-directory-found-when-compiling)

如果您制作了副本，则应将其删除。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-12T19:05:32.443

这：

```
#include "myheader.h" 
```

查找名为 myheader.h 的文件，同时执行以下操作：

```
#include "MyFolder\myheader.h" 
```

在名为 MyFolder 的文件夹中查找名为 myheader.h 的文件******

# rvm - 如何让 SublimeLinter 停止报告误报错误？

> ID：14078536
> 
> 赞同：0
> 
> 时间：2012-12-29T03:51:27.350
> 
> 标签：rvm, sublimetext2, sublimelinter

问题是 SublimeLinter 有时会将行报告为包含错误，而实际上并没有。这方面的一个例子是像`format.html { redirect_to :action => :index }`.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-29T03:51:27.350

这是因为 SublimeLinter 使用的是系统 ruby​​，而不是 gemset 的 ruby​​。看，SublimeLinter 使用的 Ruby linter 非常简单。它只是运行代码`ruby -wc`并标记代码中的任何输出。但这就是问题所在。Sublime Text 2 没有使用`ruby`你的 Rails 应用程序使用的。

您可以通过打开`Sublime Text 2`菜单，进入 Preferences -> Package Settings -> SublimeLinter，然后选择来更改 SublimeLinter 设置以纠正此问题`Settings - User`。将此文本添加到文件中，保存并重新启动 Sublime Text 2：

```
{
    "sublimelinter_executable_map":
    {
        "ruby": "rvm-auto-ruby"
    }
} 
```

# java - 通话记录-不记录来自特定号码的通话

> ID：14078539
> 
> 赞同：0
> 
> 时间：2012-12-29T03:52:26.957
> 
> 标签：java, android, broadcastreceiver, voice-recording, phone-state-listener

在这里，我想记录来自 15555215556 的电话，因为我已经给出了 IF 条件-“String aa="15555215556"; if(aa.equals(incomingNumber))”。如果incomingNumber 等于aa 它应该开始录制，但它不录制。

公共类记录扩展广播接收器{

```
PhoneStateListener listener; 
TelephonyManager telephony;
MediaRecorder recorder = new MediaRecorder();
boolean recordStarted;
String phonenumber;

@Override
public void onReceive(final Context context, final Intent intent) {
    // TODO Auto-generated method stub

     telephony = (TelephonyManager)context.getSystemService(Context.TELEPHONY_SERVICE);

        listener = new PhoneStateListener() {

            public void onCallStateChanged(int state, String incomingNumber) {

//want to record call from 15555215556
                String aa="15555215556";
            if(aa.equals(incomingNumber)){

               phonenumber=incomingNumber;
               System.out.println(""+phonenumber);

                try{

                switch(state)
                {
                case TelephonyManager.CALL_STATE_IDLE:
                   {
                       Log.d("DEBUG", "IDLE");        
                        StopRecording();
                      break;
                   }

                case TelephonyManager.CALL_STATE_RINGING:
                   {
                       Log.d("DEBUG", "RINGING");
                       StopRecording();
                       break;
                   }
                case TelephonyManager.CALL_STATE_OFFHOOK:
                   {
                        Log.d("DEBUG", "OFFHOOK");      

                        StartRecording();
                          break;
                   }

                }

                }

                catch (Exception e) {
                    // TODO: handle exception
                }
           }

            }

            public void StartRecording(){

                    try{

                 recorder.setAudioSource(MediaRecorder.AudioSource.VOICE_CALL);
                 recorder.setOutputFormat(MediaRecorder.OutputFormat.DEFAULT);
                 recorder.setAudioEncoder(MediaRecorder.AudioEncoder.AMR_NB);
                 recorder.setOutputFile(this.getFullSdPath());
                 recorder.prepare();

                 recorder.start();   // Recording is now started
                    Log.i(this.getClass().getName(), "Start Recording");
                    }
                    catch (Exception e) {
                        // TODO: handle exception
                    }

            }

            public void StopRecording(){

                 recorder.stop();          
                 recorder.release();
                 recorder = null;
                 Log.i(this.getClass().getName(), "Stop Recording");
                }

            public String getFullSdPath(){
               File sdCard = new File(Environment.getExternalStorageDirectory()    + "/RecordMyVoice");
                if (!sdCard.exists()) {
                  sdCard.mkdir();
                }
                File file = new File(Environment.getExternalStorageDirectory()      +"/RecordMyVoice/",new Date().getTime()+".mp3");
                System.out.println("Full path of record sound is : "+file.getAbsolutePath());
                return file.getAbsolutePath();
            }           
        };    

        telephony.listen(listener, PhoneStateListener.LISTEN_CALL_STATE);    

        }

} 
```

日志

```
12-30 15:48:33.973: I/incom(350): 15555215556
12-30 15:48:33.973: I/System.out(350): 15555215556
12-30 15:48:33.973: D/DEBUG(350): RINGING
12-30 15:48:33.973: E/MediaRecorder(350): stop called in an invalid state: 1
12-30 15:48:34.332: D/dalvikvm(130): GC_CONCURRENT freed 234K, 51% free 2830K/5703K, external 1006K/1038K, paused 6ms+69ms
12-30 15:48:35.042: D/dalvikvm(126): GC_EXTERNAL_ALLOC freed 277K, 50% free 3003K/5895K, external 1024K/1038K, paused 118ms
12-30 15:48:35.572: D/dalvikvm(126): GC_EXTERNAL_ALLOC freed 45K, 49% free 3039K/5895K, external 1533K/1562K, paused 128ms
12-30 15:48:35.672: W/ResourceType(126): getEntry failing because entryIndex 65 is beyond type entryCount 1
12-30 15:48:36.072: D/dalvikvm(126): GC_EXTERNAL_ALLOC freed 23K, 48% free 3105K/5895K, external 2081K/2084K, paused 58ms
12-30 15:48:37.502: I/ActivityManager(61): Displayed com.android.phone/.InCallScreen: +4s106ms
12-30 15:48:42.712: D/dalvikvm(187): GC_EXPLICIT freed 91K, 52% free 2766K/5703K, external 716K/1038K, paused 126ms
12-30 15:48:47.908: D/dalvikvm(350): GC_EXPLICIT freed 58K, 53% free 2562K/5379K, external 716K/1038K, paused 224ms
12-30 15:49:03.642: D/dalvikvm(126): GC_CONCURRENT freed 203K, 48% free 3152K/6023K, external 2387K/2604K, paused 10ms+9ms
12-30 15:49:09.102: W/ResourceType(126): Attempt to retrieve bag 0x01010041 which is invalid or in a cycle.
12-30 15:49:09.112: D/InCallTouchUi(126): onDialTrigger(whichHandle = 1)...
12-30 15:49:09.142: D/AudioHardwareInterface(34): setMode(RINGTONE)
12-30 15:49:09.172: I/phone(126): acceptCall: incoming...
12-30 15:49:09.222: D/InCallTouchUi(126): updateState: Too soon after last action; not drawing!
12-30 15:49:09.432: I/AudioService(61):  AudioFocus  requestAudioFocus() from AudioFocus_For_Phone_Ring_And_Calls
12-30 15:49:09.602: D/AudioHardwareInterface(34): setMode(IN_CALL)
12-30 15:49:13.832: I/AudioService(61):  AudioFocus  abandonAudioFocus() from AudioFocus_For_Phone_Ring_And_Calls
12-30 15:49:13.952: I/PowerManagerService(61): clearUserActivity for 10000ms from now
12-30 15:49:14.272: D/dalvikvm(126): GC_EXTERNAL_ALLOC freed 101K, 48% free 3166K/6023K, external 2594K/2604K, paused 155ms
12-30 15:49:14.503: I/ActivityManager(61): Starting: Intent { act=android.intent.action.VIEW typ=vnd.android.cursor.dir/calls flg=0x10000 cmp=com.android.contacts/.DialtactsActivity } from pid 126
12-30 15:49:14.532: D/AudioHardwareInterface(34): setMode(NORMAL)
12-30 15:49:14.722: I/ActivityManager(61): moveTaskToBack: 5
12-30 15:49:15.651: D/dalvikvm(187): GC_CONCURRENT freed 385K, 51% free 2899K/5895K, external 716K/1038K, paused 6ms+6ms
12-30 15:49:15.691: I/dalvikvm(187): Total arena pages for JIT: 11
12-30 15:49:17.161: D/dalvikvm(187): GC_EXTERNAL_ALLOC freed 61K, 50% free 2996K/5895K, external 1035K/1038K, paused 166ms
12-30 15:49:18.571: I/ActivityManager(61): Displayed com.android.contacts/.DialtactsActivity: +3s757ms 
```

我的代码有什么问题吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T03:17:02.880

这里你在“onCallStateChanged”中只得到一次来电，所以你需要把号码放在共享偏好中，最好让号码处于振铃状态

```
myprefs=context.getSharedPreferences("myprefs",001);
    final  SharedPreferences.Editor prefseditor=myprefs.edit();

    try{   

        switch(state)
        {
        case TelephonyManager.CALL_STATE_IDLE:
           { 
               try
           {
               Log.d("DEBUG", "IDLE");        
               StopRecording();  
           }
           catch (Exception e) {  
            // TODO: handle exception
        }

              break;
           }

        case TelephonyManager.CALL_STATE_RINGING:
           {
               prefseditor.putString("in",incomingNumber);
                prefseditor.commit();
               Log.d("DEBUG", "RINGING");
               StopRecording();
               break;
           }
        case TelephonyManager.CALL_STATE_OFFHOOK:
           {

               no1=myprefs.getString("in", "nothing");
                System.out.println("INCOMING"+no1);

                Log.d("DEBUG", "OFFHOOK");      

                String aa="15555215556";
                 if(aa.equals(no1)){

                 StartRecording();
                 break;
             }
           }
        }

    }
       catch (Exception e) {
            // TODO: handle exception
        }

    super.onCallStateChanged(state, incomingNumber);
}
private void StartRecording() {
    // TODO Auto-generated method stub

    try{

 recorder.setAudioSource(MediaRecorder.AudioSource.VOICE_CALL);
 recorder.setOutputFormat(MediaRecorder.OutputFormat.DEFAULT);
 recorder.setAudioEncoder(MediaRecorder.AudioEncoder.AMR_NB);
 recorder.setOutputFile(this.getFullSdPath());
 recorder.prepare();

 recorder.start();   // Recording is now started
    Log.i(this.getClass().getName(), "Start Recording");

    }
    catch (Exception e) {
        // TODO: handle exception
    }
    //db.execSQL("DROP TABLE IF EXISTS incomingnumber");
}
public String getFullSdPath(){
    File sdCard = new File(Environment.getExternalStorageDirectory()    + "/.RecordMyVoice");
     if (!sdCard.exists()) {
       sdCard.mkdir();
     }
     File file = new File(Environment.getExternalStorageDirectory()     +"/.RecordMyVoice/",new Date().getTime()+".mp3");
     System.out.println("Full path of record sound is : "+file.getAbsolutePath());
     return file.getAbsolutePath();
 }           

private void StopRecording() {
    // TODO Auto-generated method stub
    recorder.stop();          
    recorder.release();
    recorder = null;
    Log.i(this.getClass().getName(), "Stop Recording");
} 
```

# winforms - 如何在堆栈中表示 Collection PLUS 整数？

> ID：14078545
> 
> 赞同：0
> 
> 时间：2012-12-29T03:54:02.073
> 
> 标签：winforms, design-patterns

我们使用[堆栈](http://msdn.microsoft.com/en-us/library/c8hws30f.aspx)为用户提供一个简单的“后退”按钮。我们将集合推入堆栈并在他回击时再次弹出它们。

今天我们想稍微扩展一下。当我们将一个集合压入堆栈时，我们希望在集合旁边存储一个整数。然后，当我们查看堆栈时，我们想要检索集合加上它的整数。

将我们的集合 PLUS THE INTEGER 推入堆栈的最佳方式是什么？

我们应该为集合加整数定义一个结构或类吗？还是其他方式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T11:47:34.673

您不需要为此创建新类。您可以像这样简单地将您的值添加到堆栈中；

```
stack.Push(new KeyValuePair<int, Collection>(yourInteger, yourCollection)); 
```

让他们像这样；

```
KeyValuePair<int, Collection> valueYouWant = stack.Pop();

valueYouWant.Key   --> Your integer
valueYouWant.Value --> Your collection 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T09:36:16.793

最简单且开箱即用的解决方案是使用整数扩展当前容器：

```
public class StackElement : CustomerCollection
{ 
   public int Version {get; set;}
} 
```

或用整数组成：

```
public class StackElement
{ 
   public CustomerCollection Customers {get; set;}
   public int Version {get; set;}
} 
```

然后像使用任何其他东西一样使用它：

```
Stack<StackElement> stack = new Stack<StackElement>();
stack.Push(...)
var stackElement = stack.Pop(); 
```

# ruby-on-rails - 当我检查“nilness”时，为什么这个带有 if 语句的回调会失败？

> ID：14078546
> 
> 赞同：0
> 
> 时间：2012-12-29T03:54:15.293
> 
> 标签：ruby-on-rails

我的`Post`模型有以下列：

```
t.datetime "published_at"
t.string   "status" 
```

`published_at`应该只定义一次（第一次`post.status`等于`"Published"`）：

**post.rb:**

```
 before_save :publish_post

 protected

    def publish_post
      if self.status == "Published" && self.published_at.nil?
       self.published_at = Time.now
      end
    end 
```

现在，我`posts_count`在模型中添加了一个列`Tag`：

```
t.integer  "posts_count", :default => 0, :null => false 
```

计数器仅应在`post.status`等于时递增和递减`"Published"`（不应递增`post.status`等于`"Draft"`）：

**标记.rb：**

```
 after_save    :increment_tag_counter_cache
  after_destroy :decrement_tag_counter_cache

  private

   def increment_tag_counter_cache
     if self.post.status == "Published" && self.post.published_at.nil?
       Tag.increment_counter(:posts_count, self.tag.id)
     end
   end

   def decrement_tag_counter_cache
      if self.post.status == "Published" && self.post.published_at.nil?
        Tag.decrement_counter(:posts_count, self.tag.id)
      end
    end 
```

出于某种原因，现在计数器没有增加或减少。我尝试删除代码，发现问题出在这部分：`self.post.published_at.nil?`.

我不太确定发生了什么事。我很确定`published_at`就是`nil`在那一刻。可能是什么问题呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T04:03:39.613

你怎么知道

```
post.status == "Published" && post.published_at is really nil? 
```

?

post.published_at 可以只是**空白**。喜欢 ””

```
post.published_at.blank? 
```

.blank 的例子？和 .nil?:

```
"".nil?
#=> false

nil.nil?
#=> true

nil.blank?
#=> true

"".blank?
#=> true

"  ".blank?
#=> true

"     ".blank?
#=> true   

[].blank?
#=> true

{}.blank?
#=> true 
```

# c# - 从 Google Insight 下载 CSV？

> ID：14078555
> 
> 赞同：1
> 
> 时间：2012-12-29T03:54:51.073
> 
> 标签：c#, webclient

在过去的 4-5 个月前，我成功地做到了这一点，但现在我看到网站已经改变。我能够使用`HttpWebRequest`下载 CSV 文件的问题获得所需的搜索结果。

下载将无法正常工作。我用 WebClient 复制了这个，得到了所有的 cookie，但它仍然不起作用。

当我这样做时，我会在文件中得到这个

> .....meta http-equiv="refresh" content="0; url=' [http://www.google.com/trends#content=1](http://www.google.com/trends#content=1) &geo=US-AL&q=snooker&cmpt=q&hl=en-AU' ">

location.replace("http://www.google.com/trends#content\x3d1\x26geo\x3dUS-AL\x26q\x3dsnooker\x26cmpt\x3dq\x26hl\x3den-AU")

下载文件的代码如下：

```
public void downloadsheet(string url, string path)
    {
        try
        {
            using (WebClient client = new WebClient())
            {

                string tmpCookieString = string.Empty;

                string[] array = webBrowser1.Document.Cookie.Split(new char[]
                        {
                            ';'
                        });
                for (int i = 0; i < array.Length; i++)
                {
                    string cookie = array[i];
                    string name = cookie.Split(new char[]
                            {
                                '='
                            })[0];
                    string value = cookie.Substring(name.Length + 1);

                    //client.Headers.Add(name, value);
                    if (i < array.Length - 1)
                    {
                        tmpCookieString = tmpCookieString + name + "=" + value + ";";
                    }
                    else
                    {
                        tmpCookieString = tmpCookieString + name + "=" + value;
                    }
                }

                client.Headers.Add(HttpRequestHeader.Cookie, tmpCookieString);
                client.Headers.Add("Accept", "text/html, application/xhtml+xml, */*");
                client.Headers.Add("User-Agent", "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; InfoPath.2)");
                client.Headers.Add("Accept-Language", "en-US");
                using (FileStream file = File.Create(path))
                {
                    byte[] bytes = client.DownloadData(url);
                    file.Write(bytes, 0, bytes.Length);
                }
            }
        }
        catch (Exception exp_DE)
        {
        }
    } 
```

使用的网址是：

> [http://www.google.com/trends/trendsReport?hl=en-AU&q=snooker&geo=US-AL&cmpt=q&content=1&export=2](http://www.google.com/trends/trendsReport?hl=en-AU&q=snooker&geo=US-AL&cmpt=q&content=1&export=2)

如果我使用**WebBrowser**控件导航到上面的相应链接，它会打开一个对话框..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T05:35:43.260

问题是出于[安全目的](https://www.owasp.org/index.php/HttpOnly)而缺少HttpOnly cookie（即**SID**和**HSID** ） 。`WebBrowser.Document.Cookie`

这是解决方案：

```
[DllImport("wininet.dll", CharSet = CharSet.Auto, SetLastError = true)]
static extern bool InternetGetCookieEx(string pchURL, string pchCookieName, StringBuilder pchCookieData, ref uint pcchCookieData, int dwFlags, IntPtr lpReserved);
const int INTERNET_COOKIE_HTTPONLY = 0x00002000;

private static string GetGlobalCookies(string uri)
{
    uint datasize = 2048;
    StringBuilder cookieData = new StringBuilder((int)datasize);
    if (InternetGetCookieEx(uri, null, cookieData, ref datasize, INTERNET_COOKIE_HTTPONLY, IntPtr.Zero)
        && cookieData.Length > 0)
    {
        return cookieData.ToString();
    }
    else
    {
        return null;
    }
}

public void downloadsheet(string url, string path)
{
    try
    {
        using (WebClient client = new WebClient())
        {
            string tmpCookieString = GetGlobalCookies(webBrowser1.Url.AbsoluteUri);

            client.Headers.Add(HttpRequestHeader.Cookie, tmpCookieString);

            client.Headers.Add("Accept", "text/html, application/xhtml+xml, */*");
            client.Headers.Add("User-Agent", "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; InfoPath.2)");
            client.Headers.Add("Accept-Language", "en-US");
            using (FileStream file = File.Create(path))
            {
                byte[] bytes = client.DownloadData(url);
                file.Write(bytes, 0, bytes.Length);
            }
        }
    }
    catch (Exception exp_DE)
    {
    }
} 
```

当然，您应该在调用**InternetGetCookieEx**之前登录您的帐户。

# java - 初始上下文未加载 jndi.properties

> ID：14078562
> 
> 赞同：1
> 
> 时间：2012-12-29T03:55:44.910
> 
> 标签：java, eclipse, activemq, jndi

我正在尝试使用 Active MQ 和 Eclipse 设置示例聊天应用程序。

我已按照 Apache 站点上的文档进行操作，并在执行聊天应用程序时收到以下错误

```
javax.naming.NoInitialContextException: Need to specify class name in environment or system property, or as an applet parameter, or in an application resource file:  java.naming.factory.initial
    at javax.naming.spi.NamingManager.getInitialContext(Unknown Source)
    at javax.naming.InitialContext.getDefaultInitCtx(Unknown Source)
    at javax.naming.InitialContext.getURLOrDefaultInitCtx(Unknown Source)
    at javax.naming.InitialContext.list(Unknown Source) 
```

我假设`jndi.properties`文件没有加载，但不确定这是否是根本原因

以下问题类似，但我认为问题没有得到解决。 [如何在eclipse中的类路径上放置文件？](https://stackoverflow.com/questions/11302531/how-to-place-a-file-on-classpath-in-eclipse)

# c# - 尝试通过 Web 服务从 SOAP cal 更新数据，但只有少数字段正在更新

> ID：14078566
> 
> 赞同：0
> 
> 时间：2012-12-29T03:56:39.643
> 
> 标签：c#, asp.net, web-services, soap

在我的网络项目中，我通过网络服务和肥皂电话从 SQL DB 服务器获取客户详细信息，并在网页中显示相同的信息（个人详细信息）。用户可以从页面更新他们的个人详细信息。我的问题是 - 有些用户是新用户，我们在数据库中只有他们的 DOB 和 CustomerId。现在我正在尝试从页面更新新用户的详细信息，一切正常，但地址和城市没有更新。这是带有用户名和密码的网站链接。[https://www.starbazaarindia.com/test/index.aspx](https://www.starbazaarindia.com/test/index.aspx)用户 ID（俱乐部卡号）- SBS0050600092310 和密码 (DOB)- 19051985。

[https://www.starbazaarindia.com/test/index.aspx](https://www.starbazaarindia.com/test/index.aspx)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T09:37:28.780

[尝试在被调用和调试](http://msdn.microsoft.com/en-us/library/aa291236%28v=vs.71%29.aspx)的服务上设置一个调试断点。

服务帖子是 https 并返回 200，因此在不更改或调试的情况下，我们对错误视而不见。

我怀疑调试器中的 5 分钟你会有一个头晕目眩的时刻，然后修复它。

# php - 如何更改 wp_dropdown_categories 中“选项”和“选择”的值？

> ID：14078572
> 
> 赞同：1
> 
> 时间：2012-12-29T03:58:04.697
> 
> 标签：php, wordpress, drop-down-menu, custom-taxonomy

我目前正在使用此代码仅显示正在查看的当前类别的子术语 -

```
<?php

//first get the current term
$current_term = get_term_by( 'slug', get_query_var( 'term' ), get_query_var( 'taxonomy' ) );

//then set the args for wp_dropdown_categories
 $args = array(
    'child_of' => $current_term->term_id,
    'taxonomy' => $current_term->taxonomy,
    'hide_empty' => 0,
    'hierarchical' => true,
    'depth'  => 2,
    'title_li' => '',
        'show_option_all' => All,
        'hide_if_empty' => true
    );
 wp_dropdown_categories( $args );
?> 
```

我需要能够向 's 和开头添加值和类。我怎样才能修改上面的代码来做到这一点？

我不确定，但我想我已经接近了。-

```
<?php
function get_terms_dropdown($taxonomies, $args){
//first get the current term
$current_term = get_term_by( 'slug', get_query_var( 'term' ), get_query_var( 'taxonomy' ) );
 $args = array(
    'child_of' => $current_term->term_id,
    'taxonomy' => $current_term->taxonomy,
    'hide_empty' => 0,
    'hierarchical' => true,
    'depth'  => 2,
    'title_li' => '',
        'show_option_all' => All,
        'hide_if_empty' => true
    );
    $output ="<select name='".$term_slug."'><option selected='".$selected."' value='".$emptyvalue."'>Select a Category</option>'";

    foreach($current_term as $term){
        $output .="<option name='".$term_slug."' value='".$link."'>".$term_name."</option>";
    }
    $output .="</select>";
return $output;
}
echo get_terms_dropdown($taxonomies, $args);

?> 
```

问题是下拉菜单没有显示任何类别/术语，我错过了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T07:08:11.683

好的，但我回答了我自己的另一个问题。我能够创建下拉过滤器来检索正在查看的当前分类页面的子术语。对于任何对解决方案感兴趣的人，这里是---

首先我必须在我的functions.php文件中创建一个walker类——

```
class SH_Walker_TaxonomyDropdown extends Walker_CategoryDropdown{

    function start_el(&$output, $category, $depth, $args) {
        $pad = str_repeat('&nbsp;', $depth * 2);
        $cat_name = apply_filters('list_cats', $category->name, $category);

        if( !isset($args['value']) ){
            $args['value'] = ( $category->taxonomy != 'category' ? 'slug' : 'id' );
        }

        $value = ($args['value']=='slug' ? $category->slug : $category->term_id );

        $output .= "\t<option class=\"level-$depth\" data-filter-value=\".".$value."\"";
        if ( $value === (string) $args['selected'] ){ 
            $output .= ' selected="selected"';
        }
        $output .= '>';
        $output .= $pad.$cat_name;
        if ( $args['show_count'] )
            $output .= '&nbsp;&nbsp;('. $category->count .')';

        $output .= "</option>\n";
}
 } 
```

然后我把这段代码放在我的侧边栏中——

```
<?php

//first get the current term
$current_term = get_term_by( 'slug', get_query_var( 'term' ), get_query_var( 'taxonomy' ) );

//then set the args for wp_dropdown_categories
 $args = array(
    'walker'=> new SH_Walker_TaxonomyDropdown(),
    'value'=>'slug',
    'child_of' => $current_term->term_id,
    'taxonomy' => $current_term->taxonomy,
    'hide_empty' => 0,
    'hierarchical' => true,
    'depth'  => 2,
    'title_li' => '',
    'id' => 'filter-select',
    'class' => 'filter option-set',
        'show_option_all' => All,
        'hide_if_empty' => true
    );
 wp_dropdown_categories( $args );
?> 
```

# r - 粘贴/连接涉及反斜杠的字符串

> ID：14078574
> 
> 赞同：1
> 
> 时间：2012-12-29T03:58:24.883
> 
> 标签：r

我有一个接受参数的函数`bm`（然后传递给`format()`）。在函数的某个时刻，我想使用相同的参数`bm`并将其粘贴到向量的元素中。正如您从最小示例中看到的那样，字符串并不相同。我如何（给定参数`bm`）使用参数`bm`和某种......来获得与（即代替）`paste()`相同的结果？`format()``\\,``\\\\,`

```
bm <- "\\\\,"
x <- format(c(1,10000), big.mark=bm, trim=TRUE)
y <- x
y[1] <- paste0(bm, x[1])
y # both components should contain \\, 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T04:58:07.063

不确定这是否对您`\\\\,1`有帮助，但长度为 4 且`10\\,000`长度为 7。我假设您希望 y[2] 等于 R string `10\\\\,000`。一种方法是`encodeString()`在操作字符串后使用：

```
bm <- "\\\\," 
x <- encodeString(format(c(1,10000), big.mark=bm, trim=TRUE))
y <- x
y[1] <- paste0(bm, x[1])
y
# [1] "\\\\,1"     "10\\\\,000" 
```

# magento - 如何根据登录 Magento 的管理员角色显示或隐藏特定块

> ID：14078576
> 
> 赞同：0
> 
> 时间：2012-12-29T03:58:53.737
> 
> 标签：magento, rendering, admin, show-hide, roles

假设我在 Magento Role1 和 Role2 中创建了两个管理员角色。我想显示一个特定的块，比如说“store-switcher”，只有当具有角色 1 的用户登录时，而对于具有角色 2 的用户，它不应该被呈现。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T09:51:12.333

您可以构建一个自定义扩展或一个观察者来检查登录的管理员用户。根据用户，您可以添加自定义设计句柄。然后使用 XML 布局系统，您可以根据需要为特殊句柄删除或添加块。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T15:43:50.467

在没有看到您的代码并且不知道要在哪里添加块的情况下，很难说出实现此目的的最佳方法，但您可以尝试

看一看 @

*   [Magento - 如何查询管理员的角色名称？](https://stackoverflow.com/questions/2024564/magento-how-to-query-admins-role-name)
*   [Magento：如何从用户 ID 获取用户角色](https://stackoverflow.com/questions/9796128/magento-how-to-get-user-role-from-user-id)

然后

```
if(role1){
   echo $this->getLayout()->createBlock('mageigniter/storeswitcher')->toHtml();
} 
```

另请参阅[如何从控制器加载 magento 视图 (.phtml) 文件](https://stackoverflow.com/questions/6846451/how-to-load-a-magento-view-phtml-file-from-a-controller)

# html - HTML & CSS - 以角度显示图像

> ID：14078581
> 
> 赞同：0
> 
> 时间：2012-12-29T04:00:12.270
> 
> 标签：html, css, image

我需要以[如下所示的角度显示图像](http://www.datingjapan.co)。是 CSS Transfer 的方式吗？

![在此处输入图像描述](../Images/98c6915afa3e4a7fe1b2dc2baa8c041a.png)

```
/* Rotate div */
transform:rotate(7deg);
-ms-transform:rotate(7deg); /* Internet Explorer */
-moz-transform:rotate(7deg); /* Firefox */
-webkit-transform:rotate(7deg); /* Safari and Chrome */
-o-transform:rotate(7deg); /* Opera */ 
```

我只需要为每个图像计算出正确的旋转度数吗？尺寸和定位很容易。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T04:06:56.367

是的，对于每个图像，您都需要对其进行旋转。但是您也可以使用没有背景的学位对其进行 Photoshop 处理并将其保存为 png。这样你就不必给它一个旋转。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T04:15:18.220

是的，我完全同意@Cody Guldner 的选择。您只需获取列表中的所有图像，即

```
<ul>
  <li><img src="" alt="" /></li>
  <li><img src="" alt="" /></li>
  <li><img src="" alt="" /></li>
  <li><img src="" alt="" /></li>
  <li><img src="" alt="" /></li>
  <li><img src="" alt="" /></li>
</ul> 
```

对于每张图片，您都可以设置您使用的 CSS，只需添加`nth-of-type(1)`它，您就可以完全控制这些图片。

# ruby-on-rails - 确保记录与仅由具有规范的父级拥有的记录相关联的测试验证

> ID：14078583
> 
> 赞同：2
> 
> 时间：2012-12-29T04:00:22.707
> 
> 标签：ruby-on-rails, validation, testing, factory-bot, rspec-rails

我有模型类别，它具有并属于许多包。当用户在类别中创建发布时，它必须属于其类别中的包。

这是自定义验证器的代码：

```
class PackageValidator < ActiveModel::Validator
  def validate(record)
    record.errors[:package_id] <<
      I18n.t('errors.messages.package.not_in_category') unless
      record.category.packages.include? record.package
  end
end 
```

这很好用，但它打破了我所有的 rspec 测试（使用 factory_girl），因为 factory_girl 为每个类别创建一个新包，并用它构建/创建发布。

这是我的工厂：

```
factory :category do
  sequence(:name) {|n| "Parts#{n}"}
  sequence(:slug) {|n| "parts#{n}"}
  packages {[FactoryGirl.create(:package)]}
end

factory :posting do
  title 'Foo'
  body 'Bar'
  category
  package
end

factory :package do
  sequence(:name) {|n| "Basic#{n}"
  price 0
  photos 5
end 
```

我怎样才能让它们一起很好地发挥作用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T01:33:36.633

您可以将包设置为`category.packages.first`挂钩`after(:build)`。

# jquery - 通过带有错误处理的 jquery 将远程图像加载到 background-url (css)

> ID：14078584
> 
> 赞同：0
> 
> 时间：2012-12-29T04:00:31.517
> 
> 标签：jquery, ajax, background-image

在页面上，我有一个带有某个图像作为背景 URL 的 css 属性。

我想要发生的是通过 jquery/ajax 加载第二个（远程）图像（到 background-url 属性中），如果在检索图像时出现任何错误，则加载第二个“默认”图像。

我将如何完成这样的事情？

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T04:10:36.557

```
 $(document).ready(function() {
          // Handler for .ready() called.
            $.ajax({
                    url: "/loadimageurl.php",
                    type: "post",
                    data: data,
                    // callback handler that will be called on success
                    success: function(imageUrl, textStatus, jqXHR){
                        // log a message to the console
                        console.log("Hooray, it worked! Load The Image Here");
                        $('body').css('background-image', 'url(' + imageUrl + ')');
                    },
                    // callback handler that will be called on error
                    error: function(jqXHR, textStatus, errorThrown){
                        DefaultimageUrl = 'path/to/default/image.jpg';                        
                        // log the error to the console
                        console.log(
                            "Load Default Image here! The following error occured: "+
                            textStatus, errorThrown
                        );
                        $('body').css('background-image', 'url(' + DefaultimageUrl + ')');
                    }
                });

        }); 
```

当页面加载时，ajax 调用将被触发并被`loadimageurl.php`调用。如果需要，数据变量将数据发布到 php 脚本。如果调用成功（从 php 脚本返回图像 url）您设置图像 url 否则错误函数将设置默认图像 url。

阅读注释以正确理解步骤并使用控制台检查 ajax 调用的执行方式并返回数据。如果您有任何问题，请告诉我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T04:14:56.753

这是我能够想出的：

```
$(function() {
    var main_image = '';
    var second_image = '';
    $.ajax({url: main_image, cache: false, success: function(d) {
        console.log('success');
        $('#bg').css('background',main_image);                
    }, error: function() {
        console.log('failure');
        $('#bg').css('background',second_image);
    }});    
});​ 
```

jsFiddle：http: [//jsfiddle.net/sVZdK/](http://jsfiddle.net/sVZdK/)

我无法用图像对其进行测试，但我相信它会起作用。

# javascript - 整页水平滚动问题

> ID：14078587
> 
> 赞同：8
> 
> 时间：2012-12-29T04:01:19.237
> 
> 标签：javascript, jquery, scroll, jscrollpane

**整页滚动还有其他选择吗？**

整页滚动示例

[http://jscrollpane.kelvinluck.com/fullpage_scroll.html](http://jscrollpane.kelvinluck.com/fullpage_scroll.html)

第 1 步通过单击“恢复向下”按钮使窗口宽度变小。

step-2 向右滚动

现在第 3 步，通过单击“最大化”按钮使窗口宽度变大。

现在，页面左对齐

jQuery

```
 $(function()
{
    var win = $(window);

    win.bind(
        'resize',
        function()
        {

                var container = $('#full-page-container');

                container.css(
                    {
                        'width': 1,
                        'height': 1
                    }
                );

                container.css(
                    {
                        'width': win.width(),
                        'height': win.height()
                    }
                );
                isResizing = false;
                container.jScrollPane(
                    {
                        'showArrows': true
                    }
                );

        }
    ).trigger('resize');

    $('body').css('overflow', 'hidden');

    if ($('#full-page-container').width() != win.width()) {
        win.trigger('resize');
    }

}); 
```

CSS

```
html
{
    overflow: auto;
}
#full-page-container
{
    overflow: auto;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-31T12:20:02.520

这里的事情是 jScrollPane 在您向右滚动时添加 jspPane 一个 left:-***px 。并且永远不会消除损坏。

如果您要添加：

`$('#full-page-container .jspPane').css('left', 'auto');`

在您调整大小时，它将起作用。尽管我建议您也向 jScrollPane 家伙报告一个错误。

# python - oauth 身份验证后重定向永远不会发生在烧瓶-oauth 中

> ID：14078588
> 
> 赞同：2
> 
> 时间：2012-12-29T04:01:24.013
> 
> 标签：python, oauth, flask

我正在为 Flask 使用 Flask-Oauth 插件来通过 Twitter 进行身份验证。我基本上使用的是文档中的确切代码，但返回索引的重定向似乎永远不会发生。或者，如果发生这种情况，则会发生一些奇怪的浏览器缓存。

我的主页基本上是这样的：

```
@app.route('/', methods=['GET'])
def home():
    form = SadForm()
    if not g.user:
        needs_login = True
    else:
        # get some user stuff to display

    return render_template(...) 
```

该页面上有一个按钮可以转到与文档匹配的登录视图：

```
@app.route('/login')
def login():
    return twitter.authorize(callback=url_for('oauth_authorized',
        next=request.args.get('next') or request.referrer or None)) 
```

此视图中涵盖了回调：

```
@app.route('/oauth-authorized')
@twitter.authorized_handler
def oauth_authorized(response):
    next_url = request.args.get('next') or url_for('home')
    if response is None:
        flash(u'You denied the request to sign in.')
        return redirect(next_url)

    session['user_id'] = response['screen_name']
    current_user = g.db.users.find_one({'user_id': response['screen_name']})
    if current_user:
        user = current_user
    else:
        user = {}
    user['user_id'] = response['screen_name']
    user['twitter_token'] = response['oauth_token']
    user['twitter_secret'] = response['oauth_token_secret']
    g.user = user.copy()
    g.db.users.save(user)
    flash('You were signed in.')
    return redirect(next_url) 
```

看来，此方法末尾的重定向应该“刷新”视图，`home`因为我们已设置`g.user`将显示用户的内容。但是，实际上，主页认为没有人登录，但如果我使用浏览器按钮刷新页面，它就知道我已登录并呈现正确的数据。

服务器日志如下所示：

```
21:39:36     INFO werkzeug - 127.0.0.1 - - [28/Dec/2012 21:39:36] "GET / HTTP/1.1" 200 -
21:39:45     INFO werkzeug - 127.0.0.1 - - [28/Dec/2012 21:39:45] "GET /login HTTP/1.1" 302 -
21:39:47     INFO werkzeug - 127.0.0.1 - - [28/Dec/2012 21:39:47] "GET /oauth-authorized?oauth_token=nope&oauth_verifier=beep HTTP/1.1" 302 - 
```

请注意，“GET /”的 302 之后没有 200 `oauth-authorized`。不应该吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-30T20:17:01.617

原来这是一个简单的缓存问题。在我`add_header`用 装饰的方法中`@app.after_request`，我做了以下更改：

```
- response.headers['Cache-Control'] = 'public, max-age=600' 
+ response.headers['Cache-Control'] = 'public, max-age=0' 
```

所以，现在浏览器知道每次都重新获取索引视图。最终，对于更大规模的站点，我会改变这种模式，以便有效地使用缓存。

# r - ～总之是什么意思？

> ID：14078591
> 
> 赞同：2
> 
> 时间：2012-12-29T04:02:21.787
> 
> 标签：r

```
x <- iris[,1:4]
names(x) <- c("x1","x2","x3","x4")
aggregate(x1+x2+x3+x4~x1,FUN=sum,data=x) 
```

这是输出，我想知道
1.`~`公式中的含义是什么？
2.为什么`x1 = 4.3` 是`x1 + x2 + x3 + x4` 8.5？

x1 x1 + x2 + x3 + x4
1 4.3 8.5
2 4.4 26.9
3 4.5 8.4

当我使用

```
 transform(x,x1=sort(x1)) 
```

我得到的是：

```
 x1  x2  x3  x4  
1   4.3 3.5 1.4 0.2  
2   4.4 3.0 1.4 0.2  
3   4.4 3.2 1.3 0.2  
4   4.4 3.1 1.5 0.2 
```

（很多输出省略）
什么时候 `x1=4.3` ，`x1 + x2 + x3 + x4` is not `3.5+1.4+0.2=5.1`,nor `4.3+3.5+1.4+0.2=9.4`?

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-29T04:05:19.557

`~`在`aggregate()`分隔中，左侧是“聚合”的内容，右侧是用于“聚合”项目的内容。

在您的示例中，`x1 + x2 + x3 + x4`将计算每一行的结果，然后根据`tuples`其中`x1`出现的具有相同值的组进行汇总。

因此，您之所以拥有`8.5`，是因为汇总的数据是：

```
x1 + x2 + x3 + x4 = sum(c(4.3, 3.0, 1.1, 0.1)) = 8.5 
```

在您的示例中，带有 的`x1 = 4.3`行是第 14 行：`14 4.3 3.0 1.1 0.1`。

将所有值相加，并将每个结果和按`x1`值聚合，并发送到`FUN=sum`求和。

因为只有一个`x1 = 4.3`，所以值将是简单`8.5`的，这是第 14 行条目总和的结果。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-29T04:10:04.650

波浪[号运算符](http://stat.ethz.ch/R-manual/R-patched/library/base/html/tilde.html)创建一个符号公式。[这是一篇博客文章](http://www.r-bloggers.com/using-r-for-introductory-statistics-chapter-3-4/)的摘录，它比我能更好地解释它：

> f = 价格 ~ 克拉
> 
> [...]
> 
> 我们首先使用看起来很奇怪的波浪号运算符创建公式 f。这告诉 R 解释器我们正在定义一个符号公式，而不是一个要立即计算的表达式。所以，我们对公式 f 的定义说，“价格是克拉的函数”。

[公式](http://stat.ethz.ch/R-manual/R-devel/library/stats/html/formula.html)s的手册页对波浪号运算符有更多说明。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T04:24:19.073

关于你的第二个问题，在 Iris 数据集中只有一行第一列是 4.3。该行是：

```
(x[x[,1]==4.3,])

#     x1 x2  x3  x4
# 14 4.3  3 1.1 0.1

# and 4.3 + 3.0 + 1.1 + 0.1 = 8.5.

sum(x[x[,1]==4.3,])

# [1] 8.5

# There are four rows where x1 = 6.9\.  Those rows are:

x[x[,1]==6.9,]

#      x1  x2  x3  x4
# 53  6.9 3.1 4.9 1.5
# 121 6.9 3.2 5.7 2.3
# 140 6.9 3.1 5.4 2.1
# 142 6.9 3.1 5.1 2.3

# and

# 6.9 + 3.1 + 4.9 + 1.5 +
# 6.9 + 3.2 + 5.7 + 2.3 +
# 6.9 + 3.1 + 5.4 + 2.1 +
# 6.9 + 3.1 + 5.1 + 2.3 = 69.4

sum(x[x[,1]==6.9,])

# [1] 69.4 
```

关于你的新问题，我认为

```
transform(x,x1=sort(x1)) 
```

仅对第一列进行排序，其他列保持不变，在这种情况下，您正在更改数据集。

4.3+3.5+1.4+0.2=9.4

```
#      x1  x2  x3  x4
# 1   4.3 3.5 1.4 0.2
# 2   4.4 3.0 1.4 0.2
# 3   4.4 3.2 1.3 0.2
# 4   4.4 3.1 1.5 0.2
# 5   4.5 3.6 1.4 0.2 
```

如果要通过增加第一列的值而不更改数据集来对数据集进行排序，请使用：

```
x[order(x$x1),]

#      x1  x2  x3  x4
# 14  4.3 3.0 1.1 0.1
# 9   4.4 2.9 1.4 0.2
# 39  4.4 3.0 1.3 0.2
# 43  4.4 3.2 1.3 0.2
# 42  4.5 2.3 1.3 0.3 
```

# c# - C# 线程在第二个线程上崩溃，不确定如何修复

> ID：14078593
> 
> 赞同：1
> 
> 时间：2012-12-29T04:03:04.920
> 
> 标签：c#, .net, multithreading, concurrency, for-loop

只是为了好玩，我创建了一个 mandelbrot 程序。我现在试图通过将图像分成两个左/右部分以由两个线程处理来使其成为多线程。但是，应用程序一启动就会崩溃（尽管根据我的控制台输出，第一个线程在崩溃后继续，但第二个线程永远不会启动），我不确定该怎么做。

崩溃就在这条线上`this.output[x][y] = this.calculate_pixel_rgb(x, y);`，说我缺少一个对象引用，我不明白，因为它适用于第一个线程。

```
 public void compute_all()
    {
        this.setcolors(); this.zoom_multiplier = (4 / this.zoom / this.resolution);
        Thread thread1 = new Thread(new ParameterizedThreadStart(computation_thread)); thread1.Start(new double[] { 0, 0.5 });
        Thread thread2 = new Thread(new ParameterizedThreadStart(computation_thread)); thread2.Start(new double[] { 0.5, 1 });
        thread1.Join(); thread2.Join();
    }

    public void computation_thread(object threadinfo)
    {
        double[] parameters = (double[])threadinfo;

        this.output = new int[this.resolution][][];
        for (int x = (int)(this.resolution * parameters[0]); x < (int)(this.resolution * parameters[1]); x++)
        {
            this.output[x] = new int[this.resolution][];
            for (int y = 0; y < this.resolution; y++)
            {
                this.output[x][y] = this.calculate_pixel_rgb(x, y);
                this.pixels_completed++;
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-29T04:19:21.880

您的两个线程正在操作相同的输出缓冲区，相互覆盖。如果可以避免的话，不要在线程之间共享内存；它引起的只是悲伤。

如果这个练习的目的是学习如何操作原始线程，那么退后一步，研究为什么在两个线程之间共享内存是一个坏主意。

如果这个练习的目的是并行化分形的计算，那么忘记操作原始线程。您将更好地学习如何使用**任务并行库**。

线程在逻辑上是*工人*，谁想管理一堆工人？TPL 鼓励您将并行化视为对可以并行完成的*任务*的操作。让 TPL 负责确定分配给您的任务的工人数量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T04:21:38.103

`this.output`您的代码中的问题是多次 初始化（每个线程一次）。

你的两个线程都使用相同的`this`，当第一个线程初始化`this.output`的列时，第二个线程重新初始化它，第一个线程失去其分配的内存。

因此，`this.output[x]`将不再存在于第一个线程中（`missing an object reference`异常）。

这也解释了为什么您的代码只需一个线程即可完美运行。

简单的解决方案是在一开始就初始化整个数组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T04:26:20.923

你的逻辑似乎很可疑。

但是，如果您认为它是正确的并且`this.output`在每个线程中都需要重置数据，那么请执行以下操作：

1.  制作临时数组
2.  更改`[x][y]`为 [x,y]
3.  更改`[][]`为`[,]`
4.  `lock`在设置为之前应用`this.output`

# javascript - d3.js 和地理投影 albers/centers

> ID：14078594
> 
> 赞同：2
> 
> 时间：2012-12-29T04:03:32.407
> 
> 标签：javascript, d3.js, visualization

下面是我编写的一些代码，我希望有人可以帮助我并解释为什么它没有像我想象的那样响应。

我已经（很明显）从许多示例、文档等在线拼凑而成，并且正在使用 d3.v3.js。我想更好地理解投影的中心、比例和翻译“属性”的作用，所以除了我已经完成的大量阅读之外，我想我会写一个简短的脚本，让用户能够单击地图的新“中心” - 实际上，您应该能够单击此地图（使用图库中的一些可用数据制作）并将地图重新​​定位到新的州/位置/等。

问题是每次我将数据的新中心设置为单击的反投影点（即反转点以获取新坐标以设置中心）时，地图以阿拉斯加为中心，然后我可以单击该一般区域几次，世界会“旋转”回视野。

我究竟做错了什么？我认为这个脚本可以帮助我更好地了解正在发生的事情，而且我已经做到了，但如果可能的话，我希望你能提供一点帮助。

```
<script>
var w = 1280;
var h = 800;

var proj = d3.geo.albers();                                                                    

var path = d3.geo.path()
            .projection(proj); 

var svg = d3.select("body")                                                                    
            .insert("svg:svg")                                                                 
               .attr("height", h)                                                              
               .attr("width", w);                                                              

var states = svg.append("svg:g")                                                               
                  .attr("id", "states");                                                       
d3.json("./us-states.json", function(d) {                                                      
   states.selectAll("path")                                                                    
      .data(d.features).enter()                                                                
         .append("svg:path")                                                                   
            .attr("d", path)                                                                   
            .attr("class", "state");                                                           
});

svg.on("click", function() {
   var p = d3.mouse(this);                                                                     
   console.log(p+" "+proj.invert(p));                                                          
   proj.center(proj.invert(p));
   svg.selectAll("path").attr("d", path);                                                      

});   

</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T02:24:17.583

您应该能够使用 projection.rotate()

```
svg.on("click", function() {
    p = proj.invert(d3.mouse(this));
   console.log(p);                                                          
   proj.rotate([-(p[0]), -(p[1])]);
   svg.selectAll("path").attr("d", path);

}); 
```

# wordpress - FTP删除的文件夹不断重新出现

> ID：14078598
> 
> 赞同：0
> 
> 时间：2012-12-29T04:04:04.857
> 
> 标签：wordpress, ftp, file-permissions

我在 mediatemple 下托管了以下 WP 站点：

[http://actividades.acropolis.org.mx.s160231.gridserver.com/actividades](http://actividades.acropolis.org.mx.s160231.gridserver.com/actividades)

（它的设置方式（我没有这样做，我只是负责将站点从更糟糕的主机迁移过来）是 actividades 页面成为站点的索引/主页）

一切都很美好，直到昨天突然间，与页面名同名的旧文件夹/actividades/（我在几个小时前删除了）重新创建了自己。

这导致：

[http://actividades.acropolis.org.mx.s160231.gridserver.com/actividades/](http://actividades.acropolis.org.mx.s160231.gridserver.com/actividades/)

由于页面的 apache modrewrite 名称与文件夹名称匹配......它冲突。更糟糕的是，该文件夹获得 750 权限，而不是 755 不允许 .htaccess 和 apache 进入。如果我修复了权限，您确实进入了文件夹，但得到了经典的（未找到索引文件）废话。

索引页与否，我不在乎这个文件夹……它有冲突，需要永远消失……

所以我删除了它，修复了这个问题，并注意到它在 5 秒后重新生成了。

我已经尝试了所有东西，搜索了所有东西，无论从服务器端的角度还是从 wordpress 的角度来看，似乎都没有任何答案。

如此破碎和失败，我向你们专家寻求智慧之言。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T00:51:22.033

事实证明，安装在这个特定 wp 网站上的插件中存储了一些信息，这些信息保留了它们以前所在的位置，在这种情况下，文件夹 /actividades/ 在我开始在该网站上工作之前。

所以有人通过 ftp 将它们从 /actividades/ 文件夹移到根目录中，根目录没有更新这些插件记录它们的图像和数据的路径，所以他们不断地重新制作文件夹......

我删除了核心 wp 文件，然后是 wp 内容文件夹，然后是站点的其余部分，然后进行了全新的重新安装。

鉴于 wordpress 本身凌乱的 php 特性，更不用说它的插件了……这种方式更简单。找到触发文件夹重新创建的精确脚本超出了我的范围。

# html - 如何向左或向右浮动两次？

> ID：14078610
> 
> 赞同：1
> 
> 时间：2012-12-29T04:07:56.647
> 
> 标签：html, css

基本上，我想在 div 的最左侧区域使用两个不同的元素，在 div 的最右侧区域使用两个。

但是，如果我使用 float:left 和 float:right 两次，我会得到以下信息：

```
 ELEMENT                                   ELEMENT

          ELEMENT                     ELEMENT 
```

而不是

```
 ELEMENT                                    ELEMENT

   ELEMENT                                    ELEMENT 
```

这是因为，当我第二次浮动时，css 会浮动剩余的剩余空间。

如何修复此错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T04:15:55.260

You can use `clear:both;` with `float:left;` property.

Try **[Jsbin](http://jsbin.com/avugad/3/watch)** demo

```
.left {
   float:left;
   width:40%;
   height:240px;
   border:1px solid red;
}

.right {
   float:right;
   width:40%;
   border:1px solid red;
   height:240px;
} 

.elem1 {
   float:left;
   margin-bottom:20px;
}

.elem2 {
   float:left;
   clear:both;
}

.elem3 {
   float:left;
   margin-bottom:20px;
}

.elem4 {
   float:left;
   clear:both;
}
```

```
<div class="left">
    <div class="elem1">element 1</div>
    <div class="elem2">element 2</div>
 </div>
 <div class="right">
    <div class="elem3">element3</div>
    <div class="elem4">element4</div>
</div>
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T04:11:25.030

你需要的是`clear: both`在你的 CSS 中。

您的浮动工作正常，但没有足够的内容将下一个元素推到第一个元素之下。如果您将它们设置为`clear`，那么它们会。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T04:14:13.670

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-29T04:19:37.427

Try this one:

Markup:

```
 <div class='clear:both'>
    <!-- left container -->
    <div style = "float:left;">
     <div style = "float:left;">
       Element
     </div>
     <div style = "float:left; clear:left;">
       Element
     </div>    
    </div>
   <!-- right container -->
   <div style = "float:right">
   <div style = "float:right;">
      Element
     </div>
   <div style = "float:right; clear:right;">
     Element
    </div>
</div> 
```

Please use your own external style, this is just to guide you.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-29T04:42:55.343

Please have a look [here](http://jsfiddle.net/L3SEJ/) on `jsfiddle`

```
.wrapper {
   height:100px;
   border:1px solid red;
   margin: 5px;  
}

.left {
   margin: 10px;    
   float:left;
   width: 45%;    
}

.right {
   margin: 10px;
   float:right;
   width: 45%;
}
```

```
<div class="wrapper">
    <div class="left">element 1</div>
    <div class="right">element 2</div>
</div>
<div class="wrapper">
    <div class="left">element3</div>
    <div class="right">element4</div>
</div>
```

![enter image description here](../Images/182891115293aa5fceecf2b489d1f800.png)

# php - PHP 动态页面建议

> ID：14078611
> 
> 赞同：0
> 
> 时间：2012-12-29T04:08:07.257
> 
> 标签：php, dynamic

我想用产品创建 200 多个页面。

我有5个类别。

我制作了一个原型 .php 文件，它每次都会包含正确的 product1.php 或 product2.php（使用 GET）。

此外，我希望每次都有不同的元标记。所以prototype.php 将包括元标记。

我想建议 b/c 我不知道我的想法是否正确（创建 200 个产品 php 文件，它们将包含图像、页面图等和 200 个元标记 php 文件，它们将包含每个产品元标记和描述/关键字等）

我一直很困惑 b/c 我想如果我尝试创建一个数据库会更容易。

但是我想知道如果我选择msql解决方案会比我之前写的解决方案更快或更慢。

如果您需要任何详细信息或我错过了什么，请告诉我！

* * *

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T04:09:51.657

数据库绝对是解决这个问题的方法。没有问题。

我建议[研究 MySQL，并学习使用它的 PDO 方法](https://stackoverflow.com/q/1943069/362536)。

# joomla - Joomla .htm url 映射到 CMS 中的页面

> ID：14078620
> 
> 赞同：0
> 
> 时间：2012-12-29T04:10:51.973
> 
> 标签：joomla

我继承了一个我不熟悉的 Joomla 网站。网站上页面的 url 就像

```
http://hufboxing.com/about.htm
http://hufboxing.com/training.htm
http://hufboxing.com/schedule.htm 
```

我查看了 .htaccess 文件，没有看到任何将 .htm url 映射到 Joomla 查询字符串 url 的规则。

在 CM 中，每篇文章上都有 url 别名。上述每个 url 对应的 URL 别名是：

```
http://hufboxing.com/about-us
http://hufboxing.com/team-training
http://hufboxing.com/the-gym-schedule 
```

但是，转到这些别名中的任何一个都会产生 404 页面。即使我将 .htm 扩展名附加到这些 url，它也会提供 404 页。

我在 Joomla 中的哪里向网站添加新页面并添加新的 .htm 网址？

这是网站： [http ://www.hufboxing.com](http://www.hufboxing.com)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T03:58:37.620

这是正常的。它们基于您的文章和菜单别名。Joomla 使用数据库来存储文本，因此您不会找到页面。你希望这些网址看起来如何？还有什么版本？添加页面登录管理员并去创建文章。然后你可能想去菜单管理器和链接。[我建议您在http://docs.joomla.org](http://docs.joomla.org)查看初学者文档。

# android - 当我在按钮的 onClickListner 上创建数据库、表和插入查询时，如何在 ListView 上显示（显示）插入的数据？

> ID：14078621
> 
> 赞同：0
> 
> 时间：2012-12-29T04:11:15.543
> 
> 标签：android, eclipse, sqlite

我在按钮的单击方法（onClickListener）上创建了数据库和表，我还在创建表后创建了 Insert 语句，它工作得很好。现在我想在下一个活动的列表视图控件上显示插入的数据。我不能使用 SQLiteOpenHelper 类来创建数据库和表，但我直接使用 OpenOrCreateDatabase() 函数创建数据库和表。

如何在activity的ListView中显示数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T04:49:03.217

您可以使用 SimpleCursorAdapter 将数据加载到 ListView 中。*您将在com.example.android.apis.view*包下的 ApiDemos（Android SDK 的一部分）中找到一些示例

 *[这是一个教程](http://www.vogella.com/articles/AndroidListView/article.html#cursor)*

# facebook - 禁止直接创建此对象类型 - 1611181

> ID：14078627
> 
> 赞同：2
> 
> 时间：2012-12-29T04:11:46.617
> 
> 标签：facebook, json, facebook-opengraph

所以我试图让它使用 /me/photos.upload 和 Open Graph API 发布一张示例照片。我收到以下错误

> {"error":{"type":"Exception","message":"禁止直接创建此对象类型。","code":1611181}}

我看了一遍，不知道这是什么意思。有任何想法吗？

编辑：代码：

```
include 'facebook.php';
include 'cURL.php';

$facebook = new Facebook(array(
  'appId'  => 'REMOVED',
  'secret' => 'REMOVED',
));

$access_token = $facebook->getAccessToken();

$fields = array( 'access_token' => $access_token,
                    'photo' => 'http://treesroulette.com/app/test.html'
                    );

    $result = HTTP_POST("https://graph.facebook.com/me/photos.upload",// URL to query
                        $fields,                    // POST fields; associative array
                        USER_AGENT,                 // user-agent value
                        "",                         // cookie storage and retrieval
                        "",                         // proxy; type:ip:port[:user:pass]; supported types: http, socks5
                        true,                       // return the data or not
                        false,                      // include headers in the return data
                        "",                         // set value for REFERER header
                        true,                       // automatically follow "redirects" ("Location" header)
                        false); 
echo $result; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T20:47:21.680

你的代码是错误的：没有这样的端点`/me/photos.upload`——旧的 REST API 有一个名为 photos.upload 的方法，但这与当前 API 的结构无关你在文档中看到了吗？如果是这样，请在下面添加评论，我会修复它。

你应该发布到`/me/photos`

请参阅[用户对象](https://developers.facebook.com/docs/reference/api/user/)`photos`的连接或本[指南以](https://developers.facebook.com/blog/post/498/)在博客中上传照片

此外，在粘贴代码时立即更改您的应用程序密码而不删除它

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-04T20:07:14.470

如果您想上传照片并显示自己的图标，我建议您阅读此主题：[在页面照片上传的新闻提要中显示自定义 Facebook 应用程序图标](https://stackoverflow.com/questions/13730737/show-custom-facebook-app-icon-in-news-feed-on-page-photo-upload)

# ubuntu - 如何在命令行中呈现百分比编码？

> ID：14078628
> 
> 赞同：0
> 
> 时间：2012-12-29T04:12:03.147
> 
> 标签：ubuntu, unicode, sed, command-line-interface

我经常有一个字符串“百分比编码”，例如`%D1%84%D0%B0%D0%B9%D0%BB`，如果它是链接的一部分，现代浏览器会正确呈现为`файл`.

我想知道：有没有一种简单的方法可以通过使用`sed`或其他命令行工具“呈现”具有百分比编码（或简单地以百分比编码的输入字符串）的文本文件？

另请参阅[此相关问题](https://stackoverflow.com/questions/14078659/how-can-i-render-utf-16be-in-command-line)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T04:23:01.200

Python 可以使用`urllib.unquote_plus`：

```
#!/usr/bin/env python2

import sys
import urllib

print urllib.unquote_plus("%D1%84%D0%B0%D0%B9%D0%BB") 
```

您可以设置一个别名以获得快速 cli 命令： [http ://ruslanspivak.com/2010/06/02/urlencode-and-urldecode-from-a-command-line/](http://ruslanspivak.com/2010/06/02/urlencode-and-urldecode-from-a-command-line/)

# android - 如何将我从 aspx Web 服务收到的对象中的内容分离到 android？

> ID：14078632
> 
> 赞同：0
> 
> 时间：2012-12-29T04:13:03.293
> 
> 标签：android, asp.net, ksoap2

我有一个如下提供的 aspx webservice 和一个使用该服务对象的 android 程序。android程序将对象消耗为：

```
anyType{Vehicle=anyType{VehicleID=KL-9876; VehicleType=Nissan; VehicleOwner=Sanjiva;};} 
```

但现在我想分离对象中的每个内容。我怎么做

我尝试 getAttibute(0) 只是为了检查我是否可以将 VehicleID 分离但不起作用...

我的**aspx 网络服务**如下：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Services;

namespace WebService4
{
    /// <summary>
    /// Summary description for Service1
    /// </summary>
    [WebService(Namespace = "http://tempuri.org/")]
    [WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
    [System.ComponentModel.ToolboxItem(false)]
    // To allow this Web Service to be called from script, using ASP.NET AJAX, uncomment the following line. 
    // [System.Web.Script.Services.ScriptService]
    public class Service1 : System.Web.Services.WebService
    {

        [WebMethod]
        public List<Vehicle> GetCustomerList()
        {
            Vehicle vehi = simpleCase();
            List<Vehicle> newL = new List<Vehicle> { vehi };
            return newL;

        }

        [WebMethod]
        public Vehicle simpleCase()
        {
            Vehicle obj = new Vehicle();
            obj.VehicleID = "KL-9876";
            obj.VehicleType = "Nissan";
            obj.VehicleOwner = "Sanjiva";
            return obj;
        }
    }

    //someObject.SomeMethod(obj);

    public class Vehicle
    {
        public string VehicleID { get; set; }
        public string VehicleType { get; set; }
        public string VehicleOwner { get; set; }
    }

} 
```

我的**android代码**如下：

```
package com.example.objectpass;

import android.app.Activity;
import android.os.Bundle;
import android.util.Log;
import android.widget.ArrayAdapter;
import android.widget.Spinner;
import android.widget.TextView;
import org.ksoap2.*;
import org.ksoap2.serialization.SoapObject;
import org.ksoap2.serialization.SoapSerializationEnvelope;
import org.ksoap2.transport.*;

public class MainActivity extends Activity {
    TextView resultA;
    Spinner spinnerC;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        String[] toSpinnerSum;
        toSpinnerSum = new String[9];

        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        spinnerC = (Spinner) findViewById(R.id.spinner1);
        resultA = (TextView) findViewById(R.id.textView2);
//
        final String NAMESPACE = "http://tempuri.org/";
        final String METHOD_NAME = "GetCustomerList";
        final String SOAP_ACTION = "http://tempuri.org/GetCustomerList";
        final String URL = "http://192.168.1.104/WebService4/Service1.asmx";

        SoapObject Request = new SoapObject(NAMESPACE, METHOD_NAME);
        SoapSerializationEnvelope soapEnvelope = new SoapSerializationEnvelope(
                SoapEnvelope.VER11);
        soapEnvelope.dotNet = true;
        soapEnvelope.setOutputSoapObject(Request);
        AndroidHttpTransport aht = new AndroidHttpTransport(URL);
        //
        try {
            aht.call(SOAP_ACTION, soapEnvelope);
            SoapObject response = (SoapObject) soapEnvelope.bodyIn;
            SoapObject add = (SoapObject) response.getProperty(0);

            String xyz=add.toString();

            resultA.setText(xyz);
            // GetCustomerListResponse{GetCustomerListResult=anyType{Vehicle=null;
            // }; }
            //
        } 
        catch (Exception e) {
            e.printStackTrace();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T07:16:45.113

您好我已尝试使用以下代码片段解析您的回复。这不是最终的答案，但它会解决你 95% 的问题。

```
SoapObject result;
    result = (SoapObject) envelope.bodyIn;

    JSONObject tempJsonObject = null;
    String input = result.toString();

    String temp = input.substring(
            input.indexOf("GetCustomerListResult") + 28, input.length() - 2);
    input = null;
    System.out.println("String temp::**" + temp);

    try {

        tempJsonObject = new JSONObject(temp);

        String tempVehicle = tempJsonObject.getString("Vehicle");

        if(tempVehicle!=null){

        String innerTempVehicle = tempJsonObject.toString();

        String temp2= innerTempVehicle.indexOf("anyType") + 28, input.length());
        Log.i("Content of temp2",temp2);

        JSONObject tempJsonObject1 = new JSONObject(temp2);

        String tempVehicleID = tempJsonObject1.getString("VehicleID");
        String tempVehicleType = tempJsonObject1.getString("VehicleType");
        String tempVehicleOwner = tempJsonObject1.getString("VehicleOwner");

        }else{

            Log.i("Vehicle Error","Response Null");

        } 
```

# php - 我有一个 Drupal 站点：我可以使用 Sass 预处理器吗？

> ID：14078634
> 
> 赞同：0
> 
> 时间：2012-12-29T04:13:37.767
> 
> 标签：php, sass, drupal

我读过使用预处理器编写 css3 代码是有史以来最好的事情，因为它们让你的生活更轻松。事实上，我读过很多关于一些非常酷的例子，这让我对使用 SASS 感到兴奋（我读过[它比 less 好](http://css-tricks.com/sass-vs-less/)）。

现在，当我深入了解如何安装并实际使用它时，我发现它可以与 Ruby 一起使用……我认为这意味着我不能按计划安装并使用它。

我有一个 Drupal 站点，我认为我可以像使用其他脚本一样将它安装在我的服务器中，然后开始使用 sass 进行编码，服务器将读取它并用普通的旧 css 编译它。哪个......它似乎不是那样工作的。

我发现有三个 Drupal 模块可以使 Sass 适应 Drupal：[Sass API](http://drupal.org/project/sass_api)、[Compass Stylesheet Tool](http://drupal.org/project/compass)、[Sassy](http://drupal.org/project/sassy)和[SASS/SCSS](http://drupal.org/project/sass)。

他们三个没有很多安装，所以这里没有“受欢迎的赢家”，他们三个似乎很适合这个任务，但因为这是我第一次打算使用预处理器，好吧...我完全不知道该做什么，什么是更好的选择（以及为什么）。

我的网站是一个drupal 6，我计划将它升级到Drupal 7。因为我需要创建一个新主题（它是一个自定义主题），我计划使用Omega 作为基本主题并将其与Sass 一起使用。 ..？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T13:36:12.417

我建议下载并安装官方的 SCSS 和 Compass 包。

这确实需要您安装 ruby​​，但仅限于您的开发机器上。

在将它们部署到服务器之前，您应该编译所有 SCSS 文件。

# php - 如何：跨子域的持久 PHP 会话

> ID：14078635
> 
> 赞同：7
> 
> 时间：2012-12-29T04:13:44.620
> 
> 标签：php, session, cookies

> **可能重复：**
> [PHP：Cookie 域/子域控制](https://stackoverflow.com/questions/348282/php-cookie-domain-subdomain-control)
> [允许 php 会话转移到子域](https://stackoverflow.com/questions/644920/allow-php-sessions-to-carry-over-to-subdomains)

### 重要信息

*   该网站由数百个子域“example.domain.com”组成
*   登录我网站的用户具有“记住我”功能
*   用户可以从任何子域登录（并且他们必须能够通过该会话浏览任何子域）

### 问题

*   目前，当用户通过一个子域连接时，其他子域无法识别他们的会话/cookie（无论他们是否选择了 cookie 选项）。

### 问题

*   必须做些什么才能使用户会话在 domain.com 的所有子域中持久存在？换句话说，我不希望用户必须登录每个子域。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T12:19:12.903

更改 php.ini：

```
session.cookie_domain = domain.com 
```

那么它将对所有子域有效。但这取决于同一服务器提供的所有子域。

如果它是多台服务器，那么您必须通过[NFS](http://de.wikipedia.org/wiki/Network_File_System)共享会话文件夹。或者您只为自动登录添加另一个 cookie，并为每个子域设置一个单独的会话。

[http://en.php.net/manual/en/function.setcookie.php#domain](http://en.php.net/manual/en/function.setcookie.php#domain)

但是您的自动登录 cookie 牢记安全。

# c - 在 R 代码中传递种子/设置种子/C

> ID：14078636
> 
> 赞同：6
> 
> 时间：2012-12-29T04:13:59.167
> 
> 标签：c, r

我在 R 代码中制作 C。

在我的 C 代码中，我使用 rand() 函数来生成随机数。R-ext.pdf 说我必须使用命令设置种子；

```
 GetRNGstate();
  PutRNGstate(); 
```

尽管我在上面使用这些命令，但对于同一个种子，我仍然得到不同的值。你能给我任何帮助吗？

最小的例子是：

在 C 中：

```
# include <R.h>
# include <Rinternals.h>
# include <Rmath.h>
# include <R_ext/Linpack.h> 

 SEXP example(){

   SEXP output;
   GetRNGstate();
   PROTECT(output = allocVector(INTSXP, 1));
   INTEGER(output)[0] = rand() % 50;
   PutRNGstate();
   UNPROTECT(1);
   return(output);
 } 
```

在 R 中：

```
dyn.load("example.so")
## The following codes return different values at ever run 
set.seed(1)
.Call("example") 
```

提前致谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-29T04:17:32.097

这是您的想法中的一个逻辑错误——您*正确*设置了种子，从代码中初始化了 R RNG ...但随后调用了**系统 RNG**而不是 R RNG。

替换`rand()`为`unif_rand()`（或`norm_rand()`），您应该已设置好。

[Rcpp](http://dirk.eddelbuettel.com/code/rcpp.html)使这一切变得更容易，并让您可以从各种分布函数中对绘图进行矢量化访问（但如果您愿意，当然也可以在 C 中手动完成所有这些操作）。

通过使用`cppFunction()`from [Rcpp](http://dirk.eddelbuettel.com/code/rcpp.html)，我们现在还负责`RNGScope`依次提供`GetRNGstate()`/ `PutRNGstate()`（虽然旧示例仍然显示 ; 的实例化，`RNGScope`添加它并没有什么害处，因为它相当于引用计数）。

所以定义、自动扩展、编译和加载它确实是一条线：

```
R> cppFunction("double myrand() { return norm_rand(); }")
R> for (i in 1:5) { set.seed(42); cat(i, " -- ", myrand(), "\n") }
1  --  1.37096 
2  --  1.37096 
3  --  1.37096 
4  --  1.37096 
5  --  1.37096 
R> 
```

而没有我们得到的重新播种

```
R> for (i in 1:5) { cat(i, " -- ", myrand(), "\n") }
1  --  -0.564698 
2  --  0.363128 
3  --  0.632863 
4  --  0.404268 
5  --  -0.106125 
R> 
```

最后，如果您*真的*想要，您当然可以继续使用`rand()`（但请参阅有关其糟糕性能的文献），然后使用**其播种功能**而不是 R 的。

# python - Google App Engine - 从 App Engine 助手升级

> ID：14078640
> 
> 赞同：0
> 
> 时间：2012-12-29T04:15:02.027
> 
> 标签：python, django, google-app-engine

我想在基于 Python 的 App-Engine 应用程序中删除对旧式 App Engine Helper for Django 的依赖项。同时，我想升级到Python2.7和Django1.4。我有几个关于升级过程的问题：

1) 新的 App Engine SDK（1.7.4 版）声明完全支持 Django。这是否意味着既不需要 App Engine Helper 也不需要 Django-norel 就可以让 Django 在 App Engine 上运行？

2) 假设我之前的问题的答案是不需要外部补丁/帮助程序，我很难找到基于新 SDK 的示例 App Engine/Django 应用程序。你知道我在哪里可以找到不依赖外部补丁/帮助程序的 Django/AppEngine 示例吗？（这将为我提供一个已知的良好起点，然后我可以将现有代码移植到其中）。

3) 目前我的数据库模型继承自 App Engine Helper 中提供的 BaseModel。为了不破坏我的网站，鉴于 BaseModel 将不再存在，这些模型应该继承什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T07:31:24.970

您可以将 Django 1.4 与 CloudSQL 一起使用。

如果您使用 HRD，则需要使用 django-nonrel（App Engine Helper 的继承者）。虽然 django-nonrel 有效，但目前文档有点缺乏。

# python - 在 GnuplotPy 中设置线型？

> ID：14078647
> 
> 赞同：6
> 
> 时间：2012-12-29T04:16:07.710
> 
> 标签：python, visualization, gnuplot, data-visualization

在 Gnuplot 中，`linetype`或`lt`标志允许用户选择[线条类型](https://stackoverflow.com/questions/2075283/choosing-line-type-and-color-in-gnuplot-4-0)（虚线、点线、实线等）。

我正在使用一个名为[Gnuplot-Py](http://gnuplot-py.sourceforge.net/)的 Python 包装器。这是一个例子：

```
import Gnuplot
data1 = [[3, 0.03], [4, 0.02], [5, 0.017]]
data2 = [[3, 0.027], [4, 0.015], [5, 0.014]]

gp = Gnuplot.Gnuplot(persist = 1)
gp('set terminal x11 size 350,225') 
gp('set pointsize 2')
gp('set yrange [0.0:0.05]')
plot1 = Gnuplot.PlotItems.Data(data1, with_="linespoints lt rgb 'black' lw 6 pt 1", title="data1")
plot2 = Gnuplot.PlotItems.Data(data2, with_="linespoints lt rgb 'blue' lw 6 pt 8", title="data2")
gp.plot(plot2, plot1)

epsFilename='testLines.eps'
gp.hardcopy(epsFilename, terminal = 'postscript', enhanced=1, color=1) #must come after plot() function
gp.reset() 
```

这是输出： ![在此处输入图像描述](../Images/c462cc2fddeaf365ac39f7481b3ea3ad.png)

* * *

正如您在上面的代码中看到的，`lt`(linetype) 在`Gnuplot.PlotItems.Data(..., with_=...)`命令中。在普通的 Gnuplot 中，我们只`lt 1`需要选择线型 1。但是，Gnuplot-Py 似乎随意选择线型（请注意，在上图中，一条线是实线，一条线是虚线）。让我们尝试几种在 Gnuplot-Py 中手动更改线型的策略...

**策略 1.**我尝试`lt 1`了而不是`lt`在`with_`字符串中。这会引发一个错误，但它仍然会产生与我们在上面看到的相同的图。

```
plot1 = Gnuplot.PlotItems.Data(data1, with_="linespoints lt 1 rgb 'black' lw 6 pt 1", title="data1") #returns the error `line 0: ';' expected 
```

**策略2。**我也尝试`lt`从`with_`字符串中删除。这会引发错误并忽略该`data1`行的格式（参见`data1`下面的绿线）。

```
plot1 = Gnuplot.PlotItems.Data(data1, with_="linespoints rgb 'black' lw 6 pt 1", title="data1") #returns the error `line 0: ';' expected 
```

![在此处输入图像描述](../Images/0325947330c970b5dd5f6d4d0f69dce2.png)

**策略 3.**如果我添加`gp('set style lt 1')`，我再次得到错误`line 0: expecting 'data', 'function', 'line', 'fill' or 'arrow'`，并且情节与上面显示的原始内容没有变化。

* * *

## **如何在 GnuplotPy 中手动选择线型？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T21:49:59.813

这有效：

```
with_="linespoints lt 1 lw 6 pt 1 linecolor rgb 'black'" #put this inside Gnuplot.PlotItems.Data() command 
```

在我原来的帖子中，我正在做`with_="linespoints lt rgb 'black' ..."`. 换句话说，我把`linespoints`和`linecolor`争论混在一起了。我不确定为什么即使我没有指定`linetype`.

无论如何，要点是我们需要这种类型的`with_`字符串设置：
`linespoints (args to linespoints) linecolor (args to linecolor)`

结果如下： ![在此处输入图像描述](../Images/14dd03baf9dee38a1615545117ca9f5d.png)

# javascript - document.getElementById() 总是返回 null

> ID：14078655
> 
> 赞同：1
> 
> 时间：2012-12-29T04:19:12.310
> 
> 标签：javascript, getelementbyid

我正在尝试使用 javascript 从我的 HTML 中的表单中获取隐藏输入的值。但是在尝试了几种不同的方法来获取值之后，它总是在控制台（萤火虫）中说变量为空..继承人的javascript：

```
var mcq_test = form.mcq_test.value;
console.log("mcqid=" + mcq_test)
var mcq_num_questions = form.mcq_num_questions.value;
console.log("totalquestions=" + mcq_num_questions)
var x = 1;
var send = [];
send.push("mcq_test=");
send.push(mcq_test);

console.log("Send: " + send);

// have commented out the bits below...just go through them carefully looking at the string functions, put them in the send += (SRING 1 + STRING 2 + ...) format

for (var x = 1; x <= mcq_num_questions; x++) {
var questionidd = "mcq_question_id";
console.log("1 = " + questionidd);
var questionid = questionidd.concat(x); // mcq_question_id$ctr the question numer
console.log("2 = " + questionid);
var mcqid = form.questionid.value; // the questions id on db
console.log("3 = " + mcqid);
var answerr = "mcq_question";
var answer = answerr.concat(x); // mcq_question$ctr the questions chosen answer
var chosenanswer = form.answer.value; // the answers value
console.log("4 = " + chosenanswer);
var amp = "&";
var equal = "=";
var questionide = questionid.concat(equal); // "mcq_question_id$ctr="
var questionida = amp.concat(questionide); // "&mcq_question_id$ctr="
var answere = amp.concat(answer,equal); // "&mcq_question$ctr="
if (x = 1) { send.push(questionide, mcqid, answere, chosenanswer); }
else {
send.push(questionida, mcqid, answere, chosenanswer);
}
} 
```

安慰：

```
[04:08:00.328] TypeError: questionID is null 
[04:08:00.327] My new function
[04:08:00.327] mcqid=566
[04:08:00.327] totalquestions=3
[04:08:00.327] Send: mcq_test=,566
[04:08:00.328] 1 = mcq_question_id
[04:08:00.328] 2 = mcq_question_id1 
```

形式：

```
echo"<input type=\"hidden\" name=\"mcq_question_id$ctr\" id=\"mcq_question_id$ctr\" value=\"$questionID\" form=\"SubmitTest\" />"; 
```

- 更新

找到答案了！事实证明，您不能使用语法 document.getElementByID() 或 form.variable.value; 并在那里放一个变量，它必须是一个字符串或这样写：

```
form[variable].value; 
```

我没有找到 getElementById 的等价物，但 form 方法对我有用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T04:41:47.247

使用这个时

```
echo"<input type=\"hidden\" name=\"mcq_question_id$ctr\" id=\"mcq_question_id$ctr\" value=\"$questionID\" form=\"SubmitTest\" />"; 
```

在创建输入类型之前，请确保您的“$questionID”不为空

使用这个然后测试

```
echo"<input type=\"hidden\" name=\"mcq_question_id$ctr\" id=\"mcq_question_id$ctr\" value=\"questions\" form=\"SubmitTest\" />"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T04:20:50.193

在尝试访问之前，您需要确保 DOM 已加载。将 Javascript 放在 HTML 之后或设置事件以触发变量定义。

# ubuntu - 如何在命令行中呈现 UTF-16BE？

> ID：14078659
> 
> 赞同：0
> 
> 时间：2012-12-29T04:19:39.907
> 
> 标签：ubuntu, unicode, sed, command-line-interface

我经常遇到一个表示 UTF-16BE 的字符串，例如`\u0444\u0430\u0439\u043b`，它会被正确地呈现为`файл`.

我想知道：是否有一种简单的方法可以使用 sed 或其他命令行工具以 UTF-16BE（或只是 UTF-16BE 中的输入字符串）“呈现”文本文件，例如上面的那个？

另请参阅[此相关问题](https://stackoverflow.com/questions/14078628/how-can-i-render-percent-encoding-in-command-line)。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T04:42:28.387

假设文本实际上是用 UTF-16BE 编码的（而不是像您在问题中显示的那样，作为包含反斜杠和`'u'`字符的 ASCII 字符串），您可以使用该`iconv`命令。

假设您的语言环境设置为处理 UTF-8 输出：

```
iconv -f utf-16be -t utf-8 [input-file] 
```

**编辑 ：**

根据您的评论，您所拥有的根本不是 UTF-16BE；它显然是纯 ASCII，使用`\u....`语法对 Unicode 代码点进行编码。这不是一种可以`iconv`识别的格式（据我所知）。

您应该编辑您的问题，删除对 UTF-16BE 的任何引用，并更准确地解释您实际拥有的数据以及您想用它做什么。这些字符串是从哪里来的？它们是存储在文本文件中，还是来自其他来源（例如，某个程序的输出）？输入*是完全*由组成`\u....`，还是与其他数据混合？您的语言环境设置是否配置为正确显示 UTF-8？

如果您有一个包含`"\u0444\u0430\u0439\u043b"`（即 24 个 ASCII 字符）的字符串，那么该`printf`命令应该可以工作——*如果*您使用的是足够新的`printf`.

`printf`既是 shell 内置命令又是外部命令，`/usr/bin/printf`是 GNU coreutils 包的一部分。

以下适用于我的系统：

```
$ s='\u0444\u0430\u0439\u043b'
$ printf "$s\n"
файл 
```

或者您可以使用`%b`格式（这是特定于`printf`命令的；C 的`printf()`函数不这样做），它解释参数字符串中的反斜杠转义（通常它们只在格式字符串中解释）：

```
$ printf "%b\n" "$s"
файл 
```

在另一个系统上，使用旧版本的 bash，`printf`内置函数无法识别`\u`转义 - 但`/usr/bin/printf`可以。看来 coreutils`printf`命令`\u`比 bash 更早地获得了对转义的支持。

```
$ s='\u0444\u0430\u0439\u043b'
$ printf "$s\n"
\u0444\u0430\u0439\u043b
$ printf "%b\n" "$s"
\u0444\u0430\u0439\u043b
$ /usr/bin/printf "$s\n"
файл
$ /usr/bin/printf "%b\n" "$s"
файл 
```

所有这些都假设您`'\u0444\u0430\u0439\u043b'`在变量中有字符串。如果它在一个文件中，您*可以*将文件内容放入一个 shell 变量中，一次可能是一行，但这不是最好的解决方案。在这种情况下，这个 Perl 脚本应该可以完成这项工作；它将其输入复制到标准输出，用`\u....`相应的 Unicode 字符替换序列，以 UTF-8 编码；输入可以是在命令行中命名的一个或多个文件，也可以是标准输入（如果调用时不带参数）。

```
#!/usr/bin/perl

use strict;
use warnings;

use utf8;
binmode(STDOUT, ":utf8");

while (<>) {
    s/\\u([\da-fA-F]{4})/chr(hex($1))/eg;
    print;
} 
```

再次，*请*编辑您的问题，使其反映您的实际问题并删除对 UTF-16BE 的任何引用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T04:25:02.217

只需这样做：

```
echo -e "\u0444\u0430\u0439\u043b" 
```

请注意，您可能需要将 env 变量设置`LANG`为`utf-8`：

```
export LANG="en_US.UTF-8" 
```

`printf`正如 Keith Thompson 所指出的，使用;可能会更好。所以，你有：

```
printf "\u0444\u0430\u0439\u043b" 
```

对于上述两个选项，输出为：

```
файл 
```

# ios - Cocos2D 手指手势无限滚动

> ID：14078661
> 
> 赞同：1
> 
> 时间：2012-12-29T04:19:55.807
> 
> 标签：ios, cocos2d-iphone, scroll

我可以用手指手势（不是视差）无限地向左或向右滚动吗？目前我正在使用 CCCamera，但似乎它不足以满足我的需要..

有什么例子吗？

```
_________________________________

  1  |  2   |  3   |  4   |  1  |   
_________________________________ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T11:13:48.313

阅读我[关于使用 cocos2d 滚动的文章](http://www.learn-cocos2d.com/2012/12/ways-scrolling-cocos2d-explained/)。**具体来说，除非绝对必要**，否则不要使用 CCCamera 。文章解释了为什么以及这些原因是什么。

# php - zend 更新语句，不更新数据库行

> ID：14078677
> 
> 赞同：4
> 
> 时间：2012-12-29T04:22:40.177
> 
> 标签：php, mysql, zend-framework

这是我的代码

```
$id = $this->user->id;
$data['last_cust_code']     = $a_Search['custcode'];
$data['last_paid_filter']   = $a_Search['paid'];
$data['last_unpd_filter']   = $a_Search['unpaid'];
$data['last_group_field']   = $a_Search['grouping'];
$data['last_session_code']  = $a_Search['session'];
$out = $objDb->update('tblusrusers', $data,array("id = ?"=>$id)); 
```

探查器输出

```
UPDATE `tblusrusers` SET `last_cust_code` = ?, `last_paid_filter` = ?, `last_unpd_filter` = ?, `last_group_field` = ?, `last_session_code` = ? WHERE (id = '70')

Array
(
    [1] => TESTAAA
    [2] => N
    [3] => N
    [4] => 1
    [5] => 19993E
) 
```

当我直接通过mysql客户端更新时，它的更新正确。

重要提示：当我通过查询选择输出时，我可以看到更新，但不能通过 phpmyadmin.does 它与提交语句有关，我的意思是我的自动提交是错误的吗？对于其他一些使用事务的查询将它会影响我上面的更新查询吗？请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T13:31:01.380

实际上问题是我的生产团队中的某个人只是放了一个`$objDb->beginTransaction()` 但没有提交使用`$objDb->commit()`，这导致mysql数据库自动提交为false（bcoz开始的事务语句将自动提交设置为false）因此所有其他查询都不起作用，因为提交没有发生.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T05:19:54.113

我从未使用过 Zend，但我认为您的数据数组应该是

```
$data = array('last_cust_code' => $a_Search['custcode'],
             'last_paid_filter' => $a_Search['paid'],
             'last_unpd_filter' => $a_Search['unpaid'],
             'last_group_field' => $a_Search['grouping'],
             'last_session_code' => $a_Search['session'] ); 
```

# android - 如何在加载新请求之前完全重置 Android webview

> ID：14078680
> 
> 赞同：4
> 
> 时间：2012-12-29T04:23:31.087
> 
> 标签：android, webview

我正在使用**Android WebView**加载一些网页。就我而言，我必须在加载网页之前插入一些 JavaScript 代码。就像下面这样：

```
//enable javascript
mWebView.getSettings().setJavaScriptEnabled(true);

//inject my js first. 
//I can't inject the js onPageStarted() or onPageFinished() because I need to make  sure the js
//is injected before html loaded.
mWebView.loadUrl("javascript:MyJsCode"); 

//load HTML      
mWebView.loadUrl("http://example.com/demos/index.html"); 
```

该代码第一次运行良好，但多次运行时失败。因为 HTML 找不到我的 JS。

我认为因为之前的 HTML 不完全清楚，所以`mWebView.loadUrl("javascript:MyJsCode")`将 MyJsCode 注入到之前的 HTML 而不是新的 HTML。

所以我想如果我可以完全重置`WebView(to clear the previous HTML)`，将解决我的问题。

我试过`WebView.ClearView(), loadUrl("about:blank")`了，它们都不起作用。

有人建议吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-26T12:57:10.723

虽然这有点晚了，但我提供以下内容。也许它可能会有所帮助。. .

您的问题没有具体提到在 中使用任何回调`WebChromeClient`，但您确实提到了 JS，因此以下内容可能会有所帮助。在 SDK 级别 16 及以下，您可以使用回调而无需专门“清除”它们。但是，从 SDK 级别 17 开始，我观察到您必须采取行动来清除事件——特别是，如果您覆盖它`alert()`，这当然会导致在`onJSAlert()`您的事件中被触发。`WebChromeClient`在我测试过的 SDK 级别 16 及以下的所有设备中，您可以愉快地忽略回调，一切都会按计划进行。

但是，您会注意到`onJSAlert`，当被覆盖时，会在最后一个参数中传递一个`JSResult`对象，因此：

> **boolean** onJsAlert( **WebView** view, **String** url, **String** message, **JsResult**结果)

我观察到 JsResult 对象有两个公开的方法，因此：

> *公共方法*
> 
> **最终无效** 取消（）
> 
> > ```
> > Handle the result if the user cancelled the dialog. 
> > ```
> 
> **最终无效** 确认（）
> 
> > ```
> > Handle a confirmation response from the user 
> > ```

假设在回调中返回**true**（表示回调消耗了 onJsAlert 事件），并假设您使用的是 SDK 16 或之前的版本，那么`WebView.destroy()`将执行预期的操作。

但是，我观察到 SDK 17 (4.2.x) 似乎需要进一步证明回调确实处理了事件。未能调用`result.cancel()`or `result.confirm()`，将使您的`WebView`（或者，更重要的是，`WebViewCore`）永久卡住。我尝试过的任何事情都不会重新唤醒，并且此后，`WebViewCore`任何**新的**或其他的都不会加载任何内容。（尝试解释：只是 的包装类，它反过来检测一个对象。是最后一个人 ，完成所有工作。通过浏览源代码和反射，您可以钻入该对象，如果您愿意这样做。 是一个，因此，正好有一个`WebView`**`WebView``WebViewProvider``WebViewCore``WebViewCore``WebViewCore``static``WebViewCore`为您的整个应用程序。因此，如果您唯一的 WebViewCore 卡住了，那么`WebView`您的应用程序中的 no 将在此后工作。一旦它被卡住等待，例如，一个`JSResult`方法被调用，它会一直卡住，直到应用程序被销毁（即，即使暂停/恢复应用程序的效果为零）。即使直接调用`destroy()`，`WebViewCore`通过反射获得的访问也是无效的。NB 调用`destroy()`the具有调用the`WebView`的副作用，但这也无济于事）。`destroy()``WebViewCore`**

 **所以，症状就是

1.  你创建一个`WebView`
2.  一些聪明的 JS 运行，可能调用*alert()*
3.  您在覆盖方法中处理*alert()*`onJsAlert`
4.  你没有打电话`result.confirm()`或`result.cancel()`
5.  你毁了`WebView`
6.  此后，`WebView`您的应用程序中的 no 将加载任何内容。

好消息是，如果您确定通过调用适当的 JsResult 方法来“清除”您覆盖的任何回调中的事件，那么`WebViewCore`不会永久停止，您的应用程序会很高兴。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-11T07:08:19.320

我认为除了重新新建一个 WebView 之外没有办法做到这一点。**

# javascript - 优化 javascript 代码以使用整数运算

> ID：14078684
> 
> 赞同：9
> 
> 时间：2012-12-29T04:25:06.803
> 
> 标签：javascript, floating-point, integer-arithmetic

在假设“非常好”意味着最小化浮点算术运算量以支持整数算术的假设下，有些算法“非常好”地解决了问题。以[Bresenham 的线条算法](http://en.wikipedia.org/wiki/Bresenham%27s_line_algorithm)为例，该算法用于确定要填充哪些像素以便在画布上绘制线条：这个人实际上只用一些简单的整数运算就可以完成整个过程。

这种事情在很多情况下显然是好的。但是，在 javascript 中需要大量浮点数学运算的操作值得烦恼吗？据我所知，就语言规范而言，一切几乎都是十进制数。我想知道尝试将事物*尽可能*保持为整数是否值得 - 浏览器是否进行了可以使其值得的优化？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-05-26T21:43:45.780

您可以在 javascript 中使用 Int8、Uint8、Int16 等，但它需要比平常更多的努力 - 请参阅[TypedArrays](http://www.html5rocks.com/en/tutorials/webgl/typed_arrays/)。

```
var A = new Uint32Array(new ArrayBuffer(4*n));
var B = new Uint32Array(new ArrayBuffer(4*n));

//assign some example values to A
for(var i=0;i<n;i++)
  A[i] = i; //note RHS is implicitly converted to uint32

//assign some example values to B
for(var i=0;i<n;i++)
  B[i] = 4*i+3;  //again, note RHS is implicitly converted to uint32   

//this is true integer arithmetic
for(var i=0;i<n;i++)
  A[i] += B[i]; 
```

最近，[asm.js](http://asmjs.org/)项目使得将 C/C++ 代码编译为外观奇特的 javascript 成为可能，该 javascript 以一种相当极端的方式使用这些 TypedArrays，好处是您可以使用现有的 C/C++ 代码并且它应该运行得很好在浏览器中快速（特别是如果浏览器供应商对此类代码实施了特殊优化，这应该很快就会发生）。

附带说明*，如果您的程序可以执行 SIMD 并行性（参见 wikipeda），即如果您的代码使用 SSEx 指令集，您的算术将快得多，实际上使用 int8s 的速度将是使用 int16s 等的两倍。

*我认为这与浏览器无关，因为它们太难即时利用。*编辑：*事实证明，Firefox 正在尝试这种优化。Dart（真正的 Dart，不是编译为 js 的 Dart）也可以在 Chrome 中执行此操作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-29T04:29:31.643

很久以前，计算机缺乏专用的 FPU，并且完全通过软件仿真来进行浮点数学运算。

现代计算机都有专门的 FPU 来处理浮点数学和整数。除非您有非常具体的情况，否则您无需担心。

* * *

## 回答 #3

> 赞同：-5
> 
> 时间：2012-12-29T04:28:37.917

实际上，它并没有什么不同。JavaScript 没有“整数”的概念。JS 只使用双精度浮点数，它可能是也可能不是整数。

因此，将自己限制为整数绝对不会在性能方面获得任何好处。

但是，请记住，整数将精确到 2 ^(51)，而非整数很容易遭受精度损失（例如：0.1），因此您可能会因此而受益。

# c# - 在类本身中获取类名

> ID：14078696
> 
> 赞同：3
> 
> 时间：2012-12-29T04:28:22.833
> 
> 标签：c#

> **可能重复：**
> [C# 获得自己的类名](https://stackoverflow.com/questions/2113069/c-sharp-getting-its-own-class-name)

对于 Visual Studio，我想创建一个类模板并使用一个包含类本身名称的字符串字段。是否可以？

例如：

```
public class MyClass
{
     public string TAG = GetClassName(this);
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-29T04:30:28.793

在谈论非静态方法时，使用[Object.GetType 方法返回实例的确切运行时类型（对](http://msdn.microsoft.com/en-us/library/system.object.gettype.aspx)[Type Class](http://msdn.microsoft.com/en-us/library/42892f65.aspx)实例的引用）：

```
this.GetType().Name 
```

在谈论静态方法时，请使用[MethodBase 类](http://msdn.microsoft.com/en-us/library/system.reflection.methodbase.aspx)及其[GetCurrentMethod 方法](http://msdn.microsoft.com/en-us/library/system.reflection.methodbase.getcurrentmethod.aspx)：

```
Type t = MethodBase.GetCurrentMethod().DeclaringType;
//t.Name 
```

但是，有关此内容的更多信息，请参阅[SO 上的这篇文章。](https://stackoverflow.com/questions/2081612/net-determine-the-type-of-this-class-in-its-static-method)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T04:30:28.550

```
public string GetClassName(object item)
{
  return typeof(item).Name;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T04:30:59.207

尝试以下操作：

```
this.GetType().Name 
```

[Type.Name](http://msdn.microsoft.com/en-us/library/system.reflection.memberinfo.name.aspx) -> 获取当前成员的名称。

# android - 改变android中线性布局的宽度

> ID：14078699
> 
> 赞同：5
> 
> 时间：2012-12-29T04:29:16.087
> 
> 标签：android, android-layout

我有一个列表视图的这个 xml 布局：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android" android:id="@+id/menu"
android:orientation="vertical" android:background="#2f4f4f" android:layout_width="wrap_content" android:layout_height="fill_parent">

  <ListView android:id="@+id/list" android:layout_width="fill_parent" android:layout_height="wrap_content"
    android:background="#2f4f4f" android:cacheColorHint="#2f4f4f" android:scrollbars="none">
  </ListView>
</LinearLayout> 
```

线性布局默认占据全屏宽度。

![在此处输入图像描述](../Images/98d66b85b30f2073c602d71542a00476.png)

我想以编程方式更改它。我想做这样的事情：

![在此处输入图像描述](../Images/ac6a25c2ce0211264c8835434528b767.png)

但是当我改变线性布局的宽度时没有任何反应，它仍然占据全屏宽度

```
 LayoutInflater inflater = LayoutInflater.from(this);
 View menu = inflater.inflate(R.layout.xml_layout, null);
 menu.setLayoutParams(new LayoutParams(20,LayoutParams.WRAP_CONTENT)); 
```

在列表视图中硬编码布局宽度后：

```
 <ListView
  android:id="@+id/list"
  android:layout_width="200dp"
  android:layout_height="wrap_content"
  android:background="#2f4f4f"
  android:cacheColorHint="#2f4f4f"
  android:scrollbars="none" >

</ListView> 
```

我明白了：

![在此处输入图像描述](../Images/98b95526b5e06fb383d85a618dc03408.png)

请提出一种方法来做到这一点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T04:37:25.150

在列表视图中进行如下所示的更改，**在 XML 中对布局宽度进行硬编码。**

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android" 
android:layout_width="fill_parent"
android:layout_height="fill_parent" 
android:orientation="vertical" android:background="@android:color/white">

<ListView
    android:id="@+id/list"
    android:layout_width="200dp"
    android:layout_height="wrap_content"
    android:background="#2f4f4f"   >

</ListView>

</LinearLayout> 
```

您**在线性布局**和**listview fill_parent**中进行 Wrap_content ，因此 linearlayout 正在包装 listview 即全屏。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T06:49:50.497

如果您希望它适合多种屏幕尺寸，我建议添加一个空布局并使用权重。

像这样：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android" 
android:layout_width="match_parent"
android:layout_height="match_parent" 
android:orientation="horizontal" android:background="@android:color/white">

<ListView
    android:id="@+id/list"
    android:layout_width="0dp"
    android:layout_height="wrap_content"
    android:layout_weight="3"
    android:background="#2f4f4f"   >

</ListView>

<LinearLayout android:layout_width="0dp"
android:layout_height="fill_parent" 
android:layout_weight="1"
android:orientation="horizontal" android:background="@android:color/white">

</LinearLayout> 
```

我只是盯着重量。将它们调整到您需要的宽度。如果您这样做，那么您将不必为每个屏幕尺寸硬编码尺寸。

# javascript - JQuery：将 div 附加到一个 var 类

> ID：14078700
> 
> 赞同：0
> 
> 时间：2012-12-29T04:29:17.170
> 
> 标签：javascript, jquery, jquery-append

我有一行将新的 div 附加到现有的 div 上。但是我也想向新的 div 添加一个类。类的名称实际上保存在一个 var 中。

我只是不确定这个的语法 - 有人能指出我正确的方向吗？

```
 var itemclass = "myclass";

 $('#wrapper').append('<div class="itemclass"></div>'); 
```

到目前为止，我已经尝试过：

```
 $('#wrapper').append('<div class=" . itemclass . "></div>');

 $('#wrapper').append('<div class=" & itemclass & "></div>'); 
```

没有效果...任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T04:31:59.950

您正在连接一个字符串，它的完成方式如下：

```
$('#wrapper').append('<div class="' + itemclass + '"></div>'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T04:31:44.267

JS 使用 + 来连接项目，如下所示：

```
 $('#wrapper').append('<div class="' + itemclass + '"></div>'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T04:31:57.457

连接是 javascript 中的 + 号，而不是 PHP 中的句点

# objective-c - 在 Objective C 中，我应该在哪里放置一个全局效用函数？

> ID：14078702
> 
> 赞同：19
> 
> 时间：2012-12-29T04:29:33.270
> 
> 标签：objective-c, ios, xcode, cocoa

在编写 iOS 应用程序时，我应该在哪里放置我打算从任何其他文件中使用的函数？

例如，将 NSDate 转换为相对时间字符串（“5 secs ago”）的函数。我会创建一个类并使这些功能全部静态吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-12-29T05:05:34.280

函数可以放在任何方便的地方。如果一个函数或一组函数可能在很多地方被导入，您可以在它们自己的 .h/.m 对中声明和实现它们。因此，例如，您可以在名为**XYZDateUtilities.m的文件中实现日期转换函数，并在****XYZDateUtilities.h**中声明它。

用限定符声明函数`static`会将它们的范围限制在声明它们的文件中，所以你不想这样做；事实上，你想做相反的事情——`extern`在 .h 文件中声明它们，以便它们在其他文件中可见。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-12-29T04:44:20.330

你有几个选择：

1）如果您正在扩展类的行为（例如您描述的 NSDate 字符串转换方法），最好在所述类上简单地创建一个类别。

这是一个关于iOS类别的教程：

[http://mobile.tutsplus.com/tutorials/iphone/objective-c-categories/](http://mobile.tutsplus.com/tutorials/iphone/objective-c-categories/)

**重要的提示：**

*无论您是否在另一个特定类的导入中包含头 (.h) 文件，类别都会*在项目中的任何地方更改类的行为（如果您覆盖方法）

 *出于这个原因，通常最好*不要*通过类别覆盖方法，而是如果您想更改某些方法，则创建一个子类。

但是，对于添加新方法，类别可能非常方便和有用。

2) 如果您想创建一个在任何地方都导入的新类，您可以创建该类并将其头导入，即`#import "MyClass.h"`，放入您的项目`prefix.pch`文件中（默认在项目中的“支持文件”组下找到）。

您放入`prefix.pch`文件中的任何内容都将在您的应用程序中的任何位置可用。这也是放置常量（例如字符串）或定义在应用程序内的许多类中使用的枚举的有用位置。

我希望这有帮助。让我知道是否需要进一步澄清，我会尽力提供帮助。

干杯!

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-05-20T00:43:00.750

另一种选择是为您的辅助方法创建一个类并将所有辅助方法实现为类方法。

例如**HelperClass.h**

```
+ (NSString *)getFrenchCapital 
```

例如**HelperClass.m**

```
+ (NSString *)getFrenchCapital
{
    return @"Paris";
} 
```

然后在需要的地方导入你的帮助类，并简单地调用类方法：

例如**Foo.m**

```
#import "HelperClass.h"

...

- (void)logFrenchCapital
{
    NSLog(@"Capital of France: %@", [HelperClass getFrenchCapital]);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-29T04:35:00.360

如果您在一个类中将所有函数设为静态，那么替代方法是在 .m 文件中定义函数，在 .h 文件中定义外部函数，就像您在 C 中所做的那样。*

# ios - 何时使用 viewDidLoad 以及何时使用 awakeFromNib

> ID：14078708
> 
> 赞同：10
> 
> 时间：2012-12-29T04:30:52.810
> 
> 标签：ios, xcode, ios6

我已经很习惯使用 viewDidLoad 方法来执行我想要在视图开始时完成的事情，但是阅读 Apple 的教程之一，他们在 awakeFromNib 方法中为类设置了数据控制器，而在 awakeFromNib 中什么也没做。我交换了它，它似乎在我的应用程序中工作相同，但我不确定将它放在 awakeFromNib 或 viewDidLoad 中是否更好。

我什么时候应该使用其中之一？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-29T04:34:31.450

`awakeFromNib`当与类关联的 nib 文件被加载时调用。任何可以拥有 nib 的班级都可以使用它。`viewDidLoad`仅由视图控制器使用。它通常在从 nib 加载时调用，但也可以由在内存中创建的视图调用（非常罕见的情况。）。如果您使用的是控制器，那么我建议您使用`viewDidLoad`

有关更多信息，请参阅此[答案](https://stackoverflow.com/a/6455350/1887603)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-03T20:15:07.210

viewDidLoad 与视图控制器相关联。如果您需要初始化从 nib 未归档的另一个控件（例如 UITableViewCell 原型），您不能重载 viewDidLoad，您需要重载 awakeFromNib。

# php - 在 php 中使用 header 传递值

> ID：14078713
> 
> 赞同：0
> 
> 时间：2012-12-29T04:32:20.517
> 
> 标签：php

1.php

```
<?php

header( 'Location: 4.php?$x=1&y=2&z=3' );

?> 
```

发送 x ,y ,z 的值

4.php

```
<?php
 print '<pre>';
$a= $_GET ;
echo $a[x];
print '</pre>';

?> 
```

当我们调用 1.php 它被重定向到 4.php
它显示 x 的值正确但它给出了错误

> 注意：使用未定义的常量 x - 在第 6 行的 C:\wamp\www\4.php 中假定为“x”

为什么它给出错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T04:34:00.420

又是常见的bug...

```
echo $a[x]; 
```

应该

```
echo $a['$x']; 
```

在 中`echo $a[x];`，x 被视为（所谓的）“裸字符串”，PHP 将寻找一个名为 的常量`x`，该常量不存在。

另一方面，您需要获取超全局中的`$x`密钥，该密钥`$_GET`由 PHP 从您的 URL 填充。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T04:35:04.847

你需要这个：

```
echo $a['$x'] 
```

请注意，您正在传入`$x`查询字符串。确保您使用适当的字符串键`$_GET`，或`$a`在您的情况下。

# r - 如何在聚合中获得相同的结果？

> ID：14078714
> 
> 赞同：-1
> 
> 时间：2012-12-29T04:32:27.840
> 
> 标签：r

我怎样才能得到汇总的结果？

```
x=iris[,1:4]
transform(x,"sum"=apply(x,MARGIN=1,FUN=sum)) 
```

输出是：

```
 Sepal.Length Sepal.Width Petal.Length Petal.Width  sum
1            5.1         3.5          1.4         0.2 10.2
2            4.9         3.0          1.4         0.2  9.5
3            4.7         3.2          1.3         0.2  9.4
4            4.6         3.1          1.5         0.2  9.4 
```

（省略了很多行），我只是想更好地了解聚合，也许很难得到与聚合函数应用相同的结果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T05:13:18.187

您的问题似乎与我期望遵循的代码有所不同。`aggregate`旨在将特定功能“应用”到列，但仅限于由“by”参数划分的类别内。它旨在“在特定类别中聚合。

`apply`（其第二个参数设置为 2 而不是您的代码中的 1）将在整个列上使用一个函数。没有分组变量。您的编码器正在逐行运行具有不同含义和导入的向量，因此它返回每个人的四个不同测量值的单独总和，除非已经建立了该过程的一些准备或基础，否则这个过程可以说是毫无意义的。

如果您想以类似于聚合实现的方式使用应用，请查看以下内容：

```
> sapply( split(iris[,1:4], iris[, 5]), apply, 2, sum)
             setosa versicolor virginica
Sepal.Length  250.3      296.8     329.4
Sepal.Width   171.4      138.5     148.7
Petal.Length   73.1      213.0     277.6
Petal.Width    12.3       66.3     101.3

> aggregate(iris[ ,1: 4], iris[5], FUN=sum)
     Species Sepal.Length Sepal.Width Petal.Length Petal.Width
1     setosa        250.3       171.4         73.1        12.3
2 versicolor        296.8       138.5        213.0        66.3
3  virginica        329.4       148.7        277.6       101.3 
```

如果您的目标不是进行任何按类别计算，您将传递一个与数据帧的行数相同长度的列表：

```
> aggregate(iris[ ,1: 4], list(rep(1,nrow(iris))),  FUN=sum)
  Group.1 Sepal.Length Sepal.Width Petal.Length Petal.Width
1       1        876.5       458.6        563.7       179.9
> apply(iris[1:4], 2, sum)
Sepal.Length  Sepal.Width Petal.Length  Petal.Width 
       876.5        458.6        563.7        179.9 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T05:21:13.353

如果 Rubens 是正确的，并且您想使用`apply`而不是`aggregate`，并且您对与`aggregate`今天之前的帖子中相同的表达式感兴趣，那么您可以使用`tapply`.

[～总之是什么意思？](https://stackoverflow.com/questions/14078591/what-is-the-meaning-of-in-aggregate)

```
x=iris[,1:4]
names(x)<-c("x1","x2","x3","x4")
aggregate(x1+x2+x3+x4~x1,FUN=sum,data=x)
tapply((x$x1 + x$x2 + x$x3 + x$x4), x$x1, sum) 
```

编辑以添加`sapply`和`lapply`修改 DWin 的答案，以给出与上面相同的答案`tapply`， `aggregate`以及`rapply`,`vapply`和重新格式化`tapply`的`by`函数：

```
with(x, sapply(split((x1 + x2 + x3 + x4), x1), sum))
with(x, lapply(split((x1 + x2 + x3 + x4), x1), sum))
with(x, rapply(split((x1 + x2 + x3 + x4), x1), sum))
with(x, tapply(      (x1 + x2 + x3 + x4), x1 , sum))
with(x, vapply(split((x1 + x2 + x3 + x4), x1), sum, FUN.VALUE=1))
with(x, by((x1 + x2 + x3 + x4), x1, sum)) 
```

我还没有想出如何得到相同的答案`mapply`。好吧，这是一种方法，但它非常愚蠢：

```
tapply(mapply(sum, x$x1 , x$x2 , x$x3 , x$x4), x$x1, sum) 
```

最后，这是一种使用`apply`(inside `tapply`) 获得与上面其他行给出的相同答案的方法：

```
tapply(apply((x[,1:4]),1,sum),x$x1,sum) 
```

最后一件事，如果您确实想`aggregate`返回与帖子中声明相同的答案`apply`，这是可能的。但是，您所做的只是将每个单独的行与您的`apply`语句相加。因此，您将不得不“欺骗”`aggregate`认为 Iris 数据集中的每一行都有一个单独的组，如下所示：

```
x=iris[,1:4]
names(x)<-c("x1","x2","x3","x4")
apply.sums <- transform(x,"sum"=apply(x,MARGIN=1,FUN=sum))
my.factor <- seq(1, nrow(x))
ag.sums <- aggregate(x1+x2+x3+x4~my.factor,FUN=sum,data=x)
round(ag.sums[,2],2) == round(apply.sums[,5],2) 
```

# php - 浮点数验证检查 codeigniter

> ID：14078715
> 
> 赞同：3
> 
> 时间：2012-12-29T04:32:31.253
> 
> 标签：php, codeigniter, validation, numbers

在这里，我以 % 输入税收字段，但是当我输入 2.5,0.5 之类的值而不是整数时，它会产生错误。这是我的验证代码，输入浮点数的任何想法

 ````
function _set_rules()
{
  $this->form_validation->set_rules('pst','PST','trim|required|is_natural|numeric|
   max_length[4]|callback_max_pst');
  $this->form_validation->set_rules('gst','GST','trim|required|is_natural|numeric|
max_length[4]|callback_max_gst');
}
function max_pst()
 {
   if($this->input->post('pst')>100)
    {
      $this->form_validation->set_message('max_pst',' %s Value Should be less than or equals to 100');
return FALSE;
    }
   return TRUE;
  }
function max_gst()
  {
    if($this->input->post('gst')>100)
      {
    $this->form_validation->set_message('max_gst',' %s Value Should be less than or equals to 100');
    return FALSE;
    }
   return TRUE;
  }
</code> 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-12-29T04:57:11.837

从验证规则中删除并将`is_natural`其替换为`greater_than[0]`and`less_than[100]`

```
function _set_rules()
{
  $this->form_validation>set_rules('pst','PST','trim|required|
  greater_than[0]|less_than[100]|max_length[4]|callback_max_pst');
  $this->form_validation->set_rules('gst','GST','trim|required|
  greater_than[0]|less_than[100]|max_length[4]|callback_max_gst');
} 
```

`greater_than[0]`将应用`numeric`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-29T04:50:54.060

从 codeigniter 文档中：

> [is_natural](http://ellislab.com/codeigniter/user-guide/libraries/form_validation.html)如果表单元素包含自然数以外的任何内容，则返回 FALSE：0、1、2、3 等。

显然，像 2.5,0.5 这样的值不是自然数，因此它们将无法通过验证。`floatval()`您可以使用回调并在使用PHP 函数解析值后返回值。

希望能帮助到你！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-29T04:51:29.917

你可以试试这个：

```
function _set_rules()
{
  $this->form_validation>set_rules('pst','PST','trim|required|
  numeric|max_length[4]|callback_max_pst');
  $this->form_validation->set_rules('gst','GST','trim|required|
  numeric|max_length[4]|callback_max_gst');
}

function max_pst($value) {
    $var = explode(".", $value);
    if (strpbrk($value, '-') && strlen($value) > 1) {
        $this->form_validation->set_message('max_pst', '%s accepts only 
        positive values');
        return false;
    }
    if ($var[1] > 99) {
        $this->form_validation->set_message('max_pst', 'Enter value in 
        proper format');
        return false;
    } else {
        return true;
    }
} 
```

希望这段代码对您有所帮助.... :)`

# verilog - 如何构建模块链？

> ID：14078716
> 
> 赞同：1
> 
> 时间：2012-12-29T04:32:36.980
> 
> 标签：verilog, system-verilog

我在构建模块链时遇到了麻烦。我可以手动连接模型列出所有模块，但需要更简洁的表示。以下代码已尝试但不起作用？如何更正代码？

```
module network(
    input signed [31:0] xi,
    output signed [31:0] yo,
    input clk,
    input reset
    );

    wire signed [31:0] x0, x1, x2, y0, y1, y2, xo;
    wire [3:1] t;
    //working code for chain of pe
//   pe u0(xi, x0, 0, y0, clk, reset);  
//   pe u1(x0, x1, y0, y1, clk, reset);
//   pe u2(x1, x2, y1, y2, clk, reset);
//   pe u3(x2, xo, y2, yo, clk, reset);
    //chain of array not working! how!
    pe p[1:4] ((xi,t), (t, x), (0, t), (t,yo),clk,reset); <- want to improve
endmodule 
```

这里，pe（输入，输出，输入，输出，时钟，复位）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T01:15:51.647

试试这个。它应该适用于所有版本的 Verilog。在这种情况下，参数 PE_NUM 必须是值为 2 或更大的 int。如果需要 1 pe 实例，则必须使用生成块，这需要 Verilog-2001 或 SystemVerilog。当 PE_NUM 变大时（例如 2**16），某些模拟器可能会遇到内存限制。

```
/*All Verilog*/
module network(
        input signed [31:0] xi,
        output signed [31:0] yo,
        input clk,
        input reset
        );
    parameter PE_NUM = 4; // limitation PE_NUM must be greater then 1
    wire signed [31:0] xo;
    wire signed [0:PE_NUM-2] [31:0] xN;
    wire signed [0:PE_NUM-2] [31:0] yN;
    pe p[0:PE_NUM-1] ({xi,xN}, {xN,xo}, {32'b0,yN}, {yN,yo}, clk,reset);
endmodule 
```

以下是使用生成的示例：

```
/*Verilog-2001 or SystemVerilog*/
module network(
        input signed [31:0] xi,
        output signed [31:0] yo,
        input clk,
        input reset
        );
    parameter PE_NUM = 4; // no limitation
    wire signed [31:0] xo;
    generate
        if(PE_NUM <2) begin
            pe p (xi, xo, 32'b0, yo, clk,reset);
        end
        else begin
            wire signed [0:PE_NUM-2] [31:0] xN;
            wire signed [0:PE_NUM-2] [31:0] yN;
            pe p[0:PE_NUM-1] ({xi,xN}, {xN,xo}, {32'b0,yN}, {yN,yo}, clk,reset);
        end
    endgenerate
endmodule 
```

# ruby-on-rails - 在 Rails/Sinatra 上的 Typhoeus 帖子之后

> ID：14078718
> 
> 赞同：0
> 
> 时间：2012-12-29T04:33:24.737
> 
> 标签：ruby-on-rails, http, sinatra, typhoeus

我有一个场景，我正在通过 app.rb 中的 Typhoeus 在 Sinatra 中发帖。它看起来像这样：

```
post "/send-data" do
  ...
  request = Typhoeus::Request.new("http://localhost:4000/renders",
                              :method         => :post,
                              :headers        => { :Accept => "text/html" },
                              :followlocation => true,
                              :timeout        => 100, # milliseconds
                              :params         => params )

  # Run the request via Hydra.
  hydra = Typhoeus::Hydra.new
  hydra.queue(request)
  hydra.run
  ...
end 
```

当我成功发布到“发送数据”Typhoeus 时，它会发布并将用户推送到创建记录的视图 (http://localhost:4000/renders/34634646464)，这是一个 rails 应用程序。

问题是用户永远不会被重定向到 /send-data，因此如果您刷新页面，它会尝试再次发布。我想这是有道理的，但我真的需要将用户重定向到记录的最终（url）位置。换句话说，可以看到新记录，但这种重定向方法实际上并没有将用户移出 sinatra 应用程序。

处理这个问题的最佳方法是什么？我唯一能想到的就是不使用“followlocation”，而是让 /send-data 控制器操作在从 Typhoeus 获得响应位置后进行重定向。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T05:13:52.563

我尝试了我的建议，它有效……而且看起来还不错。

```
request = Typhoeus::Request.new("http://localhost:4000/renders.json",
                            :method         => :post,
                            :headers        => { :Accept => "json" },
                            :timeout        => 100, # milliseconds
                            :params         => params )

hydra = Typhoeus::Hydra.new
hydra.queue(request)
hydra.run

response = request.response
redirect response.headers_hash['Location'] 
```

我确实必须对我的 Rails 服务器进行更改。rails create 操作以 json 响应，'Location' 是它的返回值。“位置”是新创建的记录所在的位置。然后我只做一个 Sinatra 重定向，它将重定向到 rails 应用程序上的新记录。

# iphone - iPhone 5.0 和 5.1 模拟器不调用 IBActions？

> ID：14078725
> 
> 赞同：0
> 
> 时间：2012-12-29T04:34:37.193
> 
> 标签：iphone, ios, xcode

我有一个目标为 iOS 5.0 的应用程序。不幸的是，我不再有任何装有 iOS 5 的测试设备。

我希望能够使用 iOS 5.0 和 5.1 模拟器进行基本调试，但由于某种原因，我`IBAction`的 s 没有在这些模拟器上被调用。

更多信息：

*   Xcode 版本是 4.5.2

*   所有模拟器都是最新的（没有可用的更新/下载）

*   我们确实有使用 iOS 5 和 5.1 的客户，他们在点击按钮时没有任何问题（或者至少，我们没有收到他们的任何报告；）

*   在 iPhone 6.0 模拟器上，一切都按预期工作（很确定所有`IBActions`都正确连接）

这些模拟器是不是非常有问题（这是一个已知问题）？其他人是否遇到过这个问题并知道解决方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T05:26:46.627

很可能是我看到的问题..

*   可能是您没有`IBAction`在 .h 文件中定义您的方法。
*   可能是您将两个连接`IBAction`在一起`UIButton` `TouchUpInside`。
*   您还尝试从simileme clear xcode 卸载应用程序，而不是解决您的问题。
*   重置你的模拟器包含。
*   检查是否有任何更新，`Xcode`然后您尝试运行您的应用程序，然后您得到了解决方案。

我正在使用相同的配置，我没有像你这样的问题..

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T08:05:34.533

事实证明，a `UITapGesture`on`self.view`正在捕获触摸而不是转发到子视图......由于某种原因，这种行为在 iOS 6 和 iOS 5 模拟器中似乎有所不同......用户要小心......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-22T08:09:20.327

使用 UIGestureRecognizerDelegate 避免gestureRecognizer 对 selectedView 的影响：

```
- (BOOL)gestureRecognizer:(UIGestureRecognizer *)recognizer shouldReceiveTouch:(UITouch *)touch {
    UIView *selectedView = self.view;

    CGPoint point = [touch locationInView:self.view.superview];
    if (CGRectContainsPoint(selectedView.frame, point)) {
        return NO;
    }
    else {
        return YES;
    }
} 
```

# java - Java - 在具有 Class 的泛型类上使用 newInstance() ：InstantiationException

> ID：14078726
> 
> 赞同：2
> 
> 时间：2012-12-29T04:34:37.160
> 
> 标签：java, generics, subclass, instantiationexception

我正在尝试使用泛型类，但遇到了无法克服的障碍。简而言之，我遇到了一个我不明白为什么会抛出它的错误：InstantiationException

在文档中，它将此异常定义为：

> 当应用程序尝试使用 Class Class 中的 newInstance 方法创建类的实例，但指定的类对象由于它是接口或抽象类而无法实例化时抛出。

现在让我摸不着头脑的问题是我没有使用 abstract 或 interface 关键字。我还听说这可能是由于没有默认构造函数（我有）。可以肯定的是，我将代码减少到尽可能少，但仍然出现错误：

```
package Sandbox;

public class Sandbox {

    public static void main(String[] args) {
        Sandbox box = new Sandbox();
    }

    public Sandbox() {
        aMethod(subThread.class);
    }

    public void aMethod(Class<? extends superThread> type) {
        try {

            System.out.println("isInterface: "+type.isInterface());
            System.out.println("isAssignableFrom of subThread: "+type.isAssignableFrom(subThread.class));

            superThread t = type.newInstance();

        } catch (InstantiationException e) {
            e.printStackTrace();
        } catch (IllegalAccessException e) {
            e.printStackTrace();
        }
    }

    private class superThread { // implements Runnable {

        public superThread() {}

        public void run() {}
    }

    private class subThread extends superThread {

        public subThread() {
            super();
        }

        public void run() {
            // more stuff
        }
    }
} 
```

输出：

```
isInterface: false
isAssignableFrom of subThread: true
java.lang.InstantiationException: Sandbox.Sandbox$subThread
    at java.lang.Class.newInstance0(Unknown Source)
    at java.lang.Class.newInstance(Unknown Source)
    at Sandbox.Sandbox.aMethod(Sandbox.java:20)
    at Sandbox.Sandbox.<init>(Sandbox.java:11)
    at Sandbox.Sandbox.main(Sandbox.java:7) 
```

我敢肯定这很简单，但我无法弄清楚这一点。我已经尝试了几件事，但没有任何帮助。任何和所有的帮助表示赞赏。

谢谢，乔恩

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-29T04:49:24.027

这是因为您的内部类是私有的。简单修复：

```
public static class superThread { // implements Runnable {

    public superThread() {}

    public void run() {}
}

public static class subThread extends superThread {

    public subThread() {
        super();
    }

    public void run() {
        // more stuff
    }
} 
```

推理是因为 Class.newInstance 必须能够访问您要创建的类的构造函数。

由于该类是私有的，因此无法访问。此外，为了访问非静态内部类，您基本上必须拥有外部类（沙盒）的现有实例，而 newInstance 没有。结果，具有公共非静态或私有静态都行不通。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T05:05:07.790

在 zjagannatha 指出真正的问题之后，我还找到了对我自己的代码的修复，它允许我将方法保持为非静态......基本上我发现即使构造函数的参数为​​零，`Constructor`也将其视为有一个. 我得到它来列出参数，发现它需要一个沙盒类（我假设我目前正在使用的那个）很奇怪为了允许一个非静态类，我需要将我的 newInstance 代码更改为：

```
type.getConstructor(this.getClass()).newInstance(this); 
```

这也有效

# java - Android：线程可运行和 Handler.post 问题 - （Handler.postXX 未按预期按时运行）在 Run 方法中

> ID：14078727
> 
> 赞同：1
> 
> 时间：2012-12-29T04:34:48.987
> 
> 标签：java, android

我有一个用作 TCP 客户端的 TCP 套接字，用于**不断地**从服务器读取传入数据——直到客户端或服务器断开连接。我不知道任何其他方式，但在不同的 Runnable 线程中使用**while (true)**循环并在其中（在 while 循环中）检查传入数据。接收到的数据需要打印在**EditText**中。

我遇到的问题是从**Handler.post(...)**更新文本。

我知道：

*   为了创建与 Android 3.0 及更高版本的 TCP 连接，我需要将 TCP 代码放在**新的 Thread(...)**或**AsyncTask**中，因为默认情况下已启用严格模式，我不想禁用它。

*   我知道为了从 Android 中的新线程更新 UI，如果我使用线程，我需要使用 Handler.post()；如果**我**使用**AsyncTask** ，我需要通过**publichProgress**使用**onProgressUpdate**，我知道如何使用所有这些，但我是他们俩都遇到了*奇怪*的令人沮丧的问题。

 *****所以，我想做的就是：

*   永久收听服务器
*   一旦服务器向我发送消息，例如：'w' 或 'a' 或 n'，我立即将其显示在 EditText 上。您可以将其视为 telnet 会话，但我需要比 telnet“更高”的精度，因为我想处理每个字节，甚至是不可打印的字节，所以无论如何我都**不想**使用**readLine**。我**必须**一次读取一个字节或获取一个字节缓冲区，然后通过遍历缓冲区来分别处理它们。我一次只带一个字节。

这是我的代码，请**注意我在 handle.response 上面的评论**，看看我遇到的问题。我希望你能清除这个。

该代码的编码非常简短，我已经删除了该示例的许多错误检查部分。

我有一个名为：ThreadClientInput 的新类：

```
public class ThreadClientInput  implements Runnable {

InputStream inputStream;
MainActivity mainActivity;
Handler handler = new Handler();
int NextByte = 0;

public ThreadClientInput(MainActivity ma)
{
    mainActivity = ma;
}

@Override
public void run() 
{ 
    ////////////////////////////////////////////////////////////////
    // Run the sensitive code that requires us to create this thread
    try {
        mainActivity.tcp_Client = new Socket("192.168.1.90", 23);
    }
    catch (Exception e){Log.e("EXEPTION:", e.getMessage().toString());return;}
    ////////////////////////////////////////////////////////////////

    // Only try to get the inputStream if we have a successful connection
    if (mainActivity.tcp_Client != null) 
    {
        try 
        {
            inputStream = mainActivity.tcp_Client.getInputStream();
        }
        catch (Exception e){Log.e("EXEPTION:", e.getMessage().toString()); return;}
    }

    /////////////////////////////////////////////
    /////////////////////////////////////////////
    // Update the text on the "Connect" button
    handler.post(new Runnable() 
    {
        @Override
        public void run() 
        { mainActivity.btn_Connect.setText("Connected");}
    });
    /////////////////////////////////////////////
    /////////////////////////////////////////////

    try 
    {   

        // I need to constantly read the data until we manually disconnect or
        // the server drops the connection
        while (true) 
        {
            // Get the next byte
            // I do not want to use "readline()" from a BufferedReader etc because I need to know exactly what's coming in
            // I need to process every single byte
            NextByte = inputStream.read();

            if (NextByte > -1)
            {
                Log.e("in (While loop):", Character.toString((char)NextByte));

                *** Here is the problem ****
                // Update the EditText and this is where the problem starts
                // if the server sends "1234", the Log.e() above will display everything correctly: "1234"
                // however the handler.post below will run at the end of the last byte so the
                // the EditText as well as the second Log.e below within the handle.post will display: "1444" or "4444" or "2444"
                // So the handler.post does *not* run immediately even if I try handle.postAtFrontOfQueue()
                // If the server sends "12345678", again, Log.e() above will display everything correctly: "12345678" 
                // however the handler.post below will run at the end of the last byte again
                // and I will get "88888888" (most of the time) or "18888888" 

                //   

                handler.post(new Runnable() 
                {
                    @Override
                    public void run() 
                    {
                        mainActivity.et_Response.setText(mainActivity.et_Response.getText() + Character.toString((char)NextByte));
                        Log.e("In handler.post:", Character.toString((char)NextByte));
                    }
                });
            }
        }           
    }
    catch (Exception e){Log.e("EXEPTION:", e.getMessage().toString());}
}} 
```

我尝试了各种变体，包括一种带有**runOnUiThread**和 AsyncTask 的变体，但我得到了相同的结果。我出去了，我什么都没有。目前我只是在阅读一些关于 Handle.post 方法的文档，看看我是否有意义。

我希望你有一个解决方案，我知道“ **while (true)** ”不是一个好习惯，但我可以通过设置一个标志从线程外部打破循环，我不知道如何做到这一点.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T05:16:11.933

我不确定您如何在`NextByte`不`public void run()`将其定义为 final 的情况下进行访问！？

*   如果您希望处理程序将消息发布到 Activity UI 线程，您应该**在**Activity 类中创建它，以便它可以访问其 Looper。

我可以为您的问题想到两种解决方案，如下所示：

1-使用自定义 Runnable 类，在其中将 NextByte 值作为变量传递给它，例如

```
 handler.post(new MyRunnable(NextByte)); 
```

MyRunnable 可以是这样的：

```
 class MyRunnable implements Runnable{
   int byteData;  
   public MyRunnable(int byteData){
      this.byteData = byteData;
   }

     public void run(){ // update the EditText}
  } 
```

2- 使用 handler.sendMessage(); 并将 NextByte 添加为消息参数，例如

```
 Message msg = new Message();
 msg.arg1 = NextBye
 handler.sendMessage(msg); 
```

您的处理程序应定义如下：

```
handler = new Handler() {
        @Override
        public void handleMessage(Message msg) {
            int nextByte = msg.arg1;
                            // update the EditText
        }
    }; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T05:05:40.040

问题已解决。

这就是我所做的。

在 MainActivity.java 中，这是主文件，在 MainActivity 类中

```
 public static class MyRunnable implements Runnable {
    int currentByte = 0;

    public MyRunnable(int b){
        currentByte = b;
    }

    @Override
    public void run() 
    {
        mainActivity.et_Response.setText(mainActivity.et_Response.getText() + Character.toString((char)currentByte));
    }
} 
```

我有一个声明**mainActivity = this;** 在**onCreate**然后在**ThreadClientInput.run**

```
 try {
        while (true)
        {
            NextByte = inputStream.read(); 

            // if the server drops the connection, break out the loop
            if (NextByte < 0) break;

            handler.post(new MainActivity.MyRunnable(NextByte));
        }
    }
    catch (Exception e) {
        Log.e("EXCEPTION", e.getMessage());
    } 
```

在此之后，handler.post 会在正确和预期的时间被正确调用。完全归功于 iTech。*****

# ruby-on-rails - Rails 在救援块中没有捕获异常

> ID：14078737
> 
> 赞同：1
> 
> 时间：2012-12-29T04:37:30.203
> 
> 标签：ruby-on-rails, sphinx

`User`模型已定义要使用搜索的索引`ThinkingSphinx`。但是，当我停止我的`searchd`守护进程时，我希望我的方法能够优雅地失败并且不会引发错误。通常我通过使用救援块来捕获异常来做到这一点。但是在这种情况下，它仍然会抛出错误并且该`puts`语句永远不会执行。

```
def search_users(key)
  begin
    search_results =  User.search(key,options)
  rescue Exception
    puts "Hello World!!!"
    search_results = []
  end
  return search_results
end 
```

以下是我得到的错误：

`Riddle::ConnectionError (Connection to 127.0.0.1 on 3201 failed. Connection refused - connect(2)):`

有什么出路吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T05:04:49.473

解决了。

> 将 :populate => true 选项添加到您的搜索调用中。
> 
> 通常，Thinking Sphinx 会延迟加载搜索结果（允许使用 sphinx 范围等） - 但如果您希望救援生效，那么您需要强制立即加载结果 - 因此使用 :populate 选项。

请参阅上面发布的链接以进一步阅读。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T05:31:51.053

给定 ruby​​ 返回语义，您可以压缩代码：

```
def search_users(key)
  begin
    User.search(key,options)
  rescue
    puts "Hello World!!!"
    []
  end
end 
```

解救是邪恶的`Exception`。只需使用`rescue`, which就会拯救`StandardError`，它会捕获您想要的大部分内容。否则，您还会捕获`SyntaxError`,和其他您不想要的东西。在这种情况下，是合适的，但不是必需的。`LoadError``SystemExit``rescue Riddle::ConnectionError`

# linux - 我想在一个网站上调用整个字母表多个字母，这很容易吗

> ID：14078738
> 
> 赞同：0
> 
> 时间：2012-12-29T04:37:32.373
> 
> 标签：linux, shell, wget

我想将整个字母表称为多个字母，以便在启动之前预先缓存站点。

前任：

```
example.com/search?id=a

example.com/search?id=z

example.com/search?id=aa

example.com/search?id=zz

example.com/search?id=aaa

example.com/search?id=zzz 
```

是否有一种从命令行/shell 以这种方式获取**wget/etc的有效方法？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T12:15:26.440

与`curl`：

```
curl -# 'example.com/search?id=[a-z]' > /dev/null
curl -# 'example.com/search?id=[a-z][a-z]' > /dev/null
curl -# 'example.com/search?id=[a-z][a-z][a-z]' > /dev/null 
```

使用`wget`（和 bash）：

```
wget -O/dev/null 'example.com/search?id='{{a..z},{a..z}{a..z},{a..z}{a..z}{a..z}} 
```

不过，不确定它是否有效，但它可能会让你走得更远。

# java - 为什么当我“读取” HttpSession 属性时，应用引擎会执行写入操作

> ID：14078743
> 
> 赞同：0
> 
> 时间：2012-12-29T04:38:04.910
> 
> 标签：java, google-app-engine, jakarta-ee, servlets

httpsession 上的写操作正在消耗我的资源

我在会话中有一个 on UserSession 属性，它只存储一个用户 ID 和哈希

写操作应该只在登录时执行

但每次我在控制器中使用 UserSession 时 datastore_v3.Put 都会执行

怎么了？？？

我在我的项目中使用 spring mvc

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T07:18:49.337

我怀疑会话状态正在被保存，因为 Spring MVC 无法知道会话范围对象的状态在请求期间是否已更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T12:11:37.893

它可能会更新会话的时间戳，以使其在每次访问时保持新鲜。

如果您真的很好奇，您可以使用（我*相信*）_AH_SESSION 表获取低级会话数据（在空 ns 中对表 Query.KIND_METADATA_KIND 进行查询以获取完整的表列表，包括“隐藏”表） .

# php - PHP/MySQL/PDO 绑定空参数不起作用

> ID：14078744
> 
> 赞同：7
> 
> 时间：2012-12-29T04:38:17.823
> 
> 标签：php, mysql, parameters, pdo, null

我在以下代码中绑定空参数时遇到问题

```
$nullVariable = NULL;
$sql = new PDO('mysql:host=' . $Server, $User, $Password);
$sql->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
$sql->setAttribute(PDO::ATTR_EMULATE_PREPARES, false);
$statement = $sql->prepare("SELECT * FROM Table WHERE Binary16Column = :uuid");
$statement->bindParam(":uuid", $nullVariable, PDO::PARAM_NULL);
$statement->execute();
$results = $statement->fetchAll(PDO::FETCH_ASSOC); 
```

结果变量将是一个空数组。如果我不使用参数并将我的查询修改为“WHERE Binary16Column IS NULL”，它将返回预期的行数。所以问题一定是我如何处理参数，而不是我的 SQL 查询。

我的代码比上面列出的更复杂，我需要能够使用可能为 null 的参数变量，因此检查变量是否为 null 并运行不同的查询不太理想。从技术上讲，我有自己的参数设置函数，这是我检查变量的内容是否为空，并适当地绑定参数的地方，所以我不必编写不必要的查询数量。如果变量包含有效数据并且参数类型为 PARAM_LOB，则查询也可以正常工作。

有谁知道我做错了什么？非常感谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-29T06:51:35.540

阅读[三值逻辑](http://en.m.wikipedia.org/wiki/Three-valued_logic)。NULL 不是一个值；它是缺少值的标记，因此 NULL 永远不能等于任何东西，包括它自己。

但是，有一个空安全比较运算符也称为“宇宙飞船运算符”，它确实认为两个空值是等价的。

```
WHERE Binary16Column <=> :uuid 
```

...应该做你所期望的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-29T04:52:00.127

如果要选择`Binary16Column`为空的记录，则需要`IS NULL`用作条件，而不是`= NULL`。

```
SELECT * FROM Table WHERE Binary16Column IS NULL 
```

你需要做：

```
$uuid = /**some value**/;

$sql = new PDO('mysql:host=' . $Server, $User, $Password);
$sql->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
$sql->setAttribute(PDO::ATTR_EMULATE_PREPARES, false);

if ($uuid === null) {
  $statement = $sql->prepare("SELECT * FROM Table WHERE Binary16Column IS NULL");
} else {
  $statement = $sql->prepare("SELECT * FROM Table WHERE Binary16Column = :uuid");
  $statement->bindParam(":uuid", $uuid);
}

$statement->execute();
$results = $statement->fetchAll(PDO::FETCH_ASSOC); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-29T04:58:07.563

我认为你没有得到结果的原因是因为 NULL 是一个关键字。由于 MySQL 处理 NULL 值的方式，我认为当您执行 NULL 值搜索时，您将不得不执行 IS NULL。我在我有 NULL 值的本地数据库中做了一堆测试。它唯一有效的时候是我使用 IS NULL 或 IS NOT NULL 时。

很抱歉，我无法提供更多帮助（或者如果我只是告诉您您已经知道的内容），但是您似乎必须编写单独的查询，或者可能是一些简单的逻辑来连接适当的 WHERE 逻辑，取决于变量是否为空。

# date - 使用 Google 电子表格汇总今年日期的数据

> ID：14078746
> 
> 赞同：5
> 
> 时间：2012-12-29T04:38:43.310
> 
> 标签：date, sum, google-sheets, date-comparison, sumifs

我有一份多年来阅读的书籍清单，以及页数，存储在 Google 电子表格中。

对于每本书，我都会记录页数和完成这本书的日期。

我想总结一下我今年读过的所有书的页数。

到目前为止，我有这个部分不完整的公式：

```
=SUMIF(EndDate, <Ended reading date is between 2012-1-1 and 2012-12-31 inclusive>, PagesRead) 
```

我很确定我想使用 SUMIF，但我不知道如何使用实际公式表达第二个参数伪代码。

注意：我尝试了以下，但总和为 0：

```
=SUMIF(EndDate,AND("<"&DATE(2012,12,31),">"&DATE(2012,1,1)), TotalPages) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T06:06:48.307

尝试一起使用 sum & filter。在以下公式中，F13:F20 是我要求和的数据范围，E13:E20 是相应的日期：

```
 =sum(filter(F13:F20,E13:E20>date(2011,12,31),E13:E20<date(2013,1,1))) 
```

# java - 使用子类与使用识别字段或静态常量

> ID：14078748
> 
> 赞同：-2
> 
> 时间：2012-12-29T04:38:56.550
> 
> 标签：java, inheritance

我实际上正在寻找有关该主题的一般答案或信息链接，但我认为这个问题最好通过一个具体示例来说明：

前任。1：

```
class Car {

}

class Sedan extends Car {

}

// ... etc. where 10+ classes will extend Car 
```

前任。2：

```
class Car {

    public enum CarId {
    SEDAN,
    COUPE,
    // ...
    }

    public Car(CarId id) {
        //...
    }
} 
```

假设在这种情况下，Sedan、Coupe 等不会提供更多的复杂性（可能是单个字段，可能为空也可能不为空；也就是说，有些人会使用但其他人不会使用的字段）。

它们分别在什么情况下使用？问题的哪些具体特征将决定使用哪个？**具体来说，为什么要使用第二个而不是第一个。** 我看不出这是多么含糊，以至于需要投反对票。这个问题没有问什么是继承或什么是枚举。提供否决票的理由。

未能展示研究成果：
这是非常具体的，我问的唯一原因是因为我无法在谷歌上搜索该示例。如果是这个原因，至少提供一个信息来源。

Vague：
非常具体。

有用的：
我面临可以同时使用两者的情况。我可以*使用*一些关于我应该寻找什么来决定的信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T05:59:01.477

这样想：

汽车是一个物体。在 OOP 中，对象具有状态（也称为属性/属性）、行为。

对象状态使用类字段表示，对象行为使用方法表示。

现在，以您的示例为例：汽车是一个对象，汽车的属性是名称、品牌等。汽车的行为将是 applyBrakse(), accelarate(), ... 等等。

所以我会创建 Car 对象如下：

```
class Car {

    private String name;
    private String brand;
    private String type;
    // ...... other properties

    // constructor, getter and setter methods

    public void applyBrakes() {
        // code to apply brakes
    }

    public void accelarate() {
        // code to apply brakes
    }

    // ... other behavioral methods

} 
```

# ubuntu - 将星期几添加到文本文件中的日期

> ID：14078750
> 
> 赞同：0
> 
> 时间：2012-12-29T04:39:23.487
> 
> 标签：ubuntu, text, sed

在包含类似行的文本文件中

```
%12/29/2012% 
```

我该如何处理它，以便它们包括星期几？

```
%12/29/2012 sat% 
```

能`sed`做到吗？也许使用`sed`and的组合`date`？

请注意，并非所有行都是这样的日期，日期是标记。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T04:53:01.067

```
cat file | while read a; do date --date=$(echo "$a" | tr -d '%') +"%x %a"; done 
```

然后使用下一个命令添加百分号：

```
$ sed 's/.*/%&%/' file 
```

编辑：

如果要跳过不是日期的行，则必须添加 if-else 语句，例如：

```
$ cat file | while read a; do if [[ $a == %*% ]]; then date --date=$(echo "$a" | tr -d '%') +"%x %a"; else echo "$a"; fi; done 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T05:24:00.860

如果你有`GNU awk`，你可以尝试：

```
awk '(x = mktime(gensub(/%(..)\/(..)\/(....)%/, "\\3 \\1 \\2 0 0 0", ""))) != -1 { print strftime("%%%m/%d/%Y %a%%", x); next }1' file 
```

测试：

内容`file`：

```
%12/29/2012%
wtf
%12/30/2012% 
```

结果：

```
%12/29/2012 Sat%
wtf
%12/30/2012 Sun% 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T18:03:24.070

```
perl -MPOSIX -pe 's{%(\d{2})/(\d{2})/(\d{4})%}{strftime "%%%m/%d/%Y %a%%",0,0,0,$2,$1-1,$3-1900}ge' file 
```

# java - Java 反射抓取非公共字段

> ID：14078753
> 
> 赞同：1
> 
> 时间：2012-12-29T04:39:48.770
> 
> 标签：java, reflection

我在使用 Java 中的反射获取类中的字段时遇到问题：

```
public class CraftLib
{
    static List alloyRecipes = new ArrayList();
    public static HashSet damageOnCraft = new HashSet();
    public static HashMap damageContainer = new HashMap();

public static void addAlloyResult(ur output, Object[] input)
{
    alloyRecipes.add(Arrays.asList(new Object[] { input, output }));
}
//file continues 
```

我试图抓住这样的领域：

```
try {
    Field[] fields = Class.forName("class.path").getFields();
    for(Field f : fields) {
    System.out.println(f.getName());
} catch (ClassNotFoundException e) {
    System.out.println("Damn.");
}
System.out.println(fields.length); 
```

由于某种原因，它只能抓取`damageOnCraft`and`damageContainer`字段，但我真正需要的，`alloyRecipes`，没有被抓取。我无法编辑第一个文件，那么获取和编辑该字段的最佳方法是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-29T04:44:12.077

[`getFields()`](http://docs.oracle.com/javase/7/docs/api/java/lang/Class.html#getFields())如果它们无法访问，则不会为您提供私有的、受包保护的或受保护的字段。

> (getFields()) 返回一个包含 Field 对象的数组，反映此 Class 对象表示的类或接口的所有**可访问公共字段**

显然，在您的情况下，您的包裹保护`alloyRecipes`是不可访问的。

你需要[`getDeclaredFields()`](http://docs.oracle.com/javase/7/docs/api/java/lang/Class.html#getDeclaredFields())

> (getDeclaredFields()) 返回一个 Field 对象数组，反映由该 Class 对象表示的类或接口声明的所有字段。这**包括公共、受保护、默认（包）访问和私有字段**，但不包括继承的字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T04:44:37.673

将您的类与另一个类放在同一个包中，然后它将能够读取包保护字段。

# python - Django 自定义模型字段：未调用 to_python()

> ID：14078755
> 
> 赞同：9
> 
> 时间：2012-12-29T04:40:23.500
> 
> 标签：python, django

我对 Python 和 Django 还很陌生，对 Stack Overflow 也很陌生，所以我希望我不会在这里违反任何规则，并且我尊重问题的格式。

我在尝试使用 Django（Python 3.3.0，Django 1.5a1）实现自定义模型字段时遇到问题，但我没有找到任何类似的主题，我实际上非常坚持这个......

所以有一个玩家，他有一手（牌）。Hand 继承自 CardContainer，它基本上是一个带有一些（隐藏在这里）辅助函数的卡片列表。下面是对应的代码：

```
from django.db import models

class Card:
    def __init__(self, id):
        self.id = id

class CardContainer:
    def __init__(self, cards=None):
        if cards is None:
            cards = []
        self.cards = cards

class Hand(CardContainer):
    def __init__(self, cards=None):
        super(Hand, self).__init__(cards)

class CardContainerField(models.CommaSeparatedIntegerField):
    __metaclass__ = models.SubfieldBase

    def __init__(self, cls, *args, **kwargs):
        if not issubclass(cls, CardContainer):
            raise TypeError('{} is not a subclass of CardContainer'.format(cls))

        self.cls = cls
        kwargs['max_length'] = 10
        super(CardContainerField, self).__init__(*args, **kwargs)

    def to_python(self, value):
        if not value:
            return self.cls()

        if isinstance(value, self.cls):
            return value

        if isinstance(value, list):
            return self.cls([i if isinstance(i, Card) else Card(i) for i in value])

        # String: '1,2,3,...'
        return self.cls([Card(int(i)) for i in value.split(',')])

    def get_prep_value(self, value):
        if value is None:
            return ''

        return ','.join([str(card.id) for card in value.cards])

class Player(models.Model):
    hand = CardContainerField(Hand) 
```

但是当我得到一个玩家时，可以这样说：`Player.objects.get(id=3).hand`，而不是得到一个`Hand`实例（甚至根本不是一个`CardContainer`实例！），我只是得到一个逗号分隔的整数字符串，如“1,2,3”，它在数据库中很好（这是我想在数据库中看到的格式）......

在我看来， to_python 没有被调用，所以返回的数据是原始值，因此是字符串。当我搜索这类问题时，人们错过了`__metaclass__ = models.SubfieldBase`......我希望我也能错过，但是，嘿，这太简单了！我错过了一些微不足道的事情，还是我错了整件事？:D

非常感谢！！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-29T11:29:18.650

在 python 3 中`__metaclass__`不再支持模块全局变量。您必须使用：

```
class CardContainerField(models.CommaSeparatedIntegerField, metaclass=models.SubfieldBase):
   ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-10-20T18:35:56.103

对于 Django 1.10 和最新版本

```
class CardContainerField(models.CommaSeparatedIntegerField):
    def from_db_value(self,value, expression, connection, context):
      ....... 
```

# c++ - itoa 到 std::to_string

> ID：14078758
> 
> 赞同：1
> 
> 时间：2012-12-29T04:41:13.373
> 
> 标签：c++, tostring, itoa

这可能是一个模糊的问题，但我收到了这个错误

```
Simulator.cpp: In member function `void Simulator::generatePassengers()': 
Simulator.cpp:60: error: `itoa' undeclared (first use this function) 
```

这是我遇到问题的代码

`itoa(i,buf,10);`

我可以用什么来解决这个问题，因为在一个编译器上我在另一个我没有遇到这个问题。所以我很难过这里必须同时处理这两个问题。

```
 char buf[3];
    if(i<10)
    {
        key1.append("0");
        key2.append("0");
        key3.append("0");
    }
    itoa(i,buf,10);
    key1.append(buf);
    key2.append(buf);
    key3.append(buf); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T04:51:03.120

您的平台没有[itoa](http://www.cplusplus.com/reference/cstdlib/itoa/)。没有任何标准规定。您可以使用任何您喜欢的替代品，包括`printf`或只是编写您自己的替代品。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-29T04:52:12.050

这行得通吗？

```
#include <string>
std::string buf = std::to_string(i);
key1.append(buf);
key2.append(buf);
key3.append(buf); 
```

# python - django import project.app vs import app

> ID：14078762
> 
> 赞同：0
> 
> 时间：2012-12-29T04:41:56.293
> 
> 标签：python, django, import

我正在阅读另一个 django 教程，我注意到作者从**project.app.file 导入项**中使用的导入，但这不起作用，除非我 **从 app.file 导入项中执行**

示例：作者版本：

**从 ecomstore.catalog.models 导入产品**

这不起作用错误：ImportError：没有名为catalog.models的模块

但这确实

**从目录.模型导入产品**

我只是为什么作者版本对我不起作用以及为什么以及是否有设置我可以更改以解决此问题，以便更容易理解。

我认为这是一个问题，并试图了解 django 是如何工作的，以及我可以在项目中更改的设置或配置所在的位置。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T04:56:40.153

`from catalog.models import Product`很好，我认为它比示例更好。因为如果您想使用该应用程序，您必须更改使用项目名称的每个导入语句。不要这样做`from myproject.myapp.models import MyModel`，这是一种不好的做法，如果您确定您导入的模型在同一目录中，我认为这个是最好的：`from models import Product`，否则`from myapp.models import MyModel`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T09:44:36.663

根据日期，我认为您使用的是最新的 django 1.4，当您键入“django-admin.py startproject”和“django-admin.py startapp”时，它具有新的布局。

[https://docs.djangoproject.com/en/1.4/releases/1.4/#updated-default-project-layout-and-manage-py](https://docs.djangoproject.com/en/1.4/releases/1.4/#updated-default-project-layout-and-manage-py)

# cakephp - Cakephp bindModel 不工作

> ID：14078770
> 
> 赞同：0
> 
> 时间：2012-12-29T04:44:14.537
> 
> 标签：cakephp

我正在尝试绑定 Company hasMany CompanyReview。下面是控制器中的代码：

```
public function review() {
    $this->uses = array('Search', 'Company', 'CompanyReview');
    $this->Company->bindModel(array(
        'hasMany' => array(
            'CompanyReview' => array(
            'className' => 'CompanyReview',
            'foreignKey' => 'company_id'
            )
        )
    ));
    $this->CompanyReview->bindModel(
        array(
           'belongsTo'=>array(
                'Company'=>array(
                    'className'=>'Company',
                    'foreignKey'=>'company_id'
                 )
            )
        )
    );

    if (!empty($this->data)) {
        switch ($this->data['Search']['search_type']) {
            case 'all':
                $this->request->data['ReviewResults'] = $this->allReviews($this->data['Search']['search_query']);
                break;
            case 'company':
                $this->request->data = $this->Company->find('all', array(
                   'conditions' => array(
                      'OR' => array(
                          'MATCH(Company.name) against ("' . $this->data['Search']['search_query'] . '" in boolean mode)',
                          'MATCH(CompanyReview.job_title) against ("' . $this->data['Search']['search_query'] . '" in boolean mode)'
                           )

                        )
                    ));
                break;
            case 'interview':
                $this->request->data['ReviewResults'] = $this->interviewReviews($this->data['Search']['search_query']);
                break;
            case 'salary':
                $this->request->data['ReviewResults'] = $this->salaryReviews($this->data['Search']['search_query']);
                break;
            }
        }
    } 
```

但我不断收到的错误是：数据库错误

```
Error: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'CompanyReview.job_title' in 'where clause' 
```

**SQL查询**：

`SELECT Company.id, Company.name, Company.industry_id, Company.website, Company.created FROM terbang2.companies AS Company WHERE ((MATCH(Company.name) against ("air" in boolean mode)) OR (MATCH(CompanyReview.job_title) against ("air" in boolean mode)))`

注意：如果要自定义此错误消息，请创建**app/View/Errors/pdo_error.ctp**

如果您注意到，sql 不包含 company_reviews 表。怎么会这样？请帮忙！。谢谢

哦，顺便说一句，company_reviews 表中有一个名为 job_title 的表行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T04:55:25.023

您需要使用[[Joins]](http://book.cakephp.org/2.0/en/models/associations-linking-models-together.html#joining-tables)。

从关联自动构建的“正常”查询实际上对每个模型执行单独的查询，因此您不能引用其表中不存在的字段，如果试过了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T13:38:31.940

如果你想让 cake automagic 工作使用`$this->CompanyReview->find();`，因为 cake 只在 and 的情况下才`$belongsTo`加入`$hasOne`。在`$hasMany`和 HABTM 中有单独的查询。如果您想/需要在公司上查找，您需要进行@Dave 提到的加入。

笔记。您不需要双向绑定。如果您确实在 Company 上找到，则仅绑定到 Company 模型。

# html - 选择框的宽度与文本框匹配

> ID：14078771
> 
> 赞同：0
> 
> 时间：2012-12-29T04:44:18.720
> 
> 标签：html, css

> **可能重复：**
> [在 HTML 中选择输入和文本输入 - 使宽度相等的最佳方法？](https://stackoverflow.com/questions/895904/select-inputs-and-text-inputs-in-html-best-way-to-make-equal-width)

我有一个输入框和一个选择框，我希望为它们应用相同的宽度。即200像素。我尝试使用类似的东西

```
<input type="text" style="width: 200px">
<select style="width : 200px;" size="1">
  <option >test</option>
</select> 
```

但似乎它们的宽度不同，这是链接：http: [//jsfiddle.net/GdTqp/](http://jsfiddle.net/GdTqp/)

关于我们如何实现相同宽度的任何想法（同时保持 css 宽度通用）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T04:49:16.470

这是在不同浏览器中测试时的常见问题，请尝试使用 box-sizing 属性。

```
 box-sizing: border-box;
 -moz-box-sizing: border-box;
 -webkit-box-sizing: border-box; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T04:48:53.983

```
input {
box-sizing: border-box;
-moz-box-sizing: border-box;
-webkit-box-sizing: border-box;
}​
select {
box-sizing: border-box;
-moz-box-sizing: border-box;
-webkit-box-sizing: border-box;
} 
```

# android - 当我引用我的自定义类时出现空指针异常？

> ID：14078777
> 
> 赞同：0
> 
> 时间：2012-12-29T04:46:13.150
> 
> 标签：android, nullpointerexception

因为我的日志命令踢出一个“4”我猜它是：

```
word.getnewword(); 
```

那是返回空指针异常，但是为什么呢？

代码的目的是让一个类在一个单词中保存不同的字母，然后分别为单词中的每个字母设置动画，然后从类中的列表中将单词更改为随机的新单词。我对每个字母使用字符而不是单词或每个字母的字符串，这也可以吗？

```
package com.xyz.letters;

import ......abreviated

public class letters extends Activity {

private Animals word;
boolean gameover = false;
private AdView adView;

TextView tva;
TextView tvb;
TextView tvc;
TextView tvd;
TextView tve;
TextView tvf;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.letters);
    Log.e("main", "xml loaded fine"); 
    tva = (TextView) findViewById(R.id.texta);
    tvb = (TextView) findViewById(R.id.textb);
    tvc = (TextView) findViewById(R.id.textc);
    tvd = (TextView) findViewById(R.id.textd);
    tve = (TextView) findViewById(R.id.texte);
    tvf = (TextView) findViewById(R.id.textf);
    Log.e("main", "textview pre-setup complete"); 

    Log.e("main", "4"); 
        word.getnewword();  
        Log.e("main", "gotword " + word.getwordchosennumber());
        setletters();
        Log.e("main", "set letters ok");
......etc 
```

我的课：-

```
package com.xyz.letters;

import java.util.Random;

import android.util.Log;

public class Animals {

private int wordchosen;
private int length;
private char l1;
private char l2;
private char l3;
private char l4;
private char l5;
private char l6;

public Animals() {
    this.wordchosen = 0;
    this.length = 3;
    this.l1 = 'a';
    this.l2 = 'b';
    this.l3 = 'c';
    this.l4 = 'a';
    this.l5 = 'b';
    this.l6 = 'c';

}

public void getnewword() {
    Log.e("animals", "0");
       Random ran = new Random();
        Log.e("animals", "1");
       wordchosen = ran.nextInt(2); 
        Log.e("animals", "2");

   switch (wordchosen) {
        case 0:
            length = 3;
            l1 = 'a';
            l2 = 'n';
            l3 = 't';
            break;
        case 1:
            length = 4;
            l1 = 'b';
            l2 = 'a';
            l3 = 'l';
            l4 = 'l';
            break;
        case 2:
            length = 3;
            l1 = 'b';
            l2 = 'a';
            l3 = 't';
            break;

        default: 
            length = 0;
            break;
    }
}

public int getwordchosennumber()
{
    return this.wordchosen;
}

public int getlength()
{
    return this.length;
}

public int getl1()
{
    return this.l1;
}

public int getl2()
{
    return this.l2;
}

public int getl3()
{
    return this.l3;
}

public int getl4()
{
    return this.l4;
}

public int getl5()
{
    return this.l5;
}

public int getl6()
{
    return this.l6;
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T04:49:44.073

因为，`word`有价值`null`。异常`null pointer exception`本身指定了它的含义，即您要访问具有`null`引用的某个对象。

在这里声明

```
private Animals word; 
```

最初，它有`null`参考，直到你不会做类似的事情

```
word = new Animals();  // assign Animals reference 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T04:49:26.133

你永远不会初始化`word`. 在错误之前的行（或在初始声明中），使用`new`：

```
word = new Animals(); // The line to insert.
word.getnewword(); 
```

关于以后的问题，当您遇到异常或强制关闭时，请发布完整的 LogCat 堆栈跟踪（日志输出中的红色文本），以帮助我们更快地找到问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T05:14:07.907

在 OnCreate 之后 Log.e("main", "textview pre-setup complete");

添加

```
word = new Animals(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-29T05:18:52.913

您应该创建类的对象，例如

```
 word = new Animals(); 
```

现在，使用这个对象来访问 Animals 类的公共方法和变量。

```
 word.getnewword(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-29T06:25:55.373

你得到一个 NullPointerException 因为变量“word”没有被初始化。在使用变量时，Android 有点奇怪。如果在调用变量之前没有在 onCreate 方法（或从 onCreate 方法调用的某个方法）中初始化变量，那么您将收到 NullPointerException，因为 JVM 不知道该变量的值是什么。这有点像具有 main 方法的常规 java 代码 - 如果您调用尚未在 main 方法中初始化的变量，您将获得 NullPointerException。

要修复您的代码，只需在对变量进行任何调用之前将其放在 onCreateMethod 中：

```
word = new Animals(); 
```

之后，您可以使用变量执行所需的操作。

# python - Python - 如何将应用程序窗口录制到视频中？

> ID：14078781
> 
> 赞同：1
> 
> 时间：2012-12-29T04:47:05.117
> 
> 标签：python, video-capture

我有一个 python 应用程序，我需要将此窗口操作保存到视频文件中。

这个应用程序可以最小化，或者用户可以在前面放另一个窗口，但我需要钢保存这个窗口动作

可能吗 ？

好的：

我正在使用 Gnome、pygtk、X11

我需要将我的应用程序的所有实时保存到视频中

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T03:19:54.087

定期用于[`Window.get_snapshot`](http://www.pygtk.org/docs/pygtk/class-gtkwidget.html#method-gtkwidget--get-snapshot)获取窗口的快照。然后将这些图像组合成视频。我能想到的一个简单但效率低下的机制是针对每一帧，将你的[`Pixmap`](http://www.pygtk.org/docs/pygtk/class-gdkpixmap.html)转换为[`Pixbuf`](http://www.pygtk.org/docs/pygtk/class-gdkpixbuf.html)using [`Pixbuf.get_from_drawable`](http://www.pygtk.org/docs/pygtk/class-gdkpixbuf.html#method-gdkpixbuf--get-from-drawable)。然后使用[`Pixbuf.save`](http://www.pygtk.org/docs/pygtk/class-gdkpixbuf.html#method-gdkpixbuf--save)将每个帧保存为 PNG。[应用程序完成后，使用FFmpeg](http://www.ffmpeg.org/)将所有这些 PNG 组合成一个视频。

# php - 使用 AJAX 和 PHP 监控数据库的变化

> ID：14078784
> 
> 赞同：1
> 
> 时间：2012-12-29T04:47:41.667
> 
> 标签：php, mysql, jquery

我正在制作一种监视器，它显示由另一个 Web 应用程序创建的数据库更改，我每 10 秒重新加载一次页面以显示更改，但是，我认为这不是这样做的“方式”，所以我进行了一些研究，我发现ajax可以做到这一点，调用一个检查变化的函数，所以我写了我的代码，但是缺少一些东西，所以我打电话给专家，主要的想法是当页面加载时采取插入的最后一行的 id(number) 然后保存在一个名为 $resultado 的变量中，然后调用一个名为 check_changes 的函数，该函数执行相同的查询并检查结果，如果两个变量相等则没有变化，如果它们是不同的重新加载页面。

监视器.php

```
 <head>
    <script type="text/javascript" src="./js/prototype.js"></script>
    <script type="text/javascript" src="./js/jquery-1.8.3.min.js"></script>
    </head>

    <?
    //code that makes and print the query.

    // here i check the last id(number) and saved on $resultado variable
    $qry0="SELECT emergencia.id FROM emergencia ORDER BY emergencia.id DESC LIMIT 0,1";
    $qry1=db_query($qry0,$conn);
    while($row=$qry1->fetch_array()) 
    { 
    $resultado=$row['id'];
    }

    //here i call check_changes every 30 seconds
    echo "<script>setTimeout('check_changes()',30);"; 
    //ajax function that check the status of database
    echo "function check_changes(){
    $.ajax({
type: 'POST',
data: {'data':$resultado}, //here am sending the value of result via post
url: './checker.php',   //to checker.php
success: function(data) {
if(data.result==true){ 
window.location = window.location.pathname;
} 
}
})
    }";
    echo "</script>";
    ?> 
```

检查器.php

```
 <?
    $result4 = $_POST['data'];
    include( "/home/ocelas/proyecto/include/inter_dbc_innodb.php" );
    $dbc=connect_db("seguridad");

    // here i check the last id(number) and saved on $result3 variable
    $qry0="SELECT emergencia.id FROM emergencia ORDER BY emergencia.id DESC LIMIT 0,1";
    $qry1=$dbc->query($qry0);
    while($row=$qry1->fetch_array()) 
    {  
    $result3=$row['id'];
    }

    //here i check if both are equal send false to monitor.php
    if ($result4==$result3){
    $result=false
    echo json_encode($result); 
    }
    else {
    // a new row has been inserted, send true to monitor.php an reload page
    $result=true
    echo json_encode($result); 
    }
    ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T05:16:13.627

```
<script type="text/javascript">
var pollTimeout;
var observeChange = {
          'poll' : function() {
              $.ajax({
                   type: "POST",
                   url: 'checker.php',
                   data:"data=<?php echo $resultado; ?>",
                   dataType:"json",
                   async:true,
                   success:function(response){
                        // we have success fully received response,clear the timeout
                       clearTimeout(pollTimeout);                                          
                       observeChange.update(response);                             
                   },
                   error: function(XMLHttpRequest,textStatus){
                        //some error has occured please try after 5 seconds
                        pollTimeout = setTimeout(function()
                        {
                            observeChange.poll();
                        }, 1000);

                    }
                });

          },
          'update' : function(json) {
              //check whether change is there from serever or not if yes than reload page else do poll request again
              if(json.changed=="yes"){
                        window.location.reload();
              }
              else{
                observeChange.poll();
               }
          }
    };
    $(document).ready(function(){
      observeChange.poll();           
    });
    </script> 
```

你可以通过 comet 轻松完成，不建议每 10 秒查询一次服务器，如果你使用 apache，你应该增加 apache 服务器的超时时间

建议的 apache 配置是

```
Timeout 300
KeepAlive On
MaxKeepAliveRequests 100
KeepAliveTimeout 240
MaxClients 150
MaxRequestsPerChild 4 
```

检查器.php

```
<?
$result4 = $_POST['data'];
$response=array("changed"=>"no");
include( "/home/ocelas/proyecto/include/inter_dbc_innodb.php" );
$dbc=connect_db("seguridad");

// here i check the last id(number) and saved on $result3 variable
$qry0="SELECT emergencia.id FROM emergencia ORDER BY emergencia.id DESC LIMIT 0,1";
$qry1=$dbc->query($qry0);
while($row=$qry1->fetch_array()) 
{  
$result3=$row['id'];
}

if ($result4==$result3){
   $response['changed']="yes"; 
}
echo json_encode($response); exit;
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T05:14:43.283

您的 php 代码中缺少一些分号。我认为它根本不起作用。您应该检查回发脚本中生成的 php 错误消息。

在您的 javascript 中，您将结果与布尔值进行比较。返回的数据将是一个字符串。这是正确的方法，注意单引号。

```
if(data.result=='true'){ 
window.location = window.location.pathname;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T05:29:35.493

在**checker.php**中，您**在转换为 JSON 格式后发送数据**，
但**在 ajax 请求中**，您**根本没有定义数据类型**，
如果 ajax 成功时的数据是 JSON，那么您必须先解析它..

```
 $.ajax({
               type: "GET",
               url: 'checker.php',
               data:{'ata:$resultado},
               dataType:"json",
               success:function(data){
                       if( JSON.parseQuery(data)) //this will run if the result is true.
                         {
                          window.location = window.location.pathname;
                         }            
               }
           }); 
```

# javascript - 为 jquery 创建 window.onhashchange 功能之外的自定义事件

> ID：14078787
> 
> 赞同：1
> 
> 时间：2012-12-29T04:48:07.383
> 
> 标签：javascript, jquery, hash, delegates

我认为在收集有关如何解决我的问题的一些信息后重新表述整个问题会更好。

现在的简单问题是如何从`window.onhashchange`功能中创建自定义事件。

我想这样做是因为您可能知道您无法在 javascript 加载的内容上附加处理程序，您可以通过以下方式解决此问题

`$('parent').on('event', 'child', func)`正确的？这相当于 jquery 委托功能。

如何创建自定义事件`window.onhashchange`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T07:43:50.803

哦。好的。好吧，window 是唯一对触发 hashchange 有意义的东西，所以我不确定你为什么想要事件委托。听窗。当哈希值发生变化时，对当前存在的任何 HTML 执行您想要的操作。

您实际上可以将处理程序附加到 JavaScript 附加的内容。如果它在 DOM 中，那么您可以对其进行操作和监听事件。问题是当您替换 html 内容时。原来的 dom 节点不见了，所以如果你有一个点击事件，它就会注册到一个不再存在的节点上。

但是 window 只能通过重新加载页面来替换，这是唯一与哈希更改相关的事情。'hashchange' 也不是真正的 DOM 事件。如果它在一个元素上触发是有意义的，我不确定它是否还会像“click”这样的事件那样冒泡。

简短版本：如果您需要在此“hashchange”事件中发生某些事情，我不确定您是否遇到了您认为遇到的问题。

# javascript - 使用 javascript 添加 OnClick 事件

> ID：14078789
> 
> 赞同：0
> 
> 时间：2012-12-29T04:48:39.427
> 
> 标签：javascript

我正在尝试找到一种方法来制作导致 onclick 事件的类。例如，以表格为例。我想给那个表单域一个类。每次我将某个类添加到字段时，我都希望它为表单字段生成一个 onclick 命令。

我这样做的原因是我想为每个表单字段添加分析跟踪，但我使用的是重力表单，所以我希望能够在不编辑每个表单的情况下即时创建表单。如果我可以创建一个名为 .name 的类并让该类将其添加`onClick="mixpanel.track('Name_field');"` 到表单输入中，那么我可以跟踪用户每次在表单内单击以填写它。通过这种方式，我可以跟踪表单的每个步骤并查看用户何时离开。

所以列表是

```
.name  that would add onClick="mixpanel.track('Name_field');"
.email  that would add onClick="mixpanel.track('Email_field');"
.phone  that would add onClick="mixpanel.track('pnone_field');" 
```

我希望这是有道理的。谢谢你提供的所有帮助。我对 javascript 还很陌生，所以请放轻松。html 和 css 我是专业人士，但 javascript 是我要攀登的下一座山。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T04:52:33.857

委托会更有效率，因此您只有一个事件处理程序：

```
var f = function (e) {
  e = e || window.event;
  var t = e.srcElement || e.target, m;
  while (t !== this && (!t.className || !(m = t.className.match(/\b(name|email|phone)\b/)))) {
    t = t.parentNode;
  }
  if (m) {
    switch (m[0]) {
      case "name": mixpanel.track("Name_field"); break;
      case "email": mixpanel.track("Email_field"); break;
      case "phone": mixpanel.track("phone_field"); break;
    }
  }
};
if (document.body.attachEvent) {
  document.body.attachEvent("onclick", f, true);
} else {
  document.body.addEventListener("click", f, true);
} 
```

# c# - 正则表达式与文本 C# 匹配？

> ID：14078790
> 
> 赞同：0
> 
> 时间：2012-12-29T04:48:41.870
> 
> 标签：c#, .net, regex

我正在阅读一个包含以下内容的日志文件

```
DateTime: 2012-12-09 17:00:18
Command: ALTER INDEX [XPKAttribute] ON [FMC360Train_MSCRM].[MetadataSchema].[Attribute] REORGANIZE WITH (LOB_COMPACTION = ON)
Comment: ObjectType: Table, IndexType: Clustered, ImageText: No, NewLOB: No, FileStream: No, AllowPageLocks: Yes, PageCount: 1336, Fragmentation: 10.1796
Outcome: Succeeded
Duration: 00:00:01
DateTime: 2012-12-09 17:00:19

DateTime: 2012-12-09 17:00:19
Command: ALTER INDEX [XPKLocalizedLabel] ON [FMC360Train_MSCRM].[MetadataSchema].[LocalizedLabel] REORGANIZE WITH (LOB_COMPACTION = ON)
Comment: ObjectType: Table, IndexType: Clustered, ImageText: No, NewLOB: Yes, FileStream: No, AllowPageLocks: Yes, PageCount: 2522, Fragmentation: 18.5964
Outcome: Succeeded
Duration: 00:00:01
DateTime: 2012-12-09 17:00:20 
```

这是我正在使用的正则表达式代码

```
var data = new Regex(@"^DateTime:\ (?<StartTime>[^\r]+)\r\nCommand: ALTER INDEX\ (?<Command>[^\r]+)\r\nComment:\ (?<Comment>[^\r]+)\r\nOutcome:\ (?<Outcome>[^\r]+)\r\nDuration:\ (?<Duration>[^\r]+)\r\nDateTime:\ (?<EndTime>[^\r]+)", RegexOptions.Multiline)
                .Matches(File.ReadAllText(@"C:\Users\dalvi\Desktop\Index Logs\trial.txt")).Cast<Match>().Select(m => new
                {
                    StartTime = m.Groups["StartTime"].Value,
                    Command = m.Groups["Command"].Value,
                    Comment = m.Groups["Comment"].Value,
                    Outcome = m.Groups["Outcome"].Value,
                    Duration = m.Groups["Duration"].Value,
                    EndTime = m.Groups["EndTime"].Value
                }); 
```

但是输出我在命令之后得到整个文本：和评论：但是我想要在 ON 之后的文本意味着 [FMC360Train_MSCRM].[MetadataSchema].[LocalizedLabel] 然后下一个文本 REORGANIZE 作为不同的值，我该如何修改正则表达式代码得到像这样的输出

```
StartTime   DBTableName Type    Comment Outcome Duration    EndTime
2012-12-09 17:00:18 [FMC360Train_MSCRM].[MetadataSchema].[Attribute]    REORGANIZE  PageCount: 1336 Succeeded   00:00:01    2012-12-09 17:00:19 
```

我的程序正在努力获得长输出，但我想要以上述格式输出，所以我只需要正则表达式的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T05:56:56.620

我不知道解析您的`Command`行的确切规则，但以下正则表达式适用于您的两个示例输入：

```
var data = new Regex(@"^DateTime:\ (?<StartTime>[^\r]+)\r\nCommand: ALTER INDEX \[([^\]]+)\] ON (?<DBTableName>\[([^\]]+)\]\.\[([^\]]+)\]\.\[([^\]]+)\]) (?<Type>[^ ]+) ([^\r]+)\r\nComment:\ (?<Comment>.+Fragmentation: (?<Fragmentation>[\d\.]+)[^\r]+)\r\nOutcome:\ (?<Outcome>[^\r]+)\r\nDuration:\ (?<Duration>[^\r]+)\r\nDateTime:\ (?<EndTime>[^\r]+)", RegexOptions.Multiline)
    .Matches(File.ReadAllText(@"C:\Users\dalvi\Desktop\Index Logs\trial.txt")).Cast<Match>().Select(m => new
        {
            StartTime = m.Groups["StartTime"].Value,
            DBTableName = m.Groups["DBTableName"].Value,
            Type = m.Groups["Type"].Value,
            Comment = m.Groups["Comment"].Value,
            Fragmentation = m.Groups["Fragmentation"].Value,
            Outcome = m.Groups["Outcome"].Value,
            Duration = m.Groups["Duration"].Value,
            EndTime = m.Groups["EndTime"].Value
        }); 
```

编辑：

以下是在您的测试数据上运行的完整控制台应用程序：

```
class Program
{
    static void Main(string[] args)
    {
        string input =
            @"DateTime: 2012-12-09 17:00:18
Command: ALTER INDEX [XPKAttribute] ON [FMC360Train_MSCRM].[MetadataSchema].[Attribute] REORGANIZE WITH (LOB_COMPACTION = ON)
Comment: ObjectType: Table, IndexType: Clustered, ImageText: No, NewLOB: No, FileStream: No, AllowPageLocks: Yes, PageCount: 1336, Fragmentation: 10.1796
Outcome: Succeeded
Duration: 00:00:01
DateTime: 2012-12-09 17:00:19

DateTime: 2012-12-09 17:00:19
Command: ALTER INDEX [XPKLocalizedLabel] ON [FMC360Train_MSCRM].[MetadataSchema].[LocalizedLabel] REORGANIZE WITH (LOB_COMPACTION = ON)
Comment: ObjectType: Table, IndexType: Clustered, ImageText: No, NewLOB: Yes, FileStream: No, AllowPageLocks: Yes, PageCount: 2522, Fragmentation: 18.5964
Outcome: Succeeded
Duration: 00:00:01
DateTime: 2012-12-09 17:00:20";

        var data = new Regex(@"^DateTime:\ (?<StartTime>[^\r]+)\r\nCommand: ALTER INDEX \[([^\]]+)\] ON (?<DBTableName>\[([^\]]+)\]\.\[([^\]]+)\]\.\[([^\]]+)\]) (?<Type>[^ ]+) ([^\r]+)\r\nComment:\ (?<Comment>.+Fragmentation: (?<Fragmentation>[\d\.]+)[^\r]+)\r\nOutcome:\ (?<Outcome>[^\r]+)\r\nDuration:\ (?<Duration>[^\r]+)\r\nDateTime:\ (?<EndTime>[^\r]+)", RegexOptions.Multiline)
            .Matches(input).Cast<Match>().Select(m => new
            {
                StartTime = m.Groups["StartTime"].Value,
                DBTableName = m.Groups["DBTableName"].Value,
                Type = m.Groups["Type"].Value,
                Comment = m.Groups["Comment"].Value,
                Fragmentation = m.Groups["Fragmentation"].Value,
                Outcome = m.Groups["Outcome"].Value,
                Duration = m.Groups["Duration"].Value,
                EndTime = m.Groups["EndTime"].Value
            });

        foreach (var datum in data)
        {
            Console.WriteLine("StartTime: {0}", datum.StartTime);
            Console.WriteLine("DBTableName: {0}", datum.DBTableName);
            Console.WriteLine("Type: {0}", datum.Type);
            Console.WriteLine("Comment: {0}", datum.Comment);
            Console.WriteLine("Fragmentation: {0}", datum.Fragmentation);
            Console.WriteLine("Outcome: {0}", datum.Outcome);
            Console.WriteLine("Duration: {0}", datum.Duration);
            Console.WriteLine("EndTime: {0}", datum.EndTime);
            Console.WriteLine();
        }

        Console.ReadKey();
    }
} 
```

这是它的输出：

```
StartTime: 2012-12-09 17:00:18
DBTableName: [FMC360Train_MSCRM].[MetadataSchema].[Attribute]
Type: REORGANIZE
Comment: ObjectType: Table, IndexType: Clustered, ImageText: No, NewLOB: No, FileStream: No, AllowPageLocks: Yes, PageCount: 1336, Fragmentation: 10.1796
Fragmentation: 10.179
Outcome: Succeeded
Duration: 00:00:01
EndTime: 2012-12-09 17:00:19

StartTime: 2012-12-09 17:00:19
DBTableName: [FMC360Train_MSCRM].[MetadataSchema].[LocalizedLabel]
Type: REORGANIZE
Comment: ObjectType: Table, IndexType: Clustered, ImageText: No, NewLOB: Yes, FileStream: No, AllowPageLocks: Yes, PageCount: 2522, Fragmentation: 18.5964
Fragmentation: 18.596
Outcome: Succeeded
Duration: 00:00:01
EndTime: 2012-12-09 17:00:20 
```

# c - cublasDdot CUBLAS_STATUS_INTERNAL_ERROR

> ID：14078797
> 
> 赞同：2
> 
> 时间：2012-12-29T04:50:00.117
> 
> 标签：c, cuda

我实现了一个前置条件共轭梯度法，`Ax = B`通过使用`CUBLAS`lib 和`CUDA`.

我的代码在处理`40000x40000`隐式矩阵时工作正常`A`。

但是，当我将大小增加到 时`130000x130000`，它会给出`CUBLAS_STATUS_INTERNAL_ERROR`from`cublasDdot`方法。

有谁知道为什么会发生这种情况以及如何解决它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T19:20:29.247

我解决了这个问题。实际上，这不是由`CUBLAS API`. 当我给求解器提供更大尺寸的矩阵时，求解它需要更长的时间。但是，时间超过了 GPU 看门狗限制，然后求解器被看门狗进程终止。因此，我们购买了一个新的 GPU 作为我们的专用 GPU，并解决了这个问题。@talonmies 感谢您的建议！

# java - getruntime() exec() 命令中带有双引号

> ID：14078799
> 
> 赞同：3
> 
> 时间：2012-12-29T04:50:34.820
> 
> 标签：java, android, ffmpeg

我想执行一个`ffmpeg`命令，我使用的方法适用于我列表中的每个命令，除了以下包含双引号以设置过滤器 (-vf) 参数的命令

```
ffmpeg -i 2012-12-27.mp4 -vf "movie=bb.png [movie]; [in] [movie] overlay=0:0 [out]" -vcodec libx264 -acodec copy out.mp4 
```

我尝试将引号更改为单引号，但没有成功。该命令适用于带有单引号和双引号的 android 终端。

我正在开发的应用程序使用了大约 5 个`ffmpeg`命令，除了这个之外，所有命令都可以工作，这是一些错误吗？

我找不到这个问题的具体解决方案，将 args 分解成一个数组，然后`runtime().exec()`按照其他地方的建议将其传递给它似乎不起作用，或者只是试图用 \" 转义引号是行不通的。

上述命令中引用的两个文件都位于 sdcard 中，我删除了命令的串联，以免事情变得混乱，请放心，当引用文件的完整路径时，这些命令在终端中工作。我使用 stringbuilder 和`getexternalstorageDirectory().getabsolutepath() 将传递给 getRuntime().exec() 的字符串连接起来，以获取每个文件的路径，就像我在使用进程类时使用以前的命令所做的那样。

我正在使用 Jelly Bean 4.2 以防万一。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-29T05:03:04.190

尝试

```
getRuntime().exec( new String[] { "ffmpeg", "-i", "2012-12-27.mp4", "-vf", "movie=bb.png [movie]; [in] [movie] overlay=0:0 [out]", "-vcodec", "libx264", "-acodec", "copy", "out.mp4" } ); 
```

属于一起的参数（例如带引号的 -vf 过滤器字符串）需要位于同一数组元素中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T05:08:49.640

字符串数组不能正常工作？

```
java.lang.Runtime.exec(String[])
java.lang.Runtime.exec(String[], String[], File)

Runtime.exec(new String[]{"ffmpeg","-i","2012-12-27.mp4","-vf",
    "movie=bb.png [movie]; [in] [movie] overlay=0:0 [out]",
    "-vcodec","libx264","-acodec","copy","out.mp4"}); 
```

您应该将所有参数放入一个数组中。

# css - 纯 CSS 下拉菜单：我有基本功能，但是如何让二级 li 项目显示内联而不是相互叠加？

> ID：14078804
> 
> 赞同：3
> 
> 时间：2012-12-29T04:51:44.620
> 
> 标签：css, drop-down-menu, vertical-scrolling

我正在使用这个： http: [//jsfiddle.net/fJSVz/](http://jsfiddle.net/fJSVz/)作为我的基本菜单，它对于底部固定菜单非常有效。也就是说，我需要显示当您将鼠标悬停在菜单上时出现的二级列表项，以显示 ABOVE、CENTERED 和 INLINE（在一行上）而不是一个在另一个之上。有什么线索我需要改变才能让它工作吗？我为此撕毁了我的头发！

```
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>Dropup Demo</title>

<style type='text/css'>
   #navigation {
            width: 980px;
            height: 38px;
            margin-top:100px;
        }
            #navigation li {
                float: left;
                position: relative;
                width:100px;
                border:1px solid red;
            } #navigation li:hover { background: silver; }
                #navigation li a {
                    text-transform: uppercase;
                    color: white;
                    padding: 13px 33px;
                    line-height: 38px;
                    font-size: 11px;

                }
                    #navigation li a:hover { text-decoration: none; }
                    #navigation li ul {
                        position: absolute;
                        display:none;
                        z-index: 1000;
                        min-width: 100%;
                        left:-1px;
                    }
                    #navigation li:hover ul {
                        bottom:20px;
                        display:block;
                        background:#eee;
                    }
                        #navigation li ul li {
                            background: none;
                            width: 100%;
                        }
                            #navigation li ul li:hover {
                                background: none;
                                background-color: #2a51b5;
                            }
                            #navigation li ul li a {
                                text-transform: uppercase;
                                color: white;
                                padding: 8px 10px;
                                line-height: 28px;
                            width: 100%;

                            }
</style>

</head>
<body>
<ul id="navigation">

<li>1</li>

<li>2
<ul>

<li>2.1</li>
<li>2.2</li>
<li>2.3</li>

</ul>
</li>

<li>3</li>

<li>4</li>

</ul> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T04:59:49.403

```
 #navigation li  ul {
                        /*position: absolute;*/
                        display:none;
                        z-index: 1000;
                        min-width: 100%;
                        left:-1px;
                    } 
```

位置`absolute`是它使 ul 位于 that 之上的原因。

这是一个固定的[http://jsfiddle.net/fJSVz/36/](http://jsfiddle.net/fJSVz/36/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T05:22:15.347

它不能是内联的，因为它的宽度=它的父宽度的宽度，所以如果你想让它们成为内联，你需要给第二个 ul 宽度大于它的父级，那么它们的 li 可以在一行上。

所以

```
 #navigation ul li ul{
width:400%; /*  in this case it will be 4*100px */
}

   #navigation ul li ul li{
display:inline-block
} 
```

[这是示例](http://jsfiddle.net/fJSVz/44/)

当父母是相对的，孩子是绝对的，孩子的宽度不能大于它的父母，你需要手动把它放大。

# git - git show - 从历史记录中列出目录的内容

> ID：14078806
> 
> 赞同：2
> 
> 时间：2012-12-29T04:51:57.893
> 
> 标签：git

该命令`git show`非常有用，包括列出目录，但它在列出目录时的输出会导致一些问题。例如，考虑以下内容。

```
user@machine$ git show HEAD:src/
tree HEAD:src/

file0
dir0/
file1
etc/
... 
```

这里的问题是它打印`tree HEAD:src/`和一个空白行。我可以很容易地在空白行上拆分，只获取目录列表，但这似乎不必要地复杂。**我不能使用任何其他系统工具，比如`tr`或类似的。我只能使用git。**

谢谢你们！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T06:26:52.830

尝试`ls-tree`命令：

```
git ls-tree -r --name-only HEAD src/ 
```

`-r`指示`ls-tree`递归并`--name-only`简化输出。

# java - Part 类型中的方法 setText(String) 不适用于参数

> ID：14078816
> 
> 赞同：1
> 
> 时间：2012-12-29T04:54:54.397
> 
> 标签：java, string, methods, settext

我必须开发一个 java 应用程序。

在这里我得到以下错误：

**Part 类型中的方法 setText(String) 不适用于参数 (String, String)**

在这里，我必须通过 settext 将检索的用户名、检索密码发送到我的邮件。我如何在 settext 方法中调用上述 2 个字符串值。请帮助我。我的代码有什么问题。

这是我的代码：

```
 public class SendMail {
      public String authentication(String Product,String Cost){
      String retrievedUserName = "";
      String retrievedPassword = "";
      String retrievedEmail = "";
      String status = "";
      try{
      Class.forName("com.mysql.jdbc.Driver");
      Connection con = DriverManager.getConnection("jdbc:mysql://localhost:3306/xcart-432pro","root","");

      PreparedStatement statement =  con.prepareStatement("SELECT xcart_products.product,xcart_products.list_price,xcart_customers.email FROM xcart_products,xcart_customers WHERE product = '"+Product+"'");
      ResultSet result = statement.executeQuery();
      while(result.next()){
       retrievedUserName = result.getString("list_price");
       retrievedPassword = result.getString("product");
       retrievedEmail = result.getString("email");
            }
          if(retrievedPassword.equals(Product)){
       status = "The product name is send to your email";
        Properties props = new Properties();
          props.put("mail.smtp.host", "smtp.gmail.com");
         props.put("mail.smtp.socketFactory.port", "465");
        props.put("mail.smtp.socketFactory.class",
        "javax.net.ssl.SSLSocketFactory");
        props.put("mail.smtp.auth", "true");
        props.put("mail.smtp.port", "465");

          Session session = Session.getDefaultInstance(props,
                  new javax.mail.Authenticator() {
                protected PasswordAuthentication getPasswordAuthentication() {
                        new PasswordAuthentication("xxxxx@gmail.com","4242vfgDF!");
                        }
                    });
                   try {

            Message message = new MimeMessage(session);
             message.setFrom(new InternetAddress("krishnaveni.veeman@gmail.com"));
         message.setRecipients(Message.RecipientType.TO,
                    InternetAddress.parse("demo@gamil.com"));
            message.setSubject("Testing Subject");
            message.setText("Dear Friends This is your product name and price"+
                    retrievedPassword,retrievedUserName);

        Transport.send(message);

            System.out.println("Done");

            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T05:00:26.890

尝试指定字符集。我也使用 setContent，但我想 setText 会以同样的方式工作。尝试用这个替换你的 setText 调用：

```
 message.setContent("Dear Friends This is your product name and price "+
                     retrievedPassword+retrievedUserName, "text/html; charset=utf-8"); 
```

# python - 有效地删除 numpy 图像数组的行/列

> ID：14078818
> 
> 赞同：2
> 
> 时间：2012-12-29T04:55:18.447
> 
> 标签：python, image, matlab, image-processing, numpy

我正在尝试从 Numpy 数组表示的图像中删除行或列。我的图像类型为 uint16 和 2560 x 2176。例如，假设我想删除前 16 列以使其成为 2560 x 2160。

我是一个 MATLAB 到 Numpy 的转换，在 MATLAB 中会使用类似的东西：

```
A = rand(2560, 2196);
A(:, 1:16) = []; 
```

据我了解，这会删除现有的列并通过不复制到新数组来节省大量时间。

对于 Numpy，以前的帖子使用过类似`numpy.delete`. 但是，文档很清楚这会返回一个副本，因此我必须将副本重新分配给 A。这似乎会浪费大量时间进行复制。

```
import numpy as np

A = np.random.rand(2560,2196)
A = np.delete(A, np.r_[:16], 1) 
```

这真的和就地删除一样快吗？我觉得我一定是错过了更好的方法，或者不了解 python 在删除过程中如何处理数组存储。

相关以前的帖子：
[有效地删除 NumPy 中](https://stackoverflow.com/questions/7218918/removing-rows-in-numpy-efficiently)
[的行 numpy.delete 的文档](http://docs.scipy.org/doc/numpy/reference/generated/numpy.delete.html)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-29T06:18:24.280

为什么不直接切片呢？在这里，我删除了前 3000 列而不是 16 列，以使内存使用更加清晰：

```
import numpy as np
a = np.empty((5000, 5000)
a = a[:, 3000:] 
```

这有效地减少了内存中数组的大小，可以看出：

```
In [31]: a = np.zeros((5000, 5000), dtype='d')
In [32]: whos
Variable   Type       Data/Info
-------------------------------
a          ndarray    5000x5000: 25000000 elems, type `float64`, 200000000 bytes (190 Mb)
In [33]: a = a[:, 3000:]
In [34]: whos
Variable   Type       Data/Info
-------------------------------
a          ndarray    5000x2000: 10000000 elems, type `float64`, 80000000 bytes (76 Mb) 
```

对于这种大小的数组，切片似乎比您的删除选项快 10,000 倍：

```
%timeit a=np.empty((5000,5000), dtype='d');  a=np.delete(a, np.r_[:3000], 1)
1 loops, best of 3: 404 ms per loop
%timeit a=np.empty((5000,5000), dtype='d');  a=a[:, 3000:]
10000 loops, best of 3: 39.3 us per loop 
```

# git - 如何在提交前撤消 git add

> ID：14078820
> 
> 赞同：35
> 
> 时间：2012-12-29T04:55:35.397
> 
> 标签：git, version-control

> **可能重复：**
> [在提交前撤消 git add](https://stackoverflow.com/questions/348170/undo-git-add-before-commit)

当我在处理我的项目时，我不小心使用以下命令添加了文件

```
git add file 
```

我还没跑

```
git commit. 
```

如何从提交中撤消或删除这些新添加的文件？

请帮忙。

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-12-29T05:11:32.210

`git reset`是字面上的“撤消” `git add`- 它从暂存区域中删除更改。

# linux - 将平均负载作为变量

> ID：14078821
> 
> 赞同：0
> 
> 时间：2012-12-29T04:56:23.800
> 
> 标签：linux

我正在使用 Ruby 设置日志记录脚本，并且在将负载平均值作为变量时遇到了一些困难。我正在使用：

```
uptime | awk '{print $10}' 
```

获取当前的 1 分钟时间戳，但我无法在没有尾随逗号的情况下获取它。我可以稍后编辑字符串，但这似乎效率较低。是否有一个编辑可以简单地`,`从退货中删除？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T05:00:39.353

怎么样：

```
cut -f 1 -d " " /proc/loadavg 
```

该`uptime`命令读取`/proc/loadavg`然后添加逗号。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-11-16T18:33:59.793

[最后](https://github.com/djberg96/sys-cpu)，它也可以通过`/proc/loadavg`.

```
gem install sys-cpu 
```

```
require 'sys-cpu'
puts Sys::CPU.load_avg 
```

...这将为您提供一个不错的数组：`[0.72, 1.14, 1.11]`.

# php - 获取服务的完整配置，包括其参数

> ID：14078826
> 
> 赞同：0
> 
> 时间：2012-12-29T04:57:04.223
> 
> 标签：php, symfony, dependency-injection

`php app/console container:debug`没有提供有关服务的足够信息。

## 1 - 在创建服务的过程中注入了哪些参数？

例如，如果我想知道将哪些参数注入到服务`form.factory`中，是否有此命令？

`php app/console container:debug form.factory`没有给出参数列表。

## 2 - 有没有办法找到服务的位置（意味着它实际被声明的文件）？

它可以是：

*   一个`services.yml`文件
*   一个`services.xml`文件
*   通过`DependancyInjection\Configuration.php`文件

但是哪一个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T10:51:31.807

> 在创建服务的过程中注入了哪些参数？

这还不存在，但是我计划为此为 Symfony2.2 创建一个拉取请求

> 有没有办法找到服务的位置（即实际声明它的文件）？

不，你不会得到这样的功能。代码无法获取文件的位置。

您可以做的是找到声明服务的捆绑包。核心框架中的所有服务都在 SymfonyFrameworkBundle 中声明。您可以在 中找到服务配置`@bundleroot/Resources/config`。该`form.factory`服务位于`@SymfonyFrameworkBundle/Resources/config/form.xml`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-24T10:27:48.857

有一个工具：http: [//jmsyst.com/bundles/JMSDebuggingBundle](http://jmsyst.com/bundles/JMSDebuggingBundle)

它通过转储给定服务的依赖项来部分满足您的需求。但是，它没有说明服务的定义位置。

# listview - 如何在 emacslisp 中做一个显示列表缓冲区

> ID：14078830
> 
> 赞同：2
> 
> 时间：2012-12-29T04:58:39.827
> 
> 标签：listview, emacs, elisp, emacs24

如 magit、dired、elget 和 Emacs 自定义缓冲区以及许多其他模式中所示，在 Emacs 中可以创建可导航列表。

我自己会做一些额外的研究，并会发布更新。

但我想在这里联系 EmacsLisp 社区，看看是否有一种标准方法来执行这些 ncurses 样式接口，特别是一个可导航列表，我将使用 El-Get 作为我试图复制的模型。

如果特性是特定于版本的，则假设 Emacs24。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T12:22:08.983

我会稍微扩展一下 Stefan 的回答。tabulated-list-mode 确实是您正在寻找的。基本上，您使用自己的模式映射定义派生模式。然后，您只需要创建一个缓冲区，切换到您的模式，然后填充 tabulated-list-entries，然后调用 tabulated-list-init-header 和 tabulated-list-print。

您可以使用我的[标记列表](https://github.com/stsquad/emacs-mark-tools/blob/master/mark-tools.el)扩展查看一个简单的使用示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T13:57:37.907

取决于细节，也许`tabulated-list-mode`是一个好的开始。

# jquery - jQuerys .get() 信息和获取链接

> ID：14078837
> 
> 赞同：0
> 
> 时间：2012-12-29T05:01:07.843
> 
> 标签：jquery

我正在尝试获取每个用户在我网站的某个页面上的链接。我必须使用 jQuery，因为我无法访问 php。我有一个脚本，它做了一些事情，哈哈，只是不是我想要它做的......任何有用的提示和支持？

```
$.get('/profile?mode=editprofile');
   var a = $('.subtitle a').html();
   $('dl.left a').html(a); 
```

基本上网址是`/profile?mode=editprofile`，我想从中获取a href，`.subtitle a`然后将其放置在`dl.left a`我说它做某事但不确定的地方。我没有收到控制台错误或任何东西。

如果我做错了什么或者我写错了，我不肯定。

```
<div class="main-head">
  <div class="subtitle">Registration Information - 
   <a href="/u1" target="_blank" style="color:#dedfdf;">View my profile</a>
  </div>
</div> 
```

正如你所看到的，我试图抓住它，`/u1`以便让它适用于所有页面......免费网站给我们的 php 占位符不会在所有页面上工作，只是这些页面仅在配置文件中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T05:08:25.163

您必须从返回的数据中检索 html。像这样的东西应该工作。

```
$.get('/profile?mode=editprofile', function(data) {
   var a = $(this).find('.subtitle').html();
   alert(a);
 }); 
```

# iphone - iPhone视口没有响应 - 网页每次都在左上角缩放

> ID：14078839
> 
> 赞同：2
> 
> 时间：2012-12-29T05:01:44.980
> 
> 标签：iphone, html, css, asp-classic, viewport

我一直在绞尽脑汁试图弄清楚这一点，我在这个网站和其他网站上进行了搜索，并找到了许多解决方案，但都没有任何效果。我已经在许多配置中尝试过视口元标记，我尝试过删除 fb-root div，确保没有 height=100%，等等......似乎没有什么可以让这个页面以全宽和全尺寸打开。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T06:04:29.490

找出问题所在...我逐个文件地检查了文件，只是注意到其中一个 Highslide 文件（mobile.js）中的一小段代码...简单地删除了，现在一切都像我想要的那样工作。

// 添加一个元标记让 iPhone 呈现页面 1:1 hs.createElement('meta', { name: 'viewport', content: 'width=device-width; initial-scale=1.0; maximum-scale= 1.0;' }, null, document.getElementsByTagName('head')[0]);

# java - JComboBox 使用 DefaultComboBoxModel 修改索引

> ID：14078840
> 
> 赞同：1
> 
> 时间：2012-12-29T05:01:47.507
> 
> 标签：java, mysql, swing, jcombobox

我创建了一个`JComboBox`并使用`DefaultComboBoxModel`.

这是代码：

```
DefaultComboBoxModel model = new DefaultComboBoxModel();
PreparedStatement statement = con.prepareStatement("SELECT _fid, fruit_name FROM fruits;");

ResultSet result = statement.executeQuery();
while (result.next()) {
    model.addElement(result.getString(2));
}
comboBox = new JComboBox(model); 
```

我怎样才能`JComboBox`用 的值设置 的索引`_fid`？

我对 Java 和 MySQL 还很陌生，现在我还没有一个可行的想法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T08:21:31.033

> 它仍然是相同的，并且在 Fruit 类上它说 id 未使用。

不正确，我的课程`Item`按我的预期工作，在你的情况下需要更好的帮助，尽快发布[`SSCCE`](http://sscce.org/)，否则这里的一切都是黑暗的，例如，你也可以修改和应用`ItemRenderer`，

```
import java.awt.Component;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.JComboBox;
import javax.swing.JFrame;
import javax.swing.JList;
import javax.swing.SwingUtilities;
import javax.swing.plaf.basic.BasicComboBoxRenderer;

public class SelectedComboBoxID {

    public SelectedComboBoxID() {
        JComboBox comboBox = new JComboBox();
        comboBox.addItem(new Item(1, "-"));
        comboBox.addItem(new Item(2, "Snowboarding"));
        comboBox.addItem(new Item(3, "Rowing"));
        comboBox.addItem(new Item(4, "Knitting"));
        comboBox.addItem(new Item(5, "Speed reading"));
        comboBox.addItem(new Item(6, "Pool"));
        comboBox.addItem(new Item(7, "None of the above"));
        comboBox.setMaximumRowCount(3);
        comboBox.setPrototypeDisplayValue(" None of the above ");
        comboBox.addActionListener(new ActionListener() {

            @Override
            public void actionPerformed(ActionEvent e) {
                JComboBox comboBox = (JComboBox) e.getSource();
                Item item = (Item) comboBox.getSelectedItem();
                System.out.println(item.getId() + " : " + item.getDescription());
            }
        });
        //comboBox.setRenderer(new ItemRenderer());
        JFrame frame = new JFrame("MyComboEg");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.add(comboBox);
        frame.pack();
        frame.setLocationByPlatform(true);
        frame.setVisible(true);
    }

   private class ItemRenderer extends BasicComboBoxRenderer {
        private static final long serialVersionUID = 1L;

        @Override
        public Component getListCellRendererComponent(JList list, Object value,
                int index, boolean isSelected, boolean cellHasFocus) {
            super.getListCellRendererComponent(list, value, index, isSelected, cellHasFocus);
            if (value != null) {
                Item item = (Item) value;
                setText(item.getDescription().toUpperCase());
            }
            if (index == -1) {
                Item item = (Item) value;
                setText("" + item.getId());
            }
            return this;
        }
    }

   private class Item {

        private int id;
        private String description;

        public Item(int id, String description) {
            this.id = id;
            this.description = description;
        }

        public int getId() {
            return id;
        }

        public String getDescription() {
            return description;
        }

        @Override
        public String toString() {
            return description;
        }
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                SelectedComboBoxID selectedComboBoxID = new SelectedComboBoxID();
            }
        });
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T05:16:25.113

使用对象连接您的数据库记录。

```
class Fruit{
    private String id;
    private String name;
    public Fruit(String id,String name){
        this.id=id;
        this.name=name;
    }

    public String toString(){
        return this.name;
    }
}

DefaultComboBoxModel model = new DefaultComboBoxModel();
comboBox = new JComboBox(model);
//
PreparedStatement statement = con.prepareStatement("SELECT _fid, fruit_name FROM fruits;");
ResultSet result = statement.executeQuery();
while (result.next()) {
    model.addElement(new Fruit(result.getString(1),result.getString(2)));
}
close(resultset,statement,con) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-26T22:35:16.373

创建`Item`类后，您将知道如何`id`在组合框中调用关联到项目类：

```
//************************
System.out.print("The ID Associated is :"+((Item)jcbqtype.getSelectedItem()).getId());
//************************ 
```

# python - Python：如何将列表切片为某个值

> ID：14078845
> 
> 赞同：2
> 
> 时间：2012-12-29T05:03:03.273
> 
> 标签：python, list, splice, sieve

我想知道是否有办法将现有列表分割成某个最有可能不在列表中的数字。例如，假设我有：

```
primes = [2,3,5,7] 
```

现在我想测试数字 11 的整洁度。我将通过在 1 + 整数平方根 11 的限制下尝试除以所有素数来做到这一点。因此，一旦元素大于限制，我不会循环遍历列表的所有元素，素数并打破循环，我想知道我是否可以将列表拼接到 Limit 的值。在这种情况下，该值为：

```
1 + int(sqrt(11)) = 1 + 3 = 4 
```

所以我可以遍历`primes[ : up until the value of 4]`or的元素`[2,3]`

我知道一些python，但我不确定如何仅使用列表方法来做到这一点......对于高达数十亿的筛选方法，我可以通过不使用if语句来有效地节省时间......

再次提前感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T05:17:02.240

我不太确定我是否完全理解了这个问题（对不起，如果我没有理解，如果没有帮助，我会删除答案）但也许是[bisect](http://docs.python.org/2/library/bisect.html)模块（它只适用于排序列表，但如果有效，它很漂亮快速）在这种情况下会有所帮助：

```
#!/usr/bin/env python
# -*- coding: utf-8 -*-

import bisect
import math

primes = [2,3,5,7] 
searchedPrime=11
lookedPosition = 1 + int(math.sqrt(searchedPrime)) 

checkUntil = primes[:bisect.bisect_left(primes, lookedPosition)]
print "I just have to check %s positions: %s" % (len(checkUntil), checkUntil) 
```

这输出

```
I just have to check 2 positions: [2, 3] 
```

因此，也许该`sqrt`方法和对[分](http://docs.python.org/2/library/bisect.html)工具的组合将帮助您确定要检查的素数范围。

## 编辑：

哦，看那个...我不知道[sqrt](http://docs.python.org/2/library/math.html#math.sqrt)这个东西适合寻找素数...但是看起来它是...

```
#!/usr/bin/env python
# -*- coding: utf-8 -*-
import bisect
import math

foundPrimes = [] 
def isPrime(number, otherPrimes):
  global foundPrimes
  lookedPosition = 1 + int(math.sqrt(number)) 
  formerPrimes = foundPrimes[:bisect.bisect_left(foundPrimes, lookedPosition)]
  for prime in formerPrimes:
    if prime > 1 and number % prime == 0:
      return False
  return True

def getPrimes(upperLimit):
  for i in range(1, upperLimit):
      if isPrime(i, foundPrimes):
        foundPrimes.append(i)
  return foundPrimes

print "Primes: %s" % getPrimes(1000) 
```

这输出：

```
Primes: [1, 2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71, 73, 79, 83, 89, 97, 101, 103, 107, 109, 113, 127, 131, 137, 139, 149, 151, 157, 163, 167, 173, 179, 181, 191, 193, 197, 199, 211, 223, 227, 229, 233, 239, 241, 251, 257, 263, 269, 271, 277, 281, 283, 293, 307, 311, 313, 317, 331, 337, 347, 349, 353, 359, 367, 373, 379, 383, 389, 397, 401, 409, 419, 421, 431, 433, 439, 443, 449, 457, 461, 463, 467, 479, 487, 491, 499, 503, 509, 521, 523, 541, 547, 557, 563, 569, 571, 577, 587, 593, 599, 601, 607, 613, 617, 619, 631, 641, 643, 647, 653, 659, 661, 673, 677, 683, 691, 701, 709, 719, 727, 733, 739, 743, 751, 757, 761, 769, 773, 787, 797, 809, 811, 821, 823, 827, 829, 839, 853, 857, 859, 863, 877, 881, 883, 887, 907, 911, 919, 929, 937, 941, 947, 953, 967, 971, 977, 983, 991, 997] 
```

...这对我来说看起来很*重要*... **:-)**

**PS**：不要使用那样的代码......这是废话。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T05:15:41.730

`[i for i in primes if i < 4]`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T05:16:19.333

也许`itertools.takewhile`

```
>>> from itertools import takewhile
>>> primes
[2, 3, 5, 7]
>>> b = takewhile(lambda k : k < 4, primes)
>>> b
<itertools.takewhile object at 0x0200F418>
>>> for ele in b:
...     print ele
... 
2
3 
```

`itertools.takewhile`返回一个生成器。在生成器上循环比在列表上循环更快，但请注意，生成器在循环后会耗尽。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-29T05:18:24.470

这是完整的代码：

```
from math import sqrt

primes = []
for i in range(2, maxvalue):
    for p in primes:
        if p < (1 + int(sqrt(i))) and i % p == 0:
            break
    else:
        primes.append(i) 
```

这是更新的防错功能。因为`maxvalue = 100`它输出：

```
[2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71, 73, 79, 83, 89, 97] 
```

我会注意到可能还有其他简短的方法，但我会说这是迄今为止人类可读性最强的方法

# coldfusion - 当记录包含反斜杠 \ 时，CFFORM Format="HTML" 不显示任何内容

> ID：14078846
> 
> 赞同：1
> 
> 时间：2012-12-29T05:03:18.407
> 
> 标签：coldfusion, cfgrid, cfform

我有一个运行 ColdFusion 9 Standard 的 Windows Server 2003 R2。我们使用 CFFORM 和 CFGRID 来显示查询返回的信息。每当一条记录在整个查询记录集中的任何字段中都有一个 \ 时，网格和数据根本不会显示。

在这种特殊形式中，该字段甚至没有使用 cfgridcolumn 映射，也没有使用，但该字段是查询的一部分。即使它没有在 CFGRID 中使用，只要在查询中的任何字段中出现反斜杠就会破坏 cfgrid。

我能够通过不调用数据库中未使用的字段来修复此特定错误，但是，我真的很想知道是什么原因造成的，以及是否有办法修复它而不必担心包含反斜杠的字段。

这是该过程的视频捕获：http: [//screencast.com/t/0NUlwlFMtk6t](http://screencast.com/t/0NUlwlFMtk6t)

# python - Python 3.3 二进制转十六进制函数

> ID：14078848
> 
> 赞同：-3
> 
> 时间：2012-12-29T05:03:53.590
> 
> 标签：python, python-3.x, binary, hex

```
def bintohex(path):
    hexvalue = []
    file = open(path,'rb')
    while True:
        buffhex = pkmfile.read(16)
        bufflen = len(buffhex)
        if bufflen == 0: break
        for i in range(bufflen):
            hexvalue.append("%02X" % (ord(buffhex[i]))) 
```

我正在制作一个函数，它将返回特定文件的十六进制值列表。但是，此函数在 Python 3.3 中无法正常工作。我应该如何修改这段代码？

```
File "D:\pkmfile_web\pkmtohex.py", line 12, in bintohex hexvalue.append("%02X" % (ord(buffhex[i]))) TypeError: ord() expected string of length 1, but int found 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T07:05:06.447

有一个模块:-)

```
>>> import binascii
>>> binascii.hexlify(b'abc')
'616263' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T05:05:41.703

在 Python 3 中，索引`bytes`对象返回整数值；无需致电`ord`：

```
hexvalue.append("%02X" % buffhex[i]) 
```

此外，无需手动循环索引。只需循环`bytes`对象即可。我还修改了它以使用`format`而不是`%`：

```
buffhex = pkmfile.read(16)
if not buffhex:
for byte in buffhex:
    hexvalue.append(format(byte, '02X')) 
```

你甚至可能想制作`bintohex`一个发电机。为此，您可以开始`yield`设置值：

```
yield format(byte, '02X') 
```

# class - LI 中的背景图像未显示

> ID：14078853
> 
> 赞同：1
> 
> 时间：2012-12-29T05:04:59.020
> 
> 标签：class, html-lists, background-image, pixel

我想将一个类的背景图像作为列表项：

```
<ul>
<li> Stuff </li>
<li> More Stuff </li>
<li class= "horizdotted" </li>
</ul> 
```

这是CSS

```
.horizdotted {
background-image: url("images/horizdotted.png");
background-repeat:no-repeat;} 
```

这在任何浏览器中都不起作用……看来我必须在 LI 中至少有一些信息（背景图像除外）。所以，我制作了一个白色像素的 png 并尝试了另一种方法：

```
<ul>
<li> Stuff </li>
<li> More Stuff </li>
<li class= "horizdotted"><img src="images/pixel.png" alt="teeny pixel" /> </li>
</ul> 
```

相同的 CSS。这适用于 Chrome 和 Firefox，但不适用于 IE。对于我的一生，我不能让它在 IE 中工作。如果可以的话请帮忙！！这是第二种方式的 Chrome 中的图像（带有极小的像素）。[东西，更多东西，无序列表中的虚线] [http://www.flickr.com/photos/77703125@N07/8321020892/in/photostream/](http://www.flickr.com/photos/77703125@N07/8321020892/in/photostream/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T05:25:02.323

在css中设置宽度和高度

```
.horizdotted {
  background-image: url("images/horizdotted.png");
  background-repeat:no-repeat;
  width:50px;
  height:50px;
 } 
```

根据您想要的图像大小设置此属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T05:34:24.210

[**用于 IE 的 jsFiddle**](http://jsfiddle.net/8sBdj/)

您需要将内容添加到您的内容`li`中，以便显示一些内容。此外，您的问题中有 li 的语法错误。它缺少右括号`>`符号。在类名的等号后面也有一个空格。

HTML：

```
<ul>
  <li> Stuff </li>
  <li> More Stuff </li>
  <li class="horizdotted">Some stuff to view background.</li>
</ul> 
```

CSS：

```
.horizdotted {
  background-image:url(http://placehold.it/500x17/00ff00);
  background-repeat: no-repeat;
} 
```

* * *

[**用于 IE 的 jsFiddle：无 CSS**](http://jsfiddle.net/8sBdj/1/)

此外，由于它只是您要显示的虚线，因此不需要 CSS：

HTML：

```
<ul>
  <li> Stuff </li>
  <li> More Stuff </li>
  <li>-----------------</li>
</ul> 
```

# mysql - phpMyAdmin 挂在带有多个 SELECTS 的 proc 上

> ID：14078857
> 
> 赞同：3
> 
> 时间：2012-12-29T05:05:20.380
> 
> 标签：mysql, stored-procedures, phpmyadmin, freeze, multiple-resultsets

当我`CALL`在 MySQL 中执行此过程时，它只会显示`LOADING...`甚至冻结我的服务器：

```
delimiter $$
CREATE PROCEDURE MyProc(IN index1 INT, IN count1 INT, IN index2 INT, IN count2 INT)
BEGIN
    SELECT id FROM view1 WHERE column1 IS NULL OR column1 = 1 ORDER BY dateColumn DESC LIMIT index1, count1;
    SELECT id FROM view1 WHERE column2 = 0 ORDER BY column3 DESC LIMIT index2, count2;
END$$
delimiter ; 
```

如果我只有其中一个`SELECT`，它可以工作。

任何人都知道我错过了什么/做错了什么？

提前谢谢了！

**细节**

我正在为 PHP 创建一个 proc，这样我就不必与数据库建立如此多的连接。每个都`SELECT`需要有自己的结果集，并带有列信息，以便在 PHP 中使用。

我需要稍微额外的速度，因为我的网站严重依赖动态分页。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T06:02:22.420

你在做的事情是很明智的。这看起来像是 phpmyadmin 中的一个缺陷，最近可能已修复，其中返回多个结果集的存储过程未得到正确处理。

[http://sourceforge.net/tracker/?func=detail&atid=377408&aid=3474853&group_id=23067](http://sourceforge.net/tracker/?func=detail&atid=377408&aid=3474853&group_id=23067)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T05:30:03.500

试试这个：

```
DELIMITER $$
CREATE PROCEDURE MyProc(IN index1 INT, IN count1 INT, IN index2 INT, IN count2 INT)
BEGIN
    SET @s = CONCAT('SELECT id FROM view1 WHERE column1 IS NULL OR column1 = 1 ORDER BY dateColumn DESC LIMIT ', index1, ', ', count1);
    SET @s1 = CONCAT('SELECT id FROM view1 WHERE column2 = 0 ORDER BY column3 DESC LIMIT ', index2, ', ', count2);
    PREPARE stmt FROM @s;
    PREPARE stmt1 FROM @s1;
    EXECUTE stmt;
    EXECUTE stmt1;
    DEALLOCATE PREPARE stmt;
    DEALLOCATE PREPARE stmt1;
END$$
DELIMITER ; 
```

# c# - 注入具有界面属性和设计原则的界面

> ID：14078858
> 
> 赞同：2
> 
> 时间：2012-12-29T05:05:31.300
> 
> 标签：c#, mvvm

我有一系列类，每个类根据它们的角色有几个依赖项。这些依赖项被注入到构造函数中。一个例子是：

```
public class UserViewModel
{ 
    //...
    public UserViewModel(IDataService dataService,
                         INotificationService notificationService,
                         IDialogService dialogService,
                         INavigationService navigationService)
    {
        this.DataService = dataService;
        this.NotificationService = notificationService;
        this.DialogService = dialogService;
        this.NavigationService = navigationService;
    }
} 
```

如您所见，有几个参数需要设置。我可以编写如下界面：

```
public interface IInteractionService 
{
    public INotificationService NotificationService { get; set; }
    public IDialogService DialogService { get; set; }
    public INavigationService { get; set; }
} 
```

并将注入的 InteractionService 实现一次性传递给 UserViewModel 的构造函数：

```
public UserViewModel(IDataService dataService, 
       IInteractionService interactionService) {} 
```

并像这样使用它：

```
this.InteractionService.NotificationService.Publish(message); 
```

在设计模式/原则方面使用具有接口属性的交互接口是否有任何问题？或者有没有更好的方法来看待它？

感谢您的任何建议...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T05:33:49.637

一般来说，您不应该在内部创建具有不同服务的“上帝”服务。它打破了单一响应原则 (SRP)。

但是我不明白 DI 怎么会针对服务实例向您注入 null ？可能您应该针对创建“上帝”服务来解决此问题吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T05:43:56.063

IMO，构造函数中的依赖注入是通向地狱的一种方式。您能否预测应用程序生命周期内的最终依赖项数量？你真的想每次都修改ctor的代码吗？您真的想一次初始化所有依赖项，而不是延迟初始化吗？

例如，MEF 可以以惰性方式注入私有字段。

您绝对不应该测试空注入值。如果你的 DI 框架本身不能进行这些测试，那么就把它扔掉并使用普通的。

# java - 不能重用方法android OOP

> ID：14078863
> 
> 赞同：3
> 
> 时间：2012-12-29T05:07:19.040
> 
> 标签：java, android, oop

在我的应用程序中，我不能重用我在 ArabicUtility 类中声明的方法。我的意图是使用 Arabicutility 类来排列阿拉伯语文本。因此，我想要的是将字符串传递给我在 Arabicutility 类中声明的方法并进行转换。

我认为这基本上是我对 OOP 知识的一些问题。所以帮我纠正这个。

这是我添加到 Arabicutility 类的方法

```
public void addTranslate(int rid, TextView txt1) {
        String textv = getResources().getString(rid);
        txt1.setText(ArabicUtilities.reshapeSentence(textv));
    //  Typeface typeFace=Typeface.createFromAsset(getAssets(),"fonts/DroidNaskhBold.ttf");
    //  txt1.setTypeface(typeFace);

    } 
```

我不能将此方法声明为静态，因为 getResources() 是非静态的。我必须从 Activity 扩展，因为我使用 android 方法。最初它不是这样定义的。

这就是我尝试在其他活动类中使用上述方法的方式。

```
arbic.addTranslate(R.string.butt18title1, txt1);
arbic.addTranslate(R.string.butt18desc1, txt2); 
```

但是当我运行程序时，当我进行上述活动时它会崩溃。

这是原木猫

```
12-29 10:02:32.561: E/AndroidRuntime(951): FATAL EXCEPTION: main
12-29 10:02:32.561: E/AndroidRuntime(951): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.xxxx.xxx/com.xxxx.xxx.ShowMessageActivity}: java.lang.NullPointerException
12-29 10:02:32.561: E/AndroidRuntime(951):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2059)
12-29 10:02:32.561: E/AndroidRuntime(951):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2084)
12-29 10:02:32.561: E/AndroidRuntime(951):  at android.app.ActivityThread.access$600(ActivityThread.java:130)
12-29 10:02:32.561: E/AndroidRuntime(951):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1195)
12-29 10:02:32.561: E/AndroidRuntime(951):  at android.os.Handler.dispatchMessage(Handler.java:99)
12-29 10:02:32.561: E/AndroidRuntime(951):  at android.os.Looper.loop(Looper.java:137)
12-29 10:02:32.561: E/AndroidRuntime(951):  at android.app.ActivityThread.main(ActivityThread.java:4745)
12-29 10:02:32.561: E/AndroidRuntime(951):  at java.lang.reflect.Method.invokeNative(Native Method)
12-29 10:02:32.561: E/AndroidRuntime(951):  at java.lang.reflect.Method.invoke(Method.java:511)
12-29 10:02:32.561: E/AndroidRuntime(951):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
12-29 10:02:32.561: E/AndroidRuntime(951):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
12-29 10:02:32.561: E/AndroidRuntime(951):  at dalvik.system.NativeStart.main(Native Method)
12-29 10:02:32.561: E/AndroidRuntime(951): Caused by: java.lang.NullPointerException
12-29 10:02:32.561: E/AndroidRuntime(951):  at android.content.ContextWrapper.getResources(ContextWrapper.java:81)
12-29 10:02:32.561: E/AndroidRuntime(951):  at com.xxxx.xxx.ArabicUtilities.addTranslate(ArabicUtilities.java:252)
12-29 10:02:32.561: E/AndroidRuntime(951):  at com.xxxx.xxx.ShowMessageActivity.onCreate(ShowMessageActivity.java:184)
12-29 10:02:32.561: E/AndroidRuntime(951):  at android.app.Activity.performCreate(Activity.java:5008)
12-29 10:02:32.561: E/AndroidRuntime(951):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1079)
12-29 10:02:32.561: E/AndroidRuntime(951):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2023)
12-29 10:02:32.561: E/AndroidRuntime(951):  ... 11 more 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T05:10:52.617

无需声明`addTranslate`为静态即可在非活动类中获取资源，您只需使用非活动类构造函数或在方法中传递当前活动上下文：

```
public void addTranslate(int rid, TextView txt1,Context context) {
        String textv = context.getResources().getString(rid);
        txt1.setText(ArabicUtilities.reshapeSentence(textv));

    } 
```

现在您可以`addTranslate`从 Activity 类调用：

```
arbic.addTranslate(R.string.butt18title1, txt1,Your_Current_Activity.this);
arbic.addTranslate(R.string.butt18desc1, txt2,Your_Current_Activity.this); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-29T05:11:21.407

LogCat 显示 ArabicUtility 中的 Context 无效。尝试使用 TextView 的 Context 代替：

```
public void addTranslate(int rid, TextView txt1) {
    String textv = txt1.getContext().getResources().getString(rid);
    txt1.setText(ArabicUtilities.reshapeSentence(textv));
} 
```

* * *

> 我不得不从 Activity 扩展，因为我使用了 android 方法。最初它没有这样定义。
> 
> 这就是我尝试在其他活动类中使用上述方法的方式。

如果 ArabicUtility 不是*活动*的Activity，那么你不应该扩展 Activity，你应该尝试这样的事情：

```
public class ArabicUtility {
    private Context context;

    public ArabicUtility(Context context) {
        this.context = context;
    }

    ...
    public void addTranslate(int rid, TextView txt1) {
        String textv = context.getResources().getString(rid);
        txt1.setText(ArabicUtilities.reshapeSentence(textv));
    }
} 
```

在您当前的活动中使用：

```
arbic = new ArabicUtility(this);
arbic.addTranslate(R.string.butt18title1, txt1);
arbic.addTranslate(R.string.butt18desc1, txt2); 
```

# java - 在线部署 Java Web 应用程序

> ID：14078865
> 
> 赞同：11
> 
> 时间：2012-12-29T05:07:34.907
> 
> 标签：java, war, web-deployment, cloudbees

我在 Eclipse 上构建了一个 java web 应用程序。但是我在使应用程序上线（即在线部署）方面很天真。我曾尝试使用 Cloudbees，并成功将其部署在 run@cloud 那里，但看不到它实际运行。到目前为止，我还没有购买任何域名，因此我想先在任何免费域名上试用。如果我想让该应用程序上线，我必须遵循的确切步骤是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-29T06:21:12.347

使用红帽 Openshift 云...

Redhat Openshift 是一项基于云的服务，它提供 PAAS（平台即服务），即使用他们的服务器并上传我们的项目。

Redhat Openshift 还提供 MySql、Postgre 和 MongoDB。

它易于理解、易于配置且可自动扩展。

Redhat Openshift 支持：

[https://dl.dropbox.com/u/24576260/Redhat%20Support.png](https://dl.dropbox.com/u/24576260/Redhat%20Support.png)

有 Redhat Openshift - Google App Engine (GAE) 的替代品。但是 GAE 在 Trial Verison 中限制了一些类的使用。

而 Openshift 一直保持开放，任何用户想要他都可以使用和配置它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-29T05:18:20.093

**试试[Jelastic](http://jelastic.com/)。**
他们也有免费试用。
PS：每次都为我工作。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-29T17:30:17.123

如果您已成功部署到 RUN@cloud，那么您的应用程序已经在运行；无需购买自定义域。如果您登录[https://grandcentral.cloudbees.com/](https://grandcentral.cloudbees.com/)并单击“*应用程序*”选项卡，您应该会看到列出的新应用程序；在*新窗口中显示*链接将打开实时网页。（这将是[http://appid.accountid.cloudbees.net/](http://appid.accountid.cloudbees.net/)其中*appid*是您在创建应用程序时选择的任何内容，*accountid*是*risabh85*或任何您的 CloudBees 登录名。）

如果使用 CloudBees SDK，您也可以直接从 Eclipse 加载此页面（使用[http://eclipse.cloudbees.com/](http://eclipse.cloudbees.com/)下载或[http://blog.cloudbees.com/2012/07/getting-started-with- cloudbees-and.html](http://blog.cloudbees.com/2012/07/getting-started-with-cloudbees-and.html)了解更多信息）。配置您的帐户信息，然后打开 CloudBees 视图（可从 CloudBees 工具栏按钮获得），您将看到正在运行的应用程序。上下文菜单项可让您在 Web 浏览器中实时打开选定的应用程序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-29T05:25:21.593

试试谷歌应用引擎。您可以部署您的 Web 应用程序，您将获得一个免费的子域。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-29T06:08:44.220

由于我对这样的工作知之甚少，因此非常容易。这是为了通知您它的工作原理就像您自己的电脑一样。在我上一家公司，他们有一台 Windows 服务器。Tomcat 和 MySQL 已预先安装在该服务器上。我只是将我`.war`的放在正确的位置并导入空白数据库..它开始工作:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-12-16T23:11:29.150

查看我关于使用Cloudbees从头开始​​创建 Web 服务的[博客文章。](http://amirzucker.wordpress.com/2012/11/04/online-service-development-in-java-a-beginners-guide/)这是一个包含 7 篇文章的系列文章，其中包含您启动和运行服务所需的一切（包括一个开源代码库，其中几乎所有您需要的东西都已集成）

如果您只想要最快的方法，请查看[此 youtube 视频](http://www.youtube.com/watch?v=hnCNJ5IYWFM)。

# mysql - 通过 SSH 使用 Apache jmeter for MySQL

> ID：14078866
> 
> 赞同：1
> 
> 时间：2012-12-29T05:07:40.420
> 
> 标签：mysql, amazon-web-services, jmeter

我们有一个托管在 Amazon Web 服务上的 Web 应用程序。我们在 EC2 上使用 MySQL 实例。

我想在运行 MySQL 的 EC2 上对数据库进行压力测试。要连接到它，需要使用 SSH。我可以通过腻子连接到它。但我不知道如何使用 jmeter 在这个数据库上运行查询。

如何在 jmeter 测试计划中通过 SSH 连接到 MySQL 实例？

我试过 jmeter-ssh 采样器，但它只通过 SSH 运行 SSH 命令。我猜对我来说没用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T20:10:06.797

我想你可以通过 ssh 隧道做到这一点。这里有一个通过 ssh 隧道运行 jmeter 的简短教程：

[http://blog.ionelmc.ro/2012/02/16/how-to-run-jmeter-over-ssh-tunnel/](http://blog.ionelmc.ro/2012/02/16/how-to-run-jmeter-over-ssh-tunnel/)

# html - 上传仅具有 publish_actions 权限的照片

> ID：14078867
> 
> 赞同：2
> 
> 时间：2012-12-29T05:07:44.470
> 
> 标签：html, facebook, facebook-opengraph

我见过一些应用程序只要求访问`users_photos`and `publish_actions`（不是`publish_stream`or `photo_upload`）。他们能够以某种方式上传照片，我认为甚至没有被批准用于用户生成的照片（即：Instagram）。

这些应用程序如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T16:35:44.020

当您推送一个操作（您可以使用 publish_actions 权限）时，来自该操作的对象可以包含一个图像（通过 og:image）。如果是这样，则图像会显示在用户的时间线和他的朋友的新闻源上。但是，图像更小，就像您通过 publish_stream 或 photo_upload 发布的一样）。

# php - 将“流行”因素与 zend-search lucene 正确集成的最佳方法是什么？

> ID：14078868
> 
> 赞同：4
> 
> 时间：2012-12-29T05:07:56.373
> 
> 标签：php, algorithm, zend-search-lucene, popularity, scoring

我已经阅读[了这篇](http://framework.zend.com/manual/1.12/en/zend.search.lucene.extending.html#zend.search.lucene.extending.scoring)文章，但我仍然对如何去做这件事有些困惑。

我有一个未编入索引的字段，它正在计算一组正在搜索的播放列表的投票数。主搜索工作正常，但我也想将投票字段作为算法的一部分包含在内，我不确定如何将非索引字段包含在其中。任何人都可以提供任何指导或示例吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T14:50:50.323

您不必一定要调整评分算法（顺便说一句，它实现了[tf-idf](http://en.wikipedia.org/wiki/Tf%E2%80%93idf)）。

如果您只是想将视图数量整合到评分计算中，您可以在将搜索文档添加到索引之前“提升”搜索文档，例如：

```
$doc = new Zend_Search_Lucene_Document();
$boostFactor = 0.1;
$doc->boost = (float)$numberOfVotes * $boostFactor;
// ..
$index->addDocument($doc);
$index->commit(); 
```

此示例中的提升因子并不真正相关，因为您只有一个提升标准。如果你想提升非线性，你也可以在 $numberOfVotes 上使用[exp](http://php.net/manual/de/function.exp.php)或[sqrt 。](http://php.net/manual/de/function.sqrt.php)

但另一个问题：

为什么不首先使用[ElasticSearch](http://www.elasticsearch.org/)（或其他高性能搜索引擎）？

例如，ElasticSearch 比 Zend Lucene 的 PHP 实现更强大、更快速。另外，它很容易与评分机制挂钩，例如[http://www.elasticsearch.org/guide/reference/query-dsl/custom-score-query.html](http://www.elasticsearch.org/guide/reference/query-dsl/custom-score-query.html) 您可以使用像[Elastica](https://github.com/ruflin/Elastica)这样的 PHP 客户端。

# php - 查找不同的数字 PHP

> ID：14078870
> 
> 赞同：-8
> 
> 时间：2012-12-29T05:08:29.540
> 
> 标签：php

我有字符串

> $a = '123456789';

它是什么公式，所以它可以给出字符串中有 9 个不同数字的结果。

如果我有

> $a = '111222333444';

所以结果应该是

> 4

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-29T05:18:09.967

为你写了一个快速函数：

```
function unique_chars($string) {
    return strlen(count_chars($string, 3));
} 
```

**用法：**

```
echo unique_chars('111222333444'); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-29T05:12:09.497

```
$str = '123456789';
$parts = str_split( $str );
$unique = array_unique( $parts );
$uniqueCount = count( $unique ); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T05:17:44.800

```
$myString = '1111222334';
$uniqueDigits = 0;
for ($i = 0; $i < 10; $i++)
    if (FALSE !== strpos($myString, strval($i)))
        $uniqueDigits++; 
```

的`$uniqueDigits`值为`4`。

# java - 白色背景上图像的边缘检测

> ID：14078874
> 
> 赞同：1
> 
> 时间：2012-12-29T05:09:08.513
> 
> 标签：java, image, image-processing, edge-detection

我有一个白色背景上的图像。是否可以用纯色填充对象，以便 Canny Edge 仅检测边界而不检测不必要的线条？或者有没有更简单的算法来检测物体的轮廓？我见过一些用于图像处理的库，例如 JavaCV。但我还没有尝试过。你有什么建议吗？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T18:56:38.853

`Photoshop`各种图形库中的边缘检测与或做的边缘检测工具`Photopaint`一样。如果你不想真正的轮廓检测，你需要在它上面实现复杂的人工智能逻辑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T18:36:12.057

只需在图像上做一个**阈值**，去掉白色部分。然后你最终得到一个二进制图像。然后，您可以根据需要申请 Canny。

# kendo-ui - 如何使用它的 ASP MVC Complete Wrapper 设置 KendoUI Grid 的高度

> ID：14078875
> 
> 赞同：5
> 
> 时间：2012-12-29T05:09:12.253
> 
> 标签：kendo-ui

我将 KendoUI Grid 与它的 ASP MVC Complete Wrapper 库一起使用，并且在剃刀代码中设置网格的高度时遇到问题。我尝试设置 HTMLAttribute 但似乎不起作用。

```
@(Html.Kendo().Grid<SoftInn.Data.Country>()
    .Name("grid-countries")
    .DataSource(datasource => datasource.Ajax()
                                .Model(model => model.Id(record => record.Id))
                                .Create(create => create.Action("Add", "Country"))
                                .Read(read => read.Action("GetAll", "Country"))
                                .Update(update => update.Action("Update", "Country"))
                                .Destroy(delete => delete.Action("Delete", "Country"))
                                .Events(events =>
                                            {
                                                events.Sync("gridcountries_synchandler");
                                                events.Error("gridcountries_errorhandler");
                                            })
                                .PageSize(10)                                   
    )
    .Columns(columns =>
                {
                    columns.Bound(r => r.Name);
                    columns.Bound(r => r.Currency);
                    columns.Bound(r => r.TimeZone);
                    columns.Command(command => { command.Edit(); command.Destroy(); }).Width(170);
                })
    .ToolBar(toolbar =>
                 {
                     toolbar.Create().Text("Add New Country");                            
                     toolbar.Custom().Text("Refresh").Url("#").HtmlAttributes(new { onclick = "window.refreshGrid($(this).parent().parent())", @class = "customRefreshButton" });

                     toolbar.Custom().Text("More").Url("#").HtmlAttributes(new { onclick = "window.toggleDisplay($('#grid-countries > .k-grouping-header'))", @class = "customToggleButton float-right" });                         
                 }
    )
    .Editable(editable => editable.Mode(GridEditMode.InLine))
    .Pageable(pageable =>
                {
                    pageable.Refresh(true);
                    pageable.PageSizes(true);
                })
    .Resizable(resize => resize.Columns(true))
    .Reorderable(reorder => reorder.Columns(true))
    .Sortable()
    .Scrollable()
    .Filterable()
    .Selectable()
    .ColumnMenu()
    .Groupable()
    .HtmlAttributes(new { Height = "400px"})  
  ) 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-29T08:59:34.483

尝试以下操作：

```
.HtmlAttributes(new { style = "height:400px" }) 
```

当前设置不起作用，因为它不是Kendo Grid 正在呈现的元素`Height`的有效 HTML 属性。`DIV`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-08-14T11:24:36.880

我知道这个问题已经很老了，但它可能对其他人有所帮助。

```
 .Scrollable(src => src.Height(230)) 
```

这也可以解决问题。

# javascript - 单个页面上的多个 Javascript 小部件

> ID：14078880
> 
> 赞同：1
> 
> 时间：2012-12-29T05:11:30.667
> 
> 标签：javascript, jquery, jquery-ui, widget

您好所有 Javascript 和 Widget 专家。

在过去的两天里，我一直在挠头，试图弄清楚如何启用我的小部件，以便它可以两次包含在同一页面上。

这是我所做的

1.driver.js（加载所有需要的）加载jquery，jquery-ui，wdcreate.js，通过document.write调用设置tabs.js。

2.wdcreate.js（创建标签列表和内容）没什么复杂的，只是一个ui和li列表来创建3个标签内容分配给wHTML，然后通过加载内容

```
document.getElementById(tabid+"_mywidget_container").innerHTML = wHTML; 
```

3.settabs.js（理想情况下应该启用标签）只有一行来加载标签容器

```
$(document).ready(function() {$( "#"+tabid+"_mywidget_container" ).tabs();}); 
```

4.index.html -（包含小部件的测试页面）该页面仅包含两个小部件

```
<script type='text/javascript'> 
    var tabid='001';
    document.write('<scr'+'ipt type="text/JavaScript" src="http://localhost:8080/demo/driver.js"></scr'+'ipt>'); 
    </script>
    <div id="001_mywidget_container"></div>

<script type='text/javascript'> 
var tabid='002';
document.write('<scr'+'ipt type="text/JavaScript" src="http://localhost:8080/demo/driver.js"></scr'+'ipt>'); 
</script>
<div id="002_mywidget_container"></div> 
```

现在的问题是，如果我在 index.html 文件中只包含一个小部件，则会呈现选项卡，如果我为此包含两个或三个小部件，它会失败..

有什么建议或我必须做什么？我已经尝试搜索并隔离这个小项目的问题，最初是使用纯 javascript 并恢复为 jQuery（我不是专家 Javascript 程序员）。意识到这与 window.onLoad 有关系

另请注意，在 settabs 中，如果我对每个 tabwidget id 使用两个调用，而不是动态分配 tabid，它会加载两个 tab 容器。

一个页面上可以有多个小部件，例如一个选项卡容器以显示一个主题的信息，另一个选项卡容器用于另一个主题等。因此，希望拥有一个可以显示 6 个主题信息的页面的用户将包括 6 个小部件/选项卡容器同一页...

感谢您的所有帮助。再次感谢。

这里还有页面

```
http://www.werindia.com/demo/index1.html - widget included one time
http://www.werindia.com/demo/index2.html - widget included two times. in reality this could be any non zero number 

http://www.werindia.com/demo/driver.js
http://www.werindia.com/demo/wdcreate.js
http://www.werindia.com/demo/settabs.js 
```

这是带有静态容器的页面——但实际上这些是动态的

```
http://www.werindia.com/demo/index3.html 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T07:32:02.077

好吧，下面的事情是没有意义的。

*   您已经将实现代码和您的依赖项混合到一个文件中，并且您正在加载/执行所有文件两次。

*   您不仅仅是通过脚本标签链接两次。出于某种原因，您觉得有必要使用 document.write

*   现在是 2012 年，您正在使用 document.write

*   您有一些常见的选项卡功能，您想要访问两个 div 容器，并且出于某种原因，您使用的是 ID 而不是类。看起来 ID 可能会确定在您的 tabs.js 中构建了哪些选项卡，但我只能假设，因为您没有显示该代码。

我们不会重新附加脚本标签来使相同的事情在 JavaScript 中发生两次。我们两次触发函数。或者我们在更一般的 DOM 元素类别中触发正确的函数。

如果以下是在这些容器中构建选项卡所需的全部内容：

```
$(document).ready(function() {$( "#"+tabid+"_mywidget_container" ).tabs();}); 
```

那么这将更有意义：

```
$(document).ready(function() {$( ".tab_container" ).tabs();}); 
```

如果您不知道 HTML 中需要包含哪些内容才能`.tab_container`正常工作，我认为您需要放下所有这些并比您更深入地学习基础知识。尽量让你的 JS 与 HTML 完全分离。在页面底部链接一次您的文件。了解 DOM API 或至少了解 jQuery 的工作原理。尝试将 JS 视为对 HTML 的操作，而不是在解析时简单地编写它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T07:08:04.220

正确放置您的 driver.js 文件路径，它指向 localhost ，将其更改为[http://www.werindia.com](http://www.werindia.com)

使用下面的代码生成脚本标签

```
var headID = document.getElementsByTagName("head")[0];         
var newScript = document.createElement('script');
newScript.type = 'text/javascript';
newScript.src = 'http://www.somedomain.com/somescript.js';
headID.appendChild(newScript); 
```

# java - 鼠标拖动时绘制线条的问题

> ID：14078882
> 
> 赞同：4
> 
> 时间：2012-12-29T05:12:01.713
> 
> 标签：java, graphics, applet, awt, java-2d

我正在开发一个绘制不同形状的绘图小程序。我想在拖动鼠标时画线。问题是当线条出现时，它们如下图所示。

![在此处输入图像描述](../Images/461c18c46d813dbfc922c2d5dff49d67.png)

我有使用一个点（起点）构造的类线，它有一个名为的方法，该方法`setDragPoint`采用鼠标拖动点以便在拖动时绘制线条，并且`drawingImage`在拖动模式下绘制时会产生太多闪烁。为什么会这样？

```
import java.applet.*;
import java.awt.event.*;
import java.awt.*;
import java.util.*;

public class PaintBrush extends Applet implements MouseListener, MouseMotionListener {

Shape shape;
Point startPoint;
Point dragPoint;
ArrayList<Shape> shapes;
Choice shapeChoice;
Choice colorChoice;
Choice fillChoice;
Image drawingImage;
Graphics drawGraphics;
String shapeString, colorString, fillString;
boolean isDragMode;

public void init() {
    shapes = new ArrayList<Shape>();
    shapeChoice = new Choice();
    shapeChoice.addItem("Line");
    shapeChoice.addItem("Rectangle");
    shapeChoice.addItem("RoundRect");
    shapeChoice.addItem("Oval");
    shapeChoice.addItem("FreeHand");

    add(shapeChoice);

    colorChoice = new Choice();
    colorChoice.addItem("Red");
    colorChoice.addItem("Green");
    colorChoice.addItem("Blue");

    add(colorChoice);

    fillChoice = new Choice();
    fillChoice.addItem("Filled");
    fillChoice.addItem("Hollow");
    add(fillChoice);

    shapeString = shapeChoice.getSelectedItem();
    colorString = colorChoice.getSelectedItem();
    fillString = fillChoice.getSelectedItem();

    drawingImage = createImage(getSize().width, getSize().height);
    drawGraphics = drawingImage.getGraphics();
    System.out.println("set up image");
    drawGraphics.setColor(Color.black);
    drawGraphics.fillRect(0, 0, getSize().width, getSize().height);
    drawGraphics.setColor(Color.orange);
    drawGraphics.drawRect(0, 0, getSize().width - 1, getSize().height - 1);
    drawGraphics.drawRect(1, 1, getSize().width - 3, getSize().height - 3);
    startPoint = new Point(0, 0);
    dragPoint = new Point(0, 0);
    addMouseListener(this);
    addMouseMotionListener(this);
}

public void mouseEntered(MouseEvent e) {
}

public void mouseExited(MouseEvent e) {
}

public void mouseClicked(MouseEvent e) {
}

public void mousePressed(MouseEvent e) {

    System.out.println("Pressed");

    startPoint.x = e.getX();
    startPoint.y = e.getY();
    repaint();

    switch (shapeString) {
        case "Line":
            shape = new Line(startPoint.x, startPoint.y);  //step 1 here i construct a new line using the start point (the point at which the mouse is pressed)

            break;
        case "FreeHand":
            shape = new FreeShape();
            break;
    }

    }

public void mouseReleased(MouseEvent e) {
    if (isDragMode) {
        shapes.add(shape);
        isDragMode = false;
     }
    repaint();

}

public void mouseMoved(MouseEvent e) {
}

public void mouseDragged(MouseEvent e) {
    System.out.println("Dragged");
    isDragMode = true;
    dragPoint.x = e.getX();
    dragPoint.y = e.getY();

    switch (shapeString) {
        case "Line":
            shape.setDragPoint(dragPoint.x, dragPoint.y);  //here i set the drag points to the already created line at step 1 
              break;
        case "FreeHand":
            shape = new FreeShape();
            break;
    }

    shape.drawWhileDragging(drawGraphics); // i call this method to draw while mouse is dragging

    repaint();

}

public void paint(Graphics g) {

  update(g);
}
 public void update(Graphics g) {

  // create an off-screen graphics drawing environment if none
  //existed
  // or if the user resized the applet drawing area to a different
 // size
   if (drawingImage == null)
{

System.out.println("Image is Null");
    drawingImage = createImage(getSize().width,getSize().height);
drawGraphics = drawingImage.getGraphics();
}

  // erase the previous image
  drawGraphics.setColor(Color.black);
  drawGraphics.fillRect(0,0,getSize().width,getSize().height);
  drawGraphics.setColor(Color.orange);
  drawGraphics.drawRect(0,0,getSize().width-1,getSize().height-1);
  drawGraphics.drawRect(1,1,getSize().width-3,getSize().height-3);  

   for(Shape s:shapes)
         s.draw(drawGraphics);

  // paint the offscreen image to the applet viewing window
  g.drawImage(drawingImage,0,0,this);

   }
 }

abstract class Shape {

Color shapeColor;
boolean filled;

abstract void draw(Graphics g);

void drawWhileDragging(Graphics g) {
}

void setDragPoint(int x, int y) {
}
}

 class Line extends Shape {

private Point startPoint;
private Point currentPoint;

public Point getStartPoint() {
    return startPoint;
}

public Point getCurrentPoint() {
    return currentPoint;
}

public void setStartPoint(Point point) {
    this.startPoint = point;
}

public void setCurrentPoint(Point point) {
    this.currentPoint = point;
}

void drawWhileDragging(Graphics g) {
    g.drawLine(startPoint.x, startPoint.y, currentPoint.x, currentPoint.y); 
}

public void draw(Graphics g) {
    g.drawLine(startPoint.x, startPoint.y, currentPoint.x, currentPoint.y);
}

Line() {
    startPoint = new Point(0, 0);
    currentPoint = new Point(0, 0);
}

Line(int x1, int y1) {
    this();
    this.startPoint.x = x1; 
    this.startPoint.y = y1;
}

void setDragPoint(int x, int y) {
    this.currentPoint.x = x;
    this.currentPoint.y = y;
    System.out.println("Current-X:" + currentPoint.x + " currentPoint-Y" + currentPoint.y);
    System.out.println("start-X:" + startPoint.x + " startPoint-Y" + startPoint.y);
  }

 }

class FreeShape extends Shape {

private ArrayList<Point> dragPoints = new ArrayList<Point>();

public ArrayList<Point> getDragPoints() {
    return dragPoints;
}

public void setDragPoints(Point point) {
    dragPoints.add(point);
}

public void draw(Graphics g) {
}

public FreeShape() {
  }
}

class Rectangle extends Shape {

public void draw(Graphics g) {
   }
 }

class Oval extends Shape {

public void draw(Graphics g) {
   }
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T06:01:32.007

我最近写了一个类似类型的应用程序。这是屏幕截图。如您所见，它尚未完全开发。![在此处输入图像描述](../Images/ef1df48d246cac30e7f30830f4cbb6af.png)

现在，我也遇到了与您现在面临的类似问题。你要做的是。

*   双缓冲所有绘画操作
*   不要通过调用 repaint 来清除屏幕。`Repaint`实际上首先用背景颜色填充屏幕，这就是你看到的闪烁。

您可以在`Image`. `Image`每次绘图操作后都会更新。`repaint`因此，与其通过调用您所做的来清除屏幕，不如`Image`在画布上绘制。这就像双缓冲。

**在您的代码中，您`repaint`每次拖动鼠标时都会调用。这就是闪烁的原因。**

* * *

**更新**

我在您新更新的代码中发现的三个主要问题

*   在`drawWhileDragging`方法中，您不会更改线图形上下文绘图颜色。所以这条线实际上是用黑色绘制的，你的背景也是黑色的。结果你什么都看不到。
*   在同样的方法中，您将传递一个图形上下文（即参考）`drawingImage`。结果，这条线实际上是在屏幕外的图像上绘制的，而不是在屏幕上。
*   在`mouseDragged`方法中，您在每次拖动后调用重绘。结果实际上什么也没画

我已经在我的机器上运行了您的代码并进行了必要的更改。我只发布更改的方法以保持简短。

这是更新的`mouseDragged`方法

```
 public void mouseDragged(MouseEvent e) {
        System.out.println("Dragged");
        isDragMode = true;
        dragPoint.x = e.getX();
        dragPoint.y = e.getY();

        switch (shapeString) {
            case "Line":
                shape.setDragPoint(dragPoint.x, dragPoint.y);  //here i set the drag points to the already created line at step 1
                break;
            case "FreeHand":
                shape = new FreeShape();
                break;
        }

        getGraphics().drawImage(drawingImage, 0,0,null); //Added this line
        shape.drawWhileDragging(getGraphics()); // i call this method to draw while mouse is dragging
    } 
```

这是更新的`drawWhileDragging`方法

```
 void drawWhileDragging(Graphics g) {
        g.setColor(Color.ORANGE);
        g.drawLine(startPoint.x, startPoint.y, currentPoint.x, currentPoint.y);
        g.setColor(Color.BLACK);
    } 
```

好吧，我已将颜色设置为橙色。您要做的就是根据`Choice`菜单设置颜色。

您也可以实现类似的类比来绘制其他形状。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T07:16:27.983

您遇到的问题归结为您如何“尝试”执行双缓冲。与其在更新行位置时清除后备缓冲区，不如简单地连续绘制它 - 有点像在黑板上绘制......

相反，您需要清除图形内容并重新应用更新 - 令人惊讶的是，这是`paint`实际操作的一部分，但您从不调用`super.paint`

很少需要覆盖顶级容器，也不应该很少需要覆盖`paint`顶级容器的方法。除此以外，没有双缓冲。

相反，使用类似的东西`JPanel`。

我已经更新了您的示例，不包括颜色。颜色实际上应该由形状保持并在绘制时应用。

```
public class BadPaint06 extends JApplet {

    public void init() {
        setLayout(new BorderLayout());
    }

    @Override
    public void start() {
        add(new PaintPane());
    }

    public class PaintPane extends JPanel implements MouseListener, MouseMotionListener {

        Shape shape;
        Point startPoint;
        Point dragPoint;
        ArrayList<Shape> shapes;
        Choice shapeChoice;
        Choice colorChoice;
        Choice fillChoice;
        Image drawingImage;
        Graphics drawGraphics;
        String shapeString, colorString, fillString;
        boolean isDragMode;

        public PaintPane() {
            shapes = new ArrayList<Shape>();
            shapeChoice = new Choice();
            shapeChoice.addItem("Line");
            shapeChoice.addItem("Rectangle");
            shapeChoice.addItem("RoundRect");
            shapeChoice.addItem("Oval");
            shapeChoice.addItem("FreeHand");

            add(shapeChoice);

            colorChoice = new Choice();
            colorChoice.addItem("Red");
            colorChoice.addItem("Green");
            colorChoice.addItem("Blue");

            add(colorChoice);

            fillChoice = new Choice();
            fillChoice.addItem("Filled");
            fillChoice.addItem("Hollow");
            add(fillChoice);

            shapeString = shapeChoice.getSelectedItem();
            colorString = colorChoice.getSelectedItem();
            fillString = fillChoice.getSelectedItem();

            startPoint = new Point(0, 0);
            dragPoint = new Point(0, 0);
            addMouseListener(this);
            addMouseMotionListener(this);
        }

        @Override
        public void invalidate() {

            drawingImage = null;

            super.invalidate(); 

        }

        public void mouseEntered(MouseEvent e) {
        }

        public void mouseExited(MouseEvent e) {
        }

        public void mouseClicked(MouseEvent e) {
        }

        public void mousePressed(MouseEvent e) {

            startPoint.x = e.getX();
            startPoint.y = e.getY();
            repaint();

            switch (shapeString) {
                case "Line":
                    shape = new Line(startPoint.x, startPoint.y);  //step 1 here i construct a new line using the start point (the point at which the mouse is pressed)

                    break;
                case "FreeHand":
                    shape = new FreeShape();
                    break;
            }

        }

        public void mouseReleased(MouseEvent e) {
            if (isDragMode) {
                shapes.add(shape);
                isDragMode = false;
            }
            repaint();

        }

        public void mouseMoved(MouseEvent e) {
        }

        public void mouseDragged(MouseEvent e) {
            System.out.println("Dragged");
            isDragMode = true;
            dragPoint.x = e.getX();
            dragPoint.y = e.getY();

            switch (shapeString) {
                case "Line":
                    shape.setDragPoint(dragPoint.x, dragPoint.y);  //here i set the drag points to the already created line at step 1 
                    break;
                case "FreeHand":
                    shape = new FreeShape();
                    break;
            }

            repaint();

        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);

            System.out.println("In Paint");
            if (drawingImage == null) {
                drawingImage = createImage(getSize().width, getSize().height);
                drawGraphics = drawingImage.getGraphics();
                System.out.println("set up image");
                drawGraphics.setColor(Color.black);
                drawGraphics.fillRect(0, 0, getSize().width, getSize().height);
                drawGraphics.setColor(Color.orange);
                drawGraphics.drawRect(0, 0, getSize().width - 1, getSize().height - 1);
                drawGraphics.drawRect(1, 1, getSize().width - 3, getSize().height - 3);
                drawGraphics.dispose();
            }

            g.drawImage(drawingImage, 0, 0, this);

            for (Shape shape : shapes) {
                shape.draw(g);
            }

            if (shape != null) {
                shape.drawWhileDragging(g); // i call this method to draw while mouse is dragging
            }

        }
    }

    abstract class Shape {

        Color shapeColor;
        boolean filled;

        abstract void draw(Graphics g);

        void drawWhileDragging(Graphics g) {
        }

        void setDragPoint(int x, int y) {
        }
    }

    class Line extends Shape {

        private Point startPoint;
        private Point currentPoint;

        public Point getStartPoint() {
            return startPoint;
        }

        public Point getCurrentPoint() {
            return currentPoint;
        }

        public void setStartPoint(Point point) {
            this.startPoint = point;
        }

        public void setCurrentPoint(Point point) {
            this.currentPoint = point;
        }

        void drawWhileDragging(Graphics g) {
            if (currentPoint != null) {
                g.drawLine(startPoint.x, startPoint.y, currentPoint.x, currentPoint.y);
            }
        }

        public void draw(Graphics g) {
            if (currentPoint != null) {
                g.drawLine(startPoint.x, startPoint.y, currentPoint.x, currentPoint.y);
            }
        }

        Line() {
            startPoint = new Point(0, 0);
//            currentPoint = new Point(0, 0);
        }

        Line(int x1, int y1) {
            this();
            this.startPoint.x = x1;
            this.startPoint.y = y1;
        }

        void setDragPoint(int x, int y) {
            currentPoint = new Point(x, y);
//            this.currentPoint.x = x;
//            this.currentPoint.y = y;
            System.out.println("Current-X:" + currentPoint.x + " currentPoint-Y" + currentPoint.y);
            System.out.println("start-X:" + startPoint.x + " startPoint-Y" + startPoint.y);
        }
    }

    class FreeShape extends Shape {

        private ArrayList<Point> dragPoints = new ArrayList<Point>();

        public ArrayList<Point> getDragPoints() {
            return dragPoints;
        }

        public void setDragPoints(Point point) {
            dragPoints.add(point);
        }

        public void draw(Graphics g) {
        }

        public FreeShape() {
        }
    }

    class Rectangle extends Shape {

        public void draw(Graphics g) {
        }
    }

    class Oval extends Shape {

        public void draw(Graphics g) {
        }
    }
} 
```

# php - load_class 函数

> ID：14078884
> 
> 赞同：0
> 
> 时间：2012-12-29T05:12:28.187
> 
> 标签：php, class, methods, autoload

我正在尝试创建一个将自动加载类的函数，因此我可以执行以下操作：

```
load_class('Db');
$db->query(); 
```

到目前为止，这是我的代码。它加载文件并成功实例化类，但是当我尝试调用上述方法时，`Call to member function`出现错误。

这是我的代码：

```
function load_class($class) {
    $file = 'classes/' . $class . '.php';

    if (file_exists($file)) {
        include_once($file);

        if (class_exists($class)) {
            $class = new $class();
            return $class;
        }
    }
} 
```

我错过了什么？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T05:18:56.907

为了使您的代码正常工作，请这样做：

```
$db = load_class('Db');
$db->query(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T05:24:55.630

`load_class``Db`如果找到声明，则返回类的实例。

您可能需要这样做：

```
$db = load_class('Db');
if (!$db) {
  throw new Exception('Failed to load db!');
}
$db->query(); 
```

但是，如果你想在你这样做时自动加载类`$db = new Db;`，那么你应该看看***[php 的 autoload](http://php.net/manual/en/language.oop5.autoload.php)***。

例子：

```
function load_class($class) {
    $file = 'classes/' . $class . '.php';
    if (file_exists($file)) {
        include_once($file);
    }
}
spl_autoload_register('load_class'); 
```

# jquery - 轨道图像显示在当前具有透明背景的轨道图像后面

> ID：14078890
> 
> 赞同：1
> 
> 时间：2012-12-29T05:13:26.340
> 
> 标签：jquery, image, carousel, transparent, orbit

如何防止 coffee.jpg 出现在 payme.png 后面？我第一次加载网页时得到的结果是两个图像，但是在我循环浏览它们之后，一旦咖啡.jpg 不再出现在后面。

这是相对的 test.html

```
<div class="container">

    <div id="featured"> 
        <img src="these/payme.png" />      // has transparent background
        <img src="these/coffee.jpg" />     // shows up behind payme.png
    </div>

</div> 
```

和轨道.css

```
.container {
    position: absolute; 
    top: 50%; 
    left: 50%;
    margin: -250px 0 0 -420px; 
}

#featured { 
    width: 850px;
    height: 425px;
    background: rgba(0,0,0,0);
overflow: hidden; 
}

#featured>img,  

#featured>div,

#featured>a { display: none; }

div.orbit-wrapper {
    width: 1px;
    height: 1px;
    position: relative; 
}

div.orbit {
    width: 1px;
    height: 1px;
    position: relative;
    overflow: hidden 
}

div.orbit>img {
    position: absolute;
    top: 0;
    left: 0;
    display: none; 
}

div.orbit>a {
    border: none;
    position: absolute;
    top: 0;
    left: 0;
    line-height: 0; 
    display: none; 
}

.orbit>div {
    position: absolute;
    top: 0;
    left: 0;
    width: 850px;
    height: 425px; 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T14:45:01.973

我以前在使用透明图像时遇到过这个问题，并找到了 3 个选项：

*   只需给幻灯片背景颜色（许多人似乎认为这是最好/唯一的选择）。

*   使用轨道文档中介绍的“优雅加载”方法：http: [//foundation.zurb.com/docs/orbit.php](http://foundation.zurb.com/docs/orbit.php)（我刚刚注意到，奇怪的是那里没有很好地实现......）。

*   尝试一些更老套的解决方案，这些解决方案被许多其他似乎有这个问题的人抛出（谷歌“轨道堆叠图像”等）：

*   [https://github.com/zurb/foundation/issues/228#issuecomment-8174780](https://github.com/zurb/foundation/issues/228#issuecomment-8174780)

*   [https://github.com/zurb/foundation/issues/228#issuecomment-8250138](https://github.com/zurb/foundation/issues/228#issuecomment-8250138)

*   [https://groups.google.com/forum/?fromgroups=#!topic/foundation-framework-/QeWXr6JBprE](https://groups.google.com/forum/?fromgroups=#!topic/foundation-framework-/QeWXr6JBprE)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-20T15:33:15.030

编辑 dollowing 行上的 orbit-1.2.3.css 文件

线路：11 至 15

```
#featured { 
    width: 940px;
    height: 450px;
    /*background: #000 url('orbit/loading.gif') no-repeat center center;*/
    overflow: hidden;
} 
```

在以下行中编辑 jquery.orbit-1.2.3.js 文件。

第 88 到 94 行如下所示：

```
//Set initial front photo z-index and fades it in
slides.eq(activeSlide)
.css({"z-index" : 3})
.fadeIn(function() {
//brings in all other slides IF css declares a display: none
slides.css({"display":"block"})
}); 
```

将其更改为：

```
//Set initial front photo z-index and fades it in
slides.eq(activeSlide)
.css({"z-index" : 3})
.fadeIn(function() {
//brings in all other slides IF css declares a display: none
//slides.css({"display":"block"})
}); 
```

然后转到第 305 行并将其编辑为如下所示：

```
.css({"z-index" : 1, "display" : "none"}); 
```

第 337 行将其更改为：

```
.css({"z-index" : 2, "display" : "none"}); 
```

第 343 行至此：

```
.css({"opacity" : 0, "z-index" : 3 , "display" : "block"}) 
```

第 351 行至此：

```
.css({"left": orbitWidth, "z-index" : 3, "display" : "block"}) 
```

第 357 行至此：

```
.css({"left": -orbitWidth, "z-index" : 3, "display" : "block"}) 
```

第 366 行至此：

```
.css({"top": orbitHeight, "z-index" : 3, "display" : "block"}) 
```

第 372 行至此：

```
.css({"top": -orbitHeight, "z-index" : 3, "display" : "block"}) 
```

第 381 行至此：

```
.css({"left": orbitWidth, "z-index" : 3, "display" : "block"}) 
```

第 390 行至此：

```
.css({"left": -orbitWidth, "z-index" : 3, "display" : "block"}) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-05T22:42:16.023

经历了同样的问题后，我发现解决方案是`left: 0px`在第一张幻灯片上设置轨道 js 附加 css。

```
setupFirstSlide: function () {
  ...
  .css({"z-index" : 3,"left":"0px"})
  ...
} 
```

然后将轨道 CSS 文件更改为：

```
.orbit .orbit-slide {
    max-width: 100%;
    position: absolute;
    top: 0;
    left:-910px;
 } 
```

`-910`是控股 div 的宽度。

对我有用透明的png。

# .net - 如何使用部分类？

> ID：14078895
> 
> 赞同：4
> 
> 时间：2012-12-29T05:14:10.230
> 
> 标签：.net, oop, class, c#-4.0, partial

> **可能重复：**
> [为什么使用部分类？](https://stackoverflow.com/questions/3601901/why-use-partial-classes)

我是部分课程的新手，想知道是否有人可以让我大致了解我为什么要使用它们以及在此过程中我会获得什么优势。

我需要做的是，我将我的数据从**Windows 窗体**保存到多个表中，比如**5 个**表。我想在其他地方重用代码。

我已经创建了一个 DAL 类，现在如何实现这个部分类来保存数据？

提前感谢您的支持..:)

我创造了这样的东西：好用吗？

```
class clsDAL
    {
        public partial class SaveData
        {
            public void SpClient()
            {

            }
        }

        public partial class SaveData
        {
            public void SpCountry()
            {
            }
        }

        public partial class SaveData
        {
            public void SpDuration()
            {
            }
        }

        public partial class SaveData
        {
            public void SpProfile()
            {
            }
        }

        public partial class SaveData
        {
            public void SpWorkload()
            {
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T06:09:42.937

部分类用于将（大）类拆分为两个或多个通常写在单独文件中的较小类。它们不必位于单独的文件中。你可以这样做：

```
public partial class SaveData
{
    public void SpClient()
    {

    }
}

public partial class SaveData
{
    public void SpCountry()
    {

    }
} 
```

在同一个文件中。但这很少有意义。将其分成多个文件会更好。

**做什么的：**

它有时可以帮助将您的代码从单个类分类到单独的块中，即使它们基本上都构成同一类的一部分。在文件中包含`SpClient`功能`SpClient.cs`将帮助您更好地理解该文件中的代码将做什么（类似地`SpCountry`）`SpCountry.cs`..

不过，这很少需要。一种特殊情况是 VS 自动生成设计器代码到单独`designer.cs`的`Form`类中，以防 WinForms。这意味着您不必在应用程序逻辑所在的最重要的类中看到大量不重要的代码（您很可能不会处理这些代码）。所以一个`Form`类看起来像：

```
public partial class Form1 : Form 
```

这也将出现在`designer.cs`。

另一个可能的巧妙用途是：

```
public partial class SaveData : IEquatable<SaveData>
{
    //implement IEquatabale here 
}

public partial class SaveData : IComparable<SaveData>
{
     //implement IComparable here 
} 
```

您也可以拥有静态类的部分类：

```
static partial class Extensions //in StringExtension.cs
{

}

static partial class Extensions //in MathExtension.cs
{

} 
```

您只需要`static`在其中一个类上使用关键字。编译器假定此类型的所有其他部分类都是静态的。换句话说，你可以这样做：

```
static partial class Extensions //in StringExtension.cs
{

}

partial class Extensions //in MathExtension.cs
{
    //which will be static
} 
```

* * *

在您的情况下，我认为没有特殊理由将关注点分成不同的部分类。最好在一节课上写。而且您必须编写代码才能使事情正常进行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T05:22:08.887

'partial' 关键字所做的就是将你的类代码分散到多个文件中。非常适合组织。否则，它就像一堂课。

你可以重用一个类。假设它不是静态的，您可以将其实例化为不同的对象。如果它是静态且可访问的，则可以调用它的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T05:27:12.953

部分类对于将同一个类拆分到多个文件中很有用，它与代码重用无关。您描述的问题是一个典型的 CRUD 操作，您需要将表单字段映射到数据存储中的字段（sql server、xml、文档数据库（无 sql）等）。DAL 是一个很好的开始。只需将您的表单数据保存在 DTO（数据传输对象）中并将其传递给您的 DAL 以保留数据。不要担心部分类，它们很少有用。如果您的类需要跨多个文件拆分并且无法控制地增长，这意味着它们做得太多了。尊重 SRP（单一责任原则），并让您的课程集中注意力。祝你好运！

# ios - 将 Facebook 位置图像作为注释图像放在 MKMapView

> ID：14078898
> 
> 赞同：0
> 
> 时间：2012-12-29T05:15:05.670
> 
> 标签：ios, facebook-graph-api, mkmapview, grand-central-dispatch, mkannotationview

我正在开发一个应用程序，我在其中获取 Facebook 位置并`MKMapView`使用以下方法将它们显示为注释。

```
-(void) connectionDidFinishLoading: (NSURLConnection *) connection
{
latitudeArray = [[NSMutableArray alloc]init];
longitudeArray = [[NSMutableArray alloc]init];
nameArray = [[NSMutableArray alloc]init];
placeImgArray = [[NSMutableArray alloc]init];

[UIApplication sharedApplication].networkActivityIndicatorVisible = NO;

NSDictionary *placesDict = [NSJSONSerialization JSONObjectWithData:empJsonData options:kNilOptions error:nil];
NSLog(@"COUNT = %i",placesDict.count);
NSLog(@"Places Dictionary = %i",[[placesDict objectForKey:@"data"] count]);

if ([[placesDict objectForKey:@"data"]count] >= 2) {
    for (int i = 0; i<= [[placesDict objectForKey:@"data"] count] -1; i++) {
        NSString *latitude = [[[[placesDict objectForKey:@"data"]objectAtIndex:i]objectForKey:@"location"]objectForKey:@"latitude"];

        NSString *longitude = [[[[placesDict objectForKey:@"data"]objectAtIndex:i]objectForKey:@"location"]objectForKey:@"longitude"];
        NSString *name = [[[placesDict objectForKey:@"data"]objectAtIndex:i]objectForKey:@"name"];
        imgURlStr = [[[placesDict objectForKey:@"data"]objectAtIndex:i]objectForKey:@"id"];

        [latitudeArray addObject:latitude];
        [longitudeArray addObject:longitude];
        [nameArray addObject:name];
        [placeImgArray addObject:imgURlStr];
        CLLocationCoordinate2D fbPlace;
        fbPlace.latitude = [latitude doubleValue];
        fbPlace.longitude = [longitude doubleValue];
        Annotation *fbAnno = [[Annotation alloc]init];

        fbAnno.coordinate = fbPlace;
        fbAnno.title = name;
        [mapView addAnnotation:fbAnno];

    }

}

[mapView reloadInputViews];

} 
```

现在我需要获取与这些地方关联的图像并将它们作为注释图像而不是默认图钉。我怎样才能做到这一点 ？？我尝试了以下代码，但应用程序崩溃了。

```
-(MKAnnotationView *)mapView:(MKMapView *)mV viewForAnnotation:(id <MKAnnotation>)annotation
{
MKAnnotationView *pinView = nil;
if(annotation != mapView.userLocation)
{
    static NSString *defaultPinID = @"pin";
    pinView = (MKAnnotationView *)[mapView dequeueReusableAnnotationViewWithIdentifier:defaultPinID];
    if ( pinView == nil )
        pinView = [[MKAnnotationView alloc]
                   initWithAnnotation:annotation reuseIdentifier:defaultPinID];
    pinView = [[[MKPinAnnotationView alloc] initWithAnnotation:annotation
                                               reuseIdentifier:defaultPinID] autorelease];
    UIButton *calloutButton = [UIButton buttonWithType:UIButtonTypeCustom];
    calloutButton.frame = CGRectMake(0, 0, 40, 20);
    calloutButton.backgroundColor = [UIColor whiteColor];
    [calloutButton setTitle:@"Chatin" forState:UIControlStateNormal];
    calloutButton.titleLabel.font = [UIFont fontWithName:@"Arial" size:12];

    calloutButton.titleLabel.textColor = [UIColor blackColor];

    pinView.rightCalloutAccessoryView = calloutButton;

    //pinView.pinColor = MKPinAnnotationColorGreen;
    pinView.canShowCallout = YES;
    //pinView.animatesDrop = YES;

    //////////////// Downloading Place Images from Facebook//////////////////////

    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_BACKGROUND, 0), ^(void) {

        NSString *placeImgURLStr = [NSString stringWithFormat:@"http://graph.facebook.com/%@/picture?type=small",imgURlStr];

        // `imgURlStr` is `NSString` containing `id` of the Facebook place.

        NSData *data0 = [NSData dataWithContentsOfURL:[NSURL URLWithString:placeImgURLStr]];
        UIImage *image = [UIImage imageWithData:data0];

        dispatch_sync(dispatch_get_main_queue(), ^(void) {

            pinView.image = image;
            pinView.hidden =NO;

        });
    });

//////////////////////////////////////////////////////////////////////////////////

}
else {
    [mapView.userLocation setTitle:@"I am here"];
}

return pinView;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T08:21:54.160

您还没有分享您的崩溃消息，所以我不得不猜测它与您在该异步块中使用全局 imgURlStr 的事实有关，而实际上您想使用连接到那个的 imgURlStr注解。为此，您需要创建自己的注释子类并为其提供一个属性来存储 imgURlStr 值。然后，当`viewForAnnotation`被调用时，您将泛型`annotation`转换回您的类（首先检查它是该类而不是用户位置）并检索 imgURlStr。

该行还`pinView = [[[MKPinAnnotationView alloc] initWithAnnotation:annotation reuseIdentifier:defaultPinID] autorelease];`取消了您在前几行中所做的出色工作。不管 pinView 是什么，它都会创建一个新的。你可以完全放弃这条线。

# javascript - 如何调整while循环中的变量范围以匹配CoffeeScript中的所有正则表达式？

> ID：14078901
> 
> 赞同：1
> 
> 时间：2012-12-29T05:16:06.587
> 
> 标签：javascript, regex, node.js, coffeescript, scope

我在coffeescript 中的while 循环有点麻烦。

原始功能如下，[来源是这个答案](https://stackoverflow.com/a/8877261/751969)：

```
// Return all pattern matches with captured groups
RegExp.prototype.execAll = function(string) {
    var match = null;
    var matches = new Array();
    while (match = this.exec(string)) {
        var matchArray = [];
        for (i in match) {
            if (parseInt(i) == i) {
                matchArray.push(match[i]);
            }
        }
        matches.push(matchArray);
    }
    return matches;
} 
```

它按预期工作。我已经通过[js2coffee](http://js2coffee.org/)转换了它，咖啡脚本是：

```
# Return all pattern matches with captured groups
RegExp::execAll = (string) ->

  matches = new Array()
  match = null
  while match = @exec(string) 
    matchArray = new Array()
    for i of match
      matchArray.push match[i]  if parseInt(i) is i
    matches.push matchArray
  matches 
```

编译为：

```
RegExp.prototype.execAll = function(string) {
  var i, match, matchArray, matches;
  matches = new Array();
  match = null;
  while (match = this.exec(string)) {
    matchArray = new Array();
    for (i in match) {
      if (parseInt(i) === i) {
        matchArray.push(match[i]);
      }
    }
    matches.push(matchArray);
  }
  return matches;
}; 
```

结果是：

```
[
  [],
  [],
  [],
  [],
  [],
  [],
  [],
  [],
  []
] 
```

我认为这不起作用，因为变量范围，因为我能看到的唯一区别是这一行：

```
RegExp.prototype.execAll = function(string) {
  var i, match, matchArray, matches; 
```

与原版相比：

```
RegExp.prototype.execAll = function(string) {
    var match = null;
    var matches = new Array();
    while (match = this.exec(string)) {
        var matchArray = []; 
```

请注意如何`matchArray`确定范围...我找不到解决方法，但是当我研究时我发现这些问题[是 CoffeeScript 中遗漏了 `do...while` 循环...？](https://stackoverflow.com/questions/6052946/were-do-while-loops-left-out-of-coffeescript)以及[如何在咖​​啡脚本的特定范围内声明变量？](https://stackoverflow.com/questions/8005505/how-do-i-declare-a-variable-in-a-specific-scope-in-coffeescript)而且我在这里几乎没有想法......除了这个while循环之外，还有任何其他方式将所有与正则表达式匹配（顺便说一句，我已经尝试过`\gm`标志并且它仍然只匹配一个匹配）？或者有没有办法在咖啡脚本中获得这个范围？

整个咖啡脚本代码是：

```
fs = require 'fs'

text = fs.readFileSync('test.md','utf8')

#console.log text

regex = /^(?:@@)(\w+):(.*.)/gm
# Return all pattern matches with captured groups
RegExp::execAll = (string) ->

  matches = new Array()
  match = null
  while match = @exec(string) 
    matchArray = new Array()
    for i of match
      matchArray.push match[i]  if parseInt(i) is i
    matches.push matchArray
  matches

res = regex.execAll text
#console.log regex.exec text
console.log (JSON.stringify(res, null, "  ") ) 
```

有效的Javascript**是**这样的：

```
var fs, regex, res, text;

fs = require('fs');

text = fs.readFileSync('test.md', 'utf8');

regex = /^(?:@@)(\w+):(.*.)/gm;

// Return all pattern matches with captured groups
RegExp.prototype.execAll = function(string) {
    var match = null;
    var matches = new Array();
    while (match = this.exec(string)) {
        var matchArray = [];
        for (i in match) {
            if (parseInt(i) == i) {
                matchArray.push(match[i]);
            }
        }
        matches.push(matchArray);
    }
    return matches;
}

res = regex.execAll(text);

//console.log(regex.exec(text));

console.log(JSON.stringify(res, null, "  ")); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-29T05:25:25.390

实际问题不是你想的那样。实际问题是`==`编译为`===`. 以下是您修复它的方法：

```
# Return all pattern matches with captured groups
RegExp::execAll = (string) ->
  matches = []
  while match = @exec string
    matches.push(group for group in match)
  matches 
```

但是您可能想知道为什么`===`不起作用。因此，我向您介绍：

# 为什么`===`不起作用（在这种情况下）

`parseInt(i) == i`应该确定是否`i`是表示整数的字符串。您可以在 JavaScript 中对几个值进行尝试，看看它是否有效。`parseInt(i)`是一个数字，而`i`是一个字符串。在 JavaScript 中，如果您在`==`字符串和数字上使用，它将隐式强制执行，并且测试将按您预期的那样工作。这种隐式强制转换通常是出乎意料的，因此 CoffeeScript 不允许它发生，因为它没有等效的`==`运算符，将`==`(and `is`) 转换为`===`首先比较类型的运算符。在这种情况下，数字和字符串永远不会相等，因此`if`永远不会满足 ' 条件，因此不会将任何内容推送到数组中。

# php - Mongodb/Couchdb 代替 MySQL（从 PHP 切换到 Node）

> ID：14078912
> 
> 赞同：5
> 
> 时间：2012-12-29T05:17:51.457
> 
> 标签：php, mysql, node.js, mongodb, couchdb

我在后端使用 PHP/MySQL/Solr 并在前端使用 Javascript/jQuery/Backbone 完成了大部分 Web 开发。

我已经编写了一些 Node 应用程序，但使用 MySQL 而不是许多 Node 教程/书籍使用的 Mongodb/Couchdb。你会开始使用 Mongo/Couch 而不是 MySQL，因为大多数开发 Node 的人都在使用它吗？MySQL 似乎对我来说工作得很好，我不清楚切换到 Mongo/Couch 的优势。

现在我正在启动一个站点，其中“前端”应用程序服务器是 PHP/MySQL，而数字处理服务器在 Node.js 中。我坚持使用 PHP 来服务于“前端”的原因是因为我非常喜欢在我的 PHP 框架中进行开发。

选择 Node 的原因是因为会有很多并发任务，空闲/等待时间大约为几秒。这必须是高度可扩展的。

*将存储在数据库中的内容就像您将存储在 MySQL 表中的常用内容一样*

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-29T05:21:03.913

你需要考虑的一些事情——

1.  扩展是我们迁移到 mongoDB 的最重要原因之一。对 MongoDB 进行分片和复制是轻而易举的事。因此，如果您的应用程序需要水平扩展，那么 mongoDB 是您的最佳选择。垂直扩展只能达到你很快就会遇到硬件限制的程度......加上 mysql 上的分片是一个真正的痛苦。
2.  其次是数据库模式。在像我们这样的大多数初创公司中，需求和功能变化非常迅速。因此，在一段时间内，基于 mysql 模式的数据库可能更像是一种束缚，而不是“良好实践”。在这种情况下，没有人关心“良好做法”。因此，如果您需要可扩展的无模式数据库，请考虑使用 mongoDB。
3.  所有这一切都附带一个免责声明，即 mongoDB（和其他 NoSql 解决方案）是 DB 世界中闪亮的新玩具。它们远没有 MySQL 成熟。他们中的大多数人，包括 mongo 都不能很好地处理交易。所以假设你正在构建一个金融交易系统，那么我会告诉你盲目地使用 mysql 作为其 ACID 兼容（阅读 innodb 引擎）。因此，很多这些决定再次取决于您要完成的工作......

**结论：**从[NoSQL 转述](http://bjclark.me/2009/08/nosql-if-only-it-was-that-easy/)

> 真正要指出的是，如果你因为无法选择数据库而无法做出超级棒的东西，那你就做错了。如果你知道mysql，就用它。在您真正需要时进行优化。像 ak/v 商店一样使用它，像 rdbms 一样使用它，但是看在上帝的份上，**构建你的杀手级应用**！这对大多数应用程序都无关紧要。Facebook 仍然大量使用 MySQL。Wikipedia 大量使用 MySQL。FriendFeed 经常使用 MySQL。NoSQL 是一个很棒的工具，但它肯定不会成为你的竞争优势，它不会让你的应用程序变得热门，而且最重要的是，**你的用户不会**对这一切感到厌烦。
> 
> 我将在什么基础上构建下一个应用程序？可能是Postgres。我会使用 NoSQL 吗？也许。我也可能使用 Hadoop 和 Hive。我可能会将所有内容保存在平面文件中。也许我会开始在 Maglev 上进行黑客攻击。我会使用最适合这项工作的东西。如果我需要报告，我不会使用任何 NoSQL。如果需要缓存，我可能会使用 Tokyo Tyrant。如果我需要 ACIDity，我不会使用 NoSQL。如果我需要大量的计数器，我会使用 Redis。如果我需要交易，我会使用 Postgres。如果我有大量单一类型的文档，我可能会使用 Mongo。如果我需要每天编写 10 亿个对象，我可能会使用 Voldemort。如果我需要全文搜索，我可能会使用 Solr。如果我需要对易失性数据进行全文搜索，我可能会使用 Sphinx。

[**太搞笑太相关了，不能再发帖了 - MongoDb 是 Web 规模**](http://www.youtube.com/watch?v=b2F-DItXtZs)

![在此处输入图像描述](../Images/ba917ab98f0eb3b4f60951971d9df86a.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T10:34:11.900

除非您对数据进行大量规范化，以至于多个表上的 IO 成为瓶颈，否则 MySQL 将正常工作。没有理由仅仅因为大多数人都在使用 mongo 和 node.js..

Mongodb/Couchdb/Orientdb 最适合存储大量“文档”对象。如果您的数据可以适合 RDBMS 模式，则您不需要创建文档。据我所见，创建对象的主要延迟来自于填充数据字段。使用 NoSQL DB，您可以一次性获取所有数据，而在规范化的 RDBMS 中，数据字段将从不同的来源填充，从而导致轻微的延迟。当然，您可以使用缓存来改进它。如果你想要 RDBMS 的可扩展性，你可以看看 NuoDB。

由于您的后端应用程序服务器需要可扩展性，因此您还可以查看 vertx。根据基准，它似乎优于节点，但它仍然是非常新的。

# php - 如何在不覆盖php索引的情况下合并数组？

> ID：14078914
> 
> 赞同：1
> 
> 时间：2012-12-29T05:17:59.493
> 
> 标签：php, arrays, multidimensional-array, merge

我有这个数组

```
Array
(
[0] => Array
    (
        [0] => Name
        [1] => Email
        [2] => Address
    )

[1] => Array
    (
        [0] => vanson
        [1] => dhmax@pan.com
        [2] => gurgaon
    )

[2] => Array
    (
        [0] => john
        [1] => 
        [2] => 
    )

[3] => Array
    (
        [0] => sdf
        [1] => sdfsdf
        [2] => sdfsd
    )

) 
```

我想要这个

```
Array
(       [0] => Name
        [1] => Email
        [2] => Address
        [0] => vanson
        [1] => dhmax@pan.com
        [2] => gurgaon
        [0] => john
        [1] => 
        [2] => 
        [0] => sdf
        [1] => sdfsdf
        [2] => sdfsd
  ) 
```

**不覆盖其索引**

或者我想创建动态数组并将相同的索引值放入单个数组中。像这样

```
$arr_1 = array(
                    [0] => Name
                    [1] => vanson
                    [2] => john
                    [3] => sdf
                    )
  $arr_2 = array(
                    [0] => Email
                    [1] => dhmax@pan.com
                    [2] => 
                    [3] => sdfsdf
                    )
   $arr_3 = array(
                    [0] => Address
                    [1] => gurgaon
                    [2] => 
                    [3] => sdfsd
                    ) 
```

数组是根据第一个索引数组的计数创建的。（例如，如果第 0 个索引有 4 个数组，则应创建 4 个数组。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T05:27:48.023

[PHP 数组](http://php.net/manual/en/language.types.array.php)不能有多个具有相同索引的值，因此您的第一个建议是不可能的。

但是，第二个选项可以[`array_map()`](http://php.net/array_map)通过传递一个`null`值作为回调参数来实现。这是一个方便的辅助函数（基于[Tadeck](https://stackoverflow.com/questions/2815162/is-there-a-php-function-like-pythons-zip/8375865#8375865)对另一个问题的出色回答）：

```
function array_transpose( $array ) {
    $array = array_merge( array( null ), array_values( $array ) );
    return call_user_func_array( 'array_map', $array );
}

$columns = array_transpose( $rows ); 
```

（[codepad.org 上的演示](http://codepad.org/eCRSExWN)）

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-29T05:31:55.483

PHP 有一个名为[array_chunk()](http://in1.php.net/array_chunk)的内置函数，你可以像这样使用它-

```
$array = Array(Array(1=>'Name',2=>'Email'),Array(1=>'suresh',2=>'email@gmail.com'));        
echo "<pre>";print_r(array_chunk($array,1,true));
Output-
Array ( [0] => Array ( [0] => Array ( [1] => Name [2] => Email ) ) [1] => Array ( [1] => Array ( [1] => suresh [2] => email@gmail.com ) ) ) 
```

# dojo - Dojo 中的按钮集/按钮栏

> ID：14078919
> 
> 赞同：0
> 
> 时间：2012-12-29T05:18:27.250
> 
> 标签：dojo, buttonbar

我需要向我的用户展示两个选项。

我希望这些是可以点击的大按钮，而不是[RadioButton](http://dojotoolkit.org/reference-guide/1.8/dijit/form/RadioButton.html)，其中的标签通常不是可点击的元素，而只是一个传统的小圆圈来点击。

例如

![在此处输入图像描述](../Images/3d95c28e0149ca6d1568b2b6319ee272.png)

当用户单击每一个时，会使用不同的变量调用一个函数，这样其他一些魔法就可以在我的应用程序的其他地方发生。

我看到[了如何在 jQuery](https://stackoverflow.com/questions/3272663/jquery-ui-object-button-bar-that-works-like-radio-buttons)中做到这一点，所以这将是我的备用计划。

看到我正在尝试学习 Dojo 并且 90% 的应用程序目前是基于 Dojo (1.7) 构建的，我希望在 Dojo 中会有一个类似的组件。

我假设我可以将两个单独的[Dojo 按钮](http://dojotoolkit.org/reference-guide/1.8/dijit/form/Button.html)并排放置，并有一个全局变量 catch，其中一个当前已被最后一次单击，当它有时，确保另一个按钮被禁用，但这听起来并不那么优雅。

**实现选择两个按钮的最佳方法是什么，当单击一个按钮时，另一个按钮将被禁用，并以特定值触发一个函数？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T21:27:26.110

你可以使用这样的东西（注意我没有运行代码）

```
<button data-dojo-type="dijit/form/ToggleButton" id='toggle1' data-dojo-props="iconClass:'dijitCheckBoxIcon', checked: true">
<button data-dojo-type="dijit/form/ToggleButton" id='toggle2' data-dojo-props="iconClass:'dijitCheckBoxIcon', checked: false">​ 
```

这个javascript：

```
​dojo.require('dojo.parser');
dojo.require('dojo.form.ToggleButton');

dojo.ready(function(){
    dojo.parser.parse();
    dojo.connect(dijit.byId('toggle1'),'onChange',function(){
        dijit.byId('toggle2').set('checked',false);
        //what you want to do
    });
    dojo.connect(dijit.byId('toggle1'),'onChange',function(){
        dijit.byId('toggle2').set('checked',false);
        //what you want to do
    }); 
```

});​</p>

请注意，我还没有检查代码，所以它可能需要一些修改

# python - 定义的函数生成未定义的全局名称

> ID：14078920
> 
> 赞同：-1
> 
> 时间：2012-12-29T05:18:44.753
> 
> 标签：python, function

我真的很困惑，我写了这段代码，我试图引入我定义的一些函数，但我没有在某处传递正确的信息。有没有人有任何提示或指示？我不确定如何描述我的问题，但错误是：

```
Traceback (most recent call last):
  File "./test3.py", line 54, in <module>
    bar()
  File "./test3.py", line 26, in disconnectvpn
    child.sendcontrol('c')
NameError: global name 'child' is not defined 
```

我的**固定**程序代码如下所示：

```
def foo():
    child = pexpect.spawn ('./script.sh -arg1')
    child.expect ('(?i)user input:')
    child.sendline ('response')
    return child
def bar(child):
    child.sendcontrol('c')

a = foo()

bar(a) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T05:23:27.063

1.  首先，您需要从中返回子对象`connectvpn()`并捕获它
2.  `disconnectvpn()`使用前需要传入

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T19:08:43.893

您只想将子变量从函数`connectvpn`传递给函数`disconnectvpn()`吗？

您只需要保存返回的变量`connectvpn()`，然后将该变量用作函数中的`disconnectvpn`参数。

例如：

```
a= connectvpn()

print "Establishing connection..." 

time.sleep(10) 

disconnectvpn(a) 
```

告诉我这是不是你的问题。问候

# php - 取消文件上传在 Internet Explorer 中效果不佳

> ID：14078926
> 
> 赞同：0
> 
> 时间：2012-12-29T05:19:19.417
> 
> 标签：php, jquery, html

Internet Explorer 在取消文件上传时给我带来了问题，但在所有其他浏览器中，在取消文件时它不会引起任何问题。

现在在其他浏览器中，如果我上传文件，然后在上传过程中单击“取消”按钮，它将停止文件上传到服务器，显示取消消息，就是这样，没有其他任何事情发生，这很好。

但是在interent explorer中，如果我上传一个文件，然后在上传过程中点击“取消”按钮，它会显示取消消息，但它仍在后台上传文件，这意味着文件将上传到服务器和然后它将显示文件加载成功消息，替换取消消息。

我的问题是，我的代码中的什么导致 Internet Explorer 出现问题，即使我已经取消了上传，它也会继续上传文件。有谁知道如何解决这个问题？

下面是一个包含文件输入以及上传和取消按钮的表单；

```
<form action='imageupload.php' method='post' enctype='multipart/form-data' target='upload_target_image' onsubmit='return imageClickHandler(this);' class='imageuploadform' > 
 Image File: <input name='fileImage' type='file' class='fileImage' /></label><br/><br/><label class='imagelbl'>
 <input type='submit' name='submitImageBtn' class='sbtnimage' value='Upload' /></label>
 <input type='reset' name='imageCancel' class='imageCancel' value='Cancel' /></label>
 <iframe class='upload_target_image' name='upload_target_image' src='#' style='width:0px;height:0px;border:0px;solid;#fff;'></iframe></form> 
```

下面是开始上传文件的函数，其中包含取消函数：

```
 function startImageUpload(imageuploadform){

  $(imageuploadform).find('.imagef1_cancel').css('visibility','visible');
  sourceImageForm = imageuploadform;

        $(imageuploadform).find(".imageCancel").on("click", function(event) {
                  $('.upload_target_image').get(0).contentwindow
              $("iframe[name='upload_target_image']").attr("src", "javascript:'<html></html>'");
               jQuery.ajax("cancelimage.php").done(function(data) {

        return stopImageUpload(2);
    });  

}); 

      return true;
} 
```

以下是上传完成后显示相关消息的代码：

```
 var imagecounter = 0;

function stopImageUpload(success, imagefilename){

      var result = '';
      imagecounter++;

      if (success == 1){
         result = '<span class="imagemsg'+imagecounter+'">The file was uploaded successfully</span>';      
      }
      else if (success == 2){
          result = '<span class="imagemsg'+imagecounter+'"> The file upload was cancelled</span>';
      }
      else {
         result = '<span class="imagemsg'+imagecounter+'">There was an error during file upload</span>';
      }

      $(sourceImageForm).find('.imagef1_cancel').css('visibility','hidden');
      $(sourceImageForm).find('.imagemsg').html(result);
      $(sourceImageForm).find(".fileImage").replaceWith("<input type='file' class='fileImage' name='fileImage' />");

      return true;   
} 
```

下面是上传文件的 imageupload.php 页面：

```
<?php

ini_set('display_errors', 1);
error_reporting(E_ALL);

session_start();

if ($_FILES['fileImage']['error'] === UPLOAD_ERR_OK) {
    $result = 0;

    if (getimagesize($_FILES['fileImage']['tmp_name'])) {
        if ((($_FILES["fileImage"]["type"] == "image/gif") || ($_FILES["fileImage"]["type"] == "image/jpeg") || ($_FILES["fileImage"]["type"] == "image/pjpeg") || ($_FILES["fileImage"]["type"] == "image/jpg")) && ($_FILES['fileImage']['size'] > 0)) {
            if (is_file("ImageFiles/" . $_FILES['fileImage']['name'])) {
                $parts = explode(".", $_FILES['fileImage']['name']);
                $ext   = array_pop($parts);
                $base  = implode(".", $parts);
                $n     = 2;

                while (is_file("ImageFiles/" . $base . "_" . $n . "." . $ext))
                    $n++;
                $_FILES['fileImage']['name'] = $base . "_" . $n . "." . $ext;

                move_uploaded_file($_FILES["fileImage"]["tmp_name"], "ImageFiles/" . $_FILES["fileImage"]["name"]);
                $result = 1;

            }

            else {
                move_uploaded_file($_FILES["fileImage"]["tmp_name"], "ImageFiles/" . $_FILES["fileImage"]["name"]);
                $result = 1;
            }

        }

    }
} else {
    echo "Upload was not successful";
}

?> 

  <script language="javascript" type="text/javascript">window.top.stopImageUpload(<?php
echo $result;
?>, '<?php
echo $_FILES['fileImage']['name'];
?>');</script> 

</body> 
</html> 
```

更新：

以下是您所说的正确：

```
//startImageUpload

    function startImageUpload(imageuploadform){

      $(imageuploadform).find('.imagef1_cancel').css('visibility','visible');
      sourceImageForm = imageuploadform;

            $(imageuploadform).find(".imageCancel").on("click", function(event) {
        $('.upload_target_image').get(0).contentwindow
        $("iframe[name='upload_target_image']").attr("src", "javascript:'<html></html>'");
         $request = $.ajax("cancelimage.php").done(function(data) {

            return stopImageUpload(2);

        });  

    }); 

          return true;
    }

//imageClickHandler

 function imageClickHandler(imageuploadform){ 
      if(imageValidation(imageuploadform)){ 
          window.lastUploadImageIndex = $('.imageuploadform').index(imageuploadform); 
          return startImageUpload(imageuploadform); 
          $request.abort()
      } 
      return false;
  } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T07:12:40.967

看来我错误地认为您使用 ajax 上传图像。现在我看到了完整的代码，我意识到你只是允许表单提交，而 ajax 只是与接收取消的 php 进行通信。这意味着您不能使用 ajax abort 来取消上传。您可以做的是将 iframe 内容替换为 cancelimage.php。我没有测试过这个

```
//startImageUpload

function startImageUpload(imageuploadform){

  $(imageuploadform).find('.imagef1_cancel').css('visibility','visible');

  sourceImageForm = imageuploadform; // not sure what this does

  $(imageuploadform).find(".imageCancel").on("click", function(event) {

    $('.upload_target_image').get(0).contentwindow; // not sure what this is doing....

    $("iframe[name='upload_target_image']").on("load",function() {
      stopImageUpload(2);
    }).attr("src", "cancelimage.php")

  }); 

  return true;
}

//imageClickHandler

function imageClickHandler(imageuploadform){ 
  if(imageValidation(imageuploadform)){ 
      window.lastUploadImageIndex = $('.imageuploadform').index(imageuploadform); 
      return startImageUpload(imageuploadform); 
  } 
  return false;
} 
```

# javascript - Twitter 提要未显示推文

> ID：14078930
> 
> 赞同：-2
> 
> 时间：2012-12-29T05:20:25.240
> 
> 标签：javascript, twitter

在我的网站中，推特提要没有显示推文。但它在本地主机上运行良好。当它上传到服务器时会出现问题。有人可以帮我吗？这是代码

```
<a class="twitter-timeline" width="230" height="300" href="https://twitter.com/myusername" data-widget-id="MY WIDGET ID" >Tweets by @username</a>

 <script>
!function(d,s,id)
{
var js,fjs=d.getElementsByTagName(s)[0];
if(!d.getElementById(id))
{
js=d.createElement(s);j
s.id=id;
js.src="//platform.twitter.com/widgets.js";
fjs.parentNode.insertBefore(js,fjs);
}
}
(document,"script","twitter-wjs");
</script> 
```

我还使用了另一个代码，它可以在服务器上运行，但不显示推文中的图片。它显示了特定图片的链接。这是代码。

```
<script charset="utf-8" src="http://widgets.twimg.com/j/2/widget.js"></script>

<script>
new TWTR.Widget({
         version: 2,
         type: 'profile',
         rpp: 4,
         interval: 2000,
         width: 230, //we've changed our default width, to make it prettier
         height: 300,
         theme: {
               shell: {
                 background: 'transparent', //this is important
                 color: 'rgb(255, 103, 0);'
               },
               tweets: {
                 background: 'transparent', //this is important
                 color: '#aba2a2',
                 links: '#ccc'
               }
         },
         features: {
               scrollbar: false,
               loop: true,
               live: true,
               hashtags: true,
               timestamp: true,
               avatars: true,
               behavior: 'default'
         }

       }).render().setUser('user').start();
</script> 
```

是否有任何设置可以在推文上显示图片？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T05:36:46.483

公共领域需要在时间线配置部分指定 [https://dev.twitter.com/docs/embedded-timelines](https://dev.twitter.com/docs/embedded-timelines)

# android - Android-org.apache.http.NoHttpResponseException：目标服务器响应失败

> ID：14078932
> 
> 赞同：0
> 
> 时间：2012-12-29T05:21:08.407
> 
> 标签：android, android-asynctask

我是 Android 的新人。我正在尝试连接 MySQL 以获取来自 android 应用程序的存储值。但是在连接到我的服务器时遇到问题。请帮助我......？

**错误：org.apache.http.NoHttpResponseException：目标服务器无法响应** 这里是代码：

MainActivity.java

```
package com.example.easyeop;

import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Date;
import java.util.List;

import org.apache.http.NameValuePair;
import org.apache.http.message.BasicNameValuePair;
import org.json.JSONException;
import org.json.JSONObject;

import android.app.Activity;
import android.app.ProgressDialog;
import android.content.Intent;
import android.os.AsyncTask;
import android.os.Bundle;
import android.util.Log;
import android.view.Menu;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemSelectedListener;
import android.widget.ArrayAdapter;
import android.widget.Button;
import android.widget.EditText;
import android.widget.Spinner;
import android.widget.TextView;

public class MainActivity extends Activity implements OnClickListener,OnItemSelectedListener{

    EditText ename;
    String date;
    Spinner category;
    Spinner product;
    Spinner merchant;
    EditText qty;
    Spinner unit;
    EditText rate;
    TextView vals;
    double value;

    JSONParser jsonParser = new JSONParser();
    private Button mSubmit;
    private Button mCancel;
    private String spinner_category[];
    private ProgressDialog pDialog;
    private static String registerURL = "http://223.185.164.105:8080/mywebs/index.php";
    private static String register_tag = "register";

    private static final String TAG_SUCCESS = "success";

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        ename=(EditText) findViewById(R.id.eename);
        category=(Spinner) findViewById(R.id.spinner1);
        product=(Spinner)findViewById(R.id.spinner2);
        merchant=(Spinner)findViewById(R.id.spinner3);
        qty=(EditText)findViewById(R.id.eqty);
        unit=(Spinner)findViewById(R.id.spinner4);
        rate=(EditText)findViewById(R.id.erate);
        vals=(TextView) findViewById(R.id.dvalue);

        mSubmit = (Button) findViewById(R.id.submit);
        mSubmit.setOnClickListener(this);

        mCancel = (Button) findViewById(R.id.cancel);
        mCancel.setOnClickListener(this);

        spinner_category=new String[2];
        spinner_category[0]="Category11";
        spinner_category[1]="Category22";

        ArrayAdapter<String> spinnerCategory = new ArrayAdapter<String>(this,android.R.layout.simple_spinner_item, spinner_category);
        category.setAdapter(spinnerCategory);
        category.setOnItemSelectedListener(this);

        ArrayAdapter<String> spinnerProduct = new ArrayAdapter<String>(this,
                android.R.layout.simple_spinner_item, new String[] {
                        new String("Product1"), new String("Product2") });
        product.setAdapter(spinnerProduct);
        product.setOnItemSelectedListener(this);

        ArrayAdapter<String> spinnerMerchant = new ArrayAdapter<String>(this,
                android.R.layout.simple_spinner_item, new String[] {
                        new String("Ajith"), new String("Piyush") });
        merchant.setAdapter(spinnerMerchant);
        merchant.setOnItemSelectedListener(this);

        ArrayAdapter<String> spinnerUnit = new ArrayAdapter<String>(this,
                android.R.layout.simple_spinner_item, new String[] {
                        new String("KG"), new String("Tons") });
        unit.setAdapter(spinnerUnit);
        unit.setOnItemSelectedListener(this);
    }
    class saveNewData extends AsyncTask<String, String, String>{

        @Override
        protected void onPreExecute(){
            super.onPreExecute();
            pDialog = new ProgressDialog(MainActivity.this);
            pDialog.setMessage("Saving Details...!");
            pDialog.setIndeterminate(false);
            pDialog.setCancelable(true);
            pDialog.show();
        }
        @Override
        protected String doInBackground(String... arg0) {
            // TODO Auto-generated method stub
            System.out.println("Do In Background...");
            String name=ename.getText().toString();
            String cat=category.getSelectedItem().toString();
            String prd=product.getSelectedItem().toString();
            String mer=merchant.getSelectedItem().toString();
            String qt=qty.getText().toString();
            String uni=unit.getSelectedItem().toString();
            String rat=rate.getText().toString();
            Date d=new Date();
            SimpleDateFormat format=new SimpleDateFormat("dd-MM-yyyy");
            date=format.format(d);                  
            // Building Parameters
            System.out.println("bfr building params");
             List<NameValuePair> params = new ArrayList<NameValuePair>();
                params.add(new BasicNameValuePair("tag", register_tag));
                params.add(new BasicNameValuePair("name", name));
                params.add(new BasicNameValuePair("tdate", date));
                params.add(new BasicNameValuePair("category", cat));
                params.add(new BasicNameValuePair("product", prd));
                params.add(new BasicNameValuePair("merchant", mer));
                params.add(new BasicNameValuePair("qty", qt));
                params.add(new BasicNameValuePair("unit", uni));
                params.add(new BasicNameValuePair("rate", rat));

                System.out.println("aftr building params");

             // getting JSON Object
                // Note that save details url accepts POST method
                System.out.println("save details url accepts POST method...");
                JSONObject json = jsonParser.makeHttpRequest(registerURL,
                        "POST", params);
                System.out.println("aftr save details url accepts POST method...");
                // check log cat for response
                Log.d("Create Response", json.toString());
                System.out.println("create response...");
                // check for success tag
                try {
                    int success = json.getInt(TAG_SUCCESS);

                    if (success == 1) {
                        // successfully saved details
                        System.out.println("successfully saved...");
                        Intent i = new Intent(getApplicationContext(), MainActivity.class);
                        startActivity(i);

                        // closing this screen
                        finish();
                    } else {
                        // failed to save details
                        System.out.println("failed to save details...");
                    }
                } catch (JSONException e) {
                    e.printStackTrace();
                }
            return null;
        }

    }
    @Override
    public void onClick(View v) {

        switch (v.getId()) {

        case R.id.cancel:
            Intent i = new Intent(getBaseContext(), MainActivity.class);
            startActivity(i);
            // finish();
            break;          
        case R.id.submit:
                    // TODO Auto-generated method stub
            // creating new product in background thread
            System.out.println("Inside Submit");
            new saveNewData().execute();                
        break;
        }
    }
    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }
    @Override
    public void onItemSelected(AdapterView<?> arg0, View arg1, int arg2,
            long arg3) {
        // TODO Auto-generated method stub      
    }
    @Override
    public void onNothingSelected(AdapterView<?> arg0) {
        // TODO Auto-generated method stub      
    }
} 
```

JSONParser.java

```
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.UnsupportedEncodingException;
import java.util.List;

import org.apache.http.HttpEntity;
import org.apache.http.HttpResponse;
import org.apache.http.NameValuePair;
import org.apache.http.client.ClientProtocolException;
import org.apache.http.client.entity.UrlEncodedFormEntity;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.client.utils.URLEncodedUtils;
import org.apache.http.impl.client.DefaultHttpClient;
import org.json.JSONException;
import org.json.JSONObject;

import android.util.Log;

public class JSONParser {

    static InputStream is = null;
    static JSONObject jObj = null;
    static String json = "";

    // constructor
    public JSONParser() {

    }

    // function get json from url
    // by making HTTP POST or GET method
    public JSONObject makeHttpRequest(String url, String method,
            List<NameValuePair> params) {

        // Making HTTP request
        try {

            // check for request method
            if(method == "POST"){
                // request method is POST
                // defaultHttpClient
                System.out.println("method=post");
//              HttpParams httpParameters=new BasicHttpParams();
//              int timeoutConnection = 3000;               
//              HttpConnectionParams.setConnectionTimeout(httpParameters,timeoutConnection);
//                int timeoutSocket = 5000;
//                HttpConnectionParams.setSoTimeout(httpParameters, timeoutSocket);
                DefaultHttpClient httpClient = new DefaultHttpClient();
                HttpPost httpPost = new HttpPost(url);                
                httpPost.setEntity(new UrlEncodedFormEntity(params));
                HttpResponse httpResponse = httpClient.execute(httpPost);
                HttpEntity httpEntity = httpResponse.getEntity();
                is = httpEntity.getContent();

            }else if(method == "GET"){
                // request method is GET
                DefaultHttpClient httpClient = new DefaultHttpClient();
                String paramString = URLEncodedUtils.format(params, "utf-8");
                url += "?" + paramString;
                HttpGet httpGet = new HttpGet(url);

                HttpResponse httpResponse = httpClient.execute(httpGet);
                HttpEntity httpEntity = httpResponse.getEntity();
                is = httpEntity.getContent();
            }          

        } catch (UnsupportedEncodingException e) {
            System.out.println("UnsupportedEncodingException..."+e);
            e.printStackTrace();
        } catch (ClientProtocolException e) {
            System.out.println("ClientProtocolException..."+e);
            e.printStackTrace();
        } catch (IOException e) {
            System.out.println("IOException..."+e);
            e.printStackTrace();
        }

        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(
                    is, "iso-8859-1"), 8);
            StringBuilder sb = new StringBuilder();
            String line = null;
            while ((line = reader.readLine()) != null) {
                sb.append(line + "\n");
            }
            is.close();
            json = sb.toString();
        } catch (Exception e) {
            Log.e("Buffer Error", "Error converting result " + e.toString());
        }

        // try parse the string to a JSON object
        try {
            jObj = new JSONObject(json);
        } catch (JSONException e) {
            Log.e("JSON Parser", "Error parsing data " + e.toString());
        }

        // return JSON String
        return jObj;

    }
} 
```

日志猫：

```
12-31 11:44:47.718: D/ddm-heap(220): Got feature list request
12-31 11:48:15.258: W/KeyCharacterMap(220): No keyboard for id 0
12-31 11:48:15.258: W/KeyCharacterMap(220): Using default keymap: /system/usr/keychars/qwerty.kcm.bin
12-31 11:48:29.128: I/System.out(220): Inside Submit
12-31 11:48:29.259: I/System.out(220): Do In Background...
12-31 11:48:29.259: I/System.out(220): name :hfdw
12-31 11:48:29.259: I/System.out(220): category :Category11
12-31 11:48:29.259: I/System.out(220): product :Product1
12-31 11:48:29.259: I/System.out(220): merchant :Ajith
12-31 11:48:29.259: I/System.out(220): qty :445
12-31 11:48:29.259: I/System.out(220): unit :KG
12-31 11:48:29.259: I/System.out(220): rate :67
12-31 11:48:30.009: I/System.out(220): date :31-12-2012
12-31 11:48:30.020: I/System.out(220): bfr building params
12-31 11:48:30.239: I/System.out(220): aftr building params
12-31 11:48:30.309: I/System.out(220): save details url accepts POST method...
12-31 11:48:30.318: I/System.out(220): method=post
12-31 11:48:30.580: I/System.out(220): send params
12-31 11:48:30.828: D/dalvikvm(220): GC freed 3512 objects / 211920 bytes in 139ms
12-31 11:48:35.178: D/dalvikvm(220): GC freed 316 objects / 194992 bytes in 114ms
12-31 11:48:39.218: I/System.out(220): IOException...org.apache.http.NoHttpResponseException: The target server failed to respond
12-31 11:48:39.228: E/IO Exception(220): Errorrr
12-31 11:48:39.228: W/System.err(220): org.apache.http.NoHttpResponseException: The target server failed to respond
12-31 11:48:39.290: W/System.err(220):  at org.apache.http.impl.conn.DefaultResponseParser.parseHead(DefaultResponseParser.java:85)
12-31 11:48:39.298: W/System.err(220):  at org.apache.http.impl.io.AbstractMessageParser.parse(AbstractMessageParser.java:174)
12-31 11:48:39.326: W/System.err(220):  at org.apache.http.impl.AbstractHttpClientConnection.receiveResponseHeader(AbstractHttpClientConnection.java:179)
12-31 11:48:39.338: W/System.err(220):  at org.apache.http.impl.conn.DefaultClientConnection.receiveResponseHeader(DefaultClientConnection.java:235)
12-31 11:48:39.348: W/System.err(220):  at org.apache.http.impl.conn.AbstractClientConnAdapter.receiveResponseHeader(AbstractClientConnAdapter.java:259)
12-31 11:48:39.348: W/System.err(220):  at org.apache.http.protocol.HttpRequestExecutor.doReceiveResponse(HttpRequestExecutor.java:279)
12-31 11:48:39.370: W/System.err(220):  at org.apache.http.protocol.HttpRequestExecutor.execute(HttpRequestExecutor.java:121)
12-31 11:48:39.370: W/System.err(220):  at org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:410)
12-31 11:48:39.370: W/System.err(220):  at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:555)
12-31 11:48:39.370: W/System.err(220):  at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:487)
12-31 11:48:39.370: W/System.err(220):  at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:465)
12-31 11:48:39.370: W/System.err(220):  at com.example.easyeop1.JSONParser.makeHttpRequest(JSONParser.java:57)
12-31 11:48:39.370: W/System.err(220):  at com.example.easyeop1.MainActivity$saveNewData.doInBackground(MainActivity.java:159)
12-31 11:48:39.370: W/System.err(220):  at com.example.easyeop1.MainActivity$saveNewData.doInBackground(MainActivity.java:1)
12-31 11:48:39.370: W/System.err(220):  at android.os.AsyncTask$2.call(AsyncTask.java:185)
12-31 11:48:39.370: W/System.err(220):  at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:305)
12-31 11:48:39.370: W/System.err(220):  at java.util.concurrent.FutureTask.run(FutureTask.java:137)
12-31 11:48:39.370: W/System.err(220):  at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1068)
12-31 11:48:39.378: W/System.err(220):  at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:561)
12-31 11:48:39.378: W/System.err(220):  at java.lang.Thread.run(Thread.java:1096)
12-31 11:48:39.378: E/Buffer Error(220): Error converting result java.lang.NullPointerException
12-31 11:48:39.388: E/JSON Parser(220): Error parsing data org.json.JSONException: A JSONObject text must begin with '{' at character 0 of 
12-31 11:48:39.398: I/System.out(220): aftr save details url accepts POST method...
12-31 11:48:39.431: W/dalvikvm(220): threadid=17: thread exiting with uncaught exception (group=0x4001b188)
12-31 11:48:39.439: E/AndroidRuntime(220): Uncaught handler: thread AsyncTask #1 exiting due to uncaught exception
12-31 11:48:39.459: E/AndroidRuntime(220): java.lang.RuntimeException: An error occured while executing doInBackground()
12-31 11:48:39.459: E/AndroidRuntime(220):  at android.os.AsyncTask$3.done(AsyncTask.java:200)
12-31 11:48:39.459: E/AndroidRuntime(220):  at java.util.concurrent.FutureTask$Sync.innerSetException(FutureTask.java:273)
12-31 11:48:39.459: E/AndroidRuntime(220):  at java.util.concurrent.FutureTask.setException(FutureTask.java:124)
12-31 11:48:39.459: E/AndroidRuntime(220):  at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:307)
12-31 11:48:39.459: E/AndroidRuntime(220):  at java.util.concurrent.FutureTask.run(FutureTask.java:137)
12-31 11:48:39.459: E/AndroidRuntime(220):  at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1068)
12-31 11:48:39.459: E/AndroidRuntime(220):  at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:561)
12-31 11:48:39.459: E/AndroidRuntime(220):  at java.lang.Thread.run(Thread.java:1096)
12-31 11:48:39.459: E/AndroidRuntime(220): Caused by: java.lang.NullPointerException
12-31 11:48:39.459: E/AndroidRuntime(220):  at com.example.easyeop1.MainActivity$saveNewData.doInBackground(MainActivity.java:163)
12-31 11:48:39.459: E/AndroidRuntime(220):  at com.example.easyeop1.MainActivity$saveNewData.doInBackground(MainActivity.java:1)
12-31 11:48:39.459: E/AndroidRuntime(220):  at android.os.AsyncTask$2.call(AsyncTask.java:185)
12-31 11:48:39.459: E/AndroidRuntime(220):  at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:305)
12-31 11:48:39.459: E/AndroidRuntime(220):  ... 4 more
12-31 11:48:39.489: I/dalvikvm(220): threadid=7: reacting to signal 3
12-31 11:48:39.540: I/dalvikvm(220): Wrote stack trace to '/data/anr/traces.txt'
12-31 11:48:44.939: I/Process(220): Sending signal. PID: 220 SIG: 9 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-11T17:49:05.467

我遇到了同样的问题。它似乎与 ICS 之前的操作系统版本中的错误有关——或者就我而言。你运行的是哪个安卓版本？

这段代码为我解决了这个问题（参考：[http](http://code.google.com/p/android/issues/detail?id=13117#c14) ://code.google.com/p/android/issues/detail?id=13117#c14 ）

```
private void workAroundReverseDnsBugInHoneycombAndEarlier(HttpClient client) {
    // Android had a bug where HTTPS made reverse DNS lookups (fixed in Ice Cream Sandwich) 
    // http://code.google.com/p/android/issues/detail?id=13117
    SocketFactory socketFactory = new LayeredSocketFactory() {
        SSLSocketFactory delegate = SSLSocketFactory.getSocketFactory();
        @Override public Socket createSocket() throws IOException {
            return delegate.createSocket();
        }
        @Override public Socket connectSocket(Socket sock, String host, int port,
                InetAddress localAddress, int localPort, HttpParams params) throws IOException {
            return delegate.connectSocket(sock, host, port, localAddress, localPort, params);
        }
        @Override public boolean isSecure(Socket sock) throws IllegalArgumentException {
            return delegate.isSecure(sock);
        }
        @Override public Socket createSocket(Socket socket, String host, int port,
                boolean autoClose) throws IOException {
            injectHostname(socket, host);
            return delegate.createSocket(socket, host, port, autoClose);
        }
        private void injectHostname(Socket socket, String host) {
            try {
                Field field = InetAddress.class.getDeclaredField("hostName");
                field.setAccessible(true);
                field.set(socket.getInetAddress(), host);
            } catch (Exception ignored) {
            }
        }
    };
    client.getConnectionManager().getSchemeRegistry()
            .register(new Scheme("https", socketFactory, 443));
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T05:53:46.327

错误的事实是`NoHttpResponseException`，我猜该错误是由于您的网络问题或服务器过载造成的！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-21T05:44:30.513

尝试使用[https://code.google.com/p/httpclientandroidlib/](https://code.google.com/p/httpclientandroidlib/)替换 android 4.0 (ICS) 之前的 httpclient，我通过使用这个 jar 修复了这个错误。

# c++ - 将变量放在标题中的哪个位置？

> ID：14078938
> 
> 赞同：0
> 
> 时间：2012-12-29T05:21:46.273
> 
> 标签：c++, header

我需要能够`QList<QRadioButton *> colorList`从 wager.cpp 访问在 mainwindow.h 中声明的内容。

我将在这里展示我目前的尝试。

主窗口.h

```
#ifndef MAINWINDOW_H
#define MAINWINDOW_H

#include <QMainWindow>
#include <QPushButton>
#include <QTextEdit>
#include <QCheckBox>
#include <Qlist>
#include <QRadioButton>

namespace Ui {
class MainWindow;
}

class MainWindow : public QMainWindow
{
    Q_OBJECT

public:
    explicit MainWindow(QWidget *parent = 0);

    ~MainWindow();

private slots:
    void runButtonClicked();

private:
    Ui::MainWindow *ui;
    QPushButton *runButton;
        QTextEdit * runText;

    };

 QList<QRadioButton *> colorList; // where should i put this??

    #endif // MAINWINDOW_H 
```

错误: LNK2005: "class QList colorList" (?colorList@@3V?$QList@PAVQRadioButton@@@@A) 已经在 main.obj 中定义

赌注.cpp

```
#include "wager.h"
#include "mainwindow.h"
#include "deck.h"

Wager::Wager()
{
}

void build_bet_lists()

{
for(int i=0;i<5;i++)
    {
        qDebug()<<colorList[i]->isChecked;

}
} 
```

colorList 定义在

主窗口.cpp

```
MainWindow::MainWindow(QWidget *parent) :
    QMainWindow(parent),
    ui(new Ui::MainWindow)

{

QRadioButton * street1BetBlack = new QRadioButton("Black");
QRadioButton * street2BetBlack = new QRadioButton("Black");
QRadioButton * street3BetBlack = new QRadioButton("Black");
QRadioButton * street4BetBlack = new QRadioButton("Black");
QRadioButton * street5BetBlack = new QRadioButton("Black");

QRadioButton * street1BetRed = new QRadioButton("Red");
QRadioButton * street2BetRed = new QRadioButton("Red");
QRadioButton * street3BetRed = new QRadioButton("Red");
QRadioButton * street4BetRed = new QRadioButton("Red");
QRadioButton * street5BetRed = new QRadioButton("Red");

QList<QRadioButton *> colorList;
colorList << street1BetBlack << street1BetRed << street2BetBlack << street2BetRed << street3BetBlack << street3BetRed << street4BetBlack << street4BetRed << street5BetBlack << street5BetRed ;

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T05:28:03.730

像您一样在标题中声明它：但将其声明为`extern`：

```
extern QList<QRadioButton *> colorList; //declared 
```

除了在标题中“声明”它，还在 CPP 文件中“定义”它：

```
QList<QRadioButton *> colorList; //defined 
```

在全局范围内定义它，而不是在 MainWindow 构造函数中：

```
QList<QRadioButton *> colorList;

MainWindow::MainWindow(QWidget *parent) :
    QMainWindow(parent),
    ui(new Ui::MainWindow)

{

QRadioButton * street1BetBlack = new QRadioButton("Black");
QRadioButton * street2BetBlack = new QRadioButton("Black");
QRadioButton * street3BetBlack = new QRadioButton("Black");
QRadioButton * street4BetBlack = new QRadioButton("Black");
QRadioButton * street5BetBlack = new QRadioButton("Black");

QRadioButton * street1BetRed = new QRadioButton("Red");
QRadioButton * street2BetRed = new QRadioButton("Red");
QRadioButton * street3BetRed = new QRadioButton("Red");
QRadioButton * street4BetRed = new QRadioButton("Red");
QRadioButton * street5BetRed = new QRadioButton("Red");

colorList << street1BetBlack << street1BetRed << street2BetBlack << street2BetRed << street3BetBlack << street3BetRed << street4BetBlack << street4BetRed << street5BetBlack << street5BetRed ;

} 
```

或者，您可以将其声明并定义为 MainWindow 等类的静态成员。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T05:27:53.933

您必须使用 extern 关键字来访问 C++ 中的全局变量。语法如下：

```
extern type varName; 
```

所以在你声明变量的文件中试试这个：

```
extern QList<QRadioButton *> colorList; 
```

# ruby-on-rails - rspec 模拟 ActionMailer

> ID：14078946
> 
> 赞同：4
> 
> 时间：2012-12-29T05:23:27.080
> 
> 标签：ruby-on-rails, rspec

我正在编写一些 rspec 测试，我注意到访问我的 Mailer 类时它变慢了。有没有办法完全模拟 ActionMailer::Base 类，以便我可以在电子邮件传递之前和之后测试控制器的其他组件？

这是我的邮件类定义

```
class OrganisationMailer < ActionMailer::Base
# code to send emails
end 
```

这是我写的测试之一

```
require 'spec_helper'

describe OrganisationsController do

  describe "#email_single" do
    context "With email address" do 
      let(:org) {Organisation.make!}

      it "redirects to listing" do
        get :email_single, :id => org.id
        response.should redirect_to(organisations_path)
      end
    end
  end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T07:34:21.897

这很难用您包含​​的小片段来回答，但是您应该能够删除控制器发送到的任何消息，`OrganisationMailer`以便它们在您不关心执行该逻辑的 rspec 示例中是无操作的。

或者，您可以`OrganisationMailer`使用以下命令替换测试替身`stub_const`：

```
stub_const("OrganisationMailer", my_test_double) 
```

然后就可以完全控制controller和mailer的交互了。

# c# - 无法在 Visual Studio 2012 中使用 FileSystemWatcher

> ID：14078948
> 
> 赞同：1
> 
> 时间：2012-12-29T05:24:24.463
> 
> 标签：c#, visual-studio, visual-studio-2012, microsoft-metro, filesystemwatcher

我是 Visual Studio 和 C# 的新手。我习惯于使用 XCode 和 Objective-C，但现在我正在尝试编写一个 Windows 8 应用程序。我试图`FileSystemWatcher`在用户单击我的应用程序中的按钮时设置一个，但由于某种原因，Visual Studio 拒绝识别我可以做到这一点并引发错误。这是我写的一个示例：

```
using System;
using System.IO;
...

namespace My_APP
{
...
    public sealed partial class MainPage : My_App.Common.LayoutAwarePage
    {
    ...
        public void button_click_1(object sender, RoutedEventArgs e)
        {
            FileSystemWatcher watch = new FileSystemWatcher();
        }
    }
} 
```

`FileSystemWatcher`两次都用红色下划线显示错误：我`Error 1 The type or namespace name 'FileSystemWatcher' could not be found (are you missing a using directive or an assembly reference?)` 做错了什么（我确信这是非常简单的事情）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T05:50:52.200

因为`FileSystemWatcher`不包含在用于 Windows 8 应用程序的 .NET 版本中。如果受支持，您会在[MSDN 页面](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.aspx)的版本信息部分看到“.NET for Windows Store apps, Supported in: Windows 8” 。[将此与可用](http://msdn.microsoft.com/en-us/library/system.io.binaryreader.aspx)`BinaryReader`的进行对比。

Windows.Storage[命名空间](http://msdn.microsoft.com/en-us/library/windows/apps/windows.storage.aspx)具有用于在 Windows 8 应用程序中访问文件系统的 API。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-22T14:22:50.563

要在创建、修改或删除文件或文件夹时获得通知，您可以使用类`Windows.Storage.Search.StorageFolderQueryResult`和`Windows.Storage.Search.StorageFileQueryResult`，以及`ContentsChanged`事件。

*   [http://msdn.microsoft.com/en-us/library/windows/apps/windows.storage.search.storagefilequeryresult.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/windows.storage.search.storagefilequeryresult.aspx)
*   [http://msdn.microsoft.com/en-us/library/windows/apps/windows.storage.search.storagefolderqueryresult.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/windows.storage.search.storagefolderqueryresult.aspx)

# ruby-on-rails - 通过 AJAX 加载时，Rails 远程链接不起作用

> ID：14078950
> 
> 赞同：1
> 
> 时间：2012-12-29T05:24:41.987
> 
> 标签：ruby-on-rails, ajax, link-to

我想这个问题与这个问题相似[，](https://stackoverflow.com/questions/7548852/rails-remote-form-loaded-via-ajax-after-document-ready-is-not-submitting)但由于尚未得到回答，所以再次询问。

在我的 rails 应用程序中，我有一个视图，其中包含通过 ajax 加载内容的链接列表。

这是链接的部分内容

```
<%= link_to(story.title, {:controller=>"story", :id=>story.id}, :remote => true , :method=>'get', :class=>'story-link') %> 
```

当通过 HTTP 加载视图时，此远程链接可以正常工作并通过 AJAX 加载内容。

该视图还有一个小的远程表单，提交后会在视图中添加一个新链接。但是，由于这个新链接是通过 AJAX 加载的，所以它不起作用（即不通过 AJAX 加载内容）。

此外，当我在浏览器中刷新视图时，新链接可以正常工作。我相信通过 AJAX 加载链接时不会发生适当的事件绑定。我怎么解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T06:16:44.760

您要么需要对表单提交 js 使用[委托事件处理](http://www.iexposure.com/2012/10/26/rails-4-turbolinks-and-delegated-event-handling-in-jquery)，要么在重新加载内容时重新注册表单提交事件。

# php - 文件上传中的多项选择在 IE9 中不起作用

> ID：14078959
> 
> 赞同：0
> 
> 时间：2012-12-29T05:26:03.897
> 
> 标签：php

您好正在尝试多个文件选择上传。我无法在 IE9 中选择多个文件。Chrome、safari、firefox 运行良好。我使用这个输入标签来选择多个文件。

```
<input type="file" name="file_upload[]" multiple="multiple"/> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T05:29:49.867

只有 IE10 支持这个 IE9 和更早的不支持。这个问题和你的类似[IE: input type="file" multiple](https://stackoverflow.com/questions/7085171/ie-input-type-file-multiple)

# objective-c - 无接触监听器的碰撞

> ID：14078960
> 
> 赞同：1
> 
> 时间：2012-12-29T05:26:17.520
> 
> 标签：objective-c

我经历了像fruitninja这样的Raywenderlich游戏，并实现了如何使用自定义形状的多边形将对象切成两块。我通过设置其他不可破坏的对象来增强我的游戏。在创建主体时，如果我设置用户数据，则对象不会创建。无需设置用户数据，我就可以创建对象。但我需要为两个不可破坏的对象编写联系人监听器。但是如果不设置用户数据，我将无法编写侦听器，如果我设置了用户数据，我将无法对对象进行切片。任何人都可以在不接触听众的情况下帮助检测碰撞并破坏身体

# xaml - 在 WP8 中，ListPicker 是否可以不“推开”其他 UI 元素？

> ID：14078962
> 
> 赞同：2
> 
> 时间：2012-12-29T05:26:47.333
> 
> 标签：xaml, windows-phone-8, listpicker

目前，我有：

```
<StackPanel>
    <toolkit:ListPicker
         Header="Rating"
         ItemsSource="{Binding Ratings}"
         SelectedIndex="1"
         SelectionChanged="RatingSelectionChanged"/>
<TextBlock
          x:Name="RatingSelection"
          CacheMode="BitmapCache"/>
</StackPanel> 
```

每当我按下 ListPicker 时，它都会展开并推开 Textblock。有没有一种方法可以使文本块保持原位并且只是在 ListPicker 下？

**更新 1：** 按照 Will 将两个网格布局相互叠加的建议，问题仍然存在，listpicker 的扩展移动了其他 UI 元素，更具体地说，按钮随着 ListPicker 的扩展而移动。此外，我还包含了我正在使用的实际代码：

```
 <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>    

                        <Button 
                            Grid.Row="0"
                            Grid.Column="1"
                            Content="Save" 
                            Height="71" 
                            x:Name="SaveButton" 
                            Width="123" 
                            Click="SaveButton_Click"/>
                         <Button 
                            Grid.Row="0"
                            Grid.Column="2"
                            Content="Generate"
                            Height="71" 
                            x:Name="GenerateButton" 
                            Width="154" 
                            Click="GenerateButton_Click"/>

                          <Grid Grid.Row="0" Grid.Column="0">
                               <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                               </Grid.RowDefinitions>       

                               <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                               </Grid.ColumnDefinitions>

                         <toolkit:ListPicker
                             Grid.Row="0"
                             Grid.Column="0"
                             x:Name="Auth_ListPicker"
                             ItemsSource="{Binding}"
                             Width="156"
                             SelectedIndex="1"
                             SelectionChanged="Auth_ListPicker_SelectionChanged"/>
                          </Grid>            
           </Grid> 
```

还有其他建议吗？

# c# - 内连接linq c#后左外连接

> ID：14078973
> 
> 赞同：1
> 
> 时间：2012-12-29T05:29:25.857
> 
> 标签：c#, sql, linq

我的加入 linq 表达式就像以下

```
var kycKist = (from aloc in this._classesDataContext.tblUsers
                       join sup in this._classesDataContext.BR_Supervisors on aloc.SupId equals sup.Id 
                       where
                           (aloc.UserTypesId == 1 &&
                            ((aloc.CreatedOn <= attendanceDate && aloc.ModifyOn >= attendanceDate &&
                              aloc.Active == false) ||
                             (aloc.Active == true && aloc.CreatedOn <= attendanceDate &&
                              aloc.ModifyOn <= attendanceDate)))
                       select
                           new
                           {
                               sup.Name,
                               sup.Region,
                               sup.Area,
                               sup.Distribution_Name,
                               sup.BR_Alloc,
                               sup.Active
                           }).ToList(); 
```

现在我想用上面的代码做一个外连接

```
left outer join  atn in this._classesDataContext.BR_Attendence on sup.ID equals atn.SupId where atn.date =attendanceDate 
```

我的草稿代码看起来像这样

```
var kycKist = (from aloc in this._classesDataContext.tblUsers
                       join sup in this._classesDataContext.BR_Supervisors on aloc.SupId equals sup.Id 

left outer join  atn in this._classesDataContext.BR_Attendence on sup.ID equals atn.SupId where atn.date =attendanceDate
                       where
                           (aloc.UserTypesId == 1 &&
                            ((aloc.CreatedOn <= attendanceDate && aloc.ModifyOn >= attendanceDate &&
                              aloc.Active == false) ||
                             (aloc.Active == true && aloc.CreatedOn <= attendanceDate &&
                              aloc.ModifyOn <= attendanceDate)))
                       select
                           new
                           {
                               Present=(atn!=null)?atn.PresentBR:0,  
                               sup.Name,
                               sup.Region,
                               sup.Area,
                               sup.Distribution_Name,
                               sup.BR_Alloc,
                               sup.Active
                           }).ToList(); 
```

如何实现上面的左外连接？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T16:52:38.417

在这种情况下，您可以在 where 子句之前或之后执行外连接。

```
var kycKist = (from aloc in this._classesDataContext.tblUsers
               join sup in this._classesDataContext.BR_Supervisors on aloc.SupId equals sup.Id
               where
                   (aloc.UserTypesId == 1 &&
                    ((aloc.CreatedOn <= attendanceDate && aloc.ModifyOn >= attendanceDate &&
                      aloc.Active == false) ||
                     (aloc.Active == true && aloc.CreatedOn <= attendanceDate &&
                      aloc.ModifyOn <= attendanceDate)))
               join b in filterBrAttendence on sup.Id equals b.SupId into outer
               from x in outer.DefaultIfEmpty()
               select
                   new
                   {
                       sup.Name,
                       sup.Region,
                       sup.Area,
                       sup.Distribution_Name,
                       sup.BR_Alloc,
                       sup.Active,
                       PresentBR = (x != null) ? x.PresentBR.ToString() : "Absent"
                   }).ToList(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T07:10:52.437

我通过以下方式做到了

```
var filterBrAttendence = (from atn in this._classesDataContext.BR_Attendances
                                  where atn.AttenDate == attendanceDate
                                  select new {atn.SupId, atn.PresentBR});
        var kycKist = (from aloc in this._classesDataContext.tblUsers
                       join sup in this._classesDataContext.BR_Supervisors on aloc.SupId equals sup.Id
                       where
                           (aloc.UserTypesId == 1 &&
                            ((aloc.CreatedOn <= attendanceDate && aloc.ModifyOn >= attendanceDate &&
                              aloc.Active == false) ||
                             (aloc.Active == true && aloc.CreatedOn <= attendanceDate &&
                              aloc.ModifyOn <= attendanceDate)))
                       select
                           new
                               {
                                   sup.Id,
                                   sup.Name,
                                   sup.Region,
                                   sup.Area,
                                   sup.Distribution_Name,
                                   sup.BR_Alloc,
                                   sup.Active
                               });
        var final = (from a in kycKist
                     join b in filterBrAttendence on a.Id equals b.SupId into outer
                     from x in outer.DefaultIfEmpty()
                     select
                         new
                             {
                                 a.Name,
                                 //a.Region,
                                 a.Area,
                                 a.Distribution_Name,
                                 a.BR_Alloc,
                                 a.Active,
                                 PresentBR = (x!=null)?x.PresentBR.ToString():"Absent"
                             }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-04-12T08:56:57.520

```
var result = from p in db.Products.Where(p => p.IsInActive == false && p.IsLiterature == false)
             join up in db.UserToProducts.Where(up => up.IsInActive == false
             && up.UserID == userID) on p.ProductID equals up.ProductID
             join ul in db.UserToLocations.Where(ul => ul.IsInActive == false)
             on up.UserID equals ul.UserID
             join l in db.Locations.Where(l => l.IsInActive == false)
             on ul.LocationID equals l.LocationID
             join s in db.Sales.Where(s => s.IsInActive == false && s.UserID == userID && s.Date.Month == month
             && s.Date.Year == year && s.WholeSalerID == wholeSalerId) on l.LocationID equals s.LocationID into joined
             from merged in joined.DefaultIfEmpty()
             group new { up.Product, ul.Location, merged }
             by new
             {
                 LocationID = ul.Location.LocationID,
                 ul.Location.Name,
                 ProductID = up.Product.ProductID,
                 ProdictName = up.Product.Name,
                 up.Product.Code,
                 month = merged.Date.Month,
                 year = merged.Date.Year,
                 merged.Date
             } into g
             select new SalesachievementBO()
             {
                 ProductID = g.Key.ProductID,
                 ProductName = g.Key.ProdictName,
                 ProductCode = g.Key.Code,
                 LocationId = g.Key.LocationID,
                 LocationName = g.Key.Name,
                 Qty = g.Sum(p => (p.merged.Qty == null ? 0 : p.merged.Qty)),
                 Price = g.Sum(p => p.merged.Price == null ? 0 : p.merged.Price)
             }; 
```

# mysql - org.springframework.beans.factory.BeanCreationException：创建名为“sqlMap”的bean时出错

> ID：14078979
> 
> 赞同：0
> 
> 时间：2012-12-29T05:30:17.570
> 
> 标签：mysql, spring, jakarta-ee, ibatis

这是 applicationContext.xml 的代码

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN" 
    "http://www.springframework.org/dtd/spring-beans.dtd">
<beans>
    <bean id="dataSource"
       class="org.apache.commons.dbcp.BasicDataSource"
        destroy-method="close">
        <property name="driverClassName"
                  value="com.mysql.jdbc.Driver" />        
    <property name="url"
                  value="jdbc:mysql://localhost:3306/testdb" />
        <property name="username" value="root" />
        <property name="password" value="" />
    </bean>

    <bean id="sqlMap"
          class="org.springframework.orm.ibatis.SqlMapClientFactoryBean">
        <property name="configLocation">
            <value>classpath:SqlMapConfig.xml</value>
        </property>
        <property name="dataSource" ref="dataSource" />
    </bean>    

    <bean id="tradingService"
        class="com.developersbook.ibatis.service.TradeServiceImpl">
        <property name="sqlMapClient" ref="sqlMap" />
    </bean>
 </beans> 
```

这些是错误日志

```
INFO: Destroying singletons in org.springframework.beans.factory.support.DefaultListableBeanFactory@3f5735fd: defining beans [dataSource,sqlMap,tradingService]; root of factory hierarchy
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sqlMap' defined in class path resource [applicationContext.xml]: Invocation of init method failed; nested exception is java.io.FileNotFoundException: class path resource [src/SqlMapConfig.xml] cannot be opened because it does not exist
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1486)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:524)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:461)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:295)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:223)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:292)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:194)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:589)
    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:932)
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:479)
    at org.springframework.context.support.ClassPathXmlApplicationContext.<init>(ClassPathXmlApplicationContext.java:139)
    at org.springframework.context.support.ClassPathXmlApplicationContext.<init>(ClassPathXmlApplicationContext.java:83)
    at com.developersbook.ibatis.client.IBatisClient.main(IBatisClient.java:16)
Caused by: java.io.FileNotFoundException: class path resource [src/SqlMapConfig.xml] cannot be opened because it does not exist
    at org.springframework.core.io.ClassPathResource.getInputStream(ClassPathResource.java:157)
    at org.springframework.orm.ibatis.SqlMapClientFactoryBean.buildSqlMapClient(SqlMapClientFactoryBean.java:338)
    at org.springframework.orm.ibatis.SqlMapClientFactoryBean.afterPropertiesSet(SqlMapClientFactoryBean.java:293)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1545)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1483)
    ... 12 more 
```

# facebook - 如何在 Amazon EC2 上运行的 Bitnami 图像上使用 Joomla 构建 facebook 模块？

> ID：14078984
> 
> 赞同：2
> 
> 时间：2012-12-29T05:31:24.600
> 
> 标签：facebook, joomla, amazon, facebook-comments, bitnami

我正在尝试在一篇文章中实现一个 facebook 评论框。有一个“Facebook 评论插件”应该用 facebook 评论框替换文章中任何地方的“{fcomments}”。我从这里下载了它：http: [//extensions.joomla.org/extensions/social-web/social-comments/16412](http://extensions.joomla.org/extensions/social-web/social-comments/16412)

不幸的是，它不适用于我的 Joomla 2.5.6。它会显示 facebook 评论框，并允许您登录，但是，当您发表评论时，它不会做任何事情。我尝试了不同的浏览器、计算机等。经过数小时的故障排除后，我认为来自 Bitnami 的 Joomla 版本存在问题。它要么缺少软件包，要么版本不正确，因为我有另一个 Joomla 网站和另一个主机，并且相同的插件在我的另一个网站上完美运行。所以这让我认为我的环境有问题。

我想也许有些端口被关闭了，所以我打开了防火墙中的所有端口，但它仍然失败。（我现在已经关闭了所有不必要的端口）我真的认为在 BitNami 特定的 Joomla 构建的配置中缺少一些东西，因为我在网上发现其他一些人在使用 Joomla/Bitnami 图像实现 Facebook 应用程序时遇到了类似的问题。你能帮我进一步排除故障吗？

这是带有损坏的 facebook 插件的页面的链接。请注意它呈现，但不发布。

```
http://184.73.244.219/joomla/ 
```

谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T15:59:09.897

您的 FB 初始化脚本没有**app id**，

```
FB.init({appId: '', status: true, cookie: true, xfbml: true}); 
```

也许这可能是问题所在。

# php - 从查询字符串 php 中删除加号

> ID：14078991
> 
> 赞同：3
> 
> 时间：2012-12-29T05:32:08.920
> 
> 标签：php, javascript, regex, preg-match

当用户在输入栏中输入空格或什么都没有时，加号 + 仍会传递给我的 php 后端。我想删除一个单词前后的所有加号（例如从'+++school++'返回'school'）。我看到php有一些不错的功能，比如strip_tag，但我不确定在这种情况下我应该使用什么.或者有没有办法配置它（也许通过javascript？），这样那些无意义的空格/+甚至不会进入查询字符串？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T05:33:23.270

您可以使用：

```
$input = trim(urldecode($input)); 
```

其中 $input 是 post 参数之一，例如：`$input = $_POST["query"];`// 如果 query 是 POST 参数。

编辑：使用 urldecode 的另一个优点是它可以处理所有其他已编码的非字母数字字符。

来自： http: [//php.net/manual/en/function.urldecode.php](http://php.net/manual/en/function.urldecode.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T14:32:27.087

查询字符串中的`+`变成 中的空格`$_GET`。您需要做的就是修剪前导和尾随空格。

```
trim($_GET['param']) 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-29T05:35:23.603

```
$str = '++school++';
return trim(urldecode($str) 
```