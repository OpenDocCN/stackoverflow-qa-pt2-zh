# StackOverflow 问答 15665000-15665999

# java - 获取类型对象的值

> ID：15665001
> 
> 赞同：1
> 
> 时间：2013-03-27T17:07:53.000
> 
> 标签：java, oop, reflection

我有带字段的类型对象，我想在上面获取特定字段的值，我应该如何在 java 中做到这一点？

在这里，我获取与实体实例相关的字段 id 的特定字段类型，现在我想获取此特定字段“id”的**值**（如 1、2、3 等）。

```
for (Object entityInstance : fromEntityInstances) {

    try {
        Field declaredField = entityObj.getDeclaredField("id"); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-27T17:10:45.283

我*想*你正在寻找[`Field.get`](http://docs.oracle.com/javase/7/docs/api/java/lang/reflect/Field.html#get%28java.lang.Object%29)：

```
Object value = declaredField.get(entityInstance); 
```

如果您知道它的类型，则可以进行投射。对于原语，有具体的方法，比如[`Field.getInt()`](http://docs.oracle.com/javase/7/docs/api/java/lang/reflect/Field.html#getInt%28java.lang.Object%29)

```
int id = declaredField.getInt(entityInstance); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-27T17:11:00.787

一旦获得声明的字段，就可以调用它的`get`方法，如下所示：

```
// Don't forget getType() here ---vvv
Field declaredField = entityObj.getType().getDeclaredField("id");
Object res = declaredField.get(entityInstance); 
```

如果所有对象都属于同一类型，则可以将调用移到`getDeclaredField`循环外以节省一些 CPU 周期。

# html - CSS 在两个单独的页面中显示不同

> ID：15665002
> 
> 赞同：0
> 
> 时间：2013-03-27T17:07:54.477
> 
> 标签：html, css

我有以下CSS：

```
#main2 {
    width: 680px;
    margin: 0 auto;
    padding: 0;
}
#header2 {
    text-align: center;
    margin: 0 auto;
    padding: 0;
    height: 31px;
    line-height: 31px;
}
#contents2 {
    text-align: center;
    margin: 0 auto;
    border: 3px solid #0F446D;
    padding: 0;
    padding-left: 15px;
    height: 365px;
    background: url('theImages/certBG.png') no-repeat bottom;
}
#store {
    background-image: url('theImages/certHeader.png');
    width: 231px;
    height: 31px;
    padding: 0;
    margin: 0 auto;
    color: #FFFFFF;
    font-weight: bold;
    font-family: Verdana, Arial;
    font-size: 14px;
} 
```

但是这个页面：[非工作页面](http://www.interfaithmedical.com/checksite/ccopy.php?zh=loadPage) ![不工作](../Images/0268af83cea6035a8f18b38bdeb79590.png)

显示标题“您的信息”的方式与此页面不同：[工作页面](http://www.interfaithmedical.com/checksite/test/label.htm) ![在职的](../Images/a14a971dfb9197d805f3d3452b5df75f.png)

谁能告诉我为什么？以及如何使首页正确显示页眉。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T17:30:54.123

对于 Internet Explorer（**IE** ），您需要**不同的 CSS 样式表**：

 **参考以下[页面源代码](http://www.interfaithmedical.com/checksite/ccopy.php?zh=loadPage)的第 8,9 和 10 行（通过单击IE 中的**ViewSource**）。

```
<!--[if IE]>
<link href="theScriptsStyles/mainStyle-ie.css" rel="stylesheet" type="text/css" />
<![endif]--> 
```

Page [Link-1](http://www.interfaithmedical.com/checksite/ccopy.php?zh=loadPage)包含`IE Style-Sheet`，而 Page [Link-2](http://www.interfaithmedical.com/checksite/test/label.htm)不包含。

两个页面在其他浏览器（Chrome、Firefox）中看起来相同。在 Internet Explorer 中看起来不同，因为`mainStyle-ie.css`

[IE 总是有 CSS 问题](http://www.webcredible.co.uk/user-friendly-resources/css/internet-explorer.shtml)。因此，您必须专门针对 IE 的样式表。您需要将条件代码（如上）放在页面的标题部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T19:00:53.820

> `#store22{ display:block;}`

或者

> 添加显示：块；在第 22 行

它可以满足您的要求。:)**

# memory-leaks - Sencha Touch 2.1 存储加载内存泄漏

> ID：15665006
> 
> 赞同：0
> 
> 时间：2013-03-27T17:08:06.353
> 
> 标签：memory-leaks, load, store, sencha-touch-2.1

我在加载商店和泄漏内存时遇到问题。我有一个商店，我需要每 5 秒加载一次。我正在使用 DelayedTask 执行轮询。此应用程序需要轮询并将运行很长时间。商店拉回了一个相当大的 JSON 数据集，几个小时后达到了 500MB。我在控制器中执行轮询。

我已经剥离了所有逻辑，只加载商店。无论我使用 DelayedTask 还是 setInterval，泄漏都是一样的。我已经追踪到 store.load 逻辑。至少我认为我有。:)

我还从存储加载中删除了回调，并在加载事件侦听器中执行了 task.delay。泄漏仍然存在。

所以，我不知道我是否做错了并引入了闭包，还是这是一个错误？

我还使用 Ext.Ajax 每 5 秒提取一次数据。内存泄漏仍然存在，但要小得多。

任何帮助表示赞赏！

模型：

```
Ext.define('fimobile.model.myModel', {
    extend: 'Ext.data.Model',

    config: {
        fields: [
            {name: 'a', type: 'string'},
            {name: 'b', type: 'string'},
            {name: 'c', type: 'string'},
            {name: 'd', type: 'string'},
            {name: 'e', type: 'string'},
            {name: 'f', type: 'string'},
            {name: 'g', type: 'string'},
            {name: 'h', type: 'string'},
            {name: 'i', type: 'string'},
            {name: 'j', type: 'string'}
        ]
    }
}); 
```

店铺：

```
Ext.define('fimobile.store.myStore', {
    extend: 'Ext.data.Store',
    config: {
        storeId: 'myStoreID',
            model: 'app.model.myModel',
        proxy: {
        type: 'ajax',
        url : url,
        reader: {
            type: 'json',
            rootProperty: 'data',
            successProperty: 'success'
        }
        },  
        autoLoad: true
    }
}); 
```

控制器：

```
Ext.define('fimobile.controller.myController', {
    extend: 'Ext.app.Controller',

    config: {
        views: ['myView'],
        models: ['myModel'],
        stores: ['myStore'],
        refs: {  
        },
        control: { 
            'myView': {
                initialize: this.start
            }
        }
    },

    start: function () {        
        task = Ext.create('Ext.util.DelayedTask', function() {      
            this.getData();
        }, this);
        task.delay(5000);
    },

    getData: function() {               
        Ext.getStore('myStore').load({
            scope: this,
            callback : function(records, operation, success) {
                console.log('callback');
                task.delay(5000);
            }
        });
     }
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T01:49:12.410

你为什么不在 bug Sencha 论坛上发布这个？测试错误会是一个更明智的地方吗？

# azure - 为什么不删除未使用的段文件？

> ID：15665021
> 
> 赞同：0
> 
> 时间：2013-03-27T17:08:41.483
> 
> 标签：azure, lucene.net, lucene

我不知道发生了什么变化——我们的 Lucene 实现运行得相对较好。但是现在，索引目录中的文件数量一直在增长。它从 _0 个文件开始，然后出现 _1 个文件，然后是 _2 和 _3 个文件。如果开始时该目录中存在现有文件，我将 false 传递给 IndexWriter 的“create”参数的构造函数：

```
indexWriter = new IndexWriter(azureDirectory, analyzer, (azureDirectory.ListAll().Length == 0), IndexWriter.MaxFieldLength.UNLIMITED);
if (indexWriter != null)
{
    // Set the number of segments to save in memory before writing to disk.
    indexWriter.MergeFactor = 1000;
    indexWriter.UseCompoundFile = false;
    indexWriter.SetRAMBufferSizeMB(800);
        ...
    indexWriter.Dispose(); indexWriter = null;
} 
```

也许它与 UseCompoundFile 标志有关？

每隔几分钟，我创建一个新的 IndexWriter，处理 10,000 个文档，然后处理 IndexWriter。该索引有效，但文件数量的增长非常糟糕，因为我正在使用 AzureDirectory，它将 Azure 中的每个文件复制到缓存目录中，然后再开始 Lucene 写入。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T19:25:02.717

这是正常行为。如果你想要一个索引段，你有一些选择：

*   使用复合文件
*   如果使用 1，则使用 MergeFactor `LogMergePolicy`，这是 lucene 3.0 的默认策略。请注意，您在 上使用的方法`IndexWriter`只是调用 mergePolicy.MergeFactor 的便捷方法，只要 mergePolicy 是`LogMergePolicy`.
*   每次更新索引后运行优化

每次更新后的低合并因子和优化可能会对您的应用程序的性能产生严重的影响，这取决于您执行的索引类型。

请参阅此链接，其中记录了一点效果`MergeFactor`： http: [//lucene.apache.org/core/old_versioned_docs/versions/3_0_1/api/core/org/apache/lucene/index/LogMergePolicy.html#setMergeFactor%28% 29](http://lucene.apache.org/core/old_versioned_docs/versions/3_0_1/api/core/org/apache/lucene/index/LogMergePolicy.html#setMergeFactor%28%29)

# python - 如何获取在 wxpython 循环期间创建的 TextCtrl 的值

> ID：15665022
> 
> 赞同：1
> 
> 时间：2013-03-27T17:08:41.507
> 
> 标签：python, wxpython

假设我正在使用这样的循环创建 6 个文本控制字段：

```
ticker_items = ['bid', 'ask', 'open', 'close', 'high', 'low']
for item in ticker_items:
    wx.TextCtrl(self.panel, -1, value=item, size=(-1, -1)) 
```

创建后如何更新这些？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T17:15:00.747

你不能。您要么必须以某种方式保存对象（例如对象列表），要么为每个 TextCtrl 提供不同的 ID。

例如：

```
ticker_items = [('bid', 1000), ('ask', 1001),
                ('open', 1002), ('close', 1003),
                ('high', 1004), ('low', 1005)]

for item, id in ticker_items:
    wx.TextCtrl(self.panel, id=id, value=item, size=(-1, -1)) 
```

然后你可以使用

```
my_textctrl = self.panel.FindWindowById(id_of_my_ctrl) 
```

获得特定的控制权

或者，使用列表：

```
ticker_items = ['bid', 'ask', 'open', 'close', 'high', 'low']
self.my_controls = []
for item in ticker_items:
    text_control = wx.TextCtrl(self.panel, -1, value=item, size=(-1, -1))
    self.my_controls.append(text_control) 
```

您检索文本编号 0 与

```
 my_textctrl = self.my_controls[0] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-27T18:29:01.873

一个非常简单的方法是将 ctrl 存储在字典中。我已经修改了 Mike 的代码以使用字典而不是见下文。

```
import wx

########################################################################
class MyPanel(wx.Panel):
    """"""

    #----------------------------------------------------------------------
    def __init__(self, parent):
        """Constructor"""
        wx.Panel.__init__(self, parent)

        sizer = wx.BoxSizer(wx.VERTICAL)
        ticker_items = ['bid', 'ask', 'open', 'close', 'high', 'low']
        self.ticker_ctrls = {}
        for item in ticker_items:
            ctrl = wx.TextCtrl(self, value=item, size=(-1, -1), name=item)
            sizer.Add(ctrl)
            self.ticker_ctrls[item] = ctrl

        btn = wx.Button(self, label="Update")
        btn.Bind(wx.EVT_BUTTON, self.updateTextCtrls)
        sizer.Add(btn)

        self.SetSizer(sizer)

    #----------------------------------------------------------------------
    def updateTextCtrls(self, event):
        """"""
        self.ticker_ctrls['bid'].SetValue('$100')
        self.ticker_ctrls['ask'].SetValue('$500')

########################################################################
class MainFrame(wx.Frame):
    """"""

    #----------------------------------------------------------------------
    def __init__(self):
        """Constructor"""
        wx.Frame.__init__(self, None, title="TextCtrl Tutorial")
        panel = MyPanel(self)
        self.Show()

if __name__ == "__main__":
    app = wx.App(False)
    frame = MainFrame()
    app.MainLoop() 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-27T17:46:36.503

有一个更简单的方法。您可以将唯一名称传递给文本控件并使用它来更新它们。我提供了一个简单的示例，其中我更新了下面的前几个控件：

```
import wx

########################################################################
class MyPanel(wx.Panel):
    """"""

    #----------------------------------------------------------------------
    def __init__(self, parent):
        """Constructor"""
        wx.Panel.__init__(self, parent)

        sizer = wx.BoxSizer(wx.VERTICAL)
        ticker_items = ['bid', 'ask', 'open', 'close', 'high', 'low']
        for item in ticker_items:
            sizer.Add(wx.TextCtrl(self, value=item, size=(-1, -1), name=item) )

        btn = wx.Button(self, label="Update")
        btn.Bind(wx.EVT_BUTTON, self.updateTextCtrls)
        sizer.Add(btn)

        self.SetSizer(sizer)

    #----------------------------------------------------------------------
    def updateTextCtrls(self, event):
        """"""
        txtCtrls = [widget for widget in self.GetChildren() if isinstance(widget, wx.TextCtrl)]
        for ctrl in txtCtrls:
            if ctrl.GetName() == "bid":
                ctrl.SetValue("$100")
            elif ctrl.GetName() == "ask":
                ctrl.SetValue("$500")

########################################################################
class MainFrame(wx.Frame):
    """"""

    #----------------------------------------------------------------------
    def __init__(self):
        """Constructor"""
        wx.Frame.__init__(self, None, title="TextCtrl Tutorial")
        panel = MyPanel(self)
        self.Show()

if __name__ == "__main__":
    app = wx.App(False)
    frame = MainFrame()
    app.MainLoop() 
```

创建对文本控件的引用的唯一方法是使用 ikaros45 提到的 setattr 方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-27T17:21:24.047

如果您想稍后引用它们，则不能像这样创建 TextCtrl。存储它们。

一种方法是使用 settatr() 将它们添加到对象中，并且可以选择使用前缀来提供额外信息（我使用了 '_text'）

[http://docs.python.org/2/library/functions.html#setattr](http://docs.python.org/2/library/functions.html#setattr)

```
ticker_items = ['bid', 'ask', 'open', 'close', 'high', 'low']
for item in ticker_items:
    text_control = wx.TextCtrl(self.panel, -1, value=item, size=(-1, -1))
    setattr(self, '_text_' + item, text_control) 
```

稍后您可以访问它并使用例如更改值：

```
self._text_bid.SetValue('Bid v2.0') 
```

# angularjs - 为什么 ng-repeat 在第 3 级停止工作

> ID：15665025
> 
> 赞同：0
> 
> 时间：2013-03-27T17:09:00.920
> 
> 标签：angularjs

我正在使用 angularjs 来呈现层次结构。测试用例在[http://jsbin.com/agodoj/1/edit](http://jsbin.com/agodoj/1/edit)

我的问题是为什么 ng-repeat 停止在第 3 级工作？谢谢

这是我的模型

```
function Test($scope) {
  $scope.cars = {
    chrylser: {
      nameplates: [{
        name: "np1",
        trims: [
          "tirm1", "trim2"
          ]
      }]
    }
  };
} 
```

这是我的模板

```
<div ng-app ng-controller="Test">
    <div ng-repeat="(key, value) in cars">
        {{key}}
        <ul>
            <li ng-repeat="np in value.nameplates">{{np.name}}, {{np.trims}}</li>
            <ul>
                <li ng-repeat="trim in np.trims">
                   (ng-repeat stop working here) {{trim}}
                </li>
            </ul>
        </ul>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T17:25:26.920

只需要`</li>`在你的 inner 之后移动结束标签`<ul>`。你有`<li ng-repeat="np in value.nameplates">`立即关闭，结束循环。

```
 <div ng-app  ng-controller="Test">
    <div ng-repeat="(key, value) in cars">
      {{key}} 
       <ul>
        <li ng-repeat="np in value.nameplates">{{np.name}}, {{np.trims}}
         <ul>
           <li ng-repeat="trim in np.trims">
             works! {{trim}}
           </li>
         </ul>
       </li>
     </ul>
    </div>
  </div> 
```

# c# - 在激活链接的 ac# 程序中使用 cellcontentclick 事件

> ID：15665026
> 
> 赞同：1
> 
> 时间：2013-03-27T17:09:10.230
> 
> 标签：c#, datagridview, hyperlink

我有一个程序使用包含 7 列的 datagridview。其中一列是一个超链接，它将从指定位置加载文件。我使用“cellcontentclick”事件打开文件。我的问题是，当我单击该行中的任何其他单元格时，它仍会执行 cellcontentclick。只有当单击该特定列时才会执行，我该如何做到这一点？

```
 private void dataGridView1_CellContentClick(object sender, DataGridViewCellEventArgs e)
    {
        try
        {
            string sourcePath = @"SPECIFIED PATH";

            Process.Start(sourcePath + dataGridView1.Rows[e.RowIndex].Cells[5].Value);
        }

        catch (SqlException e)
        {
            MessageBox.Show("Error occured: " + e);
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T17:11:20.380

仅检查您要查找的列的内部事件处理程序。参数之一（e？）具有列信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T17:22:19.850

知道了！我只需要输入 if 语句并指定列。谢谢，evgenyl。

```
 if (e.ColumnIndex == 5 && e.RowIndex >= 0)
        {
            try
            {
                string sourcePath = @"PATH";

                Process.Start(sourcePath + dataGridView1.Rows[e.RowIndex].Cells[5].Value);
            }

            catch (SqlException a)
            {
                MessageBox.Show("Error occured: " + a);
            }
        } 
```

# ios - Twitter“状态更新”网址在 iOS 上不起作用

> ID：15665027
> 
> 赞同：2
> 
> 时间：2013-03-27T17:09:12.873
> 
> 标签：ios, twitter

我在网站上添加了一个“tweet this”链接。它使用 URL 来更新您的 Twitter 状态（如果您已登录）。基本版如下：

```
<a href="http://twitter.com/home/?status=TEST STATUS">Twitter</a> 
```

您可以在此处查看它的运行情况 - [http://jsfiddle.net/CXzf9/1/](http://jsfiddle.net/CXzf9/1/) - 右键单击​​链接以在新窗口中打开（需要先登录到 Twitter）。

除了在 iOS 设备上工作正常。然后它会给你一个错误，说“对不起，该页面不存在”。当设置为 iPad 用户代理时，您还可以使用 Safari 看到这一点。它重定向自

```
http://twitter.com/home/?status=TEST STATUS 
```

到

```
https://mobile.twitter.com/home/?status=TEST STATUS 
```

但这并不是导致问题的原因，就好像您在 Safari 中访问该链接（使用通常的用户代理）您获得了移动版本，但它仍然允许您更新您的状态。

这是一些iOS限制吗？

更新 - 视觉解释：

这是在 Safari 中访问移动链接：

![在此处输入图像描述](../Images/d58938b2a21cfd9a3b33ee1896ef8c99.png)

这是将用户代理设置为 iPad 的相同链接：

![在此处输入图像描述](../Images/d67096f27f74073a3cf8b9ac9c515a7f.png)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-27T17:44:20.467

好的，如果您使用以下网址，它似乎可以工作：

```
https://twitter.com/intent/tweet?text= 
```

所以原始代码将是：

```
<a href="https://twitter.com/intent/tweet?text=TEST STATUS">Twitter</a> 
```

由于某种原因，必须对更新状态有一些 iOS 限制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T17:15:57.830

在我的 iPad 上尝试后，我得到未定义的标题和文字说“出了点问题”。如果这是您收到的内容，那是因为 twitter 没有此页面的移动版本。因此“mobile.twitter.com”。我建议使用 twitter api（[此处](https://dev.twitter.com/)）来更新使用状态。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2016-01-11T12:17:59.690

关于创建帖子链接的官方 Twitter 文档：

[https://dev.twitter.com/web/tweet-button/web-intent](https://dev.twitter.com/web/tweet-button/web-intent)

> # 网络意图 URL
> 
> [https://twitter.com/intent/tweet](https://twitter.com/intent/tweet)
> 
> **查询参数**
> 
> *   文字（*可选*）
> 
> 预填充的 UTF-8 和 URL 编码的推文文本。传递的文本将出现预先选择，供 Twitter 用户在发布前删除或编辑。
> 
> 与任何传递的主题标签、via 或 url 参数结合使用时，传递的推文文本的长度不应超过 140 个字符。导致推文长度超过 140 个字符的已传递推文文本需要 Twitter 用户进行额外编辑才能成功发布。
> 
> 示例值：Hello%20World
> 
> *   网址（*可选*）
> 
> 具有 HTTP 或 HTTPS 方案、URL 编码的完全限定 URL。提供的 URL 将使用 Twitter 的 t.co 缩短为 short_url_length 指定的字符数。
> 
> 示例值：http:%3A%2F%2Fexample.com%2F
> 
> *   标签（*可选*）
> 
> 通过包含逗号分隔的主题标签值列表（不带前面的 # 字符），可以轻松地按主题发现推文。
> 
> 示例值：自然，日落
> 
> *   通过（*可选*）
> 
> 与推文相关联的 Twitter 用户名，例如您网站的 Twitter 帐户。提供的用户名将附加到推文的末尾，并带有文本“via @username”。
> 
> 将鼓励已注销的 Twitter 用户登录或加入 Twitter 以使用 via 帐户的推文。在用户发布推文后，该帐户可能会被建议为要关注的帐户
> 
> 示例值：twitterdev
> 
> *   相关（*可选*）
> 
> 建议与推文相关的其他 Twitter 用户名作为逗号分隔值。Twitter 可能会在用户发布他或她的推文后建议关注这些帐户。
> 
> 您可以在用户名后使用 URL 编码的逗号和文本简要说明帐户与推文的关系。
> 
> 示例值：twitter%3ATwitter%20News,twitterapi%3ATwitter%20API%20News
> 
> *   回复（*可选*）
> 
> 对话中父推文的推文 ID，例如来自您的网站或作者帐户的初始推文。
> 
> 示例值：525001166233403393

示例帖子链接：[https ://twitter.com/intent/tweet?text=Hello%20World&via=twitterdev](https://twitter.com/intent/tweet?text=Hello%20World&via=twitterdev)

# wordpress - 用wordpress中的图像替换链接

> ID：15665035
> 
> 赞同：0
> 
> 时间：2013-03-27T17:09:28.363
> 
> 标签：wordpress

我不确定如何放置图像来代替下面回显的链接。目前这显示了一个链接，但我想让它成为可点击的图像而不是链接。先感谢您 ： ）

```
<div class="back-button">
    <?php
        $this_page = get_post($id);
        $parent_id = $this_page->post_parent;
        if ($parent_id) {
            $parent = get_page($parent_id);
            echo '<a href="'.get_permalink($parent->ID).'" title="">'.get_the_title($parent->ID).'</a>';
        }
    ?> 
```

我想到了！这是解决方案：

```
 <?php
                $this_page = get_post($id);
                $parent_id = $this_page->post_parent;
                if ($parent_id) {
                    $parent = get_page($parent_id);
                    echo '<a href="'.get_permalink($parent->ID).'" title="">'.'<img src="' . get_bloginfo("template_directory") . '/images/close-icon.png" />'.'</a>';
                }
            ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:14:42.903

```
<div class="back-button">
<?php
    $this_page = get_post($id);
    $parent_id = $this_page->post_parent;
    if ($parent_id) {
        $parent = get_page($parent_id); ?>  <a href="#" title=""><img src="<?php bloginfo('template_directory')?>/images/imagename.gif"></a> <?php  }  ?> 
```

尝试使用这个

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T17:13:10.760

您只需要在 a 标签内包含一个 img 标签：

```
echo '<a href="'.get_permalink($parent->ID).'" title=""><img src='myImage.png'/></a>'; 
```

您只需将 myImage.png 替换为您想要的图像的 url。

# php - php IIS Windows Server 2008 DateTime 内部服务器错误

> ID：15665036
> 
> 赞同：0
> 
> 时间：2013-03-27T17:09:28.877
> 
> 标签：php, datetime

我在 Windows Server 2008 R2 上托管我的网站。我想将新的 DateTime 分配给对象属性。构造函数没有参数。每次我尝试都会收到一个名为“500 Internal Server Error”的非特定错误。如果我使用异常，它会在页面上打印错误代码“-3”。我不知道为什么，但错误消息不可用。

我也尝试了这个[DateTime 格式问题](https://stackoverflow.com/questions/11237765/datetime-format-issue-in-iis-7-server)，但没有成功。

这是一个示例：

```
$stop->Arrive_Time          = new DateTime(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T08:50:22.373

ini 文件描述了错误：

> PHP 致命错误：未捕获的异常 'Exception' 带有消息 'DateTime::__construct()：依赖系统的时区设置是不安全的。您*需要*使用 date.timezone 设置或 date_default_timezone_set() 函数。如果您使用了这些方法中的任何一种，但仍然收到此警告，您很可能拼错了时区标识符。我们在 ...

解决方案：[date_default_timezone_set()](http://php.net/manual/de/function.date-default-timezone-set.php)在所有 DateTime 构造或对象之前。

# php - 使用 AJAX 获取显示的 sql 查询而不是查询结果

> ID：15665037
> 
> 赞同：0
> 
> 时间：2013-03-27T17:09:31.040
> 
> 标签：php, ajax, postgresql

您好，我一直在试图弄清楚为什么我的旨在在表中列出查询结果的代码不起作用。我采用了在网上找到的代码，并且厌倦了适应它。我的数据存储在 pgsql 中。html 页面有一个允许选择机构名称的下拉菜单。当我单击提交按钮以了解我的数据库中谁属于该机构时，php 页面已加载并显示我要发送到 pgsql 的 SQL 查询。我应该得到显示在 html 页面上的表格中的查询结果。下拉菜单正常工作，因此我不提供此菜单的 php 代码（listinstitutions.php）

有人告诉我应该使用 ajaxsubmit() 但我不知道该函数放在哪里。php 文件中也可能有错误，因为查询被显示而不是被发送到 pgsql。json 是否正确发送？

您的指导将不胜感激。

谢谢你。

html端：

```
<html>
<head>

<link rel="stylesheet" href="http://code.jquery.com/ui/1.10.1/themes/base/jquery-ui.css" />

<script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
<script src="http://code.jquery.com/ui/1.10.1/jquery-ui.js"></script>
<script>
$(document).ready(function(){

  //////////////////////////////////////
  // Displays insitution names in Drop Down Menu

        //Getting the selector and running the code when clicked
        $('#selinstit').click(function(e){
                 //Getting the JSON object, after it arrives the code inside
               //function(dataI) is run, dataI is the recieved object
               $.getJSON('http://localhost/listinstitutions.php',function(dataI){
                            //loop row by row in the json, key is an index and val the row
                            var items = [];  //array
                          $.each(dataI, function(key, val) {
                            //add institution name to <option>
                            items.push('<option>' + val['Iname'] + '</option>');
                        });//end each
                        //concatenate all html
                        htmlStr=items.join('');
                        console.log(htmlStr);
                        //append code
                        $('option#in').after(htmlStr);
                });//end getJSON
        });//end cluck

    ///////////////////////////////
   // Displays persons form an institution in a table

     $( "$subinst" ).button().click(function( event ) {
     console.log($(this)); // for Firebug
     $.getJSON('http://localhost/SelectPersonsBasedOnInstitution.php',function(data){   // I make an AJAX call here
     console.log($(this)[0].url); // for Firebug   check what url I get here
                            //loop row by row in the json, key is an index and val the row
                            var items = [];  //array
                          $.each(data, function(key, val) {

                        //add table rows
                            items.push('<tr border=1><td>' + val['Pfirstname'] + '</td><td>' + val['Plastname'] + '</td><td><a mailto:=" ' + val['Pemail'] + ' " >' + val['Pemail'] + '</a></td></tr>');
                        });//end each
                        //concatenate all html
                    htmlStr=items.join('');

                        //append code
                        $('#instito').after(htmlStr);
                });//end getJSON
      event.preventDefault();
      });

}); //end ready

</script>

</head>   

<body>
<form id="myForm" action="SelectPersonsBasedOnInstitution.php" method="post">
Select persons from an institution:
<br>                                            
<tr>
 <td>
   <select id="selinstit" name="instit">
   <option id="in">Select</option>                       
   </select>
 </td>
 <td>
   <input type="submit" id="subinst" value="Submit" /> 
 </td>
</tr>

</form>

   <table frame="border" id="instito">
   </table>
</body>
</html> 
```

这是 SelectPersonsBasedOnInstitution.php 的 php 代码

```
<?php

//////////
// part 1: get information from the html form
ini_set('display_errors', 1);                                      
ini_set('display_startup_errors', 1);

foreach ($_REQUEST as $key => $value){
 $$key=$value;  
}

// part2: prepare SQL query from input
$sqlquery= sprintf('SELECT "Pfirstname", "Plastname", "Pemail" FROM "PERSON"
LEFT JOIN "INSTITUTION" ON
"PERSON"."Pinstitution"="INSTITUTION"."Iinstitution"
WHERE "Iname" = \'%s\'',$instit);
echo $sqlquery;

/////////
// part3: send query
$dbh = pg_connect("host=localhost dbname=mydb user=**** password=*****");
$sql=  $sqlquery;
$result = pg_query($dbh,$sql);
$myarray = pg_fetch_all($result);

$jsontext = json_encode($myarray);
echo($jsontext);

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T17:11:41.003

以下行可能是问题所在（不应该存在）：

```
echo $sqlquery; 
```

在没有那行的情况下重写你的代码，它应该可以工作。

```
$sqlquery= sprintf('SELECT "Pfirstname", "Plastname", "Pemail" FROM "PERSON" LEFT JOIN "INSTITUTION" ON "PERSON"."Pinstitution"="INSTITUTION"."Iinstitution" WHERE "Iname" = \'%s\'', $instit);

$dbh = pg_connect("host=localhost dbname=mydb user=**** password=*****");
$result = pg_query($dbh, $sqlquery);
$myarray = pg_fetch_all($result);
$jsontext = json_encode($myarray);
echo($jsontext); 
```

# c# - ComboBox 中的通用周期范围方法

> ID：15665042
> 
> 赞同：0
> 
> 时间：2013-03-27T17:09:59.767
> 
> 标签：c#, asp.net, telerik

我希望有人在这方面指导我。当我从组合框中选择一个句点时，我必须在几个 aspx 页面中使用相同的方法来计算范围日期。例如，我在一个页面中有一个包含期间（当月销售额、上个月销售额、去年销售额、当年销售额）的组合，在另一个页面中有一个包含期间（当周费用、当月费用等）的组合。结果是一样的，给我一个日期范围（开始和结束日期），但并非所有组合都有相同的时期（一个有：月、周、年，另一个：月和年）。我该怎么做才能使其通用？正在考虑枚举位标志或用户控件......有人可以帮帮我吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T17:55:10.557

这个答案对于评论来说有点太长了，所以我正在创建另一个答案。我没有使用过 RadComboBox，但我在 VS 2010 中创建了自己的自定义 .ascx 控件。这是您需要做的：

1.  创建 .ascx 控件
2.  在其中添加一个 ASP.NET 组合框（或者可能是 RadComboBox）
3.  创建一个控件属性（字符串），列出要显示的选项，例如“年、周、月”。这样，您可以更改 HTML 中每页的选项，而无需任何其他编码。
4.  在您的 .ascx 控件代码中，根据 #2 中的自定义属性更改显示选项。
5.  根据选择的选项，在控件中创建函数以获取周期的开始和结束。

这样，您在给定页面中所要做的就是插入您的自定义控件，指定自定义属性，然后在需要时调用 GetStart 或 GetEnd。所有其他编码都在控件本身中处理。我想你也可以用 RadComboBox 做到这一点，尽管我从未使用过它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T17:34:32.430

这是您需要做的：

1.  将时间戳字符串放入组合框选项*值*中，例如“本月费用”的“2013-03-01:2013-03-31”。您将需要一个函数来获取本月、上个月、本周等的开始和结束。我在下面编写了一个示例。
2.  保持您的组合框选项文本相同（例如，“本月的费用”）。
3.  读入组合框选项值，并使用日期/时间字符串解析器获取范围。

获取上周、上个月等的代码将类似于：

```
public static void GetPeriod(string selected_period, out DateTime start, out DateTime end)
{
    switch (selected_period)
    {
        case "last year":
            start = new DateTime(DateTime.Today.Year - 1, 1, 1);
            end = new DateTime(DateTime.Today.Year, 1, 1);
            break;
        case "this year":
            start = new DateTime(DateTime.Today.Year, 1, 1);
            end = new DateTime(DateTime.Today.Year + 1, 1, 1).AddDays(-1);
            break;
        case "last month":
            start = new DateTime(DateTime.Today.Year, DateTime.Today.Month, 1).AddMonths(-1);
            end = new DateTime(DateTime.Today.Year + 1, DateTime.Today.Month, 1).AddDays(-1);
            break;
        case "this month":
            start = new DateTime(DateTime.Today.Year, DateTime.Today.Month, 1);
            end = new DateTime(DateTime.Today.Year + 1, DateTime.Today.Month, 1).AddMonths(1).AddDays(-1);
            break;
        case "last week":
            start = DateTime.Today.AddDays(-7);
            while (start.DayOfWeek != DayOfWeek.Sunday)
                start = start.AddDays(-1);
            end = start.AddDays(6);
            break;
        case "this week":
            start = DateTime.Today;
            while (start.DayOfWeek != DayOfWeek.Sunday)
                start = start.AddDays(-1);
            end = start.AddDays(6);
            break;
    }
} 
```

然后，您只需将开始和结束转换为您放入组合框选项值的字符串。

# d3.js - 试图使 d3js 过渡缩小或增长到下一个值

> ID：15665045
> 
> 赞同：0
> 
> 时间：2013-03-27T17:10:12.173
> 
> 标签：d3.js, transition

我正在尝试转换我创建的条形图的宽度。问题是在过渡期间条形图从 0 增长到 n。如何使条形图增大或缩小到新的宽度值？这是我的 jsfiddle... [http://jsfiddle.net/LAG2r/2/](http://jsfiddle.net/LAG2r/2/)

```
var codes = d3.range("A".charCodeAt(0), "Z".charCodeAt(0)).concat(d3.range("a".charCodeAt(0), "z".charCodeAt(0))),
    chars = [];

codes.forEach(function (c) {
    var chr = String.fromCharCode(c);
    chars.push(chr);
});

function random(size) {

    var string = '',
        len = chars.length,
        start = Math.floor(Math.random() * len);

    return d3.shuffle(chars.slice(start, start + size)).join('');
}

function createData(size) {
    var data = [];
    for (var i = 0; i < size; i++) {
        data.push({
            name: random(6),
            value: Math.random() * 1000
        });
    }
    return data;
}
var svg = d3.select('#yo').append('svg:svg').append('g:svg');

var x = d3.scale.linear()
    .domain([0, 1000])
    .range([0, 490])
    .nice();

var y = d3.scale.ordinal()
    .domain(d3.range(50))
    .rangeRoundBands([0, 490], .2);

setInterval(function () {

    var dataTarget = svg.selectAll(".bar")
        .data(createData(50), function (d) {
        return d.name;
    });
    dataTarget.exit().remove();
    dataTarget.enter().append("rect")
        .attr("class", "bar")
        .attr("height", y.rangeBand())

        .attr("y", function (d, i) {
        return y(i);
    })
        .attr("x", function (d, i) {
        return x(Math.min(0, d.value));
    })
        .transition()
        .attr("width", function (d, i) {
        return d.value;
    });

}, 2000); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T17:28:46.187

这里有两个问题：

给 .data (function (d) { return d.name; })) 的键函数告诉 d3 通过名称关联每个数据点。每次刷新时，都会传入 50 个具有不同随机名称的新数据对象，因此 D3 失去了关联。所以每次刷新时，所有的数据都会进入“exit()”数据连接，而新数据会进入“enter()”数据连接。如果我们不提供 key 功能，d3 将基于 index，我认为这更接近我们想要的。

其次，您没有“更新”数据连接 - 只有一个具有转换的输入。我们需要在底部添加：

```
dataTarget
.transition()
.duration(1000)
.attr("width", function (d, i) {
    return d.value;
}); 
```

我已经用我认为你的目标修改了 jsfiddle：http: [//jsfiddle.net/LAG2r/3/](http://jsfiddle.net/LAG2r/3/)

资料来源：[http ://bost.ocks.org/mike/join/](http://bost.ocks.org/mike/join/)

# java - jboss eap-6.0 轮转日志文件出现在bin目录

> ID：15665048
> 
> 赞同：1
> 
> 时间：2013-03-27T17:10:22.590
> 
> 标签：java, logging, jboss, log4j, slf4j

我在 jboss-eap-6.0 上有 3 个应用程序都工作正常，但其中一个是在 0:00 时在 jboss /bin 目录中创建旋转日志文件，始终为 0 字节

其他所有内容都正确记录到正确的 /log 目录。

配置文件彼此之间非常相似，只是更改了文件名。我怀疑它与依赖库有关……也许 log4j 或 slf4j 不包括在这个应用程序中；我现在尝试使用 log4j。

如果有人对这个问题有任何想法或在其他地方看到过这种行为，那么知道这将非常有用。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-02-26T00:48:37.400

在我看来，配置了一个没有任何日志类别记录的定期轮换文件处理程序。每次日期格式更改时，这些处理程序都会生成一个新文件，这可以解释为什么您每晚都会获得一个新文件。

在基于 EAP 6.0 Web 的管理控制台中，单击右上角的 Profiles，然后展开左侧的 Core 并选择 Logging，然后单击 Handler 选项卡和 Periodic 子选项卡。如果 Suffix 设置为 .yyyy-MM-dd ，那么每天都会为您提供一个新文件。文件路径将是日志文件的实际文件名，使用的目录将由“文件相对于：”下显示的环境属性给出。

如果要更改用于日志文件的目录，请更改“文件相对于”下显示的环境属性的值，或者将其更改为我认为是默认设置的 jboss.server.log.dir。

# java - SocialAuth 和谷歌

> ID：15665050
> 
> 赞同：1
> 
> 时间：2013-03-27T17:10:31.633
> 
> 标签：java, google-oauth, socialauth

我正在构建一个登录模块，您可以在其中使用各种社交网络帐户登录。第一步是LinkedIn和谷歌。

LinkedIn 部分工作正常，但 Google 部分却不行。我认为问题出在身份验证之前的代码上，因为返回 url 有 openid 参数，而不是 OAuth 参数。这是重定向之前的代码：

```
HttpSession session = request.getSession();
SocialAuthConfig config = SocialAuthConfig.getDefault();
    try {
        config.load("/oauth_consumer.properties");
    } catch (Exception ex) {
        System.out.println(ex);
    }

    //Create an instance of SocialAuthManager and set config
    SocialAuthManager manager = new SocialAuthManager();
    try {
        manager.setSocialAuthConfig(config);
    } catch (Exception ex) {
        System.out.println(ex);
    }

    //URL of YOUR application which will be called after authentication
    String successUrl = "http://localhost:8080/ProjectName/completelogin.do";
    String url = "";
    try {
        url = manager.getAuthenticationUrl(type, successUrl).toString();
    } catch (Exception ex) {
        System.out.println(ex);
    }

    // Store in session
    session.setAttribute("authManager", manager);

    response.sendRedirect(url); 
```

这是我为谷歌提供的 oauth_consumer.properties 部分

```
www.google.com.consumer_key = 81XXXXXX466.apps.googleusercontent.com
www.google.com.consumer_secret = WN0oXXXXXXXHoCeSocQK
www.google.com.custom_permissions=https://www.googleapis.com/auth/userinfo.profile,https://www.googleapis.com/auth/userinfo.email 
```

我可以强制 Google 使用 OAuth 身份验证而不是 OpenID 身份验证吗？我已经使用另一个使用 OAuth 的框架登录了谷歌，它就像一个魅力。只是现在，因为我想使用几个社交网站，我不想继续重新发明轮子，而只是使用 socialauth ......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T21:45:04.670

Google OpenId 身份验证端点是[https://accounts.google.com/o/openid2/auth](https://accounts.google.com/o/openid2/auth)，OAuth2 端点是 /o/oauth2/auth。您需要将最终用户重定向到 OAuth2 端点以告诉（或“强制”）Google 使用 OAuth2。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-18T17:52:38.467

通过[https://github.com/3pillarlabs/socialauth/wiki/Sample-Properties](https://github.com/3pillarlabs/socialauth/wiki/Sample-Properties)

如果需要或需要传递额外参数，您可以设置 OAuth 端点（RequestToken URL、Authorization URL 和 AccessToken URL）

*   www.google.com.request_token_url
*   www.google.com.authentication_url
*   www.google.com.access_token_url

# arm - ARM系统上的Bootrom与引导加载程序有什么区别

> ID：15665052
> 
> 赞同：30
> 
> 时间：2013-03-27T17:10:35.123
> 
> 标签：arm, bootloader

我主要来自 x86 系统背景，其中 BIOS（固件）负责从 PowerON 加载引导加载程序（如 GRUB），然后加载操作系统。我现在一直在阅读 ARM 系统上的等效引导序列，似乎网上有文章提到了两个术语：bootrom 和 bootloader。

一些文章提到，从 PowerON 开始，引导加载程序（如 u-boot）是首先执行的，而一些文章说，从 PowerON 开始，首先执行 bootrom（通常在处理器的内部 ROM 上闪烁），然后依次加载引导加载程序（如uboot) 然后加载操作系统。

任何人都可以提供一些关于bootrom vs bootloader的说明吗？另外，我想知道 ARM 系统中通常使用的流行 bootrom 的名称。

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2013-03-27T17:59:18.867

以下是我对这些条款的理解。

## 引导程序

Bootrom（或 Boot ROM）是嵌入在处理器芯片中的一小块掩膜 ROM 或写保护闪存。它包含处理器在上电或复位时执行的第一个代码。根据一些带引脚或内部保险丝的配置，它可能决定从哪里加载要执行的下一部分代码以及如何或是否验证它的正确性或有效性。有时它可能包含附加功能，可能在引导期间或之后可由用户代码使用。一些例子：

*   iPhone 启动 ROM。嵌入在掩码 ROM 中，无法修改。从闪存或 USB（在 DFU 模式下）加载下一阶段的引导加载程序，并使用内置的 RSA 实现验证其签名。还为下一阶段的引导加载程序提供加速解密功能。

*   TI 的 OMAP4 引导 ROM。可以从闪存（NOR、NAND、OneNAND）、外部存储器、SD/MMC、USB 或 UART 加载用户代码。引导顺序和选项由带 (SYSBOOT) 引脚设置。为后期阶段提供一些功能（缓存/TLB 管理等）

*   NXP 的 LPCxxxx 系列引导 ROM。放置在内部闪光灯的隐藏部分，开机时映射为 0。实现 CRP（代码读取保护）、ISP（系统内编程），允许通过 UART 上传和刷新新代码。如果有效的用户代码在闪存中（需要有正确的校验和），则将其映射到 0 并跳转到它。bootrom 的一部分仍然映射以提​​供 IAP（应用内编程）和其他一些服务。

## 引导加载程序

Bootloader 负责查找和加载应该在芯片上运行的最终操作系统或固件。与 bootrom 的一个主要区别是它通常位于可写闪存中，并且可以更换或升级。

有时 bootrom 可以执行引导加载程序的工作。例如，OMAP 的 bootrom 非常复杂（它可以解析 FAT32！），您可能可以让它直接加载并启动 Linux 内核。

但是，在许多情况下，会使用单独的引导加载程序，要么是因为 bootrom 功能不足（或不存在），要么是因为需要额外的灵活性。它可以非常简单（从 RAM 中的固定闪存位置加载内核并跳转到它），也可以更复杂。例如，[U-Boot](http://www.denx.de/wiki/U-Boot)本身就像一个迷你操作系统——它有一个控制台、一些命令，允许你中断引导过程，例如修改内核命令行参数，甚至从不同的位置加载内核（SD/ MMC 或 USB），运行一些测试等等。

当您有一个或多或少复杂的操作系统时，通常会使用引导加载程序，这可能需要一些设置才能启动。像 NXP 的 LPC 系列这样的小型微控制器通常使用单片固件，因此它们可以在没有它的情况下正常运行（但是，它们也可能有[定制的引导加载程序](http://www.lpcware.com/content/nxpfile/an10866-lpc1700-secondary-usb-bootloader)）。

在最简单的芯片上可能根本没有引导 ROM 或引导加载程序——它们只是尝试从固定的启动地址获取和执行指令。事实上，迄今为止，大多数 x86 芯片都是这样工作的——它们只是在 FFFFFFF0 开始执行代码，并期望芯片组已将 BIOS 闪存芯片映射到那里。在这里，您可以说 BIOS 是引导加载程序（尽管它也为操作系统提供服务，类似于 bootrom）。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2016-09-05T11:17:17.823

ARM CPU 可以具有闪存 ROM，即芯片掩码包含一些用于加载 BIOS 的代码。关于 GPU 执行大部分启动顺序的说法很多，但我有保留意见。GPU 是否运行 ARM 代码？没有。所以，面对正式版的启动顺序，我从原始GPU数据中看到，32K被复制到L2缓存中（因为DRAM还没有打开），从那时起，CPU运行代码到从 SDRAM 加载 BIOS。引导序列中未启用任何 Trustzone 设置。这允许裸机编码器（嵌入式系统）将绝大多数 CPU FlashROM 用作向量表，以便您可以轮询硬件并根据需要设置向量。TZ 的东西没有有用的属性，因为 Smurf Suite 证明它不安全。但是，如果您将该空间用于向量，如果有人重新刷新，操作系统就会死掉。

# php - 数组中的strstr

> ID：15665063
> 
> 赞同：0
> 
> 时间：2013-03-27T17:10:56.327
> 
> 标签：php, arrays

我有代码需要检查每次长度都会变化的特定字符串是否在数组中的字符串内，该字符串每次长度也会变化。

我可以使用'strstr'检查文本是否在特定字符串中，我可以使用'in_array'检查字符串是否在数组中，但我似乎无法将两者连接起来。

尽可能简单地说：

```
$array = array([0]=>'12345',[1]=>'67890');
if(in_array(strstr(3,$array)))
= true
or
= 0 (being the key) 
```

（显然这行不通，但希望它有助于展示我正在尝试做的事情）

我已经考虑将数组分解成多个部分并以这种方式单独比较每个部分，但我担心数组的大小以及它必须在一次运行中完成此操作的次数可能会导致速度问题。此外，如果有一种更清洁的方式，任何人都可以想到它会更好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T17:34:28.780

您可以使用 PHP 中的函数式编程来实现它。自 PHP 5.3 以来，它得到了很大的改进。但是，我不得不承认，我认为即使找到了元素，它也会遍历整个数组。迭代解决方案（见下文）可能会停止。

函数式的解决方案可能看起来也有点复杂，所以如果你不明白，只需使用下面的迭代式即可；）我只是写了它，因为我认为函数式通常对于数组任务来说是优雅的。

```
<?php

function checkIfInArrayString($array, $needle) {
    $found = array_reduce($arr, function($isFound, $value) use ($needle) {
        return $isFound || false !== strpos($value, $needle);
    }, false);

    return $found;
}

$arr = array(
    'foo',
    'my',
    'test'
);

var_dump(checkIfInArrayString($arr, 'oo'));
var_dump(checkIfInArrayString($arr, 'ooo')); 
```

这是同一问题的迭代解决方案（未经测试）：

```
function checkIfInArrayString($array, $searchingFor) {
    foreach ($array as $element) {
        if (strpos($element, $searchingFor) !== false) {
            return true;
        }
    }
    return false;
} 
```

我使用`strpos`了代替`strstr`，因为当您只需要知道一个字符串是否与另一个字符串一起时，PHP 文档建议使用它。`strpos`返回的信息更少，因此实现更轻松。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T17:25:20.890

如果这就是你想要做的，我不能完全确定你的问题，但看起来一个简单的 preg_match() 可以解决你的问题。假设您正在寻找包含在字符串 " `somethingsomething`"... `hello world`..." " 中的字符串 "hello world `somethingelse`"。

您只需使用

```
preg_match(/somethingsomething(.*)hello world(.*)somethingelse/, $haystack); //return 1 if found 
```

一个更简洁的示例：如果您`str`在两次出现的`::`

```
preg_match(/::(.*)str(.*)::/, $haystack); //if (found) return 1; 
                                          //if (!found) return 0; 
                                          //if (err) return false;

$multiple_occurences = /::(.*)(str)(.*)::/;
$single_occurence    = /::(.*)str(.*)::/; 
```

我希望这让它更清楚一点。如果您对 preg_match() 方法有任何疑问，文档非常有帮助：[preg_match() 文档。](http://php.net/manual/en/function.preg-match.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-08-29T17:23:00.170

我意识到这已经很老了，但现在有`preg_grep()`

```
$array = array([0]=>'12345',[1]=>'67890');
$result = preg_grep('/3/',$array); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-12-14T14:28:23.563

```
 if ( in_array("search string", $array) ) echo "search string is in the array"; 
```

# java - JBoss logging - 记录依赖项目

> ID：15665064
> 
> 赞同：0
> 
> 时间：2013-03-27T17:10:58.803
> 
> 标签：java, logging, jboss, log4j, jboss5.x

我们使用 JBoss 5.1 来部署我们所有的服务。但是我们遇到了这个问题。

假设我们有 2 个项目“A”和“B”。“A”和“B”都有自己独立的日志文件，可以将内容记录到“A.log”和“B.log”中。这两个项目都使用公共依赖项“C”。现在，如果项目'A'调用'C'并且'C'中有记录器语句，则需要将其记录到'A.log'，因为'C'是从'A'调用的。同样，如果项目“B”调用“C”，则“C”中的记录器语句应记录到“B.log”。

我们如何配置 JBoss 和 log4j 来实现这种日志记录？

提前谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T00:51:58.113

您应该在 log4j 附加程序中为“A”和“B”使用 TCLFilter/TCLMCFilter 来分离共享类的应用程序日志。在此 wiki 上阅读有关它的更多信息[- SeparatingApplicationLogs](https://community.jboss.org/wiki/SeparatingApplicationLogs)

例如：

```
<appender name="LogA" class="org.apache.log4j.FileAppender">
      <errorHandler class="org.jboss.logging.util.OnlyOnceErrorHandler"></errorHandler>
      <param name="Append" value="false"/>
      <param name="File" value="some_directory/log/a.log"/>
      <layout class="org.apache.log4j.PatternLayout">
         <param name="ConversionPattern" value="%d{ABSOLUTE} %-5p [%c{1}] %m%n"/>
      </layout>
      <filter class="org.jboss.logging.filter.TCLMCFilter">
         <param name="AcceptOnMatch" value="true"/>
         <param name="DeployURL" value="a.ear"/>
      </filter>    
</appender> 
```

请注意，对于 .war 文件，文件名更改为“a-exp.war”，因此如果您使用的是战争，则需要相应地更改“DeployURL”。

# node.js - 将应用程序作为 Windows 服务运行时的命令行输出

> ID：15665067
> 
> 赞同：1
> 
> 时间：2013-03-27T17:11:02.220
> 
> 标签：node.js, logging, windows-services

在 Windows 2008 R2 环境中，我有一个 socket.io 聊天应用程序，我目前正在从命令行启动：

```
node app.js 
```

这会在屏幕上输出有关应用程序状态的不同信息，我当然可以在命令行窗口中看到这些信息。

我想将节点应用程序作为 Windows 服务运行，我发现[NSSM](http://nssm.cc)将帮助我做到这一点，这很棒。但我也希望能够在需要时查看输出。

**有没有办法获得该输出并将其放入日志文件（类似于 IIS/Apache 日志）？**

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T17:37:41.417

[https://github.com/nomiddlename/log4js-node](https://github.com/nomiddlename/log4js-node)允许您以多种输出类型保存日志，文件就是其中之一。

可以使用它来替换您选择的新输出中的控制台输出。

```
var log4js = require('log4js');

log4js.loadAppender('file');
log4js.addAppender(log4js.appenders.file('output.log'));

// the important part ;)
log4js.replaceConsole()
//

var logger = log4js.getLogger();
logger.debug("Debug message");

console.log('debug from the console'); 
```

# javascript - 从 JSON 对象中提取值

> ID：15665068
> 
> 赞同：1
> 
> 时间：2013-03-27T17:11:03.173
> 
> 标签：javascript, json

我有从 URL 传入的以下数据。我在递归打印 JSON 对象时看到的所有示例都处理对称的对象，例如[这个](https://stackoverflow.com/questions/4017122/jquery-reading-nested-json)对象。但是当每个元素都有一个特定的名称时，我将如何在 DIV 中打印以下内容？我必须手动引用每个字段吗？

我是 JSON 新手，因此我们将不胜感激。

```
var data = {
    {
            "Message": "success",
            "Status": "done",
            "providerResponse": {
            "referenceNumber": "9876542",
                "errorCode": "0",
                "errorMessage": "Approved",
                "accountNum": "XXXXXXXXXXXX0109",
                "expirationDate": "0116",
                "customerName": "MILTON BERLE",
                "customerAddress1": "614 BROADWAY",
                "customerCity": "NEW YORK",
                "customerState": "NY",
                "customerZIP": "01019",
        }
    }
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T17:14:32.010

不，你没有。你一个一个地循环键。

```
var obj = JSON.parse(jsonString);
for (key in obj) {
    alert(key + " = " + obj[key]);
    // or do other stuff with the keys and values
} 
```

# ios - 更改集合内的对象

> ID：15665069
> 
> 赞同：0
> 
> 时间：2013-03-27T17:11:07.547
> 
> 标签：ios, objective-c

我真的不知道为什么这很难找到.. 但基本上我在一个对象中有一个集合，我需要更改集合的值。

对象可能会或可能不会预先填充数据，但用户可以进行选择以填充此集合。不管集合中是否已经有数据，如果用户这样做，我需要清除集合中的所有对象并将其替换为用户选择的对象。

但是，如果已经存在数据，则 NSSet 的 setByAddingOjbectsFromArray 方法不会重新创建新集合。

我到底错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T17:14:15.470

NSMutableSet 能满足你的需要吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T17:17:31.583

如果您不想保留集合中的内容，请不要使用：

```
mySet = [NSSet setWithArray:myUserChoices]; 
```

# treeview - Gnome 3 Javascript (GJS) - TreeView - 选择下一个/上一个项目

> ID：15665070
> 
> 赞同：1
> 
> 时间：2013-03-27T17:11:19.793
> 
> 标签：treeview, gtktreeview, gnome-3, gjs

一个月前，我听说了用于 GNOME 3 的 GJS，我想尝试一下。我想做什么？带有 GJS 的 GNOME 3 的简单媒体播放器。

所以，基地已经被编程，例如：

*   创建 ListStore 并将其连接到 TreeView 对象
*   OpenFile 对话框 - 选择 MP3/OGG​​/WAV 文件
*   从 OpenFile Dialog 获取文件名和 URI 并将其放入 Gtk.ListStore 对象
*   当文件被选中（在 TreeView 对象中）时，Gst 对象从当前选定的行中获取 URI。

现在的问题是我想手动更改 TreeView 对象中选定的行（当用户按下前进或后退按钮时），我不知道如何执行此操作。

我在官方的 GNOME-Docs 和非官方的 Seed[文档](http://www.roojs.com/seed/gir-1.2-gtk-3.0/gjs/index.html)中查找了它，然后谷歌搜索了它，但没有任何结果。我试图用 GNOME 3 的 C-Docs 找到它，但仍然没有。

我希望有人可以帮我解决这个“小”问题。:)

简单音乐播放器的[链接。](https://github.com/fubaharu/music-player/blob/master/music.js)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T18:03:07.187

好的，我刚刚找到了答案：

```
// Get the selection from the Gtk.TreeView Object
this.selection = this._soundList.get_selection ();
// Get the bool "isSelected", the model and the Iter from this.selection.get_selected()
let [ isSelected, model, iter ] = this.selection.get_selected();
// Get the previous row in the list (iter_next(iter) for the next row)
this._listStore.iter_previous(iter);
// The selection should get updated
this.selection.select_iter(iter);
// Get the URI from the Gtk.ListStore Object
this.sound.uri = this._listStore.get_value (iter, 1); 
```

我希望这将帮助那些需要它的人。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-02-26T07:29:08.140

有很好的例子： [https ://github.com/optimisme/gjs-examples](https://github.com/optimisme/gjs-examples)

使用“TreeView”的是 egList.js，但 egOpen.js 也有一个使用 Gtk.ListStore、Gtk.CellRendererTex 和 Gtk.TreeIter 的 Gtk.ComboBox 来自一个“更改”事件。

# three.js - 在 Phong 着色器中计算聚光灯锥上的位置

> ID：15665074
> 
> 赞同：0
> 
> 时间：2013-03-27T17:11:40.397
> 
> 标签：three.js

我正在尝试在 WebGLRenderer 的 PhongMaterial 中为 THREE.SpotLight 实现轻质 cookie（或图案图案、轻质纹理或轻质遮罩）。目的是能够为灯光附加纹理，如下所示：[http](http://www.idjnow.com/ProductImagesLarge/GOBO-GLASS1C.jpg) ://www.idjnow.com/ProductImagesLarge/GOBO-GLASS1C.jpg纹理会降低灯光的强度，产生类似阴影的效果投影。

我想我已经涵盖了“将纹理附加到灯光并将其作为制服传递以在着色器中查找”，尽管无法对其进行测试，因为我在计算我在聚光灯锥体/聚光灯中的位置时遇到了问题。

我看到这里计算了聚光灯的光贡献（我直接修改 Three.js 源，而不是创建自己的材质）：

[https://github.com/mrdoob/three.js/blob/master/src/renderers/WebGLShaders.js#L1013](https://github.com/mrdoob/three.js/blob/master/src/renderers/WebGLShaders.js#L1013)

聚光灯的位置是一个圆圈，对吧？或椭圆，如果它在一个角度。所以我需要在这里添加一些代码，它会告诉我我在聚光灯下的位置（xy 坐标）。我可以在纹理查找上映射这些坐标，相应地降低 spotDiffuse，并希望有工作的图案投影。

我如何计算与每盏灯相关的这些坐标？

或者有没有更好的方法在 Three.js 中实现光饼干/图案/光纹理/光蒙版？我看到它是游戏引擎中的一个流行功能，如果有这样的内置功能会很好。[http://docs.unity3d.com/Documentation/Components/class-Light.html](http://docs.unity3d.com/Documentation/Components/class-Light.html)很好地描述了我正在寻找的内容（cookie 部分）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-31T17:03:00.140

看看这里：[http ://www.evpopov.com/threejstest/test_spot_projtexture.html](http://www.evpopov.com/threejstest/test_spot_projtexture.html)

我认为它正在做你想做的事。

它实际上是标准的投影纹理，除了纹理不是“按原样”使用而是衰减照明计算。

对于这个示例，我使用了投影纹理的 Alpha 通道作为衰减因子。

为了创建我使用的顶点/片段着色器，我从 phong 材质中获取了顶点/片段着色器，并且只保留了聚光灯渲染的相关部分。我还设置了一个恒定的环境颜色以避免出现黑色区域​​（在斑点范围之外）。

投影纹理的特定代码在顶点/片段着色器中具有以 // 开头的注释，如果您想在自己的着色器中重用它。

您还必须生成与您的灯光相对应的投影矩阵：该`makeProjectiveMatrixForLight`函数为您完成 => 它与您在三个用于阴影映射的 JS 源代码中找到的代码几乎相同。

启动示例时，墙壁旋转，聚光灯保持固定。`moveLightTarget`您可以通过更改为来使聚光灯的目标移动`true`，在这种情况下，您需要设置`rotateCube`为`false`以更好地查看正在发生的事情。

# java - Android Java 保存 http 请求的 cookie

> ID：15665076
> 
> 赞同：-1
> 
> 时间：2013-03-27T17:11:41.203
> 
> 标签：java, android, http, request

我刚刚找到了一个教程，其中有人解释了如何在 android 应用程序中执行 http 请求。现在我需要保存 cookie。它显示了，`PersistentCookieStore myCookieStore = new PersistentCookieStore(this)`但我需要这样做，因为`public`这样`this`不起作用：/谁能帮我写什么而不是这个？

问候，菲尔

PS：教程在这里： http: [//loopj.com/android-async-http/](http://loopj.com/android-async-http/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T17:19:28.033

根据教程， PersistentCookieStore 需要“上下文”作为参数。您可以执行 PersistentCookieStore(YourActivity.this) 或 PersistentCookieStore(getApplicationContext())。（YourActivity 是活动标题。）希望这会有所帮助。

谢谢

这是一个简单的例子。

```
package com.example.fixit;
import android.os.Bundle;
import android.app.Activity;
import android.view.Menu;
import com.loopj.android.http.*;
import android.util.Log;
public class MainActivity extends Activity {
    private static String TAG="MainActivity";
    private PersistentCookieStore myCookieStore;
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    AsyncHttpClient client = new AsyncHttpClient();
    myCookieStore = new PersistentCookieStore(this);
    client.setCookieStore(myCookieStore);
    client.get("http://www.google.com", new AsyncHttpResponseHandler() {
        @Override
        public void onSuccess(String response) {
            Log.i(TAG, response);
        }
    });
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
}
} 
```

# ios - 我的 iOS 应用程序不会遍历我的字符串

> ID：15665077
> 
> 赞同：-1
> 
> 时间：2013-03-27T17:11:43.763
> 
> 标签：ios, objective-c, nsstring

我意识到这是一个非常基本的问题，其他帖子似乎没有帮助，因为我对此很陌生。我很好奇为什么 A.）我的 for 循环不会遍历我的字符串（问题），为什么 B.）它只打印最后一个问题“你的姓氏是什么？” 当我单击目标操作按钮时，在我的 iOS 模拟器上。我所有的连接都是正确的，显然，如果它的构建，我的 .h 中的一切都很好。

感谢您的帮助！

```
- (IBAction) question;
{
    for (int i = 0; i < 5; i++)
    {
        questionLabel.text = @"Whats your name?";
        questionLabel.text = @"Whats your age?";
        questionLabel.text = @"Whats your height?";
        questionLabel.text = @"Whats your weight?";
        questionLabel.text = @"Whats your last name?";

    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-27T17:12:37.740

它正在遍历您的字符串！它的速度如此之快，以至于你所看到的只是最后一个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T17:16:27.980

这些日志会给你一个确切的想法

```
- (IBAction) question;
 {
  for (int i = 0; i < 5; i++)
  {

    NSLog(@"Iteration: %d",i);

    questionLabel.text = @"Whats your name?";
    NSLog(@"%@",questionLabel.text);

    questionLabel.text = @"Whats your age?";
    NSLog(@"%@",questionLabel.text);

    questionLabel.text = @"Whats your height?";
    NSLog(@"%@",questionLabel.text);

    questionLabel.text = @"Whats your weight?";
    NSLog(@"%@",questionLabel.text);

    questionLabel.text = @"Whats your last name?";
    NSLog(@"%@",questionLabel.text);

 }
} 
```

如果您想在同一个标​​签（`questionLabel`）上显示所有问题，请编写以下代码

```
 - (IBAction) question;
 {
   for (int i = 0; i < 5; i++)
   {

    NSLog(@"Iteration: %d",i);

    questionLabel.text = @"Whats your name?";
    NSLog(@"%@",questionLabel.text);

    questionLabel.text = [questionLabel.text stringByAppendingFormat:@"Whats your age?"] ;
    NSLog(@"%@",questionLabel.text);

    questionLabel.text = [questionLabel.text stringByAppendingFormat:@"Whats your height?"] ;
    NSLog(@"%@",questionLabel.text);

    questionLabel.text  = [questionLabel.text stringByAppendingFormat:@"Whats your weight?"] ;
    NSLog(@"%@",questionLabel.text);

    questionLabel.text  = [questionLabel.text stringByAppendingFormat:@"Whats your last name?"] ;
    NSLog(@"%@",questionLabel.text);

 }
} 
```

如果你想在不同的标签上显示所有的问题，创建不同`UILabel`的，请写下面的代码

```
- (IBAction) question;
 {
  for (int i = 0; i < 5; i++)
  {

    NSLog(@"Iteration: %d",i);

    questionLabel.text = @"Whats your name?";
    NSLog(@"%@",questionLabel.text);

    questionLabel1.text = @"Whats your age?";
    NSLog(@"%@",questionLabel1.text);

    questionLabel2.text = @"Whats your height?";
    NSLog(@"%@",questionLabel2.text);

    questionLabel3.text = @"Whats your weight?";
    NSLog(@"%@",questionLabel3.text);

    questionLabel4.text = @"Whats your last name?";
    NSLog(@"%@",questionLabel4.text);

 }
} 
```

# database - 在图 DB 中找到 N 个特定类型的邻居

> ID：15665082
> 
> 赞同：1
> 
> 时间：2013-03-27T17:12:00.140
> 
> 标签：database, graph, neo4j, dijkstra

假设我有一个有 100k 节点和 500k 边的有向图。其中 15k 个节点是“重要的”。我需要从一个特定节点开始找到 100 个最近的“重要”节点。

我在 C# 中实现了 Dijkstra 算法，它可以找到从起始节点到所有其他节点的距离。然后我按距离对“重要”节点进行排序并首先返回 100。这大约需要 1 秒钟。

现在我需要在服务器端（Linux）做同样的事情，可能有很多并发查询和不同的起始节点。我尝试过 node4j 图形数据库，在与开发人员协商后，我们得到了在 10-20 秒内完成相同操作的解决方案（实际上，如果我们计算没有长度限制的路径，大约需要 10 分钟）。这需要很长时间，因为 neo4j 存储所有最短路径，而我的 C# 实现只存储距离。在 neo4j 中使其更快的唯一选择是编写扩展，这不是微不足道的。

所以问题是：是否有任何图形数据库（非商业）可以安装在 Linux 服务器上并且能够快速运行这样的查询？我检查了维基百科列表中的所有图形数据库，但没有找到合适的。

另一种选择是在 Java 中实现相同的算法并创建一个服务（Tomcat？），它将存储图的共享副本（如何？）并回答这些查询。但我更喜欢准备好的东西...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T04:47:02.670

编写一个 Neo4j 扩展来做到这一点并不像你想象的那么糟糕。

见这里的例子： http: [//maxdemarzi.com/2012/11/26/extending-neo4j/](http://maxdemarzi.com/2012/11/26/extending-neo4j/)

这个使用 A* 算法进行“自定义”寻路：http: [//maxdemarzi.com/2012/11/27/pathfinding-with-neo4j-unmanaged-extensions/](http://maxdemarzi.com/2012/11/27/pathfinding-with-neo4j-unmanaged-extensions/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T10:26:36.730

这是对@MaxDeMarzi给出的答案的补充......

您提到您的 C# 实现：**（1）**查找从起始节点到所有其他节点的距离，（ **2）**按距离排序“重要”节点，**（3）**首先返回 100。

为了提高效率，你可以做这样的事情吗？

```
top = 100 
```

然后，每次 Dijkstra 找到到新节点的最短路径时：

```
if (isImportant(node)) resultSet.add(node,distance)
if (resultSet.size() >= top) return resultSet 
```

这将避免找到您不感兴趣的节点的路径

# javascript - mvc4：级联下拉菜单

> ID：15665086
> 
> 赞同：0
> 
> 时间：2013-03-27T17:12:08.273
> 
> 标签：javascript, jquery, asp.net-mvc-4

我似乎无法理解 ajax 和 json

我想做一个级联下拉菜单，我试图将数据放到一个 div 开始。这是脚本

```
<script src="~/Scripts/jquery-ui-1.8.20.js"></script>
<script src="~/Scripts/jquery-ui-1.8.20.min.js"></script>
<script>

    $(function () {
        $('#funtiontype').change(function () {
            var selectedValue = $(this).val();

            $.ajax(
                {
                  // url: $(this).data('url'),
                  // source: "/EmployeeReps/GetDescription",
                url: "~/EmployeeReps/GetDescription",
                type: 'GET',
                cache: false,
                data: {value: selectedValue },
                success: function (result) {
                      $('#description').html(result.employeelist);
                     }
                });

            });

        });

</script> 
```

和控制器

```
[AcceptVerbs(HttpVerbs.Get)]
        public ActionResult GetDescription(string value)
        {

            //get the data from DB
            var employeelist =(from s in db.tble_employeeReps where s.em_function==value 
                             select s);

            return Json(employeelist.ToList(), JsonRequestBehavior.AllowGet);
        } 
```

HTML @using (Html.BeginForm()) {

```
 <fieldset>

        <div class="editor-label">Function*</div>
        <div class="editor-field">

          <select id = "funtiontype">
               <option value = "">Please Select</option>
               <option value = "Finance">Finance</option>
               <option value = "Non-Finance">Non-Finance</option>
          </select>
        </div>

        <p></p>
        <p>
            <input type="submit" value="Vote" />
        </p>
    </fieldset>
    <div id="description"></div>
} 
```

但我正在努力获取任何数据。请任何人都可以帮助

非常感谢提前赫什

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T17:38:21.063

控制器中的这一行：

```
 return Json(employeelist.ToList(), JsonRequestBehavior.AllowGet); 
```

正在将您的员工列表更改为 JSON 字符串。字符串是一个对象数组。

在您的 ajax 调用中：

```
 $.ajax(
            {
              // url: $(this).data('url'),
              // source: "/EmployeeReps/GetDescription",
            url: "~/EmployeeReps/GetDescription",
            type: 'GET',
            cache: false,
            data: {value: selectedValue },
            success: function (result) {
                  $('#description').html(result.employeelist);
                 }
            });

        }); 
```

`result`是同一个对象数组。 `result`不会有一个名为`employeelist`. 它实际上是一组员工。

您将需要在该数组上循环并创建 HTML 以显示员工：

```
 $.ajax({
            url: "~/EmployeeReps/GetDescription",
            type: 'GET',
            cache: false,
            data: {value: selectedValue },
            success: function (result) {
                var employeeHTML = "";
                for(count = 0; count < result.length; count++) {
                    employeeHTML += "<p>" + result[count].EmployeeName + "</p>"; //your fields here
                }
                $('#description').html(employeeHTML);
            });
        }); 
```

# regex - 在一些随机单词之后替换所有内容

> ID：15665097
> 
> 赞同：0
> 
> 时间：2013-03-27T17:12:32.693
> 
> 标签：regex, notepad++

嗨，我怎样才能在一些随机词之后替换所有内容

前任：

```
text/col_det/keywords
text/col_ret/excalibur
text/col_get/random
text/col_free/read 
```

所以一切都会变成

```
text/col_det/
text/col_ret/
text/col_get/
text/col_free/ 
```

试过这个但不工作

找什么：

```
text/col_(.*?)/.* 
```

用。。。来代替：

```
 Blank 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T17:20:56.033

如果我理解正确，那么如果您将正则表达式更改为替换，它应该可以工作

```
text/col_\1/ 
```

`\1`是您搜索的正则表达式内括号之间的文本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T17:20:57.517

`text/col_(.*?)/.*`匹配整行，将其替换为空将清除该行。

这应该有效：

代替

```
^text/col_(.*?)/.*$ 
```

和

```
text/col_\1/ 
```

`^`- 行首
`$`- 行尾
`\1`- （基本上）您放在括号中的第一件事的匹配字符串，所以`(.*?)`在这种情况下匹配的内容。

在这种情况下，行首和行尾可能是可选的。

请记住将搜索模式选择为正则表达式。

# jquery - 使用带有 jQ uery 优化的 Control 和 Shift 键更改列表选择的行为 - 更新 2

> ID：15665099
> 
> 赞同：0
> 
> 时间：2013-03-27T17:12:35.720
> 
> 标签：jquery, list, dynamic, selection

我正在处理一个包含人员列表的页面。用户需要能够选择一行或多行。我希望该页面的行为类似于 Windows 资源管理器，其中单击一次只能选择一个人，但 Control 和 Shift 键允许进行多项选择。

我已经用 jsFiddle 编写了一个示例，据我所知，它可以在 Firefox 和 IE10 上运行。

```
var first_num;
var second_num;
var low_num;
var high_num;
var i;
var selected;
var multiple_lines_selected = 0;

$('label').click(function(e){
    if (e.shiftKey){
        multiple_lines_selected = 1;
        $('input').prop('checked', false);
        first_num = parseInt(selected.replace(' input','').replace('#n',''));
        second_num = parseInt($(this).attr('ID').replace('n',''));
        low_num = Math.min(first_num,second_num);
        high_num = Math.max(first_num,second_num);
        i = low_num;
        while (i<=high_num) {
            $('#n'+i +' input').prop('checked', true);
            i++;
        }
    }
    else if (e.ctrlKey){
        multiple_lines_selected = 1;
        selected = '#'+$(this).attr('ID') +' input';
        if (!$(selected).is(':checked')) {$(selected).prop('checked', true);}
        else {$(selected).prop('checked', false);}
    }
    else {
        selected = '#'+$(this).attr('ID') +' input';
        $('input').not(selected).prop('checked', false);
        if (multiple_lines_selected) {
            setTimeout(function(event){$(selected).prop('checked', true);});
        }
        multiple_lines_selected = 0;
    }
});
$('label').mousedown(function(e){
    window.getSelection().removeAllRanges();
}); 
```

HTML 只是一个重复

```
<label id="n1" class="row">
    <input type="checkbox" />Person 1
</label> 
```

我感谢任何建议或帮助！

链接到 jsFiddle：http: [//jsfiddle.net/mExp4/1/](http://jsfiddle.net/mExp4/1/)

**编辑 1**：在 Chrome 上，我发现了一个奇怪的错误。如果我在按住控制键的同时单击该行，一切都会按预期运行。但是，如果我单击实际的复选框，则没有任何变化。想法？

**编辑 2**：我在 Chrome 中发现的“错误”也存在于 Firefox 和 IE 中，我只是没有注意。而且我不确定这是一个错误，但我仍然无法弄清楚如何绕过它。当我单击标签时，一切正常。当我单击复选框时，在使用控制键时，事情并没有那么好。

我认为这可以追溯到这样一个事实，即当您控制或切换时，单击标签不会激活内部的复选框，而没有 javascript。这阻碍了我使用 .change 而不是 .click 的尝试。有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T17:58:23.483

我想出了解决问题的方法，但这是一个破解的答案，所以我仍然愿意接受更好的选择。基本上，我添加了一个悬停在复选框顶部的不可见 div。它在里面，所以点击它仍然会激活复选框。但是，它通过标签激活它，而不是同时激活标签和复选框。

对于不使用 javascript 的人来说，它以脚本开头`display:none`并由脚本显示。这里的一个目标是拥有一个在残疾时优雅的人。

```
.checkbox_overlay {
    height:40px;
    width:20px;
    display:none;
    position:absolute;
    margin-top:-10px;
    float:left;
}

<label id="n1" class="row">
    <div class="checkbox_overlay"></div>
    <input type="checkbox" />Person 1
</label> 
```

工作示例：http: [//jsfiddle.net/mExp4/4/](http://jsfiddle.net/mExp4/4/)

# episerver - Episerver 一些真正使用的图像在文件摘要中没有“相关页面”

> ID：15665105
> 
> 赞同：0
> 
> 时间：2013-03-27T17:12:42.493
> 
> 标签：episerver, episerver-6

在 Episerver FileManagement 中，一些图像在文件摘要中“没有相关页面”，但有些页面使用这些图片。更新、站点重启、重新索引没有帮助。图像由某个控件显示，该控件从 PropertyImageUrl（或其他一些，我也尝试过 PropertyString）类型属性获取图像路径。控制呈现像

```
var imageControl = new Image();
imageControl.ImageUrl = MediaFile; //string MediaFile - comes from property
imageControl.AlternateText = AltText;
if (ImageHeight != 0) imageControl.Height = ImageHeight;
if (ImageWidth != 0) imageControl.Width = ImageWidth;
Controls.Add(imageControl); 
```

但是有些图像只是静态写入的标签，具有静态 src 值，例如

```
<img src="/Global/image.jpg"/> 
```

这些方法中的任何一种（使用控制或静态标签）都不适用于新添加到 episerver 文件系统映像的一个 - 它仍然“没有相关页面”。但是文件管理器中的其他一些图像通常会显示相关页面，这些图像在其相关页面上的呈现方式与我上面描述的方式相同。VPP 提供程序是默认的，filesummary.config 也是默认的。似乎一些真正使用的随机图像在文件摘要中没有相关页面。这似乎不取决于图像在页面上的显示方式。也许你有一些关于 Episerver 在文件摘要中创建“相关页面”列表的方式的信息？我还能尝试什么？也许 Episerver 需要一段时间来更新这些信息？它存储在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T08:30:12.643

EPiServer 索引引用有一些延迟，所以你不会立即看到结果，但你肯定会在发布后一分钟看到结果。

**仅当**图像和页面链接包含在具有实现的**属性类型的****页面数据属性**中时，它们才会被索引。在某些情况下，此类属性应标记为。**`IReferenceMap``IsSearchable`**

 **因此，您可以期望对以下属性类型的图像进行索引：

*   `PropertyUrl`, `PropertyFileUrl`, `PropertyDocumentUrl`,`PropertyImageUrl`
*   `PropertyXhtmlString`
*   `ProperyLinkItemCollection`
*   奖励属性 -`PropertyPageReference`因为 EPiServer 将其与所有其他属性分开处理。注意处理图像，但很高兴知道

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T07:18:39.980

模板中的图像没有“索引”，因此它们不会有相关页面。

如果您在 PropertyImageUrl 或 XHTML 属性中选择其中一个图像（即通过 TinyMCE 编辑器），那么它是否会有相关页面？**

# google-apps-script - 如何让 Cucumber/Capybara/Mechanize 对抗外部非 Rails 站点

> ID：15665106
> 
> 赞同：8
> 
> 时间：2013-03-27T17:12:45.053
> 
> 标签：google-apps-script, cucumber, capybara, mechanize, bdd

我正在尝试在 Google App Script 上执行 BDD。我知道原则上我应该能够使用 Cucumber、Capybara 和 Mechanize 的某种组合在非 Rails 外部站点上执行 BDD。在这种情况下，我正在尝试测试我创建的 Google App Script。

到目前为止，我已经在这个项目中获得了完整的代码：

[https://github.com/tansaku/GoogleAppScriptBDD](https://github.com/tansaku/GoogleAppScriptBDD)

但是我目前陷入此错误：

```
rack-test requires a rack application, but none was given (ArgumentError) 
```

我知道我不想使用机架，我一直在搜索论坛和堆栈溢出，到目前为止，我最好的猜测是在我的黄瓜 env 文件中是这样的：

```
require 'capybara/cucumber'
Capybara.run_server=false
Capybara.current_driver = :mechanize 
Capybara.app_host = 'https://script.google.com/macros/s/AKfycbytA2xBsaQ0_FSJXNkPVXQekBnWD4hXPOaCjCT00wo/dev' 
```

这个 SO 帖子是相关的：

[如何使用 Cucumber 测试非 Ruby、非 Rack API](https://stackoverflow.com/questions/7934013/how-to-use-cucumber-to-test-non-ruby-non-rack-apis)

但我想使用 Capybara，因为我正在测试 HTML 界面。此处描述了另一种选择：

[http://blogs.kent.ac.uk/webdev/2012/08/02/using-capybara-webkit-with-cucumber-without-rails-or-rack/](http://blogs.kent.ac.uk/webdev/2012/08/02/using-capybara-webkit-with-cucumber-without-rails-or-rack/)

我一直在关注这里的讨论：

[https://groups.google.com/group/cukes/browse_thread/thread/297163800eaf2968](https://groups.google.com/group/cukes/browse_thread/thread/297163800eaf2968)

但是我真的很想了解如何关闭 Rack 的东西，我希望使用 mechanize 而不是上面提到的博客文章中描述的 webkit，因为我现在更了解 mechanize。

无论如何，这里有最佳实践，还是我只是继续尝试替代方案？

令人抓狂的是，这里的 Capybara 说明： [https](https://github.com/jnicklas/capybara) ://github.com/jnicklas/capybara 说：

> 如果您不使用 Rails，请将 Capybara.app 设置为您的机架应用程序：
> 
> Capybara.app = MyRackApp

但这会产生一个不同的错误“未初始化的常量 Object::MyRackApp (NameError)”，我不确定 MyRackApp 应该是什么，或者在哪里可以找到（我在使用 ruby​​ 时遇到的一般问题：-/）我应该正在通过 cucumber 或 capybara 源来找出 MyRackApp 是什么？

无论如何，我想我会在这里记录所有这些 - 非常感谢任何建议。我希望能够 BDD 我的谷歌应用脚​​本......

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-27T21:14:25.593

> 如果您不使用 Rails，请将 Capybara.app 设置为您的机架应用程序：

它的意思是：

> 如果您正在测试的应用程序是 Rack 应用程序，而不是 Rails，请将 Capybara.app 设置为您的 Rack 应用程序：

Capybara 的 README[因](https://github.com/jnicklas/capybara/commit/8bae811e1c7ab826dc265a60e8a65fe3095226a5) 这个问题而[更新。](https://github.com/jnicklas/capybara/commit/1232a912e4d982c791e4e350ed0de8042b218d7f)

当您想针对外部应用程序运行测试时，您应该设置`Capybara.app_host`而不是`Capybara.app`.

* * *

我没有使用[capybara-mechanize](https://github.com/jeroenvandijk/capybara-mechanize)但我认为它可能不是用于测试外部非机架应用程序的最佳驱动程序。Mechanize 继承自 Racktest，Racktest 用于测试具有 Rack 接口（主要是 Rails）的应用程序。如果你的应用没有 Rack 接口，那么 capybara-mechanize 可能不是最佳选择。

我建议你使用内置的 selenium、[poltergeist](https://github.com/jonleighton/poltergeist)、[capybara-webkit](https://github.com/thoughtbot/capybara-webkit)或[terminus](https://github.com/jcoglan/terminus)

您的代码也可以使用以下方法编写得更好`Capybara.configure`：

```
Capybara.configure do |config|
  config.run_server = false
  config.default_driver = :selenium
  config.app_host = 'https://www.google.com' # change url
end 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-06-24T19:42:00.220

来自 Jeroen van Dijk[在此 Google 群组消息](https://groups.google.com/forum/#!msg/ruby-capybara/9UFnfrc1S-s/TfQO5uBv7gMJ)中，只需将您的 Capybara.app 设置为评估为 true 的内容。IE

```
Capybara.app = "make sure this isn't nil" 
```

只要 Capybara.run_server 设置为 false，它就不会尝试启动应用程序。到目前为止，它对我有用。

# javascript - 如何在弹出/ div 添加时禁用/解决自动滚动到页面末尾的问题

> ID：15665109
> 
> 赞同：0
> 
> 时间：2013-03-27T17:12:49.757
> 
> 标签：javascript, jquery, html, jquery-ui

我已经为弹出创建编写了这段代码：

```
function showPopup(titleString, contentHtml, widthInt, heightInt) {
var popupID = 'dialog-modal';
if ($("#"  + popupID).length == 0) {
    jQuery(document.body).append('<div id="' + popupID + '"/>');
}
var popup = $("#"  + popupID);

popup.html('<div id="' + popupID + '" style="width:100%; height:100%;">' + contentHtml + '</div>');
popup.dialog({
    width : widthInt,
    height : heightInt,
    title : titleString,
    modal : true
}); 
```

}

并且在单击按钮时调用此代码...

问题是 - 当我第一次单击按钮时，页面滚动到最后，并在那里显示弹出窗口。它不会发生，在第二次等等。（我的意思是，在 2,3... 次中，弹出窗口显示在当前页面位置的中间）

似乎，这是特定于 chrome 的，因为它不会发生在 FF 或 IE 中。

所以，问题是 - 为什么会发生？以及如何摆脱它？

（我只在第三天写 JS/html :) 可能是我错过了）

对方法的调用由按钮完成，由 JSF 生成：

```
<input type="button" name="form:j_idt85" value="Show list" class="show-list" onclick="showListInPopup()"> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T17:58:39.623

当不包含 jquery ui 样式表时，我注意到了相同的行为。你的页面上有 ui 样式表吗？

如果没有，请尝试添加：

```
<link rel="stylesheet" href="http://code.jquery.com/ui/1.10.2/themes/smoothness/jquery-ui.css" /> 
```

# jsp - 填充列表 在 Servlet 的 textarea 中

> ID：15665110
> 
> 赞同：-1
> 
> 时间：2013-03-27T17:12:52.633
> 
> 标签：jsp, servlets, textarea, jstl

您好，我`List<String>`在 Servlet 中有这个，我需要将它填充到类似的文本区域中

小服务程序： `List<String> some_words = null; messages.put("property_name",some_words);`

JSP：

```
<textarea name="" id="">${messages.property_name}</textarea> 
```

谁能告诉我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T17:28:56.597

o您可以像这样使用[JSTL foreach](http://docs.oracle.com/javaee/5/tutorial/doc/bnakh.html)：

```
<textarea name="" id="">
  <c:forEach var="word" items="${some_words}">
    ${word},
  </c:forEach>
</textarea> 
```

这将打印它以逗号分隔...

不要忘记您必须在您的 JSP 中导入核心 JSTL 库：

```
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %> 
```

编辑：为了将列表从 servlet 传递到 JSP，您只需将列表存储在会话中并将请求转发给 JSP：

```
HttpSession session = request.getSession(true);
session.setAttribute("some_words", some_words);
request.getRequestDispatcher("anotherPage.jsp").forward(request, response); 
```

请注意，some_words 是您的列表对象，而“some_words”是您为其指定的名称，也是您将在 JSP 中使用的名称。

编辑 2：为了避免在最后一项之后打印逗号，您可以使用 JSTL **if**和**varStatus**，因此您可以像这样改进最后的代码：

```
<textarea name="" id="" varStatus="status">
  <c:forEach var="word" items="${some_words}">
    ${word}<c:if test="${!status.last}">, </c:if>
  </c:forEach>
</textarea> 
```

这样，在每个循环中，您检查当前项是否是最后一项。仅当它不是最后一个时，才打印一个逗号。

# postgresql - 加入大表时，postgres 查询速度慢

> ID：15665112
> 
> 赞同：3
> 
> 时间：2013-03-27T17:12:53.410
> 
> 标签：postgresql, query-optimization

我的查询执行得很慢。我相信问题在于我要加入几个大表，但我仍然希望有更好的性能。查询和解释分析如下：

```
SELECT
    "m_advertsnapshot"."id",
    "m_advertsnapshot"."created",
    "m_advertsnapshot"."modified",
    "m_advertsnapshot"."snapshot_timestamp",
    "m_advertsnapshot"."source_name",
    COUNT(CASE m_advert.widget_listing_id IS NULL and m_advert.height IS NULL WHEN True THEN 1 ELSE null END) AS "adh_count_with_no_wl_and_missing_height",
    COUNT(CASE m_advert.widget_listing_id IS NULL and m_advert.height IS NOT NULL and m_advert.colour_id IS NOT NULL and m_advert.ctype IS NOT NULL WHEN True THEN 1 ELSE null END) AS "adh_count_with_no_wl_and_has_height_plate_ctype",
    COUNT(CASE m_advert.widget_listing_id IS NULL and m_advert.height IS NULL and m_advert.colour_id is NULL and m_advert.ctype is NULL  WHEN True THEN 1 ELSE null END) AS "adh_count_with_no_wl_and_missing_height_and_missing_plate_c268",
    COUNT("m_adverthistory"."id") AS "adh_count",
    COUNT(CASE m_advert.widget_listing_id IS NULL and m_advert.height IS NULL and m_advert.colour_id is NULL WHEN True THEN 1 ELSE null END) AS "adh_count_with_no_wl_and_missing_height_and_missing_plate",
    COUNT("m_advert"."widget_listing_id") AS "adh_count_with_wl"
FROM "m_advertsnapshot"
    LEFT OUTER JOIN "m_adverthistory" ON ("m_advertsnapshot"."id" = "m_adverthistory"."advert_snapshot_id")
    LEFT OUTER JOIN "m_advert" ON ("m_adverthistory"."advert_id" = "m_advert"."id")
GROUP BY
    "m_advertsnapshot"."id",
    "m_advertsnapshot"."created",
    "m_advertsnapshot"."modified",
    "m_advertsnapshot"."snapshot_timestamp",
    "m_advertsnapshot"."source_name"
ORDER BY
    "m_advertsnapshot"."snapshot_timestamp" DESC

"Sort  (cost=796180.41..796180.90 rows=196 width=72) (actual time=18051.504..18051.519 rows=196 loops=1)"
"  Sort Key: m_advertsnapshot.snapshot_timestamp"
"  Sort Method: quicksort  Memory: 60kB"
"  ->  HashAggregate  (cost=796170.99..796172.95 rows=196 width=72) (actual time=18051.330..18051.396 rows=196 loops=1)"
"        ->  Hash Right Join  (cost=227052.68..622950.33 rows=6298933 width=72) (actual time=2082.551..12166.226 rows=6298933 loops=1)"
"              Hash Cond: (m_adverthistory.advert_snapshot_id = m_advertsnapshot.id)"
"              ->  Hash Left Join  (cost=227045.27..536332.59 rows=6298933 width=24) (actual time=2082.483..9971.996 rows=6298933 loops=1)"
"                    Hash Cond: (m_adverthistory.advert_id = m_advert.id)"
"                    ->  Seq Scan on m_adverthistory  (cost=0.00..121858.33 rows=6298933 width=12) (actual time=0.003..1644.060 rows=6298933 loops=1)"
"                    ->  Hash  (cost=202575.12..202575.12 rows=1332812 width=20) (actual time=2080.897..2080.897 rows=1332812 loops=1)"
"                          Buckets: 2048  Batches: 128  Memory Usage: 525kB"
"                          ->  Seq Scan on m_advert  (cost=0.00..202575.12 rows=1332812 width=20) (actual time=0.007..1564.220 rows=1332812 loops=1)"
"              ->  Hash  (cost=4.96..4.96 rows=196 width=52) (actual time=0.062..0.062 rows=196 loops=1)"
"                    Buckets: 1024  Batches: 1  Memory Usage: 17kB"
"                    ->  Seq Scan on m_advertsnapshot  (cost=0.00..4.96 rows=196 width=52) (actual time=0.004..0.030 rows=196 loops=1)"
"Total runtime: 18051.730 ms" 
```

使用 postgres 9.2 查询需要 18 秒。桌子大小是：

```
m_advertsnapshot - 196 rows
m_adverthistory - 6,298,933 rows
m_advert - 1,332,812 rows 
```

DDL：

```
-- m_advertsnapshot

CREATE TABLE m_advertsnapshot
(
  id serial NOT NULL,
  snapshot_timestamp timestamp with time zone NOT NULL,
  source_name character varying(50),
  CONSTRAINT m_advertsnapshot_pkey PRIMARY KEY (id),
  CONSTRAINT m_advertsnapshot_source_name_6a9a437077520191_uniq UNIQUE (source_name, snapshot_timestamp)
)
WITH (
  OIDS=FALSE
);

CREATE INDEX m_advertsnapshot_snapshot_timestamp
  ON m_advertsnapshot
  USING btree
  (snapshot_timestamp);

-- m_adverthistory

CREATE TABLE m_adverthistory
(
  id serial NOT NULL,
  advert_id integer NOT NULL,
  advert_snapshot_id integer NOT NULL,
  observed_timestamp timestamp with time zone NOT NULL,
  CONSTRAINT m_adverthistory_pkey PRIMARY KEY (id),
  CONSTRAINT advert_id_refs_id_30735d9eef85241c FOREIGN KEY (advert_id)
      REFERENCES m_advert (id) MATCH SIMPLE
      ON UPDATE NO ACTION ON DELETE NO ACTION DEFERRABLE INITIALLY DEFERRED,
  CONSTRAINT advert_snapshot_id_refs_id_55d3986f4f270624 FOREIGN KEY (advert_snapshot_id)
      REFERENCES m_advertsnapshot (id) MATCH SIMPLE
      ON UPDATE NO ACTION ON DELETE NO ACTION DEFERRABLE INITIALLY DEFERRED,
  CONSTRAINT m_adverthistory_advert_id_13fa0dae39e78983_uniq UNIQUE (advert_id, advert_snapshot_id)
)
WITH (
  OIDS=FALSE
);

CREATE INDEX m_adverthistory_advert_id
  ON m_adverthistory
  USING btree
  (advert_id);

CREATE INDEX m_adverthistory_advert_snapshot_id
  ON m_adverthistory
  USING btree
  (advert_snapshot_id);

-- m_advert

CREATE TABLE m_advert
(
  id serial NOT NULL,
  widget_listing_id integer,
  height integer,
  ctype integer,
  colour_id integer,
  CONSTRAINT m_advert_pkey PRIMARY KEY (id),
  CONSTRAINT "colour_id_refs_id_1e4e2dac0183b419" FOREIGN KEY (colour_id)
      REFERENCES colour ("id") MATCH SIMPLE
      ON UPDATE NO ACTION ON DELETE NO ACTION DEFERRABLE INITIALLY DEFERRED,
  CONSTRAINT widget_listing_id_refs_id_5a7e62d0d4f48013 FOREIGN KEY (widget_listing_id)
      REFERENCES m_widgetlisting (id) MATCH SIMPLE
      ON UPDATE NO ACTION ON DELETE NO ACTION DEFERRABLE INITIALLY DEFERRED,

)
WITH (
  OIDS=FALSE
);

CREATE INDEX m_advert_advert_seller_id
  ON m_advert
  USING btree
  (advert_seller_id);

CREATE INDEX m_advert_colour_id
  ON m_advert
  USING btree
  (colour_id);

CREATE INDEX m_advert_widget_listing_id
  ON m_advert
  USING btree
  (widget_listing_id); 
```

任何有关如何提高性能的想法都将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T18:46:52.257

*   架构看起来很合理（对于您实际上不需要索引的查询，并且某些索引已经被 FK 约束覆盖）
*   Junction 表不需要代理键（但不会有害）。
*   查询缓慢的真正原因是它**需要所有****表**中的所有行来计算聚合。如果你需要 100% 的数据，索引就帮不上什么忙了。
*   添加额外的约束（例如，在 snapshot_timestamp >= some_date）可能会导致使用索引的不同计划。

# android - 使用警报管理器的 numberformat 异常 - 在开始之前崩溃

> ID：15665113
> 
> 赞同：1
> 
> 时间：2013-03-27T17:12:54.613
> 
> 标签：android, gps

- - - - -更新 - - - - - - - - - - - - - - - - - - - - -

当应用程序启动时，我在行收到 numberformat 异常：

```
final long thetime=Long.parseLong(time_value); 
```

但以上内容不在主要活动中......

在我在edittex中的xml文件中

> 安卓：inputType="数字" 。

这条线在我的服务类中，我有警报管理器（注意我不能使用 catch，因为在下面（alarm.setRepeating）它不识别“时间”值。

```
protected void onHandleIntent(Intent intent) {
        //try{
            String time_value;
            time_value=(String) intent.getStringExtra("time_value");
            final long thetime=Long.parseLong(time_value);// }
        //  catch (NumberFormatException e) {

            //}
        mContext = getApplicationContext();
        mHandler.post(new Runnable(){

            @Override
            public void run() {

                // Start service using AlarmManager
                Calendar cal = Calendar.getInstance();
                cal.add(Calendar.SECOND, 10);
                Intent intent = new Intent(myservice.this,selection.class);
                PendingIntent pintent = PendingIntent.getService(myservice.this, 0, intent,
                        0);
                AlarmManager alarm = (AlarmManager) getSystemService(Context.ALARM_SERVICE);
                alarm.setRepeating(AlarmManager.RTC_WAKEUP, cal.getTimeInMillis(),
                        thetime*1000, pintent);
             // Tell the user about what we did.
                Toast.makeText(myservice.this, "Configured time interval",
                        Toast.LENGTH_LONG).show();

            }
        });
    }
} 
```

我从另一个活动加载 time_value：

```
public void onClick(View v) {
        switch (v.getId()){
        case R.id.btn:
             edit11=edit1.getText().toString();
             edit22=edit2.getText().toString();
             Intent i=new Intent(this,selection.class);
             i.putExtra("code_value",edit11);
             Intent k=new Intent(this,myservice.class);
             k.putExtra("time_value",edit22);
             this.startService(k);
             Intent l=new Intent(this,MainActivity.class);
             startActivity(l);  
             break;

     }
     } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T17:24:35.280

```
because I made lonfitude and latitude Strings (I had them as double before). How can I overcome that? 
```

从双重使用中获取字符串`String.valueOf();`

```
String latitude = String.valueOf(location.getLatitude()); 
```

重复

```
Also,how can I select to send the data in time intervals that the user will define? 
```

要以特定间隔重复使用[AlarmManager](http://developer.android.com/reference/android/app/AlarmManager.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T17:48:04.490

```
how can I select to send the data in time intervals that the user will define 
```

您可以使用[Timer](http://developer.android.com/reference/java/util/Timer.html)和[TimerTask](http://developer.android.com/reference/java/util/TimerTask.html)。将用户输入的时间间隔传递给Timer 的[schedule()](http://developer.android.com/reference/java/util/Timer.html#schedule%28java.util.TimerTask,%20long,%20long%29)。应该考虑的事情是当应用程序关闭或用户更改时间间隔然后取消以前的 TimerTask 并清除 Timer（如果有）。

对于警报，在您的活动类中执行以下操作：

```
PendingIntent Sender = null;
        Intent AlarmIntent = new Intent("com.example.gpstrackdemo.RECEIVEALARM");
        AlarmManager AlmMgr = (AlarmManager) getSystemService(Context.ALARM_SERVICE);
        Sender = PendingIntent.getBroadcast(GpsTrackActivity.this, 0,
                AlarmIntent, PendingIntent.FLAG_UPDATE_CURRENT);
        AlmMgr.setRepeating(AlarmManager.RTC_WAKEUP, 0, 15 * 60 * 1000,
                Sender); 
```

AlarmIntent 是[BroadcastReceiver](http://developer.android.com/reference/android/content/BroadcastReceiver.html)的意图。这是它的代码：

```
public class StartServiceReceiver extends BroadcastReceiver 
{
private static final String TAG = "StartServiceReceiver";
@Override
public void onReceive(Context context, Intent intent) 
{
    Intent serviceIntent = new Intent(context, MyLocationService.class);
    context.startService(serviceIntent);
    Log.v(TAG, "onReceive called");
}
} 
```

收到广播后，它将启动位置服务，我们将在其中获取用户的当前位置。

服务等级：

```
public class MyLocationService extends Service implements
    OnLocationReceivedListener {

private LocationManager manager;
private Location location = null;
PowerManager powerManager;
private WakeLock wakeLock;
private String country;
GPSLocationListener mGPSLocationListener;
NetworkLocationListener mNetworkLocationListener;
private static final int MAX_ATTEMPTS = 250;
private static String TAG = "MyLocationService";
LocTimerTask mTimerTask;
int mSattelites;
Timer myLocTimer;
int count = 0;
boolean isGPS;

@Override
public int onStartCommand(Intent intent, int flags, int startId) {
    Log.v(TAG, "onStartCommand called");
    getCurrentLocation();
    return START_STICKY;
}

@Override
public void onCreate() {
    Log.v(TAG, "onCreate called");
    powerManager = (PowerManager) getSystemService(Context.POWER_SERVICE);
    wakeLock = powerManager.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK,
            "mywakelock");
    mGPSLocationListener = new GPSLocationListener();
    mNetworkLocationListener = new NetworkLocationListener();
    wakeLock.acquire();
    super.onCreate();
}

@Override
public IBinder onBind(Intent intent) {
    return null;
}

public void getCurrentLocation() {
    manager = (LocationManager) getSystemService(Context.LOCATION_SERVICE);
    manager.addGpsStatusListener(mGPSStatusListener);
    mTimerTask = new LocTimerTask(LocationManager.GPS_PROVIDER);

    if (manager.isProviderEnabled(LocationManager.GPS_PROVIDER)) {
        Log.v(TAG, "GPS ENABLED");
        manager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 1000L,
                50.0f, mGPSLocationListener);
    }

    if(manager.isProviderEnabled(LocationManager.NETWORK_PROVIDER)) {
        manager.requestLocationUpdates(LocationManager.NETWORK_PROVIDER, 1000L,
                50.0f, mNetworkLocationListener);
    }

    myLocTimer = new Timer("LocationRunner", true);
    myLocTimer.schedule(mTimerTask, 0, 500);
}

public class GPSLocationListener implements LocationListener {

    @Override
    public void onLocationChanged(Location argLocation) {
        location = argLocation;
    }

    public void onProviderDisabled(String provider) {

    }

    public void onProviderEnabled(String provider) {

    }

    public void onStatusChanged(String provider, int status, Bundle extras) {

    }
}

public class NetworkLocationListener implements LocationListener {

    @Override
    public void onLocationChanged(Location argLocation) {
        location = argLocation;
    }

    public void onProviderDisabled(String provider) {

    }

    public void onProviderEnabled(String provider) {

    }

    public void onStatusChanged(String provider, int status, Bundle extras) {

    }
}
class LocTimerTask extends TimerTask {
    String provider;

    public LocTimerTask(String provider) {
        this.provider = provider;
    }

    final Handler mHandler = new Handler(Looper.getMainLooper());

    Runnable r = new Runnable() {
        @Override
        public void run() {
            count++;
            Log.v(TAG, "Timer Task run" + i);
            location = manager.getLastKnownLocation(provider);

            if (location != null) {
                Log.v(TAG, "in timer task run in if location not null");
                onLocationReceived(location);
                myLocTimer.cancel();
                myLocTimer.purge();
                mTimerTask.cancel();
                return;
            } else {
                isGPS = false;
                if (location == null && count == MAX_ATTEMPTS) {
                    turnGPSOff();
                    location = manager
                            .getLastKnownLocation(LocationManager.NETWORK_PROVIDER);
                    if (location != null) {

                        onLocationReceived(location);
                        myLocTimer.cancel();
                        myLocTimer.purge();
                        mTimerTask.cancel();
                        return;
                    }
                } else {
                    return;
                }
            }
            count = 0;
        }
    };

    public void run() {
        mHandler.post(r);
    }
}

private GpsStatus.Listener mGPSStatusListener = new GpsStatus.Listener() {

    @Override
    public synchronized void onGpsStatusChanged(int event) {
        switch (event) {
        case GpsStatus.GPS_EVENT_SATELLITE_STATUS:
            GpsStatus status = manager.getGpsStatus(null);
            mSattelites = 0;
            Iterable<GpsSatellite> list = status.getSatellites();
            for (GpsSatellite satellite : list) {
                if (satellite.usedInFix()) {
                    mSattelites++;
                }
            }
            break;

        case GpsStatus.GPS_EVENT_FIRST_FIX:
            break;

        case GpsStatus.GPS_EVENT_STARTED:
            break;

        case GpsStatus.GPS_EVENT_STOPPED:
            break;
        default:
            break;
        }
    }
};

public void onDestroy() {
    super.onDestroy();
    if (myLocTimer != null) {
        myLocTimer.cancel();
        myLocTimer.purge(); //Timer not required any more
    }

    if (mTimerTask != null) {
        if (mTimerTask.r != null) {
            mTimerTask.mHandler.removeCallbacks(mTimerTask.r);
        }
    }

    if (manager != null) {
        if (mGPSLocationListener != null) {
            manager.removeUpdates(mGPSLocationListener);
        }

        //remove location updates for listener once your work is done, otherwise it will drain battery
        if (mNetworkLocationListener != null) {
            manager.removeUpdates(mNetworkLocationListener);
        }

        if (mGPSStatusListener != null) {
            manager.removeGpsStatusListener(mGPSStatusListener);
        }
    }
}

@Override
public void onLocationReceived(Location mLoc) {
    //Send data to http server once you get location.
}
} 
```

在这里，我的服务类实现了一个侦听器，该侦听器具有一个回调方法`onLocationReceived`，您可以在获得位置后在其中执行您的操作。

```
public interface OnLocationReceivedListener {
    public void onLocationReceived(Location mLoc);
} 
```

在您的清单中，分别声明广播接收器和服务：

```
<receiver
        android:name=".receiver.StartServiceReceiver"
        android:enabled="true"
        android:exported="false" >
        <intent-filter>
            <action android:name="com.example.gpstrackdemo.RECEIVEALARM" />

        </intent-filter>
    </receiver>
<service android:name=".service.MyLocationService"
        android:enabled="true"></service> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-29T10:14:32.883

好的，我忘记了：

startService() 是我的主要活动。我不得不把它放在我的服务活动中。

谢谢大家

# symfony-sonata - 在带有奏鸣曲的 symfony2 中：如何将变量传递给在方法 configureListFields 中为列表映射器的给定字段定义的模板？

> ID：15665114
> 
> 赞同：3
> 
> 时间：2013-03-27T17:12:56.337
> 
> 标签：symfony-sonata, sonata-admin, listfield

将 Symfony2 与 Sonata 一起使用，在列表中，字段模板可以被覆盖并将变量分配给模板，即 setTemplateVar()，有时会很有用！（不是在谈论“attr”用于此目的的形式，而是列出......）

我想知道在 configureListFields 方法中将变量传递给为 listmapper 的给定字段定义的模板的最佳方法是什么？

```
 <?php

    namespace Acme\AcmeBundle\Admin;

    use Sonata\AdminBundle\Admin\Admin;
    use Sonata\AdminBundle\Datagrid\ListMapper;
    use Sonata\AdminBundle\Datagrid\DatagridMapper;
    use Sonata\AdminBundle\Validator\ErrorElement;
    use Sonata\AdminBundle\Form\FormMapper;

    class AcmeAdmin extends Admin
    {

        protected function configureListFields(ListMapper $listMapper)
        {
            $listMapper
                ->addIdentifier('acme_field')
                ->add('date', 'date', array(
                    'template'   => "AcmeBundle:CRUD:list_date.html.twig",
            //        'dateFormat' => "Y-m-d",// ---> how to pass this var to twig ?
                ))
                ->add('_action', 'actions', array(
                    'actions' => array(
                        'edit'   => array(),
                        'delete' => array(),
                    ),
                ))
            ;
        } 
```

已使用 twig 模板实现了翻译和格式化日期的特定问题的解决方案，如下所示：

```
 {% block field%}
        {% if value is empty %}
            &nbsp;
        {% else %}

            {# retrieving the dateFormat variable from the listmapper #}
            {% if dateFormat is defined %}
                {{ value|date(dateFormat)|title }}
            {% else %}
                {{ value|date('m / Y') }}
            {% endif %}

            {# passing the locale in some way here would be great, it is not available in twig.. #}
            {# scratch that, it is not necessary with intl.extension... #}
            {% if locale is defined %}
                {% set dflt_locale = locale %}
            {% else %}
                {% set dflt_locale = 'fr_FR.UTF-8' %}
            {% endif %}

            {{ value|localizeddate('medium', 'none', dflt_locale)|title }}

        {% endif %}
    {% endblock %} 
```

但是，我的目标是能够从 listmapper 那里检索一个变量。
在提出的示例中， dateFormat 将是一个很好的传递...

*关于语言环境的问题实际上很好，因为我意识到它不需要传递给本地化日期......它已经可以通过 intl 扩展获得。*

以下帖子答案使我得出这个结论，因为我无法定义语言环境，但通过不添加参数，它已解决！ [使用 Symfony 2 本地化树枝中的日期，](https://stackoverflow.com/questions/9480325/localize-dates-in-twigs-using-symfony-2) 因此：

```
 {{ value|localizeddate('medium', 'none')|title }} 
```

提前为与 dateFormat 参数相关的任何响应干杯！

文兹

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-09-26T14:00:08.480

在树枝上试试

```
field_description.options.YOURFIELDNAME 
```

在这里定义

```
->add('date', 'date', array(
                    'template'   => "AcmeBundle:CRUD:list_date.html.twig",
                    'YOURFIELDNAME' => 'Blablo'
                )) 
```

干杯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T11:10:59.483

最后，最直接的解决方案是在 Admin 类中定义一个 var，如下所示：

```
 <?php

        namespace Acme\AcmeBundle\Admin;

        use Sonata\AdminBundle\Admin\Admin;
        use Sonata\AdminBundle\Datagrid\ListMapper;
        use Sonata\AdminBundle\Datagrid\DatagridMapper;
        use Sonata\AdminBundle\Validator\ErrorElement;
        use Sonata\AdminBundle\Form\FormMapper;

        class AcmeAdmin extends Admin
        {
            // two options to define var and make them available to twig by admin. mechanism
            public $dateFormat = "Y-m-d";// ---> this var is available in twig : admin.dateFormat
            // or to allow better relation to context
            public $parameters = array();// ---> this array is available in twig : admin.parameters.x.y.z

            protected function configureListFields(ListMapper $listMapper)
            {
                // assuming the $dateFormat is not set, by convention it could be defined here with proper intent in mind
                // it could then be contained in an array like that

                $this->parameters = array('listmapper' => array('dateFormat' => 'Y-m-d',),);

                // then specialized in twig : admin.parameters.listmapper.dateFormat

                $listMapper
                    ->addIdentifier('acme_field')
                    ->add('date', 'date', array(
                        'template'   => "AcmeBundle:CRUD:list_date.html.twig",// checking admin.parameters.listmapper.dateFormat
                    ))
                    ->add('_action', 'actions', array(
                        'actions' => array(
                            'edit'   => array(),
                            'delete' => array(),
                        ),
                    ))
                ;
            } 
```

然后在树枝中：

```
 {% block field%}
            {% if value is empty %}
                &nbsp;
            {% else %}

                {# retrieving the dateFormat variable from the listmapper by convention...
                    twig is very forgiving in eval, so checking for defined var is peachy
                    e.g if admin.parameters is not defined or empty then else is triggered
                #}
                {% if admin.parameters.listmapper.dateFormat is defined %}

                    {{ value|date(admin.parameters.listmapper.dateFormat)|title }}

                {% else %}

                    {{ value|localizeddate('medium', 'none')|title }}

                {% endif %}

            {% endif %}
            {% endblock %} 
```

感谢[Sonata Admin：将自定义触发器/操作添加到列表/编辑操作](https://stackoverflow.com/questions/11482910/sonata-admin-add-custom-triggers-actions-to-list-edit-action?rq=1)我意识到/记住/连接了这些点......树枝可以访问 admin 变量，因此通过在类中定义一个变量，我们可以在 twig 中检索它。

现在，对管理变量的容器设置某种约束只是一个约定问题。（cf 参数数组）

对于这种特殊情况，此解决方案不会添加任何点，因为本地化日期很好地满足了我的目的，但是，为了论证，了解恕我直言是件好事。

干杯，希望有帮助！

文兹

# php - 将 Lame.h 与 PHP 扩展链接

> ID：15665118
> 
> 赞同：2
> 
> 时间：2013-03-27T17:13:11.457
> 
> 标签：php, c, lame, php-internals

我正在尝试开发我的第一个 php 扩展。它使用 Lame ，所以我安装了 liblame-dev lame.h 位于`/usr/include/lame/`

在我的 config.m4

```
 LIBNAME=lame
  PHP_ADD_LIBRARY($LIBNAME) 
```

它可以构建，但是 apache 启动时出现问题

```
 PHP Warning:  PHP Startup: Unable to load dynamic library '/usr/lib/php5/20100525+lfs/myextension.so' - /usr/lib/php5/20100525+lfs/myextension.so: 
undefined symbol: lame_init in Unknown on line 0 
```

**解决方案**

对我来说正确的行 config.m4 是

PHP_SUBST(MYEXTENSION_SHARED_LIBADD)

PHP_ADD_LIBRARY(mp3lame, 1,MYEXTENSION_SHARED_LIBADD)

# linux - 如何用shebang定义脚本解释器

> ID：15665119
> 
> 赞同：7
> 
> 时间：2013-03-27T17:13:13.057
> 
> 标签：linux, bash, unix, sml

很明显，可以使用

```
#!/usr/bin/perl 
```

在脚本的第一行中使用 shebang 表示法来定义解释器。然而，这预设了一个解释器，它忽略了以井号开始的行作为注释。如何使用没有此功能的解释器？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-27T21:55:31.680

使用包装器删除第一行并使用文件的其余部分调用真正的解释器。它可能看起来像这样：

```
#!/bin/sh

# set your "real" interpreter here, or use cat for debugging
REALINTERP="cat"

tail -n +2 $1 | $REALINTERP 
```

除此之外：在某些情况下，忽略有关第一行的错误消息可能是一种选择。

最后的手段：将解释器的注释字符的代码支持到内核中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-27T20:09:32.620

我认为第一行是由操作系统解释的。解释器将被启动并且脚本的名字作为它的第一个参数传递给脚本。以下脚本“first.myint”调用解释器“myinterpreter”，它是来自下面 C 程序的可执行文件。

```
#!/usr/local/bin/myinterpreter
% 1 #########
2 xxxxxxxxxxx
333
444
% the last comment 
```

个人翻译示意图：

```
#include <errno.h>
#include <stdio.h> 
#include <stdlib.h>
#include <string.h>

#define BUFFERSIZE  256                         /* input buffer size */

  int
main ( int argc, char *argv[] )
{
  char    comment_leader  = '%';                /* define the coment leader */
  char    *line = NULL;
  size_t  len   = 0;
  ssize_t read;
  //  char  buffer[BUFFERSIZE];

  // argv[0] : the name of this executable
  // argv[1] : the name the script calling this executable via shebang

  FILE  *input;                                 /* input-file pointer */
  char  *input_file_name = argv[1];             /* the script name    */

  input = fopen( input_file_name, "r" );
  if ( input == NULL ) {
    fprintf ( stderr, "couldn't open file '%s'; %s\n",
        input_file_name, strerror(errno) );
    exit (EXIT_FAILURE);
  }

  while ((read = getline(&line, &len, input)) != -1) {
    if ( line[0] != comment_leader ) {
      printf( "%s", line );                     /* print line as a test */
    }
    else {
      printf ( "Skipped a comment!\n" );
    }
  }

  free(line);

  if( fclose(input) == EOF ) {                  /* close input file   */
    fprintf ( stderr, "couldn't close file '%s'; %s\n",
        input_file_name, strerror(errno) );
    exit (EXIT_FAILURE);
  }

  return EXIT_SUCCESS;
}   /* ----------  end of function main  ---------- */ 
```

现在调用脚本（之前可执行）并查看输出：

```
...~> ./first.myint
#!/usr/local/bin/myinterpreter
Skipped a comment!
2 xxxxxxxxxxx
333
444
Skipped a comment! 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-29T09:00:47.527

我让它工作了。我特别感谢 holgero 的尾巴技巧

```
tail -n +2 $1 | $REALINTERP 
```

那，并在堆栈溢出上找到这个答案使得它成为可能：

[如何将 linux shell 脚本编译为独立的可执行文件 *binary*（即不仅仅是 chmod 755）？](https://stackoverflow.com/questions/6423007/how-to-compile-a-linux-shell-script-to-be-a-standalone-executable-binary-i-e)

“完全满足我需求的解决方案是 SHC - 免费工具”

SHC 是一个 shell 到 C 的翻译器，见这里：

[http://www.datsi.fi.upm.es/~frosal/](http://www.datsi.fi.upm.es/~frosal/)

所以我写道`polyscript.sh`：

```
$ cat polyscript.sh
#!/bin/bash

tail -n +2 $1 | poly 
```

我用 shc 编译它，然后用 gcc 编译：

```
$ shc-3.8.9/shc -f polyscript.sh
$ gcc -Wall polyscript.sh.x.c -o polyscript 
```

现在，我能够创建第一个用 ML 编写的脚本：

```
$ cat smlscript
#!/home/gergoe/projects/shebang/polyscript $0

print "Hello World!" 
```

而且，我能够运行它：

```
$ chmod u+x smlscript
$ ./smlscript
Poly/ML 5.4.1 Release
> > # Hello World!val it = (): unit 
```

Poly 没有抑制编译器输出的选项，但这不是问题。按照 fgm 的建议，直接在 C 中编写 polyscript 可能会很有趣，但这可能不会让它更快。

所以，这就是这么简单。我欢迎任何意见。

# c# - ASP.NET MVC 渲染视图从字符串到生成报告

> ID：15665121
> 
> 赞同：0
> 
> 时间：2013-03-27T17:13:20.780
> 
> 标签：c#, asp.net-mvc, model-view-controller

问题是：平台为客户生成报告。但是每个客户报告中的信息相同，但布局不同。每次客户想要更改布局时，我都不想生成部分视图、重新编译和发布解决方案。

我想在数据存储中存储一个表示部分视图（报告）的字符串，并在运行时传递给带有模型的视图并渲染它。

我一直在寻找一些解决方案，但涉及到部分视图文件。这篇文章（[http://www.umbraworks.net/bl0g/rebuildall/2009/11/17/ASP_NET_MVC_and_virtual_views](http://www.umbraworks.net/bl0g/rebuildall/2009/11/17/ASP_NET_MVC_and_virtual_views)）给出了一个想法，但在这种情况下，客户端总是在同一个 URL 中访问（如 ~/Reports/SomeReport/2，其中2是客户端拥有的对象的id，客户端与对象的关系是一个客户端，多个对象）。

我该如何解决这个问题？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T17:17:26.050

编辑：将围绕 RazorEngine 的评论移至答案，因为这似乎更相关。

对于动态模板（例如，从数据库中检索模板内容然后绑定到模型），看起来[RazorEngine](http://razorengine.codeplex.com/)适用于此用例。

* * *

**渲染原始 HTML** [nkvu - 出于历史目的而将此处作为“原始”，不正确的响应导致正确的响应]

如果您有一个只想在屏幕上显示的 HTML 字符串，那么您可以使用[`Html.Raw()`](http://msdn.microsoft.com/en-us/library/gg480740%28v=vs.98%29.aspx). 这是一个旧[示例](http://www.arrangeactassert.com/using-html-raw-in-asp-net-mvc-razor-views/)，但它应该说明 Raw() 是如何工作的。抱歉，如果我误解了您的用例。

但作为一种好的做法，您应该确保测试/防御各种可能出现的注入攻击，因为您正在直接渲染 HTML。我会尝试找到一些链接供您考虑并在我这样做时更新此回复

# entity-framework - 实体框架：实体名称中的无效字符列表

> ID：15665125
> 
> 赞同：0
> 
> 时间：2013-03-27T17:13:38.787
> 
> 标签：entity-framework, edmx

我正在开发一个与 Visual Studio 中的 Edmx 设计器非常相似的设计器。我想添加 Edmx 设计器应用于实体和属性名称的相同验证。有人可以分享什么是验证规则，即允许哪些字符，不允许哪些字符。实体/属性名称和其他此类规则的长度可能是多少？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T20:00:19.323

看看xsd。加载工件 (CSDL/MSL/SSDL) 时有两步验证 1 - 使用 xsd，2 内部验证检查在大多数情况下无法在 xsd 中表达的附加规则。EF6 现在是开源的，但以前版本的 xsd 架构没有改变。你可以在[这里](http://entityframework.codeplex.com/SourceControl/changeset/view/9aec1721aa76#src/EntityFramework/Resources/System/Data/EntityModel/System.Data.Resources.CSDLSchema_3.xsd)找到它们。（映射模式位于 MappingSpecification 文件夹中）。

如果您查看 v3 CSDL 模式，则属性名称指定如下：

```
<xs:simpleType name="TSimpleIdentifier">
    <xs:restriction base="xs:string">
        <xs:maxLength value="480" />
        <!-- The below pattern represents the allowed identifiers in ECMA specification -->
        <xs:pattern value="[\p{L}\p{Nl}][\p{L}\p{Nl}\p{Nd}\p{Mn}\p{Mc}\p{Pc}\p{Cf}]{0,}" />
    </xs:restriction>
</xs:simpleType> 
```

如果您不想打扰 xsds 并且想利用内部验证，您可以将您的 xml 加载到相应的项目集合中。同样在 EF6 中添加了一些重载，允许您加载工件，但如果它们无效则不会引发异常，但会返回 null 和错误列表作为输出参数（在项目集合上查找公共静态工厂方法）。

# ios - iOS 6 地图不使用 MKUserTrackingModeFollow 进行缩放

> ID：15665127
> 
> 赞同：4
> 
> 时间：2013-03-27T17:13:44.513
> 
> 标签：ios, mkmapview, mapkit, core-location, ios6-maps

当我的 iOS6`MKMapView`处于`MKUserTrackingModeFollowWithHeading`or`MKUserTrackingModeFollow`时，缩放手势（捏合、双击、两指点击）有时会起作用，但并非总是如此。

该问题似乎发生在**after**和**before**`didUpdateUserLocation:`调用时。 **`regionWillChangeAnimated` **`regionDidChangeAnimated`****

 ****有想法该怎么解决这个吗？

为了隔离问题，我创建了一个单视图应用程序，其中包含一个`MKMapView`和一个`UIToolbar`（在 .xib 中设置），我正在向其中添加一个`MKUserTrackingBarButtonItem`. `UIViewController`充当`<MKMapViewDelegate>`. _ 下面是完整的实现代码：

```
#import "ViewController.h"

@implementation ViewController

@synthesize mapView, toolbar;

- (void)viewDidLoad {
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.

    [self.mapView setDelegate:self];

    MKUserTrackingBarButtonItem *trackButton = [[MKUserTrackingBarButtonItem alloc] initWithMapView:self.mapView];
    [toolbar setItems:[NSArray arrayWithObjects:trackButton, nil] animated:YES];
}

#pragma mark - MKMapViewDelegate

- (void)mapView:(MKMapView *)mapView regionWillChangeAnimated:(BOOL)animated {
    NSLog(@"regionWillChange >>");
}

- (void)mapView:(MKMapView *)mapView regionDidChangeAnimated:(BOOL)animated {
    NSLog(@"<< regionDidChange");
}

- (void)mapView:(MKMapView *)mapView didUpdateUserLocation:(MKUserLocation *)userLocation {
    NSLog(@"-- didUpdateUserLocation --");
}

- (void)mapView:(MKMapView *)mapView didChangeUserTrackingMode:(MKUserTrackingMode)mode animated:(BOOL)animated {
    // required for <MKMapViewDelegate>
}

#pragma mark - etc

- (void)didReceiveMemoryWarning {
    [super didReceiveMemoryWarning];
}

@end 
```****

# shell - 使用脚本找出“ln -s”的目的地

> ID：15665131
> 
> 赞同：0
> 
> 时间：2013-03-27T17:13:51.020
> 
> 标签：shell, unix, zsh

首先，这是我正在谈论的脚本： [https ://github.com/Greduan/dotfiles/blob/master/scripts/symlinks.sh](https://github.com/Greduan/dotfiles/blob/master/scripts/symlinks.sh)

检查第20行。它有以下内容

```
dest = "$HOME/.`basename \"${source%.*}\"`" 
```

由于我是从另一个脚本中获取的，因此我不知道它实际上做了什么。我猜如果源文件被命名`vimrc.vim.symlink`它会输出它会做什么，对`.vimrc.vim`吗？

如果不正确，您能解释一下它的作用吗？

你能帮我弄清楚如何制作它，如果文件是`vimrc.vim.symlink`，我怎样才能制作它以便我可以得到`.vimrc`？

请检查脚本，以便您了解我在说什么。:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T17:20:13.547

首先，你的分析是正确的。`${source%.*}`从 中删除`.*`后缀`source`。其余部分`$HOME/.$(basename \"...\")`采用 的基本名称`source`，从中删除所有路径，只留下文件名并放在`$(HOME)/.`.

如果您想删除（包括）第一个点之后的所有内容，可以使用`${source%%.*}`（with`%%`代替`%`）。[这个答案](https://stackoverflow.com/a/125340/912144)给你例子。

# sql - 带有计数的 SQL Server 查询返回 null 或没有结果

> ID：15665138
> 
> 赞同：0
> 
> 时间：2013-03-27T17:14:03.100
> 
> 标签：sql, sql-server

我有以下查询：

```
SELECT Centre.Centre_Name, Count(Shop_No) AS shopcount FROM Centre INNER JOIN Space ON Centre.Centre_Name = Space.Centre_Name GROUP BY Centre.Centre_Name 
```

我需要它从中心表中返回中心列表以及从空间表中返回每个中心的商店数量。因此它计算 Space 表中 shop_no 的数量并返回中心名称加上每个中心的商店数量。但是，如果一个中心在 Space 表中尚未分配任何商店，则它不会从 Center 表返回中心名称。如果 Space 表中不存在中心，我需要它返回 0。

请指教 ：）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-27T17:14:54.330

使用 a`LEFT JOIN`而不是`INNER JOIN`：

```
SELECT Centre.Centre_Name, Count(Shop_No) AS shopcount 
FROM Centre 
    LEFT JOIN Space ON Centre.Centre_Name = Space.Centre_Name 
GROUP BY Centre.Centre_Name 
```

# vba - VBA 使用 ODBCConnection.RefreshDate 导致错误 1004

> ID：15665139
> 
> 赞同：2
> 
> 时间：2013-03-27T17:14:03.593
> 
> 标签：vba, excel

由于我正在使用的工作簿的设置方式，其中创建了许多不同的连接，但只有一个连接是有效的。有效连接将是唯一具有刷新日期的连接，因此我正在尝试使用 Excel 宏设置空检查来找到它。我到目前为止的代码是：

```
For Each c2 In ActiveWorkbook.Connections
If Not IsNull(c2.ODBCConnection.RefreshDate) Then  
Blah Blah  
End If 
```

在空检查我遇到运行时错误'1004'；应用程序定义或对象定义的错误。我想知道这是否与缺少参考有关？或者可能是别的东西。

任何帮助将不胜感激！谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T18:40:37.597

我认为这是由于该类型没有干净的空值造成的`Date`。相反，当您尝试访问它时，MS 会引发错误。

处理此问题的一种方法是将值检索到变量中，但将该检索包装在错误处理程序块中：

```
Dim d As Date
For Each c2 In ActiveWorkbook.Connections
    On Error Resume Next
    d = c2.OLEDBConnection.RefreshDate
    If Err = 1004 Then
        MsgBox "No date"
    ElseIf Err <> 0 Then
        MsgBox "Unknown error (" & Err.Number & "): " & Err.Description
    Else
        MsgBox CStr(d)
    End If
    On Error GoTo 0
Next 
```

表示以下`On Error Resume Next`代码不应因错误而中断；表示`On Error Goto 0`应该恢复正常（系统）错误处理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T17:56:52.577

并非所有连接都是 ODBC，如何：

```
For Each c2 In ActiveWorkbook.Connections
    If c2.Type = xlConnectionTypeODBC Then
        If Not IsNull(c2.ODBCConnection.RefreshDate) Then
        ''Blah Blah
        End If
    End If
Next 
```

但是，我不确定它是否会为空： http: [//msdn.microsoft.com/en-us/library/office/ff837641 (v=office.14).aspx](http://msdn.microsoft.com/en-us/library/office/ff837641(v=office.14).aspx)

# javascript - 使用 THREE.Raycaster 检测碰撞

> ID：15665141
> 
> 赞同：0
> 
> 时间：2013-03-27T17:14:06.020
> 
> 标签：javascript, three.js, collision-detection

我创建了这个函数，它在我的渲染循环中调用以检测碰撞并移动玩家/相机（这是第一人称游戏）使用命名为 CubeGeometry 的碰撞检测，该 CubeGeometry`pCube`被移动以匹配每一帧的相机：

```
// Player movements
function pMovements() {
    mPlayer.colBottom = false;

    pCube.position.x = mPlayer.yawObject.position.x + 50; // The cube is placed +50 so we can see/debug it.
    pCube.position.y = mPlayer.yawObject.position.y - 10;
    pCube.position.z = mPlayer.yawObject.position.z;

    // -- COLLISION DETECTION START --
    var originPoint = pCube.position.clone();

    for (var vertexIndex = 0; vertexIndex < pCube.geometry.vertices.length; vertexIndex++)
    {       
        var localVertex = pCube.geometry.vertices[vertexIndex].clone();
        var globalVertex = localVertex.applyMatrix4( pCube.matrix );
        var directionVector = globalVertex.sub( pCube.position );

        var ray = new THREE.Raycaster( originPoint, directionVector.clone().normalize() );
        var collisionResults = ray.intersectObjects( collidableMeshList );
        if ( collisionResults.length > 0 && collisionResults[0].distance < directionVector.length() ) {

            // Bottom vertices
            if (vertexIndex == 2 || vertexIndex == 3 || vertexIndex == 6 || vertexIndex == 7) {
                mPlayer.colBottom = true;
                mPlayer.velocity.y = Math.max( 0, mPlayer.velocity.y ); // Stop falling
            }
        }
    }
    // -- COLLISION DETECTION END --

    var delta = (Date.now() - time) * 0.1;

    mPlayer.velocity.x += (-mPlayer.velocity.x) * 0.08 * delta; // walking
    mPlayer.velocity.z += (-mPlayer.velocity.z) * 0.08 * delta; // walking
    if (mPlayer.colBottom == false) {
        mPlayer.velocity.y -= 0.1 * delta; // falling
    }

    if (mPlayer.moveForward) mPlayer.velocity.z -= mPlayer.speed * delta;
    if (mPlayer.moveBack) mPlayer.velocity.z += mPlayer.speed * delta;
    if (mPlayer.moveLeft) mPlayer.velocity.x -= mPlayer.speed * delta;
    if (mPlayer.moveRight) mPlayer.velocity.x += mPlayer.speed * delta;

    mPlayer.yawObject.translateX(mPlayer.velocity.x);
    mPlayer.yawObject.translateY(mPlayer.velocity.y); 
    mPlayer.yawObject.translateZ(mPlayer.velocity.z);

    if (mPlayer.yawObject.position.y < -2000) {
        // Player has fallen out of bounds :( so re-initialise the players position
        mPlayer.velocity.y = 0;
        mPlayer.yawObject.position.y = 100;
        mPlayer.yawObject.position.x = 0;
        mPlayer.yawObject.position.z = 0;

        mPlayer.yawObject.rotation.y = 0;
        mPlayer.pitchObject.rotation.x = 0;
    }

    if (mPlayer.moveDown) {
        mPlayer.yawObject.position.y -= 1;
    }
    if (mPlayer.moveUp) {
        mPlayer.yawObject.position.y += 1;
    }
} 
```

[单击此处查看演示。](http://gamingspire.com/g2/)
WASD 移动。跳跃的空间（有点）。黑色立方体/矩形反映了相机在 x 轴上的位置 +50。在立方体上检测到碰撞。

基本上我对此有两个问题。我应该使用立方体的顶点还是面来检测碰撞？如果对象比立方体小，则不会检测到碰撞，因为它不会碰到任何顶点。那么我应该为面孔重写它吗？

其次，当检测到碰撞时，如何防止立方体掉得太远。如果您查看演示，当立方体从某物上掉下来时，它会在停止之前继续下落一段时间。我认为与此有关，`mPlayer.velocity.y`但我无法修复它。即使是跳跃也会使立方体沉入地板深处。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T03:52:15.373

为了增加碰撞检测的“分辨率”，您可以向立方体添加更多顶点，例如，当您声明 pCube 尝试时：

```
pCube = new THREE.CubeGeometry(100,100,100, 5,5,5); 
```

并且您的其余代码可以保持不变。

对于较小的物体“在”为碰撞检测创建的​​射线之间“滑动”，通常如果您使用此方法但让小物体创建射线，那么您将更准确地检测碰撞。

# sql - 一个查询来查找一行中的任何两个字段是否相等？

> ID：15665144
> 
> 赞同：2
> 
> 时间：2013-03-27T17:14:19.487
> 
> 标签：sql, sql-server-2008

我必须维护一个设计非常糟糕的可怕遗留数据库。所有的表都有超过 100 列 - 一个有 650 列。数据库非常非规范化，我发现通常相同的数据在同一行的几列中表示。

例如，以下是其中一个表的列示例：

```
[MEMBERADDRESS] [varchar](331) NULL,
[DISPLAYADDRESS] [varchar](max) NULL,

[MEMBERINLINEADDRESS] [varchar](max) NULL,
[DISPLAYINLINEADDRESS] [varchar](250) NULL,

[__HISTISDN] [varchar](25) NULL,
[HISTISDN] [varchar](25) NULL,
[MYDIRECTISDN] [varchar](25) NULL,
[MYISDN] [varchar](25) NULL,

[__HISTALT_PHONE] [varchar](25) NULL,
[HISTALT_PHONE] [varchar](25) NULL, 
```

事实证明，`MEMBERADDRESS`表`DISPLAYADDRESS`中所有行的值都相同。我在这里展示的其他领域集群也是如此。

手动识别所有此类情况将非常困难且耗时。是否可以创建一个查询来确定两个字段在表的每一行中是否具有相同的值？

如果没有，是否有任何现有工具可以帮助我识别这些问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T17:24:20.500

我看到有两种方法可以简化这个查询：

*   **编写一个脚本来生成您的查询**- 为您的脚本提供表的名称和可疑列，并让它生成一个查询来检查每对列的相等性。这是在像您这样的情况下实施的最快方法。
*   **编写一个“规范化”您的数据的查询，并对其进行搜索**- 将查询自行连接到自身，然后过滤掉重复项。

这是第二种方法的快速说明：

```
SELECT id, name, val FROM (
    SELECT id, MEMBERADDRESS as val,'MEMBERADDRESS' as name FROM MyTable
    UNION ALL
    SELECT id, DISPLAYADDRESS as val,'DISPLAYADDRESS' as name FROM MyTable
    UNION ALL
    SELECT id, MEMBERINLINEADDRESS as val,'MEMBERINLINEADDRESS' as name FROM MyTable
    UNION ALL
    ...
) first
JOIN (
    SELECT id, MEMBERADDRESS as val,'MEMBERADDRESS' as name FROM MyTable
    UNION ALL
    SELECT id, DISPLAYADDRESS as val,'DISPLAYADDRESS' as name FROM MyTable
    UNION ALL
    SELECT id, MEMBERINLINEADDRESS as val,'MEMBERINLINEADDRESS' as name FROM MyTable
    UNION ALL
    ...
) second ON first.id=second.id AND first.value=second.value 
```

100 列有很多手动工作（至少它不会像`N^2`第一种方法那样增长，但仍然需要大量手动输入）。您最好生成与`UNION ALL`使用小脚本相关的选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T17:32:35.587

以下方法用于`unpivot`创建三元组。它做了一些假设：值不为空；每行都有一个id；并且列具有兼容的类型。

```
select t.which, t2.which 
from (select id, which, value
      from MEMBERADDRESS
      unpivot (value for which in (<list of columns here>)) up
     ) t full outer join
     (select id, which, value
      from MEMBERADDRESS
      unpivot (value for which in (<list of columns here>)) up
     ) t2
     on t.id = t2.id and t.which <> t2.which
group by t.which, t2.which
having sum(case when t.value = t2.value then 1 else 0 end) = count(*) 
```

它通过创建一个包含三列的新表来工作：id、列和列中的值。然后它对 id （以将比较保持在一行内）和 value （以获取匹配值）进行自连接。这种自联接应该始终匹配，因为查询的两半中的列是相同的。

然后`having`计算给定列对两侧相同的值的数量。当所有这些都相同时，则匹配成功。

您也可以省略该`having`子句并使用以下内容：

```
select t.which, t2.which, sum(case when t.value = t2.value then 1 else 0 end) as Nummatchs,
       count(*) as NumRows 
```

以获得更完整的信息。

# java - 春季宠物诊所应用中的问题

> ID：15665145
> 
> 赞同：0
> 
> 时间：2013-03-27T17:14:20.857
> 
> 标签：java, spring

我是spring的天真用户。我刚刚开始学习它。我想通过理解例子来学习spring。所以我尝试从链接[https://github.com/SpringSource/spring-petclinic](https://github.com/SpringSource/spring-petclinic)安装 spring 的 petclicnic 示例应用程序。当我尝试运行 mvn install 命令时，出现以下错误 java.lang.NoClassDefFoundError: org/springframework/beans/factory/NoUniqueBeanDe finitionException。我尝试使用[https://jira.springsource.org/browse/SPR-10218](https://jira.springsource.org/browse/SPR-10218)中提供的信息来解决它。我添加了所有依赖项。现在我收到以下错误。请帮忙

```
ERROR ContextLoader - Context initialization failed
java.lang.NoClassDefFoundError: org/springframework/asm/ClassVisitor
at org.springframework.beans.factory.support.Abstract AutowireCapableBean
Factory.<init>(AbstractAutowireCapableBeanFactory. java:121) ~[spring-beans-3.1.4
.RELEASE.jar:3.1.4.RELEASE]
at org.springframework.beans.factory.support.Abstract AutowireCapableBean
Factory.<init>(AbstractAutowireCapableBeanFactory. java:168) ~[spring-beans-3.1.4
.RELEASE.jar:3.1.4.RELEASE]
at org.springframework.beans.factory.support.DefaultL istableBeanFactory.
<init>(DefaultListableBeanFactory.java:163) ~[spring-beans-3.1.4.RELEASE.jar:3.1
.4.RELEASE]
at org.springframework.context.support.AbstractRefres hableApplicationCon
text.createBeanFactory(AbstractRefreshableApplicat ionContext.java:194) ~[spring-
context-3.2.2.RELEASE.jar:3.2.2.RELEASE]
at org.springframework.context.support.AbstractRefres hableApplicationCon
text.refreshBeanFactory(AbstractRefreshableApplica tionContext.java:127) ~[spring
-context-3.2.2.RELEASE.jar:3.2.2.RELEASE]
at org.springframework.context.support.AbstractApplic ationContext.obtain
FreshBeanFactory(AbstractApplicationContext.java:5 37) ~[spring-context-3.2.2.REL
EASE.jar:3.2.2.RELEASE]
at org.springframework.context.support.AbstractApplic ationContext.refres
h(AbstractApplicationContext.java:451) ~[spring-context-3.2.2.RELEASE.jar:3.2.2.
RELEASE]
at org.springframework.web.context.ContextLoader.conf igureAndRefreshWebA
pplicationContext(ContextLoader.java:389) ~[spring-web-3.2.2.RELEASE.jar:3.2.2.R
ELEASE]
at org.springframework.web.context.ContextLoader.init WebApplicationConte
xt(ContextLoader.java:294) ~[spring-web-3.2.2.RELEASE.jar:3.2.2.RELEASE]
at org.springframework.web.context.ContextLoaderListe ner.contextInitiali
zed(ContextLoaderListener.java:112) [spring-web-3.2.2.RELEASE.jar:3.2.2.RELEASE]

at org.apache.catalina.core.StandardContext.listenerS tart(StandardContex
t.java:4791) [tomcat-embed-core-7.0.30.jar:7.0.30]
at org.apache.catalina.core.StandardContext.startInte rnal(StandardContex
t.java:5285) [tomcat-embed-core-7.0.30.jar:7.0.30]
at org.apache.catalina.util.LifecycleBase.start(Lifec ycleBase.java:150)
[tomcat-embed-core-7.0.30.jar:7.0.30]
at org.apache.catalina.core.ContainerBase$StartChild. call(ContainerBase.
java:1559) [tomcat-embed-core-7.0.30.jar:7.0.30]
at org.apache.catalina.core.ContainerBase$StartChild. call(ContainerBase.
java:1549) [tomcat-embed-core-7.0.30.jar:7.0.30]
at java.util.concurrent.FutureTask$Sync.innerRun(Futu reTask.java:303) [n
a:1.6.0_20]
at java.util.concurrent.FutureTask.run(FutureTask.jav a:138) [na:1.6.0_20
]
at java.util.concurrent.ThreadPoolExecutor$Worker.run Task(ThreadPoolExec
utor.java:886) [na:1.6.0_20]
at java.util.concurrent.ThreadPoolExecutor$Worker.run (ThreadPoolExecutor
.java:908) [na:1.6.0_20]
at java.lang.Thread.run(Thread.java:619) [na:1.6.0_20]
Caused by: java.lang.ClassNotFoundException: org.springframework.asm.ClassVisito
r
at org.apache.catalina.loader.WebappClassLoader.loadC lass(WebappClassLoa
der.java:1714) ~[tomcat-embed-core-7.0.30.jar:7.0.30]
at org.apache.catalina.loader.WebappClassLoader.loadC lass(WebappClassLoa
der.java:1559) ~[tomcat-embed-core-7.0.30.jar:7.0.30]
... 20 common frames omitted
INFO XmlWebApplicationContext - Closing Root WebApplicationContext: startup dat
e [Wed Mar 27 11:31:56 CDT 2013]; root of context hierarchy
WARN XmlWebApplicationContext - Exception thrown from ApplicationListener handl
ing ContextClosedEvent
java.lang.IllegalStateException: ApplicationEventMulticaster not initialized - c
all 'refresh' before multicasting events via the context: Root WebApplicationCon
text: startup date [Wed Mar 27 11:31:56 CDT 2013]; root of context hierarchy
at org.springframework.context.support.AbstractApplic ationContext.getApp
licationEventMulticaster(AbstractApplicationContex t.java:347) [spring-context-3.
2.2.RELEASE.jar:3.2.2.RELEASE]
at org.springframework.context.support.AbstractApplic ationContext.publis
hEvent(AbstractApplicationContext.java:334) [spring-context-3.2.2.RELEASE.jar:3.
2.2.RELEASE]
at org.springframework.context.support.AbstractApplic ationContext.doClos
e(AbstractApplicationContext.java:1049) [spring-context-3.2.2.RELEASE.jar:3.2.2.
RELEASE]
at org.springframework.context.support.AbstractApplic ationContext.close(
AbstractApplicationContext.java:1010) [spring-context-3.2.2.RELEASE.jar:3.2.2.RE
LEASE]
at org.springframework.web.context.ContextLoader.clos eWebApplicationCont
ext(ContextLoader.java:558) [spring-web-3.2.2.RELEASE.jar:3.2.2.RELEASE]
at org.springframework.web.context.ContextLoaderListe ner.contextDestroye
d(ContextLoaderListener.java:143) [spring-web-3.2.2.RELEASE.jar:3.2.2.RELEASE]
at org.apache.catalina.core.StandardContext.listenerS top(StandardContext
.java:4831) [tomcat-embed-core-7.0.30.jar:7.0.30]
at org.apache.catalina.core.StandardContext.stopInter nal(StandardContext
.java:5478) [tomcat-embed-core-7.0.30.jar:7.0.30]
at org.apache.catalina.util.LifecycleBase.stop(Lifecy cleBase.java:232) [
tomcat-embed-core-7.0.30.jar:7.0.30]
at org.apache.catalina.util.LifecycleBase.start(Lifec ycleBase.java:160)
[tomcat-embed-core-7.0.30.jar:7.0.30]
at org.apache.catalina.core.ContainerBase$StartChild. call(ContainerBase.
java:1559) [tomcat-embed-core-7.0.30.jar:7.0.30]
at org.apache.catalina.core.ContainerBase$StartChild. call(ContainerBase.
java:1549) [tomcat-embed-core-7.0.30.jar:7.0.30]
at java.util.concurrent.FutureTask$Sync.innerRun(Futu reTask.java:303) [n
a:1.6.0_20]
at java.util.concurrent.FutureTask.run(FutureTask.jav a:138) [na:1.6.0_20
]
at java.util.concurrent.ThreadPoolExecutor$Worker.run Task(ThreadPoolExec
utor.java:886) [na:1.6.0_20]
at java.util.concurrent.ThreadPoolExecutor$Worker.run (ThreadPoolExecutor
.java:908) [na:1.6.0_20]
at java.lang.Thread.run(Thread.java:619) [na:1.6.0_20]
WARN XmlWebApplicationContext - Exception thrown from LifecycleProcessor on con
text close
java.lang.IllegalStateException: LifecycleProcessor not initialized - call 'refr
esh' before invoking lifecycle methods via the context: Root WebApplicationConte
xt: startup date [Wed Mar 27 11:31:56 CDT 2013]; root of context hierarchy
at org.springframework.context.support.AbstractApplic ationContext.getLif
ecycleProcessor(AbstractApplicationContext.java:36 0) [spring-context-3.2.2.RELEA
SE.jar:3.2.2.RELEASE]
at org.springframework.context.support.AbstractApplic ationContext.doClos
e(AbstractApplicationContext.java:1057) [spring-context-3.2.2.RELEASE.jar:3.2.2.
RELEASE]
at org.springframework.context.support.AbstractApplic ationContext.close(
AbstractApplicationContext.java:1010) [spring-context-3.2.2.RELEASE.jar:3.2.2.RE
LEASE]
at org.springframework.web.context.ContextLoader.clos eWebApplicationCont
ext(ContextLoader.java:558) [spring-web-3.2.2.RELEASE.jar:3.2.2.RELEASE]
at org.springframework.web.context.ContextLoaderListe ner.contextDestroye
d(ContextLoaderListener.java:143) [spring-web-3.2.2.RELEASE.jar:3.2.2.RELEASE]
at org.apache.catalina.core.StandardContext.listenerS top(StandardContext
.java:4831) [tomcat-embed-core-7.0.30.jar:7.0.30]
at org.apache.catalina.core.StandardContext.stopInter nal(StandardContext
.java:5478) [tomcat-embed-core-7.0.30.jar:7.0.30]
at org.apache.catalina.util.LifecycleBase.stop(Lifecy cleBase.java:232) [
tomcat-embed-core-7.0.30.jar:7.0.30]
at org.apache.catalina.util.LifecycleBase.start(Lifec ycleBase.java:160)
[tomcat-embed-core-7.0.30.jar:7.0.30]
at org.apache.catalina.core.ContainerBase$StartChild. call(ContainerBase.
java:1559) [tomcat-embed-core-7.0.30.jar:7.0.30]
at org.apache.catalina.core.ContainerBase$StartChild. call(ContainerBase.
java:1549) [tomcat-embed-core-7.0.30.jar:7.0.30]
at java.util.concurrent.FutureTask$Sync.innerRun(Futu reTask.java:303) [n
a:1.6.0_20]
at java.util.concurrent.FutureTask.run(FutureTask.jav a:138) [na:1.6.0_20
]
at java.util.concurrent.ThreadPoolExecutor$Worker.run Task(ThreadPoolExec
utor.java:886) [na:1.6.0_20]
at java.util.concurrent.ThreadPoolExecutor$Worker.run (ThreadPoolExecutor
.java:908) [na:1.6.0_20]
at java.lang.Thread.run(Thread.java:619) [na:1.6.0_20] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T17:20:50.593

将 asm.jar 添加到类路径中。由于 spring 内部使用许多第三方库，您可能还会遇到其他 classnotfound 异常。我通常去 jarfinder.com 提供类名，然后下载该类的 jar 并放入类路径中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T17:20:54.707

异常清楚地表明

```
java.lang.NoClassDefFoundError: org/springframework/asm/ClassVisitor 
```

这意味着您没有在类路径中包含 spring asm 库。

在您的类路径中包含 spring-asm.jar 文件以解决此问题。

# php - 使用 PHP 5.3/Doctrine 1.2 将字符串从 utf8_decode 插入 mysql 表后出现奇怪的字符

> ID：15665147
> 
> 赞同：0
> 
> 时间：2013-03-27T17:14:24.203
> 
> 标签：php, xml, utf-8, doctrine-1.2, latin1

我正在使用一个 xml（我通过休息服务获得它）。在某一时刻，我将 CDATA 字段解码为：

```
$version_doc = $this->getSimpleXml($uri);

if($version_doc != false){
        $equipment = utf8_decode((string)$version_doc->equipment);
} 
```

这是 xml 字段“设备”的示例：

```
![CDATA[ABARTH: ABS, llantas de aleación de 16'', eléctrico,llantas de aleación de 17&quot; color antracita.]] 
```

在我设置了 $equipment 变量之后，如果我将它保存在 mysql 中（一个 latin1_spanish_ci collat​​e、latin1 charset 表和 Doctrine 1.2），那么该行的 mysql col 中的结果是：

ABS, llantas de aleación de 16'', eléctrico,llantas de aleación de 17?? 颜色炭疽。

为什么我总是得到？象征？

我在 PHP5.3 ， MySql 5 并在 MAMP 环境（MAC）中运行服务器

# ruby-on-rails - 使用设计宝石耙路线错误

> ID：15665152
> 
> 赞同：1
> 
> 时间：2013-03-27T17:14:42.027
> 
> 标签：ruby-on-rails, ruby-on-rails-3, devise

我的 routes.rb 看起来像这样。

```
devise_for :users, :skip => [:sessions]
as :user do
  get 'signin' => 'devise/sessions#new', :as => :new_user_session
  post 'signin' => 'devise/sessions#create', :as => :user_session
  delete 'signout' => 'devise/sessions#destroy', :as => :destroy_user_session
end 
```

当我运行时`rake routes`出现错误

```
undefined method `as' for #<ActionDispatch::Routing::Mapper:0xa954f20>
/home/ramkishan/vijay_work/kirana/config/routes.rb:4:in `block in <top (required)>' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T19:28:27.610

无需使用**as**，

```
devise_for :users, :skip => [:sessions] do
  get '/signin'   => "devise/sessions#new",       :as => :new_user_session
  post '/signin'  => 'devise/sessions#create',    :as => :user_session
  get '/signout'  => 'devise/sessions#destroy',   :as => :destroy_user_session
end 
```

应该做。

# c# - 在 C# 代码中隐藏或删除 wpf 按钮的边框

> ID：15665153
> 
> 赞同：1
> 
> 时间：2013-03-27T17:14:46.053
> 
> 标签：c#, wpf, c#-4.0, wpf-controls, c#-3.0

我的 xaml 文件中有一个名为“mystack”的堆栈面板，我正在从 .cs 文件中动态添加按钮，并希望删除 C# .cs 文件中按钮的边框

我真正想要的是用来自字符串列表的按钮填充这个堆栈面板，谢谢

xml:

```
 <Grid HorizontalAlignment="Left" Height="227" Margin="10,10,0,0" Grid.Row="2"    
        VerticalAlignment="Top" Width="530">
        <ScrollViewer VerticalScrollBarVisibility="Auto">
            <StackPanel Name="mystack" HorizontalAlignment="Left" Grid.Row="2" 
                       VerticalAlignment="Top" Width="520"/>
        </ScrollViewer>
    </Grid> 
```

。CS：

```
 public List<String> Schools()
    {

        List<String> l = new List<string>();
        l.Add("SST");
        l.Add("SBE");
        l.Add("SSH");

        return l;

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T17:22:21.800

我同意 HighCore，您通常不想在代码中操作 UI 元素。

要删除`Border`按钮，您可以在 Xaml 或代码隐藏中将 Button 的`BorderThickness`属性设置为“0” 。`new Thickness(0)`

IE

```
myButton.BorderThickness = new Thickness(0); 
```

编辑：

好的，我注意到你更新的问题。我将创建一个属性来存储您的学校列表并以类似于以下方式绑定到它：

```
public List<string> Schools 
{ 
    get { return _schools; }
    set { _schools = value; } 
} 
```

您需要在某处`DataContext`将控件设置为包含该`Schools`属性的类。如果您要动态更新 Schools 列表，则需要实现[INotifyPropertyChanged](http://msdn.microsoft.com/en-us/library/ms229614.aspx)以便 UI 知道何时更新。然后你的 Xaml 看起来像这样：

```
<ItemsControl ItemsSource="{Binding Schools}">
    <ItemsControl.ItemTemplate>
        <DataTemplate>
             <Button Content="{Binding}" BorderThickness="0" />
        </DataTemplate>
    </ItemsControl.ItemTemplate>
<ItemsControl> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T17:30:34.033

## 快速修复：

我必须做些什么来有效地`hide`按钮边框 - 由于按钮控制模板我相信它利用和更改按钮边框（即**即使你删除它它会在我相信的某个触发器上绘制它**）......

...也要设置`BorderBrush="Transparent"`（我总是这样做`BorderThickness`，但我猜这不是必需的 - 仅用于视觉/布局外观）

即`thickness`单独设置是不够的。

> 我真的不确定这是否是下注的方法，或者实际上我很确定一定有更聪明的东西 - 但我总是以这种方式结束。

## 正确的方式：

> 正确的方法 - 并推荐 - 是编写自己的 Button 模板 - 基于 Microsoft 官方模板 - 或`base`它上面 - 并做你需要的无边框。

对于/C# 后面的代码：

> 根据您更改的问题，您真的不需要那个 - 做其他人已经建议的事情

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T17:33:04.177

您不能删除按钮的边框，例如：`btn.BorderThicknes=new Thickness(0);`

看到这个：[删除按钮的边框](https://stackoverflow.com/questions/4553692/how-to-remove-buttonchrome-border-when-defining-the-template-of-a-border)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-08-08T09:59:03.333

最好的方法是：

```
<Style TargetType="Button">
    <Style.Resources>
        <Style TargetType="{x:Type Border}">
            <Setter Property="CornerRadius" Value="0"/>
        </Style>
    </Style.Resources>
</Style> 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-03-27T17:28:05.013

> 我真正想要的是用来自字符串列表的按钮填充这个堆栈面板

这被称为`ListBox`：

```
<ListBox ItemsSource="{Binding Items}">
    <ListBox.ItemTemplate>
        <DataTemplate>
           <Button Content="{Binding}" BorderThickness="0"/>
                   <!-- Whatever other customizations to the button -->
        </DataTemplate
    </ListBox.ItemTemplate>
</ListBox> 
```

视图模型：

```
public class ViewModel
{
    public ObservableCollection<string> Items {get;set;}

    public ViewModel()
    {
        Items = new ObservablecCollection<string>();
        Items.Add("String1");
        Items.Add("String2");
        Items.Add("String3");
    }
} 
```

您需要学习 MVVM 模式。

# python - Python - 钟摆公式

> ID：15665154
> 
> 赞同：2
> 
> 时间：2013-03-27T17:14:48.020
> 
> 标签：python, python-3.x

我被提出了以下问题（有点啰嗦）：

> 在物理学中，对于一个长度为 L、初角为 A 的摆，它在 T 时刻的水平位移 X(T) 由下式给出
> 
> ```
> X(T) = L × cos(A × cos(T × √9.8/L)) - L × cos(A) 
> ```
> 
> 编写一个接受两行输入的程序；第一行是 L，第二行是 A。输出应该是十行，给出`X(0)`, `X(1)`, `X(2)`, ...,的值`X(9)`。例如，如果第一行输入是`53.1`，第二行输入是`0.8`，那么第一行输出是 0.0，第二行输出是`53.1*cos(0.8*cos(1*√9.8/53.1)) - 53.1*cos(0.8) ~ 2.6689`。

我写了以下代码来回答这个问题：

```
from math import sqrt
from math import cos
L = float(input())
A = float(input())

def X(T):
   print(L*cos(A*cos(T*sqrt(9.8/L))-L*cos(A)))

for n in range(0, 9):
   X(n) 
```

...但我的答案总是出错。我可能在某处遗漏了一些括号，但我看不到在哪里。

我得到的输出：

```
3.545012155898153
7.383727226708044
17.92714440725987
31.889478979714276
44.23118522394127
51.212404291669216
53.079364553814806
52.890770379027806
52.999922313121566 
```

我应该得到的输出：

```
0.0
2.6689070487226805
9.021742145820763
14.794542557581206
15.73774678328343
11.124903835610114
4.423693604072537
0.27377375601245213
1.295906539090336
6.863309996333497 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T17:18:27.490

你在第一个余弦之后缺少括号

```
L * cos(
  A * cos(
    T* sqrt(9.8/L)
  )
) - L * cos(A) 
```

应该

```
 L*cos(A*cos(T*sqrt(9.8/L)))-L*cos(A) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T17:18:27.003

你是对的，你的括号放错了。以下将修复它：

```
print(L*cos(A*cos(T*sqrt(9.8/L)))-L*cos(A))
                                ^ added    ^ removed 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-27T17:19:22.570

物理公式看起来第一个cos应该更早结束。所以最后的一个支架应该更靠前：

```
print(L * cos(A * cos(T * sqrt(9.8/L))) - L * cos(A)) 
```

更清楚一点：

```
firstCos = cos(A * cos(T * sqrt(9.8/L)))
print(L * firstCos - L * cos(A)) 
```

# abap - 我们是否还需要在 ECC 6 EHP4+ 中进行 DEFINITION LOAD

> ID：15665170
> 
> 赞同：2
> 
> 时间：2013-03-27T17:15:15.693
> 
> 标签：abap, sap-erp

我正在根据我的需要调整 RM_FM_EXCEL_TO_INTERNAL_TAB，我看到了以下代码：

```
"Get TAB-sign for separation of fields
CLASS cl_abap_char_utilities DEFINITION LOAD.
ld_separator = cl_abap_char_utilities=>horizontal_tab. 
```

您能否确认绝对不需要再进行定义加载，我认为这是一些古老的遗留代码？在使用静态方法或属性之前，我从不加载类，它似乎可以工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T18:53:42.737

与往常一样，我建议以[官方文档](http://help.sap.com/abapdocu_702/en/abapclass_interface_load.htm)作为参考：

> 语句 CLASS 和 INTERFACE 的变体加上 LOAD 已过时。ABAP 编译器会忽略这些语句。

# ruby-on-rails - heroku 上的 slug 大小有多大影响

> ID：15665172
> 
> 赞同：3
> 
> 时间：2013-03-27T17:15:19.160
> 
> 标签：ruby-on-rails, heroku, middleman

计划制作一个包含静态 html 内容的网站，我探索了在 Heroku 上使用 Rails 的替代方案，因为我不需要数据库或 Rails 提供的任何其他功能。我听说 Middleman 静态站点生成器可能会帮助我创建一个可以部署到 Heroku 的轻量级站点。

我用 Middleman 创建了一个测试站点，其中包含大约 6 个大部分为空的 html 内容页面（基本上每个页面上只有一个标题）。推送到 Heroku 后，我得到了这些 repo 和 slug 大小的统计信息

```
Repo size: 7.33 MB
Slug size: 8.3 MB of 200 MB 
```

slug 大小大于 repo 大小。根据 Heroku 文档，slug 应该是“应用程序的压缩和预打包副本，已针对在测功机流形上的闪电般快速分布进行了优化。” 我猜蛞蝓大小应该小于回购大小。

为了比较，我查看了我的一个基本 Rails 应用程序的统计数据，我只是将它用作博客引擎（使用 Enki）。它目前有一个数据库和大约 50 篇博客文章。

```
Repo size: 17.2 MB
Slug size: 5.55 MB of 200 MB 
```

因此，虽然 Rails 应用程序的 repo 大小要大得多，但 slug 的大小要小得多。

slug 大小是影响 Heroku 性能的唯一因素吗？如果是这样，即使我真的只打算发布一点静态内容，对我来说明显的选择是回到使用简单的 Rails 站点吗？

撇开蛞蝓大小不谈，您是否认为中间人站点可能仍然更快，因为它不使用数据库？因此不必进行查询来检索内容？对于中间人站点，我只是将内容直接写入 html 页面。我对网站真正关心的是让用户在内容页面之间快速移动。对于较小的 slug 大小的 Rails 应用程序，这将涉及数据库查询，而对于较大的 slug 大小的 Middleman 应用程序，它不会。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-27T17:33:20.417

> slug 大小是影响 Heroku 性能的唯一因素吗？

slug 大小不会影响您的应用程序的性能。如果你的 slug 更小，你的部署会更快，但是一旦应用程序被部署，性能将只取决于它的代码和它使用的资源。

您提到了一个很好的例子：典型的 Rails 应用程序可能会对数据库进行多次查询，因此响应时间比典型的中间人应用程序要长，后者只是读取并返回 HTML。

# ios - UICollectionView 单元格选择和单元格重用

> ID：15665181
> 
> 赞同：51
> 
> 时间：2013-03-27T17:15:43.447
> 
> 标签：ios, objective-c, uicollectionview

选择单元格后，我想处理更改单元格外观。我认为委托方法`collectionView:didSelectItemAtIndexPath:`是`collectionView:didDeselectItemAtIndexPath:`我应该编辑单元格的地方。

```
-(void)collectionView:(UICollectionView *)collectionView 
       didSelectItemAtIndexPath:(NSIndexPath *)indexPath {

    DatasetCell *datasetCell = 
      (DatasetCell *)[collectionView cellForItemAtIndexPath:indexPath];

    [datasetCell replaceHeaderGradientWith:[UIColor skyBlueHeaderGradient]];
    datasetCell.backgroundColor = [UIColor skyBlueColor];
} 
```

### 和

```
-(void)collectionView:(UICollectionView *)collectionView 
       didDeselectItemAtIndexPath:(NSIndexPath *)indexPath {

    DatasetCell *datasetCell = 
      (DatasetCell *)[collectionView cellForItemAtIndexPath:indexPath];

    [datasetCell replaceHeaderGradientWith:[UIColor grayGradient]];
    datasetCell.backgroundColor = [UIColor myDarkGrayColor];
} 
```

这工作正常，除非单元格被重用。如果我选择索引 (0, 0) 处的单元格，它会改变外观，但是当我向下滚动时，另一个单元格处于选定状态。

我相信我应该使用该`UICollectionViewCell`方法`-(void)prepareForReuse`准备单元格以供重用（即将单元格外观设置为非选定状态），但这给我带来了困难。

```
-(void)prepareForReuse {
    if ( self.selected ) {
        [self replaceHeaderGradientWith:[UIColor skyBlueHeaderGradient]];
        self.backgroundColor = [UIColor skyBlueColor];
    } else {
        [self replaceHeaderGradientWith:[UIColor grayGradient]];
        self.backgroundColor = [UIColor myDarkGrayColor];
    }
} 
```

当我滚动回顶部时，索引 (0, 0) 处的单元格处于取消选择状态。

当我刚刚使用 cell.backgroundView 属性时，为了防止这种情况发生是：

```
-(void)prepareForReuse {
    self.selected = FALSE;
} 
```

并且选择状态按预期工作。

有任何想法吗？

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2013-04-02T07:26:14.793

你的观察是正确的。这种行为是由于单元格的重用而发生的。**但是您不必对prepareForReuse**做任何事情 。相反，请检查**cellForItem**并相应地设置属性。就像是..

```
 - (UICollectionViewCell *)collectionView:(UICollectionView *)collectionView cellForItemAtIndexPath:(NSIndexPath *)indexPath
{
UICollectionViewCell *cell = [collectionView dequeueReusableCellWithReuseIdentifier:@"cvCell" forIndexPath:indexPath];

if (cell.selected) {
     cell.backgroundColor = [UIColor blueColor]; // highlight selection 
}
else
{
     cell.backgroundColor = [UIColor redColor]; // Default color
}
return cell;
}

-(void)collectionView:(UICollectionView *)collectionView didSelectItemAtIndexPath:(NSIndexPath *)indexPath  {

    UICollectionViewCell *datasetCell =[collectionView cellForItemAtIndexPath:indexPath];
    datasetCell.backgroundColor = [UIColor blueColor]; // highlight selection
 }  

 -(void)collectionView:(UICollectionView *)collectionView didDeselectItemAtIndexPath:(NSIndexPath *)indexPath {

UICollectionViewCell *datasetCell =[collectionView cellForItemAtIndexPath:indexPath]; 
datasetCell.backgroundColor = [UIColor redColor]; // Default color
} 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2013-10-03T11:58:06.903

**一旦您设置了单元格`backgroundView`，**框架将为您处理切换视图**`selectedBackgroundView`，请参见[管理选择和突出显示的视觉状态中的](https://developer.apple.com/library/ios/documentation/WindowsViews/Conceptual/CollectionViewPGforIOS/CreatingCellsandViews/CreatingCellsandViews.html#//apple_ref/doc/uid/TP40012334-CH7-SW8)示例：**

 **```
UIView* backgroundView = [[UIView alloc] initWithFrame:self.bounds];
backgroundView.backgroundColor = [UIColor redColor];
self.backgroundView = backgroundView;

UIView* selectedBGView = [[UIView alloc] initWithFrame:self.bounds];
selectedBGView.backgroundColor = [UIColor whiteColor];
self.selectedBackgroundView = selectedBGView; 
```

你只需要在你的类中实现`UICollectionViewDelegate`使单元格突出显示并像这样选择：

```
- (BOOL)collectionView:(UICollectionView *)collectionView
        shouldHighlightItemAtIndexPath:(NSIndexPath *)indexPath
{
    return YES;
}

- (BOOL)collectionView:(UICollectionView *)collectionView
        shouldSelectItemAtIndexPath:(NSIndexPath *)indexPath;
{
    return YES;
} 
```

这对我有用。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2016-11-22T18:26:56.657

UICollectionView 在 iOS 10 中发生了变化，为上述解决方案引入了一些问题。

这是一个很好的指南： [https ://littlebitesofcocoa.com/241-uicollectionview-cell-pre-fetching](https://littlebitesofcocoa.com/241-uicollectionview-cell-pre-fetching)

离开屏幕后，细胞现在会停留一段时间。这意味着有时我们可能无法抓住一个单元格`didDeselectItemAt indexPath`来调整它。然后它可以显示在未更新和未回收的屏幕上。`prepareForReuse`对这种极端情况没有帮助。

最简单的解决方案是通过设置`isPrefetchingEnabled`为 false 来禁用新的滚动。有了这个，管理单元格的显示 `cellForItemAt` `didSelect` `didDeselect`就像以前一样工作。

但是，如果您希望保持新的平滑滚动行为，最好使用`willDisplay`：

```
func collectionView(_ collectionView: UICollectionView, willDisplay cell: UICollectionViewCell, forItemAt indexPath: IndexPath) {
    let customCell = cell as! CustomCell
    if customCell.isSelected {
        customCell.select()
    } else {
        customCell.unselect()
    }
}

func collectionView(_ collectionView: UICollectionView, cellForItemAt indexPath: IndexPath) -> UICollectionViewCell {
    let cell = collectionView.dequeueReusableCell(withReuseIdentifier: "CustomCell", for: indexPath) as! CustomCell
    //Don't even need to set selection-specific things here as recycled cells will also go through willDisplay
    return cell
}

func collectionView(_ collectionView: UICollectionView, didSelectItemAt indexPath: IndexPath) {
    let cell = collectionView.cellForItem(at: indexPath) as? CustomCell
    cell?.select()
}

func collectionView(_ collectionView: UICollectionView, didDeselectItemAt indexPath: IndexPath) {
    let cell = collectionView.cellForItem(at: indexPath) as? CustomCell
    cell?.unselect() // <----- this can be null here, and the cell can still come back on screen!
} 
```

使用上述方法，您可以控制单元格被选中、在屏幕上取消选中、回收以及重新显示时。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2013-06-07T19:08:10.887

Anil 走在了正确的轨道上（他的解决方案看起来应该可行，我独立于他开发了这个解决方案）。我仍然使用该`prepareForReuse:`方法将单元格设置`selected`为`FALSE`，然后在`cellForItemAtIndexPath`我检查单元格的索引是否在 `collectionView.indexPathsForSelectedItems' 中，如果是，突出显示它。

在自定义单元格中：

```
-(void)prepareForReuse {
    self.selected = FALSE;
} 
```

处理高亮`cellForItemAtIndexPath:`和取消高亮重用单元格：

```
if ([collectionView.indexPathsForSelectedItems containsObject:indexPath]) {
    [collectionView selectItemAtIndexPath:indexPath animated:FALSE scrollPosition:UICollectionViewScrollPositionNone];
    // Select Cell
}
else {
    // Set cell to non-highlight
} 
```

`didDeselectItemAtIndexPath:`然后在and中处理单元格高亮和去高亮`didSelectItemAtIndexPath:`

这对我来说就像一个魅力。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2014-05-08T05:42:00.137

我有一个水平滚动的集合视图（我在 Tableview 中使用集合视图）并且我也遇到了单元重用的问题，每当我选择一个项目并向右滚动时，下一个可见集中的其他一些单元格会自动选择。尝试使用任何自定义单元格属性（如“选定”、突出显示等）来解决这个问题并没有帮助我，所以我想出了下面的解决方案，这对我有用。

第1步：

在collectionView中创建一个变量来存储选中的索引，这里我使用了一个类级别的变量，叫做selectedIndex

```
- (UICollectionViewCell *)collectionView:(UICollectionView *)collectionView cellForItemAtIndexPath:(NSIndexPath *)indexPath

{

    MyCVCell *cell = (MyCVCell*)[collectionView dequeueReusableCellWithReuseIdentifier:@"MyCVCell" forIndexPath:indexPath];    

// When scrolling happens, set the selection status only if the index matches the selected Index

if (selectedIndex == indexPath.row) {

        cell.layer.borderWidth = 1.0;

        cell.layer.borderColor = [[UIColor redColor] CGColor];

    }
    else
    {
        // Turn off the selection
        cell.layer.borderWidth = 0.0;

    }
    return cell;

}
- (void)collectionView:(UICollectionView *)collectionView didSelectItemAtIndexPath:(NSIndexPath *)indexPath

{
    MyCVCell *cell = (MyCVCell *)[collectionView cellForItemAtIndexPath:indexPath];
    // Set the index once user taps on a cell
    selectedIndex = indexPath.row;
    // Set the selection here so that selection of cell is shown to ur user immediately
    cell.layer.borderWidth = 1.0;
    cell.layer.borderColor = [[UIColor redColor] CGColor];
    [cell setNeedsDisplay];
}

- (void)collectionView:(UICollectionView *)collectionView didDeselectItemAtIndexPath:(NSIndexPath *)indexPath

{

    MyCVCell *cell = (MyCVCell *)[collectionView cellForItemAtIndexPath:indexPath];

    // Set the index to an invalid value so that the cells get deselected
    selectedIndex = -1;
    cell.layer.borderWidth = 0.0;
    [cell setNeedsDisplay];

} 
```

-anoop

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2017-05-16T15:53:03.747

我为解决这个问题所做的是在自定义单元格中进行更改。您在其类中有一个名为*DataSetCell*的自定义单元格，您可以执行以下操作（代码在 swift 中）

```
override var isSelected: Bool {
    didSet {
        if isSelected {
            changeStuff
        } else {
            changeOtherStuff
        }
    }
} 
```

这样做的作用是每次选择、取消选择、初始化或从可重用队列中调用单元格时，该代码将运行并进行更改。希望这对您有所帮助。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-07-11T09:34:06.877

在您的自定义单元格中创建公共方法：

```
- (void)showSelection:(BOOL)selection
{
    self.contentView.backgroundColor = selection ? [UIColor blueColor] : [UIColor white];
} 
```

还要编写 -prepareForReuse 单元格方法的重新定义：

```
- (void)prepareForReuse
{
    [self showSelection:NO];
    [super prepareForReuse];
} 
```

在您的 ViewController 中，您应该有 _selectedIndexPath 变量，该变量在 -didSelectItemAtIndexPath 中定义并在 -didDeselectItemAtIndexPath 中无效

```
NSIndexPath *_selectedIndexPath;

- (UICollectionViewCell *)collectionView:(UICollectionView *)collectionView cellForItemAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *cellIdentifier = @"Cell";
    UICollectionViewCell *cell = [collectionView dequeueReusableCellWithReuseIdentifier:cellIdentifier forIndexPath:indexPath];

    if (_selectedIndexPath) {
        [cell showSelection:[indexPath isEqual:_selectedIndexPath]];
    }
}

- (void)collectionView:(UICollectionView *)collectionView didSelectItemAtIndexPath:(NSIndexPath *)indexPath
{
    UICollectionViewCell *cell = [collectionView cellForItemAtIndexPath:indexPath];
    [cell showSelection:![indexPath isEqual:_selectedIndexPath]];// on/off selection
    _selectedIndexPath = [indexPath isEqual:_selectedIndexPath] ? nil : indexPath;
}

- (void)collectionView:(UICollectionView *)collectionView didDeselectItemAtIndexPath:(NSIndexPath *)indexPath
{
    UICollectionViewCell *cell = [collectionView cellForItemAtIndexPath:indexPath];
    [cell showSelection:NO];
    _selectedIndexPath = nil;
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-04-26T08:48:09.730

只有[@stefanB](https://stackoverflow.com/a/19158630/1371853)解决方案在 iOS 9.3 上对我有用

这是我必须**为 Swift 2更改的内容**

```
func collectionView(collectionView: UICollectionView, cellForItemAtIndexPath indexPath: NSIndexPath) -> UICollectionViewCell {

        //prepare your cell here..

        //Add background view for normal cell
        let backgroundView: UIView = UIView(frame: cell!.bounds)
        backgroundView.backgroundColor = UIColor.lightGrayColor()
        cell!.backgroundView = backgroundView

        //Add background view for selected cell
        let selectedBGView: UIView = UIView(frame: cell!.bounds)
        selectedBGView.backgroundColor = UIColor.redColor()
        cell!.selectedBackgroundView = selectedBGView

        return cell!
 }

 func collectionView(collectionView: UICollectionView, shouldHighlightItemAtIndexPath indexPath: NSIndexPath) -> Bool {
        return true
 }

 func collectionView(collectionView: UICollectionView, shouldSelectItemAtIndexPath indexPath: NSIndexPath) -> Bool {
        return true
 } 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-09-06T08:44:18.700

您遇到的问题来自缺少对`super.prepareForReuse()`.

上面的一些其他解决方案，建议从委托的函数更新单元格的 UI，这导致了一个有缺陷的设计，其中单元格的行为逻辑在其类之外。此外，它是可以通过调用简单地修复的额外代码`super.prepareForReuse()`。例如 ：

```
class myCell: UICollectionViewCell {

    // defined in interface builder
    @IBOutlet weak var viewSelection : UIView!

    override var isSelected: Bool {
        didSet {
            self.viewSelection.alpha = isSelected ? 1 : 0
        }
    }

    override func prepareForReuse() {
        // Do whatever you want here, but don't forget this :
        super.prepareForReuse()
        // You don't need to do `self.viewSelection.alpha = 0` here 
        // because `super.prepareForReuse()` will update the property `isSelected`

    }

    override func awakeFromNib() {
        super.awakeFromNib()
        // Initialization code
        self.viewSelection.alpha = 0
    }

} 
```

通过这样的设计，您甚至可以将代理的功能`collectionView:didSelectItemAt:`/`collectionView:didDeselectItemAt:`全部留空，选择过程将被完全处理，并在单元格回收时正常运行。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-07-20T16:00:07.207

您可以将单元格的 selectedBackgroundView 设置为 backgroundColor=x。

现在，任何时候您点击单元格，他选择的模式都会自动更改，并且会根据背景颜色更改为 x。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-10-18T13:35:29.890

感谢您的回答[@RDC](https://stackoverflow.com/a/36859814/4965086 "研发中心")。

以下代码适用于**Swift 3**

```
// MARK: - UICollectionViewDataSource protocol
func collectionView(_ collectionView: UICollectionView, cellForItemAt indexPath: IndexPath) -> UICollectionViewCell {

    //prepare your cell here..
    let cell = collectionView.dequeueReusableCell(withReuseIdentifier: reuseIdentifier, for: indexPath as IndexPath) as! MyCell
    cell.myLabel.text =  "my text"

    //Add background view for normal cell
    let backgroundView: UIView = UIView(frame: cell.bounds)
    backgroundView.backgroundColor = UIColor.lightGray
    cell.backgroundView = backgroundView

    //Add background view for selected cell
    let selectedBGView: UIView = UIView(frame: cell.bounds)
    selectedBGView.backgroundColor = UIColor.green
    cell.selectedBackgroundView = selectedBGView

    return cell
}

// MARK: - UICollectionViewDelegate protocol
func collectionView(_ collectionView: UICollectionView, shouldHighlightItemAt indexPath: IndexPath) -> Bool {
    return true
}

func collectionView(_ collectionView: UICollectionView, shouldSelectItemAt indexPath: IndexPath) -> Bool {
    return true
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-04-09T01:42:51.167

更改单元格属性（例如单元格的背景颜色）不应该在 UICollectionViewController 本身上完成，它应该在 CollectionViewCell 类中完成。不要使用 didSelect 和 didDeselect，只要使用这个：

```
class MyCollectionViewCell: UICollectionViewCell 
{
     override var isSelected: Bool
     {
         didSet
         {
            // Your code
         }
     } 
} 
```**

# android - asmx webservice 从 ksoap2 android 接收空值

> ID：15665189
> 
> 赞同：0
> 
> 时间：2013-03-27T17:16:02.447
> 
> 标签：android, web-services, asmx, ksoap2

我正在通过 ksoap2 通过 andriod 连接到 .asmx 网络服务，但不幸的是，网络服务接收到从 android 发送的空值！我正在连接到本地 IIS 服务器（笔记本电脑），我的服务器使用过一切都很好，因为我已经在本地机器上部署了我的服务，它没有从 android 接收参数！

```
// URL = "http://192.168.#.#/"
// NAME_SPACE = "http://192.168.#.#/cabservice.asmx";

String webResult = null;
Resources resource = this.activity.getResources();

SoapObject request = new SoapObject(resource.getString(R.string.NAMESPACE), resource.getString(R.string.METHOD_NAME_Customer));
request.addProperty("phoneID",this.phoneID);

SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);
envelope.dotNet = true;
envelope.setOutputSoapObject(request);

HttpTransportSE androidHTTPRequest = new HttpTransportSE(resource.getString(R.string.URL));
// androidHTTPRequest.setXmlVersionTag("<?xml version=\"1.0\"encoding=\"UTF-8\"?>");
androidHTTPRequest.debug = true;
try
{
    for(int i = 0; i < 3; i++){
        androidHTTPRequest.call(resource.getString(R.string.SOAP_ACTION_Customer), envelope);
        webResult = envelope.getResponse().toString();
        if(webResult != null)
            break;      
    }

}
catch (Exception e) {
    e.printStackTrace();
}
return webResult; 
```

本地服务器接收参数应该额外做什么？

# c# - 仅为一个 ASPX 页面启用会话

> ID：15665190
> 
> 赞同：0
> 
> 时间：2013-03-27T17:16:03.727
> 
> 标签：c#, visual-studio-2010, reportviewer

1.  我正在开发一个需要会话模式的应用程序：关闭。
2.  我需要创建一个本地报告，因为某些使用该应用程序的客户端无法访问报告服务器。
3.  如果不启用会话，报表查看器将无法（本地）工作。

**问题**：是否可以只为报告 ASPX 页面启用会话？我在想网络配置中可能有一个设置。也许包裹在这样的东西里面：

```
<location path="reportpage.aspx">
....
</location> 
```

**编辑**：从您的回答中可以清楚地看出它无法完成。另外，我意识到即使只有一页，我也会在使用会话时遇到问题。因为整个项目在 2 个独立的 IIS 服务器下运行，将工作负载分开，并且在会话中存在数据的风险导致它们很容易丢失。

所以我想我必须找到另一种方法来解决我的问题。

为了其他真正需要在一个页面上使用会话的人，我会接受解决这个问题的最佳答案（在我看来）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T17:30:39.787

我不认为如果您为应用程序关闭会话模式，您可以在该应用程序的单个页面上启用它。您可以将报告页面单独放在另一个应用程序中并以这种方式启用它。

我想你可以这样做的另一种方法是为应用程序保留会话状态，并在每个其他页面中使用 page 指令将其关闭：

```
<%@ Page language="c#" Codebehind="WebForm1.aspx.cs" 
AutoEventWireup="false" Inherits="WebApplication1.WebForm1" 
EnableSessionState="false" %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T17:31:06.687

我不相信你可以只为你的部分网站启用会话状态，因为它是作为模块实现的，据我所知，它没有这种精细的配置。

# c# - 清除剪贴板

> ID：15665191
> 
> 赞同：0
> 
> 时间：2013-03-27T17:16:04.000
> 
> 标签：c#, console, clipboard

我在 C# 中有以下控制台应用程序

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Timers;
using System.Windows.Forms;

namespace PreventScreenshot
{
    class Program
    {
        [STAThread]
        public static void Main(string[] args)
        {
            System.Timers.Timer timer1 = new System.Timers.Timer();
            timer1.Elapsed += new ElapsedEventHandler(timer_Tick);
            timer1.Interval = 1000;
            timer1.Enabled = true;
            timer1.Start();

            Console.WriteLine("---Prevent Screenshot from being taken---");
            Console.WriteLine();
            Console.WriteLine("DLL operation started.  Try to take a screenshot");
            Console.WriteLine();
            Console.WriteLine("Press enter to exit");
            Console.ReadLine();
        }

        public static void timer_Tick(object sender, EventArgs e)
        {
            Clipboard.Clear();
        }
    }
} 
```

假设应用程序每秒清除剪贴板。但是，它不起作用。问题是什么？

编辑：

我刚刚编辑了代码。当我尝试运行程序时，剪贴板仍未清除。怎么了？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-27T17:16:57.710

移动`Console.ReadLine()`后`timer1.Start()`

目前，您的应用程序正在等待输入，然后启动计时器并立即存在。

**关于您编辑的帖子：**

您正在使用`Timer`from `System.Windows.Forms`，它不适合控制台应用程序。尝试使用来自`System.Timers`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-27T17:19:00.490

1.  您需要在 ReadLine() 调用之前设置并启动计时器，否则您的代码将无法访问它。

2.  您的应用程序线程需要处于单线程单元 (STA) 模式。将 [STAThread] 属性应用于方法。请参阅：http: [//msdn.microsoft.com/en-us/library/system.windows.forms.clipboard.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.clipboard.aspx)

# symfony - symfony2 behat selenium 登录

> ID：15665194
> 
> 赞同：3
> 
> 时间：2013-03-27T17:16:23.413
> 
> 标签：symfony, selenium, login

我正在使用 behat 和 selenium 驱动程序测试我的 symfony2 登录，但它不能正常工作。我认为 symfony2 会话没有在 selenium 会话之间共享，这很糟糕，因为我的 selenium 会话中没有 SecurityPasswordToken :(

我必须在通过 symfony2 中的安全防火墙保护的页面上测试一些 javascript。

登录在我的测试功能中与默认驱动程序完美配合，但是当我强制此功能使用 selenium（使用“@javascript”）运行它时，它不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T18:26:27.940

当使用任何驱动程序时`symfony2`，应用程序使用的内核和 Mink 使用的内核是分开的。

您无需访问安全上下文即可测试登录是否有效。只需通过 UI 登录并测试您需要的东西。

# php - 我无法在 PHP 中获得返回值

> ID：15665199
> 
> 赞同：-3
> 
> 时间：2013-03-27T17:16:27.997
> 
> 标签：php

我无法获得返回值！输出显示为“错误”。

```
$c = new List();
$result = $c->create();

if( $result == "a"){
   echo("A");                   
}else if($result == "b"){
   echo("B");
}else{
   echo("ERROR");
}

class List{

    function create(){

       // $rVal = ...

       if($rVal == 1){
           return "a";
       }else if($rVal == 2){
           return "b";
       }
    }
} 
```

当我将返回更改为回显时，输出显示为“aERROR”。我不明白。create 函数有效，但返回值不正确。任何人都可以帮助我吗？对不起，我的英语不好

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T17:19:16.270

如果下面的代码是正确的，那么你没有设置`$rVal`. 该作业似乎已被注释掉：

```
class List{

    function create(){

       // $rVal = ...

       if($rVal == 1){
           return "a";
       }else if($rVal == 2){
           return "b";
       }
    }
} 
```

因此，调用不会返回任何内容（null）`create()`......这被解释为错误。

# sql - 如何避免 SQL 语句在您的应用程序中到处传播？

> ID：15665202
> 
> 赞同：1
> 
> 时间：2013-03-27T17:16:38.323
> 
> 标签：sql, rdbms

我有一个用 Ruby 编写的中型应用程序，它大量使用了 RDBMS。随着代码的增长，我发现丑陋的 SQL 语句正在蔓延到我的应用程序中的所有模块和方法，并嵌入到许多应用程序逻辑中。我不确定这是否不好，但是，我的直觉告诉我这很丑……

所以通常在任何语言中，你如何管理你的 SQL 语句？或者您认为让许多 SQL 语句嵌入应用程序逻辑中对可维护性有害吗？为什么或者为什么不？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T17:49:10.433

SQL 是一种用于访问数据库的语言。通常，它会被误认为是大型应用程序的数据存储中的 API。事实上，您应该在数据存储和应用程序之间设计一个真正的 API。

这意味着几件事。

要访问存储在表中的数据，您希望通过数据库中的视图，而不是直接访问表。

对于数据修改步骤，您希望将`insert`//包装在存储过程中。这有第二个好处，您可以在存储过程中处理约束和触发器，并更好地记录正在发生的事情。`update``delete`

出于安全考虑，您希望将数据库安全性作为安全架构的一部分。授予所有用户完全访问权限可能不是最好的方法。

不幸的是，编写一个直接使用数据库的简单应用程序很容易，无论是在 java 还是 ruby​​ 或 VBA 中或其他任何语言中。这成长为一个更大的应用程序，然后出现维护问题。

我建议采用增量方法来解决此问题。浏览代码并在您有讨厌的选择语句的地方创建视图。您可能会发现您需要的视图比选择的视图少得多（视图可以重复使用——这是一件好事）。

查找代码被修改的地方，并将它们更改为存储过程。我总是从存储过程中返回状态以进行错误检查，并将日志信息放入一个名为 someting like `splog`or的表中`_spcalls`。

如果您想限制应用程序的不同用户的权限，那么您可能对此[感兴趣](http://www.sommarskog.se/grantperm.html)。

将原始 SQL 语句留在代码中是一个问题。等到你想重命名一个列，你必须找到所有破坏代码的地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T17:22:00.073

是的，这不是最优的——维护变成了一场噩梦；当基础数据库更改发生时，很难预测和确定哪些代码必须更改。这就是为什么创建数据访问层 (DAL) 以封装来自应用程序逻辑的 CRUD 操作的良好做法的原因。在应用程序逻辑和 DAL 之间通常有一个业务逻辑层 (BLL) 来执行业务规则/逻辑。

谷歌“数据访问层”“业务逻辑层”甚至“n 层架构”了解更多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T17:22:05.987

如果您担心散布在应用程序逻辑周围的 SQL 语句，是否可以考虑将它们实现为存储过程？

这样，您将只在代码中包含过程名称和需要传递给它的任何参数。

它还有其他好处，一个常见的好处是更容易在多个文件中重复使用。

关于存储过程的速度和安全性有很多争论，你永远不会得到一个明确的答案，所以我什至不会打开那个蠕虫罐头。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-27T17:28:32.813

下面是使用 Java 执行此操作的方法： 创建一个封装对数据库的所有访问的类。为您需要运行的每个查询添加一个方法到类。

ruby 的答案将与此类似。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-27T17:52:39.870

这取决于应用程序的体系结构，但一个简单的解决方案是将每个 sql 保存在一个文件 qry.sql 中。对于每个 Ruby 模块（或 Ruby 中用于聚合相关代码的任何模块），您可以将这些文件保存在 SQL 文件夹中。因此，SQL 文件夹/文件的集合构成了应用程序的数据访问层。Ruby 代码提供了业务层。如果您的数据模型发生更改（字段名称等），您可以执行 greps 来识别需要更改的 sql 文件。无论如何，绝对将 SQL 与您的逻辑代码分开。

# jquery - 背景图像在 Firefox 中显示，但在 chrome 中不显示

> ID：15665204
> 
> 赞同：0
> 
> 时间：2013-03-27T17:16:42.917
> 
> 标签：jquery, image, google-chrome, firefox, background

在我的网站上，我的背景图像在 Firefox 上显示良好，但在 chrome 上，侧面有大的白色框，当 jquery 图像幻灯片移动到下一个图像时，这些框会消失。我在 CSS 中将背景图像链接到正文我的内容包括图像滑块。

**这是现场网站**

[http://wilsontsa.org/Technology%20courses/Technology%20Courses.html](http://wilsontsa.org/Technology%20courses/Technology%20Courses.html)

**HTML**

```
<body>

<div id="bar">
</div>
<center>
<div id="pagecontainer">
<div id="container">
<div id="navigation">

<ul id="navigation">
<li id="techlink" class="dropdown"><a href="../Technology courses/Technology                 Courses.html" style="color:#046f83">Technology Courses</a>
<ul class="sub_navigation">
<li><a href="../Technology courses/Computer Science.html">&nbsp;Computer &nbsp;Science</a></li>
<li><a href="../Technology courses/Digital Video.html">&nbsp;&nbsp;&nbsp;&nbsp;Digital Video&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a></li>
<li><a href="../Technology Courses/Technology Innovation.html">Technology Innovation</a></li>
<br />
<li><a href="../Technology courses/Visual Design and Image Applications.html">Visual Design and Image App.</a></li>
<br />
<li><a href="../Technology courses/Web Design.html">Web Design</a></li>
</ul>
</li>
<li id="englink" class="dropdown"><a href="../Engineering Courses/Engineering Courses.html">Engineering Courses</a>
<ul class="sub_navigation">
<li><a href="../Engineering Courses/Introduction to Engineering and Design.html">Intro to Engineering</a></li>
<br />
<li><a href="../Engineering Courses/Computer Integrated Manufacturing.html">Computer Integrated Manufact.</a></li>
<br />
<li><a href="../Engineering Courses/Principles of Engineering.html">Principles of Engineering</a></li>
<br />
<li><a href="../Engineering Courses/Digital Electronics.html">Digital Electronics</a></li>
<br />
<li><a href="../Engineering Courses/Civil Engineering and Architecture.html">Civil Engineering</a></li>
<br />
<li><a href="../Engineering Courses/Aerospace Engineering.html">Aerospace Engineering</a></li>
<br />
<li><a href="../Engineering Courses/Engineering Design and Development.html">Engineering Design</a></li>
<br />
<li><a href="../Engineering Courses/I-Stem.html">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I-STEM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a></li>
</ul>
</li>
<li id="STEMlink"><a href="../STEM/stem.html">STEM</a></li>
<li id="weblink" class="dropdown"><a href="../Webmaster/Evolution.html">Webmaster</a>
<ul class="sub_navigation">
<li><a href="../Webmaster/Evolution.html">Evolution</a></li>
<li><a href="../Webmaster/Adapting.html">Adapting</a></li>
<li><a href="../Webmaster/Advertising.html">Business Model</a></li>
<li><a href="../Webmaster/Solution.html">Future</a></li>
</ul>
</li>

<div id="tsa" class="TSA">
  <li><a href="../TSA Chapter/TSA.html"><img  src="../Images/Design Images/TSA-LOGO.png" width="50" height="34" /></a></li>
  </div>
</ul>
</div> <!--navigation div --> 

</ul>
</center>

<div id="spacer">

<div id="wrapper">
<div>
<div class="slider-button" onclick="ss.move(-1)">&laquo;</div>
<div id="slideshow">
  <ul id="slides">
    <li><img src="../Javascript Photos/Picture1.png" width="900" height="300" alt="Coral Reef"></li>
    <li><img src="../Javascript Photos/Picture2.png" width="900" height="300" alt="Sea turtle">
    </li>
    <li><img src="../Javascript Photos/Picture3.png" width="900" height="450" alt="Coral Reef"></li>
    <li><img src="../Javascript Photos/Picture4.png" width="900" height="300" alt="Blue Fish"></li>
  </ul>
  </div>
  <div class="slider-button" onclick="ss.move(1)">&raquo;</div>
  </div>
  <ol id="pagination" class="pagination">
  <li></li>
  <li></li>
  <li></li>
  <li></li>
  </ol>
 </div> 
```

**CSS**

```
body {
background-image: url(Images/Tech nology%20Images/bg_Tech.gif);} 
```

**滑块 CSS**

```
li.current {
background:#102c75;}

#slideshow {
float:left; 
width:900px; 
height:300px; 
border:2px solid #ccc; 
background:#fff;
position:relative;
top:16px;
z-index:-1;}

#slides {
position:relative; 
width:900px; 
height:300px; 
list-style:none; 
overflow:auto;
z-index:-1;}

#slides li {
width:900px; 
height:300px;}

.fader-slide {
opacity:0; 
position:absolute;}

.fader-fade {
opacity:1;
 -webkit-transition:opacity .4s; 
 -moz-transition:opacity .4s; 
 transition:opacity .4s;}

#content {
width:900px; 
height:270px; 
padding:15px 18px 15px 18px; 
background:#fff;}

#content h1 {
font:22px Georgia,Verdana; 
margin-bottom:15px; 
color:#036;}

#caption {
background:#fff; 
position:relative;}

#caption div {
position:absolute; 
bottom:0; 
left:0; 
width:900px; 
padding:15px 18px 10px 18px; 
background:#000; 
background:rgba(0,0,0,.7);}

#caption h2 {
font:18px Georgia,Verdana; 
margin-bottom:6px; 
color:#eee;}

#caption p {
line-height:1.4; 
color:#aaa;} 
```

# git - 使用 jenkins over ftp 来自 git 的公共差异文件

> ID：15665208
> 
> 赞同：0
> 
> 时间：2013-03-27T17:16:52.173
> 
> 标签：git, ftp, jenkins

我开始使用 jenkins，我正在使用它从 git 一个存储库中提取并使用 Publish over FTP 插件（[https://wiki.jenkins-ci.org/display/JENKINS/Publish+Over+ ）发布到 FTP FTP+插件](https://wiki.jenkins-ci.org/display/JENKINS/Publish+Over+FTP+Plugin)）。

问题是 REPO 正在增长很多，它有媒体文件（img，声音......），在我的配置中，它正在删除 ftp 上的所有内容，然后再次上传。

我只想发布差异文件（上次构建的更新文件），但我不知道从哪里开始。

任何人都可以指导我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-03T12:24:20.297

我终于在构建后手动启动了一个 PHP 脚本。

# php - 使用 AJAX 传递 JavaScript 数组

> ID：15665210
> 
> 赞同：1
> 
> 时间：2013-03-27T17:16:57.030
> 
> 标签：php, javascript, html, ajax, arrays

我对 ajax 很陌生，当用户单击提交按钮时，我正在尝试将我在 javascript 中创建的称为标记的数组传递给 PHP 页面。在提交时，数组存在并且在范围内。下面的代码就是试图做到这一点。当我单击提交按钮时，我被发送到 php 页面并打印“失败”（我的代码的一部分），这意味着数组未通过。我相信错误发生在 ajax 代码中，我不确定它来自哪里，非常感谢任何帮助！

javascript/ajax 的东西：

```
function submit_tour(){
    var input = JSON.stringify(markers);
    //var input = $(this).serialize();
    var sent = $.ajax({
            type: "POST",
            data: input,
            dataType: 'JSON',
            url: "test_portal2.php"
            }).done(function() {window.alert("done");})
            .fail(function() {window.alert("failed");});
    window.alert("" + input);
} 
```

应该发送数组的 HTML 按钮：

```
<form name="toursubmit" action="test_portal2.php" onsubmit="submit_tour()">
<input type="submit" value="Submit">
</form> 
```

捕获它的 PHP（在 test_portal.php 文件中）：

```
$ans = json_decode($sent);
echo $ans;
if ($ans != NULL){
    echo "works";
    echo $ans;
}
else {
    echo 'failed';
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T17:24:47.767

有几点需要指出。

首先，您需要阻止`submit_tour()`函数中的默认 POST 操作，否则会发生同步 POST。

其次，您需要在 AJAX 调用中将 contentType 值指定为`application/json`.

第三，如果您实际上是在将 JSON 发布到 PHP 并`application/json`用作 ContentType，那么您将需要通过访问原始输入来获取 PHP 中的 JSON 数据，如下所示：

```
$json = file_get_contents('php://input');
$obj = json_decode($json); 
```

这是因为`$_POST`仅针对表单编码的内容类型自动生成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T17:19:34.420

当你寄出

```
var input = JSON.stringify(markers); 
```

并且标记没有价值

```
<input type="hidden" id="markers" name="markers">     // No value anywhere 
```

那么它肯定会是 Null :)

您是否还`$sent`从 中的值填充变量`$_POST`？没有看到这种情况发生

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T17:21:23.640

您不需要在表单标签中使用它。代码正在提交表单而不是运行 JS。

删除表单标签，或者把这个：submit_tour(); 而是在表单上的 onsubmit 中，并返回 false。

# css - css浮动的问题

> ID：15665213
> 
> 赞同：-1
> 
> 时间：2013-03-27T17:16:58.870
> 
> 标签：css, animation, hyperlink, transition, floating

我对浮动有一点问题。

我需要以 20px 的边距并排显示我的链接，但它不起作用。

## CSS

```
ul li{
    float:left;
    display: inline-block;
    position:relative;
    padding:0 20px;
}
.link {
    font-family: Tahoma;
    font-size:18px;
    overflow: hidden;
    padding: 2px 0;
    position: absolute;
    cursor:pointer;
}
.link a{

    text-decoration:none;
    color:gray;
    -webkit-transition: color 0.4s ease;

}
.link span {
    position: inherit;
    left:-100%;
    bottom: 1px;
    height: 1px;
    width:100%;
    background: #fb6f5e;
    -webkit-transition:all 0.4s;
}
.link a:hover{
    color:#fb6f5e;

}
.link:hover span {
overflow:hidden;
position: inherit;
    bottom: 1px;
    left:100%;
    height: 1px;
    width:100%;
    background: #fb6f5ee;
   -webkit-transition:all 0.4s;

} 
```

## HTML

```
<ul>
<li><a href="#"><div class="link">Start</a><span></span></div></li>
<li><a href="#"><div class="link">About</a><span></span></div></li>
<li><a href="#"><div class="link">Other</a><span></span></div></li>
<li><a href="#"><div class="link">Contact</a><span></span></div></li>
</ul> 
```

[http://jsfiddle.net/SD58Z/727/](http://jsfiddle.net/SD58Z/727/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T17:22:54.577

这应该可以解决问题：

[**演示**](http://jsfiddle.net/SD58Z/738/)

您的链接设置为绝对位置，因此它位于元素流之外。这意味着所有元素都在彼此之上结束。

您还遇到了一些未关闭的 div 标签和其他 html 错误。

我在 html 中移动了一些东西以使其工作。我认为这可以优化。下划线悬停效果不起作用的原因是因为我更改了 html 结构（我认为这是您最初的意图）。

**css**

```
ul{
    padding-left:0px;
}

ul li{
    float:left;
    display: block;
    margin-left:20px;
    position:relative;
    color:inherit;
}

ul li:first-child{
    margin-left:0px;
}
.link {
    font-family: Tahoma;
    font-size:18px;
     overflow:hidden;
    cursor:pointer;
}
.link a{
    text-decoration:none;
    color:gray;
    -webkit-transition: color 0.4s ease;
    position:relative;
   overflow:hidden;
}

.link a:hover{
    color:#fb6f5e;

}

.link span {
    position: absolute;
    left:-100%;
    bottom: 1px;
    height: 1px;
    width:100%;
    background: #fb6f5e;
    -webkit-transition:all 0.4s;
}

.link:hover span {
    bottom: 1px;
    left:0%;
    height: 1px;
    width:100%;
    background: #fb6f5ee;
   -webkit-transition:all 0.4s;

} 
```

**html:**

```
<ul>
    <li>
        <div class="link">

            <a href="#">Start
                 <span></span>
            </a>
        </div>
    </li>
    <li>
        <div class="link">

            <a href="#">About
                 <span></span>
            </a>
        </div>
    </li>
    <li>
        <div class="link">

            <a href="#">Other
                 <span></span>
            </a>
        </div>
    </li>
    <li>
        <div class="link">

            <a href="#">Contact
                 <span></span>
            </a>
        </div>
    </li>
</ul> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T17:21:00.613

你有很多语法问题

1.  额外的`</div>`标签
2.  标签顺序不正确：`<a><div></a></div>`应该是`<a><div></div></a>`
3.  `<span>`CSS中背景颜色的十六进制代码不正确

您正在尝试浮动项目并绝对定位它们。选择一个或另一个。

使用这个 CSS（我删除了 2 行代码）它工作正常。

JSFIDDLE：http: [//jsfiddle.net/SD58Z/725/](http://jsfiddle.net/SD58Z/725/)

```
ul li{
    float:left;
    display: inline-block;
    padding:0 20px;
}
.link {
    font-family: Tahoma;
    font-size:18px;
    overflow: hidden;
    padding: 2px 0;
    cursor:pointer;
}
.link a{

    text-decoration:none;
    color:gray;
    -webkit-transition: color 0.4s ease;

}
.link span {
    position: inherit;
    left:-100%;
    bottom: 1px;
    height: 1px;
    width:100%;
    background: #fb6f5e;
    -webkit-transition:all 0.4s;
}
.link a:hover{
    color:#fb6f5e;

}
.link:hover span {
overflow:hidden;
position: inherit;
    bottom: 1px;
    left:100%;
    height: 1px;
    width:100%;
    background: #fb6f5ee;
   -webkit-transition:all 0.4s;

} 
```

修复 HTML：http: [//jsfiddle.net/SD58Z/732/](http://jsfiddle.net/SD58Z/732/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T17:25:40.107

我只是用你的代码玩了一分钟并修复了 HTML。似乎有一些无用的 CSS，但这会让你继续前进。

HTML

```
<ul class="nav">
    <li><div class="link"><a href="#">Start</a><span></span></div></li>
    <li><div class="link"><a href="#">About</a><span></span></div></li>
    <li><div class="link"><a href="#">Other</a><span></span></div></li>
    <li><div class="link"><a href="#">Contact</a><span></span></div></li>
</ul> 
```

CSS

```
#nav {
    width: 100%;
    display: block;
}
ul li{
    float:left;
    display: inline-block;
    padding:0 20px;
}
.link {
    font-family: Tahoma;
    font-size:18px;
    overflow: hidden;
    padding: 2px 0;
    cursor:pointer;
}
.link a{

    text-decoration:none;
    color:gray;
    -webkit-transition: color 0.4s ease;

}
.link span {
    position: inherit;
    left:-100%;
    bottom: 1px;
    height: 1px;
    width:100%;
    background: #fb6f5e;
    -webkit-transition:all 0.4s;
}
.link a:hover{
    color:#fb6f5e;

}
.link:hover span {
overflow:hidden;
position: inherit;
    bottom: 1px;
    left:100%;
    height: 1px;
    width:100%;
    background: #fb6f5ee;
   -webkit-transition:all 0.4s;

} 
```

# c++ - 对于使用 SkypeKit 的应用程序，任何 Apple 移动设备（iPod、iPhone、iPad）的视频方向都不正确

> ID：15665214
> 
> 赞同：2
> 
> 时间：2013-03-27T17:16:59.360
> 
> 标签：c++, qt, qml, skype, video-conferencing

我正在 Qt(4.8.4) 中开发一个应用程序，并使用（最新的）用于桌面的 SkypeKit 版本 4.5 及其 C++ 包装器。

我注意到，当我使用任何 Apple 移动设备（iPad、iPhone 或 iPod touch）进行视频通话时，视频方向可能是横向的或上下颠倒的。

**有没有办法检查和旋转传入的视频呼叫，以便它们的方向正确？**

否则，这可能是 skypekit 的错误吗？

要重现这一点，请尝试运行 SkypeKit 4.5 附带的 qt_videocalls 示例。登录 Skype 帐户并让某人从苹果设备呼叫您，当您旋转苹果设备时，桌面应用程序上的方向将不正确。

# python - 在python中创建一个2列表

> ID：15665216
> 
> 赞同：0
> 
> 时间：2013-03-27T17:17:04.050
> 
> 标签：python, numpy

假设我想创建一个多元二维标准正态分布。这本质上只是 2 个 1d 标准正态分布的组合。

```
m1 = rand.normal(0,1,500)
m2 = rand.normal(0,1,500) 
```

如何组合这些数组以便以简洁的方式获得 500x2 表？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T17:21:25.600

IIUC，只需传递`size`参数：

```
>>> m = np.random.normal(0, 1, size=(500, 2))
>>> m.shape
(500, 2)
>>> m.mean(axis=0)
array([-0.02394296,  0.0684164 ])
>>> m.std(axis=0)
array([ 1.04018539,  0.95281971]) 
```

[我假设你`rand`是`numpy.random`模块。]

如果要指定特定的协方差，另请参阅[random.multivariate_normal函数。](http://docs.scipy.org/doc/numpy/reference/generated/numpy.random.multivariate_normal.html)

# sql - 如何有条件地选择 Oracle 查询中的列

> ID：15665220
> 
> 赞同：8
> 
> 时间：2013-03-27T17:17:13.817
> 
> 标签：sql, oracle, select

我想做类似的事情：

```
select (if lookup = 8 then 08 else lookup) lookup
  , //more columns
from lookup_table
order by lookup 
```

不幸的是，Oracle 似乎不喜欢这种语法，我无法发现原因或找到我应该使用的其他函数。

基本上，如果lookup值为8，我想得到08，否则我想要lookup的值。我敢肯定我只是愚蠢。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-27T17:18:07.130

你想要一个案例陈述：

```
select (case when lookup = 8 then 8 else lookup end) as lookup 
```

如果`lookup`是一个字符串，你可能想要：

```
select (case when lookup = '08' then '08' else lookup end) as lookup 
```

如果`lookup`是一个整数，并且您想将其转换为字符串，则：

```
select (case when lookup = 8 then to_char(lookup, '00') else to_char(lookup, '00') end) as lookup 
```

但是，这对我来说似乎是多余的。

# python - 使用 for 循环创建一系列元组

> ID：15665222
> 
> 赞同：4
> 
> 时间：2013-03-27T17:17:15.177
> 
> 标签：python, for-loop, tuples

尽管我确定它已经存在，但我已经搜索并找不到答案。我对 python 很陌生，但我以前用其他语言做过这种事情，我正在读取一个数据文件的行格式，我想将每一行数据存储在它自己的元组中，以便在 for 循环之外访问。

```
tup(i) = inLine 
```

哪里`inLine`是文件中的行，`tup(i)`它是存储在其中的元组。`i`随着循环的进行而增加。然后我可以使用类似的东西打印任何行

```
print tup(100) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T17:42:38.423

如您在循环中描述的那样创建元组并不是一个好的选择，因为它们是不可变的。

这意味着每次向元组添加新行时，您实际上是在创建一个与旧元组具有相同值的新元组，以及您的新行。这是低效的，通常应该避免。

如果您只需要按索引引用行，则可以使用列表：

```
lines = []
for line in inFile:
    lines.append(line)

print lines[3] 
```

如果你真的需要一个元组，你可以在完成后转换它：

```
lines = tuple(lines) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T17:45:12.923

Python File Object 支持一种名为[file.readlines([sizehint])](http://docs.python.org/2/library/stdtypes.html#file.readlines)的方法，该方法读取整个文件内容并将其存储为列表。

或者，您可以通过元组传递文件迭代器对象以创建行元组并以您想要的方式对其进行索引

```
#This will create a tuple of file lines
with open("yourfile") as fin:
    tup = tuple(fin)

#This is a straight forward way to create a list of file lines
with open("yourfile") as fin:
    tup = fin.readlines() 
```

# html - IE10 下拉 CSS 不工作

> ID：15665225
> 
> 赞同：1
> 
> 时间：2013-03-27T17:17:22.797
> 
> 标签：html, css, internet-explorer, drop-down-menu

我有一个通过 CSS 悬停激活的下拉菜单。但是 IE 没有执行悬停命令。我尝试将下拉菜单设置为不悬停出现，这很有效，但是`:hover`li 上没有任何作用。

HTML：

```
 <div id="pilatesNav">
                <ul>
                    <li id="first" class="first mainNav"><a href="studio"><p>Studio</p></a>
                        <ul>
                            <li><a href="etiquette"><p>Etiquette</p></a></li>
                        </ul>
                    </li>
                    <li class="mainNav"><a href="about"><p>About</p></a>
                        <ul>
                            <li><a href="instructors"><p>Instructors</p></a></li>
                            <li><a href="testimonials"><p>Testimonials</p></a></li>
                            <li><a href="community"><p>Community</p></a></li>
                        </ul>
                    </li>
                    <li class="mainNav"><a href="classes"><p>Classes</p></a></li>
                    <li class="mainNav"><a href="beginners"><p>Beginners</p></a></li>
                    <li class="mainNav"><a href="schedule"><p>Schedule</p></a></li>
                    <li class="mainNav"><a href="videos"><p>Videos</p></a></li>
                    <li class="last mainNav"><a href="contact"><p>Contact</p></a></li>
                    <div class="clear"></div>
                </ul>
            </div> 
```

CSS

```
#pilatesNav{
        width: 100%;
        margin-bottom: 10px;
        overflow: visible;

        ul{
            list-style-type: none;
            overflow: visible;

            li{
                position: relative;
                text-align: center;
                z-index: 2;
                float: left;
                margin-right:85px;
                overflow: visible;

                a{
                    display: block;
                    color: #666;

                    &:hover{
                        color: lighten(@bg, 20%); 
                    }
                }
                ul{
                    position: absolute;
                    left: -9999px;
                    width: 137px;
                    text-align: center;
                    list-style-type: none;
                    background-color: @bg;
                    border-left: 1px solid darken(@bg, 10%);
                    border-right: 1px solid darken(@bg, 10%);
                    border-bottom: 1px solid darken(@bg, 10%);
                    .drop-shadow(0px, 6px, 5px, -7px, #111, 50%);

                    li{
                        display: block;
                        a{
                            display: block;
                        }
                        width: 100%;
                        padding: 5px 0px;
                        &:hover{
                            a{
                                color: lighten(@bg, 20%);
                            }
                            &:before{
                                width: 0;
                                height: 0;
                            }
                            .gradient(@bg, darken(@bg, 6%), @bg);
                        }
                    }
                }
                &:hover{
                    &:before{
                        position: absolute;
                        left: -15px;
                        content: '';
                        height: 25px;
                        width: 5px;
                        background-color: transparent;
                        border-left: 1px solid darken(@bg, 10%);
                    }
                    ul{
                        left: -15px;
                    }
                }
                &.first{
                    text-align: left;
                }
                &.last{
                    margin-right: 0px;
                    text-align: right;
                }
            }
        }
    }//End Nav 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T18:02:02.387

检查您的文档类型声明。

我在一个在 IE9 中工作但在 IE10 中没有的网站遇到了麻烦，必须更改为标准`<DOCTYPE !html>`此外，为了安全起见，确认您的所有 doctype 声明都是正确的并且没有重复。

# r - R中的错误消息：“方法（）的参数必须命名，或者一个命名列表”

> ID：15665227
> 
> 赞同：0
> 
> 时间：2013-03-27T17:17:24.733
> 
> 标签：r, class, methods, reference-class

我是在 R 中创建类和方法的新手，并且遇到了一个我没有找到太多文档的问题。我创建了一个类“DataImport”，并尝试添加以下方法：

```
DataImport$methods(reducedImport <- function(filePathOne, dataFrame) 
  {

  }
) 
```

当我运行此代码时，我收到以下错误：

```
Error in DataImport$methods(reducedImport <- function(filePathOne,  : 
  Arguments to methods() must be named, or one named list 
```

我可以直接在这个方法之前添加一个方法，它工作得很好，但是这个没有。我不太明白为什么会这样或如何解决它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T07:39:42.197

正如 Dason 在评论中提到的，您的问题在于分配。让我们创建一个简单的示例：

```
c1 = setRefClass("c1", fields = list( data = "numeric"))
c1$methods(m1 = function(a) a) 
```

现在快速测试：

```
x = c1$new(data=10)
x$m1(1) 
```

然而，

```
R> c1$methods(m2 <- function(a) a)
Error in c1$methods(m2 <- function(a) a) : 
  Arguments to methods() must be named, or one named list 
```

给出你看到的错误。这样做的原因是`<-`运营商与运营商[略有不同](https://stackoverflow.com/questions/1741820/assignment-operators-in-r-and)`=`。这通常无关紧要（但在这里确实如此）。

# javascript - 在窗口事件上运行 Jquery 函数：加载、调整大小和滚动？

> ID：15665231
> 
> 赞同：22
> 
> 时间：2013-03-27T17:17:39.547
> 
> 标签：javascript, jquery, html

如何在窗口事件上运行 jquery 函数：加载、调整大小和滚动？

这是我的代码，我试图检测一个 div 是否可见，然后它是否正在运行一些 ajax 代码......

* * *

```
<script>
function topInViewport(element) {
    return $(element).offset().top >= $(window).scrollTop() && $(element).offset().top          <= $(window).scrollTop() + $(window).height();
 }

 </script>

<script>
topInViewport($("#mydivname"))
{
// ajax code goes here
} 
```

* * *

## 回答 #1

> 赞同：116
> 
> 时间：2013-03-27T17:20:18.353

您可以使用以下内容。它们都将`window`对象包装成一个 jQuery 对象。

[加载：](http://api.jquery.com/load-event/)

```
$(window).load(function () {
    topInViewport($("#mydivname"))
}); 
```

[调整大小：](http://api.jquery.com/resize/)

```
$(window).resize(function () {
   topInViewport($("#mydivname"))
}); 
```

[滚动](http://api.jquery.com/scroll/)

```
$(window).scroll(function () {
    topInViewport($("#mydivname"))
}); 
```

或使用以下方式绑定到它们[`on`](http://api.jquery.com/on/)：

```
$(window).on("load resize scroll",function(e){
    topInViewport($("#mydivname"))
}); 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2013-03-27T17:21:51.547

您可以将侦听器绑定到一个常用功能 -

```
$(window).bind("load resize scroll",function(e){
  // do stuff
}); 
```

或者另一种方式——

```
$(window).bind({
     load:function(){

     },
     resize:function(){

     },
     scroll:function(){

    }
}); 
```

或者，`.bind()`您可以使用`.on()`as bind 直接映射到`on()`. 也许`.bind()`在未来的 jquery 版本中不会出现。

```
$(window).on({
     load:function(){

     },
     resize:function(){

     },
     scroll:function(){

    }
}); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-27T17:21:15.890

只需在事件中调用您的函数。

加载：

```
$(document).ready(function(){  // or  $(window).load(function(){
    topInViewport($(mydivname));
}); 
```

调整大小：

```
$(window).resize(function () {
    topInViewport($(mydivname));
}); 
```

滚动：

```
$(window).scroll(function () {
    topInViewport($(mydivname));
}); 
```

或在一个函数中绑定所有事件

```
$(window).on("load scroll resize",function(e){ 
```

# ios - b2PrismaticJoint 位置不适合地面

> ID：15665232
> 
> 赞同：0
> 
> 时间：2013-03-27T17:17:53.647
> 
> 标签：ios, cocos2d-iphone, retina-display, box2d-iphone

大家好，我正在使用 cocos2d v1 开发游戏，并且正在使用 box2d。我正在启用视网膜显示。我正在创建一个桶。我只想在 x 轴上移动我的桶，所以我做了一个 b2PrismaticJoint 但问题是桶不适合地面。这是我的代码：`CCSprite *tube = [CCSprite spriteWithFile:@"tube.png"]; tube.position = ccp(SCREEN_WIDTH/2, SCREEN_HEIGHT/2); [自我添加孩子：管]；

```
b2BodyDef bucketBodyDef;
bucketBodyDef.type = b2_dynamicBody;
bucketBodyDef.position.Set(tube.contentSize.width/PTM_RATIO, tube.contentSize.height/PTM_RATIO);
bucketBodyDef.userData = tube;
tubeBody = world->CreateBody(&bucketBodyDef);

b2PolygonShape bucketShape;
bucketShape.SetAsBox(tube.contentSize.width/2/PTM_RATIO, tube.contentSize.height/2/PTM_RATIO);

// Create shape definition and add to body
b2FixtureDef bucketShapeDef;
bucketShapeDef.shape = &bucketShape;
bucketShapeDef.density = 10.0f;
bucketShapeDef.friction = 0.4f;
tubeFixture = tubeBody->CreateFixture(&bucketShapeDef);

[self createTubeFixtures];

// Restrict bucket along the x axis
b2PrismaticJointDef jointDef;
b2Vec2 worldAxis(1.0f, 0.0f);
jointDef.collideConnected = true;
jointDef.Initialize(tubeBody, groundBody,
                    tubeBody->GetWorldCenter(), worldAxis); 
world->CreateJoint(&jointDef);` 
```

当我卸下接头时，一切都很好……请参见附图。谢谢！

![带接头](../Images/ed7d0edbb32d54a25cff363aa197daf0.png)

![无接头](../Images/5f55bf4ff2f789ecd2717c3bb43187d0.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T20:33:50.170

我犯了一个小错误，花了我两天时间！！那是设置身体的坐标：`b2BodyDef bucketBodyDef; bucketBodyDef.type = b2_dynamicBody; **bucketBodyDef.position.Set(tube.contentSize.width/2/PTM_RATIO, tube.contentSize.height/2/PTM_RATIO);** bucketBodyDef.userData = tube; tubeBody = world->CreateBody(&bucketBodyDef);`

# z3 - 在 Z3py 中检索匹配的模型？

> ID：15665235
> 
> 赞同：0
> 
> 时间：2013-03-27T17:18:04.993
> 
> 标签：z3, smt, constraint-programming

在以下工作示例中，如何检索匹配的模型？

```
 S,   (cl_3,cl_39,cl_11, me_32,m_59,m_81) = 
     EnumSort('S', ['cl_3','cl_39','cl_11','me_32','me_59','me_81'])

       h1, h2 = Consts('h1 h2', S)
       def fun(h1 , h2):

        conds = [
        (cl_3, me_32),
        (cl_39, me_59),
        (cl_11, me_81),
         # ...
             ]

    and_conds = (And(h1==a, h2==b) for a,b in conds)
     return Or(*and_conds) 
```

例如：作为以下求解器

```
 s = Solver()
  x1 = Const('x1', S)
  x2 = Const('x2', S)
  s.add(fun(x1,x2)) 

  print s.check()
  print s.model() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T17:43:44.097

我假设您想要Z3 生成的模型中的`x1`和的值。`x2`如果是这种情况，您可以使用以下方法检索它们：

```
 m = s.model()
   print m[x1]
   print m[x2] 
```

这是完整的示例（也可[在此处](http://rise4fun.com/Z3Py/ePKW)在线获得）。顺便说一句，请注意我们不需要`h1, h2 = Consts('h1 h2', S)`.

```
S, (cl_3, cl_39, cl_11, me_32, me_59, me_81) = 
      EnumSort('S', ['cl_3','cl_39','cl_11','me_32','me_59','me_81'])
def fun(h1 , h2):
   conds = [
     (cl_3, me_32),
     (cl_39, me_59),
     (cl_11, me_81),
   ]
   and_conds = (And(h1==a, h2==b) for a,b in conds)
   return Or(*and_conds)

s = Solver()
x1 = Const('x1', S)
x2 = Const('x2', S)
s.add(fun(x1,x2)) 
print s.check()
m = s.model()
print m
print m[x1]
print m[x2] 
```

# ios - UIModalPresentationCurrentContext 和 willRotateToInterfaceOrientation

> ID：15665245
> 
> 赞同：3
> 
> 时间：2013-03-27T17:18:33.617
> 
> 标签：ios, uiviewcontroller, uiinterfaceorientation, autorotate

我的主视图控制器上有一个模态视图控制器（我们称之为弹出视图控制器）。在某些时候，我需要看到弹出窗口后面的主视图控制器。因此，我 在显示弹出视图控制器之前将`modalPresentationStyle`属性设置为。`UIModalPresentationCurrentContext`

所以发生的情况是，当设备方向发生变化而弹出视图控制器以模态方式呈现时，不会调用`willRotateToInterfaceOrientation:`and`didRotateFromInterfaceOrientation:`方法。`supportedInterfaceOrientations`被称为 amd 返回好的值。旋转已启用，支持的方向已正确设置。如果我将 'modalPresentationStyle' 更改为默认值，弹出 conIt 实际上会起作用，一切正常，除了显然我没有看到后面的主视图控制器。

我应该补充一点，主视图控制器只支持肖像，而它上面的弹出窗口支持所有方向。

在 iOS 5.1 设备上，正确调用了`willRotate`和`didRotate`方法。只有在 iOS 6 设备上它们才不是。

是否有人遇到过类似的问题或已经需要在单个方向视图控制器上方模态显示透明的多方向视图控制器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-15T09:42:40.160

做这个...

```
- (BOOL)shouldAutorotateToInterfaceOrientation: (UIInterfaceOrientation) interfaceOrientation {
    UIDevice* thisDevice = [UIDevice currentDevice];
    if (thisDevice.userInterfaceIdiom == UIUserInterfaceIdiomPad)
    {
        return true;
    }
    else
    {
        return interfaceOrientation == UIDeviceOrientationLandscapeLeft;
    }
} 
```

# php - 如何修改短代码中的页面标题？

> ID：15665247
> 
> 赞同：2
> 
> 时间：2013-03-27T17:18:38.257
> 
> 标签：php, wordpress, shortcode

如何修改短代码中特定页面的页面标题？

以下将更改标题，但它会为每一页执行。我需要更多地控制它的执行位置。

```
function assignPageTitle(){
  return "Title goes here";
}
add_filter('wp_title', 'assignPageTitle'); 
```

有没有办法在简码函数中调用上述内容？我知道如何使用 do_shortcode() 但上面是一个过滤器。

我的目标是根据 URL 参数修改页面标题。这只发生在特定页面上。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2018-12-03T19:17:07.653

尽管 WordPress 短代码不是为此而设计的，但它可以做到。问题是在发送头部之后处理短代码，因此解决方案是在发送头部之前处理短代码。

```
add_filter( 'pre_get_document_title', function( $title ) {
    global $post;
    if ( ! $post || ! $post->post_content ) {
        return $title;
    }
    if ( preg_match( '#\[mc_set_title.*\]#', $post->post_content, $matches ) !== 1 ) {
        return '';
    }
    return do_shortcode( $matches[0] );
} );

add_shortcode( 'mc_set_title', function( $atts ) {
    if ( ! doing_filter( 'pre_get_document_title' ) ) {
        # just remove the shortcode from post content in normal shortcode processing
        return '';
    }
    # in filter 'pre_get_document_title' - you can use $atts and global $post to compute the title
    return 'MC TITLE';
} ); 
```

关键点是当过滤器 'pre_get_document_title' 完成时，全局 $post 对象被设置并且 $post->post_content 可用。所以，你现在可以找到这篇文章的简码。

通常调用短代码时，它会将自身替换为空字符串，因此对 post_content 没有影响。但是，当从过滤器“pre_get_document_title”调用时，它可以根据其参数 $atts 和全局 $post 计算标题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-27T17:23:51.287

取自[WordPress Codex](http://codex.wordpress.org/Shortcode_API)

> WordPress 2.5 中引入了 Shortcode API，这是一组用于创建用于发布内容的宏代码的简单函数。

这表明您无法使用简码控制页面标题，因为简码在帖子内容中运行，此时标题标签已经呈现，然后为时已晚。

你到底想做什么？使用[Yoast SEO 插件](http://yoast.com/wordpress/seo/)，您可以在每个帖子中设置帖子和页面标题，如果这是您想要做的？

您可以根据您的 URL 参数创建自定义插件，如下所示：

```
function assignPageTitle(){

if( $_GET['query'] == 'something' ) { return 'something'; }

elseif( $_GET['query'] == 'something-else' ) { return 'something-else'; }

else { return "Default Title"; }

}

add_filter('wp_title', 'assignPageTitle'); 
```

# javascript - 如何强制输入路由参数？

> ID：15665248
> 
> 赞同：0
> 
> 时间：2013-03-27T17:18:44.467
> 
> 标签：javascript, model-view-controller, ember.js, javascript-framework

我已经设置了以下路径：

```
this.resource('areaManagement',    { path: '/management/areas' }, function() {
  this.route('assign',    { path: '/assign' });
  this.route('new',       { path: '/new' });
  this.route('subdivide', { path: '/:id' });
}); 
```

如果你想创建一个新的区域，你会去`/management/areas/new`，但在测试中，我不小心去了`/management/areas/create`，发现没有抛出错误。然后我意识到，这条路径是匹配`subdivide`动态段的。

如果这是动态细分的工作方式，那么从技术上讲，`/management/areas/anythingyouwant`这将是一条有效/公认的路径。如果不是整数，我总是可以实现一个`model()`钩子和重定向/错误，但是**有没有办法让路由器强制执行这个？**`:id`

 *** * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T09:54:27.507

我认为一个“简单”的解决方法是通过添加一个新的嵌套级别

```
path: '/id' 
```

有一个像

```
/management/areas/id/1 
```

不一定理想但会在这里帮助你。**

# perl - HMAC SHA512 输出在 Perl 中有所不同

> ID：15665251
> 
> 赞同：0
> 
> 时间：2013-03-27T17:18:52.917
> 
> 标签：perl, hmac, sha512

我观察到每次执行脚本时，给定数据和密钥的 HMAC SHA512 输出都会发生变化。

首先，我举一个输出不变的脚本示例：

```
#! /usr/bin/perl

use Digest::SHA qw(hmac_sha512_hex);
use warnings;

$data="test";
$key="20202020";

print hmac_sha512_hex($data,$key),"\n"; 
```

我运行此脚本两次并获得相同的输出：

```
perl test.pl
457a1ff378f11880defaa91675de4633d1f1e69712b5dccd2f86612224b825b4461a9215a37cce53
8e7f5de43a6900867667b9361af38df32fc58e54d7ce9a02

perl test.pl
457a1ff378f11880defaa91675de4633d1f1e69712b5dccd2f86612224b825b4461a9215a37cce53
8e7f5de43a6900867667b9361af38df32fc58e54d7ce9a02 
```

现在我修改脚本中的数据变量如下：

```
#! /usr/bin/perl

use Digest::SHA qw(hmac_sha512_hex);
use warnings;

$data={'method' => 'test', 'value' => 21};
$key="20202020";

print hmac_sha512_hex($data,$key),"\n"; 
```

现在每次运行脚本时输出都不同：

```
perl test.pl
cb1a40ba7a7f52da39dc0a3f130399dfbecb5249946057fd19887b72a58701f28452f6e663153bb6
85a4b86f9d427de4af5904801e11cb6fcbc272344605c2a9

perl test.pl
73dd1678a4e7f29f8032a65cbe979248b3e41cd6ed7aa81e5b214b8b6232af1e7a6683412b8532b7
187313d2c2a96c7e5009a9362690f355028b56ca319825e4 
```

我该如何纠正？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T17:30:13.037

您传入的数据`hmac_sha512_hex`被解释为字符串。您将它作为对哈希的引用传递。`$data`您可以通过在将其传递给函数之前打印的值来验证这一点。

您的参考只是您的哈希的唯一标识符。Perl 不保证在程序的不同运行中您将获得相同数据的相同哈希引用。因此，您传递不同的值`hmac_sha512_hex`显然会给您不同的输出。

如果您希望您的输出相同，那么您需要找到一种方法来每次将*相同的字符串传递给函数。*一种简单的方法可能是使用从[Data::Dumper](https://metacpan.org/module/Data%3a%3aDumper)的 Dumper 函数返回的字符串。

**更新：**如果您使用 Data::Dumper，那么您需要设置`$Data::Dumper::Sortkeys`为真值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T17:29:24.997

当您将 $data 传递给 hmac_sha512_hex 函数时，您正在传递变量的地址，每次运行程序时该变量都会改变。您将不得不考虑以一致的方式将哈希序列化为字符串。

# django - django unicode 网址

> ID：15665254
> 
> 赞同：0
> 
> 时间：2013-03-27T17:19:02.920
> 
> 标签：django, dreamhost

**部署时（Django + Dreamhost +passenger_wsgi）**

在我的 urls.py 中：

```
url(ur'^(?P<url>.+)/$', 'alp.news.views.blog_dispatcher', name='blog_dispatcher'), 
```

链接：

```
domain.name/%D0%98%D0%BD%D1%84%D0%B02/ 
```

导致（看起来像重定向）：

```
domain.name/%25d0%2598%25d0%25bd%25d1%2584%25d0%25b02/ 
```

所以，我认为“url”变量=“%25d0%2598%25d0%25bd%25d1%2584%25d0%25b02”

**本地（或使用开发服务器）**

当我使用 runserver 命令时，即使在部署时，它也运行良好。当然，我可以使用 urllib 并在我的视图中取消引用 url，但 url 中的字符串仍在转换 '%' -> '%25'。不知道，魔术从哪里开始：在乘客或 wsgi 应用程序中可能有人可以清理...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:53:58.117

神奇的是dreamhost的301重定向，它双引号的路径

# android - GoogleAuthUtil 无法解析

> ID：15665255
> 
> 赞同：2
> 
> 时间：2013-03-27T17:19:11.340
> 
> 标签：android, google-play-services, google-authentication

我在我的 Android 应用程序中使用 Google Play 服务的授权和 GoogleAuthUtil。我大约 2 个月前做了这部分，从那以后它一直工作得很好。昨天，我更新了 SDK。现在我在我的应用程序中遇到了这个错误。它说“无法解析 GoogleAuthUtil”。
更新后的 SDK 有什么变化吗？
我该如何解决这个问题？

我正在导入以下内容：

```
import com.google.android.gms.auth.GoogleAuthException;
import com.google.android.gms.auth.GoogleAuthUtil;
import com.google.android.gms.auth.GooglePlayServicesAvailabilityException;
import com.google.android.gms.auth.UserRecoverableAuthException. 
```

我正进入（状态

> com.google.android.gms.auth 无法解析。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-27T18:00:17.550

每当您更新任何库时，请确保首先将其从您的参考文献中删除，然后再次将其添加到您的参考文献中。之后清理项目。如果需要，重新启动 Eclipse。我觉得你很高兴！:)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-03T15:39:24.073

只需`<uses-library>`从您的 AndroidManifest.xml 中删除标签，然后重新启动并清理所有内容。肯定会开始运行。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-01-08T17:10:05.797

如果您使用的是 Android Studio，请按照以下步骤操作。

1.  打开`SDK Manager`-> `SDK Tool`-> 点击`Google Play`服务并应用
2.  打开`Module Setting`或`Project Structure`-> 在`Dependencies`选项卡上单击`+`按钮 -> 选择`1.Library Dependency`-> 选择`play-services (...)`然后单击确定
3.  `Build`通过->清理你的项目`Clean Project`

# sql - SQL Server select where sql_variant equal 不起作用？

> ID：15665257
> 
> 赞同：3
> 
> 时间：2013-03-27T17:19:17.720
> 
> 标签：sql, sql-server, sql-server-2008

我正在使用 SQL Server 2008

我有一个名为`varEnteredValue`datatype的列`sql_Variant`。

当我执行以下选择语句时，我什么也没得到

```
SELECT * FROM tblname WHERE varEnteredValue = 1 
```

*请注意*，我在此列中有许多值为 1 的值

**问题**

我该如何解决这个问题？我需要转换数据类型吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-27T17:22:39.250

这里有两个问题：

1.  您需要将值从 转换`SQL_VARIANT`为`INT`。
2.  您需要注意转换值的方式，因为并非列中的每个值都必须转换为`INT`，而且很难预测 SQL Server 是先过滤还是先尝试转换。您需要先测试该值是否为数字，为此，您必须将其显式转换为字符串。

这是一个解决这两个问题的示例：

```
WHERE CASE WHEN ISNUMERIC(CONVERT(VARCHAR(32), varEnteredValue)) = 1 
  THEN CONVERT(FLOAT, varEnteredValue) ELSE 0 END = 1; 
```

你为什么用`SQL_VARIANT`？

# css - 加载了错误的 CSS 文件

> ID：15665265
> 
> 赞同：1
> 
> 时间：2013-03-27T17:19:39.543
> 
> 标签：css, twitter-bootstrap, responsive-design

我试图了解为什么我的页面在使用台式电脑时加载了错误的 css 文件。

这是我的代码：

```
<link href="<?php echo base_url('assets/css/bootstrap.css')?>" rel="stylesheet">
<link rel="stylesheet" type="text/css" media="screen and (max-width: 480px)" href="<?php echo base_url('assets/css/rh-mobile.css')?>" />
<link rel="stylesheet" type="text/css" media="screen and (min-width: 481px) and (max-width: 767px)" href="<?php echo base_url('assets/css/rh-tablet.css')?>" />
<link rel="stylesheet" type="text/css" media="screen and (min-width: 768px) and (max-width: 3000px)" href="<?php echo base_url('assets/css/rh.css')?>" /> 
```

当我检查 Firefox 的 Web 控制台时，我可以看到我收到了一堆错误消息，例如：

```
[11:54:09.149] Error in parsing value for 'font-weight'.  Declaration dropped. @ https://myserver/myapp/assets/css/rh-mobile.css:13

[11:54:09.150] Unknown property '-moz-border-radius'.  Declaration dropped. @ https://myserver/myapp/assets/css/rh-mobile.css:22

[11:54:09.150] Error in parsing value for 'background-image'. Declaration dropped. @ https://myserver/myapp/assets/css/rh-mobile.css:74

[11:54:09.150] Unknown property '-moz-box-shadow'.  Declaration dropped. @ https://myserver/myapp/assets/css/rh-mobile.css:170 
```

我没想到它会尝试使用移动 CSS。我的桌面屏幕分辨率是 1920 X 1200。

你能告诉我为什么 rh-mobile.css 被加载/我哪里出错了吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T02:34:06.503

虽然直觉上你可能认为浏览器只会下载他们需要的 CSS 文件，但似乎大多数浏览器会吸收所有的 CSS 文件，然后根据视口应用相关的样式。[此页面](http://www.igvita.com/2012/06/14/debunking-responsive-css-performance-myths/)上的评论提供了更多技术背景。

不过，也许这是有道理的。另一种方法是，每次更改窗口宽度时，浏览器都必须返回并检查头部内容，看看它是否应该下载不同的 CSS 文件。

因此，即使您看到正在下载 rh-mobile.css 样式表，但从您发布的内容来看，我看不出它的样式实际上会被应用。

如果您确实需要完全控制正在加载的 CSS 文件，可以使用[Adapt.js](http://adapt.960.gs)或[YepNope](http://yepnopejs.com)或[Modernizr](http://modernizr.com)等选项。它们都是在指定 CSS、JS 或其他文件的详细信息之前使用 javascript 测试视点宽度的相同想法的变体。

祝你好运！

# c++ - 创建多线程服务器的问题

> ID：15665266
> 
> 赞同：0
> 
> 时间：2013-03-27T16:49:25.617
> 
> 标签：c++, c

我正在尝试创建一个多客户端服务器，并且我设法保护服务器和单个客户端之间的信息交换，但现在我必须使用线程，以便多个客户端可以同时与服务器连接.

我按照互联网上的说明进行操作，但出现错误

> ' `CreateThread`': 无法将参数 3 从 ' `unsigned long (void *)`' 转换为 ' `unsigned long (__stdcall *) (void *)`'

你会看到在这个函数中，我返回 0，因为我不知道返回什么。

这是我的代码：

```
#include"serveur.h"

server::server(int p)
{
port = p;

}

int server::init()
{    
WORD wVersionRequested;
WSADATA  Data;
int error= (WSAStartup(MAKEWORD(2,2), &Data ));

if(error != 0 )
{
    cerr <<"WSAStartup a échoué "<< endl;
    return 1;
}
else
{
        ServerAddr.sin_family = AF_INET;
        ServerAddr.sin_port = htons( port );   

        ServerAddr.sin_addr.s_addr=htons(INADDR_ANY) ;  
}

cout <<"server correctement initialise" << endl;    
return 0;   
}

DWORD WINAPI server::ClientThread(void * p)
{

    struct thread_param *Obj = (struct thread_param      *) p ;
    server *s = Obj->ser;       

    cout << "thread client start" << endl;

char buffer[100];
        //**** sent ****

            strcpy(buffer, "coucou \n");
            send(Obj->soc, buffer,strlen(buffer), 0);
            cout<<"message envoye"<<endl;

    int reponse = 0;    
        do
        {
        //  cout<<"******** reception ...********"<<endl;
            reponse = recv(Obj->soc, buffer, sizeof(buffer), 0);
            cout<<"reponse"<<reponse<<endl;
            buffer[reponse]='\0';
            cout<<"msg recu "<<buffer<<endl;

        }while(reponse=0);

return 0;
}

int server::start ()
{
SOCKADDR_IN             ClientAddr;
int                     ClientAddrLen;
HANDLE                  hProcessThread;

struct thread_param     p;

    ListeningSocket = socket(AF_INET, SOCK_STREAM, 0);

    if(ListeningSocket == INVALID_SOCKET)
    {
        perror("socket()");
        exit(-1);
    }
        cout <<"socket correctement creee" << endl;  
if( bind( ListeningSocket, (SOCKADDR *)&ServerAddr, sizeof( ServerAddr ) ) == SOCKET_ERROR )
    {
    cerr<<"bind a echoue avec l'erreur "<< WSAGetLastError()<< endl;
    cerr<<"Le port est peut-être deja utilise par un autre processus "<< endl;

        return 1;
    } 
            cerr<<"Bind... "<< endl;
    if( listen( ListeningSocket, 5 ) == SOCKET_ERROR )
    {
        cerr<<"listen a échoué avec l'erreur "<< WSAGetLastError()<< endl;

        return 1;
    } 

        cout <<"serveur demarre : a l ecoute du port "<<port<< endl; 
        running = true;
        ClientAddrLen = sizeof( ClientAddr );
    while(running)
    {   

if(Newconnection = accept(ListeningSocket, (struct sockaddr *)&ClientAddr, &ClientAddrLen) == INVALID_SOCKET)
        {

     cout<<"accept a echoue avec l erreur "<< WSAGetLastError() << endl;

            return 1;
        }
            p.ser=this;
            p.soc=Newconnection;
            cout<<"client connecte..."<<endl;
        hProcessThread = CreateThread(NULL, 0,ClientThread, &p,0,NULL);

        if ( hProcessThread == NULL )
        {                       
    cerr <<"CreateThread a échoué avec l'erreur "<<GetLastError()<< endl;
        }

    }

    closesocket( ListeningSocket );
            WSACleanup();
return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T17:22:52.400

您将无法将成员函数作为函数指针传递给这样的 c 风格函数。您可以使用一个静态函数，该函数接受一个指向`this`然后强制转换对象并从静态函数中调用您的成员函数。或者，更好的是，使用[std::thread。](http://msdn.microsoft.com/en-us/magazine/hh852594.aspx)

# vba - 传入邮件的 Outlook VBA 脚本

> ID：15665269
> 
> 赞同：1
> 
> 时间：2013-03-27T17:20:03.753
> 
> 标签：vba, outlook

我试图制作一个脚本来接收电子邮件，重新格式化它们，然后转发到正文中的电子邮件，但我不知道如何阅读电子邮件正文。我目前有：

```
Sub Confirmation()
myMessage = "You recently made a request on the IT website, the details of your
request can be seen below:" & vbCr & vbCr & "Thank you, " & vbCr & "IT Support"

Dim itmOld As MailItem, itmNew As MailItem

Set itmOld = ActiveInspector.CurrentItem
Set itmNew = itmOld.Forward

itmNew.Body = myMessage & vbCr & vbCr & itmOld.Body
itmNew.Subject = "IT Web Request Confirmation"
itmNew.Display

Set itmOld = Nothing
Set itmNew = Nothing
End Sub 
```

这将打开电子邮件，向其中添加一些文本并将其转发。

我希望脚本打开电子邮件，从正文中读取电子邮件地址，将其用作收件人字段并将现有电子邮件重新格式化为更好的格式。这是电子邮件中的 HTML：

```
<html><body><br /><br /><table><tr><td><b>Fullname: </b></td><td>Alex Carter</td></tr><tr><td><b>OPS_Access: </b></td><td>Yes</td></tr><tr><td><b>Email_Account_Required: </b></td><td>Yes</td></tr><tr><td><b>Office_Email_Required: </b></td><td>Yes</td></tr><tr><td><b>Website_Access_Required: </b></td><td>Yes</td></tr><tr><td><b>Web_Access_Level: </b></td><td>Staff</td></tr><tr><td><b>Forum_Access_Required: </b></td><td>Yes</td></tr><tr><td><b>Date_Account_Required: </b></td><td>03/08/2013</td></tr><tr><td><b>Requested_By: </b></td><td>Alex Carter</td></tr><tr><td><b>Requestee_Email: </b></td><td>alex.carter@cars.co.uk</td></tr><tr><td><b>Office_Requesting: </b></td><td>Swindon</td></tr></table></body></html> 
```

这表明进入 to 字段的电子邮件位于表格的第 10 行，但我不太确定如何从正文中选择它？我将如何阅读正文，重新格式化，然后选择被请求者的电子邮件并将其用作收件人字段？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T05:16:14.893

这应该可以帮助您入门（修改代码），但您必须更具体地说明您希望看到的格式改进......：

```
Sub Confirmation()
    myMessage = "You recently made a request on the IT website, the details of your request can be seen below:" & vbCr & vbCr & "Thank you, " & vbCr & "IT Support"
    Dim sAddress As String ' Well need this to store the address
    Dim itmOld As MailItem, itmNew As MailItem

    Set itmOld = ActiveInspector.CurrentItem
    Set itmNew = itmOld.Forward

    sAddress = GetAddressFromMessage(itmOld) ' This is our new function
    If Len(sAddress) > 0 Then
        itmNew.To = sAddress ' If our new function found a value apply it to the To: field.
        '!!! This should be checked as a valid address before continuing !!!
    End If

    itmNew.Body = myMessage & vbCr & vbCr & itmOld.Body
    itmNew.Subject = "IT Web Request Confirmation"
    itmNew.Display

    Set itmOld = Nothing
    Set itmNew = Nothing
End Sub

Private Function GetAddressFromMessage(msg As MailItem) As String
    ' Grabs the email from the standard HTML form described in the SO question.
    Dim lStart As Long
    Dim lStop As Long
    Dim sItemBody As String
    Const sSearchStart As String = "Requestee_Email: </b></td><td>" ' We will look for these tags to determine where the address can be found.
    Const sSearchStop As String = "</td>"

    sItemBody = msg.HTMLBody ' Read the body of the message as HTML to retain TAG info.

    lStart = InStr(sItemBody, sSearchStart) + Len(sSearchStart)
    If lStart > 0 Then ' Make sure we found the first TAG.
        lStop = InStr(lStart, sItemBody, sSearchStop)
    End If

    GetAddressFromMessage = vbNullString

    If lStop > 0 And lStart > 0 Then ' Make sure we really did find a valid field.
        GetAddressFromMessage = Mid(sItemBody, lStart, lStop - lStart)
    End If

End Function 
```

# php - 使用变量/数组的 FPDF 函数

> ID：15665271
> 
> 赞同：0
> 
> 时间：2013-03-27T17:20:10.167
> 
> 标签：php, arrays, variables, fpdf

需要一些 FPDF/php 变量帮助。

我正在使用 FPDF 创建 PDF，

我有一个如下的页脚功能：

```
function Footer()
{
    $invoicedetails = $results['invoice']->invoice_details; 
    $idetails = explode(", ", $invoicedetails); 
    $invoice_cost = implode(" ", $idetails); 
    $icost = explode(" ", $invoice_cost); 
    $string = $invoice_cost;
    $pattern = '/(?P<first>([^,].*?))-(?P<second>\d+)/';
    preg_match_all($pattern,$string, $matches);
    $detailsinvoice = $matches['first']; 
    $detailscost = $matches['second']; 

    $this->MultiCell(37.5, 10, $Totalcost , 1,'C',0);
} 
```

它应该在哪里显示 $detailscost 的价格。

我在前几页中使用了这个确切的代码，之后

```
 $pdf = new PDF();
 $pdf->AddPage(); 
```

FPDF 并且它工作得很好（在这之后也是收集和播放 $detailsinvoice 部分）但由于某种原因它在页脚功能中不起作用。

有人有任何提示吗？

伊恩

# javascript - 根据值长度向元素添加 CSS 类

> ID：15665273
> 
> 赞同：0
> 
> 时间：2013-03-27T17:20:15.870
> 
> 标签：javascript

我建立了一个菜单，当菜单项变得太长时，我想更改一些 CSS。这是我所拥有的，但它不起作用：

```
<script>
    var item1 = document.getElementByClass('nm-item-link-l');
    var item2 = document.getElementByClass('nm-item-link');
    if (item1.length > 20) {
        changeit = document.getElementByClass('nm-item-link-l').addClass('addclass');
    } else {
        ;
    }
    if (item2.length > 20) {
        changeit2 = document.getElementByClass('nm-item-link-l').addClass('addclass');
    } else {
        ;
    }
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T17:24:18.267

```
document.getElementByClass 
```

除非您自己定义它，否则它不是有效的 js 函数。你可能想要`getElementByClassName` Same for `addClass`。`addClass`是一个有效的 jQuery 方法，但不是标准的 javascript 函数。

### 根据评论更新

因为看起来你正在使用 jQuery

```
 var list1 = $(".nm-item-link-l");
   var list2 = $(".nm-item-link");

   if (list1.length > 20) {
       list1.addClass("addClass");
   }
   if (list2.length > 20) {
       list2.addClass("addClass");
   } 
```

### 更新#2，

由于您似乎想按字长过滤：

```
 var list1 = $(".nm-item-link-l");
   var list2 = $(".nm-item-link");
   list1.each(filterFunc);
   list2.each(filterFunc);

   function filterFunc(index,value){
     if (parseInt(value).text().length > 20) {
         $(value).addClass("addClass");
     }
   } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T17:32:03.887

```
function minimumClass(nodes, className, minNodes) {
  for (var i = 0, n = nodes.length; n > minNodes && i < n; i++) {
    nodes[i].classList.add(className);
  }
}

minimumClass(document.getElementsByClassName('nm-item-link-1'), 'add-class', 20);
minimumClass(document.getElementsByClassName('nm-item-link'), 'add-class', 20); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T17:27:18.823

它是 document.getElementsByClassName 而不是 document.getElementByClass。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-27T17:24:46.250

这里有多个问题

1.  `document.getElementByClass`应该`document.getElementsByClassName`
2.  `getElementsByClassName`返回一个 dom 对象数组
3.  dom 对象中没有调用方法`addClass`，需要使用属性`className`来更新`class`元素的属性。

代码

```
var items = document.getElementsByClassName('nm-item-link-l');
for(var i = 0; i < items.length; i++){
    items[i].className = 'addclass';
} 
```

如果你有 jquery

```
var item1 = $('.nm-item-link-l');
if(item1.length > 20){
    item1.addClass('addclass')
} 
```

# joomla2.5 - 如何在 joomla 2.5.9 注册页面中将 enctype 更改为“multipart/form-data”？

> ID：15665274
> 
> 赞同：0
> 
> 时间：2013-03-27T17:20:15.927
> 
> 标签：joomla2.5, joomla-extensions

几天以来，我一直在尝试更改 joomla 注册页面中的 enctype。我不是 Joomla 的专业人士。我编辑了

> 组件/com_users/views/registration/tmpl/default.php

并将 enctype 属性添加到表单行，所以现在看起来像这样：

```
 <form id="member-registration" enctype="multipart/form-data" action="<?php echo
    JRoute::_('index.php?option=com_users&task=registration.register'); ?>"
    method="post" class="form-validate" > 
```

但是，更改并未反映在用户端:(。

我想将 enctype 更改为 multipart/form-data 以允许通过 Profile Picture 插件上传图片。我也尝试使用 K2 注册表单，但没有成功。非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T09:51:53.313

您的模板可能覆盖了输出。看看里面的文件`/templates/yourtemplate/com_users/registration/default.php`

一些关于模板覆盖的文档可以在这里找到：[http ://docs.joomla.org/How_to_override_the_output_from_the_Joomla!_core](http://docs.joomla.org/How_to_override_the_output_from_the_Joomla!_core)

# c++ - 如何在 C++ 中针对稀疏矩阵优化 Gauss-Seidel 例程？

> ID：15665276
> 
> 赞同：2
> 
> 时间：2013-03-27T17:20:19.093
> 
> 标签：c++, sparse-matrix, numerical-methods

我用 C++ 编写了一个例程，它使用 Gauss-Seidel 方法求解方程组 Ax = b。但是，我想将此代码用于稀疏的特定“A”矩阵（大多数元素为零）。这样，该求解器花费的大部分时间都在忙于将某些元素乘以零。

例如，对于以下方程组：

```
| 4 -1  0  0  0 | | x1 |   | b1 |
|-1  4 -1  0  0 | | x2 |   | b2 |
| 0 -1  4 -1  0 | | x3 | = | b3 |
| 0  0 -1  4 -1 | | x4 |   | b4 |
| 0  0  0 -1  4 | | x5 |   | b5 | 
```

使用 Gauss-Seidel 方法，我们将有以下 x1 的迭代公式：

x1 = [b1 - (-1 * x2 + 0 * x3 + 0 * x4 + 0 * x5)] / 4

如您所见，求解器通过将零元素相乘来浪费时间。由于我使用大矩阵（例如，10^5 x 10^5），这将对总 CPU 时间产生负面影响。我想知道是否有一种方法可以优化求解器，使其省略与零元素乘法相关的计算部分。

请注意，上例中“A”矩阵的形式是任意的，求解器必须能够处理任何“A”矩阵。

这是代码：

```
void GaussSeidel(double **A, double *b, double *x, int arraySize)
{   
const double tol = 0.001 * arraySize;
double error = tol + 1;

for (int i = 1; i <= arraySize; ++i)
    x[i] = 0;

double *xOld;
xOld = new double [arraySize];
for (int i = 1; i <= arraySize; ++i)
    xOld[i] = 101;

while (abs(error) > tol)
{

    for (int i = 1; i <= arraySize; ++i)
    {
        sum = 0;
        for (int j = 1; j <= arraySize; ++j)
        {
            if (j == i)
                continue;
            sum = sum + A[i][j] * x[j];
        }
        x[i] = 1 / A[i][i] * (b[i] - sum);
    }

    //cout << endl << "Answers:" << endl << endl;
    error = errorCalc(xOld, x, arraySize);

    for (int i = 1; i <= arraySize; ++i)
        xOld[i] = x[i];

cout << "Solution converged!" << endl << endl;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-27T18:46:43.103

编写稀疏线性系统求解器很困难。**很难。**

我只会选择现有的实现之一。任何合理的 LP 求解器内部都有一个稀疏线性系统求解器，例如参见[lp_solve](http://lpsolve.sourceforge.net/5.5/)、[GLPK](http://www.gnu.org/software/glpk/)等。

如果您可以接受许可证，我推荐[Harwell Subroutine library](http://www.hsl.rl.ac.uk/)。虽然接口 C++ 和 Fortran 并不好玩……

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-27T18:57:10.033

你的意思是稀疏到什么程度？

这是一个糟糕的稀疏实现，应该可以很好地解决线性方程组。这可能是一个幼稚的实现，我对工业强度稀疏矩阵中通常使用的数据结构知之甚少。

[代码和示例在这里。](http://ideone.com/LHkkmQ)

这是完成大部分工作的类：

```
template <typename T>
class SparseMatrix
{
private:
    SparseMatrix();

public:
    SparseMatrix(int row, int col);

    T Get(int row, int col) const;
    void Put(int row, int col, T value);

    int GetRowCount() const;
    int GetColCount() const;

    static void GaussSeidelLinearSolve(const SparseMatrix<T>& A, const SparseMatrix<T>& B, SparseMatrix<T>& X);

private:
    int dim_row;
    int dim_col;

    vector<map<int, T> > values_by_row;
    vector<map<int, T> > values_by_col;
}; 
```

ideone 中包含其他方法定义。我不测试收敛性，而是简单地循环任意次数。

稀疏表示使用 STL 映射按行和列存储所有值的位置。对于像您提供的那样非常稀疏的矩阵（密度 < .001），我能够在 1/4 秒内解决一个包含 10000 个方程的系统。

我的实现应该足够通用，以支持任何支持比较的整数或用户定义类型、4 个算术运算符（`+`、`-`、`*`、`/`），并且可以从 0 显式转换（空节点被赋予 value `(T) 0`）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-03-21T11:41:40.640

最近，我面临同样的问题。我的解决方案是使用向量数组来保存稀疏矩阵。这是我的代码：

```
#define PRECISION   0.01

inline bool checkPricision(float x[], float pre[], int n) {
    for (int i = 0; i < n; i++) {
        if (fabs(x[i] - pre[i]) > PRECISION) return false;
    }
    return true;
}

/* mx = b */
void gaussIteration(std::vector< std::pair<int, float> >* m, float x[], float b[], int n) {
    float* pre = new float[n];
    int cnt = 0;
    while (true) {
        cnt++;
        memcpy(pre, x, sizeof(float)* n);
        for (int i = 0; i < n; i++) {
            x[i] = b[i];
            float mii = -1;
            for (int j = 0; j < m[i].size(); j++) {
                if (m[i][j].first != i) {
                    x[i] -= m[i][j].second * x[m[i][j].first];
                }
                else {
                    mii = m[i][j].second;
                }
            }
            if (mii == -1) {
                puts("Error: No Solution");
                return;
            }
            x[i] /= mii;
        }
        if (checkPricision(x, pre, n)) {
            break;
        }
    }
    delete[] pre;
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-08-04T11:35:42.800

试试 PETSC。为此，您需要 CRS（压缩行存储）格式。

# java - 通过 http 将图像发送到浏览器

> ID：15665277
> 
> 赞同：0
> 
> 时间：2013-03-27T17:20:19.247
> 
> 标签：java, http

我想用java实现一个简单的Web服务器。问题是图像没有在网络浏览器上正确呈现；如果我访问 localhost:8888/image.png，我所能看到的只是一个具有精确宽度、高度和重量的白色方块。先感谢您！:)

这是代码：

```
public Http(Socket server) throws IOException {
    in = new BufferedReader(new InputStreamReader(server.getInputStream()));
    parseHeader(in);
    String response = new String();
    out = new PrintWriter(server.getOutputStream(), true);
    Files f = new Files(getHomePath() + httpRequestedPage);

    if(!f.exists) {
        // 404 ERROR
    } else {
            response += "HTTP/1.1 200 OK\r\n";
            response += "Date: " + nowDate + "\r\n";
            response += "Content-Type: image/png\r\n";
            response += "Content-Length: " + res.length() + "\r\n";
            response += "Connection: keep-alive\r\n";
            response += "\r\n";
            response +=  IOUtils.toString(new FileInputStream(getHomePath() + httpRequestedPage));
    }

    out.println(response);
    in.close();
    out.close();
} 
```

编辑：

不幸的是，它返回相同的消息。

```
 out = new PrintWriter(server.getOutputStream(), true);

    OutputStream out2 = server.getOutputStream(); 
    File file = new File(HttpServer.getHomePath() + httpRequestedPage);
    InputStream stream = new FileInputStream(file); 

    String response = new String();
    response += "HTTP/1.1 200 OK\r\n";
    response += "Date: " + nowDate + "\r\n";
    response += "Content-Type: image/png\r\n";
    response += "Content-Length: " + file.length() + "\r\n";
    response += "Connection: keep-alive\r\n";
    response += "\r\n";
    out.println(response);
    IOUtils.copy(stream, out2); 
    out.close();
    out2.close(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T17:25:29.553

您正在使用 Write 类来渲染图像。使用 OutputStream 写入图像。图像是字节，应该使用基于字节的流来渲染它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T17:48:35.667

如果要将字节转换为`String`，则必须使用`Base64`编码。在客户端，您可以指定与`src`此类似的图像`"data:image/png;base64," + imageData`。

# html - 文本后的文本字段（在 div 中）始终显示在新行中

> ID：15665278
> 
> 赞同：0
> 
> 时间：2013-03-27T17:20:21.230
> 
> 标签：html, css, position

我希望一些文本和文本字段正确显示在同一行中，并在每个文本字段后换行。首先，我在一个具有绝对位置的类中拥有所有按钮，但我认为有更好的解决方案。

目前我有这种方式

```
<form action="" method="get" name="pdaten" >
<p><div class="text">Vorname</div><input class="button" id="vname"  type="text" /></p>
<p><div class="text">Nachname</div><input class="button"  id="nname"  type="text" /></p>
<p><div class="text">Geburtstag</div><input class="button" id="gebdat" type="text" /></p>
</form> 
```

CSS：

```
form{
    padding-left:1em;

}

.button{
    position:relative;
    left:0%;
}

.text{
    position:relative;
    text-align:left;
    width:20%;
    background-color:#00FF00;
} 
```

问题是，文本字段总是显示在下一行，而不是与文本所在的 div 相同。我可以使用跨度，但我不知道如何正确定位它们，因为我希望文本字段正好位于最后一个下方。

任何人都可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T17:21:54.517

您可以将`div`s`display`属性设置为`inline`，如下所示：

```
.text {
    display: inline;
} 
```

这将使`div`s 的行为类似于内联元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T17:22:26.413

这是因为`div`'s 是块元素，您可以通过将`display`属性值更改为`inline-display`

```
.text{
    position:relative;
    text-align:left;
    width:20%;
    background-color:#00FF00;
    display: inline-block;
} 
```

演示：[小提琴](http://jsfiddle.net/arunpjohny/UcKVx/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-27T17:23:44.190

添加`display:inline-block;`到您的文本类。

```
.text{
    position:relative;
    text-align:left;
    width:20%;
    background-color:#00FF00;
    display:inline-block;
} 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/nGLHw/)**

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-27T17:24:06.260

添加`float:left; clear:right;`到您的 .button 元素

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-27T17:24:19.553

为什么不只`display: inline-block`为您的 div添加

演示：http: [//jsfiddle.net/mAsxZ/1/](http://jsfiddle.net/mAsxZ/1/)

# javascript - 是否可以在将 jQuery 创建的元素插入 DOM 树之前获取它的 HTML？

> ID：15665281
> 
> 赞同：3
> 
> 时间：2013-03-27T17:20:29.380
> 
> 标签：javascript, jquery, html, jqgrid

这是我所拥有的：

```
gridComplete: function() {
    var doneButton = $('<input>', {
        type: 'button',
        value: 'Done',
        click: function() {
            alert("Done!");
        }
    });

    console.log("HTML:", doneButton.html());

    var ids = $(this).jqGrid('getDataIDs');
    var self = this;
    _.each(ids, function(id) {
        $(self).jqGrid('setRowData', id, {
            MarkDone: doneButton.html()
        });
    });
} 
```

如果我只是尝试插入 doneButton 对象，jqGrid 单元格会呈现 [object Object] 而不是实际的按钮。因此，我可以推断它期待原始 HTML。但是， doneButton.html() 返回一个空字符串...大概是因为我还没有将 doneButton 对象附加到文档上。

用 jQuery 做这件事有诀窍吗？我更喜欢更简洁/更安全的语法来生成 HTML 标记，但我可以这样做：

```
gridComplete: function() {
    var doneButtonHtml = "<input type='button' value='Done' onclick=\"alert('Done');\" />";

    var ids = $(this).jqGrid('getDataIDs');
    var self = this;
    _.each(ids, function(id) {
        $(self).jqGrid('setRowData', id, {
            MarkDone: doneButtonHtml
        });
    });
}, 
```

它按预期呈现按钮。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T17:22:05.920

您从按钮中获得一个空字符串，因为`html()`返回的是*内部*HTML。

你可能想要`doneButton.get(0).outerHTML`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T17:43:41.320

如果我正确理解你想要什么，你可以用另一种方式做同样的事情。为了减少[Web 浏览](https://developers.google.com/speed/articles/reflow)器重排的次数， jqGrid 构建断开的网格体，然后将其插入一个。一个必须使用`gridview: true`才能具有性能优势。问题只是 jqGrid 将网格体构建**为 HTML 字符串而不是 DOM**。jqGrid 提供自定义格式化程序、cellattr 和 rowattr 回调，允许构造自定义列内容或在行上设置一些自定义属性。有关详细信息，请参阅[答案](https://stackoverflow.com/a/12519858/315935)。

所以你应该做的是

1.  `MarkDone`为带有内容`"<input type='button' value='Done' />"`（不带`click`）事件处理程序的列提供自定义格式化程序
2.  使用`onCellSelect`或回调在网格体的*任何*`beforeSelectRow`位置捕获`click`事件，包括单击“完成”按钮。[事件冒泡](http://www.w3.org/TR/DOM-Level-2-Events/events.html#Events-flow-bubbling)（参见[此处](http://en.wikipedia.org/wiki/DOM_events#Event_flow)）有助于减少网格中所需的事件句柄数量。将为您获取单击的单元格，将为您获取列号，并为您获取单击列的名称。*`$td = $(e.target).closest("td")``iCol = $.jgrid.getCellIndex($td[0])``this.p.colModel[iCol].name`*

 *[答案](https://stackoverflow.com/a/14537512/315935)，[另一个](https://stackoverflow.com/a/13765086/315935)和[最旧](https://stackoverflow.com/a/5305904/315935)的答案将为您提供所需的代码示例和其他信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T17:26:41.330

改变这个：

```
MarkDone: doneButtonHtml.html() 
```

到：

```
MarkDone: doneButtonHtml.get(0) 
```

*doneButtonHtml*是一个 DOM 元素数组。您需要调用*get(0)*来获取该数组中的第一个元素。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-27T17:29:10.807

首先要记住的是 .HTML() 实际上检索元素内部的 html，而不是元素本身的 html。

如果您从 jQuery 对象数组访问 Javascript 元素，您应该获取原始 html。看看这个小提琴：http: [//jsfiddle.net/NvKYT/](http://jsfiddle.net/NvKYT/)

```
var doneButton = $('<input>', {
    type: 'button',
    value: 'Done',
    click: function() {
        alert("Done!");
    }
});

//doneButton[0] - your html 
```

尝试传递 doneButton[0] 因为那是实际元素，而不是 jQuery 包装的元素。*

# windows-phone-7 - 模板选择器中的 Windows phone Grid Stretch Width

> ID：15665283
> 
> 赞同：0
> 
> 时间：2013-03-27T17:20:41.377
> 
> 标签：windows-phone-7, data-binding, width, listboxitems, itemtemplateselector

大家好，这是我的第一个问题，所以我会尽量明确：我有一个带有样式和模板的列表框，使其成为两列样式视图。

**这是 ListBoxItem 的模板**：

```
<DataTemplate x:Key="ItemDataTemplate">
        <Grid Height="29">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width=".3*" />
                <ColumnDefinition Width=".7*" />
            </Grid.ColumnDefinitions>
            <TextBlock Grid.Column="0" Name="txtBind1" Text="{Binding Codigo}"/>
            <TextBlock Grid.Column="1" Name="txtBind2" Text="{Binding Descripcion}"/>
        </Grid>            
    </DataTemplate>

<Style TargetType="ListBoxItem" x:Key="ListboxStretchStyle">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate>
                    <ContentPresenter HorizontalAlignment="Stretch" VerticalAlignment="Stretch"/>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="ListBoxStyle" TargetType="ListBox">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate>
                    <ScrollViewer>
                        <StackPanel VerticalAlignment="Top">
                            <Grid Height="30" Background="Gray">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="0.30*"/>
                                    <ColumnDefinition Width="0.70*" />
                                </Grid.ColumnDefinitions>
                                <Border BorderBrush="{StaticResource PhoneBackgroundBrush}" BorderThickness="1">
                                    <TextBlock Grid.Column="0" Text="{Binding CriterioActual.Descripcion}"/>
                                </Border>
                                <Border Grid.Column="1" BorderBrush="{StaticResource PhoneBackgroundBrush}" BorderThickness="1">
                                    <TextBlock Grid.Column="1" Text="Descripción"/>
                                </Border>
                            </Grid>
                            <ItemsPresenter/>
                        </StackPanel>
                    </ScrollViewer>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style> 
```

**这是列表框：**

```
<ListBox Height="320" Margin="0,84,0,0" Name="ListaArticulos" VerticalAlignment="Top"
                Style="{StaticResource ListBoxStyle}"
                ItemTemplate="{StaticResource ItemDataTemplate}"
                ItemContainerStyle="{StaticResource ListboxStretchStyle}"
                ItemsSource="{Binding Articulos}">
            </ListBox> 
```

**这是结果：**

![在此处输入图像描述](../Images/3c37c1a60250378882fe868e2e40018d.png)

至此，一切都很好，所以我实现了一个 TemplateSelector 来根据 ListBox 的 SelectedItem 更改 ListBoxItem 的模板。所以我将相同的模板放入 TemplateSelector 但网格的宽度没有拉伸。

**模板选择器：**

```
<DataTemplate x:Key="MultiTemplate">
        <Views:ArticulosTemplateSelector Content="{Binding}" Filtro="{Binding ElementName=ComboCriterios, Path=SelectedItem, Mode=OneWay}">
            <Views:ArticulosTemplateSelector.FiltroCodigo>
                <DataTemplate>
                    <Grid Height="29" Background="Gray" HorizontalAlignment="Stretch">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width=".3*" />
                            <ColumnDefinition Width=".7*" />
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Name="txtBind1" HorizontalAlignment="Stretch" Text="{Binding Codigo}"/>
                        <TextBlock Grid.Column="1" Name="txtBind2" HorizontalAlignment="Stretch" Text="{Binding Descripcion}"/>
                    </Grid>
                </DataTemplate>
            </Views:ArticulosTemplateSelector.FiltroCodigo>
</DataTemplate> 
```

**这是更新的列表框：**

```
<ListBox Height="320" Margin="0,84,0,0" Name="ListaArticulos" VerticalAlignment="Top"
                Style="{StaticResource ListBoxStyle}"
                ItemTemplate="{StaticResource MultiTemplate}"
                ItemContainerStyle="{StaticResource ListboxStretchStyle}"
                ItemsSource="{Binding Articulos}">
            </ListBox> 
```

**最终结果：**

![在此处输入图像描述](../Images/56532bfd90f90c596a7ffa6e5940fc4a.png)

网格没有拉伸，如果有人可以请帮助我，我会很感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T16:08:01.900

模板选择器有自己的宽度，因此拉伸选择器以允许网格扩展其大小很重要：

```
<Views:ArticulosTemplateSelector HorizontalContentAlignment="Stretch" Content="{Binding}" Filtro="{Binding ElementName=ComboCriterios, Path=SelectedItem, Mode=OneWay}"> 
```

**注意主要变化：**

```
HorizontalContentAlignment="Stretch" 
```

问候

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-07T13:05:17.020

我在将 Listbox TemplateSelector 设置为 100% 时遇到问题。我对此的解决方案是用 LongListSelector 替换 Listbox。

# adk - Android 到 Arduino Mega ADK 板重新连接

> ID：15665293
> 
> 赞同：1
> 
> 时间：2013-03-27T17:20:58.390
> 
> 标签：adk

当我将我的 Arduino Mega ADK 板连接到 AOA Android 应用程序时，一切都很好（最初），与 ADK 板的连接在两个方向上都可以正常工作。但是，如果屏幕旋转、有人回击、屏幕锁定等，当应用重新启动时，对 USB 管理器的 openAccessory 调用始终返回 null。所以学生必须先拔掉 USB 才能重新建立连接。

我发现问题与输入流有关，因为如果我不启动线程来接收命令，那么就没有问题。然而，这并不是一个真正有用的修复。:)

我的代码在这里： [https ://github.com/ME435/AndroidLibraries_v01/blob/master/src/edu/rosehulman/me435/AccessoryActivity.java](https://github.com/ME435/AndroidLibraries_v01/blob/master/src/edu/rosehulman/me435/AccessoryActivity.java)

我只是在这样的应用程序中将我的 AccessoryActivity 子类化......

[https://github.com/ME435/LED-Toggle/blob/master/src/edu/rosehulman/ledtoggle/LedToggleActivity.java](https://github.com/ME435/LED-Toggle/blob/master/src/edu/rosehulman/ledtoggle/LedToggleActivity.java)

它并不强大，但对学生来说非常简单。对我的问题的想法？

# ruby-on-rails - Rails 3 按日期计数记录

> ID：15665298
> 
> 赞同：1
> 
> 时间：2013-03-27T17:21:12.053
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我正在尝试通过模型方法构建一个看起来像这样的数组：

`[['3/25/13', 2], ['3/26/13', 1], ['3/27/13', 2]]`

其中，日期是字符串，后面的数字是`count`表/对象的。

我现在有以下模型方法：

```
def self.weekly_count_array
  counts = count(group: "date(#{table_name}.created_at)", conditions: { created_at: 1.month.ago.to_date..Date.today }, order: "date(#{table_name}.created_at) DESC")
  (1.week.ago.to_date).upto(Date.today) do |x|
    counts[x.to_s] ||= 0
  end
  counts.sort
end 
```

但是，它不会准确返回计数（所有值都为零）。我已经检查过关于 SO 的一些类似问题，但似乎也无法让它们工作。

有人可以帮助（1）让我知道这是否是最好的方法，并且（2）就上述代码可能存在的问题提供一些指导，如果是的话？谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-27T18:45:04.153

如果您愿意，可以将其用作模板

```
def self.period_count_array(from = (Date.today-1.month).beginning_of_day,to = Date.today.end_of_day)
  where(created_at: from..to).group('date(created_at)').count
end 
```

这将返回一个哈希值，其中日期为键，计数为值。（轨道 3.2.x）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T18:39:41.873

也许这就是你想要做的？

```
class YourActiveRecordModel < ActiveRecord::Base

  def.self weekly_count_array
    records = self.select("COUNT(id) AS record_count, DATE(created_at) AS created")
      .group("DATE(created_at)")
      .where("created_at >= ?", 1.month.ago.to_date) 
      .where("created_at <= ?", Date.current)

    records.each do |x|
      puts x.record_count
      puts x.created # 2013-03-14

      # use I18n.localize(x.created, format: :your_format) 
      # where :your_format is defined in config/locales/en.yml (or other .yml)
    end        
  end
end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-27T19:03:50.500

@Aditya Sanghi 的精彩回答。

如果您有确切的要求，您可以选择：

```
def self.weekly_count_array
  records = select('DATE(created_at) created_at, count(id) as id').group('created_at')
  1.week.ago.to_date.upto(Date.today).map do |d| 
    [d, records.where('DATE(created_at) = ?', d.to_date).first.try(:id) || 0]
  end 
end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-27T18:09:49.033

您不需要进程来执行计数。只需为此执行查询。

```
def self.weekly_count_array
    select("created_at, COUNT(created_at) AS count")
    where(created_at: 1.month.ago.to_date..Date.today)
    group("created_at")
    order("created_at DESC")
end 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-04-08T15:29:45.633

建立在@kiddorails 答案之上，

所以不要对数据库提出很多请求，从 ActiveRecord 创建了一个哈希

& 将组从 .group('created_at') 更改为 .group('DATE(created_at)') 以基于日期

```
def self.weekly_count_array
   # records = select('DATE(created_at) created_at, count(id) as id').group('created_at')
   records_hash = Hash[Download.select('DATE(created_at) created_at, count(id) as id').group('DATE(created_at)').map{|d|[d.created_at, d.id] }]
   1.month.ago.to_date.upto(Date.today).map do |d| 
     [ d, records_hash[d.to_date] || 0 ]
   end 
end 
```

# php - 从 postgresql 数据库中使用 php 动态下拉

> ID：15665299
> 
> 赞同：0
> 
> 时间：2013-03-27T17:21:12.910
> 
> 标签：php, html, forms, postgresql, drop-down-menu

**编辑：代码已更改并已针对最新错误更新问题。**

我需要使用查询从我的 postgreSQL 数据库中填充书名的下拉列表，`SELECT title FROM books WHERE ownedBy = [users facebook ID]`然后使用用户的选择来显示该书的其余信息。该页面是一个 facebook 应用程序，这就是我获取 facebook ID 的方式。

到目前为止，这是代码的相关部分，主要是根据我发现的类似问题的各种答案创建的。

```
<form action="updateform.php" method="post">
  <input type="hidden" name="userid" id="userid" value="<?php echo htmlspecialchars($user_id); ?>"
  <select name="booktitle" id="booktitle">
  <option>Select book</option>
  <?php
    $db = pg_connect("host=ec2-54-243-190-226.compute-1.amazonaws.com port=5432 dbname=d6fh4g6l0l6gvb user=zmqygfamcyvhsb password=1Apld4ivMXSK8JZ_8yL7FwIuuz sslmode=require options='--client_encoding=UTF8'") or die('Could not connect: ' . pg_last_error());
    $sql = pg_query("SELECT title FROM books WHERE ownedby='$user_id'";
    while ($row = pg_fetch_assoc($sql)) {
    echo '<option value="'.htmlspecialchars($row['title']).'"></option>';}
    pg_close($db);
    ?>
    </select>
//other form elements here
</form> 
```

目前，没有显示下拉框，服务器日志显示`pg_query() expects parameter 1 to be resource, string given in /app/www/update.php on line 275`pg_fetch_assoc 出现相同的错误

如果有人可以帮助我让下拉框部分工作，那现在很好，一旦这部分工作，我将自己解决其余部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T17:26:20.413

线

```
$sql = pg_query("SELECT title FROM books WHERE ownedby=("$user_id")"); 
```

包含一个错误，因为 $user_id 之前的双引号关闭了字符串 "SELECT .... 一个快速的解决方法是将 "$user_id" 更改为 '$user_id' 并删除大括号 ()

通常，将变量直接放入 SQL 查询中并不是一个好习惯，因为您的代码容易受到 SQL 注入的攻击。考虑使用准备、绑定和执行语句。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T17:25:09.677

引号内未转义的引号

这个

```
$sql = pg_query("SELECT title FROM books WHERE ownedby=("$user_id")"); 
```

应该

```
$sql = pg_query("SELECT title FROM books WHERE ownedby='$user_id'"); 
```

或者

```
$sql = pg_query("SELECT title FROM books WHERE ownedby=\"$user_id\""); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-27T17:25:38.583

尝试这个：

```
<form action="updateform.php" method="post">
<select name="bookTitle">
  <?php
        $db = pg_connect("host=ec2-54-243-190-226.compute-1.amazonaws.com port=5432 dbname=d6fh4g6l0l6gvb user=zmqygfamcyvhsb password=[removed] sslmode=require options='--client_encoding=UTF8'") or die('Could not connect: ' . pg_last_error());
        $sql = pg_query(sprintf("SELECT title FROM books WHERE ownedby=%d", $user_id));
        while ($row = pg_fetch_assoc($sql)) {
            echo '<option value="'.htmlspecialchars($row['title']).'"></option>';
        }
        pg_close($db);
  ?>
</select> 
```

注意使用 'echo' 而不是关闭 PHP 标记。

此外，您可能应该使用 ID，而不是选项值的标题 :)

问候，菲尔

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-27T17:24:41.963

您没有逃脱第 275 行的引号。应该是

```
$sql = pg_query("SELECT title FROM books WHERE ownedby=\"$user_id\""); 
```

或者

```
$sql = pg_query('SELECT title FROM books WHERE ownedby="'.$user_id.'"'); 
```

# java - Eclipse 3.7 在类中格式化静态

> ID：15665306
> 
> 赞同：4
> 
> 时间：2013-03-27T17:21:27.490
> 
> 标签：java, eclipse, formatting

在 Eclipse 3.7 中是代码：

```
public class AppResources
{
    private static Image titleIcon;
    static
    {
        AppResources.titleIcon = getIconImage();
    }

    public static Image getTitleIcon()
    {
        return AppResources.titleIcon;
    }
} 
```

Formatter 在哪里可以说 before`static`应该是空行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T17:49:15.360

静态块没有单独的格式设置。出于格式化目的，它似乎被视为任何其他成员变量（与函数或其他构造相反）。

不过，还有另一种方法可以得到您想要的格式。如果您将格式化选项空白行->现有空白行->要保留的空行数设置为 1，那么您可以在静态块之前手动添加一个空行，并且格式化程序不会将其删除。

![在此处输入图像描述](../Images/2495618c02e628d6ea63b242bb38e441.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T18:08:38.857

`static`正如其他答案指出的那样，通过 Eclipse 格式化程序对块执行此操作是不可能的。实现此目的的另一种方法是`File Search`在 Eclipse 中搜索/替换：

从：

```
(^\s*\n)*(^\s*static\s*\{) 
```

至：

```
\n\2 
```

`Regular Expression`启用_

# haskell - 函数式语言编译器是如何工作的？

> ID：15665308
> 
> 赞同：5
> 
> 时间：2013-03-27T17:21:38.990
> 
> 标签：haskell, compiler-construction, functional-programming

所以这可能是一个愚蠢的问题，但我有点困惑。

所以我知道 Haskell 编译器本身是用 Haskell 编写的。这是如何运作的？它编译成什么？OCaml 编译器是用什么编写的？

此外，他们说使用像 haskell 或 OCaml 这样的函数式语言。发生这种情况时，有人可以完成发生的步骤吗？那么新语言将被编译为haskell，然后将其编译为haskell编译器编译的任何内容？

# javascript - 当我将宽度设为 100% 时，元素未居中对齐

> ID：15665309
> 
> 赞同：0
> 
> 时间：2013-03-27T17:21:40.697
> 
> 标签：javascript, html, css, twitter-bootstrap

我正在使用 twitter bootstrap ......问题是容器宽度不是 100% ......如何使它成为 100% ......所以一切都变得居中对齐并且在 firbug 中我将容器宽度更改为 100% 但是它没有居中对齐...如何解决它...

[http://jsfiddle.net/WG7kk/1/embedded/result/](http://jsfiddle.net/WG7kk/1/embedded/result/)

```
.container, .navbar-fixed-top .container, .navbar-fixed-bottom .container {
width: 940px;
}

<article class="container" style="margin-top: 25px;">

<div id="landing">
    <div class="container">Purchase Order</div>

    <div class="container" >
        <section>
          <div class="row features" >

            <div id="enhancingWidth" class="span6" >

                <div class="span5 left-box">

                    <div class="control-group">

                        <div class="controls">
                            <input type="text" placeholder="Vendor No" id="c_fdCompanyName" name="bcompanyname" value="" required="required">
                            <label class="error" for="c_fdCompanyName" id="c_fdCompanyName_error"></label>
                        </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T10:09:16.767

按照下面的示例代码。

```
 body {
        min-width: 550px;         /* 2 x LC width + RC width */
    }

    #container {
        padding-left: 200px;      /* LC width */
        padding-right: 150px;     /* RC width */
    }

    #container .column {
        position: relative;
        float: left;
    }

    #center {
        width: 100%;
    }

    #left {
        width: 200px;             /* LC width */
        right: 200px;             /* LC width */
        margin-left: -100%;
    }

    #right {
        width: 150px;             /* RC width */
        margin-right: -100%;
    }

    #footer {
        clear: both;
    }

    /*** IE6 Fix ***/
    * html #left {
        left: 150px;              /* RC width */
    }

    /*** Just for Looks ***/

    body {
        margin: 0;
        padding: 0;
        background: #FFF;
    }

    #header, #footer {
        font-size: large;
        text-align: center;
        padding: 0.3em 0;
        background: #999;
    }

    #left {
        background: #66F;
    }

    #center {
        background: #DDD;
    }

    #right {
        background: #F66;
    }

    #container .column {
        padding-top: 1em;
        text-align: justify;
    }

  <div id="container">

    <div id="center" class="column">
        <h1>This is the main content.</h1>
        <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.</p>
        <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.</p>
    </div>

    <div id="left" class="column">
        <h2>This is the left sidebar.</h2>
        <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat. </p>
    </div>

    <div id="right" class="column">
        <h2>This is the right sidebar.</h2>
        <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat. </p>
    </div>

</div> 
```

# sql - 如何使用 OpenRowSet 将数据插入空白文件？

> ID：15665311
> 
> 赞同：4
> 
> 时间：2013-03-27T17:21:44.673
> 
> 标签：sql, sql-server, sql-server-2005, openrowset

如何使用**OpenRowSet**将数据插入空白文件？

我需要从数据库中插入一些选择输出（比如`select * from sys.tables`）到 txt 文件（比如 D:\TDB）

```
INSERT INTO OPENROWSET('Microsoft.Jet.OLEDB.4.0',
'Text;Database=D:\TDB;HDR=Yes;', 'SELECT * FROM sys.tables.txt')
select * from sys.tables; 
```

我明白了

> 链接服务器“（null）”的 OLE DB 提供程序“MICROSOFT.JET.OLEDB.4.0”返回消息“Microsoft Jet 数据库引擎找不到对象 'sys.tables.txt'。确保该对象存在并且您拼写它的名称和路径名正确。”。

消息 7350，第 16 级，状态 2，线路

> 1 无法从链接服务器“(null)”的 OLE DB 提供程序“MICROSOFT.JET.OLEDB.4.0”获取列信息。

怎么了？

PS。请不要提出*bcp*解决方案，因为已经测试过并且每次都不起作用，所以我现在要测试*openrowset* ..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-07T03:49:29.150

@serhio，我在下面测试了你的sql：</p>

```
INSERT INTO OPENROWSET('Microsoft.Jet.OLEDB.4.0',
'Text;Database=D:\TDB;HDR=Yes;', 'SELECT * FROM sys.tables.txt')
select * from sys.tables; 
```

我得到了一些测试结果

1.  文件名不应包含“。” 在里面。(sys.tables.txt→systables.txt)
2.  HDR（标题行）不能在这里使用。（删除它）
3.  txt 文件必须存在。（创建它）
4.  txt 文件中的第一行应该是源数据的所有列名。

**sql**

```
INSERT INTO OPENROWSET('Microsoft.Jet.OLEDB.4.0',
'Text;Database=D:\TDB;', 'SELECT * FROM systables.txt')
select * from sys.tables; 
```

**系统表.txt**

```
name,object_id,principal_id,schema_id,parent_object_id,type,type_desc,create_date,modify_date,is_ms_shipped,is_published,is_schema_published,lob_data_space_id,filestream_data_space_id,max_column_id_used,lock_on_bulk_load,uses_ansi_nulls,is_replicated,has_replication_filter,is_merge_published,is_sync_tran_subscribed,has_unchecked_assembly_data,text_in_row_limit,large_value_types_out_of_row,is_tracked_by_cdc,lock_escalation,lock_escalation_desc 
```

# css - 对齐 3 个 div 内联

> ID：15665312
> 
> 赞同：2
> 
> 时间：2013-03-27T17:21:49.407
> 
> 标签：css, html

我正在尝试将 3 个 div 相互对齐

我有

```
#header {
    width:100%;
    height:160px;
} 
```

作为主容器，因此容器适合页面的宽度（100%）

然后

```
.header-left {
    width:33%;
    display:inline-block;
}
.logo {
    width:409px; /* width of the logo */
    margin:10px auto 0 auto;
    display:inline-block;
}
.header-right {
    width:33%;
    display:inline-block;
} 
```

对于容器中的 3 个 div。

我需要在页面中心和其他 2 个 div 之间的 .logo div，然后是徽标 div 两侧的其他 2 个 div。

徽标 div 需要为 409px，因为这就是徽标的宽度。

出于某种原因，它只是全部显示在左侧，我不知道为什么

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T18:03:26.023

如果您按如下方式排列标题 HTML，则一种解决方案是可能的：

```
<header class="ex1">
    <div class="header-left">the left stuff </div>
    <div class="header-right">the right stuff</div>
    <div class="logo"><img src="http://placehold.it/409x138" ></div>
</header> 
```

并应用以下 CSS：

```
header {
    border: 1px solid blue;
    width: 100%;
    min-width: 800px;
    height: 160px;
    overflow: auto;
}
.ex1 .header-left {
    display:inline-block;
    width: 33%;
    max-width: 190px;
    background-color: gray;
    float: left;
}
.ex1 .logo {
    width: 409px; /* width of the logo */
    margin:10px auto 0 auto;
    border: 1px solid red;
}
.ex1 .logo img {
    display: block;
}
.ex1 .header-right {
    display:inline-block;
    width: 33%;
    max-width: 190px;
    background-color: gray;
    float: right;
} 
```

基本上，您将左侧的 header 元素浮动到左侧，将右侧的元素浮动到右侧，并保持 logo 元素在正常的框流中居中。

设置`min-width`以允许固定带有徽标/横幅图像。

小提琴参考：http: [//jsfiddle.net/audetwebdesign/Esst8/](http://jsfiddle.net/audetwebdesign/Esst8/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T17:35:36.680

在这种情况下，如果 409px 超过总宽度的 34% 会发生什么？它打破了。

考虑重写你的html，它不会这样工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-27T17:53:08.063

## 重组和使用`Float`

为了得到你想要的，最好的办法是重构你的 HTML 并确保你`min-width`在`body`. 像这样的东西（[如this fiddle所示](http://jsfiddle.net/R65fA/11/)）：

**HTML**

```
<div id="header">
        <div class="header-left">LEFT</div>
      <div class="header-right">RIGHT</div>
        <div class="logo"><img src="images/logo" width="409" height="138" /></div>
</div> 
```

**基本 CSS**

```
body {
    min-width: 600px; /* some minimum greater than 409px */
}

.header-left {
    float: left;
    width: 50%;
    margin-right: -204.5px;
    border-right: 204.5px solid transprent;
    -webkit-box-sizing: border-box;
    -moz-box-sizing: border-box;
    box-sizing: border-box;
}
.logo {
    width:409px; /* width of the logo */
    margin:10px auto 0 auto;
    position: relative;
    z-index: 1;
}
.header-right {
    float: right;
    width: 50%;
    margin-left: -204.5px;
    border-left: 204.5px solid transparent;
    -webkit-box-sizing: border-box;
    -moz-box-sizing: border-box;
    box-sizing: border-box;
} 
```

**更新：**要让它“在中心”运行，您必须考虑设置中较大的两个侧面部分`min-width`。因此，如果您在每一侧放置一些固定宽度的元素，那么您需要`min-width`通过以下公式根据这两个侧元素中的较大者计算您的：

> （（较大的边片 px）x 2）+ 409px 徽标 = 最小宽度

不要忘记在调整大小时根据需要考虑边界等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-27T19:26:56.017

```
#header{ width:100%}
.header-left {
    width:33%;
    float:left;
}
.logo {
    width:34%; /* width of the logo */
    margin:10px 0px 0px;
    float:left; height:138px;
}
.header-right {
    width:33%;
    float:left;
}
.clr{ clear:both;} 
```

**HTML：**

```
<div id="header">
     <div class="header-left">LEFT</div>
     <div class="header-right">RIGHT</div>
     <div class="logo"><img src="images/logo" width="409" height="138" /></div>
     <div class="clr"></div>
</div> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-27T17:28:57.667

使用`display: inline`而不是`display: inline-block`你的 div

演示：http: [//jsfiddle.net/R65fA/1/](http://jsfiddle.net/R65fA/1/)

我刚刚阅读了@Milche Patern 的答案，并注意到您对子元素同时使用百分比和固定宽度。这真是个坏主意。你最好重写以使其成为标准。

# jquery - Fancybox 默认关闭按钮 - 关闭按钮功能

> ID：15665314
> 
> 赞同：-1
> 
> 时间：2013-03-27T17:21:51.943
> 
> 标签：jquery, fancybox, fancybox-2

当用户单击fancybox 2 中的默认关闭按钮时，如何编写函数？每当我将鼠标悬停在关闭按钮上时，它都会`javascript:;`在 Chrome 中显示我。

这是图像![关闭按钮](../Images/880d3a5ccd0f3c339aedb013e7da131c.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T20:24:46.307

只需将`tpl`API 选项添加到您的自定义脚本并`href`从关闭按钮模板中删除该属性，例如：

```
$(".fancybox").fancybox({
    tpl: {
        closeBtn: '<a title="Close" class="fancybox-item fancybox-close"></a>'
    }
}); 
```

见**[JSFIDDLE](http://jsfiddle.net/SAcCD/)**

# python - 我可以使用 doxygen 来记录命令行程序吗？

> ID：15665322
> 
> 赞同：2
> 
> 时间：2013-03-27T17:22:14.143
> 
> 标签：python, c, doxygen, command-line-interface

我参与了一个大型代码项目，该项目使用 Doxygen 来记录一系列 C 库。我们也开始将 doxygen 与[doxypy 一起](http://code.foosel.org/doxypy)用于相关的 python 模块。

是否有一种简单的方法来记录命令行程序（在 python 或 C 中）及其命令行选项，（自动）使用 doxygen？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T19:33:20.520

为了生成`man`页面，您需要将`GENERATE_MAN`tag 设置为 Yes (.doxyfile)。

默认情况下，在提供的目录中创建一个名为 man 的子文件夹，`OUTPUT_DIRECTORY`用于包含生成的页面。

通过这样做，doxygen 会将您添加到源代码中的所有标记呈现为手册页（每个翻译单元一页）。

此时，您可能想要使用[exclude* 指令排除](http://www.doxygen.nl/config.html#exclude)您想要忽略的某些部分（我假设您只想展示如何调用 main） 。

我建议您编译两个不同的 doxyfile：一个用于内部使用（完整的类似 javadoc 的文档），另一个用于生成程序 man 等。

当然，你不会在第一次尝试时得到预期的结果，你可能需要稍微使用一下 doxygen 标记。

# c# - 使用javascript隐藏/显示单选按钮列表项

> ID：15665324
> 
> 赞同：-1
> 
> 时间：2013-03-27T17:22:18.477
> 
> 标签：c#, javascript, asp.net, drop-down-menu, radiobuttonlist

我有一个下拉列表，比如 ddlTest，其中包含 Opt1、Opt2 作为项目。在同一页面上，我有一个单选按钮列表，列表项为 rblItem1、rblItem2 和 rblItem3。现在，如果用户在下拉列表中选择 Opt2，那么我应该隐藏 rblItem3 或对于选择的任何其他选项，我应该在单选按钮列表中显示 rblItem3。

你能否让我知道它是否可能以及如何使用 javascript 来做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T19:24:08.127

```
<table>
    <tr>
        <td>

                <asp:RadioButtonList ID="radiobuttonlist1" runat="Server" RepeatLayout="flow" RepeatDirection="horizontal">
                         <asp:ListItem Text="Radio 1" Value="1" Selected="True"></asp:ListItem>    
                           <asp:ListItem Text="Radio 2" Value="2"></asp:ListItem>

                             <asp:ListItem Text="Radio 3" Value="3"></asp:ListItem>

                                    </asp:RadioButtonList>

                                </td>

                                <td>

                                    <input type="button" value="Submit" onclick="GetRadioButtonValue('<%= radiobuttonlist1.ClientID %>')" />

                                </td>

                            </tr>

                        </table> 
```

Javascript代码：-

```
<script language="javascript" type="text/javascript">

        // Get radio button list value

        function GetRadioButtonValue(id)

        {

            var radio = document.getElementsByName(id);

            for (var j = 0; j < radio.length; j++)

            {

                if (radio[j].checked)

                   //make hide the Item

            }

        }

</script> 
```

# ios - 如何按价格值对 SKProduct 数组进行排序

> ID：15665325
> 
> 赞同：1
> 
> 时间：2013-03-27T17:22:20.007
> 
> 标签：ios, nsarray, in-app-purchase, sorting, storekit

在发送产品 ID 列表后，我正在尝试对从 Apple 服务器收到的 SKProduct 数组进行排序。

我只想使用以下内容进行排序：

```
NSSortDescriptor *lowestPriceToHighest = [NSSortDescriptor sortDescriptorWithKey:@"self.price" ascending:YES];
NSArray *sortedProducts = [products sortedArrayUsingDescriptors:[NSArray arrayWithObject:lowestPriceToHighest]]; 
```

但我收到错误消息：`Unable to access variable "lowestPriceToHighest"` 我的排序描述符是否定义错误？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-27T20:25:10.463

尝试删除“自我”

```
NSSortDescriptor *lowestPriceToHighest = [NSSortDescriptor sortDescriptorWithKey:@"price" ascending:YES];
    NSArray *sortedProducts = [products sortedArrayUsingDescriptors:[NSArray arrayWithObject:lowestPriceToHighest]]; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2017-10-25T05:25:27.407

斯威夫特 4：

```
products.sort(by: { (p0, p1) -> Bool in
    return p0.price.floatValue < p1.price.floatValue
}) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-04-23T05:09:18.057

Assuming you have `var products: [SKProduct]` you can do:

```
products.sortInPlace {
    return Float($0.price) < Float($1.price)
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-27T19:54:03.047

尝试：

```
NSArray *products = [response.products sortedArrayUsingComparator:^(id a, id b) {
        NSDecimalNumber *first = [(SKProduct*)a price];
        NSDecimalNumber *second = [(SKProduct*)b price];
        return [first compare:second];
    }]; 
```

从这个答案：

[如何在应用程序购买中按价格对产品进行排序？](https://stackoverflow.com/questions/9074129/how-to-sort-products-by-price-in-app-purchases)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-01-05T06:55:49.983

```
NSSortDescriptor  *sort = [[NSSortDescriptor alloc] initWithKey:@"_strPrice"
                                                 ascending:sortFlag selector:@selector(localizedStandardCompare:)] ; 
```

试试这个选择器

# ios - SDK 6.1 UITextAlignment 错误

> ID：15665327
> 
> 赞同：0
> 
> 时间：2013-03-27T17:22:21.693
> 
> 标签：ios, cocoa-touch, compiler-errors

我有一个在 iOS6 下编写的项目，兼容 iOS5 或以上。最近我重新打开项目，我有这个非常奇怪的错误

![在此处输入图像描述](../Images/1a24b35eea5e42b3441b7b16193f6f78.png)

但在我所有其他项目中，这条线工作正常。问题是什么 ？

谢谢 ！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T17:43:18.867

较旧的`UITextAlignment`枚举在 iOS 6.0 中已弃用。它已被`NSTextAlignment`枚举替换。较新版本的编译器（带有较新版本的 Xcode）对此更加严格。

由于您的 Base SDK 是 iOS 6.1（基于您的问题的标题），编译器会抱怨您使用了错误的枚举值。

您的部署目标与编译器消息无关。好消息是，只要您坚持 、 和 值，新的枚举与旧的枚举`Left`向后`Center`兼容`Right`。

将您的代码更改为：

```
_cartaServiziLabel.textAlignment = NSTextAlignmentCenter; 
```

并且您的代码将编译并适用于 iOS 2.0 及更高版本。

# c - 使用带有 SIG_INFO 的 sigaction 处理程序的第三个参数（void* context）会导致分段错误

> ID：15665329
> 
> 赞同：7
> 
> 时间：2013-03-27T17:22:23.867
> 
> 标签：c, gcc, signals, handler, ucontext

我已将产生问题的巨大光纤调度程序代码减少到以下几行。
我期望的是每次都干净地返回上下文，传递给处理程序。
我得到的是“处理程序”。打印了三遍，然后是分段错误。

```
#include <ucontext.h>
#include <signal.h>
#include <stdio.h>

ucontext_t currently_executed_context;

void handler_sigusr1(int signum, siginfo_t* siginfo, void* context)
{
    currently_executed_context = (*(ucontext_t*)context);

    printf("Handler. ");
    setcontext(&currently_executed_context);
}

int main()
{
    setbuf(stdout,0);

    struct sigaction action_handler;

    action_handler.sa_sigaction = handler_sigusr1;
    action_handler.sa_flags = SA_SIGINFO;

    sigaction(SIGUSR1,&action_handler,NULL);

    for(;;) { kill(getpid(),SIGUSR1); sleep(1); }

    return 0;
} 
```

在两个不同的 Linux 发行版上同时使用 gcc-4.4.3 和 gcc-4.4.5。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T22:01:12.857

在这一点上，我自己对该问题的研究可以作为部分答案。

首先，我发现[这篇文章](http://zwillow.blogspot.com/2007/04/linux-signal-handling-is-broken.html)很旧，并且没有引用任何官方信息来源：http: [//zwillow.blogspot.com/2007/04/linux-signal-handling-is-broken.html](http://zwillow.blogspot.com/2007/04/linux-signal-handling-is-broken.html)。这是一个相关的引用：

> 第二个问题：您不能使用 setcontext() 离开信号处理程序并跳转到另一个先前保存的上下文。（或者，就此而言，您不能使用它返回作为参数传递给信号处理程序的相同上下文。）换句话说，信号处理程序就像
> 
> ```
> static void sighandler(
>    int signo, siginfo_t *psi, void *pv)
> {
>   memcpy(puc_old, pv, sizeof(ucontext_t));
>   /* choose another context to dispatch */
>   setcontext(puc_another);
> } 
> ```
> 
> 不起作用。它不会恢复 puc_other 中指定的信号掩码，不会重新建立备用信号堆栈等。但是，该方案在 Solaris 上完美运行。

如果有人可以确认有关 Solaris 的部分，将不胜感激。

其次，在与大学讲师交谈后，我开始明白从信号处理程序设置/交换上下文并不像在其他情况下那样直接。可悲的是，向我解释这一点的人当时无法提供更多细节。

因此，我的两个来源似乎都不完全可靠，但仍然是线索。

# facebook - facebook访问令牌不使用FB APP

> ID：15665331
> 
> 赞同：0
> 
> 时间：2013-03-27T17:22:29.223
> 
> 标签：facebook, token, facebook-access-token

我必须检索将要使用我的 FF 扩展的用户的访问令牌。问题是我无法在线使用常用功能，因为我没有可以使用的 FB APP 和 Facebbok APP 的密码。我有一个 FF 扩展，用户必须登录，我想用我的扩展检索正在使用我的扩展的用户的令牌，让他使用我的扩展的某些功能。一切都必须用 Javascript 制作，因为 FF 扩展适用于 JS 文件。让一切变得更简单，我有一个按钮，它必须检索正在使用我的扩展的用户的令牌，然后我有一些功能将与笔记本电脑前面的用户的令牌建立链接，使用我的扩展。

有人有一些想法吗？

我发现的唯一功能是：

```
 FB.login(function (response) {
        if (response.session) {
          var access_token = response.session.access_token;
           alert(access_token);
        } else {
           alert('User is logged out');
        }
    }); 
```

但我不知道它是否有效，当我尝试使用它时，我收到的消息是 NULL。

在此先感谢您的帮助。

# javascript - 动态更新功能不起作用

> ID：15665336
> 
> 赞同：1
> 
> 时间：2013-03-27T17:22:46.983
> 
> 标签：javascript, jquery

我有一个 for 循环，它通过一个以 JSON 格式返回的数组。这给了我每张图片的 ID 和名称。然后我有一个包含一些 HTML 的变量，并且一些元素由响应动态更新。然后我有一个函数可以从收藏夹 sql db 中添加/删除图像。但是，当我将函数添加到锚标记的 onclick 事件中并使用从数据库返回的 id 时，它拒绝运行（即使函数和 id 现在在 html 中可见）。用一些代码打开....

```
for (x in data.images) {            

    id = data.images[x].id,
    name = data.images[x].name,
    thumb = data.images[x].thumb    

output = '<div>\
              <a id="hil" href="viewer.php?id='+id+'">\
              <div>\
                   <img width="160px" height="160px" src="'+thumb+'">\
              </div>\
              </a>\

                  <div class="imft">
                      <a id="deladd" onclick="deladd('+id+')" class="deladd">
                          <img src="images/png/color_18/hand_thumbsup.png" />
                      </a> 
                  </div>\
                       <div>'+name+'</div>\
              </div>';

      $('#theImages').append(output); 
      $('#theImagesLoading').html('');
      $('#next').html('More');  

} 
```

不运行的函数是 deladd()，id 被传递给函数但 onclick 事件拒绝工作。如果需要，我可以提供更多代码和/或信息。

感谢您提前提供任何帮助。

Michael Geary 的 JSON 响应：

```
{"amount":4,"from":0,"limit":4,"images":{"1":     {"id":"3084f8d07be00e8af2ab4e7810b2e011","name":"Blossom.jpg","thumb":"thumbnails\/43efd305ac4381b2911d2cbaf212f9e0.jpg","ival":0},"2":{"id":"649d38a79f5980735be80156a83a27ff","name":"Wedding Sunflowe...","thumb":"thumbnails\/01dfca88ce1e699a6ab5d0e5c4adac5e.jpg","ival":1},"3":{"id":"ed2a2ff0c4e9ae319cdd791d8643f9e7","name":"Butterfly.JPG","thumb":"thumbnails\/6adcbf9bdf4b803654b291b2744c8a3b.jpg","ival":2},"4":{"id":"2f5e5540eceb27f9332deeb4cb44ae1c","name":"Creek.jpg","thumb":"thumbnails\/14eafef60824b9c755fc1737e6914ef1.jpg","ival":3}}} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T17:38:07.973

这段代码有几个不同的问题：

1.  永远不要使用`for..in`循环来遍历数组。请改用数字`for`循环。（我假设这`data.images`是一个数组 using `[]`，而不是一个对象 using `{}`，对吗？看看这个 JSON 数据的例子会很好。）

2.  您需要`var`对所有局部变量进行声明。

3.  它为调用生成的 HTML 代码`deladd()`在 ID 周围缺少引号。（我假设 ID 是一个字符串而不是一个数字。如果它是一个数字就可以了。）

4.  HTML 代码缺少一些`\`转义，但我认为这只是问题中的一个错字。

5.  缩进不一致。

这应该修复这些项目：

```
for( var i = 0, n = data.images.length;  i < n;  i++ ) {

    var image = data.images[i],
        id = image.id,
        name = image.name,
        thumb = image.thumb;

    var output =
        '<div>\
            <a id="hil" href="viewer.php?id='+id+'">\
                <div>\
                    <img width="160px" height="160px" src="'+thumb+'">\
                </div>\
            </a>\
            <div class="imft">\
                <a id="deladd" onclick="deladd(\''+id+'\')" class="deladd">\
                    <img src="images/png/color_18/hand_thumbsup.png" />\
                </a>\
                </div>\
                <div>'+name+'</div>\
        </div>';

    $('#theImages').append(output); 
    $('#theImagesLoading').html('');
    $('#next').html('More');  
} 
```

此外，使用其他方法添加此事件处理程序而不是`onclick`属性可能会更好。但这应该让你现在开始。

# jquery - 将 img 标签添加到 div - 而不是如何使用 append()

> ID：15665337
> 
> 赞同：0
> 
> 时间：2013-03-27T17:22:47.177
> 
> 标签：jquery, html

我使用以下代码正确添加了一个 img 标签，但它仅在网页上显示为一个带有 X 的小框。为了测试，我在网页中添加了同样的 img 标签。这显示很好。我在开发者工具（PF12）中查看了两个img标签，页面上的标签是一样的。我认为正在发生的事情是，在 jQuery 中，我在安排了所有对内容的 http 请求之后加载图像标签，所以我得到了标签，但是在浏览器的处理中获取请求的源文件为时已晚，并且加载。我正在尝试在页面的第一次显示时加载不同的图像（取决于隐藏输入字段的内容 - 访问它并根据我插入的一些警报确定哪个图像工作正常）。

这是插入图像的代码（在我解决这个问题时删除了决定）：

```
$(document).ready (function() {
            $('<img class="rcpt" src="~/Images/MountainCrs_Incline.png" alt="" />').appendTo('div#Logo');
}); 
```

这是插入的 img 标签，它只显示“未解析的引用”框（从生成的 html 中复制）：

```
<div id="Logo"><img class="rcpt" alt="" src="~/Images/ChampCrs_Incline.png"></div> 
```

这是我插入到原生 html 中的 img 标签，以验证 img 标签的格式是否正确（这个显示正常）：

```
<h3>&nbsp;</h3>
<img class="rcpt" alt="" src="/Images/ChampCrs_Incline.png">
<h3>&nbsp;</h3> 
```

如果有人能告诉我发生了什么以及如何解决它，我将不胜感激。我正在使用 Visual Studio 11 和 IE10 进行测试。谢谢...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-27T17:26:01.787

这不是有效的客户端 URL

```
~/Images/MountainCrs_Incline.png 
```

这在服务器端解析为有效的 url，但在客户端没有任何意义。尝试将其替换为

```
/Images/MountainCrs_Incline.png 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T17:30:30.637

您在使用 jQuery 插入的 img 标记的 src 属性中有一个波浪号 (~)，但在“本机 html”标记中没有。波浪号是有效的 URL 字符。我假设您使用的是 .NET。在 URL 中使用波浪号的方式仅适用于服务器端。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-27T17:45:45.447

使用[ResolveClientUrl](http://msdn.microsoft.com/en-IN/library/system.web.ui.control.resolveclienturl.aspx)试试这个：

```
var url = '<%= ResolveClientUrl("~/Images/MountainCrs_Incline.png") %>';
$('<img class="rcpt" src="' + url + '" alt="" />').appendTo('div#Logo'); 
```

# javascript - 如何在 html 5 中处理 websql 的结果集？

> ID：15665338
> 
> 赞同：0
> 
> 时间：2013-03-27T17:22:49.003
> 
> 标签：javascript, html, web-sql

我正在使用 html5 和 javascript 创建移动 Web 应用程序。我有两个 javascript 文件。AttributesDatabase.js 和 AttributeView.js.From AttributeView.js 我在执行一个选择查询时从 AttributeDatabase.js 调用一个函数。现在查询结果应该转到 AtttributeView.js。但是 Websql 事务是异步调用，就是这样没有返回正确的结果。有什么方法可以处理 websql 结果。请问有什么办法吗？

**已编辑**

```
AttributeView.js

var AttributeDAOObj = new AttributeDAO();

AttributeDAOObj.GetAttributeList();
alert(AttributeDAOObj.GetAttributeList());  //This alert is coming as undefined.   

AttributeDAO.js
this.GetAttributeList = function () {
    var baseDAOObj = new BaseDAO();
    var query = "SELECT AttributeName FROM LOGS";
    //  this.Successcalbackfromsrc = this.myInstance.Successcalback;
    var parm = { 'query': query, 'Successcalback': this.myInstance.Successcalback };
    baseDAOObj.executeSql(parm);
}

//To Create database and execute sql queries.
function BaseDAO() {
this.myInstance = this;
//Creating database
this.GetMobileWebDB = function () {
    if (dbName == null) {
        var dbName = 'ABC';
    }
    var objMobileWebDB = window.openDatabase(dbName, "1.0", dbName, 5 * 1024 * 1024);
    return objMobileWebDB;
}

//Executing queries and getting result 
this.executeSql = function (query) {
    var objMobileWebDB = this.myInstance.GetMobileWebDB();
    objMobileWebDB.transaction(function (transaction) {
 //In this transaction i m returning the result.The result value is coming.
        transaction.executeSql(query, [], function (transaction, result) { return result; }, this.Errorclback);
    });
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-13T08:56:08.270

问题在于您成功回电（如 DCoder 对您问题的评论中所述）

```
 function (transaction, result) { return result; } 
```

这是返回到哪里？

所以这是如何做到的（或至少一种方式）

例如，您可以这样做：

```
function (transaction,result){
   console.log("yes, I have some result, but this doesn't say anything, empty result gives also a result");
   // so check if there is a result:
    if (result != null && result.rows != null) {
       if (result.rows.length == 0) {
            // do something if there is no result
       }else{
            for ( var i = 0; i < result.rows.length; i++) {
                var row = result.rows.item(i);
                var id = result.rows.item(i).id; //supposing there is an id in your result
                console.log('Yeah! row id = '+id);
            }
        }
    }else{
       // do something if there is no result
    }
}; 
```

请注意，上面的代码可以更紧凑，但这是更好地理解它的方法。

另一种方法是把这个函数放在一段单独的代码中，这样你就可以保持sql语句更加紧凑和可读。就像你叫你错误回调一样，它可以在你的函数中（在它前面有 this.）或一个完全独立的函数。

# mongodb - 无法在 MongoDB 中进行简单查询（AND OR NOT）

> ID：15665345
> 
> 赞同：0
> 
> 时间：2013-03-27T17:23:11.127
> 
> 标签：mongodb, nosql

给定一个像这样的集合：

```
> db.test.find({}, {_id:0})
{ "name" : "star wars I", "duration" : 120 }
{ "name" : "star wars II", "duration" : 125 }
{ "name" : "star wars III", "duration" : 135 }
{ "name" : "star wars IV", "duration" : 115 }
{ "name" : "star trek I", "duration" : 135 }
{ "name" : "star trek II", "duration" : 200 }
{ "name" : "alien", "duration" : 200 } 
```

如何进行与此 SQL 语句等效的查询？

```
SELECT * FROM test
WHERE (name LIKE '%star%' AND NOT name LIKE '%wars%') OR duration = 200 
```

**即使使用更简单的查询，我也无法获得预期的结果，例如：**

这按预期工作：

```
> db.test.find({ name: /star/i, name: /trek/i }, {_id:0})  
{ "name" : "star trek I", "duration" : 135 }  
{ "name" : "star trek II", "duration" : 200 } 
```

但是这个没有返回任何结果。为什么？

```
> db.test.find({ name: /star/i, $not: {name: /trek/i} }, {_id:0}) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:16:41.200

~~此时您必须使用[$ne](http://docs.mongodb.org/manual/reference/operator/ne/)运算符，因为[$not](http://docs.mongodb.org/manual/reference/operator/not/)用于否定其他运算符。~~

编辑：正如彼得在评论中所述，$ne 在这里不起作用（因为正则表达式是一个运算符）。只是您的查询顺序错误。

```
> db.test.find({ name: /star/i, name: { $not: /trek/i } }, {_id:0}) 
```

给定 SQL 的查询应如下所示：

```
> db.test.find({$or:
    [
      { name: /star/i, name: { $not: /trek/i } },
      { duration: 200 }
    ]
  },{_id:0}) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T18:29:47.913

试试这个：
`db.test.find({name: {$regex: /star/i , $not: /trek/i }}, {_id:0});`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T20:03:52.567

您可能希望更改查询，因为“star”一词在“star war”和“star trek”记录中都很常见。

这是一个建议希望对你有帮助

```
db.test.find({name:{$regex:/wars/,$nin:["trek"] }},{_id:0})
{ "name" : "star wars I", "duration" : 120 }
{ "name" : "star wars II", "duration" : 125 }
{ "name" : "star wars III", "duration" : 135 } 
{ "name" : "star wars IV", "duration" : 115 } 
```

# authentication - Sitecore - 阻止访问页面，但仍将其显示在导航中

> ID：15665347
> 
> 赞同：2
> 
> 时间：2013-03-27T17:23:17.423
> 
> 标签：authentication, sitecore

在 Sitecore 中，我拒绝匿名用户访问特定页面。

这可以正常工作，但这也意味着该页面不会出现在导航菜单和站点地图（均为 XSLT）中。

我希望用户能够看到该链接，但是当他们点击它时被重定向到注册/登录页面。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T18:33:15.510

您需要允许匿名用户查看该页面，以便它在菜单和站点地图中可见。

您可以做的是覆盖**Sitecore.Pipelines.HttpRequest.HttpRequestProcessor**以检查页面是否需要登录（例如，通过向模板添加 RequiresLogin True/False），然后检查用户是否已登录（如果未重定向到）您的登录页面。

[这里](http://www.cognifide.com/blogs/sitecore/sitecore-displaying-pages-without-a-language-version/)有一个覆盖 HttpRequestProcessor 的示例

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-27T18:38:56.130

您可以将呈现逻辑包装在 SecurityDisabler 的菜单中，这样即使用户“看不到”它们，它也会呈现所有项目链接。

```
using (SecurityDisabler disabler = new SecurityDisabler())
{
  foreach (Item item in Sitecore.Context.Item.Children)
  {
    ... render the link ...
  }
} 
```

# html - 基于外部 div 测量的画布尺寸（js？）

> ID：15665349
> 
> 赞同：0
> 
> 时间：2013-03-27T17:23:28.170
> 
> 标签：html, layout, canvas, html5-canvas

我有一个布局噩梦。几天来我一直在尝试自己修复它，但现在它变成了这个......

[http://jsfiddle.net/Osceana/yQ3As/2/](http://jsfiddle.net/Osceana/yQ3As/2/)

我只是想让画布跨越该时间线的整个长度，并且我希望它在“所有站点”div 上方结束，无论它移动到哪个窗口。我似乎无法做到这一点。我在javascript中尝试过无济于事。

```
$("#chart").height(
canvasHeight);

$("#chart").width(
timelineWidth); 
```

PS时间线应该有一个我在js中实现的左边距：

```
$("#timeline").css(
    "margin-left", namesWidth); 
```

^ 这出现在我的项目中，但由于某种原因不在 jsfiddle 上。但是在我的项目中，左边距似乎导致水平溢出。我只想让时间轴移动到足以容纳名称的位置，然后它跨越屏幕水平长度的整个其余部分。我将 CSS 的宽度设置为 100%、92% 等，但结果总是很奇怪。是因为左边距百分比不起作用吗？

# 时间线 CSS：

```
 #timeline {
    font-size:15px;
    color:black;
    font-family:Calibri;
    text-align:center;
    margin-top:60px;
    width:100%;
}
    #timeline td {
    width: 4%;
} 
```

# 时间线js：

```
var namesWidth = $("#names").width()

$("#timeline").css(
    "margin-left", namesWidth); 
```

**非常*感谢您的任何见解。我希望我没有要求太多。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T17:58:22.793

**[现场演示](http://fiddle.jshell.net/loktar/yQ3As/10/show/light/)**

[编辑](http://jsfiddle.net/loktar/yQ3As/10/)

你没有设置你的小提琴来使用 jQuery。下面应该让你接近你所需要的。

```
var $chart = $("#chart"),
    spacing = 40,
    canvasHeight = $("#company").position().top - $chart.position().top - spacing,
    windowWidth = $(window).width(),
    namesWidth = $("#names").width();

$chart.width($("#timeline").width());
$chart.height(canvasHeight);

$("#timeline").css("margin-left", namesWidth);
$chart.css("margin-left", namesWidth);

// change on resize
$(window).resize(function () {
    canvasHeight = $("#company").position().top - $chart.position().top - spacing;
    $chart.height(canvasHeight);
}); 
```

# html - HTML = 内部链接不会显示为最新版本

> ID：15665350
> 
> 赞同：0
> 
> 时间：2013-03-27T17:23:29.463
> 
> 标签：html

我有一个主页 (home.html)，其中包含指向单独页面 (pagetwo.html) 的链接。每天都会在目录中复制/替换新版本的 pagetwo.html。

当我打开 home.html 并单击 pagetwo.html 时，我总是得到昨天的报告。如果我刷新页面，我会得到今天的报告。

我无法编辑 pagetwo.html 中的代码，因为这个页面是创建的，每天都复制/替换。唯一是静态的就是 home.html，它有

```
<meta http-equiv="Cache-Control" content="no-cache">
<script>
function timedRefresh(timeoutPeriod) {
setTimeout("location.reload(true);",timeoutPeriod);
}
</script>
<body onload="JavaScript:timedRefresh(10000);"><!--refreshs pages every 10 seconds--> 
```

我可以在我的“<a href="pagetwo.html”>“第二页中放入任何内容以确保它立即刷新，以便在第一次尝试时显示正确的 pagetwo.html。

谢谢

# wix - 获取属性时出错

> ID：15665352
> 
> 赞同：1
> 
> 时间：2013-03-27T17:23:36.123
> 
> 标签：wix, wix2

所以..我有这个 CA

`<CustomAction Id="InstallSetProp" Property="CustomActionData" Value="<some other data that's formatted exactly the same> /webconftmploc=&quot;[WEBCONFIGTMPLOC]&quot;" />`

但是，当调用此 CA 时，会显示一个消息框，显示“错误获取属性”，这是虚假的，因为该属性已正确设置并且稍后可以访问。（除了搞乱我完全自动化安装的尝试之外什么都不做）我正在通过一个引导程序运行 .msi，该引导程序会切换`/qr`以帮助解决这个问题。

`/webconftmploc=&quot;[WEBCONFIGTMPLOC]&quot;`删除时未显示消息框错误，因为记录`[WEBCONFIGTMPLOC]`是绝对文件路径或“未设置”，我想知道是否有任何特殊原因导致此行为发生。

但是，当然，我对抑制或修复此操作的任何可能方式更感兴趣。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T20:31:40.447

这只`CustomAction`设置了一个属性。它不可能显示错误消息。如果没有定义任何属性，它们只会解析为空白。必须有其他东西显示错误消息。

但是，由于您使用了特别命名的`CustomActionData`. 不过，这不是完全的使用方式`CustomActionData`。相反，该属性*也*`Property`应设置为`Id`您`CustomAction`要传递数据的属性。假设使用该属性值的自定义操作类似于：

 *```
<CustomAction Id='MyDeferredCustomAction' Execute='deferred' ... /> 
```

要将您尝试发送的字符串传递给它，您可以编写：

```
<CustomAction Id="InstallSetProp"
              Property="MyDeferredCustomAction"
              Value="<some other data that's formatted exactly the same> /webconftmploc=&quot;[WEBCONFIGTMPLOC]&quot;" /> 
```

请注意，第二个自定义操作正在设置一个与延迟自定义操作同名的属性：`MyDeferredCustomAction`。可以通过魔法属性访问该`MyDeferredCustomAction`值。您可以在此处阅读更多相关信息：http: [//msdn.microsoft.com/en-US/library/2w2fhwzz (v=VS.80).aspx](http://msdn.microsoft.com/en-US/library/2w2fhwzz(v=VS.80).aspx)`<some other data that's formatted exactly the same> /webconftmploc="value_of_WEBCONFIGIMPLOC_goes_here"``CustomActionData`*

# inheritance - 为什么 Dart 不继承构造函数？

> ID：15665354
> 
> 赞同：8
> 
> 时间：2013-03-27T17:23:41.090
> 
> 标签：inheritance, dart

我来自 PHP 世界，很好奇为什么开发人员选择不将构造函数（带 arg）添加到继承中的方式。在我看来，根据结构重复大量代码违反了 DRY 原则。我做了很少的研究——PHP、Ruby、Python 继承了构造函数。Java、C#、C++ 不是。C++0x 具有显式定义继承的新特性。

那么程序员没有继承构造函数并一次又一次地显式编写构造函数有什么好处吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-07-04T14:34:19.303

我对梅森的解释并不完全满意，所以我做了一些研究。

我发现语言设计者选择省略构造函数继承有两个关键原因，我可以更好地理解它们。

第一个原因是版本控制——如果在基类中引入了新的构造函数，或者在基类中更改了构造函数签名，子类将继承这些更改，这可能会导致不可预知的副作用。

这个问题经常出现在各种类型的框架中，通常，框架 API 的一部分由您希望扩展的类或您要实现的抽象类组成 - 如果框架类中的构造函数签名发生变化，您会继承这些更改，大多数情况下这些更改是没有意义的。这被称为“[脆弱基类](http://en.wikipedia.org/wiki/Fragile_base_class)”问题。

第二个原因更多是哲学方面的，并且与第一个密切相关。当你构造一个实例时，构造函数定义你的类对你的要求，作为那个类的消费者——所以它是关于类本身的*需求*。将此与定义类的实际行为的方法进行对比——它与类的*作用*有关。基于此，哲学论点是继承是关于*行为*，而不是关于*需求*。

这两个论点实际上是同一枚硬币的两个方面：可以说，构造函数继承是脆弱的*，因为*构造函数定义了一个类的*需求*——例如，期望基类的作者能够预测所有需求是不合理的你的扩展课程。

或者，至少，做出这种假设（就像某些语言所做的那样）会大大限制基类的有用性，因为您只能在扩展类中引入新*行为，而永远不会引入任何新**需求*。

我想到的另一件事是完整性问题 - 这是个人喜好问题，但是在继承构造函数的语言中，我经常发现你必须做很多挖掘基类才能学习和理解所有构造给定类的实例的不同方式。

如果构造函数不能被继承，这将迫使任何类的作者明确说明期望构造类的实例的所有方式——即使其中一些构造函数将是完全微不足道的，事实上它们是在类本身中定义的，表明该类的作者确实认为它们很有用，并且必须理解和考虑可能由不同作者编写的基类的所有需求。

与一味地继承基类的需求相反，没有主动论证任何关于基类的需求是否与扩展类的需求一致的考虑。

在实践中，我发现需求不一致。但即使它们确实对齐，被迫考虑它们如何对齐，会导致更高的代码质量，我相信这就是语言设计者选择构造函数的非继承的哲学 - 毕竟，语言只有一样好作为写入其中的代码。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2020-04-08T20:19:23.100

OO 语言总是可以提供一个默认构造函数，它接受与超类构造函数相同的参数，并使用它们调用超类的构造函数。没有真正的理由不这样做，除非您必须考虑这样做并将其设计到语言中。

不提供默认构造函数意味着提供大量样板代码。恰当的例子：我想继承`[GestureDetector][1]`对其构建方法的行为进行微小的更改。GestureDetector 具有`O(30)`构造函数参数，我需要声明并简单地传递给对 super 的调用。这些都不利于我试图解决的问题。我被鼓励复制并粘贴 GestureDetector 的重新实现（它的工作量会减少！），这一切都是因为 GestureDetector 没有提供用于调整其行为的简单挂钩。这本身需要理解 Flutter 的较低层（这很重要）并维护在其大量依赖项发生变化时会中断的代码（这在 Flutter 中经常发生）。

我不同意@mindplay.dk 的论点——如果超类构造函数发生变化，它会影响派生类，无论它是否定义了显式构造函数。大多数时候，简单地接受和传递具有相同名称的参数是正确的想法（很好，因为这可能不涉及新工作）。如果不是，则定义一个新的构造函数将遭受与当前解决方案相同的维护成本。

被迫编写样板代码是语言发展不佳的标志。Dart 当然有很多改进的方法，在这里和其他地方。添加 AST 宏将允许解决此问题和许多其他问题。这些是一流功能的最佳时机（2020 年，人们！）。

有了它，我们可以为构造函数和其他地方实现我们自己缺少的功能：

```
@inherit_super_constructor 
class B extends GestureDetector{ ... } 
```

```
class B extends A{
  @variadic_parameters   // Infers requirements from what is called
  B(*parent_positional, **parent_named, {this.extra}) : super(*parent_positional, **parent_named);

  String extra;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-27T22:38:24.250

我想你可能不得不问 Dart 的设计者这个问题，但是从继承树中省略构造函数的典型原因是一个类可能有特定的构造时操作需要发生。在 java 中（例如），所有对象都继承自 Object，它有一个零值构造函数。

所以如果你想创建一些像这样的对象：

```
public class Foo {
   private final String bar;

   public Foo(String barValue) {
       this.bar = barValue;
   }
} 
```

当有人调用父级的零参数构造函数时会发生什么，你会有一些不确定性：

```
Foo bla = new Foo(); // runtime error or is bar null? 
```

当然，与所有语言特性一样，您可以想办法指定这种行为，但显然 java 和 dart 的设计者不喜欢其中任何一种。

最后，我认为这一切都归结为哲学：php、ruby 等朝着减少打字的方向发展，而 java、C#、dart 等倾向于朝着更多打字和更少空间的方向发展为混乱。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-11-08T04:25:14.733

你可以试试下面的..

```
main(){
  ParentData parentData = SettingsData.fromJson();
}

abstract class ParentData{
  ParentData.formJson();
}

class SettingsData extends ParentData{
  SettingsData.fromJson():super.formJson(){
    print("Child json");
  }
} 
```

输出：子 json

# c# - ASP.NET MVC 4：在 Javascript 中更改隐藏字段的值

> ID：15665355
> 
> 赞同：9
> 
> 时间：2013-03-27T17:23:43.310
> 
> 标签：c#, jquery, asp.net-mvc, razor, asp.net-mvc-4

我有一个**隐藏的布尔**字段：

```
@Html.HiddenFor(x => x.IsTurkey) 
```

在 jQuery 脚本中，我尝试更改它：

```
$("@Html.IdFor(x => x.IsTurkey)").val("False"); 
```

但是在回邮 IsTurkey 上并没有改变：

```
 HttpPost]
    [ValidateAntiForgeryToken]
    public ActionResult Search(TurkeyModel model)
    { ...} 
```

如上所述使用 jQuery，如何更改MVC 4 中**隐藏**的布尔字段的值？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-27T17:29:03.853

确保在 Jquery 选择器中包含前导 #，因为 MVC HtmlHelper 不会输出它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-27T17:26:33.080

我不确定您的确切代码`IdFor`，但您可以简单地执行以下操作：

```
$("#IsTurkey").val(false); 
```

# ruby - 将txt文件的内容实时流式传输到rails视图

> ID：15665356
> 
> 赞同：1
> 
> 时间：2013-03-27T17:23:44.307
> 
> 标签：ruby, file-io

当文件更新时，将文件内容流式传输到网页的最简单方法是什么。

我目前有一个`.txt`在脚本运行时不断更新的文件，我想在更新时在页面上为用户显示该文件。

有没有简单的宝石或技术来实现这一点？或者有没有一个优秀的纯 Ruby 方法？

我的第一个想法是使用某种 AJAX 请求来返回文件的差异，但我觉得这是一个不好的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T15:18:03.903

我使用[Tony Arcieri 的 Celluloid's Reel](https://github.com/celluloid/reel)来完成此任务。

我在后台运行它（在这部分从[Adam Dalton](https://twitter.com/fladamd)那里得到了很多帮助）：

**my_reel.rb**

```
require 'reel'

CONNECTIONS = []
Reel::Server.supervise("0.0.0.0", 5000) do |connection|
 while request = connection.request
   case request
     when Reel::Request
       puts "Client requested: #{request.method} #{request.url} #{request.body}"
       CONNECTIONS.each do |c|
         c << request.body
       end
       request.respond :ok, 'YES! YOU GOT IT!'
     when Reel::WebSocket
       puts "Client made a WebSocket request to: #{request.url}"
       CONNECTIONS << request
       break
   end
 end
end

sleep 
```

然后我编写了一个命令行脚本来向 Reel 服务器发送 post 请求。[从Jesse Storimer 的编写尊重管道的 Ruby 脚本](http://www.jstorimer.com/2011/12/12/writing-ruby-scripts-that-respect-pipelines.html)中获得了很多帮助。

**~/bin/serve_it_up**

```
#!/usr/bin/env ruby

require 'httparty'

ARGF.each_line do |line|
  output_line = line.chop
  HTTParty.post 'http://localhost:5000', body: output_line                                                                                                                                   
end 
```

然后为了使其工作，我的 Rails 应用程序使用 Sidekiq ( `bundle exec sidekiq`)，并在单击按钮时在后台运行脚本，将输出发送到文件`output.txt`. 所以我运行一个强制尾部并将其输出到我的命令行脚本。

```
tail -f output.txt | serve_it_up 
```

在我的网络应用程序中，我有一些 JavaScript（在本例中为咖啡脚本）连接到网络套接字并将输出放在页面上：

```
connection = new WebSocket('ws://localhost:5000')

connection.onmessage = (event) ->
  $('#prompt').append(event.data + '<br/>')
  prompt = document.getElementById('prompt')
  prompt.scrollTop = prompt.scrollHeight 
```

因此，只要 output.txt 发生变化，它就会从中获取输出`tail -f`并将其放入 Web 浏览器中。我还将`#prompt`div 设置为具有有限高度的样式，并且始终将其滚动到底部。

这是它的风格：

```
#prompt {
  font-family: Consolas, Menlo, Monaco, Lucida Console, Liberation Mono, DejaVu Sans Mono, Bitstream Vera Sans Mono, Courier New, monospace, serif;
  height: 200px;
  overflow: auto;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T17:29:28.503

您可以考虑使用 Faye 或 gem [private_pub](https://github.com/ryanb/private_pub)（它使 Faye 频道私有）之类的东西，它允许您使用 Web 套接字或长轮询将新数据推送到客户端。Github 页面上有很多文档，还有 RailsCast。

然后，在您的应用程序或脚本中，您可以发布到服务器，该服务器会将新数据推送到所有订阅的频道。

# javascript - 如何使用外部 routes.js，这样我就不必在 app.js 中定义我的路由了？

> ID：15665362
> 
> 赞同：4
> 
> 时间：2013-03-27T17:24:01.000
> 
> 标签：javascript, node.js, express

我想在快递中做一个简单的链接。我放入 index.jade

```
a(href='/test', title='View test page') Test 
```

在 /routes 中创建一个 test.js

```
/*
* GET test page.
*/

exports.test = function(req, res){
res.render('test', { title: 'Genious test' });
}; 
```

和 /views 中的一个简单 test.jade

```
extends layout

block content
h1= title
p Test page 
```

我在 app.js 中添加了

```
app.get('/test', routes.test); 
```

如果我单击链接，我会收到错误消息

```
Cannot GET /test 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-27T17:55:03.030

行。在您的 app.js 中添加以下行，您的问题将得到解决。

```
var test = require('./routes/test.js')

app.get('/test', test.test); 
```

这肯定会允许您的应用程序运行并且链接处于活动状态。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-11T06:59:17.957

而不是创建***routes/test.js***，将其添加到***routes/index.js***

```
exports.test = function(req, res){
    res.render('test', { title: 'Test' });
}; 
```

然后**app.get('/test', routes.test);** 将按预期工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-08-19T04:02:08.440

这对我有用：

添加

```
exports.newpage = function(req, res){
  res.render('newpage');
}; 
```

到 /routes/index.js。然后添加

```
app.get('/newpage', routes.newpage); 
```

在下面

```
app.get('/', routes.index); 
```

在 server.js（或 app.js）的底部。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-09-16T07:57:32.457

事后几个月，我将以不同的方式回答这个问题。你只是想让它工作并且你有一个解决方案让它工作。但是，如果您真的想要另一个`routes.js`来处理您的更多路线怎么办？恐惧不是节点可以处理这个！

假设这种结构，

```
- app.js
- routes/
  -  index.js
  -  foo.js 
```

而且，假设你想要你的语法`app.js`

```
app.get('/test', routes.foo.test); 
```

为此，`routes.js`另外，

```
var foo = exports.foo = require('./foo'); 
```

然后在`app.js`你会有，

```
var routes = require('./routes'); 
```

这会起作用，它可以让你说`app.js`，

```
app.get('/test', routes.foo.test); 
```

这将为您提供另一个层次来组织您的路线。我通常喜欢将我所有的路线组织在`routes`对象下，但如果你想直接导入 main 你也可以，

```
var foo = require('./routes/foo');
app.get('/test', foo.test); 
```

# javascript - 使用 iframe 中的父表单捕获点击

> ID：15665373
> 
> 赞同：0
> 
> 时间：2013-03-27T17:24:27.470
> 
> 标签：javascript, jquery, html, iframe

我有一个包含 iframe 的父页面。iframe 内部是一个标签。在父页面上，我可以在按下该标签时触发事件吗？我知道如果我将捕获事件的 javascript 放置在 iframe 中，那么它将起作用，但对于我的项目，我需要让父页面捕获它。到目前为止，这是我的代码。家长代码：

```
 <html>
<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js" type="text/javascript"></script>
 <script type="text/javascript">
 var $MyFrame= $("#myiframe");
 $MyFrame.on("click", "a", function (e) {
         alert("hello");
     });
</script>
</head>
<body>
<iframe id="myiframe" height="3500" width="950" src="Iframe page" frameborder="0" style="display: block; margin: 10px auto;"></iframe>
</body>
</html> 
```

这是我在 iframe 中的页面：

```
<html>
<head>
</head>
<body>
<a href="www.google.com">Click Me!</a>
</body>
</html> 
```

这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T17:27:57.993

不确定，但`.contents()`如果帧源位于同一来源，这可以帮助您：

```
 var $MyFrame= $("#myiframe");
 $MyFrame.contents().find('a').on("click", function (e) {
     alert("hello");
 }); 
```

我注意到你已经分配了一个`id`并且你正在引用那个框架`class`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T17:29:35.880

你的`myiframe`is`id`而不是`class`.. 使用 id 选择器`#`

试试这个

```
var $MyFrame= $("#myiframe");
$MyFrame.on("click", "a", function (e) {
     alert("hello");
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T17:32:32.750

```
var $MyFrame = $("#myiframe");

// You need to wait for the iFrame content to load first
// So, that the click events work properly
$MyFrame.load(function () {
    var frameBody = $MyFrame.contents().find('body');
    frameBody.find('a').click(function () {
        // here is the iframe a click callback
        alert("hello");
    });
}); 
```

# silverlight - 当鼠标悬停在silverlight中的内部对象上时，未触发父对象鼠标事件

> ID：15665374
> 
> 赞同：0
> 
> 时间：2013-03-27T17:24:33.867
> 
> 标签：silverlight

我的 XAML 中有一个矩形，它充当文本框的容器（文本框显示在矩形上），我可以通过拖动它来移动矩形（使用矩形对象的 mousedown 和 mousemove 事件），但是文本框有问题覆盖了我的矩形的很大一部分，因此当用户单击鼠标（并尝试移动它）时，他们很有可能实际单击文本框，因此矩形鼠标事件不会触发并且没有任何作用！（即不可能移动）。我该如何克服这个问题？（我使用 SL 5 和 VS 2012）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:20:06.580

TextBox 控件处理鼠标按下事件并阻止它们在可视树上冒泡。（如果您使用的是画布，但冒泡事件无济于事）

您可以通过代码将自己的事件处理程序添加到鼠标事件中，例如

```
txtbox.AddHandler(TextBox.MouseLeftButtonDownEvent, 
                  new MouseButtonEventHandler(<your handler>), true); 
```

您的处理程序具有签名的位置：

```
 private void <your handler>(object sender, MouseButtonEventArgs e)
        {

        } 
```

让我知道您的具体情况是否需要更多信息。

# javascript - Facebook 的 __d 方法的目的是什么？

> ID：15665383
> 
> 赞同：0
> 
> 时间：2013-03-27T17:24:52.080
> 
> 标签：javascript, facebook

我注意到 Facebook 所做的一些有趣的事情，我想知道他们在做什么以及为什么？如果你在他们的一个 .js 文件上查看他们的源代码，他们似乎做了很多这样的事情：

```
__d("AjaxRequest",["Erro...
__d("FBAjaxRequest",["AjaxRequest"...
__d("CallbackManagerController",... 
```

他们的任何 JavaScript 文件中似乎都没有变量或普通函数和对象。有函数，但所有参数都传递给这个 __d 方法，如下所示：

```
__d("keyMirror",[],function(a,b,c,d,e,f){var g=function(h){var i={},j;if(!h)return h;for(j in h){if(!h.hasOwnProperty(j))continue;i[j]=j;}return i;};e.exports=g;}); 
```

这是对 JavaScript 的某种优化，还是用于更轻松的管理？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T17:26:39.667

也许只是一个执行依赖注入和错误处理之类的包装器。如果你能找出`__d`定义在哪里，你肯定会知道。

它看起来不像是优化（即打包器）。

# javascript - 使用 QUERY 或仅使用 CSS 的水平树/组织结构图/uml？

> ID：15665384
> 
> 赞同：1
> 
> 时间：2013-03-27T17:24:57.447
> 
> 标签：javascript, jquery, charts, tree, uml

想知道是否有人有任何指向 jquery 插件或任何其他项目的指针，这些项目允许创建水平树/组织结构图，如下例所示：

[http://www.yworks.com/products/yfilessilverlight/Demo.yFiles.Graph.Collapse.html](http://www.yworks.com/products/yfilessilverlight/Demo.yFiles.Graph.Collapse.html)

或者

[https://google-visualization-api-issues.googlecode.com/issues/attachment?aid=470030000&name=tech_tree3.jpg&token=r1J_Ga0ZN1bupa8yNB_SLFTFMcI%3A1364399622331&inline=1](https://google-visualization-api-issues.googlecode.com/issues/attachment?aid=470030000&name=tech_tree3.jpg&token=r1J_Ga0ZN1bupa8yNB_SLFTFMcI%3A1364399622331&inline=1)

不使用 flash 或 silveright 的东西... javascript/jquery/css 是理想的，尤其是具有可折叠功能的！

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T17:30:19.407

您可以使用 JIT ( [http://philogb.github.com/jit/demos.html](http://philogb.github.com/jit/demos.html) ) 空间树

[http://philogb.github.com/jit/static/v20/Jit/Examples/Spacetree/example1.html](http://philogb.github.com/jit/static/v20/Jit/Examples/Spacetree/example1.html)

再举一个例子

[http://codecanyon.net/item/jquery-horizo​​ntal-tree/4294567?sso?WT.ac=category_item&WT.seg_1=category_item&WT.z_author=jscode](http://codecanyon.net/item/jquery-horizontal-tree/4294567?sso?WT.ac=category_item&WT.seg_1=category_item&WT.z_author=jscode)

# python - 用于 OS X 的 Numpy-MKL

> ID：15665385
> 
> 赞同：6
> 
> 时间：2013-03-27T17:24:58.237
> 
> 标签：python, macos, numpy, python-3.3, intel-mkl

我喜欢能够在 Windows 上使用[Christoph Gohlke 的`numpy-MKL`](http://www.lfd.uci.edu/~gohlke/pythonlibs/#numpy)链接[`NumPy`](http://www.numpy.org)到英特尔的[数学内核库](http://software.intel.com/en-us/intel-mkl)的版本。但是，我一直无法为 OS X 找到类似的版本，最好是为 Mountain Lion 上的 Python 3.3 链接的 NumPy 1.7。有谁知道这可能在哪里获得？

**编辑：**

因此，经过一番寻找，我发现[了这个链接](http://software.intel.com/en-us/intel-math-kernel-library-evaluation-options)来评估英特尔 Composer XE2013 工作室的 C++ 和 Fortran（两者都包含 MKL），以及一个关于用它构建 NumPy 和[SciPy的](http://www.scipy.org)[教程](http://software.intel.com/en-us/articles/numpyscipy-with-intel-mkl)，所以这将适用于目前。然而，问题仍然存在 - 是否有类似于 Christoph Gohlke 的 OS X 经常更新的存档？如果不是，为什么不呢？:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-09-23T20:20:29.507

英特尔已根据社区许可发布了他们的 MKL，该许可是免费的，但技术支持有限。目前，社区许可下的 MKL 可用于 Linux 和 Windows，预计它们将很快提供适用于 Mac OS X 的版本。

[https://software.intel.com/en-us/comment/1839012](https://software.intel.com/en-us/comment/1839012)

在他们最近的一次网络研讨会中，我询问了他们在社区许可下的 Mac OS X MKL 计划。他们说它很快就会到来。

**更新 2：**

Continuum 为 Anaconda Python 提供了包括英特尔 MKL 在内的所有平台。

[https://www.anaconda.com/blog/developer-blog/anaconda-25-release-now-mkl-optimizations/](https://www.anaconda.com/blog/developer-blog/anaconda-25-release-now-mkl-optimizations/)

英特尔甚至可以轻松编译和链接来自 Anaconda Python 发行版的 MKL。

[https://software.intel.com/en-us/articles/using-intel-distribution-for-python-with-anaconda](https://software.intel.com/en-us/articles/using-intel-distribution-for-python-with-anaconda)

**更新：**

现在看来，英特尔有自己的 Python 版本，正在提供给 beta 测试人员。

[https://software.intel.com/en-us/forums/intel-distribution-for-python/topic/581593](https://software.intel.com/en-us/forums/intel-distribution-for-python/topic/581593)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-02-18T00:21:30.607

我知道这是一个较老的问题，但如果有人正在搜索：我建议尝试[anaconda](https://store.continuum.io/cshop/anaconda/)。只需 29.00 美元，他们就有一个包含 mkl 优化的 numpy + scipy 的附加组件。

# android - 如何从库项目中的项目中获取资源

> ID：15665386
> 
> 赞同：5
> 
> 时间：2013-03-27T17:24:58.483
> 
> 标签：android, android-resources

情况如下：我有两个项目。让我们说 a`LibraryProject`和 a `MainProject`。`MainProject`引用`LibraryProject`作为库。

我有一个活动`LibraryProject`需要发现是否`MainProject`定义了特定的可绘制对象，比如说“logo.png”（认为徽标图像必须由每个`MainProject定义，而不是由LibraryProject定义。

如何在 的一项活动中`LibraryProject`发现文件夹`MainProject`中是否有此图像`res/drawable`？

显然我试图查看是否 `R.drawable.logo != 0`（或它的变体），但如您所知，这一行将无法编译，因为图像`res/drawable`不在`LibraryProject`.

我也试过`getResources().getIdentifier("logo", "drawable", null) != 0`，但这个布尔表达式总是返回 false，因为`.getIdentifier()`总是返回零。

任何的想法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-27T17:36:41.323

你可以试试这个：（但请记住，上下文总是“ChildProject”）

```
public static Drawable getDrawable(Context context, String resource_name){
    try{
        int resId = context.getResources().getIdentifier(resource_name, "drawable", context.getPackageName());
        if(resId != 0){
            return context.getResources().getDrawable(resId);
        }
    }catch(Exception e){
        Log.e(TAG,"getDrawable - resource_name: "+resource_name);
        e.printStackTrace();
    }

    return null;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T17:28:46.333

您需要在图书馆项目中提供默认资源。如果您的 中存在同名资源`MainProject`，它将覆盖 Library Project 资源。

例如，如果您在两个项目中都提供“res/drawable/logo.png”，那么`R.drawable.logo`在库项目中将使用 MainProject 的“res/drawable”文件夹中的“logo.png”图像。

* * *

*这个答案没有解决图书馆项目应该如何发现主项目是否有资源，只是如何强制使用它，如果有的话。*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T17:29:21.333

让您的主项目将上下文传递给库，然后调用 context.getString()。

# vb.net - Visual Basic：如何同时运行 2 个循环？

> ID：15665394
> 
> 赞同：1
> 
> 时间：2013-03-27T17:25:23.153
> 
> 标签：vb.net, loops, console, simultaneous

我的代码有问题。

我正在尝试在菜单屏幕上的选项两侧设置闪烁的图标，以表示用户当前的选择。问题是我希望能够同时闪烁光标并读取用户输入移动光标位置的键。有没有办法可以做到这一点，或者比我目前拥有的设置更简单。

非常感谢任何帮助，因为我仍在学习，谢谢。

```
Sub Main()
    Dim KeyPressed As String
    Dim Pos As Integer
    Dim MenuSelection As Integer = 1
    PreStuff()
    DisplayMenu()
    Cursor(MenuSelection, False)
    Do
        KeyPressed = GetKeyPressed()
        If KeyPressed = "ConsoleKey.DownArrow" And Pos = 1 Then
            MenuSelection = 2
        ElseIf KeyPressed = "ConsoleKey.DownArrow" And Pos = 2 Then
            MenuSelection = 1
        ElseIf KeyPressed = "ConsoleKey.UpArrow" And Pos = 1 Then
            MenuSelection = 2
        ElseIf KeyPressed = "ConsoleKey.UpArrow" And Pos = 2 Then
            MenuSelection = 1
        End If
    Loop Until KeyPressed = "ConsoleKey.Enter"
    Cursor(0, True)
End Sub

Sub PreStuff()
    Console.Title = "Populatio - Pre Alpha"
    Console.SetWindowSize(80, 25)
    Console.CursorVisible = False
End Sub

Function GetKeyPressed()
    Dim KeyChoice As String
    KeyChoice = Console.ReadKey().ToString
    Return KeyChoice
End Function

Sub Cursor(ByVal Op As Integer, ByVal State As Boolean)
    Do
        Select Case Op
            Case 1 And State = False
                Console.SetCursorPosition(32, 5)
                Console.Write("►")
                Console.SetCursorPosition(43, 5)
                Console.Write("◄")
                State = True
            Case 1 And State = True
                Console.SetCursorPosition(32, 5)
                Console.Write(" ")
                Console.SetCursorPosition(43, 5)
                Console.Write(" ")
                State = False
            Case 2 And State = False
                Console.SetCursorPosition(34, 7)
                Console.Write("►")
                Console.SetCursorPosition(41, 7)
                Console.Write("◄")
                State = True
            Case 2 And State = True
                Console.SetCursorPosition(34, 7)
                Console.Write(" ")
                Console.SetCursorPosition(41, 7)
                Console.Write(" ")
                State = False
        End Select
        System.Threading.Thread.Sleep(500)
    Loop Until Op = 0
    Console.SetCursorPosition(32, 5)
    Console.Write(" ")
    Console.SetCursorPosition(43, 5)
    Console.Write(" ")
    Console.SetCursorPosition(34, 7)
    Console.Write(" ")
    Console.SetCursorPosition(41, 7)
    Console.Write(" ")
End Sub

Sub DisplayMenu()
    Console.WriteLine("╔═════════════════════════════════════════════════════════════════════════════╗")
    Console.WriteLine("║                            Populatio! By Alx                                ║")
    Console.WriteLine("╠═════════════════════════════════════════════════════════════════════════════╣")
    Console.WriteLine("║                                                                             ║")
    Console.WriteLine("║                                 New Game                                    ║")
    Console.WriteLine("║                                                                             ║")
    Console.WriteLine("║                                   Exit                                      ║")
    Console.WriteLine("║                                                                             ║")
    Console.WriteLine("║                                                                             ║")
    Console.WriteLine("║                                                                             ║")
    Console.WriteLine("║                                                                             ║")
    Console.WriteLine("║                                                                             ║")
    Console.WriteLine("║                                                                             ║")
    Console.WriteLine("║                                                                             ║")
    Console.WriteLine("║                                                                             ║")
    Console.WriteLine("║                                                                             ║")
    Console.WriteLine("║                                                                             ║")
    Console.WriteLine("║                                                                             ║")
    Console.WriteLine("║                                                                             ║")
    Console.WriteLine("║                                                                             ║")
    Console.WriteLine("║                                                                             ║")
    Console.WriteLine("║                                                                             ║")
    Console.WriteLine("║                                                                             ║")
    Console.WriteLine("║                                                                             ║")
    Console.Write("╚═════════════════════════════════════════════════════════════════════════════╝")
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T17:29:46.783

除非您有问题地拆分功能以便它基本上可以在单个循环中运行 - 您需要在单独的*线程*中运行每个循环。一个复杂的主题，但值得学习：

[http://msdn.microsoft.com/en-us/library/eed6swsx(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/eed6swsx(v=vs.80).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-01T08:36:32.830

尽管正如 Brad 所说，多线程可能是前进的方向，但您也许可以使用**DoEvent**方法实现您想要的，该方法告诉系统在继续之前先处理其他事件。

尝试在之前粘贴 DoEvents

```
 Loop Until KeyPressed = "ConsoleKey.Enter" 
```

这将允许 Cursor 方法再次运行，因此循环将变为...

```
Do
    KeyPressed = GetKeyPressed()
    If KeyPressed = "ConsoleKey.DownArrow" And Pos = 1 Then
        MenuSelection = 2
    ElseIf KeyPressed = "ConsoleKey.DownArrow" And Pos = 2 Then
        MenuSelection = 1
    ElseIf KeyPressed = "ConsoleKey.UpArrow" And Pos = 1 Then
        MenuSelection = 2
    ElseIf KeyPressed = "ConsoleKey.UpArrow" And Pos = 2 Then
        MenuSelection = 1
    End If
    DoEvents
Loop Until KeyPressed = "ConsoleKey.Enter" 
```

# git - Opscode Chef - 清理 /shared/cached-copy 的方法

> ID：15665397
> 
> 赞同：3
> 
> 时间：2013-03-27T17:25:27.310
> 
> 标签：git, chef-infra, pipeline, chef-recipe, cookbook

我们在管道中使用 Opscode Chef，我们注意到部署（请参阅[http://docs.opscode.com/resource_deploy.html](http://docs.opscode.com/resource_deploy.html)）将我们的源代码的完整副本创建到 /shared/cached-copy

它的 .git/object 文件夹中已经有近千个完整版本（不仅仅是增量！），因此文件大小增长和增长。

有什么办法可以清理甚至完全防止这种情况？我们根本不需要它。

当然，我可以在每次部署后写一些东西来删除目录，但是有没有好的方法来处理这个？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-26T13:21:10.923

我们看到了一些不同的东西。在我们的例子中，我们使用子模块。删除子模块时， git pull 不会删除旧的子模块目录。所以我们只剩下垃圾了。缓存副本被复制到带有这个额外代码的版本中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-01T01:11:00.767

缓存副本是有目的的，当 git 从远程拉取更改时，缓存副本仅用于拉取丢失的内容，仅此而已。然后这个缓存的副本使用 git 克隆到一个新的修订版本，当 git 克隆同一个磁盘上的存储库时，它会创建硬链接——所以你的 .git/objects 不会重复，它们是所有“副本”共享的相同文件。我建议你不要动这个目录，它实际上很重要。

# c# - 将 2D 视口平移转换为 3D 旋转

> ID：15665399
> 
> 赞同：0
> 
> 时间：2013-03-27T17:25:27.300
> 
> 标签：c#, wpf, math, 3d, geometry

我正在尝试参考 2D 视口旋转 3D 圆柱体。已知圆柱体的半径和 2D 平移，我怎样才能找出它转动的角度？

![我想知道的插图](../Images/15e37b345849e254687b1de18335b13c.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T20:22:04.170

让我们假设圆柱体从 A 旋转到 B。此外，让我们假设 A 是`θ`逆时针度数，B 是`θ`从水平方向顺时针旋转的度数。因此，A 和 B 之间的夹角为`2θ`。

A 的 y 坐标由 给出`r*sin(θ)`，B 的 y 坐标就是`-r*sin(θ)`。

因此，`2*r*sin(θ) = D`（平移距离）

求解`θ`：

```
θ = asin(D/(2*r)) 
```

（其中 asin 是反正弦函数）

另一种（可能更稳健）的方法是计算三角形的垂线和底边，然后执行`atan2(perp,base)`.

垂直是简单`D/2`的，而基地是`sqrt(R*R - D*D/4)`。

# java - 使用 java.nio 写入文件

> ID：15665400
> 
> 赞同：2
> 
> 时间：2013-03-27T17:25:33.327
> 
> 标签：java, io, nio

我必须使用 java.nio 通过填充数据来创建任何所需大小的文件。我正在阅读文档，但对何时需要翻转、放置或书写并出现错误感到困惑。我已经使用 .io 成功完成了这个程序，但我正在测试 .nio 是否会让它运行得更快。

到目前为止，这是我的代码。args[0] 是您要创建的文件的大小，args[1] 是要写入的文件的名称

```
public static void main(String[] args) throws IOException
 {
     nioOutput fp = new nioOutput();
     FileOutputStream fos = new FileOutputStream(args[1]);
     FileChannel fc = fos.getChannel();

     long sizeOfFile = fp.getFileSize(args[1]);      
     long desiredSizeOfFile = Long.parseLong(args[0]) * 1073741824; //1 Gigabyte = 1073741824 bytes      
     int byteLength = 1024;      
     ByteBuffer b = ByteBuffer.allocate(byteLength);

     while(sizeOfFile + byteLength < desiredSizeOfFile)
     {  
    // b.put((byte) byteLength);
     b.flip();
     fc.write(b);
     sizeOfFile += byteLength;       
     }
     int diff = (int) (desiredSizeOfFile - sizeOfFile);
     sizeOfFile += diff;

     fc.write(b, 0, diff);

     fos.close();
     System.out.println("Finished at " + sizeOfFile / 1073741824  + " Gigabyte(s)");                
 }

long getFileSize(String fileName) 
{
    File file = new File(fileName);        
    if (!file.exists() || !file.isFile()) 
    {
        System.out.println("File does not exist");
        return -1;
    }
    return file.length();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T03:24:50.783

如果您想要做的只是将文件预扩展为带有空值的给定长度，您可以在三行中完成并保存所有 I/O：

```
RandomAccessFile raf = new RandomAccessFile(file, "rw");
raf.setLength(desiredSizeOfFile);
raf.close(); 
```

这将像您现在尝试执行的操作一样快数倍。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-27T18:25:33.720

对不起大家，我想通了。

```
 while(sizeOfFile + byteLength < desiredSizeOfFile)
     {           
     fc.write(b);
     b.rewind();
     sizeOfFile += byteLength;       
     }
     int diff = (int) (desiredSizeOfFile - sizeOfFile);
     sizeOfFile += diff;

     ByteBuffer d = ByteBuffer.allocate(diff);

     fc.write(d);
     b.rewind();

     fos.close();
     System.out.println("Finished at " + sizeOfFile / 1073741824  + " Gigabyte(s)");                
 } 
```

# google-apps-script - 如何使用 Google Apps 脚本隐藏 Google 电子表格中的图像？

> ID：15665401
> 
> 赞同：2
> 
> 时间：2013-03-27T17:25:34.943
> 
> 标签：google-apps-script, google-sheets

我正在 Google 电子表格中构建一个仪表板，并希望在隐藏/显示某些行时包含一些要显示的图像。这可能吗？我使用 insertImage 插入图像，但找不到删除或隐藏图像的方法（隐藏行不会影响图像）。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:33:45.060

为什么不直接使用电子表格原生函数 =Image(URL,section)，它会和单元格一起显示或隐藏

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T18:15:08.010

没有直接的方法可以从 Apps Script API 中删除图像。即使删除一行，图像仍会保留。

[您应该在问题跟踪器 ( http://code.google.com/p/google-apps-script-issues/issues/list](http://code.google.com/p/google-apps-script-issues/issues/list) )中提出对此功能的请求。

编辑：看起来这个[https://code.google.com/p/google-apps-script-issues/issues/detail?id=64](https://code.google.com/p/google-apps-script-issues/issues/detail?id=64)已经有一个非常老的问题了。除了那里提到的解决方法

# perl - 使用 perl 下载序列文件

> ID：15665403
> 
> 赞同：-1
> 
> 时间：2013-03-27T17:25:37.443
> 
> 标签：perl, bioinformatics, bioperl

我正在尝试使用 perl 从基因库数据库下载序列文件，但它显示错误。我没有任何指南来纠正我的程序。

谁能帮我这个？错误在第 6 行 ( `use Bio::DB::GenBank;`)

文件 accnumber.txt 在我的桌面上，我正在从桌面本身运行程序。我正在使用 CentOS。

```
#!usr/bin/perl -w

use strict;
use warnings;

use Bio::DB::GenBank;

open (INPUT_FILE, 'accnumber.txt');
open (OUTPUT_FILE, 'sequence_dwnl.fa');

while()
{
    chomp;
    my $line = $_;
    my @acc_no = split(",", $line);
    my $counter = 0;

    while ($acc_no[$counter])
    {
        $acc_no[$counter] =~ s/\s//g;

        if ($acc_no[$counter] =~ /^$/)
        {
            exit;
        }

        my $db_obj = Bio::DB::GenBank->new;
        my $seq_obj = $db_obj->get_Seq_by_acc($acc_no[$counter]);
        my $sequence1 = $seq_obj->seq;

        print OUTPUT_FILE "&gt;"."$acc_no[$counter]","\n";
        print OUTPUT_FILE $sequence1,"\n";
        print "Sequence Downloaded:", "\t", $acc_no[$counter], "\n";

        $counter++;
    }
}

close OUTPUT_FILE;
close INPUT_FILE; 
```

这些是我得到的错误：

```
Bareword "Bio::DB::GenBank" not allowed while "strict subs" in use at db.pl line 6.
Bareword "new" not allowed while "strict subs" in use at db.pl line 27.
Bareword "seq" not allowed while "strict subs" in use at db.pl line 29.
Execution of db.pl aborted due to compilation errors. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T19:35:44.250

[`Bio::DB::GenBank`由于您提到从 CPAN](https://metacpan.org/module/Bio%3a%3aDB%3a%3aGenBank)加载外部 Perl 模块，我首先想到的是：该模块是否安装在您的系统上？

尝试`cpan Bio::DB::GenBank`以 root 身份运行命令（例如，通过在它前面加上`sudo`）。即使安装了模块，这也不应该受到伤害，在这种情况下，它会检查 CPAN 是否有更新。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-03-27T18:53:41.300

除了上面的答案，

请使用`die`功能检查文件是否被打开。

```
open (INPUT_FILE, 'accnumber.txt');
open (OUTPUT_FILE, 'sequence_dwnl.fa'); 
```

像这样：

```
open (my $input_file, '<', 'accnumber.txt') or die "Could not open because $!\n";
open (my $output_file, '<', 'sequence_dwnl.fa') or die "Could not open because $!\n"; 
```

另外，请指定使用这些运算符打开每个文件的目的：

1.  `<`以*只读*模式打开文件。
2.  `>`*覆盖*文件内容。
3.  `>>`*附加*文件内容。

另外请检查您是否`Bio::DB::GenBank`安装了模块。

您可以通过在命令行中运行它来做到这一点：

`perldoc -l Bio::DB::GenBank`或者`perl -MBio::DB::GenBank -e 1`

# ajax - 扩展 UIInput 时，getClientBehaviors() 方法未从 UIComponentBase 继承

> ID：15665405
> 
> 赞同：0
> 
> 时间：2013-03-27T17:25:38.597
> 
> 标签：ajax, jsf-2, custom-component, mojarra

我目前正在阅读 Core JavaServer Faces(3e) 书。

我正在尝试运行本书第 11 章中的 ajax spinner 代码。

我正在为 Eclipse、weblogic 10.3.5 服务器和 Mojarra impl 使用 Oracle 企业包。

但 UISpinner 类显示以下错误消息：

> “UISpinner 类型必须实现继承的抽象方法 ClientBehaviorHolder.getClientBehaviors()”</p>

但是，根据 jsf 规范 - UIComponentBase 类实现了由 UISpinner 类继承的 getClientBehaviors() 方法。仍然为什么我收到此错误？请帮忙。

这是 UISpinner 类的实现：

```
package com.corejsf;

import java.util.Arrays;
import java.util.Collection;
import java.util.List;
import java.util.Map;

import javax.faces.component.FacesComponent;
import javax.faces.component.UIInput;
import javax.faces.component.behavior.ClientBehavior;
import javax.faces.component.behavior.ClientBehaviorHolder;
import javax.faces.convert.IntegerConverter;

@FacesComponent("com.corejsf.Spinner")
public class UISpinner extends UIInput implements ClientBehaviorHolder {

   private static List<String> eventNames = Arrays.asList("click");

   public UISpinner() {
      setConverter(new IntegerConverter()); 
         // to convert the submitted value
      setRendererType("com.corejsf.JSSpinner");  
         // this component has a renderer
   }

   public String getDefaultEventName() { return "click"; }

   public Collection<String> getEventNames() { return eventNames; }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T18:25:51.063

你正在发生的事情有点棘手。没错，UIInput 扩展了 UIComponentBase，它确实实现了 getClientBehaviors()。但是，您正在实现 ClientBehaviorHolder，它有一个公共的 getClientBehaviors() 方法。

您正在实现的类必须具有该方法，并且显然它不能来自您正在扩展的类。我要做的是使用一个简单的空返回值来实现该方法，例如：

```
return Collections.emptyMap(); 
```

# python - Pypy (python) 优化

> ID：15665429
> 
> 赞同：2
> 
> 时间：2013-03-27T17:27:11.787
> 
> 标签：python, bubble-sort, pypy

我正在考虑用 python 代码替换一些 C 代码并使用 pypy 作为解释器。该代码做了很多列表/字典操作。因此，为了对 pypy 与 CI 的性能有一个模糊的了解，我正在编写排序算法。为了测试我所有的读取函数，我用 python 和 C++ 编写了一个冒泡排序。CPython 当然是 6.468 秒，pypy 是 0.366 秒，C++ 是 0.229 秒。然后我记得我在C++代码上忘记了-O3，时间到了0.042s。对于带有 -O3 的 32768 数据集，C++ 只有 2.588 秒，而 pypy 是 19.65 秒。我可以做些什么来加快我的python代码（当然除了使用更好的排序算法）或者我如何使用pypy（一些标志或其他东西）？

Python 代码（read_nums 模块省略，因为它的时间很简单：32768 数据集上的 0.036 秒）：

```
import read_nums
import sys

nums = read_nums.read_nums(sys.argv[1])

done = False

while not done:
    done = True

    for i in range(len(nums)-1):
        if nums[i] > nums[i+1]:
            nums[i], nums[i+1] = nums[i+1], nums[i]
            done = False

$ time pypy-c2.0 bubble_sort.py test_32768_1.nums   
real    0m20.199s
user    0m20.189s
sys     0m0.009s 
```

C 代码（read_nums 函数再次省略，因为它需要很少的时间：0.017s）：

```
#include <iostream>
#include "read_nums.h"

int main(int argc, char** argv)
{
    std::vector<int> nums;
    int count, i, tmp;
    bool done;

    if(argc < 2)
    {
        std::cout << "Usage: " << argv[0] << " filename" << std::endl;
        return 1;
    }

    count = read_nums(argv[1], nums);

    done = false;

    while(!done)
    {
        done = true;

        for(i=0; i<count-1; ++i)
        {
            if(nums[i] > nums[i+1])
            {
                tmp = nums[i];
                nums[i] = nums[i+1];
                nums[i+1] = tmp;
                done = false;
            }
        }
    }

    for(i=0; i<count; ++i)
    {
        std::cout << nums[i] << ", ";
    }

    return 0;
}

$ time ./bubble_sort test_32768_1.nums > /dev/null  
real    0m2.587s
user    0m2.586s
sys     0m0.001s 
```

**PS**第一段中给出的一些数字与时间的数字略有不同，因为它们是我第一次得到的数字。

**进一步的改进：**

*   刚刚尝试了 xrange 而不是 range，运行时间达到了 16.370 秒。
*   将函数中的代码`done = False`从头到尾`done = False`移动，现在速度为 8.771-8.834s。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T17:34:52.263

回答这个问题最相关的方法是注意 C、CPython 和 PyPy 的速度并没有恒定因素的差异：它最重要的是取决于所做的事情和编写的方式。例如，如果您的 C 代码正在执行诸如遍历数组之类的幼稚操作，而“等效”Python 代码自然会使用字典，那么只要数组足够长，Python 的任何实现都比 C 更快。当然，大多数现实生活中的例子并非如此，但同样的论点仍然适用于较小的范围。没有一种万能的方法来预测用 C 编写或用 Python 重写并在 CPython 或 PyPy 上运行的程序的相对速度。

显然有关于这些相对速度的指导方针：在小的算法示例中，您可以预期 PyPy 的速度接近“gcc -O0”的速度。在您的示例中，它“仅”慢了 1.6 倍。我们可能会帮助您优化它，甚至发现 PyPy 中缺少的优化，以便将速度提高 10% 或 30%。但这是一个与您的实际程序无关的小例子。由于上述原因，我们在这里得到的速度只是与你最终得到的速度有模糊的关系。

我只能说，为了清楚起见，将代码从 C 重写为 Python，特别是当 C 变得过于纠结而无法进一步开发时，从长远来看显然是一种胜利——即使在最后你需要的情况下再次用 C 重写它的某些部分。PyPy 的目标是减少对此的需求。虽然说再也没有人需要 C 会很好，但事实并非如此`:-)`

# c# - Unity 注入中的后期绑定名称

> ID：15665431
> 
> 赞同：0
> 
> 时间：2013-03-27T17:27:21.740
> 
> 标签：c#, .net, dependency-injection, unity-container

我正在尝试使以下代码正常工作：

```
 _container.RegisterType<string>(
            new InjectionFactory((ctr, @type, name) =>
                SomeDictionary[name])); 
```

但是它不起作用，因为上面的字符串是在没有名称的情况下注册的。

但是，在注册时，该名称是未知的。我需要能够以某种方式将名称延迟到解决时间。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T16:18:40.853

Unity 容器默认不支持此功能。您可能会编写一个容器扩展来使其工作，但在首先尝试替代方法之前我不会走这条路。

你已经说*了*你想做什么。*你为什么*要这样做？了解潜在目标将有助于找出实现目标的其他方法。

# google-api - Freebase MQL 查询以通过 alpha 3 代码检索国家/地区描述

> ID：15665432
> 
> 赞同：1
> 
> 时间：2013-03-27T17:27:24.267
> 
> 标签：google-api, freebase, mql

我一直在尝试提出适当的 MQL 查询来检索国家/地区描述，例如文本 api 的执行方式。

[https://www.googleapis.com/freebase/v1/text/en/jamaica](https://www.googleapis.com/freebase/v1/text/en/jamaica)

**那个电话的结果。**

> “结果”：“牙买加（/dʒəˈmeɪkə/），正式名称为牙买加联邦，是大安的列斯群岛的一个岛国，长 234 公里（145 英里），宽达 80 公里（50 英里），面积 10,990 平方公里（4,240 平方英里）的面积。

我不能使用 text/topic api，因为我需要使用 alpha 2/alpha 3 代码来收集这些信息。这是我进行查询的尝试。

> [{“id”：null，“name”：null，“/common/topic/description”：null，“type”：“/location/country”，“/location/country/iso_alpha_3”：“USA”}]

当我运行此查询时，未填充 common/topic/description 字段。有没有其他方法可以检索国家/地区的描述并按字母代码 3 过滤？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:10:24.080

您可以使用[Freebase 主题 API](https://developers.google.com/freebase/v1/topic-overview)执行此操作：

```
https://www.googleapis.com/freebase/v1/topic/authority/iso/3166-1/alpha-3/JAM?filter=/common/topic/description 
```

请确保您按照 API 响应中的指定正确注明来源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T18:40:31.517

ISO 国家代码在以 /authority 为根的命名空间中注册，这些标识符可以与 /en 或 /m 命名空间中的标识符互换使用。只需将适当的 ID 替换为您的 Text API 调用，例如

[https://www.googleapis.com/freebase/v1/text/authority/iso/3166-1/alpha-3/USA](https://www.googleapis.com/freebase/v1/text/authority/iso/3166-1/alpha-3/USA)

# c++ - C ++：将一个操作数保存在寄存器中带来了惊人的加速

> ID：15665433
> 
> 赞同：70
> 
> 时间：2013-03-27T17:27:25.753
> 
> 标签：c++, c, performance, optimization, assembly

我一直在尝试通过使用以下代码对数组元素进行缩放和求和的例程定时来了解在 L1 缓存中拥有数组与内存的影响（我知道我应该只通过'来缩放结果a' 在最后；关键是在循环中同时进行乘法和加法 - 到目前为止，编译器还没有想出分解'a'）：

```
double sum(double a,double* X,int size)
{
    double total = 0.0;
    for(int i = 0;  i < size; ++i)
    {
        total += a*X[i];
    }
    return total;
}

#define KB 1024
int main()
{
    //Approximately half the L1 cache size of my machine
    int operand_size = (32*KB)/(sizeof(double)*2);
    printf("Operand size: %d\n", operand_size);
    double* X = new double[operand_size];
    fill(X,operand_size);

    double seconds = timer();
    double result;
    int n_iterations = 100000;
    for(int i = 0; i < n_iterations; ++i)
    {
        result = sum(3.5,X,operand_size);
        //result += rand();  
    }
    seconds = timer() - seconds; 

    double mflops = 2e-6*double(n_iterations*operand_size)/seconds;
    printf("Vector size %d: mflops=%.1f, result=%.1f\n",operand_size,mflops,result);
    return 0;
} 
```

请注意，为简洁起见，不包括 timer() 和 fill() 例程；如果您想运行代码，可以在此处找到它们的完整源代码：

[http://codepad.org/agPWItZS](http://codepad.org/agPWItZS)

现在，这就是有趣的地方。这是输出：

```
Operand size: 2048
Vector size 2048: mflops=588.8, result=-67.8 
```

这完全是未缓存的性能，尽管 X 的所有元素都应该在循环迭代之间保存在缓存中。查看由以下生成的汇编代码：

```
g++ -O3 -S -fno-asynchronous-unwind-tables register_opt_example.cpp 
```

我注意到 sum 函数循环中的一个奇怪之处：

```
L55:
    movsd   (%r12,%rax,8), %xmm0
    mulsd   %xmm1, %xmm0
    addsd   -72(%rbp), %xmm0
    movsd   %xmm0, -72(%rbp)
    incq    %rax
    cmpq    $2048, %rax
    jne L55 
```

说明：

```
 addsd   -72(%rbp), %xmm0
    movsd   %xmm0, -72(%rbp) 
```

表示它将 sum() 中“total”的值存储在堆栈上，并在每次循环迭代时读取和写入它。我修改了程序集，使这个操作数保存在一个寄存器中：

```
...
addsd   %xmm0, %xmm3
... 
```

这个微小的变化创造了**巨大**的性能提升：

```
Operand size: 2048
Vector size 2048: mflops=1958.9, result=-67.8 
```

**tl; dr** 我的问题是：为什么用寄存器替换单个内存位置访问会大大加快代码速度，因为单个位置应该存储在 L1 缓存中？哪些架构因素使这成为可能？重复写入一个堆栈位置会完全破坏缓存的有效性，这似乎很奇怪。

**附录**

我的 gcc 版本是：

```
Target: i686-apple-darwin10
Configured with: /var/tmp/gcc/gcc-5646.1~2/src/configure --disable-checking --enable-werror --prefix=/usr --mandir=/share/man --enable-languages=c,objc,c++,obj-c++ --program-transform-name=/^[cg][^.-]*$/s/$/-4.2/ --with-slibdir=/usr/lib --build=i686-apple-darwin10 --with-gxx-include-dir=/include/c++/4.2.1 --program-prefix=i686-apple-darwin10- --host=x86_64-apple-darwin10 --target=i686-apple-darwin10
Thread model: posix
gcc version 4.2.1 (Apple Inc. build 5646) (dot 1) 
```

我的CPU是：

英特尔至强 X5650

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2013-03-27T17:45:03.713

它可能是较长的依赖链以及负载错误预测*的组合。

* * *

**更长的依赖链：**

首先，我们确定关键的依赖路径。然后我们看看提供的指令延迟：[http](http://www.agner.org/optimize/instruction_tables.pdf) ://www.agner.org/optimize/instruction_tables.pdf （第117页）

在未优化版本中，关键依赖路径为：

*   `addsd -72(%rbp), %xmm0`
*   `movsd %xmm0, -72(%rbp)`

在内部，它可能分解为：

*   负载（2 个周期）
*   添加（3 个周期）
*   存储（3 个周期）

如果我们查看优化版本，它只是：

*   添加（3 个周期）

所以你有 8 个周期与 3 个周期。几乎是 3 倍。

我不确定 Nehalem 处理器系列对存储负载依赖项的敏感程度以及它在[转发](http://en.wikipedia.org/wiki/Memory_disambiguation#Store_to_load_forwarding)方面的表现如何。但有理由相信它不为零。

* * *

**加载存储错误预测：**

现代处理器以您可以想象的更多方式使用预测。其中最著名的可能是[分支预测](https://stackoverflow.com/questions/11227809/why-is-processing-a-sorted-array-faster-than-an-unsorted-array)。鲜为人知的一种是负载预测。

当处理器看到负载时，它将在所有挂起的写入完成之前立即加载它。它将假定这些写入不会与加载的值冲突。

如果较早的写入结果与加载冲突，则必须重新执行加载并将计算回滚到加载点。（与分支错误预测回滚的方式大致相同）

它在这里是如何相关的：

不用说，现代处理器将能够同时执行该循环的多次迭代。因此，处理器将尝试执行加载（在它完成上一次迭代`addsd -72(%rbp), %xmm0)`的存储（ ）之前）。`movsd %xmm0, -72(%rbp)`

结果？先前的存储与负载冲突 - 因此是错误预测和回滚。

[*请注意，我不确定“负载预测”的名称。我只在英特尔文档中读到过它，他们似乎没有给它起名字。]

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-03-27T17:56:54.830

我推测问题不在于缓存/内存访问，而在于处理器（执行代码）。这里有几个可见的瓶颈。

这里的性能数字基于我使用的盒子（sandybridge 或 westmere）

标量数学的峰值性能是 2.7Ghz x2 FLOPS/Clock x2，因为处理器可以同时进行加法和乘法运算。代码的理论效率为0.6/(2.7*2) = 11%

所需带宽：每 (+) 和 (x) 2 个双倍 -> 4bytes/Flop 4 bytes * 5.4GFLOPS = 21.6GB/s

如果您知道它最近被读取，它可能在 L1 (89GB/s)、L2 (42GB/s) 或 L3(24GB/s) 中，因此我们可以排除缓存 B/W

内存子系统为 18.9 GB/s，因此即使在主内存中，峰值性能也应接近 18.9/21.6GB/s = 87.5 %

*   可能希望尽早批处理请求（通过展开）

即使是推测性执行，tot += a *X[i] 添加也会被序列化，因为 tot(n) 需要在 tot(n+1) 可以启动之前进行评估

第一个展开循环
将 i 移动 8 位并执行

```
{//your func
    for( int i = 0; i < size; i += 8 ){
        tot += a * X[i];
        tot += a * X[i+1];
        ...
        tot += a * X[i+7];
    }
    return tot
} 
```

使用多个累加器
这将打破依赖关系并允许我们避免在加法管道上停滞

```
{//your func//
    int tot,tot2,tot3,tot4;
    tot = tot2 = tot3 = tot4 = 0
    for( int i = 0; i < size; i += 8 ) 
        tot  += a * X[i];
        tot2 += a * X[i+1];
        tot3 += a * X[i+2];
        tot4 += a * X[i+3];
        tot  += a * X[i+4];
        tot2 += a * X[i+5];
        tot3 += a * X[i+6];
        tot4 += a * X[i+7];
    }
    return tot + tot2 + tot3 + tot4;
} 
```

更新在 SandyBridge 盒子上运行后，我可以访问：（2.7GHZ SandyBridge with -O2 -march=native -mtune=native

原始代码：

```
Operand size: 2048  
Vector size 2048: mflops=2206.2, result=61.8  
2.206 / 5.4 = 40.8% 
```

改进的代码：

```
Operand size: 2048  
Vector size 2048: mflops=5313.7, result=61.8  
5.3137 / 5.4 = 98.4% 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-03-27T17:43:33.080

我实际上无法重现这一点，因为我的编译器（gcc 4.7.2）保存`total`在一个寄存器中。

我怀疑缓慢的主要原因与 L1 缓存无关，而是由于存储在

```
movsd   %xmm0, -72(%rbp) 
```

以及后续迭代的负载：

```
addsd   -72(%rbp), %xmm0 
```

# c# - 从 linq 查询中的不同对象中选择数据

> ID：15665435
> 
> 赞同：1
> 
> 时间：2013-03-27T17:27:44.907
> 
> 标签：c#, asp.net, linq

我对 LINQ 还是很陌生，遇到了一些麻烦。我认为这一切都搞砸了，但我有一个模型，其中包含多个属性和不同类型的对象（项目）。我收到一个错误：无法将类型“AnonymousType#1”转换为“字符串”。我希望能够从我的 NotificationModel 对象中引用的 ProjectModel 对象中选择 ProjectId 和 ProjectName。这就是我所拥有的，但这不起作用，我怎样才能改变它以正确地从 ProjectModel 对象中获取信息？

通知模型：

```
public int id { get; set; }
public int ProjectId { get; set; }
public string ProjectName { get; set; }
[StringLength(50)]
public string CreatedBy { get; set; }
public Nullable<System.DateTime> CreatedDateTime { get; set; }
public Nullable<bool> IsDeleted { get; set; 

public virtual ProjectModel Project { get; set; } 
```

尝试检索数据：

```
 var notifications = (from a in db.NotificationsLog
                            where a.CreatedBy == userID
                            orderby a.CreatedDateTime ascending
                            select new NotificationModel
                            {
                                id = a.id,
                                ProjectId =  from p in db.Projects
                                          select new
                                                    {
                                                        ProjectId = p.ProjectId
                                                    }
                                ProjectName = from p in db.Projects
                                          select new

                                                    {
                                                        ProjectName = p.ProjectName
                                                    }
                                Notes = a.Notes;
                            }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T18:00:29.200

如果您的`Notification`实体上有导航属性 to `Project`，您可以这样做：

```
var notifications = 
    (from a in db.NotificationsLog
     let p = a.Project
     where a.CreatedBy == userID
     orderby a.CreatedDateTime ascending
     select new NotificationModel
     {
         id = a.id,
         ProjectId = p.Id,
         ProjectName = p.Name,
         Project = new ProjectModel
         {
             ProjectId = p.Id
             ProjectName = p.Name
             Notes = a.Notes;
         }
     }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T18:02:53.103

```
var notifications = from a in db.NotificationsLog
                    join p in db.Projects on a.ProjectId equals p.ProjectId
                    where a.CreatedBy == userID
                    select new NotificationModel
                            {
                                id = a.id,
                                ProjectId = p.ProjectId,
                                ProjectName = p.ProjectName,
                                Notes = a.Notes
                            }; 
```

# c++ - C ++动态检测参数类别并对其进行强制转换

> ID：15665436
> 
> 赞同：1
> 
> 时间：2013-03-27T17:27:45.327
> 
> 标签：c++, c++11, operator-overloading

我有两个类，一个继承自另一个。基类的相关部分如下（显然这个类有ctors、dtor等，尤其是一个`operator[]`，但我认为那些与手头的事情无关）：

```
#include <array>

template < class T, unsigned int N >
class Vector
{
public:
    template < class U, unsigned int M > friend Vector< U, M > operator+ ( const Vector< U, M >&, const Vector< U, M >& );

    template < class U, unsigned int M > friend std::ostream& operator<< ( std::ostream&, const Vector< U, M >& );
}; 
```

派生类（同样，显然我已经删除了那些我认为不相关的部分）：

```
#include "Vector.h"

template < class T, unsigned int N >
class Polynomial
    : public Vector< T, N >
{
public:
    template < class U, unsigned int M > friend std::ostream& operator<< ( std::ostream&, const Polynomial< U, M >& );
}; 
```

（注意：友元函数对模板使用的字母与类不同，因为否则 gcc 会抱怨“阴影”。不过，逻辑是相同的。）

`Vector`s 以一种方式打印出来（例如`< 3, 5, 1 >`）；`Polynomial`s 打印出另一个（例如`3 x^2 + 5 x + 1`）。

但是，这会导致问题。当我将两个`Polynomial`s 相加时，编译器使用`template < class U, unsigned int M > Vector< U, M > operator+ ( const Vector< U, M >&, const Vector< U, M >& )`，它当然会返回一个`Vector`。因此，如果我尝试执行类似的操作`std::cout << poly1 + poly2;`，则结果显示格式错误。

我想修改`template < class U, unsigned int M > Vector< U, M > operator+ ( const Vector< U, M >&, const Vector< U, M >& )`它以检测其参数的实际数据类型，并相应地转换返回值（例如，`Polynomial`如果将两个`Polynomial`s 传递给它，则返回 a ）。如果可能的话，我想这样做，而不`operator+`知道每个可能的子类`Vector`（我认为这可能是一个合理的愿望？），并且不`operator+`为每个子类创建一个新函数（因为我还有其他几个重载的运算符，并且希望避免为每个派生类复制几乎完全相同的代码十次）。

我知道这在 Python 中是可能的（事实上，相对容易）。C++ 支持这样的事情吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T18:08:25.543

如果将结果计算为`Vector<T,N>`，则不能简单地（合法地）将其转换为`Polynomial<T,N>`。要达到预期的效果，您需要进行一些更深层次的修改。您需要一个免费`operator+`的、可以提供所需结果类型的实现以及一种检测从`Vector<T,N>`. 让我们构建它。

a) 检测所有`Vector<T,N>`

为此，您可以从一个空基类派生，该基类将被空基优化 (EBO) 优化掉，并且可以通过以下方式检测`std::enable_if`：

```
struct VectorBase {};

template< class T, unsigned int N >
class Vector
{
  // ...
}; 
```

现在您可以检查任何类`U`是否派生自`Vector< T, N >`with `std::is_base_of< VectorBase, U >::value`。为了绝对正确，您需要排除`VectorBase`自身 ( `!std::is_same< U, VectorBase >::value`)，但您的用例可能不需要这样做。

b) 提供所需返回类型的实现。*在*我们这样做之前：

```
template< class T, unsigned int N >
class Vector
{
    template < class U, unsigned int M >
    friend Vector< U, M > operator+ ( const Vector< U, M >&, const Vector< U, M >& );
}; 
```

应替换为：

```
template< class T, unsigned int N >
class Vector
{
    friend Vector< T, N > operator+ ( const Vector< T, N >&, const Vector< T, N >& );
}; 
```

对于一般情况。但是你需要一个特殊的返回类型，它以后可以变成`Polynomial<T,N>`，所以：

```
template< class T, unsigned int N >
class Vector
{
public:
    template< typename R >
    static R add( const Vector< T, N >& lhs, const Vector< T, N >& rhs )
    {
        static_assert( std::is_base_of<VectorBase,R>::value,
                       "R needs to be derived from Vector<T,N>" );
        R result;
        // implement it here...
        return result;
    }
}; 
```

c) 提供一个`operator+`调用`add`并受 SFINAE 保护的：

```
// as a free function:
template< typename V >
typename std::enable_if< std::is_base_of< VectorBase, V >::value, V >::type
operator+( const V& lhs, const V& rhs )
{
  return V::template add<V>( lhs, rhs );
} 
```

减去一些小错别字（我还没有测试过），这个策略应该适合你。

# java - 不返回我的值用户和密码

> ID：15665439
> 
> 赞同：0
> 
> 时间：2013-03-27T17:27:59.973
> 
> 标签：java, ajax

我正在使用 Java + AJAX 登录，我有以下代码：

以我的形式：

```
<s:form id="formulario" action="javascript:validaUsuario();" method="get" >
  <s:textfield key="usuario" name="usuario" /> <br/>
  <s:password key="password" name="password" /> <br />
  <div style="float:left; padding-left:100px; padding-top:20px">
    <s:submit value="Enviar" />
  </div>
</s:form> 
```

当我输入用户名和密码时，信息不会发送到 actionLogin。

**验证用户**

```
javascript:validaUsuario()

function validaUsuario(
){
    alert($("#usuario").val());
    $.get("login2.action",{usuario:$("#usuario").val(), password:$("#password").val()}
    ,okusuario);

    return false;
}

function okusuario(data){

    if(data["rol"]==0){
        $("#error").text("Usuario / Contraseña incorrecto");
    }
    else{
        $("#usuario").html(data["user.login"]);

        }

} 
```

**struts.xml**

```
<action name="login2" class="com.gustavomasana.action.LoginAction" method="buscaRol">
            <result name="success">index.jsp</result>
</action> 
```

**登录操作.java**

```
public class LoginAction extends ActionSupport {

    private Collection<Usuario> Usuario;
    private Usuario user;
    private Integer rol;
    private String usuario;
    private String password;
    private String pagina;
    private String error;

    public String buscaRol()  {

        rol = Usuario_bo.buscaRol(usuario, password);
        if (rol==0){
            error = "El usuario / contraseña es incorrecto. ";
        }
        else{
            Map session = ActionContext.getContext().getSession();
            user=Usuario_bo.buscaUsuario(usuario, password);
            session.put("userSesion",user);
        }
        return SUCCESS;
    }

    public Collection<Usuario> getUsuario() {
        return Usuario;
    }

    public void setUsuario(Collection<Usuario> usuario) {
        Usuario = usuario;
    }

    public Usuario getUser() {
        return user;
    }

    public void setUser(Usuario user) {
        this.user = user;
    }

    public Integer getRol() {
        return rol;
    }

    public void setRol(Integer rol) {
        this.rol = rol;
    }

    public String getusuario() {
        return usuario;
    }

    public void setusuario(String usuario) {
        this.usuario = usuario;
    }

    public String getPassword() {
        return password;
    }

    public void setPassword(String password) {
        this.password = password;
    }

    public String getPagina() {
        return pagina;
    }

    public void setPagina(String pagina) {
        this.pagina = pagina;
    }

    public void setUsuario(String usuario) {
        this.usuario = usuario;
    }

    public String getError() {
        return error;
    }

    public void setError(String error) {
        this.error = error;
    } 
```

**为什么？**

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T17:36:15.827

您不应该在 onsubmit 属性而不是 action 属性中插入 javascript 验证吗？就像是

```
<s:form id="formulario" action="somevalidurl" onsubmit="javascript:validaUsuario();" method="get" > 
```

# css - 动态内容的引导模式页脚高度

> ID：15665442
> 
> 赞同：3
> 
> 时间：2013-03-27T17:28:05.000
> 
> 标签：css, twitter-bootstrap

对于模式中的表单，我选择使用引导模式页脚来显示与表单相关的任何错误。当错误不可避免地使页脚占用的高度超过页脚可用的高度时，这会引起一些挫败感。我很好，它需要更多的高度，但我希望它将高度添加到顶部并降低模态主体的高度，以便整个模态保持相同的高度。如果将其添加到底部，则最终会将内容推离屏幕。模态体考虑了太“高”的内容并添加了垂直滚动条，这就是为什么我愿意放弃模态体高度来适应模态页脚高度的原因。

我添加了指向我所指的图像的链接。模态页脚按预期扩展到内容，但将该高度添加到底部，因此模态页脚的其余部分在被推离屏幕时变得不可访问。我想从正文中窃取高度，以便将页脚的附加高度添加到顶部，并且模态的总高度保持相同的大小。

![在此处输入图像描述](../Images/8997054c6d54b5596c2a5b391898afe6.png)

我确定我还没有找到一个简单的解决方案，但我想我会在继续寻找的同时问一下，以防其他人已经找到了他们想要分享的解决方案。任何帮助将非常感激。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T10:33:18.777

通常引导模式使用固定位置。如果内容太大，滚动条会出现在模态框内。

如果您想拥有没有滚动条的长模态，您必须首先将模态定位更改为`absolute`. 但是，如果您的网站内容很长，则必须添加一些`top`属性值。这是因为现在 modal 垂直定位到整个站点，而不是当前浏览器视图，所以 % top 将不再起作用。

```
.modal {
    position: absolute;
    top: 100px;
} 
```

现在滚动你只需使用浏览器滚动条。

接下来要摆脱添加`max-height: inherit`到`modal-body`类的模态滚动条。现在，模式将根据没有滚动条的内容变得更大。

```
.modal .modal-body {
    max-height: inherit;
} 
```

是的，这有一些缺点。最大的问题是，如果您在页面底部启动模式，您甚至可能看不到它，因为它会在页面顶部弹出。对于这个问题，您可以在触发模式后添加 js 滚动顶部脚本。

```
$('#myModal').on('show', function () {
    $("body").animate({
        scrollTop:0
    });
}); 
```

希望有帮助！

# php - cakephp 2 记住我自动登录

> ID：15665443
> 
> 赞同：1
> 
> 时间：2013-03-27T17:28:07.670
> 
> 标签：php, cakephp

我正在尝试设置它，以便当用户登录时有一个记住我的复选框，如果选中该复选框，则会写入一个 cookie 以记住用户的电子邮件和密码。在我的用户控制器登录功能中是这样的：

```
public function login() {
    if (!empty($this->data)) {
        if ($this->Auth->login()) {
            $userId = $this->Auth->user('id');
            if(!empty($this->data['User']['remember'])) {
                $user = $this->User->find('first', array('conditions'=>array('id'=>$userId), 'recursive'=>-1, 'fields'=>array('email', 'password')));
                $this->Cookie->write('User', $user['User']);
            }
... etc etc ... 
```

在 cakephp 1.x 中，我有这个工作，所以在我的 AppController 的 beforefilter 中，我只需查找 cookie 并尝试像这样登录：

```
//try to auto login a users
    if($this->Auth->user() == null) {
        $user = $this->Cookie->read('User');
        if(!empty($user)) {
            $this->Auth->login($user);
        }
    } 
```

但这现在似乎不起作用。我认为因为从我读到的内容中，如果您将任何内容传递给登录函数，它将返回 true。为了正确登录，我需要将该cookie的内容发布到登录功能......

那正确吗？有没有比尝试在某处创建表单并通过大量重定向发布信息更简单的方法？

我还尝试将 cookie 信息添加到 $this->request->data 数组中并尝试登录，但这也不起作用:(

```
//try to auto login a users
if($this->Auth->user() == null) {
    $user = $this->Cookie->read('User');
        if(!empty($user)) {
            $this->request->data['User']['email'] = $user['email'];
            $this->request->data['User']['password'] = $user['password'];
            $this->Auth->login();
        }
    } 
```

谁能帮我吗？必须有一个更简单的方法来做到这一点！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T07:17:26.897

尝试这个..

将此复选框保留在登录 ctp 文件中

```
 <php echo $this->Form->checkbox('remember_me',array("id" => "id_remember_me",'name'=>'remember_me','label' => false)); ?>
 <span onclick="$('#id_remember_me').attr('checked',true);"><?php echo __('Remember my details')?></span> 
```

然后保持这个

```
code in the controller where the $this->Auth->login() is..
     //Setting up the expiry time
     $year = time() + 31536000;
     if($this->request->data['remember_me']) {
     // Creating a cookie in the name of remember_me with the username for the time which was set
          setcookie('remember_me', $this->request->data['User']['username'], $year);
     }
     else if(!$this->request->data['remember_me']) {
         if(isset($_COOKIE['remember_me'])) {
              $past = time() - 100;
              setcookie('remember_me', 'gone', $past);
         }
     } 
```

# git - git 错误：gnutls_handshake() 推送失败

> ID：15665444
> 
> 赞同：6
> 
> 时间：2013-03-27T17:28:11.703
> 
> 标签：git

我已经使用 git 一段时间没有问题，然后突然在使用时开始抛出此错误`git push`：

> 错误：gnutls_handshake() 失败：收到了意外长度的 TLS 数据包。访问时...致命：HTTP 请求失败

它工作正常，然后突然停止。

问题是什么？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T16:40:08.543

`gnutls`包裹好像有问题。作为一种解决方法，您可以尝试`git`使用`openssl`. [您可以在此处](https://askubuntu.com/questions/186847/error-gnutls-handshake-falied)找到有关如何完成此操作的更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-30T19:29:46.370

关于 askubuntu 的链接讨论引用了一个可能与您自己的不匹配的 git 版本号。而不是这两行：

```
sudo dpkg-source -x git_1.7.9.5-1.dsc
cd git_1.7.9.5 8. 
```

您需要考虑您正在使用的 git 版本。就我而言，它是 1.8.xxxxx。

```
sudo dpkg-source -x git_<git-version-number>.dsc
cd git_<git-version-number> 
```

解决此问题的一种简单方法是复制命令的第一部分，然后按 Tab 以自动完成。如果您之前重新编译过，这可能无法完美运行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-04-03T13:19:19.903

在我的情况下，同样的错误是由完全不同的事情引起的。

Debian 从 Wheezy 升级到 Jessie，因此 apache 从 2.2.22 升级到 2.4.10。git 试图推送到*[https://www.example.com](https://www.example.com)*并且它停止使用`error: gnutls_handshake() failed: A TLS packet with unexpected length was received`

事实证明，*www.example.com*解析为 IPv4 和 IPv6 地址，而 apache 配置`<Virtualhost x.y.w.z:443>`只有 IPv4 地址。改变它来`<Virtualhost _default_:443>`解决问题。

（如果它帮助其他人遇到同样的问题......只有在使用 openssl 重新编译 git 后发现它根本没有改变任何东西）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-01-25T08:23:23.230

[这个答案](https://stackoverflow.com/a/21181447/8554611)可能会有所帮助。尽管问题很老，但我很惊讶这些问题无处可联系在一起。

为了确保有用的信息不会丢失，我从问题中复制了一个简短的解决方案：

```
hostname=XXX
port=443
trust_cert_file_location=`curl-config --ca`

sudo bash -c "echo -n | openssl s_client -showcerts -connect $hostname:$port 2>/dev/null  | sed -ne '/-BEGIN CERTIFICATE-/,/-END CERTIFICATE-/p' >> $trust_cert_file_location" 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-02-26T11:47:14.463

我也遇到了同样的问题，后来通过在我的本地机器上禁用我的卡巴斯基防病毒软件来解决这个问题。我希望这对其他人有帮助。 [![错误报告和解决方案](../Images/524bd25736adbc7cdbcb718149db8dcc.png)](https://i.stack.imgur.com/VI51T.png)

# javascript - 在 JavaScript 中的 DOM 节点内搜索和替换

> ID：15665450
> 
> 赞同：0
> 
> 时间：2013-03-27T17:28:24.557
> 
> 标签：javascript, html, dom

我正在创建一个表单，并希望能够根据需要使用 javascript 复制某些 DIV。但是，我需要替换某段文本的多个实例。像这样用功能代码替换注释的东西：

```
<body>

   <div id="duplicate">
      <p>Section_1 of form</p>
      <a href="javascript:add_section()">Add A Section</a>
   </div>

   <script type="text/javascript">
   <!--
      var num_sections = 1;
      function add_section()
      {

         var orig_div=document.getElementById("duplicate")
         var copy_div=orig_div.cloneNode(true);

         //Change every "Section_1" in copy_div to "Section_"+num_sections

         footer = document.getElementById("footer");
         document.body.insertBefore(copy_div,footer);

      }

   //-->
   </script>

   <div id="footer"></div>

</body> 
```

`Section_1`使用 JavaScript，当这些实例位于节内的每个输入标记中时 ，替换每个实例的优雅方法是什么？

我在 CMS 的范围内工作，所以我无法使用更强大的处理语言来实现它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T17:40:05.303

您可以调用`getElementsByTagName`DOM 节点来获取标签标识的一些元素组。

```
var num_sections = 1;
window.add_section = function() {
    var orig_div=document.getElementById("duplicate")
    var copy_div=orig_div.cloneNode(true);

    //Change every "Section_1" in copy_div to "Section_"+num_sections
    num_sections++;
    var p = copy_div.getElementsByTagName('p')[0];
    p.innerHTML = p.innerHTML.replace('Section_1', 'Section_' + num_sections);

    var footer = document.getElementById("footer");
    document.body.insertBefore(copy_div,footer);
}; 
```

这是[jsFiddle](http://jsfiddle.net/LVhLt/1/)

# python - 为 pysimplesoap 服务器正确格式化函数

> ID：15665451
> 
> 赞同：2
> 
> 时间：2013-03-27T17:28:25.243
> 
> 标签：python, soap, pysimplesoap

我正在尝试为现有的 SOAP 客户端构建 SOAP 服务器。我有一个工作正常的简单函数，它只返回一个字符串。现在我正在构建一个更复杂的函数，当我使用 Wireshark 观察流量时，我没有收到任何 SOAP 响应。

这是我的功能：

```
def getMetadata(id, index, count):
print "id =", id
response = {'index': 0,
            'count': 1,
            'total': 1}
return response 
```

我的功能注册：

```
dispatcher.register_function('getMetadata', getMetadata,
                         returns={'getMetadataResult': {'index': int, 'count': int, 'total': int}},
                         args={'id': str, 'index': int, 'count': int}) 
```

我认为我在将 register_function 中的“返回”与我在 getMetadata 中构建的响应匹配时遇到了问题。

作为参考，这是我正在尝试构建的预期 SOAP 响应：

```
<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
  <soap:Body>
    <getMetadataResponse xmlns="<removed>">
      <getMetadataResult>
        <index>0</index>
        <count>3</count>
        <total>3</total>
      </getMetadataResult>
    </getMetadataResponse>
  </soap:Body>
</soap:Envelope> 
```

# c# - 比较日期时间得到不同的结果

> ID：15665454
> 
> 赞同：2
> 
> 时间：2013-03-27T17:28:42.997
> 
> 标签：c#

我需要比较两个日期，包括秒数。我在网上搜索并得到了两种方法。一是进口`Microsoft.VisualBasic dll`。当它运行相同的数据时，结果是不一样的。我认为 C# 应该在不导入 VisualBasic 的情况下做同样的事情。有人可以指点我让它在 C# 中工作的方法吗？

提前致谢。

有一个使用 Microsoft.VisualBasic

```
 if (Math.Abs(DateAndTime.DateDiff(DateInterval.Second, 
     Conversions.ToDate(colFilesFound[RuntimeHelpers.GetObjectValue(rw["file_path"])]),
     Conversions.ToDate(rw["last_modified_timestamp"]), 
     FirstDayOfWeek.Sunday, FirstWeekOfYear.Jan1)) == 0L)
 {
     unchangedFileNum++;
     Console.WriteLine("unchange");
 }
 else
 {
     modifiedFileNum++;
     Console.WriteLine("change");
 } 
```

还有另一种不使用 Visual.dll 的方法：

```
DateTime fileLastModifiedDate = Conversions.ToDate(colFilesFound[rw["file_path"]]);
DateTime dataLastModifiedDate = Conversions.ToDate(rw["last_modified_timestamp"]);
if (Math.Abs((fileLastModifiedDate - dataLastModifiedDate).TotalSeconds) == 0L)
{
     Console.WriteLine("File Date: " + colFilesFound[rw["file_path"]] + 
            " <> Database Date: " + Conversions.ToString(rw["last_modified_timestamp"]));
     unchangedFileNum++;
     Console.WriteLine("unchange");
}
else
{
     modifiedFileNum++;
     Console.WriteLine("change");
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T17:34:19.387

在 .NET 中比较 DateTimes 的正确方法是使用 == 运算符或调用[DateTime.Compare()](http://msdn.microsoft.com/en-us/library/system.datetime.compare.aspx)方法：

```
 DateTime fileLastModifiedDate = ...;
    DateTime dataLastModifiedDate = ...;

    if (fileLastModifiedDate == dataLastModifiedDate)
    {
       ...
    } 
```

你需要考虑**精度**。有时，您没有足够的精度来考虑**毫秒**。在这种情况下，您需要比较日期而不考虑毫秒：

```
public static bool IsSameDateWithoutMilliseconds(DateTime d1, DateTime d2)
{
    return d1.Subtract(d2).TotalSeconds == 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T17:40:36.263

您的问题可能是毫秒，因为这些可能与您检查日期时间的方式不同。

```
DateTime fileLastModifiedDate = Conversions.ToDate(colFilesFound[rw["file_path"]]);
DateTime dataLastModifiedDate = Conversions.ToDate(rw["last_modified_timestamp"]);

fileLastModifiedDate = fileLastModifiedDate.AddMilliseconds(-fileLastModifiedDate.Millisecond);
dataLastModifiedDate = dataLastModifiedDate.AddMilliseconds(-dataLastModifiedDate.Millisecond);

if (DateTime.Compare(fileLastModifiedDate, dataLastModifiedDate) == 0)
{
    // dates are equal
}
else
{
    // dates are not equal
} 
```

# php - 比较以 0 开头的数字的数字大小？

> ID：15665459
> 
> 赞同：0
> 
> 时间：2013-03-27T17:28:48.303
> 
> 标签：php, comparison

我试图在大小方面相互比较数字并选择最接近（最大）的值。

例如，我有一组数字：0541、0555、0789。

还有一个号码：0547。

在这种情况下，0555 将是我想要的数字。

我的代码适用于所有不以 0 开头的数字，但在上面的示例中它失败了。

有任何想法吗？

编辑：应该说清楚，不是所有的数字都以 0 开头，要比较的数字是时间，所以仍然可以从中删除零吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T17:30:37.533

如果您有一个以 a 开头的数字，`0`它将作为字符串进行比较。`intval`在使用（[http://php.net/manual/en/function.intval.php](http://php.net/manual/en/function.intval.php)）进行比较之前将数字转换为整数

# iphone - ios存储自定义对象

> ID：15665465
> 
> 赞同：1
> 
> 时间：2013-03-27T17:29:10.647
> 
> 标签：iphone, ios, smartphone

如何存储`NSMutableArray`自定义对象？我有这个用于加载和保存文件的代码：

```
- (NSMutableArray *)loadDataFromFile:(NSString *)fileName {
    NSError *error;
    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *docDir = [paths objectAtIndex:0];
    NSString *path = [docDir stringByAppendingPathComponent:fileName];
    NSFileManager *fileMgr = [NSFileManager defaultManager];
    if (![fileMgr fileExistsAtPath:path]) {
        NSArray *fileArray = [fileName componentsSeparatedByString:@"."];
        NSString *name = [fileArray objectAtIndex:0];
        NSString *ext = [fileArray objectAtIndex:1];
        NSString *bundle = [[NSBundle mainBundle] pathForResource:name ofType:ext];
        [fileMgr copyItemAtPath:bundle toPath:path error:&error];
    }
    NSMutableArray *data = [[NSMutableArray alloc] initWithContentsOfFile:path];
    return data;
}

- (void)saveData:(NSMutableArray *)arrayData toFile:(NSString *)filename forKey:(NSString *)key {
    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *docDir = [paths objectAtIndex:0];
    NSString *path = [docDir stringByAppendingPathComponent:filename];
    [arrayData writeToFile: path atomically:YES];
    NSLog(@"%@", arrayData);
} 
```

但是当我用作`data.plist`文件名时，它不起作用，因为`NSLog(@"%@", arrayData);`返回列表自定义对象地址：

> “区域表记录：0x76a7ef0”

使用以下代码将此自定义对象插入到数组中：

```
AreaTableRecord *area=[[AreaTableRecord alloc] init];
        area.title=title;
        area.lastScore=0;
        area.vocabulary=[[NSMutableArray alloc] init];
        [self.areas addObject:area]; 
```

如何存储`NSMutableArray` `self.areas`包含自定义对象 AreaTableRecord？我应该使用什么文件格式来存储这些数据？（在我看来 plist 在这种情况下不起作用）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T17:36:03.763

您只能将原始数据类型存储在 NSDefaults 或 plist 中。为了解决这个问题，您可以选择将您的信息存储在数据库中......或将您的对象编码为字节流，然后将它们保存到文件中。

看看这个[线程](http://iphonedevsdk.com/forum/iphone-sdk-development/16205-saving-class-nsuserdefaults.html)。它详细介绍了如何对对象进行编码。

基本上，您需要将这些方法添加到您的自定义类中：

```
- (void)encodeWithCoder:(NSCoder *)encoder
{
       //Encode properties, other class variables, etc
    [encoder encodeObject:self.question forKey:@\"question\"];
    [encoder encodeObject:self.categoryName forKey:@\"category\"];
    [encoder encodeObject:self.subCategoryName forKey:@\"subcategory\"];
}

- (id)initWithCoder:(NSCoder *)decoder
{
    self = [super init];
    if( self != nil )
    {
               //decode properties, other class vars
        self.question = [decoder decodeObjectForKey:@\"question\"];
        self.categoryName = [decoder decodeObjectForKey:@\"category\"];
        self.subCategoryName = [decoder decodeObjectForKey:@\"subcategory\"];
    }
    return self;
} 
```

然后为了使用它们，您可以这样调用：

对于设置：

```
NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
NSData *myEncodedObject = [NSKeyedArchiver archivedDataWithRootObject:obj];  
[defaults setObject:myEncodedObject forKey:@\"myEncodedObjectKey\"]; 
```

对于检索：

```
NSUserDefaults defaults = [NSUserDefaults standardUserDefaults];
NSData *myEncodedObject = [defaults objectForKey: key];
MyCustomObject* obj = (MyCustomObject*)[NSKeyedUnarchiver unarchiveObjectWithData: myEncodedObject]; 
```

# android - 有没有办法用 CSS 存储和显示 HTML 以在 Android 中实现文本格式化？

> ID：15665473
> 
> 赞同：0
> 
> 时间：2013-03-27T17:29:24.490
> 
> 标签：android, html, text, webview, formatting

我正在为 Android 创建一个笔记应用程序，我希望用户能够格式化他们的文本，即粗体，不同的文本大小。

我想知道的是如何做到这一点，记住文本必须可以存储在数据库中。

我可以使用带有从数据库中提取的 HTML 字符串和自定义 CSS 来在用户端设置样式的 Web 视图吗？

我也知道 Android 中有某种格式化类，但我不确定它是如何工作的，我不相信存储格式化信息会很容易。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T20:14:19.823

我认为你应该使用 Spannable 文本。请参阅 android.text.*。我认为您应该将文本存储在 HTML 标记中。也看看 [http://developer.android.com/guide/faq/commontasks.html#selectingtext](http://developer.android.com/guide/faq/commontasks.html#selectingtext)

# css - IE9 和浮动 div 对齐的 CSS 问题

> ID：15665477
> 
> 赞同：2
> 
> 时间：2013-03-27T17:29:33.370
> 
> 标签：css, internet-explorer-9, css-float

我遇到了一个问题，我有一个左侧浮动的 div，里面有一个图像，然后在右侧有一堆 div。在兼容模式下，它在 FF、Chrome 和 IE9 中显示良好，但是在普通 IE9 中查看时，最底部的 div 被推到图像下方...

左div：

```
{
float: left;
clear: both;
margin-right: 10px;
} 
```

右 div（在 IE9 下显示的一个）：

```
width: 350px;
float: right;
margin-left: 10px;
height: 150px;
overflow: hidden; 
```

这是它在 IE9 中的样子：http: [//i.imgur.com/tXgAZaN.png](http://i.imgur.com/tXgAZaN.png)

这是它在 Chrome 或 FF 中的样子：http: [//i.imgur.com/yLOFvew.png](http://i.imgur.com/yLOFvew.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-27T17:37:26.547

我认为这是那些明确解决的问题之一。我也时不时遇到这些问题。修复或破解方法是始终向其添加一个新元素，即所谓的伪元素，以使其正确呈现。所以

```
/**
 * For modern browsers
 * 1\. The space content is one way to avoid an Opera bug when the
 *    contenteditable attribute is included anywhere else in the document.
 *    Otherwise it causes space to appear at the top and bottom of elements
 *    that are clearfixed.
 * 2\. The use of `table` rather than `block` is only necessary if using
 *    `:before` to contain the top-margins of child elements.
 */
.cf:before,
.cf:after {
    content: " "; /* 1 */
    display: table; /* 2 */
}

.cf:after {
    clear: both;
}

/**
 * For IE 6/7 only
 * Include this rule to trigger hasLayout and contain floats.
 */
.cf {
    *zoom: 1;
} 
```

这里 cf 将是您的内容

它来自[http://nicolasgallagher.com/micro-clearfix-hack/](http://nicolasgallagher.com/micro-clearfix-hack/)

我希望这能为你解决它，让我知道。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T17:34:58.097

请尝试给你的左 div 一个宽度？并确保总和;-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T19:16:11.913

三件事要做。

1.  分配左右 div 所在容器的总宽度。
2.  将宽度分配给左侧宽度。这样右 div 的文本就不会合并在一起。
3.  在右 div 之后放置另一个 clr 类的 div，以便清除左右 div 所在的容器内的浮动。

**例子：**

```
<div id="container">
  <div id="left_div">

  </div>
  <div id="right_div">

  </div>
  <div class="clr" style="clear:both;"></div>
</div> 
```

它适用于每个浏览器。

**请记住 left_div 和 right_div 的总宽度不应超过容器。**

# c# - 如何在不创建设置的情况下让可执行文件在其他计算机上运行，

> ID：15665481
> 
> 赞同：2
> 
> 时间：2013-03-27T17:29:45.397
> 
> 标签：c#, winforms, charts, aforge

我有一个程序可以绘制一个包含一些数据的文本文件。它在 VS 2010 C# 的调试/发布模式下工作。我正在使用 .Net 和 Aforge 框架。在我的参考资料中是 AForge.Math 和 System.Windows.Forms.Charting 库。

当我在 ...bin/release 文件夹中运行可执行文件时，它可以完全运行，这意味着当我将文本文件拖放到表单中时，会出现一个图表，正如它应该出现的那样。但是，如果我将该发布文件夹复制到另一台计算机上，.exe 会运行，但是当我拖放文本文件时，它不会打印。我只是得到一个白色的空白表格。这就是程序运行时的样子…… ![这是程序运行时的样子](../Images/1407c270a1f6980bbd8c4463cab518fc.png)

当它不工作时，它会做这样的事情（所以我试图将一个文本文件拖放到表单中），我得到的东西看起来像这样...... ![这是行不通的](../Images/3199cd0ffbaf5fea96ade57eba7c511d.png)

我怀疑我的问题来自使用 AForge 框架。所有的计算机都有.Net，所以当输入数据时，图表会继续工作，但正在绘制的数据来自不在计算机上的 AForge。虽然我不完全确定。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T17:35:55.777

您应该复制在调试或发布文件夹中找到的所有 DLL。但有时并非所有 DLL 都出现在那里。**如果您使用的是框架，则可能正在安装目录或 GAC 中寻找这些 DLL**。

在这种情况下，AForge 是一个外部 dll，因此您有两种解决方案：

1.  **在要复制程序的所有电脑上**安装 AForge 。****
***   **CopyLocal True**：在引用中，在每个 AForge DLL 中，确保**CopyLocal 为 true**。检查此[链接](http://msdn.microsoft.com/en-gb/library/vstudio/t1zz5y8c%28v=vs.100%29.aspx)以获取有关设置 CopyLocal=true 的帮助。然后这些 DLL 将出现在您的调试/发布目录中，因此当您拖动时，所有引用都将起作用。确保复制调试/发布文件夹中的所有文件，特别是**.dll**、**.exe**、**.config**。一旦你让它工作，也许你可以避免复制 .pdb 文件。**

 **![在此处输入图像描述](../Images/cbd99da6f3aa073141968618cf01cc95.png)

我个人会尝试最后一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T17:36:43.173

尝试将所有引用设置为 copylocal = true，这应该将 dll 的副本放在 bin\release 文件夹中，以便您可以将它们复制到另一台计算机。 ![在此处输入图像描述](../Images/0cd41d6991c874d29c62a004bc26166c.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T17:40:04.177

在 Visual-Studio 中打开您的解决方案并展开解决方案资源管理器中的引用。它应该向您显示您的项目所引用的所有 DLL 的引用列表。如果使用它，它还必须包含您的 AForge 框架。

现在您所要做的就是确保目标系统上存在相同的 DLL 集：在 exe 自己的路径中（这将适用于您的自定义 DLL，例如 AForge FW）或在 GAC（全局程序集缓存)（适用于已安装的库，例如您的 System.** 框架库和 MSOffice DLL）。

如果缺少某些内容，只需将其他 DLL 复制到目标计算机上的 .exe 文件夹即可。**

# c++ - 构建错误 Intel C++ (Knights Corner) ipo: 警告 #11010: 文件格式无法识别

> ID：15665484
> 
> 赞同：2
> 
> 时间：2013-03-27T17:29:54.820
> 
> 标签：c++, linker, intel

我正在尝试编写一个构建在**3 个系统**上的代码，这些系统主要根据它们的寄存器长度进行区分：

1.  SSE（128 位）
2.  AVX（256 位）
3.  MIC（英特尔骑士角 512 位）

我的**Makefile**根据选择的系统构建可执行文件，可以从**config.mk**中选择，如下所示：

```
MIC=0           # 0 = no MIC kernels        | 1 = build MIC kernels
AVX=0           # 0 = no AVX kernels        | 1 = build AVX kernels
SSE=0           # 0 = no SSE kernels        | 1 = build SSE kernels 
```

我的主要 Makefile 是：

```
#   CONFIGURE BUILD SYSTEM
include config.mk
CXXFLAGS = -O2 -g -pedantic -Wextra -Wno-format -Wall

ifeq '$(strip $(SSE))' '1'
    CXXFLAGS += -msse4.2
    TAG = LIMA
    #@echo "$(CXXFLAGS)"
endif

ifeq '$(strip $(AVX))' '1'
    CXXFLAGS += -mavx
    TAG = SANDY
    #@echo "$(CXXFLAGS)"
endif

ifeq '$(strip $(MIC))' '1'
    CXXFLAGS += -mmic
    TAG = MIC
    #@echo "$(CXXFLAGS)"
endif

CC       = icc
CXX      = icpc
INCLUDES = -I./src/includes
CXXFLAGS := $(CXXFLAGS) $(DEFINES) $(INCLUDES)
DEFINES  = -D_GNU_SOURCE -DDEBUG
LINKER   = $(CXX) -liomp5 -lpthread
LIBS     = 
LFLAGS   = 

#   BUILD PARAMETERS
TARGET     = SpMvM_$(TAG)
SRC_DIR    = ./src
MAKE_DIR   = ./
Q         ?= @
BUILD_DIR  = ./$(TAG)

VPATH = $(SRC_DIR)
OBJ = $(addprefix $(BUILD_DIR)/,$(notdir $(patsubst %.cpp,%.o, $(wildcard $(SRC_DIR)/*.cpp)) ))

${TARGET}: $(BUILD_DIR) $(OBJ)
    @echo "===>  LINKING  $(TARGET)"
    @echo "$(Q)${LINKER} ${LFLAGS} -o $(TARGET) $(OBJ) $(LIBS)"
    $(Q)${LINKER} ${LFLAGS} -o $(TARGET) $(OBJ) $(LIBS)

$(BUILD_DIR)/%.o:  %.cpp
    @echo "===>  COMPILE  $@"
    @echo "$(Q)$(CXX) $(CXXFLAGS) -c $< -o $@"
    $(Q)$(CXX) $(CXXFLAGS) -c $< -o $@ 

$(BUILD_DIR):
    @mkdir $(BUILD_DIR)

.PHONY: clean distclean

clean:
    @echo "===>  CLEAN"
    @rm -rf $(BUILD_DIR)
    @rm -f tags
    @rm -f $(TARGET)
    @rm -f *~

distclean: clean
    @echo "===> DIST CLEAN"
    @rm -f $(TARGET)
    @rm -f tags

clean_dir:
    @echo "===> CLEAN DIR"
    @rm -rf LIMA/ SANDY/ MIC/

clean_all:
    @echo "===> CLEAN ALL"
    @rm -f  SpMvM_LIMA SpMvM_SANDY
    @rm -rf LIMA/ SANDY/ MIC/ 
```

config.mk**有助于**选择正确的编译器标志（-msse4.2、-mavx、-mmic）。

测试代码是一个简单的C++“HELLO WORLD”应用程序。它可以在**SSE**和**AVX**系统上正常工作。

当我尝试在**MIC**上编译时，出现以下错误：

```
===>  COMPILE  MIC/main.o
@icpc -O2 -g -pedantic -Wextra -Wno-format -Wall -openmp -mmic  -I./src/includes -c ./src/main.cpp  -o MIC/main.o
===>  LINKING  SpMvM_MIC
@icpc -liomp5 -lpthread -o SpMvM_MIC ./MIC/main.o
ipo: warning #11010: file format not recognized for ./MIC/main.o
ld: ./MIC/main.o: Relocations in generic ELF (EM: 181)
ld: ./MIC/main.o: Relocations in generic ELF (EM: 181)
ld: ./MIC/main.o: Relocations in generic ELF (EM: 181)
ld: ./MIC/main.o: Relocations in generic ELF (EM: 181)
ld: ./MIC/main.o: Relocations in generic ELF (EM: 181)
ld: ./MIC/main.o: Relocations in generic ELF (EM: 181)
ld: ./MIC/main.o: Relocations in generic ELF (EM: 181)
./MIC/main.o: could not read symbols: File in wrong format
make: *** [SpMvM_MIC] Error 1 
```

我已经搜索到足以了解**ipo**错误与在不同系统上编译和链接有关。但这对我来说没有意义。可执行文件 (SpMvM_$(TAG)) 和对象文件 ($(BUILD_DIR)/) 是在每个系统上创建的，并且它们都以足够的名称命名 ($(TAG) = LIMA, SANDY, MIC)，具体取决于要使用的系统用过的。**因此，来自一个系统的目标文件在与另一个系统的链接或使用方面重叠**。

有人可以告诉我有什么问题吗？

# php - 如何修剪数组格式？

> ID：15665485
> 
> 赞同：0
> 
> 时间：2013-03-27T17:30:03.250
> 
> 标签：php, arrays

我必须找到两个数组之间的差异并存储在第三个数组中。

这就是我正在做的

```
$newEmails=array_diff($Emails_1, $Emails_2); 
```

现在的问题是`$Emails_1`这种格式->

```
 array(1) { [0] => string(20) "tester@xyz.com" } 
```

和

`$Emails_2`以这种格式出现->

```
array(1) { [0] => array(1) { 'email' => string(20) "tester@xyz.com" } } 
```

我应该怎么做`$Emails_2`，以便它的格式与`$Emails_1`

PS：我不能篡改`$Emails_1`，只能更改`$Emails_2`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T17:34:03.627

你可以在比较之前这样做

```
$EmailTemp=$Emails_2[0]["email"];
$Emails_2=array();
$Emails_2[0]=$EmailTemp; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T17:41:29.257

```
$Emails_1 is in this format -> array(1) { [0] => string(20) "tester@xyz.com" }

$Emails_2 comes in this format -> array(1) { [0] => array(1) { 'email' => string(20) "tester@xyz.com" } } 
```

选项 1：为什么不先从数组中删除字符串，

```
$email1 = $Emails_1[0];

$email2 = $Emails_2[0]['email']; 
```

选项 2：使您的 array_difference(..) 迭代，

```
function array_difference($currentEmails, $comingEmails)
{
    $newEmails = new Array();

    for ($comingEmails as $p)
    {
        if (!in_array($p['email'], $currentEmails))
        {
            $newEmails[]=$p['email'];
        }
    }

    return $newEmails;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T17:42:27.260

```
$temp = array();
foreach($Emails_2 as $key => $value){
    $temp[$key] = $value['email'];
}
$Emails_2 = $temp; 
```

# android - 谁（以及如何）创建 AppWidgetProvider 的实例？

> ID：15665491
> 
> 赞同：0
> 
> 时间：2013-03-27T17:30:18.053
> 
> 标签：android, android-widget

更新2。问题出现在某种黑魔法例程（卸载、清理 Eclipse 项目、重新启动 Android 设备、重建、安装、运行）之后。它没有解决，它已经消失了。谁能解释发生了什么？

更新。似乎，在我的 Android 小部件项目中根本没有运行任何 Java 代码，它以 Hello Widget 教程为模型（参考评论）。有什么方法可以运行一些代码来使我的小部件有用吗？我相信这是可能的，因为有很多做某事的小部件。他们是怎么做到的？

我在 Hello Widget 教程之后建模了一个简单的 Android 小部件：http: [//nm-blog.sanid.com/2009/07/android-hellowidget-tutorial/](http://nm-blog.sanid.com/2009/07/android-hellowidget-tutorial/)

运行它我可以看到它根本不起作用 - 文本视图没有改变。

这是一些代码：

显现：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.pell.hellowidget"
    android:versionCode="1"
    android:versionName="1.0" >
    <uses-sdk android:minSdkVersion="8" android:targetSdkVersion="17" />
    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >        
        <receiver android:name="HelloWidgetProvider" android:label="@string/app_name">
            <intent-filter>
                <action android:name="android.appwidget.action.APPWIDGET_UPDATE" />
            </intent-filter>
            <meta-data android:name="android.appwidget.provider"
                android:resource="@xml/hello_widget_provider" />
        </receiver>                
    </application>
</manifest> 
```

res/xml/hello_widget_provider.xml

```
<?xml version="1.0" encoding="utf-8"?>
<appwidget-provider xmlns:android="http://schemas.android.com/apk/res/android"
  android:minWidth="280dp"
  android:minHeight="180dp"
  android:updatePeriodMillis="10000"
  android:initialLayout="@layout/hello_widget_layout"
  android:resizeMode="vertical" /> 
```

res/layout/hello_widget_layout.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:gravity="center_vertical|center_horizontal"
    android:orientation="vertical" >
    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Large Text"
        android:textAppearance="?android:attr/textAppearanceLarge" />
</LinearLayout> 
```

src/com/pell/hellowidget/HelloWidgetProvider.java：

```
package com.pell.hellowidget;

import java.text.DateFormat;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.Locale;
import java.util.Timer;
import java.util.TimerTask;

import android.appwidget.AppWidgetManager;
import android.appwidget.AppWidgetProvider;
import android.content.ComponentName;
import android.content.Context;
import android.widget.RemoteViews;

public class HelloWidgetProvider extends AppWidgetProvider {
    @Override
    public void onUpdate(Context context, AppWidgetManager appWidgetManager, int[] appWidgetIds) {
        Timer timer = new Timer();
        timer.scheduleAtFixedRate(new MyTime(context, appWidgetManager), 1,
                1000);

        super.onUpdate(context, appWidgetManager, appWidgetIds);
    }

    private Date currentTime;

    private class MyTime extends TimerTask {
        RemoteViews remoteViews;
        AppWidgetManager appWidgetManager;
        ComponentName thisWidget;
        DateFormat format = SimpleDateFormat.getTimeInstance(
                SimpleDateFormat.MEDIUM, Locale.getDefault());

        public MyTime(Context context, AppWidgetManager appWidgetManager) {
            this.appWidgetManager = appWidgetManager;
            remoteViews = new RemoteViews(context.getPackageName(),
                    R.layout.hello_widget_layout);
            thisWidget = new ComponentName(context, HelloWidgetProvider.class);
        }

        @Override
        public void run() {
            currentTime = new Date();
            remoteViews.setTextViewText(R.id.textView1,
                    format.format(currentTime));
            appWidgetManager.updateAppWidget(thisWidget, remoteViews);
        }
    }
} 
```

据我了解，由于没有人实例化 com.pell.hellowidget.HelloWidgetProvider 对象，因此它不起作用。入口点（int main(int argc, char * argv[])、WinMain 等）的 Java/Android Widget/etc 模拟是什么？谁（以及如何）实例化 AppWidgetProvider 对象？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:59:04.527

根据您的最终评论，. 在`android:name`可以有时是必不可少的。通常，我总是在清单中使用完全限定名称（“com.super.cool.thing.MySpecialClassActivity”），因为它非常清楚。

AppWidget 的“入口点”是提供者类。但是，它仅在被调用时才被实例化，并且一旦`onUpdate`（或`onDestroy`）返回，该类就消失了。虽然（我认为）你可以做你已经做过的事情，但这不会被认为是好的做法 - 通常你应该创建一个定义的单独线程来管理你的小部件，或者 a `Service`， an `AsyncTask`， a`Thread`等。

通常，该`onUpdate`方法将创建一个旨在启动一个服务类的意图，该服务类将控制小部件。这方面的一个例子是[http://www.vogella.com/articles/AndroidWidgets/article.html](http://www.vogella.com/articles/AndroidWidgets/article.html)，特别是第 8 节。我只会在该教程中狡辩一点：通常建议不要使用 updatePeriod。我还在[由 AlarmManager 重新创建的 Service 中](https://stackoverflow.com/questions/15435117/service-being-re-created-by-alarmmanager/15691054#15691054)考虑了使用 Services 和其他东西的一些注意事项。

# ios - 如何使用 UITableView 改变 UITextView 的内容

> ID：15665494
> 
> 赞同：-2
> 
> 时间：2013-03-27T17:30:25.193
> 
> 标签：ios, uitableview, uitextview

我需要您的支持才能将静态 UITable 视图与 UITextView 一起使用静态 UITextView 当用不同的内容按下表格单元格时我需要更改 TextView 的内容？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T17:48:26.963

似乎有点宽泛，不清楚你想做什么，但如果你有一个单元格（静态），然后在单元格中放置一个 textview，然后每当点击该单元格时更新 textView

# html - 项目符号列表行之间的间距

> ID：15665505
> 
> 赞同：14
> 
> 时间：2013-03-27T17:30:52.840
> 
> 标签：html, css

如何设置项目符号列表之间的间距？

*   asdfsdf
*   asdf23223

我想在第一行和第二行之间多留一点空间，比如

```
<ul>
    <li>asdfasdf</li>
<p />
    <li>asdf23223</li>
</ul> 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-03-27T17:32:21.033

向s添加`top`和填充，如下所示：`bottom``li`

```
ul li { padding: 5px 0px; } 
```

并**取出那个看起来很疯狂的`<p />`标签**。

演示：http: [//jsfiddle.net/aFED2/](http://jsfiddle.net/aFED2/)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-03-27T17:33:04.040

您可能可以执行以下操作：

```
<ul style="line-height:1.4;"> 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-03-27T17:33:08.283

我假设`<p />`标签只是一个错字，它不应该在那里；）

将此添加到您的`<head>`标签中：

```
<style>
    ul li { margin-bottom: 10px; }
</style> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-27T17:33:28.803

使用`line-height`这将在文本上方和下方放置间距。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-27T19:55:11.373

**将 CSS 用作：**

```
li { padding: 10px 0px 0px; }
li:first-child { margin-bottom: 0px; } 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-06-18T16:42:25.930

我只是使用它，以便在使用 html 和 php 时它不会与我所有其他页面的样式混淆。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-27T17:33:40.977

您可以`margin-bottom`为您的列表项添加一个

演示：http: [//jsfiddle.net/6tcpd/](http://jsfiddle.net/6tcpd/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-02-28T06:00:54.907

您可以使用`pre`标签。不需要css

```
<ul>
  <pre>
    <li>Foo</li>
    <li>Bar</li>
    <li>Baz</li>
    </pre>
</ul>
```

# javascript - Javascript - 对象内的函数声明

> ID：15665508
> 
> 赞同：0
> 
> 时间：2013-03-27T17:30:57.873
> 
> 标签：javascript

我试图在对象中使用函数声明，但到目前为止还不能。我知道我可以在对象中使用函数表达式，但是可以使用函数声明来代替吗？

这有效：

```
 var objContainer = {};
 objContainer.callback = function(data) {
 objContainer.server_date = data.responseXML.documentElement.getAttribute("answer");
 alert("Object should have XML response: " + objContainer.server_date);
 }; 
```

这不会：

```
 var objContainer = {};
 function objContainer.callback(data) {
 objContainer.server_date = data.responseXML.documentElement.getAttribute("answer");
 alert("Object should have XML response: " + objContainer.server_date);
 } 
```

我也尝试过使用对象文字表示法的函数声明，但它也失败了：

```
 var objContainer = {
   function callback(data) {
   var objContainer.server_date = data.responseXML.documentElement.getAttribute("answer");
   alert("Object should have XML response: " + objContainer.server_date);
   }
 }; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T17:32:52.410

> 我知道我可以在对象中使用函数表达式，但是可以使用函数声明来代替吗？

不，只有表达式。

您可以得到的最接近的方法是在范围内声明一个函数，然后按名称将该函数分配给一个对象属性。

```
function foo () { }
var bar = { func: foo }; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T17:49:16.760

如果我对您的理解正确，您只想使用“function funcname() { .. }”语法而不是“obj.prop = function() { ..}”对吗？你能做到这一点的唯一方法是使用这样的东西：

```
function objContainer() {
    this.callback = callback;
    function callback(data) {
        alert(data);
    }
};

var myObjectContainer = new objContainer();
myObjectContainer.callback('hello world'); 
```

当您使用“varName = new funcName()”调用函数时，它会创建一个对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T17:38:09.040

对于最后一个示例，我认为这就是您想要的：

```
var objContainer = {
  callback : function(data) {
 var objContainer.server_date = data.responseXML.documentElement.getAttribute("answer");
  alert("Object should have XML response: " + objContainer.server_date);
                         }
                  };
//  then you could use the object like this:
objContainer.callback(); 
```

# r - R用没有循环的随机值填充datas.frame

> ID：15665510
> 
> 赞同：0
> 
> 时间：2013-03-27T17:30:58.440
> 
> 标签：r, loops, dataframe

我需要知道一些事情。我想用值填充 data.frame D。这应该用 dbeta 来完成，所以我在做这样的事情

```
d[1:10,1:10] <- 0.01 + (1-0.01)*rbeta(1,shape1=1,shape2=2) 
```

但是，这会为所有条目生成相同的值。有没有办法在没有循环的情况下实现这一点？

谢谢R。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T17:33:52.490

你可以这样做：

```
d[1:10,1:10] <- 0.01 + (1-0.01)*rbeta(100, shape1=1,shape2=2) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T17:34:06.103

尝试 `rbeta(100,...)` 一次性创建 100 个样本。

# c# - 循环内的 C# SqlConnection

> ID：15665512
> 
> 赞同：1
> 
> 时间：2013-03-27T17:31:16.940
> 
> 标签：c#, loops, sqlconnection

第一次在stackoverflow上。我正在学习如何在我的 WebForm 页面中管理 SqlConnection，并且我想达到最佳实践来做到这一点。在我的具体情况下，我有一个循环，如果我没有为循环的每次迭代设置一个新的 SqlConnection，我就无法运行代码而不出错（错误是关于在阅读器关闭时尝试读取） . 所以我在 PageLoad 方法中声明了这一点：

```
private SqlConnection con;
protected void Page_Load(object sender, EventArgs e)
{
    con = new SqlConnection(connectionString);
} 
```

然后我有这个：

```
private int conta(int padre)
{
    string SQL = "SELECT * FROM categories WHERE idp=@idpadre";
    SqlCommand cd = new SqlCommand(SQL, con);
    cd.Parameters.AddWithValue("@idpadre", padre);
    int sub=0;
    try
    {                
        if ((con.State & ConnectionState.Open) <= 0)
        {
            con.Open();
        }

        using (SqlDataReader reader = cd.ExecuteReader())
        {
            while (reader.Read())
            {
                sub++;
            }
        }
    }
    catch (Exception err)
    {
        lbl.Text = "Errore conta!";
        lbl.Text += err.Message;
    }
    finally
    {
        con.Close();

    }
    return sub;
}

protected void buildParent(int padre, int level)
{
    StringBuilder sb = new StringBuilder();
    sb.Append(" ");
    for (int i = 0; i < level; i++)
    {
        sb.Append(HttpUtility.HtmlDecode("&nbsp;&nbsp;&nbsp;&nbsp;"));
    }
    sb.Append("|--");
    selectSQL = "SELECT * FROM categories WHERE idp=@idpadre";
    SqlConnection cn = new SqlConnection(connectionString);
    cmd = new SqlCommand(selectSQL, cn);
    cmd.Parameters.AddWithValue("@idpadre", padre);

    try
    {
        cn.Open();

        using (SqlDataReader read = cmd.ExecuteReader())
        {
            while (read.Read())
            {

                dlParent.Items.Add(new ListItem { Text = sb.ToString() + read["cat"].ToString(), Value = read["idcat"].ToString() });
                int sub = conta(Convert.ToInt32(read["idcat"]));
                //int sub = 0;
                if (sub > 0)
                {
                    buildParent(Convert.ToInt32(read["idcat"]), level + 1);
                }

            }
            read.Close();
        }

    }
    catch (Exception err)
    {
        lbl.Text = "Errore buildParent!";
        lbl.Text += err.Message;
    }
    finally
    {
        cn.Close();
        if (s != null)
        {
            if (!this.IsPostBack)
            {
                buildPage();
                buildLang();
                buildImage();
            }
        }
    }
} 
```

在 while 循环中的 buildParent 中，我调用“conta”，但如果我对这两种方法使用相同的 SqlConnection (con)，我会在阅读器关闭时尝试读取错误。我担心网络服务器上的连接池，尤其是最大连接范围。那么，我哪里错了？管理 SqlConnection 的最佳实践是什么？谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-27T17:34:32.030

您尽可能晚地打开连接，并尽快处理。让[连接池](http://msdn.microsoft.com/en-us/library/8xx3tyca.aspx)处理回收连接。

我通常这样写我的代码：

```
using (var conn = new SqlConnection(connectionString))
using (var cmd = new SqlCommand(commandToRun, conn))
{
    cmd.Parameters.AddRange(new[]
        {
            new SqlParameter("myParam", "myvalue"),
            new SqlParameter("myParam", "myvalue")
        });

    conn.Open(); // opened as late as possible
    using (SqlDataReader reader = cd.ExecuteReader())
    {
        while (reader.Read())
        {
            // do stuff.
        }
    }
} // disposed here. 
```

注意：要从 SQL 数据库中获取计数，您最好使用

```
SELECT count(*) FROM categories WHERE idp=@idpadre 
```

并执行查询`ExecuteScalar()`

# matlab - Matlab：按列图像c

> ID：15665513
> 
> 赞同：0
> 
> 时间：2013-03-27T17:31:17.883
> 
> 标签：matlab, visualization

我有一个*m* × *n*矩阵，其中*n*很大。我想通过使用每列中的值范围来可视化它，即我想在一个图像中可视化整个矩阵，但每一列都有自己的范围。这就像应用 columnwise imagesc 并在最后连接每一列。

有没有一种有效的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T17:45:16.720

我认为在使用 imagesc 之前，按列归一化应该可以解决问题。

假设您有一个名为`original`.

```
original = rand(10,5); 
```

首先获取每列的范围：

```
myMax = max(original);
myMin = min(original);
myDiff = myMax-myMin; 
```

然后我们把它下移到合适的水平

```
newimage = bsxfun(@minus,original,myMin); 
```

最后，我们将其重新缩放到适当的比例：

```
newimage = bsxfun(@rdivide,newimage ,myMax - myMin); 
```

现在您可以将 imagesc 应用于您的`newimage`，我认为这将为您提供所需的东西。

请注意，如果最大值和最小值可以彼此相等，您可能需要添加另一个步骤。

# javascript - MarkerClusterer 的最大缩放 - 相同的经纬度

> ID：15665515
> 
> 赞同：0
> 
> 时间：2013-03-27T17:31:27.997
> 
> 标签：javascript, google-maps-api-3, google-maps-markers, markerclusterer

我已将 MarkerClusterer 添加到我的 Google Maps V3 脚本中。工作正常 - 但是我有一些具有相同纬度的标记 - MarkerClusterer 无法识别这一点，当降至最大缩放级别时，它会将一个标记堆叠在另一个之上，因此我只能查看其中一个。为了解决这个问题，我使用了一个额外的脚本 (oms)，它允许在单击时扩展一组具有相同纬度的标记。这是令人困惑的部分；

当我单击最后一个单独的标记时，附加脚本会扩展所有相同的标记 - 但我需要在此之前触发它 - 当相同的标记位于集群中时。是否可以在 MarkerClusterer 中执行此操作/有人知道替代方法吗？

非常感谢您提前。

JS如下：

```
 function indexLoad() {

  var map = new google.maps.Map(document.getElementById("map"), {
    center: new google.maps.LatLng(43, 15),
    zoom: 1,
    mapTypeId: 'roadmap'

  });

 var infoBox;

 var oms = new OverlappingMarkerSpiderfier(map);

  // Change this depending on the name of your PHP file
  downloadUrl("/jofli/journals/xml/public", function(data) {
    var xml = data.responseXML;

    var markerArray = [];
    var markers = xml.documentElement.getElementsByTagName("marker");

    for (var i = 0; i < markers.length; i++) {

            var name = markers[i].getAttribute("name");
            var address = markers[i].getAttribute("address"); 
            var type = markers[i].getAttribute("type");
            var point = new google.maps.LatLng( 
                parseFloat(markers[i].getAttribute("lat")),
                parseFloat(markers[i].getAttribute("lng")));
            var html = "<section class='mapJournalInfo'> <b>" + name + "</b> <br/> <br/> " + address + "<br/> <br/>" + "<aside class='mapPhoto'> Photo 1 </aside>"  + "<br/> <br/> <br/> <a class='mapLink' href='#'> See More </a> </section>";
            var icon = customIcons[type] || {};

            var image = new google.maps.MarkerImage(

            'http://i.imgur.com/iNKorgI.png',
              new google.maps.Size(50,59),    // size of the image
              new google.maps.Point(0,0) // origin, in this case top-left corner
             // new google.maps.Point(9, 25)    // anchor, i.e. the point half-way along the bottom of the image

              );

            var marker = new google.maps.Marker({
              map: map,
              position: point,
              icon: image,
              shadow: icon.shadow
            });

            markerArray.push(marker);

            oms.addMarker(marker);

             infobox = new InfoBox({
             disableAutoPan: false,
             maxWidth: 150,
             pixelOffset: new google.maps.Size(-150, -20),
             zIndex: null,
             boxStyle: {
             background: "url('http://google-maps-utility-library-v3.googlecode.com/svn/trunk/infobox/examples/tipbox.gif') no-repeat",
             opacity: 0.75,
             width: "350px"
             },
             closeBoxMargin: "12px 4px 2px 2px",
             closeBoxURL: "http://www.google.com/intl/en_us/mapfiles/close.gif",
             infoBoxClearance: new google.maps.Size(1, 1)
             });

            infobox.setContent(html);

            google.maps.event.addListener(marker, 'click', function() {
              infobox.open(map, this);
              map.panTo(point);
            });

            // at the moment, this is the click for the max level zoom (small bear)
            // this needs to be 1 step BEFORE that (last cluster level)
            // when there are <1 markers that are of the same lat long

            oms.addListener('click', function(marker) {

              infobox.setContent(html);
              infobox.open(map, marker);

            });

          ////////////////////////////////////////////////////////////////////////////

    }

  var clusterStyles = [

    {
      opt_textColor: '#e04343',
      textColor: 'red',
      url: 'http://i.imgur.com/UUg1nM4.png',
      height: 71,
      width: 49
    }

    ];

    var mcOptions = {

        styles: clusterStyles,
        streetViewControl: true,
        maxZoom:13,

        };

    var markerCluster = new MarkerClusterer(map, markerArray, mcOptions);

  });

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-06T17:57:39.450

我有一个类似的问题，你有没有设法解决这个问题？我认为找到答案的关键在于 google clustermarkerer 插件的“zoom”属性。

但最终是 markerCluster 本身具有该属性

`var markerCluster = new MarkerClusterer(map, clusteredMarkers, {gridSize:2});`

试试这个，看看它是否有效

# java - app_glue android NDK：GetMethodID 失败，TextView.setText 调用

> ID：15665516
> 
> 赞同：2
> 
> 时间：2013-03-27T17:31:34.613
> 
> 标签：java, c, android-ndk, java-native-interface

我正在使用 NDK 开发一个原生 android 项目。我的代码只有 C，我需要通过 JNI 调用一些 java 函数。

我试过了，我可以从类中调用一些方法，例如`android`, `view`, `WindowManage`。但是当我尝试使用时，`TextView.setText`我得到了一个`java.lang.NoSuchMethodError`例外。

这是代码：

```
 JNIEnv* jni;
 state->activity->vm->AttachCurrentThread(&jni, NULL);

 jclass activityClassMine = jni->FindClass("android/widget/TextView");
 if(!(activityClassMine))
 LOGI("can't find TextView class...");

 jmethodID SetTextColour = jni->GetMethodID
                              ( activityClassMine
                              , "setTextColor"
                              , "(I)V");        //this works !!!!
 if(!(SetTextColour))
LOGI("textColour Failed...");

 jmethodID getSetText = jni->GetMethodID
                              ( activityClassMine
                              , "setText"
                              , "(Ljava/lang/CharSequence;)V");

 if(!(getSetText))      //failed                               
 LOGI("setText Failed"); 
```

我已经检查了该方法的签名，没关系，我尝试了该方法的其他可用签名，但没有成功...

# bash - 使用文件名中的信息重命名文件

> ID：15665522
> 
> 赞同：1
> 
> 时间：2013-03-27T17:31:56.587
> 
> 标签：bash, file

我有大量名为*A2012178.1220.051.2012178233531.hdf*的文件 ，从第 2 个字符到第 8 个字符是日期，年份加上儒略日。从第 13 个字符到文件的扩展名对我来说都是垃圾......所以我想重命名文件并转换日期（为方便起见）。

到目前为止，我能够在 bash 中转换日期

`CONVERTED=$(date -d "${Year}-01-01 +${JulianDay} days -1 day" "+%Y%m%d")`

但我不知道如何从文件名中读取年份和儒略日并替换 bash 脚本中的名称....

任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T18:08:32.160

使用参数替换来获取子字符串：

```
name="A2012178.1220.051.2012178233531.hdf" 

Year=${name:1:4}
JulianDay=${name:5:3} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T18:20:10.570

棘手的部分是朱利安日的长度是可变的，因此您不知道如何提前将其切出。所以，你可能会做这样的事情：

```
read begin date end < <(echo $filename | sed -e 's/\(.\)\([[:digit:]]\+\)\(.*\)\
/\1 \2 \3/')

Year=${date::4}
JulianDay=${date:4}

newdate=$(date -d "${Year}-01-01 +${JulianDay} days -1 day" "+%Y%m%d")

mv $filename "${begin}${newdate}${end}" 
```

这基本上将文件名拆分为日期字段，然后将前 4 位数字作为年份，其余为儒略日。

（这假设朱利安日不是 0 填充，这从你的问题中不清楚。如果它是零填充，那就容易多了）。

# javascript - 使用名称而不是匿名函数

> ID：15665526
> 
> 赞同：0
> 
> 时间：2013-03-27T17:32:09.230
> 
> 标签：javascript

这就是我包装所有 JavaScript 的方式：

```
;(function($, window, undefined) {
    var document = window.document;
    var myFunction = function() {}
})(jQuery, window); 
```

但现在我需要从该闭包之外调用 myFunction 。

```
window.addEventListener("offline", function(e) {
    myFunction();
}, false); 
```

问：如何命名自执行匿名函数，以便可以从全局范围调用 myFunction？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T17:34:35.813

很简单，只需将您的函数附加到全局对象（窗口）：

```
;(function($, window, undefined) {
    var document = window.document;
    var myFunction = function() {}
    window.myNamedFunction = myFunction;
})(jQuery, window); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-27T17:35:05.957

将函数分配给您要使用的任何对象/范围的属性。

```
;(function($, window, undefined) {
    var document = window.document;
    var myFunction = function() {};
    window.myFunction = myFunction;
})(jQuery, window); 
```

不过，您最好希望从 IIFE 中返回包含所有“出口”的东西。

```
var exports = (function($, window, undefined) {
    var document = window.document;
    var myFunction = function() {};
    return {
        "myFunction": myFunction
    };
})(jQuery, window);

window.addEventListener("offline", function(e) {
    exports.myFunction();
}, false); 
```

[AMD](http://requirejs.org/docs/whyamd.html)对这种编程风格很有帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-27T17:33:25.010

使用命名空间并将其推送到全局范围。

```
window.yourNamespace = window.yourNamespace || {};
window.yourNamespace.myFunction = function() {}; 
```

# javascript - AngularJS - 使用指令允许 jQuery 点击事件触发 ng-click

> ID：15665528
> 
> 赞同：0
> 
> 时间：2013-03-27T17:32:11.873
> 
> 标签：javascript, jquery, angularjs

我想用来`$(selector).trigger('click')`触发该元素上的 ng-click 事件。

我想我想使用指令来做到这一点，但我不知道该怎么做。这是我的想法：

```
.directive('jClick', function() {
    return {
        restrict : 'A',
        scope: {
            'ngClick' : '&'
        },
        link: function($scope, element) {
            return element.bind('click', function(){
                $scope.ngClick({order : $scope.order});
            });
        }
    };
}) 
```

它不仅不起作用，而且完全破坏了我的应用程序。场景（如果有帮助的话）是这样的：

我有一个可扩展的 zippies 列表，当调用 my`ng-click`中的函数时，它们会扩展 ( `ng-click="expand(order)"`)。

我有一个函数可以检查当前网址末尾是否有哈希，例如：

```
example.com#/my/route/params#83947 
```

（我将第二个哈希与第二个哈希分开，`$routeParams`因为它们用于不同的目的。）

我使用一个函数来检查第二个哈希是否存在并将页面向下滚动到相应的列表项。一切正常，但我希望它也扩展该列表项，因此我希望触发它`ng-click`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T18:05:04.057

所以你想根据一定的条件自动打开zippy？条件本身并不重要。您可以做的是将可见性（展开/折叠）绑定到布尔值并在控制器上设置变量。在 Zippy 指令上，ng-click 也会设置相同的变量。因此，您有两种方法来打开和关闭 zippy，一种是通过单击 Zippy，另一种是通过从外部设置标志。

ng-click 是一个内置指令，它本身不是一个属性，也不是你可以调用的函数。我不会依赖手动触发 ng-click。

# java - 检查列表是否包含相同的数据

> ID：15665534
> 
> 赞同：-3
> 
> 时间：2013-03-27T17:32:36.490
> 
> 标签：java, arrays, list, data-structures

我有一个对象数组列表....每个数组中有 4 个对象。

我需要阅读完整列表并将所有在 element[1] 处具有相同值的数组放在单独的列表中。

怎么做？

例如我有一个列表“数据”

其中有第 n 个对象数组，例如

```
array[0]
array[1]
array[2]
⋮ 
array[n] 
```

每个数组有 4 个值

```
array[0] has 0,23,BD,100
array[1] has 1,23,FG,200
array[2] has 3,34,GH,400
array[3] has 8,87,UJ,600
⋮ 
array[n] has 98,23,KM,9000 
```

现在我需要输入`array[0], array[1] and array[n]`相同`list(List1)`的值，因为它们都具有相同的值`'element 2' i-e '23'`

而`array[2]`在单独`list(List2)`和`array[3]`单独中，`list(List3)`因为没有其他数组具有与它们相似的“元素 2”。

所有数组都是对象类型。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:23:17.237

我认为你得到这样的值是因为你从一个或多个表中选择属性的子集。实际上，您最终会得到一个 type 数组的列表`Object`。这是因为每个属性都有自己的类型，所以可以处理这种未定义情况的通用超类型就是`Object`它自己。

您可以在这里采取两种方法。一个将需要与数据库的增强交互，另一个将用额外的处理替换此查询调整，以准备您刚刚检索到的数据。

**选项 1：进一步参数化您的查询**

在查询中添加另一个条件，在其中定义第二个属性（`element 2`如您命名的那样）。然后查询将具有以下额外条件：

```
AND element2 = :element2 
```

这样，您可以确定`element 2`何时查询数据，直接获取相关数据的每个子集。这种方法需要事先了解您要检索的值以及与值一样多的查询。

这些值可以通过一个简单的查询来检索：

```
SELECT DISTINCT(element2) FROM <YOUR_TABLES_HERE> 
```

每次执行查询时，您仍然会获得 a `List`，`Object[]`但是这一次，它们都将具有相同的值 for `element 2`。

**方案二：处理刚刚获得的数据**

如果更改查询不是一种选择（或者由于任何原因没有一种简单的方法可以了解不同的值`element 2`可以采用），那么您将不得不处理刚从数据库中获得的原始数据。

我建议您将 a`Map`与一些`List`s 混合使用。假设`element 2`位于`1`数组的索引下，您必须遍历该列表，检查值并将其添加到地图中：

```
Map<Long, List<Object[]>> queriedResultsMap = new HashMap<Long,List<Object[]>>();
//Iterate over the obtaines database values
for(Object[] currentArray : yourListOfObject) {
    if(!queriedResultsMap.containsKey(currentArray[1])) {
        //No element with that value for "element 2" is on the map yet,
        //so a new container (List) is created.
        queriedResultsMap.put(currentArray[1],new ArrayList<Object[]>());
    }
    //Adds the element to the associated list.
    queriedResultsMap.get(currentArray[1]).add(currentArray);
} 
```

这段简单的代码会遍历您当前的数组列表，并将它们中的每一个添加到与地图键的 valye 关联的列表中`element 2`。在此映射中，键是 的值，`element 2`关联的值是 a `List`，其中包含所有找到的为 设置了相应值的注册表`element 2`。

`if`每次遇到新值时，该语句都会创建一个新列表`element 2`，并将其与该值相关联。

最后，要使用数据，您只需执行以下操作：

```
queriedResultsMap.get(element2Value); 
```

Where`element2Value`包含您要为其获取结果的值。映射返回的列表包含具有特定值的所有结果`element 2`。如果没有返回列表（`get`方法返回`null`），您知道您刚刚运行的查询没有返回该值的结果`element 2`。

该地图允许在每个找到的值之间直接关联`element 2`，还可以让您直接了解所有获得的值，同时让您有机会立即检查是否检索到特定值。要确切知道`element 2`找到了哪些值，只需获取`keySet`地图的 并知道是否检索到给定值，请使用 的`containsKey`方法`Map`。

使用最适合您的方法。

# r - 在数据框中以数字方式重新排序因子

> ID：15665535
> 
> 赞同：10
> 
> 时间：2013-03-27T17:32:37.297
> 
> 标签：r, sorting

我有从 0 到 39 的因子。这是它们现在的排序方式：

```
> levels(items$label)
 [1] "0"  "1"  "10" "11" "12" "13" "14" "15" "16" "17" "18" "19"
[13] "2"  "20" "21" "22" "23" "24" "25" "26" "27" "28" "29" "3" 
[25] "30" "31" "32" "33" "34" "35" "36" "37" "38" "39" "4"  "5" 
[37] "6"  "7"  "8"  "9" 
```

为了显示目的，我如何按数字顺序重新排列它们？我不想改变数据框的含义。

*更新*：如何`items`使用排序因子更新原始数据框`labels`？这不应该实质性地改变数据框；我只是希望这些因素在后续操作中以正确的顺序出现。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-27T17:32:37.297

```
sorted_labels <- paste(sort(as.integer(levels(items$label)))) 
```

给出：

```
 [1] "0"  "1"  "2"  "3"  "4"  "5"  "6"  "7"  "8"  "9"  "10" "11"
[13] "12" "13" "14" "15" "16" "17" "18" "19" "20" "21" "22" "23"
[25] "24" "25" "26" "27" "28" "29" "30" "31" "32" "33" "34" "35"
[37] "36" "37" "38" "39" 
```

或者（如[https://stackoverflow.com/a/15665655/109618](https://stackoverflow.com/a/15665655/109618)中所述）：

```
sorted_labels <- order(levels(items$label)) - 1
# order by itself is a 1-based vector
# using `- 1` gives a 0-based vector 
```

根据更新的问题，这会更新数据框：

```
items$label <- factor(items$label, levels = sorted_labels) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-27T17:38:45.140

如果所有整数都存在，那么您可以简单地使用`order`：

```
 order(levels(items$label)) - 1   # where the minus 1 is for starting from 0 
```

如果不是所有整数都存在，那么您必须使用 as.numeric，就像您拥有它一样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-06-26T06:43:16.513

如果您正在寻找`tidyverse`/`forcats`解决方案：

生成数据：

```
items <- data.frame(label = as.character(0:39),stringsAsFactors = FALSE)
# if stringsAsFactors = TRUE (default), items$label must be converted to character before casting to integer!

factor(items$label)
#>  [1] 0  1  2  3  4  5  6  7  8  9  10 11 12 13 14 15 16 17 18 19 20 21 22
#> [24] 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39
#> 40 Levels: 0 1 10 11 12 13 14 15 16 17 18 19 2 20 21 22 23 24 25 26 ... 9 
```

使用`fct_relevel`

```
library(forcats)

fct_relevel(items$label,function(x){as.character(sort(as.integer(x)))})
#>  [1] 0  1  2  3  4  5  6  7  8  9  10 11 12 13 14 15 16 17 18 19 20 21 22
#> [24] 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39
#> 40 Levels: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 ... 39 
```

它也适用于`fct_reorder`

```
fct_reorder(items$label,as.integer(items$label))
#>  [1] 0  1  2  3  4  5  6  7  8  9  10 11 12 13 14 15 16 17 18 19 20 21 22
#> [24] 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39
#> 40 Levels: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 ... 39 
```

如果您的向量还包含字符（例如`1 egg`，`2 eggs`等），这会带来一些不错的可能性：

```
items$label2 <- paste(items$label,"eggs")

factor(items$label2)
#>  [1] 0 eggs  1 eggs  2 eggs  3 eggs  4 eggs  5 eggs  6 eggs  7 eggs 
#>  [9] 8 eggs  9 eggs  10 eggs 11 eggs 12 eggs 13 eggs 14 eggs 15 eggs
#> [17] 16 eggs 17 eggs 18 eggs 19 eggs 20 eggs 21 eggs 22 eggs 23 eggs
#> [25] 24 eggs 25 eggs 26 eggs 27 eggs 28 eggs 29 eggs 30 eggs 31 eggs
#> [33] 32 eggs 33 eggs 34 eggs 35 eggs 36 eggs 37 eggs 38 eggs 39 eggs
#> 40 Levels: 0 eggs 1 eggs 10 eggs 11 eggs 12 eggs 13 eggs ... 9 eggs

library(readr)

fct_reorder(items$label2,parse_number(items$label2))
#>  [1] 0 eggs  1 eggs  2 eggs  3 eggs  4 eggs  5 eggs  6 eggs  7 eggs 
#>  [9] 8 eggs  9 eggs  10 eggs 11 eggs 12 eggs 13 eggs 14 eggs 15 eggs
#> [17] 16 eggs 17 eggs 18 eggs 19 eggs 20 eggs 21 eggs 22 eggs 23 eggs
#> [25] 24 eggs 25 eggs 26 eggs 27 eggs 28 eggs 29 eggs 30 eggs 31 eggs
#> [33] 32 eggs 33 eggs 34 eggs 35 eggs 36 eggs 37 eggs 38 eggs 39 eggs
#> 40 Levels: 0 eggs 1 eggs 2 eggs 3 eggs 4 eggs 5 eggs 6 eggs ... 39 eggs 
```

^(由[reprex 包](https://reprex.tidyverse.org)（v0.3.0）于 2019 年 6 月 26 日创建)

fct_* 函数的所有输出都可以写回原始数据。例如：

```
items$data <- fct_reorder(items$label,as.integer(items$label)) 
```

# java - 适配器检测点击的组件android

> ID：15665539
> 
> 赞同：0
> 
> 时间：2013-03-27T17:32:59.273
> 
> 标签：java, android, listview, adapter

我有一个与适配器相结合的列表视图。在我的列表视图中，我有多个包含多个元素的元素。如何检测列表项中点击了什么？我在适配器中的每个按钮上都使用了 onclicklistener，但是没有更好的方法可以使除按钮或其他东西之外的所有内容都无法点击吗？

提前致谢

# ruby - Ruby 正则表达式匹配不以字符开头的文本

> ID：15665543
> 
> 赞同：1
> 
> 时间：2013-03-27T17:33:07.913
> 
> 标签：ruby, regex

我想知道只有当它不以特定字符开头时，您如何才能匹配模式。我想匹配“foo”，但不想匹配“afoo”。我需要什么样的正则表达式运算符？我似乎找不到合适的。也许是锚？

例如我想改变

```
foo foo afoo foo 
```

到

```
bar bar afoo bar 
```

谢谢。

虽然下面的答案对于我的示例是正确的，但如果它是 /foo 而不是 afoo 呢？这似乎不一样？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-27T18:13:31.787

听起来你正在寻找负面的看法。如果你说`(?<!expr1)expr2`，那么它会匹配任何`expr2`匹配项，只要它前面没有立即`expr1`匹配。例如：

```
>> 'foo foo afoo foo'.gsub(/(?<!a)foo/, 'bar')
=> "bar bar afoo bar" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-27T17:43:14.443

```
str = "foo foo afoo foo"

str.gsub(/\bfoo/, "bar") #=> "bar bar afoo bar" 
```

# ruby-on-rails - Rails：将参数从视图传递到控制器

> ID：15665546
> 
> 赞同：4
> 
> 时间：2013-03-27T17:33:13.413
> 
> 标签：ruby-on-rails, ruby, controller, models

我在 rails 有以下模型：

```
class Task < ActiveRecord::Base
  attr_accessible :description, :name, :project
  belongs_to :project

  validates :name, :presence => true

end

class Project < ActiveRecord::Base
  attr_accessible :name
  has_many :tasks
end 
```

我有一个列出可用项目的视图单击任何项​​目时，我想打开一个页面，其中列出了单击项目中的所有任务。现在的问题是我如何传递项目ID？之后我还希望项目 ID 在许多控制器中可见，所以我认为我应该使用会话变量或类似的东西？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T17:44:41.090

您想使用嵌套资源

路线.rb

```
resources :project do
  resources :tasks
end 
```

这将允许你做`<%= link_to 'Tasks', tasks_project_path(@project) %>`

然后你会有一个任务控制器，参数将包括 :project_id`/projects/:project_id/tasks`

然后在控制器中：

```
class TasksController < ApplicationController
  def index
    @project = Project.find(params[:project_id])
    @tasks = @project.tasks
  end
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-27T17:41:16.667

你可以这样做：

```
 <%= link_to 'Get tasks of project', {:controller => :tasks, :action => :list_project_tasks}, :params => {:project_id => project.id} %> 
```

这`list_project_tasks`是一个动作`tasks_controller`

```
 def list_project_tasks
    @project_tasks = Project.find(params[:id]).tasks
 end 
```

或者：

您可以修改您`index`的`tasks_controller`：

```
<%= link_to 'Get tasks of project', {:controller => :tasks, :action => :index}, :params => {:project_id => project.id} %>

def index
  @tasks = Project.find(params[:project_id]).try(:tasks) || Task.all
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T17:42:18.133

1）单击任何项​​目时，我想打开一个页面，其中列出了单击项目中的所有任务。- 为此，我建议使用 Rails 提供的 link_to 帮助程序，并通过 Rails 路由链接到项目。例如，您的视图将列出所有项目，并且每个项目项将使用`<%= link_to project.name, @project %>`或显示`<%= link_to project.name, project_path(@project) %>`

您可以通过在命令行中键入 rake routes 来查看路由列表。

2）我不确定您的意思，但是如果您使用的网址类似于 /projects/12/ 任何资源及其下面的控制器（例如 /projects/12/tasks/15）可以访问 project_id 为params[:project_id]，假设您的路线设置为嵌套路线。

# jquery - jQuery UI 焦点窃取

> ID：15665552
> 
> 赞同：11
> 
> 时间：2013-03-27T17:33:45.953
> 
> 标签：jquery, jquery-ui, modal-dialog

每当我在下面的“插入超链接”文本输入中键入内容时，所有单词都会`textarea`在其后面。确定和取消按钮工作正常，但我无法专注于文本输入。

我们正在使用 jQuery UI 1.10.1。它与以前版本的 jQuery 1.8.x 配合得很好。

![在此处输入图像描述](../Images/711c926b6825435b934521c1f66a8ee0.png)

我检查了 jQuery 背后的代码，它在打开模态对话框时调用了以下方法：

```
_focusTabbable: function () {
    // Set focus to the first match:
    // 1\. First element inside the dialog matching [autofocus]
    // 2\. Tabbable element inside the content element
    // 3\. Tabbable element inside the buttonpane
    // 4\. The close button
    // 5\. The dialog itself
    var hasFocus = this.element.find("[autofocus]");
    if (!hasFocus.length) {
        hasFocus = this.element.find(":tabbable");
    }
    if (!hasFocus.length) {
        hasFocus = this.uiDialogButtonPane.find(":tabbable");
    }
    if (!hasFocus.length) {
        hasFocus = this.uiDialogTitlebarClose.filter(":tabbable");
    }
    if (!hasFocus.length) {
        hasFocus = this.uiDialog;
    }
    hasFocus.eq(0).focus();
},

_keepFocus: function (event) {
    function checkFocus() {
        var activeElement = this.document[0].activeElement,
            isActive = this.uiDialog[0] === activeElement ||
                $.contains(this.uiDialog[0], activeElement);
        if (!isActive) {
            this._focusTabbable();
        }
    }
    event.preventDefault();
    checkFocus.call(this);
    // support: IE
    // IE <= 8 doesn't prevent moving focus even with event.preventDefault()
    // so we check again later
    this._delay(checkFocus);
}, 
```

取自这里：[http ://code.jquery.com/ui/1.10.1/jquery-ui.js](http://code.jquery.com/ui/1.10.1/jquery-ui.js)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-28T15:27:47.070

我发现的第二个答案是，在以下代码中，jQuery 将文档绑定到对话框。因此，当我单击所需按钮的 onclick 事件（或您正在处理的任何事件）时取消绑定时：

```
 if (window.jQuery && window.jQuery.ui.dialog) {
   $(document).unbind("focusin.dialog");
 } 
```

这是 jQuery UI 将它的`_focusTabble()`方法绑定到`focusin.dialog`文档事件的地方。

```
if ( !$.ui.dialog.overlayInstances ) {
            // Prevent use of anchors and inputs.
            // We use a delay in case the overlay is created from an
            // event that we're going to be cancelling. (#2804)
            this._delay(function() {
                // Handle .dialog().dialog("close") (#4065)
                if ( $.ui.dialog.overlayInstances ) {
                    this.document.bind( "focusin.dialog", function( event ) {
                        if ( !$( event.target ).closest(".ui-dialog").length &&
                                // TODO: Remove hack when datepicker implements
                                // the .ui-front logic (#8989)
                                !$( event.target ).closest(".ui-datepicker").length ) {
                            event.preventDefault();
                            $(".ui-dialog:visible:last .ui-dialog-content")
                                .data("ui-dialog")._focusTabbable();
                        }
                    });
                }
            });
        } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T17:56:19.783

我为解决这个问题所做的就是注释掉这个`$(".ui-dialog:visible:last .ui-dialog-content").data("ui-dialog")._focusTabbable();`

您可以在下面找到完整的代码：

```
 if ( !$.ui.dialog.overlayInstances ) {
        // Prevent use of anchors and inputs.
        // We use a delay in case the overlay is created from an
        // event that we're going to be cancelling. (#2804)
        this._delay(function() {
            // Handle .dialog().dialog("close") (#4065)
            if ( $.ui.dialog.overlayInstances ) {
                this.document.bind( "focusin.dialog", function( event ) {
                    if ( !$( event.target ).closest(".ui-dialog").length &&
                            // TODO: Remove hack when datepicker implements
                            // the .ui-front logic (#8989)
                            !$( event.target ).closest(".ui-datepicker").length ) {
                        event.preventDefault();
                        //$(".ui-dialog:visible:last .ui-dialog-content")
                            //.data("ui-dialog")._focusTabbable();
                    }
                });
            }
        });
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-08-02T14:40:50.467

另一种停止阻止来自 jquery 对话框的焦点的方法

```
$.widget("ui.dialog", $.ui.dialog, {
    _allowInteraction: function (event) {
        return !!$(event.target).closest(".input-container").length || this._super(event);
    }
}); 
```

`.input-container`包含应该获得焦点的控件的容器在哪里。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-01-06T11:14:05.637

那是因为 jquery 阻止了对话框子之外的焦点，jquery 有这个你可以阅读的方法，它会将你想要允许焦点的其他元素列入白名单。

> "_allowInteraction( event )Returns: Boolean Modal 对话框不允许用户与对话框后面的元素进行交互。这对于不是对话框子元素但绝对定位为看起来好像它们是的元素可能是有问题的。_allowInteraction( ) 方法确定是否应允许用户与给定的目标元素进行交互；因此，它可用于将不是对话框子元素但您希望用户能够使用的元素列入白名单。”

[https://api.jqueryui.com/dialog/#method-_allowInteraction](https://api.jqueryui.com/dialog/#method-_allowInteraction)

因此，我要对具有类**.other-popups**的某些项目禁用此“块焦点”的方法是在代码中添加此行

```
$.widget( "ui.dialog", $.ui.dialog, {
    _allowInteraction: function( event ) {
        return !!$( event.target ).closest( ".other-popups" ).length || this._super( event );
    }
}); 
```

或完全禁用

```
 $.widget( "ui.dialog", $.ui.dialog, {
        _allowInteraction: function( event ) {
            return true ;
        }
    }); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-07-05T14:15:40.320

我有一个类似的问题，我需要将焦点放在我的对话框的内容中（对于 WCAG）。单独使用 focus() 失败了，所以我的最终解决方案是在我添加的对话框实例化中：

```
focus: function(event, ui) {
                    setTimeout(function(){ 
                        $('#element').blur().focus().css({'color': '#000', 'text-decoration' : 'none', 'cursor' : 'default'});
                    }, 500);
                } 
```

我使用超时来确保兼容性。*注意，我将“#element”设置为锚标记（交互式元素），以便获得焦点。这就是造型的原因。

这段代码应该也可以添加到 jQuery 对话框的“打开”功能中。

# ios - CALayer 不呈现其 UIImage 内容

> ID：15665556
> 
> 赞同：2
> 
> 时间：2013-03-27T17:34:04.580
> 
> 标签：ios, core-animation, calayer

我正在将 CALayer 从 OS X 移植到 iOS。

我创建了一个单视图应用程序，在包中复制了图像“body.png”，并定义了一个 UIView 子类：

我希望这种方法在我触摸屏幕时添加一个显示图像的图层，但是图像不显示，只显示框架。

```
-(void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {

UITouch * aTouch = [touches anyObject];
CGPoint loc = [aTouch locationInView:self];
CGPoint p=loc;
CALayer * body = [CALayer layer];
UIImage * img =[UIImage imageNamed:@"body.png"];
[body setBounds:CGRectMake(0, 0, 200, 200)];
[body setPosition:p];

if (img) {
    NSLog(@"body.png loaded");
        [body setBorderWidth:1];
        [body setBorderColor:[[UIColor blackColor] CGColor]];
        [body setContents:(id)img];
    }
    else {
        [body setBackgroundColor:[[UIColor blueColor] CGColor]];
    NSLog(@"body.png not loaded");
    }

    [[self layer] addSublayer:body];
} 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T17:50:41.507

换行

```
[body setContents:(id)img]; 
```

到

```
[body setContents:(id)img.CGImage]; 
```

# python - 在 Python 数据结构中存储 html 元素结构

> ID：15665562
> 
> 赞同：0
> 
> 时间：2013-03-27T17:34:20.870
> 
> 标签：python

我需要关于如何在 python 中的某些数据结构中构造 html 元素的建议，这些元素将在各种函数中传递。我知道这可以用 xpath 轻松完成，但现在我正在寻找不同的解决方案。所以，所有我想要的是表达这种结构：

```
<div class="someclass">
   <div class="class">
      <a href="#">sometext</a>
   </div>
</div> 
```

，在 XPath 中我会写这样的东西 '/div/div/a'。现在我正在尝试混合字典和列表，但无法找出正确的结构。

# javascript - Javascript：不同形式的函数之间的区别

> ID：15665565
> 
> 赞同：2
> 
> 时间：2013-03-27T17:34:26.260
> 
> 标签：javascript, function

```
# Version A - Function Declaration Statement

// Some JavaScript code
function a() {
    // code within function
}
//Some more JavaScript code

# Version B - Function Expression

// Some JavaScript code
var b = function () {
    // code within function
};
// Some more JavaScript code 
```

我一直在阅读 JavaScript：权威指南，我想确保我了解 JavaScript 如何处理这两个版本。我将在下面解释我对每个版本的理解：

**版本 A**

1.  JavaScript 在全局范围内扫描脚本并识别所有变量和函数定义并将它们提升到顶部。变量赋值和函数评估还不会发生。
2.  对于函数 a()，JavaScript 会打包全局上下文并将其与函数的作用域链相关联。此时，函数 a() 将知道步骤 1 中的所有变量和函数定义。
3.  JavaScript 不会评估函数 a()，因此对函数内的本地上下文一无所知。在调用该函数之前，这将保持不变。

**版本 B**

1.  与上面的步骤 1 相同 - JavaScript 在全局范围内扫描脚本并识别所有变量和函数定义并将它们提升到顶部。因为变量 b 被提升到顶部，所以脚本等价于：

    ```
    var b;
    // Some JavaScript code
    b = function (){ /* code within function */ };
    // Some more JavaScript code 
    ```

2.  当 JavaScript 处理变量 b 的赋值时，它看到正在定义一个匿名函数对象。JavaScript 在定义函数时，会将定义函数的上下文（在本例中为全局上下文）打包，并将其与函数的作用域链相关联。此时，匿名函数将知道步骤 1 中的所有变量和函数定义，其中包括未定义的 var b。

3.  因为 JavaScript 看到函数被用作变量赋值中的表达式，所以它将评估函数表达式。当它对函数表达式求值时，它会再次将本地范围内的所有变量和函数定义提升到顶部，如果此函数表达式中有任何函数声明语句，它将打包此本地上下文并将其添加到范围链中这个功能的。
4.  计算函数时返回一个函数对象，然后将函数对象分配给 var b。

如果您可以对每个版本发表评论并让我知道我的理解是否准确，那就太好了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:14:16.280

理论很好，但在现实生活中浏览器使用自己的方言（由于使用自己的引擎并添加了浏览器糖果）。

例如，IE 并不关心您的脚本标签是否指定了“文本/javascript”。无论如何，它都会使用自己的 JScript。

因此（为了设计一种多语言的 EcmaScript 方言），还有助于理解该理论在现实生活中可能不会以同样的方式起作用。

例如，命名函数表达式被视为 BOTH——IE(JScript) 中的函数声明和函数表达式：

```
typeof g; // "function"
var f = function g(){}; 
```

有关其中一些示例，请参阅此链接：http:
[//kangax.github.com/nfe/#jscript-bugs](http://kangax.github.com/nfe/#jscript-bugs)

实际上，这是一个相当完整的“半官方”（来自 MS 的 Pratap Lakshman）概述 JScript 与 ES3 的偏差：
[http ://wiki.ecmascript.org/lib/exe/fetch.php?media=resources:jscriptdeviationsfromes3 .pdf](http://wiki.ecmascript.org/lib/exe/fetch.php?media=resources:jscriptdeviationsfromes3.pdf)

最后，我想指出这个非常有用的视频，Douglas Crockford 在“Crockford on JavaScript - Act III: Function the Ultimate”中解释了一些更彻底的事情：http:
[//youtu.be/ya4UHuXNygM](http://youtu.be/ya4UHuXNygM)

希望这可以帮助！

# php - 无法在 IIS 上运行的功能

> ID：15665569
> 
> 赞同：0
> 
> 时间：2013-03-27T17:34:32.380
> 
> 标签：php, mysql, iis, azure

用户登录后，我正在使用此功能重定向到投资组合...

```
function redirect($destination) 
{

    //handle url
    if (preg_match("/^https?:\/\//", $destination))
    {
        header("Location: " . $destination);
    }

    // handle absolute path
    else if (preg_match("/^\//", $destination))
    {
        $protocol = (isset($_SERVER["HTTPS"])) ? "https" : "http";
        $host = $_SERVER["HTTP_HOST"];
        header("Location: $protocol://$host$destination");
    }

    // handle relative path
    else
    {
        // adapted from http://www.php.net/header
        $protocol = (isset($_SERVER["HTTPS"])) ? "https" : "http";
        $host = $_SERVER["HTTP_HOST"];
        $path = rtrim(dirname($_SERVER["PHP_SELF"]), "/\\");
        header("Location: $protocol://$host$path/$destination");
    }

    // exit immediately since we're redirecting anyway
    exit;
} 
```

使用它会在 chrome 中产生 SSL 连接错误：错误 107 (net::ERR_SSL_PROTOCOL_ERROR): SSL 协议错误。在 firefox 连接到 localhost:63077 时出错。

```
SSL received a record that exceeded the maximum permissible length. 
```

（错误代码：ssl_error_rx_record_too_long

请不要告诉我问题...告诉我解决方案或替代方案 **我有一个 Windows azure 帐户...它甚至无法在那里工作...** 亲切问候 Vishal

PS：我知道这会花费很多时间..我的想象杯项目真的需要这个..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T17:41:41.287

似乎您在获取正确的协议时遇到问题。我不确定这是否适用于 IIS，但我通常在 Linux 上使用以下内容 - 无法想象为什么它不起作用：

```
function getProtocol()
{
        return $_SERVER['SERVER_PORT']=='443'?'https://':'http://';
} 
```

那应该消除代码中的大部分复杂性吗？

# css - IE7中的浮动元素

> ID：15665571
> 
> 赞同：0
> 
> 时间：2013-03-27T17:34:33.553
> 
> 标签：css, internet-explorer, css-float

由于 IE7 对“浮动”的糟糕处理，我花了一个下午的大部分时间来浪费我的时间。如何使用浮动显示两列布局？

我正在努力实现：

![在此处输入图像描述](../Images/4b9143171e4578a9af676d8084ddfbf5.png)

这是我的 HTML。

```
<div class="holder">
                <div class="footer-float-content">
                    <p class="footer-regional-title">AMERICAS</p>
                            <ul>
                                <li><a href="#">EN / United States</a></li>
                                <li><a href="#">PT / Brazil</a></li>
                            </ul>
                            <p class="footer-regional-title">APAC</p>
                            <ul>
                                <li><a href="#">日本語 / 日本</a></li>
                                <li><a href="#">中文 / 中人民共和国</a></li>
                                <li><a href="#">EN / Hong Kong</a></li>
                                <li><a href="#">EN / Singapore</a></li>
                                <li><a href="#">EN / Australia &amp; NZ</a></li>
                                <li><a href="#">ภาษาไทย / ประเทศไทย&lt;/a></li>
                            </ul>
                    </div>
                    <div class="footer-float-content">
                            <p class="footer-regional-title">EMEA</p>
                            <ul>
                                <li><a href="#">EN / United Kingdom</a></li>
                                <li><a href="#">FR / France</a></li>
                                <li><a href="#">NL / Nederland</a></li>
                                <li><a href="#">ES / España</a></li>        
                                <li><a href="#">DE / Deutschland</a></li>   
                                <li><a href="#">EN / India</a></li> 
                                <li><a href="#">RU / Россия</a></li>    
                                <li><a href="#">EN / FR/ NL Belgium</a></li>    
                            </ul>
                        </div>
                    </div> 
```

如您所见，我将采用两列布局。

我的CSS如下：

```
div.footer-float-content
{
float: left;
width: 155px;
display: inline;
padding-left: 20px;

}
.region-block .regions-list ul{

width:155px;

display: inline;
list-style:none;
font-size:13px;
line-height:16px;
}

p.footer-regional-title
{
display: inline;
padding-left: 17px;
font-weight: bold;
font-weight: 10pt;
text-transform: uppercase;
margin: 0;
width: 155px;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T19:51:39.127

**HTML：**

```
<div class="holder">
                <div class="footer-float-content">
                    <p class="footer-regional-title">AMERICAS</p>
                            <ul>
                                <li><a href="#">EN / United States</a></li>
                                <li><a href="#">PT / Brazil</a></li>
                            </ul>
                            <p class="footer-regional-title">APAC</p>
                            <ul>
                                <li><a href="#">日本語 / 日本</a></li>
                                <li><a href="#">中文 / 中人民共和国</a></li>
                                <li><a href="#">EN / Hong Kong</a></li>
                                <li><a href="#">EN / Singapore</a></li>
                                <li><a href="#">EN / Australia &amp; NZ</a></li>
                                <li><a href="#">ภาษาไทย / ประเทศไทย&lt;/a></li>
                            </ul>
                    </div>
                    <div class="footer-float-content">
                            <p class="footer-regional-title">EMEA</p>
                            <ul>
                                <li><a href="#">EN / United Kingdom</a></li>
                                <li><a href="#">FR / France</a></li>
                                <li><a href="#">NL / Nederland</a></li>
                                <li><a href="#">ES / España</a></li>        
                                <li><a href="#">DE / Deutschland</a></li>   
                                <li><a href="#">EN / India</a></li> 
                                <li><a href="#">RU / Россия</a></li>    
                                <li><a href="#">EN / FR/ NL Belgium</a></li>    
                            </ul>
                        </div>
    <div class="clr"></div>
                    </div> 
```

**CSS：**

```
.clr{ clear:both;}
.holder{ padding:0px 20px;}

.holder div:first-child{ float:left;}

div.footer-float-content{ float: right; width: 155px; }

div.footer-float-content ul{ padding:0px; list-style:none;}
div.footer-float-content ul li a{ text-decoration:none; color:#A5CDEB;}
div.footer-float-content ul li a:hover{ color:#6B8596;}

.region-block .regions-list ul{ width:155px; display: inline; list-style:none; font-size:13px; line-height:16px; }

p.footer-regional-title{ font-weight: bold; font-weight: 10pt; text-transform: uppercase; margin: 0;} 
```

# python - 从 irb 加载时将脚本变量保持在范围内

> ID：15665581
> 
> 赞同：0
> 
> 时间：2013-03-27T17:34:48.683
> 
> 标签：python, ruby, ipython, irb

当我在 IPython 中执行脚本时，通过使用`run myscript.py`，脚本中的名称将在交互式解释器中可用，供我进一步试验。

当`irb`我使用运行脚本时，这似乎没有发生`load 'myscript.rb'`。

如何将变量保持在交互式 ruby​​ 的范围内？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T17:37:09.230

局部变量在定义它们的范围内是局部的。这就是它们被称为*局部*变量的原因。如果您在脚本中定义了一个局部变量`myscript.rb`，那么它将被定义在该范围内而*不是其他任何地方*。这就是局部变量的全部意义所在。

如果您想要一个全局可用的变量，请使用全局变量。或者可能是顶级`main`对象的实例变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-11-05T21:56:43.997

我在查看此问题时发现的答案是使用全局变量或类或函数。

因此，例如，如果我正在使用`watir`并且我有一个正在与之交互的浏览器对象，我可以使用以下内容从测试脚本中获取它：

## 全局变量

Watir_test.rb

```
require "watir-webdriver"

browser = Watir::Browser.new :chrome
$b = browser

# all sorts of preliminary stuff I do on the browser object

# end of my test script 
```

现在启动后`irb`，我加载测试文件

```
irb(main):001:0> load './watir_test.rb'
irb(main):002:0> browser
NameError: undefined local variable or method `browser' for main:Object
    from (irb):2
    from C:/Ruby193/bin/irb:12:in `<main>'
irb(main):004:0> $b
=> #<Watir::Browser:0x..fd9200f9a url="http...."> 
```

## 返回的元素

```
test_code.rb

    def test_code
        a = 5    
        return a
    end

> load 'test_code.rb'
> a = test_code() 
```

## 返回 + local_variables

这是一个简洁的示例： [https ://stackoverflow.com/a/1961317/999943](https://stackoverflow.com/a/1961317/999943)

[Ruby local_variables 返回：符号？](https://stackoverflow.com/questions/18618230/ruby-local-variables-returns-symbols)

```
def foo(((a, b, c, d), e, *f), g, *h)
  local_variables.sort.each do |lvar| puts "#{lvar} => #{eval(lvar).inspect}" end
end

foo([[1, 2, 3], 4, 5, 6], 7, 8, 9)
# a => 1
# b => 2
# c => 3
# d => nil
# e => 4
# f => [5, 6]
# g => 7
# h => [8, 9] 
```

# python - 线程中的 subprocess.Popen

> ID：15665582
> 
> 赞同：3
> 
> 时间：2013-03-27T17:34:51.390
> 
> 标签：python, multithreading, subprocess

我有许多文件（超过 4000 个）要同时加载到 PostgreSQL 中。我已将它们分成 4 个不同的文件列表，并且我希望一个线程遍历每个列表来加载数据。

我遇到的问题是我使用 os.system 来调用加载程序，但这会阻止其他线程同时运行。如果我使用 subprocess.Popen ，那么它们会同时运行，但是线程认为它们已经完成了执行，所以转到我脚本的下一部分。

我这样做对吗？或者有没有更好的方法从线程中调用子进程。

```
def thread1Load(self, thread1fileList):
    connectionstring = settings.connectionstring
    postgreshost = settings.postgreshost
    postgresdatabase = settings.postgresdatabase
    postgresport = settings.postgresport
    postgresusername = settings.postgresusername
    postgrespassword = settings.postgrespassword

    tablename = None
    encoding = None
    connection = psycopg2.connect(connectionstring)

    for filename in thread1fileList:
        load_cmd = #load command
        run = subprocess.Popen(load_cmd, shell=True)
    print "finished loading thread 1"

def thread2Load(self, thread2fileList):
    connectionstring = settings.connectionstring
    postgreshost = settings.postgreshost
    postgresdatabase = settings.postgresdatabase
    postgresport = settings.postgresport
    postgresusername = settings.postgresusername
    postgrespassword = settings.postgrespassword

    tablename = None

    connection = psycopg2.connect(connectionstring)
    for filename in thread2fileList:
        load_cmd = #load command            
        run = subprocess.Popen(load_cmd, shell=True)
    print "finished loading thread 2"

def thread3Load(self, thread3fileList):
    connectionstring = settings.connectionstring
    postgreshost = settings.postgreshost
    postgresdatabase = settings.postgresdatabase
    postgresport = settings.postgresport
    postgresusername = settings.postgresusername
    postgrespassword = settings.postgrespassword

    tablename = None
    connection = psycopg2.connect(connectionstring)

    for shapefilename in thread3fileList:
        load_cmd = #load command
        run = subprocess.Popen(load_cmd, shell=True)
    print "finished loading thread 3"

def thread4Load(self, thread4fileList):
    connectionstring = settings.connectionstring
    postgreshost = settings.postgreshost
    postgresdatabase = settings.postgresdatabase
    postgresport = settings.postgresport
    postgresusername = settings.postgresusername
    postgrespassword = settings.postgrespassword

    tablename = None

    connection = psycopg2.connect(connectionstring)

    for filename in thread4fileList:
        load_cmd = #load command
        run = subprocess.Popen(load_cmd, shell=True)

    print "finished loading thread 4"

def finishUp(self):
    print 'finishing up'

def main():
load = Loader()

thread1 = threading.Thread(target=(load.thread1Load), args=(thread1fileList, ))
thread2 = threading.Thread(target=(load.thread2Load), args=(thread2fileList, ))
thread3 = threading.Thread(target=(load.thread3Load), args=(thread3fileList, ))
thread4 = threading.Thread(target=(load.thread4Load), args=(thread4fileList, ))
threads = [thread1, thread2, thread3, thread4]
for thread in threads:
    thread.start()
    thread.join()

load.finishUp(connectionstring)

if __name__ == '__main__':
main() 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-27T17:42:22.660

*   [不要重复自己](http://en.wikipedia.org/wiki/Don%27t_repeat_yourself)。一种`threadLoad`方法就够了。这样，如果您需要修改方法中的某些内容，则无需在 4 个不同的地方进行相同的修改。
*   用于`run.communicate()`阻塞直到子进程完成。
*   这会启动一个线程，然后阻塞直到该线程完成，然后启动另一个线程，等等：

    ```
    for thread in threads:
        thread.start()
        thread.join() 
    ```

    相反，首先启动所有线程，然后加入所有线程：

    ```
    for thread in threads:
        thread.start()
    for thread in threads:
        thread.join() 
    ```

* * *

```
import subprocess
import threading

class Loader(object):
    def threadLoad(self, threadfileList):
        connectionstring = settings.connectionstring
        ...
        connection = psycopg2.connect(connectionstring)

        for filename in threadfileList:
            load_cmd =  # load command
            run = subprocess.Popen(load_cmd, shell=True)
            # block until subprocess is done
            run.communicate()
        name = threading.current_thread().name
        print "finished loading {n}".format(n=name)

    def finishUp(self):
        print 'finishing up'

def main():
    load = Loader()
    threads = [threading.Thread(target=load.threadLoad, args=(fileList, ))
               for fileList in (thread1fileList, thread2fileList,
                                thread3fileList, thread4fileList)]
    for thread in threads:
        thread.start()
    for thread in threads:
        thread.join()

    load.finishUp(connectionstring)

if __name__ == '__main__':
    main() 
```

# google-chrome - CSS 过渡导致标签中的图像在 chrome 中跳转

> ID：15665585
> 
> 赞同：1
> 
> 时间：2013-03-27T17:34:58.887
> 
> 标签：google-chrome, css, css-transitions

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-05-02T21:54:03.220

# html - HTML5 视频快进 - 需要完整下载？

> ID：15665591
> 
> 赞同：0
> 
> 时间：2013-03-27T17:35:24.483
> 
> 标签：html, html5-video

html5 视频快进是否`playbackRate`需要加载所有视频，或者播放器是否从服务器请求它需要的帧？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T11:57:59.853

播放器向服务器请求所需的部分，就像 Youtube

# asp.net - ASP.NET - VB.NET - SQL Server Express 2012 - 存储日期

> ID：15665592
> 
> 赞同：0
> 
> 时间：2013-03-27T17:35:24.717
> 
> 标签：asp.net, vb.net, date, datetime, sql-server-2012-express

我正在尝试从日历控件中获取选定的日期并将其存储到数据库中的列中。

我收到以下错误：

> SqlDateTime 溢出。必须介于 1753 年 1 月 1 日上午 12:00:00 和 9999 年 12 月 31 日晚上 11:59:59 之间。

出生日期数据库栏：

![在此处输入图像描述](../Images/4798cc8526e194464ac14f1b9d100392.png)

VB.注册页面代码：

```
 Public Sub register()

        Dim Username As String = txtUsername.ToString
        Dim Surname As String = txtSurname.ToString
        Dim Password As String = txtPassword.ToString
        Dim Name As String = txtName.ToString
        Dim Address1 As String = txtAddress1.ToString
        Dim Address2 As String = txtAddress2.ToString
        Dim City As String = txtCity.ToString
        Dim Email As String = txtEmail.ToString
        Dim Country As String = drpCountry.ToString
        Dim DOB As Date = calDOB.SelectedDate.Date
        Dim Occupation As String = txtOccupation.ToString
        Dim WorkLocation As String = txtWorkLocation.ToString
        Dim Age As Integer = "20"

        lblDOB.Text = DOB.ToString
        lblDOB.Visible = True

        Dim ProjectManager As String = "test"
        Dim TeamLeader As String = "test"
        Dim TeamLeaderID As Integer = "1"
        Dim ProjectManagerID As Integer = "1"

        Dim RegistrationDate As Date = DateTime.Today
        Dim ContractType As String = "test"
        Dim ContractDuration As Integer = 6
        Dim Department As String = "test"

        Dim conn As New SqlConnection("Data Source=BRIAN-PC\SQLEXPRESS;Initial Catalog=master_db;Integrated Security=True")
        Dim registerSQL As SqlCommand
        Dim sqlComm As String

        sqlComm = "INSERT INTO users(Username, Password, Name, Surname, Address1, Address2, " +
            "City, Country, date_of_birth, age, Occupation, department, work_location, " +
            "project_manager,team_leader, team_leader_id, project_manager_id, " +
            "date_registration, contract_type, contract_duration) " +
            "VALUES(@p1, @p2,@p3,@p4,@p5,@p6,@p7,@p8,@p9,@p10,@p11,@p12,@p13,@p14,@p15," +
            "@p16,@p17,@p18,@p19,@p20)"

        conn.Open()
        registerSQL = New SqlCommand(sqlComm, conn)
        registerSQL.Parameters.AddWithValue("@p1", Username)
        registerSQL.Parameters.AddWithValue("@p2", Password)
        registerSQL.Parameters.AddWithValue("@p3", Name)
        registerSQL.Parameters.AddWithValue("@p4", Surname)
        registerSQL.Parameters.AddWithValue("@p5", Address1)
        registerSQL.Parameters.AddWithValue("@p6", Address2)
        registerSQL.Parameters.AddWithValue("@p7", City)
        registerSQL.Parameters.AddWithValue("@p8", Country)
        registerSQL.Parameters.AddWithValue("@p9", DOB)
        registerSQL.Parameters.AddWithValue("@p10", Age)
        registerSQL.Parameters.AddWithValue("@p11", Occupation)
        registerSQL.Parameters.AddWithValue("@p12", Department)
        registerSQL.Parameters.AddWithValue("@p13", WorkLocation)
        registerSQL.Parameters.AddWithValue("@p14", ProjectManager)
        registerSQL.Parameters.AddWithValue("@p15", TeamLeader)
        registerSQL.Parameters.AddWithValue("@p16", TeamLeaderID)
        registerSQL.Parameters.AddWithValue("@p17", ProjectManagerID)
        registerSQL.Parameters.AddWithValue("@p18", RegistrationDate)
        registerSQL.Parameters.AddWithValue("@p19", ContractType)
        registerSQL.Parameters.AddWithValue("@p20", ContractDuration)

        registerSQL.ExecuteNonQuery()

    End Sub

End Class 
```

异常跟踪：

```
System.Data.SqlClient.SqlException was unhandled by user code
  Class=16
  ErrorCode=-2146232060
  HResult=-2146232060
  LineNumber=1
  Message=String or binary data would be truncated.
The statement has been terminated.
  Number=8152
  Procedure=""
  Server=BRIAN-PC\SQLEXPRESS
  Source=.Net SqlClient Data Provider
  State=13
  StackTrace:
       at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
       at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
       at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
       at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
       at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
       at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite)
       at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite)
       at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean asyncWrite)
       at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
       at Registration.register() in C:\Users\Brian\Google Drive\Dropbox\Dropbox\THESIS\ThesisApp\Registration.aspx.vb:line 89
       at Registration.btnRegister_Click(Object sender, EventArgs e) in C:\Users\Brian\Google Drive\Dropbox\Dropbox\THESIS\ThesisApp\Registration.aspx.vb:line 14
       at System.Web.UI.WebControls.Button.OnClick(EventArgs e)
       at System.Web.UI.WebControls.Button.RaisePostBackEvent(String eventArgument)
       at System.Web.UI.WebControls.Button.System.Web.UI.IPostBackEventHandler.RaisePostBackEvent(String eventArgument)
       at System.Web.UI.Page.RaisePostBackEvent(IPostBackEventHandler sourceControl, String eventArgument)
       at System.Web.UI.Page.RaisePostBackEvent(NameValueCollection postData)
       at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)
  InnerException: 
```

**更新：**添加了新的错误消息，因为我修复了**RegistrationDate**和**DOB**。现在我收到一条新的错误消息：

```
String or binary data would be truncated.
The statement has been terminated. 
```

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:17:43.637

这可能有点用
[http://jwcooney.com/2012/09/10/asp-net-choosing-parameters-add-or-parameters-addwithvalue/](http://jwcooney.com/2012/09/10/asp-net-choosing-parameters-add-or-parameters-addwithvalue/)

esp.第二点 *Implicit Data Conversions Cause Data Errors*

..`You can accidentally introduce data errors if you use the Parameters.AddWithValue syntax to send a date datatype to your database, then you are at the mercy of the database to identify how it will store your date value. This can lead to problems since there are numerous ways of entering dates: mm/dd/yyyy in North America, dd/mm/yyyy in the UK, and yyyy-mm-dd as an upcoming standard. The database will look at the date value of 1/2/2012 that you are sending and can handle the ’1′ as either the day or as the month.`

我建议使用：

```
registerSQL.Parameters.Add("@p9", SqlDbType.DateTime).Value = DOB.Date 
```

代替 `registerSQL.Parameters.AddWithValue("@p9", DOB)`

确保`DOB`不是`DateTime.MinValue`或`DateTime.MaxValue`

也可以参考这个问题：

[SQL Server 2005 中向存储过程添加参数的区别](https://stackoverflow.com/questions/5445663/difference-between-adding-parameters-to-stored-procedure-in-sql-server-2005)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T17:51:39.043

将它分配给参数时有什么**值**？`DOB``@p9`

或者可能`RegistrationDate`是罪魁祸首？当您将其分配给参数时，该变量具有什么**值**`@p18`？

`DATETIME`如果您在 SQL Server 中有一个列并且您尝试从 .NET 应用程序插入其中，则通常会发生此错误`NULL`- 该列被转换`01/01/0001`为超出`DATETIME`.

因此我的建议：在 SQL Server **2008 和更高版本**`DATE`中使用（如果您只需要日期 - 没有时间）或**（**对于日期和时间） （没有这些值范围限制）`DATETIME2`**`DATETIME2`**`DATETIME`****

# java - 使用 URI 在 java 中复制目录

> ID：15665596
> 
> 赞同：-3
> 
> 时间：2013-03-27T17:35:44.847
> 
> 标签：java, file, copy, uri, dir

您能否告诉我，如何使用 URI 将目录从一个路径复制到另一个路径（简单方式）。请提供任何示例。

感谢您查看这个..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T17:47:16.240

您应该尝试 Apache Commons IO：[http](http://commons.apache.org/proper/commons-io/)
://commons.apache.org/proper/commons-io/ 更具体的 FileUtils.copyDirectory 方法：[http ://commons.apache.org/proper/commons-io/javadocs/api-发布/org/apache/commons/io/FileUtils.html](http://commons.apache.org/proper/commons-io/javadocs/api-release/org/apache/commons/io/FileUtils.html)

# jquery - Fancybox2 之外的页面滚动发生了什么

> ID：15665597
> 
> 赞同：-1
> 
> 时间：2013-03-27T17:35:45.483
> 
> 标签：jquery, fancybox, fancybox-2

我刚刚将一个应用程序更新到 jQuery 1.9 并升级到 FancyBox 2.0。当 Fancybox 可见时，我喜欢滚动外部页面。

此功能是否已删除？也许是因为它的新响应能力。我在 API 或更新中找不到它。由于切换 Fancybox 时隐藏了外部滚动条，我正在换班。如果外部页面滚动功能已被删除，我将修复一些问题。

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-27T20:42:02.637

使用fancybox 2，滚动外部页面是`locked`，但是您可以在选项中启用/禁用该功能，`helpers`例如：

```
$(".fancybox").fancybox({
    helpers: {
        overlay: {
            locked: false // if true (default), the content will be locked into overlay
        }
    }
}); 
```

如果您还希望 fancybox 沿页面滚动，请添加 API 选项`autoCenter` 并将其设置为`false`

```
$(".fancybox").fancybox({
    helpers: {
        overlay: {
            locked: false // if true, the content will be locked into overlay
        }
    },
    autoCenter : false // fancybox will scroll along the content
}); 
```

见**[JSFIDDLE](http://jsfiddle.net/suvtP/)**

# r - 以树格式存储数据 R

> ID：15665603
> 
> 赞同：-1
> 
> 时间：2013-03-27T17:36:04.740
> 
> 标签：r

我想在 r 中以树格式存储数据。R中有没有可以使用的包？数据样本：

```
lat lon ,v1,v2,v3,parent,id
23.9917345,90.4195876,83,3,0,0,1 
```

这里的父列代表当前行的父id

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T19:51:36.267

您可以在不循环的情况下找到孩子`aggregate(id, by=list(parent=parent), paste, collapse=" ")`：

例子：

```
> n <- 30; d <- data.frame(parent=sample(n,n,TRUE), id=1:n, value=runif(n))
> children <- with(d, aggregate(id, by=list(parent=parent), paste, collapse=" "))
> children
   parent        x
1       2       24
2       3 12 20 28
3       4        5
4       7  8 17 18
5       8       29 
```

（剪断）

现在您可以将其合并到原始数据集中：

```
> names(children) <- c("id", "children")
> merge(d, children, all.x=TRUE)
   id parent       value children
1   1     13 0.319805784     <NA>
2   2     24 0.847229065       24
3   3     21 0.946230816 12 20 28
4   4     12 0.915684833        5
5   5      4 0.754628841     <NA> 
```

（剪断）

# html - HTML CSS 表单 - 如何使表单在 页面上居中？

> ID：15665607
> 
> 赞同：0
> 
> 时间：2013-03-27T17:36:17.240
> 
> 标签：html, css, forms, margin

我制作了一个表格，我试图将它放在页面中心，但它不起作用。我尝试将这 2 个 CSS 应用于它，但它没有用。

```
form{margin: 0 auto;}

form{margin: auto;} 
```

我还尝试将表单包含在 div.container 中并对其应用相同的 CSS，但仍然没有。

但这有效：

```
{margin: 0 250px 0;} 
```

[在这里](http://jsfiddle.net/bMf9M/)形成

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-27T17:38:51.987

你需要做两件事来实现这一点：

1)`inline-block`将表单上的显示更改为`block`。
2）固定宽度（你目前有它`auto`）。

演示：http: [//jsfiddle.net/bMf9M/2/](http://jsfiddle.net/bMf9M/2/)

或者，如果您不想修复表单大小，可以使用`text-align: center`（感谢@donderpiet）

演示：http: [//jsfiddle.net/bMf9M/4/](http://jsfiddle.net/bMf9M/4/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T17:38:32.243

您必须将容器的宽度指定为具有`display:block`属性的元素，该元素会自动调整为其容器的最大宽度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T17:38:50.953

如果您喜欢使用 margin:auto; 则需要设置宽度

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-27T17:40:41.970

你`form`有一个 property `display: inline-block;`，这使它的行为像一个内联元素。因此，您必须添加`text-align: center;`到其父级以使其水平居中。像这样：http: [//jsfiddle.net/bMf9M/4/](http://jsfiddle.net/bMf9M/4/)。

不要忘记将表单设置`text-align`为`left`，否则它将具有居中对齐的文本。

# mongodb - mongodb聚合框架的自定义投影功能

> ID：15665618
> 
> 赞同：2
> 
> 时间：2013-03-27T17:37:08.837
> 
> 标签：mongodb, aggregation-framework, nosql

我想通过提供一个接收对象并返回一个键的javascript代码来拥有一个自定义投影功能，就像在标准`group`操作的情况下一样。

只是一个例子，我想按平台计算浏览器的用户代理字符串。为了得到这个平台，我只需要通过匹配来计算它们。例如，`/Android/`vs `/iPad/`vs `/iPhone/`（分别计算）。

现在 mongodb 是否支持它？如果没有，我可以投票支持任何特定的功能请求吗？

**更新：**创建了一个功能请求：[https](https://jira.mongodb.org/browse/SERVER-9156) ://jira.mongodb.org/browse/SERVER-9156 。

# c - TI-84：使用 z88dk 从目录中调用函数

> ID：15665621
> 
> 赞同：5
> 
> 时间：2013-03-27T17:37:11.747
> 
> 标签：c, assembly, ti-basic, z80

我正在使用 z88dk 用 C 语言对我的 TI-84 进行编程。我需要调用 normalcdf 和 Ztest 之类的东西。我知道可以从 ti-BASIC 调用它们，但是如何从 C 或内联汇编调用它们？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-06-19T21:07:56.850

在 TI-84 汇编中，您使用`BCALL`or`B_CALL`指令对 TI-84 的 ROM 进行“系统调用”。这通常用于简单的 I/O 事情（`B_CALL PutS`将字符串打印到屏幕上），但也可能用于更复杂的数学例程（`LD A,OPNormal; B_CALL BinOPExec`计算`normalcdf(`函数）。

谷歌[“ti-84 bcall BinOPExec”](http://www.google.com/#output=search&q=ti84+bcall+binopexec)了解更多信息`B_CALL`。

# c++ - 检查算法中的数值精度

> ID：15665622
> 
> 赞同：1
> 
> 时间：2013-03-27T17:37:13.847
> 
> 标签：c++, algorithm, numerical

检查算法中数值精度的最佳做法是什么？是否有任何建议的技术来解决“我们如何知道我们计算的结果是正确的”这个问题？如果可能：是否有一些 C++ 中数值精度增强的例子？

感谢您的任何建议！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T17:42:36.563

[Math::BigFloat](http://search.cpan.org/~pjacklam/Math-BigInt-1.997/lib/Math/BigFloat.pm) / [Math::BigInt](http://search.cpan.org/~pjacklam/Math-BigInt-1.997/lib/Math/BigInt.pm)会有所帮助。我必须说有很多图书馆可以做到这一点，我不知道哪个是最好的。也许其他人有一个很好的答案给你。

不过，一般来说，您可以编写两次：一次具有无限精度，一次没有然后验证两者。这就是我使用我编写的科学软件所做的。然后我会写第三个来提高速度。这样我就可以验证所有三个。请注意，我知道这三个不会完全相等，但它们应该有足够的佐证有效数字。

要真正*知道*有多少误差很难准确获得——记住浮点数的运算顺序会导致很大的差异。这确实是特定于问题的，但是如果您知道某些数字的相对大小，则可以更改操作顺序以获得准确性（例如，将列表按排序顺序相乘）。寻找调查的两个地方是，

*   浮点运算手册
*   [每个计算机科学家都需要了解浮点运算。](http://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html)
*   [浮点数剖析](http://www.johndcook.com/blog/2009/04/06/anatomy-of-a-floating-point-number/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T17:51:11.193

看看区间算术，例如

[http://www.boost.org/doc/libs/1_53_0/libs/numeric/interval/doc/interval.htm](http://www.boost.org/doc/libs/1_53_0/libs/numeric/interval/doc/interval.htm)

它将产生结果的上限和下限

PS：也看看[http://www.cs.cmu.edu/~quake/robust.html](http://www.cs.cmu.edu/~quake/robust.html)

# javascript - 使用 RequireJS 和 AMD 分发包含内部依赖项的项目

> ID：15665625
> 
> 赞同：0
> 
> 时间：2013-03-27T17:37:26.403
> 
> 标签：javascript, requirejs, amd

我有一个我创建的开源 JavaScript 表单验证库。最近，一位贡献者帮助修改了我的库以支持 AMD。在过去的一两个月里，我一直在重构我的库以增强可维护性、模块化和可读性。本质上，我已将逻辑片段提取到独立的模块中。但是，这些模块都位于主模块内。

在看了 AMD 是怎么做的之后，我觉得如果我能够将这些内部模块拆分到它们自己的单独文件中，那将是有益的。我来自 Java 背景，从这个角度来看，这些单独的模块对我来说就像是类，我想将它们分开。这也将帮助我更好地管理我的依赖关系并实施适当的模块化。我认为从长远来看，这将使代码变得更好。

我知道 RequireJS 有一个“优化”功能，它将所有依赖项组合到一个文件中并最小化它。

我的问题是：这个缩小的文件是否也与 AMD 兼容？也就是说，该文件会将自己暴露为 AMD 模块吗？项目本身的依赖都是内部的，我不想单独公开。但是，我仍然希望开发人员能够将我的库作为独立模块导入。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T17:50:57.573

> 这个缩小的文件是否也与 AMD 兼容？也就是说，该文件会将自己暴露为 AMD 模块吗？

Require.js 不需要生成 AMD 兼容模块。您必须使您的库与 AMD 兼容。它应该发生在您的`main`文件中。您可以从[lowdash](https://github.com/bestiejs/lodash/blob/master/lodash.js#L5425)中了解如何操作。他们创建了与 Node 和 Require.js 兼容的库。他们基本上是在寻找全局变量来检测 Node 和 Require。

```
/** Detect free variable `exports` */
  var freeExports = typeof exports == 'object' && exports;

  /** Detect free variable `module` */
  var freeModule = typeof module == 'object' && module && module.exports == freeExports && module;

  /** Detect free variable `global` and use it as `window` */
  var freeGlobal = typeof global == 'object' && global;
  if (freeGlobal.global === freeGlobal) {
    window = freeGlobal;
  } 
```

在末尾：

```
 // if (typeof define == 'function' && typeof define.amd == 'object' && define.amd) {
    // Expose Lo-Dash to the global object even when an AMD loader is present in
    // case Lo-Dash was injected by a third-party script and not intended to be
    // loaded as a module. The global assignment can be reverted in the Lo-Dash
    // module via its `noConflict()` method.
    window._ = _;

    // define as an anonymous module so, through path mapping, it can be
    // referenced as the "underscore" module
    define(function() {
      return _;
    });
  }
  // check for `exports` after `define` in case a build optimizer adds an `exports` object
  else if (freeExports && !freeExports.nodeType) {
    // in Node.js or RingoJS v0.8.0+
    if (freeModule) {
      (freeModule.exports = _)._ = _;
    }
    // in Narwhal or RingoJS v0.7.0-
    else {
      freeExports._ = _;
    }
  }
  else {
    // in a browser or Rhino
    window._ = _;
  } 
```

# r - 在R中拟合黄土线

> ID：15665627
> 
> 赞同：2
> 
> 时间：2013-03-27T17:37:29.693
> 
> 标签：r, simulation, predict, loess

我在 R 中使用`loess()`and时遇到了一些问题`predict()`。我使用以下代码来模拟数据：

```
Overall=0.6
RR=1.1
Noise=0.05

x=seq(from=0.01, to=10, by=0.01) 
logRR=log(RR)
logBeta0=log(Overall)

linear.pred = logBeta0 + (logRR*x) + rnorm(length(x), 0, Noise*sqrt(x))
linear.pred.high = logBeta0 + (logRR*15) + rnorm(length(x), 0, Noise/5)

PoissonRate <- function (x) ifelse(x<=9, exp(linear.pred), exp(linear.pred.high))

xyplot(PoissonRate(x)~x) #the shape of the 'raw' data

loess_fit <- loess(x~PoissonRate(x))
lines(predict(loess_fit), col = "black") 
```

抱歉，但我不知道如何附上图片来展示它的样子！

最后两行代码最终只是在图表的一半处添加了一条随机黑线，尽管当我之前在不同（非常相似的）数据上使用此命令时，它似乎工作正常。我错过了什么？！任何帮助都会很棒，谢谢:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T17:56:54.170

至少在我看来，你不应该在通话之外打电话`llines()`（如果这是你的意思`lines()`） 。有：`xyplot``?llines`

```
Description:

     These functions are intended to replace common low level
     traditional graphics functions, primarily for use in panel
     functions. 
```

因此，一种选择是按照它的建议进行操作并即时构建您自己的面板功能。这是一个例子：

```
set.seed(1)
dat <- data.frame(pr = PoissonRate(x), x = x)
loess_fit <- loess(pr ~ x, data = dat)

xyplot(PoissonRate(x) ~ x,
  panel = function(x, y, ...) {
    panel.xyplot(x, y, ...)
    llines(dat$x, predict(loess_fit), col.line = "red")
  }) 
```

产生：

![在此处输入图像描述](../Images/ecf8b4ac016c33a10b27a982fcf39b77.png)

一般来说，我可能会以不同的方式来做这件事——我会在公式之外生成数据。我希望`predict`新数据位置均匀分布在`x`. 这样，即使输入数据不是按递增顺序排列的，`x`您也可以获得可用于线图的合理预测。例如

```
## following on from the above
pred <- with(dat, data.frame(x = seq(min(x), max(x), length = 100)))
pred <- transform(pred, pr = predict(loess_fit, newdata = x))

xyplot(PoissonRate(x) ~ x,
  panel = function(x, y, ...) {
    panel.xyplot(x, y, ...)
    with(pred, llines(x, pr, col.line = "red"))
  }) 
```

# c# - 为什么等待异步这么慢？

> ID：15665635
> 
> 赞同：19
> 
> 时间：2013-03-27T17:37:57.693
> 
> 标签：c#, multithreading, performance, .net-4.5, async-await

我终于得到了 VS2012 并得到了一个简单的演示，并努力检查异步和等待的潜在性能提升，但令我沮丧的是它更慢！可能我做错了什么，但也许你可以帮助我。（我还添加了一个简单的 Threaded 解决方案，并且运行速度比预期的更快）

我的代码根据系统上的内核数（-1）使用一个类来对数组求和同样的事情，但有异步/等待。

代码：（请注意，您需要添加参考以`System.Management`使核心检测器工作）

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Threading;
using System.Management;
using System.Diagnostics;

namespace AsyncSum
{
    class Program
    {
        static string Results = "";

        static void Main(string[] args)
        {
            Task t = Run();
            t.Wait();

            Console.WriteLine(Results);
            Console.ReadKey();
        }

        static async Task Run()
        {
            Random random = new Random();

            int[] huge = new int[1000000];

            for (int i = 0; i < huge.Length; i++)
            {
                huge[i] = random.Next(2);
            }

            ArraySum summer = new ArraySum(huge);

            Stopwatch sw = new Stopwatch();

            sw.Restart();
            long tSum = summer.Sum();
            for (int i = 0; i < 100; i++)
            {
                tSum = summer.Sum();
            }
            long tticks = sw.ElapsedTicks / 100;

            long aSum = await summer.SumAsync();
            sw.Restart();
            for (int i = 0; i < 100; i++)
            {
                aSum = await summer.SumAsync();
            }
            long aticks = sw.ElapsedTicks / 100;

            long dSum = summer.SumThreaded();
            sw.Restart();
            for (int i = 0; i < 100; i++)
            {
                dSum = summer.SumThreaded();
            }
            long dticks = sw.ElapsedTicks / 100;

            long pSum = summer.SumParallel();
            sw.Restart();
            for (int i = 0; i < 100; i++)
            {
                pSum = summer.SumParallel();
            }
            long pticks = sw.ElapsedTicks / 100;

            Program.Results += String.Format("Regular Sum: {0} in {1} ticks\n", tSum, tticks);
            Program.Results += String.Format("Async Sum: {0} in {1} ticks\n", aSum, aticks);
            Program.Results += String.Format("Threaded Sum: {0} in {1} ticks\n", dSum, dticks);
            Program.Results += String.Format("Parallel Sum: {0} in {1} ticks\n", pSum, pticks);
        }
    }

    class ArraySum
    {
        int[] Data;
        int ChunkSize = 1000;
        int cores = 1;

        public ArraySum(int[] data)
        {
            Data = data;

            cores = 0;
            foreach (var item in new System.Management.ManagementObjectSearcher("Select * from Win32_Processor").Get())
            {
                cores += int.Parse(item["NumberOfCores"].ToString());
            }
            cores--;
            if (cores < 1) cores = 1;

            ChunkSize = Data.Length / cores + 1;
        }

        public long Sum()
        {
            long sum = 0;
            for (int i = 0; i < Data.Length; i++)
            {
                sum += Data[i];
            }
            return sum;
        }

        public async Task<long> SumAsync()
        {
            Task<long>[] psums = new Task<long>[cores];
            for (int i = 0; i < psums.Length; i++)
            {
                int start = i * ChunkSize;
                int end = start + ChunkSize;

                psums[i] = Task.Run<long>(() =>
                {
                    long asum = 0;
                    for (int a = start; a < end && a < Data.Length; a++)
                    {
                        asum += Data[a];
                    }
                    return asum;
                });
            }

            long sum = 0;
            for (int i = 0; i < psums.Length; i++)
            {
                sum += await psums[i];
            }

            return sum;
        }

        public long SumThreaded()
        {
            long sum = 0;
            Thread[] threads = new Thread[cores];
            long[] buckets = new long[cores];
            for (int i = 0; i < cores; i++)
            {
                int start = i * ChunkSize;
                int end = start + ChunkSize;
                int bucket = i;
                threads[i] = new Thread(new ThreadStart(() =>
                {
                    long asum = 0;
                    for (int a = start; a < end && a < Data.Length; a++)
                    {
                        asum += Data[a];
                    }
                    buckets[bucket] = asum;
                }));
                threads[i].Start();
            }

            for (int i = 0; i < cores; i++)
            {
                threads[i].Join();
                sum += buckets[i];
            }

            return sum;
        }

        public long SumParallel()
        {
            long sum = 0;
            long[] buckets = new long[cores];
            ParallelLoopResult lr = Parallel.For(0, cores, new Action<int>((i) =>
            {
                int start = i * ChunkSize;
                int end = start + ChunkSize;
                int bucket = i;
                long asum = 0;
                for (int a = start; a < end && a < Data.Length; a++)
                {
                    asum += Data[a];
                }
                buckets[bucket] = asum;
            }));

            for (int i = 0; i < cores; i++)
            {
                sum += buckets[i];
            }

            return sum;
        }
    }
} 
```

有什么想法吗？我做错了异步/等待吗？我很乐意尝试任何建议。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-03-27T17:57:46.650

将“异步”与“并行”区分开来很重要。 `await`是否有助于使编写异步代码更容易。并行运行的代码可能（或可能不）涉及异步，而异步代码可能会或可能不会并行运行。

没有什么`await`是旨在使并行代码更快的。的目的`await`是使编写异步代码*更容易*，同时最大限度地减少对性能的负面影响。使用`await`永远不会比正确编写的非等待异步代码快（尽管因为编写正确的代码`await`更容易，但有时会更快，因为程序员在没有等待的情况下无法正确编写异步代码，或者不是愿意花时间这样做。如果非异步代码编写得好，它的性能将与代码一样好，如果不是好一点的话`await`。

C# 确实有专门针对并行化的支持，但不是专门针对`await`. 任务并行库 (TPL) 和并行 LINQ (PLINQ) 有几种非常有效的并行代码方法，这些方法通常比简单的线程实现更有效。

在您的情况下，使用 PLINQ 的有效实现可能是这样的：

```
public static int Sum(int[] array)
{
    return array.AsParallel().Sum();
} 
```

请注意，这将有效地将输入序列划分为并行运行的块；它将负责确定块的适当大小和并发工作人员的数量，并将适当地聚合这些工作人员的结果，以确保正确同步以确保正确的结果（与您的线程示例不同）和高效（这意味着它不会完全序列化所有聚合）。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-03-27T17:55:45.100

`async`不适用于重型并行计算。您可以使用`Task.Run`with进行基本的并行工作`Task.WhenAll`，但任何严重的并行工作都应使用任务并行库（例如`Parallel`）来完成。客户端的异步代码是关于*响应*性的，而不是*并行处理*。

一种常见的方法是`Parallel`用于*并行*工作，然后将其包装在 a 中`Task.Run`并`await`在其上使用以保持 UI 响应。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-03-27T18:08:14.060

您的基准有几个缺陷：

*   您正在计时第一次运行，其中包括初始化时间（加载`class Task`、JIT 编译等）
*   您正在使用`DateTime.Now`，这对于毫秒范围内的计时来说太不准确了。你需要使用`StopWatch`

解决了这两个问题；我得到以下基准测试结果：

```
Regular Sum:  499946 in 00:00:00.0047378
Async Sum:    499946 in 00:00:00.0016994
Threaded Sum: 499946 in 00:00:00.0026898 
```

Async 现在是最快的解决方案，耗时不到 2 毫秒。

这是下一个问题：像 2ms 这样快的时间是非常不可靠的；如果其他进程在后台使用 CPU，您的线程可能会暂停更长的时间。您应该对数千次基准运行的结果进行平均。

另外，您的核心检测数量是怎么回事？我的四核使用的是 333334 的块大小，它只允许运行 3 个线程。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-03-27T17:55:58.677

快速浏览一下，结果是预期的：您的 async sum 仅使用一个线程，而您异步等待它完成，因此它比多线程 sum 慢。

如果您在完成工作时还有其他事情要完成，您将使用异步。因此，这不是任何速度/响应改进的正确测试。

# bash - awk - 如果列 = null

> ID：15665637
> 
> 赞同：9
> 
> 时间：2013-03-27T17:38:05.870
> 
> 标签：bash, awk

使用 awk，您将如何分配“null”值来读取？

我确定这有一个固定的字符，我只是找不到它。

例如，

我有一串这样的awk：

```
awk '
$3==24{print "stuff"}
$3==23{print "stuff"}
' 
```

我需要知道如何使用相同的格式来计算空白列，以便 if $3 = blank {print "stuff"}

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-27T17:40:02.787

尝试这样做：

```
awk '
    $3==24{print "stuff"}
    $3==23{print "stuff"}
    !$3{print "null"}
' file.txt 
```

如果您需要处理`$3`它是否为零（`false`for `awk`），请尝试这样做：

```
!$3 && $3 != 0{print "null"} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-03-27T17:45:06.447

在默认的 awk 处理中，没有“空白”列之类的东西。

字段由空格分隔，即一个*或多个*空格字符（基本上是制表符和空格）。所以给定这个输入：

```
this that the_other
foo       bar 
```

对于第一行`$1`, `$2`, 和`$3`, , 和`this`,和, 但对于第二行是, 不管第一和第二字段之间有多少空白。`that``the_other``bar``$2`

如果您指定不同的字段分隔符，则可以有空字段：

```
$ ( echo 'this:that:the_other' ; echo 'foo::bar' ) | awk -F: '{print $3}'
the_other
bar 
```

或者，如果您更喜欢在脚本本身中设置字段分隔符：

```
$ ( echo 'this:that:the_other' ; echo 'foo::bar' ) | \
    awk 'BEGIN { FS = ":" } {print $3}'
the_other
bar 
```

但是您可以使用正则表达式作为字段分隔符：

```
$ ( echo 'this that the_other' ; echo 'foo  bar' ) | \
  awk 'BEGIN { FS = "[ ]" } {print $3}'
the_other
bar 
```

（一些*非常*老的 Awk 实现在这里可能不支持它的正则表达式。）

正则表达式`"[ ]"`没有得到与空格字符相同的特殊处理。

对 GNU awk 手册的参考：

[默认字段拆分](http://www.gnu.org/software/gawk/manual/html_node/Default-Field-Splitting.html)：

> 字段通常由空格序列（空格、制表符和换行符）分隔，而不是由单个空格分隔。一行中的两个空格不分隔空字段。字段分隔符的默认值`FS`是一个包含单个空格的字符串，`" "`. 如果 awk 以通常的方式解释这个值，每个空格字符将分隔字段，因此一行中的两个空格将在它们之间形成一个空字段。不会发生这种情况的原因是单个空格作为 的值`FS`是一种特殊情况——它被用来指定分隔字段的默认方式。
> 
> 如果`FS`是任何其他单个字符，例如`","`，则该字符的每次出现都会分隔两个字段。两个连续的事件界定了一个空字段。如果字符出现在行首或行尾，则也将界定一个空字段。空格字符是唯一不遵循这些规则的单个字符。

和[使用正则表达式分隔字段](http://www.gnu.org/software/gawk/manual/html_node/Regexp-Field-Splitting.html)。

但要小心这一点；要么您必须修改文件以使用不同的分隔符，要么您的解析将对字段之间的空格数敏感（`foo bar`（有一个空格）将不同于`foo bar`（有两个空格））。

根据您的应用程序，您可能会考虑按列号而不是按 awk 识别的字段来解析行。

# php - 为什么 PHP 在我的 HTML 电子邮件中添加 `target="_blank"`？

> ID：15665642
> 
> 赞同：1
> 
> 时间：2013-03-27T17:38:12.417
> 
> 标签：php, html, email

我有一个 PHP 脚本，它写出包含两个链接的 HTML 电子邮件。一个链接只是网站的常规 URL。另一种是让 iPhone 用户直接连接到应用程序。代码看起来像这样：

```
$mailLinkA = '<a href="http://www.mysite.com">web link text</a>';
$mailLinkB = '<a href="myappname://?variable">iphone app link text</a>'; 
```

但是，当邮件到达时，链接都完全被删除了。

在邮件链接的情况下，`target="_blank"`添加了这个额外的文本，但它破坏了语法并破坏了链接：

```
<a target="_blank" ="http://www.mysite.com">web link text</a> 
```

在 iPhone 应用程序链接的情况下，链接标签中的所有内容都被删除，留下一个格式错误的标签：

```
<a>web link text</a> 
```

在我使用 PHP 的这些年里，我从未见过这样的行为，也从未`target="_blank"`听说*过*. 所以我完全感到困惑。

也许`target="_blank"`是我应该或不应该在我的链接中拥有的东西。但是我认为如果我决定添加它应该由我来添加，而不是一些默认包含在我的代码中。

此外，为什么我的 iPhone 链接被简单地破坏了？

我如何控制这种行为并让 PHP 让我输入链接而不是试图弄乱它们？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T17:44:40.967

每个邮件服务 Hotmail / Gmail 或 Outlook 等软件都会重新定义您的 HTML，一个逻辑问题是将目标 _blank 放置在另一个选项卡/窗口中，而不是在邮件服务的选项卡中。服务器通常会更改 HTML，这就是为什么要对邮件模板进行编程以与例如 Outlook 兼容的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T17:48:48.260

您从哪个电子邮件网站收到来自您的代码的电子邮件。因为许多电子邮件提供商（如 gmail、hotmail 等）会将任何链接更改为“target=_blank”。所以，这是常态。

# c++ - 在 C++ 中克隆对象，完全重复（构造后的数据集）

> ID：15665650
> 
> 赞同：2
> 
> 时间：2013-03-27T17:38:38.600
> 
> 标签：c++, copy, clone

有没有一种快速的方法可以在 C++ 中精确复制现有对象？

例如，我有一个默认构造函数，它使大多数变量未初始化，并且这些变量将在稍后的过程中设置。然后我想用已经初始化的所有数据制作该对象的精确副本。

我听说 C++ 中有一个复制构造函数，但我不确定如何使用它，也不知道它是否适合我的情况。除了手动复制所有数据之外，还有其他方便的方法吗？

**编辑：** 我在这个对象中有很多用户定义的类型（图表等复杂的东西）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T17:43:15.147

您需要使用复制构造函数。如果你不实现，编译器会为你提供一个默认的。如果存在无法按值复制的成员（如动态分配的指针），最好自己实现，并确保创建了深拷贝。

但是，不要忘记，一旦您选择实现复制构造函数，这表明您很可能需要实现复制赋值运算符以及析构函数。这通常被称为C++[中的三原则。](https://stackoverflow.com/questions/4172722/what-is-the-rule-of-three)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T17:45:46.357

如果您的成员是 POD 类型，或者它们本身是可复制的，那么编译器将生成一个默认的复制构造函数。

```
class Foo
{
public:
   Foo(int x, int y, int z, const std::string& name)
      : x_(x), y_(y), z_(z), name_(name)
   {
   }

private:
   int x_, y_, z_;
   std::string name_;
}; 
```

此示例类可使用默认复制构造函数进行复制。以下都是正确的：

```
Foo a(1, 2, 3, "four");

// copy construct b from a, using the compiler provided default copy constructor
Foo b(a);

Foo c(5, 6, 7, "eight");

// copy c from b, c's current values are "lost"    
c = b; 
```

如果您有一个包含用户定义类型的类在浅拷贝中无法按预期执行，那么您将需要编写自己的复制构造函数、赋值运算符和析构函数。这就是为什么大多数有经验的 C++ 开发人员会尽可能远离原始指针（和其他类似概念）。

```
class BadFoo
{
public:
   BadFoo() : x_(new int(5))
   {
   }

   // ... You need to manage the memory of x_ on your own
   // This means following the rule of 3 (C++03) or 5 (C++11)

private:
   int* x_;
}; 
```

参见： [三法则](http://en.wikipedia.org/wiki/Rule_of_three_%28C++_programming%29)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T17:44:24.080

复制构造函数是要走的路。

```
class MyObject
{
    public:
        MyObject(const MyObject& other);    
    private:
        int x;
        float y;
        std::string s;
}
MyObject::MyObject(const MyObject& other)
    : x(other.x), y(other.y), s(other.s)
{} 
```

[在此处查看其他示例](http://www.cplusplus.com/articles/y8hv0pDG/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-27T17:45:49.223

您必须手动定义复制过程。如果您重复使用相同的资源或想要该资源的副本，编译器怎么知道？

默认的复制构造函数（它始终存在，除非您定义自己的构造函数）将通过简单的赋值复制所有数据，这可能对指针、文件、连接和所有其他外部资源有害。

# d3.js - d3 饼图转换与 attrtween

> ID：15665652
> 
> 赞同：2
> 
> 时间：2013-03-27T17:38:40.967
> 
> 标签：d3.js, transition, pie-chart

我试图以某种方式扫入半圆环图，这意味着从空白屏幕开始，图表开始在 -90 度（或 270 度）处绘制并执行半圆直到达到 90 度。代码如下：

```
var width = 800;
var height = 400;
var radius = 300;
var grad=Math.PI/180;
var data = [30, 14, 4, 4, 5];
var color = d3.scale.category20();
var svg = d3.select("body").append("svg").attr("width", width).attr("height", 
`height).append("g").attr("transform", "translate(" + radius*1.5 + "," + radius*1.5 + 
")");
var arc = d3.svg.arc().innerRadius(radius - 100).outerRadius(radius - 20);
var pie = d3.layout.pie().sort(null);
svg.selectAll("path").data(pie(data)).enter().append("path").attr("d", 
arc).attr("fill", 
function(d, i) { return color(i); }).transition().duration(500).attrTween("d", sweep);

function sweep(a) {
  var i = d3.interpolate({startAngle: -90*grad, endAngle: -90*grad},{startAngle: -90*grad, endAngle: 90*grad});
   return function(t) {
    return arc(i(t));
    };
} 
```

看了几个例子，我设法获得了动画，但是，我无法将数据绑定（或转换）到弧。我的感觉是只画了一条路，然后它就停止了。

如果我将插值更改为开始/结束 -90/90 和 a，我会得到不同的颜色，但不是全部。将开始/结束角度添加到 pie-var 给我一个过渡，在开始时显示一个单色弧，然后其他部分滑入（如果开始时没有弧，这将是正确的 -比例似乎也有点不对）。将初始颜色设置为白色无济于事，因为那样一切都保持白色。

恐怕我错过了一个明显的观点，但到目前为止我被卡住了，也许有人可以指出我正确的方向。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T11:08:06.413

经过相当多的变化和测试，它以某种方式开始工作，使用这些代码行：

```
var pie = d3.layout.pie().sort(null).startAngle(-90*grad).endAngle(90*grad);

var i = d3.interpolate({startAngle: -90*grad, endAngle: -90*grad},a); 
```

最后一个“问题”是 svg 的高度太小，所以有些部分被切断了，所以把它改成

```
var height = 800; 
```

结束了我的搜索。感谢您的任何考虑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-25T15:13:58.433

上的一个小错字

```
var svg = d3.select("body").append("svg").attr("width", width).attr("height", `height) 
```

应该：

```
var svg = d3.select("body").append("svg").attr("width", width).attr("height", height) 
```

# php - 如何加载标题内容以在所有页面中可用

> ID：15665654
> 
> 赞同：1
> 
> 时间：2013-03-27T17:38:44.810
> 
> 标签：php, codeigniter

我有一个控制器，其中有很多方法，我必须在所有页面中加载我的标题。目前我正在使用`$data["query1"] = $this->mainmenumodel->getmainmenulist();`所有方法来加载我的标题数据。

我在每个类中有 30 多个方法，因此在每个方法中都写这个有点困难`$data["query1"] = $this->mainmenumodel->getmainmenulist();`。

我可以在课堂上做些什么，以便它可用于整个方法。

控制器.php

```
 --------------------------------
                       ---------------------------------
    class mainmenusetups extends MY_Controller {
       var $data = array();
       public function __construct() { 
        parent:: __construct();
        $this->load->helper('url'); 
        $this->load->model('mainmenumodel'); 
        $this->load->library('pagination'); 
        parent::MY_Controller(); 

      if ((int) $mainmenu_id > 0) 
       {
        $query = $this->mainmenumodel->get($mainmenu_id); 
          $this->data->mainmenumodel->getmainmenulist();//how to specify it only once to be use for enitere  class
        $this->load->view('admin/setups/mainmenu/index', $data);
       } 

      else if (!($this->input->post('mainmenu_id'))) 

     {
        $data["query"] = $this->mainmenumodel->fetch_mainmenu_data($config["per_page"], $page);
        $data["links"] = $this->pagination->create_links();
         $this->data->mainmenumodel->getmainmenulist();//how to specify it only once to be use for enitere  class
        $this->load->view('admin/setups/mainmenu/index', $data);
       }
     //--------like this ,i have many  methods and condition in every page-----------       } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T08:54:23.343

我觉得你有点糊涂了。

从 MY_Controller 继承所有控制器。在 MY_Controller 上，将您的标题设置为“全局”变量，例如：

```
$this->data['header'] = $this->set_header();

function set_header()
{
    //all my good logic, including:
    return $this->load->view('my_header', '', true);  // true will pass to a variable
} 
```

现在，在你所有继承的控制器上，每当你加载一个视图时，总是使用 $this->data 作为你的数据；$this->data['header'] 将被包括在内，您可以在模板/页面的顶部打印出来

# javascript - javascript按钮单击功能不起作用

> ID：15665656
> 
> 赞同：4
> 
> 时间：2013-03-27T17:38:45.360
> 
> 标签：javascript, jquery, function, click

我有一个网站，用户可以在其中选择一个项目，然后显示详细信息，包括数量。我还在 div 中包含了一个按钮，以便在单击时将数量减少 1。

```
 $("#btnBuy1").click(function()
        {
            if (!sessionStorage['quantity1'])
            {
                sessionStorage['quantity1']=1;

            }
            else
            {
                sessionStorage['quantity1']++;
            }
            $("#dropbox").html('<div id = "1"><img class = "thumb" id = "t1" src="../images/birthday_metoyou.jpg" />' + teddy[1].desc + ", Price £"
             + teddy[1].price + ", Quantity: " + sessionStorage.getItem('quantity1') + "<button id = 'btnRemove1'>Remove</button></div><br/>");
            updateBasket();
            sessionStorage["total1"] = parseInt(sessionStorage.getItem('quantity1')) * teddy[1].price;
            updateSubtotal();
            if (Modernizr.sessionstorage) 
            {  // check if the browser supports sessionStorage
                myids.push(teddy[1].partnum); // add the current username to the myids array
                sessionStorage["ids"]=JSON.stringify(myids); // convert it to a string and put into sessionStorage
            } 
            else 
            {
             // use cookies instead of sessionStorage
            }            
        });

$("#btnRemove1").click(function()
{
   alert(remove);
}); 
```

我输入了一条警报消息以查看按钮是否正常工作，但是当我单击 btnRemove1 按钮时，什么也没有发生。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-27T17:41:58.697

由于按钮是动态添加的，可以试试：

```
$(document).on('click', '#btnRemove1', function() {
{
   alert("remove"); //I dont know what remove was is the example, added quotes around it.
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-27T17:45:57.503

那是因为按钮是稍后添加的（动态）。您将不得不使用委托。

你不必为此使用身体。任何作为#btnRemove1 父级的非动态插入元素都可以。

```
$('body').on('click','#btnRemove1',function(){
   alert(remove);
}); 
```

原因是您在页面上出现元素 #btnRemove1 之前绑定了事件。因此，没有什么可以绑定事件。但是 body 元素 - 将出现在页面上并将您的事件委托给*#btnRemove1*。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-27T17:45:17.247

您可以将事件绑定到文档（jQuery live 在被弃用之前曾经做过的事情）

现在它是：

```
$(document).on("click", "#btnRemove1", function(){}) 
```

或者你可以在 #btnRemove1 添加到 Dom 之后重新绑定事件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-27T17:49:40.490

最有可能的是，在您尝试将点击事件附加到它之前，您的 Remove 按钮不在 DOM 中。从您的代码片段中很难看出，但如果“购买”按钮操作未成功完成，则“删除”将不存在。

在将 click 事件附加到 Remove 时，尝试控制台记录 $("#btnRemove1").length 以查看它是否存在，或使用断点。

对代码的改进是缓存在变量 $("#dropbox") 中，然后在其中查找按钮，如下所示：

```
var $dropBoxNode = $("#dropbox");
$dropBoxNode.find("#btnRemove1"); 
```

您应该使用 .on() 而不是已弃用的 .click()。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-27T17:44:05.777

创建删除按钮后，尝试添加删除按钮单击处理程序

```
///Code snippit

$("#dropbox").html('<div id = "1"><img class = "thumb" id = "t1" src="../images/birthday_metoyou.jpg" />' + teddy[1].desc + ", Price £"
                     + teddy[1].price + ", Quantity: " + sessionStorage.getItem('quantity1') + "<button id = 'btnRemove1'>Remove</button></div><br/>");

$("#btnRemove1").click(function()
{
     alert(remove);
});

updateBasket();

///Code snippit 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-23T19:18:21.037

```
$('a.edit').on('click','a.edit',function(){
   if (confirm("Are you sure you want to Edit this Photo?"))
   {
    ....
    ....            
   }
}); 
```

在 DIV 区域上使用 AJAX 加载数据时不起作用，就像

```
<a href="javascript:;;" class="edit">EDIT</a> 
```

# php - 正则表达式或删除这段恶意 PHP 代码的可行方法？

> ID：15665659
> 
> 赞同：-1
> 
> 时间：2013-03-27T17:38:58.343
> 
> 标签：php, header, indexing, footer, code-injection

在我的公司，大多数电子商务软件（如 osCommerce 和 OpenCart）以及一些内容管理网站（如 Wordpress 或 Joomla!）都存在问题。

这是我们在我公司在第 3 方托管公司上运行的一些站点中的几乎每个 footer.php、header.php 和 index.php 文件中找到的代码。

[PHP注入代码示例](http://pastebin.com/PuHpD4zA)

考虑一下……难道不能有一个正则表达式来检测这段特定的代码吗？它与某些页面上的模式完全相同，没有变化，所以我认为模式匹配算法或搜索和替换方法将是帮助我们的最佳选择（除了良好的安全审计，我们实际上是与西班牙顶级审计公司之一合作）。

你能告诉我我们可以使用什么方法来进行这种检测和删除模式吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T17:47:48.897

只需搜索那个 base64 字符串？`aHR0cDovL2Jyb3dzZXJnbG9iYWxzdGF0LmNvbS9zdGF0RC9zdGF0LnBocA==`

它解码为：（`hxxp://browserglobalstat.com/statD/stat.php`不要去那里！！）所以它可能总是相同的字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T17:42:06.483

我不会在如此关键的事情上使用自动化流程。我希望有人在删除过程中专门检查每个文件。

# iphone - 这个 iPhone 项目的 ViewVontroller 顺序

> ID：15665661
> 
> 赞同：0
> 
> 时间：2013-03-27T17:39:13.607
> 
> 标签：iphone, uiviewcontroller, modal-dialog, segue

我在决定这个项目的订单流程时遇到问题。有 3 个视图控制器。

1.  图像VC
2.  WebVC
3.  登录VC

* * *

我想要做的是，当应用程序启动时，在检查网络连接时打开/停留在**ImageVC**中，如果没有网络，继续弹出警报，直到有可用网络。

一旦网络可用，检查并查看钥匙串中是否存储了适当的用户名/密码，如果是，直接转到**WebVC**，否则转到**LoginVC**

**WebVC**有一个注销功能，允许用户返回**LoginVC**

所以只要有用户名/密码存储，它会直接去**WebVC**

转场的顺序是什么（在这里使用模态转场）？

ImageVC -> WebVC -> LoginVC？或 WebVC -> ImageVC -> LoginVC？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T17:44:06.427

不确定 imageVC 是什么，但是为什么不将应用程序加载到 loginVC 中，然后按提交以检查凭据，（在检查凭据时显示正在加载 HUD），然后如果正确，则加载 webVC。ImageVC 现在似乎没有目的。

当 loginVC 加载时，你可以异步检查连接，这样你就不会冻结 UI，如果你得到一个是，那么你知道继续密码检查，否则不要打扰。

多次弹出无网络警报是个坏主意（烦人）。也许找到一种微妙的方法来做到这一点（红灯还是绿灯？如果用户需要知道，如果不需要，则只需弹出一次，仅在用户再次尝试密码后再次弹出）。

登录VC-->webVC

imageVC 在这里似乎没有目的

# php - PHP：需要/包含不必要的警告

> ID：15665664
> 
> 赞同：-1
> 
> 时间：2013-03-27T17:39:25.597
> 
> 标签：php, include, require

重新生成问题的步骤：

共有3个文件

include.php 包含：

```
<?php
    $var1 = 5 + $var1;
?> 
```

require.php 包含：

```
<?php
    $var2 = 5 + $var2;
?> 
```

incvsreq.php 将包含：

```
<?php
$var1 = 0; // Starting with 0

include('include.php'); // Includes the file so Adding 5 + 0

echo $var1.'<br/>'; // Result 5

include_once('include.php'); // Will not include as it is already included

echo $var1.'<br/>'; // Display again 5, as it was not included above

include('include.php'); // This will include again so 5 + 5

echo $var1; // Result 10

rename('include.php', '_include.php'); // Rename the file

include('include.php'); // Warning should occur on this line as the file is not present now, but the script should continue.

$var2 = 0; // Starting with 0

require('require.php'); // Includes the file so Adding 5 + 0

echo $var2.'<br/>'; // Result 5

require_once('require.php'); // Will not include as it is already included

echo $var2.'<br/>'; // Display again 5, as it was not included above

require('require.php'); // This will include again so 5 + 5

echo $var2; // Result 10

rename('require.php', '_require.php'); // Rename the file

require('require.php'); // ERROR should occur on this line as the file is not present now, and the script should not continue.

echo 'This is not displayed'; // This won't be displayed.
?> 
```

该脚本的输出是：

```
5
5
﻿10
Warning: include(include.php) [function.include]: failed to open stream: No such file or directory in C:\Program Files\Ampps\www\include\incvsreq.php on line 23

Warning: include(include.php) [function.include]: failed to open stream: No such file or directory in C:\Program Files\Ampps\www\include\incvsreq.php on line 23

Warning: include() [function.include]: Failed opening 'include.php' for inclusion (include_path='.;C:\php\pear') in C:\Program Files\Ampps\www\include\incvsreq.php on line 23
﻿5
5
﻿10
Warning: require(require.php) [function.require]: failed to open stream: No such file or directory in C:\Program Files\Ampps\www\include\incvsreq.php on line 45

Warning: require(require.php) [function.require]: failed to open stream: No such file or directory in C:\Program Files\Ampps\www\include\incvsreq.php on line 45

Fatal error: require() [function.require]: Failed opening required 'require.php' (include_path='.;C:\php\pear') in C:\Program Files\Ampps\www\include\incvsreq.php on line 45 
```

我理解了从顶部开始的最后一个和第三个警告中的致命错误，但其他警告是如何出现的？我在这里有点困惑。我已经评论了每一行以便更好地理解。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T17:44:56.013

`understood the Fatal Error in the last and 3rd warning from the top but how did other warnings appear ? I am little confused here.`

如果您详细查看错误日志。如您所料，仅在两行上生成错误消息。第 23 行和第 45 行。即使它们显示 3 次，它们也只会在您要求的那两行上生成。这段代码似乎表现得像它应该的那样

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T20:41:58.853

错误行在几个不同级别的报告上生成一个 MSG，打印出来的内容由 PHP 中设置的 error_reporting 级别控制以获取更多信息，请查看 PHP 文档... [error_reporting](http://php.net/manual/en/function.error-reporting.php)

# android - 选择画廊图像并转换为位图？

> ID：15665665
> 
> 赞同：2
> 
> 时间：2013-03-27T17:39:31.447
> 
> 标签：android, bitmap, android-imageview, bitmapimage

我正在尝试从图库中选择图像，将其转换为`Bitmap`，然后将其显示为`ImageView`.

下面的代码用于从图库中选择图像

```
 Intent pickPhoto = new Intent(
            Intent.ACTION_PICK,
            android.provider.MediaStore.Images.Media.EXTERNAL_CONTENT_URI);
    startActivityForResult(pickPhoto, 1);` 
```

在`onActivityResult`我将其转换为 a`Bitmap`并将其显示在`ImageView`

```
protected void onActivityResult(int requestCode, int resultCode,
        Intent imageReturnedIntent) {
    super.onActivityResult(requestCode, resultCode, imageReturnedIntent);
    switch (requestCode) {
    case 1:
        if (resultCode == RESULT_OK) {
            Uri selectedImage = imageReturnedIntent.getData();
            BitmapFactory.Options options = new BitmapFactory.Options();
            options.inSampleSize = 4;//returning null for below statement
            bitmap = BitmapFactory.decodeFile(selectedImage.toString(), options);
            productItemImage.setImageBitmap(bitmap);
        }
        break;
    }
} 
```

所选图像 Uri 中的值返回为“content://media/external/images/media/3647”

`productItemImage`是我`ImageView`显示的`Bitmap`。没有错误，但位图返回 null。

请帮忙

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-03-27T17:42:59.093

问题可能是您`super.onActivityResult()`在`onActivityResult()`函数中的调用。

这是我去年写的一个答案，它给出了你想要做什么的完整示例，另外还允许你从相机和图库中进行选择：[允许用户为图像选择相机或图库](https://stackoverflow.com/questions/4455558/allow-user-to-select-camera-or-gallery-for-image/12347567#12347567)（这个答案得分很高，所以我认为它会对你有所帮助）。

# php - Cakephp 不确定这个业务逻辑是否属于 View？

> ID：15665668
> 
> 赞同：1
> 
> 时间：2013-03-27T17:39:33.813
> 
> 标签：php, templates, cakephp

我开始尝试使用 CakePHP，我正在考虑是否计算，可能是业务，确定在视图上呈现的内容的逻辑应该在视图中还是其他地方。

我最终将它们放在视图中的问题是因为数据仅在我执行 foreach 循环时可用。这是一个简单的例子：

```
 <?php foreach ($records as $record):
        $amountDifference = $record['Record']['outstanding'] - $record['Record']['paid']; 

        if ($amountDifference > 5){
            echo "greater than 5";
         }else{
            echo "less than 5";
         }

    endforeach; ?> 
```

你们都说什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T22:23:15.627

有几点要指出...

首先，在这种情况下，您的代码可以正常使用。这是简单的东西，所以我会说它是否在模型或视图中并不重要。

> 我最终将它们放在视图中的问题是因为数据仅在我执行 foreach 循环时可用。

其次，更重要的是，重要的是要知道“foreach”循环没有障碍，如果你愿意，你可以在你的模型中轻松做到这一点。您只需在模型中创建一个方法，如下所示：

```
public function findAllWithAmountDifference(){
    $records = $this->find('all');

    // Now go through your records and adjust, before returning them
    foreach ($records as &$record):
        $record['Record']['difference'] = $record['Record']['outstanding'] - $record['Record']['paid'];
    endforeach;

    // Now your return value will have extra array keys with the difference
    return $records;
} 
```

第三，我想说在这种特殊情况下最好的方法是使用虚拟字段（[http://book.cakephp.org/2.0/en/models/virtual-fields.html](http://book.cakephp.org/2.0/en/models/virtual-fields.html)），所以计算作为数据库查询的一部分进行。

最后，在什么被视为表示逻辑和什么被视为业务逻辑之间显然并不总是完全明确的。在像你这样的简单情况下，它可以是任何一种方式，而且不值得失眠。

严格来说，计算两个值之间的差异是对数据的操纵，因此属于模型。

话虽如此，如果您认为您的代码将更透明，并且更易于理解和维护，在您的视图中而不是模型中使用该代码，只需将它放在视图中！

关于代码理论和最佳实践的事情是，它们旨在作为使您的代码更易于调试/阅读/扩展/维护的一般指南。通常，它们非常好，但它们不是绝对规则。如果违反规则或最佳实践会真正使您的代码更易于调试/阅读/维护，那很好！违规走开！

# iphone - 样式 UIPageViewController 页面空间

> ID：15665670
> 
> 赞同：1
> 
> 时间：2013-03-27T17:39:45.823
> 
> 标签：iphone, ios, objective-c

在 a 的页面之间添加样式（例如图像）的最佳方法是`UIPageViewController`什么？日历应用程序是这样做的（不确定是否使用`UIPageViewController`）：

![在此处输入图像描述](../Images/a075246a942784b6b4f35ba63b72f669.png).

我唯一能想到的就是将 UIView 挂在页面的一侧（视图控制器）。这似乎有效，但感觉很脏。

# vim - Vim、colorschemes 和设置 ctermbg 无法正常工作

> ID：15665672
> 
> 赞同：1
> 
> 时间：2013-03-27T17:39:55.753
> 
> 标签：vim, highlight, color-scheme

我想在 Vim 中突出显示光标线，这取决于我是处于插入模式还是命令模式（在 Ubuntu 上的 Gnome 终端/Gnu 屏幕中使用它），有些人建议我应该在 .vimrc 中使用这些命令

```
au InsertEnter * set nocursorline
au InsertLeave * set cursorline
hi cursorline cterm=underline ctermbg=243 
```

如果我直接在 Vim 中使用上述所有命令（暂时使用这些设置，直到下次重新启动），它们都可以正常工作。

我还在 .vimrc 中加载了一个名为“wombat”的配色方案，但是在 .vimrc 中使用相同的命令时会出现几个问题：

*   如果我在加载方案后放置 ctermbg-command（我应该这样做），该方案会以某种方式被忽略/未加载/未使用或其他什么。意思是，vim 提供了一些标准颜色。

*   如果我在加载方案之前放置 ctermbg-command，则突出显示不起作用，但会加载方案。

*   如果我只尝试设置 cterm，那么会加载该方案，但不会出现下划线。不管哪个命令最后出现。

有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T02:57:31.520

您收到错误是因为您的配色方案覆盖了您的自定义设置。我将建议以下内容：

1.  将这两行留在 vimrc

    ```
    au InsertEnter * set nocursorline
    au InsertLeave * set cursorline 
    ```

2.  fork 你的配色方案，给它一个新名字，然后在 vimrc 中引用它

    ```
    colorscheme wombat-custom 
    ```

3.  破解计划。

    *   找到有关的代码`cursorline`，将其修改`ctermbg`为您想要的任何内容
    *   还要注意`Normal` `ctermbg`。是正常的背景，最好和cursorline相似但不同，这样你就知道你是否处于插入模式。

旁注：如果您愿意，您可以对整个颜色方案文件夹进行版本控制，以便在必要时知道如何返回。我的做法是对整个 .vim 文件夹进行版本控制，尽管设置更复杂一些。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-18T03:14:22.963

当我尝试它时，Wombat 的行为与我使用的任何其他颜色方案都不同，因此它可能只是在 GUI 之外被破坏，因为它没有直接定义任何 cterm 高亮。

不过，您不需要破解颜色方案文件。ColorScheme 自动命令在加载颜色方案后运行命令，因此，如果您希望使用的每个颜色方案都具有这种行为（因为这将覆盖所有颜色方案），那么您可以添加另一行来强制它：

```
hi cursorline cterm=underline ctermbg=243
au ColorScheme * hi cursorline cterm=underline ctermbg=243 
```

此外，我注意到 InsertEnter/InsertLeave 自动命令在我切换到和退出插入模式时没有立即正确绘制线，所以我将您的自动命令更改为：

```
au InsertEnter * set nocursorline | redraw!
au InsertLeave * set cursorline | redraw! 
```

这让一切看起来都对我有用。

# javascript - 如何在 POST 请求之前处理新的数组元素

> ID：15665673
> 
> 赞同：2
> 
> 时间：2013-03-27T17:39:56.807
> 
> 标签：javascript, web-analytics, snowplow

我目前正在开发一个脚本，允许我检索网站上连接尝试的用户名。但主要限制是我无法编辑页面的 HTML，只能通过跟踪代码管理器添加我的脚本。

我必须解释我使用什么工具。我正在使用网络跟踪工具[SnowPlow Analytics](http://www.snowplowanalytics.com)。它的工作原理与 Google Analytics 相同，带有一个数组 _snaq，（将）包含要处理的数据。问题的核心在于，即使将数据很好地添加到数组中，主脚本 (sp.js) 也没有时间完成工作并在 POST 请求之前向 CloudFront 收集器发送请求。

这是我使用的示例页面，以及捕获数据的脚本：

**页：**

```
<html>
    <head>
        <title>Sign In Example</title>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
         <!-- SnowPlow modified -->
            <script type="text/javascript">
                var _snaq=_snaq||[];
                _snaq.push(['setCollectorCf','xxxxxxxxxxxxxx']);
                _snaq.push(['trackPageView']);
                _snaq.push(['enableLinkTracking']);
                /*
                * Here is the anonymous function to include properly the snowplow.js
                * minified: d1fc8wv8zag5ca.cloudfront.net/0.11.1/sp.js
                * github : github.com/snowplow/snowplow/tree/master/1-trackers/javascript-tracker
                */
            </script>
         <!--/ SnowPlow modified -->
         <script src="js/jquery.min.js"></script>
         <script async="" type="text/javascript" src="js/getLogin.min.js"></script>
    </head>
     <body>
        <form class="formClass">
            <h2>Please sign in</h2>
            <input type="text" class="textInput" placeholder="Email address" />
            <input type="password" class="passwordInput" placeholder="Password" />
            <label class="checkbox">
                <input type="checkbox" value="remember-me" /> Remember me
            </label>
            <button class="submitButton" type="submit">Sign in</button>
        </form>
    </body>
</html>` 
```

**脚本：**

```
var checked, cb = $('input[value="remember-me"]')[0], butt = $('button[type="submit"]')[0];
if(cb.checked)
    checked = 1.0;
else
    checked = 0.0;

function snaqPush()
{
    _snaq.push(['trackStructEvent', 'connection', 'connectionAttempt', 'email',  $('input[placeholder = "Email address"]').val(), checked]);
}

cb.addEventListener("click", function(e)
{
    if(cb.checked)
        checked = 1.0;
    else
        checked = 0.0;
}, false);

butt.addEventListener("click", function()
    {
        snaqPush(); //or directly the _snaq push([...]) here
        _snaq.push(function()
        {
            setTimeout(function(){}, 1000);
        }); //I have try the setTimeout in and out of a _snaq.push, and it stills not work
    }); 
```

注意：POST 请求在包含数据的 _snaq.push() 之后使用断点！

在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T18:01:08.257

您应该将事件侦听器绑定到表单的提交操作，而不是按钮单击。这样，您可以在返回之前进行分析调用，`true`从而允许提交完成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T11:04:04.450

非常感谢它运行良好，但与您提出的建议相比，我只需要进行一些更改：

```
/*your proposal (if I'm right)*/
setTimeout(function(){}, 250);
return true;

/*the adaptation I have done for it to work*/
setTimeout(function(){myForm.submit();}, 250); 
```

# xpand - 如何以编程方式从 Java 类运行 Xpand 代码生成器？

> ID：15665674
> 
> 赞同：0
> 
> 时间：2013-03-27T17:40:00.003
> 
> 标签：xpand, mwe

我试图通过定义 DSL 并执行 M2M 以及 M2T（代码生成）来实现模型驱动的开发。对于代码生成，我选择使用 XPand 和模板定义。您能否提供示例代码或文档链接来解释如何从 Java 代码调用模板扩展？

PS 我发现在 Eclipse 之外以独立模式运行这些东西非常困难，所以我从编写简单的 Java 实用程序开始。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T22:15:49.077

这是任何有兴趣的人的代码：

```
 Resource.Factory.Registry reg = Resource.Factory.Registry.INSTANCE;
    Map<String, Object> factoryMap = reg.getExtensionToFactoryMap();
    factoryMap.put(Resource.Factory.Registry.DEFAULT_EXTENSION, new XMIResourceFactoryImpl());

    ResourceSet resourceSet = new ResourceSetImpl();
    EPackage PSM_Pkg = MyDSLPackage.eINSTANCE;
    resourceSet.getPackageRegistry().put(PSM_Pkg.getNsURI(), PSM_Pkg);

    Resource resource = resourceSet.getResource(Constants.PSM_URI, true);
    EList<EObject> inObjects = resource.getContents();

    // Xpand
    URI outURI = URI.createURI("file:///C:/Users/...");
    Output out = new OutputImpl();
    Outlet outlet = new Outlet(outURI.toFileString());
    out.addOutlet(outlet);
    XpandExecutionContextImpl executionContext = new XpandExecutionContextImpl(out, null);

    // Configure the metamodels
    EmfMetaModel emfMetaModel = new EmfMetaModel();
    emfMetaModel.setMetaModelPackage(MyDSLlPackage.class.getName());
    executionContext.registerMetaModel(emfMetaModel);
    XpandFacade xpandFacade = XpandFacade.create(executionContext);
    Object[] params = null;
    System.out.println(inObjects.get(0));
    xpandFacade.evaluate("template::Template::main", inObjects.get(0), params);
    System.out.println("Code generated."); 
```

# python - split() 字符串上的 Python strip() 有什么作用吗？

> ID：15665680
> 
> 赞同：6
> 
> 时间：2013-03-27T17:40:04.300
> 
> 标签：python, python-2.7, split, strip

根据一些实验，在我看来，以下 Python v2.7 代码：

```
def lookup_pattern(pattern, file_containing_patterns):
  for line in file_containing_patterns:
    splits = line.split()
    if splits:
      if (pattern == splits[0]):
        return map(lambda x: x.strip(), splits[1:])
  return None 
```

可以简化如下以删除`map`of `strip()`：

```
def lookup_pattern(pattern, file_containing_patterns):
  for line in file_containing_patterns:
    splits = line.split()
    if splits:
      if (pattern == splits[0]):
        return splits[1:]
  return None 
```

我相信这是真的，因为`split()`应该删除所有空白，因此`strip()`将是无操作的。

是否存在上述两种在效果上不相同的情况，如果有，它们是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-27T18:38:43.087

该[文档](http://docs.python.org/library/stdtypes.html#str.split)表明，`split`使用隐式空格分隔符（即，`split()`没有进一步的参数）将清除任何“空标记”，并且您不需要删除任何内容。由于任何连续的空白系列都可以解释为由空格分隔的空标记列表，这意味着字符串会自动修剪。

相反，如果您使用不同的分隔符拆分或隐式定义空格，则可能会发生这种情况：

```
' 1  2   3  '.split()
=> ['1', '2', '3']

'  1  2   3  '.split(None, 1)
=> ['1', '2   3  '] 
```

# cordova - Android 模拟器 - PhoneGap GPS 位置？

> ID：15665684
> 
> 赞同：3
> 
> 时间：2013-03-27T17:40:19.957
> 
> 标签：cordova, gps, emulation

我正在玩 Phone Gap 和 Android 模拟器。是否可以在模拟器中测试 GPS？显然模拟器没有GPS，但是有调试模式还是什么的？

每次我测试它时，GPS 'onDeviceReady' 都会直接进入 'onError' 功能。

有办法解决这个问题吗？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-02T17:48:57.540

在 Android 模拟器中，您可以尝试使用**ddms**。

developer.android.com/tools/debugging/ddms.html

* * *

对于在模拟器之外调试 phonegap 应用程序，**PhoneGap Emulation / Ripple** 允许您在桌面浏览器中进行测试。

[http://emulate.phonegap.com/](http://emulate.phonegap.com/) “由 Ripple 提供支持的 PhoneGap 仿真”

单击设置齿轮并选中“覆盖地理位置”。

* * *

**Weinre** (WEB INspector REmote) 使您能够远程测试 Web 应用程序。

debug.phonegap.com/

people.apache.org/~pmuellr/weinre/docs/latest/

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-01T22:20:04.387

如果您使用 Eclipse，您可以转到“window->open pespective->ddms”。然后你去模拟器控制选项卡。有一个“位置控制”，您可以发送位置。

# delphi - Delphi - 改变 TComboBox 的 OnChange

> ID：15665686
> 
> 赞同：1
> 
> 时间：2013-03-27T17:40:23.983
> 
> 标签：delphi, delphi-5

我想更改它，`TComboBox`以便如果我在其中输入文本或手动设置 Text 属性，它将触发`OnChange`事件。

就像现在一样，doing`ComboBox.Text := 'blah'`不会触发`OnChange`事件，也不会在框中输入内容。

我尝试创建一个`TComboBox`后代，我认为这是正确的方法，但我不确定如何更改触发事件的因素。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-27T17:54:34.557

据我所知，在组合框中输入内容将导致`OnChange`事件触发。但是修改text属性确实不行。

我要`OnChange`为你的组合框开火的方法是处理`CM_TEXTCHANGED`消息。处理程序需要调用该`Change`方法`OnChange`，如果它已被分配，则该方法将调用。

举个简单的例子，这是一个插入器类的实现：

```
type
  TComboBox = class(StdCtrls.TComboBox)
  protected
    procedure CMTextChanged(var Message: TMessage); message CM_TEXTCHANGED;
  end;

procedure TComboBox.CMTextChanged(var Message: TMessage);
begin
  inherited;
  Change;
end; 
```

# c# - 调试器可视化工具 - 放大镜未显示

> ID：15665690
> 
> 赞同：0
> 
> 时间：2013-03-27T17:40:39.330
> 
> 标签：c#, visual-studio-2010, visual-studio

我已经开始编写一个调试器可视化库，但是它没有按预期工作。

当我将鼠标悬停在我为其创建可视化工具的变量上时，应该有一个放大镜，但事实并非如此。显然，视觉工作室并没有告诉我出了什么问题。

以下代码位于可视化库（面向 4.0 的类库项目）中。

对话框调试器：

```
[assembly: DebuggerVisualizer(
typeof(ColorRGBA8Visualizer),
typeof(Serializer<ColorRGBA8>),
Target = typeof(ColorRGBA8),
Description = "ColorRGBA8 Visualizer")]

public class ColorRGBA8Visualizer
    : DialogDebuggerVisualizer
{
    public static void TestShowVisualizer(object objectToVisualize)
    {
        var visualizerHost = new VisualizerDevelopmentHost(objectToVisualize,
            typeof(ColorRGBA8Visualizer),
            typeof(Serializer<ColorRGBA8>));
        visualizerHost.ShowVisualizer();
    }

    protected override void Show(IDialogVisualizerService windowService, IVisualizerObjectProvider objectProvider)
    {
        var color = Serializer<ColorRGBA8>.GetValue(objectProvider);
        using (var form = new Form())
        {
            form.Text = "Color Visualizer";
            form.BackColor = Color.FromArgb(255, color.R, color.G, color.B);
            form.Size = new Size(100, 10);
            windowService.ShowDialog(form);
        }
    }
} 
```

自定义序列化器，因为无论如何我都需要它来处理更复杂的对象：

```
public class Serializer<T>
    : VisualizerObjectSource
{
    public static T GetValue(IVisualizerObjectProvider provider)
    {
        var serializer = new DataContractSerializer(typeof (T));
        var transport = (MemoryStream) provider.GetObject();
        var value = serializer.ReadObject(transport);

        return (T) value;
    }

    public override void GetData(object target, Stream outgoingData)
    {
        var value = (T) target;
        var transport = new MemoryStream();
        var serializer = new DataContractSerializer(typeof(T));
        serializer.WriteObject(transport, value);
        transport.Position = 0;

        base.GetData(transport, outgoingData);
    }
} 
```

我的测试控制台应用程序：

```
internal class Program
{
    #region Static Methods

    private static void Main(string[] args)
    {
        var value = new ColorRGBA8{R=255};
        ColorRGBA8Visualizer.TestShowVisualizer(value);
    }

    #endregion
} 
```

对话框显示得很好，但整个该死的点是当鼠标悬停在该点的变量“值”上时，显示对话框的按钮出现。

是的，我的可视化库通过构建库输出到“C:\Program Files (x86)\Microsoft Visual Studio 10.0\Common7\Packages\Debugger\Visualizers”：所有必需的引用也被复制。

[这是我的调试器中的样子](https://i.imgur.com/qCPp11q.png)

[这就是我期望的样子](https://i.imgur.com/Xng18rD.png)

谁能告诉我我错过了什么？

*编辑*

**这是[JaredPar](https://stackoverflow.com/users/23283/jaredpar)建议的解决方案。出于某种未知原因，Visual Studio 拒绝使用通用序列化器，即使它们被指定为封闭类型，例如 Serializer。**

```
public class ColorRGBA8Serializer
    : VisualizerObjectSource
{
    public static ColorRGBA8 GetValue(IVisualizerObjectProvider provider)
    {
        var serializer = new DataContractSerializer(typeof(ColorRGBA8));
        var transport = (MemoryStream)provider.GetObject();
        var value = serializer.ReadObject(transport);

        return (ColorRGBA8)value;
    }

    public override void GetData(object target, Stream outgoingData)
    {
        var value = (ColorRGBA8)target;
        var transport = new MemoryStream();
        var serializer = new DataContractSerializer(typeof(ColorRGBA8));
        serializer.WriteObject(transport, value);
        transport.Position = 0;

        base.GetData(transport, outgoingData);
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T17:53:03.987

问题似乎是您对 . 的第二个参数使用了泛型类型`DebuggerVisualizerAttribute`。可视化系统在泛型方面受到限制，出于某种原因，它似乎在这个位置拒绝泛型。我能够使用您的代码显示表单，只需将可视化器源参数更改为非泛型

注意：我没有很好的解释为什么行为是这样的。这在逻辑上没有意义，但在实验上它证明了

# javascript - Google Plus 一键加载

> ID：15665692
> 
> 赞同：0
> 
> 时间：2013-03-27T17:40:44.443
> 
> 标签：javascript, html, google-plus, google-plus-one

当点击加一按钮时，我使用了谷歌加一按钮上的回调属性来执行一个动作。这工作正常。我的问题是，当我单击加一按钮然后关闭页面并返回时，该按钮仍被单击（红色）但我的自定义操作未执行。有没有办法查看是否有人在之前的访问中点击了加号按钮？我想查看按钮的状态，而不需要用户在按钮上进行交互。我的代码如下

```
<script type="text/javascript">
function customCallback(jsonParam) {
var Special = document.getElementById('special');

if(jsonParam.state == "on"){

     $('.test').show();
   }
   else{

       $('.test').hide();
        }
}
window.onload = customCallback;
</script> 
```

然后我渲染我的按钮

```
<g:plusone callback ="customCallback"></g:plusone> 
```

如果我单击按钮，代码将按预期执行并显示 .test div。如果我然后返回页面，则 .test div 将再次隐藏。有人有什么想法吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T17:02:43.723

您可以从您的站点跟踪按钮的状态。唯一的缺点是当用户返回您的页面时，按钮的外部点击不会注册。

为回调添加一个处理程序以在单击按钮时设置 cookie：

```
<div class="g-plusone" data-callback="cookieAdd" data-annotation="inline" data-width="300"></div>

<script type="text/javascript">
  (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
  })();
</script>
<script type=text/javascript>
function cookieAdd(args){
  if (args.state == "on"){
    document.cookie = 'enrolled=1;expires=0';
  }else{
    document.cookie = 'enrolled=0;expires=0';
  }
}
</script> 
```

页面加载时，可以检查用户是否点击了按钮，如下：

```
 <script>
    if (document.cookie != undefined && document.cookie.indexOf('enrolled=1') > -1){
      // button has already been clicked "on"
    }
  </script> 
```

我不确定你在做什么，但请注意你没有违反[Google+ 按钮政策](https://developers.google.com/+/web/buttons-policy)。

# sql - 解决“字符串或二进制数据将被截断”错误

> ID：15665693
> 
> 赞同：0
> 
> 时间：2013-03-27T17:40:50.913
> 
> 标签：sql, sql-server, tsql, stored-procedures

```
Declare @STAF_TO NVARCHAR(100) 
```

作为 SQL Server 存储过程的一部分，我有以下查询：

```
SELECT @SF_TO = TP.FRST_NAME + ' ' + TP.MDLE_NAME + ' ' + TP.LAST_NAME
FROM tbl_Sf TS 
INNER JOIN tbl_Pl TP ON (TS.POPL_PK = TP.POPL_PK)
WHERE TS.SF_PK = @ID 
```

根据我在此之前插入的打印语句，我知道它`@ID`等于 140 (Type )。`INT`当我尝试单独执行此查询时，它工作正常。

但是，当我尝试将其作为存储过程的一部分运行时，出现以下错误：

> 消息 8152、级别 16、状态 13、过程 Proc_Name、第 57 行
> 字符串或二进制数据将被截断。

第 57 行`SELECT`是上述查询的语句所在的位置。任何人都知道为什么会发生这种情况？

编辑：我尝试更改`NVARCHAR(100)`为`NVARCHAR(200)`and `NVARCHAR(MAX)`，但仍然出现错误。此外，如果我单独运行查询，它可以正常工作（有 100 个字符）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-27T17:48:03.337

几乎可以肯定您的列的定义：

```
FRST_NAME
MDLE_NAME
LAST_NAME 
```

添加最多超过 98 个字符（空格 +2）。

我建议声明`@SF_TO`为大于`NVARCHAR(100)`（但究竟是什么，我不知道）。

当然，错误消息很烦人。如果输出中包含更多细节，那就太好了。[请对此 Connect 项目投票/评论](http://connect.microsoft.com/SQLServer/feedback/details/339410)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-27T17:48:58.263

连接语句几乎肯定会导致比@SF_TO 声明的长度更长的记录。您应该增加@SF_To 的长度。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-27T17:48:39.803

您收到此错误是因为以下连接：

```
TP.FRST_NAME + ' ' + TP.MDLE_NAME + ' ' + TP.LAST_NAME 
```

大于`100`字符。现在，这可能并非在每一行上都是正确的，但在您选择的那一行上却是正确的。如果您运行此选择语句：

```
SELECT TP.FRST_NAME + ' ' + TP.MDLE_NAME + ' ' + TP.LAST_NAME
FROM tbl_Sf TS 
INNER JOIN tbl_Pl TP ON (TS.POPL_PK = TP.POPL_PK)
WHERE LEN(TP.FRST_NAME + ' ' + TP.MDLE_NAME + ' ' + TP.LAST_NAME) > 100 
```

您将能够找到有问题的行。另一种方法是简单地使`@STAF_TO`变量等于这三列加在一起的长度 + 2。因此，如果这些列`50`在其定义中都是长字符，`@STAF_TO`则应该是`152`.

# pascal - 使用 Pascal 语言的 Sink 检测算法

> ID：15665698
> 
> 赞同：0
> 
> 时间：2013-03-27T17:40:55.440
> 
> 标签：pascal

我有一个关于图形中接收器检测的 Pascal 实现。这是代码：

```
FUNCTION KATAVOTHRA (A:MATRIX; N:INTEGER): INTEGER;
VAR 
  I,J,K,S:INTEGER;
BEGIN
  KATAVOTHRA:=0;  
  I:=1;
  WHILE (KATAVOTHRA=0 AND I<N) DO   {1}
  BEGIN
    J:=1;
    WHILE (A[I,J]=0 AND J<N) DO J:=J+1;  {2}
    IF (J=N) THEN BEGIN
      S:=0;
      FOR K:=1 TO N DO S:=S+A[K,I];
      IF (S=N-1) THEN 
        KATAVOTHRA:=1;
    END;
    I:=I+1;
  END;    
END; 
```

假设我们有以下邻接矩阵：

```
 0 0 1
 1 0 1
 0 0 0 
```

对于`V1`,`V2`和`V3`顶点。（如果我们在两个节点之间有连接，则为 1 个代码，否则为 0 个代码）。

我正在尝试使用此输入跟踪代码，但我不能。原因是我3岁的时候不取结果。让我们看看我到目前为止做了什么：（`KATAVOTHRA`是sink的名称）。

`BEGIN with I:=1; and J:=1`（在第一个 while 循环内）

首先我们检查`A[1,1]`是否为零并且它是（当然为了继续，1 < 3）所以`J= J+1 => J=2`

`A[1,2]`也为零，所以再次增加 J，现在 J 为 3。3 不小于 3`A[1,3]`且不为 0。所以我们要去 IF 语句`IF( J = N) => IF( 3 = 3 ) then S=0 (sum)` ，所以我们要去 FOR 循环，我们总结`A[1,1] + A[2,1] + A[3,1]`

`IF( S = N-1) THEN`我们找到了一个水槽。但是这里`S=1`不是 2。我们退出 FOR 循环，我现在是 2 再次`WHILE(KATAVOTHRA=0 AND 2<3)`J 是 1，我们现在检查`A[2,1]`但不是零，并且 2 不是 3，所以我们出去......我现在是 3......但是这次 3 < 3 是假的，所以整个循环在那里终止？我无法理解（尽管我在 Pascal lagnuage 方面没有太多经验）。

这有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-11-22T01:06:37.493

> 我现在是 3.... 但这次 3 < 3 是假的，所以整个循环在那里终止？

正如您已经说过的那样，您的循环是否过早结束一个数字。为了避免这种情况，您必须测试`I <= N`.

这里有一个简短的程序来显示这两种变体：

```
PROGRAM LoopTest;

VAR
   i : Integer;

BEGIN
   WriteLn("Example with <");
   i := 0;
   WHILE (i < 3) DO
   BEGIN
      WriteLn(" Loopvar: ", i);
      i := i + 1;
   END;
   WriteLn;

   WriteLn("Example with <=");
   i := 1;
   WHILE (i <= 3) DO
   BEGIN
      WriteLn(" Loopvar: ", i);
      i := i + 1;
   END;
END. 
```

和输出：

> ```
> Example with <
>  Loopvar: 0
>  Loopvar: 1
>  Loopvar: 2
> 
> Example with <=
>  Loopvar: 1
>  Loopvar: 2
>  Loopvar: 3 
> ```

现在很容易看到：

*   `<`用于基于零的数组
*   `<=`用于基于一个的数组

# wcf - 银光闪屏

> ID：15665702
> 
> 赞同：1
> 
> 时间：2013-03-27T17:41:15.143
> 
> 标签：wcf, silverlight, splash-screen

我有一个带有 WCF 的 SL 应用程序，我想在 WCF 调用完成期间添加一个启动屏幕以显示。我该怎么做呢？一直在谷歌搜索没有成功。目前，我的启动画面在程序包加载时显示，但应用程序在等待 WCF 时显示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:41:05.620

其中一种变体是在 WCF 调用期间显示 ChildWindow。
[http://msdn.microsoft.com/ru-ru/library/system.windows.controls.childwindow(v=vs.95).aspx](http://msdn.microsoft.com/ru-ru/library/system.windows.controls.childwindow(v=vs.95).aspx)

另一个：来自 Silverlight Toolkit 的 BusyIndi​​cator。
[http://msdn.microsoft.com/en-us/silverlight4trainingcourse_overview_topic4#_Toc259103645](http://msdn.microsoft.com/en-us/silverlight4trainingcourse_overview_topic4#_Toc259103645)

# ruby - 如何使用 ruby 以编程方式删除 Rally 回收站中的缺陷？

> ID：15665704
> 
> 赞同：0
> 
> 时间：2013-03-27T17:41:19.717
> 
> 标签：ruby, rally, bin, recycle

我可以使用 Ruby 脚本和 Rally Rest API 删除 Rally v12.4 中的缺陷。然后缺陷进入回收站。如何完全删除它？

如果您必须知道...我正在从 ClearQuest 导入数据（使用 Enterprise editino 并且没有 CQ 连接器）。当我处理映射时，我导入了一小批来检查它是如何工作的。我重复这一点，但每次都想清除所有缺陷。我编写了一个 Ruby 脚本来删除它们，但它不会从回收站中清除它们，并且必须一个接一个地完成。一旦我迁移了数百张 ClearQuest 票证，然后发现问题，我不想将它们从回收站中一一删除。

同样，要回答的问题是，“我如何完全删除它？”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T13:59:19.587

以下脚本可能有助于完成此任务：

```
# Usage: ruby rally_empty_recycle_bin.rb
# Specify the User-Defined variables below. Script will iterate through all items in
# Rally Recycle bin for specified Workspace and Project, and prompt the user to confirm
# permanent deletion of the item of interest.

require 'rally_api'

$my_base_url       = "https://rally1.rallydev.com/slm"
$my_username       = "user@company.com"
$my_password       = "password"
$my_workspace      = "My Workspace"
$my_project        = "My Project"
$wsapi_version     = "1.41"

# Make no edits below this line!!
# =================================

#Setting custom headers
$headers                            = RallyAPI::CustomHttpHeader.new()
$headers.name                       = "Rally Empty Recycle Bin"
$headers.vendor                     = "Rally Labs"
$headers.version                    = "0.50"

# Load (and maybe override with) my personal/private variables from a file...
my_vars= File.dirname(__FILE__) + "/my_vars.rb"
if FileTest.exist?( my_vars ) then require my_vars end

begin

  #==================== Make a connection to Rally ====================

  config                  = {:base_url => $my_base_url}
  config[:username]       = $my_username
  config[:password]       = $my_password
  config[:workspace]      = $my_workspace
  config[:project]        = $my_project
  config[:version]        = $wsapi_version
  config[:headers]        = $headers

  @rally = RallyAPI::RallyRestJson.new(config)

  # Lookup source Test Folder
  recycle_bin_query = RallyAPI::RallyQuery.new()
  recycle_bin_query.type = :recyclebin
  recycle_bin_query.fetch = true

  recycle_bin_query_results = @rally.find(recycle_bin_query)

  number_recycle_bin_items = recycle_bin_query_results.total_result_count

  if number_recycle_bin_items == 0
    puts "No items found in Recycle Bin. Exiting."
    exit
  end

  puts "Found #{number_recycle_bin_items} items in Recycle Bin for possible deletion."
  puts "Start processing deletions..."

# Loop through matching artifacts and delete them. Prompt user
# for each deletion.

  number_processed = 0
  number_deleted = 0
  affirmative_answer = "Y"

  recycle_bin_query_results.each do | this_recycle_bin_item |

    number_processed += 1
    puts "Processing deletion for item #{number_processed} of #{number_recycle_bin_items}."

    item_formatted_id = this_recycle_bin_item["ID"]
    item_name = this_recycle_bin_item["Name"]
    item_type = this_recycle_bin_item["Type"]
    puts "Deleting Item #{item_formatted_id}, #{item_type}: #{item_name}..."
    puts this_recycle_bin_item["_ref"]
    really_delete = [(print "Really delete? [Y/n]:"), gets.rstrip][1]

    if really_delete == affirmative_answer then
      begin
        delete_result = @rally.delete(this_recycle_bin_item["_ref"])
        puts "DELETED #{item_formatted_id}: #{item_name}"
        puts delete_result
        number_deleted += 1
      rescue => ex
        puts "Error occurred trying to delete: #{item_formatted_id}: #{item_name}"
        puts ex.backtrace
      end
    else
      puts "Did NOT delete #{item_formatted_id}: #{item_name}."
    end
  end

  puts
  puts "Deleted a total of #{number_deleted} items from the Recycle Bin."
  puts "Complete!"

end 
```

# arrays - 多阵列循环外壳

> ID：15665705
> 
> 赞同：1
> 
> 时间：2013-03-27T17:41:25.527
> 
> 标签：arrays, bash, variables, dynamic

我在构建“动态”数组时遇到问题。

首先，我创建一个数组来生成文件名列表：

```
declare -a pgidarr=`run "select partition_id from ETL.PARTITION_GROUP_MEMBER where partition_group_id=${PGID}"`
for i in ${pgidarr[@]}
do
ARRLOOP=$i
PAID=`run "select LPAD('${ARRLOOP}',2,'0')"` #LPAD the partition ID
FILENAME=ABCD_${PAID}_000000.txt 
```

现在在同一个循环中，我想创建一个新数组

```
trigarrat=("${trigarrat[@]}" $FILENAME) 
```

但是当我运行它并没有替换 $FILENAME

在谷歌上我找不到太多关于数组和变量的信息，任何人都可以帮助我吗？;） 谢谢！亚历克斯

bash --version GNU bash，版本 3.1.17(1)-release

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T18:05:45.060

尝试使用`+=`将元素附加到`trigarrat`：

```
declare -a pgidarr=`run "select partition_id from ETL.PARTITION_GROUP_MEMBER where partition_group_id=${PGID}"`
trigarrat=()
for i in ${pgidarr[@]}
do
    ARRLOOP=$i
    PAID=`run "select LPAD('${ARRLOOP}',2,'0')"` #LPAD the partition ID 
    FILENAME=ABCD_${PAID}_000000.txt
    trigarrat+=($FILENAME)
done 
```

参考：[http ://www.gnu.org/software/bash/manual/bashref.html#Shell-Parameters](http://www.gnu.org/software/bash/manual/bashref.html#Shell-Parameters)

# typo3 - TYPO3 4.5：TCA 是否应该出现在“插件选项”中？

> ID：15665708
> 
> 赞同：1
> 
> 时间：2013-03-27T17:41:30.740
> 
> 标签：typo3, typo3-tca

我正在 Typo3（版本 4.5.22）中创建我的第一个扩展。我正在使用 Dmitry Dulepov 的“TYPO3 Extension Development”一书作为指南（非常有用的参考资料）。我使用 Kickstarter 让事情顺利进行，它生成的其中一件事是一个 $TCA，它与我自己在数据库中的表一起使用。

现在，我的理解是，当您创建新的“插入插件”内容项时，TCA 会在“插件选项”下为我的插件确定哪些选项出现在后端。问题是，这部分仍然是空白的。当我选择我的插件时，没有显示任何选项。

我能够构建一个 Flexform 并让它显示在“插件选项”下，但我的插件的一个极其重要的组件是能够使用“建议”表单来搜索记录，从我读过的内容来看，使用 Flexforms 无法让它们正常工作。

我是否缺少 ext_tables 中的一个简单函数来让我的 TCA 显示在“插件选项”部分？对不起，如果我在这里完全偏离基地；Typo3 的复杂性让我有点发呆。

这是我的 ext_tables.php，它是由 Kickstarter 生成的：

```
<?php
if (!defined('TYPO3_MODE')) {
    die ('Access denied.');
}

t3lib_extMgm::allowTableOnStandardPages('tx_newsbuilder_newsitems');

t3lib_extMgm::addToInsertRecords('tx_newsbuilder_newsitems');

$TCA['tx_newsbuilder_newsitems'] = array(
    'ctrl' => array(
        'title'     => 'LLL:EXT:newsbuilder/locallang_db.xml:tx_newsbuilder_newsitems',        
        'label'     => 'uid',    
        'tstamp'    => 'tstamp',
        'crdate'    => 'crdate',
        'cruser_id' => 'cruser_id',
        'default_sortby' => 'ORDER BY crdate',    
        'delete' => 'deleted',    
        'enablecolumns' => array(        
            'disabled' => 'hidden',
        ),
        'dynamicConfigFile' => t3lib_extMgm::extPath($_EXTKEY) . 'tca.php',
        'iconfile'          => t3lib_extMgm::extRelPath($_EXTKEY) . 'icon_tx_newsbuilder_newsitems.gif',
    ),
);

t3lib_div::loadTCA('tt_content');
$TCA['tt_content']['types']['list']['subtypes_excludelist'][$_EXTKEY.'_pi1'] = 'layout,select_key';

t3lib_extMgm::addPlugin(array(
    'LLL:EXT:newsbuilder/locallang_db.xml:tt_content.list_type_pi1',
    $_EXTKEY . '_pi1',
    t3lib_extMgm::extRelPath($_EXTKEY) . 'ext_icon.gif'
),'list_type');

if (TYPO3_MODE === 'BE') {
    $TBE_MODULES_EXT['xMOD_db_new_content_el']['addElClasses']['tx_newsbuilder_pi1_wizicon'] = t3lib_extMgm::extPath($_EXTKEY) . 'pi1/class.tx_newsbuilder_pi1_wizicon.php';
}

// Flexform
//$TCA['tt_content']['types']['list']['subtypes_addlist'] [$_EXTKEY . '_pi1'] = 'pi_flexform';
//t3lib_extMgm::addPiFlexFormValue($_EXTKEY . '_pi1', 'FILE:EXT:' . $_EXTKEY . '/pi1/flexform_ds.xml');

?> 
```

另外，这里是我的 tca.php：

```
<?php
if (!defined('TYPO3_MODE')) {
    die ('Access denied.');
}

$TCA['tx_newsbuilder_newsitems'] = array(
    'ctrl' => $TCA['tx_newsbuilder_newsitems']['ctrl'],
    'interface' => array(
        'showRecordFieldList' => 'hidden,tt_news_uid,singleview_uid,fishback_uid,fishback_url,headline,subheading,link'
    ),
    'feInterface' => $TCA['tx_newsbuilder_newsitems']['feInterface'],
    'columns' => array(
        'hidden' => array(        
            'exclude' => 1,
            'label'   => 'LLL:EXT:lang/locallang_general.xml:LGL.hidden',
            'config'  => array(
                'type'    => 'check',
                'default' => '0'
            )
        ),
        'tt_news_uid' => array(        
            'exclude' => 0,        
            'label' => 'LLL:EXT:newsbuilder/locallang_db.xml:tx_newsbuilder_newsitems.tt_news_uid',        
            'config' => array(
                'type' => 'group',    
                'internal_type' => 'db',    
                'allowed' => 'NO_TABLE_NAME_AVAILABLE',    
                'size' => 1,    
                'minitems' => 0,
                'maxitems' => 1,
            )
        ),
        'singleview_uid' => array(        
            'exclude' => 0,        
            'label' => 'LLL:EXT:newsbuilder/locallang_db.xml:tx_newsbuilder_newsitems.singleview_uid',        
            'config' => array(
                'type' => 'group',    
                'internal_type' => 'db',    
                'allowed' => 'tt_news',    
                'size' => 1,    
                'minitems' => 0,
                'maxitems' => 1,
            )
        ),
        'fishback_uid' => array(        
            'exclude' => 0,        
            'label' => 'LLL:EXT:newsbuilder/locallang_db.xml:tx_newsbuilder_newsitems.fishback_uid',        
            'config' => array(
                'type' => 'group',    
                'internal_type' => 'db',    
                'allowed' => 'pages',    
                'size' => 1,    
                'minitems' => 0,
                'maxitems' => 1,
            )
        ),
        'fishback_url' => array(        
            'exclude' => 0,        
            'label' => 'LLL:EXT:newsbuilder/locallang_db.xml:tx_newsbuilder_newsitems.fishback_url',        
            'config' => array(
                'type'     => 'input',
                'size'     => '15',
                'max'      => '255',
                'checkbox' => '',
                'eval'     => 'trim',
                'wizards'  => array(
                    '_PADDING' => 2,
                    'link'     => array(
                        'type'         => 'popup',
                        'title'        => 'Link',
                        'icon'         => 'link_popup.gif',
                        'script'       => 'browse_links.php?mode=wizard',
                        'JSopenParams' => 'height=300,width=500,status=0,menubar=0,scrollbars=1'
                    )
                )
            )
        ),
        'headline' => array(        
            'exclude' => 0,        
            'label' => 'LLL:EXT:newsbuilder/locallang_db.xml:tx_newsbuilder_newsitems.headline',        
            'config' => array(
                'type' => 'text',
                'cols' => '48',    
                'rows' => '1',
            )
        ),
        'subheading' => array(        
            'exclude' => 0,        
            'label' => 'LLL:EXT:newsbuilder/locallang_db.xml:tx_newsbuilder_newsitems.subheading',        
            'config' => array(
                'type' => 'text',
                'cols' => '48',    
                'rows' => '1',
            )
        ),
        'link' => array(        
            'exclude' => 0,        
            'label' => 'LLL:EXT:newsbuilder/locallang_db.xml:tx_newsbuilder_newsitems.link',        
            'config' => array(
                'type'     => 'input',
                'size'     => '15',
                'max'      => '255',
                'checkbox' => '',
                'eval'     => 'trim',
                'wizards'  => array(
                    '_PADDING' => 2,
                    'link'     => array(
                        'type'         => 'popup',
                        'title'        => 'Link',
                        'icon'         => 'link_popup.gif',
                        'script'       => 'browse_links.php?mode=wizard',
                        'JSopenParams' => 'height=300,width=500,status=0,menubar=0,scrollbars=1'
                    )
                )
            )
        ),
    ),
    'types' => array(
        '0' => array('showitem' => 'hidden;;1;;1-1-1, tt_news_uid, singleview_uid, fishback_uid, fishback_url, headline, subheading, link')
    ),
    'palettes' => array(
        '1' => array('showitem' => '')
    )
);
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T22:40:51.193

**TCA**是表配置数组。**它在Web -> 列表**模块中配置 TYPO3 后端中的 db 表中的记录的外观。因此，如果您转到此模块并为 创建新条目`tx_newsbuilder_newsitems`，您将看到您的记录创建/编辑表单，如 和 中配置的`tca.php`那样`ext_tables.php`。

插入到页面上的**插件**是一个常见的内容元素，保存在**tt_content**表中，因此它被显示，就像在 tt_content 的 TCA 中定义的那样。但是这个表配置**了pi_flexform**字段，它是**flex**类型的，里面可以包含灵活的数据，其实就是**flexform**。为此，您需要为您的 FlexForm 创建一个适当的 XML 文件并指示 TYPO3 使用它。

[在 TYPO3 wiki](http://wiki.typo3.org/Extension_Development,_using_Flexforms)中，您可以找到有关 FlexForms 使用的详细信息。

PS 应该可以在 FlexForm 中使用*建议*向导，因为 FF 表示法与 TCA 表示法几乎相同，并且所有向导都应该可用。

# python - ctypes 通过引用传递字符串：字符串未更新

> ID：15665714
> 
> 赞同：0
> 
> 时间：2013-03-27T17:41:50.157
> 
> 标签：python, reference, ctypes

我想将对字符串的引用从 python 传递给 ac 程序。c 程序向字符串写入了一些内容，我想在 python 中读回它。c 程序如下所示：

```
void foo(char *name) {
    name = "Hello World";
} 
```

和 Python 脚本：

```
>>> import ctypes
>>> lib=ctypes.CDLL('libfoo.so')
>>> name=ctypes.create_string_buffer(32)
>>> print name.value

>>> lib.foo(name)
>>> print name.value

>>> 
```

我希望在第二个之后出现“Hello World” `print`。我确定这很简单，但我无法弄清楚出了什么问题......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T17:43:56.583

您的 C 代码更改指针的值，而不是更改缓冲区。请记住，C 参数是按值传递的，因此修改参数永远不会导致调用者可以看到的更改。

无论如何，您只需要将`strcpy`您的字符串复制到提供的缓冲区中。

```
void foo(char *name) {
    strcpy(name, "Hello World");
} 
```

显然，在实际代码中，您也需要传递缓冲区长度，以避免缓冲区溢出。

# c# - 数据调用的集成测试加载时间

> ID：15665715
> 
> 赞同：0
> 
> 时间：2013-03-27T17:41:54.163
> 
> 标签：c#, testing, integration-testing

我目前有一个方法调用需要很长时间才能加载并且有时会超时。在尝试加快数据调用之前，我想编写一个集成测试以确保在合理的时间内返回我的数据。我该怎么做？

```
 [TestMethod]
    public void GetResults_ReturnsDataInReasonableAmountOfTime_Test()
    {
        var result = _dataAccess.GetListOfResults();
        Assert.IsTrue(##How do I Test that result was returned in under 2 seconds?##);
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T17:56:55.687

一个例子`AutoResetEvent`

```
 private AutoResetEvent _resetEvent;

    [TestInitialize]
    public void SetUp()
    {
        _resetEvent = new AutoResetEvent(false);
    }

    [TestMethod]
    public void GetResults_ReturnsDataInReasonableAmountOfTime_Test()
    {
        new Thread(() =>
        {
            // your long method call
            _resetEvent.Set();
        }).Start();

        Assert.IsTrue(_resetEvent.WaitOne(2000));
    } 
```

# css - 用于全宽背景的图像的适当大小

> ID：15665717
> 
> 赞同：0
> 
> 时间：2013-03-27T17:41:59.387
> 
> 标签：css, html, background

我正在寻找有关将图像用作页面背景部分的宽度的一些说明。例如，在具有固定大小内容部分的可变宽度设计中，通常会将背景图像附加到页面主体，然后将跨越整个浏览器宽度的附加图像设置为（居中）背景图像在其他 div 上。

我在很大程度上了解这是如何工作的，但我正在寻找有关制作图像的宽度的指导。我见过一些网站使用 4000 像素宽的背景，甚至 8000 像素宽的背景，这比任何用户的浏览器窗口都可能宽。

这种技术是否依赖于一些潜在的怪癖，这是驱动巨大宽度的原因吗？

我也很好奇为什么 div 的背景图像能够落在页面上其余元素流之外的逻辑。同样，我知道它有效，但我很好奇为什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:14:10.880

当使用大照片作为背景图像时，我不会大于 2560x1440px，这是 27" iMac 屏幕上的分辨率：[http://support.apple.com/kb/sp623。1366x768px](http://support.apple.com/kb/sp623)是最常见的显示器分辨率，后跟 1920x1080px：[http](http://www.w3schools.com/browsers/browsers_resolution_higher.asp) ://www.w3schools.com/browsers/browsers_resolution_higher.asp 。

如果您有一个固定宽度的内容部分，并且希望图像填充该部分，请将图像设置为该部分的大小并使用 css 对其进行缩放：[http ://css-tricks.com/perfect-full-page-背景图像/](http://css-tricks.com/perfect-full-page-background-image/) . 我假设您将照片用作背景图像，而不是重复图案。在这种情况下，您只需在重复之前将图像缩放到图案的大小。

# plugins - 如何从 sshd 的 check_procs 检查中排除登录

> ID：15665723
> 
> 赞同：1
> 
> 时间：2013-03-27T17:42:17.463
> 
> 标签：plugins, nagios, sshd

我希望使用 Nagios 插件 check_procs 来监控在我的 CentOS 服务器上运行的 ssh 守护进程的数量。现在考虑我的服务器：

```
$ ps auxww | grep ssh
root      6750  0.0  0.0  31812  1224 ?        Ss    2012   0:01 /usr/sbin/sshd
root     23375  0.0  0.0  65464  3244 ?        Ss   16:53   0:00 sshd: user [priv]
user     23377  0.0  0.0  65464  1908 ?        S    16:53   0:00 sshd: user@pts/1
root     23404  0.0  0.0  65464  3248 ?        Ss   16:53   0:00 sshd: user [priv]
user     23406  0.0  0.0  65464  1912 ?        S    16:53   0:00 sshd: user@pts/2 
```

我只想知道有多少“/usr/sbin/sshd”实例正在运行，而不是启动了多少个守护进程来处理传入的 ssh 连接。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T01:34:29.503

您可以使用以下命令检查专门从“root”启动的“sshd”守护进程：

```
check_procs -p 1 -C sshd
PROCS OK: 1 process with PPID = 1, command name 'sshd' 
```

这应该消除开始处理用户连接的分叉。'-p' 选项告诉 check_procs 只计算具有给定 PPID 的那些进程，在这种情况下，'1' 属于 root。check_procs 命令不允许您添加路径。

如果您需要查看正在运行的“/usr/sbin/sshd”特定守护进程的数量，无论它们是从哪个用户运行的，您都可以围绕以下内容进行检查：

```
ps -ef | grep "/usr/sbin/sshd" | grep -v grep | wc -l
1 
```

这会给你计数，然后你可以检查 bash/perl/... 并根据需要发出警报。

查看 check_procs 的源代码后，我将使用以下检查配置：

```
check_procs -p 1 --ereg-argument-array=^\/usr\/sbin\/sshd 
```

这应该为您提供您正在寻找的确切内容，并将在正在检查的内容中​​包含“路径” - 这是 -C 选项不可用的。

# jquery - 从跨度父级中取出跨度并给父级一个类

> ID：15665727
> 
> 赞同：1
> 
> 时间：2013-03-27T17:42:22.303
> 
> 标签：jquery

```
I have this html:

<span class="titreck">
L
<span class="descck">Column 1</span>
</span> 
```

我需要给 titreck span 另一个类，但也要将 descck span 从其父 titreck span 中取出。

页面上还有其他的titreck span，我只需要影响这个。

我尝试使用破坏滴定跨度的 unwrap，但 L 字母仍然存在，这是一个问题。

首先，我给了父跨度一个类：

```
$('span.descck').parent().addClass('hideme'); 
```

然后像这样使用 unwrap ：

```
$('span.descck').unwrap(); 
```

但是 L 字母仍然存在，我只需要 descck span 中的内容即可。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T17:49:09.597

使用`has()`方法...`addClass()`添加类并替换它的文本，使用`text()`descck 类的文本

尝试这个

```
$('span.titreck:has(".descck")').addClass('hideme').text($("span.descck").text()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T18:07:37.460

这样做：

```
var de = $('.descck').clone(); //<-----make a copy of this span
$('.descck').remove(); //<-------remove it 
de.insertAfter('.titreck'); //<---insert after its parent
$('.titreck').toggleClass('titreck newClass'); // <---toggle the class to new one 
```

### [演示](http://jsfiddle.net/BDE5K/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T17:49:43.250

像这样的东西应该工作：

```
/*Change the class of the span having a class of titreck that is a parent of the span having a class of descck */
$("span.descck").parent(".titreck").addClass("newClass").removeClass("titreck");
/*Remove the span that has a class of descck*/
$("span.descck").remove(); 
```

# javascript - 在 JavaScript 中附加对象和属性

> ID：15665729
> 
> 赞同：-1
> 
> 时间：2013-03-27T17:42:27.330
> 
> 标签：javascript, object, push

在 JavaScript 中，我如何将一个对象连同其他一些新属性一起推送到一个数组中。例如，我想做这样的事情：

```
for(var i=0; i<T_ARRAY.length; i++)
{
   if(!T_ARRAY[i].isCorrect)
   {
      NEW_ARRAY.push({T_ARRAY[i], 'idxPerg' : i+1});
   }    
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T17:44:59.547

您可以通过执行以下操作来简单地添加属性：

```
for(var i=0; i<T_ARRAY.length; i++)
{
   if(!T_ARRAY[i].isCorrect)
   {
       var newObj = T_ARRAY[i];
       newObj.idxPerg = i+1;
       NEW_ARRAY.push(newObj);
   }    
} 
```

您也可以使用动态键符号

```
for(var i=0; i<T_ARRAY.length; i++)
{
   if(!T_ARRAY[i].isCorrect)
   {
       var newObj = T_ARRAY[i];
       newObj["idxPerg"] = i+1;
       NEW_ARRAY.push(newObj);
   }    
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T17:45:23.190

JavaScript 没有任何语法可以将属性添加到对象并返回原始对象。你必须在两个语句中做到这一点。

```
T_ARRAY[i].idxPerg = i+1;
NEW_ARRAY.push(T_ARRAY[i]); 
```

# sql-server - 实体框架是否有类似表队列的 sql OUTPUT 子句的东西？

> ID：15665743
> 
> 赞同：0
> 
> 时间：2013-03-27T17:43:16.220
> 
> 标签：sql-server, entity-framework

我正在寻找一个将由多线程应用程序访问的队列。我已经看到了一些关于这个主题的 SO 问题，并建议使用表并参考[这篇](http://rusanu.com/2010/03/26/using-tables-as-queues/)文章，该文章建议使用 sql OUTPUT 子句在同一个数据调用中执行读取和删除。这可以防止多个线程读取相同的记录。

我是我的情况，我正在使用实体框架，并且想知道是否有人知道使用实体框架实现相同结果的方法。提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T19:17:22.070

您链接到的文章创建了存储过程。EF 支持存储过程，因此您可以只从 EF 调用存储过程。

EF 还支持命令，因此您可以将 SQL 放在命令文本中并执行它。

# shell - 在 Shell 脚本中移动生成的文件

> ID：15665758
> 
> 赞同：0
> 
> 时间：2013-03-27T17:43:57.660
> 
> 标签：shell, unix

我有一个 shell 脚本，它调用生成一些文件的其他脚本。在我的 shell 脚本结束时，我想将所有生成的文件（它们具有相同的前缀）移动到一个文件夹中。

但是，由于某种原因，如果我`mv`在脚本末尾有调用，我会收到这个错误，就像文件系统仍然不知道我认为的文件一样。

```
mv: cannot stat `foo_*': No such file or directory 
```

我第一次尝试“解决”这个问题是引入`sleep`几秒钟的调用来帮助我避免这个问题，但是，即使值非常高并且我确定文件已经创建，我得到了同样的错误。

然后我尝试像这样运行我的脚本：

```
sh myscript.sh ; mv foo_* bar 
```

它没有问题。

知道为什么会发生这种情况以及如何避免使用两个脚本或双行命令来达到预期的效果吗？

谢谢。

**编辑**：我正在为可能从谷歌来到这里并遇到类似问题的人写这篇文章。

基本上，我正在生成这样的`mv`命令：

`mv $preffix"_*" $destination`

出于某种原因，这无法正常工作。刚刚创建了一个像这样的临时变量：

`MV_CMD=$preffix"_*" $destination`

然后就这样称呼它：

`mv $MV_CMD`.

如果有人知道更清洁的方法，请随时回答。谢谢大家的回答。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T23:59:20.497

出于调试目的，不要在脚本末尾添加`sleep`后跟，而是添加：`mv`

```
pwd
ls -la . 
```

这会将当前目录及其所有内容打印到控制台。

此外，在启用调试的情况下执行脚本：`sh -x ./myscript.sh`查看执行的所有命令，以便更好地了解原因可能是什么，以及正在创建的文件是什么，以及在哪个目录中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T01:52:37.950

不留下垃圾是一种常见的做法，这是您的程序创建的

检查 rm 命令的其他外壳......他们可能有删除或删除创建的中间文件的说明。

您还应该检查特定的目录更改，这些文件可能是在其他一些位置创建的或移动到某个地方的。

但无论哪种情况，您都需要浏览脚本以查找 rm 、 mv 或 cd 命令。

应该这样做。

# django - 在 Django 的基于类的视图中模拟函数

> ID：15665759
> 
> 赞同：6
> 
> 时间：2013-03-27T17:44:01.383
> 
> 标签：django, unit-testing, django-models, python-2.7, python-mock

我正在将 Django REST Framework 用于我正在处理的 API。出于几个原因，我想使用基于类的视图。但是，我对我的单元测试有点挑剔，我从不让我的单元测试接触数据库。注意：我总是使用 Carl Meyer 在 Pycon 2012 演示的“技巧”，他在其中模拟了 Cursor 包装器。

```
cursor_wrapper = Mock()
cursor_wrapper.side_effect = RuntimeError("No touching the database!")

@patch('django.db.backends.util.CursorWrapper', cursor_wrapper)
class TestMyCode(TestCase): 
```

这是如果您对幻灯片感兴趣，[链接。](http://carljm.github.com/django-testing-slides/#29)

我在其中一个视图中有一个方法可以检查数据库中的某些内容。为了干燥，它在 POST 和 PUT 之间共享。但是，我在为我的单元测试模拟它时遇到了问题。这是因为类方法 as_view 创建了一个新的实例和类调度，并返回调度返回的“处理程序”函数。所以，我似乎无法在基于类的视图中获取共享方法来模拟它。

我可以模拟出基于类的视图使用的模型，但是我必须从根本上打破我的“干”目标，并在 POST 和 PUT 中复制代码。我想我可以重构代码并将逻辑移到模型上。但是，我并不肯定我想这样做。

您如何模拟基于类的视图的共享方法以避免实际接触数据库？只是避开他们？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-03-17T08:47:10.520

我想你回答了你自己的问题。用于测试任何 Web 框架的相同内容也适用于 Django，例如控制反转和依赖注入。您可以在 Python 中保持非常简单，因此不要被诸如 Spring 之类的东西吓倒或关闭。

为什么不将代码移出基于类的视图？如果您出于某种原因在其他地方需要相同的逻辑，您的代码仍然不会干燥。仅仅因为它是 Django 并不意味着好的编程原则不适用。

我建议在新的类/python 模块中抽象一些东西，例如服务（作为一个概念，而不是 Django 对服务的定义）和其他用于数据访问的逻辑抽象。然后，您完全独立于 Django 视图的请求/响应生命周期。Django 和 Rails 开发人员倾向于将所有逻辑都直接放在模型或视图中。这只会导致上帝类和难以测试的东西。

您也可以通过将您的视图视为一个轻抽象来促进这一点，它处理诸如编组参数（GET/POST）等到您的代码的其余部分并调用封装在其他地方的必要逻辑。IMO，如果您想要可测试的代码，那么 99% 的逻辑应该在 Web 上下文之外，除非它对流程绝对至关重要。这也使得在后台和并行运行事情变得更容易。

你最终应该得到的是易于测试的普通 python 模块和类，因为它们没有直接依赖于 HTTP。如果你需要模拟 HTTP，你可以简单地模拟请求对象。你很幸运，python/django 的组合使得将这些东西转储和模拟为简单的 dicts/kwargs 变得很容易。

我意识到使用基于类的视图的一件事是它们非常适合与 mixins 一起使用并强制执行一些约定（返回 json、打开图形属性等），但是使用更“高级”的基于类的视图，这些视图直接需要 DetailView 等模型使事情不必要地复杂化。这些视图非常适合管理屏幕，但对于真正的应用程序来说，帮助大于伤害。除非您找到一种很好的、​​无缝的方式来集成缓存层等，否则它们会使事情变得难以测试和破坏性能。这时候，通常只是继承自 View 或 TemplateView 就可以了。

具体关于数据库模拟，创建你的模拟并检查你的业务逻辑。然后，只要符合一组特定的规则和接口，您输入/输出的内容就无关紧要。[例如，请参阅Mixer 之](https://github.com/klen/mixer)类的东西。您还可以在测试期间简单地创建/销毁临时数据库。一种方法是为 dev/staging/production/testing 等创建单独的设置模块，并根据环境动态加载它们。这样你就可以避免在运行单元测试时损坏你的开发数据库。当然，这更多地涉及一种集成测试形式，但您可能也应该这样做。上述解决方案在 Hibernate 等其他 ORM 中很常见。

与前面相关，您可以在设置中执行类似于以下代码的操作，以使用内存数据库进行单元测试。最终，您仍然需要考虑针对您的实际数据存储类型进行集成测试，例如 MySQL

```
if 'test' in sys.argv:
    DATABASES['default']['ENGINE'] = 'sqlite3' 
```

;tldr

1.  将类视图之外的逻辑放入适当的对象和模块中。

2.  不要把自己锁在试图让各种基于类的捆绑视图适用于实际应用程序和每个用例；滚动你自己的。

3.  使用一般良好的 TDD 原则，例如 IOC，将所需参数传递给构造函数，松散耦合，避免过多的专有状态要求（尤其是 HTTP）。

    1.  通过创建标准模拟对象（参见#3）和通过类似服务的接口（参见#1）来避免对数据库的依赖。

# javascript - 如果我将一个元素存储在一个 javascript 变量中，当我调用该变量时它会再次检查它吗？

> ID：15665760
> 
> 赞同：0
> 
> 时间：2013-03-27T17:44:03.257
> 
> 标签：javascript, variables

我将元素的值存储在 javascript 变量中，但该函数需要异步运行，因此当再次调用变量时（在 AJAX 引用之后），该元素的值可能已经改变，我需要查看。我可以简单地再次调用该变量，还是在定义变量时该变量只保存该元素的值？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T17:46:41.303

听起来像是两种方式对我有约束力，答案是否定的。将复制一个值，而不是通过引用包含在内。如果使用新值更新元素，则还必须更新变量。

这基本上是 Angular 和 Backbone 为您尝试和处理的 - 维护 ViewModel。

# ssh - 键盘认证 - SSH - 添加更多问题

> ID：15665762
> 
> 赞同：1
> 
> 时间：2013-03-27T17:44:05.997
> 
> 标签：ssh

我读了这篇关于[SSH 身份验证方法的文章](http://www.eldos.com/security/articles/1962.php)

这是那里写的？

在键盘验证期间，向用户呈现零个或多个提示（问题）。用户应该给出每个提示（问题）的答案。问题的数量和内容几乎不受限制，因此某些类型的自动登录也是可能的。

我在 Ubuntu 上运行 SSH 服务器。我的问题是如何添加更多提示（问题）？现在它只提示输入密码。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T12:04:28.940

这是使用[PAM](http://en.wikipedia.org/wiki/Pluggable_authentication_module)完成的。[这](http://www.howtogeek.com/121650/how-to-secure-ssh-with-google-authenticators-two-factor-authentication/)是将 Google Authenticator 模块与 SSH 结合使用的示例。根据您想要做什么，您可能想要编写自己的模块。可以在[这里](https://www.packtpub.com/article/development-with-pluggable-authentication-modules-pam)找到一篇关于它的好文章。

# javascript - Javascript重载页面实时结果

> ID：15665769
> 
> 赞同：-4
> 
> 时间：2013-03-27T17:44:25.683
> 
> 标签：javascript, real-time

我知道我可以在一定时间后使用 javascript 刷新页面；

```
<html>
<head>
<script type="text/JavaScript">
<!--
function timedRefresh(timeoutPeriod) {
    setTimeout("location.reload(true);",timeoutPeriod);
}
//   -->
</script>
</head>
<body onload="JavaScript:timedRefresh(5000);">
</body>
</html> 
```

一旦在数据库中添加/更新了新字段以实时显示数据而不是“F5”，是否可以重新加载页面

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T03:59:48.260

## 在 UPDATE、INSERT 和 DELETE 上通过 MySQL 触发器调用通知

这适用于大多数数据库，并且可用于在发生更改时*（例如当字段更新并且您需要立即通知客户时）*将服务器发送的事件直接发送到浏览器。

使用`Database Triggers`and `Server-Sent Event Notifications`which 通过以下命令将事件触发器**直接发送到浏览器**-[当 mysql](https://stackoverflow.com/questions/13474012/invoke-pusher-when-mysql-has-changed?answertab=active#tab-top)针对数据库上的任何更改发生更改时调用推送器。这发生在实时的实时结果中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T18:08:30.373

您可以设置插入和更新触发器来发送会导致回调在应用程序中执行的事件。然后应用程序可以调用已注册的 JS 回调函数。您可以在此处查看说明[https://stackoverflow.com/a/812803/1418005](https://stackoverflow.com/a/812803/1418005)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-27T17:48:17.683

您不应该在一定时间后刷新页面，这对用户来说相当麻烦。您应该使用 setInterval 向服务器发送另一个请求以动态更新页面。

[http://www.w3schools.com/jsref/met_win_setinterval.asp](http://www.w3schools.com/jsref/met_win_setinterval.asp)

```
setInterval(fn, 5000);

function fn() {
  alert('???');
} 
```

编辑响应：您可以使用数据库触发事件来触发插入事件，然后通知客户端读取，或者您可以使用轮询机制 - 使用 (setTimeout/setInterval) 每 60 秒查询一次数据库。这可以使用 jQuery ajax 或任何其他 XHR 机制来完成。

例如：

```
$.ajax({
  type: 'GET',
  url: 'server.php/GetPageData' // or GetPageUpdate
  data: {},
  success: function(data) {

  }
}); 
```

# windows-7 - 如何解决有故障的安装程序/Net.Pipe/SOAP 错误

> ID：15665771
> 
> 赞同：0
> 
> 时间：2013-03-27T17:44:38.060
> 
> 标签：windows-7, installation, net.pipe

我们公司从 Inprotech 获得了一个安装程序，该安装程序可以在某些机器上工作，但不能在其他机器上工作。我们部署安装程序的截止日期很紧，供应商还没有提供帮助。我希望您能帮助我获得一些见解，或者至少帮助提出正确的针对性问题。

我不明白为什么安装可以在某些机器上运行，而在其他机器上不行。我尝试使用不同的帐户进行安装，检查权限设置，桌面版本（我们在 Windows 7 上）等。

安装程序应安装新的 Word 加载项，该加载项设置 net.pipe 侦听器以将信息从 Web 提取到模板中。它在需要打开 net.pipe 和 net.tcp 侦听器适配器的 Windows 服务中安装服务。这一切似乎进展顺利。但是，当我测试连接时，在失败的机器上我收到一个错误：

```
"There was no enpoint listening at net.pipe://localhost/[domain] that could 
accept the message... 
The pipe endpoint 'net.pipe://localhost/[domain]' could not be found 
on your local machine." 
```

我已经创建了一些工作和非工作安装的详细日志文件。它们有数千行，而我在发现任何显着差异方面并没有取得多大成功。一个很大的不同是，从工作机器安装的还有数百行看起来像这样：

```
MSI (s) (E4:90) [16:31:39:832]: Using cached product context: 
    machine assigned for product: DB26B2D276F00B24EB6668D6B73666F3
MSI (s) (E4:90) [16:31:39:832]: Setting cached product context: 
    machine assigned for product: DB8788415A2A1FC41A30B26A234F9135
MSI (s) (E4:90) [16:31:39:832]: Using cached product context: 
    machine assigned for product: DB8788415A2A1FC41A30B26A234F9135
MSI (s) (E4:90) [16:31:39:832]: Setting cached product context: 
    machine assigned for product: DDA39468D428E8B4DB27C8D5DC5CA217 
```

需要明确的是，两个日志都有数百行与上述类似。成功的安装只有数百行像上面这样*。*

我不确定还有哪些其他信息与该问题相关。我怀疑失败的安装部分也引用了 S-1-5-20。我不确切知道它是如何使用引用的，但它在端口 +:8000 上设置了一些东西。

如果有人对如何针对我的故障排除有任何建议，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T11:53:07.923

您的供应商应该查看它的 net.pipe 端点 URL 是如何定义的。如果他们使用基本 URL + 相对 URL，则此问题可能发生在任何运行其他应用程序的机器上，这些应用程序也使用 WCF net.pipe 传输。

查看错误消息中的服务 URL，我猜这正是正在发生的事情。

他们应该在创建服务端点时使用绝对 URL，使用旨在保证唯一性的名称。那么这个问题就不会发生。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-01T14:51:39.833

我仍然有兴趣听取任何有其他想法的人的意见，但是在与供应商进行了一段时间的故障排除后，事实证明可以通过将端口参考中的“https”更改为 http”来解决该问题。

完整的参考没有包含在原始查询中，因为 Stack Overflow 一直给我一个错误，即不允许链接到端口。我不知道如何格式化它以包含整个链接。

# ios - 无需离开应用即可在 iOS 中的 Google+ 上分享

> ID：15665774
> 
> 赞同：0
> 
> 时间：2013-03-27T17:44:41.150
> 
> 标签：ios, iphone, ipad, google-plus

对不起我的英语不好。

我们可以使用 Google+ iOS SDK 中的 GPPShare 类在 Google+ 上共享链接，但在这里我们需要转移到 safari 浏览器。

我还看到适用于 iPhone/iPad 的 Flipboard 应用程序无需离开 Flipboard 应用程序即可在 Google+ 上进行分享。

有谁知道如何在不离开应用程序的情况下在 Google+ 上分享信息。

我现在被困住了。如果有人有任何线索，请尽快让我知道。

提前致谢。

# memory-leaks - 我的转换器没有得到 GC 的奇怪场景

> ID：15665775
> 
> 赞同：1
> 
> 时间：2013-03-27T17:44:46.433
> 
> 标签：memory-leaks, windows-phone-8, windows-phone

在我的一个 wp8 应用程序中，我使用[BindingReflector](http://www.shujaat.net/2011/02/wpf-binding-converter-parameter.html)来启用对转换器参数的绑定。我遇到的一个问题是，任何高于（在 XAML 中）在参数上使用绑定的转换器根本不会被 GC。我注意到使用此特定顺序的页面在导航到它然后返回并重复时会获得越来越多的内存。

在试图弄清楚发生了什么之后，我决定尝试更改它们在 XAML 中的顺序，使之在顶部使用反射器，问题就解决了。我想知道是否有人对此有任何解释。

当我遇到这个内存泄漏问题时，在**GC Roots**下的分析器显示我的转换器都在使用带有**Handle (WeakRef)**的反射器引用（不是直接）转换器。不知道怎么会发生这种情况，但是现在一旦它们出现故障，一切都很好，并且可以正确地进行 GC。

请注意，转换器都在兄弟控件中，结构基本上是这样的列表框：

```
<ListBox ItemsSource={Binding...}>
   <!-- ... item template like below -->
   <controlX propX={Binding xxx, converter=....}/>
   <controlY propY={Binding yyy, converter=....}/>
   ...
</ListBox> 
```

**编辑：** 我创建并上传了一个简单的测试项目，您可以[从这里下载 zip](http://sdrv.ms/100LZS8)。运行应用程序，一旦 MainPage 加载，单击将您带到 Page1.xaml 的按钮，点击后退按钮，然后再次单击将您带到 Page1.xaml 的按钮并重复此过程。

我在每个页面的标题下都包含了显示当前内存使用情况的计数器，你不会注意到那里的任何东西，但接下来的 3 个计数器是

1.  Page1 对象的当前实例计数（黄色）
2.  随机转换器对象的当前实例计数（红色）
3.  使用绑定反射器对象的转换器的当前实例计数（绿色）

您会注意到，虽然黄色和绿色永远不会超过 3，但当您在 ​​MainPage.xaml 和 Page1.xaml 之间来回切换时，红色会继续上升。

现在，使用 Page1.xaml 中的转换器切换 2 个按钮控件的位置，只需将它们注释掉并取消注释它们下面的那些，您会注意到所有 3 个计数器都不会超过 3。

**编辑2：** 显然这不仅仅是绑定反射器。让两个按钮使用相同的转换器将导致特定的转换器实例不被 GC。我不知道为什么会这样。。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-31T12:06:00.097

**到目前为止我发现了什么：**

*   泄漏以某种方式与 DataTemplate 相关联。如果我将控件放在 DataTemplate 之外，我将无法重现它。此外，即使控件是在页面资源中未使用的 DataTemplate 中声明的，也会发生泄漏
*   没有 GCRoot 可以解释该对象不是垃圾收集的。所以引用可能由一些内部本机对象持有。我已经注意到可能发生这种情况的情况：http: [//blogs.codes-sources.com/kookiz/archive/2013/02/17/wpdev-memory-leak-with-bitmapimage.aspx](http://blogs.codes-sources.com/kookiz/archive/2013/02/17/wpdev-memory-leak-with-bitmapimage.aspx)
*   正如您在评论中提到的那样，可以通过两个按钮引用同一个转换器来重现泄漏。如果两个按钮引用相同转换器类型的单独实例，则不会发生泄漏。因此，我猜 Silverlight 运行时在初始化 DataTemplate 时会以某种方式弄乱它的引用计数。

**解决方法：**

我有胆量认为泄漏来自在 DataTemplate 中引用一个已从模板范围之外声明的对象（在您的情况下是转换器，但它也让我想起了[涉及附加属性的类似泄漏](http://social.msdn.microsoft.com/Forums/en-US/wpdevelop/thread/11684ea3-5c71-4354-a4e4-c337198f52b1/)）。在寻找一种在同一范围内声明转换器的方法时，我设法找到了一种解决方法：

坐下，深呼吸。打开泄漏转换器的类（在您的情况下为`RandomConverter`）。使其继承形式`FrameworkElement`。泄漏已修复。

……别问了。

这种解决方法实际上是找出内存分配问题所在的好方法。我会在接下来的几天里尝试进一步挖掘，但不要期望太多。

# jquery - $.mobile.changePage 期间的 $.mobile.loading 动画

> ID：15665777
> 
> 赞同：1
> 
> 时间：2013-03-27T17:44:56.993
> 
> 标签：jquery, cordova, jquery-mobile

我在这个问题上挣扎了一段时间。我的目的是在 $.mobile.changePage 方法将他重定向到另一个页面时向用户显示纺车。但是，我找到的解决方案都不适合我。一定是 changePage 方法杀死加载动画的问题，因为当我收起 changePage 方法时，会出现旋转的轮子。谢谢你的帮助。

这是我的代码片段：

```
<!DOCTYPE HTML>
  <head>
    <script type="text/javascript" charset="utf-8" src="cordova-2.5.0.js"></script>
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.min.css" />
    <script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
    <script type="text/javascript">
        $( document ).bind( 'mobileinit', function(){
              $.mobile.loader.prototype.options.text = "loading";
              $.mobile.loader.prototype.options.textVisible = false;
              $.mobile.loader.prototype.options.theme = "a";
              $.mobile.loader.prototype.options.html = "";
        });
    </script>
    <script src="http://code.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.min.js"></script>
  </head>
  <body onload="onBodyLoad();">
    <!-- LOGIN PAGE -->
    <div data-role="page" id="login_page">
      <div data-role="content" id="login_content">
        <div id="buttons">
          <button value="Login" id="login">Login</button>
          <button value="Logout" id="logout">Logout</button>
        </div>
      </div>
    </div>
    <!-- TIMELINE PAGE -->
    <div data-role="page" id="timeline_page">
      <div data-role="header" id="timeline_head" data-nobackbtn="true">
        <h1>BlueBirdGap</h1>
        <h2>Timeline</h2>
        <a id="timeline_button_back" data-icon="arrow-l" class="ui-btn-left" 
        href="javascript:return true;" data-role="button" data-inline="true">Zpět</a>
        <div data-role="controlgroup" class="ui-btn-right">
          <a id="logout_button" data-icon="delete" data-role="button">Logout</a>
          <a id="new_tweet_button" data-icon="plus" data-role="button" data-theme="b">Tweet</a>
          <hr>
        </div>
      </div>
      <div data-role="content" id="timeline_content">
        <div id="new_tweet_area">
          <textarea id="tweet_text"></textarea>
          <button data-role="button" data-icon="plus" data-theme="b" class="ui-btn-right" onclick="Twitter.post()">Post</button>
        </div>
        <div id="home_timeline"></div>
      </div>
      <div data-role="footer" id="timeline_footer"></div>
    </div>

   <script>
    function onBodyLoad() {
            document.addEventListener("deviceready", onDeviceReady, false);

        }

    function onDeviceReady() {
            cb = window.plugins.childBrowser;
            $('html').addClass( "ui-loading" );

            if(localStorage.getItem(twitterKey)){
                showLogin(1);
                $.mobile.loading('show');
                Twitter.timeline();
                $.mobile.changePage('#timeline_page', {transition: "slide"});
                $.mobile.loading('hide');
             }
    }
    </script> 
```

我应该补充一点，我正在使用 PhoneGap 框架和 JQM 1.3.0 开发一个 Android 应用程序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T18:19:22.920

使用`$.mobile.showPageLoadingMsg();`and`$.mobile.hidePageLoadingMsg();`而不是`$.mobile.loading();`.

但是，如果它们不起作用，请使用以下代码。

显示加载微调器。

```
$('div.ui-loader').show(); 
```

隐藏它。

```
$('div.ui-loader').hide(); 
```

加载微调器隐藏在 div 之前`</body>`，如下所示。您所需要的只是`show();`它或`hide();`它。

```
<div class="ui-loader ui-corner-all ui-body-a ui-loader-default" style="display: block;">
 <span class="ui-icon ui-icon-loading">
 </span>
 <h1>loading</h1>
</div> 
```

# django - appengine 1.7.6 中的 django.utils 模块导入错误

> ID：15665779
> 
> 赞同：2
> 
> 时间：2013-03-27T17:45:02.153
> 
> 标签：django, google-app-engine, python-2.5

我刚刚更新到 1.7.6 appengine 并开始收到 django.utils 的 ImportError，我的应用程序使用的是 python 2.5，并且在此更新之前运行没有问题。

知道这是否在更新中被删除了吗？

```
line 1, in <module>
from django.utils import simplejson
ImportError: No module named django.utils 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T03:32:14.803

如果您无法升级到 2.7，请尝试使用`old_dev_appserver.py`而不是`dev_appserver.py`.

# html5-canvas - 单击画布中的弧线

> ID：15665782
> 
> 赞同：1
> 
> 时间：2013-03-27T17:45:08.597
> 
> 标签：html5-canvas

我有一个名为城市的数组，其中包含代表城市及其笛卡尔点的对象。从数据库中查询这些城市，然后在画布中绘制（效果很好）并推送到这个数组中。现在我想点击这些点，我想提醒（“你好”）进行测试。

```
$(document).mousemove(function(e) {
    x = e.pageX;
    y = e.pageY;
});
$(document).click(function(e) {
    newx=x;
    newy=y;
    for(var i=0;i<cities.length;i++){
        if ((newx <= cities[i].x+3) && (newx >= cities[i].x-3) && (newy <= cities[i].y+3) && (newy >= cities[i].y-3)) {
            alert(cities[i].name);
        }
    }
}); 
```

这是我的活动代码。现在，我只会在单击从我的点到画布边缘的 +x 和 -y 区域时得到反应。

请帮忙

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T19:20:10.190

**在画布上测试城市圈**

要检查用户是否点击了您的某个城市圈，请使用此毕达哥拉斯相关的命中测试：

```
var dx = cityCenterX – clickX;
var dy = cityCenterY – clickY;
var radius=cityRadius;
var IsInCity = (dx*dx+dy*dy)<(cityRadius*cityRadius); 
```

这是代码和小提琴：http: [//jsfiddle.net/m1erickson/Bgh9d/](http://jsfiddle.net/m1erickson/Bgh9d/)

```
<!doctype html>
<html>
<head>
<link rel="stylesheet" type="text/css" media="all" href="css/reset.css" /> <!-- reset css -->
<script type="text/javascript" src="http://code.jquery.com/jquery.min.js"></script>

<style>
    body{ background-color: ivory; }
    canvas{border:1px solid red;}
</style>

<script>
$(function(){

    var canvas=document.getElementById("canvas");
    var ctx=canvas.getContext("2d");

    var canvasOffset=$("#canvas").offset();
    var offsetX=canvasOffset.left;
    var offsetY=canvasOffset.top;

    // define some cities
    var cities=[];
    cities.push({x:100, y:75,  radius:50, name:"large city"});
    cities.push({x:200, y:100, radius:30, name:"medium city"});
    cities.push({x:150, y:150, radius:25, name:"small city"});

    // draw cities
    ctx.beginPath();
    ctx.lineWidth=3;
    ctx.strokeStyle="blue";
    for (var i=0;i<cities.length;i++){
        ctx.beginPath();
        ctx.arc(cities[i].x, cities[i].y, cities[i].radius, 0 , 2 * Math.PI, false);
        ctx.stroke();
    }

    function handleMouseDown(e){
      // get canvasXY of click
      canvasMouseX=parseInt(e.clientX-offsetX);
      canvasMouseY=parseInt(e.clientY-offsetY);

      // test if we clicked in any cities
      for(var i=0;i<cities.length;i++){
          var dx=canvasMouseX-cities[i].x;
          var dy=canvasMouseY-cities[i].y;
          var isInCity=(dx*dx+dy*dy)<(cities[i].radius*cities[i].radius);
          if(isInCity){
              alert("You clicked in the "+cities[i].name);
          }
      }
    }

    $("#canvas").mousedown(function(e){handleMouseDown(e);});

}); // end $(function(){});
</script>

</head>

<body>
    <canvas id="canvas" width=300 height=300></canvas>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T01:31:34.740

毕达哥拉斯是个不错的选择，除了可以尝试**isPointInPath**方法外，所有其他人都可以尝试。

您没有说，但是如果您使用“路径”（context.beginPath、context.moveTo、context.lineTo 等）将城市绘制到画布上，您应该看看内置的 isPointInPath 方法。

您使用 x, y 点调用该方法。

```
if(context.isPointInPath(50, 150)) {
     alert('In path);
} 
```

查看[此链接](http://www.informit.com/articles/article.aspx?p=1966262&seqNum=2)以获取示例。

# java - 如果结果大小大于 1，Hibernate 返回重复值

> ID：15665783
> 
> 赞同：6
> 
> 时间：2013-03-27T17:45:10.627
> 
> 标签：java, hibernate

我在 PostgreSQL 中有一个名为“transaction_response”的简单表。在这个表中，只有两列：transaction_id 和 response_id。

我在那里的数据有两行。两者都具有相同的 transaction_id，但不同的 response_id 值。

我创建了以下 Java 类来保存这些数据：

```
public class TransactionResponseDAO implements java.io.Serializable {
    private Integer transactionId;
    private Integer responseId;

    public Integer getTransactionId() {
        return transactionId;
    }

    public void setTransactionId(Integer transactionId) {
        this.transactionId = transactionId;
    }

    public Integer getResponseId() {
        return responseId;
    }

    public void setResponseId(Integer responseId) {
        this.responseId = responseId;
    }

    public String toString() {
        return "Transaction Id: " + transactionId + "\nResponse Id: " + responseId;
    }
} 
```

然后我创建了名为“TransactionResponse.hbm.xml”的 Hibernate 配置文件：

```
<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<hibernate-mapping>
    <class name="com.data.TransactionResponseDAO" table="transaction_response">
        <id name="transactionId" column="transaction_id" type="java.lang.Integer">
            <generator class="increment"/>
        </id>

        <property name="responseId" type="java.lang.Integer">
            <column name="responses_id" />
        </property>

    </class>

    <query name="findTransactionResponseByTransactionId">
        <![CDATA[from com.data.TransactionResponseDAO where transaction_id = :transactionId]]>
    </query>

    <query name="findTransactionResponseByBothIds">
        <![CDATA[from com.data.TransactionResponseDAO where transaction_id = :transactionId 
                 and responses_id = :responseId]]>
    </query>
</hibernate-mapping> 
```

在我正在测试的 Java 类中，我有以下代码：

```
Query q = null;
        SessionFactory sFactory = new Configuration().configure("/conf/hibernate.cfg.xml").buildSessionFactory();
        Session session = null;

        try {
            session = sFactory.openSession();
            q = session.getNamedQuery("findTransactionResponseByTransactionId");
            q.setInteger("transactionId", transactionId);
        }catch (Exception e) {
            System.err.println("Error running getStatusTab");
            e.printStackTrace();

            session.close();
            sFactory.close();
        }

        ArrayList<TransactionResponseDAO> results = (ArrayList<TransactionResponseDAO>) q.list();

        session.close();
        sFactory.close();

        System.out.println(">>> Size: " + results.size());

        for (TransactionResponseDAO tr : results) {
            System.out.println(tr);
            System.out.println();
        } 
```

当我运行此代码时，它会返回两行，因为它应该。但是，当打印出这些值时......两行的 response_id 是相同的。因此，出于某种原因，它似乎没有引入第二个 response_id 值。

这是什么原因？一如既往，我感谢您的帮助！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-27T17:54:29.573

问题是hibernate的缓存机制。当 hibernate 获取第一行并创建一个对象时，它会按指示的 id 列 (transactionId) 缓存该对象。当hibernate获取第二行时，它认为与第一行是同一行，因为那些行具有相同的id，从缓存中获取对象（相同的对象）并再次将其放在结果上。

如果列 transactionId 不是唯一的，请不要将其与 id 标签映射。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T18:15:42.287

感谢您的反馈。我所做的是改用 Composite_id 并修复了它。再次感谢！

```
<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<hibernate-mapping>
    <class name="com.data.TransactionResponseDAO" table="transaction_response">
        <composite-id name="primaryKey" class="com.data.TransactionResponsePK">
            <key-property name="transactionId" column="transaction_id" type="java.lang.Integer" />
            <key-property name="responseId" column="responses_id" type="java.lang.Integer" />
        </composite-id>

    </class>

    <query name="findTransactionResponseByTransactionId">
        <![CDATA[from com.data.TransactionResponseDAO tr where tr.primaryKey.transactionId = :transactionId]]>
    </query>

    <query name="findTransactionResponseByBothIds">
        <![CDATA[from com.data.TransactionResponseDAO tr where tr.primaryKey.transactionId = :transactionId 
                 and tr.primaryKey.responseId = :responseId]]>
    </query>
</hibernate-mapping> 
```

# java - 编组 java 代理

> ID：15665787
> 
> 赞同：4
> 
> 时间：2013-03-27T17:45:18.607
> 
> 标签：java, proxy, jaxb

有人可以建议一种编组和解组 javaassyst 代理对象的方法。我想要类似 JAXB 或 xstream 的方法。目前我只看到解决这个问题的一种方法

*   创建承载与代理相同属性的平面类（这是一个问题，因为我有大约 300 个属性）
*   写一些反射来映射属性（或使用类似 DOZER 的东西）（这可能会很慢且效率低下）
*   使用 xstream 序列化对象 使用 mapper 传输代理 -> 平面 -> xml 或 xml -> 平面 -> 代理

这种方法似乎效率低下，有没有人有更好的想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-16T19:54:22.673

如果基类使用 Jackson json 注释进行注释，那么它是代理这一事实不会影响编组。这是一个将代理对象编组为 JSON 的示例。

```
import javassist.util.proxy.MethodHandler;
import javassist.util.proxy.ProxyFactory;
import javassist.util.proxy.ProxyObject;
import org.codehaus.jackson.annotate.JsonProperty;
import org.codehaus.jackson.map.ObjectMapper;

import java.lang.reflect.Method;

public class Main {

    public static void main(String[] args){
        try {
            Bar bar = create(Bar.class);
            bar.setBar("something");
            ObjectMapper mapper = new ObjectMapper();
            String out = mapper.writeValueAsString(bar);
            Bar inBar = mapper.readValue(out, bar.getClass());
            System.out.println("Unmarshalled: " + inBar.getClass().getName() + " , bar: " + inBar.getBar());
        } catch (Exception e) {
            e.printStackTrace();
        }

    }
    public static <T> T create(Class<T> classs) throws Exception {
        ProxyFactory factory = new ProxyFactory();
        factory.setSuperclass(classs);
        Class clazz = factory.createClass();
        MethodHandler handler = new MethodHandler() {

            @Override
            public Object invoke(Object self, Method overridden, Method forwarder,
                                 Object[] args) throws Throwable {
                System.out.println("I could be used for AOP "+overridden.getName());
                return forwarder.invoke(self, args);
            }
        };
        Object instance = clazz.newInstance();
        ((ProxyObject) instance).setHandler(handler);
        return (T) instance;
    }
}

class Bar{
    @JsonProperty
    private String bar = "bar";

    String getBar() {
        return bar;
    }

    void setBar(String bar) {
        this.bar = bar;
    }
} 
```

# c++ - 读取文件的问题

> ID：15665788
> 
> 赞同：0
> 
> 时间：2013-03-27T17:45:19.157
> 
> 标签：c++

我上交了一份我认为是读取文件错误的家庭作业。出于明显的原因，我不想发布我的所有代码。我们正在放春假，几周后我可能会收到教授的反馈。我似乎总是在阅读文件方面遇到困难，所以我想在这周有时间的时候弄清楚一些东西。

该任务的要点是创建一个简单的人员对象，该对象具有一个包含字符串“gift”的 STL 集容器和一个包含名称作为数据成员的字符串。然后，拥有一组这些对象。该程序的第一个方面是读取具有以下格式的文件，其中行中的第一个单词始终是名称，引号之间的内容是礼物创意：

```
Tom     "iphone"
Bill    "guitar"
Bill    "pencils"
Steve   "speaker"
Mary    "tennis racket"
Jenny   "golf balls"
John    "printer"
Bill    "books"
Mary    "books" 
```

打印到屏幕时，格式应为：

```
Bill    books, guitar, pencils
Jenny   golf balls
John    printer
Mary    books, tennis racket
Steve   speaker
Tom     iphone 
```

在视觉工作室，一切都很好。但是，当我使用 gcc 编译和运行时，输出如下所示：

```
, pencilsooks
Jenny   golf balls
John    printer
Mary    books, tennis racket
Steve   speaker
Tom     iphone 
```

休息几天后，查看了我的 readfile 函数，我注意到一些东西很奇怪，而且它不是一个写得很好的函数。也就是说，在 VS 中，当我调试时，一切似乎都正常。当我连接到学校的 linux 服务器以在 gcc 上进行测试时，出现问题，但我不知道如何像在 VS 中那样在 linux 中进行调试（我需要学习的东西）。

无论如何，这是我的 readfile 函数：

```
//library facilities used: fstream, assert
//Postcondition: set of person objects have been created from file
void read_file(const char* file_name, set<person> &list)
{
    ifstream infile;
    infile.open(file_name);
    assert(infile);
    while( infile.good() )
    {
        string tmp_name; //stores name from file
        string tmp_gift; //stores gift from file
        person p_tmp;     //to be added to person_list
        set<person>::iterator people_iter; 

        infile >> tmp_name;//get 1st name in file

        //check to see if it's in the set of people
        if( in_list(tmp_name, list) )
        {
            getline(infile, tmp_gift, '\n'); //get the gift
            strip_punct(tmp_gift);
            add_to_existing(tmp_name, tmp_gift, list);
        }
        else //name is not in list
        {
            p_tmp.set_name(tmp_name);//set the name
            getline(infile, tmp_gift, '\n'); //get the gift
            strip_punct(tmp_gift);// get rid of quotes and other puncts
            p_tmp.insert_gift(tmp_gift);  //insert gift string into set of gifts for that person
            people_iter = list.begin();//add person to list of people
            list.insert(people_iter, p_tmp);    
        }//end else

    }// end while( infile.good() )

    infile.close();

}//end read_file 
```

# sql-server - Azure 数据库安装错误“无效的对象名称‘类别’”

> ID：15665792
> 
> 赞同：0
> 
> 时间：2013-03-27T17:45:24.597
> 
> 标签：sql-server, azure, azure-sql-database, remote-server, invalid-object-name

我对数据库和服务器等完全一无所知。请多多包涵。

我正在尝试安装一个名为 RealProspect 2009 的程序，它允许本地和远程 sql 数据库安装。这两种类型都是使用程序安装 .exe 完成的。

我有一个 azure 帐户，在该帐户上设置了服务器和数据库。在程序安装过程中，我被要求提供 SQL 服务器地址、SQL 服务器名称、SQL 用户名和 SQL 密码。使用 Azure 在线工具中提供的信息，我将所有这些信息输入到字段中，程序开始在远程位置安装数据库。如果我在这些字段中使用了不正确的信息，安装会返回错误并告诉我它无法登录，或者 IP 不被允许等，所以我知道它实际上是在尝试连接并验证连接凭据。

当我使用正确的服务器和登录信息时，程序会继续。它花费了几分钟“创建表格”。完成此操作后，它会尝试开始“安装默认数据（类别）”。此时程序停止，我在这篇文章的主题行中收到错误“无效的对象名称'类别'”

我没有足够的知识来告诉你我对这个过程的不了解。

我刚刚注册了 Azure，因为使用 Azure 托管数据库每月大约 5-10 美元，我希望自己和其他几个参与者能够使用该软件和一个通用数据库。我使用在线 Azure 门户中的 gui“工具/操作方法”创建了服务器和数据库，我从未编写过脚本，也从未使用在线 GUI 以外的任何东西访问服务器/数据库。

提前感谢您提供的任何帮助。我希望我不会对你的一天造成太大的阻碍。

PS - 值得您从 realinvestorsoftware.com 下载该软件的免费试用版，看看是否可以将其安装在远程服务器上。也许你能更好地看到我所看到的并告诉我如何自己做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T20:27:01.600

SQL Azure 与 SQL Server 非常相似，但有[一些特性是 SQL Azure 不支持](http://msdn.microsoft.com/en-us/library/windowsazure/ff394115.aspx)的。也就是说，如果应用程序的安装程序正在使用 SQL Azure 不支持的任何功能，我会感到惊讶。我的猜测是，他们的安装脚本中存在一个错误，可能会在更现代的 SQL Server 版本上失败（注意，他们的应用程序安装在[不再受主流支持的 SQL Express 2005 上](http://support.microsoft.com/lifecycle/search/default.aspx?sort=PN&alpha=SQL+Server+2005+Express&Filter=FilterNO)）。

只是给你一些其他的想法：你得到了在两台机器上安装应用程序的密钥，但是：

> “如果您想在两台以上的计算机上安装，那么在您订购 RealProspect 副本后，您可以在此网站上登录您的客户帐户并订购额外的激活密钥，每台仅需 97 美元。”

因为无论如何你都要支付几百美元，并且因为（你自己承认）你不是数据库专家，所以使用他们每月 27 美元的数据库托管服务可能会减少成本、压力和辛勤工作。这样您就可以在他们负责技术的同时专注于建立您的业务。

> [更新：3/27/2013 @ 23:05] Chris 提出的另一个选择是在本地安装应用程序和数据库，然后将数据库迁移到 Azure。

虽然这可能是可行的，但它需要一些技巧来执行。

[Microsoft 提供了一个数据库迁移指南](http://msdn.microsoft.com/en-us/library/windowsazure/ee730904.aspx)，其中包含几个（漂亮的手动）选项。

您可能还想阅读[这个](http://social.msdn.microsoft.com/Forums/en-US/ssdsgetstarted/thread/c635f2df-89bb-48b5-95ac-e2de7fed95d7)讨论如何通过 DACPack 迁移数据库的线程。

另一种选择是下载并使用[SQL Azure 迁移向导](http://sqlazuremw.codeplex.com/)，它应该为您完成大部分繁重的工作，并使您的数据库迁移更简单。

但是，请注意，应用程序使用的数据库*可能会*使用 SQL Azure 不支持的 SQL Server 功能。希望情况并非如此，但请注意这可能是一个问题。

祝你好运 ：）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T20:25:30.920

克里斯，

我认为 SQL Database Migration Wizard v3.9.10 & v4.0.13 会解决你的问题，我已经使用这个工具多次将 db 从本地机器迁移到 sql azure，这个工具的最大优点是它还突出了错误或 sql 不能'不会迁移到 Azure，因此我们可以轻松找到此类 sql 查询的替代语法

# .net-4.5 - .NET 4.5 准备好在生产系统中使用了吗？

> ID：15665794
> 
> 赞同：1
> 
> 时间：2013-03-27T17:45:36.420
> 
> 标签：.net-4.5, production-environment

在我的搜索过程中，我看到了大量关于 .NET 4 / .NET 4.5 兼容性的主题。我正在接管多个项目的开发，这些项目早在 2004/2005 年就开始了，并且正在使用 .NET 2 - .NET 3 和 3.5。

我可以选择使用 .NET 4.5 - 但我想确保在生产系统中开始使用它是安全的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T17:47:39.413

是的。

它于[2012](http://blogs.msdn.com/b/jasonz/archive/2012/08/15/visual-studio-2012-and-net-framework-4-5-released-to-the-web.aspx)年 8 月 15 日发布。足以让早期采用者对其进行测试。

根据您的项目，您可以做的最好的事情是更改 .NET 版本，将其部署到新服务器并针对它运行所有自动化和手动测试。

# node.js - 在 node.js 中编写一个简单的自动化测试，但同步调用有问题

> ID：15665795
> 
> 赞同：0
> 
> 时间：2013-03-27T17:45:41.653
> 
> 标签：node.js, asynchronous

我正在尝试编写一个自动化脚本来测试我的一些 api 调用这里是一个简单的例子：

```
async.series([
    function(callback){
       func.clean_database()
       callback(null);     
    },
    function(callback){
       func.register_and_auth(users[0])
       callback(null);   
    }
],
function(err, results){
    console.log('done');
}); 
```

干净的数据库看起来很简单：

```
clean_database: function () { 
    var Projects = mongoose.model("Projects", new mongoose.Schema({}));
    Projects.collection.remove(function (err, results) { console.log("Emptied: Projects"); });
    return true;
}, 
```

问题是 register_and_auth(users[0]) 在清理数据库完成之前运行..因此告诉我用户已经注册。我的印象是 async.series 会连续运行这些，即一个接一个。

我怎样才能使回调（null）与我在第一步中运行的函数的完成相关联？

谢谢！

：：：：更新：：：：

如果有人在乎，我必须扩展它并调用更多方法来模拟用户流程，这就是它最终的样子..如果有人想改进这一点，请做

```
async.series([    
  func.clean_database, function(one_callback){
    func.register_and_auth(users[0], function(callback) {
      console.log('-- Starting Create and Upload');
      func.auth_and_create_project_and_upload(users[0], data, function(callback) { 
        console.log('-- Starting Annotations');
        func.auth_open_project_add_annotations_to_all_pages(users[0], annotation, function(callback) { 
          console.log('-- Done with User 0.');
          one_callback();
        });
      });
    });
  },
  function(two_callback) {
    func.register_and_auth(users[1], function(callback) {
      console.log('-- Starting Create and Upload');
      func.auth_and_create_project_and_upload(users[1], data, function(callback) { 
        console.log('-- Starting Annotations');
        func.auth_open_project_add_annotations_to_all_pages(users[1], annotation, function(callback) { 
            console.log('-- Done with User 1.');
            two_callback();
          });
        });
      });
    },
  ],
  function(err, results){
  console.log('Load test complete for two users.');   
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T17:49:57.130

您需要传入回调并在任务完成时调用它们

```
async.series([
    func.clean_database,
    function(callback){
       func.register_and_auth(users[0], callback);
    }
],
function(err, results){
    console.log('done');
});

clean_database: function (callback) { 
    var Projects = mongoose.model("Projects", new mongoose.Schema({}));
    Projects.collection.remove(function (err, results) { 
      console.log("Emptied: Projects"); 
      callback(err, results);
    });
    return true;
}, 
```

# python - Python，对象获取新的值

> ID：15665801
> 
> 赞同：2
> 
> 时间：2013-03-27T17:45:53.123
> 
> 标签：python, oop

我有以下代码：

```
import math

class h:
    vektor = [0,0]
    rel_chyba = 0

    def __init__(self, hodnota, chyba):
        self.vektor[0] = hodnota
        self.vektor[1] = chyba
        self.rel_chyba = chyba*1.0/hodnota

    def __rmul__(self, hod2):
        return h(hod2.vektor[0]*self.vektor[0],  math.sqrt(self.rel_chyba*self.rel_chyba+hod2.rel_chyba*hod2.rel_chyba))

v = h(12,1)
print v.vektor[1]
t = h(25,2)
print v.vektor[1] 
```

我的问题是， v.vektor[1] 第一次打印 1 ，第二次打印 2 。对象 v 的所有属性都被分配了来自 t 的属性值。

如何创建两个不同的对象？感谢您的回答

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T17:48:05.213

不要`vektor`在类级别声明，这使其成为类变量。只需在里面声明它`__init__`：

```
def __init__(self, hodnota, chyba):
    self.vektor = [hodnota, chyba] 
```

# php - xDebug 在 context_get 停止

> ID：15665803
> 
> 赞同：0
> 
> 时间：2013-03-27T17:45:56.780
> 
> 标签：php, debugging, xdebug

我正在尝试使用`xdebug`and`xdebug_break()`方法调试我的 PHP 脚本。它开始工作，我的 IDE ( *PHPDesigner* ) 在休息时正常停止，但立即停止。阅读`debug.remote_logs`文件我可以检查最后一行是：

```
<- context_get -i 429 -c 0 
```

之后，我没有收到关于 GET 数据的 XML 数据的返回。所以我想问题存在，但我该如何解决呢？

我的 php.ini xdebug 配置是：

```
[xdebug]
  xdebug.remote_mode=jit
  xdebug.remote_enable=1
  xdebug.remote_host=127.0.0.1
  xdebug.remote_port=9000
  xdebug.remote_handler=dbgp
  xdebug.remote_log=C:\Wamp\logs\xdebug.log
  xdebug.idekey=xdebug 
```

我也尝试使用 XDBG，它抛出异常并停止工作。该`remote_logs`文件显示同样的失败。使用`php_xdebug-2.2.0-5.4-vc9.dll`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T17:45:56.780

在发布之前，我检查了 xDebug 的最新版本，它是`php_xdebug-2.2.2-5.4-vc9.dll`（差异：旧 2.2.0，新 2.2.2）。更新解决了我的问题，现在一切正常。耶！

# c - 如何从网站获取单词的定义？

> ID：15665806
> 
> 赞同：-6
> 
> 时间：2013-03-27T17:46:04.610
> 
> 标签：c

从网站动态提取数据的正确方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T17:54:07.933

您可以使用类似的网络服务[`Big Huge Thesaurus`](http://words.bighugelabs.com/api.php)

*   您可以使用[`libcurl`](http://curl.haxx.se/libcurl/).
*   应该有大量可用于解析的库[`JSON`](http://www.json.org/)。
*   对于 XML，[`Expat`](http://expat.sourceforge.net/)并且[`libxml`](http://www.xmlsoft.org/)是流行的。

# c# - 为什么处理 SqlCeConnection 既解决了一个异常又引发了另一个异常？

> ID：15665807
> 
> 赞同：3
> 
> 时间：2013-03-27T17:46:04.953
> 
> 标签：c#, compact-framework, sql-server-ce, windows-ce

在应用程序会话中两次调用相同的查询方法时，我得到“DBCommandExcept”

作为一个实验，我决定在方法结束时处理连接对象，看看这是否是问题所在。

我不再得到 DBCommandExcept 错误消息，而是得到“连接字符串属性尚未初始化”。

IOW，目前有点像第 22 条军规。相关代码是：

```
string query = "SELECT Bla FROM Blah";
SqlCeCommand cmd = new SqlCeCommand(query);
cmd.CommandType = CommandType.Text;
SqlCeConnection conn = dbconn.GetConnection(); 
cmd.CommandType = CommandType.Text;//probably unnecessary
cmd.Connection = conn; 

SqlCeDataReader myReader = cmd.ExecuteReader(CommandBehavior.SingleRow);
try
{
    if (myReader.Read())
    {
        itemID = myReader.GetString(ITEMID_INDEX);
        packSize = myReader.GetString(PACKSIZE_INDEX);
        recordFound = true;
    }
}
catch (Exception ex)
{
    RRDR.LogMsgs.Append(string.Format("Exception in PopulateControlsIfVendorItemsFound(): {0}", ex.Message));
}
finally
{
    myReader.Close();
    //if (null != conn)
    //{
    //  conn.Dispose();
    //}
} 
```

// Re: 上面注释掉的块：当它处于活动状态时，没有看到DBCommandExcept问题；但是，然后我得到“连接字符串属性尚未初始化”

我认为上面唯一的非 SQL-CE 标准位是 dbConn.GetConnection()。这是其中的一些代码：

```
SqlCeConnection objCon = null; 

. . .

public SqlCeConnection GetConnection()
{
    return objCon;
}

private DBConnection() // class constructor
{
    try
    {
        . . .
        objCon = new SqlCeConnection(conStr);
        objCon.Open();
        . . . 
```

同样，在应用程序的一次运行期间，仅通过此方法*第二次*看到错误（任何一个，无论我“选择”拥有哪个） 。第一次工作正常。

## 更新

我添加了下面的代码，评论讲述了悲惨的故事：

```
// With conn check only, still get two consecutive DBCommandExcepts
// With cmd check only, still get two consecutive DBCommandExcepts
// With both, still get two consecutive DBCommandExcepts; IOW, all have the same effect
if (null != conn)
{
    conn.Close();
}
if (null != cmd)
{
    cmd.Dispose();
} 
```

## 更新 2

根据 unicron 的建议，我尝试使用“使用”。

在这三种情况中的两种（SqlCeCommand 和 SqlCeDataReader）中，转换为“使用”没有差异；在另一个（SqlCeConnection）中，它引发了错误消息，“ *ConnectionString 属性尚未初始化。* ”

尽管如此，这两种用法的代码还是更简洁，因此感谢您在最佳实践方向上的推动。

这是它现在的样子：

```
private bool PopulateControlsIfPlatypusItemsFound()
{
    const int ITEMID_INDEX = 0;
    const int PACKSIZE_INDEX = 1;
    bool recordFound = false;

    try
    {
        string PlatypusId = txtPlatypus.Text.ToString().Trim();
        string PlatypusItemId = txtUPC.Text.ToString().Trim();
        string itemID = string.Empty;
        string packSize = string.Empty;

        string query = string.Format("SELECT ItemID, PackSize FROM PlatypusItems WHERE PlatypusID = {0} AND PlatypusItemID = {1}", PlatypusId, PlatypusItemId);
        using (SqlCeCommand cmd = new SqlCeCommand(query))
        {
            cmd.CommandType = CommandType.Text;
            SqlCeConnection conn = dbconn.GetConnection(); 
            if ((null != conn) && (!conn.State.Equals(ConnectionState.Open)))
            {
                conn.Open();
                TTBT.LogMsgs.Append("Connection opened");
            }
            cmd.CommandType = CommandType.Text;//probably unnecessary
            cmd.Connection = conn;

            using (SqlCeDataReader myReader = cmd.ExecuteReader(CommandBehavior.SingleRow))
            {
                if (myReader.Read())
                {
                    itemID = myReader.GetString(ITEMID_INDEX);
                    packSize = myReader.GetString(PACKSIZE_INDEX);
                    recordFound = true;
                }
            }

            txtID.Text = itemID;
            txtSize.Text = packSize;
            return recordFound;
        }
    }
    catch (Exception ex)
    {
        TTBT.LogMsgs.Append(string.Format("Exception in PopulateControlsIfPlatypusItemsFound: {0} - {1}\r\n", ex.Message, ex.InnerException));
        return recordFound;
    }
} 
```

## 更新 3

通过用通用排序替换自定义连接代码，我已经更接近常态，添加另一个“使用”到组合中：

```
private bool PopulateControlsIfVendorItemsFound()
{
    const int ITEMID_INDEX = 0;
    const int PACKSIZE_INDEX = 1;
    bool recordFound = false;

    DUCKBILL.LogMsgs.Append("Made it into frmEntry.PopulateControlsIfVendorItemsFound()\r\n");

    try
    {
        string vendorId = txtVendor.Text.ToString().Trim();
        string vendorItemId = txtUPC.Text.ToString().Trim();
        string itemID = string.Empty;
        string packSize = string.Empty;

        if ( dbconn.isValidTable( "VendorItems" ) == -1 )
        {
            DUCKBILL.LogMsgs.Append("VendorItems not a valid table");//do not see this msg; good! VendorItems is seen as valid...
            return false;
        }

        string query = string.Format("SELECT ItemID, PackSize FROM VendorItems WHERE VendorID = {0} AND VendorItemID = {1}", vendorId, vendorItemId);
    using (SqlCeCommand cmd = new SqlCeCommand(query))
    {
        cmd.CommandType = CommandType.Text;
        using (SqlCeConnection conn = new SqlCeConnection())
        {
            string filename = "\\badPlace2B\\CCRDB.SDF";
            conn.ConnectionString = string.Format("Data Source = {0}", filename);
            cmd.CommandType = CommandType.Text;//probably unnecessary/moot
            cmd.Connection = conn; 
            conn.Open();

            using (SqlCeDataReader myReader = cmd.ExecuteReader(CommandBehavior.SingleRow))
            {
                if (myReader.Read())
                {
                    itemID = myReader.GetString(ITEMID_INDEX);
                    packSize = myReader.GetString(PACKSIZE_INDEX);
                    recordFound = true;
                }
            }
        }

        txtID.Text = itemID;
        txtSize.Text = packSize;
        return recordFound;
    }
    }
    catch (Exception ex)
    {
        DUCKBILL.LogMsgs.Append(string.Format("Exception in PopulateControlsIfVendorItemsFound: {0} - {1}\r\n", ex.Message, ex.InnerException));
        return recordFound;
    }
} 
```

...但我仍然得到“DBCommandExcept”...

至于“停止打开连接”，是不是必须这样做？上面的代码怎么可能/应该有所不同？

## 更新 4

更奇怪的是，现在我的调试日志文件已经停止写入了。我一直在全局异常处理程序和主窗体的 Closed event() 中写出它，并且它总是（直到现在）至少有几个条目，但在代码的最后几次更新中，它不是写多了……？？？

两个地方都是全局异常处理程序和主窗体的 Closed event()，代码是这样的：

```
public static bool inDebugMode = true;

. . .
if (CCR.inDebugMode)
{
    DateTime dt = DateTime.Now;
    string timeAsStr = string.Format("{0}_{1}_{2}_{3}.txt", dt.Hour, dt.Minute, dt.Second, dt.Millisecond);
    using (StreamWriter file = new StreamWriter(timeAsStr))
    {
        // If the app closes normally, this is how the file is written; if it doesn't, 
        // (it crashed) it's written in PDAClient.ExceptionHandler()
        file.WriteLine(SSCS.LogMsgs.ToString());
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T14:10:35.603

由于您对数据库文件进行了多次调用（不会更改），因此我首先将您的连接字符串和您的类顶部的 SQL 语句定义为全局值：

```
private const int ITEMID_INDEX = 0;
private const int PACKSIZE_INDEX = 1;
private const string SQL_CONN_STR = "Data Source=\\badPlace2B\\CCRDB.SDF";
private const string SQL_GET_VENDOR_ITEMS = "SELECT ItemID, PackSize " + 
  "FROM VendorItems " +
  "WHERE VendorID=@VendorID AND VendorItemID=@VendorItemID"; 
```

这些永远不会改变，因此每次调用例程时都没有理由再次定义它们。

就个人而言，我不喜欢向 SQL 语句中插入值，就像您所展示的那样。相反，尝试使用参数。

要使用参数，您需要查看数据库以查看列的类型`VendorID`和类型`VendorItemID`。我的猜测是它们都是**int**值，但它们可能是类似**GUID**的值，需要`VarChar`类型字符串。如果这些是字符串，您应该记下这些列定义的大小。

**例如：**下面，我的`Serial_Number`列是`SqlDbType.NVarChar`，大小是 50。`SqlCeParameter`这个列的一个是：

```
cmd.Parameters.Add("@Serial_Number", SqlDbType.NVarChar, 50).Value = txtSerial_Number.Text.Trim(); 
```

![数据库表定义](../Images/e5a4741cf7350b844585cd70b81ea2d2.png)

由于我不知道您使用的是什么类型的数据，所以我创建了一个枚举类型来显示如何使用每种方法。如果您无法访问表的设计，最后的手段是“AddWithValue”（我个人讨厌那个，因为它让我看起来不知道我的数据库里面有什么）。

```
enum ParamStyle { AddWithValue, AddIntegers, AddVarChar } 
```

为了使用这种枚举类型，我修改了方法的签名以传入该值：

```
private bool PopulateControlsIfVendorItemsFound(ParamStyle style) { 
```

显然，您不需要这个，因为您应该知道您将使用什么技术进行编码。

我无法弄清楚你的`dbconn`对象是什么。最初，我以为这是你的`SqlCeConnection`，但它没有`isValidTable`方法，所以我只是将其注释掉：

```
 //if (dbconn.isValidTable("VendorItems") == -1) {
  //  DUCKBILL.LogMsgs.Append("VendorItems not a valid table");//do not see this msg; good! VendorItems is seen as valid...
  //  return false;
  //} 
```

说到`SqlCeConnection`...

我将您的`SqlCeCommand`实例与您的`SqlCeConnection`实例结合在一起。更少的代码通常意味着更少的错误：

```
 using (var cmd = new SqlCeCommand(SQL_GET_VENDOR_ITEMS, new SqlCeConnection(SQL_CONN_STR))) { 
```

，`CommandType`默认情况下，是`CommandType.Text`，所以这行是不必要的：

```
 // cmd.CommandType = CommandType.Text; (this is the default) 
```

我将您的大部分变量读取移到了`try/catch`例程之外，因为这些都不会导致生成异常。

另外，我使用了更有针对性`SqlCeException`的而不是通用的`Exception`. 块中唯一可能失败的是`SqlCe`相关的东西，它`SqlCeException`会给你比一般`Exception`对象更好/更具体的错误消息。

```
 } catch (SqlCeException err) { 
```

那么，它看起来像什么？

## 代码：

```
enum ParamStyle { AddWithValue, AddIntegers, AddVarChar }
private const int ITEMID_INDEX = 0;
private const int PACKSIZE_INDEX = 1;
private const string SQL_CONN_STR = "Data Source=\\badPlace2B\\CCRDB.SDF";
private const string SQL_GET_VENDOR_ITEMS = "SELECT ItemID, PackSize FROM VendorItems WHERE VendorID=@VendorID AND VendorItemID=@VendorItemID";

private bool PopulateControlsIfVendorItemsFound(ParamStyle style) {
  bool recordFound = false;

  //DUCKBILL.LogMsgs.Append("Made it into frmEntry.PopulateControlsIfVendorItemsFound()\r\n");
  string itemID = null;
  string packSize = null;
  //string vendorId = txtVendor.Text.Trim();
  //string vendorItemId = txtUPC.Text.Trim();
  //string query = string.Format("SELECT ItemID, PackSize FROM VendorItems WHERE VendorID = {0} AND VendorItemID = {1}", vendorId, vendorItemId);

  //if (dbconn.isValidTable("VendorItems") == -1) {
  //  DUCKBILL.LogMsgs.Append("VendorItems not a valid table");//do not see this msg; good! VendorItems is seen as valid...
  //  return false;
  //}
  using (var cmd = new SqlCeCommand(SQL_GET_VENDOR_ITEMS, new SqlCeConnection(SQL_CONN_STR))) {
    // cmd.CommandType = CommandType.Text; (this is the default)
    if (style == ParamStyle.AddIntegers) { // Adding Integers:
      cmd.Parameters.Add("@VendorID", SqlDbType.Int).Value = Convert.ToInt32(txtVendor.Text.Trim());
      cmd.Parameters.Add("@VendorItemID", SqlDbType.Int).Value = Convert.ToInt32(txtUPC.Text.Trim());
    } else if (style == ParamStyle.AddVarChar) { // Adding String Values
      // NOTE: Here, you should look in your database table and
      // use the size you defined for your VendorID and VendorItemID columns.
      cmd.Parameters.Add("@VendorID", SqlDbType.VarChar, 25).Value = txtVendor.Text.Trim();
      cmd.Parameters.Add("@VendorItemID", SqlDbType.VarChar, 50).Value = txtUPC.Text.Trim();
    } else if (style == ParamStyle.AddWithValue) { // Adding as Objects (only if you don't know what the data types are)
      cmd.Parameters.AddWithValue("@VendorID", txtVendor.Text.Trim());
      cmd.Parameters.AddWithValue("@VendorItemID", txtUPC.Text.Trim());
    }
    try {
      cmd.Connection.Open();
      using (var myReader = cmd.ExecuteReader(CommandBehavior.SingleRow)) {
        if (myReader.Read()) {
          itemID = myReader.GetString(ITEMID_INDEX);
          packSize = myReader.GetString(PACKSIZE_INDEX);
          recordFound = true;
        }
      }
    } catch (SqlCeException err) {
      //DUCKBILL.LogMsgs.Append(string.Format("Exception in PopulateControlsIfVendorItemsFound: {0}\r\n", err.Message));
      // (I never return from a 'catch' statement) return recordFound;
    } finally {
      if (cmd.Connection.State == ConnectionState.Open) {
        cmd.Connection.Close();
      }
    }
  }
  if (recordFound) { // set these last, and set them OUTSIDE of the try/catch block
    txtID.Text = itemID;
    txtSize.Text = packSize;
  }
  return recordFound;
} 
```

## 快乐编码！

# java - Rhino 在 Java 中设置 NativeObject 属性

> ID：15665808
> 
> 赞同：2
> 
> 时间：2013-03-27T17:46:06.940
> 
> 标签：java, rhino

我有一个 javascript 脚本，它在评估时返回一个 NativeObject

```
obj = context.evaluateString(scope,"({age:3, name:'bob'})", "<source">, 1, null) 
```

然后我将 obj 转换为 NativeObject 或 Map 然后运行 ​​put 方法

```
castObj.put("surname","smith") 
```

我得到一个 java.lang.UnsupportedOperationException 抛出。还有另一种方法可以更改对象值吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-27T18:02:35.407

您应该调用`NativeObject.put(String, Scriptable, Object)`版本，而不是从接口`put(String, Object)`继承：`Map`

```
public class AddPropertyToObject {
    public static void main(String[] args) {
        new ContextFactory().call(new ContextAction(){

            @Override
            public Object run(Context ctx) {
                Scriptable scope = ctx.initStandardObjects();
                try {
                    Scriptable entity = ctx.newObject(scope);

                    NativeObject result = (NativeObject) ctx.evaluateString(
                        scope,
                        "({age:3, name:'bob'})",
                        "<inline>", 1, null);

                    result.put("surname", result, "Smith");

                    for (Entry<Object, Object> p : result.entrySet()) {
                        System.out.println(p.getKey() + ": " + p.getValue());
                    }

                } catch (Exception e) {
                    e.printStackTrace(System.err);
                }
                return null;
            }
        });   
    }
} 
```

# c# - 更新数据网格视图

> ID：15665809
> 
> 赞同：-2
> 
> 时间：2013-03-27T17:46:14.203
> 
> 标签：c#, winforms, datagridview, updates

我有 2 个表格，不知道如何更新 datagridview，如果有人可以简单地指导我。表格1如下：

```
public partial class frmBooking : Form
{
    //instance of sqlConnection created           
    SqlConnection con = new SqlConnection("Data Source=....");

    public frmBooking()
    {
        InitializeComponent();

        //sets the  time selecter to a time format and selects the hours and mins only in 24 hour format.
        TimeOfBooking.CustomFormat = "HH:mm";
        TimeOfBooking.Format = System.Windows.Forms.DateTimePickerFormat.Custom;

        //combo box get data from database and updates when new customer is added 
        try
        {
            con.Open();
        }
        catch (SqlException ex)
        {
            MessageBox.Show(ex.Message, Application.ProductName, MessageBoxButtons.OK, MessageBoxIcon.Error);
            Application.Exit();
        }

        NameOfCustomer.Items.Clear();

        SqlCommand cm = new SqlCommand("SELECT GroupName FROM Customer ORDER BY GroupName ASC", con);

        try
        {
            SqlDataReader dr = cm.ExecuteReader();

            while (dr.Read())
            {
                NameOfCustomer.Items.Add(dr["GroupName"]);
            }

            dr.Close();
            dr.Dispose();
        }
        catch (Exception ex)
        {
            MessageBox.Show(ex.Message, Application.ProductName, MessageBoxButtons.OK, MessageBoxIcon.Error);

        }

        //ends here
    }

      //sets the facility name so its copied from the previous(facility to be booked) form into the Facility text box
    public void setFacility(string new_facility)
    {
        Facility.Text = new_facility;
    }

    //sets the date so its copied from the previous(facility to be booked) form into the date text box
    public void setDate(string new_date)
    {
        Date.Text = new_date;
    }

    //adding a new customer button, redirects user to the add customer page
    private void btnAddCust_Click(object sender, EventArgs e)
    {
        frmNewCustomer newCust = new frmNewCustomer();
        newCust.Show();
        this.Close();
    }

    //cancel button will redirect the user to the main page
    private void btnCancel_Click(object sender, EventArgs e)
    {
        Form3 frm3 = new Form3();
        frm3.Show();
        this.Close();
    }

    private void frmBooking_Load(object sender, EventArgs e)
    {
        // TODO: This line of code loads data into the 'usersDataSet.Customer' table. You can move, or remove it, as needed.
        this.customerTableAdapter.Fill(this.usersDataSet.Customer);
        // TODO: This line of code loads data into the 'usersDataSet.Customer' table. You can move, or remove it, as needed.
        this.customerTableAdapter.Fill(this.usersDataSet.Customer);
        // TODO: This line of code loads data into the 'usersDataSet.Customer' table. You can move, or remove it, as needed.
        this.customerTableAdapter.Fill(this.usersDataSet.Customer);

    }

    private void lblBookingForm_Click(object sender, EventArgs e)
    {

    }

    private void btnConfirm_Click(object sender, EventArgs e)
    {

        //validation - if any of the mandotory fields are empty an error message will apear next to the text box
        if (Facility.Text == "")
        {
            //MessageBox.Show("Please enter valid Facility, Date, Name Of Customer, Time Of Booking and Hours");
            errorFacility.SetError(Facility, "Enter A Facility To Book");
        }
        else if (Date.Text == "")
        {
            errorDate.SetError(Date, "Enter A Valid Date");
        }
        else if (NameOfCustomer.Text == "")
        {
            errorCust.SetError(NameOfCustomer, "Enter A Customer To Book");
        }
        else if (TimeOfBooking.Text == "")
        {
            errorTime.SetError(TimeOfBooking, "Enter A Time To Book");
        }
        else if (Hours.Text == "")
        {
            errorHours.SetError(Hours, "Enter The Hours To Book");
        }

        //so if there isnt no error in the fields itll go on and add the data in to the database.
        else
        {

        //instance of sqlConnection            
        SqlConnection con = new SqlConnection("Data Source=...");

        //instance of sqlCommand
        String query =
            "INSERT INTO [Booking] values ('"
            + Facility.Text
            + "', '" + Date.Text
            + "', '" + NameOfCustomer.Text
            + "', '" + TimeOfBooking.Text
            + "', '" + Hours.Text
            + "', '" + Paid.Text
            + "', '" + Notes.Text
            + "')";

        SqlCommand cmd = new SqlCommand(query, con);
        con.Open();
        cmd.ExecuteNonQuery();

        //query executed correcty or not
        con.Close();

           MessageBox.Show("Sucessfully Booked");

           Form3 mainPage = new Form3();
           mainPage.Show();
           this.Close();
        } 
    }
    }} 
```

这是我用来添加预订的表格。我拥有的第二种表格是带有datagridview的表格，我想在预订时更新它的代码如下：

```
 public partial class frmViewBookings : Form
        {
            public frmViewBookings()
            {
                InitializeComponent();
            }

            private void btnClose_Click(object sender, EventArgs e)
            {
                Form3 mainpage = new Form3();
                mainpage.Show();
                this.Close();
            }

            private void frmViewBookings_Load(object sender, EventArgs e)
            {
                // TODO: This line of code loads data into the 'usersDataSet1.Booking' table. You can move, or remove it, as needed.
                this.bookingTableAdapter.Fill(this.usersDataSet1.Booking);

            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T22:01:27.137

要在数据网格上显示数据，您必须首先设置它的数据源，您可以这样做

`datagridview1.Datasource = this.usersDataSet1.Booking.DefaultView`

每当您想刷新它时，您只需再次填充您的 tableadapter 并将您的 gridview 的数据源设置为它。

（创建一个单独的方法来加载datagridview）

# asp.net-ajax - Autocompleteextender 在 .net 目标框架 3.5 中不起作用

> ID：15665810
> 
> 赞同：0
> 
> 时间：2013-03-27T17:46:31.767
> 
> 标签：asp.net-ajax, autocompleteextender

我正在尝试在我的网站中实现一个 autocompleteextender ajax 控件，但它根本不起作用。这个你能帮我吗 。这是下面的代码示例。

ASPX：

```
 <cc3:ToolkitScriptManager ID="ToolkitScriptManager1" runat="server">     
</cc3:ToolkitScriptManager>    
<asp:TextBox ID="txtContactsSearch" runat="server" ></asp:TextBox>
<cc3:AutoCompleteExtender ServiceMethod="getrclass"
servicepath="RClassAutoComplete.asmx"    
MinimumPrefixLength="2"    
CompletionInterval="100" EnableCaching="true" CompletionSetCount="10"   
TargetControlID="txtContactsSearch"
ID="AutoCompleteExtender1" runat="server" 
UseContextKey="True">
</cc3:AutoCompleteExtender> 
```

背后的代码

```
<System.Web.Services.WebService(Namespace:="http://tempuri.org/")> _ 
```

_ _ 公共类 RClassAutoComplete 继承 System.Web.Services.WebService _ 公共函数 getrclass(ByVal PrefixText As String, ByVal count As Integer) As String() Dim items() As String items(0) = "one" items(1) =“oneeee”项目（2）=“onedsgf”项目（3）=“onettgdfsg”项目（4）=“onedgdfgbvc”项目（5）=“onerytretgfdsg”项目（6）=“onergesrfgdf”

```
 Return items

End Function 
```

请让我知道我在这里犯了什么错误

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-10T20:48:37.750

对我有用的是在主文件的正文中为脚本管理器添加一个标签。

```
<%@ Register Assembly="AjaxControlToolkit" Namespace="AjaxControlToolkit" TagPrefix="AjaxControlToolkit" %>

...

<AjaxControlToolkit:ToolkitScriptManager ID="ScriptManager1" runat="server" EnablePageMethods="true">
    <Services>
            <asp:ServiceReference Path="~/Ajax_methods.asmx" />
    </Services>
</AjaxControlToolkit:ToolkitScriptManager> 
```

然后在使用所述母版页的某些页面文件中，您将扩展程序附加到字段

```
<asp:UpdatePanel ID="customerAddress" runat="server">
<AjaxControlToolkit:AutoCompleteExtender ID="aceCustName" runat="server" DelimiterCharacters="" Enabled="True"
        TargetControlID="txtCustomerName" ServicePath="~/Ajax_methods.asmx" ServiceMethod="GetCompletionList"
        MinimumPrefixLength="1" CompletionSetCount="20" ContextKey="test" UseContextKey="True" /> 
```

在我的 Ajax_methods.asmx 中，我有以下代码。

```
<%@ WebService Language="C#" CodeBehind="~/App_Code/Ajax_methods.cs" Class="Ajax_methods" Debug="true"%> 
```

最后在 Ajax_methods.cs 我有

```
[System.Web.Services.WebMethod]
[System.Web.Script.Services.ScriptMethod]
public string[] GetCompletionList(string prefixText, int count, string contextKey) 
```

在所有的小部件都到位之前，它对我不起作用。

# ruby-on-rails - ActiveAdmin 选择所有批处理操作

> ID：15665811
> 
> 赞同：0
> 
> 时间：2013-03-27T17:46:33.333
> 
> 标签：ruby-on-rails, activeadmin

嘿伙计们，我想在活动管理员中执行批处理操作，我已将以下设置为 true

```
config.batch_actions = true 
```

在 active_admin.rb

还在索引块中模型的活动管理员生成文件下添加了 selectable_column。

当我单击最顶部的复选框以全选时，没有任何反应。它只检查一个复选框。请让我知道一个解决方案！谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T20:42:42.050

确保使用来自 github 的最新版本的 ActiveAdmin。此[问题](https://github.com/gregbell/active_admin/issues/2027)已修复，但尚未发布版本。

`gem 'activeadmin', github: 'gregbell/active_admin'`

# javascript - Backbone 和 RequireJS 有效加载

> ID：15665819
> 
> 赞同：8
> 
> 时间：2013-03-27T17:47:00.760
> 
> 标签：javascript, backbone.js, requirejs, amd, js-amd

我在互联网上查看了许多如何使用 requireJS 开始开发 BB 应用程序的示例，但我有点迷茫。

我认为 AMD 的目标是仅在确实需要时才加载文件。不早了。

为什么我只看到开发人员将几乎每个文件作为依赖项放在他/她的主文件开头的示例？

这是一个示例： [https ://github.com/jcreamer898/RequireJS-Backbone-Starter/tree/master/js](https://github.com/jcreamer898/RequireJS-Backbone-Starter/tree/master/js)

这个应用程序立即加载 main.js，它依赖于 app.js，它加载 routers/home.js，它需要 views/view.js，它加载视图的模板和 models/model.js，它......并结束。

我看不到如何扩展此应用程序，例如使用更多视图，其中视图的依赖项（其模型、模板、集合、第三方 API 等）仅在路由器调用并初始化它们时才加载。否则，在初始化应用程序时在加载所有文件的地方使用 AMD 将是无稽之谈。

类似的例子在这里： [http](http://backbonetutorials.com/organizing-backbone-using-modules/) : //backbonetutorials.com/organizing-backbone-using-modules/ 查看 router.js 文件。实际上它加载了 'views/projects/list' 和 'views/users/list' 依赖关系，而路由器没有知道用户将来是否需要它们。

请指教，提前谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-27T18:01:25.643

在这么小的示例应用程序中很难看到，因为您必须在初始路由上加载一些*东西，而在 Backbone 中加载**一些东西*通常意味着模型、集合和视图。由于您链接的示例只有一个，所以是的，您正在加载几乎所有内容。

您开始看到“按需”功能的地方是您添加其他路线/视图/模型/等的地方。但是请记住，按需加载可能是 AMD/RequireJS 的次要目标。主要目标是[模块化](http://www.requirejs.org/docs/whyamd.html)。然后，它们为您提供了许多选项，可以按需加载内容，也可以通过[优化器将所有内容捆绑在一起](http://www.requirejs.org/docs/optimization.html)

也没有任何内容表明您必须将所有 require() 放在文件的开头。您可以稍后再做（例如，在启动路线时）。这是第一个链接示例中 home.js 的修改版本。如果您使用的是 Chrome 开发工具，则可以在“调试器”时查看网络选项卡；语句暂停执行。然后继续执行并查看其余脚本是如何加载的。

```
define([
    'jquery', 
    'backbone', 
    'underscore'
    ], 
function($, Backbone, _){
    var Router = Backbone.Router.extend({
        initialize: function(){
            Backbone.history.start();
        },
        routes: {
            '': 'home'
        },
        'home': function(){
            debugger;
            require(['views/view'], function (mainView) {
                mainView.render();
            });
        }
    });

    return Router;
}); 
```

请参阅[此人的文章](http://www.henriquebarroso.com/creating-a-dynamic-modular-multi-page-app-with-backbone-js-and-requirejs/)以了解更多背景信息以及下一步您可能会去哪里。

# regex - 如何使用 Moose 类型作为正则表达式匹配表达式？

> ID：15665821
> 
> 赞同：1
> 
> 时间：2013-03-27T17:47:23.053
> 
> 标签：regex, perl, moose

我的类文件中有以下类型：

```
has 'cardNumber' => (is => 'ro', isa => 'Int', required => 1); 
```

我正在尝试执行以下操作：

```
foreach $_ (@accountsInfo) {
      if ($_ =~ m/^$self->cardNumber()/) {
            $self->pushing(split(/,/, $_));
            $self->invokeAccount();
      }
 } 
```

但我无法让它正确测试。如果我在正则表达式斜杠中手动输入我要查找的数字，它会完美运行。你能帮我使用 cardNumber 类型吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-27T18:17:21.323

Perl 的插值规则规定，数组 ( `"@foo"`) 和标量 ( `"$bar"`)，以及 (a) 在哈希 ( `"$baz{bar}"`) 或数组 ( `"$foo[1]"`) 中的值查找，以及 (b) 对先前情况的取消引用 ( `"@$foo, $$bar, $baz->{bar}, $foo->[1]"`) 被插值到双引号字符串中。

函数调用和每个扩展方法调用不会被插值。

您可以使用取消引用匿名引用的技巧将任意代码插入字符串。通常，您需要一个数组引用：

```
"foo @{[ expressions; ]} bar"; # interpolating anon hashref 
```

但标量参考也可以工作（它们长 1 个字符）。

```
"foo ${\( expressions; )}" # interpolating anon scalar ref 
```

但是，您应该考虑将要插入的值缓存在标量变量中：

```
my $cardNumber = $self->cardNumber;
for (@accountsInfo) {
  if (/\A\Q$cardNumber\E/) {
    $self->pushing(split /,/);
    $self->invokeAccount();
  }
} 
```

`$_`附加说明：我从该代码片段中删除了不必要的括号和提及。另外，我对字符进行了转义，`$cardNumber`以便它们匹配*字面意思*，并且不被视为正则表达式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T18:02:48.537

打印它以查看您要匹配的内容。你会得到像`SOMECLASS=HASH(0x6bbb48)->foo()`. 一个办法：

```
/^@{[$self->cardNumber()]}/ 
```

# compiler-construction - 如何使用 flex/bison 进行语义检查？

> ID：15665828
> 
> 赞同：4
> 
> 时间：2013-03-27T17:47:41.017
> 
> 标签：compiler-construction, bison, yacc, semantic-analysis, flex-lexer

我在 bison 中创建了一个上下文无关语法，在 flex 中创建了一个扫描仪。现在我还想做一个语义检查，例如，假设输入是这样的：

```
int m=5;
c=c+5; 
```

此输入在语法上是正确的，但使用了一个未声明的变量，即“c”。我怎样才能做这样的语义检查？我应该从哪里开始？我应该用 flex 还是 bison 编写代码？如果有人可以提供帮助，我将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-06-08T01:31:28.173

首先要考虑的是：什么时候我们有足够的信息来进行语义检查？

对于像 C 这样的静态语言，我们可以在解析时使用语法指导规则（例如在 Yacc 中触发的规则）来执行此语义。

您的解析器需要维护符号表。也就是说，每当您打开一个新的范围，例如新的函数体或语句块时，您必须为该范围创建一个新的符号表对象（并在某个全局解析器变量中保留一个指向该对象的指针作为“当前范围” ）。作用域还有一个指向前一个作用域的指针。当范围关闭时，您将原始范围恢复为“当前范围”。此范围的打开和关闭与处理块构造（如函数或语句体或结构体）的解析器规则相关联。

范围包含变量名称和语义信息之间的关联，例如它是什么类型的符号，以及其他属性（例如类型）。

当您的解析器处理某种声明时，声明的名称被引入到当前符号表中，然后它就被知道了。

所以，快进到我们的问题：如何检查名称是否未定义。这并不难。在某处，您的解析器具有如下规则

```
primary_expression : '(' expression ')'
                   /* ...*/
                   | CONSTANT
                   | IDENT
                   ; 
```

主表达式可以是标识符，例如变量、常量或函数名称。如果规则很严格，如果可以使用就必须定义这些规则，我们可以在这里进行检查。

对于 的动作规则`IDENT`，我们在当前符号表中查找标识符。如果搜索结果一无所获，我们会引发一个错误，即存在未定义的标识符。

伪代码：

```
primary_expression : '(' expression ')'
                   /* ...*/
                   | CONSTANT
                   | IDENT {
                       struct symbol *sym = symbol_lookup(current_scope, $1);
                       if (sym == NULL) {
                         static_error("undeclared identifier %s", $1);
                         $$ = error_node();
                       } else {
                         /* ... */
                       }
                     } 
```

该`symbol_lookup`函数不仅查看当前范围！如果在当前作用域中找不到标识符，它会递归到父作用域，依此类推。范围链中的顶级范围是文件范围。如果在那里找到标识符，则它是某种全局标识符。如果在那里也没有找到它，它是未定义的。我也编了`static_error`；它具有`printf`类似的参数，并添加文件/行号信息，并增加错误计数（这样当解析器完成时，它可以根据错误计数非零来指示失败）。我`error_node`也编了；它是一个函数或宏，它产生某种指示错误的节点（可能只是一个空指针）。您的解析器规则必须产生一些东西并将其存储到`$$`. 对于不存在的标识符，我们可以将一些标记放入树中。

如果您使用 Yacc 在 C 中编写编译器，那么您需要做很多工作来发明所有这些数据结构（如符号表）并编写支持库。

# android - 从应用程序资源保存到 SD 卡的图像编号

> ID：15665830
> 
> 赞同：1
> 
> 时间：2013-03-27T17:47:42.883
> 
> 标签：android, android-gallery, save-image

我的应用程序由天列表视图组成，每天都有其特定图像放置在无限画廊类中，我想做的是：

**将具有序列号的图像从应用程序可绘制资源（无限图库类）保存到 sd 卡**，

我试图获取已保存图像的序列号，如下所示：

第一张图片：Image-1.png。

第二张图片：Image-2.png 。

第三张图片：Image-3.png，

依此类推。

使用：

```
 Random generator = new Random(); 
```

**这将导致：**

**第一个问题**：用随机数保存的图像。

**第二个问题**：它不保存所有图像被用户选择保存到sd卡，它也​​将一些图像保存了两次或三次。

**这是与保存图像相关的代码部分：**

```
 View vi=convertView; 
    final ViewHolder holder; 
    if(convertView==null){ 
        vi = inflater.inflate(R.layout.gallery_items, null); 
        holder=new ViewHolder(); 
        holder.text=(TextView)vi.findViewById(R.id.textView1); 
        holder.image=(ImageView)vi.findViewById(R.id.image); 
        holder.button=(Button)vi.findViewById(R.id.button_save);

 bm = BitmapFactory.decodeResource( mContext.getResources(), images[itemPos]);
         holder.image.setImageBitmap(bm);

        holder.button.setOnClickListener(new OnClickListener() {

  public void onClick(View arg0) {

      String root = Environment.getExternalStorageDirectory().toString();
        File imagesFolder = new File(root + "/Days pictures");    
        imagesFolder.mkdirs();

        Random generator = new Random();
        int n = 1000;
     n = generator.nextInt(n);
     String fname = "Image-"+ n +".png";
     File file = new File (imagesFolder, fname);
     if (file.exists ())
       file.delete (); 
     try {
        FileOutputStream out = new FileOutputStream(file);
        bm.compress(Bitmap.CompressFormat.PNG, 100, out);
        out.flush();
        out.close();

        Toast.makeText(mContext, "Saved", Toast.LENGTH_LONG).show();}   
        catch (Exception e) {
             e.printStackTrace();    
       Toast.makeText(mContext, e.toString(), Toast.LENGTH_SHORT).show();}}});

      vi.setTag(holder);}

    else holder=(ViewHolder)vi.getTag(); 
    holder.text.setText(name[itemPos]); 

    final int stub_id=images[itemPos]; 
    holder.image.setImageResource(stub_id); 

    return vi; } 

private ImageView getImageView() { 

    ImageView i = new ImageView(mContext); 

    return i; } } 
```

谢谢你的帮助 。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:11:30.277

只需使用`for`循环。如果您确定要在 SD 卡上保存多少图像，那么，

```
for(int n=1 ; n <= size ; n++){
String fname = "Image-"+ n +".png";
 // you other stuff here
} 
```

希望这对您有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T09:02:55.880

请原谅随机，如果您想要按顺序排列的图像（如 Pragnani 建议的并且您在上面的评论中批准了）并且假设您的代码是好的，请执行以下操作：

```
 Override
    public void onClick(View arg0) {
        String root = Environment.getExternalStorageDirectory().toString();
        File imagesFolder = new File(root + "/imagesFolder");    
        imagesFolder.mkdirs();

        for (int i = 0; i < 10; i++) { 
            String fname = "Image-" + i + ".png";
            File file = new File (imagesFolder, fname);

            if (file.exists ()) file.delete (); 
            try {
               FileOutputStream out = new FileOutputStream(file);

               bm.compress(Bitmap.CompressFormat.PNG, 100, out);
               out.flush();
               out.close();
               Toast.makeText(MainActivity.this, "Saved", Toast.LENGTH_SHORT).show();
            } catch (Exception e) {
               e.printStackTrace();
               Toast.makeText(MainActivity.this, e.toString(), Toast.LENGTH_SHORT).show();
            }
        }
    } 
```

测试它并告诉我。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T10:34:00.923

从您的问题和评论中，我可以理解您想要将 n 个图像保存到 SDCard。

要保存，请按照以下步骤操作

**第 1 步**：获取您需要的所有图像。确保您在此处正确获取图像列表。

**第 2**步：计算列表中的图像数量并将其存储在变量中

```
 int numberOfImages = 15;// Get it dynamically 
```

**第 3 步**：现在循环它以按顺序存储所有图像

```
 //Create Directory to store images in SDCard
   String root = Environment.getExternalStorageDirectory().toString();
       File myDir = new File(root + "/saved_images");
       if(!myDir.exists()){
           myDir.mkdirs();
          } 
           // You have to get next image here from the resource here
           bm = BitmapFactory.decodeResource( mContext.getResources(), images[i]);// value for itemPos should be given here.

           // Get Last Saved Number
           SharedPreferences savedNumber = getSharedPreferences(PREFS_NAME, 0);
           int lastSavedNumber = savedNumber.getInt("lastsavednumber",0); 
           lastSavedNumber++;
           String fname = "Image-"+lastSavedNumber+".png";

           File file = new File (myDir, fname);
           if (file.exists ()) {file.delete (); }
           try {
                  FileOutputStream out = new FileOutputStream(file);
                  bm.compress(Bitmap.CompressFormat.JPEG, 90, out);//Your Bitmap from the resouce
                  out.flush();
                  out.close();

               } catch (Exception e) {
                  e.printStackTrace();
               }

      //To Store the last Number
     SharedPreferences saveNumber = getApplicationContext().getSharedPreferences(PREFS_NAME, 0);
     SharedPreferences.Editor editorset = saveNumber.edit();
     editorset.putInt("lastsavednumber",lastSavedNumber);   
     editorset.commit(); 
```

如果您在第一步中做错任何事情，就会发生重复。

**编辑** 以按顺序存储所有图像使用 SharedPreferences 来存储最后保存的图像编号。

```
 public static final String PREFS_NAME = "ImageNumber";  

    // Get Last Saved Number
    SharedPreferences savedNumber = getSharedPreferences(PREFS_NAME, 0);
    int lastSavedNumber = savedNumber.getInt("lastsavednumber",0); 
    lastSavedNumber++;
    String fname = "Image-"+lastSavedNumber+".png";

    //To Store Last Saved Number
     SharedPreferences saveNumber = getApplicationContext().getSharedPreferences(PREFS_NAME, 0);
     SharedPreferences.Editor editorset = saveNumber.edit();
     editorset.putInt("lastsavednumber",lastSavedNumber);   
     editorset.commit(); 
```

# c# - 用于数据库的 C# GUI

> ID：15665831
> 
> 赞同：-5
> 
> 时间：2013-03-27T17:47:45.863
> 
> 标签：c#, sql, database

我正在寻找允许您在使用 C# 创建的 GUI 中查看 sql 数据库的程序。这样做的好处是您可以创建表的快捷方式，以便公司使用。但是，我似乎在 Internet 上找不到任何关于使用 C# 程序查看数据库的公司的信息。

*   有没有人使用过执行此操作的程序？
*   有人可以指出我的方向吗？

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T17:51:39.637

你不需要编程任何东西。你有几个选择：

1.  **SQL Server Management Studio** aka SSMS（甚至 SQL Server Express 都有）
2.  Visual Studio 有一个**服务器资源管理器**（菜单视图\服务器资源管理器）

我认为选项 1 或 2 对您来说已经足够了。如果您想要其他替代品，您可以使用[LinqPad](http://www.linqpad.net/)或[Versabanq Squel](http://versabanq.com/squel)。检查此[问题](https://stackoverflow.com/questions/5170/sql-server-management-studio-alternatives)以获取替代方案。

# ruby-on-rails - 关于放置方法查询两个模型的最佳实践

> ID：15665833
> 
> 赞同：0
> 
> 时间：2013-03-27T17:47:48.193
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1

我编写了一个查询模型 A 的方法，并根据结果在模型 B 上更新/创建行。应该将其添加到模型 A 还是模型 B？

过去，我一直在正在更改的模型中放置方法，但是不确定这是否是最好的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T17:56:15.470

为什么不将代码分成两部分，以便一个方法获取查询 ModelA，而另一种方法将创建/更新 ModelB 的属性，并从 ModelA 调用 ModelB 方法。

```
# ModelA
def method_in_model_a
  result = ModelA.where(....)
  ModelB.method_in_modelb(result)
end

# ModelB
def self.method_in_model_b(result)
  # code to create/update this model object
end 
```

# android - 安卓获取日期

> ID：15665834
> 
> 赞同：1
> 
> 时间：2013-03-27T17:47:52.553
> 
> 标签：android, date

我正在尝试使用我在 Stackoverflow 上找到的这段代码。它似乎适用于 Android 上的许多人，因为很多人都竖起大拇指。

但是，Eclipse 甚至不会让我运行它。它给了我一个错误，并说 Date() 没有空的构造函数。它还有 3 个带参数的其他构造函数，但这些构造函数似乎用于将新的 Date 对象设置为特定的时间和日期。

```
SimpleDateFormat sdf = new SimpleDateFormat("yyyyMMdd_HHmmss");
String currentDateandTime = sdf.format(new Date()); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T17:52:12.060

> 但是，Eclipse 甚至不会让我运行它。它给了我一个错误，并说 Date() 没有空的构造函数。它还有 3 个带参数的其他构造函数，但这些构造函数似乎用于将新的 Date 对象设置为特定的时间和日期。

很可能是因为您导入了**java.sql.date**但您需要使用**java.util.date**

查看和的[`java.sql.Date`](http://docs.oracle.com/javase/6/docs/api/java/sql/Date.html)参考[`java.util.Date`](http://docs.oracle.com/javase/6/docs/api/java/util/Date.html)

不同之处在于**java.sql.Date**只有两个带参数的构造函数，而**java.util.Date**还有不带参数的构造函数（除了其他构造函数） - 您正在寻找它。

因此，将您的导入更改为：

```
import java.util.Date; 
```

现在它可以工作了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T18:11:13.977

首先为日期格式定义一个常量

```
public static final String DATE_FORMAT_TIMESTAMP = "yyyy-MM-dd HH:mm:ss"; 
```

以下代码将为您提供上述格式的日期和时间戳

```
 SimpleDateFormat sdf = new SimpleDateFormat(DATE_FORMAT_TIMESTAMP);
            Calendar cal = Calendar.getInstance();
            String TimeStampSTARTTIME = sdf.format(cal.getTime()); 
```

# java - 如何在android的屏幕上保持这两个活动？

> ID：15665837
> 
> 赞同：0
> 
> 时间：2013-03-27T17:47:58.367
> 
> 标签：java, android

嗨在我的应用程序中，我有两个活动。一是主要活动。所以当我启动应用程序时，它会调用主要活动。主要活动显示在屏幕的左上角，具有一定的宽度和高度。在主要活动上有一个按钮。当我按下按钮时，它会启动第二个活动。当第二个活动启动时，它会显示在屏幕中央。当第二个活动获得焦点时，第一个活动进入暂停状态，但仍显示在屏幕上。但是当我从第二个活动转移到第一个活动时，第一个活动获得焦点。问题是当第一个活动获得焦点时，第二个活动从屏幕上消失了。我想要的是它不应该消失。它必须在屏幕上处于暂停状态。然后我需要在这些活动之间切换。

以下是我的清单文件：-

```
 <application
    android:allowBackup="true"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <activity
        android:theme="@android:style/Theme.Dialog"
        android:name="com.example.firstapp.MainActivity"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <activity
        android:theme="@android:style/Theme.Dialog"
        android:name="com.example.firstapp.DisplayMessageActivity"
        android:label="@string/title_activity_display_message"
        android:parentActivityName="com.example.firstapp.MainActivity" >
        <meta-data
            android:name="android.support.PARENT_ACTIVITY"
            android:value="com.example.firstapp.MainActivity" />
    </activity>
    </application> 
```

这两个动作使用线性布局作为它们的根布局并包含一些 gui 元素。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T17:50:42.757

您需要使用片段。Vogella 有一个很棒的教程。

[http://www.vogella.com/articles/AndroidFragments/article.html](http://www.vogella.com/articles/AndroidFragments/article.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T17:53:50.880

使用片段。 [http://developer.android.com/guide/components/fragments.html](http://developer.android.com/guide/components/fragments.html)

开发者网站上的示例。

[http://developer.android.com/guide/components/fragments.html#Example](http://developer.android.com/guide/components/fragments.html#Example)

编辑：

当您从第一个活动导航到第二个活动时，第一个活动将被暂停（将在后堆栈上）。您的第二个活动被放入堆栈并获得焦点。当您返回第一个活动时，第二个活动将从堆栈中弹出并销毁。现在第一个活动成为焦点。这就是它的工作原理。堆栈的工作方式是后进先出。（后进先出）。

有关活动回栈的更多详细信息，请阅读下面链接中的主题。

[http://developer.android.com/guide/components/tasks-and-back-stack.html](http://developer.android.com/guide/components/tasks-and-back-stack.html)

# c# - WPF TabControl 标题和内容未更新？

> ID：15665838
> 
> 赞同：4
> 
> 时间：2013-03-27T17:48:01.607
> 
> 标签：c#, wpf, data-binding, user-interface, tabcontrol

设置：我有一个带有 0...n 个选项卡的选项卡控件，每个选项卡都绑定到一个类：

```
class MyTabItem
{
    string Text {get; set;}
    int ID {get; set;}
    ISet<MyTabContent> Contents {get; set;}
}

Class MyTabContent
{
    int ID {get; set;}
    string Subtext {get; set;}
} 
```

每个 tabitem 类在它的集合中有许多 tabcontent 类。（整个事情都是通过 NHibernate 获取的）。

我尝试了很多方法来将 MyTabItem 的内容绑定到每个 tabcontrol 项的标题，并将 MyTabContent 的内容绑定到每个 tabcontrol 项的内容中的数据网格。

我可以在选项卡中显示所有内容，但是每当我更改绑定类中的属性时，UI 都不会更新。我尝试调用 InvalidateVisual，尝试调度 Render 事件，尝试在绑定上更新目标和更新源（最后两个抛出异常）。我已经在我的视图模型中实现了 INotifyPropertyChanged，甚至尝试手动使用 OnPropertyChanged("MyTabItem") 无济于事。

我真的不明白为什么当我更改绑定类中的属性时我的 tabcontrol 内容不会更新。我尝试了 2 种不同的绑定策略，它们都可以显示内容，但在内容更改时都不会更新。

我的 XAML 设置是：

```
<TabControl>
  <TabControl.ItemTemplate>
    <DataTemplate DataType="models:MyTabItem">
      <TextBlock Text="{Binding Text}" />
    </DataTemplate>
  </TabControl.ItemTemplate>
  <TabControl.ContentTemplate>
    <DataTemplate DataType="models:MyTabItem">
      <DataGrid ItemsSource="{Binding Contents}">
        <DataGrid.Columns>
          <DataGridTextColumn Binding="{Binding Path=Subtext}" />
        </DataGrid.Columns>
      </DataGrid>
    </DataTemplate>
  </TabControl.ContentTemplate>
</TabControl> 
```

通过该 XAML 设置，我只需使用 tabcontrol.Items.Add(new MyTabItem) 将项目添加到 tabcontrol。

然后我尝试了另一个 XAML 设置，我将 tabcontrol.Itemsource 绑定到代码隐藏中的 ObservableCollection。同样，如果绑定属性发生变化，选项卡内容不会更新:(

我还尝试在 ViewModel 中创建一个 CurrentItem 属性，并将其用作 Window.Resource，然后将 Tabcontrol 内容绑定到

```
{Binding Source={StaticResource CurrentItem}, Path=Text} 
```

每当我更改选项卡时，我都会更新视图模型中的 CurrentItem，但它也不会更新更改。

我几乎没有想法:(

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-27T18:21:09.510

您需要实现[INotifyPropertyChanged](http://msdn.microsoft.com/en-us/library/system.componentmodel.inotifypropertychanged.aspx)

请记住，.NET 4.5 中有一个新属性可以简化任务，请看[这里](http://danrigby.com/2012/03/01/inotifypropertychanged-the-net-4-5-way/)

这是一个示例，将其应用于您的两个类，列表将需要变为[ObservableCollection](http://msdn.microsoft.com/en-us/library/ms668604.aspx)：

```
private ObservableCollection<MyTabContent> _contents = new  ObservableCollection<MyTabContent>();
public ObservableCollection<MyTabContent> Contents { get { return _contents; } } 
```

-

```
public class MyTabContent : INotifyPropertyChanged
{
    private int _id;
    int ID {
        get{ return _id; }
        set{ _id = value; OnPropertyChanged(); }
    }

    private string _subText;
    public string Subtext {
        get{ return _subText; }
        set{ _subText= value; OnPropertyChanged(); }
    }

    public event PropertyChangedEventHandler PropertyChanged;
    protected virtual void OnPropertyChanged([CallerMemberName] string propertyName = null)
    { 
        if (PropertyChanged!= null)
            PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
    }
} 
```

# c - 你将如何链接一个具有不同结构的链表

> ID：15665842
> 
> 赞同：0
> 
> 时间：2013-03-27T17:48:04.430
> 
> 标签：c, linked-list

我有 2 个不同的结构

```
 typedef struct name {

    char*markerName;
    struct test *next;

}name_t;

 typedef struct test {

    int grade;
    int studentNumber;
    struct test *next;

}test_t; 
```

和这个功能

```
void test(name_t* marker1,int data)
{
        test_t *temp= malloc(sizeof(test_t));
        test_t *location=NULL;
        temp->grade=data;
        temp->next=NULL;
        location=marker1->next;
        if(location==NULL)
        {
        //  printf("%i \n",temp->grade);
            marker1->next=temp;
        }
        else
        {
            while(location!=NULL)
            {
                printf("%i \n",location->grade);
                printf("%p \n",location->next);
                location=location->next;
            }
            location=temp;
        }
} 
```

问题是我们正在创建一个结构名称的数组，并在数组的每个元素之后创建一个测试的链表。如何将结构名称的节点链接到结构测试？

我打印了下一个，他们一直指向 NULL 指针。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T17:59:35.250

您超出了链接列表的末尾。您的`location`变量最终会得到“NULL”，即使它可以被分配，它仍然是一个局部变量，当您的函数退出时会脱离上下文。您的 while 循环应该看起来更像这样：

```
while(location->next != NULL)
{
    printf("%i \n",location->grade);
    printf("%p \n",location->next);
    location = location->next;
}

location->next = temp; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T17:59:46.553

具有两种类型的 next 指针的结构怎么样：一种是 name_t 类型，另一种是 test_t 类型。您可以使用您想要链接的一个并将另一个保留为 NULL。我希望我正确理解了你的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-27T18:12:32.760

严格来说，链表只能包含一种数据类型。如果您想要一个包含两种结构类型的列表，您可以使用联合来模拟：

```
struct name {
   char* markerName;
};

struct test {
   int grade;
   int studentNumber;
};

// Indicates the type of data stored in the union
enum dtype { NONE, NAME, TEST };

// Combination of the above structures, suitable for a mixed-type list
struct combo {
   struct combo*   next; // Next structure in the linked list
   enum dtype      type; // Indicates which of the union fields is valid
   union {
      struct name  name;
      struct test  test;
   };
}; 
```

这将两组数据存储在一个结构中，允许您从结构中创建列表，并使您能够跟踪当前有效的数据类型。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-27T17:53:50.477

您可以使用指针来键入`void`. 当然，这假设您以某种方式知道下一个对象的类型。

当你想创建一个异构数据结构时，只有一种结构类型的节点可能更聪明，并且在节点中有两个“有效负载”变量，一个告诉你节点的类型，一个指向结构的指针与实际数据。

# javascript - UnderscoreJS -- _.some() 与 _.find()

> ID：15665849
> 
> 赞同：15
> 
> 时间：2013-03-27T17:48:15.897
> 
> 标签：javascript, underscore.js

根据我在文档中阅读的内容，_.find() 的功能与 _.some() 非常相似

有谁知道两者之间是否有（性能）优势？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-03-27T17:53:04.730

假设您想知道是要使用[`find`](http://underscorejs.org/#find)还是[`some`](http://underscorejs.org/#some)在特定情况下使用，它们的性能特征可能是相同的。他们都以同样的方式懒惰。

不同之处在于输出。`find`将返回值，`some`将返回一个`boolean`.

* * *

我检查了来源（1.4.4）。`some`并且`find`都在内部使用`some`(=== `any`)。因此，即使使用本机实现，`some`它也对`find`和都有好处`some`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-27T18:09:15.003

如果你查看它的源代码，你会发现这两个是相同的，_.find 实际上调用了_.some。

```
_.find = _.detect = function(obj, iterator, context) {
  var result;
  any(obj, function(value, index, list) {
    if (iterator.call(context, value, index, list)) {
      result = value;
      return true;
    }
  });
  return result;
};

var any = _.some = _.any = function(obj, iterator, context) {
  iterator || (iterator = _.identity);
  var result = false;
  if (obj == null) return result;
  if (nativeSome && obj.some === nativeSome) return obj.some(iterator, context);
  each(obj, function(value, index, list) {
    if (result || (result = iterator.call(context, value, index, list))) return breaker;
  });
  return !!result;
}; 
```

# java - 错位构造（Java）

> ID：15665860
> 
> 赞同：-1
> 
> 时间：2013-03-27T17:48:59.867
> 
> 标签：java, syntax-error

```
 public void drawBoard(){
       System.out.println(P1 + "|" + P2 + "|" + P3 + "|"); 
       System.out.println(P4 + "|" + P5 + "|" + P6 + "|"); 
       System.out.println(P7 + "|" + P8 + "|" + P9 + "|");
    } 
```

我在“public void drawBoard()”下得到一条下划线，上面写着“token(s) misplaced construction(s) 上的语法错误”

我浏览了互联网和我的 Java 教科书，但无法提出解决方案。任何帮助将不胜感激。谢谢你，艾琳

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T17:52:16.703

这

```
public void drawBoard() { 
```

必须直接出现在类定义中。

如果之前有一个方法`drawBoard()`，请确保您已经关闭了它的所有花括号。

# mongodb - 从 Java Hibernate SQL Server 到 Python Mongo Stack 的数据迁移

> ID：15665864
> 
> 赞同：0
> 
> 时间：2013-03-27T17:49:10.657
> 
> 标签：mongodb, migration, database-migration, data-migration

我有一个拥有多个活跃用户（大约 30K）的实时网站，每个用户都有自己的配置来呈现主页。门户的当前堆栈是带有 SQL Server 的 Java Spring Hibernate。现在，我们已经在 Python MongoDB 堆栈中重新编写了代码，并希望将我们的用户迁移到新系统。这里的问题是新旧代码将部署在不同的机器上，我们希望作为 Beta 测试的一部分为少数用户运行此迁移。Beta 测试完成后，我们将迁移所有用户。

实现这一目标的最佳方法是什么？我们正在考虑将数据转储到远程服务器上的 XML/JSON 等替代文件系统中，然后在新代码中读取它。

请建议完成此任务的最佳方法

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T21:00:57.287

**将 CSV、TSV 或 JSON 数据导入 MongoDB。**

以 json、txt 或 csv 等格式转储文件会更快、更优化，应将其复制到新服务器，然后在命令行 shell 中使用 mongoimport 导入数据。

示例
mongoimport -d 数据库名 -c 集合名 < users.json

[如果您需要http://docs.mongodb.org/manual/reference/mongoimport/](http://docs.mongodb.org/manual/reference/mongoimport/)，请参阅下面的链接以获取有关 mongoimport 的更多信息

# css - Bootstrap - 输入文本字段和按钮之间的间隙

> ID：15665867
> 
> 赞同：0
> 
> 时间：2013-03-27T17:49:33.547
> 
> 标签：css, twitter-bootstrap

这是我的代码[http://jsbin.com/ixevaw/1/edit](http://jsbin.com/ixevaw/1/edit)

```
<div class="input-append">
   <input type="search" class="span3" placeholder="Search" name="search" id="search"/>
   <button class="btn">button</button>
</div> 
```

但是 safari 和 IE9 中的文本字段和按钮之间存在差距

我怎样才能消除这个差距？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-10-23T14:25:58.823

奇怪的是，如果您删除标签之间的空格，问题就会消失。所以你希望它看起来像这样：

```
<div class="input-append">
   <input type="search" class="span3" placeholder="Search" name="search" id="search"/><button class="btn">button</button>
</div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T18:23:05.757

这似乎是一个引导程序错误。对于那些仅使用检测或备用样式表的浏览器，您可能必须在按钮上放置 -5px 的左边距。

```
.input-append input + .btn {margin-left: -5px;} 
```

# python - 在 Python 中添加到行尾

> ID：15665880
> 
> 赞同：3
> 
> 时间：2013-03-27T17:50:32.453
> 
> 标签：python, line, add

我想使用 python 在每行的开头和结尾添加一些字母。

但是，我找到了各种方法来执行此操作，无论我使用哪种方法，我想添加到末尾的字母总是添加到开头。

```
input = open("input_file",'r')
output = open("output_file",'w')

for line in input:
    newline = "A" + line + "B"
    output.write(newline)
input.close()
output.close() 
```

我使用了在这里找到的各种方法。对于它们中的每一个，两个字母都被添加到前面。

[在字符串的开头和结尾插入字符](https://stackoverflow.com/questions/10059554/inserting-characters-at-the-start-and-end-of-a-string)

```
''.join(('L','yourstring','LL')) 
```

或者

```
yourstring = "L%sLL" % yourstring 
```

或者

```
yourstring = "L{0}LL".format(yourstring) 
```

我显然在这里遗漏了一些东西。我能做些什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-27T17:51:53.840

从文件中读取行时，python`\n`将最后保留。但是，您可以`.rstrip`关闭它。

```
yourstring = 'L{0}LL\n'.format(yourstring.rstrip('\n')) 
```

# sql-server - 在 SQL Server 中查询 Service Broker 队列的文件组

> ID：15665886
> 
> 赞同：0
> 
> 时间：2013-03-27T17:50:40.537
> 
> 标签：sql-server, service-broker

如何在 SQL Server 中查询 Service Broker Queue 对象的文件组？

通过查看队列的属性，我可以通过 SQL Server Management Studio 查看信息，但我希望能够在脚本中查询信息。

似乎我不能使用与查询表的文件组相同的方法 - 但也许我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T23:04:58.213

您必须寻找与`parent_object_id`队列匹配的内部表：

```
select o.* 
from sys.service_queues q
join sys.objects o on o.parent_object_id = q.object_id; 
```

# iphone - 绘制矩形中的边框不正确

> ID：15665889
> 
> 赞同：1
> 
> 时间：2013-03-27T17:50:52.040
> 
> 标签：iphone, ios, drawrect, uibezierpath

我试图在 drawRect 方法中使用贝塞尔路径在矩形上绘制圆角，但不知何故，圆角显示在矩形的内侧，而不是内侧和外侧。代码如下。随附的是当前正在绘制的边框（边框的外侧未圆角）

![仅带有内圆角的图像](../Images/7b34cbf97844b4da2a4a619acf1a9726.png)

```
 - (void)drawRect:(CGRect)rect
 {

  // Drawing code
    CGContextRef context=UIGraphicsGetCurrentContext();

    //Set gray color to whole context
    [[UIColor lightGrayColor] set];
    CGContextSetAlpha(context,0.7);
    UIRectFill(rect);

    // Configure the context colors and line
    CGContextSetStrokeColorWithColor(context, [UIColor colorWithRed:131./255\. green:148./255\. blue:219./255\. alpha:1.0].CGColor);
    CGContextSetFillColorWithColor(context, [UIColor whiteColor].CGColor);
    CGContextSetLineWidth(context, 10.0);
    CGSize size=self.bounds.size;

    CGFloat radius = 10.0;

    CGSize guideSize=CGSizeMake(330, 130);
    CGRect guideCoords= CGRectMake(size.width*.5-guideSize.width*.5, size.height*.5-guideSize.height*.5, guideSize.width , guideSize.height);

    // Guide drawing
    CGContextStrokeRect(context,guideCoords);

    // Draw the Text
    [kVinGuideMessage drawInRect:CGRectMake(guideCoords.origin.x+kSideMessageMargin, guideCoords.origin.y+guideSize.height+kMarginFromGuide, guideCoords.size.width-2*kSideMessageMargin,40) withFont:[UIFont systemFontOfSize:16.0] lineBreakMode:NSLineBreakByWordWrapping alignment:NSTextAlignmentLeft];

    //Get instersection and clear color of inner overlay
    CGRect holeRectIntersection = CGRectIntersection(rect,guideCoords);

    //----------ADDING ROUNDED CORNERS HERE-----------//
    CGPathRef clippath = [UIBezierPath bezierPathWithRoundedRect:guideCoords cornerRadius:radius].CGPath;
    CGContextAddPath(context, clippath);
    CGContextClip(context);
    //------------------------------------------------//
    [[UIColor clearColor] setFill];
    UIRectFill(holeRectIntersection); 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T17:57:51.657

`CGContextStrokeRect(context,guideCoords);`我认为外角正在绘制。那时你还没有设置剪切路径，你的线宽是 10 点，那么为什么外角要圆角呢？我认为，如果在 guideCoords 矩形上调用 stroke rect 之前设置一个剪切路径（可能与底部的剪切路径不完全相同），你会有更好的运气。

# iphone - iOS 应用内购买可安全恢复以前的购买

> ID：15665891
> 
> 赞同：0
> 
> 时间：2013-03-27T17:50:58.677
> 
> 标签：iphone, ios, in-app-purchase, payment, storekit

我已经在我的应用程序中实现了应用程序内购买，对此我有两个问题。这是我使用的代码：

```
- (IBAction)buyProduct1:(id)sender {
    SKPayment *payment = [SKPayment paymentWithProduct:product1];
    [[SKPaymentQueue defaultQueue] addTransactionObserver:self];
    [[SKPaymentQueue defaultQueue] addPayment:payment];
}

- (IBAction)restorePurchases:(id)sender {
    [[SKPaymentQueue defaultQueue] addTransactionObserver:self];
    [[SKPaymentQueue defaultQueue] restoreCompletedTransactions];
}

- (void)paymentQueue:(SKPaymentQueue *)queue updatedTransactions:(NSArray *)transactions {

    for (SKPaymentTransaction *transaction in transactions) {
        switch (transaction.transactionState) {
            case SKPaymentTransactionStatePurchasing:

                break;
            case SKPaymentTransactionStatePurchased:

                //Can I be 100% sure that this method is only called when the product is bought?
                [self product1Bought:transaction];

                break;
            case SKPaymentTransactionStateRestored:

                //What code should I have here to safely restore product1 if the product is bought?

                break;
            case SKPaymentTransactionStateFailed:

                break;
            default:
                break;
        }
    }
}

- (void)product1Bought:(SKPaymentTransaction *)transaction {
    NSString *string = @"Product1";
    [[NSUserDefaults standardUserDefaults] setObject:string forKey:@"Product1"];
    NSLog(@"Product1 is bought");
    [[SKPaymentQueue defaultQueue] finishTransaction:transaction];
} 
```

1.我只是想知道我是否可以 100% 确定 productBought 方法仅在成功购买后调用，而不是在发生任何奇怪的事情并且产品没有真正购买时调用？

2.如何检查product1是否较早购买，以便调用product1Bought方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T18:55:37.993

```
- (void)paymentQueueRestoreCompletedTransactionsFinished:(SKPaymentQueue *)queue 
```

{

```
 if ([queue.transactions count] == 0)
 {
     UIAlertView *restorealert = [[UIAlertView alloc]
                                  initWithTitle:@"Restore"
                                  message:@"There is no products purchased by you"
                                  delegate:self
                                  cancelButtonTitle:@"Ok"
                                  otherButtonTitles:nil];

     [restorealert show];
     activityIndicator.hidden = YES;

 }
else
{
    NSString *productID;

    for(SKPaymentTransaction *transaction in queue.transactions)
    {
     productID = transaction.payment.productIdentifier;
        NSLog(@"the product identifier is %@",productID); 
```

}

完成恢复后，您可以在此处获取您购买的 productId

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T18:38:55.527

1）工作正常，用户购买时数据可用

2）对于早期购买的物品，您可以在SKPaymentTransactionStateRestored下调用此方法：

```
[self RestorePurchases];

-(void)RestorePurchases{
[[SKPaymentQueue defaultQueue] restoreCompletedTransactions];
} 
```

# javascript - Java脚本，谷歌浏览器扩展：未定义的类变量，在回调引用的方法中

> ID：15665893
> 
> 赞同：0
> 
> 时间：2013-03-27T17:51:06.883
> 
> 标签：javascript, oop, google-chrome-extension

我正在尝试制作 Google Chrome 扩展程序。

一开始，我想创建 javascript 类，它代表活动的浏览器选项卡并让我使用该 HTML 源代码。它应该像这样使用：

```
var currentTab = new CurrentTab();

currentTab.requestHtml(function(html){
    // `html` contents active tab HTML
}); 
```

我用谷歌搜索，我发现活动标签的 HTML 不能直接进入扩展的弹出窗口。但我可以将我自己的 javascript 传递给选项卡，它通过`chrome.extension.sendRequest()`. 所以，我的`CurrentTab`课看起来像这样：

```
var CurrentTab = function(){
    this.listeners = {
        'requestHtml': {}
    };

    chrome.extension.onRequest.addListener(this._processListener);
};
CurrentTab.prototype = {
    requestHtml: function(callback){
        var actionKey = Math.ceil(Math.random() * 10000);  // get random identifier for this callback

        this.listeners['requestHtml'][actionKey] = callback;

        chrome.tabs.executeScript(null, { 
            code: 'console.log("SendContent.js");'
                + 'chrome.extension.sendRequest({'
                + '     action: "' + actionKey + '",'
                + '     host: document.location.hostname,'
                + '     content: document.getElementsByTagName("html")[0].outerHTML'
                + '}, function(response){});'
        });
    },

    _processListener: function(request, sender, sendResponse){
        /*25.*/console.log(this.listeners);  // `this.listeners` is 'undefined' ???
        if (this.listeners['requestHtml'][request.action]) {
            this.listeners['requestHtml'][request.action](request.content);
            delete this.listeners['requestHtml'][request.action];
        }
    }
}; 
```

问题出现在本课程的第 25 行。虽然该`_processListener`方法是类的一部分，但当通过回调调用此方法时，此处的`CurrentTab`变量是未定义的。`this.listeners`

请问，我该如何解决这个问题，为什么会这样？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:50:23.517

使用锁定函数的上下文[`Function.prototype.bind`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/bind)：

```
var CurrentTab = function(){
    ...

    chrome.extension.onRequest.addListener(this._processListener.bind(this));
}; 
```

# c# - ThreadAbortException 后如何恢复？

> ID：15665898
> 
> 赞同：2
> 
> 时间：2013-03-27T17:51:16.503
> 
> 标签：c#, multithreading, asp.net-mvc-3, iis, exception-handling

我在一个 MVC3 应用程序中有几个长时间运行的线程，它们旨在永远运行。

我遇到了一个问题，即 ThreadAbortException 被其他一些代码（不是我的）调用，我需要优雅地从中恢复并重新启动线程。目前，我们唯一的办法是回收 appDomain 的工作进程，这远非理想。

**以下是有关此代码工作的一些详细信息：**

此 MVC3 应用程序存在一个单例服务类。它必须是单例，因为它缓存数据。该服务负责向数据库发出请求。第三方库用于实际的数据库连接代码。

在这个单例类中，我们使用称为“QueryRequestors”的类的集合。这些类为对数据库的请求标识唯一的 package+stored_procedure 名称，以便我们可以对这些调用进行排队。这就是 QueryRequestor 类的目的：确保对同一个 package+stored_procedure 的调用（尽管它们可能有无限不同的参数）被排队，并且不会同时发生。这大大减轻了我们的数据库压力并提高了性能。

QueryRequestor 类使用内部 BlockingCollection 和内部 Task（线程）来监视其队列（阻塞集合）。当一个请求进入单例服务时，它会通过 package+stored_procedure 名称找到正确的 QueryRequestor 类，并将查询交给该类。查询被放入队列（阻塞收集）。QueryRequestor 的任务看到队列中有一个请求并调用数据库（现在涉及到第 3 方库）。当结果返回时，它们被缓存在单例服务中。Task 继续处理请求，直到阻塞集合为空，然后等待。

一旦 QueryRequestor 创建并启动并运行，我们永远不希望它死掉。每隔几分钟就会收到 24/7 的请求。如果服务中的缓存有数据，我们就使用它。当数据陈旧时，下一个请求会排队（并且后续的同时请求继续使用缓存，因为他们知道有人（另一个线程）已经在进行排队请求，这是有效的）。

所以这里的问题是当 QueryRequestor 类中的 Task 遇到 ThreadAbortException 时该怎么办。理想情况下，我想从中恢复并重新启动线程。或者，至少，处理 QueryRequestor（就我而言，它现在处于“损坏”状态）并重新开始。因为如果服务中不存在与 package+stored_procedure 名称匹配的下一个请求，则会创建一个新的 QueryRequestor。

我怀疑线程被第 3 方库杀死，但我不能确定。我所知道的是，*我*无处中止或试图杀死线程/任务。我希望它永远运行。但显然我们必须为这个异常准备好代码。当服务因为线程被中止而爆炸时，这很烦人。

处理这个问题的最佳方法是什么？我们怎样才能优雅地处理这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T18:02:19.263

`ThreadAbortException`您可以通过调用[Thread.ResetAbort](http://msdn.microsoft.com/en-us/library/system.threading.thread.resetabort.aspx)来停止重新抛出。

请注意，最常见的异常情况是重定向调用，取消线程中止可能会导致执行请求代码的不良影响，否则会由于终止线程而被忽略。WinForms（代码和渲染的分离不太清楚）比 MVC（您可以从控制器返回特殊重定向结果）中的常见问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T19:21:17.817

这是我想出的解决方案，效果很好。

这里真正的问题不是阻止 ThreadAbortException，因为无论如何您都无法阻止它，我们也不想阻止它。如果我们收到错误报告告诉我们发生了这种情况，这实际上是一件好事。我们只是不希望我们的应用程序因此而崩溃。

所以，我们真正需要的是一种优雅的方式来处理这个异常而不关闭应用程序。

我想出的解决方案是在名为“IsValid”的 QueryRequestor 类上创建一个 bool 标志属性。该属性在类的构造函数中设置为 true。

在 QueryRequestor 类的单独线程上运行的 DoWork() 调用中，我们捕获 ThreadAbortException 并将此标志设置为 FALSE。现在我们可以告诉其他代码这个类处于无效（损坏）状态并且不要使用它。

所以现在，使用这个 QueryRequestor 类的单例服务知道要检查这个 IsValid 属性。如果它无效，它将用一个新的 QueryRequestor 替换，然后生活继续。应用程序不会崩溃，损坏的 QueryRequestor 会被丢弃，取而代之的是可以完成这项工作的新版本。

在测试中，这工作得很好。我会故意在 DoWork() 线程上调用 Thread.Abort()，并观察 Debug 窗口中的输出行。应用程序将报告线程已中止，然后单例服务正确替换了 QueryRequestor。然后替换能够成功地处理请求。

# delphi - 如何创建一个可以容纳不同类型对象的列表？

> ID：15665900
> 
> 赞同：3
> 
> 时间：2013-03-27T17:51:25.883
> 
> 标签：delphi

我目前正在使用这样的通用列表：

```
List: TList<TPoint>; 
```

作为替代方案，我希望`List`能够保持具有三个坐标的点：

```
type 
  TPoint3D = record 
    x, y, z: Integer;
  end; 
```

我想声明这样的事情：

```
List: TList<TCanBeEitherTPointOrTPoint3D>; 
```

当然这不会起作用，但我不知道什么会起作用！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-27T21:56:36.533

Delphi 不支持异构类型列表。您必须能够用单一类型表示*所有潜在值。*一种方法是将所有不同的类型连接到一个有区别的联合中：

```
type
  TPointUnion = record
    case NumDimensions: Integer of
      2: (p2: TPoint);
      3: (p3: TPoint3D);
  end; 
```

然后您可以声明该类型的列表：

```
var
  List: TList<TPointUnion>; 
```

您可以将类型的值添加`TPointUnion`到列表中。要构造该类型的值，只需分配`NumDimensions`字段，然后分配相应的`p2`或`p3`字段。读取此类值时，请检查`NumDimensions`字段以发现哪个点字段包含有效值。在实践中，`p2`总是可以安全使用，因为它的字段与`p3`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T05:44:30.333

作为替代方案，您可以使用类类型，而不是[Rob 建议](https://stackoverflow.com/a/15670280/757830)的带有变体部分的[记录类型](http://docwiki.embarcadero.com/RADStudio/XE3/en/Structured_Types#Variant_Parts_in_Records)：

```
type
  TPoint2D = class(TObject)
    X: Integer;
    Y: Integer;
  end;

  TPoint3D = class(TPoint2D)
    Z: Integer;
  end;

var
  List: TList<TPoint2D>;

begin
  if List[I] is TPoint2D then
    TPoint2D(List[I]).X := 10
  else
    TPoint3D(List[I]).Z := 10; 
```

我不完全知道这种方法是否会表现得更好~~，但内存使用情况是一样的~~。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-29T10:49:07.063

System.RTTI.TValue 可能会有所帮助：

```
type
  tAnyList = tList<TValue>;  // Generic TList of TValue

procedure testTAnyList;
var
  tal: tAnyList;
  pt3d: TPoint3D;
  pt2d: TPoint2D;
begin
  // Init pt3d, pt2d here
  tal := tAnyList.Create;
  try
    tal.Add('Some Text');        // Store text
    tal.Add(16);                 // Some integer
    tal.Add(form1);              // Object
    tal.Add(tValue.From(pt3d));  // TPoint3D record
    tal.Add(tValue.From(pt2d));  // TPoint2D record
  finally
    tal.Free;
  end;
end; 
```

使用记录时请注意：pt3d 将作为值传递（即它的值将被复制），而不是通过引用传递。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-03-13T19:24:35.350

```
program MultiClass;

{$APPTYPE CONSOLE}

uses
  SysUtils, Generics.Defaults, Generics.Collections;

type

  TPoint2D = class
    x, y: integer;
    constructor create(x, y: integer);
  end;

  TPoint3D = class
    x, y, z: integer;
    constructor create(x, y, z: integer);
  end;

  TPointSelector = (ePoint2D, ePoint3D);

  TPoint2DOrTPoint3D = class
    select: TPointSelector;
    obj: Pointer;
    constructor create(myClass: TPoint2D); overload;
    constructor create(myClass: TPoint3D); overload;
    constructor create(x, y: integer); overload;
    constructor create(x, y, z: integer); overload;
    destructor Destroy; override;
  end;

Constructor TPoint2D.create(x: integer; y: integer);
begin
  self.x := x;
  self.y := y;
end;

Constructor TPoint3D.create(x: integer; y: integer; z: integer);
begin
  self.x := x;
  self.y := y;
  self.z := y;
end;

constructor TPoint2DOrTPoint3D.create(x, y: integer);
begin
  select := ePoint2D;
  obj := TPoint2D.create(x, y);
end;

constructor TPoint2DOrTPoint3D.create(x, y, z: integer);
begin
  select := ePoint3D;
  obj := TPoint3D.create(x, y, z);
end;

constructor TPoint2DOrTPoint3D.create(myClass: TPoint2D);
begin
  select := ePoint2D;
  obj := TPoint2D;
end;

constructor TPoint2DOrTPoint3D.create(myClass: TPoint3D);
begin
  select := ePoint3D;
  obj := TPoint3D;
end;

destructor TPoint2DOrTPoint3D.Destroy;
begin
  if assigned(obj) then
    case select of
      ePoint2D:
        TPoint2D(obj).Free;
      ePoint3D:
        TPoint3D(obj).Free;
    end;
end;

procedure Test;
var
  PointList: TObjectList<TPoint2DOrTPoint3D>;
  I: integer;
  Pt: TPoint2DOrTPoint3D;
  P3D: TPoint3D;
  P2D: TPoint2D;
begin
  PointList := TObjectList<TPoint2DOrTPoint3D>.create;
  PointList.OwnsObjects := true;

  PointList.Add(TPoint2DOrTPoint3D.create(10, 10));
  PointList.Add(TPoint2DOrTPoint3D.create(50, 10));
  PointList.Add(TPoint2DOrTPoint3D.create(-10, 10, 90));
  PointList.Add(TPoint2DOrTPoint3D.create(3, 50, 70));

  for Pt in PointList do
  begin
    case Pt.select of
      ePoint2D:
        begin
          P2D := Pt.obj;
          writeln(P2D.x, '  ', P2D.y);
        end;
      ePoint3D:
        begin
          P3D := Pt.obj;
          writeln(P3D.x, '  ', P3D.y, '  ', P3D.z);
        end;
    end;
  end;

  PointList.Destroy;

end;

begin
  try
    Test;
  except
    on E: Exception do
      writeln(E.ClassName, ': ', E.Message);
  end;
  readln;

end. 
```

这可能有点矫枉过正，但我​​认为这可能是相关的

Delphi XE 编程

# java - 图片添加

> ID：15665901
> 
> 赞同：0
> 
> 时间：2013-03-27T17:51:28.303
> 
> 标签：java, android, eclipse

我想在我的应用程序的一个屏幕的底部都有一张图片，我终于实现了，但是 eclipse 自动在我的图片的顶部和底部添加了一个栏。我不想这样，你能帮忙吗？如果您需要我提供更多信息，请说：P。

编辑：activity_main.xml：

`

```
<ImageButton
    android:id="@+id/imageButton1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_below="@+id/textView1"
    android:layout_centerHorizontal="true"
    android:minHeight="100dp"
    android:minWidth="100dp"
    android:src="@drawable/metro" />

<ImageButton
    android:id="@+id/imageButton2"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_below="@+id/textView1"
    android:layout_toLeftOf="@+id/imageButton1"
    android:minHeight="100dp"
    android:minWidth="100dp"
    android:src="@drawable/syllabus" />

<ImageButton
    android:id="@+id/imageButton3"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignTop="@+id/imageButton1"
    android:layout_toRightOf="@+id/imageButton1"
    android:minHeight="100dp"
    android:minWidth="100dp"
    android:src="@drawable/bus" />

<TextView
    android:id="@+id/textView1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentTop="true"
    android:layout_centerHorizontal="true"
    android:layout_marginTop="18dp"
    android:height="20dp"
    android:textColor="#FFFFFF"
    android:width="175dp" />

<ImageButton
    android:id="@+id/imageButton4"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_below="@+id/imageButton1"
    android:layout_toLeftOf="@+id/imageButton3"
    android:minHeight="100dp"
    android:minWidth="100dp"
    android:src="@drawable/supermarkt" />

<ImageButton
    android:id="@+id/imageButton5"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignLeft="@+id/imageButton2"
    android:layout_below="@+id/imageButton2"
    android:minHeight="100dp"
    android:minWidth="100dp"
    android:src="@drawable/restaurants" />

<ImageButton
    android:id="@+id/imageButton6"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignTop="@+id/imageButton4"
    android:layout_toRightOf="@+id/imageButton4"
    android:minHeight="100dp"
    android:minWidth="100dp"
    android:src="@drawable/geldautomaat" />

<ImageButton
    android:id="@+id/imageButton7"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_below="@+id/imageButton4"
    android:layout_toLeftOf="@+id/imageButton6"
    android:minHeight="100dp"
    android:minWidth="100dp"
    android:src="@drawable/kaartrome" />

<ImageButton
    android:id="@+id/imageButton8"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignLeft="@+id/imageButton6"
    android:layout_alignTop="@+id/imageButton7"
    android:minHeight="100dp"
    android:minWidth="100dp"
    android:src="@drawable/italiaans" />

<ImageButton
    android:id="@+id/imageButton9"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignTop="@+id/imageButton7"
    android:layout_toLeftOf="@+id/imageButton7"
    android:minHeight="100dp"
    android:minWidth="100dp"
    android:src="@drawable/telefoon" />

    <RelativeLayout 
    android:id="@+id/InnerRelativeLayout"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentBottom="true" >

    <ImageView
        android:id="@+id/Skyline"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:src="@drawable/skyline" />

</RelativeLayout> 
```

`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:11:46.653

如果您没有发布相关代码，很难说发生了什么。

如果您使用 ImageView 并在 XML 中编写布局，则代码应如下所示。

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:gravity="bottom"
    android:orientation="vertical" >

    ...other views for the screen...

    <ImageView
        android:layout_width="match_parent"
        android:layout_heigth="wrap_content"
        android:layout_gravity="bottom"
        android:src="@drawable/some_img" />
</LinearLayout> 
```

假设您使用的是垂直方向的 LinearLayout，这应该将您的图像添加到布局中，使其与父级的宽度完全一致（如果它是父级，则屏幕是根布局），并适当地缩放长度。使`gravity`图片下降到布局的底部（除非在其下布置了某些东西）。

根本不应该有酒吧。

编辑：代码现已发布。您应该在根视图的 XML 部分中拥有所有视图，例如底部图像所在的 RelativeLayout。如果将相对布局的头部移动到 XML 的顶部并将其添加`xmlns:android="http://schemas.android.com/apk/res/android"`到其中，则图像应该做你想做的事。标头应如下所示并且位于 XML 文件的顶部。

```
<RelativeLayout 
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/InnerRelativeLayout"
    android:layout_width="match_parent"
    android:layout_height="match_parent" > 
```

你看过[安卓开发者教程](http://developer.android.com/training/index.html)吗？他们非常有帮助。

# scikit-learn - scikit-learn 中交叉验证的一种标准错误规则

> ID：15665903
> 
> 赞同：5
> 
> 时间：2013-03-27T17:51:32.113
> 
> 标签：scikit-learn

我正在尝试使用 grisSearchCV 在 scikit-learn 中拟合一些模型，并且我想使用“一个标准错误”规则来选择最佳模型，即从得分在一个以内的模型子集中选择最简约的模型最好成绩的标准误。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T07:42:11.170

您可以使用以下方法计算验证分数平均值的标准误差：

```
from scipy.stats import sem 
```

然后访问`grid_scores_`拟合`GridSearchCV`对象的属性。此属性在 scikit-learn 的 master 分支中已更改，因此请使用交互式 shell 来检查其结构。

至于选择最简约的模型，模型的模型参数并不总是有一个自由度的解释。参数的含义通常是特定于模型的，并且没有高级元数据来解释它们的“简约性”。您可能必须根据每个模型类的具体情况对您的解释进行编码。

# java - 没有 X 值的 JFreeCharts TimeSeriesCharts

> ID：15665904
> 
> 赞同：1
> 
> 时间：2013-03-27T17:51:34.067
> 
> 标签：java, jfreechart, timeserieschart

如何为域轴（X 值）创建具有恒定距离的 TimeSeriesChart，就像 LineChart 但使用 DateAxis？

正常的 TimeSeriesChart 如下所示：

![在此处输入图像描述](../Images/2030efbb1d20a11d0128ce019f040392.png)

但我需要类似的东西：

![在此处输入图像描述](../Images/e20d4f7c1eb81602830b07f7d0a3a907.png)

底部有日期轴

图表数据变化非常频繁，当我使用简单的 LineChart 域轴时无法读取......

我创建了一些扩展 XYSeries 的类，它将下一个值设置为 X，并且我更改了数字格式化程序以呈现特定日期，但这个解决方案只是不好的解决方法

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T20:13:00.040

与其将`XYSeries`尝试设置扩展[`XYSeries#setMaximumItemCount(int)`](http://www.jfree.org/jfreechart/api/javadoc/org/jfree/data/xy/XYSeries.html#setMaximumItemCount%28int%29)到您希望在图表中显示的最大项目数，这将阻止图表变得不可读。

在您的第二个屏幕中，您似乎正在使用一个恒定的 x 间隔，如果您的时间是恒定的，您将获得这样的图表，如果不使用整数轴，否则您将获得不规则的步骤。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T04:53:32.650

如果您在域中存在显着差距，您可以尝试[`CombinedRangeXYPlot`](http://www.jfree.org/jfreechart/api/javadoc/org/jfree/chart/plot/CombinedRangeXYPlot.html)为每个连续的时间间隔创建一个子图。

附录：另外，请考虑平移和缩放的其中一个或两个设置，如图[所示](https://stackoverflow.com/a/12065474/230513)。

```
plot.setDomainPannable(true);
chartPanel.setMouseWheelEnabled(true); 
```

# php - 如何将图像标签插入 XML 文件？

> ID：15665907
> 
> 赞同：0
> 
> 时间：2013-03-27T17:51:52.183
> 
> 标签：php, xml

我正在使用以下 php 代码创建 XML 文件：

```
 echo '<?xml version="1.0" encoding="ISO-8859-1"?>
<rss version="2.0">
<channel>
<title>mytitle</title>
<description>my description</description>
<link>www.mysite.com</link>';

$sql = "SELECT title, description, url, picture, formatted_date 
FROM somewhere" ;

$result = mysql_query($sql);
if (!$result) {
    die('Invalid query: ' . mysql_error());
}

if(mysql_num_rows($result)>0)
{
   while($result_array = mysql_fetch_assoc($result))
   {
    //timestamp date to xml format
     $pubdate = date('D, d M Y H:i:s O', strtotime($result_array[formatted_date]));

         echo '  
       <item>  
          <title>'.$result_array[title].'</title>
          <description>'.$result_array[description].'</description> 
          <link>'.$result_array[indit_url].'</link>  
          <pubDate>'.$pubdate.' GMT</pubDate> 

          <enclosure url="'.$result_array[picture].'" length="1121990" type="image"/>
            <image>
              <url>'.$result_array[picture].'</url> 
               <title>image title</title>   
               <link>'.$result_array[picture].'</link>         
                 <width>111</width>                             
               <height>33</height>                             
               <description>An amazing picture</description>   
   </image>      </item>'; 
```

[使用http://validator.w3.org/](http://validator.w3.org/)正确验证了创建的文件，但是当我尝试使用一些 xml 解析器时，例如：[http://simplepie.org/](http://simplepie.org/)，perser 无法捕获图像。我是否使用正确的标签将图像插入 xml 文件？是否有任何其他标签或方法来插入图像？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T17:53:49.640

请尝试转义图像标签中的特殊字符。

使用`htmlspecialchars`在`$result_array[picture]`

**另外，您能否在此处显示您的 rss 提要示例，以便答案更准确。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T18:00:28.903

我建议将数据包围在 XML 转义结构中 - 例如：

```
<image>
    <url><![CDATA[ imagedatagoeshere ]]></content></url>
</image> 
```

但是，我不熟悉 simplepie，所以我不知道它是否正确理解 CDATA。

# sql-server - SSRS 数据源在本地工作，但不在服务器上

> ID：15665910
> 
> 赞同：0
> 
> 时间：2013-03-27T17:51:54.653
> 
> 标签：sql-server, reporting-services

我有这个用于 SSRS 的数据源：

```
Data Source=www.myWebsite.com;Initial Catalog=myDB 
```

它在我的本地机器上工作，但是当我将它部署到生产服务器时它不起作用。

我得到的错误信息是

> 报告处理过程中发生错误。(rsProcessingAborted) 无法创建到数据源“DataSource1”的连接。(rsErrorOpeningConnection)

奇怪的是，当我将其更改为

```
Data Source=localhost;Initial Catalog=myDB 
```

它在服务器上工作。

看起来服务器识别`localhost`但不识别`www.myWebsite.com`（它是服务器自己的网址）。

我还有另一个报告部署到该服务器，该服务器连接到另一台服务器上的数据库：

```
Data Source=www.OtherWebsite.com;Initial Catalog=otherDB 
```

它正在工作。所以服务器会识别除了它自己的网址之外的所有内容。

有人见过吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T19:32:42.763

我想通了，愚蠢的我......我们在服务器上有一个防火墙，它阻止了除少数之外的所有传入连接（我的本地计算机在该例外列表中）。当我使用 www.myWebsite.com 地址时，它认为它来自外部，因此它会阻止它。

我想如果我想保持 rdl 相同，我将不得不使用不同的 rds。

# php - 当我每次使用 window.location 时，iframe 都是嵌套的

> ID：15665913
> 
> 赞同：1
> 
> 时间：2013-03-27T17:52:09.727
> 
> 标签：php, javascript, jquery, html, iframe

我有这个html结构：

```
<html>
<body>
This is the container of the iframe
<iframe src="/foo.html">
</iframe>
</body>
</html> 
```

(/foo.html)

```
<html>
<script type="text/javascript">
$('a').click( function() {
window.location = window.location;
});
</script>
<body>
<a href="#">link to me</a>
</body>
</html> 
```

当我多次单击“链接到我”时，iframe 嵌套在另一个 iframe 结构（如副本）中（使用 firebug，您可以验证这一点）：

```
<html>
 <body>
  This is the container of the iframe
  <iframe src="/foo.html">
<html>
 <body>
  This is the container of the iframe
  <iframe src="/foo.html">
<html>
 <body>
  This is the container of the iframe
  <iframe src="/foo.html">
  </iframe>
 </body>
</html>
  </iframe>
 </body>
</html>
  </iframe>
 </body>
</html> 
```

¿ 我能做些什么来解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:03:02.677

根据[同源策略](https://developer.mozilla.org/en-US/docs/JavaScript/Same_origin_policy_for_JavaScript)`iframe`限制了它可以访问的内容。如果您来自同一个域和同一个子域，那么您可以使用：`iframe``iframe`

```
parent.document.location
parent.window.location
parent.window.document.location
parent.document.location.href 
```

或一些其他类似的方法来访问必要的数据。如果它不是来自同一个域和子域，那么尝试使用上述任何代码都会导致错误。

# html - SVG 未显示在网站上

> ID：15665924
> 
> 赞同：0
> 
> 时间：2013-03-27T17:52:59.857
> 
> 标签：html, svg

我正在尝试使用 SVG，但没有显示任何内容。该文件的 png 版本按预期工作。

```
<img src="typewriter.svg" alt="typewriter svg"> 
```

我已经搜索过，chrome 和 SVG 似乎存在问题，但我认为这不是问题所在。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T17:55:10.150

这是它应该如何工作的：

```
<object data="typewriter.svg" type="image/svg+xml">
  <img src="typewriter.png" />
</object> 
```

# java - 在哪里声明 onOptionsItemSelected 供全球使用？

> ID：15665931
> 
> 赞同：1
> 
> 时间：2013-03-27T17:53:26.123
> 
> 标签：java, android

我对 Android 开发非常陌生。

在我的`MainActivity.java`文件中，我声明了一个`onOptionsItemSelected(MenuItem menu)`方法，允许用户在当前`MainActivity.java`页面和我创建的另一个页面之间跳转，名为`Settings.java`.

当用户进入该`Settings.java`页面并单击`Home`菜单中的选项时，什么也没有发生。我知道这是因为`onOptionsItemSelected(MenuItem menu)`仅在类中定义`MainActivity.java`而不在`Settings.java`类中定义。

我现在通过将`onOptionsItemSelected(MenuItem menu)`from复制`MainActivity.java`到`Settings.java`. 但这是非常多余的。

我应该在哪里声明可以在不同类中重用的方法？

**MainActivity.java**

```
public class MainActivity extends Activity {
    ...
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.main, menu);
        return true;
    }

    @Override
    public boolean onOptionsItemSelected(MenuItem item) {
        switch (item.getItemId()) {
            case R.id.action_settings:
                showMsg("Settings Clicked");
                this.startActivity(new Intent(this, Settings.class));
                return true;
            case R.id.action_home:
                showMsg("Home clicked");
                this.startActivity(new Intent(this, MainActivity.class));
                return true;
            default:
                return super.onOptionsItemSelected(item);
        }
    }

    private void showMsg(String msg) {
        Toast toast = Toast.makeText(this.getBaseContext(), msg, Toast.LENGTH_LONG);
        toast.show();
    }
} 
```

**设置.java**

```
public class Settings extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.settings);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.main, menu);
        return true;
    }

    @Override
    public boolean onOptionsItemSelected(MenuItem item) {
        switch (item.getItemId()) {
            case R.id.action_settings:
                this.startActivity(new Intent(this, Settings.class));
                return true;
            case R.id.action_home:
                this.startActivity(new Intent(this, MainActivity.class));
                return true;
            default:
                return super.onOptionsItemSelected(item);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T17:57:12.217

如果您创建一个名为 Activity`BaseActivity`的具有您的公共`onOptionsItemSelected()`代码的活动，则扩展此类以创建`MainActivity`，并且`Settings`这两个类都将使用`super`该类'（即`BaseActivity`'s）`onOptionsItemSelected()`。

另一种方法是切换到 Fragments，因为 Fragments 使用宿主 Activity`onOptionsItemSelected()`以及它们自己的。这两种策略都允许您使用“集中式”代码，而不必维护多个“剪切和粘贴”副本。

# jquery - 文本区域上的 jQuery .focus() 不起作用

> ID：15665932
> 
> 赞同：9
> 
> 时间：2013-03-27T17:53:29.630
> 
> 标签：jquery, focus, textarea

我得到了这个代码：

```
<textarea id="status" placeholder="Write here..." name="new_entry"></textarea> 
```

和这个：

```
$('#status').focus(function() {
    alert('focused!');
}); 
```

我希望在 textarea 关注时启动警报，但它不起作用......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T17:56:31.607

[这是工作小提琴。](http://jsfiddle.net/X6HDZ/1/)

HTML

```
<textarea id="status" placeholder="Write here..." name="new_entry"></textarea> 
```

JS

```
$('document').ready(function(){
    $('#status').focus(function() {
        alert('focused!');
    });
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-03-22T07:21:13.280

如果您尝试绑定焦点的文本区域是动态加载的[使用 ajax 或其他东西]，那么您必须绑定焦点的实时事件。像这样的东西

```
$('#status').live('focus', function() {
alert('focused!'); 
```

});

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-27T18:05:54.243

尝试这个：

```
$(function(){
    $('#status').focus(function() {
        alert('focused!');
    });
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-27T18:03:45.957

您的 jquery 编写正确。看到这个类似的[小提琴](http://jsfiddle.net/UFvA2/)。检查调试器（在 Chrome 或 Firebug 中），是否`focus`调用了该方法？您可以尝试将代码放入`$('document').ready()`函数中。

```
<textarea id="status" placeholder="Write here..." name="new_entry"></textarea>
<textarea id="status2" placeholder="Write here..." name="new_entry"></textarea>

$('#status').focus(function() {
    $('#status2').val("wheee");
}); 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2017-05-03T17:03:29.870

试试这个：

```
$(function(){
    $('#status').click(function() {
        alert('focused!');
    });
}); 
```

希望它会有所帮助

# c++ - 使用 3d 对象为图形正确设置坐标

> ID：15665934
> 
> 赞同：0
> 
> 时间：2013-03-27T17:53:41.833
> 
> 标签：c++, visual-c++, opengl, graphics, 3d

我在进行这种修改时遇到了困难。我想将 2 个实体（此处称为手指）放在一起，以便在按下“o”或“c”键时它们可以打开和关闭。我无法获得正确的坐标，因此它们可以靠近绿色物体。所以它看起来像一只有 2 个手指的手。

这是所需输出的链接[http://www.tinyuploads.com/gallery/view/zO6rYg](http://www.tinyuploads.com/gallery/view/zO6rYg)

```
#include <cstdlib>
#include <cmath>
#include <vector>
#include <iostream>
#ifdef __APPLE__
#include <GLUT/glut.h>
//#include <gl.h>
//#include <glut.h>
#else
#  include <GL/glut.h>
#endif
using namespace std;
#define ESC 27
static GLfloat red[]={1,0,0}, green[]={0,1,0}, blue[]={0,0,1};
static int shoulder=0, elbow=0, finger1 = 0, finger2 = 0;
static int xrot=0, yrot=0, zrot=0;
static GLfloat xshift=-1.0, yshift=0.0, zoom=-3.0;

/* some basic GL initialization */
void init()
{
    glClearColor(1.0,1.0,1.0,0.0);
    glShadeModel(GL_FLAT);
    glEnable(GL_DEPTH_TEST);
    glEnable(GL_CULL_FACE);
    glCullFace(GL_BACK);
}

/* The display callback */
/* Put the "fingers" code somewhere in this function*/
void draw_stuff()
{
    glClear(GL_COLOR_BUFFER_BIT|GL_DEPTH_BUFFER_BIT);
    glLoadIdentity();
    glTranslatef(0.0,0.0,-5.0);
    glPushMatrix();
    glTranslatef(xshift,yshift,zoom);
    glRotatef((GLfloat)xrot,1.0,0.0,0.0);
    glRotatef((GLfloat)yrot,0.0,1.0,0.0);
    glRotatef((GLfloat)zrot,0.0,0.0,1.0);

    glColor3fv(red);
    glPushMatrix();
    glTranslatef(-1.0,0.0,0.0);
    glRotatef((GLfloat)shoulder,0.0,0.0,1.0);
    glTranslatef(1.0,0.0,0.0);
    glPushMatrix();
    glScalef(2.0,0.4,1.0);
    glutSolidCube(1.0);
    glPopMatrix();

    glColor3fv(green);
    glTranslatef(1.0,0.0,0.0);
    glRotatef((GLfloat)elbow,0.0,0.0,1.0);
    glTranslatef(1.0,0.0,0.0);
    glPushMatrix();
    glScalef(2.0,0.4,1.0);
    glutSolidCube(1.0);
    glPopMatrix();

    glColor3fv(blue);
    glTranslatef(1.0,0.2,0.0);
    glRotatef((GLfloat)finger1,0.0,0.0,1.0);
    glRotatef((GLfloat)finger2,0.0,0.0,1.0);
    glTranslatef(1.0,0.0,0.0);
    glPushMatrix();
    glScalef(2.0,0.4,1.0);
    glutSolidCube(0.25);
    glPopMatrix();

    glColor3fv(blue);
    glTranslatef(-1.0,0.0,1.0);
    glRotatef((GLfloat)finger1,0.0,0.0,1.0);
    glRotatef((GLfloat)finger2,0.0,0.0,1.0);
    glTranslatef(1.0,0.0,0.0);
    glPushMatrix();
    glScalef(2.0,0.4,1.0);
    glutSolidCube(0.25);
    glPopMatrix();

    glPopMatrix();
    glPopMatrix();
    glutSwapBuffers();
}

/* the window-reshape callback */
void reshape(int w, int h)
{
    GLfloat myFov = 65.0, myNear = 1.0, myFar = 30.0;
    glViewport(0,0,(GLsizei)w,(GLsizei)h);
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    gluPerspective(myFov,(GLfloat)w/(GLfloat)h, myNear, myFar);
    glMatrixMode(GL_MODELVIEW);
    glLoadIdentity();
}

/* The basic keyboard controls, callback for glutKeyboardFunc() */
void kb(unsigned char key, int x, int y)
{
    switch(key)
    {
        case 's':
            shoulder=(shoulder+5)%360;
            glutPostRedisplay();
            break;
        case 'S':
            shoulder=(shoulder-5)%360;
            glutPostRedisplay();
            break;
        case 'e':
            elbow=(elbow+5)%360;
            glutPostRedisplay();
            break;
        case 'E':
            elbow=(elbow-5)%360;
            glutPostRedisplay();
            break;

        case 'C' |'c':
            /* close the "hand" */
            finger1=(finger1+5)%360;
            finger2=(finger2+5)%360;
            glutPostRedisplay();
            break;
        case 'O' | 'o':
            /* open the "hand" */
            finger1=(finger1-5)%360;
            finger2=(finger2-5)%360;
            glutPostRedisplay();
            break;
        case 'x':
            xshift+=.25;
            glutPostRedisplay();
            break;
        case 'X':
            xshift-=.25;
            glutPostRedisplay();
            break;
        case 'y':
            yshift+=.25;
            glutPostRedisplay();
            break;
        case 'Y':
            yshift-=.25;
            glutPostRedisplay();
            break;
        case 'r':
        case 'R':
            xrot=yrot=zrot=shoulder=elbow=0;
            xshift=-1.0;
            yshift=0.0;
            zoom=-3.0;
            glutPostRedisplay();
            break;
        case 'z':
            zrot=(zrot-1)%360;
            glutPostRedisplay();
            break;
        case 'Z':
            zrot=(zrot+1)%360;
            glutPostRedisplay();
            break;
        case ESC:
            exit(0);
            break;
        default:
            break;
    }
}

/* The "special" keyboard controls, callback for glutSpecialFunc() */
void skb(int key, int x, int y)
{
    switch(key)
    {
        case GLUT_KEY_UP:
            zoom+=1;
            glutPostRedisplay();
            break;
        case GLUT_KEY_DOWN:
            zoom-=1;
            glutPostRedisplay();
            break;
        case GLUT_KEY_RIGHT:
            yrot=(yrot-1)%360;
            glutPostRedisplay();
            break;
        case GLUT_KEY_LEFT:
            yrot=(yrot+1)%360;
            glutPostRedisplay();
            break;
        case GLUT_KEY_PAGE_UP:
            xrot=(xrot-1)%360;
            glutPostRedisplay();
            break;
        case GLUT_KEY_PAGE_DOWN:
            xrot=(xrot+1)%360;
            glutPostRedisplay();
            break;
        default:
            break;
    }
}

void printInteraction(void)
{

    cout << "s/S:   Positive/negative shoulder rotation" << endl;
    cout << "e/E:   Positive/negative elbow rotation" << endl
    << "O/C:    Open/Close the hand -- YOU GET TO IMPLEMENT THIS" << endl
    << "x/X:    Positive/negative X-axis shift of the model" << endl
    << "y/Y:    Positive/negative Y-axis shift of the model" << endl
    << "UP/DOWN ARROWS: (zoom) Z-axis shift of the model" << endl
    << "LEFT/RIGHT ARROWS:  Y-axis rotations" << endl
    << "PAGE UP/DOWN:   X-axis rotations" << endl
    << "ESC:    exit" << endl;
}

int main(int argc, char **argv)
{
    int winWidth = 800, winHeight = 600, winPosX = 100, winPosY = 100; // OpenGL window
    printInteraction();
    glutInit(&argc,argv);
    glutInitDisplayMode(GLUT_DOUBLE|GLUT_RGB|GLUT_DEPTH);
    glutInitWindowSize(600,400);
    glutInitWindowPosition(0,0);
    glutCreateWindow("window");
    init();
    glutDisplayFunc(draw_stuff);
    glutReshapeFunc(reshape);
    glutKeyboardFunc(kb);
    glutSpecialFunc(skb);
    glutMainLoop();
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T19:48:45.503

您的`glPush/PopMatrix()`调用序列显示模型中缺少层次结构。

它应该是这样的（我缩进了伪代码来说明发生了什么）：

```
glPushMatrix();
  // do stuff to position shoulder
  // draw shoulder
  glPushMatrix();
    // do stuff to position elbow
    // draw elbow
    glPushMatrix();
      // do stuff to position finger1
      // draw finger1
    glPopMatrix();
    glPushMatrix();
      // do stuff to position finger2
      // draw finger2
    glPopMatrix();
  glPopMatrix(); // elbow
glPopMatrix(); // shoulder 
```

希望有帮助。

# php - 在表格中插入数据

> ID：15665935
> 
> 赞同：-1
> 
> 时间：2013-03-27T17:53:49.483
> 
> 标签：php

我有这段代码可以从数据库中选择和输出数据

```
<?php

require('system/connect.php'); //load the connection file

$sql = ("SELECT * FROM `movie`"); // add mysql code to a variable. In this case it will    select ALL columns from the database.

$query = mysql_query($sql); //run the query contained within the variable.

while ($row = mysql_fetch_array($query)) { //store each single row from the database in an array named $row. While there are any rows left, loop through and execute the following code:

$id = $row['movie_id']; //gets name from DB for a single row
$name = $row['movie_name']; //gets age from DB for a single row
$category = $row['movie_category']; //gets age from DB for a single row

//Following code outputs the data to the webpage:

echo $id;

echo $name;

echo $category;
};
?> 
```

页面显示：1titanicromance2zoroaction3blood diamondsaction

我需要一种方法来制作表格或数组并将数据直接插入其中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:00:10.243

为 Table 添加 HTML 应该可以解决问题。虽然，混合 PHP 和 HTML 是一种糟糕的编码。

```
<?php

require('system/connect.php'); //load the connection file

$sql = ("SELECT * FROM `movie`"); // add mysql code to a variable. In this case it will    select ALL columns from the database.

$query = mysql_query($sql); //run the query contained within the variable.

echo '<table>';

while ($row = mysql_fetch_array($query)) { //store each single row from the database in an array named $row. While there are any rows left, loop through and execute the following code:

$id = $row['movie_id']; //gets name from DB for a single row
$name = $row['movie_name']; //gets age from DB for a single row
$category = $row['movie_category']; //gets age from DB for a single row

//Following code outputs the data to the webpage:
echo '<tr>';

echo '<td>' . $id . '</td>';

echo '<td>' . $name . '</td>';

echo '<td>' . $category . '</td>';

echo '</tr>';

};

echo '</table>';

?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T18:00:34.823

你的意思是HTML表格吗？然后它看起来像这样

```
<?php

require('system/connect.php'); //load the connection file

$sql = ("SELECT * FROM `movie`"); // add mysql code to a variable. In this case it will    select ALL columns from the database.

$query = mysql_query($sql); //run the query contained within the variable.

if (mysql_num_rows($query)) { // if there is some rows in result
    echo "<table>"; // starting HTML table
    while ($row = mysql_fetch_array($query)) { //loop through the result                           
       echo "<tr>".
                "<td>".$row['movie_id']."</td>". 
                "<td>".$row['movie_name']."</td>".
                "<td>".$row['movie_category']."</td>".
            "</tr>"; 
    }
    echo "</table>";// finishing HTML table
}
?> 
```

**注意：**不要使用`mysql_*`函数。它们已被弃用。请改用[PDO](http://www.php.net/manual/en/class.pdo.php)或[Mysqli](http://www.php.net/manual/en/book.mysqli.php)。

# c++ - 我应该始终使用带有自己索引的一维向量，还是多维向量可以？

> ID：15665939
> 
> 赞同：1
> 
> 时间：2013-03-27T17:53:52.087
> 
> 标签：c++, vector, multidimensional-array

我正在存储和生成一些自然用维度 > 1 表示的数据。但是，我看到许多答案建议程序员使用具有自己的自定义索引的一维向量来表示多个维度。我的问题是：仅使用一维可以获得什么？

在我当前的项目中，性能是一个优先事项（我首先了解代码，然后是配置文件，但是这个项目正在从另一种语言导入到 C++ 中以提高速度）。我可以看到只有一个矢量对象可以减少开销，但它是否比频繁计算索引要多得多？我看到一个答案提到使用嵌套向量：

```
vector < vector<int> > 
```

导致大量调用`new`. 我可以看出这是多么令人不安，这是真的吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-27T18:01:05.680

首先，a`std::vector<std::vector<int>>`可以有不同大小的内部向量。但是，我假设您正在专门讨论使用这种类型来模拟 2D 数组。假设您在创建向量时设置了向量的大小，您可能不需要担心动态分配的数量，因为这一切都是一次性发生的。

向量在内部分配其元素的数组。因此，外部向量分配了一个向量数组，而每个内部向量都分配了一个`int`s 数组。你可以这样想：

```
┌─────┐
│ vec │
└──╂──┘
   ┃
   ▼
┌─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┐
│ vec │ vec │ vec │ vec │ vec │ vec │ vec │ vec │ vec │
└──╂──┴──╂──┴──╂──┴──╂──┴──╂──┴──╂──┴──╂──┴──╂──┴──╂──┘
   ┃     ┗━━━━━━━━━━┓
   ▼                ▼
┌─────┬─────┬┄   ┌─────┬─────┬┄
│ int │ int │    │ int │ int │
└─────┴─────┴┄   └─────┴─────┴┄ 
```

如您所见，`int`s 的数组彼此完全分开。它们可能位于完全不同的内存位置。这称为碎片。它们几乎肯定不会位于单个连续的内存块中。因此，跨 2D 矢量的不同“行”访问元素可能会导致缓存未命中。

但是，如果您分配 s 的单个向量`int`并进行自己的二维索引，则您的内存布局更像这样：

```
┌─────┐
│ vec │
└──╂──┘
   ┃
   ▼
┌─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┬┄
│ int │ int │ int │ int │ int │ int │ int │ int │ int │
└─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴┄ 
```

s现在`int`存储在单个连续的内存块中。任何访问都可能具有相似的内存地址并导致缓存命中。这可能会给您带来性能提升。

# html - 同一个 HTML5 全屏上的两个 iframe

> ID：15665942
> 
> 赞同：0
> 
> 时间：2013-03-27T17:54:16.143
> 
> 标签：html

我正在使用 HTML5 的全屏功能在 iframe 中扩展 youtube 嵌入式视频。我需要做的是在第一个 iframe 的顶部显示另一个 iframe，同时全屏显示。我正在查看 z-index 但没有成功。

代码示例：

```
<iframe src="smiley.png" id="image"></iframe>

<!-- 1\. The <iframe> (and video player) will replace this <div> tag. -->
<div id="player" align="center"></div><br>
<button onclick="goFullscreen('player'); return false">Fullscreen</button> 
```

另外（javascript全屏）：

```
function goFullscreen(id) {
      // Get the element that we want to take into fullscreen mode
      var element = document.getElementById(id);

      if (element.mozRequestFullScreen) {

        element.mozRequestFullScreen();
      } else if (element.webkitRequestFullScreen) {

        element.webkitRequestFullScreen();
     }
    } 
```

最后（CSS）：

```
.iframeclass {
      position: absolute;
      top: 0; left: 0;
      width:100%;
      height:100%;
  }
  iframe.image {
    position: relative;
    left:50px;
    top:50px;
    z-index: 3;
  }
  iframe.player {
    position: relative;
    left:50px;
    top:50px;
    z-index: 1;
  } 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:00:26.323

如果它是你所说的 youtube 视频，你可以通过在 iframe 代码（HTML 属性，而不是 CSS）中添加`wmode=transparent`, 或来解决它。`wmode=opaque`我之前遇到过这个问题，所以我找到了解决方案。类似的东西`<iframe ... ... wmode=transparent>`。

这实际上是 Flash 的问题，我猜不仅仅是 YouTube。 [这](https://stackoverflow.com/a/6226708/2157739)是堆栈溢出的答案。

# javascript - 在 HTML5 画布中插入不带扩展名的图像

> ID：15665946
> 
> 赞同：1
> 
> 时间：2013-03-27T17:54:43.470
> 
> 标签：javascript, html, image, canvas

如何在 HTML5 画布中插入没有扩展名的图像？

我想获取一个存在于画布中的页面上的图像，该图像是我在同一页面中创建的，目的是访问它的像素数组。它适用于具有 .png 之类的扩展名的图像，但不适用于没有扩展名的图像。我该如何解决我的问题？

编辑：在 html 中，我有：

```
<img id="id1" src="/blabla/test.png" />
<img id="id2" src="/tmp/qsdqsd" /> 
```

我使用这个脚本：

```
jQuery('body').append('<canvas id="canvas"></canvas>');
var img = new Image();
img.src = jQuery("#id1").attr("src");
var context = document.getElementById('canvas').getContext('2d'); 
```

context.drawImage(img, 0, 0);

它适用于第一个 img 但不适用于第二个。

# php - 使用 php 从 mySQL 数据库创建 xml 时出错

> ID：15665947
> 
> 赞同：0
> 
> 时间：2013-03-27T17:54:45.413
> 
> 标签：php, mysql, xml, google-maps

我正在关注谷歌的谷歌地图教程：

[https://developers.google.com/maps/articles/phpsqlajax_v3?hl=es](https://developers.google.com/maps/articles/phpsqlajax_v3?hl=es)

我这样格式化我的代码：

```
echo '<markers>';

// Iterate through the rows, adding XML nodes for each
for($i = 0; $i< $breweryNum; $i++ ){

    echo '<marker ';
    echo 'name="' . parseToXML($row['beerBrewery']) . '" ';
    echo 'lat="' . $row['lat'] . '" ';
    echo 'lng="' . $row['longi'] . '" ';
    echo '/>';

}

// End XML file
echo '</markers>'; 
```

但是当我运行 php 文件来测试我的 xml 时，我得到了这个：

```
XML Parsing Error: not well-formed
Location: http://beerportfolio.com/getMapMarkers.php
Line Number 1, Column 18:<markers><marker <br />
-----------------^ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T18:02:53.633

您是使用 nl2br 还是 some 来输出结果字符串？

很明显的错误信息，在“ `<markers><marker`”输出标签“ `<br />`”之后，但这里应该是你的“名称”属性。无论如何，您可以使用以下代码来不输出错误的内容：

```
$out = '<markers>';
for($i = 0; $i< $breweryNum; $i++ ){

    $out .= '<marker ';
    $out .= 'name="' . parseToXML($row['beerBrewery']) . '" ';
    $out .= 'lat="' . $row['lat'] . '" ';
    $out .= 'lng="' . $row['longi'] . '" ';
    $out .= '/>';

}
$out .= '</markers>'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T18:03:21.383

首先，XML 文件通常以它们的类型声明开始。这不是必需的，但很有帮助（即`<?xml version="1.0" encoding="UTF-8" ?>`）

您似乎已`<br />`在您的 xml 中输出。您可能会发现做类似的事情更简单

```
$strOutput = '<markers>'; 
```

进而

```
$strOutput .= '<marker name="' . parseToXML($row['beerBrewery']) . '" lat="' . $row['lat'] . '" lng="' . $row['longi'] . '" />'; 
```

并关闭

```
$strOutput = '</markers>';
echo $strOutput; 
```

# jquery - 如何刷新一个div

> ID：15665948
> 
> 赞同：-1
> 
> 时间：2013-03-27T17:54:49.403
> 
> 标签：jquery, html, refresh

我有下面的DIV：

`<div id=conteudo></div>`

```
var div= document.getElementById("conteudo");
div.setAttribute("height","55"); 
```

我想刷新 div，有没有办法用 jquery 做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T17:57:13.677

```
<div id="conteudo"></div>

$(document).ready(function(){
 $('#conteudo').css("height", "55px");
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-01T16:31:13.640

我正在使用 Jquery，这对我有用。（重新加载表）

```
$('table#table_id').load(window.location.href + ' table#table_id'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T17:57:03.757

是否要刷新来自服务器的 div 中的内容？如果是这样，您可以使用 jQuery 中的 $.load。

[http://api.jquery.com/load/](http://api.jquery.com/load/)

更具体地说，在“加载页面片段”部分下......

# iphone - Objective c - 表格视图内的按钮防止表格滚动

> ID：15665949
> 
> 赞同：3
> 
> 时间：2013-03-27T17:54:49.553
> 
> 标签：iphone, ios, objective-c, uitableview, uibutton

我有一个每行有两个按钮的 tableView，用户当然可以滚动查看更多行，或者可以点击按钮查看项目详细信息。

**问题：**

当用户向上或向下滑动手指时，表格滚动良好，但是当用户将手指按住按钮超过一秒钟然后向上或向下移动手指时，表格不会滚动。我不想要这种行为，我希望 tableview 将获得第一优先级，所以它会滚动并且按钮事件不会触发。

我怎样才能防止这种情况发生？为按钮设置目标的代码是这样的：

```
[cell.buttonLeft addTarget:self action:@selector(buttonTapped:) forControlEvents:UIControlEventTouchUpInside]; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-27T18:04:53.640

使用`UITapGestureRecognizer`而不是使用`addTarget:`

例子：

```
UIButton *button = [UIButton buttonWithType:UIButtonTypeRoundedRect];

UITapGestureRecognizer *tapGestureRecognizer = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(aMethod:)];
[button addGestureRecognizer:tapGestureRecognizer];
[button setTitle:@"Show View" forState:UIControlStateNormal];

button.frame = CGRectMake(0, 0, 160.0, 40.0);
[cell.contentView addSubview:button];

-(void)aMethod:(UITapGestureRecognizer * )sender{

    if(sender.state == UIGestureRecognizerStateEnded)
    {
         NSLog(@"triggered");
    }
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-27T22:03:14.977

如果您使用的是 IB，则可以向单元格（在 IB 中）添加一个按钮，修改其标签，然后将目标和操作添加到带有该标签的按钮。

```
UIButton *button = (UIButton *)[cell.contentView viewWithTag:1002];
    [button addTarget:self action:@selector(buttonTapped:) forControlEvents:UIControlEventTouchUpInside]; 
```

# apache - 为什么未加入域时 mod_auth_kerb 不起作用？

> ID：15665951
> 
> 赞同：-1
> 
> 时间：2013-03-27T17:55:02.990
> 
> 标签：apache, active-directory, kerberos, samba

[我正在尝试使用这些](http://acksyn.org/?p=460)说明使用 apache 设置 Active Directory Kerberos 身份验证。

我希望 apache 能够在不通过 Samba 将 apache 机器加入域的情况下针对 AD 对用户进行身份验证。我对 Kerberos 的理解是，我的 apache 服务器应该不需要加入域（我认为上面的说明只是这样做，以便他们可以轻松生成 keytab）。

但实际上，如果我让 apache 主机离开域，它将无法工作。只要它保持连接，它就可以正常工作。当我离开并尝试访问我的安全 URL 时，我收到了凭据挑战，但我输入的凭据不被接受。在这种情况下，apache 日志中会出现以下内容：

```
[Wed Mar 27 12:33:38 2013] [debug] src/mod_auth_kerb.c(1939): [client 192.168.201.52] kerb_authenticate_user entered with user (NULL) and auth_type Kerberos
[Wed Mar 27 12:33:43 2013] [debug] src/mod_auth_kerb.c(1939): [client 192.168.201.52] kerb_authenticate_user entered with user (NULL) and auth_type Kerberos
[Wed Mar 27 12:33:43 2013] [debug] src/mod_auth_kerb.c(1031): [client 192.168.201.52] Using HTTP/centosjb.iga.local@ABC.LOCAL as server principal for password verification
[Wed Mar 27 12:33:43 2013] [debug] src/mod_auth_kerb.c(735): [client 192.168.201.52] Trying to get TGT for user myuser@ABC.LOCAL
[Wed Mar 27 12:33:44 2013] [debug] src/mod_auth_kerb.c(645): [client 192.168.201.52] Trying to verify authenticity of KDC using principal HTTP/centosjb.iga.local@ABC.LOCAL
[Wed Mar 27 12:33:44 2013] [debug] src/mod_auth_kerb.c(660): [client 192.168.201.52] krb5_get_credentials() failed when verifying KDC
[Wed Mar 27 12:33:44 2013] [error] [client 192.168.201.52] failed to verify krb5 credentials: Server not found in Kerberos database
[Wed Mar 27 12:33:44 2013] [debug] src/mod_auth_kerb.c(1110): [client 192.168.201.52] kerb_authenticate_user_krb5pwd ret=401 user=(NULL) authtype=(NULL) 
```

这是我的 krb5.conf 文件（我省略了日志文件部分）：

```
[libdefaults]
 default_realm = ABC.LOCAL
 dns_lookup_realm = false
 dns_lookup_kdc = false
 ticket_lifetime = 24h
 renew_lifetime = 7d
 forwardable = true

[realms]
 ABC.LOCAL = {
  kdc = labdc12.abc.local
  admin_server = labdc12.abc.local
 }

[domain_realm]
 .abc.local = ABC.LOCAL
 abc.local = ABC.LOCAL 
```

我有一种感觉，它可能像 DNS 问题一样简单，基于“找不到服务器”消息......即我的 apache 主机只有在加入域时才能解决。但是使用 ping 所有名称进行测试就可以解决问题。谁能解释为什么这不起作用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T21:35:33.307

此主机的 SPN 会随着计算机帐户的删除而被删除（在 Kerberos 数据库中找不到服务器）。最好的方法是：

```
$ net ads join
$ net ads keytab add HTTP 
```

等待它在所有 DC 中复制，您的问题应该会消失。

换句话说：除非没有为该机器帐户注册 SPN，否则您将失败并显示上述消息。有关错误 0x7，请参见[此处](http://technet.microsoft.com/en-us/library/bb463166.aspx)。

# c++ - 您是否应该依靠 IF 语句将除 0 以外的任何其他整数值视为真？

> ID：15665956
> 
> 赞同：1
> 
> 时间：2013-03-27T17:55:16.650
> 
> 标签：c++, visual-c++, if-statement

我正在用 Visual C++ 编写一个相当大的项目，我想知道是否有办法清理当前看起来像这样的错误检查代码：

```
// A header full of error codes like this
#define NO_ERROR            0x0000
#define CASUAL_ERROR        0x0001
#define ERROR_IN_THE_MATRIX 0x0015 
```

-

```
// An example source file
int error;
error = openGLObj->Initialize();
if (!(error == NO_ERROR)
    return error; 
```

如您所见，当您几乎在每次函数调用之后都必须编写一个错误检查代码时，它会占用大量屏幕空间。

所以我尝试了这样的事情：

```
// Second example source file
int error;
error = fbxParser->ParseVertexData(...);
if (error)
    return error; 
```

它似乎至少在 Visual C++ 中有效，因为如果没有错误，我总是返回 NO_ERROR (int 0)，并且任何其他整数似乎都将布尔值设置为 true。

后者是正确的做事方式吗？或者我以后会遇到问题并且必须花费数小时（再次）转换我的 if 语句？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T18:07:17.037

这主要是风格和个人喜好的问题。

我个人不喜欢将可以具有多个有意义的非零值的表达式视为条件。例如，我会写：

如果（指针！= NULL）

而不是

如果（！ptr）

即使两者的意思完全相同。相反，如果表达式*是*“逻辑上”的布尔值（无论它是否属于类型`bool`），我更喜欢直接将其用作条件：

```
if (isdigit(foo)) 
```

而不是

```
if (isdigit(foo) != 0) 
```

和：

```
bool cond;
// ...
if (cond)
// or
if (!cond) 
```

而*不是*

```
if (cond == true)
if (cond == false) 
```

所以在你的情况下，我会写：

```
if (error != NO_ERROR)
    return error; 
```

（请注意，我使用的是`!=`运算符，而不是应用于运算符`!`的结果`==`）。

显式比较为读者提供了更多上下文来理解是什么`error`；您将其与`NO_ERROR`、 不与`0`、 或`0.0`、 或`NULL`、 或进行比较`'\0'`。

如果`error`是纯布尔值，我会写`if (error)`.

正如我所说，这是个人喜好问题。鉴于您的定义，这：

```
if (error) 
```

完全*等同*于：

```
if (error != NO_ERROR) 
```

并且您可以依靠它按预期工作。语句中的条件`if`被隐式转换为`bool`，这本质上等同于比较它是否不等于`0`。

因此，您不必担心`if (error)`行为不符合您的预期。对于现代编译器，您也不必担心编译器会为任何一种形式生成效率较低的代码。使用您认为更具可读性的任何内容。（不可写；请记住，代码的读取次数比写入次数要多得多。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-27T18:03:59.183

是的，布尔上下文中的整数/浮点数在非零时被解释为真。当指针不为空时，指针被解释为真。但请注意，您也可以写`(error != NO_ERROR)`而不是`!(error == NO_ERROR)`.

通常异常和 RAII 习惯用法可以简化错误处理。它们可能比这些句法变化更有效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-27T17:57:52.827

假设 NO_ERROR 始终为零，那么您正在做的事情很好。

# java - 数组错误 java.lang.ArrayIndexOutOfBoundsException

> ID：15665957
> 
> 赞同：1
> 
> 时间：2013-03-27T17:55:17.933
> 
> 标签：java, arrays

我对 Java 很陌生，目前正在学习数组。所以我正在制作这个小程序来输入使用的汽油和行驶的英里数来计算每加仑英里数，但是每当我运行该程序时，我都会在第 21 行得到一个错误（miles [counter] = input.nextInt（）;）错误说：

```
Exception in thread "main" java.lang.ArrayIndexOutOfBoundsException: 0
at GasMileage.inputGasAndMiles(GasMileage.java:21)
at GasMileage.main(GasMileage.java:44) 
```

我不知道这意味着什么，也不知道如何解决它，如果我能得到一些帮助，那就太好了。

```
int counter = 0;
int[] gallons, miles = new int[trips];

public void inputGasAndMiles(){

    for(counter = 0; counter <= trips; counter++){
        System.out.print("\nInput miles traveled: ");
        miles[counter] = input.nextInt();

        System.out.print("Input gallons of fuel used: ");
        gallons[counter] = input.nextInt();
    }
} 
```

编辑

```
public void askTrips(){
    System.out.print("How many trips would you like to calculate for: ");
    trips = input.nextInt();
} 
```

堆栈跟踪：

```
public static void main(String[]args){
    GasMileage gas = new GasMileage();

    gas.askTrips();
    gas.inputGasAndMiles();
    gas.calculate();
    gas.display();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T17:56:07.067

它应该是`for (counter = 0; counter < trips; counter++)`

因为，数组索引从零开始，所以最大索引`(size-1)`不会`size`

**编辑：**

```
int trips= 0; //any +ve value
int[] gallons =  new int[trips], miles = new int[trips];

public void inputGasAndMiles(){

for(counter = 0; counter < trips; counter++){
    System.out.print("\nInput miles traveled: ");
    miles[counter] = input.nextInt();

    System.out.print("Input gallons of fuel used: ");
    gallons[counter] = input.nextInt();
} 
```

}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T17:58:07.767

改变

```
for(counter = 0; counter <= trips; counter++) 
```

至

```
for(counter = 0; counter < trips; counter++) 
```

数组的索引从 0 开始到（长度 -1 ）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T17:57:10.653

尝试这个

```
int counter = 0;
int[] gallons, miles = new int[trips];

public void inputGasAndMiles() {
    for(counter = 0; counter < trips; counter++) {
        System.out.print("\nInput miles traveled: ");
        miles[counter] = input.nextInt();

        System.out.print("Input gallons of fuel used: ");
        gallons[counter] = input.nextInt();
    }   
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-27T17:56:07.240

```
for(counter = 0; counter <= trips; counter++) 
```

将其更改为：

```
for(counter = 0; counter < trips; counter++) 
```

`gallons`你的数组的大小是`trips`。因为第一个索引以开头，`0`所以`gallons`数组的最后一个索引将是`trips-1`。在您的代码中，当 for 循环中的 (counter == trips) 变为真时，您试图访问索引处的元素`trips`，这导致`ArrayIndexOutOfBounException`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-27T17:56:29.363

改变这个

```
counter <= trips 
```

对此

```
counter < trips 
```

在那里的`for`构造中。

# android - 通用图像加载器有放大/缩小选项吗？

> ID：15665958
> 
> 赞同：1
> 
> 时间：2013-03-27T17:55:19.973
> 
> 标签：android, image, zooming, pinch, universal-image-loader

我在我的应用程序中应用 costras 通用图像加载器。但是，我似乎无法在任何地方找到缩放选项。它包括它吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-27T18:28:21.007

使用 PhotoView 库代替 ImageView。

[https://github.com/chrisbanes/PhotoView](https://github.com/chrisbanes/PhotoView)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-27T17:59:07.420

下面的链接中提出了有关缩放的问题。

UIL 不提供任何 ImageView 缩放功能。

[https://github.com/nostra13/Android-Universal-Image-Loader/issues/66](https://github.com/nostra13/Android-Universal-Image-Loader/issues/66)。

用于缩放图像

[Android imageView 放大和缩小](https://stackoverflow.com/questions/6650398/android-imageview-zoom-in-and-zoom-out)

[如何获得图像的缩放功能？](https://stackoverflow.com/questions/2537238/how-can-i-get-zoom-functionality-for-images)

# android - 使用 Facebook 应用程序 access_token 可以访问哪些类型的信息？

> ID：15665959
> 
> 赞同：0
> 
> 时间：2013-03-27T17:55:21.780
> 
> 标签：android, facebook, facebook-access-token

我正在编写一个 Android 应用程序，其中除其他外，规范要求特定 Facebook 页面上的所有帖子都可以在`ListView`. 到目前为止，这一切正常，但今天我发现以前的开发人员使用用户 access_token 来访问 Open Graph API 以访问此页面。我发现这是因为 access_token 已过期。

从那时起，我就按照

[https://developers.facebook.com/docs/opengraph/howtos/publishing-with-app-token/](https://developers.facebook.com/docs/opengraph/howtos/publishing-with-app-token/) [https://developers.facebook.com/docs/howtos/login/login-as-app/](https://developers.facebook.com/docs/howtos/login/login-as-app/)

获取应用访问令牌；但是，当我尝试访问这样的页面提要时：

https://graph.facebook.com/[PAGE]/posts?access_token=[APP_ID]|[OTHER_DATA]

我得到：

```
{
    error: {
        message: "An access token is required to request this resource.",
        type: "OAuthException",
        code: 104
    }
} 
```

但是，以任何方式砍掉访问令牌都会导致

```
{
    error: {
        message: "Invalid OAuth access token signature.",
        type: "OAuthException",
        code: 190
    }
} 
```

很明显，Facebook 识别了访问令牌但拒绝了它。我在上面的第一个 Facebook 开发者链接中注意到

> 请注意，应用访问令牌用于权限允许的**发布**目的`publish_actions`。您将无法使用应用访问令牌检索有关具有给定 ID 的状态更新帖子的信息。相反，您应该为此目的使用用户访问令牌。

我想知道的是，应用令牌可以执行哪些操作，以及一个应用令牌不可能执行哪些操作？

# javascript - 我可以使用 testacular 来测试不在我的本地主机上的网页吗？

> ID：15665960
> 
> 赞同：10
> 
> 时间：2013-03-27T17:55:24.180
> 
> 标签：javascript, karma-runner

我可以使用 testacular 来测试不在我的本地主机上的网页吗？外部应用程序是使用 angularJs 开发的

在我的测试中，我尝试做

```
browser().navigateTo('<test app which is not on localhost>'); 
```

我无法验证测试中的 url。我收到此错误：

```
$location.url()

TypeError: Object [object Object] has no method 'injector'
    at Object.<anonymous> (<localhost path>/angular-scenario.js:25407:30) 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-25T04:22:25.610

我遇到了同样的问题，并通过在 karma-e2e.conf 中添加以下两行来解决它：

```
proxies = {'/': 'http://localhost:9000/'}; // assume your app is running on port 9000

urlRoot = '/_karma_/';  // important, could be any non-trivial path 
```

# android - 升级的 Android 应用程序没有获得新的版本名称

> ID：15665961
> 
> 赞同：0
> 
> 时间：2013-03-27T17:55:30.887
> 
> 标签：android, version, upgrade, google-play, android-library

我正在使用此代码获取应用程序的“版本名称”，然后将其发送到我的服务器： `String appversion = mContext.getPackageManager().getPackageInfo(act.getPackageName(), 0).versionName;`

当我在手机上安装了应用程序的 v1.0 并通过 Google Play 将应用程序升级到 v1.0.1 时，应用程序仍将“1.0”作为`versionName`.

如果我“强制关闭”应用程序然后打开它，它仍然报告“1.0”。

如果我“强制关闭”和“清除数据”，它仍然报告“1.0”。

如果我从手机上卸载该应用程序，然后下载 v1.0.1，**则版本名称才会报告为 "1.0.1"**。

任何想法为什么会发生这种情况或我能做些什么来解决这个问题？

编辑：这个应用程序是连接到 Android 库的几个目标/apk 之一。Android 库中有一个 Manifest，每个目标 apk 中有一个 Manifest。我的理解是每个 apk 都将使用它自己的清单（并且不正确的版本号也与库清单中的数字不匹配）但我想我应该提到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T20:55:51.667

首先检查[这个](http://support.google.com/googleplay/android-developer/answer/113476?hl=en&topic=2365760&ctx=topic)官方帮助！

您提到了 versionName，但有助于区分应用程序版本的是您的清单文件中定义的**versionCode 。**

因此，如果这是旧版本清单：

```
//...    
package="com.your.app"
android:versionCode="1" 
android:versionName="MyApp V1.0"
//... 
```

...新的应该是这样的：

```
//...    
package="com.your.app"
android:versionCode="2" 
android:versionName="MyApp V1.1"
//... 
```

另请注意，谷歌需要 12-48 小时才能在线发布新版本。

# javascript - 无法使用 requirejs 为我的代码加载所需的 js 文件

> ID：15665964
> 
> 赞同：0
> 
> 时间：2013-03-27T17:55:34.200
> 
> 标签：javascript, requirejs

在我的 main.js 文件中：

```
define(['require'], function(require) {
    require([
        '../libs/requirejs/plugins/domReady',
        '../core',
        '../ndn.2',
        '../Ndn/Widget'
    ],
    function(domReady) {
        // require('../Ndn/Widget'); // I tried this too, but it doesn't solve my problem

        console.log('Should have required everything...');

        domReady(function() {
            console.log('About to call init()');

            init();
        });
    }
)});

function init() {
    // Begin fetching this widget's delivery settings
    Ndn_Widget.fetchDeliverySettings();

    // ... Other code here ...
} 
```

在我的 Ndn/Widget.js 文件中，我有以下内容：

```
var Ndn_Widget;

define(['require'], function(require) {
    require(['../ndn.2', './ServerInterface'], function() {
        /**
         * An associative array for the different delivery settings
         * @var Object
         */
        var deliverySettings = {};

        Ndn_Widget = {
            fetchDeliverySettings: function() {
                // ... code here
                console.log('Finished defining Ndn_Widget.');
            }
        };
    });
}); 
```

我希望我传递给 main.js 中的 define() 函数的匿名函数只会在“../Ndn/Widget.js”文件加载后执行，但情况并非总是如此。

这是我的 console.log 语句的示例：

```
Should have required everything...
About to call init()
Uncaught TypeError: Cannot call method 'fetchDeliverySettings' of undefined 
Just finished defining Ndn_Widget. 
```

有人可以告诉我我做错了什么吗？先感谢您！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T19:31:43.790

看起来您正在错误地使用`require`and的概念`define`。

*   无需在模块之外定义变量。东西应该从模块中返回，而不是在它们之外修改。
*   听上去`define`是为了定义一段有目的的代码。如果有帮助，请将这些视为您的课程
*   用于`require`抓取您的模块并让它们进行交互。

我已经重写了你的例子来演示

**main.js**

```
require([
    '../libs/requirejs/plugins/domReady',
    '../Ndn/Widget',
    '../core'
], function(domReady, Ndn_Widget) {

    domReady(function() {
        Ndn_Widget.fetchDeliverySettings();
    });

}); 
```

**Ndn/Widget.js**

```
define(function(require) {
    require('../ndn.2');
    require('./ServerInterface');

    var deliverySettings = {};

    return {
        fetchDeliverySettings: function() {

        }
    };
}); 
```

如果您的其他依赖项不是 AMD 模块，并且您依赖于它们的返回值，那么您可能还需要使用[shim 配置选项](http://requirejs.org/docs/api.html#config-shim)。

我也鼓励您重新阅读[有关模块定义的 API 文档](http://requirejs.org/docs/api.html#define)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-28T19:47:26.863

虽然在使用 AMD 时与全局范围进行交互是不受欢迎的，但它仍然是可行的。

我需要该`../Ndn/Widget`模块并错误地期望其嵌套的 require() 逻辑（如下所示）**同步**执行：

```
require(['../ndn.2', './ServerInterface'], function() { 
```

**然而，上述逻辑仅异步执行**（正如“异步模块定义”所建议的那样）。模块中的以下代码`main`...

```
 Ndn_Widget.fetchDeliverySettings(); 
```

在不知道嵌套的 require() 逻辑是否已在`../Ndn/Widget`模块内执行的情况下执行。

解决此问题的一种解决方案是引入一个可由两个模块引用的新模块，例如一个`app`模块，该模块触发一个事件以让另一个模块知道现在定义了全局 Ndn_Widget 变量。

**更新了 main.js 文件：**

```
define(['require', 'app'], function(require, app) {
    require([
        '../libs/requirejs/plugins/domReady',
        '../core',
        '../ndn.2',
        '../Ndn/Widget'
    ],
    function(domReady) {
        console.log('Should have required everything...');

        app.on('ready', function() { // domReady(function() {
            console.log('About to call init()');

            init();
        });
    }
)});

function init() {
    // Begin fetching this widget's delivery settings
    Ndn_Widget.fetchDeliverySettings();

    // ... Other code here ...
} 
```

**更新了 Ndn/Widget.js 文件：**

```
var Ndn_Widget;

define(['app', 'require'], function(require, app) {
    require(['../ndn.2', './ServerInterface'], function() {
        /**
         * An associative array for the different delivery settings
         * @var Object
         */
        var deliverySettings = {};

        Ndn_Widget = {
            fetchDeliverySettings: function() {
                // ... code here
                console.log('Finished defining Ndn_Widget.');
            }
        };

        app.trigger('ready');
    });
}); 
```

# html - mac html 签名问题在 Outlook 上看起来很时髦

> ID：15665965
> 
> 赞同：0
> 
> 时间：2013-03-27T17:55:35.843
> 
> 标签：html, email

我有一个 mac html 签名，在发送给其他 mac 邮件人时看起来非常好。这是它看起来如何正确的一个例子 [http://s1281.photobucket.com/user/israelrodriguez1/media/good_zpsb6ee8f6e.png.html](http://s1281.photobucket.com/user/israelrodriguez1/media/good_zpsb6ee8f6e.png.html)

我遇到的问题是，当我与使用 Outlook 的人一起发送它时，它看起来真的很时髦。这是它在前景上的样子

[http://s1281.photobucket.com/user/israelrodriguez1/media/bad_zps51e90fc2.png.html?sort=3&o=1](http://s1281.photobucket.com/user/israelrodriguez1/media/bad_zps51e90fc2.png.html?sort=3&o=1)

我怎样才能解决这个问题？以下是我的mac html邮件签名，黑点是logo所在的位置

```
 <div id="sig" style="min-height: 75px; line-height: 16px; margin: 6px 0; padding: 13px; border-top: 1px #999999 dotted; border-bottom: 1px #999999 dotted; font-family: 'Lucida Grande', Verdana, Arial, Sans-Serif; font-size: 10px; color: #606F78; min-width: 530px;  white-space: nowrap;" >

    <img src="http://google.com/images/some.jpg" alt="me" style="float: left; width:170px; height:81px;margin-top:-10px;padding: 2px 6px 0 0;"> &emsp;
    <!--end-->

    <strong style="color: #606F78;">FULL NAME</strong> JOB TITLE <br/>
    &emsp;
    <!-- ADDRESS -->
    Address  |  City, NY XXXXX <br/>&emsp;

    telephone | <a href="http://google.com" style="color: #606F78; text-decoration: none; border-bottom: 1px #999999 dotted;">www.google.com</a> <br/>&emsp;

    <a href="http://google.co/" style="color: #606F78; text-decoration: none; border-bottom: 1px #999999 dotted;">Games</a> |

    <a href="http://www.google.com" style="color: #606F78; text-decoration: none; border-bottom: 1px #999999 dotted;">Facebook</a> | 
    <a href="http://google.com" style="color: #606F78; text-decoration: none; border-bottom: 1px #999999 dotted;">LinkedIn</a> |
    <a href="www.google.com" style="color: #606F78; text-decoration: none; border-bottom: 1px #999999 dotted;">Twitter</a> <br /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:02:37.607

所有电子邮件客户端都不擅长显示 HTML。实际上 Outlook 使用（或至少确实使用）Word 来呈现 HTML。不幸的是，使用 CSS 定位元素（就像您使用浮动一样）是一个坏主意。

尝试使用包含两列的表格（是的，我知道）。

# r - 将 Message 用于 file.choose 提示

> ID：15665966
> 
> 赞同：1
> 
> 时间：2013-03-27T17:55:40.457
> 
> 标签：r, prompt

如果我将一个简单的提示粘贴到 R 中以选择这样的文件：

```
message("Choose X")
X<-file.choose()
message("Choose Y")
Y<-file.choose() 
```

一切正常。我收到一条消息，要求我选择 X 以及一个文件选择窗口。

但是，如果我获取相同的代码：

```
source("Choose.R") 
```

文件选择窗口首先打开，只有在选择文件后才会显示消息。如果我在一段长代码中间连续有几个这样的代码，事情很快就会变得混乱。我可以使用“readline”作为提示而不是“message”来避免这种混淆。但我更喜欢使用“消息”。

# c++ - 如何使用正则表达式区分 AAA:BBB 和 AAA:BBB:CCC？

> ID：15665967
> 
> 赞同：0
> 
> 时间：2013-03-27T17:55:44.130
> 
> 标签：c++, regex, boost

说有字符串

A:B:C **A:BC:B** C:D:EC:D:E:F

我想将所有匹配模式“X:Y”的子字符串替换为“X:0:Y”，在这个例子中，它应该是：

A:B:C **A:0:BC:0:B** C:D:EC:D:E:F

是否可以使用一个正则表达式替换来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T18:04:25.950

代替：

```
(^|\s)(.):(.)(?=\s|$) 
```

和

```
\1\2:0:\3 
```

`^|\s`- 空白行的开头
`.`- 通配符
`:`- 冒号
`.`- 通配符
`\s|$`- 空白或行尾
`?=`是先行的，否则`A:B C:D`不会同时匹配。

`\1`- 你放在括号中的第一件事`(^|\s)`
`\2`的匹配字符串 - 你放在括号中的第二件事的匹配字符串 - 1st `(.)`
`\3`- 你放在括号中的第三件事的匹配字符串 - 2nd`(.)`

等的常见替代方法`\1`是`$1`等。

您也可以使用`\w`(word character) 代替`.`您的示例。

**编辑：**

从问题的标题来看，您可能想要匹配一个或多个 ( `+`) 单词字符：

```
(^|\s)(\w+):(\w+)(?=\s|$) 
```

**编辑 2：**固定正则表达式以使用前瞻。

[升压测试](http://liveworkspace.org/code/2xLEch%243)。

# java - 从文本文件中删除一个单词

> ID：15665970
> 
> 赞同：2
> 
> 时间：2013-03-27T17:55:59.720
> 
> 标签：java, file, text

我有一种方法可以以单词列表格式从文本文件中删除单词，但它会不断删除文件中的所有数据而不是特定单词

```
 public static void Option2Method() throws IOException 
 {
   File inputFile = new File("wordlist.txt");
   File tempFile = new File("TempWordlist.txt");

   BufferedReader reader = new BufferedReader(new FileReader(inputFile));
   BufferedWriter writer = new BufferedWriter(new FileWriter(tempFile));

   String lineToRemove = JOptionPane.showInputDialog(null, "Enter a word to remove");
   String currentLine;

   while((currentLine = reader.readLine()) != null)
 {
   String trimmedLine = currentLine.trim();
   if(trimmedLine.equals(lineToRemove)) continue;
   writer.write(currentLine);
 }
   boolean successful = tempFile.renameTo(inputFile);
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:06:48.847

代码必须调用`close()`作者。

确保数据从缓冲区获取到实际文件：

```
 while((currentLine = reader.readLine()) != null)
 {
   String trimmedLine = currentLine.trim();
   if(trimmedLine.equals(lineToRemove)) continue;
   writer.write(currentLine);
 }

 writer.close();
 reader.close(); 
```

考虑使用 try/catch/finally 块来确保即使在`IOException`抛出 an 时也关闭流。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T18:10:11.250

尝试这个：

```
String str = "Sample Line";
String[] words = str.split(" "); 
for(i=0 to i>arr.length)
{
if(str.indexOf(arr[i])!=-1) //checks if the word is present...
str.replace(arr[i],""); //replace the stop word with a blank
space..
} 
```

或者这样：

```
String yourwordline = "dgfhgdfdsgfl Sample dfhdkfl"; 
yourwordline.replaceAll("Sample",""); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T18:10:14.600

尝试这个：

```
public static void removeLineMethod(String lineToRemove) throws IOException {
   File inputFile = new File("wordlist.txt");
   File tempFile = new File("TempWordlist.txt");

   BufferedReader reader = new BufferedReader(new FileReader(inputFile));
   BufferedWriter writer = new BufferedWriter(new FileWriter(tempFile));
   String currentLine;

   while((currentLine = reader.readLine()) != null)
 {
   String trimmedLine = currentLine.trim();
   if(trimmedLine.equals(lineToRemove)) continue;
   writer.write(currentLine + "\n");
 }
   reader.close();
   writer.close();
   inputFile.delete();
   tempFile.renameTo(inputFile);
 } 
```

如果你不删除输入文件，你的重命名将失败，所以关闭流，删除输入文件，然后重命名临时文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-27T18:14:04.320

```
File inputFile = new File("wordlist.txt");
       File tempFile = new File("TempWordlist.txt");

   BufferedReader reader = new BufferedReader(new FileReader(inputFile));
   BufferedWriter writer = new BufferedWriter(new FileWriter(tempFile));

   String lineToRemove = JOptionPane.showInputDialog(null, "Enter a word to remove");
   String currentLine;

 while((currentLine = reader.readLine()) != null)
 {
   String trimmedLine = currentLine.trim();
   if(trimmedLine.equals(lineToRemove)) continue;
   writer.write(currentLine);
   writer.newLine();
 }
   reader.close();
   writer.close();
   inputFile.delete();
   tempFile.renameTo(inputFile);
    } 
```

# java - 我可以用重写替换 URLRewriteFilter 吗？

> ID：15665971
> 
> 赞同：1
> 
> 时间：2013-03-27T17:56:01.943
> 
> 标签：java, rewrite, tuckey-urlrewrite-filter

我的一个项目使用[URLRewriteFilter](http://www.tuckey.org/urlrewrite/)。URLRewriteFilter 有一个重写 xml 文件。重[写给](http://ocpsoft.org/rewrite/)了我编程配置。在我看来，这是一种更优雅的配置方式，我希望使用它们。

我的问题是他们没有足够的文档或 javadoc 页面。

现在我需要尽可能好的文档链接，并知道是否可以使用编程配置。

# php - 图像未存储在数据库 PHP 中

> ID：15665975
> 
> 赞同：1
> 
> 时间：2013-03-27T17:56:08.913
> 
> 标签：php

当用户需要添加事件时，我有此代码，他必须使用上传图片来填写表单信息以进行广告

```
 <form action="newevent.php" method="post">
<table>
<tr>
    <td> Title :</td>
    <td><input type='text' name='title'/></td>
</tr>
<tr>
      <td colspan="4">Add Your Ads 
      <input type='file' name='ads'/>
      </td>
</tr>
</table>
</form> 
```

在 neweventphp 我写了这段代码

```
<?php
$target_folder = "project_img/";
$target_file = $_FILES['ads']['name'];
$target_file_path = $target_folder.$target_file;

if(move_uploaded_file($_FILES['ads']['tmp_name'], "company_img/".$_FILES['ads']['name']))
              {echo "";}

$title=$_POST['title'];

$query1=mysql_query("INSERT INTO event VALUES('','$title','$target_file_path')");

?> 
```

问题是图片没有存储在数据库中:(你能帮我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T18:01:30.863

您需要`enctype='multipart/form-data`像这样添加到您的表单中：

```
 <form action="newevent.php" method="post" enctype='multipart/form-data'> 
```

因此，您可以从文件中发送数据。

# hadoop - 带有大 gzip 文件的 hadoop 策略

> ID：15665978
> 
> 赞同：1
> 
> 时间：2013-03-27T17:56:18.227
> 
> 标签：hadoop, gzip, hdfs

我将在hadoop中复制很多压缩为gzip的大型博客文件。我需要在这些文件上运行许多 map/reduce。

据我了解，只有一个 Map/Reduce 将按文件运行。就我而言，这是不可接受的，因为我们需要尽快完成这些工作。

将 gzip 文件拆分为较小的块（在将它们复制到 hadoop 之前或之后）以能够运行尽可能多的 map/reduce 是否是常见的做法？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T20:57:25.247

您可以使用 lzop 生成文件的 lzo 压缩副本 - 尽管压缩率低于 gzip，但 lzo 解压缩速度非常快。

就像是;

gunzip --stdout 文件.gz | lzop -ofile.lzo

应该管用。

将lzo文件复制到hdfs然后安装hadoop-lzo并使用它为lzo文件生成索引；

hadoop jar (hadoop-lzo jar 的路径) com.hadoop.compression.lzo.LzoIndexer file.lzo

（如果您愿意，也可以使用 com.hadoop.compression.lzo.DistributedLzoIndexer）

这将为 lzo 文件创建一个索引。

然后，Hadoop 将在为 MapReduce 作业生成拆分时使用（使用正确的输入格式）索引，以将 .lzo 压缩文件分发到多个映射器/减速器。

这里有更详细的信息；

[https://github.com/twitter/hadoop-lzo](https://github.com/twitter/hadoop-lzo)

以及该 repo 的一个分支，用于解决一些问题；

[https://github.com/kevinweil/hadoop-lzo](https://github.com/kevinweil/hadoop-lzo)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T20:46:05.527

我仍然不清楚你的问题，所以我会回答这个问题，如果我很接近，你可以告诉我：

*如何使用 map/reduce 范式解压缩大的 gzip 文件？*

除非为此专门准备了 gzip 文件，否则无法映射出解压作业。解压必须连续进行。即使 bzip2 压缩数据已经在单独的可解压缩块中，您也无法在没有解压整个内容的情况下*找到*这些块，串行地指向它们，这可能违背了目的。

您提到了 LZO 的“容器”格式，如果我理解正确的话，它也适用于 gzip 和 bzip2。

对于这些格式中的任何一种，您都可以通过分段压缩来准备用于并行解压缩的 gzip 流。例如，每个片段为兆字节或几兆字节，以便不会显着降低压缩性能，并维护对在压缩时构建并与压缩数据文件一起传输或存储的那些片段的索引。

gzip 流的串联本身就是一个有效的 gzip 流，它解压缩为各个流的解压缩的串联。bzip2 格式也是如此。对于 bzip2，这些片段应该是 900K 的倍数，以免有部分块，这在压缩率方面效率较低。

然后，您可以构建这样的 gzip 或 bzip2 文件，并在其中保留每个 gzip 或 bzip2 流开始的文件偏移列表。然后您可以绘制出这些部分，其中 reduce 步骤将简单地以正确的顺序连接未压缩的结果。

# apache-flex - 如果我添加 apache flex sdk 4.9.1 作为我的编译器，我可以在 fb 4.6 中使用设计模式吗？

> ID：15665980
> 
> 赞同：8
> 
> 时间：2013-03-27T17:56:20.720
> 
> 标签：apache-flex, flexbuilder, flash-builder, flex4.6

我正在运行 Flash Builder 4.6 并且刚刚将 Apache flex sdk 4.9.1 (build 1447119) 添加到运行 Moutain Lion 的 mac book pro 中，当我尝试做一个快速的“hello world”并使用设计模式向舞台添加一些元素时我收到以下错误：

> 设计模式被禁用，因为项目使用了不兼容的 flex sdk 版本

我的问题是，如果我超出了 fb 4.6 附带的默认 sdk，我是否因此失去了使用设计模式的能力并且必须在源模式下做所有事情？

此外，如果我使用 Windows，当我将鼠标悬停在`Design`选项卡上时，错误非常相似

> 不支持设计模式 - SDK 版本不兼容 - Apache Flex

谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-02T02:30:13.103

你可以做一个 hack 来让它工作（我自己做过，到目前为止它工作得很好），它涉及在 4.9.1 SDK 中编辑一个 XML 文件，以欺骗 Flash Builder 认为它正在使用 Flex 4.6。您需要编辑`'flex-sdk-description.xml'`版本标签并将其从 4.9.1 更改为 4.6，这应该会处理好它。该文件的位置在 4.9.1 文件夹中的 SDK 文件夹中，这是 Windows 7 中的路径：

```
C:\Program Files (x86)\Adobe\Adobe Flash Builder 4.6\sdks\4.9.1 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-08-27T06:31:13.023

我确认 **wakqasahmed的说法**

我在 Apache Flex 4.10 更改了它

```
<?xml version="1.0"?>
<flex-sdk-description>
    <name>Apache Flex 4.10.0 FP 11.8 AIR 3.8 en_US</name>
    <!--version>4.10.0</version-->
    <version>4.6.0</version>
    <build>20130801</build>
</flex-sdk-description> 
```

设计模式再次启用！谢谢

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-10-01T15:15:02.713

我有一个更好的技巧，它不涉及欺骗 Flash Builder 关于您正在使用的 Flex SDK。它是关于修补一个编译类中的单个位。之后，无论您使用的 Flex 版本如何，设计器都会打开。你可以在我的文章中阅读更多关于它的信息：

[Adobe Flash Builder 4.6 中的最新 Flex SDK](https://tonigodoy.com/blog/latest-flex-sdk-in-adobe-flash-builder-4-6/)
（在该领域工作了近 40 年后，我才敢于打开博客！），

但是，在这里你有一个简单的解决方案：

你必须修补类：
com\adobe\flexbuilder\mxml\editor\ **MXMLEditor.class**
里面：
eclipse\plugins\com.adobe.flexbuilder.mxml.editor **_4.6.1.335153\mxml.jar**

使用十六进制编辑器，打开文件 MXMLEditor.class 并将 byte: 更改
`3D (61 dec.) at address 0x9D04`
为：
`AC (172 dec.)`

之后，您将能够将 Flash Builder 设计器与任何版本的 Flex SDK 一起使用。但要小心并首先采取适当的预防措施：

*   在更改任何内容之前备份 .jar 文件。
*   检查您的 mxml.jar 的版本是否与上述相同。
*   修改您的软件许可证并检查您是否可以打补丁。

# c++ - C++：为什么我的 unordered_map 的散列函数不是 > 工作？

> ID：15665985
> 
> 赞同：1
> 
> 时间：2013-03-27T17:56:31.127
> 
> 标签：c++, hash, unordered-map, hash-function

我想创建一个 unordered_map，它具有 a`char*`作为键和 a`vector<int>`作为`value`. 我从之前的问题中了解到，`char*` STL 没有提供散列函数。

我从这个站点获取了第一个实现：[http ://www.cse.yorku.ca/~oz/hash.html](http://www.cse.yorku.ca/~oz/hash.html)

因此，在我的`main.cpp`文件中，我插入了以下代码：

```
namespace std
{
   template<>
   struct hash<char*>: public std::unary_function<char *, size_t>
   {
      size_t operator()(char * str) const{
      size_t hash = 5381;
      int c;

      while(c = *str++)
        hash = ((hash << 5) + hash) + c; /* hash * 33 + c */

      return hash;

     }
  };
} 
```

然后我创建了一个 unordered_map 变量：

```
std::unordered_map<char *, vector<int>> test; 
```

但是，如果我通过这样做两次插入值“temp”：

```
std::unordered_map<char *, vector<int>> test;
char *t1 = new char[5];
strcpy(t1, "temp");
char *t2 = new char[5];
strcpy(t2, "temp");
vector<int>& ptr = test[t1];
ptr.push_back(0);
vector<int>& ptr2 = test[t2];
ptr2.push_back(1); 
```

最终映射不是有一个“temp”键和一个大小为 2 的向量，其中向量的每个元素是 0 或 1，它有两个名为“temp”的键，每个键中有一个大小为 1 的向量。

这是详细的图片： ![在此处输入图像描述](../Images/3257a3fbe491d18c998440255528eb02.png)

我怎样才能避免这种情况发生？先感谢您

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T18:02:15.107

这不是散列函数的问题，而是`char*`' 的相等性的问题。您依赖于指针比较，并且您可以从调试器监视变量中看到，各种“临时”文字的指针具有不同的位置，因此不相等。

您需要定义一个实际执行字符串比较的等式仿函数，并将其与`unordered_map`.

或者，不要使用`char*`作为您的密钥，而是使用`std::string`并完全避免此问题。

# ruby-on-rails - Rails 数据库创建

> ID：15665987
> 
> 赞同：0
> 
> 时间：2013-03-27T17:56:37.403
> 
> 标签：ruby-on-rails

当我运行命令时，`rake db:create` 我收到以下消息：

```
Couldn't create database for {"password"=>"secret1", "username"=>"root", "host"=>"localhost", "database"=>"zooz_development", "encoding"=>"utf8", "port"=>3307,
"adapter"=>"mysql"}, charset: utf8, collation: utf8_unicode_ci (if you set the c
harset manually, make sure you have a matching collation) 
```

我正在使用 win7 mysql 正在使用端口 3307 我已经安装了 mysql gem，这是我的 database.yml 文件：

```
 development:
  adapter: mysql
  encoding: utf8
  database: zooz_development
  username: root
  password: secret1
  port: 3307
  host: localhost

# Warning: The database defined as "test" will be erased and
# re-generated from your development database when you run "rake".
# Do not set this db to the same as development or production.
test:
  adapter: mysql
  encoding: utf8
  database: chmaysa_test
  username: root
  password: secret1
  port: 3307
  host: localhost

production:
  adapter: mysql
  encoding: utf8
  database: zooz_development
  username: root
  password: secret1
  port: 3307
  host: localhost 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:58:07.340

尝试：

将此添加到您的 Gemfile： `gem 'mysql2'`

并将您的适配器从更改`mysql`为`mysql2`

# java - 如何清除我的画布？

> ID：15665999
> 
> 赞同：1
> 
> 时间：2013-03-27T17:57:07.367
> 
> 标签：java, android, android-canvas, paint, redraw

我尝试重置我的画布并将此代码用于 CanvasView.java 函数 clear 什么都不做，我不知道问题出在哪里。当我尝试单击垃圾按钮时，我只收到消息已删除

```
public class CanvasView extends View{

private static final float STROKE_WIDTH = 5f;
private static final float HALF_STROKE_WIDTH = STROKE_WIDTH/2;
Paint erasePaint = new Paint();
Paint paint = new Paint();
Path path = new Path();

float lastTouchX,lastTouchY;

AlertDialog.Builder alert;

RectF ovalRectangle = new RectF();
RectF dirtyRect = new RectF();

MyRectangle myRectangle;
MyOval myOval;
MyCircle myCircle;
MyFreehand myFreehand; 
MyLine myLine;
MyEraser myEraser;

List<MyEraser> eraserList = new ArrayList<MyEraser>();
List<MyLine> lineList = new ArrayList<MyLine>();
List<MyFreehand> freehandList  = new ArrayList<MyFreehand>();
List<MyCircle> circleList = new ArrayList<MyCircle>();
List<MyOval> ovalList = new ArrayList<MyOval>();
List<MyRectangle> rectangleList = new ArrayList<MyRectangle>();

public boolean dashedLine = false;
public DashPathEffect dashEffect = new DashPathEffect(new float[]{20,30}, 0);
private Paint mBitmapPaint;
private Bitmap mBitmap; 

public String textValue;

public CanvasView(Context context, AttributeSet attrs) {
    super(context, attrs);
    setBackgroundColor(Color.WHITE);

    if (android.os.Build.VERSION.SDK_INT >= 11) 
    {
        turnOffHardwareAcc();
    }

    erasePaint.setColor(Color.WHITE);
    //erasePaint.setXfermode(new PorterDuffXfermode(PorterDuff.Mode.CLEAR));

    erasePaint.setAntiAlias(true);
    erasePaint.setStyle(Paint.Style.STROKE);
    erasePaint.setStrokeJoin(Paint.Join.ROUND);
    erasePaint.setStrokeWidth(12);

    paint.setColor(Color.BLACK);
    paint.setStyle(Paint.Style.STROKE);

    paint.setAntiAlias(true);
    paint.setStrokeJoin(Paint.Join.ROUND);
    paint.setStrokeWidth(STROKE_WIDTH);
    paint.setTextSize(34);

    setMode(7);//default = 7 - free hand;

    mBitmap = Bitmap.createBitmap(320, 480, Bitmap.Config.ARGB_8888);
    mBitmapPaint = new Paint(Paint.DITHER_FLAG);

    /* input dialog*/

     //setInputDialog();

}
EditText input;
public void setInputDialog(){

    alert = new AlertDialog.Builder(getContext());
    alert.setTitle("Title");
    alert.setMessage("Write text");

    // Set an EditText view to get user input 
    input = new EditText(getContext());
    alert.setView(input);

    alert.setPositiveButton("Ok", new DialogInterface.OnClickListener() {
    public void onClick(DialogInterface dialog, int whichButton) {
         textValue= input.getText().toString();
         Toast.makeText(getContext(), textValue, Toast.LENGTH_SHORT).show();
      // Do something with value!
      }
    });

    alert.setNegativeButton("Cancel", new DialogInterface.OnClickListener() {
      public void onClick(DialogInterface dialog, int whichButton) {
        // Canceled.
      }
    });

    //alert.show();

}

public void setDashLine(){

    dashedLine = true;
    paint = new Paint();
    paint.setPathEffect(dashEffect);
    paint.setStyle(Paint.Style.STROKE);
    paint.setAntiAlias(true);
    paint.setStrokeJoin(Paint.Join.ROUND);
    paint.setStrokeWidth(STROKE_WIDTH);
}

public void setNormalLine(){
    //paint.setColor(Color.BLACK);
    dashedLine = false;

    paint.setPathEffect(null);
    paint.setStyle(Paint.Style.STROKE);
    paint.setPathEffect(null);
    paint.setAntiAlias(true);
    paint.setStrokeJoin(Paint.Join.ROUND);
    paint.setStrokeWidth(STROKE_WIDTH);
}

@TargetApi(11)
public void turnOffHardwareAcc() // to enable dashed lines
{

    this.setLayerType(View.LAYER_TYPE_SOFTWARE, null);
}

//public void setPaint(int color,)

@TargetApi(11)
protected void onDraw(Canvas canvas) {
paint.setPathEffect(null);

if(bitmap!=null){

    canvas.drawBitmap(bitmap, 0, 0, paint);
     for(MyCircle circle:circleList){// draw circles

         myCanvas.drawCircle(getCircleMidPointX(circle.firstX, circle.lastX),getCircleMidPointY(circle.firstY, circle.lastY),circle.radius,myPaint);
     }

}

 for(MyLine line:lineList){ //draw lines
     if(dashedLine)
         line.paint.setPathEffect(dashEffect);
     else
         line.paint.setPathEffect(null);
        canvas.drawLine(line.xStart, line.yStart, line.xEnd, line.yEnd, line.paint);
  }

 for(MyCircle circle:circleList){// draw circles

     canvas.drawCircle(getCircleMidPointX(circle.firstX, circle.lastX),getCircleMidPointY(circle.firstY, circle.lastY),circle.radius,paint);
 }

 for(MyOval oval:ovalList){
     oval.paint.setPathEffect(null);

       ovalRectangle.set(oval.getX1(),oval.getY1(),oval.getX2(),oval.getY2());
       canvas.drawOval(ovalRectangle, oval.paint);
 }

 for(MyRectangle rectangle:rectangleList){
     rectangle.paint.setPathEffect(null);

          canvas.drawRect(rectangle.getX1(),rectangle.getY1(),rectangle.getX2(),rectangle.getY2(),rectangle.paint);
 }  

 for(MyEraser e:eraserList){
        canvas.drawPath(e.p,erasePaint);
        invalidate();
 }
 if(textValue!= null)
     canvas.drawText(textValue, xStart, yStart, paint);
 canvas.drawPath(path, paint);
 //path.reset();

 }

final OnTouchListener drawLineListener = new OnTouchListener() {
    public boolean onTouch(View v, MotionEvent event) {

        FirstActivity.ll.setVisibility(LinearLayout.GONE);

        switch (event.getAction()) {
          case MotionEvent.ACTION_DOWN:
              myLine = new MyLine();
              myLine.xStart = event.getX();
              myLine.yStart = event.getY();

            return true;

          case MotionEvent.ACTION_MOVE:
          case MotionEvent.ACTION_UP:
            myLine.xEnd = event.getX();
            myLine.yEnd = event.getY();
            invalidate();
            lineList.add(myLine); 
            break;

          default:
            Log.d("mock it up", "Unknown touch event  " + event.toString());
            return false;
        }
        return true;

    }
};

final OnTouchListener drawDashedLineListener = new OnTouchListener() {
    public boolean onTouch(View v, MotionEvent event) {

        FirstActivity.ll.setVisibility(LinearLayout.GONE);

        switch (event.getAction()) {
          case MotionEvent.ACTION_DOWN:
             return true;

          case MotionEvent.ACTION_MOVE:
          case MotionEvent.ACTION_UP:

            break;

          default:
            Log.d("mock it up", "Unknown touch event  " + event.toString());
            return false;
        }
        return true;

    }
};

final OnTouchListener drawCircleListener = new OnTouchListener(){

    public boolean onTouch(View v, MotionEvent event) {

        FirstActivity.ll.setVisibility(LinearLayout.GONE);

        float eventX = event.getX();
        float eventY = event.getY();

        switch (event.getAction()) {
          case MotionEvent.ACTION_DOWN:
           //  path.moveTo(eventX, eventY);
              Toast.makeText(getContext(), "action down - circle",Toast.LENGTH_SHORT).show();
              myCircle = new MyCircle();
              myCircle.firstX = eventX;
              myCircle.firstY = eventY;

            // There is no end point yet, so don't waste cycles invalidating.
            return true;

          case MotionEvent.ACTION_MOVE:

          case MotionEvent.ACTION_UP:
            myCircle.lastX = eventX;
            myCircle.lastY = eventY;

            myCircle.radius = getRadius(myCircle.firstX,myCircle.firstY,myCircle.lastX,myCircle.lastY);

            circleList.add(myCircle);

            invalidate();
            break;

          default:
            Log.d("mock it up", "Unknown touch event  " + event.toString());
            return false;
        }
  return true;
    }

};

final OnTouchListener drawOvalListener = new OnTouchListener() {
        public boolean onTouch(View v, MotionEvent event) {

            FirstActivity.ll.setVisibility(LinearLayout.GONE);

            switch (event.getAction()) {
              case MotionEvent.ACTION_DOWN:
                myOval = new MyOval();
                myOval.setX1(event.getX());
                myOval.setY1(event.getY());
                // There is no end point yet, so don't waste cycles invalidating.
                return true;

              case MotionEvent.ACTION_MOVE:
              case MotionEvent.ACTION_UP:

                  myOval.setX2(event.getX());
                  myOval.setY2(event.getY());

                  invalidate();
                  ovalList.add(myOval);

              default:
                Log.d("mock it up", "Unknown touch event  " + event.toString());
                return false;
            }

        }
    };

final OnTouchListener drawRectangleListener = new OnTouchListener() {

        public boolean onTouch(View v, MotionEvent event) {

            FirstActivity.ll.setVisibility(LinearLayout.GONE);

            switch (event.getAction()) {
              case MotionEvent.ACTION_DOWN:
                  myRectangle = new MyRectangle();
                  myRectangle.setX1(event.getX());
                  myRectangle.setY1(event.getY());
                return true;

              case MotionEvent.ACTION_MOVE:

              case MotionEvent.ACTION_UP:

                  myRectangle.setX2(event.getX());
                  myRectangle.setY2(event.getY());
                  invalidate();
                  rectangleList.add(myRectangle);

                break;

              default:
                Log.d("mock it up", "Unknown touch event  " + event.toString());
                return false;
            }

            return true;
        }
};

final OnTouchListener eraseListener = new OnTouchListener() {

    public boolean onTouch(View v, MotionEvent event) {

    //  erasePaint.setXfermode(new PorterDuffXfermode(PorterDuff.Mode.CLEAR));
        //FirstActivity.ll.setVisibility(LinearLayout.GONE);

        switch (event.getAction()) {
          case MotionEvent.ACTION_DOWN:
             myEraser = new MyEraser();
              lastTouchX = event.getX();
              lastTouchY = event.getY();
              myEraser.mouseDown(event.getX(), event.getY());
              return true;

          case MotionEvent.ACTION_MOVE:
          case MotionEvent.ACTION_UP:
              resetDirtyRect(event.getX(),event.getY());
              int historySize = event.getHistorySize();
              for(int i=0;i<historySize;i++){
                  float historicalX = event.getHistoricalX(i);
                  float historicalY = event.getHistoricalY(i);
                  expandDirtyRect(historicalX, historicalY);

                  myEraser.mouseUp(historicalX, historicalY);
            }
              myEraser.mouseUp(event.getX(), event.getY());
              eraserList.add(myEraser);
             break;

          default:
            Log.d("mock it up", "Unknown touch event  " + event.toString());
            return false;
        }

        invalidate(
                (int) (dirtyRect.left - HALF_STROKE_WIDTH),
                (int) (dirtyRect.top - HALF_STROKE_WIDTH),
                (int) (dirtyRect.right + HALF_STROKE_WIDTH),
                (int) (dirtyRect.bottom + HALF_STROKE_WIDTH));

            lastTouchX = event.getX();
            lastTouchY = event.getY();
       return true;
    }
};

final OnTouchListener drawFreeHandListener = new OnTouchListener() {

    public boolean onTouch(View v, MotionEvent event) {

        FirstActivity.ll.setVisibility(LinearLayout.GONE);

        float eventX = event.getX();
        float eventY = event.getY();

        switch (event.getAction()) {
          case MotionEvent.ACTION_DOWN:
             // path.reset();
            path.moveTo(eventX, eventY);
            lastTouchX = eventX;
            lastTouchY = eventY;
            // There is no end point yet, so don't waste cycles invalidating.
            return true;

          case MotionEvent.ACTION_MOVE:
          case MotionEvent.ACTION_UP:
            // Start tracking the dirty region.
            resetDirtyRect(eventX, eventY);

            // When the hardware tracks events faster than they are delivered, the
            // event will contain a history of those skipped points.
            int historySize = event.getHistorySize();
            for (int i = 0; i < historySize; i++) {
              float historicalX = event.getHistoricalX(i);
              float historicalY = event.getHistoricalY(i);
              expandDirtyRect(historicalX, historicalY);
              path.lineTo(historicalX, historicalY);
            }

            // After replaying history, connect the line to the touch point.
            path.lineTo(eventX, eventY);
            //path.reset();
            break;

          default:
            Log.d("mock it up", "Unknown touch event  " + event.toString());
            return false;
        }

        // Include half the stroke width to avoid clipping.
        invalidate(
            (int) (dirtyRect.left - HALF_STROKE_WIDTH),
            (int) (dirtyRect.top - HALF_STROKE_WIDTH),
            (int) (dirtyRect.right + HALF_STROKE_WIDTH),
            (int) (dirtyRect.bottom + HALF_STROKE_WIDTH));

        lastTouchX = eventX;
        lastTouchY = eventY;

        return true;
    }
};

float xStart,yStart;
final OnTouchListener textListener = new OnTouchListener() {

    public boolean onTouch(View v, MotionEvent event) {
        FirstActivity.ll.setVisibility(LinearLayout.GONE);

    //  Toast.makeText(getContext(), "add some text", Toast.LENGTH_SHORT).show();

        switch (event.getAction()) {
          case MotionEvent.ACTION_DOWN:
              //
              setInputDialog();
              xStart = event.getX();
              yStart = event.getY();
              alert.show();
            break;

          case MotionEvent.ACTION_MOVE:
          case MotionEvent.ACTION_UP:
            //  setInputDialog();
                  break;

          default:
            Log.d("mock it up", "Unknown touch event  " + event.toString());
            return false;
        }

        return true;
    }
};

/**
 * Called when replaying history to ensure the dirty region includes all
 * points.
 */
private void expandDirtyRect(float historicalX, float historicalY) {
  if (historicalX < dirtyRect.left) {
    dirtyRect.left = historicalX;
  } else if (historicalX > dirtyRect.right) {
    dirtyRect.right = historicalX;
  }
  if (historicalY < dirtyRect.top) {
    dirtyRect.top = historicalY;
  } else if (historicalY > dirtyRect.bottom) {
    dirtyRect.bottom = historicalY;
  }
}

/**
 * Resets the dirty region when the motion event occurs.
 */
private void resetDirtyRect(float eventX, float eventY) {

  // The lastTouchX and lastTouchY were set when the ACTION_DOWN
  // motion event occurred.
  dirtyRect.left = Math.min(lastTouchX, eventX);
  dirtyRect.right = Math.max(lastTouchX, eventX);
  dirtyRect.top = Math.min(lastTouchY, eventY);
  dirtyRect.bottom = Math.max(lastTouchY, eventY);
}

public void setMode(int mode){
    switch(mode){
    case 1://draw line
        Toast.makeText(getContext(), "draw line", Toast.LENGTH_SHORT).show();
        setOnTouchListener(drawLineListener);
        break;
    case 2://draw dashed line
        Toast.makeText(getContext(), "dashed line", Toast.LENGTH_SHORT).show();
        break;
    case 3:// draw circle
        setOnTouchListener(drawCircleListener);
        break;
    case 4: //draw oval
        setOnTouchListener(drawOvalListener);
        break;
    case 5: //draw rectangle
        setOnTouchListener(drawRectangleListener);
        break;
    case 6: //erase
        setOnTouchListener(eraseListener);
        break;
    case 7: //free-hand
        setOnTouchListener(drawFreeHandListener);
        break;
    case 8:
        setOnTouchListener(textListener);
        break;
    }
}

private Bitmap bitmap;
private Canvas myCanvas;
public Paint myPaint;

public void setImage(Bitmap b){
    Toast.makeText(getContext(), "set Bitmap",Toast.LENGTH_SHORT).show();
    bitmap = b.copy(Bitmap.Config.ARGB_8888, true);
    myCanvas = new Canvas(bitmap);

    myPaint = new Paint();
    myPaint.setColor(Color.YELLOW);
    myPaint.setAntiAlias(true);
    myPaint.setStrokeWidth(8);

    invalidate();
}

public void changeColor(int color){
    paint = new Paint(paint);
    paint.setColor(color);
    //myPaint.setColor(color);
}

public float getRadius(float x1,float y1,float x2,float y2){
      float r = (float) (Math.sqrt((double)(Math.pow((y2-y1), 2.0)+Math.pow((x2-x1), 2.0)))/2);
      return r;
  }

public float getCircleMidPointX(float x1,float x2){
      return (x1+x2)/2;
  }

public float getCircleMidPointY(float y1,float y2){
      return (y1+y2)/2;
  }

public void clear() {
    // TODO Auto-generated method stub
      mBitmapPaint = new Paint(Paint.DITHER_FLAG);
      mBitmap = Bitmap.createBitmap(320,480,Bitmap.Config.ARGB_8888);
      myCanvas = new Canvas(mBitmap);  
      myPaint = new Paint();
      myPaint.setAntiAlias(true);
      myPaint.setDither(true);
      myPaint.setStyle(Paint.Style.STROKE);
      myPaint.setStrokeJoin(Paint.Join.ROUND);
      myPaint.setStrokeCap(Paint.Cap.ROUND);
      myPaint.setStrokeWidth(0);
      invalidate();
      lineList.clear();
      circleList.clear();
      rectangleList.clear();
      eraserList.clear();
      ovalList.clear();
      freehandList.clear();

} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T19:02:50.070

```
 public void clear()
 {
   textvalue="";// set textvalue to null

  mBitmapPaint = new Paint(Paint.DITHER_FLAG);
  mBitmap = Bitmap.createBitmap(320,480,Bitmap.Config.ARGB_8888);
  mCanvas = new Canvas(mBitmap);    
  path = new Path(); 
   //reset drawing tools. reset other drawing tools. (linepaint, cirlce paint..)        
  mypaint = new Paint();
  mypaint.setAntiAlias(true);
  mypaint.setDither(true);
  mypaint.setColor(0xFFFF0000);
  mypaint.setStyle(Paint.Style.STROKE);
  mypaint.setStrokeJoin(Paint.Join.ROUND);
  mypaint.setStrokeCap(Paint.Cap.ROUND);
  paint = new Paint();
  paint.setAntiAlias(true);
  paint.setDither(true);
  paint.setColor(0xFFFF0000);
  paint.setStyle(Paint.Style.STROKE);
  paint.setStrokeJoin(Paint.Join.ROUND);
  paint.setStrokeCap(Paint.Cap.ROUND);
  eraserList.clear();
  lineList.clear();
  freehandList.clear();
  circleList.clear();
  ovalList.clear();
  rectangleList.clear();
  invalidate(); //refresh your view. try this
  } 
```

编辑：

canvas.drawBitmap(mBitmap, 0, 0, mBitmapPaint); 将此添加到您的画布 onDraw() 并尝试一下