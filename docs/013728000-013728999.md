# StackOverflow 问答 13728000-13728999

# spring - 使用 @PropertySource 注释时未解析 @Value。如何配置 PropertySourcesPlaceholderConfigurer？

> ID：13728000
> 
> 赞同：67
> 
> 时间：2012-12-05T16:37:50.007
> 
> 标签：spring, configuration

我有以下配置类：

```
@Configuration
@PropertySource(name = "props", value = "classpath:/app-config.properties")
@ComponentScan("service")
public class AppConfig { 
```

我有财产服务：

```
@Component 
public class SomeService {
    @Value("#{props['some.property']}") private String someProperty; 
```

当我想测试 AppConfig 配置类时收到错误

```
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'someService': Injection of autowired dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Could not autowire field: private java.lang.String service.SomeService.someProperty; nested exception is org.springframework.beans.factory.BeanExpressionException: Expression parsing failed; nested exception is org.springframework.expression.spel.SpelEvaluationException: EL1008E:(pos 0): Field or property 'props' cannot be found on object of type 'org.springframework.beans.factory.config.BeanExpressionContext' 
```

该问题记录[在 SPR-8539 中](https://jira.springsource.org/browse/SPR-8539)

但无论如何我无法弄清楚如何配置**PropertySourcesPlaceholderConfigurer** 以使其工作。

## 编辑 1

这种方法适用于 xml 配置

```
<util:properties id="props" location="classpath:/app-config.properties" /> 
```

但我想使用java进行配置。

* * *

## 回答 #1

> 赞同：136
> 
> 时间：2013-09-12T07:41:03.877

正如@cwash 所说；

```
@Configuration
@PropertySource("classpath:/test-config.properties")
public class TestConfig {

     @Value("${name}")
     public String name;

     //You need this
     @Bean
     public static PropertySourcesPlaceholderConfigurer propertySourcesPlaceholderConfigurer() {
        return new PropertySourcesPlaceholderConfigurer();
     }

} 
```

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2013-03-22T03:38:32.797

如果您使用@PropertySource，则必须通过以下方式检索属性：

```
@Autowired
Environment env;
// ...
String subject = env.getProperty("mail.subject"); 
```

如果要使用 检索`@Value("${mail.subject}")`，则必须通过 xml 注册 prop 占位符。

原因： [https ://jira.springsource.org/browse/SPR-8539](https://jira.springsource.org/browse/SPR-8539)

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2014-11-27T06:56:35.963

我发现`@value`对我不起作用的原因是，`@value`需要`PropertySourcesPlaceholderConfigurer`而不是`PropertyPlaceholderConfigurer`. 我做了同样的改变，它对我有用，我使用的是 spring 4.0.3 版本。我在我的配置文件中使用以下代码进行了配置。

```
@Bean
public static PropertySourcesPlaceholderConfigurer propertySourcesPlaceholderConfigurer() {
   return new PropertySourcesPlaceholderConfigurer();
} 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2013-06-10T19:21:59.407

您是否不需要 @Configuration 类上的方法，该方法返回 PropertySourcesPlaceholderConfigurer、带注释的 @Bean 并且是静态的，以便向 Spring 注册任何 @PropertySource？

[http://www.baeldung.com/2012/02/06/properties-with-spring/#java](http://www.baeldung.com/2012/02/06/properties-with-spring/#java)

[https://jira.springsource.org/browse/SPR-8539](https://jira.springsource.org/browse/SPR-8539)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2013-05-27T12:14:20.957

我有同样的问题。`@PropertySource`玩得不好`@Value`。一个快速的解决方法是拥有一个 XML 配置，您可以`@ImportResource`像往常一样使用 Spring Java 配置来引用它，并且该 XML 配置文件将包含一个条目：（`<context:property-placeholder />`当然还有所需的命名空间仪式）。没有任何其他更改将在您的pojo`@Value`中注入属性。`@Configuration`

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2016-04-21T20:17:08.607

这个在java中也可以这样配置

```
@Bean
public static PropertySourcesPlaceholderConfigurer properties() {
    PropertySourcesPlaceholderConfigurer configurer = new PropertySourcesPlaceholderConfigurer();
    configurer.setIgnoreUnresolvablePlaceholders(true);
    configurer.setIgnoreResourceNotFound(true);
    return configurer;
} 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2012-12-05T16:55:25.540

这看起来很复杂，你不能做吗

```
 <context:property-placeholder location="classpath:some.properties" ignore-unresolvable="true"/> 
```

然后在代码参考中：

```
@Value("${myProperty}")
private String myString;

@Value("${myProperty.two}")
private String myStringTwo; 
```

其中 some.properties 看起来像这样

```
myProperty = whatever
myProperty.two = something else\
that consists of multiline string 
```

对于基于 java 的配置，您可以这样做

```
@Configuration
@PropertySource(value="classpath:some.properties")
public class SomeService { 
```

`@value`然后像以前一样注入

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-05-31T09:40:55.880

问题是：据我所知，<util:propertes id="id" location="loc"/> 只是

```
<bean id="id" class="org.springframework.beans.factory.config.PropertiesFactoryBean">
  <property name="location" value="loc"/>
</bean> 
```

（请参阅[util:properties 的文档](http://static.springsource.org/spring/docs/3.2.x/spring-framework-reference/html/xsd-config.html#xsd-config-body-schemas-util-properties)）。因此，当您使用 util:properties 时，会创建一个独立的 bean。

另一方面，@PropertySource 正如文档所说的那样

> 注释提供了一种方便的声明性机制，用于将 PropertySource 添加到 Spring 的环境中。

（请参阅[@PropertySource 文档](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/context/annotation/PropertySource.html)）。所以它不会创建任何bean。

那么“#{a['something']}”是一个SpEL表达式（参见[SpEL](http://static.springsource.org/spring/docs/3.2.x/spring-framework-reference/html/expressions.html)），意思是“从bean'a'中获取一些东西**”**。使用 util:properties 时，bean 存在，表达式有意义，但使用 @PropertySource 时，没有实际的 bean，表达式无意义。

您可以通过使用 XML（我认为这是最好的方法）或自己发出 PropertiesFactoryBean 来解决此问题，将其声明为普通的 @Bean。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2018-12-30T21:22:11.483

由于 Spring 4.3 RC2不再需要使用`PropertySourcesPlaceholderConfigurer`or 。`<context:property-placeholder>`我们可以直接使用`@PropertySource`with `@Value`。请参阅此[Spring 框架票证](https://jira.spring.io/browse/SPR-14140)

我用 Spring 5.1.3.RELEASE 创建了一个测试应用程序。`application.properties`包含两对：

```
app.name=My application
app.version=1.1 
```

通过`AppConfig`加载属性`@PropertySource`。

```
package com.zetcode.config;

import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.PropertySource;

@Configuration
@PropertySource(value = "application.properties", ignoreResourceNotFound = true)
public class AppConfig {

} 
```

`Application`注入属性并使用`@Value`它们。

```
package com.zetcode;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;
import org.springframework.context.annotation.ComponentScan;

@ComponentScan(basePackages = "com.zetcode")
public class Application {

    private static final Logger logger = LoggerFactory.getLogger(Application.class);

    @Value("${app.name}")
    private String appName;

    @Value("${app.version}")
    private String appVersion;

    public static void main(String[] args) {

        var ctx = new AnnotationConfigApplicationContext(Application.class);
        var app = ctx.getBean(Application.class);

        app.run();

        ctx.close();
    }

    public void run() {

        logger.info("Application name: {}", appName);
        logger.info("Application version: {}", appVersion);
    }
} 
```

输出是：

```
$ mvn -q exec:java
22:20:10.894 [com.zetcode.Application.main()] INFO  com.zetcode.Application - Application name: My application
22:20:10.894 [com.zetcode.Application.main()] INFO  com.zetcode.Application - Application version: 1.1 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-02-25T15:21:19.097

在我的情况下，depends-on="bean1" 在属性占位符内导致了问题。我删除了该依赖项并使用 @PostConstruct 来实现相同的原始功能，并且也能够读取新值。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-03-10T20:09:14.253

可能发生的另一件事：确保您的 @Value 注释值不是静态的。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-08-21T14:50:39.893

如果是用xml配置，添加后

> <context:property-placeholder location="..."/>

确保您的注释已激活。在我的情况下，由于这个原因没有获取属性：

> <context:annotation-config/>

# ios6 - 在哪里可以从 ipa 看到您的通行证类型标识符？

> ID：13728003
> 
> 赞同：1
> 
> 时间：2012-12-05T16:38:01.230
> 
> 标签：ios6, ipa, entitlements, passbook

有没有办法从 ipa 查看您的应用程序的通行证类型标识符？我在我的临时构建工作正常的地方遇到了麻烦，但是一旦我将应用程序提交到应用程序商店，PassKit 就停止了在设备上访问的应用程序的工作。我不希望这种情况再次发生，所以我打开了`.ipa`文件并试图`pass-type-identifier`在`embedded.mobileprovision`文件中找到它，但那里什么也没有。

更奇怪的是，当我存档时，XCode 制作了一个`archived-expanded-entitlements.xcent`文件，在其中我可以看到我的通行证类型标识符清楚地显示为 day。但是，当我将此存档转换为 a`.ipa`时，其余权利仍显示在`embedded.mobileprovision`文件中，但`pass-type-identifier`仍然丢失。

我想知道是否有其他人设法找到一种方法来做到这一点？

谢谢，

# ios - 导航栏位于 4" 屏幕的状态栏下方

> ID：13728005
> 
> 赞同：0
> 
> 时间：2012-12-05T16:38:08.290
> 
> 标签：ios, ios6, uistoryboard

我在标签栏控制器中嵌入了导航控制器，问题是导航栏（蓝色）位于状态栏下方。所以状态栏看起来是透明的，因为它显示了下面的内容。这是一个屏幕截图：

![在此处输入图像描述](../Images/37b74e23e3020f9d59dd713de181a450.png) 我尝试直接在属性检查器中将状态栏修改为黑色和半透明黑色，也禁用了自动布局，尽管我知道它与此类问题无关。无论如何，没有什么是固定的。我曾经在 iOS5 中使用它，但是自从 iOS6 和新的 4" 故事板屏幕以来，我遇到了这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T03:32:19.983

这里有一个误解。导航栏不在状态栏“下方”。这是 iOS 6 新的采用颜色的状态栏。[你可以在这里](http://www.cultofmac.com/173928/how-ios-6s-cool-new-adaptive-status-bar-works/)阅读更多。

如果你不喜欢这种行为，你唯一的选择就是让状态栏变黑。查看项目属性页面。

# c# - 向 IE 发送字符串，IE 执行字符串但没有出现 IE 或出现控制台屏幕

> ID：13728007
> 
> 赞同：0
> 
> 时间：2012-12-05T16:38:11.263
> 
> 标签：c#

我不知道是否可以在 Windows 控制台应用程序 (C#) 中执行此操作，但我的项目确实需要这样的东西。

我想向 IE 发送一个字符串（或 URL 链接）并让 IE 执行该字符串。但是，由于这个字符串是静态的；它所做的只是通过互联网打开和关闭机器。因此，在这种情况下，我没有兴趣看到 IE 弹出/显示，也没有兴趣在应用程序执行时出现黑屏控制台。

我知道在控制台应用程序 C# 中我们可以做这样的事情

```
 Process.Start("iexplore.exe", @"http://myserver.com"); 
```

但是，当我运行上面的行时，IE 弹出窗口和黑屏控制台也是如此。

有没有办法不弹出 IE 和不弹出屏幕控制台？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T16:41:37.033

我认为你正在以错误的方式解决这个问题。IE 只是 Web 请求的门户。只需直接进行网络请求调用即可。使用类似新的 Web API 或[HttpWebRequest](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.aspx)

至于使控制台不弹出，也许您应该创建一个 Windows 服务而不是控制台应用程序？我们需要有关最终用户的更多详细信息。如果这更像是一种自动化操作，那么服务将起作用。如果它是用户点击的东西，那么为什么显示控制台是一件坏事？通常，当您单击某物时，您会期望某种视觉表示。但是，[这里有一个已经回答了这个问题的 SO](https://stackoverflow.com/questions/836427/how-to-run-a-c-sharp-console-application-with-the-console-hidden)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T16:40:51.790

试试`ProcessStartInfo`。这将隐藏控制台应用程序，但我不赞成它隐藏 IE。

```
ProcessStartInfo psi = new ProcessStartInfo("iexplore.exe", @"http://myserver.com");
psi.WindowStyle = ProcessWindowStyle.Hidden;

Process.Start(psi); 
```

# java - 在哪里可以找到简单任务管理器的示例

> ID：13728010
> 
> 赞同：-3
> 
> 时间：2012-12-05T16:38:25.560
> 
> 标签：java, model-view-controller, jsp, servlets

我是一名初级 Java 开发人员。我必须制作一个需要我有两种用户、经理和普通用户的项目。管理员可以为普通用户添加新的职责，在系统中注册新用户，查看所有内容等。普通用户只能查看与他们相关的信息。我可以自己做到这一点，但我需要使用 MVC 架构，我有点困惑。请如果有人知道我在哪里可以找到任何类似的项目，它将对我有很大帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T16:45:47.880

您没有提供很多上下文，但根据您的标签（包括 JSP 和 Servlet）判断，然后考虑查看 Web 应用程序技术堆栈项目[AppFuse](http://appfuse.org/display/APF/Home)。它将使用 Maven 为您生成一个 Web 应用程序项目，该项目建立在 Web 开发的最新技术之上。生成的项目具有您 [模糊] 描述的功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T16:49:26.047

我认为您能做的最好的事情就是使用 Struts 框架来实现您的应用程序 (http://struts.apache.org/)。简单，通用，以非常简单易懂的方式实现MVC模式，支持用户处理等。另一方面，如果您不允许使用框架......

好吧，您应该使用 jsp、servlet 和 POJO 来构建您的应用程序，以实现 MVC 自定义。JSP 只处理页面布局，Servlet 管理导航和一般应用程序控制，而 POJO（Plain Old Java Objects）实现您的业务逻辑，以便将“外观”、导航问题和业务保持在分离的层中。

# jquery - 右浮动 div 在窗口调整大小时移动到另一个 div

> ID：13728011
> 
> 赞同：-1
> 
> 时间：2012-12-05T16:38:32.223
> 
> 标签：jquery, css, html

我怎样才能阻止我的右浮动 div 溢出到它左边的另一个 div 中？

```
<div class="HeaderArea">

   <div id="centertopnav">
   </div>

   <div class="srchbox">
   </div>

</div>

#centertopnav {margin:0 auto; padding:0; width:780px;}

.srchbox { 
 float:right; 
 margin:-20px 290px 0 0 ;
} 
```

HeaderArea 是全身宽度，centertopnav 使用边距“0px auto”居中，srchbox 向右浮动，但是当我调整窗口大小时，srchbox 转移到 centertopnav 中。

我用什么属性来解决这个问题？溢出？清除？[这是截图： http](http://pixholder.com/view.php?id=1160) ://pixholder.com/view.php?id=1160

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T16:45:55.597

什么是 HeaderArea 宽度？如果它是小 srchbox 将向右浮动但不能再进一步。

# ios - XCode 无法编辑 CoreData 模型

> ID：13728021
> 
> 赞同：12
> 
> 时间：2012-12-05T16:38:56.780
> 
> 标签：ios, core-data

将 CoreData 模型添加到我现有的项目后，使用

`File > New > File... > Core Data > Data Model`

我无法编辑模型。该项目现在包含一个 .xcdatamodeld 包引用，但在 Project Navigator 中单击它与单击文件夹或组具有相同的效果，当前编辑器不会更改。同样右键单击参考并选择“打开为>”不列出任何潜在的编辑器。此外，打开文件检查器面板仅列出“身份”“目标成员”和“文本设置”的设置，它不会列出“核心数据模型”或“版本化核心数据模型”的设置

并不是说这会对 XCodes 识别文件类型的能力产生任何影响，但我还在构建阶段引用了 CoreData.framework，并在 AppDelegate 中包含了必要的 Core Data 属性。

奇怪的是，我在 Finder 中打开了 .xcdatamodeld 包以公开内部 .xcdatamodel（注意没有尾随的 'd'）。双击该文件将按预期使用 Core Data Model Editor 打开 XCode。

更奇怪的是，我创建了一个新的投影并单击了“使用核心数据”复选框。这样做允许我通过在 Project Navigator 中选择 .xcdatamodeld 引用来编辑数据模型。因此，我的机器和 XCode 能够并配置为编辑 CoreData 文件。

就好像 XCode 无法使用 Core Data 一样，除非原始项目是使用“使用 Core Data”复选框创建的。

有没有人遇到过这个问题，您是否能够解决它，以及如何解决？

谢谢！

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-12-05T22:56:17.327

结果我试图将数据模型添加到一个组中，该组引用了一个特定的文件夹来存储它的孩子。但是该文件夹不存在。这导致 XCode 将数据模型放置在项目根目录中，但同时将其引用为位于项目根目录上方的 2 个目录。更奇怪的是，XCode 并没有通过将文件显示为红色来将其列为丢失。无论哪种方式，XCode 在 Project Navigator 中单击时都会忽略该文件，因为它并不真正存在于它认为它存在的位置。故事的寓意是：检查您的文件路径和配置的组路径。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2014-09-03T06:53:26.653

我今天遇到了这个问题，问题是我的`.xcdatamodel`文件是自己打包的（*奇怪*，我知道）。这是我修复它的方法：

1.  我`File.xcdatamodel`在 Finder 中找到了我的文件。
2.  右键单击并选择**Show Package Contents**。
3.  里面是另一个副本`File.xcdatamodel`。我把它复制到我的桌面。
4.  然后我将该文件拖到 Xcode 中并打开它。

终于解脱了。:) 我希望这对其他人有所帮助。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-09-07T09:48:51.133

我们真正的问题是 Xcode 在创建新版本时无法打开/验证数据模型。含义：拥有第一个 .xcdatamodel，然后`Editor > Add Model Version... > MyProject 2`（作为 .xcdatamodel）。之后，创建了 MyPoject.xcdatamodel **d**但无法打开。

经过数小时的调查，我们发现 .xcurrentversion 文件和`XCVersionGroup`项目文件中的 .xcurrentversion 文件丢失或无效。原因之一是 xcdatamodel **d**版本应该在根文件夹中。

## 简单快速的解决方案1：

创建一个新的模型版本并：

1.  设置根文件夹的路径
2.  将 指定为`Group`先前版本所在的子目录。

新的 .xcdatamodel **d**现在**可以在 Xcode 上工作，但不能移动到根文件夹以外的任何地方**。

## 复杂的解决方案2：

要在子文件夹中有一个工作的 .xcdatamodel **d**，您必须按照以下步骤手动修改项目文件：

PS：这是我曾经写过的最复杂和最老套的答案。对不起 ：（

1.  在先前版本的同一目录中创建一个新的模型版本（即使它使数据模型无效）。
2.  确保在您的目标中指定了新的 .xcdatamodel **d**文件。
3.  在 Finder 中打开 Package Content 并将所有 xcdatamodel 版本拖放到项目中。
4.  `project.pbxproj`在文本编辑器中打开文件。
5.  搜索所有数据模型的新文件并复制它们的`fileId`.

例子：

```
75F3199D1B9D80D50030FF46 /* MyProject 2.xcdatamodel in Sources */ = {isa = PBXBuildFile; fileRef = 75F319981B9D80D50030FF46 /* MyProject 2.xcdatamodel */; };
// fileId = 75F3199D1B9D80D50030FF46 /* The first id at the beginning of the line */ 
```

6.  将这些行从该`PBXBuildFile`部分移动到该部分的开头`PBXFileReference`并像这样更新它们（重用`fileId`）。

例子：

```
75F3199D1B9D80D50030FF46 /* MyProject 2.xcdatamodel */ = {isa = PBXFileReference; lastKnownFileType = wrapper.xcdatamodel; path = "MyProject 2.xcdatamodel"; sourceTree = "<group>"; }; 
```

7.  现在搜索该`MyPoject.xcdatamodeld`部分中的文件`PBXBuildFile`并复制其`fileRef`.

例子：

```
75F319961B9D7FA50030FF46 /* MyProject.xcdatamodeld in Sources */ = {isa = PBXBuildFile; fileRef = 75F319931B9D7FA50030FF46 /* MyProject.xcdatamodeld */; };
// fileRef = 75F319931B9D7FA50030FF46 
```

8.  最后，在`project.pbxproj`文件的最后创建`XCVersionGroup`部分并重用`fileRef`来自 xcdatamodel **d**和 all的`fileId`。

示例（没有`//`注释）：

```
/* Begin XCVersionGroup section */
        75F319931B9D7FA50030FF46 /* MyProject.xcdatamodeld */ = { // fileRed
            isa = XCVersionGroup;
            children = (
                75F3199D1B9D80D50030FF46 /* MyProject 2.xcdatamodel */, // fileId
                75F319A11B9D80D50030FF46 /* MyProject.xcdatamodel */, // fileId
            );
            currentVersion = 75F3199D1B9D80D50030FF46 /* MyProject 2.xcdatamodel */; // fileId of the current version
            name = MyProject.xcdatamodeld;
            path = Path/To/MyProject.xcdatamodeld; // set the correct path
            sourceTree = "<group>";
            versionGroupType = wrapper.xcdatamodel;
        };
/* End XCVersionGroup section */
    };
    rootObject = 7564EB681B4AB1560065394B /* Project object */;
} /* EOF */ 
```

8.  您现在应该能够在 Xcode 中从所需的子文件夹打开 xcdatamodel **d文件。**
9.  现在从 xcode 中删除单个 xcdatamodel 文件的额外引用（在开始时创建的那些）。

对不起，答案很长......但问题解决了：D

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-12-07T23:47:08.110

这在 Xcode 8 中仍然是一个问题。

对我来说，简单的解决方案是将我的 .xcdatamodeld 文件从其（黄色）子组文件夹（在项目文件导航器窗格内 - Xcode 的左侧）拖动到应用程序下的最顶层（蓝色的那个）图标）。之后，它立即打开了编辑器。

我通过将它拖回子组重新测试，它再次无法在编辑器中打开，然后回到顶层并正确打开......我不知道为什么会发生这种情况，但至少我可以编辑它再次。

希望这可以帮助某人。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-05T16:45:36.363

重启 Xcode 通常会解决这个问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-04-13T11:47:56.393

这是我解决问题的方法：

1.  在 Xcode 文件树中，删除了 .xcdatamodeld 文件。
2.  当我打开项目文件夹时，文件就在那里。（Xcode 只删除了引用。）
3.  我已将其拖回 Xcode 文件树，选中“如果需要则复制项目”。它没有复制，因为知道该文件已经在项目文件夹下。

问题解决了。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-05T16:58:54.120

在第一次选择时会发生这种行为，但是选择另一个类然后返回 dataModel 允许我在没有 CoreData 的新项目上进行编辑，然后将 coreData 模型添加到项目中。

只是一个想法，您是否添加了实体，或者您甚至无法访问数据模型视图？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-01-20T12:01:23.957

我在 Xcode 中这样解决它：

**右键单击您的项目**（不是您的项目文件夹，我的意思是**带有蓝色 Xcode 图标的**那个！），然后选择“新建文件”并选择正确的文件夹来保存数据模型。

注意：在项目文件夹本身或其子文件夹之一上单击“新建文件”无法以某种方式工作。

# python - 检查子列表是否包含项目

> ID：13728023
> 
> 赞同：8
> 
> 时间：2012-12-05T16:39:05.527
> 
> 标签：python, list

我有一个 Python 列表。如下图所示，我想检查其中一个子列表是否包含项目。以下尝试失败。有谁知道一种简单的方法——不用我自己编写 for 循环？

```
>>> a = [[1,2],[3,4],[5,6],7,8,9]
>>> 2 in a 
```

我希望，`True`但回报是`False`

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-05T19:11:15.270

```
>>> a = [[1,2],[3,4],[5,6],7,8,9]
>>> any(2 in i for i in a)
True 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2020-03-12T15:45:16.203

对于包含一些列表和一些整数`i`的列表，在测试搜索目标是否在`i`.

```
>>> any(2 in i for i in a if isinstance(i, list))
True
>>> any(8 in i for i in a if isinstance(i, list))
False 
```

如果你不检查是否`i`是一个列表，那么你会得到一个类似下面的错误。接受的[答案](https://stackoverflow.com/a/13730677/4518341)是错误的，因为它给出了这个错误。

```
>>> any(8 in i for i in a)
Traceback (most recent call last):
  File "<pyshell#3>", line 1, in <module>
    any(8 in i for i in a)
  File "<pyshell#3>", line 1, in <genexpr>
    any(8 in i for i in a)
TypeError: argument of type 'int' is not iterable 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-05T19:03:14.530

我认为没有某种循环就没有任何方法可以进行测试。

这是一个使用简单`for`循环显式检查子列表中的对象的函数：

```
def sublist_contains(lst, obj):
    for item in lst:
        try:
            if obj in item:
                return True
        except TypeError:
            pass
    return False 
```

当然，这并不能测试对象是否在顶级列表中，如果有多个嵌套级别，它也不会起作用。这是一个使用递归的更通用的解决方案，它将循环放在传递给内置函数的生成器表达式中`any`：

```
def nested_contains(lst, obj):
    return any(item == obj or
               isinstance(item, list) and nested_contains(item, obj)
               for item in lst) 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-12-05T19:09:04.740

简单的方法是：

```
 a = [[1,2],[3,4],[5,6],7,8,9]
  result = [2 in i for i in a]

  True in result --> True 
```

# sql-server - T-SQL：从行到列，但不是实际的枢轴

> ID：13728032
> 
> 赞同：1
> 
> 时间：2012-12-05T16:39:28.293
> 
> 标签：sql-server, sql-server-2008, tsql, pivot, unpivot

是否有 T-SQL (SQL Server 2008R2) 查询转换`TABLE_1`为预期的结果集？

**表格1**

```
+----------+-------------------------+---------+------+
| IdDevice | Timestamp               | M300    | M400 |
+----------+-------------------------+---------+------+
| 3        | 2012-12-05 16:29:51.000 | 2357,69 | 520  |
| 6        | 2012-12-05 16:29:51.000 | 1694,81 | 470  |
| 1        | 2012-12-05 16:29:51.000 | 2046,33 | 111  |
+----------+-------------------------+---------+------+ 
```

预期结果集

```
+-------------------------+---------+--------+---------+--------+---------+--------+
|        Timestamp        | 3_M300  | 3_M400 | 6_M300  | 6_M400 | 6_M300  | 6_M400 |
+-------------------------+---------+--------+---------+--------+---------+--------+
| 2012-12-05 16:29:51.000 | 2357,69 |    520 | 1694,81 |    470 | 2046,33 |    111 |
+-------------------------+---------+--------+---------+--------+---------+--------+ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T16:50:46.253

这仍然是一个`PIVOT`查询，但在`PIVOT`您必须执行`UNPIVOT`您的列之前。

首先，您执行将`UNPIVOT`当前的多列转换为两列 - 一个带有值，另一个带有列名。的关键`UNPIVOT`是数据类型相同，因此在子查询中，我将`cast`任何列指向相同的数据类型：

```
select timestamp,
    value, cast(iddevice as varchar(10)) + '_'+col as col
  from
  (
    select iddevice,
      timestamp,
      cast(m300 as varchar(10)) m300,
      cast(m400 as varchar(10)) m400
    from yourtable
  ) src
  unpivot
  (
    value
    for col in (m300, m400)
  ) unpiv 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/780f9/1)

结果：

```
|                       TIMESTAMP |   VALUE |    COL |
------------------------------------------------------
| December, 05 2012 16:29:51+0000 | 2357,69 | 3_m300 |
| December, 05 2012 16:29:51+0000 |     520 | 3_m400 |
| December, 05 2012 16:29:51+0000 | 1694,81 | 6_m300 |
| December, 05 2012 16:29:51+0000 |     470 | 6_m400 |
| December, 05 2012 16:29:51+0000 | 2046,33 | 1_m300 |
| December, 05 2012 16:29:51+0000 |     111 | 1_m400 | 
```

完成 unpivot 后，您可以应用该`PIVOT`功能：

```
select *
from
(
  select timestamp,
    value, cast(iddevice as varchar(10)) + '_'+col as col
  from
  (
    select iddevice,
      timestamp,
      cast(m300 as varchar(10)) m300,
      cast(m400 as varchar(10)) m400
    from yourtable
  ) src
  unpivot
  (
    value
    for col in (m300, m400)
  ) unpiv
) src1
pivot
(
  max(value)
  for col in ([3_m300], [3_m400],
              [6_m300], [6_m400],
              [1_m300], [1_m400])
) piv 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/64d78/3)

结果：

```
|                       TIMESTAMP |  3_M300 | 3_M400 |  6_M300 | 6_M400 |  1_M300 | 1_M400 |
--------------------------------------------------------------------------------------------
| December, 05 2012 16:29:51+0000 | 2357,69 |    520 | 1694,81 |    470 | 2046,33 |    111 | 
```

`IdDevices`如果您想要转换成列的数量未知，那么您可以使用动态 SQL：

```
DECLARE @cols AS NVARCHAR(MAX),
    @query  AS NVARCHAR(MAX)

select @cols = STUFF((SELECT DISTINCT ',' 
                      + quotename(cast(t.IdDevice as varchar(10)) +'_'
                                  +c.name)
                    from yourtable t
                     cross apply sys.columns as C
                   where C.object_id = object_id('yourtable') and
                         C.name not in ('IdDevice', 'Timestamp')
            FOR XML PATH(''), TYPE
            ).value('.', 'NVARCHAR(MAX)') 
        ,1,1,'')

set @query = 'SELECT timestamp,' + @cols + ' from 
             (
               select timestamp,
                value, cast(iddevice as varchar(10)) + ''_''+col as col
              from
              (
                select iddevice,
                  timestamp,
                  cast(m300 as varchar(10)) m300,
                  cast(m400 as varchar(10)) m400
                from yourtable
              ) src
              unpivot
              (
                value
                for col in (m300, m400)
              ) unpiv
            ) x
            pivot
            (
              max(value)
              for col in (' + @cols + ')
            ) p '

execute(@query) 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/64d78/11)

编辑，如果您需要每个 m 值的总计字段，那么您可以使用：

```
select timestamp,
  [3_m300], [3_m400],
  [6_m300], [6_m400],
  [1_m300], [1_m400],
  [1_m300] + [3_m300] + [6_m300] Total_m300,
  [1_m400] + [3_m400] + [6_m400] Total_m400
from
(
  select timestamp,
    value, cast(iddevice as varchar(10)) + '_'+col as col
  from
  (
    select iddevice,
      timestamp,
      m300,
      m400
    from yourtable
  ) src
  unpivot
  (
    value
    for col in (m300, m400)
  ) unpiv
) src1
pivot
(
  sum(value)
  for col in ([3_m300], [3_m400],
              [6_m300], [6_m400],
              [1_m300], [1_m400])
) piv 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/cfeb5/2)

# c# - WebRequest 在 ASP.NET 应用程序中因“414 Request URI too long”而失败

> ID：13728034
> 
> 赞同：10
> 
> 时间：2012-12-05T16:39:29.887
> 
> 标签：c#, iis, reporting-services, httpwebrequest, getresponse

我们有一个 ASP.NET 应用程序，它在将报表参数作为 WebRequest 传递后请求 HTML 格式的 SSRS 2005 报表。仅当请求具有大量多选参数的报告时，应用程序才会失败，并在该`webRequest.GetResponse()`行抛出“414：请求 URI 太长”错误。

用于发出请求的代码是：

```
HttpWebRequest webRequest = null;
HttpWebResponse webResponse = null;
string webRequestURL = _ReportManager.GetRSUrl(reportID); //this passes the report link on the SSRS server

//make the request

Byte[] bytes = Encoding.UTF8.GetBytes("xml_doc=" + HttpUtility.UrlEncode(webRequestURL));

webRequest = (HttpWebRequest)WebRequest.Create(webRequestURL);
webRequest.Method = "POST";
webRequest.ContentLength = bytes.Length;
webRequest.Timeout = Configuration.WebRequestTimeOut;

RSExecution2005.ReportExecutionService rsE = new RSExecution2005.ReportExecutionService();
rsE.Url = Configuration.ReportExecutionServiceUrl2005;
rsE.Credentials = System.Net.CredentialCache.DefaultCredentials;
webRequest.Credentials = rsE.Credentials;

Stream reqStream = null;
reqStream = webRequest.GetRequestStream();
reqStream.Write(bytes, 0, bytes.Length);
reqStream.Close();

webResponse = (HttpWebResponse)webRequest.GetResponse(); 
```

由于报告在服务器端失败，我查看了 IIS 和 ReportServer 属性以增加 maxUrl、maxRequestLength、MaxQueryString 等字节数（根据[本文](http://www.iis.net/configreference/system.webserver/security/requestfiltering/requestlimits)），但应用程序仍然抛出错误。我已经在 web.config 文件中直接在 IIS 管理器上尝试过。

2005 年的报告服务器版本，它托管在运行 IIS 7 的 Windows Server 2008 上。

* * *

在 David Lively 的建议下，我尝试通过将参数放在正文中来请求 URI。这适用于较小的请求，但对于大型多选参数仍然失败。修改后的代码如下：

```
HttpWebRequest webRequest = null;
HttpWebResponse webResponse = null;
string webRequestURL = _ReportManager.GetRSUrl(reportID); //this passes the report link on the SSRS server

string postData = string.Empty;
string URIrequest = string.Empty;
URIrequest = webRequestURL.Substring(0, webRequestURL.IndexOf("&"));
int requestLen = webRequestURL.Length;
int postDataStart = webRequestURL.IndexOf("&") + 1;
postData = webRequestURL.Substring(postDataStart, (requestLen - postDataStart));

Byte[] bytes1 = Encoding.UTF8.GetBytes(postData);

webRequest = (HttpWebRequest)WebRequest.Create(URIrequest);
                webRequest.Method = "POST";
                webRequest.ContentType = "application/x-www-form-urlencoded";
                webRequest.ContentLength = bytes1.Length;
                webRequest.Timeout = Configuration.WebRequestTimeOut;

RSExecution2005.ReportExecutionService rsE = new RSExecution2005.ReportExecutionService();
rsE.Url = Configuration.ReportExecutionServiceUrl2005;
rsE.Credentials = System.Net.CredentialCache.DefaultCredentials;
webRequest.Credentials = rsE.Credentials;

Stream reqStream = webRequest.GetRequestStream();
reqStream.Write(bytes1, 0, bytes1.Length);
reqStream.Close();
webResponse = (HttpWebResponse)webRequest.GetResponse(); 
```

尽管 webRequest 的 requestURI 不存储参数，但 GetReponse() 函数似乎将参数添加到 webRequest 的 'address' 属性中。这可能是问题吗？如果是这样，如何解决。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-05T20:28:30.813

您可以使用 POST 变量而不是 GET 吗？这样，我知道没有任何限制，因为您的所有数据都将以数据包而不是 HTTP 标头的形式发送。

实际上，看起来您可能正在使用代码中的 POST。您可以查看服务器日志以验证导致此失败的 URI 吗？如果您要发送 POST 数据，则请求 uri 应该不是问题，除非它与您要发布的数据无关。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-25T19:56:10.530

检查您的服务的绑定设置。我猜该服务将允许字符串长度达到 8192。将 te readerQuotas 设置为更大的大小。可能有帮助。

...

```
 <basicHttpBinding>
        <binding name="largeBuffer">
          <readerQuotas
                        maxDepth="2147483647"
                        maxStringContentLength="2147483647"
                        maxArrayLength="2147483647"
                        maxBytesPerRead="2147483647"
                        maxNameTableCharCount="2147483647" />
          <security mode="None"></security></binding>
  </basicHttpBinding> 
```

......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-05T20:25:32.547

由于您已经在使用 POST 来获取报告，因此我建议您将当前在查询字符串中传递的参数放在请求正文中。查询字符串参数适用于有限数量的参数，但不适用于大量项目。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-27T22:22:38.877

我在我的 IIS7 网站上得到了这个。用注册表黑客修复了它，我可以搜索它，但在 3/1 之前无法使用。同时，尝试使用 ip-address 而不是正常 URL 时出现错误，如果没有，则很有可能是同样的问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-27T22:10:15.020

webRequestURL.IndexOf("&") ...这是否意味着“？” 代替 ”＆”？我猜你构造了一个有效的 URL 来查询页面，然后通过在第一个 '&' 之前查找 URL 将其反向工程为一个 POST 请求......

但是，GetResponse 可能会将正文附加到 URL，因为它在 URL 中看到问号并假定参数必须进入 URL？尝试使用零参数且没有“？”进行更精确的 URL 匹配。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-12-27T03:25:59.507

你能显示 webRequestURL 的值吗？

它会“太大”。

如果您将参数传递给此 URL，它们可以在 POST 正文中吗？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-11-28T23:43:37.660

有一个类似的问题，除了 POST 工作正常，但具有完全相同参数的第二个 POST 返回 414。

设置 req.KeepAlive = false; 解决了这个问题，天知道为什么。

# facebook - 将 Facebook 更新流式传输/发布到 wordpress 网站？

> ID：13728036
> 
> 赞同：1
> 
> 时间：2012-12-05T16:39:33.723
> 
> 标签：facebook, wordpress

是否有插件或相对简单的方法可以让 Facebook 群组页面上的更新在 wordpress 网站上实时（或接近实时）显示？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T17:01:32.430

看看这篇文章。这是通过插件搜索您要查找的内容的问题。还要记住，该小组必须是公开的。[http://wpapi.com/10-great-wordpress-plugins-for-facebook/](http://wpapi.com/10-great-wordpress-plugins-for-facebook/)

# jquery - 如何使用jquery过滤json数据

> ID：13728037
> 
> 赞同：0
> 
> 时间：2012-12-05T16:39:35.713
> 
> 标签：jquery, asp.net-mvc

我正在研究 asp.net mvc。我有一个json响应，例如，

```
[{"firstname":"xxx","lastname":"yyy","name":"zzz"},
{"firstname":"aaa","lastname":"bbb","name":"ccc"},
{"firstname":"zzz","lastname":"eee","name":"ddd"},
...] 
```

现在我想按以搜索条件开头的名称过滤上述 json 响应。我一直遵循以下方式，

```
var array=[];
array = jQuery.grep(jsondata, function (n,i) { return n.name.startsWith(searchstring); }); 
```

但我总是得到空数组。请指导我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T16:42:40.703

可能[jQuery.parseJSON()](http://api.jquery.com/jQuery.parseJSON/)会有所帮助。

```
var data = $.parseJSON(<pass server json here>)[0], // 0 is used to match your example
    ret = [],
    rg = new RegExp('^' + search);

for (var i in data){
    if ( rg.test(data[i].name) ){ // '^' symbol is required.
        ret.push(data[i]);
    }
} 
```

# android - 在谷歌地图v2 android中移动标记

> ID：13728041
> 
> 赞同：27
> 
> 时间：2012-12-05T16:39:48.337
> 
> 标签：android, google-maps-api-2

我正在 Android Google maps v2 中进行地图聚类。我只想将标记从一个地理点动画到另一个地理点。有没有办法在谷歌地图 v2 中移动标记？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2012-12-17T10:08:35.220

[在 google map v2演示应用程序](https://github.com/googlemaps/android-samples)中有一个移动标记的示例 .. 在 play 库的示例中！！

我已经调查过了！！这里是移动标记的代码：->

```
 public void animateMarker(final Marker marker, final LatLng toPosition,
            final boolean hideMarker) {
        final Handler handler = new Handler();
        final long start = SystemClock.uptimeMillis();
        Projection proj = mGoogleMapObject.getProjection();
        Point startPoint = proj.toScreenLocation(marker.getPosition());
        final LatLng startLatLng = proj.fromScreenLocation(startPoint);
        final long duration = 500;

        final Interpolator interpolator = new LinearInterpolator();

        handler.post(new Runnable() {
            @Override
            public void run() {
                long elapsed = SystemClock.uptimeMillis() - start;
                float t = interpolator.getInterpolation((float) elapsed
                        / duration);
                double lng = t * toPosition.longitude + (1 - t)
                        * startLatLng.longitude;
                double lat = t * toPosition.latitude + (1 - t)
                        * startLatLng.latitude;
                marker.setPosition(new LatLng(lat, lng));

                if (t < 1.0) {
                    // Post again 16ms later.
                    handler.postDelayed(this, 16);
                } else {
                    if (hideMarker) {
                        marker.setVisible(false);
                    } else {
                        marker.setVisible(true);
                    }
                }
            }
        });
    } 
```

希望对大家有帮助！！

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2016-02-04T15:34:49.247

使用 ValueAnimator 的正确方法：

```
double[] startValues = new double[]{marker.getPosition().latitude, marker.getPosition().longitude};
double[] endValues = new double[]{destLatLng.latitude, destLatLng.longitude};
ValueAnimator latLngAnimator = ValueAnimator.ofObject(new DoubleArrayEvaluator(), startValues, endValues);
latLngAnimator.setDuration(600);
latLngAnimator.setInterpolator(new DecelerateInterpolator());
latLngAnimator.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() {
    @Override
    public void onAnimationUpdate(ValueAnimator animation) {
        double[] animatedValue = (double[]) animation.getAnimatedValue();
        marker.setPosition(new LatLng(animatedValue[0], animatedValue[1]));
    }
});
latLngAnimator.start(); 
```

`DoubleArrayEvaluator`包中不存在`android.animation`，有我的实现：

```
import android.animation.TypeEvaluator;

/**
 * Inspired from {@link android.animation.FloatArrayEvaluator}
 * <p/>
 * This evaluator can be used to perform type interpolation between <code>double[]</code> values.
 * Each index into the array is treated as a separate value to interpolate. For example,
 * evaluating <code>{100, 200}</code> and <code>{300, 400}</code> will interpolate the value at
 * the first index between 100 and 300 and the value at the second index value between 200 and 400.
 */
public class DoubleArrayEvaluator implements TypeEvaluator<double[]> {

    private double[] mArray;

    /**
     * Create a DoubleArrayEvaluator that does not reuse the animated value. Care must be taken
     * when using this option because on every evaluation a new <code>double[]</code> will be
     * allocated.
     *
     * @see #DoubleArrayEvaluator(double[])
     */
    public DoubleArrayEvaluator() {
    }

    /**
     * Create a DoubleArrayEvaluator that reuses <code>reuseArray</code> for every evaluate() call.
     * Caution must be taken to ensure that the value returned from
     * {@link android.animation.ValueAnimator#getAnimatedValue()} is not cached, modified, or
     * used across threads. The value will be modified on each <code>evaluate()</code> call.
     *
     * @param reuseArray The array to modify and return from <code>evaluate</code>.
     */
    public DoubleArrayEvaluator(double[] reuseArray) {
        mArray = reuseArray;
    }

    /**
     * Interpolates the value at each index by the fraction. If
     * {@link #DoubleArrayEvaluator(double[])} was used to construct this object,
     * <code>reuseArray</code> will be returned, otherwise a new <code>double[]</code>
     * will be returned.
     *
     * @param fraction   The fraction from the starting to the ending values
     * @param startValue The start value.
     * @param endValue   The end value.
     * @return A <code>double[]</code> where each element is an interpolation between
     * the same index in startValue and endValue.
     */
    @Override
    public double[] evaluate(float fraction, double[] startValue, double[] endValue) {
        double[] array = mArray;
        if (array == null) {
            array = new double[startValue.length];
        }

        for (int i = 0; i < array.length; i++) {
            double start = startValue[i];
            double end = endValue[i];
            array[i] = start + (fraction * (end - start));
        }
        return array;
    }
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-07-25T15:49:58.957

我是这样做的：

```
private Marker marker; 
```

在**谷歌地图**上**添加** **标记时：**

 **```
if(marker!=null){
   marker.remove();
 }

LatLng mLatLng = new LatLng(Your_Latitude, Your_Longitude);

marker = mMapHistory.addMarker(new MarkerOptions().position(mLatLng).title("My Title").snippet("My Snippet").icon(BitmapDescriptorFactory.fromResource(R.mipmap.ic_launcher))); 
```

希望这种最简单的方法对您有所帮助。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-07-04T13:15:36.693

请试试这个：

```
 private static void addMarkerWithCameraZooming(Context ctx, GoogleMap googleMap, double latitude, double longitude, String title, boolean dragabble) {
            LatLng current_latlng = new LatLng(latitude, longitude);
            googleMap.addMarker(new MarkerOptions().position(current_latlng)
                    .title(title)
                    .snippet(getLocality(current_latlng, ctx))
                    .icon(BitmapDescriptorFactory.fromResource(R.drawable.person_marker))
                    .draggable(dragabble)
                              );
            CameraPosition cameraPosition = new CameraPosition.Builder().target(new LatLng(latitude, longitude)).zoom(12).tilt(30).build();
            googleMap.animateCamera(CameraUpdateFactory.newCameraPosition(cameraPosition));
        }

mGoogleMap.setOnMarkerDragListener(new OnMarkerDragListener() {
            @Override
            public void onMarkerDragStart(Marker markerDragStart) {
                // TODO Auto-generated method stub
                if (BuildConfig.DEBUG)
                Log.i("Marker drag", "start");
            }

            @Override
            public void onMarkerDragEnd(Marker markerDragEnd) {
                if (BuildConfig.DEBUG)
                    Log.i("Marker drag", "start");
            }

            @Override
            public void onMarkerDrag(Marker markerDrag) {
                if (BuildConfig.DEBUG)
                    Log.i("Marker drag", "start");
            }
        }); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-12T18:39:49.317

嗨，我遇到了同样的问题，这是我的帖子[Google Maps Android api v2 和当前位置](https://stackoverflow.com/questions/13844209/google-maps-android-api-v2-and-current-location/13844795#13844795)

您可以使用 Marker 的 remove() 方法用新标记删除旧标记。我希望这是你需要的**

# c# - 带虚线的 TreeView/TreeViewItem ControlTemplates

> ID：13728044
> 
> 赞同：8
> 
> 时间：2012-12-05T16:39:57.653
> 
> 标签：c#, .net, wpf, xaml, mvvm

这似乎应该有一个如此简单的解决方案，但显然它没有。

我进行了广泛搜索，显然似乎无法添加虚线来连接 a 中的节点，这`TreeView`与 WinForms 等效项不同。

我在网上找到了许多资源，人们已将 ControlTemplate 更改为具有连接线的资源。然而，在阅读评论和讨论时，他们似乎都有问题。

我将如何改变 ControlTemplate 来实现这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-07T18:14:47.233

正如所承诺的那样，我编写了控制模板以使 WPF TreeView 看起来像 Winform TreeView。

您可以在[此处](http://intuitiveprogramming.wordpress.com/2012/12/07/how-to-get-the-winform-treeview-style-in-wpf/)或[此处](http://mongoose.codeplex.com/)找到所有代码和文件！

享受 ！

![在此处输入图像描述](../Images/b2d126a51a980b421f51d08c0ca077c8.png)

# database - R：序列化对象推送到文本文件，然后再推送到配置单元并再次返回

> ID：13728049
> 
> 赞同：1
> 
> 时间：2012-12-05T16:40:05.713
> 
> 标签：database, r, serialization, hive

参考以下关于堆栈溢出的问题

*   [R：将对象序列化为文本文件并再次返回](https://stackoverflow.com/questions/2258511/r-serialize-objects-to-text-file-and-back-again)

*   [将 .RData 文件序列化到数据库](https://stackoverflow.com/questions/3955108/serializing-rdata-file-to-database)

我正在努力实现以下目标：假设有 2 个国家/地区的数据

```
d1 <- data.frame(x=rnorm(100),y=rnorm(100))
d2 <- data.frame(x=rnorm(100),y=rnorm(100))
m1 <- lm(x~y,data=d1);m2 <- lm(x~y,data=d2)
m1.ser <- rawToChar(serialize(m1,NULL,ascii=TRUE))
m2.ser <- rawToChar(serialize(m2,NULL,ascii=TRUE))
res <- data.frame(country=c('c1','c2'),model=c(m1.ser,m2.ser)) 
```

在此之后，我想用`write.table`文本写出文件，然后将文件推送到配置单元。因此，由于 \n 行对齐而写出文件时会受到干扰，因此将其推送到配置单元会成为问题。

我也知道我可以使用[摘要](http://cran.r-project.org/web/packages/digest/index.html "消化")包来序列化

```
m1.ser1 <- digest(m1,ascii=TRUE)
m2.ser1 <- digest(m2,ascii=TRUE) 
```

但我不确定如何从他们那里取回原始模型 m1、m2。可能是我错过了一些非常简单的东西。

任何帮助，指针将不胜感激。

另一方面，这个序列化是跨平台的吗？我了解 PMML 正是为此目的而构建的。但是其他语言（如 python、java）是否有可能至少从 R 序列化中找出系数和模型属性？

谢谢，

# php - 无法将 $_SESSION 与 php 登录脚本一起使用

> ID：13728052
> 
> 赞同：1
> 
> 时间：2012-12-05T16:40:11.430
> 
> 标签：php, session, login

我已经研究了 2 天，为什么我的脚本不起作用。我想做的就是创建一个简单的注册、登录、注销脚本。我的注册工作正常。当我登录时，$_SESSION 不想工作，我不知道为什么。这是我的一些代码：

```
$userArr = mysql_fetch_array($query);
$stored_pwd = $userArr['password'];
$id = $userArr['id'];

if (md5($password) == $stored_pwd) {
    $_SESSION['uid'] = $id;
    $_SESSION['start'] = time();
    session_regenerate_id();
    header("Location: ".$redirect);
} else {
    $errors[] = "The passwords don't match. Please try again.";
} 
```

所以我不知道出了什么问题。我在所有页面上调用了 session_start() 以及 ob_start() 和 ob_flush()。任何帮助表示赞赏。

# git - 我可以忽略全局 .gitignore 吗？

> ID：13728053
> 
> 赞同：6
> 
> 时间：2012-12-05T16:40:13.943
> 
> 标签：git, gitignore

我的全局 .gitignore 通常很棒，但对于这个单独的项目，我不希望应用全局规则。

如何删除这个怪异存储库的全局 .gitignore 规则？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-12-05T16:47:39.243

在您的存储库中运行此命令：

```
git config --local core.excludesfile false 
```

# ruby - 转换为 JSON 的 Ruby Hash 仅显示对象名称

> ID：13728054
> 
> 赞同：1
> 
> 时间：2012-12-05T16:40:16.843
> 
> 标签：ruby, json, hash, flickr

我有一个`FlickRaw`想要转换为 JSON 的 Ruby 响应。这是其结构的一部分：

```
#<FlickRaw::Response:0x7fbd11088678
    @h = {
               "id" => "72157628092176654",
          "primary" => "6332013810",
            "owner" => "8623220@N02",
        "ownername" => "The Library of Congress",
            "photo" => [
            [ 0] #<FlickRaw::Response:0x7fbd1106a628
                @h = {
                           "id" => "6332007340",
                       "secret" => "4d92733d70",
                       "server" => "6217",
                         "farm" => 7,
                        "title" => "Woodrow Wilson, Twenty-Eighth President of the United States (LOC)",
                    "isprimary" => "0"
                },
                attr_reader :flickr_type = "photo"
            >, 
```

要将其转换为 JSON，我想简单地采用`response.to_hash.to_json`，但这会导致以下结果：

```
=> "{"id":"72157628092176654",
"primary":"6332013810",
"owner":"8623220@N02",
"ownername":"The Library of Congress",
"photo":["#<FlickRaw::Response:0x007fbd1106a628>","#<FlickRaw::Response:0x007fbd110704d8>","#<FlickRaw::Response:0x007fbd11079c40
... 
```

如您所见，它仅输出`#<FlickRaw::Response>`对象而不是实际内容。所以，它只是停止在那里递归。我如何让它实际输出类似于我从`awesome_print`上面得到的输出的东西，其中也显示了各个照片字段？

我尝试了以下方法，这让我得到了照片数组的正确表示：

```
photos.photo.map { |h| h.to_hash  }.to_json 
```

但这似乎相当复杂。有没有更简单的方法可以一次性将完整的响应格式化为 JSON，而无需先修复照片数组？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T17:53:17.023

显然该类型`FlickRaw::Response`没有默认的 JSON 表示。

您有两个选择，要么像您一样将照片转换为哈希，要么使用以下方法对`FlickRaw::Response`类进行猴子补丁`to_json`

```
class FlickRaw::Response
  def to_json
    to_hash
  end
end 
```

这应该可以解决问题。

# c# - 颜色框弹出窗口内的aspx页面未触发服务器端代码

> ID：13728060
> 
> 赞同：-1
> 
> 时间：2012-12-05T16:40:32.600
> 
> 标签：c#, asp.net, updatepanel, colorbox

我有以下情况：

一个 aspx 页面 (index.aspx) 在颜色框弹出窗口中打开另一个 aspx (popups/signin.aspx) 页面，当 signin.aspx 打开时，我有一个用户名和密码文本框和一个 asp 按钮，一旦我单击 asp 按钮页面重定向 popups/signin.aspx 甚至不去按钮的点击事件代码。

我在 signin.aspx 中也有一个更新面板，但按钮和更新面板都不起作用。

任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T23:28:09.960

我设法通过使用带有 jquery 请求的 html 页面来克服这个问题，并在 jquery ajax 函数内部重新加载父页面。

# java - 如何使用注释映射 Hibernate 与具有特定值的其他字段的连接？

> ID：13728062
> 
> 赞同：0
> 
> 时间：2012-12-05T16:40:32.553
> 
> 标签：java, hibernate, jpa-2.0

我有一个实体 A 和一个实体 B。实体 B 是和三个。并且实体 A 始终只与一个实体 B 链接。

下面将这种关系表示为一棵树：

```
A1
+-B1
 +-B2
 +-B3
 | +-B4
 |
 +-B5
 +-B6
   +-B7
     +-B8 
```

这是存储在数据库中以表示实体 B 的数据：

```
# parent_id entity_a_id 名称
1 无 1 B1
2 1 1 B2
3 1 1 B3
4 3 1 B4
5 1 1 B5
6 1 1 B6
7 6 1 B7
8 7 1 B8

```

我想在实体A上映射以带上根实体B，这意味着我要带上实体B，其中entity_a_id与当前（可能mappedBy）相同且parent_id为null。到目前为止，我还没有找到如何将自定义查询添加到关系中（parent_id 为空）。可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T16:53:07.603

如果我正确理解了要求，您希望将关系字段限制为仅包含基于条件的某些实体。在这种情况下，您可能会发现[**Hibernate 过滤器**](http://docs.jboss.org/hibernate/orm/3.6/reference/en-US/html/filters.html)很有用。

**编辑**：Hibernate 还具有`@Where`条件连接的注释，看看[**这个简单的例子**](https://stackoverflow.com/questions/2805322/hibernate-custom-join-clause-on-association)

# android - 如何在 Android 中链接外部库

> ID：13728063
> 
> 赞同：1
> 
> 时间：2012-12-05T16:40:38.217
> 
> 标签：android, c++, android-ndk, libxml2, icu

我对 Android 很陌生（准确地说是 1 天），所以请耐心解释，:)

要求是将在 iOS 上运行的现有代码（C 和 C++）移植到 Android。除了'libxml2'之外，几乎一切都很顺利。代码依赖于此。作为从这个论坛得到的建议之一，我得到了'libxml2'的源代码并为Android编译了它。但是当尝试创建它的共享库时，它无法解决外部依赖关系。对于依赖于“ucnv_*”的几乎每个函数，它都会抛出错误“对'ucnv_close'、'ucnv_open'、...的未定义引用”。

我认为“ucnv_*”作为“icu4c”外部库出现。我也尝试编译它，但徒劳无功。这会引发错误“'dynamic_cast' not allowed with -fno-rtti”和“cannot use typeid with -fno-rtti”。我在这里完全不知道（不完全了解启用/禁用标志“-fno-rtti”及其意义），并且也不喜欢破解编写良好的代码。

那么，任何人都可以解释如何链接（共享和静态）/集成外部库，特别是“libxml2”（如果需要，也可以是“icu4c”）与 C/C++ 代码，.??? （我在 *.jar 上看到了解释，但无法理解它如何适合这里）任何解决/理解我面临的问题的信息都会非常有帮助，..!!!

谢谢阅读，..

# algorithm - 保持更改数组的排序顺序的算法

> ID：13728071
> 
> 赞同：1
> 
> 时间：2012-12-05T16:40:59.270
> 
> 标签：algorithm, sorting

我有 20 项数组，其中包含十进制数字。它们是未分类的。在每次迭代中，只有几项数组更改（约 1-3 项 20 项数组）。每次迭代后，我需要有相同的数组但“排序”。

我不应该修改原始数组，而是需要维护表示相同数组但已排序的“并行”结构。允许使用指针。

我确实关心延迟，所以我需要直截了当的解决方案！显然我可以使用双链表来“记住”排序顺序，但我将花费 K*O(n)（具有相当大的 K）来更新这个列表，这听起来有点贵。我正在寻找比两链表更好的东西。

如果这件事我将在 c# 上实现它

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T16:50:00.523

假设您跟踪 1-3 个更改的元素，则可以**使用一步 merge-sort**和对数组的额外迭代非常有效地完成

1.  将所有元素收集到两个数组`changed`和`notChanged`¹ - 按顺序。
2.  排序`changed`（对于 1-3 个元素，它应该相当容易和快速）。
3.  用于`merge(changed,notChanged)`获取排序数组

我相信复杂性是`O(n)`相当好的常数，因为`merge()`它是在一次迭代中完成的，收集阶段也是如此。此外，由于我们仍在使用数组，因此这种方法的缓存效率应该很高。

* * *

(1) 注意`notChanged`是排序的，因为没有改变的元素是在它们之间排序的！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T16:45:28.147

只需使用两种结构：这很简单，很健壮，因为您使用现有的运行良好的集合，并且实施成本便宜：

使用两个集合：

一个未排序：例如在 java ArrayList 中，它是一个动态增长的数组
一个已排序：使用任何你想要的。
像往常一样，这两个“集合”都指向内容对象。

在多线程的情况下使事情线程安全：

将两个集合封装在一个类中，您可以在其中同步所有访问，以便对两个集合的读取和写入永远同步。

# asp.net-mvc - 使用 knockoutjs 绑定复选框列表

> ID：13728082
> 
> 赞同：0
> 
> 时间：2012-12-05T16:41:30.917
> 
> 标签：asp.net-mvc, model-view-controller, knockout.js

我正在尝试使用 knockoutjs 绑定复选框列表。我有一个与配置文件列表相关的用户，我想要的是在加载页面时使用用户配置文件初始化复选框列表。

这是我的代码

```
var userProfileList = [];
var jsonUserAdminModel = null;
var viewModel = {
    ,firstName: ko.observable()
    ,lastName: ko.observable()
    ,userId: ko.observable()
    ,userProfiles: ko.observableArray(userProfileList)
    ,result: ko.observable()
};

viewModel.result = ko.computed(function () {
    jsonUserAdminModel = {
        UserId: (this.userId() != undefined ? this.userId() : null)
        ,FirstName: (this.firstName() != undefined ? this.firstName() : null)
        ,LastName: (this.lastName() != undefined ? this.lastName() : null)            
    }
    return jsonUserAdminModel;
}, viewModel);

$(document).ready(function () {               
        ko.applyBindings(viewModel);
        //Init the list of all profiles
        viewModel.userProfiles(@Html.Raw(Json.Encode(Model.Profiles)));
    }); 
```

HTML

```
<div id="UserProfiles" data-bind="foreach: userProfiles" style="margin: 10px">
    <input type="checkbox" data-bind="value: ProfileId" /><span data-bind="text: Name"></span>
</div> 
```

我想检查用户默认配置文件并绑定它。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T17:34:12.640

You're going to want to bind your input to a `checked` [observable](http://knockoutjs.com/documentation/observables.html) on the user profile object. To do that, you're going to need to create a profile viewmodel and convert your raw data into instances of that viewmodel so that their properties can be made observable. You could also use the [`ko.mapping`](http://knockoutjs.com/documentation/plugins-mapping.html) plugin to achieve this.

Then your HTML would look something like this:

```
<div id="UserProfiles" data-bind="foreach: userProfiles" style="margin: 10px">
    <input type="checkbox" data-bind="attr: {value: ProfileId() }, checked: isChecked" /><span data-bind="text: Name"></span>
</div> 
```

# php - 设计连接到数据库的应用程序

> ID：13728084
> 
> 赞同：1
> 
> 时间：2012-12-05T16:41:33.713
> 
> 标签：php, c++, iphone, database

我创建了一个网站 (php)，它连接到一个数据库，因此它可以拥有用户和发布材料。把它想象成一个论坛。现在我将如何制作一个连接到同一数据库的 iPhone 应用程序。我已经在自学 C++ 来制作应用程序，但不确定如何将它连接到数据库。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T16:44:36.973

做基于 Web 的数据库，最佳实践***是使用 HTTP 请求到 PHP 脚本。这样您就不必从应用程序建立数据库连接，从而将用户名和密码排除在实际项目之外。创建一些 PHP 脚本，通过发送 POST 和 GET 变量来满足您的需求。

***根据我的经验和偏好

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T17:34:36.473

You just setup a [RESTful webservice](http://www.slimframework.com/), then access to it on Obj-C via [Restkit](http://restkit.org/).

EDIT: btw if you haven't got fancy app needs, just [make your website responsive](http://en.wikipedia.org/wiki/Responsive_web_design) and you'l be done.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-05T16:46:08.260

您需要为所有可能的操作构建 API 端点。

例如帖子/查看帖子/编辑帖子/添加

[REST http://en.wikipedia.org/wiki/Representational_state_transfer](http://en.wikipedia.org/wiki/Representational_state_transfer)是一种流行且有据可查的架构

如果您使用的是 PHP 框架，则通常有用于创建 API 的帮助库

本教程应该可以帮助您理解它 [http://net.tutsplus.com/tutorials/php/creating-an-api-centric-web-application/](http://net.tutsplus.com/tutorials/php/creating-an-api-centric-web-application/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-05T17:16:32.090

您的应用可以通过向服务器上的 URL 发出 HTTP 请求来连接到您的服务。你可以使用任何你喜欢的后端，我个人使用 PHP 和 MySQL，因为几乎所有的托管服务都支持这些工具。您通过定义执行功能的 URL 来形成查询。通常，您希望在更改服务器上的数据时使用 POST 请求，而在对信息进行只读请求时使用 GET 请求。

你必须小心设计你的 URL 和你的服务器以防止未经授权的访问，我不会在这里描述细节，但网络上有很多关于这方面的好建议。我将在这里重点介绍如何使用 URL 连接到您的服务。

我建议使用有助于发送请求和接收响应的库。回到（大约一年前）当我积极开发一个应用程序时，我使用了免费提供的 AsiHTTPRequest 库，但我现在看到作者已经停止支持它。我的 0.02 美元：它适用于我的应用程序：[http ://allseeing-i.com/ASIHTTPRequest/](http://allseeing-i.com/ASIHTTPRequest/)

有两个部分：1）发送请求，2）接收和处理响应。您通常希望确保您的请求是异步发出的，这样您的应用程序不会在请求通过 Internet、服务器处理请求并且您收到响应时冻结。

为了方便解析结果，请让您的 Web 应用后端以 Apple plist 格式发送响应。或者您可以使用 XML，但我喜欢 plist，因为 SDK 中包含对它的支持。

这是我的应用程序中执行此操作的代码：

```
// this allows you to switch between the "live" web service and a local development copy
#ifndef _USE_LOCAL_SERVER_
#define kAppCustomerInfoURL @"https://mysite.com/path/to_my/service/"
#else
#define kAppCustomerInfoURL @"http://localhost/path/to_my/service/"
#endif

NSURL *url = [NSURL URLWithString:kAppCustomerInfoURL];
ASIFormDataRequest *request = [ASIFormDataRequest requestWithURL:url];
// udm is my singleton that holds properties for the current user
[request setPostValue:[udm getProperty:kNameProperty] forKey:@"name"];
[request setPostValue:[udm getProperty:kPhoneProperty] forKey:@"phone"];
[request setPostValue:[udm getProperty:kEmailProperty] forKey:@"email"];
[request setPostValue:[udm getProperty:kCityProperty] forKey:@"city"];
[request setPostValue:[udm getProperty:kAddressProperty] forKey:@"address"];
[request setPostValue:[udm getProperty:kDeliveryNotesProperty] forKey:@"comments"];
[request setPostValue:[NSString stringWithFormat:@"%u", arc4random()] forKey:@"random"];

[request setValidatesSecureCertificate:NO];
[request setDelegate:self];
[request startAsynchronous]; 
```

您的对象需要实现 requestFinished: 和 requestFailed: 方法：

```
- (void)requestFinished:(ASIHTTPRequest *)request
{
    NSString *response = [request responseString];

    NSData* plistData = [response dataUsingEncoding:NSUTF8StringEncoding];
    NSPropertyListFormat format;
    NSString *errorStr;
    NSDictionary* plist = [NSPropertyListSerialization propertyListFromData:plistData 
                                                           mutabilityOption:NSPropertyListImmutable 
                                                                     format:&format 
                                                           errorDescription:&errorStr];
    if ( ! plist ) 
    {
        // NSLog( @"Error: %@", errorStr );
        [errorStr release];
        return;
    }

    for ( NSString *key in [plist allKeys] )
    {
         if ( [key isEqualToString:@"result"] )
         {
              NSString *resultStr = [plist objectForKey:@"result"];
              if ( ! [resultStr isEqualToString:@"ok"] )
              {
                   // set an error
              }
         }
        // more cases 
     }
} 
```

这是我的响应失败方法，它设置了一些应用程序状态并发送请求已完成的通知，应用程序的其他部分可以在请求完成时使用它来更新自己：

```
- (void)requestFailed:(ASIHTTPRequest *)request
{
    NSError *error = [request error];
    NSLog( @"update customer info failed: %@", [error localizedDescription] );

    self.syncDataToServerOK = NO;

    [[NSNotificationCenter defaultCenter] postNotificationName:kUserDataSyncFinishedNotification object:nil];
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-05T17:15:04.870

我是 iphone 开发的新手，并且已经在 iPhone 上工作了一个月左右。想给一些提示：

1）首先阅读Objective-C，因为您正在制作Iphone应用程序以及Xcode的一般工作原理

2) 接下来连接到 Web API，您可以使用 AFNetworking。这是一个入门[教程。](http://mobile.tutsplus.com/tutorials/iphone/ios-sdk_afnetworking/)您需要知道获取数据的 API 是什么。

3) 接下来，您需要根据 API 中的 JSON 或 XML 数据来解析数据。这将允许您获取数据。

4)您现在可以使用 UI 在 Xcode 中显示

# c# - 更改未聚焦的选定数据网格行的颜色

> ID：13728085
> 
> 赞同：1
> 
> 时间：2012-12-05T16:41:34.860
> 
> 标签：c#, wpf, xaml

我已经在我的数据网格行上实现了一个上下文菜单。当您右键单击一行时，它会在打开上下文菜单之前短暂突出显示它。据我了解，这是因为数据网格正在失去焦点。

我正在尝试使用 更改未聚焦但已选择的颜色`SystemColors.ControlBrushKey`，但它没有效果。这是不正确的吗？我找到了一些`ListBox`相关的解决方案，这是公认的解决方案。

```
<Style x:Key="DefaultRowStyle" TargetType="{x:Type DataGridRow}">
    <Style.Resources>
        <SolidColorBrush x:Key="{x:Static SystemColors.ControlBrushKey}" Color="Black" />
        <SolidColorBrush x:Key="{x:Static SystemColors.HighlightBrushKey}" Color="Yellow" />
    </Style.Resources>
</Style> 
```

供参考的系统颜色的完整列表：http: [//blogs.msdn.com/cfs-filesystemfile.ashx/__key/CommunityServer-Blogs-Components-WeblogFiles/00-00-01-38-64-SystemColors+Reference/6266。 swatch_5F00_Amalgam.png](http://blogs.msdn.com/cfs-filesystemfile.ashx/__key/CommunityServer-Blogs-Components-WeblogFiles/00-00-01-38-64-SystemColors+Reference/6266.swatch_5F00_Amalgam.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T17:38:56.410

您唯一的选择是从[此处](http://msdn.microsoft.com/en-us/library/ff506248%28v=vs.100%29.aspx)复制样式 XAML并更改其中的颜色设置。XAML 中的注释表明，除非您更改样式，否则它们提供的 XAML 中的许多状态是无法区分的。

```
<VisualState x:Name="Unfocused_Selected">
  <Storyboard>
    <ColorAnimationUsingKeyFrames Storyboard.TargetName="DGR_Border" Storyboard.TargetProperty="(Panel.Background).(GradientBrush.GradientStops)[0].(GradientStop.Color)">
      <EasingColorKeyFrame KeyTime="0" Value="{StaticResource ControlMediumColor}" />
    </ColorAnimationUsingKeyFrames>
    <ColorAnimationUsingKeyFrames Storyboard.TargetName="DGR_Border" Storyboard.TargetProperty="(Panel.Background).(GradientBrush.GradientStops)[1].(GradientStop.Color)">
      <EasingColorKeyFrame KeyTime="0" Value="{StaticResource ControlDarkColor}" />
    </ColorAnimationUsingKeyFrames>
  </Storyboard>
</VisualState> 
```

编辑：我链接了错误的页面。这就是 Silverlight 的风格（doh！）。我已经修复了指向 WPF 样式的链接。我还复制了 WPF 样式的适用区域。

# git - 如何删除“由他们添加”的所有文件？

> ID：13728090
> 
> 赞同：2
> 
> 时间：2012-12-05T16:41:53.463
> 
> 标签：git, merge

而不是`git rm $(git ls-files -z -d)`我需要`git rm $(git ls-files -z -u)`，但它不起作用，我认为这是因为`-u`向输出添加了其他垃圾，而不是像其他开关一样仅添加文件名。有替代方法吗？我只想删除 git status 的“未合并路径”部分（因此，这些是该部分中唯一的文件）中 git 列为“由它们添加”的所有文件`-u`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T17:56:28.300

您可以将输出通过管道传输到`cut`或`sed`获取命令输出的特定部分。否则，git 还提供`--raw`或`--porcelain`选项以脚本友好的语法形成输出。

# r - 在实例数相等的情况下随机选择 1 到 10 之间的值

> ID：13728095
> 
> 赞同：2
> 
> 时间：2012-12-05T16:42:21.263
> 
> 标签：r

> **可能重复：**
> [在 R 中选择和插入值的唯一次数](https://stackoverflow.com/questions/13721050/select-and-insert-value-unique-number-of-times-in-r)

我想生成 2000 个介于 1 和 10 之间的随机数，这样对于每个随机数我都有相同数量的实例。

在这种情况下，每个数字 200。

应该随机的是它的生成顺序。

我有以下问题：

我有一个包含 2000 个条目的数组，但不是每个条目都有唯一值，例如它的开头是这样的：

```
11112233333333344445667777777777 
```

包含 2000 个条目。

我想生成随机数并为每个 UNIQUE 值分配一个单独的随机数，但每个值都有一个条目

所以我的预期结果是这样的：

```
original array: 11112233333333344445667777777777
random numbers: 33334466666666699991778888888888 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-05T16:47:50.930

您可以通过几个步骤来做到这一点：

```
my_numbers <- rep(1:10, each=200)
my_randomizer <- sample(seq_along(my_numbers), length(my_numbers))

my_random_numbers <- my_numbers[my_randomizer] 
```

* * *

基于编辑：

我会用`rle`. 听起来您没有数组，而是向量：

```
my_array_rled <- rle(my_array)

my_random_numbers <- sample(1:10, length(unique(my_array)))

my_array_rled$values <- factor(my_array_rled$values)
levels(my_array_rled$values) <- my_random_numbers

my_array_randomized <- inverse.rle(my_array_rled) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T16:51:04.807

如果我理解正确，您可以使用“rep”复制随机数 200 次，并使用“sample”随机化生成的向量。

```
x <- sample(rep(runif(2000,1,10),200)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-05T17:44:33.500

对于这个场景，`table`函数 with`sample`非常方便：

```
set.seed(1)

     ## ASSUMING ORIGINAL IS A VECTOR
original <- c(1, 1, 1, 1, 2,2,3,3,3,3,3,3,3,3,3,4,4,4,4,5,6,6,7,7,7,7,7,7,7,7,7,7)

     ## CREATE A TABLE OF ALL THE VALUES 
tabl <- table(original)

     ## RNG is the sample range to select from.  Assuming 1:10 in this example
RNG <- 1:10

     ## PICK VALUES RANDOMLY FROM RNG
tabl[] <- sample(RNG, length(tabl), replace=FALSE)
# note that the `names` of `tabl` will contain the values from `original`
# whereas the values of `tabl` will contain the new random value. 

     ## ASSIGN NEW VALUES 
randomNums <- original
for(i in seq(length(tabl)))
  randomNums[ original==as.numeric(names(tabl))[[i]] ] <- tabl[[i]] 
```

### 结果：

```
 rbind(orig=original, rand=randomNums)

orig:  1 1 1 1  2 2  3 3 3 3 3 3 3 3 3  4 4 4 4  5  6 6  7 7 7 7 7 7 7 7 7 7
rand:  3 3 3 3  4 4  5 5 5 5 5 5 5 5 5  7 7 7 7  2  8 8  9 9 9 9 9 9 9 9 9 9 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-05T17:14:24.807

非矢量化代码：

```
# using a seed for reproducible example
set.seed(2)

original_array <- c(1,1,1,1,2,2,3,3,3,3,3,3,3,3,3,4,4,4,4,5,6,6,7,7,7,7,7,7,7,7,7,7)
random_numbers <- numeric(length=length(original_array))

rdnum <- sample(unique(original_array), length(unique(original_array)))

for ( i in  1:length(unique(original_array)))
random_numbers[original_array == i] <- rdnum[i]

random_numbers
2 2 2 2 5 5 3 3 3 3 3 3 3 3 3 1 1 1 1 6 7 7 4 4 4 4 4 4 4 4 4 4 
```

# jquery - .each() jquery 中的并行选项

> ID：13728097
> 
> 赞同：1
> 
> 时间：2012-12-05T16:42:28.420
> 
> 标签：jquery, parallel-processing, each

我有 jquery 应用程序，在页面中我有大约 1500 个复选框。我确实搜索了过滤器的文本框并隐藏了不相关的行。它的工作..但是..问题是它需要很多时间（超过 20 秒）。我的代码是：

```
 $('#tb_values').keyup(function () { 
        $("#div_values input").each(
            function () {                 
                var value_a = $(this).attr('value');                   
                var tb_text = $('#tb_values').val();
                if (value_a.indexOf(tb_text, 0) == -1) {
                    $(this).parent().hide();
                }
                else {
                    $(this).parent().show();
                }
            });        

}); 
```

我怎样才能以并行方式\更快的方式做到这一点？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T17:33:52.313

你有一个性能问题。每次迭代都会导致可能整个页面的重绘、重排/重布局。您应该找到另一种仅导致重绘一次的方法。我没有看到完整的图片，所以我只能猜测。它可能是这样的：

```
var html = '';
$("#div_values input").each(function () {  
    var $this = $(this);
    var value_a = this.value;  
    if (value_a.indexOf(tb_text) == -1) {
        html += '<div class="hidden"><input type="radio" ... /></div>';
    }
    else {
        html += '<div class="visible"><input type="radio" ... /></div>';
    }
});
$('#div_values').html(html); 
```

这种方法非常快，但有几个缺点：

1.  您需要一个单独的函数来重新创建此结构并在几乎每次更改时重新创建它。
2.  生成元素的所有事件处理程序和自定义数据都将丢失。

您也可以尝试克隆您的容器，对克隆的结构执行相同的操作，然后再将其替换为新的。

```
var currentInstance = $('#div_values');
var clonedInstance = currentInstance.clone();
clonedInstance.find('input').each(...);
currentInstance.after(clonedInstance);
currentInstance.remove(); 
```

它应该工作得很好，但没有那么快`.html(...)`

您也可以查看[documtFragments](https://developer.mozilla.org/en-US/docs/DOM/document.createDocumentFragment)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T16:45:38.473

如果可能的话，也许尝试缓存一些选择器并使用本机方法。

```
$('#tb_values').keyup(function () { 
        var tb_text = $('#tb_values')[0].value;
        $("#div_values input").each(
            function () {  
                var $this = $(this);               
                var value_a = this.value;  
                if (value_a.indexOf(tb_text) == -1) {
                    $this.parent().hide();
                }
                else {
                    $this.parent().show();
                }
            });        

}); 
```

# java - 在JAVA中动态地将多个值添加到一个键中

> ID：13728098
> 
> 赞同：2
> 
> 时间：2012-12-05T16:42:27.330
> 
> 标签：java, android, collections

我通过查询以字符串形式收到多条记录。当我在循环中解析它们时，我想动态地将具有相同“长”键的记录存储在集合中。就像，插入键和值，如果键存在，它会添加到值中，如果不存在，则创建一个新键。这样做最有效的方法是什么？我可以使用多个数组来做到这一点，但我更喜欢更干净的方式。

我不能使用 a`HashMap`因为我必须首先将记录存储在`Array`or`ArrayList`然后插入它，这违背了目的，因为无论如何我必须首先按键对列表进行分组。没有。的记录一次不会超过 50 个。

例如数据：

```
for(i = 0; i < numRecords; i++ ) {  
    Data: 1 "A", 2 "B", 1 "C", 3 "D", 1 "E"   
} 
```

我想要一个集合，在循环内我可以添加：1“A”等等..

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-05T16:46:05.457

我想`Map<Long,List<String>>`可能会对你有所帮助。

```
Map<Long,List<String>> map = new HashMap<>();
...
if(map.get(key)!=null){
  List<String> list = map.get(key);
  list.add(value);
}else{
  List<String> list = new ArrayList<>();
  list.add(value);
  map.put(key,list);
} 
```

# windows-phone-7 - 在嵌套列表框中绑定到多个类

> ID：13728100
> 
> 赞同：0
> 
> 时间：2012-12-05T16:42:34.127
> 
> 标签：windows-phone-7, binding

我正在制作一个嵌套列表框，主要是因为我需要在一个列表框中绑定多个类，而我无法做到这一点，因此是嵌套列表框。

这是我在 XAML 页面中所做的：

```
<ListBox Name="abcd" Margin="10,0,30,0" ItemsSource="{Binding Title}"     SelectionChanged="ListBox_SelectionChanged" Height="486" Width="404" FontSize="20">
                <ListBox.ItemTemplate>
                    <DataTemplate >
                        <StackPanel Margin="0,0,10,0" Width="380" Height="140">
                            <Grid  >
                            <TextBlock Text="{Binding cdata}" TextWrapping="Wrap" FontSize="{StaticResource PhoneFontSizeLarge}" />
                                <ListBox Name="ab" ItemsSource="{Binding Description}" FontSize="14">
                                    <ListBox.ItemTemplate>
                                        <DataTemplate>
                                            <StackPanel Width="380" Height="100">
                                                <Grid>
                                                   <TextBlock Text="{Binding cdata}" TextWrapping="Wrap" FontSize="{StaticResource PhoneFontSizeLarge}" />
                                                </Grid>
                                            </StackPanel>
                                        </DataTemplate>
                                    </ListBox.ItemTemplate>
                                </ListBox>
                            </Grid>
                        </StackPanel>                            
                    </DataTemplate>
                </ListBox.ItemTemplate>
            </ListBox> 
```

其中ListBox“abcd”必须与类标题和“ab”绑定到类Description。这两个类只有一个字符串字段“cdata”。

在 xaml.cs 我做：

```
abcd.ItemsSource=from article in root.openfooty.news.article
                          select new Classes.Title 
                             { 
                                  cdata = article.title.cdata
                             };

       ab.ItemSource = from article in root.openfooty.news.article
                            select new Classes.Description
                              { 
                                  cdata = article.description.cdata
                              }; 
```

与“abcd”绑定工作正常，但与“ab”它说“nam ab 在当前上下文中不存在”

任何帮助将非常感激。感谢：D

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T15:26:01.097

你为什么不写一个这样的类

```
public class TitleDescription
{
    public string title { get; set; }
    public string description { get; set; }
} 
```

并尝试数据绑定？

```
abcd.ItemsSource=from article in root.openfooty.news.article
                      select new Classes.TitleDescription 
                         { 
                              title = article.title.cdata,
                              description = article.description.cdata
                         }; 
```

并且只有一个这样的列表框

```
<ListBox Name="abcd" Margin="10,0,30,0" SelectionChanged="ListBox_SelectionChanged" Height="486" Width="404" FontSize="20">
            <ListBox.ItemTemplate>
                <DataTemplate >
                    <StackPanel Margin="0,0,10,0" Width="380" Height="140">
                        <Grid  >
                            <TextBlock Text="{Binding description}" TextWrapping="Wrap" FontSize="{StaticResource PhoneFontSizeLarge}" />
                            <TextBlock Text="{Binding title}" TextWrapping="Wrap" FontSize="{StaticResource PhoneFontSizeLarge}" />
                        </Grid>
                    </StackPanel>
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox> 
```

# mainframe - 用二进制值附加记录

> ID：13728103
> 
> 赞同：0
> 
> 时间：2012-12-05T16:42:43.783
> 
> 标签：mainframe, syncsort

我有一个 FB 长度=80 的文件。我想`1`在位置 81 处附加固定值数字，如果位置 80 =`'Y'`

这个附加值应该是`S9(9) BINARY`从字帖中查看时的值。

附加字段将`SUM FIELDS`在单独的步骤中使用。

我如何对`SORT SYSIN`卡进行编码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T15:12:33.593

```
OPTION COPY
INREC IFTHEN=(WHEN=(80,1,CH,EQ,C'Y'),OVERLAY=(81:+1,TO=BI,LENGTH=2)) 
```

无需将此与您使用 SUM 分开。显然您不会使用 OPTION COPY。

如果您在第 80 列中对 Y 以外的记录求和，则需要先使用 IFTHEN=(WHEN=INIT 将所有内容设置为零。

由于这是一项大型机任务，因此如果您使用了该标签，您将得到较早的响应。

# php - 使用单个 PDO 查询意外达到 PHP 内存限制？

> ID：13728106
> 
> 赞同：17
> 
> 时间：2012-12-05T16:42:55.437
> 
> 标签：php, mysql, memory, pdo

我有一个非常简单的查询，看起来像：

```
$result = $pdo->query('SELECT * FROM my_table');

foreach($result as $r) {
    // do some stuff
} 
```

但是当我运行它时，我收到以下错误：

> 致命错误：第 15 行 /path/to/myfile.php 中允许的内存大小为 134217728 字节已用尽（尝试分配 32 字节）

“第 15 行”是该`$pdo->query`行。

如果我放在`die()`查询之后，我仍然会得到同样的错误。

我认为这应该一次只取一行；为什么它使用这么多内存？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-12-05T18:15:19.857

> 调用查询前内存使用量为 635384 字节。我猜查询会为每条记录分配块。

叮叮叮！

当连接到 MySQL 时，PHP 喜欢使用[缓冲查询](http://php.net/mysqlinfo.concepts.buffering)。无论您使用什么方法进行连接，这都是正确的。使用缓冲查询时，会立即获取整个结果集，而不是在您询问时获取。这*通常*对性能有好处，因为往返次数较少。

但就像 PHP 中的所有内容一样，有一个问题。如缓冲页面所述：

> 当使用 libmysql 作为库时，PHP 的内存限制不会计算用于结果集的内存，除非数据被提取到 PHP 变量中。使用 mysqlnd 占用的内存将包括完整的结果集。

您使用的是 PHP 5.3，这意味着您很有可能使用的是 mysqlnd。

您需要在此处关闭缓冲查询。它在 MySQL 的每个 PHP 接口中都以不同的方式完成：

*   对于 PDO，您需要将`PDO::MYSQL_ATTR_USE_BUFFERED_QUERY`属性设置为`false`.
*   对于 mysqli，您需要将`MYSQLI_USE_RESULT`常量传递给[`query`](http://php.net/mysqli.query)方法。
*   对于 mysql，您需要调用`mysql_unbuffered_query`而不是`mysql_query`.

完整的详细信息和示例在页面上。

## 大胖无缓冲查询陷阱！

在发出另一个查询之前，您**必须**正确关闭语句句柄并释放结果集：

*   在 PDO 中，这意味着调用[`closeCursor`](http://php.net/pdostatement.closecursor)语句句柄。
*   在 mysqli 中，这意味着调用[`free_result`](http://php.net/mysqli-stmt.free-result)语句句柄或[`free`](http://php.net/mysqli-result.free)结果句柄，具体取决于您正在使用的内容。
*   在 mysql 中，这意味着调用[`mysql_free_result`](http://php.net/function.mysql-free-result)

不这样做将导致错误。

# java - Java多继承问题

> ID：13728113
> 
> 赞同：0
> 
> 时间：2012-12-05T16:43:15.173
> 
> 标签：java, oop

我有一个这样的问题：

想想这样的场景

```
public class Animal {

    protected String Name;
    Boolean canWork;

}

public class Dog {

  Enum TailType

} 
```

而且**我需要在**扩展这两个类的第三级类中同时拥有这两个类属性..但是使用接口我认为这无法实现。是否可以使用设计模式或其他方法来做到这一点？

摘要：我想拥有从两个类到一个具体类的属性

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T16:54:20.160

您可以让 Dog 扩展 Animal，然后将 Dog 扩展为第三类，但除非您的第三类是贵宾犬，否则您可能会遇到尚未意识到的问题。仅当关系是建模标准时才适合继承，并且仅扩展对象以获取其功能是错误的方法。继承应该遵循IS-A原则。那是您的子类 IS-A 在建模方面的基类。如果它没有通过该测试，那么您不应该使用继承。毕竟你可以使用委托来获得它们的功能。那个意思：

```
public class SomeClass {

    private Dog dog;

    public void bark() {
       dog.bark();  // this is reusing the functionality without extending
    }
} 
```

现在 SomeClass 可以调用或调用 Dog 上的方法而无需扩展它。现在这样做的缺点是对 Dog 的引用不能指向 SomeClass，但如果 SomeClass 不是 Dog，那可能很好。但是，如果您必须允许 Dog 和 SomeClass 共享一些类型，以便您可以拥有指向 Dog 或 SomeClass 的引用，那么您可以创建一个共享的接口：

```
public class SomeClass implements Barkable {
    private Dog dog;

    @Override
    public void bark() {
       dog.bark();
    }
}

public class Dog implements Barkable {

    @Override
    public void bark() {
       System.out.println( "Bark! Bark!" );
    }
} 
```

使用委托/组合和接口，您不需要多重继承。应用和掌握它是一种非常简单的技术，您将构建比单独依赖继承更灵活的系统。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-05T16:58:13.020

如果您只想拥有属性，我认为您可以使用以下接口：

```
interface A{
int a = 0;
}
interface B{
int b = 1;
}
class implements A, B{
//can access A.a and B.b
} 
```

但这不是一个好方法，接口意味着合约不仅仅是包含常量（接口中的变量默认是静态的和最终的）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-05T17:00:49.927

出于充分的理由，Java 和 C# 等现代 OO 语言不支持多重继承。

大多数情况下要使用的替换是接口：

```
public Interface NameAndWorkable {
  setName(String name)
  String getName();
  boolean canWork();
  setCanWork(boolean canWork);
}

public Interface TailAnimal {
   TailtypeEnum getTailType();
   setTailType(TailtypeEnum tailtype);
}

public class Animal implements NameAndWorkable {
  private String name;
  private boolean canWork;

  public setName(String name)
  public String getName();
  public boolean canWork();
  public setCanWork(boolean canWork);
}

public class Dog implements TailAnimal {

   private TailTypeEnum tailType;

   public TailtypeEnum getTailType();
   public setTailType(TailtypeEnum tailtype);
} 
```

现在第三个对象完全填充了两个接口

```
public class WorkingNamedDog implements NameAndWorkable, TailAnimal {

  private String name;
  private boolean canWork;
  private TailTypeEnum tailType;

   // from NameAndWorkable 
   public setName(String name)
   public  String getName();
   public  boolean canWork();
   public  setCanWork(boolean canWork);

  // from TailAnimal
   public TailtypeEnum getTailType();
   public setTailType(TailtypeEnum tailtype);

} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-05T22:22:06.617

要实现多重继承，就需要使用Interfaces。您可以通过将这些类相互扩展来使用继承，例如：

```
//Your first class
public abstract class Animal{

//It is upto you to use an abstract method inside it. However it is not necessary to do so!
 //define an abstract method inside an abstract class.

}

//Your second class
public class Dog extends Animal{

}

//Your third class

 public class ThirdClass extends Dog{
 //here you can instantiate Dog
 private Dog dogObject = new Dog();

 public void anyMethod(){
      dogObject.anyMethodsThatAreDefinedInClassDogAndAnimal();
      }

 } 
```

希望这可以帮助！！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-05T16:47:08.020

`Dog`应该是 的子类`Animal`。那么你的第三类将是`Dog`. 这第三类将具有 和 的`Dog`属性`Animal`。

如果`Dog`不是的子类，`Animal`那么您将需要多重继承来实现您想要的。由于 Java 不支持多重继承，因此您必须`Dog`创建`Animal`.

* * *

或者，如果您的两个类不在同一个继承层次结构中，那么您有两个选择：-

*   要么让它们成为接口，然后你就可以实现这两个接口。
*   或者，使用*Composition*而不是*Inheritance*，在这种情况下，您需要同时引用两个类 -`Animal`和`Dog`, 作为类中的属性。

例如：-

```
public class YourClass {
    Animal animal;
    Dog dog;
} 
```

但是，拥有`Animal`和`Dog`类是没有意义的，因为它`Dog`不是`Animal`. 所以，你应该先改变它，然后你就可以使用`inheritance`.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-12-05T16:52:11.003

您可以扩展一个类并将另一个类作为组合，如下所示：

```
public class MyClass extends Dog {
    private Animal animal; // instance of Animal class
    // rest of the code to expose Animal class's attributes as per your need
} 
```

# .htaccess - 使用 mod_rewrite 带或不带斜线重定向

> ID：13728114
> 
> 赞同：1
> 
> 时间：2012-12-05T16:43:19.470
> 
> 标签：.htaccess, mod-rewrite

我使用 mod_rewrite 将请求重定向到 PHP 文件：

```
RewriteRule gallery$ mod.php?m=gallery 
```

当我以这种格式调用 url 时一切正常：`http://localhost/project/gallery`但是当我调用时，`http://localhost/project/gallery/`我得到页面没有源错误。

我应该怎么做才能解决这个问题？我应该输入重复的行`/`吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T17:07:26.520

你的规则应该是这样的：

```
RewriteRule gallery/?$ mod.php?m=gallery [L,QSA,NC] 
```

# cvs - 无法使用 CVS 下载 SourceForge 项目源代码的奇怪问题

> ID：13728115
> 
> 赞同：0
> 
> 时间：2012-12-05T16:43:19.890
> 
> 标签：cvs, sourceforge

我正在尝试从 Sourceforge.net 下载项目的源代码我已按照我的 Windows 上的说明使用 CVS，但遇到了一个奇怪的问题：

```
Documents\cpluplus> cvs -d:pserver:anonymous@gretl.cvs.sourceforge.net:/cvsroot/gretl login
Logging in to :pserver:anonymous@gretl.cvs.sourceforge.net:2401/cvsroot/gretl
CVS password: 
```

当我按照建议输入空白密码时，我得到：

```
cvs [login aborted]: reading from server: Connection reset by peer 
```

有谁知道我在这里做错了什么？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T21:36:18.543

您真的应该在 SourceForge IRC 频道（Freenode 上的#sourceforge）中提出这个问题，或者在[https://sourceforge.net/support上打开支持票](https://sourceforge.net/support)

碰巧的是，匿名 CVS 目前正在停机进行维护。今天晚上应该有时间回来。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T17:04:07.197

在 SoureForge CVS 存储库 Web 查看器中还有另一个选项。您可以下载 GNU 压缩包。

# c# - System.Windows.Size 和 System.Drawing.Size 有什么区别？

> ID：13728116
> 
> 赞同：2
> 
> 时间：2012-12-05T16:43:22.887
> 
> 标签：c#, .net, size

> **可能重复：**
> [System.Drawing.Point 和 System.Windows.Point 有什么区别？](https://stackoverflow.com/questions/2659520/what-is-the-difference-between-system-drawing-point-and-system-windows-point)

为什么会有这两种不同的 Size 结构？在什么情况下你会选择使用这些？我不清楚如何在我的代码中选择正确的。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-05T16:46:57.073

`System.Drawing.Size`是 GDI+ 的一部分。
`System.Windows.Size`是 WPF 的一部分。

最显着的区别是它的宽度和高度字段`System.Drawing.Size`使用s `int`，而`System.Windows.Size`使用`double`s.

这是因为 WPF 布局框架是基于矢量的，而不是像 GDI+ 那样基于光栅的。

您可以根据所使用的 UI 框架选择其中一种。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-05T16:47:46.573

这些是不同的数据类型，在不同的程序集中针对不同的项目目标进行引用。

`System.Windows.Size`: 你会发现`WPF`

`System.Drawing.Size`: 你会发现`Windows Forms`

# php - 邮件功能不工作

> ID：13728117
> 
> 赞同：0
> 
> 时间：2012-12-05T16:43:25.983
> 
> 标签：php, html

我试过在这里和网上寻找答案，我可能只是在这里遗漏了一些小东西。

我得到了一个网站（不是 wamp 或任何东西）。我编写了非常简单的电子邮件功能来发送附件。出于某种原因，我没有错误也没有结果。

这是PHP

```
 if(isset($_POST['Submit'])){
        $strTo = "my@mail.com";  
        $strSubject = "Purchase request from " . $_POST["formName"] . $_POST["formSurname"];  
        $strMessage = nl2br($_POST["formName"] . $_POST["formEmail"] . $_POST["formInstitute"] . $_POST["formCourse"] . $_POST["formNotes"]);  

        //*** Uniqid Session ***//  
        $strSid = md5(uniqid(time()));  

        $strHeader = "";  
        $strHeader .= "From: ".$_POST["formEmail"]."<".$_POST["formEmail"].">\nReply-To: ".$_POST["formEmail"]."";  

        $strHeader .= "MIME-Version: 1.0\n";  
        $strHeader .= "Content-Type: multipart/mixed; boundary=\"".$strSid."\"\n\n";  
        $strHeader .= "This is a multi-part message in MIME format.\n";  

        $strHeader .= "--".$strSid."\n";  
        $strHeader .= "Content-type: text/html; charset=utf-8\n";  
        $strHeader .= "Content-Transfer-Encoding: 7bit\n\n";  
        $strHeader .= $strMessage."\n\n";  

        //*** Attachment ***//  
        if($_FILES["fileAttach"]["name"] != "")  
        {  
            $strFilesName = $_FILES["fileAttach"]["name"];  
            $strContent = chunk_split(base64_encode(file_get_contents($_FILES["fileAttach"]["tmp_name"])));  
            $strHeader .= "--".$strSid."\n";  
            $strHeader .= "Content-Type: application/octet-stream; name=\"".$strFilesName."\"\n";  
            $strHeader .= "Content-Transfer-Encoding: base64\n";  
            $strHeader .= "Content-Disposition: attachment; filename=\"".$strFilesName."\"\n\n";  
            $strHeader .= $strContent."\n\n";  
        }  

        $flgSend = mail($strTo,$strSubject,$strMessage,$strHeader);  // @ = No Show Error //  

        if($flgSend)
        {  
            echo "<p>works</p>";  
        }  
        else  
        {  
            echo "<p>not working</p>";  
        }  
    }
    ?> 
```

表格在不同的页面上：

```
<form action="#!/studentform.2ndpahse" method="post" name="form1" enctype="multipart/form-data">  
            <table width="500">  
            <tr>  
                <td>שם פרטי: </td>  
                <td><input name="formName" type="text" id="name"></td>  
            </tr>  
            <tr>  
                <td>שם משפחה: </td>  
                <td><input name="formSurname" type="text" id="surname"></td>  
            </tr>  
            <tr>  
                <td>דואר אלקטרוני: </td>  
                <td><input name="formEmail" type="text"></td>  
            </tr>  
            <tr>  
                <td>מוסד אקדמי: </td>  
                <td><input name="formInstitute" type="text"></td>  
            </tr>  
                <td>מסלול: </td>  
                <td><input name="formCourse" type="text"></td>  
            </tr> 
            <tr>  
                <td>הערות</td>  
                <td><textarea name="formNotes" cols="30" rows="4" id="formNotes"></textarea></td>  
            </tr>  
            <tr>  
                <td>Attachment</td>  
                <td><input name="fileAttach" type="file"></td>  
            </tr>  
            <tr>  
                <td>&nbsp;</td>  
                <td><input type="submit" name="Submit" value="שלח"></td>  
            </tr>  
            </table>  
        </form> 
```

将给予任何帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T20:58:29.723

最终这是一个托管问题，并由他们解决。

# android - 发现用户何时关闭偏好活动

> ID：13728119
> 
> 赞同：0
> 
> 时间：2012-12-05T16:43:31.053
> 
> 标签：android

我知道这听起来可能很傻，但我真的不明白是否有一种简单而标准的方法来理解用户何时退出偏好活动。

```
case R.id.menu_settings:
        Intent i = new Intent(this, Pref.class); startActivity(i);
        Toast.makeText(this, "test", Toast.LENGTH_SHORT).show();
        updateData();
        return true; 
```

显然，这里的“测试” Toast 是异步出现的，而首选项窗口仍然打开。但是在首选项中，用户可以更改要应用的需要调用 updateData() 的重要参数：我该怎么办？我确信有一种明显的方法可以做到这一点，但我错过了......谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T16:45:51.463

您可以使用`startActivityforResult`而不是 startActivity 并在 `onActivityResult`

# visual-studio-2012 - 如何创建只读 SQLOLEDB 连接？

> ID：13728121
> 
> 赞同：1
> 
> 时间：2012-12-05T16:43:35.660
> 
> 标签：visual-studio-2012

我想创建一个从 Visual Studio 2012 应用程序到 MSSQL pre-2005 数据库的只读数据连接。连接起来很简单，但 2005 年之前的连接属性中不存在读/写选项。任何想法我如何做到这一点？也许直接编辑连接字符串？

这样做的原因是应用程序（正在开发中）将连接到业务所依赖的关键业务数据库应用程序。编辑数据库不会有风险。

# workflow-foundation-4 - WF 4.0 将 WorkflowControlEndPoint 添加到 IIS 托管的 XAMLX 服务

> ID：13728122
> 
> 赞同：2
> 
> 时间：2012-12-05T16:43:37.720
> 
> 标签：workflow-foundation-4

我正在尝试将 workflowControlEndpoint 添加到我的 IIS 托管 XAMLX 服务中。我无法从客户端引用控制端点，我不断收到以下错误

请求失败，HTTP 状态为 404：未找到。元数据包含无法解析的引用：“http://localhost/Test.xamlx/wce”。内容类型应用程序/soap+xml；服务“http://mymachine/Test.xamlx/wce”不支持 charset=utf-8。客户端和服务绑定可能不匹配。远程服务器返回错误：（415）无法处理消息，因为内容类型'application/soap+xml; charset=utf-8' 不是预期的类型 'text/xml; 字符集=utf-8'..

我有以下 web.config。有人可以指出我缺少什么吗？感谢并感谢您的帮助....

```
<system.serviceModel>
  <behaviors>
    <serviceBehaviors>
      <behavior>
         <serviceMetadata httpGetEnabled="true" />
         <serviceDebug includeExceptionDetailInFaults="true" />
      </behavior>
    </serviceBehaviors>
  </behaviors>
  <bindings>
   <basicHttpBinding>
    <binding closeTimeout="00:10:00" openTimeout="00:10:00" receiveTimeout="00:10:00" sendTimeout="00:10:00" maxReceivedMessageSize="2147483647" transferMode="StreamedResponse">
      <readerQuotas maxDepth="2147483647" maxStringContentLength="2147483647" maxArrayLength="2147483647" />
      <security mode="TransportCredentialOnly">
        <transport clientCredentialType="Windows" proxyCredentialType="Windows" />
      </security>
    </binding>
    <binding name="httpSecurityOff" closeTimeout="00:10:00" openTimeout="00:10:00" receiveTimeout="00:10:00" sendTimeout="00:10:00" maxReceivedMessageSize="2147483647"
             allowCookies="false" bypassProxyOnLocal="false" hostNameComparisonMode="StrongWildcard" maxBufferSize="2147483647" maxBufferPoolSize="2147483647"
             transferMode="Streamed" useDefaultWebProxy="true">
      <readerQuotas maxDepth="2147483647" maxStringContentLength="2147483647" maxArrayLength="2147483647" />
      <security mode="None">
        <transport clientCredentialType="None" proxyCredentialType="None" realm="" />
        <message clientCredentialType="UserName" algorithmSuite="Default"/>
      </security>
    </binding>
  </basicHttpBinding>
  <service name="Test">
    <endpoint address="" binding="basicHttpBinding" contract="IService" />
    <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange" />
    <endpoint address="wce" binding="basicHttpBinding"
              bindingConfiguration="httpSecurityOff" 
              contract="System.ServiceModel.Activities.IWorkflowInstanceMangement"
              kind="workflowControlEndpoint" />
  </service> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T17:16:14.333

我试图让 IWorkflowInstanceManagement 通过 WCF 测试客户端工作，但我永远无法让它找到元数据。所以我只是尝试通过代码与它进行通信。它对我有用。

我创建了一个新的 Workflow Service 项目，我的 web.config 如下所示：

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <system.web>
    <compilation debug="true" targetFramework="4.0" />
  </system.web>

  <connectionStrings>
    <add name="ApplicationServices" connectionString="data source=localhost\SQLEXPRESS;Initial Catalog=WFS;Integrated Security=True" providerName="System.Data.SqlClient" />
  </connectionStrings>

  <system.serviceModel>

    <behaviors>
      <serviceBehaviors>
        <behavior name="workflowBehavior">
          <serviceMetadata httpGetEnabled="True" />
          <serviceDebug includeExceptionDetailInFaults="true" />
          <sqlWorkflowInstanceStore instanceCompletionAction="DeleteAll" 
                                    instanceEncodingOption="GZip" 
                                    instanceLockedExceptionAction="BasicRetry" 
                                    connectionStringName="ApplicationServices" 
                                    hostLockRenewalPeriod="00:00:20" 
                                    runnableInstancesDetectionPeriod="00:00:05" />
          <workflowInstanceManagement authorizedWindowsGroup="AS_Administrators" />
          <workflowUnhandledException action="Terminate" />
          <workflowIdle timeToPersist="00:01:00" timeToUnload="00:01:00" />
        </behavior>

        <behavior name="wceBehavior">
          <serviceMetadata httpGetEnabled="True" />
          <serviceDebug includeExceptionDetailInFaults="true" />
        </behavior>
      </serviceBehaviors>

    </behaviors>

    <serviceHostingEnvironment multipleSiteBindingsEnabled="true" />

    <services>
      <service name="Service1" behaviorConfiguration="workflowBehavior">
        <endpoint binding="basicHttpBinding" address="" contract="IService" />
        <endpoint binding="basicHttpBinding" address="wce" kind="workflowControlEndpoint" />
      </service>
    </services>
  </system.serviceModel>
  <system.webServer>
    <modules runAllManagedModulesForAllRequests="true"/>
  </system.webServer>
</configuration> 
```

然后我使用以下代码创建了一个控制台应用程序（我知道这不是使用 ChannelFactory 的最佳方式）：

```
var binding = new BasicHttpBinding(BasicHttpSecurityMode.None);
var channelFactory = new ChannelFactory<IWorkflowInstanceManagement>(binding);
var channel = channelFactory.CreateChannel(new EndpointAddress("http://localhost/WorkflowControlTest/Service1.xamlx/wce"));
channel.Cancel(new Guid("DE212DE0-6BFF-4096-BF30-F6ACB2923B50")); 
```

我的工作流程只是在一个延迟几分钟的循环中运行。我能够通过 WCF 测试客户端启动工作流实例，然后从持久性数据库中获取工作流实例 ID，然后运行控制台应用程序以取消工作流。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-23T14:48:21.810

转到“控制面板 > 程序和功能 > 打开或关闭 Windows 功能”并检查是否检查了以下功能：

*   .NET 框架 3.5
*   .NET Framework 4.5 高级服务 > WCF 服务

# string - 如何在 ColdFusion 中输出八进制值

> ID：13728123
> 
> 赞同：3
> 
> 时间：2012-12-05T16:43:36.670
> 
> 标签：string, coldfusion, ascii, output, octal

我有一系列八进制值，我想以它们的 ASCII 字符等效项输出。CHR 看到它时似乎无法识别八进制字符。ColdFusion 有什么直接的方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-05T16:49:08.540

使用[**InputBaseN**](http://cfdocs.org/InputBaseN)将八进制转换为十进制，然后可以使用[Chr](http://cfdocs.org/Chr)输出字符。

例如：

```
Chr(InputBaseN( 101 , 8 ))    => A 
```

要返回另一种方式，您可以使用[Asc](http://cfdocs.org/Asc)和[FormatBaseN](http://cfdocs.org/FormatBaseN)反转该过程：

```
FormatBaseN( Asc('A') , 8 )   => 101 
```

# java - 在java中使用RMI实现领导者选举算法

> ID：13728124
> 
> 赞同：0
> 
> 时间：2012-12-05T16:43:44.050
> 
> 标签：java, eclipse, algorithm, rmi, distributed-system

我必须在一周内提交一个分布式系统项目.. 我应该实现下面论文中写的领导选举算法

[http://pages.cpsc.ucalgary.ca/~woelfel/paper/leaderelection/le.pdf](http://pages.cpsc.ucalgary.ca/~woelfel/paper/leaderelection/le.pdf)

我尝试了一个 RMI 教程示例，并且成功完成

但现在的问题是我如何使用 RMI 编写请求的领导者选举算法

我不想有一个困难或复杂的项目

更简单的实现就足够了

所以有人可以帮助并告诉我该怎么做吗？我需要多少台服务器或客户端来实现领导者选举的想法？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T17:59:18.400

我不会具体评论选举算法，因为这似乎是你的课程和作业的重点——我将把它留给你。

但是，我认为 RMI 不是您的最佳解决方案，因为发现阶段虽然可能，但可能比其他方法困难得多。

我建议您看一下 IP/Multicast 而不是 RMI。

例如，参见[http://web.nchu.edu.tw/~jlu/cyut/multicast.shtml](http://web.nchu.edu.tw/~jlu/cyut/multicast.shtml)

# vba - Outlook 2010 宏用于保存附件并将其 FTP 到 Web 服务器

> ID：13728125
> 
> 赞同：1
> 
> 时间：2012-12-05T16:43:51.967
> 
> 标签：vba, vb.net, outlook, ms-office, office-2010

这是我第一次尝试这样的事情并遇到一些问题。

我已经编写了下面的代码，它是 Outlook 2010 宏。它将选定的电子邮件详细信息保存在 SQL 数据库中，将任何附件保存在本地，然后尝试通过 FTP 上传它们。

看起来好像它正在尝试在命令窗口打开时上传，但随后又快速关闭，但文件尚未上传，我也没有收到任何错误信息。

任何人都可以看到我的代码有任何问题吗？

```
Sub ExportToSql()
Dim objConn As New ADODB.Connection
Dim rsMsgs As New ADODB.Recordset
Dim cmdMsgs As New ADODB.Command
Dim strDBFile As String
Dim sql As String
Set objConn = New ADODB.Connection

objConn.ConnectionString = "Provider=SQLOLEDB;data source=IP_ADDRESS;initial catalog=DB_NAME;User Id=USERNAME;Password=PASSWORD;"
objConn.Open

Set objExp = Application.ActiveExplorer
If objExp.Selection.Count > 0 Then
    If objExp.Selection(1).Class = Outlook.OlObjectClass.olMail Then
        For Each objMsg In objExp.Selection

            cmdMsgs.ActiveConnection = objConn
            cmdMsgs.CommandText = "INSERT INTO [Email] ([Date], [Subject], [From], [To], [Body]) VALUES ( ?, ?, ?, ?, ?)"
            cmdMsgs.Parameters.Append cmdMsgs.CreateParameter("param1", adDBTime, adParamInput, -1, objMsg.SentOn)
            cmdMsgs.Parameters.Append cmdMsgs.CreateParameter("param2", adLongVarChar, adParamInput, 1000, objMsg.Subject)
            cmdMsgs.Parameters.Append cmdMsgs.CreateParameter("param3", adVarChar, adParamInput, -1, objMsg.SenderEmailAddress)
            cmdMsgs.Parameters.Append cmdMsgs.CreateParameter("param4", adVarChar, adParamInput, -1, objMsg.To)
            cmdMsgs.Parameters.Append cmdMsgs.CreateParameter("param5", adLongVarChar, adParamInput, 50000, objMsg.Body)
            cmdMsgs.Execute

            For Each objAtt In objMsg.Attachments

                'save file locally
                Dim saveFolder As String
                Dim filePath As String
                saveFolder = "C:\Users\jw"
                filePath = saveFolder & "\" & objAtt
                objAtt.SaveAsFile filePath
                Set objAtt = Nothing

                'upload saved file
                Dim vPath As String
                Dim vFile As String
                Dim vFTPServ As String
                vPath = "C:\inetpub\wwwroot\WEBSITE\attachments"
                vFTPServ = "IPADDRESS"
                fNum = FreeFile()
                Open filePath For Output As #fNum
                Print #fNum, "USERNAME PASSWORD"
                Print #fNum, "bin" ' bin or ascii file type to send
                Print #fNum, "put " & filePath
                Print #fNum, "close" ' close connection
                Print #fNum, "quit" ' Quit ftp program
                Close
                Shell "ftp -n -i -g -s:" & vPath & " " & vFTPServ, vbNormalNoFocus

            Next
        Next
    End If
End If

    objConn.Close
    Set rsMsgs = Nothing
    Set objConn = Nothing

End Sub 
```

谢谢你的帮助。J。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T20:37:24.987

我认为用户名和密码应该在两个单独的行上。此外，使用“>>”而不是“>”将 FTP 命令结果输出到文本文件。

# codeigniter - sql查询转移到CodeIgniter的活动记录类

> ID：13728126
> 
> 赞同：1
> 
> 时间：2012-12-05T16:43:58.497
> 
> 标签：codeigniter, activerecord, codeigniter-2

我想知道是否可以将这个原始 SQL 更改为 CodeIgniter 的 Active Record 样式？

```
$SQL = "SELECT DISTINCT c.ID, c.Title, c.VersionInfo, GROUP_CONCAT(DISTINCT i.FullName
ORDER BY cma.Ranking SEPARATOR ', ') AS Artists
FROM carriermodifications cm INNER JOIN carriers c ON cm.CarrierID=c.ID
LEFT JOIN carriermainartists cma ON cma.CarrierID=c.ID
LEFT JOIN identities i ON cma.IdentityID=i.ID
INNER JOIN carriermainartists scma ON scma.CarrierID=c.ID
INNER JOIN identities si ON scma.IdentityID=si.ID
WHERE cm.DataSourceID IN (16, 17) AND c.Verified=1 AND c.Hidden = 0 AND ((c.Filter & 1)=1)
AND (si.Nationality=2 OR c.Concept=4)
GROUP BY c.ID ORDER BY cm.ModificationDate DESC LIMIT 27"; 
```

非常感谢提前

# sql - 在 MS SQL 中分隔一列中的多个值

> ID：13728128
> 
> 赞同：0
> 
> 时间：2012-12-05T16:44:10.400
> 
> 标签：sql, sql-server

我在应用程序中有一个字段，允许用户选择多个值。当我在数据库中查询此字段时，如果选择了多个值，则结果将显示为一个长字。多个选定值之间没有逗号或空格。有什么办法可以用逗号分隔这些值？这是我的查询：

```
SELECT      HO.Value

FROM HAssessment ha 
INNER JOIN HObservation HO       
ON HO.AssessmentiD      = ha.AssessmentID
AND HO.Patient_Oid      = 2255231
WHERE Ho.FindingAbbr = 'A_R_CardHx'

------------------------------------------------
Result:
AnginaArrhythmiaCADCChest Pain
-------------------------
I would like to see:
Angina, Arrhythmia, CADC, Chest Pain
------------------------------------------ 
```

帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T17:23:20.067

对此没有简单的解决方案。

最方便的方法是编写一个字符串拆分函数。从您的示例数据来看，这些值似乎都连接在一起而没有任何分隔符。这意味着您必须提出所有可能值的列表（希望这是来自某些症状表的查询......）并从字符串中解析出每个值。这将是复杂而痛苦的。

一种直接的方法是测试每个有效的症状值以查看它是否包含在 中`HObservation.Value`，将所有找到的值组合在一起，然后返回结果。请注意，这将执行得很差。

这是 TSQL 中的一个示例。不过，在应用程序层执行此操作会更好，或者更好的是，规范化您的数据库（有关更多信息，请参见下文）。

```
declare @symptoms table (symptom varchar(100))
insert into @symptoms (symptom)
values ('Angina'),('Arrhythmia'),('CADC'),('Chest Pain')

declare @value varchar(100)
set @value = 'AnginaArrhythmiaCADCChest Pain'

declare @result varchar(100)
select @result = stuff((
SELECT ', ' + s.symptom
FROM @symptoms s
WHERE patindex('%' + s.symptom + '%',@value) > 0
FOR XML PATH('')),1,1,'')

select @result 
```

真正的答案是重组你的数据库。`HObservation.Value`如果这样的表不存在，则将在其中找到的每个不同项目（这意味着心绞痛、心律失常等作为单独的行）放入其他表中。我将此表称为症状。然后创建一个查找表以链接`HObservation`到`Symptom`. 然后完全删除该`HObservation.Value`列。在应用程序级别进行拆分工作，并在查找表中进行多次插入。

示例，基于您问题的示例数据：

```
HObservation
------------
ID Value
1  AnginaArrhythmiaCADC 
```

变成：

```
HObservation
------------
ID 
1  

Symptom
-------
ID Value
1  Angina
2  Arrhythmia
3  CADC

HObservationSymptom
-------------------
ID HObservationID SymptomID
1  1              1
1  1              2
1  1              3 
```

请注意，如果这是一个生产系统（或者您出于其他原因想要保留现有数据），您仍然需要编写代码来进行字符串拆分。

# inno-setup - 三个用户定义位置的三个组件

> ID：13728134
> 
> 赞同：1
> 
> 时间：2012-12-05T16:44:33.897
> 
> 标签：inno-setup

我看到了这篇优秀的文章：[Inno Setup - Correct use of [Types], [Components] and [Tasks]](https://stackoverflow.com/questions/8890828/inno-setup-correct-use-of-types-components-and-tasks) on components and types。

我目前要安装三个单独的 setup.exe 项目 (iss)：

1.  程序可执行文件（默认为： C:\ProgramFiles/ ）即 {pf}
2.  js/css/html 的设置（默认为：c:\wwwroot\sherlock
3.  安装图像文件 (jpg/png) 文件的设置（默认为：c:\wwwroot\toby

我希望用户能够重定向这三个“组件”中每一个的默认位置（即，他的 /wwwroot 可能在 G 驱动器上，或类似的东西。我在 Source: 中看不到任何其他命令将此发送给 {app}

```
Source: "Z:\EGPL Librarian Releases\Sample Installation\wwwroot\Sherlock\*"; DestDir: "{app}"; Flags: ignoreversion recursesubdirs createallsubdirs 
```

问题：这可以用上面文章中的组件和类型来完成吗？我是否应该创建安装程序的安装程序并保留三个单独的设置？（你能给我看一个安装程序安装程序的例子吗？）

我正在寻找一个简单的解决方案，因为我还有其他工作要做。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-06T09:13:23.457

请参阅[此页面](http://www.vincenzo.net/isxkb/index.php?title=Prompt_for_an_additional_folder_for_data)。请注意，它是为旧版本的 Inno 编写的，但它应该很容易适应。

组件/任务是可选的。如果您的项目不是可选的，那么使用它们就没有多大意义。

至于是否制作单个安装程序或安装程序的安装程序 - 主要问题是您希望在卸载时发生什么。如果您希望用户能够单独卸载每个部分，那么您必须使用唯一`AppId`的 s 创建单独的安装脚本（然后可以选择为它们制作安装程序的安装程序）。如果您希望它们始终一起卸载，那么您可以制作一个脚本。

# ruby-on-rails - 如何使用 Ruby on Rails 2.3 在 Canvas LMS 中更新外发邮件地址

> ID：13728138
> 
> 赞同：3
> 
> 时间：2012-12-05T16:44:44.657
> 
> 标签：ruby-on-rails

我使用 Ruby on Rails 2.3.14 在开发和登台环境中开发 Canvas LMS，然后使用 Capistrano 从 Git 存储库部署更新到登台，并确认所有更新的代码部署成功。

在开发的初始设置过程中，我将**外出邮件.yml 配置为临时使用“<strong>donotreply@mysite.com”，直到根据生产安装指南**[https://github.com](https://github.com/instructure/canvas-lms/wiki/Production-Start)创建了我计划用于生产的电子邮件地址[/instructure/canvas-lms/wiki/Production-Start](https://github.com/instructure/canvas-lms/wiki/Production-Start)

**原始设置：**

```
development:
  address: "smtp.mysite.com"
  port: "25"
  domain: "mysite.com"
  outgoing_address: "donotreply@mysite.com"
  default_name: "My Canvas Site" 
```

我已经更新了外出邮件.yml 中的外出地址以使用不同的电子邮件 (support@mysite.com)，但原始地址仍出现在电子邮件 (donotreply@mysite.com) 的“发件人”字段中

**更新设置：**

```
development:
  address: "smtp.mysite.com"
  port: "25"
  domain: "mysite.com"
  outgoing_address: "support@mysite.com"
  default_name: "My Canvas Site"

staging:
  address: "smtp.mysite.com"
  port: "25"
  domain: "mysite.com"
  outgoing_address: "support@mysite.com"
  default_name: "My Canvas Site" 
```

此外，Canvas 在暂存环境中发送的电子邮件默认为以下内容：

```
Instructure Canvas notifications@unknowndomain.example.com 
```

我已经确认两个环境都具有相同的输出邮件.yml 设置，甚至使用 irb 控制台检查了 ActionMailer::Base.settings。

我在数据库中搜索了任何可能存储 Canvas 应用程序配置设置的表，但没有找到。

初始配置设置是否存储在 Canvas LMS 可以引用的数据库或应用程序代码之外的某个位置？

更新 Rails 应用程序的配置文件后，是否需要运行其他 rake 任务？

在 outging_mail.yml 更新后，Canvas 如何使用旧的配置设置发送电子邮件？

# php - 需要复选框html表单的php代码

> ID：13728142
> 
> 赞同：1
> 
> 时间：2012-12-05T16:45:10.140
> 
> 标签：php, html, forms

***********编辑******* *** **********

 *****我已经成功了。现在我只帮助一件简单的小事：如何让电子邮件用逗号分隔每个复选框选择？

所以代替：

感兴趣：每小时销售线索生成 B2B 销售

它应该是：

感兴趣：每小时销售线索生成，B2B 销售

谢谢，内森

* * *

我刚刚在这个网站上注册，希望能得到一些帮助，让我的表格可以通过电子邮件发送复选框选择。

我几乎是一个 php 的菜鸟，但使用 lynda.com 我的联系表格至少可以工作 - 现在我只需要选择复选框来发送电子邮件。

这是我的表格：

```
<form id="mainForm" method="post" name="contact" action="http://www.digicrest.com/sales/contactFormProcess.php">
                        <ul>
                            <li>Name<span>*</span> <br/>
                                <input class="form2" name="name" type="text" />
                            </li>
                            <li>Email Address<span>*</span> <br/>
                                <input class="form2" name="email" type="text" />
                            </li>
                            <li>Subject<span>*</span> <br/>
                                <input class="form2" name="subject" type="text" />
                            </li>                            
                            <li>Company<span>*</span> <br/>
                                <input class="form2" name="company" type="text" />
                            </li>
                            <li>Phone Number <br/>
                                <input class="form2" name="phone" type="text" />
                            </li>                            
                            <li id="checkboxes">
                                I'm Interested In:
                                <br />
                                <div><input type="checkbox" name="interested[]" value="Pay For Performance Appointment Setting" class="checkbox" id="option1" /> Pay For Performance Appointment Setting
                                    <br />
                                    <input type="checkbox" name="interested[]" value="Hourly Sales Lead Generation" class="checkbox" id="option2" /> Hourly Sales Lead Generation
                                    <br />
                                    <input type="checkbox" name="interested[]" value="B2B Sales" class="checkbox" id="option3" /> B2B Sales
                                    <br />
                                    <input type="checkbox" name="interested[]" value="Inbound Lead Generation" class="checkbox" id="option4" /> Inbound Lead Generation
                                </div>
                            </li>
                            <li><span class="clearLeft"></span></li>
                            <div class="clearLeft"></div>

                            <li>Comments / Details<span>*</span> <br/>
                                <textarea class="form2B" cols="20" rows="6" name="message"></textarea>
                            </li>                            
                        </ul>

                        <div id="formButtons2">
                            <input class="clear2" type="reset" value=""/> 
                            <input class="submit" type="image" name="submit" src="images/send-big.jpg" alt="" />
                        </div>
                    </form> 
```

- 这是我的 php-

```
<?php

/* Subject and Email Variables */

$emailSubject = $_POST['subject'];
$webMaster = 'info@digicrest.com';
$email = $_POST['email'];

/* Gathering Data Variables */
$nameField = $_POST['name'];
$emailField = $_POST['email'];
$subjectField = $_POST['subject'];
$companyField = $_POST['company'];
$phone = $_POST['phone'];
$messageField = $_POST['message'];
$interestedField = implode(' ', $_POST['interested']);

$body = <<<EOD
<br><hr><br>
Name: $nameField <br>
Email: $emailField <br>
Subject: $subjectField <br>
Company: $companyField <br>
Phone: $phone <br>
Interested In: $interestedField <br>
Message: $messageField <br>
EOD;

$headers = "From: $email\r\n";
$headers .= "Content-type: text/html\r\n";
$success = mail($webMaster, $emailSubject, $body, $headers);

/* Results Rendered as HTML */

$theResults = <<<EOD
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">

    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Welcome To Sales Source Lead Generation - B2B Solutions</title>
        <link href="css/main.css" rel="stylesheet" type="text/css" />
        <link href='http://fonts.googleapis.com/css?family=Oswald:400,700' rel='stylesheet' type='text/css' />
        <link rel="stylesheet" href="css/basic-jquery-slider.css" />
    </head>

    <body>
        <!-- header -->
        <div id="pageArea">
            <div id="headerArea">
                <div id="header">
                    <div class="content">
                        <a id="logo" href="index.html" title="Home"><img src="images/logo.jpg" width="198" height="102" alt=""/></a> 

                        <div id="phone">
                            Call us Toll Free: <span>1-888-557-4223</span>  Ext 2
                        </div> 

                        <div id="navbar">
                            <div id="home"><a href="index.html" title="Home"></a></div>
                            <div> | </div>
                            <div id="about"><a href="about.html" title="About Us"></a></div>
                            <div> | </div>
                            <div id="services"><a href="services.html" title="Services"></a></div>
                            <div> | </div>
                            <div id="faq"><a href="faq.html" title="FAQ"></a></div>
                            <div> | </div>
                            <div id="rep"><a href="rep.html" title="Become a Rep"></a></div>
                            <div> | </div>
                            <div id="contact"><a href="contact.html" title="Contact Us"><img src="images/contact-current.jpg" width="87" height="16" alt="" /></a></div>
                        </div>

                        <div class="clearer"></div>
                    </div>
                </div>
            </div>
            <div id="barArea2">
                <div class="content">
                    <div id="light"><img src="images/light.png" width="787" height="493" alt="" /></div>
                    <h1 class="pageTitle">Message Sent!</h1>
                </div>                
            </div>

            <div id="hr"></div>

            <div class="contentArea">                
                <div class="content">
                    <div align="center">Thank you for your message! Your email will be answered as soon as possible!
                        <br />
                        <br />
                        <a href="index.html" title="Home">Click To Go Back!</a>
                    </div>
                </div>
            </div>
            <div class="clearer"></div>           

        </div>

    </body>
</html>

EOD;
echo "$theResults";
?> 
```

我很感激任何帮助:)

谢谢阅读。

-内森

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T17:13:55.480

在您的情况下，您的复选框存储在`$_POST['interested']`数组中。因此，您需要包括它们的内爆形式 ( `$interestedField`)。

如果你想要逗号，只需用 implode`", "`代替`" "`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T17:14:55.237

假设一切正常：

```
/* Gathering Data Variables */
$nameField = $_POST['name'];
$emailField = $_POST['email'];
$subjectField = $_POST['subject'];
$messageField = $_POST['message'];
$choices = implode(", ", $_POST['interested']);

$body = <<<EOD
<br><hr><br>
Name: $nameField <br>
Subject: $subjectField <br>
Email: $emailField <br>
Message: $messageField <br>
Choices: $choices
EOD; 
```

请注意，这只会为您提供复选框的值（例如：1、2、3、4）而不是文本（例如：“支付绩效预约设置”）。为了得到这个，你需要在你的 PHP 中的某个地方有这些文本：

```
$labels = array("1"=>"Pay For Performance Appointment Setting",
          "2"=>"Hourly Sales Lead Generation",
          "3"=>"B2B Sales",
          "4"=>"Inbound Lead Generation");

/* Gathering Data Variables */
$nameField = $_POST['name'];
$emailField = $_POST['email'];
$subjectField = $_POST['subject'];
$messageField = $_POST['message'];
$choices = array();
foreach($_POST['interested'] as $choice) {
    $choices[] = $labels[$choice];
}
$choices = implode(", ", $choices);

$body = <<<EOD
<br><hr><br>
Name: $nameField <br>
Subject: $subjectField <br>
Email: $emailField <br>
Message: $messageField <br>
Choices: $choices
EOD; 
```

希望这可以帮助。

编辑：好的，您在我回答时更改了您的帖子，以便复选框的值包含使我回答的第二部分多余的文本。如果您想将数据保存到数据库中，最好的方法是使用数值，并将描述存储在其他地方。*****

# iphone - 整个应用程序中 NSCache 的最佳使用

> ID：13728146
> 
> 赞同：6
> 
> 时间：2012-12-05T16:45:17.907
> 
> 标签：iphone, objective-c, ios, nscache

我想知道是否最好使用一个全局 NSCache 实例，或者为每个需要它的组件使用多个实例。

例如，我有几个视图子类，它们将内容绘制到图像中并缓存它们以避免一直重新生成它们。每个类有一个 NSCache 实例，还是整个应用程序只有 1 个集中式 NSCache 更好？

请注意，我并不是说每个对象实例一个缓存，这样做是迟缓的。我说的是每个类的一个 NSCache 实例。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T09:32:03.080

这显然取决于，但我通常会为每种类型的缓存对象投票支持一个缓存。这样，您可以`countLimit`为每个设置不同的值，例如指定“保留 50 个最近渲染的缩略图”、“保留 5 个最近下载的大图像”、“保留 10 个最近下载的 PDF”等内容。

对于计算量非常大的任务，我还使用了两层缓存，`NSCache`以获得最佳性能，并保存到本地文件系统中的临时/缓存目录，以避免昂贵的下载周期，同时不消耗 RAM。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-05T17:44:38.707

如果缓存的项目可以跨组件共享，那么您不妨拥有一个统一的缓存 - 查找成本不会显着增加，并且您至少有机会减少缓存对象的冗余副本。

但是，如果每个组件的缓存项都是唯一的，那么将它们混合在缓存中是没有意义的，并且从代码可读性的角度来看可能会令人困惑。在这种情况下，将缓存分开。这也让您可以更精确地控制它们——例如，您可以更积极地从未立即使用的组件中驱逐缓存。

# asp.net-mvc - 如何从 Json 字符串中提取值

> ID：13728147
> 
> 赞同：0
> 
> 时间：2012-12-05T16:45:17.583
> 
> 标签：asp.net-mvc, json

我正在使用 ASP.NET MVC 4 开发一个应用程序，它涉及 Web API 调用，其中我为特定记录获得的结果是一个 Json 字符串。我在控制器的操作方法中执行此 Web API 调用，我得到的此类调用的结果如下所示：

```
result = "{\"fname\":\"John\",\"lname\":\"Doe\",\"empno\":123456,\"dept\":\"IT\"}" 
```

我是 MVC 和 Json 的新手，非常感谢有关如何从这个 Json 字符串中提取特定值的任何帮助，例如 dept 的值？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T16:53:15.857

为了在项目中将其用作实际对象，您需要反序列化此字符串。.NET 有它自己的反序列化，或者您可以查看 Json.Net，这很容易弄清楚。查看有关 JsonConvert.DeserializeObject<> 的文档...

IE...

```
Instructor desInst = new Instructor();
responseContent = rsp.Content.ReadAsStringAsync().Result;
desInst = JsonConvert.DeserializeObject<Instructor>(responseContent); 
```

# java - Creating Object[][] Types On The Fly

> ID：13728149
> 
> 赞同：4
> 
> 时间：2012-12-05T16:45:20.877
> 
> 标签：java, list, object

Here is my define class, I haven't included the getting code to keep it [short and sweet](http://sscce.org).

```
public class Details() {
  String name;
  double price;
  int quan;
  double totalValue;

  public String getName();
  public double getPrice();
  public int quan();
  public double totalValue();
} 
```

This is how I hold my list of details

```
ArrayList<Details> myDetails = new ArrayList<Details>(); 
```

This is the function I would like to use to make my table rows/columns Here I would like to be able to iterate though my details table to produce something similar to below.

```
public Object[][] getStockTable() {
  Object[][] dynamicObject = new Object[][] {
      { "Name1", "Price1", "Quan1", "TV1"  },
      { "Name2", "Price2", "Quan2", "TV2"  },
      { "Name3", "Price3", "Quan3", "TV3"  } };

  //But how do this by iterating through rather than manually like above^
  return dynamicObject;

} 
```

This is how I'm setting the row/columns for the table

```
dm.setDataVector(getStockTable(), new Object[] { "Name","Price", "Quan", "Total Value" }); 
```

After some messing around I've not managed to come up with a way of doing this. Please don't just spoon feed me an answer, I would like to be able to understand how to do it rather than having it done for me.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-05T16:54:24.923

An `Object[][]` is simply an array of `Object[]`, so the OO way to do it would be to add a method to `Detail` that creates a single "row" `Object[]`

```
public Object[] toRow() {
  return new Object[] { getName(), String.valueOf(getPrice()) /* etc. */ };
} 
```

then collect those up in `getStockTable`

```
Object[][] tbl = new Object[myDetails.size()][];
int row = 0;
for(Detail d : myDetails) {
  tbl[row++] = d.toRow();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-05T16:54:46.257

something like this?

```
public Object[][] getStockTable() {
    ArrayList<Details> details = getDatailsList();
    Object[][] result = new Object[details.size()][];
    for (int i = 0; i < details.size(); i++) {
        Details detail = details.get(i);
        Object[] det = new Object[4];
        det[0] = detail.getName();
        det[1] = detail.getPrice();
        det[2] = detail.quan();
        det[3] = detail.totalValue();
        result[i] = det;
    }
    return result;
} 
```

# android - Android：在基于 listView 的应用程序中处理 onItemClick()

> ID：13728154
> 
> 赞同：2
> 
> 时间：2012-12-05T16:45:27.783
> 
> 标签：android

我是安卓新手。我正在开发一个基于 listView 的应用程序：您有一个主菜单，当您单击一个项目时，一个新的活动会从另一个菜单开始；当您再次单击时，一个新的活动将从您选择的内容开始。由于我有很多菜单项，我必须创建一个处理所有可能情况的侦听器，所以我有类似的东西：

```
 @Override public void onItemClick(AdapterView<?> listAdapter, View v, int position, long id) {              
       String text = ((TextView)v).getText().toString();
       //main menu
       if (text.equals(K.getStringById(K.ID_MAIN_THEORY))) {
          ...
       } else if (text.equals(K.getStringById(K.ID_MAIN_EXERCISE))) {
          ...
       }
       else if (text.equals(K.getStringById(K.ID_MAIN_TABLES))) {
          ...
       }
       //here other menus' items: lots of items
       ...
       //back item
       else if (text.equals(K.getStringById(K.ID_BACK))) {
          activity.finish();
       }

       Intent i = new Intent(...);
       startActivity(i);
    }
* K is a class that holds ids' references 
```

有一种方法可以避免硬编码侦听器行为吗？

** PS：列表的 TextView 无法正确呈现：文本显示为浅灰色，而不是黑色！哦

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T17:24:52.033

如果您想单击项目并导致它转到另一个活动，例如，如果您有三个项目并且当您单击项目 A 时，它会将您重定向到活动 A，如果 B 然后转到 B 等等，

```
 lstview.setOnItemClickListener(new OnItemClickListener()  
     {
       private String input;
   public void onItemClick(AdapterView<?> v, View arg1, int index,long arg3)
          {
            if(index==1)
               {
                 Intent intnt=new Intent(v.getContext(),A.class);     
                 startActivity(intnt);
                }       
            else if (index==2)
           {
              Intent intnt=new Intent(v.getContext(),B.class);     
                 startActivity(intnt);
                }       
              else
                 {
                   Intent intnt=new Intent(v.getContext(),C.class);     
                 startActivity(intnt);
                }       
           }
     } 
```

在这种情况下，您将在列表视图中选择不同的活动，输入您的评论以供进一步查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T09:30:18.873

我是这样解决的：我觉得还不错。

```
//This in K class, where MAPPED_HIERARCHY is a static field
static void activity(android.app.Activity a) {
    MAPPED_HIERARCHY = new HashMap<String, ArrayList<String>>();
    MAPPED_HIERARCHY.put(a.getResources().getString(R.string.app_name), K.array2list(a.getResources().getStringArray(R.array.menu_main)));
    MAPPED_HIERARCHY.put(a.getResources().getString(R.string.main_theory), K.array2list(a.getResources().getStringArray(R.array.menu_theory)));
    MAPPED_HIERARCHY.put(a.getResources().getString(R.string.main_exercise), K.array2list(a.getResources().getStringArray(R.array.menu_exercise)));
    ....
}
static ArrayList<String> getArrayListByString(String string) {
    ArrayList<String> copy = new ArrayList<String>(MAPPED_HIERARCHY.get(string).size());
    for (String s : MAPPED_HIERARCHY.get(string))
        copy.add(s);
    return copy; //defensive copy
}
//This in my listener class
@Override public void onItemClick(AdapterView<?> listAdapter, View v, int position, long id) {          
        String text = ((TextView)v).getText().toString();
        ArrayList<String> params = K.getArrayListByString(text);
        Intent i = new Intent(...);
        i.putExtra("params", params);
        activity.startActivity(i);
    } 
```

我有一个映射，它将包含菜单项的数组列表与字符串链接起来，从而导致菜单显示；在单击事件上，我只是根据所选项目的文本检索数组列表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-05T17:02:55.100

使用位置而不是视图来切换点击事件的动作更有用。您的 ListView 应该从某种列表中填充，因此当 onClick 触发时，为您提供位置，您可以在列表中引用该位置以了解单击的内容。

# visual-studio-2012 - EntityFramework NuGet 包不会安装

> ID：13728161
> 
> 赞同：0
> 
> 时间：2012-12-05T16:45:48.423
> 
> 标签：visual-studio-2012, nuget, entity-framework-5, failed-installation

当我尝试通过 NuGet 安装 EntityFramework 时，我得到以下信息：

PM> Install-Package EntityFramework 您正在从 Microsoft 下载 EntityFramework，其许可协议位于[http://go.microsoft.com/fwlink/?LinkId=253898&clcid=0x409](http://go.microsoft.com/fwlink/?LinkId=253898&clcid=0x409). 检查软件包是否有其他依赖项，这些依赖项可能附带他们自己的许可协议。您对包和依赖项的使用构成您接受他们的许可协议。如果您不接受许可协议，请从您的设备中删除相关组件。成功安装“EntityFramework 5.0.0”。意外的结束标记。第 46 行，位置 3。成功卸载“EntityFramework 5.0.0”。安装失败。回滚...安装包：意外的结束标记。第 46 行，位置 3。在第 1 行 char:16 + Install-Package <<<< EntityFramework + CategoryInfo : NotSpecified: (:) [Install-Package], XmlException + FullyQualifiedErrorId : NuGetCmdletUnhandledException,NuGet.PowerShell.Commands.InstallPackageCommand

旧版本的 EntityFramework 也会发生这种情况。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T18:45:57.407

您是否能够在安装实体框架之前构建和执行您的应用程序。我猜是 web.config 或其他具有意外结束标记的文件中可能存在错误。另一件事是尝试将其安装在不同的项目上，如果您仍然看到问题？例如，当我尝试将它安装到带有格式错误的 web.config 的项目上时，我收到以下错误： install-package entityframework 您正在从 Microsoft 下载 EntityFramework，其许可协议可在[http://go.microsoft 获得。 com/fwlink/?LinkId=253898&clcid=0x409](http://go.microsoft.com/fwlink/?LinkId=253898&clcid=0x409). 检查软件包是否有其他依赖项，这些依赖项可能附带他们自己的许可协议。您对包和依赖项的使用构成您接受他们的许可协议。如果您不接受许可协议，请从您的设备中删除相关组件。成功安装“EntityFramework 5.0.0”。名称不能以“<”字符开头，十六进制值 0x3C。第 12 行，位置 5。成功卸载“EntityFramework 5.0.0”。安装失败。回滚... install-package：名称不能以“<”字符开头，十六进制值 0x3C。第 12 行，位置 5。在 line:1 char:1 + install-package entityframework + ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ + CategoryInfo : NotSpecified: (:) [Install-Package], XmlException + FullyQualifiedErrorId :

# sql - 查找许多服务器上的表之间的差异

> ID：13728162
> 
> 赞同：0
> 
> 时间：2012-12-05T16:45:50.173
> 
> 标签：sql, sql-server-2008

在我的工作中，我们的服务器上有一个数据库。但是对于某些客户端，我们在服务器上实现数据库。当我们更改服务器上的表格设计时，问题就来了。我们需要在每个客户端服务器上手动复制该更改。有没有办法查看一个表或所有表的差异，以了解哪些表或存储过程需要更新。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T17:30:08.067

这是关于 stackoverflow 的帖子，其中列出了进行架构比较的工具：[什么是比较两个 SQL Server 数据库的免费工具？](https://stackoverflow.com/questions/193438/free-tool-to-compare-sql-server-tables)

此外，如果您有 VS 2010 Premium 或 Ultimate，您可以进行架构比较：http: [//msdn.microsoft.com/en-us/library/dd193250%28v=vs.100%29.aspx](http://msdn.microsoft.com/en-us/library/dd193250%28v=vs.100%29.aspx)

# entity-framework-5 - 在实体框架中更改关系的状态

> ID：13728167
> 
> 赞同：1
> 
> 时间：2012-12-05T16:45:58.080
> 
> 标签：entity-framework-5, ef-model-first

我的问题与[这个](https://stackoverflow.com/q/4365552/607162)直接相关。

接受的[答案](https://stackoverflow.com/a/4367057/607162)是“您还必须更改关系的状态”。

我使用模型优先方法，并且我的实体中没有外键。我只有导航属性。

我可以通过 更改实体的状态`DbEntityEntry`，但我不知道如何更改*关系*本身的状态。我怎样才能访问它？

我的代码示例：

```
Building building = new Building() { Id = 1, Name = "modified" }; //Buiding 1 exists in DB
building.Adress = new Adress() { Id = 1, Road = "Sesame street" }; //Address 1 exists in DB
building.Adress.State = new State() { Id = 1 }; //State with Id 1 exists in DB

dbContext.Entry<Building>(building).State = EntityState.Modified;
dbContext.Entry<Adress>(building.Adress).State = EntityState.Modified;
//The state itself is not modified, but the relation between adress and state may do.
dbContext.Entry<State>(building.Adress.State).State = EntityState.Unchanged;

dbContext.SaveChanges(); 
```

`Adress`这段代码没有错误地通过，但是和之间的关系`State`永远不会更新。`Name`建筑物和`Street`物业的情况确实如此。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-18T02:30:13.387

查看 ObjectStatementManager（并使用 ctrl + . 获取 IObjectContextAdapter 的引用）。

```
var unchangedItems = ((IObjectContextAdapter)dbContext).ObjectContext.ObjectStateManager.GetObjectStateEntries(EntityState.Unchanged);
var addedItems = ((IObjectContextAdapter)dbContext).ObjectContext.ObjectStateManager.GetObjectStateEntries(EntityState.Added); 
```

它还特别具有`ChangeRelationshipState`适合您场景的声音。

# c - 以任意顺序在结构内使用结构 (C)

> ID：13728168
> 
> 赞同：0
> 
> 时间：2012-12-05T16:45:59.940
> 
> 标签：c, struct, definition

我有一个非常简单的问题：我想在另一个结构中使用结构，但我希望能够以我想要的任何顺序定义它们。像这样的东西：

```
// User type definition
typedef struct type1{
    int i;
    type2 t;
};
// User type definition
typedef struct type2{
    int i;
    type3 t;
};
// User type definition
typedef struct type3{
    int i;
}; 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T16:51:32.450

实现这一点的唯一方法是使用指向结构的指针而不是静态成员：

```
typedef struct type1 {
    int i;
    struct type2 *t;
} type1;
// User type definition
typedef struct type2 {
    int i;
    struct type3 *t;
} type2;
// User type definition
typedef struct type3 {
    int i;
} type3; 
```

这样做的原因是编译器必须知道结构体的大小。如果您使用指针，编译器只需要知道该结构类型只是*存在*，因为给定架构上的指针类型在编译时是已知大小

# objective-c - 将原子属性保存在钥匙串/用户默认值中是否有任何优势？

> ID：13728171
> 
> 赞同：0
> 
> 时间：2012-12-05T16:46:11.357
> 
> 标签：objective-c, ios, cocoa, nsuserdefaults, keychain

对于在 NSUserDefaults / keychains 中存储一些值，具有原子或非原子属性有什么好处吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T16:51:27.453

[“原子”和“非原子”之间的区别在于](https://stackoverflow.com/questions/588866/atomic-vs-nonatomic-properties)，原子要求必须成功写入所有数据，而“非原子”意味着“尽可能多地写入”（即不一定是全部）。

因此，对于许多事情（例如少量数据），非原子或原子之间没有太大的实际区别。

但是对于更大的数据块，非原子与原子实际上会有所不同。您是否需要让写入的数据 100% 完美和完整，或者您的应用程序可以处理一些已写入默认值或钥匙串的内容？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-06-06T10:12:28.103

是的，

如果您使用的是 Atomic，它是线程安全的。

# java - java中的无限while循环，而不是在哨兵中读取

> ID：13728172
> 
> 赞同：0
> 
> 时间：2012-12-05T16:46:13.183
> 
> 标签：java, while-loop, infinite-loop

我在多个程序中都遇到过这个问题，但我不记得上次我是如何解决的。在我体内的第二个 while 循环中，由于某种原因，第二个标记值从未被读入。我一直在尝试修复它一段时间，想我可能会看看是否有人有任何线索。

```
 import java.text.DecimalFormat; // imports the decimal format
    public class Car {

    // Makes three instance variables.
    private String make;
    private int year;
    private double price;
    // Makes the an object that formats doubles.
    public static DecimalFormat twoDecPl = new DecimalFormat("$0.00");

    // Constructor that assigns the instance variables
    // to the values that the user made.
    public Car(String carMake,int carYear, double carPrice)
    {
        make = carMake;
        year = carYear;
        price = carPrice;
    }
    // Retrieves variable make.
    public String getMake()
    {
        return make;
    }
    // Retrieves variable year.
    public int getYear()
    {
        return year;
    }
    // Retrieves variable price.
    public double getPrice()
    {
        return price;
    }
    // Checks if two objects are equal.
    public boolean equals(Car c1, Car c2)
    {
        boolean b = false;
        if(c1.getMake().equals(c2.getMake()) && c1.getPrice() == c2.getPrice() &&
        c1.getYear() == c2.getYear())
        {
            b = true;
            return b;
        }
        else
        {
            return b;
        }
    }
    // Turns the object into a readable string.
    public String toString()
    {
        return "Description of car:" +      
        "\n    Make : " + make +
        "\n    Year : " + year +
        "\n    Price: " + twoDecPl.format(price);
    }
}

    import java.util.Scanner; // imports a scanner
public class CarSearch {

    public static void main(String[] args)
    {
        // initializes all variables
        Scanner scan = new Scanner(System.in);
        final int SIZE_ARR = 30;
        Car[] carArr = new Car[SIZE_ARR];
        final String SENT = "EndDatabase";
        String carMake = "";
        int carYear = 0;
        double carPrice = 0;
        int count = 0;
        int pos = 0;
        final String SECSENT = "EndSearchKeys";
        final boolean DEBUG_SW = true;

        // Loop that goes through the first list of values.
        // It then stores the values in an array, then uses the
        // values to make an object.
        while(scan.hasNext())
        {

            if(scan.hasNext())
            {
                 carMake = scan.next();
            }
            else
            {
                System.out.println("ERROR - not a String");
                System.exit(0);
            }
            if(carMake.equals(SENT))
            {
                break;
            }
            if(scan.hasNextInt())
            {
                carYear = scan.nextInt();
            }
            else
            {
                System.out.println("ERROR - not an int" + count);
                System.exit(0);
            }
            if(scan.hasNextDouble())
            {
                carPrice = scan.nextDouble();
            }
            else
            {
                System.out.println("ERROR - not a double");
                System.exit(0);
            }
            Car car1 = new Car(carMake, carYear, carPrice);
            carArr[count] = car1;
            count++;
        }
        // Calls the method debugSwitch to show the debug information.
        debugSwitch(carArr, DEBUG_SW, count);
        // Calls the method printData to print the database.
        printData(carArr, count);
        // Loops through the second group of values and stores them in key.
        // Then, it searches for a match in the database.
        **while(scan.hasNext())**
        {
            if(scan.hasNext())
            {
                 carMake = scan.next();
            }
            else
            {
                System.out.println("ERROR - not a String");
                System.exit(0);
            }
            if(carMake.equals(SECSENT))
            {
                break;
            }
            if(scan.hasNextInt())
            {
                carYear = scan.nextInt();
            }
            else
            {
                System.out.println("ERROR - not an int" + count);
                System.exit(0);
            }
            if(scan.hasNextDouble())
            {
                carPrice = scan.nextDouble();
            }
            else
            {
                System.out.println("ERROR - not a double");
                System.exit(0);
            }
            Car key = new Car(carMake, carYear, carPrice);
            // Stores the output of seqSearch in pos.

            // If the debug switch is on, then it prints these statements.
            if(DEBUG_SW == true)
            {   
                System.out.println("Search, make = " + key.getMake());
                System.out.println("Search, year = " + key.getYear());
                System.out.println("Search, price = " + key.getPrice());
            }   
            System.out.println("key =");
            System.out.println(key);
            pos = seqSearch(carArr, count, key);
            if(pos != -1)
            {
                System.out.println("This vehicle was found at index = " + pos);
            }
            else
            {
                System.out.println("This vehicle was not found in the database.");
            }

        }

    }
    // This method prints the database of cars.
    private static void printData(Car[] carArr, int count)
    {
        for(int i = 0; i < count; i++)
        {
            System.out.println("Description of car:");
            System.out.println(carArr[i]);

        }
    }
    // Searches for a match in the database.
    private static int seqSearch(Car[] carArr, int count, Car key)
    {
        for(int i = 0; i < count; i++)
        {
            boolean b = key.equals(key, carArr[i]);
            if(b == true)
            {
                return i;
            }   

        }
        return -1;
    }
    // Prints debug statements if DEBUG_SW is set to true.
    public static void debugSwitch(Car[] carArr, boolean DEBUG_SW, int count)
    {
        if(DEBUG_SW == true)
        {
            for(int i = 0; i < count; i++)
            {
                System.out.println("DB make = " + carArr[i].getMake());
                System.out.println("DB year = " + carArr[i].getYear());
                System.out.println("DB price = " + carArr[i].getPrice());
            }   
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T16:55:05.873

我认为这是你的问题，但我可能错了：

在您的 while 循环中，您有以下调用：

*   `next()`
*   `nextInt()`
*   `nextDouble()`

问题是最后一次调用 ( `nextDouble`) 不会吃掉换行符。`nextLine()`所以要解决这个问题，你应该在两个循环的末尾添加一个额外的调用。

发生的情况是，下次您调用 next() 时，它将返回换行符，而不是 CarMake-thing。

# php - 远程发布表单并将数据从会话保存到数据库

> ID：13728174
> 
> 赞同：0
> 
> 时间：2012-12-05T16:46:17.267
> 
> 标签：php, cakephp

### 问题

我正在成功发布到远程支付网站，但同时我需要将订单的详细信息保存到数据库中

### 形式

这是提交数据的表单，其中大部分存储在配置中。

```
echo $this->Form->create(null, array('url' => Configure::read('Payment.strPurchaseURL'))); ?>

echo $this->Form->hidden('navigate', array(
    'name'  => 'navigate',
    'value' => ''
));
echo $this->Form->hidden('VPSProtocol', array(
    'name'  => 'VPSProtocol',
    'value' => Configure::read('Payment.strProtocol')
));
echo $this->Form->hidden('TxType', array(
    'name'  => 'TxType',
    'value' => Configure::read('Payment.strTransactionType')
));
echo $this->Form->hidden('Vendor', array(
    'name'  => 'Vendor',
    'value' => Configure::read('Payment.strVendorName')
));
echo $this->Form->hidden('Crypt', array(
    'name'  => 'Crypt',
    'value' => $encrypted
));
echo $this->Form->end(__('Proceed to payment')); 
```

### 控制器

视图控制器的其余部分正确地完成了它的工作，但是这个 if 语句永远不会被调用，因为 post 的操作将它从控制器中带走。`$post_data`是来自会话的数据，由先前的表单生成。

```
 if ($this->request->is('post')) {
        $this->Order->create();
        if ($this->Order->save($post_data)) {
        ... 
```

### 逻辑有缺陷

我知道我的逻辑有缺陷，但是根据我的研究，您无法从控制器发布，所以我最终得到了一个有效的保存按钮或一个有效的远程发布。

我需要**两者都**做，但我还没有偶然发现一个好方法，希望你们中的一个好人可以让我直截了当。

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T14:39:10.237

我认为您应该能够使用 PHP cURL 来实现您想要的。保存订单后，您可以向辅助 URL 发出 POST 请求。这是一个未经测试的示例：

```
if ($this->request->is('post')) {
    $this->Order->create();
    if ($this->Order->save($post_data) {
        $url = 'http://domain.com/post.php';

        //url-ify the data for the POST
        $fields_string = http_build_query($post_data);

        //open connection
        $ch = curl_init();

        //set the url, number of POST vars, POST data
        curl_setopt($ch,CURLOPT_URL, $url);
        curl_setopt($ch,CURLOPT_POST, count($post_data));
        curl_setopt($ch,CURLOPT_POSTFIELDS, $fields_string);

        //execute post
        $result = curl_exec($ch);

        //close connection
        curl_close($ch);
    }
} 
```

你最好的选择是对 cURL 做一些研究:)

# java - “型号”子字符串搜索的高效数据结构

> ID：13728177
> 
> 赞同：0
> 
> 时间：2012-12-05T16:46:30.560
> 
> 标签：java, search, substring

我们有一个问题，我们想对大量 [1MM - 10MM] 的字符串（“型号”）进行子字符串搜索，快速识别包含给定子字符串的任何“型号”。型号是短字符串，例如：

1.  ABB1924DEW
2.  WTW9400PDQB
3.  GLEW1874

目标很简单，给定一个子串，快速找到与该子串匹配的所有型号。例如（在上述型号的范围内），如果我们搜索字符串“EW”，该函数将返回 GLEW1874 和 ABB1924DEW（因为它们都包含子字符串 EW）。

数据结构还需要能够支持快速搜索以给定子字符串开头和/或以给定子字符串结尾的型号。例如，我们需要能够快速进行 WTW...B 之类的搜索（这将匹配 WTW9400PDQB，因为它以 WTW 开头并以 B 结尾）

我正在寻找的是一种内存数据结构，它可以非常有效地进行这些搜索。理想情况下，Java 中也会有一个很好的（简单的）实现，已经在我们可以使用的某个地方完成。简单（和快速）比超级复杂和稍微快一点要好。天真的算法（只是循环遍历所有零件号，对每个零件号进行子字符串搜索）对于我们的目的来说太慢了，我们正在寻找更快的东西（前提是好的）

那么，这个问题的教科书数据结构/算法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T18:48:14.383

你需要的是一个[后缀树](http://en.wikipedia.org/wiki/Suffix_tree)。我不知道要推荐的 Java 库，因此您可能必须自己实现一个

# c++ - 模板别名和 sfinae

> ID：13728184
> 
> 赞同：12
> 
> 时间：2012-12-05T16:46:41.763
> 
> 标签：c++, c++11, sfinae, template-aliases

在涉及模板别名的替换失败的情况下（*例如*，缺少成员类型名上的模板别名，如下面的代码片段所示），是否应该触发错误？

Clang 和 gcc 似乎不同意这一点：

```
// some types
struct bar { };

struct foo {
    typedef void member_type;
};

// template alias
template<class T>
using member = typename T::member_type;

template<class T>
void baz(... ) { }

// only works for gcc, clang fails with: no type named 'member_type'
// in 'bar'
template<class T>
void baz( member<T>* ) { }

int main(int, char** ) {

    baz<bar>(0);            // picks first
    baz<foo>(0);            // picks second

    return 0;
} 
```

所以问题是：谁是正确的，为什么？

谢谢 ：-）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-05T19:26:15.257

根据标准，显然 GCC 是正确的，因为必须立即替换别名模板，然后`typename T::member_type`在`T`已知时应用正常/通常的 SFINAE。

但目前存在一个问题，请参阅[http://www.open-std.org/jtc1/sc22/wg21/docs/cwg_active.html#1554](http://www.open-std.org/jtc1/sc22/wg21/docs/cwg_active.html#1554)。

根据会议结果，似乎需要clangs行为：替换`T`将在别名模板的上下文中完成（即使在替换时`typename T::member_type`，不再引用别名模板 - 它仍然会需要被引用为参数类型模式的来源，如果这是它的实现方式）。

* * *

这类似于另一种在定义时丢弃模式的情况，这可能会影响实例化语义

```
template<int I>
void f(int x[I]);

int main() {
  f<0>(nullptr);
} 
```

在这种情况下，我认为标准规范上也很清楚参数立即被替换`int*`，因此实例化有效。见[http://www.open-std.org/jtc1/sc22/wg21/docs/cwg_active.html#1322](http://www.open-std.org/jtc1/sc22/wg21/docs/cwg_active.html#1322)。

# javascript - 如何知道ajax最后响应已经到达？

> ID：13728186
> 
> 赞同：0
> 
> 时间：2012-12-05T16:46:44.007
> 
> 标签：javascript, ajax, jquery

我试图捕捉/知道它何时达到最后一次 200（成功）并做一些事情，即退出。

我怎么知道它最后一次达到了200？

这是我下面的代码

//调用save和checkstatus函数的主函数

```
 $(function () {
        $("#saveChange").click(function () {
            save().complete(function (jqXHR, responseText) {

                var stat = jqXHR.status;
                if (stat == 200) {
                    console.log("inside 200");

                    setTimeout(function () {
                        checkServerStatus().complete(function (jqXHR, responseText) {

                            if (jqXHR.status == 200) {
                                console.log("inside 200");
                                setTimeout(function () {
                                    checkServerStatus().complete(function (jqXHR, responseText) {
                                        count = 0;
                                        count++;
                                        max = 10;
                                        if ((count <= max) && (jqXHR.status == 200)) {
                                            checkServerStatus();
                                            //alert(count);
                                        }

                                    });
                                    if (jqXHR.status == 500) {
                                        // alert(" 500 setimeout inside 500 status "+jqXHR.status + responseText);  
                                    } else if (jqXHR.status == 200) {
                                        // alert(" 200 setimeout inside 200 status "+jqXHR.status + responseText);  
                                    }
                                }, 9000);

                            } else if (jqXHR.status == 500) {
                                // 500 error no submission
                                console.log("inside 500");
                                //alert(" 300 setimeout inside 500 status "+jqXHR.status + responseText);   
                                checkServerStatus();
                            } else {
                                alert("else");
                            }
                        });
                    }, 6000);
                } 

            });

        });
    });

    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T17:35:32.123

[这里](http://zeroedandnoughted.com/defensive-ajax-and-ajax-retries-in-jquery/)有一个关于重试 ajax 请求的很好的讨论。我建议自己处理延期。这样你就可以让一个假人延迟，随心所欲地解决或拒绝它，然后像往常一样链接。

```
function checkServerStatus() {
    var dfd = new $.deferred();

    $.ajax({
         url : 'ajaxurl.json',
         tryCount : 0,
         retryLimit : 3,
        success : function(json) {
            dfd.resolve();
        },
        error : function(xhr, textStatus, errorThrown ) {
            if (this.tryCount++ <= this.retryLimit) {
                //try again
               $.ajax(this);
               return;
            }
            dfd.reject();
        }
    });
    return dfd;
} 
```

## 像往常一样上链

```
checkServerStatus().then(function() {
    // success!
}, function() {
   // reached retry limit :(
}); 
```

# php - 用于状态缩写的 PHP 脚本无法正常工作

> ID：13728188
> 
> 赞同：1
> 
> 时间：2012-12-05T16:46:51.763
> 
> 标签：php, state, abbreviation

我不确定这个脚本有什么问题。当我运行它时，它只给我缩写的第一个字母。

缩写部分不是我写的，是网上找的。脚本中唯一属于我的部分是 GET 和 Includes。

我已经将状态变量设置为一个状态，但我仍然得到相同的东西，所以我知道这不是我的代码部分。如果有人知道问题是什么，请告诉我。

这是建议的更新代码。仍然有同样的问题。

```
$state = 'Alabama';

function convert_state($name, $get = 'abbr') {
$states = array(
'Alabama'=>'AL',
'Alaska'=>'AK',
'Arizona'=>'AZ',
'Arkansas'=>'AR',
'California'=>'CA',
'Colorado'=>'CO',
'Connecticut'=>'CT',
'Delaware'=>'DE',
'Florida'=>'FL',
'Georgia'=>'GA',
'Hawaii'=>'HI',
'Idaho'=>'ID',
'Illinois'=>'IL',
'Indiana'=>'IN',
'Iowa'=>'IA',
'Kansas'=>'KS',
'Kentucky'=>'KY',
'Louisiana'=>'LA',
'Maine'=>'ME',
'Maryland'=>'MD',
'Massachusetts'=>'MA',
'Michigan'=>'MI',
'Minnesota'=>'MN',
'Mississippi'=>'MS',
'Missouri'=>'MO',
'Montana'=>'MT',
'Nebraska'=>'NE',
'Nevada'=>'NV',
'New Hampshire'=>'NH',
'New Jersey'=>'NJ',
'New Mexico'=>'NM',
'New York'=>'NY',
'North Carolina'=>'NC',
'North Dakota'=>'ND',
'Ohio'=>'OH',
'Oklahoma'=>'OK',
'Oregon'=>'OR',
'Pennsylvania'=>'PA',
'Rhode Island'=>'RI',
'South Carolina'=>'SC',
'South Dakota'=>'SD',
'Tennessee'=>'TN',
'Texas'=>'TX',
'Utah'=>'UT',
'Vermont'=>'VT',
'Virginia'=>'VA',
'Washington'=>'WA',
'West Virginia'=>'WV',
'Wisconsin'=>'WI',
'Wyoming'=>'WY'
);
if($get == 'name') {
// in this case $name is actually the abbreviation of the state name and you want the full name
$states = array_flip($states);
}

return $states[$name];
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-05T19:29:55.323

这个问题已经有了一个很好的答案，但是由于 OP 仍然有这个问题，这里有一个替代解决方案。请注意，数组 $a2s 需要完全填充，因为我只添加了两个状态来保持简短。将以下内容保存到您选择的文件中（例如：state.php）：

```
<?php
$state = $_GET['state'];
echo convert_state($state);

function convert_state($key) {
    $a2s = array( 
        'AL'=>'Alabama',
        'CA'=>'California'
    );
    $array = (strlen($key) == 2 ? $a2s : array_flip($a2s));
    return $array[$key];
}
?> 
```

要运行上述内容，您需要在浏览器中键入以下内容之一（假设您的文件是 state.php）：

```
state.php?state=AL
state.php?state=Alabama 
```

该代码旨在以任何一种方式工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-05T16:53:18.897

您应该将您的重构`$states`为：

```
$states = array(
  'Alabama' => 'AL',
  'Alaska' => 'AK',
  [...]
); 
```

然后你的功能变成：

```
function convert_state($name, $get = 'abbr') {
  $states = [.. see above ..];

  if($get == 'name') {
    // in this case $name is actually the abbreviation of the state name and you want the full name
    $states = array_flip($states);
  }

  return $states[$name];
} 
```

# coldfusion - 创建按字母顺序排列的索引列表（ColdFusion + Microsoft SQL Server）

> ID：13728189
> 
> 赞同：3
> 
> 时间：2012-12-05T16:46:52.527
> 
> 标签：coldfusion

我目前正在努力寻找知道如何做到这一点的人？我尝试了几种不同的方法，最终得到了一半的结果，但并不是我想要的。基本上我正在尝试创建一个显示所有乐队AZ的列表，但是乐队名称是从数据库中调用的，所以我不得不在嵌套列表中使用#band_name#。如果我重新编写代码并发布它，有人可能会看到我哪里出错了。

```
<cfoutput query="bandNameList">
  <cfloop from="65" to="90" index="i">
    <UL>
     <LI> #chr(i)#
       <UL>
         <LI> #band_name# </LI>
       </UL>
     </LI>
    </UL>
  </cfloop>
</cfoutput> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-05T17:07:32.300

我认为您所追求的是仅输出以该字母开头的第一个波段的字母。实现此目的的一种方法是稍微更改您的查询（注意我在这里使用我认为是 SQL-92 语法，但可能有更好的方法来获取特定数据库中的第一个字母）：

```
select 
  band_name, 
  SUBSTRING(band_name from 1 for 1) AS first_letter
from 
  bands 
order by 
  band_name 
```

这将为您提供查询中的第一个字母。

如果您想将所有带数字首字母的波段组合在一起，那么您可以使用 SQL 的 CASE 语句来执行此操作（您可能需要在 DBMS 中找到与 ascii() 等效的语句）。如果这更容易，您还可以反转逻辑并匹配“普通”字母并将其他所有内容归为“0-9 和标点符号”类别。我认为这就是许多音乐系统所做的（我在想 iPhone 上的 iTunes，但我相信还有其他的）

```
select 
  band_name, 
  CASE  
    WHEN ascii(left(band_name, 1)) BETWEEN 48 AND 57 THEN '0-9'
    ELSE left(band_name, 1)
  END AS first_letter   
from 
  bands 
order by 
  band_name 
```

现在，您可以使用该额外列以及 cfoutput 的 group 属性来帮助获得所需的输出。

```
<UL>
<cfoutput query="bandNameList" group="first_letter">
     <LI> #first_letter#
     <UL>
       <cfoutput>             
           <LI> #band_name# </LI>             
       </cfoutput>
       </UL>
     </LI>        
</cfoutput>
</UL> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-05T17:05:00.177

更新您的查询以具有 a`left(band_name,1) AS BandStart`并确保按 band_name 在您的`ORDER BY`. 然后使用 group 输出列表。

```
<cfoutput query="bandNameList" group="BandStart">
 <UL>
  <LI>#bandNameList.BandStart#
   <cfoutput>
    <UL>
     <LI> #bandNameList.band_name# </LI>
    </UL>
   </cfoutput>
  </LI>
 </UL>
</cfoutput> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-05T17:52:55.677

如果要显示所有字母，即使不存在以该字母开头的波段，另一种选择是使用 CTE 生成字母表`A-Z`。然后使用“分组”cfoutput 显示结果：

```
<cfquery name="getBandNameList" ...>
    ;WITH ltrs ( code ) AS (
        SELECT  ascii('A') AS code 
        UNION ALL           
        SELECT  code + 1
        FROM    ltrs
        WHERE   ascii('Z') > code
    )
    SELECT char(code) AS letter, t.band_name
    FROM   ltrs LEFT JOIN @YourTable t ON t.band_name LIKE char(code) +'%'
    ORDER BY letter ASC, t.band_name ASC
</cfquery>

<cfoutput query="bandNameList" group="Letter">
    <UL>
     <LI> #letter#
       <UL>
         <cfoutput>
            <LI> #band_name# </LI>
         </cfoutput>
       </UL>
     </LI>
    </UL>
</cfoutput> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-05T17:38:45.380

另一种方法是编写一个 sql server 存储过程，它在单个查询对象中返回所有内容。代码将类似于：

```
declare @thisNum as int
declare @lastNum as int
set @thisNum = 65;
set @lastNum = 90;

declare @letters as table(letter char(1))

while (@thisNum <= @lastNum)
begin
insert into @letters values (CHAR(@thisNum))
set @thisNum = @thisNum + 1;
end

select letter, bandname
from @letters left join band on letter = left(bandname, 1)
order by letter, bandname 
```

然后，在 ColdFusion 中，您可以将 cfoutput 与 group 属性一起使用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-05T17:12:02.903

试试这个代码::

```
<cfquery datasource="orcl" name="list">
select upper(brand) brand from tbl
</cfquery>
<cfoutput query="list">
  <cfloop from="65" to="90" index="i">
    <UL>
     <LI> #chr(i)#
       <UL>
         <LI><cfif mid(brand,1,1) eq chr(i)> #brand#</cfif></LI>
       </UL>
     </LI>
    </UL>
  </cfloop>
</cfoutput> 
```

# c# - 由于循环负载平衡器，用户正在从网站注销

> ID：13728192
> 
> 赞同：5
> 
> 时间：2012-12-05T16:47:06.347
> 
> 标签：c#, asp.net, asp.net-mvc, load-balancing

我们的运营商已经在我们的门户网站上实施了循环负载均衡器，它似乎导致了一些我无法深入了解的问题。

我能够确定我们在哪台服务器上，当我们在网站上导航时，我们停留在服务器 A 上。如果我离开它 5 分钟并尝试另一个页面，我将被推送到服务器 B，注销并显示登录页面。

我让他们确保 machine.config 中的 MachineKey 在两台服务器上都是相同的，并且我已经在本地测试了会话没有被使用 - 我可以在本地完全关闭会话并且它仍然可以工作。我已经在两台服务器上验证了它正在域上创建一个 ASPXAUTH cookie，因此我们应该在两台服务器上都被归类为经过身份验证 - 但每次我更改服务器时都会失去我的身份验证。

关于什么可能导致注销的任何想法？我猜这是我对 ASPXAUTH 工作原理的误解。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T19:39:26.953

会话与表单身份验证分开处理。这里有一个很好的[解释](https://stackoverflow.com/questions/1335472/does-formsauthentication-setauthcookie-make-a-session-based-cookie/1335538#1335538)。

负载平衡环境中表单身份验证失败的最常见原因是缺少 MachineKey 元素的同步。您已经声明您已经让服务器操作员确保 MachineKey 是同步的，但是您是否以某种方式自己验证了这一点？所有网络服务器都是这种情况吗？从之前与几个商业网络主机的交易中，我发现（不幸的是）很难从表面上接受他们的保证。

要检查的另一件事是 FormsAuthentication 配置（超时、路径、名称等）是否在所有主机上都相同。

所有主机上的补丁级别是否相同？您可能想查看[此处](http://support.microsoft.com/kb/2659968)提到的兼容性开关是否适用于您的情况。

假设主机设置是正确的，如果某些条件不满足，也许您的页面上有初始化代码会注销您？

尝试查看服务器日志并跟踪失败的页面请求期间涉及的 HTTP 请求序列。这可能会产生一个线索。

编辑：本指南对表单身份验证问题进行故障排除非常详细，并且很有帮助：[表单身份验证故障排除](http://www.iis.net/learn/troubleshoot/security-issues/troubleshooting-forms-authentication)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T19:57:47.080

检查依赖于 cookie 的任何其他应用程序功能。服务器 B 上的 Web 服务器将无法识别来自服务器 A 的 cookie。如果您的身份验证的任何部分依赖于填充的 cookie，那么这可能会导致您的问题。

您可能已经确保用于 cookie 的域在所有负载平衡服务器上都是相同的，但我想我会提到这一点。如果域不兼容，则浏览器将不会将 cookie 发送到服务器。

# jquery - 如果值不为空，则显示（播放！2）表单输入字段

> ID：13728195
> 
> 赞同：1
> 
> 时间：2012-12-05T16:47:17.370
> 
> 标签：jquery, playframework

我的表单中有一个输入，我只想在值不为 null 或空时显示，所以我在代码中创建输入（Play！生成的 html 看起来像这样） -

```
<dl class=" " id="entry_field">
  <dt><label for="entry">Blah:</label></dt>
  <dd>
    <input type="text" id="entry" name="entry" value="Blah" readonly="readonly">
  </dd>
</dl> 
```

然后将其隐藏在 jQuery onload 事件中，如下所示：

```
$(document).ready(function() {
  $( "#entry_field" ).hide();
}); 
```

所以现在我想测试输入条目是否具有非空值，如果有，则显示整个内容。所以我尝试了以下，但 entry_field 没有显示。

```
if( $('#entry').attr("value") != '') {
  $( '#entry_field').show();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T16:48:13.267

我认为您不会在**DOM** Ready 处理程序中添加它。

确保将其添加到其中，否则可能无法正常工作。

```
$(document).ready(function() {
    $("#entry_field").hide();

    if ($('#entry').attr("value") != '') {
        $('#entry_field').show();
    }
});​ 
```

`.val()` 改为使用

```
 if( $('#entry').val() !== '') { 
```

**[检查小提琴](http://jsfiddle.net/sushanth009/zfnSs/1/)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T16:54:21.610

你确定你的第二段代码被调用了吗？您能否尝试添加一个 console.log("hey") 或其他东西？因为我做了[这个 jsFiddle](http://jsfiddle.net/RedKnight91/rv7Zp/)来尝试代码，它完全有效:)

尝试在 $(document).ready 中添加两个字段，如下所示

```
$(document).ready(function() {
    $( "#entry_field" ).hide();

    if( $('#entry').attr("value") != '') {
        $( '#entry_field').show();
    }
}); 
```

如果您想检查负载，如果您想在触发事件或其他内容时调用该函数，请务必将其分配给正确的事件。

# ios - 为什么在 iPad2/iOS6 上从相机到 AIR 的延迟很长（47 秒） - CameraUI、Loader、MediaEvent、MediaPromise

> ID：13728197
> 
> 赞同：2
> 
> 时间：2012-12-05T16:47:21.687
> 
> 标签：ios, apache-flex, mobile, air, loader

我使用 Jason Sturges 提供的 DevGirl XpenseIt 解决方案取得了很大的成功，以响应其他几个寻求帮助的请求：(http://stackoverflow.com/questions/11812807/take-photo-using- adobe-builder-flex-for-ios 是最好的例子）

取得了巨大的成功，除了在使用 CameraUI 和教程中的 util 类拍摄照片后按下 iOS6 中的“使用”按钮之间，它需要 47 只 1-河马，2 只河马，直到“fileReady”事件发生。

在我看来，Loader 类似乎不需要那么长的时间。

我可以做些什么来提高这种性能吗？我被迫添加了一个快点等待 UI 元素，这样我的用户就不会认为程序已经挂起。这是上面的 CameraUtil.as 的代码，因为我目前正在使用它。

```
// http://stackoverflow.com/questions/11812807/take-photo-using-adobe-builder-flex-for-ios
package classes
{
  import flash.display.BitmapData;
  import flash.display.Loader;
  import flash.display.LoaderInfo;
  import flash.events.Event;
  import flash.events.EventDispatcher;
  import flash.events.IEventDispatcher;
  import flash.events.MediaEvent;
  import flash.filesystem.File;
  import flash.filesystem.FileMode;
  import flash.filesystem.FileStream;
  import flash.media.CameraRoll;
  import flash.media.CameraUI;
  import flash.media.MediaPromise;
  import flash.media.MediaType;
  import flash.utils.ByteArray;

  import mx.graphics.codec.JPEGEncoder;

  import events.CameraEvent;

  [Event(name = "fileReady", type = "events.CameraEvent")]

  public class CameraUtil extends EventDispatcher
  {
    protected var camera:CameraUI;
    protected var loader:Loader;
    public var file:File;

    public function CameraUtil(target:IEventDispatcher=null)
    {
      super(target);

      if (CameraUI.isSupported)
      {
        camera = new CameraUI();
        camera.addEventListener(MediaEvent.COMPLETE, mediaEventComplete);
      }
    } // End CONSTRUCTOR CameraUtil

    public function takePicture():void
    {
      if (camera)
        camera.launch(MediaType.IMAGE);
    } // End FUNCTION takePicture

    protected function mediaEventComplete(event:MediaEvent):void
    {
      var mediaPromise:MediaPromise = event.data;

      if (mediaPromise.file == null)
      {
        // For iOS we need to load with a Loader first
        loader = new Loader();
        loader.contentLoaderInfo.addEventListener(Event.COMPLETE, loaderCompleted);
        loader.loadFilePromise(mediaPromise);
        return;
      }
      else
      {
        // Android we can just dispatch the event that it's complete
        file = new File(mediaPromise.file.url);
        dispatchEvent(new CameraEvent(CameraEvent.FILE_READY, file));
      }
    } // End FUNCTION mediaEventComplete

    protected function loaderCompleted(event:Event):void
    {
      var loaderInfo:LoaderInfo = event.target as LoaderInfo;
      if (CameraRoll.supportsAddBitmapData)
      {
        var bitmapData:BitmapData = new BitmapData(loaderInfo.width, loaderInfo.height);
        bitmapData.draw(loaderInfo.loader);
        file = File.applicationStorageDirectory.resolvePath("receipt" + new Date().time + ".jpg");
        var stream:FileStream = new FileStream()
        stream.open(file, FileMode.WRITE);

        var j:JPEGEncoder = new JPEGEncoder();
        var bytes:ByteArray = j.encode(bitmapData);
        stream.writeBytes(bytes, 0, bytes.bytesAvailable);
        stream.close();
        dispatchEvent(new CameraEvent(CameraEvent.FILE_READY, file));
      }
    } // End FUNCTION loaderComplete

  } // End CLASS CameraUtil
} // End PACKAGE classes 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T15:10:47.350

我能够通过从流程中删除一个步骤来解决我的延迟问题。这一步是我自己（目前）不需要但其他人可能需要的一步，因此删除它并不能真正回答“为什么这个看似合理的过程要花费看似不合理的时间”的问题。

我需要 BitmapData，而不是外部文件，而不是：

*Camera => [snap] => Media Promise => Loader => Write File => Event => Read File => Use BitmapData*

我重写了类以删除 File/AppStorage i/o。

*Camera => [snap] => Media Promise => Loader => 使用 BitmapData*

所以非常合理（和预期的补偿时间）。

然而，我仍然感到惊讶的是，使用 CameraUtil 类中使用的方法将数据写入文件需要这么长时间。我确实需要将这些图像写到文件中，但直到用户将大小减小到 1024x768 裁剪区域并将它们编码为非常压缩的 jpg，所以希望我只会与一小部分挂起/补偿时间。

有人知道...从 Adob​​e AIR（通过 flex）将 1 个文件写入 iOS 中的应用程序存储需要很长时间吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-28T09:38:17.380

我发现这个过程也非常缓慢……但是，JPEGEncoder 似乎对这种延迟做出了很大贡献。您可以使用可在此处找到的优化编码器大大加快该过程。

[http://www.bytearray.org/?p=775](http://www.bytearray.org/?p=775)

根据您的设备，它比原始设备快 2 到 4 倍。

另一个可以省略的步骤是 bitmapData.draw()，它也很慢，直接使用 Loader.content。这样您就可以跳过另一个位图实例的实例化，这将导致内存使用量激增。

像这样：

```
protected function loaderCompleted(event:Event):void
{
  var loader:Loader = (event.target as LoaderInfo).loader;
  var bitmap:Bitmap = loader.content as Bitmap;
  (...)
} 
```

尽管如此，我仍在等待有人编写一个 iOS .ane，它应该能够在几毫秒而不是几秒内对 jpg 进行编码。但与此同时... ;)

# android - 你可以在android网站上使用数据库吗？

> ID：13728203
> 
> 赞同：3
> 
> 时间：2012-12-05T16:47:40.720
> 
> 标签：android, django

我正在同时开发一个应用程序和一个网站。该网站将在 django 中完成，并使用 Google 的应用引擎，因此使用 Google 的数据库。无论如何，我可以下载并使用数据库用于 android 应用程序吗？最好我希望它下载并提供给用户离线使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T18:01:11.487

在服务器端使用像 django tastepie 这样的 REST api，并为您的 android 应用程序所需的模型消耗剩余资源。在您的 android 上获得 Json/xml 消息后，只需将其保存到本地 sqllite db

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T16:52:38.667

Android 确实提供了一个 SQLite 接口供您读取和写入本地数据库。您可以通过网络请求获取数据库并将其保存在本地，是的。使用 Google App Engine 不会帮助/阻碍您执行此操作的能力。

# c++ - 在 C++ 图中使用深度优先搜索

> ID：13728206
> 
> 赞同：0
> 
> 时间：2012-12-05T16:47:52.440
> 
> 标签：c++, algorithm, graph, depth-first-search

我有一个包含交叉口（ID 安全名称）和街道（Intersection1 Intersection2 距离）的数据文件，如图所示：

```
INTERSECTIONS:
198 0.8 alvemon and 28th
199 0.6 alvemon and 29th
200 0.8 alvemon and 30th

STREETS:
1   2   0.6
2   3   0.1
3   4   0.9 
```

交叉点是顶点，街道是边。这是我的标题： 顶点标题：

```
#ifndef VERTEX_H
#define VERTEX_H
#include<list>
#include<string>
#include "global.h"

struct Vertex_{
int xsect;
double danger;
std::string xstreets;

std::list<Edge> EdgeList;
/*struct Vertex_ *next;
struct Vertex_ *prev;*/
};

#endif 
```

边缘标题：

```
#ifndef EDGE_H
#define EDGE_H

#include "global.h"
#include "vertex.h"
struct Edge_{
Vertex *adjvertex;
double distance;

/*struct edge *next;
struct edge *prev;*/
};

#endif 
```

我正在用列表制作图表。我已经完成了所有设置，并且制作了街道/十字路口的图表（或地图）。由于以下要求，我知道我需要使用深度优先搜索，但不确定如何实现。如果有人能给我一个深度优先搜索的例子，那就太好了。现在我的任务需要我：

慢跑路径要求

safejogger 程序应搜索提供的图形以找到满足以下要求的慢跑路径： 路径必须在用户指定的起始交点指示的同一交叉点（即顶点）处开始和结束。该路径不应重新访问任何交叉路口。换句话说，任何顶点都不应该在路径中出现两次。路径的总距离应在用户指定距离目标的 1 英里范围内。

慢跑路径安全

safejogger 程序应该计算慢跑路径的两个统计数据，包括： 平均路径安全：慢跑路径内所有交叉口的平均安全指数。最小路径安全：慢跑路径内所有路口的最小安全指数。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T18:20:28.060

如果要在图上实现 DFS，则需要一种方法来标记已访问过的顶点。您可以更改顶点结构以包含标志，或者使用单独的位向量将所有标志重新组合在一起。

对于 DFS 算法，它非常简单：

*   你标记你开始的顶点，
*   你跟随每一个边缘离开它，
*   如果尚未标记结束顶点，则递归运行 DFS 算法。

这就是底线。您可以使用堆栈将该算法转换为循环（而不是递归）。

在你的任务中，你必须在 DFS 的每一步都做一些事情，所以你需要弄清楚如何做这些额外的事情。提示：创建一个在图上执行 DFS 工作的类，并派生该类以实现额外的东西。

您的问题的第二部分不是关于 DFS，而是关于处理搜索结果，一条慢跑路径，它是一个顶点列表。

# .net - 使用 .NET 从 xlsx 文件中提取单元格范围作为图像

> ID：13728207
> 
> 赞同：0
> 
> 时间：2012-12-05T16:47:58.103
> 
> 标签：.net, excel, bitmap, render

我正在寻找一种无需任何用户操作即可从电子表格文档中提取单元格范围作为图像文件的方法。

我能够使用 OpenXML SDK 生成电子表格文档。我想定义一个单元格范围并使用 .NET 将这些单元格呈现为图像。此功能存在于 Excel 中，我认为可以使用宏来管理它：[Export bitmap image from Excel cells](https://stackoverflow.com/questions/8852656/export-bitmap-image-from-excel-cells) 但是我不知道它是否存在使用 OpenXML SDK 执行宏的方法。

有人能帮我吗 ？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T10:06:59.830

可以使用 interrop 管理 Excel，关于内存问题，您只需要阅读有关 COM 和 Marshaling 组件的 Microsoft 文档

[http://social.msdn.microsoft.com/Forums/fr-FR/visualcsharpfr/thread/e7c5109f-2beb-4669-b73c-50d28f29f6cf](http://social.msdn.microsoft.com/Forums/fr-FR/visualcsharpfr/thread/e7c5109f-2beb-4669-b73c-50d28f29f6cf)然后读取剪贴板并将元数据位图转换为位图类。

[http://support.microsoft.com/default.aspx?scid=kb;en-us;317109](http://support.microsoft.com/default.aspx?scid=kb;en-us;317109)为避免内存问题，您必须按目的实现 NAR 方法。

如果您在 Web 应用程序或 Web 服务中使用它，我建议您将逻辑放在 STA 线程中。

# python - DataFrame 的几个时间序列

> ID：13728208
> 
> 赞同：12
> 
> 时间：2012-12-05T16:48:06.710
> 
> 标签：python, pandas, time-series

我在将多个时间序列合并到一个通用 DataFrame 时遇到问题。我正在使用的示例代码：

```
import pandas
import datetime
import numpy as np

start = datetime.datetime(2001, 1, 1)
end = datetime.datetime(2001, 1, 10)
dates = pandas.date_range(start, end)
serie_1 = pandas.Series(np.random.randn(10), index = dates)
start = datetime.datetime(2001, 1, 2)
end = datetime.datetime(2001, 1, 11)
dates = pandas.date_range(start, end)
serie_2 = pandas.Series(np.random.randn(10), index = dates)
start = datetime.datetime(2001, 1, 3)
end = datetime.datetime(2001, 1, 12)
dates = pandas.date_range(start, end)
serie_3 = pandas.Series(np.random.randn(10), index = dates)

print 'serie_1'
print serie_1
print 'serie_2'
print serie_2
print 'serie_3'
print serie_3

serie_4 = pandas.concat([serie_1,serie_2], join='outer', axis = 1)
print 'serie_4'
print serie_4
serie_5 = pandas.concat([serie_4, serie_3], join='outer', axis = 1)
print 'serie_5'
print serie_5 
```

这给了我 serie_5 的错误（第二个 concat）：

```
Traceback (most recent call last):
  File "C:\Users\User\Workspaces\Python\Source\TestingPandas.py", line 29, in <module>
    serie_5 = pandas.concat([serie_4, serie_3], join='outer', axis = 1)
  File "C:\Python27\lib\site-packages\pandas\tools\merge.py", line 878, in concat
    verify_integrity=verify_integrity)
  File "C:\Python27\lib\site-packages\pandas\tools\merge.py", line 948, in __init__
    self.new_axes = self._get_new_axes()
  File "C:\Python27\lib\site-packages\pandas\tools\merge.py", line 1101, in _get_new_axes
    new_axes[i] = self._get_comb_axis(i)
  File "C:\Python27\lib\site-packages\pandas\tools\merge.py", line 1125, in _get_comb_axis
    all_indexes = [x._data.axes[i] for x in self.objs]
AttributeError: 'TimeSeries' object has no attribute '_data' 
```

我希望结果看起来像这样（第 2 列中有随机值）：

```
 0         1         2
2001-01-01 -1.224602       NaN       NaN
2001-01-02 -1.747710 -2.618369       NaN
2001-01-03 -0.608578 -0.030674 -1.335857
2001-01-04  1.503808 -0.050492  1.086147
2001-01-05  0.593152  0.834805 -1.310452
2001-01-06 -0.156984  0.208565 -0.972561
2001-01-07  0.650264 -0.340086  1.562101
2001-01-08 -0.063765 -0.250005 -0.508458
2001-01-09 -1.092656 -1.589261 -0.481741
2001-01-10  0.640306  0.333527 -0.111668
2001-01-11       NaN -1.159637  0.110722
2001-01-12       NaN       NaN -0.409387 
```

怎么了？正如我所说，可能是基本的，但我无法弄清楚，我是初学者......

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-05T16:55:39.810

连接列表`Series`返回 a `DataFrame`。因此，`serie_4`是一个`DataFrame`。`serie_3`是一个`Series`。将 a`DataFrame`与 a连接`Series`会引发异常。

你可以使用

```
import pandas as pd
serie_5 = pd.concat([serie_1, serie_2, serie_3], join='outer', axis=1) 
```

反而。

* * *

例如，

```
import functools
import numpy as np
import pandas as pd

s1 = pd.Series([0,1], index=list('AB'))
s2 = pd.Series([2,3], index=list('AC'))

result = pd.concat([s1, s2], join='outer', axis=1, sort=False)
print(result) 
```

产量

```
 0    1
A  0.0  2.0
B  1.0  NaN
C  NaN  3.0 
```

请注意，如果您尝试连接具有非唯一索引的系列，则会收到 ValueError。例如，

```
s3 = pd.Series([0,1], index=list('AB'), name='s3')
s4 = pd.Series([2,3], index=list('AA'), name='s4') # <-- non-unique index
result = pd.concat([s3, s4], join='outer', axis=1, sort=False) 
```

提高

```
ValueError: cannot reindex from a duplicate axis 
```

要解决此问题，请重置索引并[合并 DataFrame](https://stackoverflow.com/a/30512931/190597)：

```
import functools   
s3 = pd.Series([0,1], index=list('AB'), name='s3')
s4 = pd.Series([2,3], index=list('AA'), name='s4') # <-- non-unique index

result = functools.reduce(
    lambda left,right: pd.merge(left,right,on='index',how='outer'), 
    [s.reset_index() for s in [s3,s4]])
print(result) 
```

产量

```
 index  s3   s4
0     A   0  2.0
1     A   0  3.0
2     B   1  NaN 
```

# sql - 如果源表和目标表索引不同，则 SQL Server 2008 R2 中的复制

> ID：13728209
> 
> 赞同：0
> 
> 时间：2012-12-05T16:48:07.223
> 
> 标签：sql, sql-server, sql-server-2008

为了微调整个系统的性能，我检查了现有表的索引，发现我们正在使用一个 ErrorLog 表，该表每天都有数百万个事务被命中（用于写入警告和错误）。由于我们在这种表上有索引（在日期时间上），我认为这种日志记录肯定会比登录到没有任何索引的表花费更长的时间。

CreateDateTime 上的整个索引仅供开发人员用于查询表以在生产环境中进行故障排除。是否可以在主生产服务器上取出索引并仅对辅助（备份）数据库服务器中的表进行索引。当我们在辅助服务器上进行复制时，数据总是在 Sysc 中。

要通过复制同步两个表，我们是否需要在两个表上具有相同的索引？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T18:18:43.247

假设事务复制，没有什么说发布者和订阅者之间的索引必须相同。您唯一需要保留的是主键，因为这就是复制如何识别订阅者上的哪些行需要受到发布者的给定语句的影响。

# java - 同步方法，何时使用

> ID：13728216
> 
> 赞同：2
> 
> 时间：2012-12-05T16:48:31.707
> 
> 标签：java, synchronization

我需要创建一个类来包装其他非“线程安全”的类和方法（第 3 方）。我实际上想创建一个单线程类/方法。

这应该这样做：

```
public class SomeClass {
    public static synchronized void performTask(int val) {
        //interesting non-thread safe code...
        ThisClass thisclass = new ThisClass();
        thisclass.dostuff();
        ThatClass thatclass = new ThatClass();
        thatclass.dootherstuff();
        HisClass hisclass = new HisClass();
        hisclass.notsure();
    } 
```

1 个静态类和 1 个同步的静态方法。因此，如果多个对象正在使用/调用此类。他们将不得不“排队”等待。如果负载过重，性能会受到影响。

```
public class MyClass {
    public void mytask() {
        //interesting code
        SomeClass.performTask(myval); // will wait if some other code block is in SomeClass.performTask?
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T16:52:14.150

`Synchronization``multi-threaded`在环境中是必需的。当多个线程可以同时访问您的资源时，您可能需要`synchronization`资源访问。

# android - 是否可以在 Android 的对话框中显示 mapView？

> ID：13728223
> 
> 赞同：0
> 
> 时间：2012-12-05T16:49:02.037
> 
> 标签：android, android-mapview

这是我的代码：

```
 Dialog dialog = new Dialog(this);
    dialog.setContentView(R.layout.show_info_with_map);
    dialog.setTitle(title);
    dialog.setCancelable(true);
    dialog.show(); 
```

show_info_with_map 是一个带有 maoView 和一些 textView 的布局文件。我确实添加了用户库和扩展 MapActivty。但我仍然收到以下错误：

`E/AndroidRuntime(23846): android.view.InflateException:`

`Binary XML file line #108: Error inflating class com.google.android.maps.MapView`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T16:55:19.557

绝对地！添加`android:theme="@android:style/Theme.Dialog"`到清单中的地图活动，它会以对话框的形式出现。然后，您可以通过调整地图活动布局来控制对话框的显示方式

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T16:54:49.533

显示您`MapView`的`MapActivity`，只需通过应用使其看起来像对话框`Theme.Dialog`即可。

没有别的办法。至少使用 API v1。您还可以查看[Maps API V2](https://developers.google.com/maps/documentation/android/)

# extjs - Extjs - 更改 labelAble 样式的默认无效字段 messageTarget

> ID：13728227
> 
> 赞同：2
> 
> 时间：2012-12-05T16:49:15.843
> 
> 标签：extjs, extjs4, extjs4.1

在 extjs 中，是否有任何方法可以从一个位置更改整个项目中特定类型控件的属性，本质上使其成为该类的所有新实例上该属性的默认值？

特别是，我想将所有字段控件上的所有[msgTarget](http://docs.sencha.com/ext-js/4-1/#%21/api/Ext.form.Labelable-cfg-msgTarget)从“qtip”更改为“side”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T20:39:25.657

这应该有效：

```
Ext.onReady( function() { 

    Ext.override( Ext.form.Labelable, {
         msgTarget: 'side'
    });

}); 
```

有关更多信息，请参阅[此答案](https://stackoverflow.com/questions/13615817/how-to-extend-override-a-predefined-core-sencha-class/13617177#13617177)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-29T12:40:57.763

唯一对我有用的是这样的：

```
Ext.define('FooMsgTargetOverride', {
    override: 'Ext.form.field.Base',
    msgTarget: 'under'
}); 
```

# java - 如何使用 Google App Engine Blobstore 压缩图像

> ID：13728233
> 
> 赞同：3
> 
> 时间：2012-12-05T16:49:27.420
> 
> 标签：java, google-app-engine, blobstore

我们有一个应用程序从 blobstore 提供一系列图像。这里有一个例子：

[http://lh4.ggpht.com/f76xUkRZLRkb_Qz5uu82TX3LoBRh4eYb9hxYwMRMLCk5ghO_OL0DW2v4rRnkewUyDWfBuBttgbUvuJJXwtFQosEB=s0](http://lh4.ggpht.com/f76xUkRZLRkb_Qz5uu82TX3LoBRh4eYb9hxYwMRMLCk5ghO_OL0DW2v4rRnkewUyDWfBuBttgbUvuJJXwtFQosEB=s0)

这是一个巨大的 png，因此下载为 536K。

如果我们将它的大小调整为 400，它仍然很大（263k）：

[http://lh4.ggpht.com/f76xUkRZLRkb_Qz5uu82TX3LoBRh4eYb9hxYwMRMLCk5ghO_OL0DW2v4rRnkewUyDWfBuBttgbUvuJJXwtFQosEB=s400](http://lh4.ggpht.com/f76xUkRZLRkb_Qz5uu82TX3LoBRh4eYb9hxYwMRMLCk5ghO_OL0DW2v4rRnkewUyDWfBuBttgbUvuJJXwtFQosEB=s400)

我们如何以某种更好的压缩方式请求或存储图片？我们的应用程序有一个移动客户端，等待 273K 的速度真的很慢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-05T20:33:20.897

有[图像 API](https://developers.google.com/appengine/docs/java/images/)。要压缩和调整图像大小：

```
// get image from blobstore
ImagesService imagesService = ImagesServiceFactory.getImagesService();
Image oldImage = ImagesServiceFactory.makeImageFromBlob(blobKey); 

// compress & resize it
OutputSettings settings = new OutputSettings(ImagesService.OutputEncoding.JPEG);
settings.setQuality(90);
Transform transform = ImagesServiceFactory.makeResize(newWidth, newHeight) 
Image newImage = imagesService.applyTransform(transform, oldImage, settings);
byte[] blobData = newImage.getImageData();

//save data to blobstore
FileService fileService = FileServiceFactory.getFileService();
AppEngineFile file = fileService.createNewBlobFile("image/jpeg", someFilename);
FileWriteChannel writeChannel = fileService.openWriteChannel(file, true);
writeChannel.write(ByteBuffer.wrap(blobData));
writeChannel.closeFinally();

// get the blobKey to newly written data
BlobKey blobKey = fileService.getBlobKey(file); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T17:08:57.873

您可以使用[PIL](https://developers.google.com/appengine/docs/python/tools/libraries27)从前端实例动态提供重新压缩的图像。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-05T17:09:55.003

您可以将图像的不同版本（具有不同压缩比）上传到[blobstore](https://developers.google.com/appengine/docs/python/blobstore/)或[云存储](https://developers.google.com/appengine/docs/python/googlestorage/)，并选择要在客户端显示的版本（使用 CSS 或客户端逻辑）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-05T16:52:46.987

您可以启用[Pagespeed 服务](https://developers.google.com/appengine/docs/adminconsole/performancesettings#pagespeed)以即时重新压缩图像。

# c# - 这是在共享组件中使用接口作为模型的好方法吗？

> ID：13728237
> 
> 赞同：2
> 
> 时间：2012-12-05T16:49:49.230
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3

我必须创建共享局部视图**Partial1**，它将在其他屏幕上使用。**因此，我可以创建接口IPartialModel1** ，而不是为共享组件创建特定模型**PartialModel1**。

 **然后其他屏幕可以像这样实现 IPartialModel1

```
BigScreenModel1:IPartialModel1
BigScreenModel2:IPartialModel1 
```

所以在 BigScreen.cshtml 我可以使用

```
@Html.Partial("Partial",BigScreenModel1) 
```

在 BigScreen2.cshtml 上

```
@Html.Partial("Partial",BigScreenModel2) 
```

这是好习惯吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T20:26:43.153

这种方法虽然可行，但我遇到的问题是您将部分视图模型与包含页面的视图模型绑定在一起。

更好的方法是将部分视图模型作为页面视图模型的成员，如下所示：

```
public class BigScreenModel1
{
    public PartialViewModel OtherViewModel { get; set; } 
}

public class BigScreenModel2
{
    public PartialViewModel OtherViewModel { get; set; }
} 
```

然后当然是：

```
@Html.Partial("Partial", Model.OtherViewModel) 
```

在两页上。这将视图模型彼此分离。**

# java - 替换 ArrayList 中的对象

> ID：13728239
> 
> 赞同：7
> 
> 时间：2012-12-05T16:49:51.143
> 
> 标签：java, arraylist

我需要知道如何替换`ArrayList<Animal>`.

我有一个名为`ArrayList<Animal>`. 该列表仅列出了 5 种动物。

```
Animal animal = new Animal();
animal.setName("Lion");
animal.setId(1);

ArrayList<Animal> a = new ArrayList<Animal>();

a.put(animal); // likewise i will be adding 5-6 animals here. 
```

稍后，我将从这个数组列表中获取一个对象并对其进行修改。

```
Animal modifiedAnimal = new Animal();
 animal.setName("Brown Lion");
    animal.setId(1); 
```

现在我需要将此动物对象添加到`ArrayList<Animal> a` 数组列表中。我需要它来替换`Animal`我们之前命名的对象`Lion`。我怎样才能做到这一点 ？

注意：我不知道添加此对象的索引。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-05T16:52:42.173

如果您真的想用全新的替换列表中的，**请**使用. 要使用，您需要知道要替换的索引。你可以用.`Animal``Animal`[`List#set`](http://docs.oracle.com/javase/7/docs/api/java/util/List.html#set%28int,%20E%29)`List#set``Animal`[`List#indexOf`](http://docs.oracle.com/javase/7/docs/api/java/util/List.html#indexOf%28java.lang.Object%29)

如果您只想*修改*已经在集合中的动物，您不必对列表做任何事情，因为存储在列表中的是对对象的引用，而不是对象的副本。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-05T16:52:19.020

您必须首先从列表中获取其引用并简单地对其进行修改。像这样：

```
Integer yourId = 42;

for (Animal a : animalList){
     if (a.getId().equals(yourId)){
          a.setName("Brown Lion");
          //...
          break;
     }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-05T16:52:32.953

```
for(Animal al: a){
    if(al.getName().equals("Lion")){
       al.setName("Brown Lion");
       al.setId(1);
       break;
    }
} 
```

1.  遍历您的列表，直到找到动物
2.  改变它的属性
3.  跳出循环

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-05T16:54:46.913

查看 bellum 的帖子，了解如何使用`ArrayList`. 但是，您可能会更好`HashMap<String, Animal>`

```
HashMap<String, Animal> animals = new HashMap<String, Animal>();
// ...
Animal animal = new Animal();
animal.setName("Lion");
animal.setId(1);
animals.put(animal.getName(), animal);

// to modify...

Animal lion = animals.remove("Lion"); // no looping, it finds it in constant time
lion.setName("Brown Lion");
animals.put(animal.getName(), animal); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-05T16:54:29.090

您可以轻松地使用 HashMap。您的键是 id，值是动物对象。

通过使用`get`方法，您可以获取所需的动物对象并进行修改，然后再次将新动物放在同一个键上。

# c# - 当阅读器关闭错误时，asp.net 对 FieldCount 的尝试无效

> ID：13728240
> 
> 赞同：1
> 
> 时间：2012-12-05T16:49:53.170
> 
> 标签：c#, asp.net, sqldatareader

> **可能重复：**
> [阅读器关闭时调用 FieldCount 的尝试无效](https://stackoverflow.com/questions/3465490/invalid-attempt-to-call-fieldcount-when-reader-is-closed)

我在 c# 中使用 asp.net。我试图在 aspx2.cs 上的 finally 语句中关闭连接。

在 aspx1.cs 中：

```
private void BindDataGrids()
{
     try
     {
          DataGrid1.DataSource = instance.ShowDifferences(Convert.ToInt32(Request.QueryString

["CrewId"]), DateTime.Parse(Request.QueryString["StartDate"]), DateTime.Parse(Request.QueryString["EndDate"]));
          DataGrid1.DataBind();
      }
 } 
```

在 aspx2.cs 中：

```
 public static SqlDataReader ShowDifferences(int crewID, DateTime date1, DateTime date2)
 {
      Database db = DatabaseFactory.CreateDatabase();
      string sqlCommand = "stored_procedure";
      DBCommandWrapper command = db.GetStoredProcCommandWrapper(sqlCommand);
      try
      {
........code...........
         command.AddInParameter("@EndDate", DbType.Date, date2);
                IDataReader reader = db.ExecuteReader(command);
         return (SqlDataReader)reader;
      }
      finally
      {
          command.Command.Connection.Close();
      } 
```

当它到达 DataGrid1.DataBind(); 在 aspx1.cs 上。

我得到错误：

```
"Invalid attempt to FieldCount when reader is closed error" 
```

如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-05T17:03:31.217

您正在返回一个需要打开连接才能访问的阅读器，但您在退出`Read`之前关闭了连接。`ShowDifferences`读取器是增量获取数据的游标，读取的整个过程都必须连接到数据库。如果您想将内存数据集 ( `DataTable`) 与后端数据库断开连接，请考虑`Fill`使用`SqlDataAdapter`.

**更新：**

在`DataGrid1.DataBind();`“移动线之后关闭连接”

```
command.Command.Connection.Close(); 
```

到`instance`'s 类的单独方法（例如`CloseConnection`）并调用

```
instance.CloseConnection(); 
```

之后`DataGrid1.DataBind();`。为此，当然，您需要更改`DBCommandWrapper command`为`instance`' 类成员。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-05T19:20:37.523

使用时必须打开连接`DbDataReader`，ExecuteReader 不会自动打开它。像这样的东西：

```
using (DbConnection conn = factory.CreateConnection())
{
   conn.ConnectionString = connString;

   DbCommand cmd = conn.CreateCommand();
   cmd.CommandText = "...";

   conn.Open();
   DbDataReader reader = cmd.ExecuteReader();

   while (reader.Read())
   { ...
   }
} 
```

只有当您使用 a 时，`DataSet`您才不必处理连接。如果你真的在你的 ExecuteReader 方法中打开了连接，你必须保持它打开，只要你保持阅读器。

# c - 在 C 语言中使用 Luhn 算法进行信用卡验证

> ID：13728246
> 
> 赞同：1
> 
> 时间：2012-12-05T16:50:12.617
> 
> 标签：c, pseudocode

```
#include <stdio.h>

int main(int argc, string argv[])
{
   Get input from the user;
   Store it in a long long int;

   // iterate through the number
   for each odd number in the input multiply by 2
   if the number is bigger than 9 then
   do module of it and add it to the first number;
   store it into metasum;

   for each even number in the input
   add it to the others;
   store the result into metasum2;

   // is it a valid card?
   if (metasum + metasum2)%10 == 0
   {
   card is valid;
   // check which kind of cc is
   if the input begins with a 3 then it's an AMEX;
   else if the input begins with 4 it is a VISA;
   else if the input begins with 5 it is a MASTERCARD;
   }
   else
   {
   card is not valid;
   }

} 
```

它实际上是一种伪代码。我正在参加 CS50x，我想知道我的伪代码实现是否足够好。

不过我还有另一个问题，当我尝试在 CI 中实现代码时，不知道如何遍历 long long int，所以我无法实现 Luhn 算法。

如何在不使用字符串然后将每个 char 转换为 int 的情况下做到这一点？

感谢您的答复

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T16:56:22.230

要“迭代”非数组，您需要单独跟踪您的位置（以计算所有可能的数字），使用除法和模数来推进和提取数字，例如：

```
long long number = 9999999999;
for (int digitPos = 0; digitPos < 16; digitPos++) {
  int thisDigit = number % 10;
  number = number / 10; 
} 
```

至于对你的课程的适用性，我不能保证:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T16:59:14.923

使用模数和整数除法。

一个数字的右起第一个数字（最小的数字）是`number % 10`。
第二个是`(number/10) % 10`。第三个是`(number/100) % 10`。简单的模式——你可以把它写成一个函数。*（只是避免在这里混合浮动。）*

如果您想遍历一个数字的位数，您可能需要检查一个数字有多少位（请参阅：以 10 为底的对数） - 最简单的方法是重复将该数字除以 10 直到它为 0。

* * *

无论如何，**请记住信用卡号码很长！**一个无符号的 64 位数字可以包含 19 个有效数字（最大为 2**64-1），因此对于信用卡来说就足够了，但对于银行账户来说就不行了。使用字符串（某种形式）的方法将更通用。

# c# - 自定义 XamGrid 列数据绑定图像/按钮/工具提示

> ID：13728247
> 
> 赞同：1
> 
> 时间：2012-12-05T16:50:19.457
> 
> 标签：c#, silverlight, data-binding, datagrid, infragistics

嗨，我正在尝试在我的应用程序中使用 Infragistics 控件，尤其是 XamGrid。我选择了一堆参数，网格带回了结果。我曾经在常规 Silverlight DataGrid 中拥有此功能。但是我想利用 XamGrid 的 groupby 列功能。在从 DataGrid 转换为 XamGrid 时，我必须对绑定和所有这些进行一些更改，但我得到了它的编译。

但是，在加载的中途，会弹出一个错误，并显示 XamlParseException '向'Infragistics.Controls.Grids.ColumnBaseCollection' 类型的集合添加值引发异常。[Line: 238 Position: 40]' 在我的代码隐藏 InitializeComponent();

Xaml 上的第 238 行指向我的 xamgrid，如下所示

```
<ig:XamGrid Name="gridResults" AutoGenerateColumns="False" VerticalAlignment="Top" VerticalContentAlignment="Top" Height="Auto" Margin="0" Width="765" IsAlternateRowsEnabled="false"  >
            <ig:XamGrid.SelectionSettings>
                <ig:SelectionSettings CellClickAction="SelectRow" CellSelection="None" />
            </ig:XamGrid.SelectionSettings>
            <ig:XamGrid.Columns>
                <ig:TextColumn x:Name="pieceTypeColumn" Key="PieceType" HeaderText="Type" Width="SizeToHeader"  />
                <ig:TextColumn x:Name="pieceNumberColumn" Key="PieceNumber" HeaderText="Piece Num" Width="SizeToHeader"  />
                <ig:TextColumn x:Name="jobNumberColumn" Key="JobNumber" HeaderText="Job Num" Width="SizeToHeader" />
                <ig:TextColumn x:Name="businessNameColumn" Key="BusinessName" HeaderText="Business Name" Width="256" />
                <ig:TextColumn x:Name="marketColumn" Key="Market" HeaderText="Market" Width="SizeToHeader" />
                <ig:TextColumn x:Name="openDateColumn" Key="OpenDate" FormatString="\{0:d\}" Width="SizeToHeader" />
                <ig:TemplateColumn x:Name="imageColPdf" HeaderText="PDF" Width="SizeToHeader"  >
                    <ig:TemplateColumn.ItemTemplate>
                        <DataTemplate>
                            <HyperlinkButton HorizontalAlignment="Center" VerticalAlignment="Center" x:Name="imageHLpdf" Click="HyperlinkButtonPDF_Click" Visibility="{Binding PDF, Converter={StaticResource marketConverter}}" IsEnabled="{Binding Path=PDF}">
                                <ToolTipService.ToolTip>
                                    <ToolTip>
                                        <ToolTip.Content>
                                            <Image Source="{Binding Path=ttImagePathPDF}" Stretch="UniformToFill" />
                                        </ToolTip.Content>
                                    </ToolTip>
                                </ToolTipService.ToolTip>
                                <Image Source="/PrintOnDemand;component/Images/16x16/page_white_acrobat.png" Stretch="None"   HorizontalAlignment="Center" ></Image>
                            </HyperlinkButton>
                        </DataTemplate>
                    </ig:TemplateColumn.ItemTemplate>
                </ig:TemplateColumn><---------ERROR: Line 238----------->
            </ig:XamGrid.Columns>
       </ig:XamGrid> 
```

如您所见，我需要在显示图像图标的列中有一个超链接按钮，并有一个数据绑定工具提示，它显示缩略图预览。

我的问题是我是否正确转换了所有内容，以及 XamGrid 中有哪些选项来获得我想要的显示图像工具提示的超链接按钮的效果。

# jenkins - 更改 Hudson 通知电子邮件的 [email from]

> ID：13728250
> 
> 赞同：3
> 
> 时间：2012-12-05T16:50:31.980
> 
> 标签：jenkins, hudson

目前，Hudson 将以 Hudson 管理员的身份从电子邮件地址设置中发送失败构建的电子邮件等。管理员电子邮件地址是否用于其他用途，例如来自 Hudson 的错误消息或任何其他用途？我想将地址更改为其他地址，以免人们认为我正在向他们发送构建失败消息。

或者，有没有办法我可以在哈德森设置两封不同的电子邮件，一个用于管理员，一个用于发送电子邮件通知。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T16:11:56.053

我不知道有任何专门发送给 Hudson 系统管理员的电子邮件。它主要用于通知电子邮件。

去

*   **管理哈德逊**
*   **配置系统**
*   向下滚动到**电子邮件通知**
*   **将系统管理员电子邮件地址**更改为您想要的任何内容

如果您使用的是[Email-ext 插件](https://wiki.jenkins-ci.org/display/JENKINS/Email-ext+plugin)，您还可以更改默认`Reply To List`电子邮件地址。

理想情况下，您的**系统管理员**地址类似于`hudson@company.com`（不必是真实地址），而**回复**地址应该是您的实际电子邮件地址，以便用户可以联系到您。

# vb.net - 在不显式打开连接的情况下连接到数据库

> ID：13728255
> 
> 赞同：1
> 
> 时间：2012-12-05T16:50:44.420
> 
> 标签：vb.net, ado.net

我正在帮助一个还在上大学的朋友做她的商业作业。该课程教授 VB.NET 和 ADO.NET（当然真的很差）。我仅通过我在工作中支持的遗留应用程序对 ADO.NET 有过短暂的体验。

她试图实现的页面非常简单：一个带有 for 输入的表单`username`和`password`一个`submit`按钮。存在一些功能问题，但在查看代码时，我发现了一些奇怪的东西。这是她在页面顶部用来设置连接的代码

```
Public Shared Con As New SqlConnection("Data Source = asdfa; Initial Catalog= asdf; Persist Security Info = True; User ID= dfasdf; Password = asdf")
Public Shared strSQLStatement As String
Public Shared strSQLStatementCmd As String
Public Shared daActivity As New SqlDataAdapter(strSQLStatement, Con)
Public Shared dsActivity As New DataSet 
```

`con.open()`正如我所预料的那样，我没有看到任何声音。据我所知，ADO.NET 最初需要这样的命令来建立连接。我就此向她提问，她提到她从未使用`open()`命令在她的任何其他作业中建立连接，而这一切都归功于她。这段代码中有什么东西可以自动为我打开连接吗？

也许我对 ADO.NET 的理解是这样解释的。如果我错了，请纠正我，但该语言纯粹用于连接数据库，并且以这种方式完成

```
Set up connection string
Open connection
Create sql strings, such as command = "select * from table1"
Tell the open connection to run that sql
Close Connection 
```

这看起来对吗？帮我帮她。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T16:54:30.820

`SqlDataAdapter`将自动为您打开和关闭连接。

> Fill 方法使用关联的 SelectCommand 属性指定的 SELECT 语句从数据源中检索行。与 SELECT 语句关联的连接对象必须是有效的， **但它不需要是 open**。如果在调用 Fill 之前关闭连接，则打开它以检索数据，然后关闭。如果在调用 Fill 之前连接已打开，则它保持打开状态。

[http://msdn.microsoft.com/en-us/library/905keexk.aspx](http://msdn.microsoft.com/en-us/library/905keexk.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T11:12:50.707

将 MovingDA 调暗为新 OleDbDataAdapter(sqlbyworknum, myConnection) MovingDA.Fill(MovingDT)

只是你在 declraing DA 中使用 new 并传递 sql 并且你连接它将被打开并运行

# android - TabActivity 到 FragmentActivity

> ID：13728261
> 
> 赞同：0
> 
> 时间：2012-12-05T16:51:07.813
> 
> 标签：android, android-tabhost, tabactivity, android-fragmentactivity

我一直在寻找答案，但在哪里找不到。看来这真的很新。谷歌表示 TabActivity 已被弃用，应该使用 FragmentActivity。

以前我有所有要在 tabHost 中切换的活动。

现在如果我想切换到 FragmentActivity

1.  我是否必须将所有扩展 Activity 类更改为扩展 Fragment 类（或者确切的类名是什么）？
2.  我可以只使用我的 Activity 类在 TabHost 而不是 .. Fragment 中切换吗？
3.  有什么好的，简单直接的教程吗？

现在已经很晚了，我敢肯定我还有更多问题.. 一直在想一整天。我想知道为什么 Google 让开发人员的生活变得更加艰难？看看 iOS 选项卡是如何轻松实现的。现在我开始明白为什么所有的应用程序都首先出现在 iOS 而不是 Android 上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T17:12:57.610

1.  是的，你必须让你的所有活动来扩展 Fragment 或 FragmentActivity。
2.  是的，您可以将所有活动保留在 TabHost 中。
3.  谷歌有一个关于如何使用片段的片段演示应用程序。

# php - Magento 看不到产品主图看占位符

> ID：13728262
> 
> 赞同：0
> 
> 时间：2012-12-05T16:51:08.277
> 
> 标签：php, mysql, magento, product

我将很多产品上传到我的商店，但我遇到了一些问题。我想知道：

1.  是否有任何选项可以使用 MySQL 查询或 PHP 所有没有使用占位符的主图像的产品进行 SPOT？

2.  如果我找到产品并且我知道有图像但未设置为默认值，我可以使用 MySQL 查询设置图像吗？

这不是托管问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T21:30:52.453

查找所有未分配基本图像的产品...

```
$products = Mage::getModel('catalog/product')->getCollection()
    ->addAttributeToFilter('image', 'no_selection')
; 
```

关于您的第二点，将图像分配给产品，您如何执行此操作将取决于您自己的具体情况，但一些示例代码可以帮助您入门：

```
$fileSource = Mage::getBaseDir('media') . '/path/to/your/image.jpg';
$product->addImageToMediaGallery($fileSource, 'image', false); 
```

要运行上述代码，您必须先[引导 Magento](http://www.ecomdev.org/2010/06/01/application-bootstrap-in-magento.html)：

```
<?php

require_once 'app/Mage.php';
if (! Mage::isInstalled()) {
    die('Magento is not installed.');
}
Mage::app('admin', 'store'); 
```

# python - wx.StaticBox 标签的对齐方式

> ID：13728264
> 
> 赞同：4
> 
> 时间：2012-12-05T16:51:14.827
> 
> 标签：python, wxpython

我正在使用 wx 库在 python 中编写程序。我找不到以下问题的答案：

是否可以更改 wx.StaticBox 的标签对齐方式（从左到中）？

也就是说，鉴于我有这个：

```
ASysBox = wx.StaticBox(self, label='System A') 
```

我需要对齐中心“系统 A”标题

感谢您的时间和考虑。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-06T22:56:22.823

您可以尝试将对齐标志传递给样式参数，但我无法让它在 Windows 上工作。它可能取决于操作系统，也可能只是不受支持。您最好使用 wx.DC 或类似工具自己绘制它。wxPython 演示中有绘图示例，您可以开始使用。

# php - php $_GET - 澄清

> ID：13728265
> 
> 赞同：0
> 
> 时间：2012-12-05T16:51:18.117
> 
> 标签：php, conditional-statements

所以我有一个表单，当用户按下提交时，表单会将它们扔到处理文件中，如果这些字段值中的任何一个没有验证，那么该处理表单会将用户发送回他们来自的页面。我认为添加一条消息告诉他们出了什么问题很有用......

例如表单页面（contact.php）是这样构造的（下）

```
<?php 
$errormssg = stripslashes(str_replace("'","",$_GET['errormssg']));
if($errormssg){
    echo $errormssg;    
} 
?>
<html>
<form fields here >
</html> 
```

并且php进程形式或多或少是这样构造的（下）

```
<?php 

<form validation code goes here and if it fails, then throws them back to form page exactly 
like this (below)

header("Location:contact.php?errormssg='You seem to have forgotten one of the fields'");

?> 
```

我遇到的问题是，当我第一次加载联系页面时，我收到一个错误，我假设这是因为第一次加载联系页面时，`$_GET['errormssg']`不存在。

我试过像

```
if($_GET['errormssg']){
    echo $errormssg;
} 
```

仍然有错误，我是否以错误的方式解决这个问题？

我基本上想做的是，当联系页面加载时，错误消息吐出消息的唯一方法是用户是否从处理表单中被送回。因此，如果消息存在，则在指定区域回显，否则不显示任何内容。

我怎样才能做到这一点？？先谢谢了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-05T16:53:13.160

您需要先检查该值是否已定义：

```
if (isset($_GET) && isset($_GET['errormssg'])) {
    echo $_GET['errormssg'];
} 
```

编辑：根据 MrCode $_GET 现在总是被定义。不是在我学习 PHP 的时候，从那以后就再也没有失去这个习惯，很抱歉造成混乱。你不需要 if 的第一部分

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-05T16:52:44.883

尝试：

`if(isset($_GET['errormssg']))`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-05T16:53:40.027

if(isset($_GET['errormssg'])){

这应该工作:)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-05T16:54:00.530

尝试类似：

```
if(isset($_GET['errormsg']) {
   echo $_GET['errormsg'];
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-05T17:00:48.147

正如其他答案所说，您需要在尝试使用之前检查变量是否已设置。`Undefined index`如果您尝试访问未设置的数组元素，PHP 会自动发出通知。

您的错误消息系统有更好的解决方案。缺点是用户基本上可以通过使用查询字符串来修改页面上的直接内容。第一个问题是它容易受到 XSS 的攻击，因此您应该传递消息`htmlspecialchars()`或`htmlentities()`阻止它。即使没有 XSS，用户仍然可以在您的页面上设置不受欢迎的内容。

最简单的解决方案是在 URL 中使用错误代码而不是整个消息。在您的 PHP 中，您可以将错误代码映射到消息。这样做的好处是，用户不能篡改消息内容，但他们仍然可以更改代码以产生不同的消息。

更好的解决方案是使用基于会话的消息队列系统。这可以通过将消息数组存储为会话变量来实现。当您需要显示一条消息时，您只需添加到数组中即可。在您的前端，您可以遍历会话数组中的消息并输出它们，然后（重要的是）清除数组。

这会更好，因为它与用户完全隔离，并且可以在系统或站点范围内工作，而不仅仅是您的联系表格。下面是一个简单的例子。

```
// add a message if validation fails
MesssageManager::addMessage('You seem to have forgotten one of the fields'); 
```

在前端输出无序列表中的消息并清除它们：

```
<html>

<?php echo MessageManager::getHTML(); MessageManager::clear(); ?>

</html> 
```

这个类可能看起来像

```
session_start();
class MessageManager
{
    public static function addMessage($message)
    {
        if(isset($_SESSION['messages']))
        {
            $_SESSION['messages'][] = $message;
        }
        else
        {
            $_SESSION['messages'] = array($message);
        }
    }

    public static function clear()
    {
        $_SESSION['messages'] = array();
    }

    public static function getHTML()
    {
        $h  = '<ul>';
        foreach($_SESSION['messages'] as $message)
        {
            $h .= '<li>' . htmlentities($message) . '<li>';
        }
        $h .= '</ul>';

        return $h;
    }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-12-05T17:04:53.237

首先，我想解决最初的问题。因为已经有了显而易见的答案`isset()`.. 我想指出 1) 你不需要检查是否存在`$_GET`先验，这只是浪费的代码。因此，例如：

```
if(isset($_GET['errormsg']) {
  echo $_GET['errormsg'];
} 
```

确实是正确的用法。我还想指出，您将在**任何时候**使用PHP 通知和警告，`$_GET['foo']`而无需先对其进行初始化。因此，例如，这**将**产生一个通知：（注意：在下面的示例中，我将“errormssg”更改为“errormsg”，注意删除了双“s”）

```
$errormsg = stripslashes(str_replace("'","",$_GET['errormsg']));
if(isset($errormsg)) {
  echo $errmsg;
} 
```

事实上，该代码是非常多余的，因为除非代码更改，否则`$errmsg`将始终设置。要正确使用它，您可能想说：

```
if(isset($_GET['errormsg'])) { 
   $errormsg = stripslashes(str_replace("'","",$_GET['errormsg']));
   echo $errormsg;
} 
```

我还想指出`!empty()`as well 的用法。 `!empty()`与`isset()`以下示例不同：

```
$x = '';
if(isset($x)) { echo 'This will fire, since $x *is* set, just empty'; }
if(!empty($x)) { echo 'This will not fire, even though $x is set, it is empty'; } 
```

尽管对于您的示例，它很可能只会产生不明显的差异。

其次，虽然与原始问题没有直接关系，但我想指出您对`header()`and URLs 的使用是非常不正确的：

```
header("Location:contact.php?errormssg='You seem to have forgotten one of the fields'"); 
```

这都是错误的。你**应该**改用这样的东西：

header("位置：contact.php?errormsg=" . urlencode("您似乎忘记了其中一个字段"));

请注意 Location: 和 URL 之间的空格。从技术上讲，这**仍然**是不正确的，但会起作用。100% 正确的方法（根据 RFC）是在标头中包含**完整**的URL，例如：

```
header("Location: http://www.yoursite.com/contact.php?errormsg=" . 
  urlencode("You seem to have forgotten one of the fields")); 
```

`stripslashes()`如果您正确地对数据进行 URL 转义/编码，则不需要您的。

# css - 如何使用 CSS 隐藏评论列表中的最后一个分隔符？

> ID：13728270
> 
> 赞同：3
> 
> 时间：2012-12-05T16:51:37.307
> 
> 标签：css, ruby-on-rails-3, html, divider

我想使用 css 隐藏评论之间的最后一个分隔符。代码如下。

```
<div id="question_comments" class="comments_container">
  <div class="comment">
    <div class="comment_details">
      <div>
        <p>Comment1</p>
      </div>
    </div>
  </div>
  <div class="hr-comment"></div>
  <div class="comment">
    <div class="comment_details">
      <div>
        <p>Comment2</p>
      </div>
    </div>
  </div>
  <div class="hr-comment"></div>
  <div id="question_comment">
    <form> ... </form>
  </div>
  <div class="clear"></div>
</div> 
```

我在 Rails 视图中生成它：

```
<div id="question_comments" class="comments_container">
  <% @question.comments.order("created_at ASC").each do |comment| %>
    <%= render :partial => "questions/comment", :locals => { :comment => comment } %>
    <div class="hr-comment"></div>
  <% end %>
  <%= render :partial => 'new_comment', :locals => {:targit => @question, :answer => nil} %>
  <div class="clear"></div>
</div> 
```

我试过了：

```
div.hr-comment {
  background:url(hr-background.gif) repeat-x;width:100%;height:2px;margin-top:7px;margin-bottom:7px;width:310px;
}

.hr-comment:last-child { 
    display: none 
} 
```

目标是如何在不使用 ruby​​ 的情况下做到这一点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-05T16:59:31.217

:last-child 伪类仍然不能可靠地跨浏览器使用。特别是，Internet Explorer 版本 < 9 和 Safari < 3.2 肯定不支持它，尽管 Internet Explorer 7 和 Safari 3.2 确实支持 :first-child，奇怪的是。

您最好的选择是显式地向该项目添加一个 last-child （或类似）类，并改为应用 div.last-child 。

或者你可以使用一些Javascript。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-05T17:57:44.300

通常不赞成为了样式目的而添加额外的标记，例如空 div。

```
.comment + .comment:before {
    border-top:1px solid;
    max-width: 300px;
    margin: 0 auto;
    content: " ";
    display: block;
} 
```

[http://jsfiddle.net/pVcrV/1/](http://jsfiddle.net/pVcrV/1/)

在较旧的浏览器中，相邻选择器的支持比伪类`:last-child`（IE8 中不可用）或`:last-of-type`. 伪类有相当不错的`:before`支持（IE7 不可用）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-05T17:11:31.867

重新考虑设计，隐藏受支持的`:first-child`伪...并清除 div-itus 怎么样？

```
.comment { border-top:1px solid red }
.comment:first-child { border:none; }​

<div id="question_comments" class="comments_container">
  <div class="comment">
      <p>Comment1</p>
  </div>
  <div class="comment">
      <p>Comment2</p>
  </div>
</div>​ 
```

我意识到您可能只是将其`hr...`用作一个愚蠢的类，但我冒昧地将它用作一个`<hr>`元素（顺便说一句，它比`<div>`行为/工作相同的 a 更好）

[http://jsfiddle.net/pVcrV/](http://jsfiddle.net/pVcrV/)

**编辑：（放回一个容器）**

```
<div id="question_comments" class="comments_container">
  <hr>
  <div class="comment">
      <p>Comment1</p>
  </div>
  <hr>
  <div class="comment">
  ...
</div>​ 
```

[http://jsfiddle.net/VJVxt/](http://jsfiddle.net/VJVxt/)

我有点假设您正在从数据库中提取这些评论，并让服务器端语言即时吐出 HTML。用分隔符开始那个转储（然后用`:first-child`它来隐藏它）不是 100% 语义的；然而，一个元素与一个 JavaScript 或一个 CSS hack 似乎不仅仅是一个公平的权衡。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-05T16:54:42.267

```
#question_comments .hr-comment:last-child {display:none;} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-05T17:01:00.143

做这个：

```
#question_comments > .hr-comment:last-child {
  display: none;
} 
```

# r - 从 grid.arrange 中删除边框

> ID：13728272
> 
> 赞同：3
> 
> 时间：2012-12-05T16:51:51.893
> 
> 标签：r, ggplot2, gridextra

我正在使用 gridExtra 包 grid.arrange 函数组合多个 ggplot 图。

我这样做：

```
p1<-ggplot(x, aes(Date, Value)) + geom_line()
p2<-ggplot(y, aes(Date, Score)) + geom_point()
grid.arrange(p1, p2,  main=textGrob("Head Line", gp=gpar(cex=1.5, fontface="bold", col="#990000")), ncol = 1, clip=TRUE) 
```

此命令在 p1 和 p2 之间设置边界。我在 grid.arrange 中找不到有关删除边框的任何信息。可以去掉边框吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-05T21:54:42.260

`gridExtra`没有在地块之间放置任何额外的边界。您所看到的只是已经围绕每个地块的边界。即p1底部有边框，p2顶部有边框。将两者放在一起，看起来两者之间可能有额外的空间。

要删除或调整每个绘图的边界，请使用函数`plot.margin`中的元素`theme`。下面删除 p1 的下边距和 p2 的上边距。

```
library(ggplot2)
library(gridExtra)

p1<-ggplot(data.frame(x = 1:10, y = 1:10), aes(x, y)) + geom_line() +
      theme(plot.margin = unit(c(1,1,0,1), "lines"))

p2<-ggplot(data.frame(x = 1:10, y = 1:10), aes(x, y)) + geom_point() +
   theme(plot.margin = unit(c(0,1,1,1), "lines"))

grid.arrange(p1, p2,  top=textGrob("Head Line", 
     gp=gpar(cex=1.5, fontface="bold", col="#990000")), ncol = 1, clip=TRUE) 
```

![在此处输入图像描述](../Images/2aef5707b125249dc34926c8e1c08ee3.png)

**编辑**（16/07/2015）：`gridExtra`>= 2.0.0，`main`参数已重命名`top`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-08-24T17:34:50.830

有点晚了，但我遇到了同样的问题，我想我已经找到了解决方案。plot.margin 没有帮助，但是将 panel.border 和 plot.background （参数颜色和填充）调整为绘图的背景颜色就可以了。

# excel - Vlookup / 匹配不同工作表上的最大最小值

> ID：13728273
> 
> 赞同：-1
> 
> 时间：2012-12-05T16:52:09.540
> 
> 标签：excel, match, vlookup

我有 2 个工作表，一个带有公司数据，另一个带有最小最大值和答案列。

我需要做的是找出公司数据中 D 列中的值是否介于工作表 2 输出答案中工作表 2 中的最小值/最大值之间。

请有人帮忙。这显然是一个 vlookup 问题，但我不知道如何做最小值/最大值。

任何帮助将不胜感激。

工作表 1

```
NAME                    TYPE    NUMBEROFEMPLOYEES   Output
Wetland Plants Ltd      Client  4   
Capital Management LLP  Clients 3   
College ltd             Clients 156 
```

工作表 2

```
max         min     output
100000000   60000   big
59999       15000   medium
14999       0       small 
```

干杯伙计们

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T18:48:41.417

正如 TheGreatCO 所说，您需要重新排列表格以使 VLOOKUP（或 LOOKUP）工作，但如果您希望表格保持原样，请在 sheet1 E2 中尝试此公式

`=INDEX(Sheet2!C$2:C$4,MATCH(D2,Sheet2!A$2:A$4,-1))`

假设 D2 包含员工人数，并且 sheet2 表位于 A2:C4 中（A2:A4 中的最大值，B2:B4 中的最小值和 C2:C4 中的输出）

您可以将公式复制到列中......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T17:07:28.497

只有当关键数据列（包含您正在查找的数据的列）按字母数字升序排列时，您才能执行 VLOOKUP，例如。从 0 到 9，a 到 z。在这种情况下，您的工作表 2 应该是（从上到下）14999 -> 0、59999 -> 15000、100000000 -> 60000。

# linq-to-sql - Sql 生成/变更跟踪逻辑

> ID：13728277
> 
> 赞同：0
> 
> 时间：2012-12-05T16:52:13.030
> 
> 标签：linq-to-sql

我要疯了。我是 linq to sql 的新手，还没有完全掌握 linq 的更改跟踪概念。我有一种情况，我必须在单个 DataContext 中执行大量 db 内容。我注意到很多奇怪的东西，比如：

```
//Control flows to this statement, but I dont see
//corresponding sql generated in the log.
//However if I instead change it to db.ExecuteCommand("delete from mytable")
//that shows up fine in the log

db.mytable.deleteAllOnSubmit(db.mytable); 
```

这只是故事的一部分。但我想知道是否会出现不生成正确 sql 的情况？一种可能是，我试图从表中删除所有行，但后来，我尝试再次插入完全相同的行，linq 以某种方式检测到这个被忽略的删除重新插入以避免不必要的工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T18:44:37.547

> 那么不建议使用 ExecuteCommand 将 linq 与普通 sql 语句混合使用吗？

如果您打算依赖更改跟踪机制，则绝对不会。您的数据上下文将变得“陈旧”。

**更新** 如果您坚持使用“纯”L2S，所有插入/更新/删除都将转换为正确的 SQL。只要您使用一个 SubmitChanges 来完成它，它也将在一个事务中完成。所以它毕竟不是那么糟糕。您不能将它与 ExecuteCommand 混合使用，因为 L2S 不可能在不扫描整个数据库的情况下跟踪由存储过程引起的更改……这不是您想要的。

基本规则：为每个“工作单元”创建一个 DC，并且只为其执行一次 SubmitChanges。有了这个，你会很好地使用 L2s

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T17:02:53.470

您必须记住，诸如此类的操作`deleteAllOnSubmit`不会转换为 SQL 并在现场执行。

**ITable.DeleteAllOnSubmit 方法：** 将集合中的所有实体置于挂起删除状态。

请参阅：http: [//msdn.microsoft.com/en-us/library/system.data.linq.itable.deleteallonsubmit.aspx](http://msdn.microsoft.com/en-us/library/system.data.linq.itable.deleteallonsubmit.aspx)

在您执行以下操作之前，不会发生删除：

```
 db.SubmitChanges(); 
```

* * *

**更新1：**

如果您的表为空，则不会出现删除语句。此外，`SubmitChanges`它的规范允许在您的特定场景中尝试变得聪明，尽管如果您有触发器，您认为会被执行，您会感到失望。如果您有删除/插入触发器，您可能需要考虑在 LINQ“删除”之后使用 SubmitChanges。

**DataContext.SubmitChanges 方法：** 计算要插入、更新或删除的修改对象集，并执行适当的命令来实现对数据库的更改。

[http://msdn.microsoft.com/en-us/library/system.data.linq.datacontext.submitchanges.aspx](http://msdn.microsoft.com/en-us/library/system.data.linq.datacontext.submitchanges.aspx)

**注意：**此更新是在 OP 检查并验证调用时表为空之后进行的`SubmitChanges()`。稍后，OP 检查并验证当从表中删除数据只是用相同的数据替换时也会发生这种情况。

* * *

**更新 2：**

@Brian 很高兴听到您在这方面取得了进展:-)

**一般建议：**

1.  *除非您知道*自己在做什么，否则避免将 ExecuteCommand 与 L2S 混合使用；`ExecuteCommand`的可能会改变 L2S 脚下的数据库状态并让您（*当之无愧！*）头疼！如果您不害怕这样的头痛，您可以尝试`ExecuteCommand`在 L2S 访问表之前删除行（更快，但您需要正确处理）。如果您害怕这样的头痛并且只想在 SQL 服务器上触发“删除”事件，只需`SubmitChanges`在问题代码中的 L2S“删除”之后执行一个操作。
2.  您可以依靠 与数据库进行细粒度的 L2S 交互`SubmitChanges`，但从长远来看，最好意识到您获得了一个以全新方式与数据库交互的工具。L2S 试图变得聪明，这还不错。使用它为您带来优势！在这种特殊情况下，它为您节省了一些不必要的删除/插入操作，实际上优化了您的代码，而您无需做任何事情。试图变得那么聪明有错吗？是的，如果您单独考虑操作，如果您认为它试图做的只是使用代码操作的净效果更新数据库，则不。

# php - 删除应用程序请求时发生错误

> ID：13728279
> 
> 赞同：1
> 
> 时间：2012-12-05T16:52:21.517
> 
> 标签：php, facebook, facebook-graph-api, facebook-requests

我们最近推出了一个应用程序，用户可以在其中邀请朋友参加比赛。因为我们是尽职尽责的软件工程师，所以我们希望在用户接受请求后立即删除应用请求。

下面的代码在多个项目中工作，但现在失败并出现错误。

代码（requestId = 没有“_userId”的简单 id）：

```
$this->facebook->api($requestId, "DELETE", array("access_token" => $this->App["fb_app_access_token"])); 
```

错误：

```
{
  "error": {
    "message": "(#100) Requires valid app request IDs", 
    "type": "OAuthException", 
    "code": 100
  }
} 
```

我们没有将 user_id 附加到 request_id，因为用户还没有对应用程序进行身份验证，所以我们根本不知道 id。

有人遇到过上述问题或找到解决此问题的方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-05T17:23:13.710

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T22:52:15.140

每个请求 ID 代表一次仅对一个用户的唯一请求

要删除应用请求，您可以先查询 request_id，然后再发出删除请求。

您可以查询 request_id 的图形 api 它是否真的存在并且没有被删除，然后您可以尝试在 request_id 上执行 DELETE 请求

```
https://graph.facebook.com/[REQUEST_ID]?access_token=APP_ACCESS_TOKEN 
```

有关请求的更多信息，请参阅[Facebook 应用请求概述](https://developers.facebook.com/docs/requests/)

# jms - MDB 订阅 Apache Tomee 中的远程 jms 主题

> ID：13728282
> 
> 赞同：3
> 
> 时间：2012-12-05T16:52:28.693
> 
> 标签：jms, apache-tomee

我第一次尝试 Apache Tomee (1.5 plus)，我现在完全被困住了。

我工作的公司有一个应用程序（使用 JBoss 和 HornetQ）向 JMS 主题 topic/theTopicsName 发送消息。

我正在尝试使用订阅所述主题的 Tomee/ActiveMQ 实现另一项服务，通常从另一台计算机处理 MDB 中的消息，但除了 localhost 之外，我无法让它监听。

如果我理解正确，应该可以添加类似

```
<Resource id="MyJmsResourceAdapter" type="ActiveMQResourceAdapter">
    BrokerXmlConfig =
    ServerUrl       =  tcp://thehostname:5455
</Resource>

<Resource id="MyJmsConnectionFactory" type="javax.jms.ConnectionFactory">
    ResourceAdapter = MyJmsResourceAdapter
</Resource> 
```

在我的 /conf/tomee.xml

问题是如何让我的 MDB 使用上述设置？是否可以通过注释或ejb-jar.xml？

假设我有一个简单的 MDB

```
public class MessageListenerMDB implements MessageListener {

    private ConnectionFactory connectionFactory;

    public MessageListenerMDB() {}

    public void onMessage(Message message) {
        //print message
    }
} 
```

我的 */WEB_INF/ejb-jar.xml 看起来像

```
<ejb-jar xmlns="http://java.sun.com/xml/ns/javaee" metadata-complete="true">
  <enterprise-beans>
    <message-driven>
      <ejb-name>MessageListenerMDB</ejb-name>
      <ejb-class>my.package.jms.MessageListenerMDB</ejb-class>
      <messaging-type>javax.jms.MessageListener</messaging-type>
      <activation-config>
        <activation-config-property>
          <activation-config-property-name>
            destinationType
          </activation-config-property-name>
          <activation-config-property-value>
            javax.jms.Topic
          </activation-config-property-value>
        </activation-config-property>
        <activation-config-property>
          <activation-config-property-name>
            destination
          </activation-config-property-name>
          <activation-config-property-value>
            /topic/theTopicsName
          </activation-config-property-value>
        </activation-config-property>
      </activation-config>

      <resource-ref>
        <res-ref-name>
          java:comp/env/my.package.jms.MessageListenerMDB/connectionFactory
        </res-ref-name>
        <res-type>javax.jms.ConnectionFactory</res-type>
        <injection-target>
          <injection-target-class>
            my.package.jms.MessageListenerMDB
          </injection-target-class>
        <injection-target-name>connectionFactory</injection-target-name>
      </injection-target>
    </resource-ref>

    </message-driven>
  </enterprise-beans>
</ejb-jar> 
```

我需要做什么才能使用上面的 ConnectionFactory？我从一开始就完全错了吗？

友好的问候/马格努斯

# asp.net - PageMethods.set_path 在 urlrewriting 中不起作用

> ID：13728283
> 
> 赞同：-1
> 
> 时间：2012-12-05T16:52:29.750
> 
> 标签：asp.net, url-rewriting, webmethod, pagemethods

我有一个通过 Javascript 函数调用单个 PageMethod 的测试 Web 应用程序。

```
PageMethods.myMethod(params, onSuccess, onFailed); 
```

当我使用 urlRewriting 它不再工作了。所以，我搜索了网页，发现这个要添加到 js 文件中。

```
Pagemethods.set_path("/the_real_path.aspx"); 
```

但是，这不起作用。当我使用 F12 查看 chrome 中的 Web 开发人员工具时，它给出了 404 not found 错误。

你有什么建议可以给吗？任何帮助将不胜感激

下面就做好了。

```
-ScriptManager EnablePageMethods = True
-Method is public and shared(static)
-Method is decorated with <WebMethod(True)> 
```

* * *

## 回答 #1

> 赞同：-3
> 
> 时间：2012-12-06T15:40:26.917

无论如何，我找到了另一种调用`WebMethod`. 我使用了网络服务。我不需要使用 PageMethods。

# php - PHP 监控服务器统计信息

> ID：13728286
> 
> 赞同：0
> 
> 时间：2012-12-05T16:52:30.660
> 
> 标签：php, monitoring, health-monitoring, network-monitoring

PHP有没有办法获取有关外部服务器的统计信息，例如：

*   下载/上传速度
*   正常运行时间
*   在线/离线

如果不使用 PHP 任何其他网络语言？

我想要一个具有登录身份验证的子域 servers.domain.com，它将列出所有服务器（大约 10 个）并显示上面的统计信息。它们并不都在同一个网络上，大约有 3 个。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T16:55:49.157

听起来您需要像 Nagios 这样的监控包，或者像 Cacti 这样的统计跟踪工具，或者两者兼而有之。

# facebook - R 为标题、评论数量和“喜欢”抓取博客

> ID：13728289
> 
> 赞同：2
> 
> 时间：2012-12-05T16:52:34.810
> 
> 标签：facebook, r, curl, web-scraping

我正在尝试使用 R 从一些博客中获取一些信息。我想获取的数据是：

```
1) Date posted
2) Blog Post Title
3) Number of Comments
4) Number of Facebook likes. 
```

[此处](http://www.jamesaltucher.com/)的此博客包含我要收集的所有字段。

理想情况下，我想要一个如下所示的数据框：

```
Post_Date      CommentCount       FB_Likes   Title
2012-12-05          1                 629      The James and Claudia Kripalu Workshop– The Daily Practice: Finding Success From Within
  ...              ...                ...          ... 
```

有没有办法在 R 中做到这一点？这似乎是可行的，`RCurl`但我不太熟悉`html/xml/js/etc`。

到目前为止，这就是我所拥有的：

```
library(RCurl)
library(XML)
xmlTreeParse(getURI("http://www.jamesaltucher.com")) 
```

当我运行它时，我得到左括号和右括号不匹配的错误。

注意：这些不是我的博客，所以我没有对博客或他们的 FB 帐户的管理员访问权限。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T18:48:16.750

很难得到 facebook 的喜欢。我很想看到一个解决方案。我用 gsub 处理日期以获得漂亮的格式。

```
library(XML)
library(RCurl)
url.link <- 'http://www.jamesaltucher.com/'
blog <- getURL(url.link)
blog          <- htmlParse(blog, encoding = "UTF-8")
titles  <- xpathSApply (blog ,"//*[@class='article']/h2/a",xmlValue)             ## titles
dates   <- xpathSApply (blog ,"//*[@class='article']/h2/span/text()",
             function(x) {
                 y <- gsub('.*on(.*)Post.*','\\1',xmlValue(x))
               }
             )
dates <- dates[dates != 'Posted by '] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T18:38:32.030

首先，您需要解析`Html`not `Xml`so use`htmlParse`这将尝试处理格式错误的 html。一些 xpath 的示例如下

```
library(RCurl)
library(XML)
blogdata<-htmlParse(getURI("http://www.jamesaltucher.com"))
postDetail<-xpathSApply(blogdata,'/*//span[@class=\"details\"]',xmlValue)
title<-xpathSApply(blogdata,'/*//h2/a',xmlValue) 
```

我认为获得 facebook 喜欢等会更难，因为页面似乎调用脚本来访问这些。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-05T17:50:36.847

我发现[XPath](https://en.wikipedia.org/wiki/XPath)很容易用于抓取 Web 内容。以下几篇文章可能对您有所帮助。

*   [使用 XPath 进行网页抓取示例](http://www.r-bloggers.com/web-scraping-yahoo-search-page-via-xpath/)
*   [XPath 指南](http://www.xquery.com/examples/xpath/)

希望这可以帮助。

# javascript - javascript中的时尚弹出窗口？

> ID：13728296
> 
> 赞同：4
> 
> 时间：2012-12-05T16:52:54.030
> 
> 标签：javascript, jquery

我们在javascript中得到的警告框/确认框是简单的弹出框。我需要修改盒子样式。意味着使文本加粗，并使这些弹出时尚。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-05T17:01:56.993

您不能修改由 alert() 和 confirm() 调用产生的消息框。您需要创建自己的自定义警报框。您可以使用类似 jQuery UI 对话框的内容：http: [//jqueryui.com/dialog](http://jqueryui.com/dialog)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-05T16:58:23.113

这对于传统的浏览弹出窗口是不可能的。您必须使用 javascript/modal 弹出窗口。

这是一个例子：

[http://jqueryui.com/dialog/#modal-confirmation](http://jqueryui.com/dialog/#modal-confirmation)

# regex - scala 正则表达式组匹配和替换

> ID：13728297
> 
> 赞同：23
> 
> 时间：2012-12-05T16:53:00.393
> 
> 标签：regex, scala, replace, regex-group

```
val REGEX_OPEN_CURLY_BRACE = """\{""".r
val REGEX_CLOSED_CURLY_BRACE = """\}""".r
val REGEX_INLINE_DOUBLE_QUOTES = """\\\"""".r
val REGEX_NEW_LINE = """\\\n""".r

// Replacing { with '{' and } with '}'
str = REGEX_OPEN_CURLY_BRACE.replaceAllIn(str, """'{'""")
str = REGEX_CLOSED_CURLY_BRACE.replaceAllIn(str, """'}'""")
// Escape \" with '\"' and \n with '\n'
str = REGEX_INLINE_DOUBLE_QUOTES.replaceAllIn(str, """'\"'""")
str = REGEX_NEW_LINE.replaceAllIn(str, """'\n'""") 
```

有没有更简单的方法来分组和替换所有这些`{,},\",\n`？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-12-05T17:46:13.343

您可以使用括号创建一个捕获组，并`$1`在替换字符串中引用该捕获组：

```
"""hello { \" world \" } \n""".replaceAll("""([{}]|\\["n])""", "'$1'")
// => java.lang.String = hello '{' '\"' world '\"' '}' '\n' 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-12-05T17:43:36.193

您可以像这样使用正则表达式组：

```
scala> """([abc])""".r.replaceAllIn("a b c d e", """'$1'""")
res12: String = 'a' 'b' 'c' d e 
```

正则表达式中的括号允许您匹配它们之间的字符之一。`$1`替换为正则表达式中括号之间的任何内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-07-31T06:45:05.667

考虑这是你的字符串：

```
var actualString = "Hi {  {  { string in curly brace }  }   } now quoted string :  \" this \" now next line \\\n second line text" 
```

解决方案 ：

```
var replacedString = Seq("\\{" -> "'{'", "\\}" -> "'}'", "\"" -> "'\"'", "\\\n" -> "'\\\n'").foldLeft(actualString) { _.replaceAll _ tupled (_) }

scala> var actualString = "Hi {  {  { string in curly brace }  }   } now quoted string :  \" this \" now next line \\\n second line text"
actualString: String =
Hi {  {  { string in curly brace }  }   } now quoted string :  " this " now next line \
 second line text

scala>      var replacedString = Seq("\\{" -> "'{'", "\\}" -> "'}'", "\"" -> "'\"'", "\\\n" -> "'\\\n'").foldLeft(actualString) { _.replaceAll _ tupled (_) }
replacedString: String =
Hi '{'  '{'  '{' string in curly brace '}'  '}'   '}' now quoted string :  '"' this '"' now next line \'
' second line text 
```

希望这会有所帮助:)

# java - 限制线宽不切字

> ID：13728300
> 
> 赞同：1
> 
> 时间：2012-12-05T16:53:04.657
> 
> 标签：java

我目前使用此代码将行限制为 20 个字符：

```
if (string.length() % 20 == 0 && string.length() >= 20) {
    this.string += "\n";
} 
```

但是，它会破坏这样的单词：

```
Hello, my name is Pa
trick 
```

我怎样才能防止这种情况？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-05T17:01:33.573

您可以使用这样的正则表达式`.{1,20}(\W|$)`来拆分接近 20 个字符但不拆分单词的短语。

这将适用于最多 20 个字符。如果你想配置数字，你可以在正则表达式中参数化它，比如你的限制`"(.{1," + max + "}(\\W|$))"`在哪里。`max`

```
String s = "Hello, my name is Patrick and I have a lot to say, but I will tell you that another day.";
Matcher m = Pattern.compile("(.{1,20}(\\W|$))").matcher(s);
StringBuilder b = new StringBuilder();
while (m.find()) {
    b.append(m.group()).append("\n");
}
System.out.println("-> " + b.toString()); 
```

将打印出：

```
-> Hello, my name is 
Patrick and I have a 
lot to say, but I 
will tell you that 
another day. 
```

**编辑**

我编辑了上面的答案，实际上它正在搜索一个不在单词中的字符`\W`，在我的示例中，字符串以 a 结尾`.`但不在你的字符串中。我编辑了上面的正则表达式，因此如果字符串确实以未表示的字符结尾，则它也可以通过在字符串末尾`\W`添加条件来表示`$`。

你可以在这里看到一个可运行的例子：http: [//ideone.com/Nw2aNr](http://ideone.com/Nw2aNr)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-05T16:56:33.387

用空格分割字符串，`s.split("\\s+")`然后逐字附加，观察 line 的长度。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-05T17:02:36.490

我想这是每次附加一个字符时的一段代码。所以，要解决这个问题，你应该做一些更有趣的事情。基本思想是这样的：

1.  检测到线路限制。
2.  拿最后一行。
3.  使用空格分割`String words[] = line.split("\\s+");`
4.  如果你有多个单词，那么
    *   使用 获取该行的子字符串`lastIndexOf(words[words.length - 1]);`，这样可以保留除最后一个单词之外的所有内容。
    *   将最后一个单词添加到新行。
5.  否则，像现在一样断开单词（通过添加换行符）

# c# - 将 DataTable 传递给 IronPython

> ID：13728305
> 
> 赞同：5
> 
> 时间：2012-12-05T16:53:14.867
> 
> 标签：c#, python, .net, ironpython

我有一个 .NET 项目，我在其中使用 IronPython 对数据进行一些处理。目前，C#代码循环遍历并为需要动态计算的每一行和每一列生成一个IronPython脚本。但是，我想通过传入 DataTable 对象和对其执行的脚本来提高该过程的效率。不幸的是，**我遇到了`'DataTable' object is unsubscriptable`错误**，并且没有进行任何处理。

*用于生成和执行 IronPython 脚本的 C# 片段：*

```
DataTable dt = new DataTable();
dt.Columns.Add("count", typeof(int));
dt.Columns.Add("calc", typeof(int));
dt.Rows.Add(1, null);

ScriptEngine engine = Python.CreateEngine(options);
ScriptScope scope = engine.CreateScope();
scope.SetVariable("dt", dt);
ScriptSource source = engine.CreateScriptSourceFromString(code, SourceCodeKind.AutoDetect);
object result = source.Execute(scope);
DataTable table = scope.GetVariable<System.Data.DataTable>("dt"); 
```

*要对表执行的 Python 脚本：*

```
import clr
clr.AddReference('System.Data')
from System import Data
from System.Data import DataTable
for row in dt.Rows:
    dt["calc"] = dt["count"] + 1 
```

如何修复`'DataTable' object is unsubscriptable`错误，或者有更好的方法来处理将 DataTable 传递到 IronPython？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-05T17:02:55.647

DataTable 对象确实*是*不可订阅的，即不能通过索引属性（即`dt[index]`）访问。

你可能是这个意思：

```
for row in dt.Rows:
    row["calc"] = row["count"] + 1 
```

我将`dt`变量替换为`row`.

# android - 您如何将 Robolectric、Maven、ActionBarSherlock（最好是 + IntelliJ）集成到 Android 项目中？

> ID：13728310
> 
> 赞同：12
> 
> 时间：2012-12-05T16:53:26.420
> 
> 标签：android, maven, intellij-idea, actionbarsherlock, robolectric

一段时间以来，我一直在用头撞墙，试图让 maven、robolectric、actionbar sherlock 和 intellij 都能玩得很好。我现在已经放弃了使用 intellij 进行构建，而是专注于 maven。

当我跳过 maven 构建中的测试时，我有一个带有操作栏的应用程序（这告诉我我很高兴继续进行 ActionBar 集成）。IntelliJ 构建在 ManifestParsingTest.java 上失败，抱怨它不知道 junit 在哪里（以及其他问题）。

**机器人集成**

我已经在项目中成功运行了 Robolectric。[我将Jake Wharton 的 gist](https://gist.github.com/3803294)中的文件复制到`src/test/java/com/blah/blah/support/`（除了`ShadowSherlockFragmentActivity.java`位于 中`src/test/java/com/blah/blah/support/shadows/`）并将这一行放在我的自定义测试运行器的构造函数中（位于`support`文件夹中）：

```
ActionBarSherlock.registerImplementation(ActionBarSherlockRobolectric.class); 
```

**mvn 错误**

我遇到了这些构建错误（IntelliJ 也有相同的东西的红色曲线）：

```
[ERROR] Failed to execute goal org.apache.maven.plugins:maven-compiler-plugin:3.0:testCompile (default-testCompile) on project Blah: Compilation failure: Compilation failure:
[ERROR] /Users/clatislaw/Documents/Code/Android/projectName/src/test/java/com/blah/blah/support/SherlockResourceLoader.java:[29,9] cannot find symbol
[ERROR] symbol  : constructor ResourceLoader(int,java.lang.Class,java.util.List<java.io.File>,java.io.File)
[ERROR] location: class com.xtremelabs.robolectric.res.ResourceLoader
[ERROR] /Users/clatislaw/Documents/Code/Android/projectName/src/test/java/com/blah/blah/support/SherlockResourceLoader.java:[45,5] method does not override or implement a method from a supertype
[ERROR] /Users/clatislaw/Documents/Code/Android/projectName/src/test/java/com/blah/blah/support/ActionBarSherlockTestRunner.java:[39,37] resourceLoaderForRootAndDirectory has private access in com.xtremelabs.robolectric.RobolectricTestRunner
[ERROR] /Users/clatislaw/Documents/Code/Android/projectName/src/test/java/com/blah/blah/support/ActionBarSherlockTestRunner.java:[47,30] cannot find symbol
[ERROR] symbol  : method getResourcePath()
[ERROR] location: class com.xtremelabs.robolectric.RobolectricConfig
[ERROR] /Users/clatislaw/Documents/Code/Android/projectName/src/test/java/com/blah/blah/support/ActionBarSherlockTestRunner.java:[48,9] resourceLoaderForRootAndDirectory has private access in com.xtremelabs.robolectric.RobolectricTestRunner
[ERROR] /Users/clatislaw/Documents/Code/Android/projectName/src/test/java/com/blah/blah/support/ActionBarSherlockTestRunner.java:[38,3] method does not override or implement a method from a supertype 
```

**pom.xml**

```
<?xml version="1.0" encoding="UTF-8"?>
<project
    xmlns="http://maven.apache.org/POM/4.0.0"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">

    <modelVersion>4.0.0</modelVersion>
    <groupId>com.blah.blah</groupId>
    <artifactId>projectName</artifactId>
    <version>1.0.0-SNAPSHOT</version>
    <packaging>apk</packaging>
    <name>Project Name App</name>

    <dependencies>
        <dependency>
            <groupId>com.google.android</groupId>
            <artifactId>android</artifactId>
            <version>4.0.1.2</version>
            <scope>provided</scope>
        </dependency>

        <dependency>
            <groupId>com.pivotallabs</groupId>
            <artifactId>robolectric</artifactId>
            <version>1.1</version>
            <scope>test</scope>
        </dependency>

        <dependency>
             <groupId>junit</groupId>
             <artifactId>junit</artifactId>
             <version>4.8.2</version>
             <scope>test</scope>
        </dependency>

        <dependency>
             <groupId>com.google.android</groupId>
             <artifactId>support-v4</artifactId>
             <version>r6</version>
        </dependency>

        <dependency>
            <groupId>com.actionbarsherlock</groupId>
            <artifactId>library</artifactId>
            <version>4.1.0</version>
            <type>apklib</type>
        </dependency>
    <build>
        <finalName>${project.artifactId}</finalName>

        <plugins>
            <plugin>
                <!-- See http://code.google.com/p/maven-android-plugin/ -->
                <groupId>com.jayway.maven.plugins.android.generation2</groupId>
                <artifactId>android-maven-plugin</artifactId>
                <version>3.2.0</version>
                <configuration>
                    <sdk>
                        <platform>15</platform>
                    </sdk>
                </configuration>
                <extensions>true</extensions>
            </plugin>
        </plugins>
    </build>
</project> 
```

我缺少一些项目配置吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-05T17:04:21.577

在 Square，为了支持这个用例，我们使用[了 Robolectric 的修改版本](http://github.com/square/robolectric/)。我们正在与 Pivotal 合作，以使我们不再使用分叉并将必要的更改上游到主存储库中。所需的更改是挂钩到资源加载系统。这些方法当前是私有的，这是您看到的编译失败的原因。

Pivotal 不会以任何频繁的方式进行发布，因此如果更改确实使其成为上游，您可能不得不使用该`SNAPSHOT`版本一段时间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T14:43:26.623

我可以让它工作。

尝试这个：

*   将 robolectric 和 junit 依赖项移到最后。

*   在构建标签中指明 src 和测试路径，在最终名称之后和插件之前。

*   从 Maven 工具栏重建并运行测试。

    ```
    <dependencies>
    <dependency>
        <groupId>com.google.android</groupId>
        <artifactId>android</artifactId>
        <version>4.0.1.2</version>
        <scope>provided</scope>
    </dependency>

    <dependency>
        <groupId>com.google.android</groupId>
        <artifactId>support-v4</artifactId>
        <version>r6</version>
    </dependency>

    <dependency>
        <groupId>org.roboguice</groupId>
        <artifactId>roboguice</artifactId>
        <version>2.0</version>
    </dependency>

    <dependency>
        <groupId>com.octo.android.robospice</groupId>
        <artifactId>robospice-spring-android</artifactId>
        <version>1.2.0</version>
    </dependency>

    <dependency>
        <groupId>org.codehaus.jackson</groupId>
        <artifactId>jackson-mapper-asl</artifactId>
        <version>1.9.9</version>
    </dependency>

    <dependency>
        <groupId>com.google.code.gson</groupId>
        <artifactId>gson</artifactId>
        <version>2.2.2</version>
    </dependency>

    <dependency>
        <groupId>com.actionbarsherlock</groupId>
        <artifactId>actionbarsherlock</artifactId>
        <version>4.2.0</version>
        <type>apklib</type>
    </dependency>

    <dependency>
        <groupId>com.actionbarsherlock</groupId>
        <artifactId>actionbarsherlock</artifactId>
        <version>4.2.0</version>
    </dependency>

    <dependency>
        <groupId>com.pivotallabs</groupId>
        <artifactId>robolectric</artifactId>
        <version>1.1</version>
        <scope>test</scope>
    </dependency>

    <dependency>
        <groupId>junit</groupId>
        <artifactId>junit</artifactId>
        <version>4.8.2</version>
        <scope>test</scope>
    </dependency>

    </dependencies>

    <build>
    <finalName>${project.artifactId}</finalName>

    <sourceDirectory>src</sourceDirectory>
    <testSourceDirectory>test</testSourceDirectory>

    <plugins>
        <plugin>
            <!-- See http://code.google.com/p/maven-android-plugin/ -->
            <groupId>com.jayway.maven.plugins.android.generation2</groupId>
            <artifactId>android-maven-plugin</artifactId>
            <version>3.2.0</version>
            <configuration>
                <sdk>
                    <platform>15</platform>
                </sdk>
            </configuration>
            <extensions>true</extensions>
        </plugin>
    </plugins>
    </build> 
    ```

# mysql - 遍历一个mysql表并更新另一个找到匹配的表

> ID：13728311
> 
> 赞同：0
> 
> 时间：2012-12-05T16:53:27.740
> 
> 标签：mysql, loops

我在使用离线帐户更新在线数据库时遇到问题。别问……如果你明白我的意思，那就是查理狐步舞，但我必须找到一个解决方案。

我需要发生以下逻辑，这远远超出了我的技能范围。导入表中大约有 28,000 条记录，members 和 member_data 表中有 2,400 条记录——如果这有帮助的话。我希望一个有强大功夫的善良灵魂可以帮助我。

表格：

```
members
    id
    group_id
member_data
    id
    account
    phone
    modified
import
    account
    phone 
```

期望的逻辑：

```
Loop through each record in import table and search for match between import.account and member_data.account.

If Match:
    Update members.group_id to '5'.
    Update member_data.modified to '1'.

If No Match:
    Search for match between import.phone and member_data.phone.
        If Match:
            Update member_data.account with import.account of the matched record.
            Update members.group_id to '5'.
            Update member_data.modified to '1'. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T17:06:09.307

首先，您可以在“其他非标准实现”部分查看此链接：

[合并 (SQL)](http://en.wikipedia.org/wiki/Merge_%28SQL%29)

如果我正确地将我的 TSQL 经验转换为 MySQL 的风格，那么您将需要所谓的 INSERT...ON DUPLICATE KEY UPDATE 语句。这里的创始人：

[MySQL 文档 INSERT...ON DUPLICATE KEY UPDATE](http://dev.mysql.com/doc/refman/5.0/en/insert-on-duplicate.html)

这实际上是在发生密钥冲突之前插入记录。在您的情况下，帐号使记录独一无二。当它发现密钥违规（匹配记录）时，您可以通过更新语句指定您希望发生的事情。

我希望这对您有所帮助。

# jquery - 通过 JQuery 和 JSON 设置 ASP LinkBut ton 控件的文本

> ID：13728313
> 
> 赞同：1
> 
> 时间：2012-12-05T16:53:32.933
> 
> 标签：jquery, asp.net, json

我有一个 ASP.net 4.0 站点要修改。特别是，我想将 LinkBut​​ton 控件的文本值设置为文件名：

```
<asp:LinkButton ID="LinkButtonFile1" runat="server" OnClick="GetFile"> 
```

我想在客户端使用 JQuery 和 JSON 对象执行此操作：

```
 var FileNames = { "name": "testing" };
 var id = ('id=$LinkButtonFile1').val();
 ('id=$LinkButtonFile1').val() = FileNames.name 
```

我使用'id = ..'，因为我使用的是母版页，我通过谷歌搜索发现这个问题可以通过这样做来解决。在 VS2010 上运行此调试会发现 'val()' 不是有效属性。我尝试了很多变化，包括：

```
 var FileNames = { "name": "testing" };
//var id = document.getElementById("<%= $LinkButtonFile1 %>");
//var id = document.getElementById('[id$=LinkButtonFile1]');
var id = document.getElementById('id$=LinkButtonFile1');

var id = document.getElementById('$LinkButtonFile1');
//('[id=$LinkButtonFile1]').val(FileNames.name); 
```

返回 id = null。

我用谷歌搜索了许多网站，试图获得正确的语法，但没有什么对我有用。谁能告诉我正确的语法？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T16:54:50.780

您设置值的语法错误。

改变

```
('id=$LinkButtonFile1').val() = FileNames.name 
```

至

```
('[id*=LinkButtonFile1]').text(FileNames.name); 
```

或使用 id 而不是通配符，这里是首选方法

```
('#<%= LinkButtonFile1.ClientID %>').text(FileNames.name); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-28T16:35:22.237

我知道这个问题很老，但我一直在寻找相同的答案，但找不到任何帮助。经过大量的挖掘、提问等，我找到了一个解决方案，我认为它会在这里有所帮助。

首先，让我们看看您的 LinkBut​​ton：

> `<asp:LinkButton ID="LinkButtonFile1" runat="server" OnClick="GetFile">`

将 ClientIDMode="Static" 放在某处。否则，当你运行时，你会在你的 ID 前面加上“MainContent_”之类的东西。查看您的网页源代码进行验证。

其次，你如何抓住你的按钮......

> `var id = document.getElementById('id$=LinkButtonFile1');`

getElementById 更多的是与 jquery 混合的 javascript-y。让我们坚持一个.. jquery。

> `$("#LinkButtonFile1").text(FileNames.name);`

这应该允许您更改链接按钮的文本。如果这不起作用，可能尝试将 FileNames.name 放在引号中，或直接将实际文本拉出。

# javascript - 将对象绑定到全局范围

> ID：13728320
> 
> 赞同：0
> 
> 时间：2012-12-05T16:53:51.207
> 
> 标签：javascript

我有以下代码：

```
var myVar = (function (window) {    

    myobj = {};

    myobj.boo = function() {
        alert('hi');
    };

    window.myVar = myobj;

})(window);

myVar.boo(); 
```

为什么我在调用 myVar.boo() 时没有收到警报？我创建了一个匿名的自执行函数并输入了 window 对象。在里面我有另一个对象，它分配了一个方法。然后我将全局 myVar 变量分配给这个 obj。这应该为 myobj 对象提供一个别名。但是，当我调用该函数时，我得到一个无法调用未定义错误的方法“boo”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T16:57:05.430

您应该删除第一个作业

```
var myVar = 
```

当您将 myVar 值替换为不返回任何内容的函数的返回时，

或更可能从您的函数返回 myVar，而不是从闭包内部分配：

```
var myVar = (function() {
  var myobj = {};

  myobj.boo = function() {
      alert('hi');
  };

  return myobj;
})(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T17:01:49.227

您在这里定义`myVar`一个`undefined`值。当您初始化它时，它会调用匿名函数。并存储返回值。但是该函数不返回任何内容。所以没有分配给`myVar`. 即使您添加了`window.myVar = myobj`，它也会在函数完成时被覆盖。

# jquery - 无法确定在 .each 函数中使用哪些选择器

> ID：13728324
> 
> 赞同：0
> 
> 时间：2012-12-05T16:54:14.813
> 
> 标签：jquery, jquery-selectors

我有一些动态生成的 html 代码：

```
<div id="slider-7238" class="hps-slide" style="width:250px; height:50px;">
    <div class="hps-sliderText">
        Custom Pizza<br />
        Left: Mushrooms / Green Peppers<br/>Right: Cheese<span class="slide-more" id="slide-more-7238"> MORE... </span>
            <div class="slide-full-desc" id="slide-desc-7238">Left: Mushrooms / Green Peppers<br/>Right: Ultimate Cheese</div>                           
    </div>
</div>

<div id="slider-3471" class="hps-slide" style="width:250px; height:50px;">
    <div class="hps-sliderText">
        Chicken Alfredo<br />
        Grilled chicken breast strips and rotini pasta oven-baked<span class="slide-more" id="slide-more-3471"> MORE... </span>
            <div class="slide-full-desc" id="slide-desc-3471">Grilled chicken breast strips and rotini pasta oven-baked in a creamy Alfredo sauce with a layer of melted cheese. Served with an order of breadsticks.</div>                                    
    </div>
</div>

<div id="slider-7261" class="hps-slide" style="width:250px; height:50px;">
    <div class="hps-sliderText">
        Custom Pizza<br />
        Left: Ham<br/>Right: Cheese
    </div>
</div> 
```

可以有任意数量的这些块，并且与它们关联的 id 号永远是未知的。我有一个 javascript 函数，它采用`slide-more`跨度并将它们转换为鼠标悬停工具提示，其中`slide-full-desc`div 的内容作为工具提示内容。如果我在要使用的 div id 中硬编码，则该函数可以正常工作，但由于动态生成，我不能这样做。我正在尝试在 .each 函数中使用它，但似乎无法正确选择选择器。我没有收到任何错误；它只是不是所有的工作。

这是它的代码：

```
 $(document).ready( function() {
        $('span.slide-more').each(function (i) {
            new QoTooltip($(this), $('slide-full-desc').html(), {'layout':'top'});
        });
    }); 
```

QoTooltip 的参数是鼠标悬停的元素、包含工具提示内容的元素和一些设置（在这种情况下，只是布局。）

我需要的是让函数对每个跨度应用一个新的 QoTooltip 并传入相关的 slide-full-desc div 的内容。它们通过附在其 ID 上的四位数字相关联（即`span id="slide-more-3471"`需要获取`slide-desc-3471`div 的 html。

鼠标悬停工作，所以它至少在跨度上得到 .each ，但我不确定如何将正确的内容放入第二个参数中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T16:57:06.163

像这样试试

```
$('span.slide-more').each(function (i) {
    new QoTooltip($(this), $(this).next('.slide-full-desc').html(), {'layout':'top'});
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T16:57:20.050

尝试这个

```
$(this).next('.slide-full-desc').html(); 
```

**完整代码**

```
$(document).ready( function() {
      $('span.slide-more').each(function (i) {
          var $this = $(this);
          new QoTooltip($this, $this.next('.slide-full-desc').html()
                                                             , {'layout':'top'});
      });
 }); 
```

# python - 我可以在不进行系统范围安装的情况下使用 Z3Py 吗？

> ID：13728325
> 
> 赞同：2
> 
> 时间：2012-12-05T16:54:15.010
> 
> 标签：python, z3

我正在尝试从其 python 界面使用 Z3，但我不希望进行系统范围的安装（即 sudo make install）。我尝试使用 --prefix 进行本地安装，但 Makefile 是硬编码的，可以安装到系统的 python 目录中。

最好的情况是，我想直接从构建中直接运行 z3，就像我使用 z3 二进制文件 (build/z3) 一样。有谁知道如何或有脚本直接从构建目录运行 z3py 而不进行安装？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T19:09:41.573

是的，您可以通过在您的环境变量`LD_LIBRARY_PATH`和`PYTHONPATH`环境变量中包含构建目录来实现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-11T12:02:45.570

如果您不关心python接口，请编辑`build/Makefile`并注释掉或删除`install`目标中的以下行：

```
@cp libz3$(SO_EXT) /usr/lib/python2.7/dist-packages/libz3$(SO_EXT)
@cp z3*.pyc /usr/lib/python2.7/dist-packages 
```

# javascript - jQuery

> ID：13728329
> 
> 赞同：0
> 
> 时间：2012-12-05T16:54:23.260
> 
> 标签：javascript, jquery

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T17:22:32.837

将您的 HTML 片段生成为单独的字符串，使用`alert()`它来回显它，并将结果粘贴到 W3 验证器中会出现以下错误：

> **未打开的元素“DIV”的结束标记**

换句话说，你有一个虚假的`</div>`结束标签`var openSecondary = ...`

顺便说一句，验证器还抛出了您正在重用`one_0_required`作为多个元素的 ID

# winforms - Windows 窗体焦点事件

> ID：13728330
> 
> 赞同：0
> 
> 时间：2012-12-05T16:54:24.013
> 
> 标签：winforms, infragistics

我有一个带有重写 OnActivated 方法的选项卡式表单。当我离开我的应用程序 (Alt-Tab) 并返回我的应用程序时，不会触发 OnActivated 方法。

是否有另一种方法或事件可以用来捕捉这个？我想在表单上举办一个活动。如果这是不可能的，也许应用程序上有一个事件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T17:17:57.770

激活是表单创建/显示过程的一部分

Enter 或 Gotfocus 是您想要的，但通常在您 Alt 选项卡退出时具有焦点的控件上。见[MSDN](http://msdn.microsoft.com/en-us/library/86faxx0d.aspx)

了解更多详情

如果您告诉我们您想要发生什么并且可能是为什么，可能会有更好的方法。

# gcc - 学习 GCC ASM：SSE 到 NEON：加载和存储

> ID：13728349
> 
> 赞同：0
> 
> 时间：2012-12-05T16:54:58.997
> 
> 标签：gcc, assembly, sse, neon

我有一段使用 SSE 指令编写的内联 ASM 代码，我需要将其移植到 NEON。我想自己学习基础知识，看看我能不能一步一步地完成，而不是把整个东西批量转换。

因此，第一步是学习负载和存储。考虑 ...

```
float input[4] = { 1.0f, 2.0f, 3.0f, 4.0f };
float output[4] = { 0 };
asm volatile
(
    "movups %[I], %%xmm0 \n\t"
    "movups %%xmm0, %[O] \n\t"
    : [O] "=m" (output[0])
    : [I] "m" (input[0])
    : "memory", "xmm0"
); 
```

我知道（我认为）我应该使用 vld1.32 指令，但我对将它与我之前使用过的其他一些 GCC ASM 构造（如命名变量等）结合起来有点含糊。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T18:09:10.810

```
vld1.32 {d0,d1}, [%[I]]; 
vst1.32 {q0}, [%[O]]; 
```

根据 gcc 版本，它将 q0 识别为 d0,d1。另外我认为您想要 (&output[0]) 或简单地 (output) 和 (input) 而不是将浮点数加载到通用寄存器。

在 ARM 中，您还可以后递增指针：`xxx { }, [%[I]!]`

例如，请参阅[此](http://blogs.arm.com/software-enablement/241-coding-for-neon-part-3-matrix-multiplication/)示例。

# python - 如何制作新的串联列？

> ID：13728352
> 
> 赞同：0
> 
> 时间：2012-12-05T16:55:13.120
> 
> 标签：python

我有一个 .csv 有这样的数据：

```
30,972.74176,0.446378,1.825426,cl+l  
31,1015.075579,0.279686,2.950118,l  
32,1072.59334,0.273239,4.408458,cl+l  
33,1139.55317,-1.616904,4.756378,l  
34,1279.86304,50.335186,3.877577,r  
35,1181.541419,61.399389,5.155133,r  
36,1097.421199,63.809733,5.37508,r  
37,1018.555678,64.034432,2.59232,r 
```

我编写了一个程序，它取出最后一列（E，我在程序中调用它）为“l”或“c​​l+l”的行，并将其复制到另一个名为“left.csv”的文件中. 我想要做的是在 left.csv 中添加另一列，该列从第二列 (B) 中获取数据，在它们之间放置一个逗号，然后是 D 列中的数据。

所以，left.csv 现在看起来像：

```
30,972.74176,0.446378,1.825426,cl+l  
31,1015.075579,0.279686,2.950118,l  
32,1072.59334,0.273239,4.408458,cl+l  
33,1139.55317,-1.616904,4.756378,l 
```

我想要的是：

```
30,972.74176,0.446378,1.825426,cl+l,"972.74176,1.825426"  
31,1015.075579,0.279686,2.950118,l,"1015.075579,2.950118"    
32,1072.59334,0.273239,4.408458,cl+l,"1072.59334,4.408458"   
33,1139.55317,-1.616904,4.756378,l,"1139.55317,4.756378" 
```

我应该如何实现这一点，以及如何告诉程序逗号不应该开始下一个条目，即使它是 csv？这可能吗，我是否必须有括号或不同的分隔符？我现在的代码是：

```
import csv
import sys
import operator

fieldnames = ["A","B","C","D","E"]
surveyfile = open("source.csv", "r")
left_file = open("left.csv",'wb')
right_file = open("right.csv",'wb')
coil_file = open("coil1.csv","wb")

reader = csv.DictReader(surveyfile, fieldnames=fieldnames, delimiter=",")
left_writer = csv.DictWriter(left_file, fieldnames, delimiter=",")
sortedlefts = sorted(reader,key=lambda x:float(x["B"]))

surveyfile.seek(0,0)

right_writer = csv.DictWriter(right_file, fieldnames, delimiter=",")
sortedrights = sorted(reader,key=lambda x:float(x["B"]), reverse=True)

coil_writer = csv.DictWriter(coil_file, fieldnames, delimiter=",")

for row in sortedlefts:
    if row["E"] == "l" or row["E"] == "cl+l":
        left_writer.writerow(row)
        coil_writer.writerow(row)   

for row in sortedrights:
    if row["E"] == "r":
        right_writer.writerow(row)
        coil_writer.writerow(row) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T16:59:05.153

只需在 中添加一个额外的值`row`，格式化为包含逗号：

```
row['F'] = '%s,%s' % (row['E'], row['B']) 
```

或使用`','.join()`：

```
row['F'] = ','.join([row['E'], row['B']]) 
```

但请`'F'`在您的字段中包含以下内容`left_writer`：

```
left_writer = csv.DictWriter(left_file, fieldnames + ['F'], delimiter=",") 
```

如果您将`coil_writer`实例配置为*忽略*额外的列，则无需为其创建单独的循环或`row`在现有循环中创建副本：

```
coil_writer = csv.DictWriter(coil_file, fieldnames, delimiter=",", extrasaction='ignore') 
```

csv 编写器将为您处理报价。

# mysql - 生产数据库中 Rails 事务回滚与手动清理的性能

> ID：13728355
> 
> 赞同：1
> 
> 时间：2012-12-05T16:55:24.260
> 
> 标签：mysql, ruby-on-rails, database, transactions, rollback

**我知道回滚与手动清理不同，在大多数情况下，这是首选方法。也就是说，如果在数据库中的其他表中存在并发保存和删除，那么大型数据库回滚与手动清理之间的性能差异是什么？**

* * *

额外细节：

我目前正在开发一个允许用户导入嵌套学校数据的大型 CSV 的 Rails 应用程序。一所学校有很多老师，一个老师有很多教室，一个教室有很多学生。因此，CSV 可能类似于：

```
School 1
  Teacher 1
    Class 1
      Student 1
      Student 2
      Student 5
    Class 2
      Student 3
  Teacher 2
    Class 4
      Student 1
      Student 4 
```

在后台工作中，我目前正在使用这个 CSV，并在数据库事务块中，在内存中构建一个巨大的学校对象，然后尝试一次保存。如果保存失败，由于验证原因或超时，事务块会将我的数据库回滚到之前的状态。

我注意到这种回滚的性能在生产中非常慢。我相信部分原因是因为在回滚期间存在对数据库的并发读写。我现在正在考虑通过 :dependent => :delete_all 方法手动清理数据库是否会更快。当我在开发中对这些进行基准测试时，手动清理比回滚稍慢，但同样，没有并发读/写。

# jquery - jquery 替换 div 内容 html()

> ID：13728358
> 
> 赞同：10
> 
> 时间：2012-12-05T16:55:26.190
> 
> 标签：jquery

我只是尝试用绑定到点击事件的新内容替换 div 的内容。

[JSFIDDLE](http://jsfiddle.net/pCckh/)

当我使用`appendTo()`而不是`html()`它的工作时，但我需要清除旧内容所以我有点困惑为什么这不能正常工作

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-05T16:57:51.883

您正在使用`content`in place of`selector`和`selector`in place of `content`，您需要`#`与 id selctor 一起使用。你可以这样做

**[现场演示](http://jsfiddle.net/rajaadil/pCckh/1/)**

```
function showitnow() {
    var div_data = "<div ><a href='XXX'>XXX</a></div>";
    $("#test1").html(div_data);

}

$("#button1").click(function() {
     showitnow();
});
​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T17:11:09.797

你的小提琴有一些错误，应该是这样的：http: [//jsfiddle.net/pCckh/3/](http://jsfiddle.net/pCckh/3/)

```
function showitnow() {
    var div_data = "<div ><a href='XXX'>XXX</a></div>";
    $("#test1").html(div_data);
   //  ^---selector----^----------your content
}

$("#button1").click(function() {
    showitnow();
 // ^----------------remove the var and just call the function when click the button
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-05T17:42:28.953

也许你可以试试这个..
把你的 JQuery 作为父母和孩子玩..

```
<div id="Destination"> 
    <div class="child_content"> item 1 </div>
    <div class="child_content"> item 2 </div>
</div>

    <div id="Source"> 
    <div class="child_content"> item 1 </div>
    <div class="child_content"> item 2 </div>
</div>

      <script type="text/javascript"> 
        $(document).ready(function(){
            $("#Source .child_content").click(function(){
                $(this).parent().remove();
                $(this).appendTo("#Destination");
            });
        });
    </script> 
```

希望这有帮助..

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2014-03-21T10:26:54.237

[请看一看！](http://jsfiddle.net/Shreejeetd/pCckh/194/)预期结果...

在同一示例中只需要进行少量修改。

```
<div id = 'div_data'>
<button id="button1">BUTTON1</button>
div>

<div id="test2"></div> 
```

# php - 在托管网站中安装 mysqlnd

> ID：13728365
> 
> 赞同：5
> 
> 时间：2012-12-05T16:55:40.340
> 
> 标签：php, mysqli, mysqlnd

我正在用 PHP - MySQL 开发一个网站。这里有几点需要注意：

*   我正在使用**MySQLi** API 进行数据库访问。
*   在我本地安装的 XAMPP（Windows 7 机器）中，PHP 版本是**5.3.8**，MySQL 版本是**mysqlnd 5.0.8-dev - 20102224**
*   我在免费托管服务器上托管了该网站，用于测试“cuccfree.com”。这里 PHP 版本是**5.3.14**， MySQL 版本是**5.1.66**。与许多其他托管公司相比，它仍然对 MySQLi 有更好的支持。
*   在 phpinfo'ing 两者中，本地机器显示已安装**mysqlnd**驱动程序，但托管服务器尚未安装。
*   我为 MySQLi 创建了一个包装类，它使用函数**mysqli_stmt::get_result()**获取 ResultSet 。这个函数在我的本地机器上有效，但在 cuccfree.com 托管服务器上无效，因为**mysqli**对象没有名为**get_result()**的方法。不过，**mysqli_stmt**对象已**准备好**并**已**成功绑定参数。
*   [php.net](http://php.net/manual/en/mysqli-stmt.get-result.php)上**mysqli_stmt**的手册页说，要使用**mysqli_stmt::get_result()**，我们需要安装**mysqlnd**驱动程序。
*****   服务器的配置提供了**mysqli_stmt::bind_object()**的使用。但`get_result()`对我来说似乎是一个更好的选择，因为我们可以得到数组形式的结果。我已经使用以下行重写了函数以接受可变数量的参数：

    call_user_func_array(array($stmt, 'bind_param'), $params);**** 

 ****其中 $params 是一个参数数组。

*   使用 bind_object()，我必须将返回的每一列绑定到一个变量。在这种情况下，我无法创建一个包装类函数来一次性处理所有 SQL 查询。

我找了几家托管公司，与许多公司的客户支持交谈并邮寄，包括 GoDaddy 和 Manas Hosting，他们不提供**mysqlnd**的使用。他们非常合乎逻辑地坚持使用 VPS 或专用服务器。显然，这两种建议的选择都非常昂贵，即使在入门级也是如此。

那么，最后我的问题是，我们可以将 mysqlnd 安装/嵌入到 Linux 服务器上的网站中吗？如果没有，我有什么替代方法可以阻止我更改整个网站的代码，这将花费我很多天？

问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-20T09:19:19.830

我以前也经历过这种情况，它是一个真正的食客。如果您不想升级到 VPS，唯一的解决方案是使用 PDO。您可以尝试在共享主机帐户中进行 SSH，但如果尝试更改任何内容，请祝您好运，因为网络管理员在网络托管方面很聪明。我什至已经删除并拒绝了无法通过 yum 安装任何软件包的网络托管服务`yum.conf`商`/etc/`。但是，如果您获得了 VPS 并且拥有 cpanel，则可以更改 PHP 的配置选项。我花了很长时间才弄清楚这一点，但我了解到您可以通过运行更改 CPanel 中的 PHP 选项`/usr/local/cpanel/scripts/easyapache`. 如果您运行 Apache 2.2，您还可以按照本文档更改 PHP 配置选项的配置选项。没有VPS，我很确定没有办法像那样改变CPanel。我希望这篇文章有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T17:09:33.177

除非您的托管公司启用了`dl()`我几乎可以保证他们没有启用的使用，否则不会。

您已经指出的第二个选择是为 mysqlnd 编写（或查找，它们可能存在，也许其他人可以向您指出该方向）一个兼容层。我假设自从您自己编写以来，还没有一个存在。所以不幸的是，我相信你陷入了泥潭。

无论如何，你下次真的应该使用 PDO :) 但我知道，事后看来是 20/20，所以......****

# php - 以行组显示结果并对每组值求和

> ID：13728366
> 
> 赞同：3
> 
> 时间：2012-12-05T16:55:44.807
> 
> 标签：php, mysql

我对 PHP/MySQL 没有太多经验。我有一个包含 3 个字段的表格：`id`、`particular`和`amount`，如下所示。

```
id   particular   amount
1    Fees         5000
2    Fees         3000
3    Bill         9000
4    Fees         4000
5    Bill         3000
6    Expense      2000
7    Fees         1000 
```

我想按组显示数据以及每个组的总和，如下所示：

```
particular   amount
Fees         5000
Fees         3000
Fees         4000
Fees         1000
**Total        13000**
Bill         9000
Bill         3000
**Total        12000**
Expense      2000
**Total        2000** 
```

我尝试这个查询`SELECT SUM(amount), particular FROM sale_expense GROUP BY particular`并添加了所有值，但它没有显示在组中，因为我需要显示数据

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T17:19:27.800

```
SELECT particular, id, sum(amount) amount
FROM TableName
GROUP BY particular, id WITH ROLLUP 
```

[小提琴](http://www.sqlfiddle.com/#!2/c448d/2)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-05T17:03:33.743

试试这个 sql：

```
SELECT 特别，SUM(amount) AS total FROM tablename GROUP BY 特别

```

这应该给你每组的总数。
更新：试试这个

```
$sql = "SELECT specific, SUM(amount) AS total FROM tablename GROUP BY specific";
$result = mysql_query($sql);
而($row = mysql_fetch_array($result)){
    $sql2 = "SELECT * FROM tablename WHERE specific = '".$row['particular']."'";
    $result2 = mysql_query($sql2);
    而($row2 = mysql_fetch_array($result2)){
        回声 $row2['特别']。" ".$row['数量'];
        回声“\n”；
    }
    echo " Totol: ".$row['total']." ";
}
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-05T17:14:50.427

尝试这个：

```
( SELECT 
    particular, 
    amount  
  FROM sale_expense )
UNION
( SELECT 
    CONCAT(particular," - total") AS particular, 
    SUM(amount) AS amount 
  FROM sale_expense
  GROUP BY particular )
ORDER BY particular ASC 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-05T17:13:02.640

您可以将查询合并在一起：

```
select particular, amount
from ((select id, particular, amount
       from sales_expense se
      ) union all
      (select 99999 as id, concat('Total: ', particular), sum(amount) as amount
       from sales_expense se
       group by particular
      )
     ) t
group by particular
order by id 
```

# ruby-on-rails-3 - FindMeIn Gem 或输出文件名

> ID：13728369
> 
> 赞同：-1
> 
> 时间：2012-12-05T16:55:56.590
> 
> 标签：ruby-on-rails-3, gem

我想知道是否存在一个 gem，它在开发环境中显示每个 html 顶部的文件（布局、视图、部分..）的渲染路径

例子：

> 在 /posts/show.html.erb 中找到我

我正在与一位设计师合作（0 轨技能），这是我们的第一个项目

如果不存在这样的gem，如何显示每个文件的路径？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T17:54:08.523

有一个宝石可以做到这一点，我不记得名字了，但它可能是这个：

[https://rubygems.org/gems/rails_view_annotator](https://rubygems.org/gems/rails_view_annotator)

> Rails 视图注释器可以轻松找出哪个部分生成了哪个输出

# c# - 如何在 nservicebus 中预处理消息？

> ID：13728371
> 
> 赞同：0
> 
> 时间：2012-12-05T16:56:00.717
> 
> 标签：c#, log4net, nservicebus

当这样的消息进来时，我想初始化一些日志记录：

```
public class BaseMessage
{
    public long TraceID { get; set; }
}

public class MyMessage : BaseMessage, ICommand
{
    //..other properties
}

public class Handler : IHandleMessages<MyMessage>
{
    public void Handle(MyMessage message)
    {
        log4net.ThreadContext.Properties["TraceID"] = message.TraceID

        //Process message
    }
} 
```

问题是我有很多消息，我想在收到消息时为所有消息都这样做。我希望能够做这样的事情：

```
public class Handler : IInitializeHandlers, IHandleMessages<MyMessage>
{
    public void Init(BaseMessage message)
    {
        log4net.ThreadContext.Properties["TraceID"] = ((BaseMessage)message).TraceID
    }

    public void Handle(MyMessage message)
    {
        //Process message
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T17:51:17.283

将跟踪 ID 移动到标头，并使用工作单元 (IManageUnitsOfWork) 将其注册到 log4net 上下文

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T16:45:46.957

这是我解决它的方法。我想自动创建 Trace ID 并将其发送到消息正文而不是标题中。我不确定将标头添加到总线的线程安全性，并且我不想更改所有调用代码或修改任何 IHandleMessages 实现。所以这就是我想出的。

```
public class TraceIDMutator : IMutateIncomingMessages, IMutateOutgoingMessages
{
    public object MutateIncoming(object message)
    {
        var baseMsg = message as MessageBase;
        if (baseMsg != null)
            ThreadContext.Properties[Constants.TraceID] = baseMsg.TraceID;

        return message;
    }

    public object MutateOutgoing(object message)
    {
        var baseMsg = message as MessageBase;
        if(baseMsg != null)
        {
            if(baseMsg.TraceID == 0)
            {
                 var tid = ThreadContext.Properties[Constants.TraceID];
                 if (tid != null)
                     baseMsg.TraceID = (ulong)tid;
            }
        }

        return message;
    }
} 
```

和接口允许我接入 nservicebus 的消息传递管道`IMutateIncomingMessages`。`IMutateOutgoingMessages`我只是在挖掘源代码以弄清楚引擎盖下到底发生了什么之后才发现它。您需要在您的 IoC 容器中注册此类才能使其工作。

```
 ObjectFactory.Configure(x =>
        {
            x.For<IMutateIncomingMessages>().Use<TraceIDMutator>();
            x.For<IMutateOutgoingMessages>().Use<TraceIDMutator>();
        }); 
```

发送消息时将调用“MutateOutgoing”。那时，我从`log4net.ThreadContext`if 中获取当前跟踪 id 并将其分配给消息。收到消息后，`MutateIncoming`将调用它，然后我`log4net.ThreadContext`为该线程设置跟踪 id 属性。

# php - 哪个更快显示活动菜单项？开关 + 一堆回声或一堆 if 语句？

> ID：13728385
> 
> 赞同：0
> 
> 时间：2012-12-05T16:56:42.073
> 
> 标签：php, if-statement, menu, switch-statement

还是有更好的方法？

开关+一堆回声：

```
switch($currentpage) {
case 'index.php':
    $indexclass=' active';
    $otherpageclass='';
    break;
case 'otherpage.php':
    $indexclass='';
    $otherpageclass=' active';
    break;
} 
```

然后，在 li 类中，我将简单地回显 $indexclass 用于索引和 $otherpageclass 用于其他页面。

另一种选择是只设置 $currentpage 变量并执行以下操作：

```
<li class="<?php if($currentpage='index.php'){echo ' active';}?>">whatever</li>
<li class="<?php if($currentpage='otherpage.php'){echo ' active';}?>">whatever</li> 
```

显然，我的网站比这大得多，可能会有大约 30 个不同的菜单项，所以我想知道哪种方式最有效，或者是否有更好的方式。

先感谢您！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-05T17:00:31.120

我认为速度应该与这个决定无关，因为你充其量是在谈论微优化。

做最有利于代码可读性和可维护性的事情。在我看来，我倾向于更倾向于使用 switch 语句的方法，因为对我来说，这可以更清晰地分离显示逻辑和实际显示。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T17:06:50.977

我会选择一个性能更差的解决方案：对象。我会创建一个类，以便能够以这种方式定义菜单：

```
$menu = new Menu($currentpage);
$menu->addItem('index.php', 'Home');
$menu->addItem('otherpage.php', 'Other Page');
echo $menu->html(); 
```

确切的代码应该不难弄清楚：一个带有项目的私有数组和一个 html() 方法来封装渲染。

# javascript - 街景图像无法在Firefox中加载

> ID：13728387
> 
> 赞同：6
> 
> 时间：2012-12-05T16:56:46.850
> 
> 标签：javascript, google-maps, firefox, google-street-view

我有一个在标签页中运行 Google 街景的页面。它无法在 Firefox（Linux 和 Windows）中正常工作。

街景代码正确加载——您可以看到所有的地图控件，并且没有报告任何 js 错误。在萤火虫的网络面板中，您甚至可以看到街景（我猜是瓷砖）加载的图像。

但是，视口只显示一个灰色块，上面叠加了街景控件。

Streetview 在同一页面，同一台机器上的 Google Chrome 中正常工作。我也在 Win 7 机器上进行了测试，在 FF 中看到了同样的问题，而它在 IE 和 Chrome 中正常工作。

相同的代码在我本地另一个站点上的同一台 Linux 机器上的 Firefox 中完美运行，并且街景按设计执行，所以我不认为它是 Flash 插件，正如各种论坛上的许多帖子所暗示的那样。

对此有什么想法吗？

这是链接：

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-10T03:40:31.910

页面直接在css下面生成。所以，摆脱这个CSS。

415 行：

```
img {
  height:auto !important;
 //max-width:100% !important;   // <- remove this css
  ...
} 
```

![在此处输入图像描述](../Images/6992faed569cb7acd691d84493ce20dc.png)

# java - 处理由 void onMessage() 接收的值并将该值传递给不同的函数

> ID：13728388
> 
> 赞同：0
> 
> 时间：2012-12-05T16:56:49.907
> 
> 标签：java, jms, parameter-passing

## 设想

我通过实现 messageListener 来使用来自 WebLogic 队列的消息。onMessage() 调用成功，接收到的消息可以从 onMessage 函数中打印出来。

## 要求

收到此 msgText 后立即处理并将处理后的结果返回给调用方法。

## 代码

```
@Override 
```

公共无效onMessage（消息消息）{

```
try {
    String msgText;
    if (msg instanceof TextMessage) {
        msgText = ((TextMessage) msg).getText();
    } else {
        msgText = msg.toString();
    }
    System.out.println(msgText);

} catch (JMSException ex) {
    ex.printStackTrace();
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T17:50:09.980

您是否尝试将处理消息的结果返回给调用函数？如果是这样，我认为这里不可能，因为这将是一个异步调用。

如果没有，请清楚地发布您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T08:13:17.437

这是不可能的，因为您的消息驱动 bean 不知道哪个方法将消息发布到消息队列上，并且通常在 MDB 中没有回调机制。

但是，有一个技巧可以提供帮助。它被称为[TemporaryQueue](http://docs.oracle.com/javaee/6/api/javax/jms/TemporaryQueue.html)，应该按如下方式使用。在消息生产者中添加这部分代码：

```
// OPEN CONNECTION AND CREATE SESSION
..
TemporaryQueue tempQueue = session.createTemporaryQueue();
msg.setJMSReplyTo(tempQueue);
// SEND MESSAGE
..
MessageConsumer mc = session.createConsumer(tempQueue);
Message retMsg = mc.receive(); //WAITING FOR A RESPONSE.. 
```

在消费者（你的消息驱动 bean）中使用这个临时队列：

```
Queue destination = (Queue) message.getJMSReplyTo();
// CREATE PRODUCER, CREATE MESSAGE AND SEND THE MESSAGE 
```

这样您将模拟回调机制。对象`retMsg`应该包含处理结果，你就完成了。

# sql - 使用 SQL ROW_NUMBER 分页

> ID：13728391
> 
> 赞同：1
> 
> 时间：2012-12-05T16:57:00.140
> 
> 标签：sql

我想以分页格式返回搜索结果。但是，我似乎无法成功获得查询的前 10 个结果。

问题是返回的“RowNum”类似于 405、687、1024 等。我希望它们重新编号为 1、2、3、4、5 等，这样当我在第 1 行和第 20 行之间指定时，我得到第一个20 个搜索结果。相反，因为数字更大，我没有得到 1 到 10 之间的结果。

如果我将 RowNum 条件更改为：

```
AND RowNum < 20000 
```

我得到了很多结果

这是sql：

```
 SELECT  *
            FROM    ( SELECT    ROW_NUMBER() OVER ( ORDER BY DocumentID ) AS RowNum, *
                      FROM      Table
                    ) AS RowConstrainedResult
            WHERE   RowNum >= 1
                AND RowNum < 20
                                AND Title LIKE '%diabetes%'
                                AND Title LIKE '%risk%' 
```

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T17:00:53.460

您需要`WHERE`在子查询中应用 。我会改用 CTE（假设 SQL-Server）::

```
WITH CTE AS
(
  SELECT  T.*, 
     ROW_NUMBER() OVER ( ORDER BY DocumentID ) AS RowNum
  FROM Table T
  WHERE Title LIKE '%diabetes%' AND Title LIKE '%risk%'
)
SELECT * FROM CTE 
WHERE RowNum >= 1 AND RowNum < 20 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T17:01:16.970

您需要将您的`where`条件移动到子查询中：

```
 SELECT  *
        FROM    ( SELECT    ROW_NUMBER() OVER ( ORDER BY DocumentID ) AS RowNum, *
                  FROM      Table
                  where  Title LIKE '%diabetes%'
                            AND Title LIKE '%risk%'
                ) AS RowConstrainedResult
        WHERE   RowNum >= 1 AND RowNum < 20 
```

`rownum`变量按顺序分配给所有行。您没有选择前 20 名中的任何一个。

# python - 移动平均线或移动平均线

> ID：13728392
> 
> 赞同：254
> 
> 时间：2012-12-05T16:57:05.240
> 
> 标签：python, numpy, scipy, moving-average

是否有用于 Python 的 SciPy 函数或 NumPy 函数或模块来计算给定特定窗口的一维数组的运行平均值？

* * *

## 回答 #1

> 赞同：342
> 
> 时间：2014-03-24T22:01:33.470

**更新：**已经提出了更有效的解决方案，[`uniform_filter1d`可能`scipy`](https://stackoverflow.com/a/43200476/675674)是“标准”第 3 方库中最好的，并且还提供了一些更新或专门的库。

* * *

您可以[`np.convolve`](http://docs.scipy.org/doc/numpy/reference/generated/numpy.convolve.html)为此使用：

```
np.convolve(x, np.ones(N)/N, mode='valid') 
```

### 解释

运行均值是[卷积](https://en.wikipedia.org/wiki/Convolution)数学运算的一种情况。对于运行平均值，您沿着输入滑动一个窗口并计算窗口内容的平均值。对于离散的一维信号，卷积是一样的，除了计算任意线性组合而不是平均值，即，将每个元素乘以相应的系数并将结果相加。这些系数，一个对应于窗口中每个位置的系数，有时称为卷积*核*。N 个值的算术平均值是`(x_1 + x_2 + ... + x_N) / N`，所以对应的核是`(1/N, 1/N, ..., 1/N)`，这正是我们使用 得到的`np.ones(N)/N`。

### 边缘

的`mode`参数`np.convolve`指定如何处理边缘。我在这里选择了这种`valid`模式，因为我认为这是大多数人期望运行均值工作的方式，但您可能有其他优先事项。这是一个说明模式之间差异的图：

```
import numpy as np
import matplotlib.pyplot as plt
modes = ['full', 'same', 'valid']
for m in modes:
    plt.plot(np.convolve(np.ones(200), np.ones(50)/50, mode=m));
plt.axis([-10, 251, -.1, 1.1]);
plt.legend(modes, loc='lower center');
plt.show() 
```

![运行均值卷积模式](../Images/68e3620d9ae2c21f470bbc2231796189.png)

* * *

## 回答 #2

> 赞同：180
> 
> 时间：2014-12-28T22:50:57.413

## 高效的解决方案

卷积比简单的方法要好得多，但是（我猜）它使用 FFT，因此速度很慢。然而，专门用于计算运行意味着以下方法可以正常工作

```
def running_mean(x, N):
    cumsum = numpy.cumsum(numpy.insert(x, 0, 0)) 
    return (cumsum[N:] - cumsum[:-N]) / float(N) 
```

要检查的代码

```
In[3]: x = numpy.random.random(100000)
In[4]: N = 1000
In[5]: %timeit result1 = numpy.convolve(x, numpy.ones((N,))/N, mode='valid')
10 loops, best of 3: 41.4 ms per loop
In[6]: %timeit result2 = running_mean(x, N)
1000 loops, best of 3: 1.04 ms per loop 
```

请注意，两种方法是等效的`numpy.allclose(result1, result2)`。`True`N越大，时间差越大。

### 警告：虽然 cumsum 更快，但浮点错误会增加，这可能导致您的结果无效/不正确/不可接受

[评论在这里指出了这个浮点错误问题，但我在答案中让它更加明显。](https://stackoverflow.com/questions/13728392/moving-average-or-running-mean/27681394#comment82346417_27681394).

```
# demonstrate loss of precision with only 100,000 points
np.random.seed(42)
x = np.random.randn(100000)+1e6
y1 = running_mean_convolve(x, 10)
y2 = running_mean_cumsum(x, 10)
assert np.allclose(y1, y2, rtol=1e-12, atol=0) 
```

*   您累积的点越多，浮点误差就越大（因此 1e5 点很明显，1e6 点更重要，超过 1e6 并且您可能想要重置累加器）
*   您可以通过使用作弊，[`np.longdouble`](https://docs.scipy.org/doc/numpy-1.13.0/user/basics.types.html)但是对于相对大量的点，您的浮点错误仍然会变得很重要（大约> 1e5，但取决于您的数据）
*   您可以绘制错误并看到它相对快速地增加
*   [卷积解决方案](https://stackoverflow.com/a/22621523/52074)较慢，但没有这种浮点精度损失
*   [uniform_filter1d 解决方案](https://stackoverflow.com/a/43200476/52074)比这个 cumsum 解决方案更快并且没有这种浮点精度损失

* * *

## 回答 #3

> 赞同：92
> 
> 时间：2015-05-09T14:51:13.493

**更新：**下面的示例显示了`pandas.rolling_mean`已在最新版本的 pandas 中删除的旧功能。该函数调用的现代等价物将使用 [pandas.Series.rolling](https://pandas.pydata.org/docs/reference/api/pandas.Series.rolling.html)：

```
In [8]: pd.Series(x).rolling(window=N).mean().iloc[N-1:].values
Out[8]: 
array([ 0.49815397,  0.49844183,  0.49840518, ...,  0.49488191,
        0.49456679,  0.49427121]) 
```

* * *

[pandas](http://pandas.pydata.org/)比 NumPy 或 SciPy 更适合这个。它的功能[rolling_mean](http://pandas.pydata.org/pandas-docs/stable/computation.html#moving-rolling-statistics-moments)可以方便地完成这项工作。当输入是一个数组时，它还会返回一个 NumPy 数组。

任何定制的纯 Python 实现都很难`rolling_mean`在性能上被击败。以下是针对两个建议解决方案的示例性能：

```
In [1]: import numpy as np

In [2]: import pandas as pd

In [3]: def running_mean(x, N):
   ...:     cumsum = np.cumsum(np.insert(x, 0, 0)) 
   ...:     return (cumsum[N:] - cumsum[:-N]) / N
   ...:

In [4]: x = np.random.random(100000)

In [5]: N = 1000

In [6]: %timeit np.convolve(x, np.ones((N,))/N, mode='valid')
10 loops, best of 3: 172 ms per loop

In [7]: %timeit running_mean(x, N)
100 loops, best of 3: 6.72 ms per loop

In [8]: %timeit pd.rolling_mean(x, N)[N-1:]
100 loops, best of 3: 4.74 ms per loop

In [9]: np.allclose(pd.rolling_mean(x, N)[N-1:], running_mean(x, N))
Out[9]: True 
```

关于如何处理边缘值也有很好的选择。

* * *

## 回答 #4

> 赞同：73
> 
> 时间：2017-04-04T07:06:08.567

您可以使用[scipy.ndimage.filters.uniform_filter1d](https://docs.scipy.org/doc/scipy/reference/generated/scipy.ndimage.uniform_filter1d.html)：

```
import numpy as np
from scipy.ndimage.filters import uniform_filter1d
N = 1000
x = np.random.random(100000)
y = uniform_filter1d(x, size=N) 
```

`uniform_filter1d`：

*   给出具有相同 numpy 形状的输出（即点数）
*   允许多种方式来处理`'reflect'`默认的边界，但在我的情况下，我更想要`'nearest'`

[它也相当快（比上面给出的 cumsum 方法快](https://stackoverflow.com/a/27681394/52074)近 50 倍，快`np.convolve`2-5 倍）：

```
%timeit y1 = np.convolve(x, np.ones((N,))/N, mode='same')
100 loops, best of 3: 9.28 ms per loop

%timeit y2 = uniform_filter1d(x, size=N)
10000 loops, best of 3: 191 µs per loop 
```

这里有 3 个函数可以让您比较不同实现的错误/速度：

```
from __future__ import division
import numpy as np
import scipy.ndimage.filters as ndif
def running_mean_convolve(x, N):
    return np.convolve(x, np.ones(N) / float(N), 'valid')
def running_mean_cumsum(x, N):
    cumsum = np.cumsum(np.insert(x, 0, 0))
    return (cumsum[N:] - cumsum[:-N]) / float(N)
def running_mean_uniform_filter1d(x, N):
    return ndif.uniform_filter1d(x, N, mode='constant', origin=-(N//2))[:-(N-1)] 
```

* * *

## 回答 #5

> 赞同：52
> 
> 时间：2012-12-05T21:21:38.550

您可以使用以下方法计算运行平均值：

```
import numpy as np

def runningMean(x, N):
    y = np.zeros((len(x),))
    for ctr in range(len(x)):
         y[ctr] = np.sum(x[ctr:(ctr+N)])
    return y/N 
```

但它很慢。

幸运的是，numpy 包含一个[卷积](http://docs.scipy.org/doc/numpy/reference/generated/numpy.convolve.html)函数，我们可以使用它来加快速度。运行均值相当于`x`与一个很长的向量进行卷积`N`，所有成员都等于`1/N`。convolve 的 numpy 实现包括起始瞬态，因此您必须删除前 N-1 个点：

```
def runningMeanFast(x, N):
    return np.convolve(x, np.ones((N,))/N)[(N-1):] 
```

在我的机器上，快速版本要快 20-30 倍，具体取决于输入向量的长度和平均窗口的大小。

请注意，convolve 确实包含一个`'same'`似乎应该解决起始瞬态问题的模式，但它在开始和结束之间拆分了它。

* * *

## 回答 #6

> 赞同：29
> 
> 时间：2017-06-28T08:29:40.840

对于一个简短、快速的解决方案，它在一个循环中完成整个事情，没有依赖关系，下面的代码效果很好。

```
mylist = [1, 2, 3, 4, 5, 6, 7]
N = 3
cumsum, moving_aves = [0], []

for i, x in enumerate(mylist, 1):
    cumsum.append(cumsum[i-1] + x)
    if i>=N:
        moving_ave = (cumsum[i] - cumsum[i-N])/N
        #can do stuff with moving_ave here
        moving_aves.append(moving_ave) 
```

* * *

## 回答 #7

> 赞同：27
> 
> 时间：2015-10-10T15:21:39.173

> 或用于计算的python模块

在我在 Tradewave.net 的测试中，TA-lib 总是获胜：

```
import talib as ta
import numpy as np
import pandas as pd
import scipy
from scipy import signal
import time as t

PAIR = info.primary_pair
PERIOD = 30

def initialize():
    storage.reset()
    storage.elapsed = storage.get('elapsed', [0,0,0,0,0,0])

def cumsum_sma(array, period):
    ret = np.cumsum(array, dtype=float)
    ret[period:] = ret[period:] - ret[:-period]
    return ret[period - 1:] / period

def pandas_sma(array, period):
    return pd.rolling_mean(array, period)

def api_sma(array, period):
    # this method is native to Tradewave and does NOT return an array
    return (data[PAIR].ma(PERIOD))

def talib_sma(array, period):
    return ta.MA(array, period)

def convolve_sma(array, period):
    return np.convolve(array, np.ones((period,))/period, mode='valid')

def fftconvolve_sma(array, period):    
    return scipy.signal.fftconvolve(
        array, np.ones((period,))/period, mode='valid')    

def tick():

    close = data[PAIR].warmup_period('close')

    t1 = t.time()
    sma_api = api_sma(close, PERIOD)
    t2 = t.time()
    sma_cumsum = cumsum_sma(close, PERIOD)
    t3 = t.time()
    sma_pandas = pandas_sma(close, PERIOD)
    t4 = t.time()
    sma_talib = talib_sma(close, PERIOD)
    t5 = t.time()
    sma_convolve = convolve_sma(close, PERIOD)
    t6 = t.time()
    sma_fftconvolve = fftconvolve_sma(close, PERIOD)
    t7 = t.time()

    storage.elapsed[-1] = storage.elapsed[-1] + t2-t1
    storage.elapsed[-2] = storage.elapsed[-2] + t3-t2
    storage.elapsed[-3] = storage.elapsed[-3] + t4-t3
    storage.elapsed[-4] = storage.elapsed[-4] + t5-t4
    storage.elapsed[-5] = storage.elapsed[-5] + t6-t5    
    storage.elapsed[-6] = storage.elapsed[-6] + t7-t6        

    plot('sma_api', sma_api)  
    plot('sma_cumsum', sma_cumsum[-5])
    plot('sma_pandas', sma_pandas[-10])
    plot('sma_talib', sma_talib[-15])
    plot('sma_convolve', sma_convolve[-20])    
    plot('sma_fftconvolve', sma_fftconvolve[-25])

def stop():

    log('ticks....: %s' % info.max_ticks)

    log('api......: %.5f' % storage.elapsed[-1])
    log('cumsum...: %.5f' % storage.elapsed[-2])
    log('pandas...: %.5f' % storage.elapsed[-3])
    log('talib....: %.5f' % storage.elapsed[-4])
    log('convolve.: %.5f' % storage.elapsed[-5])    
    log('fft......: %.5f' % storage.elapsed[-6]) 
```

结果：

```
[2015-01-31 23:00:00] ticks....: 744
[2015-01-31 23:00:00] api......: 0.16445
[2015-01-31 23:00:00] cumsum...: 0.03189
[2015-01-31 23:00:00] pandas...: 0.03677
[2015-01-31 23:00:00] talib....: 0.00700  # <<< Winner!
[2015-01-31 23:00:00] convolve.: 0.04871
[2015-01-31 23:00:00] fft......: 0.22306 
```

[![在此处输入图像描述](../Images/771d5110fc254df4f46e116d25135817.png)](https://i.stack.imgur.com/PkKQq.png)

* * *

## 回答 #8

> 赞同：23
> 
> 时间：2012-12-05T19:23:12.210

有关即用型解决方案，请参阅[https://scipy-cookbook.readthedocs.io/items/SignalSmooth.html](https://scipy-cookbook.readthedocs.io/items/SignalSmooth.html)。它提供`flat`窗口类型的运行平均值。请注意，这比简单的自己动手的卷积方法要复杂一些，因为它试图通过反映数据来处理数据开头和结尾的问题（这在您的情况下可能有效，也可能无效。 ..)。

首先，您可以尝试：

```
a = np.random.random(100)
plt.plot(a)
b = smooth(a, window='flat')
plt.plot(b) 
```

* * *

## 回答 #9

> 赞同：17
> 
> 时间：2016-11-16T03:57:50.270

我知道这是一个老问题，但这是一个不使用任何额外数据结构或库的解决方案。它与输入列表的元素数量呈线性关系，我想不出任何其他方法来提高效率（实际上，如果有人知道分配结果的更好方法，请告诉我）。

**注意：**使用 numpy 数组而不是列表会快得多，但我想消除所有依赖项。也可以通过多线程执行来提高性能

该函数假设输入列表是一维的，所以要小心。

```
### Running mean/Moving average
def running_mean(l, N):
    sum = 0
    result = list( 0 for x in l)

    for i in range( 0, N ):
        sum = sum + l[i]
        result[i] = sum / (i+1)

    for i in range( N, len(l) ):
        sum = sum - l[i-N] + l[i]
        result[i] = sum / N

    return result 
```

**例子**

假设我们有一个列表`data = [ 1, 2, 3, 4, 5, 6 ]`，我们想要计算周期为 3 的滚动平均值，并且您还想要一个与输入列表大小相同的输出列表（这是最常见的情况）。

第一个元素的索引为 0，所以滚动平均值应该在索引 -2、-1 和 0 的元素上计算。显然我们没有 data[-2] 和 data[-1]（除非你想使用特殊的边界条件），所以我们假设这些元素是 0。这相当于对列表进行零填充，除了我们实际上不填充它，只跟踪需要填充的索引（从 0 到 N-1）。

所以，对于前 N 个元素，我们只是不断地将元素累加到一个累加器中。

```
result[0] = (0 + 0 + 1) / 3  = 0.333    ==   (sum + 1) / 3
result[1] = (0 + 1 + 2) / 3  = 1        ==   (sum + 2) / 3
result[2] = (1 + 2 + 3) / 3  = 2        ==   (sum + 3) / 3 
```

从元素 N+1 向前简单的累加是行不通的。我们期望`result[3] = (2 + 3 + 4)/3 = 3`，但这与`(sum + 4)/3 = 3.333`.

计算正确值的方法是减去`data[0] = 1`，`sum+4`从而给出 `sum + 4 - 1 = 9`。

发生这种情况是因为 current `sum = data[0] + data[1] + data[2]`，但对于每个`i >= N`因为在减法之前`sum`is也是如此`data[i-N] + ... + data[i-2] + data[i-1]`。

* * *

## 回答 #10

> 赞同：15
> 
> 时间：2019-01-17T11:47:28.870

我觉得这可以使用[瓶颈优雅地解决](https://github.com/kwgoodman/bottleneck)

请参阅下面的基本示例：

```
import numpy as np
import bottleneck as bn

a = np.random.randint(4, 1000, size=100)
mm = bn.move_mean(a, window=5, min_count=1) 
```

*   “mm”是“a”的移动平均值。

*   “窗口”是要考虑的移动平均值的最大条目数。

*   “min_count”是移动均值考虑的最小条目数（例如，对于前几个元素或数组是否具有 nan 值）。

好的部分是瓶颈有助于处理 nan 值，它也非常有效。

* * *

## 回答 #11

> 赞同：9
> 
> 时间：2015-03-09T15:42:17.503

我还没有检查这有多快，但你可以尝试：

```
from collections import deque

cache = deque() # keep track of seen values
n = 10          # window size
A = xrange(100) # some dummy iterable
cum_sum = 0     # initialize cumulative sum

for t, val in enumerate(A, 1):
    cache.append(val)
    cum_sum += val
    if t < n:
        avg = cum_sum / float(t)
    else:                           # if window is saturated,
        cum_sum -= cache.popleft()  # subtract oldest value
        avg = cum_sum / float(n) 
```

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2016-10-17T12:21:30.433

聚会有点晚了，但我做了我自己的小函数，它不会用零环绕末端或填充物，然后也可以用来找到平均值。作为进一步的处理，它还在线性间隔的点处重新采样信号。随意自定义代码以获得其他功能。

该方法是具有归一化高斯核的简单矩阵乘法。

```
def running_mean(y_in, x_in, N_out=101, sigma=1):
    '''
    Returns running mean as a Bell-curve weighted average at evenly spaced
    points. Does NOT wrap signal around, or pad with zeros.

    Arguments:
    y_in -- y values, the values to be smoothed and re-sampled
    x_in -- x values for array

    Keyword arguments:
    N_out -- NoOf elements in resampled array.
    sigma -- 'Width' of Bell-curve in units of param x .
    '''
    import numpy as np
    N_in = len(y_in)

    # Gaussian kernel
    x_out = np.linspace(np.min(x_in), np.max(x_in), N_out)
    x_in_mesh, x_out_mesh = np.meshgrid(x_in, x_out)
    gauss_kernel = np.exp(-np.square(x_in_mesh - x_out_mesh) / (2 * sigma**2))
    # Normalize kernel, such that the sum is one along axis 1
    normalization = np.tile(np.reshape(np.sum(gauss_kernel, axis=1), (N_out, 1)), (1, N_in))
    gauss_kernel_normalized = gauss_kernel / normalization
    # Perform running average as a linear operation
    y_out = gauss_kernel_normalized @ y_in

    return y_out, x_out 
```

添加正态分布噪声的正弦信号的简单用法： [![在此处输入图像描述](../Images/6d12274ae2ddce2caefe26c3d7713c6c.png)](https://i.stack.imgur.com/9jgMM.png)

* * *

## 回答 #13

> 赞同：7
> 
> 时间：2018-06-16T13:29:31.827

我建议 pandas 更快地执行此操作，而不是 numpy 或 scipy：

```
df['data'].rolling(3).mean() 
```

这采用“数据”列的 3 个周期的移动平均线 (MA)。您还可以计算移位的版本，例如排除当前单元格的版本（向后移位）可以很容易地计算为：

```
df['data'].shift(periods=1).rolling(3).mean() 
```

* * *

## 回答 #14

> 赞同：7
> 
> 时间：2018-11-04T15:05:04.517

**Python标准库解决方案**

这个生成器函数接受一个可迭代的和一个窗口大小`N` ，并产生窗口内当前值的平均值。它使用 a [`deque`](https://docs.python.org/3.7/library/collections.html#collections.deque)，这是一种类似于列表的数据结构，但针对*两个端点*`pop`的快速修改 ( , `append`)进行了优化。

 *```
from collections import deque
from itertools import islice

def sliding_avg(iterable, N):        
    it = iter(iterable)
    window = deque(islice(it, N))        
    num_vals = len(window)

    if num_vals < N:
        msg = 'window size {} exceeds total number of values {}'
        raise ValueError(msg.format(N, num_vals))

    N = float(N) # force floating point division if using Python 2
    s = sum(window)

    while True:
        yield s/N
        try:
            nxt = next(it)
        except StopIteration:
            break
        s = s - window.popleft() + nxt
        window.append(nxt) 
```

这是实际执行的功能：

```
>>> values = range(100)
>>> N = 5
>>> window_avg = sliding_avg(values, N)
>>> 
>>> next(window_avg) # (0 + 1 + 2 + 3 + 4)/5
>>> 2.0
>>> next(window_avg) # (1 + 2 + 3 + 4 + 5)/5
>>> 3.0
>>> next(window_avg) # (2 + 3 + 4 + 5 + 6)/5
>>> 4.0 
```

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2016-06-03T00:00:18.677

**另一种***不*使用`numpy`或找到移动平均线的方法`pandas`

```
import itertools
sample = [2, 6, 10, 8, 11, 10]
list(itertools.starmap(
    lambda a,b: b/a, 
    enumerate(itertools.accumulate(sample), 1))
) 
```

将打印`[2.0, 4.0, 6.0, 6.5, 7.4, 7.833333333333333]`

*   2.0 = (2)/1
*   4.0 = (2 + 6) / 2
*   6.0 = (2 + 6 + 10) / 3
*   ...

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2018-07-25T18:52:17.637

上面有很多关于计算运行平均值的答案。我的回答增加了两个额外的功能：

1.  忽略 nan 值
2.  计算 N 个相邻值的平均值，不包括感兴趣的值本身

第二个特征对于确定哪些值与总体趋势相差一定量特别有用。

我使用 numpy.cumsum 因为它是最省时的方法（[参见上面 Alleo 的回答](https://stackoverflow.com/a/27681394/8915665)）。

```
N=10 # number of points to test on each side of point of interest, best if even
padded_x = np.insert(np.insert( np.insert(x, len(x), np.empty(int(N/2))*np.nan), 0, np.empty(int(N/2))*np.nan ),0,0)
n_nan = np.cumsum(np.isnan(padded_x))
cumsum = np.nancumsum(padded_x) 
window_sum = cumsum[N+1:] - cumsum[:-(N+1)] - x # subtract value of interest from sum of all values within window
window_n_nan = n_nan[N+1:] - n_nan[:-(N+1)] - np.isnan(x)
window_n_values = (N - window_n_nan)
movavg = (window_sum) / (window_n_values) 
```

此代码仅适用于 Ns。可以通过更改 padded_x 和 n_nan 的 np.insert 来调整奇数。

示例输出（黑色为 raw，蓝色为 movavg）： [![原始数据（黑色）和每个值周围 10 个点的移动平均值（蓝色），不包括该值。 nan 值被忽略。](../Images/7ef8615dd4377685b5f1d16de71e7305.png)](https://i.stack.imgur.com/6Tqr9.png)

此代码可以很容易地修改为删除从小于 cutoff = 3 个非 nan 值计算的所有移动平均值。

```
window_n_values = (N - window_n_nan).astype(float) # dtype must be float to set some values to nan
cutoff = 3
window_n_values[window_n_values<cutoff] = np.nan
movavg = (window_sum) / (window_n_values) 
```

[![原始数据（黑色）和移动平均值（蓝色），同时忽略任何少于 3 个非 nan 值的窗口](../Images/854a2935ab53b8d418ad09cb9760241b.png)](https://i.stack.imgur.com/wfEnA.png)

* * *

## 回答 #17

> 赞同：5
> 
> 时间：2018-08-05T21:21:13.447

[mab](https://stackoverflow.com/users/3703716/mab)有一条评论埋在上面有这种方法 的[答案之一中。](https://stackoverflow.com/a/30141358/4549682)[`bottleneck`](https://github.com/kwgoodman/bottleneck)有`move_mean`一个简单的移动平均线：

```
import numpy as np
import bottleneck as bn

a = np.arange(10) + np.random.random(10)

mva = bn.move_mean(a, window=2, min_count=1) 
```

`min_count`是一个方便的参数，它基本上会将移动平均线带到数组中的那个点。如果您不设置`min_count`，它将等于`window`，并且所有`window`分数都将是`nan`。

* * *

## 回答 #18

> 赞同：5
> 
> 时间：2019-10-29T08:24:54.543

使用@Aikude 的变量，我写了一条线。

```
import numpy as np

mylist = [1, 2, 3, 4, 5, 6, 7]
N = 3

mean = [np.mean(mylist[x:x+N]) for x in range(len(mylist)-N+1)]
print(mean)

>>> [2.0, 3.0, 4.0, 5.0, 6.0] 
```

* * *

## 回答 #19

> 赞同：5
> 
> 时间：2020-03-13T15:30:18.847

所有上述解决方案都很差，因为它们缺乏

*   由于原生 python 而不是 numpy 矢量化实现，速度快，
*   由于使用不当导致的数值稳定性`numpy.cumsum`，或
*   由于`O(len(x) * w)`实现为卷积的速度。

给定

```
import numpy
m = 10000
x = numpy.random.rand(m)
w = 1000 
```

请注意，`x_[:w].sum()`等于`x[:w-1].sum()`。因此，对于第一个平均值，`numpy.cumsum(...)`添加`x[w] / w`（通过`x_[w+1] / w`）和减去`0`（从`x_[0] / w`）。这导致`x[0:w].mean()`

通过 cumsum，您将通过另外`x[w+1] / w`加减来更新第二个平均值`x[0] / w`，从而得到`x[1:w+1].mean()`.

这种情况一直持续到`x[-w:].mean()`达到。

```
x_ = numpy.insert(x, 0, 0)
sliding_average = x_[:w].sum() / w + numpy.cumsum(x_[w:] - x_[:-w]) / w 
```

该解决方案是矢量化的`O(m)`、可读的和数值稳定的。

* * *

## 回答 #20

> 赞同：4
> 
> 时间：2017-01-02T00:28:53.450

这个问题现在比 NeXuS 上个月写的时候*还要老，但我喜欢他的代码如何处理边缘情况。*然而，因为它是一个“简单的移动平均线”，它的结果落后于它们所应用的数据。我认为以比 NumPy 的模式更令人满意的方式处理边缘情况`valid`，`same`并且`full`可以通过对`convolution()`基于方法应用类似的方法来实现。

我的贡献使用了一个中央运行平均值来将其结果与他们的数据保持一致。当可用于全尺寸窗口的点太少时，将根据阵列边缘的连续较小窗口计算运行平均值。[实际上，从越来越大的窗口开始，但这是一个实现细节。]

```
import numpy as np

def running_mean(l, N):
    # Also works for the(strictly invalid) cases when N is even.
    if (N//2)*2 == N:
        N = N - 1
    front = np.zeros(N//2)
    back = np.zeros(N//2)

    for i in range(1, (N//2)*2, 2):
        front[i//2] = np.convolve(l[:i], np.ones((i,))/i, mode = 'valid')
    for i in range(1, (N//2)*2, 2):
        back[i//2] = np.convolve(l[-i:], np.ones((i,))/i, mode = 'valid')
    return np.concatenate([front, np.convolve(l, np.ones((N,))/N, mode = 'valid'), back[::-1]]) 
```

它相对较慢，因为它使用`convolve()`. 并且可能会被真正的 Pythonista 修饰很多，但是，我相信这个想法是成立的。

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2018-01-27T02:52:25.213

**仅使用 Python 标准库（内存高效）**

只需给出`deque`仅使用标准库的另一个版本。令我惊讶的是，大多数答案都使用`pandas`or `numpy`。

```
def moving_average(iterable, n=3):
    d = deque(maxlen=n)
    for i in iterable:
        d.append(i)
        if len(d) == n:
            yield sum(d)/n

r = moving_average([40, 30, 50, 46, 39, 44])
assert list(r) == [40.0, 42.0, 45.0, 43.0] 
```

实际上我[在 python 文档中找到了另一个实现](https://docs.python.org/3/library/collections.html#deque-recipes)

```
def moving_average(iterable, n=3):
    # moving_average([40, 30, 50, 46, 39, 44]) --> 40.0 42.0 45.0 43.0
    # http://en.wikipedia.org/wiki/Moving_average
    it = iter(iterable)
    d = deque(itertools.islice(it, n-1))
    d.appendleft(0)
    s = sum(d)
    for elem in it:
        s += elem - d.popleft()
        d.append(elem)
        yield s / n 
```

然而，在我看来，实现比它应该的要复杂一些。但它必须在标准 python 文档中是有原因的，有人可以评论我的实现和标准文档吗？

* * *

## 回答 #22

> 赞同：3
> 
> 时间：2018-02-07T22:42:45.460

通过阅读其他答案，我认为这不是问题所要求的，但我来到这里需要保持一个不断增长的值列表的运行平均值。

因此，如果您想保留从某处（站点、测量设备等）获取的值的列表并`n`更新最后值的平均值，您可以使用下面的代码，这样可以最大限度地减少添加新值的工作量要素：

```
class Running_Average(object):
    def __init__(self, buffer_size=10):
        """
        Create a new Running_Average object.

        This object allows the efficient calculation of the average of the last
        `buffer_size` numbers added to it.

        Examples
        --------
        >>> a = Running_Average(2)
        >>> a.add(1)
        >>> a.get()
        1.0
        >>> a.add(1)  # there are two 1 in buffer
        >>> a.get()
        1.0
        >>> a.add(2)  # there's a 1 and a 2 in the buffer
        >>> a.get()
        1.5
        >>> a.add(2)
        >>> a.get()  # now there's only two 2 in the buffer
        2.0
        """
        self._buffer_size = int(buffer_size)  # make sure it's an int
        self.reset()

    def add(self, new):
        """
        Add a new number to the buffer, or replaces the oldest one there.
        """
        new = float(new)  # make sure it's a float
        n = len(self._buffer)
        if n < self.buffer_size:  # still have to had numbers to the buffer.
            self._buffer.append(new)
            if self._average != self._average:  # ~ if isNaN().
                self._average = new  # no previous numbers, so it's new.
            else:
                self._average *= n  # so it's only the sum of numbers.
                self._average += new  # add new number.
                self._average /= (n+1)  # divide by new number of numbers.
        else:  # buffer full, replace oldest value.
            old = self._buffer[self._index]  # the previous oldest number.
            self._buffer[self._index] = new  # replace with new one.
            self._index += 1  # update the index and make sure it's...
            self._index %= self.buffer_size  # ... smaller than buffer_size.
            self._average -= old/self.buffer_size  # remove old one...
            self._average += new/self.buffer_size  # ...and add new one...
            # ... weighted by the number of elements.

    def __call__(self):
        """
        Return the moving average value, for the lazy ones who don't want
        to write .get .
        """
        return self._average

    def get(self):
        """
        Return the moving average value.
        """
        return self()

    def reset(self):
        """
        Reset the moving average.

        If for some reason you don't want to just create a new one.
        """
        self._buffer = []  # could use np.empty(self.buffer_size)...
        self._index = 0  # and use this to keep track of how many numbers.
        self._average = float('nan')  # could use np.NaN .

    def get_buffer_size(self):
        """
        Return current buffer_size.
        """
        return self._buffer_size

    def set_buffer_size(self, buffer_size):
        """
        >>> a = Running_Average(10)
        >>> for i in range(15):
        ...     a.add(i)
        ...
        >>> a()
        9.5
        >>> a._buffer  # should not access this!!
        [10.0, 11.0, 12.0, 13.0, 14.0, 5.0, 6.0, 7.0, 8.0, 9.0]

        Decreasing buffer size:
        >>> a.buffer_size = 6
        >>> a._buffer  # should not access this!!
        [9.0, 10.0, 11.0, 12.0, 13.0, 14.0]
        >>> a.buffer_size = 2
        >>> a._buffer
        [13.0, 14.0]

        Increasing buffer size:
        >>> a.buffer_size = 5
        Warning: no older data available!
        >>> a._buffer
        [13.0, 14.0]

        Keeping buffer size:
        >>> a = Running_Average(10)
        >>> for i in range(15):
        ...     a.add(i)
        ...
        >>> a()
        9.5
        >>> a._buffer  # should not access this!!
        [10.0, 11.0, 12.0, 13.0, 14.0, 5.0, 6.0, 7.0, 8.0, 9.0]
        >>> a.buffer_size = 10  # reorders buffer!
        >>> a._buffer
        [5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0, 12.0, 13.0, 14.0]
        """
        buffer_size = int(buffer_size)
        # order the buffer so index is zero again:
        new_buffer = self._buffer[self._index:]
        new_buffer.extend(self._buffer[:self._index])
        self._index = 0
        if self._buffer_size < buffer_size:
            print('Warning: no older data available!')  # should use Warnings!
        else:
            diff = self._buffer_size - buffer_size
            print(diff)
            new_buffer = new_buffer[diff:]
        self._buffer_size = buffer_size
        self._buffer = new_buffer

    buffer_size = property(get_buffer_size, set_buffer_size) 
```

您可以使用以下方法对其进行测试：

```
def graph_test(N=200):
    import matplotlib.pyplot as plt
    values = list(range(N))
    values_average_calculator = Running_Average(N/2)
    values_averages = []
    for value in values:
        values_average_calculator.add(value)
        values_averages.append(values_average_calculator())
    fig, ax = plt.subplots(1, 1)
    ax.plot(values, label='values')
    ax.plot(values_averages, label='averages')
    ax.grid()
    ax.set_xlim(0, N)
    ax.set_ylim(0, N)
    fig.show() 
```

这使：

[![值及其平均值作为值的函数 #](../Images/ea2ca4c370536a75447b5e26e3f0a66e.png)](https://i.stack.imgur.com/KbE6n.png)

* * *

## 回答 #23

> 赞同：3
> 
> 时间：2018-11-01T09:36:12.287

出于教育目的，让我再添加两个 Numpy 解决方案（比 cumsum 解决方案慢）：

```
import numpy as np
from numpy.lib.stride_tricks import as_strided

def ra_strides(arr, window):
    ''' Running average using as_strided'''
    n = arr.shape[0] - window + 1
    arr_strided = as_strided(arr, shape=[n, window], strides=2*arr.strides)
    return arr_strided.mean(axis=1)

def ra_add(arr, window):
    ''' Running average using add.reduceat'''
    n = arr.shape[0] - window + 1
    indices = np.array([0, window]*n) + np.repeat(np.arange(n), 2)
    arr = np.append(arr, 0)
    return np.add.reduceat(arr, indices )[::2]/window 
```

使用的函数：[as_strided](https://docs.scipy.org/doc/numpy-1.15.1/reference/generated/numpy.lib.stride_tricks.as_strided.html)，[add.reduceat](https://docs.scipy.org/doc/numpy-1.15.0/reference/generated/numpy.ufunc.reduceat.html)

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2018-01-12T11:33:24.813

虽然这里有这个问题的解决方案，但请看看我的解决方案。它非常简单并且运行良好。

```
import numpy as np
dataset = np.asarray([1, 2, 3, 4, 5, 6, 7])
ma = list()
window = 3
for t in range(0, len(dataset)):
    if t+window <= len(dataset):
        indices = range(t, t+window)
        ma.append(np.average(np.take(dataset, indices)))
else:
    ma = np.asarray(ma) 
```

* * *

## 回答 #25

> 赞同：2
> 
> 时间：2018-07-16T19:48:21.043

**移动平均滤波器**怎么样？它也是单线的，并且具有优势，如果您需要矩形以外的其他东西，您可以轻松地操作窗口类型，即。数组 a 的 N 长简单移动平均线：

```
lfilter(np.ones(N)/N, [1], a)[N:] 
```

并应用了三角形窗口：

```
lfilter(np.ones(N)*scipy.signal.triang(N)/N, [1], a)[N:] 
```

注意：我通常将前 N 个样本作为虚假样本丢弃，因此`[N:]`最后，但这不是必需的，只是个人选择的问题。

* * *

## 回答 #26

> 赞同：2
> 
> 时间：2021-01-05T14:02:00.150

一个新的`convolve`配方被[合并](https://github.com/python/cpython/pull/23928/files)到 Python 3.10 中。

**给定**

```
 import collections, operator

from itertools import chain, repeat

size = 3 + 1
kernel = [1/size] * size 
```

**代码**

```
def convolve(signal, kernel):
    # See:  https://betterexplained.com/articles/intuitive-convolution/
    # convolve(data, [0.25, 0.25, 0.25, 0.25]) --> Moving average (blur)
    # convolve(data, [1, -1]) --> 1st finite difference (1st derivative)
    # convolve(data, [1, -2, 1]) --> 2nd finite difference (2nd derivative)
    kernel = list(reversed(kernel))
    n = len(kernel)
    window = collections.deque([0] * n, maxlen=n)
    for x in chain(signal, repeat(0, n-1)):
        window.append(x)
        yield sum(map(operator.mul, kernel, window)) 
```

**演示**

```
list(convolve(range(1, 6), kernel))
# [0.25, 0.75, 1.5, 2.5, 3.5, 3.0, 2.25, 1.25] 
```

* * *

**细节**

[卷积](https://en.wikipedia.org/wiki/Convolution)是一种可以应用于[移动平均](https://en.wikipedia.org/wiki/Moving_average)的通用数学运算。这个想法是，给定一些数据，您将数据子集（窗口）作为“掩码”或“内核”滑过数据，在每个窗口上执行特定的数学运算。在移动平均线的情况下，内核是平均值：

[![在此处输入图像描述](../Images/21d1932eaf3a3fbd84b7846161fd3e24.png)](https://i.stack.imgur.com/uAUAJ.png)

您现在可以通过[`more_itertools.convolve`](https://more-itertools.readthedocs.io/en/stable/api.html#more_itertools.convolve). [`more_itertools`](https://github.com/more-itertools/more-itertools/)是流行的第三方包；通过安装`> pip install more_itertools`。

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2018-09-11T10:14:27.090

另一个仅使用标准库和双端队列的解决方案：

```
from collections import deque
import itertools

def moving_average(iterable, n=3):
    # http://en.wikipedia.org/wiki/Moving_average
    it = iter(iterable) 
    # create an iterable object from input argument
    d = deque(itertools.islice(it, n-1))  
    # create deque object by slicing iterable
    d.appendleft(0)
    s = sum(d)
    for elem in it:
        s += elem - d.popleft()
        d.append(elem)
        yield s / n

# example on how to use it
for i in  moving_average([40, 30, 50, 46, 39, 44]):
    print(i)

# 40.0
# 42.0
# 45.0
# 43.0 
```

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2021-11-02T10:22:53.923

我的解决方案基于维基百科的“简单移动平均线”。

```
from numba import jit
@jit
def sma(x, N):
    s = np.zeros_like(x)
    k = 1 / N
    s[0] = x[0] * k
    for i in range(1, N + 1):
        s[i] = s[i - 1] + x[i] * k
    for i in range(N, x.shape[0]):
        s[i] = s[i - 1] + (x[i] - x[i - N]) * k
    s = s[N - 1:]
    return s 
```

与之前建议的解决方案的比较表明，它比 scipy 最快的解决方案“uniform_filter1d”快两倍，并且具有相同的错误顺序。速度测试：

```
import numpy as np    
x = np.random.random(10000000)
N = 1000

from scipy.ndimage.filters import uniform_filter1d
%timeit uniform_filter1d(x, size=N)
95.7 ms ± 9.34 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)
%timeit sma(x, N)
47.3 ms ± 3.42 ms per loop (mean ± std. dev. of 7 runs, 1 loop each) 
```

错误比较：

```
np.max(np.abs(np.convolve(x, np.ones((N,))/N, mode='valid') - uniform_filter1d(x, size=N, mode='constant', origin=-(N//2))[:-(N-1)]))
8.604228440844963e-14
np.max(np.abs(np.convolve(x, np.ones((N,))/N, mode='valid') - sma(x, N)))
1.41886502547095e-13 
```

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2021-09-23T12:24:16.623

如果您必须对非常小的数组（少于大约 200 个元素）重复执行此操作，我发现仅使用线性代数即可获得最快的结果。最慢的部分是设置乘法矩阵 y，您只需要做一次，但之后可能会更快。

```
import numpy as np
import random 

N = 100      # window size
size =200     # array length

x = np.random.random(size)
y = np.eye(size, dtype=float)

# prepare matrix
for i in range(size):
  y[i,i:i+N] = 1./N

# calculate running mean
z = np.inner(x,y.T)[N-1:] 
```

* * *

## 回答 #30

> 赞同：-7
> 
> 时间：2014-03-24T22:29:47.567

如果您确实选择滚动自己，而不是使用现有库，请注意浮点错误并尽量减少其影响：

```
class SumAccumulator:
    def __init__(self):
        self.values = [0]
        self.count = 0

    def add( self, val ):
        self.values.append( val )
        self.count = self.count + 1
        i = self.count
        while i & 0x01:
            i = i >> 1
            v0 = self.values.pop()
            v1 = self.values.pop()
            self.values.append( v0 + v1 )

    def get_total(self):
        return sum( reversed(self.values) )

    def get_size( self ):
        return self.count 
```

如果您的所有值的数量级大致相同，那么这将有助于通过始终添加大致相似数量级的值来保持精度。*

# arrays - AS3.0 Hittest 未注册

> ID：13728395
> 
> 赞同：1
> 
> 时间：2012-12-05T16:57:08.987
> 
> 标签：arrays, actionscript-3, hittest

我遇到了一个未注册的热门问题。我有两个对象数组，梯形列表和阻止列表。我正在检查我的主角 mainchar 是否通过嵌套循环命中了 enterframe 事件中的任何对象。我有一个布尔变量 MCFall，如果它碰到任何一个对象，它应该会改变。如果 MCFall 为假，即 mainchar 击中梯子或块，则循环将中断。我目前遇到的问题是我的代码无法检测到 mainchar 是否正在命中块。相关代码如下。

```
addEventListener(Event.ENTER_FRAME, fl_EnterFrameHandler);
function fl_EnterFrameHandler(event:Event):void{    
  //check if touching ANY ground
  blockCheckLoop: for (var i: int=0; i<=blocklist.length; i++){
    if (blocklist[i].target.hitTestObject(mainchar.target)){
      MCFall = false;
      MCmovespeed = 4;
    }//endif
    else{
      ladderCheckLoop: for (var j: int=0; j<=ladderlist.length;j++){
        if (ladderlist[j].target.hitTestObject(mainchar.target)){
          MCFall = false;
          MCmovespeed = 4;
        }//endif
        else{
          MCFall = true;
          MCmovespeed = 0;
        }//endelseif
        if(MCFall == false) break ladderCheckLoop;
      }//endforj*/
    }//endelseif
    if(MCFall == false) break blockCheckLoop;
  }//endfori
}//endenterframe 
```

我已经用 blocklist 测试了 hittest，没有循环检查 mainchar 是否击中梯子，这是有效的。MCmovespeed 只是我使用的一个变量，因此 mainchar 在下降时不能横向移动。任何帮助将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T08:14:25.137

您最好使用以下代码：

for(var b:int = 0; b

```
var currentBlockList:blockList_class = new blocklistArray[b]; 
```

for(var m:int = 0; m

```
var currentMainChar:mainChar_class = new maincharArray[m];

if(currentBlockList.target).hitTestObject(currentMainChar.target)){

    trace("hit");
} 
```

} }

# c - linux中的内存管理：实现first fit

> ID：13728396
> 
> 赞同：4
> 
> 时间：2012-12-05T16:57:11.730
> 
> 标签：c, linux, linux-kernel, kernel

我有任务，我已尽我所能，但无论我尝试什么，我都无法获得最合适的方案。以下是代码。为了实现最佳拟合，我对功能进行了更改`slob_page_alloc`。代码如下：

```
static void *slob_page_alloc(struct page *sp, size_t size, int align)
{
    slob_t *prev, *cur, *aligned = NULL, *best_fit=NULL;
    /* See SLOB_UNITS defination for meaning of macro. units is required 
     * number OF units.*/
    int delta = 0, units = SLOB_UNITS(size);
    unsigned long frag_size = -1UL;
    /*Iterate throught the whole page to find best fit*/
    //printk("Before the for loop\n");
    printk("Starting slob_page_alloc execution\t"); 
    for(prev=NULL, cur=sp->freelist; ; prev=cur, cur=slob_next(cur)) {
        slobidx_t avail = slob_units(cur);
        if(align) {
            aligned = (slob_t *)ALIGN((unsigned long)cur, align);
            delta = aligned - cur;
        }
        if(avail >= delta+units) {
            if( frag_size > avail-units ) {
                frag_size = avail-units;
                best_fit = cur;
            }
        }
        if(slob_last(cur))
            break;
    }

    //printk("after the for loop.\n");
    if(best_fit) {
        slobidx_t avail = slob_units(best_fit);
        //printk("best fit found\n");

        if (align) {
            aligned = (slob_t *)ALIGN((unsigned long)best_fit, align);
            delta = aligned - best_fit;
        }
        if (avail >= units + delta) { /* room enough? */
            slob_t *next;

            if (delta) { /* need to fragment head to align? */
                next = slob_next(best_fit);
                /*Update the newly fragmented slob*/
                set_slob(aligned, avail - delta, next);
                /* Update the lod slob about reduced size 
                 * and new next slob*/
                set_slob(best_fit, delta, aligned);
                prev = best_fit;
                best_fit = aligned;
                avail = slob_units(best_fit);
            }

            next = slob_next(best_fit);
            if (avail == units) { /* exact fit? unlink. */
                if (prev)
                    set_slob(prev, slob_units(prev), next);
                else
                    sp->freelist = next;
            } else { /* fragment */
                if (prev)
                    set_slob(prev, slob_units(prev), best_fit + units);
                else
                    sp->freelist = best_fit + units;
                set_slob(best_fit + units, avail - units, next);
            }

            sp->units -= units;
            if (!sp->units)
                clear_slob_page_free(sp);
            printk("Returned from slob_page_alloc\t");
            return best_fit;
        }
    }
    printk("Returned from slob_page_alloc\t");
    return NULL;
} 
```

当我用这个方案配置内核时，它只是挂在某个地方。

***调试：***

我已经在此功能的某个地方以及功能中完成了打印`slob_alloc`。虽然这对我没有任何意义，但我的函数被多次调用并成功返回，然后再次被调用并返回等等。但在某一时刻，它被调用会打印此函数内的语句，但不会打印其被调用者的语句，而是无限期地挂在那里。

任何帮助表示赞赏！谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-08T08:10:26.090

我认为这里没有足够的代码来找出问题所在（可能在 lxr.oss.org.cn/source/mm/slob.c，但我没有检查）。但我猜这是你的问题：

不知何故，您在链接列表中获得了一个循环（或“循环”），因此您对 slob_last(cur) 的调用将永远不会返回 true。（您的代码确实到达了该行；没有什么更早的，除了段错误，可以阻止它。）我添加了一个调试函数，它将扫描列表以查看它是否终止或有一个循环，并打印出来如果有循环，则发出消息。然后我在你的函数中添加了对该函数的调用。如果您之前没有听说过 Bob Floyd 的宠物龟兔赛跑，请使用 Google for Bob Floyd 和链表循环检测（或链表循环检测）。我没有在下面测试我的代码，但我认为我编码它是正确的。如果它检测到循环，则查看将 slob_t 添加到列表的逻辑，并查看将它们从列表中删除的代码。那里' 必须是某种情况，它要么不正确地将某些内容添加到列表中，要么不正确地从列表中删除某些内容。如果您确实在这里找到了一个循环，请添加对其他位置的额外调用...在您修改列表的代码中的每个点之前和之后...这样您可以缩小代码的哪一部分导致循环.

```
static void slob_debug_detect_loop(slob_t *list_head, const char* debug_location)
{
    // Bob Floyd's pet tortoise & hare, both born in 1967...
    slot_t *hare = list_head;
    slob_t *tortoise = list_head;
    int tortoise_pacer=0;
    while (!slob_last(hare))
    {
        hare = slob_next(hare);
        if (++tortoise_pacer&1)
            tortoise = slob_next(tortoise);
        if (tortoise_pacer>2 && hare==tortoise)
        {
            printk("LINKED LIST LOOP DETECTED at %s!\n", debug_location);
            return;
        }
    }
}

static void *slob_page_alloc(struct page *sp, size_t size, int align)
{
    slob_t *prev, *cur, *aligned = NULL, *best_fit=NULL;
    /* See SLOB_UNITS defination for meaning of macro. units is required
    * number OF units.*/
    int delta = 0, units = SLOB_UNITS(size);
    unsigned long frag_size = -1UL;
    /*Iterate throught the whole page to find best fit*/
    //printk("Before the for loop\n");
    printk("Starting slob_page_alloc execution\t");
    slob_debug_detect_loop(sp->freelist, "before best-fit detection loop"); // ++++++++++
    for(prev=NULL, cur=sp->freelist; ; prev=cur, cur=slob_next(cur)) {
        slobidx_t avail = slob_units(cur);
        if(align) {
            aligned = (slob_t *)ALIGN((unsigned long)cur, align);
            delta = aligned - cur;
        }
        if(avail >= delta+units) {
            if( frag_size > avail-units ) {
                frag_size = avail-units;
                best_fit = cur;
            }
        }
        if(slob_last(cur))
            break;
    }
.
.
. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-12T16:40:24.177

问题是 prev 指针是错误的，因为当你找到 best_fit 时你没有中断，而是在 slob_last(cur) 上中断。best_fit 指针是 last best_fit，但 prev 是 last 的 prev。

稍后在代码列表中修改为 prev 是 best_fit 的 prev 条目的假设。当列表变得混乱时，您会陷入无限循环。

# android - 非法状态异常

> ID：13728397
> 
> 赞同：-1
> 
> 时间：2012-12-05T16:57:16.973
> 
> 标签：android, android-cursor

我有一个预算应用程序，当我试图从我的 SQLite 数据库中获取信息时，我不断收到`IllegalStateExpeaction`错误，我无法找出原因。这是我的代码，它在`Memos.add(i.getString(1));`发生错误的行

```
public List<String> getMemo(List<String> expeances) {
            // TODO Auto-generated method stub
            List<String> Memos = new ArrayList<String>();
            for(String exp: expeances)
            {
                Cursor i = ourDatabase.query(DATABASE_TABLE4, new String[]{KEY_MEMO},KEY_DATE+" = '"+exp+"'", null, null, null, null,null);

                if(i.getCount()>0)
                {
                    if(i.moveToFirst())
                    {
                        do 
                        {
                            Memos.add(i.getString(1));
                        } 
                        while (i.moveToNext());
                    }
                }
            }

            if (Memos.size()>0)
            {
                return Memos;
            }
            else
            {
                return null;
            }
        } 
```

这是我的日志猫

```
 12-05 10:49:46.058: E/AndroidRuntime(12980): FATAL EXCEPTION: main
        12-05 10:49:46.058: E/AndroidRuntime(12980): java.lang.RuntimeException: Unable to start activity ComponentInfo{budget.app/budget.app.ReviewBudget}: java.lang.IllegalStateException: Couldn't read row 0, col 1 from CursorWindow.  Make sure the Cursor is initialized correctly before accessing data from it.
        12-05 10:49:46.058: E/AndroidRuntime(12980):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2059)
        12-05 10:49:46.058: E/AndroidRuntime(12980):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2084)
        12-05 10:49:46.058: E/AndroidRuntime(12980):    at android.app.ActivityThread.access$600(ActivityThread.java:130)
        12-05 10:49:46.058: E/AndroidRuntime(12980):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1195)
        12-05 10:49:46.058: E/AndroidRuntime(12980):    at android.os.Handler.dispatchMessage(Handler.java:99)
        12-05 10:49:46.058: E/AndroidRuntime(12980):    at android.os.Looper.loop(Looper.java:137)
        12-05 10:49:46.058: E/AndroidRuntime(12980):    at android.app.ActivityThread.main(ActivityThread.java:4745)
        12-05 10:49:46.058: E/AndroidRuntime(12980):    at java.lang.reflect.Method.invokeNative(Native Method)
        12-05 10:49:46.058: E/AndroidRuntime(12980):    at java.lang.reflect.Method.invoke(Method.java:511)
        12-05 10:49:46.058: E/AndroidRuntime(12980):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
        12-05 10:49:46.058: E/AndroidRuntime(12980):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
        12-05 10:49:46.058: E/AndroidRuntime(12980):    at dalvik.system.NativeStart.main(Native Method)
        12-05 10:49:46.058: E/AndroidRuntime(12980): Caused by: java.lang.IllegalStateException: Couldn't read row 0, col 1 from CursorWindow.  Make sure the Cursor is initialized correctly before accessing data from it.
        12-05 10:49:46.058: E/AndroidRuntime(12980):    at android.database.CursorWindow.nativeGetString(Native Method)
        12-05 10:49:46.058: E/AndroidRuntime(12980):    at android.database.CursorWindow.getString(CursorWindow.java:434)
        12-05 10:49:46.058: E/AndroidRuntime(12980):    at android.database.AbstractWindowedCursor.getString(AbstractWindowedCursor.java:51)
        12-05 10:49:46.058: E/AndroidRuntime(12980):    at budget.app.BudgetDB.getMemo(BudgetDB.java:511)
        12-05 10:49:46.058: E/AndroidRuntime(12980):    at budget.app.ReviewBudget.loadSpinnerData(ReviewBudget.java:58)
        12-05 10:49:46.058: E/AndroidRuntime(12980):    at budget.app.ReviewBudget.onCreate(ReviewBudget.java:51)
        12-05 10:49:46.058: E/AndroidRuntime(12980):    at android.app.Activity.performCreate(Activity.java:5008)
        12-05 10:49:46.058: E/AndroidRuntime(12980):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1079)
        12-05 10:49:46.058: E/AndroidRuntime(12980):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2023)
        12-05 10:49:46.058: E/AndroidRuntime(12980):    ... 11 more 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T17:04:33.177

您的光标投影只有一列`KEY_MEMO`

但您正在尝试访问第二列

```
i.getString(1) 
```

采用

```
i.getString(0) 
```

反而

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-05T17:05:04.843

光标只包含一列。所以使用

```
Memos.add(i.getString(0)); 
```

# cryptography - 尝试散列已知数据，但不允许用户重新创建散列

> ID：13728400
> 
> 赞同：0
> 
> 时间：2012-12-05T16:57:20.500
> 
> 标签：cryptography

我的应用程序根据其序列号创建哈希（例如：A1C2-E3G-4I5K）。序列号为用户所知。用户也将知道散列。什么是散列数据的最佳策略，同时使用户无法/极难自己创建散列？

我使用散列作为显示远程应用程序上发生了操作的一种方式。

我曾考虑过私钥加密，但用户有可能自己掌握私钥。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T11:27:42.553

您可以查看[Keyed-HMAC](http://en.wikipedia.org/wiki/Hash-based_message_authentication_code)。基本上，您可以在您的值上创建一个 SHA-256 哈希值以及一个只有您的应用程序知道的密钥。在这种假设下，用户将无法为自己创建有效的哈希。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T17:08:01.120

您可以在散列之前尝试“加盐”序列号 [http://en.wikipedia.org/wiki/Salt_%28cryptography%29](http://en.wikipedia.org/wiki/Salt_%28cryptography%29)

# javascript - D3 基准与数据有什么区别？

> ID：13728402
> 
> 赞同：221
> 
> 时间：2012-12-05T16:57:25.907
> 
> 标签：javascript, d3.js

有人可以解释 D3.js 中 datum() 和 data() 之间的区别吗？我看到两者都在使用，但我不确定您为什么应该选择其中一个？

* * *

## 回答 #1

> 赞同：180
> 
> 时间：2012-12-05T19:33:08.817

我从迈克本人那里找到了正确的答案：

[D3 - 如何处理 JSON 数据结构？](https://stackoverflow.com/questions/10086167/d3-how-to-deal-with-json-data-structures)

如果要将数据绑定到单个 SVG 元素，请使用

```
(...).data([data]) 
```

或者

```
(...).datum(data) 
```

如果要将数据绑定到多个 SVG 元素

```
(...).data(data).enter().append("svg") 
```

......

* * *

## 回答 #2

> 赞同：67
> 
> 时间：2017-01-24T02:37:30.190

在对此进行了一番研究之后，我发现这里关于 SO 的答案并不完整，因为它们仅涵盖了您调用`selection.data`并`selection.datum`使用输入`data`参数时的情况。即使在这种情况下，如果选择是单个元素与包含多个元素时，两者的行为也会有所不同。此外，这两种方法也可以在没有任何输入参数的情况下调用，以查询选择中的绑定数据/数据，在这种情况下，它们再次表现不同并返回不同的东西。

[编辑 - 我在这里](https://www.intothevoid.io/data-visualization/understanding-d3-data-vs-datum/)发布了一个稍微更详细的答案，但下面的帖子几乎涵盖了关于这两种方法的所有关键点以及它们之间的区别。

**`data`作为**输入参数****提供时****

 *****   `selection.data(data)`将尝试在`data`数组的元素之间执行数据连接，选择导致创建`enter()`，`exit()`以及`update()`您可以随后操作的选择。这样做的最终结果是，如果您传入一个数组`data = [1,2,3]`，则会尝试将每个单独的数据元素（即数据）与所选内容连接起来。选择的每个元素将只有一个`data`绑定到它的基准元素。

*   `selection.datum(data)`完全绕过数据连接过程。这只是将整体分配给`data`选择中的所有元素作为一个整体，而不像在数据连接的情况下那样将其拆分。因此，如果您想将整个数组绑定`data = [1, 2, 3]`到 DOM 中的每个元素`selection`，那么`selection.datum(data)`将实现这一点。

> ***警告：***许多人认为这`selection.datum(data)`等价于**但仅当包含单个元素**`selection.data([data])`时才如此 。如果包含多个 DOM 元素，则将整个 绑定到选择中的每个元素。相反，仅将整个 绑定 到 中的第一个元素。这与 的数据连接行为一致。`selection` **`selection``selection.datum(data)``data``selection.data([data])``data``selection``selection.data`**

 ****不提供`data`输入参数时**

*   `selection.data()`将为选择中的每个元素获取绑定数据并将它们组合成一个返回的数组。因此，如果您`selection`在 data 中包含 3 个 DOM 元素`"a"`，`"b"`并`"c"`分别绑定到每个元素，则`selection.data()`返回`["a", "b", "c"]`. 重要的是要注意，如果`selection`是单个元素（例如）`"a"`绑定到它的数据，那么`selection.data()`将返回`["a"]`而不是`"a"`像某些人所期望的那样。

*   `selection.datum()`仅对单个选择有意义，因为它被定义为返回**绑定到**选择的第一个元素的数据。因此，在上面的示例中，选择由 DOM 元素组成，绑定数据为`"a"`,`"b"`和`"c"`,`selection.datum()`将简单地返回`"a"`。

> 请注意，即使`selection`具有单个元素，`selection.datum()`并且`selection.data()`返回不同的值。前者返回选择的绑定数据（`"a"`在上面的示例中），而后者返回数组中的绑定数据（`["a"]`在上面的示例中）。

希望这有助于阐明在提供数据作为输入参数时`selection.data`以及`selection.datum()`在通过不提供任何输入参数来查询绑定数据时两者之间的区别。

PS - 了解其工作原理的最佳方法是从 Chrome 中的空白 HTML 文档开始，然后打开控制台并尝试向文档中添加一些元素，然后使用`selection.data`and开始绑定数据`selection.datum`。有时，通过做事比阅读更容易“理解”某事。

* * *

## 回答 #3

> 赞同：42
> 
> 时间：2012-12-05T17:07:59.003

这里有一些很好的链接：

*   关于 D3“data()”的好讨论： [了解 D3.js 如何将数据绑定到节点](https://stackoverflow.com/questions/9481497/understanding-how-d3-js-binds-data-to-nodes)

*   [D3 凡人](http://www.recursion.org/d3-for-mere-mortals/)

*   [Mike Bostock 的 D3 Wiki](https://github.com/mbostock/d3/wiki/Selections)

根据后者：

> `# selection.data([values[, key]])`
> 
> 将指定的数据数组与当前选择连接起来。指定值是数据值数组，例如数字或对象数组，或返回值数组的函数。
> 
> ...
> 
> `# selection.datum([value])`
> 
> 获取或设置每个选定元素的绑定数据。与 selection.data 方法不同，此方法不计算连接（因此不计算进入和退出选择）。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2018-08-21T10:18:19.123

我认为HamsterHuey给出的解释是迄今为止最好的。为了扩展它并给出差异的可视化表示，我创建了一个示例文档，至少说明了`data`和之间的部分差异`datum`。

下面的答案更多是使用这些方法得出的意见，但如果我错了，我很高兴得到纠正。

这个例子可以在下面或[这个 Fiddle](https://jsfiddle.net/gleezer/e4m6j2d8/2/)中运行。

```
const data = [1,2,3,4,5];
const el = d3.select('#root');

 el
  .append('div')
  .classed('a', true)
  .datum(data)
  .text(d => `node => data: ${d}`);

const join= el
.selectAll('div.b')
.data(data);

join
.enter()
.append('div')
.classed('b', true)
.text((d, i) => `node-${i + 1} => data: ${d}`) 
```

我认为这`datum`更容易掌握，因为它不进行连接，但这当然也意味着它有不同的用例。

对我来说，一个很大的不同——尽管还有更多不同——是在`data`d3 图表上进行（实时）更新的自然方式，因为整个进入/更新/退出模式使它变得简单，一旦你得到它。

`datum`另一方面，在我看来，它更适合静态表示。例如，在下面的示例中，我可以在原始数组上循环并按索引访问数据，如下所示：

```
data.map((n, i) => {
 el
  .append('div')
  .classed('a', true)
  .datum(data)
  .text(d => `node-${n} => data: ${d[i]}`);
}); 
```

在这里试试：[https ://jsfiddle.net/gleezer/e4m6j2d8/6/](https://jsfiddle.net/gleezer/e4m6j2d8/6/)

同样，我认为这更容易掌握，因为您可以摆脱输入/更新/退出模式带来的精神负担，但是一旦您需要更新或更改选择，您肯定会更好地求助于`.data()`.

```
const data = [1,2,3,4,5];
const el = d3.select('#root');

 el
  .append('div')
  .classed('a', true)
  .datum(data)
  .text(d => `node => data: ${d}`);

const join= el
.selectAll('div.b')
.data(data);

join
.enter()
.append('div')
.classed('b', true)
.text((d, i) => `node-${i + 1} => data: ${d}`)
```

```
/* Ignore all the css */
html {
  font-family: arial;
}

.l {
  width: 20px;
  height: 20px;
  display: inline-block;
  vertical-align: middle;
  margin: 10px 0;
}
.l-a {
  background: #cf58e4;
}
.l-b {
  background:  #42e4e4;
}

.a {
  border-bottom: 2px solid #cf58e4;
}

.b {
  border-bottom: 2px solid #42e4e4;
}
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/5.6.0/d3.min.js"></script>

<div style="margin-bottom: 20px;">
  <span class="l l-a"></span> .datum() <br />
  <span class="l l-b"></span> .data()
</div>

<div id="root"></div>
```******

# ruby-on-rails - Rspec-Rails：使用大量参数组合测试方法

> ID：13728406
> 
> 赞同：0
> 
> 时间：2012-12-05T16:57:51.967
> 
> 标签：ruby-on-rails, rspec, tdd

我有一个方法，如果它做正确的事情，我想测试不同的参数。我现在正在做的是

```
 def test_method_with(arg1, arg2, match)
        it "method should #{match.inspect} when arg2 = '#{arg2}'" do
                method(arg1, FIXEDARG, arg2).should == match
        end
    end
    context "method with no info in arg1" do
        before (:each) do
            @ex_string = "no info"
        end
        test_method_with(@ex_string, "foo").should == "res1"}
        test_method_with(@ex_string, "bar").should == "res1"}
        test_method_with(@ex_string, "foobar").should == "res1"}
        test_method_with(@ex_string, "foobar2").should == "res2"}
        test_method_with(@ex_string, "barbar").should == "res2"}
        test_method_with(@ex_string, nil).should == nil}
    end 
```

但这真的不是那么 DRY 一遍又一遍地重复该方法......有什么更好的方法来完成这个？更多的是黄瓜的“表格”选项（它只是帮助方法的正确行为，所以使用黄瓜似乎不正确）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T17:33:19.630

Your method expects 3 arguments, but you're passing it two. That being said, you can write a loop to call `it` multiple times, like this:

```
#don't know what arg2 really is, so I'm keeping that name
[ {arg2: 'foo', expected: 'res1'},
  {arg2: 'bar', expected: 'res1'},
  #remaining scenarios not shown here
].each do |example|
  it "matches when passed some fixed arg and #{example[:arg2]}" do
     method(@ex_string, SOME_CONSTANT_I_GUESS,example[:arg2]).should == example[:expected]
  end
end 
```

This way, you only have one example (aka the `it` call) and your examples are extracted to a data table (the array containing the hashes).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T21:57:58.510

如果您删除实例变量@ex_string 的传递，我认为您的方法很好。（并且匹配只发生在`test_method_with`肯里克建议的情况下。）也就是说你可以使用自定义匹配器：

```
RSpec::Matchers.define :match_with_method do |arg2, expected|
  match do
    method(subject, arg2) == expected
  end

  failure_message_for_should do
    "call to method with #{arg2} does not match #{expected}"
  end
end

it 'should match method' do
  "no info".should match_with_method "foo", "res1"
end 
```

匹配器可以放在规范帮助文件中，以便从多个规范中访问。

# java - Ubuntu 上的 Sun Java 6

> ID：13728407
> 
> 赞同：0
> 
> 时间：2012-12-05T16:57:58.707
> 
> 标签：java, ubuntu, sun, java-6, jpcap

我需要的 java 库 (jpcap) 仅适用于 Java 6，不适用于 Java 7。是否仍然可以在 Ubuntu 上安装 Java 6？根据[Ubuntu 帮助](https://help.ubuntu.com/community/Java#Choosing_the_default_Java_to_use)：

> 由于许可证问题，Oracle (Sun) Java 6 不再可供 Ubuntu 分发

我尝试使用同一站点上的说明，但它们似乎不起作用...... `./jre-6u34-linux-i586.bin`似乎没有做任何事情！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T17:01:45.323

我会尝试 AFAIK 在 Ubuntu 上运行良好的 OpenJDK 6，并检查您的机器是否有正确的 32 位和 64 位版本。`i586`是 32 位的，不适用于 64 位构建的 jpcap。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T17:05:15.560

查看有关如何安装 Sun JDK 6 的[这些说明。在旧版本的存储库中，包含所需的软件包。](http://ddmytrenko.blogspot.de/2012/02/installing-sun-java-6-jdk-on-debian.html)

* * *

如果您没有义务，请尝试[`jNetPcap`](http://jnetpcap.com/)改用。它是 pcap 的另一个包装器，它只适用于更新的 JVM，并且不限于 32 位架构。

# jquery - JQuery mobile：登录链接转到最后一个缓存页面

> ID：13728410
> 
> 赞同：1
> 
> 时间：2012-12-05T16:58:03.333
> 
> 标签：jquery, jquery-mobile

我正在尝试为我为我的公司制作的网络应用程序实施移动解决方案。主要的基于 PC 的应用程序运行良好，但移动部分的行为很奇怪。

目前，用户退出的唯一方法是访问应用程序主页并选择退出（这最终会改变，但我们仍处于早期开发阶段）。当用户退出应用程序时，我调用一个控制器 (index.php)，它将刷新 PHP 会话数据，创建一个页面 (form.html.php)，用户可以在其中单击链接重新登录。这链接将调用主控制器，它将检查是否设置了特定的会话变量，如果没有，则重定向到登录控制器/页面。由于注销表单会刷新所有这些数据，因此应将用户重定向到登录页面。如前所述，使用 PC 浏览器可以正常工作。

移动设备上发生的情况是，当用户单击链接重新登录时，移动设备会转到注销的主页。由于所有会话数据都处于非活动状态，因此页面实际上是死的。

如何让移动应用（或 JQuery 移动）停止缓存上一页？任何帮助表示赞赏。仅供参考：我只是在学习移动应用基础设施。

索引.php：

```
<?php
    session_start();
    $url = $_SESSION['myurl'];
    $root = $_SESSION['myroot'];
    $formTitle      = 'Exit NSI CRM';
    $formHeading    = 'NSI CRM System - Goodbye';
    $m = $_SESSION['mobile'];
    session_destroy();
    ($m?include ('m_form.html.php'):include ('form.html.php'));
    exit();
?> 
```

m_form.html.php：

```
<!DOCTYPE html> 
 <html> 
    <head> 
        <meta name="viewport" content="width=device-width, initial-scale=1"> 
        <link rel="stylesheet" type="text/css" href="<?php print 'http://'.$_SERVER['HTTP_HOST'].'/crm/css/m_crm.css';?>">
        <link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
        <script type="text/javascript">
            google.load("jquery", "1");
        </script>
        <link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
        <?php include $root.'/inc/favicon.php'; ?>
        <title><?php print $formTitle; ?></title>
    </head> 
    <body> 
    <div data-role="page">
        <div>
            <br>
                <img src="<?php print 'http://'.$_SERVER['HTTP_HOST'].'/crm/img/handshake.jpg';?>">
            <h3>
                You have been logged out of the NSI CRM System. Good-bye!
            <br>
                To log back in, click <a style="font-size: larger;" href="<?php echo 'http://'.$_SERVER['HTTP_HOST'].'/crm/'; ?>">here.</a>
            </h3>
        </div>
    </div><!-- /page -->
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T17:23:09.883

您是否尝试过禁用 jquery mobile 的 ajax 功能？

```
$(document).bind("mobileinit", function () {
  $.mobile.ajaxEnabled = false;
}); 
```

在 jquery 移动框架加载之前调用它。

或者你可以修改你的链接添加这些属性之一

```
rel="external", data-ajax="false" 
```

例如`<a href="somepage.html" rel="external">Link</a>`

参考：http: [//jquerymobile.com/demos/1.0a4.1/docs/pages/link-formats.html](http://jquerymobile.com/demos/1.0a4.1/docs/pages/link-formats.html)

# seo - 我可以在 Google 站点提交中更改站点地图名称吗？

> ID：13728411
> 
> 赞同：-1
> 
> 时间：2012-12-05T16:58:06.407
> 
> 标签：seo, sitemap

我正在使用`sitemap.xml`我的站点地图，这是传统的命名系统。我可以将其更改为 anyName.xml 吗？防止第三方查看。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T16:59:36.697

[您可以根据站点地图网站](http://www.sitemaps.org/protocol.html)将其命名为任何您想要的名称。

# c++ - 使用引用参数提升 python 方法调用

> ID：13728412
> 
> 赞同：6
> 
> 时间：2012-12-05T16:58:07.053
> 
> 标签：c++, python, boost, boost-python

我正在尝试通过从 python 到 C++ 类方法的引用进行简单调用。

我的 C++ 代码如下所示：

```
class Foo {
protected:
  int _internalVal;
public:
  Foo() : _internalVal(5){}
  void getVal(int& val_io) {val_io = _internalVal;}
  void getValDoesNothing(int val_io) {val_io = _internalVal;}
} 
```

我编译好的提升包装代码是：

```
BOOST_PYTHON_MODULE(libBar) {
  boost::python::class_<Foo>("Foo")
    .def("getVal", &Foo::getVal)
    .def("getValDoesNothing", &Foo::getValDoesNothing);
} 
```

但是，当我进行以下 python 调用时：

```
In [1]: import libBar

In [2]: f = libBar.Foo()

In [3]: f
Out[3]: <libBar.Foo at 0x2b483c0>

In [4]: val = int()

In [5]: #next command is just to check function signature type

In [6]: f.getValDoesNothing(val)

In [7]: f.getVal(val)
---------------------------------------------------------------------------
ArgumentError                             Traceback (most recent call last)
<ipython-input-5-531e4cea97c2> in <module>()
----> 1 f.getVal(val)

ArgumentError: Python argument types in
    Foo.getVal(Foo, int)
did not match C++ signature:
    getVal(Foo {lvalue}, int {lvalue}) 
```

我正在使用我无法控制的库，因此更改 getVal 以返回值不是一种选择。

有没有办法让最后一个 Python 命令工作？

我什至会采取一个不改变 Python 变量但仍允许函数调用的修复程序。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-05T19:04:55.997

您要实现的目标在 Python 中无效。整数是不可变的，所以你不能简单地调用一个函数并希望它会改变它的内容。

由于您正在使用一个您无法控制的库并且更改 getVal 以返回该值不是一个选项，因此您可以创建一个这样的包装器：

```
int getVal(Foo &foo) {
    int val_io;
    foo.getVal(val_io);
    return val_io;
};

BOOST_PYTHON_MODULE(libBar) {
    boost::python::def("getVal", getVal);
    ...
} 
```

然后以这种方式使用：

```
In [1]: import libBar

In [2]: f = libBar.Foo()

In [3]: f
Out[3]: <libBar.Foo at 0x2b483c0

In [3]: libBar.getVal(f)
Out[3]: 5 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-05-23T18:25:30.863

我使用带有单个元素的 numpy 数组来完成您正在尝试的操作。这是我在文件 ipc-messenger.h 中包装的类（在我的例子中，使用 MsgBuf 的 int 实现）：

```
template <class MsgBuf>
class IPCMessenger {
public:
    IPCMessenger(const char* name);
    virtual ~IPCMessenger();
    virtual int Notify(const MsgBuf& msg, unsigned int priority = 0);
    int Receive(MsgBuf& msg, unsigned int* priority = nullptr);
    int Terminate();
private:
    boost::interprocess::message_queue _mq; /// boost IPC Message Queue.
    std::string _queue_name;                /// application defined queue name
}; 
```

这是 ipc-messenger_py.cpp 中的包装类

```
#include <boost/python.hpp>
#include "ipc-messenger.h"
#include <boost/python/numpy.hpp>

using namespace boost::python;
using namespace std;
namespace np = boost::python::numpy;

class IPCMessengerPy : public IPCMessenger<int> {
public:
    IPCMessengerPy(const char* name) : IPCMessenger(name) {}
    ~IPCMessengerPy() {}
    int Receive(np::ndarray & arr) {
        int ret = 0;
        int* p = (long *)arr.get_data();
        return IPCMessenger::Receive(*p);
    }
    int Notify(np::ndarray& arr) {
        int p = (long *)arr.get_data();
        return IPCMessenger::Notify(*p);
    }
};

BOOST_PYTHON_MODULE(ipcmessengerpy)
{
    Py_Initialize();
    np::initialize();

    class_<IPCMessengerPy, boost::noncopyable>("ipcmessenger", init<const char*>())
        .def( "receive", &IPCMessengerPy::Receive )
        .def( "send", &IPCMessengerPy::Notify )
        ;
} 
```

这可以从 python 调用，如下所示：

```
import ipcmessengerpy
import numpy as np
import time

# run this script in background, and then run ipc-master.py

q = ipcmessengerpy.ipcmessenger("QueueName")
buf = np.zeros([1], dtype = np.int32)

for c in range(0, 10):
    q.receive(buf)
    print "Received ", buf[0], " on q" 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-05T17:11:14.693

在 getValDoesNothing 中，您传递的是一个 int。在 getVal 中，您传递的是对 int 的引用。

我相信这是你问题的根源。

# java - Java程序将从数据库中读取，但不写入

> ID：13728415
> 
> 赞同：0
> 
> 时间：2012-12-05T16:58:12.923
> 
> 标签：java, mysql, database

我有一个 Java 程序可以成功连接到 Godaddy 服务器上托管的 mysql 数据库。我可以毫无问题地从该数据库读取，但是，当我尝试使用 INSERT 或 UPDATE 写入它时，查询不会执行。我正在使用通过 godaddy 设置的“管理员”帐户，我意识到这不是 root 帐户。我已经检查并确认连接不是只读的，并且在查询运行时已注销 phpmyadmin。我不确定我还能尝试什么，或者是否有人遇到过这个问题。

也许是我未能设置的连接设置？或者因为数据库托管在godaddy的服务器上，所以它不可能？

任何帮助都很棒！

谢谢。

以下是一些相关代码：
连接到数据库：

```
Connection con;
public DBconnection(String url, String user, String pass)
{
        try {
            Class.forName("com.mysql.jdbc.Driver").newInstance();
            con = DriverManager.getConnection (url,user,pass);

            if(!con.isClosed())
                System.out.println("connecton open");
        } 
        catch (InstantiationException e) {e.printStackTrace();} 
        catch (IllegalAccessException e) {e.printStackTrace();} 
        catch (ClassNotFoundException e) {e.printStackTrace();} 
        catch (SQLException e) {e.printStackTrace();}
} 
```

发送查询：

```
public ResultSet executeQuery(String query)
{
    ResultSet rs = null;

    try {
        Statement stmt = (Statement) con.createStatement();
        rs = stmt.executeQuery(query);

        //while(rs.next())
            //System.out.println(rs.getString("ticket_num"));
    } 
    catch (SQLException e) {}   

    return rs;
} 
```

插入查询（在 phpmyadmin 中工作）：

```
conn.executeQuery("INSERT INTO tickets VALUES(55555,'12/01/2012','me','reports','test','','','0','Nope')"); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T16:59:58.383

使用 statement.executeUpdate() 执行 INSERT 查询。

**[来自Statement.executeUpdate(String sql)](http://docs.oracle.com/javase/6/docs/api/java/sql/PreparedStatement.html#executeUpdate%28%29)**的 API ：

> 执行此 PreparedStatement 对象中的 SQL 语句，该语句必须是 SQL 数据操作语言 (DML) 语句，例如 INSERT、UPDATE 或 DELETE；或不返回任何内容的 SQL 语句，例如 DDL 语句。

```
 executeUpdate("INSERT INTO tickets VALUES(55555,'12/01/2012','me','reports','test','','','0','Nope')"); 
```

我**强烈**建议您使用**PreparedStatemnt**而不是简单的 Statement 来使用**JDBC执行****SQL**。

 *** * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T17:01:10.520

用于实例化连接对象的用户名和密码，只有从数据库读取的权限，不能写入。您需要更改连接数据库的凭据，或者您需要向相关用户提供权限**

# asp.net - ASP.NET 页面上的不可见控件及其子控件是否有助于视图状态？

> ID：13728417
> 
> 赞同：2
> 
> 时间：2012-12-05T16:58:18.113
> 
> 标签：asp.net, viewstate

我有一个 ASP.NET 页面，其中嵌入了大约 40 个自定义控件。控件大小不一；在他们的 .ascx 文件中，最大的大约 1,500 行，较小的在 100 到 200 行之间（标记、脚本等）。

每个控件都包含在一个`Panel`. 任何时候都只能看到这些面板中的一个，这意味着一次只能看到一个控件。

我的问题是：不可见的控件是否仍将 ViewState 为自己及其所有子项发送给客户端？这是有道理的，他们可能不得不序列化他们不可见的事实，但不是他们孩子的所有状态信息......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T17:01:54.337

如果您自己编写控件，并且没有明确说明当父级不可见时控件中的项目不应添加到视图状态，那么是的，它们应该处于视图状态。

# c++ - 内存使用理论与问题

> ID：13728419
> 
> 赞同：0
> 
> 时间：2012-12-05T16:58:22.223
> 
> 标签：c++, memory

> **可能重复：**
> [什么是堆栈溢出错误？](https://stackoverflow.com/questions/214741/what-is-a-stack-overflow-error)

看下面的代码。

```
#include <iostream>
using namespace std;

void leave(double as){
    cout<<as;
    leave(as);
}

int main(){
    double x=1234.5;
    leave(x);
    cout<<"hellow";
} 
```

当这段代码执行时，他们是无法停止的。`x`它应该一遍又一遍地打印该值。但实际上，这工作大约 20 秒并自动关闭。它不打印 line `hellow`。原因是什么？在 Windows 任务管理器中，我可以意识到应用程序使用的内存会增加。但是我`x`只在主函数中分配了内存，所以函数会`x`一遍又一遍地分配内存。这种情况是否称为内存泄漏？如果是这样，应该添加哪些行来防止它？

如果我如下更改代码，它会显示单词`hellow`，而无需一遍又一遍地执行该函数：

```
 void leave(){
     leave();
  }

  int main(){
      leave();
      cout<<"hellow";
  } 
```

如何解释这些情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T17:12:21.583

每次调用都会向`leave()`堆栈添加一些信息。当您递归调用它时，堆栈会增长，直到空间用完，并且操作系统会终止应用程序。在第二个例子中，大概编译器优化了什么都不做的函数。

# android - android上的java邮件1.4.5

> ID：13728421
> 
> 赞同：0
> 
> 时间：2012-12-05T16:58:32.793
> 
> 标签：android, jakarta-mail

我正在自定义 Android 设备上开发 IMAP 客户端。所以我决定使用 Java Mail 库。我需要从 Java Mail 的 1.4.1 版本更新到 1.4.5，因为在巨大的 INBOX 文件夹（大约 120k 邮件）的情况下我有内存问题。

所以我从官方主页下载了 2 个 jars（mail.jar 和 activation.jar），我也尝试了发布候选版本 1.4.6，但我无法让它工作。

一旦我构建了整个应用程序，一切都很好，但是当我运行时，它会出现：

```
2-05 17:31:21.020 19862 19912 I dalvikvm: Failed resolving Ljavax/activation/DataHandler; interface 571 'Ljava/awt/datatransfer/Transferable;'
12-05 17:31:21.030 19862 19912 W dalvikvm: Link of class 'Ljavax/activation/DataHandler;' failed
12-05 17:31:21.030 19862 19912 W dalvikvm: VFY: unable to find class referenced in signature (Ljavax/activation/DataHandler;)
12-05 17:31:21.030 19862 19912 I dalvikvm: Failed resolving Ljavax/activation/DataHandler; interface 571 'Ljava/awt/datatransfer/Transferable;'
12-05 17:31:21.030 19862 19912 W dalvikvm: Link of class 'Ljavax/activation/DataHandler;' failed
12-05 17:31:21.030 19862 19912 E dalvikvm: Could not find method javax.activation.DataHandler.getName, referenced from method javax.mail.internet.MimeUtility.getEncoding
12-05 17:31:21.030 19862 19912 W dalvikvm: VFY: unable to resolve virtual method 4632: Ljavax/activation/DataHandler;.getName ()Ljava/lang/String;
12-05 17:31:21.040 19862 19912 W dalvikvm: VFY:  rejecting opcode 0x6e at 0x0004
12-05 17:31:21.040 19862 19912 W dalvikvm: VFY:  rejected Ljavax/mail/internet/MimeUtility;.getEncoding (Ljavax/activation/DataHandler;)Ljava/lang/String;
12-05 17:31:21.040 19862 19912 W dalvikvm: Verifier rejected class Ljavax/mail/internet/MimeUtility;
12-05 17:31:21.050 19862 19912 D EMAIL   : Releasing mail download wake lock
12-05 17:31:21.050 19862 19912 W dalvikvm: threadid=17: thread exiting with uncaught exception (group=0x4001aa30)
12-05 17:31:21.060 19862 19912 E AndroidRuntime: Uncaught handler: thread pool-1-thread-1 exiting due to uncaught exception
12-05 17:31:21.080 19862 19912 E AndroidRuntime: java.lang.VerifyError: javax.mail.internet.MimeUtility
12-05 17:31:21.080 19862 19912 E AndroidRuntime:    at com.sun.mail.imap.protocol.IMAPProtocol.<init>(IMAPProtocol.java:130)
12-05 17:31:21.080 19862 19912 E AndroidRuntime:    at com.sun.mail.imap.IMAPStore.newIMAPProtocol(IMAPStore.java:685)
12-05 17:31:21.080 19862 19912 E AndroidRuntime:    at com.sun.mail.imap.IMAPStore.protocolConnect(IMAPStore.java:636)
12-05 17:31:21.080 19862 19912 E AndroidRuntime:    at javax.mail.Service.connect(Service.java:295)
12-05 17:31:21.080 19862 19912 E AndroidRuntime:    at javax.mail.Service.connect(Service.java:176)
12-05 17:31:21.080 19862 19912 E AndroidRuntime:    at it.kynetics.imwatch.email.imap.EmailAuthenticationImpl.login(EmailAuthenticationImpl.java:36)
12-05 17:31:21.080 19862 19912 E AndroidRuntime:    at it.kynetics.imwatch.email.imap.EmailConnection.execute(EmailConnection.java:21)
12-05 17:31:21.080 19862 19912 E AndroidRuntime:    at it.kynetics.imwatch.email.ImCloudEmailService$GetEmailTask.run(ImCloudEmailService.java:148)
12-05 17:31:21.080 19862 19912 E AndroidRuntime:    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:648)
12-05 17:31:21.080 19862 19912 E AndroidRuntime:    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:673)
12-05 17:31:21.080 19862 19912 E AndroidRuntime:    at java.lang.Thread.run(Thread.java:1060)
12-05 17:31:21.120  1830  1830 I Process : Sending signal. PID: 19862 SIG: 3 
```

我尝试检查jar中的DataHandler和getName方法，一切正常。

有没有人有同样的问题？

谢谢大家。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T13:53:08.517

并非每个 java 库都适用于 Android。您只能将[javamail 端口用于 android](http://code.google.com/p/javamail-android/)。最新版本的 Javamail 仍未移植到 Android

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T15:10:19.140

我找到了解决方案！我需要修改 mail.jar 及其源代码。这是一个“进口包装”问题。在Android移植中，部分mail.jar类，从包名为myjava.awt的additionnal.jar中导入其他类。除外。在 java mail 1.4.5 中，该包名为 java.awt exc，没有“my”前缀。解决这个问题，一切都会奏效。

谢谢大家！

# c# - 将 C char * 转换为 .Net 字符串，然后转换为 byte[]

> ID：13728423
> 
> 赞同：1
> 
> 时间：2012-12-05T16:58:35.760
> 
> 标签：c#, .net, types, interop

我遇到了需要您帮助的数据转换问题。

我的项目是`InterOp`介于**C**和 C# 之间的，来自**C**的所有数据都是`char *`类型，数据本身可以是二进制或可显示的字符，即每个字节都在 0x00 到 0xFF 范围内。

我正在使用 Data`marshal::PtrToStringAnsi`将其转换`char*`为`String^`in `CLI code`，但我发现一些字节值发生了变化。例如 C382 转换为 C32C。我想这可能是因为`ANSI`只能转换`7-bit char`，但`82`超出范围？谁能解释为什么以及最好的方法是什么？

基本上我想要做的是，我不需要任何编码转换，我只想将任何 char * 面值转换为字符串，例如，如果我也`char *p = "ABC"`想要`String ^s="ABC"`，如果`*p="C382"`（表示二进制值）我也想要`^s="C382"`。

在我的 .NET 代码中，两个子类将采用表示二进制数据或真实字符串的输入字符串，如果它是二进制的，它将转换`"C382" to byte[]=0xC3 0x82;`

读回数据时，C382 会以二进制数据的形式从数据库中取出，最终需要转换为`char* "C382"`.

有没有人有类似的经验如何在两个方向上做这些？我尝试了很多方法，它们似乎都是编码方式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T17:58:38.197

`Marshal`班级会为你做这件事。

转换时`char*`，`byte[]`您需要将指针和缓冲区长度传递给托管代码。然后你可以这样做：

```
byte[] FromNativeArray(IntPtr nativeArray, int len)
{
    byte[] retval = new byte[len];
    Marshal.Copy(nativeArray, retval, 0, len);
    return retval;
} 
```

而在另一个方向，没有什么可做的。如果你有一个，`byte[]`那么你可以简单地将它传递给你的 DLL 函数，该函数期望接收一个 char*。

**C++**

```
void ReceiveBuffer(char* arr, int len); 
```

**C＃**

```
[DllImport(...)]
static extern void ReceiveBuffer(byte[] arr, int len);
....
ReceiveBuffer(arr, arr.Length); 
```

# c++ - 使用 cout 以精度 4 打印双精度

> ID：13728425
> 
> 赞同：12
> 
> 时间：2012-12-05T16:58:48.257
> 
> 标签：c++, double, precision, cout

> **可能重复：**
> [在 C++ 中将双精度转换为固定小数点](https://stackoverflow.com/questions/3844010/convert-a-double-to-fixed-decimal-point-in-c)

假设，我有`double a = 0` 并且我想将它打印为`0.0000` .

我试过这个：

```
cout.precision(4) ; 
cout<<a<<endl ; 
```

但它`0`作为输出给出。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-12-05T17:00:27.647

你试一试：

```
#include <iomanip>
...
cout << fixed << setprecision(4);
cout << a << endl; 
```

见[这里](http://www.cplusplus.com/reference/iomanip/setprecision/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T18:01:09.837

```
#include <iomanip>
#include <iostream.h>

int main()
{
double a = 0.00;
// print a double, 2 places of precision 
cout << setprecision(4) << a << endl;
} 
```

# c++ - c++中两个向量的元素乘法

> ID：13728430
> 
> 赞同：17
> 
> 时间：2012-12-05T16:59:10.707
> 
> 标签：c++

我正在尝试使用两个向量进行以下数学运算：

```
v1 = [a1][a2][a3][a4][a5]
v2 = [b1][b2][b3][b4]b5] 
```

想计算：

```
v = [a2*b2][a3*b3][a4*b4][a5*b5] 
```

请注意，我不希望新向量中的第一个元素。

我想知道是否有比 for 循环（使用推回）更有效的（单行）方法在 c++ 中将（元素方式）两个向量相乘。我目前的做法如下，

```
for(long i=1;i < v1.size();++i){
v.push_back(v1[i]*v2[i]);
} 
```

我还尝试了以下方法，

```
 for (long i = 1; i < v1.size(); ++i){
     v[i-1] = v1[i]*v2[i];
 } 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-12-05T17:04:58.290

```
std::transform( v1.begin()+1, v1.end(),
                v2.begin()+1, v.begin(),  // assumes v1,v2 of same size > 1, 
                                          //       v one element smaller
                std::multiplies<int>() ); // assumes values are 'int' 
```

如果为空，您可以替换`v.begin()`为，您应该预先存储以避免多次分配。[`std::back_inserter(v)`](http://en.cppreference.com/w/cpp/iterator/back_inserter)`v``reserve()`

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-12-05T17:14:58.150

您可以查看[std::valarray](http://en.cppreference.com/w/cpp/numeric/valarray)。它旨在允许对数组中的每个元素进行数学运算。

# javascript - prettyphoto 不显示缩略图，但单击时会解析图像

> ID：13728431
> 
> 赞同：2
> 
> 时间：2012-12-05T16:59:10.677
> 
> 标签：javascript, wordpress, prettyphoto

我不得不将我的 wordpress 网站移动到我的托管服务器上的另一个目录文件夹。现在由于某种原因，在我网站的投资组合页面上，它没有显示灯箱图像的缩略图预览。单击缩略图时将显示图像，所以我知道它从正确的位置拉出正确的图像，但为什么它不显示预览缩略图？

这是一个链接：

任何帮助将非常感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T17:30:55.087

您没有定义 PrettyPhoto 用来拉拇指的 img src：

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T18:57:30.077

好的，根据您的评论，从一台服务器切换到另一台服务器已经停止了 aq_resize() 方法的工作。它被称为 Aqua-Resizer，这是 Github 页面；

[https://github.com/sy4mil/Aqua-Resizer/blob/master/aq_resizer.php](https://github.com/sy4mil/Aqua-Resizer/blob/master/aq_resizer.php)

它上面的[wiki](https://github.com/sy4mil/Aqua-Resizer/wiki)解释了它的用途，但是如果您所做的只是更改服务器，那么您将不得不查看其他解释，以了解它为什么不起作用。以下是您可以开始查看的列表；

确保您的 functions.php 仍然具有`require_once('aq_resizer.php');`该脚本的正确路径。确保脚本确实存在。如果是尝试更改文件的文件权限，看看是否有帮助。如果脚本使用缓存目录，请尝试更改对此的权限。

也可能是新服务器上的 PHP 版本不同（也许，我现在猜）？也检查一下。

# c# - FTP下载未将数据写入文件

> ID：13728433
> 
> 赞同：0
> 
> 时间：2012-12-05T16:59:17.513
> 
> 标签：c#, ftp

我编写了一个程序，它从远程 ftp 站点下载文件并将其保存到本地 c 驱动器，然后将该文件上传到单独的服务器。现在的问题是，当文件被下载时，它在本地 C 上创建的文本文件中没有数据，我不知道为什么会这样。这是我正在使用的代码

```
// Download File
    public void download(string remoteFile, string localFile)
    {

        try
        {
            // Create an FTP Request 
            ftpRequest = (FtpWebRequest)FtpWebRequest.Create(downhost + "/" + remoteFile);
            // Log in to the FTP Server with the User Name and Password Provided
            ftpRequest.Credentials = new NetworkCredential(downuser, downpass);
            // When in doubt, use these options
            ftpRequest.UseBinary = true;
            ftpRequest.UsePassive = true;
            ftpRequest.KeepAlive = true;
            /* Set HTTP Proxy to Null to avoid The Requested FTP Command Is Not Supported When Using HTTP Proxy error */
            ftpRequest.Proxy = null;
            // Specify the Type of FTP Request
            ftpRequest.Method = WebRequestMethods.Ftp.DownloadFile;
            // Establish Return Communication with the FTP Server
            ftpResponse = (FtpWebResponse)ftpRequest.GetResponse();
            // Get the FTP Server's Response Stream
            ftpStream = ftpResponse.GetResponseStream();
            // Open a File Stream to Write the Downloaded File
            FileStream localFileStream = new FileStream(localFile, FileMode.Create);
            // Buffer for the Downloaded Data 
            byte[] byteBuffer = new byte[bufferSize];
            int bytesRead = ftpStream.Read(byteBuffer, 0, bufferSize);
            // Download the File by Writing the Buffered Data Until the Transfer is Complete

            try
            {
                while (bytesRead > 0)
                {
                    localFileStream.Write(byteBuffer, 0, bytesRead);
                    bytesRead = ftpStream.Read(byteBuffer, 0, bufferSize);
                }

            }

            catch (Exception ex) { Console.WriteLine(ex.ToString()); }
            // Resource Cleanup
            localFileStream.Close();
            ftpStream.Close();
            ftpResponse.Close();
            ftpRequest = null;

        }
        catch (Exception ex) { Console.WriteLine(ex.ToString()); }
        return;
    } 
```

我使用在[http://www.codeproject.com/Tips/443588/Simple-Csharp-FTP-Class](http://www.codeproject.com/Tips/443588/Simple-Csharp-FTP-Class)找到的代码作为构建我的程序的基础，并且我已经完成了谷歌搜索其他人是如何编写他们的ftp 下载脚本，但无法找出未写入数据的任何原因。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-27T05:36:23.327

我在使用相同的方法时遇到问题。我确实找到了一种让系统工作的方法，但我不得不将`ftpstream`你的代码复制到另一个流中，如下所示：（在 vb.net 中，我知道，对不起）

```
ftpStream.copyTo(MySecondStream)
ftpStream.close()
'do whatever you want with the copy now
Return MySecondStream 
```

也许它与如何处理初始流以及它保持打开多长时间有关。我在这里发布了我的问题：[为什么我必须将 FTP 流复制到另一个变量才能将其返回给调用方法？](https://stackoverflow.com/questions/16766759/why-do-i-have-to-copy-an-ftp-stream-to-another-variable-to-return-it-to-the-call)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-23T22:41:28.000

我在上传时遇到了同样的问题。写入 0 个字节。代码在一台 FTP 服务器上运行，但在另一台服务器上不运行。只需执行以下操作：

```
 client.FtpStream.Flush();
                client.FtpStream.Close(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T01:32:36.033

我意识到这有点晚了，但是我在尝试使用该示例时遇到了同样的问题，我设法从此处获取了一个使用示例的 FTP 下载：

[http://www.techrepublic.com/blog/howdoi/how-do-i-use-c-to-upload-and-download-files-from-an-ftp-server/165](http://www.techrepublic.com/blog/howdoi/how-do-i-use-c-to-upload-and-download-files-from-an-ftp-server/165)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-05T17:04:22.113

刷新文件。`localFileStream.Flush();`在关闭它之前调用它。

# r - 将名称列为列表中的向量

> ID：13728445
> 
> 赞同：1
> 
> 时间：2012-12-05T17:00:11.470
> 
> 标签：r, list

从以下列表中获取的最快方法是什么：

```
 set.seed(1)
 mylist <- list(1:2,1:3,1:4)
 names(mylist) <- sample(LETTERS,3)

 mylist
$J
[1] 1 2

$V
[1] 1 2 3

$Z
[1] 1 2 3 4 
```

到具有包含列表名称的额外向量的列表，即

```
mylist
$J
[1] 1 2
[2] J J

$V
[1] 1 2 3
[2] V V V
$Z
[1] 1 2 3 4
[2] Z Z Z Z 
```

结果同样可以是数据框列表。某种

```
lapply(mylist, function(x) { data.frame(x=x,y=names(x)}) 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-05T17:13:18.917

另外一个选项：

```
df<-stack(mylist)
split(df, df$ind) 
```

也许这`stack(mylist)`就是你真正需要的？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-05T17:07:19.517

就个人而言，我喜欢@Matthew Plourde 使用`stack`

这是一个使用`mapply`保留原始列表相同结构的选项

```
mapply(function(L, N) 
     {names(L) <- rep(N, length(L)); L},   mylist, names(mylist)) 
```

### 结果：

```
$G
G G 
1 2 

$J
J J J 
1 2 3 

$N
N N N N 
1 2 3 4 
```

# javascript - Video.js 事件侦听器在 safari 和 chrome 中不起作用

> ID：13728447
> 
> 赞同：1
> 
> 时间：2012-12-05T17:00:17.757
> 
> 标签：javascript, cross-browser, video.js

我`video.js`用来播放 HTML5 视频，我添加了事件侦听器来检测视频何时结束。当视频结束时，我正在尝试播放下一个视频。它适用于除 Chrome 和 Safari 之外的其他浏览器。在他们两个中，第一个视频都在播放，但第二个视频没有。下面是我的代码：

```
<video id="home_video" class="video-js vjs-default-skin" 
  controls preload="none" width="640" height="264">
  <source src="latest.mp4" type='video/mp4'/>
  <source src="latest.ogv" type='video/ogg'/>
</video>
<script>
  var homePlayer = _V_("home_video");
  var myFunc = function () {
    var myPlayer = _V_("home_video");
    // Do something when the event is fired
    alert("hi");
    myPlayer.src([
      { type: "video/mp4", src: "latest1.mp4" }, 
      { type: video/ogg", src: "latest1.ogv" }]);
    myPlayer.play();
  };
  homePlayer.addEvent("ended", myFunc);
</script> 
```

注意：我在所有浏览器中都收到了警报，但第二个视频没有在 Safari 和 Chrome 中播放。

# java - jbutton RGBA 故障

> ID：13728448
> 
> 赞同：1
> 
> 时间：2012-12-05T17:00:20.910
> 
> 标签：java, swing, transparency, jbutton, rgba

我正在使用 RGBA 进行着色。我希望按钮透明，但能够设置透明度，因此是 alpha。现在它看起来很好，直到我做任何调用重绘/绘画的事情，比如悬停或聚焦。如果我将 opaque 设置为 false，它会使其透明，我只是不希望这 100% 透明。这也不是我在背景中绘制的图像。RGB没有问题，只有RGBA。

这些不起作用：

```
jButton1.setContentAreaFilled(true or false);
jButton1.setOpaque(true or false); 
```

这是我的 jButton 颜色代码：

```
jButton1.setBackground(new Color(255,0,0,100)); 
```

这是它的样子。![jbutton故障](../Images/0acf45e7347991fe90db0dd5634b5bf9.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T20:04:25.070

你的问题看起来像[这样](https://stackoverflow.com/questions/2163544/re-paint-on-translucent-frame-panel-component)。那里的答案可能会帮助您获得正确的半透明效果，但您需要在自定义中进行`ButtonUI`，如图[所示](https://stackoverflow.com/questions/5751311/creating-a-custom-button-in-java-with-jbutton/5755124#5755124)。

前：[![前](../Images/9dadc3d184beaa184731810244812222.png)](https://i.stack.imgur.com/B9aqS.png)

后：[![后](../Images/4454d37f33356197808e695ee4fe13af.png)](https://i.stack.imgur.com/jICOZ.png)

`ButtonUI`：![纽扣](../Images/3f3ecdb2333b2d1085bb28cf76682880.png)

# ms-access - Access 2010：用户登录或将记录限制为用户

> ID：13728453
> 
> 赞同：1
> 
> 时间：2012-12-05T17:00:33.377
> 
> 标签：ms-access

MS Access 2010 中是否可以限制用户可以在数据视图表单中看到的记录？例如，用户 A 应该只看到部门 A 的记录，而用户 B 应该只看到部门 B 的记录。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T17:28:50.557

创建一个使用您的业务规则作为约束的查询，以仅返回应允许用户访问的行的子集。然后使用该查询作为其记录源来构建您的表单。

该方法取决于两个条件：

1.  您有一种方法来识别当前用户。
2.  您可以将业务规则实现为查询`WHERE`子句。

您可以使用 API 方法获取当前用户的 Windows 帐户名称。[请参阅获取登录名](http://access.mvps.org/access/api/api0008.htm)中的示例。如果你的db文件是MDB格式，你可以设置ULS（用户级安全），并通过该`CurrentUser()`函数获取Access用户名。较新的 ACCDB 格式不支持 ULS，但 Access 2010 仍然可以使用 MDB 格式的 db 文件。

这些方法中的任何一种都可以满足第一个条件。您还可以开发代码来管理自定义用户帐户，但这对我来说似乎是太多额外的工作。

这样的事情可以将您的业务规则实现为查询`WHERE`子句。它使用`fOSUserName()`上面链接中的功能。

```
WHERE
    department = Switch(
        fOSUserName() = 'User A', 'department A',
        fOSUserName() = 'User B', 'department B') 
```

然而，一个不太脆弱的方法是内部连接一个表，该表包含与他们应该被允许查看的部门匹配的用户名。

# ios - 模态转场链

> ID：13728463
> 
> 赞同：5
> 
> 时间：2012-12-05T17:01:06.620
> 
> 标签：ios, modal-dialog, segue, viewcontroller

我有一个具有登录视图 ( `LognnViewController`) 的 iOS 应用程序，一旦用户成功通过身份验证，他们就会被带到另一个视图 ( `DetailEntryViewController`) 以输入一些简单的详细信息。
输入详细信息后，用户将被带到应用程序的主要部分，该部分由包含`TabViewController`各种其他视图的选项卡控制器 ( ) 组成。LogInViewController 对 the 执行模态转场`DetailEntryViewController`，`DetailEntryViewController`然后对 TabViewController 执行模态转场，因此我有一种模态转场链可以进入应用程序。当用户注销时，我想一直回到 LogInViewController 但是当我执行以下操作时：

```
[self.presentingViewController dismissModalViewControllerAnimated:YES]; 
```

...它弹出 TabViewController，我最终回到`DetailEntryViewController`第一个 LogInViewController 而不是。有什么方法可以让我轻松地回到第一个视图控制器，或者做这个模态segue链的事情会阻止我这样做。我有一个好主意，将一些代码放入`DetailEntryViewController` `viewWillAppear`: 如果用户已注销，它会自动弹出，但显然不允许在`viewWillAppear`:`viewDidLoad`等中调用关闭模式控制器。

关于如何实现这一点的任何想法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-05T17:39:06.470

我认为这不是实现您的应用程序的最佳结构。模态控制器应该用于临时中断程序流程，因此使用模态来获取您的主要内容并不理想。我这样做的方法是使您的选项卡栏控制器成为窗口的根视图控制器，然后在第一个选项卡的控制器中，从 viewDidAppear 方法模态显示登录控制器，因此它会立即出现（您将简要看到第一个选项卡的视图，除非您取消选中 segue 属性检查器中的“动画”框）。从那个显示细节控制器，然后关闭两个模态控制器以返回您的主要内容。当用户注销时，只需再次显示该登录控制器。我是这样实现这个想法的。在第一个选项卡的视图控制器中：

```
- (void)viewDidLoad {
    [super viewDidLoad];
    _appStarting = YES;
}

-(void)viewDidAppear:(BOOL)animated {
    [super viewDidAppear:animated];
    if (_appStarting) {
       [self performSegueWithIdentifier:@"Login" sender:self];
        _appStarting = NO;
    }
} 
```

然后在最后一个（在你的情况下是第二个）模态视图控制器中，我有一个按钮方法：

```
-(IBAction)goBackToMain:(id)sender {
    [self.view.window.rootViewController dismissViewControllerAnimated:YES completion:nil];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T17:41:57.480

我自己想出来了......只需要再上一层才能到达“根”视图控制器（LogInViewController）并发现这可以解决问题：

```
[[self.presentingViewController presentingViewController] dismissViewControllerAnimated:YES completion:nil]; 
```

正如我所说，我只是获取presentingViewController (DetailEntryViewController)，然后再上一层并获取该控制器的演示者(LogInViewController)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-23T18:37:59.057

我有类似的问题，我的“模态转场链”不受限制。我同意下面关于为不同事物设计的模态转场的答案和评论中的论点，但我喜欢模态转场的“水平翻转”动画，我找不到更简单的方法来复制它们......总的来说，我使用为一件事设计的东西来实现另一件事（例如链接模态控制器）没有任何问题。重复的“部分卷曲”动画也可以应用于某些应用程序中的某些场景。

所以我将模态控制器的堆栈实现为控制器的一个属性：

```
@interface ModalViewController : UIViewController
@property (nonatomic, retain) NSMutableArray *modalControllers;
@end 
```

当执行第一个模态segue时，堆栈在非模态控制器的prepareForSegue方法中创建：

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if ([[segue identifier] isEqualToString:@"modalSegue"]) {
        ModalViewController *controller =
            (ModalViewController *)[segue destinationViewController];

        controller.modalControllers = [NSMutableArray arrayWithObject: controller];
    }
} 
```

当一个模态控制器移动到另一个模态控制器时，目的地被添加到堆栈中（在 ModalViewCotroller 的方法中）

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if ([[segue identifier] isEqualToString:@"modalSegue"]) {
        ModalViewController *destController =
            (ModalViewController *)[segue destinationViewController];

        // add destination controller to stack
        destController.modalControllers = _modalControllers;
        [destController.modalControllers addObject: destController];
    }
} 
```

一次解除整个堆栈是最棘手的部分 - 你不能在下一个完成解除之前解除前一个控制器，所以循环不起作用，只有递归块才能做到这一点，避免内存泄漏是最棘手的（我还没有检查它，但我依靠[这个](https://stackoverflow.com/questions/8857507/recursive-blocks-in-objective-c-leaking-in-arc)）：

```
- (IBAction)dismissAllModalControllers: (id)sender
{
    // recursive block that dismisses one auth controller
    // all these dances are to avoid leaks with ARC
    typedef void (^voidBlockType)();
    __block void (^dismissController) ();
    voidBlockType __weak dismissCopy = ^void(void) {
        dismissController();
    };
    dismissController = ^void(void) {
        int count = [_modalControllers count];
        if (count > 0) {
            // get last controller
            UIViewController *controller =
                (UIViewController *)[_modalControllers lastObject];
            // remove last controller
            [_modalControllers removeLastObject];
            // dismiss last controller
            [controller
                // the first controller in chain is dismissed with animation
                dismissViewControllerAnimated: count == 1 ? YES : NO
                // on completion call the block that calls this block recursively
                completion: dismissCopy]; 
        }
    };

    // this call dismisses all modal controllers
    dismissController();        
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-05T17:03:14.633

```
[self.navigationController popToRootViewControllerAnimated:YES]; 
```

# java - 小程序加载错误 - Jasper 报告

> ID：13728470
> 
> 赞同：0
> 
> 时间：2012-12-05T17:01:17.817
> 
> 标签：java, applet, jasper-reports

我的小程序遇到了一个错误，我无法找出解决方案。我正在加载我的 java 小程序，其中包含一个简单的碧玉查看器。加载小程序时，它会引发以下异常：

```
SEVERE: Servlet.service() for servlet JasperReportServlet threw exception
java.lang.ClassNotFoundException: org.apache.commons.collections.ReferenceMap
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1358)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1204)
    at java.lang.ClassLoader.loadClassInternal(ClassLoader.java:320)
    at net.sf.jasperreports.extensions.DefaultExtensionsRegistry.<init>(DefaultExtensionsRegistry.java:96)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)
    at java.lang.reflect.Constructor.newInstance(Constructor.java:513)
    at java.lang.Class.newInstance0(Class.java:355)
    at java.lang.Class.newInstance(Class.java:308)
    at net.sf.jasperreports.engine.util.ClassUtils.instantiateClass(ClassUtils.java:59)
    at net.sf.jasperreports.extensions.ExtensionsEnvironment.createDefaultRegistry(ExtensionsEnvironment.java:80)
    at net.sf.jasperreports.extensions.ExtensionsEnvironment.<clinit>(ExtensionsEnvironment.java:68)
    at net.sf.jasperreports.engine.util.JRStyledTextParser.<clinit>(JRStyledTextParser.java:76)
    at net.sf.jasperreports.engine.fill.JRBaseFiller.<init>(JRBaseFiller.java:182)
    at net.sf.jasperreports.engine.fill.JRVerticalFiller.<init>(JRVerticalFiller.java:77)
    at net.sf.jasperreports.engine.fill.JRVerticalFiller.<init>(JRVerticalFiller.java:87)
    at net.sf.jasperreports.engine.fill.JRVerticalFiller.<init>(JRVerticalFiller.java:57)
    at net.sf.jasperreports.engine.fill.JRFiller.createFiller(JRFiller.java:142)
    at net.sf.jasperreports.engine.fill.JRFiller.fillReport(JRFiller.java:78)
    at net.sf.jasperreports.engine.JasperFillManager.fillReport(JasperFillManager.java:624)
    at com.dbhl.app.report.generator.JobUpdateGenerator.getJasperPrintObject(JobUpdateGenerator.java:279)
    at com.dbhl.app.report.JasperReportServlet.processJobUpdate(JasperReportServlet.java:153)
    at com.dbhl.app.report.JasperReportServlet.getJasperPrintObjectByLedgerType(JasperReportServlet.java:79)
    at com.dbhl.app.report.JasperReportServlet.service(JasperReportServlet.java:50)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:803)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:128)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:263)
    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:844)
    at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:584)
    at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:447)
    at java.lang.Thread.run(Thread.java:619) 
```

下面是我的小程序配置，我正在使用标准 Java 部署工具包加载小程序。

```
<script type="text/javascript" src="<%=basePath%>js/deployJava.js">
</script>

<script>
  var user = '<%=request.getParameter("user")%>';

  var attributes = {
    code : 'applet.EmbeddedViewerApplet.class',
    archive : '<%=basePath%>resources/appletviewer.jar,<%=basePath%>resources/jasperreports-applet-4.0.0.jar,<%=basePath%>resources/jasperreports-4.0.0.jar,<%=basePath%>resources/commons-collections-3.2.1.jar,<%=basePath%>resources/commons-logging-1.0.4.jar,<%=basePath%>resources/commons-beanutils-1.8.0.jar,<%=basePath%>resources/commons-digester-1.7.jar,<%=basePath%>resources/commons-javaflow-20060411.jar,<%=basePath%>resources/org-netbeans-core.jar',
    width : "100%",
    height : 600
  };

  var parameters = {
    fontSize : 16,
    REPORT_URL : '<%=basePath%>servlet/JasperReportServlet?startDate=<%=request.getParameter("startDate")%>&endDate=<%=request.getParameter("endDate")%>&user=' + user + '&reportType=<%=request.getParameter("reportType")%>'
  };

  var version = '1.4';
  deployJava.runApplet(attributes, parameters, version);
</script> 
```

我在小程序中需要的所有 jar 都存在于我的 webroot 的资源文件夹中，它们是

*   小程序查看器.jar
*   commons-beanutils-1.8.0.jar
*   commons-collections-3.2.1.jar
*   commons-digester-1.7.jar
*   commons-javaflow-20060411.jar
*   commons-logging-1.0.4.jar
*   jasperreports-4.0.0.jar
*   jasperreports-applet-4.0.0.jar
*   org-netbeans-core.jar

所有的罐子都是今天签名的，所以没有过期。我已经仔细检查了所有内容，但它总是显示上述错误。在 iReport 中，我可以查看报告，它被编译为 jasper 对象，没有错误。

[控制面板中的 java 控制台](http://pastebin.com/Xt6303tT)

我在临时缓存中检查了集合文件已成功下载，并且在上面的控制台日志中显示 jar 已成功下载到主机。 **为什么会这样`ClassNotFoundException`？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T10:28:06.393

错误来自服务器端，我在跟踪控制台日志后才知道，在我的服务器类路径中缺少 comons-collections，我添加了它并且一切正常。

# python - MQL 查询的“空”结果。Freebase Schema：/film/film/starring & /film/actor/film

> ID：13728471
> 
> 赞同：2
> 
> 时间：2012-12-05T17:01:18.817
> 
> 标签：python, freebase, mql

第一次在这里发帖，所以我希望这是足够的细节。

我今天开始使用[freebase-python](http://code.google.com/p/freebase-python/)来获取我正在开发的程序的电影信息。我需要抓住的一件事是在电影中出演的演员名单。我已经遵循了一些教程和指南来做到这一点，并且可以获得导演或电影导演的电影列表，但是当我尝试对演员或电影演员做同样的事情时，我得到“空”结果。

我在 Python 和 Freebase MQL 查询编辑器中都遇到了同样的问题，您可以在下面看到我尝试过的内容。可以在[此处](http://jamesmedd.co.uk/stackoverflow_link_limit.html)找到编辑器中编写的以下所有示例的链接，因为 Stack Overflow 不允许我在第一篇文章的每个示例下方发布链接！

**Python中的工作**主管查询：

```
import freebase
fb = freebase.mqlread
q = {'type':'/film/film', 'name':'Inception', 'directed_by':[]}
fb(q) 
```

**Python 中的工作**导演的片目查询：

```
import freebase
fb = freebase.mqlread
q = {'type':'/film/director', 'name': 'Christopher Nolan', 'film':[]}
fb(q) 
```

基于这些测试，我尝试对演员做同样的事情，但结果很奇怪：

**在 Python 中不起作用**的演员表查询：

```
import freebase
fb = freebase.mqlread
q = {'type':'/film/film', 'name':'Inception', 'starring':[]}
fb(q) 
```

**在Python**中无法使用演员的电影查询：

```
import freebase
fb = freebase.mqlread
q = {'type':'/film/actor', 'name':'Leonardo DiCaprio', 'film':[]}
fb(q) 
```

奇怪的是，我得到了准确数量的演员/电影，但没有名字。有谁知道问题可能是什么？非常感谢，我会很感激任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T19:59:48.787

那是因为电影和演员没有直接联系，而是通过一个没有名字的“中介”节点。这是因为要同时连接三件事：1）电影，2）演员，3）角色/角色。

在编写任何 MQL 之前，您需要查看要使用的域/类型的架构，以了解信息的存储方式。

另请注意，如果您只是匹配名称，那么您将获得重拍的副本等。您应该跟踪 ID 以消除所有歧义。这是修改后的查询：

```
[{
  "type": "/film/film",
  "name": "Inception",
  "mid":  null,
  "starring": [{
    "actor": null,
    "mid":   null
  }]
}]​ 
```

# jsp - 填充 HTMLJSP 中的下拉列表，其中包含从 Servlet 中的数据库获取的值 我有一个数据库 flight_DB，其中包含一个名为 Passengers 的表。每位乘客都由其护照号码唯一标识。我想创建一个下拉列表，其中包含表乘客中的所有护照号码。如何使用 JSP 和 Servlet 实现这一点？假设您已经完成了模型和数据库部分（根据问题的评论），只需创建一个 servlet 类并相应地实现 doGet() 方法。这相对简单，只需从数据库中检索乘客列表，将其存储在请求范围内，然后转发给

> ID：13728485
> 
> 赞同：3
> 
> 时间：2012-12-05T17:02:01.060
> 
> 标签：jsp, servlets, drop-down-menu, html-select

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-05T17:16:07.567

假设您已经完成了模型和数据库部分（根据问题的评论），只需创建一个[servlet](https://stackoverflow.com/tags/servlets/info)类并`doGet()`相应地实现该方法。这相对简单，只需从数据库中检索乘客列表，将其存储在请求范围内，然后转发给应该呈现它的 JSP。下面的示例假设您使用 EJB/JPA 作为服务/数据库层，但是无论您使用什么服务/数据库层，您最终都应该最终`List<Passenger>`从中获得一个。

```
@WebServlet("/passengers")
public class Passengers extends HttpServlet {

    @EJB
    private PassengerService service;

    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        List<Passenger> passengers = service.list();
        request.setAttribute("passengers", passengers);
        request.getRequestDispatcher("/WEB-INF/passengers.jsp").forward(request, response);
    }

} 
```

创建一个使用[JSTL](https://stackoverflow.com/tags/jstl/info)对其进行迭代的[JSP](https://stackoverflow.com/tags/jsp/info)文件，每次都打印一个新的 HTML：`/WEB-INF/passengers.jsp` `<c:forEach>``<option>`

```
<%@taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
...
<select name="passenger">
    <c:forEach items="${passengers}" var="passenger">
        <option value="${passenger.id}"><c:out value="${passenger.name}" /></option>
    </c:forEach>
</select> 
```

*（此示例假设`Passenger`实体具有`id`和`name`属性）*

基本上应该是这样的。[只需像http://example.com/contextpath/passengers](http://example.com/contextpath/passengers)这样调用 servlet 的 URL 来打开页面。

### 也可以看看：

*   [Servlet 中的 doGet 和 doPost](https://stackoverflow.com/questions/2349633/doget-and-dopost-in-servlets)
*   [使用 MVC 和 DAO 模式在 JSP 页面的 HTML 中显示 JDBC ResultSet](https://stackoverflow.com/questions/5003142/jsp-using-mvc-and-jdbc)
*   [在 JSP/Servlet 中填充级联下拉列表](https://stackoverflow.com/questions/2263996/populating-child-dropdownlists-in-jsp-servlet)

# python - 如何以功能方式对元素求和

> ID：13728486
> 
> 赞同：5
> 
> 时间：2012-12-05T17:02:03.920
> 
> 标签：python, functional-programming

我正在尝试编写一个函数，该函数映射列表的元素，以使用 python 以函数样式获取元素和列表中先前元素的总和，例如：

```
func([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]) = [0, 1, 3, 6, 10, 15, 21, 28, 36, 45] 
```

我尝试过使用递归，但得到`RuntimeError: maximum recursion depth exceeded`了一个很长的列表。：

```
def recursion_way(inlist, accu, summ):
    if len(inlist) == 0:
         return accu
    else:
        return recursion_way(inlist[1:], accu + [summ + inlist[0]], summ + inlist[0]) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-05T17:04:41.903

理解算不算？

```
>>> [sum(l[:i]) for i, _ in enumerate(l)]
[0, 0, 1, 3, 6, 10, 15, 21, 28, 36] 
```

或者也许使用`reduce`：

```
reduce(
    lambda (sums, last), x: (sums+[x+last], x+last),
    l, ([], 0)
)[0] 
```

或者另一种方式：

```
reduce(lambda sums,x: sums+[x+sums[-1]], l[1:], l[:1]) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T17:05:56.153

这是以函数式编程风格完成的累积和：

```
def func(l):
   if len(l) < 2: return l
   sub = func(l[:-1])
   return sub + [sub[-1] + l[-1]]

print func([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-05T17:08:29.280

怎么减？慢，但有趣，imo。

```
def func(p):
    for i in xrange(1, len(p)+1):
        yield reduce(lambda x, y: x + y, p[0:i])

>>> list(func(p))
[0, 1, 3, 6, 10, 15, 21, 28, 36, 45] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-05T17:16:01.000

这是我得到的，使用递归：

```
def f(L, n=0):
    # If the list is empty, that means we went through all the elements there
    if len(L)>0:
        # n is the last element in the sum list. Add to it the first remaining element
        n = n+L[0]
        # Return a list containing the newest item and those of the remaining elements
        return [n] + f(L[1:], n)
    else:
        # It it is empty, there are no more sums to calculate
        return [] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-05T17:05:41.240

你可以使用numpy吗？

```
import numpy
numpy.cumsum([0,1,2,3,4,5,6,7,8,9])
array([ 0,  1,  3,  6, 10, 15, 21, 28, 36, 45]) 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2012-12-05T17:06:50.333

```
l = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
reduce(lambda x, y: x+y, l) 
```

# objective-c - 在 C id __strong * 数组中赋值时偶尔出现 EXC_BAD_ACCESS

> ID：13728487
> 
> 赞同：0
> 
> 时间：2012-12-05T17:02:06.253
> 
> 标签：objective-c, malloc, automatic-ref-counting, exc-bad-access

在数组`EXC_BAD_ACCESS`中分配值时出现崩溃`id __strong *`

这是代码

```
 id __strong *entries;
    entries = (id __strong *)malloc(sizeof(id) * 20);

    for (NSUInteger j = 0; j < 20; j++)
    {

        entries[j] = @{@"key1" : @"value1",  // Crash
                       @"key2" : @"value2",
                       @"key3" : @"value3"]};
    }

    //...

    free(entries); 
```

价值是什么并不重要。即使这样：

```
 entries[j] = [NSNumber numberWithInt:1]; 
```

崩溃。

它不会每次都崩溃，但会在几次尝试中发生。在索引 0 处分配值时会发生崩溃，因此它不会在 for 循环的中途发生，并且切断 for 循环并不能修复崩溃。

启用`NSZombies`停止似乎会发生崩溃，但没有输出抱怨任何僵尸。使用 Zombies Instrument 时也会发生同样的情况 - 没有崩溃，没有僵尸输出。启用 Guard Malloc 似乎也可以阻止崩溃。

更改`__strong`为`__autoreleasing`似乎也可以阻止崩溃，但这真的是解决问题的方法吗？如果是，为什么？

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T17:29:51.507

我不是 100% 确定，但你不应该使用 calloc 吗？

```
 entries = (id __strong *)calloc(sizeof(id), 20); 
```

也许这就是问题所在，因为它不是零初始化的。在释放之前，您需要将变量清零。

# sql - 如何填补 Postgres 查询中的时间戳空白？

> ID：13728489
> 
> 赞同：7
> 
> 时间：2012-12-05T17:02:30.263
> 
> 标签：sql, postgresql, timestamp, gaps-and-islands

给定下表：

```
CREATE TABLE channel1m (
  ts TIMESTAMP WITHOUT TIME ZONE NOT NULL,
  itemId BIGINT,
  value BIGINT
) 
```

**每个 itemId 每分钟***可以*插入一行，如下所示：

 **```
ts                    itemId         value
2012-12-03 15:29:00   100            1
2012-12-03 15:30:00   100            2
2012-12-03 15:30:00   101            0
2012-12-03 15:32:00   100            1
2012-12-03 15:32:00   101            1 
```

我找不到一种方法（不创建额外的表）来编写一个通过返回`NULL`值来填充时间间隔的查询（例如，对于 itemId 101 的 15:29:00 和两个项目的 15:31:00）。

预期的结果集将是：

```
ts                    itemId         value
2012-12-03 15:29:00   100            1
2012-12-03 15:29:00   101            NULL
2012-12-03 15:30:00   100            2
2012-12-03 15:30:00   101            0
2012-12-03 15:31:00   100            NULL
2012-12-03 15:31:00   101            NULL
2012-12-03 15:32:00   100            1
2012-12-03 15:32:00   101            1 
```

我找到了具有完整系列时间戳的单独时间表的解决方案，但我更愿意单独在查询中解决这个问题。这可能吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-05T17:22:38.040

```
DROP SCHEMA tmp CASCADE;
CREATE SCHEMA tmp ;
SET search_path = tmp;

DROP TABLE IF EXISTS channel1m CASCADE;
CREATE TABLE channel1m (
  zts TIMESTAMP WITHOUT TIME ZONE NOT NULL,
  zitemid BIGINT,
  zvalue BIGINT
);

-- in which a row may be inserted each minute, per zitemid, as follows:

INSERT INTO channel1m(zts, zitemid, zvalue) VALUES
 ('2012-12-03 15:29:00',   100,            1)
,('2012-12-03 15:30:00',   100,            2)
,('2012-12-03 15:30:00',   101,            0)
,('2012-12-03 15:32:00',   100,            1)
,('2012-12-03 15:32:00',   101,            1)
        ;

        -- CTE to the rescue!!!
WITH cal AS (
        WITH mm AS (
                SELECT MIN(xx.zts) AS minmin, MAX(xx.zts) AS maxmax
                 FROM channel1m xx)
        SELECT generate_series(mm.minmin , mm.maxmax , '1 min'::interval) AS stamp
        FROM mm
        )
, ite AS (
        SELECT DISTINCT zitemid AS zitemid
        FROM channel1m
        )
SELECT cal.stamp
        , ite.zitemid
        , tab.zvalue
FROM cal
JOIN ite ON 1=1 -- Note: this is a cartesian product of the {time,id} -domains
LEFT JOIN channel1m tab ON tab.zts = cal.stamp AND tab.zitemid = ite.zitemid
ORDER BY stamp ASC
        ; 
```

输出：

```
NOTICE:  drop cascades to table tmp.channel1m
DROP SCHEMA
CREATE SCHEMA
SET
NOTICE:  table "channel1m" does not exist, skipping
DROP TABLE
CREATE TABLE
INSERT 0 5
        stamp        | zitemid | zvalue 
---------------------+---------+--------
 2012-12-03 15:29:00 |     101 |       
 2012-12-03 15:29:00 |     100 |      1
 2012-12-03 15:30:00 |     100 |      2
 2012-12-03 15:30:00 |     101 |      0
 2012-12-03 15:31:00 |     100 |       
 2012-12-03 15:31:00 |     101 |       
 2012-12-03 15:32:00 |     100 |      1
 2012-12-03 15:32:00 |     101 |      1
(8 rows) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-05T17:20:25.887

您将需要：带有 all 的表格`itemId`，以及带有所有必需日期的（伪）表格。

您可能拥有所有 distinct 的表`itemId`。让我们称之为`item_table`。

带有日期的伪表，您可以使用`generate_series('start_date','end_date', interval '1 minute')`. 详情[在这里](http://www.postgresql.org/docs/current/static/functions-srf.html)。

查询：

```
SELECT gs.ts, it.itemId, ch1m.value
FROM item_table it
CROSS JOIN generate_series('start_date','end_date', interval '1 minute') gs(ts)
LEFT JOIN channel1m ch1m ON it.itemId = ch1m.itemId 
                         AND gs.ts = ch1m.ts 
```

替换`'start_date','end_date'`为所需的值或从子查询中获取它们。

这个查询：

1) 建立所有对 item-time 通过`CROSS JOIN`

2) 获取`value`通过`LEFT JOIN`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-05T17:28:32.637

我认为最易读的方法是构建一系列表表达式。分钟和项目 ID 号之间的交叉连接将为您提供每种组合。

```
with all_minutes as (
  select ('2012-12-03 15:29'::timestamp + 
           (n || ' minute')::interval)::timestamp as ts
  from generate_series(0,10) n
),
item_ids as (
  select distinct itemid from channel1m
),
all_items_and_minutes as (
  select all_minutes.ts, item_ids.itemid from all_minutes cross join item_ids
)
select all_items_and_minutes.ts, all_items_and_minutes.itemId, channel1m.value
from all_items_and_minutes 
left join channel1m 
       on all_items_and_minutes.ts = channel1m.ts
      and all_items_and_minutes.itemid = channel1m.itemid
order by all_items_and_minutes.ts, all_items_and_minutes.itemid 
```

您可以用 SELECT 语句替换时间戳文字以获得您需要的实际范围。如果您有一个包含所有唯一项目 ID 编号的不同表，则最好从*该表**中*进行选择，而不是从 channel1m 表中选择不同的值。

 ** * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-03-03T18:43:08.353

1.  使用[`time_bucket`](https://docs.timescale.com/v1.2/api#time_bucket)或`date_trunc`创建存储桶边界。
2.  用于[`generate_series`](https://www.postgresql.org/docs/current/functions-srf.html)为您的时间范围生成空桶。
3.  用于`UNION`将空时间桶数据集与您的数据合并。
4.  用于`DISTINCT ON`为每个时间桶挑选唯一的行，优先选择那些有数据的行。

例子：

```
WITH
  timeseries_data AS (
    SELECT
      time_bucket(interval '5 minutes', started_at) time_bucket_start,
      count(distinct v1.value) unique_row_count
    FROM
      probe_execution pe1
    CROSS JOIN LATERAL (
      SELECT value
      FROM jsonb_array_elements(pe1.result)
    ) v1
    WHERE
      pe1.probe_id = 8 AND
      pe1.result_count > 0 AND
      pe1.started_at > now() - interval '1 day' AND
      pe1.ended_at < now()
    GROUP BY time_bucket_start
    UNION
    SELECT
      gs1 time_bucket_start,
      0 unique_row_count
    FROM
      generate_series(
        time_bucket(interval '5 minutes', now() - interval '1 day'),
        time_bucket(interval '5 minutes', now()),
        interval '1 minute'
      ) as gs1
  )
SELECT DISTINCT ON (td1.time_bucket_start)
  td1.time_bucket_start,
  td1.unique_row_count
FROM timeseries_data td1
ORDER BY td1.time_bucket_start, td1.unique_row_count DESC 
```***

# c# - OpenSubKey() 为我可以在 regedit.exe 中看到的注册表项返回 null

> ID：13728491
> 
> 赞同：88
> 
> 时间：2012-12-05T17:02:38.523
> 
> 标签：c#, registry

我正在尝试获取此键中子键的所有显示名称：

```
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall 
```

使用此代码：

```
 RegistryKey newKey;
     string val;

     string KeyPath64Bit = @"SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall";
     RegistryKey mainKey = Registry.LocalMachine.OpenSubKey(KeyPath64Bit);

     string[] RegKeys64Bits = Registry.LocalMachine.OpenSubKey(KeyPath64Bit).GetSubKeyNames();

     foreach (string s in RegKeys64Bits)
     {
        newKey = mainKey.OpenSubKey(s);
        val = newKey.GetValue("DisplayName", -1, RegistryValueOptions.None).ToString();
        if (val != "-1")
           file64.WriteLine(val);
     } 
```

运行代码后，我找不到我需要的键之一：

```
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{DA5E371C-6333-3D8A-93A4-6FD5B20BCC6E} 
```

它应该有显示名称：Microsoft Visual C++ 2010 x64 Redistributable - 10.0.30319，但是该`GetSubKeyNames()`方法给了我子键：`{DA5E371C-6333-3D8A-93A4-6FD5B20BCC6E}.KB2151757`它没有任何显示名称。

为什么我无法获得我需要的确切子密钥 ( `{DA5E371C-6333-3D8A-93A4-6FD5B20BCC6E}`) 以及如何获得它？

* * *

## 回答 #1

> 赞同：205
> 
> 时间：2012-12-05T17:38:37.310

默认情况下，64 位操作系统上的 32 位应用程序将查看`HKLM\Software\Wow6432Node`节点。要读取 64 位版本的密钥，您需要指定`RegistryView`：

```
using (var hklm = RegistryKey.OpenBaseKey(RegistryHive.LocalMachine, RegistryView.Registry64))
using (var key = hklm.OpenSubKey(@"SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall"))
{
   // key now points to the 64-bit key
} 
```

.NET 4.0 中添加了执行此操作的 API；如果您仍在使用 3.5，则需要使用 P/Invoke 访问 64 位密钥： [http ://www.rhyous.com/2011/01/24/how-read-the-64-bit -registry-from-a-32-bit-application-or-vice-versa/](http://www.rhyous.com/2011/01/24/how-read-the-64-bit-registry-from-a-32-bit-application-or-vice-versa/)

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2018-10-10T10:55:46.150

在 Visual Studio 2017 中转到

```
Project > Properties > Build > Uncheck **Prefer 32-bit** and Platform target as **Any CPU**. 
```

# android - 在我的手机android上安装本地数据库？

> ID：13728492
> 
> 赞同：0
> 
> 时间：2012-12-05T17:02:40.810
> 
> 标签：android, sqlite, cordova

我使用 PhoneGap 完成了移动 (Android) 应用程序的开发。我使用 PhoneGap builder 发布了版本 apk 以将其安装在我的手机上。问题是我的应用程序脱机，因为我使用本地数据库，我如何在手机上的应用程序中安装这个数据库。

Eclipse 正在使用 DDMS 文件资源管理器，但在电话上是如何发生的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T17:35:13.107

First, you dont need to install a database, you need to call openDatabase to create basic database, after that you need to create table and put in the values to them..

You can refer to the [API doc of Phone gap here](http://docs.phonegap.com/en/2.2.0/cordova_storage_storage.md.html#Storage)...

Sample code :

```
function populateDB(tx) {
     tx.executeSql('DROP TABLE IF EXISTS DEMO');
     tx.executeSql('CREATE TABLE IF NOT EXISTS DEMO (id unique, data)');
     tx.executeSql('INSERT INTO DEMO (id, data) VALUES (1, "First row")');
     tx.executeSql('INSERT INTO DEMO (id, data) VALUES (2, "Second row")');
}

function errorCB(err) {
    alert("Error processing SQL: "+err.code);
}

function successCB() {
    alert("success!");
}

var db = window.openDatabase("Database", "1.0", "Cordova Demo", 200000);
db.transaction(populateDB, errorCB, successCB); 
```

# java - 调用已经适用于单选按钮的函数，以便打印详细信息

> ID：13728493
> 
> 赞同：1
> 
> 时间：2012-12-05T17:02:42.180
> 
> 标签：java, swing, processbuilder

有一个小问题，不确定如何调用特定函数来打印其详细信息。我创建了一个单选按钮，用于检查 PC 上的总物理内存，也有一个用于 GPU 的按钮，两者都可以正常工作。

现在我不知道如何调用相同的函数，以便在我对特定系统属性进行系统扫描时打印在更大的窗口中。

```
if (isWindows()) {

        jTextArea1.setText(header + "User Name : " + name
                + "\nOperating System :" + jComboBox1.getSelectedItem()
                + "\nSelected Gamer Ability : " + this.jComboBox4.getSelectedItem()
                + "\nSelected Age Group :" + this.jComboBox5.getSelectedItem()
                + "\nSystem Version : " + System.getProperty("os.version")
                + "\nSystem Architecture : " + System.getProperty("os.arch")
  PROBLEM PART  + "\nSystem Total Ram : " + this.jRadioButton2......
                + "\nScan ID : " + n + "\n \n")

 }

private void jRadioButton1ActionPerformed(java.awt.event.ActionEvent evt)       {                                              
    String filepath = "..\\Checker\\src\\batchchecker\\memory.bat";
    try 
    {
        Process p = Runtime.getRuntime().exec(filepath); // filepath
        p.waitFor();
        InputStream in = p.getInputStream();
        ByteArrayOutputStream baos = new ByteArrayOutputStream();
        int c = -1;
        while ((c = in.read()) != -1) 
        {
            baos.write(c);
        }
        String response = new String(baos.toByteArray());
        jRadioButton2.setText(evt.getActionCommand());
        JOptionPane.showMessageDialog(null, "" + evt.getActionCommand()
            + response);

        }
        catch (Exception e) 
        {
            e.printStackTrace(System.err);
        }
    }
} 
```

从上面的代码可以看出，我的收音机做了它需要做的事情并经过了测试。我只是不确定如何将相同的结果称为更大的图景，它实际打印所有细节以及其余部分。代码行是`+ "\nSystem Total Ram : " + this.jRadioButton2......`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T17:43:05.250

似乎您只需要将实现移动到一个单独的方法，该方法可以从您的 actionPerformed() 方法和您的其他调用中调用。例如：

```
public String findMemoryDetails() {
    // ... put code here
} 
```

然后在这里调用它：

```
private void jRadioButton1ActionPerformed(java.awt.event.ActionEvent evt) {
    String memDetails = findMemoryDetails();
    JOptionPane.showMessageDialog(null, "" + evt.getActionCommand() + memDetails);
} 
```

和这里：

```
+ "\nSystem Total Ram : " + findMemoryDetails() 
```

# ghostscript - CentOS 5.3 上的 GhostScript - 无法处理 JPXDecode 数据

> ID：13728500
> 
> 赞同：6
> 
> 时间：2012-12-05T17:02:54.227
> 
> 标签：ghostscript, centos5

我正在尝试让我们的服务器将 PDF 转换为图像文件。这是一个CentOS 5.3系统，并且已经安装了最新版本的ghostscript，可以是（8.70）。

当我尝试转换 PDF 时，每页都重复出现以下错误，结果是加载了一堆空白图像。

```
**** ERROR: Unable to process JPXDecode data. Page will be missing data. 
```

所以，我在这里找到了一个似乎回答了这个问题的答案：

[iText PDF；如何使用 Java 将 jpeg2000 转换为 jpg](https://stackoverflow.com/questions/8556271/itext-pdf-howto-convert-jpeg2000-to-jpg-using-java)

之后我下载了 iText 5.3.4 和 jai_imageio-1.1.jar 并在我的本地机器上编译了提供的脚本。当我在我的 PDF 上运行最终转换命令时，我得到：

```
java.lang.NullPointerException
at com.itextpdf.text.pdf.parser.PdfImageObject.decodeImageBytes(PdfImageObject.java:296)
at com.itextpdf.text.pdf.parser.PdfImageObject.<init>(PdfImageObject.java:199)
at com.itextpdf.text.pdf.parser.PdfImageObject.<init>(PdfImageObject.java:158)
at PDFConverter.hasJpeg2000(PDFConverter.java:36)
at PDFConverter.main(PDFConverter.java:15)
Doesn't contain any JPEG2000 images: Nothing to be done... 
```

我不确定这是否肯定是说 PDF 没有任何 JPEG2000 图像，或者我在编译脚本时是否做错了什么。也许我得到了错误版本的 iText，因为在其他问题的答案中没有提供链接。

所以现在我需要帮助来转换我的 PDF 以删除任何 JPEG2000 图像，或者我需要帮助来让我们的服务器正确运行 ghostscript。

# jquery - 触发 OnClick 并从 asp ImageButton 打开一个对话框

> ID：13728504
> 
> 赞同：0
> 
> 时间：2012-12-05T17:03:05.383
> 
> 标签：jquery, jquery-ui-dialog, imagebutton

为我的[问题](https://stackoverflow.com/q/13707166/1528483)寻找解决方案我发现了另一个我找不到解决方案的疑问，这就是为什么我在这里寻求专家的知识。我在 Repetear 中有一个图像按钮，如下所示：

```
<asp:ImageButton class ="approvalDialog" runat="server" OnClick = "test_rr" CommandArgument = '<%# Eval("aux_approvalId")%>'/> 
```

我的问题是类approvalDialog正在打开一个jQuery对话框，如果它被打开，事件不会被触发，如果我删除class =“approvalDialog”，事件会被触发。

所以我的问题是：如果可能打开对话框并同时触发事件？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T17:07:07.230

使用 onclientclick = "javascriptfunction();"

如果它不能同时工作，请查看此帖子 [堆栈帖子](https://stackoverflow.com/questions/2155048/onclientclick-and-onclick-is-not-working-at-the-same-time)

您还可以创建一个 jquery/javascript 函数可以使用 ajax 调用调用的 webmethod。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T16:51:09.057

是的，这是这样工作的：

```
<td class ="approval-img"><asp:ImageButton runat="server" CommandArgument = '<%# Eval("aux_approvalId")%>'  OnClick="getApprovalID_approve" OnClientClick="OpenApprovalDialog()" ToolTip="Approve" ImageUrl="/Images/Approve.png" /></td> 
```

我的问题，我在 firebug 的控制台看到，是我调用的 javascript 函数没有定义，那是因为我已经在 $(document).ready(function ()

# javascript - 如何检测空格被退格或删除

> ID：13728505
> 
> 赞同：6
> 
> 时间：2012-12-05T17:03:05.413
> 
> 标签：javascript, jquery, keycode, backspace

我需要找到一种方法来检测空格是否被删除或退格，如果是这种情况，则运行一个函数。我正在用 JavaScript / jQuery 做这个。

我知道我可以通过以下方式获得删除或退格键按下：

```
$(this).keyup(function(event) {
        event.keyCode 
```

但是，我不知道如何判断 delete 或 backspace 命令是否删除了空格？

非常感谢任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T17:09:12.130

绑定到 keydown 并比较前后的值，看看它是否减小了大小。

```
$(input).keydown(function(){
    var currVal = this.value, self = this;
    setTimeout(function(){
        if ( currVal.length > self.value.length ) {
            console.log(currVal.length - self.value.length + " characters have been removed.");
        }
    },0);
}); 
```

[http://jsfiddle.net/ymhjA/1/](http://jsfiddle.net/ymhjA/1/)

更新示例：

```
$("input").keydown(function() {
    var currVal = this.value,
        self = this;
    setTimeout(function() {
        if (currVal.length - self.value.length === 1) {
            var origVal = $.grep(currVal.split(""),function(val){
                return val === " ";
            });
            var newVal = $.grep(self.value.split(""),function(val){
                return val === " ";
            });
            if ( origVal.length != newVal.length ) {
                console.log("a space was removed");
            }
        }
    }, 0);
});​ 
```

[http://jsfiddle.net/ymhjA/4/](http://jsfiddle.net/ymhjA/4/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-05T17:24:17.080

见这里：http: [//jsfiddle.net/Txseh/](http://jsfiddle.net/Txseh/)

```
(function(){
    var currentWhitespaceCount;

    $("input").keyup(function(e){
        var newCount = ($(this).val().match(/\s/g) || []).length;

        if (newCount < currentWhitespaceCount)
            alert("You removed one or more spaces, fool.");

        currentWhitespaceCount = newCount;
    });
})();​ 
```

它跟踪输入中当前空白字符的数量，如果数字下降，它会发出警报（或做任何你想做的事情）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-05T17:11:23.567

预先缓存该值（在按键上设置一个值）并与按键后的值进行比较。这是确定一个或多个空格已被删除的唯一方法。对键的任何检查都依赖于您能够找出哪些可能的键可以去除空间，并且可能会留下孔。

例如，选择一个单词的最后一个字母及其后面的空格，如果我们按下最后一个字母，它将删除空格。但是按下的键不是退格键或删除键。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-05T17:36:02.387

实际上这是我的代码[http://jsbin.com/atuwez/3/edit](http://jsbin.com/atuwez/3/edit)

```
 var input = $('#input'),
     afterLength,
     beforeLength;

input.on({
  'keydown': function () {
    beforeLength = input.val().split(/\s/).length;
  },
  'keyup': function(event) {
    var key = event.keyCode || event.charCode;

    if( key == 8 || key == 46 ) {
          afterLength = input.val().split(/\s/).length;
          console.log(beforeLength == afterLength);
    }
  }

}); 
```

# ruby-on-rails - 电子邮件参数的默认字段？在本地测试电子邮件

> ID：13728508
> 
> 赞同：2
> 
> 时间：2012-12-05T17:03:22.283
> 
> 标签：ruby-on-rails, ruby, sendgrid

`\incoming_emails`我的应用通过来自 Sendgrid 的 POST 请求将传入的电子邮件传送到路由。据我所知，POST 请求包含一个参数哈希，其中包括以下字段：

`params["to"] params["from"] params["subject"]`

对于测试，细读 params 哈希的最佳方法是什么？我可以轻松地使用`logger`发布 的内容`params`，但我该如何在本地发布（我可以轻松地在生产中向自己发送电子邮件，但不确定如何在本地发布）？某处是否有常规电子邮件的参数列表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T17:12:00.340

在系统的某处创建电子邮件（桌面，最简单）。取自[Railscasts](http://railscasts.com/episodes/313-receiving-email-with-mailman)的电子邮件格式。

~/桌面/email.eml

```
Date: Fri, 30 Dec 2011 14:00:00 -0800
From: foo@example.com
Subject: Mailman Test
To: support@example.com

This is a test email for use with Mailman.

Does this work? 
```

然后使用 curl 在本地发送电子邮件。取自[这个 Stackoverflow 问题](https://stackoverflow.com/questions/11917473/http-post-request-sent-via-curl-against-rest-server-looses-json-parameters)。

```
curl -X POST -d ~/Desktop/email.eml http://localhost:3000/incoming_emails 
```

# javascript - 如何在 D3 可视化的文本元素中包含链接？

> ID：13728513
> 
> 赞同：4
> 
> 时间：2012-12-05T17:03:38.447
> 
> 标签：javascript, svg, d3.js

我正在尝试添加指向此 D3 可视化的文本元素的链接：

[http://bl.ocks.org/1093025](http://bl.ocks.org/1093025)

我希望能够单击“flare”、“analytics”并导航到另一个页面或单击矩形并执行正常操作，即扩展子树。

我尝试了一些不起作用的方法：

*   `on`事件

我试图向元素添加一个`on`事件：`svg:text`

```
nodeEnter.append("svg:text")
  .attr("dy", 3.5)
  .attr("dx", 5.5)
  .text(function(d) { return d.name; })
  .on("click",function(d,i) { alert("Clicked on the text");}); 
```

*   `foreignObject`元素

我试图添加这样的`foreignObject`元素：

```
 nodeEnter.append("svg:foreignObject")
  .style("float","right")
  .attr("height", 100)
  .attr("width", 100)
  .append("div")
  .html("<a href='#'>link</a>") 
```

尽管它创建了链接，但它是一个额外的链接（不是矩形中的文本元素）。

*   与`xlink:href`属性链接

最后，我还尝试了以下方法（在某些组合中）：

```
<a xlink:href="/svg/index.html">
    <text x="10" y="20">/svg/index.html</text>
</a> 
```

但它也没有奏效。

有什么建议么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-06-12T10:43:34.400

我同意马特的回答：指针事件...将其更改为`pointer-events: all`在 css 中。

这就是我在力有向图中建立链接的方式：

```
svg = d3.select("body").append("svg");

svg.selectAll(".node")
  .append("svg:a").attr("xlink:href", function(d){ return "generic.php?url=" + d.url })
  .append("svg:text")
  .text(function(d) { return d.name; })
  .attr("dy", 3.5)
  .attr("dx", 5.5)
  .attr("text-anchor", "middle");
  //The End ;-) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-06T10:51:49.837

`.on('click', function () {})`应该只要你工作

*   选择了正确的节点
*   尚未使用 css 禁用文本元素上的指针事件

指针事件似乎吸引了人们，因为很多示例都有`pointer-events: none`文本节点。

# forms - 在表单 VB6 中显示用户控件

> ID：13728516
> 
> 赞同：4
> 
> 时间：2012-12-05T17:03:58.433
> 
> 标签：forms, user-controls, vb6

我想将 UserControl 显示到表单中，这意味着我需要一个表单来执行多个表单
，请参阅此图像了解详细信息：

![只是一个例子](../Images/5748d1f09df54db19e2e2f5dc450f7ba.png)

有人可以帮我怎么做吗？再说一次，我必须选择什么类型才能使用用户控件（标准 EXE、ActiveX EXE 或其他）。

**注意：**请**不要**关闭这个问题，我只是想知道。谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-05T17:25:21.873

1- 在您的设计器中关闭用户控件，使它们在工具箱中可用。

2-将它们拖放到您的主窗体上，使它们大小相同...

3- 使用这样的代码进行操作：

```
Private Sub Operation1()
    UserControl1.Visible = True
    UserControl2.Visible = False
End Sub

Private Sub Operation2()
    UserControl1.Visible = False
    UserControl2.Visible = True
End Sub 
```

[选择用户控件类型！]

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-05T17:25:50.753

最简单的方法，尽管非常不雅，是将所有控件添加到表单并根据需要设置它们的可见状态。不过，这通常被认为有点杂乱无章。

问题不在于用户控件或编程环境，而在于设计没有遵循典型的 Windows UI“流程”。您可能希望根据更有用的工作流程进行重新设计。

您可能只是询问如何在 VB 项目中使用 UserControls，如果是这样，那么您应该在一个项目中开发 UserControls，制作它（以便将它们添加到工具箱中），然后在另一个项目中开发表单使用工具箱中的新用户控件。为了调试用户控件，您将需要运行两个 VB 实例，一个用于 Usercontrols 项目，另一个用于表单。

# asp.net-mvc - MVCFoolProof 不适用于我的单元测试项目中的 AutoMapper

> ID：13728524
> 
> 赞同：0
> 
> 时间：2012-12-05T17:04:28.323
> 
> 标签：asp.net-mvc, model-view-controller

虽然我的主应用程序工作正常，但当我尝试在单元测试项目的初始化中执行“Mapper.AddProfile”方法时，单元测试项目出现以下错误。

'Foolproof.ContingentValidationAttribute' 的类型初始值设定项引发了异常。

无法加载文件或程序集“System.Web.Mvc，Version=2.0.0.0，Culture=neutral，PublicKeyToken=31bf3856ad364e35”或其依赖项之一。找到的程序集的清单定义与程序集引用不匹配。（来自 HRESULT 的异常：0x80131040）

我没有在我的主项目中的任何地方使用 MVC 2.0.0.0，也没有在测试项目中使用过 MVC 2.0.0.0。这两个项目都引用了 MVC 4.0.0.0

可能是什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T17:15:52.270

看起来 MVCFoolProof 项目引用了 MVC2。请参阅此处：[CodePlex 源代码](http://foolproof.codeplex.com/SourceControl/changeset/view/94877#1188719)- 您可以尝试将源代码拉下来并针对 MVC4 自行编译。

# html - !HTML 类标签的重要等价物？

> ID：13728527
> 
> 赞同：0
> 
> 时间：2012-12-05T17:04:39.290
> 
> 标签：html, css, class, tags

我正在处理一个网站的真实哈希，所以这就是我问这个荒谬问题的原因。

我到处寻找某种方法来使一个类覆盖 HTML 类标记中的另一个类，但无济于事。

我可以这样做，尝试解开一吨意大利面（无论如何我可能不会被允许这样做），或者其他任何人都可以推荐的东西（将不胜感激）。

这可能吗？

```
class="myClass !important" 
```

如果没有，是否有某种等价物？

请帮忙！提前谢谢了！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T17:07:13.127

不，那是不可能的。恐怕您将不得不自己解决[CSS 特异性。](https://developer.mozilla.org/en-US/docs/CSS/Specificity)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-05T17:09:53.570

您不能`!important`用于整个选择器。您需要找到要覆盖的特定规则，并`!important`在每个规则上使用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-05T19:25:40.253

如果您有能力更改 HTML 模板，您可以随时进入并添加一个`<div id="override">`或类似的东西到页面的最外层包装器中，以用作 CSS 类中的“主”规则。然后，在 CSS 中，您只需在任何现有类或您需要修改的类之前添加该 ID。

例如，如果您有以下内容并想要覆盖 .some-class：

```
<div class="some-class">Bleh.</div> 
```

以及相应的CSS：

```
.some-class { color: red; } 
```

您可以使用以下方法包装整个内容：

```
<div id="override">
    <div class="some-class">Bleh.</div>
</div> 
```

并在 .some-class 之前添加 #override （或任何您想命名的名称），此规则将优先于另一个：

```
#override .some-class { color: green; } /* This will override the red color form the other rule */
.some-class { color: red; } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-05T17:15:28.793

您可以向选择器添加多个类，如下所示：

```
class="myClass myClass2" 
```

以上是您的 HTML 元素上的 class 属性。

就 CSS 而言，定义类如下：

```
.myClass {
    color: black;
    font-size: 14px;
} 
```

以上只是您可能拥有的一些属性的示例。

在样式表中的“myClass”之后定义“myClass2”将允许“myClass2”中的属性覆盖“myClass”中的匹配属性：

```
//This goes below myClass
.myClass2 {
    font-size: 16px;
} 
```

只要“myClass2”在“myClass”之后，你的字体就会采用'16px;'的大小属性 “myClass”的值将被“myClass2”的值覆盖。如果 "myClass2" 出现在 "myClass" 之前，您可以使用 !important 来确保样式被稍后定义的样式取代：

```
//This goes above myClass
.myClass2 {
    font-size: 16px !important;
} 
```

希望这可以帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-05T17:17:10.810

CSS 类只是一组样式，因此您可以使用`class`而不是内联`style`标记。该`!important`关键字可帮助您覆盖特定样式而不是处理类。因此，例如：

假设我们`div`在 CSS 文件的每个地方都有一个 CSS 规则

```
div{border:solid 1px #ff0000;} 
```

后来我们有了这个规则：

```
div{background:#000000;} 
```

我们页面中的每一个`div`都将带有`border`和 a`background`如果我们想要覆盖`div`css 规则，我们需要执行以下操作：

```
div{background:none !important;border:none !important;/*...ADD YOUR CSS...*/} 
```

您可以创建一个 css 重置类来重置您想要的所有设置，然后添加您的 css

# c# - 将 MySQL 中的项目存储到多个变量中

> ID：13728532
> 
> 赞同：1
> 
> 时间：2012-12-05T17:04:57.243
> 
> 标签：c#, mysql

我编写了一个 SQL 选择语句，它从表中的 1 条记录中返回多个字段。

这是我的声明：

```
-- (item_num being the PK)
SELECT item_num, 
       category, 
       weight, 
       cost, 
       description 
  FROM inv 
 WHERE item_num = @inumber; 
```

如何将每个字段保存到变量中？

我见过用 while 循环编写的示例，但我的语句返回整数和字符，所以我想将它们保存到可敬的变量而不是数组中。

请多多包涵，因为我是使用编码处理数据库的新手。我只需要更好地理解格式。

我已经搜索了答案，但找不到任何相关内容。也许我的方法都是错误的。

感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T17:15:03.297

最终，您应该使用 Datareader，并且可以将值直接分配给变量；

```
using (var rdr = db.ExecuteReader(cmd))
{
    myIntValue = (int) rdr["IntValue"];
    myStringValue = rdr["StringValue"].ToString();
} 
```

但是，在您的情况下，我的建议是使用 DTO 并从您的数据层相应地填充这些

```
 public class MyDTO
    {
        public int MyInt { get; set; }
        public string MyString { get; set; }
    } 
```

并返回`IEnumerable<MyDTO>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T17:11:55.523

首先，您的回报不会是整数和字符。这将是字符串。至少，这是我的经验。您应该将它们全部存储在 MySQL 数据读取器中。这将允许您执行以下操作：

```
List<string> weight = new List<string>();

while(dataReader.Read())
{
     weight.Add(dataReader["weight"]);
} 
```

它的作用是从“权重”列下的所有查询结果中创建一个字符串列表。从那里，如果您需要它们成为字符和整数，您可以转换它们。但我建议您阅读[MySQL datareaders](http://www.devart.com/dotconnect/mysql/docs/Devart.Data.MySql~Devart.Data.MySql.MySqlDataReader.html)。我上面的例子并不完美，但它是一个开始。

# windows-phone-7 - Windows Phone：找到按钮的 VerticalOffset

> ID：13728533
> 
> 赞同：1
> 
> 时间：2012-12-05T17:04:57.223
> 
> 标签：windows-phone-7, windows-phone

在 Windows phone 中，如何找到按钮的 VerticalOffset？我有一个包含一堆内容的 ScrollView。我想使用 ScrollViewer.ScrollToVerticalOffset 到达特定点（一个按钮），但不知道如何获取该点的位置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T01:44:38.863

如果你有这两个项目，你应该能够使用`TransformToVisual`来获取一个控件相对于另一个控件的位置，然后使用它来滚动

请参阅[http://msdn.microsoft.com/en-us/library/system.windows.media.visual.transformtovisual.aspx](http://msdn.microsoft.com/en-us/library/system.windows.media.visual.transformtovisual.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T23:30:58.773

这就是我如何在我的应用程序中获取两个按钮的 x 和 y 坐标并移动它们。也许你可以做类似的事情：

```
Canvas.SetLeft(imUp, Canvas.GetLeft(imUp) + offsetX);
Canvas.SetLeft(imDown, Canvas.GetLeft(imDown) + offsetX); 
```

# c# - 如何获取 wmv 文件的时间码

> ID：13728540
> 
> 赞同：1
> 
> 时间：2012-12-05T17:05:08.760
> 
> 标签：c#, video, wmplib, timecodes

我在 WMPLib 中找到了 WindowsMediaPlayer，但没有找到 TimeCode！

任何人都知道如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T17:12:06.293

我相信您的问题的答案是您需要为文件中的每个流调用 IWMReaderTimecode::GetTimecodeRangeCount 。然后为每个流中的每个范围调用 IWMReaderTimecode::GetTimecodeRangeBounds 以获取每个范围的 startTimecode 和 endTimecode。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T17:26:07.047

查看这两篇文章[Get WMA/WMV meta information in C#](http://www.tech-archive.net/Archive/Media/microsoft.public.windowsmedia.sdk/2005-07/msg00240.html)和[Getting Current Time Code Using Windows Media Player Class in C#](http://social.msdn.microsoft.com/Forums/da-DK/winforms/thread/192cefd5-33e5-4fa3-8051-9b0893160964?persist=True)，您可以尝试以下操作：

```
using WMPLib; // this file is called Interop.WMPLib.dll 

WindowsMediaPlayerClass wmp = new WindowsMediaPlayerClass(); 
IWMPMedia mediaInfo = wmp.newMedia("myfile.wmv"); 

Console.WriteLine("Duration = " + mediaInfo.duration); 

for (int i=0; i<mediaInfo.attributeCount; i++) { 
    Console.WriteLine(mediaInfo.getAttributeName(i) + " = " + 
    mediaInfo.getItemInfo(mediaInfo.getAttributeName(i)) ); 
} 
```

或使用该`Controls.CurrentPositionString`属性获取当前时间。

```
Console.WriteLine(wmp.controls.currentPositionString); 
```

# internet-explorer-8 - ul 列表在 IE8 中无法正确呈现

> ID：13728543
> 
> 赞同：0
> 
> 时间：2012-12-05T17:05:29.703
> 
> 标签：internet-explorer-8, html-lists, html-rendering

当我的列表显示时，我的列表的第一个元素位于正确的位置，但从第二个到最后，它们都出现在项目符号下方而不是在它旁边：/

如果您需要查看代码，请访问[http://www.nsworld.org/development](http://www.nsworld.org/development)（点击美国）

我正在尝试解决这个问题，它只出现在 IE8 中，所有其他浏览器都完美显示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T17:13:27.867

关闭您的锚标签（以及您的列表项） - 它们只是被打开，但从未关闭：

```
"<li>"+"<a href='http://nsworld.org/'>"+"Foo"+""+""+"<br />"+"<br />"+ 
```

一般而言，此代码需要大量重新工作。有很多不必要的串联，这破坏了这条线的易读性（以及它周围的那些）。

此外，

我有几点建议。首先是您开始使用 Standards `doctype`，例如`<!DOCTYPE html>`这样您就可以在各种浏览器和版本中获得更一致的行为。

其次是关闭你的标签。我注意到这些列表项没有被关闭，因此任务留给浏览器来确定后续列表项应该如何格式化。虽然这不是*无效*的，但我绝对不会鼓励这种做法。

最后是避免在 JavaScript 中进行冗长的字符串连接，例如：

```
 switch (code) {
    case "us":
x="<ul>"+
"<li>"+"<a href='http://nsworld.org/findings/How-does-it-all-Fit-Together/Capacities#!prettyPhoto[examples2]/2/'>"+"Envision Charlotte"+""+""+"<br />"+"<br />"+
"<li><a href='http://nsworld.org/findings/Building-New-Capacities-Emergence/Innovative-Societies#!prettyPhoto[examples2]/2/'>"+"US Open Government Initiative"+""+
"<li>"+"<a href='http://nsworld.org/findings/Building-New-Capacities-Emergence/Innovative-Societies#!prettyPhoto[examples2]/3/'>"+"Unreasonable Institute"+""+""+
"<li>"+"<a href='http://nsworld.org/findings/Building-New-Capacities-Emergence/Innovative-Societies#!prettyPhoto[examples2]/4/'>"+"FailFaire"+""+""+
"<li>"+"<a href='http://nsworld.org/findings/Building-New-Capacities-Emergence/Emergent-Solutions#!prettyPhoto[examples]/1/'>"+"Ushahidi-Haiti"+""+""+
"<li>"+"<a href='http://nsworld.org/findings/Building-New-Capacities-Emergence/Public-Organizations-as-Experimentation-Platforms#!prettyPhoto[examples2]/3/'>"+"Social Innovation Fund"+""+""+
"<li>"+"<a href='http://nsworld.org/findings/Building-New-Capacities-Resilience/Adaptive-Capacity#!prettyPhoto[examples2]/1/'>"+"Community and Regional Resiliency Institute (CARRI)"+""+""+
"<li>"+"<a href='http://nsworld.org/articles/community-resilience-taking-tangible-steps-towards-achieving-societal-resilience'>"+"Community Resilience: Taking Tangible Steps Towards Achieving Societal Resilience"+""+""+
"<li>"+"<a href='http://nsworld.org/discoveries/nurse-family-partnership-co-produces-results-us'>"+"Nurse-Family Partnership Co-Produces Results in the U.S."+""+""+
""
        break; 
```

相反，您可以预先加载这些列表、异步拉下这些列表，或者将数据填充到某种 JavaScript 对象中。如您所见，大量的字符串连接使代码非常不可读，并提供了更多出错的机会。

# jqgrid - 带有EntityDataSource的JQGrid没有从相关对象中获取列

> ID：13728546
> 
> 赞同：0
> 
> 时间：2012-12-05T17:05:55.933
> 
> 标签：jqgrid, jqgrid-asp.net, entitydatasource

带有EntityDataSource的JQGrid没有从相关对象中获取列

VetCertifieds 中由 phoneid 关联的 Phone 表中的字段 Number 给出错误：DataField=Phone.Number 的列在数据源中不存在。

Phone.Number 在 DataList 中工作。

有任何想法吗？

```
 <cc1:JQGrid ID="Jqgrid1" runat="server" DataSourceID="EntityDataSource1" 
            ShrinkToFit="False">
            <Columns> 
                   <cc1:JQGridColumn DataField="FirstName" >                       
                </cc1:JQGridColumn>
                <cc1:JQGridColumn DataField="MiddleName"  Visible="false">
                </cc1:JQGridColumn>
                <cc1:JQGridColumn DataField="LastName" >
                </cc1:JQGridColumn>
                <cc1:JQGridColumn DataField="Phone.Number" >
                </cc1:JQGridColumn>
                <cc1:JQGridColumn DataField="AddressID" >
                </cc1:JQGridColumn>

            </Columns>
        </cc1:JQGrid>

    <asp:EntityDataSource ID="EntityDataSource1" runat="server" 
        ConnectionString="name=VetPhoneBookContext" 
        DefaultContainerName="VetPhoneBookContext" 
        EntitySetName="VetCertifieds" Include="Phone,Address" EnableFlattening="False"
            >
     </asp:EntityDataSource> 
```

# maven - maven 将代理应用到 nonProxyHost

> ID：13728547
> 
> 赞同：7
> 
> 时间：2012-12-05T17:06:02.540
> 
> 标签：maven, proxy, maven-3

我在 settings.xml 文件中设置了以下代理

```
<proxy>
  <id>optional</id>
  <active>true</active>
  <protocol>http</protocol>
  <username>someusername</username>
  <password>somepassword</password>
  <host>some.proxy.host.com</host>
  <port>5150</port>
  <nonProxyHosts>localhost|127.0.0.1</nonProxyHosts>
</proxy> 
```

但它仍然将代理应用于我的本地主机，每次我必须对本地主机做某事时，我都必须将活动更改为 false。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-30T04:18:36.510

根据文档[1]，您可以设置

```
<useProxy>false</useProxy> 
```

以防止这种情况发生。

[1] [http://dev.day.com/docs/en/cq/current/core/how_to/how_to_use_the_vlttool/vlt-mavenplugin.html#Common%20Parameters](http://dev.day.com/docs/en/cq/current/core/how_to/how_to_use_the_vlttool/vlt-mavenplugin.html#Common%20Parameters)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-04T12:04:47.777

如果您希望在 localhost 上部署

尝试这个

```
<nonProxyHosts>*localhost*</nonProxyHosts> 
```

应该管用

# selenium - 用于下拉框的 Selenium Select2 命令

> ID：13728551
> 
> 赞同：0
> 
> 时间：2012-12-05T17:06:04.357
> 
> 标签：selenium, selenium-ide, jquery-select2

我是 selenium 的新手，在我之前的问题[Selenium IDE command for input type hidden](https://stackoverflow.com/questions/13724760/selenium-ide-command-for-input-type-hidden) 它正在使用 select2 请帮助我使用下拉列表的选择选项的命令。

我试着在这里查看[https://gist.github.com/3683275](https://gist.github.com/3683275)但它似乎对我不起作用

```
mouseDown('//a[@class="select2-choice select2-default"][1]')
mouseUp('//li[contains(@class,"select2-result")][1]') 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T13:43:32.697

这些命令打开选项列表，等待它出现，最后选择标有“加利福尼亚”的选项。Select2 可以通过不同的方式进行自定义，希望这些命令对您有用。

```
mouseDown      css=.select2-choice > div > b
waitForVisible css=.select2-results
mouseUp        css=.select2-result-label:contains('California') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T11:13:13.887

```
WebElement element = driver.findElements(By.xpath(/*xpath*/));

Select select = new Select(element);

select.selectByVisibleText(value); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-26T09:18:56.040

或者，也可以使用 clickAt() 来处理

```
clickAt('//a[@class="select2-choice select2-default"][1]');
waitForVisible("css=.select2-results");
clickAt('//li[contains(@class,"select2-result")][1]'); 
```

# wix - Wix 3.5 - 更改/修复不要求提升

> ID：13728555
> 
> 赞同：3
> 
> 时间：2012-12-05T17:06:17.307
> 
> 标签：wix, uac

我在使用 WIX 时遇到了一个奇怪的问题：当我安装/卸载我的包时，UAC 被正确调用并且一切正常。但是，当我经历更改/修复方案时，安装程​​序不会请求 UAC Elevation，并且机器范围的设置没有更新（只是没有更改；即使下次运行安装程序时功能状态也保持不变）。

当我运行已经提升的 msiexec 时，一切正常。

InstallScope 设置为 perMachine

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T02:26:17.427

如果您从程序和功能启动，您的安装会自动提升。听起来您的安装在通过安装而不是更改完成时表现正确。检查详细日志以查看组件的操作状态。详细的日志文件可能会显示差异。

# xml - 使用 vbscript 有条件地从 XML 中删除节点

> ID：13728557
> 
> 赞同：0
> 
> 时间：2012-12-05T17:06:20.577
> 
> 标签：xml, vbscript

我有一个 xml 文件，用于将数据解析为 HTML 文件。我正在使用 vbscript 来执行此操作。在解析数据之前，我需要有条件地删除文件中的一些节点。我的 HTML 表单上有一个日期，我需要用它来与 XML 文件中的日期进行比较。如果日期超出范围，那么我想删除该节点及其下的任何子节点。

这是一个示例 XML： ![XML 数据](../Images/19348854e3397f94a22505a56647f767.png)

在上面的示例中，如果任何子节点的“exp”值小于我表单上的日期，则应将其删除。如果它下面有一个子节点，那么它也应该被删除。所以如果我表格上的日期是 12/5/12，那么我的第一个“O”节点应该连同它下面的子节点一起被删除。所有节点都有一个日期，所以我必须查看每个节点。该文件可能与此一样小或具有许多附加节点。谁能帮我指出正确的方向？同样，这需要使用 vbscript 来完成。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T18:22:59.410

使用 XPath 查找“有趣的”节点并使用 .removeChild 删除它们：

```
 Dim oFS    : Set oFS  = CreateObject("Scripting.FileSystemObject")
  Dim sFSpec : sFSpec   = oFS.GetAbsolutePathName("..\data\01.xml")
  Dim oXML   : Set oXML = CreateObject("Msxml2.DOMDocument.6.0")
  Dim sDate  : sDate    = "2012-08-31"
  oXML.setProperty "SelectionLanguage", "XPath"
  oXML.async = False
  oXML.load sFSpec
  If 0 = oXML.parseError Then
     WScript.Echo oXML.xml
     WScript.Echo "-----------------"
     Dim sXPath : sXPath     = "/addons/addon[@date=""" & sDate & """]"
     Dim ndlFnd : Set ndlFnd = oXML.selectNodes(sXPath)
     If 0 = ndlFnd.length Then
        WScript.Echo sXPath, "not found"
     Else
        WScript.Echo "found", ndlFnd.length, "nodes for", sXPath
        Dim ndCur
        For Each ndCur In ndlFnd
            ndCur.parentNode.removeChild ndCur
        Next
     End If
     WScript.Echo "-----------------"
     WScript.Echo oXML.xml
  Else
     WScript.Echo oXML.parseError.reason
  End If 
```

输出：

```
======================================================================
<?xml version="1.0"?>
<addons>
        <addon id="TicTacToe" date="2012-11-05">
                <requires>
                        <import addon="xbmc.python" version="1.0"/>
                </requires>
        </addon>
        <addon id="Sudoku" date="2012-08-31">
                <requires>
                        <import addon="xbmc.python" version="1.0"/>
                </requires>
        </addon>
        <addon id="Doom" date="1953-04-13">
                <requires>
                        <import addon="xbmc.python" version="1.0"/>
                </requires>
        </addon>
        <addon id="Muehle" date="2012-10-18">
                <requires>
                        <import addon="xbmc.python" version="1.0"/>
                </requires>
        </addon>
</addons>

-----------------
found 4 nodes for /addons/addon
filtering for dtX <= 31.08.2012
-----------------
<?xml version="1.0"?>
<addons>
        <addon id="TicTacToe" date="2012-11-05">
                <requires>
                        <import addon="xbmc.python" version="1.0"/>
                </requires>
        </addon>
        <addon id="Muehle" date="2012-10-18">
                <requires>
                        <import addon="xbmc.python" version="1.0"/>
                </requires>
        </addon>
</addons>

====================================================================== 
```

手动过滤很烂，但是

1.  它会派上用场你不是真的有用的日期格式
2.  我无法让 XPath 接受`<=`响应。`&lt;`在我的搜索表达式中

这个更好看的代码片段：

```
 ...
 Dim sXPath : sXPath     = "/addons/addon[@date=""" & sDate & """]"
 Dim ndlFnd : Set ndlFnd = oXML.selectNodes(sXPath)
 If 0 = ndlFnd.length Then
    WScript.Echo sXPath, "not found"
 Else
    WScript.Echo "found", ndlFnd.length, "nodes for", sXPath
    Dim ndCur
    For Each ndCur In ndlFnd
        ndCur.parentNode.removeChild ndCur
    Next
 End If
 ... 
```

删除数独节点，但

```
...
Dim sXPath : sXPath     = "/addons/addon[@date &lt; """ & sDate & """]"
... 
```

投掷

```
msxml6.dll: Unexpected character in query string.
/addons/addon[@date -->&<--lt; "2012-08-31"] 
```

# jquery - 在 DOM 之后加载 jQuery，如何在加载 jQuery 之前使 $.ready() 可用于我的页面？

> ID：13728564
> 
> 赞同：3
> 
> 时间：2012-12-05T17:07:07.267
> 
> 标签：jquery

我想延迟加载 jQuery，但我有少量的内联 javascript 在 $.ready() 上运行。由于未加载 jQuery，因此这些行会引发错误并且永远不会运行。有没有一种方法可以使 $.ready() 成为可用函数，但等待执行直到加载 jQuery？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-05T17:08:47.980

解决此问题的通用方法的一种选择是将您的内联 javascript 放入一个函数中，并将该函数添加到一个全局可访问的数组中 - 不要调用它。这些本质上是您想要安排`document.ready()`何时`document.ready`可用的功能。

然后，当您加载 jQuery 时，您设置了一个`document.ready()`处理程序，该处理程序循环遍历该数组中的所有函数并调用它们。

```
// declare global at the top of your web page
var readyFns = [];

// in your inline code, add a function to the readyFns array
readyFns.push(myInlineFn);

// when your jQuery code loads, do this:
$(document).ready(function() {
    for (var i = 0; i < readyFns.length; i++) {
        readyFns[i]();
    }
}); 
```

如果你想使用匿名函数，你可以像这样做中间步骤：

```
// in your inline code, add a function to the readyFns array
readyFns.push(function() {
   // put your code here
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T17:10:06.267

除了使用`.ready`，您可以使用非 jQuery 等效项，例如`window.onload`，但这些往往与 不兼容`.ready`，所以我不确定它们是否能满足您的需求。

显然有人已经提取了 jQuery 的 ready 函数，所以它可以单独使用：[http ://code.google.com/p/domready/](http://code.google.com/p/domready/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-05T17:10:48.983

你应该：

1.  用函数调用替换 ready 例如`example();`
2.  创建一个函数，例如`example() { }`
3.  把那个函数放在里面`(document).ready()`

# spring - 如何知道新用户使用spring security登录

> ID：13728571
> 
> 赞同：1
> 
> 时间：2012-12-05T17:07:19.353
> 
> 标签：spring, spring-security

我已经实现了spring security，我可以使用以下代码获取所有登录用户并将它们显示在在线标签下

```
 for (Object user: sessionRegistry.getAllPrincipals()) {
            User onlineUser = (User) user;
            onlineUsersIds.add(onlineUser.getId());
         } 
```

这是否可以知道用户刚刚登录，以便我可以更新在线用户列表，或者我必须每 5 或 10 分钟检查一次 sessionRegistry，然后每 5 或 10 分钟更新用户列表。

如果您需要任何其他详细信息，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T18:20:45.367

我会使用这个：javax.servlet.http.HttpSessionBindingListener [http://docs.oracle.com/javaee/5/api/javax/servlet/http/HttpSessionBindingListener.html](http://docs.oracle.com/javaee/5/api/javax/servlet/http/HttpSessionBindingListener.html)

这将基于“每个会话”。

所以每次有人通过身份验证时，spring security 都会在会话中放入某些值。

您所做的是，使用“valueBound”和“valueUnbound”方法检查该会话属性。这些方法将获得应用程序范围内的“设置”或同步“设置”相应地处理它们

每次渲染页面时，您只需从应用程序范围集中读取

# c# - 尝试反序列化参数时出现 CRM 错误

> ID：13728575
> 
> 赞同：0
> 
> 时间：2012-12-05T17:07:26.477
> 
> 标签：c#, dynamics-crm-2011, xrm

我有一个 CRM 函数，它返回实体中所有属性的属性类型。我的问题是，尽管过去同样的方法也有效，但现在无论我传递给它的实体如何，它都会抛出这个错误。

尝试反序列化参数时出错[http://schemas.microsoft.com/xrm/2011/Contracts/Services:ExecuteResult](http://schemas.microsoft.com/xrm/2011/Contracts/Services:ExecuteResult)

这是我的代码，我正在传递“帐户”实体。

```
public string GetFieldType(IOrganizationService svc, string entity, string fieldName)
        {
            RetrieveEntityRequest request = new RetrieveEntityRequest()
            {
                EntityFilters = EntityFilters.Attributes,
                LogicalName = entity
            };

            RetrieveEntityResponse response = (RetrieveEntityResponse)svc.Execute(request);
            string type = "";
            foreach (AttributeMetadata attribute in response.EntityMetadata.Attributes)
            {
                if (attribute.LogicalName == fieldName)
                { type = attribute.AttributeType.ToString(); }
            }

            return type;
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T18:59:23.413

If the code was working before, and it's not now, odds are that it is not a problem with your code. Most likely your `svc.Execute` is failing. Have you changed how your `IOrganizationService` is being created? Are you running as a user with rights to query the CRM instance? If all of these things check out, then try turning on server side tracing through the [diagnostic tool](http://crmdiagtool2011.codeplex.com/).

# php - cakephp captca 验证

> ID：13728576
> 
> 赞同：0
> 
> 时间：2012-12-05T17:07:27.543
> 
> 标签：php, cakephp

我正在使用验证码组件。

```
<?php

function create($width='120',$height='40',$characters='6') {

    $code = $this->generateCode($characters); 

    /* font size will be 75% of the image height */
    $font_size = $height * 0.70;

    $image = @imagecreate($width, $height) or die('Cannot initialize new GD image stream');

    /* set the colours */
    $background_color = imagecolorallocate($image, 220, 220, 220);               
    $text_color       = imagecolorallocate($image, 10, 30, 80);
    $noise_color      = imagecolorallocate($image, 150, 180, 220);

    /* generate random dots in background */
    for( $i=0; $i<($width*$height)/3; $i++ ) {
        imagefilledellipse($image, mt_rand(0,$width), mt_rand(0,$height), 1, 1, $noise_color);
    }

    /* generate random lines in background */
    for( $i=0; $i<($width*$height)/150; $i++ ) {
        imageline($image, mt_rand(0,$width), mt_rand(0,$height), mt_rand(0,$width), mt_rand(0,$height), $noise_color);
    }

    /* create textbox and add text */
    $textbox = imagettfbbox($font_size, 0, dirname(__FILE__).'/'.$this->font, $code) or die('Error in imagettfbbox function');
    $x       = ($width - $textbox[4])/2;
    $y       = ($height - $textbox[5])/2;
    $y       -= 5;
    imagettftext($image, $font_size, 0, $x, $y, $text_color, dirname(__FILE__).'/'.$this->font , $code) or die('Error in imagettftext function');

    /* output captcha image to browser */
    header('Content-Type: image/jpeg');
    imagejpeg($image);
    imagedestroy($image);

    $this->Controller->Session->write('security_code',$code);
} 
```

captca 已成功创建，但是当我尝试验证它时出现错误，因为`$code`它没有存储在会话中。我不明白为什么会这样。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T20:11:49.933

改变：

```
$this->Controller->Session->write('security_code', $code); 
```

对此：

```
$this->Session->write('security_code', $code); 
```

此外，请确保您已将 SessionHelper 添加到 $helpers 数组中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T07:21:13.997

如果您使用的是 CakePHP 1.x，您的应用程序似乎在调用 header() 函数以生成图像之前将输出发送到浏览器。在这种情况下，您需要将会话创建行移至*header('Content-Type: image/jpeg');* 如下所示：

```
imagettftext($image, $font_size, 0, $x, $y, $text_color, $this->font , $code) or die('Error in imagettftext function');
/* output captcha image to browser */
$this->Controller->Session->write('security_code',$code);
@ob_end_clean(); //clean buffers, as a fix for 'headers already sent errors..'
header('Content-Type: image/jpeg');
imagejpeg($image);
imagedestroy($image); 
```

如果您使用的是 CakePHP 2.x，请从作者的网站 www.devarticles.in/cakephp/simple-captcha-component-for-cakephp/ 下载更新版本的验证码组件

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T12:48:51.837

我遇到了一些问题，并通过更改会话存储线的位置来解决这个问题

```
function create($width='120',$height='40',$characters='6') {

    $code = $this->generateCode($characters); 
    $this->Controller->Session->write('security_code',$code);

    //.....rest of code will remain same
} 
```

# file - 如何替换findstr批处理文件中的双引号

> ID：13728577
> 
> 赞同：1
> 
> 时间：2012-12-05T17:07:25.817
> 
> 标签：file, batch-file, double, quotes, findstr

我不确定我的旧帐户发生了什么，所以必须创建这个新帐户。我写的批处理文件有问题。我让它在用户输入某些信息的地方工作，然后输入将替换文件中的文本。但是，我遇到的问题似乎无法在此处找到确切的答案或帮助我解决问题是...如何替换引号内的数据？我尝试转义引号，但我不确定它是否找到它，只是没有替换它或什么。这是部分

```
setlocal DisableDelayedExpansion
(
  for /F "usebackq delims=" %%a in ("%drive%:\bdi\%bdi1%\importer.config") do (
    set "str=%%a"
    setlocal EnableDelayedExpansion
    set "str=!str:""saveTcpMessage"" value=""True""="saveTcpMessage" value="False"!"

    echo(!str!
    endlocal
  )
) > %drive%:\bdi\%bdi1%\newfile.txt
%drive%:
cd "%drive%:\bdi\%bdi1%"
del importer.config
rename newfile.txt importer.config
pause 
```

在上面的示例中，我希望批处理文件在名为 importer.config 的文件中找到以下字符串

```
<add key="saveTcpMessage" value="True" /> 
```

如果它找到上述值，我希望将其替换为：

```
<add key="saveTcpMessage" value="False" /> 
```

我很确定 find 部分可以正常工作，因为我看到您必须转义 dbl 引号..但是替换部分不起作用。我也尝试在替换中使用双引号，但无济于事。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T22:31:06.883

cmd.exe 解析器不会像这样转义引号。为了转义引号，您必须使用`^"`，但这意味着必须转义所有引号以及所有特殊字符等`<` `&`。一旦解析器看到未转义的引号，那么引号语义就会起作用，直到遇到下一个引号。不可能逃避引用的报价。

但以上所有内容在您的情况下并不重要：您的整个方法无法正常工作，因为它不可能包含`=`在变量扩展搜索和替换的搜索部分中。它是困扰批处理编程的众多小*“陷阱”之一。*

如果您可以保证与您的元素在同一行中不存在其他 XML 元素
`<add key="saveTcpMessage" value="True" />`，那么您可以简单地验证您的行是否正确，然后将“False”替换为“True”。但您很可能无法做出这样的保证。XML 没有固有的行结构，因此可以将数据重新格式化为一条连续的行，它仍然是具有相同含义的有效 XML。或者可以将元素拆分为多行。

批处理文件通常不太擅长处理文本文件，尤其是它们在处理 XML 方面很糟糕。你可以做到，但需要大量晦涩难懂的代码，而且速度会很慢。除非您非常聪明，否则任何批处理文件解决方案都可能很脆弱，这意味着有人可能会重新格式化 XML 输入并破坏您的代码。

我建议您使用其他一些语言或实用程序 - 理想情况下是设计用于处理 XML 的实用程序。但 VBScript、JScript 或 PowerShell 也可以工作。这些语言至少可以让您轻松地进行您正在尝试的文字搜索和替换。

如果您*真的*想使用批处理脚本，我已经在 DosTips 上发布[了“终极”文件搜索和替换批处理实用程序。](http://www.dostips.com/forum/viewtopic.php?p=12345)有关如何使用脚本的文档嵌入在代码中。

另一种选择是混合 JScript/Batch 解决方案：[正则表达式搜索和替换批处理 - 轻松编辑文件！](http://www.dostips.com/forum/viewtopic.php?p=20753)，再次发布在 DosTips 上。完整的文档也嵌入在该代码中。

假设您创建了在第二个链接中找到的 REPL.BAT 脚本，您可以执行以下操作：

```
@echo off
setlocal

:: define drive and bdi1 as needed

set "file=%drive%:\bdi\%bdi1%\importer.config"
set "search=<add key="saveTcpMessage" value="True" />"
set "replace=<add key="saveTcpMessage" value="False" />"

type "%file% | repl.bat search replace el >"%file%.new"
move /y "%file%.new" "%file%" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-09-22T06:36:36.967

"到`

像这样的东西：

```
@echo off
set quot=^"
setlocal enabledelayedexpansion
for /f "usebackq skip=1 delims=" %%i in ( `wmic bios get BIOSVersion ^
 ^| findstr /r /v "^$"`) do (
for /f tokens^=*^ delims^=^"  %%a in ("%%i") do set unquoted=%%a
set "unquoted=!unquoted:%quot%=`!"
echo .
echo !unquoted!
echo .
) 
```

# c# - 如何按 RavenDB 中嵌套子属性的平均聚合对文档进行排序？

> ID：13728580
> 
> 赞同：1
> 
> 时间：2012-12-05T17:07:45.910
> 
> 标签：c#, ravendb, aggregate

给定这样的模型：

```
public class Location
{
    public int Id { get; set; }

    public string Name { get; set; }

    public Coordinates Geo { get; set; }

    public IList<Review> Reviews { get; set; }
}

public class Review
{
    public string Comment { get; set; }

    public int Rating { get; set; }
} 
```

如何编写一个查询来返回按评级降序排序的匹配位置？

我有一个索引，可让我查询地理点周围一定半径内的位置：

```
public class Locations_ByCoordinates : AbstractIndexCreationTask<Location>
{
    public Locations_ByCoordinates()
    {
        Map = locations => from l in locations
                           select new {_ = SpatialIndex.Generate(l.Geo.Lat, l.Geo.Lon)};
    }
} 
```

这似乎有效，我可以像这样对结果进行排序：

```
RavenQueryStatistics stats;
var query = session.Advanced.LuceneQuery<Location>(Names.Indexes.LocationsByCoordinates)
                       .Statistics(out stats)
                       .WithinRadiusOf(radius, coordinates.Lat, coordinates.Lon);

switch (sort)
{
    case Sort.Distance:
        query = query.SortByDistance();
        break;
    case Sort.Rating:
        query = query.AddOrder(l => l.Reviews.Average(r => r.Rating), true); // TODO: This throws an exception, perhaps a modified index with an aggregate is required? Maybe Map/Reduce?
        break;
    case Sort.Alphabetical:
        query = query.OrderBy(l => l.Name);
        break;
    case Sort.Number_of_ratings:
        query = query.AddOrder(l => l.Reviews.Count, true);
        break;
    case Sort.Relevance: // This is the default ordering in RavenDB.
        break;
    default:
        throw new ArgumentOutOfRangeException("sort");
} 
```

除了按平均评分排序之外，每个选项都可以正常工作，这会引发有关未知字段的异常。我觉得这必须是 Map/Reduce 索引而不是 Map 索引。但我不知道怎么写。

我正在从 MongoDB 迁移此代码，但我曾经在客户端通过评级对文档进行排序，我想我现在会在服务器端执行此操作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T17:16:16.950

由于所有评论都在该位置中，并且您想要每个位置的评论的平均评分，因此您无需降低。只需在地图中创建一个新字段。

```
Map = locations => from l in locations
                   select new {
                       _ = SpatialIndex.Generate(l.Geo.Lat, l.Geo.Lon),
                       AvgRating = l.Reviews.Average(r => r.Rating)
                   }; 
```

# c++ - CYK 算法是如何工作的？

> ID：13728581
> 
> 赞同：5
> 
> 时间：2012-12-05T17:07:48.110
> 
> 标签：c++, string, parsing, context-free-grammar, cyk

我必须检查是否可以从 Chomsky 范式的给定上下文中派生一个字符串。我正在使用 C++。

维基百科文章中有非常好的[伪代码](http://en.wikipedia.org/wiki/CYK_algorithm#As_pseudocode)涵盖了 CYK 算法，但我不能很好地理解它。

有人会这么好心地帮助我，给我另一个 CYK 算法的伪代码，或者解释一下 wiki 文章中的那个吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2017-07-19T21:19:24.660

CYK 算法以乔姆斯基范式的 CFG 作为输入。这意味着每个产品要么具有形式

*   S → a，对于某个终端 a，或
*   S → AB，对于一些非终结符 A 和 B。

现在，假设您有一个字符串 w，并且您想查看是否可以从起始符号为 S 的文法中导出它。有两种选择：

1.  如果 w 是单个字符长，那么解析它的唯一方法是对某个字符 a 使用形式 S → a 的产生式。因此，请查看是否有任何单字符产品与 a 匹配。
2.  如果 w 的长度超过一个字符，那么解析它的唯一方法是对某些非终结符 A 和 B 使用形式 S → AB 的产生式。这意味着我们需要将字符串 w 分成两部分 x 和 y其中 A 导出 x，B 导出 y。一种方法是尝试将 w 分成两部分的所有可能方法，并查看其中任何一个是否有效。

请注意，此处的选项 (2) 最终成为递归解析问题：要查看是否可以从 S 导出 w，请查看是否可以从 A 导出 x 和从 B 导出 y。

有了这种见解，下面是递归函数的伪代码，您可以使用它来查看非终结符 S 是否派生出字符串 w：

```
bool canDerive(nonterminal S, string w) {
    return canDeriveRec(S, w, 0, w.size());
}

/* Can you derive the substring [start, end) of w from S? */
bool canDeriveRec(nonterminal S, string w, int start, int end) {
    /* Base case: Single characters */
    if (end - start == 1) {
        return whether there is a production S -> a, where a = w[start];
    }

    /* Recursive case: Try all possible splits */
    for (each production S -> AB) {
        for (int mid = start + 1; mid < end; mid++) {
            if (canDeriveRec(A, w, start, mid) &&
                canDeriveRec(B, w, mid, end)) {
                return true;
            }
        }
    }
    return false;
} 
```

这个算法可以正常工作，但是如果你绘制出递归的形状，你会发现

1.  它进行了大量冗余的递归调用，但是
2.  没有那么多不同的可能递归调用。

事实上，不同的可能调用的数量是 O(n ² N)，其中 n 是输入字符串的长度（对于开始和结束索引的每个可能组合），N 是语法中非终结符的数量。这些观察表明，该算法将受益于记忆化或动态编程，这取决于您碰巧认为哪种方法更好。

当您采用上述递归算法并记住结果时，或者等效地当您将上述递归算法转换为动态规划问题时，您会得到 CYK 算法。

有 O(n ² N) 个可能的递归调用。对于每个尝试的生产，它确实 O(n) 工作。如果一个非终结符平均有 P 个产生式，这意味着总运行时间是 O(n ³ NP)，对于固定语法来说是 O(n ^(3 )。)

# matlab - Matlab：对有限制的列元素求和

> ID：13728586
> 
> 赞同：3
> 
> 时间：2012-12-05T17:08:04.250
> 
> 标签：matlab, sum, col

我们有一个 MxN 矩阵和一个约束`cstrn = 100;`。

约束是列元素的汇总限制（每列）：

`sum(matrix(:,:))<=cstrn`.

对于给定的示例，如下所示：

```
Columns 1 to 5:
  15  18  -5 22 19
  50  98 -15 39 -8
  70 -15  80 45 38
  31  52   9 80 72
  -2  63  52 71  6
   7  99  32 58 41 
```

我想找到满足此约束的每列元素的最大数量。

我如何将每个列元素与同一列中的其他元素进行汇总，并找到哪些总和组合使用每列的最大元素数？

在给定的示例解决方案中是：

```
 4  3  5  2  5 
```

在哪里

`column 1: 15 + 50 + 31 +7 +(-2)`

`column 2: 18 +(-15) + 52 or 63`等等

先感谢您。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-05T17:15:52.770

由于将小元素放入总和总是更容易，因此您可以执行 a `sort`，然后是累积总和：

```
m= [
  15  18  -5 22 19
  50  98 -15 39 -8
  70 -15  80 45 38
  31  52   9 80 72
  -2  63  52 71  6
   7  99  32 58 41]; 

cs = cumsum(sort(m))
cs =
    -2   -15   -15    22    -8
     5     3   -20    61    -2
    20    55   -11   106    17
    51   118    21   164    55
   101   216    73   235    96
   171   315   153   315   168 
```

现在您可以轻松识别出您跨越阈值的元素`cnstrn`（感谢@sevenless）！

```
out = sum(cs <= cnstrn)

out =
     4     3     5     2     5 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-05T17:22:37.903

我想补充一下乔纳斯的回答，你可以通过输出一个逻辑矩阵的方式来施加你的约束，然后对该矩阵的 1 和 0 求和，如下所示：

```
cstrn = 100
m= [
  15  18  -5 22 19
  50  98 -15 39 -8
  70 -15  80 45 38
  31  52   9 80 72
  -2  63  52 71  6
   7  99  32 58 41]; 

val_matrix = cumsum(sort(m))
logical_matrix = val_matrix<=cstrn
output = sum(logical_matrix) 
```

给出输出：

```
cstrn =

   100

val_matrix =

    -2   -15   -15    22    -8
     5     3   -20    61    -2
    20    55   -11   106    17
    51   118    21   164    55
   101   216    73   235    96
   171   315   153   315   168

logical_matrix =

     1     1     1     1     1
     1     1     1     1     1
     1     1     1     0     1
     1     0     1     0     1
     0     0     1     0     1
     0     0     0     0     0

output =

     4     3     5     2     5 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-05T17:18:06.310

这是一个逻辑，在移动设备上所以不能给出代码。

看一下这个。转到一列，按升序对其进行排序，循环求和，当命中 <=100 时中断。拿到柜台。返回原始列，获取与您刚刚总结的元素匹配的元素的索引 :-)

# three.js - 你如何继承网格的世界位置？

> ID：13728588
> 
> 赞同：1
> 
> 时间：2012-12-05T17:08:12.693
> 
> 标签：three.js

我有一个 Three.js 场景，其中有几个网格在移动。我想通过在场景中的相同位置和相同旋转中放置一个新的网格实例（具有相同的几何形状）来拍摄快照并复制所有网格位置。我不能简单地复制网格的 .position 和 .rotation 因为网格是其他网格的子对象。我试图 .clone() 网格的 matrixWorld 但这没有用。你如何继承网格的世界位置？

这就是我想要做的：

```
// mesh is an existing mesh loaded into a scene
// geom is an existing geometry definition

var material = new THREE.MeshFaceMaterial();

var newMesh = new THREE.Mesh( geom, material);

newMesh.matrixWorld = mesh.matrixWorld.clone();

scene.add(newMesh); 
```

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T17:51:06.597

就这么简单：

```
newMesh.position.copy( mesh.matrixWorld.getPosition() ); 
```

编辑：请参阅[此更新的答案](https://stackoverflow.com/questions/15098479/how-to-get-the-global-world-position-of-a-child-object/15098870#15098870)。

# python - 在python中简单读取fortran二进制数据并不那么简单

> ID：13728591
> 
> 赞同：3
> 
> 时间：2012-12-05T17:08:26.423
> 
> 标签：python, fortran, binaryfiles, unpack

我有一个来自 FORTRAN 代码的二进制输出文件。想用python阅读它。（使用 FORTRAN 阅读并输出文本以供 python 阅读不是一种选择。长篇大论。）我可以以简单的方式阅读第一条记录：

```
>>> binfile=open('myfile','rb')
>>> pad1=struct.unpack('i',binfile.read(4))[0]
>>> ver=struct.unpack('d',binfile.read(8))[0]
>>> pad2=struct.unpack('i',binfile.read(4))[0]
>>> pad1,ver,pad2
(8,3.13,8) 
```

正好。但这是一个大文件，我需要更有效地执行此操作。所以我尝试：

```
>>> (pad1,ver,pad2)=struct.unpack('idi',binfile.read(16)) 
```

这不会运行。给我一个错误并告诉我 unpack 需要一个长度为 20 的参数。自从我上次检查 4+8+4=16 以来，这对我来说毫无意义。当我放弃并用 20 替换 16 时，它会运行，但是这三个数字填充了数字垃圾。有谁看到我做错了什么？谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-05T17:13:39.060

你得到的大小是由于对齐，对齐后尝试`struct.calcsize('idi')`验证大小实际上是20。要使用不对齐的本机字节顺序，请指定`struct.calcsize('=idi')`并使其适应您的示例。

有关该`struct`模块的更多信息，请查看[http://docs.python.org/2/library/struct.html](http://docs.python.org/2/library/struct.html)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-05T17:23:27.967

该`struct`模块主要用于与 C 结构互操作，因此它对齐数据成员。`idi`对应于以下C结构：

```
struct
{
   int int1;
   double double1;
   int int2;
} 
```

`double`条目需要 8 字节对齐才能在大多数 CPU 加载操作中有效（甚至正确）运行。`int1`这就是为什么在和之间添加 4 个字节的填充`double1`，这会将结构的大小增加到 20 个字节。模块执行相同的填充`struct`，除非您通过添加`<`（在小端机器上）或`>`（在大端机器上）或只是`=`在格式字符串的开头来抑制填充：

```
>>> struct.unpack('idi', d)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
struct.error: unpack requires a string argument of length 20
>>> struct.unpack('<idi', d)
(-1345385859, 2038.0682530887993, 428226400)
>>> struct.unpack('=idi', d)
(-1345385859, 2038.0682530887993, 428226400) 
```

（`d`是 16 个随机字符的字符串。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-03-05T22:26:15.310

我建议使用数组来读取由 FORTRAN 使用 UNFORMATTED、SEQUENTIAL 编写的文件。

您使用数组的具体示例如下：

```
import array
binfile=open('myfile','rb')
pad = array.array('i')
ver = array.array('d')
pad.fromfile(binfile,1)   # read the length of the record 
ver.fromfile(binfile,1)   # read the actual data written by FORTRAN
pad.fromfile(binfile,1)   # read the length of the record 
```

如果您有写入整数和双精度数组的 FORTRAN 记录，这很常见，您的 python 将如下所示：

```
import array
binfile=open('myfile','rb')
pad = array.array('i')
my_integers = array.array('i')
my_floats = array.array('d')
number_of_integers = 1000 # replace with how many you need to read
number_of_floats = 10000 # replace with how many you need to read
pad.fromfile(binfile,1)   # read the length of the record
my_integers.fromfile(binfile,number_of_integers) # read the integer data
my_floats.fromfile(binfile,number_of_floats)     # read the double data
pad.fromfile(binfile,1)   # read the length of the record 
```

最后的评论是，如果文件中有字符，您也可以将它们读入数组，然后将其解码为字符串。像这样的东西：

```
import array
binfile=open('myfile','rb')
pad = array.array('i')
my_characters = array.array('B')
number_of_characters = 63 # replace with number of characters to read
pad.fromfile(binfile,1)   # read the length of the record 
my_characters.fromfile(binfile,number_of_characters ) # read the data
my_string = my_characters.tobytes().decode(encoding='utf_8') 
pad.fromfile(binfile,1)   # read the length of the record 
```

# android - 无法启动活动 ComponentInfo{

> ID：13728594
> 
> 赞同：0
> 
> 时间：2012-12-05T17:08:33.680
> 
> 标签：android, android-activity, xmlhttprequest, nullpointerexception, components

我有以下错误：

```
12-05 20:35:31.005: E/AndroidRuntime(1084): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.helplawyer/com.example.helplawyer.AndroidXMLParsingActivity}: android.os.NetworkOnMainThreadException 
```

在我添加的 xml 清单中`<uses-permission android:name="android.permission.INTERNET" />`

这是我的主要课程

```
package com.example.helplawyer;

public class AndroidXMLParsingActivity extends ListActivity {

// All static variables
static final String URL = "http://www.consultant.ru/rss/hotdocs.xml";
// XML node keys
static final String KEY_ITEM = "item"; // parent node
static final String KEY_TITLE = "title";
static final String KEY_DATE = "pubDate";
static final String KEY_LINK = "link";
static final String KEY_DESC = "description";

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.mainxml);

    ArrayList<HashMap<String, String>> menuItems = new ArrayList<HashMap<String, String>>();

    XMLParser parser = new XMLParser();
    String xml = parser.getXmlFromUrl(URL); // getting XML
    Document doc = parser.getDomElement(xml); // getting DOM element

    NodeList nl = doc.getElementsByTagName(KEY_ITEM);
    // looping through all item nodes <item>
    for (int i = 0; i < nl.getLength(); i++) {
        // creating new HashMap
        HashMap<String, String> map = new HashMap<String, String>();
        Element e = (Element) nl.item(i);
        // adding each child node to HashMap key => value

        map.put(KEY_TITLE, parser.getValue(e, KEY_TITLE));
        map.put(KEY_LINK, parser.getValue(e, KEY_LINK));
        map.put(KEY_DATE, parser.getValue(e, KEY_DATE));
        map.put(KEY_DESC, parser.getValue(e, KEY_DESC));

        // adding HashList to ArrayList
        menuItems.add(map);
    }

    // Adding menuItems to ListView
    ListAdapter adapter = new SimpleAdapter(this, menuItems,
            R.layout.list_item,
            new String[] { KEY_TITLE, KEY_DESC, KEY_DATE, KEY_LINK }, new int[] {
                    R.id.name, R.id.description, R.id.cost, R.id.link });

    setListAdapter(adapter);

    // selecting single ListView item
    ListView lv = getListView();

    lv.setOnItemClickListener(new OnItemClickListener() {

        public void onItemClick(AdapterView<?> parent, View view,
                int position, long id) {
            // getting values from selected ListItem
            String name = ((TextView) view.findViewById(R.id.name)).getText().toString();
            String cost = ((TextView) view.findViewById(R.id.cost)).getText().toString();
            String link = ((TextView) view.findViewById(R.id.link)).getText().toString();
            String description = ((TextView) view.findViewById(R.id.description)).getText().toString();

            // Starting new intent
            Intent in = new Intent(getApplicationContext(), SingleMenuItemActivity.class);
            in.putExtra(KEY_TITLE, name);
            in.putExtra(KEY_DATE, cost);
            in.putExtra(KEY_LINK, link);
            in.putExtra(KEY_DESC, description);
            startActivity(in);

        }
    });
} 
```

}

XML解析器

```
package com.example.helplawyer;

public class XMLParser {

// constructor
public XMLParser() {

}

/**
 * Getting XML from URL making HTTP request
 * @param url string
 * */
public String getXmlFromUrl(String url) {
    String xml = null;

    try {
        // defaultHttpClient
        DefaultHttpClient httpClient = new DefaultHttpClient();
        HttpGet httpGet = new HttpGet(url);

        HttpResponse httpResponse = httpClient.execute(httpGet);
        HttpEntity httpEntity = httpResponse.getEntity();
        xml = EntityUtils.toString(httpEntity);

    } catch (UnsupportedEncodingException e) {
        e.printStackTrace();
    } catch (ClientProtocolException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }
    // return XML
    return xml;
}

/**
 * Getting XML DOM element
 * @param XML string
 * */
public Document getDomElement(String xml){
    Document doc = null;
    DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();
    try {

        DocumentBuilder db = dbf.newDocumentBuilder();

        InputSource is = new InputSource();
            is.setCharacterStream(new StringReader(xml));
            doc = db.parse(is); 

        } catch (ParserConfigurationException e) {
            Log.e("Error: ", e.getMessage());
            return null;
        } catch (SAXException e) {
            Log.e("Error: ", e.getMessage());
            return null;
        } catch (IOException e) {
            Log.e("Error: ", e.getMessage());
            return null;
        }

        return doc;
}

/** Getting node value
  * @param elem element
  */
 public final String getElementValue( Node elem ) {
     Node child;
     if( elem != null){
         if (elem.hasChildNodes()){
             for( child = elem.getFirstChild(); child != null; child = child.getNextSibling() ){
                 if( child.getNodeType() == Node.TEXT_NODE  ){
                     return child.getNodeValue();
                 }
             }
         }
     }
     return "";
 }

 /**
  * Getting node value
  * @param Element node
  * @param key string
  * */
 public String getValue(Element item, String str) {     
        NodeList n = item.getElementsByTagName(str);        
        return this.getElementValue(n.item(0));
    } 
```

}

我阅读了我需要使用的[stackoverflow](https://stackoverflow.com/questions/8559381/e-androidruntime3306-java-lang-runtimeexception-unable-to-start-activity-com)`new Thread(new Runnable() {` ， 但我不明白如何重写我的应用程序运行良好的代码。请帮我解决我的问题！谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T17:11:33.767

来自 Android[文档](http://developer.android.com/reference/android/os/NetworkOnMainThreadException.html)。

> **当应用程序尝试在其主线程上执行网络操作时引发的异常。**
> 
> 这仅针对面向 Honeycomb SDK 或更高版本的应用程序抛出。允许以早期 SDK 版本为目标的应用程序在其主事件循环线程上进行网络连接，但非常不鼓励这样做。请参阅文档设计响应性。
> 
> 另请参阅严格模式。

[在这里](http://developer.android.com/training/articles/perf-anr.html)查看在后台运行此操作的示例（查找“*如何避免 ANR* ”）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T17:42:19.353

您无法从主线程访问网络。你需要使用 AsyncTask 。[在Android Connecting with PHP and MySql Force Close](https://stackoverflow.com/questions/13380941/android-connecting-with-php-and-mysql-force-close/13381073#13381073)检查我的答案

注意`AsyncTask<String, Void, String>`，这里第一个`String`是参数 to `doInBackground`，`Void`是参数 to `onProgressUpdate()`，我们没有实现这个方法，第二个`String`是参数 to`onPostExecute()`

现在，从`MainActivity`你调用`new InnerClass().execute(urltoxml);`Android 开始，它会自动调用`doInBackground()`并`urltoxml`作为参数传递`

在里面做你所有的网络东西`doInbackground`，完成后，doInBackground 将返回一个结果`string`，android 会将它作为参数传递给`onPostExecute()`. 在 onPostExecute 中使用你想要的字符串

```
public class MainActivity extends Activity implements OnClickListener{ 

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    Button button = (Button)findViewById(R.id.button1);
    button.setOnClickListener( new OnClickListener(){

    @Override
    public void onClick(View v){
        new InnerClass().execute(urltoxml);
    }

    });
}

public class InnerClass extends AsyncTask<String, Void, String>{

    @Override
    protected String doInBackground(String... arg0) {
        String returnVal;
        //process your xml here
        //store the result in returnVal;
        return returnVal;
    }

    @Override
    protected void onPostExecute(String result) {
        //do something with the data
    }

}

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-05T17:15:22.427

您正在`Network Request`main上运行`UI thread`。

`Android >=3.0`不允许`Network Request`在 main上运行`UI thread`。你需要使用

`AsyncTask`做网络操作。

# javascript - 将从ajax调用返回的复杂数组数据绑定到viewmodel

> ID：13728595
> 
> 赞同：1
> 
> 时间：2012-12-05T17:08:34.143
> 
> 标签：javascript, html, jquery, knockout.js, knockout-mapping-plugin

我有一个retrieveEntity Web 服务方法，它以json 字符串和数组的形式返回字段。我无法将这些字段绑定到文本框，同时保持视图模型完整。首先，我进行 ajax 调用来初始化我的数据并保存它。然后在我的视图模型中，我检索这些值，并绑定到所需的文本框。这是代码：

```
 <script type="text/javascript" language='javascript'>
 jQuery(function () {
     myViewModel = new viewmodel();
     ko.applyBindings(myViewModel);
 });

 var invoice = function () {
     var initializeURL = "ajaxwebservicecalls.asmx/RetrieveEmptyEntity";
     $.ajax({
         type: "Post",
         url: initializeURL,
         data: {},
         contentType: "application/json; charset=utf-8",
         dataType: "json",
         success: function retrieveemptyesuccess(msg) {
             passedmodel = (msg.d.Data);
             var data = ko.mapping.fromJS(passedmodel);
             var x = $.toJSON(passedmodel)
         },
         Error: function initializefail(msg) { alert(msg) }

     });

 } 
```

以下是 X 返回的一小段内容：

```
{
"Entities": {
    "Entity": [{
        "Index": "1",
        "Name": "BatchNumber",
        "Value": ""
    }, {
        "Index": "2",
        "Name": "InvoiceNumber",
        "Value": ""
    }]
},
"APInvoiceHeader": {
    "VoucherNumber": "",
    "PayLocationID": "",
    "InvoiceDescription": "",
    "InvoiceTypeID": "",
    "TermsRuleID": "",
    "TaxTypeID": "",
    "RecurringInvoice": 0,
    "APInvoiceItems": [{
        "FixedAssetReferences": [{
            "FixedAssetReferenceId": 0,
            "FixedAssetReferenceIdSpecified": true,
            "FormattedGLAccount": ""
        }]
    } 
```

接下来我根据返回的数据构建我的视图模型：

```
 var passedmodel;
        var myViewModel;
        var viewmodel = function () {

            this.invoice = ko.observable(new invoice());
            this.arrayentity = ko.observableArray([new invoice("ff"), new invoice("dd"), new invoice("zz"), new invoice("rr")]);

            this.RetrieveEntity = function () {
                var retrieveURL = "ajaxwebservicecalls.asmx/RetrieveEntity";
                $.ajax({
                    type: "Post",
                    url: retrieveURL,
                    data: {},
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    success: function retrievesuccess(msg) {
                        passedmodel = msg.d.Data;

    myViewModel.invoice(ko.mapping.fromJS(passedmodel, {}, myViewModel)); } 
```

//我希望能够使用上面的，然后在HTML绑定中指定例如：

```
data-bind="value:myViewModel.invoice().APInvoiceHeader.VoucherNumber" 
```

或者

```
data-bind="value:myViewModel.arrayentity().Entities.Entity()[0].Name" 
```

但是绑定语法给了我一个错误。相反，我解析了视图模型并且不能将其作为一个整体使用：

```
myViewModel.invoice(ko.mapping.fromJS(passedmodel.APInvoiceHeader, {}, myViewModel)); 
```

或者

```
myViewModel.arrayentity([(ko.mapping.fromJS(passedmodel.Entities.Entity[0])),    (ko.mapping.fromJS(passedmodel.Entities.Entity[1]))]); 
```

然后HTML绑定看起来像

```
 data-bind="value:myViewModel.invoice().VoucherNumber 
```

或者

```
 data-bind="value:myViewModel.arrayentity()[0].Name" 
```

绑定得很好，但这不是我希望视图模型看起来的样子。我需要将视图模型保持为一个并解析或导航的原因是因为我需要下一次更新屏幕上的值，这会更新视图模型，然后将视图模型转换回 JS，并将其传递给另一个保存的 ajax 调用新数据。

有人可以帮忙吗？任何提示将不胜感激。谢谢！

# joomla - Joomla更改博客分类页面上的领先文章html

> ID：13728598
> 
> 赞同：0
> 
> 时间：2012-12-05T17:08:54.363
> 
> 标签：joomla, content-management-system, joomla2.5

我想更改 Joomla 2.5 中博客类别页面的主要文章 html 结构。

它必须是这样的

```
<dl>
    <dt><a href="#">intro-image</a></dt>
    <dd>
        <h3>article-title</h3>
        <var>published-date</var>
        intro-text
    </dd>
</dl> 
```

我将 blog.php 文件复制到 my-template/html/com-content/category/ 并对其进行了修改

```
<?php if (!empty($this->lead_items)) : ?>
<?php foreach ($this->lead_items as &$item) : ?>
    <dl>
    <dt></dt>
    <dd>
        <?php
            $this->item = &$item;
            echo $this->item->introtext;
        ?>
    </dd>
    <?php
        $leadingcount++;
    ?>
    </dl>
<?php endforeach; ?> 
```

但正如你所见，我只设法展示了介绍文字。介绍图片、文章标题和发布日期如何显示在他们的位置上？是否还有更多文件需要修改？

我很感激任何帮助。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T17:46:42.930

到了一半。这是代码，但我不确定您所说的介绍图像是什么意思。它是文章的一部分吗？请解释一下，我也许可以让它充分发挥作用：

```
<?php foreach ($this->lead_items as &$item) : ?>
    <dl>
    <dt>
       <?php 
         $params = JComponentHelper::getParams( 'com_content' );
         $this->item = &$item;
         $images = json_decode($item->images);
             if (isset($images->image_intro) and !empty($images->image_intro)) {
                  $imgfloat = (empty($images->float_intro)) ? $params->get('float_intro') : $images->float_intro;
                  $class = (htmlspecialchars($imgfloat) != 'none') ? ' class="size-auto align-'.htmlspecialchars($imgfloat).'"' : ' class="size-auto"';
                  $title = ($images->image_intro_caption) ? ' title="'.htmlspecialchars($images->image_intro_caption).'"' : '';
                  echo '<a href="#"><img'.$class.$title.' src="'.htmlspecialchars($images->image_intro).'" alt="'.htmlspecialchars($images->image_intro_alt).'" /></a>';
              }
       ?>   
    </dt>
    <dd>
        <h3><?php echo $this->item->title; ?></h3>
        <var><?php echo $this->item->publish_up; ?></var>
        <?php echo $this->item->introtext; ?>
    </dd>
      <?php $leadingcount++; ?>
    </dl>
<?php endforeach; ?> 
```

# html - 使用 content_tag 时，Ruby on Rails 中 html 表的奇怪呈现

> ID：13728600
> 
> 赞同：1
> 
> 时间：2012-12-05T17:08:59.573
> 
> 标签：html, ruby-on-rails, ruby, html-table, content-tag

我正在尝试借助 content_tag 方法在 Ruby on Rails 中构建一个表。

当我运行这个：

```
def itemSemanticDifferential(method, options = {})

  if options[:surveyQuestion].any? then
    @template.content_tag(:tr) do
      @template.content_tag(:td, options[:surveyQuestion], :colspan => 3)
    end
  end

  @template.content_tag(:tr) do
    @template.content_tag(:th, options[:argument0])
  end
end 
```

只有第二部分被渲染：

```
@template.content_tag(:tr) do
  @template.content_tag(:th, options[:argument0])
end 
```

谁能告诉我这是为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-05T17:14:58.260

如果没有显式调用 return，Ruby Rails 返回它使用的最后一个变量。（ 例子： ）

```
def some_method(*args)
  a = 12
  b = "Testing a String"
  # ...
  3
end # This method will return the Integer 3 because it was the last "thing" used in the method 
```

使用数组返回所有 content_tag（**警告**：此方法将返回一个数组，而不是您期望的 content_tag，您需要在其上循环）：

```
def itemSemanticDifferential(method, options = {})

  results = []

  if options[:surveyQuestion].any? then
    results << @template.content_tag(:tr) do
      @template.content_tag(:td, options[:surveyQuestion], :colspan => 3)
    end
  end

   results << @template.content_tag(:tr) do
    @template.content_tag(:th, options[:argument0])
  end

  return results # you don't actually need the return word here, but it makes it more readable
end 
```

正如问题的作者所问，您需要循环结果，因为它是一个 content_tags 数组。此外，您需要使用`.html_safe`将 content_tags 输出为 HTML（而不是字符串）。

```
<% f.itemSemanticDifferential(:method, options = {}).each do |row| %>
  <%= row.html_safe %>
<% end %> 
```

# nhibernate - NHibernate 1.2 升级帮助

> ID：13728602
> 
> 赞同：1
> 
> 时间：2012-12-05T17:09:02.617
> 
> 标签：nhibernate, upgrade

我需要从 NHibernate 1.2.x 升级到最新版本。有人可以通过将我指向正确的方向来帮助我，向我解释我需要做什么，或者在快到 2013 年时对我使用 1.2 进行射击。

请。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T19:09:39.167

下载列表中的发行说明知道和可能的重大更改。可能值得一看。除此之外，我建议将新文件放入其中，看看会发生什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T17:53:56.387

简单的回答：您是否尝试过只下载最新版本？3.x 应该与你所拥有的有点兼容。

硬性答案：下载 Fluent NHibernate 并准备好进行有趣的学习。这完全取决于您为什么觉得需要升级。

# .net - 扩展 .Net 系统类以将新功能向后移植到旧平台？

> ID：13728603
> 
> 赞同：1
> 
> 时间：2012-12-05T17:09:05.093
> 
> 标签：.net

我在 VS 2012 中编写了一个默认目标为 .Net 4.5 的程序，后来有人问我需要什么绝对最小的 .Net 版本。重新定位 4.0 没有出现任何错误，尽管 3.5 和更早的版本起初似乎不太兼容。但我确信我没有使用任何“根本上”的新功能，因为我刚从 VS 2005 开始（嗯，可能是几个 LINQ 语句可以很容易地转换成循环）。换句话说，这些“新”功能都没有超出“语法/运行时糖”，如果只有微软愿意，可以在早期的 .Net 版本中实现，或者可以手动实现。

最常用的功能是：

*   Enumerable.First / Enumerable.Single*   String.IsNullOrWhiteSpace*   运算符 =(System.Type, System.Type)

我想知道是否有可能以不需要重写原始代码的方式扩展系统类，并保持与新的 .Net 版本的兼容性。

## 取 1\. String.IsNullOrWhiteSpace

我尝试添加部分类定义：

```
#If DotNet < "4.0" Then

Namespace Global.System

    <Serializable> _
    <Runtime.InteropServices.ComVisible(True)> _
    Partial Public NotInheritable Class [String]
        Inherits Object

        Public Shared Function IsNullOrWhiteSpace(ByVal sText As String) As Boolean
            Return String.IsNullOrEmpty(sText) OrElse String.IsNullOrEmpty(sText.Trim)
        End Function

    End Class

End Namespace

#End If 
```

那完全没有效果。我知道，可以在任意类中定义这样的函数，然后将其称为`StringUtil.IsNullOrWhiteSpace(...)`，但仍在寻找替代解决方案。

## 取 2\. operator =(System.Type, System.Type)

由于 .Net 4.0 之前的版本没有为 Type 类实现“=”运算符，因此无法在`Select Case`( `switch`) 构造中使用它。所以我再次尝试：

```
#If DotNet < "4.0" Then

Namespace Global.System

    <Serializable> _
    Partial Public MustInherit Class [Type]
        Inherits Reflection.MemberInfo

        Public Shared Operator =(ByVal oType1 As Type, ByVal oType2 As Type) As Boolean
            Return oType1 Is oType2
        End Operator

        Public Shared Operator <>(ByVal oType1 As Type, ByVal oType2 As Type) As Boolean
            Return oType1 IsNot oType2
        End Operator

    End Class

End Namespace

#End If 
```

它也没有帮助，但确实有一些额外的效果：当这个块被隐藏时，只显示“Operator '=' is not defined for types 'System.Type' and 'System.Type'”编译器错误，但是然后它存在，然后出现其他错误，例如“'IsEnum'不是'System.Type'的成员”和我最喜欢的“类型'System.Type'的值无法转换为'System.Type'”。怎么可能同时用我的部分定义替换了真正的 System.Type，但仍然没有看到“=”和“<>”运算符的定义？

是的，我知道，我可以恢复到老式的风格：

```
Select Case True
    Case Is TypeOf obj Is t1
        ' ...
    Case Is (TypeOf obj Is t2) OrElse (TypeOf obj is t3)
        ' ...
End Select 
```

但这真的很难看，我一直讨厌它。有没有办法用旧的 .Net 版本保留新的易读风格？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T17:13:09.903

您不能使用分部类来扩展不同程序集中的类。
部分类是纯粹的句法特征。

您创建了一个全新的类`System.Type`，它与原来的`System.Type`.
不要那样做。

# c# - 在同一端口上调试两个 Web 应用程序

> ID：13728605
> 
> 赞同：0
> 
> 时间：2012-12-05T17:09:08.937
> 
> 标签：c#, asp.net, .net, visual-studio-2010

我有两个网络应用程序。当用户单击 webapp1 中的特定链接时，它会将他们带到 webapp2。以前，我打开并运行了每个 Web 应用程序的 VS.NET 2010 实例。这让我可以单步执行 webapp1 和 webapp2 中的代码。Webapp1 是 IIS 中的 localhost\webapp1，而 webapp2 从 VS.NET 开发 Web 服务器运行。

现在我在 IIS 中有两个应用程序。Webapp1 是 IIS 中的默认网站。Webapp2 是默认网站下的子应用程序。它们在浏览器中看起来像这样：

```
webapp1: localhost\webapp1
webapp2: localhost\webapp2 
```

这些可能需要在不同的端口上。但我试图避免这种情况，因为它是不同的安全设置。在生产中，这两个应用程序的引用将与上述类似，而不是在不同的端口上。有没有办法在同一个端口上继续调试这两个？

-- EDIT1 --
上面的信息并不完全正确。Webapp1 不是默认网站。相反，它位于默认网站下。意思是 webapp2 不是 webapp1 的子级。他们是兄弟姐妹。

```
Default Web Site
  webapp1
  webapp2 
```

在 IIS 中使 webapp2 成为 webapp1 的子应用程序可以解决此问题。现在看起来像：

```
Default Web Site
  webapp1
    webapp2 
```

以上是解决方法。对不起。

-- 编辑2 --

说得太早了，现在我只能运行一个 VS.NET 实例。当我尝试启动第二个 VS.NET 实例时，我收到一个调试器已附加的错误。每个 Web 应用程序都有自己的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T19:53:07.530

您是否使用不同的应用程序池？通常，当您通过附加到进程进行调试时，您附加到正在运行应用程序池的进程（您可以通过转到 Visual Studio 管理员提示符并键入 appcmd list wp 来确定所需的进程 ID）。

# java - PDFBox - 从图像生成 PDF 的问题

> ID：13728606
> 
> 赞同：7
> 
> 时间：2012-12-05T17:09:10.077
> 
> 标签：java, pdfbox

我正在尝试从 JPEG、BMP 类型的图像生成 PDF，但我得到右侧图像的一部分总是被截断。我正在使用默认的 Windows 图片 Sunset.jpg 之一。

下面是代码：

```
 import java.awt.image.BufferedImage;
    import java.io.File;
    import java.io.IOException;

    import javax.imageio.ImageIO;
    import javax.imageio.stream.FileImageInputStream;
    import org.apache.pdfbox.exceptions.COSVisitorException;
    import org.apache.pdfbox.io.RandomAccessFile;
    import org.apache.pdfbox.pdmodel.PDDocument;
    import org.apache.pdfbox.pdmodel.PDPage;
    import org.apache.pdfbox.pdmodel.edit.PDPageContentStream;
    import org.apache.pdfbox.pdmodel.graphics.xobject.PDCcitt;
    import org.apache.pdfbox.pdmodel.graphics.xobject.PDJpeg;
    import org.apache.pdfbox.pdmodel.graphics.xobject.PDPixelMap;
    import org.apache.pdfbox.pdmodel.graphics.xobject.PDXObjectImage;

    public class ImageToPDF 
    {
        public void createPDFFromImage( String file, String image) throws IOException, COSVisitorException
        {
            PDDocument doc = null;
            try
            {
                doc = new PDDocument();
                PDPage page = new PDPage();
                doc.addPage( page );
                PDXObjectImage ximage = null;
                if( image.toLowerCase().endsWith( ".jpg" ) || image.toLowerCase().endsWith( ".jpeg" ))
                {        
                    BufferedImage awtImage = ImageIO.read( new File( image ) );             
            ximage = new PDJpeg(doc, awtImage, 0 );
                }
                else if (image.toLowerCase().endsWith(".tif") || image.toLowerCase().endsWith(".tiff"))
                {
                     ximage = new PDCcitt(doc, new RandomAccessFile(new File(image),"r"));
                }
                else
                {
                         BufferedImage awtImage = new BufferedImage(1000, 800, BufferedImage.TYPE_INT_RGB);             
                     awtImage = ImageIO.read(new FileImageInputStream(new File( image )));                              
                     ximage = new PDPixelMap(doc, awtImage);
                }
                System.out.println(" Width of the image.... "+ximage.getWidth());
                PDPageContentStream contentStream = new PDPageContentStream(doc, page);            
                contentStream.drawImage( ximage, 20, 20 );
                contentStream.close();
                doc.save( file );
           }
           finally
           {
                if( doc != null )
                {
                    doc.close();
                }
           }
       }

       public static void main(String[] args)
       {
            ImageToPDF app = new ImageToPDF();
            try
            {
                 app.createPDFFromImage( "C:\\test1.pdf", "C:\\Sunset.jpg");                        
            }
            catch (Exception e)
            {
                 e.printStackTrace();
            }
       } 
```

}

请帮助我纠正我做错的事情。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2014-03-11T07:07:01.350

这些代码可能对您有所帮助，它有效。

```
 public void createPDFFromImage(String pdfFile, 
        List<String> imgList,int x, int y, float scale) throws IOException, COSVisitorException {
    // the document
    PDDocument doc = null;
    try {
        doc = new PDDocument();
        Iterator iter = imgList.iterator();
        int imgIndex=0;
        while(iter.hasNext()) {
            PDPage page = new PDPage();
            doc.addPage(page);

            BufferedImage tmp_image = ImageIO.read(new File(iter.next().toString()));
            BufferedImage image = new BufferedImage(tmp_image.getWidth(), tmp_image.getHeight(), BufferedImage.TYPE_4BYTE_ABGR);        
            image.createGraphics().drawRenderedImage(tmp_image, null);

            PDXObjectImage ximage = new PDPixelMap(doc, image);

            imgIndex++;

            PDPageContentStream contentStream = new PDPageContentStream(
                    doc, page,true,true);

            contentStream.drawXObject(ximage, x, y, ximage.getWidth()*scale, ximage.getHeight()*scale);

            contentStream.close();
        }
        doc.save(pdfFile);
    } finally {
        if (doc != null) {
            doc.close();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-13T15:49:45.240

您是否考虑过裁剪图像以防止其被截断？

```
contentStream.drawImage( ximage, 20, 20, croppedWidth, croppedHeight ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-21T11:06:45.297

请尝试修改drawImage语句如下：

```
content.drawImage(ximage,0 /*or your preferred indent*/,(700-ximage.getHeight())); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-11-20T14:43:15.327

这是一个工作例程（使用 PDFBox 版本 2.0.x），它将 BufferedImage（例如签名）添加到作为 Byte 数组给出的 PDF 文档上。结果又是一个字节数组。

```
 public static byte[] addBufferedImageIntoPdfPage(byte[] pdfDocumentData, BufferedImage imageToAdd, int pageNumber, int posX, int posY, float scaleImage) throws IOException
{
    PDDocument originalDocument = PDDocument.load(new ByteArrayInputStream(pdfDocumentData));
    PDImageXObject pdImage = LosslessFactory.createFromImage(originalDocument, imageToAdd);
    PDPage page = originalDocument.getPage(pageNumber);
    PDPageContentStream contentStream = new PDPageContentStream(originalDocument, page, PDPageContentStream.AppendMode.APPEND, true, true);

    // better method inspired by http://stackoverflow.com/a/22318681/535646
    contentStream.drawImage(pdImage, posX, posY, pdImage.getWidth() * scaleImage, pdImage.getHeight() * scaleImage);
    contentStream.close();
    ByteArrayOutputStream outputStream = new ByteArrayOutputStream();
    originalDocument.save(outputStream);
    return outputStream.toByteArray();
} 
```

希望这可以帮助。干杯!

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-11-14T20:38:41.820

请添加以下代码段并尝试：

**需要导入：**

```
import org.apache.pdfbox.pdmodel.common.PDRectangle; 
```

**代码添加：**

```
PDXObjectImage image = new PDJpeg(pdfDoc, filePath));

float w = image.getWidth();
float h = image.getHeight();

PDPage page = new PDPage(new PDRectangle (w,h)); 
```

# ruby-on-rails - 具有即用型 Rails 开发环境的 VM 映像？

> ID：13728610
> 
> 赞同：10
> 
> 时间：2012-12-05T17:09:17.543
> 
> 标签：ruby-on-rails, ubuntu, virtualbox

所以...我一直在尝试开始开发 Rails，但我在设置环境时遇到了可怕的事情。

在虚拟机中安装了 Ubuntu 12.10。安装 RVM。安装了 Ruby 1.9.3。安装的导轨。然后 Rails 控制台不起作用，因为我没有 readline，我不得不从[这里开始使用 rvm 命令](https://rvm.io/packages/readline/)和 Stack Overflow 线程开始使用 rvm 命令，结果却得到了许多难以理解的错误。

那只是我试图起步并开始跑步。拜托了，难道没有一个现成的 VirtualBox VM 文件，其中包含为开发工作预先配置的机器吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-12-28T02:25:45.067

如果您只想为您打造一款，请访问：[https ://railsbox.io](https://railsbox.io)

教程将为您设置 vagrant/rails，就像其他答案正在谈论的那样。我没有使用它，但它看起来很可靠： [https ://gorails.com/guides/using-vagrant-for-rails-development](https://gorails.com/guides/using-vagrant-for-rails-development)

您也可以简单地使用已设置并可在任何地方使用的远程虚拟机：

[https://c9.io/](https://c9.io/)

还有其他类似的选择。

我已经使用了它们，并且它们为此目的发挥了出色的作用，它们在谷歌上也能很好地解决问题，因为您有多个人使用相同的环境。如果您是 Rails/Ruby 新手并且不熟悉使用 nix 环境，我强烈建议您使用这条路线。您还可以通过浏览器在任何地方或多或少地访问它们。

我知道这是一个相当古老的线程，但由于它在搜索中很容易出现，而且当我之前找到它时答案并不完全令人满意，我想我会扩大选项列表。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-05T17:18:10.250

发现这个：[https ://github.com/rails/rails-dev-box](https://github.com/rails/rails-dev-box)

希望它会有所帮助；与布兰登上面的评论一致。

# iphone - 使用 sqlite3 在 db iPhone 中插入数据时出现问题

> ID：13728611
> 
> 赞同：-1
> 
> 时间：2012-12-05T17:09:18.510
> 
> 标签：iphone, objective-c, ios, xcode, sqlite

我有一个问题，我试图将数据从`NSMutableArra`y 插入到我的数据库中。这是我到目前为止所拥有的：

```
- (void)insertList:(NSString*) strListName ArrayOfData:(NSMutableArray*) dataArray{
sqlite3 *database = nil;
sqlite3_stmt *addStmt = nil;

NSString *defaultDBPath = [[[NSBundle mainBundle] resourcePath] stringByAppendingPathComponent:@"customlists.sqlite"];
if(sqlite3_open([defaultDBPath UTF8String], &database) == SQLITE_OK)
{
    for (int i = 0; i < dataArray.count; i++)
    {
        PageData *pageDta = [PageData new];
        pageDta = [dataArray objectAtIndex:i];

        if(addStmt == nil) {
            const char *sql = "insert into NewList(ListName, PageName, PageNumber, id) Values(?, ?, ?, ?)";
            if(sqlite3_prepare_v2(database, sql, -1, &addStmt, NULL) != SQLITE_OK)
                NSAssert1(0, @"Error while creating add statement. '%s'", sqlite3_errmsg(database));
        }

        sqlite3_bind_text(addStmt, 1, [strListName UTF8String], -1, SQLITE_TRANSIENT);
        sqlite3_bind_text(addStmt, 2, [pageDta.strNamebyFilter UTF8String], -1, SQLITE_TRANSIENT);
        sqlite3_bind_text(addStmt, 3, [pageDta.strPageNuber UTF8String], -1, SQLITE_TRANSIENT);
        sqlite3_bind_int(addStmt, 4, i);

        if(SQLITE_DONE != sqlite3_step(addStmt))
            NSAssert1(0, @"Error while inserting data. '%s'", sqlite3_errmsg(database));
        else
            //SQLite provides a method to get the last primary key inserted by using sqlite3_last_insert_rowid
            sqlite3_last_insert_rowid(database);

        //Reset the add statement.
        sqlite3_reset(addStmt);
    }
}
else
{
    NSLog(@"Error while opening database '%s'", sqlite3_errmsg(database));
}
sqlite3_close(database);
} 
```

但是调用这个函数后，数据库是空的。有人可以帮我找到这个问题的原因和潜在的补救措施吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T17:43:37.733

主要问题很简单 - 您正在尝试写入应用程序包中的数据库。这是不允许的。应用程序的包在真实设备上是只读的（尽管它在模拟器中是可写的）。正确的做法是在应用程序第一次运行时将数据库从资源包复制到应用程序沙箱的可写区域。然后每次使用数据库都使用副本。

`for`在循环之前准备语句也会更简洁。无需继续检查是否已在每个循环迭代中设置。

您拨打电话`sqlite3_last_insert_rowid`但不对价值做任何事情。重点是什么？

循环完成后，您永远不会完成语句。你需要这样做。

完成后不会关闭数据库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T17:20:07.637

改变这一行：

```
const char *sql = "insert into NewList(ListName, PageName, PageNumber, id) Values(?, ?, ?, ?)"; 
```

至 ：

```
NSString *insertSQL = [NSString stringWithFormat: @"NSString stringWithFormat: "INSERT INTO  NewList(ListName, PageName, PageNumber, id) VALUES(\"%@\", \"%@\", \"%@\", \"%@\")" ,strListName, pageDta.strNamebyFilter, pageDta.strPageNuber, addStmt];

const char *sql = [insertSQL UTF8String]; 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-06T08:56:17.363

我已经将函数重写为：

```
 if(sqlite3_open([defaultDBPath UTF8String], &database) == SQLITE_OK)
{
    for (int i = 0; i < dataArray.count; i++)
    {
        PageData *pageDta = [PageData new];
        pageDta = [dataArray objectAtIndex:i];

        if(addStmt == nil) {
            const char *sql = [[NSString stringWithFormat:@"INSERT INTO NewList (ListName, PageName, PageNumber) values('%@', '%@', '%@')",strListName,pageDta.strNamebyFilter, pageDta.strPageNuber] UTF8String];

            if(sqlite3_prepare_v2(database, sql, -1, &addStmt, NULL) != SQLITE_OK)
                NSAssert1(0, @"Error while creating add statement. '%s'", sqlite3_errmsg(database));
        }

        sqlite3_bind_text(addStmt, 1, [strListName UTF8String], -1, SQLITE_TRANSIENT);
        sqlite3_bind_text(addStmt, 2, [pageDta.strNamebyFilter UTF8String], -1, SQLITE_TRANSIENT);
        sqlite3_bind_text(addStmt, 3, [pageDta.strPageNuber UTF8String], -1, SQLITE_TRANSIENT);

        if(SQLITE_DONE != sqlite3_step(addStmt))
            NSAssert1(0, @"Error while inserting data. '%s'", sqlite3_errmsg(database));

        //Reset the add statement.
        sqlite3_reset(addStmt);
    }
    sqlite3_finalize(addStmt);
}
else
{
    NSLog(@"Error while opening database '%s'", sqlite3_errmsg(database));
}
sqlite3_close(database); 
```

但结果是一样的:(

# sql-server - SQL Server - 从存储在一行中的值创建文本文件

> ID：13728613
> 
> 赞同：1
> 
> 时间：2012-12-05T17:09:30.043
> 
> 标签：sql-server

我有一个包含一个字段（信息）的表。

```
Information
===========
Hello World 1
This is testing message
How are  you 
```

我想创建三个文本文件（行数为 3），它们的内容基于行中的值。

所以，

*   File1.txt 将有`Hello World 1`
*   File2.txt 将有`This is testing message`

我们如何在 SQL Server 中实现这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T17:14:57.493

尝试这样的事情： -

```
use master
go

declare @DSQL Nvarchar(max)
declare @counter int
declare @maxrows int
declare @filename Nvarchar(30)

select @counter=1, @maxrows = 0

create table t1 (
 sno int identity(1,1) not null,
 filename varchar(5),
 filecontent varchar(100)
)

insert into t1
select 'FN1', 'Hello'
UNION
select 'FN2', 'Good Morning'
UNION
select 'FN3', 'How are you?'
UNION
select 'FN14', 'Where are you?'

select @maxrows = count(*) from t1

--SELECT * FROM T1

while (@counter <= @maxrows)
begin
  select @filename = filename from t1
   where sno = @counter
select @DSQL = N'exec xp_cmdshell' + ' ''bcp "select filecontent from master.dbo.T1 where sno = ' + cast(@counter as nvarchar(10)) + '" queryout "d:\temp\' + @filename + '.txt" -T -c -S home-e93994b54f'''

print @dsql
exec sp_executesql @DSQL
   select @counter = @counter + 1
end

drop table t1 
```

# spring - 在 Spring Security SAML 身份验证请求中配置 POST ProtocolBinding

> ID：13728623
> 
> 赞同：5
> 
> 时间：2012-12-05T17:10:09.573
> 
> 标签：spring, security, binding, saml, spring-saml

Spring Security SAML 坚持在 SAML 认证请求中请求 Artifact 绑定（ProtocolBinding 属性）：

```
<saml2p:AuthnRequest xmlns:saml2p="urn:oasis:names:tc:SAML:2.0:protocol"
                 AssertionConsumerServiceURL="http://sp.com/saml/SSO/alias/defaultAlias"
                 Destination="https://idp.com/idp"
                 ForceAuthn="false"
                 ID="a4acj06d42fdc0d3494h859g3f7005c"
                 IsPassive="false"
                 IssueInstant="2012-12-05T17:07:18.271Z"
                 ProtocolBinding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Artifact"
                 Version="2.0"
                 > 
```

如何配置 POST 绑定？感谢您的任何回答！

——安德烈亚斯

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-26T00:52:24.687

感谢 nobby 和 Sanjeev，我最近将这个应用到了一个类似的案例中，它让我走上了正确的轨道。

作为 Spring Security SAML2 扩展的新手，我不得不做一些额外的挖掘工作才能应用 WebSSOProfileOptions。本质上，要在 SAML 身份验证请求上获得 HTTP-POST 绑定，您需要将配置文件选项传递给该`org.springframework.security.saml.websso.WebSSOProfileImpl#sendAuthenticationRequest()`方法。

[对于我们的配置，它与 Spring RC2 示例项目中](https://github.com/SpringSource/spring-security-saml/blob/master/saml2-sample/src/main/resources/security/securityContext.xml)的配置非常相似，这意味着将`WebSSOProfileOptions`Sanjeev 解决方案中描述的 bean 传递给`samlEntryPoint.defaultProfileOptions`属性（或在那里添加绑定属性）。

麻烦的是，这并没有导致 AuthnRequest 获取设置的绑定属性。在我们的例子中，我们的 SAML 元数据是`isDefault=true`在 HTTP-Artifact bound 上指定的`AssertionConsumerService`。在我们的 RC2 版本的 Spring Security SAML2 库中，这是`org.springframework.security.saml.metadata.MetadataGenerator`.

这可以通过设置`assertionConsumerIndex`MetadataGenerator 的属性来覆盖。在我们的例子中，HTTP Post 断言消费者在索引 1 处配置。

```
<bean id="metadataGeneratorFilter" class="org.springframework.security.saml.metadata.MetadataGeneratorFilter">
   <constructor-arg>
      <bean class="org.springframework.security.saml.metadata.MetadataGenerator">
         <property name="assertionConsumerIndex" value="1" /><!-- 1=HTTP-POST -->
      </bean>
   </constructor-arg>
</bean> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-04T11:15:09.763

在`securityContext.xml`sp-initiated 绑定中可以设置。下面的示例使用了 HTTP-POST

```
 <bean class="org.springframework.security.saml.websso.WebSSOProfileOptions">
                <property name="includeScoping" value="false"/>
                <property name="binding" value="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST"/>
            </bean> 
```

绑定的值可以在`org.opensaml.common.xml.SAMLConstants`类中找到。

# php - PHP 通过 ["something_*"] 选择数组元素

> ID：13728625
> 
> 赞同：1
> 
> 时间：2012-12-05T17:10:23.880
> 
> 标签：php, arrays

我想知道这种情况。

如果我有大量关于`50k`项目或更多的说法怎么办。

现在让我们说许多数组键都有前缀让我们命名它`settings_`，现在如果我想选择键开始的所有值，`settings_`我需要循环遍历所有`50k`项目还是有更好的方法？

并且说有一些“神奇”的方法可以用单级数组来做到这一点，那么多维数组呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T17:31:32.497

有[preg_grep](http://be1.php.net/manual/en/function.preg-grep.php)，它匹配数组值。由于要搜索键，因此需要使用[array_flip](http://be1.php.net/manual/en/function.array-flip.php)反转键和值：

```
<?php
$array = array(
    'armenia' => 0,
    'argentina' => 1,
    'brazil' => 2,
    'bolivia' => 3,
    'congo' => 4,
    'denmark' => 5
);
$filtered = array_flip(preg_grep('/^b/', array_flip($array)));

var_dump($filtered);
/*
Output:

array(2) {
  ["brazil"]=>
  int(2)
  ["bolivia"]=>
  int(3)
}
*/ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T17:25:35.607

```
$arr_main_array = array('something_test' => 123, 'other_test' => 456, 'something_result' => 789);

foreach($arr_main_array as $key => $value){
    $exp_key = explode('_', $key);
    if($exp_key[0] == 'something'){
        $arr_result[] = $value;
    }
}

if(isset($arr_result)){
   print_r($arr_result);
} 
```

[您可以在http://sandbox.onlinephpfunctions.com/code/884816dd115b3ccc610e1732e9716471a7b29b0f](http://sandbox.onlinephpfunctions.com/code/884816dd115b3ccc610e1732e9716471a7b29b0f)执行代码

# android - 在没有视图的情况下运行的“共享方式”应用程序

> ID：13728628
> 
> 赞同：0
> 
> 时间：2012-12-05T17:10:36.970
> 
> 标签：android, android-intent, asynchronous, android-asynctask, android-view

我想编写一个位于“共享方式”菜单中的应用程序（用于快速向自己发送电子邮件链接到我在网络上找到的内容或在 RSS 阅读器中查看的内容）为此，我使用 intent.action.SEND 声明我的应用程序意图过滤器：

```
 <activity
        android:name="uk.co.baroquedub.checkit.MainActivity"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.SEND" />
            <category android:name="android.intent.category.DEFAULT" />
            <data android:mimeType="text/plain" />
           </intent-filter>
    </activity> 
```

这是 MainActivity 包的骨架

```
package uk.co.baroquedub.testcheck;

import android.app.Activity;
import android.os.AsyncTask;
import android.os.Bundle;

import android.widget.Toast;

public class MainActivity extends Activity {

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

// real code here grabs URL from intent then emails it as an asyncTask:
    doSendTask task = new doSendTask();
    task.execute(new String[] { "urlString" });
}

protected void showDialog (String response){
    Toast.makeText(this, response, Toast.LENGTH_SHORT).show();
    finish();
}

private class doSendTask extends AsyncTask<String, Void, String> {
    @Override
    protected String doInBackground(String... urls) {
      String response = "";
      // Real code here sends the email
      // Simulate waiting for the email to be sent:
      try { 
          Thread.sleep(5000);
          response = "Waited";
      }
      catch (InterruptedException ex) {  }

      return response;
    }

    @Override
        protected void onPostExecute(String result) {
            showDialog(result);
    }
}

} 
```

问题是我的应用程序正在浏览器顶部打开（出现一个白色屏幕，标题栏显示应用程序的名称） - 这会阻止浏览器访问，直到“等待”完成（因此破坏了目的将我的 sendEmail 功能包装在 asyncTask 中）。

请参阅：[问题演示的截屏视频](http://screencast.com/t/NbTOxcLJxu)

请参阅：[完整代码的相关问题](https://stackoverflow.com/questions/13704146/app-using-asynctask-still-hogging-the-ui-thread)

谁能告诉我如何让我的应用程序启动（从“共享方式”菜单）并执行我的代码，但实际上没有“视图”（如果这是空白屏幕和标题栏的正确术语）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T17:20:29.073

1.  在没有任何 UI 的情况下启动活动
2.  在 OnCreate 中启动一个服务来做你的后台服务
3.  开始服务后立即完成活动
4.  让服务发布通知或 Toast 完成。

如果您确实想显示一个对话框，您可以只使用来自服务的对话框启动一个单独的活动，但显示对话框通常是侵入性的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T11:14:35.607

感谢 Nandeesh 让我走上了正确的道路。对于那些想确切知道如何做到这一点的人，这里是完整的解决方案：

**1：在没有任何 UI 的情况下启动一个活动** 我在 AndroidManifest 中使用了以下主题：

> android:theme="@android:style/Theme.NoDisplay"

这使得初始应用程序不仅透明，而且完全没有 UI

**2：在 OnCreate 中启动一个服务来执行您的后台服务在** 这里，我仍然必须从 Share Intent 中“获取” URL，并将其作为 Extra 传递给该服务：

```
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    // get url
    Intent intent = getIntent();
    intent.setFlags( Intent.FLAG_ACTIVITY_CLEAR_TOP );
    String action = intent.getAction();

    // if this is from the share menu
   if (Intent.ACTION_SEND.equals(action)) {   
           title = intent.getStringExtra(Intent.EXTRA_SUBJECT);
           url = intent.getStringExtra(Intent.EXTRA_TEXT);

           // Flipboard fix (remove title in URL)
           url = url.replace(title, "");

           if (url != null){
            url = title+"\n"+url;
           } else {
            url = "error getting URL";
           }

    // prepare service
    Intent emailSendIntent = new Intent(getApplicationContext(), EmailSendService.class);
    emailSendIntent.putExtra("extraData", url);
    startService(emailSendIntent);

    finish();
   }

} 
```

**3：开始服务后立即完成活动** - 见上文

请注意，在服务中，Extras 被传递给 OnStart 方法（而不是预期的 On Create 方法）请参阅： [链接](https://stackoverflow.com/questions/5252598/android-access-variables-passed-to-service)

**4：让服务发布通知或Toast关于完成。** 我无法让服务打开对话框通知（根据我的原始应用程序），这不断使应用程序/服务崩溃，但 Toast 效果很好 - 正如 Nandeesh 所建议的那样，它可能不那么具有侵入性。

这是服务包：

```
public class EmailSendService extends Service {

String url;
String message;

@Override
public IBinder onBind(Intent arg0) {
    return null;
}

@Override
public void onCreate() {
    super.onCreate();

}

@Override
public void onDestroy() {
    super.onDestroy();
}

@Override 
public void onStart(Intent intent, int startId) {
      super.onStart(intent, startId);
      url = intent.getExtras().getString("extraData");

      String senderPassword = getResources().getString(R.string.senderPassword); 
      String senderEmail = getResources().getString(R.string.senderEmail); 
      String recipientEmail = getResources().getString(R.string.recipientEmail); 
      String subjectText = getResources().getString(R.string.subjectText);

      GMailSender sender = new GMailSender(senderEmail, senderPassword);
        try {
            sender.sendMail(subjectText,   
                    url,   
                      senderEmail,   
                      recipientEmail);
                message = "Email sent";
            } catch (Exception e) {
                message = "Error sending email";
            }
        Toast.makeText(this, message, Toast.LENGTH_LONG).show();
    } 
```

}

注意。记得在清单中声明服务（在应用程序标签内）：

```
 <service
        android:name=".EmailSendService"
        android:label="CheckIt EmailSendService" >
    </service> 
```

# c++ - 通过结构指针访问结构变量分配错误数据

> ID：13728629
> 
> 赞同：-5
> 
> 时间：2012-12-05T17:10:45.237
> 
> 标签：c++

```
/* c++ file */
extern "C"
{
#include "Param.h"
#include "manager.h"      
}
void Manager::Init(){

    struct config pParam;   
    memset(&pParam, 0, sizeof(pParam));

    pParam.pulse = 123;
    pParam.rotation = 567;

    Parameters(&pParam);
}

/* c file */
int max_pulse = 0, rotation = 0;
void Parameters(const struct config *p_param)
{
    max_pulse   = p_param->pulse; // assign the wrong data here
    rotation    = p_param->rotation; // assign the wrong data here
} 
```

这是一个非常奇怪的问题。

config 在 Param.h 中定义，管理器类在 manager.h 文件中定义。

运行代码后，我得到 max-pulse = 567 和 rotation = 0。我不知道为什么这段代码会发生这种情况。我正在使用 Visual Studio 2008 Express。

有人可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T17:18:34.227

您收到错误可能是因为您在初始化成员`Parameters()`时使用参数调用函数。`pParam``p_param`

# php - 是否有充分的理由使用服务器端包含而不是包含在 LAMP 环境中

> ID：13728631
> 
> 赞同：0
> 
> 时间：2012-12-05T17:10:52.443
> 
> 标签：php, apache2, ssi

我只是好奇，在 LAMP 环境中使用`SSI`而不是 PHP有什么好的理由吗？`include`我真的想不出任何好的论据来支持它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T17:24:09.963

TL;DR：不要使用 SSI。如果您只包含 100% 静态 HTML，（不是其他`include()`或任何东西）使用`readfile()`.. 否则，只需使用`include()`并确保任何随机的人都不能像我希望任何人那样写入这些文件。

SSI 包含可能是一个主要的痛苦，因为它们特别依赖于 Apache（尝试让 nginx 读取 SSI 的 .. 这并不有趣）并且除了 ......

如果有问题的文件是包含 SSI 还是包含 PHP - 如果它具有不安全的写入权限或出于任何原因不受信任的来源能够写入它，这将成为一个主要问题。请记住，当您`include()`执行 PHP 代码时。

有一些 SSI 指令也可以执行 exec ( `#exec`)，这也很危险，但可能比 PHP 本身的范围更有限（或者，它**可能**更危险，对每个特定情况都非常依赖和主观）

但是，如果您要包含的相关文件不包含且永远不会包含 PHP 代码且仅包含 HTML，请不要使用`include()`，而是使用：

```
echo file_get_contents('filename.html'); 
```

因为这会更安全，因为什么都不会被执行。或者您也可以使用 readfile，如果您正在处理包含的非常大（10MB+）的文件，这可能会更有效：

```
readfile('filename.html'); 
```

因此，我的看法可能是您应该使用 PHP 而不是 SSI，但我可以根据经验告诉您，SSI 可能变得难以管理并且至少比`file_get_contents()`or没有更多的好处`readfile()`，同时`include()`具有如果它包含 PHP 的特殊功能代码（好或坏），它将被执行。

# php - 在 $row 中提取特定记录

> ID：13728632
> 
> 赞同：1
> 
> 时间：2012-12-05T17:10:55.783
> 
> 标签：php, mysql

我想在 $row 中显示第二条记录。

这是我的查询

```
select    LEFT(A.F_ANOTRIMESTRE, 4) Year,
      RIGHT(A.F_ANOTRIMESTRE, 2) Quarter,

      IF(RIGHT(A.F_ANOTRIMESTRE, 2)=03,'Enero a Marzo',
      IF(RIGHT(A.F_ANOTRIMESTRE, 2)=06,'Abril a Junio',
      IF(RIGHT(A.F_ANOTRIMESTRE, 2)=09,'Julio a Septiembre',
      IF(RIGHT(A.F_ANOTRIMESTRE, 2)=12,'Octubre a Diciembre',
      '')
      ))) Quarter_Name,

      ROUND(A.POR_RENTABILIDAD, 2) Quarterly_yield

from      dr_rent_carteras_trimestres A
where     A.ID_CARTERA = $ID_CARTERA
And       A.IND_RENTABILIDAD = 1

Order by A.F_ANOTRIMESTRE asc 
```

这里是php。

```
while($row = mysql_fetch_array($result))
  {
    $currentState = ($currentState == 'odd' ? 'even' :'odd' );

 echo "<tr id='centered' >";  echo "<td class='leftalign'>" . $row['Quarter_Name'] .     "</td>";

echo "<td>" . $row['Quarterly_yield'] . "</td>";

  echo "</tr>";
  }
echo "</tbody></table>"; 
```

我想在 Quarterly_yield 中提取第二条记录。我将如何显示它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T17:12:50.730

如果您想从 PHP 中执行此操作，您只需索引您的结果，就像您执行任何其他数组一样。

或者，您可以通过在查询末尾使用 LIMIT 1,1 从 MySQL 执行此操作。例如，这是您修改后的查询。注意最后一行：

```
select    LEFT(A.F_ANOTRIMESTRE, 4) Year,
  RIGHT(A.F_ANOTRIMESTRE, 2) Quarter,
  IF(RIGHT(A.F_ANOTRIMESTRE, 2)=03,'Enero a Marzo',
  IF(RIGHT(A.F_ANOTRIMESTRE, 2)=06,'Abril a Junio',
  IF(RIGHT(A.F_ANOTRIMESTRE, 2)=09,'Julio a Septiembre',
  IF(RIGHT(A.F_ANOTRIMESTRE, 2)=12,'Octubre a Diciembre',
  '')
  ))) Quarter_Name,
  ROUND(A.POR_RENTABILIDAD, 2) Quarterly_yield
  from      dr_rent_carteras_trimestres A
  where     A.ID_CARTERA = $ID_CARTERA
  And       A.IND_RENTABILIDAD = 1
  Order by A.F_ANOTRIMESTRE asc
  LIMIT 1,1 
```

# c# - TimeStamp_Sys100NS 从 Win32_PerfFormattedData_PerfProc_Process wmi 返回 null

> ID：13728633
> 
> 赞同：2
> 
> 时间：2012-12-05T17:10:57.203
> 
> 标签：c#, wmi, wmi-query, wmi-service

我正在尝试使用 wmi 查询返回 TimeStamp 属性并获取对象引用错误。当我查看 quickwatch 时，属性本身为空。我在网上看到过这样的例子，但无法弄清楚为什么这个属性在给我查询的所有其他内容的同时返回 null。

我正在使用 Windows 7 机器

```
 public List<string> ReturnProcesses()
    {
        string processname;

        ulong N1 = 0;
        ulong D1 = 0;
        ulong N2 = 0;
        ulong D2 = 0;

        ConnectionOptions options = new ConnectionOptions();

        options.Impersonation = ImpersonationLevel.Impersonate;
        List<string> Processlist = new List<string>();
        ManagementScope scope = new ManagementScope("\\root\\cimv2");
        scope.Connect();
        ObjectQuery query = new ObjectQuery("SELECT IDProcess,Name,PrivateBytes,PercentProcessorTime,TimeStamp_Sys100NS FROM Win32_PerfFormattedData_PerfProc_Process");
        ManagementObjectSearcher searcher = new ManagementObjectSearcher(scope, query);
        ManagementObjectCollection queryCollection = searcher.Get();
        try
        {
            foreach (ManagementObject mo in queryCollection)
            {
                ulong privbytes = (ulong.Parse(mo["PrivateBytes"].ToString()) / 1024);
                processname = mo["IDProcess"].ToString() + " " + mo["Name"].ToString() + " " + mo["PercentProcessorTime"].ToString() + " " + privbytes.ToString();
                N2 = ulong.Parse(mo["PercentProcessorTime"].ToString());
                D2 = ulong.Parse(mo["TimeStamp_Sys100NS"].ToString());
                Processlist.Add(processname);
            }
        }
        catch (Exception ex)
        {
            throw ex;
        }
        return Processlist;
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-16T15:07:55.550

You need to use `Win32__PerfRawData_PerfProc_Process` instead of `Win32_PerfFormattedData_PerfProc_Process`.

# neo4j - Neo4j 密码查询加速

> ID：13728638
> 
> 赞同：1
> 
> 时间：2012-12-05T17:11:21.740
> 
> 标签：neo4j, cypher

我正在一个通过 php 库使用 Neo4j 的网站上工作。困扰我的是我的建议出现得很慢（1-3 秒）。它们应该几乎立即出现。我正在使用 Jquery ui Autocomplete 来显示结果，以及以下密码查询：

```
$query = "START n = node:Destination('name:*')
          WHERE  ( n.name =~ '(?i).*".$input.".*' OR n.name2 =~ '(?i).*".$input.".*' ) AND has( n.published )
          RETURN n
          LIMIT 6"; 
```

有没有人有任何优化想法，或者有人可以告诉我我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T11:25:55.253

为什么要在所有 Destination 节点中搜索，并且只是在 where 子句中与已插入的输入区分开来？您可以将其放入定义子句中：

```
$query = "START n = node:Destination('name:".$input."*'),n2 = node:Destination('name2:".$input."*')
          WHERE   has( n.published ) AND has (n2.published)
          RETURN n,n2
          LIMIT 6"; 
```

你能用这个查询测量时间吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T11:26:32.353

来自@maxdemarzi 的回答

`START n = node:Destination('name:*')` <--**不好**

看看这里的搜索示例=> [http://maxdemarzi.com/2012/11/14/crunchbase-on-neo4j/](http://maxdemarzi.com/2012/11/14/crunchbase-on-neo4j/)

```
query = "name:*#{params[:term]}* OR name2:*#{params[:term]}*"

get '/search' do 
  content_type :json
  neo = Neography::Rest.new    

  cypher = "START me=node:node_index({query}) 
            RETURN ID(me), me.name
            ORDER BY me.name
            LIMIT 15"
  query = "permalink:*#{params[:term]}* OR name:*#{params[:term]}*"
  neo.execute_query(cypher, 
                    {:query => query })["data"].
                      map{|x| 
                           { label: x[1], 
                             value: x[0] }
                         }.to_json   
end 
```

# ruby - C# 到 ruby 校验和的转换

> ID：13728644
> 
> 赞同：0
> 
> 时间：2012-12-05T17:11:57.360
> 
> 标签：ruby, ruby-on-rails-3

我有一个校验和，需要添加到十六进制的红宝石字符串中。我一直无法成功转换校验和。我对 ruby​​ 比较陌生，所以我不确定我是否遗漏了什么。这是我正在做的事情：

```
 def get_checksum message
    # get the checksum
    cnt = 0
    lrc = 0
    while (cnt < message.length - 1)
      lrc = lrc ^ message[cnt].to_i
      cnt += 1
    end

    # return as hex
    lrc.to_s.each_byte.map { |b| b.to_s(16) + " " }.join
  end 
```

我也有一些 c# 参考代码，但从未使用过 C# 作为长期 mac C/C++/Obj-C 编码器。这是我要转换的 C# 代码：

```
// calculate LRC
private string GetChecksum(string inputstring)
{
    int checksum = 0;
    foreach (char c in inputstring)
    {
        checksum ^= Convert.ToByte(c);
    }
    return checksum.ToString("X2");
} 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T17:30:32.530

`.to_i``0`在角色上调用时将返回。

```
def get_checksum message
   # get the checksum
   lrc = 0
   message.each_byte do |b|
      lrc = lrc ^ b
   end
   # return as hex
   lrc.to_s(16)
end 
```

# php - 如何删除谷歌柱形图中的小数

> ID：13728645
> 
> 赞同：3
> 
> 时间：2012-12-05T17:11:56.987
> 
> 标签：php, charts, google-visualization

如何在垂直轴上只显示整数？

我有这个：http: [//jsbin.com/oxodab/1](http://jsbin.com/oxodab/1)

但我只想在垂直轴上有 1 和 2。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T16:56:47.727

对于柱形图，没有`vAxis.showTextEvery`属性！

[您可以将十进制数字（在此处检查](http://jsbin.com/oxodab/8/)）与`vAxis.format: '#'`属性中继。但是你只会得到离散值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-04T18:19:08.147

我设法通过在选项中添加这一行来做我想做的事：

```
vAxis: {maxValue: x} (x > 5) 
```

不完美......但它的工作原理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-09-15T08:43:32.030

这听起来很疯狂，但它对我的案子来说就像魅力一样。随意分享您的用例，该用例不适用于这个小魔术。

消除错误需要做的事情：

*   将网格线的数量限制`vAxis`为 4（这对我们大多数人来说已经足够了）。
*   `maxValue`从图表数据中找到最大值。
*   然后将最大值`maxValue`除以 4 以确定结果是否为十进制数。`e.g. 20/ 4 = 0.5`
*   这样，我们就可以有条件地添加`maxValue`到`vAxis`like中：

    ```
    const maxValue = 20; // Say, the maximum value is 20.

    ...
    vAxis: Object.assign({}, { ... }, noDecimals(maxValue)),
    ...

    /**
     * Check if the divided value has decimals.
     * If it's decimals, increment the 'maxValue' by 1.
     */
    function noDecimals(maxValue) {
      return /\d+\.\d+/i.test(maxValue / 4)
        ? { maxValue: maxValue + 1 }
        : {};
    } 
    ```

最初，当您尝试分配从图表数据中找到的最大值时，它没有按预期工作。通过增加最大值`1`将使谷歌图表很好地适应它。

希望这对遇到此问题的人有所帮助！

# sql - 根据多行中的值创建字符串

> ID：13728651
> 
> 赞同：2
> 
> 时间：2012-12-05T17:12:09.940
> 
> 标签：sql, oracle

甲骨文 11G

*   Table1 有 T1_ID
*   Table2 有 T1_ID 和一个表示二进制数的字符串 (BIN_STR)

    1.  如果 Table1.T1_ID 不在 Table2 中，则返回一串 0
    2.  如果 Table1.T1_ID 在 Table2 中只找到一次，则返回是 Table2 中的字符串
    3.  如果在 Table2 中多次找到 Table1.T1_ID，则返回需要是 Table2 中字符串的按位或。

例子：

表格1

```
T1_ID 
    1 
    2 
    3 
```

表2有这些记录

```
T1_ID   BIN_STR 
    2    '0101'
    3    '0100'
    3    '1000' 
```

结果集需要有

```
T1_ID   BIN_STR 
    1    '0000'
    2    '0101'
    3    '1100' 
```

我有：

```
SELECT Tbl1.T1_ID,
       CASE (SELECT COUNT(*) FROM Table2 Tbl2 WHERE Tbl1.T1_ID = Tbl2.T1_ID)
         WHEN 0 THEN '0000'
         WHEN 1 THEN (SELECT Tbl2.BIN_STR FROM Table2 Tbl2 WHERE Tbl1.T1_ID = Tbl2.T1_ID)
         ELSE ???
       END AS "BINSTR"
FROM Table1 Tbl1 
```

我知道这可以通过存储过程中的自定义函数调用来完成。有没有办法在 SQL PLUS 中做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T23:18:46.640

在 SQL 11g 中有几种方法可以做到这一点。这是实际的 MODEL 子句：

```
SQL> with data as (select t1.t1_id, nvl(t2.bin_str, '0000') bin_str
  2    from table1 t1
  3         left outer join table2 t2
  4                      on t1.t1_id = t2.t1_id)
  5  select t1_id, new_bin_str bin_str
  6    from (select *
  7    from data
  8   model
  9   partition by (t1_id)
 10   dimension by (row_number() over (partition by t1_id order by bin_str) rn )
 11   measures (bin_str, cast(null as varchar2(16)) new_bin_str,
 12   count(*) over (partition by t1_id ) c)
 13  rules (
 14  new_bin_str[any] order by rn  =
 15                    case when bin_str[cv() - 1 ] is null
 16               then bin_str[cv()]
 17                        else cast(utl_raw.bit_or(new_bin_str[cv()-1],bin_str[cv()]) as varchar2(16))
 18           end ))
 19   where c = rn;

     T1_ID BIN_STR
---------- --------------------
         1 0000
         2 0101
         3 1100 
```

让我们分解一下。

```
SQL> with data as (select t1.t1_id, nvl(t2.bin_str, '0000') bin_str
  2    from table1 t1
  3         left outer join table2 t2
  4                      on t1.t1_id = t2.t1_id) 
```

这只是我们的基本查询，其中包含我们感兴趣的所有数据。

现在我们需要对它进行异或（可通过 utl_raw.bit_or 获得），并且只显示每个 T1_ID 的最终结果。

示范条款可以为我们做到这一点。首先，我们定义一个“分区”，因为我们希望将计算隔离到特定的 T1_ID。

```
 9   partition by (t1_id) 
```

接下来，我们对每一行应用一个顺序，以便我们每次都以相同的方式做事。即对于 T1_ID = 3 你有 0101 和 1100 所以我们想要做`0101 XOR 1100`和计算这个结果。如果有第三个二进制“0001”，我们就想这样做`0101 XOR 1100 = res`，`res XOR 0001`依此类推。而且我们只对最终结果感兴趣，所以我们可以使用行号最后为我们过滤：

```
 10   dimension by (row_number() over (partition by t1_id order by bin_str) rn ) 
```

我们也将维护每行的计数`T1_ID`：

```
 12   count(*) over (partition by t1_id ) c) 
```

即，当`rn = c`这是每个`T1_ID`.

措施条款

```
 11   measures (bin_str, cast(null as varchar2(16)) new_bin_str, 
```

现在将是我们正在操作的。即`bin_str`，而且，你看我已经定义了一个空白列`new_bin_str`。这将是我们的保存列，保存 XOR 操作的结果。

现在计算部分是执行 XOR 的部分：

14 new_bin_str[any] order by rn = 15 case when bin_str[cv() - 1] 为空 16 then bin_str[cv()] 17 else cast(utl_raw.bit_or(new_bin_str[cv()-1],bin_str[cv ()]) as varchar2(16)) 18 结束))

所以这就是说，对于第一行的每一行 (new_bin_str[ANY]) 只需使用 的值，`bin_str`但对于随后的每一行，我们将先验`new_bin_str`和 XOR 与当前`bin_str`值相异。这给了我们以下输出：

```
 T1_ID         RN BIN_STR              NEW_BIN_STR               C
---------- ---------- -------------------- ---------------- ----------
         1          1 0000                 0000                      1
         2          1 0101                 0101                      1
         3          1 0100                 0100                      2
         3          2 1000                 1100                      2 
```

你现在可以看到 NEW_BIN_STR 有我们需要的结果，但它也有所有的中间“工作”。所以我们过滤 c=rn 最终得到：

```
 T1_ID         RN BIN_STR              NEW_BIN_STR               C
---------- ---------- -------------------- ---------------- ----------
         1          1 0000                 0000                      1
         2          1 0101                 0101                      1
         3          2 1000                 1100                      2 
```

在外部选择中，我只选择`T1_ID`and `NEW_BIN_STR`。

其他方式可能是递归因子子查询、用户定义的聚合（例如，像 listagg 但一个执行异或的聚合），甚至可能是 xquery（没有想到这一点，但它也可能有能力这样做）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T17:19:55.243

我认为您需要的是按位或聚合函数。而且，Oracle 提供了它（参见[http://docs.oracle.com/cd/E17952_01/refman-5.1-en/group-by-functions.html#function_bit-or](http://docs.oracle.com/cd/E17952_01/refman-5.1-en/group-by-functions.html#function_bit-or)）。

您需要将这些值转换为 BIGINT。这假设您在字符串中少于 64 位：

```
select t1_id, cast(bit_or(cast(bin_str as bigint)) as varchar(255))
from table2
group by t1_id 
```

# c# - .NET 桌面应用程序方法的良好实时显示性能和输入处理

> ID：13728653
> 
> 赞同：4
> 
> 时间：2012-12-05T17:12:23.870
> 
> 标签：c#, wpf, performance, gdi+

我的任务是编写一个 .NET 应用程序，该应用程序显示带有一些信息（文字或图像）的幻灯片，当用户看到某些项目时，她/他必须立即按空格键并且必须记录按键时间。这些项目将一个接一个地显示，大约 50 毫秒。然后我需要评估按键的时间戳和幻灯片开始时的时间戳之间的差异（这样我就会知道用户对呈现的项目做出反应需要多长时间）。 *编辑：*我还必须记录特殊项目的发生时间。

我需要减少应用程序运行时可能发生的任何不可预测的延迟，以便输入处理尽可能真实，并减少幻灯片之间的任何延迟。目前我正在考虑3种方法：

*   编写一个标准的 Windows 窗体 (GDI+) 应用程序。
*   编写 WPF 应用程序
*   编写一个支持 DirectX 的 Windows 窗体应用程序，该应用程序利用[Tom Miller 的 Render 循环](http://social.msdn.microsoft.com/forums/en-US/gametechnologiesgeneral/thread/17775f03-b243-43ae-b8ce-bf43646b2e4a/)概念（它在性能方面被称赞为有效）。

*   您可能会建议的其他内容

我必须澄清一下，我不会使用高级显示技术、特殊效果或为目的而设计的 3D 环境——只是使用不同字体和颜色的纯文本幻灯片或图像。不幸的是，我无法引用我的资料来源，但我读到 Windows 窗体和 GDI+ 无法为我提供所需的准确性。那么，WPF 会不会为我提供更好的解决方案呢？我需要使用渲染循环还是其他方法。我对桌面应用程序的此类性能要求没有经验，所有建议将不胜感激。

* * *

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-05T17:33:43.467

我个人喜欢 WPF，但我会非常谨慎地将它用于此应用程序。它不会具有与 GDI+ 或 DirectX 相同的时间精度。您必须使用各种各样的东西，比如 DispatchTimer，而它并不是为这样的东西而构建的。WPF 是图形之上的一整套巨大的抽象，你离金属越远，你就会引入潜在的问题。如果您想将投影在 3D 球体顶部的视频放在组合框内，那么 WPF 是可行的方法，但如果您需要在您所说的比例上准确/精确，WPF 不是答案。我不知道你在哪里读到 WPF 会为你提供更好的准确性，我几乎可以保证它不会。

DirectX 很可能是确保图片一次仅显示 50 毫秒的最准确方法。但是 GDI+ 将是一个不错的替代解决方案，因为从编程的角度来看，它可以更轻松地处理文本。

另一个考虑因素是屏幕刷新率。哎呀。如果您进行数学计算，大多数 LCD 的响应速度为 5 毫秒，这是您分配时间的 10%。那和它们仅以 60Hz 显示。如果您每秒显示 20 张图片（每张图片 50 毫秒），它只会在屏幕上显示 3 个刷新周期。

我希望这有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T17:20:55.200

50 毫秒并不长。也许将幻灯片编码并播放为视频？

# mysql - mysql中的两个外键（INNO DB）

> ID：13728656
> 
> 赞同：0
> 
> 时间：2012-12-05T17:12:30.917
> 
> 标签：mysql

我有 2 张桌子：

```
id box_name hidden

---------------------------

id item_name box_id hidden 
```

所以外键是box_id，如果盒子被删除或更新，它也会触及子项目，但我怎样才能使隐藏字段相同，它们是具有相同类型int（11）的索引，如果我隐藏一些盒子，所有的孩子都被隐藏了，但是如何只隐藏那些引用box_id -> id的孩子，那些隐藏的？？？

或者换句话说，如何制作 2 个外键

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T17:23:32.233

您可以通过在父表`id,hidden`字段上添加唯一约束并更改详细表以使其具有 FK 到 ( `id,hidden`) 而不仅仅是`id`. 但是，在这种情况下，我不明白为什么需要将`hidden`属性存储在详细表中，因为它始终与 parent 相同`hidden`。

我宁愿在主表上添加一个更新后触发器，以更新详细表[s]中的所有必要行。

**更新**。例子。
第一种方法

```
CREATE TABLE boxTable(id int not null auto_increment primary key,hidden 
tinyint not null,
...
CONSTRAINT UQ_BOXTABLE(id,hidden));
CREATE TABLE childTable(...., boxId int not null, hidden tinyint not null,
 CONSTRAINT FK_childTable_BoxTable FOREIGN KEY (boxId, hidden) REFERENCES 
 boxTable(boxId, hidden) ON DELETE CASCADE ON UPDATE CASCADE) ; 
```

每次您`hidden`在 boxTable 中更改时，它都会自动更新为`childTable`.

第二种方法（仔细检查语法，我目前没有 mysql）

```
CREATE TRIGGER AU_boxTable AFTER UPDATE ON boxTable 
FOR EACH ROW
BEGIN 
  IF (new.hidden <> old.hidden) THEN 
    update childTable set hidden = new.hidden WHERE boxId = new.id;
  END IF;
END; 
```

第二种方法允许您更改`hidden`childTable 中的字段，而不管 中的值如何`boxTable`，第一种方法不会。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T17:56:38.210

我怀疑您误解了外键的用途。它们基本上旨在强制引用完整性，因此您不能物理存储目标行不存在的外键。而且它们还有助于保持这种完整性，因此当您尝试删除在另一个表中引用的行时，您要么不被允许，要么被级联删除。

但是没有办法使用外键来执行任意级联更新。它们根本不是为此而设计的。

也许您正在考虑**触发器**：-？

# sql - 使用包和游标连接三个表

> ID：13728658
> 
> 赞同：0
> 
> 时间：2012-12-05T17:12:44.223
> 
> 标签：sql, oracle10g, oracle11g

我是 sql 新手，所以我需要帮助来理解这一点。

我有 3 张桌子：-

表 1：- 员工编号。员工姓名 person_id

表 2 :- 联系电话 person_id

表 3 :- 地址 person_id

我试图制作一个包并使用一个过程来定义一个游标。现在我想使用连接显示表中的联系人号码、地址和员工号码。我已经应用了连接条件，但无法理解如何显示结果。

*包体*

```
create or replace package pacakge_name
    as 
    procedure procedure_name

    declare
    cursor cur_name is select * from table1 join table2 on table1.person_id=table2.person_id join table 3 on table1.person_idd=table3.id;

    var_curname cur_name%rowtype;

    begin

    open cur_name;

    loop
    fetch cur_name into var_curname
    exit
    when cur_name%NOTFOUND;
    end loop;
    close cur_name;
    end; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T17:26:17.530

要向控制台显示结果，您必须`dbms_output.put_line(var_curname.fieldname);`

这将是您的光标查询：

```
select table2.contact_no,
table3.address,
table1.employee_no
from 
table1,
table2,
table3
where table1.person_id = table2.person_id and
table2.person_id = table3.person_id 
```

所以你的 dbms_output.put_line 将是

```
dbms_output.put_line(var_curname.contact_no||'-'||var_curname.address||'-'||var_curname.employee_no); 
```

# math - 从一个坐标空间到另一个坐标空间的映射变换

> ID：13728659
> 
> 赞同：0
> 
> 时间：2012-12-05T17:12:49.820
> 
> 标签：math, opengl, matrix, 3d, transformation

我有两个定义两个坐标空间的 4x4 变换矩阵。我试图用另一个坐标空间来表达一个坐标空间中的平移变换。谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-05T18:49:26.300

令 A 为从空间*a*到全局空间*G*的矩阵。

令 B 为从空间*b*到全局空间*G*的矩阵。

然后从*a*到*b*我们首先用 A 变换到*G*然后用 B^-1 （B的倒数）从*G*到*b*。因此

```
v_b = B^-1 · A ·v_a 
```

# wpf - 停靠窗口可以停靠在任何地方或仅停靠在顶部、底部、左侧、右侧吗？

> ID：13728661
> 
> 赞同：1
> 
> 时间：2012-12-05T17:12:51.230
> 
> 标签：wpf, winforms, dock

我需要在我的用户界面（WPF，WinForms）中使用很多这样的窗口，
说一个带有文本“设置”的标签，当鼠标悬停它时，会出现一个窗口，当鼠标移开时，窗口会消失。标签和窗口应该排列起来，看起来好像它们是一个标签控件，标签是标题，窗口是标签项。标签可以位于主 UI 的任何位置。我正在考虑停靠窗口。
我刚开始，所以不确定我的问题是否有意义。我的理解是我可以使用嵌套的停靠窗口，就像在面板内使用停靠窗口一样，面板是父面板/窗口的一个子级。但是嵌套面板不是很直/很容易。所以我想知道停靠窗口是否可以停靠在任何地方？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T23:00:19.997

我认为对您来说最好的解决方案可能是使用现有的库而不是重新发明轮子。请参阅[这个](http://avalondock.codeplex.com/)优秀的对接库，它可能提供您需要的所有要求。它的名字是 AvalonDock，它被几个大项目使用。一个例子是 SharpDevelop，这个软件使用 AvalonDock 库。希望这对你有帮助......

# c# - C# asmx web 服务随机开始重定向

> ID：13728666
> 
> 赞同：0
> 
> 时间：2012-12-05T17:13:15.447
> 
> 标签：c#, web-services

星期一下午，我正在开发一个 Web 服务，能够在浏览器中请求 .asmx 文件，并获得了可用方法的菜单，并且能够毫无问题地从浏览器中调用它们。星期二来了，每次我访问它时，我都会收到一条“对象已移至此处”的消息，该消息链接到一个不存在的 login.aspx 页面。

这是 .asmx.cs 文件：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Services;
using System.Web.Script.Services;
using System.Data.SqlClient;

namespace LegacyReports
{
  /// <summary>
  /// Summary description for Example
  /// </summary>
  [WebService(Namespace = "http://company.com/")]
  [WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
  [System.ComponentModel.ToolboxItem(false)] 
  //[System.Web.Script.Services.ScriptService]
  public class Example : System.Web.Services.WebService
  {

    [WebMethod]
    [ScriptMethod(ResponseFormat = ResponseFormat.Json, UseHttpGet = false)]
    public List<ExampleData> ExampleDataSet()
    {
      Context.Database db = new Context.Database();
      String sql = @"SELECT TOP 10 * FROM sometable";
      SqlDataReader reader = db.ExecuteReader(sql);
      List<ExampleData> data = new List<ExampleData>();

      while (reader.Read())
      {
        int a = Convert.ToInt32(reader["somecolumn"]);
        String b = (String)reader["anothercolumn"] + " " + (String)reader["someotherrandomcolumn"];
        data.Add(new ExampleData() { a = a, b = b });
      }

      return data;
    }
  }

  public class ExampleData
  {
    public int a { get; set; }
    public String b { get; set; }
  }
} 
```

我只是不确定为什么它会在一天工作然后在第二天停止。它可能与IIS有关吗？

# java - 如何让netbeans触发System.in？

> ID：13728673
> 
> 赞同：0
> 
> 时间：2012-12-05T17:13:32.147
> 
> 标签：java, netbeans

```
BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
int num_strings = Integer.parseInt( br.readLine()), i; 
```

这只是我的代码示例，我知道`System.in`会要求用户输入并且`br.readLine`实际上会要求用户输入单行。但问题是当我运行它时，输出控制台只是说：运行：

```
BUILD SUCCESSFUL (total time: 0 seconds) 
```

永远不要问我用户输入，它贯穿它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T17:15:21.920

你建立这个。你应该运行它。
点击`Shift + F6`主类。

对我来说，您的代码运行良好。
按下后`Shift + F6`- 控制台正在等待输入

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T07:36:44.227

您需要运行文件而不是项目，该快捷键是 Shift + f6

# jquery - 一些 jQuery 代码在 VS2012 中无法运行，但在 VS2010 中运行良好

> ID：13728676
> 
> 赞同：0
> 
> 时间：2012-12-05T17:13:37.680
> 
> 标签：jquery, asp.net, visual-studio-2010, visual-studio-2012

我们刚刚将代码升级到 .Net 4.5，现在正在使用 VS2012，但是一些 jQuery 代码不再工作了。例如，在一个页面中，我们在 DataGrid 中有一个复选框。

获取复选框列表的代码：

```
$('input:checkbox[id$=MappingGrdCb]').each(function() {
    //....
} 
```

这在 VS2010 中工作正常，`$('input:checkbox[id$=MappingGrdCb]')`返回一个复选框数组，但在 VS2012 中，它是空的。

任何人都可以帮助我吗？多谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T17:24:35.580

而不是`ends with selector`试试这个 `Attribute contains selector`

```
$('input:checkbox[id*="MappingGrdCb"]') 
```

# javascript - 单击特定图像时自动填充文本字段中的一些单词

> ID：13728678
> 
> 赞同：-3
> 
> 时间：2012-12-05T17:13:46.177
> 
> 标签：javascript, html, onclick

我知道如何在 HTML 中创建一个文本字段。但我想要的是：我有一个文本字段，下面有五个图像。如果用户点击第一张图片，“p1”这个词应该会自动写在文本字段中。如果用户单击第二张图像，则应写入单词“p2”，依此类推直到“p5”。用户可以随意点击任何图像任意次数。他还可以使用键盘键入并交替单击图像。那么，当用户单击图像时，如何使“p1”、“p2”等自动填充发生？

编辑：假设第一张图片是：

`<img src="image1.jpg" alt="p1" onclick="write('p1')">`

那么在函数 write() 的主体中应该写什么来完成任务呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T17:47:30.463

尝试

```
function write(text){
    document.getElementById("textFieldId").value += text;
} 
```

# python - 在用户创建的窗口上查找文件

> ID：13728680
> 
> 赞同：0
> 
> 时间：2012-12-05T17:13:58.060
> 
> 标签：python, .net, windows, powershell

作为我公司文档清理工作的一部分，我被要求为以下问题找到解决方案。我们希望为我们的（非常非技术人员）用户群提供一种在共享驱动器上查找自己的文件的方法。它应该是按需的，这意味着用户可以在他们认为合适并看到实时结果时使用该解决方案。

我们有一个文件[硬盘管理工具](http://www.jam-software.com/spaceobserver/?cp=Domain_spaceobserver.com) ，所以我可以针对该工具的数据库编写一个存储过程并返回其中包含的数据，但是这种方法有几个缺点：

*   对用户不友好（再次，技术挑战用户群）
*   数据可能长达一周
*   难以实施“按需”战略

理想情况下，有一个 Windows 实用程序，例如 Windows 资源管理器中的搜索栏，用户可以在其中输入他们的凭据，它会返回他们拥有的文件列表。

下一个最好的将是罐装工具——想到任何工具吗？

或者，这是一个自己动手的解决方案。如果是 RYO，什么工具最好？我们是 .Net 商店，但我更喜欢 python。我不知道任何 .net 并且是 python 的初学者。我的老板建议使用 powershell，但我对此也一无所知。

另一件需要考虑的事情：用户拥有 XP Professional 桌面，但我们将在未来几个月的某个时间迁移到 Windows 7。

有什么建议么？TIA。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T18:47:08.533

您提出不使用现有管理工具的原因之一是非技术用户的困难。需要明确的是，这是一个演示问题，而不是技术问题。这是一个示例，用于确定用户在他们自己的硬盘上拥有哪些文件的所有权。您需要根据您的具体情况接受并修改它。您还需要确定如何以满足用户需求的方式呈现它。

```
ls C:\* -rec | %{if($_.GetAccessControl().Owner -like '*USERNAME*'){'{0} - {1}' -f $_.Name, $_.Getaccesscontrol().owner}} 
```

在这里，它更加脚本化，更少单行（我喜欢编造文字）以及快速而肮脏的显示。它将从您为其提供的任何搜索根递归搜索当前登录用户拥有的文件。

```
$result = @()
$user = '*{0}*' -f $env:USERNAME
$searchRoot = 'G:\'
$files = Get-ChildItem $searchRoot -recurse | Where-Object{$_.GetAccessControl().Owner -like $user}
foreach ($file in $files){
    $temp = New-Object PSCustomObject -Prop @{'Name' = $file.Name;
                                              'Path' = $file.Directory;
                                              'Owner' = $file.GetAccessControl().Owner
    }
    $result += $temp
}
$result | Out-GridView 
```

# google-analytics - 什么是 return _gaLink(this,'#);

> ID：13728684
> 
> 赞同：1
> 
> 时间：2012-12-05T17:14:11.580
> 
> 标签：google-analytics

跟踪链接时，我需要将此代码放在最后吗？

```
return _gaLink(this,'#'); 
```

它究竟是做什么的？我对此的理解不是很清楚。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T17:19:37.557

您是否正在寻找跟踪传出/外部链接？没有名为 的 Google Analytics 函数`_gaLink`。您可以发布您的代码片段吗？

`_link()`用于 X-Domain 跟踪，请参阅[文档](https://developers.google.com/analytics/devguides/collection/gajs/methods/gaJSApiDomainDirectory#_gat.GA_Tracker_._link)

如果您只是想跟踪“出站链接”，即到其他站点的链接，那么使用这段代码（这不需要 jQuery）：

```
///////////////////
// _trackOutbound
jQuery(document).ready(function($) {
    $('a[href^="http"]:not([href*="//' + location.host + '"])').live('click', function(e) {
        _gaq.push(['_trackEvent', 'outbound', 'click', this.href.match(/\/\/([^\/]+)/)[1]]);        
        _gaq.push(['t2._trackEvent', 'outbound', 'click', this.href.match(/\/\/([^\/]+)/)[1]]);
    });
}); 
```

# c++ - 向量数组 C++ - 添加元素时的奇怪行为

> ID：13728685
> 
> 赞同：7
> 
> 时间：2012-12-05T17:14:14.107
> 
> 标签：c++, arrays, vector

对于 google 和 stackoverflow 搜索无法帮助我，我别无选择，只能向你们寻求帮助。

我想使用一个向量数组——我知道这个数组只需要包含两个向量。因此

```
vector<double> testVect[1]; 
```

现在，当我想将一个元素添加到我使用的数组中包含的第一个向量时

```
testVect[0].push_back(0); 
```

到目前为止，一切似乎都还好——不幸的是，向第一个向量添加一个元素也会以某种方式也将相同的元素（在本例中为 0）添加到第二个向量。

谁能告诉我这种行为的原因？（请）-也许是一种解决方法。目前我必须使用 Visual Studio 6（雇主不会安装新的编译器 - 我已经激怒了我的同事：D

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-05T17:17:09.297

如果你想要两个向量，你应该声明：

```
 vector<double> testVect[2]; 
```

然后在你的代码中使用`testVect[0]`和。`testVect[1]`

你应该在你的编译器上启用所有警告。

顺便说一句，您可以安装最新的 Linux 发行版，以及最新的 GCC 编译器（例如 4.7），然后运行它，因为如果您静态访问越界，`g++ -Wall -g`它肯定会警告您，就像您已经拥有的那样。`testVect`

^(GNU/Linux 和 GCC 都是免费的，所以你的经理会很高兴。)

# c# - 使用递归获取所有子目录

> ID：13728688
> 
> 赞同：0
> 
> 时间：2012-12-05T17:14:21.773
> 
> 标签：c#, asp.net, asp.net-mvc, recursion, asp.net-mvc-4

我正在获取计算机中所有目录和子目录的列表。我正在使用递归。

没关系，直到我执行实际递归

我收到此错误：

```
System.NullReferenceException: Object reference not set to an instance of an object. 
at tgpwebged.Views.Admin.recursiveFileTree.WalkDirectoryTree(DirectoryInfo root) 
in s:\Projects\tgpwebged\tgpwebged\Views\Admin\recursiveFileTree.cs:line 93 
```

**这是课程：**

```
static void WalkDirectoryTree(System.IO.DirectoryInfo root)
    {
        System.IO.DirectoryInfo[] subDirs = null;

        try
        {
            DirectoryInfo[] SubDirs = root.GetDirectories("*.*", SearchOption.TopDirectoryOnly);

            foreach(DirectoryInfo sdir in SubDirs) {
                log.Add(sdir.ToString());
            }

        }
        catch (Exception e)
        {
            log.Add("Exceção: " + e.ToString());
        }

        try
        {
            foreach (System.IO.DirectoryInfo dirInfo in subDirs)
            {
                log.Add(dirInfo.ToString());
                WalkDirectoryTree(dirInfo);
            }
        }
        catch (Exception e)
        {
            log.Add("Exceção: " + e.ToString());
            log.Add("");
        }
     } 
```

如您所见，最后一个 for each 获取目录中的子目录列表并再次调用该函数执行递归。

此类从逻辑驱动程序接收所有顶级目录并深入到最后一个目录结构。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T17:21:35.913

看起来您有两个不同的变量，它们在不同的情况下被命名为相同的事物：

```
System.IO.DirectoryInfo[] subDirs = null;
DirectoryInfo[] SubDirs = root.GetDirectories("*.*", SearchOption.TopDirectoryOnly); 
```

您正在尝试迭代，`subDirs`但您从未在任何地方实际设置它。

```
// subDirs is always null because you never set it to anything other than null
// in the variable declaration
foreach (System.IO.DirectoryInfo dirInfo in subDirs)
{
    log.Add(dirInfo.ToString());
    WalkDirectoryTree(dirInfo);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-05T17:21:49.570

你不关心`System.IO.DirectoryInfo[] subDirs = null;`

但是你用`DirectoryInfo[] SubDirs`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-05T17:21:59.813

C# 区分大小写，

`SubDirs`不是`subdirs`

您声明两者，同时使用两者，但仅实例化一个。

* * *

您的消毒**功能**（不是类）应该是，

```
static void WalkDirectoryTree(System.IO.DirectoryInfo root)
{
    foreach(var subDirectory in root.GetDirectories(
        "*.*", 
        SearchOption.AllDirectories))
    {
        log.Add(subDirectory.ToString());
    }
} 
```

`log`但是，传递给函数是有意义的。

# vb.net - VB.net 中的线程

> ID：13728690
> 
> 赞同：0
> 
> 时间：2012-12-05T17:14:30.233
> 
> 标签：vb.net, multithreading

我对 vb.net 线程有一个非常基本的疑问。我有一个函数 MyFunc1() 它实际上启动一个表单并要求用户输入并返回一个字符串。只有当用户单击表单中名为“return”的按钮时，才必须完成返回。

所以我这样设计了这个功能。

```
Public done as Boolean = true
Public str as String

Function MyFunc1() As String
  Start Thread1  //launch UI as seperate thread
  While done
  End While    //Infinite loop to hold the parent loop till done is made as false
  return str
End Function

Function Thread1
  //code to launch UI
End Function

Function onClickReturn  //Function triggered when 'return' is pressed
  str = EditText.text
  done = false
End Function 
```

现在的问题是 Thread1 启动 UI，但是一旦启动 UI，Thread1 就会死掉，UI 面板也会死掉。

有什么办法可以解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T17:27:05.583

我认为您尝试做的事情不需要线程。由于您无论如何都阻塞了原始线程，因此实际上不需要创建第二个线程。通常你只需打电话

```
MyForm.ShowDialog() 
```

这将显示一个模态对话框，并将阻止该行的调用代码，从而允许显示和使用 UI，直到用户将其关闭。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T19:38:13.303

如果你有一个 .Net 线程对象，你可以通过调用[Thread.Join](http://msdn.microsoft.com/en-us/library/95hbf2ta.aspx)来阻止。

# cakephp - cakephp saveall 正在保存多个查询

> ID：13728691
> 
> 赞同：0
> 
> 时间：2012-12-05T17:14:31.230
> 
> 标签：cakephp, cakephp-2.0

我有一个使用 cakephp 中的 saveall 保存到数据库中的数组。最近我注意到该数组有大约 100 个值集，并且运行了 100 个插入查询来保存它。这是作为一个事务完成的，然后再提交它。每个查询大约需要 1 毫秒。所以 100 个查询加起来会花费很多时间。我确信有一些方法可以在一个查询中执行此操作。

我试过了

```
$this->User->savemany($data) 
```

但没有变化。

有没有其他方法可以让我保存这样的东西

```
INSERT INTO users (ID, Value) 
```

值（1，“第一”），（2，“第二”），（3，“第三”）；

谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T18:10:34.587

不，如果不使用自定义 SQL 或扩展 AppModel 以使其具有`INSERT`在某些情况下运行优化语句的方法，就无法实现此目的。**

请记住，您不会总是单独保存模型的数据。有时您正在保存相关对象。

例如：`Person hasMany Car`。当您保存多个`Person`s 时，每个都具有任意数量的`Car`(s)，CakePHP 需要取回每个保存的 Person 记录的 ID，然后才能关联数据库中的 Car 记录。

就像我说的那样，您可以扩展 AppModel 并增加 saveAll 方法以检查正在保存的数据的结构，并将其连接到您编写的自定义方法中以执行您想要的操作，但它可能会添加更多saveAll 方法的开销超过了它的价值。

** 您可以在没有大量自定义编码的情况下进行的最佳优化是用事务包装 saveAll，这样您就不必为每个事务初始化和提交。例子：

```
$this->Model->begin();
$this->Model->saveAll(data);
$this->Model->commit(); 
```

# functional-programming - 预计算中间结果的部分应用

> ID：13728692
> 
> 赞同：3
> 
> 时间：2012-12-05T17:14:32.857
> 
> 标签：functional-programming, ocaml

对于下面的二次公式，我有多个`a`but`fixed` `b`和`c`。

![在此处输入图像描述](../Images/d19d61aa66cb5e7c19d5a6cc2d09fc9b.png)

我希望编写一个`partial application`高效执行的函数，即我的函数不会重新计算固定值（因为`b`and `c`）。

* * *

这是我的解决方案

`let r b c = let z = b *. b in fun a -> (-.b +. sqrt (z-.4.0*.a*.c))/.(a*.2.0);;`

我想这个解决方案可以工作，但我不确定它是否足够有效。我只是做`b^2`了修复，因为我看到其他部分都带有`a`.

**谁能给我一个更好的解决方案？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T17:30:04.987

是的，这是处理手头情况的正确方法。[替代形式](http://mathworld.wolfram.com/QuadraticFormula.html)没有多大帮助（只要它获得您需要的准确性）。你可能也想搬出`4*c`去，

```
let r b c = let z = b *. b and c4 = 4.0 *. c in
            fun a -> (-.b +. sqrt (z-.a*.c4))/.(a*.2.0);; 
```

# python - 工具栏和 BoxLayout 叠加

> ID：13728693
> 
> 赞同：0
> 
> 时间：2012-12-05T17:14:33.873
> 
> 标签：python, qt

这是我的代码：

```
import sys
from PyQt4 import QtGui, QtCore 

def prova():
    print "test event"

class MainWindow(QtGui.QMainWindow):
    def __init__(self):
        QtGui.QMainWindow.__init__(self)                                              

    self.resize(350, 250) # ridimensiona la finestra
        self.setWindowTitle('MainWindow')

    pause = QtGui.QAction(QtGui.QIcon("icons/pause.gif"),"Pause",self)
    pause.setStatusTip("Pause!!")
    pause.triggered.connect(prova);

    play = QtGui.QAction(QtGui.QIcon("icons/play.png"),"Play",self)
        play.setStatusTip("Start!")     

    toolbar = self.addToolBar('My toolbar')
    toolbar.addAction(pause)
    toolbar.addAction(play)
    toolbar.setToolButtonStyle(QtCore.Qt.ToolButtonTextUnderIcon)

    widget = QtGui.QWidget(self)
    hbox = QtGui.QHBoxLayout(widget)

    label = QtGui.QLabel()
    label.setText("test label") 
    hbox.addWidget(label)
    hbox.setAlignment(label,QtCore.Qt.Alignment(QtCore.Qt.AlignRight))

app = QtGui.QApplication(sys.argv)
main = MainWindow()
main.show()
sys.exit(app.exec_()) 
```

我的问题是水平框 hbox 和里面的小部件都覆盖在工具栏上。如何修复覆盖，将 hbox 放在工具栏下方？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T17:22:23.720

问题是您`widget`直接添加为子项，`main`而不是将其设置为中央小部件。所以而不是：

```
widget = QtGui.QWidget(self) 
```

利用：

```
widget = QtGui.QWidget()
self.setCentralWidget(widget) 
```

# .net - 字符串参数和流返回的 WCF 问题

> ID：13728696
> 
> 赞同：0
> 
> 时间：2012-12-05T17:14:37.050
> 
> 标签：.net, vb.net, wcf, .net-4.0

我正在开发一个 WCF 项目，该项目生成并返回一个作为 System.IO.Stream 的 pdf 文件。我遇到了一种我无法解释的行为。

WCF 公开的方法之一如下：

```
Public Function Print(ByVal input As Integer) As Stream
    'Do stuff here.
    Return pdfStream
End Function 
```

客户端调用该方法：

```
Dim streamReturn as Stream
streamReturn = Service.Print(input) 
```

这很好用。当我尝试将输入的数据类型更改为 String 时出现了问题。

```
Public Function Print(ByVal input As String) As Stream
    'Do stuff here.
    Return pdfStream
End Function 
```

当我在客户端更新服务参考时，现在列出了一个错误：

```
streamReturn = Service.Print(input) 
```

“‘一维字节数组’类型的值无法转换为‘System.IO.Stream’。”

似乎当我的输入的数据类型更改为字符串时，传输模式从流式返回到缓冲。任何想法为什么？

编辑：WCF 在 .Net 4.0 中，客户端是 .Net 3.5

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T15:49:15.413

我找到了解决方案。这是由于我使用的序列化方法。我已将 XMLSerializerFormat() 添加到我的 ServiceContract 中，因此我可以在我的一个自定义对象中使用索引列表。对象是：

```
<DataContract()>
Class MyClass
    <DataMember()>
    Property MyList() As List(Of Object)
    <DataMember()>
    Property MyList(i As Integer) As Object
End Class 
```

一旦我删除了 XMLSerializerFormat() 标记（恢复为 DataContractFormat），我必须从索引属性中删除 DataMember() 标记，然后才能有一个 String 参数和 Stream 返回。

```
<DataContract()>
Class MyClass
    <DataMember()>
    Property MyList() As List(Of Object)
    '<DataMember()>
    Property MyList(i As Integer) As Object
End Class 
```

# java - 过滤现有的 SeleniumElement

> ID：13728698
> 
> 赞同：0
> 
> 时间：2012-12-05T17:14:38.740
> 
> 标签：java, selenium

我有一个 SeleniumElement 代表页面上的几个元素，我想过滤它以仅包含`":visible"`元素。

我也许可以将原始构造函数改进为仅包含一个元素，但我在问我是否可以做一些不同的事情：给定一个特定元素，创建一个新元素来过滤该元素的选择器。

像这样的东西：

```
public static SeleniumElement visible(SeleniumElement element) {
    // Locator.filter() doesn't really exist, the next line won't compile
    By locator = element.getElementLocator().filter(":visible"); 
    return new SeleniumElement(element.getName(), locator, element.getPage());
}

visible(myButton).click();

// Calling myButton.click() fails because there are multiple elements that match
// the selector. However, only one of them is visible right now 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T11:26:41.230

如果您想通过元素的可见性过滤元素，那么使用 CSS 选择器将是一个不错的选择。

我添加了 CSS 属性 Display 和 Visibility。因此，您可以使用可以找到目标元素的任何一个属性/属性。（C#代码）

```
IWebElement Query = driver.FindElement(By.XPath("Element Xpath")).FindElement(By.CssSelector("[@style='display: block;Visibility: hidden']")); 
```

我希望这有帮助。祝一切顺利 ：-）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T17:59:38.340

或者您可以根据元素是否可见执行单击。

```
 if (element.Visible)
    {
        element.click();
    } 
```

# vba - VBA Excel 2003 保护单元格点击

> ID：13728700
> 
> 赞同：1
> 
> 时间：2012-12-05T17:14:53.853
> 
> 标签：vba, excel-2003

我有一个电子表格，上面有一列（比如 A 列）。这个想法是这个列由具有各种分数的用户填充。一旦用户对他们在 A 列中的答案感到满意，我希望他们确认答案是正确的（最好通过单击按钮）。单击该按钮后，我想使用 VBA 来保护 A 列不被再次编辑。我宁愿不使用保护工作表选项，因为电子表格中有其他数据，我需要将一些单元格锁定但可编辑（它们使用数据验证列表）。

我确实找到了这一点 VBA，但这是基于工作表更改 - 如果我能以某种方式使用它，但只有在用户确认数据已设置后才激活它，那将是理想的：

```
Private Sub Worksheet_Change(ByVal Target As Excel.Range)    
    If Intersect(Target, Range("A2:A14")) Is Nothing Then Exit Sub
    Application.EnableEvents = False
    MsgBox "Hey, leave me alone!", 48, "Sorry, I'm protected."
    Application.Undo
    Application.EnableEvents = True
End Sub 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T17:36:22.873

如果您发布的内容适合您的需求，那么：

在一个模块中，像这样：

```
Public active As Boolean
Sub Button1_Click()
   active = True
End Sub 
```

在您的电子表格代码中：

```
Private Sub Worksheet_Change(ByVal Target As Excel.Range)
    If active Then
        If Intersect(Target, Range("A2:A14")) Is Nothing Then Exit Sub
        Application.EnableEvents = False
        MsgBox "Hey, leave me alone!", 48, "Sorry, I'm protected."
        Application.Undo
        Application.EnableEvents = True
    End If
End Sub 
```

一个可能更好的解决方案是在工作表中指定一个按钮填充的单元格，因此代码实际上类似于：

```
If Range("A1") = "Locked" then
    .... 
```

# python - 使用 ~ 反转一个 numpy 布尔数组

> ID：13728708
> 
> 赞同：78
> 
> 时间：2012-12-05T17:15:01.887
> 
> 标签：python, arrays, numpy, boolean-operations, negation

我可以`~A`用来反转一个 numpy 布尔数组，而不是相当笨拙的函数`np.logical_and()`吗`np.invert()`？

确实，`~`似乎工作正常，但我在任何 nympy 参考手册中都找不到它，而且 - 更令人担忧的是 - 它当然不适*用于*标量（例如`bool(~True)`返回`True`！），所以我有点担心......

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2014-03-06T12:47:48.197

简短的回答：是的

参考：

[http://docs.scipy.org/doc/numpy/reference/generated/numpy.invert.html](http://docs.scipy.org/doc/numpy/reference/generated/numpy.invert.html)

注意：

> 计算输入数组中整数的底层二进制表示的按位 NOT。这个 ufunc 实现了 C/Python 运算符 ~。

和

> bitwise_not 是反转的别名：

```
>> np.bitwise_not is np.invert
>> True 
```

# character-encoding - MS Crypto API 不加密/解密日文字符

> ID：13728714
> 
> 赞同：1
> 
> 时间：2012-12-05T17:15:24.773
> 
> 标签：character-encoding, vb6, cryptography

我们有一个 VB6 程序，可以加密一组字符在西方 Win OS 计算机上，加密的字符串被解密回来 ok。但在日本电脑上，它不起作用，并被解码为一堆????。输入和输出（解码）文本框都设置为带有日文脚本的 MS UI Gothic。下面给出部分代码。还给出了样本输入。

输入输出：

```
inputStr = 機帰帰
outputStr= 0Y365H
finalStr=  ??? 
```

部分代码：

```
Private Const IC_CONST_INST_KEY_ENCRYPT_STR = "41S81U4AYYPGZDNXKWMPGK0PMDS"
Private Sub cmdEncrypt_Click()
Dim inputStr As String
Dim outputStr As String
Dim finalStr As String
Dim sUnicodeValue, sAsciiValue

    inputStr = txtUInit.Text

    outputStr = EncryptString(inputStr, IC_CONST_INST_KEY_ENCRYPT_STR)
    txtUEncrypt.Text = outputStr

    finalStr = DecryptString(outputStr, IC_CONST_INST_KEY_ENCRYPT_STR)
    txtUDecrypt.Text = finalStr

End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-10T15:45:41.533

VB6 无法正确处理 unicode 日文字符，您需要在运行加密程序之前将 unicode 转换为 ASCII。

# eclipse - 删除 .eclipse 文件夹

> ID：13728715
> 
> 赞同：0
> 
> 时间：2012-12-05T17:15:26.703
> 
> 标签：eclipse, adt, eclipse-adt

我删除了 users/xxxx/.eclipse 下的 .eclipse 文件夹，现在我的模拟器无法加载，也无法在 eclipse 下更新 ADT。有没有办法重建它？为什么会导致模拟器挂起（启动动画）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T21:49:07.853

我建议重新安装eclipse。这将使您的项目保持完整，但您可能需要重新安装一些插件。

我将假设您使用的是基于 .eclipse 文件夹的 linux/unix 操作系统。使用以下内容清除旧安装。

`sudo apt-get remove --purge eclipse`

[然后从http://www.eclipse.org/downloads/](http://www.eclipse.org/downloads/)获取最新版本的 eclipse 。使用类似的命令提取

```
tar -zxvf eclipse-SDK-4.2-linux-gtk.tar.gz 
```

注意：在执行下一步之前，/usr/lib 下应该有一个 eclipse 文件夹已经备份和/或删除该文件夹。

如果使用 linux 将生成的 eclipse 文件夹移动到 /usr/lib。

然后，您应该能够通过`eclipse`在终端中输入来运行新版本的 eclipse。

# android - Android：onLongClick 和 onTouch 的不同拖放操作

> ID：13728717
> 
> 赞同：3
> 
> 时间：2012-12-05T17:15:31.630
> 
> 标签：android, drag-and-drop, ontouchlistener, onlongclicklistener, motionevent

我想用一个按钮实现两种不同的拖放交互。如果用户长按按钮，他可以移动按钮。这没问题，我实现了`OnLongClickListener`：

```
@Override
public boolean onLongClick(View v) {
    ClipData dragData = ClipData.newPlainText(
            AbstractFragment.BUTTON_ID_TAG, "" + v.getId());
    DragShadowBuilder shadow = new DragShadowBuilder(v);
    v.startDrag(dragData, shadow, null, 0);
    return true;
} 
```

如果用户触摸按钮并立即拖动，他可以从这个按钮画一条线到另一个按钮。我想我必须实现`OnTouchListener`接口，但我不确定识别此用户交互的条件。我需要哪个`MotionEvent`或更确切地说是哪个组合来识别这个输入。`MotionEvent`

我希望你能给我一些提示！

格茨瓦茨

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-10T14:23:51.927

这是我的解决方案：

```
@Override
public boolean onTouch(View v, MotionEvent event) {
    if (event.getAction() == MotionEvent.ACTION_MOVE) {
        Toast.makeText(getActivity(), "onClick", Toast.LENGTH_LONG).show();
        ClipData dragData = ClipData.newPlainText(
                AbstractFragment.BUTTON_ID_TAG, "" + v.getId());
        DragShadowBuilder shadow = new CanvasDragShadow(v);
        v.startDrag(dragData, shadow, null, 0);
        return true;
    }
    return false;
} 
```

我添加了这个方法，它有效。也许有必要检查`MotionEvent`s 的历史以获得更好的用户体验。

# uiview - Secure TextField 在 ios 6 中自动擦除数据

> ID：13728718
> 
> 赞同：2
> 
> 时间：2012-12-05T17:15:39.720
> 
> 标签：uiview, uiviewcontroller, ios6, uitextfield

每个人，我在 ios 6 中都遇到了安全 textField 的问题。当我点击键盘上的完成按钮时，它会自动删除内容。我检查了安全文本字段的值。中`textFieldShouldReturn`，`secureTextField.text`是正确的。但是在 中`textFieldDidEndEditing`，`secureTextField.text`变为 nil。

相同的 secureTextField 在 ios 5.1 上完美运行。如果我将secureTextField设置为普通的textField（不安全），那么一切顺利。也就是说，notSecuredTextField.text 无论是 in`textFieldShouldReturn`还是 in都是正确的`textFieldDidEndEditing`。

任何的想法？

这是代码：

> *   (BOOL)textFieldShouldReturn:(UITextField *)theTextField{
>     
>     
>     
>     ```
>     if (theTextField == self.textFieldPassword){
>         if ([self.textFieldUserName.text length] != 0){
>             [self loginMe];
>             NSLog(@"should return %@", self.textFieldPassword.text);//The value is correct
>             [self.textFieldPassword resignFirstResponder];
>         }
>     }
>     return YES; 
>     ```
>     
>     
>     
>     }

```
- (void)textFieldDidEndEditing:(UITextField *)textField
{
    NSLog(@"Did End Editing %@", self.textFieldPassword.text);
    if(textField == _textFieldPassword){
        NSLog(@"in text field did end editing %@", self.textFieldPassword.text); // The value is null
    }    
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T09:46:30.113

似乎调用`resignFirstResponder`会导致不希望的行为。所以在调用该方法之前复制数据可以解决这个问题。当然，这并不能真正解决问题，它只是隐藏问题的一种解决方案。

我为 iOS 6 创建了一个新项目，但问题没有出现。

# objective-c - OHAttributedLabel：为 URL 设置链接

> ID：13728728
> 
> 赞同：1
> 
> 时间：2012-12-05T17:15:55.407
> 
> 标签：objective-c, ios

我需要在 OHAttributedLabel 上显示如下链接：sitename.com/abc.html。我想为这个网址设置链接，例如：userlink:sitename.com/abc.html

然后我单击标签上的链接，在 UIWebView 委托上返回两次单击操作，一个带有 URL，另一个没有 URL....

我只需要一键操作

我该怎么办？

更新：

```
////seeingUrlString = @"sitename.com/abc.html";
[_tmpContentAttributeString setLink:[NSURL URLWithString:seeingUrlString] range:hyperLinkRange];

    self.contentLabel.attributedText = _tmpContentAttributeString;

-(BOOL)attributedLabel:(OHAttributedLabel *)attributedLabel shouldFollowLink:(NSTextCheckingResult *)linkInfo
{

    CustomWebView *_customWebViewa = [[CustomWebView alloc] init];
    _customWebViewa.webView.scrollView.scrollEnabled = NO;
    _customWebViewa.webView.scrollView.bounces = NO;
    _customWebViewa.webView.frame = self.view.bounds;

    NSString *_url = [linkInfo.URL absoluteString];
    if (![_url hasPrefix:HTTPPrefix]) {
        _url = [HTTPPrefix stringByAppendingString:_url];
    }
    _url = [NSString stringWithFormat:@"%@%@%@", _url, Slash, NoFollow];
    [self loadWebView:_customWebViewa.webView url:_url];
     return NO;
} 
```

两个单击操作，一个来自 OHAttributedLabel 委托，另一个我不知道它来自哪里...

**更新2：**

实际上我只需要在 OHAttributedLabel 上显示一个链接（如：sitename.com/abc.html），但不要使用此链接，我希望用户可以看到这是可点击的链接，如果他们点击链接，OHAttributedLabel 代表实际上会触发建立一个自定义链接 url，自定义链接 url 是这样的：

用户链接：sitename.com/abc.html

我希望 OAHAtrributedLabel 将显示网址视为普通字符串

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T17:19:05.230

在`OAHAtrributedLabel`return的委托方法中`NO`。

```
-(BOOL)attributedLabel:(OHAttributedLabel*)attributedLabel shouldFollowLink:(NSTextCheckingResult*)linkInfo{
    <Do your work here>
    return NO;
} 
```

**编辑** 我无法运行您的代码。所以我发布了我使用过的代码。

```
//forgotPasswordlabel is my OHAttributedLabel

self.forgotPasswordlabel.text = [[NSString localizedStringForKey:@"forgot_password"] uppercaseString];
self.forgotPasswordlabel.delegate = self;
    NSRegularExpression* userRegex = [NSRegularExpression regularExpressionWithPattern:[[NSString localizedStringForKey:@"forgot_password"] uppercaseString] options:0 error:nil];
    [userRegex enumerateMatchesInString:self.forgotPasswordlabel.text options:0 range:NSMakeRange(0,self.forgotPasswordlabel.text.length)
                             usingBlock:^(NSTextCheckingResult *match, NSMatchingFlags flags, BOOL *stop)
     {
         // FORGOT_PASSWORD_URL is mu URL which I'm opening in my WebView
         [self.forgotPasswordlabel addCustomLink:[NSURL URLWithString:FORGOT_PASSWORD_URL] inRange:match.range]; // add it
     }]; 
```

在委托方法中

```
-(BOOL)attributedLabel:(OHAttributedLabel*)attributedLabel shouldFollowLink:(NSTextCheckingResult*)linkInfo{
    [self forgetPassword:nil]; // here I handle password reset action
    return NO;
} 
```

熙是看看我的标签的外观![在此处输入图像描述](../Images/012dfb844b3411993bcc72d87166a1a3.png)

希望能帮助到你...

# java - 是否有任何理由在 java 中使用 null == 值条件？

> ID：13728739
> 
> 赞同：2
> 
> 时间：2012-12-05T17:16:32.240
> 
> 标签：java

我在某人的代码中看到了很多：空检查条件是这样写的：

```
if (null == value) 
```

而不是

```
if (value == null) 
```

我认为没有任何理由`null`在 Java 中使用运算符。这样做有什么好处吗？这仅仅是一个 C++ 程序员错误地将他的技能应用于 Java 的案例，还是我错过了一些重要的东西？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-05T17:19:20.927

这是所谓的[“尤达条件”（项目#1）](http://www.codinghorror.com/blog/2012/07/new-programming-jargon.html)的一个案例。尽管可以在 C/C++ 中合理化它们，但没有理由在 Java 中使用它们。

在 C/C++ 中，任何类型的表达式都可以进入`if`s 和`while`s。写作

```
if (var = NULL) // No compile-time error in C/C++ 
```

代替

```
if (var == NULL) 
```

是新手常见的错误。Yoda 条件被认为是解决这个问题的一种补救措施，但代价是“Yodifying”你的代码：C/C++ 将捕获分配给`NULL`

```
if (NULL = var) // Compile-time error 
```

但是“反向”`NULL`检查是可以的：

```
if (NULL == var) 
```

`if`由于 Java 将、`while`和的控制块内的非布尔表达式`for`视为错误，因此它将`var = null`代替捕获`var == null`，从而触发错误。因此，没有理由通过“Yodifying”你的表达来放弃可读性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-05T17:20:16.247

假设您只想打印长度超过 20 的字符串的内容。您将执行以下操作：

```
if (str != null && str.length() > 20) {
    System.out.println(str);
} 
```

如果实际上是，则忽略它`str != null &&`会引发 NPE 。`str``null`

如果您指的是差异

```
if (str == null) { ... } 
```

和

```
if (null == str) { ... } 
```

空无一人。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-05T17:21:42.427

答案是不！在java中没有
任何需要更喜欢的绝对！`if (null == value)``if (value == null)`

, 的检查`if (null == value)`有点奇怪，至少在 java 中，来自 C 和 C++ 中的代码指南，这是有道理的。

我更喜欢`if (value == null)`可读性更好的。

原因是为了避免 C/C++ 错误`if (value = null)`而不是正确`if (value == null)`

如果使用`if (null = value)`C/C++ 编译器会抛出错误。

然而在java中，甚至`if (value = null)`会是一个语法错误。
所以不要`(null == value)`在java中 使用它

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-05T17:25:03.543

有时它可能会更好读

```
if( null == someFunction(someParameter, anotherParameter) ) 
```

对比

```
if( someFunction(someParameter, anotherParameter) == null ) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-05T17:19:45.773

它通常是开发人员母语的产物。有些语言的规则`null == value`比`value == null`. 在语法上，它们与 Java 相同。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-05T17:19:52.423

*不*检查可能意味着空指针异常。

将它按此顺序放置有助于您不会混淆 =（赋值）和 ==（相等）。

两个都

```
if (a = null) 
```

和

```
if (a == null) 
```

将编译；但是，您可能想要第二个而不是第一个。

如果你翻转它们，

```
if (null = a) 
```

不会编译，而

```
if (null == a) 
```

将编译。

因此，您可以在编译器时捕获一个小而难以发现的错误。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-05T17:20:31.810

只是为了确保您没有为例如您分配一个值，例如`value = null`如果您省略 ==，则此代码将编译得很好，并且只能在运行时识别它，但如果您这样尝试，`null = value`这甚至不会编译。

# php - PHP & MySQL 更新查询只更新表中的最后一条记录

> ID：13728744
> 
> 赞同：2
> 
> 时间：2012-12-05T17:16:46.647
> 
> 标签：php, mysql, database, sql-update

我有一个 HTML 表单，用于通过 post 脚本更新 MySQL 表 - 但是，我遇到了一个问题，即每行上的更新按钮只适用于表中的最后一行。

```
<?php

$link = mysql_connect ('localhost', 'root', 'password');
mysql_select_db ('cardatabase');

$select = 'SELECT * from cars';
$result = mysql_query($select, $link);

if(isset($_POST['update'])){
    $updatequery = "UPDATE cars SET 
        ID='$_POST[id]',
        CARMAKE='$_POST[carmake]',
        CARMODEL='$_POST[carmodel]',
        FUELTYPE='$_POST[fueltype]',
        TRANSMISSION='$_POST[transmission]',
        DOORS='$_POST[doors]',
        AMOUNT='$_POST[amount]',
        AVAILABLE='$_POST[available]'
        WHERE ID='$_POST[hidden]'";

    mysql_query($updatequery, $link);
};

echo '<table><form action=update.php method=post>';
echo '<tr><td>ID</td><td>Make</td><td>Model</td><td>Fuel Type</td><td>Transmission</td><td>Engine Size</td><td>Doors</td><td>Amount</td><td>Available</td></tr>';

while($row = mysql_fetch_array($result)) {
    echo '<tr>';
    echo "<td><input type='text' name='id' value='{$row['ID']}'</td>";
    echo "<td><input type='text' name='carmake' value='{$row['CARMAKE']}'</td>";
    echo "<td><input type='text' name='carmodel' value='{$row['CARMODEL']}'</td>";
    echo "<td><input type='text' name='fueltype' value='{$row['FUELTYPE']}'</td>";
    echo "<td><input type='text' name='transmission' value='{$row['TRANSMISSION']}'</td>";
    echo "<td><input type='text' name='enginesize' value='{$row['ENGINESIZE']}'</td>";
    echo "<td><input type='text' name='doors' value='{$row['DOORS']}'</td>";
    echo "<td><input type='text' name='amount' value='{$row['AMOUNT']}'</td>";
    echo "<td><input type='text' name='available' value='{$row['AVAILABLE']}'</td>";
    echo "<td><input type='hidden' name='hidden' value='{$row['ID']}'</td>";
    echo '<td><input type="submit" name="update" value="Update"</td>';
    echo '</tr>';
}

echo '</form></table>';
mysql_close ($link); 
```

`cars`桌子：

![MySQL 表](../Images/f70787f16a566ca76c81ef95e2423ccc.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-05T17:20:50.593

让我们从可见性开始：

> 对于看到您的问题的未来用户。如果您知道这一点，那就太好了！欢迎来到堆栈溢出！[**请不要`mysql_*`在新代码中使用函数**](https://stackoverflow.com/q/12859942/)。它们不再被维护，并且已经开始[弃用过程。](http://news.php.net/php.internals/53799)看到[**红框**](https://www.php.net/manual/en/function.mysql-connect.php)了吗？改为了解[*准备好的语句*](https://en.wikipedia.org/wiki/Prepared_statement)，并使用[PDO](http://php.net/pdo)或[MySQLi](http://php.net/mysqli) -[本文](https://php.net/manual/en/mysqlinfo.api.choosing.php)将帮助您决定使用哪个。如果您选择 PDO，[这里有一个很好的教程](http://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers)。

* * *

您遇到的问题是由于为您的所有输入提供相同的名称（`id`等`carmake`）引起的。这意味着只会提交最后一行。

给他们起这样的名字：

```
name="id[]" 
```

这将使 PHP 将`$_POST`值视为数组，您可以访问

```
$_POST["id"][3] 
```

以获取第四行（从 0 开始）为例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-05T17:55:30.630

@MadaraUchiha 已经证明了您的更新问题的解决方案，但我想为您格式化代码的方式提出一种替代方案。

php 的功能之一是能够将其与 html 混合。我已经重新格式化了你的一段代码。正如你所看到的，我已经摆脱了你的大部分回声。以这种方式格式化代码的好处是您不必担心在字符串中正确嵌套引号，并且如果您使用带有语法突出显示的代码编辑器，则不会丢失 html 上的突出显示。

```
<table cellspacing="3" border="1" style="font-size:13px;background-color:white;">
    <form action="update.php" method="post">
        <tr style="background-color:#38C0CC;">
            <td>ID</td>
            <td>Make</td>
            <td>Model</td>
            <td>Fuel Type</td>
            <td>Transmission</td>
            <td>Engine Size</td>
            <td>Doors</td>
            <td>Amount</td>
            <td>Available</td>
        </tr>

        <?php while ( $row = mysql_fetch_array( $result ) ) { ?>
        <tr>
            <td><input type="text" name="id" value="<?php echo $row['ID']; ?>"/></td>
            <td><input type="text" name="carmake" value="<?php echo $row['CARMAKE]'; ?>"/></td>
            <td><input type="text" name="carmodel" value="<?php echo $row['CARMODEL']; ?>"/></td>
            <td><input type="text" name="fueltype" value="<?php echo $row['FUELTYPE']; ?>"/></td>
            <td><input type="text" name="transmission" value="<?php echo $row['TRANSMISSION']; ?>"/></td>
            <td><input type="text" name="enginesize" value="<?php echo $row['ENGINESIZE']; ?>"/></td>
            <td><input type="text" name="doors" value="<?php echo $row['DOORS']; ?>"/></td>
            <td><input type="text" name="amount" value="<?php echo $row['AMOUNT']; ?>"/></td>
            <td><input type="text" name="available" value="<?php echo $row['AVAILABLE']; ?>"/></td>
            <td><input type="hidden" name="hidden" value="<?php echo $row['ID']; ?>"/></td>
            <td><input type="submit" name="update" value="Update" /></td>
        </tr>
        <?php } ?>

    </form>
</table>
<?php mysql_close ($link); ?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-05T17:23:43.983

这是因为您正在覆盖`$_POST[carmake]`,`$_POST[carmodel]`等，因为它们都具有相同的表单名称。

您可以通过附加`[]`到表单名称的末尾来解决此问题，然后使它们成为一个数组。

然后，您可以通过以下方式访问它们：

```
 $_POST[carmake][n] 
```

# iphone - 如何将我的应用程序集成到更大的应用程序 - iOS

> ID：13728745
> 
> 赞同：1
> 
> 时间：2012-12-05T17:16:48.810
> 
> 标签：iphone, ios, shared-libraries

我们开发了一个具有多个屏幕和资源（图像）的应用程序。我们希望将此应用程序作为组件分发，以集成到我们客户的应用程序中，特别是大型客户端应用程序的一个模块将是我们的应用程序。有什么方法可以将它作为二进制/库分发而不共享整个源代码？我见过的静态库示例大多只包含代码（单屏），而不是资源文件和多屏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T17:28:20.013

将其打包为框架。该框架将包含已编译的代码、头文件和任何资源（图像等）。不需要源代码。

# ruby-on-rails - Globalize3--保存翻译到数据库

> ID：13728748
> 
> 赞同：3
> 
> 时间：2012-12-05T17:17:04.760
> 
> 标签：ruby-on-rails, globalize3

大家好，我是新手，很想在将语言环境翻译保存到数据库方面获得一些帮助。

我有这个表格

```
= form_for @restaurant do |f|
  = f.fields_for :en_info do |restaurant_en|
    %h4 English Information
    = restaurant_en.label :title
    = restaurant_en.text_field :title
    = restaurant_en.label :description
    = restaurant_en.text_area :description
  = f.fields_for :ar_info do |restaurant_ar|
    %h4 Arabic Information
    = restaurant_ar.label :title
    = restaurant_ar.text_field :title
    = restaurant_ar.label :description
    = restaurant_ar.text_area :description
    = f.submit 
```

在添加阿拉伯语表单字段之前，我可以在我的控制器中使用这个 create 方法将模型保存到数据库中

```
 def create
    @restaurant = Restaurant.create params[:restaurant][:en_info]
 end 
```

但是如何将阿拉伯语翻译从表单保存到数据库？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-16T14:09:02.083

尝试使用 globalize3_helpers gem。

```
= form_for @restaurant do |f|

  - f.globalize_fields_for_locale :en do |l|
    = l.input :title
    = l.input :description, as: :text

  - f.globalize_fields_for_locale :ar do |l|
    = l.input :title
    = l.input :description, as: :text 
```

# jqgrid - 如何在 jqGrid 的过滤器栏中添加“过滤器”按钮

> ID：13728754
> 
> 赞同：0
> 
> 时间：2012-12-05T17:17:32.820
> 
> 标签：jqgrid

作为 UI 改进，我想在过滤器工具栏上放置一个按钮，以便用户可以按 Enter 进行过滤或单击该按钮。

这对我来说似乎是一件小事，但我似乎无法弄清楚如何去做。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T17:46:44.690

您可以调用`triggerToolbar`过滤器工具栏的方法。为此，您需要在`click`事件处理程序中执行类似上述代码的内容

```
$("#gridid")[0].triggerToolbar(); 
```

# jquery - jQuery 追加 [object HTMLInputElement]

> ID：13728755
> 
> 赞同：0
> 
> 时间：2012-12-05T17:17:36.930
> 
> 标签：jquery, xml, ajax, servlets

我有这个 AJAX 函数，用于使用 Java servlet 中的用户名检索 XML。我在这里解析用户名并将它们发送到`addToUserList`函数，在那里我附加了 jQuery。但是`[Object HTMLInputElement]`是唯一附加到列表的东西。当我在浏览器控制台上运行 AJAX 函数时，返回的 XML 具有第一个元素，即`[object HTMLInputElement]`，但后面有用户名。

```
function displayFriendList(){
    $.ajax({
        url : '/getFriendList?userid=' +userid,
        type : "POST",
        dataType: 'xml',
        success : function(data) { 
            $(data).find("friend").each(function () {
                addToUserList($(this).find("username").text());
            });
        },
    })
} 
```

这是 addToUserList 函数

```
var userList = new Array();

function addToUserList(friend){

    var exists = false;

    for(var i=1; i<userList.length; i++){
        if(userList[i]==friend){
            exists = true;
            break;
        }
    }

    if(!exists){

        userList.push(friend);
        $('#userList').append("<a>"+friend+"</a></br>"); 
```

以及返回的 xml 的一部分

```
<data>
<friend><username>[object HTMLInputElement]</username></friend>
<friend><username>asa</username></friend>
<friend><username>asda</username></friend>
<friend><username>cece</username></friend> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T17:25:09.037

```
var userList = new Array(); 
```

每次调用函数时都重新初始化用户列表，这似乎不对

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T17:22:19.663

您需要 .each 中的键和值吗？

```
$(data).find("friend").each(function (k,v) {
                addToUserList($(v).find("username").text());
            }); 
```

# matlab - 将功率谱密度命令的结果存储在矩阵中 - matlab

> ID：13728764
> 
> 赞同：1
> 
> 时间：2012-12-05T17:18:16.670
> 
> 标签：matlab, for-loop, matrix, signal-processing

我需要一些关于 for 循环和功率谱密度的 matlab 代码的帮助。

我正在分析一个信号，需要能够测量每 30 秒段的平均功率。我已经用函数“缓冲区”分割了信号，因此矩阵的每一列中有 30 秒的数据，`segment_mat`但我希望能够使用 for 循环将功率谱密度的结果存储在矩阵中以循环数据，并将每个段的平均功率存储在一个向量`avpow`中。有什么想法我可能会出错吗？

```
for j=1:120
    Hs=spectrum.periodogram({'Hamming'});
    Power=psd(Hs,segment_mat(:,j)',fs',fs);
    avpow=mean(Power(j))';
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T17:53:40.457

您的问题是您在`for`循环的每次迭代中都覆盖了结果。

只需修改您的代码：

```
Power(j) = ...
avpow(j) = ... 
```

您将存储计算结果。如果速度是一个问题，请考虑预先分配。

# java - Applet 不会在 JPanel 中运行

> ID：13728771
> 
> 赞同：-1
> 
> 时间：2012-12-05T17:18:54.323
> 
> 标签：java, swing, concurrency, applet, jpanel

我正在尝试在 JFrame 中的 JPanel 中运行 Runnable 类。该程序编译，但它没有按预期工作。屏幕上应该有一个立方体旋转，顶部有一些菜单。我究竟做错了什么？如果我将 T3D 类转换为小程序，那么程序运行得很好，它会重新绘制，它会做所有事情。当我尝试放入 JFrame（作为 Jpanel 或小程序）时，它不会重新绘制，它不会执行 init() 中的内容。谢谢您的帮助！

**绘图演示课**

```
import javax.swing.*;
import java.awt.geom.*;
import java.awt.*;
import java.awt.Graphics;
import java.applet.Applet;

public class DrawingDemo extends JFrame{
public DrawingDemo()
{
T3D demo = new T3D();
getContentPane().add(demo);
setVisible(true);
setSize(1024,720);
setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
setLocationRelativeTo(null);

T3D p = new T3D();
JMenuBar mb = new JMenuBar();
JMenu file = new JMenu("File");
JMenu edit = new JMenu("Edit");
JMenu settings = new JMenu("Settings");
JMenu help = new JMenu("Help");
JMenuItem exit = new JMenuItem(">Exit");
JMenuItem imp = new JMenuItem(">Import");
JMenuItem exp = new JMenuItem(">Export");
JMenuItem sav = new JMenuItem(">Save");
JMenuItem ope = new JMenuItem(">Open");
file.add(ope);  
file.add(sav);
file.add(imp);
file.add(exp);
file.add(exit);
mb.add(file);
mb.add(edit);
mb.add(settings);
mb.add(help);
setJMenuBar(mb);
}

public static void main(String[] args)
{
    new DrawingDemo();
}

} 
```

**3D类**

```
import java.awt.*;
import java.applet.Applet;
import java.awt.Color;
import java.awt.Graphics;
import java.awt.event.*;
import javax.swing.*;

 public class T3D extends JPanel implements Runnable {
 long nextSecond = System.currentTimeMillis() + 1000;
 int framesInLastSecond = 0;
 int framesInCurrentSecond = 0;
 int[][] LP= new int[19][3];
 double pos_camx,pos_camy,pos_camz,rot_camx,rot_camy,xpoint,ypoint,zpoint;
 double rot_radx,rot_rady,nclip,xscr,yscr,kx,ky,e;
 int pxscr,pyscr,nxscr,nyscr;

 public void start1() {
  Thread th = new Thread(this);
  th.start();

 }

 public void keyPressed(KeyEvent e) {
    switch (e.getKeyCode()){
    case KeyEvent.VK_A : 
    {
    pos_camx -= 0.01;
    }
    case KeyEvent.VK_D :
    {
    pos_camx += 0.01;
    }
    case KeyEvent.VK_W :
    {
    pos_camy += 0.01;
    }
    case KeyEvent.VK_S :
    {
    pos_camy -= 0.01;
    }
    } 
 }

 @Override
 public void run(){
  // This will reduce the load the applet has on the runtime
  // system..
  Thread.currentThread().setPriority(1);
  while (true) {
      e+=0.01;
      pos_camx = Math.cos(e);
      pos_camy = Math.sin(e);
      repaint();
     try {
      Thread.sleep(20);
     } catch (InterruptedException ie) {
     }
  }

}

public void init() {

        LP[0][0] = -1;
        LP[0][1] = -1;
        LP[0][2] = -1;

        LP[1][0] = 1;
        LP[1][1] = -1;
        LP[1][2] = -1;

        LP[2][0] = 1;
        LP[2][1] = 1;
        LP[2][2] = -1;

        LP[3][0] = -1;
        LP[3][1] = 1;
        LP[3][2] = -1;

        LP[4][0] = -1;
        LP[4][1] = -1;
        LP[4][2] = -1;

        LP[5][0] = 1;
        LP[5][1] = 1;
        LP[5][2] = -1;

        LP[6][0] = 1;
        LP[6][1] = 1;
        LP[6][2] = 1;

        LP[7][0] = -1;
        LP[7][1] = 1;
        LP[7][2] = 1;

        LP[8][0] = -1;
        LP[8][1] = -1;
        LP[8][2] = 1;

        LP[9][0] = 1;
        LP[9][1] = -1;
        LP[9][2] = 1;

        LP[10][0] = 1;
        LP[10][1] = 1;
        LP[10][2] = 1;

        LP[11][0] = -1;
        LP[11][1] = -1;
        LP[11][2] = 1;

        LP[12][0] = -1;
        LP[12][1] = -1;
        LP[12][2] = -1;

        LP[13][0] = 1;
        LP[13][1] = -1;
        LP[13][2] = 1;

        LP[14][0] = 1;
        LP[14][1] = -1;
        LP[14][2] = -1;

        LP[15][0] = 1;
        LP[15][1] = 1;
        LP[15][2] = 1;

        LP[16][0] = -1;
        LP[16][1] = 1;
        LP[16][2] = -1;

        LP[17][0] = -1;
        LP[17][1] = 1;
        LP[17][2] = 1;

        LP[18][0] = -1;
        LP[18][1] = -1;
        LP[18][2] = -1; 

 pos_camz = 0;

 rot_camx = 0;
 rot_camy = 0;
 rot_radx = 3.1415*rot_camx/180;
 rot_rady = 3.1415*rot_camy/180;

 nclip = 0.275;
 kx = 8.52/getWidth();
 ky = 5.46/getHeight();
}

 // Drawing instructions…
 public void paint(Graphics g) {
  super.paint(g);
  Graphics2D g1 = (Graphics2D)g;
  g1.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
  g.setColor(Color.black);
     xpoint = (double)(LP[0][0])/2;
     ypoint = 10 + (double)(LP[0][1])/2;
     zpoint = (double)(LP[0][2])/2;

     pxscr = (int)(
     ((xpoint - pos_camx)*Math.cos(rot_radx) + (ypoint + pos_camy)*Math.sin(rot_radx))*nclip
     /((ypoint - pos_camy)*Math.cos(rot_radx) + (pos_camx- xpoint)*Math.sin(rot_radx) + 0.0000000012)*100/kx
                  + getWidth()/2);

     pyscr = (int)(
                  getHeight()/2-
     (((ypoint + pos_camy)*Math.sin(rot_rady) + (zpoint - pos_camz)*Math.cos(rot_rady))*nclip
     /((ypoint - pos_camy)*Math.cos(rot_radx) + (pos_camx + xpoint)*Math.sin(rot_radx) + 0.0000000012)*100/ky)
                  );
     for (int i=1; i<19;i++){
            xpoint = (double)(LP[i][0])/2;
            ypoint = 10 + (double)(LP[i][1])/2;
            zpoint = (double)(LP[i][2])/2;

            nxscr = (int)(
         ((xpoint - pos_camx)*Math.cos(rot_radx) + (ypoint + pos_camy)*Math.sin(rot_radx))*nclip
         /((ypoint - pos_camy)*Math.cos(rot_radx)+(pos_camx + xpoint)*Math.sin(rot_radx)+0.0000000012)*100/kx
                         +getWidth()/2);

            nyscr = (int)(
                         getHeight()/2-
         (((ypoint + pos_camy)*Math.sin(rot_rady)+(zpoint - pos_camz)*Math.cos(rot_rady))*nclip
         /((ypoint - pos_camy)*Math.cos(rot_radx)+(pos_camx + xpoint)*Math.sin(rot_radx)+0.0000000012)*100/ky)
                         );
            g1.drawLine(pxscr,pyscr,nxscr,nyscr);
         pxscr = nxscr;
         pyscr = nyscr;
        }
         g.drawString("(" + pxscr + "," + pyscr + ")",20,40);
         g.drawString("" + pos_camx + ")",20,60);
         g.drawString("" + pos_camy,20,80);
         g.drawString("" + rot_camx,20,100);
  long currentTime = System.currentTimeMillis();
if (currentTime > nextSecond) {
    nextSecond += 1000;
    framesInLastSecond = framesInCurrentSecond;
    framesInCurrentSecond = 0;
}
    framesInCurrentSecond++;

g.drawString(framesInLastSecond + " fps", 20, 20);
}

// The standard Applet “GO” function…
public void start() {
   Thread th = new Thread(this);
  th.start();
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T18:06:45.867

现在我想我看到了你的问题。您采用了一个扩展 JApplet 的类，并尝试将其更改为 JPanel，而保留 init() 方法并保持原样。Swing 不是这样工作的。您将需要重新编写 JApplet 类型的类，摆脱诸如 init() 和 start() 之类的 applet 特定方法，而是可能在类的构造函数中初始化该代码。您需要了解如何在 Swing 中制作图形和动画——例如使用 JPanel 的 paintComponent 方法和 Swing Timer，这种方式可能会成功。

# wordpress - Wordpress 插件设置页面实时

> ID：13728773
> 
> 赞同：0
> 
> 时间：2012-12-05T17:19:00.273
> 
> 标签：wordpress

我过去曾使用 Post Expirator 来存档（草稿）页面和帖子，当它们达到某个截止日期时。是否有一个插件可以做相反的事情：一旦页面到达某个时间就设置它？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T17:22:23.167

WordPress 内置了此功能。它位于右侧（默认为“立即”）

如果您没有看到它，请尝试升级到最新版本

# tinymce - tinymce 工具栏浮动工具栏

> ID：13728776
> 
> 赞同：4
> 
> 时间：2012-12-05T17:19:06.193
> 
> 标签：tinymce, draggable, external, toolbar, floating

我用 jQuery 为 tinymce 创建了一个外部浮动工具栏。

```
tinyMCE.init({

    ...
    theme_advanced_toolbar_location : "external",
    theme_advanced_toolbar_align : "left",
    theme_advanced_statusbar_location : "top",
    theme_advanced_resizing : false,

    // make toolbar dragable
    handle_event_callback : function(e) {
        if (e.type == 'click') {
            $('.mceExternalToolbar').draggable();
        }
        return true;
    },
    ...
}); 
```

它可以工作，但是每次我单击 时`textarea`，工具栏都会弹回到`textarea`.

如果我在 中单击*，*移动`textarea`工具栏，然后在 中单击返回`textarea`，工具栏会弹回到`textarea`.

任何想法为什么会发生这种情况以及如何阻止它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T14:18:01.363

发生这种情况是因为工具栏 (editor_template.js) 的代码在每次编辑器处理鼠标向上事件时定位它。

我设法通过更改外部工具栏的 id 来解决它：

```
if (e.type == "click")
{
   var oldid = $(".mceExternalToolbar").attr("id");
   $(".mceExternalToolbar").attr("id", oldid+"_new");
   $(".mceExternalToolbar").draggable();
} 
```

这可能还有其他一些影响，但它似乎适用于我有限的测试。

# javascript - 您可以在 Android Chrome 上为 matchMedia 添加一个 javascript 回调侦听器吗？

> ID：13728783
> 
> 赞同：2
> 
> 时间：2012-12-05T17:19:28.163
> 
> 标签：javascript, android, google-chrome, listener, media-queries

我在页面上使用 matchMedia，我注意到在 Chrome for Android 上，检查匹配项有效，但是当您尝试向媒体查询添加侦听器时，回调函数永远不会触发。

我在桌面上运行了相同的代码，它工作正常，但它似乎没有在使用 Chrome 作为浏览器的 Android 4.x 设备上调用监听器中的回调。这还没有在浏览器中实现吗？

```
var width768Check = window.matchMedia("(min-width: 768px)");
console.log(width768Check.matches);
console.log(width768Check.addListener);
width768Check.addListener(function(mediaQueryList) {
    console.log(mediaQueryList.matches);
}); 
```

**更新**

我一直在使用带有 Google Chrome v18.0.1025469 和 Android v4.2.1 的 Nexus 7 平板电脑以及带有相同版本的 Google Chrome 和不同版本的 Android v4.0.3 的 Asus Transformer 平板电脑进行测试。

有趣的是，华硕平板电脑正确使用了监听回调函数，而 Nexus 7 没有。我不确定为什么在较新版本的 Android 操作系统上使用相同版本的 Chrome 会导致问题。此外，对于 Nexus 7，我下载了 Dolphin Browser，一切正常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-01T14:10:14.753

我也遇到了这个问题，并发现 - 至少在网络上 - 一个有趣的解决方法建议：

[WebKit 的媒体查询监听器](http://www.nczonline.net/blog/2012/01/19/css-media-queries-in-javascript-part-2/)

我已经在带有 Chrome 的 iPhone 4S 上测试了这个解决方案，并且（很重要！）在带有 Chrome 的三星 Galaxy Nexus（左右）上也测试了它，并且它有效。

这有点难看，但我发现它比等待正常工作的方向更改事件（在文档或屏幕上）更好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T00:01:54.363

当您将视口显示宽度设置为设备像素时，屏幕尺寸为 601x880 像素，根据设备像素密度（N7 上为 1.3）按比例缩小

这将解释您所看到的，并且可以在此处的测试中看到：http: [//jsbin.com/eyorap/latest](http://jsbin.com/eyorap/latest)

当您不设置视口宽度时，即使 screen.width 报告 601，媒体查询也会匹配，因为它应该使用实际的设备宽度。看这个演示：http: [//jsbin.com/igifon](http://jsbin.com/igifon)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-18T17:14:38.767

你可以试试轻量级的**[Inquire .js](http://wicky.nillia.ms/enquire.js/)**库。它处理匹配和不匹配+初始可选函数的回调。它似乎在带有 Chrome 浏览器的 Android 设备上运行良好，但我目前在本机浏览器上触发方向匹配有困难。

另外：Paul Irish 有自己的 matchMedia**[实现](https://github.com/paulirish/matchMedia.js)**。

# asp.net - ext.net : 重新绑定 sqldatasource 代码隐藏

> ID：13728786
> 
> 赞同：1
> 
> 时间：2012-12-05T17:19:42.273
> 
> 标签：asp.net, ext.net

通过使用[http://examples.ext.net/#/Chart/Column/Basic/](http://examples.ext.net/#/Chart/Column/Basic/,i)中的示例，我将我的数据绑定到我的 sqldatasource 中的图表，但是，在这个示例中，有一个名为“ReloadData”的按钮刷新数据，

像这样，

```
<script runat="server">
    protected void ReloadData(object sender, DirectEventArgs e)
    {
        Store store = this.Chart1.GetStore();

        store.DataSource = Ext.Net.Examples.ChartData.GenerateData();
        store.DataBind();
    }
</script> 
```

如何在 ReloadData 方法中再次绑定我的 sqldatasource。

我的简化代码在这里；

图表.aspx

```
 <ext:Panel ID="Panel1" 
                runat="server"
                Layout="FitLayout" Flex="1">
                <TopBar>
                    <ext:Toolbar ID="Toolbar1" runat="server" Flex="1">
                        <Items>
                            <ext:Button ID="Button1" 
                                runat="server" 
                                Text="" 
                                Icon="ArrowRefresh" 
                                OnDirectClick="ReloadData" />
                            ......
                            ......

                        </Items>
                    </ext:Toolbar>
                </TopBar>
                <Items>                                                     
    <ext:Chart ID="Chart1" runat="server" Shadow="true"  StyleSpec="background:#fff" Animate="true" ColumnWidth="0.5" Flex="1">
        <HtmlBin>
            <asp:SqlDataSource ID="datasource1"
 runat="server" ConnectionString="<%$ ConnectionStrings:AProjeConnectionString %>"
                SelectCommand="SELECT COUNT(*)
                ....
                ....
                ">
            </asp:SqlDataSource>
        </HtmlBin>

                            <Store>
                            <ext:Store ID="Store1" 
                                runat="server" 
                                DataSourceID="datasource1"
                                AutoDataBind="true">                           
                                <Model>
                                 .....
                             .....
                                </Model>
                            </ext:Store>
                        </Store>
       <Axes>
                            <ext:NumericAxis                             
                                Fields="O"                            
                                Grid="true"
                                Title="S"
                                Minimum="0">
                                <Label>
                        <Renderer Handler="return 
Ext.util.Format.number(value, '0,0');" />
                                </Label>
                            </ext:NumericAxis>                            

                            <ext:CategoryAxis 
                                Position="Bottom"
                                Fields="Ad"
                                Title=""
                                Width="75"
                                />                            
                        </Axes>
              <Series>
                            <ext:ColumnSeries 

                        ......
                        ......
                        ......
                            </ext:ColumnSeries>
                        </Series>
                        </ext:Chart>
    ......
    ...... 
```

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T08:15:16.903

只是打电话

```
Store1.DataBind(); 
```

应该有帮助。

# iphone - EKEventStore 中没有源

> ID：13728787
> 
> 赞同：4
> 
> 时间：2012-12-05T17:19:43.387
> 
> 标签：iphone, objective-c, ios, calendar, ekeventstore

我有一个奇怪的问题，我的 EKEventStore 实例不包含任何源。

奇怪的是，在我的某些手机中（获取 EKSourceTypeLocal 并创建日历），而在某些手机中没有，我花了很多时间更改日历设置，但我无法找到一个模式或者其他的东西。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-11T00:28:31.690

在 iOS6 上，请确保在初始化之后和尝试获取任何数据之前调用 -requestAccessToEntityType:completion: 方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-10T09:34:30.340

检查隐私设置。如果用户不允许访问此给定应用程序的日历 (iOS 6)，那么您将不会获得任何信息。

# ruby-on-rails - 如何使用 Shopify gem 复制产品

> ID：13728793
> 
> 赞同：0
> 
> 时间：2012-12-05T17:20:02.830
> 
> 标签：ruby-on-rails, shopify

我想复制现有 Shopify 产品及其所有图像和变体。

如何使用 Shopify gem 做到这一点？

我正在运行 Rails 3.2.2 和 Shopify gem 3.0.1。

谢谢，奥古斯托

**更新＃1：**

我尝试了以下代码：

我认为问题可能在于我正在尝试创建一种与原始产品具有相同 shopifyid 的新产品。但我不确定，我认为可能还有其他问题。

```
original_p = ShopifyAPI::Product.find(xxx)
new_p = ShopifyAPI::Product.new(original_p.attributes)
new_p.save

ActiveResource::ResourceNotFound: Failed.  Response code = 404\.  Response message = Not Found.
from /Users/phishman/.rvm/gems/ruby-1.9.2-p290/gems/activeresource-3.2.2/lib/active_resource/connection.rb:136:in `handle_response'
from /Users/phishman/.rvm/gems/ruby-1.9.2-p290/gems/shopify_api-3.0.1/lib/active_resource/connection_ext.rb:9:in `handle_response_with_response_capture'
from /Users/phishman/.rvm/gems/ruby-1.9.2-p290/gems/activeresource-3.2.2/lib/active_resource/connection.rb:115:in `request'
from /Users/phishman/.rvm/gems/ruby-1.9.2-p290/gems/shopify_api-3.0.1/lib/active_resource/connection_ext.rb:13:in `request_with_detailed_log_subscriber'
from /Users/phishman/.rvm/gems/ruby-1.9.2-p290/gems/activeresource-3.2.2/lib/active_resource/connection.rb:92:in `block in put'
from /Users/phishman/.rvm/gems/ruby-1.9.2-p290/gems/activeresource-3.2.2/lib/active_resource/connection.rb:218:in `with_auth'
from /Users/phishman/.rvm/gems/ruby-1.9.2-p290/gems/activeresource-3.2.2/lib/active_resource/connection.rb:92:in `put'
from /Users/phishman/.rvm/gems/ruby-1.9.2-p290/gems/activeresource-3.2.2/lib/active_resource/base.rb:1354:in `update'
from /Users/phishman/.rvm/gems/ruby-1.9.2-p290/gems/activeresource-3.2.2/lib/active_resource/observing.rb:19:in `update_with_notifications'
from /Users/phishman/.rvm/gems/ruby-1.9.2-p290/gems/activeresource-3.2.2/lib/active_resource/base.rb:1156:in `save'
from /Users/phishman/.rvm/gems/ruby-1.9.2-p290/gems/activeresource-3.2.2/lib/active_resource/validations.rb:79:in `save_with_validation'
from /Users/phishman/.rvm/gems/ruby-1.9.2-p290/gems/activeresource-3.2.2/lib/active_resource/observing.rb:19:in `save_with_notifications'
from (irb):26
from /Users/phishman/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.2.2/lib/rails/commands/console.rb:47:in `start'
from /Users/phishman/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.2.2/lib/rails/commands/console.rb:8:in `start'
from /Users/phishman/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.2.2/lib/rails/commands.rb:41:in `<top (required)>'
from script/rails:6:in `require'
from script/rails:6:in `<main>'1.9.2p290 :027 > np.errors 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-10T17:52:52.490

以防万一您还没有找到解决方案。

1.  我建议首先找到您希望复制的产品并将其信息保存到本地数据库中（例如 Duplicate Ojbect）
2.  获取您的本地版本，然后通过 API 创建

    `product = ShopifyAPI::Product.create({ :body_html => duplicate.body_html, :title => duplicate.title })`

`duplicate`来自您当地的地方：或`duplicate = Duplicate.find().last`类似的东西。

# matlab - Matlab从其他矩阵的数据创建矩阵

> ID：13728796
> 
> 赞同：3
> 
> 时间：2012-12-05T17:20:14.140
> 
> 标签：matlab, matrix, creation

我有一个矩阵 *u_test* ，其中包含来自我的测试集的数据。它的格式是这样的：

```
X  y  value
1  3  5.0
1  6  3.4
4  3  2.0 
```

我想从 *u_test* 创建一个矩阵*测试*，以便评级的值位于正确的位置，例如：

```
 1    2    3    4    5    6

1:          5.0 
2:                         3.4
3:
4:          2.0 
```

有没有一种无循环的方法来做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-05T17:32:01.850

最简单的方法是使用[SPARSE](http://www.mathworks.com/help/matlab/ref/sparse.html)

```
out = sparse(u_test(:,1),u_test(:,2),u_test(:,3)); 
```

如果数组的目标大小应该是`m-by-n`，则可以改为

```
out = sparse(u_test(:,1),u_test(:,2),u_test(:,3),m,n); 
```

使用稀疏的好处是，如果矩阵很大，它不会占用太多空间`u_test`。但是，如果由于某种原因您不能使用稀疏矩阵，请使用转换为完整矩阵

```
outNotSparse = full(out); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-05T17:33:09.303

A fairly simple way would use the function [sub2ind](http://www.mathworks.com/help/matlab/ref/sub2ind.html):

```
A = [1 3 5; 1 6 2; 4 3 2];

maxima = max(A(:,1:2));
xsub = A(:,1);
ysub = A(:,2);

index = sub2ind(maxima, xsub, ysub);

C = zeros(maxima);
C(index) = A(:,3); 
```

This parses out the three columns of `A` and converts the first two into linear indices. These are simply used to assign your data to the proper spots in `C`.

# c# - ObservableCollection 的自定义排序 有基础类型

> ID：13728797
> 
> 赞同：1
> 
> 时间：2012-12-05T17:20:15.013
> 
> 标签：c#, sorting, observablecollection

我有以下简化类：

```
public class BaseContainer
{
    public BaseContainer()
    {
        Children = new ObservableCollection<BaseContainer>();
    }
    public ObservableCollection<BaseContainer> Children { get; set; }
}

public class ItemA : BaseContainer
{
    public ItemA()
    {
        base.Children.Add(new ItemB() { ItemBName = "bb" });
        base.Children.Add(new ItemA() { ItemAName = "ab" });
        base.Children.Add(new ItemB() { ItemBName = "ba" });
        base.Children.Add(new ItemA() { ItemAName = "aa" });
    }
    public string ItemAName { get; set; }
}

public class ItemB : BaseContainer
{
    public string ItemBName { get; set; }
} 
```

我正在尝试根据两个条件对我的 ItemA.Children 集合进行排序：

1.  所有项目 A 必须在集合中排在第一位
2.  项目 A 应按 ItemAName 排序
3.  项目 B 应按 ItemBName 排序

所以在排序之后我会期待这样的事情：

*   ItemA - ItemAName = "aa"
*   ItemA - ItemAName = "ab"
*   ItemB - ItemBName = "ba"
*   ItemB - ItemBName = "bb"

关于如何做到这一点的任何想法？

我能够按类类型名称排序：

```
 List<BaseContainer> temp = base.Children.ToList();
        temp.Sort((x, y) => string.Compare(x.GetType().Name, y.GetType().Name));
        base.Children.Clear();
        base.Children.AddRange(temp); 
```

但是名称没有排序...

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T17:23:30.677

```
var result = temp.OrderBy(x => x.GetType().Name).ThenBy(x => GetPropValue(x));

string GetPropValue(object o)
{
    Type t = o.GetType();
    var p = t.GetProperty("ItemAName");
    if (p != null)
    {
        return (string)p.GetValue(o, null);
    }
    p = t.GetProperty("ItemBName");
    return (string)p.GetValue(o, null);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T17:30:50.400

这将获取所有 A，按 AName 排序，然后与所有 B 按 B 名称排序。

```
var result = Children.OfType<ItemA>().OrderBy(a => a.ItemAName).Cast<Base>()
    .Concat(Children.OfType<ItemB>().OrderBy(b => b.ItemBName)); 
```

我不确定这是我会采用的设计......您可能会考虑在基类中添加一些东西以促进这种排序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-05T17:31:11.530

您通过指定来初始化项目`ItemName`，但既不也不`BaseContainer`定义这样的属性。`ItemA``ItemB`

声明`ItemName in the base class`BaseContainer`。项目类自动继承此属性，无需在此处重新定义此类字段。

```
public class BaseContainer
{
    public string ItemName { get; set; }

    ...
}

public class ItemA : BaseContainer
{
    // Inherits ItemName 
}

public class ItemB : BaseContainer
{
    // Inherits ItemName 
} 
```

现在像这样对列表进行排序：

```
var result = base.Children
    .OrderBy(b => b.GetType().Name)
    .ThenBy(b => b.ItemName); 
```

并且在排序之前无需将其存储到临时列表中。结果是一个`IEnumerable<BaseContainer>`. `.ToList()`如果要将结果存储为列表，可以附加 a 。

```
var result = base.Children
    .OrderBy(b => b.GetType().Name)
    .ThenBy(b => b.ItemName)
    .ToList(); 
```

* * *

**更新**

根据您的评论，您没有共同`ItemName`财产。**为什么？**你真的应该有一个。重构你的类。如果由于某种原因您不想要`ItemName`in `BaseContainer`，请创建一个抽象基类`Item`或让项目实现一个公共接口。

```
public abstract class Item : BaseContainer
{
    public string ItemName { get; set; }
}

public class ItemA : Item
{
}

public class ItemB : Item
{
} 
```

或者

```
public interface IItem
{
    string ItemName { get; set; }
}

public class ItemA : BaseContainer, IItem
{
    public string ItemName { get; set; }
}

public class ItemB : BaseContainer, IItem
{
    public string ItemName { get; set; }
} 
```

现在你可以像这样排序

```
var result = base.Children
    .OfType<Item> // or .OfType<IItem>
    .OrderBy(i => i.GetType().Name)
    .ThenBy(i => i.ItemName); 
```

结果将是`IEnumerable<Item>`or `IEnumerable<IItem>`。

* * *

另一个选择是覆盖`ToString`每个对象继承自的方法`Syste.Object`。

```
public class ItemA : BaseContainer
{
    public string ItemAName { get; set; }

    public override string ToString()
    {
        return "ItemA: " + ItemAName;
    }
} 
```

这简化了排序，因为两个条件（按类型排序和按名称排序）都可以一步完成。该字符串也将显示在列表框、组合框等中。

```
var result = base.Children
    .OrderBy(b => b.ToString()); 
```

如果这不可能，请为此创建并实现一个接口：

```
public interface ISortable
{
    string SortString { get; }
}

public class ItemA : BaseContainer, ISortable
{
    public string ItemAName { get; set; }

    public string SortString { get { return "ItemA: " + ItemAName; } }
} 
```

并排序

```
var result = base.Children
    .OfType<ISortable> 
    .OrderBy(b => b.SortString); 
```

# python - python在unittest中运行glib mainloop

> ID：13728800
> 
> 赞同：5
> 
> 时间：2012-12-05T17:20:21.083
> 
> 标签：python, testing, glib

我是 python 新手，正在尝试建立一个功能测试环境。测试环境应通过 DBus 接收信号并对其进行评估。DBus 信号使用 GLib MainLoop。我有以下封装循环的类：

```
class SignalLoop(threading.Thread):
    def __init__(self):
        threading.Thread.__init__(self)
        self.__l = gobject.MainLoop()        
    def run(self):
        self.__l.run()
    def quit(self):
        self.__l.quit() 
```

在进行 DBus 处理的模块中，我尝试了：

```
class __ModuleInitializer:
    def __init__(self):
        print('Module was initialized')
        gobject.threads_init()
        sl = SignalLoop()
        sl.start()

    def __del__(self):
        print('Module was deinitialized')
        sl.quit()

__module_init = __ModuleInitializer() 
```

我还尝试了以下方法：

*   setUp/tearDownModule() 对我不起作用 - 至少在 python 2.5.2 中
*   __init__() 和 __del__() 方法并将所有测试用例放在一个类中。__del__() 永远不会被调用，并且此解决方案不会随大量测试用例扩展。

当我运行代码时，sl.qui() 永远不会被执行，我不知道为什么。从控制台运行时，我必须杀死我的 main，因为它永远不会返回。然而，这对 PyDev 测试运行器来说不是问题。

有什么钩子可以用来破坏测试环境吗？我希望能够同时运行一个测试和几个测试，因此不能将其“破解”到方法本身中。

你能帮我么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-06T16:03:05.827

在设置和拆卸方法期间，我不会启动和停止主循环。相反，发出您的异步请求（或其他），然后通过迭代运行主循环迭代，直到您的结果到达。

例子：

```
make_asynchronous_request()
main_context = GLib.MainContext.default()
while main_context.pending():
    main_context.iteration(False)
assert(result_is_ok()) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-19T13:38:05.483

我使用 ptomato 的答案创建了一个对我有用的答案。差异可能是由于某些python版本。就我而言，有效的代码是：

```
make_asynchronous_request()
main_context = GLib.MainLoop.get_context()
while main_context.pending():
    main_context.iteration(False)
assert(result_is_ok()) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-05T19:09:20.613

我认为您应该将`SignalLoop`类​​定义为`daemon`线程。这将允许程序在完成后关闭，即使信号循环线程仍在运行。当程序关闭时，该`__module_init`对象将被垃圾回收并`__del__`调用其函数。

[http://docs.python.org/2.6/library/threading.html#threading.Thread.daemon](http://docs.python.org/2.6/library/threading.html#threading.Thread.daemon)上的文档`daemon`

# eclipse - 为什么 MANIFEST.MF 看不到来自 Maven 的 pom 的包？

> ID：13728801
> 
> 赞同：2
> 
> 时间：2012-12-05T17:20:23.453
> 
> 标签：eclipse, maven, eclipse-plugin, osgi, equinox

所以我的POM中有这样的东西：

```
<dependency>
  <!-- jsoup HTML parser library @ http://jsoup.org/ -->
  <groupId>org.jsoup</groupId>
  <artifactId>jsoup</artifactId>
  <version>1.7.1</version>
</dependency> 
```

它`jsoup-1.7.1.jar`从某个地方的 maven repo 获取并将其放在我的*Maven Dependencies*文件夹中。

现在我可以在我的代码中使用它（Eclipse 不会抱怨），但是当我尝试在我的`MANIFEST.MF`文件中添加对它的依赖时：

```
Import-Package: org.osgi.framework, org.jsoup, org.jsoup.nodes 
```

Eclipse 一直在抱怨：

```
No available bundle exports package 'org.jsoup.nodes'
No available bundle exports package 'org.jsoup' 
```

有人可以向我解释为什么会这样吗？（我很好奇确定`MANIFEST.MF`看到什么的过程）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T08:54:32.167

When you work with the eclipse PDE you have to create a target platform that contains all necessary bundles. The normal dependency resolution is not coupled with the target platform. So you have to add each dependency to the to the maven pom and to the target platform.

Btw. if you are working on a server based OSGi project it may be better to not use the PDE. You can also create bundles using the maven bundle plugin. It analyzes the imports you do and creates the manifest automatically. In most cases this is much better than the PDE manifest first way and it works better with maven.

See: [http://www.liquid-reality.de/display/liquid/2011/02/15/Karaf+Tutorial+Part+1+-+Installation+and+First+application](http://www.liquid-reality.de/display/liquid/2011/02/15/Karaf+Tutorial+Part+1+-+Installation+and+First+application)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-02T09:39:31.890

只需在该包清单文件中添加一个导出语句，记住每次导入都应该有导出[在此处输入链接描述](http://blog.christianposta.com/osgi/understanding-how-osgi-bundles-get-resolved-part-i/)

# perl - 无法使用 Perl 在 Fedora 中写入文件

> ID：13728809
> 
> 赞同：0
> 
> 时间：2012-12-05T17:20:47.287
> 
> 标签：perl, file-io, fedora

我明天要考试，我被实验室实验的这一部分困住了。

**实验：**编写一个 Perl 程序来跟踪访问该网页的访问者数量，并以正确的标题显示访问者的数量。

```
#!/usr/bin/perl
use CGI':standard';
use CGI::Carp qw(warningsToBrowser fatalsToBrowser);
print "Content-type: text/html","\n\n";
open(FILE,'<count.txt');
$count=<FILE>+1;
close(FILE);
open(FILE,'>count.txt');
print FILE "$count";
print "This page has been viewed $count times";
close(FILE);
#print $count; 
```

我已`count.txt`在 Fedora 中将 ' 的权限更改为 755。

在每个页面加载时，在 Windows XP 中的 XAMPP 上执行时计数成功增加（使用适当的 shebang 行）。但我无法在 Fedora 上执行它。不幸的是，在我的考试中，我必须在 Fedora 上执行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T17:50:02.150

一直用`use strict; use warnings;`！如果您这样做，您将在错误日志中收到以下错误：

```
Global symbol "$count" requires explicit package name 
```

修复缺失的`my`后，您将在错误日志中收到以下错误：

```
readline() on unopened filehandle FILE
print() on unopened filehandle FILE 
```

您可以通过检查返回的错误来检查您的句柄未打开的原因`open`。

```
open(FILE,'<count.txt') or die "Can't open count.txt: $!\n";
open(FILE,'>count.txt') or die "Can't create count.txt: $!\n"; 
```

第一个说文件不存在。如果程序走得那么远，第二个会给你一个权限错误。那是因为您正试图访问`count.txt`在根目录 ( `/`) 中命名的文件。更改 cwd 或使用绝对路径。

* * *

顺便说一句，你有一个竞争条件。如果两个请求同时进入，您最终只会计算其中一个。

```
 |   process 1                      process 2
 |   ----------------------------   ----------------------------
 T   Read count from the file (4)
 i   Add 1 to count (5)
 m                                  Read count from the file (4)
 e                                  Add 1 to count (5)
 |                                  Save new count to file (5)
 v   Save new count to file (5) 
```

您需要使用锁定机制。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-05T17:23:57.680

shebang ( `#!`) 必须是文件的第一个字符。

# php - 数据库插入的 SQL 错误

> ID：13728811
> 
> 赞同：0
> 
> 时间：2012-12-05T17:20:53.060
> 
> 标签：php, sql

我收到一个 SQL 语法错误，但似乎无法找到源代码，因为代码似乎正确（对我来说）。

错误：

> 无效查询：您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 3 行的 '= 'test' 、 date = '2012-12-05' 、trunk = '' 、 Introduction = '' 、 title_gallery ' 附近使用正确的语法

编码：

```
<?php include("../inc/approve-admin.php"); ?>
<?php include("../inc/connect.php"); ?>

<?php include('class.upload.php'); ?>

<?php
$filePath = "../images";
$dir_dest = $filePath;
$dir_pics = (isset($_GET['pics']) ? $_GET['pics'] : $dir_dest);
?>

<!DOCTYPE HTML>
<?php
$PageTitle = "Fashion Franchise Admin | Add Record";
$description = "Fashion Franchise";
$keywords = "Fashion Franchise";
$body = "home";
require "../inc/header.php";
?>

<script src="../js/jquery.validate.js" type="text/javascript"></script>
<!-- for styling the form -->
<script src="../js/cmxforms.js" type="text/javascript"></script>

<script type="text/javascript">
$(document).ready(function() {
    $("#addResource").validate();
});
</script>

<script type="text/javascript" src="../js/tiny_mce/tiny_mce.js" ></script>
<script type="text/javascript">
tinyMCE.init({
        mode : "textareas",
        editor_deselector : "mceNoEditor"

});
</script>

    <body id="<?php echo htmlentities("$body") ?>">

    <div class="container_12">
    <!-- Nav -->
    <?php include("../inc/nav-admin.php"); ?>
    <!-- / Nav -->

    <div class="grid_12">&nbsp;</div>
    <div class="grid_12">&nbsp;</div>

    <!-- Adimn List -->
    <?php include("../inc/admin-list.php"); ?>
    <!-- / Adimn List -->

    <div class="grid_7" id="white" style="min-height:400px">

        <p style="text-align:center;padding-top:20px;">
<?

    if(isset($_POST['title'])) {
        if(isset($_POST['gallery_1'])) {
            $gallery_1_to_insert = mysql_real_escape_string($_POST['gallery_1']);
        }
        if(isset($_POST['gallery_2'])) {
            $gallery_2_to_insert = mysql_real_escape_string($_POST['gallery_2']);
        }
            if(isset($_POST['gallery_3'])) {
            $gallery_3_to_insert = mysql_real_escape_string($_POST['gallery_3']);
        }
            if(isset($_POST['gallery_4'])) {
            $gallery_4_to_insert = mysql_real_escape_string($_POST['gallery_4']);
        }
            if(isset($_POST['gallery_5'])) {
            $gallery_5_to_insert = mysql_real_escape_string($_POST['gallery_5']);
        }

            if(isset($_POST['download_1'])) {
            $download_1_to_insert = mysql_real_escape_string($_POST['download_1']);
        }

            if(isset($_POST['download_2'])) {
            $download_2_to_insert = mysql_real_escape_string($_POST['download_2']);
        }

            if(isset($_POST['download_3'])) {
            $download_3_to_insert = mysql_real_escape_string($_POST['download_3']);
        }

        $title_to_insert = mysql_real_escape_string($_POST['title']);
        $title_gallery_to_insert = mysql_real_escape_string($_POST['title_gallery']);
        $date_to_insert = stripslashes($_POST['date']);
        $trunk_to_insert = mysql_real_escape_string($_POST['trunk']);
        $introduction_to_insert = mysql_real_escape_string($_POST['introduction']);
        $download_1_title_to_insert = mysql_real_escape_string($_POST['download_1_title']);
        $download_2_title_to_insert = mysql_real_escape_string($_POST['download_2_title']);
        $download_3_title_to_insert = mysql_real_escape_string($_POST['download_3_title']);
        $dropbox_title_to_insert = mysql_real_escape_string($_POST['dropbox_title']);
        $dropbox_info_to_insert = mysql_real_escape_string($_POST['dropbox_info']);
        $dropbox_link_to_insert = mysql_real_escape_string($_POST['dropbox_link']);
        $video_title_to_insert = mysql_real_escape_string($_POST['video_title']);
        $video_to_insert = mysql_real_escape_string($_POST['video']);
        $id = (int)$id;   // Cast this as an integer to also make it safe

        $handle = new Upload($_FILES['gallery_1']);
            if ($handle->uploaded) {
                $handle->file_max_size = 4000000;
                $handle->image_resize = true;
                $handle->image_ratio = true;
                $handle->image_ratio_crop = true;
                $handle->image_y = 407;
                $handle->image_x = 460;
                $handle->allowed = array('image/pjpeg','image/jpeg', 'image/jpg');
                $handle->Process($dir_dest);
                if ($handle->processed) {
                    echo 'issue image 1 uploaded ' . round(filesize($handle->file_dst_pathname)/256)/4 . 'KB<br /><br />';
                    $gallery_1 = $dir_pics.'/' . $handle->file_dst_name ;
                } else {
                    echo '  the following error occurred while uploading image 1<br />';
                    echo '  Error: ' . $handle->error . '<br /><br />';
                }
                $handle-> Clean();
            }

            $handle2 = new Upload($_FILES['gallery_2']);
            if ($handle2->uploaded) {
                $handle2->file_max_size = 4000000;
                $handle2->image_resize = true;
                $handle2->image_ratio = true;
                $handle2->image_ratio_crop = true;
                $handle2->image_y = 307;
                $handle2->image_x = 460;
                $handle2->allowed = array('image/pjpeg','image/jpeg', 'image/jpg');
                $handle2->Process($dir_dest);
                if ($handle2->processed) {
                    echo 'issue image 2 uploaded ' . round(filesize($handle2->file_dst_pathname)/256)/4 . 'KB<br /><br />';
                    $gallery_2 = $dir_pics.'/' . $handle2->file_dst_name ;
                } else {
                    echo '  the following error occurred while uploading image 2<br />';
                    echo '  Error: ' . $handle2->error . '<br /><br />';
                }
                $handle2-> Clean();
            }

            $handle3 = new Upload($_FILES['gallery_3']);
            if ($handle3->uploaded) {
                $handle3->file_max_size = 4000000;
                $handle3->image_resize = true;
                $handle3->image_ratio = true;
                $handle3->image_ratio_crop = true;
                $handle3->image_y = 307;
                $handle3->image_x = 460;
                $handle3->allowed = array('image/pjpeg','image/jpeg', 'image/jpg');
                $handle3->Process($dir_dest);
                if ($handle3->processed) {
                    echo 'issue image 3 uploaded ' . round(filesize($handle3->file_dst_pathname)/256)/4 . 'KB<br /><br />';
                    $gallery_3 = $dir_pics.'/' . $handle3->file_dst_name ;
                } else {
                    echo '  the following error occurred while uploading image 3<br />';
                    echo '  Error: ' . $handle3->error . '<br /><br />';
                }
                $handle3-> Clean();
            }

            $handle4 = new Upload($_FILES['gallery_4']);
            if ($handle4->uploaded) {
                $handle4->file_max_size = 4000000;
                $handle4->image_resize = true;
                $handle4->image_ratio = true;
                $handle4->image_ratio_crop = true;
                $handle4->image_y = 307;
                $handle4->image_x = 460;
                $handle4->allowed = array('image/pjpeg','image/jpeg', 'image/jpg');
                $handle4->Process($dir_dest);
                if ($handle4->processed) {
                    echo 'main image for issue uploaded ' . round(filesize($handle4->file_dst_pathname)/256)/4 . 'KB<br /><br />';
                    $gallery_4 = $dir_pics.'/' . $handle4->file_dst_name ;
                } else {
                    echo '  the following error occurred while uploading the main image<br />';
                    echo '  Error: ' . $handle4->error . '<br /><br />';
                }
                $handle4-> Clean();
            }

            $handle5 = new Upload($_FILES['gallery_5']);
            if ($handle5->uploaded) {
                $handle5->file_max_size = 4000000;
                $handle5->image_resize = true;
                $handle5->image_ratio = true;
                $handle5->image_ratio_crop = true;
                $handle5->image_y = 307;
                $handle5->image_x = 460;
                $handle5->allowed = array('image/pjpeg','image/jpeg', 'image/jpg');
                $handle5->Process($dir_dest);
                if ($handle5->processed) {
                    echo 'map image for issue uploaded ' . round(filesize($handle5->file_dst_pathname)/256)/4 . 'KB<br /><br />';
                    $gallery_5 = $dir_pics.'/' . $handle5->file_dst_name ;
                } else {
                    echo '  the following error occurred while uploading the map image<br />';
                    echo '  Error: ' . $handle5->error . '<br /><br />';
                }
                $handle5-> Clean();
            }

            $handle6 = new Upload($_FILES['download_1']);
            if ($handle6->uploaded) {
                $handle6->file_max_size = 4000000;
                $handle6->allowed = array('application/*', 'image/*');
                $handle6->Process($dir_dest);
                if ($handle6->processed) {
                    echo 'download one uploaded' . round(filesize($handle6->file_dst_pathname)/256)/4 . 'KB<br /><br />';
                    $download_1 = $dir_pics.'/' . $handle6->file_dst_name ;
                } else {
                    echo '  the following error occurred while uploading download one<br />';
                    echo '  Error: ' . $handle6->error . '<br /><br />';
                }
                $handle6-> Clean();
            }

            $handle7 = new Upload($_FILES['download_2']);
            if ($handle7->uploaded) {
                $handle->file_max_size = 4000000;
                $handle->allowed = array('application/*', 'image/*');
                $handle7->Process($dir_dest);
                if ($handle7->processed) {
                    echo 'download two uploaded' . round(filesize($handle7->file_dst_pathname)/256)/4 . 'KB<br /><br />';
                    $download_2 = $dir_pics.'/' . $handle7->file_dst_name ;
                } else {
                    echo '  the following error occurred while uploading download two<br />';
                    echo '  Error: ' . $handle7->error . '<br /><br />';
                }
                $handle7-> Clean();
            }

            $handle8 = new Upload($_FILES['download_3']);
            if ($handle8->uploaded) {
                $handle->file_max_size = 4000000;
                $handle->allowed = array('application/*', 'image/*');
                $handle8->Process($dir_dest);
                if ($handle8->processed) {
                    echo 'download three uploaded' . round(filesize($handle8->file_dst_pathname)/256)/4 . 'KB<br /><br />';
                    $download_3 = $dir_pics.'/' . $handle8->file_dst_name ;
                } else {
                    echo '  the following error occurred while uploading download three<br />';
                    echo '  Error: ' . $handle8->error . '<br /><br />';
                }
                $handle8-> Clean();
            }

        $query = mysql_query("INSERT INTO news  (
id,
title = '$title_to_insert' ,
date = '$date_to_insert' ,
trunk = '$trunk_to_insert' ,
introduction = '$introduction_to_insert' ,
title_gallery = '$title_gallery_to_insert' ,
gallery_1 = '$gallery_1_to_insert' ,
gallery_2 = '$gallery_2_to_insert' ,
gallery_3 = '$gallery_3_to_insert' ,
gallery_4 = '$gallery_4_to_insert' , 
gallery_5 = '$gallery_5_to_insert' ,
download_1 = '$download_1_to_insert' ,
download_2 = '$download_2_to_insert' ,
download_3 = '$download_3_to_insert' ,
download_1_title = '$download_1_title_to_insert' ,
download_2_title = '$download_2_title_to_insert' ,
download_3_title = '$download_3_title_to_insert' ,
dropbox_title = '$dropbox_title_to_insert' ,
dropbox_info = '$dropbox_info_to_insert' ,
dropbox_link = '$dropbox_link_to_insert' ,
video_title = '$video_title_to_insert' ,
video = '$video_to_insert'
) VALUES

(NULL,
'$title_to_insert' ,
'$title_gallery_to_insert' ,
'$date_to_insert' ,
'$trunk_to_insert' ,
'$introduction_to_insert',
'$gallery_1_to_insert',
'$gallery_2_to_insert',
'$gallery_3_to_insert',
'$gallery_4_to_insert',
'$gallery_5_to_insert',
'$download_1_to_insert',
'$download_2_to_insert',
'$download_3_to_insert',
'$download_1_title_to_insert',
'$download_2_title_to_insert',
'$download_3_title_to_insert',
'$dropbox_title_to_insert',
'$dropbox_info_to_insert',
'$dropbox_link_to_insert',
'$video_title_to_insert',
'$video_to_insert' );");

if($query) {
            $message = $title . " has been added";

        }else{
            $message = "an error occurred while updating this entry";
            die('Invalid query: ' . mysql_error());

        }
}

    ?>

    </p>

    <? if(isset($_POST['title'])) { ?>
            <div id="content_holder">
              <p style="text-align:center;padding-top:20px;">
              <strong><? echo $message; ?></strong><br/>
              <span class="error"><? if($error_message) { echo $error_message; } ?></span>
              Add another <a href="add.php">Record/Item</a></p>
            <!-- end content_holder -->
            </div>
       <? }else{ ?>

    <h1 style="padding:10px;">Add News Record</h1>  
     <form action="add_news.php" enctype="multipart/form-data"  name="addResource" id="addResource" method="post" class="cmxform">

    <table cellpadding="10px;" cellspacing="5" width="100%" align="left" valign="top">

    <tr><td colspan="2" align="right"><label>*Required Fields</label></tr>

    <tr>
    <td width="50%">
    <span class="formTitle">General Information</span><br/><br/>
    <label>*Title</label><br/>
    <input id="title" name="title" class="required" />
    </td>
    <td width="50%"><br/><br/>
    <label>*Date</label><br/>
    <input id="date" name="date" class="required"/>
    </td>
    </tr>

        <tr><td colspan="2">
    <label>*Brief News Summary (*200 Characters or Less)</label><br/>
    <p class="smallGrey">Used for list display</p><br/>
    <textarea class="mceNoEditor" id="trunk" name="trunk" style="width: 510px; height: 200px; font-size: 12px;" class="required"/></textarea>
    </td></tr>

    <tr><td colspan="2">
    <label>News Article Content</label><br/>
    <p class="smallGrey">*Basic font styling only for best display</p><br/>
    <textarea style="width: 510px; height: 300px; font-size: 12px; overflow: auto;" id="introduction" name="introduction"></textarea>
    </td></tr>

    <tr>
    <td colspan="2">
    <hr/>
    </td>   
    </tr>

    <tr>
    <td>
    <table width="100%" align="left" valign="top">
    <tr><td><span class="formTitle">Add Gallery Images</span></td></tr>
    <tr><td><p class="smallGrey">*Ideal picture size is 460px by 307px (Landscape). Larger Images will be cropped to these proportions.</p></td></tr>   
    <tr><td><label>Gallery Title/Name</label><br/><input id="title_gallery" name="title_gallery" /></td></tr>
    <tr><td><label>Image #1</label><br/><input type="file" id="gallery_1" name="gallery_1" /></td></tr>
    <tr><td><label>Image #2</label><br/><input type="file" id="gallery_2" name="gallery_2" /></td></tr>
    <tr><td><label>Image #3</label><br/><input type="file" id="gallery_3" name="gallery_3" /></td></tr>
    <tr><td><label>Image #4</label><br/><input type="file" id="gallery_4" name="gallery_4" /></td></tr>
    <tr><td><label>Image #5</label><br/><input type="file" id="gallery_5" name="gallery_5" /></td></tr>
    </table>    
    </td>
    <td valign="top">
    <span class="formTitle">Video Embed</span><br/>
    <label>Video Title</label><br/><input id="video_title" name="video_title" /><br/><br/>
    <p class="smallGrey">*Be sure to set the video width to "460" for proper display.</p><br/>
    <label>Video Embed Code</label><br/>
    <textarea class="mceNoEditor" id="video" name="video"/></textarea>
    </td>
    </tr>

    <tr>
    <td colspan="2">
    <hr/>
    </td>   
    </tr>

    <tr><td>
    <table width="100%" align="left" valign="top">
    <span class="formTitle">Add Downloads</span><br/>
    <tr><td><p class="smallGrey">*5MB Max File Upload Size. Acceptable document types: PDF, Word and Excel</p></td></tr>    
    <tr><td><label>Download Title One</label><br/><input id="download_1_title" name="download_1_title" /></td></tr>
    <tr><td><label>Download One</label><br/><input type="file" id="download_1" name="download_1" /></td></tr>
    <tr><td><label>Download Title Two</label><br/><input id="download_2_title" name="download_2_title" /></td></tr>
    <tr><td><label>Download Two</label><br/><input type="file" id="download_2" name="download_2" /></td></tr>
    <tr><td><label>Download Title Three</label><br/><input id="download_3_title" name="download_3_title" /></td></tr>
    <tr><td><label>Download Three</label><br/><input type="file" id="download_3" name="download_3" ></td></tr>
    </table>
    </td>

    <td valign="top">
    <span class="formTitle">Add Dropbox</span><br/>
    <label>Dropbox Title</label><br/>
    <input id="dropbox_title" name="dropbox_title" />
    <br/><br/>
    <label>Dropbox Description</label><br/>
    <input id="dropbox_info" name="dropbox_info" />
    <br/><br/>
    <label>Dropbox Link (No http://)</label><br/>
    <input id="dropbox_link" name="dropbox_link" />

    </td></tr>

    <tr>
    <td colspan="2">
    <hr/>
    </td>   
    </tr>

    <tr><td colspan="2" align="right">
    <p class="smallGrey">*Depending on the number and size of files being uploaded it might take awhile for the browser to process your request. Please only click the submit button once.</p><br/>
    <input type="submit" value="Add Record" class="submit" />&nbsp;&nbsp;&nbsp;&nbsp;<a href="index.php" class="cancel">Cancel</a><br/><br/>

    </td></tr>
        </table>
     </form>
      <?php

    }mysql_close();
    ?>

    </div>

<?php include("../inc/footer.php"); ?>

    <!-- / Container_12 -->
    </div>

    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-05T17:23:55.860

您的查询构造不正确。

它应该是这样的：

```
INSERT INTO news (id, title, date, ...) VALUES ($id, '$title', '$date', ...)" 
```

但问题是你在部分中有你的价值观，`VALUES (...)`但你也无缘无故地将它们放在第一部分中。

您还应该停止使用`mysql_*()`它们，因为它们已被弃用，并查看[mysqli](http://www.php.net/manual/en/class.mysqli.php)以正确构建您的查询。

# java - 在 Rational Software Architect 中打开 UML 模型时出现异常

> ID：13728813
> 
> 赞同：0
> 
> 时间：2012-12-05T17:20:54.517
> 
> 标签：java, uml, rational-rsa

我在使用 Rational Software Architect 8.0 时遇到问题。我正在开发一个为模型提供一些额外功能的插件。我正在尝试编写单元测试以确保我的插件按预期运行。

作为其中一些测试的一部分，我需要打开一个 UML 模型（emx 格式）并对其进行一些操作。我使用`com.ibm.xtools.modeler.ui.UMLModeler.openModelResource(..)`它，但它会引发一个奇怪的异常。这是代码片段：

```
Element root = null;
try {
    root = UMLModeler.openModelResource(fileName);
} catch (IOException e) {
    System.out.println("Error while opening model " + fileName + ": " + e.getMessage());
}
return root; 
```

这是抛出的异常：

```
Exception in thread "main" java.lang.ExceptionInInitializerError
    at java.lang.J9VMInternals.initialize(J9VMInternals.java:222)
    at org.eclipse.gmf.runtime.emf.core.internal.domain.MSLEditingDomain$MSLResourceSet.addURIHandlers(MSLEditingDomain.java:2282)
    at org.eclipse.gmf.runtime.emf.core.internal.domain.MSLEditingDomain$MSLResourceSet.<init>(MSLEditingDomain.java:2315)
    at org.eclipse.gmf.runtime.emf.core.internal.domain.MSLEditingDomain.<init>(MSLEditingDomain.java:255)
    at org.eclipse.gmf.runtime.emf.core.internal.domain.MSLEditingDomain.<init>(MSLEditingDomain.java:234)
    at org.eclipse.gmf.runtime.emf.core.edit.MEditingDomain.createDefaultEditingDomain(MEditingDomain.java:112)
    at org.eclipse.gmf.runtime.emf.core.edit.MEditingDomain.<clinit>(MEditingDomain.java:70)
    at java.lang.J9VMInternals.initializeImpl(Native Method)
    at java.lang.J9VMInternals.initialize(J9VMInternals.java:200)
    at org.eclipse.gmf.runtime.emf.core.util.ResourceUtil.findResource(ResourceUtil.java:163)
    at com.ibm.xtools.modeler.ui.UMLModeler.openUMLResource(UMLModeler.java:1144)
    at com.ibm.xtools.modeler.ui.UMLModeler.openModelResource(UMLModeler.java:451)
    at uk.ac.open.rbacuml.dsml.plugin.research.fixing.SSoDConstraintFixingTest.loadModel(SSoDConstraintFixingTest.java:23)
    at uk.ac.open.rbacuml.dsml.plugin.research.fixing.SSoDConstraintFixingTest.testSSoDConstraintFixing(SSoDConstraintFixingTest.java:32)
    at uk.ac.open.rbacuml.dsml.plugin.research.fixing.SSoDConstraintFixingTest.main(SSoDConstraintFixingTest.java:17)
Caused by: java.lang.NullPointerException
    at org.eclipse.gmf.runtime.common.core.util.Log.<clinit>(Log.java:42)
    at java.lang.J9VMInternals.initializeImpl(Native Method)
    at java.lang.J9VMInternals.initialize(J9VMInternals.java:200)
    ... 14 more 
```

我显然做错了什么，但我不知道是什么。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-09T14:10:20.143

ModelResources 应该从 UMLModeler 的 EditingDomain 中打开：

```
UMLModeler.getEditingDomain().runExclusive(new Runnable() {
    public void run() {
        Element root = null;
        try {
            root = UMLModeler.openModelResource(fileName);
        } catch (IOException e) {
            System.out.println("Error while opening model " + fileName + ": " + e.getMessage());
        }
    }
}); 
```

# actionscript-2 - flash action script 2.0 提取数组项

> ID：13728815
> 
> 赞同：1
> 
> 时间：2012-12-05T17:21:12.670
> 
> 标签：actionscript-2

（仅限 ActionScript 2）

我的网站是一个 SWF，它通过 PHP 从 MySQL DB 加载用户请求数据。我完全掌握了整个沟通过程。

在主页上，除了已经出现在页面右侧的新闻之外，我希望在左侧显示一些关于所提供的基本服务的提醒，以及注册用户在访问该网站时必须执行的强制性操作。

数据库返回：带有 | 的数组 分隔符和数组项的总数。

在 Flash 中，我使用以下函数来获取数组：

```
remindersFct = function () {
          var myReminders = new LoadVars();
          myReminders.identity = "reminders";
          myReminders.onLoad = function(ok) {
                    if (ok) {
                                   _root.reminderFld.html = true;
                                   var myArray:Array = new Array(myReminders.mydata.split("|"));
                                   myArray.length = myReminders.totalItems;
                    }
                    else {
                                   stop();
                    }
          };
          myReminders.sendAndLoad("misc.php",myReminders,'POST');
};
remindersFct();//start the process 
```

我想知道不同的事情......：

1 - 我如何将这个数组“分解”成不同的项目（它们都是文本字符串） 2 - 然后，我如何告诉 SWF 在适当的 htmlText 字段中一个接一个地显示它们 3 - 如何我根据它们包含的文本长度调整每个项目的持续时间

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-17T01:42:02.533

好吧，您已经列出的行 var myArray:Array = new Array(myReminders.mydata.split("|")); 会将字符串分解成一个数组。至于显示，我建议您使用 for..in 语句，例如

```
for(x in myArray){
    myDynamicTextField.htmlText += (myArray[x] + "<br>");
} 
```

请注意，由于 for..in 经常反向迭代，您可能需要先执行 myArray.reverse()。

至于持续时间，这有点难以破解。上面的代码一次将文本全部放入——您可能希望设置一个计数器和一个计时器，用于在下一次插入文本之前剩余的帧数，例如：

```
_root.x = 0;
_root.timer = 5; //frames 
```

进行设置，然后在 onEnterFrame 中：

```
_root.timer--;
if(_root.timer == 0){
     myDynamicTextField.htmlText += (myArray[_root.x] + "<br>");

     if(_root.x >= myArray.length-1){
        delete this.onEnterFrame; //clean up
     } else {
        _root.timer = ... //put whatever value should go here depending on the length of myArray[_root.x]
     }
     _root.x++;
} 
```

希望这应该有效。祝你好运！

# c++ - C++ 类成员初始化两次

> ID：13728816
> 
> 赞同：4
> 
> 时间：2012-12-05T17:21:23.730
> 
> 标签：c++

是否`MyVec`正在创建两个？`MyVec`在 的构造函数中的assinment 之前是否存在临时的、默认构造`Foo`的？

```
struct Foo {

  typedef std::vector<int> MyVec;

  Foo () {

    // determine how big the vector needs to be.
    // .....

    m_vec = MyVec(12);
  }

  MyVec m_vec; 
}; 
```

我知道我可以使用指针来做到这一点。

```
struct Foo {

  typedef std::vector<int> MyVec;

  Foo () {
    m_vec = new MyVec();
  }

  ~Foo () {
    delete m_vec;
  }

  MyVec * m_vec;
}; 
```

但如果可能的话，我想避免这种情况。

**编辑：**

我忘了提。我不能使用初始化列表，因为我需要在赋值之前在构造函数中做一些事情。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-05T17:23:45.183

请尝试以下语法：

```
struct Foo {

  typedef std::vector<int> MyVec;

  Foo ()
  : m_vec(12)
  {
  }

  MyVec m_vec; 
}; 
```

它被称为[c++ 成员初始化列表](https://www.google.com/search?q=c%2B%2B+member+initialization+list)。

* * *

> 我不能使用初始化列表，因为我需要在赋值之前在构造函数中做一些事情。

如果您需要计算向量的大小，也许您可​​以在调用构造函数之前或在从构造函数调用的静态方法中执行此操作：

```
struct Foo {

  typedef std::vector<int> MyVec;

  Foo ()
  : m_vec(calculateVectorSize())
  {
  }

  static int calculateVectorSize()
  {
      // determine how big the vector needs to be.
      // .....
  }

  MyVec m_vec; 
}; 
```

如果这些也是不可能的，那么比您的原始帖子更便宜的解决方案是：

```
struct Foo {

  typedef std::vector<int> MyVec;

  Foo () {

    // determine how big the vector needs to be.
    // .....

    m_vec.resize(12);
  }

  MyVec m_vec; 
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T17:24:17.750

是的。

是的，你可以避免它：

```
Foo():
  m_vec(/*args_to_construct_m_vec*/)
{
  // body goes here
} 
```

通过上面的语法。

如果你不能使用初始化器列表，因为你想把什么放进去`m_vec`，另一种方法是拆分你的类。

`m_vec`在计算 的大小之前需要初始化的类部分卡在父类中。你构造它，然后`m_vec`在初始化列表中构造。

请注意，`std::vector`默认初始化非常便宜（通常是“ `memset`” `sizeof`（3 个指针）指向`0`），所以您的担心几乎肯定是放错了地方。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-05T17:27:45.020

我相信 typedef 只是告诉编译器`MyVec`可以被视为`vector<int>`gvien 包含向量库。

但是，还没有实际`MyVec`构建。

此外，您应该尝试使用替代和更首选的语法来初始化成员字段。

# ios - 在 iOS 中使用 Accelerometer 需要帮助

> ID：13728817
> 
> 赞同：3
> 
> 时间：2012-12-05T17:21:24.640
> 
> 标签：ios, avaudioplayer, accelerometer

我正在开发一个应用程序，该应用程序会为用户持有其 iOS 设备的每个位置（站立、正面/背面或侧面）播放哔声。目前，当用户将设备放在一边时，我可以播放声音，但是，问题是因为我有与滑块链接的加速度计值，所以哔哔声是连续的（即它播放声音为只要用户将设备侧放），而不仅仅是一次。

我希望用户只需将设备稳定地放在一边，然后发出一声哔哔声，然后让用户将设备依次保持在其他位置，然后等待另一声哔哔声。我希望用户一步一步地走，一次一个地把设备放在每个位置，只有在听到哔哔声后才能移动到下一个位置。

这是我正在使用的代码：

```
- (void)accelerometer:(UIAccelerometer *)accelerometer didAccelerate:(UIAcceleration *)acceleration
{

    NSLog(@"(%.02f, %.02f, %.02f)", acceleration.x, acceleration.y, acceleration.z);
    slider.value = acceleration.x;

    if (slider.value == -1)
        [self pushBeep];

    else if (slider.value == 0.00)
        [self pushBap];

    else if (slider.value == 1)
        [self pushBop];

... 
```

这是我的 pushBeep() 方法的代码（仅供参考，方法 pushBeep/pushBap/pushBop 都是相同的）：

```
-(void) pushBeep {

    NSString *soundPath =[[NSBundle mainBundle] pathForResource:@"beep-7" ofType:@"wav"];
    NSURL *soundURL = [NSURL fileURLWithPath:soundPath];

    NSError *ierror = nil;
    iPlayer = [[AVAudioPlayer alloc] initWithContentsOfURL:soundURL error:&ierror];

    [iPlayer play];
} 
```

谁能弄清楚这里有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T17:48:33.600

我认为您应该使用内置的方向通知，而不是手动轮询加速度计。如果您需要 FaceUp 和 FaceDown 方向，您可以使用类似下面的方法。或者您可以使用第二种方法来简单地横向、纵向。

**第一种**依赖于设备方向的方法。如果您需要 FaceUp 或 FaceDown 方向，或者如果您没有 UIViewController，这很重要。

```
[[UIDevice currentDevice] beginGeneratingDeviceOrientationNotifications];
[[NSNotificationCenter defaultCenter]
   addObserver:self selector:@selector(orientationChanged:)
   name:UIDeviceOrientationDidChangeNotification
   object:[UIDevice currentDevice]]; 
```

这是构建的方法。

```
- (void) orientationChanged:(NSNotification *)note
{
   UIDevice * device = note.object;
   switch(device.orientation)
   {
       case UIDeviceOrientationPortrait:
       /* Play a sound */
       break;

       case UIDeviceOrientationPortraitUpsideDown:
       /* Play a sound */
       break;

       // ....

       default:
       break;
   };
} 
```

**依赖于 UIViewController 的 interfaceOrientations 的**第二种方法。****

 **```
- (void)willRotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation duration:(NSTimeInterval)duration
{
    switch (toInterfaceOrientation) {
        case UIInterfaceOrientationLandscapeLeft:
            /* Play a Sound */
            break;

        case UIInterfaceOrientationPortrait:
            /* Play a Sound */
            break;

            // .... More Orientations

        default:
            break;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T21:09:00.083

加速度计来自加速这个词——它不会告诉你设备的方向，它只会告诉你它在 x、y 和 z 轴上在空间中移动的速度。使用 UIInterfaceOrientation && UIDeviceOrientation。**

# android - 在 Android 中创建表

> ID：13728819
> 
> 赞同：0
> 
> 时间：2012-12-05T17:21:37.260
> 
> 标签：android, coding-style, create-table

给我的第一篇文章。我是第一次涉足 Android 开发，Java 编程经验有限。关于我的问题...

在 dbHelper 类中创建多个表时，首选哪种方法？

初始化变量以保存创建字符串...

```
private static final String DATABASE_CREATE =
            "create table notes (_id integer primary key autoincrement, "+
            "title text not null, body text not null);";

db.execSQL(DATABASE_CREATE); 
```

要不就...

```
db.execSQL("create table notes (_id integer primary key autoincrement, "+
            "title text not null, body text not null);"
); 
```

我已经看到它以两种方式完成，我试图理解为什么更多的代码会比更少的代码更好。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T17:32:38.820

就我个人而言，我更喜欢将它们保存在最终的静态字符串变量中，这样我就可以在一个地方轻松地编辑它们，这样我就更容易阅读它并更改可能适用于多个数据库的内容。我认为这是大多数开发人员最喜欢的方式。

```
public class myVariables {
     public final static String firstTable = "firstTableCreationQuery";
     public final static String secondTable = "secondTableCreationQuery";
} 
```

你可以很容易地访问它们

```
...
db.execSQL(myVariables.firstTable);
db.execSQL(myVariables.secondTable);
... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T17:28:06.737

作为最佳实践，您应该使用常量来创建。当您以后想对表格进行一些更改时，这将为您提供帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-05T17:27:22.783

@MrCleanX 这样做。

```
public class DatabaseHandler extends SQLiteOpenHelper {

// All Static variables
// Database Version
private static final int DATABASE_VERSION = 1;

// Database Name
private static final String DATABASE_NAME = "contactsManager";

// Contacts table name
private static final String TABLE_CONTACTS = "contacts";

// Contacts Table Columns names
private static final String KEY_ID = "id";
private static final String KEY_NAME = "name";
private static final String KEY_PH_NO = "phone_number";

public DatabaseHandler(Context context) {
    super(context, DATABASE_NAME, null, DATABASE_VERSION);
}

// Creating Tables
@Override
public void onCreate(SQLiteDatabase db) {
    String CREATE_CONTACTS_TABLE = "CREATE TABLE " + TABLE_CONTACTS + "("
            + KEY_ID + " INTEGER PRIMARY KEY," + KEY_NAME + " TEXT,"
            + KEY_PH_NO + " TEXT" + ")";
    db.execSQL(CREATE_CONTACTS_TABLE);
}

// Upgrading database
@Override
public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
    // Drop older table if existed
    db.execSQL("DROP TABLE IF EXISTS " + TABLE_CONTACTS);

    // Create tables again
    onCreate(db);
} 
```

# java - 在合并方法中返回多个变量

> ID：13728823
> 
> 赞同：0
> 
> 时间：2012-12-05T17:21:46.123
> 
> 标签：java, sorting, recursion

我编写了一种方法来合并排序值数组。方法完美无缺，但我试图展示已经发生的比较和交流的数量。我的第一个想法是创建静态变量（int 比较、int 交换）并将它们传递给方法。但是我遇到了从帮助方法返回它们的问题。是否可以在同一方法中返回一个 int[] 和两个 int？如果不是，我如何确定已经发生的比较和交换的数量？

这是我的 mergeSort 和 merge 方法：

```
 public static int[] mergeSort(int[] A, int comps, int exchs) {
    // Array has only 1 element
    if( A.length <= 1 ) {
        return A;
    }
    int midPoint = A.length / 2;
    // Initialize left and right arrays.
    int[] left = new int[midPoint];
    int[] right = new int[A.length - midPoint];
    System.arraycopy(A, 0, left, 0, midPoint);
    System.arraycopy(A, midPoint, right, 0, A.length - midPoint);
    //recursively sort left and right arrays
    left = mergeSort(left, comps, exchs);
    right = mergeSort(right, comps, exchs);
    System.out.println("Comparisons" + comps);
    System.out.println("Exchanges" + exchs);
    return merge(left, right, comps, exchs);

} 
private static int[] merge(int[] left, int[] right, int comps, int exchs){
    // Initialize the result array.
    int[] res = new int[left.length + right.length];
    // Initialize the array indexes.
    int leftIndex = 0; 
    int rightIndex = 0;
    int resIndex = 0; 
    // compare each element and merge results
    while(leftIndex < left.length && rightIndex < right.length){
        if(left[leftIndex] > right[rightIndex]){
            res[resIndex] = right[rightIndex];
            exchs++;
            rightIndex++;
        } else {
            res[resIndex] = left[leftIndex];
            exchs++;
            leftIndex++; 
        }
        comps++;
        resIndex++;
    }
    comps++;
    // Append remainder of left array into the result array.
    while(leftIndex < left.length){
        res[resIndex] = left[leftIndex];
        exchs++;
        leftIndex++;
        resIndex++;
    }
    comps++;
    // Append whatever is left from the right array into the result array.
    while(rightIndex < right.length) {
        res[resIndex] = right[rightIndex];
        exchs++;
        rightIndex++; 
        resIndex++;
    }
    comps++;
    return res; // want to return comparisons and exchanges to mergeSort method
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T17:26:41.907

创建一个为您进行排序的对象。然后它可以存储`comps`and`exchs`并且您可以使用 getter 方法访问它们...

```
public class MergeSorter {
  private int comps = 0;
  private int exchs = 0;

  public int[] mergeSort(int[] A) {
    comps = 0;
    exchs = 0;
    // your code
  }
  private int[] merge(int[] left, int[] right) {
    // your code
  }

  public int getLastComps() { return comps; }
  public int getLastExchs() { return exchs; }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T17:24:57.827

> 是否可以在同一方法中返回一个 int[] 和两个 int？

不是直接的。但是，您可以创建一个类来封装您需要从该方法返回的所有内容，并返回该类的一个实例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-05T17:36:26.303

如果您有一个具有多个合并方法的类，我将创建两个静态类变量。调用方法时，比较和交换都将设置为 0。随着代码的进行，这两个值将被更新。因此，您将始终知道在调用其中一种方法后，两个变量都会显示正确的值。例如，

```
private static int comparisons;
private static int exchanges;

public static int[] mergeSort(int[] A, int comps, int exchs) {
    comparisons = 0;
    exchanges = 0;
    if( A.length <= 1 ) {
        return A;
    }
    int midPoint = A.length / 2;
    int[] left = new int[midPoint];
    int[] right = new int[A.length - midPoint];
    System.arraycopy(A, 0, left, 0, midPoint);
    System.arraycopy(A, midPoint, right, 0, A.length - midPoint);
    //recursively sort left and right arrays
    left = mergeSort(left, comps, exchs);
    right = mergeSort(right, comps, exchs);
    comparisons = comps;
    exchanges = exchs;
    return merge(left, right, comps, exchs);
} 
```

您现在可以在调用方法后访问这些静态变量，并且在再次调用该方法时将刷新。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-05T17:38:16.520

您必须将这些值包装在一起。因为您不能从一个方法一次返回多个值。因此，将它们全部放置一个对象并返回该对象。

例子：

```
class WrapperClass {
 int[] array;
 int valueOne;
 int valueTwo;
 // Setters and Getters to these members.
} 
```

样品方法。

```
public WrapperClass method() {
  // Set your values to the object;
  WrapperClass wrapObj = new WrapperClass();
  // set array and the two values to this object.
  // return the object.
  return wrapObj;
} 
```

# php - 返回变量中空格的真值

> ID：13728825
> 
> 赞同：0
> 
> 时间：2012-12-05T17:21:52.327
> 
> 标签：php, function, return, whitespace

我有一个函数“isValid”，它负责在提供的所有变量中搜索空格。如果没有任何变量包含空格，我希望函数返回 true。这是正确的方法吗？

```
return !(strpos($this->email, " ") || strpos($this->confirm_password1, " ") || strpos($this->handle, " ") || strpos($this->phone, " ")); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T17:41:19.140

为了使其易于维护，我将执行以下操作：

```
public function isValid()
{
    $properties = array(
        'email',
        'confirm_password1',
        'handle',
        'phone',
    );

    foreach ($properties as $property) {
        if ($this->containsSpace($property)) {
            return false;
        }
    }

    return true;
}

private function containsSpace($property)
{
    return !(strpos($this->$property, '') === false);
} 
```

注意[`=== false`as 检查`strpos()`](http://php.net/manual/en/function.strpos.php). 演示：[http](http://codepad.viper-7.com/0ZgNZq) ://codepad.viper-7.com/0ZgNZq 。

请注意，这仅检查空格，而不检查其他可能的空白字符。如果您想检查其他空白字符，我建议使用简单的正则表达式：

```
private function containsSpace($property)
{
    return (bool)preg_match('/\s/', $this->$property);
} 
```

最后，如果您真的想以原始方式进行操作，我会执行以下操作：

```
public function isValid()
{
    return strpos($this->email, " ") === false && strpos($this->confirm_password1, " ") === false && strpos($this->handle, " ") === false && strpos($this->phone, " ") === false;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T17:34:00.373

```
return (strpos($this->email, " ") === false && strpos($this->confirm_password1, " ")  === false && strpos($this->handle, " ") === false && strpos($this->phone, " ") === false) 
```

but this makes for fairly unreadable code...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-05T17:25:31.250

```
function isValid($var) {
  if (strpos($var, ' ') === false) {
    // Does not contain a space character.
    return true;
  }
  return false;
} 
```

# google-app-engine - AppEngine 中的任务名称墓碑化了多长时间？

> ID：13728828
> 
> 赞同：5
> 
> 时间：2012-12-05T17:21:54.093
> 
> 标签：google-app-engine

在 AppEngine 中将任务添加到队列时，任务名称在一定时间内不能重复使用（称为“墓碑”）。我在文档中找不到墓碑的持续时间或任何修改它的方法。

唯一在附近发生的事情是`TaskOptions.Builder.etaMillis()`，它设置了任务的预期持续时间（我不知道是为了什么）。这与墓碑持续时间之间没有记录的关系。

那么，有对此有见解的人吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-06T10:28:43.613

它是未定义的。这意味着开发人员不能设置它，也不能期望一个近似的墓碑持续时间值。

“一定时间”可以由GAE团队任意设置，也可以由系统动态设置。

如果您不想在特定时间内运行相同的任务，您应该真正为它构建自己的工作流实现。:)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-12-09T08:58:18.080

来自[官方任务队列文档](https://cloud.google.com/appengine/docs/python/taskqueue/)：

> 任务在成功执行或删除后立即删除，或在最大失败次数后立即删除。**然后可以在 10 天后重新使用任务名称**。**在这10 天内**尝试创建另一个具有相同名称的任务将导致“项目存在”错误。为避免任务名称重复使用问题，我们建议您让 App Engine 自动生成任务名称。

所以我觉得应该是10天

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-12-10T21:05:03.823

为什么要有限制。我想没有人能想象谷歌会重置 App Engine。因此，它是您申请的一部分，并且您是唯一支付账单的人。所以只要你付账....是我的答案。

另请参阅此功能请求：[http ://code.google.com/p/googleappengine/issues/detail?id=1774](http://code.google.com/p/googleappengine/issues/detail?id=1774)

# c - 更改控制台窗口中的现有文本

> ID：13728832
> 
> 赞同：1
> 
> 时间：2012-12-05T17:22:08.613
> 
> 标签：c, c99, c89, c11

有时，当我安装程序时，我会在控制台窗口（或其他动态变化的文本）中看到进度条。它显示，并在同一行字符串中更改。当我使用`printf`或其他功能时，我写下一个文本，但我不能在控制台窗口中修改已经存在的文本。我怎样才能通过C来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T17:24:17.410

这种效果最简单的方法是使用插入符返回`\r`字符，它可以让您覆盖上一行。

* * *

如果您想直接访问控制台的缓冲区（即在特定的 X/Y 位置而不是逐行写入），那么您可能正在寻找像`pdcurses`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-05T17:26:02.917

如果您想继续使用 printf 并轻松“*更改*”文本，请`\r`在 linux 上使用回车。但它不适用于 MAC，因为它意味着换行。

如果你这样做，我建议使用[ioctl](http://en.wikipedia.org/wiki/Ioctl)隐藏插入符号以防止闪烁和丑陋的效果。

如果您想要一种更好的方式来处理屏幕上的文本，您可以查看[ncurses](http://en.wikipedia.org/wiki/Ncurses)

# ios - 在 Core Audio 中解释 CAShow 的输出

> ID：13728835
> 
> 赞同：1
> 
> 时间：2012-12-05T17:22:14.530
> 
> 标签：ios, core-audio

我创建了一个简单的 AUGraph - 远程 IO、混音器和一个回调（将麦克风输入写入文件） - 但是我认为它的配置方式不是我想的那样。我正在尝试使用 CAShow() 来了解我实际创建的内容，但我正在努力将其输出与我认为我已配置的内容以及运行应用程序时实际发生的情况相协调。

我*相信*我的 AUGraph 包含以下连接（从扬声器到麦克风向后工作）：

*   混音器单元的输出总线连接到远程 IO 输出元件的输入总线
*   在混音器单元的输入上设置的回调
*   连接到回调的远程 IO 输入元素的输出总线

这是配置和初始化 AUGraph 后 CAShow() 的输出：

```
AudioUnitGraph 0x8EA7000:
  Member Nodes:
    node 1: 'auou' 'rioc' 'appl', instance 0xa87f530 O I
    node 2: 'aumx' 'mcmx' 'appl', instance 0xa880420 O I
  Connections:
    node   2 bus   0 => node   1 bus   0  [ 1 ch,  44100 Hz, 'lpcm' (0x0000000C) 16-bit little-endian signed integer]
  Input Callbacks:
    {0x28c0, 0xa87df40} => node   2 bus   0  [1 ch, 44100 Hz]
  CurrentState:
    mLastUpdateError=0, eventsToProcess=F, isRunning=F 
```

它似乎应该显示从远程 IO 输入元素的输出总线到回调的连接，但事实并非如此。我知道它正在工作，因为在启动 AUGraph 时我可以听到音频，并且我的回调正在按照设计将样本写入 ExtAudioFile。

我想我误解了关于 AUGraphs、Callbacks 或两者的基本知识。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T22:18:10.007

从 RemoteIO 输入（例如麦克风）到程序输入回调的连接完全在 AUGraph 外部，因此它不会显示在`CAShow()`输出中。就 AUGraph 而言，入口点是混音器的渲染回调，出口点是 RemoteIO 输出。AUGraph 不知道您的程序是如何布局的，以及在样本在其渲染回调中被馈送到混合器之前会发生什么。

在 ASCII 中（假设您使用的是环形缓冲区）：

```
Outside AUGraph                   Inside AUGraph
+-------------------------------+-----------------------------------------+
| RemoteIO Input -> Ring Buffer | Ring Buffer -> Mixer -> RemoteIO Output |
+-------------------------------+-----------------------------------------+ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T18:40:28.593

“连接到回调的远程 IO 输入元素的输出总线” - 你能解释一下你的意思吗？据我所知，这不是一件事，所以这似乎是你的问题所在。

在您的混音器输入回调中，您可以从 remoteIO 输入访问样本并将它们提供给混音器，但它们没有连接，至少就 AUGraph 而言。

如果您发布一些代码，我会更新答案。

# python - Django + MySQL：保存点不存在？

> ID：13728843
> 
> 赞同：6
> 
> 时间：2012-12-05T17:22:27.387
> 
> 标签：python, mysql, django

我正在共享托管计划上运行一个小型 Web 应用程序。我有一个包含无限循环的“工作函数”；循环检查数据库中的任务队列是否有新的事情要做。这需要使用`@transaction.commit_manually`以击败 Django 的缓存并在每次迭代中获取最新信息。

我最近实现了数据库日志记录，因此需要在我的工作函数中引入使用保存点 - 这样，如果出现任何问题，我可以回滚到一个好的保存点，登录到数据库，并继续直到我到达最终`transaction.commit()`

现在，与我的开发服务器不同，生产服务器给了我错误：

```
 DatabaseError: (1305, 'SAVEPOINT s140364713719520_x1 does not exist') 
```

指向块中的`transaction.savepoint_rollback()`调用`except`（参见下面的源代码）。开发服务器没有这样的问题；`transaction.savepoint()`如果我在交互式 shell 中键入，生产服务器会愉快地生成保存点 ID 。

[这是我的代码大纲](http://pastebin.com/FvWPbP20)，如果有帮助的话；我尽量保持简洁。

如果那里有任何仁慈的 Python 大师，请帮助我。我对此感到非常沮丧，尽管我认为我在以冷静的方式处理它方面做得相当好。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-14T12:34:53.117

我偶尔会遇到同样令人讨厌的错误：

```
OperationalError: (1305, 'SAVEPOINT {{name}} does not exist') 
```

谷歌搜索并没有让它更清楚，除了它是一种“正常”的并发问题。所以它是非确定性的，很难在开发环境中重现。

幸运的是，我能够通过使生产应用程序日志记录足够详细来对其进行本地化。

# 原因

在 MySQL 中，有一些操作可以隐式结束事务：

*   DDL 语句（例如`CREATE TABLE`,`ALTER TABLE`等）导致隐式提交。众所周知，MySQL 中的 DDL 不是事务性的，
*   `OperationalError: (1213, 'Deadlock found when trying to get lock; try restarting transaction')`并`OperationalError: (1205, 'Lock wait timeout exceeded; try restarting transaction')`导致隐式回滚。

所以第二种情况确实有点“正常”。它可以用以下代码表示：

```
# db is an example database connection object, which 
#   - supports nested (stacked) transactions, 
#   - has autocommit on.

db.begin() # START TRANSACTION
try:
  # no-conflict op
  db.update() 

  db.begin() # SAVEPOINT sp1
  try:
    # conflict op, 
    # e.g. attempt to change exclusively locked rows by another transaction
    db.update() 

    db.commit() # RELEASE SAVEPOINT sp1
  except:
    # Everything interesting happens here:
    #   - the change attempt failed with OperationalError: (1213, 'Deadlock...'),
    #   - the transaction is rolled back with all the savepoints,
    #   - next line will attempt to rollback to savepoint which no longer exists,
    #   - so will raise OperationalError: (1305, 'SAVEPOINT sp1 does not exist'),
    #   - which will shadow the original exception.

    db.rollback() # ROLLBACK TO SAVEPOINT sp1
    raise

  db.commit() # COMMIT 
except:
  db.rollback() # ROLLBACK
  raise 
```

# 更新

请注意，上述关于异常阴影的内容是针对 Python 2 进行的。Python 3 实现了[异常链接](https://www.python.org/dev/peps/pep-3134/)，并且在出现死锁的情况下，回溯将具有所有相关信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T21:01:00.560

如果您查看 Django 上与[Savepoints](https://docs.djangoproject.com/en/dev/topics/db/transactions/?from=olddocs#savepoints)相关的文档，则会提到并非所有[MySQL 存储引擎](http://dev.mysql.com/doc/refman/5.1/en/storage-engines.html)都支持它们。基本上 MyISAM 不处理事务，因此您不会回滚，而 InnoDB 可以。所以我会检查你的 dev 和 prod 表是否都使用相同的存储引擎类型。您可以通过运行检查这一点：

```
SHOW CREATE TABLE mytable 
```

# apache - 如何在 apache 上强制 SSL 重新协商以进行测试

> ID：13728852
> 
> 赞同：5
> 
> 时间：2012-12-05T17:23:01.610
> 
> 标签：apache, authentication, ssl, openssl, ssl-certificate

我有一个关于在使用 x509 客户端证书的网站上上传文件的应用程序的错误：当上传期间发生重新协商时，由于缓存很小（128kb），上传失败。

我需要使用 apache SSLRenegBufferSize 指令来更改缓存大小，但我想测试并且无法重现重新协商以检查一切是否正常。如何从浏览器或 apache 强制重新协商？

我已经找到了如何使用 openssl 来做到这一点：http: [//blog.ivanristic.com/2009/12/testing-for-ssl-renegotiation.html](http://blog.ivanristic.com/2009/12/testing-for-ssl-renegotiation.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T16:31:40.793

如果您需要从 apache 端强制 ssl 重新协商，您需要做的就是：

*   全局设置 https 加密
*   仅在特定‹location›块内需要客户端证书

**参考 ：**

[http://www.gossamer-threads.com/lists/apache/users/419072](http://www.gossamer-threads.com/lists/apache/users/419072)

“Apache HTTP Server 将在 SSL 会话已经建立的任何时候请求 SSL 重新协商，但是针对需要不同安全性的每个位置上下文发出请求——例如，如果您在目录或位置块中有 SSLVerifyClient 指令。”

# hadoop - 如何运行 Hbase Java 示例？

> ID：13728857
> 
> 赞同：9
> 
> 时间：2012-12-05T17:23:20.157
> 
> 标签：hadoop, hbase

我在运行简单的 Hbase 示例时遇到问题。

我在 HbaseTest.java 上创建了一个表并插入了一些记录。在 Unix 中，我可以编译 java 类。经过。

$javac -classpath hbase-0.94.2.jar:hadoop-core-1.0.4.jar HBaseTest.java

但我无法通过以下方式运行该程序：$java -classpath hbase-0.94.2.jar:hadoop-core-1.0.4.jar HBaseTest

上面的命令对我不起作用。不确定是什么问题？运行 Hbase Java 示例是正确的方法吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-05T17:50:44.143

您可以使用“hbase classpath”来获取所需的类路径。

```
    /*
     * 编译并运行：
     * javac -cp`hbase 类路径`TestHBase.java
     * java -cp `hbase 类路径` TestHBase
     */
    导入 org.apache.hadoop.conf.Configuration；
    导入 org.apache.hadoop.hbase.*；
    导入 org.apache.hadoop.hbase.client.*；
    导入 org.apache.hadoop.hbase.util.*；

    公共类 TestHBase {
        公共静态 void main(String[] args) 抛出异常 {
            配置 conf = HBaseConfiguration.create();
            HBaseAdmin 管理员 = 新 HBaseAdmin(conf);
            尝试 {
                HTable 表 = 新 HTable(conf, "test-table");
                Put put = new Put(Bytes.toBytes("test-key"));
                put.add(Bytes.toBytes("cf"), Bytes.toBytes("q"), Bytes.toBytes("value"));
                table.put(put);
            } 最后 {
                admin.close();
            }
        }
    }

```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-09-22T12:35:55.717

如果它无法运行，如果可能的话，您可以使用像 NetBeans 这样的 IDE 来开发 Java HBase 客户端 API 程序。

*   打开 NetBeans 后，转到 Tools=>Libraries 并单击“New Library”并为其命名，例如“MapReduce”。
*   给它一个名字，然后单击 Add JAR/Folder 并选择所需的 JAR 文件，通常在`/usr/local/hadoop-2.x.x/share/hadoop`hadoop 库和`/usr/local/hbase-1.x.x/lib`HBase 库下，通过导航文件系统浏览器（或只是导航到您的安装目录）。Shift+箭头键用于批量选择 jar 文件。
*   现在像往常一样创建一个新的 Java 项目，然后在“项目”窗格上右键单击它并转到“属性”。
*   现在单击 Libraries=>Add Library 并从显示的列表中选择您的库。鉴于所有进程都在运行，您现在应该可以编译并运行它们了。

# regex - mod_rewrite 编码正斜杠问题

> ID：13728859
> 
> 赞同：0
> 
> 时间：2012-12-05T17:23:25.887
> 
> 标签：regex, apache, mod-rewrite, url-rewriting

在创建我们的汽车电子商务商店时，我们命名了一些名称中带有正斜杠/Virgules 的产品（“/”），例如：`VOLKSWAGEN GOLF/GTI`. 电子商务引擎将此产品的 URL 重写为`GOLF%7B47%7DGTI`. 我们决定继续并改写我们所有的产品以使用世界“AND”而不是正斜杠/virgule。

我们在网络上有大量链接，我总是使用 mod_rewrite 来确保在我们更改产品命名约定后这些链接仍然有效。然而，这一个让我难住了！这是我正在尝试做的事情：

```
OLD URL: http://mystore.com/products/MK4-GOLF%7B47%7DGTI-KONI-STRUTS.html
NEW URL: http://mystore.com/products/MK4-GOLF-AND-GTI-KONI-STRUTS.html 
```

URL 的“MK4”部分可以是 Mk1、Mk2、Mk3、Mk4、Mk5 或 Mk6 中的任何一种，我们还为每一代 Golf/GTI 提供各种支柱。因此，我需要编写一个规则，将 URL 中的 Golf/GTI 替换为 GOLF-AND-GTI，并在目标字符串之前或之后保留任何内容。

我当前的（不正确的） RewriteRule 看起来像这样：

`RewriteRule ^products/(.*)-GOLF%7B47%7DGTI-(.*) http://www.mystore.com/products/$1-GOLF-AND-GTI-$2 [B,R,L]`

在过去的几个小时里，我一直在为此烦恼，但似乎无法制定工作规则。任何帮助将不胜感激！

非常感谢您的宝贵时间！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T18:09:42.777

作为`%7B47%7D`解码，`{47}`您可以按如下方式重写 URL：

```
RewriteRule ^products/(.*)-GOLF\{47\}GTI-(.*) http://www.mystore.com/products/$1-GOLF-AND-GTI-$2 [B,R=301,L] 
```

此外，由于您打算用新 URL 替换旧 URL，因此您应该使用 301 重定向而不是默认的 302。这是从 SEO 角度处理永久 URL 更改的[推荐方法](http://www.hochmanconsultants.com/articles/301-versus-302.shtml)。

# sql - SQLite 仅在表存在时删除

> ID：13728865
> 
> 赞同：7
> 
> 时间：2012-12-05T17:23:38.933
> 
> 标签：sql, database, sqlite

现在我有这个声明

```
DELETE FROM sqlite_sequence where name = 'table_name'; 
```

在大多数情况下都可以正常工作，但是现在我遇到了一个`sqlite_sequence`没有创建表的情况，所以我回来了

```
no such table: sqlite_sequence 
```

我需要一个仅在表存在时才执行删除的语句。我发现这个语句告诉我表是否存在

```
SELECT name FROM sqlite_master WHERE type='table'; 
```

但到目前为止，我一直无法成功地将它与删除语句配对

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-05T17:52:32.387

表存在检查应该包括名称，当然

```
SELECT count(*) FROM sqlite_master WHERE type='table' AND name='table_name'; 
```

但是您必须在单独的语句中从调用应用程序中执行此操作，即运行上述语句，并根据计数（自然 1=true，0=false）作为布尔值，您可以继续运行**DELETE**语句。

# c# - 如何从类文件中访问文本框

> ID：13728872
> 
> 赞同：1
> 
> 时间：2012-12-05T17:23:51.673
> 
> 标签：c#, class, textbox

在 C# 中，我想直接从页面访问文本框，而不将其作为变量发送给类，例如

### 文件 class.cs 代码

```
public class A {
    private string dosomething {
        string text;
        text = textbox1.text; 
        // textbox1 exists in, for example, default.aspx, and I need it's 
        // value in the class after some event occurred - let's say there 
        // is button and it was clicked 
    return text;
    }
} 
```

### default.aspx.cs 代码

```
protected void Button1_Click(object sender, EventArgs e) {
    A a = new A(); 
    // I need when this button clicked to fill the variable within
    // the class with the data given from the textbox within this page
} 
```

这是我想出的，但我不确定我是否以这种方式使用 getter 和 setter 走正确的道路：

```
private TextBox TextBox1 = new TextBox();
public string  settext {
    get { return TextBox1.Text; }
    set { TextBox1.Text = value;}
} 
```

但我总是收到一条`NullReferenceException was unhandled`消息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T17:29:34.980

将其添加到构造函数

```
A a = new A(this.TextBox1.Text);

public class A
{
    private String _Text;

    public A(String text){

       this._Text = text;
    }

} 
```

私有 _Text 变量只能由类在内部访问，但是如果您更改为`public`属性，则可以在创建实例后访问它

```
A a = new A(this.TextBox1.Text);
String text = a._Text; 
```

除此之外，如果它是一个公共变量，那么您只需创建实例并设置 _Text 并且不需要`public A(String text)`构造函数：

```
A a = new A();
a._Text = this.TextBox1.Text;
String seeIfSet = a._Text; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T11:45:55.817

我找到了我正在寻找的东西，它的工作方式就像魅力 [一样/asp-net-2-0-master-pages-changes-the-pages-control-hierarchy-level-300/](http://codebetter.com/jefferypalermo/2004/09/01/asp-net-2-0-master-pages-changes-the-pages-control-hierarchy-level-300/) 如果在没有母版页的情况下使用母版页相同的想法在我的情况下我正在使用母版页并且我对其进行了测试无论有无工作都很好

```
 private TextBox  gettextbox ( )
    {

        //without master page
           /*System.Web.UI.Page Default = (System.Web.UI.Page)System.Web.HttpContext.Current.Handler;
             TextBox TextBox1 = (TextBox)Default[0].FindControl("TextBox1");*/

        //with master page
       System.Web.UI.Page Default = (System.Web.UI.Page)System.Web.HttpContext.Current.Handler;
   ContentPlaceHolder cph = Default.Controls[0].FindControl("ContentPlaceHolder1") as ContentPlaceHolder;
           TextBox Textbox1 = (TextBox)cph.FindControl("TextBox1");
           return Textbox1;
    } 
```

# c# - 从 Web 服务返回自定义对象需要很长时间，为什么

> ID：13728875
> 
> 赞同：1
> 
> 时间：2012-12-05T17:23:57.187
> 
> 标签：c#, .net, web-services, return-value, custom-object

当我的 Web 服务返回一个自定义对象（仅包含四个字符串、三个整数和一个布尔值）时，它需要几秒钟（4-8 秒）。当同一台服务器以字符串形式发送相同的信息时，它几乎会立即发送。

如果重要的话，自定义对象类在同一个 Web 服务中定义。

我不认为它会有那么大的不同，还是我错过了一些基本的东西？

编辑：一些代码，我删除了一些变量以便于阅读。

Web 服务中定义的自定义类：

```
public class AddressSearchResult
{
    public AddressSearchResult()
    {
        Address = String.Empty;
        Country = String.Empty;
    }

    public AddressSearchResult(string address, string country)
    {
        Address = address;
        Country = country;
    }

    public string Address { get; set; }
    public string Country { get; set; }
} 
```

Web 服务上的两个 WebMethod 之间的唯一区别是返回语句：

WebMethod1 返回 obj

```
return new AddressSearchResult((string)address["address"], (string)address["country"]); 
```

WebMethod2 只返回一个字符串（只是为了表明我在这里做同样的事情）

```
return new AddressSearchResult((string)address["address"], (string)address["country"]).Address; 
```

接收端，控制台应用程序：

```
AddressSearchResult result = adrSerWS.method1("example", "yehaa"); //THIS IS SLOW
string result2 = adrSerWS.method2("example", "yehaa"); //THIS IS FAST 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T19:28:08.317

问题可能是对 Web 服务的第一次调用比后续调用花费的时间更长。尝试切换您在控制台应用程序中进行的服务方法调用的顺序，看看是否`method1`仍然是最慢的。

为什么第一次通话会更慢？一些想法： 1）在控制台应用程序中，第一个方法调用可能会触发Web服务代理中的一些初始化。这可能是您自己的代码或 .NET 中的内容。2) 在 IIS 空闲一段时间后，您可能会访问 Web 服务，因此它必须生成一个新的工作进程。3) 如果您正在运行带有附加调试器的控制台应用程序，请注意这可能会夸大最坏的性能。尝试在没有调试器的情况下运行。

# c - 在 C 中使用 void 指针修改原始文件

> ID：13728877
> 
> 赞同：0
> 
> 时间：2012-12-05T17:24:03.093
> 
> 标签：c, pointers, pass-by-reference, void, void-pointers

我试图通过引用将变量传递给`void`指针以更新原始值。当我尝试它时，旧值永远不会更新。任何帮助将不胜感激。 `gst_filter_chain`就像主函数 ( `Gstreamer`)

```
void update_value(void *oldValue, void *newValue)
{
    oldValue = newValue;
}

void update_struct(myStruct *oldStruct, myStruct newStruct)
{
    update_value((void *)&oldStruct->a, (void *)&newStruct.a)
}

static GstFlowReturn
gst_filter_chain (GstPad * pad, GstBuffer * buf)
{
    GstFilter *filter= GST_FILTER (gst_pad_get_parent (pad));
    myStruct temp_data;

    int buf_size = GST_BUFFER_SIZE(buf);     
    if(buf_size > 1) //if buffer is not empty
    {
        if(!filter->is_init)
        {
            memcpy(&filter->data, GST_BUFFER_DATA(buf), sizeof(myStruct));
            filter->is_init = TRUE;
        }
        else
        {
            memcpy(&temp_data, GST_BUFFER_DATA(buf), sizeof(myStruct));
            update_struct(&filter->data, temp_data);
        }
    }   

    gst_buffer_unref(buf);
    return GST_FLOW_OK;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-05T17:28:02.010

```
void update_value(void *oldValue, void *newValue)
{
    oldValue = newValue;
} 
```

在这个片段中，您只更新指针变量，而不是它指向的值。您必须取消引用指针才能访问实际数据。如果您想要一个真正通用的 setter 解决方案，您可以使用 memcpy，但您需要将 size 参数传递给 update_value，以告诉 memcpy oldValue 和 newValue 指向的数据类型的大小是多少。

```
void update_value(void *oldValue, void *newValue, size_t dataSize)
{
    memcpy(oldValue, newValue, dataSize);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-05T17:26:59.110

我没有阅读整个代码，但是这个函数什么都不做：

```
void update_value(void *oldValue, void *newValue)
{
    oldValue = newValue;
} 
```

`oldValue`和都是`newValue`保存内存地址的局部变量。由于删除了局部变量，因此在函数退出时失去了赋值效果。

**更新**

可能您希望用' 更新`oldStruct`' 字段。然后你的功能看起来像`a``newStrcut``update_struct`

```
void update_struct(myStruct *oldStruct, myStruct newStruct)
{
    oldStruct->a = newStruct.a;
} 
```

由于`oldStruct`是一个指向结构的指针，存在于某个地方，赋值会影响它。

不幸的是，我不知道`a`会员的类型。

**更新 2**

您也可以通过指针发送第二个结构来节省处理时间：

```
void update_struct(myStruct *oldStruct, myStruct *newStruct)
{
    oldStruct->a = newStruct->a;
} 
```

# python - 在 Json 中将多个变量转储到磁盘。每行一个变量

> ID：13728878
> 
> 赞同：0
> 
> 时间：2012-12-05T17:24:03.967
> 
> 标签：python, json

假设我想使用 Json 将多个变量转储到磁盘。我通常这样做的方法是将我的变量创建为字典中的条目，然后将字典转储到磁盘：

```
with open(p_out, 'wb') as fp:
    json.dump(my_dictionary, fp) 
```

这将创建一个 json 文件，其中字典保存在很长的一行中：

```
{"variable_1": something, "variable_2" something_else, ...} 
```

我不喜欢。我希望将我的变量转储到文本文件中，每行一个变量，例如以下几行：

```
{variable_1: something\n
 variable_2: something\n
 variable_3: something_else} 
```

有没有办法在 Python 中使用 Json 来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T17:25:52.897

将`indent`选项设置为`0`或更多：

```
with open(p_out, 'wb') as fp:
    json.dump(my_dictionary, fp, indent=0) 
```

从[文档](http://docs.python.org/2/library/json.html#json.dump)中：

> 如果*indent*是一个非负整数，那么 JSON 数组元素和对象成员将使用该缩进级别进行漂亮的打印。缩进级别 0 或负数只会插入换行符。`None`（默认）选择最紧凑的表示。

您的示例将输出为：

```
{
"variable_2": "something_else", 
"variable_1": "something"
} 
```

# unix - 从文件中grep，打印匹配和不匹配

> ID：13728883
> 
> 赞同：1
> 
> 时间：2012-12-05T17:24:14.183
> 
> 标签：unix, sed, grep, pattern-matching, csh

我有一个文件，比如输入，包含如下模式：

```
quantum_mech_.*
astrophysics_.*
geology_.*
economy_* 
```

我有另一个文件，比如主题，它看起来像：

```
quantum_mech_[101]
astrophysics_[102]
geology_[203]
quantum_mech_[007]
geology_[205] 
```

我想从输入文件中查找每一行并搜索文件“主题”并仅输出第一个匹配项，如果在主题文件中根本找不到该行，则还打印“不匹配”。所以我期待这样的输出：

```
quantum_mech_[101]
astrophysics_[102]
geology_[203]
Not Matched 
```

我知道这是一个很老的问题，但似乎没有一种方法适合我。我尝试了以下代码的几种变体：

脚本.csh：

```
cat $1 | while read line
do grep $line ./subject | head -1 >> output
set VAR=$?
if ( $VAR==0 ) then 
        echo "Not Matched\n" >> output
endif
done 
```

运行方式：

```
 script.csh input 
```

任何使用 sed/grep/csh 的帮助/指针都会很棒。

谢谢并恭祝安康，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T01:27:24.807

除了文本“Not Matched”之外，这将打印每个不匹配的 RE，以便您知道哪些 RE 不匹配：

```
$ awk '
NR==FNR{ a[$0]; next }
{ for (re in a) if ($0 ~ re) { print; delete a[re] } }
END{ for (re in a) print re, "Not Matched" }
' file1 file2
quantum_mech_[101]
astrophysics_[102]
geology_[203]
economy_* Not Matched 
```

它适用于 file1 中的任何 RE 和 file2 中的任何值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T23:52:31.277

这是一种使用方法`awk`：

```
awk -F "[.*[]" 'FNR==NR && !($1 in a) { a[$1]=$2 } FNR!=NR { print ($1 in a) ? $1 "[" a[$1] : "Not Matched" }' subjects input 
```

结果：

```
quantum_mech_[101]
astrophysics_[102]
geology_[203]
Not Matched 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-06T04:22:26.773

这在 csh 和 bash 中运行良好。

```
for line in `cat $1`;
do
  grep -m1 $line ./subject || echo "Not matched"
done >> output 
```

感谢 dogbane 的指针，下面是一个更好（和正确）的方法来做同样的事情。当行中有空格时，上述内容也存在问题。

```
while read line 
do
  grep -m1 "$line" ./subject || echo "Not matched"
done < $1 >> output 
```

# drupal - 在 drupal 7 中使用 Views Bulk Operations 更改产品的销售价格？

> ID：13728890
> 
> 赞同：1
> 
> 时间：2012-12-05T17:24:24.543
> 
> 标签：drupal, views, ubercart

我是视图批量操作模块的新手。我希望能够通过计算成本价来更改属性的售价。

1.  在 VBO 中选择节点（ubercart 产品）
2.  选择并执行任意 PHP 脚本 - 编写！
3.  通过应用脚本，完成了以下更改：
    *   在表 'uc_product_options' 中，每个属性的参数 'price' 计算为 ('price' = 'cost' *1.2)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T18:39:29.437

幸运的是有人打败了你:)

[Ubercart 产品操作](http://drupal.org/project/uc_product_actions)

> 如果您的商店中有很多产品，并且您曾经想要执行以下任何操作，那么此模块肯定会有所帮助：
> 
> *   将您商店中部分/所有产品的价格降低 20%，或
> *   手动将部分/所有产品的重量设置为 0，或
> *   将您商店中部分/所有产品的价格提高 3 美元

如果该模块没有您正在寻找的操作的确切组合，只需查看代码，应该很容易找出如何根据您的需要进行调整。

# svn - svn的结构

> ID：13728891
> 
> 赞同：0
> 
> 时间：2012-12-05T17:24:27.600
> 
> 标签：svn

我有 5 个人的小项目。我有一些问题：

*   我应该使用分支标签和主干结构吗？

*   什么是小型项目的有效目录层次结构？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T17:27:59.810

没有理由不使用分支/标签/主干，因为最坏的情况是你有两个空目录，最好的情况是你会发现它很有用。

主干中的适当目录结构通常由您使用的技术决定，而不是源代码控制。

# php - WSDL 中不存在 NuSoap 操作

> ID：13728892
> 
> 赞同：3
> 
> 时间：2012-12-05T17:24:30.230
> 
> 标签：php, web-services, nusoap

我必须使用Oracle制作的Web服务，我测试了我找到的所有NuSoap示例，但都没有工作，我得到的错误是：

> WSDL 中不存在 GetMsisdnPortabilityInfoRequest 操作

GetMsisdnPortabilityInfoRequest 是我必须调用的操作的名称，请求必须如下所示：

```
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:v1="http://www.tigo.com/GetMsisdnPortabilityInfoRequest/V1" xmlns:v11="http://www.tigo.com/Core/Common/Header/Request/V1" xmlns:v12="http://www.tigo.com/ParameterType/V1">
   <soapenv:Header/>
   <soapenv:Body>
      <v1:GetMsisdnPortabilityInfoRequest>
         <v11:RequestHeader>
            <v11:Consumer code="WEBTIGO" name="WEBTIGO">
            </v11:Consumer>
            <v11:Transport code="WS" name="WS">
               <v11:communicationType>SYN</v11:communicationType>
            </v11:Transport>
            <v11:Service code="1" name="1">
            </v11:Service>
            <v11:Message messageId="1" messageIdCorrelation="1" conversationId="1">
            </v11:Message>
            <v11:Country name="PY" isoCode="600"/>
         </v11:RequestHeader>
         <v1:requestBody>
            <v1:msisdn>0961123456</v1:msisdn>
         </v1:requestBody>
      </v1:GetMsisdnPortabilityInfoRequest>
   </soapenv:Body>
</soapenv:Envelope> 
```

我必须发送的唯一参数是 msindn，我的代码如下所示：

```
require_once('lib/nusoap.php');

$url = "http://10.16.210.128/sbresource?PROXY/Portability/Gateway/PS/PS_GetMsisdnPortabilityInfo";  
$headers_raw = '<v11:RequestHeader>
        <v11:Consumer code="WEBTIGO" name="WEBTIGO">
        </v11:Consumer>
        <v11:Transport code="WS" name="WS">
           <v11:communicationType>SYN</v11:communicationType>
        </v11:Transport>
        <v11:Service code="1" name="1">
        </v11:Service>
        <v11:Message messageId="1" messageIdCorrelation="1" conversationId="1">
        </v11:Message>
        <v11:Country name="PY" isoCode="600"/>
     </v11:RequestHeader>';

$body_raw_xml = '<v1:msisdn>0961123456</v1:msisdn>';

$client = new nusoap_client($url, true);

$err = $client->getError();
if ($err) {
  echo '<h2>Constructor error</h2><pre>' . $err . '</pre>';
  echo '<h2>Debug</h2><pre>' . $client->getDebug() . '</pre>';
  exit();
}            

$result = $client->call('GetMsisdnPortabilityInfoRequest', $body_raw_xml, '', '',  $headers_raw, null);

if ($client->fault) {
  echo '<h2>Fault (Expect - The request contains an invalid SOAP body)</h2><pre>'; print_r($result); echo '</pre>';
} else {
  $err = $client->getError();
  if ($err) {
    echo '<h2>Error</h2><pre>' . $err . '</pre>';
  } else {
    echo '<h2>Result</h2><pre>'; print_r($result); echo '</pre>';
  }
}

echo '<h2>Request</h2><pre>' . $client->request . '</pre>';
echo '<h2>Response</h2><pre>' . $client->response . '</pre>';
echo '<h2>Debug</h2><pre>' . $client->getDebug() . '</pre>'; 
```

完整的 WSDL 在[https://gist.github.com/f55472fe9181856b30de](https://gist.github.com/f55472fe9181856b30de) （网络服务在本地网络上，外部无法访问，我已经更改了“example”和“example2”的原始域以保护无辜的服务器）

我也尝试过这种方式，但总是说**操作 GetMsisdnPortabilityInfoRequest 不存在于 WSDL**

```
$params = array('v1:msisdn' => $number);

$result = $client->call('V1:GetMsisdnPortabilityInfoRequest', $params, '', '', $headers_raw); 
```

我做错了什么？我想知道我必须如何发送请求。

提前致谢！

**编辑**

正确的操作名称是“process”，最终代码如下所示：

```
$raw_xml = '<v1:GetMsisdnPortabilityInfoRequest>
       <v11:RequestHeader>
          <v11:Consumer code="WEBTIGO" name="WEBTIGO">
          </v11:Consumer>
          <v11:Transport code="WS" name="WS">
             <v11:communicationType>SYN</v11:communicationType>
          </v11:Transport>
          <v11:Service code="1" name="1">
          </v11:Service>
          <v11:Message messageId="1" messageIdCorrelation="1" conversationId="1">
          </v11:Message>
          <v11:Country name="PY" isoCode="600"/>
       </v11:RequestHeader>
       <v1:requestBody>
          <v1:msisdn>' . $full_number . '</v1:msisdn>
       </v1:requestBody>
    </v1:GetMsisdnPortabilityInfoRequest>';    

// cliente del soap
$client = new nusoap_client($url, true);  

$err = $client->getError();
if ($err) {
  echo json_encode(array('status' => $err));
  exit();
}            

// realizamos la consulta al webservice, nombre método consultado = process
$result = $client->call('process', $raw_xml); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T14:57:49.590

尝试仅调用**GetMsisdnPortabilityInfo**而不是*GetMsisdnPortabilityInfo****请求***或*GetMsisdnPortabilityInfo****响应***

# python - python在线表格（例如反馈）不起作用

> ID：13728893
> 
> 赞同：0
> 
> 时间：2012-12-05T17:24:30.650
> 
> 标签：python, forms, cgi

我正在学习 python，所以我从一本书中得到了这个练习：这是一个 html 表单：

```
<html>
  <body>
    <form method=POST action="cgi-bin/cgi101.py">
      <P><b>Enter your name:</b>
      <P><input type="text name=user" />
      <P><input type="submit" />
    </form>
  </body>
</html> 
```

这是要调用的脚本：

```
#!/usr/bin/python3
import cgi
form = cgi.FieldStorage()
# parse form data
print('Content-type: text/html\n')
# hdr plus blank line
print('<title>Reply Page</title>')
# html reply page
if not 'user' in form:
  print('<h1>Who are you?</h1>')
else:
  print('<h1>Hello <i>%s</i>!</h1>' % cgi.escape(form['user'].value)) 
```

按照逻辑，如果我输入用户，它必须打印

# 你好用户

. 但它给了

# 你是谁？

反而。这意味着脚本在表单中看不到用户。为什么？apache 中允许 cgi/py 脚本用于 cgi-bin/。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T17:27:48.470

你这里有一个错字：

```
<input type="text name=user" /> 
```

这实际上应该是这样的：

```
<input type="text" name="user" /> 
```

type 和 name 是输入 HTML 标记上的每个属性。它们将始终采用的形式是：

```
<sometag attribute1="a thing" attribute2="another thing" /> 
```

请注意引号和等号的位置。一个出色的语法高亮文本编辑器将帮助您的眼球更清楚地看到这一点。

# c# - 为具有多种类型的变量重载方法的更简单方法？

> ID：13728895
> 
> 赞同：3
> 
> 时间：2012-12-05T17:24:36.047
> 
> 标签：c#

我无法通过搜索找到答案，但也许我问的方式不对。我有一个包含大量矩阵类型函数的程序，这些函数接受 3D 矩阵（以 1D-2D 锯齿状数组的形式）并对元素执行函数。然而，我经常需要使用相同的函数，但使用不同类型的参数：int[][,] 和 float[][,] 和 double[][,]。

到目前为止，我只是重写了相同的方法，但改变了类型，但我有很多这样的东西，不断重写“重新输入”的方法真的很痛苦。

```
private float SomeFunctionA(float[][,] d)
{
    float sum = 0; 
    for (int k = 0; k < d.GetLength(0); k++)
        for (int j = 0; j < d[0].GetLength(1); j++)
            for (int i = 0; i < d[0].GetLength(0); i++)
                 sum += d[k][i,j];
    return SomeFunctionB(sum);
}

private float SomeFunctionA(double[][,] d)
{
    double sum = 0; 
    for (int k = 0; k < d.GetLength(0); k++)
        for (int j = 0; j < d[0].GetLength(1); j++)
            for (int i = 0; i < d[0].GetLength(0); i++)
                 sum += d[k][i,j];
    return SomeFunctionB(sum);
} 
```

有没有更简单的方法来允许不同的类型？如果有一种方法可以拥有一个具有该功能的通用 main 方法（即 3 个 for 循环和其他主体代码），然后是采用不同类型并为每种情况调用通用方法的辅助方法，那就太好了。

谢谢大家。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T17:28:44.207

不幸的是，对于这些基本的数字类型，并非如此。他们没有实现定义`+`运算符的接口。您尝试使用反射、动态、传入求和/聚合函数等进行的任何操作都会导致相当大的性能成本。由于诸如此类的矩阵运算在性能非常密集的环境中如此频繁地完成，因此代码的减少很少值得为泛化这些方法付出代价。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-05T17:29:01.920

您可以使用通用函数并传递委托来聚合和处理结果。正如 Servy 所说，代表的成本可能很高。您需要衡量并查看以下基本方法是否适合您。如果这些操作的性能很重要，那么保留单独的版本是很好的方法。您还可以检查使用 Jon Skeet 对[通用运算符](http://www.yoda.arachsys.com/csharp/miscutil/usage/genericoperators.html)的 MiscUtil 支持是否可以获得可接受的性能。

```
private T SomeFunctionA<T>(T[][,] d, Func<T, T, T> aggregate, Func<T,T> postProcess)
{
    T sum = default(T); 
    for (int k = 0; k < d.GetLength(0); k++)
        for (int j = 0; j < d[0].GetLength(1); j++)
            for (int i = 0; i < d[0].GetLength(0); i++)
                 sum = aggreagate(sum, d[k][i,j]);
    return postProcess(sum);
} 
```

`aggregate`（在 LINQ 术语中，其他通用名称“reduce”）是执行原始“sum”，类似于[Enumerable.Aggregate](http://msdn.microsoft.com/en-us/library/bb549218.aspx)具有签名的更通用版本`Func<TAccumulate, TSource, TAccumulate>`。`postProcess`只是抽象处理结果和代码可以通过调用通用版本来重写，`SomeFunctionB`如果存在的话。对于原始代码用法将是：

```
 SomeFunctionA<float>((sum, current) => sum + current, SomeFunctionB); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-05T17:37:28.703

C# 泛型中没有运算符约束，所以我将使用下一个：

```
 private interface ICalculator<T>
    {
        T Add(T x, T y);
        // you may want to add more operations here
    }

    private class Int32Calculator: ICalculator<int>
    {
        public int Add(int x, int y)
        {
            return x + y;
        }
    }

    private int Int32SomeFunction(int [][,] d)
    {
        return SomeFunction<int>(d, new Int32Calculator());
    }

    private T SomeFunction<T>(T[][,] d, ICalculator<T> calculator)
        where T : struct 
    {
        T sum = default(T);
        for (int k = 0; k < d.GetLength(0); k++)
            for (int j = 0; j < d[0].GetLength(1); j++)
                for (int i = 0; i < d[0].GetLength(0); i++)
                    sum = calculator.Add(sum, d[k][i, j]);
        return sum;
    } 
```

对于这个解决方案，您可以创建更多的类，但在这种情况下您可以支持任何运算符（不仅是 +）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-05T17:51:07.627

为什么不使用文本模板？

创建一个名为“Overloads.tt”的新文件：

```
<#@ template debug="false" hostspecific="false" language="C#" #>
<#@ assembly name="System.Core" #>
<#@ import namespace="System.Linq" #>
<#@ import namespace="System.Text" #>
<#@ import namespace="System.Collections.Generic" #>
<#@ output extension=".cs" #>
using System;

namespace MyNamespace 
{
  public partial class Generated 
  {
  <# 
    var desiredTypes = new[] { "int", "float", "double" };
    foreach(var type in desiredTypes) {
  #>
  private <#=type#> SomeFunctionA(<#=type#>[][,] d)
  {
      <#=type#> sum = 0; 
      for (int k = 0; k < d.GetLength(0); k++)
          for (int j = 0; j < d[0].GetLength(1); j++)
              for (int i = 0; i < d[0].GetLength(0); i++)
                    sum += d[k][i,j];
      return SomeFunctionB(sum);
  }

  private <#=type#> SomeFunctionB(<#=type#> input)
  {
    return default(<#=type#>);
  }

  <# } #>
  }
} 
```

当你保存它时，会弹出`Overloads.cs`- 使用你所有的方法。

这也类似于 C++ 模板的工作方式。

几点注意事项：

该行`var desiredTypes = new[] ....`创建了一个字符串数组，然后用于驱动生成重载方法的循环。

生成类是有意义的，`partial`这样您就可以混合更传统的代码。

# python - 用两个 pandas DataFrame 将 NaN 值替换为实际值

> ID：13728896
> 
> 赞同：1
> 
> 时间：2012-12-05T17:24:41.813
> 
> 标签：python, pandas

假设我有两个 DataFrame a & b，其中 a 大于 b 并且具有所有 NaN。b.index 是 a.index 的子集，但是 b 具有实数值。我希望将 b 中的值合并到 a 中。

```
In [102]: mset

Out[102]: 
<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 9446 entries, 2012-11-02 07:00:00 to 2012-11-05 15:24:00
Data columns:
open     9207  non-null values
high     9207  non-null values
low      9207  non-null values
close    9207  non-null values
dtypes: float64(4)

In [103]: a
Out[103]: 
<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 1440 entries, 2012-11-14 00:00:00 to 2012-11-14 23:59:00
Freq: T
Data columns:
open     0  non-null values
high     0  non-null values
low      0  non-null values
close    0  non-null values
dtypes: float64(4) 
```

有一个数据框是什么样子的例子。

编辑：

我也想保留索引

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T17:56:22.500

您的示例数据框与“b.index 是 a.index 的子集，但 b 具有实际值”的语句*不匹配。*日期不重叠。然而：

这适用于整数索引，不知道 ts 索引：

```
a.ix[a.index] = mset.ix[a.index] 
```

# r - 如何创建在 R 中垂直排列的值频率组合表

> ID：13728898
> 
> 赞同：2
> 
> 时间：2012-12-05T17:21:36.073
> 
> 标签：r, frequency

如何创建垂直排列的值频率组合表，

```
> df = data.frame(fruit=c("apple", "banana", "cherry", "cherry", "apple", "banana", "apple", "date"));
> table(df$fruit)

 apple banana cherry   date 
     3      2      2      1 
```

到目前为止，一切都很好。但我想要这样的东西（例如，基于频率的基本操作和值的子集）：

```
Fruit   Freq
"apple"   3
"banana"  2
"cherry"  2
"date"    1 
```

在 SQL 中，这将是`SELECT fruit, COUNT(*) AS Freq FROM df GROUP BY fruit`，并且会产生一个类似于此问题起点的表： [https ://stats.stackexchange.com/questions/15574/how-to-convert-a-frequency-table-into-值向量](https://stats.stackexchange.com/questions/15574/how-to-convert-a-frequency-table-into-a-vector-of-values)

**在R**中是否有一种简单的方法可以做到这一点？（或者，这是否表明思维方式过于“SQL”而“R”不够？）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-05T17:27:05.013

```
data.frame(table(df))
#       df Freq
# 1  apple    3
# 2 banana    2
# 3 cherry    2
# 4   date    1 
```

也许

```
setNames(data.frame(table(df)), c("Fruit", "Freq"))
#    Fruit Freq
# 1  apple    3
# 2 banana    2
# 3 cherry    2
# 4   date    1 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-05T17:27:32.220

仅使用base R，您可以将其转换为一个矩阵，该矩阵将是面向列的，其值作为row.names。

```
as.matrix(table(df)) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-05T17:26:29.653

使用`melt`reshape2 包中的函数

```
DF <- table(df$fruit)

library(reshape2)
melt(DF)
colnames(result) <- c('Fruit', 'Freq')
result

  Fruit Freq
1  apple    3
2 banana    2
3 cherry    2
4   date    1 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-06T09:28:51.443

只是添加一个不同的答案：

```
df = data.frame(fruit=c("apple", "banana", "cherry", "cherry", "apple", "banana", "apple", "date"));
df
   fruit
1  apple
2 banana
3 cherry
4 cherry
5  apple
6 banana
7  apple
8   date
freq <- unlist(lapply(unique(df$fruit),function(x) length(which(df$fruit ==x))))

freq
[1] 3 2 2 1
df.new <- data.frame(fruits = unique(df$fruit),freq)
df.new
  fruits freq
1  apple    3
2 banana    2
3 cherry    2
4   date    1 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-06T04:38:16.283

如果你想坚持 SQL 思维方式，总有“ `sqldf`”包！

```
df = data.frame(fruit=c("apple", "banana", "cherry", "cherry", 
                        "apple", "banana", "apple", "date"))
library(sqldf)
sqldf("SELECT fruit, COUNT(*) AS Freq FROM df GROUP BY fruit")
#    fruit Freq
# 1  apple    3
# 2 banana    2
# 3 cherry    2
# 4   date    1 
```

那里！你已经知道答案了；）

# inno-setup - 安装后的 PowerShell 脚本

> ID：13728902
> 
> 赞同：4
> 
> 时间：2012-12-05T17:25:02.450
> 
> 标签：inno-setup

新手问题：我想在 inno-setup 安装结束时运行一个 powershell 脚本 (.ps1)。任何人都可以给我一个关于把这个放在哪里的提示吗？我希望提示用户询问他是否要运行此脚本。

哦，是的，这个脚本的作用是运行 netsh.exe 来打开一个端口，这个脚本很聪明，它从当前上下文中获取 Env:username 和 Env:userdomain。上下文会是运行设置的管理员吗？还是运行 setup.exe 的原始用户？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2017-09-25T18:30:53.103

另一种方法是使用`ShellExec`代码运行脚本。

```
[Files]
Source: "yourPowershell.ps1"; DestDir: "{app}"; Flags: overwritereadonly replacesameversion promptifolder;

[Tasks]
Name: "runpowershell"; Description: "Do you want to run Powershell script?"

[Code]

procedure CurStepChanged(CurStep: TSetupStep);
var
  ErrorCode: Integer;
  ReturnCode: Boolean;
begin
  if CurStep = ssPostInstall then begin

    if(IsTaskSelected('runpowershell')) then begin
      ExtractTemporaryFile('yourPowershell.ps1');
      ReturnCode := ShellExec('open', '"PowerShell"', ExpandConstant(' -ExecutionPolicy Bypass -NoLogo -NonInteractive -NoProfile -WindowStyle Hidden  -File "{tmp}\YourPowershell.ps1"'), '', SW_SHOWNORMAL, ewWaitUntilTerminated, ErrorCode);

    if (ReturnCode = False) then
        MsgBox('Message about problem. Error code: ' + IntToStr(ErrorCode) + ' ' + SysErrorMessage(ErrorCode), mbInformation, MB_OK);

  end;
end; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-06T09:07:56.903

```
[Run]
.....; Description: Run Script; Flags: postinstall 
```

（有关更多详细信息，请参阅帮助。）默认情况下，这将显示一个复选框并在原始用户的上下文中运行（尽管它取决于安装程序的运行方式）。

不过，您可能需要重新考虑这种方法；如果您正在执行机器范围的安装，那么您可能也应该在机器范围内打开端口。您可以使用调用 WinAPI 的纯 Inno 代码来执行此操作——无需 powershell。（这是一件好事，因为它可能没有安装。）

或者，如果您想将其保留为每个用户的设置，您应该考虑让您的应用程序提示用户在首次运行时做出决定。毕竟，为什么只给应用程序的众多可能用户中的一个用户提供选项呢？

# jquery - 使用 href='/subpage' 滚动到页面的一部分，而不是 href='#foo' （JQuery？）

> ID：13728904
> 
> 赞同：5
> 
> 时间：2012-12-05T17:25:04.167
> 
> 标签：jquery, html, ajax, seo, scroll

如果您在此处查看[http://www.mcgarrybowen.com/en/](http://www.mcgarrybowen.com/en/)并单击顶部导航菜单，页面将滚动到您单击的页面部分。

这通常是用 完成的`href='#foo'`，但这里是`href='/subpage'`。滚动动画在 jQuery 中没有问题，但我认为魔法可能发生在 AJAX 上，我对此一无所知。

更有趣的是，地址栏与这些 href 值同步；如果我导航到[http://www.mcgarrybowen.com/en/people](http://www.mcgarrybowen.com/en/people)，页面加载然后为我滚动，但如果我手动滚动地址栏更新到当前子页面。

这是怎么做的？有什么特别的理由使用这个，比如搜索引擎优化？

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T17:37:59.883

这不使用 AJAX，因为不需要进一步的请求来实现此功能。这里似乎有两个方面：滚动到所需`section`的位置并根据当前位置更新 URL。

正如 Alex 指出的那样，滚动似乎是由 PageScroller.js 库处理的。我不能说我熟悉这个特定的脚本，但是通过查看导航链接的来源，您可以看到它们包含`nav-item-id`与它们“链接”到的部分相对应的数据。例如

关于链接：

```
<a data-nav-item-id="9D8C69C00E8E43D39F18F1B78F073554" href="/en/About">About</a> 
```

关于部分：

```
<section id="about" class="about" data-omgb-item-id="9D8C69C00E8E43D39F18F1B78F073554">
     (content)
</section> 
```

我建议在导航链接上只设置一个单击事件的侦听器，以防止默认行为并改为滚动到相关部分。

至于基于您正在查看的部分的 URL 更新，这似乎由[ScrollSpy](http://twitter.github.com/bootstrap/javascript.html#scrollspy)处理，它是 Twitter Bootstrap 的一部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T17:38:11.450

基本上他所做的是获取与页面上的部分数量相匹配的导航中项目的长度。然后，他根据单击的导航项获取该部分的位置。

# c++ - C++ 2D 动态数组分配

> ID：13728920
> 
> 赞同：0
> 
> 时间：2012-12-05T17:26:10.060
> 
> 标签：c++, arrays, pointers, dynamic, multidimensional-array

我有一个`float**`包含`num_rows`行和`num_cols`列的数组。我想确定 0-9 列之间每个数字的出现次数。为此，我想到了使用另一个 size 的二维数组`[10][num_cols]`，这样对于每一列，对应于一个元素的数字就是原始表中该数字的出现次数。示例：如果原始表包含`1 2 3 1 1`在第五列中，那么在第二列中，值应类似于：`1-> 3, 2 -> 1, 3 -> 1`.

我尝试按如下方式使用该函数，但它给了我一个指针错误。我尝试使用向量，但这也没有带来任何运气。

```
int ** attribute_count(float * * input, int row_num, int col_num) {
    int ** arr_2 = new int * [10];
    int * arr = new int[10 * col_num];
    int counter = 0;

    for (int i = 0; i < 9; i++) {
        for (int j = 0; j < col_num; j++) {
            arr_2[i][j] = 0;
        }
    }

    for (int i = 0; i < 9; i++) {
        for (int j = 0; j < col_num; j++) {
            int temp = input[i][j];
            arr_2[temp][j]++;
        }
    }
    return arr_2;
} 
```

编辑：我试过你的建议。新代码是：

```
 int** attribute_count(float** input, int row_num, int col_num) {
    int** arr_2 = new int* [10];
    int* arr = new int[10 * col_num];
    int counter = 0;

    for (int i = 0; i < 11; i++) {
        for (int j = 0; j < col_num; j++) {
            arr_2[i] = new int[col_num];
        }
    }

    for (int i = 0; i < 11; i++) {
        for (int j = 0; j < col_num; j++) {
            int temp = input[i][j];
            arr_2[temp][j]++;
        }
    }
    return arr_2;
} 
```

这仍然给我记忆错误。该函数在 .cpp 中被调用，如下所示：

```
int** attr = attribute_count(training_data, 10, num_cols_train);
    cout<<attr[5][1]; 
```

知道我现在做错了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T17:30:50.583

arr_2 被定义并分配为指向 int 的指针数组，但您实际上并没有分配/分配这些指针。

这是纠正代码的尝试-但是我不相信您有正确的行和列...

```
int ** attribute_count(float ** input, int row_num, int col_num)
{
int ** arr_2 = new int * [10];

    for (int i = 0; i < 10; i++)
    {
        arr_2[i] = new int[col_num];
        for(int j = 0 ; j < col_num ; j++)
        {
            arr_2[i][j] = 0;
        }
    }

    for (int i = 0; i < row_num; i++)
    {
        for (int j = 0; j < col_num; j++)
        {
            int temp = input[i][j];
            arr_2[temp][j]++;
        }
    }
    return arr_2;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T17:32:34.883

您只分配了`arr_2`. 您需要循环并在每个整数上分配一个整数数组以获得第二维。

编辑：另外，怎么了`arr`？你分配它，从不使用它，不要归还它，也不要释放它。这就是我们拼写内存泄漏的方式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-05T17:33:15.913

I think your problem is in incorrect allocation of the 2D array. Try

```
int ** arr_2 = new int* [row_num];
for (int i = 0; i < row_num; i++)
    arr_2[i] = new int[col_num]; 
```

# angularjs - AngularJS orderBy 函数在 ng-repeat 中被忽略

> ID：13728922
> 
> 赞同：2
> 
> 时间：2012-12-05T17:26:16.600
> 
> 标签：angularjs

orderBy 函数被完全忽略。我在某一时刻添加了一个 console.log 进行测试，甚至没有调用该函数。数据仍然显示，但无序。

HTML 代码

```
<div id="tabs">
    <a ng-repeat="tab in tabs | orderBy:tabordinal" id="tab-{{tab.tab_id}}" class="{{getClasses(tab)}}" ng-click="tabclick(tab)">{{tab.label}}</a>
</div> 
```

JS函数

```
$scope.tabordinal = function (tab) {
    return $scope.taborder.indexOf(tab.tab_id);
}; 
```

其他一切都设置正确，（即 ng-click 正常工作，数据正确绑定，过滤器正在处理其他元素。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-05T17:34:49.240

A few things...

1.  `orderBy` takes a string, or an expression that returns a string. That string should be the name of a property you want to order by on the list of objects you're ordering. So if the objects in your array have properties like `[ { 0: 'foo', 1: 'bar', '2': 'blah' } ]`, then you're good to go, I guess. But I doubt they're structured like that.
2.  `orderBy:tabOrdinal()` if your expression is a function, as yours is in the original post, you need that `()`.

Outside of that, if you provide a fiddle, I can give you more help.

# actionscript-3 - 如何最大化 spark.components.Callout？附上截图

> ID：13728923
> 
> 赞同：1
> 
> 时间：2012-12-05T17:26:28.140
> 
> 标签：actionscript-3, apache-flex, flex4, flex4.6, callout

如何最大化[Callout](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/spark/components/Callout.html)，以便在屏幕上占用最大的可用空间？

我正在尝试[在标注中显示 ViewNavigator，](http://help.adobe.com/en_US/flex/mobileapps/WS7dd5c1363434bb706aafb086131b54b6ec7-8000.html#WScc733d9d0dc5f34c146f70711322b1fe177-8000)虽然它可以工作，但显示`View`的内容太窄：

![在此处输入图像描述](../Images/b7a63578d641df98e2f5b2e1d84acc49.png)

在同一个程序中，我有另一个程序`Callout`，它足够宽：

![在此处输入图像描述](../Images/ea8ae4218d0e0dedd69fa3b8c701283f.png)

它们之间唯一的两个区别是后者附加到[CalloutButton](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/spark/components/CalloutButton.html)并且后者包含`Score`我为其设置的自定义组件：

```
 override protected function measure():void {
        super.measure();
        measuredWidth = Capabilities.screenResolutionX;
        measuredHeight = Capabilities.screenResolutionY;
    } 
```

我一直盯着[Callout.as](https://svn.apache.org/repos/asf/incubator/flex/sdk/branches/develop/frameworks/projects/mobilecomponents/src/spark/components/Callout.as)代码，但找不到办法欺骗它以占用大部分可用空间。

我的自定义 mxml 组件非常简单：

**播放器信息.mxml：**

```
<?xml version="1.0" encoding="utf-8"?>
<s:Callout 
    xmlns:fx="http://ns.adobe.com/mxml/2009" 
    xmlns:s="library://ns.adobe.com/flex/spark"
    contentBackgroundAppearance="none">

    <fx:Script>
        <![CDATA[
            [Bindable]
            public var userid:String;
        ]]>
    </fx:Script>

    <s:ViewNavigator 
        firstView="views.Profile"
        firstViewData="{userid}">
        <s:navigationContent>
            <s:Button label="Close" click="close()" />
        </s:navigationContent>
    </s:ViewNavigator>

</s:Callout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T17:43:19.780

标注扩展了 Container，因此将宽度和高度设置为 100% 应该不会有问题。
此外，在标注代码中有一个方法：

```
/**
 *  @private
 *  Force a new measurement when callout should use it's screen-constrained
 *  max size.
 */
private function invalidateMaxSize():void
{
    // calloutMaxWidth and calloutMaxHeight don't invalidate 
    // explicitMaxWidth or explicitMaxHeight. If callout's max size changes
    // and explicit max sizes aren't set, then invalidate size here so that
    // callout's max size is applied.
    if (!canSkipMeasurement() && !isMaxSizeSet)
        skin.invalidateSize();
} 
```

因此，尝试设置“explicitMaxWidth”和“explicitMaxHeight”属性。

# python - 存储在 MySQL 数据库中的 Unicode 字符串

> ID：13728929
> 
> 赞同：0
> 
> 时间：2012-12-05T17:26:48.990
> 
> 标签：python, unicode, utf-8

我的应用程序使用 Zope 2.12.19。蟒蛇 2.6.8。MySQL 5.5

1.  在 Zope 中使用 ZMySQLDA 连接器启用了 Unicode 支持。
2.  sys.setdefaultencoding('utf8') 在 python 的 sitecustomize.py 文件中设置。
3.  MySQL 中的所有 'character_set%' 和 'collat​​ion%' 变量都已更改为使用 utf-8。

该应用程序可以很好地处理所有字符，只要它们是从浏览器输入的。但是当我执行一个从数据库读取然后写入数据库的 Python 脚本时，这些表包含 Unicode 字符串。例如... u'stack' 而不仅仅是堆栈。

谁能告诉我为什么会这样？

# gwt - 如何为 DataGrid 中的单元格创建拖放

> ID：13728931
> 
> 赞同：6
> 
> 时间：2012-12-05T17:26:54.987
> 
> 标签：gwt, datagrid, drag-and-drop

我正在尝试将拖放添加到单元格小部件。更具体地说，我想拖放`ClickableTextCell`s，但他们没有具体的方法，甚至没有`.addDomHandler`，所以我不能只创建类似的东西`.addDomHandler(new DragStartHandler() { ... }`

有人可以就如何 DnD 细胞提供一些帮助，最好是纯 GWT 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T18:55:09.880

我不知道如何使用 GWT 实现 DnD，但我知道如何实现 CnC (Clic 'n Clic)，这可能会让您感兴趣。DnD 很酷，很有趣，很漂亮，但我认为有时它们不是很方便。比如你有一个需要滚动的大屏幕，如果你想从上到下DnD一个项目，那么必须按住鼠标不方便......但这只是个人感觉......

无论如何，我建议您使用 ListDataProvider 和简单事件，以便移动您的项目：第一个 clic 选择源项目，第二个 clic 选择目标。一旦知道源和目的地，您就可以移动您的项目。

它对我很有效......如果您添加一些样式来突出显示源和目标，那就太好了。

例子：

这是主要课程：

```
 import java.util.ArrayList;

        import com.google.gwt.event.dom.client.ClickEvent;
        import com.google.gwt.event.dom.client.ClickHandler;
        import com.google.gwt.user.cellview.client.CellList;
        import com.google.gwt.user.client.ui.DialogBox;
        import com.google.gwt.user.client.ui.FlowPanel;
        import com.google.gwt.user.client.ui.FocusPanel;
        import com.google.gwt.user.client.ui.Grid;
        import com.google.gwt.user.client.ui.Label;
        import com.google.gwt.view.client.ListDataProvider;
        import com.google.gwt.view.client.SelectionChangeEvent;
        import com.google.gwt.view.client.SingleSelectionModel;

        public class Clic_Clic {

          private static final Integer LEFT = 0;

          private static final Integer CENTER = 1;

          private static final Integer RIGHT = 2;

          private ClicClicSelectionModel<Item> selectionModel = new ClicClicSelectionModel<Item>();

          ListDataProvider<Item> leftLDP = new ListDataProvider<Item>();

          ListDataProvider<Item> centerLDP = new ListDataProvider<Item>();

          ListDataProvider<Item> rightLDP = new ListDataProvider<Item>();

          FocusPanel left = new FocusPanel(), center = new FocusPanel(), right = new FocusPanel();

          Item selected = null;

          public Clic_Clic() {

            // --- Builds the GUI
            DialogBox clic_clic = buildGUI();
            clic_clic.center();
            clic_clic.show();

            // --- Initializes data
            configureSelectionManagement();
            initCellLists();
            configureAddAndRemove();

            // --- Fills the left LDP
            leftLDP.getList().add(new Item("Fraternité", LEFT));
            leftLDP.refresh();

            // --- Fills the center LDP
            centerLDP.getList().add(new Item("Egalité", LEFT));
            centerLDP.refresh();

            // --- Fills the right LDP
            rightLDP.getList().add(new Item("Liberté", RIGHT));
            rightLDP.refresh();
          }

          private DialogBox buildGUI() {
            DialogBox db = new DialogBox();
            db.setText("A simple example for Clic 'n Clic");
            db.setSize("300px", "200px");
            db.setGlassEnabled(true);
            db.setModal(true);

            FlowPanel fp = buildContent();
            db.add(fp);

            return db;
          }

          private FlowPanel buildContent() {

            Grid g = new Grid(1, 3);
            g.setSize("300px", "200px");

            g.setWidget(0, 0, left);
            left.setSize("100px", "100px");
            left.getElement().getStyle().setBackgroundColor("blue");

            g.setWidget(0, 1, center);
            center.setSize("100px", "100px");

            g.setWidget(0, 2, right);
            right.setSize("100px", "100px");
            right.getElement().getStyle().setBackgroundColor("red");

            FlowPanel fp = new FlowPanel();
            fp.setSize("300px", "200px");
            fp.add(new Label("Do you know the correct order ?"));
            fp.add(g);

            return fp;
          }

          private void initCellLists() {
            // --- Associates the left panel with the leftLDP ListDataProvider
            CellList<Item> cellListLeft = new CellList<Item>(new MyCell());
            cellListLeft.setSelectionModel(selectionModel);
            left.add(cellListLeft);
            leftLDP = new ListDataProvider<Item>(new ArrayList<Item>());
            leftLDP.addDataDisplay(cellListLeft);

            // --- Associates the center panel with the centerLDP ListDataProvider
            CellList<Item> cellListCenter = new CellList<Item>(new MyCell());
            cellListCenter.setSelectionModel(selectionModel);
            center.add(cellListCenter);
            centerLDP = new ListDataProvider<Item>(new ArrayList<Item>());
            centerLDP.addDataDisplay(cellListCenter);

            // --- Associates the right panel with the rightLDP ListDataProvider
            CellList<Item> cellListRight = new CellList<Item>(new MyCell());
            cellListRight.setSelectionModel(selectionModel);
            right.add(cellListRight);
            rightLDP = new ListDataProvider<Item>(new ArrayList<Item>());
            rightLDP.addDataDisplay(cellListRight);
          }

          private void configureAddAndRemove() {
            // --- If the user clic on the left
            left.addClickHandler(new ClickHandler() {

              @Override
              public void onClick(ClickEvent event) {
                if (selected != null) {
                  // --- If the selected item comes from the right
                  if (selected.getContainerIndex() == RIGHT) {
                    rightLDP.getList().remove(selected);
                    rightLDP.refresh();

                    selected.setContainerIndex(LEFT);
                    leftLDP.getList().add(selected);
                    leftLDP.refresh();

                    selected = null;
                  }
                  // --- If the selected item comes from the center
                  if (selected.getContainerIndex() == CENTER) {
                    centerLDP.getList().remove(selected);
                    centerLDP.refresh();

                    selected.setContainerIndex(LEFT);
                    leftLDP.getList().add(selected);
                    leftLDP.refresh();

                    selected = null;
                  }
                }
              }
            });
            // --- If the user clic on the center
            center.addClickHandler(new ClickHandler() {

              @Override
              public void onClick(ClickEvent event) {
                if (selected != null) {
                  // --- If the selected item comes from the right
                  if (selected.getContainerIndex() == RIGHT) {
                    rightLDP.getList().remove(selected);
                    rightLDP.refresh();

                    selected.setContainerIndex(CENTER);
                    centerLDP.getList().add(selected);
                    centerLDP.refresh();

                    selected = null;
                  }
                  // --- If the selected item comes from the left
                  if (selected.getContainerIndex() == LEFT) {
                    leftLDP.getList().remove(selected);
                    leftLDP.refresh();

                    selected.setContainerIndex(CENTER);
                    centerLDP.getList().add(selected);
                    centerLDP.refresh();

                    selected = null;
                  }
                }
              }
            });
            // --- If the user clic on the right
            right.addClickHandler(new ClickHandler() {

              @Override
              public void onClick(ClickEvent event) {
                // --- If the selected item comes from the left
                if (selected.getContainerIndex() == LEFT) {
                  leftLDP.getList().remove(selected);
                  leftLDP.refresh();

                  selected.setContainerIndex(RIGHT);
                  rightLDP.getList().add(selected);
                  rightLDP.refresh();

                  selected = null;
                }
                // --- If the selected item comes from the center
                if (selected.getContainerIndex() == CENTER) {
                  centerLDP.getList().remove(selected);
                  centerLDP.refresh();

                  selected.setContainerIndex(RIGHT);
                  rightLDP.getList().add(selected);
                  rightLDP.refresh();

                  selected = null;
                }
              }
            });
          }

          @SuppressWarnings("hiding")
          class ClicClicSelectionModel<Item> extends SingleSelectionModel<Item> {

            @Override
            public void setSelected(Item object, boolean selected) {
              if (getSelectedObject() != null && getSelectedObject().equals(object)) {
                super.setSelected(object, !selected);
              } else {
                super.setSelected(object, selected);
              }
            };
          }

          private void configureSelectionManagement() {
            selectionModel.addSelectionChangeHandler(new SelectionChangeEvent.Handler() {

              @Override
              public void onSelectionChange(SelectionChangeEvent event) {
                Item selected = selectionModel.getSelectedObject();
                updateSelected(selected);
              }

            });

          }

          private void updateSelected(Item item) {
            // --- If no item has been selected, update the selected item
            if (selected == null) {
              selected = item;
            }
          }

        } 
```

你还需要这个：

```
 public class Item {

          private String label;

          private Integer containerIndex;

          public Item(String l, Integer id) {
            this.label = l;
            this.containerIndex = id;
          }

          public String getLabel() {
            return label;
          }

          public void setLabel(String label) {
            this.label = label;
          }

          public Integer getContainerIndex() {
            return containerIndex;
          }

          public void setContainerIndex(Integer containerIndex) {
            this.containerIndex = containerIndex;
          }

        } 
```

最后，这个：

```
 import com.google.gwt.cell.client.AbstractCell;
        import com.google.gwt.safehtml.shared.SafeHtml;
        import com.google.gwt.safehtml.shared.SafeHtmlBuilder;
        import com.google.gwt.safehtml.shared.SafeHtmlUtils;

        public class MyCell extends AbstractCell<Item> {

          @Override
          public void render(com.google.gwt.cell.client.Cell.Context context, Item value, SafeHtmlBuilder sb) {
            if (value != null) {
              // --- If the value comes from the user, we escape it to avoid XSS
              // attacks.
              SafeHtml safeValue = SafeHtmlUtils.fromString(value.getLabel());
              sb.append(safeValue);
            }

          }

        } 
```

干得好。下次我会尝试做一个有趣的例子:)

希望能帮助到你。

# mysql - SQL select ... in (select...) 耗时较长

> ID：13728935
> 
> 赞同：1
> 
> 时间：2012-12-05T17:26:59.560
> 
> 标签：mysql, sql, where-in

我有一张用户购买的商品表，在该表中有一个类别标识符。所以，我想向用户展示同一张桌子上的其他商品，他们已经购买过相同的类别。

我正在尝试的查询运行时间超过 22 秒，而主要项目表甚至没有 3000 行......为什么效率这么低？我应该索引哪些列，如果是的话？

这是查询：

```
select * from items
    where category in (
        select category from items 
        where ((user_id = '63') AND (category <> '0')) 
        group by category
    ) 
order by dateadded desc limit 20 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T17:31:26.843

尝试使用自联接以获得更好的性能：

```
 select i1.* from items i1 JOIN items i2 on i1.category= i2.category
 where i2.user_id = '63' AND i2.category <> '0'
 group by i2.category
 order by i1.dateadded desc limit 20 
```

连接比嵌套子查询快得多。

**编辑：**尝试不使用`group by`as ：

```
 select i1.* from items i1 JOIN items i2 on i1.category= i2.category
 where i2.user_id = '63' AND i2.category <> '0'
 order by i1.dateadded desc limit 20 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T17:31:55.500

如有必要，放置索引的适当位置将是 on`dateadded`和`user_id`/或`category`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-05T18:38:53.150

这是一个查询。并确保在`category`, `user_id`,上添加索引`dateadded`

```
select i1.* 
from items i1
inner join 
(select distinct 
           category 
        from items 
        where ((user_id = '63') AND (category <> '0'))
) i2 on (i1.Category=i2.Category)

order by i1.dateadded desc limit 20 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-05T17:30:55.227

如果您索引`category`并且可能`dateadded`，它应该会加快速度。

# prolog - prolog 中的字符串操作

> ID：13728938
> 
> 赞同：4
> 
> 时间：2012-12-05T17:27:03.310
> 
> 标签：prolog

**前提**

所以我试图将给定的字符串分解成一个字符列表，然后这些字符将被编辑/更改并重新分配到列表中，之后列表将被重建回字符串。

*一个例子：*

给定`String : "ABCDEFG"`

特点`list : [A,B,C,D,E,F,G]`

操作将列表更改为类似以下内容：[E,F,G,H,I,J,K]（或类似内容）。

然后被重构为一个字符串：

```
"EFGHIJK" 
```

**问题**

我正在寻找一种方法来访问字符串中的单个元素。如果是 Java，我会使用类似的命令，`charAt(int i)`但我不知道 prolog 中是否存在这样的命令。

**笔记**

我是一名新`prolog`程序员，所以我对大多数`prolog`操作都不熟悉。

谢谢你的时间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T20:48:05.333

字符串是字符代码列表，而原子是*原子*，即不可分割，但是有[sub_atom](http://www.swi-prolog.org/pldoc/doc_for?object=sub_atom/5) /5 可以访问部分原子数据。

这里有一些字符串示例：

```
1 ?- L = "ABCDEF".
L = [65, 66, 67, 68, 69, 70].

2 ?- L = "ABCDEF", maplist(succ, L, N), format('~s', [N]).
BCDEFG
L = [65, 66, 67, 68, 69, 70],
N = [66, 67, 68, 69, 70, 71].

3 ?- L = "ABCDEF", maplist(succ, L, N), format('~s', [N]), atom_codes(A, N).
BCDEFG
L = [65, 66, 67, 68, 69, 70],
N = [66, 67, 68, 69, 70, 71],
A = 'BCDEFG'. 
```

如果分析和转换需要细节，那么通常最好使用 DCG

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T17:35:33.823

字符串是 Prolog 中的原子。

在您的情况下，您可以执行以下操作：“EFGHIJK”= List.

这是一篇关于它的好帖子：http: [//obvcode.blogspot.com/2008/11/working-with-strings-in-prolog.html](http://obvcode.blogspot.com/2008/11/working-with-strings-in-prolog.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-05T17:41:47.780

你可以试试这个

```
t(S_in, S_out) :-
    maplist(modif, S_in, S_temp),
    string_to_list(S_out, S_temp).

modif(In, Out) :-
    atom_codes('A', [X]),
    atom_codes('E', [Y]),
    Out is In + Y - X. 
```

字符串是 Prolog 中的代码列表。因此 maplist 对列表的每个代码都进行了修改（一种功能方式）。string_to_list 对于在输出中获取字符串而不是代码列表很有用。

您可以快速编写 modif，但我以您可以轻松理解的方式编写它。

输出是

```
?- t("ABCDEFG", Out).
Out = "EFGHIJK". 
```

# vb.net - 引发一个从不同类更改表单的事件

> ID：13728942
> 
> 赞同：0
> 
> 时间：2012-12-05T17:27:15.067
> 
> 标签：vb.net, winforms, events, event-handling

我想知道是否可以从课堂上制作和引发事件到表单？我有一个类，它只是不断地循环自己，但是当满足条件时，我希望一个按钮在表单上可见。我正在研究实现这一目标的不同方法。值得一提的是，我是多线程的，并且这个循环在与 UI 所在的线程不同的线程中运行。这就是为什么我希望有可能引发一个事件，这将跳转到 UI 线程并使按钮可见，然后返回到它在循环中的位置。

任何建议或方向表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T18:43:54.847

像这样的东西会起作用，

```
Public Class MyClass

   Public Event MyEvent()

   Sub DoStuff()
       RaiseEvent MyEvent
   End Sub
Public Class

Public Class MyForm 

    Public Sub HandleEvent()
         'can be called from another thread, so use invoke
         Me.Invoke(Sub() MyButton.Visible = true )
    End Sub

End Class

Dim mMyClass = New MyClass
Dim mMyForm = New MyForm 

AddHandler mMyClass.MyEvent, AddressOf mMyForm.HandleEvent() 
```

`.Invoke`如果您的事件来自另一个线程，只要您记得在更新 UI 时使用，那么让表单处理来自任何来源的事件都没有问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T18:21:59.127

我认为这是一个可能的解决方案：

1）将父表单作为参数传递给类；2）在父窗体中，调用函数

```
Private Delegate Sub DoStuffDelegate()
Private Sub DoStuff()
    If Me.InvokeRequired Then
        Me.Invoke(New DoStuffDelegate(AddressOf DoStuff))
    Else
        btn.Visible = true
    End If
End Sub 
```

3）在课堂上，将其称为 parentform.DoStuff()

*   检查我输入的语法。

# javascript - Javascript对象在固定长度的for循环中未定义

> ID：13728943
> 
> 赞同：0
> 
> 时间：2012-12-05T17:27:19.803
> 
> 标签：javascript, json

我有一个使用 jQuery 的 parseJSON 函数解析的 JSON 对象。我将其中一个子对象分配给一个局部变量，然后使用 for 循环对其进行迭代，如下所示：

```
var posts = feedObj["posts"];
content+= "<h2 title=\"" + feedDescription + "\"><a href=\"" + feedPermalink + "\">" + feedTitle + "</a></h2>";
content+= "<ul class=\"feedList\">";
for (var i = 0; i < 10; i++) {
     console.log(posts[i]["postTitle"]);
     var postTitle = posts[i]["postTitle"];
     if((typeof posts[i] != "undefined") || postTitle != null) {
          content+= "<li>";
          console.log("AJ::PostTitle"+postTitle);
          content+= "<a href=\"" + decodeURIComponent(posts[i]["permaLink"])  + "\" target=\"_blank\">" + unescapeHTML(postTitle) + "</a>";
           content+= "</li>";
     }
} 
```

由于某种原因，`var postTitle = posts[i]["postTitle"];`总是给出以下错误： `Uncaught TypeError: Cannot read property 'postTitle' of undefined`

我不知道为什么会这样。控制台语句正确打印出 postTitle，但分配总是失败。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T17:29:32.590

代替

```
for (var i = 0; i < 10; i++) { 
```

为数组对象添加检查条件

```
for (var i = 0; i < posts.length ; i++) { 
```

也许您所指的数组中可能没有 10 个条目。后面的方法应该可以解决问题..

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T17:38:47.750

如果您想获得前十个帖子，请替换

```
for (var i = 0; i < 10; i++) { 
```

和

```
for (var i = 0; i < 10 && i < posts.length; i++) { 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-12-05T17:30:44.970

使用`foreach`而不是固定长度的 for 循环。

# php - 如何在 PHP 中编写 3 天试用期？

> ID：13728945
> 
> 赞同：-1
> 
> 时间：2012-12-05T17:27:22.620
> 
> 标签：php

如何编写一个简单的登录/注册页面，用户可以选择先试用 3 天，然后会话到期，即使用户在未先支付每月订阅费的情况下登录，该页面也无法再访问.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-05T17:29:24.643

您需要在数据库中存储用户在您的应用程序上注册的日期。然后，当他访问您的网站时，您会验证该用户何时注册，如果超过 X 天，您会显示一条特定消息，要求他支付订阅费用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T17:30:46.420

强制他们在 3 天后注销的一种方法是使用 3 天后过期的 cookie。如果您真的很想规避这个问题（这是可能的），您可以将他们*创建*的时间存储在他们的用户帐户上，并有一个简单的**init()**函数，每次页面加载时都会执行该函数以查看他们的帐户是否被创建更多超过 3 天前

第二种情况假设您正在使用会话来存储登录信息。当用户关闭浏览器时，会话无论如何都会被破坏，但如果出于某种原因他们决定无限期地打开浏览器，这无论如何都会破坏它。您显然也只需检查登录

# java - 使用 PoolingClientConnectionManager 时释放连接？

> ID：13728948
> 
> 赞同：2
> 
> 时间：2012-12-05T17:27:34.250
> 
> 标签：java, multithreading, connection-pooling, apache-httpclient-4.x, connection-leaks

我正在使用带有[PoolingClientConnectionManager](http://hc.apache.org/httpcomponents-client-ga/httpclient/apidocs/org/apache/http/impl/conn/PoolingClientConnectionManager.html)和[BasicResponseHandler的 Apache](http://hc.apache.org/httpcomponents-client-ga/httpclient/apidocs/org/apache/http/impl/client/BasicResponseHandler.html) [DefaultHttpClient](http://hc.apache.org/httpcomponents-client-ga/httpclient/apidocs/org/apache/http/impl/client/DefaultHttpClient.html)。这些在不同的线程之间共享，每个线程创建自己的 HttpRequestBase 扩展。

在使用 BasicResponseHandlers 时，我是否需要手动告诉经理我已完成使用连接？我是否需要将它包装在 finally 中以便异常不会导致连接泄漏？

换句话说，我需要这样做吗

```
HttpGet get = new HttpGet(address);
try {
  httpclient.execute(get, new BasicResponseHandler());
} finally {
  get.reset();
} 
```

或者这足够了吗？

```
HttpGet get = new HttpGet(address);
httpclient.execute(get, new BasicResponseHandler()); 
```

[我在Apache 文档](http://hc.apache.org/httpcomponents-client-ga/tutorial/html/connmgmt.html)中没有看到明确的答案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T19:59:14.437

这已经足够了，值得推荐。

`HttpClient#execute`方法保证在出现异常（I/O 或运行时）的情况下自动释放与请求相关的所有资源。当使用 ResponseHandler 处理 HTTP 响应时，所有情况下，底层连接都会自动释放回连接管理器。

# python - 使用 PyMongo 进行大尺寸查询？

> ID：13728955
> 
> 赞同：0
> 
> 时间：2012-12-05T17:27:54.760
> 
> 标签：python, mongodb

我已经使用 PyMongo 社交网络实现了广度优先搜索。减少连接数是广度优先。现在我收到了类似`coll.find({"_id":{"$in":["id1", "id2", ...]}}`大量 id 的查询。PyMongo 不处理这些大查询中的一些，因为它们的大小。

有没有围绕它的技术解决方案？或者您是否建议使用另一种方法来处理此类查询，在这种查询中我需要选择具有大量 ID 中的一个的所有文档？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T19:11:49.583

如果您的应用程序需要执行大部分图形操作，则更喜欢使用像[neo4j](http://www.neo4j.org)这样的图形数据库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T17:47:41.057

如果这是一个不可避免的问题，您可以将 id 数组拆分为多个查询，然后在客户端合并结果。

# android - 使用 JsonReader 类 Android 解析 Json

> ID：13728961
> 
> 赞同：2
> 
> 时间：2012-12-05T17:28:02.873
> 
> 标签：android, json

我是一名新的 Android 开发人员，无法使用 JsonReader 类解析 JSON InputStream。每当它到达 reader.beginArray() 开始解析 InputStream 时，它就会崩溃。我使用[http://developer.android.com/reference/android/util/JsonReader.html](http://developer.android.com/reference/android/util/JsonReader.html)上的代码作为示例。有人可以帮我解决这个问题吗？顺便说一句，我正在使用 JsonReader 类，因为我在其他调用中消耗了大量的文本。

我正在传递以下 URL：--- 已删除 ---

```
public class JSONParser {

    static InputStream is = null;
    static JSONObject jObj = null;
    static String json = "";
    static JsonReader reader = null;
    // constructor
    public JSONParser() {

    }

    public List getJSONFromUrl(String url) throws IOException {

        // Making HTTP request

            // defaultHttpClient
            DefaultHttpClient httpClient = new DefaultHttpClient();
            HttpGet httpGet = new HttpGet(url);

            try {
            HttpResponse httpResponse = httpClient.execute(httpGet);
            HttpEntity httpEntity = httpResponse.getEntity();
            is = httpEntity.getContent(); 

        } catch (UnsupportedEncodingException e) {
            e.printStackTrace();
        } catch (ClientProtocolException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }

            try {
                reader = new JsonReader(new InputStreamReader(is, "UTF-8"));
            } catch (UnsupportedEncodingException e1) {
                // TODO Auto-generated catch block
                e1.printStackTrace();
            }

            List<Message> messages = new ArrayList<Message>();
            try {
            reader.beginArray();
            while (reader.hasNext()) {
              messages.add(readMessage(reader));
            }
            reader.endArray();
            }
            catch (IOException e)
            {
                e.printStackTrace();
            }

                return messages;

        // try parse the string to a JSON object

        // return JSON String
        //return reader;

    }

    public Message readMessage(JsonReader reader) throws IOException {
        long _id = -1;
        String topic_title = null;
        Integer sort_order = null;

        reader.beginObject();
         while (reader.hasNext()) {
           String name = reader.nextName();
           if (name.equals("id")) {
               _id = reader.nextLong();
           } else if (name.equals("topic_title")) {
               topic_title = reader.nextString();

           }           
           else if (name.equals("sort_order")) {
               sort_order = reader.nextInt();

           }
           else {
               reader.skipValue();
           }
         }
         reader.endObject();
         DataBaseHelper.getInstance().updateTopicOrder(_id, sort_order, topic_title);
        return new Message();
      }

} 
```

这是我的日志：

```
12-05 10:08:54.806: D/gralloc_goldfish(582): Emulator without GPU emulation detected.
12-05 10:08:56.367: D/dalvikvm(582): GC_CONCURRENT freed 146K, 3% free 10139K/10375K, paused 19ms+10ms
12-05 10:12:17.466: W/webcore(582): java.lang.Throwable: EventHub.removeMessages(int what = 107) is not supported before the WebViewCore is set up.
12-05 10:12:17.466: W/webcore(582):     at android.webkit.WebViewCore$EventHub.removeMessages(WebViewCore.java:1671)
12-05 10:12:17.466: W/webcore(582):     at android.webkit.WebViewCore$EventHub.access$7800(WebViewCore.java:920)
12-05 10:12:17.466: W/webcore(582):     at android.webkit.WebViewCore.removeMessages(WebViewCore.java:1783)
12-05 10:12:17.466: W/webcore(582):     at android.webkit.WebView.sendOurVisibleRect(WebView.java:2858)
12-05 10:12:17.466: W/webcore(582):     at android.webkit.ZoomManager.setZoomScale(ZoomManager.java:586)
12-05 10:12:17.466: W/webcore(582):     at android.webkit.ZoomManager.access$1700(ZoomManager.java:49)
12-05 10:12:17.466: W/webcore(582):     at android.webkit.ZoomManager$PostScale.run(ZoomManager.java:977)
12-05 10:12:17.466: W/webcore(582):     at android.os.Handler.handleCallback(Handler.java:605)
12-05 10:12:17.466: W/webcore(582):     at android.os.Handler.dispatchMessage(Handler.java:92)
12-05 10:12:17.466: W/webcore(582):     at android.os.Looper.loop(Looper.java:137)
12-05 10:12:17.466: W/webcore(582):     at android.app.ActivityThread.main(ActivityThread.java:4340)
12-05 10:12:17.466: W/webcore(582):     at java.lang.reflect.Method.invokeNative(Native Method)
12-05 10:12:17.466: W/webcore(582):     at java.lang.reflect.Method.invoke(Method.java:511)
12-05 10:12:17.466: W/webcore(582):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
12-05 10:12:17.466: W/webcore(582):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
12-05 10:12:17.466: W/webcore(582):     at dalvik.system.NativeStart.main(Native Method)
12-05 10:12:19.146: D/dalvikvm(582): GC_CONCURRENT freed 179K, 4% free 10370K/10695K, paused 5ms+8ms
12-05 10:12:19.616: W/dalvikvm(582): threadid=13: thread exiting with uncaught exception (group=0x409961f8)
12-05 10:12:19.672: E/AndroidRuntime(582): FATAL EXCEPTION: AsyncTask #2
12-05 10:12:19.672: E/AndroidRuntime(582): java.lang.RuntimeException: An error occured while executing doInBackground()
12-05 10:12:19.672: E/AndroidRuntime(582):  at android.os.AsyncTask$3.done(AsyncTask.java:278)
12-05 10:12:19.672: E/AndroidRuntime(582):  at java.util.concurrent.FutureTask$Sync.innerSetException(FutureTask.java:273)
12-05 10:12:19.672: E/AndroidRuntime(582):  at java.util.concurrent.FutureTask.setException(FutureTask.java:124)
12-05 10:12:19.672: E/AndroidRuntime(582):  at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:307)
12-05 10:12:19.672: E/AndroidRuntime(582):  at java.util.concurrent.FutureTask.run(FutureTask.java:137)
12-05 10:12:19.672: E/AndroidRuntime(582):  at android.os.AsyncTask$SerialExecutor$1.run(AsyncTask.java:208)
12-05 10:12:19.672: E/AndroidRuntime(582):  at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1076)
12-05 10:12:19.672: E/AndroidRuntime(582):  at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:569)
12-05 10:12:19.672: E/AndroidRuntime(582):  at java.lang.Thread.run(Thread.java:856)
12-05 10:12:19.672: E/AndroidRuntime(582): Caused by: java.lang.IllegalStateException: Expected BEGIN_ARRAY but was BEGIN_OBJECT
12-05 10:12:19.672: E/AndroidRuntime(582):  at android.util.JsonReader.expect(JsonReader.java:310)
12-05 10:12:19.672: E/AndroidRuntime(582):  at android.util.JsonReader.beginArray(JsonReader.java:277)
12-05 10:12:19.672: E/AndroidRuntime(582):  at com.gotquestions.gqandapp.util.JSONParser.readMessagesArray(JSONParser.java:82)
12-05 10:12:19.672: E/AndroidRuntime(582):  at com.gotquestions.gqandapp.util.JSONParser.getJSONFromUrl(JSONParser.java:73)
12-05 10:12:19.672: E/AndroidRuntime(582):  at com.gotquestions.gqandapp.ac.UpdaterActivity$updateTopics.doInBackground(UpdaterActivity.java:108)
12-05 10:12:19.672: E/AndroidRuntime(582):  at com.gotquestions.gqandapp.ac.UpdaterActivity$updateTopics.doInBackground(UpdaterActivity.java:1)
12-05 10:12:19.672: E/AndroidRuntime(582):  at android.os.AsyncTask$2.call(AsyncTask.java:264)
12-05 10:12:19.672: E/AndroidRuntime(582):  at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:305)
12-05 10:12:19.672: E/AndroidRuntime(582):  ... 5 more
12-05 10:12:24.938: I/Process(582): Sending signal. PID: 582 SIG: 9
12-05 10:14:39.988: W/ActivityThread(645): Application com.gotquestions.gqandapp is waiting for the debugger on port 8100...
12-05 10:14:40.097: I/System.out(645): Sending WAIT chunk
12-05 10:14:40.137: I/dalvikvm(645): Debugger is active
12-05 10:14:40.216: I/System.out(645): Debugger has connected
12-05 10:14:40.216: I/System.out(645): waiting for debugger to settle...
12-05 10:14:40.416: I/System.out(645): waiting for debugger to settle...
12-05 10:14:40.617: I/System.out(645): waiting for debugger to settle...
12-05 10:14:40.817: I/System.out(645): waiting for debugger to settle...
12-05 10:14:41.027: I/System.out(645): waiting for debugger to settle...
12-05 10:14:41.228: I/System.out(645): waiting for debugger to settle...
12-05 10:14:41.427: I/System.out(645): waiting for debugger to settle...
12-05 10:14:41.627: I/System.out(645): waiting for debugger to settle...
12-05 10:14:41.827: I/System.out(645): waiting for debugger to settle...
12-05 10:14:42.052: I/System.out(645): waiting for debugger to settle...
12-05 10:14:42.247: I/System.out(645): waiting for debugger to settle...
12-05 10:14:42.462: I/System.out(645): waiting for debugger to settle...
12-05 10:14:42.674: I/System.out(645): waiting for debugger to settle...
12-05 10:14:42.881: I/System.out(645): waiting for debugger to settle...
12-05 10:14:43.086: I/System.out(645): debugger has settled (1352)
12-05 10:14:46.566: D/gralloc_goldfish(645): Emulator without GPU emulation detected.
12-05 10:14:47.616: D/dalvikvm(645): GC_CONCURRENT freed 149K, 3% free 10138K/10375K, paused 6ms+6ms
12-05 10:19:45.851: D/dalvikvm(645): Debugger has detached; object registry had 594 entries
12-05 10:21:11.577: W/ActivityThread(707): Application com.gotquestions.gqandapp is waiting for the debugger on port 8100...
12-05 10:21:11.668: I/System.out(707): Sending WAIT chunk
12-05 10:21:11.677: I/dalvikvm(707): Debugger is active
12-05 10:21:11.747: I/System.out(707): Debugger has connected
12-05 10:21:11.747: I/System.out(707): waiting for debugger to settle...
12-05 10:21:11.987: I/System.out(707): waiting for debugger to settle...
12-05 10:21:12.197: I/System.out(707): waiting for debugger to settle...
12-05 10:21:12.397: I/System.out(707): waiting for debugger to settle...
12-05 10:21:12.597: I/System.out(707): waiting for debugger to settle...
12-05 10:21:12.799: I/System.out(707): waiting for debugger to settle...
12-05 10:21:13.007: I/System.out(707): waiting for debugger to settle...
12-05 10:21:13.207: I/System.out(707): waiting for debugger to settle...
12-05 10:21:13.407: I/System.out(707): waiting for debugger to settle...
12-05 10:21:13.607: I/System.out(707): waiting for debugger to settle...
12-05 10:21:13.820: I/System.out(707): waiting for debugger to settle...
12-05 10:21:14.017: I/System.out(707): waiting for debugger to settle...
12-05 10:21:14.227: I/System.out(707): waiting for debugger to settle...
12-05 10:21:14.427: I/System.out(707): waiting for debugger to settle...
12-05 10:21:14.626: I/System.out(707): waiting for debugger to settle...
12-05 10:21:14.864: I/System.out(707): waiting for debugger to settle...
12-05 10:21:15.078: I/System.out(707): debugger has settled (1364)
12-05 10:21:18.457: D/gralloc_goldfish(707): Emulator without GPU emulation detected.
12-05 10:21:19.567: D/dalvikvm(707): GC_CONCURRENT freed 151K, 3% free 10136K/10375K, paused 7ms+7ms
12-05 10:21:28.467: D/dalvikvm(707): GC_CONCURRENT freed 160K, 3% free 10401K/10695K, paused 6ms+8ms 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-05T09:13:39.020

你的日志说

12-05 10:12:19.672: E/AndroidRuntime(582): 由: java.lang.IllegalStateException: 预期 BEGIN_ARRAY 但为 BEGIN_OBJECT

在 Json 格式中，这个“{}”是对象，“[]”是数组

查看您的 json 文件，我认为它以对象开头。如果从对象开始，请更改您的代码行以从读取对象而不是数组开始。

```
try {
        reader.beginObject();
        while (reader.hasNext()) {
          messages.add(readMessage(reader));
        }
        reader.endObject();
        } 
```

注意：使用后关闭流。常见的方法是将代码放入 finally 块中。

# c# - 使用 C# API 通过 SSPI 向 vSphere 进行身份验证

> ID：13728962
> 
> 赞同：4
> 
> 时间：2012-12-05T17:28:04.037
> 
> 标签：c#, sspi, vsphere

我正在使用 C# 库连接到 vSphere (VimClient)。我使用这种方法登录：

```
VimClient client = new VimClient();
client.Connect("https://vSphereMachine/sdk");
client.Login("userName", "password"); 
```

我登录的用户是进程使用的当前用户。有没有办法可以使用当前登录的用户进行身份验证？

该线程似乎提供了建议，但我在那里尝试的没有任何效果：http: [//communities.vmware.com/message/1125103](http://communities.vmware.com/message/1125103)

这可能是因为我不熟悉 .NET 中的 SSPI 实现。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-03-20T21:56:43.643

由于`VMWare.Vim.dll`只是包装了生成的 WCF 服务客户端，我能够使[这个示例项目](https://github.com/git-m1chael-dg/vSphereSdkSspiSample)适应直接使用 dll。这是我对他`LoginBySspiPackage`方法的改编。

```
 private UserSession LoginBySspiPackage(SspiPackageType sspiPackage, string serviceSpn)
    {
        Log($"Logging in to VSphere instance {VimClient.ServiceUrl} using SSPI.");
        var sspiClient = new SspiClient(serviceSpn, sspiPackage);
        var sessionManager = new SessionManager(VimClient, VimClient.ServiceContent.SessionManager);

        var serverNotReady = true;
        UserSession session = null;

        while (serverNotReady)
        {
            try
            {
                var base64String = Convert.ToBase64String(sspiClient.Token);
                session = sessionManager.LoginBySSPI(base64String, "en");

                serverNotReady = false; // Connected!  
            }
            catch (VMware.Vim.VimException e)
            {
                if (e.MethodFault is SSPIChallenge)
                {
                    var sspiChallenge = e.MethodFault as SSPIChallenge;
                    var base64String = Convert.FromBase64String(sspiChallenge.Base64Token);
                    sspiClient.Initialize(base64String);
                }
                else if (e.MethodFault is InvalidLogin)
                {
                    throw new InvalidLoginException(e.Message);
                }
                else
                {
                    throw;
                }
            }
        }

        return session;
    } 
```

# .htaccess - htaccess - 文件正在发送到另一个域

> ID：13728965
> 
> 赞同：0
> 
> 时间：2012-12-05T17:28:06.197
> 
> 标签：.htaccess

我们正在将我们公司的网站移至新服务器。我们建立了一个网站，其工作是创建短链接。我正在尝试在我们移动域名之前测试它是否可以进行转换，但是 htaccess 文件会导致问题。

我们正在使用“http://ipaddress/~siteonnewserver/”访问新站点

```
<IfModule mod_rewrite.c>
RewriteEngine on
RewriteBase /~siteonnewserver/

SetEnv TZ Europe/London

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php?link=$1 [L]

</IfModule> 
```

我已经能够排除 index.php 是问题（通过删除 htaccess 并使用链接 = thisisalink 访问索引文件）

当 htaccess 存在时，它会尝试将请求发送到我们的域，而不是将其保留在新服务器上。

这是否也可能不是 htaccess 问题，而是与它在 whm 和 cpanel 上设置为 domain.com 有关？

# variables - 如何解决 mvn 变量？

> ID：13728967
> 
> 赞同：0
> 
> 时间：2012-12-05T17:28:21.743
> 
> 标签：variables, maven

两个问题合二为一：

1.  给定一个变量`${project.build.directory}`，我怎样才能找出这在我的机器上到底是什么？
2.  我在哪里可以找到所有 Maven 变量的列表？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T18:10:04.477

如果您想知道它扩展到哪个，只需执行以下操作：

```
mvn help:effective-pom 
```

可以在[文档](http://www.sonatype.com/books/mvnref-book/reference/resource-filtering-sect-properties.html)或[此处](http://docs.codehaus.org/display/MAVENUSER/MavenPropertiesGuide)找到现有的变量列表。

# c# - 如何在 Windows 通知栏中显示弹出通知

> ID：13728969
> 
> 赞同：1
> 
> 时间：2012-12-05T17:28:29.247
> 
> 标签：c#, wpf, windows

我正在用 C# 创建我的个人 gmail 检查器，我需要一种方法来在有新电子邮件时在系统托盘中弹出通知以及如何控制该通知栏的内容。另外，如果可能的话，我不需要它像 Windows 通知，而是我个人的方式。例如，不像通知那样弹出，而是像矩形（或正方形或其他）那样弹出，如果 Windows 任务栏处于自动隐藏状态，则不会显示任务栏，而只显示通知。它也是一个 wpf 应用程序。如果您需要更多信息，请告诉我

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T17:40:35.007

听起来您正在尝试创建一个“烤面包机”风格的弹出窗口。你可以看看包括这样的[WPF NotifyIcon](http://www.hardcodet.net/projects/wpf-notifyicon)：

> 这是 WPF 平台的 NotifyIcon（又名系统托盘图标或任务栏图标）的实现。它不仅仅依赖于 Windows 窗体 NotifyIcon 组件，而是一个纯粹的独立控件，它利用 WPF 框架的多个功能来显示丰富的工具提示、弹出窗口、上下文菜单和气球消息。它可以直接在代码中使用，也可以嵌入到任何 XAML 文件中。
> 
> ![WPF NotifyIcon 截图](../Images/d3416a74cb9dad6f85adb10f668ee260.png)

您还可以考虑使用[Growl for Windows 之](http://www.growlforwindows.com/gfw/default.aspx)类的通知框架：

> **好的，那么咆哮是什么？**
> 
> 简而言之，当事情发生时，Growl 会让你知道。文件下载完成，朋友上线，新电子邮件到达 - Growl 可以在任何事件发生时通过微妙的通知通知您。其余时间，Growl 不会妨碍您。
> 
> 除了让您知道事情发生时，Growl 还让您可以完全控制您收到通知的方式以及您想要对通知采取什么行动（如果有的话）。您可以选择通过视觉指示器或声音警报来提醒，或者两者都不要。您可以选择显示的显示类型、显示是否保留在屏幕上、通知的重要性，以及是否应将通知转发到另一台计算机。您可以拥有触发电子邮件、运行脚本、启动程序或大声朗读的通知。

[您可以在Growl 的开发人员页面](http://www.growlforwindows.com/gfw/developers.aspx)上找到文档和 Growl.net 文件。

# jquery - jquery检查返回值是否包含字符串

> ID：13728971
> 
> 赞同：2
> 
> 时间：2012-12-05T17:28:33.127
> 
> 标签：jquery, function, contain

我在按钮上有一个 jquery 单击它在后端代码中运行一个函数。我的代码将返回一个可能包含一些值的字符串。我可以说如果我的字符串包含然后意味着成功否则显示错误（请参阅下面的代码），以下代码会引发语法错误：

```
$.ajax({
                    type: "POST",
                    url: "MyPage.aspx/MyFunction",
                    data: "{'totalToPay': '" + totalToPay + "'}",
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",

                    success: function (msg) {
                        if (msg.d.contains('https://')) { // THIS IS WHERE IT THROWS ERROR. AM DOING THIS AS MY STRING MAY CONTAIN http://www.test.com
                            alert("TEST");
                        }
                        else {
                            $("#error").show();
                            msgbox.html(msg.d);

                        }
                    }

                }); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-05T17:31:09.080

```
msg.d.contains('https://') 
```

你要：

```
msg.d.indexOf('https://') > -1 
```

您对[包含](http://api.jquery.com/jQuery.contains/)jQuery DOM 方法感到困惑。

# sql - 为什么 Postgres 中的这个查询会导致 15 天的锁定？

> ID：13728972
> 
> 赞同：1
> 
> 时间：2012-12-05T17:28:34.913
> 
> 标签：sql, postgresql

我的数据库中的一切都在正常运行——读取、写入、大量活动。

然后我想在表格中添加一列`foos`。该`foos`表变得不可用。我退出了执行查询的代码并查看了系统中的锁。我发现下面的查询被锁定了 15 天。之后是我的表更改查询，然后是更多涉及该`foos`表的查询。

什么会导致此查询卡住 15 天？这是在 9.1.3

```
select generate_report, b.count from
   (select count(1), date_trunc('hour',f.event_happened_at) from
       foos as f, bars as b
       where age(f.event_happened_at) <= interval '24 hour' and f.id=b.foo_id and b.thing_type='Dog' and b.thing_id=26631
       group by date_trunc('hour',f.event_happened_at)) as e
   right join generate_report(date_trunc('hour',now()) - interval '24 hour',now(),interval '1 hour')
   on generate_report = b.date_trunc
   order by generate_report; 
```

**更新：**信息来自`pg_stat_activity`

```
| 后端开始 | xact_start | 查询开始 | 等待 |
--------+---------+----------+------------------+-- --------------+-----------------+----------------- --------
| 2012-11-19 18:38:40.029818+00 | 2012-11-19 18:38:40.145172+00 | 2012-11-19 18:38:40.145172+00 | f |

```

**更新：**解释的输出：

```
Merge Left Join  (cost=14135.74..14138.08 rows=1000 width=16)
  Merge Cond: (generate_report.generate_report = (date_trunc('hour'::text, f.event_happened_at)))
  ->  Sort  (cost=12.97..13.47 rows=1000 width=8)
        Sort Key: generate_report.generate_report
        ->  Function Scan on generate_report  (cost=0.00..3.00 rows=1000 width=8)
  ->  Sort  (cost=14122.77..14122.81 rows=67 width=16)
        Sort Key: (date_trunc('hour'::text, f.event_happened_at))
        ->  HashAggregate  (cost=14121.93..14122.17 rows=67 width=8)
              ->  Hash Join  (cost=3237.14..14121.86 rows=67 width=8)
                    Hash Cond: (b.foo_id = f.id)
                    ->  Index Scan using index_bars_on_thing_type_and_thing_id_and_baz on bars b  (cost=0.00..10859.88 rows=10937 width=4)
                          Index Cond: (((thing_type)::text = 'Dog'::text) AND (thing_id = 26631))
                    ->  Hash  (cost=3131.42..3131.42 rows=30207 width=12)
                          ->  Seq Scan on foos f  (cost=0.00..3131.42 rows=30207 width=12)
                                Filter: (age((('now'::text)::date)::timestamp without time zone, event_happened_at) <= '24:00:00'::interval) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T18:05:05.897

[根据您发布的pg_stat_activity](http://www.postgresql.org/docs/9.2/static/monitoring-stats.html)中的信息，该查询似乎仍在执行（等待 = f）。这意味着锁还没有被释放。

您可能想开始查看您的查询，看看它的结构或它生成的查询计划是否存在问题。15 天肯定太长了，大多数长时间运行的查询在被认为有问题之前应该不超过 10 分钟。

为了获得帮助，您需要发布表 DDL、一些示例数据以及每个表中有多少行的一些想法。这可能最好作为一个新问题提出，但您可以随时编辑这个问题。

# php - 来自 table1 的 mysql 查询链接，其中 table2 和 table3 中不存在此链接

> ID：13728983
> 
> 赞同：0
> 
> 时间：2012-12-05T17:29:18.207
> 
> 标签：php, mysql

我想进行一个 MySQL 查询，该查询从 table1 获取链接并检查该链接是否存在于 table2 和 table3 中。

现在我在做2个查询，但是我想将2个查询合并为1个，并保证返回10个结果？（第一个之后，目前如果mysql_num_rows($rez)>0，返回结果会小于10）

谢谢。

```
$result = mysql_query("SELECT id,link FROM table1 WHERE Order By id DESC LIMIT 0,10"); 
while ($row = mysql_fetch_array($result)){
  $rez = mysql_query("(SELECT link FROM table2 WHERE link='".mysql_real_escape_string($row['link'])."') UNION (SELECT link FROM table3 WHERE link='".mysql_real_escape_string($row['link'])."')");
  if(mysql_num_rows($rez)==0){
    //do stuff with $row['link'];
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T17:36:25.260

您可以使用子查询来完成此操作

`SELECT id, link FROM table1 WHERE (link IN (SELECT link FROM table2)) OR (link IN (SELECT link FROM table3)) LIMIT 10`

我的格式可能略有偏差，并且似乎有更好的方法来执行该查询，但请查看子查询，因为我认为这些会让您朝着您想要的方向前进

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T17:52:06.560

假设您要求查找 table2 或 table3 中不存在的行。如果您尝试查找其中任何一个中存在的行，请使用上面发布的查询。

```
SELECT id, link FROM table1 WHERE link NOT IN (SELECT link FROM table2) AND link NOT IN (SELECT link FROM table3) ORDER BY id DESC LIMIT 0,10 
```

# css - @font-face 问题 - 外星人联盟

> ID：13728986
> 
> 赞同：1
> 
> 时间：2012-12-05T17:29:23.900
> 
> 标签：css, firefox, font-face

我的css中有两种字体样式，两者都是相同的，但只有一种在firefox中不起作用？我尝试过更改语音标记，添加本地版本，更改文件根目录和 url 以及其他各种东西，我只是无法理解为什么一个会工作而另一个不会，这是我的代码：

```
@font-face {
font-family: 'AlienLeague';
src: url('fonts/alien5.eot');
src: url('fonts/alien5.eot?#iefix') format('embedded-opentype'),
         url('fonts/alien5.woff') format('woff'),
         url('fonts/alien5.ttf') format('truetype'),
         url('fonts/alien5.svg#alien5') format('svg');
font-weight: normal;
font-style: normal;
}

#title {
width: auto;
font-family: "AlienLeague", sans-serif;
font-size: 34px;
color: #fff;
float: left;
margin: 0px 40px 0px 40px;
} 
```

我用的是松鼠字体，所以请不要提及，这里有一个链接：[http](http://aawilson.co.uk/assign1/) ://aawilson.co.uk/assign1/ （它的左上角标题“空间和超越”）

提前致谢。

# java - 如何使用 Java 在 Selenium WebDriver 中按“ALT+S”

> ID：13728987
> 
> 赞同：1
> 
> 时间：2012-12-05T17:29:27.317
> 
> 标签：java, selenium-webdriver, webdriver

我需要`ALT+S`使用 Selenium Web 驱动程序为“EditBox. 光标位置已设置为 EditBox 我正在使用以下代码

```
driver.switchTo().activeElement().sendKeys(Keys.chord(Keys.ALT+"S")) 
```

但这并没有给我想要的结果。它是编辑框中的打字字符`'S'`。我尝试了另一个代码，但得到了相同的结果。

```
Actions action =new Actions(driver);
action.keyDown(Keys.ALT).sendKeys(String.valueOf('\u0053')).perform(); 
```

提前致谢

我想在这里再添加一件事。该代码在 Firefox 12 中正常运行，但在 IE9 中无法正常运行

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T09:02:45.983

跨浏览器问题很难调查，因为它们特定于特定驱动程序而不是 WebDriver API。

另一种可能有效的变体。

```
driver.findElement(By.xpath("your editbox's XPath")).sendKeys(Keys.chord(Keys.ALT, "s")); 
```

作为解决方法，我可能会建议您查看 AutoIT（[官方网站](http://www.autoitscript.com/site/autoit/)）或 Robot（[Java Doc](http://docs.oracle.com/javase/1.4.2/docs/api/java/awt/Robot.html)）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-11T16:25:30.490

试试这个。应该可以吧，虽然没试过

```
driver.findElement(By.xpath("your editbox's XPath"))
      .sendKeys(Keys.chord(Keys.ALT + Keys.S)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-06-10T12:44:22.807

您可以通过使用 java 的 Robot 类来实现这一点

```
 try{
        Robot robot=new Robot();
        robot.keyPress(KeyEvent.VK_ALT);
        Thread.sleep(1000);
        robot.keyPress(KeyEvent.VK_S);
        robot.keyRelease(KeyEvent.VK_ALT);
        robot.keyRelease(KeyEvent.VK_S);        
    }
    catch(Exception ex){
        System.out.println(ex.getMessage());
    } 
```

# .net - .net 输出缓存。缓存过期时如何对请求进行排队？

> ID：13728991
> 
> 赞同：3
> 
> 时间：2012-12-05T17:29:38.503
> 
> 标签：.net, caching

我有一个带有 10 秒输出缓存的服务方法。

一切都按预期工作，但是如果我在缓存过期时用多个请求点击该方法，那么所有这些请求都会得到未缓存的响应，并且当请求到达数据库时可能会导致 SQL DB 问题。

我可以排队这些请求吗？