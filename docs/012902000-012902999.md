# StackOverflow 问答 12902000-12902999

# c++ - CUDA 可以在哪里花时间进行内核调用？

> ID：12902004
> 
> 赞同：1
> 
> 时间：2012-10-15T18:45:18.570
> 
> 标签：c++, cuda, gpu, gpgpu

我想知道如何找到我的应用程序花费更多时间的确切位置。它是带有 CUDA 调用的 C++ 代码，因此我从 C++ 代码中创建了调用 CUDA 代码的包装器。对 C++ 代码进行计时，执行时间为 5 秒，但是如果我在 Nsight 中分析代码，内核需要 8 毫秒。这怎么可能？

从`c++`代码：

```
double start_divide = get_host_current_time();
callDivideKernel( keep, d_a, d_A_N );
double end_divide = get_host_current_time();
printf("divideKernel : %g\n", end_divide - start_divide); 
```

`cu`文件：

```
void callDivideKernel(int N, float* A, int* A_N){

  cudaEvent_t start, stop;
  float time;
  cudaEventCreate(&start);
  cudaEventCreate(&stop);

  dim3 dimGrid(618,128);
  dim3 dimBlock(512);

  cudaEventRecord(start, 0);
  DivideKernel<<< dimGrid,dimBlock >>>(N, A, A_N);
  cudaEventRecord(stop, 0);
  cudaEventSynchronize(stop);
  cudaEventElapsedTime(&time, start, stop);
  printf("callDividekernel = %f ms\n",time);
  cudaThreadSynchronize();

}

__global__ void DivideKernel(int N, float* A, int* A_N){

  int k =  blockIdx.x * blockDim.x + threadIdx.x +
    blockDim.x*gridDim.x*blockIdx.y;

  int kmax = (N*(N+1))/2;
  int row,col;

  if(k < kmax){
    row = (int)(sqrt(0.25+2.0*k)-0.5); 
    col = k - (row*(row+1))/2;
    int val = max(1, A_N[row*N + col]);
    A[row*N + col] /= (float)val;
  }
} 
```

结果：

```
callDividekernel = 7.111040 ms
divideKernel : 5.66533 
```

# css - 无法在 Heroku 上加载自定义 CSS

> ID：12902005
> 
> 赞同：1
> 
> 时间：2012-10-15T18:45:22.957
> 
> 标签：css, ruby-on-rails, image, heroku

我正在运行 Rails 3.2.8 并构建了一个链接到自定义 CSS 文件和图像的应用程序。自定义 CSS 文件位于我的 Assets/stylesheets 文件夹中，图像位于 Assets/images 中。

出于某种原因，当我将应用程序推送到 Heroku 时，CSS 和图像不会加载。该应用程序会生成一个 manifest.yml 文件，其中包含所有图像和 CSS 文件。

CSS 文件是 Twitter Bootstrap 的定制版本：http: [//twitter.github.com/bootstrap/index.html](http://twitter.github.com/bootstrap/index.html)

希望各位大神帮忙，提前谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T19:15:26.820

我不认为你可以在heroku上存储图像。您必须使用类似 amazone s3 存储桶之类的东西。然后将 ccs 图像链接到 amazone 存储桶

# python - python如何判断是否启用了超线程

> ID：12902008
> 
> 赞同：12
> 
> 时间：2012-10-15T18:45:35.313
> 
> 标签：python, multiprocessing, hyperthreading

我有 Intel i7-2600K 四核，在 Ubuntu 12.04 上启用了超线程。我知道我可以用 找出我在 Python 中有多少个内核`import multiprocessing; multiprocessing.cpu_count()`，但这给了我 8 个内核，因为我在 4 个物理内核上启用了超线程。我很想知道我有多少物理内核。有没有办法在 Python 中做到这一点？或者，有没有办法在 Python 中找出是否启用了超线程？预先感谢您的帮助！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-01T02:00:08.717

要获取 mac 上的超线程信息，可以使用：

```
os.popen('sysctl hw').readlines()[1:20] 
```

并将该`'hw.activecpu'`值与该`'hw.physicalcpu'`值进行比较，前者是包括超线程在内的cpu数量。或者您可以只`'hw.physicalcpu'`与从返回的值进行比较`multiprocessing.cpu_count()`。

在 linux 上，您可以使用以下方法执行类似操作：

```
os.popen('lscpu').readlines() 
```

`'Socket(s)'`并将该值乘以该`'Core(s) per socket'`值以获得物理cpu的数量。同样，您可以对照`multiprocessing.cpu_count()`.

我不使用 Windows，所以我无法帮助你，但似乎其他人在这个方向上有一些想法

可以在此处找到与此相关的示例[hardware_info()](https://github.com/qutip/qutip/blob/master/qutip/hardware_info.py)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-15T19:25:10.440

根据[http://archive.richweb.com/cpu_info](http://archive.richweb.com/cpu_info)，确定一个 cpu 超线程有点复杂，但仍然有用。

请注意，该方法是特定于 linux 的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-09-27T19:01:45.857

在 Windows 上，要查看是否启用了超线程，您可以使用[pywin32](http://sourceforge.net/projects/pywin32/)做一些 WMI 魔术：

```
from __future__ import print_function
from win32com.client import GetObject

winmgmts_root = GetObject("winmgmts:root\cimv2")
cpus = winmgmts_root.ExecQuery("Select * from Win32_Processor")
for cpu in cpus:
    print('on "{}", hyperthreading is '.format(cpu.DeviceID), end='') 
    if cpu.NumberOfCores < cpu.NumberOfLogicalProcessors:
        print('active')
    else:
        print('inactive') 
```

在我的机器上，输出是：

> 在“CPU0”上，超线程处于活动状态

[在 msdn 上](http://msdn.microsoft.com/en-us/library/aa394373%28v=vs.85%29.aspx)查看更多信息，描述可以从 Win32_Processor 类中获取的内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-12-01T05:29:44.277

> 在 Windows 上，要查看是否启用了超线程，您可以使用 pywin32 做一些 WMI 魔术：

**错误观念！**在我的 Core2Due（没有任何过度刺激）上，它给出了相同的输出：

```
<on "CPU0", hyperthreading is active> 
```

我认为您必须将代码中的字符串更改为：

```
if cpu.NumberOfCores < cpu.NumberOfLogicalProcessors 
```

（没有LowerOrEqual 只是Lower）

# autocomplete - 带有 Knockoutjs 的 twitter 引导自动完成下拉列表/组合框

> ID：12902010
> 
> 赞同：115
> 
> 时间：2012-10-15T18:45:40.570
> 
> 标签：autocomplete, combobox, twitter-bootstrap, knockout.js, html.dropdownlistfor

我有一个要求，我必须使用引导自动完成下拉菜单，但如果用户愿意，他们可以在该下拉菜单中拥有自由格式的文本。在您考虑 TypeAhead 之前，我可以使用 Bootstrap TypeAhead 文本框，但我需要有下拉菜单，因为我们想提供一些默认值作为 headstart 选项，以防用户不知道要搜索什么。

我将它与 MVC DropDownListFor 一起使用，因为它为我们创建了一个选择控件。

我发现这篇文章对我有用。

[https://github.com/danielfarrell/bootstrap-combobox/pull/20](https://github.com/danielfarrell/bootstrap-combobox/pull/20)

我所要做的就是从选择控件中删除名称，然后控件让我输入自由格式的文本。到目前为止一切都很好。

现在，我将它与 Knockoutjs 结合使用。我将我的选项和选定的值绑定到选择控件，然后在我的模板呈现的行上，我调用 (selector).combobox() 这使选择控件成为引导组合框并添加输入控件并在场景中隐藏选择控件在后面。

现在的问题是，当我尝试将他的值发布到服务器时，由于我在输入框中输入的值不是我为选择控件提供的选项中的有效选项，因此默认情况下它始终将其设置为第一个选项。这是因为，我在选择控件上设置了选定值的绑定，而不是在 bootstrap-combobox.js 创建的输入框上。

我的问题是如何让输入框数据绑定到与选择控件绑定的相同属性。

还有其他选择吗？？如果您需要更多说明或有疑问，请告诉我。请建议。

谢谢。

* * *

## 回答 #1

> 赞同：255
> 
> 时间：2012-10-16T12:31:57.193

看看[**Select2 的 Bootstrap**](https://select2.org/getting-started/basic-usage)。它应该能够做你需要的一切。

另一个不错的选择是[**Selectize.js**](https://selectize.github.io/selectize.js/)。Bootstrap 感觉有点原生。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2013-08-01T15:40:33.873

基本的 HTML5 数据列表是否有效？它很干净，您不必玩弄乱七八糟的第三方代码。[W3SCHOOL 教程](http://www.w3schools.com/tags/tryit.asp?filename=tryhtml5_datalist)

[MDN 文档](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/datalist)非常有说服力并提供示例。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-11-11T05:58:03.057

用于 Bootstrap 3 原生插件的 Select2

[https://fk.github.io/select2-bootstrap-css/index.html](https://fk.github.io/select2-bootstrap-css/index.html)

这个插件使用 select2 jquery 插件

nuget

PM> Install-Package Select2-Bootstrap

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-08-14T13:09:23.170

[Fuel UX 组合框](http://exacttarget.github.io/fuelux/#combobox)具有您期望的所有功能。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-05-11T19:43:46.843

我可以建议[http://www.jqueryscript.net/form/Twitter-Like-Mentions-Auto-Suggesting-Plugin-with-jQuery-Bootstrap-Suggest.html](http://www.jqueryscript.net/form/Twitter-Like-Mentions-Auto-Suggesting-Plugin-with-jQuery-Bootstrap-Suggest.html)吗，更像是推特帖子建议，它给你一个列表基于@或#标签的用户或主题，

在此处查看演示：[http ://www.jqueryscript.net/demo/Twitter-Like-Mentions-Auto-Suggesting-Plugin-with-jQuery-Bootstrap-Suggest/](http://www.jqueryscript.net/demo/Twitter-Like-Mentions-Auto-Suggesting-Plugin-with-jQuery-Bootstrap-Suggest/)

在这个中，您可以轻松地将 @ 和 # 更改为您想要的任何内容

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-01-21T18:50:06.190

Bootstrap Tokenfield 似乎也不错：[http ://sliptree.github.io/bootstrap-tokenfield/](http://sliptree.github.io/bootstrap-tokenfield/)

# asp.net-mvc - 如何以编程方式触发 Razor 视图设置的客户端验证？

> ID：12902013
> 
> 赞同：15
> 
> 时间：2012-10-15T18:45:57.930
> 
> 标签：asp.net-mvc, knockout.js, jquery-validate, asp.net-mvc-4

我有一个小的 Ajax 应用程序，我在其中使用 Razor 视图来最初生成 HTML 表单段，后来我使用 knockout.js 从中读取和写入。虽然我没有执行非 Ajax 操作请求，但我使用 Razor 生成 HTML，因此我喜欢自动生成 jQuery Validation 属性。例如，在我的单个页面中，我呈现了一个隐藏的表单，如下所示：

```
<section id="person-detail">
    @Html.Action("EditPartial", "Person")
</section> 
```

该`EditPartial`操作返回一个看起来很像这样的局部视图：

```
@using (Html.BeginForm())
{
    <fieldset>
        @Html.HiddenFor(model => model.Id, new { data_bind = "value: id" })
        <div class="editor-label">
            @Html.LabelFor(model => model.FirstName)
        </div>
        <div class="editor-field">
            @Html.TextBoxFor(model => model.FirstName, new { data_bind = "value: firstName" })
            @Html.ValidationMessageFor(model => model.FirstName)
        </div>
        <p>            
            <a href="#" data-bind="click: save">Update</a>&nbsp;&nbsp;
            <a href="#" data-bind="click: delete">Delete</a>
        </p>
    </fieldset>
} 
```

因为我实际上从未发布过表单，并且由于一些未知因素，尽管我`Person`模型上的所有属性都标有该`Required`属性，但我看不到客户端验证的迹象。单击保存按钮时，我必须做什么才能触发此验证？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-02-04T08:18:19.840

假设您的表单有一个“main”类：

```
 $('form').submit(function() {
            var $form = $('form.main');
            $form.valid();
    }); 
```

# mysql - 在 MySQL 选择查询输出中标记重复项

> ID：12902016
> 
> 赞同：1
> 
> 时间：2012-10-15T18:46:04.423
> 
> 标签：mysql, duplicates

到目前为止，我的 sql 查询在表上有一些连接，最终输出如下所示：

```
FLAG        id      name
----        ---     ----
OK          21      ken
OK          34      mon
OK          51      jil
OK          51      jil
OK          71      jil
OK          80      ron
OK          91      ron 
```

现在我希望重复名称的标志显示为最低 id 的“dup”：

```
FLAG        id      name
----        ---     ----
OK          21      ken
OK          34      mon
OK          51      jil
dup_51      51      jil
dup_51      71      jil
OK          80      ron
dup_80      91      ron 
```

我可以通过对存储在文件中的记录使用 shell/perl 脚本来做到这一点，但需要知道是否可以通过操作我的 SQL 查询来实现。感谢您的时间和帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T18:54:12.050

我建议使用一个子查询来跟踪重复条目`name`并返回每个重复项的最小值`id`。我假设您的表名为`tbl`：

```
select name, min(id) as dupId
from tbl
group by name
having count(name) > 1 
```

现在您可以将其与原始表连接起来：

```
select 
    tbl.*, if(not isnull(dupId), 'Ok', concat('dup_', dupId)) as flag2
from 
    tbl
    left join (
        select name, min(id) as dupId
        from tbl
        group by name
        having count(name) > 1) as a on tbl.name = a.name 
```

这是一种方法。希望它可以帮助你。

# c++ - 通过智能指针查找谁创建了对象

> ID：12902021
> 
> 赞同：1
> 
> 时间：2012-10-15T18:46:23.263
> 
> 标签：c++, memory-leaks, smart-pointers

几天前我发布了有关智能指针内存泄漏的信息。现在我能够找出哪些对象正在泄漏内存，但我无法弄清楚它们从哪里泄漏内存。

我正在使用与此处提到的相同代码 [检测引用计数对象中的内存泄漏](https://stackoverflow.com/questions/12826887/detecting-memory-leak-in-reference-counted-objects)

我已经阅读了很多评论，但没有一个能正确解释。我尝试使用宏**FILE**和**LINE**，它们都打印文件和 refmanager 类的行。

有没有调试这个问题的好方法。请也指出一些很好的例子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T19:44:49.370

最简单的方法可能是在 Windows 上使用 Valgrind（在 Linux 和 Mac 上）和一些类似的工具。

您还可以在智能指针的构造函数中获取回溯（在 Linux 和 Mac 上使用函数 backtrace() 函数）或 Windows 上 dbghelp.dll 中的类似函数，然后将回溯保存在分配的某处并删除回溯解除分配。然后在退出打印所有剩余的回溯。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-01T13:44:06.107

在 Windows 上，您可以使用 Visual Studio 2015 中的新内存诊断工具：

*   [http://blogs.msdn.com/b/vcblog/archive/2015/10/21/memory-profiling-in-visual-c-2015.aspx](http://blogs.msdn.com/b/vcblog/archive/2015/10/21/memory-profiling-in-visual-c-2015.aspx)

# asp.net - 在使用 asp.net C# 在访问数据库中插入数据之前检查重复项

> ID：12902025
> 
> 赞同：1
> 
> 时间：2012-10-15T18:46:45.560
> 
> 标签：asp.net

在插入数据之前，我尝试了以下查询以停止重复。它适用于 SQL 数据库，但不适用于 access 数据库。在将数据插入我的访问数据库之前，我希望相同的查询停止重复。等待正面回应。谢谢

```
IF NOT EXISTS (SELECT *
                 FROM dbo.Product
                WHERE email = @email)
   INSERT INTO dbo.Product(list of columns)
   VALUES (list of values) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T18:50:50.833

在这两种情况下（SQL Server 和 MS Access），您都应该在 Product 表的 email 列上创建一个适当的 UNIQUE INDEX。

对于 MS Access： http: [//office.microsoft.com/en-us/access-help/prevent-entry-of-duplicate-values-mdb-HP005187564.aspx](http://office.microsoft.com/en-us/access-help/prevent-entry-of-duplicate-values-mdb-HP005187564.aspx)

对于 SQL Server：[http ://technet.microsoft.com/en-us/library/ms189280.aspx](http://technet.microsoft.com/en-us/library/ms189280.aspx)

# java - 为重现 Soap 请求示例的 SOAP 消息创建 Java 代码

> ID：12902028
> 
> 赞同：0
> 
> 时间：2012-10-15T18:47:06.980
> 
> 标签：java, xml, soap

我正在尝试为获取 int[] 作为输入和输出的 Web 服务创建客户端。我找到了一个 Soap Request 示例，它显示了 SoapRequest 如何使用 Xml 传输数组。

```
<element name="myFavoriteNumbers"
        type="SOAP-ENC:Array"/>

<myFavoriteNumbers
  SOAP-ENC:arrayType="xsd:int[2]">
   <number>3</number> 
   <number>4</number> 
</myFavoriteNumbers> 
```

我的代码到现在

```
MessageFactory mf = MessageFactory.newInstance();
SOAPMessage sm = mf.createMessage();
SOAPHeader sh = sm.getSOAPHeader();
sh.setPrefix("S");
SOAPEnvelope envelope = sm.getSOAPPart().getEnvelope();
envelope.removeNamespaceDeclaration(envelope.getPrefix());
envelope.setPrefix("S");
          envelope.addNamespaceDeclaration("S",
        "http://schemas.xmlsoap.org/soap/envelope/");
SOAPBody sb = sm.getSOAPBody();
sb.setPrefix("S");           
SOAPElement container=sb.addChildElement("sum", "ns2",  webServicePkg);         
SOAPElement a = container.addChildElement("number1");
a.addTextNode(Integer.toString(arg1));
SOAPElement b = container.addChildElement("number2");
b.addTextNode(Integer.toString(arg2)); 
```

我所需要的只是转换我当前的 SoapMessage，以便它可以重现给定的 Xml 示例，以便它可以将这 2 个数字作为一个数组发送，而不是每个数字分开发送。

非常感谢

# list - Prolog，使用多个谓词

> ID：12902029
> 
> 赞同：0
> 
> 时间：2012-10-15T18:47:19.970
> 
> 标签：list, prolog

我刚刚开始使用 Prolog，但我不明白如何使用多个谓词。例如，我必须解决以下问题：用另一个列表的所有元素替换列表中的值。这是我到目前为止编写的代码：

```
domains
    elem=integer
    list=elem*

predicates
    %append to a list already created another list. There are 3 list parameters 
    %because I don't know other method 
    append (list,list,list)
    %This will search the list (the first one) for the searched element and   
    %it is it will replace it with the list(the second one). The result will be
    %kept in the third list.
    add(list,list,elem,list)

goal
    add([1,2,3,2,1],[4,5],2,L),
    write (L).  
clauses
    add ([],[_],_,[]).
    add ([A|L],L1,E,[A|L2]):-
        add(L,L1,E,L2).
    add ([E|L],L1,E,L2):-
        add(L,L1,E,L2).
    append([],[],L2).
    append([],[X|L1],[X|L2]):-
        append([],L1,L2). 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T20:01:32.383

你的`append`定义有效吗？我认为应该是

```
append([], L, L).
append([X|Xs], Ys, [X|Zs]):-
        append(Xs, Ys, Zs). 
```

`append`谓词它是 Prolog 编程中最基本的工具之一，更好地保持通常的行为，或者更改名称......

取而代之的是`add`一个更好的名字`replace_elem_with_list`。要实现它，您应该迭代，检查每个元素，并在找到与替换所需内容的匹配项时追加列表而不是复制元素。

就像是

```
% replace_elem_with_list(ToSearch, Replacement, SoughtElem, Result)
replace_elem_with_list([E|Es], Replacement, E, Result) :-
  !, replace_elem_with_list(Es, Replacement, E, Rs),
  append(Replacement, Rs, Result). 
```

我将留给您需要介绍的其他 2 种情况（当元素不匹配和递归基时，类似于追加）

结果：

```
?- replace_elem_with_list([1,2,3,4,2,3,4],[a,b],2,L).
L = [1, a, b, 3, 4, a, b, 3, 4]. 
```

# html - 创建响应式产品网格。我的宽度怎么了？

> ID：12902030
> 
> 赞同：1
> 
> 时间：2012-10-15T18:47:21.973
> 
> 标签：html, css, width, responsive-design

我创建了一个带有`width:90%`（和 10% 的填充）的容器，其中包含三个`display:inline`带有`width:30%`

这没有达到预期的效果，我希望三个 div 拉伸到容器的 30%，从而填满整个容器。

首先去创建一些响应式的东西。我打算将我的图像放在这些具有最大宽度的 div 中，以创建响应式产品网格。

[JS小提琴](http://jsfiddle.net/abrdn/)

正如您所看到的，当我希望它们扩展以填充内容区域时，产品 div 只是拉伸到文本的大小。

[活生生的例子](http://www.rubytuesdaycreative.co.uk/testsite/shop.html)

**CSS：**

```
.shoppg #content{
  width:90%;
  margin-top: 60px;
  margin-left:5%;
  margin-right:5%;
}

.product{
width:30%;
display:inline;
} 
```

**HTML：**

```
<div id="content">
      <div class="product">
        product 1
      </div>
      <div class="product">
        product 2
      </div>
      <div class="product">
        product 3
      </div>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T18:48:56.973

你只是忘了漂浮`.product`

```
.product{
    float:left;
    width:30%;
    display:inline;
} 
```

如果你浮动一个元素，该`display`属性是无用的，但`display:inline` [修复了一个 IE7 问题](http://www.positioniseverything.net/explorer/floatIndent.html)。

一些资源：

*   [http://css-tricks.com/all-about-floats/](http://css-tricks.com/all-about-floats/)
*   [http://coding.smashingmagazine.com/2007/05/01/css-float-theory-things-you-should-know/](http://coding.smashingmagazine.com/2007/05/01/css-float-theory-things-you-should-know/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T18:53:09.367

这是您要查找的内容：

[http://jsfiddle.net/abrdn/6/](http://jsfiddle.net/abrdn/6/)

基本上，您需要浮动它们以使它们满足填充以适应 div 的要求。

但是**由于您的最终目标是响应式设计**，因此您需要为您的产品 div 提供固定宽度，否则，当显示变得太小时，它们不会从同一行变为垂直堆叠。像这样...

[http://jsfiddle.net/abrdn/10/](http://jsfiddle.net/abrdn/10/)

请注意 div 是如何转到另一行的，而不是在使用百分比宽度时简单地挤在一起并变小。

您可以将其扩展一点，以`min-width`使用百分比进行固定以`width`使其填充，但是一旦达到最小宽度，然后转到新行，如下所示：

[http://jsfiddle.net/abrdn/12/](http://jsfiddle.net/abrdn/12/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-15T19:23:39.677

`display:inline-block;`+因为 inline-block为盒子模型`float:left;`添加了奇怪的`margin`/ 。`padding`但是`.product`' 的宽度不应该是`33.33333%`因为您将#content 的宽度除以 3 吗？然后`width:100%; height:auto; display:block;`用于图像，它们将整天填充和拉伸。

# ruby-on-rails - Rails 3：创建具有不同帖子类型（图像、链接、文本、视频）的帖子模型。我应该使用什么样的继承？

> ID：12902033
> 
> 赞同：4
> 
> 时间：2012-10-15T18:47:29.413
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我正在整理一个允许用户发布帖子的应用程序。每个帖子都有一个类型（图像、视频、链接、文本），其中包含相似和唯一的变量。我想通过整个站点可用的“作曲家”中的不同形式提交这些。

这是后期模型，画廊：

```
class Gallery < ActiveRecord::Base
    attr_accessible :name, :asset
    has_attached_file :asset, :styles => { :small => '160x120#', :medium => "500x", :thumb => "300x200#" }
    belongs_to :user
    has_many :likes
    validates :user_id, presence: true
    validates :type, presence: true
    validates :name, presence: true, length: { maximum: 140, minimum: 1 }
end 
```

我正在考虑使用单表继承，如下所示：

```
class Image < Gallery
end

class Link < Gallery
end

class Video < Gallery
end

class Text < Gallery
end 
```

但我没有达到我想要的结果。一方面，我想使用 Gallery 控制器中的方法，例如：

```
# galleries_controller.rb
def like 
    @gallery = Gallery.find(params[:id])
    @like = @gallery.likes.build(:user_id => current_user.id)
    respond_to do |format|
        if @like.save
        format.html { redirect_to @gallery }
        format.js
    end
end 
```

结尾

此外，我想创建一个“发布者”表单，其中包含每种帖子类型的表单，并允许您创建任何类型的帖子。

你会如何处理这个问题？我是 Rails 的新手，我想利用它提供的所有便利。非常感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T18:57:22.690

我会让 Gallery 成为一个抽象类，每个子类都有一个单独的数据库表。这将允许子类具有独特的属性以及共享的属性。

```
class Gallery < ActiveRecord::Base
  self.abstract_class = true # very important
  .
  .
end 
```

我会让画廊控制器多态：

```
class GalleriessController < ApplicationController
  before_filter :find_gallery

  private

  def find_gallery
    @klass = params[:gallery_type].capitalize.constantize
    @gallery = @klass.find(params[:gallery_id])
  end
end 
```

**意见：**

您可以使用 form_for @gallery 但它需要一些按摩才能与上面的多态控制器一起使用。它需要提交一个gallery_type 和gallery_id 参数而不仅仅是一个id。您可以修改 form_for 的 :url 参数来执行此操作或使用 hidden_​​fields。在 form_for 中，您可以使用部分，每个子类一个。

**路线：**

您可以像这样定义常规资源： resources :galleries 但是您需要将 id 参数设置为 gallery_id（并且始终传递galley_type 参数）。检查这个：[更改 Rails 路由中的 id 参数](https://stackoverflow.com/questions/2837102/changing-the-id-parameter-in-rails-routing)

**（可能的）结论**：

有时花哨的多态东西会很好地工作，但在其他情况下，更简单的蛮力方法可能更有意义：为每个子类设置一个控制器。这取决于实际情况。如果你最终做了太多 Rails 框架没有免费提供给你的东西，也许最好考虑另一种方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T05:52:43.840

我有一个类似的场景，在寻找一种实现它的好方法之后，我发现了我正在使用的这个 gem：

[https://github.com/hzamani/acts_as_relation](https://github.com/hzamani/acts_as_relation)

它使用多态 has_one 关联来模拟多表继承，因此在您的情况下，您可以执行以下操作：

```
class Gallery < ActiveRecord::Base
  acts_as_superclass
  ...
end

class Image < ActiveRecord::Base
  acts_as :gallery
  ...
end

class Link < ActiveRecord::Base
  acts_as :gallery
  ...
end 
```

我希望这可以帮助你。干杯!

# postgresql - PostgreSQL 命令未列出所有模式

> ID：12902036
> 
> 赞同：4
> 
> 时间：2012-10-15T18:47:47.650
> 
> 标签：postgresql

我想知道为什么`\d`只列出*公共*模式中的表？我在数据库中有另一个架构，*sps*，但这些表没有列出......

```
# psql -p 5432 -U postgres -h localhost myDB
Password for user postgres:
psql (9.1.5)
Type "help" for help.

myDB=# \d
                 List of relations
Schema |            Name            |   Type   |  Owner
--------+----------------------------+----------+----------
public | tableA                     | table    | postgres
public | tableB                     | table    | postgres
public | tableC                     | table    | postgres
public | table_col_seq              | sequence | postgres
(4 rows) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-15T18:49:57.043

你需要改变你的`search_path`. 在`psql`使用中`\dn`，然后构建您的`search_path`：

```
SET search_path = schema1,schema2,public; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-09-24T17:17:05.750

我在 Intellij IDEA 数据库选项卡中遇到了这个问题。

我得到了灵魂：数据源和驱动程序 -> YOUR_DATA_SOURCE -> 模式 -> 检查“所有数据库”

# c++ - 树莓派 C++ 分段错误

> ID：12902041
> 
> 赞同：0
> 
> 时间：2012-10-15T18:48:02.643
> 
> 标签：c++, raspberry-pi

我有一些用 C++ 编写的代码，当我在笔记本电脑上编译它时，结果显示，但是，我尝试将代码编译并运行到 RPI 上，但出现错误：

> 分段故障

该程序（当前）如何工作：

*   将（.wav）文件读入双精度向量（“rawData”）
*   将 rawData 拆分为块（阻塞）

当我尝试将数据拆分为块时，会发生分段错误。尺寸：

rawData - 57884 阻塞 - 112800

现在我知道 RPI 只有 256MB，这可能是问题所在，或者，我没有正确处理数据。我还包含了一些代码，以帮助演示事情是如何运行的：

（main.cpp）：

```
int main()
{
int N = 600;
int M = 200;

float sumthresh = 0.035;
float zerocorssthres = 0.060;

Wav sampleWave;

if(!sampleWave.readAudio("repositry/example.wav", DOUBLE))
{
    cout << "Cannot open the file BOOM";

}

// Return the data
vector<double> rawData = sampleWave.returnRaw();
// THIS segments (typedef vector<double> iniMatrix;)
vector<iniMatrix> blockked = sampleWave.something(rawData, N, M);

cout << rawData.size();

return EXIT_SUCCESS;   
} 
```

（功能：某物）

```
int n = theData.size();
int maxblockstart = n - N;
int lastblockstart = maxblockstart - (maxblockstart % M);

int numblocks = (lastblockstart)/M + 1;
vector< vector<double> > subBlock;
vector<double> temp;
this->width = N;
this->height = numblocks;

subBlock.resize(600*187);
for(int i=0; (i < 600); i++)
{
    subBlock.push_back(vector<double>());
    for(int j=0; (j < 187); j++)
    {   
        subBlock[i].push_back(theData[i*N+j]);
    } 
}    
return subBlock; 
```

任何建议将不胜感激 ：）！希望这是足够的描述。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T19:51:13.870

您可能在某处超出了数组（甚至可能不在您发布的代码中）。我也不确定您要对阻塞做什么，但我想您想将波形文件拆分为 600 个样本块？

如果是这样，我认为您想要更多类似以下的内容：

```
std::vector<std::vector<double>>
SimpleWav::something(const std::vector<double>& data, int N) {

    //How many blocks of size N can we get?
    int num_blocks = data.size() / N;

    //Create the vector with enough empty slots for num_blocks blocks
    std::vector<std::vector<double>> blocked(num_blocks);

    //Loop over all the blocks
    for(int i = 0; i < num_blocks; i++) {
        //Resize the inner vector to fit this block            
        blocked[i].resize(N);

        //Pull each sample for this block
        for(int j = 0; j < N; j++) {
            blocked[i][j] = data[i*N + j];
        }
    }

    return blocked;
} 
```

# javascript - 将日期范围过滤器应用于交叉过滤器维度

> ID：12902042
> 
> 赞同：4
> 
> 时间：2012-10-15T18:48:07.513
> 
> 标签：javascript, filter, d3.js, crossfilter

我正在尝试使用[crossfilter](http://square.github.com/crossfilter/) javascript 库（与[D3.js](http://d3js.org/)结合使用）对 json 数据进行分组和过滤。

我的 json 数据有以下字段： `week_date, category, team_name, title, subtitle`

我已经能够成功地对所有记录进行分组以生成 YTD 总数，使用如下所示：

```
var dimension = data.dimension(function(d) { return d[target]; });
var dimensionGrouped = dimension.group().all(); 
```

要么`target`要么。`category`_`team_name`

除了保留 YTD 总数之外，我还想显示给定范围的总数。例如，用户选择的一周（即 10 月 1 日至 5 日）。

**如何创建一个过滤组以返回给定日期范围的总数？使用我的 week_date 字段。**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-15T20:33:34.460

好吧，经过一些肤浅的研究，包括浏览 crossfilter 的[问题列表](https://github.com/square/crossfilter/issues)，我得出的结论是，crossfilter 目前不支持对多个字段进行分组。

我可以通过使用数据的过滤副本来解决这个问题，例如：

```
// YTD rows
var crossfilterData = crossfilter(data);
var ytdDimension = crossfilterData.dimension(function(d) { return d[target]; });
var ytdDimensionGrouped = ytdDimension.group().all();
ytdDimensionGrouped.forEach(function (item) {
    // ...
});

// Ranged rows
var filteredData = data.filter(function (d) {
    return d.week_date >= filter[0] && d.week_date <= filter[1];
});
crossfilterData = crossfilter(filteredData);
var rangeDimension = crossfilterData.dimension(function(d) { return d[target]; });
var rangeDimensionGrouped = rangeDimension.group().all();
rangeDimensionGrouped.forEach(function (item) {
    // ...
}); 
```

# c# - noda-time 在这种情况下是否适用？

> ID：12902043
> 
> 赞同：7
> 
> 时间：2012-10-15T18:48:19.370
> 
> 标签：c#, datetime, time, timezone, nodatime

我从事的项目基本上是一个数据收集器。通过定位，将其视为具有应用程序层（OSI 第 7 层）的解析/分析功能的 Wireshark（或等效项）可能会有所帮助。当前版本是具有 15 年以上历史的遗留 MFC 应用程序。它仍然有效，但维护、稳定性和可扩展性是我们面临的真正问题。项目领导团队最近同意我们需要开始开发下一代产品，我们的目标是 .NET，因为该产品严格来说是基于 Windows 桌面的产品。

鉴于我们的用户经常分析在世界各地收集的日志文件，消息时间戳非常重要。当前产品用于`_ftime_s()`分配时间戳，我曾假设我们将来会简单地用于`System.DateTime.UtcNow`在 .NET 端获取时间戳。也就是说，直到我读到[noda-time](http://code.google.com/p/noda-time/)。现在，我认为我们的问题域需要更多关注与时间相关的功能，这比我之前考虑的要多。

所以有几个问题。

1.  [根据我上面提供的描述，将noda-time](http://code.google.com/p/noda-time/)用于`NodaTime.Instant`时间戳是否有意义？

2.  如果可以选择，我更愿意为专门的支持付费，而不是因为害怕（偏执狂？）项目被放弃而使用开源项目。那些更倾向于接受开源哲学的人在这一点上有什么想法或指导吗？

3.  [noda-time](http://code.google.com/p/noda-time/)目前处于第二个测试阶段。NodaTime 1.0.0 有目标日期吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-07T08:33:20.927

1.  正如马特所说，你可以很容易地用它`DateTimeOffset`来表示一个瞬间。我认为它不像 using 那样清楚`Instant`，因为它表明您*实际上*可能对本地时间和偏移量感兴趣，而不仅仅是时间戳 - 但如果这是您使用 Noda Time的*唯一*原因, 坚持下去是有意义的`DateTimeOffset`。

2.  这是一种合理的恐惧，但你有我个人的话，我不会放弃野田时间。当然，相反的论点是，如果我*确实*放弃了它，你仍然可以修补它 - 而如果你使用商业产品并且公司倒闭，你会被卡住:) 我确实理解这种担忧。

3.  碰巧，我希望*今天*发布 v1.0.0 :)

# android - Monodroid - 如何调试 android 小部件

> ID：12902044
> 
> 赞同：2
> 
> 时间：2012-10-15T18:48:18.610
> 
> 标签：android, debugging, widget, xamarin.android, xamarin

如何使用 monodev 调试 android 小部件？我越来越

> 应用程序不包含可启动的活动

尝试将小部件作为常规应用程序调试时出错 ( `Run -> Start Debugging`)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T18:52:46.980

您必须将小部件应用到设备的桌面（启动器）以进行调试。

错误消息是正确的，可以忽略，因为如果您的应用程序仅用作小部件，则它不需要可启动的活动。

# c# - System.Random 不是那么随机，为什么会出现这种情况？

> ID：12902047
> 
> 赞同：1
> 
> 时间：2012-10-15T18:48:27.760
> 
> 标签：c#

> **可能重复：**
> [随机数生成器仅生成一个随机数](https://stackoverflow.com/questions/767999/random-number-generator-only-generating-one-random-number)

我已将在更大系统中观察到的行为提炼成以下代码序列：

```
for (int i = 0; i < 100; i++)
{
    Random globalRand = new Random(0x3039 + i);

    globalRand.Next();
    globalRand.Next();
    int newSeed = globalRand.Next();

    Random rand = new Random(newSeed);
    int value = rand.Next(1, 511);
    Console.WriteLine(value);
} 
```

从面向 .NET 4.5 的 Visual Studio 2012 运行此程序将输出 316 或 315。将其扩展超过 100 次迭代，您会看到该值缓慢递减（314、313...），但它仍然不是我想象的那样任何人都会考虑“随机”。

**编辑**

我知道 StackOverflow 上已经有几个问题询问为什么它们的随机数不是随机的。但是，这些问题存在以下问题：a）没有将种子（或相同的种子）传递给它们的 Random 对象实例，或者 b）做类似的事情`NextInt(0, 1)`并且没有意识到第二个参数是排他性的界限。对于这个问题，这些问题都不是真的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-15T18:51:05.613

它是一个伪随机生成器，它基本上创建了一个长（无限）的数字列表。该列表是确定性的，但在大多数实际场景中，顺序可以被视为随机的。然而，顺序是由种子决定的。

您可以实现的最随机的行为（没有花哨的裤子技巧，很难一直正确）是一遍又一遍地重用同一个对象。

如果您将代码更改为以下代码，您的行为会更加随机

```
Random globalRand = new Random();

for (int i = 0; i < 100; i++)
{
    globalRand.Next();
    globalRand.Next();
    int newSeed = globalRand.Next();

    Random rand = new Random(newSeed);
    int value = rand.Next(1, 511);
    Console.WriteLine(value);
} 
```

原因是伪随机生成器背后的数学基本上只是创建了一个无限的数字列表。

这些数字的分布几乎是随机的，但它们出现的顺序却不是。计算机是确定性的，因此无法产生真正的随机数（没有帮助），因此为了规避这个数学天才已经产生了能够产生这些数字列表的函数，这些函数对它们有很大的随机性，但种子决定了顺序。

给定相同的种子，函数总是产生相同的顺序。给定靠近每个订单的两个种子（其中 close 可以是使用哪个函数的属性），列表中的前几个数字几乎相同，但最终会非常不同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T18:52:29.183

使用第一个随机数生成第二个。不再让它变得“随机”。按照建议试试这个。

同样如建议的那样，无需在循环内生成随机对象。

```
 Random globalRand = new Random();

    for (int i = 0; i < 100; i++)
    {
        int value = globalRand.Next(1, 511);
        Console.WriteLine(value);
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T18:58:07.713

如果没有参数 Random c'tor 将当前日期和时间作为种子 - 您通常可以在内部计时器计算出当前日期和时间已更改之前执行大量代码。因此，您重复使用相同的种子 - 并重复获得相同的结果。来源：[http ://csharpindepth.com/Articles/Chapter12/Random.aspx](http://csharpindepth.com/Articles/Chapter12/Random.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-15T18:58:41.127

我相信这`Random()`是基于时间的，因此如果您的流程运行得非常快，如果您继续`Random()`在循环中创建新实例，您将得到相同的答案。尝试创建`Random()`循环的外部并使用`.Next()`来获得您的答案，例如：

```
Random rand = new Random(); 

for (int i = 0; i < 100; i++) 
{ 
    int value = rand.Next(); 
    Console.WriteLine(value); 
} 
```

# command-line - 我想在列中打印一个文本文件

> ID：12902049
> 
> 赞同：2
> 
> 时间：2012-10-15T18:48:35.840
> 
> 标签：command-line, printing, io, text-files

我有一个看起来像这样的文本文件：

jdkjf
kjsdh
jksfs
lksfj
gkfdj
gdfjg
lkjsd
hsfda
gadfl
dfgad

[很多行，就是]

但宁愿它看起来像

jdkjf kjsdh
jksfs lksfj
gkfdj gdfjg
lkjsd hsfda
gadfl dfgad

[等等]

所以我可以在更少的页面上打印文本文件。

当然，这不是一个难题，但我想知道是否有一些出色的工具可以解决此类问题。

编辑：我不是在寻找一种从文本文件中删除所有其他换行符的方法，而是一种将文本解释为“图片”然后将它们很好地放在页面上的工具（通过编写适当的空白符号）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T19:36:27.117

你可以使用这个 python 代码。

```
tables=input("Enter number of tables ")
matrix=[]
file=open("test.txt")
for line in file:
 matrix.append(line.replace("\n",""))
 if (len(matrix)==int(tables)):
  print (matrix)
  matrix=[]
file.close() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T07:33:27.713

*（由于您没有命名您的操作系统，我将简单地假设 Linux、Mac OS X 或其他一些 Unix...）*

您的示例看起来也可以用*“joining 2 lines together”*这个表达式来描述。

这可以**在 shell**`xargs`中实现（在and的帮助下`awk`）——但仅适用于结构类似于您的示例的输入文件（结果总是将 2 个单词放在一行上，而不管每个单词包含多少个单词）：

```
 cat file.txt | xargs -n 2 | awk '{ print $1" "$2 }' 
```

这也可以**单独实现****（`awk`**这次它真的加入了 2 整行，不管每行包含多少单词）：

```
 awk '{printf $0 " "; getline; print $0}' file.txt 
```

**或者使用`sed`**——

```
 sed 'N;s#\n# #' < file.txt 
```

另外，**`xargs`可以这样做：**

```
 xargs -L 2 < file.txt 
```

我相信其他人可以想出几十种其他完全不同的方法和命令行组合......

* * *

**注意事项：**您必须明确地测试具有奇数行的文件。如果行数为奇数，最后输入的行可能无法正确处理。

# visual-studio-2010 - QtGuid4.lib(QtGuid4.dll) LNK1112：模块机器类型“X86”与目标机器类型“x64”冲突

> ID：12902051
> 
> 赞同：1
> 
> 时间：2012-10-15T18:48:40.873
> 
> 标签：visual-studio-2010, qt, cmake

我使用 Cmake 制作我的 Qt 项目，并使用 Visual Stuio 2010 编译器在 QtCreater 中编译它。在旧计算机上我有 Windows 7 32 位并且运行正常，但在新计算机上我有 Windows 7 64 位并收到以下错误消息：**QtGuid4.lib(QtGuid4.dll):-1: Fehler:LNK1112: module machine**如果我使用*Visual C++ Compiler 10.0(x64) ，则***type 'X86' 与目标机器类型 'x64' 冲突**。如果我使用*Visual C++ Compiler 10.0(x86)*，则会收到以下消息：

> Der zum Debuggen von ausführbaren Dateien des Typs 'x86-windows-msvc2010-pe- 32bit' am besten geeignete Debugger-Engine ist nicht verfügbar。Es wird stattdessen der Debugger-Engine 'Gdb engine' benutzt。详细信息：Für ausführbare Dateien im Format 'x86-windows-msvc2010-pe-32bit' ist keine ausführbare CDB Datei verfügbar。

我如何使用 x64 编译器制作/编译？最好的祝福。维克多。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-18T15:00:24.880

从评论中复制，所以我们可以标记这个回答。

您有构建 64 位应用程序的设置，但您使用的 Qt 是 32 位。由于您不能将 32 位 Qt 与 64 位应用程序一起使用，您必须为 32 位构建应用程序或重新编译 Qt，以便您拥有 64 位 Qt。Qt 的官方下载不提供您需要自己构建的 64 位 Qt。

# ruby-on-rails-3 - Rails 3 - 在 respond_to 中设置文件名

> ID：12902052
> 
> 赞同：19
> 
> 时间：2012-10-15T18:48:44.003
> 
> 标签：ruby-on-rails-3, ruby-on-rails-3.2

这似乎应该很简单，但我似乎无法找到一个直接的答案。

我添加了一个 csv mime-type，以下似乎工作，**除了**下载的文件总是命名为“report.csv”。

在我的控制器中：

```
def report
  respond_to do |format|
    format.html
    format.csv do
      render :template => "summary/report.csv.erb",
             :filename => "foo" #doesn't work
    end
  end
end 
```

我认为它使用的是默认渲染器（我尚未实现备用渲染器），但我似乎无法找到有关可用选项的完整文档。

没有像“文件名”选项或我可以使用的东西吗？有更好的方法吗？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-10-15T19:50:54.793

我明白了，感谢[这个答案](https://stackoverflow.com/a/3876038/650475)的一些帮助。

```
format.csv do
  response.headers['Content-Disposition'] = 'attachment; filename="' + filename + '.csv"'
  render "summary/report.csv.erb"
end 
```

首先在响应头中设置文件名，然后调用`render`.

（模板参数`render`是可选的，但就我而言，我需要它。）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-10-07T02:51:15.077

您可以将文件名传递给`send_data`并让它处理 Content-Disposition 标头。

```
# config/initializers/csv_support.rb
ActionController::Renderers.add :csv do |csv, options|
  options = options.reverse_merge type: Mime::CSV
  content = csv.respond_to? :to_csv ? csv.to_csv : csv.to_s
  send_data content, options
end

# app/controllers/reports_controller.rb
respond_to do |format|
  format.html ...
  format.csv { render csv: my_report, filename: 'my_report.csv' }
end 
```

然后添加一个`to_csv`方法`my_report`或传递一个预先生成的 CSV 字符串。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-05-06T10:24:50.767

或者，您可以使用 send_data 和 render_to_string 的组合（因为您有一个 CSV 模板）。

```
def report
  respond_to do |format|
    format.html
    format.csv do
      send_data render_to_string(:template => "summary/report.csv.erb"),
             :filename => "foo"
    end
  end
end 
```

# ruby-on-rails-3 - Rails 3 在救援块中渲染

> ID：12902053
> 
> 赞同：0
> 
> 时间：2012-10-15T18:48:45.670
> 
> 标签：ruby-on-rails-3, exception-handling, transactions

我正在使用事务和异常处理动态创建一系列对象。现在它按预期处理回滚和所有事情，但我的救援块不会尝试呈现我告诉它的动作。

这是我处理交易的代码

```
def post_validation
  ActiveRecord::Base.transaction do
    begin
      params[:users].each do |user|
          #process each user and save here   
      end 
      redirect_to root_path #success
      rescue ActiveRecord::RecordInvalid
      # something went wrong, roll back          
      raise ActiveRecord::Rollback 
      flash[:error] = "Please resolve any validation errors and re-submit"          
      render :action => "validation"          
    end
  end    
end 
```

**失败时的预期：**回滚事务并呈现操作“验证”。

**失败时发生的情况：**回滚事务并尝试呈现不存在的视图“post_validation”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T17:22:56.790

好吧，我提供的代码似乎有一些问题。对于初学者来说，您不需要担心这`raise ActiveRecord::Rollback`条线，当在事务块内引发异常时，Rails 会在幕后执行此操作。此外，事务块需要在开始块内。所以生成的代码看起来像这样：

```
def post_validation
  begin      
    ActiveRecord::Base.transaction do
      #process some new records here
      redirect_to root_path 
    end
    rescue ActiveRecord::RecordInvalid
    # handle the exception here; the entire transaction gets rolled-back        
    flash[:error] = "Please resolve any validation errors and re-submit"          
    render :action => "validation"          
  end
end 
```

# c# - 有没有办法从一团天蓝色中获取所有文件

> ID：12902060
> 
> 赞同：10
> 
> 时间：2012-10-15T18:49:10.390
> 
> 标签：c#, azure, blob

我需要将我拥有的列表与 Azure Blob 存储中的文件进行比较，我需要的唯一部分是获取该 Blob 中文件列表的方法。

例如

> ```
> blob azureImages
> files:
> name
> something.jpg
> asd.jpg
> iwda.jpg 
> ```

```
my list:
name
something.jpg
asd.jpg 
```

当我将 blob 中的文件与列表进行比较时，我想删除列表中不匹配的文件。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-10-15T18:53:59.723

您可以使用 CloudBlobContainer.ListBlobs() 获取容器中的 Blob 列表，或者使用[CloudBlobDirectory.ListBlobs()](https://docs.microsoft.com/en-us/dotnet/api/microsoft.windowsazure.storage.blob.cloudblobcontainer.listblobs?view=azurestorage-8.1.3)获取[目录中的 Blob 列表](https://docs.microsoft.com/en-us/dotnet/api/microsoft.windowsazure.storage.blob.cloudblobdirectory.listblobs?view=azurestorage-8.1.3)

```
CloudBlobClient blobClient = new CloudBlobClient(blobEndpoint, new StorageCredentialsAccountAndKey(accountName, accountKey));

//Get a reference to the container.
CloudBlobContainer container = blobClient.GetContainerReference("container");

//List blobs and directories in this container
var blobs = container.ListBlobs();

foreach (var blobItem in blobs)
{
    Console.WriteLine(blobItem.Uri);
} 
```

您需要从 blobItem.Uri 解析文件名，但是您可以使用 LINQ 的 except() 方法来查找差异：

```
public string FindFilesToDelete(IEnumerable<string> fromAzure, IEnumerable<string> yourList)
{
     return fromAzure.Except(yourList);
} 
```

这将返回 fromAzure 列表中不在 yourList 中的所有内容。

[最后，您可以使用此示例](https://www.windowsazure.com/en-us/develop/net/how-to-guides/blob-storage/#delete-blobs)删除 blob

# mysql - 在 MySQL 中存储数百万个 3D 坐标 - 坏主意？

> ID：12902068
> 
> 赞同：4
> 
> 时间：2012-10-15T18:49:47.823
> 
> 标签：mysql, position, game-engine

全部-

所以我需要存储与视频游戏中的对象相关联的 3D 位置（x、y、z）。

我很好奇，这是一个可怕的想法吗？这些位置非常频繁地生成，并且可能会有所不同。

如果它不在已经存储的位置的一码内，我基本上只想将位置存储在我的数据库中。

我基本上是在游戏中选择对象的现有位置（通过 object_id、object_type、continent 和 game_version），循环并使用 PHP 计算距离。如果它> 1，我会插入它。

现在我大约有 700 万行（显然不是针对同一个对象），这效率不高，而且我正在使用的服务器正在爬行。

有人对我如何更好地存储这些信息有任何想法吗？我希望它以某种方式在 MySQL 中。

这是表的结构：

```
object_id
object_type (like unit or game object)
x
y
z
continent (an object can be on more than one continent)
game_version (positions can vary based on the game version) 
```

后来需要访问数据的时候，我基本上只通过object_id、object_type、continent、game_version来查询（所以我对这4个有索引）

谢谢！乔什

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T19:05:30.880

据推测，不同大陆上的物体被认为相距无限远。此外，您还没有披露您在表格中使用的单位。我假设英寸（一码有 36 英寸）。

因此，在插入点之前，您需要确定您是否在院子内。为此，您将需要 MySQL 地理扩展（您可以阅读）或至少在您的 x 和 y 列（可能还有 z 列）上单独索引。

院子内有任何点吗？此查询将让您了解在新点周围 +/- 1 码的边界框内是否有任何点。一个或多个的“附近”结果意味着您不应插入新点。

```
 SELECT COUNT(*) nearby
    FROM table t
   WHERE t.x between (?xpos - 36) AND (?xpos + 36)
     AND t.y between (?ypos - 36) AND (?ypos + 36)
     AND t.z between (?zpos - 36) AND (?zpos + 36)
     AND t.continent = ?cpos 
```

如果您需要查询使用笛卡尔距离而不是边界框，您可以添加平方和距离计算。但我怀疑边界框对您的应用程序来说会很好，并且比重复获取 75 行结果集以在您的应用程序中进行邻近测试更有效。

从概念上讲，为 MySQL 创建一个存储过程并不难，该存储过程只有在满足邻近条件时才会有条件地插入新行。这样，您就可以进行简单的单向事务，而不是服务器来回进行。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-10-15T19:08:38.603

它可能会杀死您的服务器，因为磁盘上的连续活动可以通过让 mysql 在内存中工作来修复，添加：ENGINE = MEMORY; 在你的桌子上定义。

# sql - 根据表值找出哪个模式

> ID：12902072
> 
> 赞同：4
> 
> 时间：2012-10-15T18:50:05.267
> 
> 标签：sql, django, postgresql, database-connection, postgresql-9.2

我的数据库根据客户端分为模式（即：每个客户端都有自己的模式，具有相同的数据结构）。

我也碰巧有一个不知道它应该针对哪个模式的外部操作。它来自系统的另一部分，它没有客户的概念，也不知道它在哪个客户的集合中运行。在处理它之前，我必须找出该请求需要针对哪个模式

要找到正确的模式，我必须找出`R`具有特定唯一 ID（字符串）的记录

据我了解，以下

```
SET search_path TO schema1,schema2,schema3,... 
```

只会查看 schema1 中的表（或与表匹配的第一个模式），并且不会进行全局搜索。

有没有办法让我在所有模式中进行全局搜索，还是我只需要使用 for 循环并一次一个地遍历所有模式？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-15T19:13:31.423

您可以为此使用[**继承。**](http://www.postgresql.org/docs/current/interactive/ddl-inherit.html)（一定要考虑[**限制**](http://www.postgresql.org/docs/current/interactive/ddl-inherit.html#DDL-INHERIT-CAVEATS)。）

考虑这个小演示：

```
CREATE SCHEMA master;  -- no access of others ..

CREATE SEQUENCE master.myseq;  -- global sequence to have globally unique id
CREATE table master.tbl (
  id int primary key DEFAULT nextval('master.myseq')
, foo text);

CREATE SCHEMA x;
CREATE table x.tbl() INHERITS (master.tbl);
INSERT INTO  x.tbl(foo) VALUES ('x');

CREATE SCHEMA y;
CREATE table y.tbl() INHERITS (master.tbl);
INSERT INTO  y.tbl(foo) VALUES ('y');

SELECT * FROM x.tbl;  -- returns 'x'
SELECT * FROM y.tbl;  -- returns 'y'
SELECT * FROM master.tbl;  -- returns 'x' and 'y' <-- !!

-- clean it all up:
-- DROP SCHEMA x, y, master CASCADE; 
```

现在，要实际识别特定行所在的表，请使用[**`tableoid`**](http://www.postgresql.org/docs/current/interactive/ddl-system-columns.html)：

```
SELECT *, tableoid::regclass AS table_name
FROM   master.tbl
WHERE  id = 2; 
```

结果：

```
id | foo | table_name
---+-----+-----------
2  | y   | y.tbl 
```

您可以从 中派生源模式`tableoid`，最好是直接使用 查询系统目录`tableoid`。（显示的名称取决于 的设置`search_path`。）

```
SELECT n.nspname 
FROM   master.tbl   t
JOIN   pg_class     c ON c.oid = t.tableoid
JOIN   pg_namespace n ON c.relnamespace = n.oid
WHERE  t.id = 2; 
```

这也比遍历许多单独的表要快得多*。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T19:04:39.723

您将不得不遍历所有命名空间。`pg_*`您可以从系统目录中获得大量此类信息。理论上，您应该能够在请求时解析客户端 -> 模式映射，而无需与数据库对话，因此您进行的第一个 SQL 调用是：

```
SET search_path = client1,global_schema; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-16T01:51:18.350

虽然我认为 Erwin 的解决方案可能更可取，如果您可以重新构造表，则不需要任何架构更改的替代方法是编写一个 PL/PgSQL 函数，该函数使用基于系统目录信息的动态 SQL 扫描表。

鉴于：

```
CREATE SCHEMA a;
CREATE SCHEMA b;

CREATE TABLE a.testtab ( searchval text );
CREATE TABLE b.testtab (LIKE a.testtab);

INSERT INTO a.testtab(searchval) VALUES ('ham');
INSERT INTO b.testtab(searchval) VALUES ('eggs'); 
```

下面的 PL/PgSQL 函数搜索所有包含以等于`_tabname`的值命名的表的模式，并返回第一个匹配的模式。`_colname``_value`

```
CREATE OR REPLACE FUNCTION find_schema_for_value(_tabname text, _colname text, _value text) RETURNS text AS $$
DECLARE
    cur_schema text;
    foundval integer;
BEGIN
    FOR cur_schema IN 
      SELECT nspname 
      FROM pg_class c 
      INNER JOIN pg_namespace n ON (c.relnamespace = n.oid) 
      WHERE c.relname = _tabname AND c.relkind = 'r'
    LOOP
      EXECUTE 
        format('SELECT 1 FROM %I.%I WHERE %I = $1', 
            cur_schema, _tabname, _colname
        ) INTO foundval USING _value;
      IF foundval = 1 THEN
        RETURN cur_schema;
      END IF;
    END LOOP;
    RETURN NULL;
END;
$$ LANGUAGE 'plpgsql'; 
```

如果没有匹配项，则返回 null。如果有多个匹配，结果将是其中之一，但不能保证是哪一个。`ORDER BY`如果您想按字母顺序或其他方式返回（例如）第一个子句，请在模式查询中添加一个子句。该函数也被简单地修改为返回`setof text`，`RETURN NEXT cur_schema`如果你想返回*所有*匹配项。

```
regress=# SELECT find_schema_for_value('testtab','searchval','ham');
 find_schema_for_value 
-----------------------
 a
(1 row)

regress=# SELECT find_schema_for_value('testtab','searchval','eggs');
 find_schema_for_value 
-----------------------
 b
(1 row)

regress=# SELECT find_schema_for_value('testtab','searchval','bones');
 find_schema_for_value 
-----------------------

(1 row) 
```

* * *

顺便说一句，如果你愿意，你可以在没有继承的情况下重用表定义，你真的应该这样做。要么使用常见的复合数据类型：

```
CREATE TYPE public.testtab AS ( searchval text );
CREATE TABLE a.testtab OF public.testtab;
CREATE TABLE b.testtab OF public.testtab; 
```

在这种情况下，它们共享相同的数据类型但不共享任何数据；或或通过`LIKE`：

```
CREATE TABLE public.testtab ( searchval text );
CREATE TABLE a.testtab (LIKE public.testtab);
CREATE TABLE b.testtab (LIKE public.testtab); 
```

在这种情况下，它们在创建后完全没有联系。

# objective-c - initWithNibName 是如何工作的？

> ID：12902075
> 
> 赞同：1
> 
> 时间：2012-10-15T18:50:07.977
> 
> 标签：objective-c, ios

我曾经以编程方式创建我的视图，并开始使用 XIB 文件进行切换。我找到了这段代码：

```
-(id)init
{
    self = [super initWithNibName:@"HelpViewController"  bundle:nil];
    if (self != nil) {
        // further initialization needed
    }

    return self;
}

-(id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    NSAssert(NO, @"Initialize with -init");
    return nil;
} 
```

它有效，但为什么？如果我遵循逻辑，initWithNibName 返回 nil 并将其设置为 self。所以，self 现在是 nil，然后你在 init 结束时返回 self。嗯，这意味着你返回 self ，它是 nil 。那正确吗？

另外，如果我想初始化一个 NSArray，我应该把它放在那个 init 函数的什么地方？

感谢您的解释。

伊科

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T19:13:52.173

因为init方法调用了self = [ **super** initWithNibName...]。所以你必须调用init方法来创建对象。如果您使用 initWithNibName 它将失败

对于 Array 你应该在 init 方法中初始化

```
-(id)init
{
    self = [super initWithNibName:@"HelpViewController"  bundle:nil];
    if (self != nil) {
        // further initialization needed
        myArray = [[NSMutableArray alloc] init];
    }

    return self;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T19:11:30.910

您正在查看两个不同的 initWithNibName 函数。

```
-(id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    NSAssert(NO, @"Initialize with -init");
    return nil;
} 
```

上面的函数覆盖了 initWithNibName 的超类版本。它提出一个断言，通知调用者使用 init。

```
self = [super initWithNibName:@"HelpViewController"  bundle:nil]; 
```

上面这行调用了 initWithNibName 的超类版本，它返回一个视图控制器。

如果你想初始化一个数组，你可以在“需要进一步初始化”注释的地方初始化它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-15T19:53:31.560

它之所以有效，是因为您在 super（很可能是 UIViewController）上调用 -initWithNibName:bundle:，而不是在 self（您的 UIViewController 的子类）上调用。如果您要在 self 上调用 initWithNibName:bundle，那么如果您禁用了断言，您将点击断言或返回 nil。-initWithNibName:bundle: 的超类实现不受您的实现影响，因此会继续正常运行。

# objective-c - Objective C Xcode 中的数组问题

> ID：12902079
> 
> 赞同：0
> 
> 时间：2012-10-15T18:50:12.913
> 
> 标签：objective-c, xcode, algorithm

我的计算疮的算法有问题。用户在 UITextField 中输入一个单词，如果该单词与数组中的字符串 (@"The Word") 匹配，则 int 'score' 将加 1。

然后 int 分数被设置为标签，因为用户得到了正确的单词。（显示分数）

问题是，用户可以一遍又一遍地输入同一个单词，分数会不断上升。是否有一个命令可以知道是否已经输入了一个单词，所以你只能使用这个单词一次。

编码

```
 NSArray *scoreArray1 = [NSArray arrayWithObjects:
@"Word 1", @"Word 2", @"Word 3", nil];

NSString *inputtwo =_EnterNameText.text;
BOOL isItright = NO;
for(NSString *possible in scoreArray1) {
    if([inputtwo isEqual:possible] ) {
        isItright = YES;
        break;
    }
}

if(isItright) {

    static int myInt = 0;
    myInt++;
    NSString *score = [NSString stringWithFormat:@"%d", myInt];
    [_scorelabel setText:score];

} 
```

更新！！！！！！

```
 NSArray *scoreArray1 = [NSArray arrayWithObjects:
@"Alan Shearer", @"Shearer", @"Andrew Cole", @"Andy Cole", @"Cole", @"Thierry Henry", @"Henry", @"Robbie Fowler", @"Fowler", @"Frank Lampard", @"Lampard", @"Michael Owen", @"Owen", nil];

NSSet *set2 = [NSSet setWithArray:scoreArray1];

NSString *inputtwo =_EnterNameText.text;
BOOL isItright = NO;
for(NSString *possible in set2) {
    if([inputtwo isEqual:possible] ) {
        isItright = YES;
        break;
    }
}

if(isItright) {

    static int myInt = 0;
    myInt++;
    NSString *score = [NSString stringWithFormat:@"%d", myInt];
    [_scorelabel setText:score];

} 
```

但是现在该应用程序无法正常工作，它崩溃了，有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T18:55:37.823

实际上，如果您有一个“合法”单词数组，那么要简单地删除每个被调用的单词，直到数组长度为零。

```
NSMutableArray* scoreArrayCopy = [NSMutableArray arrayWithArray:scoreArray];
int originalCount = scoreArrayCopy.count;
...
while (scoreArrayCopy.count > 0) {
   NSString* guess = <get next guess>;
   [scoreArrayCopy removeObject:guess];
   score = originalCount - scoreArrayCopy.count;
} 
```

（如果你有很多单词，那么使用 NSMutableSet 而不是 NSMutableArray 会更有效，但逻辑是相同的。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T18:54:12.627

为什么不保留第二个数组来存储给定（正确）答案。有了这个，你可以在你的 if.... 里面做一个 contains 问题解决了。

第二种选择不是将字符串放入您的数组中，而是将“Answer”对象放入其中，您可以将其标记为已使用的字段。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T18:55:18.543

您可以创建一个 NSMutableSet 并在输入单词时将单词的副本放入其中。然后你只需要在增加分数之前检查单词是否存在于集合中。

我建议使用一个集合，因为它使用散列访问，因此查找速度很快。此外，如果您多次添加相同的字符串，则该集合仍然只有一个对该字符串的引用。

# ruby-on-rails - Ruby on Rails：部分视图继承

> ID：12902080
> 
> 赞同：0
> 
> 时间：2012-10-15T18:50:17.253
> 
> 标签：ruby-on-rails, inheritance, partial-views

我想得到下一件事...

```
 # For ArticlesController > ApplicationController
    # in view
    render 'articles/edit/form'
    # tries 'app/views/articles/edit/_form.html.erb'
    # then tries 'app/views/articles/_form.html.erb'
    # then what it wants 
```

或者也许使用数组`partial`选项渲染：

```
 # For ArticlesController > ApplicationController
    # in view
    render_exists ['articles/edit/form', 'articles/new/form']
    # tries 'app/views/articles/edit/_form.html.erb'
    # then tries 'app/views/articles/new/_form.html.erb'
    # then what it wants 
```

这没有意识到，是吗？但也许是 3.2 或猴子补丁的一些宝石......你不知道关于它的拉取请求`rails`吗？谢谢！

**UPD**那不是基于控制器的视图继承。这应该适用于（在同一页面上）：

```
 render `articles/edit/form`
    render `comments/edit/form` 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T18:56:32.750

这已经存在，并且与控制器继承非常相似。

但是，您必须遵循常规策略。您可以将全局部分放入`app/views/application`，然后您可以在每个继承级别放置一个更具体的部分，例如`app/views/articles`.

请查看以下 railscast 了解更多详细信息：[#269 模板继承](http://railscasts.com/episodes/269-template-inheritance)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-14T23:37:20.600

我正在使用我[在 rails 论坛的一篇文章中描述的机制](http://archive.railsforum.com/viewtopic.php?id=12204)

尽管我听说最新版本中现在有一些内置支持，或者至少正在努力添加这样的功能，但它对我来说是一种享受。

# arrays - 如何计算二维数组中相同单元格的组？

> ID：12902086
> 
> 赞同：10
> 
> 时间：2012-10-15T18:50:29.670
> 
> 标签：arrays, algorithm

这是示例（计算黑色）：

输入：

![在此处输入图像描述](../Images/76c1291e1596b7e3fc7c00a8531be8b0.png)

输出：

```
5 4 // 5 groups (4 squares each)
1 1 // 1 group containing 1 square 
```

现在，我想不出比迭代痛苦更好的方法了。是否有可能以递归方式获得这些组？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T18:58:41.830

将所有黑色方块设置为节点。黑色方块之间的连接（如果方块彼此相邻）将是一条边。

这给了你一个[图表](http://en.wikipedia.org/wiki/Graph_%28mathematics%29)。

图中的[DFS](http://en.wikipedia.org/wiki/Depth-first_search)将为您提供所有组。请注意，DFS 本​​质上是递归的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T18:57:33.367

一开始，每个单元格都是“未访问的”。

我会遍历单元格，直到遇到“未访问”的黑色单元格。您在该点之前击中的每个白色单元格

一旦你击中一个黑色单元格，如果可能的话，你将它“扩展”到所有方向（类似于“floodfilling”）。您尽可能扩展并将所有访问过的单元格标记为“已访问”。在你这样做之后，你计算你感染了多少黑细胞，你就知道这个群体有多大了。检测到该组后，您继续进入下一个“未访问”的黑色单元。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T19:03:45.437

您可以使用具有 4 连接性的[连接组件标记算法](http://en.wikipedia.org/wiki/Connected-component_labeling)

# php - 如何在没有#的情况下链接到 div

> ID：12902087
> 
> 赞同：1
> 
> 时间：2012-10-15T18:50:32.020
> 
> 标签：php, html, ajax, .htaccess

我目前有一个响应式网站设计，其中包含 index.php 中的所有内容，并且仅根据正在查看的页面显示选定的 div。菜单选项卡只是链接到不同的“页面”（div），例如#blog。

我想有指向每个单独页面的“真实”链接，这样我就可以将 www.example.com/blog 链接直接指向我的博客，而不是 www.example.com/#blog

.ht 访问？阿贾克斯？将我所有的内容分成他们自己的 .html 并让 index.php 根据请求的任何页面加载它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T18:54:15.457

[pushState()](https://developer.mozilla.org/en-US/docs/DOM/Manipulating_the_browser_history#The_pushState%28%29.C2.A0method)或[replaceState()](https://developer.mozilla.org/en-US/docs/DOM/Manipulating_the_browser_history#The_replaceState%28%29.C2.A0method)是你想要的。然后，一旦你有了它，你还需要[通过 .htaccess 将所有请求路由到你的主页](http://www.josscrowcroft.com/2012/code/htaccess-for-html5-history-pushstate-url-routing/#give-me-teh-code)，然后在页面加载后将它们拾取。

# javascript - 为什么元素覆盖闪烁？

> ID：12902088
> 
> 赞同：1
> 
> 时间：2012-10-15T18:50:32.930
> 
> 标签：javascript, jquery

当鼠标悬停时，我正在尝试向 div 添加叠加层。虽然它有效，但当我在 div 内移动鼠标时，覆盖层会一直闪烁。我怎样才能防止这种情况？

**HTML：**

```
<div id="d4" class="dmc_block" style="width:60%; background:#eee; z-index:1">
    <div style="padding:20px;">
        <p>Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. </p>
    </div>
</div> 
```

**JS：**

```
$('body').on('mouseenter','.dmc_block',function(){
    var o = $(this).offset();
    var h = $(this).height();
    var w = $(this).width();
    $('<div>').addClass('hover').css({width:w,height:h,left:o.left,top:o.top,position:'absolute',zIndex:2}).insertAfter(this);
}).on('mouseleave','.dmc_block',function(){
    $('.hover').remove();
});    
$('body').on('mouseenter','.hover',function(){return false;}); 
```

小提琴：http: [//jsfiddle.net/T9Lhw/](http://jsfiddle.net/T9Lhw/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-15T18:53:36.107

改变这个：

```
.on('mouseleave','.dmc_block',function(){ 
```

对此：

```
.on('mouseleave','.hover',function(){ 
```

[**小提琴**](http://jsfiddle.net/ult_combo/T9Lhw/3/)

当叠加层`.hover`放置在上方`.dmc_block`时，它会触发`mouseleave`of，`.dmc_block`因为它现在位于 下方`.hover`。你想要的`mouseleave`是`.hover`.

# lua - (Corona SDK) 绘制区域

> ID：12902090
> 
> 赞同：2
> 
> 时间：2012-10-15T18:50:35.777
> 
> 标签：lua, touch, coronasdk, draw, area

我需要一些帮助......好吧，我正在我的游戏中创建一个长关卡。我的水平分辨率是 1280 x 960（高度 x 2），问题是当相机跟随物体时，我只能在 640 x 960 区域上画线，即使我画了我的线也会在 640 x 960 区域上画线在 1100 高度区域的某个地方...我无法弄清楚...线和相机来自电晕文档，而 moveCamera 来自 EggBreaker 示例...谢谢！

```
W = display.contentWidth;
H = display.contentHeight;

local function createPlatform(event)
if (event.phase == "began") then
        if(line) then
            line.parent:remove(line);
        end
        x = (event.x - (W/2 - 80));
        y = (event.y - (H/2));
        line = display.newLine(W/2 - 80, H/2, event.x, event.y)
        line.width = 5;
        physics.addBody(line, "static", {shape = {0, 0, x, y}});
        line.isBullet = true;
    end
    if (event.phase == "moved") then
        x = (event.x - (W/2 - 80));
        y = (event.y - (H/2));
        if (line) then
            line.parent:remove(line);
        end
        line = display.newLine(W/2 - 80, H/2, event.x, event.y)
        line.width = 5;
        physics.addBody(line, "static", {shape = {0, 0, x, y}});
        line.isBullet = true;
    end
    if (event.phase == "ended") then

    end
end

Runtime:addEventListener("touch", createPlatform)

--Camera follows bolder automatically
local function moveCamera()
  if (obj.x > 320 and obj.x < 960) then
    gameGroup.x = -obj.x + 320
  end
end

Runtime:addEventListener( "enterFrame", moveCamera ) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-05-15T22:20:38.007

你打电话时

```
fileTwo:stop(); 
```

您正在调用`transition.cancel( null )`，并且似乎使用 null 调用此函数会导致奇怪的行为。

如果你把这个放在fileTwo上

```
if(self.AnimationTransition ~= nil) then
    transition.cancel( self.AnimationTransition )
end 
```

问题消失了。

# regex - Perl 正则表达式匹配有效，但替换无效

> ID：12902093
> 
> 赞同：0
> 
> 时间：2012-10-15T18:50:52.353
> 
> 标签：regex, perl, file-io

我已经整理了一个 Perl 脚本来遍历目录并匹配源中的各种键并将结果输出到文本文件。匹配操作运行良好，但最终目标是执行替换操作。Perl 脚本如下：

```
 #!/usr/bin/perl
  #use strict;
  use warnings;

  #use File::Slurp;

  #declare variables
  my $file = '';
  my $verbose = 0;
  my $logfile;

  my @files = grep {/[.](pas|cmm|ptd|pro)$/i} glob 'C:\users\perry_m\desktop\epic_test\pascal_code\*.*';

  #iterate through the files in input directory
  foreach $file (@files) {

     print "$file\n";

     #read the file into a single string
     open FILEHANDLE, $file or die $!;
     my $string = do { local $/; <FILEHANDLE> };

     #perfrom REGEX on this string

     ########################################################
     #fix the include formats to conform to normal PASCAL
     $count = 0;
     while ($string =~ m/%INCLUDE/g)
     {
        #%include
        $count++;
     }
     if ($count > 0)
     {
        print " $count %INCLUDE\n";
     }
     $count = 0;
     while ($string =~ m/INCLUDE/g)
     {
        #%INCLUDE;
        $count++;
     }
     if ($count > 0)
     {
        print " $count INCLUDE\n";
     }
     $count = 0;
     while ($string =~ m/(%include\s+')[A-Za-z0-9]+:([A-Za-z0-9]+.[A-Za-z]+')/g)
     {
        #$1$2;
        $count++;
     }
     if ($count > 0)
     {
        print " $count XXXX:include \n";
     }        
  } 
```

这会根据需要产生输出，示例如下：

```
 C:\users\perry_m\desktop\epic_test\pascal_code\BRTINIT.PAS
   1 INCLUDE
   2 XXXX:include 
   39 external and readonly 
```

但是，如果我更改正则表达式操作以尝试执行替换，使用上面注释行中显示的替换操作，脚本将挂起并且永远不会返回。我想它在某种程度上与记忆有关，但我是 Perl 的新手。如果可能的话，我还试图避免逐行解析文件。

例子：

```
 while ($string =~ s/%INCLUDE/%include/g)
  {
     #%include
     $count++;
  } 
```

和

```
 while ($string =~ s/(%include\s+')[A-Za-z0-9]+:([A-Za-z0-9]+.[A-Za-z]+')/$1$2;/g)
  {
     #$1$2;
     $count++;
  } 
```

编辑：简化示例

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-15T19:07:21.160

问题出在你的`while`循环上。像一个循环

```
while ($string =~ m/INCLUDE/g) { ... } 
```

将为`INCLUDE`目标字符串中的每次出现执行一次，但是像

```
$string =~ s/INCLUDE/%INCLUDE;/ 
```

将一次性完成*所有*更换并返回已更换的数量。所以一个循环

```
while ($string =~ s/INCLUDE/%INCLUDE;/g) { ... } 
```

`INCLUDE`将在每个.之前和之后不断添加越来越多的百分号

要查找替换的数量，请将所有循环像这样更改为

```
$count = $string =~ s/INCLUDE/%INCLUDE;/g 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T19:06:46.200

中的模式`s/INCLUDE/%INCLUDE/g`也将与替换匹配，因此如果您在 while 循环中运行它，它将永远运行（直到内存不足）。

`s///g`将一次性替换所有匹配项，因此您很少需要将其放入循环中。也一样`m//g`，如果你把它放在列表上下文中，它会一步完成计数。

# drupal-7 - 如何以编程方式在 drupal 7 中添加新用户？我的自定义模块定义了一个带有自定义字段的表单

> ID：12902098
> 
> 赞同：3
> 
> 时间：2012-10-15T18:51:11.370
> 
> 标签：drupal-7, drupal-modules, drupal-forms

嗨，作为 drupal 的新手，请指导如何添加新用户，我知道可以使用带有 user_save 的用户模块，但是如何以及在哪里实现它？
我是否必须在下面的自定义表单的提交处理程序中编写此函数-

```
function registerme_newform($form, &$form_state) 
{
$form = array();
$form['account details'] = array(
'#type' => 'fieldset',
'#title' => t('Account Details'),
'#description' => t('Enter Personal Credentials'),
);
$form['account details']['first name'] = array(
'#type' => 'textfield',
'#title' => t('First Name'),
'#default_value' => t('Be sure of your first name'),
'#attributes' => array(
'onblur' => "if (this.value == '') {this.value = 'Be sure of your first name'}",
'onfocus' => "if (this.value == 'Be sure of your first name') {this.value = ''}" 
  , ), 
   ); 
 $form['account details']['last name'] = array(
'#type' => 'textfield',
'#title' => t('Last Name'),
'#default_value' => t('Be sure of your last name'),
'#attributes' => array(
'onblur' => "if (this.value == '') {this.value = 'Be sure of your last name'}",
'onfocus' => "if (this.value == 'Be sure of your last name') {this.value = ''}" 
   , ), );

 $form['account details']['email'] = array(
'#type' => 'textfield',
'#title' => t('E-Mail'),
'#required' => TRUE,
'#default_value' => t('Email acts as username.Dont forget it!'),
'#attributes' => array(
'onblur' => "if (this.value == '') {this.value = 'Email acts as username.Dont forget 
 it!'}",
'onfocus' => "if (this.value == 'Email acts as username.Dont forget it!')
 {this.value = ''}" 
   , ), 
 );

$form['account details']['password'] = array(
'#type' => 'password',
'#title' => t('Password'),
'#maxlength' => 60,
'#size' => 60,
'#required' => TRUE,
'#description' => t('Password should be atleast 6 characters long.'),
);

 $form['home'] = array(
'#type' => 'fieldset',
'#title' => 'Home Address',
'#description' => t('Enter Personal Residential Credentials')
 );

 $form['home']['street'] = array(
'#type' => 'textfield',
'#title' => 'Street Address',
 );

 $form['home']['city'] = array(
'#type' => 'textfield',
'#title' => 'City',
 );

 $form['work'] = array(
'#type' => 'fieldset',
'#title' => 'Work Address',
 '#description' => t('Enter Official Address')
 );

 $form['work']['street'] = array(
'#type' => 'textfield',
'#title' => 'Street Address',
 );

 $form['work']['city'] = array(
'#type' => 'textfield',
'#title' => 'City',
);

 $form['submit'] = array(
 '#type' => 'submit',
 '#value' => t('Register Me'),
 );

 return $form;

 }

 function registerme_newform_validate(&$form, &$form_state)
 {
 if($form_state['values']['account details']['first name']=='Be sure of your first
 name')
 {
  form_set_error('first name',t('Please enter your first name'));
 }
 } 
 function registerme_newform_submit(&$form, &$form_state)
 {
 dsm($form_state); 
  } 
```

还想知道如何在数据库中输入值，我的意思是如何将这些自定义字段添加到数据库中？请指导谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T17:02:32.697

首先请检查名字是否是允许的用户名。我建议您提供另一个字段来输入用户名，因为用户名已被其他人使用并不罕见。然后还要检查没有使用给定电子邮件地址注册的用户。

```
function registerme_newform_validate(&$form, &$form_state) {
  if($form_state['values']['account details']['first name']=='Be sure of your first
  name') {
  form_set_error('first name',t('Please enter your first name'));
  }
  // TODO: Provide user with a chance to enter a name ( drupal user name )
  // Also do the following two checks and report an error.
  // check using user_load_by_name($form_state['values']['account details']['first anme'])
  // check using user_load_by_mail($form_state['values']['account details']['email'])
} 
```

接下来在您的提交函数中，将表单值映射到可以传递给 user_save 的数组，如下所示。如果您想确切了解其他字段的映射方式，请使用 devel 模块通过查看已经存在的用户配置文件来检查结构。

```
function registerme_newform_submit(&$form, &$form_state){
  $new_user = array(
    // The below name field must be unique.
    'name' => $form_state['values']['account details']['name'],
    'pass' => $form_state['values']['account details']['password'],
    'mail' => $form_state['values']['account details']['email'],
    'init' => $form_state['values']['account details']['email'],
    'field_first_name' => array(LANGUAGE_NONE => array(array('value' => $form_state['values']['account details']['first name']))),
    'field_last_name' => array(LANGUAGE_NONE => array(array('value' => $form_state['values']['account details']['last name']))),
    // Map all the extra fields to user objects as shown above.
    ...

    'status' => 1,
    'access' => REQUEST_TIME,
    'roles' => $roles,
  );

  // $account returns user object
  $account = user_save(null, $new_user);
  //after user_save you can use the following code to send notification email.
  drupal_mail('user', 'register_no_approval_required', $account->mail, NULL, array('account' => $account), variable_get('site_mail', 'noreply@mysite.com'));
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-17T04:27:31.603

我对这个问题实施了不同的方法。我创建了一个实体表单 ( [https://drupal.org/project/entityform](https://drupal.org/project/entityform) )，在其中提示输入关键用户信息。我还安装了 profile2 模块，允许我创建备用配置文件。提交表单时，它会触发规则。该规则允许我创建用户，创建链接配置文件，然后向管理员发送一封电子邮件，其中包含指向新用户条目的链接，允许他们查看和激活。

如果您不想通过 PHP 解决或想在创建时创建其他内容，这是一个不错的选择。

# django - 在 sorl.thumnail 上设置动态裁剪

> ID：12902099
> 
> 赞同：0
> 
> 时间：2012-10-15T18:51:19.787
> 
> 标签：django, django-templates, sorl-thumbnail

我在我的模型上添加了一个字段，用于指定缩略图应从何处裁剪，但我似乎无法将其添加到模板标签中。

这是我现在的做法：

```
 {% if entry.main_image.crop_value == "center" %}
   {% thumbnail entry.main_image.image "350x100" crop="center" as im %}
        <a href="{{ entry.get_absolute_url }}"><img src="{{ im.url }}" width="{{ im.width }}" height="{{ im.height }}" alt=""></a>
    {% endthumbnail %}
  {% elif entry.main_image.crop_value == "top" %}
   {% thumbnail entry.main_image.image "350x100" crop="top" as im %}
        <a href="{{ entry.get_absolute_url }}"><img src="{{ im.url }}" width="{{ im.width }}" height="{{ im.height }}" alt=""></a>
    {% endthumbnail %}
  {% elif entry.main_image.crop_value == "bottom" %}
   {% thumbnail entry.main_image.image "350x100" crop="bottom" as im %}
        <a href="{{ entry.get_absolute_url }}"><img src="{{ im.url }}" width="{{ im.width }}" height="{{ im.height }}" alt=""></a>
    {% endthumbnail %}
  {% endif %} 
```

这难道不是最好的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T20:16:56.333

您可以在模板标签中使用该变量：

```
{% thumbnail entry.main_image.image "350x100" crop=entry.main_image.crop_value as im %} 
```

# sql-server - Bulk Insert Partially Quoted CSV File in SQL Server

> ID：12902110
> 
> 赞同：64
> 
> 时间：2012-10-15T18:52:09.043
> 
> 标签：sql-server, csv, bulkinsert

I'm trying to import a correctly quoted CSV file, meaning data is only quoted if it contains a comma, e.g.:

```
41, Terminator, Black
42, "Monsters, Inc.", Blue 
```

I observe that the first row imports correctly, but the second row errors in a manner that suggests the quoted comma was treated as a field separator.

I have seen suggestions such as this one

[SQL Bulk import from CSV](https://stackoverflow.com/questions/96448/sql-bulk-import-from-csv)

to change the field terminator

> FIELDTERMINATOR='","'

However, my CSV file only quotes fields that need it, so I do not believe that suggestion would work.

Can SQL Server's BULK IMPORT statement import a correctly quoted CSV file? How?

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-10-16T01:51:44.593

Unfortunately SQL Server interprets the quoted comma as a delimiter. This applies to both BCP and bulk insert .

From [http://msdn.microsoft.com/en-us/library/ms191485%28v=sql.100%29.aspx](http://msdn.microsoft.com/en-us/library/ms191485%28v=sql.100%29.aspx)

> If a terminator character occurs within the data, it is interpreted as a terminator, not as data, and the data after that character is interpreted as belonging to the next field or record. Therefore, choose your terminators carefully to make sure that they never appear in your data.

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2018-06-20T08:35:29.317

I know this is an old topic but this feature has now been implemented since SQL Server 2017\. The parameter you're looking for is FIELDQUOTE= which defaults to '"'. See more on [https://docs.microsoft.com/en-us/sql/t-sql/statements/bulk-insert-transact-sql?view=sql-server-2017](https://docs.microsoft.com/en-us/sql/t-sql/statements/bulk-insert-transact-sql?view=sql-server-2017)

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2014-12-12T09:59:33.487

There is another solution for this.

Consider the quotes as part of the fields delimiter, by editing the fmt file.

You can check this out for more information:

[http://blogs.msdn.com/b/sqlserverfaq/archive/2010/02/04/how-to-remove-unwanted-quotation-marks-while-importing-a-data-file.aspx](http://blogs.msdn.com/b/sqlserverfaq/archive/2010/02/04/how-to-remove-unwanted-quotation-marks-while-importing-a-data-file.aspx)

An extract of the link above:

The only way to remove the quotation marks would be to modify the column delimiters specified during the import operation. The only drawback here is that if you inspect the data to be inserted, you will very quickly realize that the column delimiters are different for each column (Delimiters highlighted above).

So to specify different column delimiters for each column, you would need to use a format file if you plan to use Bulk Insert or BCP. If you generate a format file for the above table structure, it would be as follows:

```
9.0
3
1       SQLCHAR       0       5       "\t"     1     FName              SQL_Latin1_General_CP1_CI_AS
2       SQLCHAR       0       5       "\t"     2     LName              SQL_Latin1_General_CP1_CI_AS
3       SQLCHAR       0       50      "\r\n"   3     Company            SQL_Latin1_General_CP1_CI_AS 
```

Modify the format file to represent the correct column delimiters for each column. The new format file to be used will look like this:

```
9.0
4
1       SQLCHAR       0       0     "\""      0     FIRST_QUOTE      SQL_Latin1_General_CP1_CI_AS
2       SQLCHAR       0       5     "\",\""   1     FNAME               SQL_Latin1_General_CP1_CI_AS
3       SQLCHAR       0       5     "\",\""   2     LNAME            SQL_Latin1_General_CP1_CI_AS
4       SQLCHAR       0       50    "\"\r\n"  3     COMPANY          SQL_Latin1_General_CP1_CI_AS 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2016-03-18T00:02:22.667

Make sure you have enabled TextQualified option and set it to be `"`.

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2016-03-02T07:28:32.540

I had this same problem, and I didn't want to have to go the SSIS route, so I found a PowerShell script that is easy to run and handles the case of the quotes with the comma in that particular field:

Source Code and DLL for the PowerShell Script: [https://github.com/billgraziano/CsvDataReader](https://github.com/billgraziano/CsvDataReader)

Here's a blog that explains the usage: [http://www.sqlteam.com/article/fast-csv-import-in-powershell-to-sql-server](http://www.sqlteam.com/article/fast-csv-import-in-powershell-to-sql-server)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-03-07T23:07:04.193

You could also look at using OpenRowSet with the CSV text file data provider.

This should be possible with any version of SQL Server >= 2005 although you need to enable the feature.

[http://social.msdn.microsoft.com/forums/en-US/sqldataaccess/thread/5869d247-f0a0-4224-80b3-ff2e414be402](http://social.msdn.microsoft.com/forums/en-US/sqldataaccess/thread/5869d247-f0a0-4224-80b3-ff2e414be402)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2016-06-22T20:52:20.457

I've spent half a day on this problem. It's best to import using SQL Server Import & Export data wizard. There is a setting in that wizard which solves this problem. Detailed screenshots here: [https://www.mssqltips.com/sqlservertip/1316/strip-double-quotes-from-an-import-file-in-integration-services-ssis/](https://www.mssqltips.com/sqlservertip/1316/strip-double-quotes-from-an-import-file-in-integration-services-ssis/) Thanks

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2014-10-01T12:11:04.760

I had the same problem, with data that only occasionally double-quotes some text. My solution is to let the BULK LOAD import the double-quotes, then run a REPLACE on the imported data.

For example:

bulk insert CodePoint_tbl from "F:\Data\Map\CodePointOpen\Data\CSV\ab.csv" with (FIRSTROW = 1, FIELDTERMINATOR = ',', ROWTERMINATOR='\n');

update CodePoint_tbl set Postcode = replace(Postcode,'"','') where charindex('"',Postcode) > 0

To make it less painful to write the REPLACE script, just copy and paste what you need from the results of something like this:

```
select C.ColID, C.[name] as Columnname into #Columns
from syscolumns C
join sysobjects T on C.id = T.id
where T.[name] = 'User_tbl'
order by 1;

declare @QUOTE char(1);
set @QUOTE = Char(39);
select 'Update User_tbl set '+ColumnName+'=replace('+ColumnName+','
 + @QUOTE + '"' + @QUOTE + ',' + @QUOTE + @QUOTE + ');
GO'
from #Columns
where ColID > 2
order by ColID; 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-11-21T07:55:21.417

I had the same problem, however, it worked for me with the following settings:

```
bulk insert schema.table
from '\\your\data\source.csv'
with (
datafiletype = 'char'
,format = 'CSV'
,firstrow = 2
,fieldterminator = '|'
,rowterminator = '\n'
,tablock
) 
```

My CSV-File looks like this:

```
"col1"|"col2"
"val1"|"val2"
"val3"|"val4" 
```

My problem was, I had rowterminator set to '0x0a' before, it did not work. Once I changed it to '\n', it started working...

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-10-15T19:20:57.737

Per CSV format specification, I don't think it matters if data is correctly quoted or not, as long as it adheres to specification. Excessive quotes should be handled by the parser, if it's properly implemented. `FIELDTERMINATOR` should be comma and `ROWTERMINATOR` is line end - this denotes a standard CSV file. Did you try to import your data with these settings?

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-09-18T18:48:28.677

Been stung by the same :)

I wrapped this logic into a function to clean up data that had been was already imported

```
DECLARE @str NVARCHAR(MAX);
DECLARE @quote_identifier NVARCHAR(MAX);

SET @quote_identifier = N'"';

SET @str = N'"quoted stuff"';

SELECT IIF(
           LEFT(@str, 1) = @quote_identifier
           AND RIGHT(@str, 1) = @quote_identifier,
           SUBSTRING(@str, DATALENGTH(@quote_identifier), LEN(@str) - DATALENGTH(@quote_identifier)),
           @str); 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2022-01-18T05:44:42.383

It seems this now works on partially quoted csv files as long as you include `FORMAT='CSV'` in the options. Once I added this, it worked as expected with a partially quoted file.

# objective-c - #else 正文中没有自动完成选项

> ID：12902114
> 
> 赞同：3
> 
> 时间：2012-10-15T18:52:14.750
> 
> 标签：objective-c, xcode, autocomplete, preprocessor-directive

在我班的顶部，我定义了一个标志：

```
#define CarsRandom 
```

然后稍后在我的一个方法中，我声明了一个 static`int`和一个`float`. 然后我想检查是否`CarsRandom`已定义并采取相应措施：

```
#ifdef CarsRandom
  //Everything is accesible in this part
#else
  //Even NSLog is not accessible
#endif 
```

问题在于，在该`#else`部分中，在方法开头声明的变量无法通过自动完成访问。虽然我可以成功构建项目，但我想知道为什么甚至`NSLog()`没有出现在自动完成列表中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T18:58:30.003

IDE，大概是 XCode，正试图变得聪明而失败。

它注意到 else 中的那段代码不会被编译，因此尝试完全忽略它，甚至忽略自动完成。

也许你可以把它写成一个普通的 if，否则在测试和重写时，如果你希望该代码被编译出来用于生产。

# c# - WCF REST JSON 服务返回错误 404/异常：System.Web.HttpException (0x80004005)

> ID：12902115
> 
> 赞同：0
> 
> 时间：2012-10-15T18:52:22.517
> 
> 标签：c#, asp.net, wcf, iis

我按照这个示例制作了我的第一个 WCF 服务：[WCF REST Service JSON](http://www.codeproject.com/Articles/327420/WCF-REST-Service-with-JSON)，然后对其进行了编辑以创建我自己的。我能够让我的服务在使用 ASP.NET Developer Server 进行调试时运行良好。我打开端口 8081（在服务器、防火墙和路由器上），然后将其分配给 IIS 中的“注册”文件夹。在花了一天时间弄清楚我必须使用 MsDeployAgentService 之后，我将该服务发布到运行 IIS 6 的 Windows Server 2003 上。然后我使用 IIS 将 ASP.NET 版本设置为 4.0.3019。Registration 文件夹包含 Service1.svc、Web.config 和 bin 文件夹。

这是我的网络配置文件：

```
<?xml version="1.0"?>
<configuration>
  <configSections>
    </configSections>
  <connectionStrings>
    <add name="ServiceApp.Properties.Settings.RegistrationConnection"
      connectionString="Data Source=EDITED;Initial Catalog=Registration;Persist Security Info=True;User ID=EDITED;Password=EDITED;MultipleActiveResultSets=True" />
  </connectionStrings>
  <system.web>
    <compilation debug="true" targetFramework="4.0" />
    <httpRuntime maxRequestLength="524288" />
  </system.web>
  <system.serviceModel>
    <bindings>
      <webHttpBinding>
        <binding name="StreamedRequestWebBinding"
                 bypassProxyOnLocal="true"
                 useDefaultWebProxy="false"
                 hostNameComparisonMode="WeakWildcard"
                 sendTimeout="10:15:00"
                 openTimeout="10:15:00"
                 receiveTimeout="10:15:00"
                 maxReceivedMessageSize="2147483647"
                 maxBufferSize="2147483647"
                 maxBufferPoolSize="2147483647"
                 transferMode="StreamedRequest">
          <readerQuotas maxArrayLength="2147483647"
                        maxStringContentLength="2147483647" />
        </binding>
      </webHttpBinding>
    </bindings>
    <services>
      <service name="ServiceApp.Service1" behaviorConfiguration="ServiceBehaviour">
        <endpoint address=""  binding="webHttpBinding" bindingConfiguration="StreamedRequestWebBinding" contract="ServiceApp.IService1" behaviorConfiguration="web">
        </endpoint>
          </service>
    </services>
    <behaviors>
      <serviceBehaviors>
        <behavior name="ServiceBehaviour">
          <serviceMetadata httpGetEnabled="true"/>
          <serviceDebug includeExceptionDetailInFaults="false"/>
        </behavior>
      </serviceBehaviors>
      <endpointBehaviors>
        <behavior name="web">
          <webHttp/>
        </behavior>
      </endpointBehaviors>
    </behaviors>
    <serviceHostingEnvironment multipleSiteBindingsEnabled="true" />
  </system.serviceModel>
  <system.webServer>
    <modules runAllManagedModulesForAllRequests="true"/>
  </system.webServer>
</configuration> 
```

当我尝试使用测试客户端使用该服务时，我收到错误 404 并带有以下语句

```
byte[] data = client.DownloadData("http://ServerIP:8081/Registration/Service1.svc/CheckSoftware/1/Customer1/1_0/abc123/1/1"); 
```

当我删除端口时，我收到错误 401“未授权”

```
byte[] data = client.DownloadData("http://ServerIP/Registration/Service1.svc/CheckSoftware/1/Customer1/1_0/abc123/1/1"); 
```

我尝试过使用 LAN IP 以及 WAN IP 地址。

[关注这篇文章](http://forums.asp.net/t/1807824.aspx/1)是因为它看起来像 OP遵循相同的示例并且有类似的问题，但它没有帮助。

然后我查看了服务器上的事件查看器，当我包含在端口号中时发现了这一点：

```
WebHost failed to process a request.
 Sender Information: System.ServiceModel.Activation.HostedHttpRequestAsyncResult/23878916
 Exception: System.Web.HttpException (0x80004005): The service '/Registration/Service1.svc' does not exist. ---> System.ServiceModel.EndpointNotFoundException: The service '/Registration/Service1.svc' does not exist.
   at System.ServiceModel.ServiceHostingEnvironment.HostingManager.EnsureServiceAvailable(String normalizedVirtualPath)
   at System.ServiceModel.ServiceHostingEnvironment.EnsureServiceAvailableFast(String relativeVirtualPath)
   at System.ServiceModel.Activation.HostedHttpRequestAsyncResult.HandleRequest()
   at System.ServiceModel.Activation.HostedHttpRequestAsyncResult.BeginRequest()
   at System.Runtime.AsyncResult.End[TAsyncResult](IAsyncResult result)
   at System.ServiceModel.Activation.HostedHttpRequestAsyncResult.End(IAsyncResult result)
 Process Name: w3wp

 Process ID: 3460 
```

我可以清楚地看到文件夹中存在 Service1.svc 文件。在这一点上我很迷茫，希望能得到任何帮助。

**编辑以包含更多代码：**

```
 namespace ServiceApp
{
    [ServiceContract]
    public interface IService1
    {

        [OperationContract]
        [WebInvoke(Method = "GET", 
          UriTemplate = "/CheckSoftware/{SoftwareId}/{CustomerId}/{Version}/{Key}/{MoboID}/{ProcessorID}",
          RequestFormat = WebMessageFormat.Json, 
          ResponseFormat = WebMessageFormat.Json)]
        SoftwareStatus CheckSoftware(string SoftwareID, string Version, string CustomerID, string Key, string moboID, string processorID);

        [OperationContract]
        [WebInvoke(
          Method = "GET", 
          UriTemplate = "/SaveKey/{SoftwareId}/{CustomerId}/{Key}/{MoboID}/{ProcessorID}",
          RequestFormat = WebMessageFormat.Json, 
          ResponseFormat = WebMessageFormat.Json)]
        string SaveKey(string SoftwareID, string CustomerID, string Key, string moboID, string processorID);
    }

    [DataContract]
    public class FileInformation
    {
        [DataMember]
        public string Name
        {
            get;
            set;
        }

        [DataMember]
        public byte[] Content
        {
            get;
            set;
        }
    }

    [DataContract]
    public class Employee
    {
        [DataMember]
        public int Id
        {
            get;
            set;
        }

        [DataMember]
        public string Name
        {
            get;
            set;
        }
    }
    [DataContract]
    public class SoftwareKey
    {
        [DataMember]
        public string SoftwareId
        {
            get;
            set;
        }
        [DataMember]
        public string CustomerId
        {
            get;
            set;
        }
        [DataMember]
        public string Version
        {
            get;
            set;
        }
        [DataMember]
        public string Key
        {
            get;
            set;
        }
    }

    [DataContract]
    public class SoftwareStatus
    {
        [DataMember]
        public Boolean SoftwareId
        {
            get;
            set;
        }
        [DataMember]
        public Boolean CustomerId
        {
            get;
            set;
        }
        [DataMember]
        public Boolean Version
        {
            get;
            set;
        }
        [DataMember]
        public Boolean Key
        {
            get;
            set;
        }
        [DataMember]
        public Boolean HardwareID
        {
            get;
            set;
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T22:53:26.320

您的 UriTemplate 设置是否正确？404 错误表明它根本没有与服务/方法联系。

REST 服务是简单的 web api，而不是像普通 WCF 服务那样尝试导入服务，而是尝试普通的 http 请求（只是一个简单的例子，不是解决方案）：

```
 //declare the request (not sure of your uri, so i guessed)
    var queryString = string.Format("1/{0}/1_0/{1}/1/1", Param1, Param2);
    var req = 
        HttpWebRequest)WebRequest.Create("http://ServerIP:8081/Registration/Service1.svc/CheckSoftware/"); //base address of service
    req.Method = "POST";
    req.ContentType = "application/x-www-form-urlencoded";

    //build the fields stream
    var fields = Encoding.UTF8.GetBytes(queryString);
    req.ContentLength = fields.Length;

    //put the request info into the stream
    var requestStream = req.GetRequestStream();
    requestStream.Write(fields, 0, fields.Length);
    requestStream.Close();

    //execute the request
    var resp = (HttpWebResponse)req.GetResponse();

    //pull your infos
    var statusCode = (int)resp.StatusCode;
    var body = new StreamReader(resp.GetResponseStream()).ReadToEnd(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T13:13:30.477

将 IIS 6.0 用于服务时，我不需要在 URL 中包含文件夹名称。所以简单地改变一行代码就解决了我的问题。

```
byte[] data = client.DownloadData("http://ServerIP:8081/Service1.svc/CheckSoftware/1/Customer1/1_0/abc123/1/1"); 
```

# php - 下载 - 每个用户的最大连接数？

> ID：12902129
> 
> 赞同：7
> 
> 时间：2012-10-15T18:53:32.377
> 
> 标签：php, html

我有一个 php 脚本，它允许用户下载带有下载简历的大文件。

这工作正常，但我已将 php 代码的下载速度限制为每个连接 200kb/s。

因此，Mozilla 的 Firefox 下载管理器只建立一个连接，速度约为 200kb/s，但 Free-Download-Manager 或 JDownloader 建立了 2 到 4 个连接，所以下载速度为 (200Kb/s * 2 或 4) = 400 到800kb/秒。

**我怎样才能停止这种情况并只允许每个用户使用一个连接来下载此文件？**

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-15T19:34:24.937

**A**. I think the first thing for you is to disable `Content-Range` ..

[14.16 Content-Range](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html)

> The Content-Range entity-header is sent with a partial entity-body to specify where in the full entity-body the partial body should be applied. Range units are defined in section 3.12.

Download manager can download a single fine in 2 or multiple connections because of range .. if you disable this both `download resume` or `multiple connections` can not be made on a single file. they would make every request to the file start from the beginning

Example

```
LoadModule headers_module modules/mod_headers.so 
Header set Accept-Ranges none 
RequestHeader unset Range 
```

You should also look at [14.35.1 Byte Ranges](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.35.1)

**B**. Introduce Download Sessions .

You can generate a `uniqid id` for each download and serve it via PHP page. If the download is still active or has been requested before you just exist the page

Example

```
$realFile = "test.pdf";
$fakeFile = uniqid("file");

$uniqid = isset($_REQUEST['id']) ? $_REQUEST['id'] : null;
if (empty($uniqid) || strlen($uniqid) < 20 || !ctype_xdigit($uniqid)) {
    die("Die! Die! Die! Stolen URL");
}
$memcache = new \Memcache();
$memcache->connect('localhost', 11211);

$runtime = (int) $memcache->get($uniqid);

if ($runtime) {
    die("Die! Die! Die! You Multiple Down loader");
} else {
    header("Expires: Mon, 26 Jul 1997 05:00:00 GMT\n");
    header("Last-Modified: " . gmdate("D, d M Y H:i:s") . " GMT");
    header("Content-Transfer-Encoding: binary");
    header("Content-disposition: attachment; filename=$fakeFile.pdf"); //
    header('Content-type: application/pdf');
    header("Content-length: " . filesize($realFile));
    readfile($realFile);
    $memcache->set($uniqid, 1);
} 
```

Simple Client

```
$url = "a.php?id=" . bin2hex(mcrypt_create_iv(30, MCRYPT_DEV_URANDOM));
printf("<a href='%s'>Download Here</a>",$url); 
```

It would output something like

```
<a href='a.php?id=aed621be9d43b0349fcc0b942e84216bf5cd34bcae9b0e33b9d913cccd6e'>Download Here</a> 
```

You also need map each id to a particular file ...

# python - 使用堆排序的错误输出（用python编写）

> ID：12902134
> 
> 赞同：0
> 
> 时间：2012-10-15T18:53:43.350
> 
> 标签：python, algorithm, sorting, heap, heapsort

我编写了以下堆排序代码，有时会得到错误的输出（未排序），我似乎无法找到原因......任何帮助将不胜感激！

```
def heap_sort(self, a):

    heapsize = self.build_max_heap(a)

    n = len(a)-1
    i = len(a)-1

    for i in range(i, 0, -1):
        temp = a[0]
        a[0] = a[i]
        a[i] = temp
        heapsize = heapsize - 1
        self.max_heapify(heapsize, a, 0)       #rebuild max heap at with new root

    return a

def max_heapify(self, heapsize, a, i):

    left = (2*(i+1))-1      #left child of i
    right = 2*(i+1)             #right child of i
    largest = i

    if left < heapsize and a[left] > a[i]:
        largest = left

    if right < heapsize and a[right] > a[largest]:
        largest = right

    if largest != i:
        temp = a[largest]
        a[largest] = a[i]
        a[i] = temp
        self.max_heapify(heapsize, a, largest)

def build_max_heap(self, a):

    heapsize = len(a)
    i = int(heapsize/2)-1

    for i in range(i, 0):
        self.max_heapify(heapsize, a, i)

    return heapsize 
```

我的测试：

```
#--Test for 0 in array--#
def zero_array(self):
    a = [12,0,232]
    print self.sort.heap_sort(a)
    return

#--Test for duplicate in array--#
def duplicate_array(self):
    a = [12, 12, 7]
    print self.sort.heap_sort(a)
    return

#--Test for all same values in array--#
def allsame_array(self):
    a = [1,1,1]
    print self.sort.heap_sort(a)
    return

#--Test for negative values in array--#
def negative_array(self):
    a = [-23, -2, 123]
    print self.sort.heap_sort(a)
    return 
```

输出（应该全部排序）：

```
 [0, 232, 12]
    [7, 12, 12]
    [1, 1, 1]
    [-2, 123, -23] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T18:59:18.580

这可能是因为你的第二个`range()`是向前而不是向后递增。

```
for i in range(i, 0): 
```

应该：

```
for i in range(i, 0, -1): 
```

您还需要记住，`range()`它将在第二个参数之前停止，因此`range(5, 0, -1)`将返回`[5, 4, 3, 2, 1]`。

# jquery - jQuery选择父级的非固定兄弟

> ID：12902136
> 
> 赞同：0
> 
> 时间：2012-10-15T18:53:56.917
> 
> 标签：jquery, jquery-selectors

所以我正在尝试使用 jQuery 来选择这样的元素：

```
<div>
    <ul>
        <li>First item</li>
        <li>Second item</li>
        <li>Third item</li>
    <ul>
</div>
<div>Item to be operated on when the first li is clicked.</div>
<div>Item to be operated on when the second li is clicked.</div>
<div>Item to be operated on when the third li is clicked.</div> 
```

当然，我正在寻找开始我的 jQuery 函数

```
$('ul li') 
```

有没有办法在没有多次 dom 潜水的情况下做到这一点？我本质上需要的是“next().next().next()”，如果它不仅对直接兄弟姐妹起作用。假设我不能在标记周围移动。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T18:55:20.197

在这种情况下，您可能会这样做：

```
$('div').eq($(this).index()+1); 
```

请参阅[eq 函数](http://api.jquery.com/eq/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-15T18:55:41.723

您可以使用`.index()`来选择相应的`div`元素：

```
var $divs = $('div');

$('ul li').click(function() {
    var $div = $divs.eq($(this).index() + 1);
}); 
```

# wpf - 如何将命令行为附加到 ListView 中的 TextBox？

> ID：12902137
> 
> 赞同：1
> 
> 时间：2012-10-15T18:53:57.993
> 
> 标签：wpf, mvvm, prism, prism-4

我正在使用股票交易者参考实现的示例代码。

[http://prism4.googlecode.com/svn/trunk/Prism4/](http://prism4.googlecode.com/svn/trunk/Prism4/)

PositionSummaryView.xaml 中有一个股票列表。在股票列表中，我添加了一个带有显示股票名称的文本框的 GridViewColumn。当用户通过使用行为 ReturnCommandBehavior 按下回车键时，我尝试在 ViewModel 中调用命令。

当我在文本框中按 Enter 时，该命令未命中。当我在列表之外有相同的文本框时，命令被命中。

这适用于 ListView

```
<TextBox Grid.Column="0"  Text="test"    Infrastructure:ReturnKey.Command="{Binding Path=UpdateTickerSymbolCommand}"  ></TextBox> 
```

这是我在 TextBox 中尝试的绑定，但没有一个有效：

```
 <TextBox Grid.Column="0"  Text="{Binding  Path=TickerSymbol}"  
                                  Infrastructure:ReturnKey.Command="{Binding Path=UpdateTickerSymbolCommand, RelativeSource={RelativeSource AncestorType={x:Type ListView}}}"  ></TextBox> 
```

第二次尝试

```
 <TextBox Grid.Column="0"  Text="{Binding  Path=TickerSymbol}"   Infrastructure:ReturnKey.Command="{Binding ElementName=root,Path= UpdateTickerSymbolCommand}" ></TextBox> 
```

这是视图模型：

```
using System.ComponentModel.Composition;
using System.Windows.Input;
using Microsoft.Practices.Prism.Events;
using Microsoft.Practices.Prism.ViewModel;
using StockTraderRI.Infrastructure;
using StockTraderRI.Modules.Position.Controllers;
using Microsoft.Practices.Prism.Commands;

namespace StockTraderRI.Modules.Position.PositionSummary
{
    [Export(typeof(IPositionSummaryViewModel))]
    [PartCreationPolicy(CreationPolicy.NonShared)]
    public class PositionSummaryViewModel : NotificationObject, IPositionSummaryViewModel
    {
        private PositionSummaryItem currentPositionSummaryItem;

        private readonly IEventAggregator eventAggregator;

        public IObservablePosition Position { get; private set; }

        private ICommand updateTickerSymbolCommand;

        public ICommand UpdateTickerSymbolCommand { get { return this.updateTickerSymbolCommand; } }

        [ImportingConstructor]
        public PositionSummaryViewModel(IOrdersController ordersController, IEventAggregator eventAggregator, IObservablePosition observablePosition)
        {
            this.eventAggregator = eventAggregator;
            this.Position = observablePosition;

            BuyCommand = ordersController.BuyCommand;
            SellCommand = ordersController.SellCommand;
            updateTickerSymbolCommand = new DelegateCommand<string>(this.UpdateTickerSymbol); ;

            this.CurrentPositionSummaryItem = new PositionSummaryItem("FAKEINDEX", 0, 0, 0);
        }

        private void UpdateTickerSymbol(string tickerSymbol)
        {

        }

        public ICommand BuyCommand { get; private set; }

        public ICommand SellCommand { get; private set; }

        public string HeaderInfo
        {
            get { return "POSITION"; }
        }

        public PositionSummaryItem CurrentPositionSummaryItem
        {
            get { return currentPositionSummaryItem; }
            set
            {
                if (currentPositionSummaryItem != value)
                {
                    currentPositionSummaryItem = value;
                    this.RaisePropertyChanged(() => this.CurrentPositionSummaryItem);
                    if (currentPositionSummaryItem != null)
                    {
                        eventAggregator.GetEvent<TickerSymbolSelectedEvent>().Publish(
                            CurrentPositionSummaryItem.TickerSymbol);
                    }
                }
            }
        }
    }
} 
```

按下回车键时我需要点击 UpdateTickerSymbol 什么？

**编辑**

我现在看到我误解了

```
Binding ElementName=root 
```

在一些示例代码中。我认为 root 是一个关键字，但它是必须赋予视图中的父控件的键

这就是为什么我用

```
 <StackPanel x:Name="LayoutRoot" > 
```

现在在父控件中

```
<TextBox Grid.Column="0"  Text="{Binding  Path=TickerSymbol}"   Infrastructure:ReturnKey.Command="{Binding ElementName=LayoutRoot, Path=UpdateTickerSymbolCommand}" ></TextBox> 
```

对于文本框，但该命令仍未命中。

我还在示例中使用 Button 尝试了上述语法，并且它有效

```
<Button Grid.Column="0" Command="{Binding Path=DataContext.BuyCommand, ElementName=LayoutRoot}" CommandParameter="{Binding Path=TickerSymbol}" AutomationProperties.AutomationId="ActionsBuyButton" Template="{StaticResource AddButtonTemplate}"  Cursor="Hand" Width="30" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T03:23:30.047

您可以简单地使用 TextBox.InputBindings 并且希望在文本上使用 Mode=TwoWay 和 UpdateSourceTrigger=PropertyChanged。

**.xaml**

```
 <ListView HorizontalAlignment="Stretch" 
              Height="Auto" 
              ItemsSource="{Binding Collection}"
              VerticalAlignment="Stretch" 
              Width="Auto">
        <ListView.ItemTemplate>
            <DataTemplate>
                <TextBox Width="100" 
                         Text="{Binding MyText, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                    <TextBox.InputBindings>
                        <KeyBinding Key="Enter" Command="{Binding MyCommand}" />
                    </TextBox.InputBindings>
                </TextBox>
            </DataTemplate>
        </ListView.ItemTemplate>
    </ListView> 
```

您的数据模型将是

**。CS**

```
public class DataModel : INotifyPropertyChanged
{
    private string m_myText;
    public string MyText
    {
        get { return m_myText; }
        set 
        { 
            m_myText = value;
            OnPropertyChanged("MyText");
        }
    }

    public ICommand MyCommand { get; set; }

    public event PropertyChangedEventHandler PropertyChanged;

    public void OnPropertyChanged(string propertyName)
    {
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
        }
    }
} 
```

视图模型上的集合

**视图模型.cs**

```
Collection = new ObservableCollection<DataModel> { new DataModel() { MyText = String.Empty, MyCommand = m_myCommand } }; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-22T17:54:19.447

我下载了源码。文本框似乎消失了。将 TextBox 的命令更改为 DataContext.BuyCommand “修复”了“问题”。命令“UpdateTickerSymbolCommand”似乎也不再可用，所以我也无法测试它。当前源也没有对 StackPanel (LayoutRoot) 的引用，所以我也无法跟踪。我认为这里的关键问题是没有正确设置命令。

# asp.net - 带有经典 ASP + ASP.NET 2.0 的 Oracle 64 位

> ID：12902140
> 
> 赞同：1
> 
> 时间：2012-10-15T18:54:00.927
> 
> 标签：asp.net, .net, asp-classic, vb6, oracle11g

我的项目包含 Classic ASP 和 Visual Basic COM+ 组件。我有一些页面是集成在 .NET 2.0 版本中的。我有 Oracle 数据库作为后端，一切都是 32 位的。它托管在 Windows server 2003 上

现在，我们计划在 Windows Server 2008 上移动它。现在，我的问题是在新服务器上，我们计划在 64 位中安装 Oracle 11g。

而且我确信我无法在 64 位中重新编译 VB COM+ 组件。

我的问题是：我的 32 位 COM+ 组件可以与 64 位 Oracle 客户端通信吗？我知道有可用的 Oracle 32 位客户端，但我不能使用它，因为在同一台服务器上我将拥有使用 Oracle 64 位客户端的 Congnos BI 工具。

任何人都可以给我任何建议吗？

谢谢，

# c# - 如何将 ListBox 中的多个值插入 SQL 数据库

> ID：12902143
> 
> 赞同：0
> 
> 时间：2012-10-15T18:54:10.760
> 
> 标签：c#, multi-select

我开发了一个由 asp.net 文本框和一个设置为“Multiple”的 ListBox 控件组成的表单，该控件有四个公司。单击提交按钮时，表单会将输入的数据插入数据库中的两个不同表中，并向各自的公司发送一封电子邮件——一切正常……除非我尝试选择多个公司——我的代码只会提交第一个选择的公司，但会根据 ListBox 中选择的公司数量插入第一个选择的公司数据。例如，如果我选择两个公司，则选择的第一个公司输入两次。4 次，如果我选择所有四家公司——这是我的代码/逻辑。任何人都可以就我做错了什么提供一些帮助吗？我在下面提供了我的代码：

/ ***** ** *** ** *** ** *** ** *** ** *** ****** * *aspx:* *

```
<p><b>Company Affected:</b><br />
<asp:ListBox 
   ID="lstcompanyAffected" 
   runat="server"
   SelectionMode="Multiple">
   <asp:ListItem Text="Select Company" Value="SelectCompany" />
   <asp:ListItem Text="CompanyI" Value="CompanyI" />
   <asp:ListItem Text="CompanyII" Value="CompanyII" />
   <asp:ListItem Text="CompanyIII" Value="CompanyIII" />
   <asp:ListItem Text="CompanyIV" Value="CompanyIV" />
   </asp:ListBox></p> 
```

/ ***** ** *** ** *** **** * *aspx.cs* *

```
lstcompanyAffected.SelectionMode = ListSelectionMode.Multiple;
        foreach (ListItem item in locationAffected.Items)
        {
            if (item.Selected) { 
                if ((lstcompanyAffected.SelectedValue.ToString() == "CompanyI"))
                {
                    outageId.Text = "1";
                    txtEmailAddresses.Text = "CompanyI@aol.com";
                }
                else if ((lstcompanyAffected.SelectedValue.ToString() == "CompanyII"))
                {
                    outageId.Text = "2";
                    txtEmailAddresses.Text = "CompanyII@aol.com";
                }
                else if ((lstcompanyAffected.SelectedValue.ToString() == "CompanyIII"))
                {
                    outageId.Text = "3";
                    txtEmailAddresses.Text = "CompanyIII@aol.com";
                }
                else if ((lstcompanyAffected.SelectedValue.ToString() == "CompanyIV"))
                {
                    outageId.Text = "4";
                    txtEmailAddresses.Text = "CompanyIV@aol.com";
                }
         //call insertOutage Function
                InsertOuage();
                //call InsertOutageDetail Function
                InsertOutageDetail();
                //call sendEmail Function
                sendEmail();
            }

        } // end foreach

       panelSendEmail.Visible = false;
       panelMailSent.Visible = true;
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T19:09:09.240

您的内部条件语句基于“lstcompanyAffected.SelectedValue”，每次 for 循环重复时，它总是相同的项目。更改 if 语句以查看您的“项目”循环变量。

# c++ - 指向可配置实现的 Pimpl 成语

> ID：12902158
> 
> 赞同：6
> 
> 时间：2012-10-15T18:54:54.703
> 
> 标签：c++, qt, interface, factory-pattern, pimpl-idiom

我读过 Pimpl 有利于二进制兼容性，接口有利于能够轻松切换实现。我需要结合这两种技术，以使我的应用程序能够通过配置文件切换底层实现。

**这是我目前的设计的布局方式：**

class Foo：提供面向客户端的 API，我关心的是 ABI 兼容性
class IFoo：接口类（所有纯虚拟方法，virtual dtor）
class Vendor1Foo：实现 IFoo，使用 Vendor1 的库
class Vendor2Foo：实现 IFoo，使用 Vendor2 的库

通过不使用 pimpl 并严格使用接口，客户端代码可能如下所示：

```
IFoo* foo = new Vendor1Foo(); 
```

问题是我的客户端代码根本不知道 Vendor1 或 Vendor2，而 Foo 只是我必须为此做的众多类之一。

我正在尝试做的总体概念如下：

```
class foo
{
  private:
  QScopedPointer<IFoo> pimpl;
  void initImpl();  // Reads from QSettings and initializes pimpl
} 
```

**有什么想法可以优雅地解决这个问题吗？**

**我希望提出一些宏或模板类/方法来帮助标准化我如何处理这个问题并尽量减少违反 DRY。**

模板类可以作为一个 pimpl 助手，就像 Herb Sutter 对 C++11 的通用 pimpl idiom 所做的那样：[herbsutter.com/gotw/_101](http://herbsutter.com/gotw/_101)，它还必须包含根据配置实例化正确实现的逻辑

这里有 pimpl 成语、桥接模式和工厂模式的元素。在我上面的例子中，initImpl() 可以被认为是一个工厂方法。我正在寻找一种可能会或可能不会使用所有这些模式的解决方案。

我已经查看了[c++ pimpl idiom : Implementation based on a template parameter](https://stackoverflow.com/questions/5425065/c-pimpl-idiom-implementation-depending-on-a-template-parameter)以及关于 SO 的大多数 pimpl idiom questions。标题看起来很有希望，但它对我的特定用例没有帮助。

我不能使用 C++11 并且正在使用 Qt。 [D-Pointers](http://qt-project.org/wiki/Dpointer)不能解决我的问题，因为它们绑定到单个实现。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T19:07:09.380

您正在寻找的是桥梁设计模式

[http://en.wikipedia.org/wiki/Bridge_pattern](http://en.wikipedia.org/wiki/Bridge_pattern)

它可以使用 pimpl idiom 来实现。

头文件：

```
class IFoo {
public:
  virtual void doA() = 0;
  virtual void dob() = 0;
};

class Foo {
public:
  Foo();
  ~Foo();
  void doA() { impl->doA(); }
  void doB() { impl->doB(); }
private:
  IFoo* impl;
  // if needed - add clone to IFoo...
  Foo(const Foo&);
  Foo& operator = (const Foo&);
}; 
```

别的地方：

```
 class Vendor1Foo : public IFoo { ... }; 
   class Vendor2Foo : public IFoo { ... }; 
```

在 .cpp 文件中：

```
Foo::Foo() : impl(createFooImpl()) {} 
```

* * *

使其模板为 40 个类做好准备：

```
template <class Interface>
Interface* createInterfaceFromConfig();

template <class Interface>
class ConcreteObject {
public:
   ConcreteObject() : impl(createInterfaceFromConfig<Interface>())
   Interface& interface() { return *impl; }
   const Interface& interface() const { return *impl; }
private:
   Interface* impl;
   // if needed - add clone to IFoo...
   ConcreteObject(const ConcreteObject&);
   ConcreteObject& operator = (const ConcreteObject&);
};

// example
class IFoo { ... };
typedef ConcreteObject<IFoo> Foo;

// somewhere else do specialization (.cpp file)

template <>
IFoo* createInterfaceFromConfig<IFoo>() { ... } 
```

以及其他 39 个接口的专业化......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T19:13:32.530

我认为，你把这一切都复杂化了。只需使用*Foos*的*工厂*。

 *```
//accessible from client code:
struct IFoo
{
    virtual ~IFoo(){}
}

struct FooFactory
{
    IFoo* createFoo() const;

// you may only need pimpl here to fix _factory_ _interface_. 
// And you always have 1 factory
private:
    FooFactroyPrivate* d;
}

//implementation:
IFoo* FooFactory::createFoo() const
{
    //checking settings, creating implementation
} 
```

现在，只要您修复了接口，您就可以自由地添加新的实现，因为您的客户只能通过接口访问，您可以自由地更改您的实现细节。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T16:36:36.147

在我看来，您的要求与**Dependency Injection**非常相似。前段时间我在寻找 C++ 的 DI 框架，发现[pococapsule](http://code.google.com/p/pococapsule/)。我最后没有使用它，所以我无法评论它，但看看。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-20T14:19:23.887

**这个解决方案实际上对我有用，所以我把它放在这里作为答案：**

**PimpleHelper.h**是一个 Pimpl 帮助器类，用于减少样板代码。使用 VendorFactory 实例化正确的供应商实现。多个供应商将注册他们实现给定接口的事实；对于给定的接口，只有一个供应商的实现被实例化。

```
 #include <QSettings>
    #include "VendorFactory.h"
    #include <cxxabi.h>

    // Pimpl Helper
    template<typename T>
    class PimplHelper
    {
        public:
        PimplHelper()
        {
            m_interfaceNameImplemented = demangle(typeid(T).name());
            initializeImpl();
        }

        T* getImpl()
        {
            return theImpl.data();
        }

        private:
        QScopedPointer< T > theImpl;
        QString m_interfaceNameImplemented;

        void initializeImpl()
        {

            // Read in configuration
            QSettings settings("AppSettings.ini", QSettings::IniFormat);
            QString vendorToUse = settings.value("VENDOR_IMPLEMENTATION_KEY", "Vendor1").toString();

            qDebug() << "Vendor to use is: " << vendorToUse << " Interface Implemented: " << m_interfaceNameImplemented;

            // Obtain an instance of the vendor's class that implements the T interface
            theImpl.reset(
                            VendorFactory<T>::create(vendorToUse, m_interfaceNameImplemented)
                         );

            if(!theImpl)
                qDebug() << "PimplHelper::initializeImpl, error resolving implementation for: "
                         << vendorToUse << " Interface Implemented: " << m_interfaceNameImplemented;
        }

        const QString demangle(const char* name)
        {
            int status = -4;
            char* res = abi::__cxa_demangle(name, NULL, NULL, &status);
            const char* const demangled_name = (status==0)?res:name;
            QString ret_val(demangled_name);
            free(res);
            return ret_val;
        }
    }; 
```

**VendorFactory.h**创建由不同供应商实现的类的实例。供应商通过宏向工厂注册他们的实现。

```
 #include <QtCore>

    template< class T>
    class VendorFactory
    {
        private:
        typedef T* (*CreateFunc)();
        typedef QMap<QString, CreateFunc> FunctionMap;

        public:
        static T * create(const QString& vendorName, const QString& interfaceName)
        {
            typename FunctionMap::iterator it = creators()->find(vendorName + interfaceName);
            if (it == creators()->end())
                return NULL;
            return (it.value())();
        }

        static bool reg(const QString& vendorName, const QString& interfaceName, CreateFunc fun)
        {
            qDebug() << "Registering: " << vendorName + interfaceName << endl;
            creators()->insert(vendorName + interfaceName, fun);
            return true;
        }

        static FunctionMap * creators()
        {
            static FunctionMap* creators = new FunctionMap;
            return creators;
        }

        virtual ~VendorFactory() {}

    };

    /// @brief This registers a Vendor's class in the factory and adds a factory function named create_vendorImplClass()
    /// and calls VendorFactory::reg() by the help of a dummy static variable to register the function.
    /// @param vendorName A string representing the vendor's name
    /// @param vendorImplClass The class implementing the interface given by the last parameter
    /// @param interface The  interface implemented by the vendorImplClass
    #define REGISTER_IN_FACTORY( vendorName, vendorImplClass, interface ) \
        namespace { \
        interface* create_ ## vendorImplClass() {  return new vendorImplClass; } \
        static bool vendorImplClass ## _creator_registered = VendorFactory< interface >::reg( vendorName, # interface, create_ ## vendorImplClass); } 
```

以下是它们的使用方式：

**Person.h** （面向公众的 API）

```
#include "IPerson.h"
#include "PimplHelper.h"

// Public facing API
class Person: public IPerson
{
    public:

    Person()
    {
        impl.reset( new PimplHelper<IPerson>());
    }

    QString GetFirstName();   
    QString GetLastName();

    private:
    QScopedPointer< PimplHelper<IPerson> > impl;
}; 
```

**Person.cpp** （面向公众的 API）

```
#include "Person.h"

QString Person::GetFirstName()
{   // I'd like to remove the call to getImpl() here
    // and just use the overloaded -> operator, but it
    // gives me a "has no member named GetFirstName()" error
    return impl->getImpl()->GetFirstName();
}

QString Person::GetLastName()
{
    return impl->getImpl()->GetLastName();
} 
```

**PersonImpl1.h**包含 Vendor1 的实现

```
#include "IPerson.h"
#include "VendorFactory.h"

// Private Implementation
class PersonImpl1: public IPerson
{

    public:

    PersonImpl1():
        FirstName("Jon"), LastName("Skeet")
    {}

    QString GetFirstName()
    {
        return FirstName;
    }

    QString GetLastName()
    {
        return LastName;
    }

    private:
    QString FirstName;
    QString LastName;

};

REGISTER_IN_FACTORY("Vendor1", PersonImpl1, IPerson) 
```

**PersonImpl2.h**包含 Vendor2 的实现

```
#include "IPerson.h"
#include "VendorFactory.h"

// Private Implementation
class PersonImpl2: public IPerson
{

    public:

    PersonImpl2(): FirstName("Chuck"), LastName("Norris")
    {}

    QString GetFirstName()
    {
        return FirstName;
    }

    QString GetLastName()
    {
        return LastName;
    }

    private:
    QString FirstName;
    QString LastName;
};

REGISTER_IN_FACTORY("Vendor2", PersonImpl2, IPerson) 
```

最后，**main.cpp**文件：

```
#include <QCoreApplication>
#include <QDebug>

#include "Person.h"

// The following needs to be included for the static/auto registration
// with the VendorFactory to occur. I'm not exactly sure why.
#include "PersonImpl1.h"
#include "PersonImpl2.h"

int main(int argc, char *argv[])
{
    Q_UNUSED(argc)
    Q_UNUSED(argv)

    Person* p = new Person();

    qDebug() << "The person implemented is: "
             << p->GetFirstName() << " " << p->GetLastName();

    qDebug() << "exiting";
} 
```

这是迄今为止对我有帮助的其他 SO 问题的列表：

[从名称实例化类？](https://stackoverflow.com/a/1096743)
[在编译时使用 C++ 模板在 AbstractFactory 中动态注册构造函数方法 在 C++](https://stackoverflow.com/q/2850213/25882)
[中的对象工厂实体/组件系统中注册对象创建者](https://stackoverflow.com/q/1310214/25882)
[，如何发现类型和构造组件？](https://gamedev.stackexchange.com/a/17759)
[有没有办法从保存类名的字符串中实例化对象？](https://stackoverflow.com/a/582456/25882)
[静态变量未初始化](https://stackoverflow.com/a/2720991/25882)
[取消 std::type_info::name 的结果](https://stackoverflow.com/q/281818/25882)*

# asp.net-mvc - 有什么方法可以阻止 Url.RouteUrl 对路由值进行urlencoding？

> ID：12902164
> 
> 赞同：1
> 
> 时间：2012-10-15T18:54:58.417
> 
> 标签：asp.net-mvc, asp.net-mvc-routing

我想在客户端模板的 url 中输出一个占位符 - {{>username}} 但占位符会自动编码 url 并且客户端模板会中断。

我可以通过传入say 'username' 然后用字符串替换它'{{>username}}' 并返回 IHtmlString 来解决它，但这远非优雅。

希望有更好的解决方案。

达林（或其他任何人）有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T20:15:51.140

```
@ViewContext.HttpContext.Server.UrlDecode(
    Url.RouteUrl(Model)
) 
```

对我有用，也许比你的其他解决方案更干净。

*测试：*

普通的：`/Value=%3C%40%24(%5E%25%24`

解码：`/Value=<@$(^%$`

# android - 特殊的编辑文本。必须显示以用户输入的字符开头的单词出现列表

> ID：12902167
> 
> 赞同：2
> 
> 时间：2012-10-15T18:55:18.000
> 
> 标签：android, android-edittext

我正在尝试找到智能 EditText 的实现。此 EditText 必须与一个 hastable 字符串连接。

当用户输入一个新字符时，edittext 必须在 hastable 上搜索并显示以用户输入的相同字符开头的单词出现的列表。

这种编辑文本有名字吗？我找不到这个的实现，因为我不知道这种编辑文本的名称。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T19:00:48.270

您正在寻找[AutoCompleteTextView](http://developer.android.com/reference/android/widget/AutoCompleteTextView.html)。

# python - Python - 如何检查文件的每一行以查看它是否包含列表中的项目以及是否确实从文件中删除该行

> ID：12902178
> 
> 赞同：0
> 
> 时间：2012-10-15T18:55:45.720
> 
> 标签：python, file

> **可能重复：**
> [逐行比较两个不同的文件并将差异写入第三个文件 - Python](https://stackoverflow.com/questions/7757626/compare-two-different-files-line-by-line-and-write-the-difference-in-third-file)

我脑海中的逻辑是这样的......对于import_file中的行检查它是否包含Existing-user-string-list中的任何项目如果它包含该列表中的任何项目然后删除该行文件。

```
filenew = open('new-user', 'r')
filexist = open('existing-user', 'r')
fileresult = open('result-file', 'r+')
xlines = filexist.readlines()
newlines = filenew.readlines()
for item in newlines:
    if item contains an item from xlines
        break
    else fileresult.write(item)
filenew.close()
filexist.close()
fileresult.close() 
```

我知道这段代码都被抬高了，但也许你可以指出我正确的方向。

谢谢！

编辑 - -

**这是我现有用户文件中的内容的示例....**

```
allyson.knanishu
amy.curtiss
amy.hunter
amy.schelker
andrea.vallejo
angel.bender
angie.loebach 
```

**这是我的新用户文件中的示例....**

```
aimee.neece,aimee,neece,aimee.neece@faculty.asdf.org,aimee neece,aimee neece,"CN=aimee neece,OU=Imported,dc=Faculty,dc=asdf,dc=org"
alexis.andrews,alexis,andrews,alexis.andrews@faculty.asdf.org,alexis andrews,alexis andrews,"CN=alexis andrews,OU=Imported,dc=Faculty,dc=asdf,dc=org"
alice.lee,alice,lee,alice.lee@faculty.asdf.org,alice lee,alice lee,"CN=alice lee,OU=Imported,dc=Faculty,dc=asdf,dc=org"
allyson.knanishu,allyson,knanishu,allyson.knanishu@faculty.asdf.org,allyson knanishu,allyson knanishu,"CN=allyson knanishu,OU=Imported,dc=Faculty,dc=asdf,dc=org" 
```

来自@mikebabcock 的新代码......谢谢。

```
outfile = file("result-file.txt", "w")
lines_to_check_for = [ parser(line) for line in file("existing-user.txt", "r") ]
for line in file("new-user.txt", "r"):
    if not parser(line) in lines_to_check_for:
        outfile.write(line) 
```

为解析器添加了导入语句...我收到以下错误...

```
C:\temp\ad-import\test-files>python new-script.py
Traceback (most recent call last):
  File "new-script.py", line 7, in <module>
    lines_to_check_for = [ parser(line) for line in file("existing-user.txt", "r
     ") ]
  TypeError: 'module' object is not callable 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T19:02:17.963

假设我明白你想做什么....使用设置交集:)

```
for line in newlines:
    if set(line.split()) & set(xlines): #set intersection
        print "overlap between xlines and current line"
        break
    else:
        fileresult.write(item) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T19:10:27.243

如果输入文件格式是每行有一个项目（以便检查 readlines 列表中的现有元素是可以的），那么您正在寻找列表成员资格测试：

```
if item in xlines:
    break 
```

再指出一些 python 的东西：从您测试成员资格的列表中创建一个集合（因为测试将是对数时间，而不是列表中的线性时间）：

```
xlines = set(filexists.readlines()) 
```

此外，您可以使用 with 语句来避免关闭文件并提供更清晰的代码（如[这里](http://preshing.com/20110920/the-python-with-statement-by-example)的第一个示例）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T19:02:20.067

我想这是你想要做的：

```
outfile = file("outfile.txt", "w")
lines_to_check_for = [ line for line in file("list.txt", "r") ]
for line in file("testing.txt", "r"):
    if not line in lines_to_check_for:
        outfile.write(line) 
```

这会将所有行读`list.txt`入一个数组，然后`testing.txt`对照该数组检查每一行。所有不在该数组中的行都将被写入`outfile.txt`.

这是基于您的新问题的更新示例：

```
newusers = file("newusers.txt", "w")
existing_users = [ line for line in file("users.txt", "r") ]
for line in file("testing.txt", "r"):
    # grab each comma-separated user, take the portion left of the @, if any
    new_users = [ entry.split["@"](0) for entry in line.split(",") ]
    for user in new_users:
        if not user in existing_users:
            newusers.write(user) 
```

# c# - 如何从 ResourceSet 获取资源文件注释？

> ID：12902179
> 
> 赞同：4
> 
> 时间：2012-10-15T18:55:52.707
> 
> 标签：c#, resource-files

> **可能重复：**
> [如何从 .resx 文件条目中获取评论](https://stackoverflow.com/questions/8854404/how-to-get-the-comment-from-a-resx-file-entry)

我使用以下方法遍历资源文件：

```
_cityResources = Cities.ResourceManager.GetResourceSet(
                        CultureInfo.CurrentUICulture, 
                        true, 
                        true);

foreach (DictionaryEntry entry in CityResources)
{
    result.Add(new CityBounds()
    {
         Name = entry.Key as string,
         BoundingBox = (entry.Value as string).ToBoundingBox()
    });
} 
```

并为我的东西使用键值对。现在我有一个问题：

如何从资源文件中获取内容，此循环中的评论列？

# php - PHP 和 jQuery Mobile 的奇怪异常？

> ID：12902184
> 
> 赞同：0
> 
> 时间：2012-10-15T18:56:22.533
> 
> 标签：php, jquery-mobile

我在使用 jQuery 和 PHP 时遇到了我无法弄清楚的问题。为了理解，让我解释一下我在做什么。

我正在使用 jQuery Mobile 为 UI 和 PHP 为服务器端制作一个小型移动网络应用程序。我已经准备好 95% 的应用程序，但在最后一页我遇到了问题。

第一页有三个下拉菜单和一个提交按钮。按下按钮时，下拉菜单中的信息通过 $_POST 传输到第二个屏幕。在这里，我验证我有数据并进行一些操作。如果没有发送数据，我会显示错误。到目前为止，我希望一切都有意义。

这是两个页面的代码： 第 1 页：http: [//pastebin.com/N0bWdbv0](http://pastebin.com/N0bWdbv0) 第 2 页：http: [//pastebin.com/TpbHqGai](http://pastebin.com/TpbHqGai)

在第二页，在浏览器中我看到： 选择成员：（第 75 行）但是！如果我查看页面的源代码，我在任何地方都看不到它，而是出现“错误！日期”（第 65 行）。

老实说，我不知道为什么我会在显示的内容和“查看页面源”显示的内容之间出现这种不一致。

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T20:05:17.907

jQuery Mobile 默认使用 AJAX 在站点中的页面之间导航。因此，当您单击指向另一个页面的链接时，您仍然使用相同的 DOM 并将另一个伪页面带入 DOM。这意味着在浏览 jQuery Mobile 网站时（默认情况下）不会发生实际的页面加载，这反过来意味着除非您刷新页面，否则网页的来源不会改变。

但是，您可以使用一些可用的开发人员工具查看“实时 DOM”（Chrome 有一组很棒的 DOM 检查工具）。

# c# - XML 属性中的 JSON

> ID：12902188
> 
> 赞同：2
> 
> 时间：2012-10-15T18:56:36.090
> 
> 标签：c#, javascript, xml, json

我必须将一些数据从 C# 模块传递到 Java 脚本模块。

现在，有一个我无法控制的中间人模块，最终会调用 external(c#) 模块，并返回一个 xml 结构，其中来自 c# 模块的数据位于 XML 属性中。

我试着放一个 JSON 字符串，`"\/Date(1350323947917)\/"`

来自

```
 DateTime dt = DateTime.Now;

    JavaScriptSerializer serailzer = new JavaScriptSerializer();
    string dateTimeString = serailzer.Serialize(dt); 
```

而且它不适合作为有效 XML 的属性。

我可以尝试做的是修剪字符串末尾的引号，但我不确定这是否会使 JSON 无效

我的问题是，我应该尝试继续使用这个 JSON 路由，还是有其他我遗漏的陷阱？

**编辑：** 我想重申，生成 XML 的不是我的程序。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-15T21:02:59.723

JSON 必须是 UTF-8，所以只要你使用 UTF-8 编码的 XML，就可以了。只需确保正确转义 json 以在属性中使用即可。您需要转义的唯一四个字符是`<`, `>`, `&`, ，`"`它们被转义为`&lt;`,`&gt;`和.`&amp;``&quot;`

CDATA 有问题。您仍然必须转义某些序列，并且由于 json 和 xml 都应该是有效的 UTF-8，因此不使用 CDATA 时的风险较小。您想要的是 SGML 所称的 PCDATA，这正是标准文本属性或 xml nodeValue 的内容。

因此，您的问题的答案只是为容器转义您的数据（无论它可能是什么）。在这种情况下，它是 xml。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-08-31T18:10:27.660

您可以使用 System.Security.SecurityElement 类来转义字符。

```
 /// <summary>
    /// Escapes Json string to be included in an XML attribute
    /// </summary>
    /// <param name="jsonString">json string</param>
    /// <returns></returns>
    public static string EscapeJson(string jsonString)
    {
        return SecurityElement.Escape(jsonString);
    }

    /// <summary>
    /// Unescapes Json string from XML attribute value
    /// </summary>
    /// <param name="xmlString">xml string</param>
    /// <returns></returns>
    public static string UnescapeJson(string xmlString)
    {
        return new SecurityElement("", xmlString).Text;
    } 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-15T19:00:09.007

1）您需要正确拼写“serializer”，否则它将不起作用:)

2) 您需要将您的 JSON 数据包含在“CDATA”部分中，以便您的 XML 文件正确保存它。

3) 以下是一些从 C# 编写 CDATA 的链接：

*   [如何在 xml 中编写 CData](https://stackoverflow.com/questions/4679543/how-to-write-cdata-in-xml)

*   [http://msdn.microsoft.com/en-us/library/system.xml.xmlwriter.writecdata.aspx](http://msdn.microsoft.com/en-us/library/system.xml.xmlwriter.writecdata.aspx)

# c - 过滤后的scanf导致无限循环

> ID：12902189
> 
> 赞同：1
> 
> 时间：2012-10-15T18:56:47.090
> 
> 标签：c, scanf

我在一个程序中通过 scanf 过滤了输入。我想要只读数字和大字母+空格。

最近我试图做类似的事情，它陷入了一个无限循环，仍然只打印第一个输入。我知道`fgets()`，但我知道这行得通。我找不到问题出在哪里。这是简化的情况；我是怎么了？

```
#include <stdio.h>
#include <string.h>

int main()
{
  char str[21];

  do
  {
    scanf("%20[0-9A-Z ]", str);
    printf("%s\n", str);
  } while(strcmp("END", str) != 0);

  return 0;
} 
```

编辑：我忘了提，输入是有效的，对于输入：“HELLO”程序卡住了......并且`scanf`仅在第一次输入时返回 1，对于其他人返回 0。我也尝试过`fflush(stdin)`，阅读后......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T19:02:24.543

您`scanf`只接受数字、大写字母（拉丁字母）和空格，

```
scanf("%20[0-9A-Z ]", str); 
```

因此，当您输入其他任何内容时，`scanf`无法将输入分配给`str`，并且有问题的输入仍保留在输入缓冲区中。您需要检查扫描是否成功并在失败时清除输入缓冲区。

并且由于特别是换行符不在有效的输入标记中，如果输入来自例如键盘而不是无换行符的输入流，则无论如何都需要清除输入缓冲区直到下一个换行符。

```
int c;
do
{
  scanf("%20[0-9A-Z ]", str);
  printf("%s\n", str);
  while((c = getchar()) != '\n' && c != EOF); // clear input buffer
} while(c != EOF && strcmp("END", str) != 0); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T19:01:01.940

取决于输入 - 但您可以检查 scanf 是否有效 - 它会返回匹配表达式的数量 - 因此在这种情况下应该是 1。如果它的 0 - 它与输入不匹配，那么它可能会粘在原来的位置。

# html - 如何通过另存为链接来保存和共享画布 html5 图像？

> ID：12902190
> 
> 赞同：0
> 
> 时间：2012-10-15T18:56:46.077
> 
> 标签：html, canvas, save, html5-canvas, share

> **可能重复：动态**
> [下载画布图像](https://stackoverflow.com/questions/12795595/download-canvas-image-on-the-fly)

我有一个可以正常工作`canvas`的**HTML5 。**现在，我想创建一个排序游戏，人们可以在其中保存他们的图像并与他人分享。这可以通过将图像保存为与画布所在位置不同的 url 来完成（我猜）。现在，如果我“保存”我的 HTML5 画布，我会在浏览器中得到这个 URL：

`data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAiYAAAHCCAYAAADb8wJPAAAeKklEQVR4nO3d36tv6V0f8M+fkItceFGKIAiC4EVpwateFQSvAm0g1Is2`

所以现在，我想把它真正保存在服务器上，并获得一个可以与朋友分享的链接，以便他们可以在互联网上看到这张图片。我怎样才能使这成为可能的家伙？

PS：我用这个片段“保存”它：

```
 <input type="button" id="save" value="Save to PNG">

<script>
  document.getElementById('save').onclick = function () {
    window.location = document.getElementById("RoCanvas").toDataURL('image/png');
  };
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T20:53:48.793

是的。基本上，您生成的图像在客户端上。您需要获取 Base64 编码的字符串并将其发送到您的服务器。然后在服务器上，您可以将其转换为图像。

为此，请参阅：[如何从 base64 数据字符串保存 PNG 图像服务器端](https://stackoverflow.com/questions/11511511/how-to-save-a-png-image-server-side-from-a-base64-data-string)

# c# - OpenFileDialog：使用复选框选择多个文件

> ID：12902193
> 
> 赞同：0
> 
> 时间：2012-10-15T18:56:56.980
> 
> 标签：c#, winforms, openfiledialog

使用 openfiledialog 多选文件时，是否可以选择在文件旁边显示复选框？

我知道有一个 Windows 选项可以更改它，但是有没有办法为我的特定 openfiledialog 临时更改它？

或者有没有办法改变 Windows 设置？我在想我可以检查它是否已经设置为显示复选框，如果是我什么都不做，否则我改变它，当对话框关闭时我把它改回来。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-15T19:46:53.013

你需要建立自己的`OpenFileDialog`来实现这一点。创建一个 Class 并继承自`FileDialog`，因为`OpenFileDialog`是一个`sealed`Class 并且不能被继承或扩展。

该[`OpenFileDialogEx`](http://www.codeproject.com/Articles/16276/Customizing-OpenFileDialog-in-NET)项目可以为您提供信息以实施一个不错的解决方案。看一看。

# asp.net - ASP.NET 表单身份验证超时

> ID：12902194
> 
> 赞同：15
> 
> 时间：2012-10-15T18:56:57.727
> 
> 标签：asp.net, timeout, forms-authentication

这可能是一个非常简单的问题，但经过几个小时试图了解它在 ASP.NET 4.0 上的工作原理后，我仍然不知道。

我正在使用表单身份验证。我有一个登录页面，上面有登录控件。

这是用户登录时我需要的：

A- 用户应该保持登录状态，直到超时设置不做任何事情。如果他们重新加载页面，则超时必须重新开始倒计时。

B-如果他们单击“记住我”，则无论他们关闭浏览器还是重新启动计算机，他们都应该保持连接直到他们注销。

我遇到的问题是，当他们登录时，我的计算机上没有看到任何 cookie：

1.  饼干在哪里？是记忆饼干吗？
2.  如果会话过期会发生什么？我想让他们记录下来，除非超时完成。
3.  如果应用程序池被回收会怎样？

我还有另一个问题：当他们点击“记住我”检查（案例 B）时，我希望他们登录，直到他们点击注销按钮。这次我确实看到了一个 cookie，但看起来他们只是在超时期间保持连接......所以记住我与不记住我有什么区别......

我想完全分离身份验证和会话。如果不是很糟糕，我希望由 cookie 控制的身份验证。

感谢您的帮助-。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-10-15T21:34:55.740

**处理非永久的、可滑动的过期票据**

Forms Authentication 为票证使用内存中的 cookie，除非您使其持久化（例如，`FormsAuthentication.SetAuthCookie(username, true)`将使其持久化）。默认情况下，票证使用滑动到期。每次处理请求时，都会发送带有新到期日期的票证。一旦该日期到期，cookie 和票证都无效，用户将被重定向到登录页面。

表单身份验证没有内置处理重定向已经呈现的页面，这些页面的停留时间超过了超时时间。您需要自己添加。在最简单的级别上，您需要使用 JavaScript 启动一个带有文档加载的计时器。

```
<script type="text/javascript">
  var redirectTimeout = <%FormsAuthentication.Timeout.TotalMilliseconds%>
  var redirectTimeoutHandle = setTimeout(function() { window.location.href = '<%FormsAuthentication.LoginUrl%>'; }, redirectTimeout);
</script> 
```

使用上述方法，如果您的页面没有刷新或更改，或者`redirectTimeoutHandle`没有以其他方式取消（使用`clearTimeout(redirectTimeoutHandle);`），它将被重定向到登录页面。FormsAuth 票证应该已经过期，因此您不必对此做任何事情。

这里的诀窍是您的网站是否使用 AJAX，或者您是否将其他客户端事件视为活跃的用户活动（移动或单击鼠标等）。您必须手动跟踪这些事件，并在它们发生时重置`redirectTimeoutHandle`. 例如，我有一个大量使用 AJAX 的网站，因此页面不会经常刷新。由于我使用 jQuery，我可以让它在每次发出 AJAX 请求时重置超时，如果它们位于单个页面上并且不进行任何更新，这实际上应该导致页面被重定向。

这是一个完整的初始化脚本。

```
$(function() {
   var _redirectTimeout = 30*1000; // thirty minute timeout
   var _redirectUrl = '/Accounts/Login'; // login URL

   var _redirectHandle = null;

   function resetRedirect() {
       if (_redirectHandle) clearTimeout(_redirectHandle);
       _redirectHandle = setTimeout(function() { window.location.href = _redirectUrl; }, _redirectTimeout);
   }

   $.ajaxSetup({complete: function() { resetRedirect(); } }); // reset idle redirect when an AJAX request completes

   resetRedirect(); // start idle redirect timer initially.
}); 
```

通过简单地发送 AJAX 请求，客户端超时和票证（以 cookie 的形式）都将被更新，您的用户应该没问题。

但是，如果用户活动不会导致 FormsAuth 票证被更新，则用户在下一次请求新页面时（通过导航或通过 AJAX）将显示为已注销。在这种情况下，当用户通过 AJAX 调用（例如，自定义处理程序、MVC 操作等）发生用户活动时，您需要“ping”您的 Web 应用程序，以使您的 FormsAuth 票证保持最新。请注意，在 ping 服务器以保持最新状态时需要小心，因为您不想让服务器充斥着请求，例如移动光标或单击内容。除了初始页面加载和 AJAX 请求之外，这是对上面的 init 脚本的补充，它添加了`resetRedirect`对文档的鼠标点击。

```
$(function() {
   $(document).on('click', function() {
      $.ajax({url: '/ping.ashx', cache: false, type: 'GET' }); // because of the $.ajaxSetup above, this call should result in the FormsAuth ticket being updated, as well as the client redirect handle.
   });
}); 
```

**处理“永久”工单**

您需要将票据作为持久 cookie 发送到客户端，并具有任意长的超时时间。您应该能够保留客户端代码和 web.config 原样，但在您的登录逻辑中单独处理用户对永久票证的偏好。在这里，您需要修改票证。以下是登录页面中执行此类操作的逻辑：

```
// assumes we have already successfully authenticated

if (rememberMe)
{
    var ticket = new FormsAuthenticationTicket(2, userName, DateTime.Now, DateTime.Now.AddYears(50), true,
                                               string.Empty, FormsAuthentication.FormsCookiePath);
    var cookie = new HttpCookie(FormsAuthentication.FormsCookieName, FormsAuthentication.Encrypt(ticket))
                     {
                         Domain = FormsAuthentication.CookieDomain,
                         Expires = DateTime.Now.AddYears(50),
                         HttpOnly = true,
                         Secure = FormsAuthentication.RequireSSL,
                         Path = FormsAuthentication.FormsCookiePath
                     };
    Response.Cookies.Add(cookie);
    Response.Redirect(FormsAuthentication.GetRedirectUrl(userName, true));
}
else
{
    FormsAuthentication.RedirectFromLoginPage(userName, false);
} 
```

**奖励：在票证中存储角色**

您询问是否可以将角色存储在票证/cookie 中，这样您就不必再次查找它们。是的，这是可能的，但有一些注意事项。

1.  您应该限制放入票证的数据量，因为 cookie 只能这么大
2.  您应该考虑是否应在客户端缓存角色。

详细说明#2：

您不应该隐含地相信您从用户那里收到的声明。例如，如果用户登录并且是管理员，并选中“记住我”从而收到持久的长期票证，他们将永远是管理员（或直到该 cookie 过期或被删除）。如果有人将他们从数据库中的该角色中删除，如果他们有旧票证，应用程序仍会认为他们是管理员。因此，您最好每次都获取用户的角色，但将角色缓存在应用程序实例中一段时间​​以最小化数据库工作。

从技术上讲，这也是票本身的问题。同样，您不应该仅仅因为他们拥有有效的票证而相信该帐户仍然有效。您可以使用与角色类似的逻辑：通过查询您的实际数据库来检查票证引用的用户是否仍然存在并且有效（它没有被锁定、禁用或删除），并且只是将 db 结果缓存一段时间是时候提高性能了。这就是我在我的应用程序中所做的，其中票证被视为身份声明（类似地，用户名/密码是另一种类型的声明）。这是 global.asax.cs（或 HTTP 模块）中的简化逻辑：

```
protected void Application_AuthenticateRequest(Object sender, EventArgs e)
{
  var application = (HttpApplication)sender;
  var context = application.Context;  

  EnsureContextUser(context);
}

private void EnsureContextUser(HttpContext context)
{
   var unauthorizedUser = new GenericPrincipal(new GenericIdentity(string.Empty, string.Empty), new string[0]);

   var user = context.User;

   if (user != null && user.Identity.IsAuthenticated && user.Identity is FormsIdentity)
   {
      var ticket = ((FormsIdentity)user.Identity).Ticket;

      context.User = IsUserStillActive(context, ticket.Name) ? new GenericPrincipal(user.Identity, GetRolesForUser(context, ticket.Name)) : unauthorizedUser;

      return; 
   }

   context.User = unauthorizedUser;
}

private bool IsUserStillActive(HttpContext context, string username)
{
   var cacheKey = "IsActiveFor" + username;
   var isActive = context.Cache[cacheKey] as bool?

   if (!isActive.HasValue)
   {
      // TODO: look up account status from database
      // isActive = ???
      context.Cache[cacheKey] = isActive;
   }

   return isActive.GetValueOrDefault();
}

private string[] GetRolesForUser(HttpContext context, string username)
{
   var cacheKey = "RolesFor" + username;
   var roles = context.Cache[cacheKey] as string[];

   if (roles == null)
   {
      // TODO: lookup roles from database
      // roles = ???
      context.Cache[cacheKey] = roles;
   }

   return roles;
} 
```

当然，您可能决定不关心这些，只想信任票证，并将角色也存储在票证中。首先，我们从上面更新您的登录逻辑：

```
// assumes we have already successfully authenticated

if (rememberMe)
{
    var ticket = new FormsAuthenticationTicket(2, userName, DateTime.Now, DateTime.Now.AddYears(50), true, GetUserRolesString(), FormsAuthentication.FormsCookiePath);
    var cookie = new HttpCookie(FormsAuthentication.FormsCookieName, FormsAuthentication.Encrypt(ticket))
                     {
                         Domain = FormsAuthentication.CookieDomain,
                         Expires = DateTime.Now.AddYears(50),
                         HttpOnly = true,
                         Secure = FormsAuthentication.RequireSSL,
                         Path = FormsAuthentication.FormsCookiePath
                     };
    Response.Cookies.Add(cookie);
    Response.Redirect(FormsAuthentication.GetRedirectUrl(userName, true));
}
else
{
    var ticket = new FormsAuthenticationTicket(2, userName, DateTime.Now, DateTime.Now.AddMinutes(FormsAuthentication.Timeout), false, GetUserRolesString(), FormsAuthentication.FormsCookieName);
    var cookie = new HttpCookie(FormsAuthentication.FormsCookieName, FormsAuthentication.Encrypt(ticket))
       {
          Domain = FormsAuthentication.CookieDomain,
          HttpOnly = true,
          Secure = FormsAuthentication.RequireSSL,
          Path = FormsAuthentication.FormsCookiePath
       };
    Response.Cookies.Add(cookie);
    Response.Redirect(FormsAuthentication.GetRedirectUrl(userName, false));
} 
```

添加方法：

```
 private string GetUserRolesString(string userName)
   {
        // TODO: get roles from db and concatenate into string
   } 
```

更新您的 global.asax.cs 以从票证中获取角色并更新 HttpContext.User：

```
protected void Application_AuthenticateRequest(Object sender, EventArgs e)
{
  var application = (HttpApplication)sender;
  var context = application.Context;  

  if (context.User != null && context.User.Identity.IsAuthenticated && context.User.Identity is FormsIdentity)
  {
      var roles = ((FormsIdentity)context.User.Identity).Ticket.Data.Split(",");

      context.User = new GenericPrincipal(context.User.Identity, roles);
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T19:58:37.850

对于**A**，您需要将会话超时变量设置为您希望用户保持登录状态[的时间。 Timeout 属性指定分配给应用程序的 Session 对象的超时期限，以分钟为单位。如果用户在超时期限内没有刷新或请求页面，则会话结束。](http://msdn.microsoft.com/en-us/library/ms525473%28v=vs.90%29.aspx)

对于**B**部分，我建议将该值存储在会话变量（或 cookie，但不驻留在服务器上）中，并在 global.asax 文件的 Session_End 事件中检查该值。如果已设置，则更新会话。

Session_End 事件在浏览器关闭时不会触发，它会在服务器在特定时间段（默认为 20 分钟）内没有收到用户请求时触发。

# tomcat - 在 Ubuntu 中设置环境变量

> ID：12902198
> 
> 赞同：1
> 
> 时间：2012-10-15T18:57:23.233
> 
> 标签：tomcat, ubuntu, global-variables, ubuntu-12.04

我正在尝试在我的 Ubuntu 机器中设置我的环境变量。现在我做了一些研究并尝试了关于这个问题的方法[Make $JAVA_HOME easy changable in Ubuntu](https://stackoverflow.com/questions/2655641/set-environment-variable-in-ubuntu)

类似的问题，但问题是我已经编写了“etc/enviroment”、“etc/profile”和“etc/bash.bashrc”文件以包含我的变量：

```
JAVA_HOME=/home/glv/information/jdk1.6.0_25/
BASEDIR=/home/glv/apache-tomcat-6.0.29/ 
```

但是问题是当我在 apache 上运行 startup.sh 时，它仍然说 BASEDIR 环境变量设置不正确。我正在使用最新的 Ubuntu，不确定这是否有问题，或者我是否必须采取另一种方式。

# xslt - 如何使用 XSLT 组合具有相同 id 的 XML 元素

> ID：12902204
> 
> 赞同：1
> 
> 时间：2012-10-15T18:57:43.550
> 
> 标签：xslt

我在组合 XML 元素时遇到问题。以下 xml 具有重复值 (T804)，我如何使用 XSLT 将它们组合成一个 T804 记录中的记录。

前：

```
<OBR>
<OBR_31_Lab_Ins_Typ_Id>IL</OBR_31_Lab_Ins_Typ_Id>
<OBX>
<OBX_3_Ltt_Cd>T084</OBX_3_Ltt_Cd>
<OBX_5_1_Lbr_No></OBX_5_1_Lbr_No>
<OBX_5_2_Lbr_Tx>HIGH</OBX_5_2_Lbr_Tx>
<OBX_6_Lbr_Unt_Tx></OBX_6_Lbr_Unt_Tx>
<OBX_7_Lbr_Rng_Tx>1.003-1.035</OBX_7_Lbr_Rng_Tx>
</OBX>
<OBX>
<OBX_3_Ltt_Cd>T084</OBX_3_Ltt_Cd>
<OBX_5_1_Lbr_No>1.038</OBX_5_1_Lbr_No>
<OBX_5_2_Lbr_Tx></OBX_5_2_Lbr_Tx>
<OBX_6_Lbr_Unt_Tx></OBX_6_Lbr_Unt_Tx>
<OBX_7_Lbr_Rng_Tx>1.003-1.035</OBX_7_Lbr_Rng_Tx>
</OBX>
<OBX>
<OBX_3_Ltt_Cd>T086</OBX_3_Ltt_Cd>
<OBX_5_1_Lbr_No>0</OBX_5_1_Lbr_No>
<OBX_5_2_Lbr_Tx></OBX_5_2_Lbr_Tx>
<OBX_6_Lbr_Unt_Tx>HPF</OBX_6_Lbr_Unt_Tx>
<OBX_7_Lbr_Rng_Tx>0-9</OBX_7_Lbr_Rng_Tx>
</OBX>
<OBX>
<OBX_3_Ltt_Cd>T087</OBX_3_Ltt_Cd>
<OBX_5_1_Lbr_No>0</OBX_5_1_Lbr_No>
<OBX_5_2_Lbr_Tx></OBX_5_2_Lbr_Tx>
<OBX_6_Lbr_Unt_Tx>HPF</OBX_6_Lbr_Unt_Tx>
<OBX_7_Lbr_Rng_Tx>0-4</OBX_7_Lbr_Rng_Tx>
</OBX>
</ORB> 
```

之后 - 将两条 T084 记录合并为一条。

```
<OBR>
<OBR_31_Lab_Ins_Typ_Id>IL</OBR_31_Lab_Ins_Typ_Id>
<OBX>
<OBX_3_Ltt_Cd>T084</OBX_3_Ltt_Cd>
<OBX_5_1_Lbr_No>1.038</OBX_5_1_Lbr_No>
<OBX_5_2_Lbr_Tx>HIGH</OBX_5_2_Lbr_Tx>
<OBX_6_Lbr_Unt_Tx></OBX_6_Lbr_Unt_Tx>
<OBX_7_Lbr_Rng_Tx>1.003-1.035</OBX_7_Lbr_Rng_Tx>
<OBX>
<OBX_3_Ltt_Cd>T086</OBX_3_Ltt_Cd>
<OBX_5_1_Lbr_No>0</OBX_5_1_Lbr_No>
<OBX_5_2_Lbr_Tx></OBX_5_2_Lbr_Tx>
<OBX_6_Lbr_Unt_Tx>HPF</OBX_6_Lbr_Unt_Tx>
<OBX_7_Lbr_Rng_Tx>0-9</OBX_7_Lbr_Rng_Tx>
</OBX>
<OBX>
<OBX_3_Ltt_Cd>T087</OBX_3_Ltt_Cd>
<OBX_5_1_Lbr_No>0</OBX_5_1_Lbr_No>
<OBX_5_2_Lbr_Tx></OBX_5_2_Lbr_Tx>
<OBX_6_Lbr_Unt_Tx>HPF</OBX_6_Lbr_Unt_Tx>
<OBX_7_Lbr_Rng_Tx>0-4</OBX_7_Lbr_Rng_Tx>
</OBX>
</ORB> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T19:44:17.483

**这种转变**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:key name="kOrderByCd" match="OBX"
  use="OBX_3_Ltt_Cd"/>

 <xsl:template match="node()|@*" name="identity">
  <xsl:copy>
   <xsl:apply-templates select="node()|@*"/>
  </xsl:copy>
 </xsl:template>

 <xsl:template match=
  "OBX[generate-id()
      =
       generate-id(key('kOrderByCd', OBX_3_Ltt_Cd)[1])
      and
       key('kOrderByCd', OBX_3_Ltt_Cd)[2]
       ]">
  <OBX>
    <xsl:apply-templates mode="inGroup"/>
  </OBX>
 </xsl:template>

  <xsl:template match=
  "OBX[not(generate-id()
          =
           generate-id(key('kOrderByCd', OBX_3_Ltt_Cd)[1])
           )
       ]"/>

 <xsl:template match="OBX/*" mode="inGroup">
  <xsl:variable name="vNonEmpty" select=
   "key('kOrderByCd', ../OBX_3_Ltt_Cd)
            /*[name() = name(current())
             and
               text()
              ]"/>
  <xsl:apply-templates select=
    "$vNonEmpty[1]| self::*[not($vNonEmpty)]"/>
 </xsl:template>
</xsl:stylesheet> 
```

**应用于提供的 XML 文档时**：

```
<OBR>
    <OBR_31_Lab_Ins_Typ_Id>IL</OBR_31_Lab_Ins_Typ_Id>
    <OBX>
        <OBX_3_Ltt_Cd>T084</OBX_3_Ltt_Cd>
        <OBX_5_1_Lbr_No></OBX_5_1_Lbr_No>
        <OBX_5_2_Lbr_Tx>HIGH</OBX_5_2_Lbr_Tx>
        <OBX_6_Lbr_Unt_Tx></OBX_6_Lbr_Unt_Tx>
        <OBX_7_Lbr_Rng_Tx>1.003-1.035</OBX_7_Lbr_Rng_Tx>
    </OBX>
    <OBX>
        <OBX_3_Ltt_Cd>T084</OBX_3_Ltt_Cd>
        <OBX_5_1_Lbr_No>1.038</OBX_5_1_Lbr_No>
        <OBX_5_2_Lbr_Tx></OBX_5_2_Lbr_Tx>
        <OBX_6_Lbr_Unt_Tx></OBX_6_Lbr_Unt_Tx>
        <OBX_7_Lbr_Rng_Tx>1.003-1.035</OBX_7_Lbr_Rng_Tx>
    </OBX>
    <OBX>
        <OBX_3_Ltt_Cd>T086</OBX_3_Ltt_Cd>
        <OBX_5_1_Lbr_No>0</OBX_5_1_Lbr_No>
        <OBX_5_2_Lbr_Tx></OBX_5_2_Lbr_Tx>
        <OBX_6_Lbr_Unt_Tx>HPF</OBX_6_Lbr_Unt_Tx>
        <OBX_7_Lbr_Rng_Tx>0-9</OBX_7_Lbr_Rng_Tx>
    </OBX>
    <OBX>
        <OBX_3_Ltt_Cd>T087</OBX_3_Ltt_Cd>
        <OBX_5_1_Lbr_No>0</OBX_5_1_Lbr_No>
        <OBX_5_2_Lbr_Tx></OBX_5_2_Lbr_Tx>
        <OBX_6_Lbr_Unt_Tx>HPF</OBX_6_Lbr_Unt_Tx>
        <OBX_7_Lbr_Rng_Tx>0-4</OBX_7_Lbr_Rng_Tx>
    </OBX>
</OBR> 
```

**产生想要的正确结果：**

```
<OBR>
   <OBR_31_Lab_Ins_Typ_Id>IL</OBR_31_Lab_Ins_Typ_Id>
   <OBX>
      <OBX_3_Ltt_Cd>T084</OBX_3_Ltt_Cd>
      <OBX_5_1_Lbr_No>1.038</OBX_5_1_Lbr_No>
      <OBX_5_2_Lbr_Tx>HIGH</OBX_5_2_Lbr_Tx>
      <OBX_6_Lbr_Unt_Tx/>
      <OBX_7_Lbr_Rng_Tx>1.003-1.035</OBX_7_Lbr_Rng_Tx>
   </OBX>
   <OBX>
      <OBX_3_Ltt_Cd>T086</OBX_3_Ltt_Cd>
      <OBX_5_1_Lbr_No>0</OBX_5_1_Lbr_No>
      <OBX_5_2_Lbr_Tx/>
      <OBX_6_Lbr_Unt_Tx>HPF</OBX_6_Lbr_Unt_Tx>
      <OBX_7_Lbr_Rng_Tx>0-9</OBX_7_Lbr_Rng_Tx>
   </OBX>
   <OBX>
      <OBX_3_Ltt_Cd>T087</OBX_3_Ltt_Cd>
      <OBX_5_1_Lbr_No>0</OBX_5_1_Lbr_No>
      <OBX_5_2_Lbr_Tx/>
      <OBX_6_Lbr_Unt_Tx>HPF</OBX_6_Lbr_Unt_Tx>
      <OBX_7_Lbr_Rng_Tx>0-4</OBX_7_Lbr_Rng_Tx>
   </OBX>
</OBR> 
```

**说明**：

1.  孟加群。

2.  使用和覆盖身份规则。

3.  钥匙的使用。

# merge - 合并两个化石项目

> ID：12902206
> 
> 赞同：0
> 
> 时间：2012-10-15T18:58:01.067
> 
> 标签：merge, fossil

我在 Rails 网站上有两个几乎相同的 ruby​​。一个是开发版本，另一个是生产版本。它们唯一不同的地方是上传的数据，但不在存储库中。

我一直只是在开发，修复了一些东西，然后我只是同步应用程序目录，或者我更改的一些文件。这工作正常，直到现在。

现在我已经一年多没碰这些网站了，两边都做了一些改动。是的，我知道，当我不应该做的时候，我在做产品。

现在，我的问题是这个。我可以轻松地合并这两个项目（特别是应用程序目录），然后也许在将来，我可以在开发项目上工作，一旦完成，只需将更改推送过来吗？

我知道如何在其他版本控制的帮助下做到这一点，但我想知道这是否可以仅使用化石。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T19:10:31.283

我认为，如果你硬着头皮把两个版本放到一个存储库中，你的生活会更轻松。

建议的程序：

选择其中一个存储库。

打开它。

删除所有用户文件

添加来自其他存储库的所有用户文件。

签入，创建一个新分支。

合并分支。您将必须决定要合并到哪个分支。

# html - CSS3将项目向右移动

> ID：12902210
> 
> 赞同：1
> 
> 时间：2012-10-15T18:58:10.800
> 
> 标签：html, css

CSS3将项目向右移动

RIGHT 列的中心位置稍有不同（请参见右侧带有更多浅蓝色空间的屏幕截图）。如何操作 CSS 以将带有圆圈和文本的 RIGHT 列移动到与 LEFT 圆​​圈相同的边缘稍微靠近边缘？

向右移动大约 10 像素。

我目前：

```
 $('#content_index_right ul li:odd').css('padding', '10px 0'); 
```

[对齐顶部 http://www.kerrydeaf.com/circle_space2.png](http://www.kerrydeaf.com/circle_space2.png "工具提示")

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T19:03:27.323

指定该“中心”类的宽度，使其为 310px，它会为您解决问题：

```
.center{width:310px;} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T19:07:22.860

这应该让您的左侧元素在右侧有 10px 的额外边距：

```
#content_index_right ul li:odd{
  margin-right:10px;
} 
```

# javascript - JQGrid 和 JQuery 自动完成

> ID：12902214
> 
> 赞同：2
> 
> 时间：2012-10-15T18:58:35.183
> 
> 标签：javascript, jquery, jquery-ui, jqgrid, autocomplete

在实现 JQGrid 4.3.0、Jquery 1.6.2 和 JQuery UI 1.8.16 时，我遇到了内联编辑的问题。当内联编辑被激活时，一些元素被分配一个自动完成。当内联编辑被取消或保存时，自动完成并不总是消失（通过双击选择文本然后点击删除，然后点击转义退出行编辑）。当该行不再处于编辑模式时，将自动完成控件留在编辑模式。

也许您可以告诉我初始化是否有问题，或者您是否知道事件后“afterrestorefunc”字段可以返回到它们的“原始”状态。原始状态在 JQGrid 行中显示为数据。

我尝试在行关闭后删除 DOM，.remove() 和 .empty()：

```
 ... 
"afterrestorefunc": function(){ 
    $('.ui-autocomplete-input').remove();  }
... 
```

但这会导致其他问题，例如 jqgrid 在序列化数据行或编辑时无法找到单元格，并且需要刷新页面，而不仅仅是 jqgrid，才能再次看到该行中的数据.

双击该行会创建元素的自动完成功能：

```
function CreateCustomSearchElement(value, options, selectiontype) {
...
            var el;
            el = document.createElement("input");
            ...
            $(el).autocomplete({
                source: function (request, response) {
                    $.ajax({
                        url: '<%=ResolveUrl("~/Services/AutoCompleteService.asmx/GetAutoCompleteResponse") %>',
                        data: "{ 'prefixText': '" + request.term + "', 'contextKey': '" + options.name + "'}",
                        dataType: "json",
                        type: "POST",
                        contentType: "application/json; charset=utf-8",
                        success: function (data) {
                            response($.map(data.d, function (item) {
                                    return {
                                        label: Trim(item),
                                        value: Trim(item),
                                        searchVal: Trim(item)
                                    }

                            }))
                        }
                    });
                },
                select: function (e, item) {
                    //Select is on the event of selection where the value and label have already been determined.                        
                },
                minLength: 1,
                change: function (event, ui) {
                    //if the active element was not the search button                      
                    //...                       
                }
            }).keyup(function (e) {
                if (e.keyCode == 8 || e.keyCode == 46) {
                    //If the user hits backspace or delete, check the value of the textbox before setting the searchValue                
                    //...
                }
            }).keydown(function (e) {
                //if keycode is enter key and there is a value, you need to validate the data through select or change(onblur)
                if (e.keyCode == '13' && ($(el).val())) {
                    return false;
                }
                if (e.keyCode == '220') { return false }
            });
        } 
```

其他来源： [http ://www.trirand.com/jqgridwiki/doku.php?id=wiki:inline_editing](http://www.trirand.com/jqgridwiki/doku.php?id=wiki:inline_editing)

[http://api.jqueryui.com/autocomplete/](http://api.jqueryui.com/autocomplete/)

**更新：** 我尝试仅在元素聚焦时创建自动完成，并在 onblur 时将其删除。那也没有解决问题。似乎只需要触发自动完成下拉菜单。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T16:58:09.097

在调用自动​​完成之前，我有一个自定义启用/禁用功能。这会导致对同一个 jqgrid 单元格的多次引用调用，从而导致冲突。因此，在我应该打开内联编辑的行上双击事件期间。根据记录类型，获取并分析需要启用/禁用哪些单元格。它从页面加载期间的代码中确定关联数组可用的字段，序列化为隐藏字段值。

```
function tableRowDoubleClick(id, iRow, iCol, e) {
...
setCellEditabilityByRecordType(id);
...    
} 
```

单元格可编辑性通过以下方式设置：

```
 function setCellEditabilityByRecordType(id) {
//change some of the fields to read-only
var grid = $('#mygrid');
var i;
var cm;
var cellRecordType = grid.jqGrid('getCell', id, 'RecordType')
//Determine Fields Disabled by evaluation of data from a hidden field.
var disablefields = eval(pg_FieldDisable[cellRecordType]);
for (i = 0; i < disablefields.length; i++) {
cm = grid.jqGrid('getColProp', disablefields[i]);
cm.editable = false;
}
...
}
... 
```

因此，当行的初始设置对双击做出反应时，就设置了单元格可编辑性。然后“CreateCustomSearchElement”触发。

但是，如果用户双击该行，它会再次触发双击，设置单元格可编辑性，但针对同一行。所以这会导致对单元格的多次引用，在这一点上，我不确定发生了什么。我所知道的是我必须将行可编辑性集中到一个函数，或者找到一种方法来读取被双击的当前行是否真的需要再次设置可编辑性。

**参考** JavaScript 关联数组：[http ://blog.xkoder.com/2008/07/10/javascript-associative-arrays-demystified/](http://blog.xkoder.com/2008/07/10/javascript-associative-arrays-demystified/)

# java - Java BufferedWriter IOException“打开的文件太多”

> ID：12902218
> 
> 赞同：1
> 
> 时间：2012-10-15T18:58:42.310
> 
> 标签：java

> **可能重复：**
> [Java 打开的文件太多](https://stackoverflow.com/questions/4289447/java-too-many-open-files)

**这不是重复的，引用的问题不同，只有标题相同，请仔细阅读**

这是我的文件写入功能

```
 public static void WriteLog(String LogLine) {
    String filePath = CommonClass.ReadPropertiesFile("LogFilepath");
    BufferedWriter out = null;
    try {
        // Create file
        FileWriter fstream = new FileWriter(filePath, true);
        out = new BufferedWriter(fstream);
        out.write(LogLine + "\r\n");

    } catch (Exception e) {//Catch exception if any
        System.err.println("Error: " + e.getMessage());
    } finally {
        //Close the output stream
        if (out != null) {
            try {
                out.write("Closing stream\r\n");
                out.close();

            } catch (IOException ex) {
                System.err.println("Error Closing stream: " + ex.getMessage());
                Logger.getLogger(LogWritter.class.getName()).log(Level.SEVERE, null, ex);
            }
        }
    }
} 
```

我也看到[了这个问题](https://stackoverflow.com/questions/2960427/java-bufferedwriter-close)，但它似乎没有帮助，如果 close 是一个阻塞调用，那么它不应该给出这个问题。

但是当我太频繁地调用 WriteLog 函数时，即在循环中我得到这个错误：

```
Error:  (No such file or directory)
Could not load properties File, Exception: (Too many open files), 
Error:  (No such file or directory)
Could not load properties File, Exception: (Too many open files), 
```

在特定数量的调用之后，在每次后续调用中，我都会不断收到此错误，并且文件中不再写入任何文本。谁能告诉我我完全困惑的原因。

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T19:04:48.350

看看 ReadPropertiesFile()

```
CommonClass.ReadPropertiesFile("LogFilepath"); 
```

我想 close() 丢失了...

坏的：

```
properties.load( new FileInputStream( PropertiesFilePath )); 
```

更好的：

```
InputStream is = new FileInputStream( PropertiesFilePath );
properties.load( is );
is.close(); 
```

但是 AMHO 可以在每次运行时读取一次 PropertiesFile，而不是每次需要属性值时

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-15T19:04:41.720

只需阅读您的属性文件一次。

```
private static String filePath = CommonClass.ReadPropertiesFile("LogFilepath");
public static void WriteLog(String LogLine) {
    ... 
```

CommonClass.ReadPropertiesFile 背后的代码可能有问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T19:13:13.827

尝试关闭文件：

```
 fstream.close(); 
```

我已经用你的代码测试了它。

# macos - 无法让 Hello World / gas / Mac OS X 工作

> ID：12902220
> 
> 赞同：1
> 
> 时间：2012-10-15T18:59:05.307
> 
> 标签：macos, assembly, clang, gnu-assembler

我正在尝试在 Mac OS X 的 GNU 汇编器中编写 Hello World，但在它可以打印“Hello World”之前出现总线错误。

[你好.s](https://github.com/mcandre/mcandre/blob/master/gas/hello/freebsd/hello.s)：

```
.global start

.data

.equ stdout, 1

.equ sys_write, 4
.equ sys_exit, 1

.equ kernel, 0x80

msg: .asciz "Hello World!\n"
.equ len, .-msg

.text

start:
    push $len
    push $msg
    push $stdout
    mov $sys_write, %eax
    sub $4, %esp
    int $kernel
    add $4 + $4 * $3, %esp

    push $0
    mov $sys_exit, %eax
    sub $4, %esp
    int $kernel 
```

痕迹：

```
$ clang -c -o hello.o hello.s
$ ld -o hello -macosx_version_min 10.6 hello.o
$ ./hello
Bus error: 10

$ gdb hello
(gdb) run
Starting program: /Users/andrew/Desktop/src/mcandre/gas/hello/freebsd/hello 

Program received signal EXC_BAD_ACCESS, Could not access memory.
Reason: KERN_PROTECTION_FAILURE at address: 0x0000000000002000
0x0000000000002000 in msg () 
```

我的代码基于几件事：

*   [为 Hello World 工作的 NASM / Mac OS X 代码](https://github.com/mcandre/mcandre/blob/master/nasm/hello/freebsd/hello.asm)
*   [Hello World 的工作气体/Linux 代码](https://github.com/mcandre/mcandre/blob/master/gas/hello/linux/hello.s)

我采用了 NASM / Mac OS X 的语义和 Gas / Linux 的语法。

[我还尝试了 GNU Assembler Wikipedia page](http://en.wikipedia.org/wiki/GNU_Assembler#Example_Programs)上的示例程序，但它也出现了总线错误。

我向 Apple 提交了一份错误报告，因为它的 GNU 汇编器非常过时（如 1.38）。他们说改用clang。

我究竟做错了什么？

眼镜：

*   ld64-134.9
*   铿锵声4.1
*   Xcode 4.5
*   Mac OS X 10.8.2
*   MacBook Pro 2009

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T22:20:50.917

对于你做错了什么，我不确定。自从我使用汇编以来已经有一段时间了，但是 clang 不喜欢我的 mac 上的 .equ 状态。当我更换这些时，它运行良好。（老实说，我更喜欢 NASM，虽然我使用的是 macports 的那个。）

我创建了一个简单的 .s 文件，可以用 clang 编译，我在字符串长度方面遇到了一个问题。（也许这是一个错误？）我将长度存储在 $len 中，但是当我使用 $len 时它不起作用..但使用硬编码数字确实如此。

我用以下代码编译了代码：

```
clang -c -o hello.o hello.s -arch i386
ld -o hello -macosx_version_min 10.6 -arch i386 hello.o
./hello 
```

你好.s:

```
/* defines */
.set sys_exit, 1
.set sys_write, 4
.set stdout, 1
.set kernel, 0x80

// TEXT SECTION
.text

/* write function */
.macro write str, strSize
    // length of string
    push \strSize
    // the string
    push \str
    // to file descriptor
    push $stdout
    // what we want to call
    movl $sys_write, %eax
    // call the kernal
    call _syscall
    // free the stack
    addl $12, %esp
.endm

/* define main function */
.globl start

/* impl. main function */
start:

    // write(string, long)
    // if I use $len i get a bunch of letters
    write $msg, $14 //$len

    // exit(0)
    // if i print out $len it is 14
    push $0 //$len
    movl $sys_exit, %eax
    call _syscall

/* call kernal 
 * 
 * so you don't have to do sub $4, %esp
 */
_syscall:
    int $kernel
    ret

// DATA SECTION
.data
    /* our string */
    msg: .string "Hello World!\n"
    // using len: .long $14 causes the same issue as . - msg
    // where the string does not end at 14
    // perhaps someone else knows why..
    len: .long . - msg 
```

我希望这有帮助。

# ruby-on-rails - Rails NullBoolean？

> ID：12902221
> 
> 赞同：2
> 
> 时间：2012-10-15T18:59:17.493
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, activerecord, sqldatatypes

Rails 是否有一个与 Django NullBoolean 等效的内置函数，接受三个值（nil、true、false）？如果没有，你会如何建议实施它？

就我而言，我有一张桌子`Overrides`和一张桌子`Objects`。`Objects`可以有很多`Overrides`。`Overrides`在结构上与 几乎相同`Objects`。在读取 a 的值之前`Object`，我拉它`Overrides`，有条件地挑选它们，然后将这些值应用到`Object`.

任何`Override`为 nil 的字段都不会应用任何更改。这个系统对我来说运行良好，但我只是在 中添加了一个布尔字段`Objects`，所以我需要在 上放置一个可为空的布尔值`Overrides`。Django`NullBoolean`在这种类型的场景中运行良好，但我很难找到等效的 rails。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-15T19:57:34.973

ActiveRecord 将数据库中的可空性和类型分开。`:null => false`此外，除非您在创建/更改列时明确指定，否则 ActiveRecord 会将列创建为可为空的。所以你应该能够创建一个标准的布尔列：

```
create_table "..." do |t|
  #...
  t.boolean "boolean_column"
end 
```

然后根据需要分配 true/false/nil：

```
o.boolean_column = true  # true
o.boolean_column = false # false
o.boolean_column = nil   # null 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-10-15T19:39:32.313

在 Ruby 中，我们得到了`nil`.

对于条件语句，`nil`被解释为`false`.

```
1.8.7 :001 > if nil
1.8.7 :002?>   0
1.8.7 :003?>   end
 => nil 
1.8.7 :004 > if false
1.8.7 :005?>   0
1.8.7 :006?>   end
 => nil 
1.8.7 :007 > if true
1.8.7 :008?>   0
1.8.7 :009?>   end
 => 0 
1.8.7 :010 > x = 0
 => 0 
1.8.7 :011 > if nil
1.8.7 :012?>   x = 1
1.8.7 :013?>   end
 => nil 
1.8.7 :014 > x
 => 0 
1.8.7 :015 > if false
1.8.7 :016?>   x = 1
1.8.7 :017?>   end
 => nil 
1.8.7 :018 > if true
1.8.7 :019?>   x = 1
1.8.7 :020?>   end
 => 1 
1.8.7 :021 > x
 => 1 
1.8.7 :022 > if 2 
1.8.7 :023?>   x= 2
1.8.7 :024?>   end
 => 2 
1.8.7 :025 > x
 => 2 
```

有趣的是，如果您`nil`在 Ruby 中执行 non-value，它会被解释为`true`您在最后一种情况中看到的那样。

# knockout.js - 敲除数组

> ID：12902224
> 
> 赞同：2
> 
> 时间：2012-10-15T18:59:19.260
> 
> 标签：knockout.js

传入的数据是这样的`[[1,2,3],[4,5,6]]`，有时是这样的`[[1,2],[4,5]]`。这是HTML。

```
<button data-bind="click: refreshJSON">Test</button>
<table>
    <tbody data-bind="foreach: array">
        <tr data-bind="foreach: subarray">
            <td data-bind="text: $data"></td>
        </tr>
    </tbody>
</table>

<script type="text/javascript">

    var ViewModel = {

        tableModel : ko.observableArray([[1,2,3],[4,5,6]]),

        refreshJSON : function(){
            this.tableModel([[1,2],[4,5]]);
        }

    };

    ko.applyBindings(ViewModel);

</script> 
```

我猜我必须`ko.observableArray()`在每个子数组上使用，但是我不清楚如何执行此操作，或者如何`data-binds`在 HTML 中执行。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-15T19:08:22.783

更新：删除了 observableArray 位中的 observableArray。显然这行不通。只需绑定您的外部集合。

绑定部分相当简单：

```
<div data-bind="foreach: tableModel">
    <div data-bind="foreach: $data">
        <span data-bind="text: $data"></span>
    </div>
</div> 
```

# shell - 如何输入带有空格的路径？

> ID：12902227
> 
> 赞同：68
> 
> 时间：2012-10-15T18:59:29.583
> 
> 标签：shell

我有一个主文件，它使用（从主我做一个源）一个带有指向路径的变量的属性文件。

属性文件如下所示：

```
TMP_PATH=/$COMPANY/someProject/tmp
OUTPUT_PATH=/$COMPANY/someProject/output
SOME_PATH=/$COMPANY/someProject/some path 
```

问题是`SOME_PATH`，我必须使用带空格的路径（我无法更改）。

我尝试用引号转义空格，但到目前为止还没有解决方案。

我编辑了路径，单引号的问题是我`$COMPANY`在路径中使用了另一个变量

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2012-10-15T19:03:17.637

使用以下三种变体之一：

```
SOME_PATH="/mnt/someProject/some path"
SOME_PATH='/mnt/someProject/some path'
SOME_PATH=/mnt/someProject/some\ path 
```

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2012-10-22T06:04:55.490

我看到 Federico 你自己找到了解决方案。问题出在两个地方。在您的情况下，作业需要正确引用

```
SOME_PATH="/$COMPANY/someProject/some path" 
```

是可能的解决方案之一。

但是在shell中这些引号并没有存储在内存中，所以当你想使用这个变量时，你需要再次引用它，例如：

```
NEW_VAR="$SOME_PATH" 
```

因为如果没有，空间将扩展到命令级别，如下所示：

```
NEW_VAR=/YourCompany/someProject/some path 
```

这不是你想要的。

[有关更多信息，您可以查看我关于它的文章[http://www.cofoh.com/white-shell](http://www.cofoh.com/white-shell)]

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2012-10-15T19:01:37.757

您可以通过在其前面放置 \ 来逃避“空格”字符。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-10-15T19:01:01.890

```
SOME_PATH=/mnt/someProject/some\ path 
```

应该管用

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-15T19:05:30.650

如果文件仅包含参数分配，则可以使用以下循环代替源代码：

```
# Instead of source file.txt
while IFS="=" read name value; do
    declare "$name=$value"
done < file.txt 
```

这使您不必引用文件中的任何内容，并且也更安全，因为您不会冒险从`file.txt`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-06-29T18:30:32.810

如果 Ubuntu 中的路径是“/home/ec2-user/目录名称”，则执行以下操作：

1) Java 的 build.properties 文件：

```
build_path='/home/ec2-user/Name\\ of\\ Directory' 
```

哪里`~/`等于`/home/ec2-user`

2）詹金斯文件：

```
build_path=buildprops['build_path']
echo "Build path= ${build_path}"
sh "cd ${build_path}" 
```

# css - Ember.js - 根据对象属性更新 CSS 宽度

> ID：12902229
> 
> 赞同：3
> 
> 时间：2012-10-15T18:59:35.963
> 
> 标签：css, ember.js, observable

正如[@andorov 的回答](https://stackoverflow.com/a/32593118/565877)中提到的，OP 的理想代码（`<div style="width:{{model.width}}">`现在几乎只适用于 Ember 1.10

> 我是 Ember.js 的新手，我发现动态更改 CSS 很困难。这是一个例子来解释我的意思：
> 
> ```
> var App = Em.Application.create();
> 
> App.MyObj=Em.Object.extend({
>     objWidth:10
> });
> 
> App.objController = Ember.ArrayController.create({
>     content: [],
>   createObj: function(){
>       var obj = App.MyObj.create();
>       this.pushObject(obj);
>   }
> }); 
> ```
> 
> 下面的代码不起作用，但它解释了我的目标。使用 Handlebars 模板，我想完成这个：
> 
> ```
> {{#each obj in App.objController}}
>      <div style="width:{{obj.objWidth}}"></div>
> {{/each}} 
> ```
> 
> 换句话说，我只想在属性更改`<div>`时获得更新的宽度。`objWidth`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-15T22:14:06.360

该`style`属性必须与 绑定`bindAttr`，将**样式作为一个整体**传递，而不仅仅是其中一个属性，因为它不理解这一点。此属性仅允许您以字符串形式访问样式，以直接元素为目标。如果您这样定义，则无法绑定到样式的属性。

所以[这是我的建议](http://jsfiddle.net/schawaska/ftWZ6/)：我创建了几个“模型”类，如下所示，实现了一个以像素为单位返回宽度的属性：

```
var WidthEnabledModel = Em.Object.extend({
    width: 100,
    unit: "px",
    widthString: function() {
        return 'width: %@%@'.fmt(this.width, this.unit);
    }.property('width', 'unit')            
});

App.SampleModel = WidthEnabledModel.extend({
    itemName: ''
}); 
```

然后，对于集合中的每个项目，我将该属性绑定到`style`属性：

```
<script type="text/x-handlebars" data-template-name="sample">
    <div id="sample_area" style="width: 250px;">
    {{#each thing in controller.content}}
      <div class="item" {{bindAttr style="thing.widthString"}}>
          {{thing.itemName}}<br />
          {{thing.widthString}}
      </div>
    {{/each}}
    <div>
</script> 
```

按照我在 jsfiddle 上制作的完整代码的示例[http://jsfiddle.net/schawaska/ftWZ6/](http://jsfiddle.net/schawaska/ftWZ6/)

**编辑：** 我在小提琴中进行了一些更改以添加更多功能，但设置宽度的部分保持不变。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-09-15T18:28:17.690

您的原始解决方案`style="{{dynamicStyleAttribute}}"`现在可以使用新的绑定属性语法 - [http://emberjs.com/blog/2015/02/07/ember-1-10-0-released.html#toc_bound-attribute-syntax](http://emberjs.com/blog/2015/02/07/ember-1-10-0-released.html#toc_bound-attribute-syntax)

您需要将 a 附加`px`到 的值`width:300px`，并调用`Ember.String.htmlSafe('your string')`它。

注意还有一些未解决的问题： [https ://github.com/emberjs/ember.js/issues/10783](https://github.com/emberjs/ember.js/issues/10783) [https://github.com/emberjs/ember.js/issues/10870](https://github.com/emberjs/ember.js/issues/10870)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T19:41:38.257

您是否尝试过创建视图并将其绑定到控制器？

例如：

**在您的 Javascript 中：**

```
App.objView = Ember.View.extend({
    contentBinding : 'App.objController',
    widthBinding : 'content.width'
}); 
```

**在您的车把中：**

```
{{#each Ember.App.objController}}
    {{#view Ember.App.objView contentBinding="this"}}
        <div style="width: {{width}};"></div>
    {{/view}}
{{/each}} 
```

# objective-c - 使用 FGallery 图像查看器

> ID：12902233
> 
> 赞同：0
> 
> 时间：2012-10-15T19:00:02.027
> 
> 标签：objective-c, ios, ipad

我正在尝试实现 FGallery imageviewer。我有一个方法，它为我提供了我想要显示的所有照片 URL 的数组。接下来我实现了以下 FGallery 方法。

```
- (int)numberOfPhotosForPhotoGallery:(FGalleryViewController *)gallery
{
     return [_picturesForAlbum count];

}

- (FGalleryPhotoSourceType)photoGallery:(FGalleryViewController *)gallery sourceTypeForPhotoAtIndex:(NSUInteger)index
{
     return FGalleryPhotoSourceTypeNetwork;
}

- (NSString*)photoGallery:(FGalleryViewController *)gallery urlForPhotoSize:(FGalleryPhotoSize)size atIndex:(NSUInteger)index {
    return [_picturesForAlbum objectAtIndex:index];
} 
```

在我的 didSelectRowForIndexPath 中我做了这个。

```
networkGallery = [[FGalleryViewController alloc] initWithPhotoSource:self.picturesForAlbum];
        [self.navigationController pushViewController:networkGallery animated:YES]; 
```

但我不知道应该在 initWithPhotoSource 中放什么。当我拥有它时。我不断收到以下错误。

```
Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[__NSArrayM numberOfPhotosForPhotoGallery:]: unrecognized selector sent to instance 0xc95bb60' 
```

有谁能够帮我？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T11:56:35.247

委托，即自我。它将调用委托方法。[[FGalleryViewController alloc] initWithPhotoSource:self];

# objective-c - UITableView setRowHeight 如何提交更改

> ID：12902236
> 
> 赞同：0
> 
> 时间：2012-10-15T19:00:23.717
> 
> 标签：objective-c, uitableview, setneedsdisplay, row-height

我有一个设计，其中`UITableViewCell`s 包含一个`UIImageView`. `UIDeviceOrientationDidChangeNotification`该图像在纵向或横向中应该具有相同的比例，这就是为什么我有一个在界面方向更改时使用通知调用的方法。

```
-(void)updateRowHeightForOrientation:(UIInterfaceOrientation)orientation {

    if(!IS_KNOWN_ORIENTATION(orientation))
        return;

    CGFloat rowHeightPortrait = (IPAD ? 320\. : 160.);
    CGFloat widthPortrait = (IPAD ? 768\. : 320.);
    CGFloat orientationWidth = (IS_PORTRAIT(orientation) ?
                                (IPAD ? 768\. : 320.) :
                                (IPAD ? 1024\. : 480.));

    CGFloat resultingRowHeight = rowHeightPortrait * orientationWidth / widthPortrait;

    [self.tableView setRowHeight:resultingRowHeight];
//    [self.tableView reloadData]; /* works if uncommented */
} 
```

如果未注释该行，则重绘视图并正确设置行高。如果没有，即使使用`[self.tableView setNeedsDisplay]`或`[self.tableView setNeedsLayout]`不使用属性的新值。

如何强制重新加载 UI 以便应用新值？

它使用了一段时间，`-(void)willRotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation duration:(NSTimeInterval)duration`因为该`rowHeight`属性是在界面旋转并重绘之前设置的，但由于一些奇怪的原因，这个方法不再被调用......

谢谢你的帮助 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T19:11:09.490

我觉得

```
[self.tableView beginUpdates];
[self.tableView endUpdates]; 
```

导致表格视图重新评估所有行高，所以你可以试试这个。

# c# - DataContractSerializer - 配置系统初始化失败——应用配置设置

> ID：12902237
> 
> 赞同：2
> 
> 时间：2012-10-15T19:00:32.980
> 
> 标签：c#, .net, serialization, datacontractserializer, datacontract

我正在使用 DataContractSerializer 作为一个独立的部分来序列化一些使用 DataContract/Member 的对象......不幸的是，如果我将自定义 App.Config 部分添加到我的解决方案的配置设置中，它会一直抛出异常，而这完全没有任何关系通过这个过程......例如，我的配置设置如下：

```
<configuration>
    <appSettings>
         <!--stuff goes here -->
    </appSettings>

    <MyCustomSectionItDoesntLike>
        <!--stuff goes here -->
    </MyCustomSectionItDoesntLike>
</configuration> 
```

然后我拿起对象并尝试使用内存流写入......

```
DataContractSerializer serializer = new DataContractSerializer(item.GetType());
using (MemoryStream memoryStream = new MemoryStream())
    {
           serializer.WriteObject(memoryStream, item);

    } 
```

如果我从配置设置中删除 MyCustomSectionItDoesntLike，它工作得很好，但是当我把它放回去时，会触发一个异常：

信息：

> 'System.Runtime.Serialization.DiagnosticUtility' 的类型初始化程序引发了异常。

内：

> 无法识别的配置节 MyCustomSectionItDoesntLike。（D:\test\bin\x86\Debug\test.vshost.exe.config 第 47 行）

我不确定为什么它不关心项目中任何地方的设置是什么，除非我要序列化......是否需要添加设置或配置部分才能使其正常工作？

谢谢！

## 更新

完全愚蠢的错误......与序列化程序无关......

```
<configuration>
    <configSections>
         <!--This is where i blew it -->
         <section name="MyCustomSectionItDoesntLike" type="System.Stuff.Stuff" />
    </configSections>
    <appSettings>
         <!--stuff goes here -->
    </appSettings>

    <MyCustomSectionItDoesntLike>
        <!--stuff goes here -->
    </MyCustomSectionItDoesntLike>
</configuration> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T19:06:12.483

`configSections`您必须在 app.config 文件中引用实现自定义部分的类。

检查[http://msdn.microsoft.com/en-us/library/2tw134k3%28v=vs.100%29.aspx](http://msdn.microsoft.com/en-us/library/2tw134k3%28v=vs.100%29.aspx)了解更多信息。

# iphone - 访问从 GestureRecognizer 点击检测到的 UIImageView.image

> ID：12902240
> 
> 赞同：3
> 
> 时间：2012-10-15T19:00:52.637
> 
> 标签：iphone, objective-c, xcode, ipad

我有一个按钮，它将以编程方式为他们从照片库中选择的每张照片创建一个带有图像的 UIImageView。它将照片放在视图上，您​​可以四处移动它等等。

当用户按住图像时，它会在 iPad 上弹出一个 UIPopOverController。从那里，用户单击一个按钮来编辑当前被触摸的图像。

我遇到的问题是我无法重新访问该 UIImageView.image 以将图像更改为刚刚编辑的完成图像。

这是一些代码示例。

```
// This figures out what imageView was tapped
- (void)handleEditTapped:(UITapGestureRecognizer *)recognizer {
editImage = (UIImageView*)recognizer.view;

if(UIGestureRecognizerStateBegan == recognizer.state) {
    // Called on start of gesture, do work son!
    popoverEditor = [[UIPopoverController alloc] initWithContentViewController:[self.storyboard instantiateViewControllerWithIdentifier:@"popupEditor"]];
    [popoverEditor presentPopoverFromRect:editImage.bounds inView:editImage permittedArrowDirections:UIPopoverArrowDirectionAny animated:YES];

}
} 
```

然后，我将使用 popupEditor 视图上的按钮弹出我的 editorController：

```
- (IBAction)effectsEditorButton:(id)sender {

// This part I've been fooling around with to save the image and re-load it to try and get it to work but it loads successfully to the editor but will not save back to uiimageview.image
NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
NSData *imageData = [defaults dataForKey:@"image"];
UIImage *loadedImage = [UIImage imageWithData:imageData];

myEditorController *editorController = [[myEditorController alloc] initWithImage:loadedImage];
[editorController setDelegate:self];

popoverEditor = [[UIPopoverController alloc] initWithContentViewController:editorController];
[popoverEditor presentPopoverFromRect:self.effectsButtonImage.bounds inView:self.effectsButtonImage permittedArrowDirections:UIPopoverArrowDirectionAny animated:YES];
   }
} 
```

然后在用户完成照片编辑后调用它：

```
- (void)photoEditor:(myEditorController *)editor finishedWithImage:(UIImage *)finishedImage
{

// NSLog(@"TAG: %i",editImage.tag); Tried tags but wouldn't hold the .tag value to re reference it. Would always result in 0 after I set the tag to 10 on handleEditTapped

editImage.image = finishedImage;

[self.popoverEditor dismissPopoverAnimated:YES];
} 
```

我不知道如何重新访问 UIImageView.image。我已经尝试过标签和 nsuserdefaults 但无济于事！

任何帮助将不胜感激！！谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T23:21:11.280

这个问题与应用程序逻辑密切相关，很大程度上取决于您如何设计对象，而不是框架、iOS 或 objc。在这方面，关于如何调整应用程序设计以解决此问题的一些建议。没有足够的信息来给出完整的答案，但希望这会有所帮助。

1.  确保您在定义 handleEditTapped: 的 ViewController 中有一个良好的数据模型。您应该使用“应用程序数据”而不是“演示数据”。即存储用户“选择”并使用该数据生成演示 UIImageViews。
2.  将 myEditorController 委托协议更新为 - (void)photoEditor:(myEditorController *)editor finishedWithImage:(UIImage *)finishedImage withUserInfo:(NSDictionary* ) 信息。使用它来构建您在 1 中定义的模型，传入唯一标识用户正在使用的“应用程序数据”的信息。myEditorController 对 userInfo 不做任何事情，只是将它传回给您的委托。
3.  当您的委托方法被回调时，检查 userInfo 中的数据（在读取它时插入它的同一控制器）并使用它连接回应用程序数据。以这种方式接近它与您正在做的事情有点“倒退”。锻炼，而不是锻炼。
4.  考虑将图像写入文件系统而不是 UserDefaults，我认为这是专门用于图像的更好选择。您可以使用唯一的字符串键将数据模型的其余部分连接到文件系统路径。

# ruby-on-rails - Rails 中的电子邮件通知

> ID：12902244
> 
> 赞同：0
> 
> 时间：2012-10-15T19:01:09.677
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.2

`new.html.erb`在我的 Rails 3.2 项目中，我有一个表单可以在其中创建一个新帖子`app/views/posts/`

```
<%= form_for(@post) do |post_form| %>
  ...
  <div class="field">
    <%= post_form.label :email %><br />
    <%= post_form.text_field :email %>
  </div>
  <div class="field">
    <%= post_form.label :title %><br />
    <%= post_form.text_field :title %>
  </div>
  <div class="field">
    <%= post_form.label :content %><br />
    <%= post_form.text_field :content %>
  </div>
  <div class="actions">
    <%= post_form.submit %>
  </div>
<% end %> 
```

然后`create`函数在`posts_controller.rb`

```
def create
  @post = Post.new(params[:post])  
  if @post.save
    format.html { redirect_to @post }
  else
    format.html { render action: "new" }
  end
end 
```

当用户提交帖子时，我想向`email`“您已提交带有标题`title`和内容的帖子”的电子邮件通知`content`。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T19:10:03.250

您将设置一个邮件程序，为它提供一个模板，然后调用邮件程序操作，或者在创建操作本身中，或者作为 Post 模型的回调。

这是[关于在 Rails 3 中使用 ActionMailer 的 Railscast](http://railscasts.com/episodes/206-action-mailer-in-rails-3)。它应该几乎涵盖了这些步骤。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T19:10:20.363

您将创建一个新的邮件程序类，并从您希望发送电子邮件的控制器中调用该类。你可以在这里了解 ActionMailer [http://guides.rubyonrails.org/action_mailer_basics.html](http://guides.rubyonrails.org/action_mailer_basics.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T19:10:43.717

您必须在 app/mailers/ 文件夹中创建一个邮件设置初始化程序和一个 user_post_mailer.rb

然后你可以打电话

UserMailer.post_confirmation(@user).deliver

来自你的控制器

[Railscast 邮件程序集](http://railscasts.com/episodes/206-action-mailer-in-rails-3)

# python - 用 +/- 符号解析数字字符串并保留符号

> ID：12902246
> 
> 赞同：0
> 
> 时间：2012-10-15T19:01:28.087
> 
> 标签：python, string

我有一个看起来像这样的字符串

```
+0.6810+0.0266-0.0140-0.0111-0.0080-00.026-0.0229+000.84 
```

我需要在每个 +/- 符号处解析此字符串，同时将符号与数字保持一致，以便将它们存储到变量中。所以我想要出来的是七个正数或负数中的每一个的变量，比如

```
a= 0.6810
b= 0.0266
c= -0.0140 
```

ETC

我能够吐出字符串，但现在一种转换为流并保持符号当前代码拆分字符串的方法是：

```
print (re.split(r'[+-]+',dataString)) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T19:03:01.620

如果字符串与您发布的字符串一样，您可以简单地执行以下操作：

```
your_string.replace('-', '+-').split('+') 
```

但这并不稳健。

无论如何，您可以简单地使用该`re.findall`方法。我认为：

```
re.findall(r'[+-]\d+(\.\d+)?', your_string) 
```

应该做的伎俩。

实际上，它也可以匹配整数，如果您的数字在两个站点上总是有句点和数字，您可以使用：

```
r'[+-]\d+\.\d+ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-15T19:07:04.887

您可以`re.findall`在您的字符串上使用：-

```
>>> string = "+0.6810+0.0266-0.0140-0.0111-0.0080-00.026-0.0229+000.84"
>>> 
>>> import re
>>> matches = re.findall(r'[-+]\d+\.\d+', string)
>>> matches
['+0.6810', '+0.0266', '-0.0140', '-0.0111', '-0.0080', '-00.026', '-0.0229', 
 '+000.84']
>>>
>>> a = float(matches[0])
>>> 0.681

>>> (a, b, c, d, e, f, g) = map(float, matches)[:7] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T19:06:52.880

用拆分替换字符串怎么样？就像是

```
print (re.replace(r"([+-])", " \1", dataString)).split() 
```

可能不是最好的方法，但它会完成这项工作......我想，没有测试它！

# unit-testing - Spring 3.1 依赖注入 - JUnit 测试

> ID：12902247
> 
> 赞同：0
> 
> 时间：2012-10-15T19:01:30.520
> 
> 标签：unit-testing, spring-mvc, controller, nullpointerexception

我正在使用 Spring MVC 3.1，并且正在尝试测试一个名为 LoginController 的控制器类。当该方法尝试使用在 LoginController 类中自动装配的引用 authenticationService 进行调用时，我在该方法中得到一个空指针异常。我已经引用了这个[链接](https://stackoverflow.com/questions/4396786/spring-ioc-dependency-injection-nullpointerexception)以及[这个](https://stackoverflow.com/questions/3133544/autowire-throws-a-nullpointerexception)链接。为了清楚起见，请参阅下面的代码

**登录控制器测试.java**

```
 @RunWith(SpringJUnit4ClassRunner.class)
 @ContextConfiguration(locations = {"classpath:servlet-context.xml"})
public class LoginControllerTest extends DatabaseSupport {

@Autowired
private ApplicationContext applicationContext;

@Autowired
private LoginController loginController;

 @Autowired
private AuthenticationService authenticationService;

private MockHttpServletRequest request;
private MockHttpServletResponse response;
private RequestMappingHandlerAdapter handlerAdapter;

private LoginForm loginForm;

@Before
public void setUp() {
    request = new MockHttpServletRequest();
    response = new MockHttpServletResponse();

    handlerAdapter = applicationContext.getBean(RequestMappingHandlerAdapter.class);
    authenticationService = applicationContext.getAutowireCapableBeanFactory()
                           .createBean(AuthenticationService.class);
    loginController = new LoginController();
    loginForm = new LoginForm();

}

@Test
public void loginTest() throws Exception {
    final String expectedMessage = "login";
    final String requestUri = "/";
    final HandlerMethod expectedHandlerMethod;

    final MockHttpServletRequest request;
    final MockHttpServletResponse response;

    request = new MockHttpServletRequest();
    response = new MockHttpServletResponse();
    request.setMethod("GET");

    request.setRequestURI(requestUri);

    expectedHandlerMethod = new HandlerMethod(loginController, "login");
    ModelAndView mav = handlerAdapter.handle(request, response, expectedHandlerMethod); //this.getHandler(request);

    assertViewName(mav, expectedMessage);
}

@Test
public void logoutTest() throws Exception {
    final String expectedMessage = "login";
    final String requestUri = "/";
    final HandlerMethod expectedHandlerMethod;

    final MockHttpServletRequest request;
    final MockHttpServletResponse response;

    request = new MockHttpServletRequest();
    response = new MockHttpServletResponse();
    request.setMethod("GET");

    request.setRequestURI(requestUri);

    expectedHandlerMethod = new HandlerMethod(loginController, "logout");
    ModelAndView mav = handlerAdapter.handle(request, response, expectedHandlerMethod); //this.getHandler(request);

    assertViewName(mav, expectedMessage);
}

@Test
public void authenticateTest() throws Exception {
    //final String expectedMessage = "redirect:search/";
    final String requestUri = "/";
    final HandlerMethod expectedHandlerMethod;
    final Map mav;

    final MockHttpServletRequest request;
    final MockHttpServletResponse response;

    loginForm.setUserName("abell");
    loginForm.setPassWord("PassW0rd");

    request = new MockHttpServletRequest();
    response = new MockHttpServletResponse();
    request.setMethod("GET");
    request.setRequestURI(requestUri);
    mav = new HashMap();

      //authenticate(@ModelAttribute("loginForm") LoginForm loginForm, Map model, HttpServletRequest request)
    //expectedHandlerMethod = new HandlerMethod(loginController, "authenticate");
    //ModelAndView mav = handlerAdapter.handle(request, response, expectedHandlerMethod); //this.getHandler(request);
    String expectedMessage = loginController.authenticate(loginForm, mav, request);

    assertTrue(expectedMessage.equalsIgnoreCase("redirect:search/"));
}

private Object getHandler(MockHttpServletRequest request) throws Exception {
    HandlerExecutionChain chain = null;

    Map<String, HandlerMapping> map = applicationContext.getBeansOfType(HandlerMapping.class);
    Iterator<HandlerMapping> itt = map.values().iterator();

    while (itt.hasNext()) {
        HandlerMapping mapping = itt.next();
        chain = mapping.getHandler(request);
        if (chain != null) {
            break;
        }
    }

    if (chain == null) {
        throw new InvalidParameterException("Unable to find handler for request URI: " + request.getRequestURI());
    }

    return chain.getHandler();
   }
} 
```

**登录控制器.java**

```
@Controller
@SessionAttributes
@RequestMapping("/")
public class LoginController {

    private static final Logger logger = LoggerFactory.getLogger(LoginController.class);

    @Autowired
    private AuthenticationService authenticationService;

    @Autowired
    private WloanInfoDao wloanInfoDao;

    @Autowired
    private UserProfile userProfile;

    @RequestMapping(value = "/", method = RequestMethod.GET)
    public String login() {

            return "login";
    }

    @RequestMapping(value = "/logout", method = RequestMethod.GET)
    public String logout() {
            logger.info("Logout");
            return "login";

    }

    @RequestMapping(value="/authenticate", method = RequestMethod.POST)
    public String authenticate(@ModelAttribute("loginForm") LoginForm loginForm, Map    model, HttpServletRequest request) throws AuthenticationException {
            try {
                    boolean authenticated = authenticationService.authenticate(loginForm.getUserName(), loginForm.getPassWord());

                    if (authenticated) {
                            userProfile.setUsername(loginForm.getUserName());
                            userProfile.setAuthenticated(true);
                            return "redirect:search/";
                    }

                    model.put("loginForm", loginForm);
                    request.setAttribute("errorMessage","Invalid username or password.");
            } catch (AuthenticationException e) {
                    logger.error("Error occurring during login: " + e.getMessage(), e);
                    throw new AuthenticationException(e);
            }
            return "login";
            }

             } 
```

**AuthenticationService.java**

```
 @Service("authenticationService")
 public class AuthenticationService {

private static final Logger logger =    LoggerFactory.getLogger(AuthenticationService.class);
private static final String APPNAME = "ULDD";

public boolean authenticate(String username, String password) throws AuthenticationException {
    try {
        final ServiceConnectionInfo sci = new ServiceConnectionInfo();

        PropertyManager props = new DbPropertyManager(APPNAME);

        logger.info("Calling service authentication webservice: " + props.getString("auth.url"));
        logger.info("Authentication user " + username);

        sci.setUrl(props.getString("auth.url"));
        sci.setUsername(props.getString("auth.username"));
        sci.setPassword(props.getString("auth.password"));

        final IServiceClient serviceClient = new Axis1ServiceClient(sci);
        final AuthenticationServiceClient asc = new AuthenticationServiceClient(serviceClient, "AuthenticationServiceClientTest");

        final AuthServiceResponse ret;

        ret = asc.authenticate(username, password, AuthServiceRequest.Domain.INTERNAL, Arrays.asList(new String[] { APPNAME }));
        ret.next();

        return ret.isAuthenticated();

    } catch (ServiceClientException e) {
        throw new AuthenticationException("Error calling authentication service", e);
    } catch (Exception e) {
        throw new AuthenticationException("Error authenticating username: " + username, e);
    }
   }
  } 
```

**servlet-context.xml**

```
 <?xml version="1.0" encoding="UTF-8"?>
 <beans xmlns="http://www.springframework.org/schema/beans"
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xmlns:p="http://www.springframework.org/schema/p"
   xmlns:context="http://www.springframework.org/schema/context"
   xmlns:mvc="http://www.springframework.org/schema/mvc"
   xmlns:aop="http://www.springframework.org/schema/aop"
   xmlns:tx="http://www.springframework.org/schema/tx"
   xsi:schemaLocation="
   http://www.springframework.org/schema/beans
   http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
   http://www.springframework.org/schema/context
   http://www.springframework.org/schema/context/spring-context-3.0.xsd
   http://www.springframework.org/schema/mvc
   http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd
   http://www.springframework.org/schema/aop
   http://www.springframework.org/schema/aop/spring-aop-3.0.xsd
   http://www.springframework.org/schema/tx
   http://www.springframework.org/schema/tx/spring-tx-3.0.xsd">

    <!-- DispatcherServlet Context: defines this servlet's request-processing infrastructure -->

    <!-- Enables the Spring MVC @Controller programming model -->
    <mvc:annotation-driven/>

    <aop:aspectj-autoproxy proxy-target-class="true"/>

    <import resource="hibernate-context.xml"/>

    <!-- Handles HTTP GET requests for /resources/** by efficiently serving up static resources in the ${webappRoot}/resources directory -->
    <mvc:resources mapping="/media/**" location="/media/"/>

    <!-- Resolves views selected for rendering by @Controllers to .jsp resources in the /WEB-INF/views directory -->
    <bean class="org.springframework.web.servlet.view.InternalResourceViewResolver">
            <property name="prefix" value="/WEB-INF/views/"/>
            <property name="suffix" value=".jsp"/>
    </bean>
    <!-- Spring is retarded, -->
    <bean class="org.springframework.beans.factory.config.CustomScopeConfigurer">
            <property name="scopes">
                    <map>
                            <entry key="session">
                                    <bean class="org.springframework.context.support.SimpleThreadScope"/>
                            </entry>
                    </map>
            </property>
    </bean>

    <bean id="multipartResolver"
          class="org.springframework.web.multipart.commons.CommonsMultipartResolver">

            <!-- one of the properties available; the maximum file size in bytes -->
            <property name="maxUploadSize" value="100000"/>
    </bean>

    <context:component-scan base-package="com.everbank.uldd" scoped-proxy="targetClass"/> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T19:24:47.143

您可能有另一个文件，其中包含您的服务 bean 的 bean 定义 - AuthenticationService 等，通过 web.xml 文件声明：

```
<context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>service..</param-value>
</context-param> 
```

如果是这样，您还需要在测试中包含此配置。

另外，对于 Spring mvc 测试，我强烈建议使用[spring-test-mvc](https://github.com/SpringSource/spring-test-mvc)。

# c# - 在 asp 和 c#/javascript 中创建帮助按钮

> ID：12902249
> 
> 赞同：0
> 
> 时间：2012-10-15T19:01:49.693
> 
> 标签：c#, javascript, asp.net, web-applications

我想在我的应用程序中加入一个帮助按钮。我看到此帮助按钮的工作方式类似于在 Windows 应用程序中发现的内容，例如，用户将单击帮助按钮，然后单击他们想要帮助的组件。

我正在考虑在单击帮助按钮后设置一个全局侦听器，以便下一次触发的 onClick 将是用户需要帮助的组件。我还没有考虑这样做，所以任何建议都会很棒！

另外，我想听听您的意见，以哪种方式解决此问题。

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-15T19:19:34.403

假设包含 jQuery，我正在给出答案，那么您也可以使用纯 JavaScript。

声明一个全局变量 -`var helpRequested = false;`
假设您的网页上提供的帮助很少有元素，假设您将 css 类`<div class="help someothercssclass"> ... </div>`应用于所有这些元素，
现在订阅所有这些需要帮助的元素的点击事件

```
$('.help').click(function(event) {
  event.preventDefault();
  if(helpRequested === true) {
    var id = $(this).attr('id');
    //based on id do your stuff... like provide help through popup window

    helpRequested = false; //finally reset
  }    
}); 
```

`<button id="helpbutton">Help</button>` 现在订阅这样 的帮助按钮的点击事件

```
$('#helpbutton').click(function() { 
     helpRequested = !helpRequested ; //toggle the value
}); 
```

我想这会做的工作......或者什么开始

# java - Java - 按键时更改图像

> ID：12902250
> 
> 赞同：0
> 
> 时间：2012-10-15T19:01:56.873
> 
> 标签：java, image, if-statement, keylistener

Java新手在这里！

我正在开发一个小游戏，它只是简单地在屏幕上移动，并且会攻击我正在创建的小 AI 矩形。

我有两个 GIF 文件 pikachu.gif（是的，它是一个口袋妖怪游戏）和 pikready.gif。

我已经实现了 KeyListener 和所有东西，并且可以让 Pikachu.gif 用箭头键在框架中移动。

我想要的是，当我按下箭头键时将图像更改为 pikready.gif，我在网上环顾四周，似乎找不到答案。

代码如下，任何注释掉的东西都是我尝试过的不同的东西。

正如我所说，我是一个 Java 新手，所以对我放轻松！

```
package game;

import java.awt.Color;
import java.awt.Graphics;
import java.awt.Image;
import java.awt.event.KeyAdapter;
import java.awt.event.KeyEvent;
import java.awt.event.KeyListener;

import javax.swing.ImageIcon;
import javax.swing.JFrame;

public class PikachuAttack extends JFrame implements Runnable{

    Graphics dbg;
    Image dbImage;
    Image Pik1;
    static ImageIcon active;

    int x, y, xDirection, yDirection;

    public void run(){
        try{
            while(true){
                move();
                Thread.sleep(10);
            }
        }catch(Exception e){
            System.out.println("Uh-oh, something went wrong!.");
        }
    }

    private void move() {
        x += xDirection;
        y += yDirection;

    }

     public void setXDirection(int xdir) {
            xDirection = xdir;
        }

        public void setYDirection(int ydir) {
            yDirection = ydir;
        }

    // KEY COMMANDS //
      public class AL extends KeyAdapter {
        @Override
        public void keyPressed(KeyEvent e) {
            int keyCode = e.getKeyCode();

                if(keyCode == e.VK_LEFT) {
                    setXDirection(-1);
                }
                if(keyCode == e.VK_RIGHT) {
                    setXDirection(+1);
                }
                if(keyCode == e.VK_UP) {    
                    setYDirection(-1);
                }
                if(keyCode == e.VK_DOWN) {
                    setYDirection(+1);
                }   
                /*(if(keyCode == e.VK_LEFT | keyCode == e.VK_RIGHT | keyCode == e.VK_UP | keyCode == e.VK_DOWN){
                    active = new ImageIcon("C:\\Users\\Neil\\workspace\\MyOwnTutorials\\bin\\game\\pikready.gif");
                }else{
                    active = new ImageIcon("C:\\Users\\Neil\\workspace\\MyOwnTutorials\\bin\\game\\pikachu.gif");
                } */

        }

        @Override
        public void keyReleased(KeyEvent e) {
            int keyCode = e.getKeyCode();
                    if(keyCode== e.VK_LEFT){
                       setXDirection(0);                    
                    }
                    if(keyCode== e.VK_RIGHT){
                       setXDirection(0);                    
                    }
                    if(keyCode== e.VK_UP){
                        setYDirection(0);
                    }
                    if(keyCode== e.VK_DOWN){
                        setYDirection(0);                   
                    }

        }

        @Override
        public void keyTyped(KeyEvent e) {

        }

    }

    // CONSTRUCTOR //
    public PikachuAttack(){

        //Image Import
        ImageIcon still = new ImageIcon("C:\\Java\\GIFS\\Pikachu.gif");
        Pik1 = still.getImage();
        //ImageIcon ready = new ImageIcon("C:\\Users\\Neil\\workspace\\MyOwnTutorials\\bin\\game\\pikready.gif");
        //Pik2 = ready.getImage(); */
        // Pik1 = active.getImage();

        //JFrame properties
        addKeyListener(new AL());
        setTitle("Pikachu Attack");
        setSize(500, 500);
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        setResizable(false);
        setVisible(true);

        x = 15;
        y = 15;
    }

    public void paint(Graphics g){
        dbImage = createImage(getWidth(), getHeight());
        dbg = dbImage.getGraphics();
        paintComponent(dbg);
        g.drawImage(dbImage, 0, 0, this);   

    }

    public void paintComponent(Graphics g){
        g.setColor(Color.red);
        g.fillRect(200, 190, 12, 20);
        g.drawImage(Pik1, x, y, this);
        g.setColor(Color.red);

        repaint();
    }

    public static void main(String[] args) {
        PikachuAttack game = new PikachuAttack();
        Thread t1 = new Thread(game);
        t1.start();
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T19:19:17.137

为什么不创建一个对当前的新引用`Image`，比如说`currentImage`在 DOWN 键上做：

```
if (keyCode == e.VK_DOWN) {
   setYDirection(+1);
   currentImage = Pik2; // the ready image
} 
```

然后在 中`paintComponent`，您可以绘制当前图像：

```
g.drawImage(currentImage, x, y, this); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T19:05:26.643

重绘后打电话

```
revalidate(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-10-10T12:28:17.340

您应该只创建一个具有空值或默认图像的图像，然后创建第二个图像，当您按下键时它将代替第一个图像。在键侦听器中，您应该将图像的值设置为下的第二个图像您要按的键的键码。

这是一个例子。一个移动的字符，在按下键时会改变图像

```
public class WorldOfWarriorsDefault extends JPanel implements KeyListener, ActionListener //main game interface
{
	Timer t = new Timer(5, this); 	
	int x = 0, y = 0, velx = 0, vely = 0; //declares the default values co-ordinates of the moving object
    Rectangle r = new Rectangle(100, 100, 40, 40);
    Toolkit toolkit = Toolkit.getDefaultToolkit();
    Image image1 = toolkit.getImage("D:\\My Stuff\\frame_2_delay-0.05s.gif");
    Image image2 = toolkit.getImage("D:\\My Stuff\\runtest2.gif");
    Image image3 = toolkit.getImage("D:\\My Stuff\\ezgif-3-4570fcd5e5.gif");
    Image image4 = toolkit.getImage("D:\\My Stuff\\Leftr.gif");
    Image image = image1;
    public WorldOfWarriorsDefault() //makes a constructor
    {
    	t.start(); //starts the timer
    	addKeyListener(this);
    	 //adds a keyboard listener
    	setFocusable(true); 
    	setFocusTraversalKeysEnabled(false); 
    }
    public void actionPerformed(ActionEvent e) 
    {
        x = x + velx;
        y = y + vely;
        repaint();
    }
    public void up()
    {
    	vely = -2;
    	velx = 0;
    }
    public void down()
    {
    	vely = 2;
    	velx = 0;
    }
    public void left()
    {
    	velx = -2;
    	vely = 0;
    }
    public void right() 
    {	
    	velx = 2;
    	vely = 0;
    }
    public void keyPressed(KeyEvent e) 
	{

		int code = e.getKeyCode(); 

        if (code == KeyEvent.VK_UP || code == KeyEvent.VK_W) 
        {
        	up();
        }
        if (code == KeyEvent.VK_DOWN || code == KeyEvent.VK_S) 
        {
        	down();
        }
        if (code == KeyEvent.VK_LEFT || code == KeyEvent.VK_A) 
        {
        	left();
        	image = image3;
        }
        if (code == KeyEvent.VK_RIGHT || code == KeyEvent.VK_D) 
        {
        	right();
        	image = image2;
        }
	}
    public void keyTyped(KeyEvent e) {}
	public void keyReleased(KeyEvent e) 
	{
		int coder = e.getKeyCode();

		if (coder == KeyEvent.VK_LEFT)
		{
			image = image4;
		}
		if (coder == KeyEvent.VK_RIGHT)
		{
			image = image1;	
		}
		velx = 0;
		vely = 0;
		x = r.getBounds().x;
		y = r.getBounds().y;
		repaint();
	}
	public void paintComponent(Graphics g) //starts a painter
    {
    	super.paintComponent(g); //paints the component
    	r.setBounds(x, y, 40, 40);
    	g.drawImage(image, x, y, this); 
    }
    public static void main(String[] args) 
	{
          JFrame f = new JFrame();
          WorldOfWarriorsDefault w = new WorldOfWarriorsDefault();
          f.add(w);
          f.setVisible(true);
          f.setSize(1900, 1000);
          f.setLocationRelativeTo(null);
          f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
	}
}
```

# json - MooTools：JSON.encode 和 Request.JSON 显示没有 POST 数据

> ID：12902251
> 
> 赞同：0
> 
> 时间：2012-10-15T19:01:57.213
> 
> 标签：json, post, mootools

我的客户端中有以下 Request.JSON（注意使用 MooTools 自己的 JSON 解析器转换为 JSON 字符串）：

```
var data = {action: 'delete', data: { id: item} };
data = JSON.encode(data);

var aRequest = new Request.JSON({
                onSuccess : (function(json) {
                    ...
                }).bind(this),
                onFailure : (function(e) {
                    ...
                }).bind(this),
                onError : (function(text, error) {
                    ...
                }).bind(this),
                url : "../sd_delete.php",
                method : "post",
                data: data,
                urlEncoded: false
            });
    aRequest.setHeader('Content-Type', 'application/json; charset=utf-8');
    aRequest.send(); 
```

现在，在服务器端，$_REQUEST 和 $_POST 都是空数组。如何访问使用 Request.JSON 发送的字符串？还是我的客户端方法有缺陷？

谢谢

**编辑：**刚刚发现，即使我将数据作为对象发送（没有 JSON.encode），服务器端也没有 POST 数据。GET 工作。可能是服务器端的问题？！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T20:17:25.430

`data`选项应该是一个对象。尝试：

```
 new Request.JSON({
            onSuccess : (function(json) {
                ...
            }).bind(this),
            onFailure : (function(e) {
                ...
            }).bind(this),
            onError : (function(text, error) {
                ...
            }).bind(this),
            url : "../sd_delete.php",
            method : "post",
            data: { anyname: data },
            urlEncoded: false
        }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-01T01:33:04.827

以下应该工作。

```
var data = {action: 'delete', data: { id: item} };

var aRequest = new Request.JSON({
    url : "../sd_delete.php",
    onComplete: function(pResponse) {
        console.log(pResponse);
    }.bind(this)
}).post(data); 
```

然后，您将在 php 中收到如下发布数据：

```
echo $_POST['action']; 
```

# ruby-on-rails-3 - Rails 3 + Heroku：找出 dyno 的内存使用情况

> ID：12902253
> 
> 赞同：13
> 
> 时间：2012-10-15T19:02:13.130
> 
> 标签：ruby-on-rails-3, heroku

有没有办法找出heroku web dyno正在使用多少内存？假设我想编写一个定期运行并检查每个测功机的内存使用情况的 rake 任务。我怎么能这样做？谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-01-30T17:38:25.077

现在还有一种本地 Heroku 方法可以做到这一点。Heroku 推出了一个实验室功能[日志运行时指标](https://devcenter.heroku.com/articles/log-runtime-metrics)，它将 CPU 负载和内存使用信息注入日志流。这些日志带有源 ID（例如“web.1”）和测功机唯一 ID，以便您可以区分测功机。它看起来像这样：

```
source=web.1 dyno=heroku.2808254.d97d0ea7-cf3d-411b-b453-d2943a50b456 sample#load_avg_1m=2.46 sample#load_avg_5m=1.06 sample#load_avg_15m=0.99
source=web.1 dyno=heroku.2808254.d97d0ea7-cf3d-411b-b453-d2943a50b456 sample#memory_total=21.00MB sample#memory_rss=21.22MB sample#memory_cache=0.00MB sample#memory_swap=0.00MB sample#memory_pgpgin=348836pages sample#memory_pgpgout=343403pages 
```

要打开它，只需运行：

```
heroku labs:enable log-runtime-metrics
heroku restart 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-07-18T07:12:49.047

我从接受的答案中接受了建议，并实现了一个 /proc 文件系统解析器，它具有聚合和基于阈值的差异。我发现它在调试 Heroku 上的一些 Ruby 2.0 内存问题时非常有用。获取[代码](https://gist.github.com/ssimeonov/6027269)，为方便起见，也包含在此处。

```
# Memory snapshot analyzer which parses the /proc file system on *nix
#
# Example (run in Heroku console):
#
#    ms = MemorySnapshot.new
#    1.upto(10000).map { |i| Array.new(i) }; nil
#    ms.snapshot!; nil
#    ms.diff 10
#    => {"lib/ld-2.11.1.so"=>156, "heap"=>2068, "all"=>2224}
#
class MemorySnapshot

  attr_reader :previous
  attr_reader :current

  def initialize
    snapshot!
    @previous = @current
  end

  # Generates a Hash of memory elements mapped to sizes of the elements in Kb
  def snapshot!
    @previous = @current
    @current = reduce(names_with_sizes)
  end

  # Calculates the difference between the previous and the current snapshot
  # Threshold is a minimum delta in kilobytes required to include an entry
  def diff(threshold = 0)
    self.class.diff_between previous, current, threshold
  end

  # Calculates the difference between two memory snapshots
  # Threshold is a minimum delta in kilobytes required to include an entry
  def self.diff_between(before, after, threshold)
    names = (before.keys + after.keys).uniq
    names.reduce({}) do |memo, name|
      delta = after.fetch(name) { 0 } - before.fetch(name) { 0 }
      memo[name] = delta if delta.abs >= threshold
      memo
    end
  end

  private

  def reduce(matches)
    total = 0
    current_name = nil
    matches.reduce(Hash.new { 0 }) do |memo, match|
      current_name = match[:name] || current_name
      size = match[:size].to_i
      total += size
      memo[current_name] += size
      memo
    end.tap { |snapshot| snapshot['all'] = total }
  end

  def names_with_sizes
    smap_entries.map do |line|
      /((^(\/|\[)(?<name>[^ \]]+)\]?\s+)|(^))(?<size>\d+)\s/.match(line)
    end
  end

  def smap_entries
    smaps.
        gsub(/^(([^Sa-f0-9])|(S[^i]))[^\n]+\n/m, '').
        gsub(/\nSize:/m, '').
        gsub(/[0-9a-f]+-[0-9a-f]+.{6}[0-9a-f]+ [0-9a-f]+:[0-9a-f]+ [0-9a-f]+\s+/i, '').
        split("\n")
  end

  def smaps
    File.read("/proc/#{Process.pid}/smaps")
  end
end 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-08T04:40:32.883

由于 Heroku 在带有 Linux 的 Amazon 实例上运行，因此您可以使用`proc`文件系统来获取运行时系统数据。该`/proc/<pid>/smaps`文件包含有关正在运行的进程及其加载的所有库的内存信息。对于常驻进程大小，请执行以下操作：

```
f = File.open("/proc/#{Process.pid}/smaps")
f.gets # Throw away first line
l = f.gets # Contains a string like "Size:               2148 kB\n"
l =~ /(\d+) kB/  # match the size in kB 
f.close
$1.to_i  # returns matched size as integer 
```

更新：proc 文件系统有一个更好的来源，`/proc/<pid>/status`. `VmRSS:`总驻留内存部分和`VmHWM:`使用的最高驻留内存（高水位线）都有一个条目。有关这些和其他字段的更多详细信息，请参阅[proc 文件系统的 Linux 内核文档](https://www.kernel.org/doc/Documentation/filesystems/proc.txt)。

# mysql - SQLite按十进制数字排序？

> ID：12902254
> 
> 赞同：0
> 
> 时间：2012-10-15T19:02:13.323
> 
> 标签：mysql, sql, sqlite, select, join

我有一个 SQLite DB，我会在其中进行表连接和按字段排序`orderID`。我需要在两个现有的（6 和 7）之间插入一个新的 orderID，MYSQL 人员建议只使用 6.5 作为这个项目的 orderID。但是，当我使用以下 SQL 时，甚至没有选择该行：

```
select i.caption, i_s.orderID, i_s.sectionID, i_s.name, r.fcid, r.pdf, r.title 
from recipes r 
inner join instructions i on r.fcid = i.recipeID 
inner join inst_sections i_s on i.timeID = i_s.sectionID 
where fcid IN (114806) 
order by i_s.orderID ASC 
```

我按预期顺序获得了所有其他 orderID，但 6.5 不在选择集中。我在这里想念什么？

# objective-c - Init 方法的 PartialMock

> ID：12902256
> 
> 赞同：0
> 
> 时间：2012-10-15T19:02:17.130
> 
> 标签：objective-c, unit-testing, ocmock

我已经尝试为部分模拟调出 init 方法，并且想知道这是否可能。

我没有运气：

```
SomeClass *foo = [SomeClass alloc];
mock = [OCMockObject partialMockForObject:foo];
[[[mock stub] andCall:@selector(mockInit) onObject:self] init]; 
```

...

```
[foo init]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T07:48:51.570

当你调用 init 方法时，你应该在你的模拟实例上使用它。如果你这样做，我认为它会起作用：

```
SomeClass *foo = [SomeClass alloc];
mock = [OCMockObject partialMockForObject:foo];
[[[mock stub] andCall:@selector(mockInit) onObject:self] init]; 
```

...

```
[mock init]; 
```

问候，昆汀

# php - 从一开始就获得 facebook 扩展权限

> ID：12902263
> 
> 赞同：1
> 
> 时间：2012-10-15T19:02:23.967
> 
> 标签：php, facebook, facebook-graph-api

我有以下代码在不存在 facebook 会话时有效

```
session_start();

# We require the library
require("/var/www/facebook.php");

# Creating the facebook object
$facebook = new Facebook(array(
    'appId'  => 'app_id',
    'secret' => 'secret',
    'cookie' => true
));

# check if active session exists
$session = $facebook->getSession();

if(!empty($session)) {

    # Do some stuff here

} else {

    # There's no active session, go get one
    $login_url = $facebook->getLoginUrl();
    header("Location: ".$login_url);

} 
```

登录 facebook 后，它会进入一个 facebook 屏幕，上面说我的应用程序将收到`Your basic info`. 是否也可以从一开始就获得电子邮件地址？我知道成功登录后如何获得更多权限。我所追求的是从一开始就获得扩展权限，最重要的是电子邮件。

我需要做什么才能`else`获得电子邮件以及基本信息？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T19:05:51.427

您需要告诉 Facebook 您需要的范围。

```
$login_url = $facebook->getLoginUrl(array('scope' => 'email')); 
```

# java - 执行快速 GPS 查找的数据结构？

> ID：12902264
> 
> 赞同：4
> 
> 时间：2012-10-15T19:02:28.757
> 
> 标签：java, python, data-structures, gps, gis

我有一个包含城市名称和 GPS 坐标的文本文件（UTF-8，~50K 行）。示例行：

```
San Pedro    locality   -3367   -5968   Argentina       Buenos Aires    San Pedro
Talagante    locality   -3366   -7093   Chile   Metropolitana   Talagante
Peñaflor     locality   -3362   -7092   Chile   Metropolitana   Talagante 
```

第三和第四列是最后一列城市的 GPS 坐标。

给定 GPS 坐标，我需要找到壁橱城市。我需要这样做数亿次。有哪些工具可以帮助我完成这项任务？Java/Python 解决方案将是理想的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-15T19:06:26.120

您正在寻找的是[KD 树](http://en.wikipedia.org/wiki/K-d_tree)。我在这里找到了一个[python 实现](http://code.google.com/p/python-kdtree/)的链接，但我不是 python 开发人员，从未尝试过。KD 树将支持在平面中找到最近点的平方根复杂度，这可能是您可以获得的最佳复杂度。您可以承受每秒大约一百万次查询。

**编辑：**实际上你的问题让我做了更彻底的研究。您可能会发现[此页面](http://en.wikipedia.org/wiki/Nearest_neighbor_search)上描述的可能方法很有用。您感兴趣的是为最近邻居的许多查询提供最佳解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-15T19:06:36.513

我会将这些记录存储在 SQLite 数据库中。有一个名为[SpatiaLite](http://en.wikipedia.org/wiki/SpatiaLite)的项目，它在 SQLite 之上添加了空间查询和类型。这使您可以向数据库询问诸如“给出 x 20 米内的所有项目”之类的问题。

如果您不想使用数据库，可以使用[quadtree](http://en.wikipedia.org/wiki/Quadtree)。Python中有几种实现。四叉树将一个矩形空间分成 4 个部分，然后将每个部分再细分为 4 个部分。搜索效率很高。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-15T19:22:01.737

对于像您要问的几何查询（最近点），KD 树是出色的数据结构。除了实施起来不是很困难。我有一个 Java 实现。不知道它对你有多有效。这是我的任务。`Point2D`和其他实用程序类在[这里](http://algs4.cs.princeton.edu/code/index.php)实现。你可以在那里查看他们的源代码。`RectHV`是需要的另一个实用程序类。它是我写的。

```
public class RectHV {
    private final double xmin, ymin;   // minimum x- and y-coordinates
    private final double xmax, ymax;   // maximum x- and y-coordinates

    // construct the axis-aligned rectangle [xmin, xmax] x [ymin, ymax]
    public RectHV(double xmin, double ymin, double xmax, double ymax) {
        if (xmax < xmin || ymax < ymin) {
            throw new IllegalArgumentException("Invalid rectangle");
        }
        this.xmin = xmin;
        this.ymin = ymin;
        this.xmax = xmax;
        this.ymax = ymax;
    }

    // accessor methods for 4 coordinates
    public double xmin() { return xmin; }
    public double ymin() { return ymin; }
    public double xmax() { return xmax; }
    public double ymax() { return ymax; }

    // width and height of rectangle
    public double width()  { return xmax - xmin; }
    public double height() { return ymax - ymin; }

    // does this axis-aligned rectangle intersect that one?
    public boolean intersects(RectHV that) {
        return this.xmax >= that.xmin && this.ymax >= that.ymin
            && that.xmax >= this.xmin && that.ymax >= this.ymin;
    }

    // draw this axis-aligned rectangle
    public void draw() {
        StdDraw.line(xmin, ymin, xmax, ymin);
        StdDraw.line(xmax, ymin, xmax, ymax);
        StdDraw.line(xmax, ymax, xmin, ymax);
        StdDraw.line(xmin, ymax, xmin, ymin);
    }

    // distance from p to closest point on this axis-aligned rectangle
    public double distanceTo(Point2D p) {
        return Math.sqrt(this.distanceSquaredTo(p));
    }

    // distance squared from p to closest point on this axis-aligned rectangle
    public double distanceSquaredTo(Point2D p) {
        double dx = 0.0, dy = 0.0;
        if      (p.x() < xmin) dx = p.x() - xmin;
        else if (p.x() > xmax) dx = p.x() - xmax;
        if      (p.y() < ymin) dy = p.y() - ymin;
        else if (p.y() > ymax) dy = p.y() - ymax;
        return dx*dx + dy*dy;
    }

    // does this axis-aligned rectangle contain p?
    public boolean contains(Point2D p) {
        return (p.x() >= xmin) && (p.x() <= xmax)
            && (p.y() >= ymin) && (p.y() <= ymax);
    }

    // are the two axis-aligned rectangles equal?
    public boolean equals(Object y) {
        if (y == this) return true;
        if (y == null) return false;
        if (y.getClass() != this.getClass()) return false;
        RectHV that = (RectHV) y;
        if (this.xmin != that.xmin) return false;
        if (this.ymin != that.ymin) return false;
        if (this.xmax != that.xmax) return false;
        if (this.ymax != that.ymax) return false;
        return true;
    }

    // return a string representation of this axis-aligned rectangle
    public String toString() {
        return "[" + xmin + ", " + xmax + "] x [" + ymin + ", " + ymax + "]";
    }

} 
```

这是KD树：

```
public class KdTree {

    private static class Node {
        private Point2D p;      // the point
        private RectHV rect;    // the axis-aligned rectangle corresponding to this node
        private Node lb;        // the left/bottom subtree
        private Node rt;        // the right/top subtree

        Node() {
            p = null;
            rect = null;
            lb = null;
            rt = null;
        }
    }

    private Node tree;
    private Point2D nearestPoint, infinitePoint;
    private int sz;
    private double nearestDist;

    // construct an empty set of points
    public KdTree() {
        tree = new Node();
        sz = 0;
        infinitePoint = new Point2D(Double.POSITIVE_INFINITY, Double.POSITIVE_INFINITY);
    }

    // is the set empty?
    public boolean isEmpty() {
        return (sz == 0);
    }

    // number of points in the set
    public int size() {
        return sz;
    }

    ////////////////////////////////////////////////
    // private function for inserting any element //
    ////////////////////////////////////////////////
    private void privateInsert( Node nd, Point2D p, int lv, double xmin, double ymin, double xmax, double ymax) {
        if(nd.p == null) {
          nd.p = p;
          nd.rect = new RectHV(xmin, ymin, xmax, ymax);
          nd.lb = new Node();
          nd.rt = new Node();
          sz = sz + 1;
        }
        else if( lv % 2 == 0 ) {
            double X = nd.p.x();
            double x = p.x();
            if( x <= X ) {
                xmax = X;
                privateInsert(nd.lb, p, lv+1, xmin, ymin, xmax, ymax);
            }
            else {
                xmin = X;
                privateInsert(nd.rt, p, lv+1, xmin, ymin, xmax, ymax);
            }
        }
        else {
            double Y = nd.p.y();
            double y = p.y();
            if( y <= Y ) {
                ymax = Y;
                privateInsert(nd.lb, p, lv+1, xmin, ymin, xmax, ymax);
            }
            else {
                ymin = Y;
                privateInsert(nd.rt, p, lv+1, xmin, ymin, xmax, ymax);
            }
        }
    }

    ////////////////////////////////////////////////
    // private function for searching any element //
    ////////////////////////////////////////////////
    private Node privateSearch( Node nd, Point2D p, int lv ) {
        if( nd.p == null ) return nd;
        else if( p.equals( nd.p ) == true ) return nd;
        if(lv % 2 == 0) {
            double X = nd.p.x();
            double x = p.x();
            if( x <= X ) {
                return privateSearch( nd.lb, p, lv+1 );
            }
            else {
                return privateSearch( nd.rt, p, lv+1);
            }
        }
        else {
            double Y = nd.p.y();
            double y = p.y();
            if( y <= Y ) {
                return privateSearch(nd.lb, p, lv+1);
            }
            else {
                return privateSearch(nd.rt, p, lv+1);
            }
        }
    }

    /////////////////////////////////////////////////
    // private function for drawing all the points //
    /////////////////////////////////////////////////
    private void privateDraw (Node nd) {
        if(nd.p == null) return;
        StdDraw.setPenColor(StdDraw.BLACK);
        StdDraw.setPenRadius(.01);
        double x = nd.p.x();
        double y = nd.p.y();
        StdDraw.point( x, y );
        privateDraw( nd.lb );
        privateDraw( nd.rt );
    }

    //////////////////////////////////////////
    // private function for range searching //
    //////////////////////////////////////////
    private void privateRange(Node nd, RectHV rect, Queue<Point2D> que){
        if(nd.p == null) return;
        if( rect.contains( nd.p ) == true ) que.enqueue( nd.p );
        if( nd.rect.intersects(rect) == true ) {
            privateRange(nd.lb, rect, que);
            privateRange(nd.rt, rect, que);
            return;
        }
        else return;
    }

    //////////////////////////////////////////////////////
    // private function for searching nearest neighbour //
    //////////////////////////////////////////////////////
    private void privateNearest( Node nd, Point2D p ) {
        if(nd.p == null) return;
        double d = p.distanceSquaredTo(nd.p);
        if(d < nearestDist) {
            nearestDist = d;
            nearestPoint = nd.p;
        }
        if(nd.lb.p != null && ( nd.lb.rect.distanceSquaredTo(p) < nearestDist) ) privateNearest(nd.lb, p);
        if(nd.rt.p != null && ( nd.rt.rect.distanceSquaredTo(p) < nearestDist) ) privateNearest(nd.rt, p);
    }

    // add the point p to the set (if it is not already in the set)
    public void insert(Point2D p) {
        if( contains( p ) == true ) {
            return;
        }
        else {
            privateInsert(tree, p, 0, 0.00, 0.00, 1.00, 1.00);
        }
    }

    // does the set contain the point p?
    public boolean contains(Point2D p) {
        Node nd = privateSearch(tree, p, 0);
        if(nd.p == null) return false;
        else return true;
    }

    // draw all of the points to standard draw
    public void draw() {
        privateDraw(tree);
    }

    // all points in the set that are inside the rectangle
    public Iterable<Point2D> range( RectHV rect ) {
        Queue<Point2D> que = new Queue<Point2D>();
        privateRange(tree, rect, que);
        return que;
    }

    // a nearest neighbor in the set to p; null if set is empty
    public Point2D nearest(Point2D p) {
        nearestPoint = infinitePoint;
        nearestDist = Double.POSITIVE_INFINITY;
        privateNearest(tree, p);
        return nearestPoint;
        //return p;
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-15T19:27:06.177

[GeoHash](http://en.wikipedia.org/wiki/Geohash)是您的另一种选择，它非常易于实现，效率也一样快。

# android - 有什么办法可以让按钮上的图像自动调整大小以适应屏幕？

> ID：12902266
> 
> 赞同：7
> 
> 时间：2012-10-15T19:02:31.880
> 
> 标签：android, android-layout, button, autoresize

所以我有四个按钮，它们都使用 match_parent 作为高度和宽度。我使用“drawableTop”属性在按钮本身中有图像，我想这样做，所以我不需要为每个分辨率单独的图像。这是我拍的肖像截图。景观会出现一点。

![按钮-纵向](../Images/fb50c017075be53b7fb1e0cef46242c7.png)

所以这看起来不错，但我只有 4 种不同的图像分辨率，在我的手机上试用它们并没有产生积极的结果。有什么办法可以让我只拥有一个更大的图像，比如“可绘制”并让它缩小以适应所有分辨率？如果没有，我该怎么办？我目前涵盖 hdpi、ldpi、mdpi 和 xhdpi，但我想涵盖所有范围。还存在哪些其他密度？

如果我可以实现自动调整大小，我也不必禁止用户使用 Landscape：

![按钮-横向](../Images/889a4166bff0bed1006da3dbcd2b0cf0.png)

另外，这是xml：

```
<LinearLayout
    android:layout_width="fill_parent"
    android:layout_height="match_parent"
    android:layout_weight="1"
    android:baselineAligned="false"
    android:orientation="horizontal" >

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_weight="1"
        android:orientation="vertical"
        tools:ignore="NestedWeights" >

        <Button
            android:id="@+id/bMap"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:drawableTop="@drawable/ic_camera"
            android:text="Button" />
    </LinearLayout>

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_weight="1"
        android:orientation="vertical" >

        <Button
            android:id="@+id/bCamera"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:drawableTop="@drawable/ic_camera"
            android:text="Button" />
    </LinearLayout>
</LinearLayout>

<LinearLayout
    android:layout_width="fill_parent"
    android:layout_height="match_parent"
    android:layout_weight="1"
    android:baselineAligned="false"
    android:orientation="horizontal" >

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_weight="1"
        android:orientation="vertical"
        tools:ignore="NestedWeights" >

        <Button
            android:id="@+id/bGallery"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:drawableTop="@drawable/ic_camera"
            android:text="Button" />
    </LinearLayout>

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_weight="1"
        android:orientation="vertical" >

        <Button
            android:id="@+id/bPlants"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:drawableTop="@drawable/ic_camera"
            android:text="Button" />
    </LinearLayout>
</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-15T19:09:53.687

AFAIK，使用可绘制背景并不容易`Button`，因为可绘制不会随视图缩放。

我相信如果您将`Button`s更改为`ImageButton`s，您可以做到这一点，它提供了更多缩放图像的选项。

ImageButton 类公开了`android:scaleType`属性，您可以使用它`centerInside`来缩小图像以适应 ImageButton 的边界。

此外，`ImageButton`您应该使用`android:src`而不是定义图像`android:drawable`。

我不确定是否有办法在 ImageButton 上设置文本。您可能需要一个更高级的布局，由 LinearLayout 中的 ImageView 和 TextView 组成，然后将该 LinearLayout 视为按钮（添加 onClick 等）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-09T20:33:15.980

是的，您可以拥有一张更大的图像并将其缩小以适应所有分辨率。您可以通过编程方式实现此自动调整大小。看看这个[答案](https://stackoverflow.com/a/32479741/2306907)`DroidUtils.scaleButtonDrawables`。

# windows - Windows 等效于 rm -rf [不想删除父目录]

> ID：12902267
> 
> 赞同：1
> 
> 时间：2012-10-15T19:02:34.123
> 
> 标签：windows, batch-file, mkdir, rmdir

我正在执行与[此处](https://stackoverflow.com/a/97896/1175065b)所述相同的操作，即在我的批处理文件中，我`rmdir E:\docs\music /S /Q`也用于删除所有内容，包括子目录，但它也删除`music`了我不想要的父目录。
我需要`mkdir`每次都跑吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T19:14:12.953

如果您`cd`进入`E:\docs\music`然后执行`rmdir E:\docs\music /S /Q`，所有内容都将被删除，`music`而不是`music`目录本身。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-15T19:11:24.343

单行解决方案用于`for`生成内部目录列表：

```
for /f %i in ('dir /ad /b music') do @rmdir /s /q music\%i 
```

`%`如果将该行放入批处理文件中，则必须转义，如下所示：

```
for /f %%i in ('dir /ad /b music') do @rmdir /s /q music\%%i 
```

# javascript - 带有嵌套 if 的 else 语句

> ID：12902269
> 
> 赞同：0
> 
> 时间：2012-10-15T19:02:40.817
> 
> 标签：javascript, nested-loops

假设当第一个 if 语句和 else 语句中的嵌套 if 都失败时，我是否正确，然后我回到第一个 for 循环并递增`i`1？

所以我可以继续直到 j < totalCols 失败，即使 if 或 else 语句都没有执行？

```
var rowCount = [];
for (var i = 0; i < totalRows; i++) {
   rowCount[i]="";
   spaceCount = 0;

   for (var j = 0; j < totalCols; j++) {
      if (puzzle[i][j] == "#") { // if this fails?
         spaceCount++;
         if (j == totalCols-1) rowCount[i] += spaceCount + "&nbsp;&nbsp;"; 
      } else {
         if (spaceCount > 0) { //and this fails?
            rowCount[i] += spaceCount + "&nbsp;&nbsp;";
            spaceCount = 0;
         } 
      }    
   }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T19:06:36.060

不，如果这些`if`语句中的任何一个失败，您仍然处于递增的内部循环中`j`。为了摆脱内部循环，您需要使用该`break`语句。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T19:08:08.710

不，您首先完成第二个循环的循环，从而增加 j。

```
 for (var j = 0; j < totalCols; j++) { 
```

只有当你完成了那个循环后，你才会回到第一个并增加 i。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T19:04:06.907

如果 `if`语句失败，嵌套`if`将不会执行。它进入`else`块并继续循环，直到满足条件`i < totalRows`。

如果 `if`语句通过并且嵌套`if`失败，则循环仍然继续，直到`i < totalRows`遇到。

如果两个 if 语句都通过，则循环继续条件，直到满足 i < totalRows。

我所说的实质是嵌套循环中的if语句与外循环无关。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-15T19:25:07.070

您可以使用 break 语句来实现此行为。编辑：应该先阅读答案。

# c - 从源代码（GNU 编译器）与构建窗口对话

> ID：12902272
> 
> 赞同：0
> 
> 时间：2012-10-15T19:02:53.270
> 
> 标签：c, gnu

是否可以从源代码向 GNU 构建窗口传递消息？就像是：

foo.c（不是生成文件）

```
#ifdef DEBUG
   Echo "The Debug flag is set"

// more code here 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T19:04:57.937

查看 gcc 中的诊断编译指示：

[http://gcc.gnu.org/onlinedocs/gcc/Diagnostic-Pragmas.html](http://gcc.gnu.org/onlinedocs/gcc/Diagnostic-Pragmas.html)

例如

> GCC 还提供了一种在编译期间打印消息的简单机制。`#pragma message string` 在编译时将字符串打印为编译器消息。该消息仅供参考，既不是编译警告也不是错误。

```
 #pragma message "Compiling " __FILE__ "..." 
```

# javascript - 脚本中的未知语法错误，根据父标题更改 div 的 id

> ID：12902276
> 
> 赞同：0
> 
> 时间：2012-10-15T19:02:57.217
> 
> 标签：javascript, html

我编写了一个脚本，根据父页面的标题更改 li 中的 div 类（意味着在 home.html 的 iframe 内部有 menu.html）。唉，我尝试了很多东西，但它不起作用。我怎样才能找到错误？我应该考虑到字幕不是英语而是希伯来语吗？

menu.html 的代码是：

```
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title> </title>
 <link rel="stylesheet" type="text/css" href="style.css" />
<script type="text/javascript">
    switch (window.parent.document.title) {
        case "העמוד הראשי": document.getElementById("nada1").className="marked"; break;
        case "על הבנאי": document.getElementById("nada2").className = "marked"; break;
        case "בדיחות משעשעות": document.getElementById("nada3").className = "marked"; break;
        case "תוכנות חינמיות": document.getElementById("nada4").className = "marked"; break;
        case "קישורים מעניינים": document.getElementById("nada5").className = "marked";     break;
        default: alert("god damn!"); break;
    }
    </script>
</head>
<body dir="rtl">
<ul class="menu1">
<li><a href="Index.html" target="_parent"><div id="nada1">דף פתיחה</div></a></li>
<li><a href="About.html" target="_parent"><div id="nada2">על עצמי     ותחביבים</div>    </a></li>
<li><a href="Jokes.html" target="_parent"><div id="nada3">בדיחות</div></a>    </li>
<li class="nada4"><a href="freewares.html" target="_parent"><div id="nada4">תוכנות     חינמיות</div></a></li>
<li class="nada5"> <a href="Links.html" target="_parent"><div id="nada5">קישורים     שימושים</div></a></li>
</ul>
    <br /><br /><hr />
<div class="write_mail">אם ברצונך להרשם לעדכוני האתר, אנא הכנס את <br />כתובת המייל שלך     בצירוף שמך באנגלית:
    <form action="sent.php" method="post" >
        <input type="text" name="subscr" /><br />email
        <input type="text" name="perosnal"/><br />שם
        <br />
        <input type="submit" name="submit" onclick="alert('good job and thanks!');"/>    </form></div>

</body>
</html> 
```

索引的代码是：

```
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>העמוד הראשי</title>
<link rel="stylesheet" type="text/css" href="style.css" />
<script type="text/javascript"></script>
</head>
<body dir="rtl">
<iframe src="menu.html" class="navibar" height="430px" width="50px" scrolling="no"     style="border-style:none"></iframe>
<a href="http://example.com"><img src="HomePage/suka1.gif"  height="200px" width="200px"     alt="מעט מידע בסיסי על חג סוכות"/></a>
<hr /><br />
<p class="About">i built it so respect!:)<br /> <a         href="mailto:me@gmail.com">לתלונות, מענות,פניות ושאר ירקות ופירות </a>
</p>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T19:10:57.103

您正在修改页面上存在的元素 - 将您的脚本块移动到`window.onload`处理程序中，它应该可以正常工作：

```
window.onload = function () {
    switch (window.parent.document.title) {
        // snip ...
    }
}; 
```

# sql-server - ORDER BY 突然与 TSQL 中的 VARCHAR 连接发生冲突

> ID：12902281
> 
> 赞同：1
> 
> 时间：2012-10-15T19:03:22.910
> 
> 标签：sql-server, sql-order-by, concatenation

`SELECT @VAR = @VAR + FIELD FROM TABLE ORDER BY OTHERFIELD`我在 Sql Server 2008 中有代码，它使用经过验证的语法将查询中的一些字符串连接到变量中。

这是我的确切 SQL：

```
SELECT @SQL = @SQL + 
    ISNULL(FORMULA, 
    CASE WHEN USEMAP = 1 THEN 
        'dbo.getFieldTranslation('+CONVERT(VARCHAR,ROWID)+', [' + ISNULL(ENCOMPASSFIELD,'') + '])' 
    ELSE 
        '[' + ISNULL(ENCOMPASSFIELD,'') + ']' END
    ) + 
    ' AS "' + FILECOLNAME + '",' + @CRLF  
FROM dbo.EXPORTMAP_EX 
WHERE WAREHOUSEID = @WHSID 
ORDER BY ORDERIDX 
```

这是完美而完美的工作。然后今天突然停止工作。它只是连接最后一行的值。在调试中，我发现如果我取出`ORDER BY`子句，那么所有的字段都会回来，但严格按照字段的字符串值按字母顺序排序。

但是，此 SQL 用于生成导出视图。导出文件的字段必须按正确的顺序排列，因此需要 ORDER BY 子句。为什么 ORDER BY 突然用于***过滤***我的结果？

我不能使用 XML/STUFF 路由，因为某些数据中确实有 < 和 > 符号。
我宁愿不必重新使用旧的 WHILE 循环，但我可能不得不这样做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T20:58:32.287

如评论中所示，您依赖于无证行为。

微软说“[聚合连接查询的正确行为是未定义的。](http://support.microsoft.com/kb/287515/en-us) ”。如果计算标量移动到计划中的错误位置，那么它就会停止工作。

您正在使用的工作是在子查询中定义排序表达式并连接此查询的结果，~~我*认为*是安全的~~。从[SQL Server 中的排序保证...](http://blogs.msdn.com/b/sqltips/archive/2005/07/20/441053.aspx)

> 出于向后兼容性的原因，SQL Server 在最顶层范围内支持 SELECT @p = @p + 1 ... ORDER BY 类型的赋值。

该帖子是在 2005 年写的，所以我不确定保证是否仍然有效（编辑：在[查看有关此问题的 Connect Items](https://stackoverflow.com/a/15163136/73226)后，我确定它没有）

顺便说一句：你说

> 我不能使用 XML/STUFF 路由，因为某些数据中确实有 < 和 > 符号。我宁愿不必重新使用旧的 WHILE 循环，但我可能不得不这样做。

情况并非如此，但它需要一个`XML PATH`比您可能使用的查询更复杂的查询，[请参阅此处的答案以获取示例](https://stackoverflow.com/a/1052353/73226)。

# xml - 在运行时从 xsd 架构创建 XML 文件

> ID：12902283
> 
> 赞同：0
> 
> 时间：2012-10-15T19:03:25.550
> 
> 标签：xml, vb.net, xsd, visual-studio-2005, .net-2.0

我正在尝试创建测试设置的 xml 报告。我的程序是一个测试套件，我想知道它运行的信息，并以 xml 格式呈现。

我有一个用 w3c 编写的 xml 架构，保存在一个 xsd 文件中。理想情况下，我想直接从架构生成 xml，因此如果程序中发生更改，只需更改架构即可更改生成的报告。

这涉及直接从模式创建 xml，我真的不知道如何做到这一点，或者如果它甚至可能没有大量的工作。

为了清楚起见，让我再次列出。

我有一个 xsd 文件，它是一个模式。我想使用此模式从我的程序中的函数调用生成 xml。因此，它采用架构并为我提供了一个匹配的 xml 文件，其中的字段填充了我的变量值。

我希望这很清楚，让我知道这是否可能。

我在 vb.net，使用 Visual Studio 2005。我认为它的 vb 版本 2.0 或 2.5

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T20:35:37.840

[您可以从 XML 模式生成 XML 文档](http://msdn.microsoft.com/en-us/library/aa302296.aspx)中重用 XmlSampleGenerator

# jquery - quickflip-2 多面板

> ID：12902285
> 
> 赞同：1
> 
> 时间：2012-10-15T19:03:30.630
> 
> 标签：jquery, jquery-plugins

我正在使用[Quickflip 2](http://jonraasch.com/blog/quickflip-2-jquery-plugin)创建多个“翻转面板”，它们都共享相同的包装类 .quickFlip

其中有两个“状态”，它们是 .blackPanel （显示为“onload”）和 .redPanel 是相反的......或备用“状态” - QuickFlip 通过简单的动画来翻转这些状态（显然这适用于 IE 8 > Safari、Firefox 和 Chrome……好东西？！）

**我有一个问题：**因为我要处理多个（最多 9 个）我想在选择一个新面板时自动关闭（或重置）所有打开的面板。

编码：

```
 $(function() {
    $('.quickFlip').quickFlip();
    $('.redPanel').on('mouseleave',function(){
 $('.quickFlip').quickFlipper( {}, 0 );
  });
});​ 
```

这是[http://jsfiddle.net/sMYzS/152/上的一个示例](http://jsfiddle.net/sMYzS/152/)

然而......在这个例子中，它在每个面板上运行动画（翻转），无论它们处于什么状态。

我确信答案在于将 .quickFlipper 函数应用于除活动（你能在 jQuery 中这么说吗？）类/区域之外的所有对象。对不起，如果我听起来完全迷路了。

我是 jquery 的新手，已经使用 .each / .mouseover 进行了调查，并添加了不同的函数，这些函数使用 javascript:onclick 来“隐藏”每个非活动状态......但我现在迷路了。经过 15 个小时的闲逛后，我决定来这里，多年来我发现了一个很棒的资源。如果你能指出我正确的方向——那就太好了。谢谢！

以下是一些我尝试修改以满足我的要求的类似技巧： [jQuery Quick Flip switch back](https://stackoverflow.com/questions/11654503/jquery-quick-flip-switch-back)

[Quickflip 2 插件 - 只翻转一次图像？](https://stackoverflow.com/questions/11297116/quickflip-2-plugin-only-having-the-image-flipped-once)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T10:25:25.727

这个小提琴解决了您遇到的问题：

*   [http://jsfiddle.net/vyyVh/1/](http://jsfiddle.net/vyyVh/1/)

在上面的代码中，这一行

```
$('.quickFlip').quickFlipper( {}, 0 ); 
```

作用于具有“quickFlip”类的所有元素 - 即所有面板。

默认情况下，插件会监视对带有“quickFlipCta”类的链接的点击，因此我为这些元素添加了另一个处理程序，在点击时将“翻转”类添加到包装器 div。

```
$('.quickFlipCta').click(function() {
    $(this).parents('.quickFlip').addClass('flipped');
}); 
```

现在不是用“quickFlip”类来取消翻转，我们可以用“flipped”类来寻找东西，一旦它被取消翻转，就删除它。

```
$('.redPanel').on('mouseleave', function() {
    $('.flipped').quickFlipper({}, 0);
    $('.flipped').removeClass('flipped');
}); 
```

但是，如果您希望面板保持翻转状态，直到您单击另一个面板，这里有一个 Fiddle 来代替：

*   [http://jsfiddle.net/vyyVh/3/](http://jsfiddle.net/vyyVh/3/)

这次翻转/取消翻转逻辑都在点击处理程序中 - 希望评论能清楚地说明那里发生了什么。

# php - PHP in_array（）没有找到价值

> ID：12902286
> 
> 赞同：0
> 
> 时间：2012-10-15T19:03:31.460
> 
> 标签：php, arrays

> **可能重复：**
> [in_array() 和多维数组](https://stackoverflow.com/questions/4128323/in-array-and-multidimensional-array)

使用此代码从数据库返回以下数组：

```
$skus = array();
$result = mysql_query($sql);
if($result){
  while($rows = mysql_fetch_array($result)){
      $skus[]=$rows;
  }
} 
```

结果：

```
Array (
    [0] => Array {
            [0] => PUBELI
            [group_sku] => PUBELI
        )
    [1] => Array (
            [0] => PUBESSENTIALS
            [group_sku] => PUBESSENTIALS
        )
    [2] => Array (
            [0] => PUBMGRPROGROUPED
            [group_sku] => PUBMGRPROGROUPED
        )
    [3] => Array (
            [0] => PUB25GROUPED
            [group_sku] => PUB25GROUPED
        )
) 
```

我正在使用 in_array 寻找这个值：

```
if (in_array('PUBESSENTIALS', $skus)) 
```

它返回false。我这样做正确吗？

如果数据库中的值是字符串，为什么数组值不会用引号引起来？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T19:35:13.357

Don't use PHP if you may do something with MySql! Try this solution:

```
$sql = "SELECT * FROM table WHERE str = 'PUBESSENTIALS'"; // some query just add WHERE

$result = mysql_query($sql);
if($result) $Row = mysql_fetch_array($result) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T19:07:12.440

假设 $skus 是上面显示的完整数组，那么 'PUBESSENTIALS' 将不在 $skus 中，因为 $sku 包含子数组。

但是， in_array('PUBESSENTIALS', $skus[1]) 将返回 true。

尝试遍历每个 $skus 元素，然后检查该子元素的 in_array(value, childArray)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-15T19:12:33.513

您只查看第一个数组，而不查看任何其他数组。您应该查看每个以测试每个子阵列。像这样的东西可以完成这项工作：

```
foreach($skus as $sku) {
    if (in_array('PUBESSENTIALS', $sku)) {
        return true;
    }
} 
```

# apache - Apache 2 安装上的乘客因您的 RVM 包装器脚本太旧而失败

> ID：12902288
> 
> 赞同：3
> 
> 时间：2012-10-15T19:03:38.523
> 
> 标签：apache, apache2, rvm, passenger, ubuntu-10.04

我正在尝试在虚拟根服务器（具有多个用户帐户）上安装乘客，但运行“passenger-install-apache2-module”总是会导致以下错误：

您的 RVM 包装器脚本太旧了。请先运行“rvm get head && rvm reload && rvm repair all”来更新它们。

遵循此给定说明不会产生任何影响。在安装乘客之前，我根据[https://rvm.io//rvm/install/将 RVM 安装为多用户/混合模式](https://rvm.io//rvm/install/)

之后我做了（使用非root帐户）：

*   rvmsudo rvm 用户 gemsets
*   rvm 安装 1.9.3
*   宝石安装导轨
*   宝石安装乘客
*   最后是passenger-install-apache2-module

我在这个问题上搜索了几个小时，但还没有找到任何可行的解决方案。有什么建议么 ？提前致谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-09T18:08:22.383

尝试像这样安装passenger-install-apache2-module：

```
rvmsudo passenger-install-apache2-module 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-15T16:03:16.373

我刚刚遇到了同样的问题。我正在使用 ZSH，但第一次尝试切换到 Bash 也失败了。

`--login`我的解决方案是使用以下标志切换到 Bash ：

```
/bin/bash --login 
```

然后我注意到我的 RVM ruby​​ 没有设置，所以我重新设置了：

```
rvm use ruby-1.9.3 --default 
```

完成此操作后，以下内容按预期工作：

```
passenger-install-apache2-module 
```

富有的

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-09T02:00:15.663

在挣扎了几天之后，我遇到了类似的问题，并且在我的 centos 6.3 系统上采取了极端措施！具体来说，我未能在默认和全局以外的 gemset 上安装独立的 phusion 乘客 apache2 模块。我已经采取了以下步骤，现在它对我有用：

1.  以root身份登录（我希望你知道你在处理什么）

2.  要完全卸载现有的 rvm，请调用
    [root#] rvm implode

3.  安装稳定的 rvm，调用
    [root#] curl -L get.rvm.io | bash -s 稳定

4.  运行 rvm shell,
    [root#] source /etc/profile.d/rvm.sh

5.  检查 rvm 要求，调用
    [root#] rvm 要求

6.  并安装所有要求。

7.  安装 ruby​​ 1.9.3，调用
    [root#] rvm install 1.9.3

8.  安装当前的 ruby​​gems，调用
    rvm ruby​​gems current

9.  将默认设置为 ruby​​ 1.9.3，调用
    [root#] rvm use 1.9.3 --default

10.  将使用 rvm 的其他用户添加到 rvm 组，调用
    [root#] usermod -a -G rvm USERNAME

11.  如果 USERNAME 当前已登录，请注销，以便组添加生效。

12.  确保添加了 rvm 组，调用
    [USERNAME#] 组

13.  在 ruby​​ 1.9.3 上创建并切换到新的 gemset，调用
    [USERNAME#] rvm use 1.9.3@mygemset --create

14.  确认您在正确的 gemset 上，调用
    [USERNAME#] rvm gemset name

15.  安装乘客 gem，调用
    gem 安装乘客

16.  要跳过 gem 文档，请调用
    [USERNAME#] gem install Passenger --no-ri --no-rdoc

17.  或在您的 .gemrc 文件中指定它们

18.  要安装 apache2 mod，请调用
    [USERNAME#]passenger-install-apache2-module

希望有帮助！

# php - 如何将变量插入搜索引擎

> ID：12902291
> 
> 赞同：-2
> 
> 时间：2012-10-15T19:03:55.020
> 
> 标签：php

我正在开发一个 Web 应用程序，用户可以在其中将文本输入到输入中，并将用户输入保存到变量中。

- 然后将此变量插入到另一个外部网页的搜索引擎中（我认为简单的方法是使用搜索输入的“id”）

-然后启动搜索引擎的提交按钮

提前致谢。将研究所有目的；）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T19:07:30.660

因此，如果您希望外部搜索引擎为您完成工作，这很容易。从用户那里获取变量并将其附加到以下字符串

```
google.ca/search?q= 
```

假设用户搜索猫；以下将是您的字符串：

```
google.ca/search?q=cats 
```

然后，您可以通过使用 php[标头函数](http://php.net/manual/en/function.header.php)或将该字符串转换为链接并将其放置在页面上来重定向用户。希望这可以帮助。

# c++ - 一个用于 2 个 cpp 程序的 makefile

> ID：12902296
> 
> 赞同：0
> 
> 时间：2012-10-15T19:04:14.857
> 
> 标签：c++, makefile

您好，我需要为一个目录中的 2 个单独的 cpp 程序创建一个生成文件。我有这个代码，但它不能正常工作。.o 文件没有被创建。谢谢

```
OBJS = a b
EXEC = first_run second_run

#------ constant definitions

ALL_OBJ = $(OBJS:%=%.o)

all: $(EXEC)

clean:
    $(RM) $(EXEC) $(OBJS) $(ALL_OBJ); make all

CC = g++

DO_OBJS = $(CC) -cpp -o $@.o $@.cpp; touch $@
DO_EXEC = $(CC) -s -o $@ $(ALL_OBJ)

#------ now compile

$(OBJS):    $(@:%=%.o)
        $(DO_OBJS)

$(EXEC):    $(OBJS)
        $(DO_EXEC) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T19:14:50.520

您的文件存在一些问题，但主要问题似乎是您尝试将两个源文件链接到单个可执行文件。您必须单独列出每个程序及其依赖项。

试试这个简单的 Makefile：

```
SOURCES = a.cpp b.cpp
OBJECTS = $(SOURCES:%.cpp=%.o)
TARGETS = first_run second_run

LD = g++
CXX = g++
CXXFLAGS = -Wall

all: $(TARGETS)

# Special rule that tells `make` that the `clean` target isn't really
# a file that can be made
.PHONY: clean

clean:
    -rm -f $(OBJECTS)
    -rm -f $(TARGETS)

# The target `first_run` depends on the `a.o` object file
# It's this rule that links the first program
first_run: a.o
    $(LD) -o $@ $<

# The target `second_run` depends on the `b.o` object file
# It's this rule that links the second program
second_run: b.o
    $(LD) -o $@ $<

# Tells `make` that each file ending in `.o` depends on a similar
# named file but ending in `.cpp`
# It's this rule that makes the object files    
.o.cpp: 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-15T19:16:45.457

吻：

```
all: first_run second_run

clean:
    rm -f first_run second_run

first_run: a.c
    $(LINK.cc) $^ $(LOADLIBES) $(LDLIBS) -o $@

second_run: b.c
    $(LINK.cc) $^ $(LOADLIBES) $(LDLIBS) -o $@ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T19:16:32.483

我建议这个 Makefile：

```
EXEC = first_run second_run
OBJS_FIRST = a.o
OBJS_SECOND = b.o

all: $(EXEC)

first_run: $(OBJS_FIRST)
    $(CXX) -o $@ $(OBJS_FIRST)

second_run: $(OBJS_SECOND)
    $(CXX) -o $@ $(OBJS_SECOND) 
```

您不需要定义对象构建，因为 make 已经知道如何做到这一点。

# php - 使 MySQL 查询动态化的最佳方法（例如，更新查询参数以显示上一周）

> ID：12902303
> 
> 赞同：1
> 
> 时间：2012-10-15T19:04:44.153
> 
> 标签：php, mysql, conditional-statements

我有一个查询，它按任务计算本周工作的总小时数：

```
SELECT name AS 'Task Name'
       , sum(hours) AS `Total Hours`
        FROM time_records
        WHERE yearweek(record_date, 3) = yearweek(now(), 3)
        GROUP BY
        weekday(record_date), name 
```

WHERE 子句指定当前周：

```
WHERE yearweek(record_date, 3) = yearweek(now(), 3) 
```

此数据使用 MySQL 查询和 PDO 语句显示为表。

我现在想为查看者添加一个选项，通过单击表格下方的链接（例如，“上一周”）来查看前一周的数据。为了显示该数据，我需要更新 WHERE 子句以查询前一周的数据：

```
 WHERE yearweek(record_date, 3) = yearweek(now(), 3) - 1 
```

我想知道最好的方法是什么？我宁愿只保留整个查询的一个版本。一种想法是使用PHP将“- 1”添加到查询中，例如：

```
WHERE yearweek(record_date, 3) = yearweek(now(), 3) <?php if (prev) {echo "- 1" ;} ?> 
```

我认为这应该可行，但我如何确定 prev 条件？我是否应该将整个查询放在一个函数中，以便默认情况下它可以是“Time_hours(0)”，而之前的查询可以是“Time_hours(1)” - 还是有更好的方法？

我担心保持代码可管理并遵循最佳实践。任何提示将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T19:56:16.003

我建议您尝试一个查询，该查询具有您要处理的几周前的参数。YEARWEEK 对于每周处理来说是一个糟糕的选择，因为它处理年终展期的效果很差。

试试这个，如果你的星期从星期日开始。这将给出当前周。

```
select r.record_id, r.record_date, w.week weekstart
from record r
join (
    select 
      (FROM_DAYS(TO_DAYS(CURDATE()) -MOD(TO_DAYS(CURDATE()) -1, 7)) 
           - interval 0 week) week
 )w
where record_date >= w.week
  and record_date < w.week + interval 1 week 
```

小提琴：[http ://sqlfiddle.com/#!2/4c487/1/0](http://sqlfiddle.com/#!2/4c487/1/0)

如果您愿意，比方说一周前，请在您的查询中更改`- interval 0 week`为。`- interval 1 week`看到这个小提琴。[http://sqlfiddle.com/#!2/4c487/2/0](http://sqlfiddle.com/#!2/4c487/2/0)

您可以放置​​任意数量的前几周，甚至是跨年结束的几周。`interval -42 week`例如， 请参见此处。[http://sqlfiddle.com/#!2/4c487/3/0](http://sqlfiddle.com/#!2/4c487/3/0)

该表达式`FROM_DAYS(TO_DAYS(CURDATE()) -MOD(TO_DAYS(CURDATE()) -1, 7))`将当前日期向下舍入到上一个星期日。如果要将其四舍五入到前一个星期一，请使用`FROM_DAYS(TO_DAYS(CURDATE()) -MOD(TO_DAYS(CURDATE()) -2, 7))`. 例如：[http ://sqlfiddle.com/#!2/4c487/8/0](http://sqlfiddle.com/#!2/4c487/8/0)

# url-rewriting - 为自动博客重写 RSS 提要中的 URL

> ID：12902309
> 
> 赞同：1
> 
> 时间：2012-10-15T19:05:06.420
> 
> 标签：url-rewriting, rss, autoblogged

我从我的 Pinterest 提要中提取图像并将其放到我的摄影博客上。我的板子的rss地址是[http://pinterest.com/bokehphotos/test/rss](http://pinterest.com/bokehphotos/test/rss)

如果你把它放在一个 rss 验证器中（http://feedvalidator.org/check.cgi?url=http%3a%2f%2fpinterest.com%2fbokehphotos%2ftest%2frss），你会看到你得到的 img scrs全部以_b.jpg结尾，像这样：“media-cache-ec4.pinterest.com/upload/80290805828015284_SNRmbshz_b.jpg”

将 _b 更改为 _c，例如 media-cache-ec4.pinterest.com/upload/80290805828015284_SNRmbshz_c.jpg，您将获得完整尺寸的图像，而不是带有 _b.jpg 的缩略图

我需要做的是在自动博客抓取它之前重写提要中的 URL。

我可以添加自定义值和自定义字段，还可以使用正则表达式对提要进行搜索和替换。

到目前为止，我唯一能做的就是将自动上传的上传文件的名称从以 b.jpg 结尾更改为 c.jpg，但不是提要中的实际 url！

我已经为此烦恼了将近两天，任何帮助都将不胜感激。

非常感谢，狮子座

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T19:08:56.760

Leo，你调查过 Yahoo Pipes 吗？Youtube 上有很多教程……抱歉，我无法具体说明，但我过去曾使用它来实现类似的提要重写。

# ruby - Ruby 错误：使用 Heroku 的工头启动时 Gem:Module (NoMethodError) 的未定义方法“load_yaml”

> ID：12902311
> 
> 赞同：1
> 
> 时间：2012-10-15T19:05:11.883
> 
> 标签：ruby, heroku, rvm, foreman

我开始使用 Heroku 在他们的免费计划中部署一个简单的 Node.js。但是当我运行时`foreman start`，我看到了这个错误：

```
/Library/Ruby/Site/1.8/rubygems/builder.rb:10: undefined method `load_yaml' for Gem:Module (NoMethodError)
    from /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/rubygems.rb:1110:in `require'
    from /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/rubygems.rb:1110
    from /usr/local/foreman/lib/foreman/process.rb:2:in `require'
    from /usr/local/foreman/lib/foreman/process.rb:2
    from /usr/local/foreman/lib/foreman/engine.rb:3:in `require'
    from /usr/local/foreman/lib/foreman/engine.rb:3
    from /usr/local/foreman/lib/foreman/cli.rb:3:in `require'
    from /usr/local/foreman/lib/foreman/cli.rb:3
    from /usr/bin/foreman:13:in `require'
    from /usr/bin/foreman:13 
```

问题：我对 Ruby 平台几乎一无所知，我不使用。我只是碰巧在我的机器上安装了 rvm，因为我曾经想玩 Octopress（基于 Jekyll 的博客生成器）。我首先搜索了互联网，但找不到任何东西。我还访问了官方 RVM 站点并遵循了故障排除的基本步骤：我运行`rvm stable`（它只是没有产生任何输出......），确保对 RVM 脚本的调用在我的最后一个`~/.bash_profile`，是的，我正在使用 bash。

这是我可以提供的信息，因此您可以帮助我。

我在 OS X 10.6.8 下。

`rvm list`印刷 ：

```
rvm rubies

=> ruby-1.9.2-p290 [ x86_64 ] 
```

`which ruby`印刷 ：

`/Users/khalid_jebbari/.rvm/rubies/ruby-1.9.2-p290/bin/ruby`

`rvm info`印刷 ：

```
ruby-1.9.2-p290:

  system:
    uname:       "Darwin djebbz 10.8.0 Darwin Kernel Version 10.8.0: Tue Jun  7 16:33:36 PDT 2011; root:xnu-1504.15.3~1/RELEASE_I386 i386"
    bash:        "/bin/bash => GNU bash, version 3.2.48(1)-release (x86_64-apple-darwin10.0)"
    zsh:         "/bin/zsh => zsh 4.3.9 (i386-apple-darwin10.0)"

  rvm:
    version:      "rvm 1.8.3 by Wayne E. Seguin (wayneeseguin@gmail.com) [https://rvm.beginrescueend.com/]"

  ruby:
    interpreter:  "ruby"
    version:      "1.9.2p290"
    date:         "2011-07-09"
    platform:     "x86_64-darwin10.8.0"
    patchlevel:   "2011-07-09 revision 32553"
    full_version: "ruby 1.9.2p290 (2011-07-09 revision 32553) [x86_64-darwin10.8.0]"

  homes:
    gem:          "/Users/khalid_jebbari/.rvm/gems/ruby-1.9.2-p290"
    ruby:         "/Users/khalid_jebbari/.rvm/rubies/ruby-1.9.2-p290"

  binaries:
    ruby:         "/Users/khalid_jebbari/.rvm/rubies/ruby-1.9.2-p290/bin/ruby"
    irb:          "/Users/khalid_jebbari/.rvm/rubies/ruby-1.9.2-p290/bin/irb"
    gem:          "/Users/khalid_jebbari/.rvm/rubies/ruby-1.9.2-p290/bin/gem"
    rake:         "/Users/khalid_jebbari/.rvm/gems/ruby-1.9.2-p290/bin/rake"

  environment:
    PATH:         "/Users/khalid_jebbari/.gem/ruby/1.8/bin:/usr/local/heroku/bin:/Users/khalid_jebbari/bin/bin:/Users/khalid_jebbari/.rvm/gems/ruby-1.9.2-p290/bin:/Users/khalid_jebbari/.rvm/gems/ruby-1.9.2-p290@global/bin:/Users/khalid_jebbari/.rvm/rubies/ruby-1.9.2-p290/bin:/Users/khalid_jebbari/.rvm/bin:/opt/local/bin:/opt/local/sbin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/usr/local/git/bin:/usr/X11/bin"
    GEM_HOME:     "/Users/khalid_jebbari/.rvm/gems/ruby-1.9.2-p290"
    GEM_PATH:     "/Users/khalid_jebbari/.rvm/gems/ruby-1.9.2-p290:/Users/khalid_jebbari/.rvm/gems/ruby-1.9.2-p290@global"
    MY_RUBY_HOME: "/Users/khalid_jebbari/.rvm/rubies/ruby-1.9.2-p290"
    IRBRC:        "/Users/khalid_jebbari/.rvm/rubies/ruby-1.9.2-p290/.irbrc"
    RUBYOPT:      ""
    gemset:       "" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T19:25:53.393

`PATH`设置不正确，我的猜测是你重置或预设 PATH，使用 ruby​​ 使其工作：

```
rvm use 1.9.2-p290 
```

并安装工头：

```
gem install foreman 
```

# java - Java 从文件中读取对象向量只读取向量中的第一个对象

> ID：12902317
> 
> 赞同：1
> 
> 时间：2012-10-15T19:05:32.427
> 
> 标签：java, vector, io, deserialization, objectoutputstream

我有几个根据用户输入分配属性的对象。然后我将这些对象存储在一个向量中，然后将该向量写入一个文件，但是在反序列化存储的向量时，只读取第一个对象。这是我到目前为止的代码：

```
 public Vector<Cases> registerCase() {
    Vector<Cases> casesVector = new Vector<Cases>(10, 2);
    Scanner myCase = new Scanner(System.in);
    Scanner userChoice = new Scanner(System.in);
    System.out.println("HOW MANY CASES DO YOU WANT TO REGISTER?");
    int count = userChoice.nextInt();
    for (int i = 0; i < count; i++) {
        Cases newCase = new Cases();

        System.out.println("Enter the case name: ");
        newCase.caseName = myCase.nextLine();

        System.out.println("Enter the client's name: ");
        newCase.client = myCase.nextLine();

        System.out.println("Enter the case type: ");
        newCase.caseType = myCase.nextLine();

        if((newCase.caseType.equals("Major")) || newCase.caseType.equals("major")){
            newCase.closedCaseRevenue = majorCasePrice;
        }else {
            newCase.closedCaseRevenue = (int) (0.75 * majorCasePrice);
        }

        casesVector.add(newCase);
    }

    try{
        // Open a file to write to, named SavedCases.sav.
        FileOutputStream saveFile = new FileOutputStream("SavedCases.sav", true);
        ObjectOutputStream save = new ObjectOutputStream(saveFile);
        save.writeObject(casesVector);
        save.close(); 
    }
    catch(Exception exc){
        exc.printStackTrace(); 
    }

    Vector<Cases> comVector = new Vector<Cases>();
    try{
        FileInputStream saveFile = new FileInputStream("SavedCases.sav");
        ObjectInputStream save = new ObjectInputStream(saveFile);
        comVector = (Vector<Cases>) save.readObject();
        System.out.println("The size of the vector is: " + comVector.size());
        save.close(); // This also closes saveFile.
    }
    catch(Exception exc){
        exc.printStackTrace(); 
    }

    for (Cases law_case : comVector) {
        System.out.println("Name: " + law_case.caseName);
        System.out.println("Client: " + law_case.client);
        System.out.println("Case Type: " + law_case.caseType);
        System.out.println("Case State: " + law_case.caseState);
        System.out.println("Case Revenue: " + law_case.closedCaseRevenue);
        System.out.println();

    }

    return casesVector;

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T19:39:41.497

您的代码对我来说运行良好，并且正在打印所有已注册的案例，除了我没有附加到已经创建的文件（这就是您想要的，对吗？）。几张支票——

1.  类 Cases 是否实现了 java.io.Serializable？
2.  字段的可见性如何？默认/私有？
3.  我看到你没有关闭 FileOutputStream 和 FileInputStream，你这样做有什么原因吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T19:53:58.303

**编辑：所以如果它已经存在，则附加到一个向量......**

使用检查现有文件

```
File f = new File(FileName);
if(f.exists()) 
  /* Read in the vector from the file using an object input stream on the file */
else 
  /* make a new vector */ 
```

然后读入你的输入并完全按照你在那里的样子输出它，但是当你让 FileOutputStream 不包含 true 标志时，这将导致你每次都添加一个新向量，而不是仅仅用新的向量覆盖当前向量，正确的一个。

**原来的**

问题在于您的实现是每次写入保存文件时都会附加一个新数组。因此，每当您尝试从文件中读取数据时，您总是会得到您制作的第一个数组。

我不确定您是否想每次都用一个新数组覆盖数组，但是您应该在添加更多案例之前读取当前数组，或者不将 FileWriter 构造函数的附加标志设置为 true，具体取决于您的期望的结果。

# wcf - 是否可以在 web.config 中设置请求/响应格式？

> ID：12902319
> 
> 赞同：1
> 
> 时间：2012-10-15T19:05:39.117
> 
> 标签：wcf, .net-4.0

我的 WCF REST 服务上有很多端点。它们都具有相同的正文样式、请求格式和响应格式。

```
[WebGet(BodyStyle = WebMessageBodyStyle.Bare,
    RequestFormat = WebMessageFormat.Json,
    ResponseFormat = WebMessageFormat.Json,
    UriTemplate = xxx)] 
```

无论如何在web.config中设置这些属性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T20:11:46.810

您可以在端点行为（见下文）中设置正文样式和传出响应格式（而不是请求格式）的*默认值。*`<webHttp>`请注意，如果您在服务中（这似乎是您的情况），那没关系，因为 WCF REST 端点可以接收 XML 和 JSON 格式的请求 - RequestFormat 属性仅在*客户端*中使用时使用, 决定以哪种格式发送请求。

```
<endpointBehaviors>
    <behavior name="WebWithDefaults">
        <webHttp defaultOutgoingResponseFormat="Json"
                 defaultBodyStyle="Bare" />
    </behavior>
</endpointBehaviors> 
```

# windows - Windows TCP keepalive 发送没有 PSH 的 1 字节消息

> ID：12902321
> 
> 赞同：2
> 
> 时间：2012-10-15T19:05:48.583
> 
> 标签：windows, networking, tcp, winsock

我有一个我认为是 Windows 客户端的流量捕获。我注意到它有时会发送被 Wireshark 识别为“TCP Keep-Alive”的内容，但它不仅设置 ACK 并且不发送任何数据，而是将 SEQ 备份一个八位字节并重新发送该数据。

（C = 客户端，S = 服务器，相对 seq / ack）

```
(connected, data transferred back and forth)
1  C: PSH      Seq=21, Ack=41, Len=12
2  S: PSH ACK  Seq=41, Ack=33, Len=12
3  C:     ACK  Seq=33, Ack=53
4  S: PSH ACK  Seq=53, Ack=33, Len=1
5  C:     ACK  Seq=33, Ack=54
   ... 3 seconds pass ...
6  C:     ACK  Seq=32, Ack=54, Len=1 (resends the last octet from #1)
7  S:     ACK  Seq=54, Ack=33
   ... 
```

这是发送 TCP keepalive 时 Windows 堆栈的正常行为吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T20:26:23.747

这就是保持活动的部分。它不是一个单独的协议，它只是一个带有已经确认的序列号的冗余发送，以触发一个带有当前序列号的 ACK 作为回复。也不需要设置 PSH 标志。

# javascript - 如何优化这个 CSS3/许多图像的性能？

> ID：12902323
> 
> 赞同：1
> 
> 时间：2012-10-15T19:05:56.637
> 
> 标签：javascript, jquery, performance, css

这是[网站的链接](http://pineapple.io/)

这里有一些事情我很想调整，但我不太确定我还能做什么。

缩略图和网站图标是通过外部服务提取的，我宁愿不设置反向代理来缓存它们。通常，图像在加载时应该平滑淡入（以一种“随机”顺序，它会产生很好的效果）。

你会注意到当页面加载时，它似乎有点不稳定，我认为是因为 twitter 脚本在加载所有缩略图的同时加载。

我已经尝试过查看几种性能工具，但对于如何改进这一点我有点茫然。

我唯一能想到的就是让推特偏移一两秒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T19:07:24.607

您应该查看[图像精灵](http://www.w3schools.com/css/css_image_sprites.asp)和 HTML[`defer`](http://www.w3schools.com/tags/att_script_defer.asp)属性。您还应该考虑打包脚本，将它们移动到页脚并合并它们。CSS 也是如此，您应该将它们放在两个单独的组中，这将导致它们分两个“批次”加载。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T19:38:52.767

您总是可以先发制人地延迟图像的显示：

查询：

```
$(document).ready(function(){

  setTimeout(function(){
    $('img').css('opacity':'1');
  }, 2000);

}); 
```

CSS：

```
img{
  opacity:0;
  transition:opacity .5s;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T19:10:13.703

为 apache 服务器下载并安装 [mod_pagespeed](https://developers.google.com/speed/pagespeed/mod)

或者试试[google的页面加速服务](https://developers.google.com/speed/pagespeed/service)

[图像优化组件的详细信息](https://developers.google.com/speed/docs/mod_pagespeed/filter-image-optimize)

# c++ - 迭代 boost::property_tree XML

> ID：12902324
> 
> 赞同：0
> 
> 时间：2012-10-15T19:06:06.823
> 
> 标签：c++, boost

如果我对设置结构一无所知，如何迭代 boost::property_tree （XML 部分）？

我想知道所有字段的名称和 xmlattr 名称。

我在这个库的 boost 文档中没有看到这样的例子。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T19:09:06.370

[在此处](http://www.boost.org/doc/libs/1_42_0/doc/html/boost_propertytree/tutorial.html)查看 boost 文档。在页面的下一部分，您可以看到以下示例代码：

```
// Iterate over the debug.modules section and store all found
// modules in the m_modules set. The get_child() function
// returns a reference to the child at the specified path; if
// there is no such child, it throws. Property tree iterators
// are models of BidirectionalIterator.
BOOST_FOREACH(ptree::value_type &v,
        pt.get_child("debug.modules"))
    m_modules.insert(v.second.data()); 
```

只需修改代码以遍历根属性树中的所有模块（如果您愿意，还可以递归到子树中）。

例如：

```
ptree my_tree;
// Read in your XML to the tree
...
BOOST_FOREACH(ptree::value_type &v,
     pt, do_something_with_field(v.second.data()); 
```

# mysql - 选择登录 mysql 二进制日志的内容

> ID：12902329
> 
> 赞同：1
> 
> 时间：2012-10-15T19:06:34.580
> 
> 标签：mysql, logging

我正在运行 mysql-server-5.0.95-1.el5_7.1。

我在数据库中遇到了一些奇怪的行为，我想存储一些操作。

阅读 Mysql 参考手册，我设置了二进制日志并开始记录数据库中发生的所有事情。

但是日志文件太大了，我想知道是否有一种方法可以配置二进制日志来仅存储一些操作（如 ALTER TABLE、DELETE 或 CREATE INDEX）而不是记录所有操作。

如果是，我该怎么做。

Rgds。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T19:54:56.850

二进制日志的重点是记录服务器上的状态变化。如果它改变状态，它会被记录下来。

# vb.net - vb.net Linq 从可枚举中选择

> ID：12902335
> 
> 赞同：0
> 
> 时间：2012-10-15T19:06:48.247
> 
> 标签：vb.net, linq, datatable

我有以下 LINQ 查询，它将按列分组并将每个组添加到数据集中的数据表中：

```
Dim ds As New DataSet
Dim query = From r In bookedorders Group By key = r.Field(Of Integer)("productgroup") Into Group
For Each grp In query
    Dim x As New DataTable
    x = grp.Group.CopyToDataTable()
    ds.Tables.Add(x)
Next 
```

`bookedorders`在将它们添加到 DataTable 之前，如何从该查询中的表中选择特定列？我有 18 列，我只想在结果中显示 4 `DataTable`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T19:20:20.640

您只能`CopyToDataTable`通过`IEnumerable(Of DataRow)`. 如果您仅通过匿名类型选择几列，`DataTable`则无法再从中创建。

因此，您需要先使用要选择的列创建另一个 DataTable。

例如：

```
Dim table2 = New DataTable()
table2.Columns.Add("Column1")
table2.Columns.Add("Column2")
Dim query = From r In bookedorders 
            Group By key = r.Field(Of Integer)("productgroup") Into Group

Dim ds As New DataSet
For Each grp In query
    Dim tbl = table2.Clone()
    ds.Tables.Add(tbl)
    For Each row As DataRow In grp.Group
        Dim newRow = tbl.Rows.Add()
        newRow.SetField("Column1", row.Field(Of String)("Column1"))
        newRow.SetField("Column2", row.Field(Of String)("Column2"))
    Next
Next 
```

# python - 如何在 python 上同时播放两个不同的歌曲文件？

> ID：12902336
> 
> 赞同：1
> 
> 时间：2012-10-15T19:06:49.257
> 
> 标签：python, python-2.4, myro

我正在尝试同时播放歌曲 1 和歌曲 2（被注释掉的歌曲），但我不知道如何使用 myro 或 winsound 或其他任何方式来做到这一点。有人建议使用线程，但我也不知道该怎么做，因为我只是一个非常初级的程序员。有人可以帮我解决这个问题和/或详细解释如何做到这一点吗？这是我到目前为止所拥有的：

```
import winsound
from myro import *
def main():

    HftM1 = makeSong("Db4 3/8; C4 3/8; Bb3 1/4; Bb3 3/8; Ab3 3/8; Gb3 3/8; Ab3 1/16; C4 3/8; Bb3 3/8; Ab3 1/8; Eb3 1/16; F3 1/16; Ab3 3/8; G3 3/8; F3 3/8; C4 1/16; Db4 3/8; C4 3/8; Bb3 1/8; F3 1/16; Gb3 1/16; Bb3 3/8; Ab3 3/8; Gb3 3/8; C4 3/8; Bb3 3/8; Ab3 1/8; Eb3 1/16; F3 1/16; Ab3 3/8; G3 3/8; F3 3/8")

    saveSong(HftM1, "HymnfortheMissing1.txt", append=1)

    HftM2 = makeSong("Bb2 1/8; F3 1/8; Bb3 1/4; Bb2 1/8; F3 3/8; Gb2 1/8; Db3 1/8; Gb3 1/4; Gb2 1/8; Db3 3/8; Ab2 1/8; Eb3 1/8; Ab3 1/4; Ab2 1/8; Eb3 3/8; F2 1/8; C3 1/8; F3 1/4; F2 1/8; C3 3/8; Bb2 1/8; F3 1/8; Bb3 1/4; Bb2 1/8; F3 3/8; Gb2 1/8; Db3 1/8; Gb3 1/4; Gb2 1/8; Db3 3/8; Ab2 1/8; Eb3 1/8; Ab3 1/4; Ab2 1/8; Eb3 3/8; F2 1/8; C3 1/8; F3 1/4; F2 1/8; C3 3/8")

    saveSong(HftM2, "HymnfortheMissing2.txt", append=1)

    song1 = readSong("HymnfortheMissing1.txt")

    #song2 = readSong("HymnfortheMissing2.txt") #This part of the song is supposed to be played at the same time as the first part, but I don't know how to do that so...

    play = []

    for n in range(len(song1)):
        play = song1[n]
        note = play[0]
        duration = play[1]
        winsound.Beep(int(note), int(duration*2000))
main() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T19:11:53.793

我建议您使用[PyGame](http://www.pygame.org/news.html)进行此类工作，并查看此[相关问题](https://stackoverflow.com/questions/6004887/in-pygame-how-is-it-if-even-possible-to-play-more-than-one-song)。您必须使用混音器模块。

一般来说，您必须对音频流使用一些数学操作来混合 PCM 数据（有关示例讨论，[请参见此问题](https://stackoverflow.com/questions/12089662/mixing-16-bit-linear-pcm-streams-and-avoiding-clipping-overflow)）。

* * *

**更新**：Myro（我从未使用过）[在文档](http://wiki.roboteducation.org/Myro_Reference_Manual#Output_Functions)中说有一种方法可以使用该`beep`函数来做到这一点：

> beep(self, duration, frequency, frequency2 = None)：发出声音。如果给出两个音调，机器人会将它们组合起来。

举个简单的例子，如果您在第一首歌曲中有音符 A，持续时间为 1 秒，而在第二首歌曲中有音符 B，持续时间为 2 秒，您将必须调用`beep`两次：首先同时播放音符 A 和 B 1 秒，然后只演奏音符 B 1 秒钟。

不用说，这段代码比使用 PyGame 之类的播放音频文件中的声音并混合它们要复杂得多。

# eclipse - eclipse 动态 web 项目文件位置

> ID：12902339
> 
> 赞同：9
> 
> 时间：2012-10-15T19:07:01.080
> 
> 标签：eclipse, jsp, web-applications, resources

我正在 Eclipse 中创建一个新的动态 Web 项目，并且想知道文件夹分类的最佳实践是什么。这就是我认为 <> 是文件夹。有人可以验证吗？

```
 <Eclipse project name>
    <src>
        -- .java files
    <WebContent> 
        -- .html pages
        <images> 
        <css> 
        <js>
        <META-INF> 
            MANIFEST.MF 
        <WEB-INF> 
            web.xml
        <app name>
          -- .jsp pages 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2017-03-27T15:34:17.243

这是一个动态 Web 项目的示例文件夹结构： [![在此处输入图像描述](../Images/8c3871bb2dc622059f3d96c896994bcc.png)](https://i.stack.imgur.com/fFwrG.png)

如您所见，所有静态文件都作为子文件夹放置在**WebContent**文件夹下。按照命名约定，.css 文件位于**css**子文件夹中。JavaScript .js 文件放置在**js**子文件夹下，任何图像文件（例如 .jpeg 或 .png）都放置在**images**子文件夹中。我还有一个额外的**lib**子文件夹，我在其中放置了一个要使用的 angularjs 库。

默认情况下，创建动态 Web 项目后，您的 web.xml 文件如下所示：

```
 `<welcome-file-list>
 <welcome-file>index.html</welcome-file>
 <welcome-file>index.jsp</welcome-file>` 
```

这意味着它会在您运行应用程序时首先调用列出的默认名称文件。这就是大多数项目将文件命名为**index.html**或**index.jsp**的原因。*注意：我的 index.html 文件位于 WebContent 文件夹的正下方，而不是子文件夹中*

最后，您可以从文件中调用/包含静态文件（.css .js 和图像文件），`'index'`如下所示：

```
 <link rel="stylesheet" href=css/bootstrap.min.css>
    <link rel="stylesheet" href=css/bootstrap-theme.min.css>

    <script type="text/javascript" src="lib/angular.min.js"></script>
    <script src="js/contactsApp.js"></script> 
```

您的 .java 文件也将正确放入**Java Resources** -> **src** -> {place java files here}

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-15T19:42:32.673

将您的页面放在`WEB-INF`文件夹下，这样它们就无法直接访问。

另请查看`maven`目录布局[http://maven.apache.org/guides/introduction/introduction-to-the-standard-directory-layout.html](http://maven.apache.org/guides/introduction/introduction-to-the-standard-directory-layout.html)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-10-14T04:23:26.070

对于 Aleksandr M 所说的，

WebContent 文件夹：所有 Web 资源的强制位置，包括 HTML、JSP、图形文件等。如果文件没有放在这个目录下（或者这个目录下的子目录结构中），那么在服务器上执行应用程序时这些文件将不可用。

WEB-INF 基于 Sun Microsystems Java Servlet 2.3 规范，此目录包含 Web 应用程序的支持 Web 资源，包括 web.xml 文件以及 classes 和 lib 目录。

来源：[http ://help.eclipse.org/juno/index.jsp?topic=%2Forg.eclipse.wst.webtools.doc.user%2Ftopics%2Fccwebprj.html](http://help.eclipse.org/juno/index.jsp?topic=%2Forg.eclipse.wst.webtools.doc.user%2Ftopics%2Fccwebprj.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-15T19:37:11.063

我不确定为什么在`app-name`下面有一个目录`WebContent`会被认为是“最佳实践”。

除此之外，在提出目录结构时应该遵循的一个主要规则是将所有静态资源放在一个目录下。在您的示例中，我将有一个名为`static`under的子目录`WebContent`，并将`js`,`css`和`images`目录放在它下面。

这样，您（稍后）将更容易配置您的 HTTP 服务器以直接从文件系统中选择静态资源，而不是通过 servlet 容器路由对静态资源的请求。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-09-14T16:39:20.033

我也有这个问题，还不能发表评论，但 Upendra Bittu 的回答帮助了我。

[http://help.eclipse.org/neon/index.jsp](http://help.eclipse.org/neon/index.jsp) 搜索“jsp”，点击“Creating JavaServer Pages (JSP) files”

> 1.  如果您还没有这样做，请创建一个动态 Web 项目。
> 2.  在 Project Explorer 中，展开您的项目并右键单击您的**WebContent 文件夹**或 WebContent 下的子文件夹。请注意， *如果您选择在其中创建 JSP 的任何其他文件夹，那么它将不会包含在部署到服务器的 WAR 文件中。此外，链接验证不会包含不在 WebContent 文件夹下的文件。*
> 3.  从上下文菜单中，选择新建 > JSP。新 Java 服务器页面窗口出现，您的文件夹被选中

我正在尝试教程，当人们没有说他们在哪里创建文件时迷路了，这有助于我理解发生了什么，所以我只是把它传递下去。

# windows-8 - 清除 ISupportIncrementalLoading

> ID：12902352
> 
> 赞同：4
> 
> 时间：2012-10-15T19:07:41.440
> 
> 标签：windows-8, microsoft-metro

我在 Windows 8 Style App 中创建了一个搜索页面。我已经实现了 ISupportIncrementalLoading 并且当用户滚动分页时效果很好。

我遇到的问题是当用户进行第二次搜索时。我显然不知道如何让 LoadMoreItemsAsync 再次触发。我尝试了以下方法：

1）清除Observable并支持ISupportIncrementalLoading的底层集合。这会清除屏幕上的所有项目，因此我知道它已正确绑定。

2) 完全替换实现 ISupportIncrementalLoading 并引发 INotifyPropertyChanged 的​​底层集合实例，以便视图知道属性已更改。这也会清除屏幕上的所有项目。

但是，LoadMoreItemsAsync 不想在清除或替换基础集合实例后触发。我的预感是 UI 认为它不需要再加载了，但是因为我已经清除了它应该想要加载更多的所有项目。

我已验证 HasMoreItems 属性设置为 true。

如果它有帮助，遗憾的是，如果您从 Windows 8 商店下载 FlixPicks，您会在生产中看到错误。重现的步骤是：

1.  使用 windows 搜索合同进行搜索
2.  通知分页工作 从搜索页面
3.  再次搜索。
4.  请注意，所有项目都已清除。（此时 LoadMoreItemsAsync 没有触发）

感谢您提供的任何建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T13:31:12.357

这绝对看起来像一个错误。要解决此问题，请在重置集合后添加以下行（在任何情况下）：

```
gv.LoadMoreItemsAsync(); 
```

您可能可以从控件继承并创建一些将自动执行此操作的覆盖：

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-12-08T19:17:09.200

我知道这是一个较老的问题，但我也遇到过它，并认为其他人可能会从 MVVM 方法中受益来解决它。我的解决方法是，在重置集合后，将单个项目加载到集合中。

```
private async Task ResetCollectionAsync()
{
    Clear();
    await LoadMoreItemsAsync(1);
} 
```

集合被清空并重新添加单个项目。/控件检测事件并重新查询以确定是否加载附加数据`GridView`。`ListView``CollectionChanged``HasMoreItems`

此行为已融入[IncrementalLoadingCollection](https://www.nuget.org/packages/UniversalWindowsPlatformToolkit.IncrementalLoadingCollection/) (v1.0.1)，它还支持开箱即用的过滤和排序功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-07-21T20:40:46.787

我正在恢复一个老问题，但是当以前的答案都不适合我时，我找到了解决方案。

```
myCollection = new MyIncrementalLoadingCollection();
myListView.ItemSource = myCollection; //This is what I was missing! 
```

由于我希望每次导航到页面时都刷新列表视图，这就是我的最终结果。

```
protected override async void OnNavigatedTo(NavigationEventArgs e) {
    _logItems = new CommandLogIncrementalLoadingCollection();
    logListBox.ItemsSource = _logItems;
} 
```

# linux - bash，如果然后脚本来解析文件

> ID：12902353
> 
> 赞同：-2
> 
> 时间：2012-10-15T19:07:45.370
> 
> 标签：linux, bash, shell, scripting

我的要求是查看 F-5 配置。

就像是：

```
 If x=virtual
 grep for virtual | pool | destination 
```

文件如下所示：

```
virtual vs_website_443 {
snat automap
pool pl_website_443
destination 11.11.11.11:https
ip protocol tcp
persist pr_cookie_JSESSION_AP
profiles {
   oneconnect-ebiz-blah {}
  pr_http_ebiz_x_forwarded_for {}
   serverssl {
      serverside
  }
   tcp-lan-optimized {}
   wildcard.origin.website.com {
      clientside
   }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T19:56:30.577

plain `bash`，虽然可以很容易地转换为 POSIX sh。

```
#!/usr/bin/env bash

in=0 # whether we are inside a 'virtual' block
     # such a block ends once we meet a line that starts with '}'

while read -r
do
    if [[ $REPLY =~ ^virtual ]]; then
        in=1
        echo "${REPLY% *}"
    elif (( in )); then
        if [[ $REPLY =~ ^pool ]]
        then echo "$REPLY"
        elif [[ $REPLY =~ ^destination ]]
        then echo "${REPLY%:*}" # or just "$REPLY" if you want the ':https' part
        elif [[ $REPLY =~ ^} ]]
        then in=0
        fi
    fi
done < file 
```

*`file`*你的数据在哪里。您可以将其更改为`"$1"` 并将文件作为参数提供给脚本。

用给定的数据测试，返回：

```
virtual vs_website_443
pool pl_website_443
destination 11.11.11.11 
```

* * *

使用平原`awk`

```
awk '$1 == "virtual" { f=1; print $1,$2; next }         \
     f == 1 { if ($1 == "pool") { print }               \
              else if ($1 == "destination") { print }   \
              else if ($0 ~ /^}/) { f=0 }               \
     }' file 
```

给定的数据输出是：

```
 $ awk '$1 == "virtual" { f=1; print $1,$2; next } f == 1 { if ($1 == "pool") { print } else if ($1 == "destination") { print } else if ($0 ~ /^}/) { f=0 } }' file
virtual vs_website_443
pool pl_website_443
destination 11.11.11.11:https 
```

# javascript - GA -- Javascript Array Auto 的 onClick，名称为 Alpha

> ID：12902357
> 
> 赞同：0
> 
> 时间：2012-10-15T19:08:03.810
> 
> 标签：javascript, css, google-analytics

我正在尝试编写一个脚本；也许使用 ' `Math`Javascript 中的方法——它允许我简单地将 CSS 类附加到我使用谷歌分析跟踪的数十个文件/照片/媒体等`onClick`。

本质上; 我一直在手动执行以下操作；跨越我要跟踪的数十个站点`onClick`。

```
<p class="downloadsmall">download: <a href="jpg/LOW/1.jpg" onClick="_gaq.push(['_trackPageview', '/downloads/img/LowRes/1.jpg']);">Low Res</a></p> 
```

我想知道我是否可以在这里简单地定义一个类；在 JavaScript 数组或类似数组中；我调用附加到标记的类；自动分配 Google 的`onClick`跟踪代码；同时以不同的方式填充名称，以简单的方式；就像在名称末尾添加 1,2,3 等一样。

例如;

```
'/downloads/img/LowRes01.jpg']);">Low Res</a></p>
'/downloads/img/LowRes02.jpg']);">Low Res</a></p> 
```

****有人对我如何写这个有任何建议吗？****是否可以？**

* * *

**更新：//** 下面是我正在尝试的完整代码；标准 GA 似乎已阅读，但它没有解决任何问题`onClicks`？我在“内容深入分析”和“事件”下进行了检查，除了基本的“GA”阅读之外，似乎没有任何问题可以解决。

```
<!doctype html>

<head>

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-35609953-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

<!-- GA track all onClicks -->

<script>
$(function(){
    $('.downloadsmall a').attr("onclick", function(i){
        var x='LowRes0'+(i+1)+'.jpg';
        return "_gaq.push(['_trackPageview', '/downloads/img/"+x+"'])";
    });
});​
</script>

<!-- End GA track all onClicks -->

<style>

#wrap {
    width: 940px;
    margin-left: 0 auto;
}

#left {
    width: 50%;
    float: left;
}

#right {
    width: 50%;
    float: right;
}

.downloadsmall {
height: 50px;
width: 200px;
border: 3px dotted #333;
}

</style>

</head>

<body>

    <div id="wrap"><!-- Wrap -->

    <div id="left">

<p class="downloadsmall">
    download: <a href="http://www.google.com">Low Res</a>
</p>

    </div>

  <div id="right">

<p class="downloadsmall">
    download: <a href="http://www.yahoo.com">Low Res</a>
</p>

    </div>
    </div><!-- Wrap -->

</body>

</html> 
```

**更新 --** // 我现在有了它，所以它正在读取页面“事件”并跟踪页面浏览量，但它没有根据附加的类归类为 LowRes01.jpg - LowRes02.jpg；这是主要目标——下面是我更新的完整代码。我在这里做错了什么？

```
<!doctype html>

<head>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-35609953-1']);
  _gaq.push(['_trackPageview']);
  _gaq.push(['_trackEvent', 'Downloads', 'JPG', '/downloads/img/LowRes01.jpg']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

<!-- GA track all onClicks -->

<script>
$(function(){
    $('.downloadsmall a').attr("onclick", function(i){
        var x='LowRes0'+(i+1)+'.jpg';
        return "_gaq.push(['_trackPageview', '/downloads/img/"+x+"'])";
        return "_gaq.push(['_trackEvent', 'Downloads', 'JPG', '/downloads/img/"+x+"'])";

    });
});​
</script>

<!-- End GA track all onClicks -->

<style>

#wrap {
    width: 940px;
    margin-left: 0 auto;
}

#left {
    width: 50%;
    float: left;
}

#right {
    width: 50%;
    float: right;
}

.downloadsmall {
height: 50px;
width: 200px;
border: 3px dotted #333;
}

</style>

</head>

<body>

    <div id="wrap"><!-- Wrap -->

    <div id="left">

<p class="downloadsmall">
    download: <a href="http://www.google.com">Low Res</a>
</p>

    </div>

  <div id="right">

<p class="downloadsmall">
    download: <a href="http://www.yahoo.com">Low Res</a>
</p>

    </div>
    </div><!-- Wrap -->

</body>

</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T19:56:38.113

你的意思是这样的吗

```
$(function(){
    $('.downloadsmall a').attr("onclick", function(i){
        var x='LowRes0'+(i+1)+'.jpg';
        return "_gaq.push(['_trackPageview', '/downloads/img/"+x+"'])";
    });
});​ 
```

[**演示**](http://jsfiddle.net/dmG7T/)（请参阅 html 源代码）。

## 来源

```
<p class="downloadsmall"> download: <a href="jpg/LOW/1.jpg">Low Res</a></p>
<p class="downloadsmall"> download: <a href="jpg/LOW/2.jpg">Low Res</a></p> 
```

## 输出

```
<p class="downloadsmall">
    download: <a href="jpg/LOW/1.jpg" onclick="_gaq.push(['_trackPageview', '/downloads/img/LowRes01.jpg'])">Low Res</a>
</p>
<p class="downloadsmall">
    download: <a href="jpg/LOW/2.jpg" onclick="_gaq.push(['_trackPageview', '/downloads/img/LowRes02.jpg'])">Low Res</a>
</p> 
```

## 更新：

要跟踪事件，您必须使用事件跟踪方法`GA`，即

```
_gaq.push(['_trackEvent', 'Downloads', 'JPG', '/downloads/img/LowRes01.jpg']); 
```

并且显示`Events`在 Analytics 报告界面中。所以，我认为它应该像

```
$(function(){
    $('.downloadsmall a').attr("onclick", function(i){
        var x='LowRes0'+(i+1)+'.jpg';
        return "_gaq.push(['_trackEvent', 'Downloads', 'JPG', '/downloads/img/"+x+"'])";
    });
});​ 
```

有关更多信息，[**请阅读此**](https://developers.google.com/analytics/devguides/collection/gajs/eventTrackerGuide)。

# android - 设备重新联机时 Google Cloud Messaging (GCM) 未交付

> ID：12902359
> 
> 赞同：7
> 
> 时间：2012-10-15T19:08:12.720
> 
> 标签：android, cloud, messaging, offline

我正在使用 GCM 开发 Android 应用程序。目前我在客户端和服务器端使用标准的谷歌库。如果我在两台 Android 设备上进行测试，无论我的应用程序是否正在运行，当两台设备都打开时 GCM 都能正常工作。

但是，如果设备 A 已关闭并且我正在从设备 B 向其发送消息，则当设备 A 重新打开时，它不会在离线时收到任何发送的消息。

在服务器端（启动实际发送），到设备 A 的每条消息都没有`collapse_key`,`time_to_live`设置为`2000000`（以防万一）。实际发送将重试参数设置为`50`（以防 GCM 本身无法访问，但这不太可能）。

我需要在设备启动时完成 GCM 注册程序吗？目前我这样做。

请注意 GCM 广播接收器和 GCMIntentService 以及清单中的权限已按照 Google 网站的说明进行设置。

任何建议将不胜感激。我真的被这个问题困住了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T10:37:33.960

对不起大家。是我的错。共享首选项未正确加载，导致 GCMIntentService 运行不正常。消息正常。

解决了

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T07:18:48.667

> 我需要在设备启动时完成 GCM 注册程序吗？

不，你没有。

在我们的项目中，我们在接收设备关闭或离线时发送的消息时没有任何问题。我们不使用任何谷歌库，并按照[gcm 主页](http://developer.android.com/guide/google/gcm/gcm.html)所述完成所有操作此外，我们没有为我们的消息设置任何**collapse_key**和**time_to_live**。

顺便说一句，你处理**message_type**吗？我的 be GCM 通知您消息已删除

# firebase - 使用 REST Api 编辑孩子的属性

> ID：12902360
> 
> 赞同：0
> 
> 时间：2012-10-15T19:08:15.903
> 
> 标签：firebase, firebase-realtime-database

我有一个以下列形式上传的数据集：

```
SomeKey

 -> Alphabet

       -Emp1: "{ 'Fname' : 'Bob', 'Lname' : 'Sob' }"
       -Emp2: "{ 'Fname' : 'Tom', 'Lname' : 'Mot }" 
```

现在使用Rest API，我想在一次调用中编辑具有`Fname`and`Lname`键的员工的`Emp1`and `Fred`，`Dref`以及具有`Fname`and`Lname`键的员工的`Emp2`and `Kent`。`Tenk`这可能吗？如果是，如何？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-12T02:14:57.990

如果您想更新单个员工，您可以使用这样的 PUT REST API 调用来执行此操作：

```
curl -X PUT -d <data> https://some.url.com/SomeKey/Employees/Emp1/.json 
```

如果想使用单个 REST API 调用更新多个员工，您可以使用 PATCH REST 调用来执行此操作，如下所示：

```
curl -X PUT -d '{"Emp1":<data1>,"Emp2":<data2>"}' \
    https://some.url.com/SomeKey/Employees/.json 
```

有关 REST API 的更多详细信息，请参见此处： [https ://www.firebase.com/docs/rest-api.html](https://www.firebase.com/docs/rest-api.html)

# php - MySQL JOIN 与 PHP foreach 循环

> ID：12902362
> 
> 赞同：3
> 
> 时间：2012-10-15T19:08:23.767
> 
> 标签：php, mysql, codeigniter, indexing

我在优化 MySQL 查询时遇到问题，但到目前为止，提取限制为 500 条记录的简单结果需要很长时间。

我的查询是这样的：

```
SELECT ou.*, gr.accepted, gr.value 
FROM offer_usermeta ou 
LEFT JOIN gateway_requests AS gr ON ou.customer_id = gr.customer_id 
WHERE ou.customer_id != "" 
AND ou.created >= '2012-10-08 00:00:00' 
AND ou.created <= '2012-10-08 23:59:59' 
ORDER BY ou.created DESC LIMIT 500 
```

此查询需要一分钟来迭代可能超过 40,000 条记录。我需要它根据客户 ID 提取网关响应（如果有），并且此查询的数据看起来正确，但我需要优化技巧。我正在考虑单独提取数据并在必要时将它们组合在一起，但我知道这可能会慢得多......

有小费吗？（如果有人也知道其中的花哨技巧，我正在使用codeigniter）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T19:10:46.480

`created`如果到目前为止还没有，请在列上添加索引。 无论您是否只有 500 条记录，数据库都必须获取所有记录以执行`order by`并匹配条件。之后尝试`where``limit`

```
SELECT ou.*, gr.accepted, gr.value 
FROM offer_usermeta ou 
LEFT JOIN gateway_requests AS gr ON ou.customer_id = gr.customer_id 
WHERE ou.created between '2012-10-08 00:00:00' and '2012-10-08 23:59:59' 
ORDER BY ou.created DESC 
LIMIT 500 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T19:11:39.600

你应该可以做一个 between 语句，这样效率更高。

AND ou.created 在“2012-10-08 00:00:00”和“2012-10-08 23:59:59”之间

# ios - 使用 RNCryptor 后无法编译

> ID：12902363
> 
> 赞同：0
> 
> 时间：2012-10-15T19:08:29.070
> 
> 标签：ios, objective-c, xcode, rncryptor

我从[这里](https://github.com/rnapier/RNCryptor)使用 RNCryptor 。但似乎无法让我的应用程序正确编译。我在日志中收到以下错误：

```
Undefined symbols for architecture i386:
  "_OBJC_CLASS_$_RNDecryptor", referenced from:
      objc-class-ref in EncryptionTransformer.o
  "_OBJC_CLASS_$_RNEncryptor", referenced from:
      objc-class-ref in EncryptionTransformer.o
ld: symbol(s) not found for architecture i386
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

谁能告诉我这里有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T19:11:23.857

我猜您为 ARM 构建了 RNCryptor，但您正在构建您的应用程序以在模拟器 (i386) 上运行。

# python - 在表单中将初始化的外键字段设置为只读

> ID：12902365
> 
> 赞同：2
> 
> 时间：2012-10-15T19:08:41.283
> 
> 标签：python, django, forms, foreign-keys, readonly

我的表单中有一个外键字段，初始化为：

```
form=myform(intial= {'val':abc.objects.get(pk=id)}) 
```

我已经单独尝试了以下一组代码，以使字段“val”成为只读值。

```
form.fields['val'].widget = forms.HiddenInput()
form.fields['val'].widget.attrs['readonly'] = True
form.fields['val'].widget.attrs['disabled'] = True
form.fields['val'].widget.attrs['disabled'] = 'disabled'
form.fields['val'].widget.attrs['disabled'] = False
form.fields['val'].widget.attrs['display_only'] = True
form.fields['val'].widget.attrs['editable'] = False 
```

仅`HiddenInput`有效，但未在表单中显示该字段，同时`disabled`显示错误。`readonly`工作于除外键字段之外的所有字段。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-12-10T17:52:23.597

我通过覆盖 Select 小部件渲染方法并更改其输出来做到这一点。

```
class ReadOnlySelect(Select):
    """
    This should replace the Select widget with a disabled text widget displaying the value, 
    and hidden field with the actual id
    """
    def render(self, name, value, attrs=None, choices=()):
        final_attrs = self.build_attrs(attrs, name=name)
        display = "None"
        for option_value, option_label in chain(self.choices, choices):
            if str(option_value) == (value) : 
                display = option_label 
        output = format_html('<input type=text value="%s" disabled="disabled" ><input type="hidden" value="%s"  %s> ' % (display, value, flatatt(final_attrs)))

        return mark_safe(output) 
```

有关 Django 片段的更完整示例。 [https://djangosnippets.org/snippets/10436/](https://djangosnippets.org/snippets/10436/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T20:22:51.420

我有类似的问题，我决定使用不同的方法。首先，我为表单定义了自己的类，例如：

```
class MyForm(ModelForm):

def __init__(self, *args, **kwargs):
    super(MyForm, self).__init__(*args, **kwargs)

class Meta:
    model = YourModel
    exclude = ('foreign_key_field') 
```

然后在模型中 myModel 做了这样的事情：

```
foreign_key_field = models.ForeignKey(KeyField)

def set_values(self, *args, **kwargs):
    foreign_key_field = kwargs.pop('foreign_key_field') 
```

我定义函数来设置只读字段值。我在views.py 中创建了表单对象后调用了这个方法。（提交表格后）

最后是views.py：

```
if form.is_valid():
        new_instance = form.save(commit=False)
        new_instance.set_values(
              foreign_key_field='YOUR VALUE',
              )
        new_instance.save() 
```

我从表单中排除了这个字段，但是在创建实例之后我正在设置值。设置值后我保存到 db.

# google-chrome - Google Chrome Mac 与 PC 样式差异

> ID：12902367
> 
> 赞同：0
> 
> 时间：2012-10-15T19:08:48.617
> 
> 标签：google-chrome, css

我在我的 Mac (OSX 10.8.2) 和我的 PC (Windows XP SP2) 上都有完全相同版本的 Google Chrome (22.0.1229.94)，但我的输入按钮的呈现方式略有不同（PC 版本略微向下移动） .

这是我的开发工具的照片

![在此处输入图像描述](../Images/e17239ca41adadcfdbff316451cc805e.png)

Mac版

![Mac版](../Images/b135db29acc3223e081823a9a0d478fd.png)

电脑版

![在此处输入图像描述](../Images/8c71f8fd685752488dc1faa90d505f92.png)

显然差别不大，但足以让它脱颖而出。我的代码中有任何明显的缺陷吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T19:24:17.707

我没有意识到我的字体大小不同。这似乎是问题所在。

# design-patterns - 实现 Data Mapper 和 Repository 的单一接口 - 有什么好处吗？

> ID：12902368
> 
> 赞同：0
> 
> 时间：2012-10-15T19:08:53.157
> 
> 标签：design-patterns, repository-pattern, datamapper

> 数据映射器是映射器的一层，它在对象和数据库之间移动数据，同时保持它们彼此独立以及映射器本身。
> 
> 存储库使用类集合接口在域和数据映射层之间进行调解，以访问域对象。

*因此， Data Mappers*的主要工作是执行*对象*和*表行*之间的映射，并保持*域*和*数据库*彼此独立，而主要工作或*存储库*是提供更多面向对象的*持久层*视图并保持*领域层*完全独立于*持久层*。

a) 据我所知，*Data Mapper*和*Repository*都抽象了*持久层*，唯一的区别是*Repository提供了更多的**持久层*的面向对象视图？

b) 在大多数实现中， *Repository位于**Data Mapper*层之上，但在以下实现中（来自《Architecting Net Solutions for the Enterprise》一书），相同的*接口*同时作为*Data Mapper*和*Repository*发挥作用（因此它也掩盖了*持久性层*作为一个集合）：

```
public interface IDataMapper<T>
{
/* Persistence */
void Create(T item);
void Update(T item);
void Delete(T item);

/* Repository */
IList<T> GetAll();
IList<T> GetAll(int index, int size);
int GetCount();
int GetCount(Query query);
T GetByKey(object key);
IList<T> GetByCriteria(Query query);
IList<T> GetByCriteria(Query query, int index, int size);
string TranslateQuery(Query query);
} 
```

*与Repository位于**数据映射器层*之上的设计相比，这种设计的优点/缺点是什么？

谢谢你

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T05:41:15.417

该代码违反了接口隔离原则，该原则基本上说您应该创建更小的定义良好的接口，而不是创建具有许多功能的更大接口。

这个动机很好地解释了它：

[![在此处输入图像描述](../Images/ca3e17b791a2d4436ed56b8ffdc828ee.png)](https://i.stack.imgur.com/J1HHK.jpg)
[（来源：[losechies.com](https://lostechies.com/derickbailey/files/2011/03/InterfaceSegregationPrinciple_60216468.jpg)）]

而不是一个简单的 USB 接口，你会得到一个带有许多高级东西的顶级盒子（这很难实现）。

保持接口小的原因是接口强制每个实现者实现所有方法（除非他们想违反 Liskovs 替换原则）。

因此将其分解，而是让类实现这两个接口。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T06:02:31.867

当@jgauffin 说接口应该被隔离时，我同意他的观点。但是，如果您确定没有将接口导出到外部模块/应用程序（尽管接口更有可能被其他人使用......这就是它们是接口的原因），您也可以确定没有其他人是要实现它，它只是您自己的代码，甚至您的代码也不希望将映射器与存储库分开，您可以权衡并将它们组合起来。它可能导致更紧凑的代码......并且可能更紧密或强制耦合。如果这些在某些情况下可能是有利的，那么可能这就是架构书的作者这样做的原因。

但是，我再次相信，最好的方法是按照@jgauffin 的建议分离接口。您无法确定接口的客户端和将来可能需要的扩展。分离接口将产生更多可维护和可扩展的代码。

# linux - 其他脚本成功执行后执行Shell脚本

> ID：12902371
> 
> 赞同：4
> 
> 时间：2012-10-15T19:09:04.187
> 
> 标签：linux, bash, shell, unix

**问题陈述：-**

我有四个 shell 脚本，只有在前一个脚本成功执行时才想执行。我目前正在这样运行它-

```
./verify-export-realtime.sh

sh -x lca_query.sh

sh -x liv_query.sh

sh -x lqu_query.sh 
```

所以为了让其他脚本在前一个脚本成功后运行。我需要做类似下面的事情吗？我不确定我是否正确？如果任何脚本由于某种原因失败，它会**因为某种原因打印为失败，对** 吧？

```
./verify-export-realtime.sh

RET_VAL_STATUS=$?
echo $RET_VAL_STATUS
if [ $RET_VAL_STATUS -ne 0 ]; then
echo "Failed due to some reason"
exit
fi

sh -x lca_query.sh

RET_VAL_STATUS=$?
echo $RET_VAL_STATUS
if [ $RET_VAL_STATUS -ne 0 ]; then
echo "Failed due to some reason"
exit
fi

sh -x liv_query.sh

RET_VAL_STATUS=$?
echo $RET_VAL_STATUS
if [ $RET_VAL_STATUS -ne 0 ]; then
echo "Failed due to some reason"
exit
fi

sh -x lqu_query.sh 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-15T19:18:10.727

shell 提供了一个操作符`&&`来执行此操作。所以你可以写：

```
./verify-export-realtime.sh && \
sh -x lca_query.sh && \
sh -x liv_query.sh && \
sh -x lqu_query.sh 
```

或者您可以去掉续行 ( `\`) 并将其全部写在一行上

```
./verify-export-realtime.sh && sh -x lca_query.sh && sh -x liv_query.sh && sh -x lqu_query.sh 
```

如果你想知道它有多远，你可以添加额外的命令来设置一个变量：

```
done=0
./verify-export-realtime.sh && done=1 &&
sh -x lca_query.sh && done=2 &&
sh -x liv_query.sh && done=3 &&
sh -x lqu_query.sh && done=4 
```

最后的值`$done`告诉你有多少命令成功完成。 `$?`将设置为最后一个命令运行的退出值（这是失败的那个），或者`0`如果全部成功

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-15T19:19:12.833

您可以简单地在命令行（或从其他脚本）中运行一系列脚本，当第一个失败的命令将破坏该链时，使用“&&”运算符：

```
$ script1.sh && echo "First done, running the second" && script2.sh && echo "Second done, running the third" && script3.sh && echo "Third done, cool!" 
```

等等。一旦其中一个步骤失败，操作将中断。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T22:08:13.357

The standard way to do this is to simply add a shell option that causes the script to abort if any simple command fails. Simply write the interpreter line as:

```
#!/bin/sh -e 
```

or add the command:

```
set -e 
```

(It is also common to do `cmd1 && cmd2 && cmd3` as mentioned in other solutions.)

You absolutely should not attempt to print an error message. The command should print a relevant error message before it exits if it encounters an error. If the commands are not well behaved and do not write useful error messages, you should fix them rather than trying to guess what error they encountered. If you do write an error message, at the very least write it to the correct place. Errors belong on stderr:

```
echo "Some error occurred" >&2 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-15T20:18:03.603

如果您想要更灵活地处理错误

```
script1.sh
rc=$?
if [ ${rc} -eq 0 ];then
echo "script1 pass, starting script2"
  script2.sh
  rc=$?
  if [ ${rc} -eq 0 ];then
   echo "script2 pass"
  else
   echo "script2 failed"
  fi
else
 echo "script1 failed"
fi 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-15T19:11:12.437

那应该是对的。如有必要，您还可以通过回显 $ 变量来打印错误代码。您还可以通过在这些脚本中实际返回您自己的值并在此主脚本中检查它们来制作自己的返回值代码。它可能比“脚本由于某种原因失败”更有帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-16T01:54:42.413

As @William Pursell said, your scripts really should report their own errors. If you *also* need error reporting in the calling script, the easiest way to do it is like this:

```
if ! ./verify-export-realtime.sh; then
    echo "Error running verify-export-realtime.sh; rest of script cancelled." >&2

elif ! sh -x lca_query.sh; then
    echo "Error running lca_query.sh; rest of script cancelled." >&2

elif ! sh -x liv_query.sh; then
    echo "Error running liv_query.sh; rest of script cancelled." >&2

elif ! sh -x lqu_query.sh; then
    echo "Error running lqu_query.sh." >&2
fi 
```

# javascript - 无法检测到空段落

> ID：12902377
> 
> 赞同：2
> 
> 时间：2012-10-15T19:09:27.040
> 
> 标签：javascript, html, dom

我正在使用以下代码来检查一个空段落，但它永远不会返回 true。为什么？

```
var isEmpty = pageChildren[i].outerHTML.toUpperCase() === "<P></P>";
var isSpace = pageChildren[i].outerHTML.toUpperCase() === "<P> </P>";
var isNbsp = pageChildren[i].outerHTML.toUpperCase() === "<P>&NBSP;</P>";
if(!isEmpty && !isSpace && !isNbsp){
   //do something
}else{
   //do something else
} 
```

这是 IE8 调试工具告诉我在 outerHTML 中的复制粘贴：`"<P></P>"`

这是从 iFrame 中读取的，因此我还需要删除`<p></p>`标签，因为上面的函数会触发框架主体中子元素的数量。

此外，这仅在 IE 上的 HTA 应用程序中运行。用户群/配置受到高度控制。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-15T19:10:38.350

如果你确定你的对象是一个段落，你应该使用[innerHTML](http://www.google.com/search?q=MDN%20innerhtml)代替：

```
var isEmpty = pageChildren[i].innerHTML.trim().length==0; 
```

（请注意，MDN[建议替换缺少 trim 的 IE8](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/Trim)）。

您也可以使用[textContent](https://developer.mozilla.org/en-US/docs/DOM/Node.textContent#Differences_from_innerText)但缺点是您必须对 IE 进行不同的测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T19:14:25.060

由于[`trim()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/Trim)并非所有浏览器都支持，我建议使用 RegEx 删除所有空格：

```
var isEmpty =
    (pageChildren[i].innerHTML.replace(/\s/g, '').length == 0) ? true : false; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T21:11:31.990

似乎 IE < 9 在外部 HTML 结果之前添加了回车、换行符，因此例如`pageChildren[i].outerHTML.toUpperCase() === '\r\n<P></P>'`对于空`p`元素返回 true。

# powershell - WindowsServer 2003 cmd 检查安装的角色

> ID：12902380
> 
> 赞同：1
> 
> 时间：2012-10-15T19:09:33.547
> 
> 标签：powershell, windows-server-2003, roles

我正在创建一个大型批处理脚本来检查 Windows 2003 服务器上安装的 Windows 功能（组件）。我似乎无法弄清楚如何查询服务器角色并在 cmd shell 中显示角色的所有子功能。这在 Windows Server 2008 中很容易通过简单地使用 servermanager.exe 或 WMI 来完成，但我无法弄清楚在 Windows 2003 中使用什么程序或 cmd。Windows Server 2003 安装了 power shell，但它看起来就像一个美化的 cmd shell在此 Windows 操作系统版本中。有谁知道可以专门在 Windows 2003 机器上使用的类似实用程序或 cmd？谢谢你的时间。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-11-12T12:11:19.447

你可以试试这个功能

```
function Get-InstalledComponents($computer = '.') {
    $components_installed   = @();

    $reg_paths  = @('SOFTWARE\Microsoft\Windows\CurrentVersion'`
            + '\Setup\Oc Manager\Subcomponents');
    $reg_paths  += @('SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion'`
            + '\Setup\Oc Manager\Subcomponents');

    $hkey   = 'LocalMachine';
    $reg    = [Microsoft.Win32.RegistryKey]::OpenRemoteBaseKey($hkey, $computer);
    foreach ($reg_path in $reg_paths) {
        $reg_key    = $reg.OpenSubKey($reg_path);
        if ($reg_key -eq $null) {
            continue;
        }
        $names  = $reg_key.GetValueNames();

        foreach ($name in $names) {
            $value  = $reg_key.GetValue($name);
            if ($value -gt 0) {
                $components_installed += @($name);
            }
        }
        $reg_key.close();
    }
    $reg.close();

    if ($components_installed.count -lt 1) {
        trap { ;
        continue } $features = @(get-wmiobject -class 'Win32_ServerFeature' `
                    -computer $computer -erroraction 'Stop');

        foreach ($feature in $features) {
            $components_installed += @($feature.name);
        }
    }       

    return ($components_installed | sort);
} 
```

# javascript - 以原生 UIWebView 为目标的条件 javascript 语句

> ID：12902381
> 
> 赞同：0
> 
> 时间：2012-10-15T19:09:44.777
> 
> 标签：javascript, ios, mobile, uiwebview, conditional

> **可能重复：**
> [通过 javascript 检测 ipad/iphone webview](https://stackoverflow.com/questions/4460205/detect-ipad-iphone-webview-via-javascript)

从本机移动应用程序 web 视图访问时，我需要禁用我们移动网站上的脚本。

是否有可用于从客户端定位 iOS UIWebView 的 javascript 条件语句？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T19:24:00.330

这是解决方案，感谢@nivas：

var is_uiwebview = /(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent);

# ruby-on-rails - 路由在浏览器中工作，在 Rspec 中失败

> ID：12902382
> 
> 赞同：0
> 
> 时间：2012-10-15T19:09:47.243
> 
> 标签：ruby-on-rails, routing, ruby-on-rails-3.2, rspec2, rspec-rails

这个问题可能已经在 Stack Overflow 上被问过十几次（例如（[1](https://stackoverflow.com/q/8647491/306084)）、（[2](https://stackoverflow.com/q/7944668/306084)）、（[3](https://stackoverflow.com/q/7859032/306084)）、（[4](https://stackoverflow.com/q/6756896/306084)）、（[5](https://stackoverflow.com/q/11074404/306084)）），但每次答案似乎都不同，而且没有一个对我有帮助. 我正在使用 Rails 引擎，发现 Rspec2 出现路由错误，但我可以在浏览器中访问路由。情况如下：

*   在引擎中`routes.rb`：

    ```
    resources :mw_interactives, :controller => 'mw_interactives', :constraints => { :id => /\d+/ }, :except => :show

    # This is so we can build the InteractiveItem at the same time as the Interactive
    resources :pages, :controller => 'interactive_pages', :constraints => { :id => /\d+/ }, :only => [:show] do
      resources :mw_interactives, :controller => 'mw_interactives', :constraints => { :id => /\d+/ }, :except => :show
    end 
    ```

*   摘录输出`rake routes`：

    ```
     new_mw_interactive GET    /mw_interactives/new(.:format)                              lightweight/mw_interactives#new {:id=>/\d+/}
                            ...
    new_page_mw_interactive GET    /pages/:page_id/mw_interactives/new(.:format)               lightweight/mw_interactives#new {:id=>/\d+/, :page_id=>/\d+/} 
    ```

*   而我的测试，来自控制器规格之一（`describe Lightweight::MwInteractivesController do`）：

    ```
    it 'shows a form for a new interactive' do
      get :new
    end 
    ```

...得到这个结果：

```
Failure/Error: get :new
ActionController::RoutingError:
  No route matches {:controller=>"lightweight/mw_interactives", :action=>"new"} 
```

...但是当我在浏览器中转到该路线时，它完全按预期工作。

我在这里想念什么？

ETA：澄清 Andreas 提出的一点：这是一个 Rails 引擎，因此 rspec 在一个虚拟应用程序中运行，该应用程序在命名空间中包含引擎的路由：

```
 mount Lightweight::Engine => "/lightweight" 
```

...因此显示的路线`rake routes`以`/lightweight/`. 这就是为什么 Rspec 错误中显示的路线似乎与`rake routes`. 但这确实使调试变得更加困难。

ETA2：回答 Ryan Clark 的评论，这是我正在测试的操作：

```
 module Lightweight
   class MwInteractivesController < ApplicationController
     def new
       create
     end 
```

……就是这样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:11:34.563

我找到了解决方法。在规范的顶部，我添加了以下代码：

```
render_views
before do
  # work around bug in routing testing
  @routes = Lightweight::Engine.routes
end 
```

...现在规范运行没有路由错误。但我不知道为什么会这样，所以如果有人可以发布解释它的答案，我会接受。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T19:28:14.940

添加文件 spec/routing/root_routing_spec.rb

```
require "spec_helper"

describe "routes for Widgets" do
  it "routes /widgets to the widgets controller" do
    { :get => "/" }.should route_to(:controller => "home", :action => "index")
  end
end 
```

然后添加一个文件 spec/controllers/home_controller_spec.rb

```
require 'spec_helper'

describe HomeController do

    context "GET index" do
    before(:each) do
      get :index
    end
    it {should respond_with :success }
    it {should render_template(:index) }

   end
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T19:20:11.857

我认为您的规格可能有问题

“轻量级”是如何进入这一行的：controller=>“lightweight/mw_interactives”

路线说

```
new_mw_interactive GET    /mw_interactives/new(.:format) 
```

不是

```
new_mw_interactive GET    /lightweight/mw_interactives/new(.:format) 
```

# c# - 将 XML 发送到套接字的格式/字节

> ID：12902383
> 
> 赞同：0
> 
> 时间：2012-10-15T19:09:52.640
> 
> 标签：c#, xml, sockets

我想将两行不同的 XML 发送到一个套接字，如下所示：

```
 <GetServerTime UpTimeAtRequest="1919"/>

         <Subscribe FrontId="priceFeed" URI="ffo:/price/productCode=VP-4-6-"/> 
```

我正在使用 Hercules 来测试它，但它不会让我以那种格式发送它。我应该如何对上面的 XML 进行定界或格式化，以便在连接到适当的 IP 地址和端口后使用 Hercules 将其直接发送到套接字？

我也很乐意使用 WebClient 或 C# 中的其他东西发送它。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T19:47:55.943

我不知道 Hercules 是什么，但是通过客户端发送任意数据很容易：

```
using (var client = new TcpClient())
{
    client.Connect(host, porg);
    using (var stream = client.GetStream())
    {
        // Or some other encoding, of course...
        byte[] data = Encoding.UTF8.GetBytes(xmlString);

        stream.Write(data, 0, data.Length);

        // Whatever else you want to do...
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T19:16:04.607

[WebClient](http://msdn.microsoft.com/en-us/library/tt0f69eh.aspx)使用起来非常简单（假设你的套接字使用的是 HTTP 协议），所以使用[UploadString](http://msdn.microsoft.com/en-us/library/0645045y.aspx)看起来像这样：

```
Uri uri = new Uri(@"http://www.mywebsite.com/someurl");
string myXml = "<insert valid xml here> /"

using (WebClient wc = new WebClient()
{
  wc.UploadString(uri, myXml);
} 
```

我只担心您的 xml 无效，因为它有两个根节点并且没有 xml 标头。

# php - ZipArchives 存储绝对路径

> ID：12902387
> 
> 赞同：4
> 
> 时间：2012-10-15T19:09:58.180
> 
> 标签：php, directory, zip, ziparchive

我可以使用相对路径压缩文件吗？

例如：

`$zip->addFile('c:/wamp/www/foo/file.txt');`

ZIP 应具有如下目录结构：

```
foo
 -> file.txt 
```

并不是：

```
wamp
 -> www
     -> foo
         -> file.txt 
```

就像默认情况下...

ps：我的完整代码在[这里](https://stackoverflow.com/questions/12895089/zip-file-not-being-created-but-no-error-gets-triggered/12895332#12895332)（我正在使用 ZipArchive 将目录的内容压缩到一个 zip 文件中）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-15T19:11:54.230

查看[`addFile()`](http://www.php.net/manual/en/ziparchive.addfile.php)函数定义，可以覆盖归档文件名：

```
$zip->addFile('/path/to/index.txt', 'newname.txt'); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-07-03T06:03:36.057

如果您尝试递归添加文件夹的所有子文件夹和文件，您可以尝试下面的代码（我[在 php 手册中修改了此代码/注释](http://www.php.net/manual/en/ziparchive.addfile.php#93090)）。

```
class Zipper extends ZipArchive {
    public function addDir($path, $parent_dir = '') {
        if($parent_dir != ''){
            $this->addEmptyDir($parent_dir);
            $parent_dir .= '/';
            print '<br>adding dir ' . $parent_dir . '<br>';
        }
        $nodes = glob($path . '/*');
        foreach ($nodes as $node) {
            if (is_dir($node)) {
                $this->addDir($node, $parent_dir.basename($node));
            }
            else if (is_file($node))  {
                $this->addFile($node, $parent_dir.basename($node));
                print 'adding file '.$parent_dir.basename($node) . '<br>';
            }
        }
    }
} // class Zipper 
```

所以基本上它的作用是它**不包括**您想要压缩的实际目录/文件夹之前的目录（绝对路径），而是仅从您想要压缩的实际文件夹（相对路径）开始。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-12-12T19:06:18.633

这是 Paolo 脚本的修改版本，以便还包含 .htaccess 之类的点文件，并且它也应该更快一些，因为我[按照此处的建议将 glob 替换为 opendir](http://www.phparch.com/2010/04/putting-glob-to-the-test/)。

```
<?php

$password = 'set_a_password'; // password to avoid listing your files to anybody

if (strcmp(md5($_GET['password']), md5($password))) die();

// Make sure the script can handle large folders/files
ini_set('max_execution_time', 600);
ini_set('memory_limit','1024M');

//path to directory to scan
if (!empty($_GET['path'])) {
    $fullpath = realpath($_GET['path']); // append path if set in GET
} else { // else by default, current directory
    $fullpath = realpath(dirname(__FILE__)); // current directory where the script resides
}

$directory = basename($fullpath); // parent directry name (not fullpath)
$zipfilepath = $fullpath.'/'.$directory.'_'.date('Y-m-d_His').'.zip';

$zip = new Zipper();

if ($zip->open($zipfilepath, ZipArchive::CREATE)!==TRUE) {
    exit("cannot open/create zip <$zipfilepath>\n");
}

$past = time();

$zip->addDir($fullpath);

$zip->close();

print("<br /><hr />All done! Zipfile saved into ".$zipfilepath);
print('<br />Done in '.(time() - $past).' seconds.');

class Zipper extends ZipArchive { 

    // Thank's to Paolo for this great snippet: http://stackoverflow.com/a/17440780/1121352
    // Modified by LRQ3000
    public function addDir($path, $parent_dir = '') {
        if($parent_dir != '' and $parent_dir != '.' and $parent_dir != './') {
            $this->addEmptyDir($parent_dir);
            $parent_dir .= '/';
            print '<br />--> ' . $parent_dir . '<br />';
        }

        $dir = opendir($path);
        if (empty($dir)) return; // skip if no files in folder
        while(($node = readdir($dir)) !== false) {
            if ( $node == '.' or $node == '..' ) continue; // avoid these special directories, but not .htaccess (except with GLOB which anyway do not show dot files)
            $nodepath = $parent_dir.basename($node); // with opendir
            if (is_dir($nodepath)) {
                $this->addDir($nodepath, $parent_dir.basename($node));
            } elseif (is_file($nodepath)) {
                $this->addFile($nodepath, $parent_dir.basename($node));
                print $parent_dir.basename($node).'<br />';
            }
        }
    }
} // class Zipper 

?> 
```

这是一个独立的脚本，只需将其复制/粘贴到一个 .php 文件（例如：zipall.php）并在浏览器中打开它（例如：`zipall.php?password=set_a_password`，如果您没有设置正确的密码，页面将保持空白以确保安全）。之后您必须使用 FTP 帐户来检索 zip 文件，这也是一种安全措施。

# meteor - 流星观察永远运行

> ID：12902392
> 
> 赞同：1
> 
> 时间：2012-10-15T19:10:06.527
> 
> 标签：meteor

根据[观察文档](http://docs.meteor.com/#observe)，我必须定义并调用*停止*函数，否则我的观察者**将永远运行**。关键是，例如，如果用户决定在预期时间之前关闭他的浏览器，如何调用*停止？*如果连接已死，我如何调用*停止？*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T23:02:55.573

您实际上不需要担心断开连接。任何时候订阅停止（无论是客户端断开连接、调用 unsub 还是您调用`this.stop`），服务器都会`onStop`在拆除活动订阅之前运行所有已注册的处理程序。（顺便说一句，断开连接时不会立即发生拆卸，但最终会发生。想法是稍等一下，以防客户端尝试重新连接并恢复其会话。）

您需要**做**的是确保注册一个`onStop`处理程序来清理您的代码使用的任何资源。同样，这需要在订阅停止时发生。 `onStop`是正确的钩子。`stop`例如，就像在示例中的第一个代码节中一样，调用主动观察非常重要。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-16T17:27:32.460

为此，您可以在发布中调用它：

```
this.session.socket.on("close", function() { /*do your thing*/}); 
```

所以，如果你想阻止观察者...

```
Meteor.publish("something", function () {

  // ...
  // your observers code here
  // ...

  self.onStop(function () {
    handle.stop();
  });
  this.session.socket.on("close", function() {
    handle.stop();
  });
}); 
```

答案在[这里](https://stackoverflow.com/a/12505615/599991)找到。感谢周华兵。

# c# - DataGrid 列颜色、字体

> ID：12902394
> 
> 赞同：0
> 
> 时间：2012-10-15T19:10:17.353
> 
> 标签：c#, wpf, wpfdatagrid

我需要在`DataGrid`. 我已经阅读了很多，但找不到有效的解决方案。当表格从基于表格的数据库加载时，应为每列设置列颜色和字体。

是否可以在`DataGrid`'`LoadingRow`事件中为单个单元格设置这些属性。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T20:37:16.533

您可以在 RowDataBound 事件中执行此操作。

# java - 在 JMapViewer 中动态更新标记

> ID：12902396
> 
> 赞同：2
> 
> 时间：2012-10-15T19:10:19.130
> 
> 标签：java, swing, jframe, markers, jmapviewer

你好 Stack Overflow 社区，

我是一个 Java 新手，我正在做一个简单的 Java 项目，我从（动态）源获取坐标（纬度和经度）并使用 JMapViewer（是的，不是 JXMapViewer）在地图上显示标记。我已将所有坐标放在两个 ArrayList(s) 中。它看起来像这样：

```
for(int i = 0; i < latArrayList.size(); i++){
    map.addMapMarker(new MapMarkerDot((double)latArrayList.get(i), (double)longArrayList.get(i)));
} 
```

编辑：地图是一个 jMapViewer 对象。

它工作得很好。问题是我需要这张地图使用计时器每 20 秒刷新一次，我发现的唯一方法是关闭和打开地图，如下所示：

```
 theMap.setVisible(false);
    theMap  = new Map();
    theMap.setVisible(true); 
```

编辑：theMap 是我在主函数中创建的对象（jFrame 不是 jMapViewer）（如在演示中），我不能在其上使用 addMapMarker（如 theMap.addMapMarker(150.2,150.2)）

好吧，正如您可以想象的那样，这很烦人（每 20 秒窗口关闭和打开一次，并且之前的“浏览”会话会丢失）。那么有没有办法刷新呢？通过动态添加标记还是仅刷新内容？

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T19:15:09.723

我从未使用过该 API，但它看起来`theMap.removeAllMapMarkers();`可以解决问题。然后，您可以再次开始添加新标记。

关于您的循环，如果您使用泛型声明您的列表，则无需强制转换为双精度：

```
List<Double> latArrayList = new ArrayList<Double> ();
latArrayList.add(125.87); //or whatever

for(int i = 0; i < latArrayList.size(); i++){
    theMap.addMapMarker(new MapMarkerDot(latArrayList.get(i), longArrayList.get(i)));
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-16T01:03:04.440

我看到两种方法：

*   维护现有`MapMarker`实例的集合并使用`removeMapMarker()`，然后`addMapMarker()`使用提供的不可变`MapMarkerDot`实现。两种方法都调用`repaint()`.

*   实现`MapMarker`接口以创建一个`MutableMapMarkerDot`；根据需要添加尽可能多的实例；*更新原位*坐标并`repaint()`在您的`javax.swing.Timer`侦听器中调用。

# ios - 试图了解CMTime

> ID：12902410
> 
> 赞同：68
> 
> 时间：2012-10-15T19:11:11.393
> 
> 标签：ios, avcapturesession, cmtime

我看过一些[CMTime](https://stackoverflow.com/questions/4001755/trying-to-understand-cmtime-and-cmtimemake)[的](https://stackoverflow.com/questions/5396800/help-me-understand-cmtime-in-avassetwriter)[例子](https://stackoverflow.com/questions/5808557/avassetwriterinputpixelbufferadaptor-and-cmtime) （三个单独的链接），但我还是不明白。我正在使用带有 AVCaptureVideoDataOutput 的 AVCaptureSession，我想设置输出的最大和最小帧速率。我的问题是我只是不了解 CMTime 结构。

显然 CMTimeMake(value, timeScale) 应该每 1/timeScale 秒给我一个 value 帧，总共 value/timeScale 秒，还是我弄错了？

为什么没有记录在任何地方以解释它的作用？

如果它真的像那样工作，我将如何让它拥有无限数量的帧？

如果它真的很简单，我很抱歉，但还没有点击。

* * *

## 回答 #1

> 赞同：176
> 
> 时间：2012-10-21T20:32:28.647

`CMTime`结构体表示存储为有理数的时间长度（参见CMTime[参考](https://developer.apple.com/library/mac/#documentation/CoreMedia/Reference/CMTime/Reference/reference.html)）。`CMTime`有一个`value`和一个`timescale`字段，代表时间`value/timescale seconds`。

`CMTimeMake`是一个返回`CMTime`结构的函数，例如：

```
CMTime t1 = CMTimeMake(1, 10); // 1/10 second = 0.1 second
CMTime t2 = CMTimeMake(2, 1);  // 2 seconds
CMTime t3 = CMTimeMake(3, 4);  // 3/4 second = 0.75 second
CMTime t4 = CMTimeMake(6, 8);  // 6/8 second = 0.75 second 
```

最后两个时间值代表相同的时间值，`t3`因此`t4`

```
CMTimeCompare(t3, t4) == 0 
```

如果您设置`videoMinFrameDuration`a `AVCaptureSession`is 并没有什么不同，如果您设置

```
connection.videoMinFrameDuration = CMTimeMake(1, 20); // or
connection.videoMinFrameDuration = CMTimeMake(2, 40); 
```

在这两种情况下，帧之间的最小时间间隔都设置为 1/20 = 0.05 秒。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2020-04-07T21:36:28.753

我的经历不同。

为了`let testTime = CMTime(seconds: 3.83, preferredTimescale: 100)`

如果您设置断点并查看调试器侧窗口，它会显示：

“383 百分之一秒”

通过在 AVPlayer 中寻找视频中的固定偏移量进行的测试已经证实了这一点。

所以将实际的秒数放在 seconds 字段中，并将精度放在 preferredTimescale 字段中。所以 100 意味着百分之一秒的精度。

正在做 `let testTime = CMTime(seconds: 3.83, preferredTimescale: 100)`

仍然在视频中寻找相同的位置，但它在调试器侧窗口中显示为“3833 1000ths of a second”

正在做 `let testTime = CMTime(seconds: 3.83, preferredTimescale: 1)`

不会在视频中寻找相同的位置，因为它已被截断，并且在调试器侧窗口中显示为“3 秒”。请注意，由于首选时间刻度，0.833 部分已丢失。

# ruby-on-rails - SQLite3::SQLException：没有这样的列：

> ID：12902427
> 
> 赞同：1
> 
> 时间：2012-10-15T19:12:24.780
> 
> 标签：ruby-on-rails, ruby

> **可能重复：**
> [#<ActiveRecord::Relation:0x472d0a0> 的未定义方法 `to_f'](https://stackoverflow.com/questions/12845647/undefined-method-to-f-for-activerecordrelation0x472d0a0)

我正在尝试制作一个呼叫跟踪应用程序来学习 twilio 和 rails。

现在，我想制作一个图表，向用户显示特定电话号码每天接到多少电话。

架构是用户 has_many 电话 has_many 呼叫。

我尝试通过创建一个实例方法来计算特定日期的电话数量来制作图表，但是当我尝试执行代码时，我得到了错误：

```
SQLite3::SQLException: no such column: calls.placed_at: SELECT COUNT(*) FROM "calls"  WHERE "calls"."phone_id" = 44 AND ("calls"."placed_at" BETWEEN '2012-09-15 00:00:00.000000' AND '2012-09-15 23:59:59.999999') 
```

我不太明白我用于实例方法的代码，它可能调用了错误的列。您对此的帮助将不胜感激。

这是我的呼叫模型的重要部分：

```
def total_on(date)
  calls.where(placed_at: date.beginning_of_day..date.end_of_day).count
end 
```

这是我在显示视图中计算电话的方式

```
<%= (1.month.ago.to_date..Date.today).map { |date| @phone.total_on(date).to_f}.inspect %> 
```

这是我定义@phone 变量的方式

```
@phone = Phone.find_by_id(params[:id]) 
```

这是我的完整手机型号（供架构参考）

```
# == Schema Information
#
# Table name: phones
#
#  id              :integer          not null, primary key
#  name            :string(255)
#  twilio_number   :integer
#  original_number :integer
#  user_id         :integer
#  created_at      :datetime         not null
#  updated_at      :datetime         not null
#

class Phone < ActiveRecord::Base

  attr_accessible :original_number, :user_id, :name, :twilio_number
  belongs_to :user
  has_many :calls, dependent: :destroy

  validates :name, presence: true
  validates :twilio_number, presence: true
  validates :original_number, presence: true
  validates :user_id, presence: true

  default_scope order: 'phones.created_at DESC'

  validate :check_phone_limit, :on => :create

  def check_phone_limit
    if User.find(self.user_id).at_max_phone_limit?
      self.errors[:base] << "Cannot add any more phones"
    end
  end

  def original_number=(value)
    num = value.to_s.gsub(/[^0-9+]/, "")
    write_attribute(:original_number, num.to_i)
  end

def total_on(date)
  calls.where(placed_at: date.beginning_of_day..date.end_of_day).count
end

end 
```

这是我完整的通话模型

```
# == Schema Information
#
# Table name: calls
#
#  id               :integer          not null, primary key
#  AccountSid       :string(255)
#  From             :string(255)
#  To               :string(255)
#  CallStatus       :string(255)
#  ApiVersion       :string(255)
#  Direction        :string(255)
#  FromCity         :string(255)
#  FromState        :string(255)
#  FromZip          :string(255)
#  FromCountry      :string(255)
#  ToCity           :string(255)
#  ToState          :string(255)
#  ToZip            :string(255)
#  ToCountry        :string(255)
#  CallSid          :string(255)
#  DialCallSid      :string(255)
#  DialCallDuration :string(255)
#  DialCallStatus   :string(255)
#  RecordingUrl     :string(255)
#  phone_id         :integer
#  DialCallMinutes  :integer
#  created_at       :datetime
#  updated_at       :datetime
#

class Call < ActiveRecord::Base
  attr_accessible :AccountSid, :From, :To, :CallStatus, :ApiVersion, :Direction, :FromCity, :FromState, :FromZip, :FromCountry, :ToCity, :ToState, :ToZip, :ToCountry, :CallSid, :DialCallSid, :DialCallDuration, :DialCallStatus, :RecordingUrl, :DialCallMinutes
  belongs_to :phone

  def self.create_from_incoming_call(params)

   user_phone = Phone.find_by_twilio_number(params['To']) #Finds the phone number in the database based on what phone Twilio is calling

    twilio_request_params = {
      :CallSid => params['CallSid'],
      :AccountSid => params['AccountSid'],
      :From => params['From'],
      :To => params['To'],
      :CallStatus => params['CallStatus'],
      :ApiVersion => params['ApiVersion'],
      :Direction => params['Direction'],
        :FromCity => params['FromCity'],
        :FromState => params['FromState'],
      :FromZip => params['FromZip'],
      :FromCountry => params['FromCountry'],
      :ToCity => params['ToCity'],
      :ToState => params['ToState'],
      :ToZip => params['ToZip'],
      :ToCountry => params['ToCountry']
      :phone_id => user_phone.phone_id

    }

    call = Call.new(twilio_request_params)
    call.save  
    return call

  end

  def Call.update_dial_call(params)

    twilio_request_params = {
        :DialCallSid => params['DialCallSid'],
        :DialCallDuration => params['DialCallDuration'],
        :DialCallStatus => params['DialCallStatus'],
        :RecordingUrl => params['RecordingUrl'],
      :DialCallMinutes => (params['DialCallDuration'].to_f/60.to_f).ceil
    }

    call = Call.where( :CallSid => params['CallSid'] ).first
    call.update_attributes twilio_request_params
    call.save

  end

end 
```

我已经坚持了一段时间了；任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T19:22:49.160

您的调用模型使用标准 rails created_at，但您的查询使用的是不存在的放置的_at。

# c# - 在 Visual Studio Express 2010 中打开 Visual Studio Express 2012 项目

> ID：12902429
> 
> 赞同：0
> 
> 时间：2012-10-15T19:12:31.923
> 
> 标签：c#, visual-studio-2010, visual-studio-2012

我正在测试 Visual Studio Express 2012 for Desktop 以适应新功能（即使没有很多），但是我的 C# 类使用 VS 2010。我似乎无法打开在 VS 2012 中创建的 winform 应用程序与 2010 年相比。

无论如何我可以允许解决方案在 2010 年打开吗？我检查了有关兼容性的微软文档，但不是很清楚。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T19:13:32.670

您的 Visual Studio 2010 需要安装 SP1 才能在 2012 和 2010 之间来回切换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T04:49:26.723

它仅适用于 VS2010 sp1 和 VS2012 此链接可能对您有所帮助 [http://msdn.microsoft.com/en-us/library/vstudio/hh266747.aspx](http://msdn.microsoft.com/en-us/library/vstudio/hh266747.aspx)

# c# - 通过 exe 文件运行 ac# 测试项目

> ID：12902434
> 
> 赞同：0
> 
> 时间：2012-10-15T19:13:00.050
> 
> 标签：c#, testing, powershell, automated-tests, powershell-2.0

我有一堆要通过 powershell 脚本运行的 c# 测试。我目前正在通过创建一个 Windows 应用程序项目、将测试编写为通用类的一部分并将其编译成 .exe 并运行 exe 来做到这一点，但这不是正确的方法。

比如说，我如何创建一个可以运行给定项目中的所有测试的类（可以作为 .exe 出现）或者我可以通过用于应用程序部署的 powershell 脚本轻松运行所有测试的其他方式

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T19:17:15.307

尝试使用[MSTest.exe](http://msdn.microsoft.com/en-us/library/ms182489%28v=vs.100%29.aspx)。有很多参数

来自上面链接的示例。

```
mstest /testcontainer:Errors.dll /detail:testtype 
```

或（*VS90COMNTOOLS*更改为您的版本）

```
&quot;%VS90COMNTOOLS%\..\IDE\MSTest.exe&quot;/testcontainer:Errors.dll /detail:testtype 
```

或（将*“Microsoft Visual Studio 11.0”*更改为您的 VS 文件夹）

```
"%PROGRAMFILES%\Microsoft Visual Studio 11.0\Common7\IDE\MSTest.exe"  /testcontainer:Errors.dll /resultsfile:out 
```

# java - Java GridBagLayout：使组件左对齐

> ID：12902444
> 
> 赞同：2
> 
> 时间：2012-10-15T19:13:40.670
> 
> 标签：java, swing, gridbaglayout

我有这个布局使用`GridBagLayout`：

```
public class Example extends JFrame {
    public Example() {
        Border outline = BorderFactory.createLineBorder(Color.black);
        GridBagLayout gbl = new GridBagLayout();
        GridBagConstraints gbc = new GridBagConstraints();
        JPanel pane = new JPanel(gbl);

        gbc.weighty = 1.0;
        gbc.weightx = 1.0;

        JLabel unitLbl = new JLabel("Unit");
        unitLbl.setBorder(outline);
        gbc.gridx = 0;
        gbc.gridy = 0;
        gbc.ipadx = 30;
        gbc.ipady = 10;
        gbl.setConstraints(unitLbl, gbc);
        pane.add(unitLbl);

        JLabel typeLbl = new JLabel("Type");
        typeLbl.setBorder(outline);
        gbc.gridx = 0;
        gbc.gridy = 1;
        gbc.ipadx = 30;
        gbc.ipady = 10;
        gbl.setConstraints(typeLbl, gbc);
        pane.add(typeLbl);

        JTextField unitField = new JTextField();
        typeLbl.setBorder(outline);
        gbc.gridx = 1;
        gbc.gridy = 0;
        gbc.ipadx = 30;
        gbc.ipady = 10;
        gbl.setConstraints(unitField, gbc);
        pane.add(unitField);

        String[] type = {"All", "Verb", "Noun", "Adjective"};
        JComboBox<String> comboBox = new JComboBox<String>(type);
        gbc.gridx = 1;
        gbc.gridy = 1;
        gbc.ipadx = 30;
        gbc.ipady = 10;
        gbl.setConstraints(comboBox, gbc);
        pane.add(comboBox);

        add(pane, BorderLayout.CENTER);
        setSize(new Dimension(400, 300));
        getContentPane().setBackground(Color.WHITE);
        setVisible(true);
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                new Example();
            }
        });
    }
} 
```

在这个例子中，当运行时，似乎每个组件都在框架的中心。但我想要的是：

1.  两个`JLabel`(`unitLbl`和`typelbl`) 将在框架的左侧
2.  `JTextField`和`JComboBox`将在两个 的右侧`JLabel`，分别相距很小的距离。
3.  此外，我想`JButton`在网格的位置（3,0）处添加一个新的，但这个位置的高度是两个`JLabel`高度之和。这意味着，此按钮高度在“两行”上。

如何修复此代码以实现此目标？请帮我。

谢谢 ：）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-15T19:45:03.577

这样的事情应该可以解决问题：

```
import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Dimension;
import java.awt.GridBagConstraints;
import java.awt.GridBagLayout;
import java.awt.Insets;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.JButton;
import javax.swing.JComboBox;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.JTextField;
import javax.swing.SwingUtilities;

public class Example extends JFrame {
    public Example() {
        GridBagLayout gbl = new GridBagLayout();
        GridBagConstraints gbc = new GridBagConstraints();
        JPanel pane = new JPanel(gbl);
        gbc.anchor = GridBagConstraints.WEST;

        JLabel unitLbl = new JLabel("Unit");
        gbc.gridx = 0;
        gbc.gridy = 0;
        gbc.insets = new Insets(3, 3, 3, 30);
        gbl.setConstraints(unitLbl, gbc);
        pane.add(unitLbl);

        JLabel typeLbl = new JLabel("Type");
        gbc.gridx = 0;
        gbc.gridy = 1;
        gbl.setConstraints(typeLbl, gbc);
        pane.add(typeLbl);

        gbc.weightx = 1.0;
        gbc.insets = new Insets(3, 3, 3, 3);

        JTextField unitField = new JTextField();
        gbc.gridx = 1;
        gbc.gridy = 0;
        gbc.fill = GridBagConstraints.BOTH;
        gbl.setConstraints(unitField, gbc);
        pane.add(unitField);

        String[] type = { "All", "Verb", "Noun", "Adjective" };
        JComboBox<String> comboBox = new JComboBox<String>(type);
        gbc.gridx = 1;
        gbc.gridy = 1;
        gbc.fill = GridBagConstraints.NONE;
        gbl.setConstraints(comboBox, gbc);
        pane.add(comboBox);

        final JButton someButton = new JButton("Click me");
        someButton.addActionListener(new ActionListener() {

            @Override
            public void actionPerformed(ActionEvent e) {
                JOptionPane.showMessageDialog(someButton, "You have clicked " + someButton.getText());
            }
        });

        gbc.gridx = 3;
        gbc.gridy = 0;
        gbc.gridheight = 2;
        gbc.fill = GridBagConstraints.VERTICAL;
        pane.add(someButton, gbc);
        add(pane, BorderLayout.CENTER);
        setSize(new Dimension(400, 300));
        getContentPane().setBackground(Color.WHITE);
        setVisible(true);
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                new Example();
            }
        });
    }
} 
```

*   您需要适当使用`weightx/weighty`（额外的水平/垂直空间如何重新分配）
*   使用适当的`fill`属性（组件是否垂直/水平/两者都拉伸？）
*   使用适当的`anchor`属性（如果组件没有被拉伸，或者至少不是双向拉伸，那么它应该位于其单元格内的哪个位置）
*   我通常更喜欢使用插入而不是填充，因此，我更喜欢`insets`（`ipadx/ipady`应该在组件周围或组件内部添加额外的空白）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-15T19:37:32.810

您想使用它[`GridBagConsraints#anchor`](http://docs.oracle.com/javase/7/docs/api/java/awt/GridBagConstraints.html#anchor)来定义单元格内要将组件对齐到的位置。

要允许组件跨越多个单元格，您需要使用[`GridBagConstraints#gridwidth`](http://docs.oracle.com/javase/7/docs/api/java/awt/GridBagConstraints.html#gridwidth)and [`GridBagConstraints#gridheight`](http://docs.oracle.com/javase/7/docs/api/java/awt/GridBagConstraints.html#gridheight)（默认值为 1）

![在此处输入图像描述](../Images/183b6c4670861e6b0db340c80e560da2.png)

```
public class TestLayout09 {

    public static void main(String[] args) {
        new TestLayout09();
    }

    public TestLayout09() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException ex) {
                } catch (InstantiationException ex) {
                } catch (IllegalAccessException ex) {
                } catch (UnsupportedLookAndFeelException ex) {
                }

                JFrame frame = new JFrame();
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(new LayoutPane());
                frame.setBackground(Color.WHITE);
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }

        });
    }

    public class LayoutPane extends JPanel {

        public LayoutPane() {
            Border outline = BorderFactory.createLineBorder(Color.black);
            setLayout(new GridBagLayout());
            GridBagConstraints gbc = new GridBagConstraints();

            // I'm not sure this really is what you want, but I may be mistaken
//            gbc.weighty = 1.0;
//            gbc.weightx = 1.0;

            JLabel unitLbl = new JLabel("Unit");
            unitLbl.setBorder(outline);
            gbc.gridx = 0;
            gbc.gridy = 0;
            gbc.ipadx = 30;
            gbc.ipady = 10;
            gbc.anchor = GridBagConstraints.WEST;
            add(unitLbl, gbc);

            JLabel typeLbl = new JLabel("Type");
            typeLbl.setBorder(outline);
            gbc.gridx = 0;
            gbc.gridy = 1;
            gbc.ipadx = 30;
            gbc.ipady = 10;
            add(typeLbl, gbc);

            JTextField unitField = new JTextField();
            typeLbl.setBorder(outline);
            gbc.gridx = 1;
            gbc.gridy = 0;
            gbc.ipadx = 30;
            gbc.ipady = 10;
            gbc.anchor = GridBagConstraints.EAST;
            add(unitField, gbc);

            String[] type = {"All", "Verb", "Noun", "Adjective"};
            JComboBox<String> comboBox = new JComboBox<String>(type);
            gbc.gridx = 1;
            gbc.gridy = 1;
            gbc.ipadx = 30;
            gbc.ipady = 10;
            add(comboBox, gbc);

            JButton btn = new JButton("Test");
            gbc.gridx = 3;
            gbc.gridy = 0;
            gbc.fill = GridBagConstraints.BOTH;
            gbc.gridheight = 2;
            add(btn, gbc);
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-15T19:23:30.683

一些答案：

将 unitlbl 的锚点放在 WEST 上。

```
gbc.anchor = GridBagConstraints.WEST; 
```

以及 unitField 到 EAST 的锚点。

```
gbc.anchor = GridBagConstraints.EAST; 
```

对于按钮：

```
JButton button = new JButton("Test");
gbc.fill = GridBagConstraints.VERTICAL;
gbc.gridx = 3;
gbc.gridy = 0;
gbc.gridwidth = 1;
gbc.gridheight = 2;
gbc.weighty = 1;
pane.add(button, gbc); 
```

# ios - 使用图层渐变点击按钮时更改外观

> ID：12902449
> 
> 赞同：1
> 
> 时间：2012-10-15T19:13:56.993
> 
> 标签：ios, uibutton, calayer, quartz-graphics

我用了这个问题：

[如何为 iPhone 创建一个带有黑色渐变的 UIButton？](https://stackoverflow.com/questions/6936917/how-to-create-a-uibutton-with-a-black-gradient-for-iphone)

...将颜色渐变设置为我的按钮的背景，它看起来很棒，但是当我点击按钮时，它并没有明显改变，并给用户任何他们成功点击按钮的反馈。

如何为突出显示的状态或类似的东西设置第二个渐变？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T19:46:39.320

好吧，您正在设置一个子层，而不是向按钮的视图提供任何内容。子图层是直接绘制的，所以 UIButton 不认为它有任何要“突出显示”的内容。如果您希望在选择按钮时获得不同的效果，可以使用三种简单的方法。

一种是用渐变制作两张图像。按下的正常状态。这要简单得多，因为您可以根据需要设计它们，并且它是一个简单的一行，一次实现。

另一种选择是添加选择器，当您的按钮获取时以及您希望将其切换回的`UIControlEventTouchDown`任何其他[控制事件时调用这些选择器。](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIControl_Class/Reference/Reference.html#//apple_ref/occ/cl/UIControl)

最后一个简单的选项是继承 UIButton 并使用`UIResponder`touch 方法来确定何时在不同背景类型之间手动切换。

# html - 移动设备特定 css 未显示在移动设备上

> ID：12902450
> 
> 赞同：2
> 
> 时间：2012-10-15T19:14:02.033
> 
> 标签：html, css, mobile, viewport

我正在使用屏幕为 720 像素宽的三星 Galaxy Nexus 手机进行测试。这就是我试图使用仅用于移动设备的移动 css 表来调用的内容：

```
<link href="mobile.css media="only screen and (max-device-width:780px) rel="stylesheet" /> 
```

以及使用：

```
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=2.0, user-scalable=yes" /> 
```

为平板电脑扩展桌面版本。

有人可以告诉我我在这里做错了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T19:17:10.223

我更喜欢在我的主 css 文件中使用媒体查询来完成同样的事情。可以让你的生活更轻松。

# devexpress - XtraBars.PopupMenu：如何访问 PopupMenuItemLinkCollection 中的项目

> ID：12902460
> 
> 赞同：1
> 
> 时间：2012-10-15T19:14:39.580
> 
> 标签：devexpress

产品版本 9.1.2。

我正在为 Xtrabars.PopupMenu 的 BeforePopup 事件编写事件处理程序。我想禁用某些项目，并遵循我在 DevExpress 支持论坛上找到的这种方法。

```
private void popupMenu1_BeforePopup(object sender, System.EventArgs e) { 
       (sender as      DevExpress.XtraBars.PopupMenu).ItemLinks[1].Item.Enabled = ! (sender as DevExpress.XtraBars.PopupMenu).ItemLinks[1].Item.Enabled; 
} 
```

在事件处理程序中，我获取 XtraBars.PopupMenu 发送者对象，然后通过 ItemLinks 属性访问链接，如上所示。ItemLinks 返回一个 PopupMenuItemLinkCollection 类型的对象。但是这个对象是不可索引的。我找不到有关 PopupMenuItemLinkCollection 的文档。

如何访问 PopupMenuItemLinkCollection 中的项目？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T10:39:32.897

我能够通过客户端代码获取索引。
1）分配带有一些 id 的菜单（例如：）`ID="menu"`2
）将客户端代码设为
`<ClientSideEvents ItemClick="OnMenuItemClick" />`
3）

```
function OnMenuItemClick(){
var item = menu.GetSelectedItem();
} 
```

item 将为您提供当前所选菜单的索引。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T13:16:42.233

我找到了允许我访问集合中的项目的方法“get_Item”：

links.get_Item(0)

# java - 如何通过 BlueJ 编译使用 .jar 文件类的代码？

> ID：12902466
> 
> 赞同：1
> 
> 时间：2012-10-15T19:15:11.530
> 
> 标签：java, bluej

我正在使用 BlueJ 学习 java，最近我得到了一个名为 .jar 的文件`Imagen.jar`。显然，它所做的是根据作为参数给出的图像文件名返回一些像素向量。

无论如何，我应该制作一个使用名为`Imagen`. 显然，此类在上述`.jar`文件中。

显然，如果我使用这样的类，BlueJ 将不会编译，因为我没有导入它或任何东西。但是，我真的不知道如何首先导入此类。

我得到了以下示例代码：

```
import java.io.PrintWriter;

public class Main {
   public static void main(String arg[ ]){
      if(arg.length > 1){
         Imagen imagen = new Imagen(arg[0]);
         int [][] m = imagen.getMatriz();
         PrintWriter salida = null;
         try {
             salida = new PrintWriter(arg[1]);  
         }
         catch(Exception e){
            System.err.println(e);   
         }
         for(int [] fila : m ){
            for(int valor : fila){
               System.out.print("\t"+valor);
               salida.print("\t"+valor);
            }   
            salida.println("");
            System.out.println("");
         }
         if(salida!=null){
            salida.close();
         }
      }
      else {
         System.out.println("Uso: java -classpath .;Imagen.jar Main nombreArchivo.gif");  
      }
   }
} 
```

哪个不使用 BlueJ 编译。但是，正如您所看到的，最后它说要使用它，您必须在终端中输入：

```
java -classpath .;Imagen.jar Main myImageFile.gif 
```

而我做到了。但它一直在给我同样的信息。

所以我现在被困住了：

*   为什么我被告知使用的终端线路不起作用？
*   如何导入 .jar 文件中包含的类？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-15T20:20:36.197

您需要执行以下操作一次。

选择菜单选项工具 -> 首选项。在出现的对话框中，单击库选项卡。

![在此处输入图像描述](../Images/a0b846536dd02cdec0cfe7a9a458014a.png)

单击添加按钮。导航到包含 jar 文件的文件夹。选择jar文件。重新启动 BlueJ。

[从这个地方提取的答案](http://horstmann.com/gridworld/gridworld-installation.html)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-15T19:18:25.543

您需要导入 Imagen 类，因为它在 main 方法中使用。

# git - TeamCity - 让 Git 子模块保持最新？

> ID：12902469
> 
> 赞同：4
> 
> 时间：2012-10-15T19:15:35.330
> 
> 标签：git, continuous-integration, teamcity, git-submodules

我有一个包含子模块的 Git 存储库。

此存储库在 TeamCity 中有各种构建配置，这些配置依赖于子模块上的代码。TeamCity 有没有办法检测到子模块存储库已更新，然后继续更新子模块，更新父存储库以指向最新的子模块并构建代码？

我想自动找出子模块上的提交是否会破坏父存储库。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T06:00:15.587

您可以添加一个步骤，该步骤将从父 repo 中检查子模块是否有任何修改的文件。

请参阅“ [Git 告诉我我的子项目很脏，这是什么意思？](https://stackoverflow.com/questions/4873980/git-tells-me-my-subproject-is-dirty-what-does-this-mean) ”作为示例。

确保子模块未配置您的父仓库以忽略内部更改：“ [Git：我可以禁止在状态，差异等中列出'修改内容'/脏子模块条目吗？](https://stackoverflow.com/questions/3240881/git-can-i-suppress-listing-of-modified-content-dirty-submodule-entries-in-sta) ”。

# javascript - 将毫秒值添加到今天的日期并显示日期、月份和年份（日期、月份和年份都是单独的值）

> ID：12902470
> 
> 赞同：1
> 
> 时间：2012-10-15T19:15:37.190
> 
> 标签：javascript, date, selenium

我正在尝试在 Selenium 中创建一个测试脚本，我需要输入一个日期。我已经弄清楚如何使用以下方法获取日期：

storeEval var d=new Date(); d.getDate() CurrentDay
store Eval var m=new Date(); (m.getMonth()+1) CurrentMonth
storeEval var y=new Date(); y.getFullYear() 当前年份

现在我想为过去和未来的时间创建变量。有人告诉我我可以用毫秒来做到这一点，这太棒了，但我能做到的最接近的是：

storeEval new Date().getTime()+604800000 //604800000-未来7天

我回来了：1350932638018 根据我发现 的这个惊人的[计算器，这是 7 天前。](http://www.ruddwire.com/handy-code/date-to-millisecond-calculators/)

那么，我如何获取我找到的数字并提取日期、月份和年份，就像我为今天的日期所做的那样。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T19:25:30.783

如果您的未来日期存储在变量中，`d`那么它应该很简单：

```
var n = new Date(d); 
```

或者如果它没有存储在变量中，那么可能是这样的？

```
var n = new Date(Date().getTime()+604800000); 
```

然后现在`n`是一个日期对象，您应该能够使用这些`.getFullYear()`方法。

看看这个小提琴，看看它是否有帮助：http: [//jsfiddle.net/wVVmw/](http://jsfiddle.net/wVVmw/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T19:21:08.600

采用`toDateString()`

所以，

```
var newDate = (Date().getTime()+604800000).toDateString(); 
```

应该返回 2012 年 10 月 22 日星期一

我不知道 selenium，但它看起来像 JavaScript。

# connection - IRobotSoft 任务期间 Internet 断开连接。使用超时？

> ID：12902471
> 
> 赞同：0
> 
> 时间：2012-10-15T19:15:43.060
> 
> 标签：connection

我正在使用 IRobotSoft 软件进行 Web Scramming。这是一个很棒的程序，但我有一个问题。

当我运行任务时，我的互联网连接中断了。当它再次出现时，“获取链接列表”任务变得疯狂，然后机器人停止了。

有谁知道我应该在“获取链接列表”属性中使用什么来执行“超时”并等到互联网再次出现？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T05:07:23.920

你可以参考这篇文章： http://irobotsoft.org/bb/YaBB.pl?num= [1351094039](http://irobotsoft.org/bb/YaBB.pl?num=1351094039)

> - 创建一个名为“timeout-refresh”的任务。在任务中，添加计划操作，并添加事件：
> 
> > 事件：在每个元组之后；条件：_TimeoutN<=100；名称：_TimeoutRetryUrl；值：刷新；值类型：字符串值
> 
> - 然后在您的主要任务中，为您的第一个操作添加一个事件：
> 
> > 事件：在每个元组之后；名称：_TimeoutTask；值：超时刷新；值类型：字符串值
> 
> 这将允许每次超时重试至少 100 次。您也可以将 100 更改为其他值。

# spring - Spring MVC 3.0 中的自定义验证 - 将 @Model 传递给验证器

> ID：12902472
> 
> 赞同：0
> 
> 时间：2012-10-15T19:15:44.153
> 
> 标签：spring, spring-mvc

我正在尝试在 Spring MVC 应用程序中编写自定义验证器。我想知道是否有办法将@Model 对象传递给自定义弹簧验证器？

说，我有一个 Person 对象和 Account 对象。我必须编写一个自定义验证器来验证 Person，但验证取决于 Account 对象和会话中的其他对象。

例如，Person 不能拥有超过 3 个帐户，帐户类型必须是特定类别且不超过 3 年（此值，即年数是动态的，基于登录的配置文件并处于会话状态）。

如何将两个对象，尤其是 @Model 传递给验证器。

```
public class ServiceValidator implements Validator {

@Autowired
private ServiceDAO servicesDao;

@Override
public boolean supports(Class<?> clasz) {
    return clasz.isAssignableFrom(Person.class);
}

@Override
public void validate(Object obj, Errors errors) {
     Person subscriber = (Person) obj;
    // How can I access @Model object here ???

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T19:36:46.497

怀疑是否可以，但有两种解决方法：

**一种。**如果它是您要查找的持久数据，则最好在验证器中再次检索它并使用该数据进行验证，例如，在您的情况下，如果您正在验证个人和个人帐户详细信息，则可以从数据库中检索，然后从数据库中获取它并使用检索到的数据在您的验证器中进行验证。

**湾。**如果您需要使用验证器的地方数量相当有限，这可能是一种更好的方法：

```
public class ServiceValidator {

@Autowired
private ServiceDAO servicesDao;

public void validate(Person subscriber, List<Account> accounts, ..., Errors errors) {

} 
```

只需从您的请求映射方法中直接调用上述验证器..

在你的控制器中..

```
List<Account> accounts = //retrieve from session
serviceValidator.validate(subscriber, accounts, ...errors);
if (errors.hasErrors())..
else.. 
```

# python - 如何访问字典值以与 python 中的 urllib 模块一起使用？

> ID：12902473
> 
> 赞同：2
> 
> 时间：2012-10-15T19:15:46.117
> 
> 标签：python, dictionary, python-2.7, key, urllib

示例-我有以下字典...

```
URLDict = {'OTX2':'http://lsdb.hgu.mrc.ac.uk/variants.php?select_db=OTX2&action=view_all',
'RAB3GAP':'http://lsdb.hgu.mrc.ac.uk/variants.php?select_db=RAB3GAP1&action=view_all',
'SOX2':'http://lsdb.hgu.mrc.ac.uk/variants.php?select_db=SOX2&action=view_all',
'STRA6':'http://lsdb.hgu.mrc.ac.uk/variants.php?select_db=STRA6&action=view_all',
'MLYCD':'http://lsdb.hgu.mrc.ac.uk/variants.php?select_db=MLYCD&action=view_all'} 
```

我想使用 urllib 在 for 循环中调用每个 url，怎么做？

我已经使用像这样的列表格式的网址成功地做到了这一点......

```
OTX2 = 'http://lsdb.hgu.mrc.ac.uk/variants.php?select_db=OTX2&action=view_all'
RAB3GAP = 'http://lsdb.hgu.mrc.ac.uk/variants.php?select_db=RAB3GAP1&action=view_all'
SOX2 = 'http://lsdb.hgu.mrc.ac.uk/variants.php?select_db=SOX2&action=view_all'
STRA6 = 'http://lsdb.hgu.mrc.ac.uk/variants.php?select_db=STRA6&action=view_all'
MLYCD = 'http://lsdb.hgu.mrc.ac.uk/variants.php?select_db=MLYCD&action=view_all'

URLList = [OTX2,RAB3GAP,SOX2,STRA6,PAX6,MLYCD]

for URL in URLList:                                                        
    sourcepage = urllib.urlopen(URL)                                     
    sourcetext = sourcepage.read() 
```

但我也希望稍后在返回数据时能够打印密钥。使用列表格式，键将是一个变量，因此无法访问它进行打印，我只能打印该值。

谢谢你的帮助。

汤姆

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-15T19:18:18.357

您是否尝试过（作为一个简单的示例）：

```
for key, value in URLDict.iteritems():
    print key, value 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-15T19:20:27.197

看起来甚至不需要字典。

```
dbs = ['OTX2', 'RAB3GAP', 'SOX2', 'STRA6', 'PAX6', 'MLYCD']
urlbase = 'http://lsdb.hgu.mrc.ac.uk/variants.php?select_db=%s&action=view_all'

for db in dbs:
    sourcepage = urllib.urlopen(urlbase % db)
    sourcetext = sourcepage.read() 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-15T19:41:07.370

我会这样做：

```
for url_key in URLDict:
    URL = URLDict[url_key]

    sourcepage = urllib.urlopen(URL)
    sourcetext = sourcepage.read() 
```

url 显然是`URLDict[url_key]`，您可以保留`key`name 中的值`url_key`。举个例子：

```
print url_key 
```

在第一次迭代将打印`OTX2`.

# drupal-7 - 我可以将 Drupal 的评论部分用于另一个 Java 应用程序吗？

> ID：12902475
> 
> 赞同：2
> 
> 时间：2012-10-15T19:15:49.673
> 
> 标签：drupal-7

我们正在开发一个基于 Java 的 Web 应用程序。此应用程序需要评论功能。商业上可用的评论服务（http://aboutecho.com/ 或[http://www.livefyre.com/](http://www.livefyre.com/)等）不在我的预算之内。我可以在我的 Java 应用程序中使用 Drupal 的评论功能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T16:32:41.393

恐怕drupal中没有现成的解决方案。

但是使用drupal 来支持你的java 应用程序的注释是完全可能的。恐怕您必须进行一些自定义编码才能实现。

安装[drupal 7](http://drupal.org)和一个名为[services](http://drupal.org/project/services)的 contrib 模块。通过安装服务，您可以将 drupal 的资源扩展为服务资源。我建议启用 REST 服务器（服务的子模块）并使用它与 drupal 进行通信。

# google-tv - 是否有支持立体 3D 视频内容的 Google TV API？

> ID：12902479
> 
> 赞同：2
> 
> 时间：2012-10-15T19:16:12.750
> 
> 标签：google-tv

LG Google TV 有一个支持 3D 的 3D 世界应用程序。该应用程序会自动触发电视的 3D 模式。在我们自己的应用程序中做同样事情的 API 是什么？

最终目标是播放 3D MKV 文件。

[编辑] 我们可以对 3D 世界应用程序使用的 API 进行逆向工程吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T20:56:36.850

Kristan 在 00:47 的 Google TV 开发者环聊中回答了这个问题。

[https://developers.google.com/live/shows/7594037-6001/](https://developers.google.com/live/shows/7594037-6001/)

答案是：不，没有 API，所以您应该提出功能请求。LG 可以做到这一点，因为他们是 OEM 合作伙伴并且可以扩展访问功能。

# java - 变量更改无法识别

> ID：12902482
> 
> 赞同：1
> 
> 时间：2012-10-15T19:16:40.050
> 
> 标签：java, variables

我对java很陌生，但遇到了一个我不明白的问题。我想要一个 jbutton 来显示一个窗口并隐藏另一个。当按下 jbutton 时，我通过一个无限循环监听变量变化来做到这一点。

```
private void jButton1MouseClicked(java.awt.event.MouseEvent evt) { //Jbutton in question
      NewJFrame frame = new NewJFrame(); //another JFrame from which I created the public variable(Visible)
      frame.Visible = false;
} 

    while (always == true) {     **//code in main method to test variable change** 
        if (frame1.Visible == true) {
            frame1.show();
            frame2.hide();
        }
        else {
            frame1.show();
            frame2.hide();
        } 
```

有趣的是，当我对创建公共变量（可见）的 JFrame 内的按钮执行相同操作时，这有效，AKA：[if] 部分，但 else 不执行。

我可以做些什么来让 Main 方法来识别这个变量的变化吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-15T19:18:57.773

我认为你有一个逻辑错误。

你说`if(frame1.Visible)`那`frame1.show()`。但`frame1`已经是可见的了！看起来你从来没有隐藏它。

我的猜测是你的意图是：

```
 if (frame1.Visible == true) {
        frame1.hide();
        frame2.show();
    } 
```

此外，作为旁注，您不必使用`== true`或`== false`使用布尔值。它们将在条件中自动评估为它们所代表的任何值。

# delphi - 为什么在更改文件属性时会丢失 UTF-8 BOM？

> ID：12902484
> 
> 赞同：0
> 
> 时间：2012-10-15T19:16:43.187
> 
> 标签：delphi, utf-8, byte-order-mark, file-attributes

我有一个测试 Delphi 应用程序，它使用 TFileStream 将 UTF-8 BOM 写入文本文件，然后是一个虚拟的文本行。

一切都按预期工作，并且使用 Notepad++ 的十六进制查看器插件，我在输出文本文件中看到了 BOM。但是，如果我在重新打开文件时更改文本文件的属性（在 Delphi 中以编程方式或通过 Windows 资源管理器），则 BOM 已被删除。

将 BOM 和虚拟数据写入文件的示例代码：

```
procedure TForm1.Button1Click(Sender: TObject);
const
  cFilename = 'myfile.txt';
var
  fs : TFileStream;
  gBOM : TBytes;
  gStr : RawByteString;
begin
  fs := TFileStream.Create(cFilename, fmCreate, fmShareDenyWrite);
  try
    gBOM := TEncoding.UTF8.GetPreamble;
    fs.WriteBuffer(PAnsiChar(gBOM)^, Length(gBOM));

    // Dummy data
    gStr := UTF8Encode('Dummy string') + AnsiChar(#13) + AnsiChar(#10);
    fs.WriteBuffer(PAnsiChar(gStr)^, Length(gStr));

    // If you read the file now the BOM will be present, however
    // the follow line appears to remove it.
    FileSetAttr(cFilename, faReadOnly);

  finally
    FreeAndNil(fs);
  end;
end; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-15T20:47:43.677

设置文件属性对文件的现有内容没有影响。BOM 消失的唯一方法是将文件的内容复制到省略 BOM 的新文件中。设置属性不会这样做。

请记住，您正在使用相对文件路径，因此您的机器上可能有多个文件副本并且正在查看错误的文件。始终使用完整路径。

将 BOM 和文本写入文件的更简单方法`TEncoding`是使用`TStreamWriter`类。

您应该`FileSetAttr()`在关闭文件后调用以确保它真正生效，并且您需要在调用`FileGetAttr()`之前调用`FileSetAttr()`以确保正确保留现有属性。

试试这个：

```
procedure TForm1.Button1Click(Sender: TObject); 
const 
  cFilename = 'c:\path to\myfile.txt'; 
var 
  sw : TStreamWriter;
  Attrs: Integer; 
begin 
  sw := TStreamWriter.Create(cFilename, False, TEncoding.UTF8); 
  try 
    sw.WriteLine('Dummy string');
  finally 
    sw.Free; 
  end; 
  Attrs := FileGetAttr(cFilename);
  if Attrs <> -1 then 
    FileSetAttr(cFilename, Attrs or faReadOnly); 
end; 
```

或者：

```
// GetFileInformationByHandle() is declared in Windows.pas, but SetFileInformationByHandle() is not!

type
  _FILE_INFO_BY_HANDLE_CLASS = ( 
    FileBasicInfo,
    FileStandardInfo,
    FileNameInfo,
    FileRenameInfo,
    FileDispositionInfo,
    FileAllocationInfo,
    FileEndOfFileInfo,
    FileStreamInfo,
    FileCompressionInfo,
    FileAttributeTagInfo,
    FileIdBothDirectoryInfo
);
FILE_INFO_BY_HANDLE_CLASS = _FILE_INFO_BY_HANDLE_CLASS;

_FILE_BASIC_INFO = record
  CreationTime: LARGE_INTEGER;
  LastAccessTime: LARGE_INTEGER;
  LastWriteTime: LARGE_INTEGER;
  ChangeTime: LARGE_INTEGER;
  FileAttributes: DWORD;
end;
FILE_BASIC_INFO = _FILE_BASIC_INFO;

function SetFileInformationByHandle(hFile: THandle; FileInformationClass: FILE_INFO_BY_HANDLE_CLASS; lpFileInformation: Pointer; dwBufferSize: DWORD): BOOL; stdcall; external 'kernel32' delayed;

procedure TForm1.Button1Click(Sender: TObject); 
const 
  cFilename = 'c:\path to\myfile.txt'; 
var 
  sw : TStreamWriter;
  fi: TByHandleFileInformation;
  bi: FILE_BASIC_INFO;
  Attrs: Integer;
  AttrsSet: Boolean;
begin 
  AttrsSet := False;

  sw := TStreamWriter.Create(cFilename, False, TEncoding.UTF8); 
  try 
    sw.WriteLine('Dummy string');

    if CheckWin32Version(6, 0) then
    begin
      if GetFileInformationByHandle(TFileStream(sw.BaseStream).Handle, fi) then
      begin
        bi.CreationTime.LowPart := fi.ftCreationTime.dwLowDateTime;
        bi.CreationTime.HighPart := fi.ftCreationTime.dwHighDateTime;

        bi.LastAccessTime.LowPart := fi.ftLastAccessTime.dwLowDateTime;
        bi.LastAccessTime.HighPart := fi.ftLastAccessTime.dwHighDateTime;

        bi.LastWriteTime.LowPart := fi.ftLastWriteTime.dwLowDateTime;
        bi.LastWriteTime.HighPart := fi.ftLastWriteTime.dwHighDateTime;

        bi.ChangeTime := bi.LastWriteTime;

        bi.FileAttributes := fi.dwFileAttributes or FILE_ATTRIBUTE_READONLY;
        AttrsSet := SetFileInformationByHandle(TFileStream(sw.BaseStream).Handle, FileBasicInfo, @bi, SizeOf(bi));
      end;
  finally 
    sw.Free; 
  end; 

  if not AttrsSet then
  begin
    Attrs := FileGetAttr(cFilename);
    if Attrs <> -1 then 
      FileSetAttr(cFilename, Attrs or faReadOnly); 
  end;
end; 
```

# unix - Unix中两个命令的管道内衬期间的系统调用

> ID：12902485
> 
> 赞同：0
> 
> 时间：2012-10-15T19:16:44.963
> 
> 标签：unix, systems-programming

当我们在终端上编写`ls -l | wc -l`命令时，内核级别内部会进行哪些系统调用？以及我们如何验证所有这些系统调用。

# java - 在 Java Lucene 库中查找给定单词的计数

> ID：12902490
> 
> 赞同：0
> 
> 时间：2012-10-15T19:17:14.403
> 
> 标签：java, lucene

在 Lucene 的教程中（[http://www.lucenetutorial.com/lucene-in-5-minutes.html](http://www.lucenetutorial.com/lucene-in-5-minutes.html)），

```
public class HelloLucene {
public static void main(String[] args) throws IOException, ParseException {
IndexWriter w = new IndexWriter(index, config);
         addDoc(w, "Lucene lucene in Action");
         addDoc(w, "Lucene for Dummies");
         addDoc(w, "Managing Gigabytes");
         addDoc(w, "The Art of Computer Science");
         w.close();
String querystr = args.length > 0 ? args[0] : "lucene";
//...
 }
} 
```

当我如上所示将字符串更改为“Lucene lucene in Action”时，然后在文档中搜索关键字“lucene”，它会找到字符串“Lucene lucene in Action”的命中数为 1。我想发送一个字符串（例如“asd asd fds asd”）来运行并搜索“asd”并找到结果 3\. 如何使用查询 addDoc(w, "asd asd fds asd"); ？？？

它没有给出所选行中的命中数。如果有一个或多个命中，则写入 1，如果没有，则写入 0。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T19:37:48.287

我相信您正在寻找的是术语向量频率的计算。

在他们身上看到这个问题 -[如何计算一组文档的词频？](https://stackoverflow.com/questions/2924089/how-to-count-term-frequency-for-set-of-documents)

而这 -[从 Lucene 索引中获取最高频率项](https://stackoverflow.com/questions/2821903/get-highest-frequency-terms-from-lucene-index/2822220#2822220)

如果我理解这个问题，您是在问如何计算输入短语（例如“asd”）在索引中的文档中出现的次数。在这种情况下，您需要计算词向量频率并比较您的搜索查询以确定是否存在匹配项和相应的出现次数。请记住，这将有助于匹配整个单词，并且并非旨在用于在索引文档语料库中对术语进行全文邻近搜索。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T19:48:56.850

我怀疑您可能会误解您的示例中的某些内容。

我没有在其中看到任何示例正在收集匹配文档中匹配项的数量。也许作者使用这个词是“命中”，这在某种程度上使事情变得混乱。

那里的`hits`变量将匹配的文档 ID 和分数存储在[ScoreDoc](http://lucene.apache.org/core/old_versioned_docs/versions/3_5_0/api/all/org/apache/lucene/search/ScoreDoc.html)的集合中。这`hits[index].score`是确定文档匹配强度的最合适的方法。

# c# - ZedGraph 图：抛出 System.OutOfMemoryException

> ID：12902492
> 
> 赞同：1
> 
> 时间：2012-10-15T19:17:18.123
> 
> 标签：c#, zedgraph

我已经编写或者尝试使用 ZedGraph 在 C# 中绘制可用空间薛定谔方程，并在运行创建的可执行文件时遇到 System.OutOfMemoryException 错误。

```
************** Exception Text **************
System.OutOfMemoryException: Exception of type 'System.OutOfMemoryException' was thrown.
   at System.Collections.Generic.List`1.set_Capacity(Int32 value)
   at System.Collections.Generic.List`1.EnsureCapacity(Int32 min)
   at System.Collections.Generic.List`1.Add(T item)
   at ZedGraph.PointPairList.Add(Double x, Double y)
   at Wavepacket.Form1.CreateGraph(ZedGraphControl schrodinger) in C:\Users\user1748005\Documents\Visual Studio 2010\Projects\Wavepacket\Wavepacket\Form1.cs:line 72
   at Wavepacket.Form1.Form1_Load(Object sender, EventArgs e) in C:\Users\user1748005\Documents\Visual Studio 2010\Projects\Wavepacket\Wavepacket\Form1.cs:line 35
   at System.Windows.Forms.Form.OnLoad(EventArgs e)
   at System.Windows.Forms.Form.OnCreateControl()
   at System.Windows.Forms.Control.CreateControl(Boolean fIgnoreVisible)
   at System.Windows.Forms.Control.CreateControl()
   at System.Windows.Forms.Control.WmShowWindow(Message& m)
   at System.Windows.Forms.Control.WndProc(Message& m)
   at System.Windows.Forms.ScrollableControl.WndProc(Message& m)
   at System.Windows.Forms.Form.WmShowWindow(Message& m)
   at System.Windows.Forms.Form.WndProc(Message& m)
   at System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message& m)
   at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message& m)
   at System.Windows.Forms.NativeWindow.Callback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam) 
```

我的 Cmplx 类的必要函数/构造函数相对简单，如下所示：

```
 public Cmplx(double r, double i)
    {
        this.real = r;
        this.imag = i;
    }

    public double Real
    {
        get { return this.real; }
        set { this.real = value; }
    }

    public double Imag
    {
        get { return this.imag; }
        set { this.imag = value; }
    }
    public Cmplx Multiply(Cmplx b)
    {
        return new Cmplx((this.real * b.real - this.imag * b.imag), (b.imag * this.real + this.imag * b.real));
    }

    public Cmplx Divide(Cmplx b)
    {
        return new Cmplx((this.real * b.real + this.imag * b.imag) / (b.real * b.real + b.imag * b.imag), (b.real * this.imag - this.real * b.imag) / (b.real * b.real + b.imag * b.imag));
    }

    public Cmplx Scale(Double b)
    {
        return new Cmplx(this.real * b, this.imag * b);
    }

    public double Mod()
    {
        return Math.Sqrt(this.real * this.real + this.imag * this.imag);
    }

    public Cmplx Sqrt()
    {
        double r, theta;
        r = this.Mod();
        theta = this.Arg();

        return new Cmplx(Math.Sqrt(r) * (Math.Cos(theta / 2)), Math.Sqrt(r) * Math.Sin(theta / 2));
    }

    public Cmplx Exp()
    {
        double x, y, z;
        x = Math.Exp(this.real);
        y = Math.Cos(this.imag);
        z = Math.Sin(this.imag);

        return new Cmplx(x * y, x * z);
    } 
```

下面是我的 ZedGraph 方法，其中只有从 Codeproject ZedGraph 教程修改的 CreateGraph 方法：

```
 public Form1()
    {
        InitializeComponent();
    }

    private void Form1_Resize(object sender, EventArgs e)
    {
        SetSize();
    }

    private void SetSize()
    {
        zedGraphControl1.Location = new Point(10, 10);
        zedGraphControl1.Size = new Size(ClientRectangle.Width - 20,
                                ClientRectangle.Height - 20);
    }

    private void Form1_Load(object sender, EventArgs e)
    {
        CreateGraph(zedGraphControl1);
        SetSize();
    }

    private void CreateGraph(ZedGraphControl schrodinger)
    {
        GraphPane myPane = schrodinger.GraphPane;

        myPane.Title.Text = "Free Space Schrodinger Equation)";
        myPane.XAxis.Title.Text = "Time (s)";
        myPane.YAxis.Title.Text = "Psi";

        double alpha, beta, norm, k0, t;
        double L,N;

        L = 25;
        N = 4096;
        alpha = 0.5;
        beta = 0.5785;  
        k0 = 1;
        t = 0;
        norm = (Math.Exp(-k0 * k0 * alpha)) * (Math.Pow((alpha / (2 * Math.PI)), 0.25));

        PointPairList list1 = new PointPairList();

        for (double i = -L; i <= L; i -= (-2L) / N)
        {
            Cmplx gamma = new Cmplx(alpha, beta * t);
            Cmplx a = new Cmplx(2 * alpha * k0, 0);
            a.Imag = i;
            Cmplx b = a.Multiply(a);
            Cmplx phi = (((b.Divide(gamma.Scale(4))).Exp()).Scale(norm)).Divide(gamma.Sqrt());
            list1.Add(phi.Mod(),i);
        }

        LineItem myCurve = myPane.AddCurve("t=0",
              list1, Color.Red, SymbolType.Default);
        schrodinger.AxisChange();
    } 
```

我改变了

```
list1.Add(phi.Mod(), i); 
```

上述代码块的 for 循环中的行到

```
Console.WriteLine("{0}, {1}", phi.Mod(), i); 
```

这可以按预期工作，尽管在命令行界面中。使用 ZedGraph 库结果的 Windows 窗体应用程序在引发上述异常之前消耗了大约 1.7GB 的 RAM。

我通过绘制大量数据点找到了 ZedGraph 内存不足的实例

[绘制海量数据图表](https://stackoverflow.com/questions/4817960/charting-massive-amounts-of-data)

但是，我不太倾向于我绘制的 4096 个数据点会导致这种内存消耗，而宁愿指责我的（缺乏）编程技能

**注意**：这是一项学术作业，因此提供的任何帮助都应考虑到这一点。干杯!

**编辑**：将 L 和 N 的初始化固定为整数而不是双精度数。如前所述，问题仍然存在。

**EDIT2**我是个白痴。我在我的测试 CLI 项目中将 L 和 N 的初始化更改为双精度，但未能更新 Windows 窗体应用程序的源代码。感谢 Jeppe Stig Nielsen 为我指明了正确的方向。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T19:26:00.683

检查你的`for`循环。看起来有一个减号 ( `-`) 太多了。

此外，您的除法（缺少`(-2*L) / N`星号）将给出**零**，因为它是**整数**除法。要解决此问题，请将一个因素转换为，或简单地编写：`*`****`double`****

 ****```
2.0 * L / N 
```

请注意，它`.0`表示一个浮点数 ( `System.Double`)，这将强制“步骤”的整个计算根据需要使用浮点执行。

总结一下：如果您的步数为零或方向错误，您将继续添加点，`list1`直到内存不足。也许这个`for`循环更好（但你自己测试一下）：

```
for (double i = -L; i <= L; i += (2.0 * L) / N) 
```****

# php - 让 Json 进入数组 php

> ID：12902494
> 
> 赞同：0
> 
> 时间：2012-10-15T19:17:29.380
> 
> 标签：php

我花了很长时间在互联网上搜索，但是我找不到解决这个问题的方法。

```
$follow = $_GET['follow'];
$following = $_GET['following'];

session_start();

if(!empty($_SESSION['username'])){
$twitteroauth = new TwitterOAuth('MY PRIVATE CODE', 'MY PRIVATE CODE', $_SESSION['oauth_token'], $_SESSION['oauth_secret']);
}

$follow_timeline = $twitteroauth->get('followers/ids', array('screen_name' => $follow));
$following_timeline = $twitteroauth->get('friends/ids', array('screen_name' =>     $following));

if (in_array($following, $follow_timeline)) {
echo "We found the word!";
} 
```

它是来自 json 文件的数据。你也可以阅读这个。[https://dev.twitter.com/docs/api/1/get/friends/ids](https://dev.twitter.com/docs/api/1/get/friends/ids) & [https://dev.twitter.com/docs/api/1/get/followers/ids](https://dev.twitter.com/docs/api/1/get/followers/ids)。当我运行上面编写的脚本时，它会显示此错误。

```
in_array() [function.in-array]: Wrong datatype for second argument in 
```

我考虑过在之前使用 json decode`if (in_array($following, $follow_timeline))`但它会显示这个错误。

```
json_decode() expects parameter 1 to be string, object given in 
```

请有人帮忙。我刚开始使用 php，发现它有点令人困惑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T19:19:25.917

你定义`$following_timeline`，然后你尝试使用`$follow_timeline`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T19:24:10.830

查看 in_array() 的文档 ....http://php.net/manual/en/function.in-array.php

第二个参数（$follow_timeline）应该是一个数组……你确定 $twitteroauth->get() 方法返回一个数组吗？

# visual-studio-2010 - CUDA Toolkit 5 生产版本和 Visual Studio 2010 集成

> ID：12902495
> 
> 赞同：2
> 
> 时间：2012-10-15T19:17:32.647
> 
> 标签：visual-studio-2010, cuda

在没有 NVidia CUDA 论坛的情况下，有人知道如何解决这个问题吗？看起来CUDA工具包的VS集成有问题。

我刚刚安装了 CUDA 工具包 5 的生产发布版本（Windows 7 上的笔记本电脑为 32 位），替换了候选发布版本（效果很好），现在我无法编译或构建任何东西，包括 CUDA 示例。

我尝试过的所有操作都会出现错误，例如： ...BuildCustomizations\CUDA 5.0.targets(360,9): error MSB4062: The "Nvda.Build.CudaTasks.ResolvePaths" task could not be loaded from the assembly C:\Program Files (x86)\MSBuild\Microsoft.Cpp\v4.0\BuildCustomizations\Nvda.Build.CudaTasks.v5.0.dll。确认声明正确，程序集及其所有依赖项都可用，并且任务包含实现 Microsoft.Build.Framework.ITask 的公共类。

“CUDA 5.0.targets”文件（它是一个 XML 文件）有几个 UsingTask 元素，我没有看到对提到的 ITask 类的任何引用，但我不愿意开始编辑我不理解的文件。

如果我切换 Build Customisations，CUDA 4.2 也会出现类似的错误。

这是使用 Visual Studio 2010 Professional。非 CUDA 项目仍在编译和构建。

关于从哪里开始的任何建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T05:27:41.090

要修复，您需要安装 64 位 CUDA 5.0.32 SDK（CUDA 5.0 的最新版本）。它包含比 32 位安装程序更新的 Nvda.Build.CudaTasks.v5.0.dll 版本（修改日期是 25/09/2012 而不是 2012 年 5 月）。

我无法将 Dll 复制到正确的位置，因为它正在被另一个进程使用。为了解决这个问题，我使用带有 CMD 提示符的 Windows SAFE_MODE 执行的批处理文件（在启动时使用 F8 来选择安全模式启动选项）。

批处理命令（在我的 64 位 Windows 系统上工作）：复制“[YOUR INSTALL PATH]\CUDA\v5.0\extras\visual_studio_integration\MSBuildExtensions\Nvda.Build.CudaTasks.v5.0.dll”“C:\程序文件 (x86)\MSBuild\Microsoft.Cpp\v4.0\BuildCustomizations"

确保您的道具和目标也从 SDK 安装文件夹中复制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-09T22:52:22.560

此问题可能是由于 Microsoft .NET Framework 功能被关闭所致。

我回答了另一个和你一样的问题。

[https://stackoverflow.com/a/21666179/2700726](https://stackoverflow.com/a/21666179/2700726)

# linux - 将标题添加到制表符分隔的文件

> ID：12902497
> 
> 赞同：14
> 
> 时间：2012-10-15T19:17:50.460
> 
> 标签：linux, unix, sed, awk, cat

我想在制表符分隔的文件中添加标头，但我不确定如何在 linux 的一行中执行此操作。

假设我的文件是：

```
roger\t18\tcolumbia\tnew york\n
albert\t21\tdartmouth\tnew london\n
etc... 
```

现在我想添加一个标题，上面写着：

```
name\tage\tuniversity\tcity 
```

我将如何在 linux 的一行中做到这一点？我对 awk、sed、cat 等很满意。不过，对 perl 一点也不熟悉。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-10-15T19:22:10.473

没有像“append”操作符那样的“prepend”操作符`>>`，但是您可以将标头写入临时文件，然后将文件的内容复制到临时文件中，然后将其移回：

```
echo -e "name\tage\tuniversity\tcity" | cat - yourfile > /tmp/out && mv /tmp/out yourfile 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-10-15T19:21:56.510

```
$ { printf 'name\tage\tuniversity\tcity\n'; cat orig-file; } > new-file 
```

或者

```
$ printf '1\ni\nname\tage\tuniversity\tcity\n.\nw\n' | ed -s orig-file 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-10-15T19:45:05.360

就个人而言，我会选择; `nano -w file.txt`-)（即只使用文本编辑器，当然不必是纳米）

但是，如果您出于某种原因想在非交互式环境中执行此操作，则可以使用`cat`各种串联：

```
echo $'name\tage\tuniversity\tcity' | cat - file.txt > file2.txt 
```

将添加标题并将输出放入`file2.txt`. 如果要覆盖原始文件，可以使用

```
echo $'name\tage\tuniversity\tcity' | cat - file.txt > file2.txt; mv file{2,}.txt 
```

或者你可以使用`sed`如下：

```
sed -i $'1 i\\\nname\tage\tuniversity\tcity' file.txt 
```

请注意，我使用`$'...'`引号允许我用来`\t`表示制表符和`\n`表示换行符（以及其他替换；有关更多信息，请参见 bash 手册页）。在这种带引号的字符串中，`\\`表示文字反斜杠。所以传递给 sed 的程序实际上是

```
1 i\
name    age     university      city 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-10-16T06:09:57.510

```
perl -i -lne 'if($.==1){print "newline\n$_"}else{print}' your_file 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-15T19:21:11.520

首先创建一个带有标题内容的文件：

```
$ cat >header
name^Iage^Iuniversity^Icity (return)
^D 
```

（`^I`tab键在哪里）

然后将其添加到数据中

```
$ cat header myfile >newfile
$ mv newfile myfile 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-11-09T09:01:24.857

```
cat <(head -1 theFileWithHeader) theFileWithoutHeader > newfile;
mv newfile theFileWithoutHeader; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-03-14T09:41:14.557

习惯性`awk`的回答。

```
awk 'BEGIN { print "name\tage\tuniversity\tcity" } { print }' yourfile > /tmp/out && mv /tmp/out yourfile 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-03-14T12:51:12.137

无需`sed`临时文件

```
sed -i "s#^#name\tage\tuniversity\tcity#g#" 
```

演示：

```
 $ cat file1.txt
roger\t18\tcolumbia\tnew york\n
albert\t21\tdartmouth\tnew london\n
etc...
$ sed -i "s#^#name\tage\tuniversity\tcity#g#" file1.txt $ cat file1.txt
name    age     university      cityroger\t18\tcolumbia\tnew york\n
name    age     university      cityalbert\t21\tdartmouth\tnew london\n
name    age     university      cityetc...
$ 
```

# iphone - 从 ABPeoplePickerNavigationController 获取人员时缺少数据

> ID：12902500
> 
> 赞同：0
> 
> 时间：2012-10-15T19:17:54.963
> 
> 标签：iphone, objective-c, ios, abaddressbook

我对 AddressBook 框架有奇怪的行为。我正在以这种方式创建和显示人员选择器控制器：

```
ABPeoplePickerNavigationController *picker = [[ABPeoplePickerNavigationController alloc] init];
picker.peoplePickerDelegate = self;
NSArray *displayedItems = [NSArray arrayWithObjects:[NSNumber numberWithInt:kABPersonFirstNameProperty], [NSNumber numberWithInt:kABPersonLastNameProperty], nil];
picker.displayedProperties = displayedItems;
[self presentViewController: picker animated:YES completion: nil]; 
```

然后在委托中，我有以下内容：

```
- (BOOL)peoplePickerNavigationController:(ABPeoplePickerNavigationController *)peoplePicker shouldContinueAfterSelectingPerson:(ABRecordRef)person
{
    myPersonRec = person;
    [self dismissViewControllerAnimated:YES completion: nil];
    return NO;
} 
```

稍后当我尝试访问 myPersonRec 属性时，我只能读取名字和姓氏（显示在人员选择器中），所有其他属性都为零。如果我将返回值更改为`YES`，我将获得电话号码和所有东西，但无论如何都无法获得人的图像。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T14:02:12.460

找到问题源：

`ABPerson`对象不会一次全部加载到内存中。它被部分加载，并在需要时加载新字段或图像，并且要正确加载，该对象应绑定到现有`ABAddressBook`实例。当我使用人员选择器视图控制器时，它引用了它自己的`ABAddressBook`实例，该实例在选择器被解除后释放，因此在视图控制器解除后我无法获得任何新数据（但之前加载的条目仍然可以访问）。

为了解决这个问题，我`ABAddressBook`在我的模型类单例中创建了一个共享实例，并在需要时使用它。因为我只是从通讯录中阅读，所以应该是很好的解决方案。

所以，选择器创建代码最终应该是这样的：

```
ABPeoplePickerNavigationController *picker = [[ABPeoplePickerNavigationController alloc] init];
picker.peoplePickerDelegate = self;
NSArray *displayedItems = [NSArray arrayWithObjects:[NSNumber numberWithInt:kABPersonFirstNameProperty], [NSNumber numberWithInt:kABPersonLastNameProperty], nil];
picker.displayedProperties = displayedItems;
picker.addressBook = [[MyModel instance] sharedAddressBookRef];
[self presentViewController: picker animated:YES completion: nil]; 
```

# javascript - JavaScript 框架仅订阅和触发自定义事件？

> ID：12902501
> 
> 赞同：4
> 
> 时间：2012-10-15T19:18:01.890
> 
> 标签：javascript, events, backbone.js, frameworks

JavaScript 框架仅监听/订阅和触发/触发类似于 Backbone.Events 的自定义事件？

只是好奇我是否缺少任何 JS 迷你/微型框架/lib ......

[Backbone.Events](http://backbonejs.org/#Events)这样做，但任何小型框架/lib*只是*这样做，还是更简单/更好？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-21T15:05:00.867

最简单的方法 - 如果你使用 jQuery - 是使用**[jQuery.trigger](http://api.jquery.com/trigger/)**（相当于发布）和**[jQuery.bind](http://api.jquery.com/bind/)**（相当于订阅）。还有**[jQuery.unbind](http://api.jquery.com/unbind/)**（取消订阅）。

您可以将它们与 DOM 事件以及自定义事件一起使用。

```
//Subsribe to my custom Event
$(document).bind('MyCustomEvent', function() {
  alert('Reacting to my custom event ..');
});

// .... somewhere else in the code, publish the event
jQuery.event.trigger('MyCustomEvent');
//or $(document).trigger('MyCustomEvent'); 
```

> **[从 jquery 文档更新]**
> 
> （从 jQuery 1.7 开始，首选 .on() 和 .off() 方法来附加和删除元素上的事件处理程序。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-15T19:30:45.313

我与使用[发布/订阅](http://en.wikipedia.org/wiki/Publish/subscribe)模式的[卓别林一起工作。](https://github.com/chaplinjs/chaplin) 您可以寻找一些“中介”，例如[Core.js](http://oscargodson.github.com/Core.js/)、[PubSub](https://github.com/mroderick/PubSubJS)或[Signal-js](http://millermedeiros.github.com/js-signals/)。[在这篇文章中](https://stackoverflow.com/questions/7991607/best-publish-subscribe-library-in-javascript) 引用和用户反馈。

# ruby - 无法使用 Capybara 和 Mechanize 下载 pdf 文件

> ID：12902508
> 
> 赞同：1
> 
> 时间：2012-10-15T19:18:28.597
> 
> 标签：ruby, capybara, mechanize

我有一个 ruby​​ 应用程序，它尝试使用 Capybara 和 Mechanize 下载大约 40 个 pdf 文件：

```
require 'rubygems'
require 'mechanize'
agent = Mechanize.new
agnet.get("https://site.com/file.pdf") 
```

当我到达第 25 个 pdf 文件时，出现以下错误：

```
crawling done, failed with Net::HTTP::Persistent::Error: too many connection resets     (due to Timeout::Error - Timeout::Error) after 0 requests on 106051380, last used 1350327629.8242197 seconds ago 
```

你能告诉我我该怎么做才能继续下载吗？

编辑：我已经发布了更多代码，现在我可以告诉你，当我尝试下载第 25 个文件时，它并不总是发生，有时是第 10 个文件，有时是第 6 个文件（所以这个错误不是针对特定的文件）

# ruby-on-rails - 在 Rails 约定中，首选的是：默认值：true 还是默认值：false？

> ID：12902509
> 
> 赞同：1
> 
> 时间：2012-10-15T19:18:31.237
> 
> 标签：ruby-on-rails, activerecord, naming-conventions

我想知道是否有任何约定偏好反对将默认布尔值设置为真或假。也许它超出了 ActiveRecord 的范围，更像是一个一般的数据库设计问题。

我有一个带有`active?`属性的模型，默认情况下所有记录都处于活动状态。

`:active, :boolean, default: true`使用or进行迁移会更好`:inactive, :boolean, default: false`吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-15T19:32:29.693

以我的经验（Rails 或其他），布尔属性最容易理解，当它们用积极的措辞时。

如果您考虑一下您的示例，您实际上是在“活跃”和“不活跃”之间进行选择。选择“不活动”（实际上只是“不活动”）会使代码更难阅读，因为我必须在心理上否定“活动”这个词才能理解代码在做什么。

这似乎是一件小事，但我真的认为“主动”是更好的选择。

* * *

要了解我的意思，请使用您的两个不同迁移作为示例来查看可读性的差异：

```
# New records will be active by default.
:active, :boolean, default: true

# New records will be not "not active" by default.
:inactive, :boolean, default: false 
```

这两条评论中哪一条更容易阅读和理解？我觉得第一个更清楚。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T19:34:24.153

使用假而不是真。我更喜欢不为 boolean 设置默认值，因为无论如何`nil`它都被解释为`false`Ruby。

```
1.8.7 :001 > if nil
1.8.7 :002?>   0
1.8.7 :003?>   end
 => nil 
1.8.7 :004 > if false
1.8.7 :005?>   0
1.8.7 :006?>   end
 => nil 
1.8.7 :007 > if true
1.8.7 :008?>   0
1.8.7 :009?>   end
 => 0 
```

但我认为该决定还取决于您希望该属性做什么。我认为在罕见的情况下，将 true 作为默认值可能更有意义。

# asp.net - asp按钮onclick事件未触发

> ID：12902512
> 
> 赞同：1
> 
> 时间：2012-10-15T19:18:59.603
> 
> 标签：asp.net

asp 按钮 onclick 事件未触发， button(id="submit") 有一个 onclick 事件 (Submit_Click) ，单击时未触发。为什么？？？

```
<form enctype="multipart/form-data" method="post" action="javascript:;">
    <div class="content">
        <p>
            I am a returning customer</p>
        <b>E-Mail Address:</b><br />

        <asp:TextBox name="email" runat="server" ID="email"></asp:TextBox>
        <asp:RegularExpressionValidator ID="email_validation" runat="server" 
            ControlToValidate="email" ErrorMessage="enter a valid email" ForeColor="Red" 
            ValidationExpression="\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*" 
            ValidationGroup="email"></asp:RegularExpressionValidator>
        <br />
        <br />
        <b>Password:</b><br />
        <asp:TextBox runat="server" name="password" TextMode="Password"></asp:TextBox>
        <br />
        <a href="javascript:;">Forgotten Password</a><br />
        <br />
        <asp:Button ID="Submit" runat="server" CssClass="button" Text="Login" 
            onclick="Submit_Click" />
        <input type="hidden" value="http://www.przemyslawlobodzinski.pl/themes/megastore/index.php?route=account/account"
            name="redirect"/>
    </div>
</form> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-15T19:21:25.027

表单缺少`runat=server`标记。

为了让 asp:Button 触发服务器端事件，它需要采用设置了 runat="server" 属性的表单。这适用于所有服务器控件。( [http://www.w3schools.com/aspnet/aspnet_forms.asp](http://www.w3schools.com/aspnet/aspnet_forms.asp) )

您的表单似乎正在尝试调用 JavaScript。

# javascript - javascript，电子邮件验证器脚本

> ID：12902513
> 
> 赞同：0
> 
> 时间：2012-10-15T19:19:07.183
> 
> 标签：javascript, email, validation

我正在尝试使用以下 javascript 来验证正确的电子邮件地址，但在此脚本中出现错误。谁能明白为什么？先感谢您。

```
function isEmail(str){
    var reg = new RegExp("?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\]");
    return reg.test(str);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T19:22:15.073

您有一个未转义的字符串字符。任何时候你用 . 打开一个字符串`"`，任何时候你想`"`在字符串中，它都需要用反斜杠转义，`\"`.

```
function isEmail(str){
    var reg = new RegExp("?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|\"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*\")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\]");
    return reg.test(str);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T19:22:24.960

错误是你有一个未转义的双引号

```
var reg = new RegExp("?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|\" ....
-----------------------------------------------------------------------------------------^ 
```

注意：只要看看你的问题的颜色编码，你就会看到它。也许您的 IDE 也有颜色编码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T13:40:37.340

电子邮件验证很容易出错。因此，我建议您使用[Verimail.js](https://github.com/comfirm/Verimail.js)。

为什么？

*   语法验证（根据 RFC 822）
*   IANA TLD 验证
*   最常见 TLD 和电子邮件域的拼写建议
*   拒绝临时电子邮件帐户域，例如 mailinator.com

这很简单！下载并在您的网站上包含该脚本：

[https://raw.github.com/comfirm/Verimail.js/master/src/verimail.js](https://raw.github.com/comfirm/Verimail.js/master/src/verimail.js)

然后使用：

```
var email = "cool@fabeook.cmo";
var verimail = new Comfirm.AlphaMail.Verimail();

verimail.verify(email, function(status, message, suggestion){
    if(status < 0){
        // Incorrect syntax!
    }else{
        // Syntax looks great!
    }
}); 
```

Verimail.js 甚至还有一个非常易于使用的[jQuery 插件：](https://github.com/comfirm/Verimail.js/blob/master/src/verimail.jquery.js)

```
$("input#email-address").verimail({
    messageElement: "p#status-message"
}); 
```

# extjs - 为应用程序中的所有按钮绑定点击事件

> ID：12902515
> 
> 赞同：5
> 
> 时间：2012-10-15T19:19:16.137
> 
> 标签：extjs

如何为我的 ExtJS 应用程序中的所有按钮绑定事件？像 JQuery：

```
$('button').click(function(el) {
    console.log($(el).getattr('value'));
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-15T19:26:48.460

两种方式：

如果你正在编写一个遵循 Ext 的 MVC 模式的完整应用程序，你必须实例化`Ext.Application`一个控制器并使用如下代码

*   [http://docs.sencha.com/ext-js/4-1/#!/api/Ext.app.Controller](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.app.Controller)
*   [http://docs.sencha.com/ext-js/4-1/#/guide/application_architecture](http://docs.sencha.com/ext-js/4-1/#/guide/application_architecture)

示例代码

```
Ext.define('MyApp.controller.Buttons', {
    extend: 'Ext.app.Controller',

    init: function() {
        this.control({
            'button': {
                click: function() { ... }
            }
        });
    }
}); 
```

破解的方法是进行查询并为每个按钮绑定一个单独的处理程序

```
Ext.Array.each(Ext.ComponentQuery.query('button'), function(btn)) {
  btn.on('click', function() {...});
}; 
```

# python - Python textwrap.wrap 导致 \n 出现问题

> ID：12902521
> 
> 赞同：2
> 
> 时间：2012-10-15T19:19:47.857
> 
> 标签：python, newline, word-wrap

所以我只是重新格式化了一堆代码以合并 textwrap.wrap，却发现我所有的 \n 都不见了。这是一个例子。

```
from textwrap import wrap

def wrapAndPrint (msg, width=25):
  """ wrap msg to width, then print """

  message = wrap(msg, width)
  for line in message:
    print line

msg = ("Ok, this is a test. Let's write to a \nnewline\nand then "
       "continue on with this message") 
```

如果我打印味精，我会得到以下信息

```
>>> print msg
Ok, this is a test. Let's write to a 
newline
and then continue on with this message
>>> 
```

但是，如果我把它送去包装，它看起来像这样：

```
>>> wrapAndPrint(msg)
Ok, this is a test. Let's
write to a  newline and
then continue on with
this message
>>> 
```

我认为这可能与从列表中打印字符串有关，所以我尝试调用特定的索引，所以我尝试让我的 for 循环看起来更像这样：

```
x = 0
for line in message:
  print line[x]
  x += 1 
```

但这并没有什么不同。那么，我在这里错过了什么，或者做错了什么？我真的需要我的换行符，我也真的需要我的文字被换行。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-15T19:25:51.117

默认情况下，该`wrap()`函数将空白字符（包括换行符）替换为单个空格。您可以通过传递关键字参数来关闭它`replace_whitespace=False`。

[http://docs.python.org/library/textwrap.html#textwrap.TextWrapper.replace_whitespace](http://docs.python.org/library/textwrap.html#textwrap.TextWrapper.replace_whitespace)

# java - JTextPane/JTextField 具有稀有字符的奇怪行为

> ID：12902529
> 
> 赞同：5
> 
> 时间：2012-10-15T19:20:39.737
> 
> 标签：java, swing, jtextfield, jtextpane

我在 JTextPane/JTextField 中发现了一个奇怪的错误（或者在它们下面的字体渲染中的某个地方）。我想知道是否有其他人遇到过同样的情况，并且可能对此有解决方案。

我试图在 JTextPane 中显示一些“特殊”或稀有字符，并且一旦我更改 JTextField 的字体（与 JTextPane 完全无关！），JTextPane “分解”，不再显示这些人物。

这应该更好地解释我的意思：

```
public class Scrap {

public static void main(String[] args) {
    JFrame frame = new JFrame();
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.setSize(200, 200);
    frame.setLayout(new BorderLayout());

    JTextField field = new JTextField();

    // Uncomment this line... and the JTextPane nor the JTextField
    // no longer display the characters
    // field.setFont(new Font("Arial", Font.PLAIN, 14));

    frame.add(field, BorderLayout.SOUTH);

    JTextPane textPane = new JTextPane();
    textPane.setFont(new Font("Arial", Font.PLAIN, 14));

    JScrollPane scroll = new JScrollPane(textPane);
    frame.add(scroll, BorderLayout.CENTER);

    StyledDocument doc = (StyledDocument) textPane.getDocument();

    try {
        String str = "◕ ◡◡ ◕";

        doc.insertString(doc.getLength(), str, null);

    } catch (BadLocationException e) {
        e.printStackTrace();
    }

    frame.setVisible(true);
    frame.setLocationRelativeTo(null);
}
} 
```

编辑：这是一个更好的问题示例。它似乎与字体的大小有关。移动 Slider，您会注意到 14 的大小不会呈现字形，而 14 恰好是 JTextField 的 Font 的大小。

```
import javax.swing.*;
import javax.swing.event.ChangeEvent;
import javax.swing.event.ChangeListener;
import javax.swing.text.*;
import java.awt.*;

public class Scrap {

public static void main(String[] args) {
    JFrame frame = new JFrame();
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.setSize(600, 200);
    frame.setLayout(new BorderLayout());

    final JTextField field = new JTextField(10);

    final JTextPane textPane = new JTextPane();

    StyledDocument doc = (StyledDocument) textPane.getDocument();

    JPanel panel = new JPanel();
    frame.add(panel, BorderLayout.SOUTH);

    // Set the Font of the JTextField, and the JTextPane
    // no longer displays the text of that size correctly...

    int changeMe = 14;

    field.setFont(new Font("Tahoma", Font.PLAIN, changeMe));

    // If we change the Font Family, the problem goes away...
    // field.setFont(new Font("Dialog", Font.PLAIN, 14));

    panel.add(field);

    final JLabel label = new JLabel();

    final JSlider slider = new JSlider(6, 32);
    slider.addChangeListener(new ChangeListener() {
        @Override
        public void stateChanged(ChangeEvent e) {
            textPane.setFont(new Font("Tahoma", Font.PLAIN, slider.getValue()));

            textPane.selectAll();

            SimpleAttributeSet attr = new SimpleAttributeSet();
            StyleConstants.setFontSize(attr, slider.getValue());
            textPane.setCharacterAttributes(attr, true);

            label.setText("" + slider.getValue());
        }
    });

    slider.setValue(14);

    panel.add(slider);

    panel.add(label);

    JScrollPane scroll = new JScrollPane(textPane);
    frame.add(scroll, BorderLayout.CENTER);

    Style s = doc.addStyle("test", null);

    try {
        String str = "◕ ◡◡ ◕";

        doc.insertString(doc.getLength(), str, doc.getStyle("test"));

    } catch (BadLocationException e) {
        e.printStackTrace();
    }

    frame.setVisible(true);
    frame.setLocationRelativeTo(null);
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T20:17:07.517

当我尝试制作一个必须支持多种语言（包括具有“非标准”字符的语言，例如中文）的应用程序时，我遇到了类似的问题。我曾经将我的小部件的字体设置为`Arial`，并且遇到了问题。以下解决方案解决了我的问题，但它可能无法解决您的问题。

每当遇到无法显示的特定字符集中的字符时，Java 都有一个回退机制。它可以使用 JRE 提供的 fontconfig.properties 文件进行配置（该文件最初以“fontconfig.properties.src”的形式提供，您必须手动重命名它）。

当您强制使用不在`Dialog`、`Serif`、或之间的字体时`SansSerif`，如果当前字符集（在您的情况下为 Arial）不能代表您尝试在屏幕上绘制的字符（或字形），Java 将无法使用不同的字符集。`Monospaced``DialogInput`

如果您查看 fontconfig.properties.src 文件，您会发现它包含许多用于多种字体类型（例如`Dialog.plain`、`Serif.bold`等）的条目。当上述字体无法显示特定字形时，这些是实际使用的备用字体。因此，将小部件的字体设置为`Font.DIALOG`可以让 Java 尝试使用字体列表来显示您的字符。

有关更多信息，请访问 Oracle 网站（[此处适用于 Java 7](http://docs.oracle.com/javase/7/docs/technotes/guides/intl/fontconfig.html)）。请注意，Oracle 不正式支持使用 fontconfig.properties。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-15T20:48:36.197

不知道发生了什么，也不知道为什么，但必须设置

`textPane.setContentType("text/html");`

![在此处输入图像描述](../Images/60db43a8093d106fcfe4f473124987c6.png)

```
import java.awt.BorderLayout;
import java.awt.Font;
import javax.swing.JFrame;
import javax.swing.JScrollPane;
import javax.swing.JTextField;
import javax.swing.JTextPane;
import javax.swing.SwingUtilities;
import javax.swing.text.BadLocationException;
import javax.swing.text.StyledDocument;

public class Scrap {

    public  Scrap() {
        JFrame frame = new JFrame();
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setSize(200, 200);
        frame.setLayout(new BorderLayout());
        JTextField field = new JTextField();
        // Uncomment this line... and the JTextPane nor the JTextField
        // no longer display the characters
        field.setFont(new Font("Arial", Font.PLAIN, 14));
        frame.add(field, BorderLayout.SOUTH);
        JTextPane textPane = new JTextPane();
        textPane.setFont(new Font("Arial", Font.PLAIN, 14));
        textPane.setContentType("text/html");
        JScrollPane scroll = new JScrollPane(textPane);
        frame.add(scroll, BorderLayout.CENTER);
        StyledDocument doc = (StyledDocument) textPane.getDocument();
        try {
            String str = "\uD0180, \u2460, \u2760, \u2380, \u2C60, \u5000, \u03E0";
            doc.insertString(doc.getLength(), str, null);
        } catch (BadLocationException e) {
            e.printStackTrace();
        }
        frame.setVisible(true);
        frame.setLocationRelativeTo(null);
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                Scrap fs = new Scrap();
            }
        });
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T20:19:22.390

简单的模拟字体和字形，

```
import java.awt.*;
import javax.swing.*;
import javax.swing.text.*;

public class Fonts implements Runnable {

    private String[] fnt;
    private JFrame frm;
    private JScrollPane jsp;
    private JTextPane jta;
    private JTextField field;
    private int width = 450;
    private int height = 300;
    private GraphicsEnvironment ge = GraphicsEnvironment.getLocalGraphicsEnvironment();
    private StyledDocument doc;
    private MutableAttributeSet mas;
    private int cp = 0;
    private Highlighter.HighlightPainter cyanPainter = new DefaultHighlighter.DefaultHighlightPainter(Color.cyan);
    private Highlighter.HighlightPainter redPainter = new DefaultHighlighter.DefaultHighlightPainter(Color.red);
    private Highlighter.HighlightPainter whitePainter = new DefaultHighlighter.DefaultHighlightPainter(Color.white);
    private int _count = 0;
    private int _lenght = 0;

    public Fonts() {
        jta = new JTextPane();
        doc = jta.getStyledDocument();
        jsp = new JScrollPane(jta);
        jsp.setPreferredSize(new Dimension(height, width));
        frm = new JFrame("awesome");
        frm.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frm.setLayout(new BorderLayout());
        frm.add(jsp, BorderLayout.CENTER);
        field = new JTextField();
        field.setText("\u2460, \u2760, \u2380, \u2C60, \u5000, \u03E0");
        frm.add(field, BorderLayout.SOUTH);
        frm.setLocation(100, 100);
        frm.pack();
        frm.setVisible(true);
        jta.setCursor(Cursor.getPredefinedCursor(Cursor.WAIT_CURSOR));
        fnt = ge.getAvailableFontFamilyNames();
        mas = jta.getInputAttributes();
        new Thread(this).start();
    }

    @Override
    public void run() {
        for (int i = 0; i < fnt.length; i++) {
            StyleConstants.setBold(mas, false);
            StyleConstants.setItalic(mas, false);
            StyleConstants.setFontFamily(mas, fnt[i]);
            StyleConstants.setFontSize(mas, 16);
            //dis(fnt[i]);
            dis("\u2460, \u2760, \u2380, \u2C60, \u5000, \u03E0");
            field.setFont(new Font(fnt[i], Font.PLAIN, 14));
            try {
                Thread.sleep(450);
            } catch (Exception e) {
                e.printStackTrace();
            }
            /*StyleConstants.setBold(mas, true);
            dis(fnt[i] + " Bold");
            try {
                Thread.sleep(75);
            } catch (Exception e) {
                e.printStackTrace();
            }
            StyleConstants.setItalic(mas, true);
            dis(fnt[i] + " Bold & Italic");
            try {
                Thread.sleep(75);
            } catch (Exception e) {
                e.printStackTrace();
            }
            StyleConstants.setBold(mas, false);
            dis(fnt[i] + " Italic");
            try {
                Thread.sleep(75);
            } catch (Exception e) {
                e.printStackTrace();
            }*/
        }
        jta.setCursor(Cursor.getPredefinedCursor(Cursor.DEFAULT_CURSOR));
    }

    public void dis(String s) {
        _count++;
        _lenght = jta.getText().length();
        try {
            doc.insertString(cp, s, mas);
            doc.insertString(cp, "\n", mas);
        } catch (Exception bla_bla_bla_bla) {
            bla_bla_bla_bla.printStackTrace();
        }
        if (_count % 2 == 0) {
            try {
                jta.getHighlighter().addHighlight(1, _lenght - 1, cyanPainter);
            } catch (BadLocationException bla_bla_bla_bla) {
            }
        } else if (_count % 3 == 0) {
            try {
                jta.getHighlighter().addHighlight(1, _lenght - 1, redPainter);
            } catch (BadLocationException bla_bla_bla_bla) {
            }
        } else {
            try {
                jta.getHighlighter().addHighlight(1, _lenght - 1, whitePainter);
            } catch (BadLocationException bla_bla_bla_bla) {
            }
        }
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                Fonts fs = new Fonts();
            }
        });
    }
} 
```

# jquery - Jquery Fancybox 2 添加了一个边距，对吗？

> ID：12902531
> 
> 赞同：3
> 
> 时间：2012-10-15T19:20:41.403
> 
> 标签：jquery, margins, fancybox-2

当我使用 Fancybox 2 jquery 插件时，添加了 23px 的边距（滚动条的宽度）。

这是网站（单击站点地图按钮）： http: [//kevinlouisdesign.com/projects/Canu/web/](http://kevinlouisdesign.com/projects/Canu/web/)

我不喜欢的是当fancybox出现时它会使内容向左跳。我想摆脱这种margin-right 风格。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-15T19:29:40.993

这是一个`CSS`修复。在`.fancybox-lock`样式上，去掉`overflow-y: scroll`，所以样式看起来像这样：

```
.fancybox-lock .fancybox-overlay {
    overflow: auto;
    overflow-y: scroll;
} 
```

应该看起来像这样：

```
.fancybox-lock .fancybox-overlay {
    overflow: auto;
} 
```

这将为您处理。

# python - 从 python 中的 gzip 文件中读取

> ID：12902540
> 
> 赞同：80
> 
> 时间：2012-10-15T19:21:25.933
> 
> 标签：python, python-2.7, gzip

我刚刚在 python 上对 gzip 进行了消费。

```
import gzip
f=gzip.open('Onlyfinnaly.log.gz','rb')
file_content=f.read()
print file_content 
```

而且我在屏幕上没有输出。作为一个python的初学者，我想知道如果我想读取gzip文件中的文件内容该怎么办。谢谢你。

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2012-10-26T08:22:11.897

尝试像这样通过 gzip 库压缩一些数据......

```
import gzip
content = "Lots of content here"
f = gzip.open('Onlyfinnaly.log.gz', 'wb')
f.write(content)
f.close() 
```

...然后按照发布的方式运行您的代码...

```
import gzip
f=gzip.open('Onlyfinnaly.log.gz','rb')
file_content=f.read()
print file_content 
```

这种方法对我有用，因为出于某种原因 gzip 库无法读取某些文件。

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2016-01-01T07:21:21.723

[python：从压缩文本文件中读取行](https://stackoverflow.com/questions/10566558/python-read-lines-from-compressed-text-files)

使用`gzip.GzipFile`：

```
import gzip

with gzip.open('input.gz','r') as fin:        
    for line in fin:        
        print('got line', line) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2021-09-01T00:06:24.340

如果您想将内容读取为*字符串*，则以[文本模式打开文件](https://docs.python.org/3/library/gzip.html#gzip.open)( `mode="rt"`)

```
import gzip

with gzip.open("Onlyfinnaly.log.gz", mode="rt") as f:
    file_content = f.read()
    print(file_content) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-07-19T17:39:37.553

对于镶木地板文件，请使用熊猫阅读

```
data = read_parquet("file.parquet.gzip")
data.head() 
```

# networking - 一个保留的IP地址：“全0的网络地址”？

> ID：12902542
> 
> 赞同：2
> 
> 时间：2012-10-15T19:21:51.543
> 
> 标签：networking

它被解释为“这个网络或网段”。这里的“网络地址”是相对于主机地址的。

我的问题：在什么情况下使用这样的IP地址？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T05:47:41.953

It's nothing more than a "notational convention"; a convenient way of talking about a network, according to the earliest reference to the all-zeroes address I found, in [RFC 919](https://www.rfc-editor.org/rfc/rfc919#page-6):

```
If the use of "all ones" in a field of an IP address means
"broadcast", using "all zeros" could be viewed as meaning
"unspecified".  There is probably no reason for such addresses to
appear anywhere but as the source address of an ICMP Information
Request datagram.  However, as a notational convention, we refer to
networks (as opposed to hosts) by using addresses with zero fields.
For example, 36.0.0.0 means "network number 36" while 36.255.255.255
means "all hosts on network number 36". 
```

For example, if I were to say "it's 10.0.0.0/16", you would know I was talking about a subnet, and not a host. If I were to say "it's 10.0.4.16/16", you would know I was talking about a host.

In practice, some IP stacks interpreted this as an alternate form of the broadcast address. But (as the RFC states) you will probably never see it on the network.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T19:29:41.967

任何打开服务器套接字以侦听任何可用接口的软件都将侦听`0.0.0.0:port`.

例如，C# 的[`IPAddress.Any`](http://msdn.microsoft.com/en-us/library/system.net.ipaddress.any.aspx)字段以这种方式运行。

> Any 字段等效于点分四边形表示法中的 0.0.0.0。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-06-17T18:58:55.693

全 0 的网络地址代表`this network`。例如 0.0.0.120 用于向网络发送广播消息。

全1的网络地址代表`all networks`。向所有网络发送广播消息。

每个人都感到困惑的是在网络地址，广播地址和相反的网络之间

网络地址：它是一个所有主机位为零的网络，即`10.0.0.0`是一个网络地址

和

广播地址：它是所有主机位均为 1 的地址，即`10.255.255.255`广播地址

# c - 如何使用整数打印 NULL 字符串

> ID：12902549
> 
> 赞同：0
> 
> 时间：2012-10-15T19:22:12.373
> 
> 标签：c, printf

我有以下代码

```
#include<stdio.h>
#include<string.h>

int main (void)
{

    unsigned int pqr = 201;
    unsigned int def = 113;

    printf("The values are,%u,%s,%s,%u\n", pqr,"\0","\0",def);
    printf("The values are,%u,%d,%d,%u\n", pqr,atoi("\0"),atoi("\0"),def);

} 
```

**值为,201,,,113
值为,201,0,0,113**

如果值字符串设置为 NULL 并且我使用了格式说明符“%S”，那么第一个 printf 什么也没给我。如何在第二个中使用格式说明符 %d 获得相同的结果。目前它给出“0”而不是什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-15T19:23:50.500

> 如果值字符串设置为 NULL 并且我使用了格式说明符“%S”，那么第一个 printf 什么也没给我。

`""`是空字符串。`"\0"`是一个带有额外空字符的空字符串。它不一样`NULL`。为转换说明符传递空指针`s`是未定义的行为。

> 如何在第二个中使用格式说明符 %d 获得相同的结果。

你不能。`printf`使用`%d`转换规范打印一个`int`值；它不能打印任何东西。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-15T19:25:24.773

`%d`总是打印一个整数，因此总是打印*一些*数字序列。没有`NULL`整数的概念，所以你不能让它什么都不打印。

顺便说一句，`"\0"`不是`NULL`字符串；`NULL`是。`"\0"`是，对于所有字符串的目的，等价于`""`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T19:27:14.830

该`atoi()`函数将字符串转换为整数，以便`0`在第二种情况下打印，因为`atoi`空字符串 ( `"\0"`) 的 0 和随机字符串（不是数字）的 atoi`0`也是。

the`%d`用于显示整数， the`%s`用于显示字符串

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-15T19:25:15.730

只需测试它是否为 0 并打印您想要的内容。

```
{
    int number = 0;
    char dummy[24];
    printf("This is the number: %s\n", (number == 0)? "" : itoa(number, dummy, 10));
} 
```

三元运算符 ( `? :`) 应检查数字是否为零，如果为零，则返回一个空字符串并打印。

如果数字不为零，它将`itoa` 在数字（以 10 为底）上运行（整数到 Ascii），并返回该字符串。

为了`itoa`工作，它需要一个缓冲区来存储其结果，因此需要`dummy`变量。

# twitter-bootstrap - Bootstrap：如何更改流体行中 div 的顺序？

> ID：12902555
> 
> 赞同：17
> 
> 时间：2012-10-15T19:22:25.917
> 
> 标签：twitter-bootstrap

如何在引导程序中重新排列/交换某些流体容器/行的顺序.....

如果我们在下一页以引导程序的流体示例为例：

[http://twitter.github.com/bootstrap/examples/fluid.html](http://twitter.github.com/bootstrap/examples/fluid.html)

他们在左侧有一个流畅的行中的侧边栏，然后在同一行中有一个英雄单位。然后是下一行的一些内容。当我们切换到移动视图/小屏幕时，它会以相同的顺序出现。但是我们怎样才能改变这个顺序。即如何在页面顶部显示最后的侧边栏和英雄单元？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-08-01T08:18:28.953

新版 Bootstrap v3 现在支持列排序：

列排序

`.col-push-* and .col-pull-*`使用修饰符类轻松更改内置网格列的顺序。

```
 <div class="row">
  <div class="col-md-9 col-md-push-3">9</div>
  <div class="col-md-3 col-md-pull-9">3</div>
</div> 
```

将给出以下命令：

```
 ----------------------------
|     3     |      9       |
---------------------------- 
```

文档： http: [//getbootstrap.com/css/#grid-column-ordering](http://getbootstrap.com/css/#grid-column-ordering)

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-10-15T22:26:27.773

您必须记住，网格默认情况下不支持此功能，但有一些方法可以解决此问题。

例如，您可以反转两个跨度（设置移动视图的顺序）并使用浮动强制正常定位：

```
<div class="row-fluid">
    <div class="span9 pull-right">
        <!-- ... -->
    </div><!--/span-->
    <div class="span3 pull-left">
        <!-- ... -->
    </div><!--/span-->
</div><!--/row--> 
```

然后，`.span`对于较小的屏幕，元素或多或少会被正确修改，但是您仍然有一些规则可以解决此问题：

```
.row-fluid .pull-left[class*="span"]:last-child { margin-left: 0; }

@media (max-width: 767px) {
    .row-fluid .pull-right[class*="span"] { float: none; }
} 
```

如果您使用多于两列，则必须反转`.pull-right`元素的边距（最后一个除外） - 例如：

```
.row-fluid .pull-right[class*="span"] { margin-right: 2.5641%;margin-left: 0; }
.row-fluid .pull-right[class*="span"]:first-child { margin-right: 0; } 
```

[现场演示（jsfiddle）](http://jsfiddle.net/Sherbrow/7vsC9/)和[全屏](http://fiddle.jshell.net/Sherbrow/7vsC9/show/)（某些样式必须在正常和响应之间设置，因此样式面板中的 jsfiddle “hack”）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-15T22:22:46.377

如果你希望你的侧栏在你的英雄之下但高于其他东西，那将需要一些 dom 操作，因为这不仅仅是将列表放在所有内容之前/之后的问题，而是放在元素之间。像这样的东西应该工作：

```
$(window).resize(function () {
    if ($(window).width() < 480) {
        $("#sidebar").insertAfter($("#hero"));
    } else {
        $("#sidebar").prepend($("#containingrow"));
    }
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-07-25T16:24:58.937

```
#wrapper {
    display: flex;
    display:-webkit-flex;
    flex-direction: column;
    -webkit-flex-direction:column;
}

#wrapper > div {
    width: 100%;
}

#header {
    order: 1;
    -webkit-order: 1;
}

#mainMenu {
    order: 2;
    -webkit-order:2;
}

#content {
    order: 3;
   -webkit-order:3;
}

#sidebar {
    order: 4;
    -webkit-order:4;
} 
```

来源：[http ://www.reddit.com/r/css/comments/1v1gv7/change_order_of_divs_with_css/](http://www.reddit.com/r/css/comments/1v1gv7/change_order_of_divs_with_css/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-06-29T19:05:32.497

我正在开发一个用于对 Bootstrap 网格进行排序和添加元素的插件。目前它非常粗糙和脆弱，但如果仅用于基本功能，我相信它可以在生产环境中生存。

该插件要求网格保持一致，所有特定宽度的跨度，但它可能对此有所帮助。

最好在标记呈现之前完成所有这些类型的工作，但在某些情况下，由于我被迫使用的某些模板语言的限制，我无法预先排序，因此我使用 Bootstrap。

[Github](https://github.com/ryanburnette/livingGrid)
[代码笔](http://codepen.io/ryanburnette/details/qApEC)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-10-15T19:39:33.370

您可以使用[媒体查询](http://mobile.smashingmagazine.com/2010/07/19/how-to-use-css3-media-queries-to-create-a-mobile-version-of-your-website/)来做到这一点，这是 CSS3 提供的一种新的可能性。

例如，通过媒体查询，您可以创建仅应用于某些类型的屏幕的样式。如果你想制作你所说的那个东西，你可以像这样：

```
@media only screen and (max-device-width: 480px) {
      .sidebar { width: 100%; bottom: 0%; blahblah: something;  }
} 
```

只有当屏幕的宽度小于 480 像素时，才会应用该样式。这个解决方案实际上并不依赖于引导程序，而是依赖于 CSS3。

顺便说一句，如果您包含 bootstrap.responsive.css （也由 bootstrap 框架提供），您的布局将自动成为单列布局，但可能不是您想要的顺序。

# php - 解析 Facebook 粉丝页面的 RSS 提要：如何伪造标题

> ID：12902561
> 
> 赞同：1
> 
> 时间：2012-10-15T19:22:58.220
> 
> 标签：php, facebook, rss, simplexml

我正在尝试从 PHP 中提取 Facebook 粉丝页面的 RSS 2.0 提要。

当我从浏览器访问提要时，没有问题。但是，当我尝试在 PHP 中提取和使用时，Facebook 返回代码以重定向到“升级您的浏览器”通知。当我尝试使用 W3C RSS 验证器验证提要时，也会发生同样的情况。

因此，Facebook 必须有一些逻辑来分析用户代理并提供提要或“您必须更新”页面。

问题是：**如何从 PHP 中访问该 RSS 提要？**

使用 SimpleXML 或 DOMdocument 时可以直接伪造用户代理标头吗？我知道有一个选项可以使用 CURL 提取提要（可以轻松设置标题），但我不想这样做。

欢迎任何想法！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T19:33:40.057

好吧，对于那些可能也好奇的人来说，这`ini_set()`似乎是一种解决方案。

```
<?php

ini_set('user_agent', 'Mozilla/5.0 (Windows NT 6.1; WOW64; rv:16.0) Gecko/20100101 Firefox/16.0');

$url = 'https://www.facebook.com/feeds/page.php?format=rss20&id={your-page-id}';
$xml = simplexml_load_file( $url );
foreach($xml->channel->item as $status){
    // Do something for each News Feed update
} 
```

虽然，当 Zuckberberg 想要更新用户代理需求时，谁知道这是否会验证。

# matlab - 在 roipoly for matlab 中使用其他工具

> ID：12902562
> 
> 赞同：1
> 
> 时间：2012-10-15T19:23:02.370
> 
> 标签：matlab, image-processing

非常简单的matlab问题，但我认为它可能很有用，因为它没有文档。

问题：在 roipoly 中，如何在使用其他工具（例如缩放或平移）后恢复多边形选择工具？

# c# - 使用带有 C# 的 Excel 互操作将 Excel 单元格内容居中

> ID：12902563
> 
> 赞同：2
> 
> 时间：2012-10-15T19:23:03.453
> 
> 标签：c#, excel, excel-interop

我正在尝试将用作标题的单元格的值居中。这是我目前用来格式化这些单元格的代码。我正在使用带有 C# 的 Excel 互操作。如何在此单元格范围内将值居中。

```
public void createHeaders(int row, int col, string htext, string cell1,
    string cell2, int mergeColumns, string b, bool font, int size, string
    fcolor)
    {
        worksheet.Cells[row, col] = htext;
        workSheet_range = worksheet.get_Range(cell1, cell2);
        workSheet_range.Merge(mergeColumns);
        switch (b)
        {
            case "BLUE":
                workSheet_range.Interior.Color = System.Drawing.Color.Red.ToArgb();
                break;
            case "GAINSBORO":
                workSheet_range.Interior.Color =
        System.Drawing.Color.Gainsboro.ToArgb();
                break;
            //case "Turquoise":
               // workSheet_range.Interior.Color =
        //System.Drawing.Color.Turquoise.ToArgb();
                //break;
            case "PeachPuff":
                workSheet_range.Interior.Color =
        System.Drawing.Color.PeachPuff.ToArgb();
                break;
            default:
                //  workSheet_range.Interior.Color = System.Drawing.Color..ToArgb();
                break;
        }

        //workSheet_range.Borders.Color = System.Drawing.Color.Black.ToArgb();
        //workSheet_range.Borders = null;
        workSheet_range.Font.Bold = font;
        workSheet_range.ColumnWidth = size;
        workSheet_range.Font.Color = System.Drawing.Color.FloralWhite.ToArgb();

    } 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-15T19:37:15.190

枚举来自 System.Drawing ，`ContentAlignment`不适用于 Excel 范围。尝试

```
workSheet_range.HorizontalAlignment =
     Microsoft.Office.Interop.Excel.XlHAlign.xlHAlignCenter; 
```

# wpf - RichTextBox Selection.Text 不正确

> ID：12902566
> 
> 赞同：2
> 
> 时间：2012-10-15T19:23:07.557
> 
> 标签：wpf, text, position, richtextbox, selection

如果我拖动（从后到前）选择 RichTextBox 中的文本，则 Selection.Text 与实际选择匹配。但是，如果我拖动（从前到后）在同一个 RichTextBox 中选择文本，则 Selection.Text**始终**是一个空字符串。

我需要这些信息的原因是，在重新解析（这涉及清除所有文本并重新填充）RichTextBox 中的文本之后，我需要将插入符号返回到原始位置。

我的目标是获得选择开始的偏移量。我可以使用它来获取一个停在那里的字符串，我将用它来替换解析结束时的插入符号。

```
if (String.IsNullOrWhiteSpace(Selection.Text))
                restartPosition = activeRun.ContentStart.GetOffsetToPosition(CaretPosition.GetInsertionPosition(LogicalDirection.Forward));
            else
                restartPosition = activeRun.ContentStart.GetOffsetToPosition(Selection.Start); 
```

关键就在那个'if'语句中。如果没有选择，我可以将文本指针用于光标所在的位置。但是，如果有选择，我需要它的开头。具有讽刺意味的是，如果它在另一个方向上失败了，那就不是问题了。

有没有办法准确地检索选择？微软的实现似乎有点缺陷。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T20:27:20.187

所以，它没有坏掉。更改 CaretPosition 会清除选择。这就是正在发生的事情。现在像冠军一样工作。

# php - 如何在不刷新页面的情况下从链接的选择框中检索和显示选定的值？

> ID：12902567
> 
> 赞同：0
> 
> 时间：2012-10-15T19:23:05.867
> 
> 标签：php, jquery, ajax

我有两个链接的选择框，其中第二个下拉列表根据第一个下拉列表的值填充，效果很好。我目前有一个 php 函数，可以在用户单击按钮时检索并显示选择框的值。现在我面临的挑战是因为他们必须单击按钮来显示他们选择的选项，页面会刷新，但我想要一种可以检索和显示所选选项的方式，这样用户就可以在不刷新页面的情况下看到他们选择的内容. 我知道这可以使用 ajax 来实现，但我是 ajax 新手，我在网上检查了很多类似的问题，但我不太明白如何做到这一点。对此的任何建议将不胜感激。请参阅下面我的 php 函数，该函数执行所选值的检索和显示

```
function OutputCategory() {
    if (isset($_POST['drop_2']) && ($_POST['btn_confirm']) && ($_POST['drop_1'])) {
        $drop2 = $_POST['drop_2'];
        $drop1 = $_POST['drop_1'];

        $cat_name = mysql_query(sprintf("SELECT subcategory_name FROM subcategory WHERE subcategory_id = '%s'", mysql_real_escape_string($drop2)));
        while ($cat_name1 = mysql_fetch_array($cat_name)) {
            $cat_name2 = $cat_name1['subcategory_name'];
        }

        $cat = mysql_query(sprintf("SELECT category_name FROM category WHERE category_id = '%s'", mysql_real_escape_string($drop1)));
        while ($cat1 = mysql_fetch_array($cat)) {
            $cat_2 = $cat1['category_name'];
        }
        echo "You selected Category:";
        echo $cat_2." >> ".$cat_name2;
    }
    elseif(isset($_POST['drop_1']) && ($_POST['btn_confirm'])) {
        $drop1 = $_POST['drop_1'];
        $cat = mysql_query(sprintf("SELECT category_name FROM category WHERE category_id = '%s'", mysql_real_escape_string($drop1)));
        while ($cat1 = mysql_fetch_array($cat)) {
            $cat_2 = $cat1['category_name'];

            echo "You selected Category:";
            echo $cat_2;
        }
    }
}​ 
```

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-10-15T19:31:44.387

您需要将 ajax 调用绑定到选择，如下所示：

```
$('#select1_id').on('change', function() {
  $.ajax({
    type: 'GET',
    data: {
      'select1_val': $(this).val()
    },
    url: 'some_page.php',
    success: function( data ) {
      $select2 = $('#select2_id');
      $select2.empty();      

      $(data.options).each(function(i,option){
        // append option to $select2
      });
    } 

  });
}); 
```

然后，在“some_page.php”上，是这样的：

```
if( $_GET['select1_val'] ) {

  // get the select 2 vals, put them into an $array
  json_encode(array('options' => $array )); exit;

} 
```

...虽然这当然是一个非常简单的例子，但我相信你明白了

干杯，

# seo - 使用 robots.txt 仅抓取我的站点地图

> ID：12902568
> 
> 赞同：0
> 
> 时间：2012-10-15T19:23:09.333
> 
> 标签：seo, robots.txt

我想阻止谷歌抓取我的整个网站——除了站点地图，我可以用它来告诉谷歌优先级和上次更改等。这是一个坏主意吗？我将如何在 robots.txt 中执行此操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T08:50:06.340

如果您在 Google Crawler 中关闭您的整体，那么 Google 也不会抓取 Sitemap.xml。

谢谢

# android - 如何通过数据库中的信息过滤listView

> ID：12902569
> 
> 赞同：1
> 
> 时间：2012-10-15T19:23:09.287
> 
> 标签：android, database, listview, filter

我编写了一个能够将主题和分数保存在数据库中的应用程序。我必须解决的最后一个问题是，如何从 Marks 类中过滤 ListView 以便它只显示相应的主题。

该应用程序由三个类组成。

主要的：

```
package maturaarbeit.nicola_pfister.marks;

import maturaarbeit.nicola_pfister.marks.database.DBAdapter;
import android.app.AlertDialog.Builder;
import android.app.ListActivity;
import android.content.DialogInterface;
import android.content.Intent;
import android.database.Cursor;
import android.os.Bundle;
import android.support.v4.widget.SimpleCursorAdapter;
import android.view.Menu;
import android.view.MenuItem;
import android.view.View;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemClickListener;
import android.widget.EditText;
import android.widget.ListView;

public class Main extends ListActivity {

    DBAdapter db = new DBAdapter(this);

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.subjects);
    }

    @Override
    protected void onPause() {
        super.onPause();
        db.close();
    }

    @Override
    protected void onResume() {
        super.onResume();
        db.open();
        getData();
    }

    @SuppressWarnings("deprecation")
    private void getData() {
        SimpleCursorAdapter adapter = new SimpleCursorAdapter(this, 
                android.R.layout.simple_list_item_1, 
                db.getAllSubjects(), 
                new String[] { "subject" }, 
                new int[] { android.R.id.text1 });

        ListView listView = (ListView) findViewById(android.R.id.list);
        listView.setAdapter(adapter);
        listView.setOnItemClickListener(new OnItemClickListener() {

            @Override
            public void onItemClick(AdapterView<?> arg0, View arg1, int arg2, long id) {

            Cursor cursor = db.getSubject(id);
            String subject = null;
            try {
                subject = cursor.getString(cursor.getColumnIndex("subject"));
            } catch (Exception e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            Intent intent = new Intent(Main.this, Marks.class);
            intent.putExtra("selected", subject);
            startActivity(intent);
            }
        });
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.subjects, menu);
        return true;
    }

    public boolean onOptionsItemSelected(MenuItem item) {
        switch (item.getItemId()) {
        case R.id.menu_add:
            Builder builder = new Builder(this);
            final EditText input = new EditText(this);
            builder
                .setTitle(R.string.dialog_addsubject)
                .setView(input)
                .setPositiveButton(android.R.string.ok, new DialogInterface.OnClickListener() {

                    public void onClick(DialogInterface dialog, int which) {
                        String value = input.getText().toString();
                        db.insertSubject(value);
                        getData();
                    }
                })
                .setNegativeButton(android.R.string.cancel, new DialogInterface.OnClickListener() {

                    public void onClick(DialogInterface dialog, int which) {
                    }

                })
                .show();
            break;
        case R.id.menu_delete:
//          getData();
            break;
        }
        return super.onOptionsItemSelected(item);
    }
} 
```

分数：

```
package maturaarbeit.nicola_pfister.marks;

import java.util.Calendar;

import maturaarbeit.nicola_pfister.marks.database.DBAdapter;
import android.app.AlertDialog.Builder;
import android.app.ListActivity;
import android.content.DialogInterface;
import android.os.Bundle;
import android.support.v4.widget.SimpleCursorAdapter;
import android.view.Menu;
import android.view.MenuInflater;
import android.view.MenuItem;
import android.widget.EditText;
import android.widget.ListView;

public class Marks extends ListActivity {

    DBAdapter db = new DBAdapter(this);

    String selection = null;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.marks);

        final Bundle extras = getIntent().getExtras();
        selection = extras.getString("selected");

        if (extras!= null) {
            setTitle(selection);
        }
    }

    @Override
    protected void onPause() {
        super.onPause();
        db.close();
    }

    @Override
    protected void onResume() {
        super.onResume();
        db.open();
        getData();

    }

    @SuppressWarnings("deprecation")
    private void getData() {
        SimpleCursorAdapter adapter = new SimpleCursorAdapter(this, 
                android.R.layout.simple_list_item_1, 
                db.getAllMarks(), 
                new String[] { "value" }, 
                new int[] { android.R.id.text1 });

        ListView listView = (ListView) findViewById(android.R.id.list);
        listView.setAdapter(adapter);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        MenuInflater inflater = getMenuInflater();
        inflater.inflate(R.menu.marks, menu);
        return true;
    }

    public boolean onOptionsItemSelected(MenuItem item) {
        switch (item.getItemId()) {
        case R.id.menu_add:
            Builder builder = new Builder(this);
            final EditText input = new EditText(this);
            builder
                .setTitle(R.string.dialog_addmark)
                .setView(input)
                .setPositiveButton(android.R.string.ok, new DialogInterface.OnClickListener() {

                    public void onClick(DialogInterface dialog, int which) {
                        String value = input.getText().toString();

                        Calendar cal = Calendar.getInstance();
                        int day = cal.get(Calendar.DAY_OF_MONTH);
                        int month = cal.get(Calendar.MONTH) + 1;
                        final String date = day + "." + month + ".";

                        db.insertMark(date, selection, value);
                        getData();
                    }
                })
                .setNegativeButton(android.R.string.cancel, new DialogInterface.OnClickListener() {

                    public void onClick(DialogInterface dialog, int which) {
                    }

                })
                .show();
            break;
        case R.id.menu_delete:
            break;
        }
        return super.onOptionsItemSelected(item);
    }
} 
```

和 DBAdapter：

```
package maturaarbeit.nicola_pfister.marks.database;

import android.content.ContentValues;
import android.content.Context;
import android.database.Cursor;
import android.database.SQLException;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteOpenHelper;

public class DBAdapter {

    int id = 0;
    public static final String KEY_ROWID = "_id";
    public static final String KEY_DATE = "date";
    public static final String KEY_SUBJECT = "subject";
    public static final String KEY_VALUE = "value";
    public static final String TAG = "DBAdapter";

    private static final String DATABASE_NAME = "database";
    private static final String DATABASE_TABLE_MARKS = "marks";
    private static final String DATABASE_TABLE_SUBJECTS = "subjects";
    private static final int DATABASE_VERSION = 1;

    private static final String DATABASE_CREATE_MARKS =
            "create table " + DATABASE_TABLE_MARKS + " (" + KEY_ROWID + " integer primary key autoincrement, " +
                    KEY_DATE +" text not null, " +
                    KEY_SUBJECT +" text not null, " +
                    KEY_VALUE +" text not null" +  ");";

    private static final String DATABASE_CREATE_SUBJECTS =
            "create table " + DATABASE_TABLE_SUBJECTS + " (" + KEY_ROWID + " integer primary key autoincrement, " +
                    KEY_SUBJECT +" text not null " + ");";

    @SuppressWarnings("unused")
    private final Context context;

    private DatabaseHelper DBHelper;
    private SQLiteDatabase db;

    public DBAdapter(Context context) {
        this.context = context;
        DBHelper = new DatabaseHelper(context);
    }

    private static class DatabaseHelper extends SQLiteOpenHelper {

        DatabaseHelper(Context context) {
            super(context, DATABASE_NAME, null, DATABASE_VERSION);
        }

        @Override
        public void onCreate(SQLiteDatabase db) {
            db.execSQL(DATABASE_CREATE_MARKS);
            db.execSQL(DATABASE_CREATE_SUBJECTS);
        }

        @Override
        public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
            db.execSQL("DROP TABLE IF EXISTS " + DATABASE_TABLE_MARKS);
            db.execSQL("DROP TABLE IF EXISTS " + DATABASE_TABLE_SUBJECTS);
            onCreate(db);
        }
    }

    public DBAdapter open() throws SQLException {
        db = DBHelper.getWritableDatabase();
        return this;
    }

    public void close() {
        DBHelper.close();
    }

    public long insertMark (String date, String subject, String value) {
        ContentValues initialValues = new ContentValues();
        initialValues.put(KEY_DATE, date);
        initialValues.put(KEY_SUBJECT, subject);
        initialValues.put(KEY_VALUE, value);
        return db.insert(DATABASE_TABLE_MARKS, null, initialValues);
    }

    public boolean deleteMark(long rowId) {
        return db.delete(DATABASE_TABLE_MARKS, KEY_ROWID + "=" + rowId, null) > 0;
    }

    public Cursor getAllMarks() {
        return db.query(DATABASE_TABLE_MARKS, new String[] {
                KEY_ROWID,
                KEY_DATE,
                KEY_SUBJECT,
                KEY_VALUE
        }, null, null, null, null, null);
    }

    public Cursor getMark(long rowId) throws SQLException {
        Cursor mCursor =
                db.query(true, DATABASE_TABLE_MARKS, new String[] {
                        KEY_ROWID,
                        KEY_DATE,
                        KEY_SUBJECT,
                        KEY_VALUE
                },
                KEY_ROWID + "=" + rowId,
                null, null, null, null, null);
        if (mCursor != null) {
            mCursor.moveToFirst();
        }
        return mCursor;
    }

    public boolean updateMark(long rowId, String date, String subject, String value) {
        ContentValues args = new ContentValues();
        args.put(KEY_DATE, date);
        args.put(KEY_SUBJECT, subject);
        args.put(KEY_VALUE, value);
        return db.update(DATABASE_TABLE_MARKS, args, KEY_ROWID + "=" + rowId, null) >0;
    }

    public void deleteMark() {
        db.delete(DATABASE_TABLE_MARKS, null, null);
    }

    public long insertSubject (String subject) {
        ContentValues initialValues = new ContentValues();
        initialValues.put(KEY_SUBJECT, subject);
        return db.insert(DATABASE_TABLE_SUBJECTS, null, initialValues);
    }

    public boolean updateSubject(long rowId, String subject) {
        ContentValues args = new ContentValues();
        args.put(KEY_SUBJECT, subject);
        return db.update(DATABASE_TABLE_MARKS, args, KEY_ROWID + "=" + rowId, null) >0;
    }

    public Cursor getSubject(long rowId) throws SQLException {
        Cursor mCursor =
                db.query(true, DATABASE_TABLE_SUBJECTS, new String[] {
                        KEY_ROWID,
                        KEY_SUBJECT
                },
                KEY_ROWID + "=" + rowId,
                null, null, null, null, null);
        if (mCursor != null) {
            mCursor.moveToFirst();
        }
        return mCursor;
    }

    public Cursor getAllSubjects() {
        return db.query(DATABASE_TABLE_SUBJECTS, new String[] {
                KEY_ROWID,
                KEY_SUBJECT
        }, null, null, null, null, null);
    }
} 
```

就像现在一样，标记活动显示任何主题的所有标记，即使标题说明了其他内容。我想使用我的数据库的“主题”列过滤 ListView，以便只显示数据库中的项目，这些项目与标题所说的主题相同。我开始对我在互联网上找到的所有不同的解决方案感到不知所措，我无法使它们中的任何一个适应我的问题......

先感谢您

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T21:53:47.443

也许在您的 DBAdapter 中创建一个这样的方法，并在您的 SimpleCursorAdapter 中使用它而不是 db.getAllMarks()，传入选择。

```
public Cursor getMarks(String subject) {
    return db.query(DATABASE_TABLE_MARKS, new String[] {
            KEY_ROWID,
            KEY_DATE,
            KEY_SUBJECT,
            KEY_VALUE
    }, KEY_SUBJECT + " = ?", subject, null, null, null);
} 
```

# android - ListView IllegalStateException 列表不添加\删除元素

> ID：12902570
> 
> 赞同：2
> 
> 时间：2012-10-15T19:23:16.223
> 
> 标签：android, android-listview, listadapter

和其他许多人一样，我在使用 ListView 时遇到 IllegalStateException :(

> java.lang.IllegalStateException：适配器的内容已更改，但 ListView 没有收到通知。确保适配器的内容不是从后台线程修改的，而只是从 UI 线程修改的

我知道基本解释 - 我可能正在尝试从后台线程修改列表。在一遍又一遍地探索我的代码之后，我找不到我真正这样做的地方。我没有从列表中添加 \ 删除元素 - 它是静态的，并且不会从创建中改变。我正在做的只是从工作线程修改列表元素的**内部**数据 - 但我不确定这是否真的是我的问题。所以 - 这是我的问题 - 只要我不通过添加\删除元素来修改列表本身，是否允许从后台线程修改列表元素的底层数据？

**更新：** 好吧，我想你是对的，所以这是一个伪代码：

```
//from main GUI thread.
ArrayList<People> namesList = // create and populate the list...
//lets assume that NamesArrayAdapter extends ArrayAdapter<People>
NamesArrayAdapter adapter = new NamesArrayAdapter(context, listViewResource, namesList); //instantiate the list adapter

//from backgroung thread
namesList.getItem(0).setName("et"); //Modifying existing element inside the list - is this ligal??? 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T19:29:30.290

`I AM doing is only modifying the internal data of the list's elements from a worker thread`

它与您设置的静态列表相同`Adapter`吗？

然后你不能改变它们`Background Thread`。如果您更改它们，请确保您致电`notifyDataSetChanged`.

# java - 无法在 Android Eclipse 应用程序中显示消息视图

> ID：12902571
> 
> 赞同：0
> 
> 时间：2012-10-15T19:23:20.240
> 
> 标签：java, android, eclipse

我从找到的教程中设置了一个活动类。Activity 类只是打开一个新屏幕并显示来自 mainActivity 上的文本框的消息。APP 调用服务器上的 php 文件，该文件返回 JSON 数据。当我测试它时，那一面在浏览器中运行良好。

现在是安卓问题。我试图让该数据显示在 messageActivity 类中。我试图简单地使用下面的代码来做到这一点，但 eclipse 标记意图行说“构造函数意图（连接，类）未定义”

我的问题是，什么是触发活动的正确方法，以便显示 JSON 数据，其次，如果您查看 quaryDB 方法，如何从响应中获取 JSON 数据到 messageActivity？

主要活动：

```
public class MainActivity extends Activity {
RadioButton radioButton1, radioButton2, radioButton3;

public final static String EXTRA_MESSAGE = "com.example.xxxxxxx.MESSAGE";
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    radioButton1 = (RadioButton)findViewById(R.id.radioButton1);
    radioButton2 = (RadioButton)findViewById(R.id.radioButton2);
    radioButton3 = (RadioButton)findViewById(R.id.radioButton3);
    radioButton1.setOnClickListener(new OnClickListener() {
        @Override
        public void onClick(View view) { 
            if (radioButton1.isChecked()){
                radioButton2.setChecked(false);
                radioButton3.setChecked(false);
            }

        }
    });

    radioButton2.setOnClickListener(new OnClickListener() {
        @Override
        public void onClick(View view) { 
            if (radioButton2.isChecked()){
                radioButton3.setChecked(false);
                radioButton1.setChecked(false);
            }

        }
    });

    radioButton3.setOnClickListener(new OnClickListener() {
        @Override
        public void onClick(View view) { 
            if (radioButton3.isChecked()){
                radioButton2.setChecked(false);
                radioButton1.setChecked(false);
            }

        }
    });

    Spinner spinner = (Spinner) findViewById(R.id.spinner);
 // Create an ArrayAdapter using the string array and a default spinner layout
 ArrayAdapter<CharSequence> adapter = ArrayAdapter.createFromResource(this,
         R.array.PracticeTypes, android.R.layout.simple_spinner_item);
 // Specify the layout to use when the list of choices appears
 adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
 // Apply the adapter to the spinner
 spinner.setAdapter(adapter);
 spinner.setOnItemSelectedListener(new MyOnItemSelectedListener());
 Connect c = new Connect();
 c.quaryDB(this);

}

public class MyOnItemSelectedListener implements OnItemSelectedListener{
public void onItemSelected(AdapterView<?> parent,
        View view, int pos, long id){
    Toast.makeText(parent.getContext(), "The Selected Practice is " + parent.getItemAtPosition(pos).toString(), Toast.LENGTH_LONG).show();
}
public void onNothingSelected(AdapterView parent){

}
 }
 public void sendMessage(View view){
    Intent intent= new Intent(this, DisplayMessageActivity.class);
    EditText editText = (EditText) findViewById(R.id.edit_message);
    String message = editText.getText().toString();
    intent.putExtra(EXTRA_MESSAGE, message);
    startActivity(intent);
}
@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;

}

}; 
```

显示消息活动：

```
 public class DisplayMessageActivity extends Activity {

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_display_message);
   Intent intent = getIntent();
   String message = intent.getStringExtra(MainActivity.EXTRA_MESSAGE);

   TextView textView= new TextView(this);
   textView.setTextSize(40);
   textView.setText(message);

   setContentView(textView);
 }
} 
```

然后是获取 JSON 数据响应的连接类：

```
 public class Connect{

void Connect(){

}

public void quaryDB(Context context){

    Connection conn=null;
    try{
        HttpClient client = new DefaultHttpClient();
        HttpPost httppost = new HttpPost("http://10.0.0.6/DevServer/getAllByZip.php");
        HttpResponse response = client.execute(httppost);
        HttpEntity entity = response.getEntity();
        String succMsg = "Successful Execute.\n";

        Toast.makeText(context, succMsg, Toast.LENGTH_LONG).show();
    }
    catch (Exception e){
        String errMsg ="Cannot connect to database server.\n"+e.toString();
        Toast.makeText(context, errMsg, Toast.LENGTH_LONG).show();
    }
    finally{
        if (conn !=null){
            try{
                conn.close();
            }
            catch (Exception e){
            }
        }
    }
}
   public void sendMessage(View view){
        Intent intent= new Intent(this, DisplayMessageActivity.class);
        EditText editText = (EditText) findViewById(R.id.edit_message);
        String message = editText.getText().toString();
        intent.putExtra(EXTRA_MESSAGE, message);
        startActivity(intent);
    }   
    } 
```

sendMessage 方法在 Connect 类中感觉不对，但我不知道如何正确地将 JSON 数据发送到 DisplayMessageActivity。在我弄清楚那部分之后，我将能够开始解析数据并做需要做的事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T20:01:43.297

首先，我将解释这个问题：

for 的构造函数`Intent`期望将活动上下文作为第一个参数。当您在扩展的类中使用它时，`Activity`您可以将`this`其用作第一个参数，即活动本身。

当您在`Connect`不扩展的类中使用它时`Activity`，使用`this`as 第一个参数将恢复为`Connect`没有上下文的类。

**解决方案：**

如果您`sendMessage`从活动中调用，您可以执行以下操作：

在活动中

```
sendMessage(this, myview); 
```

在课堂里`Connect`

```
public void sendMessage(Context context, View view){  
    Intent intent= new Intent(context, DisplayMessageActivity.class);  
    EditText editText = (EditText) findViewById(R.id.edit_message);  
    String message = editText.getText().toString();  
    intent.putExtra(EXTRA_MESSAGE, message);  
    startActivity(intent);  
} 
```

如果您不是从活动中调用它，请将上下文传递给类构造函数：

```
public class Connect{      

Context context;
void Connect(Context context){      
   this.context = context;  
} 
```

你现在可以使用上下文`sendMessage()`

祝你好运

# gstreamer - 一起使用 textoverlay 和 timeoverlay

> ID：12902574
> 
> 赞同：2
> 
> 时间：2012-10-15T19:23:34.310
> 
> 标签：gstreamer

我有一个使用 GStreamer 的小型 C 项目。我想加载视频并将其与字幕（textoverlay）和经过的时间（timeoverlay）一起显示。

我的想法是这样的：

```
- create a textoverlay and set a sample subtitle
- create a timeoverlay
- create a videosink
- put the three elements in a new bin and link them: 
  textoverlay -> timeoverlay -> videosink
- use playbin2 for playback and send the video from playbin2 to the new bin 
```

这是我的测试独立应用程序：

```
// Save as "test.c". Compile with: 
// gcc -o test `pkg-config --cflags --libs gtk+-2.0 gstreamer-0.10 gstreamer-interfaces-0.10` test.c
#include <gst/gst.h>
#include <gtk/gtk.h>

int main(int argc, char **argv) {
    // Init - GTK is only used here as a GUI hook
    gtk_init (&argc, &argv);
    gst_init(0, NULL);

    // Path to file - juts a simple demo file
    char uri[2048];
    sprintf(&uri[0], "file:///tmp/1.mpg");

    // Playbin and URI
    GstElement *playbin2 = gst_element_factory_make ("playbin2", "playbin2");
    g_object_set (G_OBJECT (playbin2), "uri", &uri[0], NULL);

    // Elements - videosink, textoverlay, timeoverlay
    GstElement *videosink = gst_element_factory_make ("sdlvideosink", "videosink");
    GstElement *textoverlay = gst_element_factory_make("textoverlay", "textoverlay");
    GstElement *timeoverlay = gst_element_factory_make("timeoverlay", "timeoverlay");

    // Set sample text in textoverlay
    g_object_set(G_OBJECT(textoverlay), "text", "Test Subtitle", NULL);

    // Create bin, add elements
    GstElement *mybin = gst_bin_new("mybin");
    gst_bin_add (GST_BIN (mybin), videosink);
    gst_bin_add (GST_BIN (mybin), textoverlay);
    gst_bin_add (GST_BIN (mybin), timeoverlay);

    // Get sink pad for textoverlay and make it a ghostpad for bin
    GstPad *pad_textoverlay_sink = gst_element_get_pad(textoverlay, "video_sink");
    gst_element_add_pad(mybin, gst_ghost_pad_new("sink", pad_textoverlay_sink));

    // Link elements: textoverlay -> timeoverlay -> videosink
    gst_element_link_pads(textoverlay, "src", timeoverlay, "sink");
    gst_element_link_pads(timeoverlay, "src", videosink, "sink");

    // Conect the bin to the playbin
    g_object_set (G_OBJECT (playbin2), "video-sink", mybin, NULL);

    // Play video
    gst_element_set_state (playbin2, GST_STATE_PLAYING);

    // GTK Main loop
    gtk_main ();
} 
```

如果我将 textoverlay 的 src pad 链接到 videosink 的 sink pad（从而跳过 timeoverlay），我会得到一个视频和一个字幕 - 正如预期的那样。

如果我更改代码并使 timeoverlay 的 sink pad 成为 mybin 的 ghostpad，然后将 timeoverlay 的 src pad 链接到 videosink（从而跳过 textoverlay） - 我得到了一个经过时间的视频，正如预期的那样。

但是，当我尝试级联 textoverlay 和 timeoverlay 时，没有视频。它不依赖于videosink - 与xvimagesink 和ximagesink 相同。没有显示错误。使用 gstreamer-launch 它可以正常工作，所以很明显我在 C 中做错了什么——我只是不知道是什么。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-11T11:30:26.833

更简单的解决方案是使用**gst_element_link_many**：

```
gst_element_link_many(textoverlay, timeoverlay, videosink); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T10:00:07.123

Textoverlay 也需要接收器上的文本流。最好使用 GST_DEBUG="*:2" 运行您的应用程序，然后您将看到有关此的警告。

顺便说一句。- 字符 uri[2048]；- sprintf(&uri[0], "file:///tmp/1.mpg"); + gchar *uri = "file:///tmp/1.mpg"; :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T13:53:55.117

解决问题的方法是使用管道而不是 bin。

```
GstElement *mybin = gst_pipeline_new ("my-pipeline"); 
```

但是，为什么会这样，我仍然不清楚。GStreamer 文档说管道只是一个顶级 bin；我发现文档中没有限制可以在一个 bin 中放置多少元素或它们可以做什么。另一方面，playbin2 内部是一个管道，因此 mybin 可以是一个常规 bin（只要只使用 textoverlay 或 timeoverlay，它就可以作为常规 bin 工作）。

# sql - 基于日期和时间检索结果的 SQL 查询

> ID：12902578
> 
> 赞同：0
> 
> 时间：2012-10-15T19:23:46.243
> 
> 标签：sql, oracle

我有以下数据表：

顾客：

```
cus_id             cus_name
1                  philip
2                  david
3                  morris 
```

命令：

```
 order_id   order_no    cus_id  ordr_status      order_ date_time
    1             123        1       d                      20121015 13:10:01
    2             456        1       c                      20121014 14:20:00
    3             789        2       d                      20121013 17:10:01
    4             767        2       c                      20121014 15:10:00 
```

基于此数据，如果订单日期时间在 20121014 14:00:00 和 20121015 14:00:00 之间并且订单状态为 (d,c) 并​​且它们具有相同的值，我想检索客户和订单信息订单号。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T19:30:44.877

那么，对于订单，

```
SELECT * 
FROM order
WHERE NOT order_date_time between '2012-10-14 14:00:00' and '2012-10-15 14:00:00' 
```

加入客户留给读者作为练习。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T21:05:27.340

如果我理解你想要这个：

查询[**SQLFiddle 示例**](http://sqlfiddle.com/#!3/22c3c/7)：

```
SELECT
c.cus_name
,o.order_no
,o.ordr_status
,o.[order_ date_time]
FROM
customer c
  RIGHT JOIN order1 o
  ON c.cus_id = o.cus_id
WHERE o.[order_ date_time] >='20121014 14:00:00'
  AND o.[order_ date_time] <='20121015 14:00:00'
  AND (o.ordr_status = 'd' OR o.ordr_status = 'c') 
```

结果：

```
| CUS_NAME | ORDER_NO | ORDR_STATUS |  ORDER_ DATE_TIME |
---------------------------------------------------------
|   philip |      123 |           d | 20121015 13:10:01 |
|   philip |      456 |           c | 20121014 14:20:00 |
|    david |      767 |           c | 20121014 15:10:00 | 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-04-10T13:28:36.273

请在 Oracle DB 中使用以下查询：

```
select * from table_name where to_char(date_field,'YYYYMMDD HH24MISS') > '20190410 180614' 
```

上述查询从表中获取记录，这些记录是在 2019 年 4 月 10 日 18:06:14 小时后插入到表中的。

# database - 列出 PostgreSQL 数据表中的所有条目

> ID：12902581
> 
> 赞同：3
> 
> 时间：2012-10-15T19:23:54.623
> 
> 标签：database, postgresql, command-line, psql

在命令行中使用 psql 时，如何查看数据表中的所有条目？

数据库名称是 newproject。

```
newproject=# 
```

我试过 \l （但这个列出所有数据库）

我正在尝试查看数据表中的所有条目。我正在尝试验证我从我的网络应用程序中输入的测试条目是否正确存储。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-10-15T19:33:27.667

If I recall correctly, `\dt` will show all tables in the database. Anyway, you can type `\?` to show available commands.

Selecting every row in a table is just a basic SQL command :

```
SELECT * FROM your_table; 
```

# .net - 访问 DataTemplates 中包含的控件

> ID：12902587
> 
> 赞同：1
> 
> 时间：2012-10-15T19:24:27.263
> 
> 标签：.net, wpf, combobox

给定以下 XAML：

```
 <ListView Name="selectedCallees" ItemsSource="{Binding Path=map, RelativeSource={RelativeSource AncestorType=Window},
            Mode=OneWay}" Height="239" HorizontalAlignment="Stretch" VerticalAlignment="Top" Margin="10,215,10,0" >
     <ListView.Resources>
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter1" />
        <Style TargetType="ListViewItem">
           <Style.Triggers>
              <DataTrigger Binding="{Binding IsMouseOver,RelativeSource={RelativeSource Self}}" Value="True">
                 <Setter Property="IsSelected" Value="True" />
              </DataTrigger>
           </Style.Triggers>
        </Style>
     </ListView.Resources>
     <ListView.View>
        <GridView AllowsColumnReorder="True" ColumnHeaderToolTip="Broadcast call targets">         
           <GridViewColumn Width="120">
              <GridViewColumn.CellTemplate>
                 <DataTemplate>
                    <ComboBox ItemsSource="{Binding Path=extensions, RelativeSource={RelativeSource AncestorType=Window}}"
                              Width="105" IsEditable="True" HorizontalAlignment="Center" Margin="0,0,0,0" BorderThickness="0" SelectedValue="------------"
                              SelectedItem="{Binding Path=Key, Mode=OneWay}" SelectionChanged="chooseExtension_SelectionChanged" >
                       <ComboBox.Resources>
                          <sys:Double x:Key="{x:Static SystemParameters.VerticalScrollBarWidthKey}">15</sys:Double>
                       </ComboBox.Resources>
                    </ComboBox>
                 </DataTemplate>
              </GridViewColumn.CellTemplate>
           </GridViewColumn>  
           <GridViewColumn DisplayMemberBinding="{Binding Path=Value}" Header="Description" Width="305" />
           <GridViewColumn Header="" Width="30">
              <GridViewColumn.CellTemplate>
                 <DataTemplate>
                    <Button Content="X" Height="21" Width="18" Click="Button_Click" Visibility="{Binding RelativeSource={RelativeSource AncestorType={x:Type ListViewItem}}, Path=IsMouseOver, Converter={StaticResource BooleanToVisibilityConverter1}}" />
                 </DataTemplate>
              </GridViewColumn.CellTemplate>
           </GridViewColumn>
        </GridView>
     </ListView.View>      
  </ListView> 
```

如 ComboBox.Resources 中所述，我可以将 SystemParameters.VerticalScrollBarWidthKey 设置为某个值。我想做的是在 Loaded 事件触发时将其设置为自定义（由 ComboBox_Loaded 处理）。

这是可能的，还是有另一种方法可以选择性地使 ComboBox 下拉箭头消失？

# button - 按下按钮时显示面板

> ID：12902588
> 
> 赞同：6
> 
> 时间：2012-10-15T19:24:31.687
> 
> 标签：button, primefaces, panel

我在 primefaces 中有一个按钮和一个面板。我希望面板在按下按钮时可见。我怎么能用primefaces做到这一点？

我有代码

```
 <p:commandButton value="Search" ajax="false"
        actionListener="#{myBean.searchPatients}" onclick="panelwv.show();">
    </p:commandButton>
    <p:panel widgetvar="panelwv" visible="false" closable="true" toggleable="true" > 
```

但它不起作用

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-15T19:45:14.673

您的代码中有错字，您需要的属性是`widgetVar`：

```
<p:commandButton value="Search" ajax="false"
    actionListener="#{myBean.searchPatients}" onclick="panelwv.show();">
</p:commandButton>
<p:panel widgetVar="panelwv" visible="false" closable="true" toggleable="true"/> 
```

如果你根本不想渲染你的面板，你应该考虑使用`rendered`组件的属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-05-04T16:18:51.800

您可以为此使用对话框。你也可以检查这个

[https://www.primefaces.org/showcase/ui/overlay/dialog/basic.xhtml](https://www.primefaces.org/showcase/ui/overlay/dialog/basic.xhtml)

```
<p:commandButton value="Search" ajax="false"
actionListener="#{myBean.searchPatients}" oncomplete="PF('dlg1').show();">
</p:commandButton>
<p:dialog header="Basic Dialog" widgetVar="dlg1" minHeight="40">
<p:panel  visible="false" closable="true" toggleable="true"/>
</p:dialog> 
```

# twitter-bootstrap - 使用一个控件将两个 Twitter Bootstrap 轮播链接在一起

> ID：12902592
> 
> 赞同：8
> 
> 时间：2012-10-15T19:24:42.420
> 
> 标签：twitter-bootstrap, carousel

我只是在学习 javascript，所以请耐心等待。我正在尝试使用相同的控件在引导程序中启动两个轮播。

现在的设置方式是，包含轮播 ID 的 href 标记控制每个轮播。有人对如何使用相同的控件以最少的修改将两者链接在一起有什么建议吗？

这是HTML：

```
<div id="asHero">
                <div id="walkThrough" class="carousel slide">
                    <!-- Carousel items -->
                    <div class="carousel-inner">
                        <div class="active item">
                            <div class="span5">
                                <h1>Discover</h1>
                                <p class="heroDesc">Explore the active side of the world around you.</p>
                            </div>
                            <div class="span6">
                                <img src="img/landing/icontest.png" />
                            </div>
                        </div>
                        <div class="item">
                            <div class="span5">
                                <h1>Track</h1>
                                <p class="heroDesc">Keep tabs on frequency and personal bests.</p>
                            </div>
                            <div class="span6">
                                <img src="img/landing/icontest2.png" />
                            </div>
                        </div>
                        <div class="item">
                            <div class="span5">
                                <h1>Conquer</h1>
                                <p class="heroDesc">Earn points and awards for everything you do in your active life.</p>
                            </div>
                            <div class="span6">
                                <img src="img/landing/icontest3.png" />
                            </div>
                        </div>
                    </div>
                    <!-- Carousel nav -->

                    <a class="carousel-control right visible-desktop" href="#walkThrough" data-slide="next">&rsaquo;</a>
                </div>
            </div> <!-- /asHero -->
            <div id="asPhone">
                <div id="walkThrough-2" class="carousel slide">
                    <!-- Carousel items -->
                    <div class="carousel-inner">
                        <div class="active item">
                            <div class="span5">
                                <h1>Discover</h1>
                                <p class="heroDesc">Explore the active side of the world around you.</p>
                            </div>
                            <div class="span6">
                                <img src="img/landing/icontest.png" />
                            </div>
                        </div>
                        <div class="item">
                            <div class="span5">
                                <h1>Track</h1>
                                <p class="heroDesc">Keep tabs on frequency and personal bests.</p>
                            </div>
                            <div class="span6">
                                <img src="img/landing/icontest2.png" />
                            </div>
                        </div>
                        <div class="item">
                            <div class="span5">
                                <h1>Conquer</h1>
                                <p class="heroDesc">Earn points and awards for everything you do in your active life.</p>
                            </div>
                            <div class="span6">
                                <img src="img/landing/icontest3.png" />
                            </div>
                        </div>
                    </div>
                    <!-- Carousel nav -->

                </div>
            </div> <!-- /asPhone --> 
```

这是 Javascript 的链接： [Twitter Bootstrap Carousel JS](http://twitter.github.com/bootstrap/assets/js/bootstrap-carousel.js)

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-15T20:13:15.567

您可以使用他们的类`carousel`而不是他们的 ID 来访问轮播。这样，您可以使用一个控件处理多个轮播。

向您的模板添加一个额外的控制按钮

```
<a href="#" class="btn">Next</a> 
```

并且给这个按钮绑定一个点击事件来控制轮播

```
$('.btn').on('click', function(e) {
  e.preventDefault()
  $('.carousel').carousel('next')
}) 
```

控制也是如此`prev`。有关更多信息，请查看[文档](http://twitter.github.com/bootstrap/javascript.html#carousel)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T20:22:49.107

不幸的是，这是部分解决方案。原因是我无法从触发的事件中找出事情的发展方向。

```
$('#walkThrough').carousel({
  interval: 5000 // Slide every 5 seconds
});

$('#walkThrough-2').carousel({
  interval: false // This one does not slide on its own
});

$('#walkThrough').bind('slide', function() {
  $('#walkThrough-2').carousel('next');
}); 
```

# asp.net-mvc - 发布链接 (MVC)

> ID：12902598
> 
> 赞同：0
> 
> 时间：2012-10-15T19:24:55.773
> 
> 标签：asp.net-mvc

我有一个允许用户当前输入评论的表单。它只允许纯文本。

我想添加一个按钮，让用户发布链接。我希望他们能够单击“链接”按钮以显示一个新的文本框来输入链接。然后将该链接和他们在纯评论文本框中输入的任何内容组合成一条评论，当他们单击提交按钮时，链接位于底部。提交按钮目前适用于纯文本。

我该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T19:48:23.683

你可以使用这样的东西：

```
public class MyModel
{
    [AllowHtml]
    public string Prop1 { get;  set; }

    public string Prop2 { get; set; }
} 
```

但是在服务器上，您需要删除所有危险标签。更多详细信息：[了解 ASP.NET MVC 3 中的请求验证](http://weblogs.asp.net/imranbaloch/archive/2011/02/19/understanding-request-validation-in-asp-net-mvc-3.aspx)

# google-maps - JS 动态应用中的 CSS

> ID：12902599
> 
> 赞同：0
> 
> 时间：2012-10-15T19:24:58.873
> 
> 标签：google-maps, google-maps-api-3

在本页面，

[Javascript 地图教程](https://developers.google.com/maps/documentation/javascript/tutorial)

生成地图的代码示例工作正常，我已经整理了如何传入 PHP 变量。

但我太新手了，无法掌握如何在页面上对齐地图（中心、右侧等）或在其周围环绕文本。

有人可以指出我理解这些问题的资源吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T19:27:58.523

你看到这条线了吗？

```
<div id="map_canvas" style="width:100%; height:100%"></div> 
```

那是您要定位的 div 。使用 CSS 添加边距、内边距、左右移动等。

你必须学习 CSS 并开始自己尝试，但这里有一些东西可以帮助你入门：[http ://www.barelyfitz.com/screencast/html-training/css/positioning/](http://www.barelyfitz.com/screencast/html-training/css/positioning/)

# fullcalendar - Fullcalendar 1.5.4 - 如何从系列中删除一个事件？

> ID：12902609
> 
> 赞同：0
> 
> 时间：2012-10-15T19:25:36.493
> 
> 标签：fullcalendar

Fullcalendar - 如何从系列中删除一个事件？有可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T11:37:18.807

更多信息会有所帮助，但在渲染日历时您仍然必须返回一个唯一的 ID。

我建议您通过`eventRender`方法捕获 id 并将其删除。以下是我如何实现它。

```
$(document).ready(function() {
            $('#calendar').fullCalendar({
                editable: true,
                theme: true,
                eventRender: function(event,element) {
                    if(event.id=="3")
                    {
                        element.remove();
                    }

                },

                eventSources: [
                    {
                        url: "jsonarray.jsp",
                        type: 'POST',
                        dataType: 'json',
                        error: function() {
                            alert('there was an error while fetching events!');
                        }

                    }
                ]

            });
        }); 
```

# php - 为什么包含字符串的 PHP 变量会移出 div？

> ID：12902610
> 
> 赞同：0
> 
> 时间：2012-10-15T19:25:40.953
> 
> 标签：php, html, css

所以我有一个模板，我使用 PHP 变量填充，如下所示：

```
<p>'.$myVar.'</p> 
```

除了包含字符串的 var 出于某种原因移出父 div 之外，工作完美。如果我像这样用静态文本替换变量

```
<p>A lot of nice text etc. etc.</p> 
```

这不会发生。我很确定这不是 CSS 问题。

**编辑** var 的内容是：

```
$myVar = 'AFDKAAGKAGGAMAGKGASKGASKLNANÖLASDNASFDNAFSDNÖADSNLNLKFDSNKAFDSNKFASDLNÖAFSÖNLAFSLNÖKAFSDLNÖAFSDNÖLKSFADÖKNLDFSAÖNKLANKLFSADNÖFASDLNÖKFSNLÖKAFLNÖKFADSKLNÖFADSKLNÖFDSALKNÖFSDANLNLÖKNÖK'; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-15T19:30:31.300

如果只有一个单词，HTML 渲染器将无法将您的文本剪切成多行。你最终会溢出。强制换行：

```
word-wrap: break-word; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-15T19:31:29.980

正如您在评论栏中看到的那样，没有任何分隔空间的长字符串会破坏大多数布局。

在您的字符串中添加一个空格，或在您的 CSS 中设置`overflow: hidden;`以隐藏超出的字符或`word-wrap: break-word;`将单词拆分为不同的行。

# ios - iOS6上的推特库

> ID：12902613
> 
> 赞同：0
> 
> 时间：2012-10-15T19:25:55.043
> 
> 标签：ios, xcode, twitter, ios6

我正在尝试使我们的应用程序在 iOS6 上运行，但存在与 twitter 库相关的问题。似乎 twitter 库不支持新的 armv7s 架构，所以每当我尝试在设备上构建应用程序时，Xcode 都会抱怨“文件是通用的（3 片）但不包含 a(n) armv7s 片：.. ./Twitter/Twitter+OAuth/Libraries & Headers/libOAuth.a 用于架构 armv7s”。有谁知道如何使这个东西工作？谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T19:33:58.413

如果您的最低 iOS 目标是 iOS5，那么您应该使用 iOS5 提供的原生 Twitter 支持。

如果您仍然需要使用这个第三方 Twitter 库，您可以简单地从应用程序构建设置中要构建的架构列表中删除 armv7s。

![在此处输入图像描述](../Images/c2a2f06f2632f9a98a2255dff3e7e8fa.png)

在 iOS6 和 Xcode 4.5 发布之后，但在我使用的一些第三方库发布了带有 armv7s 切片的更新之前，我做了这个简短的操作。

# python - 从openpyxl中的坐标值获取行号和列号

> ID：12902621
> 
> 赞同：49
> 
> 时间：2012-10-15T19:26:23.310
> 
> 标签：python, openpyxl

我试图将excel中的坐标值转换为openpyxl中的行号和列号。

例如，如果我的单元格坐标是 D4，我想找到相应的行号和列号以用于将来的操作，在这种情况下 row = 3，column = 3。我可以使用 `ws.cell('D4').row`which 返回轻松获得行号，`4`那么这只是一个问题减 1。但是`ws.cell('D4').column`返回了一个类似的参数`D`，我不知道如何轻松地将其转换为 int 形式以进行后续操作。所以我求助于stackoverflow的聪明人。你能帮助我吗？

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2012-10-15T19:39:30.423

你想要的是`openpyxl.utils.coordinate_from_string()`和`openpyxl.utils.column_index_from_string()`

```
from openpyxl.utils.cell import coordinate_from_string, column_index_from_string
xy = coordinate_from_string('A4') # returns ('A',4)
col = column_index_from_string(xy[0]) # returns 1
row = xy[1] 
```

* * *

## 回答 #2

> 赞同：69
> 
> 时间：2015-11-08T20:30:46.957

openpyxl 有一个名为**get_column_letter**的函数，可以将数字转换为列字母。

```
from openpyxl.utils import get_column_letter
print(get_column_letter(1)) 
```

1 --> 一个

50 --> 斧头

第1234章

我一直在使用它：

```
from openpyxl import Workbook
from openpyxl.utils import get_column_letter

#create excel type item
wb = Workbook()
# select the active worksheet
ws = wb.active

counter = 0
for column in range(1,6):
    column_letter = get_column_letter(column)
    for row in range(1,11):
        counter = counter +1
        ws[column_letter + str(row)] = counter

wb.save("sample.xlsx") 
```

[![在此处输入图像描述](../Images/54810b3587b162d7124bbee2212fd5cd.png)](https://i.stack.imgur.com/YzYku.png)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-10-26T20:46:27.040

这是建立在内森的回答之上的。基本上，当行和/或列的宽度超过一个字符时，他的答案就不能正常工作。抱歉 - 我有点过火了。这是完整的脚本：

```
def main():
    from sys import argv, stderr

    cells = None

    if len(argv) == 1:
        cells = ['Ab102', 'C10', 'AFHE3920']
    else:
        cells = argv[1:]

    from re import match as rematch

    for cell in cells:
        cell = cell.lower()

        # generate matched object via regex (groups grouped by parentheses)
        m = rematch('([a-z]+)([0-9]+)', cell)

        if m is None:
            from sys import stderr
            print('Invalid cell: {}'.format(cell), file=stderr)
        else:
            row = 0
            for ch in m.group(1):
                # ord('a') == 97, so ord(ch) - 96 == 1
                row += ord(ch) - 96
            col = int(m.group(2))

            print('Cell: [{},{}] '.format(row, col))

if __name__ == '__main__':
    main() 
```

## Tl;博士有一堆评论......

```
# make cells with multiple characters in length for row/column
# feel free to change these values
cells = ['Ab102', 'C10', 'AFHE3920']

# import regex
from re import match as rematch

# run through all the cells we made
for cell in cells:
    # make sure the cells are lower-case ... just easier
    cell = cell.lower()

    # generate matched object via regex (groups grouped by parentheses)
    ############################################################################
    # [a-z] matches a character that is a lower-case letter
    # [0-9] matches a character that is a number
    # The + means there must be at least one and repeats for the character it matches
    # the parentheses group the objects (useful with .group())
    m = rematch('([a-z]+)([0-9]+)', cell)

    # if m is None, then there was no match
    if m is None:
        # let's tell the user that there was no match because it was an invalid cell
        from sys import stderr
        print('Invalid cell: {}'.format(cell), file=stderr)
    else:
        # we have a valid cell!
        # let's grab the row and column from it

        row = 0

        # run through all of the characters in m.group(1) (the letter part)
        for ch in m.group(1):
            # ord('a') == 97, so ord(ch) - 96 == 1
            row += ord(ch) - 96
        col = int(m.group(2))

        # phew! that was a lot of work for one cell ;)
        print('Cell: [{},{}] '.format(row, col))

print('I hope that helps :) ... of course, you could have just used Adam\'s answer,\
but that isn\'t as fun, now is it? ;)') 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-12-28T17:46:49.130

[openpyxl.utils.cell](https://openpyxl.readthedocs.io/en/stable/api/openpyxl.utils.cell.html)模块中有一个方法可以满足所需的功能。方法[openpyxl.utils.cell.coordinate_to_tuple()](https://openpyxl.readthedocs.io/en/stable/api/openpyxl.utils.cell.html#openpyxl.utils.cell.coordinate_to_tuple)将字母数字 excel 坐标作为字符串作为输入，并将这些坐标作为整数元组返回。

```
openpyxl.utils.cell.coordinate_to_tuple('B1')
>> (1, 2) 
```

这提供了使用指定库的更简洁的单行解决方案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-10-30T09:31:39.737

老话题，但答案不正确！

**dylnmc**方法很好，但有一些错误。“AA1”或“AAB1”等单元格坐标的计算行不正确。

以下是作为函数的更正版本。

**注意：**此函数返回真正的坐标。如果你想在 ExcelWriter 中使用它，ROW 和 COL 都应该减一。**所以用return(row-1,col-1)**替换最后一行

 **例如'AA1'是[1,27]，'AAA1'是[1,703]；但是python必须将它们作为[0,26]和[0,702]。

```
import re

def coord2num(coord):
    cell = coord.lower()

    # generate matched object via regex (groups grouped by parentheses)
    m = re.match('([a-z]+)([0-9]+)', cell)

    if m is None:
        print('Invalid cell: {}'.format(cell))
        return [None,None]
    else:
        col = 0
        for i,ch in enumerate(m.group(1)[::-1]):
            n = ord(ch)-96
            col+=(26**i)*(n)

        row = int(m.group(2))

    return[row,col] 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-03-04T18:34:12.967

它看起来像新版本的[`openpyxl`](https://openpyxl.readthedocs.io/en/stable/)support `cell.col_idx`，它为有问题的单元格提供从 1 开始的列号。

所以`ws.cell('D4').col_idx`应该给你 4 而不是`D`.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-04-30T12:22:44.553

这将给出列号

```
col = "BHF"
num = 0
for i in range(len(col)):
    num = num + (ord(col[i]) - 64) * pow(26, len(col) - 1 - i)
print(num) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-05-28T11:36:05.567

如果您想在不使用任何库的情况下执行此操作：

```
def col_row(s):
    """ 'AA13' -> (27, 13) """

    def col_num(col):
        """ 'AA' -> 27 """
        s = 0
        for i, char in enumerate(reversed(col)):
            p = (26 ** i)
            s += (1 + ord(char.upper()) - ord('A')) * p
        return s

    def split_A1(s):
        """ 'AA13' -> (AA, 13) """
        for i, char in enumerate(s):
            if char.isdigit():
                return s[:i], int(s[i:])

    col, row = split_A1(s)
    return col_num(col), row

col_row('ABC13')
# Out[124]: (731, 13) 
```

* * *

## 回答 #9

> 赞同：-4
> 
> 时间：2012-10-15T19:29:16.780

你可以只使用纯 Python：

```
cell = "D4"
col = ord(cell[0]) - 65
row = int(cell[1:]) - 1 
```

这使用了`ord`接受一个字符并返回其 ASCII 码的函数。在 ASCII 中，字母`A`是 65，`B`是 66，依此类推。**

# java - 从 servlet 发出请求

> ID：12902623
> 
> 赞同：1
> 
> 时间：2012-10-15T19:26:28.520
> 
> 标签：java, servlets

我正在尝试让应用程序连接到 Google Plus API，但为此我需要对一些请求参数保密。这就是为什么我不能只发出一个简单的 ajax 请求或创建一个带有隐藏输入的表单。我的解决方案是向 servlet 发出请求，然后从那里向 HttpClient 发出另一个向 Google 的请求。这是问题所在：

```
protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
            System.out.println(TestClass.makeRequest());
} 
```

`TestClass.makeRequest()`创建 HttpPost 对象，获取响应并返回一个字符串。

当我在服务器上运行它时，我得到这个错误：

```
java.lang.ClassNotFoundException: org.apache.http.HttpEntity 
```

我不明白为什么会这样。你能提供一个解决方案吗？在请求中传输隐藏参数的任何其他方法都会有所帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T20:14:53.057

看起来，虽然您的构建路径中有所有必要的 jar 文件，但它们并未与您的 servlet 一起部署。这两种操作环境是不同的。

要使 3d 方库可用于您的 servlet 类，请确保将 `httpcore-4.0.1.jar`所有其他依赖的 jar 部署到

```
WEB-INF/lib 
```

Web 应用程序的目录。

# google-app-engine - Google App Engine 的 GWT/Java 应用程序：有登录用户的电子邮件地址，如何获取名字和姓氏？

> ID：12902624
> 
> 赞同：1
> 
> 时间：2012-10-15T19:26:28.233
> 
> 标签：google-app-engine, gwt

我没有太多运气找到有关这方面的信息，我希望有人能指出我正确的方向。

我正在构建一个托管在 App 引擎上的 GWT 应用程序，以将请求发布到远程服务器。非常简单。我的表单有一个姓名字段，我想用用户的名字和姓氏填充该字段。所有用户都将在我们企业的 google apps 域中。我使用 UserService 成功获取了用户的电子邮件地址，如下所示：

```
public class LoginServiceImpl extends RemoteServiceServlet implements LoginService {
 public LoginInfo login(String requestUri) {
        UserService userService = UserServiceFactory.getUserService();
        User user = userService.getCurrentUser();
        LoginInfo loginInfo = new LoginInfo();

        if (user != null) {
          loginInfo.setLoggedIn(true);
          loginInfo.setEmailAddress(user.getEmail());
          loginInfo.setNickname(user.getNickname());
        } else {
          loginInfo.setLoggedIn(false);
          }
        return loginInfo;
      }
} 
```

现在，我需要以某种方式获取用户的名字和姓氏，可能会使用电子邮件地址进行查找。

我想到了以下方法：
- 我可以以某种方式使用谷歌联系人 API 吗？我真的不想查看单个用户的联系人，我想查看我们通过 Google Apps Direcory 同步从 Active Directory 引入的企业联系人。
- 我可以使用 Oauth 来执行此操作吗？我真的无法找到有关如何执行此操作的好信息。
- 我能以某种方式从 Google Apps Engine 用户服务中得到这个吗？（我想我已经得出结论，你不能这样做 - 这是正确的吗？）
- （更新以添加）我也在研究配置 API ...我认为这可能有效但不想要忽略更好/更简单的方法。

任何想法、想法或建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T21:39:59.433

您可以使用 OAuth 2.0 身份验证，因为这允许您的应用访问包含名称的用户配置文件。查看[适用于 GAE](http://code.google.com/p/google-api-java-client/wiki/OAuth2#Google_App_Engine_Applications)的 OAuth 客户端库。

您还可以使用[`scribe-up`](https://github.com/leleuj/scribe-up)，它使用 OAuth 从各种提供商（包括 Google）获取配置文件。

OTOH，如果您只为一个（您自己的）域执行此操作，那么您最好使用[Google Service Accounts](https://developers.google.com/accounts/docs/OAuth2ServiceAccount)，它可以让用户独立访问特定的 Google Apps 帐户。通过这种方式，您可以[访问配置文件](https://developers.google.com/google-apps/profiles/)并获取用户数据。

# c - stdout 和 STDOUT_FILENO 的区别

> ID：12902627
> 
> 赞同：75
> 
> 时间：2012-10-15T19:26:46.670
> 
> 标签：c, linux, stdout

`stdout`我想知道 Linux C和`STDOUT_FILENO`Linux C之间的区别。

经过一番搜索工作，我得出以下结论。你能帮我复习一下并纠正其中的任何错误吗？谢谢

*   `stdout`属于C语言的标准I/O流；其类型为 FILE* 并在 stdio.h 中定义

*   `STDOUT_FILENO`，具有 int 类型，定义在`unistd.h`。它是LINUX系统的文件描述符。中`unistd.h`，解释如下：

> ```
> The following symbolic constants shall be defined for file streams:
> 
> STDERR_FILENO
>     File number of stderr; 2.
> STDIN_FILENO
>     File number of stdin; 0.
> STDOUT_FILENO
>     File number of stdout; 1. 
> ```

所以，在我看来，`STDOUT_FILENO`属于系统级的调用，在某种程度上，就像一个系统API。`STDOUT_FILENO`可用于描述系统中的任何设备。

位于`stdout`更高级别（用户级别？），实际上封装了`STDOUT_FILENO`. `stdout`有 I/O 缓冲区。

这就是我对他们差异的理解。任何意见或更正表示赞赏，谢谢。

* * *

## 回答 #1

> 赞同：98
> 
> 时间：2012-10-15T19:32:29.623

`stdout`是一个`FILE*`给出标准输出流的“常数”。所以显然具有与;`fprintf(stdout, "x=%d\n", x);`相同的行为 `printf("x=%d\n", x);`您`stdout`用于`<stdio.h>`诸如`fprintf`等之类的功能`fputs`。

`STDOUT_FILENO`是一个整数文件描述符（实际上是整数 1）。您可以将其用于`write`系统调用。

两者的关系是`STDOUT_FILENO == fileno(stdout)`

^(（除了在你做了一些奇怪的事情之后`fclose(stdout);`，或者可能一些`freopen`之后`fclose(stdin)`，你几乎不应该这样做！见[这个](https://stackoverflow.com/q/25516375/4279)，正如[JFSebastian](https://stackoverflow.com/users/4279/j-f-sebastian)评论的那样）)

您通常更喜欢这些`FILE*`东西，因为它们是缓冲的（因此通常表现良好）。有时，您可能想调用`fflush`刷新缓冲区。

您可以将文件描述符编号用于[系统调用](http://en.wikipedia.org/wiki/Syscall)，例如[write(2)](http://www.kernel.org/doc/man-pages/online/pages/man2/write.2.html)（由`stdio`库使用）或[poll(2)](http://www.kernel.org/doc/man-pages/online/pages/man2/poll.2.html)。但是使用系统调用是笨拙的。它可能会为您提供非常好的效率（但这很难编码），但通常该`stdio`库已经足够好（并且更便携）。

（当然，您应该`#include <stdio.h>`使用 stdio 函数，以及`#include <unistd.h>`- 以及其他一些头文件 - 用于系统调用，例如`write`。并且 stdio 函数是使用系统调用实现的，因此`fprintf`可以调用`write`）。

# c# - 如何获取 Windows 服务打开的端口？

> ID：12902632
> 
> 赞同：5
> 
> 时间：2012-10-15T19:14:50.783
> 
> 标签：c#, windows-services, port

我想在 C# 中获取窗口服务及其端口的列表。我可以通过使用获得所有窗口服务，`ServiceController`但我无法获得这些服务的端口。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T19:34:10.103

Please check [this question on stackoverlow](https://stackoverflow.com/questions/577433/which-pid-listens-on-a-given-port-in-c-sharp). It is not exactly the same as you are asking, but it points to a useful function called [GetExtendedTcpTable available through PInvoke](http://www.pinvoke.net/default.aspx/iphlpapi/GetExtendedTcpTable.html), that can do what you need. Also check [this one](https://stackoverflow.com/questions/3956285/list-used-tcp-port-using-c-sharp).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-03-13T07:47:42.947

经过大量环顾后，我发现 MIB_TCPROW_OWNER_MODULE 结构中有未记录的“OwningModuleInfo”。

然后寻找我发现了这个评论：

[针对 x64 时有关 GetOwnerModuleFromTcpEntry 的奇怪问题](https://stackoverflow.com/questions/17934708/weird-issue-regarding-getownermodulefromtcpentry-when-targeting-x64)

“我已经得出结论，数组中的第一项是正在运行的服务列表中服务的索引，......”

因此，问题的答案将是使用它来获取 netstat -b 显示的名称信息（服务名称和地址+端口），过滤您想要的服务。我发现了这个[https://github.com/Loriowar/IpHlpApidotnet](https://github.com/Loriowar/IpHlpApidotnet) lib，除了这个功能之外，它已经设置了一堆相关的代码。

其他有用的链接：

[使用结构成员数组编组结构](https://stackoverflow.com/questions/21687648/marshalling-struct-with-array-of-struct-member)

[https://msdn.microsoft.com/en-us/library/windows/desktop/aa366911(v=vs.85).aspx](https://msdn.microsoft.com/en-us/library/windows/desktop/aa366911(v=vs.85).aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-25T12:10:39.270

类似问题的答案总是建议使用 Iphlpapi，但完全不清楚如何在此 netstat -ban 复制粘贴中获取 RpcSs（服务名称）：TCP 0.0.0.0:135 0.0.0.0:0 LISTENING RpcSs [svchost.可执行程序]

或这里的时间表：

TCP [::]:49154 [::]:0 监听计划 [svchost.exe]

我寻找解决方案并没有找到任何东西（-easy）。Netstat 在 Iphlpapi 中调用了一些未记录的函数，但不清楚它是从 Iphlpapi 获取服务名称，还是以某种方式使用 Iphlpapi 的 pid 并使用其他东西来获取服务名称。我真的不想花时间用调试器来回答这个问题，因为..：

然而，理想情况下，无论如何都不想使用 C# 中的轮询式方法。使用 ETW 会更合适。我认为缺乏从 C# 使用它的示例是因为开始使用它有一些开销，并且周围的示例可能特定于其他类型的跟踪/监视场景。

摘要：如果您没有时间来实现这一点，那么仅保存 netstat 输出似乎是“解决方案”。理想情况下，我希望找到一个简单易用的 C# 示例来监视任何网络连接，并找出哪些服务或进程处理/启动了它们以及可能的防火墙更改。我相信 ETW 可以同时做到这两点，但就我目前的需求而言，很难证明完成这项工作所需的未知时间是合理的。我至少发现“logman 查询提供程序”列出了提供程序，然后您需要做一些事情来启用提供程序（以及驱动程序支持在某些情况下进行跟踪，例如数据包捕获）。有一个使用 ETW 的 C# 项目。但完全不清楚使用 ETW 重现 netstat 输出需要付出多少努力。

# php - 如何在我的网站上显示来自 Facebook 的个人资料？

> ID：12902633
> 
> 赞同：5
> 
> 时间：2012-10-15T19:26:57.610
> 
> 标签：php, python, facebook, web

我在 Stack Overflow、Google 等中进行了搜索，但我不知道如何在我的网站上显示我的 Facebook 上的东西。我尝试了一些解决方案，每一个都提示登录对话框，访问者必须登录并接受我的应用程序（我创建了一个来测试）。

这里的许多答案太笼统了，我不明白，这就是我问的原因。

我想要一些能让我的网站“登录”到 Facebook 并向访问者显示我的状态或照片的东西，而他们不需要接受应用程序或使用他们的帐户登录到 Facebook。

我用我的 AppID 和 AppSecret 尝试了一个 facebook-php-sdk 示例，它要求我登录。此外，github.com/facebook 没有类似于 facebook-php-sdk 的 Python SDK

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T20:37:44.067

您可以编写一个脚本（例如，使用 FB PHP SDK），该脚本使用[长期访问令牌](https://developers.facebook.com/docs/howtos/login/extending-tokens/)来获取您的 FB 数据，然后将数据存储在您的后端数据库（或您网站的其他存储）中。对于 Facebook，您的脚本看起来像一个应用程序，而您的机器将是该应用程序的唯一“用户”。请注意，长期访问令牌的有效期最长为 60 天。您也可以尝试使用[App Access Token](https://developers.facebook.com/docs/opengraph/using-app-tokens/)来获取基本信息。应用程序访问令牌不会过期。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T19:57:31.933

这可能不是您正在寻找的，因为您使用 php 和 python 标签发布了此内容，但它可能会解决您的问题。

如果您的网站由 wordpress 引擎提供支持，您可以使用 If-this-then-that：[https ://ifttt.com/](https://ifttt.com/)

它基本上允许您使用以下内容创建“食谱”：如果 Facebook 上有新状态，则在 wordpress 上创建帖子

该帖子不需要其他人登录 Facebook。

这无需编写任何代码，只需单击几下鼠标。所以我不确定这是否满足您的需求。

# html - 轮播与网站的其他部分不一致，有人愿意帮助我

> ID：12902638
> 
> 赞同：-1
> 
> 时间：2012-10-15T19:27:21.650
> 
> 标签：html, css, alignment, carousel

见下图：

在 chrome 中查看的网站 [http://i48.tinypic.com/2rr9zf7.png](http://i48.tinypic.com/2rr9zf7.png)

在 Dreamweaver 中查看的网站：http: [//i50.tinypic.com/mcvey9.png](http://i50.tinypic.com/mcvey9.png)

问题是轮播没有与顶部的导航栏对齐（见右上角）。它似乎偏离了 1 毫米

我相信它可能与导航栏有关（参见第二张图片）。如您所见，联系人按钮位于其余按钮下方。

我的理论是它导致轮播不对齐。

HTML：

```
<!DOCTYPE HTML>

<html>

<head>

<link href="../CSS/styles.css" rel="stylesheet" type="text/css">
<link href='http://fonts.googleapis.com/css?family=PT+Sans+Caption' rel='stylesheet' type='text/css'>

</head>

<body>

<div id="outer">

<a href="file:///C|/Users/Callum/Desktop/desktop/website folder/WEBSITE/main.html"><img src="../Images/webimages/banner top.jpg"  /></a>

</div>

<div id="topnav">

<ul id="list-nav">

    <li><a href="#">Home</a></li>
  <li><a href="#">About Us</a></li>
  <li><a href="#">Services</a></li>
  <li><a href="#">Technologies</a></li>
  <li><a href="#">Contact</a></li>

  </ul>

</div>

<div id="carousel">

<iframe src="../Carousel/HTML/carousel.html" height="280" width="900" scrolling="no" frameborder="0"> </iframe>

</div>
<div id="mainbody">  
<div id="bigbuttons">

<img src="../Images/webimages/Meettheteam.jpg">

</div>
</div>
</div>

</body>

</html> 
```

CSS：

```
/* Reset */

a img {
 border: none;
}

html, body {
    padding:0;
    margin:0;
    }

a {
text-decoration: none;
}

ul, li {
    list-style-type: none;
}

img.floatLeft { 
    float: left; 
    margin: 0px; 
}

*
{
   margin:  0;
   padding: 0;
}

body {background-color:#F1F1F1; }

#outer { width: 900px; margin: auto; }

#topnav { width: 900px; margin: auto; }

#mainbody { width: 900px; margin:auto; clear:both; } 

#list-nav li{display:inline-block;width:20%;float:left;}

#carousel { width: 900px; height: 280px; margin:auto; clear:both; }

#bigbuttons { width: 220px; height: 80px; margin:auto; margin-top: 9px; clear:both; float:left }

ul#list-nav li a {
 text-decoration:none;
 font-family:Arial, Helvetica, sans-serif;
 padding:5px 0;
 width: auto;
 background:#999;
 color:#eee;
 float: left
}

ul#list-nav li a {
  text-align:center;
  border-left: 1px solid #fff;
  width: 100%;
}

ul#list-nav li a:hover {
  background:#CCC;
  color:#ffff;
}

ul#list-nav li a:hover {
  background:#CCC;
  color:#ffff;
}

#content-fullwidth { width:100%; }​ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T20:08:11.687

检查您正在填充 iframe 的轮播代码。看起来您的问题在那里，而不是您提供给我们的代码。

# reporting-services - 强制 SSRS 2008 使用 SSRS 2005 CSV 渲染

> ID：12902640
> 
> 赞同：3
> 
> 时间：2012-10-15T19:27:30.373
> 
> 标签：reporting-services, ssrs-2008, reportingservices-2005, export-to-csv, ssrs-2008-r2

我们正在将报表服务器从 SSRS 2005 升级到 SSRS 2008 R2。
我对 SSRS 2008 的 CSV 导出呈现存在问题，其中列的总和出现在 2008 年的详细信息值的右侧，而不是像 2005 年那样的左侧，如下面的块所示。
`117`和`131`分别是 Column2 和 Column3 的总和。

**SSRS 2005 CSV 输出**

```
Column2_1,Column3_1,Column2,Column3
117,131,1,2
117,131,1,2
117,131,60,23
117,131,30,15
117,131,25,89 
```

**SSRS 2008 CSV 输出**

```
Column2,Column3,Column2_1,Column3_1
1,2,117,131
1,2,117,131
60,23,117,131
30,15,117,131
25,89,117,131 
```

我知道[CSV 渲染器在 SSRS 2008 R2 中经历了重大变化，](http://msdn.microsoft.com/en-us/library/ms143380%28v=sql.105%29.aspx)支持图表和仪表，更重要的是它提供了 2 种模式：默认`Excel`模式和`Compliant`模式。但是这两种模式都不能解决这个问题。Compliant 模式应该最接近 2005 年的模式，但显然它对我的情况来说还不够接近。

**我的问题：**
有没有办法强制 SSRS 2008 将报告回退到向后兼容模式，以便导出为 2005 CSV 格式？

**尝试的解决方案：**
*a) 使用基于 2005 的 CRI*
根据[这篇关于 ExecutionLog2](http://blogs.msdn.com/b/robertbruckner/archive/2009/01/05/executionlog2-view.aspx)的文章，如果 SSRS 2008 R2 遇到无法自动升级的报告（例如，使用基于 2005 的 CustomReportItem 控件构建的报告），那些特定的报告将是以“透明的向后兼容模式”使用旧的育空引擎进行处理。

似乎它回到了以前的版本模式（2005）并尝试渲染它。所以我尝试使用基于 2005 的条形码 CustomReportItem 并部署到 SSRS 2008 R2 报表服务器，但它显示的结果与以前相同，尽管它抑制了条形码。这是因为 SSRS 2008 R2 找到了一种方法来抑制部分报告输出并显示其余部分。很高兴找到一个基于 2005 年的 CRI，它可以让 SSRS 2008 R2 使用其旧的 Yukon 引擎对其进行处理。请注意，很可能，即使它使用“旧育空处理引擎”，它仍可能使用新的 CSV 渲染器，因此它显示相同的输出。如果这是真的，那么这个选项是没有实际意义的。

*b) 使用 XML 渲染器*
我们可以使用自定义 XML 渲染器，然后使用 XSLT 将 xml 转换为适当的 CSV，但这意味着我们需要转换所有 200 个报告。因此这是不可行的。

请注意，我们无法选择并排部署 SSRS 2005 和 SSRS 2008 R2。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-24T21:13:27.883

您的问题促使我最终走出去尝试[编写自定义 RenderingExtension](http://msdn.microsoft.com/en-us/library/ms153624%28v=sql.100%29.aspx)。这里的答案是**创建一个扩展，“包装”旧的 SSRS 2005 CSV 渲染扩展**，并使其在 SSRS 2008 中以新名称可用。

我当然认为有可能做到这一点。不幸的是，我没有 2005 SSRS DLL，所以我通过创建一个包装*2008* CSV 渲染器的扩展来完成我的概念验证。经过一番挣扎，我终于得到了这个工作。也许这个答案将帮助您以类似的方式为 2005 CSV 渲染器实现这一点。

前面几点说明：

*   所有的荣誉都应该归于“ [Broes](http://www.broes.nl/) ”，他在他的博客上写了一篇关于 PDF 水印的类似案例的优秀教程（[第 1](http://www.broes.nl/2011/02/pdf-watermarkbackground-rendering-extension-for-ssrs-part-1/)部分，[第 2 部分](http://www.broes.nl/2011/02/pdf-watermark-background-rendering-extension-for-ssrs-part-2/)），这对于创建扩展非常宝贵。
*   [微软警告说](http://msdn.microsoft.com/en-us/library/ms154606.aspx)要编写一个*“编写自定义渲染扩展很困难”*的扩展，即使他们正在谈论一个实际上做某事的扩展*（*除了包装一个默认扩展），我发现只是让这个东西工作可能是相当的也是一种痛苦。

所以这里是基本步骤：

1.  使用新类创建一个**新类库**（.NET 3.5，而不是 4.0+）（参见下面的代码）。
2.  添加对以下内容的**引用**：
    1.  Microsoft.ReportingServices.DataRendering（用于默认 CSV 渲染器）
    2.  Microsoft.ReportingServices.Interfaces
    3.  Microsoft.ReportingServices.ProcessingCore
3.  创建**CsvReport 渲染器的私有实例，**在构造函数中对其进行初始化。
4.  **在您的类中实现 IRenderingExtension**接口。*将所有*方法调用路由到包装渲染器的私有实例。
5.  编辑项目的属性以[使用强名称对其进行签名](http://msdn.microsoft.com/en-us/library/ms247123%28v=vs.100%29.aspx)。
6.  **编译**。
7.  **将 DLL 复制**到 ReportServer bin。
8.  编辑该`rssrvpolicy.config`文件以将您的程序集包含[在 CodeGroup 元素](http://msdn.microsoft.com/en-us/library/ms152828%28v=sql.100%29.aspx)中。
9.  编辑`rsreportserver.config`文件[以包含扩展名](http://msdn.microsoft.com/en-us/library/ms154516%28v=sql.100%29.aspx).
10.  **重新启动**SSRS 服务。
11.  （可选）**祈祷**或点燃蜡烛。
12.  在报表管理器中打开一个报表，并**验证**您的扩展是否存在：

![渲染器截图](../Images/edc18a1e0acd892564e8530c2b64177f.png)

这是包装默认 CSV 渲染器的类的代码清单：

```
using Microsoft.ReportingServices.Interfaces;
using Microsoft.ReportingServices.OnDemandReportRendering;

namespace Ssrs2005CsvRenderingExtension
{
    public class Csv2005Renderer : IRenderingExtension
    {
        private IRenderingExtension oldskoolCsvRenderer;

        public Csv2005Renderer()
        {
            oldskoolCsvRenderer = new Microsoft.ReportingServices.Rendering.DataRenderer.CsvReport();
        }

        public void GetRenderingResource(CreateAndRegisterStream createAndRegisterStreamCallback, 
                                         System.Collections.Specialized.NameValueCollection deviceInfo)
        {
            oldskoolCsvRenderer.GetRenderingResource(createAndRegisterStreamCallback, deviceInfo);
        }

        public bool Render(Microsoft.ReportingServices.OnDemandReportRendering.Report report,
                           System.Collections.Specialized.NameValueCollection reportServerParameters, 
                           System.Collections.Specialized.NameValueCollection deviceInfo, 
                           System.Collections.Specialized.NameValueCollection clientCapabilities,
                           ref System.Collections.Hashtable renderProperties, 
                           CreateAndRegisterStream createAndRegisterStream)
        {
            return oldskoolCsvRenderer.Render(report, 
                                              reportServerParameters, 
                                              deviceInfo, 
                                              clientCapabilities, 
                                              ref renderProperties, 
                                              createAndRegisterStream);
        }

        public bool RenderStream(string streamName, 
                                 Microsoft.ReportingServices.OnDemandReportRendering.Report report, 
                                 System.Collections.Specialized.NameValueCollection reportServerParameters, 
                                 System.Collections.Specialized.NameValueCollection deviceInfo, 
                                 System.Collections.Specialized.NameValueCollection clientCapabilities, 
                                 ref System.Collections.Hashtable renderProperties, 
                                 CreateAndRegisterStream createAndRegisterStream)
        {
            return oldskoolCsvRenderer.RenderStream(streamName,
                                                    report,
                                                    reportServerParameters,
                                                    deviceInfo,
                                                    clientCapabilities,
                                                    ref renderProperties,
                                                    createAndRegisterStream);
        }

        public string LocalizedName
        {
            get { return "Oldskool CSV renderer"; }
        }

        public void SetConfiguration(string configuration)
        {
            oldskoolCsvRenderer.SetConfiguration(configuration);
        }
    }
} 
```

这是添加到的扩展`rsreportserver.config`：

```
<Extension Name="OLDSKOOLCSV" Type="Ssrs2005CsvRenderingExtension.Csv2005Renderer,Ssrs2005CsvRenderingExtension"/> 
```

这是`rssrvpolicy.config`我使用它的配置xml：

```
<CodeGroup
        class="UnionCodeGroup"
        version="1"
        PermissionSetName="FullTrust"
        Name="OldskoolCsvGroup"
        Description="Code group for oldskool csv extension">
    <IMembershipCondition 
            class="UrlMembershipCondition"
            version="1"
            Url="C:\Program Files\Microsoft SQL Server\MSRS10.SQLSERVER\Reporting Services\ReportServer\bin\Ssrs2005CsvRenderingExtension.dll"
    />
</CodeGroup> 
```

一个对快速测试非常有用的脚本（主要是因为它涉及大量试验和错误），我使用[RS Utility](http://msdn.microsoft.com/en-us/library/ms162839%28v=sql.100%29.aspx)执行该脚本：

```
Public Sub Main()
    Dim items() As Extension
    items = rs.ListExtensions(1)

    For Each item As Extension In items
        Console.WriteLine(item.Name)
    Next item
End Sub 
```

就是这样。至少这是经过几个小时的反复试验后我仍然记得的所有重要内容。以最后一个音符结束：

*   应用程序事件日志有时包含 SSRS 错误。其中之一是“SSRS 无法加载 ... 扩展”。这是我清除的最后一个障碍，我通过将目标框架从**.NET 4.0 更改为 3.5 来**清除它。

如果有人尝试使用实际的 2005 CSV 渲染 DLL 进行此操作：请让我们知道它是否成功并通过评论或编辑答案。

# python - Fabric——使用父模块中的常见任务

> ID：12902644
> 
> 赞同：1
> 
> 时间：2012-10-15T19:27:44.467
> 
> 标签：python, fabric

使用@task 和子模块约定，我的“父” fabfile 导入两个子模块（“dev”和“stable”，其任务在各自的**init** .py 文件中定义）。如何在开发模块中获取@task 以调用父 fabfile 中定义的任务。我似乎无法让导入正常工作。

我也尝试使用 imp.load_source ，但这产生了令人讨厌的循环导入（fabfile.py 导入 dev 试图导入 ../fabfile.py）。

以此为例：[http ://docs.fabfile.org/en/1.4.3/usage/tasks.html#going-deeper](http://docs.fabfile.org/en/1.4.3/usage/tasks.html#going-deeper)

lb.py 中定义的任务如何调用 top **init** .py 中的某些内容或 migrations.py 中的任务如何调用 top init .py 中的某些**内容**？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T11:14:49.890

您可以按名称调用结构任务：

```
from fabric.api import execute, task
@task
def innertask():
    execute("mytask", arg1, key1=kwarg1) 
```

# bash - 期望脚本模拟 SNMP

> ID：12902649
> 
> 赞同：4
> 
> 时间：2012-10-15T19:28:12.593
> 
> 标签：bash, snmp, expect

我想监控不支持 SNMP 的设备，所以我尝试通过期望脚本获取计数器。此脚本使用 SSH 连接到设备，将输出记录到文件中，然后解析输出以获得所需的计数器。

当我从控制台执行脚本时，我得到以下所需的输出：

```
root@box:/path# ./GGSN-PDP-Contexts.expect  
.1.3.6.1.4.1.6147.2.1  
Integer32  
310838 
```

但是，当我尝试使用 snmpget 获得结果时，它不起作用！

```
root@box:/path# snmpget -m TDP-MIB  -v 2c -c TM_Com_Pub localhost .1.3.6.1.4.1.6147.2.1  
TDP-MIB::PDPContextsNumber = No Such Instance currently exists at this OID 
```

顺便说一下，这是snmpd.conf中的相关配置：
pass .1.3.6.1.4.1.6147.2.1 /usr/bin/expect /path/GGSN-PDP-Contexts.expect

这是我正在使用的期望脚本：

```
#!/usr/bin/expect -f  

# Constants  
set user "user"  
set device "10.10.222.176"  
set pass "blablabla"  
set timeout -1  
set prompt "GGSN-LV02#"  
set file "./GGSN-PDP-Contexts.log"  

# Options  
match_max 100000  
log_user 0  

# Access to device  
spawn ssh -oStrictHostKeyChecking=no -oCheckHostIP=no $user@$device  
expect "*?assword:*"  
send -- "$pass\r"  

# Commands execution  
expect -exact "$prompt"  
send -- "display pdp-number\r"  
log_file -a $file

# Logging  
expect -exact "$prompt"  
log_file  
send -- "quit\r"  

# Get the value  
set result [exec cat $file | grep "ALL GTP" | cut -d " " -f14]  
set value [format %d $result]  

# Print the value  
puts ".1.3.6.1.4.1.6147.2.1"  
puts "Integer32"  
puts $value  # If I replace the $value with a number, it doesn't work either  

# Erase log file  
exec rm $file  
close 
```

你能给我一些提示吗？提前致谢！

**编辑：**

此外，这些是 snmpget 调试输出的最后几行：

```
trace: snmp_comstr_parse(): snmp_auth.c, 135:  
dumph_recv:   SNMP version  
dumpx_recv:    02 01 01 
dumpv_recv:      Integer:       1 (0x01)  
trace: snmp_comstr_parse(): snmp_auth.c, 147:  
dumph_recv:   community string  
dumpx_recv:    04 0A 54 4D 5F 43 6F 6D 5F 50 75 62   
dumpv_recv:      String:        TM_Com_Pub  
trace: _snmp_parse(): snmp_api.c, 4149:  
dumph_recv:   PDU  
trace: snmp_pdu_parse(): snmp_api.c, 4255:  
dumpv_recv:     Command RESPONSE  
trace: snmp_pdu_parse(): snmp_api.c, 4336:  
dumph_recv:     request_id  
dumpx_recv:      02 04 3B 9E CF 74   
dumpv_recv:        Integer:     1000263540 (0x3B9ECF74)  
trace: snmp_pdu_parse(): snmp_api.c, 4347:  
dumph_recv:     error status  
dumpx_recv:      02 01 00   
dumpv_recv:        Integer:     0 (0x00)  
trace: snmp_pdu_parse(): snmp_api.c, 4358:  
dumph_recv:     error index  
dumpx_recv:      02 01 00   
dumpv_recv:        Integer:     0 (0x00)  
trace: snmp_pdu_parse(): snmp_api.c, 4376:  
dumph_recv:     VarBindList  
trace: snmp_pdu_parse(): snmp_api.c, 4406:  
dumph_recv:       VarBind  
trace: snmp_parse_var_op(): snmp.c, 166:  
dumph_recv:         Name  
dumpx_recv:          06 09 2B 06 01 04 01 B0 03 02 01   
dumpv_recv:            ObjID: TDP-MIB::PDPContextsNumber  
trace: snmp_pdu_parse(): snmp_api.c, 4415:  
dumph_recv:         Value  
TDP-MIB::PDPContextsNumber = No Such Instance currently exists at this OID 
```

另外，这是我当前的 MIB：

```
TDP-MIB DEFINITIONS ::= BEGIN  

IMPORTS  
    MODULE-IDENTITY, OBJECT-TYPE, Integer32, enterprises  
                    FROM SNMPv2-SMI  
    OBJECT-GROUP    FROM SNMPv2-CONF;   

TDP MODULE-IDENTITY  
    LAST-UPDATED "201210080000Z" -- 8/oct/2012  
    ORGANIZATION    "TELEFONICA"  
    CONTACT-INFO    "Authors: Hernan Romano / Antonio Ocampo  
                     Email: h.romanoc@pucp.edu.pe / aocampo@pucp.edu.pe"  
    DESCRIPTION     "MIB para gestionar los equipos que carecen de SNMP"  
    REVISION        "201210080000Z" -- 08/oct/2012  
    DESCRIPTION     "Revision 2.1"  
    ::= { enterprises 6147 }    

Nokia                   OBJECT IDENTIFIER ::= { TDP 1 }  
Huawei                  OBJECT IDENTIFIER ::= { TDP 2 }  
TDPMIBConformance       OBJECT IDENTIFIER ::= { TDP 3 }  

ClearCodeGroup1         OBJECT-TYPE  
                        SYNTAX Integer32  
                        MAX-ACCESS read-only  
                        STATUS current  
                        DESCRIPTION "Clear Code Group 1"  
                        ::= { Nokia 1 }  

PDPContextsNumber       OBJECT-TYPE  
                        SYNTAX Integer32  
                        MAX-ACCESS read-only  
                        STATUS current  
                        DESCRIPTION "PDP Contexts Number"  
                        ::= { Huawei 1 }  

TDPMIBGroup             OBJECT IDENTIFIER  
                        ::= { TDPMIBConformance 1 }  

--grupoTDP      OBJECT-GROUP  
--      OBJECTS {  
--              ClearCodeGroup1,  
--              PDPContextsNumber  
--      }  
--      STATUS current  
--      DESCRIPTION "Objetos para el monitoreo de los equipos que carecen de SNMP"  
--      ::= { TDPMIBGroup 1 }  
END 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T19:12:27.357

终于解决了:) 问题是路径文件。

而不是相对路径：
**设置文件“./GGSN-PDP-Contexts.log”**

我把绝对路径：
**设置文件“/FULL_PATH/GGSN-PDP-Contexts.log”**

和 snmpget 工作！

```
root@box:/path# snmpget -m TDP-MIB  -v 2c -c TM_Com_Pub localhost .1.3.6.1.4.1.6147.2.1  
TDP-MIB::PDPContextsNumber = INTEGER: 319291 
```

# c++ - 如何在不破坏 vtbl 的情况下做相当于 memset(this, ...) 的操作？

> ID：12902651
> 
> 赞同：7
> 
> 时间：2012-10-15T19:28:15.190
> 
> 标签：c++, initialization

我知道 memset 不赞成`class`初始化。例如，如下所示：

```
class X { public: 
X() { memset( this, 0, sizeof(*this) ) ; }
...
} ; 
```

`vtbl`如果混合中有一个`virtual`函数， 将会破坏。

我正在开发一个（巨大的）遗留代码库，它是 C-ish 但用 C++ 编译的，所以所有有问题的成员通常都是 POD，不需要传统的 C++ 构造函数。C++ 的使用逐渐普及（就像虚函数一样），这让那些没有意识到 memset 具有这些额外的 C++ 牙齿的开发人员陷入了困境。

我想知道是否有一种 C++ 安全的方法来进行初始的全部零初始化，然后可能是不适合零初始化的特定的成员初始化？

我发现类似的问题[memset 用于 C++ 中的初始化](https://stackoverflow.com/questions/2481654/memset-for-initialization-in-c)，并[使用 memset 将派生结构归零](https://stackoverflow.com/questions/7082691/zeroing-derived-struct-using-memset)。这两个都有“不要使用 memset()”的答案，但没有好的选择（尤其是对于可能包含许多成员的大型结构）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-15T19:39:38.537

对于找到`memset`调用的每个类，添加一个`memset`成员函数，该函数忽略指针和大小参数，并对所有数据成员进行赋值。

*编辑：* 实际上，它不应该忽略指针，它应该将它与`this`. 在匹配时，为对象做正确的事情，在不匹配时，重新路由到全局函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T19:34:00.330

You could always add constructors to these embedded structures, so they clear themselves so to speak.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-15T19:38:43.310

这很可怕，但是您*可以*为这些对象（或在公共基类中）重载`operator new/delete`，并让实现提供零缓冲。像这样的东西：

```
class HideousBaseClass
{
public:
    void* operator new( size_t nSize )
    {
        void* p = malloc( nSize );
        memset( p, 0, nSize );
        return p;
    }
    void operator delete( void* p )
    {
        if( p )
            free( p );
    }
}; 
```

也可以覆盖*全局* `new/delete`运算符，但这可能会产生负面的性能影响。

**编辑：**我刚刚意识到这种方法不适用于堆栈分配的对象。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-15T19:42:08.143

尝试这个：

```
template <class T>
void reset(T& t)
{
   t = T();
} 
```

这将使您的对象归零 - 无论它是否是 POD。

但不要这样做：

```
 A::A() { reset(*this); } 
```

这将在无限递归中调用`A::A`！！！

尝试这个：

```
 struct AData { ... all A members };
  class  A { 
   public: 
      A() { reset(data); } 
   private: 
      AData data; 
   }; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-06-29T14:57:00.707

利用静态实例初始化为零的事实： [https ://ideone.com/GEFKG0](https://ideone.com/GEFKG0)

```
template <class T>
struct clearable
{
    void clear()
    {
        static T _clear;
        *((T*)this) = _clear;
    };
};

class test : public clearable<test>
{
    public:
        int a;
};

int main()
{
    test _test;
    _test.a=3;
    _test.clear();

    printf("%d", _test.a);

    return 0;
} 
```

然而，上述将导致（模板化类的）构造函数被第二次调用。

对于导致没有 ctor 调用的解决方案，可以使用它来代替：[https ://ideone.com/qTO6ka](https://ideone.com/qTO6ka)

```
template <class T>
struct clearable
{
    void *cleared;
    clearable():cleared(calloc(sizeof(T), 1)) {}

    void clear()
    {
        *((T*)this) = *((T*)cleared);
    };
}; 
```

...如果您使用 C++11 及以后版本，则可以使用以下内容：[https ://ideone.com/S1ae8G](https://ideone.com/S1ae8G)

```
template <class T>
struct clearable
{
    void clear()
    {
        *((T*)this) = {};
    };
}; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-15T20:05:37.093

您可以使用指针算法来查找要归零的字节范围：

```
class Thing {
public:
    Thing() {
        memset(&data1, 0, (char*)&lastdata - (char*)&data1 + sizeof(lastdata));
    }
private:
    int data1;
    int data2;
    int data3;
    // ...
    int lastdata;
}; 
```

（编辑：我最初用于`offsetof()`此，但评论指出这仅适用于 POD，然后我意识到您可以直接使用成员地址。）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-10-15T20:57:33.490

我能找到的更好的解决方案是创建一个单独的结构，您将在其中将必须 memsetted 的成员设置为零。不确定这个设计是否适合你。

这个结构没有 vtable 并且没有扩展。这将只是一大块数据。这种方式 memsetting 结构是安全的。

我做了一个例子：

```
#include <iostream>
#include <cstring>

struct X_c_stuff {
    X_c_stuff() {
        memset(this,0,sizeof(this));
    }
    int cMember;
};
class X : private X_c_stuff{
public:
    X() 
    : normalMember(3)
    {
        std::cout << cMember << normalMember << std::endl;
    }
private:
    int normalMember;
};

int main() {
    X a;
    return 0;
} 
```

# javascript - Sinon.js 存根和测试以对象为参数的外部函数调用，稍后由 ref 修改

> ID：12902652
> 
> 赞同：1
> 
> 时间：2012-10-15T19:28:15.747
> 
> 标签：javascript, jquery, unit-testing, qunit, sinon

我正在寻找测试我的函数对另一个函数的调用，特别是作为对象的参数。

问题是 sinon.js 似乎存储了对其参数数组中给出的对象参数的引用，这自然是意料之中的。但是，这会在稍后由 ref 修改参数时产生问题，这会在调用函数时更改这些参数的*表观*值。

对这种情况进行单元测试的最佳方法是什么？

这是一个人为的例子：

## [http://jsfiddle.net/xtfQu/](http://jsfiddle.net/xtfQu/)

```
var view = Backbone.View.extend({
    initialize: function () {
        _.bindAll(this);    
    },

    dostuff: function () {
        var coords = { x: 0, y: 0 };
        for (var i = 0; i < 10; i++) {
            this.otherstuff(coords);

            coords.x += 10;
        }
    },

    otherstuff: function (coord) {
        // Stubbed
    }
});

test("a test", function() {
    // Arrange
    var blah = new view();

    sinon.stub(blah, 'otherstuff');

    // Act
    blah.dostuff();

    // Assert
    var expectedFirstCallCoords = { x: 0, y: 0 };

    // All assertions on the value of x for a particular call would seem to be impossible.
    // blah.otherstuff.firstCall.args[0].x --> 100
    deepEqual(blah.otherstuff.firstCall.args[0], expectedFirstCallCoords, 'parameter changed by ref, untestable?');
});​ 
```

我可以想到围绕这个“问题”的各种技巧。有没有一种更简洁的方法，不涉及克隆对象或仅仅为了让 sinon 工作而修改我的生产代码？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-16T14:09:20.420

感谢 Mantoni 在[Github](https://github.com/cjohansen/Sinon.JS/issues/184#issuecomment-9473934)上对此的相关讨论：

```
var param = { property: 'value' };
var engage = sinon.stub();
var engageWithValue = engage.withArgs(sinon.match({ property : 'value' }));

engage(param);

param.property = 'new value';

sinon.assert.calledOnce(engageWithValue); // passes 
```

# function - 在matlab中绘制一个涉及积分的函数

> ID：12902654
> 
> 赞同：3
> 
> 时间：2012-10-15T19:28:37.357
> 
> 标签：function, matlab

我正在尝试绘制一个包含定积分的函数。我的代码使用所有匿名函数。当我运行该文件时，它给了我一个错误。我的代码如下：

```
 %%% List of Parameters %%%
    gamma_sp = 1;   
    cap_gamma = 15;   
    gamma_ph = 0;   
    omega_0 = -750;   
    d_omega_0 = 400;   
    omega_inh = 100;   
    d_omega_inh = 1000;   

    %%% Formulae %%%   
    gamma_t = gamma_sp/2 + cap_gamma/2 + gamma_ph;   
    G = @(x) exp(-(x-omega_inh).^2./(2*d_omega_inh.^2))./(sqrt(2*pi)*d_omega_inh);   
    F = @(x) exp(-(x-omega_0).^2./(2*d_omega_0.^2))./(sqrt(2*pi)*d_omega_0);   
    A_integral = @(x,y) G(x)./(y - x + 1i*gamma_t);   
    Q_integral = @(x,y) F(x)./(y - x + 1i*gamma_t);   
    A = @(y) integral(@(x)A_integral(x,y),-1000,1000);   
    Q = @(y) integral(@(x)Q_integral(x,y),-3000,0);   

    P1 = @(y) -1./(1i.*(gamma_sp + cap_gamma)).*(1./(y + 2.*1i.*gamma_t)*(A(y)-conj(A(0)))-1./y.*(A(y)-A(0))+cap_gamma./gamma_sp.*Q(y).*(A(0)-conj(A(0))));   

    P2 = @(y) conj(P1(y));   
    P = @(y) P1(y) - P2(y);
    sig = @(y) abs(P(y)).^2;

    rng = -2000:0.05:1000;   
    plot(rng,sig(rng)) 
```

在我看来，当程序运行 plot 命令时，它应该将 rng 的每个值放入 sig(y) 中，并且该值将用作 A_integral 和 Q_integral 中的 y 值。但是，当我尝试运行该程序时，matlab 会引发错误。

```
Error using  - 
Matrix dimensions must agree.

Error in @(x,y)G(x)./(y-x+1i*gamma_t)

Error in @(x)A_integral(x,y)

Error in integralCalc/iterateScalarValued (line 314)
            fx = FUN(t);

Error in integralCalc/vadapt (line 133)
        [q,errbnd] = iterateScalarValued(u,tinterval,pathlen);

Error in integralCalc (line 76)
    [q,errbnd] = vadapt(@AtoBInvTransform,interval);

Error in integral (line 89)
Q = integralCalc(fun,a,b,opstruct);

Error in @(y)integral(@(x)A_integral(x,y),-1000,1000)

Error in
@(y)-1./(1i.*(gamma_sp+cap_gamma)).*(1./(y+2.*1i.*gamma_t)*(A(y)-conj(A(0)))-1\.    /y.*(A(y)-A(0))+cap_gamma./gamma_sp.*Q(y).*(A(0)-conj(A(0))))

Error in @(y)P1(y)-P2(y)

Error in @(y)abs(P(y)).^2

Error in fwm_spec_diff_paper_eqn (line 26)
plot(rng,sig(rng)) 
```

关于我做错了什么的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T19:57:10.337

你有

```
>> rng = -2000:0.05:1000;   
>> numel(rng) 
ans = 
    60001 
```

所有 60001 个元素都被传递给

```
A = @(y) integral(@(x)A_integral(x,y),-1000,1000); 
```

调用

```
A_integral = @(x,y) G(x)./(y - x + 1i*gamma_t); 
```

（与 Q 类似）。问题是，`integral`它是一种自适应正交方法，这意味着（粗略地）`x`它将插入的 ' 的数量`A_integral`随`A_integral`特定 的行为而变化`x`。

因此， in 中的元素数量`y`通常会与`x`调用中的元素不同`A_integral`。这就是`y-x +1i*gamma_t`失败的原因。

考虑到您尝试做的事情的复杂性，我认为最好将所有匿名函数重新定义为适当的函数，并将其中一些函数集成到单个函数中。查看文档`bsxfun`以查看是否有帮助（例如，`bsxfun(@minus, y.', x)`而不是`y-x`可能修复其中一些问题），否则，仅在 中进行矢量化`x`和循环`y`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T22:10:48.083

谢谢罗迪，这对我来说很有意义。我一直在尝试使用像mathematica 这样的matlab，但我忘记了matlab 是如何做事的。我稍微修改了代码，它产生了正确的结果。积分的评估非常粗略，但应该很容易解决。我已经在下面发布了我修改后的代码。

```
%%% List of Parameters %%%
gamma_sp = 1;
cap_gamma = 15;
gamma_ph = 0;
omega_0 = -750;
d_omega_0 = 400;
omega_inh = 100;
d_omega_inh = 1000;

%%% Formulae %%%
gamma_t = gamma_sp/2 + cap_gamma/2 + gamma_ph;
G = @(x) exp(-(x-omega_inh).^2./(2*d_omega_inh.^2))./(sqrt(2*pi)*d_omega_inh);
F = @(x) exp(-(x-omega_0).^2./(2*d_omega_0.^2))./(sqrt(2*pi)*d_omega_0);
A_integral = @(x,y) G(x)./(y - x + 1i*gamma_t);
Q_integral = @(x,y) F(x)./(y - x + 1i*gamma_t);

w = -2000:0.05:1000;
sigplot = zeros(size(w));
P1plot = zeros(size(w));
P2plot = zeros(size(w));
Pplot = zeros(size(w));
aInt_range = -1000:0.1:1200;
qInt_range = -2000:0.1:100;
A_0 = sum(A_integral(aInt_range,0).*0.1);

for k=1:size(w,2)

P1plot(k) = -1./(1i*(gamma_sp + cap_gamma)).*(1./(w(k)+2.*1i.*gamma_t).*(sum(A_integral(aInt_range,w(k)).*0.1)-conj(A_0))-1./w(k).*(sum(A_integral(aInt_range,w(k)).*0.1)-A_0)+cap_gamma./gamma_sp.*sum(Q_integral(qInt_range,w(k)).*0.1).*(A_0-conj(A_0)));
P2plot(k) = conj(P1plot(k));
Pplot(k) = P1plot(k) - P2plot(k);
sigplot(k) = abs(Pplot(k)).^2;

end

plot(w,sigplot) 
```

# python - 遍历列表以将值附加到变量列表

> ID：12902656
> 
> 赞同：0
> 
> 时间：2012-10-15T19:28:40.463
> 
> 标签：python, list, append, tuples, loops

我有以下数据：

```
data = [['AB', 'BS, BT'], ['AH', 'AH'], ['AS', 'AS, GS']] 
```

我想遍历列表列表以生成元组列表。

```
new_data = [('AB', 'BS'), ('AB', 'BT'), ('AH', 'AH'), ('AS', 'AS') ('AS', 'GS')] 
```

我正在考虑使用 zip() 函数，但不确定我是否使用了正确的逻辑。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T19:52:28.597

`zip`不会是我的第一选择。`itertools.product`我的第一选择是`itertools.chain`

```
In [103]: data = [['AB', 'BS, BT'], ['AH', 'AH'], ['AS', 'AS, GS']]

In [104]: [list(itertools.product([d[0]], d[1].split(','))) for d in data]
Out[104]: [[('AB', 'BS'), ('AB', ' BT')], [('AH', 'AH')], [('AS', 'AS'), ('AS', ' GS')]]

In [105]: list(itertools.chain.from_iterable([list(itertools.product([d[0]], d[1].split(','))) for d in data]))
Out[105]: [('AB', 'BS'), ('AB', ' BT'), ('AH', 'AH'), ('AS', 'AS'), ('AS', ' GS')] 
```

希望这可以帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T19:38:41.903

这可以很容易地用[`itertools.repeat()`](http://docs.python.org/py3k/library/itertools.html#itertools.repeat). 我们使用它来为每个其他项目重复第一个项目，我们通过拆分来获得它`","`，然后拉上拉链以生成我们的元组。然后我们用它[`itertools.chain.from_iterable()`](http://docs.python.org/py3k/library/itertools.html#itertools.chain.from_iterable)来生成一个列表。

```
>>> import itertools
>>> data = [['AB', 'BS, BT'], ['AH', 'AH'], ['AS', 'AS, GS']]
>>> for item in itertools.chain.from_iterable(zip(itertools.repeat(first), second.split(",")) for first, second in data):
...     print(item)
... 
('AB', 'BS')
('AB', ' BT')
('AH', 'AH')
('AS', 'AS')
('AS', ' GS') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T19:39:52.093

使用`zip()`：

```
In [32]: data
Out[32]: [['AB', 'BS, BT'], ['AH', 'AH'], ['AS', 'AS, GS']]

In [33]: [zip([x[0]]*len(x[1].split(",")),x[1].split(",")) for x in data]
Out[33]: [[('AB', 'BS'), ('AB', ' BT')], [('AH', 'AH')], [('AS', 'AS'), ('AS', ' GS')]] 
```

用于`chain()`获得预期的输出：

```
In [34]: lis=[zip([x[0]]*len(x[1].split(",")),x[1].split(",")) for x in data]

In [35]: list(chain(*lis))
Out[35]: [('AB', 'BS'), ('AB', ' BT'), ('AH', 'AH'), ('AS', 'AS'), ('AS', ' GS')] 
```

使用`izip_longest`,`fillvalue`等于每个子列表的第一个元素：

```
In [47]: from itertools import chain,izip_longest

In [48]: lis=[tuple(izip_longest([x[0]],x[1].split(","),fillvalue=x[0])) for x in data]

In [49]: lis
Out[49]: [(('AB', 'BS'), ('AB', ' BT')), (('AH', 'AH'),), (('AS', 'AS'), ('AS', ' GS'))]

In [50]: list(chain(*lis))
Out[50]: [('AB', 'BS'), ('AB', ' BT'), ('AH', 'AH'), ('AS', 'AS'), ('AS', ' GS')] 
```

# trigger.io - Trigger.io 顶栏 jQuery Mobile iOS 错误

> ID：12902660
> 
> 赞同：0
> 
> 时间：2012-10-15T19:29:01.457
> 
> 标签：trigger.io, forge

我有一个问题，内容 div 中的文本是可滚动的。在 iOS 6 和 iPhone 4 上发生，并且仅在设置了本机标题时发生。

视频：[http ://www.youtube.com/watch?v=8ARaDQzBqOM](http://www.youtube.com/watch?v=8ARaDQzBqOM)

演示：

```
<!DOCTYPE html> 
<html>
    <head>
    <script>
    forge.topbar.setTitle('Test App', function() {
        forge.logging.log("Topbar image set");
        }, function(e) {
        forge.logging.log("Topbar image error: " + e);
    });
    </script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1"> 
    <title>Single page template</title> 
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
    <script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
    <script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>
</head> 

<body> 
    <div data-role="page">
        <div data-role="content">   
            <p>this text is scrollable</p>
        </div>
    </div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T07:08:09.113

您可能想尝试使用 CSS 重置所有元素的所有边距、填充和边框。在结束之前添加这个`</head>`：

```
<style type="text/css">    
  * { /* reset */
    margin: 0;
    padding: 0;
    border: 0;
  }
</style> 
```

# python - 从测试中计算最终成绩

> ID：12902661
> 
> 赞同：0
> 
> 时间：2012-10-15T19:29:05.573
> 
> 标签：python, python-2.7, python-2.x

```
Lloyd = {
    "name":"Lloyd",
    "homework": [90,97,75,92],
    "quizzes": [ 88,40,94],
    "tests": [ 75,90]
    }
Alice = {
    "name":"Alice",
    "homework": [100,92,98,100],
    "quizzes": [82,83,91],
    "tests": [89,97]
    }
Tyler = {
    "name":"Tyler",
    "homework": [0,87,75,22],
    "quizzes": [0,75,78],
    "tests": [100,100]
    }

def average(value):
    avg=0
    items = len(value)
    for item in value:
        avg +=item 
    return avg/items

def getAverage(dictin):
    hw = average(dictin.get('homework'))
    quiz = average(dictin.get('quizzes'))
    tests = average(dictin.get('tests'))
    weighted_average = hw*.1 + quiz*.3 + tests*.6
    return weighted_average

def getLetterGrade(score):
    if score >=90:
        return "A"
    elif score < 90 and score >= 80:
        return "B"
    elif score < 80 and score >= 70:
        return "C"
    elif score < 70 and score >= 60:
        return "D"
    elif score < 60:
        return "F"
    else:
        return "No grades for you"

score = getAverage(Lloyd)
grade = getLetterGrade(score)
print grade 
```

这很好用，但我被告知在分数为 89.5 的情况下，它不起作用。我也尝试过，但我无法找出问题所在。欢迎任何错误。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-15T19:32:50.820

问题可能在于`average`您将一个整数 ( `avg`) 除以另一个整数 ( `items`) 的函数中。由于两个操作数都是整数，Python 也将结果转换为整数，因此该`average`函数永远不会返回分数。

有很多可能的解决方案：

1.  在除法之前将其中一个操作数（`avg`或`items`）转换为浮点数；例如`return float(avg)/items`，或`return (avg+0.0)/items`。

2.  让我们`avg`从 0.0 而不是 0 开始 - 这确保它`avg`始终是一个浮点数。

3.  添加`from __future__ import division`到代码的最开头。这指示 Python 以 Python 3.x 的方式使用除法并始终返回一个浮点数。

*更新*：另外，根据 MrGingerbear 的评论，您可以考虑将分数向上或向下舍入`getLetterGrade`。如果你从模块中导入`ceil`and`floor`函数`math`，你可以说`ceil(score)`向上`floor(score)`舍入、向下舍入或`round(score)`四舍五入到最接近的整数。

# spring - 在 Spring 3.1 中注入资源依赖项失败

> ID：12902664
> 
> 赞同：1
> 
> 时间：2012-10-15T19:29:34.490
> 
> 标签：spring, autowired

感谢有关注入依赖项错误的任何帮助。当 bean 独立运行时，同样的事情也能完美运行。在 apache 6.0.35 启动期间，它会抛出以下错误。提前感谢任何帮助和感谢。我正在使用 Spring 3.1.1

```
**SEVERE: Exception sending context initialized event to listener instance of class org.springframework.web.context.ContextLoaderListener
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'appConfigBean': Injection of resource dependencies failed; nested exception is 
org.springframework.beans.factory.NoSuchBeanDefinitionException: No bean named 'ExtConfigBean' is defined** 
```

完整的代码和配置如下

Java 代码

```
 @Configuration
@PropertySource("classpath:application.properties")
@Component
@Service
public class AppConfig implements ApplicationConstants, ApplicationContextAware {

    @Autowired
    private ApplicationContext applicationContext;

    /**
     * Main Map Bean
     */
    @Resource(name = "ExtConfigBean")
    private LinkedHashMap<String, String> extConfigBeanMap;

        @Override
    public void setApplicationContext(ApplicationContext applicationContext) throws BeansException {
        System.out.println("Autowiring Context Ref: " + applicationContext);
        this.applicationContext = applicationContext;
    }
} 
```

应用程序属性

```
application=ApplicationTest
version=1.0.0
release=July 2012 
```

ApplicationContext 文件是

```
 <?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:context="http://www.springframework.org/schema/context"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:util="http://www.springframework.org/schema/util"
    xmlns:tx="http://www.springframework.org/schema/tx" xmlns:aop="http://www.springframework.org/schema/aop"
    xmlns:lang="http://www.springframework.org/schema/lang" xmlns:p="http://www.springframework.org/schema/p"
    xmlns:mvc="http://www.springframework.org/schema/mvc" xmlns:beans="http://www.springframework.org/schema/beans"
    xsi:schemaLocation="http://www.springframework.org/schema/beans 
       http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
       http://www.springframework.org/schema/util 
       http://www.springframework.org/schema/util/spring-util-2.0.xsd
       http://www.springframework.org/schema/tx 
       http://www.springframework.org/schema/tx/spring-tx-2.0.xsd
       http://www.springframework.org/schema/aop 
       http://www.springframework.org/schema/aop/spring-aop-2.0.xsd
       http://www.springframework.org/schema/lang 
       http://www.springframework.org/schema/lang/spring-lang-2.0.xsd
       http://www.springframework.org/schema/context
       http://www.springframework.org/schema/context/spring-context-3.1.xsd
       http://www.springframework.org/schema/oxm
       http://www.springframework.org/schema/oxm/spring-oxm-3.0.xsd
       http://www.springframework.org/schema/mvc 
       http://www.springframework.org/schema/mvc/spring-mvc-3.1.xsd">

    <!-- Configures the @Controller programming model -->
    <mvc:annotation-driven />

    <!-- Activates scanning of @Autowired -->
    <context:annotation-config />
    <!-- <bean class="org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor" /> -->

    <!-- Activates scanning of @Repository and @Service -->
    <context:component-scan
        base-package="com.app.test ">
    </context:component-scan>

    <!-- Application wide Spring Injection -->
    <bean id="contextProvider" class="com.app.test.AppContextProvider" lazy-init="false" />

    <bean id="appConfigBean" class="com.app.test.config.AppConfig" lazy-init="false" />

        <!-- Application Configuration -->
    <bean id="ExtConfigBean" class="org.springframework.beans.factory.config.MapFactoryBean">
        <property name="sourceMap">
            <map>
                <entry key="some_key">
                    <value>Some Key Value</value>
                </entry>
            </map>
        </property>
    </bean>
</beans> 
```

web.xml

```
<?xml version="1.0" encoding="UTF-8"?> 
```

http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd">

```
<!-- Java-based Spring container definition -->
<context-param>
    <param-name>contextClass</param-name>
    <param-value>org.springframework.web.context.support.AnnotationConfigWebApplicationContext</param-value>
</context-param>

<!-- Location of Java @Configuration classes that configure the components 
    that makeup this application -->
<context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>com.xxx.ealert.app.config</param-value>
</context-param>

<!-- Creates the Spring Container shared by all Servlets and Filters -->
<listener>
    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
</listener>

<!-- Processes application requests -->
<servlet>
    <servlet-name>Spring MVC Dispatcher Servlet</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <init-param>
        <param-name>contextConfigLocation</param-name>
        <param-value></param-value>
    </init-param>
    <load-on-startup>1</load-on-startup>
</servlet>

<servlet-mapping>
    <servlet-name>Spring MVC Dispatcher Servlet</servlet-name>
    <url-pattern>/</url-pattern>
</servlet-mapping>

<!-- Secures the application -->
<filter>
    <filter-name>securityFilter</filter-name>
    <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
    <init-param>
        <param-name>targetBeanName</param-name>
        <param-value>springSecurityFilterChain</param-value>
    </init-param>
</filter>

<filter-mapping>
    <filter-name>securityFilter</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping>

<!-- Reads request input using UTF-8 encoding -->
<filter>
    <filter-name>characterEncodingFilter</filter-name>
    <filter-class>org.springframework.web.filter.CharacterEncodingFilter</filter-class>
    <init-param>
        <param-name>encoding</param-name>
        <param-value>UTF-8</param-value>
    </init-param>
    <init-param>
        <param-name>forceEncoding</param-name>
        <param-value>true</param-value>
    </init-param>
</filter>

<filter-mapping>
    <filter-name>characterEncodingFilter</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping> 
```

# c# - 等效于 mvc3 中的 validateRequest

> ID：12902674
> 
> 赞同：0
> 
> 时间：2012-10-15T19:30:22.423
> 
> 标签：c#, asp.net, asp.net-mvc-3

我在这里阅读：http: [//msdn.microsoft.com/en-us/library/ff649310.aspx#paght000004_step1](http://msdn.microsoft.com/en-us/library/ff649310.aspx#paght000004_step1)在您的 machine.config 中设置的第一步：

```
<system.web>
  <pages buffer="true" validateRequest="true" />
</system.web> 
```

这是否已经在 mvc3 中使用 [Authorize] 过滤器处理了？或者我还是应该把它放在我的 web.config 中

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T19:36:18.323

您可以使用属性：

```
[ValidateInput(false)]
public ActionResult Index(string InputText)
{
    return View();
} 
```

另请参阅这篇文章：[了解 ASP.NET MVC 3 中的请求验证](http://weblogs.asp.net/imranbaloch/archive/2011/02/19/understanding-request-validation-in-asp-net-mvc-3.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T20:02:54.900

使用 [Authorize] 过滤器，您可以将特定操作/控制器的访问权限限制为选定的用户和角色。

请求验证基本上断言在操作中提交的值不是潜在有害的 html 字符串（将它们未编码放回页面可能是危险的）。您可以通过属性 validateRequest="true/false" 使用配置文件在全局级别控制请求验证。您可以使用操作过滤器 ([ValidateInput(true/false)]) 覆盖配置文件设置（还有一些其他选项）。

当然，您可以将这两件事联系起来，它们都是某种类型的验证和安全机制。尽管如此，它们都是非常不同类型的验证，您应该将它们视为相当独立的事物。

回顾您的问题，您应该将 validateRequest="true" 放在 web.config 中（这样无论 machine.config 设置如何，您都可以进行请求验证）。

# asp.net-mvc-4 - SimpleMembershipInitializer 不会初始化

> ID：12902685
> 
> 赞同：8
> 
> 时间：2012-10-15T19:30:48.747
> 
> 标签：asp.net-mvc-4, ef-database-first, simplemembership

我正在努力在我的 EntityFramework / MVC4 / DatabaseFirst 项目中获得一个简单的成员资格方案。我发现了很多首先使用代码的示例，但没有先使用 DB。

我遇到的问题是 InitializeDatabaseConnection 抛出错误（“无法找到请求的 .Net Framework 数据提供程序。它可能未安装。”）代码如下所示：

```
WebSecurity.InitializeDatabaseConnection("DALEntities", "tblContacts1", "ContactID", "EMail", autoCreateTables: true); 
```

我不确定什么 DataProvider 失败了。如果我尝试跟踪“进入” InitializeDatabaseConnection 调用，它会立即引发错误。

我错过了什么？

信息：
DALEntities 是其余 EF 使用的 connectionString 的名称。下面的代码工作得很好......

```
 public ActionResult Test() {
        using (var db = new DALEntities()) {
            var query = from i in db.TBLINVENTORies
                            orderby i.ITEMNAME
                            select i;
            var cnt = query.Count();
            string str = "Total Inventory: " + cnt;
            return Content(str);
        }
    } 
```

我来自 web.config 的连接字符串部分：

```
 <connectionStrings>
    <add name="DALEntities" connectionString="metadata=res://*/DAL.DAL.csdl|res://*/DAL.DAL.ssdl|res://*/DAL.DAL.msl;provider=System.Data.SqlClient;provider connection string=&quot;data source=SOMECOMPUTER;initial catalog=SOMEDB;persist security info=True;user id=SOMEID;password=SOMEPASS;multipleactiveresultsets=True;App=EntityFramework&quot;" providerName="System.Data.EntityClient" />
  </connectionStrings> 
```

这篇文章似乎在问同样的问题（但在模型优先的背景下），但还没有解决方案：[Using SimpleMembership with EF model-first](https://stackoverflow.com/questions/12575311/using-simplemembership-with-ef-model-first)

另外，我看到`WebSecurity.InitializeDatabaseConnection()`帮助文本有一个重载：`Initializes the membership system ((blah blah <snip> ProviderName: the name of the ADO.NET data provider. If you want to use Microsoft SQL Server, the WebMatrix.WebData.WebSecurity.InitializeDatabaseConnection(String, String, String, String, Boolean) overload is recommended`. 我*确实*希望连接到 MSSQL 服务器……这需要吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-15T20:15:35.273

给您带来麻烦的提供程序是您的连接字符串中指定的一个，即 System.Data.EntityClient。我怀疑问题是因为您的项目是数据库优先的，而简单的成员资格是使用代码优先的。我认为您不能将这些方法混合在一个数据库中。尝试将其放回 DefaultConnection 用于 IntializeDatabaseConnection 的位置。MVC4 脚手架生成的 web.config 中应该有一个 DefaultConnection。此连接字符串通常使用 System.Data.SqlClient 作为提供程序。

如果您想在用于存储域信息（即 DALEntities）的数据库中保留简单的成员资格，那么您需要将在域上使用 EF 的方法更改为代码优先。如果您想首先保留项目数据库，您需要在数据库中设计自己的成员模式并[开发自定义成员和角色提供程序](http://www.asp.net/web-forms/videos/how-do-i/how-do-i-create-a-custom-membership-provider)。如果您真的想将用户信息集成到您的域模型中，这可能是最好的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-08-03T20:08:23.973

为了简单明了，保留两个连接字符串指向同一个数据库。一个用于 EF（无论是代码优先还是数据优先），一个用于您的 WebSecurity 东西。（正如乍得和埃里克所说）

```
<add name="DataEntities" connectionString="metadata=res://*/Models.DataEntities.csdl|res://*/Models.DataEntities.ssdl|res://*/Models.DataEntities.msl;provider=System.Data.SqlClient;provider connection string='data source=[YOUR_SERVER];initial catalog=[YOUR_DATABASE];integrated security=True;MultipleActiveResultSets=True;App=[YOUR_APP_NAME]'" providerName="System.Data.EntityClient" />
<add name="DataDB" connectionString="data source=[YOUR_SERVER];initial catalog=[YOUR_DATABASE];integrated security=True;MultipleActiveResultSets=True;App=[YOUR_APP_NAME]" providerName="System.Data.SqlClient" /> 
```

请注意，提供者是不同的：EF 使用 System.data.EntityClient，非 EF 使用 System.Data.SqlClient。

# tinymce - 如何在tinymce textarea中使用占位符

> ID：12902686
> 
> 赞同：1
> 
> 时间：2012-10-15T19:30:52.810
> 
> 标签：tinymce, placeholder

我如何在 tinymce 中使用占位符。这是我的问题。

我正在使用像 Я 这样的西里尔字母我在编辑器中手动输入 HTML 实体数字代码 (Я)，我不希望 tinymce 将其转换为 html 实体。那么我如何用占位符“[swap]”将它保存在tinymce中，然后在psql中进行替换。
我必须为这几个条目。更新
我试过：entity_encoding：“raw”没有成功

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T20:30:50.263

您也可以使用 html 覆盖，这更容易：

喜欢：

```
<div id="placeholder" style="position: relative; top: 20px;">My Placeholder</div>

<textarea id="tinybox" name="tinymcebox"></textarea> 
```

使用 jQuery，您可以创建：

```
$("#placeholder").click(function(){
    $(this).hide();
});
$("#tinybox").click(function(){
    $('#placeholder').hide();
}); 
```

然后你就知道特殊字符显示得很好。

# c++ - Nvidia NPP nppiFilter 在与 2d 内核卷积时产生垃圾

> ID：12902688
> 
> 赞同：6
> 
> 时间：2012-10-15T19:31:00.487
> 
> 标签：c++, image-processing, cuda, convolution, npp

[Nvidia Performance Primitives (NPP)](http://developer.nvidia.com/cuda/nvidia-performance-primitives)提供了`nppiFilter`将用户提供的图像与用户提供的内核进行卷积的功能。对于一维卷积核，`nppiFilter`可以正常工作。但是，`nppiFilter`正在为 2D 内核生成垃圾图像。

我使用典型的 Lena 图像作为输入： ![在此处输入图像描述](../Images/593bf555f7def434cd5dd501e692859b.png)

* * *

这是我对一**维**卷积核的实验，它产生了良好的输出。

```
#include <npp.h> // provided in CUDA SDK
#include <ImagesCPU.h> // these image libraries are also in CUDA SDK
#include <ImagesNPP.h>
#include <ImageIO.h>

void test_nppiFilter()
{
    npp::ImageCPU_8u_C1 oHostSrc;
    npp::loadImage("Lena.pgm", oHostSrc);
    npp::ImageNPP_8u_C1 oDeviceSrc(oHostSrc); // malloc and memcpy to GPU 
    NppiSize kernelSize = {3, 1}; // dimensions of convolution kernel (filter)
    NppiSize oSizeROI = {oHostSrc.width() - kernelSize.width + 1, oHostSrc.height() - kernelSize.height + 1};
    npp::ImageNPP_8u_C1 oDeviceDst(oSizeROI.width, oSizeROI.height); // allocate device image of appropriately reduced size
    npp::ImageCPU_8u_C1 oHostDst(oDeviceDst.size());
    NppiPoint oAnchor = {2, 1}; // found that oAnchor = {2,1} or {3,1} works for kernel [-1 0 1] 
    NppStatus eStatusNPP;

    Npp32s hostKernel[3] = {-1, 0, 1}; // convolving with this should do edge detection
    Npp32s* deviceKernel;
    size_t deviceKernelPitch;
    cudaMallocPitch((void**)&deviceKernel, &deviceKernelPitch, kernelSize.width*sizeof(Npp32s), kernelSize.height*sizeof(Npp32s));
    cudaMemcpy2D(deviceKernel, deviceKernelPitch, hostKernel,
                     sizeof(Npp32s)*kernelSize.width, // sPitch
                     sizeof(Npp32s)*kernelSize.width, // width
                     kernelSize.height, // height
                     cudaMemcpyHostToDevice);
    Npp32s divisor = 1; // no scaling

    eStatusNPP = nppiFilter_8u_C1R(oDeviceSrc.data(), oDeviceSrc.pitch(),
                                          oDeviceDst.data(), oDeviceDst.pitch(),
                                          oSizeROI, deviceKernel, kernelSize, oAnchor, divisor);

    cout << "NppiFilter error status " << eStatusNPP << endl; // prints 0 (no errors)
    oDeviceDst.copyTo(oHostDst.data(), oHostDst.pitch()); // memcpy to host
    saveImage("Lena_filter_1d.pgm", oHostDst); 
} 
```

带有内核的上述代码的输出`[-1 0 1]`——它看起来像一个合理的渐变图像： ![在此处输入图像描述](../Images/7c07abc4e30ce841c3218d9c21318251.png)

* * *

但是，`nppiFilter`如果我使用**2D**卷积核，则会输出垃圾图像。以下是我从上面的代码更改为使用 2D 内核运行的内容`[-1 0 1; -1 0 1; -1 0 1]`：

```
NppiSize kernelSize = {3, 3};
Npp32s hostKernel[9] = {-1, 0, 1, -1, 0, 1, -1, 0, 1};
NppiPoint oAnchor = {2, 2}; // note: using anchor {1,1} or {0,0} causes error -24 (NPP_TEXTURE_BIND_ERROR)
saveImage("Lena_filter_2d.pgm", oHostDst); 
```

**下面是使用 2D 内核的输出图像`[-1 0 1; -1 0 1; -1 0 1]`。**

# **我究竟做错了什么？**

![在此处输入图像描述](../Images/5d70cc940befc3826662101dac9d7312.png)

[这篇 StackOverflow 帖子](https://stackoverflow.com/questions/12778463/cuda-npp-filters)描述了一个类似的问题，如用户 Steenstrup 的图片所示：http: [//1ordrup.dk/kasper/image/Lena_boxFilter5.jpg](http://1ordrup.dk/kasper/image/Lena_boxFilter5.jpg)

* * *

最后的几点说明：

*   使用 2D 内核，对于某些锚值（例如`NppiPoint oAnchor = {0, 0}`or `{1, 1}`），我得到 error `-24`，`NPP_TEXTURE_BIND_ERROR`根据[NPP User Guide](http://developer.download.nvidia.com/compute/DevZone/docs/html/CUDALibraries/doc/NPP_Library.pdf)转换为。[这篇 StackOverflow 帖子](https://stackoverflow.com/questions/12778463/cuda-npp-filters)中简要提到了这个问题。
*   这段代码非常冗长。这不是主要问题，但有人对如何使这段代码更简洁有任何建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T23:15:02.457

您正在为内核数组使用 2D 内存分配器。内核数组是密集的一维数组，而不是像典型的 NPP 图像那样的二维跨步数组。

只需用大小为 kernelWidth*kernelHeight*sizeof(Npp32s) 的简单 cuda malloc 替换 2D CUDA malloc 并执行普通的 CUDA memcopy 而不是 memcopy 2D。

```
//1D instead of 2D
cudaMalloc((void**)&deviceKernel, kernelSize.width * kernelSize.height * sizeof(Npp32s));
cudaMemcpy(deviceKernel, hostKernel, kernelSize.width * kernelSize.height * sizeof(Npp32s), cudaMemcpyHostToDevice); 
```

顺便说一句，“比例因子”为 1 并不意味着没有比例。使用因子 2^(-ScaleFactor) 进行缩放。

# c# - 如何在 WebMatrix razor C# 中实现正则表达式（或类似的）？

> ID：12902691
> 
> 赞同：2
> 
> 时间：2012-10-15T19:31:05.080
> 
> 标签：c#, string, razor, webmatrix

我正在尝试在我的 C# 代码中使用正则表达式，我可以在此处找到一些示例，说明这些正则表达式对于我的原因可能是什么样的，但我无处可说明我应该如何（从语法上）将其实现到我的逻辑中和代码。

我尝试设置一个外部 .cs 文件，然后调用该方法，但返回的值无法以任何方式转换或使用。代码可以在这里找到：[检查字符串是否有足够强的密码](https://stackoverflow.com/questions/12899876/checking-strings-for-a-strong-enough-password)

无论如何，我只想知道如何检查（和测试）密码中的值，以确保它符合我指定的标准。

比建议使用正则表达式更好的方法（因为关于如何将它们合并到我自己的特定后勤设置中的信息非常稀疏且非常混乱）

...正在建议没有它们如何完成。

我知道我可以使用

```
foreach(char c in myString) 
```

然后逐个字符地单独测试，但我希望有一种更好的方法可以是正则表达式，解释（也就是说，解释如何将此建议付诸实施，而不仅仅是发布一串看似（但不是）随机字符并告诉，嘿使用那个！），或者根本不使用正则表达式，但可能是某种速记。

事实是我会使用正则表达式，但每次查找它们时，我似乎都无法在 WebMatrix 中找到任何可用的东西。

我希望能够测试密码以确保它同时具有大写和小写数字。此外，我需要检查至少一个号码。

更新：好的，请允许我改写我的问题，也许我很困惑......

正则表达式如何在 webmatrix razor (C#) 中工作。请展示正则表达式的实际工作原理（我似乎无法在 webmatrix 的网络上找到一个明确的，甚至接近于明确的答案），然后请展示如何将它（直接或间接）放入 if 逻辑, 在我的 cshtml 页面上，以便我可以实际检查它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T22:54:22.123

正如您将发现的，正则表达式 (Regex) 是一种用于将文本与模式匹配甚至提取或替换源文本中的匹配项的工具。

为此，Regex 引擎（存在于命名空间 System.Text.RegularExpressions 内的 .Net 框架中）使用一些已建立的模式来表示某些类型的字符。

要使用正则表达式，您需要将测试文本的模式和文本本身传递给它。

例如，以下代码段测试文本中是否有小写字母：

```
using System.Text.RegularExpressions;
... 
var Pattern = "[a-z]";
if (Regex.IsMatch(SomeText, Pattern)) {
//... there is at least one lower case char in the text
} 
```

上面使用的模式我们对从小写“a”到小写“z”的一系列字符感兴趣。

需要至少一个小写字母、一个数字和一个大写字母的模式可能类似于

```
@"[\d]+[a-z]+[A-Z]|[\d]+[A-Z]+[a-z]|[a-z]+[\d]+[A-Z]|[a-z]+[A-Z]+[\d]|[A-Z]+[\d]+[a-z]|[A-Z]+[a-z]+[\d]" 
```

如您所见，Regex 模式可以像第一个示例中一样简单，但根据您要检查或提取的信息类型，其复杂性可能会迅速升级。

在上面的 Regex 中，方括号之间的项目称为字符类。元素后面的加号是量词，表示该项可能出现一次或多次。由竖线分隔的项目表示备选方案。"\d" 模式表示从 "0" 到 "9" 的任何数字。

您实际上并不需要正则表达式来检查应用程序中的密码强度，但是使用 then 而不是您当前正在进行的显式测试（在我看来）会大大提高程序的可读性：

```
using System.Text.RegularExpressions;
... 
if (!Regex.IsMatch(password, "[A-Z]")) {
  errorMessage = "Your password must contain at least one uppercase character."; 
} else if (!Regex.IsMatch(password, "[a-z]") {
  errorMessage = "Your password must contain at least one lowercase character."; 
} else if (! Regex.IsMatch(password, @"[\d]")){
  errorMessage = "Your password must contain at least one numerical character."; 
}
... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-15T19:43:24.013

如果您尝试在信息发送到服务器之前在页面上进行此测试，您可以使用 javascript 和 regex 进行检查。我认为这种方式是最好的，因为您消除了对服务器的额外访问。它可以通过 javascript 验证，将数据发布到您的站点，并且您可以在服务器上进行更多验证（以防用户关闭 javascript）。Razor 语法有助于页面*呈现*，但在用户在页面上执行操作时无济于事。

图案：`((?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,15})`

这需要至少 1 个数字、1 个小写字母和 1 个大写字母。它还要求密码长度在 8 到 15 个字符之间（含）。您可以轻松更改模式中的长度要求。例如，如果您希望它至少有 8 个字符，但没有最大值：

`((?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,})`

要在 javascript 中使用它（我确实使用 jQuery 在我的测试中连接我的点击事件并从输入中获取密码）：

```
var password = $('#password').val();
var pattern = /((?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,15})/;
var pass = pattern.test(password); 
```

一个小提琴显示它在行动：http: [//jsfiddle.net/gromer/chF4D/1/](http://jsfiddle.net/gromer/chF4D/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T20:24:05.373

好吧，我知道这不是正确执行此操作的方法，（正确的方法是使用正则表达式，这是我试图弄清楚的）但是如果您像我一样，并且厌倦了询问/搜索相同的问题一遍又一遍，没有得到任何完全有用的反馈，这对我有用。

```
 int Ucount = 0;
    int Lcount = 0;
    int Ncount = 0;
    foreach(char c in password)
    {
        if(c!='A' && c!='B' && c!='C' && c!='D' && c!='E' && c!='F' && c!='G' && c!='H' && c!='I' && c!='J' && c!='K' && c!='L' && c!='M' && c!='N' && c!='O' && c!='P' && c!='Q' && c!='R' && c!='S' && c!='T' && c!='U' && c!='V' && c!='W' && c!='X' && c!='Y' && c!='Z')
        {
            Ucount++;
            if(Ucount >= password.Length)
            {
                errorMessage = "Your password must contain at least one uppercase character.";
            }
        }

        if(c!='a' && c!='b' && c!='c' && c!='d' && c!='e' && c!='f' && c!='g' && c!='h' && c!='i' && c!='j' && c!='k' && c!='l' && c!='m' && c!='n' && c!='o' && c!='p' && c!='q' && c!='r' && c!='s' && c!='t' && c!='u' && c!='v' && c!='w' && c!='x' && c!='y' && c!='z')
        {
            Lcount++;
            if(Lcount >= password.Length)
            {
                errorMessage = "Your password must contain at least one lowercase character.";
            }
        }

        if(c!='0' && c!='1' && c!='2' && c!='3' && c!='4' && c!='5' && c!='6' && c!='7' && c!='8' && c!='9')
        {
            Ncount++;
            if(Ncount >= password.Length)
            {
                errorMessage = "Your password must contain at least one numerical character.";
            }
        }
    } 
```

再次请注意，正确的方法是使用正则表达式，但这段代码对我来说很好，我必须结束理解正则表达式的野鹅追逐。

更新：或者，如果您想正确地做，请阅读上面 Branco Medeiros 的帖子，他在我发布此帖子后发布，他的方式是正确的方式（前提是您不想在 JavaScript 之前使用它发送到服务器。如果您的应用程序和我的一样，并且资源密集程度不足以需要 JavaScript 来执行此操作，请使用上面 Branco Medeiros 的示例）。

# jquery - 将点击/点击坐标发送到服务器

> ID：12902694
> 
> 赞同：0
> 
> 时间：2012-10-15T19:31:17.023
> 
> 标签：jquery, ajax, tap

我有一个大约 960x640 的 Div。我必须将点击/点击坐标发送到服务器。显然我需要它而不重新加载页面。我认为代码需要优化。

```
<div id="area2" style="width:960px; height:640; background-color:#ffaaaa"></div> 
```

JAVASCRIPT

```
// click event 
    $('#area2').click(function(e) { 
        // Take the coordinates
        var posX = e.offsetX; 
        var posY = e.offsetY; 
        // Ajax calls
        $.ajax({ 
            url:'file.php', 
            data:{posX:posX, posY:posY}, 
            type:'POST', 
            success: function(result) { 
                // Data sent
                alert("Data sent"); 
            }, 
            error: function(jqXHR, textStatus, errorThrown) { 
                alert("ohi! "+textStatus+" - " +errorThrown); 
            } 
        }); 
    }); 
```

PHP

```
$db_conn=mysql_connect($db_host,$db_user,$db_pass) or die ("Error connection!");
    $beta=mysql_select_db($db_name) or die ("Error database selection!");

$posX=intval($_POST["posX"]);
$posY=intval($_POST["posX"]);
    $UpdatePlayer = mysql_query("UPDATE players SET x=$posX, y=$posY  WHERE fb_user=$user") or die ("Error update players"); 
```

# c# - ASP.NET 页面在回发时为空白，需要刷新多个页面

> ID：12902700
> 
> 赞同：0
> 
> 时间：2012-10-15T19:31:46.470
> 
> 标签：c#, asp.net, postback

出于某种奇怪的原因，当我发出回发（通过单击按钮）时，页面执行回发，但结果页面完全空白。如果我尝试查看页面源代码，我会收到一条确认表单重新提交消息（使用 chrome）。

但是，如果我按 f5 几次，最终会加载正确的页面。

我注意到这通常发生在按下按钮导致某种数据库访问时。为什么会发生这种情况，我该如何避免？

编辑：我注意到，当我添加以下代码时，这种情况开始更频繁地发生，但它甚至在之前一直不时发生：

```
protected void BindPartList()
{
    if (UnitsDropDown.Text == "Imperial")
    {
        if (PartListGridView.Columns.Count > 4)
            PartListGridView.Columns.Remove(PartListGridView.Columns[4]);
        BoundField colIndex4 = new BoundField();
        colIndex4.DataField = "IMPUNITS";
        colIndex4.HeaderText = "Unit";
        colIndex4.SortExpression = "IMPUNITS";
        PartListGridView.Columns.Add(colIndex4);
        PartListGridView.DataSourceID = "ImpPartInfoObjectSource";
    }
    else
    {
        if (PartListGridView.Columns.Count > 4)
            PartListGridView.Columns.Remove(PartListGridView.Columns[4]);
        BoundField colIndex4 = new BoundField();
        colIndex4.DataField = "DWGUNIT";
        colIndex4.HeaderText = "Unit";
        colIndex4.SortExpression = "DWGUNIT";
        PartListGridView.Columns.Add(colIndex4);
        PartListGridView.DataSourceID = "MetricPartInfoObjectSource";
    }
    PartListGridView.DataBind();
} 
```

前端看起来像：

```
<asp:GridView ID="PartListGridView" runat="server" ShowHeaderWhenEmpty="True" AutoGenerateColumns="False"
    Width="100%" Font-Size="11pt" DataKeyNames="PARTNUM" AllowSorting="true">
    <Columns>
        <asp:BoundField DataField="PARTNUM" HeaderText="PARTNUM" SortExpression="PARTNUM"
            ReadOnly="True" />
        <asp:BoundField DataField="PARTDESC" HeaderText="PARTDESC" SortExpression="PARTDESC" />
        <asp:BoundField DataField="CATEGORY" HeaderText="CATEGORY" SortExpression="CATEGORY" />
        <asp:BoundField DataField="COLOUR" HeaderText="COLOUR" SortExpression="COLOUR" />
    </Columns>
</asp:GridView> 
```

当然除了这两个数据源

谢谢，

# php - 将变量添加到变量

> ID：12902702
> 
> 赞同：0
> 
> 时间：2012-10-15T19:31:56.467
> 
> 标签：php

抱歉标题具有误导性，很难解释这么短的问题......

所以我有一些名为 的变量`$exp_lvl1`，`$exp_lvl2`依此类推......

为了让它更简单，我得到了`$exp_lvl`（它只是给出了一个错误，因为它不存在，在这种情况下这是正常的），我得到了一个变量中需要的数字`$next_exp`。

我如何把这些放在一起？我试过`$exp_lvl.$next_exp`了，但没有用。我应该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T19:41:11.960

我猜你想要这样的东西：

```
$x = ${$exp_lvl.$next_exp}; 
```

**测试：**

```
<?php

$exp_lvl = 'var_';
$next_exp = '1';
$var_1 = 'okay';

$x = ${$exp_lvl.$next_exp};
echo $x;

?> 
```

见[@PHPFiddle](http://www.phpfiddle.org/main/code/b97-p65)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T19:40:17.787

试试这个：

```
$exp_lvl."".$next_exp 
```

# wpf - 如何实现 xamcheckeditor 禁用样式

> ID：12902703
> 
> 赞同：1
> 
> 时间：2012-10-15T19:32:10.363
> 
> 标签：wpf, infragistics, xamdatagrid

当您将 bool 值绑定到 xamdatagrid 时，该列将自动使用 xamcheckeditor 来显示数据。我想使用外部按钮来控制复选框列的 allowedit，当我更改 allowedit 属性时，列中的复选框将应用禁用/启用样式（变为灰色） 在我的资源字典中，我为 xamcheckeditor 编写样式：

```
<ControlTemplate.Triggers>
    <Trigger Property="IsReadOnly" Value="True">
        <Setter TargetName="PART_FocusSite" Property ="IsEnabled" Value="False" />
     </Trigger>
</ControlTemplate.Triggers> 
```

因此，当该字段不可编辑时，复选框将显示为禁用。

我还有一个按钮来控制列的 allowedit，当按钮被点击时，它将调用：

```
grid.FieldsLayouts[0].Fields["Enabled"].Settings.AllowEdit = true/false 
```

但是启用/禁用操作不会自动应用，我必须单击过滤器以刷新网格才能应用它们...

请告知我应该如何实施，一旦单击按钮设置提交的 allowedit，复选框将自动启用。

谢谢！

恩州

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T21:24:30.947

如果您要做的只是在 XamCheckEditor 所属的字段将 AllowEdit 设置为 false/true 时禁用/启用它，那么您需要做的就是创建一个直接附加到 AllowEdit 的绑定的样式。

```
<local:NullableBooleanConverter x:Key="converter"/>

<Style TargetType="{x:Type igEditors:XamCheckEditor}" >
    <Setter Property="IsEnabled" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type igDP:CellValuePresenter}},
        Path=Field.Settings.AllowEdit, Converter={StaticResource converter}}"/>
</Style> 
```

由于 XamCheckEditor 位于字段的每个单元格内，这意味着它位于 CellValuePresenter 内。您可以使用 RelativeSource 绑定来获取它，然后访问它的属性。它的属性之一是它所属的字段。所以知道这一点，您可以直接绑定到 AllowEdit。

现在 AllowEdit 是一个可以为 null 的布尔值（布尔值？），默认为 null，因此您需要使用转换器来确保数据正确传递到 XamCheckEditor。

```
public class NullableBooleanConverter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        // If value is null then we really mean true.
        if (value == null)
            return true;

        // value is not null so it's either true or false.
        return value;
    }

    public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        throw new NotImplementedException();
    }
} 
```

您现在需要做的就是像原来一样设置 AllowEdit 属性，它会自动更新 XamCheckEditor。

# javascript - QTip 与 JQGrid 使用超链接

> ID：12902705
> 
> 赞同：0
> 
> 时间：2012-10-15T19:32:15.720
> 
> 标签：javascript, jquery, ajax, jqgrid, qtip

我有一个 jqgrid，它有一个网格内 ID 字段的超链接。我喜欢做的是当有人将鼠标悬停在 Jqgrid 中的 id 超链接上时，我喜欢显示一个带有所选 ID 的 qTip - [http://craigsworks.com/projects/qtip/](http://craigsworks.com/projects/qtip/)。我实际上喜欢更进一步——当有人将鼠标悬停在 ID 超链接上时，我喜欢使用 JSON 并返回一个字符串，然后在 QTip 中显示该字符串

我尝试了以下方法：

```
 $(this).qtip({
              content: {
              text: $(this).attr('title'),
         }
     }); 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-10-15T19:34:41.750

请参阅： http: [//craigsworks.com/projects/qtip2/demos/#ajax](http://craigsworks.com/projects/qtip2/demos/#ajax)了解有关使用 qTip 的 Ajax/JSON 数据的详细信息。

# matlab - 如何在matlab的imagesc图中添加图例

> ID：12902709
> 
> 赞同：8
> 
> 时间：2012-10-15T19:32:31.287
> 
> 标签：matlab, legend

我有以下代码，创建我打印到文件的数字：

```
f=figure;
set(gcf,'Visible','off');
imagesc (exp_genes_sorted_cut);
h=colorbar;
set(gcf,'Colormap',mycmap);

set(gca, 'xtick', 1:num_tissues_displayed);
set(gca, 'xticklabel', tissues, 'fontsize', 14);
ylabel('Genes', 'Fontsize', 18);
xlabel('Tissues', 'Fontsize', 18); 
```

我想在颜色栏的右侧添加图例，我尝试使用图例功能这样做，但它没有显示......使用文本功能将它放在 printanle 区域之外。任何人都可以帮忙吗？谢谢，，，

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-16T03:00:05.147

一种可能的解决方法（如果我理解正确的话）：

```
 N=4;                                                    %  # of data types, hence legend entries
 Data = randi(N,30,30);                                  % generate fake data
 imagesc(Data)                                           % image it
 cmap = jet(N);                                          % assigen colormap
 colormap(cmap)
 hold on
 L = line(ones(N),ones(N), 'LineWidth',2);               % generate line 
 set(L,{'color'},mat2cell(cmap,ones(1,N),3));            % set the colors according to cmap
 legend('A','B','C','D')                                 % add as many legend entries as data 
```

![在此处输入图像描述](../Images/c899d850dfcec6e2ecb90e388ce2659e.png)

# heroku - heroku login error

> ID：12902715
> 
> 赞同：2
> 
> 时间：2012-10-15T19:33:23.497
> 
> 标签：heroku

I am using Ubuntu. When I try to login to Heroku from command shell i get the follwing error:

```
/usr/local/lib/ruby/1.9.1/net/http.rb:644:in `initialize': getaddrinfo: Name or service not known (SocketError)

from /usr/local/lib/ruby/1.9.1/net/http.rb:644:in `open'
from /usr/local/lib/ruby/1.9.1/net/http.rb:644:in `block in connect'
from /usr/local/lib/ruby/1.9.1/timeout.rb:44:in `timeout'
from /usr/local/lib/ruby/1.9.1/timeout.rb:89:in `timeout'
from /usr/local/lib/ruby/1.9.1/net/http.rb:644:in `connect'
from /usr/local/lib/ruby/1.9.1/net/http.rb:637:in `do_start'
from /usr/local/lib/ruby/1.9.1/net/http.rb:626:in `start'
from /usr/local/lib/ruby/gems/1.9.1/gems/rest-client-1.6.7/lib/restclient/request.rb:172:in `transmit' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T20:02:03.310

“名称或服务未知”通常意味着您尝试连接的主机未解析到 IP 地址（即 DNS 查找失败）。

您可以尝试一些故障排除步骤：

1.  **确保您已连接到互联网**。尝试使用`ping -c10 8.8.8.8`（因为您正在 ping IP 地址而不是主机名，它应该在没有 DNS 的情况下工作）。您会在输出的末尾获得一些统计数据，如果它说的是类似的内容，`0% packet loss`那么您就有了互联网连接。
2.  **查看 DNS 是否正常工作**。尝试使用`dig heroku.com`. 您应该得到一些输出，其中包括`ANSWER SECTION`列出多个 IP 地址。如果您收到超时，则问题出在您的 DNS 服务器上。
3.  **尝试**使用另一个 DNS 服务器`dig @8.8.8.8 heroku.com`。如果可行，您应该将您的 DNS 服务器（至少暂时）更改为 Google`8.8.8.8`和`8.8.4.4`.

也可以看看：

*   [手册`dig`页](http://linux.die.net/man/1/dig)
*   [手册`ping`页](http://linux.die.net/man/8/ping)
*   [Google 关于更改 DNS 服务器的说明](https://developers.google.com/speed/public-dns/docs/using)

# php - Windows Server 上的 Word Doc 文件到 PDF

> ID：12902720
> 
> 赞同：2
> 
> 时间：2012-10-15T19:33:38.833
> 
> 标签：php, pdf, windows-server-2008, docx

我正在尝试在 Windows 服务器上使用 PHP 将 .docx 文件转换为 pdf。我尝试了其他帖子中的几种解决方案，包括 phpdocx（它的转换效果很差，不保留任何格式）和 php 的 Com 对象。我只有 Office 2003，所以没有使用 Com 的 pdf 转换器。

我想过使用 OpenOffice/LibreOffice，但没有找到任何关于在 Windows 服务器上安装和使用 Com 的信息（我知道它可以安装，但我不知道如何为它设置 Com）。

由于表单上的数据（它们必须保留在我们的服务器上），使用网络服务不是一种选择。这意味着不能使用 Zend Framework。

任何建议都会有所帮助，或者有关将 Com 与 Open Office 结合使用的信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T16:00:28.843

我终于能够得到这个工作。我们的问题是 Word 2003 中没有 PDF 转换器。我们最终使用了 Office 2010 的试用版（假设一切正常，我们将购买完整版）。Word 2007 也可以。下面是我用来让它工作的代码：

```
 //Word Doc to PDF using Com
            ini_set("com.allow_dcom","true");

            try{
                $word = new com('word.application') or die('MS Word could not be loaded');
            }
            catch (com_exception $e)
            {
                    $nl = "<br />";
                    echo $e->getMessage() . $nl;
                    echo $e->getCode() . $nl;
                    echo $e->getTraceAsString();
                    echo $e->getFile() . " LINE: " . $e->getLine();
                    $word->Quit();
                    $word = null;
                    die;

            }

            $word->Visible = 0;
            $word->DisplayAlerts = 0;

            try{
            $doc = $word->Documents->Open(DOC_LOCATION. 'test_image.docx');
            }
            catch (com_exception $e)
            {
                $nl = "<br />";
                echo $e->getMessage() . $nl;
                echo $e->getCode() . $nl;
                echo $e->getFile() . " LINE: " . $e->getLine();
                $word->Quit();
                $word = null;
                die;
            }
            echo "doc opened";
            try{
                $doc->ExportAsFixedFormat(DOC_LOCATION . "test_image.pdf", 17, false, 0, 0, 0, 0, 7, true, true, 2, true, true, false);

            }
            catch (com_exception $e)
            {
                $nl = "<br />";
                echo $e->getMessage() . $nl;
                echo $e->getCode() . $nl;
                echo $e->getTraceAsString();
                echo $e->getFile() . " LINE: " . $e->getLine();
                $word->Quit();
                $word = null;
                die;
            }

            echo "created pdf";
            $word->Quit();
            $word = null; 
```

# java - JPA find() 不加载实体@Id

> ID：12902728
> 
> 赞同：2
> 
> 时间：2012-10-15T19:34:11.973
> 
> 标签：java, jpa, openjpa

我开始将 JPA 与 OpenJPA API 一起使用，但我遇到了 find() 问题。以下是表格：

```
CREATE TABLE compania (
  ID int(11) NOT NULL,
  NOMBRE varchar(45) DEFAULT NULL,
  PRIMARY KEY (ID)
) 

CREATE TABLE modelo (
  ID int(11) NOT NULL,
  ID_COMPANIA int(11) DEFAULT NULL,
  NOMBRE_MODELO varchar(45) DEFAULT NULL,
  PRIMARY KEY (ID),
  KEY MODELO_COMPANIA_FK_idx (ID_COMPANIA),
  CONSTRAINT MODELO_COMPANIA_FK FOREIGN KEY (ID_COMPANIA) REFERENCES compania (ID)
) 
```

这是我的实体：

```
@Entity
public class Compania extends EntityJPA{

    private static final long serialVersionUID = 1L; 

    @Id
    private int id;

    @Column
    private String nombre;

    @OneToMany(mappedBy="compania",cascade={CascadeType.ALL})
    @JoinColumn(name="ID_COMPANIA", nullable=false)
    private List<Modelo> listaModelos;

    public Compania() {
    }

    public int getId() {
        return id;
    }

    public void setId(int idCompania) {
        this.id = idCompania;
    }

    public String getNombre() {
        return nombre;
    }

    public void setNombre(String nombreCompania) {
        this.nombre = nombreCompania;
    }

    public List<Modelo> getListaModelos() {
        return listaModelos;
    }

    public void setListaModelos(List<Modelo> listaModelos) {
        this.listaModelos = listaModelos;
    }
}

@Entity
public class Modelo extends EntityJPA{

    private static final long serialVersionUID = 1L;

    @Id
    @GeneratedValue(strategy=GenerationType.IDENTITY)
    private int id;

    @Column(name="NOMBRE_MODELO")
    private String nombreModelo;

    @ManyToOne
    @JoinColumn(name="ID_COMPANIA", referencedColumnName="ID")
    private Compania compania;

    public Modelo() {
    }

    public Compania getCompania() {
        return compania;
    }

    public void setCompania(Compania compania) {
        this.compania = compania;
    }

    public int getId() {
        return id;
    }

    public void setId(int idModelo) {
        this.id = idModelo;
    }

    public String getNombre() {
        return nombreModelo;
    }

    public void setNombre(String nombreModelo) {
        this.nombreModelo = nombreModelo;
    }
} 
```

目前我做

```
Compania cia = getEntityManager().find(Compania.class, idCompania); 
```

cia 对象没有@Id 属性的值，它的值是 nombre 而不是 id。我是说：

```
cia.getId() = 0 
```

它必须是 1 或 2 等。不是 0。

非常感谢您的帮助。

我没有要保留的代码，因为它已经保留了。查找的代码是

```
public static Compania findCompania(int idCompania){
        try {
            Compania cia = getEntityManager().find(Compania.class, idCompania);
            return cia;
        } finally {
            closeEntityManager();
        }
    } 
```

如果我激活日志，这是它显示的选择：

```
482  testMySql  TRACE  [http-bio-8080-exec-5] openjpa.jdbc.SQL - <t 1228180882, conn 1699837157> executing prepstmnt 2127861376 SELECT t0.nombre FROM Compania t0 WHERE t0.id = ? [params=(int) 1]
497  testMySql  TRACE  [http-bio-8080-exec-5] openjpa.jdbc.SQL - <t 1228180882, conn 1699837157> [15 ms] spent 
```

如您所见，选择中没有 t0.id。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T19:51:30.220

如果您没有专门设置`@Id`属性的值，则必须使用它来声明它，`@GeneratedValue`以便它自动递增。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T20:03:43.363

[未使用 OpenJPA 从数据库中检索到主键 (ID) (?)](https://stackoverflow.com/questions/11670910/primary-key-id-not-retrieved-from-database-using-openjpa/11673069#11673069)

重复....帖子的目的是您需要使用不同的增强方法。

# java - Java dictionary >

> ID：12902733
> 
> 赞同：5
> 
> 时间：2012-10-15T19:34:32.573
> 
> 标签：java, dictionary

I was making a game with XNA game studio and now I want to rewrite it in Java. It's something like a 2D Minecraft clone. For collision detection, I have to loop through all blocks in the game to check on whether the player is colliding with a block. With a huge number of blocks, it is impossible to do so, so I made a grid system. I divided the world into grids which contain blocks, and put them into a dictionary.

```
Dictionary<string, List<Block>> gameBlocks; 
```

Now I have only to loop through the blocks in the current grid.

This is the method to register a block:

```
public void RegisterBlock(Block block)
{
    idX = (int)(block.blockPosition.X / width);
    idY = (int)(block.blockPosition.Y / height);
    string id = idX.ToString() + "_" + idY.ToString();
    if (gameBlocks.ContainsKey(id))
    {
        gameBlocks[id].Add(block);
    }
    else
    {
        gameBlocks.Add(id, new List<Block>());
        gameBlocks[id].Add(block);
    }
} 
```

Now I am trying to rewrite it in Java but I don't know how to put something into a Dictionary.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-15T19:46:58.547

使用 Java 的`Map`接口和`HashMap`类。您的方法在 Java 中看起来像这样：

```
private Map<String, List<Block>> gameBlocks = new HashMap<String, List<Block>>(); // Java 6
// OR:
private Map<String, List<Block>> gameBlocks = new HashMap<>(); // Java 7

public void registerBlock(Block block) {
    idX = (int)(block.blockPosition.X / width);
    idY = (int)(block.blockPosition.Y / height);
    String id = idX + "_" + idY;
    if (gameBlocks.containsKey(id)) {
        gameBlocks.get(id).add(block);
    } else {
        gameBlocks.put(id, new ArrayList<Block>());
        gameBlocks.get(id).add(block);
    }
} 
```

请注意我对 Java 推荐的格式/命名样式所做的一些更正。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T19:35:41.767

Java has something called `HashMap` which may be useful for you. Here is documentation for [HashMap](http://docs.oracle.com/javase/6/docs/api/java/util/HashMap.html).

Example:

```
HashMap<string, List<Block>> 
```

# windows - Windows store app pinch zoom handling

> ID：12902734
> 
> 赞同：1
> 
> 时间：2012-10-15T19:34:38.163
> 
> 标签：windows

I have followed the instruction on msdn about [GestureRecognizer](http://msdn.microsoft.com/library/windows/apps/BR241937)! for handling pinch guesture. However, I can't get the `ManipulationUpdated` called. Is there anything I'm missing?

In my `C#` class,

```
 `private GestureRecognizer gesture = new GestureRecognizer();` 
```

In my constructor:

```
 gesture.GestureSettings = GestureSettings.ManipulationScale;
    gesture.ManipulationUpdated += gesture_ManipulationUpdated;
    gesture.ManipulationStarted += gesture_ManipulationStarted;
    gesture.ManipulationCompleted += gesture_ManipulationCompleted; 
```

In my pointer events:

```
 private void PointerPressed_1(object sender, PointerRoutedEventArgs e)
{
   var point = e.GetIntermediatePoints(null);
   gesture.ProcessDownEvent(point[0]);
}

private void PointerMoved_1(object sender, PointerRoutedEventArgs e)
{
   gesture.ProcessMoveEvents(e.GetIntermediatePoints(null));
}

private void PointerReleased_1(object sender, PointerRoutedEventArgs e)
{
    var point = e.GetIntermediatePoints(null);
    gesture.ProcessUpEvent(point[0]);
    gesture.CompleteGesture();
}

void gesture_ManipulationCompleted(GestureRecognizer sender, ManipulationCompletedEventArgs args)
    {
        System.Diagnostics.Debug.WriteLine("Manipulation Completed {0}", args.Cumulative.Scale);
    }

void gesture_ManipulationStarted(GestureRecognizer sender, ManipulationStartedEventArgs args)
    {
        System.Diagnostics.Debug.WriteLine("Manipulation Started {0}", args.Cumulative.Scale);
    }

void gesture_ManipulationUpdated(GestureRecognizer sender, ManipulationUpdatedEventArgs args)
    {
        System.Diagnostics.Debug.WriteLine("Manipulation Updated {0}", args.Cumulative.Scale);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T10:51:58.150

尝试打开手势设置属性中的所有标志。如您的链接中所述：

```
gesture.gestureSettings =
        Windows.UI.Input.GestureSettings.manipulationRotate |
        Windows.UI.Input.GestureSettings.manipulationTranslateX |
        Windows.UI.Input.GestureSettings.manipulationTranslateY |
        Windows.UI.Input.GestureSettings.manipulationScale |
        Windows.UI.Input.GestureSettings.manipulationRotateInertia |
        Windows.UI.Input.GestureSettings.manipulationScaleInertia |
        Windows.UI.Input.GestureSettings.manipulationTranslateInertia |
        Windows.UI.Input.GestureSettings.tap; 
```

# c# - Dapper 版本 1.12.0.0 XML 参数不再起作用

> ID：12902735
> 
> 赞同：3
> 
> 时间：2012-10-15T19:34:38.960
> 
> 标签：c#, dapper

当通过 dapper 将 xml 字符串传递到 SQL Server 2008 时，dapper 似乎正在为 xml 字符串中的每个字符创建一个参数。

例如，如果字符串是`<outer></outer>`它似乎正在为每个字符（'<'、'o'、'u'、't'等）创建一个参数。

在旧版本中，代码会将一个参数（即指定的 xml 参数）传递给存储过程。

设置代码如下所示 -

```
var xml = @"
<OuterElement>
  <InnerElement>1</InnerElement>
  <InnerElement>2</InnerElement>
  <InnerElement>3</InnerElement>
  <InnerElement>4</InnerElement>
</OuterElement>";

var parameters = new Dapper.DynamicParameters();
parameters.Add("@XmlParameter", xml, DbType.Xml); 
SqlMapper.Query(
  connection, 
  "dbo.TestXmlInput", 
  parameters, 
  commandType: CommandType.StoredProcedure, 
  commandTimeout: 60
); 
```

我的问题如下：其他人可以复制吗？如果是这样，此更改是故意的还是错误的？是否有实现 xml 参数传递的解决方法？

生成的 SQL 如下所示：

```
exec dbo.TestXmlInput (@XmlParameter1, @XmlParameter2, @XmlParameter3, ...) 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-16T05:47:01.563

从历史上看，`DbType.Xml`曾被内部劫持以代表不同的东西。这是有问题的。基本上，当我使参数扩展 ( `where Id in @ids`) 起作用时`DynamicParameters`，它破坏了 xml。

我现在创建了一种不同的表示方式，并将更新的源推送到 google-code 和 github。如果您使用更新的代码，它应该可以正常工作。我还没有部署 NuGet - 如果你需要这个，请告诉我。

# wpf - Write special masked TextBox for WPF

> ID：12902743
> 
> 赞同：2
> 
> 时间：2012-10-15T19:35:16.133
> 
> 标签：wpf, custom-controls

I want to develop a custom user control in WPF which has some sort of mask. this functionality is very like the one provided in many online applications where u enter your credit card number and next time whenever u sign in to your account u see only last for digits of the card number (something like *******4587) but while I display data in this way I want to keep real value unchanged so inside binding I will access full data.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T19:49:55.787

你可以尝试这样的事情：

```
string originalNumber = textBoxOriginalNumber.Text;
int numberOfDigits = textBoxOriginalNumber.Text.Length;
string hidden = new String('*', numberOfDigits-4);
textBoxModifiedNumber.Text = hidden + originalNumber.Remove(0, numberOfDigits-4); 
```

这不是一个优雅的解决方案，但如果其他人为您提供更好的解决方案，它将帮助您。基本上，它采用原始信用卡号，计算它有多少位数，删除“n-4”的第一个数字，然后显示*符号“n-4”次加上最后四个数字。无论原始号码有多少位数，这都会起作用。

此外，我不确定掩码（或下面其他用户建议的正则表达式）是否会起作用，因为（如果我理解得很好）它将替换整个数字，而不是显示最后 4 位数字。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T09:18:26.717

您可以使用[Regex.Replace](http://msdn.microsoft.com/en-us/library/xwewhkd1.aspx)和 \d 来表示一个数字

IE

```
var digits = new Regex(@"\d");
modifiedNumber = digits.Replace(originalNumber, "*"); 
```

或者，如果您想更新除最后一组之外的整组数字

```
@"\d{4}-" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-16T14:40:01.850

好的，这是我解决该问题的方法。在使用卡号之后，我也想使用 ID 和 SN 号，所以我所做的只是编写了一个小方法，它接受字符串并在这里返回掩码值，以防有人需要这个功能。

```
 public static string GetMaskedNumber(string unsecuredNumber, char maskChar)
    {
        return unsecuredNumber.Substring(unsecuredNumber.Length - 4)
                     .PadLeft(unsecuredNumber.Length - 6, ' ')
                     .PadLeft(unsecuredNumber.Length, maskChar);
    } 
```

# php - 如何在不删除非空换行符的情况下缩小 php html 输出？

> ID：12902745
> 
> 赞同：0
> 
> 时间：2012-10-15T19:35:38.227
> 
> 标签：php, html, minify

如何像谷歌页面速度一样缩小我的 php 页面 html 输出？

例子：

```
<!DOCTYPE html>
<html>

<head>
<title>Untitled Document</title>

<meta name="description" content="Phasellus rhoncus euismod libero a lacinia. Lorem ipsum dolor sit amet, consectetur adipiscing elit." />

</head>

<body>
<div id="content">
<div id="post-1">
<h1>Phasellus rhoncus euismod libero a lacinia.</h1>
<p>...</p>
</div>

<div id="post-2">
<h1>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</h1>
<p>...</p>
</div>

</div>

</body>
</html> 
```

使用 php ob_start，这个 html 输出怎么会变成这样？

```
<!DOCTYPE html>
<html>
<head>
<title>Untitled Document</title> 
<meta name="description" content="Phasellus rhoncus euismod libero a lacinia. Lorem ipsum dolor sit amet, consectetur adipiscing elit." />
</head>
<body>
<div id="content">
<div id="post-1">
<h1>Phasellus rhoncus euismod libero a lacinia.</h1>
<p>...</p>
</div>
<div id="post-2">
<h1>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</h1>
<p>...</p>
</div>
</div>
</body>
</html> 
```

编辑：

我已经尝试过这段代码（基于 James Pegg 的回答）

```
function sanitize_output($buffer){
$search = array("\n", "\t");
return preg_replace($search, '', $buffer);}

ob_start("sanitize_output"); 
```

但它不起作用。该页面现在是空的。

最终工作代码（基于 W. Kristianto 的回答）：

```
function sanitize_output($buffer){
$buffer = preg_replace("/(^[\r\n]*|[\r\n]+)[\s\t]*[\r\n]+/", "\n", $buffer);
return $buffer;} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T20:22:31.773

```
$data = '
<!DOCTYPE html>
<html>

<head>
<title>Untitled Document</title>

<meta name="description" content="Phasellus rhoncus euismod libero a lacinia. Lorem ipsum dolor sit amet, consectetur adipiscing elit." />

</head>

<body>
<div id="content">
<div id="post-1">
<h1>Phasellus rhoncus euismod libero a lacinia.</h1>
<p>...</p>
</div>

<div id="post-2">
<h1>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</h1>
<p>...</p>
</div>

</div>

</body>
</html>';

echo "<pre>";
echo htmlentities(preg_replace("/(^[\r\n]*|[\r\n]+)[\s\t]*[\r\n]+/", "\n", $data));
echo "</pre>"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T19:38:17.300

只需删除仅包含`\r\n`, or `\r`, or的每一行`\n`。

这很有用：[如何从 PHP 中的文本中删除空行？](https://stackoverflow.com/questions/709669/how-do-i-remove-blank-lines-from-text-in-php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T19:44:22.687

您可以像这样取出所有新行和标签：

```
<?php
// Start Output Bugger
ob_start();

// Start HTML Output
?>
<!DOCTYPE html>
<html>

<head>
<title>Untitled Document</title>

<meta name="description" content="Phasellus rhoncus euismod libero a lacinia. Lorem ipsum dolor sit amet, consectetur adipiscing elit." />

</head>

<body>
<div id="content">
<div id="post-1">
<h1>Phasellus rhoncus euismod libero a lacinia.</h1>
<p>...</p>
</div>

<div id="post-2">
<h1>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</h1>
<p>...</p>
</div>

</div>

</body>
</html>

<?php

// Save Output bugger as a variable
$html = ob_get_clean();

//Array of characters to replace
$strings = Array("\n", "\t");

//Strip out new lines and tabs
$html = str_replace($strings, '', $html);

//Echo minified content
echo $html;
?> 
```

希望有帮助！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-15T19:50:32.247

尝试使用一些js[库](http://code.google.com/p/minify/)，有时它很有用

# c# - 如何列出 RadComboBox 为空的项目

> ID：12902747
> 
> 赞同：0
> 
> 时间：2012-10-15T19:35:51.630
> 
> 标签：c#, telerik, radcombobox

我有一个 RadComboBox。我用一个函数填充它，该函数返回例如 {Stack, Over, Flow, StackOverFlow} 当我单击 RadCombobox 列出的项目时。

我想把空元素放在首位。

我试着在下面做：

```
var stack= GetItems(SiteId);
RadComboBox1.Items.Add(new RadComboBoxItem("", "0"));
RadComboBox1.DataSource = stack;  

RadComboBox1.DataTextField = "Name";
RadComboBox1.DataValueField = "Id";
RadComboBox1.DataBind();

RadComboBox1.AllowCustomText = false; 
```

没有变化。仅列出 {Stack, Over, Flow, StackOverFlow}。

当我写下面的代码

```
var stack= GetItems(SiteId);

RadComboBox1.DataSource = stack;  

RadComboBox1.DataTextField = "Name";
RadComboBox1.DataValueField = "Id";
RadComboBox1.DataBind();
RadComboBox1.Items.Add(new RadComboBoxItem("xyz", "0"));
RadComboBox1.AllowCustomText = false; 
```

仅列出 {Stack, Over, Flow, StackOverFlow, xyz}。

但我没有得到我想要的结果。

设计方面如下。

```
<telerik:RadComboBox ID="RadComboBox1" runat="server" Width="120px" MarkFirstMatch="true" Filter="Contains"></telerik:RadComboBox> 
```

我能怎么做？

我想列出 { `" "` , `"Stack"`, `"Over"`, `"Flow"`, `"StackOverFlow"`}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T20:09:19.987

使用您的第一选择，`RadComboBox1.AppendDataBoundItems = true`在调用之前添加`DataBind()`。这意味着在从数据绑定中添加项目之前，它不会清除现有项目。如有必要，您将需要事先手动清除项目：

```
RadComboBox1.Items.Clear();
RadComboBox1.ClearSelection(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T20:13:07.050

当您设置 RadComboBox DataSource 属性时，它将清除 RadComboBox.Items 中的所有项目，然后遍历设置给它的 IEnumerable 对象并将它们添加到项目集合中。在您的情况下，您可以使用 radComboBox.Items.Add() 手动添加所有项目。

```
var stack= GetItems(SiteId);
//Add your empty item. 
RadComboBox1.Items.Add(new RadComboBoxItem("", "0")); 

//Add all the other items
foreach(var item in stack)
{
    RadComboBox1.Items.Add(new RadComboBoxItem(item.Name, item.Id))
}  

RadComboBox1.DataTextField = "Name"; 
RadComboBox1.DataValueField = "Id"; 
```

或者您可以先将空项目添加到集合中，然后将其绑定到 RadComboBox（我假设堆栈是 StackItem 的列表）

```
List<StackItem> stack = GetItems(SiteId);
//Add your empty item. 
stack.Insert(0, new StackItem(){Name = "", Id = 0});

//Set the DataSource
RadComboBox1.DataSource = stack;

RadComboBox1.DataTextField = "Name"; 
RadComboBox1.DataValueField = "Id"; 
```

尽管通常在这种情况下更改您的集合（后一个示例）并不是一个好主意。

# html - 将锚的下划线样式与 inline-block 元素混合

> ID：12902749
> 
> 赞同：4
> 
> 时间：2012-10-15T19:35:57.350
> 
> 标签：html, css, anchor

我注意到，如果一个元素，例如 span 或 p，具有 inline-block 的显示，那么当放置在其中时，它将覆盖锚的下划线样式。

```
<a href="http://www.stackoverflow.com"><span style="display:inline-block">test</span></a>
<a href="http://www.stackoverflow.com"><p style="display:inline-block">test</p></a> 
```

有没有办法防止这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T19:40:32.117

1）将样式移动到A标签

```
<a href="http://www.stackoverflow.com" style="display:inline-block">test</a> 
```

或者

2）给子元素添加下划线

```
<a href="http://www.stackoverflow.com"><p style="display:inline-block;text-decoration:underline">test</p></a> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T18:17:33.760

添加到样式标签`text-decoration:inherit;`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T19:40:41.487

添加以下样式：

```
​a *:hover { text-decoration: underline }​ 
```

[演示](http://jsfiddle.net/2e24v/)

# c++ - How to clone object in C++ ? Or Is there another solution?

> ID：12902751
> 
> 赞同：30
> 
> 时间：2012-10-15T19:36:06.077
> 
> 标签：c++, data-structures, stack, queue

I wrote a Stack and Queue implementation (Linked List based). There is one stack (`bigStack`). For example, I separate `bigStack` (example: `stackA` and `stackB`). I `pop()` a node from `bigStack`, I `push()` in `stackA`. In the same way, I `push()` in `stackB`. I want `bigStack` to not change. Therefore I want to clone the `bigStack` object. How do I clone objects in C++? Or is there another solution to my problem?

```
class Stack : public List {
public:
   Stack() {}
   Stack(const Stack& rhs) {}
   Stack& operator=(const Stack& rhs) {};
    ~Stack() {}

    int Top() {
        if (head == NULL) {
            cout << "Error: The stack is empty." << endl;
            return -1;
        } else {
            return head->nosu;
        }
    }

    void Push(int nosu, string adi, string soyadi, string bolumu) {
        InsertNode(0, nosu, adi, soyadi, bolumu);
    }

    int Pop() {
        if (head == NULL) {
            cout << "Error: The stack is empty." << endl;
            return -1;
        } else {
            int val = head->nosu;
            DeleteNode(val);
            return val;
        }
    }

    void DisplayStack(void);

}; 
```

then...

```
Stack copyStack = veriYapilariDersi;
copyStack.DisplayStack(); 
```

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-10-15T19:42:34.723

典型的解决方案是编写自己的函数来克隆对象。如果您能够提供复制构造函数和复制赋值运算符，这可能是您需要的。

```
class Foo
{ 
public:
  Foo();
  Foo(const Foo& rhs) { /* copy construction from rhs*/ }
  Foo& operator=(const Foo& rhs) {};
};

// ...

Foo orig;
Foo copy = orig;  // clones orig if implemented correctly 
```

有时提供显式`clone()`方法是有益的，尤其是对于多态类。

```
class Interface
{
public:
  virtual Interface* clone() const = 0;
};

class Foo : public Interface
{
public:
  Interface* clone() const { return new Foo(*this); }
};

class Bar : public Interface
{
public:
  Interface* clone() const { return new Bar(*this); }
};

Interface* my_foo = /* somehow construct either a Foo or a Bar */;
Interface* copy = my_foo->clone(); 
```

编辑：由于`Stack`没有成员变量，因此在复制构造函数或复制赋值运算符中无需`Stack`从所谓的“右手边”（`rhs`）初始化 的成员。但是，您仍然需要确保任何基类都有机会初始化*其*成员。

您可以通过调用基类来做到这一点：

```
Stack(const Stack& rhs) 
: List(rhs)  // calls copy ctor of List class
{
}

Stack& operator=(const Stack& rhs) 
{
  List::operator=(rhs);
  return * this;
}; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-15T20:15:58.110

如果您的对象不是多态的（并且堆栈实现可能不是），那么根据此处的其他答案，您想要的是复制构造函数。请注意，C++ 中的复制构造和赋值是有区别的；如果你想要这两种行为（并且默认版本不符合你的需要），你必须实现这两个功能。

如果您的对象是多态的，那么切片可能是一个问题，您可能需要跳过一些额外的环节才能进行正确的复制。有时人们使用名为 clone() 的虚拟方法作为多态复制的助手。

最后，请注意，如果您需要替换默认版本，则正确进行复制和分配实际上是相当困难的。通常最好设置您的对象（通过 RAII），以便默认版本的复制/分配执行您希望它们执行的操作。我强烈建议您查看[Meyer 的 Effective C++](https://rads.stackoverflow.com/amzn/click/com/0321334876)，尤其是第 10、11、12 项。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-15T19:42:50.207

在 C++ 中，复制对象意味着克隆。该语言没有任何特殊的克隆。

正如标准所建议的那样，在复制后，您应该拥有同一对象的 2 个相同副本。

有两种类型的复制：在非初始化空间上创建对象时的复制构造函数和在设置新状态之前需要释放对象的旧状态（预期有效）的复制运算符。

# wordpress - WordPress - specific file for custom post type

> ID：12902752
> 
> 赞同：0
> 
> 时间：2012-10-15T19:36:08.387
> 
> 标签：wordpress, wordpress-theming

I know I can create custom files for specific custom-post-types

Unfortunately, the method works for me in one case:

*   page-results.php for CPT = results
*   but does not work for page-news.php where CPT = news
*   or does not work for page-events.php where CPT = events

Why? can you have just a single file like that?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T20:02:53.817

这可能会为您澄清一些事情：

[Wordpress 模板层次结构](http://codex.wordpress.org/images/1/18/Template_Hierarchy.png)

问题是，您的自定义帖子类型实际上并不是“页面”。即使是“页面”在技术上也不是实际的页面，而是称为“页面”的分层自定义帖子类型。令人困惑？是的。但有一种方法可以疯狂。

称为“页面”的内置帖子类型与称为“帖子”的内置帖子类型的功能不同，这就是它们有自己的默认模板和层次结构的原因。然而，尽管 Wordpress 允许您扩展其核心以包含您自己的自定义帖子类型，但在其根部，它们仍被视为“帖子”，并且不会遵循“页面”分支。

如果您遵循标准模板命名约定，您的两个选择是将您的自定义帖子存档模板命名为“archive-results.php”、“archive-news.php”和“archive-events.php”。

至于您的自定义帖子单个帖子模板，您可以将它们命名为“single-results.php”、“single-news.php”和“single-events.php”。

如果您想为所有三种自定义帖子类型使用存档或单个模板，只需不要定义单独的帖子类型并定义“archive.php”和“single.php”文件。

[这是有关自定义帖子类型模板](http://codex.wordpress.org/Post_Type_Templates)的更多信息

# android - Android Resource Identifier for High Resolution Phones and Google TVs

> ID：12902755
> 
> 赞同：4
> 
> 时间：2012-10-15T19:36:28.510
> 
> 标签：android, google-tv, android-resources

Which resource identifier can I use for Google TVs to distinguish it from phones like the Galaxy S3, layout-sw720dp doesn't work?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T19:39:40.013

您可以使用`tvdpi`：

> 介于 mdpi 和 hdpi 之间的屏幕资源；大约 213dpi。这不被视为“主要”密度组。它主要用于电视，大多数应用程序不需要它 - 为大多数应用程序提供 mdpi 和 hdpi 资源就足够了，系统将根据需要对其进行缩放。如果您发现有必要提供 tvdpi 资源，则应将它们的大小调整为 1.33*mdpi。例如，mdpi 屏幕的 100px x 100px 图像对于 tvdpi 应该是 133px x 133px。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T18:22:28.483

我尝试了 tvdpi，但不幸的是 Galaxy S3 正在获取资源。我最终使用 layout 和 layout-large 作为资源。Nexus 和 Google TV 从 layout-large 中获取资源，而 Galaxy S3 从 layout 中获取资源。谢谢。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T20:17:25.303

电视设置 可寻址屏幕尺寸（以像素为单位） 密度标识符 屏幕密度（以 dp 为单位） 显示分辨率（以 dp 为单位） 屏幕尺寸标识符

*   720p 1280 x 720 像素 tvdpi 213 960 x 540 大

*   1080p 1920 x 1080 像素 xhdpi 320 960 x 540 大

这来自：[https ://developers.google.com/tv/android/docs/gtv_android_patterns](https://developers.google.com/tv/android/docs/gtv_android_patterns)

有关显示指南的更多详细信息：[https ://developers.google.com/tv/android/docs/gtv_displayguide](https://developers.google.com/tv/android/docs/gtv_displayguide)

# python - Lxml can't parse gzipped XML?

> ID：12902756
> 
> 赞同：1
> 
> 时间：2012-10-15T19:36:33.997
> 
> 标签：python, lxml

I have this Gzipped XML-file: [http://cdon.com/xml_files/cdon_games_SE.xml.gz](http://cdon.com/xml_files/cdon_games_SE.xml.gz)

According to lxml [http://lxml.de/parsing.html](http://lxml.de/parsing.html) lxml can parse gzipped XML-files: "lxml can parse from a local file, an HTTP URL or an FTP URL. It also auto-detects and reads gzip-compressed XML files (.gz)."

This code:

```
from lxml import etree
tree = urllib.urlopen('http://cdon.com/xml_files/cdon_games_SE.xml.gz')
parser = etree.XMLParser(recover=True)
tree = etree.parse(tree, parser)
tree = tree.xpath(//product) 
```

Gives error:

```
tree = tree.xpath(//product)
  File "lxml.etree.pyx", line 2038, in lxml.etree._ElementTree.xpath (src/lxml\lxml.etree.c:47529)
  File "lxml.etree.pyx", line 1709, in lxml.etree._ElementTree._assertHasRoot (src/lxml\lxml.etree.c:44508)
AssertionError: ElementTree not initialized, missing root 
```

What is wrong? Can't `lxml` parse gzipped XML-files? If I save the file in xml (without gzip) as a file on the local server it works.

# xmlhttprequest - xmlhttp POST 不起作用

> ID：12902762
> 
> 赞同：0
> 
> 时间：2012-10-15T19:36:56.077
> 
> 标签：xmlhttprequest

我正在尝试使用中间件客户端（称为 Cohesion）将事务发布到服务器。下面是我的代码（asp）：

```
Dim xmlhttp 'As Object

Set xmlhttp = CreateObject("MSXML2.ServerXMLHTTP")

xmlhttp.Open "POST", "http://server_ip/Databox-dr/CohesionConnect.asmx/GetHostReply", False

'using only http://server_ip/Databox-dr/CohesionConnect.asmx doesn't work, either

xmlhttp.setRequestHeader "Content-Type", "application/x-www-form-urlencoded"
'xmlhttp.setRequestHeader "Content-Length", "128"

xmlhttp.send "50000000000MSUF"

Set xmlhttp = Nothing 
```

我拥有的文档（仅此而已）告诉我：

HTTP POST 以下是一个示例 HTTP POST 请求和响应。显示的占位符需要替换为实际值。

```
POST /DATABOX-DR/CohesionConnect.asmx/GetHostReply HTTP/1.1
Host: server_ip
Content-Type: application/x-www-form-urlencoded
Content-Length: length

sTran=string

HTTP/1.1 200 OK
Content-Type: text/xml; charset=utf-8
Content-Length: length

<?xml version="1.0" encoding="utf-8"?>
<string xmlns="http://fidelityifs.com/webservices">string</string> 
```

（长度和字符串需要替换为实际值）

我究竟做错了什么？如何设置字符串长度？谢谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T19:47:47.780

尝试这个：

```
Dim xmlhttp As Object
Set xmlhttp = CreateObject("MSXML2.ServerXMLHTTP")
xmlhttp.Open "POST", "http://server_ip/Databox-dr/CohesionConnect.asmx/GetHostReply", False
xmlhttp.setRequestHeader "Content-Type", "application/x-www-form-urlencoded"

tosend = "50000000000MSUF"
s = "sTran=" & tosend

xmlhttp.setRequestHeader "Content-Length", Len(s)

xmlhttp.send s 
```

# c# - 使用剃刀内联设置javascript变量，这是好的做法/安全吗？

> ID：12902763
> 
> 赞同：4
> 
> 时间：2012-10-15T19:36:59.427
> 
> 标签：c#, asp.net, asp.net-mvc-3

如果我想从我的模型中设置一些 javascript 变量，那会是一种安全的做法吗？例如：

```
<script type="text/javascript">
    var myVariable = '@Model.myVar';
</script> 
```

这是一个好的做法吗？除了可能进行隐藏输入之外，我想不出更好的方法来真正做到这一点，但与此相比，这似乎工作太多了。我只是不知道这是否容易受到攻击，或者这样做是否有一些我忽略的东西。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-15T19:49:03.890

我认为这有几个问题。从根本上说，您将 javascript 与您的页面或视图紧密耦合。我认为自己是一个可靠的 .NET / C# / MVC 开发人员，但也是 javascript 的初学者，这正是我直到最近才追求的设计类型。过去，我会在我的视图中内嵌各种 javascript 并大量使用 Razor。最后它可以工作，但它会导致您的标记和脚本非常紧密地耦合，并最终产生一个难以维护的环境。

一个更好的方法是改为对 javascript 函数进行内联调用。差异是微妙的，但它将强制将这两个区域分开。

```
<script type="text/javascript">
    MyFunction('@Model.myVar');
</script> 
```

您还可以通过 Razor 在隐藏的输入字段、跨度等中嵌入值，并将它们在那里公开给您的 javascript。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T19:39:15.537

它应该是安全的，因为输出默认在 razor 中编码。

但是，如果您输出的值是用户可以更改的值，则您必须确保它已经过验证（服务器端）以停止任何 XSS。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T19:40:43.953

你这样做很好。这样做不会引入任何漏洞。如果它们已经存在，则不会阻止漏洞的出现，但这肯定不会再增加。

# c# - 使用通用模型 Visual Studio 2012 实体框架上缺少引用的问题

> ID：12902766
> 
> 赞同：0
> 
> 时间：2012-10-15T19:37:11.250
> 
> 标签：c#, entity-framework, visual-studio-2012

EntityFramework 运行时 v4.0.30319 版本 5.0.0.0

```
public abstract class AbstractPessoaFisicaDao<T>:IBasePessoaFisicaDao<T> where T: class
{

    SupremaDesEntities entidades = new SupremaDesEntities();
    Cadastro_PessoaFisica Pessoa = new Cadastro_PessoaFisica();

    public void Add(T pEntity)
    {
        entidades.Cadastro_PessoaFisica.AddObject();
    } 
```

错误 1“System.Data.Entity.DbSet”不包含“AddObject”的定义，并且找不到接受“System.Data.Entity.DbSet”类型的第一个参数的扩展方法“AddObject”（您是否缺少使用指令或程序集引用？） c:\users\msbow\documents\visual studio 2012\Projects\Inside.Net.EF\Inside.Net.EF.Data\AbstractPessoaFisicaDao.cs 26 45 Inside.Net.EF.Data

我在visual studio 2010学习这个，我现在有2012的终极版，不能调整这个参考，已经下载了框架和几个dll什么的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T19:55:15.020

尝试：

```
SupremaDesEntities entidades = new SupremaDesEntities(); 

public void Add(T pEntity) 
{         
    entidades.Set<T>().Add(pEntity);
} 
```

或者，如果您想保持实体类型为强类型：

```
SupremaDesEntities entidades = new SupremaDesEntities(); 

public void Add(Cadastro_PessoaFisica pessoa) 
{ 
    entidades.Cadastro_PessoaFisica.Add(pessoa); 
} 
```

# jquery - 如何选择所有复选框，但不选择具有某些 id 的复选框

> ID：12902768
> 
> 赞同：0
> 
> 时间：2012-10-15T19:37:19.363
> 
> 标签：jquery, jquery-selectors

我有一个每行一个复选框的表格，我想用 jQuery 选择所有复选框，但不是第一个具有 id='selectAll' 的复选框

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-15T19:38:25.073

[不](http://api.jquery.com/not/)使用：

```
$('input[type="checkbox"]').not('#selectAll') 
```

或者，要选择除第一个以外的所有复选框，您也可以使用[gt](http://api.jquery.com/gt-selector/)：

```
$('input[type="checkbox"]:gt(0)') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T19:39:07.947

这样做的许多方法之一..

```
$(':checkbox', '#tableID').filter(function () {
   return this.id != 'selectAll'; 
}).prop('selected', true); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T19:39:14.933

```
$('input[type="checkbox"]').not('#id') 
```

# ruby-on-rails-3 - link_to 在 Rails 中发布 ID

> ID：12902769
> 
> 赞同：0
> 
> 时间：2012-10-15T19:37:20.787
> 
> 标签：ruby-on-rails-3, link-to

在我的提要中，我有这个：

```
<span class="title"><strong><%= link_to feed_item.title, @micropost %></strong></span><br> 
```

我不知道如何使它链接到帖子的各个页面。

现在它链接到：`http://localhost:3000/microposts`我收到一个错误：**没有路由匹配 [GET] "/microposts"**

如果我手动输入 URL：`http://localhost:3000/microposts/25`我可以看到帖子的个人页面。

这可以链接到用户个人资料，但我无法让链接到微博页面。<%= 链接到 feed_item.user.name, feed_item.user %>

我是 Rails 新手，我正在努力解决这个问题。任何帮助，将不胜感激。

microposts_controller.rb

```
class MicropostsController < ApplicationController
  before_filter :signed_in_user, only: [:create, :destroy]
  before_filter :correct_user,   only: :destroy

  def index
  end

  def show
    @micropost = Micropost.find(params[:id])
  end

  def create
    @micropost = current_user.microposts.build(params[:micropost])
    if @micropost.save
      flash[:success] = "Micropost created!"
      redirect_to root_url
    else
      @feed_items = []
      render 'static_pages/home'
    end
  end

  def destroy
    @micropost.destroy
    redirect_to root_url
  end

  private

  def correct_user
    @micropost = current_user.microposts.find_by_id(params[:id])
    redirect_to root_url if @micropost.nil?
  end
end 
```

配置/路由.rb

```
SampleApp::Application.routes.draw do
  resources :users do
    member do
      get :following, :followers
    end
  end
  resources :sessions, only: [:new, :create, :destroy]
  resources :microposts, only: [:create, :destroy, :show]
  resources :relationships, only: [:create, :destroy]

  root to: 'static_pages#home'

  match '/signup',  to: 'users#new'
  match '/signin',  to: 'sessions#new'
  match '/signout', to: 'sessions#destroy', via: :delete

  match '/help',    to: 'static_pages#help'
  match '/about',   to: 'static_pages#about'
  match '/contact', to: 'static_pages#contact'
end 
```

_feed_item.html.erb

```
<li id="<%= feed_item.id %>">
  <%= link_to gravatar_for(feed_item.user), feed_item.user %>
  <span class="title"><strong><%= link_to feed_item.title, micropost_path(@micropost) %></strong></span><br>
    <span class="user">
      <p><small>Created by: <%= link_to feed_item.user.name, feed_item.user %><br>
        <%= feed_item.loc1T %><br>
         <%= feed_item.startTime.strftime('%A, %B %d, %Y') %></small></p>
    </span>
    <span class="content"><%= feed_item.content %></span>
    <span class="timestamp">
      Posted <%= time_ago_in_words(feed_item.created_at) %> ago.
    </span>
  <% if current_user?(feed_item.user) %>
    <%= link_to "delete", feed_item, method: :delete,
                                     data: { confirm: "Are you sure?" },
                                     title: feed_item.content %>
  <% end %>
</li> 
```

feed.html.erb

```
<% if @feed_items.any? %>
  <ol class="microposts">
    <%= render partial: 'shared/feed_item', collection: @feed_items %>
  </ol>
  <%= will_paginate @feed_items %>
<% end %>` 
```

静态页面控制器

```
class StaticPagesController < ApplicationController
  def home
    if signed_in?
      @micropost  = current_user.microposts.build
      @feed_items = current_user.feed.paginate(page: params[:page])
    end
  end

  def help
  end

  def about
  end

  def contact
  end
end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T22:03:37.383

**长答案**

当您将路由添加到您的 routes.rb 文件时，Rails 会为您生成许多方便的命名路由。通常，当对路线有疑问时，我会查看我的 rake routes 任务，它会显示所有可用路线的列表。尝试运行`rake routes > routes.txt`并打开相应的 routes.txt 文件。

生成的文件将为您列出一系列请求，在您的情况下，您的 microposts 控制器应该会看到与此类似的内容：

> ```
>  POST      /microposts(.:format)                microposts#create
> micropost GET       /microposts/:id(.:format)            microposts#show
>           DELETE    /microposts/:id(.:format)            microposts#destroy 
> ```

Rake 路线为您的每条路线生成以下信息（如果适用）：

1.  路线名称（如果有）
2.  使用的 HTTP 动词（如果路由没有响应所有动词）
3.  要匹配的 URL 模式
4.  路由的路由参数

考虑到这些信息，我们可以简单地查看 routes.txt 文件中提供的 url，以获取我们试图访问的 url (/microposts/25)。您会看到列出的`/microposts/:id(.:format)`url 模式完美地处理了这一点。瞧，它还映射到您想要的 microposts#show 操作，所以现在要获得命名路线，只需查看要出现的第一列，您就会看到“microposts”关键字。只需在其中添加 _path ，您就可以在视图中使用命名路由来生成链接 url。由于此特定路由需要一个 id 参数（如 url 模式中所述），因此您还必须传递命名的路由助手和 id 参数。

同样在您的 routes.rb 文件中，当您添加`resources :something`它时，它会为默认的七个 RESTful 路由（新建、创建、编辑、更新、删除、索引、显示）中的每一个生成路由。在您的情况下，您明确告诉 rails 为创建、销毁和显示操作生成默认路由，以便您可以擦除底部的行， `match "/microposts/:id" => "microposts#show"`因为这已经被处理了。

* * *

**简短的回答**

改变这个：

```
<%= link_to feed_item.title, @micropost %> 
```

对此：

```
<%= link_to feed_item.title, micropost_path(feed_item) %> 
```

请参阅[Ruby on Rails 指南：从外到内的 Rails 路由，](http://guides.rubyonrails.org/routing.html)了解有关路由的所有信息。

# android - 如何使用 Robolectric 隐藏 PackageManager

> ID：12902777
> 
> 赞同：14
> 
> 时间：2012-10-15T19:38:08.317
> 
> 标签：android, shadow, robolectric

我的 Android 应用程序有一个简单的方法来触发显示 URL 的意图。

```
protected void launchBrowser(int id)
{
    Uri uri = Uri.parse( getString( id ) );
    Intent intent = new Intent( ACTION_VIEW, uri);

    PackageManager packageManager = getPackageManager();
    List<ResolveInfo> activities = packageManager.queryIntentActivities(intent, 0);
    if (activities.size() > 0)
    {
        startActivity(intent);
    }
    else
    {
        Toast.makeText(getApplicationContext(),
                       "ERROR - no application to display a web page",
                       Toast.LENGTH_SHORT).show();
    }
} 
```

我正在使用 Robolectric 进行单元测试，但我无法验证此方法。具体来说，`getPackageManager()`总是返回 null。我怎样才能阴影`PackageManager`？我尝试创建一个`ShadowPackageManager`并调用`bindShadowClass`，但我的代码都没有被执行——`getPackageManager()`总是返回`null`。我还尝试隐藏 Application 上下文并返回一个具体的`StubPackageManager`，但得到了相同的结果。也许我一直在搜索/盯着太久 - 有没有更好的方法来单元测试这个方法？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2014-06-15T21:18:56.730

我为此使用 Robolectric 2.3。如其他答案所述，`getPackageManager()`不返回 null，但`shadowApplication.setPackageManager`不再存在。

由于你不能 mock `PackageManager`，你不能给它一个`Intents`要解决的列表。幸运的是，Robolectric 的`PackageManager`子类`RobolectricPackageManager`可以让您在没有模拟的情况下添加这些意图：

```
RobolectricPackageManager rpm = (RobolectricPackageManager)Robolectric.application.getPackageManager();
rpm.addResolveInfoForIntent(new Intent(Settings.ACTION_APPLICATION_DEVELOPMENT_SETTINGS), new ResolveInfo()); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-17T00:20:22.540

出于某种原因，您需要在您的应用程序上手动设置影子包管理器。创建一个自定义测试运行器（通过扩展 RobolectricTestRunner）并覆盖 setApplicationState 方法：

```
public class MyTestRunner extends RobolectricTestRunner {   
  @Override
  public void setupApplicationstate(RobolectricConfig robolectricConfig) {
     super.setupApplicationState(robolectricConfig);
     ShadowApplication shadowApplication = shadowOf(Robolectric.application);
     shadowApplication.setPackageName(robolectricConfig.getPackageName());
     shadowApplication.setPackageManager(new RobolectricPackageManager(Robolectric.application, robolectricConfig));
  }
} 
```

然后在你的测试中指定你想使用你自己的测试运行器：

```
@RunWith(MyTestRunner.class)
public class MyTest { ... } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-01-31T17:15:32.213

只需添加到[aleph_null](https://stackoverflow.com/users/933926/aleph-null)的答案，您就可以使用它`ShadowResolveInfo.newResolveInfo()`来快速创建一个`ResolveInfo`可供使用的模拟（我使用的是 Robolectric 2.4）。

```
RobolectricPackageManager rpm = (RobolectricPackageManager)Robolectric.application.getPackageManager();
rpm.addResolveInfoForIntent(new Intent(Settings.ACTION_APPLICATION_DEVELOPMENT_SETTINGS), ShadowResolveInfo.newResolveInfo(...)); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-06-13T16:46:07.730

我升级到最新的 Robolectric（2.1.1 版），PackageManager`null`不再出现。

下面的代码验证是否触发了浏览器意图（并配置了 url）。我还没有在 1.x 上测试过这个，但我认为它也可以在那里工作：

```
@Test
public void recipeTitleShouldOpenBrowserOnClick() throws Exception
{
    title.performClick();
    ShadowActivity shadowActivity = shadowOf( detailFragment.getActivity() );
    ShadowActivity.IntentForResult intent = shadowActivity.peekNextStartedActivityForResult();

    // or
    // ShadowActivity.IntentForResult intent = shadowActivity.getNextStartedActivityForResult();

    assertThat( intent.intent,
                equalTo( createBrowserIntentWithURL( "url" ) ) );
} 
```

**注意**：我在这里从一个片段调用启动活动。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-06-09T05:57:59.550

您可以在单独的方法中设置 ShadowPackageManager（无需扩展 RobolectricTestRunner）

```
private void setupPackageManager() {
    ShadowApplication shadowApplication = shadowOf(Robolectric.application);
    shadowApplication.setPackageManager(mockPackageManager);
    List<ResolveInfo> activities = new ArrayList<ResolveInfo>();
    activities.add(resolveInfo("com.test.package.Class1"));
    activities.add(resolveInfo("com.test.package.Class2"));
    when(mockPackageManager.queryIntentActivities(any(Intent.class), anyInt())).thenReturn(activities);
} 
```

**注意**：在这里，我使用了 mockito 并为我的单元测试模拟了 packagemanager，而不是使用实际的 PackageManager。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-11-17T13:55:22.823

对于 Robolectric 3.1，您可以

```
RobolectricPackageManager packageManager = RuntimeEnvironment.getRobolectricPackageManager();
// add necessary logic here 
```

# ios - ARC 正在释放 calloc'ed 内存？

> ID：12902778
> 
> 赞同：2
> 
> 时间：2012-10-15T19:38:12.733
> 
> 标签：ios, automatic-ref-counting, calloc

我的代码中发生了一些奇怪的事情。基本上我正在做网络流应用程序，将一些数据传输到 iOS 上的环形缓冲区内存中，然后读取内存。我正在获取`EXC_BAD_ACCESS`一些未确定数量的数据。所以我启用 `NSZombieEnabled`并`NSAutoreleaseFreedObjectCheckEnabled`设置了`malloc_error_break`并且能够查明错误的原因。

我`MainClass`有财产（也尝试过强参考，相同的行为）

> @property (nonatomic, 保留) RingBuffer *readBuffer;

在`RingBuffer`类中，我将缓冲区大小初始化为：

```
-(id) initWithSize: (NSInteger) size
{
    self = [super init];
    m_size = size;
    buffer = (unsigned char *)calloc(m_size, sizeof(unsigned char));
    overflow = FALSE;
    m_tail = 0;
    m_head = 0;
    error = 0;
    return self;
} 
```

之后，我使用 push 方法在 ringbuffer 中插入数据

```
- (void) push: (unsigned char) byte
{
    if (m_head == m_size && overflow == FALSE) {
        m_head = 0;
        overflow = TRUE;
        }
    buffer[m_head] = byte;
    m_head ++;
    if (overflow) m_tail++;
    if (m_tail == m_size) m_tail = 0;
} 
```

如果我删除推送调用，应用程序将不会崩溃。如果调用推送调用，它会在一段时间后崩溃。有时我得到`alloc: *** error for object 0x1cad3404: incorrect checksum for freed object - object was probably modified after being freed. *** set a breakpoint in malloc_error_break to debug`......有时它只是 EXC_BAD_ACCESS。

基本上，我不明白为什么会导致这个问题？ARC是否有可能释放了被调用的内存？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T21:58:37.760

> ARC是否有可能释放了被调用的内存？

不，那是不可能的。ARC 是 Automatic Reference Counting 的缩写，是一种编译器功能，如果启用，它可以通过将释放、保留和自动释放内存调用直接插入到编译代码中来提供 Objective C 对象的自动内存管理。因为`buffer`不是Objective C 对象，而是指向堆上已分配内存块的指针，ARC 不会释放该内存块。您有义务自己释放这个分配的内存块。

要了解有关 ARC 工作原理的更多信息，请查看 Apple 的 WWDC 2011 会议视频：[介绍自动引用计数](https://developer.apple.com/videos/wwdc/2011/#introducing-automatic-reference-counting)。

> 基本上，我不明白为什么会导致这个问题？

很难说，但问题可能`m_head`是只有在`m_head == size && overflow == FALSE`. 此条件仅在第一次`m_head`等于时为真，（因为溢出 == FALSE），但在下一次等于`m_size`时不再为真，因为等于（并且不会重置为 0）。`m_head``m_size``overflow``TRUE``m_head`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T21:46:05.190

达到 if-condition 为 TRUE 后，溢出设置为 TRUE。但是，这个程序永远不会将溢出重置为 FALSE。所以，m_head 是继续增长的。永远不要重置为零。结果，缓冲区[m_head] 访问超出保留内存。

好？

# c# - 在 web.config 中指定链接的 sql server

> ID：12902782
> 
> 赞同：1
> 
> 时间：2012-10-15T19:38:32.950
> 
> 标签：c#, sql, connection-string, linked-server

你如何设置链接服务器`MVC3 Web.Config`？

我们有一个链接服务器，它有一个`SP_PROC`我们需要运行的存储过程。但是，主`SQL`服务器`TESTSERVER1`和链接服务器都是在测试环境中设置的`TESTSERVER2`，因此一旦应用程序上线，名称/ip 将发生变化。`SP`因此，除了代码中的名称 之外，我不想指定任何其他内容。

我已经尝试在连接字符串的初始目录字段中指定链接服务器，但这会引发错误 - 所以我假设我在吠叫错误的树..

连接字符串示例：

```
<add name="connectionName" connectionString="data source=TESTSERVER1;Initial Catalog=TESTSERVER2;user id.../> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-15T19:42:01.550

链接服务器是在服务器上配置的，而不是在连接上。您连接到主服务器，您的查询将在查询中按名称引用链接服务器：

```
SELECT * FROM TESTSERVER2.database.dbo.tablename 
```

我建议不要对链接服务器名称使用实际的服务器名称，而是将其抽象化，以便您的查询可以从一个服务器移植到下一个服务器。

# python - BeautifulSoup4 藏在哪里？

> ID：12902783
> 
> 赞同：19
> 
> 时间：2012-10-15T19:38:33.320
> 
> 标签：python, beautifulsoup, pip

我做到`sudo pip install BeautifulSoup4`了，得到了非常乐观的回应：

```
Downloading/unpacking beautifulsoup4
  Running setup.py egg_info for package beautifulsoup4
Installing collected packages: beautifulsoup4
  Running setup.py install for beautifulsoup4
Successfully installed beautifulsoup4
Cleaning up.. 
```

但是当我尝试在脚本中使用`import BeautifulSoup4`或`from BeautifulSoup4 import BeautifulSoup4`时，python 说没有该名称的模块。

```
> import BeautifulSoup
ImportError: No module named BeautifulSoup 
```

更新：`pip`告诉我`beautifulsoup4 in /usr/local/lib/python2.6/dist-packages`，但我正在运行 2.7.2+（并`print sys.path`看到 2.7 路径）......所以现在我需要弄清楚为什么`pip`把东西放在错误的地方。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-10-15T19:39:25.400

试试`import bs4`。不幸的是，PyPI 包名和导入名之间没有对应关系。之后类名与之前相同，例如。`soup = bs4.BeautifulSoup(doc)`将工作。

如果这仍然不起作用，`pip install`请重试并记下软件包安装的路径。然后在你的 python 控制台中运行`import sys`并`print sys.path`确保路径在那里。

您可能需要明确指定`pip-2.7`或切换到`easy_install`（或`easy_install-2.7`）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2018-06-25T22:20:51.603

尝试这个： `from bs4 import BeautifulSoup`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-11-28T20:30:10.887

我在使用 VS Code 和**Pylance**扩展时遇到了这个问题。我能够通过找到我的 python 包的位置（在我的情况下是“c:\python39\lib\site-packages”）并将其添加到 Pylance 设置中的外部解析路径来解决它。Pylance 然后能够找到导入的位置。我使用下面的代码段从 bs4 导入 BeautifulSoup。

```
from bs4 import BeautifulSoup 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-17T09:25:43.153

After trying the easy_install and pip if things dont work then download the tz package from the package website untar it in a folder. Now open cmd window and go to the directory where you unzip the tz and run the command 'python setup.py install' IT should work

# perl - 根据用户输入的文件名打开特定目录中的文件

> ID：12902784
> 
> 赞同：0
> 
> 时间：2012-10-15T19:38:36.477
> 
> 标签：perl, file-io, directory, user-input

我正在尝试`\\\server\folder\folder\folder\filename.csv`根据用户输入的文件名打开位于的文件。该文件将始终为 csv 文件，但名称会因部门而异。该目录将始终相同，但它不是 Perl 所在的目录。

我在尝试打开文件时遇到问题。我尝试创建 2 个变量，1 个用于目录，1 个用于文件名，但是当我尝试打开`$directory\\$FileName`. 我尝试使用硬编码的目录和文件名变量来执行 open 语句，但 Perl 认为该变量是文件名的一部分（这是有道理的）。这甚至可能吗？

打开文件后，我要运行代码，该代码将编辑文件本身（这工作正常），然后我想将文件保存在新位置。这个新位置与目录相同，但我想向它添加另一个文件夹级别，然后添加相同的文件名。一种“更改前”文件位置和“更改后”文件位置。

```
print "What is your FULL file name going to be with extension included?";
my $fileInName = <>; 
my $@dirpath= '\\\\Server\\Folder1\\Folder2\\Folder3\\Folder4\\Sorted_files\\';
my $Excel = Win32::OLE->GetActiveObject('Excel.Application') || 
    Win32::OLE->new('Excel.Application', 'Quit'); 
my $Book = $Excel->Workbooks->Open($directory $file); 
my $Sheet = $Book->Worksheets(1);
$Sheet->Activate(); 
```

这就是我现在拥有的代码。我也尝试了以下方法：

```
my $@dirpath= '\\\\server\\folder1\\folder2\\folder3\\call_folder4\\Sorted_files\\$fileName'; 
```

当然，我收到“找不到文件错误：

如果我对整个路径名进行硬编码，我的文件打开效果很好，但我不想有 25 个单独的脚本，唯一的区别是文件名。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T19:50:31.217

使用`file::spec`模块。它是可移植的，您不必担心在路径中转义斜杠字符（更新：大部分是正确的，但在这种情况下，您仍然需要转义服务器引用，如下所示，在分配给`@dirpath`）。

例如：

```
use File::Spec::Functions;

# get users file from the cmd line arg
my $usersfile = $ARGV[0];

my @dirpath = qw/\\\server folder folder folder/;
my $filepath = catfile(@dirpath,$userfile);

# test existence
die "file does not exist" unless(-e $filepath); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T20:59:25.710

```
my $@dirpath= '\\Server\Folder1\Folder2\Folder3\Folder4\Sorted_files\';
my $Book = $Excel->Workbooks->Open($directory $file); 
```

甚至不编译。它应该是：

```
my $dirpath = '\\\\Server\Folder1\Folder2\Folder3\Folder4\Sorted_files';
my $Book = $Excel->Workbooks->Open("$dirpath\\$file"); 
```

# django - ImageField 的“当前”和“清除”有时不会出现

> ID：12902785
> 
> 赞同：1
> 
> 时间：2012-10-15T19:38:37.800
> 
> 标签：django

假设您有一个模型，该模型具有任何类型的必填字段以及可选的 ImageField。假设您使用 Django 的内置管理界面在此数据库表中插入一行，并且当您这样做时，您填写了这两个字段。现在假设您要编辑刚刚创建的行。ImageField 将如下所示：

目前：[网址] | [复选框] 清除更改：[文件小部件]

如果您上传非图像（例如 PDF），它会显示“上传有效图像。您上传的文件不是图像或损坏的图像”。只是现在“当前：[url] | [checkbox] Clear”部分将不再存在。这可能会误导用户（使他们认为原始图像现已消失）。

另一个问题是假设您正在编辑该行并且您将必填字段空白并用另一个图像替换了图像。当然，它会抱怨未填写必填字段。但是，图像字段的“当前：[url] | [复选框] 清除”部分将不再存在。同样，这会误导用户。

这是一个错误还是这是预期的行为？无论哪种方式，我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T22:54:58.350

由于两周过去了，没有人回答这个问题，我认为这一定是 Django 开发人员的更多问题。[我问他们](https://groups.google.com/d/topic/django-developers/3lpFZ380dzQ/discussion)，Carl Meyer 说他会称之为虫子。他让我为此提交错误报告，所以我做了：

[https://code.djangoproject.com/ticket/19215](https://code.djangoproject.com/ticket/19215)

# javascript - 字体调整器 Javascript 在 IE8 和 IE7 中不起作用

> ID：12902788
> 
> 赞同：0
> 
> 时间：2012-10-15T19:38:45.043
> 
> 标签：javascript, internet-explorer-8, fonts, resize, internet-explorer-7

我正在尝试在我公司的网站上放置一个字体调整器，因为我们的很多客户都是老年人，他们不知道 Ctrl +“+”。

这是我们拥有的代码。大小调整器在 FF、Chrome 和 IE9 下工作正常。但不是在 IE8 和 IE7 中。我在这里省略了创建 cookie/读取 cookie 部分。

```
function createCookie(name,value,days) {.....codes for create cookies......}

function changeFont(incfont) {
    try{
        var p = document.getElementsByClassName('resizable');
        for(n=0; n<p.length; n++) {
            if(p[n].style.fontSize) {
                var size = parseInt(p[n].style.fontSize.replace("px", ""));
            } else {
                var size = parseInt(window.getComputedStyle(p[n],null).getPropertyValue('font-size').replace("px", ""));
            }
            p[n].style.fontSize = size+ incfont + 'px';
        }

        p = document.getElementsByTagName('p');
        for(n=0; n<p.length; n++) {
            if(p[n].style.fontSize) {
                var size = parseInt(p[n].style.fontSize.replace("px", ""));
            } else {
                var size = parseInt(window.getComputedStyle(p[n],null).getPropertyValue('font-size').replace("px", ""));
            }
            p[n].style.fontSize = size+ incfont + 'px';
        }
    } catch(err) {}
}

function readCookie(name) { ....code for read cookies ....}

function increaseFontSize() {
    var inc=0;
    try {
        var x = readCookie('textsize')
        if (x && x!=0) {
            x = parseInt(x);
            inc = x;
        }
    } catch (e) {}

    if (inc<3) {
        inc++;
        changeFont(1);
        createCookie('textsize',inc,1);
    }
}

function decreaseFontSize() {
    var inc=0;
    try {
        var x = readCookie('textsize')
        if (x && x!=0) {
            x = parseInt(x);
            inc = x;
        }
    } catch (e) {}

    if (inc>0) {
        inc--;
        changeFont(-1);
        createCookie('textsize',inc,1);
    }
} 
```

提前致谢！YN

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T19:46:37.257

您的解决方案对我来说似乎过于复杂，我会建议您采用不同的方法，为页面正文设置基本文本大小，然后为其余元素设置字体大小百分比，这样当您想要调整所有文本的大小时您只需要做的网站：

```
$("body").css("font-size", newFontSize); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T19:45:06.697

`getComputedStyle`不适用于 9 之前的 IE。

请参阅： [https ://developer.mozilla.org/en-US/docs/DOM/window.getComputedStyle](https://developer.mozilla.org/en-US/docs/DOM/window.getComputedStyle)

此处可能提供修复：http: [//snipplr.com/view/13523/](http://snipplr.com/view/13523/) 我没有测试它，

祝你好运 ！

# javascript - 在 Node.JS 中解析 Microsoft Office 文件

> ID：12902792
> 
> 赞同：20
> 
> 时间：2012-10-15T19:39:11.753
> 
> 标签：javascript, node.js, heroku, express, doc

我正在开发一个 Web 应用程序，用户可以在其中上传 Microsoft Office 文档文件。现在，我们的服务器正在运行带有 Express.js 的 Node.JS，并且我们托管在 Heroku 上。正因为如此，我不认为我可以安装诸如 abiword 或 catdoc 之类的程序。我可以处理文件上传，但无法解析文档的内容。

如何读取 doc 文件的内容？然后将信息放入数据库中。保留基本格式（粗体、斜体、下划线）会很好，但不是必需的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-15T23:21:18.217

虽然 NPM 似乎没有任何东西可以直接执行 Word，但您可以使用 REST API 通过另一个云服务请求它。例如[Saaspose](http://saaspose.com/)（著名的 Aspose 工具）拥有[Word](http://saaspose.com/api/words)、[Excel](http://saaspose.com/api/cells)、[PDF](http://saaspose.com/api/pdf)等的公共 API。他们在其页面上列出了 node.js、javascript 和 Heroku 支持。

编辑：

我看到 Saaspose 现在被称为[Aspose for Cloud](http://www.aspose.com/cloud/total-api.aspx)

另一个声称类似的 API 是[Doxument](http://www.doxument.com/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-27T17:39:02.123

[办公](http://github.com/dkiyatkin/node-office)包：`npm install office`似乎至少提供了部分答案。我用它来读取 Excel 文件，到目前为止还没有尝试过任何 Word 文档。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-15T19:44:34.937

似乎还没有。请参阅下面的内容可能会有所帮助。

[我可以使用 Node.js 阅读 PDF 或 Word 文档吗？](https://stackoverflow.com/questions/9038231/can-i-read-pdf-or-word-docs-with-node-js)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-08-21T14:29:03.497

您可以使用 mammoth 解析 .docx 文件[https://www.npmjs.com/package/mammoth](https://www.npmjs.com/package/mammoth) 和 xlsx 解析 .xlsx 文件[https://github.com/SheetJS/js-xlsx](https://github.com/SheetJS/js-xlsx)

# java - 解析通过电子邮件发送的命令

> ID：12902797
> 
> 赞同：-1
> 
> 时间：2012-10-15T19:39:19.763
> 
> 标签：java, email

我真的不确定我应该在哪里发布这个，但如果这是错误的地方，有人可以指导我去哪里我可以得到答案吗？我希望能够向我的电子邮件地址发送命令，并在发送消息时解析和执行命令。即我发送一封电子邮件，其中包含以下内容：

```
 public class sentThruEmail {
      public static void main(String[] args) {
          System.out.println("Hello");
      }
  } 
```

我想配置我的程序以识别新电子邮件何时来自已发送地址，打开它，编译它（在这种情况下编译java），然后在运行程序的机器上执行它。我怎样才能弄清楚如何做到这一点？任何帮助都会很棒，谢谢！

编辑：或者第一步可能是如何识别电子邮件是从一个地址收到的？在 Java 中，我该怎么做：识别收到一封电子邮件并将某些内容输出到屏幕以提醒这一事实。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T19:43:52.193

这将是一个非常糟糕的主意。盲目地接受来自不受信任来源的电子邮件、编译并执行它是一个巨大的安全漏洞。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T19:44:56.920

但是，如果您想这样做，请查看套接字编程，因为您需要连接到您的电子邮件提供商（如果他允许终端登录）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-15T19:49:37.440

这有几个部分需要考虑：

**安全**

正如其他人提到的，这里有需要考虑的安全风险。如果这让您担心（而且应该！），您可能需要考虑以下一些事项：

*   对这些“命令”电子邮件进行数字签名，并在查看电子邮件之前验证该签名
    *   [PGP](http://en.wikipedia.org/wiki/Pretty_Good_Privacy)是一个受欢迎的选择
*   在“沙盒”环境中运行您的程序（读取电子邮件），例如被[chroot](http://en.wikipedia.org/wiki/Chroot)或在[监狱中](http://en.wikipedia.org/wiki/FreeBSD_jail)
*   只运行一组非常有限的命令——也许只是你发明的。

**获取邮件**

如果您仍然想这样做，考虑到安全问题，您将需要您的程序来阅读邮件。

您可能希望为此使用 IMAP 或 POP。

**解析**

收到邮件后，您需要解析内容。如果您只发送代码，您可以直接编译它。您还可以将代码作为具有特定 MIME 类型的附件发送以识别它。这样，您仍然可以发送“普通”电子邮件（可能带有有关此代码用途的评论），但您的程序将能够干净地分离出代码。

**回应**

你将如何反馈结果？还是你在乎？

您可能想要发送回复电子邮件（使用 SMTP），或更新网页。网页很好，因为如果您在本地运行 Web 服务器，您可以直接编写文件。

**例子**

*   标准的“确认电子邮件”系统与您所描述的有很多相似之处。有人向自动化系统发送电子邮件，它会读取它，进行一些处理并回复。搜索这些系统，我相信你会开始的。

*   我创建了[Exquisite Corpse Emailer](http://sourceforge.net/projects/ece/)项目，它完成了您所描述的大部分工作（但在 Perl 中）。它只接受极少数有限的命令，但它会在 IMAP 上收听电子邮件地址、解析文本、更新数据库等。

# iphone - 目标c在后台和自动释放池中执行选择器

> ID：12902799
> 
> 赞同：0
> 
> 时间：2012-10-15T19:39:22.503
> 
> 标签：iphone, objective-c

我正在开发一个 iphone 应用程序，它的一些数据存储在 sqllite 数据库中。当我的视图加载时，我想在后台线程上加载数据库中的数据。问题是应用程序不断崩溃，我不知道为什么。

编码：

```
-(id) init
{
    if((self=[super init]))
    {
       [self performSelectorInBackground:@selector(loadList) withObject:nil];
    }
 }

-(void) loadList
{
   @autoreleasepool
   {
      Loader * loader = [[Loader alloc] init];
      NSMutableArray * array = [loader getItemList];
      [array retain];
      NSLog(@"Got %d items",[array count]);

      [self performSelectorOnMainThread:@selector(createList:) withObject:array waitUntilDone:false];
      [loader release];
   }
}

-(void) createList: (NSMutableArray*) array
{
    items = array;
    int i;
    Item * it;
    for(i = 0; i < [items count]; i++)
    {
      it = [items objectAtIndex: i];
      [it getName]; // crashes
      // populate the list
    } 
} 
```

Loader 返回一个带有 Item 对象的 NSMutableArray。当我调用项目 getName（返回 NSString*）时，应用程序崩溃。据我了解，它崩溃是因为项目名称属性正在被释放。我究竟做错了什么？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T21:31:15.123

您用于填充的任何类型的对象都可能存在问题`array`。

我无法找到纸上的手指证明，但我相信它`performSelectorOnMainThread:withObject:waitUntilDone:`保留了它的对象。但是，如果其中的每个项目都`array`保留对的引用，`loader`那么他们需要负责保留该对象。看起来您正在尝试手动使其保持活动状态，但是 - 正如 Chuck 所暗示的那样 - 您的呼叫`performSelector...`将立即返回，而不是等待您完成的呼叫。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T19:50:54.760

这个特殊的错误似乎是你正在传递`waitUntilDone:NO`，所以数组被立即释放，因此它的项目也是如此。

但总的来说，UIKit 不是线程安全的，所以这只是一个敏感的设计。我可能会将这些东西的加载放在另一个为您处理任务的类中，而不是在视图中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T21:08:47.953

我会在行上放一个断点：

```
 it = [items objectAtIndex: i]; 
```

然后输入

```
po it 
```

在调试器中，查看名称字段中的内容。作为猜测，我会说两件事之一：1）getName 返回的字段没有用对象初始化（即不是真正的 NSString *），或者你从 SQLite 获取 C 字符串（其中是它通常返回的内容）并且您试图将其视为 NSString *. 如果是后者，您可以使用 [myCString stringWithUTF8String] 将 C 字符串转换为 NSString *

# php - 在 codeigniter 中，我如何在库中同时使用系统库和应用程序库？

> ID：12902804
> 
> 赞同：0
> 
> 时间：2012-10-15T19:39:33.077
> 
> 标签：php, codeigniter, session, libraries

基本上在codeigniter中，我如何在其他库中使用系统和应用程序库？所以说我有一个应用程序库，例如：

```
class User
{
   // some instance variables
} 
```

现在假设我想在 User 类中使用 codeigniter 会话类，基本上可以在 User 类中使用会话。我该怎么做呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T20:23:43.943

执行此操作的典型方法是使用`get_instance()`，它返回 Codeigniter 的实例（实际上是当前控制器类）。

这将在您的 CI 应用程序的任何地方工作：

```
get_instance()->session->set_userdata('key', 'value');
$segments = get_instance()->uri->segment_array();
// etc. 
```

通常在 Codeigniter 中，您将其分配给类变量以方便使用：

```
class User
{
    private $CI;

    function __construct()
    {
        $this->CI = get_instance();
    }

    // Example
    function login()
    {
        $user = $this->get_user();
        $this->CI->session_set_userdata('user_id', $user->id);
    }
} 
```

这确实对 CI 的状态和不同的加载类产生了很多依赖，而不是通过依赖注入将它们的实例直接传递给 User 类，但这是开发 CI 库的典型流程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T20:02:03.307

理想情况下，您只需从模型或控制器中传入所需的会话数据即可加载库。

否则，这应该适用于任何文件：

```
 <?php
    ob_start();
    include('index.php');
    ob_end_clean();
    $CI =& get_instance();
    $CI->load->library('session'); //if it's not autoloaded in your CI setup
    echo $CI->session->userdata('name');      
    ?> 
```

我在一个类似的问题上找到了这个[答案](https://stackoverflow.com/questions/7926455/access-codeigniter-session-values-from-external-files)。

# android - 如何在 Android 应用程序中使用基于选项卡的布局打开 url？

> ID：12902811
> 
> 赞同：0
> 
> 时间：2012-10-15T19:39:51.890
> 
> 标签：android, android-layout, android-webview

我正在开发具有 3 个选项卡的 Android 应用程序。

1.  在第一个选项卡上，我想显示带有一些信息的网页 (HTML/XML) 内容。

2.  当用户单击另一个选项卡时，它应该打开一个 url 而不会在同一窗口中显示地址栏。

任何供参考的输入/示例都会有所帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T22:31:32.870

[http://developer.android.com/reference/android/webkit/WebView.html](http://developer.android.com/reference/android/webkit/WebView.html)

# java - 在方法 onRegistered 和 onUnregistered 中从 GCMIntentService 更新 TextView

> ID：12902820
> 
> 赞同：0
> 
> 时间：2012-10-15T19:40:42.133
> 
> 标签：java, android, google-cloud-messaging

我想使用我实现的 GCMIntentService 类中的 onRegistered 和 onUnregistered 方法在 MainActivity 中设置 TextView 的文本。我不能直接设置它，因为它在不同的类中。处理这个问题的最佳方法是什么？

一点背景。我正在使用 TextView 来更新设备是否已注册的状态并向用户显示消息。我想在 GCMIntentService 中设置它的原因是因为一旦部署了这些方法，设备就完成了任务。现在当用户点击注册按钮时，它会将状态切换为已注册，但设备尚未完全注册。我不想因为他们认为设备已注册而引起混淆或错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:56:11.580

查看 GCM 示例应用程序。这样做的方法是：

在您从 GCMBaseIntentService 扩展的 GCMIntentService 中，在 onRegistered/onUnregistered 中，您可以发送广播消息（在示例中为 DISPLAY_MESSAGE_ACTION）。您只需要将注册状态放入意图中，例如“REGISTRATION_STATE”。在您的 MainActivity 中，您需要注册一个 BroadcastReceiver 并查找此消息，例如：

```
private final BroadcastReceiver mHandleMessageReceiver =
        new BroadcastReceiver() {
    @Override
    public void onReceive(Context context, Intent intent) {
        mTextView.setText("Registration state is: " + intent.getExtras().getString("REGISTRATION_STATE");
    }
}; 
```

# c# - 屏幕闪烁问题

> ID：12902821
> 
> 赞同：3
> 
> 时间：2012-10-15T19:40:42.783
> 
> 标签：c#, winforms

我遇到了一个问题，即某些计算机（很少）在使用我们的应用程序时开始闪烁。我在我们的应用程序的主要形式中发现了一些奇怪的代码：

```
 protected override CreateParams CreateParams
    {
        get
        {                
            var cp = base.CreateParams;
            cp.ExStyle |= 0x02000000;//composite window. Composite windows do not render/flickr when controls are born.  This speeds up loading.
            return cp;
        }
    } 
```

该代码似乎来自他们警告的在线[资源：](http://migrantfleet.net/how-to/how-to-avoid-flickering-windows-forms-controls)

> 但是，您应该知道这样一个事实，即这只适用于所有控制绘制（在层次结构内）都在 WM_PAINT 内完成的环境。使用其他/异步方式呈现到层次结构中的控件的应用程序可能会在此解决方案中遇到问题，从而导致不需要的行为。

WM_PAINT 到底是什么？它们是否意味着所有控件都需要通过 win32 API 调用进行绘制，或者这是否通常在 Load 事件中发生？

有一条注释说添加了代码是为了减少有关闪烁的错误报告……我只是想知道他们是否将婴儿和洗澡水一起扔了出去。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-02T22:20:53.360

尝试使用`DoubleBuffered = true;`

# ember.js - 为什么我的 {{#each}} 不工作？

> ID：12902825
> 
> 赞同：0
> 
> 时间：2012-10-15T19:40:56.103
> 
> 标签：ember.js

为什么我链接的 Ember Snippet 不起作用？我正在设置一个简单的 ArrayController 并在初始化时用内容填充它。然后我想在 {{#each}} 的帮助下显示这个控制器的内容，但这不起作用。

在我通读的教程中，总是使用以下结构：

```
{{#each  AppNamespace.myModelController}}
...
{{each}} 
```

但是为了使我的示例工作，我必须使用：

```
{{#each  AppNamespace.myModelController.content}}
...
{{/each}} 
```

你能看看提供的小提琴并告诉我它有什么问题吗？我认为我一定做错了什么，因为我在教程中经常看到这种模式。

注意：我是来自 Java Server Development 的 Javascript 初学者。所以这可能是我正在努力解决的简单 JS 基础知识。

我会在这里发布完整的代码，但格式无法正常工作。

[链接到我的 JS Fiddle 显示我的问题](http://jsfiddle.net/ZH75S/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T20:42:34.460

`this._super()`在您的 init 方法中添加一个调用。

[https://github.com/emberjs/ember.js/pull/1251](https://github.com/emberjs/ember.js/pull/1251)

此外，与您的问题没有直接关系，但看起来您会从阅读 #6 中受益：http: [//codebrief.com/2012/03/eight-ember-dot-js-gotchas-with-workarounds/](http://codebrief.com/2012/03/eight-ember-dot-js-gotchas-with-workarounds/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T19:41:47.430

尝试使用[http://cloud.github.com/downloads/emberjs/ember.js/ember-0.9.6.min.js](http://cloud.github.com/downloads/emberjs/ember.js/ember-0.9.6.min.js)而不是 1.0 pre 你的小提琴在这两种情况下都可以正常工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-15T22:26:30.767

我开始自己研究 Ember，我担心你正在使用的过程。

据我所知，您不应该真的像那样直接从控制器中检索数据。您使用的模式应该基于模型、控制器、视图和路由器。

[http://trek.github.com/](http://trek.github.com/)是我在学习 Ember 时发现的有用资源。

基于该示例，这将是我对小型 ember 测试应用程序的看法：

[http://jsfiddle.net/zDfBv/](http://jsfiddle.net/zDfBv/)

希望这对您有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-15T23:01:54.910

如果您将 1 个参数传递给 #each 帮助器，则它必须是 Ember.Array 兼容对象——在您的第一个示例中，当您的数据位于 content 属性中时您传递控制器。您的第二个示例有效，因为您传递了 content 属性..如果您愿意，那么这样做并没有错。

但是，您可能会更经常看到 #each 帮助器的另一种语法，它使用元素命名`{{#each model in myModelController}}`... `{{/each}}`。当您这样做时，Ember 会为您查找内容属性，因为它是视图的默认呈现上下文。

假设您使用的是 Github 的最新版本，您会发现它在两种情况下都可以查找内容，因此一旦发布为稳定版本，这一点就变得没有意义了。

# haskell - 在 windows 7 上使用 cygwin 安装 Cabal-dev

> ID：12902826
> 
> 赞同：4
> 
> 时间：2012-10-15T19:41:03.387
> 
> 标签：haskell, cygwin, cabal, yesod

我正在尝试这样做：

```
cabal install cabal-dev 
```

我安装了最新的 haskell 平台，并且 cygwin 我的路径。

我做到了这一点：

```
Resolving dependencies...
Downloading network-2.3.2.0...
Configuring network-2.3.2.0... 
```

然后最终我得到一个 sh.exe.stackdump

```
Stack trace:

Frame     Function  Args
00289218  6102F97B  (00289218, 00000000, 00000000, 00000000)
00289508  6102F97B  (6119FE20, 00008000, 00000000, 611A1C8F)
0028A538  6100652C  (611DC6AC, 0028A564, 765A1148, 000002B4)
0028A558  61006568  (611DC6AC, 611DC75D, 00000000, 00000000)
0028A598  61076E70  (61203020, 00000000, 00000000, 00000000)
0028A5D8  61077007  (0028A600, 0028A5E0, 00000000, 00000000)
0028A768  61078179  (00000000, 00000000, 00000000, 00000000)
End of stack trace 
```

进程资源管理器告诉我这正在尝试运行：

```
"sh" "configure" "--with-compiler=ghc" "--prefix=C:\Users\Adam\AppData\Roaming\cabal" "--with-gcc=C:\Program Files (x86)\Haskell Platform\2012.2.0.0\mingw\bin\gcc.exe" 
```

从这里：

```
C:\Users\XXX\AppData\Local\Temp\network-2.3.2.0-7028\network-2.3.2.0\ 
```

**我如何安装这个？**

它试过了

```
runghc Setup.hs configure 
```

来自 network-2.3.2.0 文件夹以及相同的结果。

***更新：***

我得到它安装（谢谢！）

```
cabal install --constraint="network installed" cabal-dev 
```

但我不知道如何使用它。

```
> cabal-dev install && yesod
cabal-dev is not recognized as an internal or external command 
```

我正在尝试完成[YESOD 的本教程](http://yannesposito.com/Scratch/en/blog/Yesod-tutorial-for-newbies/)，但并没有走得太远

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T20:30:54.587

正如评论所指出的，您不应重新安装`network`，而应强制`cabal-dev`使用当前`network`软件包进行安装。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-08T05:42:02.497

我通过 Git Bash（这是一个 MINGW32 shell）将它安装在沙箱中，使用：

```
cabal install network --configure-option --build=i386-unknown-mingw32 --configure-option --host=i686-pc-mingw32 
```

当然，`--enable-shared`如果您想启用动态链接，您可以添加。

# java - JPA 合并导致外国实体重复输入

> ID：12902827
> 
> 赞同：0
> 
> 时间：2012-10-15T19:41:05.433
> 
> 标签：java, jpa, merge

问题：

有谁知道如何在不`EntityManager`尝试重新插入外国实体的情况下合并？

设想：

只是为了设置一个与我的情况非常匹配的场景：我有两个实体

```
@Entity
@Table(name = "login", catalog = "friends", uniqueConstraints =
@UniqueConstraint(columnNames = "username"))
public class Login implements java.io.Serializable{

   private static final long serialVersionUID = 1L;
   @Id
   @GeneratedValue(strategy = IDENTITY)
   @Column(name = "id", unique = true, nullable = false)
   private Integer id;
   @Column(name = "username", unique = true, nullable = false, length = 50)
   private String username;
   @Column(name = "password", nullable = false, length = 250)
   private String password;
}

@Entity
@Table(name = "friendshiptype", catalog = "friends")
public class FriendshipType implements java.io.Serializable{

   private static final long serialVersionUID = 1L;
   @Id
   @GeneratedValue(strategy = IDENTITY)
   @Column(name = "id", unique = true, nullable = false)
   private Integer id;
   @OneToOne(fetch = FetchType.LAZY)
   @JoinColumn(name = "username")
   private Login login;
      @Column(name = "type", unique = true, length = 32)
   private String type;
   ...//other fields go here
} 
```

`Login`实体和实体都`FriendshipType`分别持久化到数据库中。然后，稍后，我需要将`Login`一行与`FriendshipType`一行合并。当我打电话时`entityManager.merge(friendship)`，它会尝试插入一个新`Login`的，这当然会导致以下错误

```
Internal Exception: com.mysql.jdbc.exceptions.jdbc4.MySQLIntegrityConstraintViolationException: Duplicate entry 'myUserName1350319637687' for key 'username'
Error Code: 1062
Call: INSERT INTO friends.login (password, username) VALUES (?, ?) 
```

我的问题是，如何在没有 enityManager 尝试重新插入外来对象的情况下合并两个对象？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-15T22:14:06.650

这是我解决问题的方法。我终于明白了合并没有解决的原因是因为 login.id 是由 JPA 自动生成的。因此，由于我真的不需要自动生成的 id 字段，因此我将其从架构中删除并`username`用作`@id`字段：

```
@Entity
@Table(name = "login", catalog = "friends", uniqueConstraints =
@UniqueConstraint(columnNames = "username"))
public class Login implements java.io.Serializable{

   private static final long serialVersionUID = 1L;
   @Id
   @Column(name = "username", unique = true, nullable = false, length = 50)
   private String username;
   @Column(name = "password", nullable = false, length = 250)
   private String password;
} 
```

我想到的另一个解决方案，我没有实施，但可能会帮助其他人，如果他们需要有一个自动生成的 id 字段。

不是`Login`为合并创建一个实例，而是从数据库中获取实例。我的意思是，而不是

```
Login login = new Login(); login.setUsername(username); login.setPassword(password); 
```

宁愿

```
Login login = loginDao.getByUsername(username); 
```

这样，不会生成新的 id 字段，从而使实体看起来不同。

感谢大家的帮助并为大家投票，尤其是@mijer 的耐心。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-15T21:41:38.053

您可以使您的`@JoinColumn`不可更新：

```
@JoinColumn(name = "login_id", updatable = false) // or
@JoinColumn(name = "username", referencedColumnName = "username", updatable= false) 
```

`Login`或者在合并之前尝试再次刷新/获取您的实体`FriendshipType`：

```
// either this
entityManager.refresh(friendship.getLogin());
// or this
final Login login = entityManager
          .getReference(Login.class, friendship.getLogin().getId());
friendship.setLogin(login);
// and then
entityManager.merge(friendship); 
```

但是，正如其他人所建议的那样，我相信这`FriendshipType`会更好地由`@ManyToOne`关系或[Embeddable](http://en.wikibooks.org/wiki/Java_Persistence/Embeddables)或[ElementCollection来表示](http://en.wikibooks.org/wiki/Java_Persistence/ElementCollection)

* * *

***更新***

另一种选择是更改拥有方：

```
public class Login implements java.io.Serializable {
    @OneToOne(fetch = FetchType.LAZY) 
    @JoinColumn(name = "friendshiptype_id")
    private FriendshipType friendshipType;
    // Other stuff 
}

public class FriendshipType implements java.io.Serializable {
    @OneToOne(fetch=FetchType.LAZY, mappedBy="friendshipType")
    private Login login;
    // Other stuff 
} 
```

这将影响您的数据模型（登录表将有一个`friendshiptype_id`列，而不是相反），但会防止您遇到错误，因为关系始终由拥有方维护。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-15T20:31:46.393

你试过`cascade=MERGE`吗？IE

```
@OneToOne(fetch = FetchType.LAZY, cascade=CascadeType.MERGE)
@JoinColumn(name = "username")
private Login login; 
```

**更新**

另一种可能的选择是使用`@ManyToOne`（它保存为关联是唯一的）

```
@ManyToOne(fetch = FetchType.LAZY, cascade=CascadeType.MERGE)
@JoinColumn(name = "username")
private Login login; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-16T02:20:20.350

您可以使用原始的 @Id 设置来完成。IE

```
 @Id
 @GeneratedValue(strategy = IDENTITY)
 @Column(name = "id", unique = true, nullable = false)
 private Integer id; 
```

可以，但无需更改为：

```
 @Id
 @Column(name = "username", unique = true, nullable = false, length = 50)
 private String username; 
```

诀窍是您必须首先通过 em.find(...) 或 em.createQuery(...) 从 DB 加载。然后保证用数据库中的正确值填充 id。

然后，您可以通过结束事务（对于会话 bean 中的事务范围实体管理器），或通过调用 em.detach(ent) 或 em.clear()，或通过序列化实体并将其传递给网络。

然后您可以一直更新实体，同时保持原始 id 值。

然后你可以调用 em.merge(ent) 并且你仍然有正确的 id。但是，我相信该实体此时必须已经预先存在于实体管理器的持久上下文中，否则它会认为您有一个新实体（具有手动填充的 id），并尝试在事务刷新/提交时插入。

所以第二个技巧是确保实体在合并点加载（再次通过 em.find(...) 或 em.query(...) ，如果你有一个新的持久上下文而不是原始上下文） .

:-)

# mysql - MySQL系统数据库表可以转换成InnoDB吗？

> ID：12902829
> 
> 赞同：5
> 
> 时间：2012-10-15T19:41:08.840
> 
> 标签：mysql, innodb, myisam, mariadb

我最近安装了 MySQL 5.5。我正在`InnoDB`用作我所有数据库的引擎。我注意到`mysql`数据库默认值及其所有表（用户、数据库等）都是 `MyISAM`. 他们不能/不应该有什么理由`InnoDB`吗？有谁知道MySQL是否需要`mysql`数据库`MyISAM`？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-15T19:49:56.163

警告 不要将 mysql 数据库中的 MySQL 系统表从 MyISAM 转换为 InnoDB 表！这是不受支持的操作。如果这样做，MySQL 不会重新启动，直到您从备份中恢复旧系统表或使用 mysql_install_db 脚本重新生成它们。

[http://dev.mysql.com/doc/refman/5.0/en/innodb-restrictions.html](http://dev.mysql.com/doc/refman/5.0/en/innodb-restrictions.html)

# javascript - 是否有一个 JavaScript 物理库可以处理 HTML 元素（例如 div）而不是画布？

> ID：12902831
> 
> 赞同：10
> 
> 时间：2012-10-15T19:41:13.270
> 
> 标签：javascript, html, physics, game-physics

![玩家堆栈](../Images/099ad4bf9929bd64347a8b130eccbf54.png)

我正在为一个游戏开发一个简单的堆栈，在该游戏中玩家移动编号的棋子以跟踪他们距离完成收集获胜手的棋子有多近。

目前我使用了 jQuery UI 的可拖动和可放置。这有助于轻松开始，但一次只能移动一件：[http](http://cssdeck.com/labs/cowmmudd/4) ://cssdeck.com/labs/cowmmudd/4 。

*   我想将移动部件外包给一个真正的 JavaScript 物理库，而不是使用 jQuery UI。（因此，当一个人将上排的蓝色 4 一直向左移动时，它会将该行上的所有棋子强制在一起。）
*   我想继续使用普通的 HTML 元素来表示我的作品，因为这些元素更容易设计和推理。（我已经看过使用的所有 Javascript 物理库，`canvas`但我想实现与 Google 曾经相同的功能：http: [//mrdoob.com/projects/chromeexperiments/google-gravity/](http://mrdoob.com/projects/chromeexperiments/google-gravity/)）

有人可以提供一个使用他们所知道的最好的 JavaScript 物理库来控制普通、非画布 HTML 元素的放置和碰撞的简约示例吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-15T23:32:44.760

到目前为止我发现的最简单的例子：http: [//bl.ocks.org/3411189](http://bl.ocks.org/3411189)

**更新：**对我的作品的简单改编：http: [//cssdeck.com/labs/fe3z2cfx/6](http://cssdeck.com/labs/fe3z2cfx/6)

# smtp - SMTP 优于普通 SES 的 Amazon SES 优势

> ID：12902832
> 
> 赞同：0
> 
> 时间：2012-10-15T19:41:15.987
> 
> 标签：smtp, throttling, amazon-ses

有谁知道使用 Amazon SES SMTP 选项与普通 SES 相比是否有任何优势？

我们超出了我们的限制，我想使用一个包含限制的第三方包，但他们只支持普通 SES。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T02:19:18.473

不是性能优势，但如果您将电子邮件发件人设计为使用 SMTP 接口，如果 SES 不适合您，您可以通过更改目标服务器/端口轻松切换到另一个发送服务。

# android - 从android活动将日期存储在sql数据库中

> ID：12902834
> 
> 赞同：1
> 
> 时间：2012-10-15T19:41:18.997
> 
> 标签：android, mysql, datepicker

我正在使用这种方法使用 datepickerin android 在 textview(mDateDisplay) 中设置日期（日期选择器的格式为“jan-09-2001”）

```
private void updateDisplay() {
        this.mDateDisplay.setText(
            new StringBuilder()
                    // Month is 0 based so add 1
                    .append(mMonth + 1).append("-")
                    .append(mDay).append("-")
                    .append(mYear).append(" "));} 
```

现在我已将 textview(mDateDisplay) 的内容转换为将其存储在 mysql 数据库中 String DateA= mDateDisplay.getText().toString();

```
// Building Parameters
params.add(new BasicNameValuePair("AvlDate",DateA));

and in the php file:
$dd=$_POST['AvlDate'];
$AvlDate =date('y-m-d',strtotime($dd); 
```

但这总是在数据库中存储 1970-01-01 .. 我如何存储正确的结果

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T19:45:59.853

利用

```
private void updateDisplay() {
    this.mDateDisplay.setText(
        new StringBuilder()
                // Month is 0 based so add 1
                .append(mYear).append("-")
                .append(mMonth+1).append("-")
                .append(mDay).append(" "));} 
```

您正在设置日期，`m-d-y`但正在阅读`y-m-d`

# xml - 如何将永久链接添加到 Jekyll RSS 提要？

> ID：12902840
> 
> 赞同：1
> 
> 时间：2012-10-15T19:41:59.037
> 
> 标签：xml, rss, jekyll

我的 Jekyll RSS 提要中的一些帖子是链接帖子（点击标题后，他们会将读者转发到外部源 URL）。我`{% if post.link %}`在`feed.xml`.

**我想要的是**在 RSS 提要的链接帖子底部显示一个*“∞ 永久链接” 。*

**我的问题：**有没有办法在 feed.xml 文件中每个链接帖子的底部显示一个永久链接？

作为一种解决方法，我可以在帖子内容区域的底部设置一个额外的永久链接，但它也会显示在帖子本身中，所以我很想知道是否有更直接的方法。

更新：我尝试像这样设置一个单独的永久链接：

```
<a title="Permalink" class="permalink" href="{{ site.domain }}{{ page.url }}">∞ Permalink</a> 
```

如果我将链接放在实际`2012-10-18-example-post.md`文件的底部，它可以工作，但是当我将它放在**模板**中时，它无法显示在 RSS 提要阅读器中，参见：

```
...

  {{ content }}

 <a title="Permalink" class="permalink" href="{{ site.domain }}{{ post.url }}">∞ Permalink</a> 
```

有人知道如何将链接附加到内容标签吗？

这是我的 feed.xml - 如果有帮助：

```
---
layout: none
---
<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>{{ site.name }}</title>
    <description>{{ site.description }}</description>
    <link>{{ site.url }}</link>
    <atom:link href="{{ site.url }}/feed.links.xml" rel="self" type="application/rss+xml" />
    {% for post in site.posts limit:30 %}
      {% if post.link %}
      <item>
        <title>Link:{{ post.title }}</title>
        <description>{{ post.content | xml_escape }}</description>
        <pubDate>{{ post.date | date: "%a, %d %b %Y %H:%M:%S %z" }}</pubDate>
        <link>{{ post.link | escape }}</link>
        <guid isPermaLink="true">{{ post.link }}</guid>
      </item>

      {% else %}

      {% unless post.link %}
      <item>
        <title>{{ post.title }}</title>
        <description>{{ post.content | xml_escape }}</description>
        <pubDate>{{ post.date | date: "%a, %d %b %Y %H:%M:%S %z" }}</pubDate>
        <link>{{ site.url }}{{ post.url }}</link>
        <guid isPermaLink="true">{{ site.url }}{{ post.url }}</guid>
      </item>
      {% endunless %}

      {% endif %}

    {% endfor %}
  </channel>
</rss> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T23:24:56.493

将其添加到您的 rss 文件中的适当`<description>`标签中。不要忘记这是一个包含 HTML 的 XML 文档，因此您必须对 HTML 内容进行 XML 转义：

```
<description>
    {{ post.content | xml_escape }}
    &lt;a title=&quot;Permalink&quot; class=&quot;permalink&quot; href=&quot;{{ site.domain | xml_escape }}{{ post.url | xml_escape }}&quot;&gt;
        ∞ Permalink
    &lt;/a&gt;
</description> 
```

# properties - 如何通过其编号引用命令行中提供的属性？

> ID：12902842
> 
> 赞同：2
> 
> 时间：2012-10-15T19:42:04.837
> 
> 标签：properties, jmeter

我想知道如何引用命令行中提供的特定属性。例如属性编号 1、编号 2、编号 3。不使用属性名称。

显然我用`__Property`函数来引用

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T20:20:06.067

您可以[`JMeterUtils.getJMeterProperties()`](http://jmeter.apache.org/api/org/apache/jmeter/util/JMeterUtils.html#getJMeterProperties%28%29)在 Beanshell 中访问。它将返回 java.util.Properties 然后你就可以使用它了。

你不能通过`__Property`函数来​​做到这一点

# dynamic - 具有动态字段的文档上的 RavenDB 静态索引

> ID：12902848
> 
> 赞同：1
> 
> 时间：2012-10-15T19:42:29.783
> 
> 标签：dynamic, indexing, ravendb

我正在尝试为以下示例类创建一个静态索引：

```
public class Board {
...other assorted fields
List<dynamic> Messages {get; set;}
internal Board() {Messages = new List<dynamic>();}
} 
```

该索引用于过滤具有早于某个日期的消息的板。目的是对今天到期的消息执行“更新”操作，更新它们的内容，并将它们持久化。需要该索引以避免遍历所有客户端的板的所有消息，因为这可能在计算上很昂贵。Messages 是从包含 ExpiryDate 属性的基类继承的消息类型列表。

尝试创建如下索引会导致“表达式树可能不包含动态操作”错误。我知道动态类型不能很好地与 Linq 查询配合使用，因此需要在 RavenDB 中使用 LuceneQueries 而不是 Query()。有没有办法让这个索引与动态属性一起工作？谢谢！

```
 public class ScanBoardMessagesIndex : AbstractIndexCreationTask<Board>
  {
    public ScanBoardMessagesIndex () {
      Map = boards => from board in boards
                     where board.Messages.Any(msg => ((MessageItem) msg).ExpiryDate <= DateTime.UtcNow.Date)
                     select board;
    }
  } 
```

编辑：

我遇到了 raven 序列化问题，因为现有 Board 文档的元数据 clr 类型被设置为不再有效的类命名空间。我正在做一个迁移项目，所以我继续并首先发布了一个补丁来更改现有文档的元数据 clr 类型，然后再将它们迁移到使用基/抽象类作为消息列表而不是类型动态的新数据结构。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T22:19:49.470

Map/Reduce 索引似乎更适合给定的要求。实际上，您希望能够按板中消息的最早到期日期查询板。这是一个聚合操作，正是 Map/Reduce 旨在解决的问题。此外，使用消息的基类将允许您定义索引，而无需求助于较低级别的[IndexDefinition](http://ravendb.net/docs/client-api/querying/static-indexes/defining-static-index)：

```
public class Message
{
    public DateTime ExpiryDate { get; set; }
}

public class Board
{
    public string Id { get; set; }
    public List<Message> Messages { get; set; }
}

public class OldestExpiryDateMessageInBoard : AbstractIndexCreationTask<Board, OldestExpiryDateMessageInBoard.Result>
{
    class Result
    {
        public string BoardId { get; set; }
        public DateTime OldestExpiryDate { get; set; }
    }

    public OldestExpiryDateMessageInBoard()
    {
        this.Map = boards => from board in boards
                             from message in board.Messages
                             select new
                             {
                                 BoardId = board.Id,
                                 OldestExpiryDate = message.ExpiryDate
                             };

        this.Reduce = results => from result in results
                                 group result by result.BoardId into g
                                 select new
                                 {
                                     BoardId = g.Key,
                                     OldestExpiryDate = g.Min(x => x.OldestExpiryDate)
                                 };
    }
} 
```

然后，您可以使用 Lucene 语法查询此索引。

# sql - 执行附加连接时，计数 (*) 是否会扭曲所需的结果？

> ID：12902852
> 
> 赞同：2
> 
> 时间：2012-10-15T19:42:38.727
> 
> 标签：sql, sql-server, sql-server-2008, tsql

我的查询工作正常；但是，我需要将另一个数据集加入到我的查询中，并且我希望它`count(f.*)`会中断。

这是我开始的查询：

```
SELECT
       MIN(received_date) AS FirstVisit
     , patient_id         AS PatientID
INTO #LookupTable
FROM F_ACCESSION_DAILY

SELECT 
       f.doctor           AS Doctor
     , COUNT(f.*)         AS CountNewPatients
     , MONTH(firstvisit)  AS Month
     , YEAR(firstvisit)   AS Year
FROM F_ACCESSION_DAILY f 
INNER JOIN #LookupTable l ON f.received_date = l.FirstVisit 
                         AND f.patient_id = l.PatientID
GROUP BY f.doctor
       , MONTH(firstvisit)
       , YEAR(firstvisit)

DROP TABLE #LookupTable 
```

我想在另一个表上加入上述查询。

问题是****我会`count(f.*)`保持不变还是会因为我添加了新数据集而改变？****

* ***如何确保`count(f.*)`遗嘱保持不变？**

非常感谢您的指导。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-15T19:48:28.957

> 我会`count(f.*)`保持不变还是会因为我添加了新数据集而改变？*

`COUNT(*)`计算行数。如果你加入另一个表并且行数增加，结果`COUNT(*)`将会增加。

> 我如何确保`count(f.*)`遗嘱保持不变？

使用`COUNT (DISTINCT f.Id)`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T19:48:23.683

如果新表中每个 Patient_id 正好有 1 行（并且您正在执行 INNER JOIN），那么计数不会改变。否则，它会。

您可以使用 OUTER APPLY (SELECT TOP 1 ....) 而不是 JOIN 来保证计数不会改变。

顺便说一句，您的第一个 SELECT 中似乎缺少 GROUP BY Patient_id。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-15T19:49:07.570

联接不会“倾斜” `COUNT(*)`. 计数完全按照它的广告宣传。问题是您可能会增加行数，而没有真正意识到这一点。

解决问题的一种方法是在适当的级别进行聚合。有时，您必须这样做——例如，当涉及 SUM 和 AVG 时。

但是，对于计数，您可以将其替换为：

```
count(distinct AccessionDailyID) 
```

即使行数成倍增加，这也可以计算您的数量。顺便说一句，这假设您的表的每一行都有一个唯一的 id。

顺便说一句，您可能希望确保使用`LEFT OUTER JOIN`而不是`INNER JOIN`确保在加入过程中不会丢失任何行。

# jquery - submit 删除 IE 中的输入文件值

> ID：12902855
> 
> 赞同：2
> 
> 时间：2012-10-15T19:42:56.547
> 
> 标签：jquery, internet-explorer

我正在尝试使用 jquery 在输入文件中触发单击。一切正常，直到我按下提交按钮，然后输入值被删除并取消提交事件。像往常一样，这仅在 IE8/IE9 中发生（firefox/chrome 有效）

这是代码：http: [//jsbin.com/iqeyom/1](http://jsbin.com/iqeyom/1)

我为什么要这样做？因为我隐藏了输入文件并通过链接触发了文件选择窗口。在给定的链接中，不只是为了显示目的而隐藏。有什么线索吗？提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T20:06:27.313

您是否尝试过类似的方法：

```
$('#upload').click(function(){
  $('#form_file').trigger('submit');
  //do whatever you need...
}); 
```

# java - 我的世界启动器登录代码

> ID：12902856
> 
> 赞同：0
> 
> 时间：2012-10-15T19:42:58.393
> 
> 标签：java, visual-studio, login, batch-file, minecraft

我不知道这是否是问这个问题的正确网站（我也在论坛中问过），但我从头开始创建了一个 Minecraft 启动器（不是使用 Java）。一切正常，我可以启动 Minecraft，但它每次都以离线模式启动。我使用批处理代码在 .minecraft-Folder 中启动 minecraft.jar。我知道有一种方法可以使用 Minecraft-Launcher 的参数启动 Minecraft，但那样我就无法更改 Minecraft-Directory（从`.minecraft`到`.minecraft2`）。有什么方法可以连接到 Minecraft.net 并使用批处理或 Visual Basic 登录和启动 Minecraft？太感谢了！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-15T20:05:15.117

您可以通过在运行启动器之前设置 APPDATA 环境变量来更改 Minecraft 查找其数据文件夹的位置。您可以使用这样的批处理脚本来执行此操作：

```
set APPDATA="C:\Users\You\Desktop\Some\Folder"
javaw -jar "C:\Path\To\Minecraft.exe" 
```

请记住，Minecraft.exe 秘密地只是一个包装好的 jar 文件，它作为 EXE 的目的是用 java 运行它自己。

您可以通过将第二行更改为如下内容将参数传递给它以选择用户名和密码：

```
javaw -jar "C:\Path\To\Minecraft.exe" DigitalClark hunter2 
```

或者，如果您真的喜欢，您可以通过[直接查询登录 API](https://login.minecraft.net/?user=DigitalClark&password=hunter2&version=13)、从中解析您的会话 ID 和确切的用户名，然后直接启动 minecraft（绕过启动器）来获取您自己的会话密钥：

```
javaw -Djava.library.path=[path to natives folder] -cp minecraft.jar;lwjgl.jar;lwjgl-util.jar;jinput.jar net.minecraft.client.Minecraft [username] [sessionID] 
```

您可以为 minecraft jar 指定绝对路径，如果不这样做，它们必须是相对于工作目录的。要为 natives 目录指定相对路径，请使用类似`.\This\Folder\Relative\To\Working\Dir`

坦率地说，我不明白你为什么要打扰。只需使用魔法发射器或其他东西。

# python - Python mySQL - 转义引号

> ID：12902862
> 
> 赞同：15
> 
> 时间：2012-10-15T19:43:51.693
> 
> 标签：python, mysql, mysql-python

我在这个网站上看到过以各种方式提出的这个问题，但没有一个能完全解决我的问题。

我有一个带有单引号的 sql 语句，并且在使用它进行数据库查询之前尝试使用推荐的做法。所以声明就像

```
val2="abc 'dostuff'" 
sql="INSERT INTO TABLE_A(COL_A,COL_B) VALUES(%s,'%s')" %(val1, val2)
a_cursor.execute(sql) 
```

但是，当我运行它时，我得到..

```
ProgrammingError: (1064,"You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'dostuff'. 
```

我究竟做错了什么？非常感谢努普尔

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-10-15T19:50:16.783

使用参数而不是字符串插值来确保您的值被数据库连接器正确转义：

```
sql = "INSERT INTO TABLE_A(COL_A,COL_B) VALUES(%s, %s)"
a_cursor.execute(sql, (val1, val2)) 
```

mysqldb sql 参数样式使用与 python 字符串格式化运算符相同的语法，这有点令人困惑。

# gtk - gtk2 和 gtk3：如何将样式应用到默认按钮上？

> ID：12902863
> 
> 赞同：1
> 
> 时间：2012-10-15T19:43:53.240
> 
> 标签：gtk, themes

在 gtk2 ( *.rc) 和 GTk3 (* .css) 中，如何为对话框中的默认按钮设置主题？

（按回车时将激活的那个）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-24T12:25:47.123

在 Lubuntu 12.10 中，默认主题 (/usr/share/themes/Lubuntu-default) 在 gtk-2.0 文件夹中有一个名为`button.rc`. 列出了五种“状态”：正常、预光照、不敏感、活动和聚焦。这是我的印象（有点摆弄），“焦点”状态代表您感兴趣的那个。换句话说，如果存在一个带有几个按钮的窗口，那么处于焦点状态的按钮将按回车键被“按下”或“点击”。

`lubuntu-logout`在 Lubuntu 12.10 中，当您从主菜单（或从终端运行）单击“注销”时出现的屏幕很好地说明了这一点。在出现的七个“按钮”中，最上面的一个“关机”按钮的阴影略有不同（或有一个对焦环），而其他六个按钮除了文字外彼此相似。点击“进入”而不做任何其他事情相当于点击“关机”按钮。我也想弄清楚如何使按钮成为焦点，如果我们这样称呼它，则更具*对比性*。

对于 gtk2 方面，如果您对使对焦环更明显（但更难看）感到满意，那么编辑主题`gtkrc`可能是一种方法。查找标题**样式“默认”**的部分，然后查找具有类似内容的行

`GtkWidget ::focus-line-width = 1`

更改`1`为`2`或`3`将使对焦环更加明显。

（我还没来得及看 gtk3 应用程序。）

# c# - 使用自定义get在实体框架中获取stackoverflow

> ID：12902864
> 
> 赞同：0
> 
> 时间：2012-10-15T19:43:54.777
> 
> 标签：c#, entity-framework, .net-3.5, edmx, database-first

我正在尝试将业务逻辑添加到我的数据库第一个实体框架应用程序中。我想将 address1 的长度限制为 35，并将其余部分移至地址。在数据库中的字段是地址 1 和地址 2，在我的 edmx 上是地址 1 和地址 2。我使用部分扩展了 edmx。但是当试图调用我的自定义 get 函数时，我得到一个异常，说当前线程在 stackoverflow 中。

```
 public partial class EmployeeWithAddress
    {
        public string Address1
        {
            get
            {
                var employee = Common.LimitAddressFieldTo35(this);
                address1 = employee.Address1;
                address2 = employee.Address2;
                return address1;
            }
            set { address1 = value; }
        }

        public string Address2 { get; set; }
    }

static public EmployeeWithAddress LimitAddressFieldTo35(EmployeeWithAddress employee)
        {
            var ee = employee;  
            if (ee.Address1.Length > 35)
            {
                var address = ee.Address1;
                ee.Address1 = address.Substring(0, 35).Trim();
                ee.Address2 =
                    string.Concat(address.Substring(35, address.Length - 35) + " ", employee.Address2).Trim();
            }

            return ee;
        } 
```

调用 LimitAddressFieldTo35 时发生异常。我正在使用 .net 3.5 中包含的实体框架版本

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-15T19:48:40.063

这将无限递归

```
Address1 { get { ... address1 = employee.Address1; ...} } 
```

# sql-server - 将 WHERE 子句添加到 SQL Server 查询面板

> ID：12902869
> 
> 赞同：0
> 
> 时间：2012-10-15T19:44:21.830
> 
> 标签：sql-server

我在服务器资源管理器中，在表名上，我右键单击“选择前 1000 行”。查询面板显示生成的 SQL 为

```
SELECT TOP 1000 [...] ,[....] , [....]
FROM [filename].[dbo].[TableName] 
```

现在我想添加一个简单的 WHERE 子句。

我尝试像这样添加它：

```
WHERE [ColumnName] == 11 
```

它不工作。我知道这是一个非常基本的问题，但我没有太多直接使用 SQL Server 的经验。

如何修复 WHERE 子句？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T19:47:07.537

你不需要双 == 符号 SQL 术语是只使用一个 =

从你的例子：

```
SELECT TOP 1000 [...] ,[....] , [....]
FROM [filename].[dbo].[TableName]
WHERE [ColumnName] = 11 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T16:35:12.040

C# 使用双等号（“==”）进行条件检查，在 sql 中，单“=”用于谓词。

# bash - 对多种文件类型使用 `find` 并替换找到的文件中的字符串

> ID：12902873
> 
> 赞同：3
> 
> 时间：2012-10-15T19:44:46.400
> 
> 标签：bash, recursion, sed, find

我正在尝试递归查找多种类型的文件，并在找到的每个文件中替换某个字符串。但是当我运行脚本时，它只找到一种类型的文件。

我正在使用的命令行是这样的

```
find . -name '*.tcl' -o -name '*.itcl' -o -name '*.db' -exec sed -i 's/abc/cba/g' {} + 
```

每次我运行上面的命令时，它只会找到类型为`.db`. 当我使用单一文件类型运行它时，它工作正常。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-15T19:48:23.030

您需要像这样对`-names *`部分进行分组`()`：

此外，最好（根据我的经验）`sed -i`只在与模式匹配的文件上运行，所以：

```
find . \( -name '*.tcl' -o -name '*.itcl' -o -name '*.db' \) -exec sed -i '/abc/s/abc/cba/g' {} + 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T06:04:53.410

下面的命令将搜索 txt 或日志文件，并将源字符串替换为目标字符串。

```
 find . -name "*.txt" -o -name "*.log"|xargs perl -pe 's/source/target/g' 
```

您可以通过在 perl 语句中添加 -i 来进行替换，如下所示：

```
find . -name "*.txt" -o -name "*.log"|xargs perl -pi -e 's/source/target/g' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-05T20:51:07.583

你可以做：

```
find . -regex ".*\.\(tcl\|itcl\|db\)" -exec sed -i 's/abc/cba/g' {} + 
```

这更紧凑，您不必弄乱 OR 和对逻辑操作进行分组。

# objective-c - 崩溃的线程是 iOS 崩溃报告中唯一重要的线程吗？

> ID：12902876
> 
> 赞同：1
> 
> 时间：2012-10-15T19:44:52.740
> 
> 标签：objective-c, ios, crash-reports

在从 iTunes 获得的崩溃日志中，我无法理解要挖掘的线程信息。

它说线程 16 崩溃了。那么，我是否必须检查 [FreePlayMenuScene dealloc] 中的代码，还是有可能原因位于另一个线程中？例如，在线程 0 中提到了 NSDateFormatter，我不明白这是否相关。

作为一个通用问题来问这个问题，在阅读崩溃日志时，我们应该只检查崩溃的线程还是其他线程中也可能有有用的信息？不幸的是，我在这里或网上的任何地方都找不到类似的问题。

这是代码：

```
Exception Type:  EXC_BAD_ACCESS (SIGSEGV)
Exception Codes: KERN_INVALID_ADDRESS at 0x00000000
Crashed Thread:  16

Thread 0 name:  Dispatch queue: com.apple.main-thread
Thread 0:
0   libicucore.A.dylib              0x3333feac udat_close + 0
1   CoreFoundation                  0x37cd60d0 __CFDateFormatterDeallocate + 12
2   CoreFoundation                  0x37c513ce CFRelease + 290
3   Foundation                      0x354795ea -[NSDateFormatter _clearFormatter] + 22
4   Foundation                      0x354a4b44 -[NSDateFormatter dealloc] + 52
5   libobjc.A.dylib                 0x34b95484
6   CoreFoundation                  0x37c5343c _CFAutoreleasePoolPop + 12
7   Foundation                      0x35500978 __NSThreadPerformPerform + 600
8   CoreFoundation                  0x37ce5680         9   CoreFoundation                   0x37ce4ee4 __CFRunLoopDoSources0 + 208
10  CoreFoundation                  0x37ce3cb2 __CFRunLoopRun + 642
11  CoreFoundation                  0x37c56eb8 CFRunLoopRunSpecific + 352
12  CoreFoundation                  0x37c56d44 CFRunLoopRunInMode + 100
13  GraphicsServices                0x345592e6 GSEventRunModal + 70
14  UIKit                           0x345c32fc UIApplicationMain + 1116
15  AClockworkBrain                 0x0000365a main (main.m:13)
16  AClockworkBrain                 0x0000361c start + 36

...
...

Thread 16 Crashed:
0   AClockworkBrain                 0x001d7cd2 -[CCScheduler unscheduleAllSelectorsForTarget:] + 126
1   AClockworkBrain                 0x001ca8f8 -[CCNode unscheduleAllSelectors] + 48
2   AClockworkBrain                 0x001c9526 -[CCNode cleanup] + 38
3   AClockworkBrain                 0x001f1016 -[CCArray makeObjectsPerformSelector:] + 54
4   AClockworkBrain                 0x001c9550 -[CCNode cleanup] + 80
5   AClockworkBrain                 0x001f1016 -[CCArray makeObjectsPerformSelector:] + 54
6   AClockworkBrain                 0x001c9550 -[CCNode cleanup] + 80
7   AClockworkBrain                 0x001c9cf4 -[CCNode removeAllChildrenWithCleanup:] + 156
8   AClockworkBrain                 0x00078ecc -[FreePlayMenuScene dealloc] (FreePlayMenuScene.m:776)
9   Foundation                      0x35500e4c __NSFinalizeThreadData + 1004
10  CoreFoundation                  0x37ce0f7e __CFTSDFinalize + 62
11  libsystem_c.dylib               0x37ab9128 _pthread_tsd_cleanup + 172
12  libsystem_c.dylib               0x37ab8dfe _pthread_exit + 114
13  libsystem_c.dylib               0x37ad2160 pthread_exit + 24
14  Foundation                      0x35489226 +[NSThread exit] + 6
15  Foundation                      0x35500696 __NSThread__main__ + 998
16  libsystem_c.dylib               0x37ac630e _pthread_start + 306
17  libsystem_c.dylib               0x37ac61d4 thread_start + 4 
```

非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T19:53:20.207

好吧，永远不要说永远：总会有这样一种情况，一个线程执行某些操作会导致另一个线程抛出异常并崩溃。但是，当这种情况发生时，您通常会遇到某种时间问题或竞争条件，并且当崩溃发生时，麻烦制造线程总是在同一个地方是很少见的。在这些情况下，坏线程“设置了一个陷阱”，然后崩溃的线程被困在其中。

在您的情况下，我认为日期格式与它没有任何关系，除非您在多个线程上共享 NSDateFormatter （不要，它不是线程安全的）。

由于异常是 EXC_BAD_ACCESS （访问无效的内存地址）并且它发生在 中`[CCScheduler unscheduleAllSelectorsForTarget:]`，我的猜测是一个错误的指针潜伏在您的 Cocos2D 场景图中的某个地方。也许您添加了一个过度发布的节点？很难说。在这种情况下，不一定是另一个线程有问题，但看起来问题是由其他一些代码设置的，当这段代码偶然发现它时会导致问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-15T19:53:30.640

最重要的是实际崩溃的线程。但请记住，崩溃可能会受到当时其他线程中发生的事情的影响。但在大多数情况下，只有崩溃的线程是相关的。如果崩溃实际上与跨多个线程完成的事情有关，或者事情在多个线程中并且不应该是，我会担心其他线程。

在您发布的日志中，恰好在崩溃时，日期格式化程序正在主线程上被释放。可能与您的 FreePlayMenuScene 问题完全无关。

# android - 我应该什么时候关闭游标和数据库？

> ID：12902878
> 
> 赞同：4
> 
> 时间：2012-10-15T19:44:56.773
> 
> 标签：android, android-sqlite, android-cursor

我在自定义视图中以不同的方法多次使用相同的光标。每次使用后我应该关闭光标还是可以保持打开状态直到视图被破坏？数据库也是如此，是否可以在创建保存此视图的活动后打开它，并在销毁活动时关闭它？当我按照上述方式执行操作时，我不断收到错误“数据库上从未显式调用 close()...”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T20:01:08.803

> 每次使用后我应该关闭光标还是可以保持打开状态直到视图被破坏？

要看。如果游标结果不会同时改变（例如远程连接修改数据库），那么就可以了。不要忘记使用[`CursorLoader`](http://developer.android.com/reference/android/content/CursorLoader.html)让 Android 自动管理您的光标（例如，如果您的应用程序崩溃，请关闭光标）。

> 数据库也是如此，是否可以在创建保存此视图的活动后打开它，并在销毁活动时关闭它？

是的，您可以`onResume()`在回调中打开和关闭`onPause()`，或者当您知道您的数据库将不再被查询时。

> 当我按照上述方式执行操作时，我不断收到错误“数据库上从未显式调用 close()...”。

仅当您的应用程序崩溃时，这才是正常的。如果你像我上面说的那样做，就不应该发生。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T19:57:28.987

您可以尝试将您的数据库和光标代码移动到 onResume 和 onPause 以避免该错误。但我想一个更干净的方法是在你的 Activity 中实现[LoaderCallbacks](http://developer.android.com/reference/android/app/LoaderManager.LoaderCallbacks.html)。你考虑过吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-15T19:53:43.120

一旦不需要它们，您可能希望关闭与 DB 的所有连接。如果您以后需要它们，可以保持连接，即在要销毁 Activity 时关闭连接。

# objective-c - 如何在滚动视图中滚动

> ID：12902893
> 
> 赞同：0
> 
> 时间：2012-10-15T19:46:11.250
> 
> 标签：objective-c, ios, uiscrollview

我的滚动视图包含 4 个视图。以下是我滚动视图中的前三个 ![在此处输入图像描述](../Images/3ed6cbae4db983b9a7dad1114658d651.png)

**我的目标**：我想滚动，以便我的滚动视图将显示第二个+第三个+第四个视图（第一个视图将关闭）

**问题**：我该怎么做

现在当我滚动时，我得到

![在此处输入图像描述](../Images/45ed0cd3eb75b12f9bc2d1bbfbe96cc2.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T19:51:18.050

从外观上看，似乎您没有添加其他视图，或者您没有将它们添加到正确的位置。

为了让 UIScrollView 正常工作，您需要设置`contentSize`和`frame`属性并将子视图定位为就好像它是一张大地图一样。假设您要添加三个 200x200 视图，您可以将它们各自的框架属性设置为 (0, 0, 200, 200), (200, 0, 200, 200), (400, 0, 200, 200)，如果你希望他们并排。然后，您需要将`UIScrollView`'`contentSize`属性设置为 (600, 200) 才能使其滚动浏览所有内容。

如果这不是您要查找的内容，请澄清您的问题。

# java - 在 android 应用上显示图像的另一种方法

> ID：12902894
> 
> 赞同：3
> 
> 时间：2012-10-15T19:46:16.523
> 
> 标签：java, android, imageview

我将我的`ImageView`布局放在一个`.xml`文件中，在我的主 java 文件中我正在使用代码

`static int[] images = { R.drawable.green_0, R.drawable.blue_1, R.drawable.purple_2, R.drawable.pink_3, R.drawable.red_4, R.drawable.yellow_5, R.drawable.white_6, R.drawable.teal_7, R.drawable.babyblue_8, R.drawable.lightgreen_9, R.drawable.magenta_10, R.drawable.grey_12, R.drawable.black_11 };`

显示图像。但是，稍后在代码中我尝试使用该行

`holder.image.setImageBitmap(images[position].getImage());`

这给出了错误

> “无法在原始类型 int 上调用 getImage()”

我怎么能在我的应用程序中显示图像以使用该行没有错误的代码（不将图像声明为布尔类型 int）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-15T19:51:18.880

您的问题是您正在使用整数值。您需要在 Drawable 或 Bitmap 中转换这个 int，如下所示：

```
holder.image.setImageResource(images[position]) 
```

或者

```
holder.image.setImageDrawable( getResources().getDrawable( images[position] )); 
```

或者

```
holder.image.setImageBitmap(BitmapFactory.decodeResource(getResources(),  images[position])); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T19:55:34.433

`setImageBitmap()`接受一个 Bitmap 对象，而不是一个 int。您提供的 int 只是 R.java 生成的资源文件中的 id。

使用[BitmapFactory.decodeResources()](http://developer.android.com/reference/android/graphics/BitmapFactory.html#decodeResource%28android.content.res.Resources,%20int%29)：

```
holder.image.setImageBitmap(BitmapFactory.decodeResource(this.getResources(), images[position])); 
```

# binary - 2 对使用逻辑门的有符号二进制转换器的补码？

> ID：12902906
> 
> 赞同：2
> 
> 时间：2012-10-15T19:47:07.927
> 
> 标签：binary, converter, twos-complement

我需要使用门电路为有符号二进制转换器创建一个 2 的补码。我可以使用哪些逻辑门？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-12-28T19:43:20.457

先前的答案部分不正确。使用非门来获得 1 的补码是正确的，但要获得 2 的补码，您需要求和和进位。求和由 XOR 门执行，进位由 AND 门执行。每个位都需要一个 NOT、一个 XOR 和一个 AND 门。将每条数据线连接到一个非门（执行 1 的补码） 将每个 XOR 的一个输入连接到每个 AND 的一个输入。从现在开始，我将其称为 input1。将每个 XOR 的另一个输入连接到每个 AND 的另一个输入。从现在开始，我将其称为 input2。将每个 NOT 输出连接到其对应的输入 1。将较低有效位的 input2 连接到 VCC（逻辑电平 1）。将不太重要的与门的输出连接到第二次重要的输入2。（执行进位）对所有门重复最后一步。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T19:52:38.517

我相信你可以只使用异或门来实现任何算法。去吧。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T20:07:37.733

您可以使用非门来切换输入位以获得 1 的补码。然后将每个非门的输出放到另一个“2输入异或门”的输入。

因此，如果您有 N 个输入，那么您需要 N 个非门和 N 个 Xor 门，它们的输出将 Not Gates 连接到 Xor 门的输入之一。并将 1（无论您用来表示 1 的高电压/低电压）放到 Xor 门的另一个输入端，您将在其中放置最低有效输入位的切换输出。然后将这个 Xor 门的输出放到第二个 Xor 门中，在那里放置第二个最低有效输入位的切换输出。通过这种方式，您将第 (N-1) 个 Xor 门输出的输出放入第 N 个 Xor 门的输入。

最后，当您从 Xor 门的输出中获取输出时，您会发现输入数的 2 的补码。

# plot - 回归 i Maple - 找到可能的最佳曲线

> ID：12902913
> 
> 赞同：0
> 
> 时间：2012-10-15T19:47:46.570
> 
> 标签：plot, maple

给定以下图表中绘制的一些数据点：

```
plot(<<a>|<b>>,style=point); 
```

如何通过点进行回归？那就是找到最好的曲线、直线等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T20:55:03.683

您可以查看[CurveFitting](http://www.maplesoft.com/support/help/Maple/view.aspx?path=CurveFitting)包或[Statistics,Regression](http://www.maplesoft.com/support/help/Maple/view.aspx?path=Statistics/Regression)的帮助页面。（请注意，后者应该通过`regression`在 Maple 16 帮助浏览器的搜索框中输入来显示。）

```
a:=<1,2,3,4,5>:
b:=<2,5,10,17,26>:

P1:=plot(<a|b>,style=point,color=red):

C1:=Statistics:-Fit(s+t*x,a,b,x);

C2:=Statistics:-Fit(s+t*x+u*x^2,a,b,x);

plots:-display( 
            P1,
            plot(C1, x=min(a)..max(a), color=green),
            plot(C2, x=min(a)..max(a), color=blue)
              ); 
```

# c++ - 浮点型功能

> ID：12902915
> 
> 赞同：0
> 
> 时间：2012-10-15T19:47:52.670
> 
> 标签：c++, floating-point, decimal

> **可能重复：**
> [浮点数的总和不准确](https://stackoverflow.com/questions/12878655/sum-of-float-is-not-exact)

所以我有代码：

```
#include <iostream>
using std::cout;
using std::endl;

int main () {
   float x = 0.0001;
   float y = 0;
   for (int i=0; i < 10000; i++) {
      y += x;
   }
   cout << y << endl;
   return 0;
} 
```

我期望输出为 1，但我得到 1.00005，怎么会？我需要更改什么才能使代码或多或少保持相同的“1”？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T19:53:51.543

二进制浮点数不能准确表示所有可能的十进制有理数。如果不能，则会发生舍入错误。您会看到这些舍入错误的累积。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T20:03:52.993

```
int main () {
   int x = 1;
   int y = 0;
   for (int i=0; i < 10000; i++) {
      y += x;
   }
   cout << y/10000.0 << endl;
   return 0;
} 
```

整数是精确的，浮点数通常不是。如果您需要精确性，不使用十进制库的最简单方法是将数学保留在整数域中，直到您需要它为止。

# c# - 使用 OData 的 Orderby 复杂类型

> ID：12902916
> 
> 赞同：2
> 
> 时间：2012-10-15T19:47:53.823
> 
> 标签：c#, asp.net-mvc, asp.net-web-api, odata

我开始在我的 MVC4 应用程序中使用 OData，我遇到的问题是我无法对 IQueryable 执行任何排序或过滤操作，因为我使用的是复杂对象。下面是我想要完成的一个简单示例：

我的 API 控制器试图将 MyObjects 的集合作为 IQueryable 返回。

```
public IQueryable Get()
{
    List<MyObject> myObjects = GetMyObjects();
    return myObjects.AsQueryable() ;
} 
```

每个 MyObject 都包含一个 InnerObject，它具有我想要排序和/或过滤的属性。

```
public class MyObject
{
    [Key]
    public MyInnerObject innerObject{ get; set; }

    public MyObject(Dictionary<string, object> value)
    {
        innerObject= new MyInnerObject(){
            item = value["item"].ToString(),
            itmdesc = value["itmdesc"].ToString()
        };
    }
}

public class MyInnerObject
{
    public string item { get; set; }
    public string itmdesc { get; set; }
} 
```

我可以通过url成功执行top命令

```
localhost:5050/Test/Get?$top=10 
```

但我真的希望能够使用

```
localhost:5050/Test/Get?$top=10&$orderby=innerObject.item 
```

我努力了

```
localhost:5050/Test/Get?$top=10&$orderby=innerObject.item
localhost:5050/Test/Get?$top=10&$orderby=innerObject/item
localhost:5050/Test/Get?$top=10&$orderby=item 
```

有什么建议么？

**编辑：**

我应该提一下，如果我将 item 和 itmdesc 属性放在 MyObject 中，它会起作用，但出于我的目的（这只是我的复杂实体的缩小版本），它们需要包装在复杂类型中。

在我的 Api 控制器中，我也尝试过 IQueryable< MyObject> 但这并没有什么不同

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-15T23:29:59.980

通常，作为协议的 OData 允许您尝试的第二件事 ( `localhost:5050/Test/Get?$top=10&$orderby=innerObject/item`)。这很可能是 OData 的 Web API 实现的临时限制（假设这是您根据环境的其余部分使用的以及 IQueryable 的返回）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T18:29:06.237

Aspnet Web API OData 不支持按嵌套属性或表达式排序。在 codeplex 上存在一个支持按嵌套属性排序的[问题。](http://aspnetwebstack.codeplex.com/workitem/791)

但是，如果您有点冒险，您可以使用 ODataQueryOptions 模型绑定各个 odata 查询选项，然后将 $orderby AST 转换为 linq 表达式并手动将其应用于您的 IQueryable。

# c# - 自动将表格列导入表单设计

> ID：12902919
> 
> 赞同：3
> 
> 时间：2012-10-15T19:47:56.883
> 
> 标签：c#, winforms, visual-studio-2010, sql-server-2008

到目前为止，我发现 SQL Server 上的 C# 非常容易开发（当依靠 IDE 引导您完成时）。

因此，我期望 Visual Studio 2010 和 SQL Server 2008 Express 可能提供或不提供的功能也就不足为奇了：

而不是手动将`TextBox`es 从工具栏拖到 Windows 窗体中，然后键入它们的名称等以将它们与表中的字段/列相关联......是否可以告诉 Visual Studio 使用来自的**所有**列自动填充表单一个特定的表？

如果是这样，如何做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T19:57:15.083

您需要查看 DataBinding 才能轻松完成此操作。将您的数据库添加为项目的新数据源，然后您可以将它的一部分拖到您的表单中。

请参阅[此处](http://www.codeproject.com/Articles/24656/A-Detailed-Data-Binding-Tutorial)获取教程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T19:52:13.230

是的，有可能。您可能需要稍微探索一下 .Net Reflection，使用它可以构建动态表单应用程序。

实际上，Web 有类似的东西叫做 LightSwitch (http://msdn.microsoft.com/en-us/vstudio/lightswitch.aspx)

# objective-c - iOS 应用程序的多轨 mp3 播放

> ID：12902920
> 
> 赞同：3
> 
> 时间：2012-10-15T19:48:03.043
> 
> 标签：objective-c, ios, core-audio, openal, audiounit

我正在做一个涉及以多轨格式（鼓、人声、吉他、钢琴等）播放歌曲的应用程序。我不需要对每个音轨进行任何花哨的音频处理，我需要做的就是播放、暂停和静音/取消静音每个音轨。

我一直在使用 AVAudioPlayer 的多个实例，但是在执行设备测试时，我注意到曲目在第一次播放时播放的非常不同步。此外，当我暂停并播放曲目时，它们会继续变得更加不同步。经过一番研究，我意识到 AVAudioplayer 延迟太高，不适用于我的应用程序。

在我的应用程序中，我基本上有一个 NSArray 的 AVAudioPlayers，我会循环播放每个播放器或暂停/停止每个播放器，我确信这是导致它在设备上不同步的原因。

看起来苹果的音频混音器对我来说效果很好，但是当我尝试实现它时，我得到了一个我无法弄清楚的 EXC_BAD_ACCESS 错误。

我知道答案是使用 OpenAL 或音频单元，但是当我需要做的只是同时播放大约 5 个 .mp3 曲目时，似乎没有必要花费数周时间来学习这些。有没有人对如何做到这一点有任何建议？谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-16T19:43:26.580

感谢 admsyn 的建议，我能够想出一个解决方案。

AVAudioPlayer 有一个 currentTime 属性，它返回曲目的当前时间，也可以设置。

因此，我按照 admsyn 的说明实现了 startSynchronizedPlayback，然后在停止曲目时添加了以下内容：

```
-(void) stopAll
{
int count = [tracksArr count];
for(int i = 0; i < count; i++)
    {
    trackModel = [tracksArr objectAtIndex:i]
    if(i = 0)
        {
         currentTime = [trackModel currentTime]
        }
    [trackModel stop]
    [trackModel setCurrentTime:currentTime]
    }
{ 
```

这段代码基本上循环遍历我的曲目数组，每个曲目都有自己的 AVAudioPlayer，从第一首曲目中获取当前时间，然后将所有后续曲目设置为该时间。现在，当我使用 startSynchronizedPlayback 方法时，它们都会同步播放，暂停 unpausing 也会使它们保持同步。希望这对尝试保持轨道同步的其他人有所帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-15T21:55:15.340

如果您`play`向每个 AVAudioPlayer 发出单独的消息，则消息完全有可能在不同的时间到达，或者 AVAudioPlayer 完成它们的热身阶段彼此不同步。您应该使用[playAtTime:](http://developer.apple.com/library/ios/documentation/AVFoundation/Reference/AVAudioPlayerClassReference/Reference/Reference.html#//apple_ref/occ/instm/AVAudioPlayer/playAtTime%3a)和[deviceCurrentTime](http://developer.apple.com/library/ios/documentation/AVFoundation/Reference/AVAudioPlayerClassReference/Reference/Reference.html#//apple_ref/occ/instp/AVAudioPlayer/deviceCurrentTime)属性来实现正确的同步。注意 deviceCurrentTime 的描述：

> 调用 playAtTime: 实例方法时，使用此属性指示“现在”。通过将多个音频播放器配置为在 deviceCurrentTime 的指定偏移处播放，您可以执行精确的同步 - 如该方法的讨论中所述。

还要注意讨论中的示例代码`playAtTime:`：

```
// Before calling this method, instantiate two AVAudioPlayer objects and
// assign each of them a sound.

- (void) startSynchronizedPlayback {

    NSTimeInterval shortStartDelay = 0.01;            // seconds
    NSTimeInterval now = player.deviceCurrentTime;

    [player       playAtTime: now + shortStartDelay];
    [secondPlayer playAtTime: now + shortStartDelay];

    // Here, update state and user interface for each player, as appropriate
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T06:52:55.300

如果您能够将文件解码到磁盘，那么音频单元可能是提供最佳延迟的解决方案。如果您决定使用这样的架构，您还应该查看 Novocaine：

[https://github.com/alexbw/novocaine](https://github.com/alexbw/novocaine)

该框架消除了处理音频单元的很多麻烦。

# c - 在未设置 _POSIX_SAVED_IDS 的情况下使用 setreuid()

> ID：12902923
> 
> 赞同：3
> 
> 时间：2012-10-15T19:48:13.853
> 
> 标签：c, linux, permissions, suid

我正在探索 suid 地区，发现自己无法回答这个问题。为了这个问题，假设程序二进制文件是 suid，由用户 1001 拥有并由用户 1000（均为*非 root 用户*）运行 - 因此 RUID=1000，EUID=1001。

设置时`_POSIX_SAVED_IDS`，我可以使用`setuid()`and`seteuid()`来在 1000 和 1001 之间更改 RUID 和 EUID（分别）。

但是，如果`_POSIX_SAVED_IDS`不设置，`seteuid(1000)`将导致以后无法执行`seteuid(1001)`，并且稍后`setuid(1001)`会执行相同的`setuid(1000)`操作。

为了将 EUID 更改为 RUID 并保持稍后返回的可能性，我在这里找到的解决方案[GNU Setuid Program Example](https://www.gnu.org/software/libc/manual/html_node/Setuid-Program-Example.html)是使用`setreuid(1001,1000)`（交换它们）。这对程序有什么影响，因为它改变了 RUID？据我了解，它改变了进程的所有者，因此对杀死进程或与进程交互的权限有影响。
哪些系统不使用_POSIX_SAVED_IDS？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T20:12:46.570

由于 POSIX 需要`_POSIX_SAVED_IDS`以正值定义，因此任何系统都不应缺少`_POSIX_SAVED_IDS`.

资料来源： http: [//pubs.opengroup.org/onlinepubs/9699919799/basedefs/unistd.h.html](http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/unistd.h.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-02-13T17:47:22.707

我只需要处理这个问题，到目前为止，下面的部分还没有得到正确的回答。

> 为了将 EUID 更改为 RUID 并保留稍后返回的可能性，我在这里找到的解决方案 GNU Setuid Program Example 是使用 setreuid(1001,1000) （交换它们）。这对程序有什么影响，因为它改变了 RUID？据我了解，它改变了进程的所有者，因此对杀死进程或与进程交互的权限有影响。

随处发生的情况是，EUID 是唯一用于访问文件或能够终止进程等权限的东西（可能会出现一些罕见的例外情况）。这个想法是您可以在 EUID 和 RUID 之间来回切换，但*只能*在它们之间切换。内核需要跟踪这两个 id。

`seteuid`对于非 root 用户，只允许切换到 EUID、RUID 和 - 如果内核支持它 - SUID 之一。

对于符合 POSIX 的系统，SUID 是可用的，所以会发生这种情况：

```
// uids are: EUID=1001, RUID=1000, SUID=1001
seteuid(1000) ; // works because RUID=1000
// uids are: EUID=1000, RUID=1000, SUID=1001
seteuid(1001); // works because SUID=1001 
```

在没有 SUID 的系统上：

```
// uids are: EUID=1001, RUID=1000
seteuid(1000); // works because RUID=1000
// uids are: EUID=1000, RUID=1000
seteuid(1001); // fails, neither EUID, nor RUID is 1001 
```

反过来

```
// uids are: EUID=1001, RUID=1000
setreuid(1001, 1000) ; // works because EUID=1001 and RUID=1000
// uids are: EUID=1000, RUID=1001
setreuid(1000, 1001); // works because EUID=1000 and RUID=1001 
```

我还没有找到在符合 POSIX 的系统上永久删除权限的标准方法，因为这需要修改 SUID。只有 gnu 扩展可用：

```
// uids are: EUID=1001, RUID=1000, SUID=1001
setresuid(1000, 1000, 1000);
// uids are: EUID=1000, RUID=1000, SUID=1000 
```

见：[https ://people.eecs.berkeley.edu/~daw/papers/setuid-usenix02.pdf](https://people.eecs.berkeley.edu/~daw/papers/setuid-usenix02.pdf)

# macos - 执行 gcc 时符号链接的级别太多

> ID：12902928
> 
> 赞同：0
> 
> 时间：2012-10-15T19:48:27.993
> 
> 标签：macos, plone

我正在尝试在我的新 Mac 中安装 Plone。我在运行构建时遇到了困难：

```
Getting distribution for 'zope.security==3.7.4'.
unable to execute gcc-4.2: Too many levels of symbolic links
error: Setup script exited with error: command 'gcc-4.2' failed with exit status 1
An error occured when trying to install zope.security 3.7.4\. Look above this message for          any errors that were output by easy_install.
While:
   Installing.
   Getting section instance.
   Initializing section instance.
   Installing recipe plone.recipe.zope2instance.
   Getting distribution for 'zope.security==3.7.4'.
Error: Couldn't install: zope.security 3.7.4 
```

但是python安装确实说有gcc 4.2.1

```
Python 2.7.3 (v2.7.3:70274d53c1dd, Apr  9 2012, 20:52:43) 
[GCC 4.2.1 (Apple Inc. build 5666) (dot 3)] on darwin
Type "help", "copyright", "credits" or "license" for more information. 
```

我不知道如何指向`gcc`正确的版本，或者可能是不同的问题。任何帮助或指针都会很棒。

我有 Mac OSX 10.7.5 并安装了 XCode。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T20:28:56.630

通过安装命令行工具解决。

# silverlight-5.0 - EF 属性导航

> ID：12902931
> 
> 赞同：0
> 
> 时间：2012-10-15T19:48:37.947
> 
> 标签：silverlight-5.0

我有一个带有 Ria Service 和 EF 的 Silverlight 应用程序。在我的 ViewModel 中，我想通过导航实体关系来访问一个集合，在我的服务中，我设置了查询，我看到我的集合被正确检索，但是在我的 ViewModel 类的 Silverlight 端它丢失了。有人遇到过这个问题吗？

DomainService 中的代码：

```
 var retVal = (from e in ObjectContext.embarques.Include("Bultos")
                  where e.nro_embarque == nroEmbarque && e.nro_sub_embarque == nroSubembarque
                  select e).FirstOrDefault();
        return retVal; 
```

以上 retVal 在 Bultos 中具有所需的结果，然后在我的 ViewModel 中

```
EntityQuery<embarques> query = context.GetEmbarqueQuery(NroEmbarque, NroSubembarque);
            LoadOperation<embarques> op = context.Load(query);
            op.Completed += (sender, e) => {
                if (!op.HasError) {
                    Embarque = op.Entities.FirstOrDefault();
                    if (null != Embarque) {
                        Bultos = new ObservableCollection<Bultos>(Embarque.Bultos);
                    }
                }
            };
        } 
```

Embarque.Bultos.Count = 0 以上

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T14:59:06.317

我在这里缺少的唯一和平是将 [Include] 属性放在 embarquesMetadata 类中：

```
internal sealed class embarquesMetadata
{
    ...
    [Include]                       
    public EntityCollection<Bulto> Bultos{ get; set; }
    ...
} 
```

一旦包括在内，一切都像魅力

# javascript - 更改 javascript 函数的代码

> ID：12902935
> 
> 赞同：0
> 
> 时间：2012-10-15T19:49:06.553
> 
> 标签：javascript

实际上我的想法如下：我有一个 div 标签，它在脚本标签内显示一个名为“afficher_general()”的函数的结果，还有一个按钮，它调用第一个名为“Ajouter_general()”的函数，它应该改变一个字符串在函数“afficher_general()”中

```
var general = document.getElementById("general");
general.innerHTML = general.innerHTML.replace('//WRITE', ch); 
```

按钮如下：

```
<input type="button" value="ajouter au graphe general" id="id1" onClick="Ajouter_general();afficher_general();" /> 
```

但这似乎不起作用，因为我被告知脚本只加载一次并且无法更改。那么有什么解决办法吗？提前致谢。

所以我将添加包含功能的内容。实际上我正在与 Amcharts 合作。函数afficher_general如下：

```
<script name="general" id="general" type="text/javascript">
    function afficher_general()
    {

                    chart = new AmCharts.AmSerialChart();
                    chart.dataProvider = chartData;
                    chart.categoryField = "country";
                    chart.startDuration = 1;                
                    // WRITE
                    chart.write("chartContainer");

    }
</script> 
```

而不是评论 //WRITE 我希望在每次按下按钮时添加代码。功能如下：

```
function Ajouter_general(ind){
var ch="";
var couleur = getSelectValueId("background-color"+ind);
var transparence = getSelectValueId("transparence"+ind);
var type = get_radio_value_type(ind);
var balloon = getSelectValueId("balloon-color"+ind);
if(type == "column")
                {
                ch=ch+"var graph"+ind+" = new AmCharts.AmGraph();";
                                ch=ch+"graph"+ind+".valueField = "+"visits"+";"
                ch=ch+"graph"+ind+".balloonColor = "+balloon+";";
                                ch=ch+"graph"+ind+".type = "+type+";";
                                ch=ch+"graph"+ind+".fillAlphas = "+transparence+";";
                ch=ch+"graph"+ind+".fillColors = ["+couleur+"];";
                ch=ch+"graph"+ind+".lineColor = ["+couleur+"];";
                ch=ch+"chart.addGraph(graph"+ind+");";
                ch=ch+"// WRITE";
                }
var general = document.getElementById("general");
general.innerHTML = general.innerHTML.replace('//WRITE', ch);
} 
```

由于 Amcharts 使用脚本在图表内绘制图形，因此我希望能够在每次按下按钮时动态添加这些图形。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T19:55:25.460

如果你真的需要改变一个函数的定义，你总是可以重新定义它（函数只是分配给变量的对象）：

```
var Ajouter_general = function () {
    // redefine the afficher_general function
    afficher_general = function () {
        // change it to whatever you want
    };
}; 
```

话虽如此，这通常是一种不好的做法，使用函数参数可以更好地完成相同的功能。

# javascript - 如何为输入文本框添加事件处理程序

> ID：12902937
> 
> 赞同：2
> 
> 时间：2012-10-15T19:49:07.910
> 
> 标签：javascript, jquery

我的程序应该包含名称搜索和 ID 搜索功能，当用户单击名称搜索按钮时，会触发名称搜索验证以确保所需的文本字段不为空，另一方面，当用户单击 id 搜索按钮时，触发 id 搜索验证以确保不同的必填文本字段不为空。所以在 HTML 文件中，我有以下 jQuery 和 HTML 代码。

```
 $(document).ready(function() {
        $('#submitIDSearch').bind('click', validateIDSearch);
        $('#submitNameSearch').bind('click', validateNameSearch);
        $('#searchLastName').bind('click', validateNameSearch);
        $('#searchFirstName').bind('click', validateNameSearch);
        $('#searchID').bind('click', validateIDSearch);
    });

    var validateNameSearch = function(event) {
        var btnSrchLastName = getRef('searchLastName');
        if (null != btnSrchLastName) {
            var len = btnSrchLastName.value.length;
            if (0 == len) {
                alert('Last Name is a required field, please input Last Name.');
                $('#searchLastName').focus();
                return false;
            }
        }
        return true;
    }

    var validateIDSearch = function(event) {
        var btnSrchID = getRef('searchID');
        if (null != btnSrchID) {
            var len = btnSrchID.value.length;
            if (0 == len) {
                alert('ID is a required field, please input ID.');
                $('#searchID').focus();
                return false;
            }
        }
        return true;
    } 
```

我有以下 HTML 代码：

```
 <form id="infoForm" name="checkAbsenceForm" method="post" action="absenceReport.htm">
        <label class="q">ID * <input id="searchID" name="searchID" maxlength="9" /></label>
        <input id="submitIDSearch" type="submit" value="Search ID"/>
        <hr />
        <label class="q">First Name <input id="searchFirstName" name="searchFirstName" maxlength="23"></label>
        <br />
        <label class="q">Last Name * <input id="searchLastName" name="searchLastName" maxlength="23" /></label>
        <input id="submitNameSearch" type="submit" value="Search Name"/>
        <hr />
    </form> 
```

除了一个问题，当用户点击文本框时，代码行为正确，点击事件会被触发，这会导致警报消息框的预生成。

我观察到，**当用户从文本字段中键入 'enter' 键时，会触发 click 事件，而不是 'submit'**，所以我猜我的监听器只能绑定到 click 事件。

请问是否有一种解决方法可以避免鼠标单击文本框触发事件？

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T20:00:13.903

您可以使用表单中的提交事件，因此每次有人提交表单时它都会检查。[jQuery - 提交](http://api.jquery.com/submit/)

```
$('#infoForm').submit(function (event){
    if (!validateIDSearch() && !validateNameSearch()){
        event.preventDefault(); // Prevent the submit event, since didn't validate
    }
    // Will continue to the dafault action of the form (submit it)
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T15:52:20.940

如果您仍然需要帮助... [http://jsfiddle.net/jaxkodex/Cphqf/](http://jsfiddle.net/jaxkodex/Cphqf/)

```
$(document).ready(function() {

    $('#submitNameSearch').click(function(event) {
        event.preventDefault();
        if (validate($('#searchLastName'), 'Last name field is required.')) {
            $('#infoForm').submit();
        }
    });

    $('#submitIDSearch').click(function(event) {
        event.preventDefault();
        if (validate($('#searchID'), 'ID field is required.')) {
            $('#infoForm').submit();
        }
    });
});

function validate(input, errorMsg) {
    if (input.val() == null || input.val().length == 0) {
        alert(errorMsg);
        return false;
    }
    return true;
} 
```

由于您使用的是 jQuery，因此您可以在单击按钮时提交表单`$('#infoForm').submit();`如果您检查是否需要使用按钮输入并且不再需要提交输入，因为它们会触发提交事件。这只是一种方法。如果您正在寻找实时验证，您可以使用模糊事件而不是点击，但在文本输入和按钮的点击事件中，以确保它有效。我想当你必须做一些ajax时覆盖提交函数会起作用。希望能帮助到你。

**[编辑]**如果您想保留按钮提交，您可以执行以下操作：http: [//jsfiddle.net/jaxkodex/S5HBx/1/](http://jsfiddle.net/jaxkodex/S5HBx/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T20:09:26.217

您只需要设置用户选择的按钮并在表单提交期间根据该按钮进行验证。

> `searchLastName searchFirstName submitNameSearch`正在呼唤`validateNameSearch`，`submitIDSearch searchRUID`正在呼唤`validateIDSearch`

```
 $(function () {

    var validateFx = null; //none selected;

    $('#submitNameSearch, #searchLastName, #searchFirstName')
        .bind('click', function () {
           validateFx = validateIDSearch;
        });
    $('#searchIDSearch, #searchRUID')
       .bind('click', function () {
         validateFx = validateNameSearch;
       });

    $('#infoForm').submit(function (event){
         event.preventDefault();

         if (validateFx != null && validateFx ()) {
            $(this).submit();
         }
    });
}); 
```

# string - MIPS 随机字扰码器

> ID：12902939
> 
> 赞同：0
> 
> 时间：2012-10-15T19:49:19.190
> 
> 标签：string, assembly, random, mips, permutation

我正在尝试编写使用 MARS（我的 MIPS 模拟器）伪随机数生成器的代码，以在字符串中选择一个随机字符，将其从内存中取出并放入寄存器，然后用星号 '*' 替换内存中的那个字符.

到目前为止，它只打乱了这个词的一部分，这让我发疯了。我找不到此代码中的哪些内容不起作用。我什至不需要直接的答案，只是提示/提示会很有帮助。

这是代码：

```
#this loop extracts a char at random from a string in memory, stores it in a register, and replaces the char in the string with an asterisk '*'

.data

.align 2
string0: .ascii "Tyler\n"

.align 2
endString: .asciiz "Loop completed!\n"
.align 2
scrambleString: .asciiz

.text

#counter
li $t0, 5

#pointer to string0
la $s0, string0

loop2:

#is counter = 0? go to loop3 if so
beq $t0, $0, loop3

#seed & prepare randomized number generator
li $v0, 30 
syscall

li $v0, 40 #sets seed
syscall

#generates random number in $a0, with the coUnter $t0 being the upper bound
addi $a1, $t0, 1
li $v0, 42
syscall

#add STRING POINTER by random number in $a0, store this new address in $t1
#addi $a0, $a0, 1
add $t1, $s0, $a0
#srlv $t1, $s0, $a0

#isolates that bytesized char, puts it into $t2
lbu $t2, ($t1)
#beq $t2, 0x5c, loop2

#replaces char in original string with "*"
li $t3, 0x2a
sb $t3, ($t1)

beq $t1, $t3, loop2
#decrement counter
addi $t0, $t0, -1

#loop return
j loop2

loop3:
la $a0, string0
li $v0, 4
syscall

li $v0, 10
syscall 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T22:09:11.573

1.  You are resetting the random number seed on every iteration of your loop (loop2:).
2.  Syscalls 40 and 42 each take 2 parameters which should be in `$a0` and `$a1`. See [here](http://courses.missouristate.edu/KenVollmar/MARS/Help/SyscallHelp.html).
3.  The temporary registers `$t0,...,$t9` get altered by each `syscall`. You should be using the callee saved registers `$s0,...$s8` instead.

# jquery - 将下拉 jquery 过滤器更改为单个复选框

> ID：12902940
> 
> 赞同：1
> 
> 时间：2012-10-15T19:49:22.560
> 
> 标签：jquery, checkbox, jquery-filter

我需要帮助制作此代码

```
<select id="fruit" class="friltro">
  <option value="all">All fruits</option>
  <option value="apple">apple</option>
  <option value="orange">orange</option>
  <option value="pineapple">pineapple</option>
  </select>
  <select id="price" class="friltro">
  <option value="all">All prices</option>
  <option value="1">$1</option>
  <option value="3">$3</option>
  <option valenter code hereue="4">$4</option>
</select> 
```

进入单独的复选框，这是我到目前为止所拥有的

```
<input type="checkbox" id="price" value="all" class="filtro" >
<label for="filtro" >all</label>
<input type="checkbox" id="apple" value="apple" class="filtro" >
<label for="filtro" >apple</label> 
```

但它根本不起作用，但当我尝试将其设置为复选框时，它会停止工作。

这里也是jquery代码

```
$('.friltro').change(function () {
var criteria = '';
var showAll = true;
$('.friltro').each(function () {
    var val = $(this).children(':selected').val();
    if (val !== 'all') {
        criteria += '.' + $(this).attr('id') + '-' + val;
        showAll = false;
    }
});
if (showAll) {
    $('.item').show();
} else {
    $('.item').hide();
    $(criteria).show();
} 
```

});​</p>

这也是我要过滤的内容

```
 <div class="item apple 1>

Apple $1

</div>
<div class="item orange 4">

An orange that costs 4 dollars
</div> 
```

我知道被过滤的东西非常简单，但是一旦脚本工作，我将添加图像 css。任何人都可以帮忙吗？

# c# - 检测不同域中的会话？

> ID：12902941
> 
> 赞同：1
> 
> 时间：2012-10-15T19:49:23.137
> 
> 标签：c#, asp.net, .net

我有两个 asp.net 应用程序。它们位于不同的域（即 app1.com 和 app2.com）。如果 app1.com 生成一个 asp.net sessionId，将其存储到 cookie 中，并将其保存到两个应用程序都可以访问的数据库中，那么我如何检测到同一个用户现在在 app2.com 上？访问 app2.com 会生成不同的 sessionId。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T19:52:22.167

您将需要使用不同的会话状态模式。您可以使用 SQL Server 会话状态或自定义会话状态。

[您可以在MSDN 站点](http://msdn.microsoft.com/en-us/library/ms178586%28v=vs.100%29.aspx)上阅读有关它们的更多信息。

# oracle - 实体框架中的 Oracle 分页返回的记录集与有意返回的记录集不同

> ID：12902943
> 
> 赞同：1
> 
> 时间：2012-10-15T19:49:29.830
> 
> 标签：oracle, entity-framework, c#-4.0, pagination

我以为我了解 LINQ 还是我了解了，或者它可能是一个令人讨厌的 Oracle 提供程序错误？

遇到一个非常令人沮丧的情况，我想在淘汰应用程序中实现分页。使用 Troy Goode 的 PagedList Mvc 库，我可以看到代码从返回两个项目的搜索转换为 15 个项目的结果（我已将分页设置为每个 15 个项目）。在 SQL Server 2005/2008 中工作得非常好，但使用 Oracle.DataAccess.dll v11.2.3/v4.112.3 时效果不佳（取决于版本号的读取方式）。

我在 Linq 中做了这样的搜索结果：

```
var entities = _context.Entities;

var q = !string.IsNullOrEmpty(search)
                        ? entities
                            .Where(a => a.PRODUCT_NUM.ToUpper().Contains(search.ToUpper())
                                     || a.PRINT_NAME.ToUpper().Contains(search.ToUpper()))
                        : entities;   

var result = q.OrderBy(e => e.UPDATE_DATE == null)
                             .ThenByDescending(e => e.UPDATE_DATE)
                             .Select(r => new EntityModel
                             {
                                 Id = r.ID,
                                 Num = r.PRODUCT_NUM,
                                 Name = r.PRINT_NAME,
                                 City = r.City.PRINT_NAME,
                                 State = r.City.State.PRINT_NAME,
                                 EntityType = r.ENTITY_TYPE,
                                 CompanyType = r.COMPANY_TYPE,
                                 UpdateDate = r.UPDATE_DATE
                             })
                             .ToPagedList(pageNumber, 15); 
```

现在，使用即时窗口，我可以让它返回 2 个项目，但是当它通过分页过程时，它会返回 15 个项目。

首先想到，我有缓存问题还是什么？但深入研究了 PagedList 库。[https://github.com/TroyGoode/PagedList](https://github.com/TroyGoode/PagedList)

让我们看看传递给 PagedList 的对象，我会告诉你返回的记录数。在 PagedList 内部，IQueryable 对象被称为超集并最终返回一个列表，但请查看当我通过即时窗口查询列表时得到的结果。我只是想这将是向你展示的最好方式......

```
?superset.Take(pageSize).Count()
2
?superset.Count()
51114
?superset.Skip(0).Take(pageSize).Count()
2
?superset.ToList().Count()
2
?superset.Skip(0).Take(pageSize).ToList().Count()
15
?superset.Take(pageSize).ToList().Count()
15 
```

对我来说最有趣的是，当我们执行 ToList() 时，它会返回 15 条记录。是 Oracle ODP.NET 提供程序问题吗？我启动了 Ayende 的 Entity Framework Provider [efprof.com](http://efprof.com/)并看到正在生成的 Oracle 查询，将其复制粘贴到 TOAD，它确实返回 2 项而不是 15 项。

我肯定错过了一些东西。

谢谢，-罗布

# ios - 如何像移动横幅一样滚动截断文本iOS tableview

> ID：12902944
> 
> 赞同：1
> 
> 时间：2012-10-15T19:49:31.497
> 
> 标签：ios, xcode, uitableview, tableview, tableviewcell

我有一个表格视图，其中包含来自已解析的 xml 文件的动态数据。我已经设置了默认字体大小，对于大多数条目来说，它都可以正常工作。但是，有些条目似乎被切断了.. Apple简单地在末尾添加了“...”。

有没有办法可以实现类似缓慢滚动的横幅来适应这种情况？如果没有，有没有一种方法可以使文本超出大小而不对所有条目进行全局更改？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T20:15:25.020

我认为对于缓慢滚动的横幅，您必须自己通过动画视图来实现。

如果您不希望您的文本超出大小，您可以尝试在 ios6 中使用 minimumScaleFactor：

```
[label setMinimumScaleFactor:.75f]; 
```

或 < ios6 的 minimumFontSizeSize。这些本质上会缩小文本以适应框架。ps 你可以在界面生成器中配置这些

# ms-word - 我可以以编程方式控制 Office 消息栏吗

> ID：12902949
> 
> 赞同：1
> 
> 时间：2012-10-15T19:50:10.703
> 
> 标签：ms-word, vsto, ms-office, office-interop, office-2010

在 Office 中，功能区下方有时会显示黄色或红色消息栏。安全相关消息通常为红色，信息消息通常为黄色。

下面的屏幕截图显示*MS Access*显示了一个典型的消息栏。

![MS Access 中黄色消息栏的屏幕截图](../Images/31dc9928b0c69a7cf954236f5bb916bc.png)

我想创建一个以编程方式使用此 UI 功能的小型*Word*插件。那可能吗？我搜索了[有关自定义 Office 的 MSDN 信息，](http://msdn.microsoft.com/en-us/library/jj620922.aspx)但找不到有关如何执行此操作的任何参考。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T20:01:49.347

到目前为止，对我自己的问题的最佳答案是将[自定义任务窗格](http://msdn.microsoft.com/en-us/library/vstudio/aa942864.aspx)设置为看起来像黄色面板，并用于[`DockPositionRestrict`](http://msdn.microsoft.com/en-us/library/vstudio/microsoft.office.tools.customtaskpane.dockpositionrestrict.aspx)防止它被移动。暂时不要将此标记为答案，以防有人知道更好的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T15:32:06.400

我认为，用 Office 的术语来说，消息栏实际上被称为`Protected View Window`. 它有一个 API [ProtectedViewWindow](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.word.protectedviewwindow.aspx)，可用于 Word 和 Excel 互操作。

看看它的[属性和方法](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.word.protectedviewwindow_members.aspx)，它会对你有所帮助。

例如，用于`ProtectedViewWindow.Caption`添加您的自定义消息。

# python - 根据前 2 个元素从嵌套列表中删除重复项

> ID：12902950
> 
> 赞同：5
> 
> 时间：2012-10-15T19:50:15.303
> 
> 标签：python, list

仅当前两个元素相同时，我才尝试从嵌套列表中删除重复项，而忽略第三个。

列表：

```
L = [['el1','el2','value1'], ['el3','el4','value2'], ['el1','el2','value2'], ['el1','el5','value3']] 
```

将返回：

```
L = [['el3','el4','value2'], ['el1','el2','value2'], ['el1','el5','value3']] 
```

[我在这里](https://stackoverflow.com/a/1143432/1306351)找到了一种类似的简单方法：

```
dict((x[0], x) for x in L).values() 
```

但这仅适用于第一个元素而不是前 2 个，但这正是我想要的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-15T19:52:00.313

如果顺序无关紧要，您可以使用相同的方法，但使用第一个和第二个元素的元组作为键：

```
{(x[0], x[1]): x for x in L}.values() 
```

或者在 2.7 之前的 Python 版本上：

```
dict(((x[0], x[1]), x) for x in L).values() 
```

而不是`(x[0], x[1])`你可以使用`tuple(x[:2])`，使用你觉得更易读的任何一个。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-15T19:53:25.053

如果顺序很重要，`set`请仅将 a 与嵌套列表的前两个元素一起使用：

```
seen = set()
seen_add = seen.add
return [x for x in seq if tuple(x[:2]) not in seen and not seen_add(tuple(x[:2]))] 
```

或者您可以使用`collections.OrderedDict()`对象来保持订单；将`x[:2]`切片保留为键（作为元组），并提取值：

```
from collections import OrderedDict(

return OrderedDict((tuple(x[:2]), x) for x in seq).values() 
```

在 Python 3.6 及更高版本中，标准 dict 类型恰好也保留了插入顺序：

```
return list({tuple(x[:2]): x for x in seq}.values()) 
```

`list()`需要调用才能将字典视图对象转换为列表。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-15T19:53:11.107

这应该这样做：

```
In [55]: dict((tuple(x[:2]), x) for x in L).values()
Out[55]: [['el1', 'el2', 'value2'], ['el1', 'el5', 'value3'], ['el3', 'el4', 'value2']] 
```

# php - 使用 ghostscript/PHP 的 PDF 缩放错误

> ID：12902952
> 
> 赞同：0
> 
> 时间：2012-10-15T19:50:27.163
> 
> 标签：php, ghostscript

为了解决一些问题，我又回到了我一年多前参与的一个项目。最紧迫的是，某些 PDF 文档在通过我创建的 GS 脚本抛出时无法转换。他们中的绝大多数使用以下方法工作正常：

（示例） gs -SDEVICE=pdfwrite -dPDFSETTINGS=/prepress -dPDFFitPage -g600x775 -r300 -dAutoRotatePages=/All -sOutputFile=/home//converter_files/converted/111_done.pdf -dNOPAUSE -dBATCH /home/edited/converter_files/in /111.pdf

这会在大多数情况下创建一个文档，该文档在我们使用 PDF 的 iOS 应用程序中运行良好。但是，少数（截至目前）来源未知的文档将导致此错误：

警告：exec() [function.exec]：无法分叉 [gs -SDEVICE=pdfwrite -dPDFSETTINGS=/prepress -dPDFFitPage -g600x775 -r300 -dAutoRotatePages=/All -sOutputFile=/home/edited/converter_files/converted/111_done。 pdf -dNOPAUSE -dBATCH /home/edited/converter_files/in/111.pdf] 在 /home/edited/public_html/2012test.php 第 41 行

我在这一点上不知所措。有人有什么想法可以尝试吗？不知道为什么这些特定文件不会转换。我正在尝试获取有问题但其中不包含敏感客户信息的 PDF 版本，以便我可以获得更多帮助，但截至目前，由于敏感，我无法与问题共享任何 PDF客户信息。

# php - eclipse快捷键的问题

> ID：12902955
> 
> 赞同：1
> 
> 时间：2012-10-15T19:50:41.793
> 
> 标签：php, html, eclipse

`alt + shift + up`用于选择封闭元素的eclipse快捷键适用于`.html`文件，但不适用于文件中写入的html代码`.php`。我如何解决它。或者是否有其他选择来选择 html 标签之间的内容？

# weblogic - Weblogic + Stateless Local Bean + DataSource 注入错误

> ID：12902962
> 
> 赞同：2
> 
> 时间：2012-10-15T19:51:00.110
> 
> 标签：weblogic, ejb-3.0, local, stateless-session-bean

我有一个这样的无状态本地 Bean：

```
@Stateless(name="GerencialFacadeBean", mappedName="GerencialFacade")
public class GerencialFacadeBean implements GerencialFacadeBeanLocal {

    @Resource(name="jdbc/adq_sistint", mappedName = "jdbc/adq_sistint")
    private DataSource dataSource;
.. } 
```

所以，当我使用这个bean时，我得到了以下异常：

```
Caused by: com.bea.core.repackaged.springframework.beans.factory.BeanCreationException: Dependency injection failure: can't find the bean definition about class interface javax.sql.DataSource; nested exception is com.bea.core.repackaged.springframework.beans.factory.NoSuchBeanDefinitionException: No unique bean of type [javax.sql.DataSource] is defined: No beans of type javax.sql.DataSource; owner=com.bea.core.repackaged.springframework.context.support.GenericApplicationContext@5d225fc1: display name [com.bea.core.repackaged.springframework.context.support.GenericApplicationContext@5d225fc1]; startup date [Mon Oct 15 16:30:12 BRT 2012]; parent: com.bea.core.repackaged.springframework.context.support.GenericApplicationContext@885e019
    at com.oracle.pitchfork.inject.Jsr250Metadata.applyInjections(Jsr250Metadata.java:241)
    at com.oracle.pitchfork.inject.Jsr250Metadata.inject(Jsr250Metadata.java:223)
    at com.oracle.pitchfork.inject.Jsr250Metadata.injectAndPostConstruct(Jsr250Metadata.java:253)
    at com.oracle.pitchfork.inject.Jsr250MetadataBeanPostProcessor.postProcessAfterInstantiation(Jsr250MetadataBeanPostProcessor.java:40)
    at com.bea.core.repackaged.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:957)
    at com.bea.core.repackaged.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:470)
    ... 66 more
Caused by: com.bea.core.repackaged.springframework.beans.factory.NoSuchBeanDefinitionException: No unique bean of type [javax.sql.DataSource] is defined: No beans of type javax.sql.DataSource; owner=com.bea.core.repackaged.springframework.context.support.GenericApplicationContext@5d225fc1: display name [com.bea.core.repackaged.springframework.context.support.GenericApplicationContext@5d225fc1]; startup date [Mon Oct 15 16:30:12 BRT 2012]; parent: com.bea.core.repackaged.springframework.context.support.GenericApplicationContext@885e019
    at com.oracle.pitchfork.inject.Jsr250Metadata.getUniqueInstanceOfType(Jsr250Metadata.java:304)
    at com.oracle.pitchfork.inject.Jsr250Metadata.resolveByType(Jsr250Metadata.java:298)
    at com.oracle.pitchfork.inject.Jsr250Metadata.resolve(Jsr250Metadata.java:285)
    at com.oracle.pitchfork.inject.Jsr250Metadata.applyInjections(Jsr250Metadata.java:235) 
```

重要的：

我从一个 Web 服务（在同一个 EAR）中使用这个 EJB，比如：

```
.. class MyWebService.. {
 @EJB(name="GerencialFacadeBean", mappedName="GerencialFacade")
 private GerencialFacadeBeanLocal gerencialBean;

} 
```

而且，如果我尝试在 Webservice 的类上获取数据源，它会成功运行。

编辑：

另一个考虑因素：使用 REMOTE 接口它可以工作。但我想将它与本地接口一起使用。

我正在使用 Weblogic 10.3.5。我的数据源在其他应用程序（直接通过 JNDI 获取）中创建并运行良好，那么，我得到这个错误是什么？

# algorithm - 将矩阵元素表示为向量的算法

> ID：12902963
> 
> 赞同：1
> 
> 时间：2012-10-15T19:51:07.020
> 
> 标签：algorithm, matlab, linear-algebra, numerical-methods

**问题陈述：**

1.  `M`我有一个包含`m`行和`n`列的数组。数组`M`中填充了非零元素。

2.  我还有一个`t`带有`n`元素的向量和一个`omega` 带有`m`元素的向量。

3.  的元素`t`对应于矩阵的列`M`。

4.  的元素`omega`对应于矩阵的行`M`。

**算法目标：**

定义`chi`为向量`t`和的乘积`omega`。 *我需要获得一个一维向量`a`，其中的每个元素`a`都是 的函数`chi`。*

的每个元素`chi`都是唯一的（即每个元素都是不同的）。

使用数学符号，这可以表示为`a(chi)`

vector 的每个元素`a`对应于 的一个或多个元素`M`。

**Matlab代码：**

这是一个代码片段，显示了向量`t`和`omega`是如何生成的。该矩阵`M`是预先存在的。

```
[m,n] = size(M);
t = linspace(0,5,n);
omega = linspace(0,628,m); 
```

**概念图：**

**这似乎是一种沿着常数 chi 的整合（如果这是正确的词的话）。**

![图表](../Images/7c45618108c7c0af3708592e9b0d7926.png)

**参考：**

[参考链接](http://www.scribd.com/doc/45448335/SEISMIC-INVERSE-q-FILTERING#page=208)

该算法未在参考文献中明确说明。我只希望以一种让人联想到计算机科学教科书的方式来描述这个算法！

看图 11.5，矩阵 M 是图 11.5(a)。目标是找到一种算法将图 11.5(a) 转换为 11.5(b)。

看起来该算法是一种沿常数的积分（也许是平均？）`chi`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T20:29:19.917

在我看来，[重塑](http://www.mathworks.com/help/matlab/ref/reshape.html)是您需要使用的 matlab 函数。如链接中所述：

> `B = reshape(A,siz)`返回一个 n 维数组，其元素与 A 相同，但重新整形为`siz`，一个表示重新整形数组维度的向量。

也就是说，创建一个`siz`包含数字的向量`m*n`，并说`A = reshape(P,siz)`，其中 P 是向量 t 和 ω 的乘积；或者说类似`A = reshape(t*ω,[m*n])`. （我这里没有 matlab，或者会运行测试以查看我的产品是否正确。）请注意，该链接没有显示在矩阵参数后带有一个数字（而不是几个）的示例`reshape`，但我希望从描述中`A = reshape(t*ω,m*n)`也能奏效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-15T20:57:42.287

您应该添加一个伪代码或链接到您想要实现的算法。据我所知，无论如何我已经开发了以下代码：

```
M = [1 2 3 4; 5 6 7 8; 9 10 11 12]' % easy test M matrix
a = reshape(M, prod(size(M)), 1)    % convert M to vector 'a' with reshape command

[m,n] = size(M);                    % Your sample code
t = linspace(0,5,n);                % Your sample code
omega = linspace(0,628,m);          % Your sample code 

for i=1:length(t)
    for j=1:length(omega)           % Acces a(chi) in the desired order
        chi = length(omega)*(i-1)+j;
        t(i)                        % related t value
        omega(j)                    % related omega value
        a(chi)                      % related a(chi) value
    end
end 
```

如您所见，我也认为 reshape() 函数是解决您的问题的方法。我希望这段代码有帮助，

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T17:36:01.103

基本思想是使用两个独立的循环。外循环在`chi`变量值之上，而内循环在`i`变量值之上。参考原题中的上图，`i`变量对应x轴（时间），`j`变量对应y轴（频率）。假设`chi`、`i`和`j`变量可以取任何实数，然后使用[双线性插值](http://en.wikipedia.org/wiki/Bilinear_interpolation)来找到与矩阵 中的元素对应的幅度`M`。积分只是对 的元素进行平均`M`。

以下代码片段概述了使用从 2D 到 1D 的光谱塌陷将矩阵元素表示为向量的基本算法。我找不到任何参考，但它是一个适合我的解决方案。

```
% Amp = amplitude vector corresponding to Figure 11.5(b) in book reference
% M = matrix corresponding to the absolute value of the complex Gabor transform 
% matrix in Figure 11.5(a) in book reference
% Nchi = number of chi in chi vector
% prod = product of timestep and frequency step
% dt = time step
% domega = frequency step
% omega_max = maximum angular frequency
% i = time array element along x-axis
% j = frequency array element along y-axis
% current_i = current time array element in loop
% current_j = current frequency array element in loop
% Nchi = number of chi
% Nivar = number of i variables
% ivar = i variable vector

% calculate for chi = 0, which only occurs when
% t = 0 and omega = 0, at i = 1
av0 = mean( M(1,:) );           
av1 = mean( M(2:end,1) );       
av2 = mean( [av0 av1] );    
Amp(1) = av2;                  

% av_val holds the sum of all values that have been averaged
av_val_sum = 0;

% loop for rest of chi 
for ccnt = 2:Nchi                       % 2:Nchi

    av_val_sum = 0;                     % reset av_val_sum 
    current_chi = chi( ccnt );          % current value of chi

    % loop over i vector
    for icnt = 1:Nivar                  % 1:Nivar

        current_i = ivar( icnt );
        current_j = (current_chi / (prod * (current_i - 1))) + 1;
        current_t = dt * (current_i - 1);
        current_omega = domega * (current_j - 1);

        % values out of range
        if(current_omega > omega_max)
            continue;
        end

        % use bilinear interpolation to find an amplitude
        % at current_t and current_omega from matrix M
        % f_x_y is the bilinear interpolated amplitude

        % Insert bilinear interpolation code here

        % add to running sum
        av_val_sum = av_val_sum + f_x_y;
    end % icnt loop

        % compute the average over all i
        av = av_val_sum / Nivar;

        % assign the average to Amp
        Amp(ccnt) = av;

end % ccnt loop 
```

# php - PHP MVC - 将 JSON 转换为模型数据

> ID：12902971
> 
> 赞同：2
> 
> 时间：2012-10-15T19:51:29.783
> 
> 标签：php, model-view-controller, kohana

所以基本上我发现自己正在编写一堆样板代码，这些代码从 JSON 编码的字符串中获取信息，并将该数据放入我的 MVC Web 应用程序中使用的模型中。有没有公​​认的方法来做到这一点？每个模型都应该有一个关联数组来建模对象转换器吗？我应该写一个实用程序类来做到这一点吗？基本上，我只是想从我的控制器中删除该代码以精简它们，而且我是 PHP MVC 的新手。如果这与问题相关，我正在使用 Kohana 3.2。

编辑：

我被要求澄清。我收到 JSON 编码的字符串格式的数据（来自我自己编写的 Web 服务 - Java / w Jersey）。所以本质上，我的网络应用程序中的模型不是从数据库中提取信息，而是从网络服务中提取信息。由于 Web 服务以 JSON 格式返回所有内容，因此我发现自己正在编写处理该问题的代码。反过来，我可以告诉 GSON google 代码将 JSON 转换为特定的 Java 对象。在 PHP 中似乎没有一种方法可以做到这一点。我不是在谈论 stdClass 对象，而是一个模型。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-21T18:52:21.740

您的模型必须使用 fromArray($array) 方法实现简单接口

```
public function fromArray(array $array)
{
  foreach($array as $property => $value) {
     if(property_exists($this, $property) {
       $this->$property = $value;
     }
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T20:05:04.647

Kohana 的模型（ORM 类）仅适用于数据库记录。如果您想使用 Kohana，您必须编写基于 ORM 模块的新模块。该模块实际上可以对模型执行相同的操作（加载、保存），但它可以与您输入数据一起工作。

# visual-studio-2010 - 将自定义编辑器添加到 Visual Studio 编辑器列表

> ID：12902972
> 
> 赞同：6
> 
> 时间：2012-10-15T19:51:47.113
> 
> 标签：visual-studio-2010, c#-4.0, text-editor, vsix

我正在为 Visual Studio 编写自定义编辑器。我已经为新语言实现了一些基本功能，例如语法高亮，并使用生成的 .vsix 文件成功安装了 tha 包。一切都很好，但是我的自定义编辑器需要能够与不同的文件扩展名相关联。

我错误地认为，由于我安装了编辑器，它会出现在

工具->选项..->文本编辑器->文件扩展名->编辑器列表：

![在此处输入图像描述](../Images/82cb1cb8f49456e0031eb143d7f7297d.png)

但是它没有出现在那里。所以问题是：如何将自定义编辑器添加到此列表中？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-26T05:42:22.943

好吧，至少我得到了这个问题的风滚草徽章。

经过大量逆向工程后，我找到了解决方案……没有记录在案……任何地方……

第 1 步：

首先，您需要创建一个编辑器工厂，其中包含所有的花里胡哨——MSVS 有一个扩展。

第 2 步：然后你必须创建这样一个类

```
[AttributeUsage(AttributeTargets.Class, AllowMultiple = true, Inherited = true)]
    class ProvideFileExtensionMapping : RegistrationAttribute
    {
        private readonly string _name, _id, _editorGuid, _package;
        private readonly int _sortPriority;

        public ProvideFileExtensionMapping(string id, string name, object editorGuid, string package, int sortPriority)
        {
            _id = id;
            _name = name;
            if (editorGuid is Type)
            {
                _editorGuid = ((Type)editorGuid).GUID.ToString("B");
            }
            else
            {
                _editorGuid = editorGuid.ToString();
            }
            _package = package;
            _sortPriority = sortPriority;
        }

        public override void Register(RegistrationContext context)
        {
            using (Key mappingKey = context.CreateKey("FileExtensionMapping\\" + _id))
            {
                mappingKey.SetValue("", _name);
                mappingKey.SetValue("DisplayName", _name);
                mappingKey.SetValue("EditorGuid", _editorGuid);
                mappingKey.SetValue("Package", _package);
                mappingKey.SetValue("SortPriority", _sortPriority);
            }
        }

        public override void Unregister(RegistrationAttribute.RegistrationContext context)
        {
        }
    } 
```

第 3 步：然后您需要将此类作为属性添加到您的编辑器工厂（您在第 1 步中创建）：

```
[ProvideFileExtensionMapping("{E23E32ED-3467-4401-A364-1352666A3502}", "RText Editor", typeof(EditorFactory), GuidList.guidRTextEditorPluginEditorFactoryString, 100)]
public sealed class EditorFactory : IVsEditorFactory, IDisposable{...} 
```

就是这样。您现在应该能够在 Visual Studio 的编辑器列表中看到您的编辑器。

当文件映射正确时，将调用您的编辑器。

希望这篇文章可以为其他人节省很多时间。

# php - 根据日期和状态显示考勤提交链接

> ID：12902977
> 
> 赞同：0
> 
> 时间：2012-10-15T19:52:09.923
> 
> 标签：php, date

我的数据库中有一个日期列表，用于提交出勤率，这是每周完成的。我想使用日期生成一个链接，以便教师可以单击该日期链接以提交该周的出勤率。我只需要知道最好的方法是什么。一旦他们提交了数据，我希望该周的链接不可点击。这里的主要内容是日期/链接显示在特定的时间范围内 - 例如一周结束日期后最多 3 天。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T19:53:57.113

对于您的 SQL 查询，您可能需要这样的内容：

```
SELECT * FROM table_name WHERE date BETWEEN DATE_ADD(NOW(), INTERVAL 1 DAY) AND DATE_ADD(NOW(), INTERVAL 7 DAY) 
```

我冒昧地假设您使用的是 MySQL。

有关更多日期/时间功能，请参阅此内容：http: [//dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html)

# python - 如何允许列表 append() 方法返回新列表

> ID：12902980
> 
> 赞同：111
> 
> 时间：2012-10-15T19:52:17.927
> 
> 标签：python, list, append

我想做这样的事情：

```
myList = [10, 20, 30]
yourList = myList.append(40) 
```

不幸的是，列表追加不会返回修改后的列表。

**那么，我怎样才能允许`append`返回新列表？**

* * *

## 回答 #1

> 赞同：192
> 
> 时间：2012-10-15T19:54:17.847

不要使用追加而是连接：

```
yourList = myList + [40] 
```

这将返回一个*新*列表；`myList`不会受到影响。*如果您还*需要`myList`影响任何使用方法，请与 (a copy of) 分开分配。*`.append()``yourList``myList`*

 ** * *

## 回答 #2

> 赞同：39
> 
> 时间：2018-03-01T08:21:59.080

在 python 3 中，您可以通过解压旧列表并添加新元素来创建新列表：

```
a = [1,2,3]
b = [*a,4] # b = [1,2,3,4] 
```

当你这样做时：

```
myList + [40] 
```

您实际上有 3 个列表。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-10-15T19:54:27.270

`list.append`是内置的，因此无法更改。但如果你愿意使用 以外的东西`append`，你可以尝试`+`：

```
In [106]: myList = [10,20,30]

In [107]: yourList = myList + [40]

In [108]: print myList
[10, 20, 30]

In [109]: print yourList
[10, 20, 30, 40] 
```

当然，这样做的缺点是创建一个新列表需要更多时间`append`

希望这可以帮助

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-06-26T18:38:55.140

尝试使用`itertools.chain(myList, [40])`. 这将返回一个生成器作为序列，而不是分配一个新列表。本质上，这会返回第一个迭代中的所有元素，直到它被耗尽，然后继续下一个迭代，直到所有迭代都被耗尽。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-10-15T20:04:46.690

您可以子类化内置列表类型并重新定义“附加”方法。或者更好的是，创建一个新的，它将做你想做的事情。下面是重新定义的“附加”方法的代码。

```
#!/usr/bin/env python

class MyList(list):

  def append(self, element):
    return MyList(self + [element])

def main():
  l = MyList()
  l1 = l.append(1)
  l2 = l1.append(2)
  l3 = l2.append(3)
  print "Original list: %s, type %s" % (l, l.__class__.__name__)
  print "List 1: %s, type %s" % (l1, l1.__class__.__name__)
  print "List 2: %s, type %s" % (l2, l2.__class__.__name__)
  print "List 3: %s, type %s" % (l3, l3.__class__.__name__)

if __name__ == '__main__':
  main() 
```

希望有帮助。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-04-02T18:00:01.160

只是为了扩展 Storstamp 的答案

你只需要做 myList.append(40)

它会将其附加到原始列表中，现在您可以返回包含原始列表的变量。

如果您正在处理非常大的列表，那么这是要走的路。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-03-13T19:17:37.397

不幸的是，这里没有一个答案能完全解决所问的问题。这是一个简单的方法：

```
lst = [1, 2, 3]
lst.append(4) or lst  # the returned value here would be the OP's `yourList`
# [1, 2, 3, 4] 
```

有人可能会问这样做的真正需要，比如当有人需要提高 RAM 使用率、做微基准测试等时，这些*通常是*无用的。然而，有时有人真的在“问什么”（我不知道这里是不是这样），而现实比我们所知道的更加多样化。所以这是一个（因为脱离上下文而设计的）用法......而不是这样做：

```
dic = {"a": [1], "b": [2], "c": [3]}

key, val = "d", 4  # <- example
if key in dic:
    dic[key].append(val)
else:
    dic[key] = [val]
dic
#  {'a': [1], 'b': [2], 'c': [3], 'd': [4]}

key, val = "b", 5  # <- example
if key in dic:
    dic[key].append(val)
else:
    dic[key] = [val]
dic
#  {'a': [1], 'b': [2, 5], 'c': [3], 'd': [4]} 
```

可以在任何需要表达式（而不是语句）的地方使用上面的 OR 表达式：

```
key, val = "d", 4  # <- example
dic[key] = dic[key].append(val) or dic[key] if key in dic else [val]
#  {'a': [1], 'b': [2], 'c': [3], 'd': [4]}

key, val = "b", 5  # <- example
dic[key] = dic[key].append(val) or dic[key] if key in dic else [val]
#  {'a': [1], 'b': [2, 5], 'c': [3], 'd': [4]} 
```

或者，等效地，当列表中没有*虚假*值时，可以尝试`dic.get(key, <default value>)`一些更好的方法。

* * *

## 回答 #8

> 赞同：-5
> 
> 时间：2012-10-15T19:54:45.743

你只需要做 myList.append(40)

它会将其附加到原始列表中，而不是返回新列表。*

# javascript - 侦听要调用 JavaScript 的函数

> ID：12902981
> 
> 赞同：7
> 
> 时间：2012-10-15T19:52:20.173
> 
> 标签：javascript, jquery, javascript-events, event-handling

我有以下函数每 2 秒调用一次以加载一些数据。它注册函数 [do] 以对响应进行处理。（示例已简化）。

```
function doRequest (){
    $.ajax({ url: 'www.google.com.pe', success: function (response) {do(response)} });
}

function do (text){
    var i = setInterval(doRequest, 2000);
} 
```

我想知道是否有任何方法可以创建一个每次调用 [do] 函数时调用的函数，而无需在 do 函数内添加对侦听器的调用。提前致谢。如果有任何更好的方法可以用 jquery 来做，比如一个插件，我会很感激帮助。

[编辑] 这个想法不在于它是否有效。我的问题是我是否可以向已经实现的“do”函数添加一个自定义侦听器。像 addActionListener("do", "after", doSomeThingElse) 这样我就可以在 do 函数完成后做一些其他的事情。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-15T19:56:04.870

首先，您的简化版本将不起作用，因为您需要传递`do`函数而不是调用它。

```
function doRequest (){
    $.ajax({ url: 'www.google.com.pe', success: _do });
} 
```

* * *

但听起来您每次`do`调用时都在问如何运行其他代码。

如果`do`仅在函数内部调用，则只需将您的其他代码添加到在正确时间`doRequest()`调用的匿名函数中。`do`

```
function doRequest (){
    $.ajax({ url: 'www.google.com.pe', success: function(response) {
          // Run your other code
          //   or invoke another function.
          _do(response);
    } });
} 
```

如果你想让它更通用，你可以创建一个函数装饰器，它返回一个`do`在其他代码之后调用的函数。

```
function doFactory(fn) {
    return function() {
        fn.apply(this, arguments);
        _do.apply(this, arguments);
    }
} 
```

然后制作这样的功能：

```
var doFoo = doFactory(function() {
    console.log("foo");
}); 
```

* * *

如果您的要求对 的预处理更具体`response`，您可以像这样对其进行返工：

```
function doFactory(fn) {
    return function(response) {
        _do.call(this, fn.call(this, response));
    }
} 
```

然后进行`fn`操作并返回`response`。

```
var doFoo = doFactory(function(response) {
    return response + "foo";
}); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-15T20:23:18.000

如果您想保持现有代码不变，您可以包装`do()`在另一个函数中，该函数依次调用`do()`和您的新函数（比如`do_this_as_well()`）。

请参见下面的示例（我重命名`do()`以`do_this()`避免与保留关键字混淆`do`）。这是有效的，因为全局函数只不过是其中包含函数对象的变量。这些变量可以被覆盖，在这种情况下，使用一个调用旧函数的新函数：

```
function do_this(response) { ... }

(function()
{
    var previous=do_this;
    do_this=function(response) { previous(response); do_this_as_well(); }
})(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-15T19:55:52.463

代替

```
success: do(response) 
```

和

```
success: function(response) { do(response); do_this_as_well(); } 
```

# drupal - 使用令牌作为数据选择器

> ID：12902984
> 
> 赞同：3
> 
> 时间：2012-10-15T19:52:23.153
> 
> 标签：drupal, drupal-7, token, drupal-rules

我创建了以下令牌；但是，当我尝试在循环操作中使用 site:coupons 作为数据选择器时，它不会出现在数据选择浏览器中。请注意，当我使用例如“在站点上显示消息”操作时，它确实显示为替换模式。

我花了很多时间在互联网和规则'令牌'问题队列中搜索，我也尝试阅读核心令牌，令牌和规则的源代码。我还发现了一些信息，比如数据选择器没有标记！或规则仅适用于实体！到目前为止，无论我多么努力，我都无法让它发挥作用。我的数据不是实体。反正有没有将它与规则相结合？我找不到任何官方文档，所以我创建了一个问题，希望一些规则专家可以帮助我。

注意：如果我在下面的代码中用优惠券链接替换网站，它甚至不会在规则中显示为替换模式。但它在其他任何地方都可以作为令牌正常工作，但在规则中

提前致谢

```
<?php
/**
* Implements hook_token_info().
*/
function coupon_link_token_info() {
$types['coupon-link'] = array(
'name' => t("Coupon link coupon info"),
'description' => t("Info about linked coupon via url."),
);

// Andy Pangus specific tokens.
$tokens['site']['coupon-code'] = array(
'name' => t("Coupon Link Coupon Code"),
'description' => t("The code of the coupon entered via url."),
);
$tokens['site']['coupon'] = array(
'name' => t("Coupon Link Coupon"),
'description' => t("The coupon entered via url."),
'type' => 'commerce_coupon'
);
$tokens['site']['coupons'] = array(
'name' => t("Coupon Link List Coupons"),
'description' => t("The coupons entered via url."),
'type' => 'array'
);

return array(
'types' => $types,
'tokens' => $tokens,
);
}

/**
* Implements hook_tokens().
*
* @ingroup token_example
*/
function coupon_link_tokens($type, $tokens, array $data = array(), array $options =         array()) {
$replacements = array();
$sanitize = !empty($options['sanitize']);

// Text format tokens.
if ($type == 'site' && __coupon_link_get_coupon_code()) {
//$format = $data['format'];

foreach ($tokens as $name => $original) {
switch ($name) {
case 'coupon-code':
// Since {filter_format}.format is an integer and not user-entered
// text, it does not need to ever be sanitized.
$replacements[$original] = $sanitize ? filter_xss(__coupon_link_get_coupon_code()) :     __coupon_link_get_coupon_code();
break;
case 'coupon':
// Since the format name is user-entered text, santize when requested.
$replacements[$original] = __coupon_link_get_coupon(__coupon_link_get_coupon_code());
break;
case 'coupons':
// Since the format name is user-entered text, santize when requested.
$replacements[$original] =                 array(__coupon_link_get_coupon(__coupon_link_get_coupon_code()));
break;
}
}
}
return $replacements;
}
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-21T23:43:26.157

一些东西。

1.  令牌的格式如`[type:token]`hook_token_info [api](http://api.drupal.org/api/drupal/modules!system!system.api.php/function/hook_token_info/7)页面中所述。对于您的示例，它将是`[coupon-link:coupon]`. 我不确定您为什么要将令牌附加到*站点*数组，因为您的自定义优惠券令牌可能与 *site_url* 或 *site_name* 等站点范围的令牌无关。

2.  因为类型是机器名称，所以您应该将其更改`coupon_link`为带有破折号的机器名称不是 Drupal 标准。

3.  如果您真的迷路了，我建议您还可以查看示例模块中[的令牌示例](http://api.drupal.org/api/examples/token_example!token_example.module/7)。

# xamarin.ios - 以编程方式连接到 ForeFront UAG 后面的 ASP.NET WebAPI

> ID：12902988
> 
> 赞同：5
> 
> 时间：2012-10-15T19:52:44.943
> 
> 标签：xamarin.ios, asp.net-web-api

我有一个使用 ASP.NET MVC4 构建的 WebAPI。它是一个用于获取数据的简单 API（简单的 HTTP GET 请求）。该 API 是稳定的，并且已经与我们的移动 (MonoTouch) 应用程序一起使用了相当长的一段时间。现在我们将 ForeFront UAG 放在 API 前面（只需将 web.config 更改为使用 windows auth。通过浏览器（例如 Chrome）测试安全性和 API，并显示 UAG 登录名（第一次点击 API 时）。输入您的凭据，然后您为 API GET 请求取回数据。所有您所期望的。现在，从 .NET 代码（无浏览器）我想做同样的事情。我已经看到以编程方式访问 SharePoint 和一些窗口的示例电话的东西，但它们似乎都不适用于来自常规旧 .NET 代码（我最终将在 MonoTouch 中使用）的 ASP.NET MVC4 WebApi 调用。

**任何人都有一个如何验证然后通过 UAG 成功向 ASP.NET MVC4 WebApi 发出 HTTP GET 请求的示例？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-11T18:01:21.907

我没有 ForeFront UAG 的处置权，所以我无法对此进行测试。但总的来说，您有几个选择。示例是片段，为了便于阅读，省略了一些代码。

**WebClient / HttpWebRquest**

```
CredentialCache credentials = new CredentialCache();
credentials.Add(new Uri(url), "NTLM", new NetworkCredential(userName, password, domain));

//WebClient
var webClient = new WebClient();
webClient.Credentials = credentials;

//HttpWebRequest
var request = HttpWebRequest.Create(url);
request.Credentials = credentials 
```

**HttpClient**

```
WebRequestHandler clientHandler = new WebRequestHandler();
clientHandler.UseDefaultCredentials = true;
clientHandler.AllowPipelining = true;
clientHandler.ImpersonationLevel = System.Security.Principal.TokenImpersonationLevel.Impersonation;

ProgressMessageHandler progress = new ProgressMessageHandler();

httpClient = HttpClientFactory.Create(clientHandler, progress); 
```

您还可以选择使用第三方库来完成这项工作，例如[RestSharp](http://restsharp.org/ "RestSharp") 或[Service Stack](http://www.servicestack.net/ "服务栈")。我个人使用 RestSharp 是因为它易于使用和序列化/反序列化功能。

# android - 如何从 web 视图中隐藏“网页不可用”页面/错误？

> ID：12902989
> 
> 赞同：4
> 
> 时间：2012-10-15T19:52:52.620
> 
> 标签：android

我想隐藏那个错误，只显示一个空白页和一个对话框。

我该如何隐藏它？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-15T20:14:45.837

不是那么明显。因为 WebViewClient 无论如何都会打开标准错误页面，即使您覆盖 onReceivedError 方法。所以我们需要在处理错误事件后打开自定义错误页面。

因此，您应该覆盖[WebViewClient 中的 onReceivedError](http://developer.android.com/reference/android/webkit/WebViewClient.html#onReceivedError%28android.webkit.WebView,%20int,%20java.lang.String,%20java.lang.String%29)，然后如果您处理所需的错误代码（请参阅 WebViewClient 中的 ERROR_ 常量），您应该打开空白页面或其他页面以隐藏标准 Android“网页不可用”页面。

像这样的东西：

```
@Override
public void onReceivedError(WebView view, int errorCode, String description, String failingUrl) {
    if (errorCode == neededErrorCode) {
        hideErrorPage(view);
    }
}

private void hideErrorPage(WebView view) {
    // Here we configurating our custom error page
    // It will be blank
    String customErrorPageHtml = "<html></html>";
    view.loadData(customErrorPageHtml, "text/html", null);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T19:59:16.210

您应该重写 onReceiveError 方法。

[http://developer.android.com/reference/android/webkit/WebViewClient.html#onReceivedError%28android.webkit.WebView,%20int,%20java.lang.String,%20java.lang.String%29](http://developer.android.com/reference/android/webkit/WebViewClient.html#onReceivedError%28android.webkit.WebView,%20int,%20java.lang.String,%20java.lang.String%29)

在该方法中，只需创建您的自定义视图即可查看。例如加载一个新的 url 或一些自定义的 html。

# java - 我想将控制台上的输出打印到文本文件中。我尝试了以下但没有锻炼。有人可以看看这个吗？

> ID：12902991
> 
> 赞同：0
> 
> 时间：2012-10-15T19:53:02.400
> 
> 标签：java, file-io, jdbc

下面是我尝试将控制台上的输出打印到文本文件的代码。代码的主要思想是从 csv 文件中获取值并将输出打印到文本文件中。有人可以让我知道如何实现这一目标。

```
import java.io.BufferedWriter;
import java.io.File;
import java.io.FileWriter;
import java.io.IOException;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;

import com.csvreader.CsvReader;

public class projectInfo {
    public static void main(String[] args) {

        StringBuffer buffer = new StringBuffer();

        Connection conn;

        int count = 0;

        String sampleIddisp = null;
        String sample_name = null;
        String compound_name = null;
        String registration_date = null;

            }
            products.close();

        } catch (Exception e) {
            e.printStackTrace();
        } finally {
            System.out.println("\n Total number of records processed:" + count);

        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-15T19:57:41.287

您永远不会在您的 中放置任何内容`StringBuffer` `buffer`，因此当您将其写入文件时它是空的：

```
bw.write(buffer.toString()); 
```

`buffer`可能会在这里消耗大量内存。

将数据写入文件的更好方法是在从数据库读取数据时写入数据：

```
while (rs.next()) {
   sampleIddisp = rs.getString(1);
   ...

   bw.write(....);
} 
```

# php - 如何使用 CRON 运行单个 PHP 实例？

> ID：12902996
> 
> 赞同：3
> 
> 时间：2012-10-15T19:53:27.330
> 
> 标签：php, cron

我在使用 CRON 运行 PHP 脚本的单个实例时遇到问题。也许有人可以帮助解释需要什么。目前，我有一个`startup`脚本被调用，`crontab`在调用 PHP 实例之前检查以确保 PHP 脚本的实例尚未运行。

`crontab -e`入口：

```
* * * * * /var/www/private/script.php >> /var/www/private/script.log 2>&1 & 
```

。/启动

```
#!/bin/bash

if ps -ef | grep '[s]cript';
        then
                exit;
        else
                /usr/bin/php /var/www/private/script.php  >>/var/www/private/script.log 2>&1 &
                echo 'started'
fi 
```

这似乎不起作用，我似乎无法记录任何错误以了解如何继续调试它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T19:54:32.433

您可以为此使用 lockrun：[http ://www.unixwiz.net/tools/lockrun.html](http://www.unixwiz.net/tools/lockrun.html)

```
* * * * * /usr/local/bin/lockrun --lockfile=/var/run/script.lockrun -- php /home/script.php 
```

或者使用 Perl：

```
system('php /home/script.php') if ( ! `ps -aef|grep -v grep|grep script.php`); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T19:56:58.040

测试进程并不是防止脚本出现多个实例的最可靠方法。

在`bash`，我建议你使用它：

```
if ( set -o noclobber; echo "locked" > "$lockfile") 2> /dev/null; then
  trap 'rm -f "$lockfile"; exit $?' INT TERM EXIT
  echo "Locking succeeded" >&2
  rm -f "$lockfile"
else
  echo "Lock failed - exit" >&2
  exit 1
fi 
```

此页面中还有另一个示例[http://wiki.bash-hackers.org/howto/mutex](http://wiki.bash-hackers.org/howto/mutex)

**另一种解决方案**（如果不使用`NFS`）是使用`flock (1)`，请参阅[如何使用 linuxflock 命令来防止另一个根进程删除文件？](https://stackoverflow.com/questions/1040828/how-do-i-use-the-linux-flock-command-to-prevent-another-root-process-from-deleti)